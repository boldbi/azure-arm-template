@using System.Runtime.InteropServices;

@{
    var globalAppSettings = _globalAppSettings;
    var ldapRegEx = @"/(?:ldap|http)s?:\/\/(?:(?!.*\d[\/?:])[a-z0-9\-._~%]+|(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9]?[0-9])\[[a-z0-9\-._~%!$&'()*+,;=:]+\])(?::\d+)?(?:[\/?][\-A-Z0-9+&@#\/%?=~_|$!:,.;]*)?$/i";
    var oauthRegEx = @"/(?:^|[ \t])((https?:\/\/)?(?:localhost|[\w-]+(?:\.[\w-]+)+)(:\d+)?(\/\S*)?)/";
    List<TenantAuthControl> authControl = null;
    TenantAuthControl cloudAuthControl = null;
    var loginOptions = globalAppSettings.SystemSettings.LoginOptions;
#if DashboardServerOnPremise
    authControl = ViewBag.AuthControl as List<TenantAuthControl>;
    authControl = authControl != null && authControl.Count > 0 ? authControl : null;
#else
    cloudAuthControl = ViewBag.AuthControl as TenantAuthControl;
#endif
    var isAzureApplication = ServerAppConfig.IsAzureApplication;
    var enableWindowsAD = RuntimeInformation.IsOSPlatform(OSPlatform.Windows);
}
<script>
    var defaultAuthentication = "";
</script>
<div id="active-directory-container" role="tabpanel" class="col-xs-12 admin-page-container @(ViewBag.ThirdPartyLogins ? string.Empty : "unlock-enterprise-features blur-content")" aria-labelledby="active-directory-settings-link" ng-controller="adSettingsController">

    <div class="col-md-12 import-area admin-page-header">
        <hgroup class="col-lg-6 col-md-6 col-sm-6 col-xs-12 no-padding">
            <h1 class="h2 page-title">[[[AUTHENTICATION SETTINGS]]]</h1>
            <h5 class="page-description">[[[Configure authentication/authorization providers’ information.]]]</h5>
        </hgroup>
        <div class="col-lg-6 col-md-6 col-sm-6 col-xs-12 no-padding">
            <button class="dropdown-toggle primary-button pull-right" data-toggle="dropdown" id="schedule-synchronization" title="[[[Synchronize schedules]]]">
                <span>[[[Synchronization]]] </span>
                <span class="caret"></span>
            </button>
            <ul class="dropdown-menu multi-level pull-right" role="menu" id="synchronization-options">
                @if (ServerAppConfig.IsSelfHosted && !isAzureApplication && enableWindowsAD)
                {
                    <li>
                        <a href="@Url.Action("ScheduleSynchronization", "Administration")" data-toggle="tooltip" data-placement="left" data-container="body" title="[[[Synchronize Active Directory users and groups on a regular schedule]]]">
                            <span>[[[AD Schedule Synchronization]]]</span>
                        </a>
                    </li>
                }
                <li>
                    <a href="@Url.Action("ScheduleAzureSynchronization", "Administration")" title="[[[Synchronize Azure AD users and groups on a regular schedule]]]">
                        <span>[[[Azure AD Schedule Synchronization]]]</span>
                    </a>
                </li>
                <li>
                    <a href="@Url.Action("ScheduleDatabaseSynchronization", "Administration")" title="[[[Synchronize users and groups from database on a regular schedule]]]">
                        <span>[[[Database Schedule Synchronization]]]</span>
                    </a>
                </li>
            </ul>
        </div>
    </div>

    <div>
        <ul id="ad-tab-nav" class="nav nav-tabs" role="tablist">
            @if (ServerAppConfig.IsSelfHosted)
            {
                <li role="presentation" class="active">
                    <a href="#general-settings-tab" id="general" aria-controls="general-tab" role="tab" data-toggle="tab">[[[General]]]</a>
                </li>
            }
            @if (ServerAppConfig.IsSelfHosted && !isAzureApplication && enableWindowsAD)
            {
                <li role="presentation">
                    <a href="#windows-ad-tab" id="windows-ad" aria-controls="windows-ad-tab" role="tab" data-toggle="tab">[[[Windows Active Directory]]]</a>
                </li>
            }
            <li role="presentation">
                <a href="#azure-ad-tab" id="azure-ad" aria-controls="azure-ad-tab" role="tab" data-toggle="tab">[[[Azure Active Directory]]]</a>
            </li>
            <li role="presentation">
                <a href="#database-settings-tab" id="database-settings" aria-controls="database-settings-tab" role="tab" data-toggle="tab">[[[Database]]]</a>
            </li>
            <li role="presentation">
                <a href="#auth-control-tab" id="auth-control" aria-controls="auth-control-tab" role="tab" data-toggle="tab">[[[Authentication Control]]]</a>
            </li>
            @if (ServerAppConfig.IsSelfHosted)
            {
                <li role="presentation">
                    <a href="#oauth-settings-tab" id="oauth-settings" aria-controls="oauth-settings-tab" role="tab" data-toggle="tab">[[[OAuth 2.0]]]</a>
                </li>
                <li role="presentation">
                    <a href="#openid-settings-tab" id="openid-settings" aria-controls="openid-settings-tab" role="tab" data-toggle="tab">[[[OpenID Connect]]]</a>
                </li>
            }
            </ul>

        <div class="tab-content">
            @await Html.PartialAsync("_DefaultAuthentication")
            @if (ServerAppConfig.IsSelfHosted && !isAzureApplication && enableWindowsAD)
            {
                <div role="tabpanel" class="tab-pane" id="windows-ad-tab">
                    <form autocomplete="off" class="active-directory-form col-lg-12 admin-page-body" name="windowsAdSettingsForm" enctype="multipart/form-data" id="active-directory-setting" method="post">
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                @Html.Label("username", "[[[Username]]]", new { @class = "app-textbox-label col-md-4 no-margin" })

                                <div class="col-md-8 no-margin form-input-field" ng-class="(windowsAdSettingsForm.userName.$dirty && windowsAdSettingsForm.userName.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" name="userName" placeholder="[[[Username]]]" id="username" ng-model="windowsAduserName" ng-init="windowsAduserName='@ViewBag.SystemSettings.ActiveDirectoryUserName'" required />
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.userName.$dirty && windowsAdSettingsForm.userName.$invalid">[[[Please enter username]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                @Html.Label("password", "[[[Password]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 no-margin form-input-field" ng-class="(windowsAdSettingsForm.passWord.$dirty && windowsAdSettingsForm.passWord.$invalid) ? 'has-error' : ''">
                                    <input type="text" style="display: none;">
                                    <input style="visibility: hidden; position: absolute; left: -99999px" type="password" name="fake_passwordfield_to_turnoff_autocomplete">
                                    <input type="password" class="form-control col-md-6 no-margin" value="" name="passWord" placeholder="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" id="password" ng-model="passWord" required />
                                    <div class="show-hide-password su su-eye"></div>
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.passWord.$dirty && windowsAdSettingsForm.passWord.$invalid">[[[Please enter password]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                @Html.Label("ldapurl", "[[[LDAP URL]]](LDAP://)", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 no-margin form-input-field" ng-class="(windowsAdSettingsForm.ldapUrl.$dirty && windowsAdSettingsForm.ldapUrl.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" name="ldapUrl" placeholder="[[[LDAP URL]]]" id="ldapurl" ng-model="windowsLdapUrl" ng-init="windowsLdapUrl='@ViewBag.SystemSettings.LdapUrl'" ng-pattern="@ldapRegEx" required />
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.ldapUrl.$error.required && windowsAdSettingsForm.ldapUrl.$dirty ">[[[Please enter LDAP URL]]]</span>
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.ldapUrl.$error.pattern ">[[[Invalid LDAP URL]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                @Html.Label("distinguished-name", "[[[Distinguished Name]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 no-margin form-input-field" ng-class="(windowsAdSettingsForm.distinguishedName.$dirty && windowsAdSettingsForm.distinguishedName.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" name="distinguishedName" placeholder="[[[DC=example,DC=com]]]" id="distinguished-name" ng-model="windowsDistinguishedName" ng-init="windowsDistinguishedName='@ViewBag.SystemSettings.DistinguishedName'" ng-pattern="distinguishedNameRegex" required />
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.distinguishedName.$error.required && windowsAdSettingsForm.distinguishedName.$dirty ">[[[Please enter Distinguished Name]]]</span>
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.distinguishedName.$error.pattern ">[[[Invalid Distinguished Name]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin enablesslcontainer">
                                @Html.Label("enable-ldap-ssl", "[[[Enable SSL]]]", new { @class = "app-textbox-label col-md-4 no-margin" })

                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        <input type="checkbox" id="enable-ldap-ssl" name="enablessl" @((bool)ViewBag.SystemSettings.EnableSsl ? "checked" : string.Empty) />
                                        <label for="enable-ldap-ssl" class="label-primary"></label>
                                    </span>
                                    <span class="validation-message"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                @Html.Label("ldap-port-number", "[[[Port Number]]]", new { @class = "app-textbox-label col-md-4 no-margin" })

                                <div class="col-md-8 no-margin form-input-field" ng-class="(windowsAdSettingsForm.portNo.$dirty && windowsAdSettingsForm.portNo.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" name="portNo" placeholder="[[[Port Number]]]" id="ldap-port-number" ng-model="windowsPortNo" ng-init="windowsPortNo='@ViewBag.SystemSettings.PortNo'" required />
                                    <span class="port-number-info">(Default: SSL: 636, Non-SSL: 389)</span>
                                    <span class="validation-message" ng-show="windowsAdSettingsForm.portNo.$dirty && windowsAdSettingsForm.portNo.$invalid">[[[Please enter Port Number]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                                <div class="col-md-6 no-padding no-margin enablesslcontainer">
                                    @Html.Label("ad-group-user-import", "[[[Import users from groups]]]", new { @class = "app-textbox-label col-md-4 no-margin" })

                                    <div class="col-md-8 form-input-field pull-left switch-align">
                                        <span class="material-switch text-left">
                                            <input type="checkbox" id="import-ad-group-user" name="importadgroupuser" @((bool)ViewBag.SystemSettings.EnableGroupUserImport ? "checked" : string.Empty) />
                                            <label for="import-ad-group-user" class="label-primary"></label>
                                        </span>
                                        <span class="validation-message"></span>
                                    </div>
                                </div>
                            </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-margin no-padding">
                                <input type="button" onclick="ActiveDirectoryFormValidate()" class="primary-button pull-right test-connection" data-toggle="tooltip" data-placement="top" data-container="body" title="[[[Test Active Directory Connection]]]" value="[[[Test Connection]]]" ng-disabled="windowsAdSettingsForm.$invalid" />
                            </div>
                            <div class="col-md-6 error-message" style="display: none"></div>
                            <div class="col-md-6 success-message" style="display: none"></div>
                        </div>
                    </form>
                </div>
            }
            <div role="tabpanel" class="tab-pane" id="azure-ad-tab">
                <form id="azure-ad-setting" name="azureAdSettingsForm" class="admin-page-body" method="post" enctype="multipart/form-data" autocomplete="off">
                    <div class="col-md-12 form-group">
                        <div class="col-md-6 no-padding no-margin">
                            <label class="app-textbox-label col-md-4 no-margin">[[[Tenant Name]]]</label>
                            <div class="col-md-8 no-margin form-input-field" ng-class="(azureAdSettingsForm.tenantName.$dirty && azureAdSettingsForm.tenantName.$invalid) ? 'has-error' : ''">
                                <input type="text" class="form-control col-md-6 no-margin" ng-model="azureTenantName" ng-init="azureTenantName='@ViewBag.AzureADSetting.TenantName'" name="tenantName" placeholder="example.onmicrosoft.com" id="tenantName" ng-pattern="regex" required />
                                <span class="validation-message" ng-show="azureAdSettingsForm.tenantName.$error.required && azureAdSettingsForm.tenantName.$dirty ">[[[Please enter tenant name]]]</span>
                                <span class="validation-message" ng-show="azureAdSettingsForm.tenantName.$error.pattern ">[[[Please enter valid URL]]]</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 form-group">
                        <div class="col-md-6 no-padding no-margin">
                            <label class="app-textbox-label col-md-4 no-margin">[[[Client Id]]]</label>
                            <div class="col-md-8 no-margin form-input-field" ng-class="(azureAdSettingsForm.clientId.$dirty && azureAdSettingsForm.clientId.$invalid) ? 'has-error' : ''">
                                <input type="text" class="form-control col-md-6 no-margin" ng-model="azureClientId" name="clientId" ng-init="azureClientId='@ViewBag.AzureADSetting.ClientId'" placeholder="[[[Client Id]]]" id="clientId" required />
                                <span class="validation-message" ng-show="azureAdSettingsForm.clientId.$dirty && azureAdSettingsForm.clientId.$invalid">[[[Please enter client id]]]</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 form-group">
                        <div class="col-md-6 no-padding no-margin">
                            <label class="app-textbox-label col-md-4 no-margin">[[[Client Secret Code]]]</label>
                            <div class="col-md-8 no-margin form-input-field" ng-class="(azureAdSettingsForm.clientKey.$dirty && azureAdSettingsForm.clientKey.$invalid) ? 'has-error' : ''">
                                <input type="text" style="display: none;">
                                <input style="visibility: hidden; position: absolute; left: -99999px" type="password" name="fake_passwordfield_to_turnoff_autocomplete">
                                <input type="password" class="form-control col-md-6 no-margin" value="" ng-model="azureClientKey" name="clientKey" placeholder="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" id="clientKey" required />
                                <div class="show-hide-password su su-eye"></div>
                                <span class="validation-message" ng-show="azureAdSettingsForm.clientKey.$dirty && azureAdSettingsForm.clientKey.$invalid">[[[Please enter client key]]]</span>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-12 form-group">
                        <div class="col-md-6 no-padding no-margin enablesslcontainer">
                            @Html.Label("azure-ad-group-user-import", "[[[Import users from groups]]]", new { @class = "app-textbox-label col-md-4 no-margin" })

                            <div class="col-md-8 form-input-field pull-left switch-align">
                                <span class="material-switch text-left">
                                    <input type="checkbox" id="import-azure-ad-group-user" name="importazureadgroupuser" @((bool)ViewBag.AzureADSetting.EnableGroupUserImport ? "checked" : string.Empty) />
                                    <label for="import-azure-ad-group-user" class="label-primary"></label>
                                </span>
                                <span id="azure-ad-group-user-import-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Enabling this setting will import and synchronize users when importing and synchronizing groups with Azure AD. Enable this setting if you need to import users from your Azure AD groups.]]]"></span>
                            </div>
                        </div>
                    </div>
                    @if (ViewBag.ThirdPartyLogins)
                    {
                        <div class="col-md-12">
                            <div class="col-md-6 no-padding no-margin">
                                <input type="button" id="testAzureConnection" ng-disabled="azureAdSettingsForm.$invalid" onclick="AzureADFormValidate()" class="primary-button test-connection pull-right" title="[[[Test Azure Active Directory Connection]]]" value="[[[Test Connection]]]" />
                            </div>
                            <div class="col-md-6 error-message" style="display: none"></div>
                            <div class="col-md-6 success-message" style="display: none"></div>
                        </div>
                    }
                </form>
            </div>
            <div role="tabpanel" class="tab-pane" id="database-settings-tab">
                <div id="import-database-container" class="">
                    <div class="col-lg-12 connection-properties-form admin-page-body">
                        <div id="connect-properties">
                            <form class="no-padding form-horizontal" method="post">
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <div id="databasetype-holder" class="no-padding">
                                            <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                                [[[Database type]]]
                                            </label>
                                            <div class="col-md-8 connect-database-padding txt-holder">
                                                <select id="database-type" class="selectpicker">
                                                    @if (ViewBag.DbSettings.DatabaseName != null)
                                                    {
                                                        if (ViewBag.DbSettings.ServerType.ToString() == "MSSQL")
                                                        {
                                                            <option value="MSSQL" selected="selected">[[[SQL Server]]]</option>
                                                            <option value="PostgreSQL">[[[PostgreSQL]]]</option>
                                                        }
                                                        else if (ViewBag.DbSettings.ServerType.ToString() == "PostgreSQL")
                                                        {
                                                            <option value="MSSQL">[[[SQL Server]]]</option>
                                                            <option value="PostgreSQL" selected="selected">[[[PostgreSQL]]]</option>
                                                        }
                                                    }
                                                    else
                                                    {
                                                        <option value="MSSQL">[[[SQL Server]]]</option>
                                                        <option value="PostgreSQL">[[[PostgreSQL]]]</option>
                                                    }
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </form>
                            <form id="sql-content-holder" class="no-padding content-display show-sql-content form-horizontal" method="post">
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">

                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Server name]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="txt-servername" name="servername" class="form-control" placeholder="[[[Server name]]]" value="@ViewBag.DbSettings.ServerName" />
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Authentication]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <select id="check-windows" class="selectpicker">
                                                @if (ViewBag.DbSettings.AuthenticationType == AuthenticationType.SqlServer)
                                                {
                                                    <option value="sql" selected="selected">[[[SQL authentication]]]</option>
                                                }
                                                else
                                                {
                                                    <option value="sql">[[[SQL authentication]]]</option>
                                                }
                                            </select>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Username]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="txt-login" name="username" class="form-control" placeholder="[[[Username]]]" value="@ViewBag.DbSettings.UserName" />
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Password]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" style="display: none;">
                                            <input type="password" id="txt-password-db" name="password" class="form-control" placeholder="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" autocomplete="off" />
                                            <span id="password-field" class="validation-txt-errors"></span>
                                            <div class="su su-eye show-hide-password"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Database name]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="txt-dbname" name="dbname" class="form-control system-settings-startup-page-fields dbname-fields db-fields" value="@ViewBag.databaseName" placeholder="[[[Existing Database name]]]" autocomplete="off">
                                            <div class="loader-blue loader-icon database-select-loader-icon display-none " id="sql-loader-icon">
                                                <svg class="circular">
                                                    <circle class="path" cx="27" cy="27" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"></circle>
                                                </svg>
                                            </div>
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-xs-12 form-group">
                                    @Html.Label("secure-sql-connection", "[[[Enable SSL]]]", new { @class = "app-textbox-label col-lg-2 col-md-2 col-sm-3 col-xs-4" })
                                    <div class="form-input-field col-lg-4 col-md-5 col-sm-6 col-xs-8 switch-align">
                                        <span class="material-switch text-left">
                                            <input type="checkbox" id="secure-sql-connection" name="secure-sql-connection" @((bool)@ViewBag.DbSettings.SslEnabled ? "checked" : string.Empty) />
                                            <label for="secure-sql-connection" class="label-primary"></label>
                                        </span>
                                    </div>
                                </div>
                            </form>
                            <form id="postgresql-content-holder" class="no-padding content-display show-postgresql-content form-horizontal" method="post">
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Server name]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="postgresql-servername" name="servername" class="form-control" placeholder="[[[Server name]]]" value="@ViewBag.DbSettings.ServerName" />
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Port]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="postgresql-port" name="port" class="form-control" placeholder="[[[Port]]]" value="@ViewBag.DbSettings.Port" />
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Username]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="postgresql-login" name="username" class="form-control" placeholder="[[[Username]]]" value="@ViewBag.DbSettings.UserName" />
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Password]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" style="display: none;">
                                            <input type="password" id="postgresql-password-db" name="password" class="form-control" placeholder="&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;&#9679;" autocomplete="off" />
                                            <span id="password-field" class="validation-txt-errors"></span>
                                            <div class="su su-eye show-hide-password"></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-12 form-group">
                                    <div class="col-md-6 no-padding no-margin">
                                        <label class="col-md-4 connect-database-padding txt-holder app-textbox-label">
                                            [[[Database name]]]
                                        </label>
                                        <div class="col-md-8 connect-database-padding txt-holder">
                                            <input type="text" id="postgresql-dbname" name="dbname" class="form-control system-settings-startup-page-fields dbname-fields db-fields" value="@ViewBag.databaseName" placeholder="[[[Existing Database name]]]" autocomplete="off">
                                            <div class="loader-blue loader-icon database-select-loader-icon display-none " id="postgresql-loader-icon">
                                                <svg class="circular">
                                                    <circle class="path" cx="27" cy="27" r="20" fill="none" stroke-width="4" stroke-miterlimit="10"></circle>
                                                </svg>
                                            </div>
                                            <span class="validation-txt-errors"></span>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-12 col-md-12 col-sm-12 col-xs-12 form-group">
                                    @Html.Label("secure-postgresql-connection", "[[[Enable SSL]]]", new { @class = "app-textbox-label col-lg-2 col-md-2 col-sm-3 col-xs-4" })
                                    <div class="form-input-field col-lg-4 col-md-5 col-sm-6 col-xs-8 switch-align">
                                        <span class="material-switch text-left">
                                            <input type="checkbox" id="secure-postgresql-connection" name="secure-postgresql-connection" @((bool)@ViewBag.DbSettings.SslEnabled ? "checked" : string.Empty) />
                                            <label for="secure-postgresql-connection" class="label-primary"></label>
                                        </span>
                                    </div>
                                </div>
                            </form>
                        </div>
                        @if (ViewBag.ThirdPartyLogins)
                        {
                            <div class="col-md-12 connection-properties-form">
                                <div class="col-md-6">
                                    <button type="button" id="test-connection" class="primary-button pull-right" disabled="disabled">[[[Test Connection]]]</button>
                                </div>
                                <div class="col-md-6 text-left connection-validation">
                                    <span id="test-connection-validation"></span>
                                </div>
                            </div>
                        }
                    </div>
                    <div id="selected-schema-container" class="col-xs-12 selected-schema-container admin-page-body" style="display: none">
                    </div>
                </div>
            </div>

            <div id="select-existing-join">
                <div class="col-xs-12 no-padding">
                    <div class="col-xs-12 no-padding">
                        <h3>[[[Select Relation]]]</h3>
                    </div>
                    <div class="col-xs-12 no-padding table-content">
                        <table class="relation-list"></table>
                    </div>
                </div>
                <div class="col-xs-12 btn-relation-holder">
                    <button type="button" id="select-relation" class="primary-button pull-right">[[[Apply]]]</button>
                </div>
            </div>

            <div id="get-join-details">
                <div class="col-xs-12 no-padding">
                    <div class="col-xs-12 no-padding">
                        <span class="join-dialog-title">[[[Form Relation]]]</span>
                    </div>
                    <div class="col-xs-12 no-padding relation-select-content">
                        <div class="col-xs-5 no-padding">
                            <h5>[[[Left table]]]</h5>
                            <div class="col-xs-12 no-padding">
                                <select id="left-table-selection" class="selectpicker"></select>
                            </div>
                            <div id="left-table-columnlist" class="col-xs-12 no-padding column-list">
                                <ul></ul>
                            </div>
                        </div>
                        <div class="col-xs-2 no-padding">
                            <div id="join-type-holder">
                                <select id="join-type" class="selectpicker">
                                    <option value="inner join">[[[Inner Join]]]</option>
                                    <option value="left join">[[[Left Join]]]</option>
                                </select>
                            </div>
                        </div>
                        <div class="col-xs-5 no-padding">
                            <h5>[[[Right table]]]</h5>
                            <div class="col-xs-12 no-padding">
                                <select id="right-table-selection" class="selectpicker" disabled="disabled"></select>
                            </div>
                            <div id="right-table-columnlist" class="col-xs-12 no-padding column-list">
                                <ul></ul>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="col-xs-12 btn-relation-holder">
                    <button type="button" id="apply-relation" class="primary-button pull-right" disabled="disabled">[[[Apply]]]</button>
                </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="auth-control-tab">
                <div id="auth-control-body" class="col-lg-12 col-md-12 col-sm-12 admin-page-body no-padding">
                    <form id="auth-control-form" name="authControlForm" class="auth-control-form col-lg-12 col-md-12 col-sm-12 no-padding" method="post" enctype="multipart/form-data" autocomplete="off">
                        @if (ServerAppConfig.IsSelfHosted)
                        {
                        <div class="col-md-12 form-group">
                            <div class="col-md-12 no-padding no-margin enable-global-default-label">
                                @Html.Label("enable-global-default", "[[[Enable Global Default Authentication]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        <input type="hidden" id="default-control-type" value="@AuthType.DefaultAuth">
                                        <input type="checkbox" id="enable-global-default" name="enableGlobalDefault" @(authControl == null || (authControl != null && authControl.Where(x => x.AuthType == AuthType.DefaultAuth).FirstOrDefault().IsEnabled) ? "checked" : string.Empty) />
                                        <label for="enable-global-default" class="label-primary"></label>
                                    </span>
                                </div>
                            </div>
                        </div>

                        <div class="col-md-12 form-group">
                            <div class="col-md-12 no-padding no-margin enable-global-oauth-label">
                                @Html.Label("enable-global-oauth", "[[[Enable Global OAuth Settings]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        <input type="hidden" id="oauth-control-type" value="@AuthType.OAuth">
                                        <input type="checkbox" id="enable-global-oauth" name="enableGlobalOauth" @(authControl == null || (authControl != null && authControl.Where(x => x.AuthType == AuthType.OAuth).FirstOrDefault().IsEnabled) ? "checked" : string.Empty) />
                                        <label for="enable-global-oauth" class="label-primary"></label>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-12 no-padding no-margin enable-global-openid-label">
                                @Html.Label("enable-global-openid", "[[[Enable Global OpendID Connect Settings]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        <input type="hidden" id="openid-control-type" value="@AuthType.OIDC">
                                        <input type="checkbox" id="enable-global-openid" name="enableGlobalOpenid" @(authControl == null || (authControl != null && authControl.Where(x => x.AuthType == AuthType.OIDC).FirstOrDefault().IsEnabled) ? "checked" : string.Empty) />
                                        <label for="enable-global-openid" class="label-primary"></label>
                                    </span>
                                </div>
                            </div>
                        </div>
                        }
                        else
                        {
                        <div class="col-md-12 form-group">
                            <div class="col-md-12 no-padding no-margin enable-global-external-providers-label">
                                @Html.Label("enable-global-external-providers", "[[[Enable Global External Providers]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        <input type="hidden" id="external-providers-type" value="@DirectoryType.All.ToString()">
                                        <input type="checkbox" id="enable-global-external-providers" name="enableGlobalExternalProviders" @(cloudAuthControl == null || cloudAuthControl.Settings == null || (cloudAuthControl != null && cloudAuthControl.Settings.Where(x => x.Name == DirectoryType.All.ToString()).FirstOrDefault().IsEnabled) ? "checked" : string.Empty) />
                                        <label for="enable-global-external-providers" class="label-primary"></label>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-12 login-option-dropdown no-padding">
                                <div class="col-md-4 no-padding">
                                    <label class="app-textbox-label col-md-11">[[[Allowed login providers]]]</label>
                                    <div class="col-xs-1 login-provider-info-tag">
                                        <span class="dropdown-toggle cursor-type" data-toggle="dropdown"><span class="su su-info" title=""></span></span>
                                        <div class="col-xs-2 dropdown-menu common-tooltip-info" role="menu">
                                            [[[Select the login providers that need to be shown in the login page.]]]
                                        </div>
                                    </div>
                                </div>
                                <div class="col-md-3 form-input-field">
                                    <select id="login-options" class="selectpicker" title="[[[Choose login providers]]]" multiple="" style="display:none">
                                        <option class="no-margin-dropdown-ul" value="AzureAD" selected="@(!loginOptions.HideAzureADLogin)">[[[Azure AD]]]</option>
                                        <option class="no-margin-dropdown-ul" value="SyncfusionLogin" selected="@(!loginOptions.HideSyncfusionLogin)">[[[Syncfusion Login]]]</option>
                                    </select>
                                </div>
                            </div>
                        </div>
                        }
                    </form>
                </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="oauth-settings-tab">
                <div id="oauth-page-body" class="col-lg-12 col-md-12 col-sm-12 admin-page-body no-padding">
                    <form id="oauth-setting" name="oauthSettingsForm" class="auth-settings-form col-lg-12 col-md-12 col-sm-12 no-padding" method="post" enctype="multipart/form-data" autocomplete="off">
                        <input type="hidden" name="oauthAuthenticationProvider" value="@ViewBag.OAuthSettings.AuthProvider">
                        <input type="hidden" name="oauthLogo" value="@ViewBag.OAuthSettings.OAuthAuthSettings.Logo">
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin enable-openid-label">
                                @Html.Label("enable-oauth", "[[[Enable OAuth 2.0]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        @if ((bool)ViewBag.OAuthSettings.IsEnabled)
                                        {
                                            <input type="checkbox" id="enable-oauth" name="oauthIsEnabled" ng-model="oauthIsEnabled" ng-init="oauthIsEnabled=true" ng-click="hideValidationMessage(oauthIsEnabled, 'oauth')" ng-checked=true />
                                        }
                                        else
                                        {
                                            <input type="checkbox" id="enable-oauth" name="oauthIsEnabled" ng-model="oauthIsEnabled" ng-init="oauthIsEnabled=false" ng-click="hideValidationMessage(oauthIsEnabled, 'oauth')" />
                                        }
                                        <label for="enable-oauth" class="label-primary"></label>
                                    </span>
                                    <span class="validation-message"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Provider Name]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthProviderName.$dirty && oauthSettingsForm.oauthProviderName.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthProviderName" ng-init="oauthProviderName='@ViewBag.OAuthSettings.OAuthAuthSettings.ProviderName'" name="oauthProviderName" placeholder="[[[Provider Name]]]" id="oauth-provider-name" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthProviderName.$error.required && oauthSettingsForm.oauthProviderName.$dirty && oauthIsEnabled">[[[Please enter the OAuth provider name.]]]</span>
                                </div>
                                <span id="oauth-provider-name-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Name of the authentication provider to be displayed in the login page.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Provider Logo]]]</label>
                                <div class="col-md-8 logo-container">
                                    <div id="oauth-image-upload-box" class="auth-image-upload-box">
                                        <div class="js-image-preview" style="background-image:{{oauthLogoUrl}}"></div>
                                        <div class="upload-options">
                                            <label>
                                                <span>[[[Change logo]]]</span>
                                                <input type="file" class="image-upload" accept="image/png,image/jpeg,image/svg+xml" ng-model="oauthLogoUrl" ng-init="oauthLogoUrl='@ViewBag.OAuthSettings.LogoUrl'" name="oauthLogoUrl" data-ng-disabled="!oauthIsEnabled" required />
                                            </label>
                                        </div>
                                    </div>
                                    <span id="oauth-logo-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Logo of the authentication provider to be displayed in the login page.]]]"></span>
                                    <span class="validation-message top-padding" ng-show="!oauthSettingsForm.isValidOAuthLogoUrl && oauthIsEnabled"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Authorization Endpoint]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthAuthorizationEP.$dirty && oauthSettingsForm.oauthAuthorizationEP.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthAuthorizationEP" ng-init="oauthAuthorizationEP='@ViewBag.OAuthSettings.OAuthAuthSettings.AuthorizationEndPoint'" ng-pattern="@oauthRegEx" name="oauthAuthorizationEP" placeholder="[[[Authorization Endpoint]]]" id="oauth-authorization-endpoint" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthAuthorizationEP.$error.required && oauthSettingsForm.oauthAuthorizationEP.$dirty && oauthIsEnabled">[[[Please enter the authorization endpoint.]]]</span>
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthAuthorizationEP.$error.pattern && oauthSettingsForm.oauthAuthorizationEP.$dirty && oauthIsEnabled">[[[Please enter a valid authorization endpoint.]]]</span>
                                </div>
                                <span id="oauth-auth-endpoint-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[An authorization URL where the resource owner grants authorization to the OAuth client to access protected resources.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Token Endpoint]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthTokenEP.$dirty && oauthSettingsForm.oauthTokenEP.$invalid) ? 'has-error' : ''">
                                    <select id="token-method-type" class="selectpicker method-type" data-ng-disabled="!oauthIsEnabled">
                                        <option class="no-margin-dropdown-ul" value="POST" selected="@(ViewBag.OAuthSettings.OAuthAuthSettings.TokenEndPointMethod == "POST")">[[[POST]]]</option>
                                        <option class="no-margin-dropdown-ul" value="GET" selected="@(ViewBag.OAuthSettings.OAuthAuthSettings.TokenEndPointMethod == "GET")">[[[GET]]]</option>
                                    </select>
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthTokenEP" ng-init="oauthTokenEP='@ViewBag.OAuthSettings.OAuthAuthSettings.TokenEndPoint'" ng-pattern="@oauthRegEx" name="oauthTokenEP" placeholder="[[[Token Endpoint]]]" id="oauth-token-endpoint" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthTokenEP.$error.required && oauthSettingsForm.oauthTokenEP.$dirty && oauthIsEnabled">[[[Please enter a token endpoint.]]]</span>
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthTokenEP.$error.pattern && oauthSettingsForm.oauthTokenEP.$dirty && oauthIsEnabled">[[[Please enter a valid token endpoint.]]]</span>
                                </div>
                                <span id="oauth-token-endpoint-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[A token request URL where the OAuth client exchanges an authorization grant for an access token.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[User Information Endpoint]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthUserInfoEP.$dirty && oauthSettingsForm.oauthUserInfoEP.$invalid) ? 'has-error' : ''">
                                    <select id="user-info-method-type" class="selectpicker method-type" data-ng-disabled="!oauthIsEnabled">
                                        <option class="no-margin-dropdown-ul" value="GET" selected="@(ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoEndPointMethod == "GET")">[[[GET]]]</option>
                                        <option class="no-margin-dropdown-ul" value="POST" selected="@(ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoEndPointMethod == "POST")">[[[POST]]]</option>
                                    </select>
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthUserInfoEP" ng-init="oauthUserInfoEP='@ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoEndPoint'" ng-pattern="@oauthRegEx" name="oauthUserInfoEP" placeholder="[[[User Information Endpoint]]]" id="oauth-userinfo-endpoint" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthUserInfoEP.$error.required && oauthSettingsForm.oauthUserInfoEP.$dirty && oauthIsEnabled">[[[Please enter the user information endpoint.]]]</span>
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthUserInfoEP.$error.pattern && oauthSettingsForm.oauthUserInfoEP.$dirty && oauthIsEnabled">[[[Please enter a valid user information endpoint.]]]</span>
                                </div>
                                <span id="oauth-user-info-endpoint-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[URL to retrieve the user information based on the token.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Client ID]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthClientId.$dirty && oauthSettingsForm.oauthClientId.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthClientId" ng-init="oauthClientId='@ViewBag.OAuthSettings.OAuthAuthSettings.ClientId'" name="oauthClientId" placeholder="[[[Client ID]]]" id="oauth-client-id" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthClientId.$error.required && oauthSettingsForm.oauthClientId.$dirty && oauthIsEnabled">[[[Please enter the client ID.]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Client Secret]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthClientSecret.$dirty && oauthSettingsForm.oauthClientSecret.$invalid) ? 'has-error' : ''">
                                    <input type="password" class="form-control col-md-6 no-margin" ng-model="oauthClientSecret" ng-init="oauthClientSecret" name="oauthClientSecret" placeholder="[[[Client Secret]]]" id="oauth-client-secret" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthClientSecret.$error.required && oauthSettingsForm.oauthClientSecret.$dirty && oauthIsEnabled">[[[Please enter the client secret.]]]</span>
                                    <div class="show-hide-password su su-eye"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Scopes]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.oauthScopes.$dirty && oauthSettingsForm.oauthScopes.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="oauthScopes" ng-init="oauthScopes='@ViewBag.OAuthSettings.OAuthAuthSettings.Scopes'" name="oauthScopes" placeholder="[[[Comma separated scopes]]]" id="oauth-scopes" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.oauthScopes.$error.required && oauthSettingsForm.oauthScopes.$dirty && oauthIsEnabled">[[[Please enter comma separated scopes.]]]</span>
                                </div>
                                <span id="oauth-scopes-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Scope is a mechanism in OAuth 2.0 to limit an application's access to a user's account. An application can request one or more scopes. This information is then presented to the user in the consent screen, and the access token issued to the application will be limited to the scopes granted.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Redirect URI]]]</label>
                                <div class="col-md-8 no-margin form-input-field">
                                    <input onClick="this.setSelectionRange(0, this.value.length)" id="oauth-callback-link" value="@(ServerAppConfig.InternalAppIdpUrl + AuthenticationConfig.OAuthCallabckUrl)" class="form-control col-md-6 no-margin" readonly />
                                    <div class="form-control su su-copy text focus" id="oauth-callback-link-copy" readonly="" data-original-title="[[[Click to copy]]]"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Mobile App Redirect URI]]]</label>
                                <div class="col-md-8 no-margin form-input-field">
                                    <input onClick="this.setSelectionRange(0, this.value.length)" id="oauth-mobile-callback-link" value="com.boldbi.dashboard://auth" class="form-control col-md-6 no-margin" readonly />
                                    <div class="form-control su su-copy text focus" id="oauth-mobile-callback-link-copy" readonly="" data-toggle="tooltip" data-original-title="[[[Click to copy]]]"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="section-title">
                                <span>[[[User data]]]</span>
                            </div>
                            <div class="col-md-6 section-info-message-container">
                                <span class="su su-info"></span>
                                <div class="section-info-message">[[[The user information endpoint returns claims about the authenticated user. These claims are normally represented by a JSON object that contains a collection of name and value pairs for each claim. Fill JSON keys with respect to the required details to identify the exact values.]]]</div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Email]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.userInfoEmail.$dirty && oauthSettingsForm.userInfoEmail.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="userInfoEmail" ng-init="userInfoEmail='@ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoEmail'" name="userInfoEmail" placeholder="[[[Email]]]" id="user-info-email" data-ng-disabled="!oauthIsEnabled" required />
                                    <span class="validation-message" ng-show="oauthSettingsForm.userInfoEmail.$error.required && oauthSettingsForm.userInfoEmail.$dirty && oauthIsEnabled">[[[Please enter the value for email.]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[First Name]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.userInfoFirstname.$dirty && oauthSettingsForm.userInfoFirstname.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="userInfoFirstname" ng-init="userInfoFirstname='@ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoFirstname'" name="userInfoFirstname" placeholder="[[[First Name]]]" id="user-info-firstname" data-ng-disabled="!oauthIsEnabled" />
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Last Name]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(oauthSettingsForm.userInfoLastname.$dirty && oauthSettingsForm.userInfoLastname.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="userInfoLastname" ng-init="userInfoLastname='@ViewBag.OAuthSettings.OAuthAuthSettings.UserInfoLastname'" name="userInfoLastname" placeholder="[[[Last Name]]]" id="user-info-lastname" data-ng-disabled="!oauthIsEnabled" />
                                </div>
                            </div>
                        </div>
                        <div id="oauth-group-import" class="group-import">
                            @await Html.PartialAsync("_AuthenticationGroupImportSettings", (AuthGroupImportSettings)ViewBag.OAuthSettings.OAuthAuthSettings.GroupImportSettings, new ViewDataDictionary(ViewData) { { "AuthType", AuthType.OAuth } })
                        </div>
                    </form>
                </div>
            </div>

            <div role="tabpanel" class="tab-pane" id="openid-settings-tab">
                <div id="openid-page-body" class="col-lg-12 col-md-12 col-sm-12 admin-page-body no-padding">
                    <form id="openid-setting" name="openidSettingsForm" class="auth-settings-form col-lg-12 col-md-12 col-sm-12 no-padding" method="post" enctype="multipart/form-data" autocomplete="off">
                        <input type="hidden" name="openidAuthenticationProvider" value="@ViewBag.OpenIDSettings.AuthProvider">
                        <input type="hidden" name="openidLogo" value="@ViewBag.OpenIDSettings.OIDCAuthSettings.Logo">
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin enable-openid-label">
                                @Html.Label("enable-openid", "[[[Enable OpenID Connect]]]", new { @class = "app-textbox-label col-md-4 no-margin" })
                                <div class="col-md-8 form-input-field pull-left switch-align">
                                    <span class="material-switch text-left">
                                        @if ((bool)ViewBag.OpenIDSettings.IsEnabled)
                                        {
                                            <input type="checkbox" id="enable-openid" name="openidIsEnabled" ng-model="openidIsEnabled" ng-init="openidIsEnabled=true" ng-click="hideValidationMessage(openidIsEnabled, 'openid')" ng-checked=true />
                                        }
                                        else
                                        {
                                            <input type="checkbox" id="enable-openid" name="openidIsEnabled" ng-model="openidIsEnabled" ng-init="openidIsEnabled=false" ng-click="hideValidationMessage(openidIsEnabled, 'openid')" />
                                        }
                                        <label for="enable-openid" class="label-primary"></label>
                                    </span>
                                    <span class="validation-message"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Provider Name]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(openidSettingsForm.openidProviderName.$dirty && openidSettingsForm.openidProviderName.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="openidProviderName" ng-init="openidProviderName='@ViewBag.OpenIDSettings.OIDCAuthSettings.ProviderName'" name="openidProviderName" placeholder="[[[Provider Name]]]" id="openid-provider-name" data-ng-disabled="!openidIsEnabled" required />
                                    <span class="validation-message" ng-show="openidSettingsForm.openidProviderName.$error.required && openidSettingsForm.openidProviderName.$dirty && openidIsEnabled">[[[Please enter the OpenID provider name.]]]</span>
                                </div>
                                <span id="openid-provider-name-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Name of the authentication provider to be displayed in the login page.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Provider Logo]]]</label>
                                <div class="col-md-8 logo-container">
                                    <div id="openid-image-upload-box" class="auth-image-upload-box">
                                        <div class="js-image-preview" style="background-image:{{openidLogoUrl}}"></div>
                                        <div class="upload-options">
                                            <label>
                                                <span>[[[Change logo]]]</span>
                                                <input type="file" class="image-upload" accept="image/png,image/jpeg,image/svg+xml" ng-model="openidLogoUrl" ng-init="openidLogoUrl='@ViewBag.OpenIDSettings.LogoUrl'" name="openidLogoUrl" data-ng-disabled="!openidIsEnabled" required />
                                            </label>
                                        </div>
                                    </div>
                                    <span id="openid-logo-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Logo of the authentication provider to be displayed in the login page.]]]"></span>
                                    <span class="validation-message top-padding" ng-show="!openidSettingsForm.isValidOpenIdLogoUrl && openidIsEnabled"></span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Authority]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(openidSettingsForm.openidAuthority.$dirty && openidSettingsForm.openidAuthority.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="openidAuthority" ng-init="openidAuthority='@ViewBag.OpenIDSettings.OIDCAuthSettings.Authority'" ng-pattern="@oauthRegEx" name="openidAuthority" placeholder="[[[Authority]]]" id="openid-authority" data-ng-disabled="!openidIsEnabled" required />
                                    <span class="validation-message" ng-show="openidSettingsForm.openidAuthority.$error.required && openidSettingsForm.openidAuthority.$dirty && openidIsEnabled">[[[Please enter the Authority URL.]]]</span>
                                    <span class="validation-message" ng-show="openidSettingsForm.openidAuthority.$error.pattern && openidSettingsForm.openidAuthority.$dirty && openidIsEnabled">[[[Please enter a valid Authority URL.]]]</span>
                                </div>
                                <span id="openid-authority-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[Endpoint to authenticate the user and grant access to the protected resource. It returns the claims about the authenticated user.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Client ID]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(openidSettingsForm.openidClientId.$dirty && openidSettingsForm.openidClientId.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="openidClientId" ng-init="openidClientId='@ViewBag.OpenIDSettings.OIDCAuthSettings.ClientId'" name="openidClientId" placeholder="[[[Client ID]]]" id="openid-client-id" data-ng-disabled="!openidIsEnabled" required />
                                    <span class="validation-message" ng-show="openidSettingsForm.openidClientId.$error.required && openidSettingsForm.openidClientId.$dirty && openidIsEnabled">[[[Please enter the Client ID.]]]</span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Client Secret]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(openidSettingsForm.openidClientSecret.$dirty && openidSettingsForm.openidClientSecret.$invalid) ? 'has-error' : ''">
                                    <input type="password" class="form-control col-md-6 no-margin" ng-model="openidClientSecret" ng-init="openidClientSecret" name="openidClientSecret" placeholder="[[[Client Secret]]]" id="openid-client-secret" data-ng-disabled="!openidIsEnabled" required />
                                    <span class="validation-message" ng-show="openidSettingsForm.openidClientSecret.$error.required && openidSettingsForm.openidClientSecret.$dirty && openidIsEnabled">[[[Please enter the client secret.]]]</span>
                                    <div class="show-hide-password su su-eye"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Identifier]]]</label>
                                <div class="col-md-8 no-margin form-input-field" ng-class="(openidSettingsForm.openidIdentifier.$dirty && openidSettingsForm.openidIdentifier.$invalid) ? 'has-error' : ''">
                                    <input type="text" class="form-control col-md-6 no-margin" ng-model="openidIdentifier" ng-init="openidIdentifier='@ViewBag.OpenIDSettings.OIDCAuthSettings.Identifier'" name="openidIdentifier" placeholder="[[[Identifier]]]" id="openid-identifier" data-ng-disabled="!openidIsEnabled" required />
                                    <span class="validation-message" ng-show="openidSettingsForm.openidIdentifier.$error.required && openidSettingsForm.openidIdentifier.$dirty && openidIsEnabled">[[[Please enter the Identifier.]]]</span>
                                </div>
                                <span id="openid-identifier-info" class="su su-info info-popup" data-toggle="popover" data-placement="bottom" data-html="true" data-content="[[[These claims are normally represented by a JSON object that contains a collection of name and value pairs for each claim. Provide the JSON key to identify the unique identity (email) of the user.]]]"></span>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Redirect URI]]]</label>
                                <div class="col-md-8 no-margin form-input-field">
                                    <input onClick="this.setSelectionRange(0, this.value.length)" id="openid-callback-link" value="@(ServerAppConfig.InternalAppIdpUrl + AuthenticationConfig.OidcCallabckUrl)" class="form-control col-md-6 no-margin" readonly />
                                    <div class="form-control su su-copy text focus" id="openid-callback-link-copy" readonly="" data-original-title="[[[Click to copy]]]"></div>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 form-group">
                            <div class="col-md-6 no-padding no-margin">
                                <label class="app-textbox-label col-md-4 no-margin">[[[Mobile App Redirect URI]]]</label>
                                <div class="col-md-8 no-margin form-input-field">
                                    <input onClick="this.setSelectionRange(0, this.value.length)" id="openid-mobile-callback-link" value="com.boldbi.dashboard://auth" class="form-control col-md-6 no-margin" readonly />
                                    <div class="form-control su su-copy text focus" id="openid-mobile-callback-link-copy" readonly="" data-toggle="tooltip" data-original-title="[[[Click to copy]]]"></div>
                                </div>
                            </div>
                        </div>
                        <div id="openid-group-import" class="group-import">
                            @await Html.PartialAsync("_AuthenticationGroupImportSettings", (AuthGroupImportSettings)ViewBag.OpenIDSettings.OIDCAuthSettings.GroupImportSettings, new ViewDataDictionary(ViewData) { { "AuthType", AuthType.OIDC } })
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    @if (ViewBag.ThirdPartyLogins)
    {
        <div class="admin-page-actions col-lg-12 col-md-12">
            <a href="@Url.Action("Index","Home")" class="secondary-button pull-right" id="cancel-active-dir-settings" title="">[[[Cancel]]]</a>
            <button type="submit" id="update-defaultauthlogin-settings" class="primary-button pull-right update-defaultauth-settings">[[[Save]]]</button>
            @if (!isAzureApplication && enableWindowsAD)
            {
                <button type="button" title="" id="update-active-dir-settings" name="UpdateSystemSettings" class="primary-button pull-right update-system-settings  @(!ServerAppConfig.IsSelfHosted ? " hidden" : string.Empty )" ng-disabled="windowsAdSettingsForm.$invalid" ng-click="">[[[Save]]]</button>
            }
            <button type="submit" id="update-auth-control" class="primary-button pull-right">[[[Save]]]</button>
            <button type="submit" id="update-oauth-settings" class="primary-button pull-right update-auth-settings" ng-disabled="oauthSettingsForm.$invalid">[[[Save]]]</button>
            <button type="submit" id="update-openid-settings" class="primary-button pull-right update-auth-settings" ng-disabled="openidSettingsForm.$invalid">[[[Save]]]</button>
            <button type="button" title="" id="UpdateAzureADSettings-bottom" name="UpdateSystemSettings" class="primary-button pull-right @(ServerAppConfig.IsSelfHosted ? " hidden" : string.Empty )" ng-disabled="azureAdSettingsForm.$invalid" ng-click="">[[[Save]]]</button>
            <button type="button" title="" id="save-db-settings" disabled="disabled" name="UpdateSystemSettings" class="primary-button pull-right">[[[Save]]]</button>
            <button type="button" id="connect-database" class="primary-button pull-right connect-database-button" disabled="disabled">[[[Next]]]</button>
            <button type="button" id="change-connection" class="primary-button  pull-right">[[[Back]]]</button>
        </div>
    }

</div>
