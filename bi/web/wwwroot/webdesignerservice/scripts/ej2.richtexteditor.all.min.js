/*!
*  filename: ej2.richtexteditor.all.min.js
*  version : 14.2.4.4
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function o(n,i){for(var f,r=t.extend({},n),u=0,e=Object.keys(r);u<e.length;u++)f=e[u],i.indexOf(f)<0&&t.deleteObject(r,f);return r}function ut(n,i){var f=40===i?0:n.childElementCount-1,r=f,e=n.querySelector(".e-selected"),u,o;for(e&&e.classList.remove("e-selected"),u=0,o=n.children.length;u<o;u++)n.children[u].classList.contains("e-focused")&&(r=u,n.children[u].classList.remove("e-focused"),40===i?r++:r--,r===(40===i?n.childElementCount:-1)&&(r=f));-1!==(r=ft(n,n.children[r],r,i))&&(t.addClass([n.children[r]],"e-focused"),n.children[r].focus())}function ft(n,t,i,r,u){if(void 0===u&&(u=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(i===(40===r?n.childElementCount-1:0)?i=40===r?0:n.childElementCount-1:40===r?i++:i--),(t=n.children[i]).classList.contains("e-separator")||t.classList.contains("e-disabled")){if(++u===n.childElementCount)return-1;i=ft(n,t,i,r,u)}return i}function et(n,i){var o=[].slice.call(n.getElementsByClassName("e-blank-icon")),r,u,f,s,e;(i&&[].slice.call(n.getElementsByClassName("e-item")).forEach(function(n){(n.style.paddingLeft||n.style.paddingRight)&&n.removeAttribute("style")}),o.length)&&(r=n.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)"),t.isNullOrUndefined(r)||(r.classList.contains("e-url")&&(r=r.querySelector(".e-menu-url")),f=r.querySelector(".e-menu-icon"),s=n.classList.contains("e-rtl"),u=s?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},e=parseInt(getComputedStyle(f).fontSize,10)+parseInt(getComputedStyle(f)[u.margin],10)+parseInt(getComputedStyle(r).paddingLeft,10)+"px",o.forEach(function(n){n.classList.contains("e-url")&&n.querySelector(".e-menu-url")?n.querySelector(".e-menu-url").style[u.padding]=e:n.style[u.padding]=e})))}function bt(n,i,r){var e,o,l,u,f,h,c,s;for(void 0===i&&(i={}),t.isNullOrUndefined(r)&&(r=t.createElement),f=document.querySelector(n),t.addClass([f],["e-btn-group","e-css"]),f.setAttribute("role","group"),h=f.children,i.buttons=i.buttons||[],c=0,s=0;s<h.length;c++,s++)e=h[s],null!==(u=i.buttons[c])&&("BUTTON"===e.tagName?o=e:(o=r("label"),(l=h[s+1])?f.insertBefore(o,l):f.appendChild(o),e.id&&o.setAttribute("for",e.id),u&&u.disabled&&(e.disabled=!0),s++),i.cssClass&&u&&!u.cssClass&&(u.cssClass=i.cssClass),new p.Button(u||{},o));return f}var a,v,y,rt,f,s,yt;a={};n.r(a);n.d(a,{AnimationSettings:()=>vt,Deferred:()=>g,DropDownButton:()=>k,DropDownMenuAnimationSettings:()=>ct,Item:()=>s,ProgressButton:()=>kt,SpinSettings:()=>at,SplitButton:()=>wt,createButtonGroup:()=>bt,getModel:()=>o,setBlankIconStyle:()=>et,upDownKeyHandler:()=>ut});v=n(864);const t=ejdashboard.base;rt=(y=function(n,t){return y=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},y(n,t)},function(n,t){function i(){this.constructor=n}y(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u};s=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return rt(i,n),f([t.Property("")],i.prototype,"iconCss",void 0),f([t.Property("")],i.prototype,"id",void 0),f([t.Property(!1)],i.prototype,"separator",void 0),f([t.Property("")],i.prototype,"text",void 0),f([t.Property("")],i.prototype,"url",void 0),f([t.Property(!1)],i.prototype,"disabled",void 0),i}(t.ChildProperty);const p=ejdashboard.buttons,h=ejdashboard.popups;var ot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},c="e-item",st="e-dropdown-popup",ht="e-separator",w="e-vertical",ct=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ot(r,n),i([t.Property("SlideDown")],r.prototype,"effect",void 0),i([t.Property(400)],r.prototype,"duration",void 0),i([t.Property("ease")],r.prototype,"easing",void 0),r}(t.ChildProperty),k=function(n){function r(t,i){var r=n.call(this,t,i)||this;return r.isPopupCreated=!0,r}return ot(r,n),r.prototype.preRender=function(){},r.prototype.getPersistData=function(){return this.addOnPersist([])},r.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.createPopupOnClick&&!this.isPopupCreated?(this.createPopup(),this.openPopUp()):this.closePopup()},r.prototype.render=function(){this.initialize();this.disabled||this.wireEvents();this.renderComplete()},r.prototype.addItems=function(n,t){for(var r,u,f=this.items.length,i=0,e=this.items.length;i<e;i++)if(t===this.items[i].text){f=i;break}for(r=n.length-1;r>=0;r--)u=new s(this,"items",n[r],!0),this.items.splice(f,0,u);this.canOpen()||this.createItems()},r.prototype.removeItems=function(n,t){for(var i,f,u=!1,r=0,e=n.length;r<e;r++)for(i=0,f=this.items.length;i<f;i++)if(n[r]===(t?this.items[i].id:this.items[i].text)){this.items.splice(i,1);u=!0;break}u&&this.getULElement()&&this.createItems()},r.prototype.createPopup=function(){var n,i=this.createElement("div",{className:"auto"!==this.popupWidth?st+" e-dropdown-popup-width":st,id:this.element.id+"-popup"}),r;(document.body.appendChild(i),this.dropDown=new h.Popup(i,{width:this.popupWidth,relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl}),this.dropDown.element.setAttribute("role","dialog"),this.dropDown.element.setAttribute("aria-label","dropdown menu"),t.isNullOrUndefined(this.popupContent)||(this.popupContent.style.display=""),"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element),this.dropDown.hide(),t.attributes(this.element,((n={})["aria-haspopup"]=this.items.length||this.target?"true":"false",n["aria-expanded"]="false",n.type="button",n)),this.cssClass&&t.addClass([i],this.cssClass.replace(/\s+/g," ").trim().split(" ")),this.isPopupCreated=!0,this.createPopupOnClick)&&(r=t.getComponent(this.activeElem[0],"split-btn"),r&&(r.isPopupCreated=!0))},r.prototype.getTargetElement=function(){return!this.createPopupOnClick||this.isColorPicker()||t.isNullOrUndefined(this.popupContent)?"string"==typeof this.target?t.select(this.target):this.target:this.popupContent},r.prototype.createItems=function(n){var h,i,r,e,o=this,l=this.items,a=this.hasIcon(this.items,"iconCss"),u=this.getULElement(),v,s,f,y;if(u?u.innerHTML="":u=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),this.itemTemplate)v=this.compiletemplate(this.itemTemplate),l.forEach(function(n){var i=o.createElement("li",{className:n.separator?c+" "+ht:c,attrs:n.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":n.text},id:n.id?n.id:t.getUniqueID("e-"+o.getModuleName()+"-item")}),f=v(n,o,"template",null,!1,null,i),r;f&&t.append(f,i);n.disabled&&i.classList.add("e-disabled");r={item:n,element:i};o.trigger("beforeItemRender",r);r.item.disabled!==n.disabled&&i.classList[r.item.disabled?"add":"remove"]("e-disabled");u.appendChild(i)}),this.isReact&&this.renderReactTemplates();else for(s=0;s<l.length;s++)i=l[s],this.enableHtmlSanitizer&&(i.text=t.SanitizeHtmlHelper.sanitize(i.text)),f=i.text,r=this.createElement("li",{innerHTML:i.url?"":f,className:i.separator?c+" "+ht:c,attrs:i.separator?{role:"separator",tabindex:"-1","aria-label":"separator","aria-hidden":"true"}:{role:"menuitem",tabindex:"-1","aria-label":f},id:i.id?i.id:t.getUniqueID("e-"+this.getModuleName()+"-item")}),this.enableHtmlSanitizer?r.textContent=i.url?"":f:r.innerHTML=i.url?"":f,i.url&&(r.appendChild(this.createAnchor(i)),r.classList.add("e-url")),i.iconCss?(h=this.createElement("span",{className:"e-menu-icon "+i.iconCss}),i.url?r.childNodes[0].appendChild(h):r.insertBefore(h,r.childNodes[0])):a&&!i.separator&&r.classList.add("e-blank-icon"),y=i.disabled,i.disabled&&r.classList.add("e-disabled"),e={item:i,element:r},this.trigger("beforeItemRender",e),y!==e.item.disabled&&(e.item.disabled?r.classList.add("e-disabled"):r.classList.remove("e-disabled")),u.appendChild(r);n&&this.getPopUpElement().appendChild(u);a&&et(this.getPopUpElement())},r.prototype.compiletemplate=function(n){if(this.itemTemplate)try{if("function"!=typeof this.itemTemplate){var i=document.querySelector(this.itemTemplate);if(i)return t.compile(i.innerHTML.trim())}return t.compile(n)}catch(i){return t.compile(n)}},r.prototype.hasIcon=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i][""+t])return!0;return!1},r.prototype.createAnchor=function(n){var i=n.text,t=this.createElement("a",{className:"e-menu-text e-menu-url",attrs:{href:n.url}});return this.enableHtmlSanitizer?t.textContent=i:t.innerHTML=i,t},r.prototype.initialize=function(){this.button=new p.Button({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence});this.button.createElement=this.createElement;this.button.appendTo(this.element);this.element.id||(this.element.id=t.getUniqueID("e-"+this.getModuleName()));this.appendArrowSpan();this.setActiveElem([this.element]);this.element.setAttribute("tabindex","0");this.element.setAttribute("aria-label",this.element.textContent?this.element.textContent:"dropdownbutton");this.target&&!this.isColorPicker()&&!this.createPopupOnClick||!this.createPopupOnClick?this.createPopup():(this.isPopupCreated=!1,this.target&&!this.isColorPicker()&&this.createPopupOnClick&&(this.popupContent=this.getTargetElement(),this.popupContent.style.display="none"))},r.prototype.isColorPicker=function(){if(!this.element)return!1;var n=this.element.previousSibling;return!!(n&&n.classList&&n.classList.contains("e-split-colorpicker"))},r.prototype.appendArrowSpan=function(){this.cssClass=t.isNullOrUndefined(this.cssClass)?"":this.cssClass;this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(w)>-1?"bottom":"right")+" e-caret"}))},r.prototype.setActiveElem=function(n){this.activeElem=n},r.prototype.getModuleName=function(){return"dropdown-btn"},r.prototype.canOpen=function(){var n=!1;return this.isPopupCreated&&(n=this.getPopUpElement().classList.contains("e-popup-close")),n},r.prototype.destroy=function(){var i,r=this;n.prototype.destroy.call(this);"dropdown-btn"===this.getModuleName()&&(this.element.querySelector("span.e-caret")&&t.detach(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&t.removeClass([this.element],i),t.removeClass(this.activeElem,["e-active"]),(this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"]).forEach(function(n){r.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents())},r.prototype.destroyPopup=function(){var n,r,i;this.isPopupCreated&&((this.dropDown.destroy(),this.getPopUpElement())&&(n=document.getElementById(this.getPopUpElement().id),n&&(t.removeClass([n],["e-popup-open","e-popup-close"]),t.detach(n))),t.EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler),t.EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler),this.isPopupCreated&&this.dropDown&&(this.dropDown.element=null,this.dropDown=void 0));this.isPopupCreated=!1;r=t.getComponent(this.activeElem[0],"split-btn");this.createPopupOnClick&&r&&(i=t.getComponent(this.activeElem[1],"dropdown-btn"),i&&(i.isPopupCreated=!1))},r.prototype.getPopUpElement=function(){var i=null,n;return!this.dropDown&&this.activeElem[0].classList.contains("e-split-btn")&&(n=t.getComponent(this.activeElem[1],"dropdown-btn"),n&&(this.dropDown=n.dropDown)),this.dropDown&&(i=this.dropDown.element),i},r.prototype.getULElement=function(){var n=null;return this.getPopUpElement()&&(n=this.getPopUpElement().children[0]),n},r.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this);this.createPopupOnClick||t.EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this);t.EventHandler.add(this.element,"click",this.clickHandler,this);t.EventHandler.add(this.element,"keydown",this.keyBoardHandler,this);t.EventHandler.add(window,"resize",this.windowResize,this)},r.prototype.windowResize=function(){!this.canOpen()&&this.dropDown&&this.dropDown.refreshPosition(this.element)},r.prototype.popupWireEvents=function(){this.delegateMousedownHandler||(this.delegateMousedownHandler=this.mousedownHandler.bind(this));var n=this.getPopUpElement();this.createPopupOnClick&&t.EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this);n&&(t.EventHandler.add(n,"click",this.clickHandler,this),t.EventHandler.add(n,"keydown",this.keyBoardHandler,this),this.closeActionEvents&&t.EventHandler.add(n,this.closeActionEvents,this.focusoutHandler,this));this.rippleFn=t.rippleEffect(n,{selector:"."+c})},r.prototype.popupUnWireEvents=function(){var n=this.getPopUpElement();this.createPopupOnClick&&t.EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler);n&&n.parentElement&&(t.EventHandler.remove(n,"click",this.clickHandler),t.EventHandler.remove(n,"keydown",this.keyBoardHandler),this.closeActionEvents&&t.EventHandler.remove(n,this.closeActionEvents,this.focusoutHandler));t.isRippleEnabled&&this.rippleFn&&this.rippleFn()},r.prototype.keyBoardHandler=function(n){if(n.target!==this.element||9!==n.keyCode&&(n.altKey||40!==n.keyCode)&&38!==n.keyCode)switch(n.target&&(n.target.classList.contains("e-item")||n.target.parentElement&&n.target.parentElement.classList.contains("e-split-btn-wrapper"))&&13===n.keyCode&&n.preventDefault(),n.keyCode){case 38:case 40:!n.altKey||38!==n.keyCode&&40!==n.keyCode?this.upDownKeyHandler(n):this.keyEventHandler(n);break;case 9:case 13:case 27:case 32:this.keyEventHandler(n)}},r.prototype.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},r.prototype.upDownKeyHandler=function(n){this.target&&(38===n.keyCode||40===n.keyCode)||(n.preventDefault(),ut(this.getULElement(),n.keyCode))},r.prototype.keyEventHandler=function(n){if(!this.target||13!==n.keyCode&&9!==n.keyCode)return 13===n.keyCode&&this.activeElem[0].classList.contains("e-split-btn")?(this.triggerSelect(n),void this.activeElem[0].focus()):void(n.target&&n.target.className.indexOf("e-edit-template")>-1&&32===n.keyCode||(9!==n.keyCode&&n.preventDefault(),27===n.keyCode||38===n.keyCode||9===n.keyCode?this.canOpen()||this.closePopup(n,this.element):this.clickHandler(n)))},r.prototype.getLI=function(n){return"LI"===n.tagName?n:t.closest(n,"li")},r.prototype.mousedownHandler=function(n){var i=n.target;!this.dropDown||this.canOpen()||!this.getPopUpElement()||t.closest(i,'[id="'+this.getPopUpElement().id+'"]')||t.closest(i,'[id="'+this.element.id+'"]')||this.closePopup(n)},r.prototype.focusoutHandler=function(n){var t,i,u,r,f;this.isPopupCreated&&!this.canOpen()&&(t=n.relatedTarget||n.target,t&&t.className.indexOf("e-item")>-1&&(i=this.getLI(t),i&&(u=Array.prototype.indexOf.call(this.getULElement().children,i),r=this.items[u],r&&(f={element:i,item:r,event:n},this.trigger("select",f)))),this.closePopup(n))},r.prototype.clickHandler=function(n){var i=n.target;t.closest(i,'[id="'+this.element.id+'"]')?!this.createPopupOnClick||this.target&&""!==this.target&&!this.isColorPicker()&&!this.createPopupOnClick?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(n):this.closePopup(n):this.isPopupCreated?this.closePopup(n,this.activeElem[0]):(this.createPopup(),this.openPopUp(n)):t.closest(i,'[id="'+this.getPopUpElement().id+'"]')&&this.getLI(n.target)&&(this.triggerSelect(n),this.closePopup(n,this.activeElem[0]))},r.prototype.triggerSelect=function(n){var i,r,u,t=this.getLI(n.target);t&&(r=Array.prototype.indexOf.call(this.getULElement().children,t),(u=this.items[r])&&(i={element:t,item:u,event:n},this.trigger("select",i)))},r.prototype.openPopUp=function(n){var i=this,r,u,f,e;void 0===n&&(n=null);r=this.getPopUpElement();(this.activeElem[0]&&this.activeElem[0].classList.contains("e-dropdown-btn")&&r.style.width&&"auto"!==r.style.width&&this.setWidth(r),this.target)?this.activeElem.length>1?(u=t.getComponent(this.activeElem[0],"split-btn"),u.isReact&&r.childNodes.length<1&&(u.appendReactElement&&u.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates())):this.isReact&&r.childNodes.length<1&&(this.appendReactElement&&this.appendReactElement(this.getTargetElement(),this.getPopUpElement()),this.renderReactTemplates()):this.createItems(!0);f=this.getULElement();this.popupWireEvents();e={element:f,items:this.items,event:n,cancel:!1};this.trigger("beforeOpen",e,function(n){var r,f,e,o,u,s;n.cancel||(r=i.getULElement(),f="None"!==i.animationSettings.effect?{name:i.animationSettings.effect,duration:i.animationSettings.duration,timingFunction:i.animationSettings.easing}:null,(f&&i.animatePopup(f,r),i.dropDown.show(null,i.element),t.addClass([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),i.element.setAttribute("aria-owns",i.getPopUpElement().id),r&&!i.isSafari()&&r.focus(),i.enableRtl&&"0px"!==r.parentElement.style.left)&&(e=i.element.parentElement&&i.element.parentElement.classList.contains("e-split-btn-wrapper")?i.element.parentElement.offsetWidth:i.element.offsetWidth,o=r.parentElement.offsetWidth-e,u=parseFloat(r.parentElement.style.left)-o,u<0&&(u=0),r.parentElement.style.left=u+"px"),s={element:r,items:i.items},i.trigger("open",s),r&&i.isSafari()&&r.focus())})},r.prototype.animatePopup=function(n,i){new t.Animation(n).animate(i,{begin:function(n){n.element.parentElement.style.height=n.element.parentElement.offsetHeight+"px"}})},r.prototype.setWidth=function(n){var i=t.formatUnit(n.style.width),r;i.indexOf("%")>-1&&(r=this.element.offsetWidth*parseFloat(i)/100,n.style.width=r+"px")},r.prototype.closePopup=function(n,i){var r=this,u,f;void 0===n&&(n=null);u=this.getULElement();f={element:u,items:this.items,event:n,cancel:!1};this.trigger("beforeClose",f,function(f){var s,e,o,h;f.cancel?f.element&&u.focus():(s=r.getPopUpElement(),s&&t.EventHandler.remove(s,"keydown",r.keyBoardHandler),r.popupUnWireEvents(),e=r.getULElement(),o=void 0,e&&(o=e.querySelector(".e-selected")),o&&o.classList.remove("e-selected"),r.dropDown&&r.dropDown.hide(),t.removeClass(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),r.element.removeAttribute("aria-owns"),i&&(r.isSafari()?i.focus({preventScroll:!0}):r.isColorPicker()&&27===n.keyCode||i.focus()),h={element:e,items:r.items},r.trigger("close",h),!r.target&&e&&t.detach(e),(!r.target||r.isColorPicker()||r.target&&!r.isColorPicker())&&r.createPopupOnClick&&r.destroyPopup())})},r.prototype.unWireEvents=function(){this.createPopupOnClick||t.EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler);t.EventHandler.remove(this.element,"click",this.clickHandler);t.EventHandler.remove(this.element,"keydown",this.keyBoardHandler);this.isPopupCreated&&(t.EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler),t.EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler));t.EventHandler.remove(window,"resize",this.windowResize)},r.prototype.onPropertyChanged=function(n,i){var u,r,f,e;for(this.button.setProperties(o(n,["content","cssClass","iconCss","iconPosition","disabled","enableRtl"])),this.isPopupCreated&&(u=this.getPopUpElement(),this.dropDown.setProperties(o(n,["enableRtl"]))),r=0,f=Object.keys(n);r<f.length;r++)switch(f[r]){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":n.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":(i.cssClass=t.isNullOrUndefined(i.cssClass)?"":i.cssClass,n.cssClass.indexOf(w)>-1||i.cssClass.indexOf(w)>-1)&&(this.element.querySelector("span.e-caret")||this.appendArrowSpan(),e=this.element.querySelector("span.e-caret"),n.cssClass.indexOf(w)>-1?t.classList(e,["e-icon-bottom"],["e-icon-right"]):t.classList(e,["e-icon-right"],["e-icon-bottom"]));this.isPopupCreated&&(i.cssClass&&t.removeClass([u],i.cssClass.split(" ")),n.cssClass&&t.addClass([u],n.cssClass.replace(/\s+/g," ").trim().split(" ")));break;case"target":this.dropDown.content=this.getTargetElement();this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":n.createPopupOnClick?this.destroyPopup():this.createPopup()}},r.prototype.focusIn=function(){this.element.focus()},i([t.Property("")],r.prototype,"content",void 0),i([t.Property("")],r.prototype,"cssClass",void 0),i([t.Property(!1)],r.prototype,"disabled",void 0),i([t.Property("")],r.prototype,"iconCss",void 0),i([t.Property("Left")],r.prototype,"iconPosition",void 0),i([t.Property(!0)],r.prototype,"enableHtmlSanitizer",void 0),i([t.Collection([],s)],r.prototype,"items",void 0),i([t.Property(!1)],r.prototype,"createPopupOnClick",void 0),i([t.Property("")],r.prototype,"target",void 0),i([t.Property("")],r.prototype,"closeActionEvents",void 0),i([t.Property(null)],r.prototype,"itemTemplate",void 0),i([t.Property("auto")],r.prototype,"popupWidth",void 0),i([t.Complex({effect:"None"},ct)],r.prototype,"animationSettings",void 0),i([t.Event()],r.prototype,"beforeItemRender",void 0),i([t.Event()],r.prototype,"beforeOpen",void 0),i([t.Event()],r.prototype,"beforeClose",void 0),i([t.Event()],r.prototype,"close",void 0),i([t.Event()],r.prototype,"open",void 0),i([t.Event()],r.prototype,"select",void 0),i([t.Event()],r.prototype,"created",void 0),i([t.NotifyPropertyChanges],r)}(t.Component),pt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},b="e-rtl",d="EJS-SPLITBUTTON",wt=function(n){function i(t,i){return n.call(this,t,i)||this}return pt(i,n),i.prototype.preRender=function(){var n=this.element;if(n.tagName===d){for(var f=t.getValue("ej2_instances",n),u=this.createElement("button",{attrs:{type:"button"}}),r=this.createElement(d,{className:"e-"+this.getModuleName()+"-wrapper"}),i=0,e=n.attributes.length;i<e;i++)u.setAttribute(n.attributes[i].nodeName,n.attributes[i].nodeValue);n.parentNode.insertBefore(r,n);t.detach(n);n=u;r.appendChild(n);t.setValue("ej2_instances",f,n);this.wrapper=r;this.element=n}this.element.id||(this.element.id=t.getUniqueID("e-"+this.getModuleName()))},i.prototype.render=function(){this.initWrapper();this.createPrimaryButton();this.renderControl()},i.prototype.renderControl=function(){this.createSecondaryButton();this.setActiveElem([this.element,this.secondaryBtnObj.element]);this.setAria();this.wireEvents();this.renderComplete()},i.prototype.addItems=function(t,i){n.prototype.addItems.call(this,t,i);this.secondaryBtnObj.items=this.items},i.prototype.removeItems=function(t,i){n.prototype.removeItems.call(this,t,i);this.secondaryBtnObj.items=this.items},i.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element));this.element.classList.remove("e-"+this.getModuleName());this.enableRtl&&this.wrapper.classList.add(b);this.cssClass&&t.addClass([this.wrapper],this.cssClass.replace(/\s+/g," ").trim().split(" "))},i.prototype.createPrimaryButton=function(){var n={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new p.Button(n);this.primaryBtnObj.createElement=this.createElement;this.primaryBtnObj.appendTo(this.element);this.element.classList.add("e-"+this.getModuleName());this.element.type="button";this.wrapper.appendChild(this.element)},i.prototype.createSecondaryButton=function(){var n=this,t=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"}),i;this.wrapper.appendChild(t);i={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick,beforeItemRender:function(t){n.createPopupOnClick&&(n.secondaryBtnObj.dropDown.relateTo=n.wrapper,n.dropDown=n.secondaryBtnObj.dropDown);n.trigger("beforeItemRender",t)},open:function(t){n.trigger("open",t)},close:function(t){n.trigger("close",t)},select:function(t){n.trigger("select",t)},beforeOpen:function(t){n.createPopupOnClick&&0===n.items.length&&(n.secondaryBtnObj.dropDown.relateTo=n.wrapper,n.dropDown=n.secondaryBtnObj.dropDown);var i=new g;return n.trigger("beforeOpen",t,function(n){i.resolve(n)}),i},beforeClose:function(t){var i=new g;return n.trigger("beforeClose",t,function(n){i.resolve(n)}),i}};this.secondaryBtnObj=new k(i);this.secondaryBtnObj.createElement=this.createElement;this.secondaryBtnObj.appendTo(t);this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown);this.isPopupCreated=this.secondaryBtnObj.isPopupCreated;this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element];this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right");this.disabled&&this.wrapper.classList.add("e-splitbtn-disabled")},i.prototype.setAria=function(){t.attributes(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent?this.element.textContent+" splitbutton":"splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},i.prototype.getModuleName=function(){return"split-btn"},i.prototype.toggle=function(){this.secondaryBtnObj.toggle()},i.prototype.destroy=function(){var u=this,i=[b],r;(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element)&&(r=document.getElementById(this.element.id),r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===d?(this.wrapper.innerHTML="",t.removeClass([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),t.removeClass([this.wrapper],this.cssClass.split(" "))):(t.removeClass([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){u.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),t.remove(this.wrapper)),this.unWireEvents()));this.primaryBtnObj.destroy();this.secondaryBtnObj.destroy();n.prototype.destroy.call(this);this.element&&!this.element.getAttribute("class")&&this.element.removeAttribute("class");this.refreshing&&this.isAngular&&(this.element=this.wrapper,["e-control","e-split-btn","e-lib"].forEach(function(n){u.element.classList.add(n)}),t.setValue("ej2_instances",[this],this.element));this.wrapper=null},i.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.primaryBtnClickHandler,this);new t.KeyboardEvents(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow",enter:"enter"}})},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.element,"click",this.primaryBtnClickHandler);t.getInstance(this.element,t.KeyboardEvents).destroy()},i.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},i.prototype.btnKeyBoardHandler=function(n){switch(n.action){case"altdownarrow":this.clickHandler(n);break;case"enter":this.clickHandler(n);this.getPopUpElement()&&!this.getPopUpElement().classList.contains("e-popup-close")?(this.element.classList.remove("e-active"),this.secondaryBtnObj.element.classList.add("e-active")):this.secondaryBtnObj.element.classList.remove("e-active")}},i.prototype.onPropertyChanged=function(n,i){var u=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"],r,f;for(this.primaryBtnObj.setProperties(o(n,u)),u=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(n).indexOf("items")>-1&&(this.secondaryBtnObj.items=n.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(o(n,u)),r=0,f=Object.keys(n);r<f.length;r++)switch(f[r]){case"cssClass":i.cssClass&&t.removeClass([this.wrapper],i.cssClass.split(" "));t.addClass([this.wrapper],n.cssClass.replace(/\s+/g," ").trim().split(" "));break;case"enableRtl":n.enableRtl?t.addClass([this.wrapper],b):t.removeClass([this.wrapper],b);break;case"disabled":n.disabled?t.addClass([this.wrapper],"e-splitbtn-disabled"):t.removeClass([this.wrapper],"e-splitbtn-disabled")}},i.prototype.focusIn=function(){this.element.focus()},u([t.Property("")],i.prototype,"content",void 0),u([t.Property("")],i.prototype,"cssClass",void 0),u([t.Property(!1)],i.prototype,"disabled",void 0),u([t.Property("")],i.prototype,"iconCss",void 0),u([t.Property("Left")],i.prototype,"iconPosition",void 0),u([t.Property(!1)],i.prototype,"createPopupOnClick",void 0),u([t.Collection([],s)],i.prototype,"items",void 0),u([t.Property("")],i.prototype,"target",void 0),u([t.Event()],i.prototype,"beforeItemRender",void 0),u([t.Event()],i.prototype,"beforeOpen",void 0),u([t.Event()],i.prototype,"beforeClose",void 0),u([t.Event()],i.prototype,"click",void 0),u([t.Event()],i.prototype,"close",void 0),u([t.Event()],i.prototype,"open",void 0),u([t.Event()],i.prototype,"select",void 0),u([t.Event()],i.prototype,"created",void 0),u([t.NotifyPropertyChanges],i)}(k),g=function(){return function(){var n=this;this.promise=new Promise(function(t,i){n.resolve=t;n.reject=i});this.catch=this.promise.catch.bind(this.promise);this.then=this.promise.then.bind(this.promise)}}();var nt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},tt="e-hide-spinner",lt="e-progress",l="e-progress-active",e="e-btn-content",at=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return nt(i,n),r([t.Property(null)],i.prototype,"template",void 0),r([t.Property(16)],i.prototype,"width",void 0),r([t.Property("Left")],i.prototype,"position",void 0),i}(t.ChildProperty),vt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return nt(i,n),r([t.Property(400)],i.prototype,"duration",void 0),r([t.Property("None")],i.prototype,"effect",void 0),r([t.Property("ease")],i.prototype,"easing",void 0),i}(t.ChildProperty),kt=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.step=1,r}return nt(i,n),i.prototype.preRender=function(){n.prototype.preRender.call(this)},i.prototype.render=function(){n.prototype.render.call(this);this.init();this.wireEvents();this.setAria();this.renderComplete()},i.prototype.start=function(n){this.isPaused=!1;this.startProgress(n||this.percent,this.progressTime)},i.prototype.stop=function(){this.isPaused=!0;cancelAnimationFrame(this.timerId)},i.prototype.progressComplete=function(){this.isPaused=!1;this.finishProgress()},i.prototype.getModuleName=function(){return"progress-btn"},i.prototype.destroy=function(){var r=this,i=[tt,l,"e-round-corner","e-"+n.prototype.getModuleName.call(this)];this.spinSettings.position&&i.push("e-spin-"+this.spinSettings.position.toLowerCase());n.prototype.destroy.call(this);this.unWireEvents();this.element.innerHTML="";this.cssClass&&(i=i.concat(this.cssClass.split(" ")));t.removeClass([this.element],i);(this.element.getAttribute("class")?["aria-label","aria-valuemin","aria-valuemax","aria-valuenow"]:["aria-label","aria-valuemin","aria-valuemax","aria-valuenow","class"]).forEach(function(n){r.element.removeAttribute(n)});this.disabled&&this.element.removeAttribute("disabled")},i.prototype.init=function(){this.element.classList.add("e-"+n.prototype.getModuleName.call(this));this.setContent();this.createSpinner();this.enableProgress&&this.createProgress()},i.prototype.createSpinner=function(){var n=this.createElement("span",{className:"e-spinner"});this.setSpinPosition(n);h.createSpinner({target:n,width:this.spinSettings.width||16,template:this.spinSettings.template},this.createElement)},i.prototype.getSpinner=function(){return this.element.getElementsByClassName("e-spinner")[0]},i.prototype.getProgress=function(){return this.element.getElementsByClassName(lt)[0]},i.prototype.setSpinPosition=function(n){var t=this.spinSettings.position||"Left";"Left"===t||"Top"===t?this.element.insertBefore(n,this.element.getElementsByClassName(e)[0]):this.element.appendChild(n);this.element.classList.add("e-spin-"+t.toLowerCase())},i.prototype.createProgress=function(){this.element.appendChild(this.createElement("span",{className:lt}))},i.prototype.setContent=function(){var n;n=this.element.innerHTML;this.enableHtmlSanitizer&&(n=t.SanitizeHtmlHelper.sanitize(this.element.innerHTML));this.element.innerHTML="";this.element.appendChild(this.createElement("span",{className:e,innerHTML:n}))},i.prototype.clickHandler=function(){this.element.classList.contains(l)||this.startProgress()},i.prototype.startProgress=function(n,t){var i=this.element.classList,r=i.contains("e-vertical");i.add(l);i.contains(tt)||h.showSpinner(this.element.querySelector(".e-spinner"));this.startAnimate(Date.now(),t||0,t?Date.now()-this.duration/100:Date.now(),n||0,0,this.step,0,r);this.startContAnimate()},i.prototype.startAnimate=function(n,t,i,r,u,f,e,o){var a=this,l;try{var s=n-i,c=this.duration*f/100,h=s?s<c?s-c:s%c:0;this.progressTime=t=t+s-h;i=n-h;r+=(s-h)/this.duration*100;l={percent:u=(t-e)%c==0||100===r?r:u,currentDuration:t,step:f};this.eIsVertical=o;0===r?this.trigger("begin",l,function(n){a.successCallback(n,r,u,t,e,h,i)}):100===r||t===this.duration?this.trigger("end",l,function(n){a.successCallback(n,r,u,t,e,h,i)}):this.trigger("progress",l,function(n){a.successCallback(n,r,u,t,e,h,i)})}catch(n){cancelAnimationFrame(this.timerId);this.trigger("fail",n)}},i.prototype.successCallback=function(n,t,i,r,u,f,e){var o=this,s=t,c=i,v=f,h=r,l=u,y=e,a=this.eIsVertical;s!==n.percent&&n.percent!==c&&(s=n.percent);this.percent=s;this.step=n.step;(h-l)%(this.duration*n.step/100)!=0&&100!==s||(this.timerId=requestAnimationFrame(function(){o.enableProgress&&o.getProgress()&&(o.getProgress().style[a?"height":"width"]=s+"%");o.element.setAttribute("aria-valuenow",s.toString())}),c=s,l=h);this.isPaused||(this.interval=h<this.duration&&s<100?window.setTimeout(function(){o.startAnimate(Date.now(),h,y,s,c,n.step,l,a)},this.duration/100-v):window.setTimeout(function(){o.progressTime=o.percent=0;o.enableProgress&&o.getProgress()&&(o.getProgress().style[a?"height":"width"]="0%");o.element.setAttribute("aria-valuenow","0");o.hideSpin()},100))},i.prototype.startContAnimate=function(){var n=this,i=this.element.getElementsByClassName(e)[0];"None"!==this.animationSettings.effect?new t.Animation({}).animate(i,{duration:0===this.animationSettings.duration&&"Enable"===t.animationMode?400:this.animationSettings.duration,name:"Progress"+this.animationSettings.effect,timingFunction:this.animationSettings.easing,begin:function(){"Center"===n.spinSettings.position&&n.setSpinnerSize()},end:function(){i.classList.add("e-animate-end")}}):"Center"===this.spinSettings.position&&this.setSpinnerSize()},i.prototype.finishProgress=function(){var t=this.element.classList,r=t.contains("e-vertical"),n,i;for(t.add(l),n=this.percent;n<100;n++)(n+=10)>100&&(n=100),this.enableProgress&&this.getProgress()&&(this.getProgress().style[r?"height":"width"]=this.percent<100?n+"%":"100%");this.element.setAttribute("aria-valuenow","0");this.hideSpin();i={step:this.step,currentDuration:this.progressTime,percent:100};clearTimeout(this.interval);this.trigger("end",i);this.progressTime=this.percent=0},i.prototype.setSpinnerSize=function(){var t=this.element.getElementsByClassName(e)[0],n=this.getSpinner();n.style.width=Math.max(n.offsetWidth,t.offsetWidth)+"px";n.style.height=Math.max(n.offsetHeight,t.offsetHeight)+"px";t.classList.add("e-cont-animate")},i.prototype.hideSpin=function(){var t=this.element.getElementsByClassName(e)[0],n;(this.element.classList.contains(tt)||h.hideSpinner(this.element.querySelector(".e-spinner")),this.element.classList.remove(l),"None"!==this.animationSettings.effect&&t.classList.remove("e-animate-end"),"Center"===this.spinSettings.position)&&(n=this.getSpinner(),t.classList.remove("e-cont-animate"),n.style.width="auto",n.style.height="auto")},i.prototype.setIconSpan=function(){var n=this.element.getElementsByClassName(e)[0],t=this.element.getElementsByClassName("e-btn-icon")[0];!n.childNodes[0]||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?n.appendChild(t):n.insertBefore(t,n.childNodes[0])},i.prototype.setAria=function(){t.attributes(this.element,{"aria-label":this.element.textContent+" progress"})},i.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.clickHandler,this)},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.element,"click",this.clickHandler)},i.prototype.onPropertyChanged=function(i,r){var u=this.element,e=!1,f,o;for(this.element.querySelector(".e-spinner-pane").classList.contains("e-spin-show")&&(e=!0),n.prototype.onPropertyChanged.call(this,i,r),f=0,o=Object.keys(i);f<o.length;f++)switch(o[f]){case"content":this.setContent();this.createSpinner();e&&(h.showSpinner(this.element.querySelector(".e-spinner")),e=!1);this.enableProgress&&this.createProgress();u.setAttribute("aria-label",u.textContent+" progress");break;case"iconCss":r.iconCss||this.setIconSpan();break;case"iconPosition":this.setIconSpan();break;case"enableProgress":i.enableProgress?this.createProgress():t.remove(this.getProgress());break;case"spinSettings":i.spinSettings.position&&(u.classList.remove("e-spin-"+r.spinSettings.position.toLowerCase()),this.setSpinPosition(this.getSpinner()));(i.spinSettings.template||i.spinSettings.width)&&(u.removeChild(this.getSpinner()),this.createSpinner())}},i.prototype.focusIn=function(){this.element.focus()},r([t.Property(!1)],i.prototype,"enableProgress",void 0),r([t.Property(2e3)],i.prototype,"duration",void 0),r([t.Property("Left")],i.prototype,"iconPosition",void 0),r([t.Property("")],i.prototype,"iconCss",void 0),r([t.Property(!1)],i.prototype,"disabled",void 0),r([t.Property(!1)],i.prototype,"isPrimary",void 0),r([t.Property("")],i.prototype,"cssClass",void 0),r([t.Property("")],i.prototype,"content",void 0),r([t.Property(!1)],i.prototype,"isToggle",void 0),r([t.Property(!0)],i.prototype,"enableHtmlSanitizer",void 0),r([t.Complex({},at)],i.prototype,"spinSettings",void 0),r([t.Complex({},vt)],i.prototype,"animationSettings",void 0),r([t.Event()],i.prototype,"created",void 0),r([t.Event()],i.prototype,"begin",void 0),r([t.Event()],i.prototype,"progress",void 0),r([t.Event()],i.prototype,"end",void 0),r([t.Event()],i.prototype,"fail",void 0),r([t.NotifyPropertyChanges],i)}(p.Button),it={};v.C(it,a);yt={splitbuttons:it=v.C(window.ejdashboard?window.ejdashboard.splitbuttons:{},it)};window.ejdashboard=v.C(window.ejdashboard||{},yt)})()})();(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function ow(n,t){var o=/\.\S+/.test(n),s=/\.\S+/.test(t),i,r,u,f,e;if(o&&!s)return 1;if(!o&&s)return-1;for(i=[],r=[],(n+"").replace(/(\d+)|(\D+)/g,function(n,t,r){return i.push([t||1/0,r||""]),""}),(t+"").replace(/(\d+)|(\D+)/g,function(n,t,i){return r.push([t||1/0,i||""]),""});i.length&&r.length;)if(u=i.shift(),f=r.shift(),u&&f&&(e=u[0]-f[0]||u[1].localeCompare(f[1]),e))return e;return i.length-r.length}function bf(n,i,r){var u=t.getValue("name",i),f=n.getAttribute("data-id"),e=t.isNullOrUndefined(f)?u:f;r.setProperties({path:po(n,e,r.hasId)},!0);r.pathId=wo(n);r.pathNames=ov(n,u)}function po(n,t,i){for(var u=bo(n,t,!1,i),f="/",r=u.length-2;r>=0;r--)f+=u[r]+"/";return f}function wo(n){for(var i=bo(n,n.getAttribute("data-uid"),!0),r=[],t=i.length-1;t>=0;t--)r.push(i[t]);return r}function ov(n,t){for(var r=bo(n,t,!1),u=[],i=r.length-1;i>=0;i--)u.push(r[i]);return u}function bo(n,i,r,u){for(var o,e=[i],f=n.parentNode;!t.isNullOrUndefined(f);)if(t.matches(f,"."+w)&&(o=r?f.getAttribute("data-uid"):u?f.getAttribute("data-id"):t.select("."+hf,f).textContent,e.push(o)),(f=f.parentNode).classList.contains(no))break;return e}function sv(n){for(var u,f=n.hasId?"id":"name",r="/",i=1;i<n.pathId.length;i++)u=t.getValue(n.pathId[parseInt(i.toString(),10)],n.feParent),r+=t.getValue(f,u)+"/";n.setProperties({path:r},!0)}function ko(n){n.isCut&&(ut(n),n.selectedNodes=[],n.actionRecords=[],n.enablePaste=!1,n.notify(ou,{}))}function nc(n,i){var u,r,f;if(i.isSearchCut=!1,i.actionRecords=[],i.activeElements=[],i.notify(gi,{}),0===i.activeElements.length)return!1;if(ut(i),u=i.activeElements,i.targetPath="navigationpane"!==i.activeModule?i.path:ne(i.path),r=0,u&&(df(i,u[0]),"cut"===n))for(;r<u.length;)kf(u[r]),r++;for(r=0,i.selectedNodes=[],i.enablePaste=!0,i.notify(oo,{});r<i.activeRecords.length;)i.actionRecords.push(i.activeRecords[r]),i.selectedNodes.push(t.getValue("name",i.activeRecords[r])),r++;if((""!==i.breadcrumbbarModule.searchObj.element.value||i.isFiltered)&&"navigationpane"!==i.activeModule)for(i.selectedNodes=[],i.isSearchCut=!0,f=0;f<i.selectedItems.length;)i.selectedNodes.push(i.selectedItems[f]),f++;return!0}function kf(n){n.classList.add(ur)}function ut(n,t){for(var r=t?n.element.querySelectorAll("."+nu):n.element.querySelectorAll("."+ur),i=0;i<r.length;)r[i].classList.remove(t?nu:ur),i++}function df(n,i){i&&(n.activeModule=i.classList.contains(de)?"detailsview":t.closest(i,"."+vf)?"largeiconsview":"navigationpane")}function tc(n,t){var r=n.fileSystemData.filter(function(n){return String(n.parentId)===String(t)}),i=r.slice();return r.forEach(function(t){var r=t.id;i=i.concat(tc(n,r))}),i}function gf(n,i,r){var f,e,s;if(0!==i.length||n.isFiltered||n.notify(vr,{args:n}),d(n))if(""===i)n.itemData=n.fileSystemData,o(n,r?g:ei,n.path);else{n.searchSettings.filterType=t.isNullOrUndefined(n.searchSettings.filterType)?"contains":n.searchSettings.filterType;var h=t.getValue(n.pathId[n.pathId.length-1],n.feParent),c=tc(n,t.getValue("id",h)),l=new u.DataManager(c).executeLocal((new u.Query).where("name",n.searchSettings.filterType,i,n.searchSettings.ignoreCase)),v=n.searchSettings.ignoreCase?i.toLowerCase():i;n.itemData=l;n.responseData.error=null;vs(n,r?g:ei,n.path,v,n.showHiddenItems,!n.searchSettings.ignoreCase)}else(f="startsWith"===n.searchSettings.filterType?i+"*":"endsWith"===n.searchSettings.filterType?"*"+i:"*"+i+"*",n.searchWord=f,n.itemData=[a(n)],i.length>0)?(e=n.searchSettings.ignoreCase,s=n.showHiddenItems,vs(n,r?g:ei,n.path,f,s,!e)):n.isFiltered?ls(n,g):n.isSortByClicked?(n.notify(g,{files:"Details"===n.oldView?n.detailsviewModule.gridObj.dataSource:n.largeiconsviewModule.allItems}),n.isSortByClicked=!1):o(n,r?g:ei,n.path)}function at(n,t){n.oldView=n.view;n.setProperties({view:t},!0);(""!==n.breadcrumbbarModule.searchObj.element.value||n.isFiltered)&&(n.layoutSelectedItems=n.selectedItems);var i="";n.breadcrumbbarModule.searchObj.element.value&&(i=n.breadcrumbbarModule.searchObj.element.value);n.isLayoutChange=!0;gf(n,i,!0)}function ic(n,i){var r="";i&&(r=t.closest(i,"."+ca+"."+la+" ."+da)?"detailsview":t.closest(i,"."+sf)?"largeiconsview":i.classList.contains("e-fullrow")||i.classList.contains("e-icon-expandable")?"navigationpane":t.closest(i,".e-address-list-item")?"breadcrumbbar":"");n.targetModule=r}function ti(n){n.itemData=[a(n)];wu(n.itemData[0])?o(n,bt,n.path):e(n,n.itemData[0],vo)}function rc(n){o(n,kt,n.path)}function a(n){return t.getValue(n.pathId[n.pathId.length-1],n.feParent)}function lu(n){nc("copy",n)&&(n.fileAction="copy")}function au(n){nc("cut",n)&&(n.isCut=!0,n.fileAction="move")}function vu(n){if(!t.getValue("isFile",n))return fr;var i=t.getValue("type",n);return-1!==(i=i.toLowerCase()).indexOf(".")&&(i=i.split(".").join("")),-1!==["bmp","dib","jpg","jpeg","jpe","jfif","gif","tif","tiff","png","ico"].indexOf(i)?af:-1!==["mp3","wav","aac","ogg","wma","aif","fla","m4a"].indexOf(i)?wa:-1!==["webm","mkv","flv","vob","ogv","ogg","avi","wmv","mp4","3gp"].indexOf(i)?ba:-1!==["css","exe","html","js","msi","pdf","pptx","ppt","rar","zip","txt","docx","doc","xlsx","xls","xml","rtf","php"].indexOf(i)?"e-fe-"+i:"e-fe-unknown e-fe-"+i}function go(n,i){var r=d(n)?t.getValue("imageUrl",i):"",f,c,l,s;if(d(n))return f={fileDetails:[i],imageUrl:r,useImageAsUrl:!0},n.trigger("beforeImageLoad",f),f;var u=n.ajaxSettings.getImageUrl?n.ajaxSettings.getImageUrl:n.ajaxSettings.url,e=-1!==u.indexOf("?")?"&path=":"?path=",o=encodeURIComponent(t.getValue("name",i)),h=t.getValue("filterPath",i);return n.hasId?(c=t.getValue("id",i),r=u+e+n.path+"&id="+c):r=t.isNullOrUndefined(h)?u+e+n.path+o:u+e+encodeURIComponent(h.replace(/\\/g,"/"))+o,r=r+"&time="+(new Date).getTime().toString(),l={action:"getImage",path:n.path+o,id:t.getValue("id",i)},s={fileDetails:[i],imageUrl:r,useImageAsUrl:!0,ajaxSettings:{url:u,type:"POST",contentType:"application/json",responseType:"blob",data:JSON.stringify(l),onSuccess:null,onFailure:null,beforeSend:null}},n.trigger("beforeImageLoad",s),s}function yu(n,i,r){var u=t.getValue(n.hasId?"id":"name",i)+"/",f=t.getValue(n.hasId?"filterId":"filterPath",i);return t.isNullOrUndefined(f)?r+u:f.replace(/\\/g,"/").replace(/^.*?(?=\/)/,"")+u}function uc(n,i){var r=t.getValue("name",i),u=t.getValue("filterPath",i);return""===n.breadcrumbbarModule.searchObj.element.value&&!n.isFiltered||t.isNullOrUndefined(u)||(r=(u=u.replace(/\\/g,"/")).replace(n.path,"")+r),r}function vt(n,i){var r,f;return 0===i.length?i:(r="None"===n.sortOrder||t.isNullOrUndefined(n.sortOrder)?(new u.Query).group("isFile"):(new u.Query).sortBy(n.sortBy,n.sortOrder.toLowerCase(),!0).group("isFile"),f=new u.DataManager(i).executeLocal(r),t.getValue("records",f))}function fc(n,i,r){return t.getValue(n.pathId[n.pathId.length-1],n.feFiles).filter(function(n){return n[i].toString()===r})[0]}function ec(n,r,u){var f,o=t.select("#"+n.element.id+ps,n.element),h=t.select("#"+n.element.id+gr,o).offsetHeight,s;if(f=o.offsetHeight-h,"Details"===n.view&&(f-=t.select("."+rh,o).offsetHeight),t.isNullOrUndefined(r.querySelector("."+k))){var e=t.createElement("div",{className:k}),c=t.createElement("div",{className:ka}),l=t.createElement("div",{className:ru}),a=t.createElement("div",{className:uu});"Details"===n.view?r.querySelector("."+or).appendChild(e):r.appendChild(e);e.appendChild(c);e.appendChild(l);e.appendChild(a)}r.querySelector("."+k)&&(t.isNullOrUndefined(u.error)?n.isFiltered?(r.querySelector("."+ru).innerHTML=i(n,"Filter-Empty"),r.querySelector("."+uu).innerHTML=i(n,"Filter-Key")):""!==n.breadcrumbbarModule.searchObj.element.value?(r.querySelector("."+ru).innerHTML=i(n,"Search-Empty"),r.querySelector("."+uu).innerHTML=i(n,"Search-Key")):(r.querySelector("."+ru).innerHTML=i(n,"Folder-Empty"),r.querySelector("."+uu).innerHTML=null==n.uploadObj.dropArea?i(n,""):i(n,"File-Upload")):(r.querySelector("."+ru).innerHTML=i(n,"Access-Denied"),r.querySelector("."+uu).innerHTML=i(n,"Access-Details")));s=t.select("."+k,r);f=(f-s.offsetHeight)/2;s.style.marginTop=f+"px"}function oc(n){return new u.DataManager(n).executeLocal((new u.Query).where(ev,"equal",!1,!1))}function hv(n,i){for(var u=oc(n.files),r=0,f=u.length;r<f;r++)t.setValue("_fm_id",i+"_"+r,u[r])}function cv(n){for(var r,u,i=0;i<n.length;i++)r=new Date(t.getValue("dateCreated",n[i])),u=new Date(t.getValue("dateModified",n[i])),t.setValue("_fm_created",r,n[i]),t.setValue("_fm_modified",u,n[i])}function i(n,t){var i=n.localeObj.getConstant(t);return""===i?t:i}function yt(n,i){var r=n.cssClass;return t.isNullOrUndefined(r)||""===r?i:r+" "+i}function sc(n,t){n.isSortByClicked=!0;-1!==t.item.id.indexOf("ascending")||-1!==t.item.id.indexOf("descending")||-1!==t.item.id.indexOf("none")?n.sortOrder=hc(t.item.id):n.sortBy=hc(t.item.id,n);n.itemData=[a(n)];"Details"===n.view&&(n.isMobile?at(n,"Details"):(n.notify(wf,{module:"detailsview"}),n.isSortByClicked=!1));"LargeIcons"===n.view&&at(n,"LargeIcons");n.notify(dt,{})}function hc(n,t){var u,f=n.substring(n.lastIndexOf("_")+1),i=f,r,e;switch(t&&(u=t.detailsViewSettings.columns),f){case"date":for(r=0,e=u.length;r<e;r++){if("dateModified"===u[r].field||"dateCreated"===u[r].field){i=u[r].field;break}i="_fm_modified"}break;case"ascending":i="Ascending";break;case"descending":i="Descending";break;case"none":i="None"}return i}function cc(n,i){for(var s=i.split("/"),u=n.originalPath.split("/"),h=t.getValue(n.pathId[0],n.feParent),c=t.isNullOrUndefined(t.getValue("id",h))?"name":"id",r=s.length-1,l=u.length-1;r<l;r++){var a=""===u[r+1]?tt:fi,v=""===u[r]?"/":n.path+u[r]+"/",f=fc(n,c,u[parseInt(r.toString(),10)]),e=t.getValue("_fm_id",f);n.setProperties({path:v},!0);t.isNullOrUndefined(e)||n.pathId.push(e);n.itemData=[f];n.pathNames.push(t.getValue("name",f));o(n,a,n.path);break}}function lc(n,i){var f;n.originalPath=yu(n,i,n.path);var e=t.getValue(n.pathId[0],n.feParent),u=n.feParent[t.getValue("_fm_id",n.itemData[0])],s=t.isNullOrUndefined(u)||"fe_tree"===t.getValue("_fm_id",u),r=fc(n,t.isNullOrUndefined(t.getValue("id",e))?"name":"id",d(n)?t.getValue("id",i):t.getValue("name",i));if(t.isNullOrUndefined(r)){if(s)return void cc(n,n.path);n.notify(yf,{selectedNode:n.pathId[n.pathId.length-1]})}else f=t.getValue("_fm_id",r),n.setProperties({path:n.originalPath},!0),n.pathId.push(f),n.itemData=[r],n.pathNames.push(t.getValue("name",r));o(n,n.path!==n.originalPath?fi:tt,n.path)}function pu(n){if(n.isDragDrop=!1,0!==n.selectedNodes.length&&n.enablePaste){var t=""===n.folderPath?n.path:n.folderPath;"navigationpane"!==n.activeModule||n.selectedNodes[0].includes("/")||(n.targetPath=cs(n,n.actionRecords[0]));ac(n,n.actionRecords,t,n.path)||("move"===n.fileAction&&n.targetPath!==t||"copy"===n.fileAction?(n.notify(ci,{}),ue(n,n.targetPath,n.selectedNodes,t,n.fileAction,[],n.actionRecords)):(n.enablePaste=!1,n.notify(ou,{}),ut(n),s(n,"Error",{files:null,error:{code:"402",message:i(n,"Same-Folder-Error"),fileExists:null}})))}}function ac(n,r,u,f){for(var l,a,o=!1,e=0;e<r.length;e++)if(t.getValue("isFile",r[e])){var v=n.dragData[e]?n.dragData[e].name:null,h=d(n)?v:n.dragNodes[e],c=0;if(h&&(c=h.lastIndexOf("/")),l="",c>0&&(l=f+h.substring(0,c+1)),l===u){s(n,"Error",{files:null,error:{code:"402",message:i(n,"Same-Folder-Error"),fileExists:null}});o=!0;break}}else if(a=yu(n,r[e],f),0===u.indexOf(a)){s(n,"Error",{files:null,error:{code:"402",message:i(n,"Sub-Folder-Error"),fileExists:null}});o=!0;break}return o}function lv(n){n.isDragDrop=!0;0!==n.dragData.length&&(n.dragPath=n.dragPath.replace(/\\/g,"/"),n.dropPath=n.dropPath.replace(/\\/g,"/"),ac(n,n.dragData,n.dropPath,n.dragPath)||n.dragPath===n.dropPath||(n.itemData=[n.dropData],ue(n,n.dragPath,n.dragNodes,n.dropPath,"move",[],n.dragData),n.notify(ci,{})))}function ne(n){for(var t=n.split("/"),r=t[0]+"/",i=1;i<t.length-2;i++)r+=t[i]+"/";return r}function ns(n,i){var u=t.getValue(n.hasId?"id":"name",i.cwd)+"/",r=t.getValue(n.hasId&&!t.isNullOrUndefined(n.ajaxSettings.url)?"filterId":"filterPath",i.cwd);return!t.isNullOrUndefined(r)&&d(n)&&""!==r&&"\\"!==r&&(r="\\"+i.cwd.parentId+"\\"),t.isNullOrUndefined(r)?d(n)?u:n.path+u:""===r?"/":r.replace(/\\/g,"/").replace(/^.*?(?=\/)/,"")+u}function ts(n,t,i){"move"===t&&(n.isDragDrop?n.notify(lo,i):(n.enablePaste=!1,n.notify(ou,{}),n.notify(so,i)));0===n.duplicateItems.length&&(n.pasteNodes=[]);for(var r=0;r<i.files.length;r++)n.pasteNodes.push(i.files[r][n.hasId?"id":"name"]),n.isDragDrop&&n.droppedObjects.push(i.files[r]);n.duplicateItems=[];n.duplicateRecords=[];n.isDropEnd=n.isDragDrop&&!n.isPasteError?!0:!1;n.trigger("success",{action:t,result:i});!n.isDragDrop||n.path===n.dragPath||n.path===n.dropPath||n.isSearchDrag?(n.isPathDrag=!1,o(n,et,n.path)):vc(n)}function vc(n){var i=t.getValue("_fm_id",n.dropData),r;(n.expandedId=i,n.itemData=[n.dropData],n.isPathDrag)?n.notify(uo,n.itemData):(n.navigationpaneModule&&(r=t.select('[data-uid="'+i+'"]',n.navigationpaneModule.treeObj.element),r||(i=document.querySelector('[data-id = "'+t.getValue("id",n.dropData)+'"]').getAttribute("data-uid"),r=t.select('[data-uid="'+i+'"]',n.navigationpaneModule.treeObj.element)),bf(r,n.dropData,n)),o(n,ni,n.dropPath))}function av(n,i){for(var f=null,u=n.isDragDrop?n.dragData:n.actionRecords,r=0;r<u.length;r++)if(t.getValue("name",u[r])===i){f=u[r];break}return f}function is(n){var t,i,u;if(n.isSearchDrag=!1,""!==n.breadcrumbbarModule.searchObj.element.value&&(n.isSearchDrag=!0),"navigationpane"!==n.activeModule){for(n.dragNodes=[],t=0;t<n.selectedItems.length;)n.dragNodes.push(n.selectedItems[t]),t++;0===n.selectedItems.length&&n.dragData&&1===n.dragData.length&&n.dragNodes.push(li(n,n.dragData[0]))}var f=n.createElement("div",{className:"e-fe-icon "+vu(n.dragData[0])}),e=n.createElement("div",{className:"e-fe-name",innerHTML:n.dragData[0].name}),r=n.createElement("div",{className:"e-fe-content"});r.appendChild(f);r.appendChild(e);i=n.createElement("div",{className:ge});(i.appendChild(r),n.dragNodes.length>1)&&(u=n.createElement("span",{className:"e-fe-count",innerHTML:n.dragNodes.length.toString(10)}),i.appendChild(u));n.virtualDragElement=i;n.element.appendChild(n.virtualDragElement)}function rs(n,i){var r=i,u;r.cancel=!1;null!=n.treeExpandTimer&&(window.clearTimeout(n.treeExpandTimer),n.treeExpandTimer=null);pc(n);n.element.classList.remove("e-fe-drop","e-no-drop");ut(n);n.uploadObj.dropArea=t.select("#"+n.element.id+dr,n.element);u=t.select("."+ge,n.element);u&&t.detach(u);ic(n,i.target);n.notify(gt,i);ut(n,"hover");r.fileDetails=n.dragData;n.trigger("fileDragStop",r,function(i){!i.cancel&&!t.isNullOrUndefined(n.targetModule)&&""!==n.targetModule&&n.dragCount>2&&lv(n);n.dragCount=0})}function us(n,i,r){var u=i,f;if(u.cancel=!1,u.fileDetails=n.dragData,n.dragCount=0,n.droppedObjects=[],(!n.allowDragAndDrop||"navigationpane"===n.activeModule&&t.closest(i.element,"li").getAttribute("data-uid")===n.pathId[0])&&(u.cancel=!0),n.isPathDrag="navigationpane"===n.activeModule&&-1!==n.pathId.indexOf(t.closest(i.element,"li").getAttribute("data-uid"))?!0:!1,ut(n),u.cancel)r.intDestroy(i.event),yc(n);else if(!u.cancel){for(f=0;f<n.activeElements.length;)kf(n.activeElements[f]),f++;n.trigger("fileDragStart",u,function(t){t.cancel?(r.intDestroy(i.event),yc(n)):n.uploadObj.dropArea=null})}}function yc(n){ut(n);var i=t.select("."+ge,n.element);i&&t.detach(i)}function pc(n){wc(n,lf);wc(n,ih)}function wc(n,t){for(var r=n.element.querySelectorAll("."+t),i=0;i<r.length;i++)r[i].classList.remove(t)}function fs(n,i,r,u){var e,o=n.getBoundingClientRect(),f=t.select("."+r,n);u>=o.top+n.clientHeight-30&&!t.isNullOrUndefined(f)&&(e="navigationpane"===i.targetModule||"detailsview"===i.targetModule?f.offsetHeight/2.5:f.offsetHeight/4.5,n.scrollBy(0,e));!t.isNullOrUndefined(f)&&u<=o.top+30&&(e="navigationpane"===i.targetModule||"detailsview"===i.targetModule?f.offsetHeight/2.5:f.offsetHeight/4.5,n.scrollBy(0,-e))}function es(n,i){var f=i,u,r;f.fileDetails=n.dragData;u=!1;ic(n,i.target);pc(n);null!=n.treeExpandTimer&&(window.clearTimeout(n.treeExpandTimer),n.treeExpandTimer=null);ut(n,"hover");r=null;"navigationpane"===n.targetModule?((r=t.closest(i.target,"li")).classList.add(nu,lf),u=!0,n.treeExpandTimer=window.setTimeout(function(){n.notify(ao,i)},800),fs(n.navigationpaneModule.treeObj.element.parentElement,n,"e-level-2",i.event.y)):"detailsview"===n.targetModule?((r=t.closest(i.target,"tr"))&&r.querySelector("."+fr)&&!r.classList.contains(ur)?r.classList.add(lf):!r||r.querySelector("."+fr)||r.classList.contains(ur)||r.classList.add(ih),u=!0,fs(n.detailsviewModule.gridObj.element.querySelector(".e-content"),n,"e-row",i.event.y)):"largeiconsview"===n.targetModule?((r=t.closest(i.target,"li"))&&r.querySelector("."+fr)&&!r.classList.contains(ur)&&r.classList.add(nu,lf),u=!0,fs(n.largeiconsviewModule.element.firstElementChild,n,"e-large-icon",i.event.y)):"breadcrumbbar"===n.targetModule&&(u=!0);n.element.classList.remove("e-fe-drop","e-no-drop");n.element.classList.add(u?"e-fe-drop":"e-no-drop");n.dragCount=n.dragCount+1;n.trigger("fileDragging",f)}function vv(n){for(var u="",r=Object.keys(n),i=0;i<r.length;i++)"message"!==r[i]&&(u+=(0===i?"":", ")+r[i]+": "+t.getValue(r[i],n));return u}function li(n,i){return n.hasId?t.getValue("id",i):uc(n,i)}function te(n,i){n.itemData=[i];n.currentItemText=t.getValue("name",i);n.isFile=t.getValue("isFile",i);n.filterPath=t.getValue("filterPath",i)}function ie(n){p(n.itemData[0])?s(n,"Rename"):e(n,n.itemData[0],rt)}function bc(n){for(var i=n.itemData,t=0;t<i.length;t++)if(!bu(i[t]))return void e(n,i[t],cu);n.selectedItems.length>0&&nf(n,n.path,n.selectedItems)}function kc(n,t,i){for(var r=0;r<t.length;r++)if(!p(t[r]))return void e(n,t[r],rt);n.itemData=t;fe(n,i,n.path,"delete")}function dc(n,t,i){for(var r=0;r<t.length;r++)if(!bu(t[r]))return void e(n,t[r],cu);n.itemData=t;i.length>0&&nf(n,n.path,i)}function e(n,r,u){var f=t.getValue("message",t.getValue("permission",r));""===f&&(f=i(n,"Access-Message").replace("{0}",t.getValue("name",r)).replace("{1}",u));s(n,"Error",{error:{code:"401",fileExists:null,message:f}})}function re(n){return wu(n)?"e-fe-locked":"e-fe-locked e-fe-hidden"}function wu(n){var i=t.getValue("permission",n);return!(i&&!t.getValue("read",i))}function p(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("write",i)}function os(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("writeContents",i)}function gc(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("upload",i)}function bu(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("download",i)}function ss(n){var t=n.itemData[0];os(t)?s(n,"NewFolder"):e(n,t,yo)}function hs(n){var t=n.itemData[0],i;gc(t)?(i="#"+n.element.id+ff,document.querySelector(i).click()):e(n,t,gh)}function yv(n){t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide()}function cs(n,i){return n.hasId&&!t.isNullOrUndefined(t.getValue("filterId",i))?t.getValue("filterId",i).replace(/\\/g,"/").replace(/^[^/]+\//,"/"):t.getValue("filterPath",i).replace(/\\/g,"/")}function nl(n,r,u,f){for(var e,h,o="",s=0;s<r.length;s++)if(e=t.getValue("permission",r[s]),(null==e&&(e=void 0),f)?!e||t.getValue("read",e)&&t.getValue("writeContents",e)||""===(o=t.getValue("message",t.getValue("permission",r[s])))&&(o=i(n,"Access-Message").replace("{0}",t.getValue("name",r[s])).replace("{1}","writeContents")):(h="copy"===u?t.getValue("copy",e):t.getValue("write",e),!e||t.getValue("read",e)&&h||""===(o=t.getValue("message",t.getValue("permission",r[s])))&&(o=i(n,"Access-Message").replace("{0}",t.getValue("name",r[s])).replace("{1}",u))),""!==o){n.responseData={cwd:null,details:null,error:{code:"401",message:o,fileExists:null},files:null};break}return o}function o(n,i,r){for(var u=n.itemData,f=0;f<u.length;f++)t.isNullOrUndefined(t.getValue("hasChild",u[f]))&&t.setValue("hasChild",!1,u[f]);nr(n,{action:"read",path:r,showHiddenItems:n.showHiddenItems,data:u},hw,i)}function tl(n,t){nr(n,{action:"create",path:n.path,name:t,data:n.itemData},lw,t)}function ls(n,i){var r={action:"filter",path:n.path,showHiddenItems:n.showHiddenItems,data:[a(n)]},u=n.filterData?t.extend(void 0,r,n.filterData):r;nr(n,u,cw,i,t.getValue("action",u))}function ku(n,t,i){var r,u,f;""!==n.breadcrumbbarModule.searchObj.element.value||n.isFiltered?(f=n.filterPath,n.hasId?(r=n.currentItemText,u=i):(r=(f=f.replace(/\\/g,"/")).replace(t,"")+n.currentItemText,u=f.replace(t,"")+i)):(r=n.currentItemText,u=i);nr(n,{action:"rename",path:t,name:r,newName:u,data:n.itemData,showFileExtension:n.showFileExtension},aw,t)}function ue(n,t,i,r,u,f,e){var o={action:u,path:t,targetData:n.itemData[0],targetPath:r,names:i,renameFiles:f,data:e};n.destinationPath=r;nr(n,o,vw,t,u,r)}function fe(n,t,i,r){nr(n,{action:r,path:i,names:t,data:n.itemData},yw,i)}function du(n,t,i,r){nr(n,{action:r,path:i,names:t,data:n.itemData},pw,i,r)}function d(n){return n.fileSystemData.length>=0&&t.isNullOrUndefined(n.ajaxSettings.url)}function as(n,t){return n.some(function(n){return n.name===t})}function pv(n,i){return n.fileSystemData.findIndex(function(n){return!t.isNullOrUndefined(n)&&String(n.id)===String(i)})}function pr(n,t){return n.fileSystemData.filter(function(n){return String(n.id)===String(t)})[0]}function gu(n,t){return n.fileSystemData.filter(function(n){return String(n.parentId)===String(t)})}function wv(n,i,r,u){var f={},e,o,s;for(e in n)Object.prototype.hasOwnProperty.call(n,e)&&(f[e]=null);return o=new Date,s=String(i.id)===String(0)||t.isNullOrUndefined(i.parentId)?"\\":i.filterPath+i.name+"\\",Object.assign(f,{dateCreated:o,dateModified:o,filterPath:s,hasChild:!!u&&n.hasChild,id:yr.getUid(null===r?n.name:r),isFile:!!u&&n.isFile,name:null===r?n.name:r,parentId:i.id,size:u?n.size:0,type:u?n.type:""}),t.isNullOrUndefined(i.filterId)||Object.assign(f,{filterId:i.filterId+i.id+"/"}),f}function ee(n,t,i,r){n.responseData={cwd:null,details:null,error:{code:i,message:t,fileExists:null!=r?r:null},files:null}}function sw(n,i,r){var u={cancel:!1,newName:t.getValue("newName",i),itemData:t.getValue("data",i),path:t.getValue("path",i)};n.trigger("beforeRename",u,function(t){var u,i,f;t.cancel?r.cancel=!0:d(n)&&(as(n.fileSystemData,t.newName)?(u="Cannot rename"+t.itemData[0].name+"to"+t.newName+": destination already exists.",ee(n,u,"400",null)):(i=pr(n,t.itemData[0].id),f=i.name,i.name=t.newName,bv(n,i.id,f,t.newName)))})}function bv(n,t,i,r){n.fileSystemData.forEach(function(u){if(String(u.parentId)===String(t)){var f=u.filterPath.replace(i+"\\",r+"\\");u.filterPath=f;bv(n,u.id,i,r)}})}function nr(n,r,u,f,e,o){var h={url:n.ajaxSettings.url,type:"POST",mode:!0,dataType:"json",contentType:"application/json",data:JSON.stringify(r),onSuccess:null,onFailure:null,beforeSend:null},s={action:t.getValue("action",r),ajaxSettings:h,cancel:!1};(function(n,i,r){switch(t.getValue("action",i)){case"create":!function(n,i,r){var u={folderName:t.getValue("name",i),cancel:!1,path:t.getValue("path",i),parentFolder:t.getValue("data",i)};n.trigger("beforeFolderCreate",u,function(t){var u,i,f;t.cancel?r.cancel=!0:d(n)&&(as(n.fileSystemData,t.folderName)?(u="A file or folder with the name "+t.folderName+" already exists.",ee(n,u,"400",null)):(i=t.parentFolder[0],f=wv(i,i,t.folderName,!1),n.fileSystemData.push(f)))})}(n,i,r);break;case"delete":!function(n,i,r){var u={cancel:!1,itemData:t.getValue("data",i),path:t.getValue("path",i)};n.trigger("beforeDelete",u,function(t){t.cancel?r.cancel=!0:d(n)&&t.itemData.forEach(function(t){var i=pv(n,t.id);-1!==i&&n.fileSystemData.splice(i,1);t.isFile||n.fileSystemData.filter(function(n){return n.filterPath.includes(t.name)}).forEach(function(t){var i=pv(n,t.id);-1!==i&&n.fileSystemData.splice(i,1)})})})}(n,i,r);break;case"rename":sw(n,i,r);break;case"move":case"copy":!function(n,i,r){var u={cancel:!1,itemData:t.getValue("data",i),isCopy:"copy"===t.getValue("action",i),path:t.getValue("path",i),targetData:t.getValue("targetData",i),targetPath:t.getValue("targetPath",i)};n.trigger("beforeMove",u,function(u){var p,e,l,w,s,h,a;if(u.cancel)r.cancel=!0;else if(d(n)){var v="File Already Exists",y=t.getValue("action",i),b=nl(n,u.itemData,y,!1),k=nl(n,[u.targetData],y,!0),o=[];if(n.pasteNodes=[],""===b&&""===k){if(u.isCopy)return p=gu(n,u.targetData.id),u.itemData.forEach(function(r){if(!as(p,r.name)||t.getValue("renameFiles",i).length>0){if(t.getValue("renameFiles",i).length>0){var f=r.name.split("."),e=r.name.includes(".")?f[0]+"("+n.existingFileCount+")."+f[1]:f[0]+"("+n.existingFileCount+")";return il(n,r,u.targetData,e),n.responseData.error=null,void n.existingFileCount++}il(n,r,u.targetData,null)}else o.push(r.name)}),void(o.length>0&&ee(n,v,"400",o));for(var f=u.targetData,g=gu(n,f.id),c=0;c<u.itemData.length;c++)e=u.itemData[c],!as(g,e.name)||t.getValue("renameFiles",i).length>0?(f.hasChild||(f.hasChild=!e.isFile,l=n.fileSystemData.filter(function(n){return String(n.id)===String(f.id)}),l.length>0&&(l[0].hasChild=f.hasChild)),e.isFile||(w=0!==e.parentId?gu(n,e.parentId):[],pr(n,e.parentId).hasChild=w.length>1),s=pr(n,e.id),t.getValue("renameFiles",i).length>0&&(h=e.name.split("."),e.name=e.name.includes(".")?h[0]+"("+n.existingFileCount+")."+h[1]:h[0]+"("+n.existingFileCount+")",s.name=e.name,n.responseData.error=null,n.existingFileCount++,n.dropData=f,n.dropPath=u.path,a=u.targetPath.replace(/^\/|\/$/g,"").split("/"),f=pr(n,a[a.length-1])),s.parentId=f.id,s.filterPath=0===f.id?"\\":f.filterPath+f.name+"\\",t.isNullOrUndefined(f.filterId)||(s.filterId=f.filterId+f.id+"/"),e.isFile||dv(n,s)):o.push(e.name);o.length>0&&ee(n,v,"400",o)}}})}(n,i,r);break;case"search":!function(n,i,r){var u={searchResults:t.getValue("data",i),cancel:!1,path:t.getValue("path",i),searchText:t.getValue("searchString",i),caseSensitive:t.getValue("caseSensitive",i),showHiddenItems:t.getValue("showHiddenItems",i)};n.trigger("search",u,function(n){t.setValue("data",n.searchResults,i);n.cancel&&(r.cancel=!0)})}(n,i,r)}})(n,r,s);n.trigger("beforeSend",s,function(s){var y,a;if(!s.cancel){if(n.notify(bi,{}),d(n)){var p=("node-expand"===f||"finalize-end"===f||"rename-end-parent"===f?t.getValue("path",r):n.path).replace(/^\/|\/$/g,"").split("/"),w="rename-end-parent"===f||"path-changed"===f&&0!==t.getValue("data",r).length&&t.isNullOrUndefined(n.renamedItem)?t.getValue("data",r)[0].id:p[p.length-1],h=t.getValue("action",r),b=("move"===h||"rename"===h||"copy"===h||"delete"===h||"search"===h)&&"rename-end"!==f;if("read"===h||"create"===h||"rename-end"===f)y=n.fileSystemData.filter(function(n){return t.isNullOrUndefined(n.parentId)}).length>0?n.fileSystemData.filter(function(n){return t.isNullOrUndefined(n.parentId)})[0].id:0,n.responseData={cwd:pr(n,"/"===n.path&&"node-expand"!==f&&"rename-end-parent"!==f?y:w),details:null,error:null,files:gu(n,"/"===n.path&&"node-expand"!==f&&"rename-end-parent"!==f?y:w)},t.isNullOrUndefined(n.responseData.cwd)&&ee(n,"Cannot load empty data within the File Manager.","400",null);else if(b&&null===n.responseData.error)0===(c="search"===h||"delete"===h?t.getValue("data",r):[]).length&&(c="copy"===h?n.pasteNodes.map(function(t){return pr(n,t)}):t.getValue("data",r).map(function(t){return pr(n,t.id)})),n.responseData={cwd:null,details:null,error:null,files:c};else if("details"===t.getValue("action",r)){var c,l=(c=t.getValue("data",r))[0],v=c.length>1,k=c.map(function(n){return n.name}),g=(a=v?c.reduce(function(n,t){return n+(t.size||0)},0):l.size)<1024?a+" B":a<1048576?(a/1024).toFixed(2)+" KB":a<1073741824?(a/1048576).toFixed(2)+" MB":(a/1073741824).toFixed(2)+" GB",nt=n.pathNames.includes(l.name)||v?n.pathNames.join("/"):n.pathNames.join("/")+"/"+l.name;n.responseData.details=Object.assign({location:nt,multipleFiles:v,name:k.join(", "),size:g},v?{}:{created:l.dateCreated,isFile:l.isFile,modified:l.dateModified,permission:l.permission})}return void kv(n,n.responseData,u,r,f,e,o,s)}new t.Ajax({url:t.getValue("url",s.ajaxSettings),type:t.getValue("type",s.ajaxSettings),mode:t.getValue("mode",s.ajaxSettings),dataType:t.getValue("dataType",s.ajaxSettings),contentType:t.getValue("contentType",s.ajaxSettings),data:t.getValue("data",s.ajaxSettings),beforeSend:t.getValue("beforeSend",s.ajaxSettings),onSuccess:function(h){if(t.isNullOrUndefined(h)){var c={error:{fileExists:null,message:i(n,"Server-Error")+" "+n.ajaxSettings.url,code:"406"},files:null};gv(n,s,u,c,f,e,o)}else"string"==typeof h&&(h=JSON.parse(h)),kv(n,h,u,r,f,e,o,s)},onFailure:function(){var t={files:null,error:{code:"404",message:i(n,"Network-Error")+" "+n.ajaxSettings.url,fileExists:null}};gv(n,s,u,t,f,e,o)}}).send()}})}function kv(n,i,r,u,f,e,o,s){var c,v,a,p,y,l,h;if(n.notify(lt,{action:"success"}),c=n.expandedId?n.expandedId:n.pathId[n.pathId.length-1],t.isNullOrUndefined(i.cwd)||"read"!==t.getValue("action",u)||(i.cwd.name=1===n.pathId.length&&n.rootAliasName||i.cwd.name,t.setValue("_fm_id",c,i.cwd),t.setValue(c,i.cwd,n.feParent),t.isNullOrUndefined(i.files)&&"401"!==i.error.code)||(("finalize-end"===f||"initial-end"===f)&&0===n.pathNames.length&&(v=t.getValue(n.pathId[0],n.feParent),n.pathNames[0]=t.getValue("name",v),n.hasId=!t.isNullOrUndefined(t.getValue("id",v))),"finalize-end"===f&&sv(n)),!t.isNullOrUndefined(i.files)){for(cv(i.files),a=0,p=i.files.length;a<p;a++)y=i.files[a],t.setValue("_fm_iconClass",vu(y),y);"read"===t.getValue("action",u)&&(hv(i,c),t.setValue(c,i.files,n.feFiles))}t.isNullOrUndefined(i.details)||t.isNullOrUndefined(n.rootAliasName)||(l=n.rootAliasName||t.getValue("name",i.details),h=t.getValue("location",i.details).replace(new RegExp("/","g"),"\\"),"/"===t.getValue("path",u)||n.hasId&&1===t.getValue("path",u).match(/[/]/g).length?(0===t.getValue("names",u).length&&t.setValue("name",l,i.details),h=-1===h.indexOf("\\")?l:h.replace(h.substring(0,h.indexOf("\\")),l)):h=h.replace(h.substring(0,h.indexOf("\\")),l),t.setValue("location",h,i.details));r(n,i,f,e,o);t.isNullOrUndefined(i.files)||"path-changed"!==f&&"finalize-end"!==f&&"open-end"!==f&&"drop-path"!==f||n.notify(ho,i);"function"==typeof t.getValue("onSuccess",s.ajaxSettings)&&t.getValue("onSuccess",s.ajaxSettings)()}function il(n,t,i,r){var f=wv(t,i,r,!0),e,u;for(n.fileSystemData.push(f),n.pasteNodes.push(f.id),e=gu(n,t.id),u=0;u<e.length;u++)il(n,e[u],f,null)}function dv(n,i){gu(n,i.id).forEach(function(r){r.filterPath=i.filterPath+i.name+"\\";t.isNullOrUndefined(i.filterId)||(r.filterId=i.filterId+i.id+"/");r.isFile||dv(n,r)})}function gv(n,i,r,u,f,e,o){n.notify(lt,{action:"failure"});r(n,u,f,e,o);"function"==typeof t.getValue("onFailure",i.ajaxSettings)&&t.getValue("onFailure",i.ajaxSettings)()}function hw(n,i,r){try{if(t.isNullOrUndefined(i.files))t.isNullOrUndefined(i.error)||"401"!==i.error.code||(i.files=[],n.notify(r,i),n.notify(c,{})),ii(n,i,"read"),n.setProperties({path:n.oldPath},!0),n.pathNames.pop();else{n.notify(r,i);n.notify(c,{});var u={action:"read",result:i};n.trigger("success",u)}}catch(i){ai(n,i,"read");n.setProperties({path:n.oldPath},!0);n.pathNames.pop()}n.isDragDrop&&n.isDropEnd&&(0!==n.droppedObjects.length&&(u={fileDetails:n.droppedObjects},n.trigger("fileDropped",u)),n.isDropEnd=n.isDragDrop=!1)}function cw(n,i,r,u){try{if(t.isNullOrUndefined(i.files))ii(n,i,u);else{n.notify(r,i);var f={action:u,result:i};n.trigger("success",f)}}catch(i){ai(n,i,u)}}function lw(n,r,u){var e,h,c,f;try{t.isNullOrUndefined(r.files)?"400"===r.error.code?(n.dialogObj&&n.dialogObj.visible?(e=t.select("#newname",n.dialogObj.element),h=i(n,"Validation-NewFolder-Exists").replace("{0}",'"'+e.value+'"'),e.parentElement.nextElementSibling.innerHTML=h):s(n,"Error",{files:null,error:{code:"400",message:i(n,"Validation-NewFolder-Exists").replace("{0}",'"'+u+'"'),fileExists:null}}),f={action:"create",error:r.error},n.trigger("failure",f)):(n.dialogObj&&n.dialogObj.visible&&n.dialogObj.hide(),ii(n,r,"create")):(n.dialogObj&&n.dialogObj.visible&&n.dialogObj.hide(),n.createdItem=d(n)?r.files[r.files.length-1]:r.files[0],n.breadcrumbbarModule.searchObj.value="",c={folderName:u,path:n.path,parentFolder:n.itemData},n.trigger("folderCreate",c),f={action:"create",result:r},n.trigger("success",f),n.itemData=[a(n)],o(n,pt,n.path))}catch(h){n.dialogObj&&n.dialogObj.visible&&n.dialogObj.hide();ai(n,h,"create")}}function aw(n,r){var e,u,f,h,c,s,l;try{t.isNullOrUndefined(r.files)?"400"===r.error.code&&n.dialogObj&&n.dialogObj.visible?(e=t.select("#rename",n.dialogObj.element),u=i(n,"Validation-Rename-Exists").replace("{0}",'"'+n.currentItemText+'"'),u=u.replace("{1}",'"'+e.value+'"'),e.parentElement.nextElementSibling.innerHTML=u,f={action:"rename",error:r.error},n.trigger("failure",f)):(t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide(),ii(n,r,"rename")):(t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide(),f={action:"rename",result:r},n.trigger("success",f),n.renamedItem=Array.isArray(r.files)?r.files[0]:r.files,h={newName:n.renamedItem.name,itemData:[n.renamedItem],path:n.path},(n.trigger("rename",h),"navigationpane"===n.activeModule)?(c=a(n),s=n.pathId[n.pathId.length-1].split("_").length-2,n.pathId.pop(),n.itemData=[t.getValue(n.pathId[n.pathId.length-1],n.feParent)],l=cs(n,n.renamedItem),o(n,pf,l),!t.isNullOrUndefined(c)&&n.pathNames.length>1&&s<=n.pathNames.length-1&&(n.pathNames[s]=n.renameText,n.hasId||n.setProperties({path:"/"+n.pathNames.slice(1).join("/")+"/"},!0)),n.itemData=n.navigationpaneModule.previousSelected.length>0?n.navigationpaneModule.treeObj.getTreeData(n.navigationpaneModule.previousSelected[0]):n.itemData,o(n,y,n.path),n.itemData[0]=n.renamedItem,n.renamedItem=null):(n.itemData=[a(n)],""!==n.breadcrumbbarModule.searchObj.value?vs(n,ft,n.path,n.searchWord,n.showHiddenItems,!n.searchSettings.ignoreCase):n.isFiltered?ls(n,ft):o(n,ft,n.path)))}catch(u){t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide();ai(n,u,"rename")}}function vw(n,i,r,u){try{var f={itemData:i.files,isCopy:"copy"===u,path:r,targetData:n.itemData[0],targetPath:n.path};n.trigger("move",f);i.error&&i.error.fileExists?(n.fileLength=0,t.isNullOrUndefined(i.files)||(n.isPasteError=!0,ts(n,u,i)),tf(n,"DuplicateItems",i.error.fileExists),"404"===i.error.code&&s(n,"Error",i)):i.error||t.isNullOrUndefined(i.files)?i.error&&!t.isNullOrUndefined(i.files)?(n.isPasteError=!0,ts(n,u,i),s(n,"Error",i)):ii(n,i,u):(n.isPasteError=!1,ts(n,u,i))}catch(i){ai(n,i,u)}}function yw(n,i,r){var u,f;try{u={itemData:i.files,path:r};(n.trigger("delete",u),t.isNullOrUndefined(i.files))?ii(n,i,"delete"):(n.setProperties({path:r},!0),n.itemData=[a(n)],o(n,wt,n.path),i.error)?ii(n,i,"delete"):(f={action:"delete",result:i},n.trigger("success",f))}catch(i){ai(n,i,"delete")}}function pw(n,i,r,u){try{if(t.isNullOrUndefined(i.details))ii(n,i,"details");else{s(n,u,null,i.details);var f={action:"details",result:i};n.trigger("success",f)}}catch(i){ai(n,i,"details")}}function ii(n,t,i){s(n,"Error",t);var r={action:i,error:t.error};n.trigger("failure",r)}function vs(n,t,i,r,u,f){nr(n,{action:"search",path:i,searchString:r,showHiddenItems:u,caseSensitive:f,data:n.itemData},ww,t)}function ww(n,i,r){try{if(t.isNullOrUndefined(i.files))ii(n,i,"search");else{n.notify(r,i);var u={action:"search",result:i};n.trigger("success",u)}}catch(i){ai(n,i,"search")}}function nf(n,r,u){var f=n.ajaxSettings.downloadUrl?n.ajaxSettings.downloadUrl:n.ajaxSettings.url,e={action:"download",path:r,names:u,data:n.itemData},o={data:e,cancel:!1,useFormPost:!0,ajaxSettings:{url:f,type:"POST",contentType:"application/json",responseType:"blob",data:JSON.stringify(e),onSuccess:null,onFailure:null,beforeSend:null}};n.trigger("beforeDownload",o,function(r){var u,o,h,e;if(!r.cancel)if(r.useFormPost)u=t.createElement("form",{id:n.element.id+"_downloadForm",attrs:{action:f,method:"post",name:"downloadForm",download:""}}),o=t.createElement("input",{id:n.element.id+"_hiddenForm",attrs:{name:"downloadInput",value:JSON.stringify(r.data),type:"hidden"}}),u.appendChild(o),n.element.appendChild(u),document.forms.namedItem("downloadForm").submit(),n.element.removeChild(u);else try{new t.Fetch({url:t.getValue("url",r.ajaxSettings),type:t.getValue("type",r.ajaxSettings),contentType:t.getValue("contentType",r.ajaxSettings),responseType:t.getValue("responseType",r.ajaxSettings),beforeSend:t.getValue("beforeSend",r.ajaxSettings),onLoad:function(i){if(h=i.headers.get("Content-Disposition")){var r=h.match(/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/),u=r&&r[1];e=u?u.replace(/['"]/g,""):e}else e=n.itemData.length>1?"files.zip":t.getValue("isFile",n.itemData[0])?t.getValue("name",n.itemData[0]):t.getValue("name",n.itemData[0])+".zip"},onSuccess:function(t){n.trigger("success",r);var u=t,f=URL.createObjectURL(u),i=document.createElement("a");i.href=f;i.download=e;document.body.appendChild(i);i.click();document.body.removeChild(i)},onFailure:function(t){var u={error:{code:t.status.toString(),message:i(n,"Network-Error")+" "+n.ajaxSettings.downloadUrl}};s(n,"Error",u);n.trigger("failure",r)}}).send(JSON.stringify(r.data))}catch(r){ai(n,r,"download")}})}function ai(n,t,i){ii(n,{files:null,error:{message:t.message,fileExists:null}},i)}function rl(n,i){n.notify(lt,{action:"success"});i&&"function"==typeof t.getValue("onSuccess",i)&&t.getValue("onSuccess",i)()}function ul(n,i,r){n.notify(lt,{action:"failure"});s(n,"Error",r);"function"==typeof t.getValue("onFailure",i)&&t.getValue("onFailure",i)()}function s(n,r,u,f){var e=function(n,r,u,f){var h,l,o,a,c,s,e={header:"",content:"",buttons:[],dialogName:"",open:function(){rf(n,n.dialogObj,e.dialogName)},close:function(){se(n,n.dialogObj,e.dialogName)}};switch(r=f&&!0===f.multipleFiles?"MultipleFileDetails":r){case"NewFolder":e.dialogName="Create Folder";e.header=i(n,"Header-NewFolder");e.content='<input type="text" value="New folder" id="newname"><div class="e-fe-error"><\/div>';e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Create")},click:function(t){"keydown"!==t.type&&ey(n)}}];e.open=kw.bind(this,n);break;case"Delete":e.dialogName="Delete";n.selectedItems.length>1?(e.content=("<div>"+i(n,"Content-Multiple-Delete")+"<\/div>").replace("{0}",n.selectedItems.length.toString()),e.header=i(n,"Header-Multiple-Delete")):(e.content="<div>"+i(n,n.isFile?"Content-Delete":"Content-Folder-Delete")+"<\/div>",e.header=i(n,n.isFile?"Header-Delete":"Header-Folder-Delete"));e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){!function(n){n.dialogObj.hide();n.notify(yi,{})}(n)}},{buttonModel:{content:i(n,"Button-No")},click:function(){n.dialogObj.hide()}}];break;case"Rename":e.dialogName="Rename";e.header=i(n,"Header-Rename");e.content='<input type="text" class="e-input" id="rename"><div class="e-fe-error"><\/div>';e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Save")},click:function(t){"keydown"!==t.type&&oy(n)}}];e.open=dw.bind(this,n);break;case"details":e.dialogName="File Details";l=new t.Internationalization(n.locale).formatDate(new Date(f.modified),{format:"MMMM dd, yyyy HH:mm:ss"});h="";t.isNullOrUndefined(f.permission)||(h="<tr><td>"+i(n,"Permission")+'<\/td><td class="'+ui+'" >'+vv(f.permission)+"<\/td><\/tr>");e.header=f.name;e.content="<table><tr><td>"+i(n,"Type")+'<\/td><td class="'+ui+'" title="'+(f.isFile?"File":"Folder")+'">'+(f.isFile?"File":"Folder")+"<\/td><\/tr><tr><td>"+i(n,"Size")+'<\/td><td><span class="'+ui+'" title ="'+f.size+'">'+f.size+"<\/span><\/td><\/tr><tr><td>"+i(n,"Location")+'<\/td><td class="'+ui+'" title="'+f.location+'">'+f.location+"<\/td><\/tr><tr><td>"+i(n,"Modified")+'<\/td><td class="'+ui+'" >'+l+"<\/td><\/tr>"+h+"<\/table>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(){n.dialogObj.hide()}}];break;case"MultipleFileDetails":e.dialogName="File Details";void 0===(o=n.itemData.map(function(n){return 0!==(s=n.name.indexOf(".")+1)||n.isFile?0!==s?n.name.substr(s).replace(" ",""):"undetermined":"Folder"}))[0]&&(o=f.name.split(",").map(function(n){return 0===(s=n.indexOf(".")+1)?"Folder":n.substr(s).replace(" ","")}));a=o.every(function(n,t,i){return n===i[0]})?"Folder"===o[0]?"Folder":o[0].toLocaleUpperCase()+" Type":"Multiple Types";c=f.location;e.header=f.name;e.content="<table><tr><td>"+i(n,"Type")+':<\/td><td class="'+ui+'">'+a+"<\/td><\/tr><tr><td>"+i(n,"Size")+":<\/td><td>"+f.size+'<span class="'+ui+'" title ="'+f.size+'"><\/span><\/td><\/tr><tr><td>'+i(n,"Location")+':<\/td><td class="'+ui+'" title="'+c+'">'+c+"<\/td><\/tr><\/table>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(t){"keydown"!==t.type&&n.dialogObj.hide()}}];break;case"Error":n.notify(cr,{});e.dialogName="Error";e.header="401"===u.error.code?'<span class="e-fe-icon e-fe-access-error"><\/span><div class="e-fe-access-header">'+i(n,"Access-Denied")+"<\/div>":i(n,"Error");e.content='<div class="'+rv+'">'+u.error.message+"<\/div>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(){n.dialogObj.hide()}}]}return e}(n,r,u,f);t.isNullOrUndefined(n.dialogObj)?(n.dialogObj=new nt.Dialog({beforeOpen:ry.bind(this,n,e.dialogName),beforeClose:function(t){oe(n,n.dialogObj,t,e.dialogName)},header:e.header,content:e.content,buttons:e.buttons,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!0,allowDragging:!0,isModal:!0,target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:yt(n,n.isMobile?of:st),width:"350px",open:e.open,close:e.close,enableRtl:n.enableRtl,enableHtmlSanitizer:n.enableHtmlSanitizer,locale:n.locale}),n.dialogObj.isStringTemplate=!0,n.dialogObj.appendTo("#"+n.element.id+ws)):function(n,t){n.dialogObj.header=t.header;n.dialogObj.content=t.content;n.dialogObj.buttons=t.buttons;n.dialogObj.enableRtl=n.enableRtl;n.dialogObj.open=t.open;n.dialogObj.close=t.close;n.dialogObj.beforeOpen=ry.bind(this,n,t.dialogName);n.dialogObj.beforeClose=function(i){oe(n,n.dialogObj,i,t.dialogName)};n.dialogObj.dataBind();n.dialogObj.show()}(n,e)}function tf(n,r,u,f){var e=function(n,t,r,u){var o,e,s,f={header:"",content:"",buttons:[],dialogName:"",open:function(){rf(n,n.extDialogObj,f.dialogName)},close:function(){se(n,n.extDialogObj,f.dialogName)}};switch(t){case"Extension":f.header=i(n,"Header-Rename-Confirmation");f.content="<div>"+i(n,"Content-Rename-Confirmation")+"<\/div>";f.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){n.extDialogObj.hide();ku(n,u,n.renameText)}},{buttonModel:{content:i(n,"Button-No")},click:function(){n.extDialogObj.hide();n.dialogObj.hide()}}];f.dialogName="Extension Change";break;case"DuplicateItems":f.dialogName="Duplicate Items";n.replaceItems=r;s=(e=n.replaceItems[n.fileLength]).lastIndexOf("/");e=-1===s?e:e.substring(s);f.header=i(n,"Header-Duplicate");o="<div>"+i(n,"Content-Duplicate")+"<\/div>";f.content=o.replace("{0}",e);f.close=function(){if(!n.isDropEnd&&0===n.duplicateItems.length){var t={fileDetails:n.droppedObjects};n.trigger("fileDropped",t);n.isDropEnd=n.isDragDrop=!1}se(n,n.extDialogObj,f.dialogName)};f.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){var t,i;if(n.duplicateItems.push(n.replaceItems[n.fileLength]),n.duplicateRecords.push(av(n,n.replaceItems[n.fileLength])),n.fileLength++,r[n.fileLength])t=n.replaceItems[n.fileLength],i=t.lastIndexOf("/"),t=-1===i?t:t.substring(i),n.extDialogObj.content=o.replace("{0}",t),n.extDialogObj.show();else{n.extDialogObj.hide();var u=n.isDragDrop?n.dragPath:n.targetPath,f=n.isDragDrop?n.dropPath:""===n.folderPath?n.path:n.folderPath,e=n.isDragDrop?"move":n.fileAction;ue(n,u,n.duplicateItems,f,e,n.duplicateItems,n.duplicateRecords)}}},{buttonModel:{content:i(n,"Button-No")},click:function(){var t,i;if(n.fileLength++,r[n.fileLength])t=n.replaceItems[n.fileLength],i=t.lastIndexOf("/"),t=-1===i?t:t.substring(i),n.extDialogObj.content=o.replace("{0}",t),n.extDialogObj.show();else if(n.extDialogObj.hide(),0!==n.duplicateItems.length){var u=n.isDragDrop?"move":n.fileAction,f=n.isDragDrop?n.dragPath:n.targetPath,e=n.isDragDrop?n.dropPath:""===n.folderPath?n.path:n.folderPath;ue(n,f,n.duplicateItems,e,u,n.duplicateItems,n.duplicateRecords)}}}];break;case"UploadRetry":f.dialogName="Retry Upload";f.header=i(n,"Header-Retry");f.content=n.retryFiles[0].name+'<div class="e-fe-retrycontent">'+i(n,"Content-Retry")+"<\/div>";f.open=bw.bind(this,n);f.close=function(){n.isRetryOpened=!1;he(n);se(n,n.extDialogObj,f.dialogName)};f.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Keep-Both")},click:function(){ty(n,!0)}},{buttonModel:{isPrimary:!0,content:i(n,"Button-Replace")},click:function(){ty(n,!1)}},{buttonModel:{isPrimary:!0,content:i(n,"Button-Skip")},click:function(){var t=0;n.isApplySame?(t=n.retryFiles.length,n.retryFiles=[],he(n)):(t=1,n.retryFiles.splice(0,1),0!==n.retryFiles.length?tf(n,"UploadRetry"):he(n));n.notify(fo,{count:t})}}]}return f}(n,r,u,f);n.isApplySame=!1;t.isNullOrUndefined(n.extDialogObj)?(n.extDialogObj=new nt.Dialog({beforeOpen:uy.bind(this,n,e.dialogName),beforeClose:function(t){oe(n,n.extDialogObj,t,e.dialogName)},content:e.content,header:e.header,closeOnEscape:!0,allowDragging:!0,animationSettings:{effect:"None"},target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:yt(n,n.isMobile?of:st),enableRtl:n.enableRtl,showCloseIcon:!0,isModal:!0,width:350,buttons:e.buttons,open:e.open,close:e.close,enableHtmlSanitizer:n.enableHtmlSanitizer,locale:n.locale}),n.extDialogObj.isStringTemplate=!0,n.extDialogObj.appendTo("#"+n.element.id+bs)):(n.extDialogObj.header=e.header,n.extDialogObj.close=e.close,n.extDialogObj.open=e.open,n.extDialogObj.close=e.close,n.extDialogObj.content=e.content,n.extDialogObj.buttons=e.buttons,n.extDialogObj.enableRtl=n.enableRtl,n.extDialogObj.locale=n.locale,n.extDialogObj.beforeOpen=uy.bind(this,n,e.dialogName),n.extDialogObj.beforeClose=function(t){oe(n,n.extDialogObj,t,e.dialogName)},n.extDialogObj.dataBind(),n.extDialogObj.show())}function el(n,t,i,r){var u={cancel:i.cancel,popupName:r,popupModule:t};n.trigger("beforePopupOpen",u,function(n){i.cancel=n.cancel})}function oe(n,t,i,r){var u={cancel:i.cancel,popupModule:t,popupName:r};n.trigger("beforePopupClose",u,function(t){i.cancel=t.cancel;i.cancel||!i.isInteracted||"Rename"!==r&&"Create Folder"!==r||n.trigger(cr,{})})}function rf(n,t,i){var r={popupModule:t,element:t.element,popupName:i};n.trigger("popupOpen",r)}function se(n,t,i){var r={popupModule:t,element:t.element,popupName:i};n.trigger("popupClose",r)}function ty(n,t){n.isApplySame?(t?function(n){for(;0!==n.retryFiles.length;)n.retryArgs.push({action:"keepboth",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1)}(n):function(n){for(;0!==n.retryFiles.length;)n.retryArgs.push({action:"replace",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1)}(n),he(n)):(n.retryArgs.push({action:t?"keepboth":"replace",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1),0!==n.retryFiles.length?tf(n,"UploadRetry"):he(n))}function he(n){var r=!0,i;n.isRetryOpened?n.isRetryOpened=!1:r=!1;i=t.select(".e-dlg-checkbox",n.extDialogObj.element);i&&t.remove(i);r?n.extDialogObj.hide():n.retryFiles=[]}function bw(n,r){var f;n.isRetryOpened=!0;var e=t.getValue("element",r),o=t.select(".e-dlg-content",e),u=n.createElement("div",{className:"e-dlg-checkbox"}),s=n.createElement("input",{id:n.element.id+"_applyall"});u.appendChild(s);o.appendChild(u);f=new ny.CheckBox({label:i(n,"ApplyAll-Label"),change:function(t){n.isApplySame=t.checked}});f.appendTo("#"+n.element.id+"_applyall");rf(n,n.extDialogObj,"Retry Upload")}function kw(n){var r=t.select("#newname",n.dialogObj.element);r.parentElement.classList.contains("e-control-wrapper")||iy(r,i(n,"Content-NewFolder"));r.parentElement.nextElementSibling.innerHTML="";r.oninput=function(){ol(n,r)};r.onkeyup=function(t){13===cy(t)&&ey(n)},function(n){var i=t.select("#newname",n.dialogObj.element),r;i.focus();i.value="";r=i.value.length;i.setSelectionRange(0,r)}(n);rf(n,n.dialogObj,"Create Folder")}function dw(n){var r=t.select("#rename",n.dialogObj.element);r.parentElement.classList.contains("e-control-wrapper")||iy(r,i(n,"Content-Rename"));r.parentElement.nextElementSibling.innerHTML="";r.oninput=function(){ol(n,r)};r.onkeyup=function(t){13===cy(t)&&oy(n)},function(n,t){var i,r;t.focus();i="";n.isFile&&!n.showFileExtension?(r=n.currentItemText.lastIndexOf("."),i=-1===r?n.currentItemText:n.currentItemText.substring(0,r)):i=n.currentItemText;t.value=i;n.isFile&&n.showFileExtension&&-1!==t.value.indexOf(".")?t.setSelectionRange(0,t.value.lastIndexOf(".")):t.setSelectionRange(0,t.value.length)}(n,r);rf(n,n.dialogObj,"Rename")}function iy(n,t){fl.Input.createInput({element:n,properties:{placeholder:t}})}function ry(n,i,r){fy(t.selectAll(".e-btn",n.dialogObj.element));el(n,n.dialogObj,r,i)}function uy(n,i,r){fy(t.selectAll(".e-btn",n.extDialogObj.element));el(n,n.extDialogObj,r,i)}function fy(n){for(var i=function(t){n[t].onkeydown=function(n){13===n.keyCode&&n.preventDefault()};n[t].onkeyup=function(i){13===i.keyCode&&n[t].click()}},t=0;t<n.length;t++)i(t)}function ey(n){var i=t.select("#newname",n.dialogObj.element);sy(n,i);""===i.parentElement.nextElementSibling.innerHTML&&tl(n,i.value)}function oy(n){var f=t.select("#rename",n.dialogObj.element),i,r,u;if(sy(n,f),""===f.parentElement.nextElementSibling.innerHTML)if(i=f.value,r=n.currentItemText.lastIndexOf("."),n.isFile&&!n.showFileExtension&&(i+=-1===r?"":n.currentItemText.substr(r)),n.renameText=i,n.currentItemText!==i)if(u="navigationpane"===n.activeModule?cs(n,n.itemData[0]):n.path,n.renamedId=t.getValue("id",n.itemData[0]),n.isFile){var o=-1===r?"":n.currentItemText.substr(r),e=i.lastIndexOf("."),s=-1===e?"":i.substr(e);n.showFileExtension&&o!==s?tf(n,"Extension",null,u):ku(n,u,i)}else ku(n,u,i);else n.dialogObj.hide()}function ol(n,t){/[/\\|*?"<>:]/.test(t.value)?hy(n,t):t.parentElement.nextElementSibling.innerHTML=""===t.value?i(n,"Validation-Empty"):""}function sy(n,t){ol(n,t);var i=t.value.length-1;""!==t.value&&(t.value.lastIndexOf(".")===i||t.value.lastIndexOf(" ")===i)&&(n.showFileExtension||-1===t.value.lastIndexOf(".")||0===t.value.substring(t.value.indexOf(".")+1).length)&&hy(n,t)}function hy(n,t){var r=i(n,"Validation-Invalid").replace("{0}",'"'+t.value+'"');n.enableHtmlSanitizer?t.parentElement.nextElementSibling.textContent=r:t.parentElement.nextElementSibling.innerHTML=r}function cy(n){return n.keyCode?n.keyCode:n.which?n.which:n.charCode}function sl(n,r,u){var f=t.createElement("div",{className:"e-image-wrap"}),e,o,s;u.useImageAsUrl?(e=t.createElement("img",{className:"e-image",attrs:{src:u.imageUrl,alt:r}}),f.appendChild(e)):(o=new t.Fetch({url:t.getValue("url",u.ajaxSettings),type:t.getValue("type",u.ajaxSettings),contentType:t.getValue("contentType",u.ajaxSettings),responseType:t.getValue("responseType",u.ajaxSettings),beforeSend:t.getValue("beforeSend",u.ajaxSettings),onSuccess:function(i){var e=URL.createObjectURL(i),o=t.createElement("img",{className:"e-image",attrs:{src:e,alt:r}});f.appendChild(o);rl(n,u.ajaxSettings)},onFailure:function(r){var f={error:{code:r.status.toString(),message:i(n,"Network-Error")+" "+t.getValue("url",u.ajaxSettings)}};ul(n,u.ajaxSettings,f)}}),s=t.getValue("data",u.ajaxSettings),o.send(s));t.isNullOrUndefined(n.viewerObj)?(n.viewerObj=new nt.Dialog({header:r,content:f,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!0,isModal:!0,width:"350px",height:"350px",target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:yt(n,n.isMobile?of:st),locale:n.locale,enableResize:!0,allowDragging:!0,enableHtmlSanitizer:n.enableHtmlSanitizer,position:{X:"center",Y:"center"},enableRtl:n.enableRtl,open:gw.bind(this,n),close:function(){se(n,n.viewerObj,"Image Preview")},beforeOpen:function(t){el(n,n.viewerObj,t,"Image Preview")},beforeClose:function(t){oe(n,n.viewerObj,t,"Image Preview")},resizing:hl.bind(this,n),resizeStop:hl.bind(this,n)}),n.viewerObj.isStringTemplate=!0,n.viewerObj.appendTo("#"+n.element.id+be)):(n.viewerObj.refresh(),n.viewerObj.header=r,n.viewerObj.content=f,n.viewerObj.enableRtl=n.enableRtl,n.viewerObj.dataBind(),n.viewerObj.show())}function gw(n){setTimeout(function(){n.viewerObj&&n.viewerObj.element.focus()});hl(n);rf(n,n.viewerObj,"Image Preview")}function hl(n){var r=t.select(".e-dlg-content",n.viewerObj.element),u=t.select(".e-image-wrap",n.viewerObj.element),i=window.getComputedStyle(r,null),f=i?2*parseFloat(i.paddingRight):36,e=i?2*parseFloat(i.paddingBottom):20;u.style.width=r.offsetWidth-f+"px";u.style.height=r.offsetHeight-e+"px"}var ce,le,cl,al,ay;ce={};n.r(ce);n.d(ce,{ACTIVE:()=>v,ALT_DIALOG_ID:()=>np,AjaxSettings:()=>pl,BLUR:()=>ur,BREADCRUMBBAR_ID:()=>gr,BREADCRUMBS:()=>uv,BreadCrumbBar:()=>al,CB_WRAP:()=>cf,CHECK:()=>iu,CHECK_SELECT:()=>ef,CLONE:()=>ge,COLLAPSED:()=>kp,CONTENT_ID:()=>dr,CONTEXT_MENU_ID:()=>ds,CONTROL:()=>la,Column:()=>gy,ContextMenu:()=>ly,ContextMenuSettings:()=>ea,DETAILS_LABEL:()=>wp,DIALOG_ID:()=>ws,DISPLAY_NONE:()=>ri,DROP_FILE:()=>ih,DROP_FOLDER:()=>lf,Delete:()=>fe,DetailsView:()=>eb,DetailsViewSettings:()=>ia,Download:()=>nf,EMPTY:()=>k,EMPTY_CONTENT:()=>ru,EMPTY_INNER_CONTENT:()=>uu,ERROR_CONTENT:()=>rv,EXTN_DIALOG_ID:()=>bs,FILTER:()=>ke,FOCUS:()=>vi,FOCUSED:()=>tu,FOLDER:()=>fr,FRAME:()=>th,FULLROW:()=>ro,FileManager:()=>ib,GRID_CONTENT:()=>da,GRID_HEADER:()=>rh,GRID_ID:()=>br,GRID_VIEW:()=>or,GetDetails:()=>du,HEADER_CHECK:()=>dh,HOVER:()=>nu,ICONS:()=>to,ICON_BREADCRUMB:()=>tv,ICON_CLEAR:()=>iv,ICON_COLLAPSIBLE:()=>dp,ICON_COPY:()=>sh,ICON_CUT:()=>oh,ICON_DELETE:()=>ch,ICON_DETAILS:()=>vh,ICON_DOWNLOAD:()=>bh,ICON_DROP_IN:()=>vp,ICON_DROP_OUT:()=>yp,ICON_GRID:()=>sr,ICON_IMAGE:()=>af,ICON_LARGE:()=>hr,ICON_MUSIC:()=>wa,ICON_NEWFOLDER:()=>ah,ICON_NO_DROP:()=>pp,ICON_OPEN:()=>nv,ICON_OPTIONS:()=>ap,ICON_PASTE:()=>hh,ICON_REFRESH:()=>ph,ICON_RENAME:()=>lh,ICON_SELECTALL:()=>wh,ICON_SHORTBY:()=>yh,ICON_UPLOAD:()=>eh,ICON_VIDEO:()=>ba,ICON_VIEW:()=>ga,IMG_DIALOG_ID:()=>be,LARGEICON_ID:()=>kr,LARGE_EMPTY_FOLDER:()=>ka,LARGE_EMPTY_FOLDER_TWO:()=>op,LARGE_ICON:()=>vf,LARGE_ICONS:()=>sf,LARGE_ICON_FOLDER:()=>sp,LAYOUT:()=>aa,LAYOUT_CONTENT:()=>ya,LAYOUT_ID:()=>ps,LIST_ITEM:()=>w,LIST_PARENT:()=>rr,LIST_TEXT:()=>hf,LargeIconsView:()=>cl,MENU_ICON:()=>er,MENU_ITEM:()=>uh,MOBILE:()=>nh,MOB_POPUP:()=>of,MULTI_SELECT:()=>ir,NAVIGATION:()=>va,NAVIGATION_ID:()=>ha,NavigationPane:()=>fb,NavigationPaneSettings:()=>oa,OVERLAY:()=>fv,RETRY_DIALOG_ID:()=>tp,RETRY_ID:()=>fp,ROOT:()=>ca,ROOT_POPUP:()=>st,ROW:()=>de,ROWCELL:()=>ep,RTL:()=>io,SEARCH_ID:()=>gs,SELECTED_ITEMS:()=>hp,SORTBY_ID:()=>ip,SPLITTER_ID:()=>up,SPLIT_BAR:()=>kh,STATUS:()=>bp,SUBMENU_ICON:()=>fh,Search:()=>vs,SearchSettings:()=>gl,TB_ITEM:()=>pa,TB_OPTION_DOT:()=>ht,TB_OPTION_TICK:()=>b,TEMPLATE_CELL:()=>lp,TEXT_CONTENT:()=>cp,TOOLBAR_ID:()=>uf,TREE_ID:()=>wr,TREE_VIEW:()=>no,Toolbar:()=>rb,ToolbarItem:()=>dl,ToolbarSettings:()=>kl,UPLOAD_DIALOG_ID:()=>ks,UPLOAD_ID:()=>ff,UploadSettings:()=>sa,VALUE:()=>ui,VIEW_ID:()=>rp,Virtualization:()=>ub,actionFailure:()=>cr,activeElement:()=>nc,addBlur:()=>kf,afterRequest:()=>lt,beforeDelete:()=>gp,beforeDownload:()=>rw,beforeRequest:()=>bi,clearAllInit:()=>eu,clearPathInit:()=>yf,closePopup:()=>yv,columnArray:()=>ta,copyFiles:()=>lu,createDeniedDialog:()=>e,createDialog:()=>s,createEmptyElement:()=>ec,createEnd:()=>pt,createExtDialog:()=>tf,createFolder:()=>tl,createImageDialog:()=>sl,createNewFolder:()=>ss,createVirtualDragElement:()=>is,cutCopyInit:()=>gi,cutEnd:()=>so,cutFiles:()=>au,defaultToolbarItems:()=>bl,deleteEnd:()=>wt,deleteInit:()=>yi,destroy:()=>ct,detailsInit:()=>it,doDeleteFiles:()=>kc,doDownload:()=>bc,doDownloadFiles:()=>dc,doPasteUpdate:()=>ts,doRename:()=>ie,download:()=>tw,downloadInit:()=>co,dragCancel:()=>yc,dragEnd:()=>lo,dragHelper:()=>uw,dragStartHandler:()=>us,dragStopHandler:()=>rs,dragging:()=>ao,draggingHandler:()=>es,dropHandler:()=>lv,dropInit:()=>gt,dropPath:()=>ni,fileItems:()=>ra,fileType:()=>vu,filter:()=>ls,filterEnd:()=>fu,finalizeEnd:()=>tt,folderItems:()=>ua,generatePath:()=>sv,getAccessClass:()=>re,getAccessDetails:()=>nl,getAllChildItems:()=>tc,getCssClass:()=>yt,getDirectories:()=>oc,getDirectoryPath:()=>ns,getDuplicateData:()=>av,getFullPath:()=>yu,getImageUrl:()=>go,getItemName:()=>li,getLocaleText:()=>i,getModule:()=>df,getName:()=>uc,getObject:()=>fc,getParentPath:()=>ne,getParents:()=>bo,getPath:()=>po,getPathId:()=>wo,getPathNames:()=>ov,getPathObject:()=>a,getSortField:()=>hc,getSortedData:()=>vt,getTargetModule:()=>ic,getTargetPath:()=>cs,hasContentAccess:()=>os,hasDownloadAccess:()=>bu,hasEditAccess:()=>p,hasReadAccess:()=>wu,hasUploadAccess:()=>gc,hideLayout:()=>ar,hidePaste:()=>ou,initialEnd:()=>fi,isFile:()=>ev,isFileSystemData:()=>d,layoutChange:()=>g,layoutItems:()=>fa,layoutRefresh:()=>ki,menuItemData:()=>di,methodCall:()=>ot,modelChanged:()=>f,nodeExpand:()=>eo,objectToString:()=>vv,openAction:()=>rc,openEnd:()=>kt,openInit:()=>oi,openSearchFolder:()=>lc,paste:()=>ue,pasteEnd:()=>et,pasteHandler:()=>pu,pasteInit:()=>ci,pathChanged:()=>y,pathColumn:()=>vr,pathDrag:()=>uo,permissionCopy:()=>fw,permissionDownload:()=>cu,permissionEdit:()=>rt,permissionEditContents:()=>yo,permissionRead:()=>vo,permissionUpload:()=>gh,read:()=>o,readDropPath:()=>vc,refresh:()=>ti,refreshEnd:()=>bt,removeActive:()=>ko,removeBlur:()=>ut,removeDropTarget:()=>pc,removeItemClass:()=>wc,rename:()=>ku,renameEnd:()=>ft,renameEndParent:()=>pf,renameInit:()=>si,resizeEnd:()=>pi,scrollHandler:()=>fs,search:()=>ei,searchTextChange:()=>ho,searchWordHandler:()=>gf,selectAllInit:()=>lr,selectedData:()=>hi,selectionChanged:()=>c,setDateObject:()=>cv,setNextPath:()=>cc,setNodeId:()=>hv,showPaste:()=>oo,skipUpload:()=>fo,sortByChange:()=>dt,sortColumn:()=>wf,sortComparer:()=>ow,sortbyClickHandler:()=>sc,splitterResize:()=>wi,treeSelect:()=>iw,triggerFetchFailure:()=>ul,triggerFetchSuccess:()=>rl,updateLayout:()=>at,updatePath:()=>bf,updateRenamingData:()=>te,updateSelectionData:()=>hu,updateTreeSelection:()=>su,upload:()=>nw,uploadItem:()=>hs,validateSubFolder:()=>ac});le=n(864);const t=ejdashboard.base;var ae,vy=(ae=function(n,t){return ae=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},ae(n,t)},function(n,t){function i(){this.constructor=n}ae(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ve=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},pl=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return vy(i,n),ve([t.Property(null)],i.prototype,"downloadUrl",void 0),ve([t.Property(null)],i.prototype,"getImageUrl",void 0),ve([t.Property(null)],i.prototype,"uploadUrl",void 0),ve([t.Property(null)],i.prototype,"url",void 0),i}(t.ChildProperty),wl=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),h=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},bl=["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"],kl=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return wl(i,n),h([t.Property(bl)],i.prototype,"items",void 0),h([t.Property(!0)],i.prototype,"visible",void 0),i}(t.ChildProperty),dl=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return wl(i,n),h([t.Property("")],i.prototype,"id",void 0),h([t.Property("")],i.prototype,"text",void 0),h([t.Property("auto")],i.prototype,"width",void 0),h([t.Property("")],i.prototype,"cssClass",void 0),h([t.Property(!1)],i.prototype,"showAlwaysInPopup",void 0),h([t.Property(!1)],i.prototype,"disabled",void 0),h([t.Property("")],i.prototype,"prefixIcon",void 0),h([t.Property("")],i.prototype,"suffixIcon",void 0),h([t.Property(!0)],i.prototype,"visible",void 0),h([t.Property("None")],i.prototype,"overflow",void 0),h([t.Property("")],i.prototype,"template",void 0),h([t.Property("Button")],i.prototype,"type",void 0),h([t.Property("Both")],i.prototype,"showTextOn",void 0),h([t.Property(null)],i.prototype,"htmlAttributes",void 0),h([t.Property("")],i.prototype,"tooltipText",void 0),h([t.Property("Left")],i.prototype,"align",void 0),h([t.Property(-1)],i.prototype,"tabIndex",void 0),h([t.Property()],i.prototype,"name",void 0),i}(t.ChildProperty),yy=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ye=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},gl=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return yy(i,n),ye([t.Property(!0)],i.prototype,"allowSearchOnTyping",void 0),ye([t.Property("contains")],i.prototype,"filterType",void 0),ye([t.Property(!0)],i.prototype,"ignoreCase",void 0),ye([t.Property(null)],i.prototype,"placeholder",void 0),i}(t.ChildProperty),py=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),na=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ta=[{field:"name",headerText:"Name",minWidth:120,template:'<span class="e-fe-text">${name}<\/span>',customAttributes:{"class":"e-fe-grid-name"}},{field:"_fm_modified",headerText:"DateModified",type:"dateTime",format:"MMMM dd, yyyy HH:mm",minWidth:120,width:"190"},{field:"size",headerText:"Size",minWidth:90,width:"110",template:t.initializeCSPTemplate(function(n){return'<span class="e-fe-size">'+n.size+"<\/span>"}),format:"n2"}],ia=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return py(i,n),na([t.Property(!0)],i.prototype,"columnResizing",void 0),na([t.Property(ta)],i.prototype,"columns",void 0),i}(t.ChildProperty),wy=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),pe=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ra=["Open","|","Cut","Copy","|","Delete","Download","Rename","|","Details"],ua=["Open","|","Cut","Copy","Paste","|","Delete","Rename","Download","|","Details"],fa=["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"],ea=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return wy(i,n),pe([t.Property(ra)],i.prototype,"file",void 0),pe([t.Property(ua)],i.prototype,"folder",void 0),pe([t.Property(fa)],i.prototype,"layout",void 0),pe([t.Property(!0)],i.prototype,"visible",void 0),i}(t.ChildProperty),by=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),we=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},oa=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return by(i,n),we([t.Property("650px")],i.prototype,"maxWidth",void 0),we([t.Property("240px")],i.prototype,"minWidth",void 0),we([t.Property(!0)],i.prototype,"visible",void 0),we([t.Property("None")],i.prototype,"sortOrder",void 0),i}(t.ChildProperty),ky=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tr=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},sa=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ky(i,n),tr([t.Property("")],i.prototype,"allowedExtensions",void 0),tr([t.Property(!0)],i.prototype,"autoUpload",void 0),tr([t.Property(!1)],i.prototype,"autoClose",void 0),tr([t.Property(!1)],i.prototype,"directoryUpload",void 0),tr([t.Property(0)],i.prototype,"minFileSize",void 0),tr([t.Property(3e7)],i.prototype,"maxFileSize",void 0),tr([t.Property(0)],i.prototype,"chunkSize",void 0),i}(t.ChildProperty),dy=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},gy=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return dy(i,n),l([t.Property("")],i.prototype,"field",void 0),l([t.Property("")],i.prototype,"headerText",void 0),l([t.Property("")],i.prototype,"width",void 0),l([t.Property("")],i.prototype,"minWidth",void 0),l([t.Property("")],i.prototype,"maxWidth",void 0),l([t.Property("Left")],i.prototype,"textAlign",void 0),l([t.Property(null)],i.prototype,"headerTextAlign",void 0),l([t.Property(null)],i.prototype,"type",void 0),l([t.Property(null)],i.prototype,"format",void 0),l([t.Property(null)],i.prototype,"template",void 0),l([t.Property(null)],i.prototype,"sortComparer",void 0),l([t.Property(null)],i.prototype,"headerTemplate",void 0),l([t.Property(!0)],i.prototype,"allowSorting",void 0),l([t.Property(!0)],i.prototype,"allowResizing",void 0),l([t.Property(null)],i.prototype,"customAttributes",void 0),l([t.Property("")],i.prototype,"hideAtMedia",void 0),l([t.Property(null)],i.prototype,"customFormat",void 0),l([t.Property(!1)],i.prototype,"isPrimaryKey",void 0),i}(t.ChildProperty),uf="_toolbar",ps="_layout",ha="_navigation",wr="_tree",br="_grid",kr="_largeicons",ws="_dialog",np="_alt_dialog",be="_img_dialog",bs="_extn_dialog",ks="_upload_dialog",tp="_retry_dialog",ds="_contextmenu",ip="_sortby",rp="_view",up="_splitter",dr="_content",gr="_breadcrumbbar",ff="_upload",fp="_retry",gs="_search",ca="e-filemanager",la="e-control",ef="e-fe-cb-select",st="e-fe-popup",nh="e-fe-mobile",of="e-fe-popup e-fe-mobile",ir="e-fe-m-select",ke="e-fe-m-filter",aa="e-layout",va="e-navigation",ya="e-layout-content",sf="e-large-icons",pa="e-toolbar-item",w="e-list-item",hf="e-list-text",rr="e-list-parent",b="e-icons e-fe-tick",ht="e-icons e-fe-dot",ur="e-blur",v="e-active",nu="e-hover",vi="e-focus",tu="e-focused",iu="e-check",th="e-frame",cf="e-checkbox-wrapper",de="e-row",ep="e-rowcell",k="e-empty",ru="e-empty-content",uu="e-empty-inner-content",ge="e-fe-clone",lf="e-fe-drop-folder",ih="e-fe-drop-file",fr="e-fe-folder",af="e-fe-image",wa="e-fe-music",ba="e-fe-video",vf="e-large-icon",ka="e-empty-icon e-fe-folder",op="e-empty-icon.e-fe-folder",sp="e-fe-folder",hp="e-items",cp="e-text-content",rh="e-gridheader",lp="e-templatecell",no="e-treeview",uh="e-menu-item",er="e-menu-icon",fh="e-caret",or="e-content",da="e-gridcontent",ga="e-list-parent",nv="e-icons e-fe-open",eh="e-icons e-fe-upload",oh="e-icons e-fe-cut",sh="e-icons e-fe-copy",hh="e-icons e-fe-paste",ch="e-icons e-fe-delete",lh="e-icons e-fe-rename",ah="e-icons e-fe-newfolder",vh="e-icons e-fe-details",yh="e-icons e-fe-sort",ph="e-icons e-fe-refresh",wh="e-icons e-fe-select",bh="e-icons e-fe-download",ap="e-icons e-fe-options",sr="e-icons e-fe-grid",hr="e-icons e-fe-large",tv="e-icons e-fe-breadcrumb",iv="e-icons e-fe-clear",vp="e-icons e-fe-drop-in",yp="e-icons e-fe-drop-out",pp="e-icons e-fe-no-drop",to="e-icons",wp="e-detailslabel",rv="e-fe-errorcontent",bp="e-status",uv="e-address",io="e-rtl",ri="e-display-none",kp="e-node-collapsed",ro="e-fullrow",dp="e-icon-collapsible",kh="e-split-bar",dh="e-headercheck",fv="e-fe-overlay",ui="e-fe-value",ev="isFile",f="model-changed",fi="initial-end",tt="finalize-end",pt="create-end",fu="filter-end",gp="before-delete",uo="path-drag",yi="delete-init",wt="delete-end",bt="refresh-end",pi="resize-end",wi="splitter-resize",y="path-changed",ct="destroy",bi="before-request",nw="upload",fo="skip-upload",lt="after-request",tw="download",ki="layout-refresh",cr="actionFailure",ei="search",oi="open-init",kt="open-end",c="selection-changed",lr="select-all-init",eu="clear-all-init",yf="clear-path-init",g="layout-change",dt="sort-by-change",eo="node-expand",it="details-init",di="menu-item-data",si="rename-init",pf="rename-end-parent",ft="rename-end",oo="show-paste",ou="hide-paste",hi="selected-data",gi="cut-copy-init",ci="paste-init",et="paste-end",so="cut-end",ar="hide-layout",su="update-tree-selection",iw="select-node",wf="sort-column",vr="path-column",ho="search-change",rw="before-download",co="download-init",gt="drop-init",lo="drag-end",ni="drop-path",uw="drag-helper",ao="dragging",hu="update-selection-data",ot="method-call",vo="read",rt="write",yo="writeContents",fw="copy",gh="upload",cu="download";const ew=ejdashboard.layouts,nt=ejdashboard.popups,u=ejdashboard.data;const yr=ejdashboard.grids;const fl=ejdashboard.inputs,ny=ejdashboard.buttons;const ys=ejdashboard.lists;cl=function(){function n(n){this.isInteraction=!0;this.uploadOperation=!1;this.count=0;this.isRendered=!0;this.tapCount=0;this.isSelectAllCalled=!1;this.isPasteOperation=!1;this.isInteracted=!0;this.imageEventArgsMap=new Map;this.imageUrlCache=new Map;this.parent=n;this.element=t.select("#"+this.parent.element.id+kr,this.parent.element);t.addClass([this.element],sf);this.addEventListener();this.keyConfigs={end:"end",home:"home",tab:"tab",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlEnd:"ctrl+end",ctrlHome:"ctrl+home",ctrlDown:"ctrl+downarrow",ctrlLeft:"ctrl+leftarrow",ctrlRight:"ctrl+rightarrow",ctrlUp:"ctrl+uparrow",shiftEnd:"shift+end",shiftHome:"shift+home",shiftDown:"shift+downarrow",shiftLeft:"shift+leftarrow",shiftRight:"shift+rightarrow",shiftUp:"shift+uparrow",csEnd:"ctrl+shift+end",csHome:"ctrl+shift+home",csDown:"ctrl+shift+downarrow",csLeft:"ctrl+shift+leftarrow",csRight:"ctrl+shift+rightarrow",csUp:"ctrl+shift+uparrow",space:"space",ctrlSpace:"ctrl+space",shiftSpace:"shift+space",csSpace:"ctrl+shift+space",ctrlA:"ctrl+a",enter:"enter",altEnter:"alt+enter",esc:"escape",del:"delete",ctrlX:this.parent.isMac?"cmd+x":"ctrl+x",ctrlC:this.parent.isMac?"cmd+c":"ctrl+c",ctrlV:this.parent.isMac?"cmd+v":"ctrl+v",f2:"f2",shiftdel:"shift+delete",back:"backspace",ctrlD:"ctrl+d"}}return n.prototype.render=function(n){var f,e,o,i,r;if(this.parent.visitedItem=null,this.startItem=null,nt.showSpinner(this.parent.element),"LargeIcons"===this.parent.view){for(this.resetMultiSelect(),this.element.setAttribute("tabindex","0"),this.listObj&&(this.unWireEvents(),this.removeEventListener()),this.parent.notify(ar,{}),f=t.select("#"+this.parent.element.id+kr,this.parent.element),e=t.select("ul",f),(e&&t.remove(e),this.listObj={ariaAttributes:{itemRole:"option",listRole:"listbox",itemText:"",groupItemRole:"group",wrapperRole:""},showIcon:!0,fields:{text:"name",iconCss:"_fm_icon",imageUrl:"_fm_imageUrl",imageAttributes:"_fm_imageAttr",htmlAttributes:"_fm_htmlAttr"},sortOrder:this.parent.sortOrder,itemCreated:this.onItemCreated.bind(this),enableHtmlSanitizer:this.parent.enableHtmlSanitizer},this.items=[],this.items=this.renderList(n),this.items=this.parent.sortComparer&&"None"!==this.parent.sortBy?this.allItems=u.DataUtil.sort(this.items,this.parent.sortBy,this.comparer.bind(this)):this.allItems=vt(this.parent,this.items),f.classList.remove(ri),this.parent.enableVirtualization&&this.allItems.length>0&&!t.isNullOrUndefined(this.parent.virtualizationModule)&&this.parent.virtualizationModule.setUIVirtualization(),this.listElements=ys.ListBase.createListFromJson(t.createElement,this.items,this.listObj),this.itemList=Array.prototype.slice.call(t.selectAll("."+w,this.listElements)),this.element.appendChild(this.listElements),this.imageEventArgsMap.size>0&&this.loadImages(),this.listElements.setAttribute("aria-label","listbox"),this.preventImgDrag(),this.createDragObj(),0===this.itemList.length)?(o=this.element.querySelector("."+rr),this.element.removeChild(o),ec(this.parent,this.element,n)):0!==this.itemList.length&&this.element.querySelector("."+k)&&this.element.removeChild(this.element.querySelector("."+k)),!0===this.isPasteOperation&&(this.selectItems(this.parent.pasteNodes),this.isPasteOperation=!1),!0===this.uploadOperation&&(this.selectItems(this.parent.uploadItem),this.parent.setProperties({selectedItems:[]},!0),this.count++,this.count===this.parent.uploadItem.length&&(this.uploadOperation=!1,this.parent.uploadItem=[])),i=this.element.querySelectorAll("."+v),0!==i.length&&(this.parent.activeModule="largeiconsview"),r=0;r<i.length;r++)i[r].setAttribute("aria-selected","true");this.element.style.maxHeight="100%";this.getItemCount();this.addEventListener();this.wireEvents();this.parent.enableVirtualization&&this.allItems.length>0&&!t.isNullOrUndefined(this.parent.virtualizationModule)&&(this.parent.virtualizationModule.setUlElementHeight(),this.parent.virtualizationModule.wireScrollEvent(!1));this.isRendered=!0;nt.hideSpinner(this.parent.element);this.parent.selectedItems.length&&this.checkItem()}},n.prototype.loadImages=function(){var n=this;this.parent.element.querySelectorAll(".e-list-img").forEach(function(r){var f=r.getAttribute("data-image-key"),u;if(f){if(n.imageUrlCache.has(f))return r.setAttribute("src",n.imageUrlCache.get(f)),void r.classList.remove("image-blur");u=n.imageEventArgsMap.get(f);u&&new t.Fetch({url:t.getValue("url",u.ajaxSettings),type:t.getValue("type",u.ajaxSettings),contentType:t.getValue("contentType",u.ajaxSettings),responseType:t.getValue("responseType",u.ajaxSettings),beforeSend:t.getValue("beforeSend",u.ajaxSettings),onSuccess:function(t){var i=URL.createObjectURL(t);n.imageUrlCache.set(f,i);r.setAttribute("src",i);r.classList.remove("image-blur");rl(n.parent,u.ajaxSettings)},onFailure:function(r){var f={files:null,error:{code:r.status?r.status.toString():"404",message:i(n.parent,"Network-Error")+" "+t.getValue("url",u.ajaxSettings),fileExists:null}};ul(n.parent,u.ajaxSettings,f)}}).send(t.getValue("data",u.ajaxSettings))}})},n.prototype.comparer=function(n,t){if("Descending"===this.parent.sortOrder){var i=n;n=t;t=i}return this.parent.sortComparer(n,t)},n.prototype.preventImgDrag=function(){for(var n=0;n<this.itemList.length;)this.itemList[n].querySelector("img")&&(this.itemList[n].ondragstart=function(){return!1}),n++},n.prototype.createDragObj=function(){var n=this;this.listObj&&(this.parent.allowDragAndDrop?(this.dragObj&&this.dragObj.destroy(),this.dragObj=new t.Draggable(this.listElements,{enableTailMode:!0,distance:5,enableAutoScroll:!1,dragTarget:"."+vf,helper:this.dragHelper.bind(this),cursorAt:this.parent.dragCursorPosition,dragArea:this.parent.element,dragStop:rs.bind(this,this.parent),drag:es.bind(this,this.parent),clone:!0,dragStart:function(t){us(n.parent,t,n.dragObj)}})):this.dragObj&&!this.parent.allowDragAndDrop&&this.dragObj.destroy())},n.prototype.dragHelper=function(n){var f=n.sender.target,i=t.closest(f,".e-list-item"),u,r;if(!i)return null;for(i&&!i.classList.contains("e-active")&&this.setFocus(i),u=this.element.querySelectorAll("."+v),this.parent.activeElements=[],this.parent.dragData=[],r=0;r<u.length;r++)this.parent.dragData.push(this.getItemObject(u[parseInt(r.toString(),10)])),this.parent.activeElements.push(u[r]);return df(this.parent,i),this.parent.dragPath=this.parent.path,is(this.parent),this.parent.virtualDragElement},n.prototype.onDropInit=function(n){var r,u,i;this.parent.targetModule===this.getModuleName()&&(r=t.closest(n.target,".e-list-item"),u=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent),r?(i=this.getItemObject(r),this.parent.dropPath=i.isFile?this.parent.path:yu(this.parent,i,this.parent.path),this.parent.dropData=i.isFile?u:i):(this.parent.dropPath=this.parent.path,this.parent.dropData=u))},n.prototype.getModuleName=function(){return"largeiconsview"},n.prototype.onItemCreated=function(n){var u;if(n.item.removeAttribute("aria-level"),!this.parent.showFileExtension&&t.getValue("isFile",n.curData)){var f=n.item.querySelector("."+hf),i=t.getValue("name",n.curData),r=t.getValue("type",n.curData);-1!==i.indexOf(r)&&(f.innerHTML=i.substr(0,i.length-r.length))}this.renderCheckbox(n);u={element:n.item,fileDetails:n.curData,module:"LargeIconsView"};this.parent.trigger("fileLoad",u)},n.prototype.renderCheckbox=function(n){if(this.parent.showItemCheckBoxes){var i=ny.createCheckBox(t.createElement,!1,{checked:!1,cssClass:"e-small"});i.setAttribute("role","checkbox");i.setAttribute("aria-checked","false");i.setAttribute("aria-label","checkbox");n.item.firstElementChild.insertBefore(i,n.item.firstElementChild.childNodes[0])}},n.prototype.onLayoutChange=function(n){if("LargeIcons"===this.parent.view){if(this.destroy(),this.parent.enableVirtualization&&this.parent.setProperties({selectedItems:[]},!0),this.render(n),"layout-change"===t.getValue("name",n)&&"move"===this.parent.fileAction&&this.parent.isCut&&this.parent.selectedNodes&&0!==this.parent.selectedNodes.length)for(var r=this.getIndexes(this.parent.selectedNodes),i=0;i<r.length;)kf(this.itemList[r[i]]),i++;0!==this.element.querySelectorAll("."+v).length&&this.element.focus();this.checkItem();this.parent.isLayoutChange=!1}else this.element.setAttribute("tabindex","-1")},n.prototype.checkItem=function(){var t=this.element.querySelectorAll("."+v),n;if(t)for(n=0;n<t.length;)this.checkState(t[n],!0),n++},n.prototype.renderList=function(n){for(var f,e,i=0,r=JSON.parse(JSON.stringify(n.files));i<r.length;){var o=vu(r[i]),u=t.getValue("name",r[i]),h=li(this.parent,r[i]),s=this.parent.selectedItems&&-1!==this.parent.selectedItems.indexOf(h)?vf+" e-active":vf;(p(r[i])||(s+=" "+re(r[i])),o===af&&this.parent.showThumbnail&&wu(r[i]))?(f=go(this.parent,r[i]),f.useImageAsUrl?(t.setValue("_fm_imageUrl",f.imageUrl,r[i]),t.setValue("_fm_imageAttr",{alt:u},r[i])):(e="img_"+u+"_"+i,this.imageEventArgsMap.set(e,f),t.setValue("_fm_imageUrl","",r[i]),t.setValue("_fm_imageAttr",{alt:u,"class":"e-list-img image-blur","data-image-key":e},r[i]))):t.setValue("_fm_icon",o,r[i]);t.setValue("_fm_htmlAttr",{"class":s,title:u},r[i]);i++}return r},n.prototype.onFinalizeEnd=function(n){this.render(n)},n.prototype.onCreateEnd=function(n){"LargeIcons"===this.parent.view&&(this.onLayoutChange(n),this.clearSelect(),this.selectItems([t.getValue(this.parent.hasId?"id":"name",this.parent.createdItem)]),this.parent.createdItem=null,this.parent.largeiconsviewModule.element.focus(),this.parent.activeModule="largeiconsview")},n.prototype.onSelectedData=function(){"largeiconsview"===this.parent.activeModule&&this.updateSelectedData()},n.prototype.onDeleteInit=function(){"largeiconsview"===this.parent.activeModule&&fe(this.parent,this.parent.selectedItems,this.parent.path,"delete")},n.prototype.onDeleteEnd=function(n){"LargeIcons"===this.parent.view&&(this.onLayoutChange(n),this.parent.setProperties({selectedItems:[]},!0),this.clearSelect())},n.prototype.onRefreshEnd=function(n){"LargeIcons"===this.parent.view&&this.onLayoutChange(n)},n.prototype.onRenameInit=function(){"largeiconsview"===this.parent.activeModule&&1===this.parent.selectedItems.length&&this.updateRenameData()},n.prototype.onPathChanged=function(n){this.parent.isCut=!1;""===this.parent.breadcrumbbarModule.searchObj.element.value&&(this.parent.searchedItems=[]);"LargeIcons"===this.parent.view&&(ut(this.parent),this.parent.setProperties({selectedItems:[]},!0),this.onLayoutChange(n),this.parent.renamedItem&&"largeiconsview"===this.parent.activeModule&&(this.clearSelect(),this.addSelection(this.parent.renamedItem)))},n.prototype.onOpenInit=function(n){"largeiconsview"===this.parent.activeModule&&this.doOpenAction(n.target)},n.prototype.onHideLayout=function(){"LargeIcons"!==this.parent.view&&this.element&&this.element.classList.add(ri)},n.prototype.onSelectAllInit=function(){if("LargeIcons"===this.parent.view){this.startItem=this.getFirstItem();var n=this.getLastItem();this.doSelection(n,{ctrlKey:!0,shiftKey:!0});this.isInteraction=!0;this.isInteracted=!0}},n.prototype.onClearAllInit=function(){"LargeIcons"===this.parent.view&&(this.clearSelection(),this.isInteraction=!0,this.isInteracted=!0)},n.prototype.onBeforeRequest=function(){this.isRendered=!1},n.prototype.onAfterRequest=function(){this.isRendered=!0},n.prototype.onSearch=function(n){"LargeIcons"===this.parent.view&&(this.parent.setProperties({selectedItems:[]},!0),this.parent.notify(c,{}),this.parent.searchedItems=n.files,this.onLayoutChange(n))},n.prototype.onLayoutRefresh=function(){this.parent.view},n.prototype.onUpdateSelectionData=function(){"LargeIcons"===this.parent.view&&this.updateSelectedData()},n.prototype.onPathColumn=function(){"LargeIcons"!==this.parent.view||t.isNullOrUndefined(this.listObj)||""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered||"filterPath"!==this.parent.sortBy||(this.parent.sortBy="name",this.parent.notify(dt,{}))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vr,this.onPathColumn),this.parent.off(tt,this.onFinalizeEnd),this.parent.off(pt,this.onCreateEnd),this.parent.off(hi,this.onSelectedData),this.parent.off(yi,this.onDeleteInit),this.parent.off(wt,this.onDeleteEnd),this.parent.off(bt,this.onRefreshEnd),this.parent.off(y,this.onPathChanged),this.parent.off(g,this.onLayoutChange),this.parent.off(ei,this.onSearch),this.parent.off(oi,this.onOpenInit),this.parent.off(kt,this.onPathChanged),this.parent.off(f,this.onPropertyChanged),this.parent.off(ot,this.onMethodCall),this.parent.off(cr,this.onActionFailure),this.parent.off(si,this.onRenameInit),this.parent.off(ft,this.onPathChanged),this.parent.off(ar,this.onHideLayout),this.parent.off(lr,this.onSelectAllInit),this.parent.off(eu,this.onClearAllInit),this.parent.off(di,this.onMenuItemData),this.parent.off(bi,this.onBeforeRequest),this.parent.off(lt,this.onAfterRequest),this.parent.off(wi,this.splitterResizeHandler),this.parent.off(pi,this.resizeHandler),this.parent.off(ci,this.onpasteInit),this.parent.off(et,this.onpasteEnd),this.parent.off(gi,this.oncutCopyInit),this.parent.off(gt,this.onDropInit),this.parent.off(it,this.onDetailsInit),this.parent.off(ki,this.onLayoutRefresh),this.parent.off(ni,this.onDropPath),this.parent.off(hu,this.onUpdateSelectionData),this.parent.off(fu,this.onPathChanged))},n.prototype.addEventListener=function(){this.parent.on(vr,this.onPathColumn,this);this.parent.on(tt,this.onFinalizeEnd,this);this.parent.on(pt,this.onCreateEnd,this);this.parent.on(bt,this.onRefreshEnd,this);this.parent.on(hi,this.onSelectedData,this);this.parent.on(y,this.onPathChanged,this);this.parent.on(yi,this.onDeleteInit,this);this.parent.on(ci,this.onpasteInit,this);this.parent.on(wt,this.onDeleteEnd,this);this.parent.on(g,this.onLayoutChange,this);this.parent.on(ei,this.onSearch,this);this.parent.on(oi,this.onOpenInit,this);this.parent.on(si,this.onRenameInit,this);this.parent.on(ft,this.onPathChanged,this);this.parent.on(kt,this.onPathChanged,this);this.parent.on(f,this.onPropertyChanged,this);this.parent.on(ot,this.onMethodCall,this);this.parent.on(cr,this.onActionFailure,this);this.parent.on(ar,this.onHideLayout,this);this.parent.on(lr,this.onSelectAllInit,this);this.parent.on(eu,this.onClearAllInit,this);this.parent.on(di,this.onMenuItemData,this);this.parent.on(bi,this.onBeforeRequest,this);this.parent.on(lt,this.onAfterRequest,this);this.parent.on(gt,this.onDropInit,this);this.parent.on(it,this.onDetailsInit,this);this.parent.on(wi,this.splitterResizeHandler,this);this.parent.on(pi,this.resizeHandler,this);this.parent.on(et,this.onpasteEnd,this);this.parent.on(gi,this.oncutCopyInit,this);this.parent.on(ki,this.onLayoutRefresh,this);this.parent.on(ni,this.onDropPath,this);this.parent.on(hu,this.onUpdateSelectionData,this);this.parent.on(fu,this.onPathChanged,this)},n.prototype.onActionFailure=function(){this.isInteraction=!0;this.isInteracted=!0},n.prototype.onMenuItemData=function(n){if(this.parent.activeModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.itemData=[this.getItemObject(i)]}},n.prototype.onDetailsInit=function(){this.parent.activeModule===this.getModuleName()&&(0!==this.parent.selectedItems.length?this.updateSelectedData():this.parent.itemData=[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)])},n.prototype.onpasteInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=""===this.parent.folderPath?[a(this.parent)]:[this.getItemObject(t.select(".e-active",this.element))])},n.prototype.oncutCopyInit=function(){var t,n;if(this.parent.activeModule===this.getModuleName())for(t=this.element.querySelectorAll("."+v),this.parent.activeRecords=[],this.parent.activeElements=[],n=0;n<t.length;n++)this.parent.activeElements.push(t[n]),this.parent.activeRecords.push(this.getItemObject(t[n]))},n.prototype.onpasteEnd=function(n){"LargeIcons"===this.parent.view&&(this.isPasteOperation=!0,(this.parent.path===this.parent.destinationPath||this.parent.path===ns(this.parent,n)||this.parent.hasId)&&this.onPathChanged(n))},n.prototype.onDropPath=function(n){"LargeIcons"===this.parent.view&&(this.isPasteOperation=!0,this.onPathChanged(n))},n.prototype.onPropertyChanged=function(n){var i,r,u;if(n.module===this.getModuleName()||"common"===n.module)for(r=0,u=Object.keys(n.newProp);r<u.length;r++)switch(u[r]){case"allowDragAndDrop":this.createDragObj();break;case"selectedItems":this.isInteraction=!1;this.isInteracted=!1;i=t.isNullOrUndefined(this.parent.selectedItems)?[]:this.parent.selectedItems.slice(0);i=this.parent.allowMultiSelection?i:i.slice(i.length-1);this.parent.setProperties({selectedItems:[]},!0);this.onClearAllInit();i.length&&this.selectItems(i);this.parent.setProperties({selectedItems:this.parent.selectedItems},!0);this.isInteraction=!0;this.isInteracted=!0;break;case"showThumbnail":ti(this.parent);break;case"showFileExtension":case"showHiddenItems":o(this.parent,y,this.parent.path);break;case"allowMultiSelection":case"showItemCheckBoxes":if("LargeIcons"!==this.parent.view)break;ti(this.parent);break;case"view":at(this.parent,"LargeIcons")}},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.listObj&&this.unWireEvents(),this.startItem=null,this.listElements=null)},n.prototype.wireEvents=function(){this.wireClickEvent(!0);this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keyup"});this.keyboardDownModule=new t.KeyboardEvents(this.element,{keyAction:this.keydownActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});t.EventHandler.add(this.element,"mouseover",this.onMouseOver,this)},n.prototype.unWireEvents=function(){this.wireClickEvent(!1);t.EventHandler.remove(this.element,"mouseover",this.onMouseOver);this.keyboardModule.destroy();this.keyboardDownModule.destroy()},n.prototype.onMouseOver=function(n){var i=t.closest(n.target,".e-list-item");ut(this.parent,"hover");null!==i&&i.classList.add(nu)},n.prototype.wireClickEvent=function(n){var i=this;n?this.clickObj=new t.Touch(this.element,{tap:function(n){i.parent.isDevice?(i.tapCount=n.tapCount,i.tapEvent=n,setTimeout(function(){i.tapCount>0&&i.doTapAction(i.tapEvent);i.tapCount=0},350)):2===n.tapCount&&3!==n.originalEvent.which?i.dblClickHandler(n):i.clickHandler(n)},tapHold:function(n){i.parent.isDevice&&(i.multiSelect=!!i.parent.allowMultiSelection,i.parent.allowMultiSelection&&t.addClass([i.parent.element],ir),i.clickHandler(n))}}):this.clickObj&&this.clickObj.destroy()},n.prototype.doTapAction=function(n){var i=n.originalEvent.target,r=t.closest(i,"."+w);this.multiSelect||i.classList.contains(rr)||t.isNullOrUndefined(r)?this.clickHandler(n):(this.parent.isFile=!1,this.updateType(r),this.parent.isFile?2===n.tapCount?(this.clickHandler(n),this.dblClickHandler(n)):this.clickHandler(n):this.dblClickHandler(n))},n.prototype.clickHandler=function(n){var t=n.originalEvent.target;ut(this.parent,"hover");this.doSelection(t,n.originalEvent);this.parent.activeModule="largeiconsview"},n.prototype.doSelection=function(n,i){var e=this.parent.isMac?i.metaKey:i.ctrlKey,h=this.parent.isMac&&i.ctrlKey&&i.shiftKey,r=t.closest(n,"."+w),l=n.classList,o,s,f,u;if(this.parent.isFile=!1,o="select",(3===i.which||h)&&!t.isNullOrUndefined(r)&&r.classList.contains(v))return this.addActive(r),void this.updateType(r);if(t.isNullOrUndefined(r))this.parent.selectedItems.length===this.itemList.length&&(this.isSelectAllCalled=!0),this.clearSelection();else if(this.parent.allowMultiSelection&&r.classList.contains(v)&&(e||n.classList.contains(iu))&&(o="unselect"),e&&i.shiftKey&&!h&&(this.isSelectAllCalled=!0),!0!==this.triggerSelection(o,r).cancel){if(this.parent.allowMultiSelection&&(this.multiSelect||!i||e)||l.contains(th)||(this.updateType(r),this.clearSelect()),this.parent.allowMultiSelection&&i.shiftKey&&!h){if(i&&e||this.clearSelect(),this.startItem||(this.startItem=r),s=this.itemList.indexOf(this.startItem),f=this.itemList.indexOf(r),s>f)for(u=s;u>=f;u--)this.addActive(this.itemList[u]);else for(u=s;u<=f;u++)this.addActive(this.itemList[u]);this.addFocus(this.itemList[f])}else this.startItem=r,this.parent.allowMultiSelection&&r.classList.contains(v)?this.removeActive(r):this.addActive(r),this.addFocus(r);0===this.parent.selectedItems.length&&this.resetMultiSelect();this.parent.notify(c,{});this.triggerSelect(o,r)}t.isNullOrUndefined(r)||(this.isSelectAllCalled=!1,this.updateType(r))},n.prototype.dblClickHandler=function(n){this.parent.activeModule="largeiconsview";var t=n.originalEvent.target;this.doOpenAction(t)},n.prototype.clearSelection=function(){this.clearSelect();this.resetMultiSelect();this.parent.notify(c,{})},n.prototype.resetMultiSelect=function(){this.multiSelect=!1;t.removeClass([this.parent.element],ir)},n.prototype.doOpenAction=function(n){var i=this,u,r,f;if(!t.isNullOrUndefined(n)&&(u=t.closest(n,"."+w),this.parent.isFile=!1,!t.isNullOrUndefined(u))){if(this.updateType(u),r=this.getItemObject(u),!wu(r))return void e(this.parent,r,vo);f={cancel:!1,fileDetails:r,module:"LargeIconsView"};this.parent.trigger("fileOpen",f,function(n){var u,e,f,o;n.cancel||(u=t.getValue("name",r),i.parent.isFile?vu(r)===af&&(e=go(i.parent,r),sl(i.parent,u,e)):(""!==i.parent.breadcrumbbarModule.searchObj.element.value||i.parent.isFiltered?lc(i.parent,r):(f=t.getValue("id",r),i.parent.oldPath=i.parent.path,o=i.parent.path+(t.isNullOrUndefined(f)?u:f)+"/",i.parent.setProperties({path:o},!0),i.parent.pathNames.push(u),i.parent.pathId.push(t.getValue("_fm_id",r)),i.parent.itemData=[r],rc(i.parent)),i.parent.isFiltered=!1,i.parent.setProperties({selectedItems:[]},!0)))})}},n.prototype.updateType=function(n){var i=t.select("."+fr,n);this.parent.isFile=!!t.isNullOrUndefined(i)},n.prototype.keydownActionHandler=function(n){if(this.isRendered)switch(n.action){case"end":case"home":case"moveDown":case"moveLeft":case"moveRight":case"moveUp":case"ctrlEnd":case"shiftEnd":case"csEnd":case"ctrlHome":case"shiftHome":case"csHome":case"ctrlDown":case"shiftDown":case"csDown":case"ctrlLeft":case"shiftLeft":case"csLeft":case"ctrlRight":case"shiftRight":case"csRight":case"space":case"ctrlSpace":case"shiftSpace":case"csSpace":case"ctrlA":case"enter":case"altEnter":case"esc":case"del":case"shiftdel":case"ctrlC":case"ctrlV":case"ctrlX":case"f2":case"ctrlD":n.preventDefault()}},n.prototype.keyActionHandler=function(n){var r=this;if(this.isRendered){var i=this.getFocusedItem(),u=this.getFirstItem(),f=this.getLastItem();switch(n.action){case"end":this.parent.enableVirtualization?(this.clearSelect(),this.element.firstElementChild.scrollTo(0,this.element.firstElementChild.scrollHeight),setTimeout(function(){r.navigateItem(r.itemList[r.itemList.length-1])},10)):this.navigateItem(f);break;case"home":this.parent.enableVirtualization?(this.clearSelect(),this.element.firstElementChild.scrollTop=0,setTimeout(function(){r.navigateItem(r.itemList[0])},10)):this.navigateItem(u);break;case"tab":t.isNullOrUndefined(i)?t.isNullOrUndefined(u)||this.addFocus(u):this.addFocus(i);break;case"moveDown":this.navigateDown(i,!0);break;case"moveLeft":this.navigateRight(i,!1);break;case"moveRight":this.navigateRight(i,!0);break;case"moveUp":this.navigateDown(i,!1);break;case"ctrlEnd":case"shiftEnd":case"csEnd":this.csEndKey(f,n);break;case"ctrlHome":case"shiftHome":case"csHome":this.csHomeKey(u,n);break;case"ctrlDown":case"shiftDown":case"csDown":this.csDownKey(i,n);break;case"ctrlLeft":case"shiftLeft":case"csLeft":this.csLeftKey(i,n);break;case"ctrlRight":case"shiftRight":case"csRight":this.csRightKey(i,n);break;case"ctrlUp":case"shiftUp":case"csUp":this.csUpKey(i,n);break;case"space":this.spaceKey(i);break;case"ctrlSpace":case"shiftSpace":case"csSpace":t.isNullOrUndefined(i)||this.doSelection(i,n);break;case"ctrlA":this.ctrlAKey(u,f);break;case"enter":this.doOpenAction(this.parent.visitedItem?this.parent.visitedItem:this.getVisitedItem());break;case"altEnter":this.parent.notify(it,{});du(this.parent,this.parent.selectedItems,this.parent.path,"details");break;case"esc":ko(this.parent);break;case"del":case"shiftdel":this.performDelete();break;case"ctrlC":lu(this.parent);break;case"ctrlV":this.parent.folderPath="";pu(this.parent);break;case"ctrlX":au(this.parent);break;case"f2":this.performRename();break;case"ctrlD":this.doDownload();break;case"back":this.parent.traverseBackward()}}},n.prototype.doDownload=function(){this.updateSelectedData();bc(this.parent)},n.prototype.performDelete=function(){if(this.parent.selectedItems&&this.parent.selectedItems.length>0){this.updateSelectedData();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!p(t[n]))return void e(this.parent,t[n],rt);s(this.parent,"Delete")}},n.prototype.performRename=function(){1===this.parent.selectedItems.length&&(this.updateRenameData(),ie(this.parent))},n.prototype.updateRenameData=function(){var n=t.select("."+w+"."+v,this.element),i=this.getItemObject(n);te(this.parent,i)},n.prototype.getVisitedItem=function(){var n=this.parent.selectedItems[this.parent.selectedItems.length-1],t=this.getIndexes([n],this.parent.hasId);return this.itemList[t[0]]},n.prototype.getFocusedItem=function(){return t.select("."+w+"."+vi,this.element)},n.prototype.getActiveItem=function(){return t.select("."+w+"."+v,this.element)},n.prototype.getFirstItem=function(){return this.itemList[0]},n.prototype.getLastItem=function(){return this.itemList[this.itemList.length-1]},n.prototype.navigateItem=function(n){this.setFocus(n)},n.prototype.navigateDown=function(n,t){var i=this.getNextItem(n,t,this.perRow);this.setFocus(i)},n.prototype.navigateRight=function(n,t){var i=this.getNextItem(n,t);this.setFocus(i)},n.prototype.getNextItem=function(n,i,r){var f,u,e,o;if(t.isNullOrUndefined(n))return this.getFocusedItem()||this.getActiveItem()||this.getFirstItem();u=this.itemList.indexOf(n);do if((u=i?r?u+r:u+1:r?u-r:u-1,f=this.itemList[u],this.parent.enableVirtualization&&t.isNullOrUndefined(f))&&(e=parseInt(window.getComputedStyle(this.itemList[0]).getPropertyValue("margin-top"),10)+parseInt(window.getComputedStyle(this.itemList[0]).getPropertyValue("margin-bottom"),10),o=this.itemList[0].getBoundingClientRect().height+e,this.element.firstElementChild.scrollTo(this.element.firstElementChild.scrollTop,this.element.firstElementChild.scrollTop+o)),t.isNullOrUndefined(f))return n;while(!t.isVisible(f));return f},n.prototype.setFocus=function(n){t.isNullOrUndefined(n)||!0!==this.triggerSelection("select",n).cancel&&(this.startItem=n,this.clearSelect(),this.addActive(n),this.addFocus(n),this.parent.notify(c,{}),this.triggerSelect("select",n))},n.prototype.spaceKey=function(n){t.isNullOrUndefined(n)||n.classList.contains(v)||!0!==this.triggerSelection("select",n).cancel&&(this.addActive(n),this.parent.notify(c,{}),this.triggerSelect("select",n))},n.prototype.ctrlAKey=function(n,i){if(this.parent.allowMultiSelection&&!t.isNullOrUndefined(n)){this.startItem=n;var r=this.element.querySelector("."+rr),f=r.scrollTop,u=this.getFocusedItem();this.doSelection(i,{ctrlKey:!0,shiftKey:!0});r.scrollTop=f;t.isNullOrUndefined(u)||this.addFocus(u)}},n.prototype.csEndKey=function(n,i){this.parent.allowMultiSelection?t.isNullOrUndefined(n)||("ctrlEnd"===i.action?this.addFocus(n):this.doSelection(n,i)):this.navigateItem(n)},n.prototype.csHomeKey=function(n,i){this.parent.allowMultiSelection?t.isNullOrUndefined(n)||("ctrlHome"===i.action?this.addFocus(n):this.doSelection(n,i)):this.navigateItem(n)},n.prototype.csDownKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!0,this.perRow);t.isNullOrUndefined(r)||("ctrlDown"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateDown(n,!0)},n.prototype.csLeftKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!1);t.isNullOrUndefined(r)||("ctrlLeft"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateRight(n,!1)},n.prototype.csRightKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!0);t.isNullOrUndefined(r)||("ctrlRight"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateRight(n,!0)},n.prototype.csUpKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!1,this.perRow);t.isNullOrUndefined(r)||("ctrlUp"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateDown(n,!1)},n.prototype.addActive=function(n){t.isNullOrUndefined(n)||(n.classList.contains(v)||(this.parent.selectedItems.push(this.getDataName(n)),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0),t.addClass([n],[v]),n.setAttribute("aria-selected","true"),this.checkState(n,!0)),this.parent.visitedItem=n)},n.prototype.removeActive=function(n){if(!t.isNullOrUndefined(n)){t.removeClass([n],[v]);this.parent.allowMultiSelection?n.setAttribute("aria-selected","false"):n.removeAttribute("aria-selected");this.checkState(n,!1);var i=this.parent.selectedItems.indexOf(this.getDataName(n));i>-1&&(this.parent.selectedItems.splice(i,1),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0));this.parent.visitedItem=null}},n.prototype.getDataName=function(n){var t=this.getItemObject(n);return li(this.parent,t)},n.prototype.addFocus=function(n){this.element.setAttribute("tabindex","-1");var i=this.getFocusedItem();i&&(i.removeAttribute("tabindex"),t.removeClass([i],[vi]));t.addClass([n],[vi]);n.setAttribute("tabindex","0");n.focus()},n.prototype.checkState=function(n,i){if(this.parent.showItemCheckBoxes){var r=t.select("."+th,n);t.isNullOrUndefined(r)||(i?r.classList.contains(iu)||(t.addClass([r],iu),t.closest(r,"."+cf).setAttribute("aria-checked","true")):r.classList.contains(iu)&&(t.removeClass([r],iu),t.closest(r,"."+cf).setAttribute("aria-checked","false")))}},n.prototype.clearSelect=function(){var n=Array.prototype.slice.call(t.selectAll("."+v,this.listElements)),i,r;if(0!==n.length){if(!0!==this.triggerSelection("unselect",n[0]).cancel)for(i=0,r=n.length;i<r;i++)this.removeActive(n[i]);this.triggerSelect("unselect",n[0])}},n.prototype.resizeHandler=function(){this.getItemCount()},n.prototype.splitterResizeHandler=function(){this.getItemCount()},n.prototype.getItemCount=function(){var t=1,n,i;if(this.itemList)for(n=0,i=this.itemList.length-1;n<i&&this.itemList[n].getBoundingClientRect().top===this.itemList[n+1].getBoundingClientRect().top;n++)t++;this.perRow=t},n.prototype.triggerSelection=function(n,t){var i=[],r,f,u;if(this.isSelectAllCalled)for(r=0,f=this.itemList.length;r<f;r++)i[r]=this.getItemObject(this.itemList[r]);else i[0]=this.getItemObject(t);return u={action:n,fileDetails:i.length>1?i:i[0],isInteracted:this.isInteraction,cancel:!1,target:this.isSelectAllCalled?null:t},this.parent.trigger("fileSelection",u),this.isInteraction=!0,u},n.prototype.triggerSelect=function(n,t){var i=[],r,u,f;if(this.isSelectAllCalled){for(r=0,u=this.itemList.length;r<u;r++)i[r]=this.getItemObject(this.itemList[r]);this.isSelectAllCalled=!1}else i[0]=this.getItemObject(t);this.parent.visitedData=i.length>1?i[i.length-1]:i[0];f={action:n,fileDetails:i.length>1?i:i[0],isInteracted:this.isInteracted};this.parent.trigger("fileSelect",f);this.isInteracted=!0},n.prototype.selectItems=function(n){for(var i=this.getIndexes(n,this.parent.hasId),t=0,r=i.length;t<r;t++)this.doSelection(this.itemList[i[t]],{ctrlKey:!0,shiftKey:!1})},n.prototype.getIndexes=function(n,i){for(var u=[],f=i?"id":"name",r=0,e=this.items.length;r<e;r++)-1!==n.indexOf(t.getValue(f,this.items[r]))&&u.push(r);return u},n.prototype.getItemObject=function(n){var t=this.itemList.indexOf(n);return this.items[t]},n.prototype.addSelection=function(n){var i=[],r,f;this.parent.hasId?i=new u.DataManager(this.items).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(r=new u.DataManager(this.items).executeLocal((new u.Query).where("name","equal",t.getValue("name",n),!1)),r.length>0&&(i=new u.DataManager(r).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1))));i.length>0&&(f=this.items.indexOf(i[0]),this.doSelection(this.itemList[f],{ctrlKey:!0,shiftKey:!1}))},n.prototype.updateSelectedData=function(){for(var i=[],r=t.selectAll("."+w+"."+v,this.element),n=0;n<r.length;n++)i[n]=this.getItemObject(r[n]);this.parent.itemData=i},n.prototype.onMethodCall=function(n){if("LargeIcons"===this.parent.view)switch(t.getValue("action",n)){case"deleteFiles":this.deleteFiles(t.getValue("ids",n));break;case"downloadFiles":this.downloadFiles(t.getValue("ids",n));break;case"openFile":this.openFile(t.getValue("id",n));break;case"renameFile":this.isInteraction=!1;this.isInteracted=!1;this.renameFile(t.getValue("id",n),t.getValue("newName",n));break;case"createFolder":this.isInteraction=!1;this.isInteracted=!1;break;case"clearSelection":this.isInteraction=!1;this.isInteracted=!1;this.onClearAllInit();break;case"selectAll":this.isInteraction=!1;this.isInteracted=!1;this.onSelectAllInit()}},n.prototype.getItemsIndex=function(n){var u=[],o=!(""===this.parent.breadcrumbbarModule.searchObj.element.value&&!this.parent.isFiltered),f=this.parent.hasId?"id":"name",i,r,e;if(this.parent.hasId||!o)for(i=0,r=this.items.length;i<r;i++)-1!==n.indexOf(t.getValue(f,this.items[i]))&&u.push(i);else for(i=0,r=this.items.length;i<r;i++)e=t.getValue("filterPath",this.items[i])+t.getValue("name",this.items[i]),-1===n.indexOf(e)&&-1===n.indexOf(t.getValue(f,this.items[i]))||u.push(i);return u},n.prototype.deleteFiles=function(n){var r;if(this.parent.activeModule="largeiconsview",t.isNullOrUndefined(n))this.performDelete();else if(r=this.getItemsIndex(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=this.items[r[i]],f[i]=li(this.parent,u[i]);kc(this.parent,u,f)}},n.prototype.downloadFiles=function(n){var r;if(t.isNullOrUndefined(n))this.doDownload();else if(r=this.getItemsIndex(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=this.items[r[i]],f[i]=li(this.parent,u[i]);dc(this.parent,u,f)}},n.prototype.openFile=function(n){if(!t.isNullOrUndefined(n)){var i=this.getItemsIndex([n]);i.length>0&&this.doOpenAction(this.itemList[i[0]])}},n.prototype.renameFile=function(n,i){if(this.parent.activeModule="largeiconsview",t.isNullOrUndefined(n))this.performRename();else{var r=this.getItemsIndex([n]);r.length>0&&(te(this.parent,this.items[r[0]]),t.isNullOrUndefined(i)?ie(this.parent):p(this.parent.itemData[0])?ku(this.parent,this.parent.path,i):e(this.parent,this.parent.itemData[0],rt))}},n}();const ll=ejdashboard.splitbuttons;al=function(){function n(n){this.addressPath="";this.addressBarLink="";this.searchTimer=null;this.searchWrapWidth=null;this.parent=n;this.keyConfigs={enter:"enter"};this.render()}return n.prototype.onPropertyChanged=function(n){var r,u,f,i;if(n.module===this.getModuleName()||"common"===n.module)for(r=0,u=Object.keys(n.newProp);r<u.length;r++)f=u[r],i=n.newProp.searchSettings,"searchSettings"===f&&(t.isNullOrUndefined(i.allowSearchOnTyping)||this.searchEventBind(i.allowSearchOnTyping),!this.parent.breadcrumbbarModule.searchObj.value||""===this.parent.breadcrumbbarModule.searchObj.value||!t.isNullOrUndefined(i.allowSearchOnTyping)&&t.isNullOrUndefined(i.filterType)&&t.isNullOrUndefined(i.ignoreCase)||gf(this.parent,this.parent.breadcrumbbarModule.searchObj.value,!1))},n.prototype.render=function(){this.addEventListener()},n.prototype.onPathChange=function(){var o=this.parent.pathNames,a=this.parent.path.split("/"),f=this.parent.createElement("ul",{className:"e-addressbar-ul"}),i=null,c=o.length,r,n,u,e,l,s,h;if(o.length>0){for(r="",n=0;n<c;n++){for(u=null,i=this.parent.createElement("li",{className:"e-address-list-item"}),e=0;e<=n;e++)r=r+a[e]+"/";(i.setAttribute("data-utext",r),0!==n)&&(l=t.createElement("span",{className:to}),i.appendChild(l));c-n!=1?(u=t.createElement("a",{className:hf}),i.setAttribute("tabindex","0")):u=t.createElement("span",{className:hf});r="";u.innerText=o[n];i.appendChild(u);f.appendChild(i)}s=this.parent.breadCrumbBarNavigation.querySelector(".e-addressbar-ul");t.isNullOrUndefined(s)||(t.isNullOrUndefined(this.subMenuObj)||this.subMenuObj.destroy(),t.remove(s));h=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap");h?this.parent.breadCrumbBarNavigation.appendChild(f):this.parent.breadCrumbBarNavigation.insertBefore(f,h);this.updateBreadCrumbBar(f)}},n.prototype.updateBreadCrumbBar=function(n){for(var a,o,tt,s,it,v,rt,h,y,p,c,w,b,k,u=n.querySelectorAll("li"),e=this.parent.breadCrumbBarNavigation.querySelector(".e-addressbar-ul"),d=window.getComputedStyle(e,null),ut=parseFloat(d.getPropertyValue("padding-right")),ft=parseFloat(d.getPropertyValue("padding-left")),l=e.offsetWidth-ut-ft,f=this.parent.createElement("ul",{className:"e-addressbar-ul"}),g=0,nt=[],r=0;r<u.length;r++)a=u[r].clientWidth,nt.push(a),g+=a;if(t.isNullOrUndefined(e)||t.remove(e),o=this.parent.createElement("div"),o.setAttribute("class","e-search-wrap"),tt=this.parent.element.id+gs,s=t.createElement("input",{id:tt,attrs:{autocomplete:"off","aria-label":i(this.parent,"Search")}}),o.appendChild(s),it=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap .e-input"),t.isNullOrUndefined(it)&&(this.parent.breadCrumbBarNavigation.appendChild(o),v=t.createElement("span",{className:"e-icons e-fe-search"}),t.EventHandler.add(v,"click",this.onShowInput,this),s.parentElement.insertBefore(v,s),this.searchObj=new fl.TextBox({value:"",showClearButton:!0,placeholder:i(this.parent,"Search"),focus:this.onFocus.bind(this),blur:this.onBlur.bind(this)}),this.searchObj.appendTo("#"+this.parent.element.id+gs),this.searchEventBind(this.parent.searchSettings.allowSearchOnTyping),rt=this.searchObj.element.nextElementSibling,t.EventHandler.add(rt,"mousedown",this.searchChangeHandler.bind(this),this),t.EventHandler.add(this.searchObj.element,"keyup",this.onKeyUp.bind(this),this)),h=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap"),g>(l-=this.searchWrapWidth?this.searchWrapWidth:h.offsetWidth)){for(r=u.length;r--;){if(y=l-nt[r],!(y>40)){for(p=[],c=0;c<=r;c++)w=u[c],p.push({text:w.innerText,utext:w.getAttribute("data-utext")});b=this.parent.createElement("li",{className:"e-breadcrumb-menu"});k=this.parent.createElement("button",{className:"e-breadcrumb-submenu"});b.appendChild(k);f.insertBefore(b,f.querySelector("li"));this.subMenuObj=new ll.DropDownButton({items:p,cssClass:"e-caret-hide e-submenu",iconCss:tv,iconPosition:"Top",enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeItemRender:this.addSubMenuAttributes.bind(this),select:this.subMenuSelectOperations.bind(this)});this.subMenuObj.isStringTemplate=!0;this.subMenuObj.appendTo(k);break}f.insertBefore(u[r],f.querySelector("li"));l=y}this.parent.breadCrumbBarNavigation.insertBefore(f,h)}else this.parent.breadCrumbBarNavigation.insertBefore(n,h)},n.prototype.onFocus=function(){t.closest(this.searchObj.element,".e-search-wrap").classList.add("e-focus")},n.prototype.onKeyUp=function(){this.parent.notify(vr,{args:this.parent})},n.prototype.onBlur=function(){t.closest(this.searchObj.element,".e-search-wrap").classList.remove("e-focus")},n.prototype.subMenuSelectOperations=function(n){var t={target:n.element};this.addressPathClickHandler(t)},n.prototype.addSubMenuAttributes=function(n){n.element.setAttribute("data-utext",t.getValue("utext",n.item));var i=this.parent.createElement("a",{className:"e-list-text"});n.element.appendChild(i)},n.prototype.searchEventBind=function(n){n?(this.searchObj.input=this.searchChangeHandler.bind(this),this.searchObj.change=null):(this.searchObj.change=this.searchChangeHandler.bind(this),this.searchObj.input=null)},n.prototype.searchChangeHandler=function(n){var i=this;t.isNullOrUndefined(n.value)||(this.parent.isFiltered=!1,this.parent.searchSettings.allowSearchOnTyping?(window.clearTimeout(this.searchTimer),this.searchTimer=window.setTimeout(function(){gf(i.parent,n.value,!1)},300)):gf(this.parent,n.value,!1))},n.prototype.addressPathClickHandler=function(n){var i=n.target,r,u,f;("LI"===i.nodeName||"A"===i.nodeName)&&(r="LI"===i.nodeName?i.children[0]:i,t.isNullOrUndefined(r)||(this.parent.isFiltered=!1,u=this.updatePath(r),this.parent.itemData=[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)],this.triggerFileOpen(this.parent.itemData[0]),o(this.parent,y,u),f=this.parent.pathId[this.parent.pathId.length-1],this.parent.notify(su,{module:"treeview",selectedNode:f})))},n.prototype.triggerFileOpen=function(n){var t={cancel:!1,fileDetails:n,module:"BreadCrumbBar"};delete t.cancel;this.parent.trigger("fileOpen",t)},n.prototype.onShowInput=function(){if(this.parent.isMobile)if(this.parent.element.classList.contains(ke))t.removeClass([this.parent.element],ke),this.searchWrapWidth=null;else{var n=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap");this.searchWrapWidth=n.offsetWidth;t.addClass([this.parent.element],ke);this.searchObj.element.focus()}},n.prototype.updatePath=function(n){var f=t.closest(n,"li").getAttribute("data-utext");this.addressBarLink=f;var u=this.addressBarLink.split("/"),e=this.parent.pathId,o=this.parent.pathNames;this.parent.pathId=[];this.parent.pathNames=[];for(var r="",i=0,s=u.length-1;i<s;i++)this.parent.pathId.push(e[i]),this.parent.pathNames.push(o[i]),r+=u[i]+"/";return this.parent.setProperties({path:r},!0),r},n.prototype.onUpdatePath=function(){this.onPathChange();this.removeSearchValue()},n.prototype.onCreateEnd=function(){this.onPathChange()},n.prototype.onRenameEnd=function(){this.onPathChange()},n.prototype.onDeleteEnd=function(){this.onUpdatePath()},n.prototype.removeSearchValue=function(){this.parent.isFiltered=!1;this.searchObj&&(""!==this.searchObj.value||""!==this.searchObj.element.value)&&(this.searchObj.value="",this.searchObj.element.value="",this.searchObj.dataBind())},n.prototype.onResize=function(){this.onPathChange()},n.prototype.onPasteEnd=function(){this.onPathChange()},n.prototype.addEventListener=function(){this.keyboardModule=new t.KeyboardEvents(this.parent.breadCrumbBarNavigation,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});this.parent.on(f,this.onPropertyChanged,this);t.EventHandler.add(this.parent.breadCrumbBarNavigation,"click",this.addressPathClickHandler,this);this.parent.on(ct,this.destroy,this);this.parent.on(y,this.onUpdatePath,this);this.parent.on(tt,this.onUpdatePath,this);this.parent.on(bt,this.onUpdatePath,this);this.parent.on(kt,this.onUpdatePath,this);this.parent.on(pt,this.onCreateEnd,this);this.parent.on(ft,this.onRenameEnd,this);this.parent.on(wt,this.onDeleteEnd,this);this.parent.on(wi,this.onResize,this);this.parent.on(et,this.onPasteEnd,this);this.parent.on(pi,this.onResize,this);this.parent.on(ho,this.onSearchTextChange,this);this.parent.on(gt,this.onDropInit,this);this.parent.on(ki,this.onResize,this);this.parent.on(ni,this.onPathChange,this)},n.prototype.keyActionHandler=function(n){"enter"===n.action&&this.addressPathClickHandler(n)},n.prototype.removeEventListener=function(){this.keyboardModule.destroy();this.parent.off(y,this.onUpdatePath);this.parent.off(tt,this.onUpdatePath);this.parent.off(bt,this.onUpdatePath);this.parent.off(kt,this.onUpdatePath);this.parent.off(et,this.onPasteEnd);this.parent.off(pt,this.onCreateEnd);this.parent.off(ft,this.onRenameEnd);this.parent.off(wt,this.onDeleteEnd);this.parent.off(wi,this.onResize);this.parent.off(pi,this.onResize);this.parent.off(ho,this.onSearchTextChange);this.parent.off(gt,this.onDropInit);this.parent.off(ki,this.onResize);this.parent.off(ni,this.onPathChange)},n.prototype.onDropInit=function(n){var i,r;this.parent.targetModule===this.getModuleName()&&(i=n.target.closest("li"),this.parent.dropPath=this.updatePath(i.children[0]),this.parent.dropData=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent),this.triggerFileOpen(this.parent.dropData),r=this.parent.pathId[this.parent.pathId.length-1],this.parent.notify(su,{module:"treeview",selectedNode:r}))},n.prototype.getModuleName=function(){return"breadcrumbbar"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),t.isNullOrUndefined(this.subMenuObj)||this.subMenuObj.destroy(),t.isNullOrUndefined(this.searchObj)||this.searchObj.destroy())},n.prototype.onSearchTextChange=function(n){this.searchObj.element.placeholder=null!=this.parent.searchSettings.placeholder?this.parent.searchSettings.placeholder:i(this.parent,"Search")+" "+i(this.parent,n.cwd.name.toString())},n}();const vl=ejdashboard.navigations;var ly=function(){function n(n){this.isMenuItemClicked=!1;this.currentItems=[];this.currentElement=null;this.disabledItems=[];this.parent=n;this.render()}return n.prototype.render=function(){this.keyConfigs={downarrow:"downarrow",uparrow:"uparrown"};this.contextMenu=new vl.ContextMenu({enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:"#"+this.parent.element.id,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeItemRender:this.onBeforeItemRender.bind(this),select:this.onSelect.bind(this),beforeOpen:this.onBeforeOpen.bind(this),beforeClose:this.onBeforeClose.bind(this),cssClass:yt(this.parent,st)});this.contextMenu.isStringTemplate=!0;this.contextMenu.appendTo("#"+this.parent.element.id+ds);this.addEventListener()},n.prototype.onBeforeItemRender=function(n){var i,r;n.item.id===this.getMenuId("largeiconsview")&&(i=t.createElement("span"),(r=n.element).insertBefore(i,"LargeIcons"===this.parent.view?r.childNodes[1]:r.childNodes[0]),i.setAttribute("class",hr+" "+er));n.item.id===this.getMenuId("detailsview")&&(i=t.createElement("span"),(r=n.element).insertBefore(i,"Details"===this.parent.view?r.childNodes[1]:r.childNodes[0]),i.setAttribute("class",sr+" "+er))},n.prototype.onBeforeClose=function(n){var o={cancel:!1,element:n.element,event:n.event,isFocused:n.isFocused,fileDetails:[this.menuItemData],items:n.items,parentItem:n.parentItem,menuType:this.menuType},e,u;if(this.parent.trigger("menuClose",o,function(t){t.cancel&&(n.cancel=t.cancel)}),this.menuTarget=null,!this.isMenuItemClicked&&this.parent.pathId.length>1&&"navigationpane"===this.parent.activeModule){this.parent.pathId.pop();for(var i=[],r=0,f=Object.keys(this.parent.feParent);r<f.length;r++)e=f[r],u=t.getValue(e,this.parent.feParent),-1!==this.parent.pathNames.indexOf(u.name)&&i.push(u._fm_id);this.parent.pathId.push(i[i.length-1]);this.parent.navigationpaneModule.treeObj.setProperties({selectedNodes:[this.parent.pathId[this.parent.pathId.length-1]]})}this.isMenuItemClicked=!1},n.prototype.onBeforeOpen=function(n){var u,s,r=this,h=!1,v=!1,i=n.event.target,o,y,f,p,c,l,e,a;if(this.menuTarget=this.targetNodeElement=i,this.currentElement=n.element,i.classList.contains("e-spinner-pane")&&(i=this.parent.navigationpaneModule.activeNode.getElementsByClassName(ro)[0],this.menuTarget=this.targetNodeElement=i),this.targetElement="Details"===this.parent.view?t.closest(i,"tr.e-row"):i,this.parent.enableVirtualization&&(i.classList.contains("e-virtual-bottom")||i.classList.contains("e-virtualtable"))&&(i=i.parentElement.closest("div")),o=this.getTargetView(i),this.updateActiveModule(),i.classList.contains(no)||t.closest(i,"th")||t.closest(i,"#"+this.parent.element.id+gr)||t.closest(i,"#"+this.parent.element.id+uf))n.cancel=!0;else if("LargeIcons"!==this.parent.view&&this.targetElement&&this.targetElement.classList.contains("e-emptyrow"))this.setLayoutItem(i);else if(t.closest(i,"."+k))this.setLayoutItem(i);else if(!i.classList.contains(uh)&&!i.classList.contains(er)&&!i.classList.contains(fh))if("LargeIcons"!==this.parent.view||t.isNullOrUndefined(t.closest(i,"li"))||t.closest(i,"#"+this.parent.element.id+wr)?t.isNullOrUndefined(t.closest(i,"tr.e-row"))?t.closest(i,"#"+this.parent.element.id+wr)&&(u=t.closest(i,"li").getAttribute("data-uid"),t.isNullOrUndefined(u)||(this.navUid=u),v=!0):(u=this.targetElement.getAttribute("data-uid"),s=this.parent.detailsviewModule.gridObj.getRowObjectFromUID(u).data,t.isNullOrUndefined(this.targetElement.getAttribute("aria-selected"))&&this.parent.detailsviewModule.gridObj.selectRows([parseInt(this.targetElement.getAttribute("aria-rowindex"),10)-1]),h=!0):(t.closest(i,"li").classList.contains("e-active")||this.parent.largeiconsviewModule.doSelection(i,{ctrlKey:!0,shiftKey:!0}),s=this.parent.visitedData,h=!0),h)!0===t.getValue("isFile",s)?this.setFileItem():this.setFolderItem(!1);else if(v)if(this.setFolderItem(!0),u===this.parent.pathId[0])this.disabledItems.push("Delete","Rename","Cut","Copy");else for(y=["Delete","Rename","Cut","Copy"],f=0;f<this.disabledItems.length;f++)p=this.disabledItems[f],-1!==y.indexOf(p)&&(this.disabledItems.splice(f,1),f--);else"TreeView"===o||"GridView"===o||"LargeIcon"===o?this.setLayoutItem(i):n.cancel=!0;c=t.select("#"+this.getMenuId("Paste"),this.contextMenu.element);n.cancel||this.parent.enablePaste||!c||c.classList.contains("e-disabled")?(l=this.disabledItems.indexOf("Paste"),-1!==l&&this.disabledItems.splice(l,1)):-1===this.disabledItems.indexOf("Paste")&&this.disabledItems.push("Paste");n.cancel?this.menuTarget=this.currentElement=null:(this.contextMenu.dataBind(),e=!1,(i.classList.contains(uh)||i.classList.contains(er)||i.classList.contains(fh))&&(e=!0),this.menuItemData=e?this.menuItemData:this.getMenuItemData(),a={fileDetails:[this.menuItemData],element:n.element,target:i,items:e?n.items:this.contextMenu.items,menuModule:this.contextMenu,cancel:!1,menuType:this.menuType,isSubMenu:e},this.currentItems=a.items,this.parent.trigger("menuOpen",a,function(t){e||(r.contextMenu.dataBind(),r.contextMenu.items=t.items,r.contextMenu.dataBind());r.enableItems(r.disabledItems,!1,!0);n.cancel=t.cancel;t.cancel&&(r.menuTarget=r.targetNodeElement=r.currentElement=null)}))},n.prototype.updateActiveModule=function(){this.parent.activeModule=t.closest(this.menuTarget,"#"+this.parent.element.id+wr)?"navigationpane":t.closest(this.menuTarget,"#"+this.parent.element.id+br)?"detailsview":t.closest(this.menuTarget,"#"+this.parent.element.id+kr)?"largeiconsview":this.parent.activeModule},n.prototype.getTargetView=function(n){return n.classList.contains(no)?"TreeView":n.classList.contains(or)?"GridView":n.classList.contains(ga)||n.classList.contains(sf)?"LargeIcon":""},n.prototype.getItemIndex=function(n){for(var i=this.getMenuId(n),t=0;t<this.currentItems.length;t++)if(this.currentItems[t].id===i||this.currentItems[t].id===n)return t;return-1},n.prototype.disableItem=function(n){0!==n.length&&(this.disabledItems=this.disabledItems.concat(n))},n.prototype.enableItems=function(n,t,i){var r,u;for(t&&(this.disabledItems=this.disabledItems.filter(function(t){return-1===n.indexOf(t)})),r=0;r<n.length;r++)u=this.checkValidItem(n[r]),1===u?this.contextMenu.enableItems([this.getMenuId(n[r])],t,i):2===u&&this.contextMenu.enableItems([n[r]],t,i)},n.prototype.setFolderItem=function(n){var r,u,i;(this.menuType="folder",this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.folder.map(function(n){return n.trim()})),this.contextMenu.dataBind(),n)?(r=t.select('[data-uid="'+this.navUid+'"]',this.parent.navigationpaneModule.treeObj.element),t.isNullOrUndefined(r)||this.parent.pathNames[this.parent.pathNames.length-1]!==r.querySelector(".e-list-text").innerHTML||"navigationpane"!==this.parent.activeModule?(u=this.disabledItems.indexOf("Open"),-1!==u&&this.disabledItems.splice(u,1)):this.disabledItems.push("Open"),0===this.parent.selectedItems.length&&-1!==(i=this.disabledItems.indexOf("Rename"))&&this.disabledItems.splice(i,1)):"navigationpane"!==this.parent.activeModule&&(1===this.parent.selectedItems.length?-1!==(i=this.disabledItems.indexOf("Rename"))&&this.disabledItems.splice(i,1):this.disabledItems.push("Rename","Paste"))},n.prototype.setFileItem=function(){if(this.menuType="file",this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.file.map(function(n){return n.trim()})),this.contextMenu.dataBind(),1===this.parent.selectedItems.length){var n=this.disabledItems.indexOf("Rename");-1!==n&&this.disabledItems.splice(n,1)}else this.disabledItems.push("Rename")},n.prototype.setLayoutItem=function(n){this.menuType="layout";this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.layout.map(function(n){return n.trim()}));this.contextMenu.dataBind();!this.parent.allowMultiSelection||"LargeIcons"===this.parent.view&&0!==t.closest(n,"#"+this.parent.element.id+kr).getElementsByClassName(k).length||"Details"===this.parent.view&&0!==t.closest(n,"#"+this.parent.element.id+br).getElementsByClassName(k).length?this.disabledItems.push("SelectAll"):this.disabledItems=this.disabledItems.filter(function(n){return"SelectAll"!==n});0===this.parent.selectedNodes.length&&-1===this.disabledItems.indexOf("Paste")&&this.disabledItems.push("Paste");this.contextMenu.dataBind()},n.prototype.checkValidItem=function(n){if(!t.isNullOrUndefined(this.currentElement)){if(!t.isNullOrUndefined(t.select("#"+this.getMenuId(n),this.currentElement)))return 1;if(!t.isNullOrUndefined(t.select("#"+n,this.currentElement)))return 2}return-1},n.prototype.getMenuItemData=function(){if("layout"===this.menuType)return a(this.parent);var n={target:this.menuTarget};return this.parent.notify(di,n),this.parent.itemData[0]},n.prototype.onSelect=function(n){var i=this,r,u,f;!t.isNullOrUndefined(n.item)&&n.item.id&&(u=n.item.id.substr((this.parent.element.id+"_cm_").length),"refresh"===u||"newfolder"===u||"upload"===u?(r=[a(this.parent)],this.parent.itemData=r):(this.parent.notify(hi,{}),r="navigationpane"===this.parent.activeModule&&"open"===u?[this.menuItemData]:this.parent.itemData),f={cancel:!1,element:n.element,fileDetails:r,item:n.item},this.parent.trigger("menuClick",f,function(f){var c,o,h;if(!f.cancel)switch("cut"!==u&&"copy"!==u&&(i.isMenuItemClicked=!0),u){case"cut":au(i.parent);break;case"copy":lu(i.parent);break;case"paste":"folder"===i.menuType?"navigationpane"===i.parent.activeModule?(i.parent.navigationpaneModule.openFileOnContextMenuClick(t.closest(i.targetNodeElement,"li")),i.parent.folderPath=i.parent.path):i.parent.folderPath=yu(i.parent,i.menuItemData,i.parent.path):i.parent.folderPath="";pu(i.parent);break;case"delete":for(o=0;o<r.length;o++)if(!p(r[o]))return void e(i.parent,r[o],rt);s(i.parent,"Delete");break;case"download":for(h=0;h<r.length;h++)if(!bu(r[h]))return void e(i.parent,r[h],cu);"navigationpane"===i.parent.activeModule?i.parent.notify(co,{}):i.parent.selectedItems.length>0&&nf(i.parent,i.parent.path,i.parent.selectedItems);break;case"rename":p(r[0])?(i.parent.notify(si,{}),s(i.parent,"Rename")):e(i.parent,r[0],rt);break;case"selectall":i.parent.notify(lr,{});break;case"refresh":ti(i.parent);break;case"open":i.parent.visitedItem&&"navigationpane"!==i.parent.activeModule?i.parent.notify(oi,{target:i.parent.visitedItem}):"navigationpane"===i.parent.activeModule&&(i.parent.visitedItem&&i.parent.notify(oi,{target:i.parent.visitedItem}),i.parent.navigationpaneModule.openFileOnContextMenuClick(t.closest(i.targetNodeElement,"li")));break;case"details":i.parent.notify(it,{});c=i.parent.selectedItems;"navigationpane"===i.parent.activeModule&&(c=[],i.parent.navigationpaneModule.openFileOnContextMenuClick(t.closest(i.targetNodeElement,"li")));du(i.parent,c,i.parent.path,"details");break;case"newfolder":ss(i.parent);break;case"upload":hs(i.parent);break;case"name":case"size":case"date":case"ascending":case"descending":case"none":sc(i.parent,n);break;case"largeiconsview":at(i.parent,"LargeIcons");break;case"detailsview":at(i.parent,"Details")}}))},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)"cssClass"===i[t]&&(this.contextMenu.cssClass=yt(this.parent,st))},n.prototype.addEventListener=function(){this.parent.on(ct,this.destroy,this);this.parent.on(f,this.onPropertyChanged,this);this.keyboardModule=new t.KeyboardEvents(this.contextMenu.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},n.prototype.removeEventListener=function(){this.parent.off(ct,this.destroy);this.parent.off(f,this.onPropertyChanged);this.keyboardModule.destroy()},n.prototype.keyActionHandler=function(n){switch(n.action){case"uparrow":case"downarrow":n.preventDefault()}},n.prototype.getModuleName=function(){return"contextmenu"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.contextMenu.destroy(),this.targetElement=null)},n.prototype.getItemData=function(n){for(var e=[],f=0;f<n.length;f++){var t=void 0,r=this.getMenuId(n[f]),u=i(this.parent,n[f]);switch(n[f]){case"|":t={separator:!0};break;case"Open":t={id:r,text:u,iconCss:nv};break;case"Upload":t={id:r,text:u,iconCss:eh};break;case"Cut":t={id:r,text:u,iconCss:oh};break;case"Copy":t={id:r,text:u,iconCss:sh};break;case"Paste":t={id:r,text:u,iconCss:hh};break;case"Delete":t={id:r,text:u,iconCss:ch};break;case"Rename":t={id:r,text:u,iconCss:lh};break;case"NewFolder":t={id:r,text:u,iconCss:ah};break;case"Details":t={id:r,text:u,iconCss:vh};break;case"SortBy":t={id:r,text:u,iconCss:yh,items:[{id:this.getMenuId("Name"),text:i(this.parent,"Name"),iconCss:"name"===this.parent.sortBy?ht:null},{id:this.getMenuId("Size"),text:i(this.parent,"Size"),iconCss:"size"===this.parent.sortBy?ht:null},{id:this.getMenuId("Date"),text:i(this.parent,"DateModified"),iconCss:"_fm_modified"===this.parent.sortBy?ht:null},{separator:!0},{id:this.getMenuId("Ascending"),text:i(this.parent,"Ascending"),iconCss:"Ascending"===this.parent.sortOrder?b:null},{id:this.getMenuId("Descending"),text:i(this.parent,"Descending"),iconCss:"Descending"===this.parent.sortOrder?b:null},{id:this.getMenuId("None"),text:i(this.parent,"None"),iconCss:"None"===this.parent.sortOrder?b:null}]};break;case"View":t={id:r,text:u,iconCss:"Details"===this.parent.view?sr:hr,items:[{id:this.getMenuId("largeiconsview"),text:i(this.parent,"View-LargeIcons"),iconCss:"Details"===this.parent.view?null:b},{id:this.getMenuId("detailsview"),text:i(this.parent,"View-Details"),iconCss:"Details"===this.parent.view?b:null}]};break;case"Refresh":t={id:r,text:u,iconCss:ph};break;case"SelectAll":t={id:r,text:u,iconCss:wh};break;case"Download":t={id:r,text:u,iconCss:bh};break;default:t={id:r,text:u}}e.push(t)}return e},n.prototype.getMenuId=function(n){return this.parent.element.id+"_cm_"+n.split(" ").join("").toLowerCase()},n}(),nb={NewFolder:"New folder",Upload:"Upload",Delete:"Delete",Rename:"Rename",Download:"Download",Cut:"Cut",Copy:"Copy",Paste:"Paste",SortBy:"Sort by",Refresh:"Refresh","Item-Selection":"item selected","Items-Selection":"items selected",View:"View",Details:"Details",SelectAll:"Select all",Open:"Open","Tooltip-NewFolder":"New folder","Tooltip-Upload":"Upload","Tooltip-Delete":"Delete","Tooltip-Rename":"Rename","Tooltip-Download":"Download","Tooltip-Cut":"Cut","Tooltip-Copy":"Copy","Tooltip-Paste":"Paste","Tooltip-SortBy":"Sort by","Tooltip-Refresh":"Refresh","Tooltip-Selection":"Clear selection","Tooltip-View":"View","Tooltip-Details":"Details","Tooltip-SelectAll":"Select all",Name:"Name",Size:"Size",DateModified:"Modified",DateCreated:"Date created",Path:"Path",Modified:"Modified",Created:"Created",Location:"Location",Type:"Type",Permission:"Permission",Ascending:"Ascending",Descending:"Descending",None:"None","View-LargeIcons":"Large icons","View-Details":"Details",Search:"Search","Button-Ok":"OK","Button-Cancel":"Cancel","Button-Yes":"Yes","Button-No":"No","Button-Create":"Create","Button-Save":"Save","Header-NewFolder":"Folder","Content-NewFolder":"Enter your folder name","Header-Rename":"Rename","Content-Rename":"Enter your new name","Header-Rename-Confirmation":"Rename Confirmation","Content-Rename-Confirmation":"If you change a file name extension, the file might become unstable. Are you sure you want to change it?","Header-Delete":"Delete File","Content-Delete":"Are you sure you want to delete this file?","Header-Folder-Delete":"Delete Folder","Content-Folder-Delete":"Are you sure you want to delete this folder?","Header-Multiple-Delete":"Delete Multiple Items","Content-Multiple-Delete":"Are you sure you want to delete these {0} items?","Header-Duplicate":"File/Folder exists","Content-Duplicate":"{0} already exists. Do you want to rename and paste?","Header-Upload":"Upload Files",Error:"Error","Validation-Empty":"The file or folder name cannot be empty.","Validation-Invalid":'The file or folder name {0} contains invalid characters. Please use a different name. Valid file or folder names cannot end with a dot or space, and cannot contain any of the following characters: \\/:*?"<>|',"Validation-NewFolder-Exists":"A file or folder with the name {0} already exists.","Validation-Rename-Exists":"Cannot rename {0} to {1}: destination already exists.","Folder-Empty":"This folder is empty","File-Upload":"Drag files here to upload","Search-Empty":"No results found","Search-Key":"Try with different keywords","Filter-Empty":"No results found","Filter-Key":"Try with different filter","Sub-Folder-Error":"The destination folder is the subfolder of the source folder.","Same-Folder-Error":"The destination folder is the same as the source folder.","Access-Denied":"Access Denied","Access-Details":'You don"t have permission to access this folder.',"Header-Retry":"File Already Exists","Content-Retry":"A file with this name already exists in this folder. What would you like to do?","Button-Keep-Both":"Keep both","Button-Replace":"Replace","Button-Skip":"Skip","ApplyAll-Label":"Do this for all current items",KB:"KB","Access-Message":"{0} is not accessible. You need permission to perform the {1} action.","Network-Error":"NetworkError: Failed to send on XMLHTTPRequest: Failed to load","Server-Error":"ServerError: Invalid response from"},tb=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ib=function(n){function u(i,r){var u=n.call(this,i,r)||this;return u.filterData=null,u.selectedNodes=[],u.duplicateItems=[],u.duplicateRecords=[],u.previousPath=[],u.nextPath=[],u.existingFileCount=0,u.isLayoutChange=!1,u.layoutSelectedItems=[],u.renamedId=null,u.uploadItem=[],u.deleteRecords=[],u.isFile=!1,u.isCut=!1,u.isSearchCut=!1,u.isSearchDrag=!1,u.isPasteError=!1,u.folderPath="",u.isSameAction=!1,u.isFiltered=!1,u.isSortByClicked=!1,u.enablePaste=!1,u.persistData=!1,u.retryArgs=[],u.isOpened=!1,u.isRetryOpened=!1,u.isPathDrag=!1,u.searchedItems=[],u.retryFiles=[],u.isApplySame=!1,u.dragData=[],u.dragNodes=[],u.dragPath="",u.dropPath="",u.isDragDrop=!1,u.treeExpandTimer=null,u.dragCursorPosition={left:44,top:18},u.isDropEnd=!1,u.dragCount=0,u.droppedObjects=[],u.uploadingCount=0,u.uploadedCount=0,u.isMac=!1,u.dragSelectedItems=[],u.onScrollHandler=function(){t.isNullOrUndefined(u.contextmenuModule)||t.isNullOrUndefined(u.contextmenuModule.contextMenu)||u.contextmenuModule.contextMenu.close()},h.Inject(al,cl,ly),u}var h;return tb(u,n),h=u,u.prototype.getModuleName=function(){return"filemanager"},u.prototype.preRender=function(){(t.isNullOrUndefined(this.element.id)||""===this.element.id)&&this.element.setAttribute("id",t.getUniqueID("filemanager"));this.ensurePath();this.feParent=[];this.feFiles=[];t.setStyleAttribute(this.element,{width:t.formatUnit(this.width),height:t.formatUnit(this.height)});this.isDevice=t.Browser.isDevice;this.isMobile=this.checkMobile();this.isMobile&&this.setProperties({navigationPaneSettings:{visible:!1}},!0);var n=t.closest(this.element,".e-bigger");this.isBigger=!!n;this.activeModule="LargeIcons"===this.view?"largeiconsview":"detailsview";nt.createSpinner({target:this.element},t.createElement);this.addWrapper();this.keyConfigs={altN:"alt+n",f5:"f5",ctrlShift1:"ctrl+shift+1",ctrlShift2:"ctrl+shift+2",ctrlU:"ctrl+u"};this.localeObj=new t.L10n(this.getModuleName(),nb,this.locale)},u.prototype.getPersistData=function(){return this.addOnPersist(["view","path","selectedItems"])},u.prototype.requiredModules=function(){var n=[];return n.push({member:"breadcrumbbar",args:[this]}),n.push({member:"largeiconsview",args:[this]}),this.toolbarSettings.visible&&n.push({member:"toolbar",args:[this],name:"Toolbar"}),this.navigationPaneSettings.visible&&n.push({member:"navigationpane",args:[this],name:"NavigationPane"}),this.view&&n.push({member:"detailsview",args:[this],name:"DetailsView"}),this.contextMenuSettings.visible&&!this.isDevice&&n.push({member:"contextmenu",args:[this],name:"ContextMenu"}),this.enableVirtualization&&n.push({member:"virtualization",args:[this],name:"Virtualization"}),n},u.prototype.render=function(){this.initialize();var n=t.isNullOrUndefined(this.selectedItems)?[]:this.allowMultiSelection?this.selectedItems:this.selectedItems.slice(this.selectedItems.length-1);this.setProperties({selectedItems:n},!0);this.fileView=this.view;this.isMac=navigator.platform.toUpperCase().indexOf("MAC")>=0;this.setRtl(this.enableRtl);this.addEventListeners();o(this,this.path!==this.originalPath?fi:tt,this.path);"Details"===this.fileView&&this.largeiconsviewModule.element.classList.add(ri);this.adjustHeight();t.isNullOrUndefined(this.navigationpaneModule)&&(this.splitterObj.collapse(this.enableRtl?1:0),t.select("."+kh,this.element).classList.add(ri));this.wireEvents();this.renderComplete()},u.prototype.ensurePath=function(){var n=this.path,i;t.isNullOrUndefined(n)&&(n="/");n.lastIndexOf("/")!==n.length-1&&(n+="/");this.originalPath=n;i=n.split("/");this.setProperties({path:i[0]+"/"},!0);this.pathNames=[];this.pathId=["fe_tree"];this.itemData=[]},u.prototype.initialize=function(){this.isMobile&&t.addClass([this.element],nh);this.allowMultiSelection&&t.addClass([this.element],ef);this.addCssClass(null,this.cssClass);this.renderFileUpload()},u.prototype.addWrapper=function(){var v=this.createElement("div",{id:this.element.id+uf}),n,i,u,t,f,e,r,o,s,h,c,l,a;this.element.appendChild(v);n=this.createElement("div",{id:this.element.id+ps,className:aa});this.element.appendChild(n);i=this.createElement("div",{id:this.element.id+ha,className:va});u=this.createElement("div",{id:this.element.id+wr});i.appendChild(u);t=this.createElement("div",{id:this.element.id+dr,className:ya});this.breadCrumbBarNavigation=this.createElement("div",{id:this.element.id+gr,className:uv});t.appendChild(this.breadCrumbBarNavigation);f=this.createElement("div",{id:this.element.id+br});t.appendChild(f);e=this.createElement("div",{id:this.element.id+kr,className:sf,attrs:{role:"group"}});t.appendChild(e);o=this.createElement("span",{className:fv});t.appendChild(o);this.enableRtl?(n.appendChild(t),n.appendChild(i),r=[{size:"75%",min:"270px"},{size:"25%",min:this.navigationPaneSettings.minWidth.toString(),max:this.navigationPaneSettings.maxWidth.toString()}]):(n.appendChild(i),n.appendChild(t),r=[{size:"25%",min:this.navigationPaneSettings.minWidth.toString(),max:this.navigationPaneSettings.maxWidth.toString()},{size:"75%",min:"270px"}]);this.splitterObj=new ew.Splitter({paneSettings:r,width:"100%",enableRtl:!1,enableHtmlSanitizer:this.enableHtmlSanitizer,resizing:this.splitterResize.bind(this)});this.splitterObj.isStringTemplate=!0;this.splitterObj.appendTo(n);s=this.createElement("div",{id:this.element.id+ws});this.element.appendChild(s);h=this.createElement("ul",{id:this.element.id+ds});this.element.appendChild(h);c=this.createElement("div",{id:this.element.id+be});this.element.appendChild(c);l=this.createElement("div",{id:this.element.id+bs});this.element.appendChild(l);a=this.createElement("div",{id:this.element.id+ks});this.element.appendChild(a)},u.prototype.adjustHeight=function(){var n=t.select("#"+this.element.id+uf,this.element),i=n?n.offsetHeight:0;this.splitterObj&&(this.splitterObj.height=(this.element.clientHeight-i).toString(),this.splitterObj.dataBind())},u.prototype.splitterResize=function(){this.notify(wi,{})},u.prototype.splitterAdjust=function(){var n=t.select("."+kh,this.element);this.navigationPaneSettings.visible?(this.splitterObj.expand(this.enableRtl?1:0),n.classList.remove(ri)):(this.splitterObj.collapse(this.enableRtl?1:0),n.classList.add(ri))},u.prototype.addCssClass=function(n,i){t.isNullOrUndefined(n)||""===n||t.removeClass([this.element],n.split(" "));t.isNullOrUndefined(i)||""===i||t.addClass([this.element],i.split(" "))},u.prototype.showSpinner=function(){nt.showSpinner(this.element)},u.prototype.hideSpinner=function(){nt.hideSpinner(this.element)},u.prototype.onContextMenu=function(n){n.preventDefault()},u.prototype.checkMobile=function(){return/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(t.Browser.userAgent.toLowerCase())&&/mobile/i.test(t.Browser.userAgent.toLowerCase())},u.prototype.renderFileUpload=function(){var t=this.element.id+ff,n=this.createElement("input",{id:t,attrs:{name:"uploadFiles",type:"file"}});this.element.appendChild(n);this.uploadDialogObj=new nt.Dialog({header:i(this,"Header-Upload"),content:n,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!1,isModal:!0,width:"350px",target:this.popupTarget?this.popupTarget:"#"+this.element.id,cssClass:yt(this,this.isMobile?of:st),locale:this.locale,allowDragging:!0,position:{X:"center",Y:"center"},enableRtl:this.enableRtl,enableHtmlSanitizer:this.enableHtmlSanitizer,open:this.onOpen.bind(this),close:this.onClose.bind(this),beforeOpen:this.onBeforeOpen.bind(this),beforeClose:this.onBeforeClose.bind(this)});this.uploadDialogObj.appendTo("#"+this.element.id+ks);this.renderUploadBox()},u.prototype.renderUploadBox=function(){var n=this.ajaxSettings.uploadUrl?this.ajaxSettings.uploadUrl:this.ajaxSettings.url;this.uploadObj=new fl.Uploader({dropArea:t.select("#"+this.element.id+dr,this.element),asyncSettings:{saveUrl:n,removeUrl:n,chunkSize:this.uploadSettings.chunkSize,retryCount:0},locale:this.locale,enableRtl:this.enableRtl,uploading:this.onUploading.bind(this),chunkUploading:this.onChunkUploading.bind(this),removing:this.onRemoving.bind(this),canceling:this.onCancel.bind(this),clearing:this.onClearing.bind(this),selected:this.onSelected.bind(this),success:this.onUploadSuccess.bind(this),failure:this.onUploadFailure.bind(this),autoUpload:this.uploadSettings.autoUpload,minFileSize:this.uploadSettings.minFileSize,maxFileSize:this.uploadSettings.maxFileSize,allowedExtensions:this.uploadSettings.allowedExtensions,directoryUpload:this.uploadSettings.directoryUpload,fileListRendering:this.onFileListRender.bind(this)});this.uploadObj.appendTo("#"+this.element.id+ff)},u.prototype.onFileListRender=function(n){this.trigger("uploadListCreate",n)},u.prototype.updateUploader=function(){this.uploadObj.autoUpload=this.uploadSettings.autoUpload;this.uploadObj.minFileSize=this.uploadSettings.minFileSize;this.uploadObj.maxFileSize=this.uploadSettings.maxFileSize;this.uploadObj.allowedExtensions=this.uploadSettings.allowedExtensions;this.uploadObj.directoryUpload=this.uploadSettings.directoryUpload;this.uploadObj.dataBind()},u.prototype.onBeforeOpen=function(n){var t={cancel:n.cancel,popupName:"Upload",popupModule:this.uploadDialogObj};this.trigger("beforePopupOpen",t,function(t){n.cancel=t.cancel})},u.prototype.onBeforeClose=function(n){var t={cancel:n.cancel,popupName:"Upload",popupModule:this.uploadDialogObj};this.trigger("beforePopupClose",t,function(t){n.cancel=t.cancel})},u.prototype.onOpen=function(){this.isOpened=!0;this.uploadDialogObj.element.focus();var n={popupModule:this.uploadDialogObj,popupName:"Upload",element:this.uploadDialogObj.element};this.trigger("popupOpen",n)},u.prototype.onClose=function(){this.isOpened=!1;this.uploadObj.clearAll();var n={popupModule:this.uploadDialogObj,popupName:"Upload",element:this.uploadDialogObj.element};this.trigger("popupClose",n)},u.prototype.onChunkUploading=function(n){var r="save",i,u;if(0!==this.retryArgs.length)for(i=0;i<this.retryArgs.length;i++)n.fileData.name===this.retryArgs[i].file.name&&(r=this.retryArgs[i].action);u=JSON.stringify(t.getValue(this.pathId[this.pathId.length-1],this.feParent));n.customFormData=[{path:this.path},{size:n.fileData.size},{action:r},{data:u},{filename:n.fileData.name}]},u.prototype.onUploading=function(n){var r="save",i,u,f;if(0!==this.retryArgs.length)for(i=0;i<this.retryArgs.length;i++)n.fileData.name===this.retryArgs[i].file.name&&(r=this.retryArgs[i].action,0===this.uploadSettings.chunkSize&&(this.retryArgs.splice(i,1),i=this.retryArgs.length));u=JSON.stringify(t.getValue(this.pathId[this.pathId.length-1],this.feParent));n.customFormData=[{path:this.path},{size:n.fileData.size},{action:r},{data:u},{filename:n.fileData.name}];f={url:this.ajaxSettings.uploadUrl?this.ajaxSettings.uploadUrl:this.ajaxSettings.url,type:"POST",mode:!0,dataType:null,contentType:null,data:JSON.stringify(n.customFormData),onSuccess:null,onFailure:null,beforeSend:null};this.uploadEventArgs={action:"Upload",ajaxSettings:f,cancel:!1};this.trigger("beforeSend",this.uploadEventArgs,function(i){n.customFormData=JSON.parse(t.getValue("data",i.ajaxSettings));n.cancel=i.cancel;var r={cancel:!1,httpRequest:n.currentRequest};"function"==typeof t.getValue("beforeSend",i.ajaxSettings)&&(t.getValue("beforeSend",i.ajaxSettings)(r),t.getValue("cancel",r)&&(n.cancel=t.getValue("cancel",r)))})},u.prototype.onRemoving=function(){this.onFileUploadSuccess({count:1});1===this.uploadObj.getFilesData().length&&this.uploadDialogObj.hide()},u.prototype.onCancel=function(n){var i=JSON.stringify(t.getValue(this.pathId[this.pathId.length-1],this.feParent));n.customFormData=[{path:this.path},{action:"remove"},{data:i}]},u.prototype.onClearing=function(){this.isOpened&&this.uploadDialogObj.hide()},u.prototype.onSelected=function(n){if(0!==n.filesData.length){this.uploadingCount=n.filesData.length;this.uploadedCount=0;var t=a(this);if(!gc(t))return n.cancel=!0,void e(this,t,gh);this.uploadDialogObj.show()}},u.prototype.onFileUploadSuccess=function(n){this.uploadedCount=this.uploadedCount+n.count;this.uploadSettings.autoClose&&this.uploadingCount===this.uploadedCount&&this.uploadDialogObj.hide()},u.prototype.onChunkUploadComplete=function(n){if(0!==this.retryArgs.length)for(var i=0;i<this.retryArgs.length;i++)(t.isNullOrUndefined(n)?"":t.getValue("file",n).name)===this.retryArgs[i].file.name&&(this.retryArgs.splice(i,1),i=this.retryArgs.length)},u.prototype.onUploadSuccess=function(n){this.uploadSettings.chunkSize>0&&this.onChunkUploadComplete(n);var i={action:"Upload",result:n};this.trigger("success",i);this.itemData=[t.getValue(this.pathId[this.pathId.length-1],this.feParent)];o(this,y,this.path);this.onFileUploadSuccess({count:1});"function"==typeof t.getValue("onSuccess",this.uploadEventArgs.ajaxSettings)&&t.getValue("onSuccess",this.uploadEventArgs.ajaxSettings)()},u.prototype.onUploadFailure=function(n){var i,r,u;this.uploadSettings.chunkSize>0&&this.onChunkUploadComplete(n);i=t.getValue("response",n);r=t.getValue("statusText",i);""!==r&&t.setValue("statusText",r,n);u={action:"Upload",error:n};this.trigger("failure",u);400===t.getValue("statusCode",i)&&(this.retryFiles.push(t.getValue("file",n)),this.isRetryOpened||tf(this,"UploadRetry"));"function"==typeof t.getValue("onFailure",this.uploadEventArgs.ajaxSettings)&&t.getValue("onFailure",this.uploadEventArgs.ajaxSettings)()},u.prototype.onInitialEnd=function(){cc(this,this.path)},u.prototype.addEventListeners=function(){this.on(bi,this.showSpinner,this);this.on(lt,this.hideSpinner,this);this.on(fi,this.onInitialEnd,this);this.on(it,this.onDetailsInit,this);this.on(fo,this.onFileUploadSuccess,this);t.EventHandler.add(this.element,"contextmenu",this.onContextMenu,this)},u.prototype.removeEventListeners=function(){this.isDestroyed||(this.off(bi,this.showSpinner),this.off(lt,this.hideSpinner),this.off(fi,this.onInitialEnd),this.off(it,this.onDetailsInit),this.off(fo,this.onFileUploadSuccess),t.EventHandler.remove(this.element,"contextmenu",this.onContextMenu))},u.prototype.onDetailsInit=function(){t.isNullOrUndefined(this.activeModule)&&(this.itemData=[t.getValue(this.pathId[this.pathId.length-1],this.feParent)])},u.prototype.resizeHandler=function(){this.adjustHeight();this.notify(pi,{})},u.prototype.keyActionHandler=function(n){switch(n.action){case"altN":n.preventDefault();this.itemData=[a(this)];os(this.itemData[0])?s(this,"NewFolder"):e(this,this.itemData[0],yo);break;case"f5":n.preventDefault();ti(this);break;case"ctrlShift1":n.preventDefault();this.fileView="Details";this.setProperties({view:"Details"},!0);nt.showSpinner(this.element);at(this,"Details");break;case"ctrlShift2":n.preventDefault();this.fileView="LargeIcons";this.setProperties({view:"LargeIcons"},!0);nt.showSpinner(this.element);at(this,"LargeIcons");break;case"ctrlU":n.preventDefault();-1!==this.toolbarSettings.items.indexOf("Upload")&&t.select("#"+this.element.id+ff,this.element).click()}},u.prototype.wireSelectOnDragEvent=function(n){t.isNullOrUndefined(this.view)||(n&&(this.viewElem="LargeIcons"===this.view?this.largeiconsviewModule.element:this.element.querySelector(".e-gridcontent")),n?this.allowMultiSelection&&(this.on(g,this.onLayoutChange,this),this.on(c,this.onLayoutChange,this)):(this.off(g,this.onLayoutChange),this.off(c,this.onLayoutChange)),this.viewElem&&(n&&this.allowMultiSelection?t.EventHandler.add(this.viewElem,"mousedown",this.onDragStart,this):t.EventHandler.remove(this.viewElem,"mousedown",this.onDragStart)))},u.prototype.wireEvents=function(){this.enableRangeSelection&&this.wireSelectOnDragEvent(!0);t.EventHandler.add(window,"resize",this.resizeHandler,this);this.contextMenuSettings.visible&&this.element.addEventListener("scroll",this.onScrollHandler,!0);this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},u.prototype.unWireEvents=function(){this.wireSelectOnDragEvent(!1);t.EventHandler.remove(window,"resize",this.resizeHandler);this.contextMenuSettings.visible&&this.element.removeEventListener("scroll",this.onScrollHandler,!0);this.keyboardModule.destroy()},u.prototype.onDragStart=function(n){if(this.viewElem){if(this.allowDragAndDrop&&t.closest(n.target,this.viewElem.classList.contains("e-large-icons")?".e-list-item":".e-fe-text"))return;n.preventDefault();this.dragX=n.pageX;this.dragY=n.pageY;this.dragSelectElement||(this.dragSelectElement=t.createElement("div",{id:this.element.id+"_drag",className:"e-filemanager e-drag-select",styles:"left: "+this.dragX+"px;top: "+this.dragY+"px;"}),document.body.append(this.dragSelectElement));t.EventHandler.add(document,"mouseup",this.onDragStop,this);t.EventHandler.add(this.viewElem,"mousemove",this.onDrag,this);t.EventHandler.add(this.dragSelectElement,"mousemove",this.onDrag,this)}},u.prototype.onDrag=function(n){if(n.stopPropagation(),this.dragSelectElement){var i=n.pageX-this.dragX,r=n.pageY-this.dragY;t.setStyleAttribute(this.dragSelectElement,{left:i<0?this.dragX+i+"px":this.dragX+"px",top:r<0?this.dragY+r+"px":this.dragY+"px",height:Math.abs(r)+"px",width:Math.abs(i)+"px"});this.selectItems()}else t.EventHandler.remove(this.viewElem,"mousemove",this.onDrag)},u.prototype.onDragStop=function(){this.viewElem&&(t.EventHandler.remove(document,"mouseup",this.onDragStop),t.EventHandler.remove(this.viewElem,"mousemove",this.onDrag));this.dragSelectElement&&(t.EventHandler.remove(this.dragSelectElement,"mousemove",this.onDrag),this.dragSelectElement.clientHeight>0&&this.dragSelectElement.clientWidth>0&&this.setProperties({selectedItems:this.dragSelectedItems}),this.dragSelectedItems=[],t.detach(this.dragSelectElement),this.dragSelectElement=null)},u.prototype.selectItems=function(){var n=this.dragSelectElement.getBoundingClientRect(),u,f,i,r;for(n.height>0&&n.width>0&&(this.dragSelectedItems=[],t.removeClass(t.selectAll(".e-active",this.viewElem),["e-active","e-focus"]),t.removeClass(t.selectAll(".e-check",this.viewElem),["e-check"])),u=0,f=t.selectAll(this.viewElem.classList.contains("e-large-icons")?".e-list-item":".e-row",this.viewElem);u<f.length;u++)i=f[u],r=i.getBoundingClientRect(),!(n.right<r.left||n.left>r.right||n.bottom<r.top||n.top>r.bottom)&&n.height>0&&n.width>0&&(this.viewElem.classList.contains("e-large-icons")?(i.classList.add("e-active"),this.dragSelectedItems.push(i.getAttribute("title"))):(t.addClass(t.selectAll(".e-rowcell",i),["e-active"]),this.dragSelectedItems.push(i.querySelector(".e-drag-text").textContent)),this.showItemCheckBoxes&&i.querySelector(".e-frame").classList.add("e-check"))},u.prototype.onLayoutChange=function(){this.enableRangeSelection&&(this.unWireEvents(),this.wireEvents())},u.prototype.setPath=function(){this.setProperties({selectedItems:[]},!0);this.ensurePath();this.notify(yf,{selectedNode:this.pathId[0]});o(this,this.path!==this.originalPath?fi:tt,this.path)},u.prototype.onPropertyChanged=function(n,i){for(var e,o,h=this,r=!1,u=0,s=Object.keys(n);u<s.length;u++)switch(s[u]){case"ajaxSettings":this.ajaxSettingSetModel(n);break;case"allowDragAndDrop":this.allowDragAndDrop=n.allowDragAndDrop;this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"showItemCheckBoxes":this.showItemCheckBoxes=n.showItemCheckBoxes;this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"enableVirtualization":this.enableVirtualization=n.enableVirtualization;r=!0;break;case"allowMultiSelection":this.allowMultiSelection?t.addClass([this.element],ef):(this.selectedItems.length>1&&this.setProperties({selectedItems:this.selectedItems.slice(this.selectedItems.length-1)},!0),t.removeClass([this.element],ef));this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"cssClass":this.addCssClass(i.cssClass,n.cssClass);this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"detailsViewSettings":this.notify(f,{module:"detailsview",newProp:n,oldProp:i});break;case"enableRangeSelection":this.wireSelectOnDragEvent(!1);n.enableRangeSelection&&this.wireSelectOnDragEvent(!0);break;case"enableRtl":this.enableRtl=n.enableRtl;r=!0;break;case"rootAliasName":this.rootAliasName=n.rootAliasName;r=!0;break;case"height":o=t.isNullOrUndefined(n.height)?n.height:t.formatUnit(n.height);t.setStyleAttribute(this.element,{height:o});this.adjustHeight();this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"locale":t.isNullOrUndefined(n.enableRtl)||this.setProperties({enableRtl:n.enableRtl},!0);this.localeSetModelOption(n);break;case"navigationPaneSettings":this.splitterAdjust();this.notify(f,{module:"navigationpane",newProp:n,oldProp:i});break;case"path":this.oldPath=i.path;this.setPath();break;case"searchSettings":t.isNullOrUndefined(n.searchSettings.allowSearchOnTyping)||this.setProperties({searchSettings:{allowSearchOnTyping:n.searchSettings.allowSearchOnTyping}},!0);t.isNullOrUndefined(n.searchSettings.ignoreCase)&&this.setProperties({searchSettings:{ignoreCase:n.searchSettings.ignoreCase}},!0);t.isNullOrUndefined(n.searchSettings.filterType)&&this.setProperties({searchSettings:{filterType:n.searchSettings.filterType}},!0);this.notify(f,{module:"breadcrumbbar",newProp:n,oldProp:i});break;case"selectedItems":"Details"===this.view?this.notify(f,{module:"detailsview",newProp:n,oldProp:i}):"LargeIcons"===this.view&&this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"showFileExtension":case"showHiddenItems":this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"showThumbnail":this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"toolbarSettings":case"toolbarItems":this.adjustHeight();this.notify(f,{module:"toolbar",newProp:n,oldProp:i});break;case"uploadSettings":this.updateUploader();break;case"view":"Details"===n.view?this.notify(f,{module:"detailsview",newProp:n,oldProp:i}):"LargeIcons"===n.view&&this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"width":t.setStyleAttribute(this.element,{width:t.isNullOrUndefined(n.width)?n.width:t.formatUnit(n.width)});this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"sortOrder":ti(this);this.notify(dt,{});break;case"sortBy":if("Details"===this.view){if(e=this.detailsViewSettings.columns,t.isNullOrUndefined(e)||-1===e.findIndex(function(n){return n.field===h.sortBy}))return;ti(this);this.notify(dt,{});this.notify(wf,{})}else ti(this),this.notify(dt,{});break;case"popupTarget":this.uploadDialogObj&&(this.uploadDialogObj.target=n.popupTarget);this.dialogObj&&(this.dialogObj.target=n.popupTarget);this.extDialogObj&&(this.extDialogObj.target=n.popupTarget);this.viewerObj&&(this.viewerObj.target=n.popupTarget);break;case"fileSystemData":this.fileSystemData=n.fileSystemData;r=!0}r&&this.refresh()},u.prototype.ajaxSettingSetModel=function(i){t.isNullOrUndefined(i.ajaxSettings.url)||this.setProperties({ajaxSettings:{url:i.ajaxSettings.url}},!0);t.isNullOrUndefined(i.ajaxSettings.uploadUrl)||this.setProperties({ajaxSettings:{uploadUrl:i.ajaxSettings.uploadUrl}},!0);t.isNullOrUndefined(i.ajaxSettings.downloadUrl)||this.setProperties({ajaxSettings:{downloadUrl:i.ajaxSettings.downloadUrl}},!0);t.isNullOrUndefined(i.ajaxSettings.getImageUrl)||this.setProperties({ajaxSettings:{getImageUrl:i.ajaxSettings.getImageUrl}},!0);this.setProperties({path:"/"},!0);this.setProperties({selectedItems:[]},!0);n.prototype.refresh.call(this)},u.prototype.localeSetModelOption=function(t){this.uploadObj.locale=t.locale;n.prototype.refresh.call(this)},u.prototype.destroy=function(){this.isDestroyed||(this.refreshing||this.notify(ct,{}),this.uploadObj.destroy(),this.uploadObj=null,this.uploadDialogObj.destroy(),this.uploadDialogObj=null,this.splitterObj.destroy(),this.splitterObj=null,this.dialogObj&&(this.dialogObj.destroy(),this.dialogObj=null),this.viewerObj&&(this.viewerObj.destroy(),this.viewerObj=null),this.extDialogObj&&(this.extDialogObj.destroy(),this.extDialogObj=null),this.element.removeAttribute("style"),this.element.removeAttribute("tabindex"),this.removeEventListeners(),this.unWireEvents(),this.addCssClass(this.cssClass,null),t.removeClass([this.element],[io,nh,ef]),this.element.innerHTML="",this.breadCrumbBarNavigation=null,this.activeElements=null,this.virtualDragElement=null,this.visitedItem=null,n.prototype.destroy.call(this),this.virtualizationModule=null,this.navigationpaneModule=null,this.toolbarModule=null,this.contextmenuModule=null,this.largeiconsviewModule=null,this.detailsviewModule=null,this.breadcrumbbarModule=null,this.viewElem=null,this.dragSelectElement=null,this.dragSelectedItems=null)},u.prototype.createFolder=function(n){this.notify(ot,{action:"createFolder"});var t=[a(this)];this.itemData=t;n?/[/\\|*?"<>:]/.test(n)?s(this,"Error",{files:null,error:{code:"402",message:i(this,"Validation-Invalid").replace("{0}",'"'+n+'"'),fileExists:null}}):os(t[0])?tl(this,n):e(this,t[0],yo):ss(this)},u.prototype.deleteFiles=function(n){this.notify(ot,{action:"deleteFiles",ids:n})},u.prototype.disableToolbarItems=function(n){!t.isNullOrUndefined(n)&&this.toolbarModule&&this.toolbarModule.enableItems(n,!1)},u.prototype.downloadFiles=function(n){this.notify(ot,{action:"downloadFiles",ids:n})},u.prototype.enableToolbarItems=function(n){!t.isNullOrUndefined(n)&&this.toolbarModule&&this.toolbarModule.enableItems(n,!0)},u.prototype.enableMenuItems=function(n){t.isNullOrUndefined(n)||t.isNullOrUndefined(this.contextmenuModule)||t.isNullOrUndefined(this.contextmenuModule.contextMenu)||this.contextmenuModule.enableItems(n,!0,!0)},u.prototype.disableMenuItems=function(n){t.isNullOrUndefined(n)||t.isNullOrUndefined(this.contextmenuModule)||t.isNullOrUndefined(this.contextmenuModule.contextMenu)||this.contextmenuModule.disableItem(n)},u.prototype.getMenuItemIndex=function(n){return this.contextmenuModule?this.contextmenuModule.getItemIndex(n):-1},u.prototype.getToolbarItemIndex=function(n){return this.toolbarModule?this.toolbarModule.getItemIndex(n):-1},u.prototype.filterFiles=function(n){this.filterData=n||null;this.setProperties({selectedItems:[]},!0);this.notify(c,{});this.isFiltered=!0;""!==this.breadcrumbbarModule.searchObj.element.value&&(this.breadcrumbbarModule.searchObj.element.value="");ls(this,fu)},u.prototype.getSelectedFiles=function(){return this.notify(hu,{}),this.itemData},u.prototype.openFile=function(n){this.notify(ot,{action:"openFile",id:n})},u.prototype.refreshFiles=function(){ti(this)},u.prototype.refreshLayout=function(){this.adjustHeight();this.notify(ki,{})},u.prototype.selectAll=function(){this.notify(ot,{action:"selectAll"})},u.prototype.traverseBackward=function(){var n,t;this.pathNames.length>1&&""===this.breadcrumbbarModule.searchObj.element.value&&!this.isFiltered&&(this.pathId.pop(),this.pathNames.pop(),n=this.pathNames.slice(1).join("/"),n=""===n?"/":"/"+n+"/",this.setProperties({path:n},!0),o(this,y,this.path),t=this.pathId[this.pathId.length-1],this.notify(su,{module:"treeview",selectedNode:t}))},u.prototype.clearSelection=function(){this.notify(ot,{action:"clearSelection"})},u.prototype.renameFile=function(n,t){this.notify(ot,{action:"renameFile",id:n,newName:t})},u.prototype.uploadFiles=function(){var n=[a(this)];this.itemData=n;hs(this)},u.prototype.closeDialog=function(){yv(this)},u.prototype.setRtl=function(n){n?this.addCssClass(null,io):this.addCssClass(io,null);this.uploadObj&&(this.uploadDialogObj.enableRtl=n,this.uploadObj.enableRtl=n)},r([t.Complex({},pl)],u.prototype,"ajaxSettings",void 0),r([t.Property([])],u.prototype,"fileSystemData",void 0),r([t.Property(!1)],u.prototype,"allowDragAndDrop",void 0),r([t.Property(!0)],u.prototype,"allowMultiSelection",void 0),r([t.Property(!0)],u.prototype,"showItemCheckBoxes",void 0),r([t.Complex({},ea)],u.prototype,"contextMenuSettings",void 0),r([t.Property("")],u.prototype,"cssClass",void 0),r([t.Complex({},ia)],u.prototype,"detailsViewSettings",void 0),r([t.Property(!0)],u.prototype,"enableHtmlSanitizer",void 0),r([t.Property(!1)],u.prototype,"enablePersistence",void 0),r([t.Property(!1)],u.prototype,"enableVirtualization",void 0),r([t.Property("400px")],u.prototype,"height",void 0),r([t.Property("LargeIcons")],u.prototype,"view",void 0),r([t.Complex({},oa)],u.prototype,"navigationPaneSettings",void 0),r([t.Property("/")],u.prototype,"path",void 0),r([t.Property(null)],u.prototype,"popupTarget",void 0),r([t.Complex({},gl)],u.prototype,"searchSettings",void 0),r([t.Property()],u.prototype,"selectedItems",void 0),r([t.Property(!0)],u.prototype,"showFileExtension",void 0),r([t.Property(null)],u.prototype,"rootAliasName",void 0),r([t.Property(!1)],u.prototype,"showHiddenItems",void 0),r([t.Property(!0)],u.prototype,"showThumbnail",void 0),r([t.Property("Ascending")],u.prototype,"sortOrder",void 0),r([t.Property("name")],u.prototype,"sortBy",void 0),r([t.Property(null)],u.prototype,"sortComparer",void 0),r([t.Property(!1)],u.prototype,"enableRangeSelection",void 0),r([t.Complex({},kl)],u.prototype,"toolbarSettings",void 0),r([t.Collection([],dl)],u.prototype,"toolbarItems",void 0),r([t.Complex({},sa)],u.prototype,"uploadSettings",void 0),r([t.Property("100%")],u.prototype,"width",void 0),r([t.Event()],u.prototype,"fileLoad",void 0),r([t.Event()],u.prototype,"fileOpen",void 0),r([t.Event()],u.prototype,"beforeDownload",void 0),r([t.Event()],u.prototype,"beforeImageLoad",void 0),r([t.Event()],u.prototype,"beforePopupClose",void 0),r([t.Event()],u.prototype,"beforePopupOpen",void 0),r([t.Event()],u.prototype,"beforeSend",void 0),r([t.Event()],u.prototype,"created",void 0),r([t.Event()],u.prototype,"beforeFolderCreate",void 0),r([t.Event()],u.prototype,"folderCreate",void 0),r([t.Event()],u.prototype,"destroyed",void 0),r([t.Event()],u.prototype,"beforeDelete",void 0),r([t.Event()],u.prototype,"delete",void 0),r([t.Event()],u.prototype,"beforeRename",void 0),r([t.Event()],u.prototype,"rename",void 0),r([t.Event()],u.prototype,"beforeMove",void 0),r([t.Event()],u.prototype,"move",void 0),r([t.Event()],u.prototype,"search",void 0),r([t.Event()],u.prototype,"fileDragStart",void 0),r([t.Event()],u.prototype,"fileDragging",void 0),r([t.Event()],u.prototype,"fileDragStop",void 0),r([t.Event()],u.prototype,"fileDropped",void 0),r([t.Event()],u.prototype,"fileSelection",void 0),r([t.Event()],u.prototype,"fileSelect",void 0),r([t.Event()],u.prototype,"menuClick",void 0),r([t.Event()],u.prototype,"menuOpen",void 0),r([t.Event()],u.prototype,"menuClose",void 0),r([t.Event()],u.prototype,"failure",void 0),r([t.Event()],u.prototype,"popupClose",void 0),r([t.Event()],u.prototype,"popupOpen",void 0),r([t.Event()],u.prototype,"success",void 0),r([t.Event()],u.prototype,"toolbarClick",void 0),r([t.Event()],u.prototype,"toolbarCreate",void 0),r([t.Event()],u.prototype,"uploadListCreate",void 0),h=r([t.NotifyPropertyChanges],u)}(t.Component),rb=function(){function n(n){this.default=["Delete","Rename","Download","Cut","Copy","Paste"];this.single=["Delete","Rename","Download","Cut","Copy"];this.multiple=["Delete","Download","Cut","Copy","Refresh"];this.selection=["NewFolder","Upload","SortBy","Refresh"];this.parent=n;this.render();this.addEventListener()}return n.prototype.render=function(){var n=this,t;this.items=this.toolbarItemData(this.getItems(this.parent.toolbarSettings.items.map(function(n){return n.trim()})));t={items:this.items};this.parent.trigger("toolbarCreate",t,function(t){n.items=t.items;n.toolbarObj=new vl.Toolbar({items:n.items,created:n.toolbarCreateHandler.bind(n),overflowMode:"Popup",clicked:n.onClicked.bind(n),enableHtmlSanitizer:n.parent.enableHtmlSanitizer,enableRtl:n.parent.enableRtl});n.toolbarObj.isStringTemplate=!0;n.toolbarObj.root=n.parent.root?n.parent.root:n.parent;n.toolbarObj.appendTo("#"+n.parent.element.id+uf)})},n.prototype.getItemIndex=function(n){for(var i=this.getId(n),t=0;t<this.items.length;t++)if(this.items[t].id===i)return t;return-1},n.prototype.getItems=function(n){var t=n.slice();return this.parent.isDevice&&this.parent.allowMultiSelection&&t.push("SelectAll"),this.parent.toolbarItems.length>0&&(t=this.parent.toolbarItems.map(function(n){return n.name})),t},n.prototype.onClicked=function(n){var i=this,r,u,f;!t.isNullOrUndefined(n.item)&&n.item.id&&(u=n.item.id.substr((this.parent.element.id+"_tb_").length),"refresh"===u||"newfolder"===u||"upload"===u?(r=[a(this.parent)],this.parent.itemData=r):(this.parent.notify(hi,{}),r=this.parent.itemData),f={cancel:!1,fileDetails:r,item:n.item},this.parent.trigger("toolbarClick",f,function(f){var h,c,o;if(!f.cancel)switch(u){case"sortby":(c=t.closest(n.originalEvent.target,"."+pa))&&c.classList.contains("e-toolbar-popup")&&(n.cancel=!0);break;case"newfolder":ss(i.parent);break;case"cut":au(i.parent);break;case"copy":lu(i.parent);break;case"delete":for(o=0;o<r.length;o++)if(!p(r[o]))return void e(i.parent,r[o],rt);s(i.parent,"Delete");break;case"details":i.parent.notify(it,{});h=i.parent.selectedItems;"navigationpane"===i.parent.activeModule&&(h=[]);du(i.parent,h,i.parent.path,"details");break;case"paste":i.parent.folderPath="";pu(i.parent);break;case"refresh":ti(i.parent);break;case"download":bc(i.parent);break;case"rename":p(r[0])?(i.parent.notify(si,{}),s(i.parent,"Rename")):e(i.parent,r[0],rt);break;case"upload":hs(i.parent);break;case"selectall":i.parent.notify(lr,{});break;case"selection":i.parent.notify(eu,{})}}))},n.prototype.toolbarCreateHandler=function(){var f=this,u;if(t.isNullOrUndefined(t.select("#"+this.getId("SortBy"),this.parent.element))||(u=[{id:this.getPupupId("name"),text:i(this.parent,"Name"),iconCss:"name"===this.parent.sortBy?ht:""},{id:this.getPupupId("size"),text:i(this.parent,"Size"),iconCss:"size"===this.parent.sortBy?ht:""},{id:this.getPupupId("date"),text:i(this.parent,"DateModified"),iconCss:"_fm_modified"===this.parent.sortBy?ht:""},{separator:!0},{id:this.getPupupId("ascending"),text:i(this.parent,"Ascending"),iconCss:"Ascending"===this.parent.sortOrder?b:""},{id:this.getPupupId("descending"),text:i(this.parent,"Descending"),iconCss:"Descending"===this.parent.sortOrder?b:""},{id:this.getPupupId("none"),text:i(this.parent,"None"),iconCss:"None"===this.parent.sortOrder?b:""}],this.buttonObj=new ll.DropDownButton({items:u,cssClass:yt(this.parent,st),select:sc.bind(this,this.parent),enableHtmlSanitizer:this.parent.enableHtmlSanitizer,enableRtl:this.parent.enableRtl,iconCss:yh}),this.buttonObj.isStringTemplate=!0,this.buttonObj.appendTo("#"+this.getId("SortBy"))),!t.isNullOrUndefined(t.select("#"+this.getId("View"),this.parent.element))){var e='<span class="'+sr+" "+er+'"><\/span>',o='<span class="'+hr+" "+er+'"><\/span>',s=[{id:this.getPupupId("large"),text:i(this.parent,"View-LargeIcons"),iconCss:"Details"===this.parent.view?"":b},{id:this.getPupupId("details"),text:i(this.parent,"View-Details"),iconCss:"Details"===this.parent.view?b:""}];this.layoutBtnObj=new ll.DropDownButton({iconCss:"Details"===this.parent.view?sr:hr,cssClass:yt(this.parent,"e-caret-hide "+st),items:s,select:this.layoutChange.bind(this),enableRtl:this.parent.enableRtl,content:'<span class="e-tbar-btn-text">'+i(this.parent,"View")+"<\/span>",beforeItemRender:function(n){var r=n.item.iconCss,u=n.item.text===i(f.parent,"View-LargeIcons"),s=r?" e-menu-icon "+r:"",t;n.element.innerHTML='<span class="'+s+'"><\/span>'+(u?o:e)+n.item.text;t=n.element.firstChild;t&&""===t.className&&n.element.removeChild(t)}});this.layoutBtnObj.isStringTemplate=!0;this.layoutBtnObj.appendTo("#"+this.getId("View"))}this.hideItems(this.default,!0);this.hideStatus();this.parent.portals&&this.toolbarObj.portals&&(this.parent.portals=this.parent.portals.concat(this.toolbarObj.portals),this.parent.renderReactTemplates());for(var n=t.selectAll(".e-btn",this.toolbarObj.element),h=function(t){n[t].onkeydown=function(n){13!==n.keyCode||n.target.classList.contains("e-fe-popup")||n.preventDefault()};n[t].onkeyup=function(i){13!==i.keyCode||i.target.classList.contains("e-fe-popup")||n[t].click()}},r=0;r<n.length;r++)h(r);this.parent.refreshLayout()},n.prototype.updateSortByButton=function(){if(this.buttonObj)for(var t=this.buttonObj.items,n=0;n<t.length;n++)t[n].id===this.getPupupId("name")?t[n].iconCss="name"===this.parent.sortBy?ht:"":t[n].id===this.getPupupId("size")?t[n].iconCss="size"===this.parent.sortBy?ht:"":t[n].id===this.getPupupId("date")?t[n].iconCss="dateModified"===this.parent.sortBy||"dateCreated"===this.parent.sortBy?this.parent.sortBy==this.parent.sortBy?ht:"":"_fm_modified"===this.parent.sortBy?ht:"":t[n].id===this.getPupupId("ascending")?t[n].iconCss="Ascending"===this.parent.sortOrder?b:"":t[n].id===this.getPupupId("descending")?t[n].iconCss="Descending"===this.parent.sortOrder?b:"":t[n].id===this.getPupupId("none")&&(t[n].iconCss="None"===this.parent.sortOrder?b:"")},n.prototype.getPupupId=function(n){return this.parent.element.id+"_ddl_"+n.toLowerCase()},n.prototype.layoutChange=function(n){"Details"===this.parent.view?n.item.id===this.getPupupId("large")&&at(this.parent,"LargeIcons"):n.item.id===this.getPupupId("details")&&at(this.parent,"Details")},n.prototype.toolbarItemData=function(n){var h=[],e="Both",s,t,o,c,l,a;for(this.parent.isMobile&&(e="Overflow"),s=0;s<n.length;s++){t=void 0;o=void 0;this.parent.toolbarItems.length>0&&(o=this.getItemModel(this.parent.toolbarItems[parseInt(s.toString(),10)]));var r=this.getId(n[s]),u=i(this.parent,n[s]),f=i(this.parent,"Tooltip-"+n[s]);switch(n[s]){case"|":t={type:"Separator"};break;case"Upload":t={id:r,text:u,tooltipText:f,prefixIcon:eh,showTextOn:e};break;case"SortBy":c='<span class="e-tbar-btn-text e-tbar-ddb-text">'+u+"<\/span>";o&&o.text&&(c='<span class="e-tbar-btn-text e-tbar-ddb-text">'+o.text+"<\/span>");t={id:r,tooltipText:f,template:'<button id="'+r+'" class="e-tbar-btn e-tbtn-txt" tabindex="-1">'+c+"<\/button>"};break;case"Refresh":t={id:r,text:u,tooltipText:f,prefixIcon:ph,showTextOn:e};break;case"Selection":t={id:r,text:u,tooltipText:f,suffixIcon:iv,overflow:"Show",align:"Right"};break;case"View":l=o&&o.text?o.text:i(this.parent,"View");t={id:r,tooltipText:f,prefixIcon:"Details"===this.parent.view?sr:hr,overflow:"Show",align:"Right",text:u,showTextOn:"Overflow",template:'<button id="'+r+'" class="e-tbar-btn e-tbtn-txt" tabindex="-1" aria-label='+l+"><\/button>"};break;case"Details":t={id:r,tooltipText:f,prefixIcon:vh,overflow:"Show",align:"Right",text:u,showTextOn:"Overflow"};break;case"NewFolder":t={id:r,text:u,tooltipText:f,prefixIcon:ah,showTextOn:e};break;case"Cut":t={id:r,text:u,tooltipText:f,prefixIcon:oh,showTextOn:e};break;case"Copy":t={id:r,text:u,tooltipText:f,prefixIcon:sh,showTextOn:e};break;case"Paste":t={id:r,text:u,tooltipText:f,prefixIcon:hh,showTextOn:e};break;case"Delete":t={id:r,text:u,tooltipText:f,prefixIcon:ch,showTextOn:e};break;case"Rename":t={id:r,text:u,tooltipText:f,prefixIcon:lh,showTextOn:e};break;case"Download":t={id:r,text:u,tooltipText:f,prefixIcon:bh,showTextOn:e};break;case"SelectAll":t={id:r,text:u,tooltipText:f,prefixIcon:wh,showTextOn:e};break;default:t={id:r,text:u,tooltipText:f,template:""}}this.parent.toolbarItems.length>0&&o?(a=Object.assign({},t,o),h.push(a)):h.push(t)}return h},n.prototype.getItemModel=function(n){var t={};return n.id&&(t.id=n.id),n.text&&(t.text=n.text),n.tooltipText&&(t.tooltipText=n.tooltipText),n.prefixIcon&&(t.prefixIcon=n.prefixIcon),n.cssClass&&(t.cssClass=n.cssClass),"Both"!==n.showTextOn&&(t.showTextOn=n.showTextOn),n.template&&(t.template=n.template),n.disabled&&(t.disabled=n.disabled),"auto"!==n.width&&(t.width=n.width),n.suffixIcon&&(t.suffixIcon=n.suffixIcon),"Left"!==n.align&&(t.align=n.align),"None"!==n.overflow&&(t.overflow=n.overflow),n.htmlAttributes&&(t.htmlAttributes=n.htmlAttributes),"Button"!==n.type&&(t.type=n.type),!0!==n.visible&&(t.visible=n.visible),n.showAlwaysInPopup&&(t.showAlwaysInPopup=n.showAlwaysInPopup),-1!==n.tabIndex&&(t.tabIndex=n.tabIndex),t},n.prototype.getId=function(n){return this.parent.element.id+"_tb_"+n.toLowerCase()},n.prototype.addEventListener=function(){this.parent.on(f,this.onPropertyChanged,this);this.parent.on(c,this.onSelectionChanged,this);this.parent.on(g,this.onLayoutChange,this);this.parent.on(oo,this.showPaste,this);this.parent.on(ou,this.hidePaste,this);this.parent.on(ct,this.destroy,this);this.parent.on(dt,this.updateSortByButton,this)},n.prototype.reRenderToolbar=function(n){var t=this,i=[],r;(this.parent.toolbarItems.length>0?i=this.parent.toolbarItems.map(function(n){return n.name}):void 0!==n.newProp.toolbarSettings.items&&(i=n.newProp.toolbarSettings.items.map(function(n){return n.trim()})),i.length>0)&&(this.items=this.toolbarItemData(this.getItems(i)),r={items:this.items},this.parent.trigger("toolbarCreate",r,function(n){t.buttonObj&&t.buttonObj.destroy();t.layoutBtnObj&&t.layoutBtnObj.destroy();t.items=n.items;t.toolbarObj.items=t.items;t.toolbarObj.dataBind();t.toolbarCreateHandler()}))},n.prototype.onSelectionChanged=function(){var n,r;this.hideStatus();this.hideItems(this.single,!0);this.hideItems(this.selection,!1);1===this.parent.selectedItems.length?(this.hideItems(this.single,!1),this.hideItems(this.selection,!0)):this.parent.selectedItems.length>1&&(this.hideItems(this.multiple,!1),this.hideItems(this.selection,!0));n=t.select("#"+this.getId("Selection"),this.toolbarObj.element);this.parent.selectedItems.length>0&&n&&!this.parent.enableVirtualization&&(r=1===this.parent.selectedItems.length?this.parent.selectedItems.length+" "+i(this.parent,"Item-Selection"):this.parent.selectedItems.length+" "+i(this.parent,"Items-Selection"),t.select(".e-tbar-btn-text",n).textContent=r,this.toolbarObj.hideItem(n.parentElement,!1))},n.prototype.hideItems=function(n,i){for(var u,r=0;r<n.length;r++)u=t.select("#"+this.getId(n[r]),this.parent.element),u&&this.toolbarObj.hideItem(u.parentElement,i)},n.prototype.hideStatus=function(){var n=t.select("#"+this.getId("Selection"),this.toolbarObj.element);n&&this.toolbarObj.hideItem(n.parentElement,!0)},n.prototype.showPaste=function(){this.hideItems(["Paste"],!1)},n.prototype.hidePaste=function(){this.hideItems(["Paste"],!0)},n.prototype.onLayoutChange=function(){if(this.layoutBtnObj){this.layoutBtnObj.iconCss="Details"===this.parent.view?sr:hr;for(var t=this.layoutBtnObj.items,n=0;n<t.length;n++)t[n].id===this.getPupupId("large")?t[n].iconCss="LargeIcons"===this.parent.view?b:"":t[n].id===this.getPupupId("details")&&(t[n].iconCss="Details"===this.parent.view?b:"")}},n.prototype.removeEventListener=function(){this.parent.off(f,this.onPropertyChanged);this.parent.off(c,this.onSelectionChanged);this.parent.off(g,this.onLayoutChange);this.parent.off(oo,this.showPaste);this.parent.off(ou,this.hidePaste);this.parent.off(ct,this.destroy);this.parent.off(dt,this.updateSortByButton)},n.prototype.getModuleName=function(){return"toolbar"},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"cssClass":this.buttonObj&&(this.buttonObj.cssClass=yt(this.parent,st));this.layoutBtnObj&&(this.layoutBtnObj.cssClass=yt(this.parent,"e-caret-hide "+st));break;case"height":case"width":this.toolbarObj.refreshOverflow();break;case"toolbarSettings":case"toolbarItems":this.reRenderToolbar(n)}},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.buttonObj&&this.buttonObj.destroy(),this.layoutBtnObj&&this.layoutBtnObj.destroy(),this.toolbarObj.destroy(),this.parent.refreshLayout())},n.prototype.enableItems=function(n,i){for(var u,r=0;r<n.length;r++)u=t.select("#"+this.getId(n[r]),this.parent.element),u&&this.toolbarObj.enableItems(u.parentElement,i)},n}(),ub=function(){function n(n){this.filemanagerInstance=n;this.largeIconInstance=n.largeiconsviewModule}return n.prototype.setUIVirtualization=function(){var n=this.largeIconInstance.items,r=n.slice(0,1),i=ys.ListBase.createListFromJson(t.createElement,r,this.largeIconInstance.listObj);this.itemList=Array.prototype.slice.call(t.selectAll("."+w,i));this.largeIconInstance.element.appendChild(i);0!==this.itemList.length&&this.largeIconInstance.element.querySelector("."+k)&&this.largeIconInstance.element.removeChild(this.largeIconInstance.element.querySelector("."+k));this.itemCount=this.getItemCount(Object.keys(this.largeIconInstance.allItems).length);this.largeIconInstance.element.firstChild.remove();this.largeIconInstance.items=n.slice(0,this.itemCount)},n.prototype.setUlElementHeight=function(){this.lastRowCount=(this.largeIconInstance.allItems.length-this.itemCount)%this.rowItemCount?(this.largeIconInstance.allItems.length-this.itemCount)%this.rowItemCount:this.rowItemCount;this.topElement=this.filemanagerInstance.createElement("div");this.topElement.classList.add("e-virtual-top");this.largeIconInstance.element.firstElementChild.insertBefore(this.topElement,this.largeIconInstance.element.firstElementChild.firstChild);this.bottomElement=this.filemanagerInstance.createElement("div");this.bottomElement.classList.add("e-virtual-bottom");this.largeIconInstance.element.firstElementChild.insertBefore(this.bottomElement,null);var n=parseInt(window.getComputedStyle(this.largeIconInstance.itemList[0]).getPropertyValue("margin-top"),10)+parseInt(window.getComputedStyle(this.largeIconInstance.itemList[0]).getPropertyValue("margin-bottom"),10);this.listItemHeight=this.largeIconInstance.itemList[0].getBoundingClientRect().height+n;this.totalHeight=Object.keys(this.largeIconInstance.allItems).length/this.rowItemCount*this.listItemHeight;this.topElement.style.height="0px";this.bottomElement.style.height=this.totalHeight+"px";this.topElementHeight=0;this.bottomElementHeight=this.totalHeight;this.listDiff=0;this.renderedCount=this.itemCount},n.prototype.getItemCount=function(n){var r=parseInt(window.getComputedStyle(this.itemList[0]).getPropertyValue("margin-right"),10)+parseInt(window.getComputedStyle(this.itemList[0]).getPropertyValue("margin-left"),10),i;return this.rowItemCount=Math.floor(parseFloat(t.formatUnit(this.largeIconInstance.element.firstElementChild.clientWidth))/(this.itemList[0].offsetWidth+r)),i=this.rowItemCount*Math.round(parseFloat(t.formatUnit(this.largeIconInstance.element.clientHeight))/this.itemList[0].offsetHeight),(i>n||0===i)&&(i=n),i},n.prototype.wireScrollEvent=function(n){n?t.EventHandler.remove(this.largeIconInstance.element.firstElementChild,"scroll",this.onVirtualUiScroll):t.EventHandler.add(this.largeIconInstance.element.firstElementChild,"scroll",this.onVirtualUiScroll,this)},n.prototype.onVirtualUiScroll=function(){var r,n,i;if(this.scrollPosition=t.isNullOrUndefined(this.scrollPosition)?0:this.scrollPosition,n=this.getscrollerHeight(0),this.topElementHeight=this.listItemHeight*Math.floor(n/this.listItemHeight),this.bottomElementHeight=this.totalHeight-this.topElementHeight,r=n<=this.totalHeight?[this.topElementHeight,this.bottomElementHeight]:[this.totalHeight,0],this.topElementHeight=r[0],this.bottomElementHeight=r[1],this.topElementHeight!==parseFloat(this.topElement.style.height))if(this.topElement.style.height=this.topElementHeight+"px",this.bottomElement.style.height=this.bottomElementHeight+"px",n>this.scrollPosition){i=Math.round(this.topElementHeight/this.listItemHeight-this.listDiff);this.onNormalScroll(i,!0)}else i=Math.round(this.listDiff-this.topElementHeight/this.listItemHeight),this.onNormalScroll(i,!1);this.listDiff=Math.round(this.topElementHeight/this.listItemHeight);this.scrollPosition=n;this.largeIconInstance.itemList=Array.prototype.slice.call(t.selectAll("."+w,this.largeIconInstance.element));this.itemCount=this.itemCount!==this.largeIconInstance.itemList.length?this.largeIconInstance.itemList.length:this.itemCount;this.largeIconInstance.items=this.largeIconInstance.allItems.slice(this.renderedCount-this.itemCount,this.renderedCount)},n.prototype.getscrollerHeight=function(n){return this.largeIconInstance.element.firstElementChild.scrollTop-n<=0?0:this.largeIconInstance.element.firstElementChild.scrollTop-n},n.prototype.onNormalScroll=function(n,t){for(var i=0;i<n;i++)this.updateUI(t)},n.prototype.updateUI=function(n){var o=this,u,i,r,e,s,f;if(n){if(this.items=this.largeIconInstance.allItems.slice(this.renderedCount,this.renderedCount+this.rowItemCount),this.items.length>0)for(u=ys.ListBase.createListFromJson(t.createElement,this.items,this.largeIconInstance.listObj),this.itemList=Array.prototype.slice.call(t.selectAll("."+w,u)),this.itemList.forEach(function(n){o.largeIconInstance.element.firstElementChild.insertBefore(n,o.bottomElement)}),this.renderedCount=this.largeIconInstance.allItems.length>=this.renderedCount+this.rowItemCount?this.renderedCount+this.rowItemCount:this.renderedCount+this.lastRowCount,i=0;i<this.rowItemCount;i++)t.detach(this.topElement.nextElementSibling)}else if(r=void 0,e=void 0,this.renderedCount===this.largeIconInstance.allItems.length?(r=this.renderedCount-(this.itemCount-this.rowItemCount+this.lastRowCount),this.renderedCount=this.renderedCount-this.lastRowCount<this.itemCount?this.itemCount:this.renderedCount-this.lastRowCount,e=!0):(r=this.renderedCount-this.itemCount,this.renderedCount=this.renderedCount-this.rowItemCount<this.itemCount?this.itemCount:this.renderedCount-this.rowItemCount),s=r-this.rowItemCount>0?r-this.rowItemCount:0,this.items=this.largeIconInstance.allItems.slice(s,r),this.items.length>0){for(u=ys.ListBase.createListFromJson(t.createElement,this.items,this.largeIconInstance.listObj),this.itemList=Array.prototype.slice.call(t.selectAll("."+w,u)),f=this.itemList.length;f>0;f--)this.largeIconInstance.element.firstElementChild.insertBefore(this.itemList[f-1],this.topElement.nextElementSibling);for(i=0;i<(e?this.lastRowCount:this.rowItemCount);i++)t.detach(this.bottomElement.previousElementSibling)}},n.prototype.getModuleName=function(){return"virtualization"},n.prototype.destroy=function(){this.filemanagerInstance.isDestroyed||t.isNullOrUndefined(this.largeIconInstance.element.firstElementChild)||this.wireScrollEvent(!0)},n}(),fb=function(){function n(n){this.removeNodes=[];this.moveNames=[];this.previousSelected=[];this.isDrag=!1;this.isPathDragged=!1;this.isRenameParent=!1;this.isRightClick=!1;this.isSameNodeClicked=!1;this.isNodeExpandCalled=!1;this.renameParent=null;this.isNodeClickCalled=!1;this.restrictSelecting=!1;this.parent=n;this.addEventListener();this.keyConfigs={altEnter:"alt+enter",esc:"escape",del:"delete",ctrlX:this.parent.isMac?"cmd+x":"ctrl+x",ctrlC:this.parent.isMac?"cmd+c":"ctrl+c",ctrlV:this.parent.isMac?"cmd+v":"ctrl+v",ctrlShiftN:"ctrl+shift+n",shiftF10:"shift+F10",f2:"f2"}}return n.prototype.onInit=function(){var n,i,r;t.isNullOrUndefined(this.treeObj)&&(n=t.getValue(this.parent.pathId[0],this.parent.feParent),t.setValue("_fm_icon","e-fe-folder",n),i={},r=t.getValue("id",n),t.isNullOrUndefined(r)||t.setValue("data-id",r,i),p(n)||t.setValue("class",re(n),i),t.isNullOrUndefined(i)||t.setValue("_fm_htmlAttr",i,n),this.treeObj=new vl.TreeView({fields:{dataSource:[n],id:"_fm_id",parentID:"_fm_pId",expanded:"_fm_expanded",selected:"_fm_selected",text:"name",hasChildren:"hasChild",iconCss:"_fm_icon",htmlAttributes:"_fm_htmlAttr",tooltip:"name"},enableHtmlSanitizer:this.parent.enableHtmlSanitizer,sortOrder:this.parent.navigationPaneSettings.sortOrder,nodeSelecting:this.onNodeSelecting.bind(this),nodeSelected:this.onNodeSelected.bind(this),nodeExpanding:this.onNodeExpand.bind(this),nodeClicked:this.onNodeClicked.bind(this),allowEditing:!0,nodeEditing:this.onNodeEditing.bind(this),drawNode:this.onDrowNode.bind(this),enableRtl:this.parent.enableRtl,dataBound:this.addDragDrop.bind(this)}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parent.element.id+wr),this.wireEvents())},n.prototype.addDragDrop=function(){var n=this;!this.parent.isMobile&&this.treeObj&&(this.parent.allowDragAndDrop&&t.isNullOrUndefined(this.dragObj)?this.dragObj=new t.Draggable(this.treeObj.element,{cursorAt:this.parent.dragCursorPosition,dragTarget:"."+ro,distance:5,dragArea:this.parent.element,drag:es.bind(this,this.parent),dragStart:function(t){us(n.parent,t,n.dragObj)},dragStop:rs.bind(this,this.parent),enableTailMode:!0,enableAutoScroll:!1,helper:this.dragHelper.bind(this)}):!this.parent.allowDragAndDrop&&this.dragObj&&(this.dragObj.destroy(),this.dragObj=null))},n.prototype.dragHelper=function(n){var r=n.sender.target,i;return r.classList.contains(ro)?(i=t.closest(r,"li"),this.parent.dragPath="",this.parent.dragData=[],this.parent.activeElements=[],this.parent.activeElements=[i],this.parent.dragNodes=[],df(this.parent,i),this.parent.dragData=this.getTreeData(i),this.parent.dragPath=this.getDragPath(i,this.parent.dragData[0].name),this.parent.dragNodes.push(this.parent.dragData[0].name),is(this.parent),this.parent.virtualDragElement):null},n.prototype.getDragPath=function(n,t){return ne(this.getDropPath(n,t))},n.prototype.getDropPath=function(n,t){var i=n.getAttribute("data-id");return po(n,this.parent.hasId?i:t,this.parent.hasId)},n.prototype.onDrowNode=function(n){var t={element:n.node,fileDetails:n.nodeData,module:"NavigationPane"};this.parent.trigger("fileLoad",t)},n.prototype.addChild=function(n,i,r){var f=oc(n),s=this.getTreeData(i),u,e,o,h,c,l;if(f.length>0&&s.length>0&&(null==f[0].filterPath||t.isNullOrUndefined(s[0])&&null==s[0].filterPath||f[0].filterPath!==s[0].filterPath)){for(u=0,e=f;u<f.length;)e[parseInt(u.toString(),10)]._fm_icon="e-fe-folder",o={},h=t.getValue("id",e[u]),t.isNullOrUndefined(h)||t.setValue("data-id",h,o),p(e[u])||t.setValue("class",re(e[u]),o),t.isNullOrUndefined(o)||t.setValue("_fm_htmlAttr",o,e[u]),u++;c=t.select('[data-uid="'+i+'"]',this.treeObj.element);l=t.select("ul",c);t.isNullOrUndefined(l)&&this.treeObj.addNodes(f,i,null,r)}},n.prototype.onNodeSelecting=function(n){var i,r,u;if(!n.isInteracted&&!this.isRightClick&&!this.isSameNodeClicked&&!this.isPathDragged&&!this.isRenameParent||this.restrictSelecting)return this.restrictSelecting=!1,void(this.isNodeClickCalled=!1);this.renameParent||(this.parent.activeModule="navigationpane",i=this.getTreeData(t.getValue("id",n.nodeData)),n.node.getAttribute("data-uid")!==this.parent.pathId[this.parent.pathId.length-1]&&!this.isRightClick&&!this.isNodeClickCalled||this.isSameNodeClicked||this.isPathDragged?((this.isSameNodeClicked=!1,this.isNodeClickCalled=!1,this.isSameNodeClicked)||(this.isSameNodeClicked=!0,r={action:n.action,fileDetails:i[0],isInteracted:n.isInteracted},this.parent.trigger("fileSelect",r)),this.isRightClick||(u={cancel:!1,fileDetails:i[0],module:"NavigationPane"},this.parent.trigger("fileOpen",u),n.cancel=u.cancel),n.cancel&&(this.restrictSelecting=!!this.isNodeClickCalled&&this.previousSelected[0]!==n.node.getAttribute("data-uid"),this.isNodeClickCalled=!0,this.isSameNodeClicked=!1,this.isPathDragged=!1,this.previousSelected=this.treeObj.selectedNodes,this.treeObj.setProperties({selectedNodes:[n.node.getAttribute("data-uid")]}))):this.previousSelected[0]!==n.node.getAttribute("data-uid")&&(r={action:n.action,fileDetails:i[0],isInteracted:this.isNodeClickCalled},this.parent.trigger("fileSelect",r)))},n.prototype.openFileOnContextMenuClick=function(n){var i=this.treeObj.getTreeData(n),t;this.parent.selectedItems=[];this.parent.itemData=i;this.activeNode=n;this.parent.activeModule="navigationpane";t={cancel:!1,fileDetails:i[0],module:"NavigationPane"};this.parent.trigger("fileOpen",t);this.isNodeClickCalled=!0;t.cancel||(bf(n,this.parent.itemData[0],this.parent),o(this.parent,this.isPathDragged?et:y,this.parent.path),this.parent.visitedItem=n,this.isPathDragged=this.isRenameParent=this.isRightClick=!1,this.treeObj.setProperties({selectedNodes:[n.getAttribute("data-uid")]}))},n.prototype.onNodeSelected=function(n){var i,r;(this.parent.breadcrumbbarModule&&this.parent.breadcrumbbarModule.searchObj&&!this.renameParent&&(this.parent.breadcrumbbarModule.searchObj.element.value="",this.parent.isFiltered=!1,this.isNodeClickCalled=!1),this.parent.searchedItems=[],n.isInteracted||this.isRightClick||this.isSameNodeClicked||this.isPathDragged||this.isRenameParent)?(this.activeNode=n.node,this.parent.activeModule="navigationpane",i=this.getTreeData(t.getValue("id",n.nodeData)),this.parent.selectedItems=[],this.parent.itemData=i,r=this.parent.path,!this.isRightClick&&this.isSameNodeClicked?bf(n.node,this.parent.itemData[0],this.parent):(this.parent.pathId=wo(n.node),this.parent.visitedItem=n.node),n.node.querySelector("."+to)&&null===n.node.querySelector("."+w)&&(this.expandNodeTarget="add"),r!==this.parent.path&&(!this.isRightClick&&this.isSameNodeClicked&&o(this.parent,this.isPathDragged?et:y,this.parent.path),this.parent.visitedItem=n.node),this.isPathDragged=this.isRenameParent=this.isRightClick=this.isSameNodeClicked=!1):this.parent.pathId=wo(n.node)},n.prototype.onPathDrag=function(n){this.isPathDragged=!0;this.selectResultNode(n[0])},n.prototype.onNodeExpand=function(n){if((n.isInteracted||this.isDrag)&&null===n.node.querySelector("."+w)){this.isNodeExpandCalled=!0;var r=t.getValue("text",n.nodeData),i=n.node.getAttribute("data-id"),u=!t.isNullOrUndefined(i),f=t.isNullOrUndefined(i)?r:i,e=po(n.node,f,u);this.expandNodeTarget=n.node.getAttribute("data-uid");this.parent.expandedId=this.expandNodeTarget;this.parent.itemData=this.getTreeData(t.getValue("id",n.nodeData));this.parent.pathId.push(t.getValue("id",n.nodeData));o(this.parent,eo,e)}},n.prototype.onNodeExpanded=function(n){this.addChild(n.files,this.expandNodeTarget,!1);this.parent.expandedId=null;this.isNodeExpandCalled=!1},n.prototype.onNodeClicked=function(n){if(this.parent.activeModule="navigationpane",this.previousSelected=this.treeObj.selectedNodes,this.activeNode=n.node,3===n.event.which&&n.node.getAttribute("data-uid")!==this.treeObj.selectedNodes[0])this.isRightClick=!0,this.isNodeClickCalled=!0,this.treeObj.setProperties({selectedNodes:[n.node.getAttribute("data-uid")]});else if(n.node.getAttribute("data-uid")===this.treeObj.selectedNodes[0]&&0!==this.parent.selectedItems.length){this.parent.setProperties({selectedItems:[]},!0);var t="LargeIcons"===this.parent.view?"largeiconsview":"detailsview";this.parent.notify(f,{module:t,newProp:{selectedItems:[]}})}else n.node.getAttribute("data-uid")!==this.treeObj.selectedNodes[0]||this.isNodeClickCalled||this.isNodeExpandCalled||(3===n.event.which&&(this.isRightClick=!0),this.isSameNodeClicked=!0,this.isNodeClickCalled=!0)},n.prototype.onNodeEditing=function(n){t.isNullOrUndefined(n.innerHtml)||(n.cancel=!0)},n.prototype.onPathChanged=function(n){var r,i,u;this.parent.isCut=!1;r=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feFiles);"add"===this.expandNodeTarget&&(i=t.select('[data-uid="'+this.treeObj.selectedNodes[0]+'"]',this.treeObj.element),u=t.isNullOrUndefined(i)?null:t.select("."+rr,i),t.isNullOrUndefined(u)&&this.addChild(n.files,this.treeObj.selectedNodes[0],!0),this.expandNodeTarget="");t.isNullOrUndefined(r)&&t.setValue(this.parent.pathId[this.parent.pathId.length-1],n.files,this.parent.feFiles);this.parent.uploadObj.directoryUpload&&!this.parent.hasId&&this.updateTree(n)},n.prototype.updateTree=function(n){if(this.treeObj){var t=this.treeObj.selectedNodes[0];this.updateTreeNode(n,t)}},n.prototype.updateTreeNode=function(n,t){var i=-1!==this.treeObj.expandedNodes.indexOf(t);this.removeChildNodes(t);this.addChild(n.files,t,!i)},n.prototype.removeChildNodes=function(n){var u=t.select('[data-uid="'+n+'"]',this.treeObj.element),i=t.select("."+rr,u),r=i?Array.prototype.slice.call(i.children):null;r&&this.treeObj.removeNodes(r)},n.prototype.onOpenEnd=function(n){var t=this.parent.pathId[this.parent.pathId.length-1];this.treeObj.expandAll(this.treeObj.selectedNodes);this.treeObj.setProperties({selectedNodes:[t]});this.expandNodeTarget="add";this.onPathChanged(n)},n.prototype.onOpenInit=function(n){"navigationpane"===this.parent.activeModule&&n.target.querySelector("."+to)&&this.treeObj.expandAll(this.treeObj.selectedNodes)},n.prototype.onInitialEnd=function(n){this.onInit();this.addChild(n.files,t.getValue("_fm_id",n.cwd),!1)},n.prototype.onFinalizeEnd=function(n){this.onInit();var i=t.getValue("_fm_id",n.cwd);this.addChild(n.files,i,!1);this.treeObj.setProperties({selectedNodes:[this.parent.pathId[this.parent.pathId.length-1]]})},n.prototype.onCreateEnd=function(n){this.updateTree(n)},n.prototype.onSelectedData=function(){"navigationpane"===this.parent.activeModule&&this.updateItemData()},n.prototype.onDeleteInit=function(){if("navigationpane"===this.parent.activeModule){this.updateActionData();var n=t.getValue("name",this.parent.itemData[0]);fe(this.parent,[n],this.parent.path,"delete")}},n.prototype.onDeleteEnd=function(n){if("navigationpane"===this.parent.activeModule){var i=this.treeObj.selectedNodes[0],r=t.select('[data-uid="'+i+'"]',this.treeObj.element),u=t.closest(r,"."+rr).parentElement;this.treeObj.selectedNodes=[u.getAttribute("data-uid")];this.treeObj.dataBind()}this.updateTree(n)},n.prototype.onRefreshEnd=function(n){this.updateTree(n)},n.prototype.onRenameInit=function(){"navigationpane"===this.parent.activeModule&&this.updateRenameData()},n.prototype.onRenameEndParent=function(n){var f=this.renameParent?this.renameParent:this.parent.pathId[this.parent.pathId.length-1],i,r,e;(this.updateTreeNode(n,f),this.parent.expandedId=null,this.renameParent)?this.renameParent=null:(i=[],this.parent.hasId?i=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(r=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",this.parent.renameText,!1)),r.length>0&&(i=new u.DataManager(r).executeLocal((new u.Query).where("_fm_pId","equal",f,!1)))),i.length>0&&(e=this.previousSelected.length>0&&0!==this.treeObj.getTreeData(this.previousSelected[0]).length?this.previousSelected[0]:t.getValue(this.treeObj.fields.id,i[0]),this.treeObj.selectedNodes=[e],this.treeObj.dataBind(),this.updateItemData()))},n.prototype.onRenameEnd=function(n){var r,i,f;""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?(r=this.treeObj.getTreeData(),i=[],this.parent.hasId?i=new u.DataManager(r).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(f=new u.DataManager(r).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",this.parent.currentItemText,!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1)))),i.length>0&&(this.renameParent=t.getValue(this.treeObj.fields.parentID,i[0]),this.parent.expandedId=this.renameParent,this.parent.itemData=this.getTreeData(this.renameParent),o(this.parent,pf,this.parent.filterPath.replace(/\\/g,"/")))):this.updateTree(n)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"allowDragAndDrop":this.addDragDrop();break;case"navigationPaneSettings":o(this.parent,tt,this.parent.path);n.oldProp.navigationPaneSettings.sortOrder!==n.newProp.navigationPaneSettings.sortOrder&&(this.treeObj.sortOrder=n.newProp.navigationPaneSettings.sortOrder)}},n.prototype.onDownLoadInit=function(){this.doDownload()},n.prototype.onSelectionChanged=function(n){this.treeObj.setProperties({selectedNodes:[n.selectedNode]})},n.prototype.onClearPathInit=function(n){this.removeChildNodes(n.selectedNode)},n.prototype.onDragEnd=function(n){var r,i,u;if(d(this.parent))for(this.moveNames=[],r=this.parent.dragData,i=0;i<r.length;i++)!1===t.getValue("isFile",r[i])&&this.moveNames.push(t.getValue("_fm_id",r[i]));u=this.parent.isPasteError||this.parent.isSearchDrag?this.getMoveNames(n.files,this.parent.isSearchDrag,this.parent.dragPath):this.moveNames;this.treeObj.removeNodes(u)},n.prototype.getMoveNames=function(n,i,r){for(var h,c,o,e,l,s=[],f=0;f<n.length;f++)if(!n[f].isFile&&!this.parent.hasId)for(h=n[f].previousName,i&&(c=(r+=n[f].previousName).lastIndexOf("/"),h=r.substring(c+1),r=r.substring(0,c+1)),o=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",h,!1)),e=0;e<o.length;e++)if(l=t.getValue("filterPath",o[e]),(l=l.replace(/\\/g,"/"))===r){s.push(t.getValue(this.treeObj.fields.id,o[e]));break}return s},n.prototype.onCutEnd=function(n){var t=[];this.parent.isPasteError||this.parent.isSearchCut?this.moveNames=this.getMoveNames(n.files,this.parent.isSearchCut,this.parent.targetPath):t=this.moveNames;this.treeObj.removeNodes(t)},n.prototype.selectResultNode=function(n){var r,i,e;if(this.parent.hasId)r=this.treeObj.getTreeData().filter(function(t){return t.name===n.name})[0],this.treeObj.selectedNodes=[t.getValue("_fm_id",r)],this.treeObj.dataBind();else{var o=t.getValue("filterPath",n),s=t.getValue("name",n),f=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",s,!1));f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",o,!1)),i.length>0&&(e=t.getValue(this.treeObj.fields.id,i[0]),this.treeObj.selectedNodes=[e],this.treeObj.dataBind()))}},n.prototype.onDropPath=function(n){this.onpasteEnd(n);this.selectResultNode(this.parent.dropData);this.parent.isDropEnd=!this.parent.isPasteError},n.prototype.onpasteEnd=function(n){var i=[],f,r,e;this.parent.hasId?i=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where("id","equal",t.getValue("id",n.cwd),!1)):(f=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",t.getValue("name",n.cwd),!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",t.getValue("filterPath",n.cwd),!1))));i.length>0&&(r=t.getValue(this.treeObj.fields.id,i[0]),e=-1===this.treeObj.expandedNodes.indexOf(r),this.removeChildNodes(r),this.addChild(n.files,r,e));this.parent.expandedId=null;this.onPathChanged(n);this.parent.isDragDrop&&this.checkDropPath(n)},n.prototype.checkDropPath=function(n){d(this.parent)&&(this.parent.path===this.parent.dropPath||"navigationpane"===this.parent.targetModule)||(-1===this.parent.dropPath.indexOf(ns(this.parent,n))?(this.parent.isDropEnd=!1,vc(this.parent)):this.parent.isDropEnd=!this.parent.isPasteError)},n.prototype.onpasteInit=function(){var n,i;if(this.parent.activeModule===this.getModuleName()&&this.updateItemData(),this.moveNames=[],n=this.parent.isDragDrop?this.parent.dragData:this.parent.actionRecords,n&&Array.isArray(n))for(i=0;i<n.length;i++)!1===t.getValue("isFile",n[i])&&this.moveNames.push(t.getValue("_fm_id",n[i]))},n.prototype.oncutCopyInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.activeRecords=this.getTreeData(this.treeObj.selectedNodes[0]),this.parent.activeElements=[this.activeNode])},n.prototype.addEventListener=function(){this.parent.on(f,this.onPropertyChanged,this);this.parent.on(co,this.onDownLoadInit,this);this.parent.on(fi,this.onInitialEnd,this);this.parent.on(tt,this.onFinalizeEnd,this);this.parent.on(y,this.onPathChanged,this);this.parent.on(et,this.onpasteEnd,this);this.parent.on(so,this.onCutEnd,this);this.parent.on(ci,this.onpasteInit,this);this.parent.on(eo,this.onNodeExpanded,this);this.parent.on(pt,this.onCreateEnd,this);this.parent.on(hi,this.onSelectedData,this);this.parent.on(yi,this.onDeleteInit,this);this.parent.on(wt,this.onDeleteEnd,this);this.parent.on(bt,this.onRefreshEnd,this);this.parent.on(su,this.onSelectionChanged,this);this.parent.on(oi,this.onOpenInit,this);this.parent.on(kt,this.onOpenEnd,this);this.parent.on(ct,this.destroy,this);this.parent.on(si,this.onRenameInit,this);this.parent.on(ft,this.onRenameEnd,this);this.parent.on(pf,this.onRenameEndParent,this);this.parent.on(yf,this.onClearPathInit,this);this.parent.on(gi,this.oncutCopyInit,this);this.parent.on(gt,this.onDropInit,this);this.parent.on(di,this.onMenuItemData,this);this.parent.on(lo,this.onDragEnd,this);this.parent.on(ao,this.onDragging,this);this.parent.on(ni,this.onDropPath,this);this.parent.on(it,this.onDetailsInit,this);this.parent.on(uo,this.onPathDrag,this)},n.prototype.removeEventListener=function(){this.parent.off(fi,this.onInitialEnd);this.parent.off(co,this.onDownLoadInit);this.parent.off(tt,this.onFinalizeEnd);this.parent.off(hi,this.onSelectedData);this.parent.off(f,this.onPropertyChanged);this.parent.off(y,this.onPathChanged);this.parent.off(et,this.onpasteEnd);this.parent.off(so,this.onCutEnd);this.parent.off(ci,this.onpasteInit);this.parent.off(su,this.onSelectionChanged);this.parent.off(eo,this.onNodeExpanded);this.parent.off(pt,this.onCreateEnd);this.parent.off(bt,this.onRefreshEnd);this.parent.off(oi,this.onOpenInit);this.parent.off(kt,this.onOpenEnd);this.parent.off(ct,this.destroy);this.parent.off(si,this.onRenameInit);this.parent.off(ft,this.onRenameEnd);this.parent.off(pf,this.onRenameEndParent);this.parent.off(yf,this.onClearPathInit);this.parent.off(yi,this.onDeleteInit);this.parent.off(wt,this.onDeleteEnd);this.parent.off(gi,this.oncutCopyInit);this.parent.off(gt,this.onDropInit);this.parent.off(lo,this.onDragEnd);this.parent.off(ao,this.onDragging);this.parent.off(ni,this.onDropPath);this.parent.off(it,this.onDetailsInit);this.parent.off(di,this.onMenuItemData);this.parent.off(uo,this.onPathDrag)},n.prototype.onDetailsInit=function(){if(this.parent.activeModule===this.getModuleName()){var n=this.getTreeData(this.treeObj.selectedNodes[0]);this.parent.itemData=n}},n.prototype.onMenuItemData=function(n){if(this.parent.activeModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.itemData=this.getTreeData(i.getAttribute("data-uid"))}},n.prototype.onDragging=function(n){var i=t.closest(n.target,"li"),r;i.classList.contains("e-node-collapsed")&&(this.isDrag=!0,r=parseInt(i.getAttribute("aria-level"),10),this.treeObj.expandAll([i.getAttribute("data-uid")],r+1),this.isDrag=!1)},n.prototype.onDropInit=function(n){if(this.parent.targetModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.dropData=this.getTreeData(i)[0];this.parent.dropPath=this.getDropPath(i,t.getValue("name",this.parent.dropData))}},n.prototype.getModuleName=function(){return"navigationpane"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.treeObj&&(this.unWireEvents(),this.treeObj.destroy()))},n.prototype.wireEvents=function(){this.keyboardModule=new t.KeyboardEvents(this.treeObj.element,{keyAction:this.keyDown.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},n.prototype.unWireEvents=function(){this.keyboardModule.destroy()},n.prototype.keyDown=function(n){switch(n.action){case"altEnter":this.parent.notify(it,{});du(this.parent,[],this.parent.path,"details");break;case"esc":ko(this.parent);break;case"del":this.parent.pathId[0]!==this.activeNode.getAttribute("data-uid")&&(this.updateItemData(),p(this.parent.itemData[0])?(this.removeNodes=[],s(this.parent,"Delete")):e(this.parent,this.parent.itemData[0],rt));break;case"ctrlC":lu(this.parent);break;case"ctrlV":this.parent.folderPath="";pu(this.parent);break;case"ctrlX":au(this.parent);break;case"shiftF10":if(this.updateItemData(),!bu(this.parent.itemData[0]))return void e(this.parent,this.parent.itemData[0],cu);0!==this.parent.selectedItems.length&&this.doDownload();break;case"f2":if(0===this.parent.selectedItems.length){var t=this.getTreeData(this.treeObj.selectedNodes[0])[0];p(t)?(this.updateRenameData(),s(this.parent,"Rename")):e(this.parent,t,rt)}}},n.prototype.getTreeData=function(n){for(var i=this.treeObj.getTreeData(n),r=0;r<i.length;r++)t.isNullOrUndefined(t.getValue("hasChild",i[r]))&&t.setValue("hasChild",!1,i[r]);return i},n.prototype.updateRenameData=function(){this.updateItemData();this.parent.currentItemText=t.getValue("name",this.parent.itemData[0])},n.prototype.updateItemData=function(){var n=this.getTreeData(this.treeObj.selectedNodes[0])[0];this.parent.itemData=[n];this.parent.isFile=!1},n.prototype.updateActionData=function(){this.updateItemData();bf(t.select('[data-uid="'+this.parent.pathId[this.parent.pathId.length-1]+'"]',this.treeObj.element),this.parent.itemData[0],this.parent);var n=ne(this.parent.path);this.parent.setProperties({path:n},!0);this.parent.pathId.pop();this.parent.pathNames.pop()},n.prototype.doDownload=function(){var n=ne(this.parent.path),i=this.treeObj.selectedNodes[0]===this.parent.pathId[0]?"":t.getValue("name",this.parent.itemData[0]);nf(this.parent,n,[i])},n}(),eb=function(){function n(n){this.isInteracted=!0;this.interaction=!0;this.isPasteOperation=!1;this.isColumnRefresh=!1;this.dragObj=null;this.startIndex=null;this.firstItemIndex=null;this.isSelectionUpdate=!1;this.currentSelectedItem=[];this.count=0;this.isRendered=!0;this.isLoaded=!1;this.isNameWidth=!1;this.isMultiSelect=!1;this.pasteOperation=!1;this.uploadOperation=!1;yr.Grid.Inject(yr.Resize,yr.ContextMenu,yr.Sort,yr.VirtualScroll);this.parent=n;this.element=t.select("#"+this.parent.element.id+br,this.parent.element);this.addEventListener();this.keyConfigs={altEnter:"alt+enter",esc:"escape",tab:"tab",moveDown:"downarrow",ctrlEnd:"ctrl+end",ctrlHome:"ctrl+home",ctrlDown:"ctrl+downarrow",ctrlLeft:"ctrl+leftarrow",ctrlRight:"ctrl+rightarrow",shiftEnd:"shift+end",shiftHome:"shift+home",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",ctrlUp:"ctrl+uparrow",csEnd:"ctrl+shift+end",csHome:"ctrl+shift+home",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",space:"space",ctrlSpace:"ctrl+space",shiftSpace:"shift+space",csSpace:"ctrl+shift+space",end:"end",home:"home",moveUp:"uparrow",del:"delete",ctrlX:this.parent.isMac?"cmd+x":"ctrl+x",ctrlC:this.parent.isMac?"cmd+c":"ctrl+c",ctrlV:this.parent.isMac?"cmd+v":"ctrl+v",ctrlShiftN:"ctrl+shift+n",shiftdel:"shift+delete",ctrlD:"ctrl+d",f2:"f2",ctrlA:"ctrl+a",enter:"enter",back:"backspace"}}return n.prototype.render=function(n){var o=this,r,i,e;if(this.parent.enablePersistence&&(r=window.localStorage.getItem("grid"+this.parent.element.id+"_grid"),t.isNullOrUndefined(r)||(i=JSON.parse(r),!t.isNullOrUndefined(i)&&Object.keys(i).length>0&&"sortSettings"in i&&(delete i.sortSettings,window.localStorage.setItem("grid"+this.parent.element.id+"_grid",JSON.stringify(i))))),nt.showSpinner(this.parent.element),"Details"===this.parent.view){t.removeClass([this.parent.element],ir);e=vt(this.parent,n.files);this.checkNameWidth();var u=this.getColumns(),f=void 0,s=!t.isNullOrUndefined(u)&&-1!==u.findIndex(function(n){return n.field===o.parent.sortBy});this.parent.isMobile||!s?f=[]:"None"!==this.parent.sortOrder&&(f=[{direction:this.parent.sortOrder,field:this.parent.sortBy}]);this.gridObj=new yr.Grid({dataSource:e,allowSorting:!0,rowSelecting:this.onSelection.bind(this,"select"),rowDeselecting:this.onSelection.bind(this,"unselect"),rowSelected:this.onSelected.bind(this),rowDeselected:this.onDeSelection.bind(this),allowResizing:this.parent.detailsViewSettings.columnResizing,selectionSettings:{type:this.parent.allowMultiSelection?"Multiple":"Single",checkboxMode:"ResetOnRowClick"},enableRtl:this.parent.enableRtl,pageSettings:{pageSize:20},enableVirtualization:this.parent.enableVirtualization,enablePersistence:this.parent.enablePersistence,enableVirtualMaskRow:!0,sortSettings:{allowUnsort:!1,columns:f},columns:u,recordDoubleClick:this.DblClickEvents.bind(this),beforeDataBound:this.onBeforeDataBound.bind(this),dataBound:this.onDataBound.bind(this),rowDataBound:this.onRowDataBound.bind(this),actionBegin:this.onActionBegin.bind(this),headerCellInfo:this.onHeaderCellInfo.bind(this),width:"100%",height:this.parent.enableVirtualization?this.getGridHeight():"auto",beforeCopy:function(n){n.cancel=!0},load:function(){this.focusModule.destroy()},locale:this.parent.locale});this.parent.isReact&&(this.gridObj.isReact=!0,this.gridObj.portals=[],this.gridObj.on("reactTemplateRender",this.reactTemplateRender,this));this.gridObj.isStringTemplate=!0;this.gridObj.appendTo("#"+this.parent.element.id+br);0!==this.parent.selectedItems.length&&this.parent.enableVirtualization&&this.parent.enablePersistence&&(this.isLoaded=!0);this.wireEvents();this.adjustHeight();this.emptyArgs=n}},n.prototype.reactTemplateRender=function(n){this.parent.portals=n;this.parent.portals&&this.parent.toolbarModule&&this.parent.toolbarModule.toolbarObj&&this.parent.toolbarModule.toolbarObj.portals&&(this.parent.portals=this.parent.portals.concat(this.parent.toolbarModule.toolbarObj.portals));this.parent.notify("renderReactTemplate",this.parent.portals);this.parent.renderReactTemplates()},n.prototype.getGridHeight=function(){var n=t.select("#"+this.parent.element.id+dr,this.parent.element),i=t.select("#"+this.parent.element.id+gr,this.parent.element);return n.offsetHeight-i.offsetHeight-36},n.prototype.checkNameWidth=function(){var i=this.parent.detailsViewSettings.columns,n;for(this.isNameWidth=!1,n=0;n<i.length;n++)if("name"===i[n].field)return void(this.isNameWidth=!t.isNullOrUndefined(i[n].width))},n.prototype.adjustWidth=function(n,t){var i,r;if(!this.isNameWidth||"name"!==t)for(i=0;i<n.length;i++)n[i].field===t&&(r=""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?this.element.clientWidth<=680?"name"===t?"120px":"180px":"auto":this.element.clientWidth<=500?"120px":"auto",n[i].width=r)},n.prototype.getColumns=function(){var n,s=this.parent.enableHtmlSanitizer,f,h,e,o;if(this.parent.isMobile)n=[{field:"name",headerText:i(this.parent,"Name"),width:"auto",minWidth:120,headerTextAlign:"Left",template:t.initializeCSPTemplate(function(n){return'<div class="e-fe-text">'+(s?t.SanitizeHtmlHelper.sanitize(n.name):n.name)+'<\/div><div class="e-fe-date">'+n._fm_modified+'<\/div><span class="e-fe-size">'+n.size+"<\/span>"})}];else{n=t.extend([],this.parent.detailsViewSettings.columns,null,!0);this.adjustWidth(n,"name");for(var c=function(r){if(n[r].headerText=i(l.parent,n[r].headerText),"name"===n[r].field&&!t.isNullOrUndefined(n[r].template)&&"function"!=typeof n[r].template){var u=n[r].template;n[r].template=t.initializeCSPTemplate(function(n){var i=s?t.SanitizeHtmlHelper.sanitize(n.name):n.name;return u.replace(/\${name}/g,i)})}},l=this,r=0,u=n.length;r<u;r++)c(r)}for(f=this.parent.isMobile||this.parent.isBigger?"54":"46",h={field:"type",width:f,minWidth:f,template:t.initializeCSPTemplate(function(n){return'<span class="e-fe-icon '+n._fm_iconClass+'"><\/span>'}),allowResizing:!1,allowSorting:!0,customAttributes:{"class":"e-fe-grid-icon"},headerTemplate:t.initializeCSPTemplate(function(){return"<span class='e-fe-icon e-fe-folder'><\/span>"})},(n.unshift(h),this.parent.showItemCheckBoxes)&&(e=this.parent.isBigger?"36":"26",o={type:"checkbox",width:e,minWidth:e,customAttributes:{"class":"e-fe-checkbox"},allowResizing:!1,allowSorting:!1},this.parent.isMobile?n.push(o):n.unshift(o)),r=0,u=n.length;r<u;r++)n[r].disableHtmlEncode=!this.parent.enableHtmlSanitizer;return this.parent.enableRangeSelection&&n.push({field:"name",visible:!1,customAttributes:{"class":"e-drag-text"}}),n},n.prototype.adjustHeight=function(){if(this.gridObj){var n=t.select("#"+this.parent.element.id+dr,this.parent.element),i=t.select("#"+this.parent.element.id+gr,this.parent.element),r=t.select("."+rh,this.parent.element),u=n.offsetHeight-i.offsetHeight-r.offsetHeight;this.gridObj.height=u;this.gridObj.dataBind()}},n.prototype.renderCheckBox=function(){this.gridObj.columns=this.getColumns();this.isColumnRefresh=!0;this.gridObj.refreshColumns()},n.prototype.onRowDataBound=function(n){var f=t.select(".e-fe-grid-name",n.row),u,r,v,s,e,h,y,o,b,l,k,a,d;if(!f)for(u=this.parent.detailsViewSettings.columns,r=0;r<u.length;r++)if("name"===u[r].field){f=n.row.children[this.parent.allowMultiSelection?r+2:r+1];break}if((f&&f.setAttribute("title",t.getValue("name",n.data)),this.parent.isLayoutChange&&this.parent.isCut&&"move"===this.parent.fileAction&&this.parent.selectedNodes&&0!==this.parent.selectedNodes.length&&-1!==this.parent.selectedNodes.indexOf(t.getValue("name",n.data))&&kf(n.row),!this.parent.showFileExtension&&t.getValue("isFile",n.data))&&(v=t.getValue("name",n.data),s=n.row.querySelector('[title= "'+v+'"]'),s&&(e=t.getValue("name",n.data),h=t.getValue("type",n.data),-1!==e.indexOf(h)&&(s.innerHTML=e.substr(0,e.length-h.length)))),void 0!==t.getValue("size",n.data)&&n.row.querySelector(".e-fe-size")){if(y=n.row.querySelector(".e-fe-size"),o=void 0,t.getValue("isFile",n.data)){var g=t.getValue("size",n.data),c=new t.Internationalization(this.parent.locale),w=void 0;for(u=this.parent.detailsViewSettings.columns,r=0;r<u.length;r++)if("size"===u[r].field){w=t.isNullOrUndefined(u[r].format)?"n":u[r].format.toString();break}o=c.formatNumber(g/1024,{format:w})+" "+i(this.parent,"KB")}else o="";y.innerHTML=o}if(this.parent.isMobile&&void 0!==t.getValue("_fm_modified",n.data)&&n.row.querySelector(".e-fe-date")){for(b=n.row.querySelector(".e-fe-date"),l=(c=new t.Internationalization(this.parent.locale),void(u=this.parent.detailsViewSettings.columns)),r=0;r<u.length;r++)if("dateModified"===u[r].field){l=u[r].format;break}k=c.formatDate(new Date(t.getValue("_fm_modified",n.data)),l);b.innerHTML=k}a=n.row.querySelector("."+cf);a&&a.classList.add("e-small");p(n.data)||(n.row.className+=" "+re(n.data));d={element:n.row,fileDetails:n.data,module:"DetailsView"};this.parent.trigger("fileLoad",d)},n.prototype.onActionBegin=function(n){var r,i,u;if("sorting"===n.requestType){if(this.parent.setProperties({sortOrder:n.direction},!0),this.parent.setProperties({sortBy:n.columnName},!0),0!==this.parent.selectedItems.length)for(this.sortItem=!0,r=this.gridObj.getSelectedRowIndexes(),i=r.length,this.sortSelectedNodes=[];i>0;)u=this.gridObj.getRowsObject()[r[i-1]].data,this.sortSelectedNodes.push(t.getValue(this.parent.hasId?"id":"name",u)),i--;this.parent.notify(dt,{})}},n.prototype.onHeaderCellInfo=function(n){var t=n.node.querySelector("."+cf);t&&t.classList.add("e-small")},n.prototype.onBeforeDataBound=function(n){var r=this,t,i;nt.showSpinner(this.parent.element);t=this.parent.detailsViewSettings.columns.find(function(n){return n.field===r.parent.sortBy});!t||"sortComparer"in t||(i=vt(this.parent,this.parent.enableVirtualization?n.result:this.gridObj.dataSource),n.result=i)},n.prototype.onDataBound=function(){if(this.createDragObj(),(0!==this.parent.selectedItems.length&&!this.parent.enableVirtualization||this.isLoaded)&&this.selectRecords(this.parent.selectedItems),!0===this.isPasteOperation&&!t.isNullOrUndefined(this.gridObj.getDataRows())&&this.gridObj.getDataRows().length>0&&(this.isColumnRefresh?this.isColumnRefresh=!1:(this.selectRecords(this.parent.pasteNodes),this.isPasteOperation=!1)),this.parent.createdItem&&(this.selectRecords([t.getValue(this.parent.hasId?"id":"name",this.parent.createdItem)]),this.parent.createdItem=null),this.parent.layoutSelectedItems.length&&this.selectRecords(this.parent.layoutSelectedItems),this.parent.renamedItem&&0===this.parent.selectedItems.length&&(this.gridObj.clearSelection(),this.addSelection(this.parent.renamedItem),this.parent.renamedItem=null),!0===this.sortItem&&(this.selectRecords(this.sortSelectedNodes),this.sortItem=!1),this.isSelectionUpdate&&(this.isColumnRefresh?this.isColumnRefresh=!1:(this.selectRecords(this.currentSelectedItem),this.isSelectionUpdate=!1)),!0===this.uploadOperation&&(this.count++,this.selectRecords(this.parent.uploadItem),this.count===this.parent.uploadItem.length&&(this.uploadOperation=!1,this.parent.uploadItem=[])),this.gridObj.currentViewData.length*this.gridObj.getRowHeight()<this.gridObj.height)(n=this.gridObj.getHeaderContent()).style.paddingRight="",n.style.paddingLeft="",t.select(".e-headercontent",n).style.borderRightWidth="0",(i=this.gridObj.getContent().querySelector(".e-content")).style.overflowY="",i.classList.add("e-scrollShow");else{var i,n=this.gridObj.getHeaderContent();this.parent.enableRtl?n.style.paddingLeft="16px":n.style.paddingRight="16px";(i=this.gridObj.getContent().querySelector(".e-content")).classList.remove("e-scrollShow")}this.isRendered=!0;this.parent.isLayoutChange=!1;nt.hideSpinner(this.parent.element);this.checkEmptyDiv(this.emptyArgs);this.isInteracted=!!this.isLoaded||this.isInteracted;this.isLoaded=!1},n.prototype.selectRecords=function(n){for(var u,e,f=this.gridObj.getCurrentViewRecords(),r=[],i=0,o=f.length;i<o;i++)u=this.parent.hasId?t.getValue("id",f[i]):uc(this.parent,f[i]),-1!==n.indexOf(u)?r.push(i):this.parent.showFileExtension||this.parent.hasId||!u.includes(".")||(e=u.split(".").slice(0,-1).join("."),-1!==n.indexOf(e)&&r.push(i));0!==r.length&&(this.gridObj.selectRows(r),this.addFocus(this.gridObj.selectedRowIndex))},n.prototype.addSelection=function(n){var r=this.gridObj.getCurrentViewRecords(),i=[],f,e;this.parent.hasId?i=new u.DataManager(r).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(f=new u.DataManager(r).executeLocal((new u.Query).where("name","equal",t.getValue("name",n),!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1))));i.length>0&&(e=r.indexOf(i[0]),this.gridObj.selectRows([e]))},n.prototype.onSortColumn=function(){"None"!==this.parent.sortOrder?this.gridObj.sortModule.sortColumn(this.parent.sortBy,this.parent.sortOrder):this.gridObj.dataSource=vt(this.parent,this.gridObj.dataSource);0!==this.element.querySelector(".e-content").scrollTop&&this.gridObj.freezeRefresh()},n.prototype.onPropertyChanged=function(n){var i,r,u,f;if(n.module===this.getModuleName()||"common"===n.module)for(i=0,r=Object.keys(n.newProp);i<r.length;i++)switch(r[i]){case"allowDragAndDrop":this.createDragObj();break;case"height":this.adjustHeight();break;case"detailsViewSettings":t.isNullOrUndefined(this.gridObj)||(this.checkNameWidth(),u=this.getColumns(),this.gridObj.columns=u,this.gridObj.allowResizing=this.parent.detailsViewSettings.columnResizing,this.gridObj.dataBind(),this.gridObj.refreshColumns());break;case"selectedItems":(this.interaction=!1,0!==this.parent.selectedItems.length)?(this.parent.allowMultiSelection||(f=this.parent.selectedItems.slice(this.parent.selectedItems.length-1),this.parent.setProperties({selectedItems:f},!0)),this.selectRecords(this.parent.selectedItems),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0)):t.isNullOrUndefined(this.gridObj)||(this.gridObj.clearSelection(),this.interaction=!0);break;case"showFileExtension":case"showHiddenItems":o(this.parent,y,this.parent.path);break;case"showItemCheckBoxes":case"allowMultiSelection":t.isNullOrUndefined(this.gridObj)||(this.currentSelectedItem=this.parent.selectedItems,this.gridObj.selectionSettings.type=n.newProp.allowMultiSelection?"Multiple":"Single",this.isSelectionUpdate=!0,this.renderCheckBox());break;case"view":at(this.parent,"Details");break;case"width":this.onDetailsResize()}},n.prototype.onPathChanged=function(n){this.parent.isCut=!1;var i=this.parent.detailsViewSettings.columns.find(function(n){return"filterPath"===n.field});(""!==this.parent.breadcrumbbarModule.searchObj.element.value.trim()||!this.gridObj)&&(t.isNullOrUndefined(i)||t.isNullOrUndefined(i.hideAtMedia)||""===i.hideAtMedia)||(this.parent.searchedItems=[],this.parent.isFiltered?this.updatePathColumn():this.removePathColumn(!1));ut(this.parent);"Details"===this.parent.view&&(this.isInteracted=!1,nt.showSpinner(this.parent.element),this.parent.setProperties({selectedItems:[]},!0),this.gridObj.dataSource=vt(this.parent,n.files),this.gridObj.freezeRefresh(),this.parent.isReact&&this.gridObj.on("reactTemplateRender",this.reactTemplateRender,this),this.wireClickEvent(!0));this.emptyArgs=n},n.prototype.updatePathColumn=function(){var n=this.gridObj.columns.length,t=JSON.parse(JSON.stringify(this.gridObj.columns)),r;t[n-1].field&&"filterPath"!==t[n-1].field&&!this.parent.isMobile&&(r={field:"filterPath",headerText:i(this.parent,"Path"),minWidth:180,width:"auto"},this.gridObj.columns.push(r),this.adjustWidth(this.gridObj.columns,"filterPath"),this.adjustWidth(this.gridObj.columns,"name"),this.isColumnRefresh=!0,this.gridObj.refreshColumns())},n.prototype.checkEmptyDiv=function(n){var i=vt(this.parent,n.files),r;0!==i.length||t.isNullOrUndefined(this.element.querySelector("."+or))?0!==i.length&&this.element.querySelector("."+k)&&(this.element.querySelector("."+or).querySelector("."+k)?(r=this.element.querySelector("."+or).querySelector("."+k),this.element.querySelector("."+or).removeChild(r)):this.element.removeChild(this.element.querySelector("."+k))):ec(this.parent,this.element,n)},n.prototype.onOpenInit=function(){if("detailsview"===this.parent.activeModule){var n=this.gridObj.getSelectedRecords()[0];this.openContent(n)}},n.prototype.DblClickEvents=function(n){var t;this.gridObj.selectRows([n.rowIndex]);n.rowData&&(t=JSON.parse(JSON.stringify(n.rowData)),this.openContent(t))},n.prototype.openContent=function(n){var i=this,r;wu(n)?(r={cancel:!1,fileDetails:n,module:"DetailsView"},this.parent.trigger("fileOpen",r,function(r){var u,e,f,o;r.cancel||(u=t.getValue("name",n),t.getValue("isFile",n)?vu(n)===af&&(e=go(i.parent,n),sl(i.parent,u,e)):(""!==i.parent.breadcrumbbarModule.searchObj.element.value||i.parent.isFiltered?lc(i.parent,n):(f=t.getValue("id",n),i.parent.oldPath=i.parent.path,o=i.parent.path+(t.isNullOrUndefined(f)?u:f)+"/",i.parent.setProperties({path:o},!0),i.parent.pathNames.push(u),i.parent.pathId.push(t.getValue("_fm_id",n)),i.parent.itemData=[n],rc(i.parent)),i.parent.isFiltered=!1),i.element.focus(),i.parent.enableVirtualization&&i.parent.element.querySelector("#"+i.parent.element.id+be).focus())})):e(this.parent,n,vo)},n.prototype.onLayoutChange=function(n){"Details"===this.parent.view&&(this.parent.enableVirtualization&&this.parent.setProperties({selectedItems:[]},!0),this.gridObj?this.isLoaded=!0:this.render(n),this.parent.isFiltered&&(this.updatePathColumn(),this.parent.setProperties({selectedItems:[]},!0)),this.gridObj.dataSource=vt(this.parent,n.files),this.parent.notify(ar,{}),this.gridObj.element.classList.remove(ri),this.isInteracted=!1,this.gridObj.clearSelection(),""!==this.parent.breadcrumbbarModule.searchObj.element.value.trim()&&this.onSearchFiles(n),this.adjustHeight(),this.gridObj.sortSettings.columns.length>0&&this.gridObj.sortSettings.columns[0].field!==this.parent.sortBy&&"None"!==this.parent.sortOrder&&this.gridObj.sortColumn(this.parent.sortBy,this.parent.sortOrder))},n.prototype.onSearchFiles=function(n){"Details"===this.parent.view&&(this.parent.setProperties({selectedItems:[]},!0),this.parent.notify(c,{}),this.parent.isLayoutChange||(this.parent.layoutSelectedItems=[]),this.updatePathColumn(),this.parent.searchedItems=n.files,this.onPathChanged(n))},n.prototype.removePathColumn=function(n){if(null!=this.gridObj){var i=this.gridObj.columns.length,r=JSON.parse(JSON.stringify(this.gridObj.columns)),u=this.parent.detailsViewSettings.columns.some(function(n){return"filterPath"===n.field});r[i-1].field&&"filterPath"===r[i-1].field&&!u&&(t.isNullOrUndefined(this.gridObj.sortSettings.columns[0])||"filterPath"!==this.gridObj.sortSettings.columns[0].field||("None"!==this.parent.sortOrder?this.gridObj.sortColumn("name",this.parent.sortOrder):this.gridObj.dataSource=vt(this.parent,this.gridObj.dataSource),this.parent.notify(dt,{})),this.gridObj.columns.pop(),n||(this.isColumnRefresh=!0,this.gridObj.refreshColumns()))}},n.prototype.onFinalizeEnd=function(n){"Details"===this.parent.view&&(this.gridObj?this.onPathChanged(n):this.render(n))},n.prototype.onCreateEnd=function(n){"Details"===this.parent.view&&this.onPathChanged(n)},n.prototype.onRenameInit=function(){"detailsview"===this.parent.activeModule&&1===this.parent.selectedItems.length&&this.updateRenameData()},n.prototype.onSelectedData=function(){"detailsview"===this.parent.activeModule&&(this.parent.itemData=this.gridObj.getSelectedRecords())},n.prototype.onDeleteInit=function(){"detailsview"===this.parent.activeModule&&fe(this.parent,this.parent.selectedItems,this.parent.path,"delete")},n.prototype.onDeleteEnd=function(n){"Details"===this.parent.view&&(this.onPathChanged(n),this.parent.setProperties({selectedItems:[]},!0))},n.prototype.onRefreshEnd=function(n){"Details"===this.parent.view&&(this.isInteracted=!1,this.removePathColumn(!1),this.gridObj.dataSource=vt(this.parent,n.files),this.emptyArgs=n)},n.prototype.onHideLayout=function(){"Details"!==this.parent.view&&this.gridObj&&this.gridObj.element.classList.add(ri)},n.prototype.onSelectAllInit=function(){"Details"===this.parent.view&&(this.isInteracted=!1,this.parent.allowMultiSelection?this.gridObj.selectionModule.selectRowsByRange(0,this.gridObj.getRows().length):this.gridObj.selectRow(this.gridObj.getRows().length-1),this.isInteracted=!0,this.interaction=!0)},n.prototype.onClearAllInit=function(){"Details"===this.parent.view&&(this.removeSelection(),this.interaction=!0)},n.prototype.onSelectionChanged=function(){t.removeClass([this.element],dh);this.parent.selectedItems.length>0&&t.addClass([this.element],dh)},n.prototype.onLayoutRefresh=function(){"Details"===this.parent.view&&this.adjustHeight()},n.prototype.onBeforeRequest=function(){this.isRendered=!1},n.prototype.onAfterRequest=function(){this.isRendered=!0},n.prototype.onUpdateSelectionData=function(){"Details"===this.parent.view&&(this.parent.itemData=this.gridObj.getSelectedRecords())},n.prototype.addEventListener=function(){this.parent.on(tt,this.onFinalizeEnd,this);this.parent.on(ct,this.destroy,this);this.parent.on(g,this.onLayoutChange,this);this.parent.on(y,this.onPathChanged,this);this.parent.on(pt,this.onCreateEnd,this);this.parent.on(gt,this.onDropInit,this);this.parent.on(it,this.onDetailsInit,this);this.parent.on(bt,this.onRefreshEnd,this);this.parent.on(ei,this.onSearchFiles,this);this.parent.on(ot,this.onMethodCall,this);this.parent.on(cr,this.onActionFailure,this);this.parent.on(f,this.onPropertyChanged,this);this.parent.on(yi,this.onDeleteInit,this);this.parent.on(wt,this.onDeleteEnd,this);this.parent.on(hi,this.onSelectedData,this);this.parent.on(si,this.onRenameInit,this);this.parent.on(ft,this.onPathChanged,this);this.parent.on(oi,this.onOpenInit,this);this.parent.on(wf,this.onSortColumn,this);this.parent.on(kt,this.onPathChanged,this);this.parent.on(fu,this.onPathChanged,this);this.parent.on(ci,this.onPasteInit,this);this.parent.on(ar,this.onHideLayout,this);this.parent.on(lr,this.onSelectAllInit,this);this.parent.on(eu,this.onClearAllInit,this);this.parent.on(vr,this.onPathColumn,this);this.parent.on(c,this.onSelectionChanged,this);this.parent.on(bi,this.onBeforeRequest,this);this.parent.on(lt,this.onAfterRequest,this);this.parent.on(et,this.onpasteEnd,this);this.parent.on(gi,this.oncutCopyInit,this);this.parent.on(di,this.onMenuItemData,this);this.parent.on(pi,this.onDetailsResizeHandler,this);this.parent.on(wi,this.onDetailsResize,this);this.parent.on(ki,this.onLayoutRefresh,this);this.parent.on(ni,this.onDropPath,this);this.parent.on(hu,this.onUpdateSelectionData,this)},n.prototype.removeEventListener=function(){this.parent.off(tt,this.onFinalizeEnd);this.parent.off(ct,this.destroy);this.parent.off(g,this.onLayoutChange);this.parent.off(y,this.onPathChanged);this.parent.off(ci,this.onPasteInit);this.parent.off(pt,this.onCreateEnd);this.parent.off(bt,this.onRefreshEnd);this.parent.off(ei,this.onSearchFiles);this.parent.off(ot,this.onMethodCall);this.parent.off(cr,this.onActionFailure);this.parent.off(f,this.onPropertyChanged);this.parent.off(si,this.onRenameInit);this.parent.off(ft,this.onPathChanged);this.parent.off(fu,this.onPathChanged);this.parent.off(oi,this.onOpenInit);this.parent.off(wf,this.onSortColumn);this.parent.off(kt,this.onPathChanged);this.parent.off(ar,this.onHideLayout);this.parent.off(lr,this.onSelectAllInit);this.parent.off(eu,this.onClearAllInit);this.parent.off(yi,this.onDeleteInit);this.parent.off(wt,this.onDeleteEnd);this.parent.off(vr,this.onPathColumn);this.parent.off(c,this.onSelectionChanged);this.parent.off(bi,this.onBeforeRequest);this.parent.off(lt,this.onAfterRequest);this.parent.off(et,this.onpasteEnd);this.parent.off(gi,this.oncutCopyInit);this.parent.off(gt,this.onDropInit);this.parent.off(hi,this.onSelectedData);this.parent.off(it,this.onDetailsInit);this.parent.off(di,this.onMenuItemData);this.parent.off(pi,this.onDetailsResizeHandler);this.parent.off(wi,this.onDetailsResize);this.parent.off(ki,this.onLayoutRefresh);this.parent.off(ni,this.onDropPath);this.parent.off(hu,this.onUpdateSelectionData)},n.prototype.onActionFailure=function(){this.interaction=!0},n.prototype.onMenuItemData=function(n){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=[this.gridObj.getRowInfo(n.target).rowData])},n.prototype.onPasteInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=""!==this.parent.folderPath?this.gridObj.getSelectedRecords():[a(this.parent)])},n.prototype.onDetailsInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=0!==this.parent.selectedItems.length?this.gridObj.getSelectedRecords():[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)])},n.prototype.dragHelper=function(n){var i,r,t=n.sender.target.closest("tr.e-row");return t?(t.getElementsByClassName("e-fe-text")[0]?i=this.parent.hasId?this.gridObj.getRowInfo(t).rowData.id:t.getElementsByClassName("e-fe-text")[0].innerText:t.getElementsByClassName("e-rowcell e-templatecell")[0].nextElementSibling&&(i=this.parent.hasId?this.gridObj.getRowInfo(t).rowData.id:t.getElementsByClassName("e-rowcell e-templatecell")[0].nextElementSibling.innerText),t&&!t.querySelector(".e-active")&&this.selectRecords([i]),df(this.parent,t),this.parent.activeElements=[],this.parent.dragData=[],this.parent.dragData=this.gridObj.getSelectedRecords(),0===this.parent.dragData.length&&t&&(r=this.gridObj.getRowInfo(t)),r&&this.parent.dragData.push(r.rowData),this.parent.dragPath=this.parent.path,this.parent.activeElements=this.gridObj.getSelectedRows(),is(this.parent),this.parent.virtualDragElement):null},n.prototype.onDetailsResize=function(){if("Details"===this.parent.view&&!this.parent.isMobile&&!t.isNullOrUndefined(this.gridObj))for(var i=this.gridObj.getHeaderContent().querySelector(".e-headercontent").querySelector("colgroup"),r=this.gridObj.getContent().querySelector(".e-content .e-table").children[0],u=this.gridObj.getColumns(),n=0;n<u.length;n++)(this.isNameWidth||"name"!==u[n].field)&&"filterPath"!==u[n].field||(""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?this.element.clientWidth<=680?"name"===u[n].field?(i.children[n].style.width="120px",r.children[n].style.width="120px"):(i.children[n].style.width="180px",r.children[n].style.width="180px"):this.element.clientWidth>680&&(i.children[n].style.width="auto",r.children[n].style.width="auto"):this.element.clientWidth<=500?(i.children[n].style.width="120px",r.children[n].style.width="120px"):this.element.clientWidth>500&&(i.children[n].style.width="auto",r.children[n].style.width="auto"))},n.prototype.onDetailsResizeHandler=function(){this.onDetailsResize();"Details"!==this.parent.view||this.parent.isMobile||t.isNullOrUndefined(this.gridObj)||this.adjustHeight()},n.prototype.createDragObj=function(){var n=this;this.gridObj&&(this.parent.allowDragAndDrop&&t.isNullOrUndefined(this.dragObj)?this.dragObj=new t.Draggable(this.gridObj.element,{cursorAt:this.parent.dragCursorPosition,distance:5,enableTailMode:!0,dragArea:this.parent.element,dragTarget:"."+de,drag:es.bind(this,this.parent),dragStart:function(t){us(n.parent,t,n.dragObj)},dragStop:rs.bind(this,this.parent),enableAutoScroll:!1,helper:this.dragHelper.bind(this)}):!this.parent.allowDragAndDrop&&this.dragObj&&(this.dragObj.destroy(),this.dragObj=null))},n.prototype.onDropInit=function(n){if(this.parent.targetModule===this.getModuleName()){var i,r=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent);n.target.closest("tr")?(i=this.gridObj.getRowInfo(n.target).rowData,this.parent.dropPath=i.isFile?this.parent.path:yu(this.parent,i,this.parent.path),this.parent.dropData=i.isFile?r:i):(this.parent.dropPath=this.parent.path,this.parent.dropData=r)}},n.prototype.oncutCopyInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.activeRecords=this.gridObj.getSelectedRecords(),this.parent.activeElements=this.gridObj.getSelectedRows())},n.prototype.onpasteEnd=function(n){"Details"===this.parent.view&&(this.isPasteOperation=!0,(this.parent.path===this.parent.destinationPath||this.parent.path===ns(this.parent,n)||this.parent.hasId)&&this.onPathChanged(n))},n.prototype.onDropPath=function(n){"Details"===this.parent.view&&(this.isPasteOperation=!0,this.onPathChanged(n))},n.prototype.getModuleName=function(){return"detailsview"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.gridObj&&(this.parent.isReact&&this.gridObj.off("reactTemplateRender",this.reactTemplateRender),this.unWireEvents(),this.gridObj.destroy()))},n.prototype.updateType=function(n){var i=t.select("."+fr,n);this.parent.isFile=!!t.isNullOrUndefined(i)},n.prototype.onSelection=function(n,t){var i={action:n,fileDetails:t.data,isInteracted:this.interaction,cancel:!1,target:t.target},r;(this.parent.trigger("fileSelection",i),t.cancel=i.cancel,this.isMultiSelect)||((this.isMultiSelect=!0,(t.isShiftPressed||t.isCtrlPressed)&&!this.parent.allowMultiSelection&&t.target&&t.target.parentElement&&!t.target.parentElement.classList.contains("e-checkbox-wrapper"))&&(t.cancel=!0,r=t&&t.rowIndexes?t.rowIndexes[t.rowIndexes.length-1]:t.rowIndex,this.gridObj.selectRow(r)),this.isMultiSelect=!1)},n.prototype.onSelected=function(n){var u,o,f,i,r,e,s,h,l;if(this.parent.activeModule="detailsview",this.parent.isLayoutChange&&!this.parent.isFiltered||this.selectedRecords(),this.parent.notify(c,{}),1===this.gridObj.getSelectedRowIndexes().length&&(this.firstItemIndex=this.gridObj.selectedRowIndex),this.gridObj.element.setAttribute("tabindex","-1"),this.triggerSelect("select",n),u=this.gridObj.getRowByIndex(this.gridObj.selectedRowIndex),(this.updateType(u),t.isNullOrUndefined(u)||t.isNullOrUndefined(u.querySelector(".e-checkselect")))||(1!==this.gridObj.getSelectedRowIndexes().length&&(o=this.gridObj.getSelectedRowIndexes()[this.gridObj.getSelectedRowIndexes().length-2],f=this.gridObj.getRowByIndex(o),t.isNullOrUndefined(f)||f.querySelector(".e-checkselect").setAttribute("tabindex","-1")),u.querySelector(".e-rowcell.e-fe-checkbox").removeAttribute("tabindex")),t.isNullOrUndefined(this.gridObj)||t.isNullOrUndefined(this.gridObj.element.querySelector(".e-checkselectall"))||this.gridObj.element.querySelector(".e-checkselectall").setAttribute("tabindex","-1"),i=this.gridObj.getSelectedRowIndexes(),!this.parent.allowMultiSelection)for(r=0;r<i.length;r++)i[r]===this.gridObj.selectedRowIndex?this.gridObj.getRowByIndex(i[r]).setAttribute("tabindex","0"):this.gridObj.getRowByIndex(i[r]).removeAttribute("tabindex");e=i.length;this.parent.enableVirtualization?this.parent.currentItemText=t.getValue("name",n.data):e>0&&(s=this.gridObj.getRowsObject()[i[e-1]].data,this.parent.currentItemText=t.getValue("name",s));h=t.getValue("rowIndexes",n);l=t.getValue("enableSelectMultiTouch",this.gridObj.selectionModule);this.parent.isDevice&&t.isNullOrUndefined(h)&&n.target&&!l&&!n.target.closest(".e-headercell")&&(this.parent.isFile=t.getValue("isFile",n.data),this.parent.isFile||this.openContent(n.data));this.parent.visitedItem=n.row;this.parent.enableVirtualization&&n.isHeaderCheckboxClicked||this.addFocus(this.gridObj.selectedRowIndex);this.parent.isLayoutChange||(this.isInteracted=!0)},n.prototype.onPathColumn=function(){"Details"!==this.parent.view||t.isNullOrUndefined(this.gridObj)||""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered||this.removePathColumn(!1)},n.prototype.selectedRecords=function(){var t,n,i,r;for(this.parent.setProperties({selectedItems:[]},!0),t=this.gridSelectNodes(),n=0;n<t.length;)i=t[n],r=li(this.parent,i),this.parent.selectedItems.push(r),n++;this.parent.setProperties({selectedItems:this.parent.selectedItems},!0)},n.prototype.onDeSelection=function(n){var i,u,r;!this.parent.allowMultiSelection&&t.isNullOrUndefined(n.data)?(i=this.gridObj.getRowByIndex(n.rowIndex),t.isNullOrUndefined(i)||i.removeAttribute("tabindex")):this.gridObj.getSelectedRowIndexes().length>1&&(u=this.gridObj.getSelectedRowIndexes()[this.gridObj.getSelectedRowIndexes().length-2],r=this.gridObj.getRowByIndex(u),t.isNullOrUndefined(r)||r.querySelector(".e-checkselect").removeAttribute("tabindex"));-1===this.gridObj.selectedRowIndex&&this.gridObj.element.setAttribute("tabindex","0");this.isInteracted?(this.selectedRecords(),0===this.parent.selectedItems.length&&(t.setValue("enableSelectMultiTouch",!1,this.gridObj.selectionModule),t.removeClass([this.parent.element],ir)),this.parent.notify(c,{}),this.triggerSelect("unselect",n),this.parent.visitedItem=null):this.isInteracted=!0},n.prototype.triggerSelect=function(n,t){var i={action:n,fileDetails:t.data,isInteracted:this.interaction};this.parent.trigger("fileSelect",i);this.interaction=!0},n.prototype.wireEvents=function(){this.wireClickEvent(!0);this.keyboardModule=new t.KeyboardEvents(this.gridObj.element,{keyAction:this.keyupHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keyup"});this.keyboardDownModule=new t.KeyboardEvents(this.element,{keyAction:this.keydownHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});t.EventHandler.add(this.gridObj.element,"blur",this.removeFocus,this);t.EventHandler.add(this.parent.element,"focusout",this.onBlur,this)},n.prototype.unWireEvents=function(){this.wireClickEvent(!1);this.keyboardModule.destroy();this.keyboardDownModule.destroy();t.EventHandler.remove(this.gridObj.element,"blur",this.removeFocus);t.EventHandler.remove(this.parent.element,"focusout",this.onBlur)},n.prototype.wireClickEvent=function(n){var i=this,r;n?(r=this.gridObj.getContent(),this.clickObj=new t.Touch(r,{tap:function(n){1===n.tapCount&&n.originalEvent.target.classList.contains("e-content")&&i.onClearAllInit()},tapHold:function(n){var r,u,f;i.parent.isDevice&&(n.originalEvent.preventDefault(),i.parent.allowMultiSelection&&(t.setValue("enableSelectMultiTouch",i.parent.allowMultiSelection,i.gridObj.selectionModule),t.addClass([i.parent.element],ir)),r=n.originalEvent.target,r&&(u=t.closest(r,"."+de),f=i.gridObj.getRows().indexOf(u),i.gridObj.selectRow(f)))}})):this.clickObj&&this.clickObj.destroy()},n.prototype.removeSelection=function(){t.removeClass([this.parent.element],ir);this.gridObj.clearSelection();this.parent.setProperties({selectedItems:[]},!0);this.parent.notify(c,{});-1===this.gridObj.selectedRowIndex&&(this.startIndex=null);this.isInteracted=!0},n.prototype.removeFocus=function(){this.addFocus(null)},n.prototype.onBlur=function(n){if((null===n.relatedTarget||t.closest(n.relatedTarget,".e-grid")===n.relatedTarget)&&!t.isNullOrUndefined(this.gridObj.element))for(var r=this.gridObj.element.querySelectorAll("th"),i=0;i<r.length;i++)r[i].classList.contains("e-focus")&&this.addFocus(null)},n.prototype.getFocusedItemIndex=function(){return t.isNullOrUndefined(this.getFocusedItem())?null:parseInt(this.getFocusedItem().getAttribute("aria-rowindex"),10)-1},n.prototype.keydownHandler=function(n){if(this.isRendered)switch(n.action){case"end":case"home":case"space":case"ctrlSpace":case"shiftSpace":case"csSpace":case"ctrlA":case"enter":case"altEnter":case"ctrlEnd":case"shiftEnd":case"csEnd":case"ctrlHome":case"shiftHome":case"csHome":case"ctrlDown":case"shiftDown":case"csDown":case"ctrlLeft":case"shiftLeft":case"csLeft":case"esc":case"del":case"shiftdel":case"ctrlC":case"ctrlV":case"ctrlX":case"f2":case"moveDown":case"moveUp":case"ctrlD":n.preventDefault()}},n.prototype.keyupHandler=function(n){var c,l,a;if(this.isRendered){n.preventDefault();var o,u,f,p=n.action,i=vt(this.parent,this.gridObj.dataSource),e=i.length,s=this.getFocusedItemIndex(),r=this.gridObj.selectedRowIndex,h=this.gridObj.getSelectedRowIndexes();switch(p){case"altEnter":this.parent.notify(it,{});du(this.parent,this.parent.selectedItems,this.parent.path,"details");break;case"esc":ko(this.parent);break;case"del":case"shiftdel":this.performDelete();break;case"enter":if(-1===this.gridObj.selectedRowIndex&&!0===this.gridObj.allowSorting){n.target.classList.contains("e-fe-grid-icon")||(c=n.target.getElementsByClassName("e-ascending").length?"Descending":"Ascending",l=this.gridObj.getColumnByUid(n.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid")).field,this.gridObj.sortColumn(l,c),t.isNullOrUndefined(this.getFocusedItem().nextSibling)||this.getFocusedItem().nextSibling.setAttribute("tabindex","0"));break}(o=this.gridObj.getRowsObject()[this.gridObj.selectedRowIndex].data)&&(a=JSON.parse(JSON.stringify(o)),this.openContent(a));break;case"ctrlC":lu(this.parent);break;case"ctrlV":this.parent.folderPath="";pu(this.parent);break;case"ctrlX":au(this.parent);break;case"ctrlD":this.doDownload();break;case"f2":this.performRename();break;case"ctrlA":if(!t.isNullOrUndefined(i[0])&&this.parent.allowMultiSelection){var v=this.gridObj.getContent().querySelector(".e-content"),w=v.scrollTop,y=this.gridObj.selectedRowIndex;this.gridObj.selectionModule.selectRowsByRange(0,i.length-1);v.scrollTop=w;-1!==y&&this.addFocus(y)}break;case"ctrlHome":case"tab":if(!t.isNullOrUndefined(i[0]))if(this.parent.allowMultiSelection||"ctrlHome"!==n.action){if(-1!==this.gridObj.selectedRowIndex&&"tab"===n.action)return;this.addHeaderFocus(n)}else this.gridObj.selectRow(0);break;case"ctrlEnd":t.isNullOrUndefined(i[0])||(this.parent.allowMultiSelection?this.addFocus(e-1):this.gridObj.selectRow(e-1));break;case"shiftHome":case"shiftEnd":case"csHome":case"csEnd":this.parent.allowMultiSelection?t.isNullOrUndefined(i[0])||(t.isNullOrUndefined(r)||-1===r?"csHome"===n.action||"shiftHome"===n.action?this.gridObj.selectRow(0):this.gridObj.selectionModule.selectRowsByRange(0,i.length-1):this.checkRowsKey(i,r,null,n)):this.gridObj.selectRow("shiftHome"===n.action||"csHome"===n.action?0:i.length-1);break;case"space":case"csSpace":case"shiftSpace":case"ctrlSpace":this.spaceSelection(h,s,r,n);break;case"csUp":case"csDown":case"shiftUp":case"shiftDown":this.shiftMoveMethod(i,r,s,h,n);break;case"ctrlUp":case"ctrlDown":this.parent.allowMultiSelection?this.ctrlMoveFunction(i,n,r):this.moveFunction(i,n,r);break;case"home":u=[t.getValue(this.parent.hasId?"id":"name",i[0])];this.parent.setProperties({selectedItems:u},!0);this.selectRecords(u);break;case"moveUp":case"moveDown":this.moveFunction(i,n,r);break;case"end":f=[t.getValue(this.parent.hasId?"id":"name",i[e-1])];this.parent.setProperties({selectedItems:f},!0);this.selectRecords(f);break;case"back":this.parent.traverseBackward()}}},n.prototype.gridSelectNodes=function(){return this.gridObj.getSelectedRecords()},n.prototype.doDownload=function(){if(0!==this.parent.selectedItems.length){this.parent.itemData=this.gridObj.getSelectedRecords();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!bu(t[n]))return void e(this.parent,t[n],cu);nf(this.parent,this.parent.path,this.parent.selectedItems)}},n.prototype.performDelete=function(){if(this.parent.selectedItems&&this.parent.selectedItems.length>0){this.parent.itemData=this.gridObj.getSelectedRecords();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!p(t[n]))return void e(this.parent,t[n],rt);s(this.parent,"Delete")}},n.prototype.performRename=function(){1===this.parent.selectedItems.length&&(this.updateRenameData(),ie(this.parent))},n.prototype.updateRenameData=function(){var n=this.gridSelectNodes()[0];te(this.parent,n)},n.prototype.shiftMoveMethod=function(n,t,i,r,u){this.parent.allowMultiSelection?-1!==t||"csUp"!==u.action&&"csDown"!==u.action?-1===t||i===t||("csUp"===u.action||"csDown"===u.action)&&this.isSelected(r,i)?this.shiftSelectedItem(t,r,n,u):this.shiftSelectFocusItem(t,i,r,u):this.ctrlMoveFunction(n,u,t):this.moveFunction(n,u,t)},n.prototype.moveFunction=function(n,i,r){!t.isNullOrUndefined(this.getFocusedItem())&&this.parent.allowMultiSelection?"moveDown"===i.action?this.gridObj.selectRow(this.getFocusedItemIndex()+1):this.gridObj.selectRow(this.getFocusedItemIndex()-1):t.isNullOrUndefined(r)||-1===r?t.isNullOrUndefined(n[0])||this.gridObj.selectRow(0):"moveDown"===i.action||"ctrlDown"===i.action||"shiftDown"===i.action||"csDown"===i.action?this.gridObj.selectRow(r+(r!==n.length-1?1:0)):this.gridObj.selectRow(r-(0!==r?1:0))},n.prototype.spaceSelection=function(n,i,r,u){if(this.isSelected(n,i)||-1===r||"shiftSpace"!==u.action&&"csSpace"!==u.action)if(t.isNullOrUndefined(this.getFocusedItem())||i===r)if(-1!==r&&"ctrlSpace"===u.action&&this.parent.allowMultiSelection){var f=r;n.pop();this.gridObj.selectRows(n);this.addFocus(f)}else"shiftSpace"===u.action&&this.gridObj.selectRow(r);else n.push(this.getFocusedItemIndex()),this.gridObj.selectRows(n);else i<r?this.gridObj.selectionModule.selectRowsByRange(i,r):this.gridObj.selectionModule.selectRowsByRange(r,i)},n.prototype.ctrlMoveFunction=function(n,i,r){var f,u;t.isNullOrUndefined(this.getFocusedItem())?t.isNullOrUndefined(r)||-1===r?t.isNullOrUndefined(n[0])||(f=0):f="ctrlDown"===i.action||"csDown"===i.action?r+(r<n.length?1:0):r-(r<1?0:1):(u=this.getFocusedItemIndex(),f="ctrlDown"===i.action||"csDown"===i.action?u+(u<n.length-1?1:0):u-(u<1?0:1));this.addFocus(f)},n.prototype.checkRowsKey=function(n,i,r,u){"Uncheck"===this.gridObj.checkAllRows||"Intermediate"===this.gridObj.checkAllRows?"csHome"!==u.action&&"csEnd"!==u.action?(t.isNullOrUndefined(this.startIndex)&&this.firstItemIndex!==i&&(this.firstItemIndex=i),"shiftEnd"===u.action?this.gridObj.selectionModule.selectRowsByRange(this.firstItemIndex,n.length-1):this.gridObj.selectionModule.selectRowsByRange(0,this.firstItemIndex),this.startIndex=i):"csEnd"===u.action?this.gridObj.selectRows(this.InnerItems(t.isNullOrUndefined(i)?0:i,t.isNullOrUndefined(r)?n.length-1:r,u)):t.isNullOrUndefined(i)?this.gridObj.selectRow(0):this.gridObj.selectRows(this.InnerItems(t.isNullOrUndefined(r)?0:r,i,u)):this.gridObj.selectionModule.selectRow("shiftHome"===u.action||"csHome"===u.action?0:n.length-1)},n.prototype.InnerItems=function(n,t,i){var u=this.gridObj.getSelectedRowIndexes(),r;if("csEnd"===i.action)for(r=n+1;r<=t;r++)u.push(r);else for(r=t-1;n<=r;r--)u.push(r);return u},n.prototype.shiftSelectFocusItem=function(n,i,r,u){var e=i+("shiftDown"===u.action||"csDown"===u.action?1:-1),f=t.isNullOrUndefined(this.startIndex)?n:r[0];f===e?this.gridObj.selectRow(f):f<e?"shiftDown"===u.action||"csDown"===u.action?this.gridObj.selectionModule.selectRowsByRange(f,e):this.gridObj.selectionModule.selectRowsByRange(e,f):"shiftDown"===u.action||"csDown"===u.action?this.gridObj.selectionModule.selectRowsByRange(e,f):this.gridObj.selectionModule.selectRowsByRange(f,e);this.startIndex=this.gridObj.selectedRowIndex},n.prototype.addFocus=function(n){var r=this.getFocusedItem(),i=this.gridObj.getRowByIndex(n);r&&(r.removeAttribute("tabindex"),t.removeClass([r],[vi,tu]));t.isNullOrUndefined(i)||(this.gridObj.element.setAttribute("tabindex","-1"),i.setAttribute("tabindex","0"),i.focus(),t.addClass([i],[vi,tu]))},n.prototype.addHeaderFocus=function(n){var i,r=t.select(".e-row",this.element);this.gridObj.element.setAttribute("tabindex","-1");!t.isNullOrUndefined(n.target)&&n.target.classList.contains("e-defaultcursor")?(this.addFocus(0),i=n.target.nextElementSibling):t.isNullOrUndefined(this.gridObj.element.querySelector(".e-focus"))||"TH"!==this.gridObj.element.querySelector(".e-focus").tagName?i=t.select("th.e-fe-grid-icon",this.element):(i=this.gridObj.element.querySelector(".e-focus").nextElementSibling,this.addFocus(0));t.isNullOrUndefined(i)||(i.setAttribute("tabindex","0"),i.focus(),t.addClass([i],[vi,tu]),r.setAttribute("tabindex","0"),0===r.tabIndex&&0===i.tabIndex&&t.removeClass([r],[vi,tu]))},n.prototype.getFocusedItem=function(){return t.select("."+tu,this.element)},n.prototype.isSelected=function(n,t){for(var r=!1,i=0;i<=n.length-1;i++)if(n[i]===t){r=!0;break}return r},n.prototype.shiftSelectedItem=function(n,i,r,u){-1===n?this.gridObj.selectRow(0):t.isNullOrUndefined(this.startIndex)&&u.shiftKey?(this.startIndex=this.gridObj.selectedRowIndex,this.gridObj.selectRows([n,"shiftDown"===u.action||"csDown"===u.action?n+(n!==r.length-1?1:0):n-(0!==n?1:0)])):"shiftDown"===u.action||"shiftUp"===u.action?("shiftDown"===u.action&&-1===i.indexOf(n+1)?n!==r.length-1&&i.push(n+1):"shiftUp"===u.action&&-1===i.indexOf(n-1)?0!==n&&i.push(n-1):i.pop(),this.gridObj.selectRows(i)):"csDown"===u.action?this.isSelected(i,this.getFocusedItemIndex()+1)?this.addFocus(this.getFocusedItemIndex()+1):(i.push(this.getFocusedItemIndex()+1),this.gridObj.selectRows(i)):this.isSelected(i,this.getFocusedItemIndex()-1)?this.addFocus(this.getFocusedItemIndex()-1):(i.push(this.getFocusedItemIndex()-1),this.gridObj.selectRows(i))},n.prototype.onMethodCall=function(n){if("Details"===this.parent.view)switch(t.getValue("action",n)){case"deleteFiles":this.deleteFiles(t.getValue("ids",n));break;case"downloadFiles":this.downloadFiles(t.getValue("ids",n));break;case"openFile":this.openFile(t.getValue("id",n));break;case"createFolder":this.interaction=!1;break;case"renameFile":this.interaction=!1;this.renameFile(t.getValue("id",n),t.getValue("newName",n));break;case"selectAll":this.interaction=!1;this.onSelectAllInit();break;case"clearSelection":this.interaction=!1;this.onClearAllInit()}},n.prototype.getRecords=function(n){var r=this.gridObj.getCurrentViewRecords(),f=[],o=!(""===this.parent.breadcrumbbarModule.searchObj.element.value&&!this.parent.isFiltered),s=this.parent.hasId?"id":"name",i,u,e;if(this.parent.hasId||!o)for(i=0,u=r.length;i<u;i++)-1!==n.indexOf(t.getValue(s,r[i]))&&f.push(r[i]);else for(i=0,u=r.length;i<u;i++)e=t.getValue("filterPath",r[i])+t.getValue("name",r[i]),-1!==n.indexOf(e)&&f.push(r[i]);return f},n.prototype.deleteFiles=function(n){var r;if(this.parent.activeModule="detailsview",t.isNullOrUndefined(n))this.performDelete();else if(r=this.getRecords(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=r[i],f[i]=li(this.parent,u[i]);kc(this.parent,u,f)}},n.prototype.downloadFiles=function(n){var r;if(t.isNullOrUndefined(n))this.doDownload();else if(r=this.getRecords(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=r[i],f[i]=li(this.parent,u[i]);dc(this.parent,u,f)}},n.prototype.openFile=function(n){if(!t.isNullOrUndefined(n)){var i=this.getRecords([n]);i.length>0&&this.openContent(i[0])}},n.prototype.renameFile=function(n,i){if(this.parent.activeModule="detailsview",t.isNullOrUndefined(n))this.performRename();else{var r=this.getRecords([n]);r.length>0&&(te(this.parent,r[0]),t.isNullOrUndefined(i)?ie(this.parent):p(this.parent.itemData[0])?ku(this.parent,this.parent.path,i):e(this.parent,this.parent.itemData[0],rt))}},n}(),yl={};le.C(yl,ce);ay={filemanager:yl=le.C(window.ejdashboard?window.ejdashboard.filemanager:{},yl)};window.ejdashboard=le.C(window.ejdashboard||{},ay)})()})();(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function ar(n,t,i){for(var r=0;t.length>r;r++)if(t[r].value===i.subCommand)return n.localeObj.getConstant(t[r].locale);return i.text}function iv(n,t){var i=-1;return t.some(function(t,r){return"string"==typeof t&&n===t.toLocaleLowerCase()&&(i=r,!0)}),i}function et(n,t){var i=!1;return n.classList.contains(t)&&(i=!0),i}function fi(n,i,r,u){var e,o,f;if(0===n.length&&"FontSize"===i)return"Font Size";for(f=0;f<n.length;f++){if("value"===r&&n[f].value.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}if("text"===r&&n[f].text.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}if("subCommand"===r&&n[f].subCommand.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}}if(!t.isNullOrUndefined(e))switch(u){case"text":o=e.text;break;case"value":o=e.value;break;case"iconCss":o=e.iconCss}return o}function rv(n){return t.isNullOrUndefined(n)?"":n}function bb(n,t,i){return i?window.pageYOffset+t.getBoundingClientRect().top+n.clientY:n.pageY}function ve(n,t){var i=t.getService("rteLocale"),r=aot[""+n];return i.getConstant(r)}function uv(n,i,r){var f,h,s,y,o,e,p,k,a;tk(r);for(var u=n.dropDownModule,c=n.args,v=0,b=Object.keys(n.args);v<b.length;v++)for(f=b[v],h=0;h<n.tbItems.length;h++)if(s=n.tbItems[h].subCommand,y=s&&s.toLocaleLowerCase(),s&&y===f||"UL"===s&&"unorderedlist"===f||"OL"===s&&"orderedlist"===f||"CodeBlock"===s&&"isCodeBlock"===f||"Checklist"===s&&"isCheckList"===f||"pre"===y&&"insertcode"===f||"NumberFormatList"===s&&"numberFormatList"===f||"BulletFormatList"===s&&"bulletFormatList"===f)if("boolean"==typeof c[""+f])!0===c[""+f]?t.addClass([n.tbElements[h]],[uu]):t.removeClass([n.tbElements[h]],[uu]);else if(("string"==typeof c[""+f]||null===c[""+f])&&iv(f,n.parent.toolbarSettings.items)>=-1){o=c[""+f]?c[""+f]:"";e="";switch(f){case"formats":if(t.isNullOrUndefined(u.formatDropDown)||!t.isNullOrUndefined(u.formatDropDown)&&u.formatDropDown.isDestroyed)break;p=n.parent.format.types;k=t.isNullOrUndefined(n.parent.format.default)?p[0].text:n.parent.format.default;e="empty"===o?"":fi(p,o,"subCommand","text");u.formatDropDown.content='<span style="display: inline-flex;width:'+n.parent.format.width+'" ><span class="e-rte-dropdown-btn-text'+(t.isNullOrUndefined(n.parent.cssClass)?"":" "+n.parent.cssClass)+'">'+(t.isNullOrUndefined(e)?k:e)+"<\/span><\/span>";u.formatDropDown.dataBind();break;case"alignments":if(t.isNullOrUndefined(u.alignDropDown)||!t.isNullOrUndefined(u.alignDropDown)&&u.alignDropDown.isDestroyed)break;e=fi(ds,o,"subCommand","iconCss");u.alignDropDown.iconCss=t.isNullOrUndefined(e)?"e-icons e-justify-left":e;u.alignDropDown.dataBind();break;case"fontname":if(t.isNullOrUndefined(u.fontNameDropDown)||!t.isNullOrUndefined(u.fontNameDropDown)&&u.fontNameDropDown.isDestroyed)break;a=n.parent.fontFamily.items;e="empty"===o?"":fi(a,o,"value","text");var d=t.isNullOrUndefined(n.parent.fontFamily.default)?0===a.length?r.serviceLocator.getService("rteLocale").getConstant("fontName"):a[0].text:n.parent.fontFamily.default,tt="Default"===(t.isNullOrUndefined(e)?d:e)?r.serviceLocator.getService("rteLocale").getConstant("fontName"):t.isNullOrUndefined(e)?d:e,w='<span style="display: inline-flex;width:'+n.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text'+(t.isNullOrUndefined(n.parent.cssClass)?"":" "+n.parent.cssClass)+'">'+tt+"<\/span><\/span>";kb(u.fontNameDropDown,w);break;case"fontsize":if(t.isNullOrUndefined(u.fontSizeDropDown)||!t.isNullOrUndefined(u.fontSizeDropDown)&&u.fontSizeDropDown.isDestroyed)break;var l=n.parent.fontSize.items,g=t.isNullOrUndefined(n.parent.fontSize.default)?0===l.length?r.serviceLocator.getService("rteLocale").getConstant("fontSize"):l[0].text:n.parent.fontSize.default,nt=fi(l,""===o?g.replace(/\s/g,""):o,l.length>0&&l[0]&&g.replace(/\s/g,"")===l[0].text&&""===o?"text":"value","text");e="empty"===o?"":"Default"===nt?r.serviceLocator.getService("rteLocale").getConstant("fontSize"):nt;w='<span style="display: inline-flex;width:'+n.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text'+(t.isNullOrUndefined(n.parent.cssClass)?"":" "+n.parent.cssClass)+'">'+rv(e)+"<\/span><\/span>";kb(u.fontSizeDropDown,w);break;case"bulletFormatList":case"numberFormatList":""!==o?t.addClass([n.tbElements[h]],[uu]):t.removeClass([n.tbElements[h]],[uu])}}}function ye(n){return"object"==typeof n?n:[n]}function kb(n,t){var i=t.match(/style="([^"]*)"/),r="",u;i&&(r=i[1]);u=t.replace(/ style="([^"]*)"/,"");n.content=u;n.dataBind();n.element.firstChild&&(n.element.firstChild.style.cssText=r)}function pe(n,t){for(var i,u=[],r=0;r<n.length;r++)for(i=0;i<t.length;i++)if("Separator"!==t[i].type){if(("OrderedList"===n[r]||"NumberFormatList"===n[r])&&"OL"===t[i].subCommand){u.push(i);break}if(("UnorderedList"===n[r]||"BulletFormatList"===n[r])&&"UL"===t[i].subCommand){u.push(i);break}if("InsertCode"===n[r]&&"Pre"===t[i].subCommand){u.push(i);break}if("Blockquote"===n[r]&&"blockquote"===t[i].subCommand){u.push(i);break}if("string"==typeof n[r]&&"inlinecode"===n[r].toLocaleLowerCase()&&"InlineCode"===t[i].subCommand){u.push(i);break}if("FileManager"===n[r]&&"File"===t[i].subCommand){u.push(i);break}if("object"==typeof n[r]&&"Custom"===n[r].command){u.push(r);break}if(n[r]===t[i].subCommand){u.push(i);break}}return u}function bu(n,i){for(var o,u,f=0,s=pe(ye(kot),n.toolbarObj.items),h=t.selectAll("."+or,n.toolbarObj.element),r=0,e=Object.keys(i);r<e.length;r++)o=e[r],u=h[s[f]],u&&n.toolbarObj.enableItems(u,i[""+o]),f++}function eu(n,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0);n.dispatchEvent(i)}function vr(n){var i=t.createElement("template");return i.innerHTML=n,i.content instanceof DocumentFragment?i.content:document.createRange().createContextualFragment(n)}function db(n,t){var i=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?i.push(t):i=i.concat(db(n,t));return i}function fv(n){for(var i={},r=Object.keys(n),t=0;t<Object.keys(n).length;t++)i[r[t].toLocaleLowerCase()]=n[r[t]];return i}function gs(n,t){var i;return null!==n&&""!==n?(i=t.enableHtmlEncode?gb(nr(n),t):gb(n,t),t.setProperties({value:i},!0)):i="DIV"===t.enterKey?t.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/><\/div>":"BR"===t.enterKey?t.enableHtmlEncode?"&lt;br/&gt;":"<br/>":t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/><\/p>",i}function gb(n,i){var u=document.createElement("div"),o=document.createElement("div"),y=u.childNodes,e,l,f;if(u.innerHTML=n.trim(),u.setAttribute("class","tempDiv"),y.length>0){for(var h=void 0,a=void 0,s=void 0;u.firstChild;){for(var v=u.querySelectorAll(gd),c=!1,r=0;r<v.length;r++)v[r].innerHTML="<br>";for(e=u.querySelectorAll("p"),r=0;r<e.length;r++)0===e[r].textContent.trim().length&&1===e[r].childNodes.length&&"#text"===e[r].childNodes[0].nodeName&&t.isNullOrUndefined(e[r].childNodes[0].textContent.match(/\u00a0/g))&&(e[r].innerHTML="<br>");for(l=u.querySelectorAll(ng),r=0;r<l.length;r++)l[r].innerHTML="&ZeroWidthSpace;";"#text"===u.firstChild.nodeName&&" "===u.firstChild.textContent&&(c=!(!t.isNullOrUndefined(u.firstChild.nextSibling)&&-1!==["A","ABBR","ACRONYM","B","BDO","BIG","BR","BUTTON","CITE","CODE","DFN","EM","I","INPUT","KBD","LABEL","MAP","OBJECT","Q","SAMP","SCRIPT","SELECT","SMALL","SPAN","STRONG","SUB","SUP","TEXTAREA","TIME","TT","U","VAR","WBR"].indexOf(u.firstChild.nextSibling.nodeName)));"BR"!==i.enterKey&&("#text"===u.firstChild.nodeName&&(u.firstChild.textContent.indexOf("\n")<0||""!==u.firstChild.textContent.trim())||dot.indexOf(u.firstChild.nodeName.toLocaleLowerCase())>=0)&&!c?(h?a.appendChild(u.firstChild):(s="DIV"===i.enterKey?t.createElement("div"):t.createElement("p"),o.appendChild(s),s.appendChild(u.firstChild)),a=s,h=!0):"#text"!==u.firstChild.nodeName||!("\n"===u.firstChild.textContent||u.firstChild.textContent.indexOf("\n")>=0&&""===u.firstChild.textContent.trim()||c)||!t.isNullOrUndefined(i.sourceCodeModule)&&t.isNullOrUndefined(i.sourceCodeModule)?(o.appendChild(u.firstChild),h=!1):t.detach(u.firstChild)}for(f=o.querySelectorAll("img"),r=0;r<f.length;r++)f[r].classList.contains("e-rte-image-unsupported")||(f[r].classList.contains(bs)||f[r].classList.add(bs),f[r].classList.contains(gi)||f[r].classList.contains(ri)||f[r].classList.contains("e-imgleft")||f[r].classList.contains("e-imgright")||f[r].classList.contains("e-imgcenter")||f[r].classList.add(gi))}return o.innerHTML}function nk(n){return"DIV"===n.enterKey?n.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/><\/div>":"BR"===n.enterKey?n.enableHtmlEncode?"&lt;br/&gt;":"<br/>":n.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/><\/p>"}function ett(n){return"<p><br><\/p>"===n||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===n||"<div><br><\/div>"===n||"&lt;div&gt;&lt;br&gt;&lt;/div&gt;"===n||"<br>"===n||"&lt;br&gt;"===n||""===n}function nr(n){return n.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function ev(n,i){if(i.enableHtmlSanitizer){var r=t.SanitizeHtmlHelper.beforeSanitize();r.selectors.tags[2]&&r.selectors.tags[2].indexOf("iframe")>-1&&(r.selectors.tags[2]="iframe:not(.e-rte-embed-url)");t.extend(r,r,{cancel:!1,helper:null});i.trigger("beforeSanitizeHtml",r);r.cancel&&!t.isNullOrUndefined(r.helper)?n=r.helper(n):r.cancel||(n=t.SanitizeHtmlHelper.serializeValue(r,n))}return ott(n)}function ott(n){var i=t.createElement("div"),r;return n=n.replace(/&(times|divide|ne)/g,"&amp;amp;$1"),i.innerHTML=n,i.querySelectorAll("font").forEach(function(n){var r=document.createElement("span"),i=(n.getAttribute("style")||"").replace(/style:/gi,"").trim();t.isNullOrUndefined(i)||""===i.trim()||i.endsWith(";")||(i+=";");Array.from(n.attributes).forEach(function(n){var r=n.name.toLowerCase(),t=n.value;switch(r){case"size":i+="font-size:"+t+";";break;case"face":i+="font-family:"+t+";";break;case"bgcolor":i+="background-color:"+t+";";break;case"style":break;default:i+=r+":"+t+";"}});t.isNullOrUndefined(i)||""===i.trim()||(i=i.replace(/;;+/g,";"),r.style.cssText=i);r.innerHTML=n.innerHTML;t.isNullOrUndefined(n.parentNode)||n.parentNode.replaceChild(r,n)}),r=i.innerHTML,i.remove(),r}function nh(n,t,i){for(var r=0;t.length>r;r++)if(t[r].value===i.value||t[r].value===i.subCommand)return n.localeObj.getConstant(t[r].locale);return i.text}function tk(n){aa.forEach(function(t,i){aa[i].text=nh(n,vot,aa[i])});va.forEach(function(t,i){va[i].text=nh(n,yot,va[i])});pa.forEach(function(t,i){pa[i].text=nh(n,pot,pa[i])});wa.forEach(function(t,i){wa[i].text=nh(n,wot,wa[i])})}function s(){var n=!1;return t.Browser.isDevice&&t.Browser.isIos&&(n=!0),n}function wr(n,i){if("BODY"===n.nodeName&&!t.isNullOrUndefined(i)){var r=top.window.document.querySelector(i);t.isNullOrUndefined(r)||r.contentWindow.focus()}}function ltt(n){var e=document.createElement("div"),i,t,u,r,f;for(e.innerHTML=n,i=e.querySelectorAll("table"),t=0;t<i.length;t++)if(i[t].classList.length>0&&!i[t].classList.contains("e-rte-table")&&!i[t].classList.contains("e-rte-custom-table")){if(i[t].classList.add("e-rte-paste-table"),i[t].classList.contains("e-rte-paste-word-table")){i[t].classList.remove("e-rte-paste-word-table");continue}if(i[t].classList.contains("e-rte-paste-excel-table"))for(i[t].classList.remove("e-rte-paste-excel-table"),"0"===i[t].getAttribute("border")&&i[t].removeAttribute("border"),u=i[t].querySelectorAll("td"),r=0;r<u.length;r++)"none"===u[r].style.borderLeft&&u[r].style.removeProperty("border-left"),"none"===u[r].style.borderRight&&u[r].style.removeProperty("border-right"),"none"===u[r].style.borderBottom&&u[r].style.removeProperty("border-bottom"),"none"===u[r].style.borderTop&&u[r].style.removeProperty("border-top"),"none"===u[r].style.border&&u[r].style.removeProperty("border");else{if(i[t].classList.contains("e-rte-paste-onenote-table")){i[t].classList.remove("e-rte-paste-onenote-table");continue}if(i[t].classList.contains("e-rte-paste-html-table")){i[t].classList.remove("e-rte-paste-html-table");continue}}}for(f=e.querySelectorAll("img"),t=0;t<f.length;t++)f[t].classList.contains("e-rte-image-unsupported")||(f[t].classList.contains("e-rte-image")||f[t].classList.add("e-rte-image"),f[t].classList.contains("e-imginline")||f[t].classList.contains("e-imgbreak")||f[t].classList.add("e-imginline"));return e.innerHTML}function att(n){var t=n;do t.childNodes.length>0&&(t=t.childNodes[0]);while(t.childNodes.length>0);return t}function got(){return{bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,numberFormatList:!1,bulletFormatList:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1,blockquote:!1,inlinecode:!1,isCodeBlock:!1,isCheckList:!1}}function nst(){return{bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,uppercase:!1,lowercase:!1,inlinecode:!1,unorderedlist:!1,formats:null}}function uk(n,t){var f,i,u,e,r;if((void 0===t&&(t=null),!n)||(f=n.nodeName.toUpperCase(),-1!==["TABLE","IMG","VIDEO","AUDIO"].indexOf(f)))return!1;if(n.nodeType===Node.ELEMENT_NODE&&n.hasAttribute("style"))return!0;for(t||(t=new yi),i=0,u=["bold","italic","underline","strikethrough","superscript","subscript","fontcolor","fontname","fontsize","backgroundcolor","inlinecode"];i<u.length;i++)if(e=u[i],t.isFormattedNode(n,e))return!0;for(r=0;r<n.childNodes.length;r++)if(uk(n.childNodes[r],t))return!0;return!1}function vtt(n,i){if(null!==n.startContainer.parentElement.closest("ol,ul")&&null!==n.endContainer.parentElement.closest("ol,ul")){n.extractContents();var r=("#text"===n.startContainer.nodeName?n.startContainer.parentElement:n.startContainer).querySelectorAll("li");r.length>0&&r.forEach(function(n){t.isNullOrUndefined(n.firstChild)||"OL"!==n.firstChild.nodeName&&"UL"!==n.firstChild.nodeName||(n.style.listStyleType="none");""===n.innerHTML.trim()&&n!==i&&n.remove();var r="LI"===i.nodeName?i:t.closest(i,"li");""===n.textContent.trim()&&n!==r&&n.remove()})}}function hr(n,i){var e="BODY"===i.nodeName?i.ownerDocument.defaultView.frameElement.closest(".e-richtexteditor"):i.closest(".e-richtexteditor"),l=e.style.height,o,c;if(0!==n.getSelection().rangeCount){var s=n.getSelection().getRangeAt(0),r="#text"===s.startContainer.nodeName?s.startContainer.parentElement:s.startContainer,a=r.getBoundingClientRect(),u=a.top,f=a.bottom,h=e.getBoundingClientRect(),v=e.querySelectorAll(".e-count-enabled, .e-resize-enabled").length>0;"BODY"===i.nodeName?"auto"===l?window.innerHeight<u&&r.scrollIntoView(!1):(u>i.getBoundingClientRect().height||f>h.bottom)&&r.scrollIntoView({block:"nearest",inline:"nearest"}):"auto"===l?(window.innerHeight<u&&r.scrollIntoView({block:"end",inline:"nearest"}),u>i.getBoundingClientRect().height&&r.scrollIntoView({block:"nearest",inline:"nearest"})):(u>i.getBoundingClientRect().height&&r.scrollIntoView({block:"nearest",inline:"nearest"}),f>h.bottom&&(e.querySelector(".e-rte-content").scrollTop+=f-h.bottom+(v?20:0)));o=i.closest('div[style*="overflow-y: scroll"]');t.isNullOrUndefined(o)||(c=o.getBoundingClientRect(),f>c.bottom&&(o.scrollTop+=f-c.bottom))}}function fk(n,t,i){for(var r=0;r<t.length;r++)0===r?n.splice(i+r,1,t[r]):n.splice(i+r,0,t[r]);return n}function p(n,i){t.removeClass(n,i);for(var r=0;r<n.length;r++)0===n[r].classList.length&&n[r].hasAttribute("class")&&n[r].removeAttribute("class");return n}function g(n){for(var f=[],e=n.rows,t=0;t<=e.length-1;t++)for(var o=e[t],i=0,r=0;r<=o.children.length-1;r++){var u=o.children[r],s=parseInt(u.getAttribute("colspan"),10)||1,h=parseInt(u.getAttribute("rowspan"),10)||1;i=ytt(f,u,t,i,s,h);i+=s}return f}function ytt(n,t,i,r,u,f){for(var o,e=i;e<i+f;e++)for(n[e]||(n[e]=[]),o=r;o<r+u;o++)n[e][o]?r++:n[e][o]=t;return r}function pi(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]===n)return[i,r];return[]}function rf(n,i){var u,f,s,b,a,h,v,c,y,e,l;if(void 0===i&&(i=!1),n&&(!ou(n)||i)){for(var k=de(n),o=new Array(k),p=t.createElement("colgroup"),w=new Map,r=0;r<n.rows.length;r++)for(u=0,f=0;f<n.rows[r].cells.length;f++){for(s=1;s<n.rows[r].cells[f].rowSpan;s++)b=""+(r+s)+u,w.set(b,n.rows[r].cells[f]);(e=fh(w,r,f))>u&&(u=e);a=n.rows[r].cells[f].offsetWidth;(!o[u]||a<o[u])&&(o[u]=a);u+=1+n.rows[r].cells[f].colSpan-1}for(h=0;h<o.length;h++)(l=t.createElement("col")).appendChild(t.createElement("br")),l.style.width=it(o[h],parseInt(getComputedStyle(n).width,10))+"%",p.appendChild(l);for(i&&(v=ou(n),v&&t.detach(v)),n.insertBefore(p,n.firstChild),c=0;c<n.rows.length;c++)for(y=n.rows[c],e=0;e<y.cells.length;e++)(l=y.cells[e]).style.width="";(t.isNullOrUndefined(n.style.width)||""===n.style.width)&&(n.style.width=n.offsetWidth+"px")}}function ou(n){return n&&n.children&&Array.from(n.children).find(function(n){return"COLGROUP"===n.tagName})||null}function de(n){if(!n||!n.rows||0===n.rows.length)return 0;for(var i=n.rows[0].cells,r=0,t=0;t<i.length;t++)r+=i[t].colSpan;return r}function fh(n,t,i){var u=""+t+i,r=n.get(u);return r?fh(n,t,i+r.colSpan):i}function it(n,t){return 0===t?0:n/t*100}function uf(n,t){if(t&&"HTML"===t&&n){var i=document.createElement("div");i.innerHTML=n.trim();i.querySelectorAll(".e-img-inner").forEach(function(n){n.setAttribute("contenteditable","true")});n=i.innerHTML;i.remove()}return n}function tr(n,i){var r,u,f;if(n&&i){if(r=document.createElement("div"),"HTML"===i){if(r.innerHTML=n,r.querySelectorAll(".e-img-inner").forEach(function(n){n.setAttribute("contenteditable","false")}),u=r.querySelectorAll(".e-column-resize, .e-row-resize, .e-table-box, .e-table-rhelper, .e-img-resize, .e-vid-resize, .e-tb-row-insert, .e-tb-col-insert"),u.length>0)for(f=0;f<u.length;f++)t.detach(u[f]);ek(r)}else r.textContent=n;return"Markdown"===i?r.innerHTML.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&amp;/g,"&"):r.innerHTML}return n}function ek(n){for(var i,r,f=[rh,nt,dv,kv,dt,oi,gv,ke],u=0;u<f.length;u++)if(i=n.querySelectorAll("."+f[u]),t.removeClass(i,f[u]),0!==i.length)for(r=0;r<i.length;r++)0===i[r].classList.length&&i[r].removeAttribute("class"),"IMG"!==i[r].nodeName&&"VIDEO"!==i[r].nodeName||""===i[r].style.outline||(i[r].style.outline="");n.querySelectorAll('[class=""]').forEach(function(n){n.removeAttribute("class")})}function ny(n,i,r){var u,f,e;return r||"br"===i.toLowerCase()||t.isNullOrUndefined(n)?n:(u=document.createElement("div"),u.innerHTML=n,f=i.toLowerCase(),ok(u,["div","p"].indexOf(f)>=0?f:"div"),e=u.innerHTML,u.remove(),e)}function ff(n,t){for(var r=n.values(),i=r.next();!i.done;){if(i.value===t)return!0;i=r.next()}return!1}function ok(n,t){for(var o=new Set(["DIV","TH","TD","LI","BLOCKQUOTE","OL","UL","TABLE","TBODY","TR","THEAD","TFOOT"]),r=new Set(["DIV","P","SECTION","ARTICLE","HEADER","FOOTER","ASIDE","NAV","MAIN","FIGURE","FIGCAPTION","BLOCKQUOTE","OL","UL","LI","TABLE","TBODY","TR","TD","TH","THEAD","TFOOT","H1","H2","H3","H4","H5","H6","SVG","PRE","COLGROUP"]),f=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","IMG","LABEL","IFRAME","VIDEO","AUDIO","OBJECT","EMBED","CANVAS","METER","PROGRESS","OBJECT"]),s=new Set(["BASE","AREA","LINK"]),h=Array.from(n.childNodes),i=null,c=function(u){var c=!0,h,l,a;if((u.parentElement&&"LI"===u.parentElement.nodeName&&(c=btt(u.parentElement,r)),u.nodeType===Node.TEXT_NODE)?u.nodeValue&&u.nodeValue.trim()&&c&&(i||(i=document.createElement(t),n.insertBefore(i,u)),i.appendChild(u)):u.nodeType===Node.ELEMENT_NODE&&(h=(e=u).tagName.toUpperCase(),ff(r,h)&&!ff(f,h)?(i=null,l=Array.from(e.childNodes),a=!1,l.forEach(function(n){var t=n.tagName;n.nodeType===Node.ELEMENT_NODE&&ff(r,t)&&(a=!0)}),ff(o,h)&&l.length>0&&a&&ok(e,t)):ff(r,h)||ff(f,h)||s.has(h)||"HR"===h||u.parentNode&&c&&u.parentNode.childNodes.length>1&&(i||(i=document.createElement(t),n.insertBefore(i,u)),i.appendChild(u))),u.nodeType===Node.ELEMENT_NODE){h=(e=u).tagName.toUpperCase();for(var e,y=!1,p=r.values(),v=p.next();!v.done;){if(v.value===h){y=!0;break}v=p.next()}if(y)if(1===e.childNodes.length&&e.firstChild&&e.firstChild.nodeType===Node.ELEMENT_NODE&&"P"===e.firstChild.nodeName&&"DIV"!==e.nodeName&&1===e.firstChild.childNodes.length&&e.firstChild.firstChild&&e.firstChild.firstChild.nodeType!==Node.ELEMENT_NODE&&0===e.firstChild.attributes.length)e.replaceChild(e.firstChild.firstChild,e.firstChild);else if("P"===e.nodeName&&e.parentElement&&"LI"===e.parentElement.nodeName&&!c&&0===e.attributes.length){var w=void 0,b=ptt(e.nextSibling),k=wtt(e.previousSibling);if(b||k||(w=!0),w){for(;e.firstChild;)e.parentElement.insertBefore(e.firstChild,e);e.parentElement.removeChild(e)}}}},u=0,e=h;u<e.length;u++)c(e[u])}function ptt(n){for(;n;){if((n.nodeType!==Node.TEXT_NODE||""!==n.textContent.trim())&&"OL"!==n.nodeName&&"UL"!==n.nodeName)return n;n=n.nextSibling}return null}function wtt(n){for(;n;){if((n.nodeType!==Node.TEXT_NODE||""!==n.textContent.trim())&&"OL"!==n.nodeName&&"UL"!==n.nodeName)return n;n=n.previousSibling}return null}function btt(n,t){var i=!1,r=!1;return n.childNodes.forEach(function(n){var f,e,u;n.nodeType===Node.ELEMENT_NODE?(f=n.nodeName,t.has(f)&&"OL"!==f&&"UL"!==f?(u=n.nextSibling)&&-1!==["UL","OL"].indexOf(u.nodeName)||(i=!0):-1!==["OL","UL"].indexOf(f)?(e=n.previousSibling,u=n.nextSibling,e&&t.has(e.nodeName)&&u&&u.nodeType===Node.TEXT_NODE&&u.textContent.trim().length>0&&(i=!0)):t.has(f)||"LI"===f||(u=n.nextSibling)&&-1!==["UL","OL"].indexOf(u.nodeName)||(r=!0)):n.nodeType===Node.TEXT_NODE&&n.textContent.trim().length>0&&(r=!0)}),i&&r}function br(n,t){function u(n){return"pre-line"===n.style.whiteSpace}function f(n){return"PRE"===n.tagName||"pre"===n.style.whiteSpace||"pre-wrap"===n.style.whiteSpace}var r=!1,i;return"pre-wrap"===getComputedStyle(t).whiteSpace||"pre"===getComputedStyle(t).whiteSpace?n:("pre-line"===getComputedStyle(t).whiteSpace&&(r=!0),i=document.createElement("div"),i.innerHTML=n,function n(t,i){if(void 0===i&&(i=!1),null!=t)for(var r=t.firstChild;null!=r;)3===r.nodeType?i?(r.nodeValue=r.nodeValue.replace(/[\t]/g," "),r.nodeValue=r.nodeValue.replace(/[ ]{2,}/g," ")):(r.nodeValue=r.nodeValue.replace(/[\n\r\t]/g," "),r.nodeValue=r.nodeValue.replace(/[ ]{2,}/g," ")):1===r.nodeType&&(f(r)||u(r)||n(r,i),u(r)&&n(r,!0)),r=r.nextSibling}(i,r),i.innerHTML)}function kr(n){for(var i=n.split(","),f=i[0].match(/:(.*?);/)[1],r=atob(i[1]),t=r.length,u=new Uint8Array(t);t--;)u[t]=r.charCodeAt(t);return new Blob([u],{type:f})}function ktt(n){return n.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function dtt(n){return ty((new DOMParser).parseFromString(n,"text/html").body,0).trim()}function ty(n,t){var u=new Set(["address","article","aside","blockquote","canvas","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hr","li","main","nav","noscript","ol","p","pre","section","table","tfoot","ul","thead","tbody","tr","th","td","colgroup"]),f=new Set(["area","base","br","col","embed","hr","img","input","link","meta","source","track","wbr"]),r="   ".repeat(t),i="";return n.childNodes.forEach(function(n){var o,a;if(n.nodeType===Node.TEXT_NODE)o=n.textContent,0===o.trim().length&&(o=o.trim()),o&&(o=o.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;"),i+=o);else if(n.nodeType===Node.ELEMENT_NODE){var v=n,e=v.tagName.toLowerCase(),s=Array.from(v.attributes).map(function(n){return n.name+'="'+ktt(n.value)+'"'}).join(" "),h=s?" "+s:"",c=s?"<"+e+" "+s+">":"<"+e+">",l="<\/"+e+">",y=u.has(e);f.has(e)?i+="col"===e?"\n"===i[i.length-1]?r+"<"+e+h+">\n":"\n"+r+"<"+e+h+">\n":"<"+e+h+"/>":y?(i+="\n"===i[i.length-1]?""+r+c:"\n"+r+c,a=ty(n,t+1),a&&(i+=""+a),i+="\n"===i[i.length-1]?""+r+l+"\n":l+"\n"):i+=""+c+ty(n,0)+l}}),i}function gtt(n,i){var h=n.ownerDocument.createElement("div"),e=[].slice.call(n.ownerDocument.getElementsByTagName("head")[0].querySelectorAll("base, link, style")),o=[].slice.call(n.ownerDocument.getElementsByTagName("body")[0].querySelectorAll("link, style")),r,u,s,f,c;if(o.length)for(r=0,u=o.length;r<u;r++)e.push(o[parseInt(r.toString(),10)]);for(s="",t.isNullOrUndefined(i)&&(i=window.open("","print","height=452,width=1024,tabbar=no")),h.appendChild(n.cloneNode(!0)),f=0,u=e.length;f<u;f++)s+=e[parseInt(f.toString(),10)].outerHTML;return i.document.write("<!DOCTYPE html> <html><head>"+s+"<\/head><body>"+h.innerHTML+"<script> (function() { window.ready = true; })(); <\/script><\/body><\/html>"),i.document.close(),i.focus(),c=setInterval(function(){i.ready&&(i.print(),i.close(),clearInterval(c))},500),i}function pp(n,t,i,r){var f,e,o,u;if(f=i?t.contentModule.getDocument().querySelector("body"):t.element,Object.keys(n).length)for(e=0,o=Object.keys(n);e<o.length;e++)u=o[e],"class"===u?f.classList.add(n[""+u]):"disabled"===u&&"disabled"===n[""+u]?(t.enabled=!1,t.setEnable()):"readonly"===u&&"readonly"===n[""+u]?(t.readonly=!0,t.setReadOnly(r)):"style"===u?f.style.cssText=n[""+u]:"tabindex"===u?t.inputElement.setAttribute("tabindex",n[""+u]):"placeholder"===u?(t.placeholder=n[""+u],t.setPlaceHolder()):["name","required"].indexOf(u)>-1?t.valueContainer.setAttribute(u,n[""+u]):f.setAttribute(u,n[""+u])}var vh,yh,iy,sk,lp,tft;vh={};n.r(vh);n.d(vh,{ACTION:()=>ku,ALIGNMENT_TYPE:()=>dy,ALLOWED_TABLE_BLOCK_TAGS:()=>rit,AUDIO:()=>uy,Alignments:()=>ait,Audio:()=>est,AudioCommand:()=>frt,BLOCKQUOTE_LIST_HANDLE:()=>stt,BLOCK_TAGS:()=>bt,BaseQuickToolbar:()=>fut,BaseToolbar:()=>bp,CLASS_AUDIO:()=>sp,CLASS_AUDIO_BREAK:()=>nrt,CLASS_AUDIO_FOCUS:()=>gk,CLASS_AUDIO_INLINE:()=>bk,CLASS_AUDIO_WRAP:()=>hp,CLASS_CAPTION:()=>v,CLASS_CAPTION_INLINE:()=>wk,CLASS_CLICK_ELEM:()=>kk,CLASS_EMBED_VIDEO_WRAP:()=>dk,CLASS_IMAGE_BREAK:()=>op,CLASS_IMAGE_CENTER:()=>ef,CLASS_IMAGE_INLINE:()=>trt,CLASS_IMAGE_LEFT:()=>ki,CLASS_IMAGE_RIGHT:()=>bi,CLASS_RTE_CAPTION:()=>rst,CLASS_VIDEO:()=>ti,CLASS_VIDEO_BREAK:()=>hh,CLASS_VIDEO_CENTER:()=>pk,CLASS_VIDEO_CLICK_ELEM:()=>ch,CLASS_VIDEO_FOCUS:()=>nd,CLASS_VIDEO_INLINE:()=>ro,CLASS_VIDEO_LEFT:()=>io,CLASS_VIDEO_RIGHT:()=>ep,CLASS_VIDEO_WRAP:()=>irt,CLEAR_COMMAND:()=>tw,CLEAR_TYPE:()=>rp,CLS_ACTIVE:()=>uu,CLS_ALIGN_TB_BTN:()=>gg,CLS_AUDIOBREAK:()=>ys,CLS_AUDIOINLINE:()=>he,CLS_AUDIOWRAP:()=>sr,CLS_AUDIO_QUICK_TB:()=>fg,CLS_AUD_FOCUS:()=>oi,CLS_BACK:()=>fet,CLS_BACKGROUND_COLORPICKER:()=>fn,CLS_BORDERCOLOR_COLORPICKER:()=>tn,CLS_BORDER_STYLE_BTN:()=>nn,CLS_BULLETFORMATLIST_DROPDOWN:()=>on,CLS_BULLETFORMATLIST_TB_BTN:()=>cet,CLS_CAPINLINE:()=>se,CLS_CAPTION:()=>ui,CLS_CLICKELEM:()=>cr,CLS_CODEBLOCK_TB_BTN:()=>pg,CLS_CODEBLOCK_TB_BTN_ICON:()=>wg,CLS_COLOR_PALETTE:()=>sn,CLS_CONTENT:()=>kft,CLS_COUNT:()=>eb,CLS_CUSTOM_TILE:()=>gn,CLS_DISABLED:()=>ra,CLS_DROPAREA:()=>la,CLS_DROPDOWN:()=>lr,CLS_DROPDOWN_BTN:()=>yt,CLS_DROPDOWN_ICONS:()=>fa,CLS_DROPDOWN_ITEMS:()=>vi,CLS_DROPDOWN_MENU:()=>vg,CLS_DROPDOWN_POPUP:()=>ni,CLS_ERROR:()=>ha,CLS_EXPAND_OPEN:()=>ca,CLS_FOCUS:()=>oa,CLS_FONT_COLORPICKER:()=>un,CLS_FONT_NAME_TB_BTN:()=>kg,CLS_FONT_SIZE_TB_BTN:()=>dg,CLS_FORMATS_TB_BTN:()=>bg,CLS_FULL_SCREEN:()=>fe,CLS_HIDE:()=>pu,CLS_HR_SEPARATOR:()=>yg,CLS_ICONS:()=>ws,CLS_IMGBREAK:()=>ri,CLS_IMGCENTER:()=>fb,CLS_IMGINLINE:()=>gi,CLS_IMGLEFT:()=>ub,CLS_IMGRIGHT:()=>rb,CLS_IMG_FOCUS:()=>rh,CLS_IMG_INNER:()=>lb,CLS_IMG_QUICK_TB:()=>ug,CLS_IMG_RESIZE:()=>bn,CLS_INLINE:()=>ua,CLS_INLINE_DROPDOWN:()=>lg,CLS_INLINE_POP:()=>cg,CLS_INLINE_TOOLBAR:()=>ee,CLS_LINK_QUICK_TB:()=>sg,CLS_LIST_PRIMARY_CONTENT:()=>set,CLS_MAXIMIZE:()=>uet,CLS_MINIMIZE:()=>ret,CLS_NOCOLOR_ITEM:()=>ntt,CLS_NUMBERFORMATLIST_DROPDOWN:()=>en,CLS_NUMBERFORMATLIST_TB_BTN:()=>het,CLS_POPUP:()=>tet,CLS_POPUP_CLOSE:()=>cb,CLS_POPUP_OPEN:()=>wu,CLS_QUICK_DROPDOWN:()=>iu,CLS_QUICK_POP:()=>gw,CLS_QUICK_TB:()=>vs,CLS_QUICK_TBAR_TIP_POINTER:()=>nb,CLS_RESIZE:()=>gv,CLS_RM_WHITE_SPACE:()=>eet,CLS_RTE:()=>ls,CLS_RTE_AUDIO_UPLOAD_POPUP:()=>utt,CLS_RTE_CAPTION:()=>ag,CLS_RTE_CONTAINER:()=>ig,CLS_RTE_CONTENT:()=>gft,CLS_RTE_DIALOG_MIN_HEIGHT:()=>yn,CLS_RTE_DIALOG_UPLOAD:()=>ab,CLS_RTE_DRAG_IMAGE:()=>ke,CLS_RTE_ELEMENTS:()=>pt,CLS_RTE_EXPAND_TB:()=>dw,CLS_RTE_FIXED_TB_EXPAND:()=>yb,CLS_RTE_HIDDEN:()=>sb,CLS_RTE_IFRAME_CONTENT:()=>bw,CLS_RTE_IMAGE:()=>bs,CLS_RTE_IMAGE_UPLOAD_POPUP:()=>itt,CLS_RTE_PASTE_CANCEL:()=>vn,CLS_RTE_PASTE_KEEP_FORMAT:()=>hn,CLS_RTE_PASTE_OK:()=>an,CLS_RTE_PASTE_PLAIN_FORMAT:()=>ln,CLS_RTE_PASTE_REMOVE_FORMAT:()=>cn,CLS_RTE_READONLY:()=>le,CLS_RTE_RES_CNT:()=>vb,CLS_RTE_RES_EAST:()=>wn,CLS_RTE_RES_HANDLE:()=>pn,CLS_RTE_RES_WEST:()=>ttt,CLS_RTE_SOURCE_CODE_TXTAREA:()=>fu,CLS_RTE_TABLE_RESIZE:()=>bv,CLS_RTE_TB_ENABLED:()=>pb,CLS_RTE_UPLOAD_POPUP:()=>hb,CLS_RTE_VIDEO_UPLOAD_POPUP:()=>rtt,CLS_RTL:()=>tu,CLS_SCRIPT_SHEET:()=>pw,CLS_SEPARATOR:()=>iet,CLS_SHOW:()=>tb,CLS_STYLE_SHEET:()=>ww,CLS_TABLE:()=>aet,CLS_TABLE_BGCOLOR_COLORPICKER:()=>rn,CLS_TABLE_BORDER:()=>vet,CLS_TABLE_MULTI_CELL:()=>dv,CLS_TABLE_QUICK_TB:()=>og,CLS_TABLE_SEL:()=>nt,CLS_TABLE_SEL_END:()=>kv,CLS_TB_ALT_BOR:()=>tf,CLS_TB_BOX_RES:()=>be,CLS_TB_BTN:()=>oet,CLS_TB_COL_INSERT:()=>ctt,CLS_TB_COL_RES:()=>th,CLS_TB_DASH_BOR:()=>nf,CLS_TB_EXTENDED:()=>net,CLS_TB_FIXED:()=>kw,CLS_TB_FLOAT:()=>as,CLS_TB_INLINE:()=>dft,CLS_TB_IOS_FIX:()=>ob,CLS_TB_ITEM:()=>or,CLS_TB_ROW_INSERT:()=>htt,CLS_TB_ROW_RES:()=>ih,CLS_TB_STATIC:()=>hg,CLS_TB_WRAP:()=>ea,CLS_TEXT_QUICK_TB:()=>rg,CLS_TOOLBAR:()=>ue,CLS_UPLOAD_FILES:()=>dn,CLS_VIDEOBREAK:()=>ps,CLS_VIDEOINLINE:()=>ce,CLS_VIDEOWRAP:()=>ru,CLS_VIDEO_QUICK_TB:()=>eg,CLS_VID_CLICK_ELEM:()=>oe,CLS_VID_FOCUS:()=>dt,CLS_VID_RESIZE:()=>kn,CLS_VISIBLE:()=>ib,CLS_WARNING:()=>sa,CODEBLOCK_DISABLETOOLBAR:()=>wv,CODEBLOCK_INDENTATION:()=>pv,CODE_BLOCK:()=>sv,ClearFormat:()=>vut,ClearFormatExec:()=>wit,CodeBlock:()=>nlt,CodeBlockPlugin:()=>gut,ColorPickerInput:()=>lh,ContentRender:()=>iy,Count:()=>hct,CustomUserAgentData:()=>sh,DEFAULT_TAG:()=>gt,DELETECOLUMN:()=>cy,DELETEROW:()=>hy,DESTROY:()=>rk,DOMNode:()=>oh,DialogRenderer:()=>crt,DialogType:()=>d,DropDownButtons:()=>kp,EMOJI_PICKER_ACTIONS:()=>yv,EXPORT_STYLES:()=>ed,EditorManager:()=>git,EmojiPicker:()=>dct,EmojiPickerAction:()=>dut,ExecCommandCallBack:()=>brt,FORMAT_PAINTER_ACTIONS:()=>vv,FORMAT_TYPE:()=>du,FileManager:()=>bct,FormatPainter:()=>kct,FormatPainterActions:()=>nft,Formats:()=>lit,Formatter:()=>ud,FullScreen:()=>nut,HTMLFormatter:()=>wut,HtmlEditor:()=>yct,HtmlToolbarStatus:()=>fd,IFRAME_EDITOR_DARK_THEME_STYLES:()=>vrt,IFRAME_EDITOR_LIGHT_THEME_STYLES:()=>art,IFRAME_EDITOR_STYLES:()=>lrt,IGNORE_BLOCK_TAGS:()=>ir,IMAGE:()=>no,INDENT_TYPE:()=>gy,INSERTHTML_TYPE:()=>tp,INSERT_COLUMN:()=>sy,INSERT_ROW:()=>oy,INSERT_TEXT_COMMAND:()=>rw,INSERT_TEXT_TYPE:()=>ip,INTERNAL_DESTROY:()=>f,IframeContentRender:()=>tut,Image:()=>fst,ImageCommand:()=>urt,ImageInputSource:()=>ge,ImportExport:()=>gct,Indents:()=>vit,InsertHtml:()=>kt,InsertHtmlExec:()=>pit,InsertMethods:()=>h,InsertTextExec:()=>dit,IsFormatted:()=>yi,KEY_DOWN:()=>we,KEY_DOWN_HANDLER:()=>c,KEY_UP:()=>yr,KEY_UP_HANDLER:()=>ei,KeyboardEvents:()=>yp,LINK:()=>eh,LINK_COMMAND:()=>nw,LISTS_COMMAND:()=>gp,LIST_TYPE:()=>ov,Link:()=>ust,LinkCommand:()=>rrt,Lists:()=>cit,MDFormats:()=>sut,MDLink:()=>lut,MDLists:()=>out,MDSelectionFormats:()=>hut,MDTable:()=>aut,MD_TABLE:()=>iw,MODEL_CHANGED:()=>gu,MODEL_CHANGED_PLUGIN:()=>pr,MOUSE_DOWN:()=>ik,MS_WORD_CLEANUP:()=>cv,MS_WORD_CLEANUP_PLUGIN:()=>hv,MarkdownEditor:()=>act,MarkdownFormatter:()=>put,MarkdownParser:()=>yut,MarkdownRender:()=>iut,MarkdownSelection:()=>dp,MarkdownToolbarStatus:()=>eut,MediaInputSource:()=>ry,MsWordPaste:()=>kit,NodeCutter:()=>su,NodeSelection:()=>st,ON_BEGIN:()=>lv,PASTE_SOURCE:()=>up,PasteCleanup:()=>pct,PasteCleanupAction:()=>kut,QuickPopupRenderer:()=>rut,QuickToolbar:()=>sct,REMOVETABLE:()=>ly,Render:()=>sk,RenderType:()=>o,RendererFactory:()=>wrt,Resize:()=>wct,RichTextEditor:()=>rct,SELECTION_TYPE:()=>np,SELF_CLOSING_TAGS:()=>iit,SPACE_ACTION:()=>av,SelectionBasedExec:()=>yit,SelectionCommands:()=>fp,ServiceLocator:()=>prt,SlashMenu:()=>ect,TABLE:()=>ey,TABLEHEADER:()=>ay,TABLE_BACKGROUND_COLOR:()=>ky,TABLE_BLOCK_TAGS:()=>to,TABLE_HORIZONTAL_SPLIT:()=>wy,TABLE_MERGE:()=>yy,TABLE_MOVE:()=>hk,TABLE_SELECTION_STATE_ALLOWED_ACTIONKEYS:()=>sit,TABLE_STYLES:()=>by,TABLE_VERTICAL_ALIGN:()=>vy,TABLE_VERTICAL_SPLIT:()=>py,Table:()=>cst,TableCommand:()=>hrt,TablePasting:()=>srt,Toolbar:()=>oct,ToolbarAction:()=>uut,ToolbarRenderer:()=>lp,ToolbarStatus:()=>td,ToolbarType:()=>wt,UndoRedoCommands:()=>cut,UndoRedoManager:()=>bit,VIDEO:()=>fy,Video:()=>ost,VideoCommand:()=>ert,ViewSource:()=>ort,XhtmlValidation:()=>but,actionBegin:()=>l,actionComplete:()=>ct,actionSuccess:()=>eft,afterImageDelete:()=>sl,afterKeyDown:()=>gl,afterMediaDelete:()=>bo,afterPasteCleanup:()=>lw,alignmentHtml:()=>dtt,audioDelete:()=>cc,audioToolbarAction:()=>rc,autoResize:()=>ta,beforeDialogClose:()=>vd,beforeDialogOpen:()=>ld,beforeDropDownItemRender:()=>tc,beforeDropDownOpen:()=>pc,beforeFileUpload:()=>cl,beforeImageDrop:()=>dd,beforeImageUpload:()=>hl,beforeMediaDrop:()=>hw,beforePasteCleanup:()=>cw,beforeQuickToolbarOpen:()=>pd,bindCssClass:()=>w,bindOnEnd:()=>b,blockEmptyNodes:()=>gd,checkUndo:()=>gf,cleanHTMLString:()=>br,cleanupInternalElements:()=>tr,cleanupResizeElements:()=>dl,clearDialogObj:()=>fr,closeAudioDialog:()=>yl,closeImageDialog:()=>vl,closeLinkDialog:()=>al,closeTableDialog:()=>wl,closeTooltip:()=>cs,closeVideoDialog:()=>pl,codeBlockEnter:()=>kc,codeBlockPaste:()=>wo,colorPickerChanged:()=>pf,contentBlur:()=>pft,contentChanged:()=>cf,contentFocus:()=>yft,contentscroll:()=>ai,conversionFactors:()=>tg,convertPixelToPercentage:()=>it,convertToBlob:()=>kr,count:()=>wc,createTable:()=>dc,created:()=>ift,decode:()=>nr,destroy:()=>u,destroyTooltip:()=>re,destroyed:()=>rft,dialogClose:()=>yd,dialogOpen:()=>ad,disableFullScreen:()=>oo,dispatchEvent:()=>eu,docClick:()=>gr,documentClickClosedBy:()=>nu,drop:()=>te,dropDownSelect:()=>ci,dynamicModule:()=>er,editAreaClick:()=>vt,editLink:()=>ec,emojiPicker:()=>es,enableFullScreen:()=>eo,enterHandler:()=>tl,escaseHtml:()=>ktt,execCommandCallBack:()=>so,executeGroup:()=>yrt,expandPopupClick:()=>vft,fileRemoving:()=>sw,fileSelected:()=>ow,fileUploadFailed:()=>ol,fileUploadSuccess:()=>el,fileUploading:()=>fl,focusChange:()=>wf,formatNode:()=>ty,formatPainterClick:()=>bl,formatPainterDoubleClick:()=>kl,formatRTEContent:()=>gb,getCellIndex:()=>fh,getColGroup:()=>ou,getCollection:()=>ye,getCorrespondingColumns:()=>g,getCorrespondingIndex:()=>pi,getDefaultHtmlTbStatus:()=>got,getDefaultMDTbStatus:()=>nst,getDefaultValue:()=>nk,getDropDownValue:()=>fi,getEditValue:()=>gs,getFormattedFontSize:()=>rv,getIndex:()=>iv,getLastTextNode:()=>att,getLocaleFontFormat:()=>nh,getMaxCellCount:()=>de,getNextMeaningfulSibling:()=>ptt,getPreviousMeaningfulSibling:()=>wtt,getSelectedHtml:()=>kf,getStructuredHtml:()=>ny,getTBarItemsIndex:()=>pe,getTextNodesUnder:()=>db,getTooltipText:()=>ve,hasAnyFormatting:()=>uk,hasClass:()=>et,hidePopup:()=>os,hideTableQuickToolbar:()=>uh,htmlKeyConfig:()=>uit,htmlToolbarClick:()=>wh,iframeMouseDown:()=>ut,imageAlt:()=>sc,imageBreak:()=>cft,imageCaption:()=>ac,imageCenter:()=>hft,imageDelete:()=>hc,imageInline:()=>lft,imageLeft:()=>oft,imageLink:()=>oc,imageRemoving:()=>ew,imageResizeFactor:()=>eit,imageRight:()=>sft,imageSelected:()=>kd,imageSize:()=>vc,imageToolbarAction:()=>ic,imageUploadFailed:()=>ul,imageUploadSuccess:()=>rl,imageUploading:()=>il,imgModule:()=>wft,initialEnd:()=>a,initialLoad:()=>hf,inlineEmptyNodes:()=>ng,insertAudio:()=>yo,insertColGroupWithSizes:()=>rf,insertCompleted:()=>ii,insertImage:()=>af,insertItemsAtIndex:()=>fk,insertLink:()=>lo,insertVideo:()=>po,isEditableValueEmpty:()=>ett,isIDevice:()=>s,isInSet:()=>ff,keyDown:()=>y,keyUp:()=>tt,linkToolbarAction:()=>fc,listConversionFilters:()=>tst,load:()=>sd,mapCellToMatrixPositions:()=>ytt,markdownFormatTags:()=>ck,markdownKeyConfig:()=>fit,markdownListsTags:()=>ak,markdownSelectionTags:()=>lk,markdownToolbarClick:()=>bh,markerClassName:()=>e,mentionRestrictKeys:()=>oit,modelChanged:()=>k,mouseDown:()=>at,mouseUp:()=>nc,needToWrapLiChild:()=>btt,nestedListCleanUp:()=>vtt,onCodeBlock:()=>gh,onExport:()=>fo,onHandleFontsizeChange:()=>vw,onImport:()=>dh,onResize:()=>ho,openLink:()=>vo,openPrintWindow:()=>gtt,pageYOffset:()=>bb,parseHelper:()=>ott,parseHtml:()=>vr,paste:()=>vu,pasteClean:()=>nl,pasteCleanupGroupingTags:()=>vk,popupHide:()=>bft,preventQuickToolbarClose:()=>ia,quickToolbarClose:()=>bd,quickToolbarOpen:()=>wd,readOnlyMode:()=>ne,redo:()=>fft,refreshBegin:()=>uo,removeClassWithAttr:()=>p,removeSelectionClassStates:()=>ek,renderFileManager:()=>go,renderInlineToolbar:()=>bc,renderQuickToolbar:()=>ko,resetContentEditableElements:()=>uf,resizeInitialized:()=>ll,resizeStart:()=>cu,resizeStop:()=>co,rtlMode:()=>ur,sanitizeHelper:()=>ev,scroll:()=>li,scrollToCursor:()=>hr,selectAll:()=>bf,selectRange:()=>au,selectionChangeMouseUp:()=>yu,selectionChanged:()=>yw,selectionCommand:()=>ah,selectionRestore:()=>lt,selectionSave:()=>ft,selfClosingTags:()=>yk,setAttributes:()=>pp,setEditFrameFocus:()=>wr,setToolbarStatus:()=>uv,showAudioDialog:()=>rs,showColorPicker:()=>ss,showDropDown:()=>hs,showImageDialog:()=>is,showLinkDialog:()=>ts,showTableDialog:()=>fs,showVideoDialog:()=>us,slashMenuOpening:()=>uw,sourceCode:()=>lu,sourceCodeMouseDown:()=>yf,statusCollection:()=>cp,supportedUnits:()=>aw,tableModulekeyUp:()=>kh,tableToolbarAction:()=>gc,tableclass:()=>sf,toObjectLowerCase:()=>fv,toolbarClick:()=>ph,toolbarCreated:()=>hd,toolbarOpen:()=>aft,toolbarRefresh:()=>hi,toolbarRenderComplete:()=>fw,toolbarUpdated:()=>di,unLink:()=>ao,undo:()=>uft,updateDropDownFontFormatLocale:()=>tk,updateDropdownContent:()=>kb,updateProperty:()=>df,updateSource:()=>vf,updateTbItemsStatus:()=>ns,updateTextNode:()=>ltt,updateToolbarItem:()=>lf,updateUndoRedoStatus:()=>bu,updateValueOnIdle:()=>na,updatedToolbarStatus:()=>cd,videoDelete:()=>lc,videoSize:()=>yc,videoToolbarAction:()=>uc,windowResize:()=>dr,wrapTextAndInlineNodes:()=>ok,xhtmlValidation:()=>ie});yh=n(864);const t=ejdashboard.base;var o,ift="create",rft="destroy",sf="tableclass",sd="load",hf="initial-load",cf="content-changed",a="initial-end",ut="iframe-click",u="destroy",ph="toolbarClick",hi="toolbar-refresh",uw="slash-menu-opening",uo="refresh-begin",di="toolbar-updated",b="bind-on-end",wh="html-toolbar-click",bh="markdown-toolbar-click",k="model-changed",kh="tableModulekeyUp",tt="keyUp",y="keyDown",dh="onImport",fo="onExport",gh="onCodeBlock",nc="mouseUp",hd="toolbarCreated",fw="toolbarRenderComplete",eo="enableFullScreen",oo="disableFullScreen",ci="dropDownSelect",tc="beforeDropDownItemRender",so="execCommandCallBack",ic="image-toolbar-action",rc="audio-toolbar-action",uc="video-toolbar-action",fc="link-toolbar-action",dr="resize",cu="resizeStart",ho="resizing",co="resizeStop",uft="undo",fft="redo",lo="insertLink",ao="unLink",ec="editLink",vo="openLink",l="actionBegin",ct="actionComplete",cd="updatedToolbarStatus",eft="actionSuccess",lf="updateToolbarItem",af="insertImage",yo="insertAudio",po="insertVideo",ii="insertCompleted",oft="justifyLeft",sft="justifyRight",hft="justifyCenter",cft="break",lft="inline",oc="insertImgLink",sc="imgAltText",hc="delete",cc="delete",lc="delete",ac="caption",vc="imageSize",yc="videoSize",lu="sourceCode",vf="updateSource",aft="toolbarOpen",pc="beforeDropDownOpen",ft="selection-save",lt="selection-restore",vft="expandPopupClick",wc="count",yft="contentFocus",pft="contentBlur",at="mouseDown",yf="sourceCodeMouseDown",vt="editAreaClick",li="scroll",ai="contentscroll",pf="colorPickerChanged",wf="focusChange",bf="selectAll",au="selectRange",kf="getSelectedHtml",bc="renderInlineToolbar",vu="paste-content",wo="code-block-paste-content",kc="code-block-enter",wft="imageModule",ur="rtl-mode",dc="createTable",df="updateProperty",gr="docClick",gc="table-toolbar-action",gf="checkUndoStack",ne="readOnlyMode",nl="pasteClean",tl="enterHandler",ld="beforeDialogOpen",fr="clearDialogObj",ad="dialogOpen",vd="beforeDialogClose",yd="dialogClose",pd="beforeQuickToolbarOpen",wd="quickToolbarOpen",bd="quickToolbarClose",bft="popupHide",kd="imageSelected",il="imageUploading",rl="imageUploadSuccess",ul="imageUploadFailed",ew="imageRemoving",ow="fileSelected",fl="fileUploading",el="fileUploadSuccess",ol="fileUploadFailed",sw="fileRemoving",sl="afterImageDelete",bo="afterMediaDelete",te="drop",ko="renderQuickToolbar",ie="xhtmlValidation",hl="beforeImageUpload",cl="beforeFileUpload",ll="resizeInitialized",go="renderFileManager",dd="beforeImageDrop",hw="beforeMediaDrop",er="dynamicModule",cw="beforePasteCleanup",lw="afterPasteCleanup",ns="updateTbItemsStatus",ts="showLinkDialog",al="closeLinkDialog",is="showImageDialog",rs="showAudioDialog",us="showVideoDialog",vl="closeImageDialog",yl="closeAudioDialog",pl="closeVideoDialog",fs="showTableDialog",wl="closeTableDialog",w="bindCssClass",bl="formatPainterClick",kl="formatPainterDoubleClick",es="emojiPicker",re="destroyTooltip",os="hidePopup",dl="cleanupResizeElements",gl="afterKeyDown",na="updateValueOnIdle",nu="documentClickClosedBy",ss="showColorPicker",hs="showDropDown",cs="closeTooltip",ta="autoResize",yu="selectionChangeMouseUp",gd="address:empty, article:empty, aside:empty, blockquote:empty,\n details:empty, dd:empty, div:empty, dl:empty, dt:empty, fieldset:empty, footer:empty,form:empty, h1:empty,\n h2:empty, h3:empty, h4:empty, h5:empty, h6:empty, header:empty, hgroup:empty, li:empty, main:empty, nav:empty,\n noscript:empty, output:empty, p:empty, pre:empty, section:empty, td:empty, th:empty",ng="a:empty, abbr:empty, acronym:empty, b:empty, bdi:empty, bdo:empty, big:empty, button:empty,\ncanvas:empty, cite:empty, code:empty, data:empty, datalist:empty, del:empty, dfn:empty, em:empty, font:empty, i:empty, iframe:empty,\nins:empty, kbd:empty, label:empty, map:empty, mark:empty, meter:empty, noscript:empty, object:empty, output:empty, picture:empty, progress:empty,\nq:empty, ruby:empty, s:empty, samp:empty, script:empty, select:empty, slot:empty, small:empty, span:empty, strong:empty, strike:empty, sub:empty, sup:empty, svg:empty,\ntemplate:empty, textarea:empty, time:empty, u:empty, tt:empty, var:empty, wbr:empty",aw=["px","em","rem","pt","cm","mm","in","pc","vw","vh","vmin","vmax"],tg={px:{px:1,em:.0625,rem:.0625,pt:.75,cm:.0264583,mm:.0026458,"in":.0104167,pc:.0625,vw:.00625,vh:.00625,vmin:.00625,vmax:.00625},em:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,"in":.166667,pc:.0625,vw:1,vh:1,vmin:1,vmax:1},rem:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,"in":.166667,pc:.0625,vw:1,vh:1,vmin:1,vmax:1},pt:{px:1.33333,em:.0833333,rem:.0833333,pt:1,cm:.0352778,mm:.0035278,"in":.0138889,pc:.0416667,vw:.00416667,vh:.00416667,vmin:.00416667,vmax:.00416667},cm:{px:37.7953,em:2.3622,rem:2.3622,pt:28.3465,cm:1,mm:.1,"in":.393701,pc:.148148,vw:.0377953,vh:.0377953,vmin:.0377953,vmax:.0377953},mm:{px:3.77953,em:.23622,rem:.23622,pt:2.83465,cm:10,mm:1,"in":.0393701,pc:.0148148,vw:.00377953,vh:.00377953,vmin:.00377953,vmax:.00377953},"in":{px:96,em:6,rem:6,pt:72,cm:2.54,mm:25.4,"in":1,pc:.375,vw:.09375,vh:.09375,vmin:.09375,vmax:.09375},pc:{px:16,em:1,rem:1,pt:12,cm:.423333,mm:.0423333,"in":.166667,pc:1,vw:.0625,vh:.0625,vmin:.0625,vmax:.0625},vw:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,"in":1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vh:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,"in":1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vmin:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,"in":1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1},vmax:{px:160,em:10,rem:10,pt:120,cm:4.23333,mm:.423333,"in":1.66667,pc:.625,vw:1,vh:1,vmin:1,vmax:1}},vw="onHandleFontsizeChange",ia="preventQuickToolbarClose",yw="selectionChanged",ls="e-richtexteditor",tu="e-rtl",kft="e-content",ra="e-disabled",pw="rte-iframe-script-sheet",ww="rte-iframe-style-sheet",ig="e-rte-container",bw="e-rte-iframe-content",ue="e-rte-toolbar",kw="e-rte-tb-fixed",as="e-rte-tb-float",ua="e-rte-inline",dft="e-rte-tb-inline",dw="e-rte-tb-expand",fe="e-rte-full-screen",vs="e-rte-quick-toolbar",rg="e-text-quicktoolbar",ug="e-image-quicktoolbar",fg="e-audio-quicktoolbar",eg="e-video-quicktoolbar",og="e-table-quicktoolbar",sg="e-link-quicktoolbar",hg="e-tb-static",gw="e-rte-quick-popup",cg="e-rte-inline-popup",nb="e-rte-tip-pointer",iu="e-quick-dropdown",ee="e-rte-inline-toolbar",lg="e-rte-inline-dropdown",ni="e-rte-dropdown-popup",fa="e-rte-dropdown-icons",vi="e-rte-dropdown-items",yt="e-rte-dropdown-btn",gft="e-rte-content",or="e-toolbar-item",net="e-toolbar-extended",ea="e-toolbar-wrapper",tet="e-popup",iet="e-separator",ret="e-minimize",uet="e-maximize",fet="e-back",tb="e-show",pu="e-hide",ib="e-visible",oa="e-focused",eet="e-remove-white-space",rb="e-imgright",ub="e-imgleft",fb="e-imgcenter",ri="e-imgbreak",ys="e-audio-break",cr="e-clickelem",oe="e-video-clickelem",sr="e-audio-wrap",ru="e-video-wrap",ps="e-video-break",ui="e-img-caption",ag="e-rte-img-caption",se="e-caption-inline",gi="e-imginline",he="e-audio-inline",ce="e-video-inline",eb="e-rte-character-count",sa="e-warning",ha="e-error",ws="e-icons",uu="e-active",ca="e-expand-open",pt="e-rte-elements",oet="e-tbar-btn",vg="e-rte-dropdown-menu",yg="e-rte-horizontal-separator",ob="e-tbar-ios-fixed",set="e-rte-list-primary-content",het="e-rte-numberformatlist-dropdown",cet="e-rte-bulletformatlist-dropdown",pg="e-rte-codeblock-dropdown",wg="e-rte-code-block-icon e-preformat-code",bg="e-formats-tbar-btn",kg="e-font-name-tbar-btn",dg="e-font-size-tbar-btn",gg="e-alignment-tbar-btn",nn="e-border-style-btn",tn="e-rte-border-colorpicker",rn="e-rte-table-bg-colorpicker",un="e-rte-font-colorpicker",fn="e-rte-background-colorpicker",en="e-rte-numberformatlist-dropdown",on="e-rte-bulletformatlist-dropdown",lr="e-rte-dropdown",sn="e-rte-square-palette",le="e-rte-readonly",sb="e-rte-hidden",hn="e-rte-keepformat",cn="e-rte-removeformat",ln="e-rte-plainformat",an="e-rte-pasteok",vn="e-rte-pastecancel",yn="e-rte-dialog-minheight",pn="e-resize-handle",wn="e-south-east",bs="e-rte-image",hb="e-rte-upload-popup",wu="e-popup-open",cb="e-popup-close",bn="e-img-resize",kn="e-vid-resize",la="e-droparea",lb="e-img-inner",dn="e-upload-files",ab="e-rte-dialog-upload",vb="e-rte-resize",gn="e-custom-tile",ntt="e-nocolor-item",aet="e-rte-table",vet="e-rte-table-border",yb="e-rte-fixed-tb-expand",pb="e-rte-toolbar-enabled",ttt="e-south-west",fu="e-rte-srctextarea",itt="e-image-upload-popup",rtt="e-video-upload-popup",utt="e-audio-upload-popup";!function(n){n[n.Toolbar=0]="Toolbar";n[n.Content=1]="Content";n[n.Popup=2]="Popup";n[n.LinkToolbar=3]="LinkToolbar";n[n.TextToolbar=4]="TextToolbar";n[n.ImageToolbar=5]="ImageToolbar";n[n.AudioToolbar=6]="AudioToolbar";n[n.VideoToolbar=7]="VideoToolbar";n[n.InlineToolbar=8]="InlineToolbar";n[n.TableToolbar=9]="TableToolbar"}(o||(o={}));var yet={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccfe","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080fe","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000065","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},pet={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},aa=[{cssClass:"e-default",text:"Default",command:"Font",subCommand:"FontName",value:""},{cssClass:"e-segoe-ui",text:"Segoe UI",command:"Font",subCommand:"FontName",value:"Segoe UI"},{cssClass:"e-arial",text:"Arial",command:"Font",subCommand:"FontName",value:"Arial,Helvetica,sans-serif"},{cssClass:"e-georgia",text:"Georgia",command:"Font",subCommand:"FontName",value:"Georgia,serif"},{cssClass:"e-impact",text:"Impact",command:"Font",subCommand:"FontName",value:"Impact,Charcoal,sans-serif"},{cssClass:"e-tahoma",text:"Tahoma",command:"Font",subCommand:"FontName",value:"Tahoma,Geneva,sans-serif"},{cssClass:"e-times-new-roman",text:"Times New Roman",command:"Font",subCommand:"FontName",value:"Times New Roman,Times,serif"},{cssClass:"e-verdana",text:"Verdana",command:"Font",subCommand:"FontName",value:"Verdana,Geneva,sans-serif"}],wet=[{text:"Default",value:""},{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],va=[{cssClass:"e-paragraph",text:"Paragraph",command:"Formats",subCommand:"P",value:"P"},{cssClass:"e-h1",text:"Heading 1",command:"Formats",subCommand:"H1",value:"H1"},{cssClass:"e-h2",text:"Heading 2",command:"Formats",subCommand:"H2",value:"H2"},{cssClass:"e-h3",text:"Heading 3",command:"Formats",subCommand:"H3",value:"H3"},{cssClass:"e-h4",text:"Heading 4",command:"Formats",subCommand:"H4",value:"H4"},{cssClass:"e-code",text:"preformatted",command:"Formats",subCommand:"Pre",value:"Pre"}],bet=["Bold","Italic","Underline","|","Formats","Alignments","Blockquote","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],ya=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}],pa=[{text:"None",command:"Lists",subCommand:"NumberFormatList",value:"none"},{text:"Number",command:"Lists",subCommand:"NumberFormatList",value:"decimal"},{text:"Lower Greek",command:"Lists",subCommand:"NumberFormatList",value:"lowerGreek"},{text:"Lower Roman",command:"Lists",subCommand:"NumberFormatList",value:"lowerRoman"},{text:"Upper Alpha",command:"Lists",subCommand:"NumberFormatList",value:"upperAlpha"},{text:"Lower Alpha",command:"Lists",subCommand:"NumberFormatList",value:"lowerAlpha"},{text:"Upper Roman",command:"Lists",subCommand:"NumberFormatList",value:"upperRoman"}],wa=[{text:"None",command:"Lists",subCommand:"BulletFormatList",value:"none"},{text:"Disc",command:"Lists",subCommand:"BulletFormatList",value:"disc"},{text:"Circle",command:"Lists",subCommand:"BulletFormatList",value:"circle"},{text:"Square",command:"Lists",subCommand:"BulletFormatList",value:"square"}],ket=[{language:"plaintext",label:"Plain text"},{language:"c",label:"C"},{language:"csharp",label:"C#"},{language:"cpp",label:"C++"},{language:"css",label:"CSS"},{language:"diff",label:"Diff"},{language:"html",label:"HTML"},{language:"java",label:"Java"},{language:"javascript",label:"JavaScript"},{language:"php",label:"PHP"},{language:"python",label:"Python"},{language:"ruby",label:"Ruby"},{language:"sql",label:"SQL"},{language:"typescript",label:"TypeScript"},{language:"xml",label:"XML"}],det=[{name:"Smilies & People",code:"1F600",iconCss:"e-emoji",icons:[{code:"1F600",desc:"Grinning face"},{code:"1F603",desc:"Grinning face with big eyes"},{code:"1F604",desc:"Grinning face with smiling eyes"},{code:"1F606",desc:"Grinning squinting face"},{code:"1F605",desc:"Grinning face with sweat"},{code:"1F602",desc:"Face with tears of joy"},{code:"1F923",desc:"Rolling on the floor laughing"},{code:"1F60A",desc:"Smiling face with smiling eyes"},{code:"1F607",desc:"Smiling face with halo"},{code:"1F642",desc:"Slightly smiling face"},{code:"1F643",desc:"Upside-down face"},{code:"1F60D",desc:"Smiling face with heart-eyes"},{code:"1F618",desc:"Face blowing a kiss"},{code:"1F61B",desc:"Face with tongue"},{code:"1F61C",desc:"Winking face with tongue"},{code:"1F604",desc:"Grinning face with smiling eyes"},{code:"1F469",desc:"Woman"},{code:"1F468",desc:"Man"},{code:"1F467",desc:"Girl"},{code:"1F466",desc:"Boy"},{code:"1F476",desc:"Baby"},{code:"1F475",desc:"Old woman"},{code:"1F474",desc:"Old man"},{code:"1F46E",desc:"Police officer"},{code:"1F477",desc:"Construction worker"},{code:"1F482",desc:"Guard"},{code:"1F575",desc:"Detective"},{code:"1F9D1",desc:"Cook"}]},{name:"Animals & Nature",code:"1F435",iconCss:"e-animals",icons:[{code:"1F436",desc:"Dog face"},{code:"1F431",desc:"Cat face"},{code:"1F42D",desc:"Mouse face"},{code:"1F439",desc:"Hamster face"},{code:"1F430",desc:"Rabbit face"},{code:"1F98A",desc:"Fox face"},{code:"1F43B",desc:"Bear face"},{code:"1F43C",desc:"Panda face"},{code:"1F428",desc:"Koala"},{code:"1F42F",desc:"Tiger face"},{code:"1F981",desc:"Lion face"},{code:"1F42E",desc:"Cow face"},{code:"1F437",desc:"Pig face"},{code:"1F43D",desc:"Pig nose"},{code:"1F438",desc:"Frog face"},{code:"1F435",desc:"Monkey face"},{code:"1F649",desc:"Hear-no-evil monkey"},{code:"1F64A",desc:"Speak-no-evil monkey"},{code:"1F412",desc:"Monkey"},{code:"1F414",desc:"Chicken"},{code:"1F427",desc:"Penguin"},{code:"1F426",desc:"Bird"},{code:"1F424",desc:"Baby chick"},{code:"1F986",desc:"Duck"},{code:"1F985",desc:"Eagle"}]},{name:"Food & Drink",code:"1F347",iconCss:"e-food-and-drinks",icons:[{code:"1F34E",desc:"Red apple"},{code:"1F34C",desc:"Banana"},{code:"1F347",desc:"Grapes"},{code:"1F353",desc:"Strawberry"},{code:"1F35E",desc:"Bread"},{code:"1F950",desc:"Croissant"},{code:"1F955",desc:"Carrot"},{code:"1F354",desc:"Hamburger"},{code:"1F355",desc:"Pizza"},{code:"1F32D",desc:"Hot dog"},{code:"1F35F",desc:"French fries"},{code:"1F37F",desc:"Popcorn"},{code:"1F366",desc:"Soft ice cream"},{code:"1F367",desc:"Shaved ice"},{code:"1F36A",desc:"Cookie"},{code:"1F382",desc:"Birthday cake"},{code:"1F370",desc:"Shortcake"},{code:"1F36B",desc:"Chocolate bar"},{code:"1F369",desc:"Donut"},{code:"1F36E",desc:"Custard"},{code:"1F36D",desc:"Lollipop"},{code:"1F36C",desc:"Candy"},{code:"1F377",desc:"Wine glass"},{code:"1F37A",desc:"Beer mug"},{code:"1F37E",desc:"Bottle with popping cork"}]},{name:"Activities",code:"1F383",iconCss:"e-activities",icons:[{code:"26BD",desc:"Soccer ball"},{code:"1F3C0",desc:"Basketball"},{code:"1F3C8",desc:"American football"},{code:"26BE",desc:"Baseball"},{code:"1F3BE",desc:"Tennis"},{code:"1F3D0",desc:"Volleyball"},{code:"1F3C9",desc:"Rugby football"},{code:"1F3B1",desc:"Pool 8 ball"},{code:"1F3D3",desc:"Ping pong"},{code:"1F3F8",desc:"Badminton"},{code:"1F94A",desc:"Boxing glove"},{code:"1F3CA",desc:"Swimmer"},{code:"1F3CB",desc:"Weightlifter"},{code:"1F6B4",desc:"Bicyclist"},{code:"1F6F9",desc:"Skateboard"},{code:"1F3AE",desc:"Video game"},{code:"1F579",desc:"Joystick"},{code:"1F3CF",desc:"Cricket"},{code:"1F3C7",desc:"Horse racing"},{code:"1F3AF",desc:"Direct hit"},{code:"1F3D1",desc:"Field hockey"},{code:"1F3B0",desc:"Slot machine"},{code:"1F3B3",desc:"Bowling"},{code:"1F3B2",desc:"Game die"},{code:"265F",desc:"Chess pawn"}]},{name:"Travel & Places",code:"1F30D",iconCss:"e-travel-and-places",icons:[{code:"2708",desc:"Airplane"},{code:"1F697",desc:"Automobile"},{code:"1F695",desc:"Taxi"},{code:"1F6B2",desc:"Bicycle"},{code:"1F68C",desc:"Bus"},{code:"1F682",desc:"Locomotive"},{code:"1F6F3",desc:"Passenger ship"},{code:"1F680",desc:"Rocket"},{code:"1F681",desc:"Helicopter"},{code:"1F6A2",desc:"Ship"},{code:"1F3DF",desc:"Stadium"},{code:"1F54C",desc:"Mosque"},{code:"26EA",desc:"Church"},{code:"1F6D5",desc:"Hindu Temple"},{code:"1F3D4",desc:"Snow-capped mountain"},{code:"1F3EB",desc:"School"},{code:"1F30B",desc:"Volcano"},{code:"1F3D6",desc:"Beach with umbrella"},{code:"1F3DD",desc:"Desert island"},{code:"1F3DE",desc:"National park"},{code:"1F3F0",desc:"Castle"},{code:"1F5FC",desc:"Tokyo tower"},{code:"1F5FD",desc:"Statue of liberty"},{code:"26E9",desc:"Shinto shrine"},{code:"1F3EF",desc:"Japanese castle"},{code:"1F3A2",desc:"Roller coaster"}]},{name:"Objects",code:"1F507",iconCss:"e-objects",icons:[{code:"1F4A1",desc:"Light bulb"},{code:"1F526",desc:"Flashlight"},{code:"1F4BB",desc:"Laptop computer"},{code:"1F5A5",desc:"Desktop computer"},{code:"1F5A8",desc:"Printer"},{code:"1F4F7",desc:"Camera"},{code:"1F4F8",desc:"Camera with flash"},{code:"1F4FD",desc:"Film projector"},{code:"1F3A5",desc:"Movie camera"},{code:"1F4FA",desc:"Television"},{code:"1F4FB",desc:"Radio"},{code:"1F50B",desc:"Battery"},{code:"231A",desc:"Watch"},{code:"1F4F1",desc:"Mobile phone"},{code:"260E",desc:"Telephone"},{code:"1F4BE",desc:"Floppy disk"},{code:"1F4BF",desc:"Optical disk"},{code:"1F4C0",desc:"Digital versatile disc"},{code:"1F4BD",desc:"Computer disk"},{code:"1F3A7",desc:"Headphone"},{code:"1F3A4",desc:"Microphone"},{code:"1F3B6",desc:"Multiple musical notes"},{code:"1F4DA",desc:"Books"}]},{name:"Symbols",code:"1F3E7",iconCss:"e-symbols",icons:[{code:"274C",desc:"Cross mark"},{code:"2714",desc:"Check mark"},{code:"26A0",desc:"Warning sign"},{code:"1F6AB",desc:"Prohibited"},{code:"2139",desc:"Information"},{code:"267B",desc:"Recycling symbol"},{code:"1F6AD",desc:"No smoking"},{code:"1F4F5",desc:"No mobile phones"},{code:"1F6AF",desc:"No littering"},{code:"1F6B3",desc:"No bicycles"},{code:"1F6B7",desc:"No pedestrians"},{code:"2795",desc:"Plus"},{code:"2796",desc:"Minus"},{code:"2797",desc:"Divide"},{code:"2716",desc:"Multiplication"},{code:"1F4B2",desc:"Dollar banknote"},{code:"1F4AC",desc:"Speech balloon"},{code:"2755",desc:"White exclamation mark"},{code:"2754",desc:"White question mark"},{code:"2764",desc:"Heart"}]}],wb=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","audiolayoutoption","videolayoutoption","videoalign","tablerows","tablecolumns","tablecell","tablecellhorizontalalign","tablecellverticalalign","styles","numberformatlist","bulletformatlist","codeblock","borderstyle","bordercolor","tablebackgroundcolor"],ae={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-rte-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},importword:{id:"ImportWord",icon:"e-rte-import-doc",tooltip:"Import from Word",command:"Import",subCommand:"ImportWord"},exportword:{id:"ExportWord",icon:"e-rte-export-doc",tooltip:"Export to Word",command:"Export",subCommand:"ExportWord"},exportpdf:{id:"ExportPdf",icon:"e-rte-export-pdf",tooltip:"Export to PDF",command:"Export",subCommand:"ExportPdf"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},numberformatlist:{id:"NumberFormatList",icon:"e-order-list",tooltip:"Number Format List",command:"NumberFormatList",subCommand:"NumberFormatList"},bulletformatlist:{id:"BulletFormatList",icon:"e-unorder-list",tooltip:"Bullet Format List",command:"BulletFormatList",subCommand:"BulletFormatList"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},audio:{id:"Audio",icon:"e-audio",tooltip:"Insert Audio",command:"Audios",subCommand:"Audio"},video:{id:"Video",icon:"e-video",tooltip:"Insert Video",command:"Videos",subCommand:"Video"},filemanager:{id:"FileManager",icon:"e-rte-file-manager",tooltip:"File Manager",command:"Files",subCommand:"File"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},audioreplace:{id:"AudioReplace",icon:"e-audio-replace",tooltip:"Audio Replace",command:"Audios",subCommand:"AudioReplace"},audioremove:{id:"AudioRemove",icon:"e-audio-remove",tooltip:"Audio Remove",command:"Audios",subCommand:"AudioRemove"},audiolayoutoption:{id:"AudioLayoutOption",icon:"e-audio-display",tooltip:"Audio LayoutOption",command:"Audios",subCommand:"AudioLayoutOption"},videoreplace:{id:"VideoReplace",icon:"e-video-replace",tooltip:"Video Replace",command:"Videos",subCommand:"VideoReplace"},videoalign:{id:"VideoAlign",icon:"e-video-align",tooltip:"Video Align",command:"Videos",subCommand:"VideoAlign"},videoremove:{id:"VideoRemove",icon:"e-video-remove",tooltip:"Video Remove",command:"Videos",subCommand:"VideoRemove"},videolayoutoption:{id:"VideoLayoutOption",icon:"e-video-display",tooltip:"Video LayoutOption",command:"Videos",subCommand:"VideoLayoutOption"},videodimension:{id:"VideoDimension",icon:"e-video-dimension",tooltip:"Video Dimension",command:"Videos",subCommand:"VideoDimension"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-img-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Code View (Ctrl+Shift+H)",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview (Ctrl+Shift+H)",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-preformat-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},blockquote:{id:"Blockquote",icon:"e-blockquote",tooltip:"Blockquote",command:"Formats",subCommand:"blockquote"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecell:{id:"TableCell",icon:"e-table-cell",tooltip:"Table Cell",command:"Table",subCommand:"TableCell"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"},formatpainter:{id:"FormatPainter",icon:"e-rte-format-painter",tooltip:"Format Painter",command:"FormatPainter",subCommand:"FormatPainter"},emojipicker:{id:"EmojiPicker",icon:"e-emoji",tooltip:"Emoji Icon",command:"EmojiPicker",subCommand:"EmojiPicker"},inlinecode:{id:"inlineCode",icon:"e-inline-code",tooltip:"inlineCode",command:"Style",subCommand:"InlineCode"},codeblock:{id:"codeBlock",icon:"e-rte-code-block",tooltip:"Insert Code Block",command:"CodeBlock",subCommand:"CodeBlock"},horizontalline:{id:"HorizontalLine",icon:"e-horizontal-line",tooltip:"Horizontal Line",command:"InsertHTML",subCommand:"HorizontalLine"},borderwidth:{id:"BorderWidth",tooltip:"Border Width",command:"Table",subCommand:"BorderWidth",value:"1px"},borderstyle:{id:"BorderStyle",tooltip:"Border Style",command:"Table",subCommand:"BorderStyle",value:"solid"},bordercolor:{id:"BorderColor",tooltip:"Border Color",command:"Table",subCommand:"BorderColor",value:"#0000000A"},tablebackgroundcolor:{id:"TableBackgroundColor",tooltip:"Table Background Color",command:"Table",subCommand:"TableBackgroundColor",value:"#0000000A"},checklist:{id:"checklist",icon:"e-checklist",tooltip:"Checklist",command:"Checklist",subCommand:"Checklist"}},ks=[{text:"None",command:"BorderStyle",subCommand:"None"},{text:"Solid",command:"BorderStyle",subCommand:"Solid"},{text:"Dashed",command:"BorderStyle",subCommand:"Dashed"},{text:"Dotted",command:"BorderStyle",subCommand:"Dotted"},{text:"Double",command:"BorderStyle",subCommand:"Double"},{text:"Groove",command:"BorderStyle",subCommand:"Groove"},{text:"Ridge",command:"BorderStyle",subCommand:"Ridge"},{text:"Inset",command:"BorderStyle",subCommand:"Inset"},{text:"Outset",command:"BorderStyle",subCommand:"Outset"},{text:"Hidden",command:"BorderStyle",subCommand:"Hidden"}],get=[{locale:"borderStyleNone",value:"None"},{locale:"borderStyleSolid",value:"Solid"},{locale:"borderStyleDashed",value:"Dashed"},{locale:"borderStyleDotted",value:"Dotted"},{locale:"borderStyleDouble",value:"Double"},{locale:"borderStyleGroove",value:"Groove"},{locale:"borderStyleRidge",value:"Ridge"},{locale:"borderStyleInset",value:"Inset"},{locale:"borderStyleOutset",value:"Outset"},{locale:"borderStyleHidden",value:"Hidden"}],not=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],ds=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],tot=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],iot=[{iconCss:"e-icons e-justify-left",command:"Videos",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Videos",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Videos",subCommand:"JustifyRight"}],rot=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],uot=[{locale:"audioLayoutOptionDropDownInline",value:"Inline"},{locale:"audioLayoutOptionDropDownBreak",value:"Break"}],fot=[{locale:"videoLayoutOptionDropDownInline",value:"Inline"},{locale:"videoLayoutOptionDropDownBreak",value:"Break"}],ba=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],ka=[{text:"Inline",cssClass:"e-audio-inline",command:"Audios",subCommand:"Inline"},{text:"Break",cssClass:"e-audio-break",command:"Audios",subCommand:"Break"}],da=[{text:"Inline",cssClass:"e-video-inline",command:"Videos",subCommand:"Inline"},{text:"Break",cssClass:"e-video-break",command:"Videos",subCommand:"Break"}],eot=[{iconCss:"e-icons e-cell-merge",text:"Merge cells",command:"Table",subCommand:"Merge"},{iconCss:"e-icons e-cell-horizontal-split",text:"Horizontal split",command:"Table",subCommand:"HorizontalSplit"},{iconCss:"e-icons e-cell-vertical-split",text:"Vertical split",command:"Table",subCommand:"VerticalSplit"}],oot=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],ga=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],sot=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],nv=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],hot=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],tv=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],cot=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}];var ftt={CreateLink:"Ctrl+K",Image:"Ctrl+Shift+I",CreateTable:"Ctrl+Shift+E",Undo:"Ctrl+Z",Redo:"Ctrl+Y",Copy:"Ctrl+C",Cut:"Ctrl+X",Paste:"Ctrl+V",Bold:"Ctrl+B",Italic:"Ctrl+I",Underline:"Ctrl+U",StrikeThrough:"Ctrl+Shift+S",UpperCase:"Ctrl+Shift+U",LowerCase:"Ctrl+Shift+L",SuperScript:"Ctrl+Shift+=",SubScript:"Ctrl+=",SourceCode:"Ctrl+Shift+H",Maximize:"Ctrl+Shift+F",Minimize:"Esc",ClearFormat:"Ctrl+Shift+R",OL:"Ctrl+Shift+O",UL:"Ctrl+Alt+O",NumberFormatList:"Ctrl+Shift+O",BulletFormatList:"Ctrl+Alt+O",Audio:"Ctrl+Shift+A",Video:"Ctrl+Alt+V",Indent:"Ctrl+]",Outdent:"Ctrl+[","Decrease Fontsize":"Ctrl+Shift+<","Increase Fontsize":"Ctrl+Shift+>",JustifyCenter:"Ctrl+E",JustifyFull:"Ctrl+J",JustifyLeft:"Ctrl+L",JustifyRight:"Ctrl+R",FormatPainter:"Alt+Shift+C, Alt+Shift+V",InlineCode:"Ctrl+`",CodeBlock:"Ctrl+Shift+B",Checklist:"Ctrl+Shift+9"},lot={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",importWord:"Import from Word",exportWord:"Export to Word",exportPdf:"Export to PDF",horizontalLine:"Horizontal Line",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Link",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",audio:"Insert Audio",video:"Insert Video",replace:"Replace",numberFormatList:"Number Format List",bulletFormatList:"Bullet Format List",audioReplace:"Replace",videoReplace:"Replace",videoAlign:"Align",videoDimension:"Dimension",audioRemove:"Remove",videoRemove:"Remove",audioLayoutOption:"Layout option",videoLayoutOption:"Layout option",align:"Align",caption:"Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",blockquote:"Blockquote",linkText:"Display text",linkTooltipLabel:"Title",linkWebUrl:"Web address",linkTitle:"Enter a title",linkurl:"https://example.com",linkOpenInNewWindow:"Open link in new window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",audioHeader:"Insert Audio",videoHeader:"Insert Video",imageLinkHeader:"You can also provide a link from the web",audioLinkHeader:"You can also provide a link from the web",videoLinkHeader:"Web URL",embedVideoLinkHeader:"Media Embed URL",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",audioUploadMessage:"Drop an audio file or browse to upload",videoUploadMessage:"Drop a video file or browse to upload",imageDeviceUploadMessage:"Click here to upload",audioDeviceUploadMessage:"Click here to upload",videoDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"https://example.com/image.png",audioUrl:"https://example.com/audio.mp3",videoUrl:"https://example.com/video.mp4",webUrl:"Web URL",embedUrl:"Embed Code",imageCaption:"Caption",imageSizeHeader:"Image Size",videoSizeHeader:"Video Size",imageHeight:"Height",imageWidth:"Width",videoHeight:"Height",videoWidth:"Width",textPlaceholder:"Enter text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",borderWidth:"Width",borderColor:"Color",borderLabel:"Border",tableBackgroundColor:"Background Color",borderStyle:"Style",borderWidthTooltip:"Border width",borderColorTooltip:"Border color",borderStyleTooltip:"Border style",borderStyleNone:"None",borderStyleSolid:"Solid",borderStyleDashed:"Dashed",borderStyleDotted:"Dotted",borderStyleDouble:"Double",borderStyleGroove:"Groove",borderStyleRidge:"Ridge",borderStyleInset:"Inset",borderStyleOutset:"Outset",borderStyleHidden:"Hidden",rows:"Number of rows",tableRows:"Row",tableColumns:"Column",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Vertical Align",insertTableRowTitle:"Enter a whole number from 1 to 100",insertTableColumnTitle:"Enter a whole number from 1 to 50",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Header Row",tableRemove:"Delete Table",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",editAudioHeader:"Edit Audio",editVideoHeader:"Edit Video",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",audioLayoutOptionDropDownInline:"Inline",audioLayoutOptionDropDownBreak:"Break",videoLayoutOptionDropDownInline:"Inline",videoLayoutOptionDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel",fileManager:"File Manager",fileDialogHeader:"File Browser",formatsDropDownParagraph:"Paragraph",formatsDropDownCode:"Preformatted",formatsDropDownQuotation:"Blockquote",formatsDropDownHeading1:"Heading 1",formatsDropDownHeading2:"Heading 2",formatsDropDownHeading3:"Heading 3",formatsDropDownHeading4:"Heading 4",fontNameSegoeUI:"Segoe UI",fontNameArial:"Arial",fontNameGeorgia:"Georgia",fontNameImpact:"Impact",fontNameTahoma:"Tahoma",fontNameTimesNewRoman:"Times New Roman",fontNameVerdana:"Verdana",numberFormatListNumber:"Number",numberFormatListLowerAlpha:"Lower Alpha",numberFormatListUpperAlpha:"Upper Alpha",numberFormatListLowerRoman:"Lower Roman",numberFormatListUpperRoman:"Upper Roman",numberFormatListLowerGreek:"Lower Greek",bulletFormatListDisc:"Disc",bulletFormatListCircle:"Circle",bulletFormatListSquare:"Square",numberFormatListNone:"None",bulletFormatListNone:"None",formatPainter:"Format Painter",emojiPicker:"Emoji Picker",embeddedCode:"Embedded code",pasteEmbeddedCodeHere:"Paste embedded code here",emojiPickerTypeToFind:"Type to find",emojiPickerNoResultFound:"No results found",emojiPickerTrySomethingElse:"Try something else",linkAriaLabel:"Open in new window",imageLinkAriaLabel:"Open in new window",unsupportedImage:"Unsupported file format",mergecells:"Merge cells",verticalsplit:"Vertical split",horizontalsplit:"Horizontal split",inlinecode:"Inline Code",slashMenuItemHeadingOneText:"Heading 1",slashMenuItemHeadingOneDescription:"Use this for a top level heading or title.",slashMenuItemHeadingTwoText:"Heading 2",slashMenuItemHeadingTwoDescription:"Use this for key sections.",slashMenuItemHeadingThreeText:"Heading 3",slashMenuItemHeadingThreeDescription:"Use this for sub sections and group headings.",slashMenuItemHeadingFourText:"Heading 4",slashMenuItemHeadingFourDescription:"Use this for the key points of the sub topics.",slashMenuItemParagraphText:"Paragraph",slashMenuItemParagraphDescription:"Writing with paragraphs.",slashMenuItemBlockquoteText:"Blockquote",slashMenuItemBlockquoteDescription:"Create a quote or citation.",slashMenuItemOrderedListText:"Ordered List",slashMenuItemOrderedListDescription:"Create an ordered list.",slashMenuItemUnorderedListText:"Unordered List",slashMenuItemUnorderedListDescription:"Create an unordered list.",slashMenuItemCodeText:"CodeBlock",slashMenuItemCodeDescription:"Create a preformatted code block.",slashMenuItemTableText:"Table",slashMenuItemTableDescription:"Insert a table.",slashMenuItemLinkText:"Link",slashMenuItemLinkDescription:"Insert a link.",slashMenuItemImageText:"Image",slashMenuItemImageDescription:"Insert an image.",slashMenuItemAudioText:"Audio",slashMenuItemAudioDescription:"Insert an audio.",slashMenuItemVideoText:"Video",slashMenuItemVideoDescription:"Insert a video.",slashMenuItemEmojiText:"Emojipicker",slashMenuItemEmojiDescription:"Use emojis to express ideas and emoticons.",codeBlock:"Insert Code Block",checklist:"Checklist"},aot={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",importword:"importWord",exportword:"exportWord",exportpdf:"exportPdf",horizontalline:"horizontalLine",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",numberformatlist:"numberFormatList",bulletformatlist:"bulletFormatList",undo:"undo",redo:"redo",filemanager:"fileManager",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",audio:"audio",video:"video",replace:"replace",audioreplace:"audioReplace",videoreplace:"videoReplace",videoalign:"videoAlign",videodimension:"videoDimension",audioremove:"audioRemove",videoremove:"videoRemove",audiolayoutoption:"audioLayoutOption",videolayoutoption:"videoLayoutOption",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"imageAlternateText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",blockquote:"blockquote",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow",formatpainter:"formatPainter",emojipicker:"emojiPicker",embeddedCode:"Embedded code",pasteEmbeddedCodeHere:"Paste embedded code here",emojiPickerTypeToFind:"Type to find",emojiPickerNoResultFound:"No results found",emojiPickerTrySomethingElse:"Try something else",inlinecode:"inlinecode",codeblock:"codeBlock",checklist:"checklist"},vot=[{locale:"fontNameSegoeUI",value:"Segoe UI"},{locale:"fontNameArial",value:"Arial,Helvetica,sans-serif"},{locale:"fontNameGeorgia",value:"Georgia,serif"},{locale:"fontNameImpact",value:"Impact,Charcoal,sans-serif"},{locale:"fontNameTahoma",value:"Tahoma,Geneva,sans-serif"},{locale:"fontNameTimesNewRoman",value:"Times New Roman,Times,serif"},{locale:"fontNameVerdana",value:"Verdana,Geneva,sans-serif"}],yot=[{locale:"formatsDropDownParagraph",value:"P"},{locale:"formatsDropDownCode",value:"Pre"},{locale:"formatsDropDownHeading1",value:"H1"},{locale:"formatsDropDownHeading2",value:"H2"},{locale:"formatsDropDownHeading3",value:"H3"},{locale:"formatsDropDownHeading4",value:"H4"}],pot=[{locale:"numberFormatListNone",value:"none"},{locale:"numberFormatListNumber",value:"decimal"},{locale:"numberFormatListLowerAlpha",value:"lowerAlpha"},{locale:"numberFormatListUpperAlpha",value:"upperAlpha"},{locale:"numberFormatListLowerRoman",value:"lowerRoman"},{locale:"numberFormatListUpperRoman",value:"upperRoman"},{locale:"numberFormatListLowerGreek",value:"lowerGreek"}],wot=[{locale:"bulletFormatListNone",value:"none"},{locale:"bulletFormatListDisc",value:"disc"},{locale:"bulletFormatListCircle",value:"circle"},{locale:"bulletFormatListSquare",value:"square"}],bot=new Map([["Heading 1",{text:"slashMenuItemHeadingOneText",description:"slashMenuItemHeadingOneDescription"}],["Heading 2",{text:"slashMenuItemHeadingTwoText",description:"slashMenuItemHeadingTwoDescription"}],["Heading 3",{text:"slashMenuItemHeadingThreeText",description:"slashMenuItemHeadingThreeDescription"}],["Heading 4",{text:"slashMenuItemHeadingFourText",description:"slashMenuItemHeadingFourDescription"}],["Paragraph",{text:"slashMenuItemParagraphText",description:"slashMenuItemParagraphDescription"}],["Blockquote",{text:"slashMenuItemBlockquoteText",description:"slashMenuItemBlockquoteDescription"}],["OrderedList",{text:"slashMenuItemOrderedListText",description:"slashMenuItemOrderedListDescription"}],["UnorderedList",{text:"slashMenuItemUnorderedListText",description:"slashMenuItemUnorderedListDescription"}],["CodeBlock",{text:"slashMenuItemCodeText",description:"slashMenuItemCodeDescription"}],["Table",{text:"slashMenuItemTableText",description:"slashMenuItemTableDescription"}],["Link",{text:"slashMenuItemLinkText",description:"slashMenuItemLinkDescription"}],["Image",{text:"slashMenuItemImageText",description:"slashMenuItemImageDescription"}],["Audio",{text:"slashMenuItemAudioText",description:"slashMenuItemAudioDescription"}],["Video",{text:"slashMenuItemVideoText",description:"slashMenuItemVideoDescription"}],["Emojipicker",{text:"slashMenuItemEmojiText",description:"slashMenuItemEmojiDescription"}]]),kot=["Undo","Redo"],dot=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];var we="keydown",ku="action",du="format-type",c="keydown-handler",ov="list-type",sv="code-block",ei="keyup-handler",yr="keyup",pr="model_changed_plugin",gu="model_changed",hv="ms_word_cleanup_plugin",cv="ms_word_cleanup",lv="onBegin",av="actionBegin",vv="format_painter_actions",stt="blockquote_list_handled",yv="emoji_picker_actions",ik="mouseDown",rk="destroy",f="internal_destroy",pv="codeblock_indentation",wv="codeblock_disabletoolbar",bv="e-rte-table-resize",htt="e-tb-row-insert",ctt="e-tb-col-insert",nf="e-dashed-border",tf="e-alternate-border",th="e-column-resize",ih="e-row-resize",be="e-table-box",rh="e-img-focus",nt="e-cell-select",kv="e-cell-select-end",dv="e-multi-cells-select",oi="e-audio-focus",dt="e-video-focus",ke="e-rte-drag-image",gv="e-resize",uh="hideTableQuickToolbar",yi=function(){function n(){}return n.prototype.getFormattedNode=function(n,t,i){var r=this.getFormatParent(n,t,i);return null!==r&&r!==i?r:null},n.prototype.getFormatParent=function(n,t,i){do n=n.parentNode;while(n&&n!==i&&!this.isFormattedNode(n,t));return n},n.prototype.isFormattedNode=function(t,i){switch(i){case"bold":return n.isBold(t);case"italic":return n.isItalic(t);case"underline":return n.isUnderline(t);case"strikethrough":return n.isStrikethrough(t);case"superscript":return n.isSuperscript(t);case"subscript":return n.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);case"inlinecode":return n.isCode(t);default:return!1}},n.isBold=function(n){return-1!==["strong","b"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"bold"!==n.style.fontWeight)},n.isItalic=function(n){return-1!==["em","i"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"italic"!==n.style.fontStyle)},n.isUnderline=function(n){return-1!==["u"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"underline"!==n.style.textDecoration&&"underline"!==n.style.textDecorationLine)},n.isStrikethrough=function(n){return-1!==["del","strike","s"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"line-through"!==n.style.textDecoration&&"line-through"!==n.style.textDecorationLine)},n.isSuperscript=function(n){return-1!==["sup"].indexOf(n.nodeName.toLowerCase())},n.isSubscript=function(n){return-1!==["sub"].indexOf(n.nodeName.toLowerCase())},n.prototype.isFontColor=function(t){var i=t.style&&t.style.color;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isBackgroundColor=function(t){var i=t.style&&t.style.backgroundColor;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontSize=function(t){var i=t.style&&t.style.fontSize;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontName=function(t){var i=t.style&&t.style.fontFamily;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.isCode=function(n){return!(-1===["code"].indexOf(n.nodeName.toLowerCase())||n.parentElement&&"PRE"===n.parentElement.nodeName&&n.parentElement.hasAttribute("data-language"))},n.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","font","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var","del"],n}();iy=function(){function n(n){this.parent=n}return n.prototype.renderPanel=function(){var n=this.parent,i=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),r=gs(n.value,n);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true","aria-label":"Rich Text Editor",role:"textbox",lang:n.locale.slice(0,2),dir:n.enableRtl?"rtl":"ltr"}});t.isNullOrUndefined(this.parent.fontFamily.default)||(this.editableElement.style.fontFamily=this.parent.fontFamily.default);t.isNullOrUndefined(this.parent.fontSize.default)||(this.editableElement.style.fontSize=this.parent.fontSize.default);this.editableElement.innerHTML=r;i.appendChild(this.editableElement);this.setPanel(i);n.rootContainer.appendChild(i)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){var n=this.getEditPanel().innerText;return"\n"===n?"":n},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}();sk=function(){function n(n,t){this.parent=n;this.locator=t;this.renderer=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.render=function(){this.parent;this.contentRenderer=this.renderer.getRenderer(o.Content);this.contentRenderer.renderPanel()},n.prototype.refresh=function(n){void 0===n&&(n={requestType:"refresh"});this.parent.notify(n.requestType+"-begin",n)},n.prototype.destroy=function(){t.isNullOrUndefined(this.parent)||(this.removeEventListener(),this.locator.destroy(),this.renderer.destroy())},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(k,this.refresh,this),this.parent.on(tt,this.keyUp,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(k,this.refresh),this.parent.off(tt,this.keyUp))},n.prototype.keyUp=function(n){var t,i,r;if("HTML"===this.parent.editorMode)switch(n.args.which){case 46:case 8:t=this.parent.contentModule.getEditPanel().childNodes;(0===t.length||1===t.length&&0===t[0].childNodes.length&&("BR"===t[0].tagName||("P"===t[0].tagName||"DIV"===t[0].tagName)&&""===t[0].textContent))&&(i=this.parent.contentModule.getEditPanel(),i.innerHTML="DIV"===this.parent.enterKey?"<div><br/><\/div>":"BR"===this.parent.enterKey?"<br/>":"<p><br/><\/p>",r="BR"===this.parent.enterKey?i.childNodes[0].parentElement:i.childNodes[0],this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),r,0))}},n}();const nit=ejdashboard.navigations,tit=ejdashboard.splitbuttons,wi=ejdashboard.popups,ot=ejdashboard.inputs;var d,wt,ge,ry,no="INSERT-IMAGE",uy="INSERT-AUDIO",fy="INSERT-VIDEO",ey="INSERT-TABLE",eh="INSERT-LINK",oy="INSERT-ROW",sy="INSERT-COLUMN",hy="DELETE-ROW",cy="DELETE-COLUMN",ly="REMOVE-TABLE",ay="TABLE-HEADER",vy="TABLE_VERTICAL_ALIGN",yy="TABLE_MERGE",py="TABLE_VERTICAL_SPLIT",wy="TABLE_HORIZONTAL_SPLIT",by="TABLE_STYLES",ky="TABLE_BACKGROUND_COLOR",hk="TABLE_MOVE",dy="alignment-type",gy="indent-type",gt="p",bt=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","body"],ir=["td","th"],to=["table","tbody","td","tfoot","th","thead","tr"],np="selection-type",tp="inserthtml-type",ip="insert-text-type",rp="clear-type",iit=["area","base","br","embed","hr","img","input","param","source","track","wbr","iframe","td","table"],up=["word","excel","onenote"],rit=["article","aside","blockquote","body","canvas","details","div","fieldset","figure","footer","form","header","li","main","nav","noscript","section"],ck={h6:"###### ",h5:"##### ",h4:"#### ",h3:"### ",h2:"## ",h1:"# ",blockquote:"> ",pre:"```\n",p:""},lk={Bold:"**",Italic:"*",StrikeThrough:"~~",InlineCode:"`",SubScript:"<sub>",SuperScript:"<sup>",UpperCase:"A-Z",LowerCase:"a-z"},ak={OL:"1. ",UL:"- "},uit={"toolbar-focus":"alt+f10",escape:"escape",backspace:"backspace","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-audio":"ctrl+shift+a","insert-video":"ctrl+alt+v","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"space",enter:"enter",tab:"tab","shift-tab":"shift+tab","delete":"delete","format-copy":"alt+shift+c","format-paste":"alt+shift+v",inlinecode:"ctrl+`","code-block":"ctrl+shift+b",checklist:"ctrl+shift+9"},fit={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=","full-screen":"ctrl+shift+f","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o"},vk={b:["strong"],strong:["b"],i:["emp","cite"],emp:["i","cite"],cite:["i","emp"]},tst={first:"MsoListParagraphCxSpFirst",middle:"MsoListParagraphCxSpMiddle",last:"MsoListParagraphCxSpLast"},yk=["BR","IMG"],eit={topLeft:[-1,-1],topRight:[1,-1],botRight:[1,1],botLeft:[-1,1]},oit=["ArrowUp","ArrowDown","Enter","Tab","Escape"],sit=["Enter","ArrowRight","ArrowLeft"],hit=function(){function n(n,t){this.BLOCK_TAGS=["p","h1","h2","h3","h4","h5","h6","blockquote","li","pre","td","th","div","hr","section","figure"];this.BASIC_FORMATS=["p","h1","h2","h3","h4","h5","h6","blockquote","pre"];this.root=n;this.currentDocument=t}return n.prototype.getBlockNodes=function(){var i=[],n,r;if(t.isNullOrUndefined(this.root.querySelector(".e-cell-select"))||(n=this.root.querySelector(".e-cell-select").closest("table").querySelectorAll(".e-cell-select"),t.isNullOrUndefined(n)||n.length<2))return i;for(r=0;r<n.length;r++)this.addBlockNodes(n[r],i);return this.wrapParagraphNodes(i),i},n.prototype.addBlockNodes=function(n,t){var u=n.childNodes,r,i;if(0!==u.length)for(r=0;r<u.length;r++)i=u[r],t.indexOf(i.parentElement)>=0||(!i.parentElement||"TD"!==i.parentElement.nodeName&&"TH"!==i.parentElement.nodeName||1!==i.parentElement.childNodes.length||"BR"===i.nodeName||(i.nodeType,Node.TEXT_NODE),t.push(i.parentElement));else t.push(n)},n.prototype.getTextNodes=function(){var r=[],n,i;if(t.isNullOrUndefined(this.root.querySelector(".e-cell-select"))||(n=this.root.querySelector(".e-cell-select").closest("table").querySelectorAll(".e-cell-select"),t.isNullOrUndefined(n)||n.length<2))return r;for(i=0;i<n.length;i++)this.addTextNodes(n[i],r);return r},n.prototype.addTextNodes=function(n,t){var i=n.childNodes,r,f,u;if(0===i.length&&("TD"===n.nodeName||"TH"===n.nodeName))return r=this.currentDocument.createTextNode("​"),n.appendChild(r),void t.push(r);if(1===i.length&&("TD"===n.nodeName||"TH"===n.nodeName)&&"BR"===i[0].nodeName)return r=this.currentDocument.createTextNode("​"),n.insertBefore(r,i[0]),void t.push(r);for(f=0;f<i.length;f++)u=i[f],u.nodeType===Node.TEXT_NODE?t.push(u):u.nodeType===Node.ELEMENT_NODE&&this.addTextNodes(u,t)},n.prototype.wrapParagraphNodes=function(n){for(var i,h,e,o,c,u,f,s=Array.from(n),r=0;r<s.length;r++)i=s[r],("TD"===i.nodeName||"TH"===i.nodeName)&&(1!==i.childNodes.length||"BR"!==i.childNodes[0].nodeName&&i.childNodes[0].nodeType!==Node.TEXT_NODE?(h=n.indexOf(i),this.wrapInlineNodes(i,n,h)):(e=i.childNodes[0],o=t.createElement("p"),e.parentElement.insertBefore(o,e),o.appendChild(e),c=n.indexOf(i),n[c]=o));for(r=0;r<n.length;r++)u=n[r],"LI"===u.nodeName&&1===u.childNodes.length&&(f=u.childNodes[0],f.nodeType===Node.ELEMENT_NODE&&this.BASIC_FORMATS.indexOf(f.nodeName.toLocaleLowerCase())>=0&&f.textContent===u.textContent&&(n[r]=f))},n.prototype.wrapInlineNodes=function(n,i,r){var u=n.childNodes[0],f=t.createElement("p"),e=[],h,o,l,a,s,c;if(t.isNullOrUndefined(u))return n.appendChild(f),e.push(f),void fk(i,e,r);for(;u;)if("BR"===u.nodeName)u.parentNode.insertBefore(f,u),f.appendChild(u),f.childNodes.length>0&&e.indexOf(f)<0&&e.push(f),u=f.nextSibling,f=t.createElement("p");else if(this.BLOCK_TAGS.indexOf(u.nodeName.toLocaleLowerCase())>=0)if(e.push(u),f.childNodes.length>0)u=(f=u).nextSibling;else{if(u&&"LI"===u.nodeName&&u.querySelectorAll("li").length>0)for(h=u.querySelectorAll("li"),o=0;o<h.length;o++)e.push(h[o]);u="LI"===u.nodeName&&t.isNullOrUndefined(u.nextSibling)?u.parentElement.nextSibling:u.nextSibling}else if(u.nodeType===Node.TEXT_NODE){if(""===u.textContent.trim()&&u.textContent.indexOf("​")<0){l=u.nextSibling;t.detach(u);u=l;continue}u.parentNode.insertBefore(f,u);a=u;f.appendChild(a);f.childNodes.length>0&&e.indexOf(f)<0&&e.push(f);u=f.nextSibling}else if("TABLE"===u.nodeName||"UL"===u.nodeName||"OL"===u.nodeName)if("TABLE"===u.nodeName){for(s=[],c=u.querySelectorAll("td, th"),o=0;o<c.length;o++)this.addBlockNodes(c[o],s);for(this.wrapParagraphNodes(s),o=0;o<s.length;o++)e.push(s[o]);u=u.nextSibling}else u=u.firstElementChild;else this.BLOCK_TAGS.indexOf(u.nodeName.toLocaleLowerCase())<0&&(u.parentNode.insertBefore(f,u),f.appendChild(u),f.childNodes.length>0&&e.indexOf(f)<0&&e.push(f),u=f.nextSibling);fk(i,e,r)},n}(),e={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"},oh=function(){function n(n,t){this.parent=n;this.nodeSelection=new st(n);this.currentDocument=t;this.tableSelection=new hit(n,t)}return n.prototype.contents=function(n){return n&&"IFRAME"!==n.tagName?Array.prototype.slice.call(n.childNodes||[]):[]},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&bt.indexOf(n.tagName.toLowerCase())>=0},n.prototype.isLink=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&"a"===n.tagName.toLowerCase()},n.prototype.blockParentNode=function(n){for(;n&&n.parentNode!==this.parent&&(!n.parentNode||!this.hasClass(n.parentNode,"e-node-inner"));null)if(n=n.parentNode,this.isBlockNode(n))return n;return n},n.prototype.rawAttributes=function(n){var u={},i=n.attributes,t,r;if(i.length>0)for(t=0;t<i.length;t++)r=i[t],u[r.nodeName]=r.value;return u},n.prototype.attributes=function(n){var i,t;if(!n)return"";for(var u="",f=this.rawAttributes(n),e=Object.keys(f).sort(),r=0;r<e.length;r++)i=e[r],t=f[""+i],u+=t.indexOf("'")<0&&t.indexOf('"')>=0?" "+i+"='"+t+"'":t.indexOf('"')>=0&&t.indexOf("'")>=0?" "+i+'="'+(t=t.replace(/"/g,"&quot;"))+'"':" "+i+'="'+t+'"';return u},n.prototype.clearAttributes=function(n){for(var r,i=n.attributes,t=i.length-1;t>=0;t--)r=i[t],n.removeAttribute(r.nodeName)},n.prototype.openTagString=function(n){return"<"+n.tagName.toLowerCase()+this.attributes(n)+">"},n.prototype.closeTagString=function(n){return"<\/"+n.tagName.toLowerCase()+">"},n.prototype.createTagString=function(n,t,i){return"<"+n.toLowerCase()+this.attributes(t)+">"+i+"<\/"+n.toLowerCase()+">"},n.prototype.isList=function(n){return!!n&&["UL","OL"].indexOf(n.tagName)>=0},n.prototype.isElement=function(n){return n===this.parent},n.prototype.isEditable=function(n){return(!n.getAttribute||"true"===n.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(n.tagName)<0},n.prototype.hasClass=function(n,t){return n&&n.classList&&n.classList.contains(t)},n.prototype.replaceWith=function(n,i){var r=n.parentNode;null!==r&&r.insertBefore(this.parseHTMLFragment(i),n);t.detach(n)},n.prototype.parseHTMLFragment=function(n){var i=t.createElement("template");return i.innerHTML=n,i.content instanceof DocumentFragment?i.content:document.createRange().createContextualFragment(n)},n.prototype.wrap=function(n,t){return n.parentNode.insertBefore(t,n),(t=n.previousSibling).appendChild(n),t},n.prototype.insertAfter=function(n,t){t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.wrapInner=function(n,t){for(n.appendChild(t),(t=n.querySelector(".e-rte-wrap-inner")).classList.remove("e-rte-wrap-inner"),0===t.classList.length&&t.removeAttribute("class");n.firstChild!==t;)t.appendChild(n.firstChild);return t},n.prototype.unWrap=function(n){var i=n&&n.parentNode,t;if(!i)return[];for(t=[];n.firstChild&&" "!==n.textContent;)t.push(n.firstChild),i.insertBefore(n.firstChild,n);return t=t.length>0?t:[n.parentNode],i.removeChild(n),t},n.prototype.getSelectedNode=function(n,t){return n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t-1]&&n.childNodes[t-1].nodeType===Node.ELEMENT_NODE&&(n.childNodes[t-1].classList.contains(e.startSelection)||n.childNodes[t-1].classList.contains(e.endSelection))?n=n.childNodes[t-1]:n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t]&&(n=n.childNodes[t]),n.nodeType===Node.TEXT_NODE&&(n=n.parentNode),n},n.prototype.nodeFinds=function(n,t){for(var r=[],i=0;i<t.length;i++)n.contains(t[i])&&n!==t[i]&&r.push(t[i]);return r},n.prototype.isEditorArea=function(){for(var n=this.getRangePoint(0).commonAncestorContainer;n&&!this.isElement(n);null)n=n.parentNode;return!!this.isElement(n)},n.prototype.getRangePoint=function(n){var t=this.getSelection(),i=[],r;if(t&&t.getRangeAt&&t.rangeCount)for(i=[],r=0;r<t.rangeCount;r++)i.push(t.getRangeAt(r));else i=[this.currentDocument.createRange()];return void 0!==n?i[n]:i},n.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},n.prototype.getPreviousNode=function(n){for(n=n.previousElementSibling;n&&"\n"===n.textContent;null)n=n.previousElementSibling;return n},n.prototype.encode=function(n){var t=document.createElement("div");return t.innerText=n,t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},n.prototype.saveMarker=function(n){var r,f,i=this.parent.querySelector("."+e.startSelection),t=this.parent.querySelector("."+e.endSelection),u;return this.hasClass(i,e.startSelection)&&i.classList.length>1?(u=this.createTagString(gt,i,this.encode(i.textContent)),this.replaceWith(i,u),(i=this.parent.querySelector("."+e.startSelection)).classList.remove(e.startSelection),r=i.childNodes[0]):r=this.unWrap(i)[0],this.hasClass(t,e.endSelection)&&t.classList.length>1?(u=this.createTagString(gt,t,this.encode(t.textContent)),this.replaceWith(t,u),(t=this.parent.querySelector("."+e.endSelection)).classList.remove(e.endSelection),f=t.childNodes[0]):f=t?this.unWrap(t)[0]:r,n.startContainer=n.getNodeArray(r,!0),n.endContainer=n.getNodeArray(f,!1),n},n.prototype.marker=function(n,t){return'<span class="'+n+'">'+t+"<\/span>"},n.prototype.setMarker=function(n){var r=n.range,o=r.startContainer.childNodes,a=o.length>1&&"TABLE"===o[0].nodeName&&0===r.startOffset,v=o.length>1&&"IMAGE"===o[0].nodeName&&1===r.endOffset&&"#text"===r.endContainer.nodeName&&0===r.endContainer.textContent.length,i=(a?att(o[r.startOffset+1]):o[r.startOffset>0?r.startOffset-1:r.startOffset])||r.startContainer,f=r.endContainer.childNodes[r.endOffset>0?v?r.endOffset:r.endOffset-1:r.endOffset]||r.endContainer,h,l;if(i.nodeType===Node.ELEMENT_NODE&&f.nodeType===Node.ELEMENT_NODE&&(i.contains(f)||f.contains(i))&&(h=i.contains(f)?i:f,h.nodeType!==Node.TEXT_NODE)){for(var c=[],s=[],u=h;h.contains(u);null)c.indexOf(u)<0&&u.childNodes&&u.childNodes.length?(c.push(u),u=u.childNodes[0]):u.nextSibling?u=u.nextSibling:u.parentNode&&(u=u.parentNode,c.push(u)),s.indexOf(u)<0&&(u.nodeType===Node.TEXT_NODE||ir.indexOf(u.parentNode.tagName.toLocaleLowerCase())>=0&&("BR"===u.tagName||"IMG"===u.tagName))&&s.push(u);s.length&&(i=i.contains(f)?s[0]:i,f=s[s.length-1])}i!==f?(i.nodeType!==Node.TEXT_NODE&&("BR"===i.tagName&&ir.indexOf(i.parentNode.tagName.toLocaleLowerCase())>=0||"IMG"===i.tagName)?(this.replaceWith(i,this.marker(e.startSelection,this.encode(i.textContent))),r.startContainer.querySelector("."+e.startSelection).appendChild(i)):3!==i.nodeType&&"#text"!==i.nodeName&&"BR"!==i.nodeName?(l=this.marker(e.startSelection,""),t.append([this.parseHTMLFragment(l)],i)):this.replaceWith(i,this.marker(e.startSelection,this.encode(i.textContent))),f.nodeType!==Node.TEXT_NODE&&"BR"===f.tagName&&ir.indexOf(f.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(f,this.marker(e.endSelection,this.encode(f.textContent))),r.endContainer.querySelector("."+e.endSelection).appendChild(f)):this.ensureSelfClosingTag(f,e.endSelection,r)):this.ensureSelfClosingTag(i,e.startSelection,r)},n.prototype.ensureSelfClosingTag=function(n,i,r){var l=!1,s,h,f,c,u,o,a;if(3===n.nodeType)this.replaceWith(n,this.marker(i,this.encode(n.textContent)));else if("BR"===n.tagName)this.replaceWith(n,this.marker(i,this.encode(n.textContent))),s=r.startContainer.querySelector("."+i),s&&s.parentElement.appendChild(n);else{if(h=t.isNullOrUndefined(n.parentElement)?"":n.parentElement.tagName.toLocaleLowerCase(),"IMG"===n.tagName&&"p"!==h&&"div"!==h&&(f=document.createElement("p"),n.parentElement.insertBefore(f,n),f.appendChild(n),n=f.children[0]),"TABLE"===n.tagName)if(l=!0,""===n.textContent)c=n.querySelectorAll("td"),n=c[c.length-1],n=t.isNullOrUndefined(n.childNodes[0])?n:n.childNodes[0];else{for(u=n.lastChild;3!==u.nodeType&&"#text"!==u.nodeName&&"BR"!==u.nodeName;)u=u.lastChild;n=u}for(o=0;o<yk.length;o++)n=n.tagName!==yk[o]||l?n:n.parentNode;3===n.nodeType&&"#text"===n.nodeName?this.replaceWith(n,this.marker(i,this.encode(n.textContent))):"BR"===n.nodeName?(this.replaceWith(n,this.marker(e.endSelection,this.encode(n.textContent))),r.endContainer.querySelector("."+e.endSelection).appendChild(n)):"HR"!==n.nodeName&&(a=this.marker(i,""),t.append([this.parseHTMLFragment(a)],n))}},n.prototype.createTempNode=function(n){var i=n.textContent,r,o,u,t;if("BR"===n.tagName)r="<"+gt+"><\/"+gt+">",o=n.parentNode,ir.indexOf(o.tagName.toLocaleLowerCase())>=0&&(n=this.wrap(n,this.parseHTMLFragment(r)));else if(n.nodeType!==Node.TEXT_NODE&&(n.classList.contains(e.startSelection)||n.classList.contains(e.endSelection))||i.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||i.length&&i.indexOf("\n")<0&&" "!==i){if(r="<"+gt+"><\/"+gt+">",n.parentNode&&!this.isBlockNode(n.parentNode))for(var h=this.getImmediateBlockNode(n),f=0,s=Array.from(h.childNodes);f<s.length;f++)if(u=s[f],u&&u.contains(n)){n=u;break}t=n;n=this.wrap(n,this.parseHTMLFragment(r));t.nodeType===Node.ELEMENT_NODE&&t.firstChild&&"BR"===t.firstChild.nodeName&&(t.classList.contains(e.startSelection)||t.classList.contains(e.endSelection))||!n.nextElementSibling||"BR"!==n.nextElementSibling.tagName||n.appendChild(n.nextElementSibling)}return n},n.prototype.getImageTagInSelection=function(){var n=this.getSelection();return this.isEditorArea()&&n.rangeCount?n.focusNode.querySelectorAll("img"):null},n.prototype.gatherElementsAround=function(n,i){var u=t.createElement(i),r=n.previousSibling,f=n.parentElement,e,o,s;for("e-editor-select-start"===f.className?f.parentNode.insertBefore(u,f):f&&f.insertBefore(u,n),e=0;null!==r&&"BR"!==r.nodeName&&!this.isBlockNode(r);)o=r.previousSibling,3!==r.nodeType&&1!==r.nodeType||(0===e?u.appendChild(r):u.insertBefore(r,u.firstChild)),r=o,e++;for(u.appendChild(n),r=u.nextSibling?u.nextSibling:u.parentElement.nextSibling;null!==r&&"BR"!==r.nodeName&&!this.isBlockNode(r);)s=r.nextSibling?r.nextSibling:r.parentElement.nextSibling,3!==r.nodeType&&1!==r.nodeType||u.appendChild(r),r=s;return u},n.prototype.convertToBlockNodes=function(n,i){var u,r,e,f,o;if(n.length>1)for(u=0,r=n[0];!t.isNullOrUndefined(r);)"BR"===r.nodeName&&(e=r.nextSibling,t.detach(r),r=e),t.isNullOrUndefined(r)||(n[u]=i?"LI"===r.nodeName||this.isBlockNode(r)?r:this.gatherElementsAround(r,i?"p":"div"):this.isBlockNode(n[u])?n[u]:this.gatherElementsAround(r,i?"p":"div"),f="LI"===n[u].nodeName?n[u].parentElement:n[u],o="#text"===f.nodeName?f.parentElement:f,null!==(r=t.isNullOrUndefined(o.querySelector(".e-editor-select-end"))&&t.isNullOrUndefined(t.closest(r,".e-editor-select-end"))?f.nextSibling:null)||t.isNullOrUndefined(f.nextSibling)||"BR"!==f.nextSibling.nodeName||t.detach(f.nextSibling)),u++;else this.isBlockNode(n[0])||(n[0]=this.gatherElementsAround(n[0],i?"p":"div"),t.isNullOrUndefined(n[0].nextSibling)||"BR"!==n[0].nextSibling.nodeName||(""===n[0].textContent?n[0].appendChild(n[0].nextSibling):t.detach(n[0].nextSibling)));return n},n.prototype.blockNodes=function(n){var i=[],c=this.getSelection(),o=this.tableSelection.getBlockNodes(),u,h;if(o.length>0)return o;if(this.isEditorArea()&&c.rangeCount)for(var s=this.getRangePoint(),l=function(u){var h=void 0,c=s[u],o=r.getSelectedNode(c.startContainer,c.startOffset),l=r.getSelectedNode(c.endContainer,c.endOffset),p,w,v,y,a,f;for(r.isBlockNode(o)&&i.indexOf(o)<0&&i.push(o),h=r.blockParentNode(o),p=r.blockParentNode(l),h&&i.indexOf(h)<0&&(!t.isNullOrUndefined(n)&&n?(w=["TD","TH"],[c.commonAncestorContainer,h,p].some(function(n){return-1!==w.indexOf(n.nodeName)})?(v=r.getPreBlockNodeCollection(c),v.length>1?r.wrapWithBlockNode(v,i):v.length>0&&(o!==l&&"BR"!==o.nodeName||o===l&&"SPAN"===o.nodeName&&(o.classList.contains(e.startSelection)||o.classList.contains(e.endSelection)))&&i.push(r.createTempNode(o))):i.push(h)):ir.indexOf(h.tagName.toLocaleLowerCase())>=0&&("BR"===o.tagName||o.nodeType===Node.TEXT_NODE||o.classList.contains(e.startSelection)||o.classList.contains(e.endSelection))?(y=o.previousSibling&&o.previousSibling.nodeType===Node.TEXT_NODE?o.previousSibling:o,o.nextSibling||o.previousSibling||"BR"!==o.tagName?i.push(r.createTempNode(y)):i.push(y)):i.push(h)),a=[],f=o;f!==l&&f!==r.parent;null)a.indexOf(f)<0&&f.childNodes&&f.childNodes.length?(a.push(f),f=f.childNodes[0]):f&&8!==f.nodeType&&("BR"===f.tagName||f.nodeType===Node.TEXT_NODE&&""!==f.textContent.trim()||f.nodeType!==Node.TEXT_NODE&&(f.classList.contains(e.startSelection)||f.classList.contains(e.endSelection)))&&ir.indexOf(f.parentNode.tagName.toLocaleLowerCase())>=0?f=r.createTempNode(f):f.nextSibling&&8!==f.nextSibling.nodeType&&("BR"===f.nextSibling.tagName||f.nextSibling.nodeType===Node.TEXT_NODE||f.nextSibling.classList.contains(e.startSelection)||f.nextSibling.classList.contains(e.endSelection))&&ir.indexOf(f.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?f=r.createTempNode(f.nextSibling):f.nextSibling?f=f.nextSibling:f.parentNode&&(f=f.parentNode,a.push(f)),i.indexOf(f)<0&&f.nodeType===Node.ELEMENT_NODE&&ir.indexOf(f.parentNode.tagName.toLocaleLowerCase())>=0&&(f.classList.contains(e.startSelection)||f.classList.contains(e.endSelection))&&i.push(r.createTempNode(f)),r.isBlockNode(f)&&r.ignoreTableTag(f)&&a.indexOf(f)<0&&i.indexOf(f)<0&&(f!==l||c.endOffset>0)&&i.push(f),"IMG"===f.nodeName&&"true"===f.parentElement.contentEditable&&i.push(f);(h=r.blockParentNode(l))&&r.ignoreTableTag(h)&&i.indexOf(h)<0&&!t.isNullOrUndefined(h.previousElementSibling)&&"IMG"!==h.previousElementSibling.tagName&&i.push(h)},r=this,f=0;f<s.length;f++)l(f);for(u=i.length-1;u>0;u--)if(this.nodeFinds(i[u],i).length){if(h=i[u].querySelectorAll("ul, ol"),"LI"===i[u].tagName&&h.length>0)continue;i.splice(u,1)}return i},n.prototype.ignoreTableTag=function(n){return!(to.indexOf(n.tagName.toLocaleLowerCase())>=0)},n.prototype.getPreBlockNodeCollection=function(n){var s=this.getSelectedNode(n.startContainer,n.startOffset),l=this.getSelectedNode(n.endContainer,n.endOffset),r=[],u=s.closest("td, th"),i;if(t.isNullOrUndefined(u))return r;for(var h=Array.from(u.childNodes),f=!0,e=this.getClosestInlineParent(s,u,!0),c=this.getClosestInlineParent(l,u,!1),o=0;o<h.length;o++)i=h[o],e===c&&i===e?(r.push(i),f=!0):i===e?f=!1:i===c&&(r.push(i),f=!0),f||r.push(i);return r},n.prototype.getClosestInlineParent=function(n,t,i){var r,f,u;if(n.nodeType===Node.TEXT_NODE||this.isBlockNode(n))return n;for(r=n,f=!1;r;)if(u=r,f){if(this.isBlockNode(r))return u;if(i&&r.previousSibling){if(this.isBlockNode(r.previousSibling)||"BR"===r.previousSibling.nodeName)return u;r=r.previousSibling}else{if(i||!r.nextSibling)return r;if(this.isBlockNode(r.nextSibling)||"BR"===r.nextSibling.nodeName)return u;r=r.nextSibling}}else(r=r.parentElement)===t&&(r=u,f=!0);return null},n.prototype.wrapWithBlockNode=function(n,i){for(var u,r=t.createElement("p"),f=0;f<n.length;f++)if(u=n[f],"BR"===u.nodeName)u.parentNode.insertBefore(r,u),r.appendChild(u),r.childNodes.length>0&&i.push(r),r=t.createElement("p");else{if(this.isBlockNode(u))i.push(u);else{if("#text"===u.nodeName&&""===u.textContent.trim())continue;0===r.childElementCount?(u.parentNode.insertBefore(r,u),r.appendChild(u)):r.appendChild(u)}f===n.length-1&&r.nextElementSibling&&0===r.querySelectorAll("br").length&&"BR"===r.nextElementSibling.nodeName&&r.appendChild(r.nextElementSibling)}r.childNodes.length>0&&i.indexOf(r)<0&&i.push(r)},n.prototype.getImmediateBlockNode=function(n){for(;n&&bt.indexOf(n.nodeName.toLocaleLowerCase())<0;)n=n.parentNode;return n},n}(),h=function(){function n(){}return n.WrapBefore=function(n,t,i){return t.innerText=n.textContent,i?this.AppendBefore(t,n,!0):this.AppendBefore(t,n),n.parentNode&&n.parentNode.removeChild(n),t.childNodes[0]},n.Wrap=function(n,t){return this.AppendBefore(t,n),t.appendChild(n),n},n.unwrap=function(n){var i,s=n.parentNode,r=n.ownerDocument.defaultView.getSelection(),u=null,e=0,f=null,o=0,t;for(r&&r.rangeCount&&(u=(i=r.getRangeAt(0)).startContainer,e=i.startOffset,f=i.endContainer,o=i.endOffset),t=[];n.firstChild;null)t.push(s.insertBefore(n.firstChild,n));return s.removeChild(n),r&&u&&f&&t.length>0&&(u===n&&(u=t[Math.min(e,t.length-1)],e=0),f===n&&(f=t[Math.min(o,t.length-1)],o=0),r.removeAllRanges(),i.setStart(u,e),i.setEnd(f,o),r.addRange(i)),t},n.AppendBefore=function(n,t,i){return t.parentNode?i?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.insertBefore(n,t):t},n}(),su=function(){function n(){this.enterAction="P";this.position=-1;this.nodeSelection=new st}return n.prototype.GetSpliceNode=function(n,t){return t=this.SplitNode(n,t,!0),this.SplitNode(n,t,!1)},n.prototype.SplitNode=function(n,t,i){var r,e;if(t){var f=n.cloneRange(),u=t.parentNode,o=this.nodeSelection.getIndex(t);return f.collapse(i),i?f.setStartBefore(t):f.setEndAfter(t),r=f.extractContents(),i?(t=u.childNodes[o],(r=this.spliceEmptyNode(r,!1))&&r.childNodes.length>0&&(1!==r.childNodes.length||"IMG"===r.childNodes[0].nodeName||r.querySelectorAll("img").length>0||!this.isRteElm(r)||""!==r.textContent.trim()||32===r.textContent.charCodeAt(0)||160===r.textContent.charCodeAt(0))&&(t?h.AppendBefore(r,t):(u.appendChild(r),(e=document.createElement("div")).innerHTML="&#65279;&#65279;",t=e.firstChild,u.appendChild(t)))):(t=u.childNodes.length>1?u.childNodes[o]:u.childNodes[0],(r=this.spliceEmptyNode(r,!0))&&r.childNodes.length>0&&(1!==r.childNodes.length||"IMG"===r.childNodes[0].nodeName||!this.isRteElm(r)||""!==r.textContent.trim()||32===r.textContent.charCodeAt(0)||160===r.textContent.charCodeAt(0)))&&(t?h.AppendBefore(r,t,!0):u.childNodes.length>1&&u.childNodes.length!==o?(t=u.childNodes[u.childNodes.length-1],h.AppendBefore(r,t,!0),t=t.nextSibling):(u.appendChild(r),(e=document.createElement("div")).innerHTML="&#65279;&#65279;",u.insertBefore(e.firstChild,u.firstChild),t=u.firstChild)),t}return null},n.prototype.isRteElm=function(n){var u=!0,i,r;if(1===n.childNodes.length&&"IMG"!==n.childNodes[0].nodeName)for(i=n.childNodes[0],r=0;!t.isNullOrUndefined(i.childNodes)&&r<i.childNodes.length;r++)("IMG"===i.childNodes[r].nodeName||"SPAN"===i.childNodes[r].nodeName&&(i.childNodes[r].classList.contains("e-video-wrap")||i.childNodes[r].classList.contains("e-embed-video-wrap")||i.childNodes[r].classList.contains("e-audio-wrap"))||"TABLE"===i.childNodes[r].nodeName||"HR"===i.childNodes[r].nodeName)&&(u=!1);else u=!0;return u},n.prototype.spliceEmptyNode=function(n,t){var i;return(i=1===n.childNodes.length&&"#text"===n.childNodes[0].nodeName&&""===n.childNodes[0].textContent||""===n.textContent?-1:n.childNodes.length-1)>-1&&!t?this.spliceEmptyNode(n.childNodes[i],t):i>-1?this.spliceEmptyNode(n.childNodes[0],t):3===n.nodeType||11===n.nodeType||"IMG"===n.nodeName||n.querySelectorAll("img").length>0||n.classList.contains("e-video-wrap")||n.classList.contains("e-audio-wrap")||n.parentNode.removeChild(n),n},n.prototype.GetCursorStart=function(n,t,i){for(var u=(n=i?n:n.reverse())[0],r=0;r<n.length&&(i?n[r]<t:n[r]>=t);r++)u=n[r];return u},n.prototype.GetCursorRange=function(n,t,i){var o=n.createRange(),r=[],u,f,e;for(r.push(0),u=this.TrimLineBreak(i.data),f=u.indexOf(" ",0);-1!==f;)r.indexOf(f)<0&&r.push(f),new RegExp("\\s").test(u[f-1])&&r.indexOf(f-1)<0&&r.push(f-1),new RegExp("\\s").test(u[f+1])&&r.push(f+1),f=u.indexOf(" ",f+1);return(r.push(u.length),r.indexOf(t.startOffset)>=0||r.indexOf(t.startOffset-1)>=0&&(1!==t.startOffset||1===t.startOffset&&new RegExp("\\s").test(u[0]))||r[r.length-1]-1===t.startOffset&&t.endOffset!==u.length-1&&!new RegExp("\\s").test(u[0]))?(o=t,this.position=1):(e=this.GetCursorStart(r,t.startOffset,!0),0!==e&&u[e]&&" "===u[e]&&(e+=1),this.position=t.startOffset-e,o.setStart(t.startContainer,e),o.setEnd(t.startContainer,this.GetCursorStart(r,t.startOffset,!1))),o},n.prototype.GetCursorNode=function(n,t,i){return this.GetSpliceNode(this.GetCursorRange(n,t,i),i)},n.prototype.TrimLineBreak=function(n){return n.replace(/(\r\n\t|\n|\r\t)/gm," ")},n}(),kt=function(){function n(){}return n.Insert=function(n,i,r,u,f,e){var o=this.prepareInsertNode(i,u,r),nt=t.isNullOrUndefined(r)?0:r.scrollHeight,c=new st(r),v=new su,s=c.getRange(n),d,g,l,w,b;s=this.adjustSelectionRange(c,n,r,s);var y=this.isCursorAtStartPoint(s),p=s.collapsed,a=this.getNodeCollection(s,c,o),k="table"===o.nodeName.toLowerCase(),h=this.findRelevantParentNode(a,k,s,r);if(h&&"BR"===h.nodeName&&(h=h.parentNode),h&&"LI"===h.nodeName&&k)this.handleTableInListItem(s,o,h,a,c,v,r);else if(d="#text"!==o.nodeName&&!t.isNullOrUndefined(o.children[0])&&!t.isNullOrUndefined(o.children[0].tagName)&&"IMG"===o.children[0].tagName&&1===o.children.length,y&&""===s.startContainer.textContent&&"BR"!==s.startContainer.nodeName&&"BR"!==f&&d&&(s.startContainer.innerHTML=""),g=u||!t.isNullOrUndefined(o)&&!t.isNullOrUndefined(o.classList)&&o.classList.contains("pasteContent"),l=n.querySelectorAll("td.e-cell-select, th.e-cell-select"),l&&l.length>1&&this.clearTargetCells(l),g){if(e&&e.tableObj&&e.tableObj.tablePastingObj&&(w=e.tableObj.tablePastingObj,b=w.getValidTableFromPaste(o),l&&l.length>0&&b))return void w.handleTablePaste(b,l);this.pasteInsertHTML(a,o,s,c,v,n,p,h,r,f)}else this.shouldInsertOutsideRange(r,s,p,h,o)?this.handleContentInsertionOutsideRange(n,r,s,c,v,p,h,o,a,i,y,f):this.handleContentInsertionInsideRange(n,s,c,h,o,y),this.shouldScrollToCursor(r,nt,o)&&hr(n,r)},n.clearTargetCells=function(n){for(var t=0;t<n.length;t++)n[t].innerHTML="<br>"},n.prepareInsertNode=function(n,i,r){if("string"==typeof n)return n=br(n,r),(u=t.createElement("div")).innerHTML=n.replace(/&(times|divide|ne)(;?)/g,"&amp;$1$2"),i?u:u.firstChild;var u,f=!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.classList)&&n.classList.contains("pasteContent");return i&&!f?((u=t.createElement("div")).appendChild(n),u):n},n.adjustSelectionRange=function(n,t,i,r){return r.startContainer===r.endContainer&&0===r.startOffset&&r.startOffset===r.endOffset?(r=this.adjustEmptyEditorSelection(n,t,i,r),r=this.adjustSelectionToFirstTextNode(n,t,i,r),r=this.adjustBrElementSelection(n,t,r)):r},n.adjustEmptyEditorSelection=function(n,t,i,r){return r.startContainer!==i||0!==i.textContent.length||"P"!==i.children[0].tagName&&"DIV"!==i.children[0].tagName&&"BR"!==i.children[0].tagName?r:(n.setSelectionText(t,r.startContainer.children[0],r.startContainer.children[0],0,0),n.getRange(t))},n.adjustSelectionToFirstTextNode=function(n,i,r,u){if(u.startContainer===r&&r.textContent.trim().length>0&&"TABLE"!==r.childNodes[0].tagName){var f=this.findFirstTextNode(u.startContainer);if(!t.isNullOrUndefined(f))return n.setSelectionText(i,f,f,0,0),n.getRange(i)}return u},n.adjustBrElementSelection=function(n,t,i){if("BR"===i.startContainer.nodeName){var r=Array.prototype.slice.call(i.startContainer.parentElement.childNodes).indexOf(i.startContainer);return n.setSelectionText(t,i.startContainer.parentElement,i.startContainer.parentElement,r,r),n.getRange(t)}return i},n.handleTableInListItem=function(n,t,i,r,u,f,e){var o,s,h;0===r.length&&(o=u.processedTableImageCursor(n),("TABLE"===o.startName||"TABLE"===o.endName)&&(s=o.start?o.startNode:o.endNode,r.push(s)));h=this.findClosestRelevantElement(r[r.length-1].parentNode,e);this.insertTableInList(n,t,i,r[0],f,h)},n.isCursorAtStartPoint=function(n){return 0===n.startOffset&&n.startOffset===n.endOffset&&n.startContainer===n.endContainer},n.findRelevantParentNode=function(n,i,r,u){return i?t.isNullOrUndefined(n[0])||t.isNullOrUndefined(n[0].parentNode)?r.startContainer:this.findClosestRelevantElement(n[0].parentNode,u):n[0]},n.shouldInsertOutsideRange=function(n,t,i,r,u){return n!==t.startContainer&&(!i&&!(r.nodeType===Node.ELEMENT_NODE&&-1!==to.indexOf(r.tagName.toLocaleLowerCase()))||"table"===u.nodeName.toLowerCase()&&r&&-1===to.indexOf(r.tagName.toLocaleLowerCase()))},n.handleContentInsertionOutsideRange=function(n,i,r,u,f,e,o,s,h,c,l,a){var y=f.GetSpliceNode(r,o),w=y.previousSibling,p=y.parentNode,v;1===h.length?(u.setSelectionContents(n,y),r=u.getRange(n)):p&&"LI"!==p.nodeName&&(v=f.GetSpliceNode(r,h[h.length-1].parentElement),v=t.isNullOrUndefined(v)?y:v,u.setSelectionText(n,y,v,0,3===v.nodeType?v.textContent.length:v.childNodes.length),r=u.getRange(n));this.extractOrCleanupContent(r,p);"TABLE"===c.tagName&&this.cleanupForTableInsertion(r,i);this.removeOriginalNodes(h);this.insertNodeAtLocation(n,w,p,i,s,y,c,l,r,a);this.removeEmptyElements(i);this.setSelectionAfterInsertion(s,u,n)},n.extractOrCleanupContent=function(n,t){null!==n.startContainer.parentElement.closest("ol,ul")&&null!==n.endContainer.parentElement.closest("ol,ul")?vtt(n,t):n.extractContents()},n.cleanupForTableInsertion=function(n,i){var r=t.closest(n.startContainer,"blockquote"),u,f;if(!t.isNullOrUndefined(r)&&r.childNodes.length>0)for(u=r.childNodes.length-1;u>=0;u--)f=r.childNodes[u],t.isNullOrUndefined(f)||""!==f.innerText.trim()||t.detach(f);this.removeEmptyElements(i,!1,r)},n.removeOriginalNodes=function(n){for(var t=0;t<n.length;t++)if(3!==n[t].nodeType&&null!=n[t].parentNode){if("IMG"===n[t].nodeName)continue;n[t].parentNode.removeChild(n[t])}},n.insertNodeAtLocation=function(n,i,r,u,f,e,o,s,c,l){t.isNullOrUndefined(i)||t.isNullOrUndefined(i.parentNode)?(r=this.findAppropriateParentNode(r,u),this.insertNodeBasedOnContext(r,u,f,o,s,c,e,l)):n.contains(i)?h.AppendBefore(f,i,!0):c.insertNode(f)},n.findAppropriateParentNode=function(n,t){for(var i=null;n!==t&&n.firstChild&&""===n.textContent.trim()&&"LI"!==n.nodeName;)i=n,n=n.parentNode;return null!==i?i:n},n.insertNodeBasedOnContext=function(n,i,r,u,f,e,o,s){if(n.firstChild&&(n!==i||"TABLE"===r.nodeName&&f&&n===e.startContainer&&n===e.endContainer))if(""===n.textContent.trim()&&n!==i&&"LI"===n.nodeName)n.appendChild(r);else if(""===n.textContent.trim()&&n!==i){if(!n.parentNode||n.parentNode!==i||this.isBlockElement(r)||s&&"BR"===s.toUpperCase())h.AppendBefore(r,n,!1);else{var c=s&&"DIV"===s.toUpperCase()?t.createElement("div"):t.createElement("p");c.appendChild(r);h.AppendBefore(c,n,!1)}t.detach(n)}else h.AppendBefore(r,n.firstChild,!1);else t.isNullOrUndefined(o.previousSibling)&&"TABLE"===u.tagName?n.prepend(r):n.appendChild(r)},n.setSelectionAfterInsertion=function(n,t,i){"IMG"===n.nodeName?this.imageFocus(n,t,i):3!==n.nodeType?t.setSelectionText(i,n,n,0,n.childNodes.length):t.setSelectionText(i,n,n,0,n.textContent.length)},n.handleContentInsertionInsideRange=function(n,i,r,u,f,e){var o=t.isNullOrUndefined(u)?null:t.closest(u,"li");this.shouldInsertInTableCell(u,o,e)?(i.extractContents(),o.appendChild(f),this.removeEmptyNextLI(o)):this.insertWithRangeHandling(n,i,f,e);this.setCursorAfterInsertion(n,f,r)},n.shouldInsertInTableCell=function(n,i,r){return!(t.isNullOrUndefined(n)||"TD"!==n.nodeName&&"TH"!==n.nodeName||t.isNullOrUndefined(i)||r)},n.insertWithRangeHandling=function(n,i,r,u){if(i.deleteContents(),u&&""===i.startContainer.textContent&&"BR"!==i.startContainer.nodeName&&(i.startContainer.innerHTML=""),t.Browser.isIE){var f=n.createDocumentFragment();f.appendChild(r);i.insertNode(f)}else this.isHrElement(i)?this.insertAfterHrElement(i,r):this.insertBasedOnStartContainer(i,r)},n.isHrElement=function(n){return 1===n.startContainer.nodeType&&"hr"===n.startContainer.nodeName.toLowerCase()&&"hr"===n.endContainer.nodeName.toLowerCase()},n.insertAfterHrElement=function(n,i){var r=n.startContainer.nextElementSibling;r&&(r.querySelector("br")&&t.detach(r.querySelector("br")),r.appendChild(i))},n.insertBasedOnStartContainer=function(n,t){"BR"===n.startContainer.nodeName?n.startContainer.parentElement.insertBefore(t,n.startContainer):n.insertNode(t)},n.setCursorAfterInsertion=function(n,t,i){3!==t.nodeType&&t.childNodes.length>0?i.setSelectionText(n,t,t,1,1):"IMG"===t.nodeName?this.imageFocus(t,i,n):3!==t.nodeType?i.setSelectionContents(n,t):i.setSelectionText(n,t,t,t.textContent.length,t.textContent.length)},n.shouldScrollToCursor=function(n,i,r){return!t.isNullOrUndefined(n)&&i<n.scrollHeight&&1===r.nodeType&&("IMG"===r.nodeName||!t.isNullOrUndefined(r.querySelector("img")))},n.removeEmptyNextLI=function(n){for(var i=t.closest(n,"ul,ol");i&&i.parentElement&&"LI"===i.parentElement.nodeName;)i=t.closest(i.parentElement,"ul,ol");i&&i.querySelectorAll("li").forEach(function(n){(function(n){return""===n.textContent.trim()&&!n.querySelector("audio,video,img,table,br")})(n)&&t.detach(n)})},n.findFirstTextNode=function(n){var i,r;if(n.nodeType===Node.TEXT_NODE)return n;for(i=0;i<n.childNodes.length;i++)if(r=this.findFirstTextNode(n.childNodes[i]),!t.isNullOrUndefined(r))return r;return null},n.pasteInsertHTML=function(n,t,i,r,u,f,e,o,s,h){var l=this.getImmediateBlockNode(n[n.length-1],s),a,v,c,y,p;l&&0===l.textContent.length&&(a=l.querySelector("br:last-of-type"),a&&a.classList.add("rte-temp-br"));v=i.startOffset===i.endOffset&&i.startContainer===i.endContainer;i=this.adjustRangeForEmptyEditor(n,i,r,f,s,v);c=this.setupRangeForPaste(n,t,i,r,u,f,e,o,s);i=c.range;y=this.containsBlockElements(t)?this.handleBlockNodeContent(n,t,i,u,s,h,e):this.handleInlineContent(n,t,i,r,f,s,v,c.sibNode,c.lasNode,c.isSingleNode);p=this.processSpecialNodes(y,t,h);this.positionCursorAfterPaste(p,t,r,f,s,h);this.alignCheck(s);this.listCleanUp(r,f);this.removeEmptyBrFromParagraph(s)},n.removeEmptyBrFromParagraph=function(n){var t=n.querySelector("br.rte-temp-br");t&&t.remove()},n.adjustRangeForEmptyEditor=function(n,t,i,r,u,f){if(f&&t.startContainer===u&&""===u.textContent&&0===t.startOffset&&0===t.endOffset&&"TABLE"!==u.childNodes[0].tagName){var e=this.getImmediateBlockNode(n[n.length-1],u);return i.setSelectionText(r,e,e,0,0),i.getRange(r)}return t},n.setupRangeForPaste=function(n,i,r,u,f,e,o,s,h){var l,v,c,a=!1,y;return h===r.startContainer||(o||s.nodeType===Node.ELEMENT_NODE&&-1!==to.indexOf(s.tagName.toLocaleLowerCase()))&&("table"!==i.nodeName.toLowerCase()||!s||-1!==to.indexOf(s.tagName.toLocaleLowerCase()))||"HR"===i.firstChild.nodeName||(l=f.GetSpliceNode(r,s),t.isNullOrUndefined(l))||((v=t.isNullOrUndefined(l.previousSibling)?l.parentNode.previousSibling:l.previousSibling,1===n.length)?(u.setSelectionContents(e,l),r=u.getRange(e),a=!0):(y=n[n.length-1].textContent?n[n.length-1].textContent:"",(c=f.GetSpliceNode(r,n[n.length-1].parentElement))&&"LI"===c.nodeName&&c.nextSibling&&"LI"===c.nextSibling.nodeName&&(this.isAnotherLiFromEndLi=y!==c.textContent),c=t.isNullOrUndefined(c)?l:c,u.setSelectionText(e,l,c,0,3===c.nodeType?c.textContent.length:c.childNodes.length),r=u.getRange(e),a=!1)),this.removingComments(i),{preNode:l,sibNode:v,lasNode:c,isSingleNode:a,range:r}},n.containsBlockElements=function(n){for(var i=n.childNodes,t=0;t<i.length;t++)if(bt.indexOf(i[t].nodeName.toLowerCase())>=0)return!0;return!1},n.handleInlineContent=function(n,t,i,r,u,f,e,o,s,h){var c=document.createDocumentFragment();return e?this.handleCursorInlineContent(n,t,i,r,u,f,c):this.handleRegularInlineContent(t,i,c,f,o,s,h)},n.handleRegularInlineContent=function(n,i,r,u,f,e,o){for(var c,s,h;n.firstChild;)c=n.firstChild,r.appendChild(n.firstChild);return o?(i.deleteContents(),this.removeEmptyElements(u,!0),i.insertNode(r)):(s=u===i.startContainer?i.startContainer:i.startContainer.parentNode,h=Array.prototype.indexOf.call(s.childNodes,-1!==t.Browser.userAgent.indexOf("Firefox")&&u===i.startContainer?i.startContainer.firstChild:i.startContainer),i.deleteContents(),-1!==h&&(i.setStart(s,h),i.setEnd(s,h)),t.isNullOrUndefined(e)||e===u||(t.detach(e),this.removeEmptyElements(u,!0)),t.isNullOrUndefined(f)?i.insertNode(r):f.parentNode===u?f.appendChild(r):f.parentNode.appendChild(r)),c},n.handleCursorInlineContent=function(n,i,r,u,f,e,o){var h,c=this.getImmediateBlockNode(r.startContainer,e),s=t.createElement("span",{className:"tempSpan"});for(this.shouldInsertInAnchor(r)?this.insertInAnchor(r,s,e):this.isMentionChip(n)?r.startContainer.parentElement.insertAdjacentElement("afterend",s):0===r.startOffset||0===r.endOffset||r.startOffset!==r.endOffset||i.querySelector("a")||r.endOffset!==r.startContainer.textContent.length?r.insertNode(s):c.appendChild(s);i.firstChild;)h=i.firstChild,o.appendChild(i.firstChild);return this.insertFragmentOrReplaceNode(s,o,r,u,document,h)},n.shouldInsertInAnchor=function(n){var i=t.closest(n.startContainer.parentElement,"a");return 3===n.startContainer.nodeType&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(t.closest(i,"span"))},n.insertInAnchor=function(n,i,r){var u=this.getImmediateBlockNode(n.startContainer,r);u.querySelectorAll("br").length>0&&t.detach(u.querySelector("br"));t.closest(t.closest(n.startContainer.parentElement,"a"),"span").appendChild(i)},n.isMentionChip=function(n){return n[0]&&"#text"===n[0].nodeName&&n[0].nodeValue.includes("​")&&!t.isNullOrUndefined(n[0].parentElement)&&!t.isNullOrUndefined(n[0].parentElement.previousElementSibling)&&n[0].parentElement.previousElementSibling.classList.contains("e-mention-chip")},n.insertFragmentOrReplaceNode=function(n,t,i,r,u,f){var e=this.getClosestMatchingElement(n.parentNode,t);return 1===t.childNodes.length&&t.firstChild&&e?this.replaceWithMatchedContent(n,e,t,i,r,u,f):(n.parentNode.replaceChild(t,n),f)},n.replaceWithMatchedContent=function(n,t,i,r,u,f,e){var s=document.createElement("div"),l=i.firstChild.textContent||"",o,h,c;return s.innerHTML=i.firstChild.innerHTML||"",o=s.firstChild,h=e,o&&(t.replaceChild(o,n),t.parentNode&&o.nodeType===Node.TEXT_NODE&&this.shouldNormalizeTextNodes(o))&&(t.parentNode.normalize(),c=r.startOffset+l.length,u.setCursorPoint(f,t.firstChild,c),h=null),s.remove(),h},n.shouldNormalizeTextNodes=function(n){return n.previousSibling&&n.previousSibling.nodeType===Node.TEXT_NODE||n.nextSibling&&n.nextSibling.nodeType===Node.TEXT_NODE},n.handleBlockNodeContent=function(n,i,r,u,f,e,o){var s=this.findParentPreElement(r,f);return t.isNullOrUndefined(i)||t.isNullOrUndefined(s)||"PRE"!==s.nodeName?this.processBlockContent(n,i,r,u,f,e,o):(r.insertNode(i),i.lastChild)},n.findParentPreElement=function(n,i){for(var r=n.startContainer;!t.isNullOrUndefined(r)&&"PRE"!==r.nodeName&&r!==i;)r=r.parentElement;return r},n.processInlineNodesBetweenBlocks=function(n,i){for(var r,e,u=document.createDocumentFragment(),o=!1,f=null,s=null,h=t.createElement("div",{id:"pasteContent_rte"});n.firstChild;)r=n.firstChild,"#text"!==r.nodeName||""!==r.textContent.trim()?(s=r,e=this.isBlockElement(r),o?e?(f=null,u.appendChild(r)):(f||(f="DIV"===i?t.createElement("div"):t.createElement("p"),u.appendChild(f)),f.appendChild(r)):e?(o=!0,u.appendChild(r)):(h.appendChild(r),u.appendChild(h))):t.detach(r);return{fragment:u,lastNode:s}},n.isBlockElement=function(n){if(n.nodeType!==Node.ELEMENT_NODE)return!1;for(var i=bt,r=n.nodeName.toLowerCase(),t=0;t<i.length;t++)if(i[t]===r)return!0;return!1},n.processBlockContent=function(n,i,r,u,f,e,o){var h,c=this.processInlineNodesBetweenBlocks(i,e),s;return h=this.insertTempNode(r,c.fragment,n,u,f),this.contentsDeleted||this.cleanupBeforeBlockInsertion(r,f,o),s=f.querySelector("#pasteContent_rte"),t.isNullOrUndefined(s)||this.processFirstInlineNodeSet(s,e),h},n.cleanupBeforeBlockInsertion=function(n,t,i){i||0!==n.startContainer.parentElement.textContent.length||"BR"!==n.startContainer.nodeName||"P"!==n.startContainer.parentElement.nodeName||t.removeChild(n.startContainer.parentElement);n.deleteContents();this.removeEmptyElements(t)},n.processFirstInlineNodeSet=function(n,i){for(var r;n.firstChild&&(r=n.firstChild,this.isInlineElement(r));)r=this.handleFirstBlockChild(n,i);return t.detach(n),r},n.handleFirstBlockChild=function(n,i){var u=n.firstChild,r;return t.isNullOrUndefined(n.previousElementSibling)&&(r="DIV"===i?t.createElement("div"):t.createElement("p"),n.parentElement.insertBefore(r,n)),"BR"===n.previousElementSibling.nodeName?n.parentElement.insertBefore(n.firstChild,n):n.previousElementSibling.appendChild(n.firstChild),u},n.isInlineElement=function(n){return"#text"===n.nodeName||this.inlineNode.indexOf(n.nodeName.toLowerCase())>=0},n.processSpecialNodes=function(n,t,i){return n?n instanceof Element&&"GOOGLE-SHEETS-HTML-ORIGIN"===n.nodeName?this.processGoogleSheetsTable(n):"TABLE"===n.nodeName?this.addParagraphAfterTable(n,i):n:null},n.processGoogleSheetsTable=function(n){var r=n.querySelector("table"),f=r.querySelector("colgroup"),t,i,u,e;if(f)for(t=0;t<r.rows.length;t++)for(i=0;i<r.rows[t].cells.length;i++)u=f.querySelectorAll("col")[i],u&&u.hasAttribute("width")&&(e=u.getAttribute("width"),r.rows[t].cells[i].style.width=e+"px");return n},n.addParagraphAfterTable=function(n,i){var r=t.createElement("DIV"===i?"div":"p");return r.appendChild(t.createElement("br")),n.parentElement.insertBefore(r,n.nextSibling),r},n.positionCursorAfterPaste=function(n,i,r,u,f,e){n&&("#text"===n.nodeName?this.placeCursorEnd(n,i,r,u,f):"HR"===n.nodeName?this.handleHRElementCursor(n,r,u,e):f.contains(n)&&t.isNullOrUndefined(f.querySelector(".paste-cursor"))?this.cursorPos(n,i,r,u,f):this.handleListElementCursor(i,f,r,u))},n.handleListElementCursor=function(n,i,r,u){var e=i.querySelector(".paste-cursor"),f,o;t.isNullOrUndefined(e)?(f=i.querySelectorAll(".pasteContent_RTE"),f.length>0&&(o=f[f.length-1],this.cursorPos(o,n,r,u,i))):(r.setCursorPoint(u,e,0),e.remove())},n.handleHRElementCursor=function(n,i,r,u){for(var s,f,e,h,o=n.nextSibling;o&&"#text"===o.nodeName&&""===o.textContent.trim();)o=o.nextSibling;if(s=t.createElement("DIV"===u?"div":"p"),s.appendChild(t.createElement("br")),f=n.parentNode,o&&("HR"===o.nodeName||"TABLE"===o.nodeName))f.insertBefore(s,o),n=s;else if(f&&"LI"===f.nodeName){for(e=n.nextSibling;e&&e.nodeType===Node.TEXT_NODE&&""===e.textContent.trim();)e=e.nextSibling;for(;!e&&f;){if(f&&("OL"===f.nodeName||"UL"===f.nodeName||"LI"===f.nodeName||"BLOCKQUOTE"===f.nodeName))for(e=f.nextSibling;e&&e.nodeType===Node.TEXT_NODE&&""===e.textContent.trim();)e=e.nextSibling;f=f.parentNode}t.isNullOrUndefined(e)&&n.parentNode.appendChild(s);n=e||s}else o?(h=o.firstChild,h&&"#text"!==h.nodeName&&h.hasAttribute("class")&&h.classList.contains("rte-temp-br")&&o.firstChild.removeAttribute("class"),n=o):(f.appendChild(s),f.insertBefore(n,s),n=s);return i.setSelectionText(r,n,n,0,0),n},n.compareParentElements=function(n,t){return!(!n||!t)&&n.tagName===t.tagName&&this.getFilteredAttributes(n)===this.getFilteredAttributes(t)},n.getFilteredAttributes=function(n){return Array.from(n.attributes).map(function(n){if("class"===n.name){var t=n.value.split(" ").filter(function(n){return"pasteContent_RTE"!==n}).join(" ");return t?"class='"+t+"'":""}return n.name+"='"+n.value+"'"}).filter(function(n){return n.length>0}).sort().join(" ")},n.getClosestMatchingElement=function(n,t){for(var i=n;i;){if(this.findMatchingChild(t,i))return i;i=i.parentElement}return null},n.findMatchingChild=function(n,t){for(var r,f,i=0,u=Array.from(n.children);i<u.length;i++){if(r=u[i],this.compareParentElements(r,t))return r;if(f=this.findMatchingChild(r,t),f)return f}return null},n.listCleanUp=function(n,i){var r=n.getRange(i),f=r.startContainer,e=r.startOffset,o=r.startContainer.parentElement,s=r.endContainer.parentElement,u,h,c,l;t.isNullOrUndefined(o)||t.isNullOrUndefined(s)||(u=o.closest("ol, ul"),h=s.closest("ol, ul"),t.isNullOrUndefined(u)||t.isNullOrUndefined(h)||(c=this.cleanUpListItems(u),l=this.cleanUpListContainer(u),(c||l)&&(r.setStart(f,e),r.setEnd(f,e))))},n.cleanUpListItems=function(n){var r,e=this,u=!1,i,f;return(t.isNullOrUndefined(n.closest("ol, ul"))||(r=n.closest("ol, ul").querySelectorAll("li")),t.isNullOrUndefined(r)||0===r.length)?!1:(i=null,r.forEach(function(n){var r=n.parentElement,f,s,h;if(!t.isNullOrUndefined(r)&&"OL"!==r.nodeName&&"UL"!==r.nodeName&&(t.isNullOrUndefined(i)&&(i=r.closest("li")),!t.isNullOrUndefined(i))){if(f=n.nextSibling,!t.isNullOrUndefined(f)&&"LI"!==f.nodeName){for(var c=Array.prototype.indexOf.call(r.childNodes,f),o=r.cloneNode(!1),a=r.childNodes.length,l=c;l<a;l++)o.appendChild(r.childNodes[c]);o.childNodes.length>0?(s=document.createElement("li"),s.appendChild(o),i.insertAdjacentElement("afterend",s)):o.remove()}h=r.closest("ol, ul");i.insertAdjacentElement("afterend",n);i=i.nextSibling;t.isNullOrUndefined(h)||e.removeEmptyElements(h);u=!0}}),f=this.cleanUpFlattenListContainer(n),u=f||u)},n.cleanUpFlattenListContainer=function(n){var i,r=!1;return t.isNullOrUndefined(n.closest("ol, ul"))||(i=n.closest("ol, ul").querySelectorAll("li")),!t.isNullOrUndefined(i)&&0!==i.length&&(i.forEach(function(n){t.isNullOrUndefined(n.firstChild)||"OL"!==n.firstChild.nodeName&&"UL"!==n.firstChild.nodeName||(n.style.listStyleType="none");var i=Array.from(n.children).find(function(n){return"LI"===n.tagName&&n.parentElement&&"OL"!==n.parentElement.tagName&&"UL"!==n.parentElement.tagName});t.isNullOrUndefined(i)||t.isNullOrUndefined(n.parentNode)||(n.parentNode.replaceChild(i,n),(t.isNullOrUndefined(i.textContent)||""===i.textContent.trim())&&i.remove(),r=!0)}),r)},n.cleanUpListContainer=function(n){var r=!1,i=[],u=[];return t.isNullOrUndefined(n)||(n.childNodes.forEach(function(t){"LI"!==t.nodeName.toLocaleUpperCase()&&i.push(t);("LI"===t.nodeName.toLocaleUpperCase()||n.lastChild===t)&&i.length>0&&(u.push({elements:i.slice()}),i=[])}),u.forEach(function(t){var u=t.elements,i=document.createElement("li");u[0].parentNode.replaceChild(i,u[0]);u.forEach(function(n){return i.appendChild(n)});i.textContent&&""===i.textContent.trim()&&!i.querySelector("img")&&n.removeChild(i);r=!0})),r},n.placeCursorEnd=function(n,i,r,u,f){for(;!t.isNullOrUndefined(n)&&"#text"!==n.nodeName&&"IMG"!==n.nodeName&&"BR"!==n.nodeName&&"HR"!==n.nodeName;){if(!t.isNullOrUndefined(n.lastChild)&&"P"===n.lastChild.nodeName&&""===n.lastChild.innerHTML){var e=t.createElement("br");n.lastChild.appendChild(e)}n=n.lastChild}"IMG"===(n=t.isNullOrUndefined(n)?i:n).nodeName?this.imageFocus(n,r,u):r.setSelectionText(u,n,n,n.textContent.length,n.textContent.length);this.removeEmptyElements(f)},n.getNodeCollection=function(n,t,i){var r=[];return n.startOffset===n.endOffset&&n.startContainer===n.endContainer&&"BR"!==n.startContainer.nodeName&&n.startContainer.childNodes.length>0&&("TD"===n.startContainer.nodeName||3!==n.startContainer.nodeType&&i.classList&&i.classList.contains("pasteContent"))?r.push(n.startContainer.childNodes[n.endOffset]):r=t.getInsertNodeCollection(n),r},n.insertTempNode=function(n,t,i,r,u){var f=t.lastChild;return this.shouldInsertAfterTable(n,u)?(this.insertNodeAfterTable(n.startContainer,t,n.endOffset-1),f):this.shouldInsertBeforeTable(n,u)?(this.insertNodeBeforeTable(n.startContainer,t,n.startOffset),f):this.shouldAppendAfterTableAtCursor(n,u)?(n.startContainer.appendChild(t),f):f=this.handleStandardNodeInsertion(n,t,i,r,u)},n.shouldInsertAfterTable=function(n,i){var r=n.startContainer.nodeType===Node.TEXT_NODE?n.startContainer.parentNode:n.startContainer;return(r===i||r.closest("table"))&&!t.isNullOrUndefined(r.childNodes[n.endOffset-1])&&"TABLE"===r.childNodes[n.endOffset-1].nodeName},n.insertNodeAfterTable=function(n,i,r){t.isNullOrUndefined(n.childNodes[r].nextSibling)?n.appendChild(i):n.insertBefore(i,n.childNodes[r].nextSibling)},n.shouldInsertBeforeTable=function(n,i){return n.startContainer===i&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])&&"TABLE"===n.startContainer.childNodes[n.startOffset].nodeName},n.insertNodeBeforeTable=function(n,t,i){i>=0&&i<n.childNodes.length?n.insertBefore(t,n.childNodes[i]):n.appendChild(t)},n.shouldAppendAfterTableAtCursor=function(n,i){return n.startContainer===i&&!t.isNullOrUndefined(n.startContainer.childNodes[n.endOffset])&&"TABLE"===n.startContainer.childNodes[n.endOffset].nodeName},n.handleStandardNodeInsertion=function(n,t,i,r,u){var f=this.findBlockNodeForInsertion(n,i,u),e;return this.processListItemsInNode(f,t,u),e=t.lastChild,this.isTableCellNode(f)?(this.insertInTableCell(n,t,f,r),e):this.isHorizontalRuleInEmptyBlock(e,n)?(n.startContainer.parentNode.replaceChild(t,n.startContainer),e):(this.isMediaElement(f)&&(f=n.startContainer),this.handleRegularInsertion(n,t,f,r,u),e)},n.findBlockNodeForInsertion=function(n,i,r){var u=this.getImmediateBlockNode(i[i.length-1],r);return(t.isNullOrUndefined(u)||t.isNullOrUndefined(u.parentElement))&&3!==n.endContainer.nodeType&&(u=n.endContainer,n.setEnd(u,n.endContainer.textContent.length)),u&&("BODY"===u.nodeName||"DIV"===u.nodeName&&n.startContainer===n.endContainer&&1===n.startContainer.nodeType)&&(u=n.startContainer),u},n.processListItemsInNode=function(n,i,r){if(this.shouldProcessListItems(n,i,r))for(var f,u=i;!t.isNullOrUndefined(u.firstElementChild)&&u.firstElementChild.lastElementChild&&"LI"===u.firstElementChild.lastElementChild.tagName;)f=u.firstElementChild.lastElementChild,this.removeChecklistStyle(n,f),this.removeListItemMargins(f),u.firstElementChild.insertAdjacentElement("afterend",f)},n.removeChecklistStyle=function(n,t){"LI"===n.nodeName&&n.parentElement&&("UL"===n.parentElement.nodeName||"OL"===n.parentElement.nodeName)&&(t.style.removeProperty("list-style"),t.style.removeProperty("position"),""===t.getAttribute("style")&&t.removeAttribute("style"))},n.shouldProcessListItems=function(n,t,i){return n&&"#text"!==n.nodeName&&n.closest("LI")&&i.contains(n.closest("LI"))&&"TD"!==n.nodeName&&"TH"!==n.nodeName&&"TR"!==n.nodeName&&t&&t.firstElementChild&&("OL"===t.firstElementChild.tagName||"UL"===t.firstElementChild.tagName)},n.removeListItemMargins=function(n){n.style.removeProperty("margin-left");n.style.removeProperty("margin-top");n.style.removeProperty("margin-bottom");""===n.getAttribute("style")&&n.removeAttribute("style")},n.isTableCellNode=function(n){if(!n)return!1;var t=n.nodeName;return"TD"===t||"TH"===t||"TR"===t||"TABLE"===t},n.insertInTableCell=function(n,i,r,u){var f=n.startContainer,e;if(("TD"===f.nodeName||"TH"===f.nodeName)&&1===f.childNodes.length&&"BR"===f.firstChild.nodeName)return f.replaceChild(i,f.firstChild),void(this.contentsDeleted=!0);for(;!t.isNullOrUndefined(f)&&f.parentElement!==r;)f=f.parentElement;n.deleteContents();e=u.GetSpliceNode(n,f);e?e.parentNode.replaceChild(i,e):n.insertNode(i);this.contentsDeleted=!0},n.handleRegularInsertion=function(n,t,i,r,u){var f,s=new st(u),o=this.getNodeCollection(n,s,t),e=o[o.length-1];if(this.isEmptySpecialNode(e)){if(f=e,this.handleEmptySpecialNodeInsertion(n,t,e))return}else if(this.isTextOrBrInListItem(e,i,u)){if(f=e,this.handleTextInListItem(n,t,e,i,r,u))return}else f=this.getSplitElementForInsertion(n,r,i);f&&f.nodeType===Node.ELEMENT_NODE&&""===n.toString()&&null!==f.querySelector("img, video, audio")?f.parentNode.insertBefore(t,f):f.parentNode.replaceChild(t,f)},n.isEmptySpecialNode=function(n){return!!n&&("BR"===n.nodeName||"HR"===n.nodeName||"#text"===n.nodeName&&!t.isNullOrUndefined(n.parentElement)&&"LI"===n.parentElement.nodeName)&&!t.isNullOrUndefined(n.parentElement)&&0===n.parentElement.textContent.trim().length},n.handleEmptySpecialNodeInsertion=function(n,i,r){if("LI"!==r.parentElement.nodeName||t.isNullOrUndefined(r.nextSibling)||"BR"!==r.nextSibling.nodeName||t.detach(r.nextSibling),("LI"===r.parentElement.nodeName||r.parentElement.closest("li"))&&""===r.parentElement.textContent){this.removeListfromPaste(n);1===r.parentElement.childNodes.length&&"BR"===r.nodeName&&t.detach(r);var f=Array.from(i.childNodes).filter(function(n){return!("LI"===n.nodeName||"UL"===n.nodeName||"OL"===n.nodeName)}),u=this.extractChildNodes(i);return f.length>0&&u.length>1?this.insertBlockNodesInLI(u,n):n.insertNode(i),this.contentsDeleted=!0,!0}return!1},n.extractChildNodes=function(n){for(var i=[],t=0;t<n.childNodes.length;t++)i.push(n.childNodes.item(t));return i},n.insertBlockNodesInLI=function(n,i){var o,f;n=this.processInsertNodes(n);for(var r=document.createDocumentFragment(),u=0,e=n;u<e.length;u++)o=e[u],f=t.createElement("li"),f.appendChild(o.cloneNode(!0)),r.appendChild(f);this.unwrapInlineWrappers(r);i.insertNode(r)},n.processInsertNodes=function(n){for(var i,r=[],t=[],u=0,f=n;u<f.length;u++)i=f[u],i.nodeType===Node.ELEMENT_NODE&&-1!==bt.indexOf(i.nodeName.toLowerCase())?(t.length>0&&(r.push(this.wrapInlineElementsInSpan(t)),t=[]),r.push(i)):t.push(i);return t.length>0&&r.push(this.wrapInlineElementsInSpan(t)),r},n.wrapInlineElementsInSpan=function(n){var i=t.createElement("span");return i.className="inline-wrapper",n.forEach(function(n){return i.appendChild(n)}),i},n.unwrapInlineWrappers=function(n){n.querySelectorAll(".inline-wrapper").forEach(function(n){var t=n.parentNode;if(t){for(;n.firstChild;)t.insertBefore(n.firstChild,n);t.removeChild(n)}})},n.removeEmptyAfterStartLI=function(n,i){var u=this,r;this.clearIfCompletelyEmpty(n);r=this.getRootList(n,i);r&&r.querySelectorAll("li").forEach(function(i){u.isRemovableEmptyListItem(i,n)&&t.detach(i)})},n.clearIfCompletelyEmpty=function(n){0!==n.textContent.length||n.querySelector("audio,video,img,table,br,hr")||(n.innerHTML="")},n.getRootList=function(n,i){for(var u,r=t.closest(n,"ul,ol");r&&r.parentElement&&i.contains(r.parentElement);){if(u=t.closest(r.parentElement,"ul,ol"),!i.contains(u))return r;r=u}return r||null},n.isRemovableEmptyListItem=function(n,t){return n!==t&&""===n.textContent.trim()&&!n.querySelector("audio,video,img,table,br,hr")},n.isTextOrBrInListItem=function(n,i,r){return n&&("#text"===n.nodeName||"BR"===n.nodeName||"HR"===n.nodeName)&&!t.isNullOrUndefined(n.parentElement)&&("LI"===n.parentElement.nodeName||n.parentElement.closest("LI")||i===r&&n.parentElement===i)&&n.parentElement.textContent.trim().length>0},n.handleTextInListItem=function(n,i,r,u,f,e){var a,v,p;"LI"!==r.parentElement.nodeName||t.isNullOrUndefined(r.nextSibling)||"BR"!==r.nextSibling.nodeName||t.detach(r.nextSibling);var h=Array.from(i.childNodes).filter(function(n){return!("LI"===n.nodeName||"UL"===n.nodeName||"OL"===n.nodeName)}),w=r.parentElement,s=null,c=n.collapsed,y=c?r.parentElement.closest("LI"):null,o=null,l=null;return n.collapsed||(a=n.startContainer,v=n.startOffset,s=n.cloneRange(),o=this.findLiFromContainer(s.startContainer),l=this.findLiFromContainer(s.endContainer),this.removeListfromPaste(n),o&&h.length>0&&this.removeEmptyAfterStartLI(o,e),n.setStart(a,v),n.setEnd(a,v)),p=this.getImmediateBlockNode(r,i),"HR"===i.firstChild.nodeName?(u=(o?t.closest(o,"li"):t.closest(u,"li"))||u,this.insertBlockElementInList(n,i,u,f)):c&&y&&h.length>0?this.pasteLI(i,y,w,p,n,f):!c&&o&&l&&h.length>0?this.nonCollapsedInsertion(i,s,f,l):n.insertNode(i),this.contentsDeleted=!0,!0},n.findLiFromContainer=function(n){if("LI"===n.nodeName)return n;var t=n.nodeType===Node.TEXT_NODE?n.parentNode:n;return"LI"===t.nodeName?t:t.closest("LI")},n.nonCollapsedInsertion=function(n,t,i,r){var o=this.extractChildNodes(n);o=this.processInsertNodes(o);var s=t.startContainer,u=t.endContainer,c="UL"===u.nodeName||"OL"===u.nodeName,f=this.getClosestLi(s),l=this.getPreviousLi(f),h=this.getNextLi(f),e=f.parentNode;h&&e===u&&c&&""===r.textContent&&(h=null);s===u||(!h||f.contains(u)&&!c)&&!this.isAnotherLiFromEndLi||this.isAnotherLiFromEndLi&&e!==u&&"A"!==u.nodeName?this.handleSingleLiInsertion(f,l,h,o,s,t,i,e):this.handleMultiLiInsertion(f,o,s,u,e);this.unwrapInlineWrappers(e)},n.getClosestLi=function(n){for(var t=n.nodeType===Node.TEXT_NODE?n.parentNode:n;t&&"LI"!==t.nodeName;)t=t.parentNode;return t},n.getPreviousLi=function(n){var t=n.previousSibling;return t&&"LI"===t.nodeName?t:null},n.getNextLi=function(n){var t=n.nextSibling;return t&&"LI"===t.nodeName?t:null},n.appendListItems=function(n,t,i,r){for(var f,e=null,u=i;u<r;u++)f=document.createElement("li"),f.appendChild(t[u]),n.appendChild(f),e=f;return e},n.moveSiblingsToLiAndInsert=function(n,t,i,r,u){for(var f,e=[];n;)e.push(n),n=n.nextSibling;for(f=0;f<e.length;f++)r.contains(e[f])&&r.removeChild(e[f]);for(f=0;f<e.length;f++)t.appendChild(e[f]);r.nextSibling?u.insertBefore(i,r.nextSibling):r.appendChild(i)},n.handleSingleLiInsertion=function(n,i,r,u,f,e,o,s){var y=document.createDocumentFragment(),a,p,w,v;this.extractNestedListsIntoNewListItem(n);var c=null,h=null,l=!n.hasChildNodes()||n.lastChild.nodeType!==Node.TEXT_NODE&&""!==n.textContent?n.lastChild:n;f&&f.textContent&&f.textContent.length>0&&(l=(c=o.GetSpliceNode(e,f)).previousSibling!==i?c.previousSibling:null,h=c.nextSibling!==r?c.nextSibling:null);a=u[0];p=1===u.length;(p&&(h?(this.addCursorMarker(h),this.moveAllChildren(h,a),h.parentNode.removeChild(h)):this.addCursorMarker(a,!0)),l&&l!==i&&l.textContent&&l.textContent.length>0)?this.moveAllChildren(a,l):p&&""===n.textContent?n.appendChild(a):(w=t.createElement("li"),w.appendChild(a),y.appendChild(w));v=this.appendListItems(y,u,1,u.length);v&&h&&(this.addCursorMarker(h),"A"===h.nodeName?v.lastChild.appendChild(h):this.mergeLastNodeContent(h,v));!h||"LI"!==h.nodeName&&h.nextSibling?v&&this.moveSiblingsToLiAndInsert(h,v,y,n,s):(s.insertBefore(y,n.nextSibling),h&&h.parentNode&&0===h.textContent.length&&h.parentNode.removeChild(h));c&&c.parentNode&&""===c.textContent&&c.parentNode.removeChild(c);n&&n.parentNode&&""===n.textContent&&n.parentNode.removeChild(n)},n.handleMultiLiInsertion=function(n,i,r,u,f){var s=document.createDocumentFragment(),e,h,c,o,l;this.extractNestedListsIntoNewListItem(n);e=n.nextSibling;e&&this.extractNestedListsIntoNewListItem(e);r=r.nodeType===Node.TEXT_NODE?r.parentNode:r;""===u.textContent&&u.nextSibling&&(u=u.nextSibling);e.contains(u)&&"UL"!==u.nodeName&&"OL"!==u.nodeName||(u=e);h=i[0];c=i[i.length-1];u.nodeType===Node.TEXT_NODE&&i.length>1?c.appendChild(u):i.length>1&&(this.addCursorMarker(u),this.moveAllChildren(u,c),e.insertBefore(c,e.firstChild));1===i.length&&(this.addCursorMarker(u),this.moveAllChildren(u,h),e&&e.parentNode&&e.parentNode.removeChild(e));o=null;r.textContent.length>0&&n.textContent.length>0?(this.moveAllChildren(h,r),"A"===r.nodeName&&(r=r.parentNode.lastChild)):(l=t.createElement("li"),l.appendChild(h),s.appendChild(l),1===i.length&&(o=l));t.isNullOrUndefined(o)&&(o=this.appendListItems(s,i,1,i.length-1));t.isNullOrUndefined(r.nextSibling)?f.insertBefore(s,n.nextSibling):o&&this.moveSiblingsToLiAndInsert(r.nextSibling,o,s,n,f);""===n.textContent&&n.parentNode&&n.parentNode.removeChild(n)},n.pasteLI=function(n,i,r,u,f,e){var s=this.extractChildNodes(n),o,c,y,p;s=this.processInsertNodes(s);var l=this.getBlockNodeLength(u),h=i.parentNode,a=!0,v=!1;if(i.contains(r)&&r.previousSibling&&(a=!1),i.contains(r)&&(t.isNullOrUndefined(r.nextSibling)||r.nextSibling&&-1!==["LI","UL","OL"].indexOf(r.nextSibling.nodeName))&&f.startOffset===r.textContent.length){for(o=r.previousSibling,c=f.startOffset;o&&"LI"!==o.nodeName;)c+=o.textContent.length,o=o.previousSibling;v=c===l}y=0===f.startOffset&&a;p=f.startOffset===l||v;y?this.handlePasteAtStart(s,i,r,h):p?this.handlePasteAtEnd(s,i,r,h):this.handlePasteInMiddle(s,i,r,f,h,e);this.unwrapInlineWrappers(h)},n.handlePasteAtStart=function(n,t,i,r){var u=n[n.length-1],f;this.addCursorMarker(i);this.moveAllChildren(i,u);t.insertBefore(u,t.firstChild);f=this.createLiFragment(n,0,n.length-1);r.insertBefore(f,t)},n.handlePasteAtEnd=function(n,i,r,u){var h=n[0],f=this.hasNestedListInsideLi(r),o,e,s;"LI"===r.nodeName&&f?(o=this.collectAndRemoveFollowingNodes(i,f),this.moveAllChildren(h,r),o.forEach(function(n){return r.appendChild(n)})):this.moveAllChildren(h,r);e=this.createLiFragment(n,1,n.length);s=e.lastChild;t.isNullOrUndefined(f)&&(t.isNullOrUndefined(r.nextSibling)||"LI"===r.nodeName)?u.insertBefore(e,i.nextSibling):s&&((o=this.collectAndRemoveFollowingNodes(i,f||r.nextSibling)).forEach(function(n){return s.appendChild(n)}),this.insertFragmentAfterLi(e,i,u))},n.handlePasteInMiddle=function(n,i,r,u,f,e){var h=e.GetSpliceNode(u,r),v=h.previousSibling,o=h.nextSibling,a=n[0],c,s,l;1===n.length&&(this.addCursorMarker(o),this.moveAllChildren(o,a));this.moveAllChildren(a,v);c=this.createLiFragment(n,1,n.length);s=c.lastChild;s&&(this.addCursorMarker(o),"A"===o.nodeName?s.lastChild.appendChild(o):this.mergeLastNodeContent(o,s));l=this.hasNestedListInsideLi(i);o&&t.isNullOrUndefined(o.nextSibling)&&s&&t.isNullOrUndefined(l)||"LI"===o.nodeName?(f.insertBefore(c,i.nextSibling),0===o.textContent.length&&o.parentNode.removeChild(o)):s&&(this.collectAndRemoveFollowingNodes(i,l||o).forEach(function(n){return s.appendChild(n)}),this.insertFragmentAfterLi(c,i,f));h.parentNode.removeChild(h)},n.hasNestedListInsideLi=function(n){var i,u,f,r,e,t;if("LI"===n.nodeName)for(i=0,u=Array.from(n.children);i<u.length;i++)if("UL"===(t=u[i]).tagName||"OL"===t.tagName)return t;if(f=n.closest("LI"),!f)return null;for(r=0,e=Array.from(f.children);r<e.length;r++)if("UL"===(t=e[r]).tagName||"OL"===t.tagName)return t;return null},n.getBlockNodeLength=function(n){var t;if("LI"===n.nodeName){for(var r=0,i=0,u=Array.from(n.childNodes);i<u.length;i++){if(t=u[i],t.nodeType===Node.ELEMENT_NODE&&-1!==["UL","OL"].indexOf(t.tagName))break;r+=t.textContent?t.textContent.length:0}return r}return n.textContent?n.textContent.length:0},n.addCursorMarker=function(n,i){var r=t.createElement("span");r.className="paste-cursor";i?n.appendChild(r):n.insertBefore(r,n.firstChild)},n.extractNestedListsIntoNewListItem=function(n){for(var i,l,r,s,u=[],f=0,h=Array.from(n.childNodes);f<h.length;f++)i=h[f],i.nodeType!==Node.ELEMENT_NODE||"UL"!==i.tagName&&"OL"!==i.tagName||u.push(i);if(u.length>0){for(var e=t.createElement("li"),o=0,c=u;o<c.length;o++)l=c[o],e.appendChild(l);r=n.parentNode;r&&(s=n.nextSibling,s?r.insertBefore(e,s):r.appendChild(e))}},n.createLiFragment=function(n,i,r){for(var e,f=document.createDocumentFragment(),u=i;u<r;u++)e=t.createElement("li"),e.appendChild(n[u]),f.appendChild(e);return f},n.collectAndRemoveFollowingNodes=function(n,t){for(var u,r=[],i=t;i;)u=i.nextSibling,r.push(i),n.removeChild(i),i=u;return r},n.insertFragmentAfterLi=function(n,t,i){t.nextSibling?i.insertBefore(n,t.nextSibling):t.appendChild(n)},n.moveAllChildren=function(n,t){for(var i,u="A"===t.nodeName,r="A"===n.nodeName;n.firstChild&&!r;){if(i=n.firstChild,"UL"===i.nodeName||"OL"===i.nodeName)return;u?(t.parentNode.insertBefore(i,t.nextSibling),t=t.nextSibling):t.appendChild(i)}r&&t.appendChild(n)},n.mergeLastNodeContent=function(n,t){for(;n&&n.firstChild;){var i=n.firstChild;i&&(bt.indexOf(i.nodeName.toLowerCase())>=0?"UL"===i.nodeName||"OL"===i.nodeName?t.appendChild(i):(this.moveAllChildren(i,t.lastChild),n.removeChild(i)):t.lastChild.appendChild(i))}},n.getSplitElementForInsertion=function(n,t,i){var r=n.collapsed,u=0===n.startOffset,f=n.startContainer.nodeType===Node.TEXT_NODE?n.startOffset===n.startContainer.textContent.length:n.startOffset===n.startContainer.childNodes.length;return i&&"P"===i.nodeName&&(u||f||!r)&&""===i.textContent.trim()?t.SplitNode(n,i,!0):t.GetSpliceNode(n,i)},n.cursorPos=function(n,i,r,u,f){n.classList.add("lastNode");f.innerHTML=ltt(f.innerHTML);n=f.querySelector(".lastNode");t.isNullOrUndefined(n)||(this.placeCursorEnd(n,i,r,u,f),n.classList.remove("lastNode"),0===n.classList.length&&n.removeAttribute("class"))},n.imageFocus=function(n,t,i){var r=document.createTextNode(" "),u,f;n.parentNode&&"A"===n.parentNode.nodeName?(u=n.parentNode,f=u.parentNode,f.insertBefore(r,u.nextSibling),f.insertBefore(n,r)):n.parentNode.insertBefore(r,n.nextSibling);t.setSelectionText(i,n.nextSibling,n.nextSibling,0,0)},n.getImmediateBlockNode=function(n){for(;n&&bt.indexOf(n.nodeName.toLocaleLowerCase())<0;)n=n.parentNode;return n},n.removingComments=function(n){var t=n.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.findDetachEmptyElem=function(n,i){return void 0===i&&(i=!1),t.isNullOrUndefined(n.parentElement)?null:n.parentElement.textContent.length>0&&n.parentElement.textContent.match(/\u00a0/g)&&n.parentElement.textContent.match(/\u00a0/g).length>0||""!==n.parentElement.textContent.trim()||"true"===n.parentElement.contentEditable||!t.isNullOrUndefined(n.parentElement.querySelector("img"))||"TD"===n.parentElement.nodeName||"TH"===n.parentElement.nodeName||!t.isNullOrUndefined(n.parentElement.querySelector("table td, table th"))?i&&-1!==bt.indexOf(n.tagName.toLowerCase())?null:n:i&&-1!==bt.indexOf(n.parentElement.tagName.toLowerCase())?n:this.findDetachEmptyElem(n.parentElement,i)},n.removeEmptyElements=function(n,i,r){var o,u,h,f,c;void 0===i&&(i=!1);void 0===r&&(r=null);for(var l=n.querySelectorAll(":empty"),s=Array.from(l).filter(function(n){var t=n.tagName.toLowerCase();return!(n.closest("svg")||n.closest("canvas")||["td","tr","th","textarea","input","img","video","audio","br","hr","iframe"].indexOf(t)>-1)}),e=0;e<s.length;e++)o=!0,u=s[e],("DIV"===u.tagName&&(o="none"===u.style.borderBottom||""===u.style.borderBottom),"COL"!==u.nodeName)?(h=!t.isNullOrUndefined(r)&&u===r,iit.indexOf(u.tagName.toLowerCase())<0&&o&&!h&&(f=this.findDetachEmptyElem(u,i),t.isNullOrUndefined(f)||f.nodeType===Node.ELEMENT_NODE&&"TEXTAREA"===f.nodeName.toUpperCase()||t.detach(f))):u.style.width||(c=u.parentElement,t.detach(c))},n.findClosestRelevantElement=function(n,i){for(var s,e,u,r=n,f=0,o=["table","li"];f<o.length;f++)if(s=o[f],e=t.closest(r,s),e)return e;for(;r&&r.nodeType===Node.ELEMENT_NODE;){if((u=r.parentNode,u===i)||!t.isNullOrUndefined(u.tagName)&&(this.isTagInList(u.tagName,ir)||this.isTagInList(u.tagName,rit)))return r;r=u}return null},n.isTagInList=function(n,t){return-1!==t.indexOf(n.toLowerCase())},n.insertTableInList=function(n,i,r,u,f,e){var c=t.closest(r,"ul,ol"),a=c?c.querySelectorAll("li").length:0,s=f.SplitNode(n,r,!0),o=s.previousElementSibling,h=e?t.closest(e,"li"):null,l=h?h.innerHTML:null;o&&t.closest(o,"ol,ul")&&t.closest(o,"ol,ul").querySelectorAll("li").length>a?(o.appendChild(i),n.deleteContents(),s.childNodes.length>0&&this.moveChildNodes(s,o),r!==e&&l&&l!==h.innerHTML&&this.moveChildNodes(h,o)):(n.deleteContents(),s.insertBefore(i,s.firstChild),r!==e&&this.moveChildNodes(e,r));this.removeEmptyNextLI(t.closest(i,"li"));i.classList.add("ignore-table")},n.moveChildNodes=function(n,i){for(;!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.firstChild);)i.appendChild(n.firstChild)},n.alignCheck=function(n){for(var u,i,e,f,o,t=n.querySelectorAll('span[style*="text-align"]'),r=0;r<t.length;r++)if(u=t[r],u&&(i=this.getImmediateBlockNode(u,null),i)){for(e="",f=0;f<t.length;f++)o=t[f],i.contains(o)&&(e+=o.textContent);i.textContent.trim()===e.trim()&&(i.style.textAlign=u.style.textAlign)}},n.removeListfromPaste=function(n){n.deleteContents();var i=n.startContainer;t.isNullOrUndefined(i)||"LI"!==i.nodeName||t.isNullOrUndefined(i.parentElement)||"OL"!==i.parentElement.nodeName&&"UL"!==i.parentElement.nodeName||""!==i.textContent.trim()||i.parentElement.querySelectorAll("li").forEach(function(n){""===n.textContent.trim()&&n!==i&&n.remove()})},n.isHorizontalRuleInEmptyBlock=function(n,t){if("HR"!==n.nodeName)return!1;var i=t.startContainer;return i.nodeType===Node.ELEMENT_NODE&&("P"===i.nodeName||"DIV"===i.nodeName)&&1===i.childNodes.length&&i.firstChild&&"BR"===i.firstChild.nodeName},n.isMediaElement=function(n){return!!n&&("VIDEO"===n.nodeName||"AUDIO"===n.nodeName)},n.insertBlockElementInList=function(n,i,r,u){var e=t.closest(r,"ul,ol"),s=e?e.querySelectorAll("li").length:0,f=u.SplitNode(n,r,!0),o=f.previousElementSibling;o&&e&&e.querySelectorAll("li").length>s?(o.appendChild(i.firstChild),f.childNodes.length>0&&this.moveChildNodes(f,o)):f.firstChild&&"HR"===f.firstChild.nodeName?f.insertBefore(i.firstChild,f.firstChild.nextSibling):f.insertBefore(i.firstChild,f.firstChild);""===f.textContent.trim()&&f.childNodes.length<1&&t.detach(f)},n.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","title","u","tt","var","video","wbr"],n.contentsDeleted=!1,n.isAnotherLiFromEndLi=!1,n}(),hu=function(){function n(n){this.directRangeElems=["IMG","TABLE","AUDIO","VIDEO","HR"];this.BLOCK_TAGS=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","output","p","pre","section","td","tfoot","th","video","body"];this.editableElement=n;this.currentDocument=n.ownerDocument}return n.prototype.getBlockNode=function(){var u=this,i=[],n=this.currentDocument.getSelection().getRangeAt(0);if(n.startContainer===this.editableElement&&n.startContainer===n.endContainer&&"#text"!==n.startContainer.nodeName){if(n.startOffset===n.endOffset?this.editableElement.childNodes[n.startOffset]&&this.directRangeElems.indexOf(this.editableElement.childNodes[n.startOffset].nodeName)>-1&&i.push(this.editableElement.childNodes[n.startOffset]):n.endOffset===n.startOffset+1&&i.push(this.editableElement.childNodes[n.startOffset]),i.length>0)return i}else{var f=n.startContainer.nodeType===Node.TEXT_NODE?n.startContainer.parentElement:n.startContainer,r=n.endContainer.nodeType===Node.TEXT_NODE?n.endContainer.parentElement:n.endContainer,e=this.isBlockNode(r)?r:this.getParentBlockNode(r),t=this.currentDocument.createTreeWalker(this.editableElement,NodeFilter.SHOW_ELEMENT,{acceptNode:function(t){return n.intersectsNode(t)?u.isBlockNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP:NodeFilter.FILTER_REJECT}});for(t.currentNode=f;t.currentNode;)if(this.isBlockNode(t.currentNode)?(this.addToBlockCollection(i,t,n),t.nextNode()):t.previousNode(),t.currentNode===r||t.currentNode===e){this.addToBlockCollection(i,t,n);break}}return i},n.prototype.addToBlockCollection=function(n,t,i){var r=t.currentNode;if(t.currentNode&&-1===n.indexOf(t.currentNode))if("LI"===r.nodeName)if(r.parentNode.closest("li")){var u=i.commonAncestorContainer,f=r.parentElement.closest("li"),e="LI"===r.nodeName&&!!f,o=!!(3===u.nodeType?u.parentElement:u).closest("ul,ol");if(!e||!o)return;n.push(t.currentNode)}else n.push(t.currentNode);else n.push(t.currentNode)},n.prototype.getTextNodes=function(n){for(var i=[],u=this.currentDocument.getSelection().getRangeAt(0),r=this.currentDocument.createTreeWalker(n,NodeFilter.SHOW_TEXT,{acceptNode:function(n){return u.intersectsNode(n)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),t=r.nextNode();t;)i.push(t),t=r.nextNode();return i},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&this.BLOCK_TAGS.indexOf(n.tagName.toLowerCase())>=0},n.prototype.getLastTextNode=function(n){for(var i=this.currentDocument.createTreeWalker(n,NodeFilter.SHOW_TEXT,null),r=null,t=i.nextNode();t;)r=t,t=i.nextNode();return r},n.prototype.getFirstTextNode=function(n){return this.currentDocument.createTreeWalker(n,NodeFilter.SHOW_TEXT,null).nextNode()},n.prototype.getParentBlockNode=function(n){var i=this,t=this.currentDocument.createTreeWalker(this.editableElement,NodeFilter.SHOW_ELEMENT,{acceptNode:function(n){return i.isBlockNode(n)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return t.currentNode=n,t.parentNode()},n.prototype.getTopMostNode=function(n){if(this.isBlockNode(n.parentNode))return n;for(var t=n.parentNode;t;){if(this.isBlockNode(t.parentNode)||n.textContent!==t.textContent)return t;t=t.parentNode}return t},n.prototype.findParentLiElementUntilEditable=function(n){for(var i,t=n;t&&t!==this.editableElement;){if(t.nodeType===Node.ELEMENT_NODE&&(i=t,"LI"===i.tagName))return i;t=t.parentNode}return null},n.prototype.getSelectedLiElements=function(){var r=this.currentDocument.getSelection().getRangeAt(0),n=this.currentDocument.createTreeWalker(r.commonAncestorContainer,NodeFilter.SHOW_ALL,{acceptNode:function(n){return function(n,t){var i=n.cloneRange();return i.selectNodeContents(t),n.compareBoundaryPoints(Range.END_TO_START,i)<0&&n.compareBoundaryPoints(Range.START_TO_END,i)>0}(r,n)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}}),t=new Set,u=this.findParentLiElementUntilEditable(n.currentNode),i;for(u&&t.add(u);n.nextNode();)i=this.findParentLiElementUntilEditable(n.currentNode),i&&t.add(i);return Array.from(t)},n.prototype.getLiElementsInRange=function(){for(var n=[],r=this.getSelectedLiElements(),f=function(i){var f=u.findParentLiElementUntilEditable(r[i]),e;f&&f.querySelectorAll("li").length>0&&(e=u.currentDocument.getSelection().getRangeAt(0),f.querySelectorAll("li").forEach(function(t){e.intersectsNode(t)&&-1===n.indexOf(t)&&n.push(t)}));t.isNullOrUndefined(f)||-1!==n.indexOf(f)||n.push(f)},u=this,i=0;i<r.length;i++)f(i);return n},n}(),cit=function(){function n(n){this.listTabIndentation=!1;this.parent=n;this.domNode=this.parent.domNode;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ov,this.applyListsHandler,this);this.parent.observer.on(ei,this.onKeyUp,this);this.parent.observer.on(c,this.keyDownHandler,this);this.parent.observer.on(av,this.spaceKeyAction,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(ov,this.applyListsHandler);this.parent.observer.off(ei,this.onKeyUp);this.parent.observer.off(c,this.keyDownHandler);this.parent.observer.off(av,this.spaceKeyAction);this.parent.observer.off(f,this.destroy)},n.prototype.testList=function(n){var r=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],u=t.isNullOrUndefined(n)?null:n.innerText.trim().split(".")[0]+".",i;if(!t.isNullOrUndefined(u))for(i=0;i<r.length;i++)if(r[i].test(u))return!0;return!1},n.prototype.testCurrentList=function(n){var u=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/],r,i;if(!t.isNullOrUndefined(n.startContainer.textContent.slice(0,n.startOffset)))for(r=n.startContainer.textContent.replace(/\u200B/g,"").slice(0,n.startOffset).trim(),i=0;i<u.length;i++)if(u[i].test(r)&&2===r.length)return!0;return!1},n.prototype.createAutoList=function(n,t){var i={BR:{BR:!0,P:!0,DIV:!0},P:{BR:!1,P:!0,DIV:!0},DIV:{BR:!1,P:!0,DIV:!0}};return!(!i[n]||void 0===i[n][t])&&i[n][t]},n.prototype.isInsideSameListType=function(n,t){var r,i;return n?(r=n.closest("li"),!r)?!1:(i=r.closest("ul, ol"),!!i&&("OL"===i.tagName&&t||"UL"===i.tagName&&!t)):!1},n.prototype.spaceList=function(n){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),e;this.saveSelection=this.parent.nodeSelection.save(i,this.parent.currentDocument);var r=this.parent.domNode.getSelectedNode(i.startContainer,i.startOffset),u=(this.parent.domNode.getSelectedNode(i.endContainer,i.endOffset),r.previousElementSibling),f=r.nextElementSibling,s=t.isNullOrUndefined(u)?null:u.innerText.trim().substring(0,1),h=t.isNullOrUndefined(f)?null:f.innerText.trim().substring(0,1),o=this.testCurrentList(i),c=this.testList(u),l=this.testList(f),a=this.isInsideSameListType(r,o),v=i.startContainer.previousElementSibling&&"BR"===i.startContainer.previousElementSibling.tagName;a||c||l||"*"===s||"*"===h||!this.createAutoList(n.enterKey,n.shiftEnterKey)&&v||(e=t.createElement("br"),o?(i.startContainer.textContent=i.startContainer.textContent.slice(i.startOffset,i.startContainer.textContent.length),"#text"===i.startContainer.nodeName&&0===i.startContainer.textContent.length&&this.parent.domNode.insertAfter(e,i.startContainer),this.applyListsHandler({subCommand:"OL",callBack:n.callBack,enterAction:n.enterKey}),n.event.preventDefault()):"*"!==i.startContainer.textContent.replace(/\u200B/g,"").slice(0,i.startOffset).trim()&&"-"!==i.startContainer.textContent.replace(/\u200B/g,"").slice(0,i.startOffset).trim()||(i.startContainer.textContent=i.startContainer.textContent.slice(i.startOffset,i.startContainer.textContent.length),"#text"===i.startContainer.nodeName&&0===i.startContainer.textContent.length&&this.parent.domNode.insertAfter(e,i.startContainer),this.applyListsHandler({subCommand:"UL",callBack:n.callBack,enterAction:n.enterKey}),n.event.preventDefault()))},n.prototype.isCtrlEnterInChecklist=function(n){var r=!1,i,t;if(n.event&&(n.event.ctrlKey||n.event.metaKey)&&"Enter"===n.event.key)for(i=new hu(this.parent.editableElement).getLiElementsInRange(),t=0;t<i.length;t++)"LI"===i[t].nodeName&&"UL"===i[t].parentElement.nodeName&&!i[t].classList.contains("e-rte-checklist-hidden")&&i[t].parentElement.classList.contains("e-rte-checklist")&&(r=!0,i[t].classList.contains("e-rte-checklist-checked")?i[t].classList.remove("e-rte-checklist-checked"):i[t].classList.add("e-rte-checklist-checked"));r&&(n.callBack&&n.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:n.event}),r=!1)},n.prototype.enterList=function(n){var r=this.parent.nodeSelection.getRange(this.parent.currentDocument),i="LI"===r.startContainer.nodeName?r.startContainer:r.startContainer.parentElement.closest("LI"),o="LI"===r.endContainer.nodeName?r.endContainer:r.endContainer.parentElement.closest("LI"),f,u,s,h,c,l,a,e,y,p;if(this.isCtrlEnterInChecklist(n),s=!1,t.isNullOrUndefined(i)||(h=i.querySelectorAll(".e-video-clickelem"),c=h.length>0&&"IFRAME"===h[0].childNodes[0].nodeName,s=i.querySelectorAll("IMG").length>0||i.querySelectorAll("AUDIO").length>0||i.querySelectorAll("VIDEO").length>0||c),i&&(f=i.parentElement)&&(u=f.parentElement),l=t.isNullOrUndefined(i)?null:i.querySelector("TABLE"),!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(o)&&i===o&&"LI"===i.tagName&&""===i.textContent.trim()&&!s&&t.isNullOrUndefined(l)){if(i.innerHTML.indexOf("&nbsp;")>=0)return;if(65279===i.textContent.charCodeAt(0)&&(i.textContent=""),t.isNullOrUndefined(u.closest("UL"))&&t.isNullOrUndefined(u.closest("OL"))){t.isNullOrUndefined(i.nextElementSibling)||(a=this.parent.domNode.blockParentNode(i),this.parent.nodeCutter.GetSpliceNode(r,a));e=void 0;"DIV"===n.enterAction?(e=t.createElement("div")).innerHTML="<br>":"P"===n.enterAction?(e=t.createElement("p")).innerHTML="<br>":e=t.createElement("br");var w=this.domNode.getImmediateBlockNode(r.startContainer),v=this.applyFormattingFromRange(e,r,w,n.enterAction),b=v.formattedElement,k=v.cursorTarget;e=b;t.isNullOrUndefined(u)||"BLOCKQUOTE"!==u.nodeName||this.parent.observer.notify("blockquote_list_handled",{});this.parent.domNode.insertAfter(e,f);n.event.preventDefault();this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,k,0);""===f.textContent&&0===f.querySelectorAll("audio,video,table").length?t.detach(f):t.detach(i)}t.isNullOrUndefined(u)||t.isNullOrUndefined(u.closest("UL"))&&t.isNullOrUndefined(u.closest("OL"))||"LI"!==u.nodeName||"none"!==u.style.listStyleType||""!==u.textContent||""!==i.textContent||i!==f.firstElementChild||!t.isNullOrUndefined(i.nextSibling)||(t.detach(f),u.style.removeProperty("list-style-type"),n.event.preventDefault())}if(y="#text"===r.startContainer.nodeName?r.startContainer.parentElement:r.startContainer,p=this.isNodeInListNotTable(y),!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(o)&&i===o&&"LI"===i.tagName&&0!==i.textContent.length&&p&&n.event&&!n.event.shiftKey&&!n.event.ctrlKey&&!n.event.metaKey)return this.splitListAtCursor(r,i,f),void n.event.preventDefault();this.handleNestedEnterKeyForLists(n,u,i,f)},n.prototype.splitListAtCursor=function(n,i,r){var f,u=this.parent.editableElement.ownerDocument.createRange(),c=["AREA","BASE","BR","COL","EMBED","HR","IMG","INPUT","LINK","META","SOURCE","TRACK","WBR"],l=n.startContainer,a=n.startOffset,s,e,o,h;if(n.startContainer===n.endContainer&&n.startOffset===n.endOffset?(u.setStart(l,a),u.setEndAfter(i),this.parent.nodeSelection.setRange(this.parent.currentDocument,u),f=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument).cloneContents(),this.cleanupListElements(f,c),u.deleteContents()):(n.deleteContents(),u.setStart(l,a),u.setEndAfter(i),this.parent.nodeSelection.setRange(this.parent.currentDocument,u),f=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument).cloneContents(),this.cleanupListElements(f,c),u.deleteContents()),i.querySelectorAll("*:empty").length>0)for(s=i.querySelectorAll("*:empty"),e=0;e<s.length;e++)-1===c.indexOf(s[e].nodeName)&&t.detach(s[e]);""===i.innerHTML&&(i.innerHTML="<br>");o=this.parent.nodeSelection.findFirstContentNode(f);(i.nextElementSibling?r.insertBefore(f,i.nextElementSibling):r.appendChild(f),"BR"===o.node.nodeName)?(h=this.parent.editableElement.ownerDocument.createRange(),h.setStartBefore(o.node),h.setEndBefore(o.node),this.parent.nodeSelection.setRange(this.parent.currentDocument,h)):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,o.node,0)},n.prototype.cleanupListElements=function(n,i){for(var u=n.firstElementChild.querySelectorAll("*:empty"),r=0;r<u.length-1;r++)-1===i.indexOf(u[r].nodeName)&&t.detach(u[r]);this.ensureListItemContent(n)},n.prototype.ensureListItemContent=function(n){for(var t,u,f,r=n.querySelectorAll("li"),i=0;i<r.length;i++)t=r[i],t.childNodes.length>0&&(t.firstChild&&("UL"===t.firstChild.nodeName||"OL"===t.firstChild.nodeName)||t.firstElementChild&&("UL"===t.firstElementChild.nodeName||"OL"===t.firstElementChild.nodeName))||""===t.innerHTML?(u=document.createElement("br"),t.firstChild?t.insertBefore(u,t.firstChild):t.appendChild(u)):(f=t.querySelector("*:empty"),f&&f.appendChild(document.createElement("br")))},n.prototype.isNodeInListNotTable=function(n){for(var t=n;t&&t!==this.parent.editableElement;){if("TABLE"===t.nodeName)return!1;if("UL"===t.nodeName||"OL"===t.nodeName)return!0;t=t.parentNode}return!1},n.prototype.applyFormattingFromRange=function(n,i,r,u){var h=n,o=[],f,c,s,e,l;if(r){for(f=i.startContainer,c=["div","p","h1","h2","h3","h4","h5","h6","li","ul","ol","table","tr","td","th"];f&&f!==r;)s=f.nodeName.toLowerCase(),-1===c.indexOf(s)&&f.nodeType===Node.ELEMENT_NODE&&o.push({tag:s,element:f}),f=f.parentNode;o.length>0&&((n="BR"===u?t.createElement("DIV"):n).innerHTML="",e=n,o.reverse().forEach(function(n){var i=t.createElement(n.tag);Array.from(n.element.attributes).forEach(function(n){i.setAttribute(n.name,n.value)});e.appendChild(i);e=i}),l=t.createElement("br"),e.appendChild(l),h=e)}return{formattedElement:"BR"===u&&o.length>0?n.firstChild:n,cursorTarget:h}},n.prototype.handleNestedEnterKeyForLists=function(n,i,r,u){var e=!1,o,f;(!t.isNullOrUndefined(r)&&r.querySelectorAll("audio,video,table,img,HR").length>0&&(e=!0),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.closest("UL"))&&t.isNullOrUndefined(i.closest("OL"))&&"UL"!==u.nodeName&&"OL"!==u.nodeName||"LI"!==i.nodeName&&"LI"!==r.nodeName||"none"!==i.style.listStyleType&&""!==i.style.listStyleType||""===i.textContent||t.isNullOrUndefined(r.lastElementChild)||""===r.lastElementChild.textContent||!r.firstElementChild||""!==r.firstElementChild.textContent||e||r!==u.firstElementChild&&"LI"!==r.nodeName)||(o=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.saveSelection=this.parent.nodeSelection.save(o,this.parent.currentDocument),this.domNode.setMarker(this.saveSelection),n.event.preventDefault(),f=[],r===u.firstElementChild?f.push(u.firstElementChild):"LI"===r.nodeName&&f.push(r),this.revertList(f,n),this.revertClean(),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore())},n.prototype.backspaceList=function(n){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),i=this.parent.domNode.getSelectedNode(e.startContainer,e.startOffset),o=this.parent.domNode.getSelectedNode(e.endContainer,e.endOffset),h,f,v,r;if(i="BR"===i.nodeName?i.parentElement:i,o="BR"===o.nodeName?o.parentElement:o,!t.isNullOrUndefined(i)&&i.closest("li")){var c=this.getListCursorInfo(e),p=null===i.previousElementSibling,u=this.parent.domNode.blockNodes(),w=this.isAllListNodesSelected(i.closest("li").parentElement),b="StartNested"===c.position&&i&&i.parentElement&&i.parentElement.closest("li")&&i.parentElement.closest("li").getAttribute("style")&&-1!==i.parentElement.closest("li").getAttribute("style").indexOf("list-style-type: none;");if(p&&(["StartParent"].indexOf(c.position)>-1||b)){for(n.event.preventDefault(),h=this.parent.nodeSelection.save(e,this.parent.currentDocument),this.domNode.setMarker(h),f=0;f<u.length;f++)u.length>0&&"LI"!==u[f].tagName&&"LI"===u[f].parentNode.tagName&&(u[f]=u[f].parentNode);return this.revertList([u[0]],n),this.revertClean(),void(h=this.domNode.saveMarker(h)).restore()}if(["SingleFull","MultipleFull"].indexOf(c.selectionState)>-1&&w){if(n.event.preventDefault(),u[0].innerHTML="",e.deleteContents(),u.length>1)for(f=0;f<u.length;f++)0!==f&&(v=u[f],t.detach(v));return void this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,u[0],0)}}if(i===o&&!t.isNullOrUndefined(t.closest(i,"li"))&&(""===i.textContent.trim()&&65279===i.textContent.charCodeAt(0)||1===i.textContent.length&&8203===i.textContent.charCodeAt(0))&&(i.textContent=""),i===o&&"LI"===i.tagName&&0===i.textContent.length&&t.isNullOrUndefined(i.previousElementSibling)&&i.removeAttribute("style"),i===o&&""===i.textContent){if("LI"===i.parentElement.tagName&&"LI"===o.parentElement.tagName)t.detach(i);else if((i.closest("ul")||i.closest("ol"))&&(r=t.isNullOrUndefined(i.closest("ul"))?i.closest("ol"):i.closest("ul")).firstElementChild===i&&!t.isNullOrUndefined(r.children[1])&&("OL"===r.children[1].tagName||"UL"===r.children[1].tagName))if(r.tagName===r.children[1].tagName){for(;r.children[1].lastChild;)this.parent.domNode.insertAfter(r.children[1].lastChild,r.children[1]);t.detach(r.children[1])}else r.parentElement.insertBefore(r.children[1],r)}else if(!(t.isNullOrUndefined(i.firstChild)||"BR"!==i.firstChild.nodeName||t.isNullOrUndefined(i.childNodes[1])||"UL"!==i.childNodes[1].nodeName&&"OL"!==i.childNodes[1].nodeName))if((r=t.isNullOrUndefined(i.closest("ul"))?i.closest("ol"):i.closest("ul")).tagName===i.childNodes[1].nodeName){for(;i.childNodes[1].lastChild;)this.parent.domNode.insertAfter(i.children[1].lastChild,i);t.detach(i.childNodes[1])}else r.parentElement.insertBefore(i.children[1],r);if(i===o&&"LI"===i.tagName&&this.isAtListStart(i,e)&&!t.isNullOrUndefined(i.closest("ul, ol"))){var l=i.closest("ul, ol"),a=l.parentElement,s=i.previousElementSibling,y=i.querySelector("ol, ul");(t.isNullOrUndefined(a)||"LI"!==a.tagName||t.isNullOrUndefined(l.previousSibling))&&(t.isNullOrUndefined(s)||"LI"!==s.nodeName)||(t.isNullOrUndefined(y)||!t.isNullOrUndefined(s)&&t.isNullOrUndefined(s)||(n.event.preventDefault(),this.handleNestedListRearrangement(i,l,a,s,y)))}this.removeList(e,n);this.firstListBackSpace(e,n)},n.prototype.handleNestedListRearrangement=function(n,i,r,u,f){for(var e,o=this.parent.nodeSelection.findLastTextPosition(t.isNullOrUndefined(u)?i.previousSibling:u),h=Array.from(n.childNodes),s=0;s<h.length;s++)if(e=h[s],e===f&&f)for(;f.firstChild;)i.insertBefore(f.firstChild,n),n.querySelector("OL:empty,UL:empty")&&n.remove();else t.isNullOrUndefined(u)?r.insertBefore(e,i):o.node.parentElement.closest("li").appendChild(e);this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,o.node,o.offset)},n.prototype.findPreviousElementForCursor=function(n){var t=null;return n.previousElementSibling?t=n.previousElementSibling:n.parentElement&&n.parentElement!==this.parent.editableElement&&(t=n.parentElement),t},n.prototype.handleCursorPositioningAfterListRemoval=function(n){if(n&&this.parent.userAgentData.isSafari()){var t=this.parent.nodeSelection.findLastTextPosition(n);t?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t.node,t.offset):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,n.childNodes.length)}},n.prototype.removeList=function(n,i){var l=this,f=this.parent.domNode.getSelectedNode(n.startContainer,n.startOffset),r=!t.isNullOrUndefined(n.endContainer.parentElement.closest("li"))&&n.endContainer.parentElement.closest("li").childElementCount>1&&"#text"===n.endContainer.nodeName?n.endContainer:this.parent.domNode.getSelectedNode(n.endContainer,n.endOffset),e="#text"===n.startContainer.nodeName?n.startContainer.parentElement.closest("li"):n.startContainer.closest("li"),o="#text"===n.endContainer.nodeName?n.endContainer.parentElement.closest("li"):n.endContainer.closest("li"),a="",s,h,v;if(t.isNullOrUndefined(e)||t.isNullOrUndefined(e.firstChild)||e.childNodes.forEach(function(n){a+=n.textContent}),f="BR"===f.nodeName?f.parentElement:f,r="BR"===r.nodeName?r.parentElement:r,f="LI"===f.nodeName||t.isNullOrUndefined(f.closest("LI"))?f:f.closest("LI"),r="LI"===r.nodeName||"#text"===r.nodeName||t.isNullOrUndefined(r.closest("LI"))?r:r.closest("LI"),v=!t.isNullOrUndefined(o)&&t.isNullOrUndefined(o.nextElementSibling),(("OL"===n.commonAncestorContainer.nodeName||"UL"===n.commonAncestorContainer.nodeName||"LI"===n.commonAncestorContainer.nodeName)&&t.isNullOrUndefined(r.nextElementSibling)&&r.textContent.length===n.endOffset&&v&&t.isNullOrUndefined(f.previousElementSibling)&&0===n.startOffset||-1!==t.Browser.userAgent.indexOf("Firefox")&&n.startContainer===n.endContainer&&n.startContainer===this.parent.editableElement&&0===n.startOffset&&1===n.endOffset)&&(-1!==t.Browser.userAgent.indexOf("Firefox")?(s=this.findPreviousElementForCursor(n.commonAncestorContainer.childNodes[0]),t.detach(n.commonAncestorContainer.childNodes[0])):"LI"===n.commonAncestorContainer.nodeName?(s=this.findPreviousElementForCursor(n.commonAncestorContainer.parentElement),t.detach(n.commonAncestorContainer.parentElement)):(s=this.findPreviousElementForCursor(n.commonAncestorContainer),t.detach(n.commonAncestorContainer)),i.event.preventDefault(),this.handleCursorPositioningAfterListRemoval(s),e="#text"===n.startContainer.nodeName?n.startContainer.parentElement.closest("li"):n.startContainer.closest("li")),!t.isNullOrUndefined(o)&&n.commonAncestorContainer===this.parent.editableElement||!t.isNullOrUndefined(e)&&(!n.collapsed||""===e.textContent.trim()&&t.isNullOrUndefined(e.previousElementSibling)&&t.isNullOrUndefined(e.nextElementSibling))&&e.textContent===a){n.deleteContents();for(var u=this.parent.editableElement.querySelectorAll("li"),y=function(n){t.isNullOrUndefined(u[n].childNodes)||u[n].childNodes.forEach(function(t){"A"===t.nodeName&&""===t.textContent&&u[n].removeChild(t)});u[n].firstChild&&""!==u[n].textContent.trim()||u[n]!==f&&u[n]!==r&&u[n]!==o||(h=p.findPreviousElementForCursor(u[n]),u[n].parentNode.removeChild(u[n]))},p=this,c=0;c<u.length;c++)y(c);this.parent.editableElement.querySelectorAll("ol").forEach(function(n){n.firstChild&&""!==n.textContent.trim()||(h=l.findPreviousElementForCursor(n),n.parentNode.removeChild(n))});this.parent.editableElement.querySelectorAll("ul").forEach(function(n){n.firstChild&&""!==n.textContent.trim()||(h=l.findPreviousElementForCursor(n),n.parentNode.removeChild(n))});i.event.preventDefault();this.handleCursorPositioningAfterListRemoval(h)}},n.prototype.onKeyUp=function(n){var u,r,i;if(!t.isNullOrUndefined(this.commonLIParent)&&!t.isNullOrUndefined(this.commonLIParent.querySelector(".removeList"))){for(u=this.commonLIParent.querySelector(".removeList");!t.isNullOrUndefined(u.firstChild);)this.parent.domNode.insertAfter(u.firstChild,u);t.detach(u)}if(13===n.event.keyCode)for(r=this.parent.editableElement.querySelectorAll("UL, OL"),i=0;i<r.length;i++)t.isNullOrUndefined(r[i])||t.isNullOrUndefined(r[i].parentElement)||t.isNullOrUndefined(r[i].previousElementSibling)||"UL"!==r[i].parentElement.nodeName&&"OL"!==r[i].parentElement.nodeName||r[i].previousElementSibling.appendChild(r[i])},n.prototype.firstListBackSpace=function(n){var i=this.parent.domNode.getSelectedNode(n.startContainer,n.startOffset),r=i.closest("LI"),u;(t.isNullOrUndefined(r)||this.isAtListStart(r,n))&&(t.isNullOrUndefined(i.closest("OL"))?t.isNullOrUndefined(i.closest("UL"))||(this.commonLIParent=i.closest("UL")):this.commonLIParent=i.closest("OL"),!t.isNullOrUndefined(r)&&0===n.startOffset&&0===n.endOffset&&t.isNullOrUndefined(i.previousSibling)&&!t.isNullOrUndefined(this.commonLIParent)&&t.isNullOrUndefined(this.commonLIParent.previousSibling)&&t.isNullOrUndefined(this.commonLIParent.parentElement.closest("OL"))&&t.isNullOrUndefined(this.commonLIParent.parentElement.closest("UL"))&&t.isNullOrUndefined(this.commonLIParent.parentElement.closest("LI")))&&(u=t.createElement("P"),u.innerHTML="&#8203;",i.classList.add("removeList"),this.commonLIParent.parentElement.insertBefore(u,this.commonLIParent))},n.prototype.isAtListStart=function(n,t){if("LI"!==n.nodeName)return!1;var i=n;return this.getFirstTextNode(i)===t.startContainer&&0===t.startOffset},n.prototype.getFirstTextNode=function(n){var t,i;if(n.nodeType===Node.TEXT_NODE)return n;for(t=0;t<n.childNodes.length;t++)if(i=this.getFirstTextNode(n.childNodes[t]),i)return i;return null},n.prototype.keyDownHandler=function(n){var u,i;if(13===n.event.which&&this.enterList(n),32===n.event.which&&this.spaceList(n),8===n.event.which&&this.backspaceList(n),46===n.event.which&&"delete"===n.event.action){var o=(u=this.parent.nodeSelection.getRange(this.parent.currentDocument)).commonAncestorContainer,h=u.startContainer,c=u.endContainer,e=3===h.nodeType?this.domNode.blockParentNode(h):h,s=3===c.nodeType?this.domNode.blockParentNode(c):c;"UL"!==o.nodeName&&"OL"!==o.nodeName||e===s||t.isNullOrUndefined(t.closest(e,"ul"))&&t.isNullOrUndefined(t.closest(e,"ol"))||t.isNullOrUndefined(t.closest(s,"ul"))&&t.isNullOrUndefined(t.closest(s,"ol"))||o.lastElementChild!==t.closest(s,"li")||o.lastChild===s||u.collapsed||this.areAllListItemsSelected(o,u)&&t.detach(o);this.removeList(u,n)}if(9===n.event.which){if(u=this.parent.nodeSelection.getRange(this.parent.currentDocument),n.event.action&&"indent"===n.event.action||(this.saveSelection=this.parent.nodeSelection.save(u,this.parent.currentDocument)),n.enableTabKey&&this.handleListIndentation(),(e=this.parent.domNode.getSelectedNode(u.startContainer,u.startOffset))===(s=this.parent.domNode.getSelectedNode(u.endContainer,u.endOffset))&&("BR"===e.nodeName||"#text"===e.nodeName)&&ir.indexOf(e.parentNode.tagName.toLocaleLowerCase())>=0)return;n.event.action&&"indent"===n.event.action||this.listTabIndentation||this.domNode.setMarker(this.saveSelection);i=this.domNode.blockNodes();for(var f=[],l=!0,r=0;r<i.length;r++)"LI"===i[r].parentNode.tagName?f.push(i[r].parentNode):t.closest(i[r],"OL")||t.closest(i[r],"UL")||!t.closest(i[r],"LI")?"LI"===i[r].tagName&&"P"!==i[r].childNodes[0].tagName&&"OL"!==i[r].childNodes[0].tagName&&"UL"!==i[r].childNodes[0].tagName&&f.push(i[r]):f.push(t.closest(i[r],"LI"));f.length>1||1===f.length?(n.event.preventDefault(),n.event.stopPropagation(),this.currentAction=this.getAction(f[0]),n.event.shiftKey&&(!n.enableTabKey||n.enableTabKey&&!this.listTabIndentation)?(this.revertList(f,n),this.revertClean()):(!n.enableTabKey||n.enableTabKey&&!this.listTabIndentation)&&(l=this.nestedList(f)),l&&(this.cleanNode(),this.parent.editableElement.focus({preventScroll:!0})),n.event.action&&"indent"===n.event.action||this.listTabIndentation||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),n.callBack&&n.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:n.event}))):n.event.action&&"indent"===n.event.action||this.listTabIndentation||(n.event&&n.event.shiftKey&&"Tab"===n.event.key&&(n.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore());this.listTabIndentation=!1}else switch(n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault();break;case"checklist":this.applyListsHandler({subCommand:"Checklist",callBack:n.callBack});n.event.preventDefault()}},n.prototype.handleListIndentation=function(){var o=this.parent.nodeSelection.getRange(this.parent.currentDocument),e=this.saveSelection.getParentNodeCollection(o),n,h,f,r;if(("LI"===e[0].nodeName||t.closest(e[0],"li"))&&!this.isCursorAtStartOfLI(o)){var u=e[e.length-1],i=e[0],s=o.startContainer;if(u&&i){if(o.deleteContents(),u!==i){for(n=s;n.parentElement;){if(this.parent.domNode.isBlockNode(n.parentElement)){n=n.parentElement;break}n=n.parentElement}if(h=void 0,this.parent.domNode.isBlockNode(u.lastChild)?(s.nodeValue+="    ",h=s.nodeValue.length):u.innerHTML+='&nbsp;&nbsp;&nbsp;&nbsp;<span class="rte-tab-space"><\/span>',f=i.firstChild,f&&this.parent.domNode.isBlockNode(f)){for(;f.firstChild;)n.appendChild(f.firstChild);f.remove()}for(;i.firstChild;)this.parent.domNode.isBlockNode(i.firstChild)?this.parent.domNode.insertAfter(i.firstChild,n):u.appendChild(i.firstChild);i.remove();r=u.querySelector(".rte-tab-space");r&&r.previousSibling?(this.saveSelection.setCursorPoint(this.parent.currentDocument,r.previousSibling,r.previousSibling.textContent.length),r.parentNode.removeChild(r)):this.saveSelection.setCursorPoint(this.parent.currentDocument,s,h)}else kt.Insert(this.parent.currentDocument,"&nbsp;&nbsp;&nbsp;&nbsp;",this.parent.editableElement);this.listTabIndentation=!0}}},n.prototype.isCursorAtStartOfLI=function(n){for(var i,t=n.startContainer;t&&"LI"!==t.nodeName;)t=t.parentNode;return t?(i=n.cloneRange(),i.selectNodeContents(t),i.setEnd(n.startContainer,n.startOffset),""===i.toString().trim()):!1},n.prototype.spaceKeyAction=function(n){32===n.event.which&&this.spaceList(n)},n.prototype.getAction=function(n){return"OL"===n.parentNode.nodeName?"OL":"UL"},n.prototype.revertClean=function(){for(var n,t,r,u=this.parent.editableElement.querySelectorAll("ul, ol"),i=0;i<u.length;i++)if(n=u[i].querySelectorAll("ul, ol"),n.length>0)for(t=0;t<n.length;t++)r=n[t].previousSibling,r&&"LI"===r.tagName&&r.appendChild(n[t])},n.prototype.noPreviousElement=function(n){var e,f,s=n.querySelectorAll("ol, ul"),h=n.querySelectorAll("li"),l=this.domNode.contents(h[0])[0],i,o,u,c,r;if(h.length>0&&(s.length<=1||s[0].childNodes.length>1)&&("OL"===l.nodeName||"UL"===l.nodeName)?e=h[0]:f=s[0],e)for(i=this.domNode.contents(n)[0];i&&!this.domNode.isList(i);null)o=i.nextSibling,t.prepend([i],e),t.setStyleAttribute(n,{"list-style-type":"none"}),(c=n.parentNode&&n.parentNode.classList.contains("e-rte-checklist"))&&t.addClass([n],["e-rte-checklist-hidden"]),t.setStyleAttribute(e,{"list-style-type":""}),i=o;else if(f){for(u=t.createElement("li"),t.prepend([u],f),i=this.domNode.contents(n)[0];i&&!this.domNode.isList(i);null)o=i.nextSibling,u.appendChild(i),i=o;c=n.parentNode&&n.parentNode.classList.contains("e-rte-checklist");t.prepend([f],n.parentNode);t.detach(n);r=t.createElement("li",{styles:"list-style-type: none;"});c&&t.addClass([r],["e-rte-checklist-hidden"]);t.prepend([r],f.parentNode);t.append([f],r)}else r=t.createElement("li",{styles:"list-style-type: none;"}),t.prepend([r],n.parentNode),u=t.createElement(n.parentNode.tagName),n.parentNode.classList.contains("e-rte-checklist")&&(t.addClass([u],["e-rte-checklist"]),t.addClass([r],["e-rte-checklist-hidden"])),t.prepend([u],r),t.append([n],u)},n.prototype.nestedList=function(n){for(var r=!1,f=function(u){var f=i.domNode.getPreviousNode(n[u]),o,e,c,p;if(f){r=!0;var s=void 0,h=void 0,l=n[u].querySelectorAll("ol, ul"),a=n[u].querySelectorAll("li"),v=i.domNode.contents(a[0])[0];if(a.length>0&&(l.length<=1||l[0].childNodes.length>1)&&("OL"===v.nodeName||"UL"===v.nodeName)?h=a[0]:s=l[0],s){for(o=t.createElement("li"),t.prepend([o],s),e=i.domNode.contents(n[u])[0];e&&!i.domNode.isList(e);null)c=e.nextSibling,o.appendChild(e),e=c;f.parentNode&&f.parentNode.classList.contains("e-rte-checklist")&&t.addClass([s],["e-rte-checklist"]);t.append([s],f);t.detach(n[u])}else if(h){if("LI"===f.tagName){for(e=i.domNode.contents(n[u])[0];e&&!i.domNode.isList(e);null)c=e.nextSibling,t.prepend([e],h),t.setStyleAttribute(n[u],{"list-style-type":"none"}),t.setStyleAttribute(h,{"list-style-type":""}),e=c;t.append([h.parentNode],f);t.detach(n[u])}}else if("LI"===f.tagName){o=t.createElement(n[u].parentNode.tagName);n[u].parentNode.classList.contains("e-rte-checklist")&&t.addClass([o],["e-rte-checklist"]);o.style.listStyleType=n[u].parentNode.style.listStyleType;var y=f.getAttribute("style"),w=getComputedStyle(n[u]),b=n[u].style;y&&y.split(";").filter(Boolean).forEach(function(t){var f=t.split(":").map(function(n){return n.trim()}),i=f[0],e=f[1],r,o;i&&e&&"list-style-type"!==i&&(r=w.getPropertyValue(i).trim(),o=b.getPropertyValue(i).trim(),r===e||o||n[u].style.setProperty(i,r))});t.append([o],f);t.append([n[u]],o)}else"OL"!==f.tagName&&"UL"!==f.tagName||t.append([n[u]],f)}else p=n[u],r=!0,i.noPreviousElement(p)},i=this,u=0;u<n.length;u++)f(u);return r},n.prototype.isCursorBeforeTable=function(n){return n.startOffset===n.endOffset&&n.startContainer.childNodes.length>0&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])&&"TABLE"===n.startContainer.childNodes[n.startOffset].nodeName},n.prototype.isCursorAtEndOfTable=function(n){return n.startOffset===n.endOffset&&n.startContainer.childNodes.length>0&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])&&"TABLE"===n.startContainer.childNodes[n.startOffset-1].nodeName},n.prototype.isListItemWithTableChild=function(n){return"LI"===n.nodeName&&!t.isNullOrUndefined(n.firstChild)&&"TABLE"===n.firstChild.nodeName},n.prototype.handleChecklistToggle=function(n){var i=n.event.target;"LI"!==i.tagName&&t.isNullOrUndefined(t.closest(i,".e-rte-checklist"))||(n.event.preventDefault(),n.event.stopPropagation(),i.classList.contains("e-rte-checklist-checked")?i.classList.remove("e-rte-checklist-checked"):i.classList.add("e-rte-checklist-checked"))},n.prototype.applyListsHandler=function(n){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),s,r,f;if("Checklist"===n.subCommand&&n.item&&"toggleChecklist"===n.item.action)this.handleChecklistToggle(n);else{var o="HR"===i.startContainer.nodeName?i.startContainer:i.startContainer.childNodes[i.startOffset],h=o&&"HR"===o.nodeName?o.nextElementSibling:null,c=i.startContainer===i.endContainer&&i.startOffset===i.endOffset;if(-1!==t.Browser.userAgent.indexOf("Firefox")&&i.startContainer===i.endContainer&&i.startContainer===this.parent.editableElement){for(var l=i.startContainer.childNodes[i.startOffset>0?i.startOffset-1:i.startOffset]||i.startContainer,e=i.endContainer.childNodes[i.endOffset>0?i.endOffset-1:i.endOffset]||i.endContainer,u="BR"===e.lastChild.nodeName?t.isNullOrUndefined(e.lastChild.previousSibling)?e:e.lastChild.previousSibling:e.lastChild;!t.isNullOrUndefined(u)&&"#text"!==u.nodeName&&"IMG"!==u.nodeName&&"BR"!==u.nodeName&&"HR"!==u.nodeName;)u=u.lastChild;this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,l,u,0,u.textContent.length);i=this.parent.nodeSelection.getRange(this.parent.currentDocument)}for(i.startContainer===i.endContainer&&i.startContainer===this.parent.editableElement&&i.startOffset===i.endOffset&&0===i.startOffset&&0===this.parent.editableElement.textContent.length&&"TABLE"!==this.parent.editableElement.childNodes[0].nodeName&&"IMG"!==this.parent.editableElement.childNodes[0].nodeName&&(s=i.startContainer.childNodes[0],this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,s,s,0,0),i=this.parent.nodeSelection.getRange(this.parent.currentDocument)),this.saveSelection=this.parent.nodeSelection.save(i,this.parent.currentDocument),this.currentAction=n.subCommand,this.currentAction=n.subCommand="NumberFormatList"===this.currentAction?"OL":"BulletFormatList"===this.currentAction?"UL":this.currentAction,this.domNode.setMarker(this.saveSelection),r=this.domNode.blockNodes(!0),"BR"===n.enterAction&&(this.isCursorBeforeTable(i)?r=[i.startContainer.childNodes[i.startOffset]]:this.isCursorAtEndOfTable(i)?r=[i.startContainer.childNodes[i.startOffset-1]]:1===r.length&&this.isListItemWithTableChild(r[0])?r[0]=r[0].firstChild:(this.setSelectionBRConfig(),this.parent.domNode.convertToBlockNodes(this.parent.domNode.blockNodes(),!0),this.setSelectionBRConfig(),r=this.parent.domNode.blockNodes())),f=0;f<r.length;f++)"TABLE"!==r[f].tagName||i.collapsed||r.splice(f,1),r.length>0&&"LI"!==r[f].tagName&&"LI"===r[f].parentNode.tagName&&(r[f]=r[f].parentNode);this.applyLists(r,this.currentAction,n.selector,n.item,n,c);h&&i.startContainer===i.endContainer&&i.startOffset===i.endOffset&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,h,0)}n.callBack&&n.callBack({requestType:this.currentAction,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.setSelectionBRConfig=function(){var n=this.parent.editableElement.querySelector("."+e.startSelection),i=this.parent.editableElement.querySelector("."+e.endSelection);t.isNullOrUndefined(i)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,i,0,0)},n.prototype.applyLists=function(n,i,r,u,f,e){var p,o,k,w,b,y;if("Checklist"===i&&(i="UL"),this.isRevert(n,i,u,f.subCommand)&&t.isNullOrUndefined(u))this.revertList(n,f),this.removeEmptyListElements();else for(this.checkLists(n,i,u,e,f.subCommand),p="",""!==n[0].style.marginLeft&&(p=' style = "margin-left: '+n[0].style.marginLeft+';"'),o=0;o<n.length;o++)if(t.isNullOrUndefined(u)||t.isNullOrUndefined(u.listStyle)||"Checklist"===f.subCommand||("listImage"===u.listStyle?t.setStyleAttribute(n[o],{"list-style-image":u.listImage}):(t.setStyleAttribute(n[o],{"list-style-image":"none"}),k=this.formatListStyle(u.listStyle),t.setStyleAttribute(n[o],{"list-style-type":k}))),n[o].style.removeProperty("margin-left"),w="IMG"===n[o].tagName||n[o].classList.contains("e-editor-select-start")?"":this.domNode.attributes(n[o]),"true"===n[o].getAttribute("contenteditable")&&1===n[o].childNodes.length&&"TABLE"===n[o].childNodes[0].nodeName)b=document.createElement(i),b.innerHTML="<li><br/><\/li>",n[o].appendChild(b);else if("LI"!==n[o].tagName&&t.isNullOrUndefined(u)&&"BLOCKQUOTE"===n[o].nodeName){var l="<"+i+p+">",a="<\/"+i+">",v="li"+w,c=n[o].innerHTML,h=l+(y=this.domNode.createTagString(v,null,c))+a;"Checklist"===f.subCommand&&(h=this.addCheckListClass(h));n[o].innerHTML=h}else"LI"!==n[o].tagName&&t.isNullOrUndefined(u)?(l="<"+i+p+">",a="<\/"+i+">",v="li"+w,c=void 0,c=n[o].tagName.toLowerCase()===gt||"DIV"===n[o].tagName?n[o].innerHTML:n[o].outerHTML,"HR"===n[o].tagName&&n[o].firstElementChild&&"SPAN"===n[o].firstElementChild.tagName&&n[o].firstElementChild.hasAttribute("class")&&"e-editor-select-start"===n[o].firstElementChild.className&&(c=n[o].firstElementChild.outerHTML+n[o].outerHTML),y=this.domNode.createTagString(v,null,c),h=l+(y=this.setStyle(y))+a,"Checklist"===f.subCommand&&(h=this.addCheckListClass(h)),this.domNode.replaceWith(n[o],h)):t.isNullOrUndefined(u)||"LI"===n[o].tagName||(l="<"+i+("IMG"===n[o].tagName?"":this.domNode.attributes(n[o]))+">",a="<\/"+i+">",v="li",c=void 0,c=n[o].tagName.toLowerCase()===gt||"DIV"===n[o].tagName?n[o].innerHTML:n[o].outerHTML,h=l+(y=this.domNode.createTagString(v,null,c))+a,"Checklist"===f.subCommand&&(h=this.addCheckListClass(h)),this.domNode.replaceWith(n[o],h));this.cleanNode();"BR"===f.enterAction&&document.querySelectorAll("span#removeSpan").forEach(function(n){for(var t=document.createDocumentFragment();n.firstChild;)t.appendChild(n.firstChild);n.parentNode.replaceChild(t,n)});this.parent.editableElement.focus({preventScroll:!0});s()&&wr(this.parent.editableElement,r);this.saveSelection=this.domNode.saveMarker(this.saveSelection);this.saveSelection.restore()},n.prototype.addCheckListClass=function(n){var i=t.createElement("div"),r;return i.innerHTML=n,r=i.firstElementChild,this.applyCheckListClasses(r),i.innerHTML},n.prototype.applyCheckListClasses=function(n){t.addClass([n],"e-rte-checklist")},n.prototype.setStyle=function(n){var u=document.createElement("div"),i,r,f;if(u.innerHTML=n.trim(),i=u.querySelector("li"),r=i,i&&1===i.childNodes.length){for(f=function(){var n=i.firstChild,f,u;n&&(n.style.cssText||"B"===n.tagName.toUpperCase()||"STRONG"===n.tagName.toUpperCase()||"I"===n.tagName.toUpperCase()||"EM"===n.tagName.toUpperCase())&&(f=["font-size","font-family","color","font-weight"],u=n.style.cssText.split(";").map(function(n){return n.trim()}).filter(function(n){var i=t.isNullOrUndefined(n.split(":")[0])?"":n.split(":")[0].trim();return i&&-1!==f.indexOf(i)}).join(";"),u?r.style.cssText+=(r.style.cssText?";":"")+u:"B"===n.tagName.toUpperCase()||"STRONG"===n.tagName.toUpperCase()?(u="font-weight: bold;",r.style.cssText+=(r.style.cssText?";":"")+u):"I"!==n.tagName.toUpperCase()&&"EM"!==n.tagName.toUpperCase()||(u="font-style: italic;",r.style.cssText+=(r.style.cssText?";":"")+u));i=n};i&&1===i.children.length&&i.firstChild&&i.firstChild.nodeType!==Node.TEXT_NODE;)f();n=u.innerHTML}return n},n.prototype.removeEmptyListElements=function(){for(var i=this.parent.editableElement.querySelectorAll("ol, ul"),n=0;n<i.length;n++)""===i[n].textContent.trim()&&t.detach(i[n])},n.prototype.isRevert=function(n,i,r,u){for(var e=!0,f=0;f<n.length;f++){if("LI"!==n[f].tagName)return!1;(n[f].parentNode.tagName!==i||t.isNullOrUndefined(r)&&""!==n[f].parentNode.style.listStyleType||"UL"===n[f].parentNode.tagName&&n[f].parentNode.classList.contains("e-rte-checklist")&&"Checklist"!==u)&&(e=!1);n[f].parentNode.tagName===i&&""!==n[f].parentNode.style.listStyleType&&(e=!0);"UL"!==n[f].parentNode.tagName||n[f].parentNode.classList.contains("e-rte-checklist")||"Checklist"!==u||(e=!1)}return e},n.prototype.checkLists=function(n,i,r,u,f){for(var e,s=[],o=0;o<n.length;o++)e=n[o].parentNode,("LI"===n[o].tagName&&e.tagName!==i&&s.indexOf(e)<0||"LI"===n[o].tagName&&e.tagName===i&&s.indexOf(e)<0&&null!==r||"LI"===n[o].tagName&&e.tagName===i&&"Checklist"===f&&s.indexOf(e)<0||"LI"===n[o].tagName&&e.tagName===i&&"Checklist"!==f&&s.indexOf(e)<0&&e.classList.contains("e-rte-checklist"))&&s.push(e),t.isNullOrUndefined(r)&&(e.tagName===i||("UL"===e.tagName||"OL"===e.tagName)&&e.hasAttribute("style"))&&e.hasAttribute("style")&&e.removeAttribute("style");this.convertListType(n,i,s,u,r,f)},n.prototype.convertListType=function(n,t,i,r,u,f){var o=this;t="Checklist"===f?"Checklist":t;for(var h=Array.from(new Set(n.map(function(n){return n.parentNode}).filter(function(n){return"OL"===n.tagName||"UL"===n.tagName}))).reverse(),c=function(s){var c=h[s],p,k,b;if(r||"UL"!==c.tagName&&"OL"!==c.tagName){if(r)for(p=i.length-1;p>=0;p--){var g=i[p],nt="Checklist"===t?"ul":t,tt="<"+nt.toLowerCase()+" "+e.domNode.attributes(g)+">"+g.innerHTML+"<\/"+nt.toLowerCase()+">",a=document.createElement("div");if(a.innerHTML=tt,e.applyListItemStyle(a.firstChild,u),"Checklist"===f)a.innerHTML=e.addCheckListClass(a.innerHTML);else{for(k=a.querySelectorAll("li"),b=0;b<k.length;b++)e.revertChecklistItem(k[b]);a.firstElementChild&&a.firstElementChild.classList.contains("e-rte-checklist")&&(a.firstElementChild.classList.remove("e-rte-checklist"),0===a.firstElementChild.classList.length&&a.firstElementChild.removeAttribute("class"))}e.domNode.replaceWith(i[p],a.innerHTML)}}else{var d=e.parent.currentDocument.createDocumentFragment(),y=c.tagName,w=c.classList.contains("e-rte-checklist"),v="Checklist"===t,l=e.parent.currentDocument.createElement(v?"ul":t.toLowerCase());v&&e.applyCheckListClasses(l);Array.from(c.children).filter(function(n){return"LI"===n.tagName}).forEach(function(i){var r,f;-1!==n.indexOf(i)?y===(v?"ul":t.toLowerCase())&&w===v?(r=i.cloneNode(!0),l.appendChild(r)):(f=v?"UL":t,l=o.parent.currentDocument.createElement(f.toLowerCase()),y!==t||c.classList.contains("e-rte-checklist")&&"UL"===t||o.transferAttributes(c,l),v&&o.applyCheckListClasses(l),y=v?"ul":t.toLowerCase(),w=v,d.appendChild(l),r=i.cloneNode(!0),o.applyListItemStyle(l,u),l.appendChild(r)):(y===c.tagName.toLowerCase()&&w===c.classList.contains("e-rte-checklist")||(y=c.tagName.toLowerCase(),w=c.classList.contains("e-rte-checklist"),l=o.parent.currentDocument.createElement(y),w&&o.applyCheckListClasses(l),o.transferAttributes(c,l),d.appendChild(l)),l.appendChild(i.cloneNode(!0)))});c.parentNode.replaceChild(d,c)}},e=this,s=0;s<h.length;s++)c(s)},n.prototype.applyListItemStyle=function(n,i){if(!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.listStyle))if("listImage"===i.listStyle)t.setStyleAttribute(n,{"list-style-image":i.listImage});else{t.setStyleAttribute(n,{"list-style-image":"none"});var r=this.formatListStyle(i.listStyle);t.setStyleAttribute(n,{"list-style-type":r})}},n.prototype.transferAttributes=function(n,t){for(var r,i=0;i<n.attributes.length;i++)r=n.attributes[i],t.setAttribute(r.name,r.value)},n.prototype.cleanNode=function(){for(var v,a,h,u,e,o,c,l,i,s=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),f=0;f<s.length;f++){for(var n=s[f],y=!0,r=n;r.parentElement&&(!r.parentElement||"LI"===r.parentElement.tagName||"OL"===r.parentElement.tagName||"UL"===r.parentElement.tagName);)r=r.parentElement;if(!y||"OL"!==s[f].parentElement.parentElement.nodeName&&"UL"!==s[f].parentElement.parentElement.nodeName||(y=!1,v=s[f].parentElement.parentElement.style.listStyleType,a=n.previousElementSibling),this.domNode.isList(n.previousElementSibling)&&this.domNode.openTagString(n)===this.domNode.openTagString(n.previousElementSibling)){for(h=this.domNode.contents(n),u=0;u<h.length;u++)n.previousElementSibling.appendChild(h[u]);n.parentNode.removeChild(n)}else if(t.isNullOrUndefined(n.getAttribute("level"))){if(this.domNode.isList(n.previousElementSibling)&&r.contains(n.previousElementSibling)&&("OL"===n.tagName||"UL"===n.tagName)&&("OL"===n.previousElementSibling.nodeName||"UL"===n.previousElementSibling.nodeName)&&n.previousElementSibling.classList.contains("e-rte-checklist")&&n.classList.contains("e-rte-checklist")&&(!n.previousElementSibling.classList.contains("e-rte-checklist")||!n.classList.contains("e-rte-checklist"))){for(h=this.domNode.contents(n),u=0;u<h.length;u++)n.previousElementSibling.appendChild(h[u]);n.parentNode.removeChild(n)}}else n.tagName===n.previousElementSibling.tagName&&n.previousElementSibling.lastChild.append(n)}if(a)for(a.style.listStyleType=v,e=this.parent.nodeSelection.getRange(this.parent.currentDocument),o=[],"UL"===e.commonAncestorContainer.nodeName||"OL"===e.commonAncestorContainer.nodeName?(e.commonAncestorContainer instanceof Element&&o.push(e.commonAncestorContainer),o=o.concat(Array.from(e.commonAncestorContainer.querySelectorAll("ol, ul")))):o=Array.from(e.commonAncestorContainer.querySelectorAll("ol, ul")),c=0;c<o.length;c++)for(l=void 0,i=o[c];i;)"OL"!==i.nodeName&&"OL"!==i.nodeName||(""!==i.style.listStyleType&&"none"!==i.style.listStyleType&&"LI"!==i.nodeName?l=i.style.listStyleType:t.isNullOrUndefined(l)||""!==i.style.listStyleType&&"none"!==i.style.listStyleType||"LI"===i.nodeName||"UL"!==i.nodeName&&"OL"!==i.nodeName||(i.style.listStyleType=l)),i=i.querySelector("UL,OL")},n.prototype.findUnSelected=function(n,t){var r,s,h,e,a,c,u;if((n=n.slice().reverse()).length>0){var l=[],i=[],f=[],o=[];for(f=t[t.length-1].childNodes,r=0;r<f.length;r++)if(("OL"===f[r].tagName||"UL"===f[r].tagName)&&(s=f[r].querySelectorAll("li"),s.length>0))for(h=0;h<s.length;h++)o.push(s[h]);for(e=0;e<o.length;e++){for(a=0,c=0;c<n.length;c++)o[e].contains(n[c])||(a+=1);a===n.length&&i.push(o[e])}if(i.length>0)for(u=0;u<i.length;u++)"OL"!==this.domNode.contents(i[u])[0].nodeName&&"UL"!==this.domNode.contents(i[u])[0].nodeName&&l.push(i[u]);l.length>0&&this.nestedList(l)}},n.prototype.revertChecklistItem=function(n){n&&n.parentElement&&n.parentElement.classList.contains("e-rte-checklist")&&n.parentElement.classList.remove("e-rte-checklist")},n.prototype.revertList=function(n,i){for(var a,v,r,f,s,h,tt,it,rt,ot,y,ht,c,o,b,k,l,p,ft,et,w=[],u=n.length-1;u>=0;u--)for(a=u-1;a>=0;a--)if(n[a].contains(n[u])||n[a]===n[u]){w.push(n[u]);n.splice(u,1);break}for(this.findUnSelected(w,n),v=[],u=0;u<n.length;u++){if(r=n[u],3===this.domNode.contents(r)[0].nodeType&&0===this.domNode.contents(r)[0].textContent.trim().length&&t.detach(this.domNode.contents(r)[0]),f=n[u].parentNode,s=r.getAttribute("class"),0===w.length&&(h=n[u].querySelectorAll("ul, ol")[0],h&&h.querySelectorAll("li")&&(tt=t.createElement(h.tagName),t.append([tt],h.parentNode),it=t.createElement("li",{styles:"list-style-type: none;"}),t.append([it],tt),t.append([h],it))),r.parentNode.insertBefore(this.closeTag(f.tagName),r),"LI"===f.parentNode.tagName||"OL"===f.parentNode.tagName||"UL"===f.parentNode.tagName)r.parentNode.insertBefore(this.closeTag("LI"),r);else{if(rt=this.getClosestListParentMargin(r),gt&&0===r.querySelectorAll(bt.join(", ")).length){ot=t.isNullOrUndefined(s)?' class="e-rte-wrap-inner"':' class="'+s+' e-rte-wrap-inner"';y=f;n.length===y.querySelectorAll("li").length&&(t.isNullOrUndefined(y.style.listStyleType)||f.style.removeProperty("list-style-type"),t.isNullOrUndefined(y.style.listStyleImage)||f.style.removeProperty("list-style-image"),0===y.style.length&&f.removeAttribute("style"));var st=t.isNullOrUndefined(i.enterAction)?gt:i.enterAction,lt="<"+st+ot+this.domNode.attributes(r)+"><\/"+st+">",ut=document.createElement("div");(ut.innerHTML=lt,""!==rt&&(ut.firstElementChild.style.marginLeft=rt),"BR"!==i.enterAction)?this.domNode.wrapInner(r,this.domNode.parseHTMLFragment(ut.innerHTML)):""!==r.textContent&&(ht=document.createElement("br"),this.domNode.wrapInner(r,this.domNode.parseHTMLFragment("<span class=e-rte-wrap-inner id=removeSpan><\/span>")),r.appendChild(ht))}else if(3===this.domNode.contents(r)[0].nodeType)c=this.domNode.createTagString(gt,f,this.parent.domNode.encode(this.domNode.contents(r)[0].textContent)),this.domNode.replaceWith(this.domNode.contents(r)[0],c);else if(this.domNode.contents(r)[0].classList.contains(e.startSelection)||this.domNode.contents(r)[0].classList.contains(e.endSelection))c=this.domNode.createTagString(gt,f,"<br>"+this.domNode.contents(r)[0].outerHTML),this.domNode.contents(r)[1]&&"BR"===this.domNode.contents(r)[1].tagName?(this.domNode.contents(r)[1].remove(),c=this.domNode.createTagString(gt,f,"<br>"+this.domNode.contents(r)[0].outerHTML)):c=this.domNode.createTagString(gt,f,this.domNode.contents(r)[0].outerHTML),this.domNode.replaceWith(this.domNode.contents(r)[0],c);else{if(o=r.firstChild,o&&(b=r.parentElement.attributes,b.length>0))for(k=0;k<b.length;k++){var d=b[k],ct=function(n){return n?n.split(";").filter(function(n){return!/list-style-(image|type):/.test(n.trim())}).join(";").trim():""},g=ct(o.getAttribute(d.nodeName)),nt=ct(r.parentElement.getAttribute(d.nodeName));g&&g!==nt?o.setAttribute(d.nodeName,g?nt+" "+g:nt):o.setAttribute(d.nodeName,nt);0===o.style.length&&o.removeAttribute("style")}(s=o.getAttribute("class"))&&o.getAttribute("class")&&s!==o.getAttribute("class")&&t.attributes(o,{"class":s+" "+o.getAttribute("class")})}t.append([this.openTag("LI")],r);t.prepend([this.closeTag("LI")],r)}this.domNode.insertAfter(this.openTag(f.tagName),r);"LI"===f.parentNode.tagName&&(f=f.parentNode.parentNode);v.indexOf(f)<0&&v.push(f)}for(u=0;u<v.length;u++)l=v[u],p=l.innerHTML,p=(p=p.replace(/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,"<\/$1>")).replace(/<span class="e-rte-list-open-([a-z]*)"><\/span>/g,"<$1 "+this.domNode.attributes(l)+">"),this.domNode.replaceWith(l,this.domNode.openTagString(l)+p.trim()+this.domNode.closeTagString(l));for(ft=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),u=0;u<ft.length;u++)t.detach(ft[u]);for(et=this.parent.editableElement.querySelectorAll("li:empty"),u=0;u<et.length;u++)t.detach(et[u]);this.revertCheckListClasses()},n.prototype.revertCheckListClasses=function(){var n=this.parent.editableElement;n.querySelectorAll(".e-rte-checklist").forEach(function(n){"UL"!==n.nodeName&&n.classList.contains("e-rte-checklist")&&(t.removeClass([n],["e-rte-checklist"]),""===n.getAttribute("class")&&n.removeAttribute("class"))});n.querySelectorAll(".e-rte-checklist-checked").forEach(function(n){"LI"!==n.nodeName&&(t.removeClass([n],["e-rte-checklist-checked"]),""===n.getAttribute("class")&&n.removeAttribute("class"))})},n.prototype.getClosestListParentMargin=function(n){for(var t=n;t&&t!==this.parent.editableElement;){if("UL"===t.nodeName||"OL"===t.nodeName)return t.style.marginLeft;t=t.parentElement}return""},n.prototype.openTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+n.toLowerCase()+'"><\/span>')},n.prototype.closeTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+n.toLowerCase()+'"><\/span>')},n.prototype.destroy=function(){this.removeEventListener();this.domNode&&(this.domNode=null)},n.prototype.areAllListItemsSelected=function(n,t){for(var u,r=n.querySelectorAll("li"),i=0;i<r.length;i++)if(u=r[i],this.parent.currentDocument.createRange().selectNodeContents(u),!t.intersectsNode(u))return!1;return!0},n.prototype.getListCursorInfo=function(n){var u,f,h=new hu(this.parent.editableElement),t=n.startContainer.nodeType===Node.TEXT_NODE?h.getTopMostNode(n.startContainer):n.startContainer,e=n.endContainer.nodeType===Node.TEXT_NODE?h.getTopMostNode(n.endContainer):n.endContainer,c=!n.collapsed,i=t.nodeType===Node.TEXT_NODE?t.parentElement.closest("li"):t.closest("li"),o=e.nodeType===Node.TEXT_NODE?e.parentElement.closest("li"):e.closest("li"),r=!(!i||!i.closest("ol, ul"))&&this.checkIsNestedList(i.closest("ol, ul")),l=!(!o||!o.closest("ol, ul"))&&this.checkIsNestedList(o.closest("ol, ul")),s=this.parent.domNode.blockNodes(),a=s.length,v=this.getListSelectionType(r?"Nested":"Parent",l?"Nested":"Parent");return c?(f=1===s.length?0===n.startOffset&&n.endOffset===i.textContent.length?"SingleFull":"SinglePartial":0===n.startOffset&&n.endOffset===s[a-1].textContent.length?"MultipleFull":"MultiplePartial",u="None"):(u=0===n.startOffset&&null===t.previousSibling?r?"StartNested":"StartParent":n.startOffset===i.textContent.length&&null===t.nextSibling?r?"EndNested":"EndParent":r?"MiddleNested":"MiddleParent",f="None"),{position:u,selectionState:f,itemType:v}},n.prototype.checkIsNestedList=function(n){return!(n.parentElement===this.parent.editableElement||!n.closest("li"))},n.prototype.getListSelectionType=function(n,t){return"Nested"===n&&"Nested"===t?"Nested":"Parent"===n&&"Parent"===t?"Parent":"Mixed"},n.prototype.isAllListNodesSelected=function(n){for(var u=this.parent.currentDocument.getSelection(),t=!1,r=n.querySelectorAll("li"),i=0;i<r.length;i++){if(!u.containsNode(r[i],!1)){t=!1;break}t=!0}return t},n.prototype.formatListStyle=function(n){var t=/^(lower|upper)(greek|alpha|roman)$/i;return t.test(n)?n.replace(t,function(n,t,i){return t+"-"+i}).toLowerCase():n.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()},n}(),lit=function(){function n(n){this.blockquotePrevent=!1;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(du,this.applyFormats,this);this.parent.observer.on(ei,this.onKeyUp,this);this.parent.observer.on(c,this.onKeyDown,this);this.parent.observer.on(stt,this.blockQuotesHandled,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(du,this.applyFormats);this.parent.observer.off(ei,this.onKeyUp);this.parent.observer.off(c,this.onKeyDown);this.parent.observer.off(f,this.destroy)},n.prototype.getParentNode=function(n){for(var i=n,t=["DIV","SECTION","ARTICLE","ASIDE","FOOTER","HEADER","NAV","MAIN"];n.parentNode&&n.parentNode!==this.parent.editableElement;null)n=n.parentNode;if(-1!==t.indexOf(n.nodeName.toUpperCase()))for(n=i;-1===t.indexOf(n.nodeName.toUpperCase())&&-1===t.indexOf(n.parentNode.nodeName.toUpperCase());)n=n.parentNode;return n},n.prototype.blockQuotesHandled=function(){this.blockquotePrevent=!0},n.prototype.onKeyUp=function(n){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),e=i.endContainer,u=e.lastChild,f,r;13===n.event.which&&i.startContainer===e&&3!==e.nodeType&&(((r=t.createElement("p")).innerHTML="<br>",!t.isNullOrUndefined(u)&&u&&"BR"===u.nodeName&&u.previousSibling&&"TABLE"===u.previousSibling.nodeName)?(e.replaceChild(r,u),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0)):(f=this.parent.nodeSelection.getSelectionNodeCollectionBr(i)[0],!t.isNullOrUndefined(f)&&"BR"===f.nodeName&&f.previousSibling&&"TABLE"===f.previousSibling.nodeName&&(e.replaceChild(r,f),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0))));"BR"!==n.enterAction&&!t.isNullOrUndefined(i.startContainer)&&!t.isNullOrUndefined(i.startContainer.parentElement)&&i.startContainer===i.endContainer&&"#text"===i.startContainer.nodeName&&i.startContainer.parentElement.classList.contains("e-content")&&i.startContainer.parentElement.isContentEditable&&(r=t.createElement(n.enterAction),i.startContainer.parentElement.insertBefore(r,i.startContainer),r.appendChild(i.startContainer),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,1))},n.prototype.getBlockParent=function(n,t){for(var i=n;n!==t;)i=n,n=n.parentElement;return i},n.prototype.onKeyDown=function(n){if(13===n.event.which&&!this.blockquotePrevent){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),h=0===i.startContainer.textContent.length||"PRE"===i.startContainer.nodeName?i.startContainer:i.startContainer.parentElement,f=0===i.endContainer.textContent.length||"PRE"===i.endContainer.nodeName?i.endContainer:i.endContainer.parentElement,u=t.closest(h,"pre"),e=t.closest(f,"pre"),o=t.closest(h,"blockquote"),c=t.closest(f,"blockquote");if(!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u.parentElement)&&"LI"===u.parentElement.tagName)return;if((t.isNullOrUndefined(u)&&!t.isNullOrUndefined(e)||!t.isNullOrUndefined(u)&&t.isNullOrUndefined(e))&&(n.event.preventDefault(),this.deleteContent(i),this.removeCodeContent(i),i=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0)),13===n.event.which&&(!t.isNullOrUndefined(o)&&!t.isNullOrUndefined(c)||!t.isNullOrUndefined(o)&&t.isNullOrUndefined(c))&&(8203===(r=this.getBlockParent(i.startContainer,o)).textContent.charCodeAt(0)&&1===r.textContent.length||0===r.textContent.length&&0===r.querySelectorAll("img").length&&0===r.querySelectorAll("table").length)&&(n.event.preventDefault(),t.isNullOrUndefined(r.nextElementSibling)||(new su).SplitNode(i,r.parentElement,!1).cloneNode(!0),this.paraFocus(r.parentElement===this.parent.editableElement?r:r.parentElement)),13===n.event.which&&!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(e)){n.event.preventDefault();this.deleteContent(i);this.removeCodeContent(i);var s=(i=this.parent.nodeSelection.getRange(this.parent.currentDocument)).startContainer.childNodes[i.endOffset],l=i.startContainer.childNodes[i.endOffset-1],r=i.startContainer;if(t.isNullOrUndefined(s)||t.isNullOrUndefined(l)||!t.isNullOrUndefined(s.nextSibling)||"BR"!==s.nodeName||"BR"!==l.nodeName)if(8203===r.textContent.charCodeAt(0)&&1===r.textContent.length||0===r.textContent.length){for(;"PRE"!==r.parentElement.nodeName&&(1===r.textContent.length||0===r.textContent.length);)r=r.parentElement;!t.isNullOrUndefined(r.previousSibling)&&"BR"===r.previousSibling.nodeName&&t.isNullOrUndefined(r.nextSibling)?this.paraFocus(r.parentElement):this.isNotEndCursor(u,i)}else this.isNotEndCursor(u,i);else this.paraFocus(i.startContainer,n.enterAction)}}this.blockquotePrevent=!1},n.prototype.removeCodeContent=function(n){var i=new RegExp("﻿","g"),r;t.isNullOrUndefined(n.endContainer.textContent.match(i))||(r=65279===n.endContainer.textContent.charCodeAt(n.endOffset-1)?n.endOffset-2:n.endOffset,n.endContainer.textContent=n.endContainer.textContent.replace(i,""),""===n.endContainer.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer,r))},n.prototype.deleteContent=function(n){n.startContainer===n.endContainer&&n.startOffset===n.endOffset||n.deleteContents()},n.prototype.paraFocus=function(n,i){var r;"DIV"===i?(r=t.createElement("div")).innerHTML="<br>":"BR"===i?r=t.createElement("br"):(r=t.createElement("p")).innerHTML="<br>";this.parent.domNode.insertAfter(r,n);this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0);t.detach(n.lastChild)},n.prototype.isNotEndCursor=function(n,i){var e=new su,o=i.startOffset===n.lastChild.textContent.length&&n.lastChild.textContent===i.startContainer.textContent,u,f,r;0===n.textContent.indexOf(i.startContainer.textContent)&&(0===i.startOffset&&0===i.endOffset||"PRE"===i.startContainer.nodeName)?(this.insertMarker(n,i),u=t.createElement("br"),n.childNodes[i.endOffset].parentElement.insertBefore(u,n.childNodes[i.endOffset])):(f=e.SplitNode(i,n,!0),this.insertMarker(n,i),r=n.previousElementSibling,"PRE"===r.tagName&&(r.insertAdjacentHTML("beforeend","<br>"+f.innerHTML),t.detach(n)));this.setCursorPosition(o,n)},n.prototype.setCursorPosition=function(n,i){var u=!1,r=this.parent.editableElement.querySelector(".tempSpan"),f=r.parentElement,e;(""===r.parentNode.textContent?u=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),n)?u?f===i?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),t.detach(r)):this.focusSelectionParent(r,f):(e=t.createElement("br"),this.parent.domNode.insertAfter(e,r),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),t.detach(r)):u?this.focusSelectionParent(r,f):t.detach(r)},n.prototype.focusSelectionParent=function(n,i){t.detach(n);i.innerHTML="​";this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0)},n.prototype.insertMarker=function(n,i){var r=t.createElement("span",{className:"tempSpan"});"PRE"===i.startContainer.nodeName?n.childNodes[i.endOffset].parentElement.insertBefore(r,n.childNodes[i.endOffset]):i.startContainer.parentElement.insertBefore(r,i.startContainer)},n.prototype.applyFormats=function(n){var k=this.parent.nodeSelection.getRange(this.parent.currentDocument),l=this.parent.nodeSelection.processedTableImageCursor(k),ct,p,r,i,f,lt,h,o,a,v,rt,at,d,u,g,w,vt,wt,tt,kt,ei,c,y,b,ft,it,et,ht,dt,oi;if((l.start||l.end)&&"blockquote"!==n.subCommand.toLowerCase()&&("TABLE"===l.startName||"TABLE"===l.endName))oi=l.start?l.startNode:l.endNode,this.applyTableSidesFormat(n,l.start,oi);else{if(ct=!1,this.parent.editableElement!==k.endContainer||t.isNullOrUndefined(this.parent.editableElement.children[k.endOffset-1])||"TABLE"!==this.parent.editableElement.children[k.endOffset-1].tagName||k.collapsed||(ct=!0),p=this.parent.nodeSelection.save(k,this.parent.currentDocument),this.parent.domNode.setMarker(p),r=this.parent.domNode.blockNodes(!0),"BR"===n.enterAction){this.setSelectionBRConfig();var si=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),ot=this.parent.nodeSelection.getSelectionNodes(si),st=[];for(0===ot.length&&ot.push(r[0]),i=0;i<ot.length;i++){for(f=ot[i],lt=void 0;!this.parent.domNode.isBlockNode(f)&&f!==this.parent.editableElement;)lt=f,f=f.parentElement;this.parent.domNode.isBlockNode(f)&&f===this.parent.editableElement&&st.push(lt)}for(i=0;i<st.length;i++)if(!this.parent.domNode.isBlockNode(st[i])){for(h=f=st[i];f===this.parent.editableElement;)h=f,f=f.parentElement;for(o=void 0,this.parent.domNode.isBlockNode(h.parentElement)&&h.parentElement===this.parent.editableElement?(o=t.createElement("div"),h.parentElement.insertBefore(o,h),o.appendChild(h),0===h.textContent.length&&h.appendChild(t.createElement("br"))):o=h,a=o.previousSibling;!t.isNullOrUndefined(a)&&"BR"!==a.nodeName&&!this.parent.domNode.isBlockNode(a);)o.firstChild.parentElement.insertBefore(a,o.firstChild),a=o.previousSibling;for(t.isNullOrUndefined(a)||"BR"!==a.nodeName||t.detach(a),v=o.nextSibling;!t.isNullOrUndefined(v)&&"BR"!==v.nodeName&&!this.parent.domNode.isBlockNode(v);)o.appendChild(v),v=o.nextSibling;t.isNullOrUndefined(v)||"BR"!==v.nodeName||t.detach(v)}this.setSelectionBRConfig();r=this.parent.domNode.blockNodes()}for(rt=!1,at=!1,i=0;i<r.length;i++)(t.isNullOrUndefined(t.closest(r[0],"blockquote"))||t.isNullOrUndefined(t.closest(r[r.length-1],"blockquote")))&&(at=!0);for(d=!1,i=0;i<r.length;i++)if(u=void 0,g=void 0,"HR"!==r[i].nodeName&&("blockquote"===n.subCommand.toLowerCase()?(u=this.getParentNode(r[i]),g="BR"===n.enterAction?u.innerHTML:!t.isNullOrUndefined(t.closest(r[i],"table"))&&this.parent.editableElement.contains(t.closest(r[i],"table"))?t.isNullOrUndefined(t.closest(r[i],"blockquote"))?r[i].outerHTML:t.closest(r[i],"blockquote").outerHTML:u.outerHTML):(w=r[i],g=w&&"PRE"===w.tagName&&w.firstChild&&"CODE"===w.firstChild.nodeName&&w.hasAttribute("data-language")?(u=w).querySelector("code").innerHTML:(u=w).innerHTML),vt="PRE"===u.tagName&&u.firstChild&&"CODE"===u.firstChild.nodeName&&u.hasAttribute("data-language"),vt||!("blockquote"===n.subCommand.toLowerCase()&&n.subCommand.toLowerCase()===u.tagName.toLowerCase()&&at||n.subCommand.toLowerCase()===u.tagName.toLowerCase()&&("pre"!==n.subCommand.toLowerCase()&&"blockquote"!==n.subCommand.toLowerCase()||!t.isNullOrUndefined(n.exeValue)&&"dropDownSelect"===n.exeValue.name)||t.isNullOrUndefined(u.parentNode)||"TABLE"===u.tagName&&"pre"===n.subCommand.toLowerCase()))){this.cleanFormats(u,n.subCommand);var yt="pre"!==n.subCommand.toLowerCase()||"pre"!==u.tagName.toLowerCase()||vt?n.subCommand:"p",hi=n.subCommand.toLowerCase()===u.tagName.toLowerCase()&&"blockquote"===n.subCommand.toLowerCase()&&!t.isNullOrUndefined(t.closest(r[i],"li")),ci="TABLE"===u.tagName?t.isNullOrUndefined(t.closest(r[i],"blockquote"))?u:t.closest(r[i],"blockquote"):u;d=n.subCommand.toLowerCase()===ci.tagName.toLowerCase()&&"blockquote"===n.subCommand.toLowerCase();var nt=void 0,gt=this.getNode(r[i]),ni=this.getNode(r[r.length-1]);if((t.isNullOrUndefined(t.closest(r[i],"table"))||t.isNullOrUndefined(t.closest(r[i],"td"))&&t.isNullOrUndefined(t.closest(r[i],"th"))?d&&u.firstChild===gt&&u.lastChild===ni:this.hasOnlyBlockquotes(t.closest(r[i],"td")||t.closest(r[i],"th")))?nt=g.replace(/<blockquote[^>]*>|<\/blockquote>/g,""):hi?(rt=!0,0===i&&this.createBlockquoteSpan("e-rte-blockquote-close",gt,"before"),i===r.length-1&&this.createBlockquoteSpan("e-rte-blockquote-open",ni,"after")):d&&t.closest(r[0],"blockquote")&&t.closest(r[r.length-1],"blockquote")?(rt=!0,0===i&&this.createBlockquoteSpan("e-rte-blockquote-close",r[i],"before"),i===r.length-1&&this.createBlockquoteSpan("e-rte-blockquote-open",r[i],"after")):nt=u&&"PRE"===u.tagName&&u.firstChild&&"CODE"===u.firstChild.nodeName&&u.hasAttribute("data-language")?this.parent.domNode.createTagString(yt,null,g.replace(/>\s+</g,"><")):this.parent.domNode.createTagString(yt,"blockquote"===n.subCommand.toLowerCase()?null:u,g.replace(/>\s+</g,"><")),"LI"===u.tagName){for(var ti=u.firstChild,ii=[],ri=!1,pt=0,ui=Array.from(u.childNodes);pt<ui.length;pt++)wt=(tt=ui[pt]).nodeName.toLowerCase(),"ul"===wt||"ol"===wt?ri=!0:ii.push(tt);if(ri){for(var ut=document.createElement("div"),bt=0,fi=ii;bt<fi.length;bt++)tt=fi[bt],ut.appendChild(tt.cloneNode(!0)),ti!==tt&&u.removeChild(tt);r[i+1]&&r[i+1].textContent===ut.textContent&&(ut=r[i+1]);nt=this.parent.domNode.createTagString(yt,"blockquote"===n.subCommand.toLowerCase()?null:ut,ut.innerHTML.replace(/>\s+</g,"><"));kt=document.createElement("div");kt.innerHTML=nt;u.replaceChild(kt.firstChild,ti)}else u.innerHTML="",u.insertAdjacentHTML("beforeend",nt)}else rt||(ei=!t.isNullOrUndefined(t.closest(r[i],"table"))&&this.parent.editableElement.contains(t.closest(r[i],"table"))?t.isNullOrUndefined(t.closest(r[i],"blockquote"))?r[i]:t.closest(r[i],"blockquote"):u,this.parent.domNode.replaceWith(ei,nt))}if(rt)for(c=this.parent.editableElement.querySelectorAll(".e-rte-blockquote-open, .e-rte-blockquote-close"),i=0;i<c.length;i++){if(y=c[i].parentElement,b=y.innerHTML,b=(b=b.replace(/<span class="e-rte-blockquote-open"><\/span>/g,"<blockquote>")).replace(/<span class="e-rte-blockquote-close"><\/span>/g,"<\/blockquote>"),c[0].parentElement===c[1].parentElement){this.parent.domNode.replaceWith(y,this.parent.domNode.openTagString(y)+b.trim()+this.parent.domNode.closeTagString(y));break}i!==c.length-1||t.isNullOrUndefined(c[i])||t.isNullOrUndefined(c[i-1])||c[i].parentElement===c[i-1].parentElement?this.parent.domNode.replaceWith(y,this.parent.domNode.openTagString(y)+b.trim()+this.parent.domNode.closeTagString(y)):this.parent.domNode.replaceWith(y,b.trim())}this.preFormatMerge();this.blockquotesFormatMerge(n.enterAction);ft=this.parent.editableElement.querySelector("."+e.startSelection);it=this.parent.editableElement.querySelector("."+e.endSelection);(t.isNullOrUndefined(ft)||t.isNullOrUndefined(it)||(ft=ft.lastChild,it=it.lastChild),p=this.parent.domNode.saveMarker(p),s()&&wr(this.parent.editableElement,n.selector),ct)?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,ft,it,0,it.textContent.length):l.start&&"blockquote"===n.subCommand.toLowerCase()?(et=p.range.startContainer.childNodes[d?p.range.startOffset-1:p.range.startOffset],d?(ht=et.parentElement,dt=Array.prototype.indexOf.call(ht.childNodes,et),this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,ht,ht,dt,dt)):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,et,et,0,0)):p.restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})}},n.prototype.hasOnlyBlockquotes=function(n){for(var t,r=!1,i=0;i<n.childNodes.length;i++)if(t=n.childNodes[i],t.nodeType===Node.TEXT_NODE){if(""!==t.textContent.replace(/[\u200B\u200C\u200D]/g,"").trim())return!1}else if(t.nodeType===Node.ELEMENT_NODE){if("BLOCKQUOTE"!==t.tagName)return!1;r=!0}return r},n.prototype.getNode=function(n){if("BLOCKQUOTE"===n.nodeName)return n.firstChild;for(;n.parentNode&&"BLOCKQUOTE"!==n.parentNode.nodeName;null)n=n.parentNode;return n},n.prototype.createBlockquoteSpan=function(n,i,r){var u=t.createElement("span");return u.classList.add(n),"before"===r?i.parentNode.insertBefore(u,i):this.parent.domNode.insertAfter(u,i),u},n.prototype.setSelectionBRConfig=function(){var n=this.parent.editableElement.querySelector("."+e.startSelection),i=this.parent.editableElement.querySelector("."+e.endSelection);t.isNullOrUndefined(i)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,i,0,0)},n.prototype.preFormatMerge=function(){var i=this.parent.editableElement.querySelectorAll("PRE:not([data-language])"),n,r;if(!t.isNullOrUndefined(i))for(n=0;n<i.length;n++)r=i[n].previousElementSibling,t.isNullOrUndefined(r)||"PRE"!==r.tagName||(r.insertAdjacentHTML("beforeend","<br>"+i[n].innerHTML),t.detach(i[n]))},n.prototype.blockquotesFormatMerge=function(n){var r=this.parent.editableElement.querySelectorAll("BLOCKQUOTE"),i,u;if(!t.isNullOrUndefined(r))for(i=0;i<r.length;i++)""===r[i].innerHTML.trim()&&t.detach(r[i]),u=r[i].previousElementSibling,t.isNullOrUndefined(u)||"BLOCKQUOTE"!==u.tagName||(u.insertAdjacentHTML("beforeend",("BR"===n?"<br>":"")+r[i].innerHTML),t.detach(r[i]))},n.prototype.cleanFormats=function(n,t){var r=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"],i;for(t=t.toLowerCase(),i=0;i<r.length&&"p"!==t&&"blockquote"!==t&&"pre"!==t;i++)n.style.removeProperty(r[i])},n.prototype.applyTableSidesFormat=function(n,i,r){var u=t.createElement(n.subCommand);"BR"!==n.enterAction&&u.appendChild(t.createElement("br"));r.insertAdjacentElement(i?"beforebegin":"afterend",u);this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,u,0);n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.destroy=function(){this.removeEventListener()},n}(),ait=function(){function n(n){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"};this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(dy,this.applyAlignment,this);this.parent.observer.on(c,this.onKeyDown,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(dy,this.applyAlignment);this.parent.observer.off(c,this.onKeyDown);this.parent.observer.off(f,this.destroy)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:n.callBack});n.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:n.callBack});n.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:n.callBack});n.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:n.callBack});n.event.preventDefault()}},n.prototype.getTableNode=function(n){var i=n.startContainer.nodeType===Node.ELEMENT_NODE?n.startContainer:n.startContainer.parentNode;return[t.closest(i,"td,th")]},n.prototype.applyAlignment=function(n){var c="Table"===n.value,e=this.parent.nodeSelection.getRange(this.parent.currentDocument),u=this.parent.nodeSelection.save(e,this.parent.currentDocument),f,r,i,l,o,h;if(c)if(f=this.parent.editableElement.querySelectorAll(".e-cell-select"),f.length>0)for(i=0;i<f.length;i++)t.setStyleAttribute(f[i],{"text-align":this.alignments[n.subCommand]});else t.setStyleAttribute(this.getTableNode(e)[0],{"text-align":this.alignments[n.subCommand]});else{for(this.parent.domNode.setMarker(u),r=this.parent.domNode.blockNodes(),"BR"===n.enterAction&&(r=this.parent.domNode.convertToBlockNodes(r,!1)),i=0;i<r.length;i++)l=r[i],t.setStyleAttribute(l,{"text-align":this.alignments[n.subCommand]});for(o=this.parent.domNode.getImageTagInSelection(),i=0;i<o.length;i++)h=[],h.push(o[i]),this.parent.imgObj.imageCommand({item:{selectNode:h},subCommand:n.subCommand,value:n.subCommand,callBack:n.callBack,selector:n.selector});this.parent.editableElement.focus({preventScroll:!0});u=this.parent.domNode.saveMarker(u);s()&&wr(this.parent.editableElement,n.selector);u.restore()}n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:c?this.getTableNode(e):this.parent.domNode.blockNodes()})},n.prototype.destroy=function(){this.removeEventListener()},n}(),vit=function(){function n(n){this.indentValue=20;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(gy,this.applyIndents,this);this.parent.observer.on(c,this.onKeyDown,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(gy,this.applyIndents);this.parent.observer.off(c,this.onKeyDown);this.parent.observer.off(f,this.destroy)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:n.callBack});n.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:n.callBack});n.event.preventDefault()}},n.prototype.applyIndents=function(n){var a=this.parent.editableElement,v=a.classList.contains("e-rtl"),h=this.parent.nodeSelection.getRange(this.parent.currentDocument),l,i;if(t.isNullOrUndefined(this.parent.codeBlockObj)||!this.parent.codeBlockObj.isSelectionWithinCodeBlock(h,h.startContainer,h.endContainer)){l=this.parent.nodeSelection.save(h,this.parent.currentDocument);this.parent.domNode.setMarker(l);i=this.parent.domNode.blockNodes();"BR"===n.enterAction&&(i=this.parent.domNode.convertToBlockNodes(i,!1));for(var u=i.slice(),y=[],r=0;r<u.length;r++)"LI"!==u[r].tagName&&"LI"===u[r].parentNode.tagName?(i.splice(i.indexOf(u[r]),1),y.push(u[r].parentNode)):"LI"===u[r].tagName&&(i.splice(i.indexOf(u[r]),1),y.push(u[r]));for(y.length>0&&this.parent.observer.notify(c,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:"Indent"!==n.subCommand,which:9,action:"indent"}}),r=0;r<i.length;r++){var f=i[r],e=v?f.style.marginRight:f.style.marginLeft,o=void 0;"HR"!==f.tagName&&("Indent"===n.subCommand?(o=""===e?this.indentValue+"px":parseInt(e,null)+this.indentValue+"px",v?f.style.marginRight=o:f.style.marginLeft=o):(o=""===e||"0px"===e||"0in"===e?"":parseInt(e,null)-this.indentValue<0?"0px":parseInt(e,null)-this.indentValue+"px",v?f.style.marginRight=o:f.style.marginLeft=o))}a.focus({preventScroll:!0});s()&&wr(a,n.selector);(0===i.length||i[0]&&"TABLE"!==i[0].nodeName)&&(l=this.parent.domNode.saveMarker(l)).restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})}else this.parent.observer.notify(pv,{e:n,event:n.event,subCommand:n.subCommand,callBack:n.callBack})},n.prototype.destroy=function(){this.removeEventListener()},n}(),sh=function(){function n(n,t){this.userAgent=n;this.isTesting=t}return n.prototype.getPlatform=function(){return!this.isTesting&&window.navigator.userAgentData?window.navigator.userAgentData.platform:/windows/i.test(this.userAgent)?"Windows":/macintosh|mac os/i.test(this.userAgent)&&!/iphone|ipad|ipod/i.test(this.userAgent)?"macOS":/linux/i.test(this.userAgent)&&!/android/i.test(this.userAgent)?"Linux":/iphone|ipad|ipod/i.test(this.userAgent)?"iOS":/android/i.test(this.userAgent)?"Android":"Unknown"},n.prototype.getBrowser=function(){var n,t,i;if(!this.isTesting&&window.navigator.userAgentData)for(n=0,t=window.navigator.userAgentData.brands;n<t.length;n++){if(i=t[n],"Google Chrome"===i.brand)return"Chrome";if("Microsoft Edge"===i.brand)return"Edge"}return/chrome|chromium|crios/i.test(this.userAgent)&&!/edg/i.test(this.userAgent)?"Chrome":/firefox|fxios/i.test(this.userAgent)&&!/edg/i.test(this.userAgent)?"Firefox":/safari/i.test(this.userAgent)&&!/chrome|chromium|crios/i.test(this.userAgent)?"Safari":/edg/i.test(this.userAgent)?"Edge":"Unknown"},n.prototype.isMobileDevice=function(){return!this.isTesting&&window.navigator.userAgentData?window.navigator.userAgentData.mobile:/(iphone|ipod|ipad|android|blackberry|bb|playbook|windows phone|webos|opera mini|mobile)/i.test(this.userAgent)},n.prototype.isSafari=function(){var n=this.getPlatform();return"Safari"===this.getBrowser()&&("macOS"===n||"iOS"===n)},n}(),fp=function(){function n(){}return n.applyFormat=function(i,r,u,f,e,o,h,c){var pt,ot,p,nt,wt,k,vt,tt,ft,et,y,w;if(this.enterAction=f,["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor","inlinecode"].indexOf(r)>-1||"formatPainter"===o){"backgroundcolor"===r&&""===o&&(o="transparent");var v=new st(u),yt=new oh(u,i),g=new su,it=new yi,l=v.getRange(i);if(l.collapsed&&l.startContainer===l.endContainer&&l.startContainer===v.editableElement&&!t.isNullOrUndefined(l.startContainer.firstChild)&&(pt=i.createRange(),l.setStart(l.startContainer.firstChild,0),l.collapse(!0),v.setRange(i,pt)),ot=0,p=l.startContainer.parentElement,l.collapsed&&!t.isNullOrUndefined(p)&&"A"===p.tagName&&(l.startOffset===p.textContent.length||0===l.startOffset)&&(nt=document.createTextNode(""),0===l.startOffset?p.parentNode.insertBefore(nt,p):t.isNullOrUndefined(p.nextSibling)?p.parentNode.appendChild(nt):p.parentElement.insertBefore(nt,p.nextSibling),wt=i.createRange(),l.setStart(nt,0),l.setEnd(nt,0),l.collapse(!0),v.setRange(i,wt)),-1!==t.Browser.userAgent.indexOf("Firefox")&&l.startContainer===l.endContainer&&!t.isNullOrUndefined(u)&&l.startContainer===u){for(var kt=l.startContainer.childNodes[l.startOffset>0?l.startOffset-1:l.startOffset]||l.startContainer,rt=l.endContainer.childNodes[l.endOffset>0?l.endOffset-1:l.endOffset]||l.endContainer,b="BR"===rt.lastChild.nodeName?t.isNullOrUndefined(rt.lastChild.previousSibling)?rt:rt.lastChild.previousSibling:rt.firstChild;!t.isNullOrUndefined(b)&&"#text"!==b.nodeName&&"IMG"!==b.nodeName&&"BR"!==b.nodeName&&"HR"!==b.nodeName;)b=b.lastChild;v.setSelectionText(i,kt,b,0,0);l=v.getRange(i)}var dt=v.save(l,i),a=void 0,d=!1;u&&e&&"#text"!==u.nodeName&&(a=e.getTextNodes());a&&a.length>0?d=!0:a=l.collapsed?v.getSelectionNodeCollection(l):v.getSelectionNodeCollectionBr(l);var ht,ct=!1,ut=!1,lt=!1,at=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(r)>-1,bt=!1;for((n.userAgentData.isSafari()&&a.length>0&&(bt="None"!==n.isMentionStartOrEnd(u,a[0],a[a.length-1])),!d&&l.collapsed)&&(k=it.getFormattedNode(l.startContainer,r,u),vt=t.isNullOrUndefined(k)?null:null===k.getAttribute("style")?k.nodeName:k.nodeName+"[style='"+k.getAttribute("style")+"']",a.length>0?(ct=!0,l=g.GetCursorRange(i,l,a[0])):3===l.startContainer.nodeType&&(l.startContainer.parentElement.childElementCount>0&&l.startOffset>0&&"br"!==l.startContainer.parentElement.firstElementChild.tagName.toLowerCase()||!t.isNullOrUndefined(k)&&k===l.startContainer.parentElement.closest(vt)&&0!==l.startContainer.parentElement.closest(vt).textContent.replace(new RegExp("​","g"),"").trim().length)?(ct=!0,l=g.GetCursorRange(i,l,l.startContainer),a.push(l.startContainer)):(tt=this.insertCursorNode(i,v,l,it,g,r,o,u),v.endContainer=v.startContainer=v.getNodeArray(tt,!0),ft="BR"===tt.nodeName&&tt.parentNode.childNodes,t.isNullOrUndefined(ft)||1!==ft.length||"BR"!==ft[0].nodeName||0!==a.length?v.endOffset=v.startOffset=1:(v.setSelectionText(i,l.startContainer,l.endContainer,0,0),lt=!0),"BR"===tt.nodeName&&0===tt.parentNode.textContent.length&&(lt=!0))),ht=!d&&l.collapsed,et=!1,y=0;y<a.length;y++)w=it.getFormattedNode(a[y],r,u),null===w&&("subscript"===r?et=null!==(w=it.getFormattedNode(a[y],"superscript",u)):"superscript"===r&&(et=null!==(w=it.getFormattedNode(a[y],"subscript",u)))),0===y&&null===w&&(ut=!0),null===w||ut&&!at||(a[y]=this.removeFormat(a,y,w,ht,d,ut,at,l,g,r,o,v,u,yt)),null===w&&(a[y]=this.insertFormat(i,a,y,w,ht,d,ut,at,l,g,r,o,c,yt,u),ot++),a.length===ot&&(this.isWrapped=!0),d||bt||(v=this.applySelection(a,v,g,y,ct));s()&&wr(u,h);lt||d||dt.restore();et&&this.applyFormat(i,r,u,f,e)}},n.insertCursorNode=function(n,i,r,u,f,e,o,s){var c=i.getNodeCollection(r),g=new oh(s,n),l=c.length>0?c.length>1&&r.startContainer===r.endContainer?this.getCursorFormat(u,c,e,s):""===o&&"fontsize"===e&&null==u.getFormattedNode(c[0],e,s)&&"SPAN"===c[0].parentElement.nodeName?c[0].parentElement:u.getFormattedNode(c[0],e,s):null,a=null,b,v,p,k,d,nt,tt,y,it,w;if(l){if(a=c[0],8203===l.firstChild.textContent.charCodeAt(0)&&3===l.firstChild.nodeType){if(b=new RegExp("​","g"),v=void 0,"#text"!==a.nodeName)for(p=0;p<c.length;p++)c[p].nodeType===Node.TEXT_NODE&&(a=c[p]);l.firstChild===a?(a.textContent=l.parentElement&&(g.isBlockNode(l.parentElement)&&l.parentElement.textContent.length<=1?l.parentElement.childElementCount>1:0===l.childElementCount)&&(l.parentElement.textContent.length>1||l.parentElement.firstChild&&1===l.parentElement.firstChild.nodeType)?a.textContent:a.textContent.replace(b,""),v=a):(l.firstChild.textContent=l.firstChild.textContent.replace(b,""),v=l.firstChild);k=void 0;0===v.textContent.length&&(t.isNullOrUndefined(v.previousSibling)?t.isNullOrUndefined(v.parentElement)||0!==v.parentElement.textContent.length||(d=document.createElement("BR"),v.parentElement.appendChild(d),t.detach(v),a=d,i.setCursorPoint(n,a.parentElement,0)):(a=v.previousSibling,k=v.textContent.length-1,i.setCursorPoint(n,v,k)))}["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(e)>-1?("fontcolor"===e?l.style.color=o:"fontname"===e?l.style.fontFamily=o:"fontsize"===e?l.style.fontSize=o:l.style.backgroundColor=o,a=l):(h.unwrap(l),i.setCursorPoint(n,a,0))}else{if(c.length>1&&r.startOffset>0&&c[0].firstElementChild&&"br"===c[0].firstElementChild.tagName.toLowerCase()&&(c[0].innerHTML=""),1!==c.length||0!==r.startOffset||"BR"!==c[0].nodeName&&(t.isNullOrUndefined(c[0].nextSibling)||"BR"!==c[0].nextSibling.nodeName)||t.detach("#text"===c[0].nodeName?c[0].nextSibling:c[0]),!t.isNullOrUndefined(c[0]&&c[0].parentElement)&&-1!==yi.inlineTags.indexOf(c[0].parentElement.tagName.toLowerCase())&&c[0].textContent.includes("​")){if(nt=this.GetFormatNode(e,o),tt=c[0],"fontsize"===e)for(y=c[0];y;){if(it=y.parentElement.textContent.trim()===c[0].textContent.trim(),w=y.parentElement,g.isBlockNode(w)||!it||"SPAN"===w.nodeName&&w.classList.contains("e-img-inner"))break;y=w;c[0]=y}return this.applyStyles(c,0,nt),tt}a=this.getInsertNode(n,r,e,o).firstChild}return a},n.getCursorFormat=function(n,t,i,r){for(var u,f=0;f<t.length;f++)u=t[f].lastElementChild?t[f].lastElementChild:t[f];return"fontsize"===i&&null==n.getFormattedNode(u,i,r)&&"SPAN"===u.parentElement.nodeName?u.parentElement:n.getFormattedNode(u,i,r)},n.removeFormat=function(i,r,u,f,e,o,s,c,l,a,v,y,p,w){var ct,lt,ni=null,ui="#text"===c.startContainer.nodeName?c.startContainer.textContent.substring(c.startOffset,c.startContainer.textContent.length):c.startContainer.textContent,fi=i[r].textContent,ei=i[0].parentElement.nodeName===i[0].parentElement.parentElement.nodeName,ut,at,wt,vt,bt,nt,kt,et,rt,b,tt,ti,g,dt,ot,st,ht,yt,ft;if(c.startContainer===c.endContainer&&0===c.startOffset&&c.endOffset===c.startContainer.length&&(c.startContainer.textContent===u.textContent||ei)){if(s&&!i[r].contains(u)&&3===i[r].nodeType&&i[r].textContent!==u.textContent){for(var oi=i[r].textContent===i[r].wholeText,d=i[r],si=this.GetFormatNode(a,v);d&&d.textContent===d.parentElement.textContent;)d=d.parentElement;if(oi&&u.textContent!==d.textContent)return wt=[],vt=this.getPriorityFormatNode(d,p),vt&&vt.textContent===d.textContent&&(d=vt),wt.push(d),this.applyStyles(wt,0,si),i[r]}}else{var it=[],k=i[r],pt=k;do it.push(y.getIndex(k)),k=k.parentNode;while(k&&k!==u);if("BR"!==i[r].nodeName&&("#text"===pt.nodeName&&pt.textContent.includes("​")&&pt.remove(),e||(k=ni=f&&u.textContent.length-1===c.startOffset?l.SplitNode(c,u,!0):l.GetSpliceNode(c,u))),f){for(ut=ni;null!==ut.firstChild&&3!==ut.firstChild.nodeType;null)ut=ut.firstChild;ut.innerHTML="&#8203;";i[r]=ut.firstChild}else{for(;k&&k.childNodes.length>0&&it.length-1>=0&&k.childNodes.length>it[it.length-1];){if(k.childNodes.length>1&&it.length>1){k=k.childNodes[it[it.length-2]];break}k=k.childNodes[it[it.length-1]];it.pop()}if("BR"!==i[r].nodeName){for(;1===k.nodeType&&k.childNodes.length>0;)k=k.childNodes[0];3!==k.nodeType||f&&""===k.nodeValue?(at=document.createElement("div"),at.innerHTML="&#8203;",3!==k.nodeType?(k.insertBefore(at.firstChild,k.firstChild),i[r]=k.firstChild):(k.parentNode.insertBefore(at.firstChild,k),i[r]=k.previousSibling,k.parentNode.removeChild(k))):i[r]=k}}}if(("backgroundcolor"===a&&(ct=u.style.fontSize),"fontsize"===a)&&(bt=t.closest(i[r].parentElement,"span[style*=background-color]"),t.isNullOrUndefined(bt)||(lt=bt.style.backgroundColor)),kt=u.getAttribute("style"),et=u.tagName,"A"===et&&"underline"===a?(u.style.textDecoration="none",nt=[u]):-1!==yi.inlineTags.indexOf(et.toLowerCase())&&s&&"span"!==et.toLocaleLowerCase()?(rt=u.style,rt.color&&"fontcolor"===a?rt.color="A"===u.nodeName?v:"":rt.backgroundColor&&"backgroundcolor"===a?rt.backgroundColor="":rt.fontSize&&"fontsize"===a?rt.fontSize="":rt.fontFamily&&"fontname"===a&&(rt.fontFamily=""),""===u.getAttribute("style")&&u.removeAttribute("style"),nt=[u]):(nt=h.unwrap(u),0===r&&(this.isUnwrapped=!0),b=i[r].parentElement,t.isNullOrUndefined(b)||"li"===b.tagName.toLowerCase()||(b=t.closest(b,"li")),t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()!==i[r].textContent.trim()&&(b.innerText.split("\n").length!==i.length||b.innerText.split("\n")[0]!==i[r].textContent.trim())?t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()===i[r].textContent.trim()||("bold"===a?b.style.fontWeight="":"italic"===a&&(b.style.fontStyle=""),n.conCatenateTextNode(b,a,"","normal",v)):"bold"===a?b.style.fontWeight="":"italic"===a?b.style.fontStyle="":"fontsize"===a&&(b.style.fontSize="")),nt[0]&&!s)for(tt=d=nt[r]?nt[r]:nt[0];d&&d.parentElement&&d.parentElement!==p;d)if(ti="SPAN"===u.nodeName?d.parentElement.tagName.toLocaleLowerCase()===u.tagName.toLocaleLowerCase()&&d.parentElement.getAttribute("style")===kt:d.parentElement.tagName.toLocaleLowerCase()===u.tagName.toLocaleLowerCase(),d.parentElement&&ti&&d.parentElement.childElementCount>0){if(tt.parentElement&&tt.parentElement.tagName.toLocaleLowerCase()===u.tagName.toLocaleLowerCase()&&c.startContainer===c.endContainer&&1!==tt.nodeType&&!t.isNullOrUndefined(tt.textContent)&&tt.parentElement.childElementCount>1&&(c.setStart(tt,0),c.setEnd(tt,tt.textContent.length),l.SplitNode(c,tt.parentElement,!1)),"span"===d.parentElement.tagName.toLocaleLowerCase()&&"underline"===u.style.textDecoration&&"underline"!==d.parentElement.style.textDecoration){d=d.parentElement;continue}h.unwrap(d.parentElement);d=t.isNullOrUndefined(d.parentElement)||w.isBlockNode(d.parentElement)?d.parentElement:tt}else d=d.parentElement;if(nt.length>0&&s){for(g=0;g<nt.length;g++)(3!==nt[g].nodeType||nt[g].textContent&&(nt[g].textContent.trim().length>0||nt[g].textContent.includes(" ")))&&((""!==v||"fontcolor"===a&&""===v)&&(nt[g]=h.Wrap(nt[g],this.GetFormatNode(a,v,et,kt))),b=i[r].parentElement,t.isNullOrUndefined(b)||"li"===b.tagName.toLowerCase()||(b=t.closest(b,"li")),t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()!==i[r].textContent.trim()||"fontname"===a&&(b.style.fontFamily=v),t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()===i[r].textContent.trim()||"fontname"!==a||b.style.removeProperty("font-family"),nt[g].textContent===ui&&("#text"===c.startContainer.nodeName||"#text"!==c.startContainer.nodeName&&c.startContainer.classList&&!c.startContainer.classList.contains("e-multi-cells-select"))&&(0===g?c.setStartBefore(nt[g]):g===nt.length-1&&c.setEndAfter(nt[g])));if(dt=i[r].parentElement,t.isNullOrUndefined(ct)||""===ct||(dt.style.fontSize=ct),t.isNullOrUndefined(lt)||""===lt||(dt.style.backgroundColor=lt),"fontsize"===a||"fontcolor"===a||"fontname"===a){for(b=i[r].parentElement,ot=i[r].parentElement;!t.isNullOrUndefined(ot)&&"li"!==ot.tagName.toLowerCase();)b=ot=ot.parentElement;for(g=r,st="";g>=0&&!t.isNullOrUndefined(b)&&"li"===b.tagName.toLowerCase()&&b.contains(i[g])&&b.textContent.replace("/​/g","").trim().includes(i[g].textContent.trim());)st=i[g].textContent+st,g--;var gt=!1,ii=0,ri=!1;if(!t.isNullOrUndefined(b)&&b.childNodes)for(ht=0;ht<b.childNodes.length;ht++)"OL"!==b.childNodes[ht].nodeName&&"UL"!==b.childNodes[ht].nodeName||(ii++,gt=!0);if(t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.split("​").join("").trim()!==st.split("​").join("").trim()){if(!t.isNullOrUndefined(b)&&"li"===b.tagName.toLowerCase()&&gt){if(gt&&ii>0)for(yt=0;yt<b.childNodes.length;yt++)i[r].textContent===b.childNodes[yt].textContent&&i[r].textContent===fi&&b.textContent.replace("/​/g","").trim().includes(st.split("​").join("").trim())&&(ri=!0);if(ri){for(ft=0;ft<b.childNodes.length;ft++)"OL"!==b.childNodes[ft].nodeName&&"UL"!==b.childNodes[ft].nodeName||b.childNodes[ft].removeAttribute("style");"fontsize"===a?b.style.fontSize=v:"fontname"===a?b.removeAttribute("style"):(b.style.color=v,b.style.textDecoration="inherit")}}}else"fontsize"===a?b.style.fontSize=v:"fontname"===a?b.removeAttribute("style"):(b.style.color=v,b.style.textDecoration="inherit")}}return i[r]},n.insertFormat=function(i,r,u,f,e,o,s,h,c,l,a,v,y,p,w){var it,b,g,d,ft,nt,rt,et,tt,k,ht,ut,ot,st;if(e)"uppercase"!==a&&"lowercase"!==a?(it=this.getInsertNode(i,c,a,v),r[u]=it.firstChild,l.position=1):l.position=c.startOffset;else if(null===f&&s||h){if(o||"BR"===r[u].nodeName||(r[u]=l.GetSpliceNode(c,r[u]),r[u].textContent=l.TrimLineBreak(r[u].textContent)),"uppercase"===a||"lowercase"===a)r[u].textContent="uppercase"===a?r[u].textContent.toLocaleUpperCase():r[u].textContent.toLocaleLowerCase();else if(!0!==h||""!==v)if(it=this.GetFormatNode(a,v),"formatPainter"===v||h){for(b=r[u].parentElement,g=r[u].parentElement;!t.isNullOrUndefined(g)&&"li"!==g.tagName.toLowerCase();)b=g=g.parentElement;if(("fontcolor"===a||"fontname"===a||"fontsize"===a)&&(d=g&&"LI"===g.tagName?g:r[u].parentElement,!t.isNullOrUndefined(d)&&d.childNodes))for(ft=0;ft<d.childNodes.length;ft++){if(this.concatenateTextExcludingList(r,u)===r[u].textContent&&(nt=void 0,"LI"===d.tagName?nt=d:d.closest("li")&&(nt=d.closest("li")),!t.isNullOrUndefined(nt)))switch(a){case"fontcolor":nt.style.color=v;break;case"fontname":nt.style.fontFamily=v;break;case"fontsize":nt.style.fontSize=v}if(rt=d.childNodes[ft],"OL"===rt.tagName||"UL"===rt.tagName)switch(a){case"fontcolor":rt.style.color="initial";break;case"fontname":rt.style.fontFamily="initial";break;case"fontsize":rt.style.fontSize="initial"}}if(t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()!==r[u].textContent.trim()||("fontsize"===a?b.style.fontSize=v:"fontcolor"===a?(b.style.color=v,b.style.textDecoration="inherit"):"fontname"===a&&(b.style.fontFamily=v)),"formatPainter"===v)return this.insertFormatPainterElem(r,u,c,l,y,p);if(et=r[u],tt=this.getPriorityFormatNode(et,w),!t.isNullOrUndefined(tt)||h){if(k=t.isNullOrUndefined(tt)?et:tt,k=t.isNullOrUndefined(tt)||""===tt.style.fontSize?k:k.firstChild,t.isNullOrUndefined(tt)||"fontsize"===a)for(;k;){if(ht=k.parentElement.textContent.trim()===r[u].textContent.trim(),ut=k.parentElement,p.isBlockNode(ut)||!ht||"SPAN"===ut.nodeName&&ut.classList.contains("e-img-inner"))break;k=ut}ot=[];h&&(st=t.closest(r[u].parentElement,"A"),t.isNullOrUndefined(st)||st.firstChild.textContent.trim()!==r[u].textContent.trim()||(k=r[u]));r[u].textContent.trim()!==k.textContent.trim()&&(k=r[u]);ot[0]=k;this.applyStyles(ot,0,it);t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()===r[u].textContent.trim()||n.conCatenateTextNode(b,a,b.textContent,a,v)}else r[u]=this.applyStyles(r,u,it)}else b=r[u].parentElement,r[u]=this.applyStyles(r,u,it),t.isNullOrUndefined(b)||"li"===b.tagName.toLowerCase()||(b=t.closest(b,"li")),t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()!==r[u].textContent.trim()&&(b.innerText.split("\n").length!==r.length||b.innerText.split("\n")[0]!==r[u].textContent.trim())?t.isNullOrUndefined(b)||"li"!==b.tagName.toLowerCase()||b.textContent.trim()===r[u].textContent.trim()||n.conCatenateTextNode(b,a,b.textContent,a):"bold"===a?b.style.fontWeight="bold":"italic"===a&&(b.style.fontStyle="italic")}else!o&&r[u].isConnected&&(r[u]=l.GetSpliceNode(c,r[u]));return r[u]},n.applyStyles=function(n,t,i){return"BR"===n[t].nodeName&&"BR"===this.enterAction||(n[t]=t===n.length-1||"BR"===n[t].nodeName?h.Wrap(n[t],i):h.WrapBefore(n[t],i,!0),n[t]=this.getChildNode(n[t],i)),n[t]},n.getPriorityFormatNode=function(n,i){var u,f,e,r=new yi,o=r.getFormattedNode(n,"fontsize",i);return t.isNullOrUndefined(o)?(f=r.getFormattedNode(n,"backgroundcolor",i),t.isNullOrUndefined(f)?(e=r.getFormattedNode(n,"fontname",i),t.isNullOrUndefined(e)?(u=r.getFormattedNode(n,"fontcolor",i),t.isNullOrUndefined(u)?null:u):e):f):o},n.getInsertNode=function(n,i,r,u){var f=this.GetFormatNode(r,u),e;return(f.innerHTML="&#8203;",t.Browser.isIE)?(e=n.createDocumentFragment(),e.appendChild(f),i.insertNode(e)):i.insertNode(f),f},n.getChildNode=function(n,t){return null==n&&(t.innerHTML="&#8203;",n=t.firstChild),n},n.applySelection=function(n,t,i,r,u){return 1!==n.length||u?1===n.length&&u?(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=i.position,t.endOffset=i.position):0===r?(t.startContainer=t.getNodeArray(n[r],!0),t.startOffset=0):r===n.length-1&&(t.endContainer=t.getNodeArray(n[r],!1),t.endOffset=n[r].textContent.length):(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=n[r].textContent.length),t},n.GetFormatNode=function(n,t,i,r){var u;switch(n){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.textDecoration="underline",u;case"strikethrough":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.textDecoration="line-through",u;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.color=t,u.style.textDecoration="inherit",u;case"fontname":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.fontFamily=t,u;case"fontsize":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.fontSize=t,u;case"inlinecode":return document.createElement("code");default:return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.backgroundColor=t,u}},n.updateStyles=function(n,t,i){null!==i&&"SPAN"===t&&(n.style.cssText=i)},n.insertFormatPainterElem=function(n,i,r,u,f,e){var o=e.isBlockNode(n[i].parentElement)?n[i]:n[i].parentElement,l,v;if(!e.isBlockNode(o))for(;o.textContent.trim()===o.parentElement.textContent.trim()&&!e.isBlockNode(o.parentElement);)o=o.parentElement;if(t.isNullOrUndefined(o)||1!==o.nodeType||o.classList.contains("e-rte-img-caption")||o.classList.contains("e-img-inner")||this.formatPainterCleanup(i,n,o,r,u,e),l=f.element,!t.isNullOrUndefined(l)){var s=l.cloneNode(!0),a=s.querySelectorAll(f.lastChild.nodeName),c=void 0;a.length>0?c=a[a.length-1]:t.isNullOrUndefined(s)||s.nodeName!==f.lastChild.nodeName||(c=s);c.textContent=n[i].textContent;v=c.childNodes[0];n[i]=h.Wrap(n[i],s);n[i].textContent="";n[i]=v}return n[i]},n.formatPainterCleanup=function(n,i,r,u,f,e){var y=["A","AUDIO","IMG","VIDEO","IFRAME"],l,o,c,s,a,v;if(0===n&&r.textContent.trim()!==i[n].textContent.trim()){for(f.SplitNode(u,r,!0),l=i[n].parentElement.childNodes,o=0;o<l.length;o++)if(l[o].textContent.trim()===i[o].textContent.trim()){r.parentNode.insertBefore(l[o],r);break}for(c=r.parentElement.childNodes,s=0;s<c.length;s++)""!==c[s].textContent.trim()&&0!==c[s].textContent.length||160===c[s].textContent.charCodeAt(0)||t.detach(c[s])}else if(r.textContent.trim()!==i[n].textContent.trim())r.parentElement.insertBefore(i[n],r);else for(;!t.isNullOrUndefined(r)&&3!==r.nodeType&&!e.isBlockNode(r);){for(a=void 0,o=0;o<r.childNodes.length;o++)v=r.childNodes[o],0!==v.textContent.trim().length&&3!==v.nodeType&&(a=r.childNodes[o]);-1===y.indexOf(r.tagName)&&h.unwrap(r);r=a}},n.concatenateTextExcludingList=function(n,i){var e="",f="#text"===n[i].nodeName?t.closest(n[i].parentElement,"li"):t.closest(n[i],"li"),u,r;if(!t.isNullOrUndefined(f))for(u=0;u<f.childNodes.length;u++)r=f.childNodes[u],(3===r.nodeType||1===r.nodeType&&"OL"!==r.tagName&&"UL"!==r.tagName)&&(e+=r.textContent);return e},n.conCatenateTextNode=function(i,r,u,f,e){var o="",s="";switch(r){case"bold":i.querySelectorAll("strong").forEach(function(n){o+=n.textContent});o===u&&(i.style.fontWeight=f);break;case"italic":i.querySelectorAll("em").forEach(function(n){o+=n.textContent});o===u&&(i.style.fontStyle=f);break;case"fontcolor":i.querySelectorAll("span").forEach(function(t){s=t.style.color;n.hasColorsEqual(s,e)&&(o+=t.textContent)});t.isNullOrUndefined(o)||t.isNullOrUndefined(u)||""===o||""===u||o.replace(/\s+/g,"")!==u.replace(/\s+/g,"")||(i.style.color=e,i.style.textDecoration="inherit");break;case"fontsize":i.querySelectorAll("span").forEach(function(n){n.style.getPropertyValue("font-size")===e&&(o+=n.textContent)});t.isNullOrUndefined(o)||t.isNullOrUndefined(u)||""===o||""===u||o.replace(/\s+/g,"")!==u.replace(/\s+/g,"")||(i.style.fontSize=e);break;case"fontname":i.querySelectorAll("span").forEach(function(n){n.style.getPropertyValue("font-family").replace(/ /g,"")===e&&(o+=n.textContent)});t.isNullOrUndefined(o)||t.isNullOrUndefined(u)||""===o||""===u||o.replace(/\s+/g,"")!==u.replace(/\s+/g,"")||(i.style.fontFamily=e)}},n.hasColorsEqual=function(n,i){return t.isNullOrUndefined(n)||t.isNullOrUndefined(i)||""===n.trim()||""===i.trim()?n===i:(n.startsWith("rgb(")&&(n=n.replace("rgb(","rgba(").slice(0,-1)+",1)"),i.startsWith("rgb(")&&(i=i.replace("rgb(","rgba(").slice(0,-1)+",1)"),n.replace(/\s+/g,"")===i.replace(/\s+/g,""))},n.isMentionStartOrEnd=function(n,t,i){var r="None",e=new hu(n),u=e.getTopMostNode(t),f=e.getTopMostNode(i);return u.nodeType!==Node.ELEMENT_NODE||u.isContentEditable||f.nodeType!==Node.ELEMENT_NODE||f.isContentEditable||(r="Both"),u.nodeType!==Node.ELEMENT_NODE||u.isContentEditable||(r="Start"),f.nodeType!==Node.ELEMENT_NODE||f.isContentEditable||(r="End"),r},n.enterAction="P",n.isUnwrapped=!1,n.isWrapped=!1,n.userAgentData=new sh(t.Browser.userAgent,!1),n}(),yit=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(np,this.applySelection,this);this.parent.observer.on(c,this.keyDownHandler,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(np,this.applySelection);this.parent.observer.off(c,this.keyDownHandler);this.parent.observer.off(f,this.destroy)},n.prototype.keyDownHandler=function(n){(n.event.ctrlKey||n.event.metaKey)&&["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","inlinecode"].indexOf(n.event.action)>-1&&(n.event.preventDefault(),fp.applyFormat(this.parent.currentDocument,n.event.action,this.parent.editableElement,n.enterAction,this.parent.tableCellSelection),this.callBack(n,n.event.action))},n.prototype.applySelection=function(n){fp.applyFormat(this.parent.currentDocument,n.subCommand.toLocaleLowerCase(),this.parent.editableElement,n.enterAction,this.parent.tableCellSelection,n.value,n.selector);this.callBack(n,n.subCommand)},n.prototype.callBack=function(n,t){n.callBack&&n.callBack({requestType:t,event:n.event,editorMode:"HTML",isKeyboardEvent:n.name===c,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n}(),pit=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(tp,this.applyHtml,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(tp,this.applyHtml);this.parent.observer.off(f,this.destroy)},n.prototype.applyHtml=function(n){var t=this.getSelectionRange(),i=n.value.firstChild;if(i&&"A"===i.nodeName&&t.startOffset!==t.endOffset){var r="#text"===t.startContainer.nodeName,u=r?eh:no,f=r?"CreateLink":"InsertLink";this.parent.observer.notify(u,{value:f,item:this.extractHyperlinkDetails(n),callBack:n.callBack})}else kt.Insert(this.parent.currentDocument,n.value,this.parent.editableElement,!0,n.enterAction,this.parent);if("pasteCleanup"===n.subCommand){var e=this.parent.editableElement.querySelectorAll(".pasteContent_RTE"),o=[].slice.call(e),s=this.parent.editableElement.querySelectorAll(".pasteContent_Img"),h=[].slice.call(s);n.callBack({requestType:n.subCommand,editorMode:"HTML",elements:o,imgElem:h})}else n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.extractHyperlinkDetails=function(n){var i,r=this.getSelectionRange(),o=this.parent.nodeSelection.getParentNodeCollection(r),t=n.value.querySelector("a"),u=this.findAnchorElement(o),f,e;return u&&"A"===u.nodeName?(f=r.toString(),e=u.innerText,i=f.length<e.length?e:f):i=r.toString(),{url:t.href||"",text:i,title:t.title||"",target:t.target||"",ariaLabel:t.ariaLabel||"",selection:this.parent.nodeSelection,selectNode:Array.from(this.getSelectionRange().startContainer.childNodes),selectParent:o}},n.prototype.getSelectionRange=function(){return this.parent.nodeSelection.getRange(this.parent.currentDocument)},n.prototype.findAnchorElement=function(n){for(var f,u,i=0,r=n;i<r.length;i++)if(f=r[i],u=t.closest(f,"a"),u)return u;return n[0]},n.prototype.destroy=function(){this.removeEventListener()},n}(),ist=function(){function n(){}return n.clear=function(n,i,r,u,f){var y,l,p,a,v,w,d;this.domNode=new oh(i,n);this.defaultTag="P"===r?"p":"div";var h=new st(i),c=new su,e=h.getRange(n),o=e.collapsed?h.getSelectionNodeCollection(e):h.getSelectionNodeCollectionBr(e),b=h.save(e,n),k=!1;if(e.collapsed&&"ClearFormat"!==f&&(k=!0,e=c.GetCursorRange(n,e,o[0])),!e.collapsed){if(y=o.length>0&&"BR"===o[0].nodeName&&t.closest(o[0],"table")?c.GetSpliceNode(e,t.closest(o[0],"table")):c.GetSpliceNode(e,o[o.length>1&&"IMG"===o[0].nodeName?1:0]),1===o.length)h.setSelectionContents(n,y),e=h.getRange(n);else if(o.length>1){for(l=1,p=o[o.length-l];o.length<=l&&"BR"===o[o.length-l].nodeName;)l++,p=o[o.length-l];a=c.GetSpliceNode(e,p);a&&h.setSelectionText(n,y,a,0,3===a.nodeType?a.textContent.length:a.childNodes.length);e=h.getRange(n)}v=h.getNodeCollection(e);w=v.slice();this.clearInlines(h.getSelectionNodesBr(w),w,h.getRange(n),c,i);this.reSelection(n,b,v);e=h.getRange(n);d=(v=h.getNodeCollection(e)).slice();this.clearBlocks(n,d,i,c,h);s()&&wr(i,u);this.reSelection(n,b,v)}k&&h.setCursorPoint(n,e.endContainer,e.endOffset)},n.reSelection=function(n,t,i){var r=t.getInsertNodes(i),u;t.startContainer=t.getNodeArray(r[0],!0,n);t.startOffset=0;t.endContainer=t.getNodeArray(r[r.length-1],!1,n);u=r[r.length-1];t.endOffset=3===u.nodeType?u.textContent.length:u.childNodes.length;t.restore()},n.clearBlocks=function(n,t,i,r,u){for(var f=[],e=0;e<t.length;e++)this.BLOCK_TAGS.indexOf(t[e].nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e])?f.push(t[e]):this.BLOCK_TAGS.indexOf(t[e].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e].parentNode)&&i!==t[e].parentNode&&f.push(t[e].parentNode);f=this.spliceParent(f,t)[0];f=this.removeParent(f);this.unWrap(n,f,r,u)},n.spliceParent=function(n,t){for(var f,r,u,e,o,s,i=0;i<n.length;i++)for(f=n[i].childNodes.length,r=0;r<f;r++)if(t.indexOf(n[i].childNodes[r])>0&&n[i].childNodes[r].childNodes.length>0&&(t=this.spliceParent([n[i].childNodes[r]],t)[1]),t.indexOf(n[i].childNodes[r])<=-1&&""!==n[i].childNodes[r].textContent.trim()){for(u=0;u<f;u++)t.indexOf(n[i].childNodes[u])>-1&&t.splice(t.indexOf(n[i].childNodes[u]),1);r=n[i].childNodes.length;e=n.indexOf(n[i].parentNode);o=t.indexOf(n[i].parentNode);e>-1&&n.splice(e,1);o>-1&&t.splice(o,1);s=t.indexOf(n[i]);s>-1&&t.splice(s,1);n.splice(i,1);i--}return[n,t]},n.removeChild=function(n,t){var r=t.childNodes.length,i;if(r>0)for(i=0;i<r;i++)n.indexOf(t.childNodes[i])>-1&&(n=this.removeChild(n,t.childNodes[i])).splice(n.indexOf(t.childNodes[i]),1);return n},n.removeParent=function(n){for(var t=0;t<n.length;t++)n.indexOf(n[t].parentNode)>-1&&((n=this.removeChild(n,n[t])).splice(t,1),t--);return n},n.unWrap=function(n,i,r,u){for(var s,c,e,o,f=0;f<i.length;f++)if(i[f]=t.closest(i[f],"li")&&"UL"!==i[f].nodeName&&"OL"!==i[f].nodeName?t.closest(i[f],"li"):i[f],this.NONVALID_TAGS.indexOf(i[f].nodeName.toLowerCase())>-1&&i[f].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(i[f].parentNode.nodeName.toLowerCase())>-1&&(u.setSelectionText(n,i[f],i[f],0,i[f].childNodes.length),h.unwrap(r.GetSpliceNode(u.getRange(n),i[f].parentNode))),s=t.closest(i[f],"blockquote"),"blockquote"===i[f].nodeName.toLocaleLowerCase()||t.isNullOrUndefined(s)||s.textContent!==i[f].textContent||(c=this.removeParent([s]),this.unWrap(n,c,r,u)),"p"!==i[f].nodeName.toLocaleLowerCase())for(!(this.NONVALID_PARENT_TAGS.indexOf(i[f].nodeName.toLowerCase())<0)||("blockquote"===i[f].nodeName.toLocaleLowerCase()||"li"===i[f].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(i[f].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===i[f].childNodes.length&&"p"===i[f].childNodes[0].nodeName.toLocaleLowerCase()||h.Wrap(i[f],n.createElement(this.defaultTag)),e=h.unwrap(i[f]),1===e.length&&"p"===e[0].parentNode.nodeName.toLocaleLowerCase()&&(h.Wrap(i[f],n.createElement(this.defaultTag)),h.unwrap(i[f])),o=0;o<e.length;o++)this.NONVALID_TAGS.indexOf(e[o].nodeName.toLowerCase())>-1?this.unWrap(n,[e[o]],r,u):this.BLOCK_TAGS.indexOf(e[o].nodeName.toLocaleLowerCase())>-1&&"p"!==e[o].nodeName.toLocaleLowerCase()?(c=this.removeParent([e[o]]),this.unWrap(n,c,r,u)):this.BLOCK_TAGS.indexOf(e[o].nodeName.toLocaleLowerCase())>-1&&"p"===e[o].nodeName.toLocaleLowerCase()?("p"===e[o].parentNode.nodeName.toLocaleLowerCase()&&h.unwrap(e[o].parentNode),h.Wrap(e[o],n.createElement(this.defaultTag)),h.unwrap(e[o])):this.BLOCK_TAGS.indexOf(e[o].nodeName.toLocaleLowerCase())>-1&&e[o].parentNode.nodeName.toLocaleLowerCase()===e[o].nodeName.toLocaleLowerCase()&&h.unwrap(e[o]);else h.Wrap(i[f],n.createElement(this.defaultTag)),h.unwrap(i[f])},n.clearInlines=function(n,t,i,r){for(var u,f,e=0;e<n.length;e++){for(u=n[e],f=void 0;!this.domNode.isBlockNode(u)&&u.parentElement&&!u.parentElement.classList.contains("e-img-inner");)f=u,u=u.parentElement;f&&yi.inlineTags.indexOf(f.nodeName.toLocaleLowerCase())>-1&&(r.GetSpliceNode(i,f),this.removeInlineParent(f))}},n.removeInlineParent=function(n){for(var i=h.unwrap(n),t=0;t<i.length;t++)1===i[t].parentNode.childNodes.length&&!i[t].parentNode.classList.contains("e-img-inner")&&yi.inlineTags.indexOf(i[t].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(i[t].parentNode):yi.inlineTags.indexOf(i[t].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(i[t])},n.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","ul"],n.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],n.IGNORE_PARENT_TAGS=["ul","ol","table"],n.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],n.defaultTag="p",n}(),wit=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(rp,this.applyClear,this);this.parent.observer.on(c,this.onKeyDown,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(rp,this.applyClear);this.parent.observer.off(c,this.onKeyDown);this.parent.observer.off(f,this.destroy)},n.prototype.onKeyDown=function(n){"clear-format"===n.event.action&&(this.applyClear({subCommand:"ClearFormat",callBack:n.callBack,enterAction:n.enterAction}),n.event.preventDefault())},n.prototype.applyClear=function(n){"ClearFormat"===n.subCommand&&(ist.clear(this.parent.currentDocument,this.parent.editableElement,n.enterAction,n.selector,n.subCommand),n.callBack&&n.callBack({requestType:n.subCommand,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},n.prototype.destroy=function(){this.removeEventListener()},n}(),bit=function(){function n(n,i){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=t.isNullOrUndefined(i)?30:i.undoRedoSteps;this.undoRedoTimer=t.isNullOrUndefined(i)?300:i.undoRedoTimer;this.addEventListener()}return n.prototype.addEventListener=function(){this.debounceListener=t.debounce(this.keyUp,this.undoRedoTimer);this.parent.observer.on(ei,this.debounceListener,this);this.parent.observer.on(c,this.keyDown,this);this.parent.observer.on(ku,this.onAction,this);this.parent.observer.on(pr,this.onPropertyChanged,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){this.parent.observer.off(ei,this.keyUp);this.parent.observer.off(c,this.keyDown);this.parent.observer.off(ku,this.onAction);this.parent.observer.off(pr,this.onPropertyChanged);this.parent.observer.off(f,this.destroy);this.debounceListener=null},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.destroy=function(){this.removeEventListener();this.element=null;this.steps=null;this.undoRedoStack=[];this.undoRedoSteps=null;this.undoRedoTimer=null},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.getTextContentFromFragment=function(n){for(var t,i="",r=0;r<n.childNodes.length;r++)t=n.childNodes[r],t.nodeType===Node.TEXT_NODE?i+=t.textContent:t.nodeType===Node.ELEMENT_NODE&&(i+=this.getTextContentFromFragment(t));return i},n.prototype.isElementStructureEqual=function(n,t){var i,r,u;if(n.childNodes.length!==t.childNodes.length)return!1;for(i=0;i<n.childNodes.length;i++)if((r=n.childNodes[i],u=t.childNodes[i],!r||!u)||r.nodeType!==u.nodeType||r.outerHTML!==u.outerHTML)return!1;return!0},n.prototype.saveData=function(n){var e;if(this.parent.currentDocument){for(var u=new st(this.parent.editableElement).getRange(this.parent.currentDocument),r=this.parent.editableElement===u.startContainer.parentElement?u.startContainer.parentElement:u.startContainer,i=r.childNodes.length-1;i>=0;i--)!t.isNullOrUndefined(r.childNodes[i])&&"#text"===r.childNodes[i].nodeName&&0===r.childNodes[i].textContent.length&&"IMG"!==r.childNodes[i].nodeName&&"BR"!==r.childNodes[i].nodeName&&r.childNodes[i].nodeName&&t.detach(r.childNodes[i]);u=new st(this.parent.editableElement).getRange(this.parent.currentDocument);for(var f=new st(this.parent.editableElement).save(u,this.parent.currentDocument),o=this.removeResizeElement(this.parent.editableElement.cloneNode(!0)),s=document.createDocumentFragment();o.firstChild;)s.appendChild(o.firstChild);e={text:s,range:f};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===u.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===f.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===f.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===f.range.startContainer&&this.getTextContentFromFragment(this.undoRedoStack[this.undoRedoStack.length-1].text).trim()===this.getTextContentFromFragment(e.text).trim()&&this.isElementStructureEqual(this.undoRedoStack[this.undoRedoStack.length-1].text,e.text)||(this.undoRedoStack.push(e),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())}},n.prototype.removeResizeElement=function(n){var s=n.querySelector(".e-vid-resize"),r,u,f,i,h,e,o;for(s&&t.detach(s),r=n.querySelector("."+dt),r&&t.removeClass([r],[dt,"e-resize"]),u=n.querySelector(".e-img-resize"),u&&t.detach(u),f=n.querySelectorAll("img"),i=0;i<f.length;i++)h=f[i],t.removeClass([h],["e-img-focus","e-resize"]);for(e=n.querySelector("."+oi),e&&t.removeClass([e],[oi]),o=n.querySelectorAll("img, audio, video"),i=0;i<o.length;i++)o[i].style.outline="";return n},n.prototype.undo=function(n){if(this.steps>0){var t=this.undoRedoStack[this.steps-1].range,i=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML="";this.parent.editableElement.appendChild(i.cloneNode(!0));this.parent.editableElement.focus();hr(this.parent.currentDocument,this.parent.editableElement);s()&&wr(this.parent.editableElement,n.selector);t.restore();this.steps--;n.callBack&&n.callBack({requestType:"Undo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){var t=this.undoRedoStack[this.steps+1].range,i=this.undoRedoStack[this.steps+1].text;this.parent.editableElement.innerHTML="";this.parent.editableElement.appendChild(i.cloneNode(!0));this.parent.editableElement.focus();hr(this.parent.currentDocument,this.parent.editableElement);s()&&wr(this.parent.editableElement,n.selector);t.restore();this.steps++;n.callBack&&n.callBack({requestType:"Redo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n.prototype.getCurrentStackIndex=function(){return this.steps},n.prototype.clear=function(){this.undoRedoStack=[];this.steps=null},n}(),kit=function(){function n(n){this.olData=["decimal","decimal-leading-zero","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"];this.ulData=["disc","square","circle","disc","square","circle"];this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"];this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"];this.borderStyle=["border-top","border-right","border-bottom","border-left"];this.upperRomanNumber=["I","II","III","IV","V","VI","VII","VIII","IX","X","XI","XII","XIII","XIV","XV","XVI","XVII","XVIII","XIX","XX"];this.lowerRomanNumber=["i","ii","iii","iv","v","vi","vii","viii","ix","x","xi","xii","xiii","xiv","xv","xvi","xvii","xviii","xix","xx"];this.lowerGreekNumber=["α","β","γ","δ","ε","ζ","η","θ","ι","κ","λ","μ","ν","ξ","ο","π","ρ","σ","τ","υ","φ","χ","ψ","ω"];this.removableElements=["o:p","style","w:sdt"];this.listContents=[];this.cropImageDimensions=[];this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(hv,this.wordCleanup,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(hv,this.wordCleanup);this.parent.observer.off(f,this.destroy)},n.prototype.wordCleanup=function(n){var o=t.isNullOrUndefined(n.allowedStylePropertiesArray)?[]:n.allowedStylePropertiesArray,u=[],r=n.args.clipboardData.getData("text/HTML"),s=n.args.clipboardData.getData("text/rtf"),i=t.createElement("p"),e,f;i.setAttribute("id","MSWord-Content");i.innerHTML=r;this.addDoubleBr(i);e=/style='mso-width-source:/i;f=this.findSource(i);/class='?Mso|style='[^ ]*\bmso-/i.test(r)||/class="?Mso|style="[^ ]*\bmso-/i.test(r)||/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi.test(r)||e.test(r)?(r=r.replace(/<img[^>]+>/i,""),this.addListClass(i),u=this.listCleanUp(i,u),t.isNullOrUndefined(u[0])||"UL"===u[0].parentElement.tagName||"OL"===u[0].parentElement.tagName||this.listConverter(u),this.imageConversion(i,s),this.cleanList(i,"UL"),this.cleanList(i,"OL"),this.styleCorrection(i,o),this.removingComments(i),this.removeUnwantedElements(i),this.removeEmptyElements(i),this.removeEmptyAnchorTag(i),this.breakLineAddition(i),this.processMargin(i),this.removeClassName(i),e.test(r)&&this.addTableBorderClass(i),n.callBack(i.innerHTML,this.cropImageDimensions,f)):(f===up[2]&&this.handleOneNoteContent(i),this.removeEmptyMetaTags(i),n.callBack(i.innerHTML,null,f))},n.prototype.addDoubleBr=function(n){var i=n.querySelector(".Apple-interchange-newline"),u,f,r,e,o;if(!t.isNullOrUndefined(i)&&-1!==t.Browser.userAgent.indexOf("Chrome")&&"P"===i.parentElement.nodeName&&n!==i.parentElement)for(u=0;u<n.childNodes.length;u++)if(f=n.childNodes[u],f.nodeType===Node.COMMENT_NODE&&-1!==f.nodeValue.indexOf("StartFragment")){r=t.createElement("p");r.innerHTML="<br>";e=i.parentElement.style.cssText;o=(r.getAttribute("style")||"")+e;r.style.cssText=o;n.insertBefore(r,f.nextSibling);t.detach(i);break}},n.prototype.cleanList=function(n,t){for(var i,e,f,u=n.querySelectorAll(t+" div"),r=u.length-1;r>=0;r--){for(i=u[r],e=i.parentNode;i.firstChild;)e.insertBefore(i.firstChild,i);f=this.findClosestListElem(i);f&&this.insertAfter(i,f)}},n.prototype.insertAfter=function(n,t){t.parentNode&&t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.findClosestListElem=function(n){for(var i,r,u;!t.isNullOrUndefined(n);)r=!t.isNullOrUndefined(n.closest("ul"))&&"UL"!==n.tagName,u="OL"!==n.tagName&&!t.isNullOrUndefined(n.closest("ol")),n=r?n.closest("ul"):u?n.closest("ol"):null,i=t.isNullOrUndefined(n)?i:n;return i},n.prototype.addListClass=function(n){for(var i,f,u=n.querySelectorAll("*"),r=0;r<u.length;r++)if(i=u[r],f=i.getAttribute("style"),!t.isNullOrUndefined(f)){var e=f.replace(/ /g,"").replace("\n","").indexOf("mso-list:l")>=0,o=-1===i.className.toLowerCase().indexOf("msolistparagraph"),s="H"!==i.tagName.charAt(0),h="LI"!==i.tagName&&"OL"!==i.tagName&&"UL"!==i.tagName;e&&o&&s&&h&&i.classList.add("msolistparagraph")}},n.prototype.addTableBorderClass=function(n){for(var i,r=n.querySelectorAll("table"),u=!1,t=0;t<r.length;t++){for(i=0;i<this.borderStyle.length;i++)if(r[t].innerHTML.indexOf(this.borderStyle[i])>=0){u=!0;break}u&&(r[t].classList.add("e-rte-table-border"),u=!1)}},n.prototype.imageConversion=function(n,t){var i,e;if(this.checkVShape(n),i=n.querySelectorAll("img"),this.markUnsupportedImages(i),0!==(i=n.querySelectorAll("img")).length){var r=[],u=[],f=[];this.extractImageInfo(i,r,f);e=this.hexConversion(t);this.processHexValues(e,u);this.updateImageSources(n,r,u,f);this.cleanUnsupportedImages(n)}},n.prototype.markUnsupportedImages=function(n){for(var r,u,i=0;i<n.length;i++)r=n[i],u=r.getAttribute("v:shapes"),t.isNullOrUndefined(u)||(this.isUnsupportedImageShape(u)&&r.classList.add("e-rte-image-unsupported"),r.removeAttribute("v:shapes"))},n.prototype.isUnsupportedImageShape=function(n){for(var i,r=["Picture","Chart","圖片","Grafik","image","Graphic","_x0000_s","_x0000_i","img1","Immagine"],t=0;t<r.length;t++)if(i=r[t],"image"===i){if(n.toLowerCase().indexOf(i)>=0)return!1}else if(n.indexOf(i)>=0)return!1;return!0},n.prototype.extractImageInfo=function(n,t,i){for(var u,f,e,o,r=0;r<n.length;r++)u=n[r],u.classList.contains("e-rte-image-unsupported")||(f=u.getAttribute("src"),t.push(f),e=f.split("/"),o=e[e.length-1].split(".")[0]+r,i.push(o))},n.prototype.processHexValues=function(n,i){for(var r,u=0;u<n.length;u++)r=n[u],i.push({base64Data:t.isNullOrUndefined(r.hex)?null:this.convertToBase64(r),isCroppedImage:r.isCroppedImage}),r.isCroppedImage&&this.cropImageDimensions.push({goalWidth:r.goalWidth,goalHeight:r.goalHeight,cropLength:r.cropLength,cropTop:r.cropTop,cropR:r.cropR,cropB:r.cropB})},n.prototype.updateImageSources=function(n,i,r,u){for(var f,s,o,c=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.)|(blob\:))|(data:image\/[a-zA-Z]+;base64,[\w+/=]+)(\S+))/gi),h=n.querySelectorAll("img:not(.e-rte-image-unsupported)"),e=0;e<h.length;e++)f=h[e],s=i[e],s.match(c)?f.setAttribute("src",s):(o=r[e],t.isNullOrUndefined(o)||t.isNullOrUndefined(o.base64Data)?(f.removeAttribute("src"),f.classList.add("e-rte-image-unsupported")):f.setAttribute("src",o.base64Data),!t.isNullOrUndefined(o)&&o.isCroppedImage&&f.classList.add("e-img-cropped")),f.setAttribute("id","msWordImg-"+u[e])},n.prototype.cleanUnsupportedImages=function(n){for(var i=n.querySelectorAll(".e-rte-image-unsupported"),t=0;t<i.length;t++)i[t].removeAttribute("src")},n.prototype.checkVShape=function(n){for(var r,u=n.querySelectorAll("*"),i=0;i<u.length;i++){r=u[i];switch(r.nodeName){case"V:SHAPETYPE":t.detach(r);break;case"V:SHAPE":this.processVShapeElement(r)}}},n.prototype.processVShapeElement=function(n){var i=n.firstElementChild,u,r;i&&"V:IMAGEDATA"===i.nodeName&&(u=i.getAttribute("src"),r=t.createElement("img"),r.setAttribute("src",u),n.parentElement.insertBefore(r,n),t.detach(n))},n.prototype.convertToBase64=function(n){var i=this.conHexStringToBytes(n.hex),r=this.conBytesToBase64(i),t=n.type;return t?"data:"+t+";base64,"+r:null},n.prototype.conBytesToBase64=function(n){for(var t,e="",o=n.length,u=0;u<o;u+=3){var i=n.slice(u,u+3),f=i.length,r=[];if(f<3)for(t=f;t<3;t++)i[t]=0;for(r[0]=(252&i[0])>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|(192&i[2])>>6,r[3]=63&i[2],t=0;t<4;t++)e+=t<=f?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r[t]):"="}return e},n.prototype.conHexStringToBytes=function(n){for(var r,u,i=[],f=n.length/2,t=0;t<f;t++)r=n.substr(2*t,2),u=parseInt(r,16),i.push(u);return i},n.prototype.hexConversion=function(n){var s=RegExp,u=new s("\\{\\\\pict[\\s\\S]+?\\\\bliptag-?\\d+(\\\\blipupi-?\\d+)?(\\{\\\\\\*\\\\blipuid\\s?[\\da-fA-F]+)?[\\s\\}]*?"),h=new s("(?:("+u.source+"))([\\da-fA-F\\s]+)\\}","g"),f=n.match(h),e=[],r,i,o;if(t.isNullOrUndefined(f))return e;for(r=0;r<f.length;r++)i=f[r],(-1===i.indexOf("fIsBullet")||-1!==i.indexOf("wzName"))&&u.test(i)&&(o=this.extractImageData(i,u),o&&e.push(o));return e},n.prototype.extractImageData=function(n,t){var r=null,u,i;if(-1!==n.indexOf("\\pngblip"))r="image/png";else if(-1!==n.indexOf("\\jpegblip"))r="image/jpeg";else{if(-1===n.indexOf("\\emfblip"))return null;r=null}return u=this.isImageCropped(n),i={goalWidth:0,goalHeight:0,cropLength:0,cropTop:0,cropR:0,cropB:0},u&&(i.goalWidth=this.extractCropValue("wgoal",n),i.goalHeight=this.extractCropValue("hgoal",n),i.cropLength=this.extractCropValue("cropl",n),i.cropTop=this.extractCropValue("cropt",n),i.cropR=this.extractCropValue("cropr",n),i.cropB=this.extractCropValue("cropb",n)),{hex:r?n.replace(t,"").replace(/[^\da-fA-F]/g,""):null,type:r,isCroppedImage:u,goalWidth:i.goalWidth,goalHeight:i.goalHeight,cropLength:i.cropLength,cropTop:i.cropTop,cropR:i.cropR,cropB:i.cropB}},n.prototype.isImageCropped=function(n){var t=this.extractCropValue("cropl",n)>0&&this.extractCropValue("cropt",n)>0,i=this.extractCropValue("cropr",n)>0,r=this.extractCropValue("cropb",n)>0;return t||i||r},n.prototype.extractCropValue=function(n,t){var r=t.replace(/\r\n\\/g,"\\").replace(/\n/g,"\\"),i=new RegExp("\\\\pic"+n+"(\\-?\\d+)\\\\").exec(r);return!i||i.length<2?0:parseInt(i[1],10)},n.prototype.removeClassName=function(n){for(var i=n.querySelectorAll("*[class]:not(.e-img-cropped):not(.e-rte-image-unsupported)"),t=0;t<i.length;t++)i[t].removeAttribute("class")},n.prototype.breakLineAddition=function(n){for(var f,i,e,u=n.querySelectorAll("*"),r=0;r<u.length;r++)f=u[r],this.isReplacableWithBreak(f)&&(i=this.findDetachElem(f),e=t.createElement("br"),this.hasNonBreakingSpace(i)||t.isNullOrUndefined(i.parentElement)||(i.parentElement.insertBefore(e,i),t.detach(i)))},n.prototype.isReplacableWithBreak=function(n){var i=0===n.children.length,r="&nbsp;"===n.innerHTML,u=!n.closest("li"),f=!n.closest("td"),e="SPAN"!==n.nodeName,o="SPAN"===n.nodeName&&t.isNullOrUndefined(n.previousElementSibling)&&t.isNullOrUndefined(n.nextElementSibling);return i&&r&&u&&f&&(e||o)},n.prototype.hasNonBreakingSpace=function(n){var i=n.textContent.length>0,t=n.textContent.match(/\u00a0/g),r=null!==t&&t.length>0;return i&&r},n.prototype.findDetachElem=function(n){var i=n.parentElement;if(t.isNullOrUndefined(i))return n;var r=""===i.textContent.trim(),u="TD"!==i.tagName&&"TH"!==i.tagName,f=t.isNullOrUndefined(i.querySelector("img"));return r&&u&&f?this.findDetachElem(i):n},n.prototype.removeUnwantedElements=function(n){this.removeStyleElements(n);this.removeElementsByTagName(n)},n.prototype.removeStyleElements=function(n){var i=n.querySelector("style");t.isNullOrUndefined(i)||t.detach(i)},n.prototype.removeElementsByTagName=function(n){for(var t=n.innerHTML,r=RegExp,i=0;i<this.removableElements.length;i++){var u=this.removableElements[i],f=new r("<"+u+"\\s*[^>]*>","g"),e=new r("<\/"+u+">","g");t=(t=t.replace(f,"")).replace(e,"")}n.innerHTML=t;n.querySelectorAll(":empty")},n.prototype.findDetachEmptyElem=function(n){if(t.isNullOrUndefined(n.parentElement))return null;var i=n.parentElement,r=!this.hasNonBreakingSpace(i)&&""===i.textContent.trim(),u="MSWord-Content"!==i.getAttribute("id"),f=!this.hasParentWithClass(n,"MsoListParagraph"),e=t.isNullOrUndefined(i.querySelector("img"));return r&&u&&f&&e?this.findDetachEmptyElem(i):n},n.prototype.hasParentWithClass=function(n,i){for(var r=n.parentElement;!t.isNullOrUndefined(r);){if(r.classList.contains(i))return!0;r=r.parentElement}return!1},n.prototype.removeEmptyElements=function(n){for(var i,e,f,u=n.querySelectorAll(":empty"),r=0;r<u.length;r++)i=u[r],this.isEmptyCellWithMsoNormal(i)&&(i.innerHTML="-"),e=this.isDivWithoutBorder(i),this.shouldRemoveEmptyElement(i,e)&&(f=this.findDetachEmptyElem(i),t.isNullOrUndefined(f)||t.detach(f))},n.prototype.isEmptyCellWithMsoNormal=function(n){var i=n.closest("td");return!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.querySelector(".MsoNormal"))},n.prototype.isDivWithoutBorder=function(n){if("DIV"!==n.tagName)return!0;var t=n.style.borderBottom;return"none"===t||""===t},n.prototype.shouldRemoveEmptyElement=function(n,t){return-1===["IMG","BR","IFRAME","TD","TH","HR"].indexOf(n.tagName)&&t},n.prototype.removeEmptyMetaTags=function(n){for(var u,r=n.querySelectorAll("meta:empty"),i=r.length-1;i>=0;i--)u=r[i],""===u.textContent&&t.detach(u)},n.prototype.styleCorrection=function(n,i){var r=n.querySelectorAll("style"),f=[],e,o,s,u;0!==r.length&&(e=/[\S ]+\s+{[\s\S]+?}/gi,t.isNullOrUndefined(r[0].innerHTML.match(e))?r.length>1&&(f=r[1].innerHTML.match(e)):f=r[0].innerHTML.match(e),o=t.isNullOrUndefined(f)?null:this.findStyleObject(f),t.isNullOrUndefined(o)||(s=Object.keys(o),u=s.map(function(n){return o[""+n]}),u=this.removeUnwantedStyle(u,i),this.filterStyles(n,i),this.applyStylesToElements(n,s,u),this.processListStyles(n,s,u)))},n.prototype.filterStyles=function(n,t){for(var f,h,r=n.querySelectorAll("*[style]"),i=0;i<r.length;i++){for(var e=r[i],o=e.getAttribute("style").split(";"),s="",u=0;u<o.length;u++)f=o[u],h=f.split(":")[0].trim(),t.indexOf(h)>=0&&(s+=f+";");e.style.cssText=s}},n.prototype.applyStylesToElements=function(n,t,i){for(var h,o,s=!1,r=0;r<t.length;r++){var u=t[r],f=u.split("."),e=f[0];if(""===e)h=f[1],o=n.getElementsByClassName(h),s=!0;else{if(1===f.length&&e.indexOf("@")>=0||/^(p|div|li)\.(1|10|11)$/.test(u))continue;o=1===f.length&&e.indexOf("@")<0?n.getElementsByTagName(e):n.querySelectorAll(u)}this.applyStyleToElementCollection(o,u,i[r],s);s=!1}},n.prototype.applyStyleToElementCollection=function(n,i,r,u){for(var f,e,s,h,o=0;o<n.length;o++)f=n[o],f.closest("li")&&"p"===i||(e=f.getAttribute("style"),t.isNullOrUndefined(e)||""===e.trim()?(r=r.replace(/text-indent:-.*?;?/g,"").replace(/border:\s*none;?/g,"").trim(),f.style.cssText=r):(s=r.split(";"),this.removeBorderNoneStyles(s),u||this.removeOverlappingStyles(s,e),h=s.join(";")+";"+e,f.style.cssText=h))},n.prototype.removeBorderNoneStyles=function(n){for(var i,t=0;t<n.length;t++)i=n[t].split(":"),"border"===i[0]&&"none"===i[1]&&(n.splice(t,1),t--)},n.prototype.removeOverlappingStyles=function(n,t){for(var r,i=0;i<n.length;i++)r=n[i].split(":")[0],t.indexOf(r+":")>=0&&(n.splice(i,1),i--)},n.prototype.processListStyles=function(n,t,i){for(var o,u=["MsoListParagraphCxSpFirst","MsoListParagraphCxSpMiddle","MsoListParagraphCxSpLast"],r=0;r<u.length;r++){var f=u[r],s="li."+f,e=t.indexOf(s);e>-1&&(o=n.querySelectorAll("ol."+f+", ul."+f),this.adjustListMargins(o,i[e]))}},n.prototype.adjustListMargins=function(n,i){for(var u,e,o,f,s,h,r=0;r<n.length;r++)if(u=n[r],e=u.getAttribute("style"),!t.isNullOrUndefined(e)&&""!==e.trim()&&""!==u.style.marginLeft)for(o=i.split(";"),f=0;f<o.length;f++)s=o[f],h=s.split(":")[0],"margin-left".indexOf(h)>=0&&this.adjustMarginLeftValue(u,s)},n.prototype.adjustMarginLeftValue=function(n,i){var r=i.split(":")[1],u=n.style.marginLeft,f,e;!t.isNullOrUndefined(r)&&r.indexOf("in")>=0&&u.indexOf("in")>=0&&(f=parseFloat(r.split("in")[0]),e=parseFloat(u.split("in")[0]),n.style.marginLeft=e-f+"in")},n.prototype.removeUnwantedStyle=function(n,t){for(var f,s,r=[],i=0;i<n.length;i++){for(var e=n[i].split(";"),o="",u=0;u<e.length;u++)f=e[u],s=f.split(":")[0],t.indexOf(s)>=0&&(o+=f+";");r[i]=o}return r},n.prototype.findStyleObject=function(n){for(var e,i,r={},t=0;t<n.length;t++){var o=n[t],u=o.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),f=o.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");for(u=this.cleanupStyleText(u),f=this.cleanupStyleText(f),e=u.split(", "),i=0;i<e.length;i++)r[e[i]]=f}return r},n.prototype.cleanupStyleText=function(n){var t=n;return(t=t.replace(/^[\s]|[\s]$/gm,"")).replace(/\n|\r|\n\r/g,"")},n.prototype.removingComments=function(n){var t=n.innerHTML.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.prototype.listCleanUp=function(n,t){for(var i,e=[],u=!1,f=n.querySelectorAll("*"),r=0;r<f.length;r++)i=f[r],this.shouldIgnoreElement(i)?e.push(i):(this.isMsoListParagraph(i)&&(this.isFirstListItem(i)&&t.length>0&&null!==t[t.length-1]&&t.push(null),t.push(i)),this.shouldAddListSeparator(u,i)&&t.push(null),this.isBlockElement(i)&&(u=this.isMsoListParagraph(i)));return t.length>0&&null!==t[t.length-1]&&t.push(null),t},n.prototype.shouldIgnoreElement=function(n){var t=-1===this.ignorableNodes.indexOf(n.nodeName),i=3===n.nodeType&&""===n.textContent.trim();return t||i},n.prototype.isMsoListParagraph=function(n){var i=n.className,u=i&&-1!==i.toLowerCase().indexOf("msolistparagraph"),r=n.getAttribute("style"),f=!t.isNullOrUndefined(r)&&r.indexOf("mso-list:")>=0;return u&&f},n.prototype.isFirstListItem=function(n){return n.className.indexOf("MsoListParagraphCxSpFirst")>=0},n.prototype.shouldAddListSeparator=function(n,t){return n&&this.isBlockElement(t)&&!this.isMsoListParagraph(t)},n.prototype.isBlockElement=function(n){return-1!==this.blockNode.indexOf(n.nodeName.toLowerCase())},n.prototype.listConverter=function(n){var t=[];this.processListNodes(n,t,[],"");this.replaceNodesWithLists(n,t)},n.prototype.processListNodes=function(n,i,r,u){for(var h,f,o,l,v,e=0;e<n.length;e++)if(f=n[e],null!==f){if(this.fixOutlineLevel(f),o=f.getAttribute("style")||"",l=this.extractNestingLevel(o),h=this.extractListFormatOverride(o,h),this.listContents=[],this.getListContent(f),!t.isNullOrUndefined(this.listContents[0])){for(var s=this.determineListProperties(this.listContents[0],e,n,f),a=[],c=1;c<this.listContents.length;c++)a.push(this.listContents[c]);v=t.isNullOrUndefined(f.className)?"":f.className;u=this.updateNodeStyle(f,o);r.push({listType:s.type,content:a,nestedLevel:l,listFormatOverride:h,"class":v,listStyle:u,listStyleTypeName:s.styleType,start:s.startAttr,styleMarginLeft:s.marginLeft})}}else i.push({content:this.makeConversion(r),node:n[e-1]}),r=[]},n.prototype.fixOutlineLevel=function(n){var t=n.getAttribute("style");t&&-1!==t.indexOf("mso-outline-level")&&(n.style.cssText=t.replace("mso-outline-level","mso-outline"))},n.prototype.extractNestingLevel=function(n){return n&&-1!==n.indexOf("level")?parseInt(n.charAt(n.indexOf("level")+5),null):1},n.prototype.extractListFormatOverride=function(n,i){if(n&&-1!==n.indexOf("mso-list:")){if(n.match(/mso-list:[^;]+;?/)){var r=n.replace(new RegExp("\\n","g"),"").split(" ").join("").match(/mso-list:[^;]+;?/)[0].split(":l");return t.isNullOrUndefined(r)?null:parseInt(r[1].split("level")[0],10)}return null}return i},n.prototype.determineListProperties=function(n,t,i,r){var u={type:n.trim().length>1?"ol":"ul",styleType:""};return u.styleType=this.getlistStyleType(n,u.type),"ol"!==u.type||0!==t&&null!==i[t-1]||(u.startAttr=this.determineStartAttribute(n,u.styleType)),""!==r.style.marginLeft&&(u.marginLeft=r.style.marginLeft),u},n.prototype.determineStartAttribute=function(n,t){var i=n.split(".")[0];if(-1===["A","a","I","i","α","1","01","1-"].indexOf(i))switch(t){case"decimal":case"decimal-leading-zero":if(!isNaN(parseInt(i,10)))return parseInt(i,10);break;case"upper-alpha":return i.split(".")[0].charCodeAt(0)-64;case"lower-alpha":return i.split(".")[0].charCodeAt(0)-96;case"upper-roman":return this.upperRomanNumber.indexOf(i.split(".")[0])+1;case"lower-roman":return this.lowerRomanNumber.indexOf(i.split(".")[0])+1;case"lower-greek":return this.lowerGreekNumber.indexOf(i.split(".")[0])+1;default:return}},n.prototype.updateNodeStyle=function(n,i){return t.isNullOrUndefined(n.getAttribute("style"))?"":(n.style.cssText=i.replace("text-align:start;",""),n.style.textIndent="",n.getAttribute("style"))},n.prototype.replaceNodesWithLists=function(n,t){for(var f,u,e,r,i=n.shift();i;){for(f=[],u=0;u<t.length;u++)if(t[u].node===i){for(e=t[u].content,r=0;r<e.childNodes.length;r++)f.push(e.childNodes[r]);for(r=0;r<f.length;r++)i.parentElement.insertBefore(f[r],i);break}i.remove();(i=n.shift())||(i=n.shift())}},n.prototype.getlistStyleType=function(n,t){var i=n.split(".")[0];return"ol"===t?this.getOrderedListStyleType(i):this.getUnorderedListStyleType(i)},n.prototype.getOrderedListStyleType=function(n){var t=n.charCodeAt(0);return this.upperRomanNumber.indexOf(n)>-1?"upper-roman":this.lowerRomanNumber.indexOf(n)>-1?"lower-roman":this.lowerGreekNumber.indexOf(n)>-1?"lower-greek":t>64&&t<91?"upper-alpha":t>96&&t<123?"lower-alpha":n.length>1&&"0"===n[0]&&!isNaN(Number(n))?"decimal-leading-zero":"decimal"},n.prototype.getUnorderedListStyleType=function(n){switch(n){case"o":return"circle";case"§":return"square";default:return"disc"}},n.prototype.makeConversion=function(n){var o,f=t.createElement("div"),e="e-current-list-item",i,a,s,h;if(0===n.length)return f;for(var r,c=1,v=0,l=n[0].listFormatOverride,u=0;u<n.length;u++)i=n[u],a=this.isStandardListType(i.class),r&&r.classList.remove(e),this.shouldResetListItem(r,u,n,a)&&(r=null),s=this.createParagraphWithContent(i),this.isNewRootList(i,v,l)?r=(o=this.createRootList(f,i,s)).querySelector("."+e):this.isSameLevelList(i,c,l)?r=(o=this.addToSameLevelList(i,o,s,r,f)).querySelector("."+e):this.isDeeperNestedList(i,c)?r=(o=this.createNestedList(i,r,s,a,f,c)).querySelector("."+e):this.isTopLevelList(i)?r=(o=this.handleTopLevelList(i,f,s)).querySelector("."+e):(this.handleOtherNestingScenarios(i,r,s,l),r=f.querySelector("."+e)),this.applyListItemStyles(r,i),c=i.nestedLevel,l=i.listFormatOverride,v++,this.setStartAttributeIfNeeded(o,i);for(h=f.querySelectorAll("."+e),u=0;u<h.length;u++)h[u].classList.remove(e),""===h[u].className&&h[u].removeAttribute("class");return f},n.prototype.isStandardListType=function(n){for(var r=["MsoListParagraphCxSpFirst","MsoListParagraphCxSpMiddle","MsoListParagraphCxSpLast"],i=0;i<r.length;i++)if(!t.isNullOrUndefined(n)&&r[i].indexOf(n)>=0)return!0;return!1},n.prototype.shouldResetListItem=function(n,i,r,u){return!t.isNullOrUndefined(n)&&0!==i&&r[i-1].listType!==r[i].listType&&!u},n.prototype.createParagraphWithContent=function(n){var i=t.createElement("p",{className:"MsoNoSpacing"});return i.innerHTML=n.content.join(" "),i},n.prototype.isNewRootList=function(n,t,i){return 1===n.nestedLevel&&(0===t||i!==n.listFormatOverride)&&n.content.length>0},n.prototype.createRootList=function(n,i,r){var u=t.createElement(i.listType,{className:i.class}),f=t.createElement("li");return f.appendChild(r),u.appendChild(f),n.appendChild(u),u.setAttribute("level",i.nestedLevel.toString()),"msolistparagraph"!==i.class?u.style.marginLeft=i.styleMarginLeft:t.addClass([u],"marginLeftIgnore"),u.style.listStyleType=i.listStyleTypeName,f.classList.add("e-current-list-item"),u},n.prototype.isSameLevelList=function(n,t,i){return n.nestedLevel===t&&i===n.listFormatOverride},n.prototype.addToSameLevelList=function(n,i,r,u,f){var e,o;return t.isNullOrUndefined(u)||t.isNullOrUndefined(u.parentElement)||u.parentElement.tagName.toLowerCase()!==n.listType?t.isNullOrUndefined(u)?((e=t.createElement(n.listType)).style.listStyleType=n.listStyleTypeName,(o=t.createElement("li")).classList.add("e-current-list-item"),o.appendChild(r),e.appendChild(o),e.setAttribute("level",n.nestedLevel.toString()),f.appendChild(e),e):((e=t.createElement(n.listType)).style.listStyleType=n.listStyleTypeName,(o=t.createElement("li")).classList.add("e-current-list-item"),o.appendChild(r),e.appendChild(o),e.setAttribute("level",n.nestedLevel.toString()),u.parentElement.parentElement.appendChild(e),e):((o=t.createElement("li")).classList.add("e-current-list-item"),o.appendChild(r),u.parentElement.appendChild(o),u.parentElement)},n.prototype.isDeeperNestedList=function(n,t){return n.nestedLevel>t},n.prototype.createNestedList=function(n,i,r,u,f,e){var o,s,h;if(t.isNullOrUndefined(i))return u?this.createStandardNestedList(n,r,f):this.createRootList(f,n,r);for(s=n.nestedLevel-e,h=0;h<s;h++)o=t.createElement(n.listType),i.appendChild(o),i=t.createElement("li"),h!==s-1&&s>1&&(i.style.listStyleType="none"),o.appendChild(i);return i.classList.add("e-current-list-item"),i.appendChild(r),o.setAttribute("level",n.nestedLevel.toString()),o.style.listStyleType=n.listStyleTypeName,o},n.prototype.createStandardNestedList=function(n,i,r){var u,e=t.createElement(n.listType),f=t.createElement("li"),o;for(e.appendChild(f),e.style.listStyleType="none",o=0;o<n.nestedLevel-1;o++)u=t.createElement(n.listType),f.appendChild(u),f=t.createElement("li"),u.appendChild(f),u.style.listStyleType="none";return f.classList.add("e-current-list-item"),f.appendChild(i),r.appendChild(e),u.setAttribute("level",n.nestedLevel.toString()),u.style.listStyleType=n.listStyleTypeName,u},n.prototype.getLastListItem=function(n){return n.querySelector("li:last-child")},n.prototype.isTopLevelList=function(n){return 1===n.nestedLevel},n.prototype.handleTopLevelList=function(n,i,r){var u,e=i.lastChild,f;return e&&e.tagName.toLowerCase()===n.listType?u=e:((u=t.createElement(n.listType)).style.listStyleType=n.listStyleTypeName,i.appendChild(u)),f=t.createElement("li"),f.appendChild(r),u.appendChild(f),u.setAttribute("level",n.nestedLevel.toString()),f.classList.add("e-current-list-item"),u},n.prototype.handleOtherNestingScenarios=function(n,i,r,u){for(var o,h,s,e,f=i;f.parentElement;)if(h=(f=f.parentElement).attributes.getNamedItem("level"),h){if(s=parseInt(h.textContent,10),s===n.nestedLevel&&u===n.listFormatOverride){(e=t.createElement("li")).appendChild(r);f.appendChild(e);e.classList.add("e-current-list-item");break}if(s===n.nestedLevel&&u!==n.listFormatOverride){this.createDifferentFormatList(n,f,r);break}if(n.nestedLevel>s){o=t.createElement(n.listType);(e=t.createElement("li")).appendChild(r);o.appendChild(e);f.appendChild(o);o.setAttribute("level",n.nestedLevel.toString());o.style.listStyleType=n.listStyleTypeName;e.classList.add("e-current-list-item");break}}},n.prototype.createDifferentFormatList=function(n,i,r){var u=t.createElement(n.listType),f=t.createElement("li"),e;if(u.appendChild(f),n.nestedLevel>1)for(e=0;e<n.nestedLevel-1;e++)f.appendChild(u=t.createElement(n.listType)),f=t.createElement("li"),u.appendChild(f),u.style.listStyleType="none";f.appendChild(r);f.classList.add("e-current-list-item");i.appendChild(u);u.setAttribute("level",n.nestedLevel.toString());u.style.listStyleType=n.listStyleTypeName},n.prototype.applyListItemStyles=function(n,i){t.isNullOrUndefined(n)||(n.setAttribute("class",i.class),n.style.cssText=t.isNullOrUndefined(i.listStyle)?"":i.listStyle)},n.prototype.setStartAttributeIfNeeded=function(n,i){t.isNullOrUndefined(i.start)||1===i.start||"ol"!==i.listType||n.setAttribute("start",i.start.toString())},n.prototype.getListContent=function(n){var t=n.firstElementChild;this.isImageList(t)?this.handleImageList(n):t.childNodes.length>0&&this.handleTextList(n,t);this.listContents.push(n.innerHTML)},n.prototype.isImageList=function(n){return""===n.textContent.trim()&&!t.isNullOrUndefined(n.firstElementChild)&&"IMG"===n.firstElementChild.nodeName},n.prototype.handleImageList=function(n){var t=n.innerHTML.trim();this.listContents.push("");this.listContents.push(t)},n.prototype.handleTextList=function(n,t){this.cleanupListIgnoreTags(t);var i=this.cleanupListOrder(t);this.processListOrderElement(n,t,i)},n.prototype.cleanupListIgnoreTags=function(n){for(var r,u,i=n.querySelectorAll('[style*="mso-list"]'),t=0;t<i.length;t++)r=i[t],u=r.getAttribute("style").replace(/\n/g,""),r.setAttribute("style",u)},n.prototype.cleanupListOrder=function(n){var i=n.querySelector('span[style*="mso-list"]'),t;return i&&(t=i.getAttribute("style"),t&&(t=t.replace(/\s*:\s*/g,":"),i.setAttribute("style",t))),n.querySelector('span[style="mso-list:Ignore"]')},n.prototype.processListOrderElement=function(n,i,r){var f=t.isNullOrUndefined(r),u;(r=f?i:r,t.isNullOrUndefined(r))||(u=r.textContent.trim(),f&&(u=this.extractBulletMarker(r,u)),this.listContents.push(u),f||t.detach(r),this.removingComments(n),this.removeUnwantedElements(n))},n.prototype.extractBulletMarker=function(n,i){var u=i.match(/^(\d{1,2}|[a-zA-Z]|[*#~•○■])(\.|\)|-)\s*/),r;return t.isNullOrUndefined(u)?i:(r=u[0].trim(),n.textContent=n.textContent.trim().substring(r.length).trim(),r)},n.prototype.processMargin=function(n){this.processListItemMargins(n);this.processTableMargins(n);this.processIgnoredNodeMargins(n)},n.prototype.processListItemMargins=function(n){for(var r,u=n.querySelectorAll("li"),i=0;i<u.length;i++)r=u[i],t.isNullOrUndefined(r.style.marginLeft)||r.parentElement.classList.contains("marginLeftIgnore")||(r.style.marginLeft="")},n.prototype.processTableMargins=function(n){for(var u,f,r=n.querySelectorAll("table"),i=0;i<r.length;i++)u=r[i],f=u.style.marginLeft,!t.isNullOrUndefined(f)&&f.indexOf("-")>=0&&(u.style.marginLeft="")},n.prototype.processIgnoredNodeMargins=function(n){for(var f,r,e,u=n.querySelectorAll(".marginLeftIgnore li"),i=0;i<u.length;i++)f=u[i],r=f.style.marginLeft,t.isNullOrUndefined(r)||""===r||(e=parseFloat(r.split("in")[0])-.5,f.style.marginLeft=e.toString()+"in")},n.prototype.removeEmptyAnchorTag1=function(n){for(var r,i=n.querySelectorAll("a:not([href])"),t=i.length-1;t>=0;t--){for(r=i[t].parentNode;i[t].firstChild;)r.insertBefore(i[t].firstChild,i[t]);r.removeChild(i[t])}},n.prototype.removeEmptyAnchorTag=function(n){for(var t,u,r=n.querySelectorAll("a:not([href])"),i=r.length-1;i>=0;i--){for(t=r[i],u=t.parentNode;t.firstChild;)u.insertBefore(t.firstChild,t);u.removeChild(t)}},n.prototype.findSource=function(n){for(var i,f,r=n.querySelectorAll("meta"),t=0;t<r.length;t++){var e=r[t],u=e.getAttribute("content"),o=e.getAttribute("name");if(o&&o.toLowerCase().indexOf("generator")>=0&&u&&u.toLowerCase().indexOf("microsoft")>=0)for(i=0;i<up.length;i++)if(f=up[i],u.toLowerCase().indexOf(f)>=0)return f}return"html"},n.prototype.handleOneNoteContent=function(n){for(var i=n.querySelectorAll("ul, ol"),t=0;t<i.length;t++){var r=i[t],u=0===r.querySelectorAll("li").length,f=r.childNodes.length>0;u&&f&&h.unwrap(r)}},n.prototype.destroy=function(){this.removeEventListener()},n}(),dit=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ip,this.insertText,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(ip,this.insertText);this.parent.observer.off(f,this.destroy)},n.prototype.insertText=function(n){var t=document.createTextNode(n.value);kt.Insert(this.parent.currentDocument,t,this.parent.editableElement);n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n}(),git=function(){function n(n){this.clickCount=0;this.lastClickTime=0;this.currentDocument=n.document;this.editableElement=n.editableElement;this.nodeSelection=new st(this.editableElement);this.nodeCutter=new su;this.domNode=new oh(this.editableElement,this.currentDocument);this.domTree=new hu(this.editableElement);this.observer=new t.Observer(this);this.listObj=new cit(this);this.formatObj=new lit(this);this.alignmentObj=new ait(this);this.indentsObj=new vit(this);this.selectionObj=new yit(this);this.inserthtmlObj=new pit(this);this.insertTextObj=new dit(this);this.clearObj=new wit(this);this.undoRedoManager=new bit(this,n.options);this.msWordPaste=new kit(this);this.tableCellSelection=new hit(this.editableElement,this.currentDocument);this.userAgentData=new sh(t.Browser.userAgent,!1);this.wireEvents();this.isDestroyed=!1}return n.prototype.wireEvents=function(){this.observer.on(we,this.editorKeyDown,this);this.observer.on(yr,this.editorKeyUp,this);this.observer.on(yr,this.editorKeyUp,this);this.observer.on(gu,this.onPropertyChanged,this);this.observer.on(cv,this.onWordPaste,this);this.observer.on(lv,this.onBegin,this);this.observer.on(ik,this.editorMouseDown,this);this.observer.on(rk,this.destroy,this)},n.prototype.unwireEvents=function(){this.observer.off(we,this.editorKeyDown);this.observer.off(yr,this.editorKeyUp);this.observer.off(yr,this.editorKeyUp);this.observer.off(gu,this.onPropertyChanged);this.observer.off(cv,this.onWordPaste);this.observer.off(lv,this.onBegin);this.observer.off(ik,this.editorMouseDown);this.observer.off(rk,this.destroy)},n.prototype.onWordPaste=function(n){this.observer.notify(hv,n)},n.prototype.onPropertyChanged=function(n){this.observer.notify(pr,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(c,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(ei,n)},n.prototype.onBegin=function(n){this.observer.notify(av,n)},n.prototype.execCommand=function(n,t,i,r,u,f,e,o){switch(n.toLowerCase()){case"lists":case"checklist":this.observer.notify(ov,{subCommand:t,event:i,callBack:r,selector:e,item:f,enterAction:o});break;case"codeblock":this.observer.notify(sv,{subCommand:t,event:i,callBack:r,selector:e,item:f,enterAction:o});break;case"formats":this.observer.notify(du,{subCommand:t,event:i,callBack:r,selector:e,exeValue:f,enterAction:o});break;case"alignments":this.observer.notify(dy,{subCommand:t,event:i,callBack:r,selector:e,value:f,enterAction:o});break;case"indents":this.observer.notify(gy,{subCommand:t,event:i,callBack:r,selector:e,enterAction:o});break;case"links":this.observer.notify(eh,{command:n,value:t,item:f,event:i,callBack:r,enterAction:o});break;case"files":this.observer.notify(no,{command:n,value:"Image",item:f,event:i,callBack:r,selector:e});break;case"images":this.observer.notify(no,{command:n,value:t,item:f,event:i,callBack:r,selector:e});break;case"audios":this.observer.notify(uy,{command:n,value:t,item:f,event:i,callBack:r,selector:e});break;case"videos":this.observer.notify(fy,{command:n,value:t,item:f,event:i,callBack:r,selector:e});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(ey,{item:f,event:i,callBack:r,enterAction:o});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(oy,{item:f,event:i,callBack:r});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(sy,{item:f,event:i,callBack:r});break;case"deleterow":this.observer.notify(hy,{item:f,event:i,callBack:r});break;case"deletecolumn":this.observer.notify(cy,{item:f,event:i,callBack:r});break;case"tableremove":this.observer.notify(ly,{item:f,event:i,callBack:r});break;case"tableheader":this.observer.notify(ay,{item:f,event:i,callBack:r});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(vy,{item:f,event:i,callBack:r});break;case"merge":this.observer.notify(yy,{item:f,event:i,callBack:r});break;case"horizontalsplit":this.observer.notify(wy,{item:f,event:i,callBack:r});break;case"verticalsplit":this.observer.notify(py,{item:f,event:i,callBack:r});break;case"dashed":case"alternate":case"custom":this.observer.notify(by,{item:f,event:i,callBack:r});break;case"backgroundcolor":this.observer.notify(ky,{subCommand:t,value:f,event:i,callBack:r})}break;case"font":case"style":case"effects":case"casing":this.observer.notify(np,{subCommand:t,event:i,callBack:r,value:u,selector:e,enterAction:o});break;case"inserthtml":this.observer.notify(tp,{subCommand:t,callBack:r,value:u,enterAction:o});break;case"inserttext":this.observer.notify(ip,{subCommand:t,callBack:r,value:u});break;case"clear":this.observer.notify(rp,{subCommand:t,event:i,callBack:r,selector:e,enterAction:o});break;case"actions":this.observer.notify(ku,{subCommand:t,event:i,callBack:r,selector:e});break;case"formatpainter":this.observer.notify(vv,{item:f,subCommand:t,event:i,callBack:r});break;case"emojipicker":this.observer.notify(yv,{item:f,subCommand:t,value:u,event:i,callBack:r})}},n.prototype.editorMouseDown=function(n){if(3===n.args.detail&&this.tripleClickSelection(n.args),-1!==t.Browser.userAgent.indexOf("Safari")){var i=(new Date).getTime();i-this.lastClickTime>500&&(this.clickCount=0);this.clickCount++;this.lastClickTime=i;3===this.clickCount&&(this.tripleClickSelection(n.args),this.clickCount=0)}},n.prototype.tripleClickSelection=function(n){var f=this.nodeSelection.getRange(this.currentDocument),e=this.nodeSelection.get(this.currentDocument),o=new hu(this.editableElement),t,i;if(e.rangeCount>0&&""!==e.toString()&&(t=this.getParentBlockNode(f.startContainer),i=this.getParentBlockNode(f.endContainer),t&&i&&t===i)){var r=this.currentDocument.createRange(),s=o.getFirstTextNode(t),u=o.getLastTextNode(i);s&&u&&(r.setStart(s,0),r.setEnd(u,u.textContent.length),this.nodeSelection.setRange(this.currentDocument,r),n.preventDefault())}},n.prototype.getParentBlockNode=function(n){var t=this.currentDocument.createTreeWalker(this.editableElement,NodeFilter.SHOW_ELEMENT,{acceptNode:function(n){return window.getComputedStyle(n).display.indexOf("inline")<0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});return t.currentNode=n,t.parentNode()},n.prototype.destroy=function(){this.isDestroyed||(this.unwireEvents(),this.observer.notify(f),this.editableElement&&(this.editableElement=null),this.currentDocument=null,this.nodeCutter&&(this.nodeCutter=null),this.domNode&&(this.domNode=null),this.listObj&&(this.listObj=null),this.formatObj&&(this.formatObj=null),this.alignmentObj&&(this.alignmentObj=null),this.indentsObj&&(this.indentsObj=null),this.linkObj&&(this.linkObj=null),this.imgObj&&(this.imgObj=null),this.audioObj&&(this.audioObj=null),this.videoObj&&(this.videoObj=null),this.selectionObj&&(this.selectionObj=null),this.inserthtmlObj&&(this.inserthtmlObj=null),this.insertTextObj&&(this.insertTextObj=null),this.clearObj&&(this.clearObj=null),this.tableObj&&(this.tableObj=null),this.codeBlockObj&&(this.codeBlockObj=null),this.msWordPaste&&(this.msWordPaste=null),this.formatPainterEditor&&(this.formatPainterEditor=null),this.emojiPickerObj&&(this.emojiPickerObj=null),this.tableCellSelection&&(this.tableCellSelection=null),this.domTree&&(this.domTree=null),this.userAgentData=null,this.isDestroyed=!0)},n.prototype.beforeSlashMenuApplyFormat=function(){for(var t=this.nodeSelection.getRange(this.currentDocument),i=this.nodeSelection.getNodeCollection(t)[0],u=t.startOffset;-1===this.nodeSelection.getRange(this.currentDocument).toString().indexOf("/");)this.nodeSelection.setSelectionText(this.currentDocument,i,i,u,t.endOffset),u--;var f=this.nodeSelection.getRange(this.currentDocument),n=this.nodeCutter.GetSpliceNode(f,i),r=n.previousSibling;n.parentElement&&(1===n.parentElement.innerHTML.length||1===n.parentNode.childNodes.length)&&n.parentElement.appendChild(document.createElement("br"));n.parentNode.removeChild(n);r&&this.nodeSelection.setCursorPoint(document,r,r.textContent.length)},n}(),bi="e-imgright",ki="e-imgleft",ef="e-imgcenter",ep="e-video-right",io="e-video-left",pk="e-video-center",op="e-imgbreak",nrt="e-audio-break",hh="e-video-break",v="e-img-caption",rst="e-rte-img-caption",wk="e-caption-inline",trt="e-imginline",bk="e-audio-inline",kk="e-clickelem",ch="e-video-clickelem",sp="e-rte-audio",ti="e-rte-video",hp="e-audio-wrap",irt="e-video-wrap",dk="e-embed-video-wrap",gk="e-audio-focus",nd="e-video-focus",ro="e-video-inline",st=function(){function n(n){this.startNodeName=[];this.endNodeName=[];this.editableElement=n}return n.prototype.saveInstance=function(n,t){return this.range=n.cloneRange(),this.rootNode=this.documentFromRange(n),this.body=t,this.startContainer=this.getNodeArray(n.startContainer,!0),this.endContainer=this.getNodeArray(n.endContainer,!1),this.startOffset=n.startOffset,this.endOffset=n.endOffset,this.html=this.body.innerHTML,this},n.prototype.documentFromRange=function(n){return 9===n.startContainer.nodeType?n.startContainer:n.startContainer.ownerDocument},n.prototype.getRange=function(n){var i=this.get(n),t=i&&i.rangeCount>0?i.getRangeAt(i.rangeCount-1):n.createRange();return t.startContainer!==n||t.endContainer!==n||t.startOffset||t.endOffset||(t.setStart(n.body,0),t.collapse(!0)),t},n.prototype.get=function(n){return n.defaultView.getSelection()},n.prototype.save=function(n,t){return n=n?n.cloneRange():this.getRange(t),this.saveInstance(n,t.body)},n.prototype.getIndex=function(n){var t=0;if(n=n.previousSibling||"BR"!==n.tagName?n.previousSibling:n)for(n.nodeType;n;null)t++,n.nodeType,n=n.previousSibling;return t},n.prototype.isChildNode=function(n,t){for(var i=0;i<t.childNodes.length;i++)if(n.indexOf(t.childNodes[i])>-1)return!0;return!1},n.prototype.getNode=function(n,t,i){return(!this.editableElement||this.editableElement.contains(n)&&this.editableElement!==n)&&(t!==n||3!==n.nodeType&&n.firstChild&&-1===i.indexOf(n.firstChild)&&!this.isChildNode(i,n))?3===n.nodeType&&n.previousSibling===t&&"IMG"===t.nodeName?null:-1===i.indexOf(n.firstChild)&&n.firstChild&&!this.isChildNode(i,n)?n.firstChild:n.nextSibling?n.nextSibling:n.parentNode?n.parentNode:null:null},n.prototype.getNodeCollection=function(n){var t=n.startContainer.childNodes[n.startOffset]||n.startContainer,u=n.endContainer.childNodes[n.endOffset>0?n.endOffset-1:n.endOffset]||n.endContainer,i=this.processedTableImageCursor(n),r;if((i.start||i.end)&&("TABLE"===i.startName||"TABLE"===i.endName))return[i.start?i.startNode:i.endNode];if((t===u||"BR"===t.nodeName&&t===n.endContainer.childNodes[n.endOffset])&&0===t.childNodes.length)return[t];if(n.startOffset===n.endOffset&&0!==n.startOffset&&"PRE"===n.startContainer.nodeName)return["BR"===t.nodeName||"#text"===t.nodeName?t:t.childNodes[0]];r=[];do-1===r.indexOf(t)&&r.push(t),t=this.getNode(t,u,r);while(t);return r},n.prototype.getParentNodeCollection=function(n){return this.getParentNodes(this.getNodeCollection(n),n)},n.prototype.getParentNodes=function(n,t){n=n.reverse();for(var i=0;i<n.length;i++)-1!==n.indexOf(n[i].parentNode)||3===n[i].nodeType&&t.startContainer!==t.endContainer&&t.startContainer.parentNode!==t.endContainer.parentNode&&t.startContainer.parentNode.tagName&&t.endContainer.parentNode.tagName&&-1!==bt.indexOf(t.startContainer.parentNode.tagName.toLowerCase())&&-1!==bt.indexOf(t.endContainer.parentNode.tagName.toLowerCase())?(n.splice(i,1),i--):3===n[i].nodeType&&(n[i]=n[i].parentNode);return n},n.prototype.getSelectionNodeCollection=function(n){return this.getSelectionNodes(this.getNodeCollection(n))},n.prototype.getSelectionNodeCollectionBr=function(n){return this.getSelectionNodesBr(this.getNodeCollection(n))},n.prototype.getSelectionNodes=function(n){n=n.reverse();for(var i=new RegExp("​","g"),t=0;t<n.length;t++)(3!==n[t].nodeType||""===n[t].textContent.trim()||1===n[t].textContent.length&&n[t].textContent.match(i))&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getSelectionNodesBr=function(n){n=n.reverse();for(var t=0;t<n.length;t++)"BR"===n[t].nodeName||3===n[t].nodeType&&(""!==n[t].textContent.trim()||n[t].textContent.includes(" "))||(n.splice(t,1),t--);return n.reverse()},n.prototype.getInsertNodeCollection=function(n){return this.getInsertNodes(this.getNodeCollection(n))},n.prototype.getInsertNodes=function(n){n=n.reverse();for(var t=0;t<n.length;t++)(0!==n[t].childNodes.length&&3!==n[t].nodeType||3===n[t].nodeType&&""===n[t].textContent)&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getNodeArray=function(n,i,r){var u=[];for(i?this.startNodeName=[]:this.endNodeName=[];n!==(r||this.rootNode)&&!t.isNullOrUndefined(n);null)i?this.startNodeName.push(n.nodeName.toLowerCase()):this.endNodeName.push(n.nodeName.toLowerCase()),u.push(this.getIndex(n)),n=n.parentNode;return u},n.prototype.setRangePoint=function(n,t,i,r){for(var u=this.rootNode,e=i.length,f=r;e--;null)u=u&&u.childNodes[i[e]];return u&&f>=0&&"html"!==u.nodeName&&(3===u.nodeType&&"&nbsp;"===u.nodeValue.replace(/\u00a0/g,"&nbsp;")?f=u.textContent.length:3!==u.nodeType&&(f=Math.min(f,u.childNodes.length)),n[t?"setStart":"setEnd"](u,f)),n},n.prototype.restore=function(){var n=this.range.cloneRange();return n=this.setRangePoint(n,!0,this.startContainer,this.startOffset),n=this.setRangePoint(n,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,n),n},n.prototype.selectRange=function(n,t){this.setRange(n,t);this.save(t,n)},n.prototype.setRange=function(n,t){var i=this.get(n);i.removeAllRanges();i.addRange(t)},n.prototype.setSelectionText=function(n,t,i,r,u){var f=n.createRange();f.setStart(t,r);f.setEnd(i,u);this.setRange(n,f)},n.prototype.setSelectionContents=function(n,t){var i=n.createRange();i.selectNode(t);this.setRange(n,i)},n.prototype.setSelectionNode=function(n,t){var i=n.createRange();i.selectNodeContents(t);this.setRange(n,i)},n.prototype.getSelectedNodes=function(n){return this.getNodeCollection(this.getRange(n))},n.prototype.Clear=function(n){this.get(n).removeAllRanges()},n.prototype.insertParentNode=function(n,t,i){i.surroundContents(t);this.selectRange(n,i)},n.prototype.setCursorPoint=function(n,t,i){var r=n.createRange(),u=n.defaultView.getSelection();r.setStart(t,i);r.collapse(!0);u.removeAllRanges();u.addRange(r)},n.prototype.isTableOrImageStart=function(n){var i=n.startContainer,u=n.startOffset,t=i.childNodes[u],r=n.collapsed&&1===i.nodeType&&i.isContentEditable&&t&&["TABLE"].indexOf(t.nodeName)>-1;return r?{start:r,startNodeName:t.nodeName,startNode:t}:{start:!1,startNodeName:"",startNode:void 0}},n.prototype.isTableOrImageEnd=function(n){var i=n.startContainer,u=n.startOffset,t=i.childNodes[u-1],r=n.collapsed&&1===i.nodeType&&i.isContentEditable&&t&&["TABLE"].indexOf(t.nodeName)>-1;return r?{end:r,endNodeName:t.nodeName,endNode:t}:{end:!1,endNodeName:"",endNode:void 0}},n.prototype.processedTableImageCursor=function(n){var t=this.isTableOrImageStart(n),r=t.start,u=t.startNodeName,f=t.startNode,i=this.isTableOrImageEnd(n);return{start:r,startName:u,end:i.end,endName:i.endNodeName,startNode:f,endNode:i.endNode}},n.prototype.findLastTextPosition=function(n){var t,i;if(n.nodeType===Node.TEXT_NODE)return{node:n,offset:n.textContent?n.textContent.length:0};if("BR"===n.nodeName)return{node:n,offset:0};for(t=n.childNodes.length-1;t>=0;t--)if(i=this.findLastTextPosition(n.childNodes[t]),i)return i;return null},n.prototype.findFirstTextNode=function(n){var i,r;if(n.nodeType===Node.TEXT_NODE)return n;for(i=0;i<n.childNodes.length;i++)if(r=this.findFirstTextNode(n.childNodes[i]),!t.isNullOrUndefined(r))return r;return null},n.prototype.findFirstContentNode=function(n){var t,i;if(n.nodeType===Node.TEXT_NODE)return{node:n,position:0};if("BR"===n.nodeName)return{node:n,position:0};for(t=0;t<n.childNodes.length;t++)if(i=this.findFirstContentNode(n.childNodes[t]),null!==i.node)return i;return{node:n,position:0}},n}(),cp={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,numberFormatList:!1,bulletFormatList:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1,blockquote:!1,inlinecode:!1,isCodeBlock:!1,isCheckList:!1},td=function(){function n(){}return n.get=function(n,i,r,u,f,e){for(var y,o=JSON.parse(JSON.stringify(cp)),h=JSON.parse(JSON.stringify(cp)),l=new st(i),a=l.getRange(n),c=e?[e]:a.collapsed?l.getNodeCollection(a):l.getSelectionNodeCollectionBr(a),p=c.length,v=!1,s=0;s<c.length;s++){for(;c[s]&&3===c[s].nodeType&&3===a.startContainer.nodeType&&c[s].parentNode&&c[s].parentNode.lastElementChild&&"BR"!==c[s].parentNode.lastElementChild.nodeName&&this.getImmediateBlockNode(c[s].parentNode)&&0===this.getImmediateBlockNode(c[s].parentNode).textContent.replace(/\u200B/g,"").length&&0===a.startContainer.textContent.replace(/\u200B/g,"").length&&0===l.get(n).toString().replace(/\u200B/g,"").length;)c[s]=c[s].parentNode.lastElementChild.firstChild,v=!0;v&&c[s]&&(l.setCursorPoint(n,c[s],c[s].textContent.length),v=!1);c[s]&&("BR"!==c[s].nodeName&&3!==c[s].nodeType||p>1&&3===c[s].nodeType&&""===c[s].textContent.trim())&&(c.splice(s,1),s--)}for(s=0;s<c.length;s++)y=t.closest(c[s],"col, colgroup"),t.isNullOrUndefined(y)&&(o=this.getFormatParent(n,o,c[s],i,r,u,f),(0===s&&o.bold||!o.bold)&&(h.bold=o.bold),(0===s&&o.insertcode||!o.insertcode)&&(h.insertcode=o.insertcode),(0===s&&o.isCodeBlock||!o.isCodeBlock)&&(h.isCodeBlock=o.isCodeBlock),(0===s&&o.isCheckList||!o.isCheckList)&&(h.isCheckList=o.isCheckList),(0===s&&o.blockquote||!o.blockquote)&&(h.blockquote=o.blockquote),(0===s&&o.italic||!o.italic)&&(h.italic=o.italic),(0===s&&o.underline||!o.underline)&&(h.underline=o.underline),(0===s&&o.strikethrough||!o.strikethrough)&&(h.strikethrough=o.strikethrough),(0===s&&o.superscript||!o.superscript)&&(h.superscript=o.superscript),(0===s&&o.subscript||!o.subscript)&&(h.subscript=o.subscript),(0===s&&o.fontcolor||!o.fontcolor)&&(h.fontcolor=o.fontcolor),h.fontname=0===s&&o.fontname?o.fontname:o.fontname===h.fontname?o.fontname:"empty",h.fontsize=0===s&&o.fontsize?o.fontsize:o.fontsize===h.fontsize?o.fontsize:"empty",(0===s&&o.backgroundcolor||!o.backgroundcolor)&&(h.backgroundcolor=o.backgroundcolor),(0===s&&o.orderedlist||!o.orderedlist)&&(h.orderedlist=o.orderedlist),(0===s&&o.unorderedlist||!o.unorderedlist)&&(h.unorderedlist=o.unorderedlist),(0===s&&o.alignments||!o.alignments)&&(h.alignments=o.alignments),h.formats=0===s&&o.formats?o.formats:o.formats===h.formats?o.formats:"empty",(0===s&&o.createlink||!o.createlink)&&(h.createlink=o.createlink),(0===s&&o.numberFormatList||!o.numberFormatList)&&(h.numberFormatList=o.numberFormatList),(0===s&&o.bulletFormatList||!o.bulletFormatList)&&(h.bulletFormatList=o.bulletFormatList),(0===s&&o.inlinecode||!o.inlinecode)&&(h.inlinecode=o.inlinecode),o=JSON.parse(JSON.stringify(cp)));return h},n.getImmediateBlockNode=function(n){do n=n.parentNode;while(n&&bt.indexOf(n.nodeName.toLocaleLowerCase())<0);return n},n.getFormatParent=function(n,t,i,r,u,f,e){return(r.contains(i)||i&&3===i.nodeType&&3!==r.nodeType&&r.contains(i.parentNode))&&(t=this.isFormattedNode(n,t,i,!1,!1,u,f,e,r)),t},n.checkCodeBlock=function(n){return"CODE"===n.nodeName&&n.parentElement&&"PRE"===n.parentElement.nodeName&&n.parentElement.hasAttribute("data-language")},n.isFormattedNode=function(n,t,i,r,u,f,e,o,s){for(var v,a,y,p=bt,h=i,l=[],c={};h&&!(p.indexOf(h.nodeName.toLowerCase())>-1)&&(!s||h.nodeName!==s.nodeName);)1===h.nodeType&&(v=h,this.checkCodeBlock(v)||l.push(v.nodeName.toLowerCase()),this.collectStyles(h,c,n,o,e)),h=h.parentNode;for(;h&&h!==s;)a=h.nodeName.toLowerCase(),y="UL"===h.tagName&&h.classList.contains("e-rte-checklist"),t.unorderedlist||"ul"!==a||r||u||y||(t.unorderedlist=!0,r=!0,t.bulletFormatList=this.isBulletFormatList(h),u=null!==t.bulletFormatList),t.orderedlist||"ol"!==a||r||u||(t.orderedlist=!0,r=!0,t.numberFormatList=this.isNumberFormatList(h),u=null!==t.numberFormatList),t.blockquote||"blockquote"!==a||(t.blockquote=!0),t.formats||(t.formats=this.isFormats(h,f),"pre"!==t.formats||"pre"!==a||"CODE"===h.firstChild.nodeName||h.hasAttribute("data-language")||(t.insertcode=!0)),!t.isCodeBlock&&"pre"===h.nodeName.toLocaleLowerCase()&&h.hasAttribute("data-language")&&(t.isCodeBlock=!0),!t.isCheckList&&y&&(t.isCheckList=!0),this.collectStyles(h,c,n,o,e),h=h.parentNode;return(l.indexOf("b")>-1||l.indexOf("strong")>-1)&&(t.bold=!0),(l.indexOf("i")>-1||l.indexOf("em")>-1)&&(t.italic=!0),(l.indexOf("u")>-1||c.underLine)&&(t.underline=!0),(l.indexOf("s")>-1||l.indexOf("del")>-1||c.strikeThrough)&&(t.strikethrough=!0),l.indexOf("sup")>-1&&(t.superscript=!0),l.indexOf("sub")>-1&&(t.subscript=!0),c.color&&(t.fontcolor=c.color),c.backgroundColor&&(t.backgroundcolor=c.backgroundColor),c.fontFamily&&(t.fontname=c.fontFamily),c.fontSize&&(t.fontsize=c.fontSize),c.textAlign&&(t.alignments=c.textAlign),l.indexOf("a")>-1&&(t.createlink=!0),l.indexOf("code")>-1&&(t.inlinecode=!0),t},n.isFontColor=function(n,t){var i=t.style&&t.style.color;return null!=i&&""!==i||3===t.nodeType||(i=this.getComputedStyle(n,t,"color")),null!==i&&""!==i&&void 0!==i?i:null},n.isBackgroundColor=function(n){var t=n.style&&n.style.backgroundColor;return null!==t&&""!==t&&void 0!==t?t:null},n.isFontSize=function(n,t,i){var r=t.style&&t.style.fontSize,u=yi.inlineTags.indexOf(t.nodeName.toLowerCase())>-1;return r&&1===t.nodeType&&!u&&(r=null),null!=r&&""!==r||3===t.nodeType||!t.parentElement.classList.contains("e-content")||(r=this.getComputedStyle(n,t,"font-size")),null!==r&&""!==r&&void 0!==r&&(null==i||i.indexOf(r)>-1)?r:null},n.isFontName=function(n,i,r){var u=i.style&&i.style.fontFamily,e=yi.inlineTags.indexOf(i.nodeName.toLowerCase())>-1,f;return u&&1===i.nodeType&&!e&&(u=null),(null==u||""===u)&&3!==i.nodeType&&e&&(u=this.getComputedStyle(n,i,"font-family")),f=null,null!==u&&""!==u&&void 0!==u&&(null==r||r.filter(function(n,i){var r=new RegExp(u,"i");(n.replace(/"/g,"").replace(/ /g,"").toLowerCase()===u.replace(/"/g,"").replace(/ /g,"").toLowerCase()||n.split(",")[0]&&!t.isNullOrUndefined(n.split(",")[0].trim().match(r))&&n.split(",")[0].trim()===n.split(",")[0].trim().match(r)[0])&&(f=i)})&&null!==f)?null!==f?r[f]:u.replace(/"/g,""):null},n.isAlignment=function(n){var t=n.style&&n.style.textAlign;return"left"===t?"justifyleft":"center"===t?"justifycenter":"right"===t?"justifyright":"justify"===t?"justifyfull":null},n.isFormats=function(n,t){return null==t&&bt.indexOf(n.nodeName.toLocaleLowerCase())>-1||null!=t&&t.indexOf(n.nodeName.toLocaleLowerCase())>-1?n.nodeName.toLocaleLowerCase():["tbody","tfoot","thead","ol","ul","table","li","td","th"].indexOf(n.nodeName.toLocaleLowerCase())>-1?"p":null},n.getComputedStyle=function(n,t,i){return n.defaultView.getComputedStyle(t,null).getPropertyValue(i)},n.isNumberFormatList=function(n){var t=n.style&&n.style.listStyleType;return"lower-alpha"===t?"Lower Alpha":"number"===t?"Number":"upper-alpha"===t?"Upper Alpha":"lower-roman"===t?"Lower Roman":"upper-roman"===t?"Upper Roman":"lower-greek"===t?"Lower Greek":"none"===t&&"OL"===n.nodeName?"None":"OL"===n.nodeName||null},n.isBulletFormatList=function(n){var t=n.style&&n.style.listStyleType;return"circle"===t?"Circle":"square"===t?"Square":"none"===t&&"UL"===n.nodeName?"None":"disc"===t?"Disc":"UL"===n.nodeName||null},n.collectStyles=function(n,t,i,r,u){var e,o,f;(t.color||(t.color=this.isFontColor(i,n)),t.backgroundColor||(t.backgroundColor=this.isBackgroundColor(n)),t.fontFamily)||(e=this.isFontName(i,n,r),e&&(t.fontFamily=e));t.fontSize||(o=this.isFontSize(i,n,u),o&&(t.fontSize=o));t.textAlign||(t.textAlign=this.isAlignment(n));f=null;n.style&&n.style.textDecoration?f=n.style.textDecoration:(f=this.getComputedStyle(i,n,"text-decoration"),"A"===n.nodeName&&f.includes("underline")&&(f=null));f&&(t.underLine||(t.underLine=f.includes("underline")?"underline":null),t.strikeThrough||(t.strikeThrough=f.includes("line-through")?"line-through":null))},n}();!function(n){n.InsertLink="InsertLink";n.InsertImage="InsertImage";n.InsertAudio="InsertAudio";n.InsertVideo="InsertVideo";n.InsertTable="InsertTable"}(d||(d={})),function(n){n.Expand="Expand";n.MultiRow="MultiRow";n.Scrollable="Scrollable";n.Popup="Popup"}(wt||(wt={})),function(n){n.Uploaded="Uploaded";n.Dropped="Dropped";n.Pasted="Pasted"}(ge||(ge={})),function(n){n.Uploaded="Uploaded";n.Dropped="Dropped";n.Pasted="Pasted"}(ry||(ry={}));lp=function(){function n(n,t){this.isEscapeKey=!1;this.rangeStore=!1;this.parent=n;this.isDestroyed=!1;t&&(this.l10n=t.getService("rteLocale"));this.wireEvent()}return n.prototype.wireEvent=function(){this.parent.on(u,this.destroy,this);this.parent.on(re,this.destroyTooltip,this);this.parent.on(cs,this.closeTooltip,this)},n.prototype.destroyTooltip=function(){var n=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument(),i,r;t.isNullOrUndefined(n.querySelector(".e-tooltip-wrap"))||t.isNullOrUndefined(n.querySelector("[data-tooltip-id]"))||(i=n.querySelector("[data-tooltip-id]"),r=new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0}),i.dispatchEvent(r))},n.prototype.unWireEvent=function(){this.parent.off(u,this.destroy);this.parent.off(re,this.destroyTooltip);this.parent.off(cs,this.closeTooltip)},n.prototype.toolbarBeforeCreate=function(n){"Extended"===this.mode&&(n.enableCollision=!1)},n.prototype.toolbarCreated=function(){if(this.parent.notify(hd,this),"Extended"===this.mode){var n=this.toolbarPanel.querySelector(".e-expended-nav");n&&t.EventHandler.add(n,"mousedown",this.extendedToolbarMouseDownHandler,this)}},n.prototype.extendedToolbarMouseDownHandler=function(){this.parent.userAgentData.isSafari()&&this.parent.notify(ft,{})},n.prototype.toolbarClicked=function(n){var r=this,i,u;this.parent.enabled&&(this.parent.toolbarSettings.type===wt.Popup&&(i=void 0,n.item&&n.item.command&&(i=n.item.command),t.isNullOrUndefined(i)||-1===["Formats","Font","Alignments","EmojiPicker","Table","BulletFormatList","NumberFormatList","CodeBlock"].indexOf(i)||(n.cancel=!0)),u={item:n.item,originalEvent:n.originalEvent,cancel:!1},this.parent.trigger("toolbarClick",u,function(i){r.parent.readonly&&!t.isNullOrUndefined(n.item)||i.cancel||r.parent.notify(ph,i)}))},n.prototype.dropDownSelected=function(n){this.parent.notify(ci,{element:n.element,item:n.item,originalEvent:n.event});this.destroyTooltip()},n.prototype.beforeDropDownItemRender=function(n){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(tc,n)},n.prototype.tooltipBeforeRender=function(n){if(!t.isNullOrUndefined(n.target.getAttribute("title"))){var i=void 0;switch(n.target.getAttribute("title")){case"Minimize":i=this.l10n.getConstant("minimize");n.target.setAttribute("title",i+" (Esc)");break;case"Maximize":i=this.l10n.getConstant("maximize");n.target.setAttribute("title",i+" (Ctrl+Shift+F)")}}n.target.querySelector(".e-active")&&(n.cancel=!0,t.isNullOrUndefined(n.target.getAttribute("title"))||this.closeTooltip({target:n.target,isTitle:!0}))},n.prototype.dropDownOpen=function(n){if(n.element.parentElement.getAttribute("id").indexOf("TableCell")>-1&&!t.isNullOrUndefined(n.element.parentElement.querySelector(".e-cell-merge"))){var i=n.element.querySelectorAll("li"),r=this.parent.inputElement.querySelectorAll(".e-cell-select");1===r.length?(t.addClass([i[0]],"e-disabled"),t.removeClass([i[1],i[2]],"e-disabled")):r.length>1&&(Array.from(r).every(function(n){return n.tagName.toLowerCase()===r[0].tagName.toLowerCase()})?t.removeClass([i[0]],"e-disabled"):t.addClass([i[0]],"e-disabled"),t.addClass([i[1],i[2]],"e-disabled"))}this.parent.notify(ft,n)},n.prototype.dropDownClose=function(n){this.isEscapeKey||this.parent.notify(lt,n);this.isEscapeKey=!1},n.prototype.dropDownBeforeClose=function(n){t.isNullOrUndefined(n.event)||"Escape"!==n.event.key||27!==n.event.keyCode||(this.isEscapeKey=!0,this.parent.notify(ia,n))},n.prototype.renderToolbar=function(n){var t=this,i=this.parent.toolbarSettings&&"Bottom"===this.parent.toolbarSettings.position;this.setPanel(n.target);this.renderPanel();this.mode=n.overflowMode;n.rteToolbarObj.toolbarObj=new nit.Toolbar({items:n.items,width:"100%",overflowMode:n.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:function(){t.positionToolbar(i);t.toolbarCreated()},clicked:this.toolbarClicked.bind(this),enablePersistence:n.enablePersistence,enableRtl:n.enableRtl,cssClass:n.cssClass});n.rteToolbarObj.toolbarObj.isStringTemplate=!0;n.rteToolbarObj.toolbarObj.createElement=this.parent.createElement;n.rteToolbarObj.toolbarObj.appendTo(n.target);this.parent.showTooltip&&"toolbar"===n.type&&(this.tooltip=new wi.Tooltip({target:"#"+this.parent.getID()+"_toolbar_wrapper [title]",showTipPointer:!0,openDelay:400,opensOn:"Hover",beforeRender:this.tooltipBeforeRender.bind(this),beforeOpen:this.tooltipBeforeOpen.bind(this),cssClass:this.parent.getCssClass(),windowCollision:!0,position:i?"TopCenter":"BottomCenter"}),this.tooltip.appendTo(n.target.parentElement))},n.prototype.positionToolbar=function(n){var r=this.parent.element.querySelector(".e-rte-container"),i=this.parent.element.querySelector(".e-toolbar-wrapper");n&&r&&i&&t.addClass([i],"e-rte-tb-bottom")},n.prototype.tooltipBeforeOpen=function(n){n.element&&n.element.setAttribute("data-rte-id",this.parent.getID())},n.prototype.renderDropDownButton=function(n){var f,i=this,e=n.activeElement;n.element.classList.add(yt);f=n.cssClass+" "+pt+" "+vg;this.parent.inlineMode.enable&&t.Browser.isDevice&&(f=f+" "+lg);var o=this.parent.element&&this.parent.element.dataset&&"true"===this.parent.element.dataset.rteUnitTesting,r=this,u=new tit.DropDownButton({items:n.items,iconCss:n.iconCss,cssClass:f,content:n.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),animationSettings:o?{effect:"None",duration:0}:{effect:"None",duration:400,easing:"ease"},beforeOpen:function(n){var f,k,v,o,y,h,c,l,rt,ut,p,s;if(!r.parent.readonly&&r.parent.enabled){if(i.parent.userAgentData.isSafari()&&"keydown"===n.event.type&&i.parent.formatter.editorManager.nodeSelection&&!i.parent.inputElement.contains(i.parent.getRange().startContainer)&&i.parent.notify(lt,n),"Markdown"!==r.parent.editorMode){var a=r.parent.getRange().startContainer.parentElement,b=a.closest("table"),ft=a.closest("tr");if(!t.isNullOrUndefined(b)&&b.classList.contains("e-dashed-border"))for(f=0;f<n.element.childNodes.length;f++)n.element.childNodes[f].classList.contains("e-dashed-borders")&&t.addClass([n.element.childNodes[f]],"e-active");if(!t.isNullOrUndefined(b)&&b.classList.contains("e-alternate-rows")&&""!==window.getComputedStyle(ft).backgroundColor)for(f=0;f<n.element.childNodes.length;f++)n.element.childNodes[f].classList.contains("e-alternate-rows")&&t.addClass([n.element.childNodes[f]],"e-active");if(!t.isNullOrUndefined(n.element.parentElement)&&n.element.parentElement.classList.contains("e-border-style-btn"))for(k=r.parent.contentModule.getDocument().activeElement.innerText.toLowerCase(),v=0;v<n.items.length;v++){if(n.items[v].text.toLowerCase()===k){t.addClass([n.element.childNodes[v]],"e-active");break}t.removeClass([n.element.childNodes[v]],"e-active")}for(o=r.parent.getRange().startContainer;o!==r.parent.inputElement&&!t.isNullOrUndefined(o.parentElement);){if("#text"===o.nodeName&&(o=o.parentElement),y=window.getComputedStyle(o).textAlign,!t.isNullOrUndefined(n.items[0])&&"Alignments"===n.items[0].command){if("Align Left"===n.items[0].text&&"left"===y||"start"===y){t.addClass([n.element.childNodes[0]],"e-active");break}if("Align Center"===n.items[1].text&&"center"===y){t.addClass([n.element.childNodes[1]],"e-active");break}if("Align Right"===n.items[2].text&&"right"===y){t.addClass([n.element.childNodes[2]],"e-active");break}if("Align Justify"===n.items[3].text&&"justify"===y){t.addClass([n.element.childNodes[3]],"e-active");break}}o=o.parentElement}if(h=a.closest("img")||e||a.querySelector("img"),t.isNullOrUndefined(n.items[0])||"Images"!==n.items[0].command||t.isNullOrUndefined(h)||(f=void 0,h.classList.contains("e-imgleft")||h.classList.contains("e-imginline")?f=0:h.classList.contains("e-imgcenter")||h.classList.contains("e-imgbreak")?f=1:h.classList.contains("e-imgright")&&(f=2),t.isNullOrUndefined(n.element.childNodes[f])||t.addClass([n.element.childNodes[f]],"e-active")),c=a.closest(".e-video-wrap")||e||a.querySelector("video"),t.isNullOrUndefined(n.items[0])||"Videos"!==n.items[0].command||t.isNullOrUndefined(c)||(f=void 0,c.classList.contains("e-video-left")||c.classList.contains("e-video-inline")?f=0:c.classList.contains("e-video-center")||c.classList.contains("e-video-break")?f=1:c.classList.contains("e-video-right")&&(f=2),t.isNullOrUndefined(n.element.childNodes[f])||t.addClass([n.element.childNodes[f]],"e-active")),!t.isNullOrUndefined(n.items[0])&&("Formats"===n.items[0].command||"Font"===n.items[0].command)){var d=[],g=[],w=!1;for(i.parent.format.types.forEach(function(n){g.push(n.value.toLocaleLowerCase())}),i.parent.fontFamily.items.forEach(function(n){d.push(n.value)}),l=td.get(i.parent.contentModule.getDocument(),i.parent.contentModule.getEditPanel(),g,null,d),f=0;f<n.element.childNodes.length;f++){var nt=u.content.trim(),tt=nt.match(/style="([^"]*)"/),it="";tt&&(it=tt[1]);rt=nt.replace(/ style="([^"]*)"/,"");(s=i.parent.createElement("div")).innerHTML=rt;s.querySelector("span").style.cssText=it;!w&&(""!==s.textContent.trim()&&n.element.childNodes[f].textContent.trim()===s.textContent.trim()||"Formats"===n.items[0].command&&!t.isNullOrUndefined(l.formats)&&i.parent.format.types[f].value.toLowerCase()===l.formats.toLowerCase()&&n.element.childNodes[f].classList.contains(i.parent.format.types[f].cssClass)||"FontName"===n.items[0].subCommand&&"Font"===n.items[0].command&&!t.isNullOrUndefined(l.fontname)&&!t.isNullOrUndefined(i.parent.fontFamily.items[f])&&i.parent.fontFamily.items[f].value.toLowerCase()===l.fontname.toLowerCase()&&n.element.childNodes[f].classList.contains(i.parent.fontFamily.items[f].cssClass)||"FontName"===n.items[0].subCommand&&""===i.parent.fontFamily.items[f].value&&t.isNullOrUndefined(l.fontname)&&n.element.childNodes[f].classList.contains(i.parent.fontFamily.items[f].cssClass)||"FontSize"===n.items[0].subCommand&&"Default"===n.element.childNodes[f].textContent&&"Font Size"===s.textContent&&""===i.parent.fontSize.items[f].value&&!t.isNullOrUndefined(l.fontsize))?n.element.childNodes[f].classList.contains("e-active")||(t.addClass([n.element.childNodes[f]],"e-active"),w=!0):t.removeClass([n.element.childNodes[f]],"e-active")}}}else if("Markdown"===r.parent.editorMode&&"Formats"===n.items[0].command)for(ut=[],w=!1,i.parent.format.types.forEach(function(n){ut.push(n.value.toLocaleLowerCase())}),p=n.element.childNodes,f=0;f<p.length;f++)(s=i.parent.createElement("div")).innerHTML=u.content.trim(),w||""===s.textContent.trim()||p[f].textContent.trim()!==s.textContent.trim()?t.removeClass([p[f]],"e-active"):p[f].classList.contains("e-active")||(t.addClass([p[f]],"e-active"),w=!0);r.parent.notify(pc,n)}else n.cancel=!0},close:this.dropDownClose.bind(this),beforeClose:this.dropDownBeforeClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});return u.isStringTemplate=!0,u.createElement=r.parent.createElement,u.appendTo(n.element),n.element.tabIndex=-1,document.getElementById(u.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),u},n.prototype.mouseOutHandler=function(){if(t.isNullOrUndefined(this.tooltipTargetEle)){var n=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument();this.tooltipTargetEle=n.querySelector("[data-title]");this.tooltipTargetEle.setAttribute("title",this.tooltipTargetEle.getAttribute("data-title"))}else this.tooltipTargetEle.setAttribute("title",this.tooltipTargetEle.getAttribute("data-title"));this.tooltipTargetEle.removeAttribute("data-title");t.EventHandler.remove(this.tooltipTargetEle,"mouseout",this.mouseOutHandler)},n.prototype.closeTooltip=function(n){if(n.isTitle)this.tooltipTargetEle=n.target,this.tooltipTargetEle.setAttribute("data-title",this.tooltipTargetEle.getAttribute("title")),this.tooltipTargetEle.removeAttribute("title"),t.EventHandler.add(this.tooltipTargetEle,"mouseout",this.mouseOutHandler,this);else{var i=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument();this.tooltipTargetEle=t.closest(n.target,"[data-tooltip-id]");t.isNullOrUndefined(this.tooltipTargetEle)||!this.parent.showTooltip||t.isNullOrUndefined(i.querySelector(".e-tooltip-wrap"))||(this.destroyTooltip(),this.tooltipTargetEle.setAttribute("data-title",this.tooltipTargetEle.getAttribute("title")),this.tooltipTargetEle.removeAttribute("title"),t.EventHandler.add(this.tooltipTargetEle,"mouseout",this.mouseOutHandler,this))}},n.prototype.handleCodeBlockDropdown=function(n){var u=this.parent.getRange(),f=this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(u.startContainer),e=this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(u.endContainer),o="",r,i,s;if(!t.isNullOrUndefined(f)||!t.isNullOrUndefined(e))for(o=(f||e).getAttribute("data-language")||"",r=n.element.querySelectorAll("li"),i=0;i<r.length;i++)s=r[i].getAttribute("data-language")||r[i].textContent.toLowerCase(),o.toLowerCase()===s?t.addClass([r[i]],"e-active"):t.removeClass([r[i]],"e-active")},n.prototype.handleListsDropdown=function(n){var r=this,s,h,u,i;if(!r.parent.readonly&&r.parent.enabled){if("safari"!==t.Browser.info.name||r.parent.inputElement.contains(r.parent.getRange().startContainer)||r.parent.notify(lt,{}),"Markdown"!==r.parent.editorMode){var e=r.parent.getRange().startContainer.parentElement.closest("LI"),f=t.isNullOrUndefined(e)?null:e.parentElement,o=n.items[0].subCommand;if(!t.isNullOrUndefined(f)&&(s="NumberFormatList"===o&&"OL"===f.nodeName,h="BulletFormatList"===o&&"UL"===f.nodeName,s||h))for(u=f.style.listStyleType.split("-").join("").toLocaleLowerCase(),u="decimal"===u?"number":u,i=0;i<n.element.childNodes.length;i++){if(u===n.element.childNodes[i].innerHTML.split(" ").join("").toLocaleLowerCase()){t.addClass([n.element.childNodes[i]],"e-active");break}if(""===u&&("Number"===n.element.childNodes[i].innerHTML||"Disc"===n.element.childNodes[i].innerHTML)){t.addClass([n.element.childNodes[i]],"e-active");break}}}}else n.cancel=!0},n.prototype.renderSplitButton=function(n){var t=this,r=n.cssClass,i=new tit.SplitButton({items:n.items,cssClass:r,iconCss:n.iconCss,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),created:function(){var t=n.element.parentElement;t&&(t.tabIndex=-1)},beforeOpen:function(n){!t.parent.readonly&&t.parent.enabled?n.items&&("CodeBlock"===n.items[0].command&&t.handleCodeBlockDropdown(n),"Lists"===n.items[0].command&&t.handleListsDropdown(n),t.currentElement=i.element,t.currentDropdown=i):n.cancel=!0},close:this.dropDownClose.bind(this),beforeClose:this.dropDownBeforeClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)});return i.appendTo(n.element),document.getElementById(i.element.id+"_dropdownbtn-popup").setAttribute("aria-owns",this.parent.getID()),i},n.prototype.renderColorPicker=function(n,i,r){var o,f=this,u=this,s=!1,e;return"bordercolor"===i||"tablebackgroundcolor"===i?(o=n.value,s=!0):o=t.isNullOrUndefined(this.defaultColorPicker)?"backgroundcolor"===i?u.parent.backgroundColor.default:u.parent.fontColor.default:this.defaultColorPicker,e=new ot.ColorPicker({enableRtl:this.parent.enableRtl,inline:!1,value:o,showButtons:!1,cssClass:n.cssClass,disabled:!this.parent.enabled,created:function(){var f,e,o,t=n.element.parentElement,i,r,u;t&&(t.tabIndex=-1,i=t.childNodes[1],i&&((f=i.classList).add.apply(f,n.cssClass.split(" ")),r=t.querySelector(".e-split-colorpicker"),r&&((e=r.classList).add.apply(e,n.cssClass.split(" ")),u=t.querySelector(".e-dropdown-btn"),u&&(o=u.classList).add.apply(o,n.cssClass.split(" ")))))},mode:"backgroundcolor"===i?u.parent.backgroundColor.mode:u.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===i?u.parent.backgroundColor.modeSwitcher:u.parent.fontColor.modeSwitcher,showRecentColors:!("quick"===r&&!s)&&(!!s||("backgroundcolor"===i?u.parent.backgroundColor.showRecentColors:u.parent.fontColor.showRecentColors)),presetColors:"backgroundcolor"===i?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,columns:"backgroundcolor"===i?this.parent.backgroundColor.columns:this.parent.fontColor.columns,beforeTileRender:function(n){if(n.element.classList.add(sn),n.element.classList.add(gn),!t.isNullOrUndefined(f.parent.cssClass))for(var r=f.parent.getCssClass().split(" "),i=0;i<r.length;i++)""!==r[i].trim()&&n.element.classList.add(r[i]);""===n.value&&n.element.classList.add(ntt)},beforeOpen:function(){(u.parent.userAgentData.isSafari()||!u.parent.userAgentData.isSafari())&&f.parent.formatter.editorManager.nodeSelection&&f.parent.inputElement.contains(f.parent.getRange().startContainer)&&(u.parent.notify(ft,{}),f.rangeStore=!0)},change:function(i){var s,e,o;f.rangeStore&&(u.parent.notify(lt,{}),f.rangeStore=!1);(!u.parent.userAgentData.isSafari()||u.parent.userAgentData.isSafari()&&f.parent.formatter.editorManager.nodeSelection&&f.parent.inputElement.contains(f.parent.getRange().startContainer))&&u.parent.notify(ft,{});s=i.currentValue.rgba;i.item={command:n.command,subCommand:n.subCommand,value:s};u.parent.notify(lt,{});e=u.parent.formatter.editorManager.nodeSelection.getRange(u.parent.contentModule.getDocument());o=t.closest(e.startContainer.parentNode,"table");("TD"===e.startContainer.nodeName||"TH"===e.startContainer.nodeName||"BODY"===e.startContainer.nodeName||e.startContainer.parentNode&&t.closest(e.startContainer.parentNode,"td,th"))&&e.collapsed&&"BackgroundColor"===n.subCommand&&(o&&t.closest(o,"."+ls)||u.parent.iframeSettings.enable)&&"quick"===r?(f.defaultColorPicker=i.currentValue.hex,i.name="tableColorPickerChanged",i.item.command="Table",u.parent.formatter.process(f.parent,i,i.event,i.item.value)):u.parent.notify(pf,i)},beforeModeSwitch:function(n){""===(o=e.value)&&e.setProperties({value:"Picker"===n.mode?"#008000ff":""},!0);e.showButtons="Palette"!==n.mode},beforeClose:this.dropDownClose.bind(this)}),e.isStringTemplate=!0,e.createElement=this.parent.createElement,e.appendTo(n.element),e},n.prototype.renderPanel=function(){this.getPanel().classList.add(ue)},n.prototype.getPanel=function(){return this.toolbarPanel},n.prototype.setPanel=function(n){this.toolbarPanel=n},n.prototype.destroy=function(){var i,n,r;if(!this.isDestroyed){if(this.tooltip&&!this.tooltip.isDestroyed)for(this.tooltip.destroy(),i=document.querySelectorAll('[data-rte-id="'+this.parent.getID()+'"]'),n=0;n<i.length;n++)r=i[n],this.parent.getID()===r.getAttribute("data-rte-id")&&t.detach(r);this.unWireEvent();this.mode=null;this.defaultColorPicker=null;this.toolbarPanel=null;this.currentElement=null;this.currentDropdown=null;this.tooltip=null;this.tooltipTargetEle=null;this.isDestroyed=!0}},n}();const rr=ejdashboard.buttons;var ap,id,rrt=function(){function n(n){this.parent=n;this.drop=this.dragDrop.bind(this);this.enter=this.dragEnter.bind(this);this.start=this.dragStart.bind(this);this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(eh,this.linkCommand,this);this.parent.observer.on(f,this.destroy,this);var n=this.parent.editableElement;n&&(t.EventHandler.add(n,"drop",this.drop),t.EventHandler.add(n,"dragenter",this.enter),t.EventHandler.add(n,"dragover",this.start))},n.prototype.removeEventListener=function(){this.parent.observer.off(eh,this.linkCommand);this.parent.observer.off(f,this.destroy);var n=this.parent.editableElement;n&&(t.EventHandler.remove(n,"drop",this.drop),t.EventHandler.remove(n,"dragenter",this.enter),t.EventHandler.remove(n,"dragover",this.start));this.drop=null;this.enter=null;this.start=null},n.prototype.linkCommand=function(n){switch(n.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(n);break;case"openlink":this.openLink(n);break;case"removelink":this.removeLink(n)}},n.prototype.dragStart=function(n){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);if(t){var i,r=t.startContainer,u=t.endContainer,f=null,e=null;r.nodeType===Node.ELEMENT_NODE?f=r.closest("a"):(i=r.parentElement)&&(f=i.closest("a"));u.nodeType===Node.ELEMENT_NODE?e=u.closest("a"):(i=u.parentElement)&&(e=i.closest("a"));("A"===n.target.nodeName||f||e)&&(this.dragSelectionRange=t.cloneRange())}},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragDrop=function(n){var u=n.dataTransfer.getData("text/html"),i,r,f,e,o,s;u&&/^<img[\s\S]*?>$/i.test(u.trim())||!this.dragSelectionRange||(n.preventDefault(),i=void 0,(this.parent.currentDocument.caretRangeFromPoint?i=this.parent.currentDocument.caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent&&(i=this.parent.currentDocument.createRange()).setStart(n.rangeParent,n.rangeOffset),u)&&(r=null,(i.startContainer&&i.startContainer.nodeType===Node.TEXT_NODE?r=i.startContainer.parentNode:i.startContainer instanceof HTMLAnchorElement&&(r=i.startContainer),r)?r&&"A"!==r.nodeName&&(r=r.closest("a")):i.collapsed&&(f=i.startContainer,f&&(e=f.closest("a"),e&&(r=e))),r&&(o=t.createElement("div",{innerHTML:u}),o.querySelectorAll("a").forEach(function(n){for(;n.firstChild;)n.parentNode.insertBefore(n.firstChild,n);n.remove()}),u=o.innerHTML),i.deleteContents(),s=i.createContextualFragment(u),s.querySelectorAll("a").forEach(function(n){n.style.textDecoration=""}),this.dragSelectionRange&&(this.dragSelectionRange.deleteContents(),this.normalizeEmptyLinks(),this.dragSelectionRange=null),this.parent.nodeSelection.setRange(this.parent.currentDocument,i),kt.Insert(this.parent.currentDocument,s,this.parent.editableElement,!0),r&&r.normalize()))},n.prototype.normalizeEmptyLinks=function(){if(this.dragSelectionRange){var t=this.dragSelectionRange.commonAncestorContainer,n=t.nodeType===Node.TEXT_NODE?t.parentElement:t;n&&-1===bt.indexOf(n.nodeName.toLocaleLowerCase())&&(n=this.parent.domNode.getImmediateBlockNode(n));n&&n.querySelectorAll("a:empty").forEach(function(n){""!==n.textContent.trim()||n.querySelector("img")||n.querySelector("video")||n.parentNode&&n.parentNode.removeChild(n)})}},n.prototype.createLink=function(n){var f=!t.isNullOrUndefined(n.item.selectParent)&&1===n.item.selectParent.length&&t.closest(n.item.selectParent[0],"a"),e,r,l,u,a,s,i,h,c,o,v;(f=t.isNullOrUndefined(f)?t.isNullOrUndefined(n.item.selectParent)||1!==n.item.selectParent.length?null:n.item.selectParent[0]:f,t.isNullOrUndefined(f)||"A"!==f.tagName)?(e=new st(this.parent.editableElement),r=e.getRange(this.parent.currentDocument),"#text"!==r.endContainer.nodeName||r.startContainer.textContent.length!==r.endOffset+1||" "!==r.endContainer.textContent.charAt(r.endOffset)||t.isNullOrUndefined(r.endContainer.nextSibling)||"A"!==r.endContainer.nextSibling.nodeName||(e.setSelectionText(this.parent.currentDocument,r.startContainer,r.endContainer,r.startOffset,r.endOffset+1),r=e.getRange(this.parent.currentDocument)),l=!!t.isNullOrUndefined(n.item.text)||n.item.text.replace(/ /g,"").localeCompare(r.toString().replace(/\n/g," ").replace(/ /g,""))<0,n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode)||"Paste"===n.item.action||r.collapsed||l?(u=this.createAchorNode(n),u.innerText=""===n.item.text?n.item.url:n.item.text,a=u.innerText.replace(/  +/g,function(n){return" ".repeat(n.length)}),(u.innerText=a,n.item.selection.restore(),kt.Insert(this.parent.currentDocument,u,this.parent.editableElement),t.isNullOrUndefined(u.parentElement)||"LI"!==u.parentElement.nodeName||t.isNullOrUndefined(u.parentNode.childNodes)||""!==u.parentNode.childNodes[0].textContent||u.parentNode.removeChild(u.parentNode.childNodes[0]),n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode||/[^\w\s\\/\\.\\:]/g.test(n.event.key)))?(s=n.item.selection.range.startContainer,s.textContent=this.removeText(s.textContent,n.item.text)):(o="Paste"===n.item.action?u.childNodes[0].textContent.length:0,n.item.selection.setSelectionText(this.parent.currentDocument,u.childNodes[0],u.childNodes[0],o,u.childNodes[0].textContent.length))):this.handleLinkFormat(n)):(i=f,h="",(t.isNullOrUndefined(n.item.url)||i.setAttribute("href",n.item.url),t.isNullOrUndefined(n.item.title)||i.setAttribute("title",n.item.title),t.isNullOrUndefined(n.item.text)||""===n.item.text)||(h=i.innerText,c=document.createTreeWalker(i,NodeFilter.SHOW_TEXT,null).nextNode(),c&&(c.textContent=n.item.text)),(t.isNullOrUndefined(n.item.target)?(i.removeAttribute("target"),i.removeAttribute("aria-label")):(i.setAttribute("target",n.item.target),i.setAttribute("aria-label",n.item.ariaLabel)),h===n.item.text)?(n.item.selection.setSelectionText(this.parent.currentDocument,i,i,1,1),n.item.selection.restore()):(o="Paste"===n.item.action?i.childNodes[0].textContent.length:0,v="#text"===i.firstChild.nodeName?i.childNodes[0].textContent.length:i.childNodes.length,n.item.selection.setSelectionText(this.parent.currentDocument,i.childNodes[0],i.childNodes[0],o,v)));n.callBack&&n.callBack({requestType:"Links",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.createAchorNode=function(n){var i=t.createElement("a",{className:"e-rte-anchor",attrs:{href:n.item.url,title:t.isNullOrUndefined(n.item.title)||""===n.item.title?n.item.url:n.item.title}});return t.isNullOrUndefined(n.item.target)||i.setAttribute("target",n.item.target),t.isNullOrUndefined(n.item.ariaLabel)||i.setAttribute("aria-label",n.item.ariaLabel),i},n.prototype.removeText=function(n,t){for(var r=n.split(" "),i=0;i<r.length;i++)r[i]===t&&(r.splice(i,1),i--);return r.join(" ")+" "},n.prototype.openLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeLink=function(n){var o=this.parent.domNode.blockNodes(),e,f,r;if(o.length<2){this.parent.domNode.setMarker(n.item.selection);for(var u=t.closest(n.item.selectParent[0],"a")||n.item.selectParent[0],s=u.parentNode,i=[];u.firstChild&&s;null)i.push(s.insertBefore(u.firstChild,u));s.removeChild(u);i&&1===i.length&&(n.item.selection.startContainer=n.item.selection.getNodeArray(i[i.length-1],!0),n.item.selection.endContainer=n.item.selection.startContainer,n.item.selection.startOffset=0,n.item.selection.endOffset=i[i.length-1].textContent.length);n.item.selection=this.parent.domNode.saveMarker(n.item.selection)}else for(e=0;e<o.length;e++)for(f=o[e].querySelectorAll("a"),r=0;r<f.length;r++)this.parent.currentDocument.getSelection().containsNode(f[r],!0)&&(f[r].outerHTML=f[r].innerHTML);n.item.selection.restore();this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.handleLinkFormat=function(n){var l=this.parent.editableElement,i=this.parent.nodeSelection.getRange(l.ownerDocument),a=this.parent.currentDocument.getSelection(),f,o,s,y,c;if(a&&0!==a.rangeCount){var u,e,r,p=new hu(l),h="BR"===n.enterAction?[this.parent.editableElement]:p.getBlockNode(),t=[],v=["IMG","AUDIO","VIDEO"];for(1===i.startContainer.nodeType&&(u=(r=i.startContainer.childNodes[i.startOffset])&&v.indexOf(r.nodeName)>-1?r:null),1===i.endContainer.nodeType&&(e=(r=i.endContainer.childNodes[i.endContainer.childNodes.length>1?i.endOffset-1:i.endOffset])&&v.indexOf(r.nodeName)>-1?r:null),f={startContainer:i.startContainer,endContainer:i.endContainer,endOffset:i.endOffset,startOffset:i.startOffset,collapsed:i.collapsed},o=0;o<h.length;o++)s=h[o],(this.unwrapLink(s),s.normalize(),this.applyLinkToBlockNode(s,n,t),h.length<=1&&t.length<=1)&&(y=t[t.length-1].textContent.trim(),c=n.item.text.trim(),y!==c&&(t[t.length-1].textContent=c));if(0!==t.length)if(u||e){var w=u?u.parentElement:f.startContainer,b=e?e.parentElement:f.endContainer,k=u?0:f.startOffset,d=f.endOffset;this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,w,b,k,d)}else 1===t.length?this.parent.nodeSelection.setSelectionContents(this.parent.currentDocument,t[0]):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,t[0],t[t.length-1],0,t[t.length-1].textContent.length)}},n.prototype.applyLinkToBlockNode=function(n,t,i){for(var a,v,y,c=new hu(this.parent.editableElement),l=c.getTextNodes(n),p=n.querySelectorAll("*"),r=this.parent.nodeSelection.getRange(this.parent.currentDocument),f=[],w=0===p.length,e=0;e<l.length;e++){var o=void 0,u=l[e],s=(new yi).getFormattedNode(u,"fontcolor",n);w?(o=this.getSplitNode(u,r),i.push(h.Wrap(o,this.createAchorNode(t)))):s?(f.length>0&&this.replaceElementsWithAnchor(f,this.createAchorNode(t),t.enterAction),o=this.getSplitNode(s,r),r.intersectsNode(s)&&(h.Wrap(s.firstChild,this.createAchorNode(t)),i.push(u))):(a="#text"===r.startContainer.nodeName&&r.startContainer===u&&0!==r.startOffset,v="#text"===r.endContainer.nodeName&&r.endContainer===u&&r.endOffset!==r.startContainer.textContent.length,(e>0&&("BR"===t.enterAction?this.parent.editableElement:c.getParentBlockNode(u))!==n&&this.replaceElementsWithAnchor(f,this.createAchorNode(t),t.enterAction),a||v)?(y=c.getTopMostNode(u),o=this.getSplitNode(y,r),i.push(u),f.push(u)):(i.push(u),f.push(u)),e===l.length-1&&this.replaceElementsWithAnchor(f,this.createAchorNode(t),t.enterAction))}},n.prototype.unwrapLink=function(n){var r=n.querySelectorAll("a"),e,i,u,o;if(0!==r.length){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),s=t.startContainer,c=t.endContainer,f=t.startOffset,l=t.endOffset;for(this.parent.nodeSelection.save(t,this.parent.currentDocument),e=this.parent.nodeSelection.get(this.parent.currentDocument),i=0;i<r.length;i++)t.intersectsNode(r[i])&&(e.containsNode(r[i],!1)?h.unwrap(r[i]):(u=r[i]&&r[i].textContent,u&&t.startContainer.textContent&&-1!==u.indexOf(t.startContainer.textContent)&&(f=0),o=this.getSplitNode(r[i],t),h.unwrap(o)));t.setStart(s,f);t.setEnd(c,l)}},n.prototype.replaceElementsWithAnchor=function(n,i,r){for(var v,e,a,o,s,u,f,h=new hu(this.parent.editableElement),c=[],l=0;l<n.length;l++)v=n[l],c.push(h.getTopMostNode(v));for(n.length=0,a=c[0],o=i.cloneNode(!0),a.parentElement.insertBefore(i,a),s=0;s<c.length;s++)if(u=c[s],"BR"===r)if(0===s)i.appendChild(u);else if(t.isNullOrUndefined(e))f=o.cloneNode(!0),u.parentElement.insertBefore(f,u),f.appendChild(u),e=f;else{var y=u.nextSibling&&"BR"===u.nextSibling.nodeName||h.isBlockNode(u.nextSibling),p=u.previousSibling&&"BR"===u.previousSibling.nodeName||h.isBlockNode(u.previousSibling),w=this.parent.editableElement.lastChild===u,b=h.isBlockNode(u.parentElement);y&&p?(f=o.cloneNode(!0),u.parentElement.insertBefore(f,u),f.appendChild(u),e=f):w?(f=o.cloneNode(!0),u.parentElement.insertBefore(f,u),f.appendChild(u)):b?(f=o.cloneNode(!0),u.parentElement.insertBefore(f,u),f.appendChild(u),e=f):e.appendChild(u)}else i.appendChild(u)},n.prototype.getSplitNode=function(n,t){var i=new su;return t.collapsed?i.SplitNode(t,n,!0):i.GetSpliceNode(t,n)},n}(),ust=function(){function n(n,t){this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.addEventListener();this.serviceLocator=t;this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.isDestroyed=!1;this.mouseDown=this.onDocumentClick.bind(this)}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(lo,this.linkDialog,this),this.parent.on(ts,this.showDialog,this),this.parent.on(al,this.closeDialog,this),this.parent.on(y,this.onKeyDown,this),this.parent.on(ii,this.showLinkQuickToolbar,this),this.parent.on(fr,this.clearDialogObj,this),this.parent.on(fc,this.onToolbarAction,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(ao,this.removeLink,this),this.parent.on(ec,this.editLink,this),this.parent.on(vo,this.openLink,this),this.parent.on(vt,this.editAreaClickHandler,this),this.parent.on(w,this.setCssClass,this),this.parent.on(u,this.destroy,this),this.parent.on(b,this.bindOnEnd,this),this.parent.on(yu,this.editAreaClickHandler,this))},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager&&!this.parent.formatter.editorManager.linkObj&&(this.parent.formatter.editorManager.linkObj=new rrt(this.parent.formatter.editorManager))},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"OpenLink":this.parent.notify(vo,n);break;case"EditLink":this.parent.notify(ec,n);break;case"RemoveLink":this.parent.notify(ao,n)}},n.prototype.removeEventListener=function(){this.parent.off(lo,this.linkDialog);this.parent.off(ts,this.showDialog);this.parent.off(al,this.closeDialog);this.parent.off(y,this.onKeyDown);this.parent.off(ii,this.showLinkQuickToolbar);this.parent.off(fr,this.clearDialogObj);this.parent.off(fc,this.onToolbarAction);this.parent.off(ao,this.removeLink);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(ec,this.editLink);this.parent.off(vo,this.openLink);this.parent.off(vt,this.editAreaClickHandler);this.parent.off(w,this.setCssClass);this.parent.off(u,this.destroy);this.parent.off(b,this.bindOnEnd);this.parent.off(yu,this.editAreaClickHandler);t.isNullOrUndefined(this.contentModule)||(this.parent.element.ownerDocument.removeEventListener("mousedown",this.mouseDown),this.mouseDown=null)},n.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){this.updateCss(this.checkBoxObj,n);this.updateCss(this.dialogObj,n)},n.prototype.showLinkQuickToolbar=function(n){var l=this,r,u,i;if(!t.isNullOrUndefined(n.args)&&"enter"!==n.args.action&&"space"!==n.args.action){if("Links"!==n.type||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var f,e=this.parent.element.getBoundingClientRect().top,s=this.parent.element.getBoundingClientRect().left,o=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(n.elements,function(n,t){0===t&&(f="#text"===n.nodeName?n.parentNode:n)}),n.isNotify){var h=this.parent.toolbarModule.getToolbarElement(),c=f.getBoundingClientRect().top,a=f.getBoundingClientRect().left,v=c-e,y=h?h.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;r=this.parent.iframeSettings.enable?s+a:f.getBoundingClientRect().left;u=window.pageYOffset+(this.parent.iframeSettings.enable?e+y+c:e+v);this.linkQTPopupTime=setTimeout(function(){l.showLinkPopup(r,u,o,n.args)},400)}else i=void 0,i=n.args.touches?n.args.changedTouches[0]:i=n.args,r=this.parent.iframeSettings.enable?window.pageXOffset+s+i.clientX:i.pageX,u=this.parent.iframeSettings.enable?window.pageYOffset+e+i.clientY:i.pageY,this.showLinkPopup(r,u,o,n.args);this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(o.endContainer,n.args)}},n.prototype.showLinkPopup=function(n,t,i,r){this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(i.endContainer,r)},n.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},n.prototype.editAreaClickHandler=function(n){if(this.parent.readonly)this.hideLinkQuickToolbar();else{var r=n.args,e=this.parent.quickToolbarSettings.showOnRightClick,s=this.parent.userAgentData.isSafari()&&3===r.which;if(!(2===r.which||e&&1===r.which||!e&&3===r.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar){this.quickToolObj=this.parent.quickToolbarModule;var i=r.target,h=i&&("HTML"===i.nodeName||"#document"===i.nodeName),c=!(i&&"#text"!==i.nodeName&&"#document"!==i.nodeName&&"HTML"!==i.nodeName&&i.closest(".e-rte-elements"));if((h||!this.parent.inputElement.contains(i)&&c)&&(i=(f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).commonAncestorContainer.parentElement),i=this.getAnchorNode([i]),this.contentModule=this.rendererFactory.getRenderer(o.Content),"A"===i.nodeName&&i.childNodes.length>0&&"IMG"!==i.childNodes[0].nodeName&&"IMG"!==n.args.target.nodeName&&!t.isNullOrUndefined(t.closest(this.parent.getRange().startContainer.parentElement,"A"))&&(!t.isNullOrUndefined(t.closest(this.parent.getRange().endContainer.parentElement,"A"))||s))if(!1===n.args.ctrlKey)this.showLinkQuickToolbar({args:r,isNotify:!1,type:"Links",elements:[r.target]});else{var u=this.parent.formatter.editorManager.nodeSelection,f=u.getRange(this.parent.contentModule.getDocument()),l={args:{item:{subCommand:"OpenLink",command:"Links",name:""},originalEvent:n.args},selectNode:u.getNodeCollection(f),selectParent:u.getParentNodeCollection(f),selection:u.save(f,this.parent.contentModule.getDocument())};this.parent.notify(vo,l)}else this.hideLinkQuickToolbar()}}},n.prototype.onKeyDown=function(n){var i=n.args;switch(i.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"insert-link":this.openDialog(!0,n);i.preventDefault()}},n.prototype.openDialog=function(n,t){var r;if(n||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),o={args:t?t.args:{item:{command:"Links",subCommand:"CreateLink"},originalEvent:void 0,name:n?null:"showDialog"},selectNode:f,selection:u,selectParent:e};this.linkDialog(o)}else r=this.parent.contentModule.getEditPanel(),this.parent.formatter.editorManager.markdownSelection.save(r.selectionStart,r.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:t&&t.args},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})},n.prototype.showDialog=function(){this.openDialog(!1);this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.linkDialog=function(n,i){var r=this,f;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else if(f="HTML"===this.parent.editorMode?n.selection.getRange(this.parent.contentModule.getDocument()).toString():n.text,!t.isNullOrUndefined(i)&&(!t.isNullOrUndefined(n.selectParent)&&n.selectParent.length>1||!t.isNullOrUndefined(n.selectNode)&&n.selectNode.length>1)&&(i.text=f),"HTML"===this.parent.editorMode&&(this.hasAnchorNodePresent(n.selectParent)||this.hasAnchorNodePresent(n.selectNode))&&t.isNullOrUndefined(i))this.editLink(n);else{var h=this.i10n.getConstant("linkWebUrl"),c=this.i10n.getConstant("linkText"),l=this.i10n.getConstant("linkTooltipLabel"),a=this.i10n.getConstant("linkurl"),v=this.i10n.getConstant("textPlaceholder"),y=this.i10n.getConstant("linkTitle"),e=this.parent.createElement("div",{className:"e-rte-link-dialog"+this.parent.getCssClass(!0),id:this.rteID+"_rtelink"});this.parent.rootContainer.appendChild(e);var u=this.parent.createElement("div",{className:"e-rte-linkcontent"+this.parent.getCssClass(!0),id:this.rteID+"_linkContent"}),p="HTML"===this.parent.editorMode?"<label>"+l+'<\/label><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+y+'"aria-label="'+this.i10n.getConstant("linkTitle")+'" class="e-input e-rte-linkTitle'+this.parent.getCssClass(!0)+'"><\/div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="checkbox" class="e-rte-linkTarget'+this.parent.getCssClass(!0)+'"  data-role ="none"><\/div>':"",w=vr('<div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+h+'<\/label><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" spellcheck="false" placeholder="'+a+'"aria-label="'+this.i10n.getConstant("linkWebUrl")+'" class="e-input e-rte-linkurl'+this.parent.getCssClass(!0)+'"/><\/div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+c+'<\/label><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText'+this.parent.getCssClass(!0)+'"aria-label="'+this.i10n.getConstant("linkText")+'" placeholder="'+v+'"><\/div><div class="e-rte-label'+this.parent.getCssClass(!0)+'">'+p);u.appendChild(w);var b=u.querySelector(".e-rte-linkTarget"),k=u.querySelector(".e-rte-linkurl"),o=u.querySelector(".e-rte-linkText"),d=u.querySelector(".e-rte-linkTitle"),g=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new rr.CheckBox({label:g,checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass()});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(b);var nt=this.i10n.getConstant("dialogInsert"),tt=this.i10n.getConstant("dialogCancel"),it=n.selection,s={selection:n.selection,selectParent:n.selectParent,args:n.args},rt={header:this.i10n.getConstant("linkHeader"),content:u,cssClass:pt+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"310px",position:{X:"center",Y:t.Browser.isDevice?"center":"top"},isModal:t.Browser.isDevice,buttons:[{click:this.insertlink.bind(this,s),buttonModel:{content:nt,cssClass:"e-flat e-insertLink"+this.parent.getCssClass(!0),isPrimary:!0}},{click:this.cancelDialog.bind(this,s),buttonModel:{cssClass:"e-flat"+this.parent.getCssClass(!0),content:tt}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){r.parent.isBlur=!1;n&&n.event.returnValue&&("HTML"===r.parent.editorMode?it.restore():r.parent.formatter.editorManager.markdownSelection.restore(r.parent.contentModule.getEditPanel()));r.dialogObj.element&&r.dialogObj.element.querySelector(".e-rte-linkurl")&&null!==r.dialogObj.element.querySelector(".e-rte-linkurl")&&t.EventHandler.remove(r.dialogObj.element.querySelector(".e-rte-linkurl"),"input",r.handleKeyDown);r.dialogObj.destroy();t.detach(r.dialogObj.element);var i=r.dialogObj;r.dialogRenderObj.close(i);r.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(rt);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(e);e.style.maxHeight="inherit";t.isNullOrUndefined(this.dialogObj)||(t.isNullOrUndefined(i)||(k.value=i.url,o.value=i.text,d.value=i.title,this.checkBoxObj.checked=i.target?!0:!1,this.dialogObj.header=i.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=i.btnText),this.checkUrl(!1),("HTML"===this.parent.editorMode&&t.isNullOrUndefined(i)&&(!t.isNullOrUndefined(f)&&""!==f&&0===n.selection.range.startOffset||n.selection.range.startOffset!==n.selection.range.endOffset)||"Markdown"===n.module)&&(o.value=f),this.parent.element.ownerDocument.addEventListener("mousedown",this.mouseDown),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup()))}},n.prototype.hasAnchorNodePresent=function(n){return!t.isNullOrUndefined(n)&&n.length>0&&n.some(function(n){return n&&null!==t.closest(n,"a")})},n.prototype.insertlink=function(n){var c,f=this.dialogObj.element,r=f.querySelector(".e-rte-linkurl").value.trim(),u=f.querySelector(".e-rte-linkText").value,l,a,i,e,v,o,h;"HTML"===this.parent.editorMode&&(c=f.querySelector(".e-rte-linkTitle").value);l=this.checkBoxObj.checked?"_blank":null;a=this.checkBoxObj.checked?this.i10n.getConstant("linkAriaLabel"):null;("Markdown"===this.parent.editorMode&&""===r&&(r="https://"),""!==r)?(u="Markdown"===this.parent.editorMode?""!==u.trim()?u:"":""===u.trim()?r:u,this.isUrl(r)?this.checkUrl(!1):this.parent.enableAutoUrl||(r=r.indexOf("https")>-1?r:"https://"+r),i=this,"HTML"===i.parent.editorMode&&t.isNullOrUndefined(t.closest(n.selection.range.startContainer.parentNode,"[id='"+i.parent.contentModule.getPanel().id+"']"))&&(i.parent.contentModule.getEditPanel().focus(),t.Browser.isIE&&i.parent.iframeSettings.enable&&n.selection.restore(),e=i.parent.formatter.editorManager.nodeSelection.getRange(i.parent.contentModule.getDocument()),n.selection=i.parent.formatter.editorManager.nodeSelection.save(e,i.parent.contentModule.getDocument()),n.selectParent=i.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e)),v={url:r,text:u,title:c,target:l,ariaLabel:a,selection:n.selection,selectParent:n.selectParent},(document.body.contains(i.dialogObj.element)&&this.dialogObj.hide({returnValue:!1}),null===this.dialogObj)&&((s()&&i.parent.iframeSettings.enable&&t.select("iframe",i.parent.element).contentWindow.focus(),"HTML"===i.parent.editorMode&&n.selection.restore(),0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),t.isNullOrUndefined(n.args)||"KeyK"!==n.args.code)?o=n.args:(h=n.args,t.extend(n.args,{item:{command:"Links",subCommand:"CreateLink"},originalEvent:h},!0),o={item:{command:"Links",subCommand:"CreateLink"},originalEvent:h}),this.parent.formatter.process(this.parent,o,!t.isNullOrUndefined(n.args)&&n.args.originalEvent,v),this.parent.contentModule.getEditPanel().focus())):this.checkUrl(!0)},n.prototype.isUrl=function(n){return new RegExp("(ftp|http|https)://(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(/|/([\\w#!:.?+=&%@\\-\\/]))?","gi").test(n)},n.prototype.handleKeyDown=function(){var n=this.parent.element.querySelector("#"+this.rteID+"_rtelink_dialog-content").querySelector(".e-rte-linkurl");n.classList.contains("e-error")&&n.value.length>=1&&" "!==n.value.trim()&&t.removeClass([n],"e-error")},n.prototype.checkUrl=function(n){var i=this.dialogObj.element.querySelector(".e-rte-linkurl");n?(t.addClass([i],"e-error"),i.setSelectionRange(0,i.value.length),i.focus(),t.EventHandler.add(i,"input",this.handleKeyDown,this)):(t.removeClass([i],"e-error"),t.EventHandler.remove(i,"input",this.handleKeyDown))},n.prototype.removeLink=function(n){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var i=this.getAnchorNode(n.selectParent);this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,selectParent:n.selectParent,selection:n.selection,text:i.innerText,subCommand:n.args.item.subCommand});s()&&this.parent.iframeSettings.enable?t.select("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus();this.hideLinkQuickToolbar()},n.prototype.openLink=function(n){var t=this.getAnchorNode(n.selectParent),r,i;(t.classList.contains("e-rte-anchor")||"A"===t.tagName)&&(r=this.parent.htmlEditorModule.sanitizeHelper(t.outerHTML),i=document.createElement("div"),i.innerHTML=r,this.parent.formatter.process(this.parent,n.args,n.args,{url:i.firstChild.href,text:t.innerText,target:""===t.target?"_self":"_blank",selectNode:n.selectNode,subCommand:n.args.item.subCommand}),i.remove())},n.prototype.getAnchorNode=function(n){for(var f,u,i=0,r=n;i<r.length;i++)if(f=r[i],u=t.closest(f,"a"),u)return u;return n[0]},n.prototype.editLink=function(n){var i=this.getAnchorNode(n.selectNode),t=this.getAnchorNode(n.selectParent),r,u;((t="A"===i.nodeName?i:t).classList.contains("e-rte-anchor")||"A"===t.tagName)&&(r=this.i10n.getConstant("dialogUpdate"),u={url:t.getAttribute("href"),text:t.innerText,title:t.title,target:t.target,header:this.i10n.getConstant("editLink"),btnText:r},this.linkDialog(n,u))},n.prototype.cancelDialog=function(n){if(this.parent.isBlur=!1,this.dialogObj.hide({returnValue:!0}),s())n.selection.restore();else{var t=window.scrollX,i=window.scrollY;this.parent.contentModule.getEditPanel().focus();window.scrollTo(t,i)}},n.prototype.onDocumentClick=function(n){var i=n.target;t.isNullOrUndefined(this.dialogObj)||(t.closest(i,"[id='"+this.dialogObj.element.id+"']")||!this.parent.toolbarSettings.enable||!this.parent.getToolbarElement()||this.parent.getToolbarElement().contains(n.target))&&(!(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)||this.parent.inlineMode.enable&&!t.closest(i,"#"+this.dialogObj.element.id))||t.closest(i,"#"+this.parent.getID()+"_toolbar_CreateLink")||i.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))||(this.parent.notify(nu,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,eu(this.parent.element,"focusout"))},n.prototype.destroy=function(){this.isDestroyed||(t.isNullOrUndefined(this.linkQTPopupTime)||(clearTimeout(this.linkQTPopupTime),this.linkQTPopupTime=null),this.removeEventListener(),this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"link"},n}(),urt=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(no,this.imageCommand,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(no,this.imageCommand);this.parent.observer.off(f,this.destroy)},n.prototype.imageCommand=function(n){switch(n.value.toString().toLowerCase()){case"image":case"replace":this.createImage(n);break;case"insertlink":this.insertImageLink(n);break;case"openimagelink":this.openImageLink(n);break;case"editimagelink":this.editImageLink(n);break;case"removeimagelink":this.removeImageLink(n);break;case"remove":this.removeImage(n);break;case"alttext":this.insertAltTextImage(n);break;case"dimension":this.imageDimension(n);break;case"caption":this.imageCaption(n);break;case"justifyleft":this.imageJustifyLeft(n);break;case"justifycenter":this.imageJustifyCenter(n);break;case"justifyright":this.imageJustifyRight(n);break;case"inline":this.imageInline(n);break;case"break":this.imageBreak(n)}},n.prototype.createImage=function(n){var r=this,f=!1,u,e;if((n.item.url=t.isNullOrUndefined(n.item.url)||"undefined"===n.item.url?n.item.src:n.item.url,t.isNullOrUndefined(n.item.selectParent)||"IMG"!==n.item.selectParent[0].tagName)?(u=t.createElement("img"),this.setStyle(u,n),t.isNullOrUndefined(n.item.selection)||n.item.selection.restore(),t.isNullOrUndefined(n.selector)||"pasteCleanupModule"!==n.selector?kt.Insert(this.parent.currentDocument,u,this.parent.editableElement):t.isNullOrUndefined(this.parent.currentDocument)||n.callBack({requestType:"Images",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[u]})):(e=n.item.selectParent[0],f=!0,this.setStyle(e,n,f)),n.callBack&&(t.isNullOrUndefined(n.selector)||!t.isNullOrUndefined(n.selector)&&"pasteCleanupModule"!==n.selector)){var o=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],i="Replace"===n.value||f?n.item.selectParent[0]:t.Browser.isIE?o.previousSibling:o.previousElementSibling,s=function(){if(!t.isNullOrUndefined(r.parent.currentDocument)){r.parent.userAgentData.isSafari()&&hr(r.parent.currentDocument,r.parent.editableElement);var u=i.getAttribute("width"),f=i.getAttribute("height");(t.isNullOrUndefined(u)||"auto"===u)&&i.setAttribute("width",i.offsetWidth.toString());(t.isNullOrUndefined(f)||"auto"===f)&&i.setAttribute("height",i.offsetHeight.toString());n.callBack({requestType:"Replace"===n.value?(n.item.subCommand="Replace","Replace"):"Images",editorMode:"HTML",event:n.event,range:r.parent.nodeSelection.getRange(r.parent.currentDocument),elements:[i]})}i.removeEventListener("load",s)};i.addEventListener("load",s)}},n.prototype.setStyle=function(n,i,r){var f;if(t.isNullOrUndefined(i.item.url)||n.setAttribute("src",i.item.url),r)for(var o={"e-imgcenter":"e-imgcenter","e-imgright":"e-imgright","e-imgleft":"e-imgleft"},e=n.classList,u=0;u<e.length;u++)t.isNullOrUndefined(o[e[u]])||(f=o[e[u]]);n.setAttribute("class","e-rte-image"+(t.isNullOrUndefined(i.item.cssClass)?"":" "+i.item.cssClass)+(t.isNullOrUndefined(f)?"":" "+f));t.isNullOrUndefined(i.item.altText)||n.setAttribute("alt",i.item.altText.replace(/\.[a-zA-Z0-9]+$/,""));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.width)||n.setAttribute("width",this.calculateStyleValue(i.item.width.width));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.height)||n.setAttribute("height",this.calculateStyleValue(i.item.height.height));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.minWidth)||(n.style.minWidth=this.calculateStyleValue(i.item.width.minWidth));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.maxWidth)||(n.style.maxWidth=this.calculateStyleValue(i.item.width.maxWidth));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.minHeight)||(n.style.minHeight=this.calculateStyleValue(i.item.height.minHeight));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.maxHeight)||(n.style.maxHeight=this.calculateStyleValue(i.item.height.maxHeight))},n.prototype.calculateStyleValue=function(n){return"string"==typeof n&&(n.indexOf("px")||n.indexOf("%")||n.indexOf("auto"))?n:n+"px"},n.prototype.insertImageLink=function(n){var i=t.createElement("a",{attrs:{href:n.item.url}});n.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(n.item.selection.restore(),i.setAttribute("contenteditable","true"));i.appendChild(n.item.selectNode[0]);t.isNullOrUndefined(n.item.target)||i.setAttribute("target",n.item.target);t.isNullOrUndefined(n.item.ariaLabel)||i.setAttribute("aria-label",n.item.ariaLabel);kt.Insert(this.parent.currentDocument,i,this.parent.editableElement);this.callBack(n)},n.prototype.openImageLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeImageLink=function(n){var i=n.item.selectParent[0];if(i.classList.contains("e-img-caption")){var r=t.select(".e-img-wrap",i),u=t.select(".e-img-inner",i),f=u.cloneNode(!0);t.detach(t.select("a",i));t.detach(u);r.appendChild(n.item.insertElement);r.appendChild(f)}else t.detach(i),t.Browser.isIE&&n.item.selection&&n.item.selection.restore(),kt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.editImageLink=function(n){n.item.selectNode[0].parentElement.href=n.item.url;t.isNullOrUndefined(n.item.target)?(n.item.selectNode[0].parentElement.removeAttribute("target"),n.item.selectNode[0].parentElement.removeAttribute("aria-label")):(n.item.selectNode[0].parentElement.target=n.item.target,n.item.selectNode[0].parentElement.setAttribute("aria-label",n.item.ariaLabel));this.callBack(n)},n.prototype.removeImage=function(n){if(t.closest(n.item.selectNode[0],"a"))"A"!==n.item.selectNode[0].parentElement.nodeName||t.isNullOrUndefined(n.item.selectNode[0].parentElement.innerText)?t.detach(t.closest(n.item.selectNode[0],"a")):t.isNullOrUndefined(t.closest(n.item.selectNode[0],"."+v))?t.detach(n.item.selectNode[0]):t.detach(t.closest(n.item.selectNode[0],"."+v));else if(t.isNullOrUndefined(t.closest(n.item.selectNode[0],"."+v))){var i=n.item.selectNode[0].parentElement;t.detach(n.item.selectNode[0]);0===i.childNodes.length&&i.appendChild(document.createElement("br"))}else t.detach(t.closest(n.item.selectNode[0],"."+v));this.callBack(n)},n.prototype.insertAltTextImage=function(n){n.item.selectNode[0].setAttribute("alt",n.item.altText);this.callBack(n)},n.prototype.imageDimension=function(n){var i=n.item.selectNode[0];i.style.height="";i.style.width="";"auto"!==n.item.width?i.style.width=t.formatUnit(n.item.width):i.removeAttribute("width");"auto"!==n.item.height?i.style.height=t.formatUnit(n.item.height):i.removeAttribute("height");this.callBack(n)},n.prototype.imageCaption=function(n){kt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.imageJustifyLeft=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+v))||(t.removeClass([t.closest(i,"."+v)],bi),t.addClass([t.closest(i,"."+v)],ki)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],bi),t.addClass([i.parentElement],ki),t.addClass([i],ki)):null!=i.parentElement.nextElementSibling?(t.addClass([i],ki),i.parentElement.nextElementSibling.style.clear="left"):t.addClass([i],ki),this.callBack(n))},n.prototype.imageJustifyCenter=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+v))||(t.removeClass([t.closest(i,"."+v)],ki),t.removeClass([t.closest(i,"."+v)],bi),t.addClass([t.closest(i,"."+v)],ef)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],ki),t.removeClass([i.parentElement],bi),t.addClass([i.parentElement],ef),t.addClass([i],ef)):t.addClass([i],ef),this.callBack(n))},n.prototype.imageJustifyRight=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+v))||(t.removeClass([t.closest(i,"."+v)],ki),t.addClass([t.closest(i,"."+v)],bi)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],ki),t.addClass([i.parentElement],bi),t.addClass([i],bi)):null!=i.parentElement.nextElementSibling?(t.addClass([i],bi),i.parentElement.nextElementSibling.style.clear="right"):t.addClass([i],bi),this.callBack(n))},n.prototype.imageInline=function(n){var i=n.item.selectNode[0];i.removeAttribute("class");t.addClass([i],"e-rte-image");t.addClass([i],trt);t.isNullOrUndefined(t.closest(i,"."+v))||(t.removeClass([t.closest(i,"."+v)],op),t.removeClass([t.closest(i,"."+v)],ef),t.removeClass([t.closest(i,"."+v)],ki),t.removeClass([t.closest(i,"."+v)],bi),t.addClass([t.closest(i,"."+v)],wk));this.callBack(n)},n.prototype.imageBreak=function(n){var i=n.item.selectNode[0];i.removeAttribute("class");t.addClass([i],op);t.addClass([i],"e-rte-image");t.isNullOrUndefined(t.closest(i,"."+v))||(t.removeClass([t.closest(i,"."+v)],wk),t.removeClass([t.closest(i,"."+v)],ef),t.removeClass([t.closest(i,"."+v)],ki),t.removeClass([t.closest(i,"."+v)],bi),t.addClass([t.closest(i,"."+v)],op));this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n}(),fst=function(){function n(n,t){this.isImgUploaded=!1;this.isAllowedTypes=!0;this.pageX=null;this.pageY=null;this.deletedImg=[];this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.popupUploaderObj=t.getService("popupUploaderObject");this.addEventListener();this.drop=this.dragDrop.bind(this);this.drag=this.dragOver.bind(this);this.enter=this.dragEnter.bind(this);this.start=this.dragStart.bind(this);this.docClick=this.onDocumentClick.bind(this);this.isDestroyed=!1}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(y,this.onKeyDown,this),this.parent.on(tt,this.onKeyUp,this),this.parent.on(af,this.insertImage,this),this.parent.on(is,this.showDialog,this),this.parent.on(vl,this.closeDialog,this),this.parent.on(dr,this.onWindowResize,this),this.parent.on(ii,this.showImageQuickToolbar,this),this.parent.on(fr,this.clearDialogObj,this),this.parent.on(ic,this.onToolbarAction,this),this.parent.on(ac,this.caption,this),this.parent.on(hc,this.deleteImg,this),this.parent.on(oc,this.insertImgLink,this),this.parent.on(sc,this.insertAltText,this),this.parent.on(vt,this.editAreaClickHandler,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(vc,this.imageSize,this),this.parent.on(ci,this.alignmentSelect,this),this.parent.on(a,this.afterRender,this),this.parent.on(er,this.afterRender,this),this.parent.on(vu,this.imagePaste,this),this.parent.on(w,this.setCssClass,this),this.parent.on(u,this.destroy,this),this.parent.on(b,this.bindOnEnd,this))},n.prototype.removeEventListener=function(){if(!this.parent.isDestroyed){this.parent.off(y,this.onKeyDown);this.parent.off(tt,this.onKeyUp);this.parent.off(dr,this.onWindowResize);this.parent.off(af,this.insertImage);this.parent.off(is,this.showDialog);this.parent.off(vl,this.closeDialog);this.parent.off(ii,this.showImageQuickToolbar);this.parent.off(fr,this.clearDialogObj);this.parent.off(ac,this.caption);this.parent.off(ic,this.onToolbarAction);this.parent.off(hc,this.deleteImg);this.parent.off(oc,this.insertImgLink);this.parent.off(sc,this.insertAltText);this.parent.off(vt,this.editAreaClickHandler);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(vc,this.imageSize);this.parent.off(ci,this.alignmentSelect);this.parent.off(a,this.afterRender);this.parent.off(er,this.afterRender);this.parent.off(vu,this.imagePaste);this.parent.off(w,this.setCssClass);this.parent.off(u,this.destroy);this.parent.off(b,this.bindOnEnd);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.removeEventListener("drop",this.drop,!0);n.removeEventListener("dragstart",this.drag,!0);n.removeEventListener("dragenter",this.enter,!0);n.removeEventListener("dragover",this.start,!0);this.drop=null;this.drag=null;this.enter=null;this.start=null;t.isNullOrUndefined(this.contentModule)||(t.EventHandler.remove(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.imageClick),this.parent.formatter.editorManager.observer.off(gf,this.undoStack),this.parent.insertImageSettings.resize&&(t.EventHandler.remove(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart),this.parent.element.ownerDocument.removeEventListener("mousedown",this.docClick),this.docClick=null,t.EventHandler.remove(this.contentModule.getEditPanel(),"cut",this.onCutHandler),t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing)))}},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager&&!this.parent.formatter.editorManager.imgObj&&(this.parent.formatter.editorManager.imgObj=new urt(this.parent.formatter.editorManager))},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){this.popupObj&&n.cssClass&&(t.isNullOrUndefined(n.oldCssClass)||t.removeClass([this.popupObj.element],n.oldCssClass),t.addClass([this.popupObj.element],n.cssClass));this.updateCss(this.checkBoxObj,n);this.updateCss(this.widthNum,n);this.updateCss(this.heightNum,n);this.updateCss(this.uploadObj,n);this.updateCss(this.dialogObj,n)},n.prototype.onIframeMouseDown=function(n){var i=n.target;this.dialogObj&&this.dialogObj.hide({returnValue:!0});(t.isNullOrUndefined(this.parent.currentTarget)||"IMG"!==this.parent.currentTarget.nodeName)&&this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction();this.contentModule.getEditPanel().querySelector(".e-img-resize")&&"IMG"===this.parent.currentTarget.nodeName&&(t.isNullOrUndefined(this.prevSelectedImgEle)||this.prevSelectedImgEle===i||(this.prevSelectedImgEle.style.outline=""))},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content);t.EventHandler.add(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.imageClick,this);this.parent.insertImageSettings.resize&&(t.EventHandler.add(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart,this),this.parent.element.ownerDocument.addEventListener("mousedown",this.docClick),t.EventHandler.add(this.contentModule.getEditPanel(),"cut",this.onCutHandler,this));var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.addEventListener("drop",this.drop,!0);n.addEventListener("dragstart",this.drag,!0);n.addEventListener("dragenter",this.enter,!0);n.addEventListener("dragover",this.start,!0)},n.prototype.undoStack=function(n){var r,i,s,u,f,e,o;if(("undo"===n.subCommand.toLowerCase()||"redo"===n.subCommand.toLowerCase())&&"HTML"===this.parent.editorMode)for(r=0;r<this.parent.formatter.getUndoRedoStack().length;r++)if(i=this.parent.createElement("div"),s=this.parent.formatter.getUndoRedoStack()[r].text,i.appendChild(s.cloneNode(!0)),u=i.querySelectorAll("img"),i.querySelector(".e-img-resize")&&u.length>0){for(f=0;f<u.length;f++)u[f].style.outline="";for(t.detach(i.querySelector(".e-img-resize")),e=i.cloneNode(!0),o=document.createDocumentFragment();e.firstChild;)o.appendChild(e.firstChild);this.parent.formatter.getUndoRedoStack()[r].text=o}},n.prototype.resizeEnd=function(n){this.resizeBtnInit();this.imgEle.parentElement&&(this.imgEle.parentElement.style.cursor="auto");t.Browser.isDevice&&t.removeClass([n.target.parentElement],"e-mob-span");var i={event:n,requestType:"images"};this.parent.trigger(co,i);this.parent.formatter.editorManager.observer.on(gf,this.undoStack,this);this.parent.formatter.saveData();t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd)},n.prototype.resizeStart=function(n,i){var h=this,r,o,e,u,f,s;if(!this.parent.readonly&&(r=i||n.target,(this.prevSelectedImgEle=this.imgEle,"IMG"===r.tagName)&&(this.parent.preventDefaultResize(n),o=r,this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&t.detach(this.imgResizeDiv),this.imageResize(o)),r.classList.contains("e-rte-imageboxmark"))){for(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),n.preventDefault(),n.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.imageQTBar.hidePopup(),e=["topLeft","topRight","botLeft","botRight"],u=0;u<e.length;u++)if(f=e[u],r.classList.contains("e-rte-"+f)){this.resizeBtnStat[f]=!0;this.currentResizeHandler=f;this.aspectRatio=this.findAspectRatio(this.imgEle);break}t.Browser.isDevice&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&!this.imgResizeDiv.classList.contains("e-mob-span")?t.addClass([this.imgResizeDiv],"e-mob-span"):(s={event:n,requestType:"images"},this.parent.trigger(cu,s,function(n){n.cancel&&h.cancelResizeAction()}));t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing,this);t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd,this)}},n.prototype.imageClick=function(n){t.Browser.isDevice&&("IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName||"IMG"===n.target.tagName?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),n.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true"));"IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName&&n.preventDefault()},n.prototype.onCutHandler=function(){this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction()},n.prototype.imageResize=function(n){this.resizeBtnInit();this.imgEle=n;t.addClass([this.imgEle],"e-resize");this.imgResizeDiv=this.parent.createElement("span",{className:"e-img-resize"+this.parent.getCssClass(!0),id:this.rteID+"_imgResize"});this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topLeft"+this.parent.getCssClass(!0),styles:"cursor: nwse-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topRight"+this.parent.getCssClass(!0),styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botLeft"+this.parent.getCssClass(!0),styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botRight"+this.parent.getCssClass(!0),styles:"cursor: nwse-resize"}));t.Browser.isDevice&&t.addClass([this.imgResizeDiv],"e-mob-rte");n.style.outline="2px solid #4a90e2";this.imgResizePos(n,this.imgResizeDiv);this.resizeImgDupPos(n);this.contentModule.getEditPanel().appendChild(this.imgResizeDiv);"auto"===this.parent.element.style.height&&this.imgResizePos(n,this.imgResizeDiv)},n.prototype.getPointX=function(n){return this.parent.iframeSettings.enable?n.touches&&n.touches.length?n.touches[0].screenX:n.screenX:n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return this.parent.iframeSettings.enable?n.touches&&n.touches.length?n.touches[0].screenY:n.screenY:n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.imgResizePos=function(n,i){var e=this.calcPos(n),u=e.top,f=e.left,o=n.getBoundingClientRect().width,s=n.getBoundingClientRect().height,r=t.Browser.isDevice?4*parseInt(n.style.outline.slice(-3),10)+2:2*parseInt(n.style.outline.slice(-3),10)+2,h=t.Browser.isDevice?0:2;i.querySelector(".e-rte-botLeft").style.left=f-r+"px";i.querySelector(".e-rte-botLeft").style.top=s-r+u+"px";i.querySelector(".e-rte-botRight").style.left=o-(r-h)+f+"px";i.querySelector(".e-rte-botRight").style.top=s-r+u+"px";i.querySelector(".e-rte-topRight").style.left=o-(r-h)+f+"px";i.querySelector(".e-rte-topRight").style.top=u-r+"px";i.querySelector(".e-rte-topLeft").style.left=f-r+"px";i.querySelector(".e-rte-topLeft").style.top=u-r+"px"},n.prototype.calcPos=function(n){for(var f,r={top:0,left:0},u=n.ownerDocument,i=(n.offsetParent&&(n.offsetParent.classList.contains("e-img-caption")||["TD","TH","TABLE","A"].indexOf(n.offsetParent.tagName)>-1)?t.closest(n,"#"+this.parent.getID()+"_rte-edit-view"):n.offsetParent)||u.documentElement;i&&(i===u.body||i===u.documentElement)&&"static"===i.style.position;)i=i.parentNode;return i&&i!==n&&1===i.nodeType&&(r=i.getBoundingClientRect()),n.offsetParent&&n.offsetParent.classList.contains("e-img-caption")?{top:(f=n.getBoundingClientRect()).top-r.top,left:f.left-r.left}:{top:n.offsetTop,left:n.offsetLeft}},n.prototype.setAspectRatio=function(n,i,r){if(!t.isNullOrUndefined(n.width)){var f=n.width===n.height,u=this.parent.insertImageSettings.resizeByPercent?"%":"px",e=""===n.style.width&&""===n.style.height;f||e?(this.setImageWidth(n,i,u),this.parent.insertImageSettings.resizeByPercent?this.removeImageHeight(n):this.setImageHeight(n,r,u)):""!==n.style.width&&""!==n.style.height?this.parent.insertImageSettings.resizeByPercent?(this.setImageWidth(n,i,u),this.removeImageHeight(n)):(this.setImageWidth(n,i,u),this.setImageHeight(n,r,u)):""!==n.style.width?this.parent.insertImageSettings.resizeByPercent?(this.setImageWidth(n,i,u),this.removeImageHeight(n)):this.setImageWidth(n,i,u):""!==n.style.height&&(this.parent.insertImageSettings.resizeByPercent?(this.setImageWidth(n,i,u),this.removeImageHeight(n)):this.setImageHeight(n,r,u))}},n.prototype.setImageWidth=function(n,t,i){n.style.width=this.getImageDimension(t,n)+i;this.parent.insertImageSettings.resizeByPercent||n.setAttribute("width",t.toString())},n.prototype.setImageHeight=function(n,t,i){n.style.height=this.getImageDimension(t,n)+i;this.parent.insertImageSettings.resizeByPercent||n.setAttribute("height",t.toString())},n.prototype.removeImageHeight=function(n){n.style.height="";n.removeAttribute("height")},n.prototype.getImageDimension=function(n,t){if(this.parent.insertImageSettings.resizeByPercent){var i=t.parentElement;return this.pixToPerc(n,i)}return n},n.prototype.adjustDimensionsByAspectRatio=function(n,t,i){return t=Math.round(n/i),{width:n=Math.round(t*i),height:t}},n.prototype.pixToPerc=function(n,t){return n/parseFloat(getComputedStyle(t).width)*100},n.prototype.imgDupMouseMove=function(n,i,r){var u=this,f={event:r,requestType:"images"};this.parent.trigger(ho,f,function(r){if(r.cancel)u.cancelResizeAction();else{if(parseInt(u.parent.insertImageSettings.minWidth,10)>=parseInt(n,10)||parseInt(u.parent.getInsertImgMaxWidth(),10)<=parseInt(n,10)&&t.isNullOrUndefined(u.imgEle.style.width))return;if(!u.parent.insertImageSettings.resizeByPercent&&(parseInt(u.parent.insertImageSettings.minHeight,10)>=parseInt(i,10)||parseInt(u.parent.insertImageSettings.maxHeight,10)<=parseInt(i,10)))return;u.imgEle.parentElement.style.cursor="pointer";u.setAspectRatio(u.imgEle,parseInt(n,10),parseInt(i,10));u.resizeImgDupPos(u.imgEle);u.imgResizePos(u.imgEle,u.imgResizeDiv)}})},n.prototype.resizing=function(n){if(this.parent){if(this.resizeBtnStat.botRight||this.resizeBtnStat.botLeft||this.resizeBtnStat.topRight||this.resizeBtnStat.topLeft)if(this.parent.iframeSettings.enable){var t=this.getResizeFactor(this.currentResizeHandler),o=this.getPointX(n),s=this.getPointY(n),r=this.imgEle.clientWidth,u=this.imgEle.clientHeight,h=o-this.pageX,c=s-this.pageY,f=h*t[0]+r,e=c*t[1]+u,i=this.adjustDimensions(f,e,h,c,this.aspectRatio);this.pageX=o;this.pageY=s;this.imgDupMouseMove(i.width+"px",i.height+"px",n);this.parent.autoResize()}else{var l=this.getPointX(n),a=this.getPointY(n),v=(t=this.getResizeFactor(this.currentResizeHandler),l-this.pageX),y=a-this.pageY;r=this.imgEle.clientWidth;u=this.imgEle.clientHeight;f=v*t[0]+r;e=y*t[1]+u;i=this.adjustDimensions(f,e,v,y,this.aspectRatio);this.pageX=l;this.pageY=a;this.imgDupMouseMove(i.width+"px",i.height+"px",n)}}else this.cancelResizeAction()},n.prototype.adjustDimensions=function(n,t,i,r,u){return n=n<16?16:n,t=t<16?16:t,this.adjustDimensionsByAspectRatio(n,t,u)},n.prototype.getResizeFactor=function(n){return eit[n]},n.prototype.findAspectRatio=function(n){return n.clientWidth/n.clientHeight},n.prototype.cancelResizeAction=function(){t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&(t.detach(this.imgResizeDiv),this.imgEle.style.outline="",this.imgResizeDiv=null,this.pageX=null,this.pageY=null,this.currentResizeHandler=null,this.aspectRatio=null)},n.prototype.resizeImgDupPos=function(n){this.imgDupPos={width:""!==n.style.width&&this.parent.insertImageSettings&&!this.parent.insertImageSettings.resizeByPercent?this.imgEle.style.width:n.width+"px",height:""!==n.style.height?this.imgEle.style.height:n.height+"px"}},n.prototype.resizeBtnInit=function(){return this.aspectRatio=null,this.currentResizeHandler=null,this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},n.prototype.onToolbarAction=function(n){switch(s()&&this.parent.notify(lt,{}),n.args.item.subCommand){case"Replace":this.parent.fileManagerSettings.enable?this.parent.notify(go,n):this.parent.notify(af,n);break;case"Caption":this.parent.notify(ac,n);break;case"InsertLink":this.parent.notify(oc,n);break;case"AltText":this.parent.notify(sc,n);break;case"Remove":this.parent.notify(hc,n);break;case"Dimension":this.parent.notify(vc,n);break;case"OpenImageLink":this.openImgLink(n);break;case"EditImageLink":this.editImgLink(n);break;case"RemoveImageLink":this.removeImgLink(n)}},n.prototype.openImgLink=function(n){var r=this.parent.htmlEditorModule.sanitizeHelper(n.selectParent[0].parentNode.outerHTML),t=document.createElement("div"),i;t.innerHTML=r;i=""===n.selectParent[0].parentNode.target?"_self":"_blank";this.parent.formatter.process(this.parent,n.args,n.args,{url:t.firstChild.href,target:i,selectNode:n.selectNode,subCommand:n.args.item.subCommand});t.remove()},n.prototype.editImgLink=function(n){var t=n.selectParent[0].parentNode,i=this.i10n.getConstant("dialogUpdate"),r={url:t.href,target:t.target,header:"Edit Link",btnText:i};this.insertImgLink(n,r)},n.prototype.removeImgLink=function(n){t.Browser.isIE&&this.contentModule.getEditPanel().focus();n.selection.restore();var i=!(!this.contentModule.getEditPanel().contains(this.captionEle)||!t.select("a",this.captionEle)),r=i?[this.captionEle]:[n.selectNode[0].parentElement];this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:n.selectNode[0],selectParent:r,selection:n.selection,subCommand:n.args.item.subCommand});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.isNullOrUndefined(n.selectParent)||t.removeClass([n.selectParent[0]],"e-img-focus"));i&&t.select(".e-img-inner",this.captionEle).focus()},n.prototype.onKeyDown=function(n){var i,o,u,f,a,r=n.args,s,e,c,v,h,l;if(this.deletedImg=[],"HTML"===this.parent.editorMode&&(a=(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).startContainer===i.endContainer&&i.startOffset===i.endOffset),!a&&"HTML"===this.parent.editorMode&&[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183].indexOf(r.which)<0)for(s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),e=0;e<s.length;e++)"IMG"===s[e].nodeName&&this.deletedImg.push(s[e]);"HTML"===this.parent.editorMode&&(8===r.which&&"Backspace"===r.code||46===r.which&&"Delete"===r.code)&&(c=i.startContainer===i.endContainer&&i.startOffset===i.endOffset,8===r.which&&"Backspace"===r.code&&c?this.checkImageBack(i):46===r.which&&"Delete"===r.code&&c&&this.checkImageDel(i));(t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||"KeyK"===r.code||(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),f=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),r.ctrlKey||!r.key||1!==r.key.length&&"enter"!==r.action||t.isNullOrUndefined(f[0])||"IMG"!==f[0].tagName||!f[0].parentElement||(this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),t.removeClass([f[0]],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.hidePopup())),!r.ctrlKey||89!==r.keyCode&&90!==r.keyCode||"Markdown"!==this.parent.editorMode&&this.undoStack({subCommand:90===r.keyCode?"undo":"redo"}),8===r.keyCode||46===r.keyCode)&&(u&&u[0]&&"IMG"===u[0].nodeName&&u.length<1&&(t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(o=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument())),r.preventDefault(),v={selectNode:u,selection:o,selectParent:f,args:{item:{command:"Images",subCommand:"Remove"},originalEvent:r}},this.deleteImg(v,r.keyCode)),this.parent.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle());switch("Backspace"===r.code&&(r.action="backspace"),r.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":"Markdown"!==this.parent.editorMode&&(3===i.startContainer.nodeType?"Backspace"===r.code?i.startContainer.previousElementSibling&&0===i.startOffset&&i.startContainer.previousElementSibling.classList.contains(ui)&&i.startContainer.previousElementSibling.classList.contains(se)&&t.detach(i.startContainer.previousElementSibling):i.startContainer.nextElementSibling&&i.endContainer.textContent.length===i.endOffset&&i.startContainer.nextElementSibling.classList.contains(ui)&&i.startContainer.nextElementSibling.classList.contains(se)&&t.detach(i.startContainer.nextElementSibling):1===i.startContainer.nodeType&&(i.startContainer.querySelector("."+ui+"."+se)?t.detach(i.startContainer.querySelector("."+ui+"."+se)):i.startContainer.querySelector("."+ui+"."+ri)?t.detach(i.startContainer.querySelector("."+ui+"."+ri)):i.startContainer.classList.contains("e-img-wrap")&&t.closest(i.startContainer,"."+ui)&&(h=i.startContainer.parentElement.parentElement,(t.detach(t.closest(i.startContainer,"."+ui)),h&&""===h.textContent.trim())&&(l=this.parent.createElement("br"),l.classList.add("e-rte-image-remove-focus"),h.appendChild(l)))));break;case"insert-image":t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(o=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()));this.openDialog(!0,r,o,u,f);r.preventDefault()}r.ctrlKey&&"a"===r.key&&this.handleSelectAll()},n.prototype.handleSelectAll=function(){this.cancelResizeAction();var n=this.parent.inputElement.querySelectorAll("."+rh);t.removeClass(n,rh)},n.prototype.openDialog=function(n,i,r,u,f){var e,o,s,h;n||t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)?(o=r,s=u,h=f):(e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(e),h=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e));"HTML"===this.parent.editorMode?this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:i,name:n?null:"showDialog"},selectNode:s,selection:o,selectParent:h}):this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:i,name:n?null:"showDialog"},member:"image",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertImage"})},n.prototype.showDialog=function(n){t.isNullOrUndefined(n.originalEvent)?this.openDialog(!1):this.openDialog(!1,n.originalEvent);this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.onKeyUp=function(){var n,i;if(!t.isNullOrUndefined(this.deletedImg)&&this.deletedImg.length>0)for(n=Array.from(this.deletedImg).length-1;n>=0;n--)i={element:this.deletedImg[n],src:this.deletedImg[n].getAttribute("src")},this.parent.trigger(sl,i),this.deletedImg.splice(n,1)},n.prototype.checkImageBack=function(n){"#text"!==n.startContainer.nodeName||0!==n.startOffset||t.isNullOrUndefined(n.startContainer.previousSibling)||"IMG"!==n.startContainer.previousSibling.nodeName?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])||"IMG"!==n.startContainer.childNodes[n.startOffset-1].nodeName||this.deletedImg.push(n.startContainer.childNodes[n.startOffset-1]):this.deletedImg.push(n.startContainer.previousSibling)},n.prototype.checkImageDel=function(n){"#text"!==n.startContainer.nodeName||n.startOffset!==n.startContainer.textContent.length||t.isNullOrUndefined(n.startContainer.nextSibling)||"IMG"!==n.startContainer.nextSibling.nodeName?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])||"IMG"!==n.startContainer.childNodes[n.startOffset].nodeName||this.deletedImg.push(n.startContainer.childNodes[n.startOffset]):this.deletedImg.push(n.startContainer.nextSibling)},n.prototype.alignmentSelect=function(n){var u=n.item;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Images"===u.command){var f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),i=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(f),r={args:n,selectNode:i="IMG"===i[0].nodeName?i:[this.imgEle]};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),u.subCommand){case"JustifyLeft":case"JustifyCenter":case"JustifyRight":this.alignImage(r);break;case"Inline":this.inline(r);break;case"Break":this.break(r)}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.removeClass([i[0]],"e-img-focus"));this.cancelResizeAction()}},n.prototype.showImageQuickToolbar=function(n){var r=this,i,u;"Images"!==n.type&&"Replace"!==n.type||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.imageQTBar)||t.isNullOrUndefined(n.args)||(this.quickToolObj=this.parent.quickToolbarModule,i=n.elements,[].forEach.call(n.elements,function(n,t){0===t&&(i=n)}),u=this.quickToolObj.imageQTBar.quickTBarObj.toolbarObj.element,t.isNullOrUndefined(u.querySelector(".e-insert-link"))||(i.closest("a")?u.classList.add("e-link-enabled"):u.classList.contains("e-link-enabled")&&u.classList.remove("e-link-enabled")),"IMG"===i.nodeName&&t.addClass([i],["e-img-focus"]),this.parent.quickToolbarModule.imageQTBar&&(n.isNotify?this.imageQTPopupTime=setTimeout(function(){r.parent.formatter.editorManager.nodeSelection.Clear(r.contentModule.getDocument());r.parent.formatter.editorManager.nodeSelection.setSelectionContents(r.contentModule.getDocument(),i);r.quickToolObj.imageQTBar.showPopup(i,n.args);!0===r.parent.insertImageSettings.resize&&r.resizeStart(n.args,i)},"true"===this.parent.element.dataset.rteUnitTesting?0:400):this.quickToolObj.imageQTBar.showPopup(i,n.args)))},n.prototype.hideImageQuickToolbar=function(){t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-img-focus"))||(t.removeClass([this.contentModule.getEditPanel().querySelector(".e-img-focus")],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup())},n.prototype.editAreaClickHandler=function(n){var i,r,u;this.parent.readonly?this.hideImageQuickToolbar():(i=n.args,r=this.parent.quickToolbarSettings.showOnRightClick,2===i.which||r&&1===i.which||!r&&3===i.which?r&&1===i.which&&!t.isNullOrUndefined(i.target)&&"IMG"===i.target.tagName&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),i.target)):"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.imageQTBar&&(this.quickToolObj=this.parent.quickToolbarModule,u=i.target,this.contentModule=this.rendererFactory.getRenderer(o.Content),"IMG"===u.nodeName&&this.parent.quickToolbarModule?(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),u),s()&&this.parent.notify(ft,n),t.addClass([u],"e-img-focus"),this.showImageQuickToolbar({args:i,type:"Images",elements:[i.target]})):this.hideImageQuickToolbar()))},n.prototype.insertImgLink=function(n,i){var e=this;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),!t.isNullOrUndefined(this.dialogObj))){var r=this.parent.createElement("div",{className:"e-img-linkwrap"+this.parent.getCssClass(!0)}),o=this.i10n.getConstant("linkurl"),s=vr('<div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" class="e-input e-img-link'+this.parent.getCssClass(!0)+'" spellcheck="false" placeholder="'+o+'"/><\/div><div class="e-rte-label"><\/div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget'+this.parent.getCssClass(!0)+'"  data-role ="none"><\/div>');r.appendChild(s);var h=r.querySelector(".e-rte-linkTarget"),u=r.querySelector(".e-img-link"),c=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new rr.CheckBox({label:c,checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),change:function(n){f=n.checked?"_blank":null}});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(h);var f="_blank",l=this.i10n.getConstant("imageLinkAriaLabel"),a=this.i10n.getConstant("dialogUpdate"),v={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,selectParent:n.selectParent,link:u,target:f,ariaLabel:l};this.dialogObj.setProperties({width:"290px",header:this.parent.localeObj.getConstant("imageInsertLinkHeader"),content:r,buttons:[{click:function(){e.insertlink(v)},buttonModel:{content:a,cssClass:"e-flat e-update-link"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-link-dialog"});t.isNullOrUndefined(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass});t.isNullOrUndefined(i)||(u.value=i.url,this.checkBoxObj.checked=!!i.target,this.dialogObj.header=i.header);this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAltText=function(n){var o=this,r,f,e;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),r=this.i10n.getConstant("altText"),!t.isNullOrUndefined(this.dialogObj))){var i=this.parent.createElement("div",{className:"e-img-altwrap"+this.parent.getCssClass(!0)}),s=this.i10n.getConstant("alternateHeader"),h=this.i10n.getConstant("dialogUpdate"),c=null===n.selectNode[0].getAttribute("alt")?"":n.selectNode[0].getAttribute("alt"),u=vr('<div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" spellcheck="false"  class="e-input e-img-alt'+this.parent.getCssClass(!0)+'" placeholder="'+r+'"/><\/div>');u.querySelector("input").setAttribute("value",c);i.appendChild(u);f=i.querySelector(".e-img-alt");e={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,alt:f};this.dialogObj.setProperties({width:"290px",header:s,content:i,buttons:[{click:function(){o.insertAlt(e)},buttonModel:{content:h,cssClass:"e-flat e-update-alt"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-alt-dialog"});t.isNullOrUndefined(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAlt=function(n){if(!t.isNullOrUndefined(n.alt)){n.selection.restore();0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var i=n.alt.value;this.parent.formatter.process(this.parent,n.args,n.args,{altText:i,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.dialogObj.hide({returnValue:!1});this.parent.iframeSettings.enable?this.parent.inputElement.focus({preventScroll:!0}):n.selectNode[0].focus({preventScroll:!0});n.selection.restore()}},n.prototype.handleKeyDown=function(){var n=this.parent.element.querySelector("#"+this.rteID+"_image_dialog-content").querySelector(".e-img-link");n.classList.contains("e-error")&&n.value.length>=1&&" "!==n.value.trim()&&t.removeClass([n],"e-error")},n.prototype.insertlink=function(n){var r,i,u,f;if("IMG"===n.selectNode[0].nodeName){if(r=n.link.value,""===r.trim())return t.addClass([n.link],"e-error"),n.link.setSelectionRange(0,r.length),n.link.focus(),void t.EventHandler.add(n.link,"input",this.handleKeyDown,this);if(t.EventHandler.remove(n.link,"input",this.handleKeyDown),t.removeClass([n.link],"e-error"),this.isUrl(r)?t.removeClass([n.link],"e-error"):this.parent.enableAutoUrl||(r=r.indexOf("http")>-1?r:"http://"+r),i=n.selfImage,"HTML"===i.parent.editorMode&&n.selection.restore(),0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),"A"===n.selectNode[0].parentElement.nodeName)return i.parent.formatter.process(i.parent,n.args,n.args,{url:r,target:i.checkBoxObj.checked?"_blank":null,ariaLabel:i.checkBoxObj.checked?this.i10n.getConstant("imageLinkAriaLabel"):null,selectNode:n.selectNode,subCommand:n.args.item.subCommand}),void i.dialogObj.hide({returnValue:!0});i.parent.formatter.process(i.parent,n.args,n.args,{url:r,target:i.checkBoxObj.checked?"_blank":null,ariaLabel:i.checkBoxObj.checked?this.i10n.getConstant("imageLinkAriaLabel"):null,selectNode:n.selectNode,subCommand:n.args.item.subCommand,selection:n.selection});u=t.closest(n.selectNode[0],".e-img-caption");u&&(f=t.select("."+lb,u),u&&f.focus());i.dialogObj.hide({returnValue:!1})}},n.prototype.isUrl=function(n){return new RegExp("(ftp|http|https)://(\\w+:{0,1}\\w*@)?(\\S+)(:[0-9]+)?(/|/([\\w#!:.?+=&%@\\-\\/]))?","gi").test(n)},n.prototype.deleteImg=function(n,i){var e,r,f,u;if("IMG"===n.selectNode[0].nodeName){if(e={element:n.selectNode[0],src:n.selectNode[0].getAttribute("src")},0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),r=n.selection.range.startContainer,"SPAN"===n.selection.range.startContainer.nodeName&&r.classList.contains("e-img-wrap")&&r.parentElement.classList.contains("e-img-caption"))if(r=r.parentElement,t.isNullOrUndefined(r.previousSibling)){if(!t.isNullOrUndefined(r.nextSibling)){for(f=r.nextSibling;"#text"!==f.nodeName&&"BR"!==f.nodeName;)f=f.firstChild;this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),f,0)}}else{for(u=r.previousSibling;"#text"!==u.nodeName&&"BR"!==u.nodeName;)u=u.lastChild;this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),u,"BR"!==u.nodeName?u.textContent.length:0)}else n.selection.restore();this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle();this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,captionClass:ui,subCommand:n.args.item.subCommand});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup();this.cancelResizeAction();t.isNullOrUndefined(i)&&this.parent.trigger(sl,e)}},n.prototype.caption=function(n){var i=n.selectNode[0],u,o;if("IMG"===i.nodeName){if(n.selection.restore(),0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.cancelResizeAction(),t.addClass([i],"e-rte-image"),u=n.args.item?n.args.item.subCommand:"Caption",t.isNullOrUndefined(t.closest(i,"."+ui))){this.captionEle=this.parent.createElement("span",{className:ui+" "+ag+this.parent.getCssClass(!0),attrs:{contenteditable:"false",draggable:"false",style:"width:"+this.parent.insertImageSettings.width}});var e=this.parent.createElement("span",{className:"e-img-wrap"+this.parent.getCssClass(!0)}),r=this.parent.createElement("span",{className:"e-img-inner"+this.parent.getCssClass(!0),attrs:{contenteditable:"true"}}),f=n.selectNode[0].parentElement;"A"===f.tagName&&f.setAttribute("contenteditable","true");e.appendChild("A"===f.tagName?f:n.selectNode[0]);e.appendChild(r);o=this.i10n.getConstant("imageCaption");r.innerHTML=o;this.captionEle.appendChild(e);i.classList.contains(gi)&&t.addClass([this.captionEle],se);i.classList.contains(ri)&&t.addClass([this.captionEle],ri);i.classList.contains(ub)&&t.addClass([this.captionEle],ub);i.classList.contains(rb)&&t.addClass([this.captionEle],rb);i.classList.contains(fb)&&t.addClass([this.captionEle],fb);this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:this.captionEle,selectNode:n.selectNode,subCommand:u});this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),r.childNodes[0],r.childNodes[0],0,r.childNodes[0].textContent.length)}else t.detach(t.closest(i,"."+ui)),t.Browser.isIE&&(this.contentModule.getEditPanel().focus(),n.selection.restore()),"A"===i.parentElement.tagName?this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:i.parentElement,selectNode:n.selectNode,subCommand:u}):this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:i,selectNode:n.selectNode,subCommand:u});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.removeClass([i],"e-img-focus"))}},n.prototype.imageSize=function(n){var e=this,i,r,u,f;"IMG"!==n.selectNode[0].nodeName||(this.imagDialog(n),t.isNullOrUndefined(this.dialogObj))||(i=this.i10n.getConstant("imageSizeHeader"),r=this.i10n.getConstant("dialogUpdate"),this.changedHeightValue=null,this.changedWidthValue=null,u=this.imgsizeInput(n),f={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode},this.dialogObj.setProperties({width:"290px",header:i,content:u,buttons:[{click:function(){e.insertSize(f)},buttonModel:{content:r,cssClass:"e-flat e-update-size"+this.parent.getCssClass(!0),isPrimary:!0}}],cssClass:this.dialogObj.cssClass+" e-rte-img-size-dialog"}),t.isNullOrUndefined(this.parent.cssClass)||this.dialogObj.setProperties({cssClass:this.parent.cssClass}),this.dialogObj.element.style.maxHeight="inherit",this.dialogObj.content.querySelector("input").focus())},n.prototype.break=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item.subCommand;this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.inline=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item.subCommand;this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.alignImage=function(n){var t=n.args.item.subCommand;this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})},n.prototype.clearDialogObj=function(){this.uploadObj&&!this.uploadObj.isDestroyed&&(this.uploadObj.destroy(),t.detach(this.uploadObj.element),this.uploadObj=null);this.checkBoxObj&&!this.checkBoxObj.isDestroyed&&(this.checkBoxObj.destroy(),t.detach(this.checkBoxObj.element),this.checkBoxObj=null);this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),t.detach(this.popupObj.element),this.popupObj=null);this.widthNum&&!this.widthNum.isDestroyed&&(this.widthNum.destroy(),t.detach(this.widthNum.element),this.widthNum=null);this.heightNum&&!this.heightNum.isDestroyed&&(this.heightNum.destroy(),t.detach(this.heightNum.element),this.heightNum=null);this.browseButton&&!this.browseButton.isDestroyed&&(this.browseButton.destroy(),t.detach(this.browseButton.element),this.browseButton=null);this.dialogObj&&!this.dialogObj.isDestroyed&&(this.dialogObj.element&&this.dialogObj.element.querySelector(".e-img-link")&&null!==this.dialogObj.element.querySelector(".e-img-link")&&t.EventHandler.remove(this.dialogObj.element.querySelector(".e-img-link"),"input",this.handleKeyDown),this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.imagDialog=function(n){var i=this,f,e,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{f=this.parent.createElement("div",{className:"e-rte-img-dialog"+this.parent.getCssClass(!0),id:this.rteID+"_image"});this.parent.rootContainer.appendChild(f);var s=this.i10n.getConstant("dialogInsert"),h=this.i10n.getConstant("dialogCancel"),c=this.i10n.getConstant("imageHeader"),l=n.selection,a={selfImage:this,selection:n.selection,args:n.args,selectParent:n.selectParent},r={header:c,cssClass:pt+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",isModal:t.Browser.isDevice,position:{X:"center",Y:t.Browser.isDevice?"center":"top"},buttons:[{click:this.insertImageUrl.bind(a),buttonModel:{content:s,cssClass:"e-flat e-insertImage"+this.parent.getCssClass(!0),isPrimary:!0,disabled:"Markdown"!==this.parent.editorMode}},{click:this.cancelDialog.bind(this),buttonModel:{cssClass:"e-flat e-cancel"+this.parent.getCssClass(!0),content:h}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){n&&"user action"!==n.closedBy&&i.uploadObj&&i.uploadObj.filesData.length>0&&i.uploadObj.remove();i.parent.isBlur=!1;n&&!t.isNullOrUndefined(n.event)&&n.event.returnValue&&("HTML"===i.parent.editorMode?l.restore():i.parent.formatter.editorManager.markdownSelection.restore(i.parent.contentModule.getEditPanel()));i.clearDialogObj();i.dialogRenderObj.close(n)}},u=this.parent.createElement("div",{className:"e-img-content"+this.parent.getCssClass(!0)});(t.isNullOrUndefined(this.parent.insertImageSettings.path)||"Markdown"!==this.parent.editorMode)&&"HTML"!==this.parent.editorMode||u.appendChild(this.imgUpload(n));e=this.parent.createElement("div",{className:"e-linkheader"+this.parent.getCssClass(!0)});o=this.i10n.getConstant("imageLinkHeader");e.innerHTML="HTML"===this.parent.editorMode?o:this.i10n.getConstant("mdimageLink");u.appendChild(e);u.appendChild(this.imageUrlPopup(n));n.selectNode&&"IMG"===n.selectNode[0].nodeName?(r.header=this.parent.localeObj.getConstant("editImageHeader"),r.content=u,r.buttons[0].buttonModel.cssClass=r.buttons[0].buttonModel.cssClass+" e-updateImage"):r.content=u;this.dialogObj=this.dialogRenderObj.render(r);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(f);t.isNullOrUndefined(this.dialogObj)||(n.selectNode&&"IMG"===n.selectNode[0].nodeName&&"insertImage"===n.name&&(this.dialogObj.element.querySelector(".e-insertImage").textContent=this.parent.localeObj.getConstant("dialogUpdate")),f.style.maxHeight="inherit",this.quickToolObj&&(this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.isNullOrUndefined(n.selectParent)||t.removeClass([n.selectParent[0]],"e-img-focus")),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup()))}},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;!t.isNullOrUndefined(this.uploadObj)&&this.uploadObj.filesData.length>0&&this.uploadObj.remove();this.dialogObj.hide({returnValue:!0})},n.prototype.onDocumentClick=function(n){var i=n.target,u,r;if(!t.isNullOrUndefined(this.contentModule.getEditPanel())&&("IMG"===i.nodeName&&(this.imgEle=i),this.parent)){if("#document"!==i.nodeName&&(this.parent.currentTarget=n.target),!t.isNullOrUndefined(this.dialogObj)&&(!t.closest(i,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(n.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)&&!t.closest(i,"#"+this.parent.getID()+"_toolbar_Image")&&!i.querySelector("#"+this.parent.getID()+"_toolbar_Image"))&&(n.offsetX>n.target.clientWidth||n.offsetY>n.target.clientHeight||(this.parent.notify(nu,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,eu(this.parent.element,"focusout"))),this.parent.iframeSettings.enable&&!t.isNullOrUndefined(this.parent.currentTarget)&&"IMG"===this.parent.currentTarget.nodeName||"IMG"===n.target.tagName||!this.imgResizeDiv||this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.element.contains(n.target)||!this.contentModule.getEditPanel().contains(this.imgResizeDiv)||this.cancelResizeAction(),!this.contentModule.getEditPanel().querySelector(".e-img-resize")||this.parent.iframeSettings.enable&&"IMG"===this.parent.currentTarget.nodeName||("IMG"!==i.tagName&&this.removeResizeEle(),"IMG"===i.tagName||t.isNullOrUndefined(this.imgEle)?t.isNullOrUndefined(this.prevSelectedImgEle)||this.prevSelectedImgEle===i||(this.prevSelectedImgEle.style.outline=""):this.imgEle.style.outline=""),"IMG"!==i.tagName)for(u=this.contentModule.getEditPanel().querySelectorAll("img"),r=0;r<u.length;r++)t.removeClass([u[r]],"e-img-focus"),t.removeClass([u[r]],"e-resize");this.parent.inlineMode.enable&&i&&this.dialogObj&&!t.closest(i,"#"+this.dialogObj.element.id)&&this.dialogObj.hide()}},n.prototype.removeResizeEle=function(){t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);t.detach(this.contentModule.getEditPanel().querySelector(".e-img-resize"))},n.prototype.onWindowResize=function(){t.isNullOrUndefined(this.contentModule)||t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-img-resize"))||this.cancelResizeAction()},n.prototype.imageUrlPopup=function(n){var i=this,r=this.parent.createElement("div",{className:"imgUrl"+this.parent.getCssClass(!0)}),f=this.i10n.getConstant("imageUrl"),u;return(this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url"+this.parent.getCssClass(!0),attrs:{placeholder:f,spellcheck:"false","aria-label":this.i10n.getConstant("imageLinkHeader")}}),this.inputUrl.addEventListener("input",function(){t.isNullOrUndefined(i.inputUrl)||(0===i.inputUrl.value.length?i.dialogObj.getButtons(0).element.disabled=!0:i.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),n.selectNode&&"IMG"===n.selectNode[0].nodeName)&&(u=new RegExp(/([^\S]|^)(((https?:\/\/)|(www\.))(\S+))/gi),this.inputUrl.value=n.selectNode[0].src.match(u)?n.selectNode[0].src:""),r.appendChild(this.inputUrl),r},n.prototype.insertImageUrl=function(n){var i=this.selfImage,r,f,e,u;if(i.isImgUploaded=!1,r=i.inputUrl.value,n.target&&"BUTTON"===n.target.nodeName&&n.target.classList.contains("e-updateImage")&&(f={element:this.selectNode&&this.selectNode[0]&&"IMG"===this.selectNode[0].nodeName?this.selectNode[0]:null,src:r},i.parent.trigger(sl,f)),"Markdown"===i.parent.editorMode&&""===r&&(r="http://"),0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),e=this.args.item.subCommand,this.args.item.subCommand="Update"===n.target.innerHTML?"Replace":this.args.item.subCommand,t.isNullOrUndefined(i.uploadUrl)||""===i.uploadUrl.url){if(""!==r){"HTML"===i.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selection.range.startContainer.parentNode,"[id='"+i.contentModule.getPanel().id+"']"))&&("IFRAME"===i.contentModule.getPanel().tagName&&"Replace"===this.args.item.subCommand?i.contentModule.getPanel():i.contentModule.getEditPanel(),u=i.parent.formatter.editorManager.nodeSelection.getRange(i.contentModule.getDocument()),this.selection=i.parent.formatter.editorManager.nodeSelection.save(u,i.contentModule.getDocument()),this.selectParent=i.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(u));var o=/[\w-]+.(jpg|png|jpeg|gif)/g,s=t.isNullOrUndefined(r.match(o))||"HTML"!==i.parent.editorMode?"":r.match(o)[0],h={cssClass:this.selectParent&&this.selectParent[0].classList&&!0===this.selectParent[0].classList.contains("e-imgbreak")?ri:"inline"===i.parent.insertImageSettings.display?gi:ri,url:r,selection:this.selection,altText:s,selectParent:this.selectParent,width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}};if(i.dialogObj.hide({returnValue:!1}),null!==i.dialogObj)return;i.parent.formatter.process(i.parent,this.args,this.args.originalEvent,h)}}else{if(i.uploadUrl.cssClass=this.selectParent&&this.selectParent[0].classList&&!0===this.selectParent[0].classList.contains("e-imgbreak")?ri:"inline"===i.parent.insertImageSettings.display?gi:ri,i.dialogObj.hide({returnValue:!1}),null!==i.dialogObj)return;i.parent.formatter.process(i.parent,this.args,this.args.originalEvent,i.uploadUrl);i.uploadUrl.url="";i.contentModule.getEditPanel().querySelector(".e-img-resize")&&(i.imgEle.style.outline="",i.removeResizeEle())}this.args.item.subCommand=e},n.prototype.imgsizeInput=function(n){var r=this,i=n.selectNode[0],s=this.i10n.getConstant("imageHeight"),h=this.i10n.getConstant("imageWidth"),u=this.parent.createElement("div",{className:"e-img-sizewrap"+this.parent.getCssClass(!0)}),f=!t.isNullOrUndefined(this.changedWidthValue)||"auto"!==i.style.width.toString()&&""===i.style.width?t.isNullOrUndefined(this.changedWidthValue)?parseInt(i.getClientRects()[0].width.toString(),10).toString():this.changedWidthValue:i.style.width,e=!t.isNullOrUndefined(this.changedHeightValue)||"auto"!==i.style.height.toString()&&""===i.style.height?t.isNullOrUndefined(this.changedHeightValue)?parseInt(i.getClientRects()[0].height.toString(),10).toString():this.changedHeightValue:i.style.height,o;return""===i.style.width&&""===f&&(f="auto"),""===i.style.height&&""===e&&(e="auto"),this.changedWidthValue=null,this.changedHeightValue=null,o=vr('<div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+h+'<\/label><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" id="imgwidth" class="e-img-width'+this.parent.getCssClass(!0)+'"/><\/div><div class="e-rte-label'+this.parent.getCssClass(!0)+'"><label>'+s+'<\/label><\/div><div class="e-rte-field'+this.parent.getCssClass(!0)+'"> <input type="text" id="imgheight" class="e-img-height'+this.parent.getCssClass(!0)+'"/><\/div>'),o.getElementById("imgwidth").setAttribute("value",f),o.getElementById("imgheight").setAttribute("value",e),u.appendChild(o),this.widthNum=new ot.TextBox({value:t.formatUnit(f),enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),input:function(n){r.inputWidthValue=t.formatUnit(r.inputValue(n.value))}}),this.widthNum.createElement=this.parent.createElement,this.widthNum.appendTo(u.querySelector("#imgwidth")),this.heightNum=new ot.TextBox({value:t.formatUnit(e),enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),input:function(n){r.inputHeightValue=t.formatUnit(r.inputValue(n.value))}}),this.heightNum.createElement=this.parent.createElement,this.heightNum.appendTo(u.querySelector("#imgheight")),u},n.prototype.inputValue=function(n){return"auto"===n||-1!==n.indexOf("%")||-1!==n.indexOf("px")||n.match(/(\d+)/)?n:"auto"},n.prototype.insertSize=function(n){var t,i,r,u;n.selection.restore();t=n.selfImage;0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData();i=t.dialogObj.element;this.changedWidthValue=this.inputWidthValue;this.changedHeightValue=this.inputHeightValue;r=i.querySelector(".e-img-width").value;u=i.parentElement.querySelector(".e-img-height").value;t.parent.formatter.process(this.parent,n.args,n.args,{width:r,height:u,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.imgResizeDiv&&t.imgResizePos(n.selectNode[0],this.imgResizeDiv);t.dialogObj.hide({returnValue:!0});t.parent.inputElement.focus({preventScroll:!0})},n.prototype.insertImage=function(n){if(this.imagDialog(n),!t.isNullOrUndefined(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var i=this.dialogObj.element.querySelector(".e-img-content");!t.isNullOrUndefined(this.parent.insertImageSettings.path)&&"Markdown"===this.parent.editorMode||"HTML"===this.parent.editorMode?document.getElementById(this.rteID+"_insertImage").focus():i.querySelector(".e-img-url").focus()}},n.prototype.imgUpload=function(n){var e,o,r=this,i=this,v=i.parent.iframeSettings.enable,h,s,y,p,l,w,a,u;"HTML"===i.parent.editorMode&&(!v&&t.isNullOrUndefined(t.closest(n.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||v&&!et(n.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))?(this.contentModule.getEditPanel().focus(),h=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.save(h,this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(h)):(e=n.selection,o=n.selectParent);var c=this.parent.createElement("div",{className:"e-img-uploadwrap e-droparea"+this.parent.getCssClass(!0)}),b=this.i10n.getConstant("imageDeviceUploadMessage"),k=this.i10n.getConstant("imageUploadMessage"),f=this.parent.createElement("span",{className:"e-droptext"+this.parent.getCssClass(!0)}),d=this.parent.createElement("span",{className:"e-rte-upload-text"+this.parent.getCssClass(!0),innerHTML:t.Browser.isDevice?b:k});return f.appendChild(d),s=this.parent.createElement("button",{className:"e-browsebtn"+this.parent.getCssClass(!0),id:this.rteID+"_insertImage",attrs:{autofocus:"true",type:"button"}}),f.appendChild(s),c.appendChild(f),y=this.i10n.getConstant("browse"),this.browseButton=new rr.Button({content:y,enableRtl:this.parent.enableRtl}),this.browseButton.isStringTemplate=!0,this.browseButton.createElement=this.parent.createElement,this.browseButton.appendTo(s),p=t.Browser.isDevice?f:s,t.EventHandler.add(p,"click",this.fileSelect,this),a=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"},className:this.parent.getCssClass()}),c.appendChild(a),u=null,this.uploadObj=new ot.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},dropArea:f,multiple:!1,enableRtl:this.parent.enableRtl,cssClass:this.parent.getCssClass(),allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),maxFileSize:this.parent.insertImageSettings.maxFileSize,selected:function(n){i.isImgUploaded=!0;w=n;n.filesData;r.parent.trigger(kd,w,function(n){if(!n.cancel){if(t.isNullOrUndefined(n.filesData[0]))return;if(r.checkExtension(n.filesData[0]),l=n.filesData[0].name.replace(/\.[a-zA-Z0-9]+$/,""),"HTML"===r.parent.editorMode&&t.isNullOrUndefined(r.parent.insertImageSettings.path)){var u=new FileReader;u.addEventListener("load",function(){var s="Base64"===r.parent.insertImageSettings.saveFormat?u.result:URL.createObjectURL(kr(u.result)),f;(i.uploadUrl={url:s,selection:e,altText:l,selectParent:o,width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}},i.inputUrl.setAttribute("disabled","true"),t.isNullOrUndefined(r.dialogObj))||(f=r.dialogObj.getButtons(0),t.isNullOrUndefined(f)||(t.isNullOrUndefined(i.parent.insertImageSettings.saveUrl)&&r.isAllowedTypes&&n.filesData[0].size<=r.uploadObj.maxFileSize?f.element.removeAttribute("disabled"):f.element.setAttribute("disabled","true")))});u.readAsDataURL(n.filesData[0].rawFile)}}})},beforeUpload:function(n){r.parent.trigger(hl,n)},uploading:function(n){r.parent.isServerRendered||r.parent.trigger(il,n)},success:function(n){n.detectImageSource=ge.Uploaded;r.parent.trigger(rl,n,function(n){var f=!1,s;(t.isNullOrUndefined(u)||u.name===n.file.name||"remove"!==n.operation.toLocaleLowerCase()||(f=!0),t.isNullOrUndefined(r.parent.insertImageSettings.path)||f)||(s=r.parent.insertImageSettings.path+n.file.name,t.isNullOrUndefined(u)||"upload"!==n.operation||r.uploadObj.remove(u),i.uploadUrl={url:s,selection:e,altText:l,selectParent:o,width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}},n&&n.operation&&"REMOVE"!==n.operation.toLocaleUpperCase()&&i.inputUrl.setAttribute("disabled","true"),u=n.file);"upload"!==n.operation||t.isNullOrUndefined(r.dialogObj)||r.dialogObj.getButtons(0).element.removeAttribute("disabled")})},failure:function(n){r.parent.trigger(ul,n)},removing:function(n){r.parent.trigger(ew,n,function(){i.isImgUploaded=!1;r.dialogObj.getButtons(0).element.disabled=!0;i.inputUrl.removeAttribute("disabled");i.uploadUrl&&(i.uploadUrl.url="")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(a),c},n.prototype.checkExtension=function(n){this.uploadObj.allowedExtensions&&n.type&&(-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+n.type).toLocaleLowerCase())?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},n.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},n.prototype.dragStart=function(n){if("IMG"!==n.target.nodeName)return!0;n.dataTransfer.effectAllowed="copyMove";n.target.classList.add(ke)},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragOver=function(n){if(!("edge"===t.Browser.info.name&&n.dataTransfer.items[0].type.split("/")[0].indexOf("image")>-1||t.Browser.isIE&&"Files"===n.dataTransfer.types[0]))return!0;n.preventDefault()},n.prototype.dragDrop=function(n){var i=this;this.parent.trigger(dd,n,function(n){var u=i.parent.inputElement.ownerDocument.querySelector("."+ke),f=u&&"IMG"===u.tagName||n.dataTransfer.files.length>0,r;if(!n.cancel&&f){if(t.closest(n.target,"#"+i.parent.getID()+"_toolbar")||"false"===i.parent.inputElement.contentEditable)return void n.preventDefault();if(i.parent.element.querySelector("."+bn)&&t.detach(i.imgResizeDiv),n.preventDefault(),r=void 0,i.contentModule.getDocument().caretRangeFromPoint?r=i.contentModule.getDocument().caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent?(r=i.contentModule.getDocument().createRange()).setStart(n.rangeParent,n.rangeOffset):r=i.getDropRange(n.clientX,n.clientY),i.parent.notify(au,{range:r}),i.parent.element.querySelector("."+la))return;i.insertDragImage(n)}else f&&n.preventDefault()})},n.prototype.getDropRange=function(n,t){var i=this.contentModule.getDocument().createRange(),e;this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var f=this.contentModule.getDocument().elementFromPoint(n,t),u=f.childNodes.length>0?f.childNodes[0]:f,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)i.setStart(u,r),i.setEnd(u,r);else{e=void 0;do r++,i.setStart(u,r),i.setEnd(u,r+1),e=i.getBoundingClientRect();while(e.left<n&&r<u.length-1)}return i},n.prototype.insertDragImage=function(n){var r=this,u,i,f;if(n.preventDefault(),u=this.parent.element.querySelector(""+wu),this.parent.notify(te,{args:n}),u&&u.classList.add(pu),i=this.parent.inputElement.ownerDocument.querySelector("."+ke),f={requestType:"Images",name:"ImageDragAndDrop",cancel:!1,originalEvent:n},n.dataTransfer.files.length>0&&null===i){if(n.dataTransfer.files.length>1)return;for(var o=n.dataTransfer.files,s=o[0].name,c=s.substring(s.lastIndexOf(".")),h=this.parent.insertImageSettings.allowedTypes,e=0;e<h.length;e++)c.toLocaleLowerCase()===h[e].toLowerCase()&&(this.parent.insertImageSettings.saveUrl?this.onSelect(n):this.parent.trigger(l,f,function(t){if(t.cancel)t.originalEvent.preventDefault();else{var i={args:n,text:"",file:o[0]};n.preventDefault();r.imagePaste(i)}}))}else this.parent.trigger(l,f,function(u){var e,o,f,s,h;u.cancel?u.originalEvent.preventDefault():(e=r.parent.formatter.editorManager.nodeSelection.getRange(r.parent.contentModule.getDocument()),i&&"IMG"===i.tagName&&(o=i.closest(".e-rte-img-caption"),t.isNullOrUndefined(o)?(f=i.closest("a"),f&&"A"===f.tagName&&r.hasOnlyImage(f)?e.insertNode(f):i.parentNode&&(i.parentNode.removeChild(i),e.insertNode(i))):e.insertNode(o),i.classList.remove(ke),s={elements:[i]},i.addEventListener("load",function(){r.parent.trigger(ct,s)}),r.parent.formatter.editorManager.nodeSelection.Clear(r.contentModule.getDocument()),h=n,r.parent.insertImageSettings.resize&&r.resizeStart(h,i),r.hideImageQuickToolbar()))})},n.prototype.hasOnlyImage=function(n){for(var t,i=!1,r=0;r<n.childNodes.length;r++)if(t=n.childNodes[r],t.nodeType===Node.TEXT_NODE){if(""!==t.textContent.replace(/[\u200B\u200C\u200D]/g,"").trim())return!1}else if(t.nodeType===Node.ELEMENT_NODE){if("IMG"!==t.tagName||i)return!1;i=!0}return i},n.prototype.onSelect=function(n){var f=this,h=this,e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.createElement("ul",{className:dn}),s,i,r,u;this.parent.rootContainer.appendChild(o);s={name:n.dataTransfer.files[0].name,size:n.dataTransfer.files[0].size,status:"",statusCode:"",type:n.dataTransfer.files[0].type,rawFile:n.dataTransfer.files[0],validationMessages:{}};i=this.parent.createElement("IMG");i.style.opacity="0.5";i.classList.add(bs);i.classList.add(gi);i.classList.add(gv);r=s.rawFile;u=new FileReader;u.addEventListener("load",function(){var n=URL.createObjectURL(kr(u.result));i.src="Blob"===h.parent.insertImageSettings.saveFormat?n:u.result});r&&u.readAsDataURL(r);var c=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),a={cssClass:"inline"===this.parent.insertImageSettings.display?gi:ri,url:this.parent.insertImageSettings.path+r.name,selection:c,altText:r.name.replace(/\.[a-zA-Z0-9]+$/,""),width:{width:this.parent.insertImageSettings.width,minWidth:this.parent.insertImageSettings.minWidth,maxWidth:this.parent.getInsertImgMaxWidth()},height:{height:this.parent.insertImageSettings.height,minHeight:this.parent.insertImageSettings.minHeight,maxHeight:this.parent.insertImageSettings.maxHeight}},v={requestType:"Image",name:"ImageDragAndDrop",cancel:!1,originalEvent:n,itemCollection:a};this.parent.trigger(l,v,function(i){if(i.cancel)i.originalEvent.preventDefault();else{var u=i.itemCollection,r=t.createElement("img",{className:u.cssClass,attrs:{src:u.url,alt:u.altText}});r.style.opacity="0.5";r.classList.add(bs);r.classList.add(gi);r.classList.add(gv);e.insertNode(r);f.uploadMethod(n,r);r.addEventListener("load",function(n){var t={requestType:"Image",name:"InsertDropImage",elements:[r],event:n,editorMode:"HTML"};f.parent.trigger(ct,t)});t.detach(o)}})},n.prototype.uploadMethod=function(n,t){var u=this,i,r;this.popupObj=this.popupUploaderObj.renderPopup("Images",t);i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());r=n.dataTransfer.files[0].size>1e6?300:100;this.imageDragPopupTime=setTimeout(function(){u.popupUploaderObj.refreshPopup(t)},r);this.uploadObj=this.popupUploaderObj.createUploader("Images",n,t,this.popupObj.element.childNodes[0]);this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none";i.selectNodeContents(t);this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i)},n.prototype.imagePaste=function(n){var u=this,i,r;0!==n.text.length||t.isNullOrUndefined(n.file)||(i=this,r=new FileReader,n.args.preventDefault(),r.addEventListener("load",function(){var f={cssClass:"inline"===i.parent.insertImageSettings.display?gi:ri,url:"Base64"!==u.parent.insertImageSettings.saveFormat&&t.isNullOrUndefined(n.callBack)?URL.createObjectURL(kr(r.result)):r.result,width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}};t.isNullOrUndefined(n.callBack)?(i.parent.formatter.process(i.parent,{item:{command:"Images",subCommand:"Image"}},n.args,f),u.showPopupToolBar(n,f)):n.callBack(f)}),r.readAsDataURL(n.file))},n.prototype.showPopupToolBar=function(n,t){var i=this,f='img[src="'+t.url+'"]',r=this.parent.inputElement.querySelector(f),u;this.parent.quickToolbarModule.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,o.ImageToolbar);u={args:n.args,type:"Images",isNotify:void 0,elements:r};r&&(this.showImageQTbarTime=setTimeout(function(){i.showImageQuickToolbar(u);i.parent.insertImageSettings.resize&&i.resizeStart(n.args,r)},0))},n.prototype.destroy=function(){this.isDestroyed||(this.prevSelectedImgEle=void 0,t.isNullOrUndefined(this.imageQTPopupTime)||(clearTimeout(this.imageQTPopupTime),this.imageQTPopupTime=null),t.isNullOrUndefined(this.imageDragPopupTime)||(clearTimeout(this.imageDragPopupTime),this.imageDragPopupTime=null),t.isNullOrUndefined(this.uploadCancelTime)||(clearTimeout(this.uploadCancelTime),this.uploadCancelTime=null),t.isNullOrUndefined(this.uploadFailureTime)||(clearTimeout(this.uploadFailureTime),this.uploadFailureTime=null),t.isNullOrUndefined(this.showImageQTbarTime)||(clearTimeout(this.showImageQTbarTime),this.showImageQTbarTime=null),t.isNullOrUndefined(this.uploadSuccessTime)||(clearTimeout(this.uploadSuccessTime),this.uploadSuccessTime=null),this.removeEventListener(),this.clearDialogObj(),this.cancelResizeAction(),this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"image"},n}(),frt=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(uy,this.audioCommand,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(uy,this.audioCommand);this.parent.observer.off(f,this.destroy)},n.prototype.audioCommand=function(n){var i,r,u=n.value.toString().toLowerCase();switch("inline"!==u&&"break"!==u&&"audioremove"!==u||(r=(i=n.item.selectNode[0]).closest("."+hp)),u){case"audio":case"audioreplace":this.createAudio(n);break;case"inline":i.removeAttribute("class");r.style.display="inline-block";t.addClass([i],[sp,bk,gk]);this.callBack(n);break;case"break":i.removeAttribute("class");r.style.display="block";t.addClass([i],[nrt,sp,gk]);this.callBack(n);break;case"audioremove":r?t.detach(r):t.detach(i);this.callBack(n)}},n.prototype.createAudio=function(n){var r,i=this,u=!1,o,e,f;if(!t.isNullOrUndefined(n.item.selectParent)&&n.item.selectParent[0].classList&&(n.item.selectParent[0].classList.contains(kk)||n.item.selectParent[0].classList.contains(hp)||"AUDIO"===n.item.selectParent[0].tagName))o=n.item.selectParent[0].querySelector("source"),this.setStyle(o,n),u=!0;else{r=t.createElement("span",{className:hp,attrs:{contentEditable:"false",title:t.isNullOrUndefined(n.item.title)?t.isNullOrUndefined(n.item.fileName)?"":n.item.fileName:n.item.title}});var s=t.createElement("audio",{className:sp+" "+bk,attrs:{controls:""}}),h=t.createElement("source"),c=t.createElement("span",{className:kk});if(this.setStyle(h,n),s.appendChild(h),c.appendChild(s),r.appendChild(c),t.isNullOrUndefined(n.item.selection)||n.item.selection.restore(),kt.Insert(this.parent.currentDocument,r,this.parent.editableElement),!t.isNullOrUndefined(n.item.selection)){var l=n.item.selection.getRange(this.parent.currentDocument),a=document.createTextNode(" "),v=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0];r.parentNode.insertBefore(a,v.nextSibling);n.item.selection.save(l,this.parent.currentDocument)}}n.callBack&&(t.isNullOrUndefined(n.selector)||!t.isNullOrUndefined(n.selector)&&"pasteCleanupModule"!==n.selector)&&(e=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],f="AudioReplace"===n.value||u?"audio"===n.item.selectParent[0].tagName.toLowerCase()?n.item.selectParent[0]:n.item.selectParent[0].querySelector("audio"):t.Browser.isIE?e:e.querySelector("audio"),f.addEventListener("loadeddata",function(){"AudioReplace"===n.value&&u||t.isNullOrUndefined(i.parent.currentDocument)||(i.parent.userAgentData.isSafari()&&hr(i.parent.currentDocument,i.parent.editableElement),n.callBack({requestType:"Audios",editorMode:"HTML",event:n.event,range:i.parent.nodeSelection.getRange(i.parent.currentDocument),elements:[f]}))}),u&&f.load())},n.prototype.setStyle=function(n,i){t.isNullOrUndefined(i.item.url)||n.setAttribute("src",i.item.url);var r=i.item.fileName?i.item.fileName.split(".").pop().toLowerCase():i.item.url?i.item.url.split(".").pop().toLowerCase():"";n.type="opus"===r?"audio/ogg":"m4a"===r?"audio/mp4":i.item.fileName&&i.item.fileName.split(".").length>0?"audio/"+i.item.fileName.split(".")[i.item.fileName.split(".").length-1]:i.item.url&&i.item.url.split(".").length>0?"audio/"+i.item.url.split(".")[i.item.url.split(".").length-1]:""},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n}(),est=function(){function n(n,t){this.isAudioUploaded=!1;this.isAllowedTypes=!0;this.deletedAudio=[];this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.popupUploaderObj=t.getService("popupUploaderObject");this.addEventListener();this.docClick=this.onDocumentClick.bind(this);this.isDestroyed=!1}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.drop||(this.drop=this.dragDrop.bind(this)),this.drag||(this.drag=this.dragOver.bind(this)),this.enter||(this.enter=this.dragEnter.bind(this)),this.parent.on(y,this.onKeyDown,this),this.parent.on(tt,this.onKeyUp,this),this.parent.on(yo,this.insertingAudio,this),this.parent.on(a,this.afterRender,this),this.parent.on(er,this.afterRender,this),this.parent.on(rs,this.showDialog,this),this.parent.on(yl,this.closeDialog,this),this.parent.on(rc,this.onToolbarAction,this),this.parent.on(ci,this.alignmentSelect,this),this.parent.on(cc,this.deleteAudio,this),this.parent.on(vt,this.editAreaClickHandler,this),this.parent.on(ii,this.showAudioQuickToolbar,this),this.parent.on(u,this.destroy,this),this.parent.on(ut,this.closeDialog,this),this.parent.on(b,this.bindOnEnd,this))},n.prototype.removeEventListener=function(){this.parent.off(y,this.onKeyDown);this.parent.off(tt,this.onKeyUp);this.parent.off(yo,this.insertingAudio);this.parent.off(a,this.afterRender);this.parent.off(er,this.afterRender);this.parent.off(rs,this.showDialog);this.parent.off(yl,this.closeDialog);this.parent.off(b,this.bindOnEnd);this.parent.off(rc,this.onToolbarAction);this.parent.off(ci,this.alignmentSelect);this.parent.off(cc,this.deleteAudio);this.parent.off(vt,this.editAreaClickHandler);this.parent.off(ii,this.showAudioQuickToolbar);this.parent.off(u,this.destroy);this.parent.off(ut,this.closeDialog);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.removeEventListener("drop",this.drop,!0);n.removeEventListener("dragenter",this.enter,!0);n.removeEventListener("dragover",this.drag,!0);t.isNullOrUndefined(this.contentModule)||(t.EventHandler.remove(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.touchStart),t.EventHandler.remove(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.audioClick),this.parent.element.ownerDocument.removeEventListener("mousedown",this.docClick),this.docClick=null)},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager.audioObj||(this.parent.formatter.editorManager.audioObj=new frt(this.parent.formatter.editorManager))},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.addEventListener("drop",this.drop,!0);n.addEventListener("dragenter",this.enter,!0);n.addEventListener("dragover",this.drag,!0);t.EventHandler.add(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.touchStart,this);t.EventHandler.add(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.audioClick,this);this.parent.element.ownerDocument.addEventListener("mousedown",this.docClick)},n.prototype.checkAudioBack=function(n){"#text"===n.startContainer.nodeName&&0===n.startOffset&&!t.isNullOrUndefined(n.startContainer.previousSibling)&&this.isAudioElem(n.startContainer.previousSibling)?this.deletedAudio.push(n.startContainer.previousSibling):"#text"!==n.startContainer.nodeName&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])&&this.isAudioElem(n.startContainer.childNodes[n.startOffset-1])&&this.deletedAudio.push(n.startContainer.childNodes[n.startOffset-1])},n.prototype.checkAudioDel=function(n){"#text"!==n.startContainer.nodeName||n.startOffset!==n.startContainer.textContent.length||t.isNullOrUndefined(n.startContainer.nextSibling)||"AUDIO"!==n.startContainer.nextSibling.nodeName?"#text"!==n.startContainer.nodeName&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])&&this.isAudioElem(n.startContainer.childNodes[n.startOffset])&&this.deletedAudio.push(n.startContainer.childNodes[n.startOffset]):this.deletedAudio.push(n.startContainer.nextSibling)},n.prototype.undoStack=function(n){var t,i,r;if(("undo"===n.subCommand.toLowerCase()||"redo"===n.subCommand.toLowerCase())&&"HTML"===this.parent.editorMode)for(t=0;t<this.parent.formatter.getUndoRedoStack().length;t++)i=this.parent.createElement("div"),r=this.parent.formatter.getUndoRedoStack()[t].text,i.appendChild(r.cloneNode(!0))},n.prototype.touchStart=function(){this.parent.readonly||(this.prevSelectedAudEle=this.audEle)},n.prototype.onToolbarAction=function(n){switch(s()&&this.parent.notify(lt,{}),n.args.item.subCommand){case"AudioReplace":this.parent.notify(yo,n);break;case"AudioRemove":this.parent.notify(cc,n)}},n.prototype.onKeyUp=function(){var n;if(!t.isNullOrUndefined(this.deletedAudio)&&this.deletedAudio.length>0)for(n=0;n<this.deletedAudio.length;n++){var i=this.deletedAudio[n],r="SOURCE"===i.tagName?i:i.querySelector("source"),u={element:this.deletedAudio[n].querySelector("audio"),src:r.getAttribute("src")};this.parent.trigger(bo,u)}},n.prototype.onKeyDown=function(n){var i,s,u,e,l,r=n.args,h,f,c,o,a,v;if(this.deletedAudio=[],"HTML"===this.parent.editorMode&&(l=(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).startContainer===i.endContainer&&i.startOffset===i.endOffset),!l&&"HTML"===this.parent.editorMode&&[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183].indexOf(r.which)<0)for(h=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),f=0;f<h.length;f++)this.isAudioElem(h[f])&&this.deletedAudio.push(h[f]);"HTML"===this.parent.editorMode&&(8===r.which&&"Backspace"===r.code||46===r.which&&"Delete"===r.code)&&(c=i.startContainer===i.endContainer&&i.startOffset===i.endOffset,8===r.which&&"Backspace"===r.code&&c?this.checkAudioBack(i):46===r.which&&"Delete"===r.code&&c&&this.checkAudioDel(i));!t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)&&"KeyK"!==r.code&&(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),!r.ctrlKey&&r.key&&(1===r.key.length||"enter"===r.action)&&this.isAudioElem(e[0])&&e[0].parentElement)&&(o=e[0].parentElement.childNodes[0],this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),o,o,o.textContent.length,o.textContent.length),t.removeClass([e[0]],oi),this.quickToolObj.audioQTBar.hidePopup());(!r.ctrlKey||89!==r.keyCode&&90!==r.keyCode||this.undoStack({subCommand:90===r.keyCode?"undo":"redo"}),(8===r.keyCode||46===r.keyCode)&&u&&(this.isAudioElem(u[0])||46===r.keyCode&&u[0].nextSibling&&this.isAudioElem(u[0].nextSibling)||8===r.keyCode&&u[0].previousSibling&&this.isAudioElem(u[0].previousSibling))&&u.length<=2&&"#text"!==u[0].nodeName)&&(t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(s=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument())),r.preventDefault(),a={selectNode:u,selection:s,selectParent:e,args:{item:{command:"Audios",subCommand:"AudioRemove"},originalEvent:r}},this.deleteAudio(a,r.keyCode));switch(r.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":for(f=0;f<this.deletedAudio.length;f++)v=this.deletedAudio[f].src,this.audioRemovePost(v);"Markdown"!==this.parent.editorMode&&(3===i.startContainer.nodeType?"Backspace"===r.code?i.startContainer.previousElementSibling&&0===i.startOffset&&i.startContainer.previousElementSibling.classList.contains(sr)&&t.detach(i.startContainer.previousElementSibling):i.startContainer.nextElementSibling&&i.endContainer.textContent.length===i.endOffset&&i.startContainer.nextElementSibling.classList.contains(sr)&&t.detach(i.startContainer.nextElementSibling):1===i.startContainer.nodeType&&i.startContainer.classList&&(i.startContainer.classList.contains(sr)||i.startContainer.classList.contains(cr)||i.startContainer.classList.contains(oe))&&t.detach(i.startContainer));break;case"insert-audio":t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(s=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()));this.openDialog(!0,r,s,u,e);r.preventDefault()}r.ctrlKey&&"a"===r.key&&this.handleSelectAll()},n.prototype.handleSelectAll=function(){var n=this.parent.inputElement.querySelectorAll("."+oi);t.removeClass(n,oi)},n.prototype.openDialog=function(n,i,r,u,f){var e,o,s,h;n||t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)?(o=r,s=u,h=f):(e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(e),h=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e));"HTML"===this.parent.editorMode&&this.insertAudio({args:{item:{command:"Audios",subCommand:"Audio"},originalEvent:i,name:n?null:"showDialog"},selectNode:s,selection:o,selectParent:h})},n.prototype.showDialog=function(n){t.isNullOrUndefined(n.originalEvent)?this.openDialog(!1):this.openDialog(!1,n.originalEvent)},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.deleteAudio=function(n,i){if(this.isAudioElem(n.selectNode[0])){this.audEle&&(3===n.selectNode[0].nodeType?n.selectNode[0]=this.audEle:this.isAudioElem(n.selectNode[0])&&(n.selectNode[0]=n.selectNode[0].classList.contains(sr)?n.selectNode[0]:n.selectNode[0].parentElement));var r={element:n.selectNode[0].querySelector("audio"),src:n.selectNode[0].querySelector("source").getAttribute("src")};0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();n.selection.restore();this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.audioRemovePost(r.src);this.quickToolObj&&document.body.contains(this.quickToolObj.audioQTBar.element)&&this.quickToolObj.audioQTBar.hidePopup();t.isNullOrUndefined(i)&&this.parent.trigger(bo,r)}},n.prototype.audioRemovePost=function(n){var u=this,r="",i;t.isNullOrUndefined(this.parent.insertAudioSettings.removeUrl)||""===this.parent.insertAudioSettings.removeUrl||(r=n.indexOf("http://")>-1||n.indexOf("https://")>-1?n:new URL(n,document.baseURI).href,this.removingAudioName=r.replace(/^.*[\\/]/,""),i=new XMLHttpRequest,i.addEventListener("readystatechange",function(){4===this.readyState&&200===this.status&&u.triggerPost(this.response)}),i.open("GET",r),i.responseType="blob",i.send())},n.prototype.triggerPost=function(n){var i=this.parent.insertAudioSettings.removeUrl;if(!t.isNullOrUndefined(i)&&""!==i){var u=new File([n],this.removingAudioName),f=new t.Ajax(i,"POST",!0,null),r=new FormData;r.append("UploadFiles",u);f.send(r)}},n.prototype.audioClick=function(n){t.Browser.isDevice&&(this.isAudioElem(n.target)?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),n.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true"));this.isAudioElem(n.target)&&!this.parent.userAgentData.isSafari()&&(this.audEle=n.target.querySelector("audio"),n.preventDefault())},n.prototype.onDocumentClick=function(n){var i=n.target;t.isNullOrUndefined(this.contentModule.getEditPanel())||(this.isAudioElem(i)&&(this.audEle=i.querySelector("audio")),!t.isNullOrUndefined(this.dialogObj)&&(!t.closest(i,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(n.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)&&!t.closest(i,"#"+this.parent.getID()+"_toolbar_Audio")&&!i.querySelector("#"+this.parent.getID()+"_toolbar_Audio"))&&(n.offsetX>n.target.clientWidth||n.offsetY>n.target.clientHeight||(this.parent.notify(nu,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,eu(this.parent.element,"focusout"))),this.isAudioElem(i)||(t.isNullOrUndefined(this.audEle)||""===this.audEle.style.outline?t.isNullOrUndefined(this.prevSelectedAudEle)||""===this.prevSelectedAudEle.style.outline||(this.prevSelectedAudEle.style.outline=""):this.audEle.style.outline=""),this.parent.inlineMode.enable&&i&&this.dialogObj&&!t.closest(i,"#"+this.dialogObj.element.id)&&this.dialogObj.hide())},n.prototype.alignmentSelect=function(n){var u=n.item,f,i,r;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Audios"===u.command){f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());i=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(f);this.audEle&&(i=[this.audEle]);r={args:n,selectNode:i};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),u.subCommand){case"Inline":this.inline(r);break;case"Break":this.break(r)}this.quickToolObj&&document.body.contains(this.quickToolObj.audioQTBar.element)&&(this.quickToolObj.audioQTBar.hidePopup(),t.removeClass([i[0]],oi))}},n.prototype.break=function(n){if("AUDIO"===n.selectNode[0].nodeName){var t=n.args.item&&n.args.item.subCommand?n.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:t})}},n.prototype.inline=function(n){if("AUDIO"===n.selectNode[0].nodeName){var t=n.args.item&&n.args.item.subCommand?n.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:t})}},n.prototype.editAreaClickHandler=function(n){if(this.parent.readonly)this.hideAudioQuickToolbar();else{var r=n.args,i=r.target,u=this.parent.quickToolbarSettings.showOnRightClick;if(2===r.which||u&&1===r.which||!u&&3===r.which)return u&&1===r.which&&!t.isNullOrUndefined(i)&&this.isAudioElem(i)&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),i)),void(this.isAudioElem(i)&&i.querySelector("audio")&&(i.querySelector("audio").style.outline="2px solid #4a90e2"));"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.audioQTBar&&(this.quickToolObj=this.parent.quickToolbarModule,this.contentModule=this.rendererFactory.getRenderer(o.Content),this.isAudioElem(i)&&this.parent.quickToolbarModule?(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),i),s()&&this.parent.notify(ft,n),this.showAudioQuickToolbar({args:r,type:"Audios",elements:[r.target]})):this.hideAudioQuickToolbar())}},n.prototype.isAudioElem=function(n){return!!(n&&3!==n.nodeType&&"BR"!==n.nodeName&&n.classList&&(n.classList.contains(sr)||n.classList.contains("e-rte-audio")||n.classList.contains(cr)))},n.prototype.showAudioQuickToolbar=function(n){var r=this,i,u;"Audios"!==n.type||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.audioQTBar)||t.isNullOrUndefined(n.args)||(this.quickToolObj=this.parent.quickToolbarModule,i=n.elements,([].forEach.call(n.elements,function(n,t){0===t&&(i=n)}),this.isAudioElem(i))&&(u="AUDIO"===i.tagName?i:i.querySelector("audio"),t.addClass([u],[oi]),u.style.outline="2px solid #4a90e2",this.audEle=u),this.parent.quickToolbarModule.audioQTBar&&(n.isNotify?this.showPopupTime=setTimeout(function(){r.parent.formatter.editorManager.nodeSelection.Clear(r.contentModule.getDocument());r.parent.formatter.editorManager.nodeSelection.setSelectionContents(r.contentModule.getDocument(),i);r.quickToolObj.audioQTBar.showPopup(i,n.args)},"true"===this.parent.element.dataset.rteUnitTesting?0:400):this.quickToolObj.audioQTBar.showPopup(i,n.args)))},n.prototype.hideAudioQuickToolbar=function(){t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector("."+oi))||(t.removeClass([this.contentModule.getEditPanel().querySelector("."+oi)],oi),t.isNullOrUndefined(this.audEle)||(this.audEle.style.outline=""),this.quickToolObj&&this.quickToolObj.audioQTBar&&document.body.contains(this.quickToolObj.audioQTBar.element)&&this.quickToolObj.audioQTBar.hidePopup())},n.prototype.insertingAudio=function(n){if(this.insertAudio(n),!t.isNullOrUndefined(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var i=this.dialogObj.element.querySelector(".e-audio-content");t.isNullOrUndefined(this.parent.insertAudioSettings.path)&&"HTML"!==this.parent.editorMode?i.querySelector(".e-audio-url").focus():document.getElementById(this.rteID+"_insertAudio").focus()}},n.prototype.clearDialogObj=function(){this.uploadObj&&!this.uploadObj.isDestroyed&&(this.uploadObj.destroy(),t.detach(this.uploadObj.element),this.uploadObj=null);this.button&&!this.button.isDestroyed&&(this.button.destroy(),t.detach(this.button.element),this.button=null);this.dialogObj&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.insertAudio=function(n){var i=this,u,e,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{u=this.parent.createElement("div",{className:"e-rte-audio-dialog",id:this.rteID+"_audio"});this.parent.rootContainer.appendChild(u);var s=this.i10n.getConstant("dialogInsert"),h=this.i10n.getConstant("dialogCancel"),c=this.i10n.getConstant("audioHeader"),l=n.selection,a={selfAudio:this,selection:n.selection,args:n.args,selectParent:n.selectParent},f={header:c,cssClass:pt,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",isModal:t.Browser.isDevice,position:{X:"center",Y:t.Browser.isDevice?"center":"top"},buttons:[{click:this.insertAudioUrl.bind(a),buttonModel:{content:s,cssClass:"e-flat e-insertAudio",isPrimary:!0,disabled:!0}},{click:function(n){i.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:h}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){i.isAudioUploaded&&(i.dialogObj.element.querySelector(".e-file-abort-btn")?i.dialogObj.element.querySelector(".e-file-abort-btn").click():i.uploadObj.remove());i.parent.isBlur=!1;n&&!t.isNullOrUndefined(n.event)&&n.event.returnValue&&"HTML"===i.parent.editorMode&&l.restore();i.clearDialogObj();i.dialogRenderObj.close(n)}},r=this.parent.createElement("div",{className:"e-audio-content"});t.isNullOrUndefined(this.parent.insertAudioSettings.path)&&"HTML"!==this.parent.editorMode||r.appendChild(this.audioUpload(n));e=this.parent.createElement("div",{className:"e-audioheader"});o=this.i10n.getConstant("audioLinkHeader");"HTML"===this.parent.editorMode&&(e.innerHTML=o);r.appendChild(e);r.appendChild(this.audioUrlPopup(n));n.selectNode&&1===n.selectNode[0].nodeType&&this.isAudioElem(n.selectNode[0])?(f.header=this.parent.localeObj.getConstant("editAudioHeader"),f.content=r):f.content=r;this.dialogObj=this.dialogRenderObj.render(f);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(u);n.selectNode&&1===n.selectNode[0].nodeType&&this.isAudioElem(n.selectNode[0])&&"insertAudio"===n.name&&(this.dialogObj.element.querySelector(".e-insertAudio").textContent=this.parent.localeObj.getConstant("dialogUpdate"));u.style.maxHeight="inherit";this.quickToolObj&&(this.quickToolObj.audioQTBar&&document.body.contains(this.quickToolObj.audioQTBar.element)&&this.quickToolObj.audioQTBar.hidePopup(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup())}},n.prototype.audioUrlPopup=function(n){var i=this,u=this.parent.createElement("div",{className:"audioUrl"}),e=this.i10n.getConstant("audioUrl"),f,r;return(this.inputUrl=this.parent.createElement("input",{className:"e-input e-audio-url",attrs:{placeholder:e,spellcheck:"false","aria-label":this.i10n.getConstant("audioLinkHeader")}}),this.inputUrl.addEventListener("input",function(){t.isNullOrUndefined(i.inputUrl)||(0===i.inputUrl.value.length?i.dialogObj.getButtons(0).element.disabled=!0:i.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),n.selectNode&&this.isAudioElem(n.selectNode[0]))&&(f=new RegExp(/([^\S]|^)(((https?:\/\/)|(www\.))(\S+))/gi),r=n.selectNode[0].querySelector("source"),this.inputUrl.value=r.src.match(f)?r.src:""),u.appendChild(this.inputUrl),u},n.prototype.audioUpload=function(n){var f,e,i=this,r=this,a=r.parent.iframeSettings.enable,s,o,v,y,c,p,l;"HTML"===r.parent.editorMode&&(!a&&t.isNullOrUndefined(t.closest(n.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||a&&!et(n.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))?(this.contentModule.getEditPanel().focus(),s=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.save(s,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(s)):(f=n.selection,e=n.selectParent);var h=this.parent.createElement("div",{className:"e-aud-uploadwrap e-droparea"}),w=this.i10n.getConstant("audioDeviceUploadMessage"),b=this.i10n.getConstant("audioUploadMessage"),u=this.parent.createElement("span",{className:"e-droptext"}),k=this.parent.createElement("span",{className:"e-rte-upload-text",innerHTML:t.Browser.isDevice?w:b});return u.appendChild(k),o=this.parent.createElement("button",{className:"e-browsebtn",id:this.rteID+"_insertAudio",attrs:{autofocus:"true",type:"button"}}),u.appendChild(o),h.appendChild(u),v=this.i10n.getConstant("browse"),this.button=new rr.Button({content:v,enableRtl:this.parent.enableRtl}),this.button.isStringTemplate=!0,this.button.createElement=this.parent.createElement,this.button.appendTo(o),y=t.Browser.isDevice?u:o,t.EventHandler.add(y,"click",this.fileSelect,this),l=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),h.appendChild(l),this.uploadObj=new ot.Uploader({asyncSettings:{saveUrl:this.parent.insertAudioSettings.saveUrl,removeUrl:this.parent.insertAudioSettings.removeUrl},dropArea:u,multiple:!1,enableRtl:this.parent.enableRtl,allowedExtensions:this.parent.insertAudioSettings.allowedTypes.toString(),maxFileSize:this.parent.insertAudioSettings.maxFileSize,selected:function(n){r.isAudioUploaded=!0;p=n;i.parent.trigger(ow,p,function(n){if(!n.cancel){if(t.isNullOrUndefined(n.filesData[0]))return;if(i.checkExtension(n.filesData[0]),c=n.filesData[0].name,"HTML"===i.parent.editorMode&&t.isNullOrUndefined(i.parent.insertAudioSettings.path)){var u=new FileReader;u.addEventListener("load",function(){var n="Base64"===i.parent.insertAudioSettings.saveFormat?u.result:URL.createObjectURL(kr(u.result));r.uploadUrl={url:n,selection:f,fileName:c,selectParent:e};r.inputUrl.setAttribute("disabled","true");t.isNullOrUndefined(r.parent.insertAudioSettings.saveUrl)&&i.isAllowedTypes&&!t.isNullOrUndefined(i.dialogObj)&&i.dialogObj.getButtons(0).element.removeAttribute("disabled")});u.readAsDataURL(n.filesData[0].rawFile)}}})},beforeUpload:function(n){i.parent.trigger(cl,n)},uploading:function(n){i.parent.isServerRendered||i.parent.trigger(fl,n)},success:function(n){i.parent.trigger(el,n,function(n){if(!t.isNullOrUndefined(i.parent.insertAudioSettings.path)){var u=i.parent.insertAudioSettings.path+n.file.name;r.uploadUrl={url:u,selection:f,fileName:c,selectParent:e};r.inputUrl.setAttribute("disabled","true")}"upload"!==n.operation||t.isNullOrUndefined(i.dialogObj)||i.dialogObj.getButtons(0).element.removeAttribute("disabled")})},failure:function(n){i.parent.trigger(ol,n)},removing:function(){i.parent.trigger(sw,n,function(){r.isAudioUploaded=!1;i.dialogObj.getButtons(0).element.disabled=!0;r.inputUrl.removeAttribute("disabled");r.uploadUrl&&(r.uploadUrl.url="")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(l),h},n.prototype.checkExtension=function(n){this.uploadObj.allowedExtensions&&(-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+n.type).toLocaleLowerCase())?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},n.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragOver=function(n){if(!("edge"===t.Browser.info.name&&n.dataTransfer.items[0].type.split("/")[0].indexOf("audio")>-1||t.Browser.isIE&&"Files"===n.dataTransfer.types[0]))return!0;n.preventDefault()},n.prototype.dragDrop=function(n){var i=this;this.parent.trigger(hw,n,function(n){var u=n.dataTransfer.files.length>0,r;if(!n.cancel&&u){if(t.closest(n.target,"#"+i.parent.getID()+"_toolbar")||"false"===i.parent.inputElement.contentEditable)return void n.preventDefault();if(n.preventDefault(),r=void 0,i.contentModule.getDocument().caretRangeFromPoint?r=i.contentModule.getDocument().caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent?(r=i.contentModule.getDocument().createRange()).setStart(n.rangeParent,n.rangeOffset):r=i.getDropRange(n.clientX,n.clientY),i.parent.notify(au,{range:r}),i.parent.element.querySelector("."+la))return;i.insertDragAudio(n)}else u&&n.preventDefault()})},n.prototype.getDropRange=function(n,t){var i=this.contentModule.getDocument().createRange(),e;this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var f=this.contentModule.getDocument().elementFromPoint(n,t),u=f.childNodes.length>0?f.childNodes[0]:f,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)i.setStart(u,r),i.setEnd(u,r);else{e=void 0;do r++,i.setStart(u,r),i.setEnd(u,r+1),e=i.getBoundingClientRect();while(e.left<n&&r<u.length-1)}return i},n.prototype.insertDragAudio=function(n){var o=this,t,r;if(n.preventDefault(),t=this.parent.element.querySelector(""+wu),this.parent.notify(te,{args:n}),t&&t.classList.add(pu),r={requestType:"Audios",name:"AudioDragAndDrop",cancel:!1,originalEvent:n},n.dataTransfer.files.length>0){if(n.dataTransfer.files.length>1)return;for(var u=n.dataTransfer.files,f=u[0].name,s=f.substring(f.lastIndexOf(".")).toLowerCase(),e=this.parent.insertAudioSettings.allowedTypes,i=0;i<e.length;i++)s.toLowerCase()===e[i].toLowerCase()&&(this.parent.insertAudioSettings.saveUrl?this.onSelect(n):this.parent.trigger(l,r,function(t){if(t.cancel)t.originalEvent.preventDefault();else{var i={args:n,text:"",file:u[0]};n.preventDefault();o.audioPaste(i)}}))}},n.prototype.onSelect=function(n){var t=this,r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.save(r,this.parent.contentModule.getDocument()),i=n.dataTransfer.files[0],f={cssClass:"Inline"===this.parent.insertAudioSettings.layoutOption?he:ys,url:this.parent.insertAudioSettings.path+i.name,selection:u,fileName:i.name.replace(/\.[a-zA-Z0-9]+$/,"")},e={requestType:"Audios",name:"AudioDragAndDrop",cancel:!1,originalEvent:n,itemCollection:f};this.parent.trigger(l,e,function(i){if(i.cancel)i.originalEvent.preventDefault();else{t.parent.formatter.process(t.parent,{item:{command:"Audios",subCommand:"Audio"}},n,i.itemCollection);var r=t.parent.contentModule.getEditPanel().querySelector("audio:last-of-type");r&&(r.style.opacity="0.5",t.uploadMethod(n,r))}})},n.prototype.uploadMethod=function(n,t){var u=this,i,r;this.popupObj=this.popupUploaderObj.renderPopup("Audios",t);i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());r=n.dataTransfer.files[0].size>1e6?300:100;this.audioDragPopupTime=setTimeout(function(){u.popupUploaderObj.refreshPopup(t)},r);this.uploadObj=this.popupUploaderObj.createUploader("Audios",n,t,this.popupObj.element.childNodes[0]);this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none";i.selectNodeContents(t);this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i)},n.prototype.audioPaste=function(n){var u=this,r,i;0!==n.text.length||t.isNullOrUndefined(n.file)||(r=this,i=new FileReader,n.args.preventDefault(),i.addEventListener("load",function(){var e=n.file,o="Base64"!==u.parent.insertAudioSettings.saveFormat&&t.isNullOrUndefined(n.callBack)?URL.createObjectURL(kr(i.result)):i.result,f={cssClass:"Inline"===r.parent.insertAudioSettings.layoutOption?he:ys,url:o,fileName:e.name};t.isNullOrUndefined(n.callBack)?(r.parent.formatter.process(r.parent,{item:{command:"Audios",subCommand:"Audio"}},n.args,f),u.showPopupToolBar(n,f)):n.callBack(f)}),i.readAsDataURL(n.file))},n.prototype.showPopupToolBar=function(n,t){var u=this,f='audio[src="'+t.url+'"]',i=this.parent.inputElement.querySelector(f),r;this.parent.quickToolbarModule.createQTBar("Audio","MultiRow",this.parent.quickToolbarSettings.audio,o.AudioToolbar);r={args:n.args,type:"Audios",isNotify:void 0,elements:i};i&&(this.showAudioQTbarTime=setTimeout(function(){u.showAudioQuickToolbar(r)},0))},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0});this.isAudioUploaded&&this.uploadObj.removing()},n.prototype.insertAudioUrl=function(){var n=this.selfAudio,i,r,u,f;if(n.isAudioUploaded=!1,i=n.inputUrl.value,0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),t.isNullOrUndefined(n.uploadUrl)||""===n.uploadUrl.url){if(""!==i){if("HTML"===n.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selection.range.startContainer.parentNode,"[id='"+n.contentModule.getPanel().id+"']"))&&!n.parent.iframeSettings.enable&&(n.contentModule.getEditPanel().focus(),r=n.parent.formatter.editorManager.nodeSelection.getRange(n.contentModule.getDocument()),this.selection=n.parent.formatter.editorManager.nodeSelection.save(r,n.contentModule.getDocument()),this.selectParent=n.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(r)),u="HTML"===n.parent.editorMode?i.split("/")[i.split("/").length-1]:"",f={cssClass:"Inline"===n.parent.insertAudioSettings.layoutOption?he:ys,url:i,selection:this.selection,fileName:u,selectParent:this.selectParent},n.dialogObj.hide({returnValue:!1}),null!==n.dialogObj)return;n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,f)}}else{if(n.uploadUrl.cssClass="Inline"===n.parent.insertAudioSettings.layoutOption?he:ys,n.dialogObj.hide({returnValue:!1}),null!==n.dialogObj)return;n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,n.uploadUrl);n.uploadUrl.url=""}},n.prototype.destroy=function(){this.isDestroyed||(this.prevSelectedAudEle=void 0,this.showPopupTime&&(clearTimeout(this.showPopupTime),this.showPopupTime=null),this.removeEventListener(),this.clearDialogObj(),this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"audio"},n}(),ert=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(fy,this.videoCommand,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(fy,this.videoCommand);this.parent.observer.off(f,this.destroy)},n.prototype.videoCommand=function(n){var i,r,f,u="",e=n.value.toString().toLowerCase();switch("video"!==e&&"videoreplace"!==e&&(r=(i=n.item.selectNode[0]).closest("."+dk),f=i.closest("."+ch)),i&&(u=i.classList.contains("e-rte-embed-url")?"e-rte-embed-url":""),e){case"video":case"videoreplace":this.createVideo(n);break;case"videodimension":this.videoDimension(n);break;case"inline":i.removeAttribute("class");r&&(r.style.display="inline-block");f&&(i.parentElement.style.cssFloat="");t.addClass([i],[ti,ro,nd]);this.callBack(n);break;case"break":i.removeAttribute("class");r&&(r.style.display="block");f&&(i.parentElement.style.cssFloat="");t.addClass([i],[hh,ti,nd]);this.callBack(n);break;case"justifyleft":i.removeAttribute("class");r&&(r.style.display="block");f?i.parentElement.style.cssFloat="left":null!=i.parentElement.nextElementSibling?(t.addClass([i],""===u?[ti,io]:[ti,io,u]),i.parentElement.nextElementSibling.style.clear="left"):t.addClass([i],""===u?[ti,io]:[ti,io,u]);this.callBack(n);break;case"justifycenter":i.removeAttribute("class");r&&(r.style.display="block");f&&(i.parentElement.style.cssFloat="");t.addClass([i],""===u?[ti,pk]:[ti,pk,u]);this.callBack(n);break;case"justifyright":i.removeAttribute("class");r&&(r.style.display="block");f?i.parentElement.style.cssFloat="right":null!=i.parentElement.nextElementSibling?(t.addClass([i],""===u?[ti,ep]:[ti,io,u]),i.parentElement.nextElementSibling.style.clear="right"):t.addClass([i],""===u?[ti,ep]:[ti,ep,u]);this.callBack(n);break;case"videoremove":t.detach(i.parentElement);this.callBack(n)}},n.prototype.wrapVideo=function(n){var i,r,u,f;return n.item.isEmbedUrl?(i=t.createElement("span",{className:dk,attrs:{contentEditable:"false"}}),u=t.createElement("span",{className:ch}),f=t.createElement("template"),f.innerHTML=n.item.fileName,u.appendChild(f.content),this.vidElement=r=u.firstElementChild,this.setStyle(r,n,this.vidElement),i.style.display=n.item.cssClass===ro?"inline-block":"block",i.appendChild(u)):(i=t.createElement("span",{className:irt,attrs:{contentEditable:"false",title:t.isNullOrUndefined(n.item.title)?t.isNullOrUndefined(n.item.fileName)?"":n.item.fileName:n.item.title}}),this.vidElement=t.createElement("video",{className:ti+" "+ro,attrs:{controls:""}}),r=t.createElement("source"),this.setStyle(r,n,this.vidElement),this.vidElement.appendChild(r),i.appendChild(this.vidElement)),i},n.prototype.createVideo=function(n){var i,u=this,e=!1,s,o,h,r,f;if("VideoReplace"!==n.value||t.isNullOrUndefined(n.item.selectParent)||"VIDEO"!==n.item.selectParent[0].tagName)if("VideoReplace"===n.value&&!t.isNullOrUndefined(n.item.selectParent)&&t.isNullOrUndefined(n.item.selectParent[0].querySelector("iframe"))&&n.item.selectParent[0].classList&&n.item.selectParent[0].classList.contains(ch))n.item.selectParent[0].innerHTML=n.item.fileName,this.setStyle(n.item.selectParent[0].firstElementChild,n,n.item.selectParent[0].firstElementChild);else if("VideoReplace"!==n.value||t.isNullOrUndefined(n.item.selectParent)||t.isNullOrUndefined(n.item.selectParent[0].querySelector("iframe"))||n.item.isEmbedUrl){if(n.item.isEmbedUrl?i=this.wrapVideo(n):("VideoReplace"===n.value&&(s=n.item.selection.range.startContainer.closest(".e-embed-video-wrap"),t.isNullOrUndefined(s)||s.remove()),i=this.wrapVideo(n)),t.isNullOrUndefined(n.item.selection)||n.item.selection.restore(),kt.Insert(this.parent.currentDocument,i,this.parent.editableElement),!t.isNullOrUndefined(n.item.selection)){var c=n.item.selection.getRange(this.parent.currentDocument),l=document.createTextNode(" "),a=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0];i.parentNode.insertBefore(l,a.nextSibling);n.item.selection.save(c,this.parent.currentDocument)}}else i=this.wrapVideo(n),(o=n.item.selection.range.startContainer).parentNode.replaceChild(i,o);else n.item.isEmbedUrl?(i=this.wrapVideo(n),(o=n.item.selection.range.startContainer).parentNode.replaceChild(i,o)):(h=n.item.selectParent[0].querySelector("source"),this.setStyle(h,n,h),e=!0);n.callBack&&(t.isNullOrUndefined(n.selector)||!t.isNullOrUndefined(n.selector)&&"pasteCleanupModule"!==n.selector)&&(f=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],"VideoReplace"===n.value||e?n.item.isEmbedUrl?n.item.isEmbedUrl?t.isNullOrUndefined(i)||(r=i.querySelector("iframe")):r=n.item.selectParent[0].querySelector("iframe"):r=n.item.selectParent[0]:r=n.item.isEmbedUrl?f.querySelector("iframe"):"VIDEO"===f.tagName?f:f.lastElementChild,r.addEventListener("IFRAME"!==r.tagName?"loadeddata":"load",function(){"VideoReplace"===n.value&&e||(n.item.isEmbedUrl&&r&&r.classList.add("e-rte-embed-url"),t.isNullOrUndefined(u.parent.currentDocument)||(u.parent.userAgentData.isSafari()&&hr(u.parent.currentDocument,u.parent.editableElement),n.callBack({requestType:"Videos",editorMode:"HTML",event:n.event,range:u.parent.nodeSelection.getRange(u.parent.currentDocument),elements:[r]})))}),e&&r.load(),-1!==t.Browser.userAgent.indexOf("Firefox")&&(this.vidElement.addEventListener("play",function(){u.editAreaVideoClick(n)}),this.vidElement.addEventListener("pause",function(){u.editAreaVideoClick(n)})))},n.prototype.editAreaVideoClick=function(n){n.callBack({requestType:"VideosPlayPause",editorMode:"HTML",event:n.event})},n.prototype.setStyle=function(n,i,r){(""===i.item.url||t.isNullOrUndefined(i.item.url)||!t.isNullOrUndefined(n))&&n&&n.nodeName&&"iframe"!==n.nodeName.toLowerCase()&&n.setAttribute("src",i.item.url);i.item.isEmbedUrl||(n.type=i.item.fileName&&i.item.fileName.split(".").length>0?"video/"+i.item.fileName.split(".")[i.item.fileName.split(".").length-1]:i.item.url&&i.item.url.split(".").length>0?"video/"+i.item.url.split(".")[i.item.url.split(".").length-1]:"");t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.width)||r.setAttribute("width",t.formatUnit(i.item.width.width));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.height)||r.setAttribute("height",t.formatUnit(i.item.height.height));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.minWidth)||(r.style.minWidth=t.formatUnit(i.item.width.minWidth));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.maxWidth)||(r.style.maxWidth=t.formatUnit(i.item.width.maxWidth));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.minHeight)||(r.style.minHeight=t.formatUnit(i.item.height.minHeight));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.maxHeight)||(r.style.maxHeight=t.formatUnit(i.item.height.maxHeight));t.isNullOrUndefined(i.item.cssClass)||(i.item.cssClass===hh?(t.addClass([r],[hh]),t.removeClass([r],[ro])):(t.addClass([r],[ro]),t.removeClass([r],[hh])))},n.prototype.videoDimension=function(n){var i=n.item.selectNode[0].classList.contains(ch)?n.item.selectNode[0].querySelector("iframe"):n.item.selectNode[0];i.style.height="";i.style.width="";"auto"!==n.item.width&&(i.style.width=t.formatUnit(n.item.width));"auto"!==n.item.height&&(i.style.height=t.formatUnit(n.item.height));this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.destroy=function(){this.removeEventListener()},n}(),ost=function(){function n(n,t){this.isVideoUploaded=!1;this.isAllowedTypes=!0;this.pageX=null;this.pageY=null;this.mouseX=null;this.deletedVid=[];this.isResizeBind=!0;this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.popupUploaderObj=t.getService("popupUploaderObject");this.addEventListener();this.isDestroyed=!1;this.docClick=this.onDocumentClick.bind(this)}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.drop||(this.drop=this.dragDrop.bind(this)),this.drag||(this.drag=this.dragOver.bind(this)),this.enter||(this.enter=this.dragEnter.bind(this)),this.parent.on(y,this.onKeyDown,this),this.parent.on(tt,this.onKeyUp,this),this.parent.on(po,this.insertingVideo,this),this.parent.on(a,this.afterRender,this),this.parent.on(er,this.afterRender,this),this.parent.on(dr,this.onWindowResize,this),this.parent.on(us,this.showDialog,this),this.parent.on(pl,this.closeDialog,this),this.parent.on(ci,this.alignmentSelect,this),this.parent.on(lc,this.deleteVideo,this),this.parent.on(uc,this.onToolbarAction,this),this.parent.on(vt,this.editAreaClickHandler,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(yc,this.videoSize,this),this.parent.on(ii,this.showVideoQuickToolbar,this),this.parent.on(fr,this.clearDialogObj,this),this.parent.on(u,this.destroy,this),this.parent.on(b,this.bindOnEnd,this))},n.prototype.removeEventListener=function(){this.parent.off(y,this.onKeyDown);this.parent.off(tt,this.onKeyUp);this.parent.off(po,this.insertingVideo);this.parent.off(dr,this.onWindowResize);this.parent.off(a,this.afterRender);this.parent.off(er,this.afterRender);this.parent.off(us,this.showDialog);this.parent.off(pl,this.closeDialog);this.parent.off(ci,this.alignmentSelect);this.parent.off(lc,this.deleteVideo);this.parent.off(uc,this.onToolbarAction);this.parent.off(vt,this.editAreaClickHandler);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(yc,this.videoSize);this.parent.off(ii,this.showVideoQuickToolbar);this.parent.off(fr,this.clearDialogObj);this.parent.off(u,this.destroy);this.parent.off(b,this.bindOnEnd);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.removeEventListener("drop",this.drop,!0);n.removeEventListener("dragenter",this.enter,!0);n.removeEventListener("dragover",this.drag,!0);this.drop=null;this.drag=null;this.enter=null;t.isNullOrUndefined(this.contentModule)||(t.EventHandler.remove(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.videoClick),this.parent.formatter.editorManager.observer.off(gf,this.undoStack),this.parent.insertVideoSettings.resize&&(t.EventHandler.remove(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart),this.parent.element.ownerDocument.removeEventListener("mousedown",this.docClick),this.docClick=null,t.EventHandler.remove(this.contentModule.getEditPanel(),"cut",this.onCutHandler),t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing)))},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager.videoObj||(this.parent.formatter.editorManager.videoObj=new ert(this.parent.formatter.editorManager))},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content);t.EventHandler.add(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.videoClick,this);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.addEventListener("drop",this.drop,!0);n.addEventListener("dragenter",this.enter,!0);n.addEventListener("dragover",this.drag,!0);this.parent.insertVideoSettings.resize&&(t.EventHandler.add(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart,this),this.parent.element.ownerDocument.addEventListener("mousedown",this.docClick),t.EventHandler.add(this.contentModule.getEditPanel(),"cut",this.onCutHandler,this))},n.prototype.clearDialogObj=function(){this.uploadObj&&!this.uploadObj.isDestroyed&&(this.uploadObj.destroy(),t.detach(this.uploadObj.element),this.uploadObj=null);this.webUrlBtn&&!this.webUrlBtn.isDestroyed&&(this.webUrlBtn.destroy(),t.detach(this.webUrlBtn.element),this.webUrlBtn=null);this.embedUrlBtn&&!this.embedUrlBtn.isDestroyed&&(this.embedUrlBtn.destroy(),t.detach(this.embedUrlBtn.element),this.embedUrlBtn=null);this.widthNum&&!this.widthNum.isDestroyed&&(this.widthNum.destroy(),t.detach(this.widthNum.element),this.widthNum=null);this.heightNum&&!this.heightNum.isDestroyed&&(this.heightNum.destroy(),t.detach(this.heightNum.element),this.heightNum=null);this.button&&!this.button.isDestroyed&&(this.button.destroy(),t.detach(this.button.element),this.heightNum=null);this.dialogObj&&this.dialogObj.element&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.onKeyUp=function(){var n,i;if(!t.isNullOrUndefined(this.deletedVid)&&this.deletedVid.length>0)for(n=0;n<this.deletedVid.length;n++)i={element:this.deletedVid[n],src:"IFRAME"!==this.deletedVid[n].tagName?this.deletedVid[n].querySelector("source").getAttribute("src"):this.deletedVid[n].src},this.parent.trigger(bo,i)},n.prototype.undoStack=function(n){var r,i,s,u,f,e,o;if(("undo"===n.subCommand.toLowerCase()||"redo"===n.subCommand.toLowerCase())&&"HTML"===this.parent.editorMode)for(r=0;r<this.parent.formatter.getUndoRedoStack().length;r++)if(i=this.parent.createElement("div"),s=this.parent.formatter.getUndoRedoStack()[r].text,i.appendChild(s.cloneNode(!0)),u=i.querySelectorAll("video"),i.querySelector(".e-vid-resize")&&u.length>0){for(f=0;f<u.length;f++)u[f].style.outline="";for(t.detach(i.querySelector(".e-vid-resize")),e=i.cloneNode(!0),o=document.createDocumentFragment();e.firstChild;)o.appendChild(e.firstChild);this.parent.formatter.getUndoRedoStack()[r].text=o}},n.prototype.onIframeMouseDown=function(n){var i=n.target;this.dialogObj&&this.dialogObj.hide({returnValue:!0});(t.isNullOrUndefined(this.parent.currentTarget)||"VIDEO"!==this.parent.currentTarget.nodeName)&&this.videoEle&&this.vidResizeDiv&&this.contentModule.getEditPanel().contains(this.vidResizeDiv)&&this.cancelResizeAction();this.contentModule.getEditPanel().querySelector(".e-vid-resize")&&"VIDEO"===this.parent.currentTarget.nodeName&&(t.isNullOrUndefined(this.prevSelectedVidEle)||this.prevSelectedVidEle===("IFRAME"===i.tagName||"VIDEO"===i.tagName?i:i.querySelector("iframe"))||(this.prevSelectedVidEle.style.outline=""))},n.prototype.videoSize=function(n){var i=this;if(("VIDEO"===n.selectNode[0].nodeName||this.isEmbedVidElem(n.selectNode[0]))&&(this.insertVideo(n),!t.isNullOrUndefined(this.dialogObj))){var r=this.i10n.getConstant("videoSizeHeader"),u=this.i10n.getConstant("dialogUpdate"),f=this.vidsizeInput(n),e={args:n.args,selfVideo:this,selection:n.selection,selectNode:n.selectNode};this.dialogObj.setProperties({width:"290px",header:r,content:f,buttons:[{click:function(){i.insertSize(e)},buttonModel:{content:u,cssClass:"e-flat e-update-size",isPrimary:!0}}]});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.vidsizeInput=function(n){var e=this,i=n.selectNode[0],s=this.i10n.getConstant("videoHeight"),h=this.i10n.getConstant("videoWidth"),r=this.parent.createElement("div",{className:"e-video-sizewrap"}),u=!t.isNullOrUndefined(this.changedWidthValue)||"auto"!==i.style.width.toString()&&""===i.style.width?t.isNullOrUndefined(this.changedWidthValue)?parseInt(i.getClientRects()[0].width.toString(),10).toString():this.changedWidthValue:i.style.width,f=!t.isNullOrUndefined(this.changedHeightValue)||"auto"!==i.style.height.toString()&&""===i.style.height?t.isNullOrUndefined(this.changedHeightValue)?parseInt(i.getClientRects()[0].height.toString(),10).toString():this.changedHeightValue:i.style.height,o;return""===i.style.width&&t.isNullOrUndefined(this.changedWidthValue)&&(u="auto"),""===i.style.height&&t.isNullOrUndefined(this.changedHeightValue)&&(f="auto"),this.changedWidthValue=null,this.changedHeightValue=null,o=vr('<div class="e-rte-label"><label>'+h+'<\/label><\/div><div class="e-rte-field"><input type="text" id="vidwidth" class="e-vid-width" value='+u+' /><\/div><div class="e-rte-label"><label>'+s+'<\/label><\/div><div class="e-rte-field"> <input type="text" id="vidheight" class="e-vid-height" value='+f+" /><\/div>"),r.appendChild(o),this.widthNum=new ot.TextBox({value:t.formatUnit(u),enableRtl:this.parent.enableRtl,input:function(n){e.inputWidthValue=t.formatUnit(n.value)}}),this.widthNum.createElement=this.parent.createElement,this.widthNum.appendTo(r.querySelector("#vidwidth")),this.heightNum=new ot.TextBox({value:t.formatUnit(f),enableRtl:this.parent.enableRtl,input:function(n){e.inputHeightValue=t.formatUnit(n.value)}}),this.heightNum.createElement=this.parent.createElement,this.heightNum.appendTo(r.querySelector("#vidheight")),r},n.prototype.insertSize=function(n){var t,i,r,u;n.selection.restore();t=n.selfVideo;0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData();i=t.dialogObj.element;this.changedWidthValue="px"===this.inputWidthValue?null:this.inputWidthValue;this.changedHeightValue="px"===this.inputHeightValue?null:this.inputHeightValue;r=i.querySelector(".e-vid-width").value;u=i.parentElement.querySelector(".e-vid-height").value;t.parent.formatter.process(this.parent,n.args,n.args,{width:r,height:u,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.vidResizeDiv&&(n.selectNode[0]="VIDEO"===n.selectNode[0].tagName||"IFRAME"===n.selectNode[0].tagName?n.selectNode[0]:n.selectNode[0].querySelector("iframe"),t.vidResizePos(n.selectNode[0],this.vidResizeDiv));t.dialogObj.hide({returnValue:!0})},n.prototype.resizeEnd=function(n){this.resizeBtnInit();this.videoEle.parentElement.style.cursor="auto";t.Browser.isDevice&&t.removeClass([n.target.parentElement],"e-mob-span");var i={event:n,requestType:"videos"};this.parent.trigger(co,i);this.getPointX(n);this.parent.iframeSettings.enable?(window.pageYOffset,this.parent.element.getBoundingClientRect().top,n.clientY):n.pageY;this.parent.formatter.editorManager.observer.on(gf,this.undoStack,this);this.parent.formatter.saveData()},n.prototype.resizeStart=function(n,i){var e=this,r,u,f;this.parent.readonly||(r=i||(this.isEmbedVidElem(n.target)?n.target.querySelector("iframe"):n.target),t.isNullOrUndefined(r)||((this.prevSelectedVidEle=this.videoEle,"VIDEO"===r.tagName||"IFRAME"===r.tagName)&&(this.parent.preventDefaultResize(n),u=r,this.vidResizeDiv&&this.contentModule.getEditPanel().contains(this.vidResizeDiv)&&t.detach(this.vidResizeDiv),this.videoResize(u)),r.classList.contains("e-rte-videoboxmark")&&((0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),n.preventDefault(),n.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.videoQTBar.hidePopup(),r.classList.contains("e-rte-topLeft")&&(this.resizeBtnStat.topLeft=!0),r.classList.contains("e-rte-topRight")&&(this.resizeBtnStat.topRight=!0),r.classList.contains("e-rte-botLeft")&&(this.resizeBtnStat.botLeft=!0),r.classList.contains("e-rte-botRight")&&(this.resizeBtnStat.botRight=!0),t.Browser.isDevice&&this.contentModule.getEditPanel().contains(this.vidResizeDiv)&&!this.vidResizeDiv.classList.contains("e-mob-span"))?t.addClass([this.vidResizeDiv],"e-mob-span"):(f={event:n,requestType:"videos"},this.parent.trigger(cu,f,function(n){n.cancel&&e.cancelResizeAction()})),this.isResizeBind&&(t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing,this),t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd,this),this.isResizeBind=!1))))},n.prototype.videoClick=function(n){t.Browser.isDevice&&("VIDEO"===n.target.tagName||this.isEmbedVidElem(n.target)?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),n.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true"));("VIDEO"===n.target.tagName||this.isEmbedVidElem(n.target)&&!this.parent.userAgentData.isSafari())&&n.preventDefault()},n.prototype.onCutHandler=function(){this.vidResizeDiv&&this.contentModule.getEditPanel().contains(this.vidResizeDiv)&&this.cancelResizeAction()},n.prototype.videoResize=function(n){this.resizeBtnInit();this.videoEle=n;t.addClass([this.videoEle],"e-resize");this.vidResizeDiv=this.parent.createElement("span",{className:"e-vid-resize",id:this.rteID+"_vidResize"});this.vidResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-videoboxmark e-rte-topLeft",styles:"cursor: nwse-resize"}));this.vidResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-videoboxmark e-rte-topRight",styles:"cursor: nesw-resize"}));this.vidResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-videoboxmark e-rte-botLeft",styles:"cursor: nesw-resize"}));this.vidResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-videoboxmark e-rte-botRight",styles:"cursor: nwse-resize"}));t.Browser.isDevice&&t.addClass([this.vidResizeDiv],"e-mob-rte");n.style.outline="2px solid #4a90e2";this.vidResizePos(n,this.vidResizeDiv);this.resizeVidDupPos(n);this.contentModule.getEditPanel().appendChild(this.vidResizeDiv);"auto"===this.parent.element.style.height&&this.vidResizePos(n,this.vidResizeDiv)},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.vidResizePos=function(n,i){if(!t.isNullOrUndefined(i)){var e=this.calcPos(n),u=e.top,f=e.left,o=0!==n.width&&"auto"!==n.width&&"NaN"!==n.width?n.width:n.getBoundingClientRect().width,s=0!==n.height&&"auto"!==n.height&&"NaN"!==n.height?n.height:n.getBoundingClientRect().height,r=t.Browser.isDevice?4*parseInt(n.style.outline.slice(-3),10)+2:2*parseInt(n.style.outline.slice(-3),10)+2,h=t.Browser.isDevice?0:2;i.querySelector(".e-rte-botLeft").style.left=f-r+"px";i.querySelector(".e-rte-botLeft").style.top=parseInt(s.toString(),10)-r+u+"px";i.querySelector(".e-rte-botRight").style.left=parseInt(o.toString(),10)-(r-h)+f+"px";i.querySelector(".e-rte-botRight").style.top=parseInt(s.toString(),10)-r+u+"px";i.querySelector(".e-rte-topRight").style.left=parseInt(o.toString(),10)-(r-h)+f+"px";i.querySelector(".e-rte-topRight").style.top=u-r+"px";i.querySelector(".e-rte-topLeft").style.left=f-r+"px";i.querySelector(".e-rte-topLeft").style.top=u-r+"px"}},n.prototype.calcPos=function(n){for(var f,r={top:0,left:0},u=n.ownerDocument,i=(n.offsetParent&&(n.offsetParent.classList.contains("e-video-clickelem")||["TD","TH","TABLE","A"].indexOf(n.offsetParent.tagName)>-1)?t.closest(n,"#"+this.parent.getID()+"_rte-edit-view"):n.offsetParent)||u.documentElement;i&&(i===u.body||i===u.documentElement)&&"static"===i.style.position;)i=i.parentNode;return i&&i!==n&&1===i.nodeType&&(r=i.getBoundingClientRect()),n&&1===n.nodeType&&"IFRAME"===n.tagName?{top:(f=n.getBoundingClientRect()).top-r.top,left:f.left-r.left}:{top:n.offsetTop,left:n.offsetLeft}},n.prototype.setAspectRatio=function(n,i,r,u){var o=getComputedStyle(n),s;if(!t.isNullOrUndefined(o)){var h=RegExp,f=""!==o.width?o.width.match(new h("^\\d+(\\.\\d*)?%$","g"))?parseFloat(o.width):parseInt(o.width,10):""!==n.style.width?n.style.width:n.width,e=""!==o.height?parseInt(o.height,10):""!==n.style.height?n.style.height:n.height;(f=f.toString().match(new h("\\b\\d+(\\.\\d*)?(%|$)\\b","g"))?parseFloat(f.toString()):parseInt(f.toString(),10))>(e=e.toString().match(new h("\\b\\d+(\\.\\d*)?(%|$)\\b","g"))?parseFloat(e.toString()):parseInt(e.toString(),10))?(n.style.minWidth=0===this.parent.insertVideoSettings.minWidth?"200px":t.formatUnit(this.parent.insertVideoSettings.minWidth),n.style.minHeight=0===this.parent.insertVideoSettings.minHeight?"90px":t.formatUnit(this.parent.insertVideoSettings.minHeight),this.parent.insertVideoSettings.resizeByPercent)?this.updateVidEleWidth(n,f,e,i,r):""===n.style.width&&""!==n.style.height||""===o.width&&""!==o.height?n.style.height=r+"px":""!==n.style.width&&""===n.style.height||""!==o.width&&""===o.height?(s=f/e*r+f/e<this.parent.inputElement.getBoundingClientRect().right-32?f/e*r+f/e:this.parent.inputElement.getBoundingClientRect().right-32,n.style.width=s.toString()+"px"):""!==n.style.width||""!==o.width?(s=f/e*r<this.parent.inputElement.getBoundingClientRect().right-32?f/e*r:this.parent.inputElement.getBoundingClientRect().right-32,n.style.width=s+"px",n.style.height=r+"px"):n.setAttribute("width",parseInt((f/e*r+f/e).toString(),10).toString()):e>f?this.parent.insertVideoSettings.resizeByPercent?this.updateVidEleWidth(n,f,e,i,r):""!==o.width||""!==n.style.width?(n.style.width=i+"px",n.style.height=e/f*i+"px"):n.setAttribute("width",this.resizeBtnStat.botRight?(this.getPointX(u.event)-n.getBoundingClientRect().left).toString():i.toString()):this.parent.insertVideoSettings.resizeByPercent?(n.style.width=this.pixToPerc(i,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):(n.style.width=i+"px",n.style.height=i+"px")}},n.prototype.updateVidEleWidth=function(n,t,i,r,u){if(0!==parseInt(""+n.getBoundingClientRect().width,10)&&0!==parseInt(""+t,10)){var f=(n.offsetWidth+this.mouseX)/n.offsetWidth*("NaN"===parseFloat(n.style.width).toString()?n.offsetWidth/parseFloat(getComputedStyle(this.parent.element).width)*100:parseFloat(n.style.width));n.style.width=(f>3?f:3)+"%"}else n.style.width=t>i?this.pixToPerc(t/i*u,n.previousElementSibling||n.parentElement)+"%":this.pixToPerc(r/i*u,n.previousElementSibling||n.parentElement)+"%";n.style.height=null;n.removeAttribute("height")},n.prototype.pixToPerc=function(n,t){return n/parseFloat(getComputedStyle(t).width)*100},n.prototype.vidDupMouseMove=function(n,i,r){var u=this,f={event:r,requestType:"videos"};this.parent.trigger(ho,f,function(r){if(r.cancel)u.cancelResizeAction();else{if(parseInt(u.parent.insertVideoSettings.minWidth,10)>=parseInt(n,10)||parseInt(u.parent.getInsertVidMaxWidth(),10)<=parseInt(n,10)&&t.isNullOrUndefined(u.videoEle.style.width))return;if(!u.parent.insertVideoSettings.resizeByPercent&&(parseInt(u.parent.insertVideoSettings.minHeight,10)>=parseInt(i,10)||parseInt(u.parent.insertVideoSettings.maxHeight,10)<=parseInt(i,10)))return;u.videoEle.parentElement.style.cursor="pointer";u.setAspectRatio(u.videoEle,parseInt(n,10),parseInt(i,10),f);u.resizeVidDupPos(u.videoEle);u.vidResizePos(u.videoEle,u.vidResizeDiv)}})},n.prototype.resizing=function(n){this.videoEle.offsetWidth>=this.parent.getInsertVidMaxWidth()&&(this.videoEle.style.maxHeight=this.videoEle.offsetHeight+"px");var t=this.getPointX(n),i=this.getPointY(n),r=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(t-this.pageX):t-this.pageX,u=this.resizeBtnStat.topLeft||this.resizeBtnStat.topRight?-(i-this.pageY):i-this.pageY,f=parseInt(this.vidDupPos.width,10)+r,e=parseInt(this.vidDupPos.height,10)+u;this.pageX=t;this.pageY=i;this.mouseX=r;(this.resizeBtnStat.botRight||this.resizeBtnStat.botLeft||this.resizeBtnStat.topRight||this.resizeBtnStat.topLeft)&&this.vidDupMouseMove(f+"px",e+"px",n)},n.prototype.cancelResizeAction=function(){this.isResizeBind=!0;t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);this.videoEle&&this.vidResizeDiv&&this.contentModule.getEditPanel().contains(this.vidResizeDiv)&&(t.detach(this.vidResizeDiv),this.videoEle.style.outline="",this.vidResizeDiv=null,this.pageX=null,this.pageY=null)},n.prototype.resizeVidDupPos=function(n){this.vidDupPos={width:""!==n.style.width&&this.parent.insertVideoSettings&&!this.parent.insertVideoSettings.resizeByPercent?this.videoEle.style.width:"auto"!==n.width&&0!==n.width&&"NaN"!==n.width?n.width+"px":parseInt(getComputedStyle(n).width,10)+"px",height:""!==n.style.height?this.videoEle.style.height:"auto"!==n.height&&0!==n.height&&"NaN"!==n.height?n.height+"px":parseInt(getComputedStyle(n).height,10)+"px"}},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},n.prototype.onToolbarAction=function(n){switch(s()&&this.parent.notify(lt,{}),n.args.item.subCommand){case"VideoReplace":this.parent.notify(po,n);break;case"VideoRemove":this.parent.notify(lc,n);break;case"VideoDimension":this.parent.notify(yc,n)}},n.prototype.onKeyDown=function(n){var r,s,u,e,c,i=n.args,o,f,h,l,a;if(this.deletedVid=[],"HTML"===this.parent.editorMode&&(c=(r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).startContainer===r.endContainer&&r.startOffset===r.endOffset),!c&&"HTML"===this.parent.editorMode&&[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183].indexOf(i.which)<0)for(o=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(r),f=0;f<o.length;f++)"VIDEO"!==o[f].nodeName&&"IFRAME"!==o[f].nodeName||this.deletedVid.push(o[f]);"HTML"===this.parent.editorMode&&(8===i.which&&"Backspace"===i.code||46===i.which&&"Delete"===i.code)&&(h=r.startContainer===r.endContainer&&r.startOffset===r.endOffset,8===i.which&&"Backspace"===i.code&&h?this.checkVideoBack(r):46===i.which&&"Delete"===i.code&&h&&this.checkVideoDel(r));(t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||"KeyK"===i.code||(r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(r),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(r),i.ctrlKey||!i.key||1!==i.key.length&&"enter"!==i.action||(t.isNullOrUndefined(e[0])||"VIDEO"!==e[0].tagName)&&!this.isEmbedVidElem(e[0])||!e[0].parentElement||(this.contentModule.getEditPanel().querySelector(".e-vid-resize")&&this.removeResizeEle(),t.removeClass([e[0]],dt),this.quickToolObj&&this.quickToolObj.videoQTBar&&this.quickToolObj.videoQTBar.hidePopup())),!i.ctrlKey||89!==i.keyCode&&90!==i.keyCode||this.undoStack({subCommand:90===i.keyCode?"undo":"redo"}),8===i.keyCode||46===i.keyCode)&&(u&&u[0]&&("VIDEO"===u[0].nodeName||this.isEmbedVidElem(u[0])||46===i.keyCode&&u[0].nextSibling&&("e-video-wrap"===u[0].nextSibling.className||this.isEmbedVidElem(u[0].nextSibling))||8===i.keyCode&&u[0].previousSibling&&("e-video-wrap"===u[0].previousSibling.className||this.isEmbedVidElem(u[0].previousSibling)))&&u.length<=2&&"#text"!==u[0].nodeName&&(t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(s=this.parent.formatter.editorManager.nodeSelection.save(r,this.parent.contentModule.getDocument())),i.preventDefault(),l={selectNode:u,selection:s,selectParent:e,args:{item:{command:"Videos",subCommand:"VideoRemove"},originalEvent:i}},this.deleteVideo(l,i.keyCode)),this.parent.contentModule.getEditPanel().querySelector(".e-vid-resize")&&this.removeResizeEle());switch("Backspace"===i.code&&(i.action="backspace"),i.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":for(f=0;f<this.deletedVid.length;f++)a=this.deletedVid[f].src,this.videoRemovePost(a);"Markdown"!==this.parent.editorMode&&(3===r.startContainer.nodeType?"Backspace"===i.code?r.startContainer.previousElementSibling&&0===r.startOffset&&r.startContainer.previousElementSibling.classList.contains(ru)&&t.detach(r.startContainer.previousElementSibling):r.startContainer.nextElementSibling&&r.endContainer.textContent.length===r.endOffset&&r.startContainer.nextElementSibling.classList.contains(ru)&&t.detach(r.startContainer.nextElementSibling):1===r.startContainer.nodeType&&r.startContainer.classList&&r.startContainer.classList.contains(ru)?t.detach(r.startContainer):1!==r.startContainer.nodeType||t.isNullOrUndefined(r.startContainer.querySelector(".e-video-wrap"))||"Delete"!==i.code||t.detach(r.startContainer.querySelector(".e-video-wrap")));break;case"insert-video":t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)||(s=this.parent.formatter.editorManager.nodeSelection.save(r,this.parent.contentModule.getDocument()));this.openDialog(!0,i,s,u,e);i.preventDefault()}i.ctrlKey&&"a"===i.key&&this.handleSelectAll()},n.prototype.handleSelectAll=function(){this.cancelResizeAction();var n=this.parent.inputElement.querySelectorAll("."+dt);t.removeClass(n,dt)},n.prototype.openDialog=function(n,i,r,u,f){var e,o,s,h;n||t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)?(o=r,s=u,h=f):(e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(e),h=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e));"HTML"===this.parent.editorMode&&this.insertVideo({args:{item:{command:"Videos",subCommand:"Video"},originalEvent:i,name:n?null:"showDialog"},selectNode:s,selection:o,selectParent:h})},n.prototype.showDialog=function(n){t.isNullOrUndefined(n.originalEvent)?this.openDialog(!1):this.openDialog(!1,n.originalEvent)},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.isVideoWrapElem=function(n){return!!(n&&n.classList&&n.classList.contains(ru))},n.prototype.checkVideoBack=function(n){"#text"!==n.startContainer.nodeName||0!==n.startOffset||t.isNullOrUndefined(n.startContainer.previousSibling)||"VIDEO"!==n.startContainer.previousSibling.nodeName&&!this.isEmbedVidElem(n.startContainer.previousSibling)&&!this.isVideoWrapElem(n.startContainer.previousSibling)?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])||"VIDEO"!==n.startContainer.childNodes[n.startOffset-1].nodeName&&!this.isEmbedVidElem(n.startContainer.childNodes[n.startOffset-1])&&!this.isVideoWrapElem(n.startContainer.childNodes[n.startOffset-1])||this.deletedVid.push(n.startContainer.childNodes[n.startOffset-1]):this.deletedVid.push(n.startContainer.previousSibling)},n.prototype.checkVideoDel=function(n){"#text"!==n.startContainer.nodeName||n.startOffset!==n.startContainer.textContent.length||t.isNullOrUndefined(n.startContainer.nextSibling)||"VIDEO"!==n.startContainer.nextSibling.nodeName&&!this.isEmbedVidElem(n.startContainer.nextSibling)&&!this.isVideoWrapElem(n.startContainer.nextSibling)?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])||"VIDEO"!==n.startContainer.childNodes[n.startOffset].nodeName&&!this.isEmbedVidElem(n.startContainer.childNodes[n.startOffset])&&!this.isVideoWrapElem(n.startContainer.childNodes[n.startOffset])||this.deletedVid.push(n.startContainer.childNodes[n.startOffset]):this.deletedVid.push(n.startContainer.nextSibling)},n.prototype.alignmentSelect=function(n){var r=n.item;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Videos"===r.command){var f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),i=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(f),u={args:n,selectNode:i="VIDEO"===i[0].nodeName?i:[this.videoEle]};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),r.subCommand){case"JustifyLeft":case"JustifyCenter":case"JustifyRight":this.alignVideo(u,r.subCommand);break;case"Inline":this.inline(u);break;case"Break":this.break(u)}this.quickToolObj&&document.body.contains(this.quickToolObj.videoQTBar.element)&&(this.quickToolObj.videoQTBar.hidePopup(),t.removeClass([i[0]],dt));this.cancelResizeAction()}},n.prototype.deleteVideo=function(n,i){if("VIDEO"===n.selectNode[0].nodeName||this.isEmbedVidElem(n.selectNode[0])){this.isEmbedVidElem(n.selectNode[0])&&(n.selectNode[0]=n.selectNode[0].classList.contains(oe)?n.selectNode[0]:n.selectNode[0].parentElement);var r={element:this.isEmbedVidElem(n.selectNode[0])?n.selectNode[0]:n.selectNode[0].querySelector("iframe"),src:this.isEmbedVidElem(n.selectNode[0])?n.selectNode[0].querySelector("iframe").getAttribute("src"):n.selectNode[0].querySelector("source").getAttribute("src")};0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();n.selection.restore();this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.videoRemovePost(r.src);this.quickToolObj&&document.body.contains(this.quickToolObj.videoQTBar.element)&&this.quickToolObj.videoQTBar.hidePopup();this.cancelResizeAction();t.isNullOrUndefined(i)&&this.parent.trigger(bo,r)}},n.prototype.videoRemovePost=function(n){var u=this,r="",i;t.isNullOrUndefined(this.parent.insertVideoSettings.removeUrl)||""===this.parent.insertVideoSettings.removeUrl||(r=n.indexOf("http://")>-1||n.indexOf("https://")>-1?n:new URL(n,document.baseURI).href,this.removingVideoName=r.replace(/^.*[\\\/]/,""),i=new XMLHttpRequest,i.addEventListener("readystatechange",function(){4===this.readyState&&200===this.status&&u.triggerPost(this.response)}),i.open("GET",r),i.responseType="blob",i.send())},n.prototype.triggerPost=function(n){var i=this.parent.insertVideoSettings.removeUrl;if(!t.isNullOrUndefined(i)&&""!==i){var u=new File([n],this.removingVideoName),f=new t.Ajax(i,"POST",!0,null),r=new FormData;r.append("UploadFiles",u);f.send(r)}},n.prototype.onDocumentClick=function(n){var i=n.target;t.isNullOrUndefined(this.contentModule.getEditPanel())||(("VIDEO"===i.nodeName||this.isEmbedVidElem(i))&&(this.videoEle=this.isEmbedVidElem(i)?i.querySelector("iframe"):i),!t.isNullOrUndefined(this.dialogObj)&&(!t.closest(i,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(n.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)&&!t.closest(i,"#"+this.parent.getID()+"_toolbar_Video")&&!i.querySelector("#"+this.parent.getID()+"_toolbar_Video"))&&(n.offsetX>n.target.clientWidth||n.offsetY>n.target.clientHeight||(this.parent.notify(nu,{closedBy:"outside click"}),this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,eu(this.parent.element,"focusout"))),this.contentModule.getEditPanel().querySelector(".e-vid-resize")&&("VIDEO"===i.tagName||this.isEmbedVidElem(i)||this.removeResizeEle(),"VIDEO"===i.tagName||this.isEmbedVidElem(i)||t.isNullOrUndefined(this.videoEle)?t.isNullOrUndefined(this.prevSelectedVidEle)||this.prevSelectedVidEle===("IFRAME"===i.tagName||"VIDEO"===i.tagName?i:i.querySelector("iframe"))||(this.prevSelectedVidEle.style.outline=""):this.videoEle.style.outline=""),this.parent.inlineMode.enable&&i&&this.dialogObj&&!t.closest(i,"#"+this.dialogObj.element.id)&&this.dialogObj.hide())},n.prototype.removeResizeEle=function(){this.isResizeBind=!0;t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);t.detach(this.contentModule.getEditPanel().querySelector(".e-vid-resize"))},n.prototype.onWindowResize=function(){t.isNullOrUndefined(this.contentModule)||t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-vid-resize"))||this.cancelResizeAction()},n.prototype.break=function(n){if("VIDEO"===n.selectNode[0].nodeName||this.isEmbedVidElem(n.selectNode[0])){var t=n.args.item?n.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:t})}},n.prototype.inline=function(n){if("VIDEO"===n.selectNode[0].nodeName||this.isEmbedVidElem(n.selectNode[0])){var t=n.args.item?n.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:t})}},n.prototype.alignVideo=function(n,t){var i=n.args.item?n.args.item.subCommand:t;this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{selectNode:n.selectNode,subCommand:i})},n.prototype.editAreaClickHandler=function(n){var i,u,r;this.parent.readonly?this.hideVideoQuickToolbar():(i=n.args,u=this.parent.quickToolbarSettings.showOnRightClick,2===i.which||u&&1===i.which||!u&&3===i.which?u&&1===i.which&&!t.isNullOrUndefined(i.target)&&("VIDEO"===i.target.tagName||this.isEmbedVidElem(i.target))&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),i.target)):"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.videoQTBar&&(this.quickToolObj=this.parent.quickToolbarModule,r=i.target,this.contentModule=this.rendererFactory.getRenderer(o.Content),("VIDEO"===r.nodeName||this.isEmbedVidElem(r))&&this.parent.quickToolbarModule?(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),r),s()&&this.parent.notify(ft,n),t.addClass([this.isEmbedVidElem(r)?r.querySelector("iframe"):r],dt),this.showVideoQuickToolbar({args:i,type:"Videos",elements:[i.target]})):this.hideVideoQuickToolbar()))},n.prototype.showVideoQuickToolbar=function(n){var r=this,i;"Videos"!==n.type||!t.isNullOrUndefined(n.args)&&2===n.args.detail||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.videoQTBar)||t.isNullOrUndefined(n.args)||(this.quickToolObj=this.parent.quickToolbarModule,i=n.elements,[].forEach.call(n.elements,function(n,t){0===t&&(i=n)}),("VIDEO"===i.tagName||this.isEmbedVidElem(i))&&t.addClass([this.isEmbedVidElem(i)&&"IFRAME"!==i.tagName?i.querySelector("iframe"):i],[dt]),this.parent.quickToolbarModule.videoQTBar&&(n.isNotify?this.showPopupTime=setTimeout(function(){r.parent.formatter.editorManager.nodeSelection.Clear(r.contentModule.getDocument());r.parent.formatter.editorManager.nodeSelection.setSelectionContents(r.contentModule.getDocument(),i);r.quickToolObj.videoQTBar.showPopup(i,n.args);!0===r.parent.insertVideoSettings.resize&&r.resizeStart(n.args,i)},400):(this.quickToolObj.videoQTBar.showPopup(i,n.args),!0===this.parent.insertVideoSettings.resize&&-1!==t.Browser.userAgent.indexOf("Firefox")&&this.resizeStart(n.args,i))))},n.prototype.hideVideoQuickToolbar=function(){t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector("."+dt))||(t.removeClass([this.contentModule.getEditPanel().querySelector("."+dt)],dt),t.isNullOrUndefined(this.videoEle)||(this.videoEle.style.outline=""),t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-vid-resize"))||t.detach(this.contentModule.getEditPanel().querySelector(".e-vid-resize")),this.quickToolObj&&this.quickToolObj.videoQTBar&&document.body.contains(this.quickToolObj.videoQTBar.element)&&this.quickToolObj.videoQTBar.hidePopup())},n.prototype.isEmbedVidElem=function(n){return!!(n&&3!==n.nodeType&&"BR"!==n.nodeName&&n.classList&&(n.classList.contains(oe)||n.classList.contains("e-embed-video-wrap"))||n&&"IFRAME"===n.nodeName)},n.prototype.insertingVideo=function(n){if(this.insertVideo(n),!t.isNullOrUndefined(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var i=this.dialogObj.element.querySelector(".e-video-content");t.isNullOrUndefined(this.parent.insertVideoSettings.path)&&"HTML"!==this.parent.editorMode?i.querySelector(".e-video-url").focus():document.getElementById(this.rteID+"_insertVideo").focus()}},n.prototype.insertVideo=function(n){var i=this,r;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{r=this.parent.createElement("div",{className:"e-rte-video-dialog",id:this.rteID+"_video"});this.parent.rootContainer.appendChild(r);var e=this.i10n.getConstant("dialogInsert"),o=this.i10n.getConstant("dialogCancel"),s=this.i10n.getConstant("videoHeader"),h=n.selection,c={selfVideo:this,selection:n.selection,args:n.args,selectParent:n.selectParent},u={header:s,cssClass:pt,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",isModal:t.Browser.isDevice,position:{X:"center",Y:t.Browser.isDevice?"center":"top"},buttons:[{click:this.insertVideoUrl.bind(c),buttonModel:{content:e,cssClass:"e-flat e-insertVideo",isPrimary:!0,disabled:!0}},{click:function(n){i.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:o}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){i.isVideoUploaded&&(i.dialogObj.element.querySelector(".e-file-abort-btn")?i.dialogObj.element.querySelector(".e-file-abort-btn").click():i.uploadObj.remove());i.parent.isBlur=!1;n&&!t.isNullOrUndefined(n.event)&&n.event.returnValue&&"HTML"===i.parent.editorMode&&h.restore();i.clearDialogObj();i.dialogRenderObj.close(n)}},f=this.parent.createElement("div",{className:"e-video-content"});t.isNullOrUndefined(this.parent.insertVideoSettings.path)&&"HTML"!==this.parent.editorMode||f.appendChild(this.videoUpload(n));var l=this.parent.createElement("div",{className:"e-videoheader"}),a=this.parent.createElement("div",{className:"e-embed-videoheader"}),v=this.i10n.getConstant("videoLinkHeader"),y=this.i10n.getConstant("embedVideoLinkHeader");"HTML"===this.parent.editorMode&&(l.innerHTML=v,a.innerHTML=y);f.appendChild(this.urlPopup(n));n.selectNode&&1===n.selectNode[0].nodeType&&("VIDEO"===n.selectNode[0].tagName||this.isEmbedVidElem(n.selectNode[0]))?(u.header=this.parent.localeObj.getConstant("editVideoHeader"),u.content=f):u.content=f;this.dialogObj=this.dialogRenderObj.render(u);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(r);n.selectNode&&1===n.selectNode[0].nodeType&&("VIDEO"===n.selectNode[0].tagName||this.isEmbedVidElem(n.selectNode[0]))&&"insertVideo"===n.name&&(this.dialogObj.element.querySelector(".e-insertVideo").textContent=this.parent.localeObj.getConstant("dialogUpdate"));r.style.maxHeight="inherit";this.quickToolObj&&(this.quickToolObj.videoQTBar&&document.body.contains(this.quickToolObj.videoQTBar.element)&&(this.quickToolObj.videoQTBar.hidePopup(),t.isNullOrUndefined(n.selectParent)||t.removeClass([n.selectParent[0]],dt)),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup(),this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup())}},n.prototype.urlPopup=function(n){var i=this,u=this.parent.createElement("div",{className:"e-video-url-wrap"}),r=this.parent.createElement("div",{id:"urlcontent"}),s=this.i10n.getConstant("videoUrl"),h=vr('<input id="embedURL" type="radio"><input id="webURL" type="radio" >'),o,f,e;return(u.appendChild(h),u.appendChild(r),this.embedInputUrl=this.parent.createElement("textarea",{className:"e-input e-embed-video-url",attrs:{placeholder:this.i10n.getConstant("pasteEmbeddedCodeHere"),type:"text",tabindex:"-1","aria-label":this.i10n.getConstant("embedVideoLinkHeader")}}),this.embedInputUrl.addEventListener("input",function(){t.isNullOrUndefined(i.embedInputUrl)||(0===i.embedInputUrl.value.length?i.dialogObj.getButtons(0).element.disabled=!0:i.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),this.inputUrl=this.parent.createElement("input",{className:"e-input e-video-url",attrs:{placeholder:s,spellcheck:"false"}}),this.inputUrl.addEventListener("input",function(){t.isNullOrUndefined(i.inputUrl)||(0===i.inputUrl.value.length?i.dialogObj.getButtons(0).element.disabled=!0:i.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),n.selectNode&&n.selectNode[0]&&("VIDEO"===n.selectNode[0].nodeName||this.isEmbedVidElem(n.selectNode[0])))&&("VIDEO"===n.selectNode[0].nodeName||n.selectNode[0].classList.contains("e-video-wrap")?(o=new RegExp(/([^\S]|^)(((https?:\/\/)|(www\.))(\S+))/gi),f=n.selectNode[0].querySelector("source"),this.inputUrl.value=f&&f.src&&f.src.match(o)?f.src:""):this.embedInputUrl.value="IFRAME"===n.selectNode[0].nodeName?n.selectNode[0].outerHTML:n.selectNode[0].querySelector("iframe").outerHTML),e=!!this.inputUrl.value,this.embedUrlBtn=new rr.RadioButton({label:this.i10n.getConstant("embeddedCode"),checked:!e,name:"URL",created:function(){e||r.appendChild(i.embedInputUrl)},change:function(){r.innerHTML="";r.appendChild(i.embedInputUrl)}}),this.embedUrlBtn.appendTo(u.querySelector("#embedURL")),this.webUrlBtn=new rr.RadioButton({label:this.i10n.getConstant("webUrl"),checked:e,name:"URL",created:function(){e&&r.appendChild(i.inputUrl)},change:function(){r.innerHTML="";r.appendChild(i.inputUrl)}}),this.webUrlBtn.appendTo(u.querySelector("#webURL")),u},n.prototype.videoUpload=function(n){var f,e,r=this,i=this,a=i.parent.iframeSettings.enable,s,o,v,y,c,p,l;"HTML"===i.parent.editorMode&&(!a&&t.isNullOrUndefined(t.closest(n.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||a&&!et(n.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))?(this.contentModule.getEditPanel().focus(),s=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.save(s,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(s)):(f=n.selection,e=n.selectParent);var h=this.parent.createElement("div",{className:"e-vid-uploadwrap e-droparea"}),w=this.i10n.getConstant("videoDeviceUploadMessage"),b=this.i10n.getConstant("videoUploadMessage"),u=this.parent.createElement("span",{className:"e-droptext"}),k=this.parent.createElement("span",{className:"e-rte-upload-text",innerHTML:t.Browser.isDevice?w:b});return u.appendChild(k),o=this.parent.createElement("button",{className:"e-browsebtn",id:this.rteID+"_insertVideo",attrs:{autofocus:"true",type:"button"}}),u.appendChild(o),h.appendChild(u),v=this.i10n.getConstant("browse"),this.button=new rr.Button({content:v,enableRtl:this.parent.enableRtl}),this.button.isStringTemplate=!0,this.button.createElement=this.parent.createElement,this.button.appendTo(o),y=t.Browser.isDevice?u:o,t.EventHandler.add(y,"click",this.fileSelect,this),l=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),h.appendChild(l),this.uploadObj=new ot.Uploader({asyncSettings:{saveUrl:this.parent.insertVideoSettings.saveUrl,removeUrl:this.parent.insertVideoSettings.removeUrl},dropArea:u,multiple:!1,enableRtl:this.parent.enableRtl,allowedExtensions:this.parent.insertVideoSettings.allowedTypes.toString(),maxFileSize:this.parent.insertVideoSettings.maxFileSize,selected:function(n){i.isVideoUploaded=!0;p=n;n.filesData;r.parent.trigger(ow,p,function(n){if(!n.cancel){if(t.isNullOrUndefined(n.filesData[0]))return;if(r.checkExtension(n.filesData[0]),c=n.filesData[0].name,"HTML"===r.parent.editorMode&&t.isNullOrUndefined(r.parent.insertVideoSettings.path)){var u=new FileReader;u.addEventListener("load",function(){var n="Base64"===r.parent.insertVideoSettings.saveFormat?u.result:URL.createObjectURL(kr(u.result));i.uploadUrl={url:n,selection:f,fileName:c,selectParent:e};i.inputUrl.setAttribute("disabled","true");i.embedInputUrl.setAttribute("disabled","true");t.isNullOrUndefined(i.parent.insertVideoSettings.saveUrl)&&r.isAllowedTypes&&!t.isNullOrUndefined(r.dialogObj)&&r.dialogObj.getButtons(0).element.removeAttribute("disabled")});u.readAsDataURL(n.filesData[0].rawFile)}}})},beforeUpload:function(n){r.parent.trigger(cl,n)},uploading:function(n){r.parent.isServerRendered||r.parent.trigger(fl,n)},success:function(n){r.parent.trigger(el,n,function(n){if(!t.isNullOrUndefined(r.parent.insertVideoSettings.path)){var u=r.parent.insertVideoSettings.path+n.file.name;i.uploadUrl={url:u,selection:f,fileName:c,selectParent:e,width:{width:i.parent.insertVideoSettings.width,minWidth:i.parent.insertVideoSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertVideoSettings.height,minHeight:i.parent.insertVideoSettings.minHeight,maxHeight:i.parent.insertVideoSettings.maxHeight}};i.embedInputUrl.setAttribute("disabled","true")}"upload"!==n.operation||t.isNullOrUndefined(r.dialogObj)||r.dialogObj.getButtons(0).element.removeAttribute("disabled")})},failure:function(n){r.parent.trigger(ol,n)},removing:function(){r.parent.trigger(sw,n,function(){i.isVideoUploaded=!1;r.dialogObj.getButtons(0).element.disabled=!0;i.inputUrl.getAttribute("disabled")&&i.inputUrl.removeAttribute("disabled");i.embedInputUrl.getAttribute("disabled")&&i.embedInputUrl.removeAttribute("disabled");i.uploadUrl&&(i.uploadUrl.url="")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(l),h},n.prototype.checkExtension=function(n){this.uploadObj.allowedExtensions&&(-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+n.type).toLocaleLowerCase())?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},n.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragOver=function(n){if(!("edge"===t.Browser.info.name&&"video"===n.dataTransfer.items[0].type.split("/")[0]||t.Browser.isIE&&"Files"===n.dataTransfer.types[0]))return!0;n.preventDefault()},n.prototype.dragDrop=function(n){var i=this;this.parent.trigger(hw,n,function(n){var u=n.dataTransfer.files.length>0,r;if(!n.cancel&&u){if(t.closest(n.target,"#"+i.parent.getID()+"_toolbar")||"false"===i.parent.inputElement.contentEditable)return void n.preventDefault();if(i.parent.element.querySelector("."+kn)&&t.detach(i.vidResizeDiv),n.preventDefault(),r=void 0,i.contentModule.getDocument().caretRangeFromPoint?r=i.contentModule.getDocument().caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent?(r=i.contentModule.getDocument().createRange()).setStart(n.rangeParent,n.rangeOffset):r=i.getDropRange(n.clientX,n.clientY),i.parent.notify(au,{range:r}),i.parent.element.querySelector("."+la))return;i.insertDragVideo(n)}else u&&n.preventDefault()})},n.prototype.getDropRange=function(n,t){var i=this.contentModule.getDocument().createRange(),e;this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var f=this.contentModule.getDocument().elementFromPoint(n,t),u=f.childNodes.length>0?f.childNodes[0]:f,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)i.setStart(u,r),i.setEnd(u,r);else{e=void 0;do r++,i.setStart(u,r),i.setEnd(u,r+1),e=i.getBoundingClientRect();while(e.left<n&&r<u.length-1)}return i},n.prototype.insertDragVideo=function(n){var o=this,t,r;if(n.preventDefault(),t=this.parent.element.querySelector(""+wu),this.parent.notify(te,{args:n}),t&&t.classList.add(pu),r={requestType:"Videos",name:"VideoDragAndDrop",cancel:!1,originalEvent:n},n.dataTransfer.files.length>0){if(n.dataTransfer.files.length>1)return;for(var u=n.dataTransfer.files,f=u[0].name,s=f.substring(f.lastIndexOf(".")),e=this.parent.insertVideoSettings.allowedTypes,i=0;i<e.length;i++)s.toLocaleLowerCase()===e[i].toLowerCase()&&(this.parent.insertVideoSettings.saveUrl?this.onSelect(n):this.parent.trigger(l,r,function(t){if(t.cancel)t.originalEvent.preventDefault();else{var i={args:n,text:"",file:u[0]};n.preventDefault();o.videoPaste(i)}}))}},n.prototype.onSelect=function(n){var t=this,r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.save(r,this.parent.contentModule.getDocument()),i=n.dataTransfer.files[0],f={cssClass:"Inline"===this.parent.insertVideoSettings.layoutOption?ce:ps,url:this.parent.insertVideoSettings.path+i.name,selection:u,fileName:i.name,width:{width:this.parent.insertVideoSettings.width,minWidth:this.parent.insertVideoSettings.minWidth,maxWidth:this.parent.getInsertVidMaxWidth()},height:{height:this.parent.insertVideoSettings.height,minHeight:this.parent.insertVideoSettings.minHeight,maxHeight:this.parent.insertVideoSettings.maxHeight}},e={requestType:"Videos",name:"VideoDragAndDrop",cancel:!1,originalEvent:n,itemCollection:f};this.parent.trigger(l,e,function(i){if(i.cancel)i.originalEvent.preventDefault();else{t.parent.formatter.process(t.parent,{item:{command:"Videos",subCommand:"Video"}},n,i.itemCollection);var r=t.parent.contentModule.getEditPanel().querySelector("video:last-of-type");r&&(r.style.opacity="0.5",t.uploadMethod(n,r))}})},n.prototype.uploadMethod=function(n,t){var u=this,i,r;this.popupObj=this.popupUploaderObj.renderPopup("Videos",t);i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());r=n.dataTransfer.files[0].size>1e6?300:100;this.videoDragPopupTime=setTimeout(function(){u.popupUploaderObj.refreshPopup(t)},r);this.uploadObj=this.popupUploaderObj.createUploader("Videos",n,t,this.popupObj.element.childNodes[0]);this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none";i.selectNodeContents(t);this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i)},n.prototype.videoPaste=function(n){var u=this,i,r;0!==n.text.length||t.isNullOrUndefined(n.file)||(i=this,r=new FileReader,n.args.preventDefault(),r.addEventListener("load",function(){var e=n.file,o="Base64"!==u.parent.insertVideoSettings.saveFormat&&t.isNullOrUndefined(n.callBack)?URL.createObjectURL(kr(r.result)):r.result,f={cssClass:"Inline"===i.parent.insertVideoSettings.layoutOption?ce:ps,url:o,fileName:e.name,width:{width:i.parent.insertVideoSettings.width,minWidth:i.parent.insertVideoSettings.minWidth,maxWidth:i.parent.getInsertVidMaxWidth()},height:{height:i.parent.insertVideoSettings.height,minHeight:i.parent.insertVideoSettings.minHeight,maxHeight:i.parent.insertVideoSettings.maxHeight}};t.isNullOrUndefined(n.callBack)?(i.parent.formatter.process(i.parent,{item:{command:"Videos",subCommand:"Video"}},n.args,f),u.showPopupToolBar(n,f)):n.callBack(f)}),r.readAsDataURL(n.file))},n.prototype.showPopupToolBar=function(n,t){var i=this,f='video[src="'+t.url+'"]',r=this.parent.inputElement.querySelector(f),u;this.parent.quickToolbarModule.createQTBar("Video","MultiRow",this.parent.quickToolbarSettings.video,o.VideoToolbar);u={args:n.args,type:"Videos",isNotify:void 0,elements:r};r&&(this.showVideoQTbarTime=setTimeout(function(){i.showVideoQuickToolbar(u);i.parent.insertVideoSettings.resize&&i.resizeStart(n.args,r)},0))},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0});this.isVideoUploaded&&this.uploadObj.removing()},n.prototype.insertVideoUrl=function(){var n=this.selfVideo,i,r;if(n.isVideoUploaded=!1,i=n.inputUrl.value,r=n.embedInputUrl.value,0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),t.isNullOrUndefined(n.uploadUrl)||""===n.uploadUrl.url){if("HTML"===n.parent.editorMode&&(""!==i||""!==r)){var u=document.getElementById("webURL"),f=u.checked?i.split("/")[i.split("/").length-1]:r,e={cssClass:"Inline"===n.parent.insertVideoSettings.layoutOption?ce:ps,url:i,selection:this.selection,fileName:f,isEmbedUrl:!u.checked,selectParent:this.selectParent,width:{width:n.parent.insertVideoSettings.width,minWidth:n.parent.insertVideoSettings.minWidth,maxWidth:n.parent.getInsertImgMaxWidth()},height:{height:n.parent.insertVideoSettings.height,minHeight:n.parent.insertVideoSettings.minHeight,maxHeight:n.parent.insertVideoSettings.maxHeight}};if(n.dialogObj.hide({returnValue:!1}),null!==n.dialogObj)return;n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,e)}}else{if(n.uploadUrl.cssClass="Inline"===n.parent.insertVideoSettings.layoutOption?ce:ps,n.uploadUrl.width={width:n.parent.insertVideoSettings.width,minWidth:n.parent.insertVideoSettings.minWidth,maxWidth:n.parent.getInsertImgMaxWidth()},n.uploadUrl.height={height:n.parent.insertVideoSettings.height,minHeight:n.parent.insertVideoSettings.minHeight,maxHeight:n.parent.insertVideoSettings.maxHeight},n.dialogObj.hide({returnValue:!1}),null!==n.dialogObj)return;n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,n.uploadUrl);n.uploadUrl.url=""}},n.prototype.destroy=function(){this.isDestroyed||(this.prevSelectedVidEle=void 0,this.removeEventListener(),this.showPopupTime&&(clearTimeout(this.showPopupTime),this.showPopupTime=null),this.clearDialogObj(),this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"video"},n}(),sst=(ap=function(n,t){return ap=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},ap(n,t)},function(n,t){function i(){this.constructor=n}ap(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),vp=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},hst={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187,"<":188,">":190,"`":192,9:57},yp=function(n){function i(t,i){var u=n.call(this,i,t)||this;return u.keyPressHandler=function(n){for(var h,t,c=n.altKey,l=n.ctrlKey,a=n.shiftKey,v=n.metaKey,y=n.which,i=0,e=Object.keys(u.keyConfigs);i<e.length;i++)for(var o=e[i],f=0,s=u.keyConfigs[""+o].split(",");f<s.length;f++)h=s[f],t=r.getKeyConfigData(h.trim()),c===t.altKey&&(l===t.ctrlKey||v)&&a===t.shiftKey&&y===t.keyCode&&(n.action=o);u.keyAction&&u.keyAction(n)},u.bind(),u}var r;return sst(i,n),r=i,i.prototype.destroy=function(){this.unwireEvents();n.prototype.destroy.call(this)},i.prototype.onPropertyChanged=function(){},i.prototype.bind=function(){this.wireEvents()},i.prototype.getModuleName=function(){return"keyboard"},i.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},i.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},i.getKeyConfigData=function(n){if(n in this.configCache)return this.configCache[""+n];var t=n.toLowerCase().split("+"),i={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return i.keyCode=t[t.length-1].length>1&&Number(t[t.length-1])?Number(t[t.length-1]):r.getKeyCode(t[t.length-1]),r.configCache[""+n]=i,i},i.getKeyCode=function(n){return hst[""+n]||n.toUpperCase().charCodeAt(0)},i.configCache={},vp([t.Property({})],i.prototype,"keyConfigs",void 0),vp([t.Property("keyup")],i.prototype,"eventName",void 0),vp([t.Event()],i.prototype,"keyAction",void 0),r=vp([t.NotifyPropertyChanges],i)}(t.Base),ort=function(){function n(n,t){this.parent=n;var i=t;this.rendererFactory=i.getService("rendererFactory");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(lu,this.sourceCode,this);this.parent.on(a,this.onInitialEnd,this);this.parent.on(vf,this.updateSourceCode,this);this.parent.on(u,this.destroy,this)},n.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(c,this.onKeyDown,this)},n.prototype.removeEventListener=function(){this.unWireEvent();this.parent.off(lu,this.sourceCode);this.parent.off(vf,this.updateSourceCode);this.parent.off(a,this.onInitialEnd);this.parent.off(u,this.destroy);this.parent.formatter.editorManager.observer.off(c,this.onKeyDown)},n.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:fu+this.parent.getCssClass(!0)})},n.prototype.wireEvent=function(n){this.keyboardModule=new yp(n,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"});t.EventHandler.add(this.previewElement,"mousedown",this.mouseDownHandler,this)},n.prototype.unWireEvent=function(){this.previewElement&&t.EventHandler.remove(this.previewElement,"mousedown",this.mouseDownHandler);this.keyboardModule&&!this.keyboardModule.isDestroyed&&this.keyboardModule.destroy()},n.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new yp(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},n.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},n.prototype.mouseDownHandler=function(n){this.parent.notify(yf,{args:n})},n.prototype.previewKeyDown=function(n){switch(n.action){case"html-source":this.updateSourceCode(n);n.preventDefault();break;case"toolbar-focus":if(this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()){var t=this.parent.getToolbarElement().querySelector(".e-toolbar-item:not(.e-overlay)[title]");t.firstElementChild.removeAttribute("tabindex");t.firstElementChild.focus()}break;case"escape":this.parent.element.classList.contains("e-rte-full-screen")&&(this.parent.fullScreenModule.hideFullScreen(n),n.preventDefault());break;case"full-screen":this.parent.fullScreenModule.showFullScreen(n);n.preventDefault()}},n.prototype.onKeyDown=function(n){"html-source"===n.event.action&&(n.event.preventDefault(),this.sourceCode(n),n.callBack({requestType:"SourceCode",editorMode:"HTML",event:n.event}))},n.prototype.sourceCode=function(n){var i=this;this.parent.notify(os,{});this.parent.isBlur=!1;this.parent.trigger(l,{requestType:"SourceCode",targetItem:"SourceCode",args:n,cancel:!1},function(r){var e,f,u;r.cancel||(e=t.selectAll("."+or,i.parent.element),i.contentModule=i.rendererFactory.getRenderer(o.Content),f=i.parent.inputElement.getBoundingClientRect().height,i.parent.rootContainer.classList.add("e-source-code-enabled"),i.parent.notify(lf,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:i.parent.getBaseToolbarObject()}),t.isNullOrUndefined(i.previewElement)&&(i.previewElement=i.getSourceCode()),i.parent.inputElement.innerHTML=tr(i.replaceAmpersand(i.parent.inputElement.innerHTML),i.parent.editorMode),i.parent.updateValueData(),u=void 0,t.isNullOrUndefined(i.parent.element.querySelector("#"+i.parent.getID()+"_source-view"))?u=i.parent.createElement("div",{className:"e-source-content",id:i.parent.getID()+"_source-view",attrs:{style:"height:"+f+"px"}}):(u=i.parent.element.querySelector("#"+i.parent.getID()+"_source-view")).style.height=f+"px",u.appendChild(i.previewElement),i.parent.rootContainer.appendChild(u),i.getPanel().value=tr(i.getTextAreaValue(),i.parent.editorMode),i.parent.isBlur=!1,i.parent.disableToolbarItem(i.parent.toolbarSettings.items),i.parent.enableToolbarItem("SourceCode"),i.parent.getToolbar()&&t.removeClass([i.parent.getToolbar()],[ca]),t.removeClass(e,[uu]),i.wireEvent(i.previewElement),i.unWireBaseKeyDown(),i.previewElement.focus(),i.parent.inputElement.innerHTML=tr(i.replaceAmpersand(i.parent.inputElement.innerHTML),i.parent.editorMode),i.parent.updateValue(),i.parent.trigger(ct,{requestType:"SourceCode",targetItem:"SourceCode",args:n}),i.parent.invokeChangeEvent(),!t.isNullOrUndefined(i.parent.saveInterval)&&i.parent.saveInterval>0&&i.parent.autoSaveOnIdle&&(i.codeViewTimeInterval=setInterval(function(){i.parent.notify(na,{})},i.parent.saveInterval)))})},n.prototype.updateSourceCode=function(n){var i=this;this.parent.isBlur=!1;this.parent.trigger(l,{requestType:"Preview",targetItem:"Preview",args:n,cancel:!1},function(r){var u,o,e,f,s;r.cancel||(i.parent.rootContainer.classList.remove("e-source-code-enabled"),u=i.getPanel(),i.parent.notify(lf,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:i.parent.getBaseToolbarObject()}),t.isNullOrUndefined(u)||(u.value=i.parent.enableHtmlSanitizer?br(i.parent.htmlEditorModule.sanitizeHelper(u.value),i.parent.element):br(u.value,i.parent.element),u.value=uf(i.replaceAmpersand(u.value),i.parent.editorMode)),o=i.parent.serializeValue(u.value),e=void 0,e=null===o||""===o?"DIV"===i.parent.enterKey?"<div><br/><\/div>":"BR"===i.parent.enterKey?"<br/>":"<p><br/><\/p>":o,f=document.createElement("div"),f.innerHTML=e,s="\n"===f.textContent?"":f.textContent,t.detach(f),f=null,i.parent.maxLength>=0&&s.length>i.parent.maxLength&&(e=i.contentModule.getEditPanel().innerHTML),i.contentModule.getEditPanel().innerHTML=uf(i.replaceAmpersand(e),i.parent.editorMode),i.parent.isBlur=!1,i.parent.enableToolbarItem(i.parent.toolbarSettings.items),i.parent.getToolbar()&&t.removeClass([i.parent.getToolbar()],[ca]),i.unWireEvent(),i.wireBaseKeyDown(),i.parent.updateValue(),i.contentModule.getEditPanel().focus(),i.parent.trigger(ct,{requestType:"Preview",targetItem:"Preview",args:n}),i.parent.formatter.enableUndo(i.parent),i.parent.addAudioVideoWrapper(),clearTimeout(i.codeViewTimeInterval),i.parent.invokeChangeEvent(),i.parent.notify(sf,{}),"HTML"!==i.parent.editorMode||t.isNullOrUndefined(i.parent.codeBlockModule)||i.parent.codeBlockModule.disableToolbarItems())})},n.prototype.replaceAmpersand=function(n){var t=this;return"HTML"===this.parent.editorMode&&["times","divide","ne"].forEach(function(i){var r=new RegExp("&(amp;)*("+i+")","g"),u;t.parent.enableHtmlSanitizer?(u=t.parent.enableHtmlEncode?"&amp;amp;amp;amp;"+i:"&amp;amp;"+i,n=n.replace(r,u)):n=n.replace(r,"&amp;"+i)}),n},n.prototype.getTextAreaValue=function(){return"<p><br><\/p>"===this.contentModule.getEditPanel().innerHTML||"<div><br><\/div>"===this.contentModule.getEditPanel().innerHTML||"<br>"===this.contentModule.getEditPanel().innerHTML||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length||"DIV"===this.contentModule.getEditPanel().childNodes[0].tagName&&11===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value},n.prototype.getPanel=function(){return this.parent.element&&this.parent.element.querySelector(".e-rte-srctextarea")},n.prototype.destroy=function(){t.isNullOrUndefined(this.parent)||this.removeEventListener()},n}(),srt=function(){function n(){this.allCells=[];this.hasCellsUpdated=!1;this.preventOverflowCells=!1}return n.prototype.handleTablePaste=function(n,t){var r,i,f,u,e,o;!n||!t||t.length<1||(this.hasCellsUpdated=!1,r=t[0],this.preventOverflowCells=t.length>1,i=this.getClosestTable(r),i&&(f=this.getTableRows(n),u=this.getRowIndex(r),this.allCells=g(i),e=this.getCellIndex(r,u),o=g(n),this.pasteMultipleRows(i,f,u,e,o),this.hasCellsUpdated&&rf(i,!0)))},n.prototype.getClosestTable=function(n){return t.closest(n,"table")},n.prototype.getTableRows=function(n){for(var i,r=[],u=n.rows.length,t=0;t<u;t++)i=n.rows.item(t),null!==i&&r.push(i);return r},n.prototype.getRowIndex=function(n){var t=n.parentElement;return null!==t?t.rowIndex:0},n.prototype.getCellIndex=function(n,t){var i,u,r;for(void 0===t&&(t=0),i=t;i<this.allCells.length;i++)for(u=this.allCells[i],r=0;r<u.length;r++)if(this.allCells[i][r]===n)return r;return n.cellIndex>=0?n.cellIndex:0},n.prototype.pasteMultipleRows=function(n,t,i,r,u){for(var e,f=0;f<t.length;f++)e=t[f],this.pasteRowContent(n,e,r,i,u)},n.prototype.ensureCellCount=function(n,t,i){if(i<t)for(this.hasCellsUpdated=!0;i<t;)n.insertCell().innerHTML="<br>",i++},n.prototype.getOrCreateRow=function(n,t){if(t<n.rows.length)return n.rows.item(t);if(!this.preventOverflowCells){var i=n.insertRow();return this.fillRowWithEmptyCells(i,this.getMaxColumnCount(n.rows[0].cells)),this.allCells=g(n),i}return null},n.prototype.fillRowWithEmptyCells=function(n,t){for(var i=0;i<t;i++)n.insertCell().innerHTML="<br>"},n.prototype.getMaxColumnCount=function(n){for(var i=0,t=0;t<n.length;t++)i+=n[t].colSpan;return i},n.prototype.pasteRowContent=function(n,t,i,r,u){var l=this.getRowCells(t),f,e,c,s;for(this.allCells=g(n),this.preventOverflowCells||this.ensureTargetTableCapacity(n,i,u),f=0;f<l.length;f++){e=l[f];this.allCells=g(n);var a=pi(e,u),o=r+a[0],h=i+a[1];this.preventOverflowCells&&this.adjustCellSpans(e,o,h,n);c=this.getOrCreateRow(n,o);c&&(s=this.allCells[o][h],s&&!this.shouldSkipCell(s)&&this.copyCellAttributes(s,e,o,h,n,c))}},n.prototype.adjustCellSpans=function(n,t,i,r){var u=parseInt(n.getAttribute("rowspan")||"1",10),f=parseInt(n.getAttribute("colspan")||"1",10),e,o;u>1&&(e=this.calculateAdjustedRowSpan(n,t,i,u,r),n.setAttribute("rowspan",e.toString()));f>1&&(o=this.calculateAdjustedColSpan(t,i,f),n.setAttribute("colspan",o.toString()))},n.prototype.calculateAdjustedRowSpan=function(n,t,i,r,u){for(var o,s,h,f=r,e=1;e<r;e++)o=t+e,this.getOrCreateRow(u,o)?(s=this.allCells[o][i],s&&!this.shouldSkipCell(s)||--f):--f;return h=r-f,h>0&&this.adjustCellHeights(n,null,f,h),f},n.prototype.calculateAdjustedColSpan=function(n,t,i){for(var e,f,u=i,r=0;r<i;r++)e=t+r,f=this.allCells[n][e],f&&!this.shouldSkipCell(f)||--u;return u},n.prototype.ensureTargetTableCapacity=function(n,t,i){var r;if(i[0])for(r=0;r<n.rows.length;r++){var u=n.rows[r],f=this.allCells[r].length,e=t+i[0].length;this.ensureCellCount(u,e,f)}},n.prototype.shouldSkipCell=function(n){return this.preventOverflowCells&&!(n.classList.contains("e-cell-select")&&n.classList.contains("e-multi-cells-select"))},n.prototype.getRowCells=function(n){for(var i,r=[],u=n.cells.length,t=0;t<u;t++)i=n.cells.item(t),null!==i&&r.push(i);return r},n.prototype.copyCellAttributes=function(n,t,i,r,u,f){if(t){n=this.handleCellInsertLocation(n,f,i,r);n=this.handleInsertRowMismatch(n,f,i,r,u);var e=this.getCellSpanAttributes(n,t);n=this.handleColspanChanges(n,e.oldColSpan,e.newColSpan,i,r,f,u);(n=this.handleRowspanChanges(n,e.oldRowSpan,e.newRowSpan,i,r,u,e.newColSpan)).innerHTML=t.innerHTML;n.style.cssText=t.style.cssText}},n.prototype.getCellSpanAttributes=function(n,t){return{oldRowSpan:parseInt(n.getAttribute("rowspan")||"1",10),oldColSpan:parseInt(n.getAttribute("colspan")||"1",10),newRowSpan:parseInt(t.getAttribute("rowspan")||"1",10),newColSpan:parseInt(t.getAttribute("colspan")||"1",10)}},n.prototype.handleCellInsertLocation=function(n,t,i,r){var e=this.getInsertionColIndex(r,t,i),o,f,s,u;return e<r&&(o=parseInt(n.getAttribute("colspan")||"1",10),f=o-(r-e),f>0)?(s=e+1,u=t.insertCell(s),u.innerHTML="<br>",u.style.cssText=n.style.cssText,u.className=n.className,n.setAttribute("colspan",(o-f).toString()),this.allCells[i][r]=u,u.setAttribute("colspan",f.toString()),n.hasAttribute("rowspan")&&u.setAttribute("rowspan",n.getAttribute("rowspan")),u):n},n.prototype.handleInsertRowMismatch=function(n,t,i,r,u){var f;if(n.parentElement!==t){var o=parseInt(n.getAttribute("rowspan")||"1",10),e=o-(i-this.getRowIndex(n)),s=o-e;if(o>1)return this.removeRowspanAttributes(u,i,r),f=this.allCells[i][r],f.innerHTML=n.innerHTML,f.style.cssText=n.style.cssText,f.className=n.className,n.hasAttribute("colspan")&&f.setAttribute("colspan",n.getAttribute("colspan")),1===e?f.removeAttribute("rowspan"):f.setAttribute("rowspan",e.toString()),s>1?n.setAttribute("rowspan",s.toString()):n.removeAttribute("rowspan"),this.adjustCellHeights(n,f,s,e),f}return n},n.prototype.adjustCellHeights=function(n,t,i,r){var e,u,f;n.style.height&&(e=n.style.height,u=parseFloat(e),!isNaN(u)&&u>0&&(f=u/(i+r),n.style.height=i*f+"px",t&&(t.style.height=r*f+"px")))},n.prototype.handleRowspanChanges=function(n,t,i,r,u,f,e){var c,s,h,o;return t>1&&i<=1?(c=t-i,s=r+1,this.removeRowspanAttributes(f,s,u),(o=this.allCells[s][u]).innerHTML=n.innerHTML,o.style.cssText=n.style.cssText,o.className=n.className,n.hasAttribute("colspan")&&o.setAttribute("colspan",n.getAttribute("colspan")),1===c?o.removeAttribute("rowspan"):o.setAttribute("rowspan",c.toString()),n.removeAttribute("rowspan"),this.adjustCellHeights(n,o,i,c)):t>1&&i>1?(h=i-t,h>0?(this.applyRowspanAttributes(f,r,u,i,e),n.setAttribute("rowspan",i.toString())):h<0&&(s=r+i,this.removeRowspanAttributes(f,s,u),(o=this.allCells[s][u]).innerHTML=n.innerHTML,o.style.cssText=n.style.cssText,o.className=n.className,n.hasAttribute("colspan")&&o.setAttribute("colspan",n.getAttribute("colspan")),1==-h?o.removeAttribute("rowspan"):o.setAttribute("rowspan",(-h).toString()),n.setAttribute("rowspan",i.toString()),this.adjustCellHeights(n,o,i,-h))):i>1&&t<=1&&(this.applyRowspanAttributes(f,r,u,i,e),n.setAttribute("rowspan",i.toString())),n},n.prototype.handleColspanChanges=function(n,t,i,r,u,f,e){var h,c,o,s;return t>1&&i<=1?(h=t-i,this.insertFollowingSiblings(f,u,r,i),1===h?n.removeAttribute("colspan"):n.setAttribute("colspan",h.toString()),n.innerHTML="",(s=this.allCells[r][u]).className=n.className,n=s):i>1&&t<=1?(c=i-t,c>0&&(this.removeFollowingSiblings(this.allCells[r],u+t,c,e,f,r),n.setAttribute("colspan",i.toString()))):i>1&&t>1&&(o=i-t,o>0?(this.removeFollowingSiblings(this.allCells[r],u+t,o,e,f,r),n.setAttribute("colspan",i.toString())):o<0&&(this.insertFollowingSiblings(f,u,r,1),n.setAttribute("colspan",(-o).toString()),n.innerHTML="",(s=this.allCells[r][u]).className=n.className,(n=s).setAttribute("colspan",i.toString()))),n},n.prototype.applyRowspanAttributes=function(n,t,i,r,u){for(var o,e,s,f=1;f<r;f++)for(o=t+f,e=0;e<u;e++)s=i+e,this.processRowspanCell(n,o,s)},n.prototype.processRowspanCell=function(n,t,i){var u=this.getOrCreateRow(n,t),r=this.allCells[t][i],o=Array.prototype.indexOf.call(u.cells,r),f,e;r&&r.parentElement&&-1!==o&&(f=parseInt(r.getAttribute("colspan")||"1",10),e=parseInt(r.getAttribute("rowspan")||"1",10),f<=1&&e<=1||this.handleComplexCellRemoval(n,u,r,t,i,f,e),u.removeChild(r),this.allCells[t][i]=null)},n.prototype.handleComplexCellRemoval=function(n,t,i,r,u,f,e){f>1&&this.handleColspanCellRemoval(t,i,r,u,f);e>1&&this.handleRowspanCellRemoval(n,i,r,u,e)},n.prototype.handleColspanCellRemoval=function(n,t,i,r,u){this.insertFollowingSiblings(n,r,i,1);var e=u-1,f=this.allCells[i][r];f.innerHTML="<br>";f.style.cssText=t.style.cssText;f.className=t.className;1===e?f.removeAttribute("colspan"):f.setAttribute("colspan",e.toString())},n.prototype.handleRowspanCellRemoval=function(n,t,i,r,u){this.removeRowspanAttributes(n,i+1,r);var f=this.allCells[i+1][r],e=u-1;f.innerHTML=t.innerHTML;f.style.cssText=t.style.cssText;f.className=t.className;1===e?f.removeAttribute("rowspan"):f.setAttribute("rowspan",e.toString());this.adjustCellHeights(t,f,u,e)},n.prototype.removeRowspanAttributes=function(n,t,i){var r=this.getOrCreateRow(n,t),u=this.getInsertionColIndex(i,r,t),f=r.insertCell(u);this.allCells[t][i]=f},n.prototype.getInsertionColIndex=function(n,t,i){var r,u,f;return!t||0===t.cells.length?0:(r=n,u=this.allCells[i]||[],r=this.findMatchingCellIndex(u,t,r,!0),f=u.indexOf(t.cells[0]),(u.length<=r||t.cells.length<=n&&-1!==f&&f<r)&&(r=n,r=this.findMatchingCellIndex(u,t,r,!1)),u[r]?(r=u[r].cellIndex,t.cells.length<=n&&-1!==f&&n>f&&r++):r=n,r)},n.prototype.findMatchingCellIndex=function(n,t,i,r){for(var u=i;n&&u>=0&&n[u]&&t&&-1===Array.prototype.indexOf.call(t.cells,n[u]);)u=r?u+1:u-1;return u},n.prototype.removeFollowingSiblings=function(n,t,i,r,u,f){for(var e,s,h,o=0;o<i;o++)e=n[t],e&&e.parentElement&&(s=parseInt(e.getAttribute("colspan")||"1",10),h=parseInt(e.getAttribute("rowspan")||"1",10),s<=1&&h<=1||this.handleComplexCellRemoval(r,u,e,f,t,s,h),e.parentElement.removeChild(e),n[t]=null)},n.prototype.insertFollowingSiblings=function(n,t,i,r){for(var f,e=this.getInsertionColIndex(t,n,i),u=0;u<r;u++)f=n.insertCell(e),f.innerHTML="<br>",this.allCells[i][t]=f},n.prototype.getValidTableFromPaste=function(n){if("table"===n.nodeName.toLowerCase())return n;var t=n.querySelector("table");return t?this.getWrapperNodeForTable(n,t):null},n.prototype.getWrapperNodeForTable=function(n,t){for(var r,i=n;i!==t;){if(r=Array.from(i.childNodes).filter(function(n){return n.nodeType!==Node.COMMENT_NODE&&!(n.nodeType===Node.TEXT_NODE&&""===n.textContent.trim())}),1!==r.length)return null;i=r[0]}return i},n}(),hrt=function(){function n(n,t,i){this.isTableMoveActive=!1;this.pageX=null;this.pageY=null;this.isResizeBind=!0;this.currentColumnResize="";this.resizeEndTime=0;this.ensureInsideTableList=!0;this.parent=n;this.tablePastingObj=new srt;this.tableModel=t;this.iframeSettings=i;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ey,this.createTable,this);this.parent.observer.on(oy,this.insertRow,this);this.parent.observer.on(sy,this.insertColumn,this);this.parent.observer.on(hy,this.deleteRow,this);this.parent.observer.on(cy,this.deleteColumn,this);this.parent.observer.on(ly,this.removeTable,this);this.parent.observer.on(ay,this.tableHeader,this);this.parent.observer.on(vy,this.tableVerticalAlign,this);this.parent.observer.on(yy,this.cellMerge,this);this.parent.observer.on(wy,this.horizontalSplit,this);this.parent.observer.on(py,this.verticalSplit,this);this.parent.observer.on(by,this.tableStyles,this);this.parent.observer.on(ky,this.setBGColor,this);this.parent.observer.on(hk,this.tableMove,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(ey,this.createTable);this.parent.observer.off(oy,this.insertRow);this.parent.observer.off(sy,this.insertColumn);this.parent.observer.off(hy,this.deleteRow);this.parent.observer.off(cy,this.deleteColumn);this.parent.observer.off(ly,this.removeTable);this.parent.observer.off(ay,this.tableHeader);this.parent.observer.off(vy,this.tableVerticalAlign);this.parent.observer.off(yy,this.cellMerge);this.parent.observer.off(wy,this.horizontalSplit);this.parent.observer.off(py,this.verticalSplit);this.parent.observer.off(by,this.tableStyles);this.parent.observer.off(ky,this.setBGColor);this.parent.observer.off(hk,this.tableMove);this.parent.observer.off(f,this.destroy);!t.Browser.isDevice&&this.tableModel.tableSettings.resize&&(t.EventHandler.remove(this.tableModel.getEditPanel(),"mouseover",this.resizeHelper),t.EventHandler.remove(this.tableModel.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart));this.curTable&&t.EventHandler.remove(this.curTable,"mouseleave",this.tableMouseLeave);t.EventHandler.remove(this.tableModel.getDocument(),"selectionchange",this.tableCellsKeyboardSelection)},n.prototype.copy=function(n){var t=this.extractSelectedTable(this.curTable,n),i,r,u;if(t){i=tr(t.outerHTML,this.tableModel.editorMode);try{r=new Blob([i],{type:"text/html"});u=new window.ClipboardItem({"text/html":r});navigator.clipboard.write([u])}catch(n){console.error("Clipboard API not supported in this browser")}}},n.prototype.updateTableModel=function(n){this.tableModel=n},n.prototype.extractSelectedTable=function(n,t){var r=n.querySelectorAll(".e-cell-select.e-multi-cells-select"),i,u;return!r||0===r.length?null:(i=n.cloneNode(!0),u=this.buildSelectionMap(n,r,t),this.cleanTableToSelection(i,u),this.removeColGroup(i),i)},n.prototype.buildSelectionMap=function(n,t,i){for(var e,r=new Map,u=0;u<t.length;u++){for(var o=t[u],s=o.parentElement,h=Array.prototype.indexOf.call(n.rows,s),c=Array.prototype.indexOf.call(s.cells,o),l=parseInt(o.getAttribute("rowspan")||"1",10),f=0;f<l;f++)e=f+h,r.has(e)||r.set(e,new Set),0===f&&r.get(e).add(c);i&&(n.rows[h].cells[c].innerHTML="<br>")}return r},n.prototype.cleanTableToSelection=function(n,i){for(var f,e,u,r=n.rows.length-1;r>=0;r--)if(f=n.rows[r],i.has(r))for(e=i.get(r),u=f.cells.length-1;u>=0;u--)e.has(u)||f.deleteCell(u);else t.detach(f)},n.prototype.removeColGroup=function(n){var i=ou(n);i&&t.detach(i)},n.prototype.createTable=function(n){var t=this.createTableStructure(n);return this.insertTableInDocument(t,n),this.handlePostTableInsertion(t,n),t},n.prototype.createTableStructure=function(n){var i=t.createElement("table",{className:"e-rte-table"}),u,f,r;return this.applyTableDimensions(i,n.item.width),u=this.calculateCellWidth(n.item.width.width,n.item.columns),f=this.createInitialColgroup(n.item.columns,u),i.appendChild(f),r=t.createElement("tbody"),this.createRowsAndCells(r,n.item.rows,n.item.columns),i.appendChild(r),i},n.prototype.createInitialColgroup=function(n,i){for(var r,u=t.createElement("colgroup"),f=0;f<n;f++)r=t.createElement("col"),r.appendChild(t.createElement("br")),r.style.width=i+"%",u.appendChild(r);return u},n.prototype.applyTableDimensions=function(n,i){t.isNullOrUndefined(i.width)||(n.style.width=this.calculateStyleValue(i.width));t.isNullOrUndefined(i.minWidth)||(n.style.minWidth=this.calculateStyleValue(i.minWidth));t.isNullOrUndefined(i.maxWidth)||(n.style.maxWidth=this.calculateStyleValue(i.maxWidth))},n.prototype.calculateCellWidth=function(n,t){return parseInt(n,10)>100?100/t:parseInt(n,10)/t},n.prototype.createRowsAndCells=function(n,i,r){for(var f,e,o,u=0;u<i;u++){for(f=t.createElement("tr"),e=0;e<r;e++)o=t.createElement("td"),o.appendChild(t.createElement("br")),f.appendChild(o);n.appendChild(f)}},n.prototype.insertTableInDocument=function(n,t){t.item.selection.restore();kt.Insert(this.tableModel.getDocument(),n,this.tableModel.getEditPanel());t.item.selection.setSelectionText(this.tableModel.getDocument(),n.querySelector("td"),n.querySelector("td"),0,0)},n.prototype.handlePostTableInsertion=function(n,t){var i,r,u;this.insertElementAfterTableIfNeeded(n,t.enterAction);n.classList.contains("ignore-table")&&p([n],["ignore-table"]);i=this.getOffsetParent(n,this.tableModel.getDocument());i&&(r=i&&("TD"===i.nodeName||"TH"===i.nodeName),u=!(!i.classList||!i.classList.contains("e-multi-cells-select")),r&&!u&&p([i],["e-cell-select"]));n.querySelector("td").classList.add("e-cell-select");t.callBack&&t.callBack({requestType:"Table",editorMode:"HTML",event:t.event,range:this.parent.nodeSelection.getRange(this.tableModel.getDocument()),elements:[n]})},n.prototype.insertElementAfterTableIfNeeded=function(n,i){if(null===n.nextElementSibling&&!n.classList.contains("ignore-table")){var r=void 0;"DIV"===i?(r=t.createElement("div")).appendChild(t.createElement("br")):"BR"===i?r=t.createElement("br"):(r=t.createElement("p")).appendChild(t.createElement("br"));this.insertAfter(r,n)}},n.prototype.calculateStyleValue=function(n){return"string"==typeof n&&(n.indexOf("px")>=0||n.indexOf("%")>=0||n.indexOf("auto")>=0)?n:n+"px"},n.prototype.insertAfter=function(n,t){t.parentNode&&t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.getSelectedCellMinMaxIndex=function(n){for(var t,o,s=this.curTable.querySelectorAll(".e-cell-select"),i=n.length,r=0,u=n[0].length,f=0,e=0;e<s.length;e++)t=pi(s[e],n),o=this.FindIndex(t[0],t[1],n),i=Math.min(t[0],i),r=Math.max(o[0],r),u=Math.min(t[1],u),f=Math.max(o[1],f);return{startRow:i,endRow:r,startColumn:u,endColumn:f}},n.prototype.insertRow=function(n){var r="InsertRowBefore"!==n.item.subCommand,i;this.curTable=t.closest(this.parent.nodeSelection.range.startContainer.parentElement,"table");i=0===this.curTable.querySelectorAll(".e-cell-select").length?this.addRowWithoutCellSelection():this.addRowWithCellSelection(n,r);this.updateSelectionAfterRowInsertion(i,n);this.executeCallback(n)},n.prototype.addRowWithoutCellSelection=function(){var i=this.curTable.rows[this.curTable.rows.length-1],t=i.cloneNode(!0),n;return t.removeAttribute("rowspan"),this.insertAfter(t,i),n=t.cells,n&&n.length>0?n[0]:null},n.prototype.addRowWithCellSelection=function(n,i){var e=g(this.curTable),u=this.getSelectedCellMinMaxIndex(e),o=i?u.endRow:u.startRow,f=t.createElement("tr"),s=this.curTable.querySelectorAll("th.e-cell-select").length>0,r;return this.createCellsForNewRow(e,o,i,s,f),this.insertNewRowAtPosition(n,i,s,o,f),r=f.cells,r&&r.length>0&&u.endColumn<r.length?r[u.endColumn]:null},n.prototype.createCellsForNewRow=function(n,t,i,r,u){for(var f=0;f<n[t].length;f++)this.isCellAffectedByRowspan(n,t,f,i)?this.isFirstCellInSpan(n,t,f)&&this.incrementRowspan(n[t][f]):this.createNewCellForRow(n,t,f,r,i,u)},n.prototype.isCellAffectedByRowspan=function(n,t,i,r){return r&&t<n.length-1&&n[t][i]===n[t+1][i]||!r&&0<t&&n[t][i]===n[t-1][i]},n.prototype.isFirstCellInSpan=function(n,t,i){return 0===i||0<i&&n[t][i]!==n[t][i-1]},n.prototype.incrementRowspan=function(n){var t=parseInt(n.getAttribute("rowspan"),10)||1;n.setAttribute("rowspan",(t+1).toString())},n.prototype.createNewCellForRow=function(n,i,r,u,f,e){var o=t.createElement("td"),s,h;o.appendChild(t.createElement("br"));e.appendChild(o);s=n[this.getReferenceRowIndex(n,i,u,f)][r].getAttribute("style");s&&(h=this.cellStyleCleanup(s),o.style.cssText=h)},n.prototype.getReferenceRowIndex=function(n,t,i,r){return i&&r&&t+1<n.length?t+1:t},n.prototype.insertNewRowAtPosition=function(n,t,i,r,u){var f;f=i&&t?this.curTable.querySelector("tbody").childNodes[0]:this.curTable.rows[r];"InsertRowBefore"===n.item.subCommand||i?f.parentElement.insertBefore(u,f):this.insertAfter(u,f)},n.prototype.updateSelectionAfterRowInsertion=function(n,i){n&&(this.clearTableSelections(),t.addClass([n],nt),i.item.selection.setSelectionText(this.tableModel.getDocument(),n,n,0,0))},n.prototype.clearTableSelections=function(){p(this.tableModel.getEditPanel().querySelectorAll(".e-cell-select"),nt);this.removeTableSelection()},n.prototype.executeCallback=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.tableModel.getDocument()),elements:this.parent.nodeSelection.getSelectedNodes(this.tableModel.getDocument())})},n.prototype.insertColumn=function(n){var i=n.item.selection.range.startContainer,o,f;"TH"!==i.nodeName&&"TD"!==i.nodeName&&(i=t.closest(i.parentElement,"td,th"));var r=t.closest(i,"tr"),s=t.closest(r,"table").rows,u=Array.prototype.slice.call(r.querySelectorAll(":scope > td, :scope > th")).indexOf(i),e=t.closest(r,"table");this.prepareTableForColumnInsertion(n,e);this.insertCellsInAllRows(n,s,u,e);o="InsertColumnRight"===n.item.subCommand?u+1:u;f=r.cells[o];this.clearTableSelections();t.addClass([f],nt);this.finalizeColumnInsertion(n,f)},n.prototype.prepareTableForColumnInsertion=function(n,i){for(var u=i.querySelectorAll("th,td"),r=0;r<u.length;r++)u[r].dataset.oldWidth=u[r].offsetWidth/i.offsetWidth*100+"%";(t.isNullOrUndefined(i.style.width)||""===i.style.width)&&(i.style.width=i.offsetWidth+"px")},n.prototype.insertCellsInAllRows=function(n,t,i,r){for(var u,f,h=r.querySelectorAll("th,td"),o=t[0].querySelectorAll(":scope > td, :scope > th").length,s=parseInt(n.item.width,10)/(o+1),c=parseInt(n.item.width,10)/o,l=this.updateColumnGroup(r,i,n.item.subCommand,s),e=0;e<t.length;e++)u=t[e].querySelectorAll(":scope > td, :scope > th")[i],f=this.createColumnCell(u),"InsertColumnLeft"===n.item.subCommand?u.parentElement.insertBefore(f,u):this.insertAfter(f,u),delete f.dataset.oldWidth;this.redistributeCellWidths(h,c,s,l)},n.prototype.updateColumnGroup=function(n,i,r,u){var e,f,o,s;return rf(n),e=ou(n),f=t.createElement("col"),f.appendChild(t.createElement("br")),f.style.width=u.toFixed(4)+"%",o=e.querySelectorAll("col"),o.length>0&&i<o.length?(s=o[i],"InsertColumnLeft"===r?e.insertBefore(f,s):this.insertAfter(f,s)):e.appendChild(f),e.querySelectorAll("col")},n.prototype.createColumnCell=function(n){var i=n.cloneNode(!0),r=i.getAttribute("style"),u;return r&&(u=this.cellStyleCleanup(r),i.style.cssText=u),i.innerHTML="",i.appendChild(t.createElement("br")),i.removeAttribute("class"),i.removeAttribute("colspan"),i.removeAttribute("rowspan"),i},n.prototype.redistributeCellWidths=function(n,t,i,r){for(var f,u=0;u<n.length;u++)n[u].dataset.oldWidth&&(f=Number(n[u].dataset.oldWidth.split("%")[0]),r[Array.prototype.slice.call(n[u].parentElement.querySelectorAll(":scope > td, :scope > th")).indexOf(n[u])].style.width=(f*i/t).toFixed(4)+"%",delete n[u].dataset.oldWidth)},n.prototype.finalizeColumnInsertion=function(n,t){n.item.selection.setSelectionText(this.tableModel.getDocument(),t,t,0,0);this.executeCallback(n)},n.prototype.setBGColor=function(n){var i=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),u=3===i.startContainer.nodeType?i.startContainer.parentNode:i.startContainer,r,t;for(this.curTable=u.closest("table"),r=this.curTable.querySelectorAll(".e-cell-select"),t=0;t<r.length;t++)r[t].style.backgroundColor=n.value.toString();this.parent.undoRedoManager.saveData();this.parent.observer.notify(uh,{});this.executeBgColorCallback(n)},n.prototype.executeBgColorCallback=function(n){n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.tableModel.getDocument()),elements:this.parent.nodeSelection.getSelectedNodes(this.tableModel.getDocument())})},n.prototype.tableStyles=function(n){var i=n.event,u=n.item.subCommand,r=t.closest(i.selectParent[0],"table");this.applyTableStyleCommand(u,r);this.applyCustomCssClasses(i,r);this.parent.undoRedoManager.saveData();this.parent.observer.notify(uh,{});this.parent.nodeSelection.restore();n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:i.args,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.applyTableStyleCommand=function(n,t){"Dashed"===n?(this.parent.editableElement.classList.contains(nf)?p([this.parent.editableElement],nf):this.parent.editableElement.classList.add(nf),t.classList.contains(nf)?p([t],nf):t.classList.add(nf)):"Alternate"===n&&(this.parent.editableElement.classList.contains(tf)?p([this.parent.editableElement],tf):this.parent.editableElement.classList.add(tf),t.classList.contains(tf)?p([t],tf):t.classList.add(tf))},n.prototype.applyCustomCssClasses=function(n,t){var u=n.args,f,i,r;if(u&&u.item.cssClass)for(f=u.item.cssClass.split(" "),i=0;i<f.length;i++)r=f[i],t.classList.contains(r)?p([t],r):t.classList.add(r)},n.prototype.deleteColumn=function(n){var i=n.item.selection.range.startContainer,r;(3===i.nodeType&&(i=t.closest(i.parentElement,"td,th")),this.curTable=t.closest(i,"table"),1===t.closest(i,"tr").querySelectorAll("th,td").length)?this.removeEntireTable(n):(rf(this.curTable),r=this.removeSelectedColumns(n),this.updateColgroupAfterColumnDeletion(this.curTable,r.startColumn,r.endColumn));this.executeDeleteColumnCallback(n)},n.prototype.updateColgroupAfterColumnDeletion=function(n,t,i){for(var f=ou(n),u=f.querySelectorAll("col"),s=i-t+1,r=0;r<s;r++)t<u.length&&(f.removeChild(u[t]),u=f.querySelectorAll("col"));var e=u.length,h=n.offsetWidth,o=new Array(e);for(r=0;r<e;r++)o[r]=u[r].offsetWidth;for(r=0;r<e;r++)u[r].style.width=it(o[r],h).toFixed(4)+"%"},n.prototype.removeEntireTable=function(n){var i=n.item.selection.range.startContainer;t.detach(t.closest(i.parentElement,"table"));n.item.selection.restore()},n.prototype.removeSelectedColumns=function(n){for(var s,r,i,c,e,h=-1,u=g(this.curTable),f=this.getSelectedCellMinMaxIndex(u),l=f.startColumn,a=f.endColumn,o=0;o<u.length;o++)for(s=u[o],r=0;r<s.length;r++)i=s[r],"true"!==i.dataset.processed&&(c=pi(i,u),e=parseInt(i.getAttribute("colspan"),10)||1,this.isCellAffectedByDeletedColumns(c[1],e,l,a)&&(i.dataset.processed="true",e>1?this.adjustColspan(i,e):(t.detach(i),h=r,this.handleIESpecificSelection(n,t.Browser.isIE))));return this.cleanupProcessedCells(),this.updateSelectionAfterColumnDelete(n,f.startRow,h),f},n.prototype.cleanupProcessedCells=function(){var n=this.curTable.querySelectorAll("td, th");Array.from(n).forEach(function(n){delete n.dataset.processed})},n.prototype.isCellAffectedByDeletedColumns=function(n,t,i,r){return n+(t-1)>=i&&n<=r},n.prototype.adjustColspan=function(n,t){n.setAttribute("colspan",(t-1).toString())},n.prototype.handleIESpecificSelection=function(n,t){if(t){var i=this.curTable.querySelector("td");n.item.selection.setSelectionText(this.tableModel.getDocument(),i,i,0,0);i.classList.add("e-cell-select")}},n.prototype.updateSelectionAfterColumnDelete=function(n,t,i){if(i>-1){var u=i<=(this.curTable&&this.curTable.rows[t]&&this.curTable.rows[t].cells.length-1)?i:i-1,r=this.curTable.rows[t].cells[u];r&&(n.item.selection.setSelectionText(this.tableModel.getDocument(),r,r,0,0),r.classList.add("e-cell-select"))}},n.prototype.executeDeleteColumnCallback=function(n){var t,r,i;n.callBack&&(t=this.parent.nodeSelection.getRange(this.tableModel.getDocument()).startContainer,"TD"!==t.nodeName&&(r=this.parent.nodeSelection.getRange(this.tableModel.getDocument()).startOffset,i=t.children[r],i&&this.parent.nodeSelection.setCursorPoint(this.tableModel.getDocument(),i,0)),this.executeCallback(n))},n.prototype.deleteRow=function(n){var i=n.item.selection.range.startContainer,u,r,f;3===i.nodeType&&(i=t.closest(i.parentElement,"td,th"));u=Array.prototype.indexOf.call(i.parentNode.childNodes,i);this.curTable=t.closest(i,"table");r=g(this.curTable);f=this.getSelectedCellMinMaxIndex(r);1===this.curTable.rows.length?this.removeEntireTable(n):this.deleteSelectedRows(n,f,r,u);this.executeCallback(n)},n.prototype.deleteSelectedRows=function(n,t,i,r){for(var e,f,u=t.endRow;u>=t.startRow;u--)e=this.curTable.rows[u],this.adjustRowSpans(u,i),this.repositionSpannedCells(u,i),f=e.rowIndex,this.curTable.deleteRow(f),this.restoreFocusAfterRowDeletion(n,f,r)},n.prototype.adjustRowSpans=function(n,t){for(var r,u,f,i=0;i<t[n].length;i++)(0===i||t[n][i]!==t[n][i-1])&&(r=t[n][i],u=r.getAttribute("rowspan"),u&&parseInt(u,10)>1&&(f=parseInt(u,10)-1,1===f?(r.removeAttribute("rowspan"),this.createReplacementCellIfNeeded(i)):r.setAttribute("rowspan",f.toString())))},n.prototype.createReplacementCellIfNeeded=function(n){var i=this.getMergedRow(g(this.curTable)),t,r;i&&n<i.length&&(t=i[n],t&&(r=t.cloneNode(!0),r.innerHTML="<br>",t.parentElement&&t.parentElement.insertBefore(r,t)))},n.prototype.repositionSpannedCells=function(n,t){for(var r,i=0;i<t[n].length;i++){var u=t[n][i],f=n<t.length-1&&u===t[n+1][i],e=0===n||u!==t[n-1][i];if(f&&e)for(r=i;r>0&&u===t[n][r-1];)0===r?this.curTable.rows[n+1].prepend(u):t[n+1][r-1].insertAdjacentElement("afterend",u),r--}},n.prototype.restoreFocusAfterRowDeletion=function(n,i,r){var e=t.isNullOrUndefined(this.curTable.rows[i])?this.curTable.rows[i-1]:this.curTable.rows[i],u=e&&e.querySelectorAll("td")[r],f;u?(n.item.selection.setSelectionText(this.tableModel.getDocument(),u,u,0,0),u.classList.add("e-cell-select")):(f=this.curTable.querySelector("td"),n.item.selection.setSelectionText(this.tableModel.getDocument(),f,f,0,0),f.classList.add("e-cell-select"))},n.prototype.getMergedRow=function(n){for(var i,r=this.curTable.rows[0].childNodes.length,t=0;t<n.length;t++)if(n[t].length!==r){i=n[t];break}return i},n.prototype.removeTable=function(n){var i=n.item.selection.range.startContainer,r,u;i=3===i.nodeType?i.parentNode:i;r=t.closest(i.parentElement,"table");r&&(u=r.nextSibling,t.detach(r),n.item.selection.restore(),this.focusAfterTableDeletion(u));this.executeCallback(n)},n.prototype.focusAfterTableDeletion=function(n){var t,i;n&&(t=this.parent.nodeSelection.findFirstContentNode(n),t&&t.node&&("BR"===t.node.nodeName?(i=this.parent.editableElement.ownerDocument.createRange(),i.setStartBefore(t.node),i.setEndBefore(t.node),this.parent.nodeSelection.setRange(this.parent.currentDocument,i)):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t.node,0)))},n.prototype.tableHeader=function(n){var t=this.getTableFromSelection(n),i=this.checkIfTableHasHeader(t);t&&!i?this.createTableHeader(t):t.deleteTHead();this.executeCallback(n)},n.prototype.getTableFromSelection=function(n){var i=n.item.selection.range.startContainer;return"TABLE"===i.nodeName?i:(3===i.nodeType&&(i=i.parentNode),t.closest(i.parentElement,"table"))},n.prototype.checkIfTableHasHeader=function(n){var t=!1;return Array.prototype.slice.call(n.childNodes).forEach(function(n){"THEAD"===n.nodeName&&(t=!0)}),t},n.prototype.createTableHeader=function(n){for(var u,i=n.querySelector("tr"),f=i.childElementCount,r=0,t=0;t<f;t++)r+=parseInt(i.children[t].getAttribute("colspan"),10)||1;u=n.createTHead().insertRow(0);this.createHeaderCells(u,r)},n.prototype.createHeaderCells=function(n,i){for(var u,r=0;r<i;r++)u=t.createElement("th"),u.appendChild(t.createElement("br")),n.appendChild(u)},n.prototype.tableVerticalAlign=function(n){var t=this.getVerticalAlignmentValue(n.item.subCommand);this.applyVerticalAlignment(n.item.tableCell,t);this.executeCallback(n)},n.prototype.getVerticalAlignmentValue=function(n){switch(n){case"AlignTop":return"top";case"AlignMiddle":return"middle";case"AlignBottom":return"bottom";default:return""}},n.prototype.applyVerticalAlignment=function(n,t){var i=this.curTable&&this.curTable.querySelectorAll(".e-cell-select"),r;if(i&&i.length>0)for(r=0;r<i.length;r++)i[r].style.verticalAlign=t;else n.style.verticalAlign=t;t&&""!==t&&n.getAttribute("valign")&&n.removeAttribute("valign")},n.prototype.cellMerge=function(n){var i,u,r;this.curTable=t.closest(this.parent.nodeSelection.range.startContainer.parentElement,"table");i=this.curTable.querySelectorAll(".e-cell-select");i.length<2||(rf(this.curTable),u=de(this.curTable),this.mergeCellContent(),r=this.getSelectedMinMaxIndexes(g(this.curTable)),this.configureFirstCellForMerge(i,r),this.cleanupAfterMerge(i),this.updateTableStructureAfterMerge(r),this.updateColgroupAfterMerge(r.startColumn,r.endColumn,u),this.updateSelectionAfterMerge(n,i[0]),this.executeCallback(n))},n.prototype.configureFirstCellForMerge=function(n,t){var i=n[0],u=i.parentElement.querySelectorAll(".e-cell-select"),r;t.startColumn<t.endColumn&&i.setAttribute("colspan",(t.endColumn-t.startColumn+1).toString());t.startRow<t.endRow&&i.setAttribute("rowspan",(t.endRow-t.startRow+1).toString());r=this.calculateMaxCellHeight(u);i.style.height=r+"px"},n.prototype.updateColgroupAfterMerge=function(n,t,i){var f=ou(this.curTable),s=this.isEntireColumnsMerged(i),r,e,o,u;if(n<t&&s>0){if(r=f.querySelectorAll("col"),e=parseFloat(r[n].style.width)||0,n<r.length)for(o=0;o<s;o++)u=n+1,u<r.length&&(e+=parseFloat(r[u].style.width),f.removeChild(r[u]),r=f.querySelectorAll("col"));r[n].style.width=e+"%"}},n.prototype.isEntireColumnsMerged=function(n){return n-de(this.curTable)},n.prototype.calculateMaxCellHeight=function(n){for(var r,t=0,i=0;i<n.length;i++)r=n[i].offsetHeight,r>t&&(t=r);return t},n.prototype.cleanupAfterMerge=function(n){for(var u,r=[],i=1;i<n.length;i++)r.push(n[i]);for(r.forEach(function(n){return t.detach(n)}),u=[],i=0;i<this.curTable.rows.length;i++)""===this.curTable.rows[i].innerHTML.trim()&&u.push(this.curTable.rows[i]);u.forEach(function(n){return t.detach(n)});p(this.curTable.querySelectorAll("table td, table th"),"e-multi-cells-select");p(this.curTable.querySelectorAll("table td, table th"),"e-cell-select-end")},n.prototype.updateTableStructureAfterMerge=function(n){this.updateRowSpanStyle(n.startRow,n.endRow,g(this.curTable));this.updateColSpanStyle(n.startColumn,n.endColumn,g(this.curTable))},n.prototype.updateSelectionAfterMerge=function(n,t){n.item.selection.setSelectionText(this.tableModel.getDocument(),n.item.selection.range.startContainer,n.item.selection.range.startContainer,0,0);this.parent.nodeSelection&&t&&this.parent.nodeSelection.setCursorPoint(this.tableModel.getDocument(),t,0)},n.prototype.updateColSpanStyle=function(n,t,i){var r,f=0,e=0,u=i;if(n<(t=Math.min(t,u[0].length-1))){for(r=n;r<=t&&(f=this.getEffectiveColspan(u[0][r],t-n+1),!this.isValidColspanStart(u[0],n,r,f)||(e=this.processRowsForColspan(u,r,f)));r++);e&&this.updateCellAttribute(u,e,"colspan",0,u.length-1,n,t)}},n.prototype.getEffectiveColspan=function(n,t){var i=n.getAttribute("colspan"),r=i?parseInt(i,10):1;return Math.min(r,t)},n.prototype.isValidColspanStart=function(n,t,i,r){var u=t<i&&n[i]===n[i-1],f=r>1&&n[i]===n[i+1];return!u&&f},n.prototype.processRowsForColspan=function(n,t,i){for(var u=i-1,r=1;r<n.length&&(n[r][t]===n[r-1][t]||(u=this.processRowCells(n,r,t,i,u)));r++);return u},n.prototype.processRowCells=function(n,t,i,r,u){for(var o,e=u,f=i;f<i+r;f++)if(o=parseInt(n[t][f].getAttribute("colspan"),10)||1,o>1&&n[t][f]===n[t][f+1])f+=e=Math.min(e,o-1);else if(0===(e=Math.max(0,e-1)))break;return e},n.prototype.updateRowSpanStyle=function(n,t,i){var r=i,f=0,u,e;if(n<(t=Math.min(t,r.length-1))){for(u=n;u<=t;u++)if(this.isValidRowspanStart(r,n,u,t)&&(e=this.getEffectiveRowspan(r[u][0],t-n+1),!(f=this.processColumnsForRowspan(r,u,e))))break;f&&this.updateCellAttribute(r,f,"rowspan",n,t,0,r[0].length-1)}},n.prototype.isValidRowspanStart=function(n,t,i,r){var s=!(t<i&&n[i][0]===n[i-1][0]),e=!!n[i][0],u=0,f,o;return e&&(f=n[i][0].getAttribute("rowspan"),u=f?parseInt(f,10):1,u=Math.min(u,r-t+1)),o=u>1&&i+1<=r&&n[i][0]===n[i+1][0],s&&e&&u>1&&o},n.prototype.getEffectiveRowspan=function(n,t){var i=n.getAttribute("rowspan"),r=i?parseInt(i,10):1;return Math.min(r,t)},n.prototype.processColumnsForRowspan=function(n,t,i){for(var u=i-1,r=1;r<n[0].length&&(n[t][r]===n[t][r-1]||(u=this.processColumnCells(n,t,r,i,u)));r++);return u},n.prototype.processColumnCells=function(n,t,i,r,u){for(var o,e=u,f=t;f<t+r;f++)if(o=parseInt(n[f][i].getAttribute("rowspan"),10)||1,o>1&&f+1<n.length&&n[f][i]===n[f+1][i])f+=e=Math.min(e,o-1);else if(0===(e=Math.max(0,e-1)))break;return e},n.prototype.updateCellAttribute=function(n,t,i,r,u,f,e){for(var s,h,c,o=r;o<=u;o++)for(s=f;s<=e;s++)if(n[o][s]){if("true"===n[o][s].dataset.processed)continue;h=parseInt(n[o][s].getAttribute(i),10)||1;this.shouldUpdateCellAttribute(n,o,s,r,f,h)&&(c=h-t,this.updateSpanAttribute(n[o][s],i,c),n[o][s].dataset.processed="true")}this.cleanupProcessedCells()},n.prototype.shouldUpdateCellAttribute=function(n,t,i,r,u,f){var e=r<t&&n[t][i]===n[t-1][i],o=u<i&&n[t][i]===n[t][i-1];return e||o||f>1},n.prototype.updateSpanAttribute=function(n,t,i){i>1?n.setAttribute(t,i.toString()):n.removeAttribute(t)},n.prototype.mergeCellContent=function(){for(var r,n=this.curTable.querySelectorAll(".e-cell-select"),t=this.isCellEmpty(n[0])?"":n[0].innerHTML,i=1;i<n.length;i++)r=n[i],this.isCellEmpty(r)||(t=this.appendCellContent(t,r.innerHTML));n[0].innerHTML=t},n.prototype.isCellEmpty=function(n){return"<br>"===n.innerHTML||""===n.innerHTML},n.prototype.appendCellContent=function(n,t){return n?n+"<br>"+t:t},n.prototype.getSelectedMinMaxIndexes=function(n){var r=this.curTable.querySelectorAll(".e-cell-select"),t,i;if(r.length>0){for(t=this.initializeMinMaxData(n),i=0;i<r.length;i++)t=this.updateMinMaxWithCell(t,r[i],n);return t}return null},n.prototype.initializeMinMaxData=function(n){return{startRow:n.length,endRow:0,startColumn:n[0].length,endColumn:0}},n.prototype.updateMinMaxWithCell=function(n,t,i){var r=pi(t,i),u=this.FindIndex(r[0],r[1],i);return{startRow:Math.min(r[0],n.startRow),endRow:Math.max(u[0],n.endRow),startColumn:Math.min(r[1],n.startColumn),endColumn:Math.max(u[1],n.endColumn)}},n.prototype.horizontalSplit=function(n){var e=n.item.selection.range.startContainer;if(this.curTable=t.closest(e.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");var i=this.prepareNewCellForSplit(),r=pi(this.activeCell,g(this.curTable)),u=g(this.curTable),f=this.getRowSpanValue(this.activeCell);f>1?this.splitCellWithRowspan(f,r,u,i):this.splitCellWithoutRowspan(r,u,i);this.executeCallback(n)}},n.prototype.prepareNewCellForSplit=function(){var n=this.activeCell.cloneNode(!0);return n.removeAttribute("class"),n.innerHTML="<br>",n},n.prototype.getRowSpanValue=function(n){return n.getAttribute("rowspan")?parseInt(n.getAttribute("rowspan"),10):1},n.prototype.splitCellWithRowspan=function(n,t,i,r){var u=Math.ceil(n/2),o=n-u,f,e,s;this.activeCell.style&&this.activeCell.style.height&&(f=this.activeCell.offsetHeight/n,this.activeCell.style.height=f*u+"px",r.style.height=f*o+"px");this.updateRowspanAttributes(this.activeCell,r,u,o);e=t[0]+u;s=this.findInsertionColumnIndex(i,e,t[1]);this.insertNewCellIntoRow(i,e,s,r)},n.prototype.updateRowspanAttributes=function(n,t,i,r){i>1?n.setAttribute("rowspan",i.toString()):n.removeAttribute("rowspan");r>1?t.setAttribute("rowspan",r.toString()):t.removeAttribute("rowspan")},n.prototype.findInsertionColumnIndex=function(n,t,i){for(var u,f,r=0===i?i:i-1;r>=0;){if(u=n[t][r]===n[t][r-1],f=t>0&&n[t][r]===n[t-1][r],!u&&!f)break;r--}return r},n.prototype.insertNewCellIntoRow=function(n,t,i,r){if(-1===i){var u=this.curTable.rows[t];u.firstChild?u.prepend(r):this.curTable.appendChild(r)}else n[t][i].insertAdjacentElement("afterend",r)},n.prototype.splitCellWithoutRowspan=function(n,i,r){var f,u,o,e;this.activeCell.style&&this.activeCell.style.height&&(f=this.activeCell.offsetHeight/2,this.activeCell.style.height=f+"px",r.style.height=f+"px");u=t.createElement("tr");u.appendChild(r);o=i[n[0]];(this.adjustRowspansInRow(o),this.activeCell.parentNode.style&&this.activeCell.parentNode.style.height)&&(e=parseFloat(this.activeCell.parentNode.style.height)/2,u.style.height=e+"%",this.activeCell.parentNode.style.height=e+"%");this.activeCell.parentNode.insertAdjacentElement("afterend",u)},n.prototype.adjustRowspansInRow=function(n){for(var i,t=0;t<=n.length-1;t++)n[t]!==n[t-1]&&n[t]!==this.activeCell&&(i=parseInt(n[t].getAttribute("rowspan"),10)||1,n[t].setAttribute("rowspan",(i+1).toString()))},n.prototype.verticalSplit=function(n){var o=n.item.selection.range.startContainer,r;if(this.curTable=t.closest(o.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){rf(this.curTable);r=de(this.curTable);this.activeCell=this.curTable.querySelector(".e-cell-select");var u,f=this.prepareNewCellForVerticalSplit(),i=pi(this.activeCell,g(this.curTable)),s=g(this.curTable),e=this.getColSpanValue(this.activeCell);u=e>1?this.splitCellWithColspan(e,i,f):this.splitCellWithoutColspan(i,s);this.activeCell.parentNode.insertBefore(f,this.activeCell.nextSibling);this.updateColgroupAfterVerticalSplit(this.curTable,i[1],u,r);this.executeCallback(n)}},n.prototype.updateColgroupAfterVerticalSplit=function(n,i,r,u){var o=ou(n),s=de(n),f=o.querySelectorAll("col"),e;i<f.length&&u<s&&(f[i].style.width=r.leftCellWidth+"%",e=t.createElement("col"),e.appendChild(t.createElement("br")),e.style.width=r.rightCellWidth+"%",f[i].parentNode.insertBefore(e,f[i].nextSibling))},n.prototype.prepareNewCellForVerticalSplit=function(){var n=this.activeCell.cloneNode(!0);return n.removeAttribute("class"),n.innerHTML="<br>",n},n.prototype.getColSpanValue=function(n){return parseInt(n.getAttribute("colspan"),10)||1},n.prototype.splitCellWithColspan=function(n,t,i){var r=Math.ceil(n/2),e=n-r,u=this.getColSizes(this.curTable),f=this.calculateLeftCellWidth(t[1],r,u),o=this.calculateRightCellWidth(t[1],r,n,u,f);return this.updateColspanAttributes(this.activeCell,i,r,e),{leftCellWidth:f,rightCellWidth:o}},n.prototype.calculateLeftCellWidth=function(n,t,i){return this.getSplitColWidth(n,n+t-1,i)},n.prototype.calculateRightCellWidth=function(n,t,i,r,u){var f=this.getSplitColWidth(n+t,n+i-1,r),e=it(this.activeCell.offsetWidth,this.curTable.offsetWidth);return e-u<f?e-u:f},n.prototype.updateColspanAttributes=function(n,t,i,r){i>1?n.setAttribute("colspan",i.toString()):n.removeAttribute("colspan");r>1?t.setAttribute("colspan",r.toString()):t.removeAttribute("colspan")},n.prototype.splitCellWithoutColspan=function(n,t){var i=it(this.activeCell.offsetWidth,this.curTable.offsetWidth)/2;return this.adjustColspansInColumn(t,n),{leftCellWidth:i,rightCellWidth:i}},n.prototype.adjustColspansInColumn=function(n,t){for(var u,r=this.curTable.rows,i=0;i<=r.length-1;i++)this.shouldAdjustColspanForCell(i,n,t)&&(u=n[i][t[1]],this.incrementColspan(u))},n.prototype.shouldAdjustColspanForCell=function(n,t,i){return(0===n||t[n][i[1]]!==t[n-1][i[1]])&&t[n][i[1]]!==this.activeCell},n.prototype.incrementColspan=function(n){var t=parseInt(n.getAttribute("colspan"),10)||1;n.setAttribute("colspan",(t+1).toString())},n.prototype.getSplitColWidth=function(n,t,i){for(var u=0,r=n;r<=t;r++)u+=i[r];return it(u,this.curTable.offsetWidth)},n.prototype.getColSizes=function(n){for(var r,i,f,e=n.rows[0].cells,o=0,u=0;u<e.length;u++)o+=e[u].colSpan;for(var s=new Array(o),h=new Map,t=0;t<n.rows.length;t++)for(r=0,i=0;i<n.rows[t].cells.length;i++)this.mapRowspanCells(n,h,t,i,r),f=fh(h,t,i),f>r&&(r=f),this.storeCellWidth(n,s,r,t,i),r+=1+n.rows[t].cells[i].colSpan-1;return s},n.prototype.mapRowspanCells=function(n,t,i,r,u){for(var e,f=1;f<n.rows[i].cells[r].rowSpan;f++)e=""+(i+f)+u,t.set(e,n.rows[i].cells[r])},n.prototype.storeCellWidth=function(n,t,i,r,u){var f=n.rows[r].cells[u].offsetWidth;(!t[i]||f<t[i])&&(t[i]=f)},n.prototype.FindIndex=function(n,t,i){for(var r=n+1,u=t+1;r<i.length;){if(i[r][t]!==i[n][t]){r--;break}r++}for(r===i.length&&r--;u<i[n].length;){if(i[n][u]!==i[n][t]){u--;break}u++}return u===i[n].length&&u--,[r,u]},n.prototype.isMergedCell=function(n){return parseInt(n.getAttribute("rowspan")||"1",10)>1||parseInt(n.getAttribute("colspan")||"1",10)>1},n.prototype.adjustBoundary=function(n,t,i,r,u,f,e){var o=pi(i[n][t],i),s=this.FindIndex(o[0],o[1],i);return s&&(r=Math.min(o[0],r),u=Math.max(s[0],u),f=Math.min(o[1],f),e=Math.max(s[1],e)),[r,u,f,e]},n.prototype.highlightCells=function(n,t,i,r,u){for(var h,l,a,v,y,f=n,e=t,o=i,s=r,c=f;c<=e;c++)for(this.isMergedCell(u[c][o])&&(f=(l=this.adjustBoundary(c,o,u,f,e,o,s))[0],e=l[1],o=l[2],s=l[3]),this.isMergedCell(u[c][s])&&(f=(a=this.adjustBoundary(c,s,u,f,e,o,s))[0],e=a[1],o=a[2],s=a[3]),h=o;h<=s;h++)this.isMergedCell(u[f][h])&&(f=(v=this.adjustBoundary(f,h,u,f,e,o,s))[0],e=v[1],o=v[2],s=v[3]),this.isMergedCell(u[e][h])&&(f=(y=this.adjustBoundary(e,h,u,f,e,o,s))[0],e=y[1],o=y[2],s=y[3]);return f===n&&e===t&&o===i&&s===r?{startRow:n,endRow:t,startColumn:i,endColumn:r}:this.highlightCells(f,e,o,s,u)},n.prototype.restoreRange=function(n){if(this.parent.userAgentData.isSafari())this.parent.nodeSelection.Clear(this.tableModel.getDocument());else{var t="TD"===n.nodeName||"TH"===n.nodeName;this.tableModel.getDocument().getSelection().rangeCount>0&&t&&this.parent.nodeSelection.setCursorPoint(this.tableModel.getDocument(),n,0)}},n.prototype.tableStyle=function(n){this.executeCallback(n)},n.prototype.tableMove=function(n){var i,r,u,f;if(this.activeCell=n.selectNode[0],this.activeCell){if(i=n.event.target,!this.isValidCellTarget(i)){if(r=null,(r=i.nodeType!==Node.ELEMENT_NODE?i.parentElement:i)&&"TD"!==r.tagName&&"TH"!==r.tagName&&(r=t.closest(r,"TD")||t.closest(r,"TH")),!r)return;i=r}if(this.curTable=t.closest(i,"table"),u=t.closest(this.activeCell,"table"),u.contains(this.curTable)&&(f=this.findContainingCell(u,this.curTable),f&&(this.curTable=u,i=f)),this.areCellsInSameTable(this.curTable,u)){var e=g(this.curTable),o=pi(this.activeCell,e),s=pi(i,e),h=this.clearPreviousSelection();this.isSameCellSelected(o,s,h)||(this.selectCellRange(o,s,e),i.classList.add("e-cell-select-end"),n.event.type&&n.event.preventDefault(),this.restoreRange(i))}}},n.prototype.findContainingCell=function(n,t){for(var f,r,e,u=n.rows,i=0;i<u.length;i++)for(f=u[i].cells,r=0;r<f.length;r++)if(e=f[r],e.contains(t))return e;return null},n.prototype.isValidCellTarget=function(n){if(!this.activeCell||!n)return!1;var t=this.activeCell.tagName,i=n.tagName;return"TD"===n.tagName||"TH"===n.tagName||t===i},n.prototype.areCellsInSameTable=function(n,i){return!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(i)&&n===i},n.prototype.clearPreviousSelection=function(){for(var t,n=this.curTable.querySelectorAll(".e-cell-select, .e-multi-cells-select, .e-cell-select-end"),i=n.length-1;i>=0;i--)t=i,this.activeCell!==n[t]&&p([n[t]],["e-cell-select"]),p([n[t]],["e-multi-cells-select"]),p([n[t]],["e-cell-select-end"]);return n},n.prototype.isSameCellSelected=function(n,t,i){return!(n[0]!==t[0]||n[1]!==t[1]||(i.length>1&&this.restoreRange(this.activeCell),0))},n.prototype.selectCellRange=function(n,t,i){for(var e,f,o,r=this.highlightCells(Math.min(n[0],t[0]),Math.max(n[0],t[0]),Math.min(n[1],t[1]),Math.max(n[1],t[1]),i),u=r.startRow;u<=r.endRow;u++)for(e=u,f=r.startColumn;f<=r.endColumn;f++)o=f,i[e][o].classList.add("e-cell-select"),i[e][o].classList.add("e-multi-cells-select")},n.prototype.destroy=function(){this.removeEventListener();this.resizeIconPositionTime&&(clearTimeout(this.resizeIconPositionTime),this.resizeIconPositionTime=null)},n.prototype.cellStyleCleanup=function(n){for(var s,r=n.split(";"),u=[],f=["background-color","vertical-align","text-align"],t=0;t<r.length;t++){for(var e=r[t],o=!0,i=0;i<f.length;i++)if(s=f[i],e.indexOf(s)>-1){o=!1;break}o&&u.push(e)}return u.join(";")},n.prototype.calMaxCol=function(n){var r,i,f,l,o,a;if(!(n&&n.rows&&0!==n.rows.length&&n.rows[0]&&n.rows[0].cells))return[];for(var s=n.rows[0].cells,h=0,e=0;e<s.length;e++)h+=s[e].colSpan;for(var u=new Array(h),c=new Map,t=0;t<n.rows.length;t++)for(r=0,i=0;i<n.rows[t].cells.length;i++){for(f=1;f<n.rows[t].cells[i].rowSpan;f++)l=""+(t+f)+r,c.set(l,n.rows[t].cells[i]);o=fh(c,t,i);o>r&&(r=o);a=n.rows[t].cells[i].offsetWidth;(!u[r]||a<u[r].offsetWidth)&&(u[r]=n.rows[t].cells[i]);r+=1+n.rows[t].cells[i].colSpan-1}return u},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={column:!1,row:!1,tableBox:!1}},n.prototype.calcPos=function(n){var f={top:0,left:0},u,s;if(!n)return f;var r=n.getBoundingClientRect(),h=n.ownerDocument,i=this.getOffsetParent(n,h),o=!1;if(i&&"TD"===i.nodeName&&"TABLE"===n.nodeName&&(i=t.closest(i,".e-rte-content"),o=!0),i&&i!==n&&1===i.nodeType&&(f=i.getBoundingClientRect()),o){o=!1;var e=this.iframeSettings.enable?h.documentElement:this.tableModel.getEditPanel(),c=e&&e.scrollTop||0,l=e&&e.scrollLeft||0;return{top:c>0?c+r.top-f.top:r.top-f.top,left:l>0?l+r.left-f.left:r.left-f.left}}if(i!==this.tableModel.getEditPanel()&&"TABLE"===n.nodeName){for(u=n;u&&u.parentElement!==this.tableModel.getEditPanel();)u=u.parentElement;return s=u.getBoundingClientRect(),{top:this.iframeSettings.enable?r.top:u.offsetTop+r.top-s.top,left:r.left-s.left+1}}return{top:n.offsetTop,left:n.offsetLeft}},n.prototype.getOffsetParent=function(n,t){for(var i=n.offsetParent||t.documentElement;i&&(i===t.body||i===t.documentElement)&&"static"===i.style.position;)i=i.parentNode;return i},n.prototype.getPointX=function(n){var t=n,i=n;return t.touches&&t.touches.length>0?t.touches[0].pageX:i.pageX},n.prototype.getPointY=function(n){var t=n,i=n;return t.touches&&t.touches.length>0?t.touches[0].pageY:i.pageY},n.prototype.getCurrentColWidth=function(n,t){var i=0,r;return n&&n.style&&""!==n.style.width?(r=n.style.width,i=-1!==r.indexOf("%")?parseFloat(r.split("%")[0]):it(n.offsetWidth,t)):n&&t>0&&(i=it(n.offsetWidth,t)),i},n.prototype.resetResizeHelper=function(n){var i=this.tableModel.rteElement.querySelectorAll(".e-table-rhelper.e-column-helper"),t;Array.from(i).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)});t=this.tableModel.rteElement.querySelectorAll(".e-table-rhelper.e-row-helper");Array.from(t).forEach(function(n){n.parentNode&&n.parentNode.removeChild(n)});0===parseInt(n.style.width,10)&&(n.style.width=n.offsetWidth+"px")},n.prototype.resizeStart=function(n){var i,r,u;this.parent&&this.tableModel&&!this.tableModel.readonly&&(t.Browser.isDevice&&this.resizeHelper(n),i=n.target,i&&(i.classList.contains(th)||i.classList.contains(ih)||i.classList.contains(be))&&((this.resetResizeHelper(this.curTable),n.preventDefault(),this.tableModel.preventDefaultResize(n),i.classList.contains(be))||(r=this.tableModel.getEditPanel().querySelector(".e-table-box"),t.isNullOrUndefined(r)||parseInt(i.getAttribute("data-col"),10)===this.calMaxCol(this.curTable).length||r.classList.add("e-hide")),(p(this.curTable.querySelectorAll("td,th"),nt),this.removeTableSelection(),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),this.resizeBtnStat=this.resizeBtnInit(),this.tableModel.hideTableQuickToolbar(),i.classList.contains(th)?this.handleColumnResize(i):i.classList.contains(ih)?this.handleRowResize(i):i.classList.contains(be)&&(this.resizeBtnStat.tableBox=!0),t.Browser.isDevice&&this.helper&&!this.helper.classList.contains("e-reicon"))?(this.helper.classList.add("e-reicon"),t.EventHandler.add(document,t.Browser.touchStartEvent,this.removeHelper,this),t.EventHandler.add(this.helper,t.Browser.touchStartEvent,this.resizeStart,this)):(u={event:n,requestType:"Table"},this.tableModel.resizeStart(u)),this.isResizeBind&&(t.EventHandler.add(this.tableModel.getDocument(),t.Browser.touchMoveEvent,this.resizing,this),t.EventHandler.add(this.tableModel.getDocument(),t.Browser.touchEndEvent,this.resizeEnd,this),this.isResizeBind=!1)))},n.prototype.handleColumnResize=function(n){this.resizeBtnStat.column=!0;rf(this.curTable);var i=n.getAttribute("data-col")||"0",t=parseInt(i,10);t===this.calMaxCol(this.curTable).length?(this.currentColumnResize="last",this.colIndex=t-1,this.columnEle=this.calMaxCol(this.curTable)[this.colIndex]):(this.currentColumnResize=0===t?"first":"middle",this.colIndex=t,this.columnEle=this.calMaxCol(this.curTable)[this.colIndex]);this.appendHelper(n)},n.prototype.appendHelper=function(n){var i="e-table-rhelper"+this.tableModel.getCssClass(!0);this.helper=t.createElement("div",{className:i});t.Browser.isDevice&&this.helper.classList.add("e-reicon");this.tableModel.getEditPanel().appendChild(this.helper);this.setHelperHeight(n);this.hideRowColumnAddIcons(n)},n.prototype.setHelperHeight=function(n){if(this.resizeBtnStat&&this.resizeBtnStat.column){this.helper.classList.add("e-column-helper");var t=n.style.height,i=parseFloat(n.style.left)+.5,r=n.style.top;this.helper.style.cssText="height: "+t+"; top: "+r+"; left: "+i+"px;"}else{this.helper.classList.add("e-row-helper");var u=n.style.width,f=parseFloat(n.style.top)-.5,e=n.style.left;this.helper.style.cssText="width: "+u+"; top: "+f+"px; left: "+e+";"}},n.prototype.updateHelper=function(){var n,t,i;this.helper&&(n=this.calcPos(this.curTable),(n=this.adjustPositionForScrollbar(n,this.curTable),this.resizeBtnStat&&this.resizeBtnStat.column)?(t=n.left+this.calcPos(this.columnEle).left+(this.tableModel.enableRtl?this.columnEle.getBoundingClientRect().width:0)+("last"!==this.currentColumnResize||this.tableModel.enableRtl?0:this.columnEle.offsetWidth)-1,this.helper.style.left=t+"px",this.helper.style.height=this.curTable.offsetHeight+"px"):(i=this.calcPos(this.rowEle).top+n.top+this.rowEle.offsetHeight-1,this.helper.style.top=i+"px",this.helper.style.width=this.curTable.offsetWidth+"px"))},n.prototype.handleRowResize=function(n){var t=n.getAttribute("data-row")||"0",i=parseInt(t,10);this.rowEle=this.curTable.rows[i];this.resizeBtnStat.row=!0;this.appendHelper(n)},n.prototype.addResizeEventHandlers=function(){t.EventHandler.add(this.tableModel.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart,this);t.Browser.isDevice||t.EventHandler.add(this.tableModel.getEditPanel(),"mouseover",this.resizeHelper,this)},n.prototype.resizeHelper=function(n){var i,f;if(this.parent&&this.tableModel&&!this.tableModel.readonly&&!(this.isTableMoveActive||n&&n.buttons&&n.buttons>0)&&(i=null,n&&n.targetTouches&&n.targetTouches.length>0?i=n.targetTouches[0].target:n&&n.target&&(i=n.target),i)){var r=t.closest(i,"table.e-rte-table, table.e-rte-paste-table, table.e-rte-custom-table"),u=this.tableModel.getEditPanel(),e=u.querySelectorAll(".e-table-box.e-rbox-select, .e-table-rhelper.e-column-helper, .e-table-rhelper.e-row-helper").length>0;(e||t.isNullOrUndefined(this.curTable)||t.isNullOrUndefined(r)||r===this.curTable||!u.contains(r)||(this.removeResizeElement(),this.removeHelper(n),this.cancelResizeAction()),this.isTableNode(i))||(f=t.closest(i,"td, th"),f&&(i=f));!e&&this.isTableNode(i)?(this.curTable=r&&u.contains(r)&&("TD"===i.nodeName||"TH"===i.nodeName)?r:i,this.removeResizeElement(),this.tableResizeEleCreation(this.curTable,n),this.handleRowColumnAddIcon(i,this.curTable)):this.hideRowColumnAddIcons(i)}},n.prototype.isTableNode=function(n){return"TABLE"===n.nodeName||"TD"===n.nodeName||"TH"===n.nodeName},n.prototype.handleRowColumnAddIcon=function(n,t){var r,u;if(n&&"TABLE"!==n.nodeName){var f=this.getAttributeValue(n,"rowspan",1),e=this.getAttributeValue(n,"colspan",1),i=pi(n,g(t));i.length<2||(r=i[0]+(f-1),u=i[1],0!==r&&0!==u||(this.updateRowInsertIcons(r,f),this.updateColumnInsertIcons(u,e)))}},n.prototype.getAttributeValue=function(n,t,i){if(!n.hasAttribute(t))return i;var r=n.getAttribute(t);return r?parseInt(r,10):i},n.prototype.createIcon=function(n){return t.createElement("span",{attrs:{unselectable:"on",contenteditable:"false"},className:"e-icons "+n})},n.prototype.updateRowInsertIcons=function(n,t){for(var u,f,r=this.tableModel.getEditPanel(),i=0;i<=t;i++)u='.e-rte-table-resize.e-tb-row-insert[data-row="'+(n-i)+'"]',f=r.querySelector(u),this.updateInsertIcon(f)},n.prototype.updateColumnInsertIcons=function(n,t){for(var u,f,r=this.tableModel.getEditPanel(),i=0;i<=t;i++)u='.e-rte-table-resize.e-tb-col-insert[data-col="'+(n+i)+'"]',f=r.querySelector(u),this.updateInsertIcon(f)},n.prototype.updateInsertIcon=function(n){if(n){var t=this.tableModel.enableRtl?"e-circle e-insert-cell-rtl":"e-circle",i=this.createIcon(t);n.appendChild(i);n.style.opacity="1"}},n.prototype.hideRowColumnAddIcons=function(n){if(n&&n.classList&&!n.classList.contains("e-circle-add")&&(!n.classList.contains("e-rte-table-resize")||this.tableModel.getEditPanel().contains(this.helper))){var i=this.tableModel.getEditPanel();i.querySelectorAll(".e-rte-table-resize .e-icons.e-circle-add").length>0?this.removeResizeElement():i.querySelectorAll(".e-rte-table-resize .e-icons.e-circle").forEach(function(n){var i=n.parentElement;i&&(i.style.opacity="0",t.detach(n))})}},n.prototype.resizeEnd=function(n){var f,e,o;if(this.parent){(this.resizeBtnInit(),this.isResizeBind=!0,t.EventHandler.remove(this.tableModel.getDocument(),t.Browser.touchMoveEvent,this.resizing),t.EventHandler.remove(this.tableModel.getDocument(),t.Browser.touchEndEvent,this.resizeEnd),this.tableModel.getEditPanel().querySelector(".e-table-box")&&this.tableModel.getEditPanel().contains(this.tableModel.getEditPanel().querySelector(".e-table-box")))&&(f=this.tableModel.getEditPanel().querySelector(".e-table-box"),t.isNullOrUndefined(f)||f.classList.remove("e-hide"),t.Browser.isDevice||(t.EventHandler.remove(this.tableModel.getEditPanel(),"mouseover",this.resizeHelper),t.EventHandler.add(this.tableModel.getEditPanel(),"mouseover",this.resizeHelper,this)),this.removeResizeElement());this.helper&&this.tableModel.getEditPanel().contains(this.helper)&&(t.detach(this.helper),this.helper=null);this.resetResizeHelper(this.curTable);this.pageX=null;this.pageY=null;for(var r=this.curTable.querySelectorAll("tr"),u=[],i=0;i<r.length;i++)e=parseFloat(r[i].clientHeight.toString())/parseFloat(this.curTable.clientHeight.toString())*100,u[i]=e;for(i=0;i<r.length;i++)r[i].style.height&&("THEAD"===r[i].parentElement.nodeName?(r[i].parentElement.style.height=u[i]+"%",r[i].style.height=u[i]+"%"):r[i].style.height=u[i]+"%");o={event:n,requestType:"table"};this.tableModel.resizeEnd(o);this.resizeEndTime=(new Date).getTime()}},n.prototype.cancelResizeAction=function(){this.isResizeBind=!0;t.EventHandler.remove(this.tableModel.getEditPanel(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.tableModel.getEditPanel(),t.Browser.touchEndEvent,this.resizeEnd);this.removeResizeElement()},n.prototype.removeResizeElement=function(){var r=this.tableModel.getEditPanel().querySelectorAll(".e-column-resize, .e-row-resize, .e-table-box, .e-table-rhelper, .e-tb-col-insert, .e-tb-row-insert"),u,n,f,i;if(r&&r.length>0)for(u=0;u<r.length;u++)n=r[u],n&&(n.classList&&(n.classList.contains("e-tb-col-insert")||n.classList.contains("e-tb-row-insert"))&&(f=n.querySelector(".e-circle-add"),f&&t.EventHandler.remove(f,"mousedown",this.handleIconMouseDown),this.removeInsertIconEvents(n)),t.detach(r[u]));i=this.parent.editableElement?this.parent.editableElement.lastChild:null;i&&"P"===i.nodeName&&(t.removeClass([i],["e-rte-last-paragraph"]),0===i.classList.length&&i.removeAttribute("class"))},n.prototype.removeHelper=function(n){var i=n?n.target:null,r=i?i.classList:null;r&&!r.contains("e-reicon")&&this.helper&&(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart),this.tableModel.getEditPanel().contains(this.helper)&&t.detach(this.helper),this.pageX=null,this.helper=null)},n.prototype.tableResizeEleCreation=function(n,i){var r,f;if(n&&i){this.tableModel.preventDefaultResize(i);var e=this.calMaxCol(this.curTable),h=this.getTableRowsWithoutRowspan(n),o=parseFloat(getComputedStyle(n).height)||0,s=parseFloat(getComputedStyle(n).width)||0,u=this.parent.editableElement?this.parent.editableElement.lastChild:null;u&&"P"===u.nodeName&&t.addClass([u],["e-rte-last-paragraph"]);r=this.calcPos(n);r=this.adjustPositionForScrollbar(r,n);f=g(n);this.createColumnResizers(e,o,r,f);this.createRowResizers(h,n,s,r,f);this.createResizeBox(e.length,r,s,o)}},n.prototype.adjustPositionForScrollbar=function(n,t){var i,f,e,r,u;if(!this.tableModel.enableRtl)return n;if(this.iframeSettings.enable){if((i=this.tableModel.getDocument(),!(i&&i.defaultView&&i.body&&i.body.id))||(f=this.getOffsetParent(t,i),!f||"TD"!==f.nodeName||"TABLE"!==t.nodeName))return n;var o=i.defaultView.parent&&i.defaultView.parent.window,s=o&&o.document,h=i.body.id.replace("-edit","");s&&h&&(e=s.querySelector("#"+h),e&&(r=e.clientWidth-i.body.clientWidth)>0&&(n.left-=r))}else u=this.tableModel.getEditPanel(),u&&(r=u.offsetWidth-u.clientWidth)>0&&this.tableModel.enableRtl&&(n.left-=r);return n},n.prototype.resizing=function(n){if(this.parent&&this.tableModel){var t={event:n,requestType:"table"};this.tableModel.resizing(t)}},n.prototype.perfomResizing=function(n){var c,nt=this.getPointX(n),tt=this.getPointY(n),i=this.tableModel.enableRtl?-(nt-this.pageX):nt-this.pageX,k=this.tableModel.enableRtl?-(tt-this.pageY):tt-this.pageY,v,ct,y,e,lt,rt,ut,p,ft,et,s,g,ot,w,st,at,vt,pt,b;this.pageX=nt;this.pageY=tt;var u,o=this.curTable.closest("td"),l=this.tableModel.getEditPanel().querySelector(".e-table-box"),r=parseInt(getComputedStyle(this.curTable).width,10),ht=isNaN(parseInt(this.curTable.style.height,10))?parseInt(getComputedStyle(this.curTable).height,10):parseInt(this.curTable.style.height,10),wt=+getComputedStyle(this.tableModel.getEditPanel()).paddingRight.match(/\d/g).join(""),d=this.tableModel.getEditPanel().offsetWidth-(this.tableModel.getEditPanel().offsetWidth-this.tableModel.getEditPanel().clientWidth)-2*wt,a=this.curTable&&this.curTable.parentElement;if(t.isNullOrUndefined(this.curTable.parentElement.closest("table"))||t.isNullOrUndefined(this.curTable.closest("td"))||!this.tableModel.getEditPanel().contains(this.curTable.closest("td"))?u=a&&a!==this.tableModel.getEditPanel()&&a.clientWidth!==d?a.clientWidth-2*+getComputedStyle(a).paddingRight.match(/\d/g).join(""):d:(v=this.curTable.closest("td"),ct=+getComputedStyle(v).paddingRight.match(/\d/g).join(""),u=v.offsetWidth-(v.offsetWidth-v.clientWidth)-2*ct),this.resizeBtnStat.column){if(this.curTable.closest("li")&&(u=this.curTable.closest("li").offsetWidth),e=this.curTable.querySelectorAll("colgroup > col"),y=""!==this.curTable.style.width&&this.curTable.style.width.includes("%")?parseFloat(this.curTable.style.width.split("%")[0]):this.getCurrentTableWidth(this.curTable.offsetWidth,this.tableModel.getEditPanel().offsetWidth),lt=e[this.colIndex],rt=this.getCurrentColWidth(lt,r),"first"===this.currentColumnResize){if(i-=.75,this.removeResizeElement(),o&&(c=this.curTable.getBoundingClientRect().right-this.calcPos(o).left,this.curTable.style.maxWidth=c+"px"),(0!==i&&5<rt||i<0)&&y<=100&&it(r-i,u)<=100){if(ut=e[this.colIndex],this.curTable.style.width=it(r-i,u)>100?"100%":it(r-i,u)+"%",p=y-it(r-i,u),ft=0,!(b=this.curTable.style.width.indexOf("%")>-1)&&this.curTable.offsetWidth>this.tableModel.getEditPanel().offsetWidth)return void(this.curTable.style.width=d+"px");if(b&&parseFloat(this.curTable.style.width.split("%")[0])>100)return void(this.curTable.style.width="100%");if(t.isNullOrUndefined(this.curTable.style.marginLeft)||""===this.curTable.style.marginLeft||(et=this.curTable.style.marginLeft.match(/[-+]?\d*\.\d+|\d+/),t.isNullOrUndefined(et)||(ft=parseFloat(et[0]))),s=ft+p,s&&s>100&&(s=100-parseFloat(this.curTable.style.width)),!this.curTable.classList.contains("e-rte-paste-table")&&s&&s<1)return this.curTable.style.marginLeft=null,void(this.curTable.style.width="100%");this.curTable.style.marginLeft="calc("+("100%"===this.curTable.style.width?0:s)+"%)";g=this.getCurrentColWidth(ut,r);ut.style.width=g-p+"%"}}else"last"===this.currentColumnResize?(i+=.75,this.removeResizeElement(),o&&(c=o.getBoundingClientRect().right-this.curTable.getBoundingClientRect().left,this.curTable.style.maxWidth=c+"px"),(0!==i&&5<rt||i>0)&&y<=100&&it(r+i,u)<=100)&&(ot=e[this.colIndex],this.curTable.style.width=it(r+i,u)>100?"100%":it(r+i,u)+"%",p=y-it(r+i,u),g=this.getCurrentColWidth(ot,r),ot.style.width=g-p+"%"):(w=e[this.colIndex].offsetWidth-i,st=e[this.colIndex].offsetWidth+e[this.colIndex-1].offsetWidth,st-w>20&&w>20&&(at=st-w,vt=w,e[this.colIndex-1].style.width=it(at,r)+"%",e[this.colIndex].style.width=it(vt,r)+"%"));this.updateHelper()}else if(this.resizeBtnStat.row){this.tableModel.preventDefaultResize(n);for(var yt=[],h=this.curTable.querySelectorAll("tr"),f=0;f<h.length;f++)this.rowEle!==h[f]&&(yt[f]=parseFloat(h[f].clientHeight.toString()));for(this.curTable.style.height=parseFloat(this.curTable.clientHeight.toString())+(k>0?0:k)+"px",f=0;f<h.length;f++)h[f].style.height=this.rowEle===h[f]?parseFloat(h[f].clientHeight.toString())+k+"px":yt[f]+"px";t.isNullOrUndefined(l)||(l.style.cssText="top: "+(this.calcPos(this.curTable).top+ht-4)+"px; left:"+(this.calcPos(this.curTable).left+(this.tableModel.enableRtl?0:r)-4)+"px;");this.updateHelper()}else if(this.resizeBtnStat.tableBox){if(o&&(pt=this.curTable.getBoundingClientRect().left-o.getBoundingClientRect().left,c=Math.abs(pt-o.getBoundingClientRect().width)-5,this.curTable.style.maxWidth=c+"px"),this.curTable.style.height=ht+k+"px",t.isNullOrUndefined(l)||(l.classList.add("e-rbox-select"),l.style.cssText="top: "+(this.calcPos(this.curTable).top+parseInt(getComputedStyle(this.curTable).height,10)-4)+"px; left:"+(this.calcPos(this.curTable).left+(this.tableModel.enableRtl?0:r)-4)+"px;"),this.curTable.closest("li")&&(u=this.curTable.closest("li").offsetWidth),(b=this.curTable.style.width.indexOf("%")>-1)&&parseFloat(this.curTable.style.width.split("%")[0])>100)return void(this.curTable.style.width="100%");if(!b&&this.curTable.offsetWidth>this.tableModel.getEditPanel().offsetWidth)return void(this.curTable.style.width=d+"px");this.curTable.style.width=b?it(r+i,u)+"%":r+i+"px"}},n.prototype.getCurrentTableWidth=function(n,t){return 0===t?0:n/t*100},n.prototype.getTableRowsWithoutRowspan=function(n){for(var i,r=[],t=0;t<n.rows.length;t++)for(i=0;i<n.rows[t].cells.length;i++)if(!n.rows[t].cells[i].hasAttribute("rowspan")){r.push(n.rows[t].cells[i]);break}return r},n.prototype.createColumnResizers=function(n,i,r,u){var s=this.tableModel.enableRtl,e=r.left,f,o,h;if(s)for(f=0;f<n.length;f++)e+=n[f].getBoundingClientRect().width;for(f=0;f<=n.length;f++)o=t.createElement("span",{attrs:{"data-col":f.toString(),unselectable:"on",contenteditable:"false"}}),(o.classList.add(bv,th),0!==f)&&(h=n[f-1],e+=s?-h.getBoundingClientRect().width:h.getBoundingClientRect().width),o.style.cssText="height:"+i+"px;width:4px;top:"+r.top+"px;left:"+(e-1.5)+"px;",this.tableModel.getEditPanel().appendChild(o),0===f||f!==n.length&&u[0][f]===u[0][f-1]||this.createTableInsertIcon({index:f,top:r.top,left:e,cellType:"column",allCells:u,isRTL:s})},n.prototype.createTableInsertIcon=function(n){var r,i="column"===n.cellType,f=i?"data-col":"data-row",o=i?ctt:htt,s=i?"e-column-resize":"e-row-resize",h=i?"e-column-helper":"e-row-helper",u=t.createElement("span",{attrs:(r={},r[f]=n.index.toString(),r.unselectable="on",r.contenteditable="false",r)}),e;u.classList.add(bv,o);n.isRTL&&u.classList.add("e-insert-cell-rtl");e="left:"+(i?n.left-12.5:n.left-14.3)+"px;top:"+(i?n.top-14.3:n.top-11.5)+"px;";u.style.cssText=u.style.cssText+e;this.attachInsertIconEvents(u,f,s,h,n.allCells,n.isRTL)},n.prototype.attachInsertIconEvents=function(n,i,r,u,f,e){t.EventHandler.add(n,"mouseover",this.handleIconMouseOver.bind(this,n,i,r,u,e,f),this);t.EventHandler.add(n,"mouseout",this.handleIconMouseOut.bind(this,n),this);var o=this.tableModel.getEditPanel();o&&o.appendChild(n)},n.prototype.handleIconMouseOver=function(n,i,r,u,f,e){var o=n.querySelector(".e-circle");o&&o.classList&&o.classList.contains("e-circle")&&(t.detach(o),n.style.cursor=this.isResizeBind?"pointer":"",this.isResizeBind&&this.handleInsertIconHover(n,i,r,u,f,e))},n.prototype.handleIconMouseOut=function(n,t){var i=t.relatedTarget;i&&!n.contains(i)&&"1"===n.style.opacity&&this.removeResizeElement()},n.prototype.handleIconMouseDown=function(n,t,i,r){var e;if(r&&this.parent&&this.parent.undoRedoManager){r.preventDefault();r.stopPropagation();this.removeResizeElement();this.parent.undoRedoManager.saveData();var o="data-col"===t,u=n.getAttribute(t),f=u?parseInt(u,10):-1;f<0||!i||(e=o?"column":"row",this.insertTableElement(e,f,i))}},n.prototype.removeInsertIconEvents=function(n){n&&(t.EventHandler.remove(n,"mouseover",this.handleIconMouseOver),t.EventHandler.remove(n,"mouseout",this.handleIconMouseOut))},n.prototype.handleInsertIconHover=function(n,i,r,u,f,e){var c=f?"e-circle-add e-insert-cell-rtl":"e-circle-add",s=this.createIcon(c),h,o;t.EventHandler.add(s,"mousedown",this.handleIconMouseDown.bind(this,n,i,e),this);n.appendChild(s);n.style.opacity="1";h="span["+i+'="'+n.getAttribute(i)+'"].e-rte-table-resize.'+r;o=this.tableModel.getEditPanel().querySelector(h);o&&(o.classList.add("e-table-rhelper",u),o.classList.remove("e-rte-table-resize",r),o.style.backgroundColor="","data-row"===i?this.applyRowResizeStyles(o,f):this.applyColumnResizeStyles(o))},n.prototype.applyRowResizeStyles=function(n,t){var i,r,u;(n.style.height="2px",t)||(i=this.parseNumericStyle(n.style.width),n.style.width=i-.5+"px",r=this.parseNumericStyle(n.style.left),n.style.left=r+.5+"px");u=this.parseNumericStyle(n.style.top);n.style.top=u+1+"px"},n.prototype.applyColumnResizeStyles=function(n){var t,i,r;n.style.width="2px";t=this.parseNumericStyle(n.style.height);n.style.height=t-.5+"px";i=this.parseNumericStyle(n.style.top);n.style.top=i+.5+"px";r=this.parseNumericStyle(n.style.left);n.style.left=r+1+"px"},n.prototype.parseNumericStyle=function(n){if(!n)return 0;var t=parseFloat(n);return isNaN(t)?0:t},n.prototype.insertTableElement=function(n,i,r){var u,f,e,s,o;!this.curTable||i<0||("column"===n?(u="InsertColumnLeft",i===r[0].length&&(u="InsertColumnRight",i-=1)):u="InsertRowAfter",f=this.tableModel.getDocument(),e="column"===n?r[0][i]:r[i][0],this.parent.nodeSelection.setCursorPoint(f,e,0),"row"===n&&(this.clearTableSelections(),t.addClass([e],nt)),s=this.parent.nodeSelection.getRange(f),o={item:{selection:this.parent.nodeSelection.save(s,f),subCommand:u,width:this.tableModel.tableSettings.width},callBack:null,subCommand:"",value:"",selector:""},"column"===n?this.insertColumn(o):this.insertRow(o),this.parent.undoRedoManager.saveData(),this.tableModel.enableUndo())},n.prototype.createRowResizers=function(n,i,r,u,f){for(var o,s,e=0;e<n.length;e++){o=n[e];s=t.createElement("span",{attrs:{"data-row":e.toString(),unselectable:"on",contenteditable:"false"}});s.classList.add(bv,ih);var h=t.isNullOrUndefined(i.getAttribute("cellspacing"))&&""===i.getAttribute("cellspacing")?this.calcPos(o).left:0,l=!(!o.classList||!o.classList.contains("e-multi-cells-select")),c=this.calcPos(o).top+(l?0:u.top)+o.getBoundingClientRect().height-1.5;s.style.cssText="width:"+r+"px;height:4px;top:"+c+"px;left:"+(h+u.left)+"px; z-index: 2";s.style.cssText="width:"+r+"px;height:4px;top:"+c+"px;left:"+(h+u.left)+"px;";this.tableModel.getEditPanel().appendChild(s);e+1!==n.length&&f[e][0]===f[e+1][0]||this.createTableInsertIcon({index:e,top:c,left:this.tableModel.enableRtl?r+h+u.left:h+u.left,cellType:"row",allCells:f,isRTL:this.tableModel.enableRtl})}},n.prototype.createResizeBox=function(n,i,r,u){var f=t.createElement("span",{className:be+this.tableModel.getCssClass(!0),attrs:{"data-col":n.toString(),unselectable:"on",contenteditable:"false"}});r=this.tableModel.enableRtl?0:r;f.style.cssText="top:"+(i.top+u-4)+"px;left:"+(i.left+r-4)+"px;";t.Browser.isDevice&&f.classList.add("e-rmob");this.tableModel.getEditPanel().appendChild(f)},n.prototype.removeTableSelection=function(){var n=this.tableModel.getEditPanel().querySelector("table.e-cell-select");n&&p([n],nt);this.removeAllFakeSelectionEles()},n.prototype.removeAllFakeSelectionEles=function(){var n=this.tableModel.getEditPanel().querySelectorAll(".e-table-fake-selection");n&&n.length>0&&n.forEach(function(n){t.detach(n)})},n.prototype.tableArrowNavigation=function(n,t,i){if(this.previousTableElement=i,!this.shouldSkipArrowNavigation(n,t)){n.preventDefault();this.clearSelectionState(i);var r=this.getTargetCellForArrowNavigation(n,i);r&&t.setSelectionText(this.tableModel.getDocument(),r,r,0,0)}},n.prototype.shouldSkipArrowNavigation=function(n,t){var i=t.range.startContainer;return!(40!==n.keyCode||3!==i.nodeType||!(i.nextSibling&&"BR"===i.nextSibling.nodeName||i.parentNode&&!i.parentNode.closest("td")))||!(38!==n.keyCode||3!==i.nodeType||!(i.previousSibling&&"BR"===i.previousSibling.nodeName||i.parentNode&&!i.parentNode.closest("td")))},n.prototype.clearSelectionState=function(n){p([n],nt);this.removeCellSelectClasses();this.removeTableSelection()},n.prototype.getTargetCellForArrowNavigation=function(n,t){return 40===n.keyCode?this.getNextRowCell(t):this.getPreviousRowCell(t)},n.prototype.getNextRowCell=function(n){var r=t.closest(n,"tr"),i=t.closest(n,"table"),u;return r&&r.nextElementSibling?(u=n.cellIndex,r.nextElementSibling.children[u]):i.tHead&&"TH"===n.nodeName&&i.rows.length>1?i.rows[1].cells[n.cellIndex]:i.nextSibling?i.nextSibling:n},n.prototype.getPreviousRowCell=function(n){var r=t.closest(n,"tr"),i=t.closest(n,"table"),u;return r&&r.previousElementSibling?(u=n.cellIndex,r.previousElementSibling.children[u]):i.tHead&&"TH"!==n.nodeName?i.tHead.rows[0].cells[n.cellIndex]:i.previousSibling?i.previousSibling:n},n.prototype.tabSelection=function(n,t,i){this.cleanTableRows(i);this.previousTableElement=i;var r=this.insideList(t.range);r||this.clearSelectionState(i);this.shouldSkipTabNavigation(n)||r||(n.preventDefault(),n.shiftKey||37===n.keyCode?this.handleBackwardTabNavigation(i,t,n):this.handleForwardTabNavigation(i,t,n))},n.prototype.cleanTableRows=function(n){var r=n.closest("table"),i,t;if(r)for(i=r.querySelectorAll("thead, tbody, tr"),t=0;t<i.length;t++)this.removeEmptyTextNodes(i[t])},n.prototype.removeEmptyTextNodes=function(n){for(var i,r=n.childNodes,t=r.length-1;t>=0;t--)i=r[t],i.nodeType===Node.TEXT_NODE&&""===i.nodeValue.trim()&&n.removeChild(i)},n.prototype.shouldSkipTabNavigation=function(n){return 37===n.keyCode||39===n.keyCode},n.prototype.insideList=function(n){var i=this.getBlockNodesInSelection(n),t=this.getListNodesFromBlocks(i);return t.length>1||t.length&&0===n.startOffset&&0===n.endOffset?(this.ensureInsideTableList=!0,!0):(this.ensureInsideTableList=!1,!1)},n.prototype.getListNodesFromBlocks=function(n){for(var t,u,i=[],r=0;r<n.length;r++)t=n[r],u=t.parentNode,"LI"===u.tagName?i.push(u):"LI"===t.tagName&&this.isSimpleListItem(t)&&i.push(t);return i},n.prototype.isSimpleListItem=function(n){if(!n.childNodes.length)return!1;var t=n.childNodes[0];return"P"!==t.tagName&&"OL"!==t.tagName&&"UL"!==t.tagName},n.prototype.getBlockNodesInSelection=function(n){var i=["DIV","SECTION","HEADER","FOOTER","ARTICLE","NAV","P","H1","H2","H3","BLOCKQUOTE","LI","PRE","TD","TH","FORM","FIELDSET","LEGEND","LABEL","TEXTAREA"],t=new Set;return n.collapsed?this.handleCollapsedRangeBlockNodes(n,i,t):this.handleExpandedRangeBlockNodes(n,i,t),Array.from(t)},n.prototype.handleCollapsedRangeBlockNodes=function(n,t,i){var r=this.getImmediateBlockNode(n.startContainer,t);r&&i.add(r)},n.prototype.handleExpandedRangeBlockNodes=function(n,t,i){for(var u,r=this.tableModel.getDocument().createTreeWalker(n.commonAncestorContainer,NodeFilter.SHOW_TEXT,{acceptNode:function(t){return n.intersectsNode(t)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_REJECT}});r.nextNode();)u=this.getImmediateBlockNode(r.currentNode,t),u&&i.add(u)},n.prototype.getImmediateBlockNode=function(n,t){for(var r,i=n.nodeType===Node.TEXT_NODE?n.parentNode:n;i&&i.nodeType===Node.ELEMENT_NODE;){if(r=i,t.indexOf(r.tagName)>-1)return r;i=i.parentNode}return null},n.prototype.handleForwardTabNavigation=function(n,i,r){var u=this.findNextElementForward(n);n===u&&"TH"===n.nodeName&&(u=t.closest(n,"table").rows[1].cells[0]);39===r.keyCode&&n===u&&(u=t.closest(n,"table").nextSibling);u&&this.setSelectionForElement(u,i);n===u&&39!==r.keyCode&&u&&this.addNewRowAndNavigate(n,u,i,r)},n.prototype.findNextElementForward=function(n){var r,i;return t.isNullOrUndefined(n.nextSibling)?(r=t.closest(n,"tr").nextSibling,!t.isNullOrUndefined(r))?r.childNodes[0]:(i=t.closest(n,"table").nextSibling,t.isNullOrUndefined(i)?n:"td"===i.nodeName.toLowerCase()?i:n):n.nextSibling},n.prototype.addNewRowAndNavigate=function(n,t,i,r){n.classList.add(nt);this.tableModel.addRow(i,r,!0);this.clearSelectionState(n);var u=t.parentElement;t=u.nextSibling?u.nextSibling.firstChild:u.firstChild;this.setSelectionForElement(t,i)},n.prototype.removeCellSelectClasses=function(){p(this.tableModel.getEditPanel().querySelectorAll("table td, table th"),kv);p(this.tableModel.getEditPanel().querySelectorAll("table td, table th"),dv);p(this.tableModel.getEditPanel().querySelectorAll("table td, table th"),nt)},n.prototype.handleBackwardTabNavigation=function(n,i,r){var u=this.findPreviousElementBackward(n),f;this.shouldNavigateToTableHeader(n,u)&&(f=t.closest(n,"table"),u=f.rows[0].cells[f.rows[0].cells.length-1]);n===u&&37===r.keyCode&&(u=t.closest(n,"table").previousSibling);(u=this.handleNestedTableNavigation(u))&&this.setSelectionForElement(u,i)},n.prototype.findPreviousElementBackward=function(n){var i,r;return t.isNullOrUndefined(n.previousSibling)?(i=t.closest(n,"tr").previousSibling,!t.isNullOrUndefined(i))?i.childNodes[i.childNodes.length-1]:(r=t.closest(n,"table").previousSibling,t.isNullOrUndefined(r)?n:"td"===r.nodeName.toLowerCase()?r:n):n.previousSibling},n.prototype.shouldNavigateToTableHeader=function(n,i){return n===i&&0===n.cellIndex&&t.closest(n,"table").tHead&&"TH"!==n.nodeName},n.prototype.handleNestedTableNavigation=function(n){if(!t.isNullOrUndefined(n)&&n.firstChild&&"TABLE"===n.firstChild.nodeName){for(var i=n;!t.isNullOrUndefined(i.firstChild)&&"TABLE"===i.firstChild.nodeName&&i.firstChild.rows.length>0&&i.firstChild.rows[0].cells.length>0;)i=i.firstChild.rows[0].cells[0];return i}return n},n.prototype.setSelectionForElement=function(n,i){""!==n.textContent.trim()&&t.closest(n,"td")?i.setSelectionNode(this.tableModel.getDocument(),n):i.setSelectionText(this.tableModel.getDocument(),n,n,0,0)},n.prototype.resetTableSelection=function(){var n=this.tableModel.getEditPanel().querySelectorAll(".e-cell-select-end");!t.isNullOrUndefined(n)&&n.length>0&&this.parent.nodeSelection.setSelectionNode(this.tableModel.getDocument(),this.curTable);this.removeCellSelectClasses();this.removeTableSelection()},n.prototype.handleShiftKeyTableSelection=function(n){var i=39===n.keyCode||37===n.keyCode||38===n.keyCode||40===n.keyCode;n.shiftKey&&i&&(this.keyDownEventInstance=n,t.EventHandler.add(this.tableModel.getDocument(),"selectionchange",this.tableCellsKeyboardSelection,this))},n.prototype.tableCellsKeyboardSelection=function(n){var r,f,u,i;if(t.EventHandler.remove(this.tableModel.getDocument(),"selectionchange",this.tableCellsKeyboardSelection),this.setupSelectionState(),r=this.tableModel.getEditPanel().querySelectorAll(".e-cell-select-end"),this.isTableMultiSelectActive()||!t.isNullOrUndefined(r)&&r.length>0)this.handleTableCellArrowNavigation(r);else{if(!this.curTable||!this.parent||!this.tableModel)return;if(f=this.curTable.querySelectorAll(".e-cell-select"),!f||f.length<1){if(u=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),!u)return;i=null;(i=u.endContainer.nodeType===Node.ELEMENT_NODE?u.endContainer:u.endContainer.parentElement||null)&&"TD"!==i.tagName&&"TH"!==i.tagName&&(i=t.closest(i,"TD")||t.closest(i,"TH")||null);i&&this.curTable.contains(i)&&this.moveToTargetCell(i)}}r.length>0&&(this.keyDownEventInstance.preventDefault(),n.preventDefault())},n.prototype.handleTableCellArrowNavigation=function(n){var i,r=g(this.curTable),e=pi(!t.isNullOrUndefined(n)&&n.length>0?n[0]:this.activeCell,r),u=e[0],f=e[1];switch(this.keyDownEventInstance.keyCode){case 39:i=this.handleRightArrowNavigation(r,u,f,n);break;case 37:i=this.handleLeftArrowNavigation(r,u,f,n);break;case 38:i=this.handleUpArrowNavigation(r,u,f);break;case 40:i=this.handleDownArrowNavigation(r,u,f)}i&&this.moveToTargetCell(i)},n.prototype.moveToTargetCell=function(n){this.parent.observer.notify("TABLE_MOVE",{event:{target:n},selectNode:[this.activeCell]})},n.prototype.setupSelectionState=function(){var n=this.tableModel.getEditPanel().querySelectorAll(".e-cell-select-end");!t.isNullOrUndefined(n)&&n.length>0&&(this.parent.nodeSelection.Clear(this.tableModel.getDocument()),this.parent.nodeSelection.setSelectionText(this.tableModel.getDocument(),n[0],n[0],0,0),this.parent.nodeSelection.setCursorPoint(this.tableModel.getDocument(),n[0],0))},n.prototype.isTableMultiSelectActive=function(){var r=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),e,f,n;if(t.isNullOrUndefined(r)||t.isNullOrUndefined(r.commonAncestorContainer)||t.isNullOrUndefined(this.activeCell)||(e=r.commonAncestorContainer,e.nodeType!==Node.ELEMENT_NODE))return!1;var s=e,u=s.tagName,c="TR"===u||"TBODY"===u||"THEAD"===u||"TABLE"===u;if("TABLE"===u){if(s.querySelectorAll(".e-cell-select, .e-multi-cells-select").length>1)return!0;var h=this.activeCell,o=r.startContainer,i=null;return((i=o.nodeType===Node.ELEMENT_NODE?o:o.parentElement)&&"TD"!==i.tagName&&"TH"!==i.tagName&&(i=t.closest(i,"td,th")),i&&i!==h)?!0:(f=r.endContainer,n=null,(n=f.nodeType===Node.ELEMENT_NODE?f:f.parentElement)&&"TD"!==n.tagName&&"TH"!==n.tagName&&(n=t.closest(n,"td,th")),null!==n&&n!==h)}return c},n.prototype.handleRightArrowNavigation=function(n,t,i,r){return i<n[0].length-1?n[t][i+1]:t<n.length-1?(0===r.length&&t<n.length-1&&(this.activeCell=n[t][0]),n[t+1][i]):(this.resetTableSelection(),null)},n.prototype.handleLeftArrowNavigation=function(n,t,i,r){return 0<i?n[t][i-1]:0<t?(0===r.length&&0<t&&(this.activeCell=n[t][n[t].length-1]),n[t-1][i]):(this.resetTableSelection(),null)},n.prototype.handleUpArrowNavigation=function(n,t,i){return 0<t?n[t-1][i]:(this.resetTableSelection(),null)},n.prototype.handleDownArrowNavigation=function(n,t,i){return t<n.length-1?n[t+1][i]:(this.resetTableSelection(),null)},n.prototype.isTableInteractionPossible=function(n){return!t.isNullOrUndefined(this.parent.nodeSelection)&&this.tableModel.getEditPanel()&&"KeyK"!==n.code},n.prototype.handleTableKeyboardInteractions=function(n){var i=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),t=this.parent.nodeSelection.getParentNodeCollection(i)[0];t=t&&"TD"!==t.tagName&&"TH"!==t.tagName?t.parentElement:t;this.handleTableDeleteOperations(n,i,t);t=this.findClosestTableCell(t);this.handleTableCellNavigation(n,i,t)},n.prototype.handleTableDeleteOperations=function(n,i,r){var f=8===n.keyCode||46===n.keyCode,e=n.ctrlKey&&88===n.keyCode,u;(f||e)&&(r&&"TBODY"===r.tagName?!t.isNullOrUndefined(this.parent)&&this.tableModel.getDocument()&&this.tableModel.getDocument()&&(u=this.parent.nodeSelection.save(i,this.tableModel.getDocument()),n.preventDefault(),this.tableModel.removeTable(u,n,!0)):r&&r.querySelectorAll("table").length>0&&(this.removeResizeElement(),this.tableModel.hideTableQuickToolbar()))},n.prototype.findClosestTableCell=function(n){if(n&&"TD"!==n.tagName&&"TH"!==n.tagName){var i=t.closest(n,"td");return!t.isNullOrUndefined(i)&&this.tableModel.getEditPanel().contains(i)?i:n}return n},n.prototype.handleTableCellNavigation=function(n,i,r){var f,u;if(r&&("TD"===r.tagName||"TH"===r.tagName)&&(f=this.tableModel.getEditPanel().querySelectorAll(".e-cell-select-end"),(t.isNullOrUndefined(this.activeCell)||this.activeCell!==r)&&!t.isNullOrUndefined(f)&&0===f.length&&(i.collapsed||9===n.keyCode)&&(this.activeCell=r),u=void 0,t.isNullOrUndefined(this.parent.nodeSelection)||(u=this.parent.nodeSelection.save(i,this.tableModel.getDocument())),!n.shiftKey||n.shiftKey&&9===n.keyCode))switch(n.keyCode){case 9:case 37:case 39:this.tabSelection(n,u,r);break;case 40:case 38:this.tableArrowNavigation(n,u,r)}},n.prototype.handleGlobalKeyboardShortcuts=function(n){n.ctrlKey&&"a"===n.key&&this.handleSelectAll()},n.prototype.handleSelectAll=function(){this.cancelResizeAction();p(this.tableModel.getEditPanel().querySelectorAll("."+nt),nt);this.removeTableSelection()},n.prototype.handleTableDeletion=function(n){var r="Delete"===n.code&&46===n.which,u="Backspace"===n.code&&8===n.which,t,i;if((r||u)&&"HTML"===this.tableModel.editorMode){if(t=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),this.isFakeTableSelectionElement(t.startContainer))return this.deleteTable(),void n.preventDefault();i=this.getAdjacentTableElement(t,r);i&&(this.updateTableSelection(i),n.preventDefault())}},n.prototype.updateTableSelection=function(n){t.addClass([n],"e-cell-select")},n.prototype.getAdjacentTableElement=function(n,t){var f;if(!n.collapsed||!t&&this.tableModel.isTableQuickToolbarVisible())return null;var u=this.getNodeCollection(n),r=n.collapsed&&this.tableModel.getEditPanel()===n.startContainer&&u&&u.length>0&&u[0]?u[0]:n.startContainer,i=this.getSelectedTableEle(u),e=this.getBrElement(n,u);return this.shouldSkipForMediaElement(r,n,t)?null:this.shouldSkipForTextNode(r,n,t)?null:((r&&r.nodeType===Node.ELEMENT_NODE&&"TABLE"===r.tagName&&(i=r),i)&&(f=this.parent.nodeSelection.getIndex(i),n.startOffset===f&&t||n.startOffset!==f&&!t||(i=null)),!i&&r&&(i=this.getAdjacentElementFromDom(r,e,t)),i&&i.nodeType===Node.ELEMENT_NODE&&"TABLE"===i.tagName?(this.setSelection(i,e),i):null)},n.prototype.shouldSkipForMediaElement=function(n,t,i){var r,u;return n&&n.nodeType===Node.ELEMENT_NODE&&("IMG"===n.tagName||n.querySelector("img")||"AUDIO"===n.tagName||n.querySelector("audio")||"VIDEO"===n.tagName||n.querySelector("video")||n.querySelector(".e-video-clickelem"))?(r=this.tableModel.getDocument().createRange(),r.collapse(!0),r.selectNodeContents(n),u=this.parent.nodeSelection.getIndex(n),i&&r.startOffset>=t.startOffset||!i&&("IMG"!==n.tagName&&r.startOffset!==t.startOffset||"IMG"===n.tagName&&u!==t.startOffset)):!1},n.prototype.shouldSkipForTextNode=function(n,t,i){if(n&&n.nodeType===Node.TEXT_NODE)if(i){if(t.endOffset!==t.endContainer.textContent.length&&t.endOffset!==t.endContainer.textContent.trim().length)return!0}else if(0!==t.startOffset)return!0;return!1},n.prototype.getAdjacentElementFromDom=function(n,t,i){for(var r,o,f,u=t||n.parentNode,e=n;u&&!r&&u.parentNode;)if(o=Array.from(u.childNodes),f=o.indexOf(e),-1!==f&&(i&&f<o.length-1||!i&&f>0)?r=o[i?f+1:f-1]:(r=i?u.nextSibling:u.previousSibling,e=u),this.isBrElement(t,n,r))t=e=u=r,r=null;else if(this.isEmptyTextNode(t,r))e=u=r.parentNode,r=null;else{if(this.isListElement(r)&&!(r=this.getAdjacentElementFromList(r,i)))return null;this.isLiElement(u,i)&&(r=u);u=u.parentNode}return r},n.prototype.isBrElement=function(n,t,i){return!n&&t.nodeType===Node.TEXT_NODE&&i&&i.tagName&&"BR"===i.tagName.toUpperCase()},n.prototype.isEmptyTextNode=function(n,i){return!n&&i&&!(i.nodeType===Node.ELEMENT_NODE&&"TABLE"===i.tagName)&&!t.isNullOrUndefined(i.textContent)&&!i.textContent.trim()},n.prototype.isListElement=function(n){return n&&n.tagName&&-1!==["UL","OL","LI"].indexOf(n.tagName.toUpperCase())},n.prototype.isLiElement=function(n,t){return n&&n.tagName&&"LI"===n.tagName.toUpperCase()&&!t},n.prototype.getAdjacentElementFromList=function(n,t){for(;n;){if(n.tagName&&-1===["UL","OL","LI"].indexOf(n.tagName.toUpperCase())){n.nodeType===Node.ELEMENT_NODE&&"TABLE"===n.tagName||(n=t?n.firstChild:n.lastChild);break}n=t?n.firstChild:n.lastChild}return n},n.prototype.getNodeCollection=function(n){var t=[],i;return n.collapsed&&this.tableModel.getEditPanel()===n.startContainer&&n.startContainer.childNodes.length>0?(i=Math.max(0,Math.min(n.startContainer.childNodes.length-1,n.endOffset-1)),t.push(n.startContainer.childNodes[i])):t=this.parent.nodeSelection.getNodeCollection(n),t},n.prototype.getSelectedTableEle=function(n){var t,r,i;if(n&&n.length>0)for(t=0,r=Array.from(n);t<r.length;t++)if(i=r[t],i&&"TABLE"===i.tagName)return i;return null},n.prototype.getBrElement=function(n,t){return"BR"===n.endContainer.tagName?n.endContainer:1===t.length&&t[0]&&"BR"===t[0].tagName?t[0]:null},n.prototype.setSelection=function(n,i){if(!n.classList.contains("e-cell-select")){this.parent.nodeSelection.Clear(this.tableModel.getDocument());i&&(i.parentNode&&1===i.parentNode.childNodes.length&&"BR"===i.parentNode.firstChild.nodeName?t.detach(i.parentNode):t.detach(i));var r=t.createElement("div",{className:"e-table-fake-selection"});r.setAttribute("contenteditable","false");this.tableModel.getEditPanel().appendChild(r);this.parent.nodeSelection.setSelectionNode(this.tableModel.getDocument(),r)}},n.prototype.deleteTable=function(){var i=this.tableModel.getEditPanel().querySelector("table.e-cell-select"),t,n;(this.removeResizeElement(),i)&&(t=document.createElement("br"),n=t,"DIV"===this.tableModel.enterKey?(n=document.createElement("div")).appendChild(t):"P"===this.tableModel.enterKey&&(n=document.createElement("p")).appendChild(t),i.parentNode.replaceChild(n,i),this.parent.nodeSelection.setSelectionText(this.tableModel.getDocument(),n,n,0,0),this.removeTableSelection())},n.prototype.isFakeTableSelectionElement=function(n){return n.nodeType===Node.ELEMENT_NODE&&"DIV"===n.nodeName&&n.classList.contains("e-table-fake-selection")},n.prototype.handleDeselectionOnTyping=function(n){var r=n.shiftKey&&"Enter"===n.key,u=-1!==sit.indexOf(n.key),f=n.key&&1===n.key.length,t,i;(r||u||f)&&(t=this.tableModel.getEditPanel().querySelector("table.e-cell-select"),t&&(39===n.keyCode||37===n.keyCode?this.parent.nodeSelection.setCursorPoint(this.tableModel.getDocument(),t,0):(i=t.querySelector("tr").cells[0],this.parent.nodeSelection.setSelectionText(this.tableModel.getDocument(),i,i,0,0)),this.removeTableSelection()))},n.prototype.setDefaultEmptyContent=function(){if(null===this.tableModel.getEditPanel().innerHTML||""===this.tableModel.getEditPanel().innerHTML){var n=this.tableModel.getEditPanel();n.innerHTML="DIV"===this.tableModel.enterKey?"<div><br/><\/div>":"BR"===this.tableModel.enterKey?"<br/>":"<p><br/><\/p>"}},n.prototype.tableModulekeyUp=function(n){if(!t.isNullOrUndefined(this.parent.nodeSelection)&&this.tableModel.getEditPanel()){var r=this.parent.nodeSelection.getRange(this.tableModel.getDocument()),i=this.getSelectedElementFromRange(r);i&&("TD"===i.tagName||"TH"===i.tagName)&&!i.classList.contains(nt)&&(r.collapsed||9===n.args.keyCode)&&i.classList.add(nt);this.handleTableElementTransition(i,n.args)}},n.prototype.getSelectedElementFromRange=function(n){var i=this.parent.nodeSelection.getParentNodeCollection(n)[0],r;return(i=i&&"TD"!==i.tagName&&"TH"!==i.tagName?i.parentElement:i)&&"TD"!==i.tagName&&"TH"!==i.tagName&&(r=t.closest(i,"td"),i=!t.isNullOrUndefined(r)&&this.tableModel.getEditPanel().contains(r)?r:i),i},n.prototype.handleTableElementTransition=function(n,i){var r=this.previousTableElement!==n,u=!t.isNullOrUndefined(this.previousTableElement),f=!i.shiftKey&&(39===i.keyCode||37===i.keyCode||38===i.keyCode||40===i.keyCode);r&&u&&f&&(p([this.previousTableElement],nt),this.removeTableSelection());(8===i.which&&"Backspace"===i.code||46===i.which&&"Delete"===i.code)&&this.tableModel.hideTableQuickToolbar()},n.prototype.cellSelect=function(n){if(n&&n.args){var t=this.getTargetCell(n);this.isShiftKeyTableMove(n,t)?this.handleShiftKeyTableMove(n):(this.resetTableSelectionState(n,t),this.isValidTableCell(t)&&this.setActiveCell(t))}},n.prototype.resetTableSelectionState=function(n,t){var i=n.args;this.tableModel.quickToolbarSettings.showOnRightClick&&3===i.which&&t.classList.contains(nt)||(this&&this.isTableMoveActive&&(this.unwireTableSelectionEvents(),this.isTableMoveActive=!1,this.activeCell=null),this.heightcheck(),this&&(this.removeCellSelectClasses(),this.removeTableSelection()))},n.prototype.unwireTableSelectionEvents=function(){this.curTable&&(t.EventHandler.remove(this.curTable,"mousemove",this.tableMouseMove),t.EventHandler.remove(this.tableModel.getDocument(),"mouseup",this.tableMouseUp),t.EventHandler.remove(this.tableModel.getDocument(),"dragend",this.tableMouseUp),t.EventHandler.remove(this.curTable,"mouseleave",this.tableMouseLeave))},n.prototype.tableMouseMove=function(n){this.parent.observer.notify("TABLE_MOVE",{event:n,selectNode:[this.activeCell]})},n.prototype.tableMouseUp=function(){this.unwireTableSelectionEvents();this.handleTableSelectionEnd();this.isTableMoveActive=!1},n.prototype.handleTableSelectionEnd=function(){this.activeCell&&!this.activeCell.classList.contains(nt)&&this.isTableMoveActive&&(this.activeCell=null)},n.prototype.tableMouseLeave=function(){t.Browser.isDevice||this.resetTableSelection()},n.prototype.getTargetCell=function(n){var i=n.args.target,r=t.closest(i,"td,th"),f="TD"!==i.nodeName,u=null!=r,e=u&&this.tableModel.getEditPanel().contains(r);return f&&u&&e?r:i},n.prototype.isShiftKeyTableMove=function(n,i){var r=n.args;return this&&!t.isNullOrUndefined(this.activeCell)&&r.shiftKey&&!t.isNullOrUndefined(i)&&!t.isNullOrUndefined(i.tagName)&&("TD"===i.tagName||"TH"===i.tagName)&&this.activeCell!==i},n.prototype.handleShiftKeyTableMove=function(n){this.parent.observer.notify("TABLE_MOVE",{event:n.args,selectNode:[this.activeCell]});n.args.preventDefault()},n.prototype.isValidTableCell=function(n){return n&&n.tagName&&("TD"===n.tagName||"TH"===n.tagName)},n.prototype.setActiveCell=function(n){t.addClass([n],nt);this.activeCell=n;this.curTable||(this.curTable=t.closest(n,"table"));this.wireTableSelectionEvents();this.isTableMoveActive=!0;this.removeResizeElement();this.helper&&this.tableModel.getEditPanel().contains(this.helper)&&t.detach(this.helper)},n.prototype.heightcheck=function(){var t=this.tableModel.getEditPanel().querySelector("td.e-cell-select"),n;t&&(n=t.querySelector("img"),n&&n.style&&"string"==typeof n.style.height&&-1!==n.style.height.indexOf("%")&&(t.style.height="inherit"))},n.prototype.wireTableSelectionEvents=function(){this.curTable&&(t.EventHandler.add(this.curTable,"mousemove",this.tableMouseMove,this),t.EventHandler.add(this.tableModel.getDocument(),"mouseup",this.tableMouseUp,this),t.EventHandler.add(this.tableModel.getDocument(),"dragend",this.tableMouseUp,this),t.EventHandler.add(this.curTable,"mouseleave",this.tableMouseLeave,this))},n.prototype.tableCellSelect=function(n){var r,i,u;if(n&&(r=n.target,r&&(i=r.parentElement,u=i?i.parentElement:null,i&&u))){var f=Array.prototype.slice.call(u.children).indexOf(i),e=Array.prototype.slice.call(i.children).indexOf(r),o=this.dlgDiv.querySelectorAll(".e-rte-tablecell");Array.prototype.forEach.call(o,function(n){var i=n.parentElement,r=i?i.parentElement:null,u,o;i&&r&&(u=Array.prototype.slice.call(r.children).indexOf(i),o=Array.prototype.slice.call(i.children).indexOf(n),p([n],"e-active"),u<=f&&o<=e&&t.addClass([n],"e-active"))});this.tblHeader.innerHTML=e+1+"x"+(f+1)}},n.prototype.tableCellLeave=function(){p(this.dlgDiv.querySelectorAll(".e-rte-tablecell"),"e-active");var n=this.dlgDiv.querySelector(".e-rte-tablecell");n&&t.addClass([n],"e-active");this.tblHeader.innerHTML="1x1"},n.prototype.afterKeyDown=function(){var n=this;this.curTable&&(this.resizeIconPositionTime=setTimeout(function(){n.updateResizeIconPosition()},1))},n.prototype.updateResizeIconPosition=function(){var n,i;this.curTable&&(n=this.tableModel.getEditPanel().querySelector(".e-table-box"),t.isNullOrUndefined(n)||(i=this.calcPos(this.curTable),n.style.cssText="top: "+(i.top+parseInt(getComputedStyle(this.curTable).height,10)-4)+"px; left:"+(i.left+(this.tableModel.enableRtl?0:parseInt(getComputedStyle(this.curTable).width,10))-4)+"px;"))},n}(),lh=function(){function n(n,i){this.tools={};this.parent=n;this.locator=i;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,ae,fv(this.parent.toolbarSettings.itemConfigs),!0):this.tools=ae}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar)},n.prototype.renderColorPickerInput=function(n,i){var r=this,e,u,o,f;this.initializeInstance();o=n.containerType;f=n.container;wb.forEach(function(s){var h,l,c;if(-1!==iv(s,n.items))switch(s){case"fontcolor":if(u={cssClass:pt+" "+lr+" "+un+" "+r.tools[s.toLocaleLowerCase()].icon+" "+ws+r.parent.getCssClass(!0),value:r.tools[s.toLocaleLowerCase()].value,command:r.tools[s.toLocaleLowerCase()].command,subCommand:r.tools[s.toLocaleLowerCase()].subCommand,element:t.select("#"+r.parent.getID()+"_"+o+"_FontColor",f),target:e},!t.isNullOrUndefined(u.element.nextElementSibling)&&u.element.nextElementSibling.classList.contains(lr))return;r.fontColorPicker=r.toolbarRenderer.renderColorPicker(u,"fontcolor",n.containerType);break;case"backgroundcolor":if(u={cssClass:pt+" "+lr+" "+fn+" "+r.tools[s.toLocaleLowerCase()].icon+" "+ws+r.parent.getCssClass(!0),value:r.tools[s.toLocaleLowerCase()].value,command:r.tools[s.toLocaleLowerCase()].command,subCommand:r.tools[s.toLocaleLowerCase()].subCommand,element:t.select("#"+r.parent.getID()+"_"+o+"_BackgroundColor",f),target:e},!t.isNullOrUndefined(u.element.nextElementSibling)&&u.element.nextElementSibling.classList.contains(lr))return;r.backgroundColorPicker=r.toolbarRenderer.renderColorPicker(u,"backgroundcolor",n.containerType);break;case"bordercolor":h=i.style.borderColor;h.match(/\d+/g)&&(l="#"+h.match(/\d+/g).slice(0,3).map(function(n){var t=parseInt(n,10).toString(16);return 1===t.length?"0"+t:t}).join(""),h=l);u={cssClass:pt+" "+lr+" "+tn+r.parent.getCssClass(!0),value:h||r.tools[s.toLocaleLowerCase()].value,command:r.tools[s.toLocaleLowerCase()].command,subCommand:r.tools[s.toLocaleLowerCase()].subCommand,element:f,target:e};r.borderColorPicker=r.toolbarRenderer.renderColorPicker(u,"bordercolor",n.containerType);break;case"tablebackgroundcolor":c=i.style.backgroundColor;c.match(/\d+/g)&&(l="#"+c.match(/\d+/g).slice(0,3).map(function(n){var t=parseInt(n,10).toString(16);return 1===t.length?"0"+t:t}).join(""),c=l);u={cssClass:pt+" "+lr+" "+rn+r.parent.getCssClass(!0),value:c||r.tools[s.toLocaleLowerCase()].value,command:r.tools[s.toLocaleLowerCase()].command,subCommand:r.tools[s.toLocaleLowerCase()].subCommand,element:f,target:e};r.tableBackgroundColorPicker=r.toolbarRenderer.renderColorPicker(u,"tablebackgroundcolor",n.containerType)}});this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.destroy=function(){this.removeEventListener();this.destroyColorPicker();this.fontColorPicker=null;this.backgroundColorPicker=null;this.borderColorPicker=null;this.tableBackgroundColorPicker=null;this.tools={}},n.prototype.destroyColorPicker=function(){this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy();this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy();this.borderColorPicker&&!this.borderColorPicker.isDestroyed&&this.borderColorPicker.destroy();this.tableBackgroundColorPicker&&!this.tableBackgroundColorPicker.isDestroyed&&this.tableBackgroundColorPicker.destroy()},n.prototype.setRtl=function(n){this.fontColorPicker&&this.fontColorPicker.setProperties({enableRtl:n.enableRtl});this.backgroundColorPicker&&this.backgroundColorPicker.setProperties({enableRtl:n.enableRtl});this.borderColorPicker&&this.borderColorPicker.setProperties({enableRtl:n.enableRtl});this.tableBackgroundColorPicker&&this.tableBackgroundColorPicker.setProperties({enableRtl:n.enableRtl})},n.prototype.setCssClass=function(n){this.updateCss(this.fontColorPicker,n);this.updateCss(this.backgroundColorPicker,n);this.updateCss(this.borderColorPicker,n);this.updateCss(this.tableBackgroundColorPicker,n)},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").replace("  "," ").trim()+" "+i.cssClass).trim()}))},n.prototype.addEventListener=function(){this.parent.on(fw,this.renderColorPickerInput,this);this.parent.on(ur,this.setRtl,this);this.parent.on(k,this.onPropertyChanged,this);this.parent.on(w,this.setCssClass,this);this.parent.on(ss,this.showColorPicker,this)},n.prototype.showColorPicker=function(n){t.isNullOrUndefined(this.fontColorPicker)||"fontcolor"!==n.toolbarClick?t.isNullOrUndefined(this.backgroundColorPicker)||"backgroundcolor"!==n.toolbarClick||this.backgroundColorPicker.toggle():this.fontColorPicker.toggle()},n.prototype.onPropertyChanged=function(n){for(var i,f,r,e,t=n.newProp,u=0,o=Object.keys(t);u<o.length;u++)switch(o[u]){case"fontColor":if(this.fontColorPicker)for(i=0,f=Object.keys(t.fontColor);i<f.length;i++)switch(f[i]){case"default":this.fontColorPicker.setProperties({value:t.fontColor.default});break;case"mode":this.fontColorPicker.setProperties({mode:t.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:t.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:t.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:t.fontColor.modeSwitcher});break;case"showRecentColors":this.fontColorPicker.setProperties({showRecentColors:t.fontColor.showRecentColors})}break;case"backgroundColor":if(this.backgroundColorPicker)for(r=0,e=Object.keys(t.backgroundColor);r<e.length;r++)switch(e[r]){case"default":this.backgroundColorPicker.setProperties({value:t.backgroundColor.default});break;case"mode":this.backgroundColorPicker.setProperties({mode:t.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:t.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:t.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:t.backgroundColor.modeSwitcher});break;case"showRecentColors":this.backgroundColorPicker.setProperties({showRecentColors:t.backgroundColor.showRecentColors})}}},n.prototype.removeEventListener=function(){this.parent.off(fw,this.renderColorPickerInput);this.parent.off(ur,this.setRtl);this.parent.off(k,this.onPropertyChanged);this.parent.off(w,this.setCssClass);this.parent.off(ss,this.showColorPicker)},n}(),cst=function(){function n(n,t){this.tableCellPaddingValue="";this.tableStyles={};this.parent=n;this.rteID=n.element.id;this.l10n=t.getService("rteLocale");this.tableBorderStyle=new kp(this.parent,t);this.tableBorderColor=new lh(this.parent,t);this.tableBackgroundColor=new lh(this.parent,t);this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener();this.isDestroyed=!1}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(dc,this.renderDlgContent,this),this.parent.on(a,this.afterRender,this),this.parent.on(er,this.afterRender,this),this.parent.on(fs,this.showDialog,this),this.parent.on(wl,this.closeDialog,this),this.parent.on(fr,this.clearDialogObj,this),this.parent.on(b,this.bindOnEnd,this),this.parent.on(df,this.updateTableProperty,this),this.parent.on(gr,this.docClick,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(vt,this.editAreaClickHandler,this),this.parent.on(gc,this.onToolbarAction,this),this.parent.on(ci,this.dropdownSelect,this),this.parent.on(pf,this.tableColorHandler,this),this.parent.on(y,this.keyDown,this),this.parent.on(kh,this.tableModulekeyUp,this),this.parent.on(gl,this.afterKeyDown,this),this.parent.on(w,this.setCssClass,this),this.parent.on(u,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.off(dc,this.renderDlgContent);this.parent.off(a,this.afterRender);this.parent.off(er,this.afterRender);this.parent.off(fs,this.showDialog);this.parent.off(wl,this.closeDialog);this.parent.off(fr,this.clearDialogObj);this.parent.off(b,this.bindOnEnd);this.parent.off(df,this.updateTableProperty);this.parent.off(gr,this.docClick);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(vt,this.editAreaClickHandler);this.tableObj&&this.parent.off(at,this.tableObj.cellSelect);this.parent.off(gc,this.onToolbarAction);this.parent.off(ci,this.dropdownSelect);this.parent.off(pf,this.tableColorHandler);this.parent.off(y,this.keyDown);this.parent.off(kh,this.tableModulekeyUp);this.parent.off(gl,this.afterKeyDown);this.parent.off(w,this.setCssClass);this.parent.off(u,this.destroy);"Markdown"!==this.parent.editorMode&&this.parent.formatter&&this.parent.formatter.editorManager.observer.off(uh,this.hideTableQuickToolbar)},n.prototype.bindOnEnd=function(){if("HTML"===this.parent.editorMode&&this.parent.formatter&&this.parent.formatter.editorManager&&this.contentModule){var n=this.getTableModelProperty();this.parent.formatter.editorManager.tableObj=this.tableObj=new hrt(this.parent.formatter.editorManager,n,this.parent.iframeSettings);this.tableObj&&(this.parent.tableSettings.resize&&this.tableObj.addResizeEventHandlers(),this.parent.off(at,this.tableObj.cellSelect),this.parent.on(at,this.tableObj.cellSelect,this.tableObj));this.parent.formatter&&this.parent.formatter.editorManager.observer.on(uh,this.hideTableQuickToolbar,this)}},n.prototype.getTableModelProperty=function(){var n=this;return{tableSettings:this.parent.tableSettings,rteElement:this.parent.element,readonly:this.parent.readonly,enableRtl:this.parent.enableRtl,enterKey:this.parent.enterKey,editorMode:this.parent.editorMode,quickToolbarSettings:this.parent.quickToolbarSettings,getCssClass:function(t){return n.parent.getCssClass(t)},preventDefaultResize:function(t){n.parent.preventDefaultResize(t)},getDocument:function(){return n.contentModule?n.contentModule.getDocument():n.parent.contentModule.getDocument()},getEditPanel:function(){return n.contentModule?n.contentModule.getEditPanel():n.parent.contentModule.getEditPanel()},resizeStart:function(t){n.resizeStart(t)},resizing:function(t){n.resizing(t)},resizeEnd:function(t){n.resizeEnd(t)},addRow:function(t,i,r){n.addRow(t,i,r)},hideTableQuickToolbar:function(){n.hideTableQuickToolbar()},removeTable:function(t,i,r){n.removeTable(t,i,r)},isTableQuickToolbarVisible:function(){return n.isTableQuickToolbarVisible()},enableUndo:function(){n.enableUndo()}}},n.prototype.updateTableProperty=function(){var n=this.getTableModelProperty();t.isNullOrUndefined(this.tableObj)||this.tableObj.updateTableModel(n)},n.prototype.resizeStart=function(n){var t=this;this.parent.contentModule.getDocument().activeElement!==this.parent.inputElement&&this.parent.inputElement.focus({preventScroll:!0});this.parent.trigger(cu,n,function(n){n.cancel&&t.tableObj&&t.tableObj.cancelResizeAction()})},n.prototype.enableUndo=function(){this.parent.formatter&&this.parent.formatter.enableUndo(this.parent)},n.prototype.resizing=function(n){var t=this;this.parent.trigger(ho,n,function(i){t.tableObj&&(i.cancel?t.tableObj.cancelResizeAction():t.tableObj.perfomResizing(n.event))})},n.prototype.isTableQuickToolbarVisible=function(){return this.quickToolObj&&this.quickToolObj.tableQTBar&&document.body.contains(this.quickToolObj.tableQTBar.element)},n.prototype.resizeEnd=function(n){this.parent.trigger(co,n)},n.prototype.afterRender=function(){t.isNullOrUndefined(this.contentModule)&&(this.contentModule=this.rendererFactory.getRenderer(o.Content),this.bindOnEnd())},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){this.popupObj&&n.cssClass&&(t.isNullOrUndefined(n.oldCssClass)||p([this.popupObj.element],n.oldCssClass),t.addClass([this.popupObj.element],n.cssClass));this.updateCss(this.createTableButton,n);this.updateCss(this.editdlgObj,n);for(var r=[this.columnTextBox,this.rowTextBox,this.tableWidthNum,this.tableCellPadding,this.tableCellSpacing,this.tableBorderWidth],i=0;i<r.length;i++)r[i]&&this.updateCss(r[i],n)},n.prototype.dropdownSelect=function(n){var r=this,i=n.item,u,t;if("BorderStyle"===i.command&&this.parent.trigger(l,{cancel:!1,requestType:"BorderStyle"},function(n){n.cancel||(r.parent.contentModule.getPanel().ownerDocument.getElementById(r.parent.getID()+"_borderStyle").firstChild.innerHTML='<span class="e-rte-dropdown-btn-text" >'+i.text+"<\/span>",r.tableElement.style.cssText+="border-style: "+i.subCommand.toLowerCase()+";",r.parent.trigger(ct,{requestType:"BorderStyle"}))}),document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Table"===i.command){u=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());t={args:n,selection:this.parent.formatter.editorManager.nodeSelection.save(u,this.contentModule.getDocument()),selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(u)};switch(i.subCommand){case"InsertRowBefore":case"InsertRowAfter":this.addRow(t.selection,n);break;case"InsertColumnLeft":case"InsertColumnRight":this.addColumn(t.selection,n);break;case"DeleteColumn":case"DeleteRow":this.removeRowColumn(t.selection,n);break;case"AlignTop":case"AlignMiddle":case"AlignBottom":this.verticalAlign(t,n);break;case"Dashed":case"Alternate":case"Custom":this.parent.formatter.process(this.parent,n,t,{command:i.command,subCommand:n.item.subCommand});break;case"Merge":case"VerticalSplit":case"HorizontalSplit":this.UpdateCells(t.selection,n)}}},n.prototype.UpdateCells=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,subCommand:t.item.subCommand});this.hideTableQuickToolbar()},n.prototype.keyDown=function(n){var t=n.args;this.handleSpecialActions(t,n);this.tableObj&&(this.tableObj.isTableInteractionPossible(t)&&this.tableObj.handleTableKeyboardInteractions(t),"HTML"===this.parent.editorMode&&this.tableObj.handleShiftKeyTableSelection(t),this.tableObj.handleGlobalKeyboardShortcuts(t),this.tableObj.handleTableDeletion(t),this.tableObj.handleDeselectionOnTyping(t))},n.prototype.handleSpecialActions=function(n,t){switch(n.action){case"insert-table":"HTML"===this.parent.editorMode?this.openDialog(!0,t):"Markdown"===this.parent.editorMode&&this.parent.formatter.process(this.parent,null,n);n.preventDefault()}},n.prototype.selectionEventTriggers=function(){var n=this.parent.contentModule.getDocument().getSelection(),i=n&&0!==n.rangeCount&&n.getRangeAt(0),r,u;if(i&&(r="#text"===i.startContainer.nodeName?i.startContainer.parentElement:i.startContainer,r.closest("table")&&(u=r.closest(".e-multi-cells-select"),!t.isNullOrUndefined(u)))){var e=r.closest("table"),f=this.tableObj.extractSelectedTable(e,!1),o={selectedContent:f?f.outerHTML:null,selection:n,editorMode:this.parent.editorMode};this.parent.trigger(yw,o)}},n.prototype.tableModulekeyUp=function(n){var t=this;this.tableObj&&this.tableObj.tableModulekeyUp(n);this.selectionTimeout&&(clearTimeout(this.selectionTimeout),this.selectionTimeout=null);this.parent.element&&this.parent.element.dataset&&"true"===this.parent.element.dataset.rteUnitTesting?this.selectionEventTriggers():this.selectionTimeout=window.setTimeout(function(){t.selectionEventTriggers()},600)},n.prototype.openDialog=function(n,t){if(n||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var i=this.parent.contentModule.getDocument(),r=this.parent.formatter.editorManager.nodeSelection.getRange(i),u=this.parent.formatter.editorManager.nodeSelection.save(r,i),f={originalEvent:t?t.args:{action:"insert-table"},item:{command:"Table",subCommand:"CreateTable"},name:n?null:"showDialog"};this.insertTableDialog({self:this,args:f,selection:u})}},n.prototype.showDialog=function(){this.openDialog(!1);this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.closeDialog=function(){this.editdlgObj&&this.editdlgObj.hide({returnValue:!0})},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"TableHeader":this.tableHeader(n.selection,n.args);break;case"TableRemove":this.removeTable(n.selection,n.args);break;case"TableEditProperties":if(this.tableElement=t.closest(n.selectParent[0],"table"),this.tableElement){var i=this.tableElement.style;this.tableCellPaddingValue=this.tableElement.querySelector("td")?this.tableElement.querySelector("td").style.padding:"";this.tableStyles={borderStyle:i.borderStyle,borderColor:i.borderColor,backgroundColor:i.backgroundColor,borderWidth:i.borderWidth,width:i.width,borderSpacing:i.borderSpacing,borderCollapse:i.borderCollapse};this.tableElement.style.borderWidth||(this.tableElement.style.cssText+="border-width: 1px;");this.tableElement.style.borderStyle||(this.tableElement.style.cssText+="border-style: double;")}this.editTable(n)}},n.prototype.verticalAlign=function(n,i){var r=t.closest(n.selectParent[0],"th")||t.closest(n.selectParent[0],"td");r&&this.parent.formatter.process(this.parent,i,i,{tableCell:r,subCommand:i.item.subCommand})},n.prototype.hideTableQuickToolbar=function(){this.quickToolObj&&void 0!==this.quickToolObj.tableQTBar&&this.quickToolObj.tableQTBar&&void 0!==this.quickToolObj.tableQTBar.element&&document.body.contains(this.quickToolObj.tableQTBar.element)&&this.quickToolObj.tableQTBar.hidePopup()},n.prototype.tableHeader=function(n,t){t&&"object"==typeof t&&this.parent.formatter.process(this.parent,t,t.originalEvent,{selection:n,subCommand:void 0!==t.item?t.item.subCommand:void 0})},n.prototype.getAnchorNode=function(n){return n&&"object"==typeof n&&t.closest(n,"a")||n},n.prototype.editAreaClickHandler=function(n){var t,i,r;this.shouldSkipQuickToolbar(n)||("HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&(this.quickToolObj=this.parent.quickToolbarModule,t=n.args,i=t.target,this.contentModule=this.rendererFactory.getRenderer(o.Content),r=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),this.shouldShowQuickToolbar(t,i,r)?this.showTableQuickToolbar(n,t,i,r):this.hideTableQuickToolbar()),n.args,this.selectionEventTriggers())},n.prototype.shouldSkipQuickToolbar=function(n){var u,i,r;return this.parent.readonly?!0:(u=n.args.target,!t.isNullOrUndefined(t.closest(u,".e-img-caption")))?!0:(i=n.args,r=this.parent.quickToolbarSettings.showOnRightClick,2===i.which||r&&1===i.which||!r&&3===i.which)},n.prototype.shouldShowQuickToolbar=function(n,i,r){var u=t.closest(i,"table"),e=this.parent.getRange().startContainer.parentElement,o=this.parent.getRange().endContainer.parentElement,s=this.getAnchorNode(i),f="macOS"===this.parent.userAgentData.getPlatform()&&3===n.which,h=r.startContainer===r.endContainer&&r.startOffset===r.endOffset,c=(new Date).getTime();return i&&"A"!==i.nodeName&&"A"!==s.nodeName&&"IMG"!==i.nodeName&&"VIDEO"!==i.nodeName&&"AUDIO"!==i.nodeName&&!i.classList.contains(cr)&&(e===o||f)&&("TD"===i.nodeName||"TH"===i.nodeName||"TABLE"===i.nodeName||u&&this.parent.contentModule.getEditPanel().contains(u))&&!(3===r.startContainer.nodeType&&!r.collapsed&&!f)&&this.tableObj&&c-this.tableObj.resizeEndTime>100&&(h||u.querySelectorAll(".e-multi-cells-select").length>0)},n.prototype.showTableQuickToolbar=function(n,t,i,r){this.parent.formatter.editorManager.nodeSelection.save(r,this.contentModule.getDocument());this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument());this.parent.formatter.editorManager.nodeSelection.restore();this.quickToolObj.tableQTBar.showPopup(i,n.args)},n.prototype.tableCellClick=function(n){var i=n.target,t,r;if(i&&(t=i.parentElement,r=t?t.parentElement:null,t&&r)){var f=Array.prototype.slice.call(r.children).indexOf(t)+1,e=Array.prototype.slice.call(t.children).indexOf(i)+1,u=this.self;"function"==typeof u.tableInsert&&u.tableInsert(f,e,n,this)}},n.prototype.tableInsert=function(n,t,i,r){var u=r&&r.self?r.self:this,e=window.scrollX,o=window.scrollY,f;this.prepareSelectionForTableInsert(r,u);this.cleanupTableCreationEvents(i,u);f=this.createTableConfiguration(n,t,u,r);this.insertTableIntoEditor(f,r,u);window.scrollTo(e,o);this.setupTableCellSelection(u)},n.prototype.prepareSelectionForTableInsert=function(n,t){var i,r,u;n&&n.selection&&n.selection.range&&(i=n.selection.range.startContainer,"P"!==i.nodeName||""!==i.textContent.trim()||i.childNodes.length>0||(i.innerHTML="<br>"),r=i.parentNode,this.isHtmlEditorOutsideEditableRegion(t,r)&&(t.contentModule.getEditPanel().focus(),u=t.parent.formatter.editorManager.nodeSelection.getRange(t.contentModule.getDocument()),n.selection=t.parent.formatter.editorManager.nodeSelection.save(u,t.contentModule.getDocument())))},n.prototype.isHtmlEditorOutsideEditableRegion=function(n,i){if(!n.parent||"HTML"!==n.parent.editorMode)return!1;var r=n.parent.iframeSettings.enable&&i.ownerDocument&&i.ownerDocument.querySelector("body")&&!et(i.ownerDocument.querySelector("body"),"e-lib"),u=n.contentModule.getPanel().id,f=!n.parent.iframeSettings.enable&&t.isNullOrUndefined(t.closest(i,'[id="'+u+'"]'));return r||f},n.prototype.cleanupTableCreationEvents=function(n,i){var u,o,f,e,r;if(i.popupObj){if(u=n.target,u&&u.parentElement&&u.parentElement.parentElement)for(o=Array.prototype.slice.call(u.parentElement.parentElement.children),f=0;f<o.length;f++)for(t.EventHandler.remove(o[f],"mouseleave",this.tableObj.tableCellLeave),e=Array.prototype.slice.call(o[f].children),r=0;r<e.length;r++)t.EventHandler.remove(e[r],"mousemove",this.tableObj.tableCellSelect),t.EventHandler.remove(e[r],"mouseup",this.tableCellClick),this.parent.toolbarSettings.type===wt.Popup&&t.EventHandler.remove(e[r],"click",this.tableCellClick);i.popupObj.hide()}i.editdlgObj&&i.editdlgObj.hide();t.isNullOrUndefined(i.parent)||i.parent.element.querySelector(".e-content")&&i.parent.element.querySelector(".e-content").focus()},n.prototype.createTableConfiguration=function(n,t,i,r){return{rows:n,columns:t,width:{minWidth:i.parent.tableSettings.minWidth,maxWidth:i.parent.tableSettings.maxWidth,width:i.parent.tableSettings.width},selection:r.selection}},n.prototype.insertTableIntoEditor=function(n,t,i){i.parent.formatter.process(i.parent,t.args,t.args.originalEvent,n);i.contentModule.getEditPanel().focus()},n.prototype.setupTableCellSelection=function(n){var i,r;if(n.tableObj){n.parent.on(at,n.tableObj.cellSelect,n.tableObj);i=n.parent.formatter.editorManager.nodeSelection.get(n.contentModule.getDocument());t.isNullOrUndefined(i)||t.isNullOrUndefined(i.anchorNode)||i.anchorNode.nodeType!==Node.ELEMENT_NODE||(r=i.anchorNode,("TD"===r.tagName||"TH"===r.tagName)&&(n.tableObj.curTable=t.closest(i.anchorNode,"table"),n.tableObj.activeCell=i.anchorNode))}},n.prototype.addRow=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"InsertRowAfter"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t,u)},n.prototype.addColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,width:this.parent.tableSettings.width,subCommand:t.item.subCommand})},n.prototype.removeRowColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,subCommand:t.item.subCommand});this.hideTableQuickToolbar()},n.prototype.removeTable=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"TableRemove"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t.originalEvent,u);this.contentModule.getEditPanel().focus();this.tableObj&&(this.tableObj.setDefaultEmptyContent(),this.tableObj.removeResizeElement());this.hideTableQuickToolbar()},n.prototype.renderDlgContent=function(n){var i=this,o=n.args.originalEvent.target,e,f,u,r;t.Browser.isDevice||this.parent.inlineMode.enable||!t.isNullOrUndefined(t.closest(o,".e-text-quicktoolbar"))?this.insertTableDialog(n):this.popupObj?this.popupObj.hide():(this.hideTableQuickToolbar(),e=this.l10n.getConstant("inserttablebtn"),this.dlgDiv=this.parent.createElement("div",{className:"e-rte-table-popup"+this.parent.getCssClass(!0),id:this.rteID+"_table"}),this.createTablePopupBoundFn=this.createTablePopupKeyDown.bind(this),this.dlgDiv.addEventListener("keydown",this.createTablePopupBoundFn),this.tblHeader=this.parent.createElement("div",{className:"e-rte-popup-header"+this.parent.getCssClass(!0)}),this.tblHeader.innerHTML="1X1",this.tableObj&&(this.tableObj.tblHeader=this.tblHeader,this.tableObj.dlgDiv=this.dlgDiv),this.dlgDiv.appendChild(this.tblHeader),f=this.parent.createElement("div",{className:"e-rte-table-span"+this.parent.getCssClass(!0)}),this.drawTable(f,n),this.dlgDiv.appendChild(f),this.dlgDiv.appendChild(this.parent.createElement("span",{className:"e-span-border"+this.parent.getCssClass(!0)})),u=this.parent.createElement("button",{className:"e-insert-table-btn"+this.parent.getCssClass(!0),id:this.rteID+"_insertTable",attrs:{type:"button",tabindex:"0"}}),t.isNullOrUndefined(this.parent.getToolbarElement().querySelector(".e-expended-nav"))||this.parent.getToolbarElement().querySelector(".e-expended-nav").setAttribute("tabindex","1"),this.dlgDiv.appendChild(u),this.createTableButton=new rr.Button({iconCss:"e-icons e-create-table",content:e,cssClass:"e-flat"+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale}),this.createTableButton.isStringTemplate=!0,this.createTableButton.appendTo(u),t.EventHandler.add(u,"click",this.insertTableDialog,{self:this,args:n.args,selection:n.selection}),this.parent.getToolbar().parentElement.appendChild(this.dlgDiv),r=n.args.originalEvent.target,r=r.classList.contains("e-toolbar-item")?r.firstChild:r.parentElement,this.popupObj=new wi.Popup(this.dlgDiv,{targetType:"relative",relateTo:r,collision:{X:"fit",Y:"none"},offsetY:8,viewPortElement:this.parent.element,position:{X:"left",Y:"bottom"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){t.EventHandler.remove(u,"click",i.insertTableDialog);i.dlgDiv.removeEventListener("keydown",i.createTablePopupBoundFn);t.detach(u);i.createTableButton&&!i.createTableButton.isDestroyed&&(i.createTableButton.destroy(),i.createTableButton.element=null,i.createTableButton=null);i.parent.isBlur=!1;i.popupObj.element.parentElement.style.zIndex="";i.popupObj.destroy();t.detach(i.popupObj.element);i.popupObj=null}}),t.addClass([this.popupObj.element],"e-popup-open"),this.popupObj.element.parentElement.style.zIndex="11",t.isNullOrUndefined(this.parent.cssClass)||t.addClass([this.popupObj.element],this.parent.getCssClass()),this.popupObj.refreshPosition(r),this.positionDialogue(r),u.focus())},n.prototype.positionDialogue=function(n){var t,e=window.innerHeight,o=this.popupObj.element.getBoundingClientRect().height,s=e-n.getBoundingClientRect().bottom,i=n.closest(".e-toolbar-item"),h="Popup"===this.parent.toolbarSettings.type,r=this.parent.toolbarModule.getToolbarElement(),u=r?r.querySelector(".e-toolbar-extended"):r,f;i?h?(t=i.getBoundingClientRect().height,i.parentElement.getBoundingClientRect().top<r.getBoundingClientRect().top&&(t=r.getBoundingClientRect().height+i.parentElement.getBoundingClientRect().height)):t=i.parentElement.getBoundingClientRect().height:(f=this.parent.element.querySelector(".e-toolbar-item"),f&&(t=f.parentElement.getBoundingClientRect().height));u&&i.parentElement!==u&&(t+=u.getBoundingClientRect().height);s<o&&(this.popupObj.element.style.setProperty("top","auto"),this.popupObj.element.style.setProperty("bottom",t+"px"))},n.prototype.onIframeMouseDown=function(n){if(this.popupObj&&this.popupObj.hide(),this.editdlgObj&&this.editdlgObj.hide(),!t.isNullOrUndefined(this.parent)&&!t.isNullOrUndefined(this.parent.contentModule)&&!t.isNullOrUndefined(this.parent.contentModule.getEditPanel())&&this.tableObj){if(n&&n.target){var i=n.target;if(i&&i.classList&&i.classList.contains("e-rte-table-resize"))return}this.tableObj.removeResizeElement()}},n.prototype.docClick=function(n){var i=n.args.target,r,e,u,f,o,s,h,c;if(i&&i.classList&&(this.popupObj&&!t.closest(i,"[id='"+this.popupObj.element.id+"']")||this.editdlgObj&&!t.closest(i,"#"+this.editdlgObj.element.id))&&!i.classList.contains("e-create-table")&&i.offsetParent&&!i.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")){if(this.popupObj&&this.popupObj.hide(),this.editdlgObj&&!i.closest(".e-border-style-btn")&&!i.closest(".e-rte-border-colorpicker")&&!i.closest(".e-rte-table-bg-colorpicker")){if(this.editdlgObj.element.querySelector(".e-rte-edit-table-content")){for(r in this.tableStyles)Object.prototype.hasOwnProperty.call(this.tableStyles,r)&&(this.tableElement.style[r]=this.tableStyles[r]);for(e=this.tableElement.querySelectorAll("td,th"),u=0;u<e.length;u++)e[u].style.padding=this.tableCellPaddingValue?this.tableCellPaddingValue:""}f=this.parent.contentModule.getDocument().querySelector(".e-colorpicker-popup.e-popup-open");f&&(f.classList.remove("e-popup-open"),f.classList.add("e-popup-close"));this.parent.notify(nu,{closedBy:"outside click"});this.editdlgObj.hide()}this.parent.isBlur=!0;eu(this.parent.element,"focusout")}o=t.closest(i,"td")||t.closest(i,"th");s=!(!o||!this.parent.contentModule.getEditPanel().contains(o));!i||"TD"===i.tagName||"TH"===i.tagName||s||null!==t.closest(i,".e-rte-quick-popup")||!i.offsetParent||i.offsetParent.classList.contains("e-quick-dropdown")||i.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")||t.closest(i,".e-rte-dropdown-popup")||t.closest(i,".e-rte-elements")||(h=!(!i.closest(".e-toolbar")&&!i.closest(".e-toolbar-wrapper")),c=!!t.closest(i,"#"+this.parent.element.id+"_pasteCleanupDialog"),this.tableObj&&(h||c||(this.tableObj.removeCellSelectClasses(),this.tableObj.removeTableSelection())),t.Browser.isIE||this.hideTableQuickToolbar());this.tableObj&&i&&i.classList&&!i.classList.contains(th)&&!i.classList.contains(ih)&&!i.classList.contains(be)&&this.tableObj.removeResizeElement()},n.prototype.drawTable=function(n,i){for(var e,r,f,u=0;u<3;u++){for(e=this.parent.createElement("div",{className:"e-rte-table-row"+this.parent.getCssClass(!0),attrs:{"data-column":""+u}}),t.EventHandler.add(e,"mouseleave",this.tableObj.tableCellLeave,this.tableObj),f=0;f<10;f++)r=this.parent.createElement("div",{className:"e-rte-tablecell e-default"+this.parent.getCssClass(!0),attrs:{"data-cell":""+f}}),e.appendChild(r),r.style.display="inline-block",0===f&&0===u&&t.addClass([r],"e-active"),t.EventHandler.add(r,"mousemove",this.tableObj.tableCellSelect,this.tableObj),this.parent.toolbarSettings.type===wt.Popup?t.EventHandler.add(r,"click",this.tableCellClick,{self:this,args:i.args,selection:i.selection}):t.EventHandler.add(r,"mouseup",this.tableCellClick,{self:this,args:i.args,selection:i.selection});n.appendChild(e)}},n.prototype.editTable=function(n){var t=this;this.createDialog();var i=this.tableDlgContent(n),r=this.l10n.getConstant("dialogUpdate"),u=this.l10n.getConstant("dialogCancel"),f=this.l10n.getConstant("tableEditHeader");this.editdlgObj.setProperties({height:"initial",width:"390px",content:i,header:f,buttons:[{click:this.saveProperties.bind(this),buttonModel:{content:r,cssClass:"e-flat e-size-update"+this.parent.getCssClass(!0),isPrimary:!0}},{click:function(){t.cancelDialog(!0)},buttonModel:{cssClass:"e-flat e-cancel"+this.parent.getCssClass(!0),content:u}}],cssClass:this.editdlgObj.cssClass+" e-rte-edit-table-prop-dialog"});this.editdlgObj.element.style.maxHeight="none";this.editdlgObj.content.querySelector("input").focus();this.hideTableQuickToolbar()},n.prototype.insertTableDialog=function(n){var i=this.self?this.self:this;i.popupObj&&i.popupObj.hide();i.createDialog();var r=i.tableCellDlgContent(),u=i.l10n.getConstant("dialogInsert"),f=i.l10n.getConstant("dialogCancel");t.isNullOrUndefined(i.editdlgObj)||(i.editdlgObj.setProperties({height:"initial",width:"290px",content:r,buttons:[{click:i.customTable.bind(this,n),buttonModel:{content:u,cssClass:"e-flat e-insert-table "+i.parent.cssClass,isPrimary:!0}},{click:function(){i.cancelDialog()},buttonModel:{cssClass:"e-flat e-cancel "+i.parent.cssClass,content:f}}]}),t.isNullOrUndefined(i.parent.cssClass)||i.editdlgObj.setProperties({cssClass:i.parent.cssClass}),i.editdlgObj.element.style.maxHeight="none",i.editdlgObj.content.querySelector("input").focus())},n.prototype.tableCellDlgContent=function(){var t=this.l10n.getConstant("columns"),i=this.l10n.getConstant("rows"),n=this.parent.createElement("div",{className:"e-cell-wrap"+this.parent.getCssClass(!0)}),r=vr('<div id="tableColumn-parent" class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text"  data-role ="none" id="tableColumn" class="e-table-column'+this.parent.getCssClass(!0)+'"/><\/div><div id="tableRow-parent" class="e-rte-field'+this.parent.getCssClass(!0)+'"><input type="text" data-role ="none" id="tableRow" class="e-table-row'+this.parent.getCssClass(!0)+'" /><\/div>');return n.appendChild(r),this.columnTextBox=new ot.NumericTextBox({format:"n0",min:1,value:3,placeholder:t,floatLabelType:"Auto",max:50,enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass()}),this.columnTextBox.isStringTemplate=!0,this.columnTextBox.appendTo(n.querySelector("#tableColumn")),this.rowTextBox=new ot.NumericTextBox({format:"n0",min:1,value:3,placeholder:i,floatLabelType:"Auto",max:100,enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass()}),this.rowTextBox.isStringTemplate=!0,this.rowTextBox.appendTo(n.querySelector("#tableRow")),this.parent.showTooltip&&this.createTooltip(["tableRow-parent","tableColumn-parent"],{"tableRow-parent":"insertTableRowTitle","tableColumn-parent":"insertTableColumnTitle"},n),n},n.prototype.createTooltip=function(n,t,i){var r=this,u=n.map(function(n){return"#"+n}).join(",");new wi.Tooltip({target:u,showTipPointer:!0,openDelay:400,opensOn:"Hover",cssClass:this.parent.getCssClass(),windowCollision:!0,position:"BottomCenter",beforeRender:function(n){var i=n.target.id,u=t[i]||"",f=r.l10n.getConstant(u);n.target.setAttribute("title",f)}}).appendTo(i)},n.prototype.clearDialogObj=function(){this.editdlgObj&&(this.editdlgObj.destroy(),t.detach(this.editdlgObj.element),this.editdlgObj=null)},n.prototype.createDialog=function(){var n=this,i;if(this.editdlgObj)this.editdlgObj.hide({returnValue:!0});else{i=this.parent.createElement("div",{className:"e-rte-edit-table"+this.parent.getCssClass(!0),id:this.rteID+"_tabledialog"});this.parent.rootContainer.appendChild(i);var r=this.l10n.getConstant("dialogInsert"),u=this.l10n.getConstant("dialogCancel"),f={header:this.l10n.getConstant("tabledialogHeader"),cssClass:pt+this.parent.getCssClass(!0),enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",height:"initial",position:{X:"center",Y:t.Browser.isDevice?"center":"top"},isModal:t.Browser.isDevice,buttons:[{buttonModel:{content:r,cssClass:"e-flat e-insert-table"+this.parent.getCssClass(!0),isPrimary:!0}},{click:function(){n.cancelDialog()},buttonModel:{cssClass:"e-flat e-cancel"+this.parent.getCssClass(!0),content:u}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(i){var r,f,u;if(n.parent.isBlur=!1,n.editdlgObj.element.querySelector(".e-rte-edit-table-content")&&("escape"===i.closedBy.toString()||"close icon"===i.closedBy.toString())){for(r in n.tableStyles)Object.prototype.hasOwnProperty.call(n.tableStyles,r)&&(n.tableElement.style[r]=n.tableStyles[r]);for(f=n.tableElement.querySelectorAll("td,th"),u=0;u<f.length;u++)f[u].style.padding=n.tableCellPaddingValue?n.tableCellPaddingValue:""}n.editdlgObj.destroy();t.detach(n.editdlgObj.element);n.dialogRenderObj.close(i);n.editdlgObj=null}};this.editdlgObj=this.dialogRenderObj.render(f);this.editdlgObj.appendTo(i);this.quickToolObj&&this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup();this.quickToolObj&&this.quickToolObj.textQTBar&&this.parent.element.ownerDocument.body.contains(this.quickToolObj.textQTBar.element)&&this.quickToolObj.textQTBar.hidePopup()}},n.prototype.customTable=function(n,i){var r=this.self?this.self:this,u;r&&r.rowTextBox&&r.rowTextBox.value&&r.columnTextBox&&r.columnTextBox.value&&(u=t.Browser.isDevice||!t.isNullOrUndefined(n.args)&&!t.isNullOrUndefined(n.args.originalEvent)&&"insert-table"===n.args.originalEvent.action||r.parent.inlineMode.enable||!t.isNullOrUndefined(r.parent.quickToolbarSettings.text)&&!(n instanceof PointerEvent)?n:this,r.tableInsert(r.rowTextBox.value,r.columnTextBox.value,i,u))},n.prototype.cancelDialog=function(n){var t,r,i;if(n){for(t in this.tableStyles)Object.prototype.hasOwnProperty.call(this.tableStyles,t)&&(this.tableElement.style[t]=this.tableStyles[t]);for(r=this.tableElement.querySelectorAll("td,th"),i=0;i<r.length;i++)r[i].style.padding=this.tableCellPaddingValue?this.tableCellPaddingValue:""}this.parent.isBlur=!1;this.editdlgObj.hide({returnValue:!0})},n.prototype.tableColorHandler=function(n){var t=this,i;"TableBackgroundColor"===n.item.subCommand?(i={cancel:!1,requestType:"TableBackgroundColor"},this.parent.trigger(l,i,function(i){i.cancel||(""===n.value&&(n.value="transparent"),t.tableElement.style.cssText+="background-color: "+n.value+";",t.parent.trigger(ct,{requestType:"TableBackgroundColor"}))})):"BorderColor"===n.item.subCommand&&(i={cancel:!1,requestType:"BorderColor"},this.parent.trigger(l,i,function(i){i.cancel||(""===n.value&&(n.value="transparent"),t.tableElement.style.cssText+="border-color: "+n.value+";",t.parent.trigger(ct,{requestType:"BorderColor"}))}))},n.prototype.saveProperties=function(){this.parent.formatter.saveData();this.editdlgObj.hide({returnValue:!0})},n.prototype.tableDlgContent=function(n){var u=this,i=n.selectParent[0],s=this.l10n.getConstant("tableWidth"),h=this.l10n.getConstant("cellpadding"),c=this.l10n.getConstant("cellspacing"),p=this.l10n.getConstant("borderWidth"),w=this.l10n.getConstant("borderColor"),b=this.l10n.getConstant("borderLabel"),l=this.l10n.getConstant("tableBackgroundColor"),k=this.l10n.getConstant("borderStyle"),d=this.l10n.getConstant("borderWidthTooltip"),g=this.l10n.getConstant("borderColorTooltip"),nt=this.l10n.getConstant("borderStyleTooltip"),r=this.parent.createElement("div",{className:"e-table-sizewrap"+this.parent.getCssClass(!0)}),tt=t.closest(i,"table").getClientRects()[0].width,a=t.closest(i,"td")?t.closest(i,"td").style.padding:t.closest(i,"th").style.padding,f=t.closest(i,"table").style.borderSpacing,e=t.closest(i,"table").style.borderWidth,it=vr('<div class="e-rte-edit-table-content'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-cell'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-tablewidth'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-widthlabel'+this.parent.getCssClass(!0)+'"><label>'+s+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+s+'"><input type="text" data-role ="none" id="'+this.parent.getID()+'_tableWidth" class="e-table-width'+this.parent.getCssClass(!0)+'"  /><\/div><\/div><div class="e-rte-edit-table-bgcolor'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-bgcolorlabel'+this.parent.getCssClass(!0)+'"><label>'+l+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+l+'"><input type="color" data-role ="none" id="'+this.parent.getID()+'_backgroundColor" role="combobox" aria-label="Background Color Picker" data-testid="rte-bg-color-picker" class="e-background-color e-rte-bg-color-picker e-colorpicker'+this.parent.getCssClass(!0)+'" /><\/div><\/div><\/div><div class="e-rte-edit-table-cell e-rte-edit-table-element'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-cellpadding'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-cellpaddinglabel'+this.parent.getCssClass(!0)+'"><label>'+h+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+h+'"><input type="text" data-role ="none" id="'+this.parent.getID()+'_cellPadding" class="e-cell-padding'+this.parent.getCssClass(!0)+'" /><\/div><\/div><div class="e-rte-edit-table-cellspacing'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-cellspacinglabel'+this.parent.getCssClass(!0)+'"><label>'+c+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+c+'"><input type="text" data-role ="none" id="'+this.parent.getID()+'_cellSpacing" class="e-cell-spacing'+this.parent.getCssClass(!0)+'" /><\/div><\/div><\/div><div class="e-rte-edit-table-border e-rte-edit-table-element'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-borderlabel'+this.parent.getCssClass(!0)+'"><label>'+b+'<\/label><\/div><div class="e-rte-edit-table-borderfields e-rte-edit-table-element'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-borderwidth'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-borderwidthlabel'+this.parent.getCssClass(!0)+'"><label>'+p+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+d+'"><input type="text" data-role ="none" id="'+this.parent.getID()+'_borderWidth" role="spinbutton" aria-label="Border Width in pixels" min="0" max="10" step="0.5" value="1" data-testid="rte-border-width-numeric" class="e-border-width e-rte-border-width-numeric e-numerictextbox'+this.parent.getCssClass(!0)+'" /><\/div><\/div><div class="e-rte-edit-table-borderstyle'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-borderstylelabel'+this.parent.getCssClass(!0)+'"><label>'+k+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+nt+'"><button role="group" aria-label="Table Styles Configuration" data-testid="rte-styles-section" class="e-border-style e-rte-table-styles" tabindex="0" id="'+this.parent.getID()+'_borderStyle"><\/button><\/div><\/div><div class="e-rte-edit-table-bordercolor'+this.parent.getCssClass(!0)+'"><div class="e-rte-edit-table-borderwidthlabel'+this.parent.getCssClass(!0)+'"><label>'+w+'<\/label><\/div><div class="e-rte-edit-table-field'+this.parent.getCssClass(!0)+'" title="'+g+'"><input type="color" data-role ="none" id="'+this.parent.getID()+'_borderColor" role="combobox" aria-label="Border Color Picker" data-testid="rte-border-color-picker" class="e-border-color e-rte-border-color-picker e-colorpicker'+this.parent.getCssClass(!0)+'" /><\/div><\/div><\/div><\/div><\/div>');r.appendChild(it);var o=r.querySelector(".e-border-style"),v=r.querySelector(".e-border-color"),y=r.querySelector(".e-background-color");return this.tableWidthNum=new ot.NumericTextBox({format:"n0",min:0,value:tt,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass(),change:function(n){u.tableElement.style.cssText+="width: "+n.value+"px;"}}),this.tableWidthNum.isStringTemplate=!0,this.tableWidthNum.appendTo(r.querySelector("#"+this.parent.getID()+"_tableWidth")),this.tableCellPadding=new ot.NumericTextBox({format:"n0",min:0,value:""!==a?parseInt(a,10):0,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass(),change:function(n){for(var r,i=u.tableElement.querySelectorAll("td,th"),t=0;t<i.length;t++)r="",""===i[t].style.padding?r=(i[t].getAttribute("style")?i[t].getAttribute("style"):"")+" padding:"+n.value+"px;":(i[t].style.padding=n.value+"px",r=i[t].getAttribute("style")),i[t].style.cssText=r}}),this.tableCellPadding.isStringTemplate=!0,this.tableCellPadding.appendTo(r.querySelector("#"+this.parent.getID()+"_cellPadding")),this.tableCellSpacing=new ot.NumericTextBox({format:"n0",min:0,value:""===f||t.isNullOrUndefined(f)?0:parseInt(f,10),floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass(),change:function(n){n.value>0&&"separate"!==u.tableElement.style.borderCollapse&&(u.tableElement.style.cssText=u.tableElement.style.cssText.replace(/border-collapse\s*:\s*[^;]+;?/gi,""),u.tableElement.style.cssText+="border-collapse: separate;");u.tableElement.style.cssText+="border-spacing: "+n.value+"px;"}}),this.tableCellSpacing.isStringTemplate=!0,this.tableCellSpacing.appendTo(r.querySelector("#"+this.parent.getID()+"_cellSpacing")),this.tableBorderWidth=new ot.NumericTextBox({format:"n1",min:0,max:10,step:.5,value:""===e||t.isNullOrUndefined(e)?1:parseInt(e,10),floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.getCssClass(),change:function(n){u.tableElement.style.cssText+="border-width: "+n.value+"px;"}}),this.tableBorderWidth.isStringTemplate=!0,this.tableBorderWidth.appendTo(r.querySelector("#"+this.parent.getID()+"_borderWidth")),this.tableBorderColor.renderColorPickerInput({container:v,containerType:"quick",items:["bordercolor"]},t.closest(i,"table")),v.setAttribute("aria-label","Border Color Picker"),this.tableBackgroundColor.renderColorPickerInput({container:y,containerType:"quick",items:["tablebackgroundcolor"]},t.closest(i,"table")),y.setAttribute("aria-label","Background Color Picker"),this.tableBorderStyle.renderDropDowns({container:o,containerType:"quick",items:["borderstyle"]},t.closest(i,"table")),o.setAttribute("aria-label","Table Styles Configuration"),o.setAttribute("tabindex","0"),r},n.prototype.destroy=function(){this.isDestroyed||(this.removeEventListener(),this.tableCellSpacing&&!this.tableCellSpacing.isDestroyed&&(this.tableCellSpacing.destroy(),this.tableCellSpacing=null),this.tableCellPadding&&!this.tableCellPadding.isDestroyed&&(this.tableCellPadding.destroy(),this.tableCellPadding=null),this.tableWidthNum&&!this.tableWidthNum.isDestroyed&&(this.tableWidthNum.destroy(),this.tableWidthNum=null),this.rowTextBox&&!this.rowTextBox.isDestroyed&&(this.rowTextBox.destroy(),this.rowTextBox=null),this.columnTextBox&&!this.columnTextBox.isDestroyed&&(this.columnTextBox.destroy(),this.columnTextBox=null),this.createTableButton&&!this.createTableButton.isDestroyed&&(this.createTableButton.destroy(),this.createTableButton=null),this.tableBorderWidth&&!this.tableBorderWidth.isDestroyed&&(this.tableBorderWidth.destroy(),this.tableBorderWidth=null),this.tableBackgroundColor&&(this.tableBackgroundColor.destroyColorPicker(),this.tableBackgroundColor=null),this.tableBorderColor&&(this.tableBorderColor.destroyColorPicker(),this.tableBorderColor=null),this.tableBorderStyle&&(this.tableBorderStyle.destroyDropDowns(),this.tableBorderStyle=null),this.createTablePopupBoundFn=null,this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"table"},n.prototype.afterKeyDown=function(){this.tableObj&&this.tableObj.afterKeyDown()},n.prototype.createTablePopupKeyDown=function(n){if("Escape"===n.key){var r=n.target.closest(".e-rte-table-popup"),i=t.getComponent(r,"popup"),u=i.relateTo;i.hide();u.focus({preventScroll:!0})}},n}(),crt=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(u,this.removeEventListener,this),this.parent.on(nu,this.documentClickClosedBy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(u,this.removeEventListener),this.parent.off(nu,this.documentClickClosedBy))},n.prototype.render=function(n){n.beforeOpen=this.beforeOpen.bind(this);n.open=this.open.bind(this);n.position={X:"center",Y:"string"===n.target||"BODY"!==n.target.nodeName||t.isNullOrUndefined(n.position)?this.getDialogPosition():n.position.Y};t.isNullOrUndefined(n.close)&&(n.close=this.close.bind(this));n.beforeClose=this.beforeClose.bind(this);"true"===this.parent.element.dataset.rteUnitTesting&&(n.animationSettings={effect:"None",duration:0});var i=new wi.Dialog(n);return i.isStringTemplate=!0,i},n.prototype.beforeOpen=function(n){if(this.parent.quickToolbarModule&&this.parent.quickToolbarModule.textQTBar&&this.parent.quickToolbarModule.textQTBar.element&&this.parent.quickToolbarModule.textQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.parent.quickToolbarModule.textQTBar.element)&&this.parent.quickToolbarModule.textQTBar.hidePopup(),n.element.classList.contains("e-dialog")){var i=t.closest(n.target,"form");t.isNullOrUndefined(i)||(this.dialogEle=n.element,this.dialogEle.addEventListener("keydown",this.handleEnterKeyDown))}this.parent.trigger(ld,n,this.beforeOpenCallback.bind(this,n))},n.prototype.handleEnterKeyDown=function(n){"Enter"===n.key&&n.preventDefault()},n.prototype.beforeOpenCallback=function(n){n.cancel&&this.parent.notify(fr,null)},n.prototype.open=function(n){t.isNullOrUndefined(n.container.querySelector(".e-rte-file-manager-dialog"))||(n.preventFocus=!0);this.parent.trigger(ad,n)},n.prototype.documentClickClosedBy=function(n){this.outsideClickClosedBy=n.closedBy},n.prototype.beforeClose=function(n){this.dialogEle&&this.dialogEle.removeEventListener("keydown",this.handleEnterKeyDown);n.closedBy="outside click"===this.outsideClickClosedBy?this.outsideClickClosedBy:n.closedBy;this.parent.trigger(vd,n,function(n){n.cancel||n.container.classList.contains("e-popup-close")&&(n.cancel=!0)});this.outsideClickClosedBy=""},n.prototype.getDialogPosition=function(){var t=this.parent.element.getBoundingClientRect().top,i,n,r;if(t<0){for(i=0,n=this.parent.element;"BODY"!==n.nodeName;)r=n.getBoundingClientRect().top,r>0&&(i=r),n=n.parentElement;return(t=Math.abs(t)+i).toString()}return"top"},n.prototype.close=function(n){this.parent.trigger(yd,n)},n}(),lrt="\n@charset \"UTF-8\";\n\n* {\n    box-sizing: border-box;\n}\n\nhtml {\n    height: auto;\n}\n\nhtml, body {\n    margin: 0;\n}\n\nbody {\n    color: #333;\n    word-wrap: break-word;\n}\n\n.e-content {\n    background: unset;\n    min-height: 100px;\n    outline: 0 solid transparent;\n    padding: 16px;\n    position: relative;\n    overflow-x: auto;\n    font-weight: normal;\n    line-height: 1.5;\n    font-size: 14px;\n    text-align: inherit;\n    font-family: \"Roboto\", \"Segoe UI\", \"GeezaPro\", \"DejaVu Serif\", \"sans-serif\", \"-apple-system\", \"BlinkMacSystemFont\";\n}\n\n.e-content p {\n    margin: 0 0 10px;\n    margin-bottom: 10px;\n}\n.e-rte-checklist > li:not(.e-rte-checklist-hidden) {\n    list-style: none;\n    position: relative;\n}\n.e-rte-checklist > li::before {\n    content: '';\n    position: absolute;\n    top: 2px;\n    box-sizing: content-box;\n    left: -25px;\n    width: 16px;\n    height: 16px;\n    border-radius: 2px;\n    cursor: pointer;\n}\n.e-rte-checklist li.e-rte-checklist-checked::after {\n    border-style: solid;\n    border-width: 0 calc(16px / 8) calc(16px / 8) 0;\n    box-sizing: content-box;\n    content: '';\n    display: block;\n    height: 8px;\n    width: 4px;\n    left: -19px;\n    position: absolute;\n    top: 4.5px;\n    transform: rotate(45deg);\n    cursor: pointer;\n}\n.e-rtl {\n    .e-rte-checklist li.e-rte-checklist-checked::after {\n        right: -19px;\n    }\n    .e-rte-checklist > li::before {\n        right: -25px;\n    }\n}\n.e-content h1 {\n    font-size: 2.857em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin: 10px 0;\n}\n\n.e-content h2 {\n    font-size: 2.285em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin: 10px 0;\n}\n\n.e-content h3 {\n    font-size: 2em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin: 10px 0;\n}\n\n.e-content h4 {\n    font-size: 1.714em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin: 10px 0;\n}\n\n.e-content h5 {\n    font-size: 1.428em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin: 10px 0;\n}\n\n.e-content h6 {\n    font-size: 1.142em;\n    font-weight: 600;\n    line-height: 1.5;\n    margin: 10px 0;\n}\n\n.e-content blockquote {\n    margin: 10px 0;\n    padding-left: 12px;\n    border-left: 2px solid #5c5c5c;\n}\n\n.e-rtl.e-content blockquote {\n    padding-left: 0;\n    padding-right: 12px;\n}\n\n.e-content pre {\n    border: 0;\n    border-radius: 0;\n    color: #333;\n    font-size: inherit;\n    line-height: inherit;\n    margin: 0 0 10px;\n    overflow: visible;\n    padding: 0;\n    white-space: pre-wrap;\n    word-break: inherit;\n    word-wrap: break-word;\n}\n\n.e-content code {\n    background: #9d9d9d26;\n    color: #ed484c;\n}\n\n.e-content strong,\n.e-content b {\n    font-weight: bold;\n}\n\n.e-content hr {\n    margin: 10px 0;\n    border: 2px solid rgba(176, 179, 184, 1);\n}\n\n.e-content hr:hover {\n    cursor: default;\n}\n\nhr.e-rte-hr-focus {\n    outline: 2px solid rgba(33, 150, 243, .3);\n    outline-offset: 3px;\n}\n\n.e-content a {\n    text-decoration: none;\n    user-select: auto;\n}\n\n.e-content a:hover {\n    text-decoration: underline;\n}\n\n.e-content li {\n    margin-bottom: 10px;\n}\n\n.e-content li ol,\n.e-content li ul {\n    margin-block-start: 10px;\n}\n\n.e-content ul {\n    list-style-type: disc;\n}\n\n.e-content ul ul,\n.e-content ol ul {\n    list-style-type: circle;\n}\n\n.e-content ul ul ul,\n.e-content ol ul ul,\n.e-content ul ol ul,\n.e-content ol ol ul {\n    list-style-type: square;\n}\n\n.e-content p:last-child,\n.e-content pre:last-child,\n.e-content blockquote:last-child {\n    margin-bottom: 0;\n}\n\n.e-content h3 + h4,\n.e-content h4 + h5,\n.e-content h5 + h6 {\n    margin-top: 0.6em;\n}\n\n.e-content ul:last-child {\n    margin-bottom: 0;\n}\n\n.e-content table {\n    margin-bottom: 10px;\n    border-collapse: collapse;\n    border-spacing: 0;\n    empty-cells: show;\n}\n\n.e-content table.e-cell-select {\n    position: relative;\n}\n\n.e-content table.e-cell-select::after {\n    content: '';\n    position: absolute;\n    top: 0;\n    left: 0;\n    right: 0;\n    bottom: 0;\n    border: 2px double #4a90e2;\n    pointer-events: none;\n}\n\ntable .e-cell-select {\n    border: 1px double #4a90e2 !important;\n}\n\n.e-content table.e-rte-table th {\n    background-color: rgba(157, 157, 157, .15);\n}\n\n.e-rte-table td,\n.e-rte-table th {\n    border: 1px solid #BDBDBD;\n    height: 20px;\n    min-width: 20px;\n    padding: 2px 5px;\n}\n\n.e-rte-table td.e-cell-select.e-multi-cells-select,\n.e-rte-table th.e-cell-select.e-multi-cells-select {\n    position: relative;\n}\n\n.e-rte-table td.e-cell-select.e-multi-cells-select::after,\n.e-rte-table th.e-cell-select.e-multi-cells-select::after {\n    background-color: rgba(13, 110, 253, 0.08);\n    content: \"\";\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    bottom: 0;\n    pointer-events: none;\n    right: 0;\n}\n\ntable td.e-multi-cells-select ::selection,\ntable th.e-multi-cells-select ::selection {\n    background-color: transparent;\n}\n\ntd.e-multi-cells-select,\nth.e-multi-cells-select {\n    user-select: none !important;\n}\n\n.e-rte-table.e-dashed-border > tbody > tr > td,\n.e-rte-table.e-dashed-border > tbody > tr > th {\n    border-style: dashed;\n}\n\n.e-rte-table.e-alternate-border > tbody > tr:nth-child(2n),\n.e-rte-table.e-alternate-border > tbody > tr:nth-child(2n) > td,\n.e-rte-table.e-alternate-border > tbody > tr:nth-child(2n) > th {\n    background-color: #F5F5F5;\n}\n\n.e-rte-image,\n.e-rte-audio,\n.e-rte-video  {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-image.e-imginline,\n.e-rte-audio.e-audio-inline,\n.e-rte-video.e-video-inline {\n    margin-left: 5px;\n    margin-right: 5px;\n    display: inline-block;\n    float: none;\n    max-width: 100%;\n    padding: 1px;\n    vertical-align: bottom;\n}\n\n.e-rte-image.e-imgcenter,\n.e-rte-video.e-video-center {\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: 5px auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-image.e-imgright,\n.e-rte-video.e-video-right {\n    float: right;\n    margin: 0 auto;\n    margin-left: 5px;\n    text-align: right;\n}\n\n.e-rte-image.e-imgleft,\n.e-rte-video.e-video-left {\n    float: left;\n    margin: 0 auto;\n    margin-right: 5px;\n    text-align: left;\n}\n\n.e-rte-img-caption {\n    display: inline-block;\n    margin: 5px auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-img-caption.e-caption-inline {\n    display: inline-block;\n    margin: 5px auto;\n    margin-left: 5px;\n    margin-right: 5px;\n    max-width: calc(100% - (2 * 5px));\n    position: relative;\n    text-align: center;\n    vertical-align: bottom;\n}\n\n.e-rte-img-caption.e-imgcenter {\n    display: contents;\n    margin-left: auto;\n    margin-right: auto;\n}\n\n.e-rte-img-caption.e-imgright {\n    display: contents;\n    margin-left: auto;\n    margin-right: 0;\n}\n\n.e-rte-img-caption.e-imgleft {\n    display: contents;\n    margin-left: 0;\n    margin-right: auto;\n}\n\n.e-img-caption.e-rte-img-caption.e-imgbreak {\n    display: contents;\n}\n\n.e-rte-img-caption .e-img-inner {\n    display: block;\n    font-size: 16px;\n    font-weight: initial;\n    margin: auto;\n    opacity: .9;\n    position: relative;\n    text-align: center;\n    width: 100%;\n}\n\n.e-img-wrap {\n    display: inline-block;\n    margin: auto;\n    padding: 0;\n    text-align: center;\n    width: 100%;\n}\n\n.e-imgleft,\n.e-video-left {\n    float: left;\n    margin: 0 5px 0 0;\n    text-align: left;\n}\n\n.e-imgright,\n.e-video-right {\n    float: right;\n    margin: 0 0 0 5px;\n    text-align: right;\n}\n\n.e-imgcenter,\n.e-video-center {\n    cursor: pointer;\n    display: block;\n    float: none;\n    height: auto;\n    margin: 5px auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-control img:not(.e-resize) {\n    border: 2px solid transparent;\n    z-index: 1000\n}\n\n.e-imginline,\n.e-audio-inline,\n.e-video-inline {\n    display: inline-block;\n    float: none;\n    margin-left: 5px;\n    margin-right: 5px;\n    vertical-align: bottom;\n}\n\n.e-imgbreak,\n.e-audio-break,\n.e-video-break {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: 5px auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-image.e-img-focus:not(.e-resize),\n.e-audio-focus:not(.e-resize),\n.e-video-focus:not(.e-resize) {\n    border: solid 2px #4a90e2;\n}\n\nimg.e-img-focus::selection,\naudio.e-audio-focus::selection,\n.e-video-focus::selection {\n    background: transparent;\n    color: transparent;\n}\n\nspan.e-rte-imageboxmark,\nspan.e-rte-videoboxmark {\n    width: 10px;\n    height: 10px;\n    position: absolute;\n    display: block;\n    background: #4a90e2;\n    border: 1px solid #fff;\n    z-index: 1000;\n}\n\n.e-mob-rte.e-mob-span span.e-rte-imageboxmark,\n.e-mob-rte.e-mob-span span.e-rte-videoboxmark {\n    background: #4a90e2;\n    border: 1px solid #fff;\n}\n\n.e-mob-rte span.e-rte-imageboxmark,\n.e-mob-rte span.e-rte-videoboxmark {\n    background: #fff;\n    border: 1px solid #4a90e2;\n    border-radius: 15px;\n    height: 20px;\n    width: 20px;\n}\n\n.e-mob-rte.e-mob-span span.e-rte-imageboxmark,\n.e-mob-rte.e-mob-span span.e-rte-videoboxmark {\n    background: #4a90e2;\n    border: 1px solid #fff;\n}\n\n.e-content img.e-resize,\n.e-content video.e-resize {\n    z-index: 1000;\n}\n\n.e-img-caption .e-img-inner {\n    outline: 0;\n}\n\n.e-rte-img-caption.e-imgleft .e-img-inner {\n    float: left;\n    text-align: left;\n}\n\n.e-rte-img-caption.e-imgright .e-img-inner {\n    float: right;\n    text-align: right;\n}\n\n.e-rte-img-caption.e-imgleft .e-img-wrap,\n.e-rte-img-caption.e-imgright .e-img-wrap {\n    display: contents;\n}\n\n.e-img-caption a:focus-visible {\n    outline: none;\n}\n\n.e-rte-img-caption .e-rte-image.e-imgright {\n    margin-left: auto;\n    margin-right: 0;\n}\n\n.e-rte-img-caption .e-rte-image.e-imgleft {\n    margin: 0;\n}\n\n.e-content {\n    .e-clickelem::after {\n        left: 0;\n        right: 0;\n        z-index: 1;\n    }\n    .e-clickelem::before {\n        left: 0;\n        right: 0;\n        z-index: 1;\n    }\n    .e-clickelem::before {\n        bottom: 70%;\n        top: 0;\n    }\n    .e-clickelem::after {\n        bottom: 0;\n        top: 70%;\n    }\n\n    .e-audio-wrap {\n        display: inline-block;\n    }\n\n    .e-clickelem {\n        display: block;\n        margin: 0;\n        outline: none;\n        padding: 0;\n        position: relative;\n    }\n\n    .e-clickelem::after {\n        background: transparent;\n        content: '';\n        cursor: default;\n        display: block;\n        position: absolute;\n    }\n\n    .e-clickelem::before {\n        background: transparent;\n        content: '';\n        cursor: default;\n        display: block;\n        position: absolute;\n    }\n}\n\nspan.e-table-box {\n    cursor: nwse-resize;\n    display: block;\n    height: 10px;\n    position: absolute;\n    width: 10px;\n    background-color: #ffffff;\n    border: 1px solid #BDBDBD;\n}\n\nspan.e-table-box.e-rmob {\n    height: 14px;\n    width: 14px;\n    background-color: #BDBDBD;\n    border: 1px solid #BDBDBD;\n}\n\n.e-rte-table-resize.e-tb-col-insert,\n.e-rte-table-resize.e-tb-row-insert {\n  position: absolute;\n  background-color: transparent;\n  text-align: center;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  opacity: 0;\n  color: #0F6CBD;\n}\n\n.e-rte-table-resize.e-tb-col-insert {\n  width: 26px;\n  height: 22px;\n}\n\n.e-rte-table-resize.e-tb-row-insert {\n  width: 22px;\n  height: 26px;\n}\n\n.e-rte-table-resize.e-tb-row-insert.e-insert-cell-rtl {\n  right: 2px;\n}\n\n.e-rte-table-resize.e-tb-col-insert .e-icons.e-circle-add,\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle-add {\n  font-size: 16px;\n  line-height: 16px;\n  border: 1px;\n  position: absolute;\n}\n\n.e-rte-table-resize.e-tb-col-insert .e-icons.e-circle-add {\n  top: -1px;\n  left: 5px;\n}\n\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle-add {\n  top: 5.5px;\n  left: -0.8px;\n}\n\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle-add.e-insert-cell-rtl {\n  left: 7px;\n}\n\n.e-rte-table-resize.e-tb-col-insert .e-icons.e-circle,\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle {\n  font-size: 8px;\n  line-height: 8px;\n  border: 1px;\n  position: absolute;\n}\n\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle {\n  top: 9px;\n  left: 4px;\n}\n\n.e-rte-table-resize.e-tb-col-insert .e-icons.e-circle {\n  top: 4px;\n  left: 9px;\n}\n\n.e-rte-table-resize.e-tb-row-insert .e-icons.e-circle.e-insert-cell-rtl {\n  left: 10px;\n}\n\n.e-row-resize,\n.e-column-resize {\n    background-color: transparent;\n    background-repeat: repeat;\n    bottom: 0;\n    cursor: col-resize;\n    height: 1px;\n    overflow: visible;\n    position: absolute;\n    width: 1px;\n}\n\n.e-row-resize {\n    cursor: row-resize;\n    height: 1px;\n}\n\n.e-table-rhelper {\n    cursor: col-resize;\n    opacity: .87;\n    position: absolute;\n}\n\n.e-table-rhelper.e-column-helper {\n    width: 1px;\n}\n\n.e-table-rhelper.e-row-helper {\n    height: 1px;\n}\n\n.e-icons.e-circle::before {\n  content: '';\n  display: inline-block;\n  width: 8px;\n  height: 8px;\n  background-image: url('data:image/svg+xml,%3Csvg%20width%3D%228%22%20height%3D%228%22%20viewBox%3D%220%200%208%208%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%20%20%3Cg%20clip-path%3D%22url(%23clip0_circle_8)%22%3E%0A%20%20%20%20%3Crect%20width%3D%228%22%20height%3D%228%22%20fill%3D%22black%22%20fill-opacity%3D%220.01%22%2F%3E%0A%20%20%20%20%3Cpath%20d%3D%22M3.82767%200.571429L3.64626%200.589569L3.47392%200.60771L3.14739%200.680273L2.98413%200.725627L2.82086%200.780047L2.51247%200.907027L2.22222%201.07029L1.95011%201.25837L1.82313%201.35147L1.69615%201.46032L1.46032%201.69615L1.35147%201.82313L1.25837%201.95011L1.07029%202.22222L0.907027%202.51247L0.780047%202.82086L0.725627%202.98413L0.680273%203.14739L0.60771%203.47392L0.589569%203.64626L0.571429%203.82767V4.17233L0.589569%204.35374L0.60771%204.52608L0.680273%204.85261L0.725627%205.01587L0.780047%205.17914L0.907027%205.48753L1.07029%205.77778L1.25837%206.04989L1.35147%206.17687L1.46032%206.30385L1.69615%206.53968L1.82313%206.64853L1.95011%206.74163L2.22222%206.92971L2.51247%207.09297L2.82086%207.21995L2.98413%207.27437L3.14739%207.31973L3.47392%207.39229L3.64626%207.41043L3.82767%207.42857H4.17233L4.35374%207.41043L4.52608%207.39229L4.85261%207.31973L5.01587%207.27437L5.17914%207.21995L5.48753%207.09297L5.77778%206.92971L6.04989%206.74163L6.17687%206.64853L6.30385%206.53968L6.53968%206.30385L6.64853%206.17687L6.74163%206.04989L6.92971%205.77778L7.09297%205.48753L7.21995%205.17914L7.27437%205.01587L7.31973%204.85261L7.39229%204.52608L7.41043%204.35374L7.42857%204.17233V3.82767L7.41043%203.64626L7.39229%203.47392L7.31973%203.14739L7.27437%202.98413L7.21995%202.82086L7.09297%202.51247L6.92971%202.22222L6.74163%201.95011L6.64853%201.82313L6.53968%201.69615L6.30385%201.46032L6.17687%201.35147L6.04989%201.25837L5.77778%201.07029L5.48753%200.907027L5.17914%200.780047L5.01587%200.725627L4.85261%200.680273L4.52608%200.60771L4.35374%200.589569L4.17233%200.571429H3.82767ZM4%200L4.20862%200.00907027L4.41149%200.0181405L4.60771%200.0453515L4.80392%200.0816327L4.9977%200.126984L5.18821%200.181405L5.37869%200.244898L5.56009%200.317461L5.73242%200.390023L5.90476%200.480726L6.07709%200.580499L6.24036%200.680273L6.39456%200.798187L6.53968%200.916102L6.82993%201.17007L6.95691%201.30612L7.08389%201.45125L7.31973%201.75964L7.41953%201.9229L7.51934%202.0951L7.61014%202.26757L7.68254%202.43991L7.75514%202.62131L7.81859%202.81179L7.87301%203.0056L7.8844%203.19274L7.95467%203.39229L7.98186%203.5885L7.99093%203.79138L8%204L7.99093%204.20862L7.98186%204.41149L7.95467%204.60771L7.8844%204.80392L7.87301%204.9977L7.81859%205.18821L7.75514%205.37869L7.68254%205.56009L7.61014%205.73242L7.51934%205.90476L7.41953%206.07709L7.31973%206.24036L7.08389%206.54875L6.95691%206.69388L6.82993%206.82993L6.69388%206.95691L6.54875%207.08389L6.24036%207.31973L6.07709%207.41953L5.90476%207.51934L5.73242%207.61014L5.56009%207.68254L5.37869%207.75514L5.18821%207.81859L4.9977%207.87301L4.80392%207.8844L4.60771%207.95467L4.41149%207.98186L4.20862%207.99093L4%208L3.79138%207.99093L3.5885%207.98186L3.39229%207.95467L3.19274%207.8844L3.0056%207.87301L2.81179%207.81859L2.62131%207.75514L2.43991%207.68254L2.26757%207.61014L2.0951%207.51934L1.9229%207.41953L1.75964%207.31973L1.45125%207.08389L1.30612%206.95691L1.17007%206.82993L0.916102%206.53968L0.798187%206.39456L0.680273%206.24036L0.580499%206.07709L0.480726%205.90476L0.390023%205.73242L0.317461%205.56009L0.244898%205.37869L0.181405%205.18821L0.126984%204.9977L0.0816327%204.80392L0.0453515%204.60771L0.0181405%204.41149L0.00907027%204.20862L0%204L0.00907027%203.79138L0.0181405%203.5885L0.0453515%203.39229L0.0816327%203.19274L0.126984%203.0056L0.181405%202.81179L0.244898%202.62131L0.317461%202.43991L0.390023%202.26757L0.480726%202.0951L0.580499%201.9229L0.680273%201.75964L0.798187%201.60544L0.916102%201.46032L1.17007%201.17007L1.30612%201.04309L1.45125%200.916102L1.75964%200.680273L1.9229%200.580499L2.0951%200.480726L2.26757%200.390023L2.43991%200.317461L2.62131%200.244898L2.81179%200.181405L3.0056%200.126984L3.19274%200.0816327L3.39229%200.0453515L3.5885%200.0181405L3.79138%200.00907027L4%200Z%22%20fill%3D%22%230F6CBD%22%2F%3E%0A%20%20%3C%2Fg%3E%0A%20%20%3Cdefs%3E%0A%20%20%20%20%3CclipPath%20id%3D%22clip0_circle_8%22%3E%0A%20%20%20%20%20%20%3Crect%20width%3D%228%22%20height%3D%228%22%20fill%3D%22white%22%2F%3E%0A%20%20%20%20%3C%2FclipPath%3E%0A%20%20%3C%2Fdefs%3E%0A%3C%2Fsvg%3E');\n}\n\n.e-icons.e-circle-add::before {\n  content: '';\n  display: inline-block;\n  width: 16px;\n  height: 16px;\n  background-image: url('data:image/svg+xml,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Cg%20clip-path%3D%22url(%23clip0_1124_24361)%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22black%22%20fill-opacity%3D%220.01%22%2F%3E%0A%3Cpath%20d%3D%22M8.10169%204.27119L8.20339%204.30508L8.30508%204.35593L8.44068%204.49153L8.49153%204.59322L8.52542%204.69492L8.54237%204.79661V7.45763H11.2034L11.3051%207.47458L11.4068%207.50847L11.5085%207.55932L11.6441%207.69492L11.6949%207.79661L11.7288%207.89831V8.10169L11.6949%208.20339L11.6441%208.30508L11.5085%208.44068L11.4068%208.49153L11.3051%208.52542L11.2034%208.54237H8.54237V11.2034L8.52542%2011.3051L8.49153%2011.4068L8.44068%2011.5085L8.30508%2011.6441L8.20339%2011.6949L8.10169%2011.7288H7.89831L7.79661%2011.6949L7.69492%2011.6441L7.55932%2011.5085L7.50847%2011.4068L7.47458%2011.3051L7.45763%2011.2034V8.54237H4.79661L4.69492%208.52542L4.59322%208.49153L4.49153%208.44068L4.35593%208.30508L4.30508%208.20339L4.27119%208.10169V7.89831L4.30508%207.79661L4.35593%207.69492L4.49153%207.55932L4.59322%207.50847L4.69492%207.47458L4.79661%207.45763H7.45763V4.79661L7.47458%204.69492L7.50847%204.59322L7.55932%204.49153L7.69492%204.35593L7.79661%204.30508L7.89831%204.27119H8.10169ZM8%201.05085L7.64407%201.0678L7.28814%201.10169L6.94915%201.13559L6.59322%201.20339L6.27119%201.27119L5.9322%201.37288L5.61017%201.47458L5.30508%201.61017L4.98305%201.74576L4.69492%201.89831L4.11864%202.23729L3.84746%202.44068L3.59322%202.64407L3.08475%203.08475L2.64407%203.59322L2.44068%203.84746L2.23729%204.11864L1.89831%204.69492L1.74576%204.98305L1.61017%205.30508L1.47458%205.61017L1.37288%205.9322L1.27119%206.27119L1.20339%206.59322L1.13559%206.94915L1.10169%207.28814L1.0678%207.64407L1.05085%208L1.0678%208.35593L1.10169%208.71186L1.13559%209.05085L1.20339%209.40678L1.27119%209.72881L1.37288%2010.0678L1.47458%2010.3898L1.61017%2010.6949L1.74576%2011.0169L1.89831%2011.3051L2.23729%2011.8814L2.44068%2012.1525L2.64407%2012.4068L3.08475%2012.9153L3.59322%2013.3559L3.84746%2013.5593L4.11864%2013.7627L4.69492%2014.1017L4.98305%2014.2542L5.30508%2014.3898L5.61017%2014.5254L5.9322%2014.6271L6.27119%2014.7288L6.59322%2014.7966L6.94915%2014.8644L7.28814%2014.8983L7.64407%2014.9322L8%2014.9492L8.35593%2014.9322L8.71186%2014.8983L9.05085%2014.8644L9.40678%2014.7966L9.72881%2014.7288L10.0678%2014.6271L10.3898%2014.5254L10.6949%2014.3898L11.0169%2014.2542L11.3051%2014.1017L11.8814%2013.7627L12.1525%2013.5593L12.4068%2013.3559L12.9153%2012.9153L13.3559%2012.4068L13.5593%2012.1525L13.7627%2011.8814L14.1017%2011.3051L14.2542%2011.0169L14.3898%2010.6949L14.5254%2010.3898L14.6271%2010.0678L14.7288%209.72881L14.7966%209.40678L14.8644%209.05085L14.8983%208.71186L14.9322%208.35593L14.9492%208L14.9322%207.64407L14.8983%207.28814L14.8644%206.94915L14.7966%206.59322L14.7288%206.27119L14.6271%205.9322L14.5254%205.61017L14.3898%205.30508L14.2542%204.98305L14.1017%204.69492L13.7627%204.11864L13.5593%203.84746L13.3559%203.59322L12.9153%203.08475L12.4068%202.64407L12.1525%202.44068L11.8814%202.23729L11.3051%201.89831L11.0169%201.74576L10.6949%201.61017L10.3898%201.47458L10.0678%201.37288L9.72881%201.27119L9.40678%201.20339L9.05085%201.13559L8.71186%201.10169L8.35593%201.0678L8%201.05085ZM8.40678%200L8.81356%200.0338983L9.22034%200.0847458L9.61017%200.152542L10%200.237288L10.7458%200.474576L11.1186%200.627119L11.4746%200.779661L12.1525%201.15254L12.4746%201.35593L12.7966%201.57627L13.1017%201.81356L13.3898%202.0678L13.9322%202.61017L14.1864%202.89831L14.4237%203.20339L14.6441%203.52542L14.8475%203.84746L15.2203%204.52542L15.3729%204.88136L15.5254%205.25424L15.6441%205.61017L15.7627%206L15.8475%206.38983L15.9153%206.77966L15.9661%207.18644L16%207.59322V8.40678L15.9661%208.81356L15.9153%209.22034L15.8475%209.61017L15.7627%2010L15.6441%2010.3898L15.5254%2010.7458L15.3729%2011.1186L15.2203%2011.4746L14.8475%2012.1525L14.6441%2012.4746L14.4237%2012.7966L14.1864%2013.1017L13.9322%2013.3898L13.3898%2013.9322L13.1017%2014.1864L12.7966%2014.4237L12.4746%2014.6441L12.1525%2014.8475L11.4746%2015.2203L11.1186%2015.3729L10.7458%2015.5254L10%2015.7627L9.61017%2015.8475L9.22034%2015.9153L8.81356%2015.9661L8.40678%2016H7.59322L7.18644%2015.9661L6.77966%2015.9153L6.38983%2015.8475L6%2015.7627L5.25424%2015.5254L4.88136%2015.3729L4.52542%2015.2203L3.84746%2014.8475L3.52542%2014.6441L3.20339%2014.4237L2.89831%2014.1864L2.61017%2013.9322L2.0678%2013.3898L1.81356%2013.1017L1.57627%2012.7966L1.35593%2012.4746L1.15254%2012.1525L0.779661%2011.4746L0.627119%2011.1186L0.474576%2010.7458L0.237288%2010L0.152542%209.61017L0.0847458%209.22034L0.0338983%208.81356L0%208.40678V7.59322L0.0338983%207.18644L0.0847458%206.77966L0.152542%206.38983L0.237288%206L0.474576%205.25424L0.627119%204.88136L0.779661%204.52542L1.15254%203.84746L1.35593%203.52542L1.57627%203.20339L1.81356%202.89831L2.0678%202.61017L2.61017%202.0678L2.89831%201.81356L3.20339%201.57627L3.52542%201.35593L3.84746%201.15254L4.52542%200.779661L4.88136%200.627119L5.25424%200.474576L6%200.237288L6.38983%200.152542L6.77966%200.0847458L7.18644%200.0338983L7.59322%200H8.40678Z%22%20fill%3D%22%230F6CBD%22%2F%3E%0A%3C%2Fg%3E%0A%3Cdefs%3E%0A%3CclipPath%20id%3D%22clip0_1124_24361%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22white%22%2F%3E%0A%3C%2FclipPath%3E%0A%3C%2Fdefs%3E%0A%3C%2Fsvg%3E%20%20%0A');\n}\n\n.e-reicon::before {\n    border-bottom: 6px solid transparent;\n    border-right: 6px solid;\n    border-top: 6px solid transparent;\n    content: '';\n    display: block;\n    height: 0;\n    position: absolute;\n    right: 4px;\n    top: 4px;\n    width: 20px;\n}\n\n.e-reicon::after {\n    border-bottom: 6px solid transparent;\n    border-left: 6px solid;\n    border-top: 6px solid transparent;\n    content: '';\n    display: block;\n    height: 0;\n    left: 4px;\n    position: absolute;\n    top: 4px;\n    width: 20px;\n    z-index: 3;\n}\n\n.e-row-helper.e-reicon::after {\n    top: 10px;\n    transform: rotate(90deg);\n}\n\n.e-row-helper.e-reicon::before {\n    left: 4px;\n    top: -20px;\n    transform: rotate(90deg);\n}\n\n.e-table-rhelper {\n    background-color: #0F6CBD;\n}\n\n.e-rtl {\n    direction: rtl;\n}\n\n.e-rte-placeholder::before {\n    content: attr(placeholder);\n    opacity: 0.54;\n    overflow: hidden;\n    padding-top: 16px;\n    position: absolute;\n    text-align: start;\n    top: 0;\n    z-index: 1;\n}\n\n.e-resize-enabled,\n.e-count-enabled {\n    padding-bottom: 0px;\n}\npre[data-language] {\n    font-family: Space Mono;\n    border-radius: 6px;\n    padding: 20px 16px 16px;\n    position: relative;\n}\npre[data-language] code{\n    background: none;\n    color: #645454;\n}\npre[data-language]::before {\n    content: attr(data-language);\n    font-family: 'Helvetica Neue';\n    font-weight: 500;\n    font-size: 12px;\n    line-height: 18px;\n    right: 8px;\n    padding: 2px 4px;\n    top: -1px;\n    border-radius: 0px 0px 4px 4px;\n    position: absolute;\n}\n",art="\npre[data-language] {\n    background-color: rgba(157, 157, 157, 0.08);\n    color: rgba(46, 46, 46, 1);\n    border: 1px solid rgba(229, 231, 235, 1);\n}\npre[data-language]::before {\n    background-color: rgba(105, 105, 105, 1);\n    color: rgba(249, 250, 251, 1);\n}\n.e-rte-checklist > li::before {\n   border: 1px solid rgba(97, 97, 97, 1);\n}\n.e-rte-checklist li.e-rte-checklist-checked::before {\n  background: rgba(15, 108, 189, 1);\n  border: 1px solid rgba(15, 108, 189, 1);\n}\n.e-rte-checklist li.e-rte-checklist-checked::after {\n  border-color: rgba(255, 255, 255, 1);\n}\n",vrt="\npre[data-language] {\n    background-color: rgba(157, 157, 157, 0.08);\n    color: rgba(245, 245, 245, 1);\n    border: 1px solid rgba(40, 47, 60, 1);\n}\npre[data-language]::before {\n    background-color: rgba(189, 186, 186, 1);\n    color: rgba(29, 36, 50, 1);\n}\n.e-rte-checklist > li::before {\n   border: 1px solid rgba(173, 173, 173, 1);\n}\n.e-rte-checklist li.e-rte-checklist-checked::before {\n  background: rgba(17, 94, 163, 1);\n  border: 1px solid rgba(17, 94, 163, 1);\n}\n.e-rte-checklist li.e-rte-checklist-checked::after {\n  border-color: rgba(255, 255, 255, 1);\n}\n",yrt={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},editLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},insertAudio:{command:"Audios",subCommand:"Audio"},insertVideo:{command:"Videos",subCommand:"Video"},editImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"},copyFormatPainter:{command:"FormatPainter",value:"format-copy"},applyFormatPainter:{command:"FormatPainter",value:"format-paste"},escapeFormatPainter:{command:"FormatPainter",value:"escape"},InlineCode:{command:"Style",subCommand:"inlinecode",value:"inlinecode"},insertCodeBlock:{command:"CodeBlock",subCommand:"CodeBlock"},numberFormatListNone:{command:"Lists",subCommand:"NumberFormatList",value:"none"},numberFormatList:{command:"Lists",subCommand:"NumberFormatList"},bulletFormatList:{command:"Lists",subCommand:"BulletFormatList"},checklist:{command:"Checklist",subCommand:"Checklist"}},prt=function(){function n(){this.services={}}return n.prototype.register=function(n,i){t.isNullOrUndefined(this.services[""+n])&&(this.services[""+n]=i)},n.prototype.getService=function(n){if(t.isNullOrUndefined(this.services[""+n]))throw"The service "+n+" is not registered";return this.services[""+n]},n.prototype.destroy=function(){this.services={}},n}(),wrt=function(){function n(){this.rendererMap={}}return n.prototype.addRenderer=function(n,i){var r=t.getEnumValue(o,n);t.isNullOrUndefined(this.rendererMap[""+r])&&(this.rendererMap[""+r]=i)},n.prototype.getRenderer=function(n){var i=t.getEnumValue(o,n);if(t.isNullOrUndefined(this.rendererMap[""+i]))throw"The renderer "+i+" is not found";return this.rendererMap[""+i]},n.prototype.destroy=function(){this.rendererMap={}},n}(),brt=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(so,this.commandCallBack,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.commandCallBack=function(n){var i=!t.isNullOrUndefined(n.requestType)&&"FormatPainter"===n.requestType&&"format-copy"===n.action;t.isNullOrUndefined(n)||t.isNullOrUndefined(n.requestType)||"Undo"===n.requestType||"Redo"===n.requestType||i||this.parent.formatter.saveData();this.parent.notify(hi,{args:n});this.parent.notify(wc,{})},n.prototype.removeEventListener=function(){this.parent.off(so,this.commandCallBack);this.parent.off(u,this.removeEventListener)},n}();!function(n){n.Top="Top";n.Bottom="Bottom"}(id||(id={}));var rt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},lst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(!0)],r.prototype,"enable",void 0),i([t.Property(!0)],r.prototype,"enableFloating",void 0),i([t.Property(wt.Expand)],r.prototype,"type",void 0),i([t.Property(bet)],r.prototype,"items",void 0),i([t.Property({})],r.prototype,"itemConfigs",void 0),i([t.Property(id.Top)],r.prototype,"position",void 0),r}(t.ChildProperty),ast=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"serviceUrl",void 0),r}(t.ChildProperty),vst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"serviceUrl",void 0),i([t.Property("Sample.docx")],r.prototype,"fileName",void 0),i([t.Property(null)],r.prototype,"stylesheet",void 0),r}(t.ChildProperty),yst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"serviceUrl",void 0),i([t.Property("Sample.pdf")],r.prototype,"fileName",void 0),i([t.Property(null)],r.prototype,"stylesheet",void 0),r}(t.ChildProperty),pst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property([".jpeg",".jpg",".png"])],r.prototype,"allowedTypes",void 0),i([t.Property("inline")],r.prototype,"display",void 0),i([t.Property("Blob")],r.prototype,"saveFormat",void 0),i([t.Property("auto")],r.prototype,"width",void 0),i([t.Property("auto")],r.prototype,"height",void 0),i([t.Property(null)],r.prototype,"saveUrl",void 0),i([t.Property(null)],r.prototype,"path",void 0),i([t.Property(!0)],r.prototype,"resize",void 0),i([t.Property(null)],r.prototype,"removeUrl",void 0),i([t.Property(0)],r.prototype,"minWidth",void 0),i([t.Property(null)],r.prototype,"maxWidth",void 0),i([t.Property(0)],r.prototype,"minHeight",void 0),i([t.Property(null)],r.prototype,"maxHeight",void 0),i([t.Property(!1)],r.prototype,"resizeByPercent",void 0),i([t.Property(3e7)],r.prototype,"maxFileSize",void 0),r}(t.ChildProperty),wst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property([".wav",".mp3",".m4a",".wma"])],r.prototype,"allowedTypes",void 0),i([t.Property("Inline")],r.prototype,"layoutOption",void 0),i([t.Property("Blob")],r.prototype,"saveFormat",void 0),i([t.Property(null)],r.prototype,"saveUrl",void 0),i([t.Property(null)],r.prototype,"removeUrl",void 0),i([t.Property(null)],r.prototype,"path",void 0),i([t.Property(3e7)],r.prototype,"maxFileSize",void 0),r}(t.ChildProperty),bst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property([".mp4",".mov",".wmv",".avi"])],r.prototype,"allowedTypes",void 0),i([t.Property("Inline")],r.prototype,"layoutOption",void 0),i([t.Property("Blob")],r.prototype,"saveFormat",void 0),i([t.Property("auto")],r.prototype,"width",void 0),i([t.Property("auto")],r.prototype,"height",void 0),i([t.Property(null)],r.prototype,"saveUrl",void 0),i([t.Property(null)],r.prototype,"path",void 0),i([t.Property(!0)],r.prototype,"resize",void 0),i([t.Property(null)],r.prototype,"removeUrl",void 0),i([t.Property(0)],r.prototype,"minWidth",void 0),i([t.Property(null)],r.prototype,"maxWidth",void 0),i([t.Property(0)],r.prototype,"minHeight",void 0),i([t.Property(null)],r.prototype,"maxHeight",void 0),i([t.Property(!1)],r.prototype,"resizeByPercent",void 0),i([t.Property(3e7)],r.prototype,"maxFileSize",void 0),r}(t.ChildProperty),kst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property("100%")],r.prototype,"width",void 0),i([t.Property(ya)],r.prototype,"styles",void 0),i([t.Property(!0)],r.prototype,"resize",void 0),i([t.Property(0)],r.prototype,"minWidth",void 0),i([t.Property(null)],r.prototype,"maxWidth",void 0),r}(t.ChildProperty),dst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(!0)],r.prototype,"enable",void 0),i([t.Property(!1)],r.prototype,"showOnRightClick",void 0),i([t.Property("none")],r.prototype,"actionOnScroll",void 0),i([t.Property(["Open","Edit","UnLink"])],r.prototype,"link",void 0),i([t.Property(["AltText","Caption","|","Align","Display","|","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","|","Dimension","Replace","Remove"])],r.prototype,"image",void 0),i([t.Property(["AudioLayoutOption","AudioReplace","AudioRemove"])],r.prototype,"audio",void 0),i([t.Property(["VideoLayoutOption","VideoAlign","|","VideoDimension","VideoReplace","VideoRemove"])],r.prototype,"video",void 0),i([t.Property(null)],r.prototype,"text",void 0),i([t.Property(["Tableheader","TableRemove","|","TableRows","TableColumns","|","Styles","BackgroundColor","Alignments","TableCellVerticalAlign"])],r.prototype,"table",void 0),r}(t.ChildProperty),gst=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property("b; em; font; sub; sup; kbd; i; s; u; code; strong; span; p; div; h1; h2; h3; h4; h5; h6; blockquote; ol; ul; li; pre;")],r.prototype,"allowedFormats",void 0),i([t.Property(null)],r.prototype,"deniedFormats",void 0),r}(t.ChildProperty),nht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(!1)],r.prototype,"prompt",void 0),i([t.Property(null)],r.prototype,"deniedAttrs",void 0),i([t.Property(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","list-style-type","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-transform","text-indent","top","vertical-align","visibility","white-space","width","flex-direction"])],r.prototype,"allowedStyleProps",void 0),i([t.Property(null)],r.prototype,"deniedTags",void 0),i([t.Property(!0)],r.prototype,"keepFormat",void 0),i([t.Property(!1)],r.prototype,"plainText",void 0),r}(t.ChildProperty),tht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("72px")],r.prototype,"width",void 0),i([t.Property(aa)],r.prototype,"items",void 0),r}(t.ChildProperty),iht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("60px")],r.prototype,"width",void 0),i([t.Property(wet)],r.prototype,"items",void 0),r}(t.ChildProperty),rht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("65px")],r.prototype,"width",void 0),i([t.Property(va)],r.prototype,"types",void 0),r}(t.ChildProperty),uht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property("#ff0000")],r.prototype,"default",void 0),i([t.Property("Palette")],r.prototype,"mode",void 0),i([t.Property(10)],r.prototype,"columns",void 0),i([t.Property(pet)],r.prototype,"colorCode",void 0),i([t.Property(!1)],r.prototype,"modeSwitcher",void 0),i([t.Property(!0)],r.prototype,"showRecentColors",void 0),r}(t.ChildProperty),fht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property("#ffff00")],r.prototype,"default",void 0),i([t.Property("Palette")],r.prototype,"mode",void 0),i([t.Property(10)],r.prototype,"columns",void 0),i([t.Property(yet)],r.prototype,"colorCode",void 0),i([t.Property(!1)],r.prototype,"modeSwitcher",void 0),i([t.Property(!0)],r.prototype,"showRecentColors",void 0),r}(t.ChildProperty),eht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(pa)],r.prototype,"types",void 0),r}(t.ChildProperty),oht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(wa)],r.prototype,"types",void 0),r}(t.ChildProperty),sht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return rt(r,n),i([t.Property(ket)],r.prototype,"languages",void 0),i([t.Property("plaintext")],r.prototype,"defaultLanguage",void 0),r}(t.ChildProperty),hht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),krt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},cht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return hht(i,n),krt([t.Property(det)],i.prototype,"iconsSet",void 0),krt([t.Property(!0)],i.prototype,"showSearchBox",void 0),i}(t.ChildProperty);const si=ejdashboard.filemanager;var lht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ht=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},aht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return lht(i,n),ht([t.Event()],i.prototype,"beforeSend",void 0),ht([t.Complex({getImageUrl:null,url:null,uploadUrl:null},si.AjaxSettings)],i.prototype,"ajaxSettings",void 0),ht([t.Property(!1)],i.prototype,"allowDragAndDrop",void 0),ht([t.Complex({visible:!0,file:["Open","|","Cut","Copy","|","Delete","Rename","|","Details"],folder:["Open","|","Cut","Copy","Paste","|","Delete","Rename","|","Details"],layout:["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"]},si.ContextMenuSettings)],i.prototype,"contextMenuSettings",void 0),ht([t.Property("")],i.prototype,"cssClass",void 0),ht([t.Complex({},si.DetailsViewSettings)],i.prototype,"detailsViewSettings",void 0),ht([t.Property(!1)],i.prototype,"enable",void 0),ht([t.Complex({maxWidth:"650px",minWidth:"240px",visible:!0},si.NavigationPaneSettings)],i.prototype,"navigationPaneSettings",void 0),ht([t.Property("/")],i.prototype,"path",void 0),ht([t.Property(null)],i.prototype,"rootAliasName",void 0),ht([t.Complex({},si.SearchSettings)],i.prototype,"searchSettings",void 0),ht([t.Property(!0)],i.prototype,"showFileExtension",void 0),ht([t.Property(!1)],i.prototype,"showHiddenItems",void 0),ht([t.Property(!0)],i.prototype,"showThumbnail",void 0),ht([t.Property("Ascending")],i.prototype,"sortOrder",void 0),ht([t.Complex({visible:!0,items:["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"]},si.ToolbarSettings)],i.prototype,"toolbarSettings",void 0),ht([t.Complex({autoUpload:!0,minFileSize:0,maxFileSize:3e7,allowedExtensions:"",autoClose:!1},si.UploadSettings)],i.prototype,"uploadSettings",void 0),ht([t.Property("LargeIcons")],i.prototype,"view",void 0),i}(t.ChildProperty),drt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),of=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},vht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return drt(i,n),of([t.Property([])],i.prototype,"styles",void 0),of([t.Property([])],i.prototype,"scripts",void 0),i}(t.ChildProperty),yht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return drt(i,n),of([t.Property(!1)],i.prototype,"enable",void 0),of([t.Property(null)],i.prototype,"attributes",void 0),of([t.Complex({},vht)],i.prototype,"resources",void 0),of([t.Property([])],i.prototype,"metaTags",void 0),of([t.Property(null)],i.prototype,"sandbox",void 0),i}(t.ChildProperty),pht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),grt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},wht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return pht(i,n),grt([t.Property(!1)],i.prototype,"enable",void 0),grt([t.Property(!0)],i.prototype,"onSelection",void 0),i}(t.ChildProperty);var nut=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.showFullScreen=function(n){var i=this,r;(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||t.isNullOrUndefined(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.showTooltip&&!t.isNullOrUndefined(document.querySelector(".e-tooltip-wrap"))&&this.parent.notify(re,{args:n}),this.scrollableParent=wi.getScrollableParent(this.parent.element),this.parent.element.classList.contains(fe))||(r={cancel:!1,requestType:"Maximize",targetItem:"Maximize",args:n},this.parent.trigger(l,r,function(r){r.cancel||(i.parent.toolbarSettings.enableFloating&&!i.parent.inlineMode.enable&&i.parent.toolbarSettings.enable&&(i.parent.getToolbarElement().style.width="100%",i.parent.getToolbarElement().style.top="0px"),i.parent.element.classList.add(fe),i.toggleParentOverflow(!0),i.parent.toolbarModule&&(i.parent.getBaseToolbarObject().toolbarObj.items[0].properties||i.parent.getBaseToolbarObject().toolbarObj.removeItems(0),t.Browser.isDevice&&i.parent.toolbarModule.removeFixedTBarClass(),i.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:i.parent.getBaseToolbarObject()})),i.parent.refreshUI(),i.parent.trigger(ct,{requestType:"Maximize",targetItem:"Maximize",args:n}))}))},n.prototype.hideFullScreen=function(n){var i=this,r;(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||t.isNullOrUndefined(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.showTooltip&&!t.isNullOrUndefined(document.querySelector(".e-tooltip-wrap"))&&this.parent.notify(re,{args:n}),this.parent.element.classList.contains(fe))&&(r={cancel:!1,requestType:"Minimize",targetItem:"Minimize",args:n},this.parent.trigger(l,r,function(r){if(!r.cancel){i.parent.element.classList.remove(fe);for(var f=document.querySelectorAll(".e-rte-overflow"),u=0;u<f.length;u++)t.removeClass([f[u]],["e-rte-overflow"]);i.parent.toolbarModule&&(i.parent.getBaseToolbarObject().toolbarObj.items[0].properties||i.parent.getBaseToolbarObject().toolbarObj.removeItems(0),i.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:i.parent.getBaseToolbarObject()}),t.Browser.isDevice&&i.parent.inlineMode.enable&&i.parent.toolbarModule.addFixedTBarClass());i.parent.refreshUI();i.parent.trigger(ct,{requestType:"Minimize",targetItem:"Minimize",args:n})}}))},n.prototype.toggleParentOverflow=function(){var n,i;if(!t.isNullOrUndefined(this.scrollableParent))for(n=0;n<this.scrollableParent.length;n++)"#document"===this.scrollableParent[n].nodeName?(i=document.querySelector("body"),t.addClass([i],["e-rte-overflow"])):(i=this.scrollableParent[n],t.addClass([i],["e-rte-overflow"]))},n.prototype.onKeyDown=function(n){var t=n.args;switch(t.action){case"full-screen":this.showFullScreen(n.args);t.preventDefault();break;case"escape":this.hideFullScreen(n.args);t.preventDefault()}},n.prototype.addEventListener=function(){this.parent.on(y,this.onKeyDown,this);this.parent.on(u,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.off(y,this.onKeyDown);this.parent.off(u,this.destroy)},n.prototype.destroy=function(){if(!t.isNullOrUndefined(this.parent)){this.parent.element.classList.contains(fe)&&this.toggleParentOverflow(!1);for(var i=document.querySelectorAll(".e-rte-overflow"),n=0;n<i.length;n++)t.removeClass([i[n]],["e-rte-overflow"]);this.removeEventListener()}},n}(),bht=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(tl,this.enterHandler,this);this.parent.on(u,this.destroy,this)},n.prototype.destroy=function(){t.isNullOrUndefined(this.parent)||this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.off(tl,this.enterHandler);this.parent.off(u,this.destroy)},n.prototype.getRangeNode=function(){this.range=this.parent.getRange();this.startNode="#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement:this.range.startContainer;this.endNode="#text"===this.range.endContainer.nodeName?this.range.endContainer.parentElement:this.range.endContainer},n.prototype.enterHandler=function(n){var i=this,e,u,h,o,s,f,r,c;if(this.getRangeNode(),e=!0,this.formatTags=["h1","h2","h3","h4","h5","h6","blockquote"],u=this.processedTableImageCursor(),!t.isNullOrUndefined(this.parent.codeBlockModule)&&(h=this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(this.range.startContainer)||this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(this.range.endContainer),!t.isNullOrUndefined(h)))return void this.parent.notify(kc,n);if((u.start||u.end)&&("TABLE"===u.startName||"TABLE"===u.endName))this.handleCursorAtTableSide(n,u.start,u.end);else if((u.start||u.end||"IMG"===this.range.startContainer.nodeName)&&"BR"===this.parent.enterKey&&("IMG"===u.startName||"IMG"===u.endName||"IMG"===this.range.startContainer.nodeName))this.handleEnterKeyAtImageSide(n,u.start,u.end);else{if(!t.isNullOrUndefined(this.startNode.closest("TABLE"))&&!t.isNullOrUndefined(this.endNode.closest("TABLE"))){for(e=!1,o=this.startNode,s=o;!this.parent.formatter.editorManager.domNode.isBlockNode(o);)s=o=o.parentElement;e="TH"!==s.tagName&&"TD"!==s.tagName&&"TBODY"!==s.tagName}f=n.args;13===f.which&&!f.ctrlKey&&(t.Browser.isDevice?"Enter"===f.key:"Enter"===f.code||"NumpadEnter"===f.code)&&t.isNullOrUndefined(this.startNode.closest("LI, UL, OL"))&&t.isNullOrUndefined(this.endNode.closest("LI, UL, OL"))&&t.isNullOrUndefined(this.startNode.closest(".e-img-inner"))&&e&&t.isNullOrUndefined(this.startNode.closest("PRE"))&&t.isNullOrUndefined(this.endNode.closest("PRE"))&&t.isNullOrUndefined(this.startNode.closest("BLOCKQUOTE"))&&t.isNullOrUndefined(this.endNode.closest("BLOCKQUOTE"))&&(r=n.args.shiftKey,c={cancel:!1,name:l,requestType:r?"ShiftEnterAction":"EnterAction",originalEvent:n.args},this.parent.trigger(l,c,function(u){var h,c,k,bt,o,ni,pi,wi,bi,ft,ii,d,tt,ri,ui,ki,st,di,gi,nr,ei,y,b,ir,si,yt,a,hi,f,ht,l,ci,ct,pt,s,g,li,ai,p,rr,rt,ur,nt,fr,et,lt,ot,ut,wt;if(!u.cancel){if(0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),i.range.startOffset!==i.range.endOffset||i.range.startContainer!==i.range.endContainer)if(i.range.startContainer.nodeType!==Node.TEXT_NODE&&("IMG"===i.range.startContainer.nodeName||i.range.startContainer.querySelector("img")||"SPAN"===i.range.startContainer.nodeName&&(i.range.startContainer.classList.contains("e-video-wrap")||i.range.startContainer.classList.contains("e-audio-wrap")))||i.range.deleteContents(),"#text"===i.range.startContainer.nodeName&&0===i.range.startContainer.textContent.length&&i.range.startContainer.parentElement!==i.parent.inputElement)i.range.startContainer.parentElement.innerHTML="BR"===i.parent.enterKey?"&#8203;":"<br>";else if(i.range.startContainer===i.parent.inputElement&&""===i.range.startContainer.innerHTML)i.range.startContainer.innerHTML="P"===i.parent.enterKey?"<p><br><\/p>":"DIV"===i.parent.enterKey?"<div><br><\/div>":"<br>",h=i.range.startContainer.childNodes[i.range.startOffset],i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,0);else if(i.parent.inputElement===i.range.startContainer){if("#text"===(h=i.range.startContainer.childNodes[i.range.startOffset]).nodeName&&0===h.textContent.length)i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,0===h.textContent.length?0:h.previousSibling.textContent.length);else if(i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,h.textContent.length>=0?0:1),0===h.previousSibling.textContent.length){if(t.detach(h.previousSibling),!r){for(c=t.isNullOrUndefined(h.lastChild)?h:h.lastChild;!t.isNullOrUndefined(c)&&"#text"!==c.nodeName&&"BR"!==c.nodeName;)c=c.lastChild;"BR"!==c.nodeName&&0===c.parentElement.textContent.length&&0===c.parentElement.innerHTML.length&&"BR"!==c.parentElement.nodeName&&c.parentElement.appendChild(i.parent.createElement("BR"));i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),"BR"===c.nodeName?c:c.parentElement,c.parentElement.textContent.length>=0||"BR"===c.nodeName?0:1)}}else if(0===h.textContent.length){for(c="#text"===h.previousSibling.nodeName?h.previousSibling:h.previousSibling.lastChild;!t.isNullOrUndefined(c)&&"#text"!==c.nodeName;)c=c.lastChild;i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),c,c.textContent.length);t.detach(h)}else if("BR"!==i.parent.enterKey&&0!==h.previousSibling.textContent.length&&0!==h.textContent.length)return void n.args.preventDefault();i.getRangeNode()}if(i.range.startContainer===i.range.endContainer&&i.range.startOffset===i.range.endOffset&&i.range.startContainer===i.parent.inputElement){if(1!==i.parent.inputElement.childNodes.length||"TABLE"!==i.parent.inputElement.childNodes[0].nodeName)if(t.isNullOrUndefined(i.range.startContainer.childNodes[i.range.startOffset])){for(k=i.range.startContainer.childNodes[i.range.startOffset-1];null!==k.lastChild&&"#text"!==k.nodeName;)k=k.lastChild;i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),k,"BR"===k.nodeName?0:k.textContent.length)}else i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),i.range.startContainer.childNodes[i.range.startOffset],0);i.getRangeNode()}if(bt=i.range.startContainer.childNodes.length>0&&""===i.range.startContainer.childNodes[0].textContent.trim()&&!t.isNullOrUndefined(i.range.startContainer.childNodes[i.range.startOffset])&&"IMG"===i.range.startContainer.childNodes[i.range.startOffset].nodeName,"P"===i.parent.enterKey&&!r||"DIV"===i.parent.enterKey&&!r||"P"===i.parent.shiftEnterKey&&r||"DIV"===i.parent.shiftEnterKey&&r){if(1===i.range.startOffset&&1===i.parent.inputElement.childNodes.length&&"TABLE"===i.parent.inputElement.childNodes[0].nodeName)(f=i.createInsertElement(r)).appendChild(i.parent.createElement("BR")),i.parent.inputElement.appendChild(f),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),f,0);else{o=void 0;o=e&&i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode)?"#text"!==i.range.startContainer.nodeName||t.isNullOrUndefined(i.range.startContainer.previousSibling)||"HR"!==i.range.startContainer.previousSibling.nodeName?i.startNode:i.range.startContainer.nextSibling:i.parent.formatter.editorManager.domNode.blockParentNode(i.startNode);var kt=!1,at=!1,dt=!1,gt=!1;if((nt=i.range.startContainer.parentElement)&&(ni=i.parent.contentModule.getDocument().defaultView.getComputedStyle(nt),dt="pre-wrap"===ni.getPropertyValue("white-space"),gt="nowrap"===ni.getPropertyValue("text-wrap")),0===i.range.startOffset||0===i.range.endOffset||i.range.startContainer!==i.range.endContainer||!t.isNullOrUndefined(o.childNodes[0])&&("IMG"===o.childNodes[0].nodeName||o.querySelectorAll("img, audio, video").length>0))(0===i.range.startOffset&&0===i.range.endOffset||1===i.range.startOffset&&1===i.range.endOffset&&bt)&&(at=!0);else{var ti=i.range.startContainer.textContent,vi=ti.substring(0,i.range.startOffset),yi=vi.charCodeAt(i.range.startOffset-1),vt=0===vi.trim().length;vt&&"#text"!==i.range.startContainer.nodeName&&i.range.startContainer.firstChild&&i.range.startContainer.firstChild.nodeType===Node.ELEMENT_NODE&&"false"===i.range.startContainer.firstChild.getAttribute("contenteditable")&&(vt=0===ti.trim().length);pi=0!==ti.slice(i.range.startOffset).trim().length;(160!==yi&&vt&&!dt&&!gt||32===yi&&(dt||gt)&&vt&&pi)&&!i.range.startContainer.previousSibling&&(at=!0)}if(i.removeBRElement(o),wi=-1!==t.Browser.userAgent.indexOf("Firefox")&&0===i.range.startOffset&&i.range.startContainer===i.range.endContainer&&"#text"===i.range.startContainer.nodeName&&!t.isNullOrUndefined(i.range.startContainer.previousSibling)&&!i.parent.formatter.editorManager.domNode.isBlockNode(i.range.startContainer.previousSibling)&&i.range.startContainer.parentElement===i.range.startContainer.previousSibling.parentElement,bi="#text"===i.range.startContainer.nodeName&&i.range.startContainer.textContent.includes("​")&&"​"===i.range.startContainer.textContent.trim()||"#text"===i.range.startContainer.nodeName&&!t.isNullOrUndefined(i.range.startContainer.textContent[i.range.startOffset])&&i.range.startContainer.textContent[i.range.startOffset].includes("​")&&"​"===i.range.startContainer.textContent[i.range.startOffset]&&"​"!==i.parent.inputElement.textContent[0],("#text"!==i.range.startContainer.nodeName&&"BR"!==i.range.startContainer.nodeName||0!==i.range.startOffset||0!==i.range.endOffset||i.range.startContainer.parentElement!==i.parent.inputElement||"BR"!==i.parent.enterKey||!r)&&!bi&&!wi&&"HR"!==i.range.startContainer.nodeName&&(0===i.range.startOffset&&0===i.range.endOffset||at)&&(t.isNullOrUndefined(i.range.startContainer.previousSibling)||"IMG"!==i.range.startContainer.previousSibling.nodeName&&"BR"!==i.range.startContainer.previousSibling.nodeName)){for(ht=void 0,f=void 0,t.isNullOrUndefined(i.range.startContainer.childNodes)||"#text"===i.range.startContainer.nodeName||0!==i.range.startContainer.textContent.length&&(t.isNullOrUndefined(i.range.startContainer.querySelector(".e-video-clickelem"))||0!==i.range.startContainer.querySelector(".e-video-clickelem").textContent.length)||!(i.range.startContainer.querySelectorAll("img, audio, video").length>0)&&t.isNullOrUndefined(i.range.startContainer.querySelector(".e-video-clickelem"))&&"IMG"!==i.range.startContainer.nodeName&&"TABLE"!==i.range.startContainer.nodeName?0!==o.textContent.trim().length||!t.isNullOrUndefined(o.childNodes[0])&&"IMG"===o.childNodes[0].nodeName||""===o.textContent.trim()&&o.querySelectorAll("img, audio, video").length>0?(i.range.startOffset===i.range.endOffset&&0!==i.range.startOffset?f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!1).cloneNode(!0):(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0).cloneNode(!0),kt=!0),ht=!1):(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0).cloneNode(!0),ht=!0):(f=i.createInsertElement(r),kt=!0,ht=!1),l=void 0,l=i.formatTags.indexOf(f.nodeName.toLocaleLowerCase())<0?i.createInsertElement(r):i.parent.createElement(f.nodeName);f.firstChild;)l.appendChild(f.firstChild);if(ci=!(i.range.startContainer===o||!(o.querySelector(".e-video-wrap")||o.querySelector(".e-audio-wrap")&&i.range.startContainer.classList.contains("e-clickelem"))),ct=!(i.range.startContainer===o||!o.querySelector("img")),ci?i.parent.formatter.editorManager.domNode.insertAfter(l,o):o.parentElement.insertBefore(l,o),!ht){if(c=l,pt=void 0,i.range.startOffset===i.range.endOffset&&0!==i.range.startOffset)for(;!t.isNullOrUndefined(c)&&"#text"!==c.nodeName&&"BR"!==c.nodeName;)pt=c,c=c.lastChild;else pt=c;pt.innerHTML="<br>";kt||t.detach(o)}ci||ct?i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),l,0):i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),l.nextElementSibling,0)}else if(o===i.parent.inputElement||0!==o.textContent.length||!t.isNullOrUndefined(o.childNodes[0])&&"IMG"===o.childNodes[0].nodeName||o.querySelectorAll("video").length>0||o.querySelectorAll(".e-video-wrap").length>0||o.querySelectorAll("audio").length>0||o.querySelectorAll("img").length>0)if(i.range.startContainer===i.range.endContainer&&i.range.startContainer.nodeType!==Node.TEXT_NODE&&("IMG"===i.range.startContainer.nodeName||i.range.startContainer.querySelector("img")||"SPAN"===i.range.startContainer.nodeName&&(i.range.startContainer.classList.contains("e-video-wrap")||i.range.startContainer.classList.contains("e-audio-wrap")))){if(o.textContent.trim().length>0&&(!o.querySelector("iframe")||"&ZeroWidthSpace;"!==o.textContent)){if(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0),ft=t.isNullOrUndefined(f.previousSibling.querySelector(".e-video-wrap"))?f.previousSibling.querySelector(".e-audio-wrap"):f.previousSibling.querySelector(".e-video-wrap"),ii=!1,!t.isNullOrUndefined(ft)){for(d=ft.previousSibling;!t.isNullOrUndefined(d)&&"#text"!==d.nodeName;)d=d.lastChild;t.isNullOrUndefined(d)&&(tt=i.parent.createElement("br"),ft.parentElement.appendChild(tt),ii=!0);ii?i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),ft.parentElement,0):i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),d,d.textContent.length);t.detach(ft)}}else{for(h=(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0)).hasChildNodes()?f.previousSibling:f,ri=t.isNullOrUndefined(f.querySelector("img"))?null:f.querySelector("img"),ui=t.isNullOrUndefined(f.querySelector(".e-video-wrap"))?null:f.querySelector(".e-video-wrap"),(l=i.createInsertElement(r),t.isNullOrUndefined(ri)&&t.isNullOrUndefined(ui))?t.isNullOrUndefined(ri)&&h.querySelector("img")&&(h=f):at?(f.parentElement.insertBefore(l,f),h=f.previousSibling):(i.parent.formatter.editorManager.domNode.insertAfter(l,f),ki=ui&&h.nodeType===Node.ELEMENT_NODE&&1===h.children.length&&h.lastChild.classList.contains("e-video-wrap"),!t.isNullOrUndefined(h)&&h!==f&&f.previousSibling===h&&ki&&t.detach(h),h=f.nextSibling);!t.isNullOrUndefined(h.firstChild);)t.detach(h.firstChild);tt=i.parent.createElement("br");h.appendChild(tt);i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,0)}t.isNullOrUndefined(i.parent.audioModule)||i.parent.audioModule.hideAudioQuickToolbar();t.isNullOrUndefined(i.parent.videoModule)||i.parent.videoModule.hideVideoQuickToolbar()}else if("BR"===i.parent.enterKey&&r&&i.range.startContainer.nodeType===Node.TEXT_NODE&&i.range.startContainer.parentElement&&i.range.startContainer.parentElement===i.parent.inputElement){var it=i.range,v=it.startContainer,fi=it.startOffset,w=i.parent.createElement(i.parent.shiftEnterKey);v.nodeType===Node.TEXT_NODE&&0!==it.endOffset&&0!==it.startOffset?(st=v,fi<st.length?(di=st.splitText(fi),w.appendChild(di)):w.innerHTML="<br>",st.parentNode.insertBefore(w,st.nextSibling),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),w,0)):0===fi&&0===it.endOffset&&((w.innerHTML="<br>",it.endOffset===v.textContent.length)&&(gi=i.parent.createElement("br"),v.parentNode.insertBefore(gi,v)),v.parentNode.insertBefore(w,v),nr=it.endOffset===v.textContent.length?w:w.nextSibling,v.parentNode.insertBefore(w,v),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),nr,0))}else{if(ei=!1,y=null,i.range.startContainer===i.range.endContainer&&(b=i.getCursorNode(i.range),b&&b.parentNode)){var oi=b,er=oi.previousElementSibling&&"BR"===oi.previousElementSibling.nodeName,tr="BR"===b.nodeName;(er||tr)&&(y=document.createTextNode("​"),b.parentNode.insertBefore(y,b),tr&&!oi.previousElementSibling&&b.parentNode.insertBefore(document.createElement("br"),y),i.range.setStartAfter(y),i.range.setEndBefore(b),ei=!0)}if((f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0),ei&&y&&y.parentNode&&"​"===y.textContent&&y.parentNode.removeChild(y),t.isNullOrUndefined(f.childNodes[0])||"#text"!==f.childNodes[0].nodeName||0!==f.childNodes[0].textContent.length||t.detach(f.childNodes[0]),0===f.textContent.trim().length||f.childNodes[0].textContent.trim().includes("​")&&"​"===f.childNodes[0].textContent.trim())&&((tt=i.parent.createElement("br"),"A"===i.startNode.nodeName||i.startNode.closest("a"))?(i.startNode="A"===i.startNode.nodeName?i.startNode:i.startNode.closest("a"),ir=i.startNode.parentElement,i.startNode.parentElement.insertBefore(tt,i.startNode),t.detach(i.startNode),i.startNode=ir):"BR"!==i.startNode.nodeName&&i.startNode.appendChild(tt),"\n"===f.childNodes[0].textContent&&t.detach(f.childNodes[0]),f.childNodes[0].textContent.trim().includes("​")&&"​"===f.childNodes[0].textContent.trim()&&t.detach(f.childNodes[0]),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),i.startNode,0)),(("P"===i.parent.enterKey||"DIV"===i.parent.enterKey)&&!r||("DIV"===i.parent.shiftEnterKey||"P"===i.parent.shiftEnterKey)&&r)&&(si=i.formatTags.indexOf(f.nodeName.toLocaleLowerCase()),si<0||si>=0&&0===f.textContent.trim().length)){for(yt=i.createInsertElement(r);f.firstChild;)yt.appendChild(f.firstChild);i.parent.formatter.editorManager.domNode.insertAfter(yt,f);t.detach(f);a=i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode)?yt:i.startNode;hi=0;a&&("A"===a.nodeName||a.closest("a"))&&(a="A"===a.nodeName?a:a.closest("a"),(a=i.getFirstTextNode(a)).nodeValue="​"+a.nodeValue,hi=1);i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),a,hi)}}else t.isNullOrUndefined(o.children[0])||"BR"===o.children[0].tagName?((l=i.createInsertElement(r)).innerHTML="<br>",i.parent.formatter.editorManager.domNode.insertAfter(l,o),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),l,0)):(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!1).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(f,o),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),f,f.textContent.length>=0?0:1))}n.args.preventDefault()}if("BR"===i.parent.enterKey&&!r||"BR"===i.parent.shiftEnterKey&&r){if(s=void 0,i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode))s=i.startNode;else{for(g=i.startNode,li=g;!i.parent.formatter.editorManager.domNode.isBlockNode(g);)li=g,g=g.parentElement;s=g===i.parent.inputElement?li:g}for(ai=window.getComputedStyle(s),i.removeBRElement(s),p=s.lastChild;!t.isNullOrUndefined(p)&&"#text"!==p.nodeName&&"BR"!==p.nodeName&&"IMG"!==p.nodeName;)p=p.lastChild;if(rr=i.range.startContainer===p?i.range.startContainer.textContent.length:s.textContent.length,ct="IMG"===i.range.startContainer.nodeName||i.range.startContainer.childNodes.length>0&&!t.isNullOrUndefined(i.range.startContainer.childNodes[i.range.startOffset])&&"IMG"===i.range.startContainer.childNodes[i.range.startOffset].nodeName||1===i.range.startContainer.nodeType&&null!==i.range.startContainer.querySelector("img"),s!==i.parent.inputElement&&i.parent.formatter.editorManager.domNode.isBlockNode(s)&&i.range.startOffset===i.range.endOffset&&(i.range.startOffset===rr||0===s.textContent.trim().length&&ct))rt=i.parent.createElement("br"),0===i.range.startOffset&&"TABLE"===i.range.startContainer.nodeName?i.range.startContainer.parentElement.insertBefore(rt,i.range.startContainer):"BR"===p.nodeName&&0===s.textContent.length?i.parent.formatter.editorManager.domNode.insertAfter(rt,p):0===i.range.startOffset&&0===i.range.endOffset&&ct?(ur="IMG"===i.range.startContainer.nodeName?i.range.startContainer:i.range.startContainer.childNodes[i.range.startOffset],s.insertBefore(rt,ur)):1===i.range.startOffset&&1===i.range.endOffset&&bt?s.insertBefore(rt,i.range.startContainer):(fr=i.parent.createElement("br"),et=void 0,(nt=i.range.startContainer.parentElement)&&"A"===nt.nodeName&&nt.textContent.length===i.range.startOffset?et=nt:nt&&(et=nt.closest("a")||i.range.startContainer),i.parent.formatter.editorManager.domNode.insertAfter(rt,et),i.parent.formatter.editorManager.domNode.insertAfter(fr,et),lt=et.nextElementSibling,ot=t.isNullOrUndefined(lt)?null:lt.nextElementSibling,t.isNullOrUndefined(lt)||t.isNullOrUndefined(ot)||t.isNullOrUndefined(ot.nextElementSibling)||"BR"!==lt.nodeName||"BR"!==ot.nodeName||"BR"!==ot.nextElementSibling.nodeName||ot.nextElementSibling.remove()),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),rt,0);else if(t.isNullOrUndefined(s)||s===i.parent.inputElement||"BR"===s.nodeName)i.insertBRElement();else if(0===s.textContent.trim().length||1===s.textContent.trim().length&&8203===s.textContent.charCodeAt(0))s.childElementCount>0&&"IMG"===s.lastElementChild.nodeName||s.lastElementChild&&"BR"===s.lastElementChild.nodeName||!t.isNullOrUndefined(s.firstElementChild)&&(s.querySelector(".e-video-wrap")||s.classList.contains("e-video-wrap")||s.querySelector(".e-audio-wrap")||s.classList.contains("e-audio-wrap"))?i.insertBRElement():(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!0).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(f,s),ut=i.parent.createElement("br"),f.parentElement.insertBefore(ut,f),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),f,0));else if(f=void 0,ut=i.parent.createElement("br"),0!==i.range.startOffset||0!==i.range.endOffset||t.isNullOrUndefined(s.previousSibling)||"BR"!==s.previousSibling.nodeName||"P"===s.nodeName||"DIV"===s.nodeName)s===i.parent.inputElement||"inline"!==ai.display&&"inline-block"!==ai.display?"A"===i.startNode.nodeName||i.startNode.closest("A")?(i.startNode="A"===i.startNode.nodeName?i.startNode:i.startNode.closest("A"),i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,i.startNode,!0).cloneNode(!0),i.startNode.parentElement.insertBefore(ut,i.startNode),wt=i.getFirstTextNode(i.startNode),wt.nodeValue="​"+wt.nodeValue,i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),wt,1)):i.insertBRElement():(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!0).cloneNode(!0),s.parentElement.insertBefore(ut,s),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),s,0),i.insertFocusContent());else{for(f=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!1).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(ut,s),i.insertFocusContent(),c=ut.nextSibling;!t.isNullOrUndefined(c)&&"#text"!==c.nodeName;)c=c.lastChild;i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),c,0)}n.args.preventDefault()}i.triggerActionComplete(n,r);i.parent.inputElement.dispatchEvent(new Event("input"))}}))}},n.prototype.getCursorNode=function(n){var t=n.startContainer,i=n.startOffset;return t.nodeType===Node.TEXT_NODE?t:t.nodeType===Node.ELEMENT_NODE?t.childNodes[i]||t:null},n.prototype.getFirstTextNode=function(n){return this.parent.contentModule.getDocument().createTreeWalker(n,NodeFilter.SHOW_TEXT,null).nextNode()},n.prototype.removeBRElement=function(n){-1!==t.Browser.userAgent.indexOf("Firefox")&&this.range.endOffset===n.textContent.length&&(0!==n.textContent.length||n.querySelectorAll("BR").length>1)&&!t.isNullOrUndefined(n.lastChild)&&"BR"===n.lastChild.nodeName&&t.detach(n.lastChild)},n.prototype.insertBRElement=function(){var i=!1,e=!0,o=!1,n,r,u,s,h,f;for(0===this.range.endContainer.textContent.length&&"BR"===this.range.startContainer.nodeName&&(e=!1),n=this.parent.createElement("br"),r=this.startNode;r.lastChild;)r=r.lastChild;u="A"===this.startNode.nodeName&&"A"===this.endNode.nodeName&&!t.isNullOrUndefined(this.range.startContainer.parentElement)&&this.range.startOffset===this.range.endOffset&&this.range.startContainer.textContent.trim().length===r.textContent.trim().length;"BR"===this.startNode.nodeName&&"BR"===this.endNode.nodeName&&0===this.range.startOffset&&this.range.startOffset===this.range.endOffset?(this.parent.formatter.editorManager.domNode.insertAfter(n,this.startNode),i=!0):(this.startNode!==this.parent.inputElement||t.isNullOrUndefined(this.range.startContainer.previousSibling)||"BR"!==this.range.startContainer.previousSibling.nodeName||0!==this.range.startContainer.textContent.length||(i=!0),u?this.parent.formatter.editorManager.domNode.insertAfter(n,this.startNode):"SPAN"===this.startNode.tagName&&(this.startNode.classList.contains("e-video-wrap")||this.startNode.classList.contains("e-audio-wrap"))?(this.startNode.parentElement.insertBefore(n,this.startNode),i=!0):this.startNode!==this.parent.inputElement&&this.startNode.nodeType===Node.ELEMENT_NODE&&this.startNode.childElementCount>0&&"IMG"===this.startNode.lastElementChild.nodeName?(this.startNode.parentElement.insertBefore(n,this.startNode),i=!0,o=!0):(this.range.insertNode(n),i=!0));s=!t.isNullOrUndefined(n.nextSibling)&&(n.nextSibling.textContent.length>0||"#text"!==n.nextSibling.nodeName&&(n.nextSibling.querySelectorAll("audio,video,table,img").length>0||n.nextSibling.querySelectorAll(".e-video-wrap").length>0))||!t.isNullOrUndefined(n.nextElementSibling)&&"BR"===n.nextElementSibling.tagName||"BR"===this.range.startContainer.nodeName;h=!t.isNullOrUndefined(n.nextSibling)&&!t.isNullOrUndefined(n.nextSibling.classList)&&(n.nextSibling.classList.contains("e-video-wrap")||n.nextSibling.classList.contains("e-audio-wrap"));s&&(i||!t.isNullOrUndefined(n.nextSibling)&&"#text"===n.nextSibling.nodeName&&0===n.nextSibling.textContent.trim().length&&!t.isNullOrUndefined(n.nextSibling.nextSibling)&&n.nextSibling.nextSibling.textContent.trim().length>0)?(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),t.isNullOrUndefined(n.nextSibling)||!e||o||h?n:n.nextSibling,0),i=!1):(f=this.parent.createElement("br"),u?this.parent.formatter.editorManager.domNode.insertAfter(f,this.startNode):this.range.insertNode(f),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),n,0))},n.prototype.insertFocusContent=function(){0===this.range.startContainer.textContent.length&&("#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement.innerHTML="&#8203;":this.range.startContainer.innerHTML="&#8203;")},n.prototype.createInsertElement=function(n){var u,i,r;return"DIV"===this.parent.enterKey&&!n||"DIV"===this.parent.shiftEnterKey&&n?u=this.parent.createElement("div"):("P"===this.parent.enterKey&&!n||"P"===this.parent.shiftEnterKey&&n)&&(u=this.parent.createElement("p")),i=this.parent.formatter.editorManager.domNode.blockNodes()[0].previousSibling,r=this.parent.formatter.editorManager.domNode.blockNodes()[0].nextSibling,!t.isNullOrUndefined(i)&&"#text"!==i.nodeName&&i.hasAttribute("style")&&"TABLE"!==i.nodeName&&(u.style.cssText=i.getAttribute("style")),t.isNullOrUndefined(i)&&!t.isNullOrUndefined(r)&&"#text"!==r.nodeName&&r.hasAttribute("style")&&"TABLE"!==r.nodeName&&(u.style.cssText=r.getAttribute("style")),u},n.prototype.triggerActionComplete=function(n,t){this.parent.trigger(ct,{requestType:t?"ShiftEnterAction":"EnterAction",args:n.args})},n.prototype.handleCursorAtTableSide=function(n,i,r){var u=this,f,e;"BR"!==this.parent.enterKey&&(f=n.args.shiftKey,e={cancel:!1,name:l,requestType:f?"ShiftEnterAction":"EnterAction",originalEvent:n.args},this.parent.trigger(l,e,function(e){var s,o;e.cancel||(s=u.parent.createElement(u.parent.enterKey),s.innerHTML="<br>",o=void 0,i&&(o=u.range.startContainer.childNodes[u.range.startOffset]).parentElement.insertBefore(s,o),r&&(o=u.range.startContainer.childNodes[u.range.startOffset-1],t.isNullOrUndefined(o.nextSibling)?t.isNullOrUndefined(o.nextSibling)&&o.parentElement.appendChild(s):o.parentElement.insertBefore(s,o.nextSibling)),u.parent.formatter.editorManager.nodeSelection.setCursorPoint(u.parent.contentModule.getDocument(),s,0),n.args.preventDefault(),u.triggerActionComplete(n,f))}))},n.prototype.handleEnterKeyAtImageSide=function(n,i,r){var u=this,e={cancel:!1,name:l,requestType:n.args.shiftKey?"ShiftEnterAction":"EnterAction",originalEvent:n.args},f=!1;"IMG"===this.range.startContainer.nodeName&&0===this.range.startOffset&&(f=!0);this.parent.trigger(l,e,function(e){var s,o,h;e.cancel||"BR"!==u.parent.enterKey||(s=u.parent.createElement("BR"),o=void 0,(f&&((o=u.range.startContainer).parentElement.insertBefore(s,o),u.parent.formatter.editorManager.nodeSelection.setCursorPoint(u.parent.contentModule.getDocument(),o,0)),i&&((o=u.range.startContainer.childNodes[u.range.startOffset]).parentElement.insertBefore(s,o),u.parent.formatter.editorManager.nodeSelection.setCursorPoint(u.parent.contentModule.getDocument(),o,0)),r)&&((o=u.range.startContainer.childNodes[u.range.startOffset-1],t.isNullOrUndefined(o.nextSibling))?t.isNullOrUndefined(o.nextSibling)&&(o.parentElement.appendChild(s),h=u.parent.createElement("BR"),o.parentElement.appendChild(h),u.parent.formatter.editorManager.nodeSelection.setCursorPoint(u.parent.contentModule.getDocument(),h,0)):(o.parentElement.insertBefore(s,o.nextSibling),u.parent.formatter.editorManager.nodeSelection.setCursorPoint(u.parent.contentModule.getDocument(),s.nextSibling,0))),n.args.preventDefault(),u.triggerActionComplete(n,n.args.shiftKey))})},n.prototype.isTableOrImageStart=function(){var n=this.range.startContainer,t=this.range.startOffset,i=this.range.collapsed&&1===n.nodeType&&n.isContentEditable&&n.childNodes[t]&&["IMG","TABLE"].indexOf(n.childNodes[t].nodeName)>-1;return i?{start:i,startNodeName:n.childNodes[t].nodeName}:{start:!1,startNodeName:""}},n.prototype.isTableOrImageEnd=function(){var n=this.range.startContainer,t=this.range.startOffset,i=this.range.collapsed&&1===n.nodeType&&n.isContentEditable&&n.childNodes[t-1]&&["IMG","TABLE"].indexOf(n.childNodes[t-1].nodeName)>-1;return i?{end:i,endNodeName:n.childNodes[t-1].nodeName}:{end:!1,endNodeName:""}},n.prototype.processedTableImageCursor=function(){var n=this.isTableOrImageStart(),i=n.start,r=n.startNodeName,t=this.isTableOrImageEnd();return{start:i,startName:r,end:t.end,endName:t.endNodeName}},n}(),kht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wp=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},dht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return kht(i,n),wp([t.Property(!1)],i.prototype,"enable",void 0),wp([t.Property(["Paragraph","Heading 1","Heading 2","Heading 3","Heading 4","OrderedList","UnorderedList","CodeBlock","Blockquote"])],i.prototype,"items",void 0),wp([t.Property("300px")],i.prototype,"popupWidth",void 0),wp([t.Property("320px")],i.prototype,"popupHeight",void 0),i}(t.ChildProperty),ght=[{command:"Paragraph",subCommand:"p",type:"Basic Block",iconCss:"e-rte-paragraph"},{command:"Heading 1",subCommand:"h1",type:"Basic Block",iconCss:"e-rte-h1"},{command:"Heading 2",subCommand:"h2",type:"Basic Block",iconCss:"e-rte-h2"},{command:"Heading 3",subCommand:"h3",type:"Basic Block",iconCss:"e-rte-h3"},{command:"Heading 4",subCommand:"h4",type:"Basic Block",iconCss:"e-rte-h4"},{command:"OrderedList",subCommand:"insertOrderedList",type:"Basic Block",iconCss:"e-list-ordered e-icons"},{command:"UnorderedList",subCommand:"insertUnorderedList",type:"Basic Block",iconCss:"e-list-unordered e-icons"},{command:"Blockquote",subCommand:"blockquote",type:"Basic Block",iconCss:"e-blockquote e-icons"},{command:"CodeBlock",subCommand:"pre",type:"Basic Block",iconCss:"e-code-view e-icons"}],nct=[{command:"Image",subCommand:d.InsertImage,type:"Media",module:"Image",iconCss:"e-icons e-image"},{command:"Audio",subCommand:d.InsertAudio,type:"Media",module:"Audio",iconCss:"e-icons e-audio"},{command:"Video",subCommand:d.InsertVideo,type:"Media",module:"Video",iconCss:"e-icons e-video"},{command:"Link",subCommand:d.InsertLink,type:"Inline",module:"Link",iconCss:"e-icons e-link"},{command:"Table",subCommand:d.InsertTable,type:"Basic Block",module:"Table",iconCss:"e-icons e-table"},{command:"Emojipicker",subCommand:null,type:"Inline",module:"EmojiPicker",iconCss:"e-icons e-emoji"}],tct=function(){function n(n){this.isDestroyed=!1;this.parent=n;this.rteID=n.element.id}return n.prototype.renderPopup=function(n,i){var r=this,u=this.parent.createElement("div"),f;this.parent.rootContainer.appendChild(u);f=this.parent.createElement("input",{id:this.rteID+"_"+n.toLowerCase()+"_upload",attrs:{type:"File",name:"UploadFiles"}});switch(this.popupObj=new wi.Popup(u,{relateTo:i,viewPortElement:this.parent.inputElement,zIndex:10001,content:f,enableRtl:this.parent.enableRtl,height:"85px",width:"300px",actionOnScroll:"none",close:function(){r.parent.isBlur=!1;r.popupObj&&(r.popupObj.destroy(),t.detach(r.popupObj.element),r.popupObj=null);!r.parent.inlineMode.enable&&r.parent.toolbarModule&&r.parent.toolbarModule.baseToolbar&&r.parent.toolbarModule.baseToolbar.toolbarObj.disable(!1)}}),this.popupObj.element.style.display="none",t.addClass([this.popupObj.element],wu),t.addClass([this.popupObj.element],hb),n){case"Images":this.popupObj.element.classList.add(itt);break;case"Videos":this.popupObj.element.classList.add(rtt);break;case"Audios":this.popupObj.element.classList.add(utt)}return t.isNullOrUndefined(this.parent.cssClass)||t.addClass([this.popupObj.element],this.parent.cssClass.replace(/\s+/g," ").trim().split(" ")),this.popupObj},n.prototype.createUploader=function(n,i,r,u){var o,s,h,f=this,e=!1,c="";switch(n){case"Images":c=this.parent.insertImageSettings.allowedTypes.toString();o=this.parent.insertImageSettings.saveUrl;s=this.parent.insertImageSettings.removeUrl;h=this.parent.insertImageSettings.maxFileSize;break;case"Videos":c=this.parent.insertVideoSettings.allowedTypes.toString();o=this.parent.insertVideoSettings.saveUrl;s=this.parent.insertVideoSettings.removeUrl;h=this.parent.insertVideoSettings.maxFileSize;break;case"Audios":c=this.parent.insertAudioSettings.allowedTypes.toString();o=this.parent.insertAudioSettings.saveUrl;s=this.parent.insertAudioSettings.removeUrl;h=this.parent.insertAudioSettings.maxFileSize}return this.uploadObj=new ot.Uploader({asyncSettings:{saveUrl:o,removeUrl:s},cssClass:ab+this.parent.getCssClass(!0),dropArea:this.parent.element,allowedExtensions:c,maxFileSize:h,multiple:!1,enableRtl:this.parent.enableRtl,removing:function(){f.parent.inputElement.contentEditable="true";e=!1;r&&t.detach(r);f.popupObj&&f.popupObj.close()},canceling:function(){f.parent.inputElement.contentEditable="true";e=!1;r&&t.detach(r);f.popupObj&&f.popupObj.close();f.parent.quickToolbarModule&&("Images"===n&&f.parent.quickToolbarModule.imageQTBar?f.parent.quickToolbarModule.imageQTBar.hidePopup():"Videos"===n&&f.parent.quickToolbarModule.videoQTBar?f.parent.quickToolbarModule.videoQTBar.hidePopup():"Audios"===n&&f.parent.quickToolbarModule.audioQTBar&&f.parent.quickToolbarModule.audioQTBar.hidePopup());f.uploadCancelTime=setTimeout(function(){f.uploadObj&&!f.uploadObj.isDestroyed&&f.uploadObj.destroy()},900)},beforeUpload:function(t){var i="Images"===n?hl:cl;f.parent.trigger(i,t);!f.parent.inlineMode.enable&&f.parent.toolbarModule&&f.parent.toolbarModule.baseToolbar&&f.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0)},uploading:function(i){if(!f.parent.isServerRendered){e=!0;var u="Images"===n?il:fl;f.parent.trigger(u,i,function(n){n.cancel?(r&&!t.isNullOrUndefined(r)&&t.detach(r),f.popupObj&&f.popupObj.element&&!t.isNullOrUndefined(f.popupObj.element)&&t.detach(f.popupObj.element)):f.parent.inputElement.contentEditable="false"})}},selected:function(n){e&&(n.cancel=!0)},failure:function(t){e=!1;f.parent.inputElement.contentEditable="true";var u={args:i,type:n,isNotify:void 0,elements:r};f.uploadFailureTime=setTimeout(function(){f.uploadFailure(r,u,t)},900)},success:function(t){if("cancel"!==t.operation){e=!1;f.parent.inputElement.contentEditable="true";var u,o,s={args:i,type:n,isNotify:void 0,elements:r};"Images"===n?u={e:t.e,file:t.file,statusText:t.statusText,operation:t.operation,response:t.response,element:r,detectImageSource:ge.Dropped}:o={e:t.e,file:t.file,statusText:t.statusText,operation:t.operation,response:t.response,element:r,detectMediaSource:ry.Dropped};f.uploadSuccessTime=setTimeout(function(){"Images"===n?f.uploadSuccess(r,i,s,u):"Videos"!==n&&"Audios"!==n||f.uploadSuccess(r,i,s,o)},900)}}}),this.uploadObj.appendTo(u),this.uploadObj},n.prototype.uploadFailure=function(n,i,r){n&&t.detach(n);this.popupObj&&this.popupObj.close();var u="Images"===i.type?ul:ol;this.parent.trigger(u,r);this.uploadObj&&!this.uploadObj.isDestroyed&&this.uploadObj.destroy()},n.prototype.uploadSuccess=function(n,i,r,u){var f=this,e,o;if("cancel"!==u.operation){switch(n.style.opacity="1",r.type){case"Images":n.classList.add(rh);break;case"Videos":case"Audios":e="Videos"===r.type?dt:oi;n.classList.add(e)}o="Images"===r.type?rl:el;this.parent.trigger(o,u,function(i){var u,e,s,o;if(n&&i.file){u=i.file.name;switch(r.type){case"Images":t.isNullOrUndefined(f.parent.insertImageSettings.path)||(e=f.parent.insertImageSettings.path+u,n.src=e,n.setAttribute("alt",u));break;case"Videos":!t.isNullOrUndefined(f.parent.insertVideoSettings.path)&&(e=f.parent.insertVideoSettings.path+u,o=n.querySelector("source"))&&(o.setAttribute("src",e),s=u.split(".").pop().toLowerCase(),o.setAttribute("type","video/"+s),n.style.opacity="1");break;case"Audios":t.isNullOrUndefined(f.parent.insertAudioSettings.path)||(e=f.parent.insertAudioSettings.path+u,(o=n.querySelector("source"))&&(o.setAttribute("src",e),s=u.split(".").pop().toLowerCase(),o.setAttribute("type","audio/"+s),n.style.opacity="1",n.load()))}}});this.popupObj&&this.popupObj.close();this.uploadObj&&!this.uploadObj.isDestroyed&&this.uploadObj.destroy();"Images"===r.type?(this.parent.notify(ii,r),this.parent.insertImageSettings.resize&&this.parent.notify(cu,{event:i,element:n})):"Videos"===r.type?(this.parent.notify(ii,r),setTimeout(function(){f.parent.notify(cu,{event:i,element:n})},100)):"Audios"===r.type&&this.parent.notify(ii,r)}},n.prototype.refreshPopup=function(n){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(this.popupObj.offsetY=this.parent.iframeSettings.enable?-30:-65,this.popupObj.element.style.display="block"):this.popupObj&&(this.popupObj.refreshPosition(n),this.popupObj.element.style.display="block")},n.prototype.destroy=function(){this.isDestroyed||(t.isNullOrUndefined(this.uploadCancelTime)||(clearTimeout(this.uploadCancelTime),this.uploadCancelTime=null),t.isNullOrUndefined(this.uploadFailureTime)||(clearTimeout(this.uploadFailureTime),this.uploadFailureTime=null),t.isNullOrUndefined(this.uploadSuccessTime)||(clearTimeout(this.uploadSuccessTime),this.uploadSuccessTime=null),this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),t.detach(this.popupObj.element),this.popupObj=null),this.uploadObj&&!this.uploadObj.isDestroyed&&(this.uploadObj.destroy(),t.detach(this.uploadObj.element),this.uploadObj=null),this.isDestroyed=!0)},n}(),ict=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rd=function(){return rd=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n},rd.apply(this,arguments)},r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},rct=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.hasContentChanged=!1,r.isPlainPaste=!1,r.needsID=!0,r.isCopyAll=!1,r.isSelecting=!1,r.isSelectionStartInRTE=!1,r}return ict(i,n),i.prototype.requiredModules=function(){var n=[];return this.toolbarSettings.enable&&(n.push({member:"toolbar",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&n.push({member:"quickToolbar",args:[this,this.serviceLocator]})),"HTML"===this.editorMode&&this.slashMenuSettings.enable&&n.push({member:"slashMenu",args:[this,this.serviceLocator]}),this.showCharCount&&n.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&n.push({member:"markdownEditor",args:[this,this.serviceLocator]}),n.push({member:"link",args:[this,this.serviceLocator]}),n.push({member:"table",args:[this,this.serviceLocator]}),n.push({member:"image",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(n.push({member:"audio",args:[this,this.serviceLocator]}),n.push({member:"video",args:[this,this.serviceLocator]}),n.push({member:"htmlEditor",args:[this,this.serviceLocator]}),n.push({member:"pasteCleanup",args:[this,this.serviceLocator]}),n.push({member:"importExport",args:[this,this.serviceLocator]}),n.push({member:"formatPainter",args:[this]}),n.push({member:"emojiPicker",args:[this,this.serviceLocator]}),n.push({member:"codeBlock",args:[this,this.serviceLocator]})),this.fileManagerSettings.enable&&n.push({member:"fileManager",args:[this,this.serviceLocator]}),this.enableResize&&n.push({member:"resize",args:[this]}),n},i.prototype.updateEnable=function(){this.enabled?(t.removeClass([this.element],ra),this.element.setAttribute("aria-disabled","false"),t.isNullOrUndefined(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(t.removeClass(this.getToolbar().querySelectorAll("."+uu),uu),t.removeClass([this.getToolbar().parentElement],[as])),t.addClass([this.element],ra),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},i.prototype.setEnable=function(){this.updateEnable();this.enabled?this.eventInitializer():this.unWireEvents()},i.prototype.initializeValue=function(){this.isFocusOut=!1;this.isRTE=!1;this.isBlur=!0;this.defaultResetValue=null;this.isResizeInitialized=!1},i.prototype.preRender=function(){this.initializeValue();this.clickPoints={clientX:0,clientY:0};this.initialValue=this.value;this.serviceLocator=new prt;this.initializeServices();this.setContainer();this.persistData();t.setStyleAttribute(this.element,{width:t.formatUnit(this.width)});t.attributes(this.element,{role:"application","aria-label":"Rich Text Editor"});this.beforeRenderClassValue=this.element.getAttribute("class")},i.prototype.persistData=function(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){this.element.id=this.originalElement.id+"_wrapper";var n=window.localStorage.getItem(this.getModuleName()+this.element.id);t.isNullOrUndefined(n)||""===n||this.setProperties(JSON.parse(n),!0)}},i.prototype.setContainer=function(){var u,f,r;this.originalElement=this.element.cloneNode(!0);null!==this.value&&null===this.valueTemplate||this.setValue();this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex"));this.element.innerHTML="";for(var e=["class","style","id","ejs-for"],i={},n=0;n<this.element.attributes.length;n++)-1!==e.indexOf(this.element.attributes[n].name)||/^data-val/.test(this.element.attributes[n].name)||(i[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));if((t.extend(i,this.htmlAttributes,i),this.setProperties({htmlAttributes:i},!0),t.isNullOrUndefined(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),this.internalID=this.element.id,"TEXTAREA"===this.element.tagName)?(u=this.createElement("div",{className:this.element.getAttribute("class")}),this.element.innerHTML="",this.element.parentElement.insertBefore(u,this.element),this.valueContainer=this.element,t.removeClass([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=u):this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value",attrs:{"aria-labelledby":this.getID()}}),this.valueContainer.name=this.getID(),t.addClass([this.valueContainer],sb),!t.isNullOrUndefined(this.cssClass))for(f=this.cssClass.split(" "),r=0;r<f.length;r++)t.addClass([this.valueContainer],f[r]);this.rootContainer=this.createElement("div",{className:ig,attrs:{role:"presentation"}});this.element.appendChild(this.rootContainer);this.rootContainer.appendChild(this.valueContainer)},i.prototype.getPersistData=function(){return this.addOnPersist(["value"])},i.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}),this.notify(hi,{}))},i.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},i.prototype.selectAll=function(){this.notify(bf,{})},i.prototype.selectRange=function(n){this.notify(au,{range:n})},i.prototype.getSelection=function(){var n="";return this.notify(kf,{callBack:function(t){n=t}}),n},i.prototype.showEmojiPicker=function(n,t){this.readonly||this.notify(es,{x:n,y:t})},i.prototype.executeCommand=function(n,i,r){var o,h,s,e,c,u,f,l,a;if("importWord"===n){for(o=this.createElement("div"),o.innerHTML=i,h=o.querySelectorAll("table:not(.e-rte-table):not(.e-rte-paste-table)"),s=0;s<h.length;s++)h[s].classList.add("e-rte-paste-table");i=o.innerHTML;o.remove();n="insertHTML"}((i=this.htmlPurifier(n,i),"HTML"===this.editorMode)&&(c=this.getRange(),this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument),(this.iframeSettings.enable&&c.startContainer===this.inputElement||!this.inputElement.contains(c.startContainer))&&this.focusIn()),u=yrt[""+n],(r&&r.undo&&r.undo&&0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),-1===this.maxLength||t.isNullOrUndefined(u.command))||(f=0,("Links"===u.command&&(f=0===i.text.length?i.url.length:i.text.length),"Images"!==u.command&&"Table"!==u.command&&"Files"!==u.command||(f=1),"InsertHTML"===u.command)&&(t.isNullOrUndefined(i)?t.isNullOrUndefined(u.value)||"<hr/>"!==u.value&&"<br/>"!==u.value||(f=1):(l=this.createElement("div"),l.innerHTML=i,f=l.textContent.length)),"InsertText"===u.command&&(f=i.length),a=this.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length-this.getSelection().length+f,-1===this.maxLength||a<=this.maxLength))&&(e=i,"FormatPainter"===u.command&&(t.isNullOrUndefined(i)||(this.formatPainterSettings=i),e={formatPainterAction:u.value}),"CodeBlock"!==u.command||t.isNullOrUndefined(i)||(i.action="createCodeBlock"),"NumberFormatList"!==u.subCommand&&"BulletFormatList"!==u.subCommand||(e={listStyle:i,type:u.subCommand}),this.formatter.editorManager.execCommand(u.command,u.subCommand?u.subCommand:e||u.value,null,null,e||u.value,e||("UL"===u.value||"OL"===u.value?null:u.value),null,this.enterKey),hr(this.contentModule.getDocument(),this.inputElement),r&&r.undo&&(this.formatter.saveData(),this.formatter.enableUndo(this)),this.setPlaceHolder(),this.notify(cf,{}))},i.prototype.htmlPurifier=function(n,i){var s,r,f,e,u,c,h,o;if("HTML"===this.editorMode)switch(n){case"insertHTML":this.enableHtmlSanitizer&&("string"==typeof i?(i=i.replace(/&(times|divide|ne)/g,"&amp;amp;$1"),i=this.htmlEditorModule.sanitizeHelper(i)):i=this.htmlEditorModule.sanitizeHelper(i.outerHTML));break;case"insertTable":t.isNullOrUndefined(i.width)&&(i.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width});break;case"insertImage":s=(e=this.createElement("img",{attrs:{src:i.url}})).outerHTML;this.enableHtmlSanitizer&&(s=this.htmlEditorModule.sanitizeHelper(e.outerHTML));r=""!==s&&this.createElement("div",{innerHTML:s}).firstElementChild.getAttribute("src")||null;r=t.isNullOrUndefined(r)?"":r;i.url=r;t.isNullOrUndefined(i.width)&&(i.width={minWidth:this.insertImageSettings.minWidth,maxWidth:this.insertImageSettings.maxWidth,width:this.insertImageSettings.width});t.isNullOrUndefined(i.height)&&(i.height={minHeight:this.insertImageSettings.minHeight,maxHeight:this.insertImageSettings.maxHeight,height:this.insertImageSettings.height});break;case"insertAudio":f=this.createElement("audio",{attrs:{controls:""}});e=this.createElement("source",{attrs:{src:i.url,type:i.url&&i.url.split(".").length>0?"audio/"+i.url.split(".")[i.url.split(".").length-1]:""}});f.appendChild(e);u=f.outerHTML;this.enableHtmlSanitizer&&(u=this.htmlEditorModule.sanitizeHelper(f.outerHTML));r=""!==u&&this.createElement("div",{innerHTML:u}).firstElementChild.firstElementChild.getAttribute("src")||null;r=t.isNullOrUndefined(r)?"":r;i.url=r;break;case"insertVideo":f=this.createElement("video",{attrs:{controls:""}});e=this.createElement("source",{attrs:{src:i.url,type:i.url&&i.url.split(".").length>0?"video/"+i.url.split(".")[i.url.split(".").length-1]:""}});f.appendChild(e);u=f.outerHTML;this.enableHtmlSanitizer&&(u=this.htmlEditorModule.sanitizeHelper(e.outerHTML));r=""!==u&&this.createElement("div",{innerHTML:u}).firstElementChild.getAttribute("src")||null;r=t.isNullOrUndefined(r)?"":r;i.url=r;t.isNullOrUndefined(i.width)&&(i.width={minWidth:this.insertVideoSettings.minWidth,maxWidth:this.insertVideoSettings.maxWidth,width:this.insertVideoSettings.width});t.isNullOrUndefined(i.height)&&(i.height={minHeight:this.insertVideoSettings.minHeight,maxHeight:this.insertVideoSettings.maxHeight,height:this.insertVideoSettings.height});break;case"createLink":c=this.createElement("a",{attrs:{href:i.url}});h=c.outerHTML;this.enableHtmlSanitizer&&(h=this.htmlEditorModule.sanitizeHelper(c.outerHTML));o=""!==h&&this.createElement("div",{innerHTML:h}).firstElementChild.getAttribute("href")||null;o=t.isNullOrUndefined(o)?"":o;i.url=o}return i},i.prototype.encode=function(n){var t=this.createElement("div");return t.innerText=n.trim(),t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},i.prototype.render=function(){this.setProperties({value:this.replaceEntities(this.value)},!0);this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0);this.value="Markdown"===this.editorMode||t.isNullOrUndefined(this.value)?this.value:this.addAnchorAriaLabel(this.value);this.renderModule=new sk(this,this.serviceLocator);this.sourceCodeModule=new ort(this,this.serviceLocator);this.notify(hf,{});this.trigger(sd);this.RTERender();new brt(this);this.userAgentData="true"===this.element.dataset.rteUnitTesting?new sh(t.Browser.userAgent,!0):new sh(t.Browser.userAgent,!1);this.notify(a,{});this.enableXhtml&&(this.value=ny(br(this.value,this.element),this.enterKey,this.enableHtmlEncode),this.setProperties({value:this.getXhtml()}));this.toolbarSettings.enable&&("Expand"===this.toolbarSettings.type||"MultiRow"===this.toolbarSettings.type||"Scrollable"===this.toolbarSettings.type)&&!t.isNullOrUndefined(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]);null!==this.value&&(this.valueContainer.defaultValue=this.value);this.enabled&&!this.readonly?this.eventInitializer():this.unWireEvents();this.notify(w,{cssClass:this.getCssClass()});this.addAudioVideoWrapper();this.notify(sf,{});this.autoResize();this.renderComplete()},i.prototype.addAudioVideoWrapper=function(){for(var u,s,i,f,e,o=this,r=this.element.querySelectorAll("audio"),n=0;n<r.length;n++)(r[n].classList.contains("e-rte-audio")||(r[n].classList.add("e-rte-audio"),r[n].classList.add(he)),r[n].parentElement.classList.contains(cr)||r[n].parentElement.classList.contains(sr))||(u=this.createElement("span",{className:sr}),t.updateCSSText(u,"width:300px; margin:0 auto;"),u.contentEditable="false",s=this.createElement("span",{className:cr}),u.appendChild(s),r[n].parentNode.insertBefore(u,r[n].nextSibling),s.appendChild(r[n]),null===u.nextElementSibling&&(e=this.createElement("br"),u.parentNode.insertBefore(e,u.nextSibling)));for(i=this.element.querySelectorAll("video"),n=0;n<i.length;n++)(i[n].classList.contains("e-rte-video")||(i[n].classList.add("e-rte-video"),i[n].classList.add(ce)),i[n].parentElement.classList.contains(cr)||i[n].parentElement.classList.contains(ru))||(f=this.createElement("span",{className:ru}),f.contentEditable="false",i[n].parentNode.insertBefore(f,i[n].nextSibling),f.appendChild(i[n]),null===f.nextElementSibling&&(e=this.createElement("br"),f.parentNode.insertBefore(e,f.nextSibling))),-1!==t.Browser.userAgent.indexOf("Firefox")&&(i[n].addEventListener("play",function(n){o.notify(at,{args:n});o.notify("editAreaClick",{args:n})}),i[n].addEventListener("pause",function(n){o.notify(at,{args:n});o.notify("editAreaClick",{args:n})}))},i.prototype.eventInitializer=function(){this.wireEvents()},i.prototype.cleanList=function(){var i=this.getRange(),h=i.startContainer,e=i.endContainer,l=i.startOffset,a=h===e,o=(e.textContent.length,"#text"===i.endContainer.nodeName?i.endContainer.parentElement:i.endContainer),u=t.closest(o,"LI"),c=!1,s=i.endOffset,r,n,f;if(e.nodeType===Node.TEXT_NODE&&"﻿"===e.textContent.charAt(s-1)&&s--,!t.isNullOrUndefined(u)&&o.textContent.trim().length===s&&!i.collapsed&&t.isNullOrUndefined(o.nextElementSibling)&&!o.classList.contains(lb)){for(r=0;r<u.childNodes.length;r++)"#text"===u.childNodes[r].nodeName&&0===u.childNodes[r].textContent.trim().length&&(t.detach(u.childNodes[r]),c=!0,r--);for(n=u;null!==n.lastChild&&"#text"!==n.nodeName;)n=n.lastChild;c&&(f="BR"!==n.nodeName||t.isNullOrUndefined(n.previousSibling)?n:n.previousSibling,this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),a?f:h,f,l,"BR"===f.nodeName?0:f.textContent.length))}},i.prototype.keyDown=function(n){var e,nt,tt,it,o,i,rt,ut,et,s,f,st,h,c,ht,ct,lt,l,at,p,w,b,k;if(this.isSelectionStartInRTE=!0,e="macOS"===this.userAgentData.getPlatform(),((n.ctrlKey||n.metaKey&&e)&&n.shiftKey&&86===n.keyCode||n.metaKey&&e&&n.altKey&&n.shiftKey&&86===n.keyCode)&&(this.isPlainPaste=!0),this.inputElement.classList.contains("e-mention")){var d=this.element.ownerDocument.getElementById(this.inputElement.id+"_popup"),g=this.element.ownerDocument.getElementById(this.inputElement.id+"_slash_menu_popup"),yt=-1!==oit.indexOf(n.key),pt=d&&d.classList.contains("e-popup-open"),wt=g&&g.classList.contains("e-popup-open");if(yt&&(pt||wt))return}if("HTML"===this.editorMode&&!t.isNullOrUndefined(this.codeBlockModule)&&(nt=this.getRange(),this.formatter.editorManager.codeBlockObj.isActionDisallowedInCodeBlock(n,nt)))return void n.preventDefault();if(this.enableTabKey&&(this.quickToolbarModule&&!n.altKey&&"F10"!==n.key&&"toolbar-focus"!==n.action&&this.quickToolbarModule.hideQuickToolbars(),tt=!(!this.imageModule||!this.imageModule.imgResizeDiv),it=!(!this.videoModule||!this.videoModule.vidResizeDiv),tt&&this.imageModule.cancelResizeAction(),it&&this.videoModule.cancelResizeAction()),o=!1,t.isNullOrUndefined(this.codeBlockModule)||(i=this.getRange(),o=this.formatter.editorManager.codeBlockObj.isCodeBlockEnterAction(i,n)),this.notify(y,{member:"keydown",args:n}),this.restrict(n),"HTML"===this.editorMode&&this.cleanList(n),"HTML"===this.editorMode&&(8===n.which&&"Backspace"===n.code||46===n.which&&"Delete"===n.code))if(rt="#text"===(i=this.getRange()).startContainer.nodeName?i.startContainer.parentElement:i.startContainer,t.closest(rt,"pre")&&8===n.which&&8203===i.startContainer.textContent.charCodeAt(i.startOffset-1)||46===n.which&&8203===i.startContainer.textContent.charCodeAt(i.startOffset))ut=new RegExp("​","g"),et=8===n.which?i.startOffset-1:i.startOffset,i.startContainer.textContent=i.startContainer.textContent.replace(ut,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,et);else if("Backspace"===n.code&&8===n.which&&8203===i.startContainer.textContent.charCodeAt(0)&&i.collapsed){for(var u=i.startContainer.parentElement,ot=void 0,r=void 0,r=0;r<u.childNodes.length;r++)u.childNodes[r]===i.startContainer&&(ot=r);for(s=!0,f=[],r=ot;r>=0;r--)3===u.childNodes[r].nodeType&&8203===u.childNodes[r].textContent.charCodeAt(0)&&s?f.push(r):s=!1;if(f.length>0)for(r=f.length-1;r>0;r--)u.childNodes[f[r]].textContent="";this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,i.startOffset)}if(st=!!t.isNullOrUndefined(n.action)||"format-copy"!==n.action,0!==this.formatter.getUndoRedoStack().length||!st||n.altKey||n.shiftKey&&16===n.which||n.altKey&&n.shiftKey&&67===n.which||this.formatter.saveData(),h=!1,c=!0,"HTML"!==this.editorMode||(i=this.getRange(),h=!t.isNullOrUndefined(i.startContainer)&&i.startContainer===i.endContainer&&i.endContainer.childNodes.length>1&&!t.isNullOrUndefined(i.startContainer.childNodes[i.startOffset-1])&&"#text"===i.startContainer.childNodes[i.startOffset-1].nodeName&&!t.isNullOrUndefined(i.startContainer.childNodes[i.startOffset-1].previousSibling)&&32===i.startContainer.childNodes[i.startOffset-1].textContent.charCodeAt(0)&&"#text"!==i.startContainer.childNodes[i.startOffset-1].previousSibling.nodeName&&i.startContainer.childNodes[i.startOffset-1].previousSibling.classList.contains("e-mention-chip"),t.isNullOrUndefined(this.codeBlockModule))||(ht=this.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(i.startContainer),ct=this.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(i.endContainer),t.isNullOrUndefined(ht)&&t.isNullOrUndefined(ct)||(lt=n.action,c=-1!==["undo","redo","indents","outdents","ordered-list","unordered-list"].indexOf(lt))),-1===["insert-link","format-copy","format-paste","insert-image","insert-table","insert-audio","insert-video"].indexOf(n.action)&&(!n.target||!n.target.classList.contains("e-mention")||t.isNullOrUndefined(document.querySelector("#"+n.target.id+"_popup.e-popup-open"))||"Tab"!==n.code)&&(n.action&&"paste"!==n.action&&"space"!==n.action||9===n.which||"Backspace"===n.code&&8===n.which)&&!h){l=!1;t.isNullOrUndefined(this.formatPainterModule)||(l="escape"===this.formatPainterModule.previousAction);at="undo"===n.action||"redo"===n.action;switch(l&&!at||!c||o||("HTML"!==this.editorMode||"increase-fontsize"!==n.action&&"decrease-fontsize"!==n.action?this.formatter.process(this,null,n):this.notify(vw,{member:"onHandleFontsizeChange",args:n})),n.action){case"toolbar-focus":if(this.toolbarSettings.enable&&this.getToolbarElement()){this.userAgentData.isSafari()&&"keydown"===n.type&&this.formatter.editorManager.nodeSelection&&this.formatter.editorManager.nodeSelection.get(this.contentModule.getDocument()).rangeCount>0&&this.inputElement.contains(this.getRange().startContainer)&&this.notify(ft,{});var a="toolbar",v=this.getToolbarElement().querySelector(".e-toolbar-item:not(.e-overlay)[title]"),vt=this.getRenderedQuickToolbarElem();(vt&&(v=vt.querySelector(".e-toolbar-item:not(.e-overlay)[title]"),a="quickToolbar"),v)&&(p=v.firstElementChild,p.removeAttribute("tabindex"),p.focus(),!this.userAgentData.isSafari()||"toolbar"!==a&&"quickToolbar"!==a||this.inputElement.ownerDocument.getSelection().removeAllRanges())}break;case"escape":this.contentModule.getEditPanel().focus()}}(this.notify(gl,{member:"afterKeyDown",args:n}),this.autoResize(),t.isNullOrUndefined(this.placeholder)||this.setPlaceHolder(),"HTML"!==this.editorMode||t.isNullOrUndefined(n)||t.isNullOrUndefined(n.code)||"Backspace"!==n.code&&"Delete"!==n.code)||(i=this.contentModule.getDocument().getSelection().getRangeAt(0),w=document.createElement("div"),w.appendChild(i.cloneContents()),b=w.innerHTML,(b===this.inputElement.innerHTML||i.commonAncestorContainer===this.inputElement&&b===this.inputElement.textContent.trim())&&(this.isCopyAll=!0));(n.metaKey&&"Backspace"===n.key&&this.autoSaveOnIdle&&this.keyUp(n),"HTML"===this.editorMode)&&(k=this.contentModule.getDocument().getSelection(),i=k&&k.getRangeAt(0),this.previousRange=i&&i.cloneRange())},i.prototype.clearSelectionTimeout=function(){this.selectionTimeout&&(clearTimeout(this.selectionTimeout),this.selectionTimeout=null)},i.prototype.triggerSelectionChanged=function(){var t=this.contentModule.getDocument().getSelection(),n=t&&t.getRangeAt(0),i;this.isSelectionCollapsed()||this.previousRange&&this.previousRange.startContainer===n.startContainer&&this.previousRange.endContainer===n.endContainer&&this.previousRange.startOffset===n.startOffset&&this.previousRange.endOffset===n.endOffset||(i={selectedContent:this.getSelectedHtml(),selection:t,editorMode:this.editorMode},this.trigger(yw,i),this.previousRange=n.cloneRange())},i.prototype.keyUp=function(n){var u=this,r,s,f,e,h,o,i;"HTML"===this.editorMode&&(r=this.getRange(),t.isNullOrUndefined(n)||t.isNullOrUndefined(n.code)||"Backspace"!==n.code&&"Delete"!==n.code&&"KeyX"!==n.code||(s=this.getRange(),f=this.iframeSettings.enable?this.contentModule.getPanel().ownerDocument.getSelection():this.contentModule.getDocument().getSelection(),this.isCopyAll&&(e=this.createElement("br"),h="BR"===this.enterKey?e:this.createElement(this.enterKey).appendChild(e).parentElement,this.inputElement.innerHTML="",this.inputElement.appendChild(h),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),e.parentElement,0),this.isCopyAll=!1),f.rangeCount>0&&"INPUT"!==this.contentModule.getDocument().activeElement.tagName&&this.inputElement.contains(this.contentModule.getDocument().activeElement)&&"<br>"===r.startContainer.innerHTML&&""===r.startContainer.textContent&&(f.removeAllRanges(),f.addRange(s))),-1!==t.Browser.userAgent.indexOf("Firefox")&&"#text"===r.startContainer.nodeName&&r.startContainer.parentElement===this.inputElement&&"BR"!==this.enterKey&&(o=this.getRange(),i=this.createElement(this.enterKey),o.startContainer.parentElement.insertBefore(i,o.startContainer),i.appendChild(o.startContainer),this.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),i.childNodes[0],i.childNodes[0],i.childNodes[0].textContent.length,i.childNodes[0].textContent.length)));0===this.formatter.getCurrentStackIndex()&&this.updateUndoRedoStack(n);this.notify(tt,{member:"keyup",args:n});this.notify(kh,{member:"tableModulekeyUp",args:n});"KeyX"!==n.code||88!==n.which||88!==n.keyCode||!n.ctrlKey||""!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||(this.inputElement.innerHTML=uf(gs(nk(this),this),this.editorMode));var l=this.inputElement.classList.contains("e-mention"),c=32===n.which||13===n.which||8===n.which||46===n.which||9===n.which&&l,a="C"===n.key&&n.altKey&&n.shiftKey,v="V"===n.key&&n.altKey&&n.shiftKey;(!a&&!v&&("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||c)||"Markdown"===this.editorMode&&("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||c)||this.autoSaveOnIdle&&t.Browser.isDevice&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,n);(this.inputElement&&0!==this.inputElement.textContent.length||this.element.querySelectorAll(".e-toolbar-item.e-active").length>0||this.formatter.getUndoRedoStack().length>0)&&this.notify(hi,{args:n});this.setPlaceHolder();"HTML"===this.editorMode&&(this.clearSelectionTimeout(),this.element&&this.element.dataset&&"true"===this.element.dataset.rteUnitTesting?this.isSelecting&&(this.triggerSelectionChanged(),this.isSelecting=!1,this.isSelectionStartInRTE=!1):this.selectionTimeout=window.setTimeout(function(){u.isSelecting&&(u.triggerSelectionChanged(),u.isSelecting=!1,u.isSelectionStartInRTE=!1)},600))},i.prototype.serializeValue=function(n){return"HTML"!==this.editorMode||t.isNullOrUndefined(n)||(n=br(n,this.element),this.enableXhtml||(n=ny(n,this.enterKey,this.enableHtmlEncode)),this.enableHtmlEncode?(n=this.htmlEditorModule.sanitizeHelper(nr(n)),n=this.encode(n)):(n=this.htmlEditorModule.sanitizeHelper(n),n=this.enableXhtml?this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(n):n)),n},i.prototype.sanitizeHtml=function(n){return this.serializeValue(n)},i.prototype.updateValue=function(n){if(t.isNullOrUndefined(n)){var i=this.inputElement.innerHTML;this.setProperties({value:ett(i)?null:i})}else this.setProperties({value:n})},i.prototype.triggerEditArea=function(n){if(s()){var t=n.touches?n.changedTouches[0]:n;this.clickPoints.clientX===t.clientX&&this.clickPoints.clientY===t.clientY&&this.notify(vt,{member:"editAreaClick",args:n})}else this.notify(vt,{member:"editAreaClick",args:n})},i.prototype.focusHR=function(n){"HR"===n.target.tagName&&n.target.classList.add("e-rte-hr-focus")},i.prototype.notifyMouseUp=function(n){var i=n.touches?n.changedTouches[0]:n;this.notify(nc,{member:"mouseUp",args:n,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:i.clientX,clientY:i.clientY}});(this.inputElement&&("HTML"===this.editorMode&&(0!==this.inputElement.textContent.length||n.target&&!t.isNullOrUndefined(n.target.querySelector("li")))||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)||n.target&&!t.isNullOrUndefined(t.closest(n.target,"table"))||n.target&&!t.isNullOrUndefined(n.target.querySelector("img"))||n.target&&("VIDEO"===n.target.nodeName||n.target.querySelectorAll("."+ru).length>0)||n.target&&"BR"!==n.target.nodeName&&(n.target.classList.contains(sr)||n.target.classList.contains(cr)||n.target.classList.contains(oe)))&&this.notify(hi,{args:n});this.triggerEditArea(n);"HTML"===this.editorMode&&this.focusHR(n)},i.prototype.updateUndoRedoStack=function(n){var t=this.formatter.getUndoRedoStack(),i=this.formatter.getCurrentStackIndex(),o=-1!==["ArrowLeft","ArrowRight","ArrowUp","ArrowDown","Home","End","PageUp","PageDown"].indexOf(n.key),r="keyup"!==n.type||o,u,f;if(0===t.length||0===i)if(0===t.length)this.formatter.saveData();else if(0===i&&"HTML"===this.editorMode&&r)u=t[0],f=new st(this.inputElement).save(this.getRange(),this.contentModule.getDocument()),u.range=f;else if(0===i&&"Markdown"===this.editorMode&&r){var e=t[0],s=this.inputElement.selectionStart,h=this.inputElement.selectionEnd;e.start=s;e.end=h}},i.prototype.mouseUp=function(n){var u,f,r,i,e;if((this.isSelectionStartInRTE=!1,this.isSelectionCollapsed())&&(u=this.contentModule.getDocument().getSelection(),f=u&&0!==u.rangeCount&&u.getRangeAt(0),this.previousRange=f&&f.cloneRange()),r=n.target,r&&-1!==["IMG","VIDEO","AUDIO","TABLE","TH","TD","TR","TBODY"].indexOf(r.tagName)||"#text"!==r.nodeName&&(r.closest(".e-audio-wrap")||r.closest(".e-video-wrap")||r.closest(".e-embed-video-wrap"))||"HTML"!==this.editorMode||t.Browser.isDevice||s()||this.isSelectionInRTE()){if(this.quickToolbarSettings.showOnRightClick&&t.Browser.isDevice&&(i=n.target,e=t.closest(i,"table"),i&&"A"===i.nodeName||"IMG"===i.nodeName||"TD"===i.nodeName||"TH"===i.nodeName||"TABLE"===i.nodeName||e&&this.contentModule.getEditPanel().contains(e)))return;this.notifyMouseUp(n);this.setPlaceHolder();this.autoResize();this.updateUndoRedoStack(n);this.isSelectionInRTE()&&(this.triggerSelectionChanged(),this.isSelecting=!1)}},i.prototype.ensureModuleInjected=function(n){return this.getInjectedModules().indexOf(n)>=0},i.prototype.onCopy=function(n){void 0===n&&(n=null);n&&"HTML"===this.editorMode&&this.handleTableCellCopy()?n.preventDefault():this.contentModule.getDocument().execCommand("copy",!1,null)},i.prototype.onCut=function(n){var t,i,r;(void 0===n&&(n=null),n&&"HTML"===this.editorMode&&this.handleTableCellCopy(!0))?n.preventDefault():(t=this.contentModule.getDocument().getSelection().getRangeAt(0),i=document.createElement("div"),i.appendChild(t.cloneContents()),r=i.innerHTML,(r===this.inputElement.innerHTML||t.commonAncestorContainer===this.inputElement&&r===this.inputElement.textContent.trim())&&(this.isCopyAll=!0),this.contentModule.getDocument().execCommand("cut",!1,null))},i.prototype.onPaste=function(n){var i=this,r={originalEvent:n,cancel:!1,requestType:"Paste"};this.isPlainPaste=n&&n.clipboardData&&n.clipboardData.items&&n.clipboardData.items.length&&1===n.clipboardData.items.length&&"text/plain"===n.clipboardData.items[0].type;this.trigger(l,r,function(r){var h=i.getText().replace(/\u200B/g,"").replace("HTML"===i.editorMode?/(\r\n|\n|\r|\t)/gm:"","").length-i.getSelection().length+(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.clipboardData)?0:n.clipboardData.getData("text/plain").replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length),c,e,u,l,s;if("Markdown"===i.editorMode)return c={requestType:"Paste",editorMode:i.editorMode,event:n},setTimeout(function(){i.formatter.onSuccess(i,c)},0),void(-1===i.maxLength||h<=i.maxLength||n.preventDefault());if(!r.cancel&&"true"===i.inputElement.contentEditable&&(-1===i.maxLength||h<=i.maxLength))if(e=i.getRange(),u=void 0,t.isNullOrUndefined(i.codeBlockModule)||(u=i.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(e.startContainer)||i.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(e.endContainer)),l=i.contentModule.getDocument().querySelector(".e-rte-img-dialog"),!t.isNullOrUndefined(i.pasteCleanupModule)&&t.isNullOrUndefined(u))t.isNullOrUndefined(l)&&i.notify(nl,{args:n,isPlainPaste:i.isPlainPaste});else if(i.isPlainPaste)!i.isPlainPaste||t.isNullOrUndefined(u)||t.isNullOrUndefined(i.codeBlockModule)||i.notify(wo,{args:n});else{console.warn('[WARNING] :: Module "pasteCleanup" is not available in RichTextEditor component! You either misspelled the module name or forgot to load it.');var a={requestType:"Paste",editorMode:i.editorMode,event:n},f=null,o=!1;n&&!t.isNullOrUndefined(n.clipboardData)&&(f=n.clipboardData.getData("text/plain"),o=n.clipboardData.getData("text/html").indexOf("MsoNormal")>0);s=n&&n.clipboardData&&n.clipboardData.items.length>0?n.clipboardData.items[0].getAsFile():null;null!==f&&t.isNullOrUndefined(u)?i.notify(vu,{file:s,args:n,text:f,isWordPaste:o}):null===f||t.isNullOrUndefined(u)||t.isNullOrUndefined(i.codeBlockModule)||i.notify(wo,{file:s,args:n,text:f,isWordPaste:o});setTimeout(function(){i.formatter.onSuccess(i,a)},0)}else n.preventDefault()});this.isPlainPaste=!1},i.prototype.clipboardAction=function(n,t){switch(n.toLowerCase()){case"cut":this.onCut(t);this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:t});break;case"copy":this.onCopy(t);this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:t});break;case"paste":this.onPaste(t)}},i.prototype.destroy=function(){var i,f,e,r;if(!this.isDestroyed&&this.isRendered){if(this.element.className=this.beforeRenderClassValue,this.removeHtmlAttributes(),this.removeAttributes(),this.beforeRenderClassValue=null,t.isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),t.isNullOrUndefined(this.autoSaveTimeOut)||(clearTimeout(this.autoSaveTimeOut),this.autoSaveTimeOut=null),t.isNullOrUndefined(this.idleInterval)||(clearTimeout(this.idleInterval),this.idleInterval=null),this.notify(u,{}),this.destroyDependentModules(),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){for(this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),t.detach(this.element),""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:t.isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.valueContainer.defaultValue,this.element=this.valueContainer,i=0;i<this.originalElement.classList.length;i++)t.addClass([this.element],this.originalElement.classList[i]);if(!t.isNullOrUndefined(this.cssClass))for(f=this.cssClass.split(" "),i=0;i<f.length;i++)t.addClass([this.element],f[i]);t.removeClass([this.element],sb)}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:t.isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";if(e=document.querySelector(".e-dialog.e-rte-elements"),e&&t.detach(e),this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),!t.isNullOrUndefined(this.cssClass))for(r=this.cssClass.split(" "),i=0;i<r.length;i++)""!==r[i].trim()&&t.removeClass([this.element],r[i]);this.rootContainer&&(this.rootContainer=null);this.valueContainer&&(this.valueContainer=null);this.originalElement&&(this.originalElement=null);this.currentTarget=null;this.scrollParentElements=[];this.userAgentData=null;this.isRendered=!1;this.isSelecting=!1;this.selectionTimeout=null;this.previousRange=null;n.prototype.destroy.call(this)}},i.prototype.handleTableCellCopy=function(n){void 0===n&&(n=!1);var t=this.getRange();return!!(t&&t.startContainer&&this.tableModule&&this.tableModule.tableObj&&this.tableModule.tableObj.curTable&&this.tableModule.tableObj.curTable.contains(t.startContainer)&&this.tableModule.tableObj.curTable.querySelectorAll(".e-cell-select.e-multi-cells-select").length>0)&&(this.tableModule.tableObj.copy(n),!0)},i.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var t=Object.keys(this.htmlAttributes),n=0;n<t.length&&this.element.hasAttribute(t[n]);n++)this.element.removeAttribute(t[n])},i.prototype.removeAttributes=function(){this.enabled||t.removeClass([this.element],ra);this.enableRtl&&t.removeClass([this.element],tu);this.readonly&&t.removeClass([this.element],le);""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width");""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height");this.element.removeAttribute("aria-disabled");this.element.removeAttribute("role");this.element.removeAttribute("tabindex");this.element.removeAttribute("aria-label")},i.prototype.destroyDependentModules=function(){this.renderModule.destroy();this.formatter.editorManager.destroy()},i.prototype.getContent=function(){return this.contentModule.getPanel()},i.prototype.getText=function(){return this.contentModule.getText()},i.prototype.getSelectedHtml=function(){var n=this.createElement("div"),t=this.contentModule.getDocument().getSelection(),i;return t.rangeCount>0&&(i=t.getRangeAt(0).cloneContents(),n.appendChild(i)),n.innerHTML},i.prototype.showInlineToolbar=function(){var i,r;if(this.inlineMode.enable){var n=this.getRange(),u="#text"===n.endContainer.nodeName?n.endContainer.parentElement:n.endContainer,t=Array.from(n.getClientRects(),function(n){return n});(0===t.length&&(t=[n.startContainer.getBoundingClientRect()]),t.length>0)&&(i=t[0].left,r=t[0].top,this.quickToolbarModule.showInlineQTBar(i,r,u))}},i.prototype.hideInlineToolbar=function(){this.quickToolbarModule.hideInlineQTBar()},i.prototype.getModuleName=function(){return"richtexteditor"},i.prototype.onPropertyChanged=function(i,r){for(var u,f,c,s,l,e,o=0,h=Object.keys(i);o<h.length;o++){u=h[o];switch(u){case"enterKey":case"value":f=void 0;f="enterKey"===u?null===this.value||"<div><br><\/div>"===this.value||"<p><br><\/p>"===this.value||"<br>"===this.value?null:this.value:i[u];f="HTML"===this.editorMode?this.replaceEntities(f):f;f=this.serializeValue(f);c="HTML"===this.editorMode?gs(f,this):f;(t.isNullOrUndefined(f)||""===f)&&"enterKey"!==u||this.setProperties({value:this.enableHtmlEncode?this.encode(nr(c)):c},!0);this.updatePanelValue();this.inputElement&&this.notify(sf,{});this.setPlaceHolder();this.notify(ie,{module:"XhtmlValidation",newProp:i,oldProp:r});this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0);this.showCharCount&&this.countModule.refresh();this.addAudioVideoWrapper();break;case"valueTemplate":this.setValue(!0);this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(i[u]);this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(i[u]);this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(r[u]);this.setCssClass(i[u]);this.notify(w,{cssClass:i[u],oldCssClass:r[u]});break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=i[u];this.setPlaceHolder();break;case"htmlAttributes":pp(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":s=r[u];s.resources&&(l=this.contentModule.getDocument().querySelector("head"),e=void 0,s.resources.scripts&&(e=l.querySelectorAll("."+pw),this.removeSheets(e)),s.resources.styles&&(e=l.querySelectorAll("."+ww),this.removeSheets(e)));this.setIframeSettings();break;case"locale":n.prototype.refresh.call(this);break;case"inlineMode":this.notify(k,{module:"quickToolbar",newProp:i,oldProp:r});break;case"toolbarSettings":this.notify(k,{module:"toolbar",newProp:i,oldProp:r});break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":i[u]&&this.countModule?this.countModule.renderCount():!1===i[u]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData();this.updatePanelValue();this.setPlaceHolder();this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(gu,{newProp:i,oldProp:r});break;case"enableXhtml":this.notify(ie,{module:"XhtmlValidation",newProp:i,oldProp:r});this.inputElement.innerHTML=ny(br(this.inputElement.innerHTML,this.element),this.enterKey,this.enableHtmlEncode);break;case"quickToolbarSettings":i.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent();this.notify(k,{newProp:i,oldProp:r});break;case"formatPainterSettings":this.formatter.editorManager.observer.notify(gu,{module:"formatPainter",newProp:i});break;default:this.notify(k,{newProp:i,oldProp:r})}this.autoResize()}this.formatter&&this.notify(df,{})},i.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode(nr(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:nr(this.inputElement.innerHTML)})},i.prototype.removeSheets=function(n){for(var i=0;i<n.length;i++)t.detach(n[i])},i.prototype.replaceEntities=function(n){var r=this;if("HTML"!==this.editorMode||t.isNullOrUndefined(n)||!/&(amp;)*((times)|(divide)|(ne))/.test(n))return" "===n?"<p><br><\/p>":n;for(var o=this.enableHtmlEncode||this.enableHtmlSanitizer,s=["times","divide","ne"].map(function(n){var t=o?"&amp;amp;"+n:"&amp;"+n,i=!r.enableHtmlEncode&&r.enableHtmlSanitizer?"&("+n+")":"&(amp;)*("+n+")";return[t,new RegExp(i,"g")]}),i=0,u=s;i<u.length;i++){var f=u[i],h=f[0],e=f[1];e.test(n)&&(n=n.replace(e,h))}return n},i.prototype.updatePanelValue=function(){var n,i;this.setProperties({value:this.replaceEntities(this.value)},!0);n="HTML"===this.editorMode?this.listOrderCorrection(this.value):this.value;n=this.enableHtmlEncode&&this.value?nr(n):n;i=this.element.querySelector("."+fu);n?(!t.isNullOrUndefined(i)&&this.rootContainer.classList.contains("e-source-code-enabled")&&(i.value=dtt(this.value)),this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:n),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==n.trim()?this.inputElement.innerHTML=uf(n,this.editorMode):"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==n.trim()&&(this.inputElement.value=n)):(!t.isNullOrUndefined(i)&&this.rootContainer.classList.contains("e-source-code-enabled")&&(i.value=""),"HTML"===this.editorMode?this.inputElement.innerHTML="DIV"===this.enterKey?"<div><br/><\/div>":"BR"===this.enterKey?"<br/>":"<p><br/><\/p>":this.inputElement.value="",this.valueContainer&&(this.valueContainer.value=""));this.showCharCount&&this.countModule.refresh()},i.prototype.listOrderCorrection=function(n){var u=this.createElement("div"),r,i;for(u.innerHTML=n,r=u.querySelectorAll("UL, OL"),i=0;i<r.length;i++)t.isNullOrUndefined(r[i])||t.isNullOrUndefined(r[i].parentElement)||t.isNullOrUndefined(r[i].previousElementSibling)||"UL"!==r[i].parentElement.nodeName&&"OL"!==r[i].parentElement.nodeName||r[i].previousElementSibling.appendChild(r[i]);return u.innerHTML},i.prototype.setHeight=function(n){this.element.style.height="auto"!==n?t.formatUnit(n):"auto";"Expand"===this.toolbarSettings.type&&("string"==typeof this.height&&this.height.indexOf("px")>-1||"number"==typeof this.height)?this.element.classList.add(yb):this.element.classList.remove(yb)},i.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper&&this.inputElement.parentElement.contains(this.placeHolderWrapper)||(this.placeHolderWrapper=this.createElement("span",{className:"e-rte-placeholder "+this.getCssClass()}),this.fontSize.default&&(this.placeHolderWrapper.style.fontSize=this.fontSize.default),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement)),this.placeHolderWrapper.innerHTML=this.placeholder,0===this.inputElement.textContent.length&&this.inputElement.childNodes.length<2&&!t.isNullOrUndefined(this.inputElement.firstChild)&&("BR"===this.inputElement.firstChild.nodeName||("P"===this.inputElement.firstChild.nodeName||"DIV"===this.inputElement.firstChild.nodeName)&&!t.isNullOrUndefined(this.inputElement.firstChild.firstChild)&&this.inputElement.firstChild.childNodes.length<2&&"BR"===this.inputElement.firstChild.firstChild.nodeName)?(this.placeHolderWrapper.classList.add("e-placeholder-enabled"),t.EventHandler.add(this.inputElement,"input",this.setPlaceHolder,this)):(this.placeHolderWrapper.classList.remove("e-placeholder-enabled"),t.EventHandler.remove(this.inputElement,"input",this.setPlaceHolder))):this.inputElement.setAttribute("placeholder",this.placeholder));this.placeholder&&this.iframeSettings.enable&&this.inputElement&&(!(0===this.inputElement.textContent.length&&this.inputElement.childNodes.length<2)||t.isNullOrUndefined(this.inputElement.firstChild)||"BR"!==this.inputElement.firstChild.nodeName&&("P"!==this.inputElement.firstChild.nodeName&&"DIV"!==this.inputElement.firstChild.nodeName||t.isNullOrUndefined(this.inputElement.firstChild.firstChild)||"BR"!==this.inputElement.firstChild.firstChild.nodeName)?(t.removeClass([this.inputElement],"e-rte-placeholder"),t.EventHandler.remove(this.inputElement,"input",this.setPlaceHolder)):(t.addClass([this.inputElement],"e-rte-placeholder"),this.inputElement.setAttribute("placeholder",this.placeholder),t.EventHandler.add(this.inputElement,"input",this.setPlaceHolder,this)))},i.prototype.setWidth=function(n){"auto"!==n?t.setStyleAttribute(this.element,{width:t.formatUnit(this.width)}):this.element.style.width="auto"},i.prototype.setCssClass=function(n){if(!t.isNullOrUndefined(n))for(var r=n.split(" "),i=0;i<r.length;i++)""!==r[i].trim()&&this.element.classList.add(r[i])},i.prototype.updateRTL=function(){this.notify(ur,{enableRtl:this.enableRtl});this.enableRtl?(this.element.classList.add(tu),this.inputElement.classList.add(tu)):(this.element.classList.remove(tu),this.inputElement.classList.remove(tu))},i.prototype.updateReadOnly=function(){this.notify(ne,{editPanel:this.inputElement,mode:this.readonly})},i.prototype.setReadOnly=function(n){this.updateReadOnly();n||(this.readonly&&this.enabled?(this.unbindEvents(),this.unWireEvents()):this.enabled&&this.wireEvents())},i.prototype.print=function(){var n,i=this,r={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(l,r,function(r){var u,f;(n=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth),"msie"===t.Browser.info.name&&n.resizeTo(screen.availWidth,screen.availHeight),i.iframeSettings.enable)?n=gtt(i.inputElement,n):(u=document.createElement("div"),t.addClass([u],["e-richtexteditor","e-control"]),f=document.createElement("div"),t.addClass([f],["e-rte-content"]),f.appendChild(i.inputElement.cloneNode(!0)),u.appendChild(f),n=t.print(u,n));r.cancel||i.trigger(ct,{requestType:"print"})})},i.prototype.refreshUI=function(){this.renderModule.refresh();("Markdown"===this.editorMode||this.iframeSettings.enable)&&this.autoResize();t.isNullOrUndefined(this.quickToolbarModule)||this.quickToolbarModule.isDestroyed||this.quickToolbarModule.refreshQuickToolbarPopup(null)},i.prototype.showFullScreen=function(){this.fullScreenModule.showFullScreen()},i.prototype.enableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!0,t)},i.prototype.disableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!1,t)},i.prototype.removeToolbarItem=function(n){this.toolbarModule.removeTBarItems(n)},i.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},i.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new wrt);this.serviceLocator.register("rteLocale",this.localeObj=new t.L10n(this.getModuleName(),lot,this.locale));this.serviceLocator.register("dialogRenderObject",new crt(this));this.serviceLocator.register("popupUploaderObject",new tct(this))},i.prototype.RTERender=function(){var n=this.serviceLocator.getService("rendererFactory");this.contentModule=n.getRenderer(o.Content);this.fullScreenModule=new nut(this);this.enterKeyModule=new bht(this);this.renderModule.render();this.inputElement=this.contentModule.getEditPanel();this.setHeight(this.height);pp(this.htmlAttributes,this,!1,!0);this.iframeSettings&&this.setIframeSettings();this.setCssClass(this.cssClass);this.updateEnable();this.setPlaceHolder();this.updateRTL();this.updateReadOnly();this.updatePanelValue();this.inputElement&&(this.inputElement.innerHTML=uf(this.inputElement.innerHTML,this.editorMode));this.enableHtmlEncode&&!t.isNullOrUndefined(this.value)&&this.setProperties({value:this.encode(nr(this.value))})},i.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var n=this.iframeSettings.resources.styles,i=this.iframeSettings.resources.scripts;!t.isNullOrUndefined(this.iframeSettings.resources.scripts)&&this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,i);!t.isNullOrUndefined(this.iframeSettings.resources.styles)&&this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,n)}this.iframeSettings.attributes&&pp(this.iframeSettings.attributes,this,!0,!1)},i.prototype.InjectSheet=function(n,t){var r,i,u,f;try{if(t&&t.length>0)for(r=this.contentModule.getDocument().querySelector("head"),i=0;i<t.length;i++)n?(u=this.createScriptElement(),u.src=t[i],r.appendChild(u)):(f=this.createStyleElement(),f.href=t[i],r.appendChild(f))}catch(n){return}},i.prototype.createScriptElement=function(){var n=this.createElement("script",{className:pw});return n.type="text/javascript",n},i.prototype.createStyleElement=function(){var n=this.createElement("link",{className:ww});return n.rel="stylesheet",n},i.prototype.setValue=function(n){var r=this,h,u,i,f,e,s,o;if(this.valueTemplate)if(h=new RegExp(/<(?=.*? .*?\/ ?>|br|hr|input|!--|wbr)[a-z]+.*?>|<([a-z]+).*?<\/\1>/i),"string"==typeof this.valueTemplate&&h.test(this.valueTemplate))this.setProperties({value:this.valueTemplate});else if(u=t.compile(this.valueTemplate)("",this,"valueTemplate"),"string"!=typeof this.valueTemplate&&this.isReact){for(this.displayTempElem=this.createElement("div"),i=0;i<u.length;i++)f=u[i],t.append([f],this.displayTempElem);this.renderTemplates(function(){r.inputElement.innerHTML=uf(r.displayTempElem.childNodes[0].innerHTML,r.editorMode);r.setProperties({value:r.inputElement.innerHTML.trim()})})}else{for(e=this.element,n&&(this.inputElement.innerHTML="",e=this.inputElement),i=0;i<u.length;i++)f=u[i],t.append([f],e);s=e.innerHTML.trim();s.length>0&&this.setProperties({value:s});this.renderReactTemplates()}else o=!t.isNullOrUndefined(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim(),""!==o&&("TEXTAREA"===this.element.tagName?this.setProperties({value:nr(o)}):this.setProperties({value:o}))},i.prototype.renderTemplates=function(n){this.renderReactTemplates(n)},i.prototype.updateResizeFlag=function(){this.isResizeInitialized=!0},i.prototype.getInsertImgMaxWidth=function(){var u=this.insertImageSettings.maxWidth,r=this.contentModule.getEditPanel(),n,i,f;return"HTML"!==this.editorMode||t.isNullOrUndefined(this.formatter.editorManager.nodeSelection)||t.isNullOrUndefined(this.formatter.editorManager.nodeSelection.range)||(n=this.formatter.editorManager.nodeSelection.range,3!==n.startContainer.nodeType&&n.startContainer.closest&&!t.isNullOrUndefined(n.startContainer.closest("TD"))&&(r=n.startContainer)),i=window.getComputedStyle(r),f=r.offsetWidth-(14+parseFloat(i.paddingLeft.split("px")[0])+parseFloat(i.paddingRight.split("px")[0])+parseFloat(i.marginLeft.split("px")[0])+parseFloat(i.marginRight.split("px")[0])),t.isNullOrUndefined(u)?f:u},i.prototype.getInsertVidMaxWidth=function(){var i=this.insertVideoSettings.maxWidth,r=this.contentModule.getEditPanel(),n=window.getComputedStyle(r),u=r.offsetWidth-(14+parseFloat(n.paddingLeft.split("px")[0])+parseFloat(n.paddingRight.split("px")[0])+parseFloat(n.marginLeft.split("px")[0])+parseFloat(n.marginRight.split("px")[0]));return t.isNullOrUndefined(i)?u:i},i.prototype.getHtml=function(){var n=tr(this.contentModule.getEditPanel().innerHTML,this.editorMode);return!this.enableXhtml||"<p><br><\/p>"!==n&&"<div><br><\/div>"!==n&&"<br>"!==n?this.serializeValue(n):null},i.prototype.getXhtml=function(){var n=tr(this.value,this.editorMode);return!t.isNullOrUndefined(n)&&this.enableXhtml&&(n=this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(n)),n},i.prototype.showSourceCode=function(){this.readonly||this.notify(lu,{})},i.prototype.getCharCount=function(){var n="Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim();return"Markdown"!==this.editorMode&&-1!==n.indexOf("​")?n.replace(/\u200B/g,"").length:n.length},i.prototype.showDialog=function(n){n===d.InsertLink?this.notify(ts,{}):n===d.InsertImage?this.notify(is,{}):n===d.InsertAudio?this.notify(rs,{}):n===d.InsertVideo?this.notify(us,{}):n===d.InsertTable&&this.notify(fs,{})},i.prototype.closeDialog=function(n){n===d.InsertLink?this.notify(al,{}):n===d.InsertImage?this.notify(vl,{}):n===d.InsertAudio?this.notify(yl,{}):n===d.InsertVideo?this.notify(pl,{}):n===d.InsertTable&&this.notify(wl,{})},i.prototype.getBaseToolbarObject=function(){return!this.inlineMode.enable||t.Browser.isDevice&&!s()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar()},i.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},i.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},i.prototype.getID=function(){return this.internalID},i.prototype.getCssClass=function(n){return t.isNullOrUndefined(this.cssClass)?"":n?" "+this.cssClass:this.cssClass},i.prototype.mouseDownHandler=function(n){this.isSelectionStartInRTE=!0;var i=n.touches?n.changedTouches[0]:n;t.addClass([this.element],[oa]);this.preventDefaultResize(n);this.notify(at,{args:n});this.formatter.editorManager.observer.notify(at,{args:n});this.clickPoints={clientX:i.clientX,clientY:i.clientY}},i.prototype.preventImgResize=function(n){"img"===n.target.nodeName.toLocaleLowerCase()&&n.preventDefault()},i.prototype.preventDefaultResize=function(){"msie"===t.Browser.info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===t.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},i.prototype.defaultResize=function(){"msie"===t.Browser.info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===t.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},i.prototype.resizeHandler=function(n){if(!document.body.contains(this.element))return document.defaultView.removeEventListener("resize",this.resizeHandler,!0),void(this.onResizeHandler=null);this.toolbarSettings.enable&&!this.inlineMode.enable&&this.toolbarModule.refreshToolbarOverflow();this.notify(dr,{args:n});this.autoResize()},i.prototype.scrollHandler=function(n){this.element&&this.notify(li,{args:n})},i.prototype.contentScrollHandler=function(n){this.notify(ai,{args:n})},i.prototype.focusHandler=function(n){var i,f,r,u;if(!this.isRTE||this.isFocusOut){if(this.isRTE=!this.isFocusOut,this.isFocusOut=!1,t.addClass([this.element],[oa]),this.cloneValue="HTML"===this.editorMode?"<p><br><\/p>"===this.inputElement.innerHTML||"<div><br><\/div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(nr(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value,i=document.activeElement,(i===this.element||i===this.getToolbarElement()||i===this.contentModule.getEditPanel()||this.iframeSettings.enable&&i===this.contentModule.getPanel()&&n.target&&!n.target.classList.contains("e-img-inner")&&n.target&&n.target.parentElement&&!n.target.parentElement.classList.contains("e-img-wrap")||t.closest(i,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!t.isNullOrUndefined(this.getToolbarElement())))for(this.getToolbarElement().setAttribute("tabindex","-1"),f=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),r=0;r<f.length;r++)f[r].setAttribute("tabindex","-1");this.preventDefaultResize(n);this.trigger("focus",{event:n,isInteracted:0!==Object.keys(n).length});!t.isNullOrUndefined(this.saveInterval)&&this.saveInterval>0&&!this.autoSaveOnIdle&&t.isNullOrUndefined(this.timeInterval)&&"Markdown"===this.editorMode&&(this.timeInterval=setInterval(this.updateValueOnIdle.bind(this),this.saveInterval));t.EventHandler.add(document,"mousedown",this.onDocumentClick,this)}this.readonly||(u=this.getCurrentFocus(n),"editArea"!==u&&"textArea"!==u&&"sourceCode"!==u||this.resetToolbarTabIndex())},i.prototype.getUpdatedValue=function(){var n,r=this.element.querySelector("."+fu),i;return"HTML"===this.editorMode?(n="<p><br><\/p>"===this.inputElement.innerHTML||"<div><br><\/div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(nr(tr(this.inputElement.innerHTML,this.editorMode))):this.inputElement.innerHTML,this.enableHtmlSanitizer&&!t.isNullOrUndefined(n)&&/&(amp;)*((times)|(divide)|(ne))/.test(n)&&(n=n.replace(/&(amp;)*(times|divide|ne)/g,"&amp;amp;$2")),!t.isNullOrUndefined(r)&&this.rootContainer.classList.contains("e-source-code-enabled"))&&(i=this.enableHtmlSanitizer?this.htmlEditorModule.sanitizeHelper(r.value):r.value,n=br(/&(amp;)*((times)|(divide)|(ne))/.test(i)?i.replace(/&(amp;)*(times|divide|ne)/g,"&amp;amp;$2"):i,this.element)):n=""===this.inputElement.value?null:this.inputElement.value,null==n||this.enableHtmlEncode||(n=tr(n,this.editorMode)),n},i.prototype.updateValueOnIdle=function(){(t.isNullOrUndefined(this.tableModule)||t.isNullOrUndefined(this.inputElement.querySelector(".e-table-box.e-rbox-select")))&&(this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.isValueChangeBlurhandler=!1,this.invokeChangeEvent())},i.prototype.updateIntervalValue=function(){clearTimeout(this.idleInterval);this.idleInterval=setTimeout(this.updateValueOnIdle.bind(this),0)},i.prototype.cleanupResizeElements=function(n){var t=tr(n.value,this.editorMode);n.callBack(t)},i.prototype.addAnchorAriaLabel=function(n){var r=document.createElement("div"),t,i;if(r.innerHTML=n,t=r.querySelectorAll("a"),t.length>0)for(i=0;i<t.length;i++)t[i].hasAttribute("target")&&"_blank"===t[i].getAttribute("target")&&(t[i].hasAttribute("aria-label")&&""!==t[i].getAttribute("aria-label")||t[i].setAttribute("aria-label",this.serviceLocator.getService("rteLocale").getConstant("linkAriaLabel")));return r.innerHTML},i.prototype.updateStatus=function(n){if(!t.isNullOrUndefined(n.html)||!t.isNullOrUndefined(n.markdown)){var i=this.formatter.editorManager.undoRedoManager.getUndoStatus(),r={undo:i.undo,redo:i.redo,html:n.html,markdown:n.markdown};this.trigger(cd,r)}},i.prototype.onDocumentClick=function(n){var i=n.target,u=t.closest(i,"."+ls),r;this.element.contains(n.target)||document===n.target||u===this.element||t.closest(i,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1);this.notify(gr,{args:n});this.removeHrFocus(n);r=this.quickToolbarModule&&!this.inlineMode.enable&&t.isNullOrUndefined(this.quickToolbarModule.inlineQTBar);(!r||t.isNullOrUndefined(t.closest(i,".e-toolbar-wrapper")))&&(!r||t.isNullOrUndefined(t.closest(i,".e-rte-table-resize"))&&t.isNullOrUndefined(t.closest(i,".e-table-box")))||this.quickToolbarModule.hideQuickToolbars();"msie"!==t.Browser.info.name&&n.detail>3&&n.preventDefault();this.handleChecklistDocumentClick(n,i)},i.prototype.handleChecklistDocumentClick=function(n,t){if(this.handleChecklistClick(n,t)){var i={originalEvent:n,item:this.createToolbarCommand()};this.formatter.process(this,i,n,{action:"toggleChecklist"})}},i.prototype.createToolbarCommand=function(){var n=null;return t.isNullOrUndefined(n)&&(n={command:"Checklist",subCommand:"Checklist"}),n},i.prototype.handleChecklistClick=function(n,i){if("LI"!==i.tagName||!t.closest(i,".e-rte-checklist"))return!1;var r=i.getBoundingClientRect(),u=n.clientX;if(this.enableRtl){if(u<=r.right)return!1}else if(u>=r.left)return!1;return!0},i.prototype.blurHandler=function(n){var i=n.relatedTarget,r,u,f;i&&(r=t.closest(i,"."+ls),!r&&this.iframeSettings.enable&&(u=this.element.querySelector("#"+this.getID()+"_rte-view"),u&&u.contentWindow.document.body.contains(i)&&(r=t.closest(u,"."+ls))),r&&r===this.element?(this.isBlur=!1,i===this.getToolbarElement()&&i.setAttribute("tabindex","-1")):t.closest(i,'[aria-owns="'+this.getID()+'"]')||t.closest(i,"."+pt)?this.isBlur=!1:(this.isBlur=!0,i=null));this.isBlur&&t.isNullOrUndefined(i)?(t.removeClass([this.element],[oa]),ek(this.inputElement),this.notify(wf,{}),f=this.getUpdatedValue(),this.rootContainer.classList.contains("e-source-code-enabled")?this.setProperties({value:f}):this.setProperties({value:f},!0),this.valueContainer.value=this.value,this.isValueChangeBlurhandler=!0,this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,eu(this.valueContainer,"focusout"),this.defaultResize(n),this.trigger("blur",{event:n,isInteracted:0!==Object.keys(n).length}),t.isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),!t.isNullOrUndefined(this.placeHolderWrapper)&&this.element.querySelector("[title = Preview]")&&(this.placeHolderWrapper.style.display="none"),t.EventHandler.remove(document,"mousedown",this.onDocumentClick)):this.isRTE=!0;this.readonly||"outside"!==this.getCurrentFocus(n)||this.resetToolbarTabIndex();this.previousRange=null},i.prototype.contentChanged=function(n){var i=this.inputElement.querySelector(".tempSpan");i&&t.detach(i);n&&!t.isNullOrUndefined(n.detail)&&n.detail.click&&this.formatter.saveData();this.autoSaveOnIdle&&(t.isNullOrUndefined(this.saveInterval)||(clearTimeout(this.autoSaveTimeOut),this.autoSaveTimeOut=setTimeout(this.updateIntervalValue.bind(this),this.saveInterval)))},i.prototype.invokeChangeEvent=function(){var n={value:this.enableXhtml?this.getXhtml():this.value,isInteracted:this.isValueChangeBlurhandler};this.value!==tr(this.cloneValue,this.editorMode)&&(this.trigger("change",n),this.cloneValue=this.value)},i.prototype.wireScrollElementsEvents=function(){var n,i,r;for(this.scrollParentElements=wi.getScrollableParent(this.element),n=0,i=this.scrollParentElements;n<i.length;n++)r=i[n],t.EventHandler.add(r,"scroll",this.scrollHandler,this);this.iframeSettings.enable||t.EventHandler.add(this.inputElement,"scroll",this.contentScrollHandler,this)},i.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(t.EventHandler.add(this.inputElement,"contextmenu",this.contextHandler,this),t.Browser.isDevice&&(this.touchModule=new t.Touch(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},i.prototype.unWireContextEvent=function(){t.EventHandler.remove(this.inputElement,"contextmenu",this.contextHandler);t.Browser.isDevice&&this.touchModule&&this.touchModule.destroy()},i.prototype.unWireScrollElementsEvents=function(){var n,i,r;for(this.scrollParentElements=wi.getScrollableParent(this.element),n=0,i=this.scrollParentElements;n<i.length;n++)r=i[n],t.EventHandler.remove(r,"scroll",this.scrollHandler);this.iframeSettings.enable||t.EventHandler.remove(this.inputElement,"scroll",this.contentScrollHandler)},i.prototype.touchHandler=function(n){this.notifyMouseUp(n.originalEvent);this.triggerEditArea(n.originalEvent)},i.prototype.contextHandler=function(n){var i=t.closest(n.target,"a, table, img, video, audio, .e-embed-video-wrap");!i&&n.target&&n.target.classList&&(n.target.classList.contains(sr)||n.target.classList.contains(cr))&&(i=n.target.querySelector("audio"));!1!==this.inlineMode.onSelection&&(t.isNullOrUndefined(i)||!this.inputElement.contains(i)||"IMG"!==i.tagName&&"TABLE"!==i.tagName&&"A"!==i.tagName&&"video"!==i.tagName.toLowerCase()&&"audio"!==i.tagName.toLowerCase()&&"SPAN"!==i.tagName)||n.preventDefault()},i.prototype.resetHandler=function(){var n=this.valueContainer.defaultValue.trim();this.setProperties({value:""===n?null:n})},i.prototype.autoResize=function(){var t,i,n,r;this.element&&this.originalElement&&this.valueContainer&&("auto"===this.height?"Markdown"===this.editorMode?this.setAutoHeight(this.inputElement):this.iframeSettings.enable&&(t=this.element.querySelector("#"+this.getID()+"_rte-view"),t&&this.setAutoHeight(t)):"Markdown"===this.editorMode?(i=this.inputElement,n=this.enableResize||this.showCharCount?20:0,i&&(i.style.height=this.element.clientHeight-(this.toolbarModule.getToolbarHeight()+n+3)+"px")):this.iframeSettings.enable&&(r=this.element.querySelector("#"+this.getID()+"_rte-view"),n=this.enableResize||this.showCharCount?20:0,r&&this.toolbarModule&&(r.style.height=this.element.clientHeight-(this.toolbarModule.getToolbarHeight()+n+3)+"px")))},i.prototype.setAutoHeight=function(n){"TEXTAREA"===n.nodeName?(n.style.height="auto",n.style.height=this.inputElement.scrollHeight+16+"px",n.style.overflow="hidden"):"IFRAME"===n.nodeName&&(n.style.height=this.inputElement.parentElement.offsetHeight+"px")},i.prototype.checkContentChanged=function(n){var t=this;return n.some(function(n){var i,r,u;return"characterData"===n.type?!0:"childList"===n.type&&(n.addedNodes.length>0||n.removedNodes.length>0)?!0:"attributes"===n.type?(i=n.target,i.isContentEditable&&t.inputElement===i)?!1:(r=n.attributeName,u=i.getAttribute(r),n.oldValue!==u):!1})},i.prototype.wireEvents=function(){var n=this;this.onBlurHandler=this.blurHandler.bind(this);this.onFocusHandler=this.focusHandler.bind(this);this.onResizeHandler=this.resizeHandler.bind(this);this.element.addEventListener("focusin",this.onFocusHandler,!0);this.element.addEventListener("focusout",this.onBlurHandler,!0);"HTML"===this.editorMode&&(this.mutationObserver=new MutationObserver(function(i){i.length>0&&!n.isFocusOut&&(n.checkContentChanged(i)?(n.hasContentChanged=!0,!n.autoSaveOnIdle&&!t.isNullOrUndefined(n.saveInterval)&&n.saveInterval>0&&t.isNullOrUndefined(n.timeInterval)&&(n.timeInterval=setInterval(function(){n.hasContentChanged?(n.updateValueOnIdle(),n.hasContentChanged=!1):(clearInterval(n.timeInterval),n.timeInterval=null)},n.saveInterval))):n.autoSaveOnIdle||t.isNullOrUndefined(n.timeInterval)||(clearInterval(n.timeInterval),n.timeInterval=null))}),this.mutationObserver.observe(this.inputElement,{attributes:!0,childList:!0,subtree:!0,characterData:!0,attributeOldValue:!0}));this.on(cf,this.contentChanged,this);this.on(ll,this.updateResizeFlag,this);this.on(ns,this.updateStatus,this);this.on(dl,this.cleanupResizeElements,this);this.on(na,this.updateValueOnIdle,this);this.on(ta,this.autoResize,this);this.iframeSettings.enable&&(this.onLoadHandler=this.iframeEditableElemLoad.bind(this),this.contentModule.getEditPanel().addEventListener("load",this.onLoadHandler,!0));this.readonly&&this.enabled||this.bindEvents()},i.prototype.restrict=function(n){var i;if(this.maxLength>=0){if(i="Markdown"===this.editorMode?this.contentModule.getText():this.getText().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,""),!i)return;for(var r=[8,16,17,37,38,39,40,46,65],u=void 0,t=0;t<=r.length-1;t++)if(n.which===r[t]){if(n.ctrlKey&&65===n.which)return;if(65!==n.which)return void(u=r[t])}i.length>=this.maxLength&&-1!==this.maxLength&&n.which!==u&&n.preventDefault()}},i.prototype.beforeInputHandler=function(n){if(this.maxLength>=0){var t="Markdown"===this.editorMode?this.contentModule.getText():this.getText().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"");n.data&&t.length>=this.maxLength&&!this.isSpecialInputType(n)&&n.preventDefault()}},i.prototype.isSpecialInputType=function(n){return n.inputType?-1!==n.inputType.indexOf("delete")||-1!==n.inputType.indexOf("backward")||"insertLineBreak"===n.inputType:-1!==[8,16,17,37,38,39,40,46,65].indexOf(n.which)},i.prototype.bindEvents=function(){this.keyboardModule=new yp(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:rd({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});this.userAgentData&&"Android"===this.userAgentData.getPlatform()&&t.EventHandler.add(this.inputElement,"beforeinput",this.beforeInputHandler,this);var n=t.closest(this.valueContainer,"form");n&&t.EventHandler.add(n,"reset",this.resetHandler,this);t.EventHandler.add(this.inputElement,"keyup",this.keyUp,this);t.EventHandler.add(this.inputElement,"paste",this.onPaste,this);t.EventHandler.add(this.inputElement,"content-changed",this.contentChanged,this);this.mouseDownDebListener=t.debounce(this.mouseUp,30);t.EventHandler.add(this.inputElement,t.Browser.touchEndEvent,this.mouseDownDebListener,this);t.EventHandler.add(this.inputElement,t.Browser.touchStartEvent,this.mouseDownHandler,this);t.EventHandler.add(this.inputElement,"input",this.inputHandler,this);this.wireContextEvent();this.formatter.editorManager.observer.on(c,this.editorKeyDown,this);this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0);this.iframeSettings.enable&&(t.EventHandler.add(this.inputElement,"focusin",this.focusHandler,this),t.EventHandler.add(this.inputElement,"focusout",this.blurHandler,this),t.EventHandler.add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),t.EventHandler.add(this.inputElement.ownerDocument,t.Browser.touchStartEvent,this.onIframeMouseDown,this),t.EventHandler.add(this.contentModule.getPanel(),"load",this.iframeLoadHandler,this));this.wireScrollElementsEvents();t.EventHandler.add(this.inputElement.ownerDocument,"selectionchange",this.selectionChangeHandler,this);t.EventHandler.add(this.inputElement.ownerDocument,"mouseup",this.mouseUpHandlerForSelection,this)},i.prototype.onIframeMouseDown=function(n){this.isBlur=!1;this.currentTarget=n.target;this.notify(ut,n);this.removeHrFocus(n);this.handleChecklistDocumentClick(n,this.currentTarget)},i.prototype.inputHandler=function(){this.autoResize()},i.prototype.editorKeyDown=function(n){switch(n.event.action){case"copy":this.onCopy(n.event);break;case"cut":this.onCut(n.event);break;case"tab":this.iframeSettings.enable&&(this.isBlur=!0)}n.callBack&&("copy"===n.event.action||"cut"===n.event.action||"delete"===n.event.action)&&n.callBack({requestType:n.event.action,editorMode:"HTML",event:n.event})},i.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0);this.onFocusHandler=null;this.element.removeEventListener("focusout",this.onBlurHandler,!0);this.onBlurHandler=null;this.mutationObserver&&(this.mutationObserver.disconnect(),this.mutationObserver=null);this.off(cf,this.contentChanged);this.off(ll,this.updateResizeFlag);this.off(ns,this.updateStatus);this.off(dl,this.cleanupResizeElements);this.off(na,this.updateValueOnIdle);this.off(ta,this.autoResize);this.iframeSettings.enable&&(this.contentModule.getEditPanel().removeEventListener("load",this.onLoadHandler,!0),this.onLoadHandler=null);this.readonly&&this.enabled||this.unbindEvents()},i.prototype.unbindEvents=function(){this.keyboardModule&&!this.keyboardModule.isDestroyed&&(this.keyboardModule.destroy(),this.keyboardModule=null);var n=t.closest(this.valueContainer,"form");n&&t.EventHandler.remove(n,"reset",this.resetHandler);t.EventHandler.remove(this.inputElement,"keyup",this.keyUp);t.EventHandler.remove(this.inputElement,"paste",this.onPaste);t.EventHandler.remove(this.inputElement,"content-changed",this.contentChanged);t.EventHandler.remove(this.inputElement,t.Browser.touchEndEvent,this.mouseDownDebListener);this.mouseDownDebListener=null;t.EventHandler.remove(this.inputElement,t.Browser.touchStartEvent,this.mouseDownHandler);t.EventHandler.remove(this.inputElement,"input",this.inputHandler);t.EventHandler.remove(document,"mousedown",this.onDocumentClick);this.unWireContextEvent();this.formatter&&this.formatter.editorManager.observer.off(c,this.editorKeyDown);this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0);this.onResizeHandler=null;this.iframeSettings.enable&&(t.EventHandler.remove(this.inputElement,"focusin",this.focusHandler),t.EventHandler.remove(this.inputElement,"focusout",this.blurHandler),t.EventHandler.remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),t.EventHandler.remove(this.inputElement.ownerDocument,t.Browser.touchStartEvent,this.onIframeMouseDown),t.EventHandler.remove(this.contentModule.getPanel(),"load",this.iframeLoadHandler));this.userAgentData&&"Android"===this.userAgentData.getPlatform()&&t.EventHandler.remove(this.inputElement,"beforeinput",this.beforeInputHandler);this.unWireScrollElementsEvents();t.EventHandler.remove(this.inputElement.ownerDocument,"selectionchange",this.selectionChangeHandler);t.EventHandler.remove(this.inputElement.ownerDocument,"mouseup",this.mouseUpHandlerForSelection)},i.prototype.getCurrentFocus=function(n){return n.target===this.inputElement&&document.activeElement===this.inputElement?"editArea":n.target===this.getToolbarElement()||!t.isNullOrUndefined(n.relatedTarget)&&t.closest(n.relatedTarget,".e-rte-toolbar")===this.getToolbarElement()?"toolbar":n.target===this.valueContainer&&document.activeElement===this.valueContainer?"textArea":!t.isNullOrUndefined(n.target)&&n.target.classList.contains(fu)&&document.activeElement===n.target?"sourceCode":"outside"},i.prototype.resetToolbarTabIndex=function(){if(this.getToolbarElement())for(var t=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]"),n=0;n<t.length;n++)t[n].classList.contains("e-rte-dropdown-btn")||t[n].classList.contains("e-insert-table-btn")||t[n].hasAttribute("tabindex")&&"-1"===t[n].getAttribute("tabindex")||t[n].setAttribute("tabindex","-1")},i.prototype.getRenderedQuickToolbarElem=function(){if(!t.isNullOrUndefined(this.quickToolbarModule))for(var i=this.quickToolbarModule.getQuickToolbarInstance(),n=0;n<i.length;n++)if(i[n]&&i[n].isRendered)return i[n].element;return null},i.prototype.iframeLoadHandler=function(){this.autoResize()},i.prototype.iframeEditableElemLoad=function(){this.autoResize()},i.prototype.clearUndoRedo=function(){t.isNullOrUndefined(this.formatter)||(this.formatter.clearUndoRedoStack(),this.formatter.enableUndo(this))},i.prototype.removeHrFocus=function(n){if(n.target&&this.inputElement.querySelector("hr.e-rte-hr-focus")){var t=this.inputElement.querySelector("hr.e-rte-hr-focus");t.classList.remove("e-rte-hr-focus");0===t.classList.length&&t.removeAttribute("class")}},i.prototype.isSelectionInRTE=function(){var t=this.contentModule.getDocument().getSelection(),n;return t.rangeCount>0&&(n=t.getRangeAt(0),n&&this.inputElement.contains(n.startContainer)&&this.inputElement.contains(n.endContainer))?!0:!1},i.prototype.selectionChangeHandler=function(){this.isSelectionInRTE()&&!this.isSelectionCollapsed()&&this.isSelectionStartInRTE&&(this.isSelecting=!0)},i.prototype.isMouseUpOutOfRTE=function(n){var t=n.target&&("HTML"===n.target.nodeName||"#document"===n.target.nodeName),i=!(n.target&&"#text"!==n.target.nodeName&&"#document"!==n.target.nodeName&&"HTML"!==n.target.nodeName&&(n.target.closest(".e-rte-elements")||n.target.closest(".e-rte-toolbar")));return!!(t||!this.inputElement.contains(n.target)&&i)},i.prototype.mouseUpHandlerForSelection=function(n){this.isSelecting&&this.isMouseUpOutOfRTE(n)&&this.endSelection(n);this.isSelectionStartInRTE=!1},i.prototype.endSelection=function(n){this.handleSelectionChange(n);this.isSelecting=!1},i.prototype.isSelectionCollapsed=function(){var t=this.contentModule.getDocument().getSelection(),n=t&&0!==t.rangeCount&&t.getRangeAt(0);return n.startContainer===n.endContainer&&n.startOffset===n.endOffset},i.prototype.handleSelectionChange=function(n){!0===this.inlineMode.enable&&this.notify(yu,{args:n});!this.inlineMode.enable&&this.quickToolbarSettings&&(this.quickToolbarSettings.text||this.quickToolbarSettings.link&&"mouseup"===n.type)&&(this.notify(ko,{args:n}),this.notify(yu,{args:n}));this.quickToolbarModule.linkQTBar&&this.quickToolbarModule.linkQTBar.element&&this.quickToolbarModule.linkQTBar.element.classList.contains("e-popup-open")||this.notify(hi,{args:n});this.triggerSelectionChanged()},r([t.Complex({},lst)],i.prototype,"toolbarSettings",void 0),r([t.Complex({enable:!1,items:["Paragraph","Heading 1","Heading 2","Heading 3","Heading 4","OrderedList","UnorderedList","CodeBlock","Blockquote"],popupWidth:"300px",popupHeight:"320px"},dht)],i.prototype,"slashMenuSettings",void 0),r([t.Complex({},dst)],i.prototype,"quickToolbarSettings",void 0),r([t.Complex({},nht)],i.prototype,"pasteCleanupSettings",void 0),r([t.Complex({},gst)],i.prototype,"formatPainterSettings",void 0),r([t.Complex({},cht)],i.prototype,"emojiPickerSettings",void 0),r([t.Complex({},yht)],i.prototype,"iframeSettings",void 0),r([t.Complex({},pst)],i.prototype,"insertImageSettings",void 0),r([t.Complex({},ast)],i.prototype,"importWord",void 0),r([t.Complex({},vst)],i.prototype,"exportWord",void 0),r([t.Complex({},yst)],i.prototype,"exportPdf",void 0),r([t.Complex({},wst)],i.prototype,"insertAudioSettings",void 0),r([t.Complex({},bst)],i.prototype,"insertVideoSettings",void 0),r([t.Complex({},kst)],i.prototype,"tableSettings",void 0),r([t.Property(0)],i.prototype,"floatingToolbarOffset",void 0),r([t.Complex({},wht)],i.prototype,"inlineMode",void 0),r([t.Complex({},aht)],i.prototype,"fileManagerSettings",void 0),r([t.Property("100%")],i.prototype,"width",void 0),r([t.Property(!1)],i.prototype,"enablePersistence",void 0),r([t.Property(!0)],i.prototype,"showTooltip",void 0),r([t.Property(!1)],i.prototype,"enableResize",void 0),r([t.Property({})],i.prototype,"htmlAttributes",void 0),r([t.Property(null)],i.prototype,"placeholder",void 0),r([t.Property(!1)],i.prototype,"autoSaveOnIdle",void 0),r([t.Property(!1)],i.prototype,"readonly",void 0),r([t.Property(!0)],i.prototype,"enabled",void 0),r([t.Property(!0)],i.prototype,"enableHtmlSanitizer",void 0),r([t.Property(!1)],i.prototype,"enableHtmlEncode",void 0),r([t.Property(!1)],i.prototype,"enableXhtml",void 0),r([t.Property("auto")],i.prototype,"height",void 0),r([t.Property(null)],i.prototype,"cssClass",void 0),r([t.Property(null)],i.prototype,"value",void 0),r([t.Property("P")],i.prototype,"enterKey",void 0),r([t.Property("BR")],i.prototype,"shiftEnterKey",void 0),r([t.Property(30)],i.prototype,"undoRedoSteps",void 0),r([t.Property(300)],i.prototype,"undoRedoTimer",void 0),r([t.Property("HTML")],i.prototype,"editorMode",void 0),r([t.Property(null)],i.prototype,"keyConfig",void 0),r([t.Property(!1)],i.prototype,"showCharCount",void 0),r([t.Property(!1)],i.prototype,"enableTabKey",void 0),r([t.Property(!1)],i.prototype,"enableAutoUrl",void 0),r([t.Property(-1)],i.prototype,"maxLength",void 0),r([t.Complex({},rht)],i.prototype,"format",void 0),r([t.Complex({},sht)],i.prototype,"codeBlockSettings",void 0),r([t.Complex({},eht)],i.prototype,"numberFormatList",void 0),r([t.Complex({},oht)],i.prototype,"bulletFormatList",void 0),r([t.Complex({},tht)],i.prototype,"fontFamily",void 0),r([t.Complex({},iht)],i.prototype,"fontSize",void 0),r([t.Complex({},uht)],i.prototype,"fontColor",void 0),r([t.Complex({},fht)],i.prototype,"backgroundColor",void 0),r([t.Property(null)],i.prototype,"valueTemplate",void 0),r([t.Property(1e4)],i.prototype,"saveInterval",void 0),r([t.Event()],i.prototype,"actionBegin",void 0),r([t.Event()],i.prototype,"actionComplete",void 0),r([t.Event()],i.prototype,"beforeDialogOpen",void 0),r([t.Event()],i.prototype,"dialogOpen",void 0),r([t.Event()],i.prototype,"beforeDialogClose",void 0),r([t.Event()],i.prototype,"dialogClose",void 0),r([t.Event()],i.prototype,"beforeQuickToolbarOpen",void 0),r([t.Event()],i.prototype,"quickToolbarOpen",void 0),r([t.Event()],i.prototype,"quickToolbarClose",void 0),r([t.Event()],i.prototype,"toolbarStatusUpdate",void 0),r([t.Event()],i.prototype,"updatedToolbarStatus",void 0),r([t.Event()],i.prototype,"imageSelected",void 0),r([t.Event()],i.prototype,"beforeImageUpload",void 0),r([t.Event()],i.prototype,"imageUploading",void 0),r([t.Event()],i.prototype,"imageUploadSuccess",void 0),r([t.Event()],i.prototype,"imageUploadFailed",void 0),r([t.Event()],i.prototype,"imageRemoving",void 0),r([t.Event()],i.prototype,"afterImageDelete",void 0),r([t.Event()],i.prototype,"fileSelected",void 0),r([t.Event()],i.prototype,"beforeFileUpload",void 0),r([t.Event()],i.prototype,"fileUploading",void 0),r([t.Event()],i.prototype,"fileUploadSuccess",void 0),r([t.Event()],i.prototype,"fileUploadFailed",void 0),r([t.Event()],i.prototype,"fileRemoving",void 0),r([t.Event()],i.prototype,"afterMediaDelete",void 0),r([t.Event()],i.prototype,"created",void 0),r([t.Event()],i.prototype,"destroyed",void 0),r([t.Event()],i.prototype,"beforeSanitizeHtml",void 0),r([t.Event()],i.prototype,"blur",void 0),r([t.Event()],i.prototype,"toolbarClick",void 0),r([t.Event()],i.prototype,"focus",void 0),r([t.Event()],i.prototype,"change",void 0),r([t.Event()],i.prototype,"resizing",void 0),r([t.Event()],i.prototype,"resizeStart",void 0),r([t.Event()],i.prototype,"resizeStop",void 0),r([t.Event()],i.prototype,"beforePasteCleanup",void 0),r([t.Event()],i.prototype,"afterPasteCleanup",void 0),r([t.Event()],i.prototype,"beforeImageDrop",void 0),r([t.Event()],i.prototype,"beforeMediaDrop",void 0),r([t.Property(null)],i.prototype,"formatter",void 0),r([t.Event()],i.prototype,"slashMenuItemSelect",void 0),r([t.Event()],i.prototype,"selectionChanged",void 0),r([t.NotifyPropertyChanges],i)}(t.Component),uct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tut=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.styles=t.getEditorStyles(),t.IFRAMEHEADER="\n    <!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset='utf-8' /> \n            <style>"+t.styles+"\n            <\/style>\n        <\/head>\n    ",t}return uct(i,n),i.prototype.getEditorStyles=function(){return lrt.replace(/[\n\t]/g,"")+(window.getComputedStyle(this.parent.element.querySelector(".e-rte-container")).content.includes("dark-theme")?vrt:art).replace(/[\n\t]/g,"")},i.prototype.renderPanel=function(){var r=this.parent,s=gs(r.value,r),h='<body contenteditable="true" aria-label="Rich Text Editor" role="textbox" lang="'+this.parent.locale.slice(0,2)+'" dir="'+(this.parent.enableRtl?"rtl":"ltr")+'">'+s+"<\/body><\/html>",u=this.IFRAMEHEADER+h,n=this.parent.createElement("iframe",{id:this.parent.getID()+"_rte-view",className:"e-rte-content",attrs:{srcdoc:u}}),f,e,i,o;(n.setAttribute("role","none"),this.setPanel(n),t.isNullOrUndefined(this.parent.iframeSettings.sandbox))||(f=this.parent.iframeSettings.sandbox.map(function(n){return n.toLocaleLowerCase().trim()}).join(" "),f.includes("allow-same-origin")||(f+=" allow-same-origin"),n.setAttribute("sandbox",f.trim()));e=t.createElement("div",{className:bw});r.rootContainer.appendChild(e);e.appendChild(n);n.contentDocument.body.setAttribute("aria-owns",this.parent.getID());n.contentDocument.open();u=this.setThemeColor(u,{color:"#333"});n.contentDocument.write(u);n.contentDocument.close();i=n.contentDocument.body;(i.className="e-content","auto"===this.parent.height&&(i.style.overflowY="hidden"),t.isNullOrUndefined(this.parent.fontFamily.default)||(i.style.fontFamily=this.parent.fontFamily.default),t.isNullOrUndefined(this.parent.fontSize.default)||(i.style.fontSize=this.parent.fontSize.default),i.id=this.parent.getID()+"_rte-edit-view",r.enableRtl&&this.contentPanel.contentDocument.body.classList.add("e-rtl"),!t.isNullOrUndefined(n.contentDocument.head)&&this.parent.iframeSettings.metaTags.length>0)&&(o=n.contentDocument.head,this.parent.iframeSettings.metaTags.forEach(function(n){var r=document.createElement("meta");for(var i in n)t.isNullOrUndefined(n[i])||r.setAttribute("httpEquiv"===i?"http-equiv":i,n[i]);o.appendChild(r)}))},i.prototype.setThemeColor=function(n,t){var i=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return n.replace(t.color,i)},i.prototype.getEditPanel=function(){return t.isNullOrUndefined(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body},i.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},i}(iy),iut=function(){function n(n){this.parent=n}return n.prototype.renderPanel=function(){var n=this.parent,t=this.parent.createElement("div",{id:this.parent.getID()+"_view",className:"e-rte-content"});this.editableElement=this.parent.createElement("textarea",{className:"e-content",id:this.parent.getID()+"_editable-content",attrs:{"aria-labelledby":this.parent.getID()+"_view","aria-label":"Markdown Editor",role:"textbox",lang:n.locale.slice(0,2),dir:n.enableRtl?"rtl":"ltr"}});t.appendChild(this.editableElement);this.setPanel(t);n.rootContainer.appendChild(t)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){return this.getEditPanel().value},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}(),rut=function(){function n(n){this.parent=n}return n.prototype.renderPopup=function(n){var i;this.type=n;var r="Inline"===this.type?gw+" "+cg:gw,u="Inline"===this.type?"_Inline_Quick_Popup":"_Quick_Popup",f=t.getUniqueID(this.parent.getID()+"_"+n+u);return this.popupElement=this.parent.createElement("div",{className:r+" "+pt}),this.popupElement.setAttribute("aria-owns",this.parent.getID()),this.popupElement.id=f,i=this.parent.createElement("div",{className:nb}),this.popupElement.appendChild(i),this.popup=this.createPopup(this.type,this.popupElement),this.popup},n.prototype.quickToolbarOpen=function(){var n=this.popup;this.parent.trigger(wd,n)},n.prototype.createPopup=function(n,t){var i;switch(n){case"Inline":case"Text":case"Link":case"Audio":case"Video":case"Image":case"Table":i=new wi.Popup(t,{viewPortElement:this.parent.iframeSettings.enable?null:this.parent.contentModule.getEditPanel(),zIndex:9,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"top"},actionOnScroll:"none",open:this.quickToolbarOpen.bind(this)})}return i},n}();const fct=ejdashboard.dropdowns;var ect=function(){function n(n,t){this.parent=n;this.currentDocument=this.parent.element.ownerDocument;this.L10n=t.getService("rteLocale");this.savedSelection=new st(this.parent.inputElement);this.defaultItems=ght;this.injectibleItems=nct;this.parent.on(k,this.onPropertyChanged,this);this.parent.on(u,this.removeEventListener,this);this.parent.on(a,this.render,this)}return n.prototype.removeEventListener=function(){this.parent.off(k,this.onPropertyChanged);this.parent.off(u,this.removeEventListener)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)if("slashMenuSettings"===i[t])switch(Object.keys(n.newProp.slashMenuSettings)[0]){case"enable":n.newProp.slashMenuSettings.enable?this.render():this.removeEventListener();break;case"items":this.mention.dataSource=this.getItems();break;case"popupHeight":this.mention.popupHeight=n.newProp.slashMenuSettings.popupHeight;break;case"popupWidth":this.mention.popupWidth=n.newProp.slashMenuSettings.popupWidth}},n.prototype.getModuleName=function(){return"slashMenu"},n.prototype.destroy=function(){this.mention&&!this.mention.isDestroyed&&(this.mention.destroy(),this.defaultItems=[],this.injectibleItems=[])},n.prototype.generateMentionModel=function(){var n=this;return{dataSource:this.getItems(),cssClass:"e-slash-menu e-rte-elements"+this.parent.getCssClass(),fields:{text:"text",groupBy:"type",iconCss:"iconCss",value:"description"},mentionChar:"/",target:this.parent.inputElement,popupHeight:this.parent.slashMenuSettings.popupHeight,popupWidth:this.parent.slashMenuSettings.popupWidth,allowSpaces:!0,itemTemplate:'${if(iconCss && description)}<div class="e-rte-slash-menu-item-content-description"><div class="e-slash-menu-icon"><div class="${iconCss}"><\/div><\/div> <div class="e-rte-slash-menu-item-text-column"><span class="e-rte-slash-menu-item-text">${text}<\/span>${if(description)}<span class="e-rte-slash-menu-item-description">${description}<\/span>${/if}<\/div><\/div>${else}${if(iconCss && text)}<div class="e-rte-slash-menu-item-content-text"><div class="e-slash-menu-icon"><div class="${iconCss}"><\/div><\/div> <span class="e-rte-slash-menu-item-icon-text">${text}<\/span><\/div>${/if}${/if}',beforeOpen:function(){n.parent.notify(uw,{});n.savedSelection=n.savedSelection.save(n.savedSelection.getRange(n.currentDocument),n.currentDocument)},filtering:function(){n.savedSelection=n.savedSelection.save(n.savedSelection.getRange(n.currentDocument),n.currentDocument)},select:this.handleSelect.bind(this)}},n.prototype.handleSelect=function(n){var i=this,u,r;n.cancel=!0;this.parent.focusIn();this.savedSelection.restore();u=n.itemData;r={isInteracted:n.isInteracted,item:n.item,itemData:n.itemData,originalEvent:n.e,cancel:!1};n.itemData.isCustomItem&&this.parent.formatter.beforeSlashMenuApply();this.parent.trigger("slashMenuItemSelect",r,function(n){var e,f,o,s;if(!n.cancel)if(n.itemData.isCustomItem)i.parent.inputElement.classList.contains("e-mention")&&(e=i.parent.inputElement.ownerDocument.getElementById(i.parent.inputElement.id+"_slash_menu_popup"),e&&e.classList.contains("e-popup-open")&&i.mention.hidePopup());else{i.parent.formatter.beforeSlashMenuApply();f=u;switch(f.command){case"OrderedList":i.parent.executeCommand("insertOrderedList");break;case"UnorderedList":i.parent.executeCommand("insertUnorderedList");break;case"Audio":case"Video":case"Image":case"Table":case"Link":i.mention.hidePopup();setTimeout(function(){f.subCommand===d.InsertLink?i.parent.notify(ts,{}):f.subCommand===d.InsertImage?i.parent.notify(is,r):f.subCommand===d.InsertAudio?i.parent.notify(rs,r):f.subCommand===d.InsertVideo?i.parent.notify(us,r):f.subCommand===d.InsertTable&&i.parent.notify(fs,{})},100);break;case"Emojipicker":i.mention.hidePopup();setTimeout(function(){i.parent.showEmojiPicker()},100);break;case"CodeBlock":t.isNullOrUndefined(i.parent.codeBlockModule)||(o=void 0,i.parent.codeBlockSettings.languages&&i.parent.codeBlockSettings.languages.length>0&&(s=t.isNullOrUndefined(i.parent.codeBlockSettings.defaultLanguage)?[]:i.parent.codeBlockSettings.languages.filter(function(n){return n.language===i.parent.codeBlockSettings.defaultLanguage}),o=s.length>0?s[0]:i.parent.codeBlockSettings.languages[0],i.parent.executeCommand("insertCodeBlock",o)));break;default:i.parent.executeCommand("formatBlock",f.subCommand)}i.parent.notify(hi,{})}})},n.prototype.getItems=function(){for(var n=this.parent.slashMenuSettings.items,r=[],f=function(u){var e,f,o;"string"==typeof n[u]?(e=n[u],f=i.defaultItems.filter(function(n){return n.command===e})[0],t.isNullOrUndefined(f)&&(f=i.injectibleItems.filter(function(n){return n.module.toLowerCase().replace(" ","")===e.toLowerCase().replace(" ","")})[0]),o=bot.get(e),r.push({text:i.L10n.getConstant(o.text),command:f.command,subCommand:f.subCommand,type:f.type,module:f.module,iconCss:f.iconCss,description:i.L10n.getConstant(o.description)})):r.push({text:n[u].text,command:n[u].command,type:n[u].type,iconCss:n[u].iconCss,description:n[u].description,isCustomItem:!0})},i=this,u=0;u<n.length;u++)f(u);return r},n.prototype.render=function(){if("HTML"===this.parent.editorMode&&this.parent.slashMenuSettings.enable){var n=this.generateMentionModel();this.mention=new fct.Mention(n);this.mention.appendTo(this.parent.rootContainer.appendChild(this.parent.createElement("div",{className:"e-rte-slash-menu",id:this.parent.getID()+"_slash_menu"})))}},n}(),bp=function(){function n(n,i){this.tools={};this.parent=n;this.locator=i;this.isDestroyed=!1;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,ae,fv(this.parent.toolbarSettings.itemConfigs),!0):this.tools=ae;(this.parent.toolbarSettings.enable||this.parent.quickToolbarSettings.enable)&&(this.toolbarRenderer=new lp(this.parent,this.locator),this.renderFactory.addRenderer(o.Toolbar,this.toolbarRenderer))}return n.prototype.addEventListener=function(){this.parent.on(ur,this.setRtl,this);this.parent.on(w,this.setCssClass,this)},n.prototype.removeEventListener=function(){this.parent.off(ur,this.setRtl);this.parent.off(w,this.setCssClass)},n.prototype.setCssClass=function(n){t.isNullOrUndefined(this.toolbarObj)||(t.isNullOrUndefined(n.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+n.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(n.oldCssClass,"").trim()+" "+n.cssClass).trim()}))},n.prototype.setRtl=function(n){t.isNullOrUndefined(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.getClass=function(n){var t;switch(n){case"fontsize":t="e-rte-inline-size-template";break;case"fontcolor":case"backgroundcolor":t="e-rte-inline-color-template";break;default:t="e-rte-inline-template"}return t},n.prototype.getTemplateObject=function(n,t){var i;switch(n){case"fontcolor":case"backgroundcolor":i="span";break;default:i="button"}return{command:this.tools[n.toLocaleLowerCase()].command,subCommand:this.tools[n.toLocaleLowerCase()].subCommand,template:this.parent.createElement(i,{id:this.parent.getID()+"_"+t+"_"+this.tools[n.toLocaleLowerCase()].id}).outerHTML,cssClass:this.parent.inlineMode.enable?this.getClass(n):"",tooltipText:this.parent.enabled?ve(n,this.locator):""}},n.prototype.getObject=function(n,t){var i=n.toLowerCase();if(-1!==wb.indexOf(i))return this.getTemplateObject(i,t);switch(i){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:yg};default:return{id:this.parent.getID()+"_"+t+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,tooltipText:this.parent.enabled?ve(i,this.locator):"",command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}}},n.prototype.getItems=function(n,i){var u=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var r=[],s=function(n){var e,f,o;"string"==typeof n?(e=h.getObject(n,i),n.toLowerCase().indexOf("imagelink")>-1&&(e.cssClass="e-link-groups"),r.push(e)):(t.isNullOrUndefined(n.click)||(f=n,o=f.click,f.click=function(){if(f.undo&&0===u.parent.formatter.getUndoRedoStack().length&&u.parent.formatter.saveData(),o.call(u),u.parent.formatter.getUndoRedoStack().length>0){var n=u.parent.createElement("div"),t=u.parent.formatter.getUndoRedoStack()[u.parent.formatter.getUndoRedoStack().length-1].text.cloneNode(!0);if(n.appendChild(t),n.innerHTML.trim()===u.parent.inputElement.innerHTML.trim())return}f.undo&&u.parent.formatter.saveData()}),r.push(n))},h=this,f=0,o=n;f<o.length;f++)s(o[f]);if(this.parent.showTooltip&&this.parent.enabled)for(var c=function(n){var i=r[n].tooltipText,u=void 0,f="macOS"===l.parent.userAgentData.getPlatform();(u=!ftt[""+r[n].subCommand]||t.isNullOrUndefined(r[n].id)&&t.isNullOrUndefined(r[n].cssClass)?i:ftt[""+r[n].subCommand].split(",").map(function(n){return f?n.replace("Ctrl+","⌘").replace("Shift+","⇧").replace("Alt+","⌥"):n}).join(", "))&&("Images"===r[n].command&&"InsertLink"===r[n].subCommand||(r[n].tooltipText=i!==u?i+" ("+u+")":i))},l=this,e=0;e<r.length;e++)c(e);return r},n.prototype.getToolbarOptions=function(n){return{target:n.target,rteToolbarObj:this,items:this.getItems(n.items,n.container),overflowMode:n.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,cssClass:n.cssClass,type:n.container}},n.prototype.render=function(n){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar);this.toolbarRenderer&&this.toolbarRenderer.isDestroyed&&(this.toolbarRenderer=new lp(this.parent,this.locator));this.toolbarRenderer.renderToolbar(this.getToolbarOptions(n))},n.prototype.destroy=function(){this.isDestroyed||(this.removeEventListener(),this.toolbarObj&&!this.toolbarObj.isDestroyed&&(this.toolbarObj.destroy(),this.toolbarObj=null),this.toolbarRenderer.destroy(),this.toolbarRenderer=null,this.tools={},this.isDestroyed=!0)},n}(),kp=function(){function n(n,t){this.parent=n;this.locator=t;this.i10n=t.getService("rteLocale");this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(o.Toolbar)},n.prototype.beforeRender=function(n){var i=n.item;i.cssClass&&t.addClass([n.element],i.cssClass)},n.prototype.dropdownContent=function(n,t,i){return'<span class="e-rte-dropdown-btn-text-wrapper" style="width:'+("quick"===t?"auto":n)+'" ><span class="e-rte-dropdown-btn-text">'+i+"<\/span><\/span>"},n.prototype.renderDropDowns=function(n,i){var r=this,u,f;this.initializeInstance();u=n.containerType;f=n.container;wb.forEach(function(e){var o=void 0,l,a,v,c,d,s,y,h,p,w,k;if(-1!==iv(e,n.items))switch(e){case"numberformatlist":if(o=t.select("#"+r.parent.getID()+"_"+u+"_NumberFormatList",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;l=r.parent.numberFormatList.types.slice();l.forEach(function(n){Object.defineProperties(n,{command:{value:"Lists",enumerable:!0},subCommand:{value:"NumberFormatList",enumerable:!0}})});r.numberFormatListDropDown=r.toolbarRenderer.renderSplitButton({cssClass:en+" "+pt+" "+lr,itemName:"NumberFormatList",items:l,element:o,iconCss:"e-order-list "+ws});break;case"bulletformatlist":if(o=t.select("#"+r.parent.getID()+"_"+u+"_BulletFormatList",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;a=r.parent.bulletFormatList.types.slice();a.forEach(function(n){Object.defineProperties(n,{command:{value:"Lists",enumerable:!0},subCommand:{value:"BulletFormatList",enumerable:!0}})});r.bulletFormatListDropDown=r.toolbarRenderer.renderSplitButton({cssClass:on+" "+pt+" "+lr,itemName:"BulletFormatList",items:a,element:o,iconCss:"e-unorder-list "+ws});break;case"codeblock":if(o=t.select("#"+r.parent.getID()+"_"+u+"_codeBlock",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;v=(t.isNullOrUndefined(r.parent.codeBlockSettings.languages)?[]:r.parent.codeBlockSettings.languages).slice();v.forEach(function(n){Object.defineProperties(n,{command:{value:"CodeBlock",enumerable:!0},subCommand:{value:"CodeBlock",enumerable:!0},text:{value:n.label,enumerable:!0},value:{value:n.language,enumerable:!0}})});r.codeBlockSplitButton=r.toolbarRenderer.renderSplitButton({cssClass:"e-code-block "+pg+" "+pt+" e-rte-dropdown",itemName:"CodeBlock",items:v,element:o,iconCss:wg+" e-icons"});break;case"formats":if(o=t.select("#"+r.parent.getID()+"_"+u+"_Formats",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;c=r.parent.format.types.slice();c.forEach(function(n){Object.defineProperties(n,{command:{value:"Formats",enumerable:!0},subCommand:{value:n.value,enumerable:!0}})});d=t.isNullOrUndefined(r.parent.format.default)?c[0].text:r.parent.format.default;r.formatDropDown=r.toolbarRenderer.renderDropDownButton({content:r.dropdownContent(r.parent.format.width,u,"quick"===u?"":fi(c,d,"text","text")),cssClass:ni+" "+vi+" "+bg,itemName:"Formats",items:c,element:o});break;case"fontname":if(o=t.select("#"+r.parent.getID()+"_"+u+"_FontName",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;s=r.parent.fontFamily.items.slice();s.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});y=t.isNullOrUndefined(r.parent.fontFamily.default)?0===s.length?"":s[0].text:r.parent.fontFamily.default;r.fontNameDropDown=r.toolbarRenderer.renderDropDownButton({content:r.dropdownContent(r.parent.fontFamily.width,u,0===s.length?r.i10n.getConstant("fontName"):"quick"===u?"":"Default"===fi(s,y,"text","text")?r.i10n.getConstant("fontName"):fi(s,y,"text","text")),cssClass:ni+" "+vi+" "+kg,itemName:"FontName",items:s,element:o});break;case"fontsize":if(o=t.select("#"+r.parent.getID()+"_"+u+"_FontSize",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;h=!t.isNullOrUndefined(r.fontSizeDropDown)&&!t.isNullOrUndefined(r.fontSizeDropDown.items)&&r.fontSizeDropDown.items.length>0?r.fontSizeDropDown.items:JSON.parse(JSON.stringify(r.parent.fontSize.items.slice()));h.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});p=t.isNullOrUndefined(r.parent.fontSize.default)?0===h.length?"":h[0].text:r.parent.fontSize.default;w=fi(h,p.replace(/\s/g,""),"Default"===p?"text":"value","text");r.fontSizeDropDown=r.toolbarRenderer.renderDropDownButton({content:r.dropdownContent(r.parent.fontSize.width,u,0===h.length?r.i10n.getConstant("fontSize"):rv("Default"===w?r.i10n.getConstant("fontSize"):w)),cssClass:ni+" "+vi+" "+dg,itemName:"FontSize",items:h,element:o});break;case"alignments":if(o=t.select("#"+r.parent.getID()+"_"+u+"_Alignments",f),t.isNullOrUndefined(o)||o.classList.contains(yt))return;r.alignDropDown=r.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:ni+" "+vi+" "+gg,itemName:"Alignments",items:ds,element:o});break;case"align":case"videoalign":r.renderAlignmentDropDown(u,f,i,e);break;case"display":case"audiolayoutoption":case"videolayoutoption":r.renderDisplayDropDown(u,f,i,e);break;case"tablerows":r.rowDropDown(u,f,o,i);break;case"tablecolumns":r.columnDropDown(u,f,o);break;case"tablecell":r.cellDropDown(u,f,o);break;case"tablecellverticalalign":r.verticalAlignDropDown(u,f,o);break;case"styles":r.tableStylesDropDown(u,f,o);break;case"borderstyle":o=f;for(var g=void 0,b=0,nt=ks;b<nt.length;b++)if(k=nt[b],i.style.borderStyle===k.subCommand.toLowerCase()){g=k.text;break}r.tableBorderStyleDropDown=r.toolbarRenderer.renderDropDownButton({content:'<span class="e-rte-dropdown-btn-text-wrapper"><span class="e-rte-dropdown-btn-text">'+g+"<\/span><\/span>",cssClass:ni+" "+vi+" "+nn,itemName:"BorderStyle",items:ks,element:o})}});this.parent.inlineMode.enable&&this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.getUpdateItems=function(n,t){var i=n.slice();return i.forEach(function(n){Object.defineProperties(n,{command:{value:"Format"===t?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===t?n.value:t,enumerable:!0}})}),i},n.prototype.onPropertyChanged=function(n){for(var f,c,e,l,o,a,v,y,p,s,w,b,d,i,u,r=n.newProp,h=0,k=Object.keys(r);h<k.length;h++)switch(k[h]){case"fontFamily":if(this.fontNameDropDown)for(f=0,c=Object.keys(r.fontFamily);f<c.length;f++)switch(c[f]){case"default":case"width":e=this.fontNameDropDown.items;i=t.isNullOrUndefined(t.closest(this.fontNameDropDown.element,"."+vs))?"toolbar":"quick";l=t.isNullOrUndefined(this.parent.fontFamily.default)?e[0].text:this.parent.fontFamily.default;u=this.dropdownContent(this.parent.fontFamily.width,i,"quick"===i?"":"Default"===fi(e,l,"text","text")?this.i10n.getConstant("fontName"):fi(e,l,"text","text"));this.fontNameDropDown.setProperties({content:u});t.isNullOrUndefined(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(r.fontFamily.items,"FontName")})}break;case"fontSize":if(this.fontSizeDropDown)for(o=0,a=Object.keys(r.fontSize);o<a.length;o++)switch(a[o]){case"default":case"width":v=this.fontSizeDropDown.items;i=t.isNullOrUndefined(t.closest(this.fontSizeDropDown.element,"."+vs))?"toolbar":"quick";y=t.isNullOrUndefined(this.parent.fontSize.default)?v[0].text:this.parent.fontSize.default;p=fi(v,y.replace(/\s/g,""),"Default"===y?"text":"value","text");u=this.dropdownContent(this.parent.fontSize.width,i,rv("Default"===p?this.i10n.getConstant("fontSize"):p));this.fontSizeDropDown.setProperties({content:u});t.isNullOrUndefined(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(r.fontSize.items,"FontSize")})}break;case"format":if(this.formatDropDown)for(s=0,w=Object.keys(r.format);s<w.length;s++)switch(w[s]){case"default":case"width":b=this.formatDropDown.items;i=t.isNullOrUndefined(t.closest(this.formatDropDown.element,"."+vs))?"toolbar":"quick";d=t.isNullOrUndefined(this.parent.format.default)?b[0].text:this.parent.format.default;u=this.dropdownContent(this.parent.format.width,i,"quick"===i?"":fi(b,d,"text","text"));this.formatDropDown.setProperties({content:u});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(r.format.types,"Format")})}}},n.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},n.prototype.rowDropDown=function(n,i,r,u){r=t.select("#"+this.parent.getID()+"_"+n+"_TableRows",i);var f=Array.from(ga);r.classList.contains(yt)||(u.closest("th")&&f.shift(),this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:ni+" "+vi+" "+iu,itemName:"TableRows",items:f,element:r}))},n.prototype.columnDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableColumns",i)).classList.contains(yt)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:ni+" "+vi+" "+iu,itemName:"TableColumns",items:nv,element:r}))},n.prototype.cellDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableCell",i)).classList.contains(yt)||(this.tableCellDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell e-icons",cssClass:ni+" "+vi+" "+iu,itemName:"TableCell",items:eot,element:r}))},n.prototype.verticalAlignDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableCellVerticalAlign",i)).classList.contains(yt)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:ni+" "+vi+" "+iu,itemName:"TableCellVerticalAlign",items:tv,element:r}))},n.prototype.renderDisplayDropDown=function(n,i,r,u){var f=r;(r=t.select("#"+this.parent.getID()+"_"+n+("display"===u?"_Display":"videolayoutoption"===u?"_VideoLayoutOption":"_AudioLayoutOption"),i)).classList.contains(yt)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"display"===u?"e-display e-icons":"videolayoutoption"===u?"e-video-display e-icons":"e-audio-display e-icons",cssClass:ni+" "+vi+" "+iu,itemName:"display"===u?"Display":"videolayoutoption"===u?"VideoLayoutOption":"AudioLayoutOption",items:"display"===u?ba:"videolayoutoption"===u?da:ka,element:r,activeElement:f}))},n.prototype.renderAlignmentDropDown=function(n,i,r,u){var f=r;(r=t.select("#"+this.parent.getID()+"_"+n+("align"===u?"_Align":"_VideoAlign"),i)).classList.contains(yt)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:ni+" "+fa+" "+iu,itemName:"align"===u?"Align":"VideoAlign",items:"align"===u?tot:iot,element:r,activeElement:f}))},n.prototype.tableStylesDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_Styles",i)).classList.contains(yt)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:ni+" "+fa+" "+iu,itemName:"Styles",items:this.parent.tableSettings.styles,element:r}))},n.prototype.removeDropDownClasses=function(n){t.removeClass([n],[yt,ni,fa,vi])},n.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy(),this.formatDropDown=null);this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy(),this.fontNameDropDown=null);this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy(),this.fontSizeDropDown=null);this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy(),this.alignDropDown=null);this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy(),this.imageAlignDropDown=null);this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy(),this.displayDropDown=null);this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy(),this.tableRowsDropDown=null);this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy(),this.tableColumnsDropDown=null);this.tableCellDropDown&&(this.removeDropDownClasses(this.tableCellDropDown.element),this.tableCellDropDown.destroy(),this.tableCellDropDown=null);this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy(),this.tableCellVerticalAlignDropDown=null);this.numberFormatListDropDown&&(this.removeDropDownClasses(this.numberFormatListDropDown.element),this.numberFormatListDropDown.destroy(),this.numberFormatListDropDown=null);this.bulletFormatListDropDown&&(this.removeDropDownClasses(this.bulletFormatListDropDown.element),this.bulletFormatListDropDown.destroy(),this.bulletFormatListDropDown=null);this.codeBlockSplitButton&&(this.removeDropDownClasses(this.codeBlockSplitButton.element),this.codeBlockSplitButton.destroy(),this.codeBlockSplitButton=null);this.tableBorderStyleDropDown&&(this.removeDropDownClasses(this.tableBorderStyleDropDown.element),this.tableBorderStyleDropDown.destroy(),this.tableBorderStyleDropDown=null);this.toolbarRenderer=null},n.prototype.showDropDown=function(n){t.isNullOrUndefined(this.numberFormatListDropDown)||"NumberFormatList"!==n.toolbarClick?t.isNullOrUndefined(this.bulletFormatListDropDown)||"BulletFormaList"!==n.toolbarClick?t.isNullOrUndefined(this.codeBlockSplitButton)||"CodeBlock"!==n.toolbarClick||this.codeBlockSplitButton.toggle():this.bulletFormatListDropDown.toggle():this.numberFormatListDropDown.toggle()},n.prototype.setRtl=function(n){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:n.enableRtl});this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:n.enableRtl});this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:n.enableRtl});this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:n.enableRtl});this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:n.enableRtl});this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:n.enableRtl});this.numberFormatListDropDown&&this.numberFormatListDropDown.setProperties({enableRtl:n.enableRtl});this.bulletFormatListDropDown&&this.bulletFormatListDropDown.setProperties({enableRtl:n.enableRtl});this.tableBorderStyleDropDown&&this.tableBorderStyleDropDown.setProperties({enableRtl:n.enableRtl})},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){for(var i=[this.formatDropDown,this.fontNameDropDown,this.fontSizeDropDown,this.alignDropDown,this.imageAlignDropDown,this.displayDropDown,this.numberFormatListDropDown,this.bulletFormatListDropDown,this.tableRowsDropDown,this.tableColumnsDropDown,this.tableCellDropDown,this.tableCellVerticalAlignDropDown,this.tableBorderStyleDropDown],t=0;t<i.length;t++)this.updateCss(i[t],n)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(tc,this.beforeRender,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(ur,this.setRtl,this),this.parent.on(k,this.onPropertyChanged,this),this.parent.on(w,this.setCssClass,this),this.parent.on(hs,this.showDropDown,this))},n.prototype.onIframeMouseDown=function(){var n=this.parent.getToolbarElement(),i,r,u;t.isNullOrUndefined(n)||(i=n.querySelectorAll('.e-dropdown-btn[aria-expanded="true"]'),(i&&i.length>0&&this.closeOpenDropdowns(),n.querySelector(".e-rte-dropdown.e-dropdown-btn.e-active"))&&(r=n.querySelector(".e-rte-dropdown.e-dropdown-btn.e-active"),u=r.classList.contains("e-rte-font-colorpicker"),(u||r.classList.contains("e-rte-background-colorpicker"))&&this.parent.notify(ss,{toolbarClick:u?"fontcolor":"backgroundcolor"})))},n.prototype.closeOpenDropdowns=function(){[this.formatDropDown,this.fontNameDropDown,this.fontSizeDropDown,this.alignDropDown,this.imageAlignDropDown,this.displayDropDown,this.numberFormatListDropDown,this.bulletFormatListDropDown,this.tableRowsDropDown,this.tableColumnsDropDown,this.tableCellDropDown,this.tableCellVerticalAlignDropDown,this.tableBorderStyleDropDown].forEach(function(n){n&&n.dropDown&&n.dropDown.element&&n.dropDown.element.classList.contains("e-popup-open")&&n.toggle()})},n.prototype.removeEventListener=function(){this.parent.off(ut,this.onIframeMouseDown);this.parent.off(ur,this.setRtl);this.parent.off(tc,this.beforeRender);this.parent.off(k,this.onPropertyChanged);this.parent.off(w,this.setCssClass);this.parent.off(hs,this.showDropDown)},n.prototype.destroy=function(){this.removeEventListener();this.destroyDropDowns()},n}(),uut=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ph,this.toolbarClick,this);this.parent.on(ci,this.dropDownSelect,this);this.parent.on(pf,this.renderSelection,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.toolbarClick=function(n){var r,i;(this.parent.userAgentData.isSafari()&&this.parent.formatter.editorManager.nodeSelection&&!this.parent.inputElement.contains(this.parent.getRange().startContainer)&&this.parent.notify(lt,{}),t.isNullOrUndefined(n.item))||(t.isNullOrUndefined(n.item.controlParent)||(r=n.item.controlParent.activeEle,r&&(r.tabIndex=-1)),("NumberFormatList"===n.item.command||"BulletFormatList"===n.item.command)&&(i="SPAN"===n.originalEvent.target.nodeName?n.originalEvent.target.closest(".e-rte-dropdown.e-split-btn"):n.originalEvent.target,i&&(i.classList.contains("e-rte-numberformatlist-dropdown")||i.classList.contains("e-rte-bulletformatlist-dropdown"))&&(n.item.command="Lists",n.item.subCommand="NumberFormatList"===n.item.subCommand?"OL":"UL")),"Lists"===n.item.command&&((n.originalEvent.target.classList.contains("e-rte-numberformatlist-dropdown")||n.originalEvent.target.classList.contains("e-rte-bulletformatlist-dropdown"))&&n.originalEvent.target.classList.contains("e-dropdown-btn")||n.originalEvent.target.classList.contains("e-caret"))||("HorizontalLine"===n.item.subCommand&&(n.item.value="<hr/>"),this.parent.notify(wh,n),this.parent.notify(bh,n)))},n.prototype.dropDownSelect=function(n){var t,i,r;(this.parent.notify(lt,{}),document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&n.item&&("Images"===n.item.command||"Audios"===n.item.command||"Videos"===n.item.command||"VideoLayoutOption"===n.item.command||"Display"===n.item.command||"Table"===n.item.command))||(t=n.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(n.item.controlParent.element)?"Table":null,"Lists"===n.item.command||"Checklist"===n.item.command?(i={listStyle:n.item.value,listImage:n.item.listImage,type:n.item.subCommand},this.parent.formatter.process(this.parent,n,n.originalEvent,i)):"CodeBlock"===n.item.command?(r={language:n.item.text,label:n.item.label,action:"createCodeBlock"},this.parent.formatter.process(this.parent,n,n.originalEvent,r)):this.parent.formatter.process(this.parent,n,n.originalEvent,t));this.parent.notify(ft,{})},n.prototype.renderSelection=function(n){this.parent.notify(lt,{});this.parent.formatter.process(this.parent,n,n.originalEvent,null);this.parent.notify(ft,{})},n.prototype.removeEventListener=function(){this.parent.off(ph,this.toolbarClick);this.parent.off(ci,this.dropDownSelect);this.parent.off(pf,this.renderSelection);this.parent.off(u,this.removeEventListener)},n}(),oct=function(){function n(n,i){var r;this.tools={};this.parent=n;this.isDestroyed=!1;this.isToolbar=!1;this.locator=i;this.isTransformChild=!1;this.renderFactory=this.locator.getService("rendererFactory");r=this.parent;ds.forEach(function(n,t){ds[t].text=ar(r,not,ds[t])});ba.forEach(function(n,t){ba[t].text=ar(r,rot,ba[t])});ka.forEach(function(n,t){ka[t].text=ar(r,uot,ka[t])});da.forEach(function(n,t){da[t].text=ar(r,fot,da[t])});ga.forEach(function(n,t){ga[t].text=ar(r,oot,ga[t])});nv.forEach(function(n,t){nv[t].text=ar(r,sot,nv[t])});tv.forEach(function(n,t){tv[t].text=ar(r,hot,tv[t])});ya.forEach(function(n,t){ya[t].text=ar(r,cot,ya[t])});ks.forEach(function(n,t){ks[t].text=ar(r,get,ks[t])});tk(this.parent);this.baseToolbar=new bp(this.parent,this.locator);this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,ae,fv(this.parent.toolbarSettings.itemConfigs),!0):this.tools=ae}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.editableElement=this.contentRenderer.getEditPanel();this.editPanel=this.contentRenderer.getPanel()},n.prototype.toolbarBindEvent=function(){!this.parent.inlineMode.enable&&this.getToolbarElement()&&(this.keyBoardModule=new t.KeyboardEvents(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},n.prototype.toolBarKeyDown=function(n){var r,i,u,f;switch(n.action){case"escape":this.parent.contentModule.getEditPanel().focus();break;case"enter":if((r=n.target,!t.isNullOrUndefined(r))&&(i="BUTTON"===r.nodeName?r.closest(".e-split-btn-wrapper.e-rte-dropdown"):r,i)){if(u=i.querySelector(".e-rte-font-colorpicker"),u||i.querySelector(".e-rte-background-colorpicker"))return void this.parent.notify(ss,{toolbarClick:u?"fontcolor":"backgroundcolor"});if(f=i.querySelector(".e-rte-numberformatlist-dropdown"),f||i.querySelector(".e-rte-bulletformatlist-dropdown"))return void this.parent.notify(hs,{toolbarClick:f?"NumberFormatList":"BulletFormaList"});if(i.querySelector(".e-rte-codeblock-dropdown"))return void this.parent.notify(hs,{toolbarClick:"CodeBlock"})}}},n.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"});!t.Browser.isDevice&&this.parent.inlineMode.enable&&s()||(this.parent.inlineMode.enable?this.parent.iframeSettings.enable?this.parent.rootContainer.prepend(this.tbElement):this.parent.rootContainer.insertBefore(this.tbElement,this.editPanel):(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:ea}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.iframeSettings.enable?this.parent.rootContainer.prepend(this.tbWrapper):this.parent.rootContainer.insertBefore(this.tbWrapper,this.editPanel)))},n.prototype.getToolbarMode=function(){var n;switch(this.parent.toolbarSettings.type){case wt.Expand:n="Extended";break;case wt.Scrollable:n="Scrollable";break;case wt.Popup:n="Popup";break;default:n="MultiRow"}return s()&&this.parent.toolbarSettings.type===wt.Expand&&(n=wt.Scrollable),n},n.prototype.checkToolbarResponsive=function(n){return!(!t.Browser.isDevice||s()||(i=this.parent.toolbarSettings.type===wt.Expand?wt.MultiRow:this.parent.toolbarSettings.type,this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:i,target:n,cssClass:this.parent.getCssClass()}),this.parent.toolbarSettings.type===wt.Expand&&(t.addClass([n],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():t.addClass([n],[hg])),this.wireEvents(),this.dropDownModule.renderDropDowns({container:n,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.renderColorPicker({container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),0));var i},n.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var i=t.selectAll('[style*="transform"]',document),n=0;n<i.length;n++)if(!t.isNullOrUndefined(i[n].contains)&&i[n].contains(this.parent.element)){this.isTransformChild=!0;break}},n.prototype.toggleFloatClass=function(){var n=this.parent.floatingToolbarOffset;this.parent.toolbarSettings.enableFloating?(t.addClass([this.tbElement.parentElement],[as]),t.setStyleAttribute(this.tbElement.parentElement,{top:n+"px"})):(t.removeClass([this.tbElement.parentElement],[as]),t.setStyleAttribute(this.tbElement.parentElement,{top:""}))},n.prototype.renderToolbar=function(){this.initializeInstance();this.createToolbarElement();this.checkToolbarResponsive(this.tbElement)||(this.parent.inlineMode.enable?this.parent.notify(bc,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement,cssClass:this.parent.getCssClass()}),this.parent.element.classList.contains("e-rte-full-screen")&&this.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),t.addClass([this.parent.element],[pb]),this.parent.toolbarSettings.type===wt.Expand&&t.addClass([this.parent.element],[dw]))),this.wireEvents(),this.parent.inlineMode.enable&&!s()&&this.addFixedTBarClass(),this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.renderColorPicker({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow()),this.parent.rootContainer&&this.parent.rootContainer.classList.contains("e-source-code-enabled")&&(this.parent.notify(lf,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items)))},n.prototype.addFixedTBarClass=function(){t.addClass([this.tbElement],[kw])},n.prototype.removeFixedTBarClass=function(){t.removeClass([this.tbElement],[kw])},n.prototype.showFixedTBar=function(){t.addClass([this.tbElement],[tb]);t.Browser.isIos&&t.addClass([this.tbElement],[ob])},n.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:t.removeClass([this.tbElement],[tb,ob])},n.prototype.updateItem=function(n){var r=this.tools[n.updateItem.toLocaleLowerCase()],i,u;this.parent.enabled&&("Code View"!==ve(n.updateItem.toLocaleLowerCase(),this.locator)&&"Preview"!==ve(n.updateItem.toLocaleLowerCase(),this.locator)||"en-US"!==this.parent.locale)&&(r.tooltip=ve(n.updateItem.toLocaleLowerCase(),this.locator));i=pe(ye(this.tools[n.targetItem.toLocaleLowerCase()].subCommand),n.baseToolbar.toolbarObj.items)[0];t.isNullOrUndefined(i)?this.addTBarItem(n,0):(u=this.parent.inlineMode.enable?"_quick_":"_toolbar_",n.baseToolbar.toolbarObj.items[i].id=this.parent.getID()+u+r.id,n.baseToolbar.toolbarObj.items[i].prefixIcon=r.icon,n.baseToolbar.toolbarObj.items[i].tooltipText=r.tooltip,n.baseToolbar.toolbarObj.items[i].subCommand=r.subCommand,n.baseToolbar.toolbarObj.dataBind(),n.baseToolbar.toolbarObj.refreshOverflow())},n.prototype.updateToolbarStatus=function(n){this.tbElement&&(!this.parent.inlineMode.enable||!s()&&t.Browser.isDevice)&&uv({args:n,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:t.selectAll("."+or,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items},this.parent.inlineMode.enable,this.parent)},n.prototype.fullScreen=function(n){this.parent.fullScreenModule.showFullScreen(n)},n.prototype.hideScreen=function(n){this.parent.fullScreenModule.hideFullScreen(n)},n.prototype.getBaseToolbar=function(){return this.baseToolbar},n.prototype.addTBarItem=function(n,t){n.baseToolbar.toolbarObj.addItems([n.baseToolbar.getObject(n.updateItem,"toolbar")],t)},n.prototype.enableTBarItems=function(n,i,r,u){var s,f,h,e,o;for("Popup"===this.parent.toolbarSettings.type&&"string"!=typeof i?(s=i.filter(function(n){return"|"!==n}),h=n.toolbarObj.items.filter(function(n){return"Separator"!==n.type}),f=pe(ye(s),h),this.tbItems=t.selectAll("."+or+":not(.e-separator)",n.toolbarObj.element)):(f=pe(ye(i),n.toolbarObj.items),this.tbItems=t.selectAll("."+or,n.toolbarObj.element)),e=0;e<f.length;e++)o=this.tbItems[f[e]],o&&n.toolbarObj.enableItems(o,r);t.select("."+fu,this.parent.element)||u||bu(n,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},n.prototype.removeTBarItems=function(n){var r,i;for(t.isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject()),r=pe(ye(n),this.baseToolbar.toolbarObj.items),this.tbItems=this.parent.inlineMode.enable?t.selectAll("."+or,this.baseToolbar.toolbarObj.element):t.selectAll("."+or,this.parent.element),i=0;i<r.length;i++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[r[i]])},n.prototype.getExpandTBarPopHeight=function(){var i=0,n;return this.parent.toolbarSettings.type===wt.Expand&&this.tbElement.classList.contains("e-extended-toolbar")&&(n=t.select(".e-toolbar-extended",this.tbElement),n&&this.tbElement.classList.contains("e-expand-open")||n&&n.classList.contains("e-popup-open")?(t.addClass([n],[ib]),i+=n.offsetHeight,t.removeClass([n],[ib])):t.removeClass([this.tbElement],[ca])),i},n.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},n.prototype.getToolbarElement=function(){return this.parent&&this.parent.element?t.select("."+ue,this.parent.element):null},n.prototype.refreshToolbarOverflow=function(){this.parent.element.classList.remove(tu);this.baseToolbar.toolbarObj.refreshOverflow();this.parent.enableRtl&&this.parent.element.classList.add(tu)},n.prototype.isToolbarDestroyed=function(){return!!(this.baseToolbar&&this.baseToolbar.toolbarObj&&this.baseToolbar.toolbarObj.isDestroyed)},n.prototype.destroyToolbar=function(){if(!this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents();this.unWireEvents();this.dropDownModule.destroy();this.parent.emojiPickerModule&&!this.parent.emojiPickerModule.isPopupDestroyed&&this.parent.emojiPickerModule.childDestroy();this.dropDownModule=null;this.colorPickerModule.destroy();this.colorPickerModule=null;this.keyBoardModule&&(this.keyBoardModule.destroy(),this.keyBoardModule=null);this.baseToolbar.destroy();this.removeEventListener();t.removeClass([this.parent.element],[pb]);t.removeClass([this.parent.element],[dw]);var n=t.select("."+ea,this.parent.element),i=t.select("."+ue,this.parent.element);t.isNullOrUndefined(n)||t.detach(n);t.isNullOrUndefined(i)||t.detach(i)}},n.prototype.destroy=function(){this.isDestroyed||(this.isToolbarDestroyed()||this.destroyToolbar(),this.toolbarObj=null,this.editPanel=null,this.isToolbar=null,this.editableElement=null,this.tbItems=null,this.baseToolbar=null,this.tbElement=null,this.tbWrapper=null,this.isTransformChild=null,this.contentRenderer=null,this.dropDownModule=null,this.colorPickerModule=null,this.toolbarActionModule=null,this.tools=null,this.locator=null,this.renderFactory=null,this.isDestroyed=!0)},n.prototype.mouseDownHandler=function(){t.Browser.isDevice&&this.parent.inlineMode.enable&&!s()&&this.showFixedTBar()},n.prototype.focusChangeHandler=function(){t.Browser.isDevice&&this.parent.inlineMode.enable&&!s()&&(this.isToolbar=!1,this.hideFixedTBar())},n.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},n.prototype.tbFocusHandler=function(){var r=document.activeElement,u=t.closest(r,".e-rte-toolbar"),i,n;if(r===this.parent.getToolbarElement()||u===this.parent.getToolbarElement())for(i=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),n=0;n<i.length;n++)t.isNullOrUndefined(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?i[n].setAttribute("tabindex","0"):i[n].setAttribute("tabindex","1")},n.prototype.wireEvents=function(){this.parent.inlineMode.enable&&s()||t.EventHandler.add(this.tbElement,"focusin",this.tbFocusHandler,this)},n.prototype.unWireEvents=function(){t.EventHandler.remove(this.tbElement,"focusin",this.tbFocusHandler)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new kp(this.parent,this.locator),this.toolbarActionModule=new uut(this.parent),this.colorPickerModule=new lh(this.parent,this.locator),this.parent.on(a,this.renderToolbar,this),this.parent.on(b,this.toolbarBindEvent,this),this.parent.on(di,this.updateToolbarStatus,this),this.parent.on(k,this.onPropertyChanged,this),this.parent.on(uo,this.onRefresh,this),this.parent.on(u,this.destroy,this),this.parent.on(eo,this.fullScreen,this),this.parent.on(oo,this.hideScreen,this),this.parent.on(lf,this.updateItem,this),this.parent.on(pc,this.dropDownBeforeOpenHandler,this),this.parent.on(wf,this.focusChangeHandler,this),this.parent.on(at,this.mouseDownHandler,this),this.parent.on(yf,this.mouseDownHandler,this),this.parent.on(w,this.setCssClass,this))},n.prototype.removeEventListener=function(){this.parent.off(a,this.renderToolbar);this.parent.off(b,this.toolbarBindEvent);this.parent.off(di,this.updateToolbarStatus);this.parent.off(k,this.onPropertyChanged);this.parent.off(uo,this.onRefresh);this.parent.off(u,this.destroy);this.parent.off(eo,this.parent.fullScreenModule.showFullScreen);this.parent.off(oo,this.parent.fullScreenModule.hideFullScreen);this.parent.off(lf,this.updateItem);this.parent.off(pc,this.dropDownBeforeOpenHandler);this.parent.off(wf,this.focusChangeHandler);this.parent.off(at,this.mouseDownHandler);this.parent.off(yf,this.mouseDownHandler);this.parent.off(w,this.setCssClass)},n.prototype.setCssClass=function(n){this.toolbarObj&&n.cssClass&&(t.isNullOrUndefined(n.oldCssClass)?this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass+" "+n.cssClass).trim()}):this.toolbarObj.setProperties({cssClass:(this.toolbarObj.cssClass.replace(n.oldCssClass,"").trim()+" "+n.cssClass).trim()}))},n.prototype.onRefresh=function(){this.parent.inlineMode.enable||this.refreshToolbarOverflow();this.parent.autoResize()},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.inlineMode))for(var i=0,r=Object.keys(n.newProp.inlineMode);i<r.length;i++)"enable"===r[i]&&this.refreshToolbar();t.isNullOrUndefined(n.newProp.toolbarSettings)||t.isNullOrUndefined(n.newProp.toolbarSettings.enableFloating)||this.toggleFloatClass();n.module===this.getModuleName()&&this.refreshToolbar()},n.prototype.refreshToolbar=function(){t.isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var n=t.select("."+ea,this.parent.element);(t.select("."+ue,this.parent.element)||n)&&this.destroyToolbar();this.parent.toolbarSettings.enable&&(this.baseToolbar&&this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed&&this.baseToolbar.destroy(),this.baseToolbar=new bp(this.parent,this.locator),this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),t.select("."+fu,this.parent.element)||this.parent.inlineMode.enable||bu(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()),this.parent.notify(er,{}))},n.prototype.getModuleName=function(){return"toolbar"},n.prototype.renderColorPicker=function(n){this.colorPickerModule.renderColorPickerInput(n)},n}(),fut=function(){function n(n,t,i){this.previousToolbarStatus={};this.parent=t;this.locator=i;this.isRendered=!1;this.isDestroyed=!1;this.type=n;this.dropDownButtons=new kp(this.parent,this.locator);this.colorPickerObj=new lh(this.parent,this.locator);this.popupWidth=null;this.popupHeight=null;this.tipPointerHeight=this.parent.userAgentData.isMobileDevice()?16:10}return n.prototype.appendToolbarElement=function(){switch(this.toolbarElement=this.parent.createElement("div",{className:vs}),this.type){case"Image":this.toolbarElement.classList.add(ug);break;case"Link":this.toolbarElement.classList.add(sg);break;case"Table":this.toolbarElement.classList.add(og);break;case"Audio":this.toolbarElement.classList.add(fg);break;case"Video":this.toolbarElement.classList.add(eg);break;case"Text":this.toolbarElement.classList.add(rg);break;case"Inline":this.toolbarElement.classList.add(ue);this.toolbarElement.classList.add(ee)}this.popupObj.element.appendChild(this.toolbarElement)},n.prototype.render=function(n){this.stringItems=n.toolbarItems;var t=new rut(this.parent);this.popupObj=t.renderPopup(n.popupType);this.element=this.popupObj.element;this.tipPointerElem=this.element.querySelector(".e-rte-tip-pointer");this.appendToolbarElement();this.createToolbar(n.toolbarItems,n.mode,n.cssClass);this.addEventListener();this.addCSSClass()},n.prototype.createToolbar=function(n,t,i){this.quickTBarObj=new bp(this.parent,this.locator);this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:n,mode:t,cssClass:i})},n.prototype.showPopup=function(n,i){var u=this,f=this.parent.formatter.editorManager.nodeSelection.get(this.parent.inputElement.ownerDocument),e,l,v,h;if(!(t.isNullOrUndefined(f)&&f.rangeCount<0)&&(this.renderSubComponents(n),e=this.getRelativeElement(f,n),null!==e)){this.parent.iframeSettings.enable&&(l=this.parent.contentModule.getPanel().getBoundingClientRect());var c=f.getRangeAt(0),o=c.getClientRects(),a=this.getSelectionDirection(f),s=t.isNullOrUndefined(i)?"none":i.type;"mouseup"===s&&i.detail&&3===i.detail&&(s="trippleclick");v=0===o.length?c.getBoundingClientRect():"Backward"===a?o[0]:o[o.length-1];h={blockElement:e,blockRect:e.getBoundingClientRect(),range:c,rangeRect:v,iframeRect:l,contentPanelElement:this.parent.contentModule.getPanel(),editPanelDomRect:this.parent.contentModule.getEditPanel().getBoundingClientRect(),direction:a,type:s};this.popupWidth=this.getPopupDimension(this.popupObj,"width");this.popupHeight=this.getPopupDimension(this.popupObj,"height");this.toolbarHeight=this.parent.getToolbarElement().getBoundingClientRect().height;var y=this.calculateOffsetX(h),p=this.calculateOffsetY(h),r={popup:this.popupObj,cancel:!1,targetElement:e,type:s,positionX:y,positionY:p};this.enableDisableToolbarItems();r=this.handleVerticalCollision(h,r);this.setTipPointerPostion(this.currentTipPosition);"Audio"!==this.type&&"Image"!==this.type&&"Video"!==this.type||("Bottom-Center"===this.currentTipPosition||"Bottom-Left"===this.currentTipPosition||"Bottom-Right"===this.currentTipPosition?r.positionY=r.positionY-2:"Top-Center"!==this.currentTipPosition&&"Top-Left"!==this.currentTipPosition&&"Top-Right"!==this.currentTipPosition||(r.positionY=r.positionY+2));this.parent.trigger(pd,r,function(i){if(!i.cancel){var r={offsetX:i.positionX,offsetY:i.positionY,relateTo:i.targetElement};u.popupObj.setProperties(r);u.popupObj.dataBind();t.removeClass([u.element],[pu,wu]);u.popupObj.show();u.isRendered=!0;u.previousTarget=n}})}},n.prototype.renderSubComponents=function(n){if(t.addClass([this.element],[pu]),this.parent.iframeSettings.enable?t.append([this.element],this.parent.rootContainer.querySelector("."+bw)):t.append([this.element],this.parent.contentModule.getPanel()),this.dropDownButtons.renderDropDowns({container:this.toolbarElement,containerType:"quick",items:this.stringItems},n),"Text"===this.type&&this.dropDownButtons){if(this.dropDownButtons.formatDropDown){var i='<span style="display: inline-flex;width:'+this.parent.format.width+'" ><span class="e-rte-dropdown-btn-text><\/span><\/span>';this.dropDownButtons.formatDropDown.setProperties({content:i});this.dropDownButtons.formatDropDown.dataBind()}this.dropDownButtons.fontSizeDropDown&&(i='<span style="display: inline-flex;width:'+this.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text><\/span><\/span>',this.dropDownButtons.fontSizeDropDown.setProperties({content:i}),this.dropDownButtons.fontSizeDropDown.dataBind());this.dropDownButtons.fontNameDropDown&&(i='<span style="display: inline-flex;width:'+this.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text><\/span><\/span>',this.dropDownButtons.fontNameDropDown.setProperties({content:i}),this.dropDownButtons.fontNameDropDown.dataBind())}this.colorPickerObj.renderColorPickerInput({container:this.toolbarElement,containerType:"quick",items:this.stringItems});this.parent.showTooltip&&(this.tooltip=new wi.Tooltip({target:"#"+this.element.id+" [title]",openDelay:400,showTipPointer:!0,beforeRender:this.tooltipBeforeRender.bind(this),windowCollision:!0,position:"BottomCenter",cssClass:this.parent.getCssClass()}),this.tooltip.appendTo(this.toolbarElement));"75%"!==this.element.style.maxWidth&&t.setStyleAttribute(this.element,{maxWidth:"75%"})},n.prototype.tooltipBeforeRender=function(n){n.target.querySelector(".e-active")&&(n.cancel=!0,t.isNullOrUndefined(n.target.getAttribute("title"))||this.parent.notify(cs,{target:n.target,isTitle:!0}))},n.prototype.hidePopup=function(){var u=!t.isNullOrUndefined(this.parent.rootContainer)&&this.parent.rootContainer.classList.contains("e-source-code-enabled"),n,f,i,r;(t.Browser.isDevice&&!s()&&t.removeClass([this.parent.getToolbar()],[pu]),t.isNullOrUndefined(this.element.querySelectorAll("[data-title]"))||this.element.querySelectorAll("[data-title]").forEach(function(n){var t=new MouseEvent("mouseout",{bubbles:!0,cancelable:!0});n.dispatchEvent(t)}),t.isNullOrUndefined(document.querySelector(".e-tooltip-wrap")))?t.isNullOrUndefined(this.tooltip)||this.tooltip.destroy():(t.isNullOrUndefined(document.querySelector("#"+this.element.id+" [data-tooltip-id]"))||(n=document.querySelector("#"+this.element.id+" [data-tooltip-id]"),f=n.getAttribute("data-content"),n.removeAttribute("data-content"),n.setAttribute("title",f),n.removeAttribute("data-tooltip-id")),t.isNullOrUndefined(this.tooltip)||this.tooltip.destroy());i=!1;t.isNullOrUndefined(this.parent.codeBlockModule)||(r=this.parent.getRange(),i=!t.isNullOrUndefined(this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(r.startContainer))||!t.isNullOrUndefined(this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(r.endContainer)));t.isNullOrUndefined(this.parent.getToolbar())||i||(this.parent.inlineMode.enable?u||this.parent.enableToolbarItem(this.parent.toolbarSettings.items):u||t.isNullOrUndefined(this.parent.toolbarModule.baseToolbar.toolbarObj)||this.parent.enableToolbarItem(this.parent.toolbarSettings.items));this.removeEleFromDOM();this.isRendered=!1},n.prototype.removeEleFromDOM=function(){var i=this.popupObj.element,n;this.isRendered&&(this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),t.detach(i),n=this.popupObj,this.parent.trigger(bd,n))},n.prototype.updateStatus=function(n){uv({args:n,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:t.selectAll("."+or,this.element),tbItems:this.quickTBarObj.toolbarObj.items},0,this.parent);"Text"===this.type&&this.parent.quickToolbarSettings.text&&this.parent.quickToolbarSettings.text.length>0&&this.parent.quickToolbarModule.textQTBar&&(uv({args:n,dropDownModule:this.parent.quickToolbarModule.textQTBar.dropDownButtons,parent:this.parent,tbElements:t.selectAll("."+or,this.parent.quickToolbarModule.textQTBar.element),tbItems:this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj.items},0,this.parent),bu(this.parent.quickToolbarModule.textQTBar.quickTBarObj,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()));t.select("."+fu,this.parent.element)||bu(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus());this.previousToolbarStatus=n},n.prototype.destroy=function(){this.isDestroyed||(this.tooltip&&!this.tooltip.isDestroyed&&(this.tooltip.destroy(),this.tooltip=null),this.removeEventListener(),this.quickTBarObj.destroy(),this.quickTBarObj=null,this.popupObj&&!this.popupObj.isDestroyed&&(this.removeEleFromDOM(),this.popupObj.destroy()),this.colorPickerObj=null,this.dropDownButtons=null,this.stringItems=null,this.dropDownButtons=null,this.colorPickerObj=null,this.toolbarElement=null,this.popupWidth=null,this.popupHeight=null,this.tipPointerElem=null,this.previousTarget=null,this.isDestroyed=!0)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(u,this.destroy,this),this.parent.on(k,this.onPropertyChanged,this),(this.parent.inlineMode.enable||"Text"===this.type&&this.parent.quickToolbarSettings.text&&this.parent.quickToolbarSettings.text.length>0)&&this.parent.on(di,this.updateStatus,this),this.parent.on(w,this.addCSSClass,this))},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.inlineMode))for(var i=0,r=Object.keys(n.newProp.inlineMode);i<r.length;i++)"enable"===r[i]&&(n.newProp.inlineMode.enable?this.parent.on(di,this.updateStatus,this):this.parent.off(di,this.updateStatus))},n.prototype.removeEventListener=function(){this.parent.off(u,this.destroy);this.parent.off(k,this.onPropertyChanged);(this.parent.inlineMode.enable||"Text"===this.type&&this.parent.quickToolbarSettings.text&&this.parent.quickToolbarSettings.text.length>0)&&this.parent.off(di,this.updateStatus);this.parent.off(w,this.addCSSClass)},n.prototype.getPopupDimension=function(n,t){var i=n.element,r;return i.classList.remove(cb),r="width"===t?i.clientWidth:i.clientHeight,i.classList.add(cb),r},n.prototype.getRelativeElement=function(n,i){var r,u=n.focusNode;switch(this.type){case"Inline":case"Text":"TD"!==(r=this.parent.formatter.editorManager.domTree.isBlockNode(u)?u:this.parent.formatter.editorManager.domTree.getParentBlockNode(u)).nodeName&&"TH"!==r.nodeName||(r=t.closest(i,"table"));break;case"Link":r=3===u.nodeType?u.parentElement:u;r=t.closest(r,"a");break;case"Image":case"Audio":case"Video":r=i;break;case"Table":r=t.closest(i,"table")}return r},n.prototype.calculateOffsetX=function(n){var r,t=this.popupWidth,u,i,f,e;switch(this.type){case"Text":case"Inline":u="Backward"===n.direction?n.rangeRect.left:n.rangeRect.right;i=!1===this.parent.iframeSettings.enable?u-n.blockRect.left:u;i<t/4?(r=i-16.5,this.currentTipPosition="Top-Left"):i>t/4&&i<t/2?(r=i-t/4,this.currentTipPosition="Top-LeftMiddle"):i>t/2&&i<3*t/4?(r=i-t/2,this.currentTipPosition="Top-Center"):i>3*t/4&&i<t?(r=i-3*t/4,this.currentTipPosition="Top-RightMiddle"):(r=i-t+16.5,this.currentTipPosition="Top-Right");break;case"Link":case"Image":case"Audio":case"Video":case"Table":f=n.blockRect.left-n.editPanelDomRect.left;e=n.editPanelDomRect.right-n.blockRect.right;n.blockRect.width>t||f>t/2&&e>t/2?(r=n.blockRect.width/2-t/2,this.currentTipPosition="Link"===this.type?"Top-Center":"Bottom-Center"):e<t/2?(r=-(t-n.blockRect.width),this.currentTipPosition="Link"===this.type?"Top-Right":"Bottom-Right"):f<t/2&&(r=0,this.currentTipPosition="Link"===this.type?"Top-Left":"Bottom-Left");this.parent.iframeSettings.enable&&(r+=n.blockRect.left)}return r},n.prototype.calculateOffsetY=function(n){var t;switch(this.type){case"Text":case"Inline":case"Link":t=this.parent.iframeSettings.enable?n.rangeRect.bottom+this.tipPointerHeight:n.rangeRect.bottom-n.blockRect.top+this.tipPointerHeight;break;case"Image":case"Audio":case"Video":case"Table":t=this.parent.iframeSettings.enable?-100:-(this.popupHeight+this.tipPointerHeight)}return t},n.prototype.setTipPointerPostion=function(n){if(this.tipPointerElem.className="",this.tipPointerElem.classList.add(nb),"None"!==n){var t=n.split("-"),i=t[0],r=t[1];this.tipPointerElem.classList.add("e-rte-tip-"+i.toLowerCase());this.tipPointerElem.classList.add("e-rte-tip-"+r.toLowerCase())}},n.prototype.getSelectionDirection=function(n){if(n&&n.rangeCount>0&&n.getRangeAt(0).collapsed)return"Forward";var t=new Range;return t.setStart(n.anchorNode,n.anchorOffset),t.setEnd(n.focusNode,n.focusOffset),t.collapsed?"Backward":"Forward"},n.prototype.addCSSClass=function(){this.popupObj&&this.parent.cssClass&&(t.removeClass([this.popupObj.element],this.parent.cssClass.replace(/\s+/g," ").trim().split(" ")),t.addClass([this.popupObj.element],this.parent.cssClass.replace(/\s+/g," ").trim().split(" ")))},n.prototype.enableDisableToolbarItems=function(){"Audio"!==this.type&&"Image"!==this.type&&"Video"!==this.type||(this.parent.disableToolbarItem(this.parent.toolbarSettings.items),this.parent.enableToolbarItem(["Undo","Redo"]))},n.prototype.handleVerticalCollision=function(n,t){return this.parent.iframeSettings.enable?(t="Audio"===this.type||"Image"===this.type||"Table"===this.type||"Video"===this.type?this.handleIFrameMediaCollision(n,t):this.handleIFrameTextVerticalCollision(n,t)).targetElement=this.parent.contentModule.getPanel().parentElement:t="Audio"===this.type||"Image"===this.type||"Table"===this.type||"Video"===this.type?this.handleMediaVerticalCollision(n,t):this.handleTextVerticalCollision(n,t),t},n.prototype.handleMediaVerticalCollision=function(n,t){var r,u,o=this.parent.scrollParentElements&&this.parent.scrollParentElements.length>0&&"#document"!==this.parent.scrollParentElements[0].nodeName?this.parent.scrollParentElements[0]:this.parent.inputElement,s=o.getBoundingClientRect(),i=n.blockRect,f=this.parent.getToolbarElement().getBoundingClientRect(),w="Bottom"===this.parent.toolbarSettings.position,h=this.parent.toolbarSettings.enableFloating,b=h&&"Top"===this.parent.toolbarSettings.position,k=h&&"Bottom"===this.parent.toolbarSettings.position,l=n.editPanelDomRect,a=this.getSpaceAbove(n,b,f,s),v=this.getSpaceBelow(n,k,f,s),e=this.tipPointerHeight+this.popupHeight,d=this.isElemVisible(i,"top",!1)&&a>e,g=this.isElemVisible(i,"bottom",!1)&&v>e,y,c,p;return d?(r="top",u="flip",this.currentTipPosition=this.currentTipPosition.replace("Top","Bottom"),t.positionY=-(this.popupHeight+this.tipPointerHeight)):g?(r="bottom",u="flip",this.currentTipPosition=this.currentTipPosition.replace("Bottom","Top"),t.positionY=this.tipPointerHeight):a<e&&v<e&&(r="top",u="fit",y=-i.top+f.bottom,c=o===this.parent.inputElement?-i.top:-i.top+l.top,t.positionY=w?c:h?f.top<0?-i.top:y:o===this.parent.inputElement?c:l.top<0?-i.top:-(i.top-s.top),this.currentTipPosition="None"),p={position:{Y:r,X:this.popupObj.position.X},collision:{Y:u,X:this.popupObj.collision.X}},this.popupObj.setProperties(p),this.popupObj.dataBind(),t},n.prototype.isElemVisible=function(n,t,i,r){if(i){var u=r.top+n.top,f=r.top+n.bottom;return"top"===t?u>=0&&u<=window.innerHeight:f<=window.innerHeight&&f>=0}return"top"===t?n.top>=0&&n.top<=window.innerHeight:n.bottom<=window.innerHeight&&n.bottom>=0},n.prototype.handleIFrameMediaCollision=function(n,t){var h=this.parent.scrollParentElements&&this.parent.scrollParentElements.length>0&&"#document"!==this.parent.scrollParentElements[0].nodeName?this.parent.scrollParentElements[0]:this.parent.inputElement,u=h.getBoundingClientRect(),f=this.parent.toolbarSettings.enableFloating,e=this.parent.getToolbarElement().getBoundingClientRect(),a=this.parent.getToolbarElement().getBoundingClientRect(),v="Bottom"===this.parent.toolbarSettings.position,r=n.blockRect,y=f&&"Top"===this.parent.toolbarSettings.position,p=f&&"Bottom"===this.parent.toolbarSettings.position,c=this.getIFrameSpaceAbove(n,y,e,u),l=this.getIFrameSpaceBelow(n,p,e,u),i=this.tipPointerHeight+this.popupHeight,o,s;return this.isElemVisible(r,"top",!0,n.iframeRect)&&c>i?(t.positionY=r.top-i,this.currentTipPosition=this.currentTipPosition.replace("Top","Bottom")):this.isElemVisible(r,"bottom",!0,n.iframeRect)&&l>i?(t.positionY=r.bottom+this.tipPointerHeight,this.currentTipPosition=this.currentTipPosition.replace("Bottom","Top")):c<i&&l<i&&(o=-n.iframeRect.top+e.bottom,s=h===this.parent.inputElement?-n.iframeRect.top:-n.iframeRect.top+u.top,v?t.positionY=s:f?t.positionY=a.top<0?-n.iframeRect.top:o:(this.parent.inputElement,t.positionY=n.iframeRect.top<0?s:o),this.currentTipPosition="None"),t},n.prototype.getSpaceAbove=function(n,t,i,r){var u,f=n.blockRect,e=n.editPanelDomRect,o=this.getTopCollisionType(f,e,t?i:r);if(t)switch(o){case"ParentElement":case"ScrollableContainer":u=f.top-i.top-i.height;break;case"ViewPort":case"Hidden":u=f.top}else switch(o){case"ParentElement":u=f.top-e.top;break;case"ScrollableContainer":u=r.top-e.top;break;case"ViewPort":case"Hidden":u=f.top}return u},n.prototype.getSpaceBelow=function(n,t,i,r){var u,f=n.blockRect,e=n.editPanelDomRect,o=this.getBottomCollisionType(f,e,t?i:r),s;if(t)switch(o){case"Hidden":case"ParentElement":case"ScrollableContainer":u=e.bottom-f.bottom-i.height;break;case"ViewPort":u=f.bottom}else switch(o){case"Hidden":case"ParentElement":u=e.bottom-f.bottom;break;case"ScrollableContainer":u=r.bottom-f.bottom;break;case"ViewPort":u=window.innerHeight-f.bottom}return s=t?this.toolbarHeight:0,window.innerHeight-f.bottom-s<this.popupHeight+this.tipPointerHeight&&(u=0),u},n.prototype.handleTextVerticalCollision=function(n,t){var u=(this.parent.scrollParentElements&&this.parent.scrollParentElements.length>0&&"#document"!==this.parent.scrollParentElements[0].nodeName?this.parent.scrollParentElements[0]:this.parent.inputElement).getBoundingClientRect(),i=n.blockRect,f=this.parent.getToolbarElement().getBoundingClientRect(),e=this.parent.toolbarSettings.enableFloating,s=e&&"Top"===this.parent.toolbarSettings.position,h=e&&"Bottom"===this.parent.toolbarSettings.position,c=i.top,l=i.bottom,a=this.getSpaceAbove(n,s,f,u),v=this.getSpaceBelow(n,h,f,u),r=this.tipPointerHeight+this.popupHeight,o=this.isElemVisible(i,"top",!1)&&a>r&&c>r;return"Backward"===n.direction&&o||!(this.isElemVisible(i,"bottom",!1)&&v>r&&l>r)?(o&&(t.positionY=-(this.popupHeight+10)+(n.rangeRect.top-n.blockRect.top),this.currentTipPosition=this.currentTipPosition.replace("Top","Bottom")),t):t},n.prototype.handleIFrameTextVerticalCollision=function(n,t){var r=(this.parent.scrollParentElements&&this.parent.scrollParentElements.length>0&&"#document"!==this.parent.scrollParentElements[0].nodeName?this.parent.scrollParentElements[0]:this.parent.inputElement).getBoundingClientRect(),u=this.parent.toolbarSettings.enableFloating,f=this.parent.getToolbarElement().getBoundingClientRect(),s=u&&"Top"===this.parent.toolbarSettings.position,h=u&&"Bottom"===this.parent.toolbarSettings.position,c=this.getIFrameSpaceAbove(n,s,f,r),l=this.getIFrameSpaceBelow(n,h,f,r),e=n.blockRect,i=this.tipPointerHeight+this.popupHeight,o=this.isElemVisible(e,"top",!0,n.iframeRect)&&c>i;return"Backward"===n.direction&&o||!(this.isElemVisible(e,"bottom",!0,n.iframeRect)&&l>i)?(o&&(t.positionY=n.rangeRect.top-i,this.currentTipPosition=this.currentTipPosition.replace("Top","Bottom")),t):t},n.prototype.getPreviousStatus=function(){return this.previousToolbarStatus},n.prototype.getTopCollisionType=function(n,t,i){return n.top<0||n.top>=window.innerHeight?"Hidden":t.top>0?"ParentElement":i.top<0?"ViewPort":i.top>0?"ScrollableContainer":"ParentElement"},n.prototype.getBottomCollisionType=function(n,t,i){return n.bottom<0||n.bottom>=window.innerHeight?"Hidden":i.bottom>=window.innerHeight&&t.bottom>=window.innerHeight?"ViewPort":t.bottom<=i.bottom?"ParentElement":"ScrollableContainer"},n.prototype.getIFrameSpaceAbove=function(n,t,i,r){var u,f=n.blockRect,o=n.editPanelDomRect,e;if(n.editPanelDomRect.top===r.top&&n.editPanelDomRect.bottom==n.editPanelDomRect.bottom&&(r=n.editPanelDomRect),e=this.getIFrameTopCollisionType(f,o,t?i:r,n.iframeRect),t)switch(e){case"ParentElement":case"ScrollableContainer":u=n.iframeRect.top+f.top-i.top-i.height;break;case"ViewPort":case"Hidden":u=n.iframeRect.top+f.top-i.height}else switch(e){case"ScrollableContainer":u=n.iframeRect.top+n.blockRect.top>r.top?n.iframeRect.top+n.blockRect.top-r.top:-(r.top-(n.iframeRect.top+n.blockRect.top));break;case"ParentElement":u=n.iframeRect.top+f.top-(n.iframeRect.top+n.editPanelDomRect.top);break;case"ViewPort":case"Hidden":u=i.top<0?n.iframeRect.top+f.top:n.iframeRect.top+f.top-i.bottom}return u},n.prototype.getIFrameSpaceBelow=function(n,t,i,r){var f,u=n.blockRect,h=n.editPanelDomRect,s=n.editPanelDomRect.top===r.top&&n.editPanelDomRect.bottom==n.editPanelDomRect.bottom,e;if(s&&(r=n.iframeRect),e=this.getIFrameBottomCollisionType(u,h,t?i:r,n.iframeRect),t)switch(e){case"Hidden":case"ParentElement":case"ScrollableContainer":f=n.iframeRect.bottom-(n.iframeRect.top+u.bottom);break;case"ViewPort":f=window.innerHeight-(n.iframeRect.top+u.bottom)}else switch(e){case"Hidden":case"ParentElement":case"ScrollableContainer":f=s||"ParentElement"!==e?r.bottom-(n.iframeRect.top+u.bottom):n.iframeRect.bottom-(n.iframeRect.top+u.bottom);break;case"ViewPort":f=window.innerHeight-(n.iframeRect.top+u.bottom)}var o=n.iframeRect.top+u.bottom,c=this.popupHeight+this.tipPointerHeight,l=o>window.innerHeight,a=o>n.iframeRect.bottom&&o+c>r.bottom;return(l||a)&&(f=0),f},n.prototype.getIFrameTopCollisionType=function(n,t,i,r){return r.top+n.top<0||r.top+n.top>=window.innerHeight?"Hidden":r.top+t.top>0?"ParentElement":i.top<=0?"ViewPort":i.top>0?"ScrollableContainer":"ParentElement"},n.prototype.getIFrameBottomCollisionType=function(n,t,i,r){return r.top+n.bottom<0||r.top+n.bottom>=window.innerHeight||r.top+n.bottom>=r.bottom||r.top+n.bottom>=i.bottom?"Hidden":i.bottom>=window.innerHeight&&r.top+t.bottom>=window.innerHeight?"ViewPort":r.top+t.bottom<=i.bottom?"ParentElement":"ScrollableContainer"},n}(),sct=function(){function n(n,t){this.debounceTimeout=1e3;this.escapeKeyPressed=!1;this.parent=n;this.locator=t;this.addEventListener();this.isDestroyed=!1}return n.prototype.formatItems=function(n){var t=[];return n.forEach(function(n){if("string"==typeof n)switch(n.toLocaleLowerCase()){case"open":t.push("openLink");break;case"edit":t.push("editLink");break;case"unlink":t.push("removeLink");break;default:t.push(n)}else t.push(n)}),t},n.prototype.getQTBarOptions=function(n,t,i,r){return{popupType:n,toolbarItems:i,mode:t,renderType:r,cssClass:this.parent.getCssClass()}},n.prototype.createQTBar=function(n,t,i,r){if(i.length<1)return null;var u=new fut(n,this.parent,this.locator);return u.render(this.getQTBarOptions(n,t,this.formatItems(i),r)),u},n.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this;this.contentRenderer=this.parent.contentModule;this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&s()&&t.EventHandler.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},n.prototype.onMouseDown=function(){this.parent.isBlur=!1;this.parent.isRTE=!0},n.prototype.keyUpQT=function(n){27===n.which&&this.hideQuickToolbars()},n.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.audioQTBar||this.videoQTBar||this.textQTBar||this.tableQTBar||(this.parent.quickToolbarSettings.link&&this.parent.quickToolbarSettings.link.length>0&&(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,o.LinkToolbar)),t.isNullOrUndefined(this.parent.quickToolbarSettings.text)||this.parent.inlineMode.enable||(this.textQTBar=this.createQTBar("Text","MultiRow",this.parent.quickToolbarSettings.text,o.TextToolbar)),this.parent.quickToolbarSettings.image&&this.parent.quickToolbarSettings.image.length>0&&(this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,o.ImageToolbar)),this.parent.quickToolbarSettings.audio&&this.parent.quickToolbarSettings.audio.length>0&&(this.audioQTBar=this.createQTBar("Audio","MultiRow",this.parent.quickToolbarSettings.audio,o.AudioToolbar)),this.parent.quickToolbarSettings.video&&this.parent.quickToolbarSettings.video.length>0&&(this.videoQTBar=this.createQTBar("Video","MultiRow",this.parent.quickToolbarSettings.video,o.VideoToolbar)),this.parent.quickToolbarSettings.table&&this.parent.quickToolbarSettings.table.length>0&&(this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,o.TableToolbar)),this.linkQTBar&&(t.EventHandler.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.linkQTBar.element,"keyup",this.keyUpQT,this)),this.imageQTBar&&(t.EventHandler.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.imageQTBar.element,"keyup",this.keyUpQT,this)),this.audioQTBar&&(t.EventHandler.add(this.audioQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.audioQTBar.element,"keyup",this.keyUpQT,this)),this.videoQTBar&&(t.EventHandler.add(this.videoQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.videoQTBar.element,"keyup",this.keyUpQT,this)),this.textQTBar&&(t.EventHandler.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.textQTBar.element,"keyup",this.keyUpQT,this)),this.tableQTBar&&(t.EventHandler.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.tableQTBar.element,"keyup",this.keyUpQT,this)))},n.prototype.renderInlineQuickToolbar=function(){this.parent.inlineMode.enable&&(!t.Browser.isDevice||s())&&(t.addClass([this.parent.element],[ua]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,o.InlineToolbar),t.EventHandler.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.inlineQTBar.element,"keyup",this.keyUpQT,this))},n.prototype.showInlineQTBar=function(n,i,r,u){"HTML"!==r.nodeName&&"#document"!==r.nodeName||(r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).commonAncestorContainer.parentElement);t.isNullOrUndefined(this.parent)||this.parent.readonly||"img"===r.tagName.toLowerCase()||this.inlineQTBar.element.querySelector(".e-rte-color-content")||this.inlineQTBar.showPopup(r,u)},n.prototype.hideInlineQTBar=function(){this.inlineQTBar&&this.inlineQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.inlineQTBar.element)&&this.inlineQTBar.hidePopup();this.escapeKeyPressed=!1},n.prototype.hideQuickToolbars=function(){this.linkQTBar&&this.linkQTBar.element&&this.linkQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup();!this.escapeKeyPressed&&this.textQTBar&&this.textQTBar.element&&this.textQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup();!this.escapeKeyPressed&&this.imageQTBar&&this.imageQTBar.element&&this.imageQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup();!this.escapeKeyPressed&&this.audioQTBar&&this.audioQTBar.element&&this.audioQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.audioQTBar.element)&&this.audioQTBar.hidePopup();!this.escapeKeyPressed&&this.videoQTBar&&this.videoQTBar.element&&this.videoQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.videoQTBar.element)&&this.videoQTBar.hidePopup();!this.escapeKeyPressed&&this.tableQTBar&&this.tableQTBar.element&&this.tableQTBar.element.classList.contains("e-popup-open")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup();t.isNullOrUndefined(this.parent)||!this.parent.inlineMode.enable||t.Browser.isDevice&&!s()||this.hideInlineQTBar();this.escapeKeyPressed=!1},n.prototype.deBounce=function(n,t,i,r){var u=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){u.showInlineQTBar(n,t,i,r)},this.debounceTimeout)},n.prototype.mouseUpHandler=function(n){var f,o,h,e;if(this.parent.inlineMode.enable&&(!t.Browser.isDevice||s())){var u=n.args.touches?n.args.changedTouches[0]:n.args,r=this.parent.getRange(),i=n.args.target;if(t.isNullOrUndefined(t.select("."+ee,document.body))){if(s()&&n.touchData&&n.touchData.prevClientX!==n.touchData.clientX&&n.touchData.prevClientY!==n.touchData.clientY)return;if(this.hideInlineQTBar(),f=this.parent.element.getBoundingClientRect().left,this.offsetX=this.parent.iframeSettings.enable?window.pageXOffset+f+u.clientX:u.pageX,this.offsetY=bb(u,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===i.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,i,n.args);else if(i=t.closest(i,"a")||i,o=this.parent.getRange().startContainer.parentElement,h=this.parent.getRange().endContainer.parentElement,(t.isNullOrUndefined(t.closest(o,"A"))||t.isNullOrUndefined(t.closest(h,"A")))&&(!t.closest(i,"td,th")||!r.collapsed)&&("IMG"!==i.tagName||this.parent.getRange().startOffset!==this.parent.getRange().endOffset)){if(e=r.startOffset===r.endOffset&&r.startContainer===r.endContainer,this.parent.inlineMode.onSelection&&e||!this.parent.inlineMode.onSelection&&!e)return;this.target=i;this.showInlineQTBar(this.offsetX,this.offsetY,i,n.args)}}}if(!t.isNullOrUndefined(this.textQTBar)&&!t.isNullOrUndefined(this.parent.quickToolbarSettings.text)&&!this.parent.inlineMode.enable){if(!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.name)&&"sourceCodeMouseDown"===n.name)return;if(u=n.args.touches?n.args.changedTouches[0]:n.args,i=n.args.target,this.hideQuickToolbars(),f=this.parent.element.getBoundingClientRect().left,this.offsetX=this.parent.iframeSettings.enable?this.parent.element.ownerDocument.documentElement.scrollLeft+f+u.clientX:u.pageX,this.offsetY=bb(u,this.parent.element,this.parent.iframeSettings.enable),(r=this.parent.getRange()).endContainer.parentElement.tagName===r.startContainer.parentElement.tagName&&"A"===r.startContainer.parentElement.tagName&&"A"===r.endContainer.parentElement.tagName||"IMG"===i.tagName||"VIDEO"===i.tagName||this.isEmbedVidElem(i)||"AUDIO"===i.tagName||i.childNodes[0]&&1===i.childNodes[0].nodeType&&i.childNodes[0].classList.contains("e-rte-audio")||this.parent.getRange().startOffset===this.parent.getRange().endOffset||this.hasResizeElement(this.parent.inputElement))return;this.target=i;this.textQTBar.showPopup(i,u)}},n.prototype.hasResizeElement=function(n){return!(!n||!n.querySelector(".e-img-resize")&&!n.querySelector(".e-vid-resize"))},n.prototype.isEmbedVidElem=function(n){return!!(n&&3!==n.nodeType&&"BR"!==n.nodeName&&n.classList&&n.classList.contains(oe)||n&&"IFRAME"===n.nodeName)},n.prototype.keyDownHandler=function(n){var i=n.args.altKey;this.parent.inlineMode.enable&&n.args.metaKey&&65===n.args.keyCode?this.showInlineQTBar(this.offsetX,this.offsetY,n.args.target,n.args):i||(!this.parent.inlineMode.enable||t.Browser.isDevice&&!s()||t.isNullOrUndefined(t.select("."+ee,document))||this.hideInlineQTBar(),this.textQTBar&&!et(this.textQTBar.element,"e-popup-close")&&this.textQTBar.hidePopup())},n.prototype.inlineQTBarMouseDownHandler=function(){!this.parent.inlineMode.enable||t.Browser.isDevice&&!s()||t.isNullOrUndefined(t.select("."+ee,document))||this.hideInlineQTBar();t.isNullOrUndefined(this.parent.quickToolbarSettings.text)||this.textQTBar&&!et(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup()},n.prototype.keyUpHandler=function(n){var r=this,i=n.args;if(this.parent.inlineMode.enable&&!t.Browser.isDevice){if(this.parent.inlineMode.onSelection)return void(this.parent.getSelection().length>0&&(i.ctrlKey&&65===i.keyCode||i.shiftKey&&(33===i.keyCode||34===i.keyCode||35===i.keyCode||36===i.keyCode||37===i.keyCode||38===i.keyCode||39===i.keyCode||40===i.keyCode))&&(this.showInlineQTBarTimeOut&&(clearTimeout(this.showInlineQTBarTimeOut),this.showInlineQTBarTimeOut=null),this.parent.element&&this.parent.element.dataset&&"true"===this.parent.element.dataset.rteUnitTesting?this.showInlineQTBar(this.offsetX,this.offsetY,n.args.target,n.args):this.showInlineQTBarTimeOut=window.setTimeout(function(){r.showInlineQTBar(r.offsetX,r.offsetY,n.args.target,n.args)},600)));this.deBounce(this.offsetX,this.offsetY,i.target,n.args)}this.parent.quickToolbarSettings.text&&!t.Browser.isDevice&&(i.ctrlKey&&65===i.keyCode||i.shiftKey&&(33===i.keyCode||34===i.keyCode||35===i.keyCode||36===i.keyCode||37===i.keyCode||38===i.keyCode||39===i.keyCode||40===i.keyCode))&&this.textQTBar.showPopup(i.target,i)},n.prototype.selectionChangeHandler=function(n){var t=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){t.onSelectionChange(n)},this.debounceTimeout)},n.prototype.onSelectionChange=function(n){t.isNullOrUndefined(t.select("."+ee,document.body))&&(this.contentRenderer.getDocument().getSelection().isCollapsed||this.mouseUpHandler({args:n}))},n.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},n.prototype.destroy=function(){this.isDestroyed||(this.linkQTBar&&!this.linkQTBar.isDestroyed&&(t.EventHandler.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.linkQTBar.element,"keyup",this.keyUpQT),this.linkQTBar.destroy()),this.textQTBar&&!this.textQTBar.isDestroyed&&(t.EventHandler.remove(this.textQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.textQTBar.element,"keyup",this.keyUpQT),this.textQTBar.destroy()),this.imageQTBar&&!this.imageQTBar.isDestroyed&&(t.EventHandler.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.imageQTBar.element,"keyup",this.keyUpQT),this.imageQTBar.destroy()),this.audioQTBar&&!this.audioQTBar.isDestroyed&&(t.EventHandler.remove(this.audioQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.audioQTBar.element,"keyup",this.keyUpQT),this.audioQTBar.destroy()),this.videoQTBar&&!this.videoQTBar.isDestroyed&&(t.EventHandler.remove(this.videoQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.videoQTBar.element,"keyup",this.keyUpQT),this.videoQTBar.destroy()),this.tableQTBar&&!this.tableQTBar.isDestroyed&&(t.EventHandler.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.tableQTBar.element,"keyup",this.keyUpQT),this.tableQTBar.destroy()),this.inlineQTBar&&!this.inlineQTBar.isDestroyed&&(t.EventHandler.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.inlineQTBar.element,"keyup",this.keyUpQT),s()&&t.EventHandler.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy()),this.removeEventListener(),this.isDestroyed=!0)},n.prototype.wireInlineQTBarEvents=function(){this.parent.on(nc,this.mouseUpHandler,this);this.parent.on(at,this.inlineQTBarMouseDownHandler,this);this.parent.on(y,this.keyDownHandler,this);this.parent.on(tt,this.keyUpHandler,this);this.parent.on(yf,this.mouseUpHandler,this);this.parent.on(bc,this.renderInlineQuickToolbar,this)},n.prototype.unWireInlineQTBarEvents=function(){this.parent.off(nc,this.mouseUpHandler);this.parent.off(at,this.inlineQTBarMouseDownHandler);this.parent.off(y,this.keyDownHandler);this.parent.off(tt,this.keyUpHandler);this.parent.off(yf,this.mouseUpHandler);this.parent.off(bc,this.renderInlineQuickToolbar)},n.prototype.toolbarUpdated=function(){this.linkQTBar&&!et(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup();this.escapeKeyPressed||!this.imageQTBar||et(this.imageQTBar.element,"e-popup-close")||this.imageQTBar.hidePopup();this.escapeKeyPressed||!this.audioQTBar||et(this.audioQTBar.element,"e-popup-close")||this.audioQTBar.hidePopup();this.escapeKeyPressed||!this.videoQTBar||et(this.videoQTBar.element,"e-popup-close")||this.videoQTBar.hidePopup();this.escapeKeyPressed||!this.tableQTBar||et(this.tableQTBar.element,"e-popup-close")||this.tableQTBar.hidePopup();this.escapeKeyPressed=!1},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(a,this.initializeQuickToolbars,this),this.parent.on(at,this.renderQuickToolbars,this),this.parent.on(di,this.toolbarUpdated,this),this.parent.on(te,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(k,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll?(this.parent.on(li,this.hideQuickToolbars,this),this.parent.on(ai,this.hideQuickToolbars,this)):(this.parent.on(li,this.onScroll,this),this.parent.on(ai,this.onScroll,this)),this.parent.on(wf,this.hideQuickToolbars,this),this.parent.on(ut,this.onIframeMouseDown,this),this.parent.on(u,this.destroy,this),this.parent.on(y,this.onKeyDown,this),this.parent.on(ur,this.setRtl,this),this.parent.on(w,this.setCssClass,this),this.parent.on(os,this.hideQuickToolbars,this),this.parent.on(ko,this.renderQuickToolbars,this),this.parent.on(ia,this.preventQuickToolbarClose,this),this.parent.on(dr,this.onWindowResize,this),this.parent.on(yu,this.mouseUpHandler,this))},n.prototype.preventQuickToolbarClose=function(n){var i=this.parent.getID(),r=[i+"_quick_Display-popup",i+"_quick_Align-popup",i+"_quick_VideoLayoutOption-popup",i+"_quick_VideoAlign-popup",i+"_quick_TableRows-popup",i+"_quick_TableColumns-popup",i+"_quick_TableCell-popup",i+"_quick_TableCellVerticalAlign-popup",i+"_quick_Styles-popup",i+"_quick_Alignments-popup",i+"_quick_BackgroundColor-popup",i+"_quick_AudioLayoutOption-popup",i+"_quick_FontSize-popup",i+"_quick_FontName-popup",i+"_quick_FontColor-popup",i+"_quick_BackgroundColor-popup",i+"_quick_Formats-popup",i+"_quick_Alignments-popup",i+"_quick_NumberFormatList-popup",i+"_quick_BulletFormatList-popup"];!t.isNullOrUndefined(n.element)&&!t.isNullOrUndefined(n.element.parentElement)&&r.indexOf(n.element.parentElement.id)>-1&&(this.escapeKeyPressed=!0)},n.prototype.onKeyDown=function(n){var t=n.args;8!==t.which&&46!==t.which||(this.imageQTBar&&!et(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup(),this.audioQTBar&&!et(this.audioQTBar.element,"e-popup-close")&&this.audioQTBar.hidePopup(),this.videoQTBar&&!et(this.videoQTBar.element,"e-popup-close")&&this.videoQTBar.hidePopup(),this.tableQTBar&&!et(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup(),this.linkQTBar&&!et(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup(),this.textQTBar&&!et(this.textQTBar.element,"e-popup-close")&&this.textQTBar.hidePopup())},n.prototype.onIframeMouseDown=function(){this.hideQuickToolbars();this.hideInlineQTBar()},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass&&n.quickTBarObj.toolbarObj.cssClass!==i.cssClass)?n.quickTBarObj.toolbarObj.setProperties({cssClass:(n.quickTBarObj.toolbarObj.cssClass+" "+i.cssClass).trim()}):n.quickTBarObj.toolbarObj.setProperties({cssClass:(n.quickTBarObj.toolbarObj.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){for(var i=[this.inlineQTBar,this.imageQTBar,this.linkQTBar,this.textQTBar,this.tableQTBar],t=0;t<i.length;t++)this.updateCss(i[t],n)},n.prototype.setRtl=function(n){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.audioQTBar&&this.audioQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.videoQTBar&&this.videoQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.linkQTBar&&this.linkQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.textQTBar&&this.textQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.removeEventListener=function(){this.deBouncer&&(clearTimeout(this.deBouncer),this.deBouncer=null);this.parent.off(a,this.initializeQuickToolbars);this.parent.off(at,this.renderQuickToolbars);this.parent.off(di,this.toolbarUpdated);this.parent.off(te,this.renderQuickToolbars);this.unWireInlineQTBarEvents();this.parent.off(k,this.onPropertyChanged);"hide"===this.parent.quickToolbarSettings.actionOnScroll?(this.parent.off(li,this.hideQuickToolbars),this.parent.off(ai,this.hideQuickToolbars)):(this.parent.off(li,this.onScroll),this.parent.off(ai,this.onScroll));this.parent.off(wf,this.hideQuickToolbars);this.parent.off(u,this.destroy);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(y,this.onKeyDown);this.parent.off(ur,this.setRtl);this.parent.off(w,this.setCssClass);this.parent.off(os,this.hideQuickToolbars);this.parent.off(ko,this.renderQuickToolbars);this.parent.off(ia,this.preventQuickToolbarClose);this.parent.off(dr,this.onWindowResize);this.parent.off(yu,this.mouseUpHandler)},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.quickToolbarSettings))for(var i=0,r=Object.keys(n.newProp.quickToolbarSettings);i<r.length;i++)"actionOnScroll"===r[i]&&("none"===n.newProp.quickToolbarSettings.actionOnScroll?(this.parent.on(li,this.onScroll),this.parent.on(ai,this.onScroll),this.parent.off(li,this.hideQuickToolbars),this.parent.off(ai,this.hideQuickToolbars)):(this.parent.on(li,this.hideQuickToolbars,this),this.parent.on(ai,this.hideQuickToolbars,this),this.parent.off(li,this.onScroll),this.parent.off(ai,this.onScroll)));n.module===this.getModuleName()&&(this.inlineQTBar&&(t.removeClass([this.parent.element],[ua]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||t.Browser.isDevice&&!s()||(t.addClass([this.parent.element],[ua]),this.wireInlineQTBarEvents()))},n.prototype.getModuleName=function(){return"quickToolbar"},n.prototype.getQuickToolbarInstance=function(){return[this.linkQTBar,this.imageQTBar,this.audioQTBar,this.videoQTBar,this.tableQTBar,this.textQTBar,this.inlineQTBar]},n.prototype.onScroll=function(n){this.refreshQuickToolbarPopup(n)},n.prototype.refreshQuickToolbarPopup=function(n){for(var t,f,u,i=0,r=this.getQuickToolbarInstance();i<r.length;i++)t=r[i],t&&t.isRendered&&t.element&&t.element.classList.contains("e-popup-open")&&(t.hidePopup(),f=t.previousTarget,(t.showPopup(f,n),this.parent.quickToolbarSettings.text||this.parent.quickToolbarModule.inlineQTBar&&this.parent.quickToolbarModule.inlineQTBar.isRendered)&&(u=t.getPreviousStatus(),u&&t.updateStatus(u)))},n.prototype.onWindowResize=function(n){t.isNullOrUndefined(n.args)||this.refreshQuickToolbarPopup(n.args)},n}(),hct=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.isDestroyed=!1}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);this.editPanel=this.contentRenderer.getEditPanel();this.addEventListener()},n.prototype.renderCount=function(){this.initializeInstance();this.element=this.parent.createElement("span",{className:eb});this.parent.rootContainer.appendChild(this.element);this.parent.rootContainer.classList.add("e-count-enabled");this.parent.iframeSettings.enable&&this.parent.inputElement.classList.add("e-count-enabled");this.appendCount();-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength)},n.prototype.appendCount=function(){var n="Markdown"===this.parent.editorMode?this.editPanel.value:this.parent.getText().replace(/(\r\n|\n|\r|\t)/gm,""),t;this.htmlLength="Markdown"!==this.parent.editorMode&&-1!==n.indexOf("​")?n.replace(/\u200B/g,"").length:n.length;t=-1===this.parent.maxLength?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength;this.element.innerHTML=t},n.prototype.charCountBackground=function(n){var t=n/this.parent.maxLength*100;t<85?(this.element.classList.remove(sa),this.element.classList.remove(ha)):t>85&&t<=90?(this.element.classList.remove(ha),this.element.classList.add(sa)):t>90&&(this.element.classList.remove(sa),this.element.classList.add(ha))},n.prototype.refresh=function(){t.isNullOrUndefined(this.editPanel)||(this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength))},n.prototype.destroy=function(){this.isDestroyed||(this.parent&&this.parent.rootContainer&&this.parent.rootContainer.classList.contains("e-count-enabled")&&this.parent.rootContainer.classList.remove("e-count-enabled"),this.parent.iframeSettings.enable&&!t.isNullOrUndefined(this.parent.inputElement)&&this.parent.inputElement.classList.remove("e-count-enabled"),this.element&&!t.isNullOrUndefined(this.parent.element.querySelector("."+eb))&&t.detach(this.element),this.removeEventListener(),this.editPanel&&(this.editPanel=null),this.element&&(t.detach(this.element),this.element=null),this.isDestroyed=!0)},n.prototype.toggle=function(n){this.element.style.display="viewSource"===n.member?"none":"block"},n.prototype.addEventListener=function(){this.parent.on(a,this.renderCount,this);this.parent.on(tt,this.refresh,this);this.parent.on(wc,this.refresh,this);this.parent.on(uo,this.refresh,this);this.parent.on(at,this.refresh,this);this.parent.on(u,this.destroy,this);this.parent.on(lu,this.toggle,this);this.parent.on(vf,this.toggle,this)},n.prototype.removeEventListener=function(){this.parent.off(a,this.renderCount);this.parent.off(tt,this.refresh);this.parent.off(uo,this.refresh);this.parent.off(wc,this.refresh);this.parent.off(at,this.refresh);this.parent.off(u,this.destroy);this.parent.off(lu,this.toggle);this.parent.off(vf,this.toggle)},n.prototype.getModuleName=function(){return"count"},n}(),dp=function(){function n(){}return n.prototype.getLineNumber=function(n,t){return n.value.substr(0,t).split("\n").length},n.prototype.getSelectedText=function(n){var t=n.selectionStart,i=n.selectionEnd;return n.value.substring(t,i)},n.prototype.getAllParents=function(n){return n.split("\n")},n.prototype.getSelectedLine=function(n){return this.getAllParents(n.value)[this.getLineNumber(n,n.selectionStart)-1]},n.prototype.getLine=function(n,t){return this.getAllParents(n.value)[t]},n.prototype.getSelectedParentPoints=function(n){var o=this.getAllParents(n.value),h=this.getLineNumber(n,n.selectionStart),c=this.getLineNumber(n,n.selectionEnd),e=this.getSelectedText(n).split("\n"),t=[],s=o[h-1],l=o.slice(0,h-1).join("").length,i={},r,u,f;if(i.line=h-1,i.start=l+i.line,i.end=""!==s?i.start+s.length+1:i.start+s.length,i.text=s,t.push(i),e.length>1){for(r=1;r<e.length-1;r++)u={},u.line=t[r-1].line+1,u.start=(e[r],t[r-1].end),u.end=u.start+e[r].length+1,u.text=e[r],t.push(u);f={};f.line=t[t.length-1].line+1;f.start=t[t.length-1].end;f.end=f.start+o[c-1].length+1;f.text=o[c-1];t.push(f)}return t},n.prototype.setSelection=function(n,t,i){n.setSelectionRange(t,i);n.focus()},n.prototype.save=function(n,t){this.selectionStart=n;this.selectionEnd=t},n.prototype.restore=function(n){this.setSelection(n,this.selectionStart,this.selectionEnd)},n.prototype.isStartWith=function(n,t){var i=!1,r=RegExp;return n&&(i=(n.trim()===t.trim()?new r("^("+this.replaceSpecialChar(t.trim())+")","gim"):new r("^("+this.replaceSpecialChar(t)+")","gim")).test(n.trim())),i},n.prototype.replaceSpecialChar=function(n){return n.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/g,"\\$&")},n.prototype.isClear=function(n,t){for(var r=RegExp,i=0;i<n.length;i++)if(new r(t,"gim").test(n[i].text))return!0;return!1},n.prototype.getSelectedInlinePoints=function(n){return{start:n.selectionStart,end:n.selectionEnd,text:this.getSelectedText(n)}},n}(),eut=function(){function n(n){this.toolbarStatus=this.prevToolbarStatus={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,uppercase:!1,lowercase:!1,inlinecode:!1,unorderedlist:!1,formats:null};this.selection=new dp;this.parent=n;this.element=this.parent.contentModule.getEditPanel();this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(hi,this.onRefreshHandler,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(hi,this.onRefreshHandler);this.parent.off(u,this.removeEventListener)},n.prototype.onRefreshHandler=function(n){var i=this.selection.getSelectedParentPoints(this.element),t;this.toolbarStatus={orderedlist:!n.documentNode&&this.isListsApplied(i,"OL"),unorderedlist:!n.documentNode&&this.isListsApplied(i,"UL"),formats:this.currentFormat(i,n.documentNode),bold:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Bold"),italic:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Italic"),inlinecode:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode"),strikethrough:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("StrikeThrough"),subscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SubScript"),superscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SuperScript"),uppercase:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("UpperCase")};this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode")&&(this.toolbarStatus.formats="pre");t=JSON.stringify(this.toolbarStatus);this.parent.notify(di,this.toolbarStatus);JSON.stringify(this.prevToolbarStatus)!==t&&(this.parent.notify(ns,{html:null,markdown:JSON.parse(t)}),this.prevToolbarStatus=JSON.parse(t))},n.prototype.isListsApplied=function(n,t){var r=!0,i,u;if("OL"===t){for(i=0;i<n.length;i++)if(u=n[i].text.trim().split(" ",2)[0]+" ",!/^[\d.]+[ ]+$/.test(u)){r=!1;break}}else for(i=0;i<n.length;i++)if(!this.selection.isStartWith(n[i].text,this.parent.formatter.listTags[""+t])){r=!1;break}return r},n.prototype.currentFormat=function(n,t){for(var u="p",r=Object.keys(this.parent.formatter.formatTags),f="backward"===this.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(f,this.parent.formatter.formatTags[r[i]])){u=r[i];break}if("pre"===r[i]&&this.codeFormat()){u=r[i];break}}return u},n.prototype.codeFormat=function(){var e,o=!1,i=this.parent.inputElement,s=i.selectionStart,n=(e=s,function(n){return[n.slice(0,e),n.slice(e)]})(i.value),r=this.parent.formatter.formatTags.pre,u=this.getSelectedText(i),t,f;return""!==u&&u===u.toLocaleUpperCase()?!0:""===u&&(t=i.value.substr(n[0].length-1,1),f=n[1].substr(0,1),""!==t&&""!==f&&t.match(/[a-z]/i)&&t===t.toLocaleUpperCase()&&f===f.toLocaleUpperCase())?!0:(this.isCode(n[0],r)&&this.isCode(n[1],r)&&n[0].match(this.multiCharRegx(r)).length%2==1&&n[1].match(this.multiCharRegx(r)).length%2==1&&(o=!0),o)},n.prototype.getSelectedText=function(n){return n.value.substring(n.selectionStart,n.selectionEnd)},n.prototype.isCode=function(n,t){return-1!==n.search("\\"+t)},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n}(),ud=function(){function n(){}return n.prototype.process=function(n,i,r,u){var s,a,o=this,v=n.contentModule.getDocument().getSelection(),e=v.rangeCount>0?v.getRangeAt(v.rangeCount-1):null,y,h,p,f,w,c,b;if(t.isNullOrUndefined(u)||t.isNullOrUndefined(u.selection)||(a=u.selection.range),y=!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u.cssClass)&&"e-video-inline"!==u.cssClass,"HTML"===n.editorMode&&(t.isNullOrUndefined(i)||y||(t.isNullOrUndefined(i.name)||!t.isNullOrUndefined(i.name)&&"showDialog"!==i.name&&!t.isNullOrUndefined(i.item.command))&&(s=a?this.editorManager.nodeSelection.save(a,n.contentModule.getDocument()):this.editorManager.nodeSelection.save(e,n.contentModule.getDocument()))),t.isNullOrUndefined(i)||!i.item.command||"Table"===i.item.command||"Actions"===i.item.command||"Links"===i.item.command||"Images"===i.item.command||"Files"===i.item.command||"Audios"===i.item.command||"Videos"===i.item.command||"EmojiPicker"===i.item.command||"CodeBlock"===i.item.command||!e||n.contentModule.getEditPanel().contains(this.getAncestorNode(e.commonAncestorContainer))||n.contentModule.getEditPanel()===e.commonAncestorContainer||n.contentModule.getPanel()===e.commonAncestorContainer){if(!t.isNullOrUndefined(i)&&-1!==n.maxLength&&!t.isNullOrUndefined(i.item.command)&&(h=0,"Links"===i.item.command&&(h=0===u.text.length?u.url.length:u.text.length),"Images"!==i.item.command&&"Videos"!==i.item.command&&"Table"!==i.item.command&&"Files"!==i.item.command||(h=1),p=n.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length-n.getSelection().length+h,!(-1===n.maxLength||p<=n.maxLength)))return;t.isNullOrUndefined(i)?(f=r.action,i={},w={originalEvent:r,cancel:!1,requestType:f||r.key+"Key",itemCollection:u},(t.extend(i,i,w,!0),"tab"!==f&&"enter"!==f&&"space"!==f&&"escape"!==f)&&("Markdown"===n.editorMode&&"insert-table"===f&&(u={headingText:n.localeObj.getConstant("TableHeadingText"),colText:n.localeObj.getConstant("TableColText")}),c=e?e.commonAncestorContainer:null,("backspace"!==f&&"delete"!==f||c&&c.nodeType===Node.ELEMENT_NODE&&c.querySelectorAll("img, audio, video").length>0)&&n.trigger(l,i,function(n){n.cancel&&("paste"!==f&&"cut"!==f&&"copy"!==f||r.preventDefault())})),i.cancel||(b=!!t.isNullOrUndefined(n.tableModule)||!!n.tableModule&&n.tableModule.tableObj&&n.tableModule.tableObj.ensureInsideTableList,(9===r.which&&b||9!==r.which)&&(13===r.which&&"HTML"===n.editorMode&&(u={enterAction:n.enterKey}),this.editorManager.observer.notify("keydown"===r.type?we:yr,{event:r,callBack:this.onSuccess.bind(this,n),value:u,enterAction:n.enterKey,enableTabKey:n.enableTabKey})))):!t.isNullOrUndefined(i)&&i.item.command&&i.item.subCommand&&(i.item.command!==i.item.subCommand&&"Font"!==i.item.command&&"Export"!==i.item.command&&"TableBackgroundColor"!==i.item.subCommand&&"BorderColor"!==i.item.subCommand||("FontName"===i.item.subCommand||"FontSize"===i.item.subCommand)&&"dropDownSelect"===i.name||("BackgroundColor"===i.item.subCommand||"FontColor"===i.item.subCommand)&&("colorPickerChanged"===i.name||"tableColorPickerChanged"===i.name)||"FormatPainter"===i.item.subCommand||"EmojiPicker"===i.item.subCommand||"CodeBlock"===i.item.subCommand||"Checklist"===i.item.subCommand)&&(t.extend(i,i,{requestType:i.item.subCommand,cancel:!1,itemCollection:u,selectType:i.name},!0),n.trigger(l,i,function(f){var h,c,l,e;f.cancel||(h=!t.isNullOrUndefined(f.requestType)&&"FormatPainter"===f.requestType&&"format-copy"===f.name,c=!t.isNullOrUndefined(f.requestType)&&"FormatPainter"===f.requestType&&"format-paste"===f.name,(0===o.getUndoRedoStack().length&&"Links"!==f.item.command&&"Images"!==f.item.command&&!h||c)&&o.saveData(),n.isBlur=!1,l=!(t.isNullOrUndefined(r)||t.isNullOrUndefined(r.target)||t.isNullOrUndefined(t.closest(r.target,".e-rte-elements.e-dropdown-popup.e-rte-dropdown-popup.e-quick-dropdown.e-popup-open"))&&t.isNullOrUndefined(t.closest(r.target,".e-rte-elements.e-rte-quick-popup.e-popup-open"))),(t.isNullOrUndefined(s)||!l&&(t.isNullOrUndefined(t.closest(s.range.startContainer.parentElement,".e-img-caption"))||"false"!==t.closest(s.range.startContainer.parentElement,".e-img-caption").getAttribute("contenteditable"))&&-1===t.Browser.userAgent.indexOf("Firefox"))&&n.contentModule.getEditPanel().focus({preventScroll:!0}),"HTML"!==n.editorMode||y||(t.isNullOrUndefined(i.selectType)||!t.isNullOrUndefined(i.selectType)&&"showDialog"!==i.selectType)&&s.restore(),e=f.item.subCommand.toLocaleLowerCase(),"image"!==e&&"file"!==e&&"replace"!==e||(u=f.itemCollection),"paste"===e||"cut"===e||"copy"===e?n.clipboardAction(e,r):(o.editorManager.observer.notify(gf,{subCommand:f.item.subCommand}),o.editorManager.execCommand(f.item.command,f.item.subCommand,r,o.onSuccess.bind(o,n),f.item.value,"Pre"===f.item.subCommand&&"dropDownSelect"===f.selectType?{name:f.selectType}:u,"#"+n.getID()+" iframe",n.enterKey)))}));(t.isNullOrUndefined(r)||r&&"copy"!==r.action)&&(!r||!r.shiftKey||"Tab"!==r.key)&&this.enableUndo(n)}},n.prototype.getAncestorNode=function(n){return 3===n.nodeType?n.parentNode:n},n.prototype.onKeyHandler=function(n,t){var i=this;this.editorManager.observer.notify(yr,{event:t,callBack:function(){n.notify(cf,{});i.enableUndo(n)},enterAction:n.enterKey})},n.prototype.onSuccess=function(n,i){var e=this;n.notify(cf,{});i&&(t.isNullOrUndefined(i.event)||"copy"!==i.event.action)&&("Paste"===i.requestType?(n.notify(so,i),this.enableUndo(n)):(this.enableUndo(n),n.notify(so,i)));var r=n.contentModule.getDocument().getSelection(),u=r.rangeCount>0?r.getRangeAt(r.rangeCount-1):null,f=u?u.commonAncestorContainer:null;"delete"!==i.requestType||u&&f.nodeType===Node.ELEMENT_NODE&&f.querySelectorAll("img, audio, video").length>0?n.trigger(ct,i,function(t){e.actionCompleteCallBack(n,t)}):this.actionCompleteCallBack(n,i)},n.prototype.actionCompleteCallBack=function(n,t){if(n.setPlaceHolder(),("Images"===t.requestType||"Replace"===t.requestType||"Links"===t.requestType||"Audios"===t.requestType||"Videos"===t.requestType)&&"HTML"===n.editorMode){var i=t;if("Links"===t.requestType&&t.event&&"keydown"===t.event.type&&32===t.event.keyCode)return;n.notify(ii,{args:i.event,type:t.requestType,isNotify:!0,elements:i.elements})}"VideosPlayPause"===t.requestType&&n.notify("editAreaClick",{args:event});n.autoResize()},n.prototype.saveData=function(n){this.editorManager.undoRedoManager.saveData(n)},n.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},n.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},n.prototype.enableUndo=function(n){var i=this.getUndoStatus();!n.inlineMode.enable||t.Browser.isDevice&&!s()?n.toolbarModule&&n.toolbarModule.baseToolbar&&bu(n.toolbarModule.baseToolbar,i):bu(n.quickToolbarModule.inlineQTBar.quickTBarObj,i)},n.prototype.beforeSlashMenuApply=function(){this.editorManager.beforeSlashMenuApplyFormat()},n.prototype.getCurrentStackIndex=function(){return this.editorManager.undoRedoManager.getCurrentStackIndex()},n.prototype.clearUndoRedoStack=function(){this.editorManager.undoRedoManager.clear()},n}(),gp="lists-commands",ah="command-type",nw="link-commands",tw="clear-commands",iw="insert-table",rw="insert-text",out=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(gp,this.applyListsHandler,this);this.parent.observer.on(c,this.keyDownHandler,this);this.parent.observer.on(ei,this.keyUpHandler,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(gp,this.applyListsHandler);this.parent.observer.off(c,this.keyDownHandler);this.parent.observer.off(ei,this.keyUpHandler);this.parent.observer.off(f,this.destroy)},n.prototype.keyDownHandler=function(n){switch(9===n.event.which&&this.tabKey(n),n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault()}},n.prototype.keyUpHandler=function(n){13===n.event.which&&this.enterKey(n)},n.prototype.tabKey=function(n){var r=this.parent.element,y,k,i,h,f,w,u;this.selection.save(r.selectionStart,r.selectionEnd);var e=r.selectionStart,o=r.selectionEnd,t=this.selection.getSelectedParentPoints(r),v=0,b=this.isNotFirstLine(r,t[0]);if(b||n.event.shiftKey){for(y=this.olListType(),k=this.getListRegex(),this.currentAction=this.getAction(t[0].text),i=0;i<t.length;i++)if(h=(n.event.shiftKey,t[i].line-1),f=this.selection.getLine(r,h),f&&(!n.event.shiftKey&&b||n.event.shiftKey)){var d=f.split(". "),c=n.event.shiftKey?-1:1,s=t[i].text.split("\t");if(n.event.shiftKey&&1===s.length)break;if("OL"===this.currentAction&&/^\d+$/.test(d[0].trim())&&y){n.event.preventDefault();t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text;var l=this.getTabSpace(t[i].text),a=this.getTabSpace(f),p=t[i].text.split(". ");if(l===a)this.changeTextAreaValue(p,this.nextOrderedListValue(d[0].trim()),n,r,t,i,o);else if(a<l)this.changeTextAreaValue(p,"1. ",n,r,t,i,o);else for(;a.length>l.length;null)if(h-=1,w=(f=this.selection.getLine(r,h)).trim().split(". "),/^\d+$/.test(w[0])&&(a=this.getTabSpace(f)).length<=l.length){this.changeTextAreaValue(p,this.nextOrderedListValue(w[0]),n,r,t,i,o);break}}else("UL"===this.currentAction&&k.test(f.trim())||!y)&&(n.event.preventDefault(),t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text,r.value=r.value.substr(0,t[i].start)+t[i].text+"\n"+r.value.substr(t[i].end,r.value.length));if(e=0===i?e+c:e,v+=c,1!==t.length)for(u=i;u<t.length;u++)t[u].start=0!==u?t[u].start+c:t[u].start,t[u].end=t[u].end+c}this.restore(r,e,o+v,n)}else this.restore(r,e,o+v,n)},n.prototype.changeTextAreaValue=function(n,i,r,u,f,e){var k=i,c,w,b;n.splice(0,1);var d,ut=this.selection.getAllParents(u.value).length,o="",h=this.getTabSpace(f[e].text),g=parseInt(k.split(".")[0],null),y=this.getTabSpace(f[e].text),nt=!0,a=!0,tt=-1,it=!0,rt=0,p="";for(o=""!==this.selection.getLine(u,f[0].line+1)?"":o+u.value.substr(f[0].end,u.value.length),c=1;c<ut&&!t.isNullOrUndefined(this.selection.getLine(u,f[0].line+c))&&""!==this.selection.getLine(u,f[0].line+c);c++){var v=this.selection.getLine(u,f[0].line+c),s=this.getTabSpace(v),l=v.split(". ");if(1===l.length){o+=u.value.substr(f[0].end+rt,u.value.length);break}rt+=v.length;w=!1;(d=r.event.shiftKey?h.length+1:h.length-1,s.length>y.length&&(it=!1),h.length!==s.length&&s.length<y.length?(a=!0,nt=!1,w=!(!r.event.shiftKey||h.length!==s.length||(a=!1,0))):it&&r.event.shiftKey&&h.length===s.length&&s.length===y.length&&(a=!1,w=!0),p=""===o?"":"\n",d===s.length&&a)?(b=r.event.shiftKey?(tt++,this.nextOrderedListValue(tt.toString())):this.previousOrderedListValue(l[0]),l.splice(0,1),o=o+p+s+b+l.join(". ")):h.length===s.length&&nt||w?(b=this.nextOrderedListValue(g.toString()),g++,l.splice(0,1),o=o+p+s+b+l.join(". ")):(o=o+p+v,a=!1);y=this.getTabSpace(v)}f[e].text=this.getTabSpace(f[e].text)+k+n.join(". ")+"\n";u.value=u.value.substr(0,f[e].start)+f[e].text+o},n.prototype.getTabSpace=function(n){for(var i=n.split("\t"),r="",t=0;t<i.length&&""===i[t];t++)r+="\t";return r},n.prototype.isNotFirstLine=function(n,t){var s,c=t.text,o=t.line-1,i=this.selection.getLine(n,o),h=this.getListRegex(),r=!1,u,f,e;if(i&&(this.currentAction=this.getAction(i),u=i.split(". "),s="OL"===this.currentAction?/^\d+$/.test(u[0].trim()):h.test(i.trim())),i&&s)for(f=this.getTabSpace(c),e=this.getTabSpace(i),r=f===e||r;e.length>f.length;null)if(o-=1,u=(i=this.selection.getLine(n,o)).trim().split(". "),("OL"===this.currentAction?/^\d+$/.test(u[0]):h.test(i.trim()))&&(e=this.getTabSpace(i)).length<=f.length){r=!0;break}return r},n.prototype.getAction=function(n){var t=n.split(". ")[0],i=/^\d+$/.test(t.trim()),r=n.trim().split(new RegExp("^("+this.selection.replaceSpecialChar(this.syntax.UL).trim()+")"))[1];return i?"OL":r?"UL":"NOTLIST"},n.prototype.nextOrderedListValue=function(n){return(parseInt(n,null)+1).toString()+". "},n.prototype.previousOrderedListValue=function(n){return(parseInt(n,null)-1).toString()+". "},n.prototype.enterKey=function(n){var i=this.parent.element,a,e,f,h,c,v,g;this.selection.save(i.selectionStart,i.selectionEnd);var l=i.selectionStart,nt=i.selectionEnd,r=this.selection.getSelectedParentPoints(i),u=this.selection.getLine(i,r[0].line-1),p=this.olListType(),w=this.getListRegex(),o=[];if(t.isNullOrUndefined(u)||(o=u.split(". "),this.currentAction=this.getAction(u)),a=0,"OL"===this.currentAction&&o.length>1&&/^\d+$/.test(o[0].trim())&&p&&""!==o[1]){e=this.getTabSpace(u);this.currentAction=this.getAction(u);f=this.nextOrderedListValue(o[0]);r[0].text=e+f+r[0].text;for(var tt=this.selection.getAllParents(i.value).length,s="\n",b=this.getTabSpace(u),k=this.getTabSpace(r[0].text),d=!0,y=1;y<tt&&""!==i.value.substr(r[0].end,i.value.length);y++)h=this.selection.getLine(i,r[0].line+y),t.isNullOrUndefined(h)?s+="":(c=h.split(". "),v=this.getTabSpace(h),(v.length<k.length&&(d=!1),c.length>1&&/^\d+$/.test(c[0].trim())&&b.length===v.length&&d)?(g=this.nextOrderedListValue(c[0]),c.splice(0,1),s=s+v+g+c.join(". ")+"\n"):(s=s+h+"\n",k=this.getTabSpace(h)));i.value=i.value.substr(0,r[0].start)+b+f+this.selection.getLine(i,r[0].line)+s;l=l+f.length+e.length;a+=f.length+e.length}else("UL"===this.currentAction&&u&&w.test(u.trim())&&""!==u.trim().replace(w,"")||"OL"===this.currentAction&&!p&&""!==o[1])&&(e=this.getTabSpace(u),f=this.syntax[this.currentAction],r[0].text=e+f+r[0].text+(r[0].text.trim().length>0?"\n":""),i.value=i.value.substr(0,r[0].start)+r[0].text+i.value.substr(r[0].end,i.value.length),l=l+f.length+e.length,a+=f.length+e.length);this.restore(i,l,nt+a,n)},n.prototype.olListType=function(){var n=this.syntax.OL.split(".,");return 1!==n.length&&parseInt(n[2].trim(),null)-parseInt(n[0].trim(),null)?1:0},n.prototype.applyListsHandler=function(n){var f=this.parent.element,u,p,e;this.selection.save(f.selectionStart,f.selectionEnd);this.currentAction=n.subCommand;for(var o,s=f.selectionStart,l=f.selectionEnd,a=0,v=0,c=0,i=this.selection.getSelectedParentPoints(f),h="",y=this.olListType(),w={},r=0;r<i.length;r++)if(o=y?"OL"===this.currentAction?r+y+". ":this.syntax[this.currentAction]:"OL"===this.currentAction?this.syntax.OL:this.syntax[this.currentAction],this.selection.isStartWith(i[r].text,o))i[r].text=i[r].text.replace(o,""),f.value=f.value.substr(0,i[r].start+c)+i[r].text+"\n"+f.value.substr(i[r].end+c,f.value.length),c-=o.length,v=o.length,this.restore(f,s-v,l+c,null);else{if(""===i[r].text&&0===r&&(this.selection.save(s,l),1!==i.length))for(u=r;u<i.length;u++)i[u].start=0!==u?1+i[u].start:i[u].start,i[u].end=1+i[u].end;if(p=t.isNullOrUndefined(i[r-1])?0:this.getTabSpace(i[r-1].text).length,e=this.appliedLine(i[r].text,o,w,p),h=e.line?h:o,i[r].text=e.line?e.line:h+i[r].text,e.space=e.space?e.space:0,f.value=f.value.substr(0,i[r].start+c)+i[r].text+"\n"+f.value.substr(i[r].end,f.value.length),s=0===r?s+h.length+e.space>0?s+h.length+e.space:0:s,a+=h.length+e.space,1!==i.length)for(u=r;u<i.length;u++)i[u].start=0!==u?h.length+i[u].start+e.space:i[u].start,i[u].end=h.length+i[u].end+e.space;this.restore(f,s<=o.length?0:s,l+a,null)}this.restore(f,null,null,n)},n.prototype.appliedLine=function(n,i,r,u){var e={},c=new RegExp("^["+this.syntax.UL.trim()+"]"),f=n.split(". "),l=f[0]+". ",v=c.test(n.trim())||n.trim()===this.syntax.OL.trim()||n.trim()===this.syntax.UL.trim()||/^\d+$/.test(f[0].trim()),a=this.olListType(),o=this.getTabSpace(n).length,s,h;return("OL"===this.currentAction&&a&&(r[o.toString()]=t.isNullOrUndefined(r[o.toString()])?1:r[o.toString()].valueOf()+1,i=r[o.toString()].valueOf().toString()+". ",!t.isNullOrUndefined(u)&&u>o&&(r[u.toString()]=0)),v)&&(s=void 0,h=void 0,c.test(n.trim())?(h=this.syntax.UL,s=i,e.space=i.trim().length-this.syntax.UL.trim().length):/^\d+$/.test(f[0].trim())&&a?(h=f[0].trim()+". ",s=i,e.space=this.syntax.UL.trim().length-l.trim().length):/^\d+$/.test(f[0].trim())&&(h=f[0].trim()+". ",s=this.syntax.UL,e.space=this.syntax.UL.trim().length-l.trim().length),e.line=n.replace(h,s)),e},n.prototype.restore=function(n,i,r,u){t.isNullOrUndefined(i)||t.isNullOrUndefined(i)||this.selection.save(i,r);t.isNullOrUndefined(u)||this.selection.restore(n);u&&u.callBack&&u.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:u.event})},n.prototype.getListRegex=function(){for(var n,t="",r=Object.keys(this.syntax),u=RegExp,i=0;i<r.length;i++)n=this.selection.replaceSpecialChar(this.syntax[r[i]]),t+=""===t?"^("+n+")|^("+n.trim()+")":"|^("+n+")|^("+n.trim()+")";return new u(t)},n.prototype.destroy=function(){this.removeEventListener()},n}(),sut=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(du,this.applyFormats,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(du,this.applyFormats);this.parent.observer.off(f,this.destroy)},n.prototype.applyFormats=function(n){var r,i,u,f;if(n.subCommand=n.subCommand.toLowerCase(),r=this.parent.element,this.selection.save(r.selectionStart,r.selectionEnd),i=this.selection.getSelectedParentPoints(r),this.isAppliedFormat(i)===n.subCommand){if("pre"===n.subCommand){if(!(i.length>1))return;this.applyCodeBlock(r,n,i)}return this.cleanFormat(r),void this.restore(r,r.selectionStart,r.selectionEnd,n)}if("p"===n.subCommand)return this.cleanFormat(r),void this.restore(r,r.selectionStart,r.selectionEnd,n);("pre"===n.subCommand&&1!==i.length||"pre"!==n.subCommand)&&this.cleanFormat(r,n.subCommand);var e=r.selectionStart,s=r.selectionEnd,o=0;if(i=this.selection.getSelectedParentPoints(r),"pre"!==n.subCommand){for(u=0;u<i.length;u++)if(""===i[u].text||this.selection.isStartWith(i[u].text,"\\"+this.syntax[n.subCommand])){if(""===i[u].text&&0===u&&(this.selection.save(e,s),0===this.selection.getSelectedText(r).length&&(i[u].text=this.syntax[n.subCommand],r.value=r.value.substr(0,i[u].start)+this.syntax[n.subCommand]+r.value.substr(i[u].end,r.value.length),e=0===u?e+this.syntax[n.subCommand].length:e,o+=this.syntax[n.subCommand].length),1!==i.length))for(f=u;f<i.length;f++)i[f].start=0!==f?1+i[f].start:i[f].start,i[f].end=1+i[f].end}else if(i[u].text=this.syntax[n.subCommand]+i[u].text,r.value=r.value.substr(0,i[u].start)+i[u].text+"\n"+r.value.substr(i[u].end,r.value.length),e=0===u?e+this.syntax[n.subCommand].length:e,o+=this.syntax[n.subCommand].length,1!==i.length)for(f=u;f<i.length;f++)i[f].start=0!==f?this.syntax[n.subCommand].length+i[f].start:i[f].start,i[f].end=this.syntax[n.subCommand].length+i[f].end;this.restore(r,e,s+o,n)}else i.length>1?this.applyCodeBlock(r,n,i):(t.extend(n,n,{subCommand:"InlineCode"},!0),this.parent.observer.notify(ah,n))},n.prototype.clearRegex=function(){for(var i="",t=Object.keys(this.syntax),n=0;n<t.length&&"pre"!==t[n]&&"p"!==t[n];n++)i+=""===i?"^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")":"|^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")";return i},n.prototype.cleanFormat=function(n,t){var i=this.selection.getSelectedParentPoints(n),o=n.selectionStart,c=n.selectionEnd,l=0,r,s,u,e,h,f;if(this.selection.isClear(i,this.clearRegex())){for(r=0;r<i.length;r++){for(s=Object.keys(this.syntax),u=0;""!==i[r].text&&u<s.length;u++)if(e=this.syntax[s[u]],s[u]!==t&&(h=new RegExp("^("+this.selection.replaceSpecialChar(e)+")","gim"),h.test(i[r].text))){if(i[r].text=i[r].text.replace(h,""),n.value=n.value.substr(0,i[r].start)+i[r].text+"\n"+n.value.substr(i[r].end,n.value.length),o=0===r?o-e.length>0?o-e.length:0:o,l+=e.length,1!==i.length)for(f=0;f<i.length;f++)i[f].start=0!==f?i[f].start-e.length:i[f].start,i[f].end=i[f].end-e.length;break}if(""===i[r].text&&0===r&&(this.selection.save(o,c),1!==i.length))for(u=r;u<i.length;u++)i[u].start=0!==u?1+i[u].start:i[u].start,i[u].end=1+i[u].end}this.restore(n,o,c-l)}},n.prototype.applyCodeBlock=function(n,t,i){var e=t.subCommand,r=i[0].start,u=i[i.length-1].end,h=this.selection.getAllParents(n.value),y=h[i[0].line-1],p=h[i.length+1+1],l,a,s,v;if(this.selection.isStartWith(y,this.syntax.pre.split("\n")[0])||this.selection.isStartWith(p,this.syntax.pre.split("\n")[0])){var f=this.syntax[""+e],o=this.parent.markdownSelection.getSelectedInlinePoints(n),w=n.value.substr(0,n.selectionStart).lastIndexOf(f),c=n.value.substr(n.selectionEnd,n.selectionEnd).indexOf(f);c+=o.end;l=this.replaceAt(n.value.substr(0,o.start),f,"",w,o.start);a=this.replaceAt(n.value.substr(o.end,n.value.length),f,"",0,c);n.value=l+o.text+a;r=this.selection.selectionStart-f.length;u=this.selection.selectionEnd-f.length}else s=n.value.substring(r,u).split("\n"),v=""===s[s.length-1]?"":"\n",n.value=n.value.substr(0,r)+this.syntax[""+e]+n.value.substring(r,u)+v+this.syntax[""+e]+n.value.substr(u,n.value.length),r=this.selection.selectionStart+this.syntax[""+e].length,u=this.selection.selectionEnd+this.syntax[""+e].length-1;this.restore(n,r,u,t)},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.isAppliedFormat=function(n,t){for(var u="p",r=(Object.keys(this.syntax),Object.keys(this.syntax)),e="backward"===this.parent.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(e,this.syntax[r[i]])){u=r[i];break}if("pre"===r[i]){var f=this.selection.getAllParents(this.parent.element.value),o=f[n[0].line-1],s=f[n.length+1];if(this.selection.isStartWith(o,this.syntax[r[i]].split("\n")[0])&&this.selection.isStartWith(s,this.syntax[r[i]].split("\n")[0])){u=r[i];break}}}return u},n.prototype.destroy=function(){this.removeEventListener()},n}(),hut=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ah,this.applyCommands,this);this.parent.observer.on(c,this.keyDownHandler,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(ah,this.applyCommands);this.parent.observer.off(c,this.keyDownHandler);this.parent.observer.off(f,this.destroy)},n.prototype.keyDownHandler=function(n){switch(n.event.action){case"bold":this.applyCommands({subCommand:"Bold",callBack:n.callBack});n.event.preventDefault();break;case"italic":this.applyCommands({subCommand:"Italic",callBack:n.callBack});n.event.preventDefault();break;case"strikethrough":this.applyCommands({subCommand:"StrikeThrough",callBack:n.callBack});n.event.preventDefault();break;case"uppercase":this.applyCommands({subCommand:"UpperCase",callBack:n.callBack});n.event.preventDefault();break;case"lowercase":this.applyCommands({subCommand:"LowerCase",callBack:n.callBack});n.event.preventDefault();break;case"superscript":this.applyCommands({subCommand:"SuperScript",callBack:n.callBack});n.event.preventDefault();break;case"subscript":this.applyCommands({subCommand:"SubScript",callBack:n.callBack});n.event.preventDefault()}},n.prototype.isBold=function(n,t){return-1!==n.search("\\"+t+"\\"+t)},n.prototype.isItalic=function(n,t){return-1!==n.search("\\"+t)},n.prototype.isMatch=function(n,t){var i=[""];switch(t){case this.syntax.Italic:case this.syntax.InlineCode:case this.syntax.StrikeThrough:i=n.match(this.singleCharRegx(t))}return i},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+"\\"+n+")","g")},n.prototype.singleCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n.prototype.isAppliedCommand=function(n){var h,r=!1,e=this.parent.element,l=e.selectionStart,i=(h=l,function(n){return[n.slice(0,h),n.slice(h)]})(e.value),u=this.syntax.Bold.substr(0,1),c=this.syntax.Italic,o=this.parent.markdownSelection.getSelectedText(e),f,s;return""!==o&&o===o.toLocaleUpperCase()&&"UpperCase"===n?!0:""===o&&(f=e.value.substr(i[0].length-1,1),s=i[1].substr(0,1),""!==f&&""!==s&&f.match(/[a-z]/i)&&f===f.toLocaleUpperCase()&&s===s.toLocaleUpperCase()&&"UpperCase"===n)?!0:(this.isBold(i[0],u)||this.isItalic(i[0],c)||this.isBold(i[1],u)||this.isItalic(i[1],c)||(t.isNullOrUndefined(this.isMatch(i[0],this.syntax.StrikeThrough))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.StrikeThrough))||this.isMatch(i[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(i[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.InlineCode))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.InlineCode))||this.isMatch(i[0],this.syntax.InlineCode).length%2!=1||this.isMatch(i[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sub>/g))||t.isNullOrUndefined(i[1].match(/\<\/sub>/g))||i[0].match(/\<sub>/g).length%2!=1||i[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sup>/g))||t.isNullOrUndefined(i[1].match(/\<\/sup>/g))||i[0].match(/\<sup>/g).length%2!=1||i[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(r=!0)),this.isBold(i[0],u)&&this.isBold(i[1],u)&&i[0].match(this.multiCharRegx(u)).length%2==1&&i[1].match(this.multiCharRegx(u)).length%2==1&&"Bold"===n&&(r=!0),i[0]=this.isBold(i[0],u)?i[0].replace(this.multiCharRegx(u),"$%@"):i[0],i[1]=this.isBold(i[1],u)?i[1].replace(this.multiCharRegx(u),"$%@"):i[1],t.isNullOrUndefined(this.isMatch(i[0],this.syntax.Italic))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.Italic))||this.isMatch(i[0],this.syntax.Italic).length%2!=1||this.isMatch(i[1],this.syntax.Italic).length%2!=1||"Italic"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.StrikeThrough))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.StrikeThrough))||this.isMatch(i[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(i[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.InlineCode))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.InlineCode))||this.isMatch(i[0],this.syntax.InlineCode).length%2!=1||this.isMatch(i[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sub>/g))||t.isNullOrUndefined(i[1].match(/\<\/sub>/g))||i[0].match(/\<sub>/g).length%2!=1||i[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sup>/g))||t.isNullOrUndefined(i[1].match(/\<\/sup>/g))||i[0].match(/\<sup>/g).length%2!=1||i[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(r=!0),r)},n.prototype.applyCommands=function(n){var i,e,o,c,s;this.currentAction=n.subCommand;i=this.parent.element;this.selection.save(i.selectionStart,i.selectionEnd);var u=i.selectionStart,f=i.selectionEnd,r=0,t=this.parent.markdownSelection.getSelectedInlinePoints(i);if(this.isAppliedCommand(n.subCommand)&&""!==t.text){var h=this.syntax[n.subCommand],l="SubScript"===n.subCommand?"<\/sub>":"SuperScript"===n.subCommand?"<\/sup>":this.syntax[n.subCommand],a="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:h.length,y=i.value.substr(0,t.start).lastIndexOf(h),v=i.value.substr(t.end,i.value.length).indexOf(l);return v+=t.end,e=this.replaceAt(i.value.substr(0,t.start),h,"",y,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),l,"",0,v),i.value=e+t.text+o,void this.restore(i,u-a,f-a,n)}""===t.text||this.isApplied(t,n.subCommand)?"UpperCase"!==n.subCommand&&"LowerCase"!==n.subCommand?("SubScript"===n.subCommand||"SuperScript"===n.subCommand?(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5)):(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand]),i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),r=this.syntax[n.subCommand].length,t.start===t.end?this.restore(i,u+r,f+r,n):this.restore(i,u+r,f-r,n)):this.restore(i,u,f,n):(r="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:this.syntax[n.subCommand].length,c=i.value.substr(t.start-this.syntax[n.subCommand].length,this.syntax[n.subCommand].length),s=void 0,c===n.subCommand||t.start-this.syntax[n.subCommand].length===i.value.indexOf(this.syntax[n.subCommand])&&(t.end===i.value.lastIndexOf(this.syntax[n.subCommand])||t.end===i.value.lastIndexOf("<\/"+this.syntax[n.subCommand].substring(1,5)))?(s="SubScript"===n.subCommand||"SuperScript"===n.subCommand?i.value.substr(t.end,this.syntax[n.subCommand].length+1):i.value.substr(t.end,this.syntax[n.subCommand].length),e=this.replaceAt(i.value.substr(0,t.start),c,"",t.start-this.syntax[n.subCommand].length,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),s,"",0,s.length),i.value=e+t.text+o,this.restore(i,u-r,f-r,n)):(t.text="SubScript"===n.subCommand||"SuperScript"===n.subCommand?this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5):"UpperCase"===n.subCommand||"LowerCase"===n.subCommand?"UpperCase"===n.subCommand?t.text.toUpperCase():t.text.toLowerCase():this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand],i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),this.restore(i,u+r,f+r,n)));this.parent.undoRedoManager.saveData()},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.textReplace=function(n,t){var i=this.singleCharRegx(this.syntax[""+t]),u,r,f;switch(t){case"Bold":i=this.multiCharRegx(this.syntax[""+t].substr(0,1));n=n.replace(i,"");break;case"Italic":this.isBold(n,this.syntax[""+t].substr(0,1))?(u=this.multiCharRegx(this.syntax[""+t].substr(0,1)),r=n,r=r.replace(u,"$%@").replace(i,""),f=new RegExp("\\$%@","g"),n=r.replace(f,this.syntax[""+t].substr(0,1)+this.syntax[""+t].substr(0,1))):n=n.replace(i,"");break;case"StrikeThrough":case"InlineCode":n=n.replace(i,"");break;case"SubScript":n=n.replace(/<sub>/g,"").replace(/<\/sub>/g,"");break;case"SuperScript":n=n.replace(/<sup>/g,"").replace(/<\/sup>/g,"")}return n},n.prototype.isApplied=function(n,t){var i=this.singleCharRegx(this.syntax[""+t]),r,f,u;switch(t){case"SubScript":case"SuperScript":return(i=this.singleCharRegx(this.syntax[""+t])).test(n.text);case"Bold":case"StrikeThrough":return(i=this.multiCharRegx(this.syntax[""+t].substr(0,1))).test(n.text);case"UpperCase":case"LowerCase":return(i=new RegExp("^["+this.syntax[""+t]+"]*$","g")).test(n.text);case"Italic":return r=void 0,f=this.multiCharRegx(this.syntax[""+t].substr(0,1)),f.test(n.text)?(u=n.text,u=u.replace(f,"$%#"),r=i.test(u)):r=i.test(n.text),r;case"InlineCode":return i.test(n.text)}},n.prototype.destroy=function(){this.removeEventListener()},n}(),cut=function(){function n(n,i){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=t.isNullOrUndefined(i)?30:i.undoRedoSteps;this.undoRedoTimer=t.isNullOrUndefined(i)?300:i.undoRedoTimer;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){var n=t.debounce(this.keyUp,this.undoRedoTimer);this.parent.observer.on(ei,n,this);this.parent.observer.on(c,this.keyDown,this);this.parent.observer.on(ku,this.onAction,this);this.parent.observer.on(pr,this.onPropertyChanged,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){var n=t.debounce(this.keyUp,300);this.parent.observer.off(ei,n);this.parent.observer.off(c,this.keyDown);this.parent.observer.off(ku,this.onAction);this.parent.observer.off(pr,this.onPropertyChanged);this.parent.observer.off(f,this.destroy)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.saveData=function(n){var t=this.parent.element;this.selection.save(t.selectionStart,t.selectionEnd);var i=t.selectionStart,r=t.selectionEnd,u={text:this.parent.element.value,start:i,end:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].start===i&&this.undoRedoStack[this.undoRedoStack.length-1].end===r||(this.undoRedoStack.push(u),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())},n.prototype.undo=function(n){if(this.steps>0){this.currentAction="Undo";var t=this.undoRedoStack[this.steps-1].start,i=this.undoRedoStack[this.steps-1].end,r=this.undoRedoStack[this.steps-1].text;this.parent.element.value=r;this.parent.element.focus();this.steps--;this.restore(this.parent.element,t,i,n)}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){this.currentAction="Redo";var t=this.undoRedoStack[this.steps+1].start,i=this.undoRedoStack[this.steps+1].end;this.parent.element.value=this.undoRedoStack[this.steps+1].text;this.parent.element.focus();this.steps++;this.restore(this.parent.element,t,i,n)}},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n.prototype.getCurrentStackIndex=function(){return this.steps},n.prototype.clear=function(){this.undoRedoStack=[];this.steps=null},n}(),lut=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(nw,this.createLink,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(nw,this.createLink);this.parent.observer.off(f,this.destroy)},n.prototype.createLink=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i="Image"===n.subCommand?this.selection.getSelectedText(t):n.item.text,f="Image"===n.subCommand?r+2:r+1,e="Image"===n.subCommand?u+2:u+1;i="Image"===n.subCommand?"!["+i+"]("+n.item.url+")":"["+i+"]("+n.item.url+")";t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,f,e);this.restore(t,f,e,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.destroy=function(){this.removeEventListener()},n}(),aut=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(iw,this.createTable,this);this.parent.observer.on(c,this.onKeyDown,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(iw,this.createTable);this.parent.observer.off(c,this.onKeyDown);this.parent.observer.off(f,this.destroy)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onKeyDown=function(n){"insert-table"===n.event.action&&(n.item=n.value,this.createTable(n))},n.prototype.createTable=function(n){this.element=this.parent.element;var t=this.element.selectionStart,i=this.element.selectionEnd,r=this.element.value;this.locale=n;this.selection.save(t,i);this.restore(this.element.selectionStart,this.element.selectionEnd,null);this.insertTable(t,i,r,n)},n.prototype.getTable=function(){var n="";return n+=this.textNonEmpty(),(n+=this.tableHeader(this.locale))+this.tableCell(this.locale)},n.prototype.tableHeader=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=1===i?n.item.headingText+" "+r+"|":"---------|";t+=this.insertLine()}return t},n.prototype.tableCell=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=n.item.colText+" "+this.convertToLetters(i)+r+"|";t+=this.insertLine()}return t+this.insertLine()},n.prototype.insertLine=function(){var n=document.createElement("div");return n.innerHTML="\n",n.textContent},n.prototype.insertTable=function(n,t,i,r){var u=this.selection.getSelectedParentPoints(this.element),f=u[u.length-1].text.split(" ",2),e=this.getFormatTag();f.length<2?(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t)):this.ensureFormatApply(u[u.length-1].text)?this.checkValid(n,t,this.getTable(),i,r,f,u,e):(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t));this.restore(this.element.selectionStart,this.element.selectionEnd,r)},n.prototype.makeSelection=function(n,t,i){i=t+(n.length>0?12:10);t+=n.length>0?3:1;this.selection.setSelection(this.element,t,i)},n.prototype.getFormatTag=function(){for(var n,r=Object.keys(this.syntaxTag.Formats),u=Object.keys(this.syntaxTag.List),t=[],i=0;i<r.length;i++)t.push(this.syntaxTag.Formats[r[i]]);for(n=0;n<u.length;n++)t.push(this.syntaxTag.List[u[n]]);return t},n.prototype.ensureFormatApply=function(n){for(var i=this.getFormatTag(),r=n.trim().split(" ",2)[0]+" ",t=0;t<i.length;t++)if(r===i[t]||/^[\d.]+[ ]+$/.test(r))return!0;return!1},n.prototype.ensureStartValid=function(n,t){for(var r=t[0].text.split(" ",2),i=n+1;i<=n+r[0].length-1;i++)if(this.element.selectionStart===i||this.element.selectionEnd===i)return!1;return!0},n.prototype.ensureEndValid=function(n,t){for(var i=n+1;i<=n+t-1;i++)if(this.element.selectionEnd===i)return!1;return!0},n.prototype.updateValueWithFormat=function(n,t){var i=this.element.value.substring(this.element.selectionEnd,this.element.value.length);return t+=i.replace(i,n[0]+" "+i),this.element.value.substr(0,this.element.selectionStart)+t},n.prototype.updateValue=function(n){return this.element.value.substr(0,this.element.selectionStart)+n+this.element.value.substr(this.element.selectionEnd,this.element.value.length)},n.prototype.checkValid=function(n,t,i,r,u,f,e){this.ensureStartValid(e[0].start,e)&&this.ensureEndValid(e[e.length-1].start,f[0].length)&&(this.element.value=n===e[0].start?n!==t&&t!==e[e.length-1].end-1?this.updateValueWithFormat(f,i):this.updateValue(i):t===e[e.length-1].end-1?this.updateValue(i):this.updateValueWithFormat(f,i),this.makeSelection(r,n,t))},n.prototype.convertToLetters=function(n){var i="A".charCodeAt(0),t="";do n-=1,t=String.fromCharCode(i+n%26)+t,n=n/26|0;while(n>0);return t},n.prototype.textNonEmpty=function(){var n="";return(this.isCursorBased()||this.isSelectionBased())&&this.element.value.length>0&&(n+=this.insertLine(),n+=this.insertLine()),n},n.prototype.isCursorBased=function(){return this.element.selectionStart===this.element.selectionEnd},n.prototype.isSelectionBased=function(){return this.element.selectionStart!==this.element.selectionEnd},n.prototype.restore=function(n,i,r){this.selection.save(n,i);this.selection.restore(this.element);r&&r.callBack&&(t.isNullOrUndefined(r.subCommand)&&"action"in r.event&&"insert-table"===r.event.action&&(r.subCommand="CreateTable"),r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(this.element),editorMode:"Markdown",event:r.event}))},n}(),vut=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(tw,this.clear,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(tw,this.clear);this.parent.observer.off(f,this.destroy)},n.prototype.replaceRegex=function(n){return n.replace(/\*/gi,"\\*").replace(/\&/gi,"\\&").replace(/\-/gi,"\\-").replace(/\^/gi,"\\^").replace(/\$/gi,"\\$").replace(/\./gi,"\\.").replace(/\|/gi,"\\|").replace(/\?/gi,"\\?").replace(/\+/gi,"\\+").replace(/\-/gi,"\\-").replace(/\&/gi,"\\&")},n.prototype.clearSelectionTags=function(n){for(var i,r,u,t=this.parent.selectionTags,e=Object.keys(t),f=0;f<e.length;f++)if(i=e[f],Object.prototype.hasOwnProperty.call(t,i)&&""!==t[""+i]){var o=this.replaceRegex(t[""+i]),s=void 0,h=t[""+i].length,c="<sup>"===t[""+i]||"<sub>"===t[""+i]?t[""+i].length+1:t[""+i].length;for(s="<sup>"===t[""+i]?new RegExp("<sup>(.*?)<\/sup>","ig"):"<sub>"===t[""+i]?new RegExp("<sub>(.*?)<\/sub>","ig"):new RegExp(o+"(.*?)"+o,"ig"),r=n.match(s),u=0;r&&u<r.length&&""!==r[u];u++)n=n.replace(r[u],r[u].substr(h,r[u].length-c-h))}return n},n.prototype.clearFormatTags=function(n){var t=n.split("\n");return this.clearFormatLines(t)},n.prototype.clearFormatLines=function(n){for(var u,r,o=[this.parent.formatTags,this.parent.listTags],f="",t=0;t<n.length;t++){for(u=0;u<o.length;u++)for(var i=o[u],s=Object.keys(i),e=0;e<s.length;e++)r=s[e],Object.prototype.hasOwnProperty.call(i,r)&&""!==i[""+r]&&0===n[t].indexOf(i[""+r])&&(n[t]=n[t].replace(i[""+r],""),n[t]=this.clearFormatLines([n[t]]));f=f+n[t]+(t!==n.length-1?"\n":"")}return f},n.prototype.clear=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i=this.selection.getSelectedText(t);i=this.clearSelectionTags(i);i=this.clearFormatTags(i);t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,r,r+i.length);this.restore(t,r,r+i.length,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.destroy=function(){this.removeEventListener()},n}(),cct=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(rw,this.InsertTextExec,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(rw,this.InsertTextExec);this.parent.observer.off(f,this.destroy)},n.prototype.InsertTextExec=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i=n.value.text,f=r+i.length,e=u+i.length;t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,f,e);this.restore(t,f,e,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.destroy=function(){this.removeEventListener()},n}(),yut=function(){function n(n){this.initialize();t.extend(this,this,n,!0);this.observer=new t.Observer(this);this.markdownSelection=new dp;this.listObj=new out({parent:this,syntax:this.listTags});this.formatObj=new sut({parent:this,syntax:this.formatTags});this.undoRedoManager=new cut(this,n.options);this.mdSelectionFormats=new hut({parent:this,syntax:this.selectionTags});this.linkObj=new lut(this);this.tableObj=new aut({parent:this,syntaxTag:{Formats:this.formatTags,List:this.listTags}});this.clearObj=new vut(this);this.insertTextObj=new cct(this);this.wireEvents()}return n.prototype.initialize=function(){this.formatTags=ck;this.listTags=ak;this.selectionTags=lk},n.prototype.wireEvents=function(){this.observer.on(we,this.editorKeyDown,this);this.observer.on(yr,this.editorKeyUp,this);this.observer.on(gu,this.onPropertyChanged,this)},n.prototype.unwireEvents=function(){this.observer.off(we,this.editorKeyDown);this.observer.off(yr,this.editorKeyUp);this.observer.off(gu,this.onPropertyChanged)},n.prototype.onPropertyChanged=function(n){this.observer.notify(pr,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(c,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(ei,n)},n.prototype.execCommand=function(n,t,i,r,u,f){switch(n.toLocaleLowerCase()){case"lists":this.observer.notify(gp,{subCommand:t,event:i,callBack:r});break;case"formats":this.observer.notify(du,{subCommand:t,event:i,callBack:r});break;case"actions":this.observer.notify(ku,{subCommand:t,event:i,callBack:r});break;case"style":case"effects":case"casing":this.observer.notify(ah,{subCommand:t,event:i,callBack:r});break;case"links":case"images":this.observer.notify(nw,{subCommand:t,event:i,callBack:r,item:f});break;case"table":"createtable"===t.toString().toLocaleLowerCase()&&this.observer.notify(iw,{subCommand:t,item:f,event:i,callBack:r});break;case"clear":this.observer.notify(tw,{subCommand:t,event:i,callBack:r});break;case"inserttext":this.observer.notify(rw,{subCommand:t,event:i,callBack:r,value:{text:f}})}},n.prototype.destroy=function(){this.observer.notify(f,{});this.unwireEvents()},n}(),lct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),put=function(n){function i(i){var r=n.call(this)||this;return r.initialize(),t.extend(r,r,i,!0),i&&r.element&&r.updateFormatter(r.element,document,i.options),r}return lct(i,n),i.prototype.initialize=function(){this.keyConfig=fit;this.formatTags=ck;this.listTags=ak;this.selectionTags=lk},i.prototype.updateFormatter=function(n,t,i){n&&(this.editorManager=new yut({element:n,formatTags:this.formatTags,listTags:this.listTags,selectionTags:this.selectionTags,options:i}))},i}(ud),act=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.isDestroyed=!1}return n.prototype.destroy=function(){this.isDestroyed||(this.removeEventListener(),this.isDestroyed=!0)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.saveSelection=new dp,this.parent.on(hf,this.instantiateRenderer,this),this.parent.on(a,this.render,this),this.parent.on(k,this.onPropertyChanged,this),this.parent.on(bh,this.onToolbarClick,this),this.parent.on(u,this.destroy,this),this.parent.on(bf,this.selectAll,this),this.parent.on(kf,this.getSelectedHtml,this),this.parent.on(ft,this.onSelectionSave,this),this.parent.on(lt,this.onSelectionRestore,this),this.parent.on(ne,this.updateReadOnly,this))},n.prototype.updateReadOnly=function(){this.parent.readonly?(this.parent.contentModule.getEditPanel().setAttribute("readonly","readonly"),t.addClass([this.parent.element],le)):(this.parent.contentModule.getEditPanel().removeAttribute("readonly"),t.removeClass([this.parent.element],le))},n.prototype.onSelectionSave=function(){var n=this.parent.contentModule.getEditPanel();this.saveSelection.save(n.selectionStart,n.selectionEnd)},n.prototype.onSelectionRestore=function(){this.contentRenderer.getEditPanel().focus();var n=this.parent.contentModule.getEditPanel();this.saveSelection.restore(n)},n.prototype.onToolbarClick=function(n){var i=n.item,t=this.parent.contentModule.getEditPanel(),u;"Formats"!==i.command&&t.focus();var f=t.selectionStart,e=t.selectionEnd,r=t.value.substring(f,e);switch(i.subCommand){case"Maximize":this.parent.notify(eo,{args:n});break;case"Minimize":this.parent.notify(oo,{args:n});break;case"CreateLink":this.parent.notify(lo,{member:"link",args:n,text:r,module:"Markdown"});break;case"Image":this.parent.notify(af,{member:"image",args:n,text:r,module:"Markdown"});break;case"CreateTable":u={headingText:this.parent.localeObj.getConstant("TableHeadingText"),colText:this.parent.localeObj.getConstant("TableColText")};this.parent.formatter.process(this.parent,n,n.originalEvent,u);break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}},n.prototype.instantiateRenderer=function(){this.renderFactory.addRenderer(o.Content,new iut(this.parent))},n.prototype.removeEventListener=function(){this.parent.off(a,this.render);this.parent.off(k,this.onPropertyChanged);this.parent.off(u,this.destroy);this.parent.off(bh,this.onToolbarClick);this.parent.off(hf,this.instantiateRenderer);this.parent.off(bf,this.selectAll);this.parent.off(kf,this.getSelectedHtml);this.parent.off(ft,this.onSelectionSave);this.parent.off(lt,this.onSelectionRestore);this.parent.off(ne,this.updateReadOnly)},n.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(o.Content);var n=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};t.isNullOrUndefined(this.parent.formatter)?this.parent.formatter=new put({element:n,options:i}):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),i);this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new eut(this.parent));this.parent.notify(b,{})},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.formatter)){var i=this.contentRenderer.getEditPanel(),r={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(i,this.contentRenderer.getDocument(),r)}},n.prototype.getModuleName=function(){return"markdownEditor"},n.prototype.selectAll=function(){this.parent.formatter.editorManager.markdownSelection.setSelection(this.parent.contentModule.getEditPanel(),0,this.parent.contentModule.getEditPanel().value.length)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()))},n}(),vct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wut=function(n){function i(i){var r=n.call(this)||this;return r.initialize(),t.extend(r,r,i,!0),r.currentDocument&&r.element&&r.updateFormatter(r.element,r.currentDocument,i.options,i.formatPainterSettings),r}return vct(i,n),i.prototype.initialize=function(){this.keyConfig=uit},i.prototype.updateFormatter=function(n,t,i,r){n&&t&&(this.editorManager=new git({document:t,editableElement:n,options:i,formatPainterSettings:r}))},i}(ud),fd=function(){function n(n){this.debounceDelay=100;this.parent=n;this.toolbarStatus=this.prevToolbarStatus={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,numberFormatList:!1,bulletFormatList:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1,blockquote:!1,inlinecode:!1,isCodeBlock:!1,isCheckList:!1};this.debounceDelay=void 0!==this.debounceDelay?this.debounceDelay:100;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(hi,this.onRefreshHandler,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.toolbarStatus=null;this.prevToolbarStatus=null;this.debounceTimer=null;this.parent.off(hi,this.onRefreshHandler);this.parent.off(u,this.removeEventListener)},n.prototype.onRefreshHandler=function(n){var t=this;this.parent.readonly||(!n.args||!n.args.isKeyboardEvent||this.parent.element&&this.parent.element.dataset&&"true"===this.parent.element.dataset.rteUnitTesting?(clearTimeout(this.debounceTimer),this.getToolbarStatus(n)):(clearTimeout(this.debounceTimer),this.debounceTimer=window.setTimeout(function(){t.getToolbarStatus(n)},this.debounceDelay)))},n.prototype.getToolbarStatus=function(n){var i=[],r=[],u=[],t;this.parent.fontSize.items.forEach(function(n){i.push(n.value)});this.parent.fontFamily.items.forEach(function(n){r.push(n.value)});this.parent.format.types.forEach(function(n){u.push(n.value.toLocaleLowerCase())});this.toolbarStatus=td.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),u,i,r,n.documentNode);t=JSON.stringify(this.toolbarStatus);this.parent.notify(di,this.toolbarStatus);JSON.stringify(this.prevToolbarStatus)!==t&&(this.parent.notify(ns,{html:JSON.parse(t),markdown:null}),this.prevToolbarStatus=JSON.parse(t))},n}(),but=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ie,this.enableXhtmlValidation,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(ie,this.enableXhtmlValidation);this.parent.off(u,this.removeEventListener)},n.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&(this.currentElement=t.isNullOrUndefined(this.parent.inputElement)?this.parent.element:this.parent.inputElement,this.clean(this.currentElement),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.currentElement.innerHTML=this.selfEncloseValidation(this.currentElement.innerHTML,"\n"===this.currentElement.innerText?this.currentElement.innerText.length:this.currentElement.innerText.trim().length),this.parent.setProperties({value:this.currentElement.innerHTML},!0))},n.prototype.selfEncloseValidation=function(n,t){var u,e,r,f;0===t&&n.indexOf("table")<0&&n.indexOf("img")<0&&n.includes("&nbsp;")&&(u=n.split("&nbsp;"),u[u.length-1]="&#8203;"+u[u.length-1],n=u.join(""));n=n.replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>").replace(/ /g," ");for(var i=[],h=[],s=[/<img(.*?)>/gi,/<area(.*?)>/gi,/<base(.*?)>/gi,/<col (.*?)>/gi,/<embed(.*?)>/gi,/<input(.*?)>/gi,/<link(.*?)>/gi,/<meta(.*?)>/gi,/<param(.*?)>/gi,/<source(.*?)>/gi,/<track(.*?)>/gi,/<wbr(.*?)>/gi],o=0;o<s.length;o++){for(e=s[o].exec(n);null!==e;)i.push(e[0].toString()),e=s[o].exec(n);for(h=i.slice(0),r=0;r<i.length;r++)-1!==i[r].indexOf("/")&&i[r].lastIndexOf("/")===i[r].length-2||(i[r]=i[r].substr(0,i[r].length-1)+" /"+i[r].substr(i[r].length-1,i[r].length));for(f=0;f<=i.length-1;f++)n=n.replace(h[f],i[f])}return n},n.prototype.clean=function(n){for(var t,i=0;i<n.childNodes.length;i++)t=n.childNodes[i],8===t.nodeType||"V:IMAGE"===t.nodeName?(n.removeChild(t),i--):1===t.nodeType&&this.clean(t);return this.currentElement.innerHTML},n.prototype.ImageTags=function(){for(var t=this.currentElement.querySelectorAll("IMG"),n=t.length-1;n>=0;n--)t[n].hasAttribute("alt")||t[n].setAttribute("alt","")},n.prototype.removeTags=function(){for(var t=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],n=0;n<t.length;n++)this.RemoveElementNode(t[n][0],t[n][1])},n.prototype.RemoveElementNode=function(n,i){for(var e,u,f=this.currentElement.querySelectorAll(i),r=0;r<f.length;r++)for(e=f[r].querySelectorAll(n),u=e.length;u>0;u--)t.detach(e[u-1])},n.prototype.RemoveUnsupported=function(){for(var u,r,f,e,i=this.currentElement.querySelectorAll("u"),n=i.length-1;n>=0;n--)u=this.parent.createElement("span"),u.style.textDecoration="underline",u.innerHTML=i[n].innerHTML,i[n].parentNode.insertBefore(u,i[n]),t.detach(i[n]);for(r=this.currentElement.querySelectorAll("strong"),n=r.length-1;n>=0;n--)f=this.parent.createElement("b"),f.innerHTML=r[n].innerHTML,r[n].parentNode.insertBefore(f,r[n]),t.detach(r[n]);for(e=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"],n=0;n<=e.length;n++)this.RemoveAttributeByName(e[n])},n.prototype.RemoveAttributeByName=function(n){var u,i,f,t,r;if(null!==this.currentElement.firstChild&&3!==this.currentElement.firstChild.nodeType)for(u=0;u<this.currentElement.childNodes.length;u++)if(i=this.currentElement.childNodes[u],3!==i.nodeType&&"TABLE"!==i.nodeName&&"TBODY"!==i.nodeName&&"THEAD"!==i.nodeName&&"TH"!==i.nodeName&&"TR"!==i.nodeName&&"TD"!==i.nodeName&&(i.hasAttribute(n)&&i.removeAttribute(n),i.hasChildNodes()))for(f=0;f<i.childNodes.length;f++)if(t=i.childNodes[f],3!==t.nodeType&&"TABLE"!==t.nodeName&&"TBODY"!==t.nodeName&&"THEAD"!==t.nodeName&&"TH"!==t.nodeName&&"TR"!==t.nodeName&&"TD"!==t.nodeName&&t.hasAttribute(n)&&!t.classList.contains("e-mention-chip")&&t.removeAttribute(n),t.hasChildNodes())for(r=0;r<t.childNodes.length;r++)3!==t.childNodes[r].nodeType&&"TABLE"!==t.childNodes[r].nodeName&&"TBODY"!==t.childNodes[r].nodeName&&"THEAD"!==t.childNodes[r].nodeName&&"TH"!==t.childNodes[r].nodeName&&"TR"!==t.childNodes[r].nodeName&&"TD"!==t.childNodes[r].nodeName&&t.childNodes[r].hasAttribute(n)&&t.childNodes[r].removeAttribute(n)},n}(),yct=function(){function n(n,t){this.rangeCollection=[];this.isImageDelete=!1;this.isMention=!1;this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.xhtmlValidation=new but(n);this.addEventListener();this.isDestroyed=!1;this.isCopyAll=!1;this.isSlashMenuOpen=!1;this.isPreviousNodeBrAfterBackSpace=!1}return n.prototype.destroy=function(){this.isDestroyed||(this.clickTimeout&&(clearTimeout(this.clickTimeout),this.clickTimeout=null),this.removeEventListener(),this.locator=null,this.contentRenderer=null,this.renderFactory=null,this.toolbarUpdate=null,this.nodeSelectionObj=null,this.isCopyAll=null,this.isSlashMenuOpen=null,this.rangeCollection.length>0&&(this.rangeCollection=[]),this.rangeElement&&(this.rangeElement=null),this.oldRangeElement&&(this.oldRangeElement=null),this.deleteRangeElement&&(this.deleteRangeElement=null),this.deleteOldRangeElement&&(this.deleteOldRangeElement=null),this.saveSelection&&(this.saveSelection=null),this.xhtmlValidation&&(this.xhtmlValidation=null),this.isDestroyed=!0)},n.prototype.sanitizeHelper=function(n){return ev(n,this.parent)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new st(this.parent.inputElement),this.parent.on(hf,this.instantiateRenderer,this),this.parent.on(wh,this.onToolbarClick,this),this.parent.on(uw,this.onSlashMenuOpen,this),this.parent.on(y,this.onKeyDown,this),this.parent.on(tt,this.onKeyUp,this),this.parent.on(a,this.render,this),this.parent.on(k,this.onPropertyChanged,this),this.parent.on(u,this.destroy,this),this.parent.on(bf,this.selectAll,this),this.parent.on(au,this.selectRange,this),this.parent.on(kf,this.getSelectedHtml,this),this.parent.on(ft,this.onSelectionSave,this),this.parent.on(lt,this.onSelectionRestore,this),this.parent.on(ne,this.updateReadOnly,this),this.parent.on(vu,this.onPaste,this),this.parent.on(sf,this.isTableClassAdded,this),this.parent.on(vw,this.onHandleFontsizeChange,this))},n.prototype.onSlashMenuOpen=function(){this.isSlashMenuOpen=!0},n.prototype.updateReadOnly=function(){this.parent.readonly?(t.attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),t.addClass([this.parent.element],le)):(t.attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),t.removeClass([this.parent.element],le))},n.prototype.onSelectionSave=function(){var n=this.contentRenderer.getDocument(),t=this.nodeSelectionObj.getRange(n);this.saveSelection=this.nodeSelectionObj.save(t,n)},n.prototype.onSelectionRestore=function(n){this.parent.isBlur=!1;this.contentRenderer.getEditPanel().focus({preventScroll:!0});!t.isNullOrUndefined(n.items)&&!n.items||t.isNullOrUndefined(this.saveSelection)||this.saveSelection.restore()},n.prototype.isTableClassAdded=function(){for(var t=this.parent.inputElement.querySelectorAll("table"),n=0;n<t.length;n++)t[n].classList.contains("e-rte-table")||t[n].classList.contains("e-rte-paste-table")||t[n].classList.contains("e-rte-custom-table")||t[n].classList.add("e-rte-table")},n.prototype.onHandleFontsizeChange=function(n){var f,a=n.args,u={name:"dropDownSelect",item:{command:"Font",subCommand:"FontSize"}},i=this.parent.fontSize.items,e,o,h,b,r,c,l,v;if(this.parent.toolbarModule&&this.parent.toolbarModule.dropDownModule&&this.parent.toolbarModule.dropDownModule.fontSizeDropDown&&!t.isNullOrUndefined(this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent)&&""!==this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent)f=this.parent.toolbarModule.dropDownModule.fontSizeDropDown.activeElem[0].textContent;else{e=void 0;o=this.parent.contentModule.getDocument().getSelection();e=o&&o.focusNode&&o.focusNode.parentElement?document.defaultView.getComputedStyle(o.focusNode.parentElement,null).getPropertyValue("font-size"):this.parent.fontSize.width;var y=(e=t.isNullOrUndefined(e)?this.parent.fontSize.width:e).match(/^([\d.]+)(\D+)$/),p=parseInt(y[1],10),s=y[2],w=i[1].value.match(/^([\d.]+)(\D+)$/);w[2]===s?(h=i.findIndex(function(n){var t=n.value;return parseInt(t,10)>=p}),f=i[h].text):(b=this.convertFontSize(p,s,w[2]),h=i.findIndex(function(n){var t=n.value;return parseInt(t,10)>=b}),f=i[h].text)}r=i.findIndex(function(n){return n.text===("Font Size"===f?"Default":f)});"increase-fontsize"===a.action&&-1!==r?r>=i.length-1?(c=i[r].value.match(/^([\d.]+)(\D+)$/),c&&(l=parseInt(c[1],10),v=(s=c[2],l%10==0?10*Math.ceil((l+1)/10):10*Math.ceil(l/10)),u.item.value=v.toLocaleString()+s,u.item.text=v.toLocaleString()+" "+s),this.parent.fontSize.items.push(u.item)):(u.item.value=i[r+1].value,u.item.text=i[r+1].text):"decrease-fontsize"===a.action&&-1!==r&&r>0?(u.item.value=i[r-1].value,u.item.text=i[r-1].text):r>=0&&r<i.length&&i[r]&&(u.item.value=i[r].value,u.item.text=i[r].text);this.parent.formatter.process(this.parent,u,a)},n.prototype.convertFontSize=function(n,t,i){return-1===aw.indexOf(t)&&-1===aw.indexOf(i)||(t="px"),n*tg[t][i]},n.prototype.onKeyUp=function(n){var c=n.args,i=this.parent.getRange(),o=new RegExp("​","g"),g=i.startContainer===i.endContainer&&i.startOffset===i.endOffset&&1===i.startOffset&&1===i.startContainer.textContent.length&&8203===i.startContainer.textContent.charCodeAt(0)&&0===i.startContainer.textContent.replace(o,"").length,b=!1,a,f,y,k,v,p,s,h,w,u,e,d,l;if(i.startContainer===i.endContainer&&i.startOffset===i.endOffset&&i.startContainer!==this.parent.inputElement&&0!==i.startOffset&&(a=3===i.startContainer.nodeType?i.startContainer:i.startContainer.childNodes[i.startOffset-1],b=16===c.keyCode&&8203===a.textContent.charCodeAt(0)&&!t.isNullOrUndefined(a.previousSibling)&&"false"===a.previousSibling.contentEditable),!this.isCopyAll){if(y=!1,!this.isSlashMenuOpen&&[8,9,13,17,18,20,27,36,37,38,39,40,44,45,46,91,112,113,114,115,116,117,118,119,120,121,122,123].indexOf(c.keyCode)<0&&!c.shiftKey&&!c.ctrlKey&&!c.altKey&&!g&&!b){(f=i.startOffset,"#text"===i.startContainer.nodeName?i.startContainer.parentElement!==this.parent.inputElement?i.startContainer.parentElement.classList.add("currentStartMark"):y=!0:i.startContainer.classList.add("currentStartMark"),8203===i.startContainer.textContent.charCodeAt(0))&&(k=i.startContainer.textContent.length,v=i.startOffset,this.removeZeroWidthSpaces(i.startContainer,o),f=0===v?v:v-(k-i.startContainer.textContent.length),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,f));var nt=this.parent.inputElement.innerHTML.length,tt=this.parent.inputElement.innerHTML.replace(o,"").length,r=i.startContainer;if(nt>tt&&!y){for(0!==r.textContent.trim().length&&r.previousSibling&&(p=document.createElement("span"),p.className="tempSpan",i.insertNode(p)),s=this.parent.inputElement.firstChild;!t.isNullOrUndefined(s);)"#text"!==s.nodeName?(s.textContent.replace(o,"").trim().length>0&&s.textContent.includes("​")&&this.removeZeroWidthSpaces(s,o),s=s.nextElementSibling):s=s.nextElementSibling;if(h=this.parent.inputElement.querySelector(".tempSpan"),h&&h.previousSibling&&0!==r.textContent.trim().length&&(r=h.previousSibling,f=h.previousSibling.textContent.length,h.parentNode.removeChild(h),h=null),w=this.parent.inputElement.querySelector(".currentStartMark"),u=w?w.childNodes:[],u.length>1)for(e=0;e<u.length;e++)("#text"===u[e].nodeName&&0===u[e].textContent.length&&(t.detach(u[e]),e--),t.isNullOrUndefined(u[e])||r.textContent.replace(o,"")!==u[e].textContent)||(d=f<=r.textContent.indexOf("​"),f=r.textContent.length>1?r.textContent===u[e].textContent||d?f:f-(r.textContent.length-r.textContent.replace(o,"").length):r.textContent.length,r=u[e]);else 1===u.length&&r.textContent.replace(o,"")===u[0].textContent&&(r=u[0]);this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),r,f)}l=this.parent.inputElement.querySelector(".currentStartMark");t.isNullOrUndefined(l)||(l.classList.remove("currentStartMark"),""===l.getAttribute("class").trim()&&l.removeAttribute("class"));!t.isNullOrUndefined(i.startContainer.previousSibling)&&!t.isNullOrUndefined(i.startContainer.previousSibling.parentElement)&&i.startContainer.parentElement===i.startContainer.previousSibling.parentElement&&8203===i.startContainer.previousSibling.textContent.charCodeAt(0)&&i.startContainer.previousSibling.textContent.length<=1&&(i.startContainer.previousSibling.textContent=i.startContainer.previousSibling.textContent.replace(o,""));8203===i.endContainer.textContent.charCodeAt(i.endOffset)&&(f=i.startOffset,i.endContainer.textContent=i.endContainer.textContent.replace(o,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,f))}this.isSlashMenuOpen=!1}},n.prototype.removeZeroWidthSpaces=function(n,t){var i=this;n.nodeType!==Node.TEXT_NODE?n.childNodes.forEach(function(n){i.removeZeroWidthSpaces(n,t)}):null!==n.textContent&&(n.textContent=n.textContent.replace(t,""))},n.prototype.onKeyDown=function(n){var r,e=this,i,v,y,s,u,o,h,b,a,d,g;if(this.isCopyAll=n.args.ctrlKey&&65===n.args.keyCode?!0:!1,i=n.args,this.parent.inputElement.querySelectorAll(".e-cell-select:not(table)").length>1&&(8===i.keyCode||32===i.keyCode||13===i.keyCode||46===i.keyCode))return this.tableSelectionKeyAction(n),void this.parent.autoResize();if("chrome"===t.Browser.info.name&&(r=this.parent.getRange(),this.backSpaceCleanup(n,r),this.deleteCleanup(n,r)),v=!1,(t.isNullOrUndefined(this.parent.codeBlockModule)||(r=this.parent.getRange(),v=this.parent.formatter.editorManager.codeBlockObj.isSelectionWithinCodeBlock(r,r.startContainer,r.endContainer)),9===i.keyCode&&this.parent.enableTabKey&&!v)&&((this.parent.formatter.saveData(n),!t.isNullOrUndefined(i.target)&&t.isNullOrUndefined(t.closest(i.target,".e-rte-toolbar")))&&(y=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),s=this.nodeSelectionObj.getParentNodeCollection(y),"LI"===s[0].nodeName||t.closest(s[0],"li")||t.closest(s[0],"table")||(i.preventDefault(),u=this.contentRenderer.getDocument().getSelection().getRangeAt(0),o=this.parent.formatter.editorManager.domNode.blockNodes(),"BR"===this.parent.enterKey?u.startOffset!==u.endOffset&&0===u.startOffset?(h=this.nodeSelectionObj.save(y,this.contentRenderer.getDocument()),this.parent.formatter.editorManager.domNode.setMarker(h),o=this.parent.formatter.editorManager.domNode.blockNodes(),this.parent.formatter.editorManager.domNode.convertToBlockNodes(o,!1),this.marginTabAdd(i.shiftKey,o),(h=this.parent.formatter.editorManager.domNode.saveMarker(h)).restore()):(kt.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;",this.parent.element),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))):u.startOffset!==u.endOffset&&0===u.startOffset?this.marginTabAdd(i.shiftKey,o):(kt.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;",this.parent.element),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))))),this.parent.formatter.saveData(n)),("space"===n.args.action||"enter"===n.args.action||13===n.args.keyCode||/[^\w\s\\/\\.\\:@-]/g.test(n.args.key))&&(this.spaceLink(n.args),"HTML"===this.parent.editorMode&&!this.parent.readonly)){if(b=this.parent.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length-this.parent.getSelection().length+1,!(-1===this.parent.maxLength||b<=this.parent.maxLength||13!==n.args.keyCode))return void n.args.preventDefault();this.parent.notify(tl,{args:n.args});hr(this.parent.contentModule.getDocument(),this.parent.inputElement)}if("space"===n.args.action){var c=this.parent.getRange(),k=c.startContainer.textContent.slice(0,c.startOffset),f=this.isOrderedList(k),p=this.isUnOrderedList(k),w=!1;(f||p)&&(w=this.hasMultipleTextNode(c))&&!this.isMention&&(a=c.startContainer,(a=this.parent.formatter.editorManager.domNode.getImmediateBlockNode(a)).childNodes.length>0&&!a.innerHTML.includes("<br>")&&(w=!1));w||(!f||p)&&(!p||f)||(d={callBack:null,event:n.args,name:"keydown-handler",enterKey:this.parent.enterKey,shiftEnterKey:this.parent.shiftEnterKey},g={cancel:!1,item:{command:"Lists",subCommand:f?"OL":"UL"},name:"actionBegin",originalEvent:n.args,requestType:f?"OL":"UL"},this.parent.trigger(l,g,function(t){t.cancel||(e.parent.formatter.editorManager.observer.notify(lv,d),e.parent.trigger(ct,{editorMode:e.parent.editorMode,elements:e.parent.formatter.editorManager.domNode.blockNodes(),event:n.args,name:ct,range:e.parent.getRange(),requestType:f?"OL":"UL"}))}))}"chrome"!==t.Browser.info.name||(t.isNullOrUndefined(this.rangeElement)||t.isNullOrUndefined(this.oldRangeElement))&&(t.isNullOrUndefined(this.deleteRangeElement)||t.isNullOrUndefined(this.deleteOldRangeElement))||"TD"===r.startContainer.parentElement.tagName||"TH"===r.startContainer.parentElement.tagName||(this.rangeElement=null,this.oldRangeElement=null,this.deleteRangeElement=null,this.deleteOldRangeElement=null,this.isImageDelete||i.preventDefault(),i.preventDefault());this.parent.autoResize()},n.prototype.isOrderedList=function(n){var r,i;if(n=n.replace(/\u200B/g,""),r=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/],!t.isNullOrUndefined(n))for(i=0;i<r.length;i++)if(r[i].test(n))return!0;return!1},n.prototype.isUnOrderedList=function(n){var r,i;if(n=n.replace(/\u200B/g,""),r=[/^[*]$/,/^[-]$/],!t.isNullOrUndefined(n))for(i=0;i<r.length;i++)if(r[i].test(n))return!0;return!1},n.prototype.hasMultipleTextNode=function(n){var r,i;if(this.isMention=!1,n&&n.startContainer&&n.startContainer.parentNode){if(r=n.startContainer.parentNode,n.startContainer.previousElementSibling&&n.startContainer.previousElementSibling.classList.contains("e-mention-chip")&&!n.startContainer.previousElementSibling.isContentEditable)return this.isMention=!0,!0;if("BR"===this.parent.enterKey||t.closest(r,"table"))return!1;for(var f=r.childNodes,e=[],u=0;u<f.length;u++)if(i=f[u],i&&i.nodeType===Node.TEXT_NODE&&(e.push(i),e.length>1))return!0}return!1},n.prototype.isCursorAtBlockStart=function(n){var r,u,e,i,f,t;if(0!==n.startOffset||0!==n.endOffset||(r=n.startContainer,u=r.nodeType===Node.TEXT_NODE?r.parentElement:r,"TD"===u.tagName||"TH"===u.tagName))return!1;if(e=this.parent.formatter.editorManager.domNode.getImmediateBlockNode(u),r===e&&0===n.startOffset)return!0;for(i=u,f=!1;i&&i!==e;){for(t=i.previousSibling;t;){if(t.nodeType!==Node.TEXT_NODE||t.textContent&&t.textContent.trim()){f=!0;break}t=t.previousSibling}if(f)break;i=i.parentNode}return!f},n.prototype.backSpaceCleanup=function(n,i){var k=!1,d=!0,r,f,y,o,c,et,l,u,w,h,a,ot,b,v,s;t.isNullOrUndefined(i.startContainer.previousSibling)||"SPAN"!==i.startContainer.previousSibling.nodeName||(d="false"!==i.startContainer.previousSibling.contentEditable);var e="#text"===i.startContainer.nodeName?i.startContainer.parentElement:i.startContainer,st=!t.closest("#text"===i.startContainer.nodeName?i.startContainer.parentElement:i.startContainer,"li")||"li"!==e.nodeName&&t.isNullOrUndefined(e.previousSibling),ht=this.isCursorAtBlockStart(i);if("Backspace"===n.args.code&&8===n.args.keyCode&&ht&&" "!==i.startContainer.textContent&&" "!==i.startContainer.nodeValue&&0===this.parent.getSelection().length&&i.startContainer.textContent.length>0&&d&&st){if(!this.parent.formatter.editorManager.domNode.isBlockNode(e)&&!t.isNullOrUndefined(e.previousSibling)&&"BR"===e.previousSibling.nodeName||!t.isNullOrUndefined(i.startContainer.previousSibling)&&"BR"===i.startContainer.previousSibling.nodeName)return;if(!t.isNullOrUndefined(this.parent.codeBlockModule)){var g=this.parent.formatter.editorManager.domNode.getImmediateBlockNode(i.startContainer),nt=g!==this.parent.inputElement?g:i.startContainer,tt=this.parent.formatter.editorManager.nodeSelection.findFirstContentNode(nt),it=tt&&tt.node===("CODE"===i.startContainer.nodeName?i.startContainer.firstChild:i.startContainer)&&0===i.startOffset,ct=this.parent.formatter.editorManager.codeBlockObj.findParentOrPreviousSiblingCodeBlock(i),lt=this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(nt);if(!t.isNullOrUndefined(ct)&&it||!t.isNullOrUndefined(lt)&&it)return}if(this.rangeElement=this.getRootBlockNode(i.startContainer),"OL"===this.rangeElement.tagName||"UL"===this.rangeElement.tagName)r=this.getRangeLiNode(i.startContainer),r.previousElementSibling&&this.parent.inputElement.contains(r.previousElementSibling)&&r.previousElementSibling.childElementCount>0&&(this.oldRangeElement="BR"===r.previousElementSibling.lastElementChild.nodeName?r.previousElementSibling:r.previousElementSibling.lastChild,!t.isNullOrUndefined(r.lastElementChild)&&"BR"!==r.lastElementChild.nodeName&&t.isNullOrUndefined(r.lastElementChild.previousSibling)&&"#text"!==r.lastChild.nodeName?(this.rangeElement=r.lastElementChild,k=!0):this.rangeElement=r);else{if(this.rangeElement===this.parent.inputElement||"TABLE"===this.rangeElement.tagName||!t.isNullOrUndefined(this.rangeElement.previousElementSibling)&&"TABLE"===this.rangeElement.previousElementSibling.tagName)return;this.oldRangeElement=this.rangeElement.previousElementSibling}if(f=this.parent.formatter.editorManager.domNode.blockNodes(),!t.isNullOrUndefined(f[0])&&i.collapsed&&0===i.startOffset&&0===i.endOffset&&""!==f[0].style.marginLeft&&(f[0].style.marginLeft=parseInt(f[0].style.marginLeft,10)<=20?"":parseInt(f[0].style.marginLeft,10)-20+"px"),y=f[0].previousSibling?f[0].previousSibling:this.findPreviousElementSibling(f[0]),t.isNullOrUndefined(this.oldRangeElement)&&t.isNullOrUndefined(f[0].previousSibling))return;if(y)if(o=y,c=f[0],o.textContent.trim()){this.removeLastBr(o);var rt=this.parent.formatter.editorManager.nodeSelection.findLastTextPosition(o),at=rt.offset,ut=rt.node,ft=Array.from(c.childNodes),p=this.nodeSelectionObj.save(i,this.contentRenderer.getDocument());for(this.isPreviousNodeBrAfterBackSpace&&this.parent.formatter.editorManager.domNode.setMarker(p),et=this.parent.formatter.editorManager.domNode.getImmediateBlockNode(ut),l=0;l<ft.length;l++)et.appendChild(ft[l].cloneNode(!0));this.isPreviousNodeBrAfterBackSpace?(p=this.parent.formatter.editorManager.domNode.saveMarker(p)).restore():this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),ut,at);c.parentNode.removeChild(c);n.args.preventDefault()}else o.parentNode.removeChild(o);else{for("OL"!==this.oldRangeElement.tagName&&"UL"!==this.oldRangeElement.tagName||(this.oldRangeElement=this.oldRangeElement.lastElementChild.lastElementChild?this.oldRangeElement.lastElementChild.lastElementChild:this.oldRangeElement.lastElementChild),u=this.oldRangeElement.lastChild?this.oldRangeElement.lastChild:this.oldRangeElement;3!==u.nodeType&&"#text"!==u.nodeName&&"BR"!==u.nodeName&&!t.isNullOrUndefined(u.lastChild);)u=u.lastChild;if("IMG"===u.nodeName?this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),u.parentElement,u.parentElement.childNodes.length):this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),u,u.textContent.length),w=!1,this.oldRangeElement&&"#text"!==this.oldRangeElement.nodeName&&1===this.oldRangeElement.querySelectorAll("BR").length&&(h=this.oldRangeElement.querySelector("BR"),h&&t.isNullOrUndefined(h.nextSibling)&&(a=h.parentNode,ot=this.oldRangeElement.innerHTML,this.parent.formatter.saveData(ot),t.detach(h),a&&0===a.childNodes.length&&(t.detach(a),w=!0))),!t.isNullOrUndefined(this.rangeElement)&&this.oldRangeElement!==this.rangeElement&&!w){for(;this.rangeElement.firstChild;)"#text"===this.oldRangeElement.nodeName?this.oldRangeElement.parentElement.appendChild(this.rangeElement.childNodes[0]):this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);k?t.detach(this.rangeElement.parentElement):t.detach(this.rangeElement);this.oldRangeElement.normalize()}}}"Backspace"===n.args.code&&8===n.args.keyCode&&i.startContainer.nodeType!==Node.TEXT_NODE&&(b=t.isNullOrUndefined(i.startContainer.childNodes[i.startOffset-1])||t.isNullOrUndefined(i.startContainer.childNodes[i.startOffset-1].isContentEditable)||i.startContainer.childNodes[i.startOffset-1].isContentEditable?null:i.startContainer.childNodes[i.startOffset-1],v=i.startOffset>1?i.startOffset-1:0,b?(b.remove(),n.args.preventDefault()):(e&&""===e.textContent.trim()||i.startContainer.childNodes[v]&&""===i.startContainer.childNodes[v].textContent.trim())&&(s=e&&""===e.textContent.trim()?e:i.startContainer.childNodes[v],uk(s)&&s.previousSibling&&""===s.previousSibling.textContent.trim()&&(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),s.previousSibling,0),t.detach(s),n.args.preventDefault())))},n.prototype.findPreviousElementSibling=function(n){for(var i,t=n;t;){if(i=t.previousElementSibling,i)return i;if((t=t.parentElement)&&t===this.parent.inputElement)return null}return null},n.prototype.getLastNode=function(n){for(;n&&n.lastChild;)n=n.lastChild;for(;n&&n.nodeType===Node.TEXT_NODE&&!n.nodeValue.trim();)n=n.previousSibling;return n},n.prototype.removeLastBr=function(n){var i=this.getLastNode(n);i&&"BR"===i.nodeName&&i.parentNode&&(this.isPreviousNodeBrAfterBackSpace=!t.isNullOrUndefined(i.previousSibling)&&"BR"===i.previousSibling.nodeName,i.parentNode.removeChild(i))},n.prototype.deleteCleanup=function(n,i){var u,a,v=!1,h,c,l,s,r;if((t.isNullOrUndefined(this.parent.codeBlockModule)||(h=this.parent.formatter.editorManager.codeBlockObj.getCodeBlockPosition(i),"Delete"!==n.args.code||t.isNullOrUndefined(this.parent.formatter.editorManager.codeBlockObj.isValidCodeBlockStructure(i.startContainer))&&(t.isNullOrUndefined(h.nextSiblingCodeBlockElement)||!h.cursorAtLastPosition)))&&"Delete"===n.args.code&&46===n.args.keyCode&&0!==this.parent.contentModule.getText().trim().replace(/(\r\n|\n|\r|\t)/gm,"").replace(/\u200B/g,"").length&&0===this.parent.getSelection().length&&"TD"!==i.startContainer.parentElement.tagName&&"TH"!==i.startContainer.parentElement.tagName){if(this.deleteRangeElement=a=this.getRootBlockNode(i.startContainer),"OL"===this.deleteRangeElement.tagName||"UL"===this.deleteRangeElement.tagName)(u=this.getRangeLiNode(i.startContainer)).nextElementSibling&&u.nextElementSibling.childElementCount>0&&!u.nextElementSibling.querySelector("BR")?t.isNullOrUndefined(u.lastElementChild)?this.deleteRangeElement=u:(this.deleteRangeElement=u.lastElementChild,v=!0):this.deleteRangeElement=this.getRangeElement(u);else if(3===this.deleteRangeElement.nodeType||"TABLE"===this.deleteRangeElement.tagName||!t.isNullOrUndefined(this.deleteRangeElement.nextElementSibling)&&"TABLE"===this.deleteRangeElement.nextElementSibling.tagName)return;if(c=!1,this.deleteRangeElement.querySelectorAll("img").length>0&&""===this.deleteRangeElement.textContent.trim()&&(c=!0),this.getCaretIndex(i,this.deleteRangeElement)!==this.deleteRangeElement.textContent.length||c||"HR"===this.deleteRangeElement.tagName)this.deleteRangeElement=null;else{if(this.deleteRangeElement.lastElementChild&&"HR"===this.deleteRangeElement.lastElementChild.tagName)return void(this.deleteRangeElement=null);if(t.isNullOrUndefined(u)?this.deleteOldRangeElement=this.deleteRangeElement.nextElementSibling:(l=this.findNextHierarchySibling(u),this.deleteOldRangeElement=l?this.getRangeElement(l):a.nextElementSibling),t.isNullOrUndefined(this.deleteOldRangeElement))return;0===i.startOffset&&1===i.endOffset&&"IMG"===this.deleteRangeElement.childNodes[0].nodeName?(this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement,0,1),this.isImageDelete=!0):(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement.childNodes.length),this.isImageDelete=!1);var e=this.deleteRangeElement.querySelector("BR"),f=this.deleteRangeElement.lastChild,o=void 0;if(f&&(o=f.parentNode),e&&e.classList.contains("e-rte-image-remove-focus"))return void t.removeClass([e],["e-rte-image-focus"]);if(e&&f&&"BR"===f.nodeName){if(t.detach(f),t.isNullOrUndefined(o)||0!==o.childNodes.length||t.detach(o),!t.isNullOrUndefined(this.deleteRangeElement)&&this.deleteOldRangeElement.tagName&&("OL"===this.deleteOldRangeElement.tagName||"UL"===this.deleteOldRangeElement.tagName)&&this.deleteOldRangeElement!==this.deleteRangeElement&&!this.parent.contentModule.getEditPanel().contains(this.deleteRangeElement))if(s=this.deleteOldRangeElement.querySelector("li"),s){for(r=s;r&&r.firstChild&&r.firstChild.nodeType!==Node.TEXT_NODE;)r=r.firstChild;r&&r.firstChild&&r.firstChild.nodeType===Node.TEXT_NODE?this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),r.firstChild,0):this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),s,0)}else this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),this.deleteOldRangeElement,this.deleteOldRangeElement,0,0);n.args.preventDefault()}if(!t.isNullOrUndefined(this.deleteRangeElement)&&"OL"!==this.deleteOldRangeElement.tagName&&"UL"!==this.deleteOldRangeElement.tagName&&this.deleteOldRangeElement!==this.deleteRangeElement&&this.parent.contentModule.getEditPanel().contains(this.deleteRangeElement)){for(;this.deleteOldRangeElement.firstChild;)this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);v?t.detach(this.deleteOldRangeElement.parentElement):t.detach(this.deleteOldRangeElement);this.deleteRangeElement.normalize()}else this.deleteRangeElement=null,this.deleteOldRangeElement=null}}},n.prototype.findNextHierarchySibling=function(n){var t,i;if("LI"===n.nodeName){if(n.nextElementSibling)return n.nextElementSibling;if(t=n.parentElement,t.nextElementSibling&&"LI"===t.nextElementSibling.nodeName)return t.nextElementSibling;if("UL"===t.tagName||"OL"===t.tagName){if(i=t.parentElement,i&&i.nextElementSibling)return i.nextElementSibling;if(i&&"LI"===i.nodeName)return this.findNextHierarchySibling(i)}return null}return n.nextElementSibling},n.prototype.getCaretIndex=function(n,t){var r=0,i;return 0!==this.parent.contentModule.getDocument().getSelection().rangeCount&&(i=n.cloneRange(),i.selectNodeContents(t),i.setEnd(n.endContainer,n.endOffset),r=i.toString().length),r},n.prototype.getRangeElement=function(n){return n.childNodes.length<=1&&n.lastElementChild?"BR"===n.lastElementChild.tagName?n.lastElementChild.previousElementSibling?n.lastElementChild.previousElementSibling:n:n.lastElementChild:n},n.prototype.getRootBlockNode=function(n){for(;n&&this.parent&&this.parent.inputElement!==n&&n.parentElement!==this.parent.inputElement;n)n=n.parentElement;return n},n.prototype.getRangeLiNode=function(n){for(var t=n.parentElement;t!==this.parent.inputElement&&(1!==t.nodeType||"LI"!==t.tagName);)t=t.parentElement;return t},n.prototype.onPaste=function(n){var y=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi),u,s,f,a,e;if(n.text.match(y)){if(n.isWordPaste)return;n.args.preventDefault();for(var p=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),w=(this.parent.formatter.editorManager.nodeSelection.save(p,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),b=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),h=n.text.split("\n"),c="",r=0;r<h.length;r++)if(""===h[r].trim())c+=nk(this.parent);else{for(var o="",v=!0,l=h[r].split(" "),i=0;i<l.length;i++)""===l[i].trim()?o+=v?"&nbsp;":" ":(v=!1,o+=l[i]+" ");c+=0===r?"<span>"+o.trim()+"<\/span>":"<p>"+o.trim()+"<\/p>"}for(u=this.parent.createElement("div"),u.setAttribute("class","pasteContent"),u.style.display="inline",u.innerHTML=c.replace("&para","&amp;para"),s=u.querySelectorAll("span, p"),r=0;r<s.length;r++){for(f=s[r].innerHTML.split(" "),a="",i=0;i<f.length;i++)a+=f[i].match(w)||f[i].match(b)?'<a class="e-rte-anchor" href="'+f[i]+'" title="'+f[i]+'" target="_blank" aria-label="'+this.parent.serviceLocator.getService("rteLocale").getConstant("linkAriaLabel")+'">'+f[i]+" <\/a>":f[i]+" ";s[r].innerHTML=a.trim()}e=u.childNodes[0];t.isNullOrUndefined(e)||t.isNullOrUndefined(e.childNodes[0])||"SPAN"!==e.nodeName||"A"!==e.childNodes[0].nodeName||(u.innerHTML=u.innerHTML.replace("<span>","").replace("<\/span>",""));t.isNullOrUndefined(this.parent.pasteCleanupModule)?this.parent.formatter.editorManager.execCommand("insertHTML",null,null,null,u):n.callBack(u.innerHTML)}},n.prototype.spaceLink=function(n){var t=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),e,o,s;if(t.startContainer.nodeType===Node.TEXT_NODE){var u=this.nodeSelectionObj.getParentNodeCollection(t),f=t.startContainer.textContent.substr(0,t.endOffset),r=f.split(" "),i=r[r.length-1],h=t.startOffset-(f.length-r[r.length-1].length);i=i.slice(0,h);e=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);u[0]&&"A"!==u[0].nodeName&&i.match(e)&&(o=this.nodeSelectionObj.save(t,this.parent.contentModule.getDocument()),s={url:i.indexOf("http")>-1?i:"http://"+i,selection:o,selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(t),text:i,title:"",target:"_blank"},this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},n,s))}},n.prototype.onToolbarClick=function(n){var r,u,f,a=this,i=n.item,o=t.closest(n.originalEvent.target,".e-rte-quick-popup"),v=n.originalEvent.target,h,c,l,e;if(this.parent.notify(cs,{target:v}),"FormatPainter"!==i.command)if(h=!t.isNullOrUndefined(o)&&o.classList.contains("e-rte-quick-popup")&&1===o.querySelectorAll(".e-text-quicktoolbar").length,!o||o.classList.contains("e-rte-inline-popup")||h){c=document.getElementById(this.parent.getID()+"_rtelink");l=document.getElementById(this.parent.getID()+"_image");switch("SourceCode"!==i.subCommand&&"Preview"!==i.subCommand&&"FontColor"!==i.subCommand&&"BackgroundColor"!==i.subCommand&&"NumberFormatList"!==i.subCommand&&"BulletFormatList"!==i.subCommand&&(e=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),t.isNullOrUndefined(c)&&t.isNullOrUndefined(l)&&(r=this.nodeSelectionObj.save(e,this.parent.contentModule.getDocument())),u=this.nodeSelectionObj.getNodeCollection(e),f=this.nodeSelectionObj.getParentNodeCollection(e)),i.subCommand){case"Maximize":this.parent.notify(eo,{args:n});break;case"Minimize":this.parent.notify(oo,{args:n});break;case"CreateLink":this.parent.notify(lo,{member:"link",args:n,selectNode:u,selection:r,selectParent:f});break;case"RemoveLink":this.parent.notify(ao,{member:"link",args:n,selectNode:u,selection:r,selectParent:f});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(af,{member:"image",args:n,selectNode:u,selection:r,selectParent:f});break;case"Audio":this.parent.notify(yo,{member:"audio",args:n,selectNode:u,selection:r,selectParent:f});break;case"Video":this.parent.notify(po,{member:"video",args:n,selectNode:u,selection:r,selectParent:f});break;case"CreateTable":this.parent.notify(dc,{member:"table",args:n,selection:r});break;case"SourceCode":this.parent.notify(lu,{member:"viewSource",args:n});break;case"Preview":this.parent.notify(vf,{member:"updateSource",args:n});break;case"FontColor":case"BackgroundColor":break;case"File":this.parent.notify(go,{member:"fileManager",args:n,selectNode:u,selection:r,selectParent:f});break;case"EmojiPicker":this.parent.notify(es,{member:"emojiPicker",args:n});break;case"ImportWord":this.parent.notify(dh,{});break;case"ExportWord":this.parent.notify(fo,{member:"ExportWord",args:n});break;case"CodeBlock":this.parent.notify(gh,{member:"codeBlock",args:n});break;case"ExportPdf":this.parent.notify(fo,{member:"ExportPdf",args:n});break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}!t.isNullOrUndefined(this.parent.quickToolbarModule)&&(t.isNullOrUndefined(this.parent.quickToolbarModule.imageQTBar)&&"Image"===i.subCommand||t.isNullOrUndefined(this.parent.quickToolbarModule.audioQTBar)&&"Audio"===i.subCommand||t.isNullOrUndefined(this.parent.quickToolbarModule.videoQTBar)&&"Video"===i.subCommand||t.isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar)&&"CreateLink"===i.subCommand)&&this.parent.notify(ko,{})}else"SourceCode"!==i.subCommand&&"Preview"!==i.subCommand&&"FontColor"!==i.subCommand&&"BackgroundColor"!==i.subCommand&&(s()&&"Images"===i.command&&this.nodeSelectionObj.restore(),e=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),r=this.nodeSelectionObj.save(e,this.parent.contentModule.getDocument()),u=this.nodeSelectionObj.getNodeCollection(e),f=this.nodeSelectionObj.getParentNodeCollection(e)),"Images"===i.command&&this.parent.notify(ic,{member:"image",args:n,selectNode:u,selection:r,selectParent:f}),"Audios"===i.command&&this.parent.notify(rc,{member:"audio",args:n,selectNode:u,selection:r,selectParent:f}),"Videos"===i.command&&this.parent.notify(uc,{member:"video",args:n,selectNode:u,selection:r,selectParent:f}),"Links"===i.command&&this.parent.notify(fc,{member:"link",args:n,selectNode:u,selection:r,selectParent:f}),"Table"===i.command&&this.parent.notify(gc,{member:"table",args:n,selectNode:u,selection:r,selectParent:f});else 1===n.originalEvent.detail?(clearTimeout(this.clickTimeout),this.clickTimeout=setTimeout(function(){a.parent.notify(bl,{member:"formatPainter",args:n})},200)):(clearTimeout(this.clickTimeout),this.parent.notify(kl,{member:"formatPainter",args:n}))},n.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(o.Content,new tut(this.parent)):this.renderFactory.addRenderer(o.Content,new iy(this.parent))},n.prototype.removeEventListener=function(){this.parent.off(a,this.render);this.parent.off(k,this.onPropertyChanged);this.parent.off(wh,this.onToolbarClick);this.parent.off(u,this.destroy);this.parent.off(y,this.onKeyDown);this.parent.off(hf,this.instantiateRenderer);this.parent.off(bf,this.selectAll);this.parent.off(au,this.selectRange);this.parent.off(kf,this.getSelectedHtml);this.parent.off(ft,this.onSelectionSave);this.parent.off(lt,this.onSelectionRestore);this.parent.off(ne,this.updateReadOnly);this.parent.off(vu,this.onPaste);this.parent.off(sf,this.isTableClassAdded)},n.prototype.render=function(){var n,i,r;this.contentRenderer=this.renderFactory.getRenderer(o.Content);n=this.contentRenderer.getEditPanel();i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};t.isNullOrUndefined(this.parent.formatter)?(r=new wut({currentDocument:this.contentRenderer.getDocument(),element:n,options:i,formatPainterSettings:this.parent.formatPainterSettings}),this.parent.setProperties({formatter:r},!0)):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),i,this.parent.formatPainterSettings);this.parent.enableXhtml&&this.parent.notify(ie,{});this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new fd(this.parent));this.parent.inlineMode.enable&&(t.isNullOrUndefined(this.parent.fontFamily.default)||(n.style.fontFamily=this.parent.fontFamily.default),t.isNullOrUndefined(this.parent.fontSize.default)||(n.style.fontSize=this.parent.fontSize.default));this.parent.notify(b,{})},n.prototype.onPropertyChanged=function(n){if(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.newProp.toolbarSettings)||t.isNullOrUndefined(n.newProp.toolbarSettings.enable)||(this.toolbarUpdate=new fd(this.parent)),!t.isNullOrUndefined(n.newProp.formatter)){var i=this.contentRenderer.getEditPanel(),r={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(i,this.contentRenderer.getDocument(),r)}},n.prototype.getModuleName=function(){return"htmlEditor"},n.prototype.selectAll=function(){var n=db(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());n.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),n[0],n[n.length-1],0,n[n.length-1].textContent.length)},n.prototype.selectRange=function(n){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),n.range)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},n.prototype.tableSelectionKeyAction=function(n){for(var t,u=n.args,r=this.parent.inputElement.querySelectorAll(".e-cell-select"),i=0;i<r.length;i++)t=r[i],p([t],[nt,dv,kv]),0===i?(t.innerHTML=32===u.keyCode?"&#8203;<br>":"<br>",this.nodeSelectionObj.setCursorPoint(this.parent.contentModule.getDocument(),t.firstChild,0)):t.innerHTML="<br>"},n.prototype.marginTabAdd=function(n,t){for(var i,u,r=0;r<t.length;r++)i=t[r],i.closest("li")||(i.style.marginLeft?(u=parseInt(i.style.marginLeft,10),n?u-=20:u+=20,i.style.marginLeft=u.toString()+"px","0px"===i.style.marginLeft&&i.removeAttribute("style")):n||(i.style.marginLeft="20px"))},n}(),kut=function(){function n(n,t){this.parent=n;this.pasteModel=t;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(f,this.destroy)},n.prototype.updatePasteCleanupModel=function(n){this.pasteModel=n},n.prototype.extractFileFromClipboard=function(n){if(!n||!n.args||!n.args.clipboardData||0===n.args.clipboardData.items.length)return null;var i=n.args.clipboardData.items,r=i[0].getAsFile();return null!==r?r:t.isNullOrUndefined(i[1])?null:i[1].getAsFile()},n.prototype.splitBreakLine=function(n){for(var o,t,u=n.split("\r\n\r\n"),f="",s=this.getHtmlNode(!0),r=this.getHtmlNode(!1),e="BR"===this.pasteModel.enterKey,i=0;i<u.length;i++)o=u[i],t=this.normalizeSpacesForHtml(o).replace(/\r\n|\n/g,"<br>"),0===i?f+=e&&(i!==u.length-1||t.endsWith("<br>"))?i!==u.length-1?t+r+r:t+r:t:e?f+=t.endsWith("<br>")||""===t&&i===u.length-1?t+r:i===u.length-1?t:t+r+r:(""===t.trim()&&(f+="<br>"),f+=s+t+r);return f},n.prototype.getHtmlNode=function(n){return"P"===this.pasteModel.enterKey?n?"<p>":"<\/p>":"DIV"===this.pasteModel.enterKey?n?"<div>":"<\/div>":n?"":"<br>"},n.prototype.normalizeSpacesForHtml=function(n){var t="",r,i,u;if(""===n)return n;for(r=n.split(" "),i=0;i<r.length;i++)u=r[i],""===u?t+="&nbsp;":"\t"===u?t+="&nbsp;&nbsp;&nbsp;&nbsp;":(i>0&&i<r.length&&(t+=" "),t+=u);return(t=t.replace(/\t/g,"&nbsp;&nbsp;&nbsp;&nbsp;")).replace(/&nbsp;&nbsp;/g,"&nbsp; ")},n.prototype.base64ToFile=function(n,i){for(var e,o=n.split(","),r=o[0].match(/:(.*?);/)[1].split("/")[1],s=atob(o[1]),u=s.length,f=new Uint8Array(u);u--;)f[u]=s.charCodeAt(u);return t.Browser.isIE||navigator.appVersion.indexOf("Edge")>-1?(e=new Blob([f],{type:r}),t.extend(e,{name:i+"."+(t.isNullOrUndefined(r)?"":r)}),e):new File([f],i+"."+(t.isNullOrUndefined(r)?"":r),{type:r})},n.prototype.setImageOpacity=function(n){n.style.opacity="0.5"},n.prototype.createPopupElement=function(){var n=t.createElement("div");return this.pasteModel.rootContainer.appendChild(n),n},n.prototype.getBlob=function(n){for(var r,u,i=0;i<n.length;i++)r=n[i].getAttribute("src"),!t.isNullOrUndefined(r)&&r.split(",")[0].indexOf("base64")>=0&&(u=URL.createObjectURL(kr(r)),n[i].setAttribute("src",u))},n.prototype.cleanAppleClass=function(n){for(var r=n.querySelectorAll("br.Apple-interchange-newline"),i=0;i<r.length;i++)t.detach(r[i]);return n},n.prototype.cleanupDeniedTagsAndAttributes=function(n,t){return null!==this.pasteModel.pasteCleanupSettings.deniedTags&&(n=this.deniedTags(n)),(t||null!==this.pasteModel.pasteCleanupSettings.deniedAttrs)&&(n=this.deniedAttributes(n,t)),n},n.prototype.deniedTags=function(n){var i=t.isNullOrUndefined(this.pasteModel.pasteCleanupSettings.deniedTags)?[]:this.pasteModel.pasteCleanupSettings.deniedTags.slice(),u,e,f,r,o;for(i=this.attributesfilter(i),i=this.tagGrouping(i),u=0;u<i.length;u++)for(e=n.querySelectorAll(i[u]),f=e.length-1;f>=0;f--){for(r=e[f],o=r.parentNode;r.firstChild;)o.insertBefore(r.firstChild,r);o.removeChild(r)}return n},n.prototype.attributesfilter=function(n){for(var i,s,e,h,c,t=0;t<n.length;t++)if(i=n[t],i.split("[").length>1){for(var o=i.split("[")[1].split("]")[0].split(","),r=[],u=[],f=0;f<o.length;f++)s=o[f],o[f].indexOf("!")<0?r.push(s.trim()):u.push(s.split("!")[1].trim());e=r.length>1?r.join("]["):r.join();h=u.length>1?u.join("]["):u.join();h.length>0?(c=""!==e?i.split("[")[0]+"["+e+"]":i.split("[")[0],n[t]=c+":not(["+h+"])"):n[t]=i.split("[")[0]+"["+e+"]"}return n},n.prototype.tagGrouping=function(n){for(var i,r,t,u=n.slice(),o=Object.keys(vk),f=o.map(function(n){return vk[""+n]}),s=[],e=0;e<u.length;e++)if(i=u[e],r=o.indexOf(i),i.split("[").length>1&&(i=i.split("[")[0].trim()),o.indexOf(u[e])>-1)for(t=0;t<f[r].length;t++)u.indexOf(f[r][t])<0&&s.indexOf(f[r][t])<0&&s.push(f[r][t]);return n.concat(s)},n.prototype.deniedAttributes=function(n,i){var u=t.isNullOrUndefined(this.pasteModel.pasteCleanupSettings.deniedAttrs)?[]:this.pasteModel.pasteCleanupSettings.deniedAttrs.slice(),r;for(i&&u.push("style"),r=0;r<u.length;r++)for(var e=u[r],o=n.querySelectorAll("["+e+"]"),f=0;f<o.length;f++)o[f].removeAttribute(e);return n},n.prototype.allowedStyle=function(n){var s=t.isNullOrUndefined(this.pasteModel.pasteCleanupSettings.allowedStyleProps)?[]:this.pasteModel.pasteCleanupSettings.allowedStyleProps.slice(),f,i;for(s.push("list-style-type","list-style"),f=n.querySelectorAll("[style]"),i=0;i<f.length;i++){for(var h,e=f[i],r=[],o=e.getAttribute("style").split(";"),u=0;u<o.length;u++)s.indexOf(o[u].split(":")[0].trim())>=0&&r.push(o[u]);e.removeAttribute("style");(h=""===r.join(";").trim()?r.join(";"):r.join(";")+";")&&(e.style.cssText+=h)}return n},n.prototype.setImageClassAndProps=function(n){for(var i=n.getElementsByTagName("img"),t=0,r=i.length;t<r;t++)null!==i[t].getAttribute("src")&&(i[t].className+=" pasteContent_Img"),this.setImageProperties(i[t]);this.addTempClass(n)},n.prototype.setImageProperties=function(n){"auto"!==this.pasteModel.insertImageSettings.width&&n.setAttribute("width",this.pasteModel.insertImageSettings.width);"0"!==this.pasteModel.insertImageSettings.minWidth&&0!==this.pasteModel.insertImageSettings.minWidth&&(n.style.minWidth=this.pasteModel.insertImageSettings.minWidth.toString());null!==this.pasteModel.insertImageSettings.maxWidth&&(n.style.maxWidth=this.pasteModel.getInsertImgMaxWidth().toString());"auto"!==this.pasteModel.insertImageSettings.height&&n.setAttribute("height",this.pasteModel.insertImageSettings.height);"0"!==this.pasteModel.insertImageSettings.minHeight&&0!==this.pasteModel.insertImageSettings.minHeight&&(n.style.minHeight=this.pasteModel.insertImageSettings.minHeight.toString());null!==this.pasteModel.insertImageSettings.maxHeight&&(n.style.maxHeight=this.pasteModel.insertImageSettings.maxHeight.toString())},n.prototype.addTempClass=function(n){for(var i=n.children,t=0;t<i.length;t++)i[t].classList.add("pasteContent_RTE")},n.prototype.hasPictureElement=function(n){return n.getElementsByTagName("picture").length>0},n.prototype.processPictureElement=function(n){for(var i,r,f,s,e=n.querySelectorAll("picture"),h=this.pasteModel.getDocument().baseURI,t=0;t<e.length;t++)if(i=e[t].querySelector("img"),r=e[t].querySelectorAll("source"),i&&i.getAttribute("src"))for(var o=i.getAttribute("src"),c=o.indexOf("http")>-1?new URL(o):new URL(o,h),u=0;u<r.length;u++)f=r[u].getAttribute("srcset"),f&&-1===f.indexOf("http")&&(s=c.origin+f,r[u].setAttribute("srcset",s))},n.prototype.hasContentToPaste=function(n){var t=""!==n.textContent&&""!==n.textContent.replace(/\u200B/g,"").trim(),i=n.getElementsByTagName("img").length>0,r=n.getElementsByTagName("table").length>0;return t||i||r},n.prototype.collectBase64ImageFiles=function(n){var s=[],u,r,o;if(!t.isNullOrUndefined(n.querySelector("img"))){for(var f=n.querySelectorAll("img"),e=[],h=[],c=[],i=0;i<f.length;i++)u=f[i].getAttribute("src"),u&&u.split(",")[0].indexOf("base64")>=0&&(e.push(u),h.push(t.getUniqueID("rte_image")),c.push(f[i]));for(r=[],o=void 0,i=0;i<e.length;i++)r.push(this.base64ToFile(e[i],h[i])),o={name:r[i].name,rawFile:r[i],size:r[i].size,type:r[i].type,status:"",validationMessages:{minSize:"",maxSize:""},statusCode:"1"},s.push(o)}return s},n.prototype.addTableClass=function(n,i){for(var f,e=n.querySelectorAll("table"),u=0;u<e.length;u++){var r=e[u],o=r.parentElement,s=o&&"FIGURE"===o.nodeName;r.classList.length>0&&r.classList.contains("e-rte-custom-table")||(this.pasteModel.pasteCleanupSettings.keepFormat&&i&&!s?r.classList.add("e-rte-paste-"+i+"-table"):r.classList.contains("e-rte-table")||r.classList.add("e-rte-table"),f=r.nextSibling,t.isNullOrUndefined(r.nextElementSibling)&&f&&""===f.textContent.trim()&&t.detach(f))}return n},n.prototype.removeTempClass=function(){for(var t=this.pasteModel.getEditPanel().querySelectorAll(".pasteContent_RTE"),n=0;n<t.length;n++)t[n].classList.remove("pasteContent_RTE"),""===t[n].getAttribute("class")&&t[n].removeAttribute("class")},n.prototype.cropImageHandler=function(n){var t=n.querySelectorAll(".e-img-cropped");t.length>0?this.processCroppedImages(t):this.handleBlobOrUpload()},n.prototype.processCroppedImages=function(n){for(var t=this,r=function(i){var e=n[i],o=e.getAttribute("src"),r,f;o&&o.split(",")[0].indexOf("base64")>=0&&(r=u.pasteModel.getCropImageData()[i],f=new Image,f.src=o,f.onload=function(){var s=r.goalWidth/f.naturalWidth,h=r.goalHeight/f.naturalHeight,c=r.cropLength/s,l=r.cropTop/h,i=(r.goalWidth-r.cropLength-r.cropR)/s,u=(r.goalHeight-r.cropTop-r.cropB)/h,n=document.createElement("canvas"),o;n.width=i;n.height=u;o=n.getContext("2d");o&&(o.drawImage(f,c,l,i,u,0,0,i,u),e.setAttribute("src",n.toDataURL("image/png")),e.classList.remove("e-img-cropped"),t.pasteModel.imageUpload(),t.pasteModel.iframeSettings.enable&&t.pasteModel.updateValue())})},u=this,i=0;i<n.length;i++)r(i)},n.prototype.handleBlobOrUpload=function(){var n=this,i=this.pasteModel.getEditPanel(),r=i.querySelectorAll("img");r.length>0&&r[0].src.startsWith("blob")&&!t.isNullOrUndefined(this.pasteModel.insertImageSettings.saveUrl)&&!t.isNullOrUndefined(this.pasteModel.insertImageSettings.path)?(this.convertBlobToBase64(i),this.iframeUploadTime=setTimeout(function(){n.pasteModel.imageUpload();n.pasteModel.iframeSettings.enable&&n.pasteModel.updateValue()},20)):(this.pasteModel.imageUpload(),this.pasteModel.iframeSettings.enable&&!this.pasteModel.enableXhtml&&this.pasteModel.updateValue())},n.prototype.convertBlobToBase64=function(n){for(var t=n.querySelectorAll("img"),r=function(n){var r=t[n].getAttribute("src"),i,u;r&&r.startsWith("blob")&&(i=new Image,u=function(){var r=document.createElement("canvas"),e=r.getContext("2d"),f;r.width=i.width;r.height=i.height;e.drawImage(i,0,0);f=r.toDataURL("image/png");t[n].src=f;i.removeEventListener("load",u)},i.src=r,i.addEventListener("load",u))},i=0;i<t.length;i++)r(i)},n.prototype.destroy=function(){this.iframeUploadTime&&(clearTimeout(this.iframeUploadTime),this.iframeUploadTime=null);this.removeEventListener()},n}(),pct=function(){function n(n,t){this.isNotFromHtml=!1;this.containsHtml=!1;this.cropImageData=[];this.plainTextContent="";this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.i10n=t.getService("rteLocale");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener();this.isDestroyed=!1}return n.prototype.addEventListener=function(){this.nodeSelectionObj=new st(this.parent.inputElement);this.parent.isDestroyed||(this.parent.on(nl,this.pasteClean,this),this.parent.on(b,this.bindOnEnd,this),this.parent.on(w,this.setCssClass,this),this.parent.on(u,this.destroy,this),this.parent.on(gr,this.docClick,this),this.parent.on(df,this.updatePasteCleanupProperty,this))},n.prototype.destroy=function(){this.isDestroyed||(this.fireFoxUploadTime&&(clearTimeout(this.fireFoxUploadTime),this.fireFoxUploadTime=null),this.refreshPopupTime&&(clearTimeout(this.refreshPopupTime),this.refreshPopupTime=null),this.popupCloseTime&&(clearTimeout(this.popupCloseTime),this.popupCloseTime=null),this.failureTime&&(clearTimeout(this.failureTime),this.failureTime=null),this.removeEventListener(),this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.popupObj=null),this.uploadObj&&!this.uploadObj.isDestroyed&&(this.uploadObj.destroy(),this.uploadObj=null),this.keepRadioButton&&!this.keepRadioButton.isDestroyed&&(this.keepRadioButton.destroy(),this.keepRadioButton=null),this.cleanRadioButton&&!this.cleanRadioButton.isDestroyed&&(this.cleanRadioButton.destroy(),this.cleanRadioButton=null),this.plainTextRadioButton&&!this.plainTextRadioButton.isDestroyed&&(this.plainTextRadioButton.destroy(),this.plainTextRadioButton=null),this.isDestroyed=!0,this.plainTextContent="")},n.prototype.removeEventListener=function(){this.parent.off(nl,this.pasteClean);this.parent.off(w,this.setCssClass);this.parent.off(u,this.destroy);this.parent.off(gr,this.docClick);this.parent.off(b,this.bindOnEnd);this.parent.off(df,this.updatePasteCleanupProperty)},n.prototype.bindOnEnd=function(){if("HTML"===this.parent.editorMode&&this.parent.formatter&&this.parent.formatter.editorManager&&this.parent.contentModule){var n=this.getPasteCleanupModel();this.parent.formatter.editorManager.pasteObj=this.pasteObj=new kut(this.parent.formatter.editorManager,n)}},n.prototype.getPasteCleanupModel=function(){var n=this;return{rteElement:this.parent.element,enterKey:this.parent.enterKey,rootContainer:this.parent.rootContainer,enableXhtml:this.parent.enableXhtml,iframeSettings:this.parent.iframeSettings,pasteCleanupSettings:this.parent.pasteCleanupSettings,insertImageSettings:this.parent.insertImageSettings,getInsertImgMaxWidth:function(){return n.parent.getInsertImgMaxWidth()},getDocument:function(){return n.contentModule?n.contentModule.getDocument():n.parent.contentModule.getDocument()},getEditPanel:function(){return n.contentModule?n.contentModule.getEditPanel():n.parent.contentModule.getEditPanel()},updateValue:function(){n.parent.updateValue()},imageUpload:function(){n.imgUploading(n.parent.inputElement)},getCropImageData:function(){return n.getCropImageData()}}},n.prototype.updatePasteCleanupProperty=function(){var n=this.getPasteCleanupModel();t.isNullOrUndefined(this.pasteObj)||this.pasteObj.updatePasteCleanupModel(n)},n.prototype.pasteClean=function(n){var r={requestType:"Paste",editorMode:this.parent.editorMode,event:n},i=null,u=this.parent.insertImageSettings.allowedTypes;n.args&&!t.isNullOrUndefined(n.args.clipboardData)&&(i=n.args.clipboardData.getData("text/html"),n.args.clipboardData.getData("text/plain")&&(this.plainTextContent=n.args.clipboardData.getData("text/plain")));n.args&&null!==i&&"HTML"===this.parent.editorMode&&this.processHtmlPaste(n,i,r,u,void 0)},n.prototype.processHtmlPaste=function(n,t,i,r,u){var f=t,e;if(0===t.length){if(e=this.handleEmptyHtmlValue(n,t,i,r,u),f=e.value,!e.shouldContinue)return!1}else t.length>0&&(f=this.handleNonEmptyHtmlValue(n,t,i));return null!==f&&""!==f&&(f=f.replace(/<base[^>]*>/g,"")),this.prepareAndInsertContent(n,f,i),!0},n.prototype.handleEmptyHtmlValue=function(n,t,i,r,u){var s=new RegExp(/<\/[a-z][\s\S]*>/i),f=n.args.clipboardData.getData("text/plain"),e,o,h;return(this.parent.trigger(cw,{value:f}),this.isNotFromHtml=""!==f,f=(f=f.replace(/</g,"&lt;")).replace(/>/g,"&gt;"),this.containsHtml=s.test(f),this.plainTextContent=f,e=this.pasteObj.extractFileFromClipboard(n),e&&(o=e.name,h=o.substring(o.lastIndexOf(".")),this.isInvalidImageType(h,r)))?(n.args.preventDefault(),{value:f,shouldContinue:!1}):this.processPasteWithImage(n,e,f,i,u,s)},n.prototype.isInvalidImageType=function(n,t){return t.every(function(t){return t.toLowerCase()!==n})},n.prototype.processPasteWithImage=function(n,t,i,r,u,f){var o=this,e=i,s;return(this.parent.notify(vu,{file:t,args:n.args,text:e,callBack:function(t){"object"==typeof(u=t)?o.parent.formatter.editorManager.execCommand("Images","Image",n.args,o.imageFormatting.bind(o,r),"pasteCleanup",u,"pasteCleanupModule"):e=u}}),f.test(e))||(s=this.parent.createElement("div"),s.innerHTML=this.pasteObj.splitBreakLine(e),e=s.innerHTML),{value:e,shouldContinue:!0}},n.prototype.handleNonEmptyHtmlValue=function(n,t,i){var u=this,r=t;return this.parent.trigger(cw,{value:r}),this.parent.formatter.editorManager.observer.notify(cv,{args:n.args,text:n.text,allowedStylePropertiesArray:this.parent.pasteCleanupSettings.allowedStyleProps,callBack:function(n,t,f){i.pasteTableSource=f;r=n.trim();u.cropImageData=t}}),r},n.prototype.prepareAndInsertContent=function(n,i,r){var e,s,u;this.contentModule=this.renderFactory.getRenderer(o.Content);e=this.contentModule.getDocument();s=this.nodeSelectionObj.getRange(e);this.saveSelection=this.nodeSelectionObj.save(s,e);u=this.parent.createElement("div");u.innerHTML=i;this.processUnsupportedImages(u);var h=u.innerHTML,c=""!==u.textContent||!t.isNullOrUndefined(u.querySelector("img"))||!t.isNullOrUndefined(u.querySelector("table")),f=h;this.parent.notify(dl,{value:h,callBack:function(n){f=n}});f=br(f,this.parent.element);this.handlePasteBasedOnSettings(n,f,r,c)},n.prototype.processUnsupportedImages=function(n){for(var i=n.querySelectorAll(".e-rte-image-unsupported"),t=0;t<i.length;t++)i[t].setAttribute("alt",this.i10n.getConstant("unsupportedImage")),i[t].classList.remove("e-rte-image-unsupported")},n.prototype.handlePasteBasedOnSettings=function(n,t,i,r){this.parent.pasteCleanupSettings.prompt&&!n.isPlainPaste?r&&(n.args.preventDefault(),this.pasteDialog(t,i)):this.parent.pasteCleanupSettings.plainText?(n.args.preventDefault(),this.plainFormatting(t,i)):this.parent.pasteCleanupSettings.keepFormat||n.isPlainPaste?(n.args.preventDefault(),this.formatting(t,!1,i)):(n.args.preventDefault(),this.formatting(t,!0,i))},n.prototype.imgUploading=function(n){var t=n.querySelectorAll(".pasteContent_Img");this.parent.insertImageSettings.saveUrl&&t.length>0?this.processImagesWithSaveUrl(t):"Blob"===this.parent.insertImageSettings.saveFormat&&this.pasteObj.getBlob(t);this.cleanupImageClasses(n,t)},n.prototype.processImagesWithSaveUrl=function(n){for(var r,u,f=[],e=[],o=[],i=0;i<n.length;i++)r=n[i].getAttribute("src"),!t.isNullOrUndefined(r)&&r.split(",")[0].indexOf("base64")>=0&&(f.push(r),e.push(t.getUniqueID("rte_image")),o.push(n[i]));for(u=[],i=0;i<f.length;i++)u.push(this.pasteObj.base64ToFile(f[i],e[i]));for(i=0;i<u.length;i++)this.uploadMethod(u[i],o[i]);t.isNullOrUndefined(this.parent.insertImageSettings.path)&&"Blob"===this.parent.insertImageSettings.saveFormat&&this.pasteObj.getBlob(n)},n.prototype.cleanupImageClasses=function(n,t){for(var r=n.querySelectorAll(".pasteContent_Img"),i=0;i<r.length;i++)r[i].classList.remove("pasteContent_Img"),""===r[i].getAttribute("class").trim()&&t[i].removeAttribute("class")},n.prototype.toolbarEnableDisable=function(n){this.parent.inlineMode.enable||this.parent.toolbarModule.baseToolbar.toolbarObj.disable(n)},n.prototype.uploadMethod=function(n,t){this.pasteObj.setImageOpacity(t);var i=this.pasteObj.createPopupElement();this.createPopupObject(i,t,n);this.createUploader(t);this.initializeUpload(n);this.hideFileSelectWrapper()},n.prototype.createPopupObject=function(n,i,r){var u=this,f=this.parent.createElement("input",{id:this.parent.getID()+"_upload",attrs:{type:"File",name:"UploadFiles"}});this.popupObj=new wi.Popup(n,{relateTo:i,height:"85px",width:"300px",content:f,viewPortElement:this.parent.inputElement,enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){u.parent.isBlur=!1;u.popupObj.destroy();t.detach(u.popupObj.element)}});this.configurePopupStyles();this.schedulePopupRefresh(i,r)},n.prototype.configurePopupStyles=function(){this.popupObj.element.style.display="none";t.addClass([this.popupObj.element],[wu,hb]);t.isNullOrUndefined(this.parent.cssClass)||t.addClass([this.popupObj.element],this.parent.cssClass.replace(/\s+/g," ").trim().split(" "))},n.prototype.schedulePopupRefresh=function(n,t){var i=this,r=t.size>1e6?300:100;this.refreshPopupTime=setTimeout(function(){i.refreshPopup(n,i.popupObj)},r)},n.prototype.createUploader=function(n){var t=this;this.uploadObj=new ot.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},cssClass:ab,dropArea:this.parent.inputElement,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),success:function(i){t.popupClose(t.popupObj,t.uploadObj,n,i)},uploading:function(i){return t.handleUploading(i,n)},beforeUpload:function(n){return t.handleBeforeUpload(n)},failure:function(i){return t.handleFailure(i,n)},canceling:function(){return t.handleCanceling(n)},selected:function(n){n.cancel=!0},removing:function(){return t.handleRemoving(n)}});this.uploadObj.appendTo(this.popupObj.element.childNodes[0])},n.prototype.handleUploading=function(n,i){var r=this;this.parent.isServerRendered||this.parent.trigger(il,n,function(n){n.cancel?(t.isNullOrUndefined(i)||t.detach(i),t.isNullOrUndefined(r.popupObj.element)||t.detach(r.popupObj.element)):r.parent.inputElement.contentEditable="false"})},n.prototype.handleBeforeUpload=function(n){this.parent.trigger(hl,n);this.toolbarEnableDisable(!0)},n.prototype.handleFailure=function(n,t){var i=this;this.failureTime=setTimeout(function(){i.uploadFailure(t,i.uploadObj,i.popupObj,n)},900)},n.prototype.handleCanceling=function(n){this.parent.inputElement.contentEditable="true";n.nextSibling&&" "===n.nextSibling.textContent&&t.detach(n.nextSibling);t.detach(n);this.popupObj.close()},n.prototype.handleRemoving=function(n){this.parent.inputElement.contentEditable="true";n.nextSibling&&" "===n.nextSibling.textContent&&t.detach(n.nextSibling);t.detach(n);this.popupObj.close()},n.prototype.initializeUpload=function(n){var t=[{name:n.name,rawFile:n,size:n.size,type:n.type,status:"Ready to Upload",validationMessages:{minSize:"",maxSize:""},statusCode:"1"}];this.uploadObj.createFileList(t);this.uploadObj.upload(t)},n.prototype.hideFileSelectWrapper=function(){var i=this.popupObj.element.getElementsByClassName("e-file-select-wrap")[0],n;i&&(i.style.display="none");n=this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap");n&&t.detach(n)},n.prototype.uploadFailure=function(n,i,r,u){this.parent&&this.parent.isDestroyed||(this.parent.inputElement.contentEditable="true",t.detach(n),this.cleanupPopup(r),this.parent.trigger(ul,u),this.cleanupUploader(i))},n.prototype.cleanupPopup=function(n){n&&(this.parent.isBlur=!1,n.destroy(),t.isNullOrUndefined(n.element)||t.detach(n.element))},n.prototype.cleanupUploader=function(n){n&&!n.isDestroyed&&n.element&&n.destroy()},n.prototype.popupClose=function(n,t,i,r){this.parent.inputElement.contentEditable="true";this.prepareEventArgs(r,i);this.handleUploadStatus(r,i);this.scheduleCleanup(n,t,i)},n.prototype.prepareEventArgs=function(n,t){n.element=t;n.detectImageSource=ge.Pasted},n.prototype.handleUploadStatus=function(n,t){var i=n.file;"2"===i.statusCode?this.handleSuccessfulUpload(n,t):"5"===i.statusCode&&this.handleImageRemoval(n)},n.prototype.handleSuccessfulUpload=function(n,i){var r=this;this.parent.trigger(rl,n,function(n){if(!t.isNullOrUndefined(r.parent.insertImageSettings.path)){var u=r.parent.insertImageSettings.path+n.file.name;r.updateImageSource(i,u,n.file.name)}})},n.prototype.updateImageSource=function(n,t,i){if(!this.parent.inputElement.contains(n)&&n.id){var r=this.parent.inputElement.querySelectorAll("#"+n.id);this.updateDetachedImages(r,t,i)}else n.src=t,n.setAttribute("alt",i)},n.prototype.updateDetachedImages=function(n,t,i){for(var r,u=0;u<n.length;u++)r=n[u],r&&r.style&&"0.5"===r.style.opacity&&(r.src=t,r.setAttribute("alt",i))},n.prototype.handleImageRemoval=function(n){this.parent.trigger(ew,n,function(n){t.isNullOrUndefined(n.element.src)||(n.element.src="")})},n.prototype.scheduleCleanup=function(n,t,i){var r=this;this.popupCloseTime=setTimeout(function(){r.cleanupPopup(n);r.resetImageOpacity(i);r.toolbarEnableDisable(!1);r.cleanupUploader(t)},1500)},n.prototype.resetImageOpacity=function(n){this.parent.inputElement.contains(n)||!n.id&&!n.alt?n.style.opacity="1":this.resetDetachedImageOpacity(n)},n.prototype.resetDetachedImageOpacity=function(n){var u=n.id?"#"+n.id:'[alt="'+n.alt+'"]',r,i,t;if(u)for(r=this.parent.inputElement.querySelectorAll(u),i=0;i<r.length;i++)t=r[i],t&&t.style&&"0.5"===t.style.opacity&&(t.style.opacity="1")},n.prototype.refreshPopup=function(n,t){this.calculateImagePosition(n)>this.parent.element.offsetTop+this.parent.element.offsetHeight?this.positionPopupAtTop(t):this.positionPopupAtImage(t,n)},n.prototype.calculateImagePosition=function(n){return this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop},n.prototype.positionPopupAtTop=function(n){n.offsetY=this.parent.iframeSettings.enable?-30:-65;n.element.style.display="block"},n.prototype.positionPopupAtImage=function(n,t){n&&(n.refreshPosition(t),n.element.style.display="block")},n.prototype.imageFormatting=function(n,i){var f=i.elements[0],e,r,s,h,u;t.isNullOrUndefined(f.getAttribute("src"))||f.classList.add("pasteContent_Img");e=this.parent.createElement("span");e.appendChild(f);r=e.innerHTML;this.contentModule=this.renderFactory.getRenderer(o.Content);s=this.contentModule.getDocument();h=this.nodeSelectionObj.getRange(s);this.saveSelection=this.nodeSelectionObj.save(h,s);u=this.parent.pasteCleanupSettings;u.prompt?this.pasteDialog(r,n):u.plainText?this.plainFormatting(r,n):u.keepFormat?this.formatting(r,!1,n):this.formatting(r,!0,n)},n.prototype.radioRender=function(){var n,t,i;this.keepRadioButton=new rr.RadioButton({label:this.i10n.getConstant("keepFormat"),name:"pasteOption",checked:!0});this.keepRadioButton.isStringTemplate=!0;n=this.parent.element.querySelector("#keepFormating");this.keepRadioButton.appendTo(n);this.cleanRadioButton=new rr.RadioButton({label:this.i10n.getConstant("cleanFormat"),name:"pasteOption"});this.cleanRadioButton.isStringTemplate=!0;t=this.parent.element.querySelector("#cleanFormat");this.cleanRadioButton.appendTo(t);this.plainTextRadioButton=new rr.RadioButton({label:this.i10n.getConstant("plainText"),name:"pasteOption"});this.plainTextRadioButton.isStringTemplate=!0;i=this.parent.element.querySelector("#plainTextFormat");this.plainTextRadioButton.appendTo(i)},n.prototype.selectFormatting=function(n,t,i,r){i?this.formatting(n,!1,t):r?this.formatting(n,!0,t):this.plainFormatting(n,t)},n.prototype.pasteDialog=function(n,t){this.dialogObj=this.dialogRenderObj.render(this.getDialogModel(n,t));var i=this.parent.element.querySelector("#"+this.parent.getID()+"_pasteCleanupDialog");i&&""!==i.innerHTML&&this.destroyDialog(i);i||(i=this.parent.createElement("div",{id:this.parent.getID()+"_pasteCleanupDialog"}),this.parent.rootContainer.appendChild(i));this.dialogObj.appendTo(i);this.radioRender();this.dialogObj.show();this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.getDialogModel=function(n,i){return{buttons:[this.getOkButton(n,i),this.getCancelButton()],header:this.i10n.getConstant("pasteFormat"),content:this.getDialogContent(),target:this.parent.element,width:"300px",height:"265px",cssClass:yn,isModal:t.Browser.isDevice,visible:!1}},n.prototype.getOkButton=function(n,t){var i=this;return{click:function(){if(!i.dialogObj.isDestroyed){var r=!!i.parent.element.querySelector("#keepFormating").checked,u=!!i.parent.element.querySelector("#cleanFormat").checked;i.closeDialog();i.selectFormatting(n,t,r,u)}},buttonModel:{isPrimary:!0,cssClass:"e-flat "+an,content:this.i10n.getConstant("pasteDialogOk")}}},n.prototype.getCancelButton=function(){var n=this;return{click:function(){n.dialogObj.isDestroyed||n.closeDialog()},buttonModel:{cssClass:"e-flat "+vn,content:this.i10n.getConstant("pasteDialogCancel")}}},n.prototype.closeDialog=function(){this.dialogObj.hide();var n=this.dialogObj;this.dialogRenderObj.close(n);this.dialogObj.destroy()},n.prototype.getDialogContent=function(){return this.i10n.getConstant("pasteFormatContent")+'<br/><div>\n            <div class="e-rte-radio-keep-format">\n                <input type="radio" class="'+hn+'" id="keepFormating"/>\n            <\/div>\n            <div class="e-rte-radio-remove-format">\n                <input type="radio" class="'+cn+'" id="cleanFormat"/>\n            <\/div>\n            <div class="e-rte-radio-plain-format">\n                <input type="radio" class="'+ln+'" id="plainTextFormat"/>\n            <\/div>\n        <\/div>'},n.prototype.updateCss=function(n,i){n&&i.cssClass&&(t.isNullOrUndefined(i.oldCssClass)?n.setProperties({cssClass:(n.cssClass+" "+i.cssClass).trim()}):n.setProperties({cssClass:(n.cssClass.replace(i.oldCssClass,"").trim()+" "+i.cssClass).trim()}))},n.prototype.setCssClass=function(n){this.popupObj&&n.cssClass&&(n.oldCssClass&&t.removeClass([this.popupObj.element],n.oldCssClass),t.addClass([this.popupObj.element],n.cssClass));this.updateCss(this.dialogObj,n);this.updateCss(this.uploadObj,n);this.updateCss(this.plainTextRadioButton,n);this.updateCss(this.cleanRadioButton,n);this.updateCss(this.keepRadioButton,n)},n.prototype.destroyDialog=function(n){var i=this.parent.element.querySelector(".e-rte-dialog-minheight");for(i&&t.detach(i);n.firstChild;)t.detach(n.firstChild)},n.prototype.docClick=function(n){var i=n.args.target;i&&i.classList&&this.dialogObj&&!t.closest(i,"[id='"+this.dialogObj.element.id+"']")&&!i.classList.contains("e-toolbar-item")&&this.dialogObj.hide()},n.prototype.formatting=function(n,t,i){var r=this.parent.createElement("div",{className:"pasteContent",styles:"display:inline;"}),u;this.isNotFromHtml&&this.containsHtml&&(n=this.pasteObj.splitBreakLine(n));r.innerHTML=n;r=this.pasteObj.cleanAppleClass(r);r=this.pasteObj.cleanupDeniedTagsAndAttributes(r,t);null!==this.parent.pasteCleanupSettings.allowedStyleProps&&(r=this.pasteObj.allowedStyle(r));this.saveSelection.restore();u=r.innerHTML;this.parent.enableHtmlSanitizer&&(u=r.innerHTML.split("&").join("&amp;"));r.innerHTML=ev(u,this.parent);this.pasteObj.setImageClassAndProps(r);this.pasteObj.hasPictureElement(r)&&this.pasteObj.processPictureElement(r);this.pasteObj.hasContentToPaste(r)&&this.handlePastedImagesAndEvents(r,n,i)},n.prototype.handlePastedImagesAndEvents=function(n,t,i){var r=this.parent.createElement("div"),u;r.innerHTML=t;u=this.pasteObj.collectBase64ImageFiles(r);this.parent.trigger(lw,{value:n.innerHTML,filesData:u},function(n){t=n.value});n.innerHTML=this.parent.addAnchorAriaLabel(t);n=this.pasteObj.addTableClass(n,i.pasteTableSource);this.execPasteCommand(n,i);this.parent.notify(ta,{});hr(this.parent.contentModule.getDocument(),this.parent.inputElement);this.pasteObj.removeTempClass();this.parent.notify(hi,{});this.pasteObj.cropImageHandler(this.parent.inputElement)},n.prototype.execPasteCommand=function(n,i){var r=this;this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",i,function(n){t.extend(i,{elements:n.elements,imageElements:n.imgElem},!0);r.parent.formatter.onSuccess(r.parent,i)},n,null,null,this.parent.enterKey)},n.prototype.getCropImageData=function(){return this.cropImageData},n.prototype.plainFormatting=function(n,i){var u=this,r=this.parent.createElement("div",{className:"pasteContent"}),f,e;this.plainTextContent=this.plainTextContent.replace(/</g,"&lt;");this.plainTextContent=this.plainTextContent.replace(/>/g,"&gt;");f=ev(this.plainTextContent,this.parent);e=this.pasteObj.splitBreakLine(f);r.innerHTML=e;""!==r.textContent.trim()?(this.saveSelection.restore(),this.parent.trigger(lw,{value:r.innerHTML,filesData:null},function(t){n=t.value}),r.innerHTML=n,this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",i,function(n){t.extend(i,{elements:n.elements,imageElements:n.imgElem},!0);u.parent.formatter.onSuccess(u.parent,i)},r,null,null,this.parent.enterKey),this.pasteObj.removeTempClass()):(this.saveSelection.restore(),t.extend(i,{elements:[]},!0),this.parent.formatter.onSuccess(this.parent,i))},n.prototype.getModuleName=function(){return"pasteCleanup"},n}(),wct=function(){function n(n){this.parent=n;this.addEventListener();this.isDestroyed=!1;this.isResizing=!1;this.iframeMouseUpBoundFn=this.iframeMouseUp.bind(this)}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(a,this.renderResizable,this),this.parent.on(u,this.destroy,this))},n.prototype.renderResizable=function(){var n=this,i=this.parent.enableRtl?ttt:wn;this.resizer=this.parent.createElement("div",{id:this.parent.getID()+"-resizable",className:"e-icons "+pn+" "+i});this.parent.element.classList.add(vb);this.parent.rootContainer.appendChild(this.resizer);this.parent.rootContainer.classList.add("e-resize-enabled");this.parent.iframeSettings.enable&&(this.parent.inputElement.classList.add("e-resize-enabled"),this.parent.contentModule.getDocument().addEventListener("mouseup",this.iframeMouseUpBoundFn));this.iframeElement=this.parent.contentModule.getDocument().querySelectorAll("iframe");t.isNullOrUndefined(this.iframeElement)||this.iframeElement.forEach(function(i){t.EventHandler.add(i,"load",n.onIFrameLoad,n)});this.touchStartEvent="msie"===t.Browser.info.name?"pointerdown":"touchstart";t.EventHandler.add(this.resizer,"mousedown",this.resizeStart,this);t.EventHandler.add(this.resizer,this.touchStartEvent,this.resizeStart,this)},n.prototype.onIFrameLoad=function(n){var i=n.target;"IFRAME"===i.nodeName&&i.contentDocument&&t.EventHandler.add(i.contentDocument,"mouseup",this.stopResize,this)},n.prototype.removeMouseUpEventListener=function(n){n.contentDocument&&t.EventHandler.remove(n.contentDocument,"mouseup",this.stopResize)},n.prototype.resizeStart=function(n){var i=this,t;this.isResizing=!1;n.cancelable&&n.preventDefault();this.wireResizeEvents();this.parent.notify(ll,{});t={event:n,requestType:"editor"};this.parent.trigger(cu,t,function(n){n.cancel&&i.unwireResizeEvents()})},n.prototype.performResize=function(n){var c=this,e,i,r,h,u,f;if(this.isResizing=!0,e={event:n,requestType:"editor"},this.parent.trigger(ho,e,function(n){n.cancel&&c.unwireResizeEvents()}),i=this.parent.element.getBoundingClientRect(),this.isMouseEvent(n)){if((this.parent.element.style.height=n.clientY-i.top+"px",this.parent.element.style.width=this.parent.enableRtl?i.right-n.clientX+"px":n.clientX-i.left+"px",this.parent.toolbarModule)&&(r=this.parent.toolbarModule.getToolbarElement(),!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(r.parentElement)&&r.parentElement.classList.contains(as)&&this.parent.toolbarSettings.enableFloating&&this.parent.getToolbar()&&!this.parent.inlineMode.enable)){var o=this.parent.element.querySelector("#"+this.parent.getID()+"_source-view"),l=this.parent.contentModule.getPanel(),s=!1;o&&this.parent.element.querySelector(".e-source-code-enabled")&&(s=!0);h=s?o.getBoundingClientRect().width:l.getBoundingClientRect().width;r.style.width=h+"px"}}else u="msie"!==t.Browser.info.name?n.touches[0]:n,this.parent.element.style.height=u.clientY-i.top+"px",this.parent.element.style.width=this.parent.enableRtl?i.right-u.clientX+"px":u.clientX-i.left+"px";f=this.parent.element.querySelector("#"+this.parent.getID()+"_source-view");t.isNullOrUndefined(f)||(f.style.height=this.parent.element.style.height);this.parent.refreshUI()},n.prototype.stopResize=function(n){this.isResizing=!1;this.parent.refreshUI();this.unwireResizeEvents();var t={event:n,requestType:"editor"};this.parent.trigger(co,t)},n.prototype.getEventType=function(n){return n.indexOf("mouse")>-1?"mouse":"touch"},n.prototype.isMouseEvent=function(n){var i=!1;return("mouse"===this.getEventType(n.type)||!t.isNullOrUndefined(n.pointerType)&&"mouse"===this.getEventType(n.pointerType))&&(i=!0),i},n.prototype.wireResizeEvents=function(){t.EventHandler.add(document,"mousemove",this.performResize,this);t.EventHandler.add(document,"mouseup",this.stopResize,this);this.touchMoveEvent="msie"===t.Browser.info.name?"pointermove":"touchmove";this.touchEndEvent="msie"===t.Browser.info.name?"pointerup":"touchend";t.EventHandler.add(document,this.touchMoveEvent,this.performResize,this);t.EventHandler.add(document,this.touchEndEvent,this.stopResize,this)},n.prototype.unwireResizeEvents=function(){t.EventHandler.remove(document,"mousemove",this.performResize);t.EventHandler.remove(document,"mouseup",this.stopResize);t.EventHandler.remove(document,this.touchMoveEvent,this.performResize);t.EventHandler.remove(document,this.touchEndEvent,this.stopResize)},n.prototype.destroy=function(){this.isDestroyed||(this.removeEventListener(),this.resizer&&(t.detach(this.resizer),this.resizer=null),this.isDestroyed=!0)},n.prototype.removeEventListener=function(){var n=this;this.parent.off(a,this.renderResizable);this.parent.element.classList.remove(vb);this.parent&&this.parent.rootContainer&&this.parent.rootContainer.classList.contains("e-resize-enabled")&&this.parent.rootContainer.classList.remove("e-resize-enabled");this.parent.iframeSettings.enable&&!t.isNullOrUndefined(this.parent.inputElement)&&(this.parent.inputElement.classList.remove("e-resize-enabled"),this.parent.contentModule.getDocument().removeEventListener("mouseup",this.iframeMouseUpBoundFn));t.isNullOrUndefined(this.iframeElement)||this.iframeElement.forEach(function(i){n.removeMouseUpEventListener(i);t.EventHandler.remove(i,"load",n.onIFrameLoad)});this.resizer&&(t.EventHandler.remove(this.resizer,"mousedown",this.resizeStart),t.EventHandler.remove(this.resizer,this.touchStartEvent,this.resizeStart),t.detach(this.resizer));this.parent.off(u,this.destroy);this.iframeMouseUpBoundFn=null},n.prototype.iframeMouseUp=function(n){this.isResizing&&this.stopResize(n)},n.prototype.getModuleName=function(){return"resize"},n}(),bct=function(){function n(n,t){si.FileManager.Inject(si.ContextMenu,si.DetailsView,si.NavigationPane,si.Toolbar);this.parent=n;this.i10n=t.getService("rteLocale");this.dialogRenderObj=t.getService("dialogRenderObject");this.rendererFactory=t.getService("rendererFactory");this.addEventListener();this.isDestroyed=!1;this.insertImageBoundFn=this.insertImageUrl.bind(this);this.cancelDialogBoundFn=this.cancelDialog.bind(this);this.renderFileManagerBoundFn=this.renderFileManager.bind(this);this.dialogClosedBoundFn=this.dialogClosed.bind(this);this.onDocumentClickBoundFn=this.onDocumentClick.bind(this)}return n.prototype.initialize=function(){this.contentModule=this.rendererFactory.getRenderer(o.Content)},n.prototype.render=function(n){var r,u,f,i,e;r=n.selectNode&&"IMG"===n.selectNode[0].nodeName?this.parent.localeObj.getConstant("dialogUpdate"):this.i10n.getConstant("dialogInsert");u=this.parent.localeObj.getConstant("fileDialogHeader");f=this.i10n.getConstant("dialogCancel");this.dlgButtons=[{click:this.insertImageBoundFn,buttonModel:{content:r,cssClass:"e-flat e-insertImage",isPrimary:!0,disabled:!0}},{click:this.cancelDialogBoundFn,buttonModel:{cssClass:"e-flat e-cancel",content:f}}];this.selectObj={selection:n.selection,args:n.args,selectParent:n.selectParent};i=this.parent.createElement("div",{className:"e-rte-file-manager-dialog",id:this.parent.getID()+"_file-manager-dialog",attrs:{"aria-owns":this.parent.getID()}});document.body.appendChild(i);this.fileWrap=this.parent.createElement("div",{id:this.parent.getID()+"_rte-file-manager",className:"e-img-file-wrap"});i.appendChild(this.fileWrap);i.appendChild(this.getInputUrlElement());e={visible:!1,isModal:!0,header:u,target:document.body,locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:pt,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,width:"720px",height:"auto",position:{X:"center",Y:"center"},buttons:this.dlgButtons,created:this.renderFileManagerBoundFn,close:this.dialogClosedBoundFn};this.dialogObj=this.dialogRenderObj.render(e);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(i);this.dialogObj.show(!!t.Browser.isDevice);this.setCssClass({cssClass:this.parent.getCssClass()})},n.prototype.setCssClass=function(n){this.dialogObj&&n.cssClass&&(t.isNullOrUndefined(n.oldCssClass)?this.dialogObj.setProperties({cssClass:(this.dialogObj.cssClass+" "+n.cssClass).trim()}):this.dialogObj.setProperties({cssClass:(this.dialogObj.cssClass.replace(n.oldCssClass,"").trim()+" "+n.cssClass).trim()}))},n.prototype.dialogClosed=function(n){this.parent.isBlur=!1;n&&n.event.returnValue&&this.selectObj.selection.restore();this.destroyComponents();this.parent.element.ownerDocument.removeEventListener("mousedown",this.onDocumentClickBoundFn);this.dialogRenderObj.close(n)},n.prototype.renderFileManager=function(){var n=this;this.fileObj=new si.FileManager({allowMultiSelection:!1,locale:this.parent.locale,enableRtl:this.parent.enableRtl,path:this.parent.fileManagerSettings.path,view:this.parent.fileManagerSettings.view,enablePersistence:this.parent.enablePersistence,cssClass:this.parent.fileManagerSettings.cssClass,sortOrder:this.parent.fileManagerSettings.sortOrder,ajaxSettings:this.parent.fileManagerSettings.ajaxSettings,showThumbnail:this.parent.fileManagerSettings.showThumbnail,rootAliasName:this.parent.fileManagerSettings.rootAliasName,uploadSettings:this.parent.fileManagerSettings.uploadSettings,searchSettings:this.parent.fileManagerSettings.searchSettings,toolbarSettings:this.parent.fileManagerSettings.toolbarSettings,showHiddenItems:this.parent.fileManagerSettings.showHiddenItems,allowDragAndDrop:this.parent.fileManagerSettings.allowDragAndDrop,showFileExtension:this.parent.fileManagerSettings.showFileExtension,detailsViewSettings:this.parent.fileManagerSettings.detailsViewSettings,contextMenuSettings:this.parent.fileManagerSettings.contextMenuSettings,navigationPaneSettings:this.parent.fileManagerSettings.navigationPaneSettings,beforeSend:this.parent.fileManagerSettings.beforeSend,fileSelect:function(t){var i=t.fileDetails;i.isFile&&n.parent.insertImageSettings.allowedTypes.indexOf(i.type)>-1?(n.inputUrl.value=n.parent.fileManagerSettings.ajaxSettings.getImageUrl+"?path="+(i.filterPath&&i.filterPath.replace(/\\/g,"/"))+i.name,n.dlgButtons[0].buttonModel.disabled=!1):(n.inputUrl.value="",n.dlgButtons[0].buttonModel.disabled=!0);n.dialogObj.setProperties({buttons:n.dlgButtons})},created:function(){n.inputUrl.removeAttribute("disabled")},success:function(){n.fileObj.refreshLayout()}});t.Browser.isDevice&&(this.fileObj.height="85%");this.fileObj.appendTo(this.fileWrap);this.parent.element.ownerDocument.addEventListener("mousedown",this.onDocumentClickBoundFn)},n.prototype.getInputUrlElement=function(){var n=this.parent.createElement("div",{className:"imgUrl"}),t=this.parent.createElement("div",{className:"e-rte-label"}),i;return t.innerHTML='<label for="rteSample_img_url">'+this.i10n.getConstant("linkWebUrl")+"<\/label>",n.appendChild(t),i=this.i10n.getConstant("imageUrl"),this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url",attrs:{placeholder:i,spellcheck:"false",disabled:"true"}}),n.appendChild(this.inputUrl),n},n.prototype.insertImageUrl=function(){var n=this.inputUrl.value,i;if(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),""!==n){"HTML"===this.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selectObj.selection.range.startContainer.parentNode,"#"+this.contentModule.getPanel().id))&&(this.contentModule.getEditPanel().focus(),i=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),this.selectObj.selection=this.parent.formatter.editorManager.nodeSelection.save(i,this.contentModule.getDocument()),this.selectObj.selectParent=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i));var r=/[\w-]+.(jpg|png|jpeg|gif)/g,u=t.isNullOrUndefined(n.match(r))||"HTML"!==this.parent.editorMode?"":n.match(r)[0],f={cssClass:"inline"===this.parent.insertImageSettings.display?gi:ri,url:n,selection:this.selectObj.selection,altText:u,selectParent:this.selectObj.selectParent,width:{width:this.parent.insertImageSettings.width,minWidth:this.parent.insertImageSettings.minWidth,maxWidth:this.parent.getInsertImgMaxWidth()},height:{height:this.parent.insertImageSettings.height,minHeight:this.parent.insertImageSettings.minHeight,maxHeight:this.parent.insertImageSettings.maxHeight}};this.parent.formatter.process(this.parent,this.selectObj.args,this.selectObj.args.originalEvent,f);this.dialogObj.hide({returnValue:!1})}},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0})},n.prototype.onDocumentClick=function(n){var i=n.target,r="#document"!==i.nodeName&&!t.isNullOrUndefined(i.previousElementSibling)&&i.previousElementSibling;t.isNullOrUndefined(this.dialogObj)||t.closest(i,"#"+this.parent.getID()+"_file-manager-dialog")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_tb_sortby-popup")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_tb_view-popup")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_contextmenu")||!t.isNullOrUndefined(t.closest(i,".e-contextmenu-wrapper"))&&t.closest(i,".e-contextmenu-wrapper").querySelector("#"+this.parent.getID()+"_rte-file-manager_contextmenu")||t.isNullOrUndefined(r)||r.classList.contains("e-rte-file-manager-dialog")||t.isNullOrUndefined(r)||r.id===this.parent.getID()+"_rte-file-manager_contextmenu"?this.parent.isRTE=!0:(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,eu(this.parent.element,"focusout"))},n.prototype.addEventListener=function(){this.parent.on(a,this.initialize,this);this.parent.on(go,this.render,this);this.parent.on(w,this.setCssClass,this);this.parent.on(u,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.element.ownerDocument.removeEventListener("mousedown",this.onDocumentClickBoundFn);this.parent.off(a,this.initialize);this.parent.off(go,this.render);this.parent.off(w,this.setCssClass);this.parent.off(u,this.destroy)},n.prototype.destroyComponents=function(){this.fileObj&&(this.fileObj.destroy(),this.fileObj=null);this.dialogObj&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element))},n.prototype.destroy=function(){this.isDestroyed||(this.destroyComponents(),this.removeEventListener(),this.dlgButtons=null,this.isDestroyed=!0,this.insertImageBoundFn=null,this.cancelDialogBoundFn=null,this.renderFileManagerBoundFn=null,this.dialogClosedBoundFn=null,this.onDocumentClickBoundFn=null)},n.prototype.getModuleName=function(){return"fileManager"},n}(),dut=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(yv,this.emojiInsert,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(yv,this.emojiInsert);this.parent.observer.off(f,this.destroy)},n.prototype.emojiInsert=function(n){for(var s,f,i,o=document.createTextNode(n.value),r=this.parent.currentDocument.getSelection(),u=r.getRangeAt(0).startOffset,e=u-1;e>=u-15;e--)if(s=r.focusNode.textContent.substring(e-1,e),/:$/.test(s)){this.beforeApplyFormat(!0);break}var h=/:$/.test(r.focusNode.textContent.charAt(u-1)),c=r.focusNode.textContent.charAt(u-2),l=/\s/.test(c);h&&(l||1===r.focusOffset)&&this.beforeApplyFormat(!0);f=r.focusNode;i=t.closest("#text"===f.nodeName?f.parentNode:f,"a");i?0===u?i.parentNode.insertBefore(o,i):u===f.textContent.length&&(i.parentNode.insertBefore(o,i.nextSibling),new st(i).setCursorPoint(this.parent.currentDocument,i.nextSibling,i.nextSibling.textContent.length)):kt.Insert(this.parent.currentDocument,o,this.parent.editableElement);n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.beforeApplyFormat=function(n){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),t=this.parent.nodeSelection.getNodeCollection(i)[0],o=!(":"===t.parentElement.innerHTML.replace(/&nbsp;|<br>/g,"").trim()||0===t.textContent.trim().indexOf("/")),r=t,u,e,f;if(o&&n)for(;r!==this.parent.editableElement;)r=r.parentElement;for(u=i.startOffset;-1===this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument).toString().indexOf(":");)this.parent.nodeSelection.setSelectionText(this.parent.editableElement.ownerDocument,t,t,u,i.endOffset),u--;e=this.parent.nodeSelection.getRange(this.parent.currentDocument);f=this.parent.nodeCutter.GetSpliceNode(e,t);f.parentNode.removeChild(f)},n.prototype.destroy=function(){this.removeEventListener()},n}(),gut=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(sv,this.applyCodeBlockHandler,this);this.parent.observer.on(f,this.destroy,this);this.parent.observer.on(pv,this.handleCodeBlockIndentation,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(sv,this.applyCodeBlockHandler);this.parent.observer.off(f,this.destroy);this.parent.observer.off(pv,this.handleCodeBlockIndentation)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.applyCodeBlockHandler=function(n){if(!("CodeBlock"!==n.subCommand||t.isNullOrUndefined(n.item)||t.isNullOrUndefined(n.item.action)||t.isNullOrUndefined(n.event)&&"createCodeBlock"!==n.item.action)){switch(n.item.action){case"createCodeBlock":this.codeBlockCreation(n);break;case"codeBlockPaste":this.codeBlockPasteAction(n);break;case"codeBlockEnter":this.codeBlockEnterAction(n);break;case"codeBlockBackSpace":this.codeBlockBackSpaceAction(n);break;case"codeBlockTabAction":this.codeBlockTabAction(n);break;case"codeBlockShiftTabAction":this.codeBlockShiftTabAction(n)}this.callBack(n)}},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.subCommand,action:n.item.action,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(!0)})},n.prototype.isValidCodeBlockStructure=function(n){var i="#text"===n.nodeName?n.parentElement:n;return i===this.parent.editableElement||t.isNullOrUndefined(i.closest("pre"))||!i.closest("pre").hasAttribute("data-language")||t.isNullOrUndefined(i.closest("pre").firstChild)||"CODE"!==i.closest("pre").firstChild.nodeName?null:i.closest("pre")},n.prototype.isCodeBlockEnterAction=function(n,i){var r=n.startContainer===n.endContainer&&n.startOffset===n.endOffset;return!(13!==i.keyCode||!r||t.isNullOrUndefined(this.isValidCodeBlockStructure(n.startContainer)))},n.prototype.codeBlockBackSpaceAction=function(n){var t=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument),i="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer,r="#text"===t.endContainer.nodeName?t.endContainer.parentElement:t.endContainer;"keyup"===n.event.type?this.handleKeyUpBackspace(t,i,r):"keydown"===n.event.type&&this.handleKeyDownBackspace(n,t,i,r)},n.prototype.handleKeyUpBackspace=function(n,i,r){var u,o,f,e;this.isCodeBlockElement(i)&&this.isCodeBlockElement(r)&&(u=i.closest("pre[data-language]"),o=u.querySelector("code"),t.isNullOrUndefined(o)&&0===n.startOffset&&0===n.endOffset&&"PRE"===n.startContainer.nodeName&&"PRE"===n.endContainer.nodeName&&(i.closest("pre[data-language]").firstChild.remove(),f=t.createElement("br"),e=t.createElement("code"),e.appendChild(f),u.appendChild(e),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0)))},n.prototype.isCodeBlockElement=function(n){return!t.isNullOrUndefined(n.closest("pre[data-language]"))},n.prototype.handleKeyDownBackspace=function(n,i,r,u){!t.isNullOrUndefined(this.isValidCodeBlockStructure(r))||t.isNullOrUndefined(this.isValidCodeBlockStructure(u))?t.isNullOrUndefined(this.isValidCodeBlockStructure(r))||!t.isNullOrUndefined(this.isValidCodeBlockStructure(u))?46!==n.event.which&&8!==n.event.which||i.startContainer!==i.endContainer||i.startOffset!==i.endOffset||this.handleSinglePointDeletion(n,i,r):this.handleSelectionFromCodeBlockToRegular(n,i,r):this.handleSelectionAcrossCodeBlockBoundary(n,i,r,u)},n.prototype.handleSelectionAcrossCodeBlockBoundary=function(n,t,i,r){var f,u;n.event.preventDefault();f=this.isValidCodeBlockStructure(r);u=this.parent.domNode.getImmediateBlockNode(i);t.deleteContents();var o=this.parent.nodeSelection.findLastTextPosition(u),s=this.parent.nodeSelection.findLastTextPosition(f.previousSibling),e=f.firstChild;e&&u&&""!==u.textContent&&this.moveContentToParent(e,u,f);this.setCursorAfterBoundaryOperation(u,f,o,s);this.cleanupEmptyElements(f,u)},n.prototype.moveContentToParent=function(n,t,i){for(;n&&n.firstChild;)t===this.parent.editableElement?t.insertBefore(n.firstChild,i):t.appendChild(n.firstChild)},n.prototype.setCursorAfterBoundaryOperation=function(n,t,i,r){""===n.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t.firstChild,0):n===this.parent.editableElement?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r.node,r.offset):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i.node,i.offset)},n.prototype.cleanupEmptyElements=function(n,t){""===n.textContent.trim()&&n.remove();""===t.textContent&&t.remove()},n.prototype.handleSelectionFromCodeBlockToRegular=function(n,t,i){var s=this,u=this.isValidCodeBlockStructure(i),h=this.parent.domNode.blockNodes(!0),f,e,r,o;t.deleteContents();f=u.querySelector("code");this.addBrElementIfMissing(f,t)?n.event.preventDefault():(e=n.item.currentFormat,r=this.parent.nodeSelection.findLastTextPosition(u),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r.node,r.offset),t=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument),o=h.filter(function(n){return s.parent.editableElement.contains(n)}),this.setCursorMarkers(t),this.processCodeBlockAction(t,o,e),n.event.preventDefault())},n.prototype.addBrElementIfMissing=function(n,i){if(!t.isNullOrUndefined(n)&&0===n.childNodes.length){var r=t.createElement("br");return n.appendChild(r),i.setStartBefore(r),i.setEndBefore(r),!0}return!1},n.prototype.handleSinglePointDeletion=function(n,t,i){var r=n.event.which,u=this.isValidCodeBlockStructure(i);46===r&&this.handleDeleteKeyAtCodeBlockBoundary(n,t,u);this.handleNextSiblingCodeBlockDeletion(n,t,r);this.handleBackspaceAtCodeBlockStart(n,t,r,u);this.handleBackspaceAfterCodeBlock(n,t,r)},n.prototype.handleDeleteKeyAtCodeBlockBoundary=function(n,i,r){var u,o,f;if(r){u="CODE"===i.startContainer.nodeName?i.startContainer.childNodes[i.startOffset]:i.startContainer;o=i.startContainer===i.endContainer&&i.startOffset===i.endOffset;o&&this.isBrAsLastChildInCodeBlock(r)&&(f=r.querySelector("code"),f&&f.lastChild&&"BR"===f.lastChild.nodeName&&f.removeChild(f.lastChild));var s=o&&1===r.querySelector("code").childNodes.length&&"BR"===r.querySelector("code").childNodes[0].nodeName&&r.querySelector("code").firstChild===u,h=46===n.event.which,e=this.findNextValidSibling(r),c=h&&!t.isNullOrUndefined(r)&&!t.isNullOrUndefined(e)&&this.isValidCodeBlockStructure(i.startContainer).querySelector("code").lastChild===u&&u.textContent.length===("BR"===u.nodeName?0:i.startOffset),l=s&&t.isNullOrUndefined(e),a=s&&!t.isNullOrUndefined(e),v=s&&t.isNullOrUndefined(r.previousSibling);l&&v?this.handleActionWhenNextSiblingIsNull(n,r):a?this.handleActionWhenNextSiblingExists(n,r,e):c&&(n.event.preventDefault(),this.mergeNextContentIntoCodeBlock(r,u))}},n.prototype.isBrAsLastChildInCodeBlock=function(n){var i=n.querySelector("code").lastChild,r=i?i.previousSibling:null;return i&&"BR"===i.nodeName&&!t.isNullOrUndefined(r)&&"BR"!==r.nodeName},n.prototype.handleActionWhenNextSiblingIsNull=function(n,i){n.event.preventDefault();this.nodeCreateBasedOnEnterAction(i,n.enterAction);t.detach(i)},n.prototype.handleActionWhenNextSiblingExists=function(n,t,i){var r,u;n.event.preventDefault();r=this.parent.nodeSelection.findFirstContentNode(i);"BR"===r.node.nodeName?(u=this.parent.editableElement.ownerDocument.createRange(),u.setStartBefore(r.node),u.setEndBefore(r.node),this.parent.nodeSelection.setRange(this.parent.currentDocument,u)):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r.node,0);this.processListElement(t)},n.prototype.processListElement=function(n){var i=n.parentElement,r;(i&&"LI"!==i.nodeName&&i.lastChild===n&&(i=n.closest("li")),t.detach(n),i&&"LI"===i.nodeName)&&(r=i.parentElement,t.detach(i),!r||"UL"!==r.nodeName&&"OL"!==r.nodeName||r.querySelector("li")||t.detach(r))},n.prototype.findNextValidSibling=function(n){var i=n.nextSibling,r,u;if(t.isNullOrUndefined(i)&&n!==this.parent.editableElement)for(r=n.parentElement;r&&r!==this.parent.editableElement;){for(i=r.nextSibling;i&&!this.isValidNode(i);)i=i.nextSibling;if(i&&("TH"===i.nodeName||"TD"===i.nodeName))return null;if(i)break;r=r.parentElement}return i&&("UL"===i.nodeName||"OL"===i.nodeName)&&(u=this.findFirstListItem(i),u)?u:i},n.prototype.findFirstListItem=function(n){for(var i,r,u,t=0;t<n.childNodes.length;t++)if(i=n.childNodes[t],"LI"===i.nodeName)return(r=i.querySelector("OL,UL"),r&&(u=this.findFirstListItem(r),u))?u:i;return null},n.prototype.isValidNode=function(n){return n.nodeType===Node.ELEMENT_NODE||n.nodeType===Node.TEXT_NODE&&n.textContent.trim().length>0},n.prototype.nodeCreateBasedOnEnterAction=function(n,i){var r=t.createElement(i),f=t.createElement("br"),u;("P"!==i&&"DIV"!==i||r.appendChild(f),n.parentNode.insertBefore(r,n),"BR"===i)?(u=this.parent.editableElement.ownerDocument.createRange(),u.setStartBefore(r),u.setEndBefore(r),this.parent.nodeSelection.setRange(this.parent.currentDocument,u)):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0)},n.prototype.mergeNextContentIntoCodeBlock=function(n,i){var r=this.findNextValidSibling(n),u=n.querySelector("code");"BR"===r.nodeName?(this.processNode(r,u),t.detach(r)):t.isNullOrUndefined(r)||("BR"===i.nodeName&&t.detach(i),this.parent.domNode.isBlockNode(r)?(this.processNode(r,u),r&&"LI"===r.nodeName&&1===r.parentElement.querySelectorAll("li").length?t.detach(r.parentElement):r.parentNode.removeChild(r)):this.processInlineNextSiblings(r,u))},n.prototype.processInlineNextSiblings=function(n,t){for(var i,r=n,u=!0;r&&u;)i=r,r=r.nextSibling,"BR"===i.nodeName||this.parent.domNode.isBlockNode(i)?u=!1:(this.processNode(i,t),i.parentNode.removeChild(i))},n.prototype.handleNextSiblingCodeBlockDeletion=function(n,i,r){var f=this.parent.domNode.getImmediateBlockNode(i.startContainer),o=f!==this.parent.editableElement?f:i.startContainer,u=this.parent.nodeSelection.findLastTextPosition(o),s=u&&u.node===i.startContainer&&u.offset===i.startOffset,e=this.findParentOrNextSiblingCodeBlock(i);46===r&&!t.isNullOrUndefined(e)&&s&&(n.event.preventDefault(),this.mergeCodeBlockWithCurrentNode(e))},n.prototype.mergeCodeBlockWithCurrentNode=function(n){var t=n.nextSibling,i=t.querySelector("code"),r=n.currentNode,u,f,e;if(this.parent.domNode.isBlockNode(r)){for(;i.firstChild;)u=i.firstChild,r.appendChild(u);t.parentNode.removeChild(t)}else{for(f=r.parentNode,e=r.nextSibling;i.firstChild;)u=i.firstChild,f.insertBefore(u,e);t.parentNode.removeChild(t)}},n.prototype.handleBackspaceAtCodeBlockStart=function(n,i,r,u){var o=this.parent.nodeSelection.findFirstContentNode(this.parent.domNode.getImmediateBlockNode(i.startContainer)),h=o.node&&o.node===("CODE"===i.startContainer.nodeName?i.startContainer.firstChild:i.startContainer)&&0===i.startOffset,s,f,e;8===r&&!t.isNullOrUndefined(u)&&h&&(n.event.preventDefault(),s=u.querySelector("code"),t.isNullOrUndefined(u.previousSibling)?t.isNullOrUndefined(u.previousSibling)&&0===u.textContent.length&&(this.nodeCreateBasedOnEnterAction(u,n.enterAction),t.detach(u)):(f=u.previousSibling,e=this.parent.nodeSelection.findLastTextPosition(f),this.mergePreviousElementWithCodeBlock(f,s,u),t.isNullOrUndefined(f)||this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,e.node,e.offset)))},n.prototype.mergePreviousElementWithCodeBlock=function(n,t,i){var r,u,f;if(this.parent.domNode.isBlockNode(n)){for(;t.firstChild;)r=t.firstChild,n.appendChild(r);i.parentNode.removeChild(i)}else{for(u=n.parentNode,f=n.nextSibling;t.firstChild;)r=t.firstChild,u.insertBefore(r,f);i.parentNode.removeChild(i)}},n.prototype.handleBackspaceAfterCodeBlock=function(n,i,r){var f=this.parent.domNode.getImmediateBlockNode(i.startContainer),o=f!==this.parent.editableElement?f:i.startContainer,e=this.parent.nodeSelection.findFirstContentNode(o),s=e.node&&e.node===("CODE"===i.startContainer.nodeName?i.startContainer.firstChild:i.startContainer)&&0===i.startOffset,u=this.findParentOrPreviousSiblingCodeBlock(i),h=u&&"TABLE"===u.currentNode.nodeName;8!==r||t.isNullOrUndefined(u)||!s||h||(n.event.preventDefault(),this.mergePreviousCodeBlockWithCurrent(u))},n.prototype.mergePreviousCodeBlockWithCurrent=function(n){var e=this,r=n.previousSibling.querySelector("code"),i=n.currentNode,t=null,u=!0,f=function(n,i){e.processNode(n,i);u&&(t=i.lastChild,u=!1)};this.parent.domNode.isBlockNode(i)?this.processMergeBlockNode(i,r,f):this.processMergeInlineNode(i,r,f);t&&t.nodeType===Node.TEXT_NODE&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,t,0)},n.prototype.processMergeBlockNode=function(n,t,i){for(;n.firstChild;){var r=n.firstChild;n.removeChild(r);i(r,t)}n.parentNode.removeChild(n)},n.prototype.processMergeInlineNode=function(n,t,i){for(var u,r=n;r;){if(u=r.nextSibling,"BR"===r.nodeName||this.parent.domNode.isBlockNode(r))break;r.parentNode&&r.parentNode.removeChild(r);i(r,t);r=u}},n.prototype.codeBlockEnterAction=function(n){var t=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument),i="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer,r="#text"===t.endContainer.nodeName?t.endContainer.parentElement:t.endContainer;this.isCodeBlockPointSelection(t,i,r)?this.handleCodeBlockPointSelection(n,t,i):this.isSelectionWithinCodeBlock(t,i,r)?this.handleSelectionWithinCodeBlock(n,t):this.isSelectionOutsideToInside(i,r)?this.handleOutsideToInsideSelection(n,t,r):this.isSelectionInsideToOutside(i,r)&&this.handleInsideToOutsideSelection(n,t,i)},n.prototype.isCodeBlockPointSelection=function(n,i,r){var e=n.startContainer===n.endContainer&&n.startOffset===n.endOffset,o=!t.isNullOrUndefined(i.closest("pre[data-language]"))&&!t.isNullOrUndefined(r.closest("pre[data-language]")),u,f;return!e||!o?!1:(u=this.isFirstAppendScenario(n),f=this.isLastAppendScenario(n),u||f)},n.prototype.isFirstAppendScenario=function(n){return 0===n.startOffset&&0===n.endOffset&&"CODE"===n.startContainer.nodeName&&n.startContainer.childNodes[n.startOffset]&&n.endContainer.childNodes[n.endOffset]&&"BR"===n.startContainer.childNodes[n.endOffset].nodeName&&n.startContainer.childNodes.length>1&&!t.isNullOrUndefined(n.startContainer.childNodes[n.endOffset+1])},n.prototype.isLastAppendScenario=function(n){return"CODE"===n.startContainer.nodeName&&n.startContainer.childNodes[n.startOffset]&&"BR"===n.startContainer.childNodes[n.startOffset].nodeName&&n.startContainer.lastChild===n.startContainer.childNodes[n.startOffset]&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])&&"BR"===n.startContainer.childNodes[n.startOffset-1].nodeName&&!t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-2])&&"BR"===n.startContainer.childNodes[n.startOffset-2].nodeName},n.prototype.handleCodeBlockPointSelection=function(n,i,r){var u=this.isValidCodeBlockStructure(r),l=u.closest("UL,OL"),f,o,h,e;if(t.isNullOrUndefined(l))n.event.preventDefault(),f=t.createElement(n.enterAction),o=t.createElement("br"),"P"!==n.enterAction&&"DIV"!==n.enterAction||f.appendChild(o),h=this.isFirstAppendScenario(i),e=u.querySelector("code"),h?(t.detach(e.firstChild),u.parentElement.insertBefore(f,u)):(t.detach(e.lastChild),t.detach(e.lastChild),u.parentElement.insertBefore(f,u.nextElementSibling)),this.setNewRangeBeforeBrElement(o);else{if(n.event.preventDefault(),f=t.createElement("LI"),o=t.createElement("br"),f.appendChild(o),h=this.isFirstAppendScenario(i),e=u.querySelector("code"),h)t.detach(e.firstChild),l.insertBefore(f,u.closest("li"));else{t.detach(e.lastChild);t.detach(e.lastChild);for(var a=u.closest("li"),c=a.querySelectorAll("UL,OL"),s=0;s<c.length;s++)"UL"!==c[s].nodeName&&"OL"!==c[s].nodeName||f.appendChild(c[s]);l.insertBefore(f,a.nextElementSibling)}this.setNewRangeBeforeBrElement(o)}},n.prototype.setNewRangeBeforeBrElement=function(n){var t=this.parent.editableElement.ownerDocument.createRange();t.setStartBefore(n);t.setEndBefore(n);this.parent.nodeSelection.setRange(this.parent.currentDocument,t)},n.prototype.isSelectionWithinCodeBlock=function(n,i,r){return!t.isNullOrUndefined(this.isValidCodeBlockStructure(i))&&!t.isNullOrUndefined(this.isValidCodeBlockStructure(r))},n.prototype.handleSelectionWithinCodeBlock=function(n,i){var f,o,u;n.event.preventDefault();f=this.isValidCodeBlockStructure(i.startContainer);i.startContainer===i.endContainer&&i.startOffset===i.endOffset||i.deleteContents();var e="#text"===i.endContainer.nodeName?i.endContainer.parentElement.closest("code"):i.endContainer.closest("code"),s=e&&e.lastChild===i.startContainer&&i.endOffset===(i.endContainer.nodeType===Node.TEXT_NODE?i.endContainer.textContent.length:i.endContainer.childNodes.length)&&(t.isNullOrUndefined(i.startContainer.nextSibling)||!t.isNullOrUndefined(i.startContainer.nextSibling)&&"BR"!==i.startContainer.nextSibling.nodeName),r=t.createElement("br");(i.insertNode(r),s)&&(o=t.createElement("br"),r.parentNode.insertBefore(o,r.nextSibling));f.normalize();u=r.nextSibling;u&&u.nodeType===Node.TEXT_NODE?(i.setStart(u,0),i.setEnd(u,0)):(i.setStartAfter(r),i.setEndAfter(r));this.parent.nodeSelection.setRange(this.parent.currentDocument,i)},n.prototype.isSelectionOutsideToInside=function(n,i){return t.isNullOrUndefined(this.isValidCodeBlockStructure(n))&&!t.isNullOrUndefined(this.isValidCodeBlockStructure(i))},n.prototype.handleOutsideToInsideSelection=function(n,i,r){var o;n.event.preventDefault();var f=this.isValidCodeBlockStructure(r),u=f.querySelector("code"),e=f.previousSibling,s=i.endContainer===u.lastChild&&i.endOffset===u.lastChild.textContent.length;(i.deleteContents(),s&&0===e.textContent.length)?(this.nodeCreateBasedOnEnterAction(f,n.enterAction),f.parentNode.removeChild(f),0===e.textContent.length&&e.parentNode.removeChild(e)):u&&0!==u.childNodes.length&&""!==u.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0):u&&0===u.children.length&&u.childNodes[0]&&"BR"!==u.childNodes[0].nodeName&&(o=t.createElement("br"),u.appendChild(o),i.setStartAfter(o),i.setEndAfter(o))},n.prototype.isSelectionInsideToOutside=function(n,i){return!t.isNullOrUndefined(this.isValidCodeBlockStructure(n))&&t.isNullOrUndefined(this.isValidCodeBlockStructure(i))},n.prototype.handleInsideToOutsideSelection=function(n,i,r){var o,u,e,f,s;n.event.preventDefault();i.deleteContents();o=this.isValidCodeBlockStructure(r);u=o.querySelector("code");u&&""===u.innerHTML&&u.childNodes[0]&&"BR"!==u.childNodes[0].nodeName&&(e=t.createElement("br"),u.appendChild(e),i.setStartAfter(e),i.setEndAfter(e));f=o.nextSibling;f&&(f.nodeType===Node.TEXT_NODE?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0):(s=this.findFirstTextNode(f),s?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,s,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0)))},n.prototype.findFirstTextNode=function(n){var i,r;if(n.nodeType===Node.TEXT_NODE)return n;for(i=0;i<n.childNodes.length;i++)if(r=this.findFirstTextNode(n.childNodes[i]),!t.isNullOrUndefined(r))return r;return null},n.prototype.getSelectionRange=function(){return this.parent.editableElement.ownerDocument.defaultView.getSelection().getRangeAt(0)},n.prototype.codeBlockPasteAction=function(n){var t=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument),r="#text"===t.startContainer.nodeName?t.startContainer.parentElement:t.startContainer,u="#text"===t.endContainer.nodeName?t.endContainer.parentElement:t.endContainer,i;(this.isValidCodeBlockStructure(r)||this.isValidCodeBlockStructure(u))&&(n.event.preventDefault(),i=n.event.clipboardData.getData("text/plain"),t&&(this.isPointSelection(t)?this.handlePointSelectionPaste(t,i):this.isSameCodeBlockSelection(r,u)?this.handleSameCodeBlockPaste(t,i):this.handleCrossCodeBlockPaste(t,i,r,u,n)))},n.prototype.isPointSelection=function(n){return n.startContainer===n.endContainer&&n.startOffset===n.endOffset},n.prototype.isSameCodeBlockSelection=function(n,i){return!t.isNullOrUndefined(this.isValidCodeBlockStructure(i))&&!t.isNullOrUndefined(this.isValidCodeBlockStructure(n))&&this.isValidCodeBlockStructure(i)===this.isValidCodeBlockStructure(n)},n.prototype.handlePointSelectionPaste=function(n,t){var u=this.isValidCodeBlockStructure(n.startContainer),r=document.createTextNode(t),i;n.insertNode(r);i=this.parent.nodeSelection.findLastTextPosition(r);i&&i.node&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i.node,i.offset);u.normalize()},n.prototype.handleSameCodeBlockPaste=function(n,t){var r=document.createTextNode(t),i;n.deleteContents();n.insertNode(r);i=this.parent.nodeSelection.findLastTextPosition(r);i&&i.node&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i.node,i.offset)},n.prototype.handleCrossCodeBlockPaste=function(n,t,i,r,u){var l=this,a=this.parent.domNode.blockNodes(),e,o,f,s,h,c;n.deleteContents();e=document.createTextNode(t);this.isValidCodeBlockStructure(r)?(o=this.isValidCodeBlockStructure(r).querySelector("code")).insertBefore(e,o.firstChild):this.isValidCodeBlockStructure(i)&&(o=this.isValidCodeBlockStructure(i).querySelector("code")).appendChild(e);f=this.parent.nodeSelection.findLastTextPosition(e);f&&f.node&&(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f.node,f.offset),s=this.getSelectionRange(),h=a.filter(function(n){return l.parent.editableElement.contains(n)}),this.setCursorMarkers(s),c=u.item.currentFormat,this.processCodeBlockAction(s,h,c))},n.prototype.extractAndWrapCodeBlockContent=function(n,i){for(var h,s,o,c=n.querySelector("code"),l=n.parentElement,u=c.childNodes,f=[],e=this.parent.currentDocument.createElement(i),r=0;r<u.length;r++)"BR"!==i?"BR"!==u[r].nodeName?(h=u[r].cloneNode(!0),e.appendChild(h),u[r+1]||(f.push(e),e=null)):"BR"===u[r].nodeName&&(0!==e.childNodes.length&&f.push(e),e=this.parent.currentDocument.createElement(i),r+1<u.length&&"BR"===u[r+1].nodeName)&&(s=this.parent.currentDocument.createElement(i),s.innerHTML="<br>",f.push(s)):f.push(u[r].cloneNode(!0));for(o=0;o<f.length;o++)l.insertBefore(f[o],n);return"BR"!==i&&this.parent.editableElement.querySelectorAll(".e-rte-cursor-marker").forEach(function(n){0===n.parentElement.textContent.length&&n.parentElement.appendChild(t.createElement("BR"))}),n.remove(),f},n.prototype.isRevertCodeBlock=function(n,i){return!!(n.event&&n.event.target&&n.event.target.parentElement&&n.event.target.parentElement.classList.contains("e-split-btn")||n.event&&n.event.target&&n.event.target.classList.contains("e-split-btn"))&&!t.isNullOrUndefined(this.isValidCodeBlockStructure(i.startContainer))&&!t.isNullOrUndefined(this.isValidCodeBlockStructure(i.endContainer))},n.prototype.codeBlockCreation=function(n){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.isRevertCodeBlock(n,t)?(this.revertCodeBlockToNormalText(t,n.enterAction),this.disableToolbarItems()):this.createNewCodeBlock(t,n)},n.prototype.revertCodeBlockToNormalText=function(n,t){var e,u,o;this.setCursorMarkers(n);for(var f=this.getBlockNodes(),r=[],i=0;i<f.length;i++)e=f[i],u=this.isValidCodeBlockStructure(e),u&&(o=this.extractAndWrapCodeBlockContent(u,t),r.push.apply(r,o));for(this.restoreCursorFromMarkers(),i=0;i<r.length;i++)r[i].normalize()},n.prototype.createNewCodeBlock=function(n,t){var i,o,r,u,s;this.setCursorMarkers(n);var f=this.getBlockNodes(),e=t.item,h=this.checkTableElementInsideSelection(f),c=h.hasTableNodes,l=h.itemList;if(this.isRangeInsideTable(n)||c)if(c)for(i=0,o=l;i<o.length;i++)r=o[i],this.processCodeBlockAction(n,r,e);else for(u=0,s=f;u<s.length;u++)r=[s[u]],this.processCodeBlockAction(n,r,e);else this.processCodeBlockAction(n,f,e)},n.prototype.checkTableElementInsideSelection=function(n){for(var o,r=[],t=[],i=[],f=!1,e=0,s=n;e<s.length;e++)if(o=s[e],o.nodeType===Node.ELEMENT_NODE){var u=o,h=u.closest("td, th, thead, tbody, tr"),c=u.closest("blockquote");u&&"TABLE"===u.nodeName||h&&!h.classList.contains("e-cell-select")?(t.length>0&&r.push(t),i.length>0&&r.push(i),t=[],i=[],f=!0):c?(t.length>0&&r.push(t),i.push(u),t=[],f=!0):(i.length>0&&r.push(i),t.push(u),i=[])}return t.length>0&&r.push(t.slice()),i.length>0&&r.push(i.slice()),{hasTableNodes:f,itemList:r}},n.prototype.isRangeInsideTable=function(n){var r=1===n.startContainer.nodeType?n.startContainer:n.startContainer.parentElement,u=1===n.endContainer.nodeType?n.endContainer:n.endContainer.parentElement,t=r.closest("table"),i=u.closest("table");return!(!t||!i||t!==i)&&this.parent.editableElement.querySelectorAll("td.e-multi-cells-select, th.e-multi-cells-select").length>0},n.prototype.getBlockNodes=function(){return this.getTextAndBrNodes()},n.prototype.getTextAndBrNodes=function(){var h=this,i=[],u=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument),a=this.parent.editableElement.ownerDocument,e=this.parent.editableElement.querySelector('.e-rte-cursor-marker[data-cursor-pos="point"]'),y=this.parent.editableElement.querySelector('.e-rte-cursor-marker[data-cursor-pos="start"]'),p=this.parent.editableElement.querySelector('.e-rte-cursor-marker[data-cursor-pos="end"]'),o,v,c,n,s,l;for(t.isNullOrUndefined(e)||(o=a.createRange(),o.setStartBefore(e),o.setEndBefore(e),this.parent.nodeSelection.setRange(this.parent.currentDocument,o)),v=(u=this.parent.nodeSelection.getRange(this.parent.editableElement.ownerDocument)).commonAncestorContainer,this.includeFullNodeForRange(y,p,e),c=a.createTreeWalker(v,NodeFilter.SHOW_TEXT|NodeFilter.SHOW_ELEMENT,{acceptNode:function(n){var t=n.nodeType===Node.ELEMENT_NODE&&n.previousSibling&&"SPAN"===n.previousSibling.nodeName&&n.previousSibling.classList.contains("e-rte-cursor-marker"),i=h.parent.nodeSelection.getRange(h.parent.editableElement.ownerDocument);return(n.nodeType===Node.TEXT_NODE||"BR"===n.nodeName||t)&&n!==h.parent.editableElement&&i.intersectsNode(n)?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}}),n=c.currentNode;n;)n===this.parent.editableElement||"UL"===n.nodeName||"OL"===n.nodeName||"TD"===n.nodeName||"TH"===n.nodeName||"BLOCKQUOTE"===n.nodeName||("#text"!==n.nodeName||""===n.textContent||1===n.textContent.length&&32===n.textContent.charCodeAt(0))&&"BR"!==n.nodeName||i.push(n),n=c.nextNode();for(var f=[],w=u.startContainer===u.endContainer&&u.startOffset===u.endOffset,r=0;r<i.length;r++)s="#text"===i[0].nodeName?i[0].parentElement:i[0],l=s&&s.closest("td,th")&&s.closest("td,th").classList.contains("e-multi-cells-select"),"BR"===i[r].nodeName?l?this.wrapTableElementToList(f):(r+1<i.length&&"BR"===i[r+1].nodeName||w&&r===i.length-1)&&this.processNodeForBlockNodes(i[r],f):l?this.wrapTableElementToList(f):this.processNodeForBlockNodes(i[r],f);return f},n.prototype.includeFullNodeForRange=function(n,t,i){var u=null,r=null,e,f,s,o;if(n&&t||i){if(n=null!=n?n:i,(u=this.parent.domNode.getImmediateBlockNode(n))===this.parent.editableElement||u&&("TH"===u.nodeName||"TD"===u.nodeName))for(u=n;u&&u.previousSibling&&"BR"!==u.previousSibling.nodeName&&!this.parent.domNode.isBlockNode(u.previousSibling);){if(e=this.parent.domNode.getImmediateBlockNode(u),e!==this.parent.editableElement&&"TD"!==e.nodeName&&"TH"!==e.nodeName)break;u=u.previousSibling}if(t=null!=t?t:i,(r=this.parent.domNode.getImmediateBlockNode(t))===this.parent.editableElement||r&&("TH"===r.nodeName||"TD"===r.nodeName))for(f=t,s=(r=t)&&r.nextSibling&&"BR"===r.nextSibling.nodeName&&t&&"SPAN"===t.nodeName&&f.className&&-1!==f.className.indexOf("e-rte-cursor-marker");r&&r.nextSibling&&"BR"!==r.nextSibling.nodeName&&!this.parent.domNode.isBlockNode(r.nextSibling)||s;){if(r.nextSibling&&"BR"===r.nextSibling.nodeName&&t&&"SPAN"===t.nodeName&&f.className&&-1!==f.className.indexOf("e-rte-cursor-marker")){r=r.nextSibling;break}r=r.nextSibling}}u&&r&&(o=(this.parent.editableElement?this.parent.editableElement.ownerDocument:document).createRange(),o.setStartBefore(u),o.setEndAfter(r),this.parent.nodeSelection.setRange(this.parent.currentDocument,o))},n.prototype.wrapTableElementToList=function(n){for(var i,r,u=this.parent.editableElement.querySelectorAll("table td.e-multi-cells-select, table th.e-multi-cells-select"),t=0;t<u.length;t++){for(i=u[t],r=document.createElement("div");i.childNodes.length>0;)r.appendChild(i.childNodes[0]);i.appendChild(r);n.push(r)}},n.prototype.processNodeForBlockNodes=function(n,t){var i=this.parent.domNode.getImmediateBlockNode(n),r,s,a,o,h,v;if(i&&i!==this.parent.editableElement&&"TD"!==i.nodeName&&"TH"!==i.nodeName&&"UL"!==i.nodeName&&"OL"!==i.nodeName&&"BLOCKQUOTE"!==i.nodeName)-1===t.indexOf(i)&&t.push(i);else{for(var f=n,y=n,u=n.previousSibling;u&&"BR"!==u.nodeName&&!this.parent.domNode.isBlockNode(u);)f=u,u=u.previousSibling;for(r=n.nextSibling;r&&"BR"!==r.nodeName&&!this.parent.domNode.isBlockNode(r);)y=r,r=r.nextSibling;for(var c=this.parent.editableElement.ownerDocument.createElement("div"),e=f,l=[];e&&(l.push(e),e!==y);)e=e.nextSibling;for(s=0,a=l;s<a.length;s++)o=a[s],c.appendChild(o.cloneNode(!0));if(f.parentNode){for(f.parentNode.insertBefore(c,f),h=0,v=l;h<v.length;h++)(o=v[h]).parentNode&&o.parentNode.removeChild(o);t.push(c)}}},n.prototype.processCodeBlockAction=function(n,t,i){0!==t.length&&this.formatCodeBlock(n,t,i)},n.prototype.formatCodeBlock=function(n,i,r){var h=this,o=this.parent.editableElement.ownerDocument.createDocumentFragment(),u=t.createElement("pre"),f,e,s;u.setAttribute("data-language",r.label);u.setAttribute("spellcheck","false");f=t.createElement("code");f.className="language-"+r.language.toLowerCase().replace(/\s+/g,"");i.forEach(function(n,r){h.processNode(n,f);r<i.length-1&&f.appendChild(t.createElement("br"))});u.appendChild(f);o.appendChild(u);e=i[0];s=e.parentElement;this.insertFragmentAtNode(o,e,s);this.removeNodes(i);this.restoreCursorFromMarkers();u.normalize();this.disableToolbarItems()},n.prototype.disableToolbarItems=function(){this.parent.observer.notify(wv,{})},n.prototype.insertFragmentAtNode=function(n,i,r){for(var e,u=null,f=i;f&&f!==this.parent.editableElement;){if("LI"===f.nodeName){u=f;break}f=f.parentNode}u?(e=t.createElement("li"),e.appendChild(n),u.parentNode.insertBefore(e,u),""===u.textContent.trim()&&u.remove()):r.insertBefore(n,i)},n.prototype.removeNodes=function(n){for(var t,i=0;i<n.length;i++)t=n[i],"#text"!==t.nodeName&&t.closest("li")?t.closest("li").remove():(t.nodeName,t.remove())},n.prototype.processNode=function(n,i){var u=this,r;n.nodeType===Node.ELEMENT_NODE&&n.classList&&n.classList.contains("e-rte-cursor-marker")?i.appendChild(n.cloneNode(!0)):n.nodeType===Node.TEXT_NODE?i.appendChild(this.parent.editableElement.ownerDocument.createTextNode(n.textContent)):n.nodeType===Node.ELEMENT_NODE&&(r=n,"br"===r.tagName.toLowerCase()?i.appendChild(t.createElement("br")):Array.from(r.childNodes).forEach(function(n){return u.processNode(n,i)}))},n.prototype.setCursorMarkers=function(n){var f=t.createElement("span"),i,u,r;return(f.className="e-rte-cursor-marker",n.startContainer===n.endContainer&&n.startOffset===n.endOffset)?(f.setAttribute("data-cursor-pos","point"),(u=n.cloneRange()).insertNode(f),{startMarker:f,endMarker:null}):(i=t.createElement("span"),i.className="e-rte-cursor-marker",i.setAttribute("data-cursor-pos","start"),i.style.display="inline",r=t.createElement("span"),r.className="e-rte-cursor-marker",r.setAttribute("data-cursor-pos","end"),r.style.display="inline",(u=n.cloneRange()).collapse(!1),u.insertNode(r),(u=n.cloneRange()).collapse(!0),u.insertNode(i),{startMarker:i,endMarker:r})},n.prototype.restoreCursorFromMarkers=function(){var n=this.parent.editableElement.querySelector('[data-cursor-pos="point"]'),f,u,t,i,r;n&&((t=this.parent.editableElement.ownerDocument.createRange()).setStartBefore(n),t.setStartAfter(n),f=n.previousSibling,(n.parentNode.removeChild(n),this.parent.nodeSelection.setRange(this.parent.currentDocument,t),f)&&(u=this.parent.nodeSelection.findLastTextPosition(f),u&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,u.node,u.offset)));i=this.parent.editableElement.querySelector('[data-cursor-pos="start"]');r=this.parent.editableElement.querySelector('[data-cursor-pos="end"]');i&&r&&((t=this.parent.editableElement.ownerDocument.createRange()).setStartAfter(i),t.setEndBefore(r),i.parentNode.removeChild(i),r.parentNode.removeChild(r),this.parent.nodeSelection.setRange(this.parent.currentDocument,t))},n.prototype.findParentOrNextSiblingCodeBlock=function(n){for(var i,r=n.startContainer;r&&t.isNullOrUndefined(this.isValidCodeBlockStructure(r))&&r!==this.parent.editableElement;){for(i=r.nextSibling;i&&"BR"!==i.nodeName&&this.parent.domNode.isBlockNode(i);){if(this.isValidCodeBlockStructure(i))return{currentNode:r,nextSibling:i};if(this.parent.domNode.isBlockNode(i))break;i=i.nextSibling}if((r=r.parentElement)===this.parent.editableElement)break}return null},n.prototype.findParentOrPreviousSiblingCodeBlock=function(n){for(var i,u,r=n.startContainer;r&&t.isNullOrUndefined(this.isValidCodeBlockStructure(r))&&r!==this.parent.editableElement;){for(i=r.previousSibling;i&&"BR"!==i.nodeName&&this.parent.domNode.isBlockNode(i);){if(u=this.parent.nodeSelection.findLastTextPosition(i),u&&u.node&&this.isValidCodeBlockStructure(u.node))return{currentNode:r,previousSibling:this.isValidCodeBlockStructure(u.node)};if(this.isValidCodeBlockStructure(i))return{currentNode:r,previousSibling:i};if(this.parent.domNode.isBlockNode(i))break;i=i.previousSibling}if((r=r.parentElement)===this.parent.editableElement)break}return null},n.prototype.getCodeBlockPosition=function(n){var i=this.parent.domNode.getImmediateBlockNode(n.startContainer),r=i!==this.parent.editableElement?i:n.startContainer,t=this.parent.nodeSelection.findLastTextPosition(r);return{blockNode:r,cursorAtLastPosition:t&&t.node===n.startContainer&&t.offset===n.startOffset,nextSiblingCodeBlockElement:this.findParentOrNextSiblingCodeBlock(n)}},n.prototype.isActionDisallowedInCodeBlock=function(n,i){if(!t.isNullOrUndefined(this.isValidCodeBlockStructure(i.startContainer))||!t.isNullOrUndefined(this.isValidCodeBlockStructure(i.endContainer))){var r=n.action;if(!t.isNullOrUndefined(r)&&-1===["paste","cut","copy","decrease-fontsize","increase-fontsize","maximize","minimize","tab","undo","redo","backspace","enter","delete","code-block","space","full-screen","escape","down","up","home","end","toolbar-focus","indents","outdents","ordered-list","unordered-list","shift-tab"].indexOf(r))return!0}return!1},n.prototype.codeBlockTabAction=function(n){var t={subCommand:"TabAction",callBack:n.callBack};this.handleCodeBlockIndentation(t)},n.prototype.codeBlockShiftTabAction=function(n){var t={subCommand:"ShiftTabAction",callBack:n.callBack};this.handleCodeBlockIndentation(t)},n.prototype.handleCodeBlockIndentation=function(n){var t=this.parent.nodeSelection.getRange(this.parent.currentDocument),h="Outdent"===n.subCommand||"ShiftTabAction"===n.subCommand,c=this.isValidCodeBlockStructure(t.startContainer),f=this.parent.nodeSelection.getSelectedNodes(this.parent.editableElement.ownerDocument),i,o,s,u,r;if(t.startContainer===t.endContainer&&t.startOffset===t.endOffset)if(h){if(t.startOffset>0&&"\t"===t.startContainer.textContent[t.startOffset-1]){var a=(r=t.startContainer.textContent).substring(0,t.startOffset-1),v=r.substring(t.startOffset),y=this.parent.currentDocument.createTextNode(a),e=this.parent.currentDocument.createTextNode(v),l=t.startContainer.parentElement;l.replaceChild(e,t.startContainer);l.insertBefore(y,e);(i=this.parent.editableElement.ownerDocument.createRange()).setStart(e,0);i.setEnd(e,0);this.parent.nodeSelection.setRange(this.parent.currentDocument,i)}}else o=this.parent.currentDocument.createTextNode("\t"),t.insertNode(o),(i=this.parent.editableElement.ownerDocument.createRange()).setStartAfter(o),i.setEndAfter(o),this.parent.nodeSelection.setRange(this.parent.currentDocument,i);else if(f&&f.length>0){for(this.setCursorMarkers(t),s=0;s<f.length;s++)u=f[s],3===u.nodeType&&(r=u.textContent||"",h?r.startsWith("\t")&&(u.textContent=r.substring(1)):u.textContent="\t"+r);this.restoreCursorFromMarkers()}c.normalize();"TabAction"!==n.subCommand&&"ShiftTabAction"!==n.subCommand&&n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:c})},n}(),nft=function(){function n(n,t){this.INVALID_TAGS=["A","AUDIO","IMG","VIDEO","IFRAME"];this.parent=n;this.settings=t;this.addEventListener();this.setDeniedFormats()}return n.prototype.addEventListener=function(){this.parent.observer.on(vv,this.actionHandler,this);this.parent.observer.on(pr,this.onPropertyChanged,this);this.parent.observer.on(f,this.destroy,this)},n.prototype.onPropertyChanged=function(n){n&&"formatPainter"===n.module&&(t.isNullOrUndefined(n.newProp.formatPainterSettings.allowedFormats)||(this.settings.allowedFormats=n.newProp.formatPainterSettings.allowedFormats),t.isNullOrUndefined(n.newProp.formatPainterSettings.deniedFormats)||(this.settings.deniedFormats=n.newProp.formatPainterSettings.deniedFormats,this.setDeniedFormats()))},n.prototype.removeEventListener=function(){this.parent.observer.off(vv,this.actionHandler);this.parent.observer.off(pr,this.onPropertyChanged);this.parent.observer.off(f,this.destroy)},n.prototype.destroy=function(){this.removeEventListener();this.INVALID_TAGS=null;this.copyCollection=null;this.deniedFormatsCollection=null;this.newElem=null;this.newElemLastChild=null;this.settings=null;this.parent=null},n.prototype.actionHandler=function(n){if(!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.item)&&!t.isNullOrUndefined(n.item.formatPainterAction)){switch(n.item.formatPainterAction){case"format-copy":this.copyAction();break;case"format-paste":this.pasteAction();break;case"escape":this.escapeAction()}this.callBack(n)}},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:"FormatPainter",action:n.item.formatPainterAction,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.generateElement=function(){var c=this.copyCollection.slice(),f,s,h,r,w,y,i;c.reverse();for(var u,b=c.length,l=t.createElement("div",{className:"e-format-paste-wrapper"}),a=0;a<b;a++){var e=c[a],v=e.attrs,p=e.className,o=e.styles,k=e.tagName,n=t.createElement(k);for(""!==p&&(n.className=p),f=0;f<v.length;f++)s=v[f].name,h=v[f].value,n.setAttribute(s,h);for(r=0;r<o.length;r++)s=o[r].property,h=o[r].value,w=o[r].priority,n.style.setProperty(s,h,w);0===l.childElementCount?(l.append(n),u=n):(u.append(n),u=n)}for(y=this.removeDeniedFormats(l),i=y;i;)null===i.firstChild?(u=i,i=void 0):i=i.firstChild;this.newElem=y;this.newElemLastChild=u},n.prototype.pasteAction=function(){t.isNullOrUndefined(this.copyCollection)||0===this.copyCollection.length?this.paintPlainTextFormat():this.insertFormatNode(this.newElem,this.newElemLastChild)},n.prototype.removeDeniedFormats=function(n){var c,f,r,s,l,h,a;if(!t.isNullOrUndefined(this.deniedFormatsCollection)&&this.deniedFormatsCollection.length>0)for(var e=this.deniedFormatsCollection,v=e.length,u=0;u<v;u++)if(c=e[u].tag,e[u].tag)for(f=n.querySelectorAll(c),r=0;r<f.length;r++){if(e[u].classes.length>0){for(var o=e[u].classes,y=o.length,i=0;i<y;i++)f[r].classList.contains(o[i])&&t.removeClass([f[r]],o[i].trim());0===f[r].classList.length&&f[r].removeAttribute("class")}if(e[u].styles.length>0){for(s=e[u].styles,l=s.length,i=0;i<l;i++)f[r].style.removeProperty(s[i].trim());0===f[r].style.length&&f[r].removeAttribute("style")}if(e[u].attributes.length>0)for(h=e[u].attributes,a=h.length,i=0;i<a;i++)f[r].removeAttribute(h[i].trim())}return n.firstElementChild},n.prototype.copyAction=function(){var a=[],r=this.parent.nodeSelection.getRange(this.parent.currentDocument),f=this.parent.nodeSelection,e=r.collapsed?f.getSelectionNodeCollection(r):f.getSelectionNodeCollectionBr(r),y,u,c;if(0!==e.length||0!==f.getSelectionNodeCollectionBr(r).length){for(var n=(e=0===e.length?f.getSelectionNodeCollectionBr(r):e)[0].parentElement,o=this.findCurrentContext(n),s=this.settings.allowedFormats.indexOf(";")>-1?this.settings.allowedFormats.split(";"):[this.settings.allowedFormats],i=0;i<s.length;i++)s[i]=s[i].trim();var v=this.getRangeParentElem(o,n),w=v[0],b=v[1];if(null===o&&(o=b),!t.isNullOrUndefined(o)){"#text"===r.startContainer.nodeName&&(n=r.startContainer.parentElement);y=n;do{if(s.indexOf(n.nodeName.toLowerCase())>-1){for(u=n.attributes,c=[],i=0;i<u.length;i++)"class"!==u[i].name&&"style"!==u[i].name&&c.push(u[i]);var k=n.className,h=n.style,p=[];for(i=0;i<h.length;i++){var l=h[i],d=h.getPropertyValue(l),g=h.getPropertyPriority(l);p.push({property:l,value:d,priority:g})}a.push({attrs:c,className:k,styles:p,tagName:n.nodeName})}if(w===n?n=void 0:t.isNullOrUndefined(n.parentElement)||(n=n.parentElement),y===n)break}while(!t.isNullOrUndefined(n)||n===this.parent.editableElement);this.copyCollection=a}this.generateElement()}},n.prototype.getRangeParentElem=function(n,i){var r,u=i,f;switch(3===u.nodeType&&(u=u.parentElement),n){case"Table":r=t.closest(u,"td");t.isNullOrUndefined(r)&&(r=t.closest(u,"th"));break;case"List":r=t.closest(u,"li");break;case"Text":r=t.closest(u,"p")}return t.isNullOrUndefined(r)&&(f=this.getNearestBlockParentElement(i),t.isNullOrUndefined(f)||"UL"===f||"OL"===f||"LI"===f||(r=t.closest(u,f),n="Text")),"List"===n&&(r=r.parentElement),[r,n]},n.prototype.getNearestBlockParentElement=function(n){var i=n;for(3===i.nodeType&&(i=i.parentNode);i&&i!==this.parent.editableElement;){if(!t.isNullOrUndefined(i)&&this.isBlockElement(i))return i.nodeName;i=i.parentNode}return null},n.prototype.isBlockElement=function(n){return["P","DIV","UL","OL","LI","H1","H2","H3","H4","H5","H6","ADDRESS","ARTICLE","ASIDE","BLOCKQUOTE","FIGCAPTION","FIGURE","FOOTER","HEADER","HR","MAIN","NAV","SECTION","SUMMARY","PRE"].indexOf(n.nodeName)>-1},n.prototype.escapeAction=function(){this.copyCollection=[]},n.prototype.paintPlainTextFormat=function(){var i,n=this.parent.nodeSelection.getRange(this.parent.currentDocument),u=this.parent.nodeSelection,r=n.collapsed?u.getSelectionNodeCollection(n):u.getSelectionNodeCollectionBr(n),t;if(r.length>1)for(t=0;t<r.length;t++)i=this.validateELementTag(r[t]);else i=this.validateELementTag(n.startContainer)&&this.validateELementTag(n.endContainer);i||this.parent.execCommand("Clear","ClearFormat",null,null)},n.prototype.validateELementTag=function(n){return 3===n.nodeType&&(n=n.parentElement),this.INVALID_TAGS.indexOf(n.tagName)>-1},n.prototype.findCurrentContext=function(n){var i=t.closest(n,"p"),r=t.closest(n,"li");return i&&!r?"Text":t.closest(n,"li")?t.isNullOrUndefined(i)||t.isNullOrUndefined(r)||i.textContent.trim()===r.textContent.trim()?"List":"Text":t.closest(n,"td")||t.closest(n,"tr")||t.closest(n,"th")?"Table":null},n.prototype.insertFormatNode=function(n,i){var e=n.cloneNode(!0),o,a,f,c;this.isBlockElement(n)||(o=t.createElement("P"),o.appendChild(n),e=o.cloneNode(!0));for(var l,v=this.parent.editableElement,s=this.parent.currentDocument,u=e.firstChild;u;){if(!this.isBlockElement(u)){l=u.parentNode.removeChild(u);break}u=u.firstChild}a={element:l,lastChild:i};fp.applyFormat(s,null,v,"P",null,"formatPainter",null,a);var h=this.parent.nodeSelection.getRange(s),y=h.collapsed,r=this.parent.domNode.blockNodes();if(this.isListCopied())for(f=0;f<r.length;f++)t.closest(r[f],"li")&&(r[f]=t.closest(r[f],"li"));c=!1;1===r.length&&(c=r[0].textContent.trim()===h.toString().trim());(this.isBlockElement(e)&&y||r.length>1||c)&&this.insertBlockNode(e,h,s,r)},n.prototype.isListCopied=function(){for(var t=!1,n=0;n<this.copyCollection.length;n++)if("OL"===this.copyCollection[n].tagName||"UL"===this.copyCollection[n].tagName){t=!0;break}return t},n.prototype.insertBlockNode=function(n,i,r,u){var a,o,v=this.parent.nodeSelection.save(i,r),h,y,f,e,s,c,l;for(this.parent.domNode.setMarker(v),h=!1,"UL"!==n.nodeName&&"OL"!==n.nodeName||(a=(o=n.cloneNode(!0)).firstChild),y=t.isNullOrUndefined(o)?n:n.firstChild,f=0;f<u.length;f++)if(!(this.INVALID_TAGS.indexOf(u[f].nodeName)>-1||u[f].querySelectorAll("img,audio,video,iframe").length>0)){for(e=y.cloneNode(!1);u[f].firstChild;)0!==u[f].textContent.trim().length?e.appendChild(u[f].firstChild):u[f].removeChild(u[f].firstChild);if("TD"!==u[f].nodeName&&"TH"!==u[f].nodeName){if(t.isNullOrUndefined(o)||(h=this.isSameListType(n,u[f])),"LI"!==e.nodeName||h?h?this.insertSameList(u,f,o,e):u[f].parentNode.replaceChild(e,u[f]):this.insertNewList(i,u,f,o,e),"LI"!==e.nodeName&&("OL"===e.parentElement.nodeName||"UL"===e.parentElement.nodeName))if(s=e.parentElement,this.parent.nodeCutter.SplitNode(i,s,!0),t.isNullOrUndefined(s.previousElementSibling))s.parentElement.prepend(e);else if(s.previousElementSibling.after(e),e.childNodes.length>1)for(c=0;c<e.childNodes.length;c++)l=e.childNodes[c],"OL"!==l.nodeName&&"UL"!==l.nodeName||e.after(l)}else{if(t.isNullOrUndefined(o)){u[f].appendChild(e);continue}if(0!==f||t.isNullOrUndefined(o)){u[f].appendChild(e);continue}u[f].appendChild(o);o.appendChild(e)}}t.isNullOrUndefined(a)||t.detach(a);this.cleanEmptyLists();this.parent.domNode.saveMarker(v).restore()},n.prototype.insertNewList=function(n,i,r,u,f){var s,e,o;if(0===r)if(s=i[r].nodeName,i[r]=i[r].parentNode.replaceChild(u,i[r]),e="LI"===s?u.parentElement:u,this.parent.nodeCutter.SplitNode(n,e,!0),"LI"!==i[r].nodeName||t.isNullOrUndefined(e))if(t.isNullOrUndefined(e))u.append(f);else if(t.isNullOrUndefined(e.previousElementSibling)||e.previousElementSibling.nodeName!==u.nodeName)if(t.isNullOrUndefined(e.nextElementSibling)||e.nextElementSibling.nodeName!==u.nodeName)u.append(f);else for((o=e.nextElementSibling).prepend(f);o.firstChild;)u.append(o.firstChild);else for((o=e.previousElementSibling).append(f);o.firstChild;)u.append(o.firstChild);else u.append(f),t.isNullOrUndefined(e.parentNode)||e.parentNode.insertBefore(u,e);else u.append(f);this.detachEmptyBlockNodes(i[r])},n.prototype.insertSameList=function(n,i,r,u){var f,o,e;if(0===i){if(!t.isNullOrUndefined(n[i].parentNode)&&("UL"===n[i].parentNode.nodeName||"OL"===n[i].parentNode.nodeName)){if(1===n.length){for(;u.firstChild;)n[i].append(u.firstChild);for(f=0;f<n[i].parentNode.childNodes.length;f++)o=n[i].parentNode.childNodes[f],r.append(o.cloneNode(!0))}else r.append(u);e=void 0;n[i].parentNode&&(e=Array.from(n[i].parentNode.childNodes).map(function(n){return n.textContent.trim()}).join(""));e===Array.from(n).map(function(n){return n.textContent.trim()}).join("")||n[i].parentNode&&n[i].parentNode.textContent===r.textContent?n[i].parentNode.parentNode.replaceChild(r,n[i].parentNode):n[i].parentNode.replaceChild(u,n[i])}}else r.parentNode?r.append(u):n[i].parentNode.replaceChild(u,n[i]);this.detachEmptyBlockNodes(n[i])},n.prototype.isSameListType=function(n,i){var u=!1,r=t.closest(i,"ol, ul");return!t.isNullOrUndefined(r)&&r.querySelectorAll("li").length>0&&(u=r.nodeName===n.nodeName),u},n.prototype.cleanEmptyLists=function(){for(var i=this.parent.editableElement.querySelectorAll("ol, ul"),n=0;n<i.length;n++)""===i[n].textContent.trim()&&t.detach(i[n])},n.prototype.setDeniedFormats=function(){var u=[],n,r;if(!t.isNullOrUndefined(this.settings)&&!t.isNullOrUndefined(this.settings.deniedFormats)){for(var f=this.settings.deniedFormats.indexOf(";")>-1?this.settings.deniedFormats.split(";"):[this.settings.deniedFormats],e=f.length,i=0;i<e;i++)n=f[i],""!==n&&(n.trim(),r=this.makeDeniedFormatsCollection(n),t.isNullOrUndefined(r)||u.push(r));this.deniedFormatsCollection=u}},n.prototype.detachEmptyBlockNodes=function(n){t.isNullOrUndefined(n)||""!==n.textContent.trim()||t.detach(n)},n.prototype.makeDeniedFormatsCollection=function(n){var u=n.indexOf("("),o=n.indexOf(")"),f=n.indexOf("["),s=n.indexOf("]"),e=n.indexOf("{"),h=n.indexOf("}"),c=[],l=[],a=[],i,t,r;return u>-1&&o>-1&&(c=n.substring(u+1,o).split(" ")[0].split(")")[0].split(",")),f>-1&&s>-1&&(l=n.substring(f+1,s).split(",")),e>-1&&h>-1&&(a=n.substring(e+1,h).split(",")),t=[u,f,e],r=(t=t.filter(function(n){return n>-1})).length,1===r?i=t[0]:2===r?i=Math.min(t[0],t[1]):3===r&&(i=Math.min(t[0],t[1],t[2])),{tag:n.substring(0,i).trim(),styles:a,classes:c,attributes:l}},n}(),kct=function(){function n(n){this.isSticky=!1;this.isActive=!1;this.parent=n;this.addEventListener();this.isDestroyed=!1}return n.prototype.addEventListener=function(){this.parent.on(bl,this.toolbarClick,this);this.parent.on(kl,this.toolbarDoubleClick,this);this.parent.on(vt,this.editAreaClick,this);this.parent.on(y,this.onKeyDown,this);this.parent.on(u,this.destroy,this);this.parent.on(b,this.bindOnEnd,this)},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager.formatPainterObj||(this.parent.formatter.editorManager.formatPainterObj=new nft(this.parent.formatter.editorManager,this.parent.formatPainterSettings))},n.prototype.toolbarClick=function(n){this.parent.focusIn();this.isSticky?(n.args.action="escape",this.actionHandler(n,"keyBoard")):(this.isActive=!0,this.actionHandler(n,"click"));this.parent.quickToolbarModule&&!t.isNullOrUndefined(this.parent.quickToolbarSettings.text)&&this.parent.quickToolbarModule.textQTBar&&this.parent.element.ownerDocument.contains(this.parent.quickToolbarModule.textQTBar.element)&&this.parent.quickToolbarModule.textQTBar.hidePopup()},n.prototype.toolbarDoubleClick=function(n){this.isActive=!0;this.isSticky=!0;this.parent.focusIn();this.actionHandler(n,"dbClick")},n.prototype.onKeyDown=function(n){var i=n.args;(t.isNullOrUndefined(i)||t.isNullOrUndefined(i.action)||"format-copy"!==i.action&&"format-paste"!==i.action)&&("escape"!==i.action||"format-copy"!==this.previousAction&&"format-paste"!==this.previousAction)||("format-copy"!==i.action&&"format-paste"!==i.action||i.stopPropagation(),"Firefox"!==this.parent.userAgentData.getBrowser()&&"Safari"!==this.parent.userAgentData.getBrowser()||i.preventDefault(),this.actionHandler(n,"keyBoard"))},n.prototype.actionHandler=function(n,i){var r,u,f,o=!1,e,s,h;switch(i){case"dbClick":case"click":f=n.args.item;u=n.args.originalEvent;r="format-copy";break;case"keyBoard":u=n.args;o=!0;"escape"===(r=n.args.action)&&(this.isSticky=!1,this.isActive=!1);break;case"docClick":u=n;r="format-paste"}t.isNullOrUndefined(f)&&(f={command:"FormatPainter",subCommand:"FormatPainter"});e={requestType:"FormatPainter",originalEvent:u,name:r,item:f};s={formatPainterAction:r};(this.parent.formatter.process(this.parent,e,u,s),e.cancel)||(this.updateCursor(o),h="docClick"!==i&&"escape"!==r,this.updateToolbarBtn(h));this.previousAction=r},n.prototype.updateCursor=function(n){this.parent.inputElement.classList.contains("e-rte-cursor-brush")||n?this.isSticky||t.removeClass([this.parent.inputElement],"e-rte-cursor-brush"):t.addClass([this.parent.inputElement],"e-rte-cursor-brush")},n.prototype.updateToolbarBtn=function(n){if(!t.isNullOrUndefined(this.parent.element.querySelector(".e-rte-format-painter"))){var i=this.parent.element.querySelector(".e-rte-format-painter").parentElement.parentElement;n?t.addClass([i],"e-active"):this.isSticky||t.removeClass([i],"e-active")}},n.prototype.editAreaClick=function(n){this.isActive&&(this.isSticky||(this.isActive=!1),this.actionHandler(n,"docClick"),this.updateToolbarBtn(!1))},n.prototype.destroy=function(){this.isDestroyed||(this.parent.off(bl,this.toolbarClick),this.parent.off(vt,this.editAreaClick),this.parent.off(kl,this.toolbarDoubleClick),this.parent.off(y,this.onKeyDown),this.parent.off(u,this.destroy),this.parent.off(b,this.bindOnEnd),this.parent=null,this.isSticky=null,this.isActive=null,this.previousAction=null,this.isDestroyed=!0)},n.prototype.getModuleName=function(){return"formatPainter"},n}(),dct=function(){function n(n,t){this.noResultsFoundCount=0;this.parent=n;this.locator=t;this.i10n=t.getService("rteLocale");this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.isDestroyed=!1;this.isPopupDestroyed=!1}return n.prototype.destroy=function(){this.isDestroyed||(this.removeEventListener(),this.isDestroyed=!0)},n.prototype.childDestroy=function(){var n,i,r,u;this.isPopupDestroyed||(this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.element&&this.popupObj.element.querySelector(".e-rte-emoji-search")&&(n=t.getComponent(this.popupObj.element.querySelector(".e-rte-emoji-search"),"textbox"),n&&!n.isDestroyed&&n.destroy()),this.popupObj.element&&this.popupObj.element.querySelector(".e-rte-emojipicker-toolbar")&&(i=t.getComponent(this.popupObj.element.querySelector(".e-rte-emojipicker-toolbar"),"toolbar"),i&&!i.isDestroyed&&i.destroy()),r=this.popupObj.element.querySelector(".e-clear-icon"),t.isNullOrUndefined(r)||t.EventHandler.remove(r,"mousedown",this.searchFilter),this.popupObj.destroy(),this.isPopupDestroyed=!0),this.popDiv&&(t.EventHandler.remove(this.popDiv,"keydown",this.onKeyDown),t.EventHandler.remove(this.popDiv,"keyup",this.searchFilter),this.popDiv.querySelector(".e-rte-emojipicker-btn"))&&(u=this.popDiv.querySelector(".e-rte-emojipicker-btn"),t.EventHandler.remove(u,"scroll",this.scrollEvent),t.EventHandler.remove(u,"click",this.emojiBtnClick)))},n.prototype.addEventListener=function(){this.parent.on(es,this.toolbarClick,this);this.parent.on(gr,this.docClick,this);this.parent.on(ut,this.onIframeMouseDown,this);this.parent.on(y,this.onkeyPress,this);this.parent.on(tt,this.onkeyUp,this);this.parent.on(ai,this.contentscroll,this);this.parent.on(li,this.contentscroll,this);this.parent.on(u,this.destroy,this);this.parent.on(b,this.bindOnEnd,this)},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager.emojiPickerObj||(this.parent.formatter.editorManager.emojiPickerObj=new dut(this.parent.formatter.editorManager))},n.prototype.toolbarClick=function(n){var k,d,l,e=this,at,g,nt,vt,r,s,h,tt,a,v,it,c,y,i,p,u,rt,ut,et,w,b,st,o,f,ht,yt,ct,lt;if(this.noResultsFoundCount=0,t.isNullOrUndefined(this.parent.element.querySelector(".e-emoji"))?this.parent.inlineMode.enable&&(l=this.parent.element.ownerDocument.querySelector(".e-emoji")):l=this.parent.element.querySelector(".e-emoji"),this.divElement=l.closest("div"),this.parent.inputElement.contains(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).startContainer)||this.parent.contentModule.getEditPanel().focus(),at=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),this.save=this.parent.formatter.editorManager.nodeSelection.save(at,this.parent.contentModule.getDocument()),this.clickEvent=n.args,g=this.parent.emojiPickerSettings.iconsSet,this.popupObj){if(t.removeClass([this.divElement],"e-active"),this.popupObj.element.querySelector(".e-rte-emoji-search")||!this.parent.emojiPickerSettings.showSearchBox)return void this.popupObj.hide();this.popupObj.hide()}for(this.popDiv=this.parent.createElement("div",{className:"e-rte-emojipicker-popup",id:this.parent.getID()+"_emojiPicker"}),nt=n.args?n.args.originalEvent.target:this.parent.inputElement,t.isNullOrUndefined(this.parent.getToolbar())||this.parent.inlineMode.enable||"Bottom"===this.parent.toolbarSettings.position&&nt===this.parent.inputElement?(this.parent.inlineMode.enable||"Bottom"===this.parent.toolbarSettings.position||nt===this.parent.inputElement)&&this.parent.rootContainer.appendChild(this.popDiv):this.parent.getToolbar().parentElement.appendChild(this.popDiv),t.EventHandler.add(this.popDiv,"keydown",this.onKeyDown,this),t.EventHandler.add(this.popDiv,"keyup",this.searchFilter,this),tt=this.parent.element.querySelector(".e-toolbar-extended"),(vt=t.isNullOrUndefined(tt)?"10001":window.getComputedStyle(tt).getPropertyValue("z-index"),"Bottom"===this.parent.toolbarSettings.position&&(n.y=n.y-this.parent.getToolbar().getBoundingClientRect().height),!t.isNullOrUndefined(n.args)&&!this.parent.inlineMode.enable&&(t.isNullOrUndefined(this.parent.quickToolbarSettings.text)||!t.isNullOrUndefined(this.parent.quickToolbarSettings.text)&&t.isNullOrUndefined(this.parent.element.querySelector(".e-rte-quick-toolbar"))))?(r=(r=n.args.originalEvent.target).classList.contains("e-toolbar-item")?r.firstChild:r.parentElement,s="left",h="bottom"):t.isNullOrUndefined(n.x)&&t.isNullOrUndefined(n.y)&&!this.parent.inlineMode.enable&&t.isNullOrUndefined(this.parent.quickToolbarSettings.text)?(r=this.parent.inputElement,this.parent.contentModule.getDocument().getSelection().rangeCount>0&&(s=(a=this.getCoordinates()).left,h=a.top)):t.isNullOrUndefined(n.x)&&t.isNullOrUndefined(n.y)&&(this.parent.inlineMode.enable||!t.isNullOrUndefined(this.parent.quickToolbarSettings.text))?(this.parent.notify(os,{}),this.parent.contentModule.getDocument().getSelection().rangeCount>0&&(s=(a=this.getCoordinates()).left,h=a.top)):(r=this.parent.inputElement,s=n.x,h=n.y),(this.popupObj=new wi.Popup(this.popDiv,{targetType:"relative",relateTo:r,collision:{X:"fit",Y:"none"},offsetY:8,viewPortElement:this.parent.element,position:{X:s,Y:h},enableRtl:this.parent.enableRtl,zIndex:parseInt(vt,10)+1,actionOnScroll:"hide",close:function(){e.parent.isBlur=!1;e.childDestroy();e.popupObj.element.parentElement.style.zIndex="";t.detach(e.popupObj.element);e.popupObj=null;e.divElement.firstChild.focus()}}),this.isPopupDestroyed=!1,t.addClass([this.popupObj.element],"e-popup-open"),this.popupObj.element.parentElement.style.zIndex="11",this.popupObj.refreshPosition(r),this.positionDialogue(r,l),(!t.isNullOrUndefined(n.args)||t.isNullOrUndefined(n.x)&&t.isNullOrUndefined(n.y))&&this.parent.emojiPickerSettings.showSearchBox)&&(v=t.createElement("input",{id:"e-rte-emoji-search",className:"e-rte-emoji-search"}),this.popDiv.append(v),new ot.TextBox({placeholder:this.i10n.getConstant("emojiPickerTypeToFind"),showClearButton:!0}).appendTo(v),this.parent.userAgentData.isSafari()&&this.parent.inputElement.contains(this.parent.getRange().startContainer)&&this.parent.notify(ft,{}),v.focus()),it=this.popupObj.element.querySelector(".e-clear-icon"),t.isNullOrUndefined(it)||t.EventHandler.add(it,"mousedown",this.searchFilter,this),c=this.parent.createElement("div",{className:"e-rte-emojipicker-toolbar"}),this.popDiv.appendChild(c),y=[],i=0;i<this.parent.emojiPickerSettings.iconsSet.length;i++)t.isNullOrUndefined(this.parent.emojiPickerSettings.iconsSet[i].iconCss)?y.push({text:"&#x"+this.parent.emojiPickerSettings.iconsSet[i].code+";",htmlAttributes:(d={},d.title=this.parent.emojiPickerSettings.iconsSet[i].name,d)}):y.push({prefixIcon:this.parent.emojiPickerSettings.iconsSet[i].iconCss,htmlAttributes:(k={},k.title=this.parent.emojiPickerSettings.iconsSet[i].name,k)});for(new nit.Toolbar({items:y,clicked:this.emojiToolbarClick.bind(this)}).appendTo(c),u=this.parent.createElement("div",{className:"e-rte-emojipicker-btn"}),this.popDiv.appendChild(u),rt=window.getComputedStyle(this.popDiv),(!t.isNullOrUndefined(n.args)||t.isNullOrUndefined(n.x)&&t.isNullOrUndefined(n.y))&&this.parent.emojiPickerSettings.showSearchBox?(ut=this.parent.element.querySelector(".e-rte-emoji-search").parentElement,et=window.getComputedStyle(ut),p=this.popDiv.getBoundingClientRect().height-c.getBoundingClientRect().height-ut.getBoundingClientRect().height-parseFloat(et.marginTop)-parseFloat(et.marginBottom)-2*parseFloat(rt.borderWidth)+"px",u.style.setProperty("height",p,"important")):(p=this.popDiv.getBoundingClientRect().height-c.getBoundingClientRect().height-2*parseFloat(rt.borderWidth)+"px",u.style.setProperty("height",p,"important")),i=0;i<g.length;i++)for(w=this.parent.createElement("div",{className:"e-rte-emojipicker-group"}),u.appendChild(w),b=this.parent.createElement("div",{className:"e-rte-emojipicker-name"}),b.innerText=this.parent.emojiPickerSettings.iconsSet[i].name,b.setAttribute("aria-label",this.parent.emojiPickerSettings.iconsSet[i].name),w.appendChild(b),st=this.parent.createElement("div",{className:"e-rte-emojipickerbtn-group"}),w.appendChild(st),o=0;o<g[i].icons.length;o++)f=this.parent.createElement("button",{className:"e-btn  e-control"}),f.innerHTML=this.buttoncode(this.parent.emojiPickerSettings.iconsSet[i].icons[o].code),f.setAttribute("aria-label",this.parent.emojiPickerSettings.iconsSet[i].icons[o].desc),f.setAttribute("title",this.parent.emojiPickerSettings.iconsSet[i].icons[o].desc),st.appendChild(f),f.innerHTML.length>2&&(f.style.fontSize="17px");t.EventHandler.add(u,"scroll",this.scrollEvent,this);t.EventHandler.add(u,"click",this.emojiBtnClick,this);ht=this.parent.element.querySelectorAll(".e-rte-emojipicker-btn button");t.isNullOrUndefined(this.parent.element.querySelector(".e-rte-emoji-search"))&&!t.isNullOrUndefined(n.args)&&(ht[0].focus(),t.addClass([ht[0]],"e-focus"));ct=this.parent.element.querySelector(".e-rte-emojipicker-btn");lt=this.parent.element.querySelectorAll(".e-rte-emojipicker-toolbar button");t.isNullOrUndefined(ct)||(yt=Math.round(ct.scrollTop));yt<lt[0].offsetHeight&&t.addClass([lt[0]],"e-selected");this.popupObj&&t.addClass([this.divElement],"e-active")},n.prototype.positionDialogue=function(n,t){var e;if(this.parent.inputElement!==n){var i,s=window.innerHeight,o=this.popDiv.getBoundingClientRect().height,h=s-t.getBoundingClientRect().top,r=t.closest(".e-toolbar-item"),c="Popup"===this.parent.toolbarSettings.type,u=this.parent.toolbarModule.getToolbarElement(),f=u?u.querySelector(".e-toolbar-extended"):u;r?c?(i=r.getBoundingClientRect().height,r.parentElement.getBoundingClientRect().top<u.getBoundingClientRect().top&&(i=u.getBoundingClientRect().height+r.parentElement.getBoundingClientRect().height)):i=r.parentElement.getBoundingClientRect().height:(e=this.parent.element.querySelector(".e-toolbar-item"),e&&(i=e.parentElement.getBoundingClientRect().height));f&&r.parentElement!==f&&(i+=f.getBoundingClientRect().height);h<o&&t.getBoundingClientRect().top>o&&(this.popupObj.element.style.setProperty("top","auto"),this.popupObj.element.style.setProperty("bottom",i+"px"))}},n.prototype.onIframeMouseDown=function(){this.popupObj&&(t.removeClass([this.divElement],"e-active"),this.popupObj.hide())},n.prototype.buttoncode=function(n){return n.split("-").map(function(n){return String.fromCodePoint(parseInt(n,16))}).join("‍")},n.prototype.docClick=function(n){var i=n.args.target;i&&i.classList&&this.popupObj&&!t.closest(i,"[id='"+this.popupObj.element.id+"']")&&!i.classList.contains("e-emoji")&&!i.classList.contains("e-toolbar-item")&&this.popupObj&&(t.removeClass([this.divElement],"e-active"),this.popupObj.hide())},n.prototype.scrollEvent=function(){var f,e=this.parent.element.querySelector(".e-rte-emojipicker-btn"),o=this.parent.element.querySelectorAll(".e-rte-emojipicker-group"),n=this.parent.element.querySelectorAll(".e-rte-emojipicker-toolbar button"),s,r,i,u;for(t.isNullOrUndefined(e)||(f=Math.round(e.scrollTop)),s=0,r=0;r<n.length;r++)f<n[0].offsetHeight&&(t.isNullOrUndefined(n[r+1])||t.removeClass([n[r+1]],"e-selected"),t.addClass([n[0]],"e-selected"));for(i=0;i<o.length;i++)if(f>=(s+=Math.round(o[i].offsetHeight))){for(u=0;u<n.length;u++)n[u].classList.contains("e-selected")&&t.removeClass([n[u]],"e-selected");t.isNullOrUndefined(n[i+1])||t.addClass([n[i+1]],"e-selected")}},n.prototype.contentscroll=function(){if(t.isNullOrUndefined(this.clickEvent)&&this.popupObj)return t.removeClass([this.divElement],"e-active"),void this.popupObj.hide()},n.prototype.emojiToolbarClick=function(n){for(var e,f,o=n.item.htmlAttributes.title,s=this.parent.element.querySelectorAll(".e-rte-emojipicker-group"),r=this.parent.element.querySelectorAll(".e-rte-emojipicker-btn button"),u=this.parent.element.querySelectorAll(".e-rte-emojipicker-toolbar button"),i=0;i<u.length;i++)u[i].classList.contains("e-selected")&&t.removeClass([u[i]],"e-selected");for(i=0;i<r.length;i++)r[i].classList.contains("e-focus")&&t.removeClass([r[i]],"e-focus");e=this.parent.element.querySelector(".e-rte-emojipicker-btn");f=0;s.forEach(function(n){var r=n.childNodes[0],i=n.childNodes[1].childNodes[0],u=r.getAttribute("aria-label");o===u?r&&(e.scrollTop=f+10,t.addClass([i],"e-focus"),i.focus()):(f+=n.scrollHeight,t.removeClass([i],"e-focus"))})},n.prototype.onKeyDown=function(n){var r=this.parent.element.querySelectorAll(".e-rte-emojipicker-btn button"),e=this.parent.element.querySelectorAll(".e-rte-emojipickerbtn-group"),k=this.parent.element.querySelector(".e-rte-emojisearch-btn button"),a,f,h,c,u,s,v,o,i,y,b,p;if(27===n.keyCode&&this.popupObj&&(t.removeClass([this.divElement],"e-active"),this.popupObj.hide()),13===n.keyCode&&document.activeElement.classList.contains("e-btn")&&(this.emojiBtnClick(n),n.preventDefault()),a=n.srcElement,!t.isNullOrUndefined(a)&&a.classList.contains("e-rte-emoji-search")&&40===n.keyCode)for(f=0;f<r.length;f++)r[f].classList.contains("e-focus")&&t.removeClass([r[f]],"e-focus");if(t.isNullOrUndefined(k)){for(f=0;f<r.length;f++)if(h=f,r[f].classList.contains("e-focus"))if(40===n.keyCode){if(r.length-4>f){for(c=0,u=0;u<e.length;u++)for(s=0;s<e[u].childNodes.length;s++)if(e[u].childNodes[s].classList.contains("e-focus")&&1!==c){var l=s,d=e[u].lastChild,w=Math.floor(s%6),g=e[u].childNodes.length-1,nt=Math.floor(g%6);if(-1!==l){if(v=l+6,t.isNullOrUndefined(e[u].childNodes[v])){if(t.isNullOrUndefined(e[u].childNodes[v])&&!d.classList.contains("e-focus")&&nt<w){o=r[f];t.removeClass([o],"e-focus");i=e[u].lastChild;t.addClass([i],"e-focus");i.focus();c=1;break}o=r[f];t.removeClass([o],"e-focus");i=e[u+1].childNodes[w];t.addClass([i],"e-focus");i.focus();c=1;break}o=r[f];t.removeClass([o],"e-focus");i=r[h+=6];t.addClass([i],"e-focus");i.focus();break}}break}}else{if(38===n.keyCode){if(f>=6){for(c=0,u=0;u<e.length;u++)for(s=0;s<e[u].childNodes.length;s++)if(e[u].childNodes[s].classList.contains("e-focus")&&1!==c&&(l=s,y=t.isNullOrUndefined(e[u-1])?null:e[u-1].childNodes.length%6||6,-1!==l)){if(b=l-6,t.isNullOrUndefined(e[u].childNodes[b])){if(t.isNullOrUndefined(e[u-1].childNodes[e[u-1].childNodes.length-(y-s)])){o=r[f];t.removeClass([o],"e-focus");i=e[u-1].lastChild;t.addClass([i],"e-focus");i.focus();c=1;break}o=r[f];t.removeClass([o],"e-focus");i=e[u-1].childNodes[e[u-1].childNodes.length-(y-s)];t.addClass([i],"e-focus");i.focus();c=1;break}o=r[f];t.removeClass([o],"e-focus");i=r[h-=6];t.addClass([i],"e-focus");i.focus();break}}else{if(o=r[f],t.removeClass([o],"e-focus"),i=r[h-=1],p=this.popupObj.element.querySelector(".e-rte-emoji-search"),t.isNullOrUndefined(i)&&!t.isNullOrUndefined(p)){p.focus();break}t.addClass([i],"e-focus");i.focus()}break}if(39===n.keyCode){r.length!==f+1&&(o=r[f],t.removeClass([o],"e-focus"),i=r[h+=1],t.addClass([i],"e-focus"),r[h].focus());break}if(37===n.keyCode){f>0&&(o=r[f],t.removeClass([o],"e-focus"),i=r[h-=1],t.addClass([i],"e-focus"),r[h].focus());break}}}else this.filterKeyHandler(n);40===n.keyCode&&(o=this.parent.element.querySelector(".e-focus"),t.isNullOrUndefined(o)&&(i=r[0],t.addClass([i],"e-focus"),this.parent.userAgentData.isSafari()&&this.parent.inputElement.contains(this.parent.getRange().startContainer)&&this.parent.notify(ft,{}),r[0].focus()))},n.prototype.filterKeyHandler=function(n){var i=this.parent.element.querySelectorAll(".e-rte-emojisearch-btn button"),a=this.parent.element.querySelector(".e-focus"),r,u,f,o,s,e,h,c,l;if(t.isNullOrUndefined(a)&&40===n.keyCode)r=i[0],t.addClass([r],"e-focus"),this.parent.userAgentData.isSafari()&&this.parent.notify(ft,{}),i[0].focus();else for(u=0;u<i.length;u++)if(f=u,i[u].classList.contains("e-focus"))if(38===n.keyCode){if(u>=6){o=i[u];t.removeClass([o],"e-focus");r=i[f-=6];t.addClass([r],"e-focus");r.focus();break}if(s=i[u],t.removeClass([s],"e-focus"),r=i[f-=1],e=this.popupObj.element.querySelector(".e-rte-emoji-search"),t.isNullOrUndefined(r)&&!t.isNullOrUndefined(e)){e.focus();break}t.addClass([r],"e-focus");r.focus()}else if(40===n.keyCode){if(i.length-6>u){h=i[u];t.removeClass([h],"e-focus");r=i[f+=6];t.addClass([r],"e-focus");r.focus();break}}else{if(39===n.keyCode){i.length!==u+1&&(c=i[u],t.removeClass([c],"e-focus"),r=i[f+=1],t.addClass([r],"e-focus"),i[f].focus());break}if(37===n.keyCode&&u>0){l=i[u];t.removeClass([l],"e-focus");r=i[f-=1];t.addClass([r],"e-focus");i[f].focus();break}}},n.prototype.searchFilter=function(n,i,r){var h,k,c,p,w,o,e,b,v,ut,s;if(void 0===r&&(r=!1),h=this.parent.element.querySelector(".e-rte-emoji-search"),k=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel():this.parent.element.querySelector(".e-content"),document.activeElement===h||document.activeElement===k){c=void 0;":"===i||t.isNullOrUndefined(i)?t.isNullOrUndefined(i)||(c=i):c=i.replace(/^:/,"");var u=t.isNullOrUndefined(h)?c:h.value,d=this.parent.element.querySelectorAll(".e-rte-emojipicker-btn button"),f=this.parent.element.querySelector(".e-rte-emojipicker-btn"),g=this.parent.element.querySelectorAll(".e-rte-emojipicker-group"),l=this.parent.element.querySelector(".e-rte-emojipicker-toolbar"),nt=this.parent.element.querySelector(".e-rte-emojisearch-btn"),y=this.popDiv.childNodes[0],tt=window.getComputedStyle(y),it="SPAN"===y.nodeName?y.getBoundingClientRect().height+parseFloat(tt.marginTop)+parseFloat(tt.marginBottom):0,rt=window.getComputedStyle(this.popDiv),a=t.isNullOrUndefined(nt)?d:Array.from(d).filter(function(n){return!nt.contains(n)});if(!(t.isNullOrUndefined(l)||t.isNullOrUndefined(f)||t.isNullOrUndefined(u))){for(""===u||":"===i?(l.style.display="",f.style.height=this.popDiv.getBoundingClientRect().height-l.getBoundingClientRect().height-it-2*parseFloat(rt.borderWidth)+"px",g.forEach(function(n){n.style.display=""})):(g.forEach(function(n){n.style.display="none"}),l.style.display="none",f.style.height=this.popDiv.getBoundingClientRect().height-it-2*parseFloat(rt.borderWidth)+"px"),p=this.parent.createElement("div",{className:"e-rte-emojisearch-btn"}),w=this.parent.element.querySelector(".e-rte-emojisearch-btn"),w&&w.remove(),o=!0,e=0;e<a.length;e++)if(!t.isNullOrUndefined(a[e].getAttribute("title")))for(b=a[e].getAttribute("title").toLowerCase().split(" "),v=0;v<b.length;v++)if(b[v].startsWith(u.toLowerCase())&&""!==u){ut=a[e].cloneNode(!0);p.appendChild(ut);o=!1;break}return s=this.parent.createElement("div",{className:"e-rte-emojiSearch-noEmoji"}),o&&!this.parent.element.querySelector(".e-rte-emojiSearch-noEmoji")&&""!==u&&":"!==i&&": :"!==i?t.isNullOrUndefined(s)||(s.innerHTML='<span style="color: rgba(0, 0, 0, 0.75); font-weight: 500; font-size: 16px;">'+this.i10n.getConstant("emojiPickerNoResultFound")+' 😥 <\/span><br><span style="color: rgba(0, 0, 0, 0.75);"> '+this.i10n.getConstant("emojiPickerTrySomethingElse")+" ? <\/span>",s.style.margin="55px",f.appendChild(s)):(!o&&this.parent.element.querySelector(".e-rte-emojiSearch-noEmoji")||""===u&&":"===i||""===u&&this.parent.element.querySelector(".e-rte-emojiSearch-noEmoji"))&&f.removeChild(this.parent.element.querySelector(".e-rte-emojiSearch-noEmoji")),f.appendChild(p),r&&(o&&":"!==i?this.noResultsFoundCount+=1:this.noResultsFoundCount=0,this.noResultsFoundCount>=9&&!t.isNullOrUndefined(this.popupObj))?(t.removeClass([this.divElement],"e-active"),this.popupObj.hide(),void(this.noResultsFoundCount=0)):void 0}}},n.prototype.emojiBtnClick=function(n){for(var i,u,o,f,s=new MouseEvent("mouseleave",{bubbles:!0,cancelable:!0}),e=this.parent.element.querySelectorAll(".e-rte-emojipicker-popup [data-tooltip-id]"),r=0;r<e.length;r++)e[r].dispatchEvent(s);i=n.target;"BUTTON"===i.tagName&&(i.focus(),u=this.save.startOffset,o=this.save.range.startContainer.textContent.substring(u,u+1),t.isNullOrUndefined(this.clickEvent)&&":"===o||this.save.restore(),this.popupObj&&(t.removeClass([this.divElement],"e-active"),this.popupObj.hide()),this.parent.userAgentData.isSafari()&&"keydown"===n.type&&this.parent.notify(lt,{}),f=n,this.parent.formatter.process(this.parent,{item:{command:"EmojiPicker",subCommand:"EmojiPicker",value:i.innerHTML},originalEvent:f},n,f))},n.prototype.onkeyPress=function(n){var i=n.args,r=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().contentWindow.getSelection():this.parent.contentModule.getDocument().getSelection(),f,e;if(!(r.rangeCount<=0)){var u=r.getRangeAt(0).startOffset,o=r.focusNode.textContent.substring(u-1,u),s=/\s/.test(o),h=":"===r.focusNode.textContent.substring(u-1,u),c=":"===r.focusNode.textContent.charAt(u-1);186===i.keyCode&&i.shiftKey&&(s||0===r.focusOffset)&&(f=this.getCoordinates(),this.parent.showEmojiPicker(f.left,f.top));(8===i.keyCode&&c&&this.popupObj&&(t.removeClass([this.divElement],"e-active"),this.popupObj.hide()),32===i.keyCode&&h&&this.popupObj)&&(t.removeClass([this.divElement],"e-active"),e=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().ownerDocument:this.parent.contentModule.getDocument(),this.parent.showTooltip&&!t.isNullOrUndefined(e.querySelector(".e-tooltip-wrap"))&&this.parent.notify(re,{args:event}),this.popupObj.hide());this.popupObj&&(37===i.keyCode||38===i.keyCode||39===i.keyCode||27===i.keyCode||40===i.keyCode)&&(this.onKeyDown(i),i.preventDefault())}},n.prototype.onkeyUp=function(n){var o=n.args,i=this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().contentWindow.getSelection():this.parent.contentModule.getDocument().getSelection(),c,e;if(!(i.rangeCount<=0)){for(var f,s=i.getRangeAt(0),r=s.startOffset,h=0,u=r-1;u>=r-i.focusNode.textContent.length;u--)c=i.focusNode.textContent.substring(u-1,u),/:$/.test(c)&&!t.isNullOrUndefined(this.popDiv)&&0===h&&(f=s.startContainer.textContent.substring(u-1,r),this.searchFilter(o,f,!0),h=1);e=i.focusNode.textContent.substring(r-1,r);":"!==e||t.isNullOrUndefined(this.popupObj)||(f=e,this.searchFilter(o,f,!0))}},n.prototype.getCoordinates=function(){var f,u,n=(this.parent.iframeSettings.enable?this.parent.contentModule.getPanel().contentWindow.getSelection():window.getSelection()).getRangeAt(0);"P"!==n.startContainer.nodeName&&"DIV"!==n.startContainer.nodeName||"#text"!==n.startContainer.childNodes[0].nodeName&&(u=n.startContainer.childNodes[0]);var i=t.isNullOrUndefined(u)?n.getBoundingClientRect():u.getBoundingClientRect(),e=this.parent.element.querySelector(".e-rte-content"),o=this.parent.element,s=o.offsetHeight-e.offsetHeight,h=i.top-this.parent.inputElement.getBoundingClientRect().top,c=i.left-this.parent.inputElement.getBoundingClientRect().left,l=window.innerHeight,r=h,a=c+i.width;return o.getBoundingClientRect().top<0&&!this.parent.inlineMode.enable&&(r=r+e.getBoundingClientRect().top-s),i.top<330||i.top+330>l&&(r-=350),this.parent.inputElement&&(f={top:r+60,left:a+8}),f},n.prototype.removeEventListener=function(){this.parent.off(es,this.toolbarClick);this.parent.off(gr,this.docClick);this.parent.off(ut,this.onIframeMouseDown);this.parent.off(y,this.onkeyPress);this.parent.off(tt,this.onkeyUp);this.parent.off(ai,this.contentscroll);this.parent.off(li,this.contentscroll);this.parent.off(u,this.destroy);this.parent.off(b,this.bindOnEnd)},n.prototype.getModuleName=function(){return"emojiPicker"},n}(),ed='\nhtml {\n    height: auto;\n    margin: 0;\n}\n\nbody {\n    margin: 0;\n    color: #333;\n    word-wrap: break-word;\n}\n\n.e-content {\n    min-height: 100px;\n    outline: 0 solid transparent;\n    padding: 16px;\n    position: relative;\n    overflow-x: auto;\n    font-weight: normal;\n    line-height: 1.5;\n    font-size: 14px;\n    text-align: inherit;\n    font-family: "Roboto", "Segoe UI", "GeezaPro", "DejaVu Serif", "sans-serif", "-apple-system", "BlinkMacSystemFont";\n}\n\np {\n   margin-top: 0;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh1 {\n    font-size: 2.857em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh2 {\n    font-size: 2.285em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh3 {\n    font-size: 2em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh4 {\n    font-size: 1.714em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh5 {\n    font-size: 1.428em;\n    font-weight: 600;\n    line-height: 1.2;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nh6 {\n    font-size: 1.142em;\n    font-weight: 600;\n    line-height: 1.5;\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n}\n\nblockquote {\n    margin-top: 10px;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n    padding-left: 12px;\n    border-left: 2px solid #5c5c5c;\n}\n\npre {\n    border: 0;\n    border-radius: 0;\n    color: #333;\n    font-size: inherit;\n    line-height: inherit;\n    margin-top: 0;\n    margin-right: 0;\n    margin-bottom: 10px;\n    margin-left: 0;\n    overflow: visible;\n    padding: 0;\n    white-space: pre-wrap;\n    word-break: inherit;\n    word-wrap: break-word;\n}\n\ncode {\n    background-color: #9d9d9d26;\n    color: #ed484c;\n}\n\nstrong {\n    font-weight: bold;\n}\n\nb {\n    font-weight: bold;\n}\n\na {\n    text-decoration: none;\n    user-select: auto;\n}\n\nli {\n    margin-bottom: 10px;\n}\n\nli ol {\n    margin-block-start: 10px;\n}\n\nli ul {\n    margin-block-start: 10px;\n}\n\nul {\n    list-style-type: disc;\n}\n\nul ul {\n    list-style-type: circle;\n}\n\nol ul {\n    list-style-type: circle;\n}\n\nul ul ul {\n    list-style-type: square;\n}\n\nol ul ul {\n    list-style-type: square;\n}\n\nul ol ul {\n    list-style-type: square;\n}\n\nol ol ul {\n    list-style-type: square;\n}\n\ntable {\n    margin-bottom: 10px;\n    border-collapse: collapse;\n}\n\nth {\n    background-color: rgba(157, 157, 157, .15);\n    border: 1px solid #BDBDBD;\n    height: 20px;\n    min-width: 20px;\n    padding: 2px 5px;\n}\n\ntd {\n    border: 1px solid #BDBDBD;\n    height: 20px;\n    min-width: 20px;\n    padding: 2px 5px;\n}\n\n.e-rte-image {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-audio {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-rte-video {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-imginline {\n    margin-left: 5px;\n    margin-right: 5px;\n    display: inline-block;\n    float: none;\n    max-width: 100%;\n    padding: 1px;\n    vertical-align: bottom;\n}\n\n.e-audio-inline {\n    margin-left: 5px;\n    margin-right: 5px;\n    display: inline-block;\n    float: none;\n    max-width: 100%;\n    padding: 1px;\n    vertical-align: bottom;\n}\n\n.e-video-inline {\n    margin-left: 5px;\n    margin-right: 5px;\n    display: inline-block;\n    float: none;\n    max-width: 100%;\n    padding: 1px;\n    vertical-align: bottom;\n}\n\n.e-imgcenter {\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-video-center {\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-imgright {\n    float: right;\n    margin-top: 0;\n    margin-right: auto;\n    margin-bottom: 0;\n    margin-left: auto;\n    margin-left: 5px;\n    text-align: right;\n}\n\n.e-video-right {\n    float: right;\n    margin-top: 0;\n    margin-right: auto;\n    margin-bottom: 0;\n    margin-left: auto;\n    margin-left: 5px;\n    text-align: right;\n}\n\n.e-imgleft {\n    float: left;\n    margin-top: 0;\n    margin-right: auto;\n    margin-bottom: 0;\n    margin-left: auto;\n    margin-right: 5px;\n    text-align: left;\n}\n\n.e-video-left {\n    float: left;\n    margin-top: 0;\n    margin-right: auto;\n    margin-bottom: 0;\n    margin-left: auto;\n    margin-right: 5px;\n    text-align: left;\n}\n\n.e-rte-img-caption {\n    display: inline-block;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-caption-inline {\n    display: inline-block;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    margin-left: 5px;\n    margin-right: 5px;\n    max-width: calc(100% - (2 * 5px));\n    position: relative;\n    text-align: center;\n    vertical-align: bottom;\n}\n\n.e-img-wrap {\n    display: inline-block;\n    margin: auto;\n    padding: 0;\n    text-align: center;\n    width: 100%;\n}\n\n.e-imgbreak {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-audio-break {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n\n.e-video-break {\n    border: 0;\n    cursor: pointer;\n    display: block;\n    float: none;\n    margin-top: 5px;\n    margin-right: auto;\n    margin-bottom: 5px;\n    margin-left: auto;\n    max-width: 100%;\n    position: relative;\n}\n',gct=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(dh,this.onImport,this);this.parent.on(fo,this.onExport,this);this.parent.on(u,this.destroy,this)},n.prototype.onImport=function(){var n=this;this.parent.trigger(l,{cancel:!1,requestType:"Import"},function(t){if(!t.cancel){n.uploaderObj=new ot.Uploader({allowedExtensions:".doc,.docx,.rtf,.dot,.dotx,.docm,.dotm",asyncSettings:{saveUrl:n.parent.importWord.serviceUrl},success:function(t){n.parent.executeCommand("importWord",t.e.currentTarget.response,{undo:!0});n.parent.trigger(ct,{requestType:"Import"})}});n.parent.setProperties({enableXhtml:!0},!0);var r=n.parent.createElement("div",{className:"e-import-uploadwrap e-droparea"+n.parent.getCssClass(!0)}),i=n.parent.createElement("input",{id:n.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"},className:n.parent.getCssClass()});r.appendChild(i);n.uploaderObj.appendTo(i);n.uploaderObj.element.click();n.uploaderObj.element.closest(".e-upload").style.display="none"}})},n.prototype.onExport=function(n){var t,i,e=this,r,u,f;this.parent.setProperties({enableXhtml:!0},!0);u=this.parent.getHtml();"ExportWord"===n.member?(t=this.parent.exportWord.fileName,i=this.parent.exportWord.serviceUrl,r="<html><head><style>"+(this.parent.exportWord.stylesheet+ed)+'<\/style><\/head><body><div class="e-content">'+u+"<\/div><\/body><\/html>"):"ExportPdf"===n.member&&(t=this.parent.exportPdf.fileName,i=this.parent.exportPdf.serviceUrl,r="<html><head><style>"+(this.parent.exportPdf.stylesheet+ed)+'<\/style><\/head><body><div class="e-content">'+u+"<\/div><\/body><\/html>");f={requestType:n.member,exportValue:r,cancel:!1};this.parent.trigger(l,f,function(r){r.cancel||fetch(i,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({html:r.exportValue})}).then(function(n){if(!n.ok)throw new Error("HTTP error! Status: "+n.status);return n.blob().then(function(n){return{blob:n,filename:t}})}).then(function(t){var u=t.blob,f=t.filename,r=window.URL.createObjectURL(u),i=document.createElement("a");i.href=r;i.download=f;document.body.appendChild(i);i.click();document.body.removeChild(i);window.URL.revokeObjectURL(r);e.parent.trigger(ct,{requestType:n.member})}).catch(function(n){console.error("Fetch error:",n)})})},n.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(dh,this.onImport),this.parent.off(fo,this.onExport),this.parent.off(u,this.destroy),this.uploaderObj&&!this.uploaderObj.isDestroyed&&(this.uploaderObj.destroy(),this.uploaderObj=null))},n.prototype.getModuleName=function(){return"importExport"},n}(),nlt=function(){function n(n){this.parent=n;this.isDestroyed=!1;this.isItemsDisabled=!1;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(gh,this.onCodeBlock,this);this.parent.on(wo,this.onPaste,this);this.parent.on(kc,this.codeBlockEnter,this);this.parent.on(y,this.onKeyDown,this);this.parent.on(tt,this.onKeyUp,this);this.parent.on(vt,this.editAreaClickHandler,this);this.parent.on(u,this.destroy,this);this.parent.on(b,this.bindOnEnd,this)},n.prototype.onCodeBlock=function(n){var i,r,u;"codeBlock"===n.member&&n.args&&n.args.item&&n.args.originalEvent.target&&n.args.originalEvent.target.parentElement.classList.contains("e-dropdown-btn")||!(n.args.originalEvent.target.parentElement.classList.contains("e-split-btn")||n.args.originalEvent.target.classList.contains("e-split-btn"))||(i=this.parent.codeBlockSettings,r=void 0,i.languages&&i.languages.length>0&&(u=t.isNullOrUndefined(i.defaultLanguage)?[]:i.languages.filter(function(n){return n.language===i.defaultLanguage}),r=u.length>0?u[0]:i.languages[0],this.parent.formatter.process(this.parent,n.args,n.args.originalEvent,{language:r.language,label:r.label,action:"createCodeBlock",enterAction:this.parent.enterKey})))},n.prototype.onPaste=function(n){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),f;if(this.codeBlockObj.isValidCodeBlockStructure(i.startContainer)||this.codeBlockObj.isValidCodeBlockStructure(i.endContainer)){var e=t.isNullOrUndefined(this.codeBlockObj.isValidCodeBlockStructure(i.startContainer))?this.codeBlockObj.isValidCodeBlockStructure(i.endContainer):this.codeBlockObj.isValidCodeBlockStructure(i.startContainer),u=this.parent.codeBlockSettings.languages.slice().filter(function(n){return n.label===e.getAttribute("data-language")}),r=n.item;t.isNullOrUndefined(r)&&(r={command:"CodeBlock",subCommand:"CodeBlock"});f={originalEvent:n.args,item:r};this.parent.formatter.process(this.parent,f,n.args,{action:"codeBlockPaste",currentFormat:{label:u[0].label,language:u[0].language}})}},n.prototype.codeBlockEnter=function(n){var r,i,u;n.args&&13===n.args.which&&(r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),(this.codeBlockObj.isValidCodeBlockStructure(r.startContainer)||this.codeBlockObj.isValidCodeBlockStructure(r.endContainer))&&(i=n.item,t.isNullOrUndefined(i)&&(i={command:"CodeBlock",subCommand:"CodeBlock"}),u={originalEvent:n.args,item:i},this.parent.formatter.process(this.parent,u,n.args,{action:"codeBlockEnter"})))},n.prototype.codeBlockTab=function(n){var i=n.args&&9===n.args.which&&!n.args.shiftKey,r=n.args&&9===n.args.which&&n.args.shiftKey,t;if((i||r)&&(t=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),this.codeBlockObj.isSelectionWithinCodeBlock(t,t.startContainer,t.endContainer))){var u=this.createToolbarItem(n),f={originalEvent:n.args,item:u},e=i?"codeBlockTabAction":"codeBlockShiftTabAction";this.parent.formatter.process(this.parent,f,n.args,{action:e});n.args.preventDefault()}},n.prototype.onKeyDown=function(n){var r=n.args,h,u,i,y,s;if(9!==r.which){if(h=8===r.which||46===r.which,u="code-block"===r.action,(h||u)&&(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),!this.isSelectionAllContent(i))){var e=this.parent.formatter.editorManager,o=e.codeBlockObj.getCodeBlockPosition(i),c=!t.isNullOrUndefined(o.nextSiblingCodeBlockElement)&&o.cursorAtLastPosition,l=e.nodeSelection.findFirstContentNode(o.blockNode),p=l&&l.node===i.startContainer&&0===i.startOffset,f=e.codeBlockObj.findParentOrPreviousSiblingCodeBlock(i),a=!t.isNullOrUndefined(f)&&f.currentNode&&"UL"!==f.currentNode.nodeName&&"OL"!==f.currentNode.nodeName&&p,w=!t.isNullOrUndefined(this.codeBlockObj.isValidCodeBlockStructure(i.startContainer)),b=!t.isNullOrUndefined(this.codeBlockObj.isValidCodeBlockStructure(i.endContainer)),v=w||b;(v||c||a||u)&&(y=this.createToolbarItem(n),s={originalEvent:n.args,item:y},u?this.createCodeBlockWithDefaultLanguage(s,n):this.processCodeBlockDeletion(s,n,c,a,v,i))}}else this.codeBlockTab(n)},n.prototype.createToolbarItem=function(n){var i=n.item;return t.isNullOrUndefined(i)&&(i={command:"CodeBlock",subCommand:"CodeBlock"}),i},n.prototype.processCodeBlockDeletion=function(n,i,r,u,f,e){if(r||u||!f)this.parent.formatter.process(this.parent,n,i.args,{action:"codeBlockBackSpace"});else{var s=(t.isNullOrUndefined(this.codeBlockObj.isValidCodeBlockStructure(e.startContainer))?this.codeBlockObj.isValidCodeBlockStructure(e.endContainer):this.codeBlockObj.isValidCodeBlockStructure(e.startContainer)).getAttribute("data-language"),o=this.parent.codeBlockSettings.languages.slice().filter(function(n){return n.label===s});o.length>0&&this.parent.formatter.process(this.parent,n,i.args,{action:"codeBlockBackSpace",currentFormat:{label:o[0].label,language:o[0].language}})}},n.prototype.createCodeBlockWithDefaultLanguage=function(n,i){var r=this.parent.codeBlockSettings,u,f;r.languages&&0!==r.languages.length&&(t.isNullOrUndefined(r.defaultLanguage)?u=r.languages[0]:(f=r.languages.filter(function(n){return n.language===r.defaultLanguage}),u=f.length>0?f[0]:r.languages[0]),this.parent.formatter.process(this.parent,n,i.args,{language:u.language,label:u.label,action:"createCodeBlock",enterAction:this.parent.enterKey}))},n.prototype.isSelectionAllContent=function(n){var t=document.createElement("div");return t.appendChild(n.cloneContents()),t.innerHTML===this.parent.inputElement.innerHTML},n.prototype.onKeyUp=function(n){var r,u;if(8===n.args.which||46===n.args.which){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),f="#text"===i.startContainer.nodeName?i.startContainer.parentElement:i.startContainer,e="#text"===i.endContainer.nodeName?i.endContainer.parentElement:i.endContainer;f.closest("pre[data-language]")&&e.closest("pre[data-language]")&&(r=n.item,t.isNullOrUndefined(r)&&(r={command:"CodeBlock",subCommand:"CodeBlock"}),u={originalEvent:n.args,item:r},this.parent.formatter.process(this.parent,u,n.args,{action:"codeBlockBackSpace"}))}this.disableToolbarItems()},n.prototype.editAreaClickHandler=function(){this.disableToolbarItems()},n.prototype.disableToolbarItems=function(){var n=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.inputElement.ownerDocument),r="#text"===n.startContainer.nodeName?n.startContainer.parentElement:n.startContainer,u="#text"===n.endContainer.nodeName?n.endContainer.parentElement:n.endContainer,t=["undo","redo"],f=["codeblock","indent","outdent","sourcecode","emojipicker","importword","exportword","exportpdf","lowercase","uppercase","blockquote","numberformatlist","bulletformatlist","unorderedlist","orderedlist","fullscreen"],i;this.codeBlockObj.isValidCodeBlockStructure(r)||this.codeBlockObj.isValidCodeBlockStructure(u)?(this.parent.disableToolbarItem(this.parent.toolbarSettings.items.filter(function(n){return-1===t.indexOf(n.toLocaleLowerCase())})),this.parent.enableToolbarItem(this.parent.toolbarSettings.items.filter(function(n){return-1!==f.indexOf(n.toLocaleLowerCase())})),this.disableTextQuickToolbarItems(!0),this.isItemsDisabled=!0):this.isItemsDisabled&&(i=this.parent.toolbarSettings.items.slice(),this.parent.enableToolbarItem(i.filter(function(n){return-1===t.indexOf(n.toLocaleLowerCase())})),this.disableTextQuickToolbarItems(!1),this.isItemsDisabled=!1)},n.prototype.disableTextQuickToolbarItems=function(n){for(var f,e=["undo","redo","codeblock","indent","outdent","sourcecode","emojipicker","importword","exportword","exportpdf","lowercase","uppercase","blockquote","numberformatlist","bulletformatlist","unorderedlist","orderedlist","fullscreen"],r=this.parent.quickToolbarModule&&this.parent.quickToolbarModule.textQTBar&&this.parent.quickToolbarModule.textQTBar.quickTBarObj&&this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj?this.parent.quickToolbarModule.textQTBar.quickTBarObj.toolbarObj:null,u=t.isNullOrUndefined(this.parent.quickToolbarSettings.text)?[]:this.parent.quickToolbarSettings.text,i=0;i<u.length;i++)f=u[i],-1===e.indexOf(f.toLocaleLowerCase())&&r&&r.enableItems(i,!n)},n.prototype.removeEventListener=function(){this.parent.off(gh,this.onCodeBlock);this.parent.off(wo,this.onPaste);this.parent.off(kc,this.codeBlockEnter);this.parent.off(y,this.onKeyDown);this.parent.off(tt,this.onKeyUp);this.parent.off(vt,this.editAreaClickHandler);this.parent.off(u,this.destroy);this.parent.off(b,this.bindOnEnd);this.parent.formatter.editorManager.observer.off(wv,this.editAreaClickHandler)},n.prototype.destroy=function(){this.isDestroyed||(this.isDestroyed=!0,this.removeEventListener())},n.prototype.getModuleName=function(){return"codeBlock"},n.prototype.bindOnEnd=function(){this.parent.formatter.editorManager.codeBlockObj||(this.parent.formatter.editorManager.codeBlockObj=new gut(this.parent.formatter.editorManager),this.codeBlockObj=this.parent.formatter.editorManager.codeBlockObj,this.parent.formatter.editorManager.observer.on(wv,this.editAreaClickHandler,this))},n}(),od={};yh.C(od,vh);tft={richtexteditor:od=yh.C(window.ejdashboard?window.ejdashboard.richtexteditor:{},od)};window.ejdashboard=yh.C(window.ejdashboard||{},tft)})()})();ejdashboard.richtexteditor.RichTextEditor.Inject(ejdashboard.richtexteditor.HtmlEditor,ejdashboard.richtexteditor.Toolbar,ejdashboard.richtexteditor.QuickToolbar,ejdashboard.richtexteditor.Link,ejdashboard.richtexteditor.Image,ejdashboard.richtexteditor.Count,ejdashboard.richtexteditor.MarkdownEditor,ejdashboard.richtexteditor.PasteCleanup,ejdashboard.richtexteditor.Resize,ejdashboard.richtexteditor.Table);
