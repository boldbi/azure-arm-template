/*!
*  filename: ej2.map.all.min.js
*  version : 12.1.5.5
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function t(r){var f=n[r],u;return void 0!==f?f.exports:(u=n[r]={exports:{}},i[r](u,u.exports,t),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},n={};(()=>{function ii(t,i){return"string"!=typeof t?t:n.isNullOrUndefined(t)?null:-1!==t.indexOf("%")?i/100*parseInt(t,10):parseInt(t,10)}function tr(t){t.element.style.height=n.isNullOrUndefined(t.height)?"auto":t.height;t.element.style.width=n.isNullOrUndefined(t.width)?"auto":t.width;t.element.style.setProperty("display","block");var i=t.element.clientWidth,r=t.element.clientHeight,u="string"==typeof t.element.style.width?ii(t.element.style.width,i):t.element.style.width,f="string"==typeof t.element.style.height?ii(t.element.style.height,r):t.element.style.height;return new w(0,0),"0px"===t.width||"0%"===t.width||"0%"===t.height||"0px"===t.height?new w(0,0):new w(ii(t.width,i)||i||u||600,ii(t.height,r)||r||f||(t.isDevice?Math.min(window.innerWidth,window.innerHeight):450))}function li(n,t,i){var r=i.getBoundingClientRect(),u=i.ownerDocument.defaultView.pageXOffset,f=i.ownerDocument.defaultView.pageYOffset,e=i.ownerDocument.documentElement.clientTop,o=i.ownerDocument.documentElement.clientLeft,s=r.left+u-o,h=r.top+f-e;return new b(n-s,t-h)}function ai(n){return n*(Math.PI/180)}function ir(n){return n*(180/Math.PI)}function v(t,i,r,u,e){var a,v,y,s,h,l,p=new w(e.mapAreaRect.width,e.mapAreaRect.height),it=e.baseMapBounds.longitude,rt=e.baseMapBounds.latitude,o=ai(t),c=ai(i),k=n.isNullOrUndefined(e.projectionType)?"Mercator":e.projectionType,b=e.isTileMap?256*Math.pow(2,1):n.isNullOrUndefined(r)?Math.min(p.width,p.height):Math.min(p.width,p.height)*r,d,g,nt,tt;if("Normal"===u.geometryType)a=n.isNullOrUndefined(r)?i:Math.abs((i-it.min)*r),v=n.isNullOrUndefined(r)?t:Math.abs((rt.max-t)*r);else if("Geographic"===u.geometryType){switch(k){case"Mercator":d=new f(b/2,b/2);a=d.x+i*(b/360);g=function(t,i,r){return n.isNullOrUndefined(i)||(t=Math.max(t,i)),n.isNullOrUndefined(r)||(t=Math.min(t,r)),t}(Math.sin(ai(t)),-.9999,.9999);v=d.y+.5*Math.log((1+g)/(1-g))*(-b/(2*Math.PI));break;case"Winkel3":h=((y=rr(c,o)).x+c/(Math.PI/2))/2;s=(y.y+o)/2;break;case"Miller":h=c;s=1.25*Math.log(Math.tan(Math.PI/4+.4*o));break;case"Eckert3":h=2/(l=Math.sqrt(Math.PI*(4+Math.PI)))*c*(1+Math.sqrt(1-4*o*o/(Math.PI*Math.PI)));s=4/l*o;break;case"AitOff":h=(y=rr(c,o)).x;s=y.y;break;case"Eckert5":h=c*(1+Math.cos(o))/Math.sqrt(2+Math.PI);s=2*o/Math.sqrt(2+Math.PI);break;case"Equirectangular":h=c;s=o;break;case"Eckert6":for(l=(1+Math.PI/2)*Math.sin(o),nt=1/0,tt=0;tt<10&&Math.abs(nt)>1e-6;tt++)o-=nt=(o+Math.sin(o)-l)/(1+Math.cos(o));l=Math.sqrt(2+Math.PI);h=c*(1+Math.cos(o))/l;s=2*o/l}a="Mercator"===k?a:ur(function(t,i){var r=t.baseMapBounds.longitude,u=n.isNullOrUndefined(t.baseSize)?t.mapAreaRect.width:t.mapAreaRect.width+Math.abs(t.baseSize.width-t.mapAreaRect.width)/2;return Math.round(u*(i-r.min)/(r.max-r.min)*100)/100}(e,ir(h)),3);v="Mercator"===k?v:-ur(function(n,t){var i=n.baseMapBounds.latitude;return Math.round(n.mapAreaRect.height*(t-i.min)/(i.max-i.min)*100)/100}(e,ir(s)),3)}return new f(a,v)}function it(n,t,i,r){var u=256*Math.pow(2,t),s=(n.x+180)/360,f=Math.sin(n.y*Math.PI/180),h=.5-Math.log((1+f)/(1-f))/(4*Math.PI),e=n.x,o=n.y;return r&&(e=s*u+.5+i.x,o=h*u+.5+i.y),{x:e,y:o}}function rr(n,t){var i,r=Math.cos(t),u=function(n){return n/Math.sin(n)}((i=r*Math.cos(n/=2),Math.acos(i)));return new f(2*r*Math.sin(n)*u,Math.sin(t)*u)}function ur(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function p(n,t){var i=document.getElementById("mapsmeasuretext");return null===i&&((i=document.createElement("text")).id="mapsmeasuretext",document.body.appendChild(i)),i.innerText=n,i.style.cssText="position: absolute; font-size: "+("number"==typeof t.size?t.size+"px":t.size)+"; font-weight: "+t.fontWeight+"; font-style: "+t.fontStyle+"; font-family: "+t.fontFamily+"; visibility: hidden; top: -100; left: 0; whiteSpace: nowrap; lineHeight: normal",new w(i.clientWidth,i.clientHeight)}function st(n,t){var i=document.createElement("canvas"),r=i.getContext("2d"),u,f;return r.font=t.fontStyle+" "+t.fontWeight+" "+("number"==typeof t.size?t.size+"px":t.size)+" "+t.fontFamily,u=r.measureText(n).width,f=parseFloat(t.size)||16,i=null,new w(u,f)}function ht(n,t,i,r,u){var e,c;void 0===u&&(u=!1);var s,o,l={id:n.id,x:n.x,y:n.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":n.anchor,transform:n.transform,opacity:t.opacity,"dominant-baseline":n.baseLine},a="string"==typeof n.text||"number"==typeof n.text?n.text:u?n.text[n.text.length-1]:n.text[0],h=new ot.SvgRenderer(""),f=h.createText(l,a);if(f.style["user-select"]="none",f.style["font-family"]=t.fontFamily,f.style["font-size"]=t.size,f.style["font-weight"]=t.fontWeight,f.style["font-color"]=t.color,f.style["-moz-user-select"]="none",f.style["-webkit-touch-callout"]="none",f.style["-webkit-user-select"]="none",f.style["-khtml-user-select"]="none",f.style["-ms-user-select"]="none",f.style["-o-user-select"]="none","string"!=typeof n.text&&n.text.length>1)for(e=1,c=n.text.length;e<c;e++)o=p(n.text[e],t).height,s=h.createTSpan({x:n.x,id:n.id,y:n.y+(u?-e*o:e*o)},u?n.text[n.text.length-(e+1)]:n.text[e]),f.appendChild(s);return r.appendChild(f),f}function pt(n,t){return t.format&&!isNaN(Number(n))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(n)):n}function er(n,t,i,r){for(var s,e,c,o=""===n?t:n,f=""===n?o.split("${"):o.split("{{:"),l=RegExp,u=0;u<f.length;u++)if(f[u].indexOf("}}")>-1&&f[u].indexOf(".")>-1||f[u].indexOf("}")>-1&&f[u].search(".")>-1)for(s=""===n?f[u].split("}"):f[u].split("}}"),e=0;e<s.length;e++)s[e].indexOf(".")>-1&&(c=h(i,s[e]).toString(),o=""===n?o.split("${"+s[e]+"}").join(pt(c,r)):o.replace(new l("{{:"+s[e]+"}}","g"),c));return o}function or(t,i,r,u,f,e,o){var h,c,l,k,s=f.size,g=f.borderColor,nt=parseFloat(f.borderWidth),tt=parseFloat(f.borderOpacity),v=f.fill,p=f.dashArray,it={color:g,width:nt,opacity:tt},w=f.opacity,b=new y(u,v,nt,g,w,tt,p,""),rt,ut;return(s.width="string"==typeof s.width?parseInt(s.width,10):s.width,s.height="string"==typeof s.height?parseInt(s.height,10):s.height,"Circle"===t)?(rt=(s.width+s.height)/4,ut=new yt(u,v,it,w,r.x,r.y,rt,p),h=o.renderer.drawCircle(ut)):"Rectangle"===t?(c=r.x-s.width/2,l=r.y-s.height/2,k=new d(u,v,it,w,new a(c,l,s.width,s.height),null,null,"",p),h=o.renderer.drawRectangle(k)):"Image"===t?(c=r.x-s.width/2,l=r.y-(u.indexOf("cluster")>-1?s.height/2:s.height),n.merge(b,{href:i,height:s.height,width:s.width,x:c,y:l}),h=o.renderer.drawImage(b)):h=function(n,t,i,r,u,f){var o;switch(t){case"Balloon":o=kr(n,i,r,u,"Marker",f);break;case"Cross":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"Diamond":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+u.y+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+u.y+" Z";break;case"Star":i.d="M "+(u.x+r.width/3)+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y-r.height/6)+" L "+(u.x+r.width/2)+" "+(u.y-r.height/6)+" L "+(u.x-r.width/3)+" "+(u.y+r.height/2)+" L "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/3)+" "+(u.y+r.height/2)+" Z";break;case"Triangle":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/2)+" Z";break;case"HorizontalLine":i.d=" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"VerticalLine":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2);break;case"InvertedTriangle":i.d="M "+(u.x-r.width/2)+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" Z";break;case"Pentagon":for(var s=void 0,h=void 0,e=0;e<5;e++)s=r.width/2*Math.cos(Math.PI/180*72*e),h=r.height/2*Math.sin(Math.PI/180*72*e),i.d+=(0===e?"M ":"L ")+(u.x+s)+" "+(u.y+h);i.d+=" Z"}return"Cross"!==t&&"HorizontalLine"!==t&&"VerticalLine"!==t||(i.stroke="transparent"===i.stroke?i.fill:i.stroke),"Balloon"===t?o:n.renderer.drawPath(i)}(o,t,b,s,r,e),h}function h(t,i){var r,u;if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(i))if(r=i.replace(/\[/g,".").replace(/\]/g,"").split("."),1===r.length)t=t[r[0]];else for(u=0;u<r.length&&!n.isNullOrUndefined(t);u++)t=t[r[u]];return t}function yi(t,i){var r=n.isNullOrUndefined(t.colorValuePath)?i[t.colorValuePath]:t.colorValuePath.indexOf(".")>-1?h(i,t.colorValuePath).toString():i[t.colorValuePath];return t.fill=n.isNullOrUndefined(t.colorValuePath)||n.isNullOrUndefined(r)?t.fill:t.colorValuePath.indexOf(".")>-1?h(i,t.colorValuePath).toString():i[t.colorValuePath],t}function pi(t,i){return n.isNullOrUndefined(t.shapeValuePath)||n.isNullOrUndefined(i[t.shapeValuePath])?(hr(t,i),cr(t,i)):(hr(t,i),"Image"===i[t.shapeValuePath]&&cr(t,i)),t}function sr(n,t){return n.indexOf(".")>-1?h(t,n).toString():t[n]}function hr(t,i){if(!n.isNullOrUndefined(t.shapeValuePath)){var r=sr(t.shapeValuePath,i);t.shape=n.isNullOrUndefined(r)||""===r.toString()?t.shape:r}}function cr(t,i){if(!n.isNullOrUndefined(t.imageUrlValuePath)){var r=sr(t.imageUrlValuePath,i);t.imageUrl=n.isNullOrUndefined(r)?t.imageUrl:r}}function wt(t,i,u,e,o,s,c,l,a,y,p){var d,st,kt,wt,yt,lt,rt,dt,at=[],ft=[],et=0,ot=0,ct=t.markerSettings[o],pt=0,nt=[],k=!p&&t.markerClusterSettings.allowClustering?t.markerClusterSettings:ct.clusterSettings,gt=k.labelStyle,b=u.renderer.createGroup({id:u.element.id+"_LayerIndex_"+e+"_markerCluster"}),g={cancel:!1,name:so,fill:k.fill,height:k.height,width:k.width,imageUrl:k.imageUrl,shape:k.shape,data:void 0,maps:u,cluster:k,border:k.border},vt=u.element.getBoundingClientRect();u.isTileMap?{}:ut(u,t,!1);u.isTileMap||(dt=u.mapLayerPanel.calculateFactor(t));var ni=!1,bt=u.isTileMap?u.tileZoomLevel:u.mapScaleValue,ti=ct.clusterSettings.allowClustering||t.markerClusterSettings.allowClustering&&t.markerSettings.length>1?i.querySelectorAll("[id*='LayerIndex_"+e+"_MarkerIndex_"+o+"']:not([id*='_Group'])"):i.childNodes;return u.trigger("markerClusterRendering",g,function(){var ii,ri,ui,fi,ut,ei;for(Array.prototype.forEach.call(ti,function(r,c){var st,fi,ei,p,ii;if(nt=[],"hidden"!==r.style.visibility){if((d=(rt=r).getBoundingClientRect(),nt.push(c),!n.isNullOrUndefined(d))&&(st=u.markerModule.zoomedMarkerCluster.length>0&&u.markerModule.zoomedMarkerCluster[e]&&u.markerModule.zoomedMarkerCluster[e][c]&&u.markerModule.zoomedMarkerCluster[e][c].length>0||u.markerModule.initialMarkerCluster.length>0&&u.markerModule.initialMarkerCluster[e]&&u.markerModule.initialMarkerCluster[e][c]&&u.markerModule.initialMarkerCluster[e][c].length>0?u.previousScale<bt?u.markerModule.zoomedMarkerCluster[e][c]:u.markerModule.initialMarkerCluster[e][c]:null,n.isNullOrUndefined(st)||0===st.length||ct.clusterSettings.allowClustering?Array.prototype.forEach.call(ti,function(n,t){t>=c+1&&"hidden"!==n.style.visibility&&ar(n,d,at,nt,t)}):Array.prototype.forEach.call(st,function(n){if(c!==n){var t=document.getElementById(u.element.id+"_LayerIndex_"+e+"_MarkerIndex_"+o+"_dataIndex_"+n);t&&"hidden"!==t.style.visibility&&ar(t,d,at,nt,n)}}),lr(u,bt,e,c,nt),et=d.left+d.width/2,ot=d.top+d.height,at.length>0)){nt=nt.filter(function(n,t,i){return i.indexOf(n)===t});et-=vt.left;ot-=u.availableSize.height<=vt.height?vt.top:vt.bottom-vt.top;var ut,yt=parseInt(r.id.split("_dataIndex_")[1].split("_")[0],10),ft=parseInt(r.id.split("_MarkerIndex_")[1].split("_")[0],10),a=t.markerSettings[ft],l=a.dataSource[yt],ri=n.isNullOrUndefined(a.longitudeValuePath)?n.isNullOrUndefined(l.longitude)?n.isNullOrUndefined(l.Longitude)?0:parseFloat(l.Longitude):parseFloat(l.longitude):Number(h(l,a.longitudeValuePath)),ui=n.isNullOrUndefined(a.latitudeValuePath)?n.isNullOrUndefined(l.latitude)?n.isNullOrUndefined(l.Latitude)?0:parseFloat(l.Latitude):parseFloat(l.latitude):Number(h(l,a.latitudeValuePath));u.isTileMap?u.isTileMap&&(ut=it(new f(ri,ui),u.tileZoomLevel,u.tileTranslatePoint,!0)):ut=v(ui,ri,dt,t,u);r.style.visibility="hidden";g.cancel?(lt={size:new w(k.width,k.height),fill:k.fill,borderColor:k.border.color,borderWidth:k.border.width,opacity:k.opacity,dashArray:k.dashArray,imageUrl:k.imageUrl,shape:k.shape}).borderOpacity=n.isNullOrUndefined(k.border.opacity)?k.opacity:k.border.opacity:(lt={size:new w(g.width,g.height),fill:g.fill,borderColor:g.border.color,borderWidth:g.border.width,opacity:k.opacity,dashArray:k.dashArray,imageUrl:g.imageUrl,shape:g.shape}).borderOpacity=n.isNullOrUndefined(g.border.opacity)?k.opacity:g.border.opacity;et=u.isTileMap||i.id.indexOf("_Markers_Group")>-1?et:et+3.75-g.width/2;ot=u.isTileMap||i.id.indexOf("_Markers_Group")>-1?ot:ot-g.height/2;u.isTileMap?(et=ut.x,ot=ut.y):(et=(ut.x+(n.isNullOrUndefined(u.translatePoint)||0===u.translatePoint.x||u.isResize?y.location.x:u.translatePoint.x))*(n.isNullOrUndefined(u.scale)?y.scale:u.scale)+a.offset.x,ot=(ut.y+(n.isNullOrUndefined(u.translatePoint)||0===u.translatePoint.y||u.isResize?y.location.y:u.translatePoint.y))*(n.isNullOrUndefined(u.scale)?y.scale:u.scale)+a.offset.y);fi=u.element.id+"_LayerIndex_"+e+"_MarkerIndex_"+ft+"_dataIndex_"+yt+"_cluster_"+pt;ei=u.element.id+"_LayerIndex_"+e+"_MarkerIndex_"+ft+"_dataIndex_"+yt+"_cluster_"+pt+"_datalabel_"+pt;pt++;p=or(lt.shape,lt.imageUrl,{x:0,y:0},fi,lt,s,u);p.setAttribute("transform","translate( "+et+" "+ot+" )");"Balloon"===g.shape?p.children[0].textContent=nt.toString():p.textContent=nt.toString();kt=new tt(ei,0,3.75,"middle",(at.length+1).toString(),"","");(wt=ht(kt,gt,gt.color,s)).setAttribute("transform","translate( "+et+" "+ot+" )");ii=parseFloat(p.id.split("_MarkerIndex_")[1]);a.clusterSettings.allowClustering&&ii===ft||t.markerClusterSettings.allowClustering&&t.markerSettings.length>1&&ii===ft?(b.appendChild(p),b.appendChild(wt)):(b.appendChild(wt),b.appendChild(p))}at=[]}else lr(u,bt,e,c,nt);ni=!0}),c.appendChild(b),u.svgObject.appendChild(c),u.element.appendChild(u.svgObject),k.allowDeepClustering&&!p&&Array.prototype.forEach.call(b.childNodes,function(i,r){var u,f,e;if("hidden"!==i.style.visibility&&(d=(rt=i).getBoundingClientRect(),!(n.isNullOrUndefined(d)||rt.id.indexOf("_datalabel_")>-1))){for(u=r+1;u<b.childElementCount;u++)"hidden"===b.childNodes[u].style.visibility||(yt=b.childNodes[u],st=yt.getBoundingClientRect(),n.isNullOrUndefined(st)||yt.id.indexOf("_datalabel_")>-1||d.left>st.right||d.right<st.left||d.top>st.bottom||d.bottom<st.top)||(ft.push(yt),ft.push(b.childNodes[u-1]),b.childNodes[u].style.visibility="hidden",f=n.isNullOrUndefined(b.childNodes[u+1])?null:parseFloat(b.childNodes[u+1].id.split("_MarkerIndex_")[1]),ct.clusterSettings.allowClustering&&f===o||t.markerClusterSettings.allowClustering&&t.markerSettings.length>1&&f===o?b.childNodes[u+1].style.visibility="hidden":(f=parseFloat(b.childNodes[u-1].id.split("_MarkerIndex_")[1]),b.childNodes[u-1].style.visibility=f===o?"hidden":b.childNodes[u-1].style.visibility),nt.push(u));if(ft.length>0)for(rt=i,e=0;e<ft.length;e++)"g"===rt.tagName?rt.childNodes[0].textContent=rt.childNodes[0].textContent+","+ft[e].textContent:rt.textContent=rt.textContent+","+ft[e].textContent,f=parseFloat(b.childNodes[r+1].id.split("_MarkerIndex_")[1]),ct.clusterSettings.allowClustering&&f===o||t.markerClusterSettings.allowClustering&&t.markerSettings.length>1&&f===o?b.childNodes[r+1].textContent=(+b.childNodes[r+1].textContent+ +ft[e+1].textContent).toString():(f=parseFloat(b.childNodes[r-1].id.split("_MarkerIndex_")[1]),b.childNodes[r-1].textContent=f===o?(+b.childNodes[r-1].textContent+ +ft[e+1].textContent).toString():b.childNodes[r-1].textContent),e++;ft=[]}});0<b.childNodes.length;)ii=parseFloat(b.childNodes[0].id.split("_MarkerIndex_")[1]),ct.clusterSettings.allowClustering&&ii===o||t.markerClusterSettings.allowClustering&&t.markerSettings.length>1&&ii===o?s.insertBefore(b.childNodes[0],null):ii===o&&s.insertBefore(b.childNodes[0],s.firstChild);l||r(u.element.id+"_Secondary_Element").appendChild(s);ri=document.getElementById(u.element.id+"_LayerIndex_"+e+"_Polygon_Group");ui=document.getElementById(u.element.id+"_LayerIndex_"+e+"_Polygons_Group");n.isNullOrUndefined(ri)&&!u.isTileMap?c.insertBefore(s,c.firstChild):u.isTileMap?n.isNullOrUndefined(ui)?n.isNullOrUndefined(ri)?c.insertBefore(s,c.firstChild):ri.insertAdjacentElement("afterend",s):ui.insertAdjacentElement("afterend",s):c.appendChild(s);fi=document.getElementById(u.element.id+"_LayerIndex_"+e+"_markerCluster");(n.isNullOrUndefined(fi)||fi.remove(),a)&&(ut=document.getElementById(u.element.id+"_Layer_Collections"),ei=document.getElementById(u.element.id+"_LayerIndex_"+(e+1)),n.isNullOrUndefined(ut)||n.isNullOrUndefined(ei)?n.isNullOrUndefined(ut)||ut.appendChild(c):ut.insertBefore(c,ei))}),ni}function lr(t,i,r,u,f){var e,o;1===i?(e=n.isNullOrUndefined(t.markerModule.initialMarkerCluster[r][u])?[]:f.length>1?f:[],t.markerModule.initialMarkerCluster[r][u]=e,o=n.isNullOrUndefined(t.markerModule.zoomedMarkerCluster[r][u])?[]:f.length>1?f:[],t.markerModule.zoomedMarkerCluster[r][u]=o):i>1&&(t.markerModule.zoomedMarkerCluster[r][u]=f.length>1?f:[])}function ar(t,i,r,u,f){var e=t.getBoundingClientRect();n.isNullOrUndefined(e)||i.left>e.right||i.right<e.left||i.top>e.bottom||i.bottom<e.top||(r.push(e),t.style.visibility="hidden",u.push(f))}function vr(t,i){var h,u=t[0].layerIndex,l=t[0].targetClusterIndex,e=t[0].markerIndex,y=t[0].dataIndex,f=i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+e,a=i.layers[u].markerSettings[e],s=f+"_dataIndex_"+y+"_cluster_"+l,p="Balloon"===i.layers[u].markerClusterSettings.shape?o(s+"_Group"):o(s),w=o(s+"_datalabel_"+l),v,r;for(p.setAttribute("visibility","visible"),w.setAttribute("visibility","visible"),v=t[0].data.length,r=0;r<v;r++)(h="Balloon"===a.shape&&n.isNullOrUndefined(a.template)?o(f+"_dataIndex_"+t[0].data[r].index+"_Group"):o(f+"_dataIndex_"+t[0].data[r].index)).style.visibility="hidden",h.id.indexOf("Group")>-1&&(o(f+"_dataIndex_"+t[0].data[r].index).style.visibility="hidden");c(i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+e+"_markerClusterConnectorLine")}function yr(t,i,r,u){var w=t[0].layerIndex,b=t[0].markerIndex,ct=t[0].targetClusterIndex,rt=t[0].dataIndex,e=u?o:r.querySelector.bind(r),s=u?"":"#",h=i.element.id+"_LayerIndex_"+w+"_MarkerIndex_"+b,k=i.layers[w],lt=!i.markerModule.allowInnerClusterSetting(k)&&k.markerClusterSettings.allowClustering?k.markerClusterSettings:k.markerSettings[b].clusterSettings,l=k.markerSettings[b],ot=h+"_dataIndex_"+rt+"_cluster_"+ct,st="Balloon"===lt.shape?e(s+""+ot+"_Group"):e(s+""+ot),bt=e(s+""+ot+"_datalabel_"+ct),y,p,it,wt,et;st.setAttribute("visibility","hidden");bt.setAttribute("visibility","hidden");var f="Balloon"===l.shape&&n.isNullOrUndefined(l.template)?e(s+""+h+"_dataIndex_"+rt+"_Group"):e(s+""+h+"_dataIndex_"+rt),d=f.parentElement.id.indexOf("Template_Group")>-1?f.getBoundingClientRect().height:l.height,c=f.parentElement.id.indexOf("Template_Group")>-1?f.getBoundingClientRect().width:l.width,at=+st.getAttribute("transform").split("translate(")[1].trim().split(" ")[0],vt=+st.getAttribute("transform").split("translate(")[1].trim().split(" ")[1].split(")")[0].trim(),ut=(c="string"==typeof c?parseFloat(c):c)+5,g=6.28*ut,ht=0,a=Math.round(g/c);ht+=a;for(var ft=t[0].data.length,nt=Math.round(d/g*100),yt=(nt=ft<a?100/ft:nt)/100*360,tt=ft<a?45:0,kt=1,dt="M "+at+" "+vt+" ",pt="",v=0;v<ft;v++){if(ht===v||Math.round(tt)>=360){for(tt=0,g=6.28*(ut=(c+5)*++kt),a=Math.round(g/d),nt=Math.round(d/g*100);nt*a<100;)a++;yt=nt/100*360;ht+=a}y=at+ut*Math.sin(2*Math.PI*tt/360);p=vt+ut*Math.cos(2*Math.PI*tt/360);pt+=dt+"L "+y+" "+p+" ";(f="Balloon"===l.shape&&n.isNullOrUndefined(l.template)?e(s+""+h+"_dataIndex_"+t[0].data[v].index+"_Group"):e(s+""+h+"_dataIndex_"+t[0].data[v].index)).parentElement.id.indexOf("Template_Group")>-1?(f.style.transform="",f.style.left=i.isTileMap?y-c/2+"px":y-c/2-10+"px",f.style.top=i.isTileMap?p-d/2+"px":p-d/2-10+"px",f.setAttribute("transform","translate( "+y+" "+p+")")):f.setAttribute("transform","translate( "+y+" "+p+")");f.style.visibility="visible";f.id.indexOf("Group")>-1&&(e(s+""+h+"_dataIndex_"+t[0].data[v].index).style.visibility="visible");tt+=yt}it=lt.connectorLineSettings;wt={d:pt,id:i.element.id+"_LayerIndex_"+w+"_MarkerIndex_"+b+"_dataIndex_"+rt+"_markerClusterConnectorLine",stroke:it.color,"fill-opacity":it.opacity,"stroke-opacity":it.opacity,"stroke-width":it.width};r=u?e(i.element.id+"_Markers_Group"):r;r=e(i.element.id+"_LayerIndex_"+w).querySelector("#"+r.id);et=i.renderer.createGroup({id:i.element.id+"_LayerIndex_"+w+"_MarkerIndex_"+b+"_markerClusterConnectorLine"});et.appendChild(i.renderer.drawPath(wt));"Balloon"===l.shape?r.insertBefore(et,r.querySelector("#"+h+"_dataIndex_0_Group")):r.insertBefore(et,r.querySelector("#"+h+"_dataIndex_0"))}function pr(t,i,r,u,e,o,s,h,l,a,v){var nt={size:new w(t.width,t.height),fill:t.fill,borderColor:t.border.color,borderWidth:t.border.width,opacity:i.opacity,dashArray:i.dashArray,borderOpacity:n.isNullOrUndefined(t.border.opacity)?i.opacity:t.border.opacity},k,d,g;c(s);var y=or(t.shape,t.imageUrl,{x:0,y:0},s,nt,v,a),p=(a.isTileMap?e.x:(e.x+o.x)*l)+(n.isNullOrUndefined(h)||n.isNullOrUndefined(h.x)?0:h.x),b=(a.isTileMap?e.y:(e.y+o.y)*l)+(n.isNullOrUndefined(h)||n.isNullOrUndefined(h.y)?0:h.y);return(y.setAttribute("transform","translate( "+p+" "+b+" )"),ri(a.selectedMarkerElementId,a.markerSelectionClass,y,"MarkerselectionMapStyle"),a.legendSettings.toggleLegendSettings.enable&&"Markers"===a.legendSettings.type)&&(k=parseInt(y.id.split("_LayerIndex_")[1],10),br(a.toggledElementId,"g"===y.tagName?y.children[0]:y,a.legendSettings.toggleLegendSettings.applyShapeSettings?a.layers[k].shapeSettings:a.legendSettings.toggleLegendSettings)),v.appendChild(y),d=r.length-1===u?"marker":null,g=new f(p,b),(i.animationDuration>0||"Enable"===n.animationMode)&&iu(y,i.animationDelay,i.animationDuration,g,a,d),v}function wr(t,i,r,u,f,e,o,s,h,c,l){if((i=ei(t.template,l))&&i(u,l,t.template,l.element.id+"_MarkerTemplate"+f,!1).length){for(var a=function(t,i,r,u,f,e){var h=n.createElement("div",{id:i,className:f.element.id+"_marker_template_element"}),l;for(h.style.cssText="position: absolute;pointer-events: auto;",l=t.length;l>0;)h.appendChild(t[0]),l--;if(!f.isReact||"function"!==e){for(var c=h.innerHTML,s=Object.keys(r),a=RegExp,o=0;o<s.length;o++)"object"==typeof r[s[o]]?c=er(c,"",r,f):"latitude"!==s[o].toLowerCase()&&"longitude"!==s[o].toLowerCase()&&(c=c.replace(new a("{{:"+s[o]+"}}","g"),r[s[o].toString()]));h.innerHTML=c}return h}(i(u,l,t.template,l.element.id+"_MarkerTemplate"+f,!1),r,u,0,l,typeof t.template),v=0;v<a.children.length;v++)a.children[v].style.pointerEvents="auto";a.style.left=(l.isTileMap?o.x:(o.x+s.x)*h)+c.x-(l.isTileMap?0:l.mapAreaRect.x)+"px";a.style.top=(l.isTileMap?o.y:(o.y+s.y)*h)+c.y-(l.isTileMap?0:l.mapAreaRect.y)+"px";a.style.transform="translate(-50%, -50%)";e.appendChild(a)}return e}function ri(t,i,r,u){if(t)for(var f=0;f<t.length;f++)r.getAttribute("id")===t[f]&&(0!==f&&"g"!==r.tagName||(n.isNullOrUndefined(i)||n.isNullOrUndefined(i.id)||document.body.appendChild(i),r.id.indexOf("_MarkerIndex_")>-1&&r.childElementCount>0&&r.children[0].setAttribute("class",u)),r.setAttribute("class",u))}function br(t,i,r){if(!n.isNullOrUndefined(t)&&t.length>0)for(var u=0;u<t.length;u++)t[u]===i.id&&(i.setAttribute("fill",r.fill),i.setAttribute("stroke",r.border.color),i.setAttribute("fill-opacity",r.opacity.toString()),i.setAttribute("stroke-opacity",(n.isNullOrUndefined(r.border.opacity)?r.opacity:r.border.opacity).toString()),i.setAttribute("stroke-width",(n.isNullOrUndefined(r.border.width)?0:r.border.width).toString()))}function ui(n,t){return t&&t.appendChild(n),n}function kr(n,t,i,r,u,f){var e,c=i.width,o=i.height,h;r.x-=c/2;r.y-=t.id.indexOf("cluster")>-1?o/2:t.id.indexOf("Legend")>-1?o/1.25:o;t.d="M15,0C8.8,0,3.8,5,3.8,11.2C3.8,17.5,9.4,24.4,15,30c5.6-5.6,11.2-12.5,11.2-18.8C26.2,5,21.2,0,15,0z M15,16c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S17.8,16,15,16z";var s=n.renderer.drawPath(t),l=i.width/30,a=i.height/30;return(s.setAttribute("transform","translate("+r.x+", "+r.y+") scale("+l+", "+a+")"),"Marker"===u)?(h=n.renderer.createGroup({id:t.id+"_Group"}),ui(s,h),e=ui(h,f)):e=s,e}function ct(t,i,r,u){var f,e,o;if(!n.isNullOrUndefined(i)&&!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(r))for(f=0;f<t.length;f++)if(e=r.indexOf(".")>-1?h(t[f],r):t[f][r],o=fi(e,u,i),(!n.isNullOrUndefined(e)&&isNaN(i[o])&&"string"==typeof e?e.toLowerCase():e)===(!n.isNullOrUndefined(i[o])&&isNaN(i[o])?i[o].toLowerCase():i[o]))return f;return null}function fi(t,i,r){if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(r)&&!n.isNullOrUndefined(i))for(var f="[object Array]"===Object.prototype.toString.call(i)?i:[i],u=0;u<f.length;u++)if((n.isNullOrUndefined(t)||"string"!=typeof t?t:t.toLowerCase())===(!n.isNullOrUndefined(r[f[u]])&&isNaN(r[f[u]])?r[f[u]].toLowerCase():r[f[u]]))return f[u];return null}function wi(n,t,i){var b,r;if(!n.length)return null;for(var a,v,o,s,w=n.length,h=0,u=0,f=0,e=0;e<=w-1;e++)a=n[e].x,v="Mercator"===t||"Normal"===i?n[e].y:-n[e].y,e===w-1?(o=n[0].x,s="Mercator"===t||"Normal"===i?n[0].y:-n[0].y):(o=n[e+1].x,s="Mercator"===t||"Normal"===i?n[e+1].y:-n[e+1].y),h+=Math.abs(a*s-o*v),u+=Math.abs((a+o)*(a*s-o*v)),f+=Math.abs((v+s)*(a*s-o*v));h*=.5;b=n.some(function(n){return n.x<5&&n.y<5})&&"Normal"===i?6:4;u=0!==h?1/(b*h)*u:0;f=0!==h?1/(b*h)*f:0;var k={x:0,y:0},y={x:0,y:0},d={x:0,y:0},p={x:0,y:0},g={x:0,y:0},c={x:0,y:0},nt={x:0,y:0},l={x:0,y:0},tt=0;for(e=0;e<=w-1;e++)r=n[e],r.y="Mercator"===t||"Normal"===i?r.y:-r.y,r.y>f?r.x<u&&u-r.x<u-g.x?g={x:r.x,y:r.y}:r.x>u&&(0===c.x||r.x-u<c.x-u)&&(c={x:r.x,y:r.y}):r.x<u&&u-r.x<u-nt.x?nt={x:r.x,y:r.y}:r.x>u&&(0===l.x||r.x-u<l.x-u)&&(l={x:r.x,y:r.y}),tt=c.y-l.y+(c.y-l.y)/4,r.x>u?r.y<f&&f-r.y<f-k.y?k={x:r.x,y:r.y}:r.y>f&&(0===y.y||r.y-f<y.y-f)&&(y={x:r.x,y:r.y}):r.y<f&&f-r.y<f-d.y?d={x:r.x,y:r.y}:r.y>f&&(0===p.y||r.y-f<p.y-f)&&(p={x:r.x,y:r.y});return{x:u,y:f,rightMin:k,rightMax:y,leftMin:d,leftMax:p,points:n,topMax:l,topMin:nt,bottomMax:c,bottomMin:g,height:tt}}function dr(t){var i=!1;return"[object Array]"===Object.prototype.toString.call(t)&&Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(t.geometry)||"Path"!==t.geometry.type||(i=!0)}),i}function g(t,i,r,u,f,e){var o=i,s;if(n.isNullOrUndefined(u)&&(u=f?st(i,r).width:p(i,r).width),u>t)for(s=i.length-1;s>=0;--s)if(o=i.substring(0,s)+"...",(u=f?st(o,r).width:p(o,r).width)<=t||o.length<4)return o.length<4&&(o=" "),n.isNullOrUndefined(e)||e.push(u),o;return n.isNullOrUndefined(e)||e.push(u),o}function c(t){var i=document.getElementById(t);return i?n.remove(i):null}function gr(n,t){var i=v(n.minLatOfGivenLocation,n.minLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),r=v(n.maxLatOfGivenLocation,n.maxLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),u=(i.x+r.x)/2,e=(i.y+r.y)/2;return new f(u,e)}function ut(t,i,r){var e,y=t.zoomSettings.zoomFactor,k=t.centerPosition,p=k.latitude,w=k.longitude,d=!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&t.zoomNotApplied,h,c,u,ft,ot,b,it,rt,st;n.isNullOrUndefined(t.mapScaleValue)&&(t.mapScaleValue=y);t.zoomSettings.shouldZoomInitially&&t.zoomSettings.enable&&(t.mapScaleValue=e=y=(t.zoomSettings.shouldZoomInitially||t.enablePersistence)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?1:t.markerZoomedState?t.markerZoomFactor:parseInt(t.scale.toString()),t.markerZoomedState&&t.mapScaleValue!==t.markerZoomFactor&&!t.enablePersistence&&(t.mapScaleValue=y=t.markerZoomFactor),!t.markerZoomedState||n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(p=t.markerCenterLatitude,w=t.markerCenterLongitude));d&&(t.mapScaleValue=e=y=t.scaleOfGivenLocation);var l=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.min,g=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.max,ut=r?1:t.mapScaleValue;if(n.isNullOrUndefined(t.currentShapeDataLength)&&!n.isNullOrUndefined(i.shapeData)&&(t.currentShapeDataLength=n.isNullOrUndefined(i.shapeData.features)?n.isNullOrUndefined(i.shapeData.geometries)?0:i.shapeData.geometries.length:i.shapeData.features.length),u=t.totalRect&&t.legendSettings.visible?t.totalRect:t.mapAreaRect,ft=t.availableSize,!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(g)){var o=Math.abs(g.x-l.x),s=Math.abs(l.y-g.y),et=r?1:1===t.markerZoomFactor?t.mapScaleValue:y;if(k=t.zoomSettings.shouldZoomInitially&&t.markerZoomedState&&!t.zoomPersistence?t.markerZoomCenterPoint:t.centerPosition,(n.isNullOrUndefined(w)||0===w||n.isNullOrUndefined(p)||0===p)&&!d)if(n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType)0!==s&&0!==o&&s!==o||(o=u.width/2,s=u.height),o*=e=(e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)))>1.05?1:e,s*=e,ot=0!==l.x&&"layers"===t.translateType?ft.width-u.width:0,h=u.x+(-l.x+(u.width/2-o/2))-ot,c=u.y+(-l.y+(u.height/2-s/2)),t.previousTranslate=new f(h,c);else if(t.zoomSettings.shouldZoomInitially||1!==t.markerZoomFactor||1!==t.mapScaleValue)if(e=t.mapScaleValue<1?t.mapScaleValue+1:t.mapScaleValue,t.mapScaleValue=t.zoomSettings.enable&&1!==t.mapScaleValue?t.mapScaleValue:1,t.currentShapeDataLength!==(n.isNullOrUndefined(i.shapeData.features)?i.shapeData.geometries.length:i.shapeData.features.length)&&"SubLayer"!==i.type)b=parseFloat(Math.min(u.height/s,u.width/o).toFixed(2)),s*=b,o*=b,c=u.y+(-l.y+(u.height/2-s/2)),e=b,h=u.x+(-l.x+(u.width/2-o/2));else if(t.availableSize.height===t.heightBeforeRefresh&&t.widthBeforeRefresh===t.availableSize.width||n.isNullOrUndefined(t.translatePoint)||n.isNullOrUndefined(t.previousTranslate))n.isNullOrUndefined(t.previousProjection)||!(1===t.mapScaleValue||t.mapScaleValue<=1.05)||t.zoomModule.isDragZoom?(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y,e=t.scale):(o*=e=(e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)))>1.05?1:e,h=u.x+(-l.x+(u.width/2-o/2)),s*=e,c=u.y+(-l.y+(u.height/2-s/2)));else{it=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2));rt=o;rt*=it;st=s*it;var ht=u.x+(-l.x+(u.width/2-rt/2)),ct=u.y+(-l.y+(u.height/2-st/2)),lt=(t.translatePoint.x-t.previousTranslate.x)/t.widthBeforeRefresh,at=(t.translatePoint.y-t.previousTranslate.y)/t.heightBeforeRefresh;h=ht+lt*t.availableSize.width;c=ct+at*t.availableSize.height;t.previousTranslate=new f(ht,ct);t.zoomTranslatePoint.x=h;t.zoomTranslatePoint.y=c}else s*=e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)),o*=e,c=u.y+(-l.y+(u.height/2-s/2)),h=u.x+(-l.x+(u.width/2-o/2));else{var nt=((o+Math.abs(t.mapAreaRect.width-o))/2+t.mapAreaRect.x)/et,tt=((s+Math.abs(t.mapAreaRect.height-s))/2+t.mapAreaRect.y)/et,a=d?gr(t,i):v(p,w,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType||t.isMarkerZoomCompleted?(h=-a.x+nt,c=-a.y+tt,e=ut):(1!==Math.floor(t.scale)&&t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt):t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt,e=ut):(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y),e=t.mapScaleValue)}n.isNullOrUndefined(t.translatePoint)||(h=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:h,c=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:c)}return e=t.enablePersistence?t.mapScaleValue>=1?t.mapScaleValue:1:e,t.widthBeforeRefresh=t.availableSize.width,t.heightBeforeRefresh=t.availableSize.height,{scale:e,location:new f(h,c)}}function bt(t,i,r){var e,o=t.zoomSettings.zoomFactor,et=t.centerPosition,k=et.latitude,d=et.longitude,tt=!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&t.zoomNotApplied,y,b,ft,p,nt,u;n.isNullOrUndefined(t.previousCenterLatitude)&&n.isNullOrUndefined(t.previousCenterLongitude)?(t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.previousCenterLatitude!==t.centerPosition.latitude&&t.previousCenterLongitude!==t.centerPosition.longitude?(t.centerPositionChanged=!0,t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.centerPositionChanged=!1;(n.isNullOrUndefined(t.mapScaleValue)||o>t.mapScaleValue)&&(t.mapScaleValue=t.isReset&&1===t.mapScaleValue?t.mapScaleValue:!n.isNullOrUndefined(t.mapScaleValue)&&t.mapScaleValue<=t.scale?t.scale:o);t.mapScaleValue=1!==t.zoomSettings.zoomFactor&&t.zoomSettings.zoomFactor===t.mapScaleValue||t.zoomSettings.zoomFactor===t.mapScaleValue||t.centerPositionChanged?t.zoomSettings.zoomFactor:t.mapScaleValue;t.zoomSettings.shouldZoomInitially&&!t.isZoomByPosition&&(t.mapScaleValue=o=e=(t.enablePersistence||t.zoomSettings.shouldZoomInitially)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?t.mapScaleValue:t.markerZoomFactor,o=t.mapScaleValue,n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(k=t.markerCenterLatitude,d=t.markerCenterLongitude));tt&&(t.mapScaleValue=e=o=t.scaleOfGivenLocation);var l,a,it=r?1:t.mapScaleValue,s=t.mapAreaRect,g=t.baseMapRectBounds.min,ot=t.baseMapRectBounds.max,st=r?1:t.mapScaleValue,rt=Math.abs(ot.x-g.x),ut=Math.abs(g.y-ot.y);if((n.isNullOrUndefined(d)||0===d||n.isNullOrUndefined(k)||0===k)&&!tt){if(y=0===t.zoomSettings.zoomFactor?1:t.zoomSettings.zoomFactor,b=t.zoomSettings.maxZoom,e=y=y>b?b:y,ft=0===t.mapScaleValue?1:t.mapScaleValue>b?b:t.mapScaleValue,c=s.x+(-g.x+(s.width/2-rt/2)),h=s.y+(-g.y+(s.height/2-ut/2)),!n.isNullOrUndefined(t.zoomTranslatePoint)||!n.isNullOrUndefined(t.previousProjection))if(t.previousProjection!==t.projectionType){for(p=[],nt={x:c,y:h},p.push(nt),u=1;u<b;u++)nt={x:p[u-1].x-(s.width/u-s.width/(u+1))/2,y:p[u-1].y-(s.height/u-s.height/(u+1))/2},p.push(nt);c=p[y-1].x;h=p[y-1].y}else c=t.zoomTranslatePoint.x,h=t.zoomTranslatePoint.y,y!==ft&&(e=ft);n.isNullOrUndefined(t.translatePoint)||(l=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:c,a=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:h)}else{var h=(ut+Math.abs(t.mapAreaRect.height-ut))/2/st,c=(rt+Math.abs(t.mapAreaRect.width-rt))/2/st,w=tt?gr(t,i):v(k,d,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.zoomTranslatePoint)&&n.isNullOrUndefined(t.previousProjection)||t.zoomNotApplied?(l=-w.x+c+t.mapAreaRect.x/it,a=-w.y+h+t.mapAreaRect.y/it):t.previousProjection!==t.projectionType?(l=-w.x+c,a=-w.y+h):(t.isZoomByPosition&&(t.zoomTranslatePoint.x=-w.x+c,t.zoomTranslatePoint.y=-w.y+h),l=t.zoomTranslatePoint.x,a=t.zoomTranslatePoint.y,o=it);n.isNullOrUndefined(t.translatePoint)||(a=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:a,l=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:l);e=0!==o?o:1}return e=t.enablePersistence?0===t.mapScaleValue?1:t.mapScaleValue:e,t.widthBeforeRefresh=t.availableSize.width,t.heightBeforeRefresh=t.availableSize.height,{scale:r?1:e,location:new f(l,a)}}function r(n){return document.getElementById(n)}function ft(n){return"string"==typeof n?parseFloat(n):n}function nu(n,t){return n.formatFunction=n.intl.getNumberFormat({format:n.format,useGrouping:n.useGroupingSeparator}),n.formatFunction(t)}function ei(t,i){var r=null;try{"function"!=typeof t&&document.querySelectorAll(t).length?r=n.compile(document.querySelector(t).innerHTML.trim()):(i.isVue||i.isVue3||"function"==typeof t)&&(r=n.compile(t))}catch(i){r=n.compile(t)}return r}function o(n){return document.getElementById(n)}function lt(n){return document.getElementsByClassName(n)}function e(n,t){var i=null;return document.getElementById(t)&&(i=document.getElementById(t).querySelector("#"+n)),i}function tu(n,t,i,r){for(var f,e=r.layers[n].shapeData.features,u=0;u<e.length;u++)if(e[u].properties.name===t){f=r.element.id+"_LayerIndex_"+n+"_shapeIndex_"+u+"_dataIndex_undefined";break}return o(f)}function kt(t,i,r){var u=n.createElement("style",{id:t});return u.innerText="."+i+"{fill:"+r.fill+";fill-opacity:"+(n.isNullOrUndefined(r.opacity)?"1":r.opacity.toString())+";stroke-opacity:"+(n.isNullOrUndefined(r.border.opacity)?"1":r.border.opacity.toString())+";stroke-width:"+r.border.width.toString()+";stroke:"+r.border.color+";}",u}function at(t,i,r){var u=o(t);n.isNullOrUndefined(u)||(u.innerText="."+i+"{fill:"+r.fill+";fill-opacity:"+(n.isNullOrUndefined(r.opacity)?"1":r.opacity.toString())+";stroke-width:"+r.border.width.toString()+";stroke-opacity:"+(n.isNullOrUndefined(r.border.opacity)?"1":r.border.opacity.toString())+";stroke:"+r.border.color+"}")}function te(t,i,r,u,f){var s={color:t.border.color,width:t.border.width/i.scale,opacity:t.border.opacity},e={opacity:t.opacity,fill:t.fill,border:s,name:yf,target:r.id,cancel:!1,shapeData:u,data:f,maps:i};i.trigger("itemSelection",e,function(){e.border.opacity=n.isNullOrUndefined(t.border.opacity)?t.opacity:t.border.opacity;i.shapeSelectionItem.push(e.shapeData);o("ShapeselectionMap")?at("ShapeselectionMap","ShapeselectionMapStyle",e):document.body.appendChild(kt("ShapeselectionMap","ShapeselectionMapStyle",e))})}function l(n){n.removeAttribute("class")}function iu(t,i,r,u,f,e,o){void 0===o&&(o=0);var c=u.x,l=u.y,s=0,h=t.getAttribute("transform")||"";new n.Animation({}).animate(t,{duration:0===r&&"Enable"===n.animationMode?1e3:r,delay:i,progress:function(i){if(i.timeStamp>i.delay&&!f.zoomModule.isPanningInProgress){if(f.isTileMap&&0===s){var r=document.querySelector(".GroupElement");n.isNullOrUndefined(r)||(r.style.display="block")}s=(i.timeStamp-i.delay)/i.duration;t.setAttribute("transform","translate( "+(c-o*s)+" "+(l-o*s)+" ) scale("+s+")")}else f.zoomModule.isPanningInProgress&&(h=t.getAttribute("transform"))},end:function(){if(f.zoomModule.isPanningInProgress||t.setAttribute("transform",h),f.zoomModule.isPanningInProgress=!1,e){var n={cancel:!1,name:af,element:e,maps:f};f.trigger(af,n)}}})}function ie(n){c(n)}function bi(t,i,r,u,f,e,o,s,h){var b=li(r,u,s),w;n.isNullOrUndefined(b)||(r=b.x,u=b.y);for(var l=document.getElementById(o),c=p(t,{fontFamily:"Segoe UI",size:"8px",fontStyle:"Normal",fontWeight:"Regular"}).width,a=t.split(" "),v=a[0].length,y=1;y<a.length;y++)v<a[y].length&&(v=a[y].length);l||((l=n.createElement("div",{id:o})).style.cssText='background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(0, 0, 0); padding-left:5px;font-size:12px; font-family: "Segoe UI"; text-align:center');r<f-c||(r>f-c&&r<f-8*v?c=f-r:r>=f-8*v&&(r>c?r-=c:(c=r,r=0)));w=i.split("px");ru(l,t,r,u,w,c,f,s);l.clientHeight+2*parseInt(w[0],10)>e&&(c=r,r=0);ru(l,t,r,u,w,c,f,s);h&&setTimeout(ie,5e3,o)}function ru(n,t,i,r,u,f,e,o){n.innerText=t;n.style.top=-1!==n.id.indexOf("_Legend")?(parseInt(u[0],10)+r).toString()+"px":(2*parseInt(u[0],10)).toString()+"px";n.style.left=i.toString()+"px";n.style.width=f.toString()+"px";n.style.maxWidth=e.toString()+"px";n.style.wordWrap="break-word";o.appendChild(n)}function uu(n){var i,t;return-1!==n.indexOf("#")&&-1===n.toLowerCase().indexOf("rgb")?(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n))?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null:-1!==n.toLowerCase().indexOf("rgb")?(t=n.match(/\d+/g).map(function(n){return parseInt(n,10)}))?{r:t[0],g:t[1],b:t[2]}:null:(i=document.createElement("div"),i.style.color=n,t=window.getComputedStyle(document.body.appendChild(i)).color.match(/\d+/g).map(function(n){return parseInt(n,10)}),document.body.removeChild(i),t?{r:t[0],g:t[1],b:t[2]}:null)}function fu(t,i,r,u){for(var f,o,h,e=0;e<t.childElementCount;e++)if((f=t.childNodes[e]).id.indexOf("_NavigationGroup")>-1)re(f,i,r,u);else if(f.id.indexOf("_Polygons_Group")>-1)for(o=0;o<f.childElementCount;o++)h=u.layersCollection[i].polygonSettings.polygons[parseInt(f.children[o].id.split("_PolygonIndex_")[1])].borderWidth,f.children[o].setAttribute("stroke-width",(h/r).toString());else{var c,s=0,l=u.layersCollection[i].shapeSettings.borderWidthValuePath,a=u.layersCollection[i].shapeSettings.border.width,v=u.layersCollection[i].shapeSettings.circleRadius;c=u.layersCollection[i].shapeSettings.borderWidthValuePath&&null!==(s=ct(u.layersCollection[i].dataSource,u.layersCollection[i].layerData[e].property,u.layersCollection[i].shapeDataPath,u.layersCollection[i].shapePropertyPath,u.layersCollection[i]))&&u.layersCollection[i].dataSource[s][l]?u.layersCollection[i].dataSource[s][l]:n.isNullOrUndefined(a)?0:a;f.setAttribute("stroke-width",(c/r).toString());(t.id.indexOf("_Point")>-1||t.id.indexOf("_MultiPoint")>-1)&&f.setAttribute("r",(v/r).toString())}}function re(n,t,i,r){for(var f,e,u=0;u<n.childElementCount;u++)"path"===(f=n.childNodes[u]).tagName&&(e=r.layersCollection[t].navigationLineSettings[parseFloat(f.id.split("_NavigationIndex_")[1].split("_")[0])].width,f.setAttribute("stroke-width",(e/i).toString()))}function eu(n){for(var r=[],i=n.touches,t=0;t<i.length;t++)r.push({pageX:i[t].pageX,pageY:i[t].pageY});return r}function ou(n,t){var i=n.pageX-t.pageX,r=n.pageY-t.pageY;return Math.sqrt(i*i+r*r)}function su(n,t){return n+t}function ue(n,t,i,r,u,f,e){var c=0,o=e.previousPoint,l=e.previousScale,v=u-l,s=new b(0,0),h=1;if(u!==l){var a=function(n,t){return n.x===t.x?null:(t.y-n.y)/(t.x-n.x)}(o,r),y=function(n,t){return null===t?n.x:n.y-t*n.x}(o,a),p=r.x-o.x,w=r.y-o.y;hu(n,0,i,function(n){n.timeStamp>n.delay&&(c=(n.timeStamp-n.delay)/n.duration,h=l+c*v,s.x=o.x+c*p/(h/u),s.y=null==a?o.y+c*w:a*s.x+y,n.element.setAttribute("transform","scale( "+h+" ) translate( "+s.x+" "+s.y+" )"),e.translatePoint=s,e.scale=h,e.zoomModule.processTemplate(r.x,r.y,h,e))},function(){e.translatePoint=r;e.scale=u;n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )");e.zoomModule.processTemplate(r.x,r.y,u,e)})}else n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )")}function hu(t,i,u,f,e){var h,c=this,o=null,s;u="Disable"===n.animationMode?0:u;s=function(n){o||(o=n);var i=n-o;i<u?(f.call(c,{element:t,delay:0,timeStamp:i,duration:u}),window.requestAnimationFrame(s)):(window.cancelAnimationFrame(h),e.call(c,{element:t}),t.id.indexOf("Marker")>-1&&(r(t.id.split("_Layer")[0]+"_Markers_Group").style.cssText="visibility:visible"))};h=window.requestAnimationFrame(s)}function di(n,t,i,r){var o=0,u=n.getAttribute("transform").split(" ");2===u.length&&(u[2]=u[1].split(")")[0],u[1]=u[0].split("(")[1]);var f=new b(parseInt(u[1],10),parseInt(u[2],10)),s=r.x-f.x,h=r.y-f.y,e=new b(0,0);hu(n,0,i,function(n){n.timeStamp>n.delay&&(o=(n.timeStamp-n.delay)/n.duration,e.x=f.x+o*s,e.y=f.y+o*h,n.element.setAttribute("transform","translate( "+e.x+" "+e.y+" )"))},function(){n.setAttribute("transform","translate( "+r.x+" "+r.y+" )")})}function yu(t,i){var u=n.isNullOrUndefined(i.shouldZoomPreviousFactor)?null:i.shouldZoomPreviousFactor,r=n.isNullOrUndefined(i.shouldZoomCurrentFactor)?null:i.shouldZoomCurrentFactor;n.isNullOrUndefined(r)?!n.isNullOrUndefined(u)&&n.isNullOrUndefined(r)&&i.shouldZoomPreviousFactor!==t?i.shouldZoomCurrentFactor=t:i.shouldZoomPreviousFactor=t:(i.shouldZoomCurrentFactor=null,i.shouldZoomPreviousFactor=null)}function pu(n,t,i,r,u,f,e,o){var s,a,b=e.zoomSettings.maxZoom,v=Math.sin(t*Math.PI/180),k=Math.log((1+v)/(1-v))/2,d=Math.max(Math.min(k,Math.PI),-Math.PI)/2,y=Math.sin(n*Math.PI/180),g=Math.log((1+y)/(1-y))/2,nt=Math.max(Math.min(g,Math.PI),-Math.PI)/2,h,c;e.zoomNotApplied&&!e.isTileMap&&(h=Math.abs((e.baseMapBounds.latitude.max-e.baseMapBounds.latitude.min)/(t-n)),c=Math.abs((e.baseMapBounds.longitude.max-e.baseMapBounds.longitude.min)/(r-i)),a=o?(h+c)/2:Math.min(h,c));var tt=(d-nt)/Math.PI,l=r-i,it=(l<0?l+360:l)/360,p=Math.log(f/256/tt)/Math.LN2,w=Math.log(u/256/it)/Math.LN2,rt=e.zoomNotApplied&&!e.isTileMap?a:o&&!e.isTileMap?(p+w)/2:Math.min(p,w);return s=Math.min(rt,b),s=e.isTileMap||!e.zoomNotApplied?Math.floor(s):s,e.isTileMap||yu(s,e),s}function dt(t){var r,i=n.isNullOrUndefined(t.result)?t.actual:t.result;return n.isNullOrUndefined(i.length)?n.isNullOrUndefined(i.Items)||(r=i.Items):r=i,r}var hi,ti,ci,w,et,cu,lu,au,vu,ki,si,gf;hi=t(864);const n=ejdashboard.base,ot=ejdashboard.svgbase;ci=(ti=function(n,t){return ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},ti(n,t)},function(n,t){function i(){this.constructor=n}ti(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});w=function(){return function(n,t){this.width=n;this.height=t}}();var f=function(){return function(n,t){this.x=n;this.y=t}}(),fr=function(){return function(n,t){this.min=n;this.max=t}}(),vi=function(){return function(n,t){this.latitude=new fr(n.min,n.max);this.longitude=new fr(t.min,t.max)}}();var tt=function(){return function(n,t,i,r,u,f,e){void 0===f&&(f="");this.transform="";this.baseLine="auto";this.id=n;this.text=u;this.transform=f;this.anchor=r;this.x=t;this.y=i;this.baseLine=e}}(),y=function(){return function(n,t,i,r,u,f,e,o){this.id=n;this["fill-opacity"]=u;this["stroke-opacity"]=f;this.fill=t;this.stroke=r;this["stroke-width"]=i;this["stroke-dasharray"]=e;this.d=o}}(),ne=function(){return function(n,t,i){this.r=n;this.g=t;this.b=i}}(),d=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,r.opacity)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c["stroke-dasharray"]=h,c["fill-opacity"]=u,c["stroke-opacity"]=r.opacity,c}return ci(t,n),t}(y),yt=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,r.color,u,r.opacity,s)||this;return h.cy=e,h.cx=f,h.r=o,h["stroke-dasharray"]=s,h["fill-opacity"]=u,h["stroke-opacity"]=r.opacity,h}return ci(t,n),t}(y),b=function(){return function(n,t){this.x=n;this.y=t}}(),a=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}();ki=function(){return function(n,t,i,r,u){this.dataOptions=n;this.type=t||"GET";this.async=i||!0;this.contentType=r;this.sendData=u}}();!function(n){n.mapsTitleFont={size:"14px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:null,fontStyle:"Regular",fontFamily:null};n.legendTitleFont={size:"12px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:null};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:null,fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(et||(et={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"}}(cu||(cu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"}}(lu||(lu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#000000",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:null,fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(au||(au={})),function(n){n.mapsTitleFont={fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",size:"14px",fontStyle:"Medium",color:"#FFFFFF"};n.mapsSubTitleFont={size:"13px",color:"#FFFFFF",fontWeight:"Medium",fontFamily:"Roboto, Noto, Sans-serif",fontStyle:"Medium"};n.tooltipLabelFont={size:"12px",color:"#282727",fontWeight:"Regular",fontFamily:"Roboto",fontStyle:"Regular"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",color:"#DADADA",fontStyle:"Medium"}}(vu||(vu={}));var s=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},fe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("")],r.prototype,"content",void 0),i([n.Property("0px")],r.prototype,"x",void 0),i([n.Property("0px")],r.prototype,"y",void 0),i([n.Property("None")],r.prototype,"verticalAlignment",void 0),i([n.Property("None")],r.prototype,"horizontalAlignment",void 0),i([n.Property("-1")],r.prototype,"zIndex",void 0),r}(n.ChildProperty),ee=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("Start")],r.prototype,"position",void 0),i([n.Property("false")],r.prototype,"showArrow",void 0),i([n.Property(2)],r.prototype,"size",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"offSet",void 0),r}(n.ChildProperty),rt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"size",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property("Roboto, Noto, Sans-serif")],r.prototype,"fontFamily",void 0),i([n.Property("Medium")],r.prototype,"fontWeight",void 0),i([n.Property("Medium")],r.prototype,"fontStyle",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),oe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("transparent")],r.prototype,"fill",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property(null)],r.prototype,"borderColor",void 0),i([n.Property(null)],r.prototype,"radius",void 0),i([n.Property(null)],r.prototype,"selectionColor",void 0),i([n.Property(null)],r.prototype,"highlightColor",void 0),i([n.Property(5)],r.prototype,"padding",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(["ZoomIn","ZoomOut","Reset"])],r.prototype,"toolbarItems",void 0),r}(n.ChildProperty),se=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("white")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property("#707070")],r.prototype,"borderColor",void 0),i([n.Property("black")],r.prototype,"fontColor",void 0),i([n.Property("")],r.prototype,"fontFamily",void 0),i([n.Property("")],r.prototype,"fontStyle",void 0),i([n.Property("")],r.prototype,"fontWeight",void 0),i([n.Property("")],r.prototype,"fontSize",void 0),i([n.Property(1)],r.prototype,"fontOpacity",void 0),r}(n.ChildProperty),he=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("transparent")],r.prototype,"backgroundColor",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property("transparent")],r.prototype,"borderColor",void 0),i([n.Property("Far")],r.prototype,"horizontalAlignment",void 0),i([n.Property("Near")],r.prototype,"verticalAlignment",void 0),i([n.Property("Horizontal")],r.prototype,"orientation",void 0),i([n.Complex({},oe)],r.prototype,"buttonSettings",void 0),i([n.Complex({},se)],r.prototype,"tooltipSettings",void 0),r}(n.ChildProperty),k=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"opacity",void 0),r}(n.ChildProperty),ce=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),gi=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("")],r.prototype,"template",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:null,width:1},k)],r.prototype,"border",void 0),i([n.Complex({fontFamily:null,size:null,fontWeight:null},rt)],r.prototype,"textStyle",void 0),i([n.Property(null)],r.prototype,"format",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property(2e3)],r.prototype,"duration",void 0),r}(n.ChildProperty),le=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:null,width:1},k)],r.prototype,"border",void 0),i([n.Complex({fontFamily:null,size:null,fontWeight:null},rt)],r.prototype,"textStyle",void 0),i([n.Property(2e3)],r.prototype,"duration",void 0),r}(n.ChildProperty),ae=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(10)],r.prototype,"left",void 0),i([n.Property(10)],r.prototype,"right",void 0),i([n.Property(10)],r.prototype,"top",void 0),i([n.Property(10)],r.prototype,"bottom",void 0),r}(n.ChildProperty),ve=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("#000000")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),wu=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"allowClustering",void 0),i([n.Property(!0)],r.prototype,"allowDeepClustering",void 0),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),i([n.Property("#D2691E")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Rectangle")],r.prototype,"shape",void 0),i([n.Property(12)],r.prototype,"width",void 0),i([n.Property(12)],r.prototype,"height",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Complex({},rt)],r.prototype,"labelStyle",void 0),i([n.Property(!1)],r.prototype,"allowClusterExpand",void 0),i([n.Complex({},ve)],r.prototype,"connectorLineSettings",void 0),r}(n.ChildProperty),bu=(n.ChildProperty,function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"from",void 0),i([n.Property(null)],r.prototype,"to",void 0),i([n.Property(null)],r.prototype,"value",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"minOpacity",void 0),i([n.Property(null)],r.prototype,"maxOpacity",void 0),i([n.Property(null)],r.prototype,"label",void 0),i([n.Property(!0)],r.prototype,"showLegend",void 0),r}(n.ChildProperty)),ye=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),pe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"shapePath",void 0),i([n.Property(null)],r.prototype,"shapeValue",void 0),r}(n.ChildProperty),gt=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(!1)],r.prototype,"enableMultiSelect",void 0),i([n.Complex({color:"transparent",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),ni=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Complex({color:"transparent",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),we=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("#FF471A")],r.prototype,"borderColor",void 0),i([n.Property("#FF471A")],r.prototype,"fill",void 0),i([n.Property([])],r.prototype,"points",void 0),i([n.Property("")],r.prototype,"tooltipText",void 0),i([n.Property("")],r.prototype,"tooltipTemplate",void 0),r}(n.ChildProperty),be=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Collection([],we)],r.prototype,"polygons",void 0),i([n.Complex({},gt)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ni)],r.prototype,"highlightSettings",void 0),i([n.Complex({},le)],r.prototype,"tooltipSettings",void 0),r}(n.ChildProperty),ke=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"angle",void 0),i([n.Complex({showArrow:!1,position:"Start",size:5,color:"black"},ee)],r.prototype,"arrowSettings",void 0),i([n.Complex({},gt)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ni)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),de=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Complex({},k)],r.prototype,"border",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Property(10)],r.prototype,"minRadius",void 0),i([n.Property(20)],r.prototype,"maxRadius",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property("Circle")],r.prototype,"bubbleType",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Collection([],bu)],r.prototype,"colorMapping",void 0),i([n.Complex({},gi)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},gt)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ni)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),nr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property("")],r.prototype,"text",void 0),i([n.Property("")],r.prototype,"description",void 0),r}(n.ChildProperty),ge=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Complex({size:null,fontWeight:null,fontFamily:null},rt)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),r}(nr),no=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Complex({size:null,fontWeight:null,fontFamily:null},rt)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Complex({},ge)],r.prototype,"subtitleSettings",void 0),r}(nr),to=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"enablePanning",void 0),i([n.Property(!0)],r.prototype,"enableSelectionZooming",void 0),i([n.Property(!0)],r.prototype,"mouseWheelZoom",void 0),i([n.Property(!1)],r.prototype,"doubleClickZoom",void 0),i([n.Property(!0)],r.prototype,"pinchZooming",void 0),i([n.Property(!1)],r.prototype,"zoomOnClick",void 0),i([n.Property(1)],r.prototype,"zoomFactor",void 0),i([n.Property(10)],r.prototype,"maxZoom",void 0),i([n.Property(1)],r.prototype,"minZoom",void 0),i([n.Property(!1)],r.prototype,"shouldZoomInitially",void 0),i([n.Property(!0)],r.prototype,"resetToInitial",void 0),i([n.Complex({},he)],r.prototype,"toolbarSettings",void 0),r}(n.ChildProperty),ku=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"applyShapeSettings",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:"",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),io=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"useMarkerShape",void 0),i([n.Property(!1)],r.prototype,"toggleVisibility",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("transparent")],r.prototype,"background",void 0),i([n.Property("Layers")],r.prototype,"type",void 0),i([n.Property(!1)],r.prototype,"invertedPointer",void 0),i([n.Property("After")],r.prototype,"labelPosition",void 0),i([n.Property("None")],r.prototype,"labelDisplayMode",void 0),i([n.Property("Circle")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"height",void 0),i([n.Complex({fontFamily:null,fontWeight:null},rt)],r.prototype,"textStyle",void 0),i([n.Property(15)],r.prototype,"shapeWidth",void 0),i([n.Property(15)],r.prototype,"shapeHeight",void 0),i([n.Property(10)],r.prototype,"shapePadding",void 0),i([n.Complex({color:null,width:0},k)],r.prototype,"border",void 0),i([n.Complex({color:"#000000",width:0},k)],r.prototype,"shapeBorder",void 0),i([n.Complex({},nr)],r.prototype,"title",void 0),i([n.Complex({size:null,color:et.legendTitleFont.color,fontStyle:et.legendTitleFont.fontStyle,fontWeight:null,fontFamily:null},rt)],r.prototype,"titleStyle",void 0),i([n.Property("Bottom")],r.prototype,"position",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Property("None")],r.prototype,"orientation",void 0),i([n.Property({x:0,y:0})],r.prototype,"location",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Default")],r.prototype,"mode",void 0),i([n.Property(null)],r.prototype,"showLegendPath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property(!1)],r.prototype,"removeDuplicateLegend",void 0),i([n.Complex({},ku)],r.prototype,"toggleLegendSettings",void 0),r}(n.ChildProperty),ro=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Complex({width:0,color:"transparent"},k)],r.prototype,"border",void 0),i([n.Property("black")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(5)],r.prototype,"rx",void 0),i([n.Property(5)],r.prototype,"ry",void 0),i([n.Complex({fontWeight:null},rt)],r.prototype,"textStyle",void 0),i([n.Property("")],r.prototype,"labelPath",void 0),i([n.Property("None")],r.prototype,"smartLabelMode",void 0),i([n.Property("None")],r.prototype,"intersectionAction",void 0),i([n.Property("")],r.prototype,"template",void 0),i([n.Property(0)],r.prototype,"animationDuration",void 0),r}(n.ChildProperty),uo=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property([])],r.prototype,"palette",void 0),i([n.Property(5)],r.prototype,"circleRadius",void 0),i([n.Complex({width:null,color:null},k)],r.prototype,"border",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"borderColorValuePath",void 0),i([n.Property(null)],r.prototype,"borderWidthValuePath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Collection([],bu)],r.prototype,"colorMapping",void 0),i([n.Property(!1)],r.prototype,"autofill",void 0),r}(n.ChildProperty),du=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return s(t,n),t}(function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),i([n.Property(null)],r.prototype,"dashArray",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(!1)],r.prototype,"enableDrag",void 0),i([n.Property("#FF471A")],r.prototype,"fill",void 0),i([n.Property(null)],r.prototype,"heightValuePath",void 0),i([n.Property(null)],r.prototype,"widthValuePath",void 0),i([n.Property(10)],r.prototype,"height",void 0),i([n.Property(10)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"shapeValuePath",void 0),i([n.Property(null)],r.prototype,"imageUrlValuePath",void 0),i([n.Property("Balloon")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"legendText",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property(null)],r.prototype,"template",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},gi)],r.prototype,"tooltipSettings",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Complex({},gt)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ni)],r.prototype,"highlightSettings",void 0),i([n.Property(null)],r.prototype,"latitudeValuePath",void 0),i([n.Property(null)],r.prototype,"longitudeValuePath",void 0),i([n.Collection([],ye)],r.prototype,"initialMarkerSelection",void 0),i([n.Complex({},wu)],r.prototype,"clusterSettings",void 0),r}(n.ChildProperty)),fo=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.isBaseLayer=!1,n}return s(r,t),i([n.Property(null)],r.prototype,"shapeData",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},uo)],r.prototype,"shapeSettings",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property("Layer")],r.prototype,"type",void 0),i([n.Property("Geographic")],r.prototype,"geometryType",void 0),i([n.Property("")],r.prototype,"urlTemplate",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("name")],r.prototype,"shapeDataPath",void 0),i([n.Property("name")],r.prototype,"shapePropertyPath",void 0),i([n.Property(0)],r.prototype,"animationDuration",void 0),i([n.Collection([],du)],r.prototype,"markerSettings",void 0),i([n.Complex({},wu)],r.prototype,"markerClusterSettings",void 0),i([n.Complex({},ro)],r.prototype,"dataLabelSettings",void 0),i([n.Collection([],de)],r.prototype,"bubbleSettings",void 0),i([n.Collection([],ke)],r.prototype,"navigationLineSettings",void 0),i([n.Complex({},be)],r.prototype,"polygonSettings",void 0),i([n.Complex({},gi)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},gt)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ni)],r.prototype,"highlightSettings",void 0),i([n.Complex({},ku)],r.prototype,"toggleLegendSettings",void 0),i([n.Collection([],pe)],r.prototype,"initialShapeSelection",void 0),r}(n.ChildProperty),eo=function(){return function(n,t,i,r,u,f,e){void 0===i&&(i=256);void 0===r&&(r=256);void 0===u&&(u=0);void 0===f&&(f=0);void 0===e&&(e=null);this.x=n;this.y=t;this.top=u;this.left=f;this.height=i;this.width=r;this.src=e}}(),oo=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return s(r,t),i([n.Property(null)],r.prototype,"background",void 0),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),r}(n.ChildProperty),vt="click",gu="resize",nf="tooltipRender",tf="shapeHighlight",rf="markerRendering",so="markerClusterRendering",uf="markerClick",ff="markerDragStart",ef="markerClusterClick",of="markerMouseMove",sf="markerClusterMouseMove",hf="bubbleRendering",cf="bubbleClick",lf="bubbleMouseMove",af="animationComplete",vf="annotationRendering",yf="itemSelection",pf="itemHighlight",oi="pan",wf=function(){function t(n){this.maps=n}return t.prototype.getBingMap=function(t,i,r,u,f,e){for(var h,c,l,o="",s=Math.min(this.maps.tileZoomLevel,parseInt(this.maxZoom,10));s>0;s--)h=0,c=1<<s-1,0!=(t.x&c)&&h++,0!=(t.y&c)&&(h+=2),o=o+""+h;return n.isNullOrUndefined(e)?"":(l=e[Math.min(parseInt(o.substr(o.length-1,1),10),e.length)],(f=f.replace("{quadkey}",o).replace("{subdomain}",l))+"&mkt="+u+"&ur=IN&Key="+i)},t.prototype.destroy=function(){this.maps=null;this.subDomains=[]},t}(),bf=function(){function t(){}return t.prototype.getShapeColorMapping=function(t,i,r){var u=t.colorValuePath?t.colorValuePath:t.valuePath,f=n.isNullOrUndefined(u)?i[u]:u.indexOf(".")>-1?h(i,u):i[u],o=Number(f),e=this.getColorByValue(t.colorMapping,o,f);return n.isNullOrUndefined(e)?r:e},t.prototype.getColorByValue=function(t,i,r){var u;if(isNaN(i)&&n.isNullOrUndefined(r))return null;for(var o,f="",e=0,s=t;e<s.length;e++)u=s[e],(!n.isNullOrUndefined(u.from)&&!n.isNullOrUndefined(u.to)&&i>=u.from&&i<=u.to||u.value===r)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?n.isNullOrUndefined(u.value)?this.getColor(u,i):u.color[0]:u.color),(i>=u.from&&i<=u.to||u.value===r)&&!n.isNullOrUndefined(u.minOpacity)&&!n.isNullOrUndefined(u.maxOpacity)&&f&&(o=this.deSaturationColor(u,f,i,r)),(""===f||n.isNullOrUndefined(f))&&n.isNullOrUndefined(u.from)&&n.isNullOrUndefined(u.to)&&n.isNullOrUndefined(u.minOpacity)&&n.isNullOrUndefined(u.maxOpacity)&&n.isNullOrUndefined(u.value)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?u.color[0]:u.color);return{fill:f||(t.length?null:r),opacity:o}},t.prototype.deSaturationColor=function(n,t,i,r){var u=1;return(i>=n.from&&i<=n.to||n.value===r)&&(u=(isNaN(i)?n.from/(n.to-n.from):(i-n.from)/(n.to-n.from))*(n.maxOpacity-n.minOpacity)+n.minOpacity),u},t.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},t.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},t.prototype.getColor=function(n,t){var i,r="";return Number(t)===n.from?r=n.color[0]:Number(t)===n.to?r=n.color[n.color.length-1]:(i=this.getGradientColor(Number(t),n),r=this.rgbToHex(i.r,i.g,i.b)),r},t.prototype.getGradientColor=function(n,t){var f,e,s=t.from,c=t.to,o=0,l=c-s,i;if(o=(n-s)/l,t.color.length<=2)f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]),e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);else{f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]);e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);for(var u=l/(t.color.length-1),v=t.color.length-1,r=[],a={},h=1;h<v;h++)a={b:s+h*u,color:t.color[h]},r.push(a);for(i=0;i<r.length;i++)s<=n&&n<=r[i].b&&0===i?(e="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u):r[i].b<=n&&n<=c&&i===r.length-1&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u),i!==r.length-1&&i<r.length&&r[i].b<=n&&n<=r[i+1].b&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),e="#"===r[i+1].color.charAt(0)?r[i+1].color:this._colorNameToHex(r[i+1].color),o=Math.abs(n-r[i+1].b)/u)}return this.getPercentageColor(o,f,e)},t.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new ne(f,e,o)},t.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},t.prototype._colorNameToHex=function(n){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",orchid:"#da70d6",papayawhip:"#ffefd5",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"[object Array]"===Object.prototype.toString.call(n)?n:void 0!==t[n.toLowerCase()]?t[n.toLowerCase()]:n},t}(),ho=function(){function t(t){this.isMapCoordinates=!0;this.horizontalPan=!1;this.horizontalPanXCount=0;this.mapObject=t;this.ajaxModule=new n.Fetch;this.ajaxResponse=[]}return t.prototype.measureLayerPanel=function(){var u=this,e=this.mapObject.layersCollection,t=this.mapObject.mapAreaRect,f=r(this.mapObject.element.id+"_Secondary_Element"),i;this.mapObject.isTileMap&&f&&(this.tileSvgObject=this.mapObject.renderer.createSvg({id:this.mapObject.element.id+"_Tile_SVG",width:t.width,height:t.height}),i=n.createElement("div",{id:this.mapObject.element.id+"_Tile_SVG_Parent"}),i.style.cssText="position: absolute; height: "+t.height+"px; width: "+t.width+"px;",i.appendChild(this.tileSvgObject),f.appendChild(i));this.layerGroup=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_Layer_Collections","clip-path":"url(#"+this.mapObject.element.id+"_MapArea_ClipRect)"});this.clipRectElement=this.mapObject.renderer.drawClipPath(new d(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:this.mapObject.isTileMap?0:t.x,y:this.mapObject.isTileMap?0:t.y,width:t.width,height:t.height}));this.layerGroup.appendChild(this.clipRectElement);this.mapObject.baseMapBounds=null;this.mapObject.baseMapRectBounds=null;this.mapObject.baseSize=null;Array.prototype.forEach.call(e,function(n,t){u.currentLayer=n;u.processLayers(n,t)});n.isNullOrUndefined(this.mapObject.legendModule)||"Float"!==this.mapObject.legendSettings.position||(this.mapObject.isTileMap?this.layerGroup.appendChild(this.mapObject.legendModule.legendGroup):this.mapObject.svgObject.appendChild(this.mapObject.legendModule.legendGroup))},t.prototype.renderTileLayer=function(t,i,r,u){var s,o,e,a,h,c,l;t.currentFactor=t.calculateFactor(i);t.mapObject.defaultState=!(1!==t.mapObject.zoomSettings.zoomFactor&&!n.isNullOrUndefined(t.mapObject.tileZoomLevel)&&1!==t.mapObject.tileZoomLevel);n.isNullOrUndefined(t.mapObject.previousCenterLatitude)&&n.isNullOrUndefined(t.mapObject.previousCenterLongitude)&&!t.mapObject.isZoomByPosition?(t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.previousCenterLatitude!==t.mapObject.centerPosition.latitude&&t.mapObject.previousCenterLongitude!==t.mapObject.centerPosition.longitude||t.mapObject.isZoomByPosition?(t.mapObject.centerPositionChanged=!0,t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.centerPositionChanged=!1;s=new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude);o=s;this.mapObject.isTileMap&&t.mapObject.markerModule&&t.mapObject.zoomSettings.enable&&(t.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection),n.isNullOrUndefined(this.mapObject.markerCenterLatitude)||n.isNullOrUndefined(this.mapObject.markerCenterLongitude)||t.mapObject.isZoomByPosition||(o=new f(t.mapObject.markerCenterLongitude,t.mapObject.markerCenterLatitude)));s=!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.centerPosition.longitude&&t.mapObject.centerPosition.latitude&&!t.mapObject.zoomPersistence&&t.mapObject.defaultState?new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude):t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.markerZoomedState&&!t.mapObject.zoomPersistence&&!n.isNullOrUndefined(t.mapObject.markerZoomCenterPoint)?new f(t.mapObject.markerZoomCenterPoint.longitude,t.mapObject.markerZoomCenterPoint.latitude):{x:null,y:null};e=t.mapObject.zoomSettings.shouldZoomInitially&&!t.mapObject.isZoomByPosition?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?1:t.mapObject.markerZoomFactor:t.mapObject.zoomSettings.zoomFactor;(e=t.mapObject.enablePersistence?n.isNullOrUndefined(t.mapObject.mapScaleValue)?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?t.mapObject.zoomSettings.zoomFactor:t.mapObject.markerZoomFactor:t.mapObject.mapScaleValue:e,e=(e=t.mapObject.zoomSettings.enable?e:t.mapObject.zoomSettings.zoomFactor)>0?e:1,t.mapObject.defaultState=1===e,!t.mapObject.markerZoomedState&&t.mapObject.zoomSettings.shouldZoomInitially&&1===t.mapObject.zoomSettings.zoomFactor&&(t.mapObject.defaultState=!0),n.isNullOrUndefined(t.mapObject.tileZoomLevel))?(t.mapObject.tileZoomLevel=e,t.mapObject.previousZoomFactor=e):this.mapObject.isReset&&1===t.mapObject.tileZoomLevel&&!t.mapObject.zoomSettings.shouldZoomInitially?(a=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=a):1!==t.mapObject.zoomSettings.zoomFactor||t.mapObject.zoomSettings.shouldZoomInitially?(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=t.mapObject.defaultState&&t.mapObject.zoomSettings.enable?t.mapObject.tileZoomLevel:t.mapObject.zoomSettings.shouldZoomInitially||t.mapObject.centerPositionChanged?e:t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor?t.mapObject.zoomSettings.zoomFactor:t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=1===e&&0===t.mapObject.zoomSettings.zoomFactor?e:t.mapObject.tileZoomLevel,!n.isNullOrUndefined(t.mapObject.tileTranslatePoint)&&(t.mapObject.markerZoomFactor!==t.mapObject.mapScaleValue||n.isNullOrUndefined(t.mapObject.markerZoomFactor)&&n.isNullOrUndefined(t.mapObject.mapScaleValue))&&(t.mapObject.zoomSettings.zoomFactor<=1||t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor)&&(t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0)):t.mapObject.defaultState&&(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=e,n.isNullOrUndefined(t.mapObject.tileTranslatePoint)||(t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0));(e<=1&&!n.isNullOrUndefined(t.mapObject.height)&&!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.tileZoomLevel===t.mapObject.tileZoomScale&&this.mapObject.initialCheck&&function(n){n.tileZoomScale=n.tileZoomLevel=Math.floor(n.availableSize.height/512)+1;var t=256*Math.pow(2,n.tileZoomLevel);n.tileTranslatePoint.x=n.availableSize.width/2-t/2;n.tileTranslatePoint.y=n.availableSize.height/2-t/2+20;n.previousTileWidth=n.availableSize.width;n.previousTileHeight=n.availableSize.height}(this.mapObject),n.isNullOrUndefined(t.mapObject.centerLatOfGivenLocation)||n.isNullOrUndefined(t.mapObject.centerLongOfGivenLocation)||!t.mapObject.zoomNotApplied||(n.isNullOrUndefined(o)||(o.y=t.mapObject.centerLatOfGivenLocation,o.x=t.mapObject.centerLongOfGivenLocation),t.mapObject.tileZoomLevel=t.mapObject.mapScaleValue=t.mapObject.scaleOfGivenLocation),t.mapObject.tileTranslatePoint=t.panTileMap(t.mapObject.availableSize.width,t.mapObject.availableSize.height,o),this.mapObject.zoomSettings.resetToInitial&&this.mapObject.initialCheck&&!n.isNullOrUndefined(t.mapObject.height)&&this.mapObject.availableSize.height>512)&&(this.mapObject.applyZoomReset=!0,this.mapObject.initialZoomLevel=Math.floor(this.mapObject.availableSize.height/512),h=256*Math.pow(2,this.mapObject.initialZoomLevel),n.isNullOrUndefined(this.mapObject.initialTileTranslate)||(this.mapObject.initialTileTranslate.x=this.mapObject.availableSize.width/2-h/2,this.mapObject.initialTileTranslate.y=this.mapObject.availableSize.height/2-h/2+20));(t.generateTiles(t.mapObject.tileZoomLevel,t.mapObject.tileTranslatePoint,null,u),n.isNullOrUndefined(t.mapObject.previousZoomFactor)||t.mapObject.previousZoomFactor===t.mapObject.zoomSettings.zoomFactor||(t.mapObject.previousZoomFactor=t.mapObject.zoomSettings.zoomFactor),t.mapObject.polygonModule)&&(c=t.mapObject.polygonModule.polygonRender(this.mapObject,r,t.mapObject.tileZoomLevel),n.isNullOrUndefined(c)||t.layerObject.appendChild(c));t.mapObject.navigationLineModule&&(l=t.mapObject.navigationLineModule.renderNavigation(t.currentLayer,t.mapObject.tileZoomLevel,r),n.isNullOrUndefined(l)||t.layerObject.appendChild(l));t.mapObject.markerModule&&t.mapObject.markerModule.markerRender(this.mapObject,t.layerObject,r,t.mapObject.tileZoomLevel,null);t.translateLayerElements(t.layerObject);t.layerGroup.appendChild(t.layerObject)},t.prototype.processLayers=function(t,i){var r=this,e,u,f;if((this.layerObject=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+i}),!this.mapObject.enablePersistence)&&(e=this.mapObject.getModuleName()+this.mapObject.element.id,-1===navigator.userAgent.indexOf("Edge"))){u=void 0;try{u=window.localStorage}catch(t){u=null}!n.isNullOrUndefined(u)&&window.localStorage.getItem(e)&&window.localStorage.removeItem(e)}f={cancel:!1,name:"layerRendering",index:i,layer:t,maps:this.mapObject,visible:t.visible};this.mapObject.trigger("layerRendering",f,function(){var o,e,u;!f.cancel&&f.visible&&(n.isNullOrUndefined(t.shapeData)&&!n.isNullOrUndefined(t.urlTemplate)&&""!==t.urlTemplate?!n.isNullOrUndefined(t.urlTemplate)&&t.urlTemplate.indexOf("quadkey")>-1?(o=new wf(r.mapObject),r.bingMapCalculation(t,i,r,o)):r.renderTileLayer(r,t,i):n.isNullOrUndefined(t.shapeData)||n.isNullOrUndefined(t.shapeData.geometries)&&n.isNullOrUndefined(t.shapeData.features)||(e=!n.isNullOrUndefined(t.shapeData.geometries)&&t.shapeData.geometries.length>0?t.shapeData.geometries:t.shapeData.features,t.layerData=[],u=t.shapeData.bbox,!n.isNullOrUndefined(u)&&t.isBaseLayer?r.mapObject.baseMapBounds=new vi({min:u[0][1],max:u[1][1]},{min:u[0][0],max:u[1][0]}):n.isNullOrUndefined(r.mapObject.baseMapBounds)&&!dr(e)&&r.calculateRectBounds(e),r.calculatePathCollection(i,e)))});this.mapObject.isTileMap?this.tileSvgObject&&(this.tileSvgObject.appendChild(this.layerGroup),this.mapObject.baseMapBounds=null):this.mapObject.svgObject.appendChild(this.layerGroup)},t.prototype.bingMapCalculation=function(n,t,i,r){r.imageUrl=n.urlTemplate;r.subDomains=["t0","t1","t2","t3"];r.maxZoom="21";i.mapObject.bingMap=r;i.renderTileLayer(i,n,t,r);this.mapObject.arrangeTemplate();this.mapObject.zoomModule&&this.mapObject.previousScale!==this.mapObject.scale&&this.mapObject.zoomModule.applyTransform(this.mapObject,!1,!0)},t.prototype.bubbleCalculation=function(t,i){var f,r,u;if(null!=t.dataSource&&null!=t)for(f=t.dataSource,r=0;r<f.length;r++)u=n.isNullOrUndefined(t.valuePath)?parseFloat(t.dataSource[r][t.valuePath]):t.valuePath.indexOf(".")>-1?Number(h(t.dataSource[r],t.valuePath)):parseFloat(t.dataSource[r][t.valuePath]),isNaN(u)||(0!==r?u>i.max?i.max=u:u<i.min&&(i.min=u):i.max=i.min=u)},t.prototype.calculatePathCollection=function(t,i){var u=this,r,e,o;if(this.groupElements=[],dr(i)||(this.currentFactor=this.calculateFactor(this.currentLayer)),this.rectBounds=null,r=this.currentLayer.shapeSettings,Array.prototype.forEach.call(i,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var i=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,r=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates,f=t.geometry,e=t.properties;u.generatePoints(i,r,f,e)}}),this.currentLayer.rectBounds=this.rectBounds,n.isNullOrUndefined(this.mapObject.baseMapRectBounds)&&this.currentLayer.isBaseLayer&&(this.mapObject.baseMapRectBounds=this.rectBounds),e=!n.isNullOrUndefined(r.palette)&&r.palette.length>1?r.palette:function(n){var t;switch(n.toLowerCase()){case"tailwind":t=["#0369A1","#14B8A6","#15803D","#334155","#5A61F6","#65A30D","#8B5CF6","#9333EA","#F59E0B","#F97316"];break;case"tailwinddark":t=["#10B981","#22D3EE","#2DD4BF","#4ADE80","#8B5CF6","#E879F9","#F472B6","#F87171","#F97316","#FCD34D"];break;case"tailwind3":t=["#2F4074","#03B4B4","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"tailwind3dark":t=["#8029F1","#1ABC9C","#0D72DE","#FF5733","#D63384","#F39C12","#EF291F","#91C822"];break;case"fluent":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;case"fluentdark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;case"material3":t=["#6200EE","#E77A16","#82C100","#7107DC","#05BB3D","#D21020","#FAD200","#0085FF","#9204EA","#08EE9B"];break;case"material3dark":t=["#4EAAFF","#FA4EAB","#FFF500","#17EA58","#38FFE7","#FF9E45","#B3F32F","#B93CE4","#FC5664","#9B55FF"];break;case"fluent2":t=["#6200EE","#09AF74","#0076E5","#CB3587","#E7910F","#0364DE","#66CD15","#F3A93C","#107C10","#C19C00"];break;case"fluent2dark":case"fluent2highcontrast":t=["#9BB449","#2A72D5","#43B786","#3F579A","#584EC6","#E85F9C","#6E7A89","#EA6266","#0B6A0B","#C19C00"];break;case"bootstrap5":case"bootstrap5dark":t=["#6610F2","#6f42C1","#D63384","#DC3545","#FD7E14","#FFC107","#198754","#0DCAF0"];break;default:t=["#B5E485","#7BC1E8","#DF819C","#EC9B79","#78D0D3","#D6D572","#9178E3","#A1E5B4","#87A4B4","#E4C16C"]}return t}(this.mapObject.theme),o=n.createElement("div",{id:this.mapObject.element.id+"_LayerIndex_"+t+"_Label_Template_Group",className:this.mapObject.element.id+"_template"}),o.style.cssText="pointer-events: none; overflow: hidden; position: absolute;top:"+this.mapObject.mapAreaRect.y+"px;left:"+this.mapObject.mapAreaRect.x+"px;height:"+this.mapObject.mapAreaRect.height+"px;width:"+this.mapObject.mapAreaRect.width+"px;",0!==this.currentLayer.layerData.length)for(var c=function(s){var p,nt,w,a=void 0,b={color:r.border.color||f.mapObject.themeStyle.shapeBorderColor,width:r.border.width,opacity:r.border.opacity},c=f.currentLayer.layerData[s],l="",v=r.autofill?e[s%e.length]:r.fill||f.mapObject.themeStyle.shapeFill,k,d;null===r.colorValuePath||n.isNullOrUndefined(c.property)||(null!==(a=ct(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&0===r.colorMapping.length?v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?h(f.currentLayer.dataSource[a],r.colorValuePath):f.currentLayer.dataSource[a][r.colorValuePath]:c.property[r.colorValuePath]&&0===f.currentLayer.dataSource.length&&0===r.colorMapping.length&&(v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?h(c.property,r.colorValuePath):c.property[r.colorValuePath]),v=n.isNullOrUndefined(v)?r.fill||f.mapObject.themeStyle.shapeFill:v);k=f.mapObject.element.id+"_LayerIndex_"+t+"_shapeIndex_"+s+"_dataIndex_"+a;d=f.getShapeColorMapping(f.currentLayer,c.property,v);v="[object Object]"!==Object.prototype.toString.call(d)||n.isNullOrUndefined(d.fill)?v:d.fill;(f.currentLayer.shapeSettings.borderColorValuePath||f.currentLayer.shapeSettings.borderWidthValuePath)&&null!==(a=ct(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&(f.currentLayer.dataSource[a][r.borderColorValuePath]&&(b.color=f.currentLayer.dataSource[a][r.borderColorValuePath]),f.currentLayer.dataSource[a][r.borderWidthValuePath]&&(b.width=f.currentLayer.dataSource[a][r.borderWidthValuePath]));var g="[object Object]"!==Object.prototype.toString.call(d)||n.isNullOrUndefined(d.opacity)?r.opacity:d.opacity,it={cancel:!1,name:"shapeRendering",index:s,data:f.currentLayer.dataSource?f.currentLayer.dataSource[a]:null,maps:f.mapObject,shape:r,fill:v,border:{width:b.width,color:b.color,opacity:b.opacity}},tt=function(f){var a,h=n.isNullOrUndefined(c._isMultiPolygon)?n.isNullOrUndefined(c.type)?c[0].type:c.type:"MultiPolygon",d,tt,it,rt;if(h="Polygon"===h||"MultiPolygon"===h?"Polygon":h,f.cancel?(f.fill=v,f.border.color=r.border.color||u.mapObject.themeStyle.shapeBorderColor,f.border.width=r.border.width):(f.fill="#A6A6A6"===f.fill?f.shape.fill||u.mapObject.themeStyle.shapeFill:f.fill,f.border.color="transparent"===f.border.color?f.shape.border.color:f.border.color,f.border.width=0===f.border.width?f.shape.border.width:f.border.width,n.isNullOrUndefined(r.borderColorValuePath)&&(b.color=f.border.color),n.isNullOrUndefined(r.borderWidthValuePath)&&(b.width=f.border.width)),f.border.opacity=n.isNullOrUndefined(f.border.opacity)?g:f.border.opacity,u.groupElements.length<1)w=u.mapObject.renderer.createGroup({id:u.mapObject.element.id+"_LayerIndex_"+t+"_"+h+"_Group",transform:""}),u.groupElements.push(w);else for(d=0;d<u.groupElements.length;d++){if(tt=u.groupElements[d],tt.id.indexOf(h)>-1){w=tt;break}if(d>=u.groupElements.length-1){w=u.mapObject.renderer.createGroup({id:u.mapObject.element.id+"_LayerIndex_"+t+"_"+h+"_Group"});u.groupElements.push(w);break}}switch(h){case"Polygon":c._isMultiPolygon?l=u.generateMultiPolygonPath(c):(l+="M"+c[0].point.x+" "+c[0].point.y,c.map(function(n){l+=" L "+n.point.x+" "+n.point.y}));(l+=" z ").length>3&&(p=new y(k,f.fill,f.border.width,f.border.color,g,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"LineString":c.map(function(n,t){l+=0===t?"M "+n.point.x+" "+n.point.y:"L"+n.point.x+" , "+n.point.y+" "});l.length>3&&(p=new y(k,"transparent",n.isNullOrUndefined(f.border.width)?1:f.border.width,n.isNullOrUndefined(f.fill)?f.border.color:f.fill,g,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"MultiLineString":c.map(function(n){n.map(function(n,t){l+=0===t?"M "+n.point.x+" "+n.point.y:"L"+n.point.x+" , "+n.point.y+" "})});l.length>3&&(p=new y(k,"transparent",n.isNullOrUndefined(f.border.width)?1:f.border.width,n.isNullOrUndefined(f.fill)?f.border.color:f.fill,g,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"Point":it=c.point;rt="SubLayer"!==u.mapObject.layers[t].type?r.circleRadius:r.circleRadius/(u.mapObject.isTileMap?u.mapObject.scale:u.currentFactor);nt=new yt(k,f.fill,f.border,g,it.x,it.y,rt,r.dashArray);a=u.mapObject.renderer.drawCircle(nt);break;case"MultiPoint":c.map(function(n,i){var e=n.point,o="SubLayer"!==u.mapObject.layers[t].type?r.circleRadius:r.circleRadius/(u.mapObject.isTileMap?u.mapObject.scale:u.currentFactor);nt=new yt(k+"_multiLine_"+i,f.fill,f.border,g,e.x,e.y,o,r.dashArray);a=u.mapObject.renderer.drawCircle(nt);u.pathAttributeCalculate(w,a,h,c)});break;case"Path":l=c.point;p=new y(k,f.fill,f.border.width,f.border.color,g,f.border.opacity,r.dashArray,l);a=u.mapObject.renderer.drawPath(p)}n.isNullOrUndefined(a)||"MultiPoint"===h||u.pathAttributeCalculate(w,a,h,c);s===u.currentLayer.layerData.length-1&&u.layerFeatures(t,e,i,o)};tt.bind(f);f.mapObject.trigger("shapeRendering",it,tt)},f=this,s=0;s<this.currentLayer.layerData.length;s++)c(s);else this.layerFeatures(t,e,i,o)},t.prototype.pathAttributeCalculate=function(t,i,r,u){for(var e,o="[object Array]"===Object.prototype.toString.call(this.currentLayer.shapePropertyPath)?this.currentLayer.shapePropertyPath:[this.currentLayer.shapePropertyPath],f=0;f<o.length;f++)if(!n.isNullOrUndefined(u.property)){e=o[f];break}i.setAttribute("aria-label",n.isNullOrUndefined(u.property)?"":u.property[e]);this.currentLayer.selectionSettings.enable||this.currentLayer.highlightSettings.enable?(i.tabIndex=this.mapObject.tabIndex,i.setAttribute("role","button"),i.style.cursor=this.currentLayer.highlightSettings.enable&&!this.currentLayer.selectionSettings.enable?"default":"pointer"):i.setAttribute("role","region");"LineString"!==r&&"MultiLineString"!==r||(i.style.cssText="outline:none");ri(this.mapObject.selectedElementId,this.mapObject.shapeSelectionClass,i,"ShapeselectionMapStyle");this.mapObject.legendSettings.toggleLegendSettings.enable&&"Layers"===this.mapObject.legendSettings.type&&br(this.mapObject.toggledElementId,i,this.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings?this.currentLayer.shapeSettings:this.mapObject.legendSettings.toggleLegendSettings);t.appendChild(i)},t.prototype.layerFeatures=function(t,i,r,u){var h,e=this,s,l;if(this.mapObject.polygonModule&&this.groupElements.push(this.mapObject.polygonModule.polygonRender(this.mapObject,t,this.mapObject.isTileMap?Math.floor(this.currentFactor):this.currentFactor)),this.currentLayer.bubbleSettings.length&&this.mapObject.bubbleModule)for(var o,a=this.currentLayer.bubbleSettings.length,v=function(r){var s,u;o=f.currentLayer.bubbleSettings[r];h=f.mapObject.renderer.createGroup({id:f.mapObject.element.id+"_LayerIndex_"+t+"_bubble_Group_"+r});s={min:0,max:0};f.bubbleCalculation(o,s);u=o.dataSource;f.mapObject.bubbleModule.bubbleCollection=[];!n.isNullOrUndefined(u)&&u.length>0&&(u.map(function(n,u){e.renderBubble(e.currentLayer,n,i[u%i.length],s,r,u,h,t,o)}),f.groupElements.push(h))},f=this,c=0;c<a;c++)v(c);this.mapObject.markerModule&&!this.mapObject.isTileMap&&this.mapObject.zoomSettings.enable&&this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);s=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+t+"_dataLableIndex_Group"});(s.style.pointerEvents="none",this.mapObject.dataLabelModule&&this.currentLayer.dataLabelSettings.visible)&&(l=[],Array.prototype.forEach.call(r,function(n,i){e.renderLabel(e.currentLayer,t,n,s,i,u,l)}),this.groupElements.push(s));this.mapObject.navigationLineModule&&this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer,this.currentFactor,t));n.isNullOrUndefined(this.groupElements)||n.isNullOrUndefined(this.layerObject)||this.groupElements.map(function(t){n.isNullOrUndefined(t)||e.layerObject.appendChild(t)});this.mapObject.markerModule&&this.mapObject.markerModule.markerRender(this.mapObject,this.layerObject,t,this.mapObject.isTileMap?Math.floor(this.currentFactor):this.currentFactor,null);this.translateLayerElements(this.layerObject);this.layerGroup.appendChild(this.layerObject)},t.prototype.renderLabel=function(n,t,i,r,u,f,e){this.mapObject.dataLabelModule.renderLabel(n,t,i,n.layerData,r,f,u,e)},t.prototype.generateMultiPolygonPath=function(n){for(var i="",t=0;t<n.length;t++)i+="M"+n[t][0].point.x+" "+n[t][0].point.y,n[t].map(function(n){i+=" L "+n.point.x+" "+n.point.y});return i},t.prototype.renderBubble=function(t,i,r,u,f,e,o,s,h){if(n.isNullOrUndefined(this.mapObject.bubbleModule)||!h.visible)return null;r=h.fill?h.fill:r;this.mapObject.bubbleModule.id=this.mapObject.element.id+"_LayerIndex_"+s+"_BubbleIndex_"+f+"_dataIndex_"+e;this.mapObject.bubbleModule.renderBubble(h,i,r,u,f,e,s,t,o,this.mapObject.bubbleModule.id)},t.prototype.getShapeColorMapping=function(t,i,r){if(r=r||t.shapeSettings.fill,0===t.shapeSettings.colorMapping.length&&n.isNullOrUndefined(t.dataSource))return r;var u=ct(t.dataSource,i,t.shapeDataPath,t.shapePropertyPath),f=new bf(this.mapObject);return n.isNullOrUndefined(t.dataSource)||n.isNullOrUndefined(t.dataSource[u])?r:f.getShapeColorMapping(t.shapeSettings,t.dataSource[u],r)},t.prototype.generatePoints=function(t,i,r,u){var e,o,s=this,f=[],h,c,a,p,w,l,b,y,k;switch(t.toLowerCase()){case"polygon":(f=this.calculatePolygonBox(i[0])).length>0&&(f.property=u,f.type=t,f._isMultiPolygon=!1,this.currentLayer.layerData.push(f));break;case"multipolygon":for(h=[],c=0;c<i.length;c++)for(a=0;a<i[c].length;a++)(f=this.calculatePolygonBox(i[c][a])).length>0&&h.push(f);h.property=u;h.type=t;h._isMultiPolygon=!0;this.currentLayer.layerData.push(h);break;case"linestring":p=n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width;i.map(function(n){e=n[1];o=n[0];var t=v(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,p);f.push({point:t,lat:e,lng:o})});f.property=u;f.type=t;this.currentLayer.layerData.push(f);break;case"multilinestring":w=n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width;l=[];i.map(function(n){f=[];n.map(function(n){e=n[1];o=n[0];var t=v(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,w);f.push({point:t,lat:e,lng:o})});l.push(f)});l.property=u;l.type=t;this.currentLayer.layerData.push(l);break;case"point":b=(n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width)+2*this.currentLayer.shapeSettings.circleRadius;e=i[1];o=i[0];y=v(e,o,this.currentFactor,this.currentLayer,this.mapObject);this.calculateBox(y,b);this.currentLayer.layerData.push({point:y,type:t,lat:e,lng:o,property:u});break;case"multipoint":k=(n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width)+2*this.currentLayer.shapeSettings.circleRadius;f=[];i.map(function(n){e=n[1];o=n[0];var t=v(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,k);f.push({point:t,lat:e,lng:o})});f.property=u;f.type=t;this.currentLayer.layerData.push(f);break;case"path":this.currentLayer.layerData.push({point:r.d,type:t,property:u})}},t.prototype.calculateBox=function(t,i){n.isNullOrUndefined(this.rectBounds)?this.rectBounds={min:{x:t.x-i,y:t.y-i},max:{x:t.x+i,y:t.y+i}}:(this.rectBounds.min.x=Math.min(this.rectBounds.min.x,t.x-i),this.rectBounds.min.y=Math.min(this.rectBounds.min.y,t.y-i),this.rectBounds.max.x=Math.max(this.rectBounds.max.x,t.x+i),this.rectBounds.max.y=Math.max(this.rectBounds.max.y,t.y+i))},t.prototype.calculateFactor=function(n){var o,i,r,s,u=this.mapObject.baseMapBounds,t=new w(this.mapObject.mapAreaRect.width,this.mapObject.mapAreaRect.height-5),f,e;return u?(f=v(u.latitude.min,u.longitude.min,null,n,this.mapObject),e=v(u.latitude.max,u.longitude.max,null,n,this.mapObject),i=e.y-f.y,r=e.x-f.x,0!==i&&0!==r||(r=t.width/2,i=t.height)):i=r=500,o=i<t.height?parseFloat(Math.abs(100*Number(t.height/Number(i.toString()+"e+1"))).toString().split(".")[0])/10:t.height/i,s=r<t.width?parseFloat(Math.abs(100*Number(t.width/Number(r.toString()+"e+1"))).toString().split(".")[0])/10:t.width/r,Math.min(s,o)},t.prototype.translateLayerElements=function(t){var i,u,s,h,r,c,f,e,o;if(this.mapObject.translateType="layer",n.isNullOrUndefined(this.mapObject.baseMapRectBounds)){if(this.mapObject.isTileMap&&!n.isNullOrUndefined(this.mapObject.scale))for(u=0;u<t.childElementCount;u++)(i=t.childNodes[u]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||i.id.indexOf("_line_Group")>-1||-1!==i.id.indexOf("_Polygons_Group")||(o="scale( "+this.mapObject.scale+" ) translate( "+this.mapObject.translatePoint.x+" "+this.mapObject.translatePoint.y+" ) ",i.setAttribute("transform",o))}else for(s="Disable"===n.animationMode?0:0===this.currentLayer.animationDuration&&"Enable"===n.animationMode?1e3:this.currentLayer.animationDuration,h=0!==s||n.isNullOrUndefined(this.mapObject.zoomModule),this.mapObject.baseTranslatePoint=this.mapObject.zoomTranslatePoint,r=void 0,r=this.mapObject.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.mapObject.zoomModule)?bt(this.mapObject,this.currentLayer,h):ut(this.mapObject,this.currentLayer,h),c=this.mapObject.previousScale=r.scale,f=this.mapObject.previousPoint=r.location,this.mapObject.baseTranslatePoint=this.mapObject.translatePoint=f,this.mapObject.baseScale=this.mapObject.scale=c,e=0;e<t.childElementCount;e++)(i=t.childNodes[e]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||(o="scale( "+c+" ) translate( "+f.x+" "+f.y+" ) ",i.setAttribute("transform",o),s>0&&!n.isNullOrUndefined(this.mapObject.zoomModule)&&(r=this.mapObject.zoomSettings.zoomFactor>1?bt(this.mapObject,this.currentLayer):ut(this.mapObject,this.currentLayer),this.mapObject.scale=r.scale,this.mapObject.zoomTranslatePoint=this.mapObject.translatePoint=r.location))},t.prototype.calculateRectBounds=function(t){var i=this;Array.prototype.forEach.call(t,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var u=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,r=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates;switch(u.toLowerCase()){case"polygon":i.calculateRectBox(r[0]);break;case"multipolygon":r.map(function(n){i.calculateRectBox(n[0])});break;case"multilinestring":r.map(function(n){n.map(function(n,t){i.calculateRectBox(n,"multilinestring",0===t)})});break;case"linestring":r.map(function(n,t){i.calculateRectBox(n,"linestring",0===t)});break;case"point":i.calculateRectBox(r,"point");break;case"multipoint":r.map(function(n,t){i.calculateRectBox(n,"multipoint",0===t)})}}})},t.prototype.calculatePolygonBox=function(t){var i=this,u=[],r=this.mapObject.baseMapBounds;return t.map(function(t){var e=t[1],o=t[0],f;o>=r.longitude.min&&o<=r.longitude.max&&e>=r.latitude.min&&e<=r.latitude.max&&(f=v(e,o,i.currentFactor,i.currentLayer,i.mapObject),n.isNullOrUndefined(i.rectBounds)?i.rectBounds={min:{x:f.x,y:f.y},max:{x:f.x,y:f.y}}:(i.rectBounds.min.x=Math.min(i.rectBounds.min.x,f.x),i.rectBounds.min.y=Math.min(i.rectBounds.min.y,f.y),i.rectBounds.max.x=Math.max(i.rectBounds.max.x,f.x),i.rectBounds.max.y=Math.max(i.rectBounds.max.y,f.y)),u.push({point:f,lat:e,lng:o}))}),u},t.prototype.calculateRectBox=function(t,i,r){var u=this;"linestring"!==i&&"multilinestring"!==i&&"point"!==i&&"multipoint"!==i?Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(u.mapObject.baseMapBounds)?u.mapObject.baseMapBounds=new vi({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(u.mapObject.baseMapBounds.latitude.min=Math.min(u.mapObject.baseMapBounds.latitude.min,t[1]),u.mapObject.baseMapBounds.latitude.max=Math.max(u.mapObject.baseMapBounds.latitude.max,t[1]),u.mapObject.baseMapBounds.longitude.min=Math.min(u.mapObject.baseMapBounds.longitude.min,t[0]),u.mapObject.baseMapBounds.longitude.max=Math.max(u.mapObject.baseMapBounds.longitude.max,t[0]))}):(r||"point"===i)&&n.isNullOrUndefined(this.mapObject.baseMapBounds)?this.mapObject.baseMapBounds=new vi({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(this.mapObject.baseMapBounds.latitude.min=Math.min(this.mapObject.baseMapBounds.latitude.min,t[1]),this.mapObject.baseMapBounds.latitude.max=Math.max(this.mapObject.baseMapBounds.latitude.max,t[1]),this.mapObject.baseMapBounds.longitude.min=Math.min(this.mapObject.baseMapBounds.longitude.min,t[0]),this.mapObject.baseMapBounds.longitude.max=Math.max(this.mapObject.baseMapBounds.longitude.max,t[0]))},t.prototype.generateTiles=function(t,i,r,u,f){var e,a,rt=this.mapObject.locale,h=this.mapObject.availableSize,p,w,v,c,l,b,k,d,o,s,g,it,nt,y;this.tiles=[];e=a=Math.pow(2,t);p=0;w=0;i.x+256*e<h.width&&(p=i.x>0?Math.ceil(i.x/256):0,w=i.x+256*e<h.width?Math.ceil((h.width-(i.x+256*e))/256):0);e+=p+w;"Pan"===r?(e=this.horizontalPanXCount>=e?this.horizontalPanXCount:e,this.horizontalPan=!1):(this.horizontalPanXCount=e,this.horizontalPan=!0);v=this.mapObject.layers[this.mapObject.baseLayerIndex];this.urlTemplate=v.urlTemplate;var ft=Math.min(a,(-i.y+h.height)/256+1),et=Math.min(e,(-i.x+h.width+256*w)/256+1),ot=-(i.x+256*p+256)/256,st=-(i.y+256)/256;for(u=u||this.bing||this.mapObject.bingMap,c=Math.round(ot);c<Math.round(et);c++)for(l=Math.round(st);l<Math.round(ft);l++)b=256*c+i.x,k=256*l+i.y,b>-256&&b<=h.width&&k>-256&&k<h.height&&l>=0&&(d=c,c<0&&(d=d%a+a),o=new eo(d%a,l),o.left=Math.round(b),o.top=Math.round(k),u&&!n.isNullOrUndefined(v.urlTemplate)&&""!==v.urlTemplate&&v.urlTemplate.indexOf("quadkey")>-1?o.src=u.getBingMap(o,"","",rt,u.imageUrl,u.subDomains):(u=null,o.src=this.urlTemplate.replace("level",t.toString()).replace("tileX",o.x.toString()).replace("tileY",o.y.toString())),this.tiles.push(o));n.isNullOrUndefined(r)||(r.indexOf("wheel")>1?(this.animateToZoomX=this.mapObject.availableSize.width/2-f.x-10,this.animateToZoomY=-f.y):(this.animateToZoomX=-10,this.animateToZoomY=10-(this.mapObject.availableSize.height/2+11.5)));for(var ht=n.extend([],this.tiles,[],!0),tt=0,ut=this.mapObject.layers;tt<ut.length;tt++)if(s=ut[tt],"SubLayer"===s.type&&s.visible&&n.isNullOrUndefined(s.shapeData)&&!n.isNullOrUndefined(s.urlTemplate)&&""!==s.urlTemplate)for(g=0,it=ht;g<it.length;g++)nt=it[g],y=n.extend({},nt,{},!0),s.urlTemplate.indexOf("quadkey")?(u=new wf(this.mapObject),y.src=u.getBingMap(y,"","",rt,u.imageUrl,u.subDomains)):y.src=s.urlTemplate.replace("level",t.toString()).replace("tileX",nt.x.toString()).replace("tileY",nt.y.toString()),this.tiles.push(y);(this.mapObject.previousScale!==this.mapObject.scale||this.mapObject.isReset||this.mapObject.isZoomByPosition||this.mapObject.zoomNotApplied)&&this.arrangeTiles(r,this.animateToZoomX,this.animateToZoomY)},t.prototype.arrangeTiles=function(t,i,r){var o,u=this,f=document.getElementById(this.mapObject.element.id+"_tile_parent"),e=document.getElementById(this.mapObject.element.id+"_tiles");n.isNullOrUndefined(t)||"Pan"===t?o=0:(this.tileAnimation(t,i,r),o="Disable"===n.animationMode?0:0===this.mapObject.layersCollection[0].animationDuration&&"Enable"===n.animationMode?1e3:this.mapObject.layersCollection[0].animationDuration);setTimeout(function(){var o,h,i,a,l,v,y;for(f&&(f.style.zIndex="1"),e&&(e.style.zIndex="0"),!document.getElementById(u.mapObject.element.id+"_animated_tiles")&&f?(o=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(o)):"Pan"!==t&&e&&f?(e.appendChild(f.children[0]),u.mapObject.isAddLayer||n.isNullOrUndefined(document.getElementById(u.mapObject.element.id+"_animated_tiles"))||(document.getElementById(u.mapObject.element.id+"_animated_tiles").id=u.mapObject.element.id+"_animated_tiles_old"),o=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(o)):o=f?f.children[0]:null,h=0;h<u.tiles.length;h++){var s=u.tiles[h],r=null,p=u.mapObject.element.id;"Pan"===t?(i=document.getElementById(p+"_tile_"+h),a=!1,n.isNullOrUndefined(i)?(a=!0,i=n.createElement("div",{id:p+"_tile_"+h}),r=n.createElement("img")):(i.style.removeProperty("display"),r=i.children[0]),!a&&r&&r.src!==s.src&&(r.src=s.src),i.style.position="absolute",i.style.left=s.left+"px",i.style.top=s.top+"px",i.style.height=s.height+"px",i.style.width=s.width+"px",a&&(r.setAttribute("height","256px"),r.setAttribute("width","256px"),r.setAttribute("src",s.src),r.setAttribute("alt",u.mapObject.getLocalizedLabel("ImageNotFound")),r.style.setProperty("user-select","none"),i.appendChild(r),o.appendChild(i))):((r=n.createElement("img")).setAttribute("height","256px"),r.setAttribute("width","256px"),r.setAttribute("src",s.src),r.style.setProperty("user-select","none"),r.setAttribute("alt",u.mapObject.getLocalizedLabel("ImageNotFound")),(i=n.createElement("div",{id:p+"_tile_"+h})).style.position="absolute",i.style.left=s.left+"px",i.style.top=s.top+"px",i.style.height=s.height+"px",i.style.width=s.width+"px",i.appendChild(r),o&&o.appendChild(i));h===u.tiles.length-1&&document.getElementById(u.mapObject.element.id+"_animated_tiles_old")&&c(u.mapObject.element.id+"_animated_tiles_old")}if(!n.isNullOrUndefined(u.mapObject.currentTiles))for(l=u.tiles.length;l<o.childElementCount;l++){for(v=!1,y=0;y<u.mapObject.currentTiles.childElementCount;y++)v||u.mapObject.currentTiles.children[y].id!==o.children[l].id||(v=!0);v?o.children[l].style.display="none":o.removeChild(o.children[l])}},o)},t.prototype.tileAnimation=function(t,i,r){var o=document.getElementById(this.mapObject.element.id+"_tile_parent"),f=document.getElementById(this.mapObject.element.id+"_animated_tiles"),u=document.getElementById(this.mapObject.element.id+"_tiles"),e="2";if(0===t.indexOf("ZoomOut")||"Reset"===t){for(u.style.zIndex="1",o.style.zIndex="0";u.childElementCount>=1;)u.removeChild(u.children[0]);i=0;r=document.getElementById(this.mapObject.element.id+"_tile_parent").getClientRects()[0].height/4;e=0===t.indexOf("ZoomOut")?"0.5":"0.2"}n.isNullOrUndefined(f)||(f.style.transition="Disable"===n.animationMode?"0ms":0===this.mapObject.layersCollection[0].animationDuration&&"Enable"===n.animationMode?"1000ms":this.mapObject.layersCollection[0].animationDuration+"ms",f.style.transform="translate("+i+"px, "+r+"px) scale("+e+")")},t.prototype.panTileMap=function(t,i,r){var l,a;this.mapObject.tileZoomLevel<=this.mapObject.tileZoomScale&&this.mapObject.initialCheck&&(this.mapObject.tileZoomLevel=this.mapObject.tileZoomScale);var e,u,o=this.mapObject.tileZoomLevel,s=20,h=256*Math.pow(2,o),c=it(r,o,{x:e=t/2-h/2,y:u=i/2-h/2},this.isMapCoordinates);return(s=this.mapObject.zoomNotApplied?0:s,e-=c.x-t/2,u=u-(c.y-i/2)+s,this.mapObject.scale=Math.pow(2,o-1),(n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||0===this.mapObject.tileTranslatePoint.y&&0===this.mapObject.tileTranslatePoint.x||n.isNullOrUndefined(this.mapObject.previousTileWidth)||n.isNullOrUndefined(this.mapObject.previousTileHeight))&&(this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||!n.isNullOrUndefined(r.x)||1!==this.mapObject.zoomSettings.zoomFactor&&this.mapObject.zoomSettings.zoomFactor===o&&this.mapObject.defaultState||t===this.mapObject.previousTileWidth&&i===this.mapObject.previousTileHeight)||(l=e-(this.mapObject.previousTileWidth/2-h/2),a=u-(this.mapObject.previousTileHeight/2-h/2+s),this.mapObject.tileTranslatePoint.x=this.mapObject.tileTranslatePoint.x+l,this.mapObject.tileTranslatePoint.y=this.mapObject.tileTranslatePoint.y+a),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||this.mapObject.zoomNotApplied||(0===this.mapObject.tileTranslatePoint.x||this.mapObject.tileTranslatePoint.x===e||this.mapObject.centerPositionChanged||(e=this.mapObject.tileTranslatePoint.x),0===this.mapObject.tileTranslatePoint.y||this.mapObject.tileTranslatePoint.y===u||this.mapObject.centerPositionChanged||(u=this.mapObject.tileTranslatePoint.y)),this.mapObject.translatePoint=new f((e-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale,(u-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale),this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i,new f(e,u)},t.prototype.destroy=function(){this.mapObject=null;this.groupElements=[];this.layerObject=null;this.currentLayer=null;this.rectBounds=null;this.tiles=[];this.clipRectElement=null;this.tileSvgObject=null;this.ajaxModule=null;this.ajaxResponse=[];this.layerGroup=null;n.isNullOrUndefined(this.bing)||this.bing.destroy();this.bing=null},t}(),kf=function(){function t(n){this.map=n}return t.prototype.renderAnnotationElements=function(){var u=this,i=this.map.element.id+"_Secondary_Element",t=n.createElement("div",{id:this.map.element.id+"_Annotations_Group"});t.style.position="absolute";t.style.top="0px";t.style.left="0px";this.map.annotations.map(function(n,i){null!==n.content&&u.createAnnotationTemplate(t,n,i)});t.childElementCount>0&&!n.isNullOrUndefined(r(i))&&r(i).appendChild(t);this.map.renderReactTemplates()},t.prototype.createAnnotationTemplate=function(t,i,r){var u,f,y,k,e=this,c=this.map,d=c.availableSize,o=n.createElement("div",{id:c.element.id+"_Annotation_"+r}),s;o.style.cssText="position: absolute; z-index:"+i.zIndex+";";s={cancel:!1,name:vf,content:i.content,annotation:i};this.map.trigger(vf,s,function(){if(!s.cancel)if((y=ei(s.content,e.map))&&y(e.map,e.map,s.content,e.map.element.id+"_ContentTemplate_"+r).length)for(var i=(k=Array.prototype.slice.call(y(e.map,e.map,s.content,e.map.element.id+"_ContentTemplate_"+r))).length,t=0;t<i;t++)o.appendChild(k[t]);else o.appendChild(n.createElement("div",{innerHTML:s.content}))});var l=function(n,t){t.appendChild(n);var i=n.offsetWidth,r=n.offsetHeight;return t.removeChild(n),new w(i,r)}(o.cloneNode(!0),c.element),g=c.element.getBoundingClientRect(),h=c.svgObject.getBoundingClientRect();u=Math.abs(h.left-g.left);f=Math.abs(h.top-g.top);var p=n.isNullOrUndefined(i.x)?"0%":i.x,b=n.isNullOrUndefined(i.y)?"0%":i.y,a=p.indexOf("%")>-1?d.width/100*parseFloat(p):parseFloat(p),v=b.indexOf("%")>-1?d.height/100*parseFloat(b):parseFloat(b);switch(u="None"===i.horizontalAlignment?u+a:u,f="None"===i.verticalAlignment?f+v:f,i.verticalAlignment){case"Near":f+=v;break;case"Center":f=f+v+(h.height/2-l.height/2);break;case"Far":f=f+h.height+v-l.height}switch(i.horizontalAlignment){case"Near":u+=a;break;case"Center":u=u+a+(h.width/2-l.width/2);break;case"Far":u=u+h.width+a-l.width}o.style.left=u+"px";o.style.top=f+"px";t.appendChild(o)},t.prototype.getModuleName=function(){return"Annotations"},t.prototype.destroy=function(){this.map=null},t}();const nt=ejdashboard.data;var co=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},df=function(t){function i(i,r){var u=t.call(this,i,r)||this;return u.isTileMap=!1,u.isResize=!1,u.isReset=!1,u.baseSize=new w(0,0),u.translatePoint=new f(0,0),u.baseTranslatePoint=new f(0,0),u.zoomTranslatePoint=new f(0,0),u.markerZoomedState=!0,u.zoomPersistence=!1,u.defaultState=!0,u.centerPositionChanged=!1,u.markerNullCount=0,u.tileTranslatePoint=new f(0,0),u.baseTileTranslatePoint=new f(0,0),u.isDevice=!1,u.staticMapZoom=u.zoomSettings.enable?u.zoomSettings.zoomFactor:0,u.zoomNotApplied=!1,u.dataLabelShape=[],u.zoomShapeCollection=[],u.zoomLabelPositions=[],u.mouseDownEvent={x:null,y:null},u.mouseClickEvent={x:null,y:null},u.selectedElementId=[],u.selectedMarkerElementId=[],u.selectedBubbleElementId=[],u.selectedNavigationElementId=[],u.selectedPolygonElementId=[],u.selectedLegendElementId=[],u.legendSelectionCollection=[],u.shapeSelections=!0,u.legendSelection=!0,u.toggledLegendId=[],u.toggledElementId=[],u.checkInitialRender=!0,u.initialTileTranslate=new f(0,0),u.isMarkerZoomCompleted=!1,u.markerDragId="",u.initialCheck=!0,u.applyZoomReset=!1,u.markerClusterExpandCheck=!1,u.markerClusterExpand=!1,u.mouseMoveId="",u.shapeSelectionItem=[],u.markerDragArgument=null,n.setValue("mergePersistData",u.mergePersistMapsData,u),u}return co(i,t),Object.defineProperty(i.prototype,"isShapeSelected",{get:function(){return this.mapSelect},enumerable:!0,configurable:!0}),i.prototype.mergePersistMapsData=function(){var i,f,r,o,u,e,t;try{f=window.localStorage}catch(i){f=null}if(n.isNullOrUndefined(f)||(i=window.localStorage.getItem(this.getModuleName()+this.element.id)),!n.isNullOrUndefined(i)&&""!==i){for(r=JSON.parse(i),o=Object.keys(r),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)t=e[u],"object"!=typeof this[t]||n.isNullOrUndefined(this[t])?this[t]=r[t]:n.extend(this[t],r[t]);this.isProtectedOnChange=!1}},i.prototype.getLocalizedLabel=function(n){return this.localeObject.getConstant(n)},i.prototype.preRender=function(){this.isDevice=n.Browser.isDevice;this.initPrivateVariable();this.allowServerDataBinding=!1;this.unWireEVents();this.wireEVents();this.setCulture()},i.prototype.renderElements=function(){this.isDestroyed||(this.trigger("load",{maps:this}),this.createSVG(),this.findBaseAndSubLayers(),!n.isNullOrUndefined(this.markerModule)&&this.markerModule.getMapsInstance()&&this.markerModule.initializeMarkerClusterList(),this.createSecondaryElement(),this.addTabIndex(),this.themeStyle=function(n){var t,i;switch(n.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(n.toLowerCase()){case"materialdark":case"fabricdark":case"bootstrapdark":t={backgroundColor:i,areaBackgroundColor:i,titleFontColor:"#FFFFFF",titleFontSize:"14px",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#DADADA",legendTextColor:"#DADADA",dataLabelFontColor:"#DADADA",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",zoomFillColor:"#FFFFFF",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",legendFontSize:"12px",fontWeight:"Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"highcontrast":t={backgroundColor:"#000000",areaBackgroundColor:"#000000",titleFontColor:"#FFFFFF",titleFontSize:"14px",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#000000",tooltipFontColor:"#000000",tooltipFillColor:"#ffffff",zoomFillColor:"#FFFFFF",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",legendFontSize:"12px",fontWeight:"Medium",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#5B6269",fontFamily:"HelveticaNeue-Medium",fontSize:"12px",fontWeight:"Medium",titleFontSize:"16px",legendFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"HelveticaNeue-Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"tailwind":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#374151",subTitleFontColor:"#374151",legendTitleFontColor:"#374151",legendTextColor:"#6B7280",dataLabelFontColor:"#505967",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#111827",zoomFillColor:"#6b7280",fontFamily:"Inter",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#374151",shapeFill:"#E5E7EB",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"tailwinddark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#D1D5DB",subTitleFontColor:"#D1D5DB",legendTitleFontColor:"#D1D5DB",legendTextColor:"#D1D5DB",dataLabelFontColor:"#D1D5DB",tooltipFontColor:"#1F2937",tooltipFillColor:"#F9FAFB",zoomFillColor:"#D1D5DB",fontFamily:"Inter",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#F3F4F6",shapeFill:"#374151",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"tailwind3":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#111827",subTitleFontColor:"#111827",legendTitleFontColor:"#111827",legendTextColor:"#6B7280",dataLabelFontColor:"#111827",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#111827",zoomFillColor:"#374151",fontFamily:"Inter",fontSize:"12px",fontWeight:"400",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#6B7280",shapeFill:"#F3F4F6",shapeBorderColor:"#E5E7EB",rectangleZoomFillColor:"#818CF8",rectangleZoomFillOpacity:.3,rectangleZoomBorderColor:"#4F46E5",legendBorderColor:"#E5E7EB",legendBorderWidth:0,tooltipBorderColor:"#111827",zoomButtonRadius:32};break;case"tailwind3dark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#9CA3AF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#1F2937",tooltipFillColor:"#F9FAFB",zoomFillColor:"#D1D5DB",fontFamily:"Inter",fontSize:"12px",fontWeight:"400",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Inter",titleFontWeight:"600",zoomSelectionColor:"#9CA3AF",shapeFill:"#282F3C",shapeBorderColor:"#282F3C",rectangleZoomFillColor:"#3730A3",rectangleZoomFillOpacity:.3,rectangleZoomBorderColor:"#6366F1",legendBorderColor:"#282F3C",legendBorderWidth:0,tooltipBorderColor:"#F9FAFB",zoomButtonRadius:30};break;case"bootstrap5":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#6E757D",fontFamily:"Segoe UI",fontSize:"10px",fontWeight:"400",titleFontSize:"14px",subTitleFontSize:"12px",legendFontSize:"10px",tooltipFillOpacity:.9,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"400",zoomSelectionColor:"#212529",zoomBorderColor:"#DEE2E6",shapeFill:"#E9ECEF",shapeBorderColor:"#DEE2E6",zoomButtonRadius:32,rectangleZoomBorderColor:"#0D6EFD",rectangleZoomFillColor:"#86B7FE",rectangleZoomFillOpacity:.3,legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent"};break;case"bootstrap5dark":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#DEE2E6",subTitleFontColor:"#DEE2E6",legendTitleFontColor:"#DEE2E6",legendTextColor:"#DEE2E6",dataLabelFontColor:"#DEE2E6",tooltipFontColor:"#212529",tooltipFillColor:"#FFFFFF",zoomFillColor:"#ADB5BD",fontFamily:"Segoe UI",fontSize:"10px",fontWeight:"400",titleFontSize:"14px",subTitleFontSize:"12px",legendFontSize:"10px",tooltipFillOpacity:.9,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"400",zoomSelectionColor:"#F8F9FA",zoomBorderColor:"#495057",shapeFill:"#343A40",shapeBorderColor:"#495057",zoomButtonRadius:32,rectangleZoomFillColor:"#86B7FE",rectangleZoomBorderColor:"#0D6EFD",rectangleZoomFillOpacity:.3,legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent"};break;case"fluent":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#201F1E",subTitleFontColor:"#201F1E",legendTitleFontColor:"#201F1E",legendTextColor:"#201F1E",dataLabelFontColor:"#201F1E",tooltipFontColor:"#323130",tooltipFillColor:"#FFFFFF",zoomFillColor:"#A19F9D",fontFamily:"Segoe UI",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#323130",shapeFill:"#F3F2F1",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"fluentdark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#F3F2F1",subTitleFontColor:"#F3F2F1",legendTitleFontColor:"#F3F2F1",legendTextColor:"#F3F2F1",dataLabelFontColor:"#F3F2F1",tooltipFontColor:"#F3F2F1",tooltipFillColor:"#252423",zoomFillColor:"#484644",fontFamily:"Segoe UI",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#F3F2F1",shapeFill:"#252423",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"material3":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#1C1B1F",subTitleFontColor:"#1C1B1F",legendTitleFontColor:"#1C1B1F",legendTextColor:"#49454E",dataLabelFontColor:"#1C1B1F",tooltipFontColor:"#F4EFF4",tooltipFillColor:"#313033",zoomFillColor:"#49454E",fontFamily:"Roboto",fontSize:"14px",titleFontSize:"16px",subTitleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Roboto",titleFontWeight:"500",fontWeight:"400",zoomSelectionColor:"#49454E",shapeFill:"#E7E0EC",shapeBorderColor:"#000000",rectangleZoomFillColor:"#6750A4",rectangleZoomFillOpacity:.24,rectangleZoomBorderColor:"#6750A4",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"material3dark":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#E6E1E5",subTitleFontColor:"#E6E1E5",legendTitleFontColor:"#E6E1E5",legendTextColor:"#CAC4D0",dataLabelFontColor:"#E6E1E5",tooltipFontColor:"#313033",tooltipFillColor:"#E6E1E5",zoomFillColor:"#E6E1E5",fontFamily:"Roboto",fontSize:"14px",titleFontSize:"16px",subTitleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Roboto",titleFontWeight:"500",fontWeight:"400",zoomSelectionColor:"#E6E1E5",shapeFill:"#49454F",shapeBorderColor:"#000000",rectangleZoomFillColor:"#D0BCFF",rectangleZoomFillOpacity:.24,rectangleZoomBorderColor:"#D0BCFF",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30};break;case"fluent2":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#242424",subTitleFontColor:"#242424",legendTitleFontColor:"#242424",legendTextColor:"#242424",dataLabelFontColor:"#242424",tooltipFontColor:"#242424",tooltipFillColor:"#FFFFFF",zoomFillColor:"#D1D1D1",fontFamily:"Segoe UI",fontSize:"10px",fontWeight:"400",titleFontSize:"14px",subTitleFontSize:"12px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#242424",shapeFill:"#E6E6E6",shapeBorderColor:"#EBEBEB",rectangleZoomFillColor:"#B4D6FA",rectangleZoomFillOpacity:.25,rectangleZoomBorderColor:"#0F6CBD",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:32};break;case"fluent2dark":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#292929",zoomFillColor:"#666",fontFamily:"Segoe UI",fontSize:"10px",fontWeight:"400",titleFontSize:"14px",subTitleFontSize:"12px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#FFFFFF",shapeFill:"#333333",shapeBorderColor:"#000000",rectangleZoomFillColor:"#0E4775",rectangleZoomFillOpacity:.25,rectangleZoomBorderColor:"#0E4775",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:32};break;case"fluent2highcontrast":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#3FF23F",fontFamily:"Segoe UI",fontSize:"10px",fontWeight:"400",titleFontSize:"14px",subTitleFontSize:"12px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#FFFFFF",zoomBorderColor:"#FFFFFF",shapeFill:"#FFFFFF",shapeBorderColor:"#FFFFFF",rectangleZoomFillColor:"#1AEBFF",rectangleZoomFillOpacity:.25,rectangleZoomBorderColor:"#1AEBFF",legendBorderColor:"#FFFFFF",legendBorderWidth:1,tooltipBorderColor:"#FFF",zoomButtonRadius:32};break;default:t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#424242",titleFontSize:"14px",subTitleFontColor:"#424242",legendTitleFontColor:"#757575",legendTextColor:"#757575",dataLabelFontColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#737373",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",legendFontSize:"12px",fontWeight:"Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",shapeBorderColor:"#000000",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900",legendBorderColor:"#000000",legendBorderWidth:0,tooltipBorderColor:"transparent",zoomButtonRadius:30}}return t}(this.theme),this.renderBorder(),this.renderTitle(this.titleSettings,"title",null,null),this.renderArea(),this.processRequestJsonData(),this.renderComplete(),this.isAddLayer=!!this.isTileMap&&this.isAddLayer)},i.prototype.render=function(){this.renderElements()},i.prototype.processRequestJsonData=function(){var i,r,t=this,u=this.layersCollection.length-1;this.serverProcess={request:0,response:0};Array.prototype.forEach.call(this.layersCollection,function(f,e){var s,o,h;if(f.shapeData instanceof nt.DataManager?(t.serverProcess.request++,r=f.shapeData,i=f.query instanceof nt.Query?f.query:new nt.Query,r.executeQuery(i).then(function(n){t.processResponseJsonData("DataManager",n,f,"ShapeData")})):(f.shapeData instanceof ki||f.shapeData)&&(n.isNullOrUndefined(f.shapeData.dataOptions)||t.processAjaxRequest(f,f.shapeData,"ShapeData")),f.dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.dataSource,i=f.query instanceof nt.Query?f.query:new nt.Query,r.executeQuery(i).then(function(n){f.dataSource=dt(n)})),f.markerSettings.length>0)for(s=function(n){f.markerSettings[n].dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.markerSettings[n].dataSource,i=f.markerSettings[n].query instanceof nt.Query?f.markerSettings[n].query:new nt.Query,r.executeQuery(i).then(function(t){f.markerSettings[n].dataSource=dt(t)}))},o=0;o<f.markerSettings.length;o++)s(o);if(f.bubbleSettings.length>0)for(h=function(n){f.bubbleSettings[n].dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.bubbleSettings[n].dataSource,i=f.bubbleSettings[n].query instanceof nt.Query?f.bubbleSettings[n].query:new nt.Query,r.executeQuery(i).then(function(t){f.bubbleSettings[n].dataSource=dt(t)}))},o=0;o<f.bubbleSettings.length;o++)h(o);(f.dataSource instanceof ki||!n.isNullOrUndefined(f.dataSource)&&!n.isNullOrUndefined(f.dataSource.dataOptions))&&t.processAjaxRequest(f,f.dataSource,"DataSource");t.serverProcess.request===t.serverProcess.response&&u===e&&t.processResponseJsonData(null)})},i.prototype.processAjaxRequest=function(t,i,r){var f=this,u;this.serverProcess.request++;u=new n.Fetch(i.dataOptions,i.type,i.contentType);u.onSuccess=function(i){if(n.isNullOrUndefined(i.type)||"application/octet-stream"!==i.type)f.processResponseJsonData("Fetch",i,t,r);else{var u=new FileReader,e=f;u.onload=function(){i=JSON.parse(u.result.toString());e.processResponseJsonData("Fetch",i,t,r)};u.readAsText(i)}};u.send(i.sendData)},i.prototype.processResponseJsonData=function(t,i,r,u){var f,e,o;if(this.serverProcess.response++,t&&("ShapeData"===u?r.shapeData="DataManager"===t?dt(i):i:r.dataSource="DataManager"===t?dt(i):i),n.isNullOrUndefined(t)||this.serverProcess.request!==this.serverProcess.response)n.isNullOrUndefined(t)&&this.renderMap();else{for(f=this.layersCollection,this.layersCollection=[],e=0;e<f.length;e++)f[e].isBaseLayer&&this.layersCollection.push(f[e]);for(o=0;o<f.length;o++)f[o].isBaseLayer||this.layersCollection.push(f[o]);this.renderMap()}},i.prototype.renderMap=function(){var t,h,c,i,r,o,l;for(this.legendModule&&this.legendSettings.visible&&this.legendModule.renderLegend(),this.createTile(),this.zoomSettings.enable&&this.zoomModule&&this.zoomModule.createZoomingToolbars(),n.isNullOrUndefined(this.dataLabelModule)||(this.dataLabelModule.dataLabelCollections=[]),this.mapLayerPanel.measureLayerPanel(),n.isNullOrUndefined(this.svgObject)||this.element.appendChild(this.svgObject),this.setSecondaryElementPosition(),t=0;t<this.layers.length;t++){if(this.layers[t].selectionSettings&&this.layers[t].selectionSettings.enable&&this.layers[t].initialShapeSelection.length>0&&this.checkInitialRender){for(h=this.layers[t].selectionSettings.enableMultiSelect,this.layers[t].selectionSettings.enableMultiSelect=h||!0,c=this.layers[t].initialShapeSelection,i=0;i<this.layers[t].initialShapeSelection.length;i++)this.shapeSelection(t,c[i].shapePath,c[i].shapeValue,!0);this.layers[t].selectionSettings.enableMultiSelect=h;t===this.layers.length-1&&(this.checkInitialRender=!1)}if(!this.isResize)for(r=0;r<this.layers[t].markerSettings.length;r++)if(this.layers[t].markerSettings[r].selectionSettings&&this.layers[t].markerSettings[r].selectionSettings.enable&&this.layers[t].markerSettings[r].initialMarkerSelection.length>0)for(o=this.layers[t].markerSettings[r].initialMarkerSelection,i=0;i<o.length;i++)this.markerInitialSelection(t,r,this.layers[t].markerSettings[r],o[i].latitude,o[i].longitude)}if(!n.isNullOrUndefined(document.getElementById(this.element.id+"_tile_parent"))){var e,a=this.svgObject.getBoundingClientRect(),v=document.getElementById(this.element.id),u=document.getElementById(this.element.id+"_tile_parent"),s=document.getElementById(this.element.id+"_tiles"),y=u.getBoundingClientRect(),f=void 0;f=parseFloat(u.style.left);l=a.bottom-y.bottom-v.offsetTop;e=parseFloat(u.style.top);e=l<=11?e:n.isNullOrUndefined(this.legendModule)||"Bottom"!==this.legendSettings.position?2*e:this.mapAreaRect.y;f=l<=11?f:n.isNullOrUndefined(this.legendModule)?2*f:f;u.style.top=e+"px";u.style.left=f+"px";s.style.top=e+"px";s.style.left=f+"px";!n.isNullOrUndefined(this.legendModule)&&this.legendModule.totalPages.length>0&&(u.style.height=s.style.height=this.legendModule.legendTotalRect.height+"px",u.style.width=s.style.width=this.legendModule.legendTotalRect.width+"px")}for(this.arrangeTemplate(),this.annotationsModule&&"0px"!==this.width&&"0px"!==this.height&&"0%"!==this.width&&"0%"!==this.height&&this.annotationsModule.renderAnnotationElements(),this.element.style.outline="none",this.element.style.position="relative",t=0;t<document.getElementsByTagName("path").length-1;t++)document.getElementsByTagName("path")[t].id.indexOf("shapeIndex")>-1&&(document.getElementsByTagName("path")[t].style.outline="none");this.zoomingChange();this.zoomModule&&this.isDevice&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,this.element.id+"_Zooming_");this.isZoomByPosition||this.zoomNotApplied||this.triggerZoomEvent();this.isResize=!1},i.prototype.triggerZoomEvent=function(){var t,n=this.getMinMaxLatitudeLongitude();t={maps:this,isResized:this.isResize,minLatitude:n.minLatitude,maxLatitude:n.maxLatitude,minLongitude:n.minLongitude,maxLongitude:n.maxLongitude,cancel:!1,name:"Loaded"};this.trigger("loaded",t)},i.prototype.markerSelection=function(n,t,i,r){var f={color:n.border.color,width:n.border.width/t.scale,opacity:n.border.opacity},u={opacity:n.opacity,fill:n.fill,border:f,target:i.id,cancel:!1,data:r,maps:t};o("MarkerselectionMap")?at("MarkerselectionMap","MarkerselectionMapStyle",u):document.body.appendChild(kt("MarkerselectionMap","MarkerselectionMapStyle",u));(0===this.selectedMarkerElementId.length||n.enableMultiSelect)&&("g"===i.tagName?(i.children[0].setAttribute("class","MarkerselectionMapStyle"),this.selectedMarkerElementId.push(i.children[0].id)):(i.setAttribute("class","MarkerselectionMapStyle"),this.selectedMarkerElementId.push(i.id)))},i.prototype.markerInitialSelection=function(n,t,i,r,u){var s=i.selectionSettings,f,e,h;if(s.enable)for(f=0;f<i.dataSource.length;f++)e=i.dataSource[f],e.latitude===r&&e.longitude===u&&(h=this.element.id+"_LayerIndex_"+n+"_MarkerIndex_"+t+"_dataIndex_"+f,this.markerSelection(s,this,o(h),e))},i.prototype.renderArea=function(){var u=this.mapsArea.border.width,t=this.mapsArea.background,i,r;(u>0||t||this.themeStyle.areaBackgroundColor)&&(i={opacity:n.isNullOrUndefined(this.mapsArea.border.opacity)?1:this.mapsArea.border.opacity,color:this.mapsArea.border.color,width:this.mapsArea.border.width},r=new d(this.element.id+"_MapAreaBorder",t||this.themeStyle.areaBackgroundColor,i,1,this.mapAreaRect),this.svgObject.appendChild(this.renderer.drawRectangle(r)))},i.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"Maps Element");this.element.setAttribute("role","region");this.element.tabIndex=this.tabIndex},i.prototype.setSecondaryElementPosition=function(){var i=r(this.element.id+"_Secondary_Element"),u=this.element.getBoundingClientRect(),f=r(this.element.id+"_svg"),t;n.isNullOrUndefined(f)||(t=f.getBoundingClientRect(),i.style.left=Math.max(t.left-u.left,0)+"px",i.style.top=Math.max(t.top-u.top,0)+"px")},i.prototype.zoomingChange=function(){var h,c,u,t,v,f,i,w,s,e;if(r(this.element.id+"_Layer_Collections")&&this.zoomModule&&(this.zoomModule.layerCollectionEle=r(this.element.id+"_Layer_Collections")),this.isTileMap&&r(this.element.id+"_Tile_SVG")&&r(this.element.id+"_tile_parent")){var l=r(this.element.id+"_tile_parent"),a=r(this.element.id+"_Tile_SVG"),o=r(this.element.id+"_Tile_SVG_Parent"),y=l.getBoundingClientRect(),p=a.getBoundingClientRect();if(h=y.left-p.left,c=y.top-p.top,o.style.left=h+"px",o.style.top=c+"px",!n.isNullOrUndefined(this.legendModule)&&this.legendModule.totalPages.length>0&&(l.style.width=a.style.width=this.legendModule.legendTotalRect.width.toString(),l.style.height=a.style.height=this.legendModule.legendTotalRect.height.toString(),o.style.width=this.legendModule.legendTotalRect.width+"px",o.style.height=this.legendModule.legendTotalRect.height+"px"),u=document.getElementsByClassName("template"),!n.isNullOrUndefined(u)&&u.length>0)for(t=0;t<u.length;t++)v=u[t],v.style.left=h+"px",v.style.top=c+"px"}if(this.zoomSettings.zoomFactor>=0){if(this.zoomModule&&this.zoomModule.toolBarGroup&&this.zoomSettings.enable&&this.zoomModule.alignToolBar(),f=document.getElementById(this.element.id+"_Layer_Collections"),!n.isNullOrUndefined(f)&&f.childElementCount>0)for(t=0;t<f.childNodes.length;t++)if(i=f.childNodes[t],"g"===i.tagName&&-1===i.id.indexOf("_Legend_Group"))for(w=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),s=0;s<i.childNodes.length;s++)e=i.childNodes[s],e.id.indexOf("_Markers_Group")>-1||e.id.indexOf("_bubble_Group")>-1||e.id.indexOf("_dataLableIndex_Group")>-1||fu(e,w,this.scale,this);this.zoomModule&&(this.previousScale!==this.scale||this.zoomNotApplied||this.isZoomByPosition)&&this.zoomModule.applyTransform(this,!1,!0)}},i.prototype.createSecondaryElement=function(){if(n.isNullOrUndefined(document.getElementById(this.element.id+"_Secondary_Element"))){var t=n.createElement("div",{id:this.element.id+"_Secondary_Element"});t.style.cssText="position: relative;z-index:2;";this.element.appendChild(t)}},i.prototype.getMinMaxLatitudeLongitude=function(){var t=document.getElementById(this.element.id);if(n.isNullOrUndefined(t))return{minLatitude:0,maxLatitude:0,minLongitude:0,maxLongitude:0};var i=t.getBoundingClientRect(),f=ft(this.margin.left),r=this.isTileMap?this.pointToLatLong(this.mapAreaRect.x-f,-this.mapAreaRect.y):this.getGeoLocation(0,this.mapAreaRect.x+i.left,this.mapAreaRect.y),u=this.isTileMap?this.pointToLatLong(this.mapAreaRect.width,this.mapAreaRect.height-this.mapAreaRect.y):this.getGeoLocation(0,this.mapAreaRect.x+i.left+this.mapAreaRect.width,this.mapAreaRect.y+this.mapAreaRect.height);return{minLatitude:r.latitude,maxLatitude:u.latitude,minLongitude:r.longitude,maxLongitude:u.longitude}},i.prototype.arrangeTemplate=function(){var i=this,t;document.getElementById(this.element.id+"_Legend_Border")&&(document.getElementById(this.element.id+"_Legend_Border").style.pointerEvents="none");t=document.getElementsByClassName(this.element.id+"_template");!n.isNullOrUndefined(t)&&t.length>0&&r(this.element.id+"_Layer_Collections")&&!this.isTileMap&&Array.prototype.forEach.call(t,function(t){var e=0,o=0,u,f;!n.isNullOrUndefined(t)&&t.childElementCount>0&&(u=r(i.element.id+"_Layer_Collections").getBoundingClientRect(),f=r(t.id).getBoundingClientRect(),-1===t.id.indexOf("Marker")&&(e=i.isTileMap?0:u.left<f.left?-Math.abs(f.left-u.left):Math.abs(f.left-u.left),o=i.isTileMap?0:u.top<f.top?-Math.abs(f.top-u.top):Math.abs(f.top-u.top)),Array.prototype.forEach.call(t.childNodes,function(n){-1===n.id.indexOf("Marker")&&(n.style.left=parseFloat(n.style.left)+e+"px",n.style.top=parseFloat(n.style.top)+o+"px",n.style.transform="translate(-50%, -50%)")}))})},i.prototype.createTile=function(){var t=this.layersCollection[0],i,r,u;t.isBaseLayer&&!n.isNullOrUndefined(t.urlTemplate)&&""!==t.urlTemplate&&n.isNullOrUndefined(t.shapeData)&&(c(this.element.id+"_tile_parent"),c(this.element.id+"_tiles"),c("animated_tiles"),i=n.createElement("div",{id:this.element.id+"_tile_parent"}),r=ft(this.margin.right),i.style.cssText="position: absolute; left: "+this.mapAreaRect.x+"px; right: "+r+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;",u=n.createElement("div",{id:this.element.id+"_tiles"}),u.style.cssText="position: absolute; left: "+this.mapAreaRect.x+"px;  right: "+r+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;",this.element.appendChild(i),this.element.appendChild(u))},i.prototype.initPrivateVariable=function(){if(""===this.element.id){var n=document.getElementsByClassName("e-maps").length;this.element.id="maps_control_"+n}this.renderer=new ot.SvgRenderer(this.element.id);this.mapLayerPanel=new ho(this)},i.prototype.findBaseAndSubLayers=function(){var f=this,e=this.baseLayerIndex,i=[],u=[],t,r;for(this.layersCollection=[],Array.prototype.forEach.call(this.layers,function(n){"Layer"===n.type?i.push(n):u.push(n)}),t=0;t<i.length;t++){if(r=i[t],r.visible&&e===t){r.isBaseLayer=!0;this.isTileMap=!!n.isNullOrUndefined(r.shapeData);this.layersCollection.push(r);break}if(t===i.length-1){this.layersCollection.push(i[0]);break}}u.map(function(n){n.visible&&f.layersCollection.push(n)})},i.prototype.renderBorder=function(){var t=this.border.width,i=this.svgObject.querySelector("#"+this.element.id+"_MapBorder"),r,u;(t>0||this.background||this.themeStyle.backgroundColor)&&n.isNullOrUndefined(i)?(r={opacity:n.isNullOrUndefined(this.border.opacity)?1:this.border.opacity,color:this.border.color,width:this.border.width},u=new d(this.element.id+"_MapBorder",this.background||this.themeStyle.backgroundColor,r,1,new a(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t)),this.svgObject.appendChild(this.renderer.drawRectangle(u))):i.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},i.prototype.renderTitle=function(t,i,r,u){var o,e={size:t.textStyle.size,color:t.textStyle.color,fontFamily:t.textStyle.fontFamily,fontWeight:t.textStyle.fontWeight,fontStyle:t.textStyle.fontStyle,opacity:t.textStyle.opacity},c=ft(this.margin.top),w=ft(this.margin.bottom),s=ft(this.margin.left),d=ft(this.margin.right),l=Math.abs(s+d-this.availableSize.width);if(e.fontFamily=n.isNullOrUndefined(e.fontFamily)?this.themeStyle.fontFamily:e.fontFamily,e.fontWeight=e.fontWeight||this.themeStyle.titleFontWeight,e.size="title"===i?e.size||this.themeStyle.titleFontSize:e.size||this.themeStyle.subTitleFontSize||et.mapsSubTitleFont.size,t.text){n.isNullOrUndefined(u)&&(u=this.renderer.createGroup({id:this.element.id+"_Title_Group"}));var b=g(l,t.text,e),v=p(b,e),h=function(n,t,i,r){var u,e;switch(t){case"Near":u=n.x;break;case"Center":u="title"===r?n.width/2-i.width/2:n.x+n.width/2-i.width/2;break;case"Far":u="title"===r?n.width-n.y-i.width:n.x+n.width-i.width}return e="title"===r?n.y+i.height/2:n.y+n.height/2+i.height/2,new f(u,e)}(n.isNullOrUndefined(r)?new a(s,c,this.availableSize.width,this.availableSize.height):r,n.isNullOrUndefined(t.alignment)?"Center":t.alignment,v,i),nt=new tt(this.element.id+"_Map_"+i,h.x,h.y,"start",b),y=new a(h.x,h.y,v.width,v.height),k=ht(nt,e,e.color||("title"===i?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),u);k.setAttribute("aria-label",t.text);k.setAttribute("role","region");("title"===i&&!t.subtitleSettings.text||"subtitle"===i)&&(o=Math.abs(y.y+w-this.availableSize.height),this.mapAreaRect=new a(s,y.y+10,l,o-10));"subtitle"!==i&&t.subtitleSettings.text?this.renderTitle(t.subtitleSettings,"subtitle",y,u):this.svgObject.appendChild(u)}else o=Math.abs(c+w-this.availableSize.height),this.mapAreaRect=new a(s,c,l,o)},i.prototype.createSVG=function(){this.removeSvg(),function(n){n.renderer=new ot.SvgRenderer(n.element.id);n.availableSize=tr(n);n.svgObject=n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height});"0px"!==n.width&&"0%"!==n.width&&"0%"!==n.height&&"0px"!==n.height||(n.svgObject.setAttribute("height","0"),n.svgObject.setAttribute("width","0"))}(this)},i.prototype.removeSvg=function(){if(c(this.element.id+"_Secondary_Element"),c(this.element.id+"_tile_parent"),c(this.element.id+"_tiles"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&n.remove(this.svgObject)}this.clearTemplate()},i.prototype.wireEVents=function(){n.EventHandler.add(this.element,"click",this.mapsOnClick,this);n.EventHandler.add(this.element,"contextmenu",this.mapsOnRightClick,this);n.EventHandler.add(this.element,"dblclick",this.mapsOnDoubleClick,this);n.EventHandler.add(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap,this);n.EventHandler.add(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap,this);n.EventHandler.add(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap,this);n.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap,this);n.EventHandler.add(this.element,"keydown",this.keyDownHandler,this);n.EventHandler.add(this.element,"keyup",this.keyUpHandler,this);this.resizeEvent=this.mapsOnResize.bind(this);window.addEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeEvent)},i.prototype.unWireEVents=function(){n.EventHandler.remove(this.element,"click",this.mapsOnClick);n.EventHandler.remove(this.element,"contextmenu",this.mapsOnRightClick);n.EventHandler.remove(this.element,"dblclick",this.mapsOnDoubleClick);n.EventHandler.remove(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap);n.EventHandler.remove(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap);n.EventHandler.remove(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap);n.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap);n.EventHandler.remove(this.element,"keydown",this.keyDownHandler);n.EventHandler.remove(this.element,"keyup",this.keyUpHandler);window.removeEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeEvent)},i.prototype.mouseLeaveOnMap=function(){document.getElementsByClassName("highlightMapStyle").length>0&&this.legendModule&&(this.legendModule.removeShapeHighlightCollection(),l(document.getElementsByClassName("highlightMapStyle")[0]))},i.prototype.keyUpHandler=function(n){var t=n.target.id;this.isTileMap&&this.removeTileMap();"Tab"===n.code&&t.indexOf("_LayerIndex_")>-1&&t.indexOf("shapeIndex")>-1?this.keyboardHighlightSelection(t,n):-1===t.indexOf("_LayerIndex_")&&-1===t.indexOf("shapeIndex")&&lt("highlightMapStyle").length>0&&(l(lt("highlightMapStyle")[0]),this.legendSettings.visible&&this.legendModule&&this.legendModule.removeShapeHighlightCollection())},i.prototype.keyboardHighlightSelection=function(t,i){var u=i.type,r=parseInt(t.split("_LayerIndex_")[1].split("_")[0],10),f=parseInt(t.split("_shapeIndex_")[1].split("_")[0],10),e=this.layers[r].shapeData.features.length>f?this.layers[r].shapeData.features[f].properties:null,o=parseInt(t.split("_dataIndex_")[1].split("_")[0],10),s=n.isNullOrUndefined(o)?null:this.layers[r].dataSource[o];this.layers[r].selectionSettings.enable&&"keydown"===u&&this.selectionModule?(this.selectionModule.selectionsettings=this.layers[r].selectionSettings,this.selectionModule.selectionType="Shape",this.selectionModule.selectElement(i.target,r,s,e)):this.highlightModule&&this.layers[r].highlightSettings.enable&&"keyup"===u&&!i.target.classList.contains("ShapeselectionMapStyle")&&(this.highlightModule.highlightSettings=this.layers[r].highlightSettings,this.highlightModule.handleHighlight(i.target,r,s,e))},i.prototype.keyDownHandler=function(t){var i=this.zoomModule,r=t.target.id,f,u;("ArrowUp"===t.code||"ArrowDown"===t.code||"ArrowLeft"===t.code||"ArrowRight"===t.code)&&i&&(f=document.getElementById(this.element.id+"_animated_tiles"),this.isTileMap&&!n.isNullOrUndefined(f)&&(this.currentTiles=f.cloneNode(!0)));this.zoomSettings.enable&&i&&("+"===t.key||"Equal"===t.code)?i.performZoomingByToolBar("zoomin"):this.zoomSettings.enable&&i&&("-"===t.key||"Minus"===t.code)?i.performZoomingByToolBar("zoomout"):this.zoomSettings.enable&&i&&82===t.keyCode?(i.performZoomingByToolBar("reset"),i.isPanModeEnabled=!1):this.zoomSettings.enable&&this.zoomSettings.enablePanning&&i&&("ArrowUp"===t.code||"ArrowDown"===t.code)?(t.preventDefault(),i.mouseDownLatLong.x=0,i.mouseMoveLatLong.y=this.mapAreaRect.height/7,i.panning("None",i.mouseDownLatLong.x,"ArrowUp"===t.code?-i.mouseMoveLatLong.y:i.mouseMoveLatLong.y,t),i.mouseDownLatLong.y=i.mouseMoveLatLong.y):this.zoomSettings.enable&&this.zoomSettings.enablePanning&&i&&("ArrowLeft"===t.code||"ArrowRight"===t.code)?(t.preventDefault(),i.mouseDownLatLong.y=0,i.mouseMoveLatLong.x=this.mapAreaRect.width/7,i.panning("None","ArrowLeft"===t.code?-i.mouseMoveLatLong.x:i.mouseMoveLatLong.x,i.mouseDownLatLong.y,t),i.mouseDownLatLong.x=i.mouseMoveLatLong.x):"Enter"===t.code&&((r=t.target.id,t.preventDefault(),this.legendModule&&(r.indexOf("_Left_Page_Rect")>-1||r.indexOf("_Right_Page_Rect")>-1))&&(this.mapAreaRect=this.legendModule.initialMapAreaRect,this.legendModule.currentPage=r.indexOf("_Left_Page_")>-1?this.legendModule.currentPage-1:this.legendModule.currentPage+1,this.legendModule.legendGroup=this.renderer.createGroup({id:this.element.id+"_Legend_Group"}),this.legendModule.drawLegendItem(this.legendModule.currentPage),u=document.getElementById(this.element.id+"_Paging_Text").textContent.split("/").map(Number),r.indexOf("_Left_Page_Rect")>-1?(1!==u[0]&&t.target.focus(),t.target.style.outlineColor=u[0]-1!==u[1]?"":"transparent"):r.indexOf("_Right_Page_Rect")>-1&&(u[0]!==u[1]&&t.target.focus(),t.target.style.outlineColor=u[0]!==u[1]+1?"":"transparent"),e(this.element.id+"_Legend_Border",this.element.id)&&(e(this.element.id+"_Legend_Border",this.element.id).style.pointerEvents="none")),r.indexOf("shapeIndex")>-1&&this.keyboardHighlightSelection(r,t));this.zoomModule&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,this.mouseMoveId)},i.prototype.SelectedElement=function(n){var t=!1;return"ShapeselectionMapStyle"===n.getAttribute("class")&&(t=!0),t},i.prototype.mapsOnClick=function(t){var e=this,i=t.target,f=i.id,o=null,s=null,u,r;(this.mouseClickEvent={x:t.x,y:t.y},-1===i.id.indexOf("_ToolBar"))&&(u=this.getClickLocation(f,t.pageX,t.pageY,i,t.layerX,t.layerY),n.isNullOrUndefined(u)||(o=u.latitude,s=u.longitude),r={cancel:!1,name:vt,target:f,x:t.clientX,y:t.clientY,latitude:o,longitude:s,isShapeSelected:this.SelectedElement(i)},this.onclick?(r.name="onclick",this.trigger("onclick",r,function(){e.clickHandler(t,r,i)})):this.trigger("click",r,function(){e.clickHandler(t,r,i)}));this.zoomModule&&(this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,f),this.isDevice&&this.zoomModule.removeToolbarClass("","","","",""))},i.prototype.clickHandler=function(n,t,i){i.id.indexOf("shapeIndex")>-1&&(this.mergeCluster(),o(this.element.id+"_mapsTooltip")&&this.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&c(this.element.id+"_mapsTooltip"));this.markerModule&&this.markerModule.markerClusterClick(n);t.cancel||this.notify(vt,i);t.cancel||-1===i.id.indexOf("shapeIndex")||this.triggerShapeSelection(i)},i.prototype.triggerShapeSelection=function(t){var r=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),i=function(t,i,r,u){var e=function(n,t){var r,f=parseInt(n.split("_LayerIndex_")[1].split("_")[0],10),e=parseInt(n.split("_shapeIndex_")[1].split("_")[0],10),i=t.layersCollection[f],u=i.layerData[e].property;return i.dataSource&&(r=i.dataSource[ct(i.dataSource,u,i.shapeDataPath,i.shapePropertyPath)]),{shapeData:u,data:r}}(t,r),o={color:i.border.color,opacity:i.border.opacity,width:i.border.width},f=i.enableMultiSelect?{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r,shapeDataCollection:r.shapeSelectionItem}:{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r};return r.trigger(u,f,function(){f.border.opacity=n.isNullOrUndefined(f.border.opacity)?f.opacity:f.border.opacity}),f}(t.id,this.layers[r].selectionSettings,this,"shapeSelected");i.cancel||!this.selectionModule||n.isNullOrUndefined(this.shapeSelected)?i.cancel&&this.selectionModule&&n.isNullOrUndefined(i.data)&&(l(t),this.selectionModule.removedSelectionList(t)):at(this.selectionModule.selectionType+"selectionMap",this.selectionModule.selectionType+"selectionMapStyle",i)},i.prototype.getMarkerClickLocation=function(n,t,i,r,u,f){var s;document.getElementById(this.element.id+"_svg").style.cursor="grabbing";var h=o(u.targetId),e=this.getClickLocation(u.targetId,n,t,h,i,r),c=this.isTileMap?it(new b(e.longitude,e.latitude),this.tileZoomLevel,this.tileTranslatePoint,!0):v(e.latitude,e.longitude,this.mapLayerPanel.currentFactor,this.layersCollection[u.layerIndex],this),l=this.translatePoint,a=this.isTileMap?c.x:(c.x+l.x)*this.scale,y=this.isTileMap?c.y:(c.y+l.y)*this.scale;return("Balloon"!==this.markerDragArgument.shape?h.setAttribute("transform","translate( "+a+" "+y+" )"):h.parentElement.setAttribute("transform","translate( "+a+" "+y+" )"),f)&&(s=this.layers[u.layerIndex].markerSettings[u.markerIndex],e=this.getClickLocation(u.targetId,n-s.offset.x,t-s.offset.y,h,i-s.offset.x,r-s.offset.y)),e},i.prototype.getClickLocation=function(t,i,r,u,f,e,o){var s,a=0,k,d,g,c,l;if(-1===t.indexOf("_LayerIndex_")||this.isTileMap||n.isNullOrUndefined(o)&&(parseInt(this.mouseDownEvent.x,10)!==parseInt(this.mouseClickEvent.x,10)||parseInt(this.mouseDownEvent.y,10)!==parseInt(this.mouseClickEvent.y,10)))this.isTileMap&&(!n.isNullOrUndefined(o)||parseInt(this.mouseDownEvent.x,10)===parseInt(this.mouseClickEvent.x,10)&&parseInt(this.mouseDownEvent.y,10)===parseInt(this.mouseClickEvent.y,10))&&(s=this.getTileGeoLocation(f,e));else if(a=parseFloat(t.split("_LayerIndex_")[1].split("_")[0]),"Normal"===this.layers[a].geometryType)if(t.indexOf("_shapeIndex_")>-1){var h=u.parentElement,v=li(i,r,h.id.indexOf("_Point_Group")>-1||h.id.indexOf("_LineString_Group")>-1||h.id.indexOf("_MultiLineString_Group")>-1||h.id.indexOf("_Polygon_Group")>-1?h.parentElement:h),y=this.mapLayerPanel.currentFactor*this.mapScaleValue,p=Math.abs(-this.baseMapBounds.longitude.min*y),w=Math.abs(this.baseMapBounds.latitude.max*y);s={latitude:Math.abs(this.baseMapBounds.latitude.max-v.y/y),longitude:Math.abs(v.x/y+this.baseMapBounds.longitude.min)};this.baseMapBounds.longitude.min<0&&p>v.x&&(s.longitude=-s.longitude);this.baseMapBounds.latitude.min<0&&w>v.y&&(s.latitude=-s.latitude)}else t.indexOf("_MarkerIndex_")>-1&&this.markerModule&&!this.markerDragArgument?(k=parseInt(t.split("_MarkerIndex_")[1].split("_")[0],10),d=parseInt(t.split("_dataIndex_")[1].split("_")[0],10),isNaN(k)||isNaN(d)?s={latitude:null,longitude:null}:(g=this.layers[a].markerSettings[k].dataSource[d],s={latitude:g.latitude,longitude:g.longitude})):t.indexOf("_MarkerIndex_")>-1&&this.markerModule&&this.markerDragArgument?(c=document.getElementById(this.element.id+"_LayerIndex_"+this.markerDragArgument.layerIndex).getBoundingClientRect(),l=new b(i>c.left?Math.abs(c.left-i):0,r>c.top?Math.abs(c.top-r):0),p=Math.abs(-this.baseMapBounds.longitude.min*this.mapLayerPanel.currentFactor),w=Math.abs(this.baseMapBounds.latitude.max*this.mapLayerPanel.currentFactor),s={latitude:Math.abs(this.baseMapBounds.latitude.max-l.y/(this.mapLayerPanel.currentFactor*this.scale)),longitude:Math.abs(l.x/(this.mapLayerPanel.currentFactor*this.scale)+this.baseMapBounds.longitude.min)},this.baseMapBounds.longitude.min<0&&p>l.x&&(s.longitude=-s.longitude),this.baseMapBounds.latitude.min<0&&w>l.y&&(s.latitude=-s.latitude)):s={latitude:null,longitude:null};else s=this.getGeoLocation(a,i,r);return s},i.prototype.removeTileMap=function(){var t=document.getElementById(this.element.id+"_animated_tiles"),i;if(!n.isNullOrUndefined(this.currentTiles)&&t.childElementCount<this.currentTiles.childElementCount)for(i=t.childElementCount-1;i>=this.currentTiles.childElementCount;i--)t.removeChild(t.children[i]);this.currentTiles=null},i.prototype.mouseEndOnMap=function(t){var f,e,l,o=0,s=0,i,h,r,u,c;return(-1!==t.type.indexOf("touch")?(this.isTouch=!0,o=f=(l=t).changedTouches[0].pageX,s=(e=l.changedTouches[0].pageY)-(this.isTileMap?10:0),this.mouseClickEvent={x:f,y:e}):(this.isTouch="touch"===t.pointerType,f=t.pageX,e=t.pageY,o=t.layerX,s=t.layerY-(this.isTileMap?10:0)),this.isTileMap&&this.removeTileMap(),this.isTouch&&(this.titleTooltip(t,f,e,!0),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)),this.notify(n.Browser.touchEndEvent,t),t.cancelable&&!this.isTouch&&t.preventDefault(),n.isNullOrUndefined(this.markerDragArgument))?document.getElementById(this.element.id+"_svg").style.cursor="auto":(i=this.markerDragArgument,this.mouseClickEvent.x=this.mouseDownEvent.x,this.mouseClickEvent.y=this.mouseDownEvent.y,h=this.getMarkerClickLocation(f,e,o,s,this.markerDragArgument,!0),r=this.layers[i.layerIndex].markerSettings[i.markerIndex],document.getElementById(this.element.id+"_svg").style.cursor=r.enableDrag?"pointer":"grabbing",u={name:"markerDragEnd",x:f,y:e,latitude:h.latitude,longitude:h.longitude,layerIndex:i.layerIndex,markerIndex:i.markerIndex,dataIndex:i.dataIndex},n.isNullOrUndefined(r.latitudeValuePath)&&n.isNullOrUndefined(r.longitudeValuePath)?(c=r.dataSource[i.dataIndex],n.isNullOrUndefined(c.Longitude)||n.isNullOrUndefined(c.Latitude)?(r.dataSource[i.dataIndex].latitude=u.latitude,r.dataSource[i.dataIndex].longitude=u.longitude):(r.dataSource[i.dataIndex].Latitude=u.latitude,r.dataSource[i.dataIndex].Longitude=u.longitude)):(r.dataSource[i.dataIndex][r.latitudeValuePath]=u.latitude,r.dataSource[i.dataIndex][r.longitudeValuePath]=u.longitude),this.markerDragId="",this.markerDragArgument=null,this.trigger("markerDragEnd",u)),this.zoomModule&&this.isDevice&&(this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.scale,this.element.id+"_Zooming_"),this.zoomModule.removeToolbarClass("","","","","")),!1},i.prototype.mouseDownOnMap=function(t){var i,u,r;this.mouseDownEvent={x:t.x,y:t.y};-1!==t.type.indexOf("touch")&&t.changedTouches&&(this.mouseDownEvent={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY});this.isDevice&&!n.isNullOrUndefined(this.mapsTooltipModule)&&this.mapsTooltipModule.renderTooltip(t);i=t.target;this.markerDragId=i.id;u=document.getElementById(this.element.id+"_animated_tiles");(this.isTileMap&&!n.isNullOrUndefined(u)&&(this.currentTiles=u.cloneNode(!0)),-1===i.id.indexOf("_ToolBar"))&&(r=this.markerModule,(i.id.indexOf("shapeIndex")>-1||i.id.indexOf("Tile")>-1)&&this.mergeCluster(),r&&(r.markerClick(t),r.markerClusterClick(t)),this.bubbleModule&&this.bubbleModule.bubbleClick(t));this.notify(n.Browser.touchStartEvent,t)},i.prototype.mergeCluster=function(){this.markerModule&&this.markerModule.sameMarkerData.length>0&&(!this.zoomModule||this.zoomModule.isSingleClick)&&(vr(this.markerModule.sameMarkerData,this),this.markerModule.sameMarkerData=[])},i.prototype.mapsOnRightClick=function(t){var r=t.target,u=r.id,f=null,e=null,i,o;(this.mouseClickEvent=this.mouseDownEvent={x:t.x,y:t.y},-1===r.id.indexOf("_ToolBar"))&&(i=this.getClickLocation(u,t.pageX,t.pageY,r,t.layerX,t.layerY),n.isNullOrUndefined(i)||(f=i.latitude,e=i.longitude),o={cancel:!1,name:"rightClick",target:u,x:t.clientX,y:t.clientY,latitude:f,longitude:e,isShapeSelected:!1},this.trigger("rightClick",o))},i.prototype.mapsOnDoubleClick=function(n){var e;this.notify("dblclick",n);var t,i=n.target,o=i.id,f=0,r=null,u=null;-1===i.id.indexOf("_ToolBar")&&(-1===i.id.indexOf("_LayerIndex_")||this.isTileMap||this.mouseDownEvent.x!==n.clientX||this.mouseDownEvent.y!==n.clientY?this.isTileMap&&this.mouseDownEvent.x===n.clientX&&this.mouseDownEvent.y===n.clientY&&(r=(t=this.getTileGeoLocation(n.layerX,n.layerY)).latitude,u=t.longitude):(f=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),r=(t=this.getGeoLocation(f,n.layerX,n.layerY)).latitude,u=t.longitude),e={cancel:!1,name:"doubleClick",x:n.clientX,y:n.clientY,target:o,latitude:r,longitude:u,isShapeSelected:null},this.trigger("doubleClick",e))},i.prototype.mouseMoveOnMap=function(t){var i;i="touchmove"===t.type?t.target:i=t.target;this.mouseMoveEvent(t);this.markerModule&&(this.markerModule.markerMove(t),this.markerModule.markerClusterMouseMove(t));this.bubbleModule&&this.bubbleModule.bubbleMove(t);-1===i.id.indexOf("MarkerIndex")&&(document.getElementById(this.element.id+"_svg").style.cursor="auto");this.onMouseMove(t);this.notify(n.Browser.touchMoveEvent,t)},i.prototype.mouseMoveEvent=function(n){var r,i,u=n.target.id,t;this.isTileMap?(t=this.getTileGeoLocation(n.layerX,n.layerY),i={x:n.clientX,y:n.clientY,latitude:t.latitude,longitude:t.longitude,target:n.target}):(r=u.indexOf("_LayerIndex_")>-1?parseInt(u.split("_LayerIndex_")[1].split("_")[0],10):this.baseLayerIndex,t=this.getGeoLocation(r,n.clientX,n.clientY),i={x:n.clientX,y:n.clientY,latitude:t.latitude,longitude:t.longitude,target:n.target});this.trigger("mouseMove",i)},i.prototype.onMouseMove=function(t){var i,r,s=t.target,o;this.mouseMoveId=s.id;var e=null,u=0,f=0;return(-1===t.type.indexOf("touch")?(i=t.pageX,r=t.pageY,u=t.layerX,f=t.layerY-(this.isTileMap?10:0),this.titleTooltip(t,t.pageX,t.pageY),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)):(u=i=(e=t.touches)[0].clientX,f=r=e[0].clientY-(this.isTileMap?10:0)),n.isNullOrUndefined(this.markerDragArgument))||(o=this.markerDragArgument,this.mouseClickEvent.x=this.mouseDownEvent.x,this.mouseClickEvent.y=this.mouseDownEvent.y,this.getMarkerClickLocation(i,r,u,f,o,!1)),this.zoomModule&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.scale,t.target.id),!1},i.prototype.legendTooltip=function(n,t,i,r){var h,l,e=n.target.id,s=this.legendModule.currentPage,u=n.target.id.split("_Index_")[1],a,f;for(s=this.legendModule.totalPages.length<=this.legendModule.currentPage?this.legendModule.totalPages.length-1:this.legendModule.currentPage<0?0:this.legendModule.currentPage,a=0!==this.legendModule.totalPages.length?this.legendModule.totalPages[s].Collection.length:this.legendModule.totalPages.length,f=0;f<a;f++)h=(l=this.legendModule.totalPages[s].Collection[f]).DisplayText,e=n.target.id,u=n.target.id.split("_Index_")[1],e===this.element.id+"_Legend_Text_Index_"+u&&n.target.textContent.indexOf("...")>-1&&l.idIndex===parseInt(u,10)&&bi(h,this.legendSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Legend_Text_Tooltip",o(this.element.id+"_Secondary_Element"),r);e!==this.element.id+"_Legend_Text_Index_"+u&&c(this.element.id+"_EJ2_Legend_Text_Tooltip")},i.prototype.titleTooltip=function(n,t,i,r){var u=n.target.id;u===this.element.id+"_LegendTitle"&&n.target.textContent.indexOf("...")>-1?bi(this.legendSettings.title.text,this.legendSettings.titleStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_LegendTitle_Tooltip",o(this.element.id+"_Secondary_Element"),r):c(this.element.id+"_EJ2_LegendTitle_Tooltip");u===this.element.id+"_Map_title"&&n.target.textContent.indexOf("...")>-1?bi(this.titleSettings.text,this.titleSettings.textStyle.size||this.themeStyle.titleFontSize,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Title_Tooltip",o(this.element.id+"_Secondary_Element"),r):c(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.mapsOnResize=function(){var t=this,i;return this.isDestroyed||this.isExportInitialTileMap||(this.isResize=this.isReset=!0,i={cancel:!1,name:gu,previousSize:this.availableSize,currentSize:tr(this),maps:this},this.trigger(gu,i),i.cancel||(this.resizeTo&&clearTimeout(this.resizeTo),!n.isNullOrUndefined(this.element)&&this.element.classList.contains("e-maps")&&(this.resizeTo=setTimeout(function(){t.unWireEVents();t.createSVG();t.refreshing=!0;t.wireEVents();t.render();t.refreshing=!1},500)))),!1},i.prototype.zoomByPosition=function(t,i){if(!this.isDestroyed){this.zoomNotApplied=this.isMarkerZoomCompleted=!1;var r=this.zoomSettings.zoomFactor===i;this.previousProjection=null;!this.isTileMap&&this.zoomModule?n.isNullOrUndefined(t)?(this.zoomSettings.zoomFactor=i,this.isZoomByPosition=!0,this.mapScaleValue=null):(this.zoomSettings.zoomFactor=i,r=this.centerPosition.latitude===t.latitude&&this.centerPosition.longitude===t.longitude||r,this.centerPosition=t,this.isZoomByPosition=!0,this.mapScaleValue=null):this.zoomModule&&(this.tileZoomLevel=this.zoomSettings.zoomFactor=i,r=this.centerPosition.latitude===t.latitude&&this.centerPosition.longitude===t.longitude||r,this.centerPosition=t,this.isZoomByPosition=!0);r&&this.refresh()}},i.prototype.panByDirection=function(n,t){if(!this.isDestroyed){var i=0,r=0;switch(n){case"Left":i=-this.mapAreaRect.width/7;break;case"Right":i=this.mapAreaRect.width/7;break;case"Top":r=-this.mapAreaRect.height/7;break;case"Bottom":r=this.mapAreaRect.height/7}this.zoomModule&&this.zoomModule.panning(n,i,r,t)}},i.prototype.addLayer=function(n){if(!this.isDestroyed){var t=this.layers;t.push(n);this.isAddLayer=!0;this.layers=t}},i.prototype.removeLayer=function(n){if(!this.isDestroyed){var t=this.layers;t.splice(n,1);this.layers=t}},i.prototype.addMarker=function(t,i){var r,u,f,e,o;if(!this.isDestroyed&&!n.isNullOrUndefined(this.markerModule))if(n.isNullOrUndefined(t)||n.isNullOrUndefined(i)){for(r=0;r<this.layers.length;r++)u=document.getElementById(this.element.id+"_LayerIndex_"+r),this.markerModule.zoomedMarkerCluster[r]=[],this.markerModule.initialMarkerCluster[r]=[],this.markerModule.markerRender(this,u,r,this.isTileMap?this.tileZoomLevel:this.mapLayerPanel.currentFactor,null);this.arrangeTemplate()}else if(u=document.getElementById(this.element.id+"_LayerIndex_"+t),i.length>0&&u){for(f=0,e=i;f<e.length;f++)o=e[f],this.layersCollection[t].markerSettings.push(new du(this,"markerSettings",o));this.markerModule.markerRender(this,u,t,this.isTileMap?this.tileZoomLevel:this.mapLayerPanel.currentFactor,"AddMarker");this.arrangeTemplate()}},i.prototype.shapeSelection=function(t,i,r,u){var s,e,h,y,nt,k;if(!this.isDestroyed&&!n.isNullOrUndefined(this.layers[t])){var f=void 0,d=void 0,a=Array.isArray(i)?i:Array(i);if(n.isNullOrUndefined(u)&&(u=!0),s=this.layers[t].selectionSettings,!s.enableMultiSelect&&this.legendSelection&&u&&this.removeShapeSelection(),"SubLayer"===this.layers[t].type)for(e=0;e<this.layersCollection.length;e++)if(this.layersCollection[e].shapeData===this.layers[t].shapeData){d=e;break}if(!n.isNullOrUndefined(s)&&s.enable){var p=void 0,w=void 0,b=void 0,g=void 0,v=void 0,c=this.layers[t].shapeData.features;for(e=0;e<c.length;e++)for(h=0;h<a.length;h++)if(y=void 0,(!n.isNullOrUndefined(c[e].properties[a[h]])&&isNaN(c[e].properties[a[h]])?c[e].properties[a[h]].toLowerCase():c[e].properties[a[h]])===(n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toLowerCase()))if(n.isNullOrUndefined(this.layers[t].shapeSettings.colorValuePath)||(y=ct(this.layers[t].dataSource,c[e].properties,this.layers[t].shapeDataPath,this.layers[t].shapePropertyPath,this.layers[t])),nt=this.layers[t],this.baseLayerIndex>=0&&nt.isBaseLayer?b=0:"SubLayer"===this.layers[t].type&&(b=d),f=o(this.element.id+"_LayerIndex_"+b+"_shapeIndex_"+e+"_dataIndex_"+y),n.isNullOrUndefined(y)&&n.isNullOrUndefined(f)&&(f=o(this.element.id+"_LayerIndex_"+t+"_shapeIndex_"+e+"_dataIndex_null")),w=parseInt(f.id.split("_shapeIndex_")[1].split("_")[0],10),g=this.layers[t].shapeData.features.length>w?this.layers[t].shapeData.features[w].properties:null,p=parseInt(f.id.split("_dataIndex_")[1].split("_")[0],10),v=n.isNullOrUndefined(p)?null:this.layers[t].dataSource[p],u){if(te(s,this,f,g,v),this.shapeSelectionClass=o("ShapeselectionMap"),this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&this.legendModule.shapeHighLightAndSelection(f,v,s,"selection",t),(!this.legendSettings.visible||this.legendModule.shapeToggled)&&(f.setAttribute("class","ShapeselectionMapStyle"),-1===this.selectedElementId.indexOf(f.getAttribute("id"))&&this.selectedElementId.push(f.getAttribute("id")),!s.enableMultiSelect))return}else(this.legendSelection=!s.enableMultiSelect&&!this.legendSelection||this.legendSelection,this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&"ShapeselectionMapStyle"===f.getAttribute("class")&&this.legendModule.shapeHighLightAndSelection(f,v,s,"selection",t),!this.legendSettings.visible||this.legendModule.shapeToggled)&&(l(f),k=this.selectedElementId.indexOf(f.getAttribute("id")),-1!==k&&(this.selectedElementId.splice(k,1),!s.enableMultiSelect&&this.legendSelection&&this.selectedElementId.length>0&&this.removeShapeSelection()))}}},i.prototype.zoomToCoordinates=function(t,i,r,u){var s,h,f,l;if(!this.isDestroyed){this.isMarkerZoomCompleted=!1;var e=void 0,o=void 0,c=!1;this.centerPosition={latitude:null,longitude:null};this.isZoomByPosition=!1;(n.isNullOrUndefined(r)&&n.isNullOrUndefined(u)||n.isNullOrUndefined(t)&&n.isNullOrUndefined(i))&&(t=n.isNullOrUndefined(t)?0:t,i=n.isNullOrUndefined(t)?0:i,r=n.isNullOrUndefined(r)?t:r,u=n.isNullOrUndefined(u)?i:u,c=!0);t>r&&(t=(s=[r,t])[0],r=s[1]);i>u&&(i=(h=[u,i])[0],u=h[1]);c?(e=t+r,o=i+u):(e=(t+r)/2,o=(i+u)/2);this.centerLatOfGivenLocation=e;this.centerLongOfGivenLocation=o;this.minLatOfGivenLocation=t;this.minLongOfGivenLocation=i;this.maxLatOfGivenLocation=r;this.maxLongOfGivenLocation=u;this.zoomNotApplied=!0;this.scaleOfGivenLocation=pu(t,r,i,u,this.mapAreaRect.width,this.mapAreaRect.height,this,!0);f=this.getMinMaxLatitudeLongitude();l={cancel:!1,name:"zoom",type:"zoomIn",maps:this,tileTranslatePoint:{},translatePoint:{},tileZoomLevel:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{},scale:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{previous:this.scale,current:this.scaleOfGivenLocation},minLatitude:f.minLatitude,maxLatitude:f.maxLatitude,minLongitude:f.minLongitude,maxLongitude:f.maxLongitude};this.trigger("zoom",l);this.refresh()}},i.prototype.removeShapeSelection=function(){for(var i,t=this.selectedElementId.length,n=0;n<t;n++)l(r(this.selectedElementId[0])),this.selectedElementId.splice(0,1);if(this.legendSettings.visible)for(i=this.legendSelectionCollection.length,n=0;n<i;n++)l(r(this.legendSelectionCollection[n].legendElement.id)),this.selectedLegendElementId.splice(0,1);this.shapeSelectionItem=[];this.legendSelectionCollection=[]},i.prototype.setCulture=function(){this.intl=new n.Internationalization;this.setLocaleConstants();this.localeObject=new n.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},i.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ImageNotFound:"Image Not Found"}},i.prototype.destroy=function(){this.unWireEVents();n.isNullOrUndefined(this.mapsTooltipModule)||this.mapsTooltipModule.removeEventListener();n.isNullOrUndefined(this.bingMap)||this.bingMap.destroy();t.prototype.destroy.call(this);this.shapeSelectionItem=[];this.toggledElementId=[];this.toggledLegendId=[];this.legendSelectionCollection=[];this.selectedLegendElementId=[];this.selectedNavigationElementId=[];this.selectedBubbleElementId=[];this.selectedMarkerElementId=[];this.selectedElementId=[];this.dataLabelShape=[];this.zoomShapeCollection=[];this.zoomLabelPositions=[];this.mouseDownEvent={x:null,y:null};this.mouseClickEvent={x:null,y:null};this.formatFunction=null;this.localeObject=null;this.defaultLocalConstants=null;this.intl=null;this.mapAreaRect=null;this.layersCollection=null;this.themeStyle=null;this.totalRect=null;this.baseSize=null;this.baseMapBounds=null;this.baseMapRectBounds=null;this.baseTranslatePoint=null;this.baseTileTranslatePoint=null;this.markerZoomCenterPoint=null;this.currentTiles=null;this.serverProcess=null;this.toolbarProperties=null;this.zoomLabelPositions=null;this.resizeEvent=null;this.availableSize=null;document.getElementById("mapsmeasuretext")&&document.getElementById("mapsmeasuretext").remove();this.removeSvg();this.svgObject=null;this.mapLayerPanel=null;this.renderer=null;this.translatePoint=null;this.tileTranslatePoint=null;this.previousPoint=null;this.dataLabelShape=[];this.zoomShapeCollection=[];this.selectedElementId=[];this.selectedMarkerElementId=[];this.selectedBubbleElementId=[];this.shapeSelectionClass=null;this.markerSelectionClass=null;this.bubbleSelectionClass=null;this.navigationSelectionClass=null;this.selectedNavigationElementId=[];this.polygonSelectionClass=null;this.selectedPolygonElementId=[];this.legendSelectionClass=null;this.previousTranslate=null;this.initialTileTranslate=null;this.markerDragArgument=null},i.prototype.getModuleName=function(){return"maps"},i.prototype.getPersistData=function(){return this.addOnPersist(["translatePoint","zoomSettings","mapScaleValue","tileTranslatePoint","baseTranslatePoint","scale","zoomPersistence","defaultState","markerZoomedState","initialCheck","initialZoomLevel","initialTileTranslate","applyZoomReset","markerZoomFactor"])},i.prototype.onPropertyChanged=function(i,r){var s,y,u,e,h,p;if(!this.isDestroyed){for(var f=!1,l=!1,a=!1,o=0,v=Object.keys(i);o<v.length;o++){s=v[o];switch(s){case"background":this.renderBorder();break;case"height":case"width":case"layers":case"projectionType":case"centerPosition":case"legendSettings":case"baseLayerIndex":if("layers"===s)for(a=!0,y=Object.keys(i.layers).length,u=0;u<y;u++)if(!n.isNullOrUndefined(i.layers[u]))for(e=0,h=Object.keys(i.layers[u]);e<h.length;e++)p=h[e],n.isNullOrUndefined(this.layers[u].shapeData)&&!n.isNullOrUndefined(this.layers[u].urlTemplate)&&""!==this.layers[u].urlTemplate?this.isReset=!0:"markerSettings"===p&&(l=!0);f=!0;break;case"zoomSettings":n.isNullOrUndefined(r.zoomSettings)||(i.zoomSettings.zoomFactor===r.zoomSettings.zoomFactor||a?i.zoomSettings.shouldZoomInitially!==r.zoomSettings.shouldZoomInitially?(this.zoomSettings.zoomFactor=1,this.previousProjection=null,this.scale=this.isMarkerZoomCompleted?null:this.scale,this.isMarkerZoomCompleted=!i.zoomSettings.shouldZoomInitially,f=!0):i.zoomSettings.enable!==r.zoomSettings.enable?(this.zoomSettings.zoomFactor=1,f=!0):f=!0:f=!1);break;case"locale":case"currencyCode":t.prototype.refresh.call(this)}}f&&(i.layers&&l?(c(this.element.id+"_Markers_Group"),this.isTileMap?this.mapLayerPanel.renderTileLayer(this.mapLayerPanel,this.layers.currentFactor,this.layers.length-1):this.render()):(this.createSVG(),this.renderElements()))}},i.prototype.requiredModules=function(){var n=[],t=this.findVisibleLayers(this.layers),i=!1;return this.annotations.map(function(n){i=null!=n.content}),this.isBubbleVisible()&&n.push({member:"Bubble",args:[this],name:"Bubble"}),t.highlight&&n.push({member:"Highlight",args:[this],name:"Highlight"}),t.selection&&n.push({member:"Selection",args:[this],name:"Selection"}),this.legendSettings.visible&&n.push({member:"Legend",args:[this],name:"Legend"}),(this.zoomSettings.enable||this.zoomSettings.zoomFactor>this.zoomSettings.minZoom)&&n.push({member:"Zoom",args:[this],name:"Zoom"}),this.isMarkersVisible()&&n.push({member:"Marker",args:[this],name:"Marker"}),this.isDataLabelVisible()&&n.push({member:"DataLabel",args:[this],name:"DataLabel"}),this.isNavigationVisible()&&n.push({member:"NavigationLine",args:[this],name:"NavigationLine"}),this.isPolygonVisible()&&n.push({member:"Polygon",args:[this],name:"Polygon"}),t.tooltip&&n.push({member:"MapsTooltip",args:[this],name:"MapsTooltip"}),i&&n.push({member:"Annotations",args:[this,kf],name:"Annotations"}),this.allowPrint&&n.push({member:"Print",args:[this],name:"Print"}),this.allowImageExport&&n.push({member:"ImageExport",args:[this],name:"ImageExport"}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this],name:"PdfExport"}),n},i.prototype.isMarkersVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.markerSettings.length;i++)if(t.markerSettings[i].visible){n=!0;break}}),n},i.prototype.isDataLabelVisible=function(){for(var t=!1,n=0;n<this.layers.length;n++)if(this.layers[n].dataLabelSettings.visible){t=!0;break}return t},i.prototype.isNavigationVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.navigationLineSettings.length;i++)if(t.navigationLineSettings[i].visible){n=!0;break}}),n},i.prototype.isPolygonVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.polygonSettings.polygons.length;i++)if(t.polygonSettings.polygons.length>0){n=!0;break}}),n},i.prototype.isBubbleVisible=function(){for(var r,t=!1,n=0,i=this.layers;n<i.length;n++)if(r=i[n],this.getBubbleVisible(r)){t=!0;break}return t},i.prototype.getBubbleVisible=function(n){for(var i=!1,t=0,r=n.bubbleSettings;t<r.length;t++)if(r[t].visible){i=!0;break}return i},i.prototype.print=function(n){this.allowPrint&&this.printModule&&!this.isDestroyed&&this.printModule.print(this,n)},i.prototype.export=function(t,i,r,u){var f=this;if(!this.isDestroyed){if(n.isNullOrUndefined(u)&&(u=!0),"PDF"!==t&&this.allowImageExport&&this.imageExportModule)return new Promise(function(n){n(f.imageExportModule.export(f,t,i,u))});if(this.allowPdfExport&&this.pdfExportModule)return new Promise(function(n){n(f.pdfExportModule.export(f,t,i,u,r))})}return null},i.prototype.getBingUrlTemplate=function(t){var i;return this.isDestroyed||(i=new Promise(function(i){var r=new n.Fetch({url:t});r.onSuccess=function(n){var t=n.resourceSets[0].resources[0];i(t.imageUrl)};r.send()})),i},i.prototype.findVisibleLayers=function(t,i,r,u,f,e){var tt,it,rt,l,w,o,a,b,s,v,k,d,y,g,h,p,nt,c;for(void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),void 0===f&&(f=!1),void 0===e&&(e=!1),l=0,w=t;l<w.length;l++){if(o=w[l],i=o.visible||i,o.visible){for(tt=o.bubbleSettings,it=o.markerSettings,rt=o.polygonSettings,a=0,b=o.navigationLineSettings;a<b.length;a++)s=b[a],s.visible&&(f=!n.isNullOrUndefined(s.highlightSettings)&&s.highlightSettings.enable||f,e=!n.isNullOrUndefined(s.selectionSettings)&&s.selectionSettings.enable||e);for(v=0,k=rt.polygons;v<k.length;v++)d=k[v],!n.isNullOrUndefined(d.points)&&d.points.length>0&&(f=o.polygonSettings.highlightSettings.enable||f,e=o.polygonSettings.selectionSettings.enable||e,u=o.polygonSettings.tooltipSettings.visible||u);for(y=0,g=it;y<g.length;y++)if(h=g[y],h.visible&&(u=h.tooltipSettings.visible||u,f=h.selectionSettings.enable||f,e=h.highlightSettings.enable||e),u)break;for(p=0,nt=tt;p<nt.length;p++)if(c=nt[p],c.visible&&(u=c.tooltipSettings.visible||u,f=c.selectionSettings.enable||f,e=c.highlightSettings.enable||e),u)break;u=o.tooltipSettings.visible||u;f=o.selectionSettings.enable||f;e=o.highlightSettings.enable||e}if(i&&r&&u)break}return{layer:i,bubble:r,tooltip:u,selection:f,highlight:e}},i.prototype.getGeoLocation=function(n,t,i){var f=null,e=null;if(!this.isDestroyed&&!this.isTileMap){var r=document.getElementById(this.element.id),o=this.element.getBoundingClientRect(),h=t-r.offsetLeft-(o.left-r.offsetLeft)-window.scrollX,c=i-r.offsetTop-(o.top-r.offsetTop)-window.scrollY,s=ut(this,this.layersCollection[n],!1).location,l=s.x*this.scale,a=s.y*this.scale,u=Math.min(this.mapAreaRect.height,this.mapAreaRect.width)*this.mapLayerPanel.currentFactor*this.scale,v=this.clip(h-l,0,u-1)/u-.5,y=.5-this.clip(c-a,0,u-1)/u;f=90-360*Math.atan(Math.exp(2*-y*Math.PI))/Math.PI;e=360*v}return{latitude:f,longitude:e}},i.prototype.clip=function(n,t,i){return Math.min(Math.max(n,t),i)},i.prototype.getTileGeoLocation=function(t,i){var f=null,e=null,r,u;return this.isTileMap&&(r=document.getElementById(this.element.id+"_tile_parent"),this.isDestroyed||n.isNullOrUndefined(r)||(u=this.pointToLatLong(t+this.mapAreaRect.x-r.offsetLeft,i+this.mapAreaRect.y-r.offsetTop),f=u.latitude,e=u.longitude)),{latitude:f,longitude:e}},i.prototype.pointToLatLong=function(t,i){var u=0,f=0;if(!this.isDestroyed&&!n.isNullOrUndefined(this.translatePoint)){i=n.isNullOrUndefined(this.markerDragArgument)?i:i+10;var r=256*Math.pow(2,this.tileZoomLevel),e=this.clip(t-this.translatePoint.x*this.scale,0,r-1)/r-.5,o=.5-this.clip(i-this.translatePoint.y*this.scale,0,r-1)/r;u=90-360*Math.atan(Math.exp(2*-o*Math.PI))/Math.PI;f=360*e}return{latitude:u,longitude:f}},u([n.Property(null)],i.prototype,"background",void 0),u([n.Property(!1)],i.prototype,"useGroupingSeparator",void 0),u([n.Property(null)],i.prototype,"format",void 0),u([n.Property(null)],i.prototype,"width",void 0),u([n.Property(null)],i.prototype,"height",void 0),u([n.Property("MouseMove")],i.prototype,"tooltipDisplayMode",void 0),u([n.Property(!1)],i.prototype,"allowPrint",void 0),u([n.Property(!1)],i.prototype,"allowImageExport",void 0),u([n.Property(!1)],i.prototype,"allowPdfExport",void 0),u([n.Complex({},no)],i.prototype,"titleSettings",void 0),u([n.Complex({},to)],i.prototype,"zoomSettings",void 0),u([n.Complex({},io)],i.prototype,"legendSettings",void 0),u([n.Collection([],fo)],i.prototype,"layers",void 0),u([n.Collection([],fe)],i.prototype,"annotations",void 0),u([n.Complex({},ae)],i.prototype,"margin",void 0),u([n.Complex({color:"#DDDDDD",width:0},k)],i.prototype,"border",void 0),u([n.Property("Material")],i.prototype,"theme",void 0),u([n.Property("Mercator")],i.prototype,"projectionType",void 0),u([n.Property(0)],i.prototype,"baseLayerIndex",void 0),u([n.Property(null)],i.prototype,"description",void 0),u([n.Property(0)],i.prototype,"tabIndex",void 0),u([n.Complex({latitude:null,longitude:null},ce)],i.prototype,"centerPosition",void 0),u([n.Complex({},oo)],i.prototype,"mapsArea",void 0),u([n.Event()],i.prototype,"load",void 0),u([n.Event()],i.prototype,"beforePrint",void 0),u([n.Event()],i.prototype,"loaded",void 0),u([n.Event()],i.prototype,"click",void 0),u([n.Event()],i.prototype,"onclick",void 0),u([n.Event()],i.prototype,"doubleClick",void 0),u([n.Event()],i.prototype,"rightClick",void 0),u([n.Event()],i.prototype,"resize",void 0),u([n.Event()],i.prototype,"tooltipRender",void 0),u([n.Event()],i.prototype,"legendRendering",void 0),u([n.Event()],i.prototype,"tooltipRenderComplete",void 0),u([n.Event()],i.prototype,"shapeSelected",void 0),u([n.Event()],i.prototype,"itemSelection",void 0),u([n.Event()],i.prototype,"itemHighlight",void 0),u([n.Event()],i.prototype,"shapeHighlight",void 0),u([n.Event()],i.prototype,"layerRendering",void 0),u([n.Event()],i.prototype,"shapeRendering",void 0),u([n.Event()],i.prototype,"markerRendering",void 0),u([n.Event()],i.prototype,"markerClusterRendering",void 0),u([n.Event()],i.prototype,"markerClick",void 0),u([n.Event()],i.prototype,"markerDragStart",void 0),u([n.Event()],i.prototype,"markerDragEnd",void 0),u([n.Event()],i.prototype,"markerClusterClick",void 0),u([n.Event()],i.prototype,"markerClusterMouseMove",void 0),u([n.Event()],i.prototype,"markerMouseMove",void 0),u([n.Event()],i.prototype,"mouseMove",void 0),u([n.Event()],i.prototype,"dataLabelRendering",void 0),u([n.Event()],i.prototype,"bubbleRendering",void 0),u([n.Event()],i.prototype,"bubbleClick",void 0),u([n.Event()],i.prototype,"bubbleMouseMove",void 0),u([n.Event()],i.prototype,"animationComplete",void 0),u([n.Event()],i.prototype,"annotationRendering",void 0),u([n.Event()],i.prototype,"zoom",void 0),u([n.Event()],i.prototype,"pan",void 0),u([n.Event()],i.prototype,"panComplete",void 0),u([n.Event()],i.prototype,"zoomComplete",void 0),u([n.NotifyPropertyChanges],i)}(n.Component),lo=function(){function t(n){this.id="";this.maps=n;this.bubbleCollection=[]}return t.prototype.renderBubble=function(t,i,r,u,f,e,o,s,c,l){var ot,vt,y=this,g=s.layerData,nt=t.colorValuePath,gt=n.isNullOrUndefined(nt)?i[nt]:nt.indexOf(".")>-1?h(i,t.colorValuePath):i[nt],ni=n.isNullOrUndefined(nt)?Number(i[nt]):nt.indexOf(".")>-1?Number(h(i,t.colorValuePath)):Number(i[nt]),ti=n.isNullOrUndefined(t.valuePath)?Number(i[t.valuePath]):t.valuePath.indexOf(".")>-1?Number(h(i,t.valuePath)):Number(i[t.valuePath]),rt,pt,ii,st,ei,wt,w,it,p,tt,ft,dt,lt,et;if(isNaN(ti)&&isNaN(ni)&&n.isNullOrUndefined(gt))return null;w=(rt=t.minRadius,pt=t.maxRadius,ii=ti,st=u.min,wt=(pt-rt)/100*100/((ei=u.max)-st)*(ii-st)+rt,ei===st&&(wt=(pt-rt)/100+rt),wt);it=new bf(this.maps).getColorByValue(t.colorMapping,ni,gt);vt="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.fill)?r:it.fill;ot="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.opacity)?t.opacity:it.opacity;p=[[]];this.maps.translateType="bubble";for(var kt=0,ht=0,ct=0,k=0,hi=g.length;k<hi;k++)if(tt=g[k],tt=tt.property,ft=fi(i[s.shapeDataPath],s.shapePropertyPath,tt),(!n.isNullOrUndefined(i[s.shapeDataPath])&&isNaN(i[s.shapeDataPath])?i[s.shapeDataPath].toLowerCase():i[s.shapeDataPath])===(!n.isNullOrUndefined(tt[ft])&&isNaN(tt[ft])?tt[ft].toLowerCase():tt[ft])&&"LineString"!==g[k].type&&"MultiLineString"!==g[k].type&&"Point"!==g[k].type&&"MultiPoint"!==g[k].type)if(g[k]._isMultiPolygon)for(dt=g[k],lt=0;lt<dt.length;lt++)p.push(this.getPoints(dt[lt],[])),ht<(ct=p[p.length-1].length)&&(ht=ct,kt=p.length-1);else p.push(this.getPoints(g[k],[])),ht<(ct=p[p.length-1].length)&&(ht=ct,kt=p.length-1);var oi,v,ci=this.maps.projectionType,si={color:t.border.color,opacity:t.border.opacity,width:t.border.width},at=wi(p[kt],ci,s.geometryType);if(t.visible){if(n.isNullOrUndefined(at)){if(et=p.length-1,!p[et].x||!p[et].y)return;v={cancel:!1,name:hf,border:si,cx:p[et].x,cy:p[et].y,data:i,fill:vt,maps:this.maps,radius:w}}else oi="Mercator"===this.maps.projectionType?at.y:-at.y,v={cancel:!1,name:hf,border:si,cx:at.x,cy:oi,data:i,fill:vt,maps:this.maps,radius:w};this.maps.trigger("bubbleRendering",v,function(){var i,u,p,k,g,h,it;if(!v.cancel){(v.border.opacity=n.isNullOrUndefined(v.border.opacity)?ot:v.border.opacity,"Circle"===t.bubbleType)?(p=new yt(l,v.fill,v.border,ot,0,0,v.radius,null),i=function(n,t,i){return ui(n.renderer.drawCircle(t),i)}(y.maps,p,c)):(k="Mercator"===y.maps.projectionType?v.cy-w:v.cy+w,g=new d(l,v.fill,v.border,ot,new a(0,0,2*w,2*w),2,2),v.cx-=w,v.cy=k,i=function(n,t,i){return ui(n.renderer.drawRectangle(t),i)}(y.maps,g,c));ri(y.maps.selectedBubbleElementId,y.maps.bubbleSelectionClass,i,"BubbleselectionMapStyle");y.bubbleCollection.push({LayerIndex:o,BubbleIndex:f,DataIndex:e,element:i,center:{x:v.cx,y:v.cy}});h=0!==s.animationDuration||"Enable"===n.animationMode||n.isNullOrUndefined(y.maps.zoomModule);u=y.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(y.maps.zoomModule)&&!y.maps.isTileMap?bt(y.maps,s,h):ut(y.maps,s,h);var rt=t.dataSource,nt=u.scale,tt=u.location,r=new b(y.maps.isTileMap?(v.cx+y.maps.translatePoint.x)*y.maps.tileZoomLevel:(v.cx+tt.x)*nt,y.maps.isTileMap?(v.cy+y.maps.translatePoint.y)*y.maps.tileZoomLevel:(v.cy+tt.y)*nt);i.setAttribute("transform","translate( "+r.x+" "+r.y+" )");it=rt.length-1===e?"bubble":null;"Square"===t.bubbleType?(r.x+=w,r.y+=w*("Mercator"===y.maps.projectionType?1:-1)):w=0;(t.animationDuration>0||"Enable"===n.animationMode)&&iu(i,t.animationDelay,t.animationDuration,r,y.maps,it,w)}})}},t.prototype.getPoints=function(t,i){return n.isNullOrUndefined(t.map)?i=t.point:t.map(function(n){i.push(new f(n.point.x,n.point.y))}),i},t.prototype.bubbleClick=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:cf,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(cf,u)))},t.prototype.getbubble=function(n){var t=n.split("_LayerIndex_"),r=parseInt(t[1].split("_")[0],10);if(n.indexOf("_BubbleIndex_")>-1){var u=this.maps.layers[r],i=parseInt(t[1].split("_BubbleIndex_")[1],10),f=parseInt(t[1].split("_BubbleIndex_")[1].split("_dataIndex_")[1],10);if(!isNaN(i))return u.bubbleSettings[i].dataSource[f]}return null},t.prototype.bubbleMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:lf,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(lf,u)))},t.prototype.getModuleName=function(){return"Bubble"},t.prototype.destroy=function(){this.bubbleCollection=[];this.maps=null},t}(),ao=function(){function t(n){this.maps=n;this.sameMarkerData=[];this.initialMarkerCluster=[];this.zoomedMarkerCluster=[]}return t.prototype.getMapsInstance=function(){return this.maps},t.prototype.markerRender=function(t,i,u,f,e){var s=this,w=0,d=0,p=!1,g=0,o,c,l,k,a,y,nt;t.translateType="marker";o=t.layersCollection[u];c=i.querySelectorAll("#"+t.element.id+"_Markers_Group");c.length>0?(this.markerSVGObject=c[0],this.markerSVGObject.innerHTML="",p=!0):this.markerSVGObject=t.renderer.createGroup({id:t.element.id+"_Markers_Group","class":"GroupElement"});this.markerSVGObject.style.pointerEvents="auto";k=r(t.element.id+"_Secondary_Element").querySelectorAll("#"+t.element.id+"_LayerIndex_"+u+"_Markers_Template_Group");k&&k.length>0&&k[0].childElementCount>0?((l=r(t.element.id+"_LayerIndex_"+u+"_Markers_Template_Group")).innerHTML="",p=!0):(l=n.createElement("div",{id:t.element.id+"_LayerIndex_"+u+"_Markers_Template_Group",className:t.element.id+"_template"})).style.cssText="overflow: hidden; position: absolute;pointer-events: none;top:"+t.mapAreaRect.y+"px;left:"+t.mapAreaRect.x+"px;height:"+t.mapAreaRect.height+"px;width:"+t.mapAreaRect.width+"px;";y=this.allowInnerClusterSetting(o);nt=0!==o.animationDuration||"Enable"===n.animationMode||n.isNullOrUndefined(t.zoomModule);t.isTileMap||(a=!n.isNullOrUndefined(t.zoomModule)&&t.zoomSettings.zoomFactor>1?bt(t,o,nt):ut(t,o,nt));Array.prototype.forEach.call(o.markerSettings,function(k,nt){var tt=k.dataSource;w=0;n.isNullOrUndefined(k.dataSource)||Array.prototype.forEach.call(tt,function(rt,ut){t.markerNullCount=nt>0&&0===ut?0:t.markerNullCount;var ft={cancel:!1,name:rf,fill:k.fill,height:n.isNullOrUndefined(k.heightValuePath)||n.isNullOrUndefined(rt[k.heightValuePath])?k.height:rt[k.heightValuePath],width:n.isNullOrUndefined(k.widthValuePath)||n.isNullOrUndefined(rt[k.widthValuePath])?k.width:rt[k.widthValuePath],imageUrl:k.imageUrl,shape:k.shape,template:k.template,data:rt,maps:t,marker:k,border:k.border,colorValuePath:k.colorValuePath,shapeValuePath:k.shapeValuePath,imageUrlValuePath:k.imageUrlValuePath};t.trigger("markerRendering",ft,function(){var ht,et,ct,lt;ft=pi(ft=yi(ft,rt),rt);var ot=n.isNullOrUndefined(k.longitudeValuePath)?n.isNullOrUndefined(rt.longitude)?n.isNullOrUndefined(rt.Longitude)?null:parseFloat(rt.Longitude):parseFloat(rt.longitude):Number(h(rt,k.longitudeValuePath)),st=n.isNullOrUndefined(k.latitudeValuePath)?n.isNullOrUndefined(rt.latitude)?n.isNullOrUndefined(rt.Latitude)?null:parseFloat(rt.Latitude):parseFloat(rt.latitude):Number(h(rt,k.latitudeValuePath)),vt=k.offset;ft.cancel||!k.visible||n.isNullOrUndefined(ot)||n.isNullOrUndefined(st)||(ht=t.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+nt+"_dataIndex_"+ut,et=t.isTileMap?it(new b(ot,st),f,t.tileTranslatePoint,!0):v(st,ot,f,o,t),t.isTileMap&&(a="SubLayer"===o.type&&n.isNullOrUndefined(t.zoomModule)?et=it(new b(ot,st),t.tileZoomLevel,t.tileTranslatePoint,!0):{}),ct="AddMarker"===e?t.scale:a.scale,lt="AddMarker"===e?t.translatePoint:a.location,!ft.template||isNaN(et.x)||isNaN(et.y)?ft.template||isNaN(et.x)||isNaN(et.y)||(p=!0,w++,pr(ft,k,tt,ut,et,lt,ht,vt,ct,t,s.markerSVGObject)):(p=!1,g++,wr(ft,void 0,ht,rt,nt,l,et,lt,ct,vt,t),t.renderReactTemplates()));d+=isNaN(st)||isNaN(ot)?1:0;g+=ft.cancel?1:0;w+=ft.cancel?1:0;t.markerNullCount=n.isNullOrUndefined(ot)||n.isNullOrUndefined(st)?t.markerNullCount+1:t.markerNullCount;var yt=tt.length-t.markerNullCount,at=!1,pt=k.clusterSettings.allowClustering||o.markerClusterSettings.allowClustering&&o.markerSettings.length>1?s.markerSVGObject.querySelectorAll("[id*='LayerIndex_"+u+"_MarkerIndex_"+nt+"']:not([id*='_Group'])"):s.markerSVGObject.childNodes,bt=s.markerSVGObject.childNodes===pt?g:0;pt.length===yt-bt-d&&"Template"!==e&&(0===c.length&&i.appendChild(s.markerSVGObject),(k.clusterSettings.allowClustering||!y&&o.markerClusterSettings.allowClustering)&&(0===c.length&&(t.svgObject.appendChild(s.markerSVGObject),t.element.appendChild(t.svgObject)),-1!==o.urlTemplate.indexOf("openstreetmap")&&n.isNullOrUndefined(o.shapeData)&&t.zoomSettings.enable?(at=wt(o,s.markerSVGObject,t,u,nt,s.markerSVGObject,i,!0,!1,null,y),0===c.length&&i.appendChild(s.markerSVGObject)):at=wt(o,s.markerSVGObject,t,u,nt,s.markerSVGObject,i,!0,!1,a,y),t.renderReactTemplates()));(k.clusterSettings.allowClustering||o.markerClusterSettings.allowClustering&&o.markerSettings.length>1?l.querySelectorAll("[id*='LayerIndex_"+u+"_MarkerIndex_"+nt+"']:not([id*='_Group'])"):l.childNodes).length===yt-w-d&&r(t.element.id+"_Secondary_Element")&&(p||r(t.element.id+"_Secondary_Element").appendChild(l),t.checkInitialRender&&(k.clusterSettings.allowClustering||!y&&o.markerClusterSettings.allowClustering)&&!at&&(wt(o,l,t,u,nt,s.markerSVGObject,i,!1,!1,a,y),t.renderReactTemplates()),o.markerClusterSettings.allowClustering&&c.length>0&&r(t.element.id+"_Layer_Collections").appendChild(i))})})})},t.prototype.calculateIndividualLayerMarkerZoomLevel=function(n,t,i){var r,u,o=Math.abs(this.maps.baseMapBounds.latitude.max-this.maps.baseMapBounds.latitude.min),s=Math.abs(this.maps.baseMapBounds.longitude.max-this.maps.baseMapBounds.longitude.min),e,f;return r=(r=Math.floor(Math.log(t/o)))>i?i:r,u=(u=Math.floor(Math.log(n/s)))>i?i:u,e=Math.min(r,u),f=Math.min(e,i-1),this.maps.isTileMap||yu(f,this.maps),f},t.prototype.calculateZoomCenterPositionAndFactor=function(t){var o;if(!n.isNullOrUndefined(this.maps))if(this.maps.zoomSettings.shouldZoomInitially&&this.maps.markerModule){var r,u,f,e,i=void 0,s=void 0,h=void 0,a=this.maps.zoomSettings.maxZoom,c=this.maps.mapAreaRect.width,l=this.maps.mapAreaRect.height;(this.maps.markerZoomedState=this.maps.markerZoomedState?this.maps.markerZoomedState:n.isNullOrUndefined(this.maps.markerZoomFactor)?!this.maps.markerZoomedState:this.maps.markerZoomFactor>1?this.maps.markerZoomedState:!this.maps.markerZoomedState,this.maps.defaultState=this.maps.markerZoomedState?!this.maps.markerZoomedState:this.maps.defaultState,Array.prototype.forEach.call(t,function(t){0!==t.markerSettings.length&&Array.prototype.forEach.call(t.markerSettings,function(t){var i=t.dataSource;!n.isNullOrUndefined(i)&&i.length>0&&Array.prototype.forEach.call(i,function(t,i){var o=n.isNullOrUndefined(t.latitude)?n.isNullOrUndefined(t.Latitude)?null:parseFloat(t.Latitude):parseFloat(t.latitude),s=n.isNullOrUndefined(t.longitude)?n.isNullOrUndefined(t.Longitude)?null:parseFloat(t.Longitude):parseFloat(t.longitude);n.isNullOrUndefined(o)||n.isNullOrUndefined(s)||(r=n.isNullOrUndefined(r)&&0===i?s:r,u=n.isNullOrUndefined(u)&&0===i?o:u,f=n.isNullOrUndefined(f)&&0===i?o:f,e=n.isNullOrUndefined(e)&&0===i?s:e,r>s&&(r=s),f>o&&(f=o),e<s&&(e=s),u<o&&(u=o))})})}),n.isNullOrUndefined(f)||n.isNullOrUndefined(r)||n.isNullOrUndefined(e)||n.isNullOrUndefined(u))||(s=(f+u)/2,h=(r+e)/2,this.maps.markerCenterLatitude=s,this.maps.markerCenterLongitude=h,(n.isNullOrUndefined(this.maps.markerZoomCenterPoint)||this.maps.markerZoomedState)&&(this.maps.markerZoomCenterPoint={latitude:s,longitude:h}),o=void 0,this.maps.isTileMap||0===this.maps.baseMapRectBounds.min.x?(i=pu(f,u,r,e,c,l,this.maps,!1),this.maps.isTileMap?o=n.isNullOrUndefined(this.maps.markerZoomFactor)||n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue>1&&1!==this.maps.markerZoomFactor?this.maps.mapScaleValue:i:(o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:1!==Math.floor(this.maps.scale)&&this.maps.mapScaleValue!==i&&n.isNullOrUndefined(this.maps.shouldZoomCurrentFactor)?this.maps.mapScaleValue:i)!==this.maps.mapScaleValue||1!==this.maps.markerZoomFactor&&1!==this.maps.mapScaleValue||this.maps.enablePersistence||(o=i)):(i=this.calculateIndividualLayerMarkerZoomLevel(c,l,a),o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue!==i?this.maps.mapScaleValue:i),this.maps.markerZoomFactor=o)}else this.maps.markerZoomedState=!1,this.maps.markerZoomFactor>1&&(this.maps.markerCenterLatitude=null,this.maps.markerCenterLongitude=null,this.maps.markerZoomFactor=1,this.maps.enablePersistence||(this.maps.mapScaleValue=1)),this.maps.isTileMap&&!this.maps.enablePersistence&&this.maps.mapScaleValue<=1&&(this.maps.tileZoomLevel=0===this.maps.mapScaleValue?this.maps.isZoomByPosition?this.maps.tileZoomLevel:1:this.maps.mapScaleValue,1!==this.maps.mapScaleValue||1!==this.maps.markerZoomFactor||n.isNullOrUndefined(this.maps.tileTranslatePoint)||(this.maps.tileTranslatePoint.x=0,this.maps.tileTranslatePoint.y=0))},t.prototype.markerClick=function(t){var r=t.target.id,u,i,h,l;if(-1===r.indexOf(this.maps.element.id)&&(u=t.target.closest("."+this.maps.element.id+"_marker_template_element"),!n.isNullOrUndefined(u)&&u.id.indexOf("_MarkerIndex_")>-1&&(r=u.id)),!(-1===r.indexOf("_LayerIndex_")||r.indexOf("_cluster_")>0)&&(i=this.getMarker(r),!n.isNullOrUndefined(i)&&(i.marker.enableDrag&&(document.getElementById(this.maps.element.id+"_svg").style.cursor="grabbing"),h={cancel:!1,name:uf,data:i.data,maps:this.maps,marker:i.marker,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,value:i.data.name},this.maps.trigger(uf,h),i.marker.enableDrag))){var c=!1,f=parseInt(r.split("_LayerIndex_")[1].split("_")[0],10),e=parseInt(r.split("_MarkerIndex_")[1].split("_")[0],10),o=parseInt(r.split("_dataIndex_")[1].split("_")[0],10),s=this.maps.layers[f].markerSettings[e];(this.sameMarkerData.length>0&&(c=this.sameMarkerData[0].data.filter(function(n){return n.index===o}).length>0&&this.sameMarkerData[0].layerIndex===f&&this.sameMarkerData[0].markerIndex===e),c)||(l={name:ff,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,layerIndex:f,markerIndex:e,dataIndex:o},this.maps.trigger(ff,l),this.maps.markerDragArgument={targetId:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,shape:n.isNullOrUndefined(s.shapeValuePath)?s.shape:s.dataSource[o][s.shapeValuePath],layerIndex:f,markerIndex:e,dataIndex:o})}},t.prototype.markerClusterClick=function(t){var r=t.target.id,i,u;-1!==r.indexOf("_LayerIndex_")&&-1!==r.indexOf("_cluster_")&&(i=this.getMarker(r),n.isNullOrUndefined(i)||(i.clusterCollection.length>0&&this.maps.markerClusterExpand&&(o(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&c(this.maps.element.id+"_mapsTooltip"),this.sameMarkerData.length>0&&!this.maps.markerClusterExpandCheck?(this.maps.markerClusterExpandCheck=!0,vr(this.sameMarkerData,this.maps)):(this.sameMarkerData=i.clusterCollection,this.maps.markerClusterExpandCheck=!1,yr(this.sameMarkerData,this.maps,this.markerSVGObject,!0))),u={cancel:!1,name:ef,data:i,maps:this.maps,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,markerClusterCollection:i.markCollection},this.maps.trigger(ef,u)))},t.prototype.getMarker=function(n){var r,t,s=n.split("_LayerIndex_"),v=parseInt(s[1].split("_")[0],10),i=this.maps.layers[v],y=[],p=[],u,h,c,f,e,a,o;if(n.indexOf("_MarkerIndex_")>-1&&(u=parseInt(s[1].split("_MarkerIndex_")[1].split("_")[0],10),h=parseInt(s[1].split("_dataIndex_")[1].split("_")[0],10),t=i.markerSettings[u],c=this.allowInnerClusterSetting(i),this.maps.markerClusterExpand=!c&&i.markerClusterSettings.allowClustering?i.markerClusterSettings.allowClusterExpand:t.clusterSettings.allowClusterExpand,!isNaN(u))){if(r=t.dataSource[h],f=[],!t.template&&n.indexOf("_cluster_")>-1&&this.maps.markerClusterExpand&&Array.prototype.forEach.call(t.dataSource,function(n,t){n.latitude===r.latitude&&n.longitude===r.longitude&&f.push({data:r,index:t})}),n.indexOf("_cluster_")>-1){var l=!c&&i.markerClusterSettings.allowClustering?i.markerClusterSettings:i.markerSettings[u].clusterSettings,w=document.getElementById(n.indexOf("_datalabel_")>-1?"Balloon"===l.shape?n.split("_datalabel_")[0]+"_Group":n.split("_datalabel_")[0]:"Balloon"===l.shape?n+"_Group":n),b="Balloon"===l.shape?w.children[0].textContent.split(",").map(Number):w.textContent.split(",").map(Number);for(f=[],e=0,a=b;e<a.length;e++)o=a[e],f.push({data:t.dataSource[o],index:o}),y.push(t.dataSource[o]);p.push({data:f,layerIndex:v,markerIndex:u,dataIndex:h,targetClusterIndex:+(n.split("_cluster_")[1].indexOf("_datalabel_")>-1?n.split("_cluster_")[1].split("_datalabel_")[0]:n.split("_cluster_")[1]),isClusterSame:!1})}return{marker:t,data:r,clusterCollection:p,markCollection:y}}return null},t.prototype.markerMove=function(t){var i=t.target.id,r,u;-1===i.indexOf("_LayerIndex_")||i.indexOf("_cluster_")>0||(r=this.getMarker(i),n.isNullOrUndefined(r)||(r.marker.enableDrag&&(document.getElementById(this.maps.element.id+"_svg").style.cursor=n.isNullOrUndefined(this.maps.markerDragArgument)?"pointer":"grabbing"),u={cancel:!1,name:of,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(of,u)))},t.prototype.markerClusterMouseMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&-1!==i.indexOf("_cluster_")&&(r=this.getMarker(i),(this.maps.markerClusterExpand&&(t.target.style.cursor="pointer"),n.isNullOrUndefined(r))||(u={cancel:!1,name:sf,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(sf,u)))},t.prototype.allowInnerClusterSetting=function(n){for(var i=!1,t=0;t<n.markerSettings.length;t++)if(n.markerSettings[t].clusterSettings.allowClustering){i=!0;break}return i},t.prototype.initializeMarkerClusterList=function(){for(var n=0;n<this.maps.layers.length;n++)this.initialMarkerCluster[n]=[],this.zoomedMarkerCluster[n]=[]},t.prototype.getModuleName=function(){return"Marker"},t.prototype.destroy=function(){this.maps=null;this.markerSVGObject=null;this.sameMarkerData=[];this.initialMarkerCluster=[];this.zoomedMarkerCluster=[]},t}(),vo=function(){function t(n){this.value={rightWidth:0,leftWidth:0,heightTop:0,heightBottom:0};this.maps=n;this.dataLabelCollections=[]}return t.prototype.getDataLabel=function(t,i,r,u){for(var o,f,s,e=0;e<(n.isNullOrUndefined(t)?0:t.length);e++)if(f=t[e],s=!n.isNullOrUndefined(f[u])&&isNaN(f[u])&&"string"==typeof f[u]?f[u].toLowerCase():f[u],r=n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toString(),s===(n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toLowerCase())){o=f;break}return o},t.prototype.renderLabel=function(t,i,r,u,e,o,s,h){var ui,et,ot,kt,b,fi,l,oi,ai,c=this,lt=t.dataLabelSettings,p=t.dataLabelSettings.textStyle,it=t.dataLabelSettings,dt=t.dataLabelSettings.labelPath,nt=[[]],gt=0,ni=0,rt=r,v="",ti=0,si=!1,di=r.properties,at=this.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_LabelIndex_"+s,k=new f(0,0),ii=u[s],ct,li,pt,wt,w;p.fontFamily="material"!==this.maps.theme.toLowerCase()?this.maps.themeStyle.labelFontFamily:p.fontFamily;p.fontWeight=p.fontWeight||this.maps.themeStyle.fontWeight;p.size=p.size||this.maps.themeStyle.fontSize;r=n.isNullOrUndefined(ii)?null:ii.property;var hi,vi,ci="[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)?t.shapePropertyPath:[t.shapePropertyPath],yi=0!==t.animationDuration||"Enable"===n.animationMode||n.isNullOrUndefined(this.maps.zoomModule),pi=this.maps.isTileMap?{}:this.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.maps.zoomModule)?bt(this.maps,t,yi):ut(this.maps,t,yi),y=this.maps.isTileMap?this.maps.scale:pi.scale,ft=this.maps.isTileMap?this.maps.translatePoint:pi.location,ri=this.maps.zoomTranslatePoint,vt=n.isNullOrUndefined(this.maps.scale)?1:Math.floor(this.maps.scale),yt=this.maps.zoomSettings.enable?!n.isNullOrUndefined(this.maps.zoomShapeCollection)&&this.maps.zoomShapeCollection.length>0&&!this.maps.isAddLayer:this.maps.zoomSettings.enable;for(this.maps.translateType="labels",ct=0;ct<ci.length&&!(di[ci[ct]]&&(hi=ci[ct],b=this.getDataLabel(t.dataSource,t.shapeDataPath,rt.properties[hi],t.shapeDataPath)));ct++);if(b=this.getDataLabel(t.dataSource,t.shapeDataPath,rt.properties[hi],t.shapeDataPath),!n.isNullOrUndefined(ii)&&!n.isNullOrUndefined(ii.property))if(nt=[[]],u[s]._isMultiPolygon||"Point"===u[s].type||"MultiPoint"===u[s].type){if("Point"!==u[s].type&&"MultiPoint"!==u[s].type)for(li=u[s],ct=0;ct<li.length;ct++)nt.push(this.getPoint(li[ct],[])),ni<(ti=nt[nt.length-1].length)&&(ni=ti,gt=nt.length-1)}else nt.push(this.getPoint(u[s],[])),ni<(ti=nt[nt.length-1].length)&&(ni=ti,gt=nt.length-1);if(v=n.isNullOrUndefined(b)?rt.properties[dt]:n.isNullOrUndefined(b[dt])?b[t.shapeDataPath]:b[dt].toString(),"[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)&&n.isNullOrUndefined(v)&&!n.isNullOrUndefined(t.dataSource)&&0===t.dataSource.length)for(pt=0;pt<t.shapePropertyPath.length;pt++)if(rt.properties[t.shapePropertyPath[pt]]){v=rt.properties[t.shapePropertyPath[pt]];break}n.isNullOrUndefined(v)&&""!==t.dataLabelSettings.template&&0===t.dataSource.length&&(v=rt.properties[t.shapePropertyPath]);n.isNullOrUndefined(v)&&!n.isNullOrUndefined(t.dataSource)&&t.dataSource.length>0&&(v="");var gi=v,bi=this.maps.projectionType,ki=l=wi(nt[gt],bi,t.geometryType);if(!n.isNullOrUndefined(v)&&!n.isNullOrUndefined(l)){if(yt&&vt>1&&!this.maps.zoomNotApplied&&""===lt.template){if(i>0)for(wt=0;wt<this.maps.zoomLabelPositions.length;wt++)if(this.maps.zoomLabelPositions[wt].dataLabelText===v){fi=s;s=wt;si=!0;break}oi=l.x;ai=l.y;l.x=(l.x+ri.x)*y;l.y=(l.y+ri.y)*y}l.y="Mercator"===this.maps.projectionType||"Normal"===t.geometryType?l.y:-l.y;n.isNullOrUndefined(this.maps.format)||isNaN(Number(v))||isNaN(parseFloat(v))||this.maps.useGroupingSeparator&&(v=nu(this.maps,parseFloat(v)),n.isNullOrUndefined(b)||(b[dt]=v));w={name:"dataLabelRendering",maps:this.maps,cancel:!1,border:{color:lt.border.color,width:lt.border.width,opacity:lt.border.opacity},datalabel:lt,fill:lt.fill,template:lt.template,text:v,offsetX:0,offsetY:0};this.maps.trigger("dataLabelRendering",w,function(r){var ti,ct,ut,pt,yi,pi,hi,dt,ni,wt,f,bt,nr;if(!w.cancel){ct=yt&&vt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.dataLabelShape[s]*y:(l.rightMax.x-l.leftMax.x)*y;n.isNullOrUndefined(c.maps.dataLabelShape)||c.maps.isReset||(vi=ki.rightMax.x-ki.leftMax.x,c.maps.dataLabelShape.push(vi));w.text===v||w.cancel||(v=w.text);var u=st(v,p),lt=v,ii=u,tr=l.y-u.height/2,ir=l.y+u.height/2,rr=(l.y+ft.y)*y-u.height/2,ur=(l.y+ft.y)*y+u.height/2;if((ti=function(n,t,i){for(var u,f=[],r=0;r<n.length;r++)u=n[r],t<=u.y&&i>=u.y&&f.push(u);return f}(nt[gt],tr,ir),ti.length>5&&"MultiPolygon"!==rt.geometry.type&&"MultiPolygon"!==rt.type)&&(ut=wi(ti,bi,t.geometryType),yt&&vt>1&&!c.maps.zoomNotApplied&&""===w.template&&(ut.x=(c.maps.zoomLabelPositions[s].location.x+ri.x)*y,ut.y=(c.maps.zoomLabelPositions[s].location.y+ri.y)*y),oi=ut.x,l.x=ut.x,ct=yt&&vt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.dataLabelShape[s]*y:(ut.rightMax.x-ut.leftMax.x)*y>0?(ut.rightMax.x-ut.leftMax.x)*y:ct),yi=(l.x+ft.x)*y+u.width/2,pi=(l.x+ft.x)*y-u.width/2,c.value[s]={rightWidth:yi,leftWidth:pi,heightTop:rr,heightBottom:ur},""!==w.template)hi=(ui=ei(w.template,c.maps))?ui(n.isNullOrUndefined(b)?rt.properties:b,c.maps,w.template,c.maps.element.id+"_LabelTemplate",!1):document.createElement("div"),hi.innerHTML=ui?"":w.template,pt=function(t,i,r){for(var o,f=(n.isNullOrUndefined(t.childElementCount)?t[0]:t).outerHTML,e=Object.keys(r),s=RegExp,u=0;u<e.length;u++)f=f.replace(new s("{{:"+e[u]+"}}","g"),r[e[u].toString()]);return o=n.createElement("div",{id:i,innerHTML:f}),o.style.position="absolute",o}(hi,at,n.isNullOrUndefined(b)?rt.properties:b),c.maps.isTileMap?(pt.style.left=(l.x+ft.x)*y-u.width/2+"px",pt.style.top=(l.y+ft.y)*y-u.height+"px"):(pt.style.left=Math.abs(c.maps.baseMapRectBounds.min.x-l.x)*y+r.offsetX+"px",pt.style.top=Math.abs(c.maps.baseMapRectBounds.min.y-l.y)*y+r.offsetY+"px"),o.appendChild(pt);else{if(dt=n.isNullOrUndefined(it.smartLabelMode)?"None":it.smartLabelMode.toString(),"Trim"===dt&&(ii=st(lt=g(ct,"number"==typeof v?v.toString():v,p,null,!0),p),et=new tt(at,k.x,k.y,"middle",lt,"","")),"None"===dt&&(et=new tt(at,k.x,k.y,"middle",v,"","")),"Hide"===dt&&(v=ct>=u.width?v:"",et=new tt(at,k.x,k.y,"middle",v,"","")),n.isNullOrUndefined(et)||(v=et.text),ni=n.isNullOrUndefined(it.intersectionAction)?"None":it.intersectionAction.toString(),"Hide"===ni){for(wt=0;wt<h.length;wt++)if(!n.isNullOrUndefined(h[wt])&&!(c.value[s].leftWidth>h[wt].rightWidth||c.value[s].rightWidth<h[wt].leftWidth||c.value[s].heightTop>h[wt].heightBottom||c.value[s].heightBottom<h[wt].heightTop)){v="";break}h.push(c.value[s]);et=new tt(at,k.x,k.y,"middle",v,"","")}if("Trim"===ni){for(f=0;f<h.length;f++)if(!n.isNullOrUndefined(h[f]))if(h[f].rightWidth<c.value[s].leftWidth||h[f].leftWidth>c.value[s].rightWidth||h[f].heightBottom<c.value[s].heightTop||h[f].heightTop>c.value[s].heightBottom)lt=v;else{if(c.value[s].leftWidth>h[f].leftWidth){lt=g((ct=h[f].rightWidth-c.value[s].leftWidth)-(c.value[s].rightWidth-c.value[s].leftWidth),v,p,null,!0);break}if(c.value[s].leftWidth<h[f].leftWidth){ct=c.value[s].rightWidth-h[f].leftWidth;lt=g(Math.abs(ct-(c.value[s].rightWidth-c.value[s].leftWidth)),v,p,null,!0);break}}ii=st(lt,p);h.push(c.value[s]);et=new tt(at,k.x,k.y,"middle",lt,"","")}if(("None"===ni&&(et=new tt(at,k.x,k.y,"middle",v,"","")),lt.length>1)&&(bt=w.border,bt.width>1)){var fr=w.fill,di=it.opacity,er=it.rx,or=it.ry,ci=void 0,li=void 0;yt&&vt>1&&!c.maps.zoomNotApplied?(ci=l.x-u.width/2,li=l.y-u.height/2-5):(ci=(l.x+ft.x)*y-u.width/2,li=(l.y+ft.y)*y-u.height/2);bt.opacity=n.isNullOrUndefined(bt.opacity)?di:bt.opacity;nr=new d(c.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_rectIndex_"+s,fr,bt,di,new a(ci+r.offsetX,li+r.offsetY,u.width,u.height),er,or);(kt=c.maps.renderer.drawRectangle(nr)).setAttribute("visibility",t.dataLabelSettings.animationDuration>0||"Enable"===n.animationMode?"hidden":"visibile");e.appendChild(kt)}(ot=ht(et,p,p.color||c.maps.themeStyle.dataLabelFontColor,e)).setAttribute("aria-label",v);ot.setAttribute("role","region");ot.setAttribute("visibility",t.dataLabelSettings.animationDuration>0||"Enable"===n.animationMode?"hidden":"visibile");yt&&vt>1&&!c.maps.zoomNotApplied?(ot.setAttribute("transform","translate( "+(l.x+r.offsetX)+" "+(l.y+r.offsetY)+" )"),l.x=oi,l.y=ai):ot.setAttribute("transform","translate( "+((l.x+ft.x)*y+r.offsetX)+" "+((l.y+ft.y)*y+ii.height/2+r.offsetY)+" )");e.appendChild(ot)}c.dataLabelCollections.push({location:{x:l.x+r.offsetX,y:l.y+r.offsetY},element:n.isNullOrUndefined(pt)?ot:pt,layerIndex:i,shapeIndex:si?fi:s,labelIndex:si?fi:s,dataLabelText:gi});o.childElementCount>0&&!c.maps.element.contains(o)&&(document.getElementById(c.maps.element.id+"_Secondary_Element").appendChild(o),c.maps.renderReactTemplates());(t.dataLabelSettings.animationDuration>0||"Enable"===n.animationMode)&&(n.isNullOrUndefined(ot)||(c.datalabelAnimate(ot,it.animationDuration,p.opacity,!1),n.isNullOrUndefined(kt)||c.datalabelAnimate(kt,it.animationDuration,it.opacity,!0)))}})}},t.prototype.datalabelAnimate=function(t,i,r,u){var f=0;new n.Animation({}).animate(t,{duration:0===i&&"Enable"===n.animationMode?1e3:i,delay:0,progress:function(n){n.timeStamp>n.delay&&(f=(n.timeStamp-n.delay)/n.duration,t.setAttribute("style","user-select: none; visibility: visible;"),t.setAttribute(u?"fill-opacity":"opacity",(r*f).toString()))},end:function(){t.style.visibility="visible";t.setAttribute(u?"fill-opacity":"opacity",r.toString())}})},t.prototype.getPoint=function(n,t){return"MultiLineString"===n.type?Array.prototype.forEach.call(n,function(n){Array.prototype.forEach.call(n,function(n){t.push(new f(n.point.x,n.point.y))})}):Array.prototype.forEach.call(n,function(n){t.push(new f(n.point.x,n.point.y))}),t},t.prototype.getModuleName=function(){return"DataLabel"},t.prototype.destroy=function(){this.dataLabelCollections=[];this.value=null;this.maps=null},t}(),yo=function(){function t(n){this.maps=n}return t.prototype.renderNavigation=function(t,i,r){var ot,u,p,kt,e,dt,tt,rt,gt,ut,l;if(!n.isNullOrUndefined(this.maps)){var a=void 0,h=t.navigationLineSettings,w=void 0,o=[],k=void 0,at=void 0,s=void 0,st=void 0,ht=void 0,ct=void 0,ft=void 0,d=void 0,vt=void 0,yt=void 0,g=void 0,c=void 0,nt=void 0,pt=void 0,wt=void 0,b=void 0,lt=void 0,et=void 0,bt=void 0;for(ot=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_line_Group"}),u=0;u<h.length;u++){if(k=h[u].latitude,w=h[u].longitude,at=!n.isNullOrUndefined(h[u].visible)&&h[u].visible,s=n.isNullOrUndefined(h[u].angle)?0:h[u].angle,st=h[u].width||1,ht=h[u].color,ct=h[u].dashArray,c=h[u].arrowSettings,vt=!n.isNullOrUndefined(c)&&c.showArrow,!n.isNullOrUndefined(w)&&!n.isNullOrUndefined(k)&&w.length===k.length&&at)for(p=0;p<w.length;p++)kt=this.maps.isTileMap?it(new f(w[p],k[p]),i,this.maps.tileTranslatePoint,!0):v(k[p],w[p],i,t,this.maps),o.push(kt);for(et=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_NavigationGroup"+u}),e=0;e<o.length-1;e++)s=1<(s=-1>s?-1:s)?1:s,dt=this.maps.element.id+"_LayerIndex_"+r+"_NavigationIndex_"+u+"_Line"+e,tt=this.convertRadius(o[e],o[e+1]),(s<=1&&s>0&&(d=0,o[e].x>o[e+1].x&&(d=1)),s>=-1&&s<0&&(d=1,o[e].x>o[e+1].x&&(d=0)),vt)&&(yt=c.color,g=n.isNullOrUndefined(c.size)?0:c.size,lt=n.isNullOrUndefined(c.offSet)?0:c.offSet,rt=Math.round(g/2),pt="Start"===(nt=c.position)?"url(#triangle"+u+")":null,wt="End"===nt?"url(#triangle"+u+")":null,0!==b&&0===s&&(b="Start"===nt?lt:-lt),b=n.isNullOrUndefined(b)?0:b,gt=this.maps.element.id+"_triangle",ut=this.maps.renderer.createDefs(),ut.innerHTML+='<marker id="triangle'+u+'"><\/marker>',l=ut.querySelector("#triangle"+u),l.setAttribute("markerWidth",g.toString()),l.setAttribute("markerHeight",g.toString()),l.setAttribute("refX",(rt-b).toString()),l.setAttribute("refY",rt.toString()),l.setAttribute("orient","auto"),ft=new y(gt,yt,st,ht,1,1,ct,"M 0,0  L 0,"+g+" L "+rt+", "+rt+" Z"),a=this.maps.renderer.drawPath(ft),l.appendChild(a),ut.appendChild(l),et.appendChild(ut)),bt=0===(s=Math.abs(s))?"M "+o[e].x+","+o[e].y+"L "+o[e+1].x+","+o[e+1].y+" ":"M "+o[e].x+","+o[e].y+" A "+(tt/2+(1-s)*tt/(10*s))+" "+(tt/2+(1-s)*tt/(10*s))+" 0,0,"+d+" , "+o[e+1].x+","+o[e+1].y+" ",ft=new y(dt,"none",st,ht,1,1,ct,bt),a=this.maps.renderer.drawPath(ft),n.isNullOrUndefined(nt)||("Start"===nt?a.setAttribute("marker-start",pt):a.setAttribute("marker-end",wt)),ri(this.maps.selectedNavigationElementId,this.maps.navigationSelectionClass,a,"navigationlineselectionMapStyle"),et.appendChild(a),ot.appendChild(et);o=[]}}return ot},t.prototype.convertRadius=function(n,t){var i=t.x-n.x,r=t.y-n.y;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))},t.prototype.getModuleName=function(){return"NavigationLine"},t.prototype.destroy=function(){this.maps=null},t}(),po=function(){function t(n){this.legendBorderRect=new a(0,0,0,0);this.initialMapAreaRect=new a(0,0,0,0);this.legendTotalRect=new a(0,0,0,0);this.totalPages=[];this.page=0;this.currentPage=0;this.legendItemRect=new a(0,0,0,0);this.heightIncrement=0;this.widthIncrement=0;this.textMaxWidth=0;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.shapeToggled=!0;this.legendElement=null;this.maps=n;this.addEventListener()}return t.prototype.renderLegend=function(){this.legendRenderingCollections=[];this.legendCollection=[];this.totalPages=[];this.widthIncrement=0;this.heightIncrement=0;this.defsElement=this.maps.renderer.createDefs();this.maps.svgObject.appendChild(this.defsElement);this.initialMapAreaRect=this.maps.mapAreaRect;this.calculateLegendBounds();this.drawLegend()},t.prototype.calculateLegendBounds=function(){var ut=this,y=this.maps,t=y.legendSettings,ct,r,ft,ei,oi,ot,b,kt,u,i,o,dt,ii,ri,ui,fi,gt;if(this.legendCollection=[],ct=y.mapAreaRect.y,this.legendRenderingCollections=[],Array.prototype.forEach.call(y.layersCollection,function(i,r){var o,h,u;if(!n.isNullOrUndefined(i.shapeData)){var c=i.shapeData.features,l=i.shapeDataPath,a=i.shapePropertyPath,s=i.dataSource,f=void 0,e=void 0;if("Layers"===t.type&&i.visible)f=i.shapeSettings.colorValuePath,e=i.shapeSettings.colorMapping,ut.getLegends(r,c,e,s,l,f,a);else if("Bubbles"===t.type)for(o=0,h=i.bubbleSettings;o<h.length;o++)u=h[o],u.visible&&(f=u.colorValuePath,e=u.colorMapping,s=u.dataSource,ut.getLegends(r,c,e,s,l,f,a))}"Markers"===t.type&&ut.getMarkersLegendCollections(r,i.markerSettings)}),this.legendCollection.length>0)for(r=0;r<this.legendCollection.length;r++)ft={name:"legendRendering",cancel:!1,fill:(o=this.legendCollection[r]).fill,shape:t.shape,shapeBorder:t.shapeBorder,text:"number"==typeof o.text?o.text.toString():o.text},y.trigger("legendRendering",ft),o.fill=ft.fill,o.shape=ft.shape,o.shapeBorder=ft.shapeBorder,o.text=ft.text,ft.cancel&&(this.legendCollection.splice(r,1),r--);if(ei=y.legendSettings.title.text,oi=y.legendSettings.titleStyle,this.legendCollection.length>0){var si,hi,yi=t.mode,k=0,d=0,lt=0,st=0,ni=t.shapePadding,l=t.shapeHeight,et=t.shapeWidth,s=[],nt=[],ci=t.position,li=t.labelDisplayMode,v="None"===t.orientation?"Top"===ci||"Bottom"===ci?"Horizontal":"Vertical":t.orientation,f=t.width.length>1?t.width.indexOf("%")>-1?y.availableSize.width/100*parseInt(t.width,10):parseInt(t.width,10):null,e=t.height.length>1?t.height.indexOf("%")>-1?y.availableSize.height/100*parseInt(t.height,10):parseInt(t.height,10):null,h=0,c=0,ai=p(ei,oi);if("Interactive"===yi){var ti=t.textStyle,at=this.legendCollection.length,tt="Horizontal"===v?n.isNullOrUndefined(f)?y.mapAreaRect.width/at:f/at:n.isNullOrUndefined(f)?25:f,it="Horizontal"===v?n.isNullOrUndefined(e)?25:e:n.isNullOrUndefined(e)?y.mapAreaRect.height/at:e/at;h=0;c=ai.height+10;var vt=t.labelPosition,yt=0,pt=0,rt=10,wt=0,bt=0,ht=0,vi=0;for(r=0;r<this.legendCollection.length;r++){if(h="Horizontal"===v?h+tt:h,c="Horizontal"===v?c:c+it,ot=this.legendCollection[r].text,b=new w(0,0),"None"===li?b=p(ot,ti):"Trim"===li?b=p(ot=g("Horizontal"===v?tt:it,ot,ti),ti):ot="","Left"===t.position||"Right"===t.position||"Float"===t.position)for(kt=0;kt<this.legendCollection.length;kt++)u=p((o=this.legendCollection[kt]).text,t.textStyle),this.textMaxWidth=Math.max(this.textMaxWidth,u.width);ht=Math.max(ht,b.height);vi=Math.max(vi,b.width);b.width>0&&b.height>0&&("Horizontal"===v?(yt=h+tt/2,pt="After"===vt?c+it+b.height/2+rt:c-rt):(yt="After"===vt?h-this.textMaxWidth/2-rt:h+tt+this.textMaxWidth/2+rt,pt=c+it/2+b.height/4));0===r?(wt="Horizontal"===v?h:"After"===vt?yt-this.textMaxWidth/2:h,bt="Horizontal"===v?"After"===vt?c:pt-b.height/2:c,1===this.legendCollection.length&&(f="Horizontal"===v?Math.abs(h+tt-wt):tt+this.textMaxWidth+rt,e="Horizontal"===v?it+ht/2+rt:Math.abs(c+it-bt))):r===this.legendCollection.length-1&&(f="Horizontal"===v?Math.abs(h+tt-wt):tt+this.textMaxWidth+rt,e="Horizontal"===v?it+ht/2+rt:Math.abs(c+it-bt));this.legendRenderingCollections.push({fill:this.legendCollection[r].fill,x:h,y:c,width:tt,height:it,text:ot,textX:yt,textY:pt,textWidth:b.width,textHeight:b.height,shapeBorder:this.legendCollection[r].shapeBorder})}1===this.legendCollection.length&&(e=ht+rt,f=tt);this.legendItemRect={x:wt,y:bt,width:f,height:e}}else{for(f=n.isNullOrUndefined(f)?y.mapAreaRect.width:f,e=n.isNullOrUndefined(e)?y.mapAreaRect.height:e,i=0,this.page=0,r=0;r<this.legendCollection.length;r++)o=this.legendCollection[r],(n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]}),u=p(o.text,t.textStyle),this.textMaxWidth=Math.max(this.textMaxWidth,u.width),0===r)?(h=k=10+et/2,c=d=ct+ai.height+(l>u.height?l/2:u.height/4)):(dt=u.height>l?u.height:l,"Horizontal"===v?(ii=nt[i-1].x+nt[i-1].width+10+et,ii+ni+u.width>f?(ri=(nt[i-1].y>s[i-1].y+l/2?nt[i-1].y:s[i-1].y+l/2)+ct,ri+dt>e?(this.getPageChanged(),i=0,s=[],nt=[],k=h,d=c):(k=s[0].x,d=ri+dt/2)):(k=ii-et/2,d=s[i-1].y)):(ui=nt[i-1].y>s[i-1].y+l/2?nt[i-1].y:s[i-1].y+l/2,ui+ct+dt>e?(fi=nt[i-1].x+this.textMaxWidth+10,fi+ni+u.width>f?(k=h,d=c,nt=[],s=[],this.getPageChanged(),i=0):(k=fi+et/2,d=s[0].y)):(k=s[i-1].x,d=ui+10+l/2))),lt=k+et/2+ni,st=d+u.height/4,s.push({x:k,y:d}),nt.push({x:lt,y:st,width:u.width,height:u.height/2}),this.totalPages[this.page].Collection.push({DisplayText:o.text,ImageSrc:o.imageSrc,Shape:{x:k,y:d},Text:{x:lt,y:st},Fill:o.fill,legendShape:o.shape,shapeBorder:o.shapeBorder,idIndex:r,Rect:{x:s[i].x-et/2,y:s[i].y-l/2<st-u.height?s[i].y-l/2:st-u.height,width:Math.abs(s[i].x-et/2-(lt+u.width)),height:l>u.height?l:u.height}}),i++;gt=this.totalPages[0].Collection;Array.prototype.forEach.call(gt,function(n,t){var i=new a(n.Rect.x,n.Rect.y,n.Rect.width,n.Rect.height);0===t&&(si=i.x,hi=i.y);ut.widthIncrement=Math.max(ut.widthIncrement,Math.abs(si-(i.x+i.width)));ut.heightIncrement=Math.max(ut.heightIncrement,Math.abs(hi-(i.y+i.height)))});f=this.widthIncrement<f?this.widthIncrement:f;e=this.heightIncrement<e?this.heightIncrement:e;this.legendItemRect={x:gt[0].Rect.x,y:gt[0].Rect.y,width:f,height:e}}}},t.prototype.getLegends=function(n,t,i,r,u,f,e){this.getRangeLegendCollection(n,t,i,r,u,f,e);this.getEqualLegendCollection(n,t,i,r,u,f,e);this.getDataLegendCollection(n,t,i,r,u,f,e)},t.prototype.getPageChanged=function(){this.page++;n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},t.prototype.legendTextTrim=function(n,t,i,r){var u=t,e=p(t,i).width,o=r-e,f;if(r>n)for(f=t.length-1;f>=0;--f)if(o+(e=p(u=t.substring(0,f)+"...",i).width)<=n||u.length<4)return u.length<4&&(u=" "),u;return u},t.prototype.drawLegend=function(){var c,e=this.maps,t=e.legendSettings,l=e.renderer,i={size:t.textStyle.size,color:t.textStyle.color,fontFamily:t.textStyle.fontFamily,fontWeight:t.textStyle.fontWeight,fontStyle:t.textStyle.fontStyle,opacity:t.textStyle.opacity},u,s,v,o,h;if(this.legendGroup=l.createGroup({id:e.element.id+"_Legend_Group"}),"Interactive"===t.mode)for(u=0;u<this.legendRenderingCollections.length;u++){var y=e.element.id+"_Legend_Index_"+u,p=e.element.id+"_Legend_Index_"+u+"_Text",r=this.legendRenderingCollections[u],w=new a(r.x,r.y,r.width,r.height);0===u&&this.renderLegendBorder();s=new f(r.textX,r.textY);i.color=null!==i.color?i.color:this.maps.themeStyle.legendTextColor;v=new d(y,r.fill,r.shapeBorder,t.opacity,w);c=new tt(p,s.x,s.y,"middle",r.text,"","");i.fontFamily=n.isNullOrUndefined(i.fontFamily)?this.maps.themeStyle.fontFamily:i.fontFamily;i.size=i.size||e.themeStyle.legendFontSize;o=ht(c,i,i.color,this.legendGroup);o.setAttribute("aria-label",r.text);o.setAttribute("role","region");h=l.drawRectangle(v);this.legendGroup.appendChild(h);!e.legendSettings.toggleLegendSettings.enable||"Layers"!==t.type&&"Markers"!==t.type||this.maintainLegendToggle(u,h,o);this.legendToggle()}else this.drawLegendItem(this.currentPage)},t.prototype.drawLegendItem=function(t){var dt,gt,ni,ti,ii,vt,ut,r=this.maps,i=r.legendSettings,ri=new w(i.shapeWidth,i.shapeHeight),h=r.renderer,yt=i.shape,v,b,l,wt,et,ei,k,oi,u,si,hi,ci,rt;if(t>=0&&t<this.totalPages.length)for(e(this.legendGroup.id,this.maps.element.id)&&n.remove(e(this.legendGroup.id,this.maps.element.id)),v=0;v<this.totalPages[t].Collection.length;v++){var o=this.totalPages[t].Collection[v],g=o.shapeBorder,nt=h.createGroup({id:r.element.id+"_Legend_Index_"+o.idIndex}),ft=o.DisplayText,li="HorizontalLine"===i.shape||"VerticalLine"===i.shape||"Cross"===i.shape?n.isNullOrUndefined(i.fill)?"#000000":i.fill:g.color,ai="HorizontalLine"!==i.shape&&"VerticalLine"!==i.shape&&"Cross"!==i.shape||0!==g.width?g.width:1,vi=r.element.id+"_Legend_Shape_Index_"+o.idIndex,yi=r.element.id+"_Legend_Text_Index_"+o.idIndex,pt=new f(o.Shape.x,o.Shape.y-4),ui=new f(o.Text.x,o.Text.y-4),fi=new y(vi,o.Fill,ai,li,i.opacity,n.isNullOrUndefined(g.opacity)?i.opacity:g.opacity,""),s={fontFamily:i.textStyle.fontFamily,fontStyle:i.textStyle.fontStyle,fontWeight:i.textStyle.fontWeight,size:i.textStyle.size,color:i.textStyle.color,opacity:i.textStyle.opacity};if((s.color=null!==s.color?s.color:this.maps.themeStyle.legendTextColor,s.fontFamily=n.isNullOrUndefined(s.fontFamily)?this.maps.themeStyle.fontFamily:s.fontFamily,s.size=s.size||r.themeStyle.legendFontSize,s.fontWeight=s.fontWeight||r.themeStyle.fontWeight,0===v&&this.renderLegendBorder(),"Markers"===i.type&&i.useMarkerShape)&&(b=this.legendCollection[o.idIndex].data[0],l=r.layers[b.layerIndex].markerSettings[b.markerIndex],yt=n.isNullOrUndefined(l.dataSource[b.dataIndex][l.shapeValuePath])||""===l.dataSource[b.dataIndex][l.shapeValuePath]?l.shape:l.dataSource[b.dataIndex][l.shapeValuePath]),"Balloon"===yt?nt.appendChild(kr(r,fi,ri,{x:pt.x,y:pt.y+5},"Legend")):nt.appendChild((dt=pt,gt=yt,ni=ri,ti=o.ImageSrc,ii=fi,vt=void 0,ut=void 0,vt=new ot.SvgRenderer(""),ut=function(t,i,r,u,f){var s,v="Path",c=i.width,o=i.height,h=t.x,e=t.y,l=t.x+-c/2,w=t.y+-o/2;switch(u.stroke="HorizontalLine"===r||"VerticalLine"===r||"Cross"===r?u.fill:u.stroke,u["stroke-width"]=0!==u["stroke-width"]||"HorizontalLine"!==r&&"VerticalLine"!==r&&"Cross"!==r?u["stroke-width"]:1,r){case"Circle":case"Bubble":v="Ellipse";n.merge(u,{rx:c/2,ry:o/2,cx:h,cy:e});break;case"VerticalLine":s="M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"HorizontalLine":s="M "+h+" "+e+" L "+(h+c/2)+" "+e;n.merge(u,{d:s});break;case"Diamond":s="M "+l+" "+e+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+e+" L "+h+" "+(e+o/2)+" L "+l+" "+e+" z";n.merge(u,{d:s});break;case"Rectangle":s="M "+l+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" L "+l+" "+(e+-o/2)+" z";n.merge(u,{d:s});break;case"Triangle":s="M "+l+" "+(e+o/2)+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" z";n.merge(u,{d:s});break;case"InvertedTriangle":s="M "+(h+c/2)+" "+(e-o/2)+" L "+h+" "+(e+o/2)+" L "+(h-c/2)+" "+(e-o/2)+" L "+(h+c/2)+" "+(e-o/2)+" z";n.merge(u,{d:s});break;case"Pentagon":for(var y=void 0,p=void 0,a=0;a<=5;a++)y=c/2*Math.cos(Math.PI/180*72*a),p=c/2*Math.sin(Math.PI/180*72*a),s=0===a?"M "+(h+y)+" "+(e+p)+" ":s.concat("L "+(h+y)+" "+(e+p)+" ");s=s.concat("Z");n.merge(u,{d:s});break;case"Star":s="M "+(t.x+i.width/3)+" "+(t.y+i.height/2)+" L "+(t.x-i.width/2)+" "+(t.y-i.height/6)+" L "+(t.x+i.width/2)+" "+(t.y-i.height/6)+" L "+(t.x-i.width/3)+" "+(t.y+i.height/2)+" L "+t.x+" "+(t.y-i.height/2)+" L "+(t.x+i.width/3)+" "+(t.y+i.height/2)+" Z";n.merge(u,{d:s});break;case"Cross":s="M "+l+" "+e+" L "+(h+c/2)+" "+e+" M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"Image":v="Image";n.merge(u,{href:f,height:o,width:c,x:l,y:w})}return{renderOption:u,functionName:v}}(dt,ni,gt,ii,ti),vt["draw"+ut.functionName](ut.renderOption))),wt=o.Rect.x+o.Rect.width,wt>this.legendBorderRect.width&&(ft=this.legendTextTrim(this.legendBorderRect.width,ft,s,wt)),et=ht(new tt(yi,ui.x,ui.y,"start",ft,"",""),s,s.color,nt),(et.setAttribute("aria-label",ft),et.setAttribute("role","region"),this.legendGroup.appendChild(nt),r.legendSettings.toggleLegendSettings.enable&&("Layers"===i.type||"Markers"===i.type))&&(ei=nt.childNodes[0],this.maintainLegendToggle(o.idIndex,ei,et)),v===this.totalPages[t].Collection.length-1){if(k=void 0,0!==this.page){var bt=t+1+"/"+this.totalPages.length,st=i.textStyle,kt=p(bt,st),ct=this.legendItemRect.x+this.legendItemRect.width-kt.width-38,it=this.legendItemRect.x+this.legendItemRect.width,pi=it-10-kt.width/2-9,c=this.legendItemRect.y+this.legendItemRect.height+2.5+10;k=h.createGroup({id:r.element.id+"_Legend_Paging_Group"});var lt=h.createGroup({id:r.element.id+"_Legend_Left_Paging_Group"}),at=h.createGroup({id:r.element.id+"_Legend_Right_Paging_Group"}),wi=" M "+it+" "+c+" L "+(it-10)+" "+(c-5)+" L "+(it-10)+" "+(c+5)+" z ",bi=" M "+ct+" "+c+" L "+(ct+10)+" "+(c-5)+" L "+(ct+10)+" "+(c+5)+" z ",ki=new y(r.element.id+"_Left_Page",this.maps.themeStyle.legendTextColor,0,this.maps.themeStyle.legendTextColor,t+1===1?.5:1,1,"",bi);lt.appendChild(h.drawPath(ki));oi=new d(r.element.id+"_Left_Page_Rect","transparent",{},1,new a(ct-5,c-10,20,20),null,null,"","");u=h.drawRectangle(oi);u.setAttribute("aria-label","Navigate to the previous legend items");u.setAttribute("role","button");u.tabIndex=t+1===1?-1:r.tabIndex;t+1===1?(u.style.cursor="default",u.style.setProperty("outline","none")):(u.style.cursor="pointer",u.style.removeProperty("outline"));lt.appendChild(u);this.wireEvents(lt);si=new y(r.element.id+"_Right_Page",this.maps.themeStyle.legendTextColor,0,this.maps.themeStyle.legendTextColor,t+1===this.totalPages.length?.5:1,1,"",wi);at.appendChild(h.drawPath(si));hi=new d(r.element.id+"_Right_Page_Rect","transparent",{},1,new a(it-15,c-10,20,20),null,null,"","");(u=h.drawRectangle(hi)).setAttribute("aria-label","Navigate to the next legend items");u.setAttribute("role","button");u.tabIndex=t+1===this.totalPages.length?-1:r.tabIndex;t+1===this.totalPages.length?(u.style.cursor="default",u.style.setProperty("outline","none")):(u.style.cursor="pointer",u.style.removeProperty("outline"));at.appendChild(u);this.wireEvents(at);k.appendChild(lt);k.appendChild(at);ci={id:r.element.id+"_Paging_Text",x:pi,y:c+kt.height/4,fill:this.maps.themeStyle.legendTextColor,"font-size":"14px","font-style":st.fontStyle,"font-family":st.fontFamily,"font-weight":st.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":""};rt=h.createText(ci,bt);rt.style.cssText="user-select: none;";rt.setAttribute("aria-label",bt);rt.setAttribute("role","region");k.appendChild(rt);this.legendGroup.appendChild(k)}this.legendToggle()}}},t.prototype.maintainLegendToggle=function(t,i,r){var f,u;this.maps.legendSettings.toggleLegendSettings.enable&&!n.isNullOrUndefined(this.maps.toggledLegendId)&&this.maps.toggledLegendId.indexOf(t)>-1&&!n.isNullOrUndefined(this.maps.toggledElementId)&&this.maps.toggledElementId.length>0&&(f=this.legendCollection[t].data,this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(u=f[f.length-1].layerIndex,this.setToggleAttributes(r,i,this.maps.layers[u].shapeSettings.fill,this.maps.layers[u].shapeSettings.opacity,this.maps.layers[u].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity,this.maps.layers[u].shapeSettings.fill)):this.setToggleAttributes(r,i,this.maps.legendSettings.toggleLegendSettings.fill,this.maps.legendSettings.toggleLegendSettings.opacity,this.maps.legendSettings.toggleLegendSettings.border.color,this.maps.legendSettings.toggleLegendSettings.border.width,n.isNullOrUndefined(this.maps.legendSettings.toggleLegendSettings.border.opacity)?this.maps.legendSettings.toggleLegendSettings.opacity:this.maps.legendSettings.toggleLegendSettings.border.opacity,this.maps.legendSettings.toggleLegendSettings.fill),f._isVisible=!1)},t.prototype.legendHighLightAndSelection=function(t,i){var w,b,k,rt,s,ct="Default"===this.maps.legendSettings.mode?document.getElementById(t.id.replace("Shape","Text")):document.getElementById(t.id+"_Text"),h=this.maps.legendModule.legendCollection,a=!n.isNullOrUndefined(h[0].data[0].layerIndex)&&this.maps.layers[h[0].data[0].layerIndex].selectionSettings.enableMultiSelect,v=0,d=!0,ut=parseFloat(t.id.charAt(t.id.length-1)),ft,g,u,y,f,et,e,o,nt,p,st,ht,tt,it;if(this.updateLegendElement(),ft=this.maps.toggledLegendId.indexOf(ut),this.maps.legendSettings.toggleLegendSettings.enable&&"highlight"===i&&-1!==ft)return g=this.getIndexofLegend(this.legendHighlightCollection,t),-1!==g&&this.legendHighlightCollection.splice(g,1),this.removeLegendHighlightCollection(),null;if("selection"===i){if(this.shapeHighlightCollection=[],this.maps.shapeSelections||a||(this.removeAllSelections(),this.maps.shapeSelections=!0),this.maps.legendSelectionCollection.length>0&&(a||this.maps.shapeSelections))for(u=0;u<this.maps.legendSelectionCollection.length;u++){if(t===this.maps.legendSelectionCollection[u].legendElement){this.maps.legendSelectionCollection[u].legendElement=t;d=!1;this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement);this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(ut),1);this.maps.legendSelectionCollection.splice(u,1);this.maps.legendSelection=!(this.maps.legendSelectionCollection.length>0);break}if(!a)if(this.maps.legendSelectionCollection.length>1){for(y=0;y<this.maps.legendSelectionCollection.length;y++)this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[y].legendElement);this.maps.legendSelectionCollection=[]}else this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement),this.maps.legendSelectionCollection.splice(u,1)}}else{if(this.maps.legendSelectionCollection.length>0)for(u=0;u<this.maps.legendSelectionCollection.length;u++){if((t.id.indexOf("_Legend_Shape")>-1||t.id.indexOf("_Legend_Index"))&&t===this.maps.legendSelectionCollection[u].legendElement){d=!1;break}this.removeLegendHighlightCollection()}this.removeLegendHighlightCollection()}if(d)for(f=0;f<h.length;f++)if(et="Interactive"===this.maps.legendSettings.mode?parseFloat(t.id.split("_Legend_Index_")[1]):parseFloat(t.id.split("_Legend_Shape_Index_")[1]),ct.textContent===h[f].text&&h[f].data.length>0&&et===f){var c=this.maps.layers[h[f].data[0].layerIndex],ot=void 0,r=void 0,l=void 0;if(n.isNullOrUndefined(c)||(ot="selection"===i?c.selectionSettings.enable:c.highlightSettings.enable,r=void 0,r="selection"===i?c.selectionSettings:c.highlightSettings,l=h[f].data),ot)for(e=0;e<l.length;e++)if(o=void 0,w=l[e].shapeIndex,b=l[e].layerIndex,k=l[e].dataIndex,null!==(o=-1===(rt=l[e].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+b+"_shapeIndex_"+w+"_dataIndex_"+k):document.getElementById(this.maps.element.id+"_LayerIndex_"+b+"_shapeIndex_"+w+"_dataIndex_"+k+"_multiLine_"+rt))){if(nt=!0,null!==this.maps.legendSelectionCollection)for(p=0;p<this.maps.legendSelectionCollection.length;p++)if(this.maps.legendSelectionCollection[p].legendElement===t){nt=!1;break}if("highlight"===i&&nt){0===e&&(this.legendHighlightCollection=[],this.pushCollection(t,this.legendHighlightCollection,h[f],c.shapeSettings));s=this.legendHighlightCollection.length;st=this.legendHighlightCollection[s-1].legendOldFill;this.legendHighlightCollection[s-1].MapShapeCollection.Elements.push(o);var lt=this.legendHighlightCollection[s-1].MapShapeCollection.Elements.length-1,at=o.getAttribute("fill"),vt=o.getAttribute("fill-opacity");this.legendHighlightCollection[s-1].shapeOldFillColor.push(at);this.legendHighlightCollection[s-1].shapeOldOpacity=vt;ht=this.legendHighlightCollection[s-1].shapeOldFillColor[lt];tt=this.legendHighlightCollection[s-1].shapeOldOpacity;this.shapePreviousColor=this.legendHighlightCollection[s-1].shapeOldFillColor;this.setColor(o,n.isNullOrUndefined(r.fill)?ht:r.fill,n.isNullOrUndefined(r.opacity)?tt:r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight");this.setColor(t,n.isNullOrUndefined(r.fill)?st:r.fill,n.isNullOrUndefined(r.opacity)?tt:r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")}else"selection"===i&&(this.legendHighlightCollection=[],this.maps.legendSelectionClass=r,0===e&&(this.pushCollection(t,this.maps.legendSelectionCollection,h[f],c.shapeSettings),a||0===this.maps.selectedLegendElementId.length||(this.maps.selectedLegendElementId=[]),this.maps.selectedLegendElementId.push(f)),v=this.maps.legendSelectionCollection.length,it=this.maps.legendSelectionCollection[v-1].legendOldFill,this.maps.legendSelectionCollection[v-1].MapShapeCollection.Elements.push(o),this.maps.legendSelectionCollection[v-1].shapeOldFillColor=this.shapePreviousColor,this.setColor(t,n.isNullOrUndefined(r.fill)?it:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),this.setColor(o,n.isNullOrUndefined(r.fill)?it:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),-1===this.maps.selectedElementId.indexOf(o.getAttribute("id"))&&this.maps.selectedElementId.push(o.getAttribute("id")),e===l.length-1&&(this.maps.legendSelection=!1,this.removeLegend(this.maps.legendSelectionCollection)))}}},t.prototype.setColor=function(t,i,r,u,f,e){var s=t.parentElement.id.indexOf("LineString")>-1;"selection"===e?(function(t,i,r,u,f,e,s){if(!o(t)){var h=n.createElement("style",{id:t});h.innerText="."+i+"{fill:"+r+";opacity:"+u+";stroke-width:"+e+";stroke:"+f+";}";s.shapeSelectionClass=h;document.body.appendChild(h)}}(s?"LineselectionMap":"ShapeselectionMap",s?"LineselectionMapStyle":"ShapeselectionMapStyle",s?"transparent":i,r,s?i:u,f,this.maps),t.setAttribute("class",s?"LineselectionMapStyle":"ShapeselectionMapStyle")):(t.setAttribute("fill",s?"transparent":i),t.setAttribute("fill-opacity",r),t.setAttribute("stroke",s?i:u),t.setAttribute("stroke-width",(Number(f)/this.maps.scale).toString()))},t.prototype.pushCollection=function(n,t,i,r){t.push({legendElement:n,legendOldFill:i.fill,legendOldOpacity:i.opacity,legendOldBorderColor:i.borderColor,legendOldBorderWidth:i.borderWidth,shapeOpacity:r.opacity,shapeOldBorderColor:r.border.color||this.maps.themeStyle.shapeBorderColor,shapeOldBorderWidth:r.border.width});var u=t.length;t[u-1].MapShapeCollection={Elements:[]};t[u-1].shapeOldFillColor=[];t[u-1].shapeOldOpacity=null},t.prototype.removeLegend=function(t){for(var i,f,r,e,o,u=0;u<t.length;u++)for(i=t[u],this.setColor(i.legendElement,i.legendOldFill,i.legendOldOpacity,i.legendOldBorderColor,i.legendOldBorderWidth,"highlight"),f=i.MapShapeCollection.Elements.length,r=0;r<f;r++)e=-1!==i.legendOldFill.indexOf("url")?i.shapeOldFillColor[r]:i.legendOldFill,o=n.isNullOrUndefined(i.shapeOldOpacity)?i.shapeOpacity:i.shapeOldOpacity,this.setColor(i.MapShapeCollection.Elements[r],e,o,i.shapeOldBorderColor,i.shapeOldBorderWidth,"highlight")},t.prototype.removeLegendHighlightCollection=function(){this.legendHighlightCollection.length>0&&(this.removeLegend(this.legendHighlightCollection),this.legendHighlightCollection=[])},t.prototype.removeLegendSelectionCollection=function(n){var t,r;if(this.maps.legendSelectionCollection.length>0){l(n);for(var u=this.shapesOfLegend(n),f=u.length,i=0;i<f;i++)t=o(u[i]),("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&(l(t),r=this.maps.selectedElementId.indexOf(t.id),-1!==r&&this.maps.selectedElementId.splice(r,1))}},t.prototype.removeShapeHighlightCollection=function(){var t;if(this.shapeHighlightCollection.length>0)for(t=0;t<this.shapeHighlightCollection.length;t++){for(var n=this.shapeHighlightCollection[t],r=!0,i=0;i<this.maps.legendSelectionCollection.length;i++)this.maps.legendSelectionCollection[i].legendElement===n.legendElement&&(r=!1);r&&this.setColor(n.legendElement,n.legendOldFill,n.legendOldOpacity,n.legendOldBorderColor,n.legendOldBorderWidth,"highlight")}},t.prototype.shapeHighLightAndSelection=function(t,i,r,u,f){var b,y,h,p,v,d,o,a,it,rt,g,nt,tt;if(void 0!==i){this.updateLegendElement();this.shapeToggled=!0;var w=this.maps.legendModule.legendCollection,e=this.legendIndexOnShape(i,f),s=this.shapeDataOnLegend(t),ut=this.maps.toggledLegendId.indexOf(e.actualIndex);if(this.maps.legendSettings.toggleLegendSettings.enable&&-1!==ut)return this.shapeToggled=!1,this.legendHighlightCollection=[],b=this.getIndexofLegend(this.shapeHighlightCollection,s.LegendEle),-1!==b&&this.shapeHighlightCollection.splice(b,1),this.removeShapeHighlightCollection(),null;if(void 0===e.currentIndex&&void 0===e.actualIndex)return this.removeShapeHighlightCollection(),null;if(void 0!==e.currentIndex||"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||"ShapeselectionMapStyle"===t.getAttribute("class")||(this.maps.legendSelection=!1),"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||this.maps.legendSelection||(this.removeAllSelections(),this.maps.legendSelection=!0),void 0===e.currentIndex){if("selection"===u&&void 0!==e.actualIndex){for(y=0,h=0;h<s.Elements.length;h++)"ShapeselectionMapStyle"===s.Elements[h].getAttribute("class")&&y++;p=this.maps.selectedLegendElementId.indexOf(e.actualIndex);-1===p?(this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r):y<=1&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&(this.maps.layers[f].selectionSettings.enableMultiSelect?y<=1&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&this.maps.selectedLegendElementId.splice(p,1):this.maps.selectedLegendElementId.splice(p,1))}return this.removeShapeHighlightCollection(),null}var ft=w[e.actualIndex].text,k=void 0,c=void 0;if("Default"===this.maps.legendSettings.mode?void 0!==e.currentIndex&&(k=document.getElementById(this.maps.element.id+"_Legend_Text_Index_"+e.actualIndex).textContent,c=document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+e.actualIndex)):(k=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex+"_Text").textContent,c=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex)),this.oldShapeElement=s.LegendEle,v=this.maps.legendSelectionCollection.length,ft===k){if(d=!0,this.maps.legendSelectionCollection)for(h=0;h<this.maps.legendSelectionCollection.length;h++)if(this.maps.legendSelectionCollection[h].legendElement===s.LegendEle){d=!1;break}if("highlight"===u&&d){for((void 0===(a=this.isTargetSelected(s,this.shapeHighlightCollection))||a&&!a.IsSelected)&&this.pushCollection(c,this.shapeHighlightCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),o=0;o<this.shapeHighlightCollection.length;o++)s.LegendEle.id===this.shapeHighlightCollection[o].legendElement.id&&(this.shapeHighlightCollection[o].legendElement=s.LegendEle);if(v>0)for(o=0;o<v;o++){if(s.LegendEle===this.maps.legendSelectionCollection[o].legendElement){this.maps.legendSelectionCollection[o].legendElement=s.LegendEle;this.removeShapeHighlightCollection();break}o===v-1&&(this.removeShapeHighlightCollection(),this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight"))}else this.removeShapeHighlightCollection(),this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,n.isNullOrUndefined(r.opacity)?"1":r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")}else if("selection"===u){if(a=this.isTargetSelected(s,this.maps.legendSelectionCollection),v>0)for(o=0;o<this.maps.legendSelectionCollection.length;)s.LegendEle===this.maps.legendSelectionCollection[o].legendElement||r.enableMultiSelect?o++:(it=this.maps.legendSelectionCollection[o],rt=this.maps.selectedLegendElementId.indexOf(e.actualIndex),this.maps.selectedLegendElementId.splice(rt,1),this.maps.legendSelectionCollection.splice(o,1),l(it.legendElement),this.maps.shapeSelections=!0,o=0);if(a&&a.IsSelected&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))){if(g=0,r.enableMultiSelect)for(h=0;h<s.Elements.length;h++)t.getAttribute("class")===s.Elements[h].getAttribute("class")&&g++;g<=1&&(r.enableMultiSelect||this.maps.legendSelection)&&(this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(e.actualIndex),1),n.isNullOrUndefined(s.LegendEle)||l(s.LegendEle),this.maps.legendSelectionCollection.splice(a.SelectionIndex,1),this.maps.shapeSelections=!0)}else{for(void 0!==a&&(!a||a.IsSelected)||n.isNullOrUndefined(c)||-1===(tt=this.getIndexofLegend(this.maps.legendSelectionCollection,c))&&this.pushCollection(c,this.maps.legendSelectionCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),nt=!0,h=0;h<this.maps.selectedLegendElementId.length;h++)e.actualIndex===this.maps.selectedLegendElementId[h]&&(nt=!1);(nt&&this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r,this.removeLegend(this.shapeHighlightCollection),n.isNullOrUndefined(c))||(this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,n.isNullOrUndefined(r.opacity)?"1":r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),tt=this.getIndexofLegend(this.maps.legendSelectionCollection,c),this.maps.legendSelectionCollection[tt].MapShapeCollection.Elements.push(t));this.maps.shapeSelections=!1}}else document.getElementsByClassName("highlightMapStyle").length>0&&(this.removeShapeHighlightCollection(),l(document.getElementsByClassName("highlightMapStyle")[0]))}}else this.removeShapeHighlightCollection()},t.prototype.isTargetSelected=function(t,i){for(var u,r=0;r<i.length;r++)n.isNullOrUndefined(t.LegendEle.getAttribute("id"))||t.LegendEle.getAttribute("id")!==i[r].legendElement.getAttribute("id")||(u={IsSelected:!0,SelectionIndex:r});return u},t.prototype.updateLegendElement=function(){for(var n=0;n<this.maps.legendSelectionCollection.length;n++)document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id)&&(this.maps.legendSelectionCollection[n].legendElement=document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id))},t.prototype.getIndexofLegend=function(n,t){return n.map(function(n){return n.legendElement}).indexOf(t)},t.prototype.removeAllSelections=function(){for(var i,r,u,t=0;t<this.maps.selectedElementId.length;t++)l(r=document.getElementById(this.maps.selectedElementId[t]));for(i=0;i<this.maps.selectedLegendElementId.length;i++)r=("Interactive"===this.maps.legendSettings.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_")+this.maps.selectedLegendElementId[i],u=document.getElementById(r),n.isNullOrUndefined(u)||l(document.getElementById(r));this.maps.legendSelectionCollection=[];this.maps.selectedLegendElementId=[];this.maps.selectedElementId=[]},t.prototype.legendIndexOnShape=function(t,i){var c,l,o,a=t[this.maps.layers[i].shapeDataPath],s=this.maps.legendSettings.mode,h=this.maps.legendModule.legendCollection,v,u,f,e,r;for("Default"===s&&!n.isNullOrUndefined(this.maps.legendModule.totalPages)&&this.maps.legendModule.totalPages.length>0&&(o=this.maps.legendModule.totalPages[this.maps.legendModule.currentPage].Collection),v="Default"!==s||n.isNullOrUndefined(o)?1:o.length,u=0;u<h.length;u++){for(f=h[u].data,e=0;e<v;e++)if("Default"!==s||h[u].text===o[e].DisplayText)for(r=0;r<f.length;r++)a===f[r].name&&(c=e);for(r=0;r<f.length;r++)a===f[r].name&&(l=u)}return{currentIndex:c,actualIndex:l}},t.prototype.shapeDataOnLegend=function(t){for(var v,e,o,s,h,c=this.maps.legendModule.legendCollection,y=this.maps.legendSettings,r=0;r<c.length;r++){for(var u=c[r].data,l=!1,a=[],f={Elements:[]},i=0;i<u.length;i++)e=u[i].shapeIndex,o=u[i].layerIndex,s=u[i].dataIndex,t===(v=-1===(h=u[i].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+o+"_shapeIndex_"+e+"_dataIndex_"+s):document.getElementById(this.maps.element.id+"_LayerIndex_"+o+"_shapeIndex_"+e+"_dataIndex_"+s+"_multiLine_"+h))&&(l=!0),a.push(v);if(l)return n.isNullOrUndefined(f.LegendEle)&&(f.LegendEle="Default"===y.mode?document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+r):document.getElementById(this.maps.element.id+"_Legend_Index_"+r)),f.Elements=a,f}return null},t.prototype.shapesOfLegend=function(t){for(var o,u,f,e,s,c=parseFloat(t.id.charAt(t.id.length-1)),r=this.maps.legendModule.legendCollection[c].data,h=[],i=0;i<r.length;i++)u=r[i].shapeIndex,f=r[i].layerIndex,e=r[i].dataIndex,o=-1===(s=r[i].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+f+"_shapeIndex_"+u+"_dataIndex_"+e):document.getElementById(this.maps.element.id+"_LayerIndex_"+f+"_shapeIndex_"+u+"_dataIndex_"+e+"_multiLine_"+s),n.isNullOrUndefined(o)||h.push(o.id);return h},t.prototype.legendToggle=function(){var u=this.maps,f=u.legendSettings,t,s,i,h,r,c,l,e,a,o;if(this.maps.selectedLegendElementId)for(t=0;t<this.maps.selectedLegendElementId.length;t++)if(s="Interactive"===f.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_",i=u.svgObject.querySelector("#"+s+this.maps.selectedLegendElementId[t]),!n.isNullOrUndefined(i)){for(h=n.isNullOrUndefined(this.maps.legendSelectionClass.fill)?i.getAttribute("fill"):this.maps.legendSelectionClass.fill,this.setColor(i,h,this.maps.legendSelectionClass.opacity.toString(),this.maps.legendSelectionClass.border.color,this.maps.legendSelectionClass.border.width.toString(),"selection"),r=0;r<this.maps.legendSelectionCollection.length;r++)this.maps.legendSelectionCollection[r].legendElement.id===i.id&&(this.maps.legendSelectionCollection[r].legendElement=i);-1===this.getIndexofLegend(this.maps.legendSelectionCollection,i)&&(c=this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]].data[t].layerIndex,this.pushCollection(i,this.maps.legendSelectionCollection,this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]],this.maps.layers[c].shapeSettings))}if(this.maps.toggledLegendId)for(t=0;t<this.maps.toggledLegendId.length;t++)l="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]+"_Text":"#"+this.maps.element.id+"_Legend_Text_Index_"+this.maps.toggledLegendId[t],e=u.svgObject.querySelector(l),n.isNullOrUndefined(e)||e.setAttribute("fill","#E5E5E5"),a="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]:"#"+this.maps.element.id+"_Legend_Shape_Index_"+this.maps.toggledLegendId[t],o=u.svgObject.querySelector(a),n.isNullOrUndefined(o)||o.setAttribute("fill","#E5E5E5")},t.prototype.renderLegendBorder=function(){var r=this.maps,i=r.legendSettings,f=i.title.text,t={fontFamily:i.titleStyle.fontFamily,fontStyle:i.titleStyle.fontStyle,fontWeight:i.titleStyle.fontWeight,size:i.titleStyle.size,color:i.titleStyle.color,opacity:i.titleStyle.opacity},s=g(this.legendItemRect.width+20,f,t),e=p(s,t),u,h,o;this.legendBorderRect=new a(this.legendItemRect.x-10,this.legendItemRect.y-10-e.height,this.legendItemRect.width+20,this.legendItemRect.height+20+e.height+("Interactive"===i.mode?0:0!==this.page?10:0));u={color:i.border.color||this.maps.themeStyle.legendBorderColor,opacity:i.border.opacity,width:i.border.width||this.maps.themeStyle.legendBorderWidth};u.opacity=n.isNullOrUndefined(u.opacity)?1:u.opacity;h=new d(r.element.id+"_Legend_Border",i.background,u,1,this.legendBorderRect,null,null,"","");(this.legendGroup.appendChild(r.renderer.drawRectangle(h)),this.getLegendAlignment(r,this.legendBorderRect.width,this.legendBorderRect.height,i),this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )"),"Float"!==i.position&&r.svgObject.appendChild(this.legendGroup),f)&&(t.color=null!==t.color?t.color:this.maps.themeStyle.legendTitleFontColor,t.fontFamily=n.isNullOrUndefined(t.fontFamily)?this.maps.themeStyle.fontFamily:t.fontFamily,t.size=n.isNullOrUndefined(t.size)?this.maps.themeStyle.subTitleFontSize||et.legendTitleFont.size:t.size,t.fontWeight=n.isNullOrUndefined(t.fontWeight)?this.maps.themeStyle.titleFontWeight||et.legendTitleFont.fontWeight:t.fontWeight,o=ht(new tt(r.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-e.height/2-5,"middle",s,""),t,t.color,this.legendGroup),o.setAttribute("aria-label",f),o.setAttribute("role","region"))},t.prototype.changeNextPage=function(t){this.currentPage=t.target.id.indexOf("_Left_Page_")>-1?this.currentPage-1:this.currentPage+1;this.legendGroup=this.maps.renderer.createGroup({id:this.maps.element.id+"_Legend_Group"});this.maps.mapAreaRect=this.initialMapAreaRect;this.drawLegendItem(this.currentPage);n.isNullOrUndefined(this.maps.legendModule)||"Float"!==this.maps.legendSettings.position||(this.maps.isTileMap?this.maps.mapLayerPanel.layerGroup.appendChild(this.maps.legendModule.legendGroup):this.maps.svgObject.appendChild(this.maps.legendModule.legendGroup));e(this.maps.element.id+"_Legend_Border",this.maps.element.id)&&(e(this.maps.element.id+"_Legend_Border",this.maps.element.id).style.pointerEvents="none")},t.prototype.getLegendAlignment=function(t,i,r,u){var s,h,e,o=10,c=(e=n.extend({},t.mapAreaRect,e,!0)).x,l=e.y,a=e.height,b=e.width,v=t.availableSize.width,y=t.availableSize.height,p=n.isNullOrUndefined(u.location.x)?0:"string"==typeof u.location.x&&u.location.x.indexOf("%")>-1?t.availableSize.width/100*parseFloat(u.location.x):"string"==typeof u.location.x?parseFloat(u.location.x):u.location.x,w=n.isNullOrUndefined(u.location.y)?0:"string"==typeof u.location.y&&u.location.y.indexOf("%")>-1?t.availableSize.height/100*parseFloat(u.location.y):"string"==typeof u.location.y?parseFloat(u.location.y):u.location.y;if("Float"===u.position)this.translate=t.isTileMap?new f(p,w+2.5):new f(p+t.mapAreaRect.x,w+t.mapAreaRect.y),this.legendTotalRect=t.mapAreaRect;else{switch(u.position){case"Top":case"Bottom":e.height="Top"===u.position?a-r:a-r-20;s=v/2-i/2;h="Top"===u.position?l:l+e.height;e.y="Top"===u.position?l+r+(t.isTileMap?5:o):l-5;break;case"Left":case"Right":e.width=b-i-t.mapAreaRect.x;s="Left"===u.position?c+5:c+e.width+o;h=y/2-r/2;e.x="Left"===u.position?c+i+o:c}switch(u.alignment){case"Near":"Top"===u.position||"Bottom"===u.position?s=e.x-("Interactive"===u.mode?o:0):h=e.y-(u.height&&u.width||"Interactive"!==u.mode?0:t.mapAreaRect.x);break;case"Far":"Top"===u.position||"Bottom"===u.position?s=v-i-("Interactive"===u.mode?0:o):h=y-r-("Default"===u.mode?o:0)}(u.height||u.width)&&"Interactive"!==u.mode?this.legendTotalRect=t.mapAreaRect=t.totalRect=e:(t.totalRect=null,(u.height||u.width)&&"Interactive"===u.mode&&(t.totalRect=e),this.legendTotalRect=t.mapAreaRect=e);"Left"===u.position&&(t.mapAreaRect.width=e.width);this.translate=new f(s,h)}},t.prototype.getMarkersLegendCollections=function(t,i){var r=this;Array.prototype.forEach.call(i,function(i,u){var e=i.dataSource,f=i.legendText;Array.prototype.forEach.call(e,function(e,o){var a=!!n.isNullOrUndefined(e[r.maps.legendSettings.showLegendPath])||e[r.maps.legendSettings.showLegendPath],s;if(i.visible&&a&&!n.isNullOrUndefined(e.latitude)&&!n.isNullOrUndefined(e.longitude)){i.template&&(s=ei(i.template,r.maps)(r.maps),(n.isNullOrUndefined(s.childElementCount)?s[0]:s).querySelector("img").src);var h=n.isNullOrUndefined(e[f])?"":e[f],c=n.isNullOrUndefined(i.colorValuePath)?i.fill:e[i.colorValuePath],l=[];r.maps.legendSettings.removeDuplicateLegend?(l.push(r.getMarkerLegendData(t,h,c)),r.getOverallLegendItemsCollection(h,c,l,a)):(l.push({layerIndex:t,markerIndex:u,dataIndex:o,value:c,name:h,shape:n.isNullOrUndefined(i.shapeValuePath)||n.isNullOrUndefined(e[i.shapeValuePath])||""===e[i.shapeValuePath]?r.maps.legendSettings.useMarkerShape?i.shape:r.maps.legendSettings.shape:e[i.shapeValuePath]}),r.getOverallLegendItemsCollection(h,c,l,a))}})})},t.prototype.getMarkerLegendData=function(t,i,r){var f=this,u=[];return this.maps.layers[t].markerSettings.map(function(e,o){var s=e.dataSource;Array.prototype.forEach.call(s,function(e,s){var h=f.maps.layers[t].markerSettings[o];i!==e[h.legendText]&&""!==i||r!==(e[h.colorValuePath]||h.fill)||u.push({layerIndex:t,markerIndex:o,dataIndex:s,value:r,name:i,shape:n.isNullOrUndefined(h.shapeValuePath)?h.shape:e[h.shapeValuePath]})})}),u},t.prototype.getRangeLegendCollection=function(t,i,r,u,f,e,o){for(var l,w=this,a=0,v=this.maps.legendSettings.fill,s=[],b=function(r){var c,p;n.isNullOrUndefined(r.from)||n.isNullOrUndefined(r.to)||(l=n.isNullOrUndefined(r.label)?r.from+" - "+r.to:r.label,s=[],c=!1,!n.isNullOrUndefined(u)&&u.length>0&&Array.prototype.forEach.call(u,function(n,u){var l=e.indexOf(".")>-1?Number(h(n,e)):parseFloat(n[e]);l>=r.from&&l<=r.to&&(c=!0,s.push(w.getLegendData(t,u,n,f,i,o,l)))}),c||s.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null}),p=n.isNullOrUndefined(v)?"[object Array]"===Object.prototype.toString.call(r.color)?n.isNullOrUndefined(r.value)?y.legendGradientColor(r,a):r.color[0]:r.color:v,a++,y.getOverallLegendItemsCollection(l,p,s,r.showLegend))},y=this,c=0,p=r;c<p.length;c++)b(p[c])},t.prototype.getOverallLegendItemsCollection=function(n,t,i,r){var f=[],s=this.maps.legendSettings,u,e,o;if(i.length>0&&r){for(u=0;u<i.length;u++){if(e=i[u],e.length>0)for(o=0;o<e.length;o++)f.push(e[o]);else f.push(i[u]);f._isVisible=!0}if(this.maps.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollection,n,t))for(u=0;u<this.legendCollection.length;u++)this.legendCollection[u].text===n&&this.legendCollection[u].fill===t&&this.legendCollection[u].data.push(f[0]);else this.legendCollection.push({text:n,fill:t,data:f,opacity:s.opacity,borderColor:s.shapeBorder.color,borderWidth:s.shapeBorder.width})}},t.prototype.removeDuplicates=function(n,t,i){for(var u=!1,r=0;r<n.length;r++)if((n[r].text===t||""===n[r].text)&&n[r].fill===i){u=!0;break}return u},t.prototype.getEqualLegendCollection=function(t,i,r,u,f,e,o){for(var l,v=this,w=this.maps.legendSettings.fill,c=[],a=[],s=[],y=[],d=function(p){var k,tt,nt,d,g,it,rt;if(n.isNullOrUndefined(p.value))n.isNullOrUndefined(p.minOpacity)&&n.isNullOrUndefined(p.maxOpacity)&&n.isNullOrUndefined(p.value)&&n.isNullOrUndefined(p.from)&&n.isNullOrUndefined(p.to)&&!n.isNullOrUndefined(p.color)&&((Array.prototype.forEach.call(u,function(n,r){for(var c=e.indexOf(".")>-1?h(n,e):n[e],u=0;u<s.length;u++)c===s[u]&&y.push(v.getLegendData(t,r,n,f,i,o,c))}),0===s.length)&&(k=!1,Array.prototype.forEach.call(u,function(u,s){k=!1;for(var h=u[e],c=0;c<r.length;c++)n.isNullOrUndefined(h)||isNaN(h)?k||(k=!1):h>=r[c].from&&h<=r[c].to&&(k=!0);k||y.push(v.getLegendData(t,s,u,f,i,o,h))})),l=n.isNullOrUndefined(p.label)?"Others":p.label,tt="[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color,b.getOverallLegendItemsCollection(l,tt,y,p.showLegend));else{for(l=n.isNullOrUndefined(p.label)?p.value:p.label,a=[],nt=!1,!n.isNullOrUndefined(u)&&u.length>0&&Array.prototype.forEach.call(u,function(n,r){var u=e&&e.indexOf(".")>-1?h(n,e):n[e];u===p.value?(nt=!0,-1===c.indexOf(u)&&c.push(u),a.push(v.getLegendData(t,r,n,f,i,o,u))):-1===s.indexOf(u)&&s.push(u)}),d=0;d<c.length;d++)for(g=0;g<s.length;g++)c[d]===s[g]&&(it=s.indexOf(c[d]),s.splice(it,1));nt||a.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null});rt=n.isNullOrUndefined(w)?"[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color:w;b.getOverallLegendItemsCollection(l,rt,a,p.showLegend)}},b=this,p=0,k=r;p<k.length;p++)d(k[p])},t.prototype.getDataLegendCollection=function(t,i,r,u,f,e,o){var l,s=this,a=this.maps.legendSettings.fill,c=this.maps.legendSettings.valuePath;n.isNullOrUndefined(e)||n.isNullOrUndefined(u)||Array.prototype.forEach.call(u,function(u,v){var w=!!n.isNullOrUndefined(s.maps.legendSettings.showLegendPath)||!n.isNullOrUndefined(u[s.maps.legendSettings.showLegendPath])&&u[s.maps.legendSettings.showLegendPath],y=e.indexOf(".")>-1?h(u,e):u[e],p=[],b=n.isNullOrUndefined(a)?y:a;n.isNullOrUndefined(y)||0!==r.length||n.isNullOrUndefined(c)&&n.isNullOrUndefined(f)||(l=n.isNullOrUndefined(u[c])?f.indexOf(".")>-1?h(u,f):u[f]:c.indexOf(".")>-1?h(u,c):u[c],p.push(s.getLegendData(t,v,u,f,i,o,y)));s.getOverallLegendItemsCollection(l,b,p,w)})},t.prototype.interactiveHandler=function(t){var o=t.target,i=this.maps.legendSettings,r=this.maps.element.id+"_Interactive_Legend",nt="Layers"===i.type?"_shapeIndex_":"Markers"===i.type?"_MarkerIndex_":"_BubbleIndex_",c,k,l,u;if(o.id.indexOf(nt)>1){var h=parseFloat(o.id.split("_LayerIndex_")[1].split("_")[0]),tt=parseFloat(o.id.split(/_dataIndex_/i)[1].split("_")[0]),p=void 0,w=void 0,b=void 0;if(n.isNullOrUndefined(e(r,this.maps.element.id))||n.remove(e(r,this.maps.element.id)),c=this.maps.layersCollection[h],k="Layers"===i.type?c.visible:"Markers"===i.type?c.markerSettings[parseFloat(o.id.split("_MarkerIndex_")[1].split("_")[0])].visible:this.maps.getBubbleVisible(this.maps.layersCollection[h]),i.visible&&this.legendRenderingCollections.length>0&&"Interactive"===i.mode&&k)for(l=this.maps.svgObject.getBoundingClientRect(),u=0;u<this.legendCollection.length;u++){var d=this.legendCollection[u],g=e(this.maps.element.id+"_Legend_Index_"+u,this.maps.element.id),s=g.getBoundingClientRect(),it=new a(Math.abs(s.left-l.left),Math.abs(s.top-l.top),s.width,s.height);if(p=g.getAttribute("fill"),w=i.shapeBorder.color,b=i.shapeBorder.width,!n.isNullOrUndefined(d.data))for(var v=d.data,rt=function(t){if(tt===v[t].dataIndex&&h===v[t].layerIndex){f.renderInteractivePointer(i,p,w,r,b,it);var u=e(r,f.maps.element.id);return f.maps.isDevice&&!n.isNullOrUndefined(u)&&(clearTimeout(f.arrowTimer),f.arrowTimer=setTimeout(function(){n.isNullOrUndefined(u.parentNode)||n.remove(u)},2e3)),"break"}},f=this,y=0;y<v.length&&"break"!==rt(y);y++);}}else n.isNullOrUndefined(e(r,this.maps.element.id))||n.remove(e(r,this.maps.element.id))},t.prototype.renderInteractivePointer=function(n,t,i,r,u,f){var l,e,o,s=10,h=10,a="None"===n.orientation?"Top"===n.position||"Bottom"===n.position?"Horizontal":"Vertical":n.orientation,c;f.y="Float"===n.position&&this.maps.isTileMap?f.y-this.maps.mapAreaRect.y:f.y;l="Horizontal"===a?n.invertedPointer?" M "+(e=f.x+f.width/2-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height)+" L "+(e-h)+" "+(o+s)+" L "+(e+h)+" "+(o+s)+" Z ":" M "+(e=f.x+f.width/2-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y)+" L "+(e-h)+" "+(o-s)+" L "+(e+h)+" "+(o-s)+" Z ":n.invertedPointer?" M "+(e=f.x-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height/2)+" L "+(e-h)+" "+(o-s)+" L "+(e-h)+" "+(o+s)+" z ":" M "+(e=f.x+f.width-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height/2)+" L "+(e+h)+" "+(o-s)+" L "+(e+h)+" "+(o+s)+" z ";c=new y(r,t,u,i,1,1,"",l);"Float"===n.position&&this.maps.isTileMap?this.maps.mapLayerPanel.layerGroup.appendChild(this.maps.renderer.drawPath(c)):this.maps.svgObject.appendChild(this.maps.renderer.drawPath(c))},t.prototype.wireEvents=function(t){n.EventHandler.add(t,n.Browser.touchStartEvent,this.changeNextPage,this)},t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.interactiveHandler,this),this.maps.on(n.Browser.touchEndEvent,this.interactiveHandler,this),this.maps.on(vt,this.legendClick,this))},t.prototype.markerToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].markerSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].markerSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].markerSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].markerSettings[r].border.opacity)?this.maps.layers[i].markerSettings[r].opacity:this.maps.layers[i].markerSettings[r].border.opacity).toString());var f=this.maps.toggledElementId.indexOf(t.id);-1!==f&&this.maps.toggledElementId.splice(f,1)},t.prototype.bubbleToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].bubbleSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].bubbleSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].bubbleSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].bubbleSettings[r].border.opacity)?this.maps.layers[i].bubbleSettings[r].opacity:this.maps.layers[i].bubbleSettings[r].border.opacity).toString())},t.prototype.legendClick=function(t){var f,s,p=this.maps.legendSettings.toggleLegendSettings.fill,d=this.maps.legendSettings.toggleLegendSettings.opacity,g=this.maps.legendSettings.toggleLegendSettings.border.color,nt=this.maps.legendSettings.toggleLegendSettings.border.width,tt=n.isNullOrUndefined(this.maps.legendSettings.toggleLegendSettings.border.opacity)?this.maps.legendSettings.toggleLegendSettings.opacity:this.maps.legendSettings.toggleLegendSettings.border.opacity,i,u,o,b,h,it,k,c,y,l,rt;if(!n.isNullOrUndefined(t.parentNode)&&t.parentNode.id.indexOf(this.maps.element.id+"_Legend_Index_")>-1){var a=void 0,r=parseFloat(t.parentElement.id.substr((this.maps.element.id+"_Legend_Index_").length)),w=(k=this.legendCollection[r].data)._isVisible,v=void 0;if(this.maps.legendSettings.toggleLegendSettings.enable&&("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type))for(i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(o=0;o<k.length;o++)v=this.legendCollection[r].data[o],a="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+v.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+v.dataIndex,this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+v.layerIndex+"_MarkerIndex_"+v.markerIndex+"_dataIndex_"+v.dataIndex,this.maps.element.id),n.isNullOrUndefined(v.shape)||"Balloon"!==v.shape||(a=(a="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+v.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+v.dataIndex+"_Group",this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+v.layerIndex+"_MarkerIndex_"+v.markerIndex+"_dataIndex_"+v.dataIndex+"_Group",this.maps.element.id)).children[0]),b=this.maps.toggledLegendId.indexOf(r),w&&null!==a?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(a.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),a.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),a.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),a.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),a.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(a.setAttribute("fill",p),a.setAttribute("fill-opacity",d.toString()),a.setAttribute("stroke",g),a.setAttribute("stroke-width",nt.toString()),a.setAttribute("stroke-opacity",tt.toString())),"Markers"===this.maps.legendSettings.type&&(-1===b&&this.maps.toggledLegendId.push(r),-1===this.maps.toggledElementId.indexOf(a.id)&&this.maps.toggledElementId.push(a.id)),null!==t&&(f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[i].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[i].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[i].shapeSettings.fill):this.setToggleAttributes(s,f,p,d,g,nt,tt,p))):("Markers"===this.maps.legendSettings.type?(-1!==b&&0===o&&this.maps.toggledLegendId.splice(b,1),this.markerToggleSelection(a,i,u,r)):this.bubbleToggleSelection(a,i,u,r),null!==t&&(f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,this.maps.legendSettings.textStyle.color),"HorizontalLine"!==this.maps.legendSettings.shape&&"VerticalLine"!==this.maps.legendSettings.shape&&"Cross"!==this.maps.legendSettings.shape||f.setAttribute("stroke",this.legendCollection[r].fill)));k._isVisible=!w}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(h=void 0,this.removeCollections(t,r),-1!==(b=this.maps.toggledLegendId.indexOf(r))&&(w=!1),u=0;u<this.maps.layers.length;u++)for(o=0;o<k.length;o++)(v=this.legendCollection[r].data[o],null!==(h=e(this.maps.element.id+"_LayerIndex_"+v.layerIndex+"_shapeIndex_"+v.shapeIndex+"_dataIndex_"+v.dataIndex,this.maps.element.id)))&&(it=this.maps.toggledElementId.indexOf(h.id),w?(0===o&&this.maps.toggledLegendId.push(r),-1===it&&this.maps.toggledElementId.push(h.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(h.setAttribute("fill",this.maps.layers[u].shapeSettings.fill),h.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),h.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),h.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),h.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString())):(h.setAttribute("fill",p),h.setAttribute("fill-opacity",d.toString()),h.setAttribute("stroke",g),h.setAttribute("stroke-width",nt.toString()),h.setAttribute("stroke-opacity",tt.toString())),null!==t&&(s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[u].shapeSettings.fill,this.maps.layers[u].shapeSettings.opacity,this.maps.layers[u].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity,this.maps.layers[u].shapeSettings.fill):this.setToggleAttributes(s,f,p,d,g,nt,tt,p))):(-1!==b&&0===o&&this.maps.toggledLegendId.splice(b,1),-1!==it&&this.maps.toggledElementId.splice(it,1),h.setAttribute("fill",this.legendCollection[r].fill),h.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString()),h.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),h.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),h.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),null!==t&&(s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,"#757575"))));k._isVisible=!w}}else if(!n.isNullOrUndefined(t.id)&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendSettings.visible&&-1===t.id.indexOf("_Text")){if(c=void 0,y=void(r=parseFloat(t.id.split(this.maps.element.id+"_Legend_Index_")[1])),w=(k=this.legendCollection[r].data)._isVisible,("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type)&&this.maps.legendSettings.toggleLegendSettings.enable)for(b=this.maps.toggledLegendId.indexOf(r),i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(o=0;o<k.length;o++)y=this.legendCollection[r].data[o],c="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+y.dataIndex,this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+y.dataIndex,this.maps.element.id),n.isNullOrUndefined(y.shape)||"Balloon"!==y.shape||(c=(c="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+y.dataIndex+"_Group",this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+y.dataIndex+"_Group",this.maps.element.id)).children[0]),w&&null!==c?("Markers"===this.maps.legendSettings.type&&(-1===b&&this.maps.toggledLegendId.push(r),-1===this.maps.toggledElementId.indexOf(c.id)&&this.maps.toggledElementId.push(c.id)),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(c.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),c.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),c.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),c.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),c.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString())):(c.setAttribute("fill",p),c.setAttribute("fill-opacity",d.toString()),c.setAttribute("stroke",g),c.setAttribute("stroke-width",nt.toString()),c.setAttribute("stroke-opacity",tt.toString())),null!==t&&(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[i].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[i].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[i].shapeSettings.fill):this.setToggleAttributes(s,f,p,d,g,nt,tt,p))):("Markers"===this.maps.legendSettings.type?(-1!==b&&0===o&&this.maps.toggledLegendId.splice(b,1),this.markerToggleSelection(c,i,u,r)):this.bubbleToggleSelection(c,i,u,r),null!==t&&((f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill),f.setAttribute("fill-opacity",this.legendCollection[r].opacity),f.setAttribute("stroke",this.legendCollection[r].shapeBorder.color),f.setAttribute("stroke-width",this.legendCollection[r].shapeBorder.width),f.setAttribute("stroke-opacity",this.legendCollection[r].shapeBorder.opacity),(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id)).setAttribute("fill",this.maps.legendSettings.textStyle.color)));k._isVisible=!w}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(l=void 0,this.removeCollections(t,r),rt=this.maps.toggledLegendId.indexOf(r),-1!==rt&&(w=!1),i=0;i<this.maps.layers.length;i++)for(o=0;o<k.length;o++)y=this.legendCollection[r].data[o],null!==(l=e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_shapeIndex_"+y.shapeIndex+"_dataIndex_"+y.dataIndex,this.maps.element.id))&&(it=this.maps.toggledElementId.indexOf(l.id),w?(0===o&&this.maps.toggledLegendId.push(r),-1===it&&this.maps.toggledElementId.push(l.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(l.setAttribute("fill",this.maps.layers[0].shapeSettings.fill),l.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),l.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),l.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),l.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(l.setAttribute("fill",p),l.setAttribute("fill-opacity",d.toString()),l.setAttribute("stroke",g),l.setAttribute("stroke-width",nt.toString()),l.setAttribute("stroke-opacity",tt.toString())),null!==t&&(f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[0].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[0].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[0].shapeSettings.fill):this.setToggleAttributes(s,f,p,d,g,nt,tt,p))):(-1!==rt&&0===o&&this.maps.toggledLegendId.splice(rt,1),-1!==it&&this.maps.toggledElementId.splice(it,1),l.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),l.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),l.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color||this.maps.themeStyle.shapeBorderColor),l.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),l.setAttribute("fill",this.legendCollection[r].fill),null!==t&&(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,"#757575"))));k._isVisible=!w}}},t.prototype.removeCollections=function(n,t){var i,r,u;this.removeLegendSelectionCollection(n);i=this.getIndexofLegend(this.maps.legendSelectionCollection,n);-1!==i&&this.maps.legendSelectionCollection.splice(i,1);-1!==this.getIndexofLegend(this.legendHighlightCollection,n)&&this.legendHighlightCollection.splice(i,1);r=this.getIndexofLegend(this.shapeHighlightCollection,n);-1!==r&&this.shapeHighlightCollection.splice(r,1);u=this.maps.selectedLegendElementId.indexOf(t);-1!==u&&this.maps.selectedLegendElementId.splice(u,1)},t.prototype.removeEventListener=function(){var t,i;if(!this.maps.isDestroyed&&(this.maps.off(n.Browser.touchMoveEvent,this.interactiveHandler),this.maps.off(n.Browser.touchEndEvent,this.interactiveHandler),this.maps.off(vt,this.legendClick),t=document.getElementById(this.maps.element.id+"_Legend_Paging_Group"),t))for(i=0;i<t.childElementCount;i++)n.EventHandler.remove(t.childNodes[i],n.Browser.touchStartEvent,this.changeNextPage)},t.prototype.getLegendData=function(t,i,r,u,f,e,o){var y=[],c,v;if("[object Array]"===Object.prototype.toString.call(f))for(c=0;c<f.length;c++){var s=f[c],l=u.indexOf(".")>-1?h(r,u):r[u],a=fi(r[u],e,s.properties),p=n.isNullOrUndefined(l)||"string"!=typeof l?l:l.toLowerCase();if((!n.isNullOrUndefined(s.properties[a])&&isNaN(s.properties[a])?s.properties[a].toLowerCase():s.properties[a])===p)if("MultiPoint"!==s.geometry.type)y.push({layerIndex:t,shapeIndex:c,dataIndex:i,name:r[u],value:o,pointIndex:-1});else for(v=0;v<s.geometry.coordinates.length;v++)y.push({layerIndex:t,shapeIndex:c,dataIndex:i,name:r[u],value:o,pointIndex:v})}return y},t.prototype.setToggleAttributes=function(t,i,r,u,f,e,o,s){t.setAttribute("fill",s);i.setAttribute("fill",r);i.setAttribute("fill-opacity",u.toString());i.setAttribute("stroke",f);i.setAttribute("stroke-width",e.toString());n.isNullOrUndefined(o)||i.setAttribute("stroke-opacity",o.toString())},t.prototype.legendGradientColor=function(t,i){var o,s="http://www.w3.org/2000/svg",u,h,f,c;if(!n.isNullOrUndefined(t.color)&&"object"==typeof t.color){var r=document.createElementNS(s,"linearGradient"),e=this.maps.legendSettings.position,l="Top"===e||"Bottom"===e?"100":"0",a="Top"===e||"Bottom"===e?"0":"100";for(r.setAttribute("id","linear_"+i+"_"+this.maps.element.id),r.setAttribute("x1","0%"),r.setAttribute("y1","0%"),r.setAttribute("x2",l+"%"),r.setAttribute("y2",a+"%"),u=0;u<t.color.length;u++)h=100/(t.color.length-1),f=document.createElementNS(s,"stop"),f.setAttribute("offset",u*h+"%"),f.setAttribute("stop-color",t.color[u]),f.setAttribute("stop-opacity",1..toString()),r.appendChild(f);this.legendLinearGradient=r;c="url(#linear_"+i+"_"+this.maps.element.id+")";this.defsElement.appendChild(r);o=c}return o},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.legendCollection=[];this.legendRenderingCollections=[];this.translate=null;this.legendBorderRect=null;this.initialMapAreaRect=null;this.legendTotalRect=null;this.totalPages=[];this.legendItemRect=null;this.legendGroup=null;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.legendLinearGradient=null;this.currentLayer=null;this.defsElement=null;this.legendElement=[];this.oldShapeElement=null;this.removeEventListener();this.maps=null},t}(),wo=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.mouseMove,this),this.maps.on(n.Browser.touchStartEvent,this.mouseMove,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(n.Browser.touchMoveEvent,this.mouseMove),this.maps.off(n.Browser.touchStartEvent,this.mouseMove))},t.prototype.addHighlight=function(n,t,i){var r=tu(n,t,0,this.maps);i?this.mapHighlight(r,null,null):l(r)},t.prototype.mouseMove=function(t){var r,i=t.target,y="touch"===t.pointerType||"2"===t.pointerType||t.type.indexOf("touch")>-1,c,a,u,e,v;if((-1!==i.id.indexOf("LayerIndex")||i.id.indexOf("NavigationIndex")>-1)&&"ShapeselectionMapStyle"!==i.getAttribute("class")&&!y&&"MarkerselectionMapStyle"!==i.getAttribute("class")&&"BubbleselectionMapStyle"!==i.getAttribute("class")&&"navigationlineselectionMapStyle"!==i.getAttribute("class")&&"PolygonselectionMapStyle"!==i.getAttribute("class")&&"LineselectionMapStyle"!==i.getAttribute("class")){r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10);var s=void 0,o=void 0,h=void 0,f=void 0;i.id.indexOf("shapeIndex")>-1?(h=parseInt(i.id.split("_shapeIndex_")[1].split("_")[0],10),s=this.maps.layers[r].shapeData.features&&!n.isNullOrUndefined(this.maps.layersCollection[r].layerData[h])?this.maps.layersCollection[r].layerData[h].property:null,f=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=n.isNullOrUndefined(f)?null:this.maps.layers[r].dataSource[f],this.highlightSettings=this.maps.layers[r].highlightSettings):i.id.indexOf("BubbleIndex")>-1?(c=parseInt(i.id.split("_BubbleIndex_")[1].split("_")[0],10),f=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].bubbleSettings[c].dataSource[f],this.highlightSettings=this.maps.layers[r].bubbleSettings[c].highlightSettings):i.id.indexOf("MarkerIndex")>-1?(a=parseInt(i.id.split("_MarkerIndex_")[1].split("_")[0],10),f=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].markerSettings[a].dataSource[f],this.highlightSettings=this.maps.layers[r].markerSettings[a].highlightSettings):i.id.indexOf("_PolygonIndex_")>-1?(f=parseInt(i.id.split("_PolygonIndex_")[1].split("_")[0],10),o=this.maps.layers[r].polygonSettings.polygons[f].points,this.highlightSettings=this.maps.layers[r].polygonSettings.highlightSettings):(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10),s=null,o={latitude:this.maps.layers[r].navigationLineSettings[u].latitude,longitude:this.maps.layers[r].navigationLineSettings[u].longitude},this.highlightSettings=this.maps.layers[r].navigationLineSettings[u].highlightSettings);this.highlightSettings.enable?this.handleHighlight(i,r,o,s):(e=document.getElementsByClassName("highlightMapStyle")[0],!n.isNullOrUndefined(e)&&(l(e),e.id.indexOf("NavigationIndex")>-1)&&(u=parseInt(e.id.split("_NavigationIndex_")[1].split("_")[0],10),v=parseInt(e.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),e.setAttribute("stroke-width",this.maps.layers[v].navigationLineSettings[u].width.toString()),e.setAttribute("stroke",this.maps.layers[v].navigationLineSettings[u].color)))}else lt("highlightMapStyle").length>0?((i=lt("highlightMapStyle")[0]).id.indexOf("NavigationIndex")>-1&&(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[r].navigationLineSettings[u].width.toString()),i.setAttribute("stroke",this.maps.layers[r].navigationLineSettings[u].color)),l(i),this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeShapeHighlightCollection()):(-1!==i.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")||-1!==i.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule&&this.maps.legendSettings.visible&&-1===i.id.indexOf("_Text")?this.maps.legendModule.legendHighLightAndSelection(i,"highlight"):this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeLegendHighlightCollection()},t.prototype.handleHighlight=function(n,t,i,r){this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule&&"Layers"===this.maps.legendSettings.type&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.highlightSettings,"highlight",t);n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule&&!this.maps.legendModule.shapeToggled||this.mapHighlight(n,r,i)},t.prototype.mapHighlight=function(t,i,r){var a=this,v=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),c=!1,l,u;t.id.indexOf("MarkerIndex")>-1&&(l=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),c=this.maps.layers[v].markerSettings[l].highlightSettings.enable);var o=-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.color:this.highlightSettings.fill||this.highlightSettings.border.color,s=-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.width/(c?1:this.maps.scale):this.highlightSettings.border.width/this.maps.scale,h=n.isNullOrUndefined(this.highlightSettings.border.opacity)?this.highlightSettings.opacity:this.highlightSettings.border.opacity,f={opacity:this.highlightSettings.opacity,fill:-1===t.parentElement.id.indexOf("LineString")?-1===t.id.indexOf("NavigationIndex")?n.isNullOrUndefined(this.highlightSettings.fill)?t.getAttribute("fill"):this.highlightSettings.fill:"none":"transparent",border:{color:o,width:s,opacity:h},cancel:!1},e={opacity:f.opacity,fill:f.fill,border:{color:o,width:s,opacity:h},name:tf,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};t.id.indexOf("shapeIndex")>-1&&this.maps.trigger(tf,e,function(){});u={opacity:f.opacity,fill:f.fill,border:{color:o,width:s,opacity:h},name:pf,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};this.maps.trigger(pf,u,function(){u.cancel=f.cancel!==u.cancel?u.cancel:t.id.indexOf("shapeIndex")>-1?e.cancel:f.cancel;u.fill=f.fill!==u.fill?u.fill:t.id.indexOf("shapeIndex")>-1?e.fill:f.fill;u.opacity=f.opacity!==u.opacity?u.opacity:t.id.indexOf("shapeIndex")>-1?e.opacity:f.opacity;u.border.color=f.border.color!==u.border.color?u.border.color:t.id.indexOf("shapeIndex")>-1?e.border.color:f.border.color;u.border.width=f.border.width!==u.border.width?u.border.width:t.id.indexOf("shapeIndex")>-1?e.border.width:f.border.width;u.border.opacity=f.border.opacity!==u.border.opacity?u.border.opacity:t.id.indexOf("shapeIndex")>-1?e.border.opacity:f.border.opacity;a.highlightMap(t,u)})},t.prototype.highlightMap=function(n,t){var i,r,u;"highlightMapStyle"===n.getAttribute("class")||t.cancel||(lt("highlightMapStyle").length>0&&(i=lt("highlightMapStyle")[0],(l(i),i.id.indexOf("NavigationIndex")>-1)&&(r=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),u=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[u].navigationLineSettings[r].width.toString()),i.setAttribute("stroke",this.maps.layers[u].navigationLineSettings[r].color))),o("highlightMap")?at("highlightMap","highlightMapStyle",t):document.body.appendChild(kt("highlightMap","highlightMapStyle",t)),n.setAttribute("class","highlightMapStyle"))},t.prototype.getModuleName=function(){return"Highlight"},t.prototype.destroy=function(){this.highlightSettings=null;this.removeEventListener();this.maps=null},t}(),bo=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||this.maps.on(vt,this.mouseClick,this)},t.prototype.removeEventListener=function(){this.maps.isDestroyed||this.maps.off(vt,this.mouseClick)},t.prototype.mouseClick=function(t){var s,h,e;if(!n.isNullOrUndefined(t.type)&&-1!==t.type.indexOf("touch")&&n.isNullOrUndefined(t.id)&&(t=t.target),!n.isNullOrUndefined(t.id)&&(t.id.indexOf("LayerIndex")>-1||t.id.indexOf("NavigationIndex")>-1)){var o=void 0,u=void 0,f=void 0,r=void 0,i=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10);t.id.indexOf("shapeIndex")>-1?(f=parseInt(t.id.split("_shapeIndex_")[1].split("_")[0],10),o=!n.isNullOrUndefined(this.maps.layers[i].shapeData.features)&&this.maps.layers[i].shapeData.features.length>f?this.maps.layers[i].shapeData.features[f].properties:!n.isNullOrUndefined(this.maps.layers[i].shapeData.geometries)&&this.maps.layers[i].shapeData.geometries.length>f?this.maps.layers[i].shapeData.geometries[f].properties:null,r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=n.isNullOrUndefined(r)?null:this.maps.layers[i].dataSource[r],this.selectionsettings=this.maps.layers[i].selectionSettings,this.selectionType="Shape"):t.id.indexOf("BubbleIndex")>-1?(s=parseInt(t.id.split("_BubbleIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].bubbleSettings[s].dataSource[r],this.selectionsettings=this.maps.layers[i].bubbleSettings[s].selectionSettings,this.selectionType="Bubble"):t.id.indexOf("MarkerIndex")>-1?(h=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].markerSettings[h].dataSource[r],this.selectionsettings=this.maps.layers[i].markerSettings[h].selectionSettings,this.selectionType="Marker"):t.id.indexOf("_PolygonIndex_")>-1?(r=parseInt(t.id.split("_PolygonIndex_")[1].split("_")[0],10),u=this.maps.layers[i].polygonSettings.polygons[r].points,this.selectionsettings=this.maps.layers[i].polygonSettings.selectionSettings,this.selectionType="Polygon"):t.id.indexOf("NavigationIndex")>-1&&(e=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),o=null,u={latitude:this.maps.layers[i].navigationLineSettings[e].latitude,longitude:this.maps.layers[i].navigationLineSettings[e].longitude},this.selectionsettings=this.maps.layers[i].navigationLineSettings[e].selectionSettings,this.selectionType="navigationline");!n.isNullOrUndefined(this.selectionsettings)&&this.selectionsettings.enable&&this.selectElement(t,i,u,o)}else this.maps.legendSettings.visible&&!this.maps.legendSettings.toggleLegendSettings.enable&&this.maps.legendModule&&!n.isNullOrUndefined(t.id)&&-1===t.id.indexOf("_Text")&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule.legendHighLightAndSelection(t,"selection")},t.prototype.selectElement=function(n,t,i,r){this.maps.mapSelect=!!n;this.maps.legendModule&&this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.selectionsettings,"selection",t);(!(n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule)||this.maps.legendModule.shapeToggled)&&this.selectMap(n,r,i)},t.prototype.addSelection=function(n,t,i){var r=tu(n,t,0,this.maps);i?this.selectMap(r,null,null):l(r)},t.prototype.selectMap=function(t,i,u){var f=this,s=t.parentElement.id.indexOf("LineString")>-1,h={color:s&&this.selectionsettings.fill||this.selectionsettings.border.color,width:s?this.selectionsettings.border.width/this.maps.scale:this.selectionsettings.border.width/("Marker"===this.selectionType?1:this.maps.scale),opacity:this.selectionsettings.border.opacity},e={opacity:this.selectionsettings.opacity,fill:s?"transparent":"navigationline"!==this.selectionType?this.selectionsettings.fill:"none",border:h,name:yf,target:t.id,cancel:!1,shapeData:i,data:u,maps:this.maps};this.maps.trigger("itemSelection",e,function(){var a,h,c,i,w,p,b;if(e.border.opacity=n.isNullOrUndefined(f.selectionsettings.border.opacity)?f.selectionsettings.opacity:f.selectionsettings.border.opacity,!e.cancel)if(t.getAttribute("class")===f.selectionType+"selectionMapStyle"||"LineselectionMapStyle"===t.getAttribute("class")){for(l(t),f.removedSelectionList(t),a=0;a<f.maps.shapeSelectionItem.length;a++)if(f.maps.shapeSelectionItem[a]===e.shapeData){f.maps.shapeSelectionItem.splice(a,1);break}t.id.indexOf("NavigationIndex")>-1&&(h=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),c=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),t.setAttribute("stroke-width",f.maps.layers[c].navigationLineSettings[h].width.toString()),t.setAttribute("stroke",f.maps.layers[c].navigationLineSettings[h].color))}else{if(i=r(f.maps.element.id+"_Layer_Collections"),!f.selectionsettings.enableMultiSelect&&(i.getElementsByClassName(f.selectionType+"selectionMapStyle").length>0||i.getElementsByClassName("LineselectionMapStyle").length>0)){for(var y=i.getElementsByClassName(f.selectionType+"selectionMapStyle").length,u=void 0,v=0;v<y;v++)l(u=i.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),f.removedSelectionList(u);if(i.getElementsByClassName("LineselectionMapStyle").length>0)for(y=i.getElementsByClassName("LineselectionMapStyle").length,v=0;v<y;v++)l(u=i.getElementsByClassName("LineselectionMapStyle")[0]),f.removedSelectionList(u);if("Shape"===f.selectionType)for(f.maps.shapeSelectionItem=[],w=f.maps.selectedElementId.length,p=0;p<w;p++)l(u=i.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),b=f.maps.selectedElementId.indexOf(u.getAttribute("id")),f.maps.selectedElementId.splice(b,1);u.id.indexOf("NavigationIndex")>-1&&(h=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),c=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),u.setAttribute("stroke-width",f.maps.layers[c].navigationLineSettings[h].width.toString()),u.setAttribute("stroke",f.maps.layers[c].navigationLineSettings[h].color))}s?(o("LineselectionMap")?at("LineselectionMap","LineselectionMapStyle",e):document.body.appendChild(kt("LineselectionMap","LineselectionMapStyle",e)),t.setAttribute("class","LineselectionMapStyle")):(o(f.selectionType+"selectionMap")?at(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e):document.body.appendChild(kt(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e)),t.setAttribute("class",f.selectionType+"selectionMapStyle"));"ShapeselectionMapStyle"===t.getAttribute("class")&&(f.maps.shapeSelectionClass=o(f.selectionType+"selectionMap"),f.maps.selectedElementId.push(t.getAttribute("id")),f.maps.shapeSelectionItem.push(e.shapeData));"MarkerselectionMapStyle"===t.getAttribute("class")&&(f.maps.markerSelectionClass=o(f.selectionType+"selectionMap"),f.maps.selectedMarkerElementId.push(t.getAttribute("id")));"BubbleselectionMapStyle"===t.getAttribute("class")&&(f.maps.bubbleSelectionClass=o(f.selectionType+"selectionMap"),f.maps.selectedBubbleElementId.push(t.getAttribute("id")));"navigationlineselectionMapStyle"===t.getAttribute("class")&&(f.maps.navigationSelectionClass=o(f.selectionType+"selectionMap"),f.maps.selectedNavigationElementId.push(t.getAttribute("id")));"PolygonselectionMapStyle"===t.getAttribute("class")&&(f.maps.polygonSelectionClass=o(f.selectionType+"selectionMap"),f.maps.selectedPolygonElementId.push(t.getAttribute("id")))}})},t.prototype.removedSelectionList=function(n){"Shape"===this.selectionType&&this.maps.selectedElementId.splice(this.maps.selectedElementId.indexOf(n.getAttribute("id")),1);"Bubble"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1);"Marker"===this.selectionType&&this.maps.selectedMarkerElementId.splice(this.maps.selectedMarkerElementId.indexOf(n.getAttribute("id")),1);"navigationline"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1);"Polygon"===this.selectionType&&this.maps.selectedPolygonElementId.splice(this.maps.selectedPolygonElementId.indexOf(n.getAttribute("id")),1)},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.selectionsettings=null;this.removeEventListener();this.maps=null},t}(),ko=function(){function t(n){this.maps=n;this.tooltipId=this.maps.element.id+"_mapsTooltip";this.addEventListener()}return t.prototype.renderTooltip=function(t){var ht,ct,b,lt,f,i,k,r=this,rt,o,gt,vt,d,it,ft,et,ti,ri,v,st,ui;(-1!==t.type.indexOf("touch")?(this.isTouch=!0,ht=(lt=t).changedTouches[0].pageX,ct=lt.changedTouches[0].pageY,b=lt.target):(this.isTouch="touch"===t.pointerType,ht=t.pageX,ct=t.pageY,b=t.target),-1===b.id.indexOf(this.maps.element.id))&&(rt=b.closest("."+this.maps.element.id+"_marker_template_element"),!n.isNullOrUndefined(rt)&&rt.id.indexOf("_MarkerIndex_")>-1&&(b=rt));var tt,ut,yt,g,wt,l,s="",e=b.id,w=[],y=e.indexOf("_LayerIndex_")>-1&&parseFloat(e.split("_LayerIndex_")[1].split("_")[0]),u=this.maps.layersCollection[y],bt=[],ei=li(ht,ct,this.maps.svgObject);this.tooltipTargetID=e;var kt=null,dt=null,at=this.maps.getClickLocation(e,t.pageX,t.pageY,b,t.layerX,t.layerY,"tooltip");if(n.isNullOrUndefined(at)||(kt=at.latitude,dt=at.longitude),o=e.indexOf("_PolygonIndex_")>-1,(e.indexOf("_shapeIndex_")>-1||e.indexOf("_MarkerIndex_")>-1||e.indexOf("_BubbleIndex_")>-1||e.indexOf("_PolygonIndex_")>-1)&&null===this.maps.markerDragArgument){if(e.indexOf("_PolygonIndex_")>-1)gt=parseInt(e.split("_PolygonIndex_")[1].split("_")[0],10),k=u.polygonSettings.tooltipSettings,l=u.polygonSettings.polygons[gt],g=k.textStyle,wt=k.fill,bt.push(l.tooltipText);else if(e.indexOf("_shapeIndex_")>-1){if(i=u.tooltipSettings,vt=parseInt(e.split("_shapeIndex_")[1].split("_")[0],10),n.isNullOrUndefined(u.layerData)||n.isNullOrUndefined(u.layerData[vt]))return;var a=u.layerData[vt].property,ni=!1,nt="[object Array]"===Object.prototype.toString.call(u.shapePropertyPath)?u.shapePropertyPath:[u.shapePropertyPath];if(!n.isNullOrUndefined(nt)){for(d=0;d<nt.length;d++)if(!n.isNullOrUndefined(u.dataSource)&&!n.isNullOrUndefined(u.shapeDataPath))for(it=0;it<u.dataSource.length;it++)if(ft=u.dataSource[it],et=u.shapeDataPath.indexOf(".")>-1?h(ft,u.shapeDataPath):ft[u.shapeDataPath],(!n.isNullOrUndefined(et)&&isNaN(ft[u.shapeDataPath])?et.toLowerCase():et)===(!n.isNullOrUndefined(a[nt[d]])&&isNaN(a[nt[d]])?a[nt[d]].toLowerCase():a[nt[d]])){ni=!0;y=it;d=nt.length;break}if(y=ni?y:null,u.dataSource&&u.dataSource.length>0){if(!n.isNullOrUndefined(u.dataSource[y]))for(ut in w=JSON.parse(JSON.stringify(u.dataSource[y])),a)w.hasOwnProperty(ut)||(w[ut]=a[ut])}else w=a}!i.visible||(n.isNullOrUndefined(y)||isNaN(y))&&n.isNullOrUndefined(a)||(u.tooltipSettings.format?s=this.formatter(u.tooltipSettings.format,w):(ti=fi(u.shapeDataPath,u.shapePropertyPath,a),s=n.isNullOrUndefined(u.dataSource)||n.isNullOrUndefined(y)?a[ti]:pt(i.valuePath.indexOf(".")>-1?h(u.dataSource[y],i.valuePath):u.dataSource[y][i.valuePath],this.maps),n.isNullOrUndefined(s)&&!n.isNullOrUndefined(i.valuePath)&&(s=i.valuePath.indexOf(".")>-1?h(a,i.valuePath):a[i.valuePath])))}else if(e.indexOf("_MarkerIndex_")>-1){var ii=parseInt(e.split("_MarkerIndex_")[1].split("_")[0],10),p=parseInt(e.split("_MarkerIndex_")[1].split("_")[2],10),c=u.markerSettings[ii];i=c.tooltipSettings;w=c.dataSource[p];i.visible&&!isNaN(ii)&&(c.tooltipSettings.format?s=this.formatter(c.tooltipSettings.format,c.dataSource[p]):"function"!=typeof c.template&&c.template&&!c.tooltipSettings.valuePath?s=c.template.split(">")[1].split("<")[0]:n.isNullOrUndefined(c.tooltipSettings.valuePath)||(s=pt(c.tooltipSettings.valuePath.indexOf(".")>-1?h(c.dataSource[p],c.tooltipSettings.valuePath):c.dataSource[p][c.tooltipSettings.valuePath],this.maps)))}else e.indexOf("_BubbleIndex_")>-1&&(ri=parseInt(e.split("_BubbleIndex_")[1].split("_")[0],10),v=(p=parseInt(e.split("_BubbleIndex_")[1].split("_")[2],10),u.bubbleSettings[ri]),i=v.tooltipSettings,w=v.dataSource[p],i.visible&&!isNaN(p)&&(v.tooltipSettings.format?s=this.formatter(v.tooltipSettings.format,v.dataSource[p]):n.isNullOrUndefined(v.tooltipSettings.valuePath)||(s=pt(v.tooltipSettings.valuePath.indexOf(".")>-1?h(v.dataSource[p],v.tooltipSettings.valuePath):v.dataSource[p][v.tooltipSettings.valuePath],this.maps))));(o?k.visible:i.visible)?(document.getElementById(this.tooltipId)?tt=document.getElementById(this.tooltipId):(tt=n.createElement("div",{id:this.maps.element.id+"_mapsTooltip",className:"EJ2-maps-Tooltip"}),n.isNullOrUndefined(o?l.tooltipTemplate:i.template)||(o?""===l.tooltipTemplate:""===i.template)||"MouseMove"===this.maps.tooltipDisplayMode?tt.style.cssText="position: absolute;pointer-events:none;":tt.style.position="absolute",document.getElementById(this.maps.element.id+"_Secondary_Element").appendChild(tt)),o?l.tooltipTemplate:i.template,(o?null!==l.tooltipTemplate:null!==i.template)&&1===Object.keys((o?l.tooltipTemplate:i.template,o?l.tooltipTemplate:i.template)).length&&(o?l.tooltipTemplate=l.tooltipTemplate[Object.keys(l.tooltipTemplate)[0]]:i.template=i.template[Object.keys(i.template)[0]]),st={location:ei,text:bt,data:w=this.setTooltipContent(i,w),textStyle:{color:o?g.color:i.textStyle.color,fontFamily:o?g.fontFamily:i.textStyle.fontFamily,fontStyle:o?g.fontStyle:i.textStyle.fontStyle,fontWeight:o?g.fontWeight:i.textStyle.fontWeight,opacity:o?g.opacity:i.textStyle.opacity,size:o?g.size:i.textStyle.size},template:o?l.tooltipTemplate:i.template},""!==(f={cancel:!1,name:nf,options:st,fill:o?wt:i.fill,maps:this.maps,latitude:kt,longitude:dt,element:b,eventArgs:t,content:o?n.isNullOrUndefined(l.tooltipText)?"":l.tooltipText:n.isNullOrUndefined(s)?"":s.toString()}).content||""!==f.options.template?this.maps.trigger(nf,f,function(){var h,u;f.cancel||n.isNullOrUndefined(s)||-1!==e.indexOf("_cluster_")||-1!==e.indexOf("_dataLabel_")?r.clearTooltip(t.target):(r.maps.isProtectedOnChange=!0,f.options.textStyle.size=f.options.textStyle.size||r.maps.themeStyle.fontSize,f.options.textStyle.color=f.options.textStyle.color||r.maps.themeStyle.tooltipFontColor,f.options.textStyle.fontFamily=f.options.textStyle.fontFamily||r.maps.themeStyle.fontFamily,f.options.textStyle.fontWeight=f.options.textStyle.fontWeight||r.maps.themeStyle.fontWeight,f.options.textStyle.opacity=f.options.textStyle.opacity||r.maps.themeStyle.tooltipTextOpacity,h=o?{color:k.border.color||r.maps.themeStyle.tooltipBorderColor,width:k.border.width,opacity:k.border.opacity}:{color:i.border.color||r.maps.themeStyle.tooltipBorderColor,width:i.border.width,opacity:i.border.opacity},(r.svgTooltip=f.cancel?new ot.Tooltip({theme:r.maps.theme,enable:!0,header:"",data:i.data,template:i.template,content:f.content.toString()!==s.toString()?[f.content.toString()]:[s.toString()],shapes:[],location:i.location,palette:[yt],areaBounds:r.maps.mapAreaRect,textStyle:i.textStyle,availableSize:r.maps.availableSize,fill:i.fill||r.maps.themeStyle.tooltipFillColor,enableShadow:!0,border:h}):new ot.Tooltip({theme:r.maps.theme,enable:!0,header:"",data:f.options.data,template:f.options.template,content:f.content.toString()!==s.toString()?[f.content.toString()]:[s.toString()],shapes:[],location:f.options.location,palette:[yt],areaBounds:r.maps.mapAreaRect,textStyle:f.options.textStyle,availableSize:r.maps.availableSize,fill:f.fill||r.maps.themeStyle.tooltipFillColor,enableShadow:!0,border:h}),(r.maps.isVue||r.maps.isVue3)&&(r.svgTooltip.controlInstance=r.maps),r.svgTooltip.opacity=r.maps.themeStyle.tooltipFillOpacity||r.svgTooltip.opacity,r.svgTooltip.appendTo(tt),r.maps.renderReactTemplates(),r.maps.isDevice)&&(u=e.indexOf("_MarkerIndex_")>-1||e.indexOf("_BubbleIndex_")>-1||e.indexOf("_shapeIndex_")>-1?i.duration:k.duration,null!==(u=!n.isNullOrUndefined(u)&&u>0?u:u<0?2e3:null)&&(clearTimeout(r.tooltipTimer),r.tooltipTimer=setTimeout(r.removeTooltip.bind(r),u))))}):this.clearTooltip(t.target),this.svgTooltip&&this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:st,element:this.svgTooltip.element}),this.svgTooltip?this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:st,element:this.svgTooltip.element}):this.clearTooltip(t.target)):this.clearTooltip(t.target)}else ui=t.target.closest("#"+this.maps.element.id+"_mapsTooltipparent_template"),n.isNullOrUndefined(ui)&&this.clearTooltip(t.target)},t.prototype.setTooltipContent=function(t,i){var r=n.extend({},i,null,!0);return this.maps.format&&!isNaN(Number(r[t.valuePath]))?r[t.valuePath]=nu(this.maps,Number(r[t.valuePath])):r=Object.keys(r).length?r:void 0,r},t.prototype.formatter=function(n,t){var i,u,r;for(void 0===t&&(t={}),i=0,u=Object.keys(t);i<u.length;i++)r=u[i],n="object"==typeof t[r]?er("",n,t,this.maps):n.split("${"+r+"}").join(pt(t[r],this.maps));return n},t.prototype.mouseUpHandler=function(t){n.isNullOrUndefined(this.maps)||(this.renderTooltip(t),"MouseMove"===this.maps.tooltipDisplayMode&&(clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout(this.removeTooltip.bind(this),2e3)))},t.prototype.removeTooltip=function(){var t=!1;return document.getElementsByClassName("EJ2-maps-Tooltip").length>0&&(n.remove(document.getElementsByClassName("EJ2-maps-Tooltip")[0]),t=!0),t},t.prototype.clearTooltip=function(t){var i=t.closest("#"+this.maps.element.id+"_mapsTooltipparent_template");n.isNullOrUndefined(i)&&this.removeTooltip()&&this.maps.clearTemplate()},t.prototype.addEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.on("dblclick",this.renderTooltip,this):"Click"===this.maps.tooltipDisplayMode?this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this):this.maps.on(n.Browser.touchMoveEvent,this.renderTooltip,this),this.maps.on(n.Browser.touchCancelEvent,this.removeTooltip,this),this.maps.element.addEventListener("contextmenu",this.removeTooltip))},t.prototype.removeEventListener=function(){if(this.maps){if(this.maps.isDestroyed)return;"DoubleClick"===this.maps.tooltipDisplayMode?this.maps.off("dblclick",this.renderTooltip):"Click"===this.maps.tooltipDisplayMode?this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler):this.maps.off(n.Browser.touchMoveEvent,this.renderTooltip);this.maps.off(n.Browser.touchCancelEvent,this.removeTooltip);this.maps.element.removeEventListener("contextmenu",this.removeTooltip)}},t.prototype.getModuleName=function(){return"MapsTooltip"},t.prototype.destroy=function(){n.isNullOrUndefined(this.svgTooltip)||(this.svgTooltip.destroy(),this.svgTooltip.controlInstance=null,c(this.maps.element.id+"_mapsTooltip"));this.svgTooltip=null;this.maps=null},t}(),go=function(){function t(t){this.isPanModeEnabled=!1;this.mouseEnter=!1;this.isTouch=!1;this.rectZoomingStart=!1;this.browserName=n.Browser.info.name;this.isPointer=n.Browser.isPointer;this.handled=!1;this.isPanningInProgress=!1;this.isPan=!1;this.isZoomFinal=!1;this.isZoomSelection=!1;this.pinchFactor=1;this.startTouches=[];this.mouseDownLatLong={x:0,y:0};this.mouseMoveLatLong={x:0,y:0};this.isSingleClick=!1;this.maps=t;this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";this.cancelEvent=this.isPointer?"pointerleave":"mouseleave";this.selectionColor=this.maps.zoomSettings.toolbarSettings.buttonSettings.selectionColor;this.fillColor=this.maps.zoomSettings.toolbarSettings.buttonSettings.color;this.addEventListener()}return t.prototype.performZooming=function(t,i,r,u){var a=this,e,y,k,tt,d,g;void 0===u&&(u=!1);e=this.maps;e.previousProjection=i<=1.5?void 0:e.projectionType;e.defaultState=!1;e.initialCheck=!1;e.markerZoomedState=e.isMarkerZoomCompleted=!1;e.zoomPersistence=e.enablePersistence;var c=e.tileZoomLevel,nt=e.previousScale=e.scale,v=e.zoomSettings.maxZoom,b=e.zoomSettings.minZoom;i=v>=i?i:v;y=!0;switch(r.toLowerCase()){case"zoomin":y=i<=this.maps.zoomSettings.maxZoom;break;case"zoomout":y=i>=this.maps.zoomSettings.minZoom}if(y){if(k=e.tileTranslatePoint,!e.isTileMap&&(("ZoomIn"===r?i>=b&&i<=v:i>=b)||e.isReset)){var o=e.mapAreaRect,l=e.baseMapRectBounds.min,it=e.baseMapRectBounds.max,s=Math.abs(l.x-it.x),h=Math.abs(l.y-it.y),p=void 0,w=void 0;i<1.2&&"Eckert5"!==e.projectionType?(0!==s&&0!==h&&s!==h||(s=o.width/2,h=o.height),i=(i=parseFloat(Math.min(o.width/s,o.height/h).toFixed(2)))>1.05?1:i,e.translatePoint=this.calculateInitalZoomTranslatePoint(i,s,h,o,l,e)):(d=e.translatePoint,p=d.x-(o.width/nt-o.width/i)/(o.width/t.x),w=d.y-(o.height/nt-o.height/i)/(o.height/t.y),g=Math.abs(e.baseMapRectBounds.max.y-e.baseMapRectBounds.min.y)*i,p=g<e.mapAreaRect.height?o.x+(-l.x+(o.width/2-s/2)):p,w=g<e.mapAreaRect.height?o.y+(-l.y+(o.height/2-h/2)):w,e.translatePoint=new f(p,w));e.scale=i;e.zoomTranslatePoint=e.translatePoint;this.triggerZoomEvent(k,c,r)?(e.translatePoint=e.previousPoint,e.scale=e.mapScaleValue=e.previousScale):this.applyTransform(e,u)}else e.isTileMap&&i>=b&&i<=v&&((this.getTileTranslatePosition(c,i,t,r),e.tileZoomLevel=i,e.zoomSettings.zoomFactor=i,e.scale=Math.pow(2,i-1),"ZoomOut"===r&&e.zoomSettings.resetToInitial&&e.applyZoomReset&&i<=e.initialZoomLevel&&(e.initialCheck=!0,e.zoomPersistence=!1,e.tileTranslatePoint.x=e.initialTileTranslate.x,e.tileTranslatePoint.y=e.initialTileTranslate.y,i=e.tileZoomLevel=e.mapScaleValue=e.initialZoomLevel,e.scale=Math.pow(2,i-1)),e.mapScaleValue=isNaN(e.mapScaleValue)?1:e.mapScaleValue,e.translatePoint.y=(e.tileTranslatePoint.y-.01*e.mapScaleValue)/e.scale,e.translatePoint.x=(e.tileTranslatePoint.x-.01*e.mapScaleValue)/e.scale,this.triggerZoomEvent(k,c,r))?(e.translatePoint=e.tileTranslatePoint=new f(0,0),e.scale=e.previousScale,e.tileZoomLevel=c,e.zoomSettings.zoomFactor=e.previousScale):(document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),this.markerLineAnimation(e),e.mapLayerPanel.generateTiles(i,e.tileTranslatePoint,r+"wheel",null,t),tt=0===this.maps.layersCollection[0].animationDuration&&"Enable"===n.animationMode?1e3:this.maps.layersCollection[0].animationDuration,setTimeout(function(){a.applyTransform(a.maps,u);document.getElementById(a.maps.element.id+"_LayerIndex_1")&&(document.getElementById(a.maps.element.id+"_LayerIndex_1").style.display="block")},tt)));this.triggerZoomComplete(e,c,r)}this.maps.zoomNotApplied=!1;this.maps.isDevice&&this.removeToolbarOpacity(e.isTileMap?Math.round(e.tileZoomLevel):e.scale,e.element.id+"_Zooming_")},t.prototype.calculateInitalZoomTranslatePoint=function(n,t,i,r,u,e){t*=n;i*=n;var o=0!==u.x&&"layers"===e.translateType?e.availableSize.width-r.width:0,s=r.x+(-u.x+(r.width/2-t/2))-o,h=r.y+(-u.y+(r.height/2-i/2));return new f(s,h)},t.prototype.triggerZoomEvent=function(t,i,r){var e,u=this.maps,f;return u.isTileMap&&(u.mapScaleValue=n.isNullOrUndefined(u.mapScaleValue)?1:u.mapScaleValue,u.translatePoint.y=(u.tileTranslatePoint.y-.01*u.mapScaleValue)/u.scale,u.translatePoint.x=(u.tileTranslatePoint.x-.01*u.mapScaleValue)/u.scale),f=this.maps.getMinMaxLatitudeLongitude(),e=u.isTileMap?{cancel:!1,name:"zoom",type:r,maps:u,tileTranslatePoint:{previous:t,current:u.tileTranslatePoint},translatePoint:{previous:u.previousPoint,current:u.translatePoint},tileZoomLevel:{previous:i,current:u.tileZoomLevel},scale:{previous:u.previousScale,current:u.scale},minLatitude:f.minLatitude,maxLatitude:f.maxLatitude,minLongitude:f.minLongitude,maxLongitude:f.maxLongitude}:{cancel:!1,name:"zoom",type:r,maps:u,tileTranslatePoint:{},translatePoint:{previous:u.previousPoint,current:u.translatePoint},tileZoomLevel:{},scale:{previous:u.previousScale,current:u.scale},minLatitude:f.minLatitude,maxLatitude:f.maxLatitude,minLongitude:f.minLongitude,maxLongitude:f.maxLongitude},u.trigger("zoom",e),e.cancel},t.prototype.getTileTranslatePosition=function(n,t,i,r){var u=this.maps,s="ZoomOut"===r?10:"Reset"===r&&t>1?0:10,f=u.availableSize,e=256*Math.pow(2,n),o=256*Math.pow(2,t),h=(i.x-u.tileTranslatePoint.x)/e*100,c=(i.y-u.tileTranslatePoint.y)/e*100;u.tileTranslatePoint.x=1===t?f.width/2-256:i.x-h*o/100;u.tileTranslatePoint.y=1===t?f.height/2-256+2*s:i.y-c*o/100},t.prototype.performRectZooming=function(){var n,i,e,h,v,y;this.isDragZoom=!0;n=this.maps;i=n.availableSize;n.previousProjection=n.projectionType;var o,r=n.tileZoomLevel,c=n.tileTranslatePoint,u=this.zoomingRect,s=n.zoomSettings.maxZoom,p=n.zoomSettings.minZoom;if(u.height>0&&u.width>0){var l=this.zoomingRect.x+this.zoomingRect.width/2,a=this.zoomingRect.y+this.zoomingRect.height/2,t=void 0;n.isTileMap?(t=(t=r+Math.round(r+(i.width/u.width+i.height/u.height)/2))>=p&&t<=s?t:s,n.zoomSettings.zoomFactor=t,this.getTileTranslatePosition(r,t,{x:l,y:a}),n.tileZoomLevel=t,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,t))/Math.pow(2,t),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,t))/Math.pow(2,t),n.scale=Math.pow(2,t),(o=this.triggerZoomEvent(c,r,""))?(n.translatePoint=n.tileTranslatePoint=new f(0,0),n.scale=n.tileZoomLevel=n.zoomSettings.zoomFactor=r):n.mapLayerPanel.generateTiles(t,n.tileTranslatePoint)):(e=n.previousScale=n.scale,t=(t=e+Math.round((i.width/u.width+i.height/u.height)/2))<this.maps.zoomSettings.maxZoom?t:this.maps.zoomSettings.maxZoom,h=n.previousPoint=n.translatePoint,t<=s&&(v=h.x-(i.width/e-i.width/t)/(i.width/l),y=h.y-(i.height/e-i.height/t)/(i.height/a),n.translatePoint=new f(v,y)),n.scale=t<this.maps.zoomSettings.maxZoom?t:this.maps.zoomSettings.maxZoom,(o=this.triggerZoomEvent(c,r,""))&&(n.translatePoint=n.previousPoint,n.scale=n.previousScale),n.zoomTranslatePoint=n.translatePoint);o||(n.mapScaleValue=t,this.applyTransform(n,!1,!0),this.maps.zoomNotApplied=!1,this.zoomingRect=null)}this.isZoomFinal=this.isZoomSelection&&Math.round(n.scale)===this.maps.zoomSettings.maxZoom;this.triggerZoomComplete(n,r,"");this.removeToolbarOpacity(n.scale,this.maps.element.id+"_Zooming_")},t.prototype.setInteraction=function(n){this.lastScale=1;this.interaction=n},t.prototype.updateInteraction=function(){2===this.fingers?this.setInteraction("zoom"):this.setInteraction(null)},t.prototype.performPinchZooming=function(){var p,s,w,b,d,t=this.maps,h=t.tileZoomLevel,r=this.pinchFactor,g=t.tileTranslatePoint,a,u,i,k;if(this.maps.mergeCluster(),t.isTileMap)c=this.getTouchCenterPoint(),a=Math.sqrt(Math.pow(this.touchMoveList[0].pageX-this.touchMoveList[1].pageX,2)+Math.pow(this.touchMoveList[0].pageY-this.touchMoveList[1].pageY,2)),u=t.tileZoomLevel,n.isNullOrUndefined(this.pinchDistance)||(this.pinchDistance>a?u-=1:this.pinchDistance<a&&(u+=1),(u=Math.min(this.maps.zoomSettings.maxZoom,Math.max(this.maps.zoomSettings.minZoom,u)))!==t.tileZoomLevel&&(this.pinchFactor=u,t.previousScale=t.scale,t.tileZoomLevel=this.pinchFactor,t.scale=Math.pow(2,t.tileZoomLevel-1),this.getTileTranslatePosition(h,this.pinchFactor,{x:c.x,y:c.y},null),t.translatePoint.x=(t.tileTranslatePoint.x-.01*t.scale)/t.scale,t.translatePoint.y=(t.tileTranslatePoint.y-.01*t.scale)/t.scale,(p=this.triggerZoomEvent(g,h,""))?(t.translatePoint=t.tileTranslatePoint=new f(0,0),t.scale=t.previousScale,t.tileZoomLevel=h,t.zoomSettings.zoomFactor=t.previousScale):t.mapLayerPanel.generateTiles(u,t.tileTranslatePoint))),this.pinchDistance=a;else{i=t.mapAreaRect;t.isMarkerZoomCompleted=!1;t.previousScale=t.scale;t.previousPoint=t.translatePoint;t.previousProjection=t.projectionType;var nt=(w=this.touchStartList,b=this.touchMoveList,d=ou(w[0],w[1]),ou(b[0],b[1])/d),c=(s=function(n,t){var i=t.element.getBoundingClientRect(),r=i.top+document.defaultView.pageXOffset,u=i.left+document.defaultView.pageYOffset;return Array.prototype.slice.call(n).map(function(n){return{x:n.pageX-u,y:n.pageY-r}})}(this.touchMoveList,this.maps),{x:s.map(function(n){return n.x}).reduce(su)/s.length,y:s.map(function(n){return n.y}).reduce(su)/s.length}),rt=nt/this.lastScale;this.lastScale=nt;this.pinchFactor*=rt;this.pinchFactor=Math.min(this.maps.zoomSettings.maxZoom,Math.max(this.pinchFactor,this.maps.zoomSettings.minZoom));var l=t.baseMapRectBounds.min,tt=t.baseMapRectBounds.max,e=Math.abs(l.y-tt.y),o=Math.abs(l.x-tt.x),it=t.translatePoint,v=void 0,y=void 0;r<1.2&&"Eckert5"!==t.projectionType?(0!==o&&0!==e&&o!==e||(o=i.width/2,e=i.height),r=(r=parseFloat(Math.min(i.width/o,i.height/e).toFixed(2)))>1.05?1:r,t.translatePoint=this.calculateInitalZoomTranslatePoint(r,o,e,i,l,t)):(k=Math.abs(t.baseMapRectBounds.max.y-t.baseMapRectBounds.min.y)*r,v=it.x-(i.width/t.scale-i.width/r)/(i.width/c.x),y=it.y-(i.height/t.scale-i.height/r)/(i.height/c.y),v=k<t.mapAreaRect.height?i.x+(-l.x+(i.width/2-o/2)):v,y=k<t.mapAreaRect.height?i.y+(-l.y+(i.height/2-e/2)):y,t.translatePoint=new f(v,y));t.scale=r;(p=this.triggerZoomEvent(g,h,""))&&(t.translatePoint=t.previousPoint,t.scale=t.previousScale)}t.mapScaleValue=r;p||this.applyTransform(t);this.triggerZoomComplete(t,h,"");n.Browser.isDevice&&this.removeToolbarOpacity(t.isTileMap?Math.round(t.tileZoomLevel):t.scale,t.element.id+"_Zooming_")},t.prototype.getTouchCenterPoint=function(){for(var n=[],t=0;t<this.touchMoveList.length;t++)n.push(this.getMousePosition(this.touchMoveList[t].pageX,this.touchMoveList[t].pageY));return{x:(n[0].x+n[1].x)/2,y:(n[0].y+n[1].y)/2}},t.prototype.triggerZoomComplete=function(t,i,r){var f,u;t.zoomSettings.enable&&(t.isTileMap&&(t.mapScaleValue=n.isNullOrUndefined(t.mapScaleValue)?1:t.mapScaleValue,t.translatePoint.y=(t.tileTranslatePoint.y-.01*t.mapScaleValue)/t.scale,t.translatePoint.x=(t.tileTranslatePoint.x-.01*t.mapScaleValue)/t.scale),u=this.maps.getMinMaxLatitudeLongitude(),f=t.isTileMap?{cancel:!1,name:"zoomComplete",type:r,maps:t,tileTranslatePoint:{previous:t.tileTranslatePoint,current:t.tileTranslatePoint},translatePoint:{previous:t.previousPoint,current:t.translatePoint},tileZoomLevel:{previous:i,current:t.tileZoomLevel},scale:{previous:t.previousScale,current:t.scale},minLatitude:u.minLatitude,maxLatitude:u.maxLatitude,minLongitude:u.minLongitude,maxLongitude:u.maxLongitude}:{cancel:!1,name:"zoomComplete",type:r,maps:t,tileTranslatePoint:{},translatePoint:{previous:t.previousPoint,current:t.translatePoint},tileZoomLevel:{},scale:{previous:t.previousScale,current:t.scale},minLatitude:u.minLatitude,maxLatitude:u.maxLatitude,minLongitude:u.minLongitude,maxLongitude:u.maxLongitude},this.maps.trigger("zoomComplete",f))},t.prototype.drawZoomRectangle=function(){var n=this.maps,t=this.mouseDownPoints,i=this.mouseMovePoints,c={width:1,color:this.maps.themeStyle.rectangleZoomBorderColor},o=Math.abs(i.x-t.x),s=Math.abs(i.y-t.y),u=i.x>t.x?t.x:t.x-o,f=i.y>t.y?t.y:t.y-s,e,h;u>n.mapAreaRect.x&&u<n.mapAreaRect.x+n.mapAreaRect.width&&f>n.mapAreaRect.y&&f<n.mapAreaRect.y+n.mapAreaRect.height&&(this.zoomingRect=new a(u,f,o,s),e=n.renderer.createSvg({id:n.element.id+"_Selection_Rect_Zooming",width:n.availableSize.width,height:n.availableSize.height,style:"position: absolute;"}),h=new d(n.element.id+"_ZoomRect",this.maps.themeStyle.rectangleZoomFillColor,c,this.maps.themeStyle.rectangleZoomFillOpacity,this.zoomingRect,0,0,"","3"),e.appendChild(n.renderer.drawRectangle(h)),r(n.element.id+"_Secondary_Element").appendChild(e))},t.prototype.animateTransform=function(t,i,r,u,f){var e=0===this.currentLayer.animationDuration&&"Enable"===n.animationMode?1e3:this.currentLayer.animationDuration;i&&0!==e&&!this.maps.isTileMap?this.maps.isTileMap||ue(t,0,e,new b(r,u),f,this.maps.mapAreaRect,this.maps):this.maps.isTileMap&&t.id.indexOf("_Polygons_Group")>-1||t.setAttribute("transform","scale("+f+") translate( "+r+" "+u+" )")},t.prototype.applyTransform=function(t,i,r,u){var g,a,e=this,y,w,k;this.templateCount=0;var s=t.scale,h=t.translatePoint.x,l=t.translatePoint.y,nt=0;if((t.zoomShapeCollection=[],this.isPanningInProgress=u||!1,document.getElementById(t.element.id+"_mapsTooltip")&&c(t.element.id+"_mapsTooltip"),t.isTileMap)&&(y=document.getElementById(t.element.id+"_svg"),y))for(w=0;w<t.layers.length;w++)k=y.querySelector("#"+t.element.id+"_LayerIndex_"+w),k&&y.removeChild(k);if(this.layerCollectionEle){for(var tt=function(y){var w=f.layerCollectionEle.childNodes[y];if("g"===w.tagName){f.templateCount++;f.index=w.id.indexOf("_LayerIndex_")>-1&&parseFloat(w.id.split("_LayerIndex_")[1].split("_")[0]);f.currentLayer=t.layersCollection[f.index];for(var k=t.mapLayerPanel.calculateFactor(f.currentLayer),rt=w.childElementCount,tt=document.getElementById(t.element.id+"_LayerIndex_"+f.index+"_Markers_Template_Group"),ut=function(y){var d=w.childNodes[y],lt,ft,et,st,ht,rt,ot,ut,pt,wt;if(d.id.indexOf("_Markers_Group")>-1||d.id.indexOf("_bubble_Group")>-1||d.id.indexOf("_dataLableIndex_Group")>-1)if(d.id.indexOf("_Markers_Group")>-1)f.isPanModeEnabled&&u||n.isNullOrUndefined(d.childNodes[0])&&n.isNullOrUndefined(tt.childNodes[0])||(lt=n.isNullOrUndefined(d.childNodes[0])?tt.childNodes[0]:d.childNodes[0],f.markerTranslates(lt,k,h,l,s,"Marker",w)),(d=w.childNodes[y],!n.isNullOrUndefined(d)&&-1!==d.id.indexOf("Markers")&&(Array.prototype.forEach.call(d.childNodes,function(u,f){var v,o,y,c;if(e.markerTranslate(u,k,h,l,s,"Marker",r),v=parseInt(u.id.split("_dataIndex_")[1].split("_")[0],10),o=parseInt(u.id.split("_MarkerIndex_")[1].split("_")[0],10),e.currentLayer.markerSettings[o].initialMarkerSelection.length>0)for(y=e.currentLayer.markerSettings[o].dataSource[v],c=0;c<e.currentLayer.markerSettings[o].initialMarkerSelection.length;c++)e.currentLayer.markerSettings[o].initialMarkerSelection[c].latitude!==y.latitude&&e.currentLayer.markerSettings[o].initialMarkerSelection[c].longitude!==y.longitude||t.markerSelection(e.currentLayer.markerSettings[o].selectionSettings,t,d.children[f],e.currentLayer.markerSettings[o].dataSource[v]);(e.currentLayer.animationDuration>0||"Enable"===n.animationMode||(t.layersCollection[0].animationDuration>0||"Enable"===n.animationMode)&&"SubLayer"===e.currentLayer.type)&&!e.isPanModeEnabled&&(t.isTileMap||(a=i?a:"visibility:hidden",n.isNullOrUndefined(a)||(d.style.cssText=a)))}),f.isPanModeEnabled&&t.markerModule.sameMarkerData.length>0?yr(t.markerModule.sameMarkerData,t,d,!0):t.markerModule.sameMarkerData.length>0&&(t.markerModule.sameMarkerData=[],document.getElementById(t.element.id+"_mapsTooltip")&&c(t.element.id+"_mapsTooltip")),document.getElementById(t.element.id+"_mapsTooltip")&&t.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")&&!f.isPanModeEnabled))&&(ft=t.mapsTooltipModule,et=d.querySelector("#"+ft.tooltipTargetID),n.isNullOrUndefined(et)||("hidden"===et.style.visibility?c(t.element.id+"_mapsTooltip"):(st=parseFloat(et.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[1]),ht=parseFloat(et.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[2]),t.isTileMap&&(st+=+o(t.element.id+"_tile_parent").style.left.split("px")[0],ht+=+o(t.element.id+"_tile_parent").style.top.split("px")[0]),ft.svgTooltip.location.x=st,ft.svgTooltip.location.y=ht,ft.svgTooltip.enableAnimation=!1)));else if(d.id.indexOf("_bubble_Group")>-1)for(rt=void 0,ot=0;ot<d.childElementCount;ot++){rt=d.childNodes[ot];g=parseFloat(rt.id.split("_LayerIndex_")[1].split("_")[0]);for(var bt=parseFloat(rt.id.split("_BubbleIndex_")[1].split("_")[0]),kt=parseFloat(rt.id.split("_BubbleIndex_")[1].split("_")[2]),ct=0;ct<t.bubbleModule.bubbleCollection.length;ct++)if(ut=t.bubbleModule.bubbleCollection[ct],ut.LayerIndex===g&&ut.BubbleIndex===bt&&ut.DataIndex===kt){var dt=ut.center.x,gt=ut.center.y,at=(dt+h)*s,vt=(gt+l)*s,yt=0===f.currentLayer.animationDuration&&"Enable"===n.animationMode?1e3:f.currentLayer.animationDuration;r&&0!==yt?di(rt,0,yt,new b(at,vt)):rt.setAttribute("transform","translate( "+at+" "+vt+" )");break}}else d.id.indexOf("_dataLableIndex_Group")>-1&&!n.isNullOrUndefined(t.layers[f.index])&&(t.zoomLabelPositions=[],t.zoomLabelPositions=t.dataLabelModule.dataLabelCollections,pt=!t.isTileMap&&r,wt=[],Array.prototype.forEach.call(d.childNodes,function(i,r){var f,o,c;if(d.childNodes[r].id.indexOf("_LabelIndex_")>-1&&(f=parseFloat(d.childNodes[r].id.split("_LabelIndex_")[1].split("_")[0]),o=d.childNodes[r].id,t.zoomShapeCollection.push(o),e.dataLabelTranslate(d.childNodes[r],k,h,l,s,"DataLabel",pt,nt,u,wt),nt++,c=t.layers[e.index].dataLabelSettings.border,r>0&&c.width>1&&d.childNodes[r-1].id.indexOf("_rectIndex_")>-1&&!n.isNullOrUndefined(t.zoomLabelPositions[f]))){var y=(t.zoomLabelPositions[f].location.x+h)*s,w=(t.zoomLabelPositions[f].location.y+l)*s,a=p(d.childNodes[r].textContent,t.layers[e.index].dataLabelSettings.textStyle),v=d.childNodes[r-1],b=y-a.width/2,g=w-a.height/2-5;v.setAttribute("x",b);v.setAttribute("y",g)}}));else t.isTileMap&&d.id.indexOf("_line_Group")>-1?(d.remove(),w.children.length>0&&w.children[0]?w.insertBefore(t.navigationLineModule.renderNavigation(f.currentLayer,t.tileZoomLevel,f.index),w.children[1]):w.appendChild(t.navigationLineModule.renderNavigation(f.currentLayer,t.tileZoomLevel,f.index))):t.isTileMap&&d.id.indexOf("_Polygons_Group")>-1?f.currentLayer.polygonSettings.polygons.length>0&&(f.currentLayer.polygonSettings.polygons.map(function(i,r){var f=i.points,o=function(t,i,r,u){var f="";return!n.isNullOrUndefined(u)&&u.length>1&&(Array.prototype.forEach.call(u,function(n,u){var o=n.latitude,s=n.longitude,e=t.isTileMap?it(new b(s,o),i,t.tileTranslatePoint,!0):v(o,s,i,r,t);f+=0===u?"M "+e.x+" "+e.y:" L "+e.x+" "+e.y}),f+=" z "),f}(t,t.tileZoomLevel,e.currentLayer,f),u=document.getElementById(t.element.id+"_LayerIndex_"+e.index+"_PolygonIndex_"+r);n.isNullOrUndefined(u)||u.setAttribute("d",o)}),document.getElementById(t.element.id+"_LayerIndex_"+f.index+"_Polygons_Group").style.visibility=""):-1===d.id.indexOf("Legend")&&(fu(d,f.index,s,t),t.zoomTranslatePoint=t.translatePoint,f.animateTransform(d,r,h,l,s))},d=0;d<rt;d++)ut(d)}t.arrangeTemplate()},f=this,d=0;d<this.layerCollectionEle.childElementCount;d++)tt(d);n.isNullOrUndefined(this.currentLayer)||r&&0!==this.currentLayer.animationDuration&&!t.isTileMap||this.processTemplate(h,l,s,t)}},t.prototype.markerTranslates=function(t,i,u,f,e,o,s){var l=this,tt=0,g=0,nt=0,p=parseInt((t||s).id.split("_LayerIndex_")[1].split("_")[0],10),a=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement"}),k,w,y,d;a.style.pointerEvents="auto";document.getElementById(a.id)&&c(a.id);k=this.maps.mapAreaRect;w=n.createElement("div",{id:this.maps.element.id+"_LayerIndex_"+p+"_Markers_Template_Group",className:"template"});w.style.cssText="overflow: hidden; position: absolute;pointer-events: none;top:"+k.y+"px;left:"+k.x+"px;height:"+k.height+"px;width:"+k.width+"px;";document.getElementById(w.id)&&c(w.id);y=this.maps.layersCollection[p];d=this.maps.markerModule.allowInnerClusterSetting(y);Array.prototype.forEach.call(y.markerSettings,function(t,c){nt=0;g=0;var k=t.dataSource;n.isNullOrUndefined(k)||Array.prototype.forEach.call(k,function(rt,ut){l.maps.markerNullCount=c>=0&&0===ut?0:l.maps.markerNullCount;var ft={template:t.template,data:rt,maps:l.maps,marker:t,cancel:!1,name:rf,fill:t.fill,colorValuePath:t.colorValuePath,shapeValuePath:t.shapeValuePath,height:n.isNullOrUndefined(t.heightValuePath)||n.isNullOrUndefined(rt[t.heightValuePath])?t.height:rt[t.heightValuePath],width:n.isNullOrUndefined(t.widthValuePath)||n.isNullOrUndefined(rt[t.widthValuePath])?t.width:rt[t.widthValuePath],imageUrl:t.imageUrl,imageUrlValuePath:t.imageUrlValuePath,shape:t.shape,border:t.border};ft=yi(ft=pi(ft,rt),rt);l.maps.trigger("markerRendering",ft,function(){var ht,ct,lt,at;t.shapeValuePath!==ft.shapeValuePath&&(ft=pi(ft,rt));t.colorValuePath!==ft.colorValuePath&&(ft=yi(ft,rt));var ot=n.isNullOrUndefined(t.latitudeValuePath)?n.isNullOrUndefined(rt.latitude)?n.isNullOrUndefined(rt.Latitude)?null:rt.Latitude:parseFloat(rt.latitude):Number(h(rt,t.latitudeValuePath)),st=n.isNullOrUndefined(t.longitudeValuePath)?n.isNullOrUndefined(rt.longitude)?n.isNullOrUndefined(rt.Longitude)?null:rt.Longitude:parseFloat(rt.longitude):Number(h(rt,t.longitudeValuePath)),vt=t.offset;if(!ft.cancel&&t.visible&&!n.isNullOrUndefined(st)&&!n.isNullOrUndefined(ot)){var yt=l.maps.element.id+"_LayerIndex_"+p+"_MarkerIndex_"+c+"_dataIndex_"+ut,et=l.maps.isTileMap?it(new b(st,ot),l.maps.tileZoomLevel,l.maps.tileTranslatePoint,!0):v(ot,st,i,y,l.maps),pt={x:u,y:f};!ft.template||isNaN(et.x)||isNaN(et.y)?ft.template||isNaN(et.x)||isNaN(et.y)||(g++,pr(ft,t,k,ut,et,pt,yt,vt,e,l.maps,a)):(nt++,wr(ft,void 0,yt,rt,c,w,et,pt,e,vt,l.maps))}tt+=isNaN(ot)||isNaN(st)?1:0;nt+=ft.cancel?1:0;g+=ft.cancel?1:0;l.maps.markerNullCount=n.isNullOrUndefined(ot)||n.isNullOrUndefined(st)?l.maps.markerNullCount+1:l.maps.markerNullCount;ht=k.length-l.maps.markerNullCount;ct=!1;(t.clusterSettings.allowClustering||y.markerClusterSettings.allowClustering&&y.markerSettings.length>1?a.querySelectorAll("[id*='LayerIndex_"+p+"_MarkerIndex_"+c+"']:not([id*='_Group'])"):a.childNodes).length===ht-nt-tt&&"Template"!==o&&(l.maps.isTileMap?(lt=document.getElementById(l.maps.element.id+"_LayerIndex_"+p+"_Polygons_Group"),at=document.getElementById(l.maps.element.id+"_LayerIndex_"+p+"_Polygon_Group"),n.isNullOrUndefined(lt)?n.isNullOrUndefined(at)?s.insertBefore(a,s.firstElementChild):at.insertAdjacentElement("afterend",a):lt.insertAdjacentElement("afterend",a)):s.appendChild(a),(y.markerSettings[c].clusterSettings.allowClustering||!d&&y.markerClusterSettings.allowClustering)&&(l.maps.svgObject.appendChild(a),l.maps.element.appendChild(l.maps.svgObject),ct=wt(y,a,l.maps,p,c,a,s,!0,!0,null,d)));(t.clusterSettings.allowClustering||y.markerClusterSettings.allowClustering&&y.markerSettings.length>1?w.querySelectorAll("[id*='LayerIndex_"+p+"_MarkerIndex_"+c+"']:not([id*='_Group'])"):w.childNodes).length===ht-g-tt&&r(l.maps.element.id+"_Secondary_Element")&&(r(l.maps.element.id+"_Secondary_Element").appendChild(w),e>=1&&(t.clusterSettings.allowClustering||!d&&y.markerClusterSettings.allowClustering)&&!ct&&wt(y,w,l.maps,p,c,a,s,!1,!0,null,d))})})})},t.prototype.processTemplate=function(t,i,u,f){for(var e,v,c=0,o=0;o<this.templateCount;o++){var a=f.mapLayerPanel.calculateFactor(this.currentLayer),s=r(f.element.id+"_LayerIndex_"+o+"_Markers_Template_Group"),h=r(f.element.id+"_LayerIndex_"+o+"_Label_Template_Group"),l=r(f.element.id+"_LayerIndex_"+o+"_Polygons_Group");if(!n.isNullOrUndefined(s)&&s.childElementCount>0)for(s.style.visibility="visible",e=0;e<s.childElementCount;e++)this.markerTranslate(s.childNodes[e],a,t,i,u,"Template");if(!n.isNullOrUndefined(h)&&h.childElementCount>0)for(e=0;e<h.childElementCount;e++)this.dataLabelTranslate(h.childNodes[e],a,t,i,u,"Template",!1,c),c++;if(!n.isNullOrUndefined(l))for(e=0;e<l.childElementCount;e++)v=f.layersCollection[o].polygonSettings.polygons[e].borderWidth,l.childNodes[e].childNodes[0].setAttribute("stroke-width",(v/u).toString())}},t.prototype.dataLabelTranslate=function(t,i,u,f,e,o,s,h,c,l){var nt,tt,ot,ht,wt,at,vt,it,ut,k,ct,yt;void 0===s&&(s=!1);var a,d,w,y,pt,bt=this.maps.dataLabelModule.dataLabelCollections,rt=this.maps.layers[this.index].dataLabelSettings.textStyle,kt=parseFloat(t.id.split("_LayerIndex_")[1].split("_")[0]),dt=parseFloat(t.id.split("_shapeIndex_")[1].split("_")[0]);t.id.indexOf("_LabelIndex_")>-1&&(pt=parseFloat(t.id.split("_LabelIndex_")[1].split("_")[0]));var lt=0===this.currentLayer.animationDuration&&"Enable"===n.animationMode?1e3:this.currentLayer.animationDuration,ft=bt[h],et=h;if(ft.layerIndex===kt&&ft.shapeIndex===dt&&ft.labelIndex===pt)if(nt=ft.location.x,tt=ft.location.y,"Template"===o)ot=0,ht=0,this.maps.isTileMap?(ot=(nt+u)*e-(y=p(w=ft.dataLabelText,rt)).width/2,ht=(tt+f)*e-y.height):(wt=r(this.maps.element.id+"_Layer_Collections"),nt=Math.abs(this.maps.baseMapRectBounds.min.x-nt)*e,tt=Math.abs(this.maps.baseMapRectBounds.min.y-tt)*e,at=wt.getBoundingClientRect(),vt=t.parentElement.getBoundingClientRect(),ot=nt+(at.left-vt.left),ht=tt+(at.top-vt.top)),t.style.left=ot+"px",t.style.top=ht+"px";else{if(nt=(nt+u)*e,tt=(tt+f)*e,w=ft.dataLabelText,s&&0!==lt||t.setAttribute("transform","translate( "+nt+" "+tt+" )"),(n.isNullOrUndefined(c)||!c)&&("None"!==this.maps.layers[this.index].dataLabelSettings.smartLabelMode||"None"!==this.maps.layers[this.index].dataLabelSettings.intersectionAction)){var gt=tt-(y=st(w,rt)).height/2,ni=tt+y.height/2,v={rightWidth:nt+y.width/2,leftWidth:nt-y.width/2,heightTop:gt,heightBottom:ni};if("Hide"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(a=this.maps.dataLabelShape[et]*e>=y.width?w:"",t.textContent=a):(a=this.maps.dataLabelShape[et]>=y.width?w:"",t.textContent=a)),it=[],"Trim"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(a=g(this.maps.dataLabelShape[et]*e,w,rt,y.width,!0,it),t.textContent=a):(a=g(this.maps.dataLabelShape[et],w,rt,y.width,!0,it),t.textContent=a)),"Hide"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(ut=0;ut<l.length;ut++)if(!n.isNullOrUndefined(l[ut])){if(!(v.leftWidth>l[ut].rightWidth||v.rightWidth<l[ut].leftWidth||v.heightTop>l[ut].heightBottom||v.heightBottom<l[ut].heightTop)){a="";t.textContent=a;break}a=n.isNullOrUndefined(a)?w:a;t.textContent=a}l.push(v)}if("Trim"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(k=0;k<l.length;k++)if(!n.isNullOrUndefined(l[k]))if(v.rightWidth<l[k].leftWidth||v.leftWidth>l[k].rightWidth||v.heightBottom<l[k].heightTop||v.heightTop>l[k].heightBottom)(d=n.isNullOrUndefined(a)?w:a,e>1)&&(ct=it.length>0?it[0]:y.width,d=g(this.maps.dataLabelShape[et]*e,d,rt,ct,!0)),t.textContent=d;else{if(v.leftWidth>l[k].leftWidth){d=g((yt=l[k].rightWidth-v.leftWidth)-(v.rightWidth-v.leftWidth),a=n.isNullOrUndefined(a)?w:a,rt,ct=it.length>0?it[0]:y.width,!0);t.textContent=d;break}if(v.leftWidth<l[k].leftWidth){yt=v.rightWidth-l[k].leftWidth;d=g(Math.abs(yt-(v.rightWidth-v.leftWidth)),a=n.isNullOrUndefined(a)?w:a,rt,ct=it.length>0?it[0]:y.width,!0);t.textContent=d;break}}l.push(v);n.isNullOrUndefined(d)&&(d=g(this.maps.dataLabelShape[et]*e,w,rt,y.width,!0),t.textContent=d)}}(s||lt>0)&&di(t,0,lt,new b(nt,tt))}},t.prototype.markerTranslate=function(t,i,u,e,o,s,c){var w,b;void 0===c&&(c=!1);var nt=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),tt=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),y=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),k=this.maps.layersCollection[nt],l=k.markerSettings[tt];if(!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(l.dataSource)&&!n.isNullOrUndefined(l.dataSource[y])){var d=n.isNullOrUndefined(l.longitudeValuePath)?n.isNullOrUndefined(l.dataSource[y].longitude)?n.isNullOrUndefined(l.dataSource[y].Longitude)?0:parseFloat(l.dataSource[y].Longitude):parseFloat(l.dataSource[y].longitude):Number(h(l.dataSource[y],l.longitudeValuePath)),g=n.isNullOrUndefined(l.latitudeValuePath)?n.isNullOrUndefined(l.dataSource[y].latitude)?n.isNullOrUndefined(l.dataSource[y].Latitude)?0:parseFloat(l.dataSource[y].Latitude):parseFloat(l.dataSource[y].latitude):Number(h(l.dataSource[y],l.latitudeValuePath)),p=0===this.currentLayer.animationDuration&&"Enable"===n.animationMode?1e3:this.currentLayer.animationDuration,a=this.maps.isTileMap?it(new f(d,g),this.maps.tileZoomLevel,this.maps.tileTranslatePoint,!0):v(g,d,i,k,this.maps);this.maps.isTileMap?"Template"===s?(t.style.left=a.x+l.offset.x+"px",t.style.top=a.y+l.offset.y+"px"):(a.x+=l.offset.x,a.y+=l.offset.y,t.setAttribute("transform","translate( "+a.x+" "+a.y+" )")):"Template"===s?p>0?(a.x=Math.abs(this.maps.baseMapRectBounds.min.x-a.x)*o,a.y=Math.abs(this.maps.baseMapRectBounds.min.y-a.y)*o,w=r(this.maps.element.id+"_Layer_Collections").getBoundingClientRect(),b=t.parentElement.getBoundingClientRect(),t.style.left=a.x+(w.left-b.left)+l.offset.x+"px",t.style.top=a.y+(w.top-b.top)+l.offset.y+"px",t.style.transform="translate(-50%, -50%)"):(t.style.left=(a.x+u)*o+l.offset.x-this.maps.mapAreaRect.x+"px",t.style.top=(a.y+e)*o+l.offset.y-this.maps.mapAreaRect.y+"px"):(a.x=(a.x+u)*o+l.offset.x,a.y=(a.y+e)*o+l.offset.y,c&&0!==p?di(t,0,p,a):t.setAttribute("transform","translate( "+a.x+" "+a.y+" )"))}},t.prototype.markerLineAnimation=function(t){var i;if(t.isTileMap)for(i=0;i<t.layersCollection.length;i++){var u=r(this.maps.element.id+"_LayerIndex_"+i+"_Markers_Template_Group"),f=r(this.maps.element.id+"_LayerIndex_"+i+"_line_Group"),e=r(this.maps.element.id+"_LayerIndex_"+i+"_Polygons_Group");n.isNullOrUndefined(u)||(u.style.visibility="hidden");n.isNullOrUndefined(f)||(f.style.visibility="hidden");n.isNullOrUndefined(e)||(e.style.visibility="hidden")}},t.prototype.panning=function(t,i,u,e){var a,o=this.maps,k=this.mouseDownPoints,d=this.mouseMovePoints,g=o.scale,h,c,v,nt,p,w,b;if(o.markerZoomedState=!1,o.zoomPersistence=o.enablePersistence,o.defaultState=!1,o.initialCheck=!1,v=o.translatePoint,nt=o.tileTranslatePoint,i=n.isNullOrUndefined(i)?k.x-d.x:i,u=n.isNullOrUndefined(u)?k.y-d.y:u,p=e.type.indexOf("mouse")>-1||e.type.indexOf("key")>-1?e.layerX:e.touches[0].pageX,w=e.type.indexOf("mouse")>-1||e.type.indexOf("key")>-1?e.layerY:e.touches[0].pageY,this.maps.mergeCluster(),o.isTileMap)this.maps.tileZoomLevel>1&&(h=o.tileTranslatePoint.x-i,c=o.tileTranslatePoint.y-u,o.tileTranslatePoint.x=h,o.tileTranslatePoint.y=c,(o.tileTranslatePoint.y>-10&&u<0||o.tileTranslatePoint.y<-256*(Math.pow(2,this.maps.tileZoomLevel)-2)&&u>0)&&(o.tileTranslatePoint.x=h+i,o.tileTranslatePoint.y=c+u),o.translatePoint.x=o.tileTranslatePoint.x/o.scale,o.translatePoint.y=o.tileTranslatePoint.y/o.scale,b=this.maps.getTileGeoLocation(p,w),s=this.maps.getMinMaxLatitudeLongitude(),a={cancel:!1,name:oi,maps:o,tileTranslatePoint:{previous:nt,current:o.tileTranslatePoint},translatePoint:{previous:v,current:o.translatePoint},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:b.latitude,longitude:b.longitude,minLatitude:s.minLatitude,maxLatitude:s.maxLatitude,minLongitude:s.minLongitude,maxLongitude:s.maxLongitude},o.trigger(oi,a),o.mapLayerPanel.generateTiles(o.tileZoomLevel,o.tileTranslatePoint,"Pan"),this.applyTransform(o,!1,!1,!0),o.translatePoint.x=(o.tileTranslatePoint.x-i)/o.scale,o.translatePoint.y=(o.tileTranslatePoint.y-u)/o.scale);else{var et=ft(o.margin.top),tt=document.getElementById(o.element.id+"_Legend_Group"),ot=n.isNullOrUndefined(tt)?0:tt.getClientRects()[0].height;h=v.x-i/g;c=v.y-u/g;var l=r(o.element.id+"_Layer_Collections").getBoundingClientRect(),y=r(o.element.id+"_svg").getBoundingClientRect(),it=i<0?l.left<=y.left+o.mapAreaRect.x:l.left+l.width+o.mapAreaRect.x>=y.width,rt=u<0?l.top<=y.top+o.mapAreaRect.y:l.top+l.height+ot+et>=y.top+y.height,ut=this.maps.getGeoLocation(this.maps.layersCollection.length-1,p,w),s=this.maps.getMinMaxLatitudeLongitude();a={cancel:!1,name:oi,maps:o,tileTranslatePoint:{},translatePoint:{previous:v,current:new f(h,c)},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:ut.latitude,longitude:ut.longitude,minLatitude:s.minLatitude,maxLatitude:s.maxLatitude,minLongitude:s.minLongitude,maxLongitude:s.maxLongitude};o.trigger(oi,a);a.cancel||(it&&rt?(o.translatePoint=new f(h,c),this.applyTransform(o,!1,!1,!0)):it?(o.translatePoint=new f(h,o.translatePoint.y),this.applyTransform(o,!1,!1,!0)):rt&&(o.translatePoint=new f(o.translatePoint.x,c),this.applyTransform(o,!1,!1,!0)));this.maps.zoomNotApplied=!1}o.zoomTranslatePoint=o.translatePoint;this.mouseDownPoints=this.mouseMovePoints;this.isSingleClick=!1},t.prototype.toolBarZooming=function(t,i){var l=this,r=this.maps,o,p,w,s,nt,tt;r.initialCheck=r.isMarkerZoomCompleted=!1;r.defaultState="Reset"===i&&1===t&&!(r.zoomSettings.resetToInitial&&r.applyZoomReset)||"ZoomOut"===i&&1===t;o=r.tileZoomLevel;p=r.previousScale=r.scale;r.markerZoomedState=!1;r.zoomPersistence=r.enablePersistence;r.mapScaleValue=t;var b=r.zoomSettings.maxZoom,e=r.zoomSettings.minZoom,u=r.mapAreaRect,k=r.previousPoint=r.translatePoint,d=r.tileTranslatePoint;if(this.maps.mergeCluster(),r.previousProjection="Reset"===i?void 0:r.projectionType,t="ZoomOut"===i&&1===Math.round(t)?1:t,t=e>(t="Reset"===i?e:0===Math.round(t)?1:t)&&"ZoomIn"===i?e+1:t,!r.isTileMap&&("ZoomIn"===i?t>=e&&Math.round(t)<=b:t>=e||r.isReset)){var a=r.baseMapRectBounds.min,g=r.baseMapRectBounds.max,h=Math.abs(g.x-a.x),c=Math.abs(a.y-g.y),v=void 0,y=void 0;t<1.2&&"Eckert5"!==r.projectionType?(0!==c&&0!==h&&c!==h||(h=u.width/2,c=u.height),t=(t=parseFloat(Math.min(u.width/h,u.height/c).toFixed(2)))>1.05?1:t,r.translatePoint=this.calculateInitalZoomTranslatePoint(t,h,c,u,a,r)):(v=k.x-(u.width/p-u.width/t)/2,y=k.y-(u.height/p-u.height/t)/2,w=Math.abs(r.baseMapRectBounds.max.y-r.baseMapRectBounds.min.y)*t,v=w<r.mapAreaRect.height?u.x+(-a.x+(u.width/2-h/2)):v,y=w<r.mapAreaRect.height?u.y+(-a.y+(u.height/2-c/2)):y,r.translatePoint=new f(v,y));r.zoomTranslatePoint=r.translatePoint;r.scale=t;this.triggerZoomEvent(d,o,i)?(r.translatePoint=r.zoomTranslatePoint=r.previousPoint,r.scale=r.previousScale):this.applyTransform(r,!1,!0)}else r.isTileMap&&(t>=e&&t<=b||r.isReset)&&(s=o<e&&!r.isReset?e:t,(r.scale=Math.pow(2,s-1),r.tileZoomLevel=s,r.previousScale!==r.scale||r.isReset)&&(r.zoomSettings.zoomFactor=t,nt={x:r.availableSize.width/2,y:r.availableSize.height/2},(this.getTileTranslatePosition(o,s,nt,i),(r.zoomSettings.resetToInitial&&r.applyZoomReset&&"Reset"===i||"ZoomOut"===i&&r.zoomSettings.resetToInitial&&r.applyZoomReset&&s<=r.initialZoomLevel)&&(r.initialCheck=!0,r.zoomPersistence=!1,r.tileTranslatePoint.x=r.initialTileTranslate.x,r.tileTranslatePoint.y=r.initialTileTranslate.y,s=r.tileZoomLevel=r.mapScaleValue=r.initialZoomLevel),this.triggerZoomEvent(d,o,i))?(r.translatePoint=r.tileTranslatePoint=new f(0,0),r.scale=r.previousScale,r.tileZoomLevel=o,r.zoomSettings.zoomFactor=r.previousScale):(r.translatePoint.y=(r.tileTranslatePoint.y-.01*r.mapScaleValue)/r.scale,r.translatePoint.x=(r.tileTranslatePoint.x-.01*r.mapScaleValue)/r.scale,document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),this.markerLineAnimation(r),r.mapLayerPanel.generateTiles(s,r.tileTranslatePoint,i),tt=0===this.maps.layersCollection[0].animationDuration&&"Enable"===n.animationMode?1e3:this.maps.layersCollection[0].animationDuration,setTimeout(function(){l.applyTransform(l.maps,!1,!0);document.getElementById(l.maps.element.id+"_LayerIndex_1")&&(document.getElementById(l.maps.element.id+"_LayerIndex_1").style.display="block");l.maps.isAddLayer=!1},tt))),this.maps.zoomNotApplied=!1);this.triggerZoomComplete(r,o,i)},t.prototype.createZoomingToolbars=function(){var t=this.maps,st,e,g,r,c,v,p,tt,it,rt,w,ut,ft;this.toolBarGroup=t.renderer.createGroup({id:t.element.id+"_Zooming_KitCollection",opacity:"fluentdark"===t.theme.toLowerCase()?.6:.3});var b=15,k=15,u=t.zoomSettings.toolbarSettings,i=t.zoomSettings.toolbarSettings.buttonSettings;this.maps.toolbarProperties={toolBarOrientation:u.orientation,highlightColor:i.highlightColor,selectionColor:i.selectionColor,horizontalAlignment:u.horizontalAlignment,verticalAlignment:u.verticalAlignment,color:i.color,shapeOpacity:i.opacity,borderOpacity:i.borderOpacity};var f=i.radius||t.themeStyle.zoomButtonRadius,ht=f/4,ct=f/4,lt=f/2,o=i.padding,et=this.maps.toolbarProperties.toolBarOrientation,nt=t.zoomSettings.toolbarSettings.buttonSettings.toolbarItems.map(function(n){return n});b=f/4+i.borderWidth/2+o;k=f/4+i.borderWidth/2+o;var l=nt.length,at="Horizontal"===et?l*f+l*o+o+l*i.borderWidth:f+i.borderWidth+2*o,vt="Horizontal"===et?f+i.borderWidth+2*o:l*f+l*o+o+l*i.borderWidth,ot=t.renderer.createDefs();for(ot.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/><\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',this.toolBarGroup.appendChild(ot),st=t.renderer.drawRectangle(new d(t.element.id+"_Zooming_Rect",u.backgroundColor,{color:u.borderColor,width:u.borderWidth,opacity:u.borderOpacity},u.borderOpacity,new a(u.borderWidth/2,u.borderWidth/2,at-u.borderWidth,vt-u.borderWidth),0,0)),this.toolBarGroup.appendChild(st),e=(f-i.borderWidth/2)/30,g=0;g<nt.length;g++){0!==g&&(b="Horizontal"===t.toolbarProperties.toolBarOrientation?b+(f+o)+i.borderWidth:b,k="Horizontal"===t.toolbarProperties.toolBarOrientation?k:k+(f+o)+i.borderWidth);var s=nt[g],h=n.isNullOrUndefined(this.maps.toolbarProperties.color)?this.maps.themeStyle.zoomFillColor:this.maps.toolbarProperties.color,pt=i.borderColor||this.maps.themeStyle.zoomBorderColor||this.maps.themeStyle.zoomFillColor;this.currentToolbarEle=t.renderer.createGroup({id:t.element.id+"_Zooming_ToolBar_"+s+"_Group",transform:"translate( "+b+" "+k+" ) "});this.currentToolbarEle.setAttribute("class","e-maps-toolbar");this.currentToolbarEle.appendChild(t.renderer.drawCircle(new yt(t.element.id+"_Zooming_ToolBar_"+s+"_Rect",i.fill,{color:pt,width:i.borderWidth,opacity:i.borderOpacity},i.opacity,ht,ct,lt,"")));r="";c=i.fill;switch(this.selectionColor=this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor,s.toLowerCase()){case"zoom":v=void 0;p=void 0;r="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";r+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571";r+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,";this.currentToolbarEle.setAttribute("class",this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"");this.maps.zoomSettings.enablePanning&&!this.maps.zoomSettings.enableSelectionZooming||this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(v=c,p=h):this.maps.zoomSettings.enablePanning||this.maps.zoomSettings.enableSelectionZooming?!this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(v=this.maps.themeStyle.zoomFillColor,p=h):(v=this.selectionColor,p=this.selectionColor):(v=c,p=h);tt=t.renderer.drawPath(new y(t.element.id+"_Zooming_ToolBar_"+s,v,1,p,1,1,null,r+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z"));tt.setAttribute("transform","scale( "+e+","+e+" )");this.currentToolbarEle.appendChild(tt);this.zoomElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomin":r="M 8, 0 L 8, 16 M 0, 8 L 16, 8";it=t.renderer.drawPath(new y(t.element.id+"_Zooming_ToolBar_"+s+"_Path",c,3,h,1,1,null,r));it.setAttribute("transform","scale( "+e+","+e+" )");this.currentToolbarEle.appendChild(it);this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomout":r="M 0, 8 L 16, 8";rt=t.renderer.drawPath(new y(t.element.id+"_Zooming_ToolBar_"+s,c,3,h,1,1,null,r));rt.setAttribute("transform","scale( "+e+","+e+" )");this.currentToolbarEle.appendChild(rt);this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"pan":w=void 0;r="M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,";r+="11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z";this.currentToolbarEle.setAttribute("class",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"");this.maps.zoomSettings.enablePanning&&this.maps.zoomModule.isDragZoom?w=this.selectionColor||this.maps.themeStyle.zoomFillColor:this.maps.zoomSettings.enablePanning?w=c||this.maps.themeStyle.zoomFillColor:(w=this.selectionColor||this.maps.themeStyle.zoomFillColor,this.currentToolbarEle.setAttribute("class",""));ut=t.renderer.drawPath(new y(t.element.id+"_Zooming_ToolBar_"+s,w,1,h,1,1,null,r));ut.setAttribute("transform","scale( "+e+","+e+" )");this.currentToolbarEle.appendChild(ut);this.panColor=w;this.panElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"reset":r="M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,";r+="1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,";r+="13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,";ft=t.renderer.drawPath(new y(t.element.id+"_Zooming_ToolBar_"+s,c,null,h,1,1,null,r+"3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z"));ft.setAttribute("transform","scale( "+e+","+e+" )");this.currentToolbarEle.appendChild(ft);this.wireEvents(this.currentToolbarEle,this.performToolBarAction)}this.toolBarGroup.appendChild(this.currentToolbarEle)}},t.prototype.performToolBarAction=function(n){var u=n.target,r;n.stopImmediatePropagation();var f="touch"===n.pointerType||"2"===n.pointerType||n.type.indexOf("touch")>-1,i=u.id.split("_Zooming_ToolBar_")[1].split("_")[0],t=!0;switch(i.toLowerCase()){case"zoomin":t=(this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale)+1<=this.maps.zoomSettings.maxZoom;break;case"zoomout":r=this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale;t="Miller"===this.maps.projectionType||"Winkel3"===this.maps.projectionType||"AitOff"===this.maps.projectionType?Math.round(r)-1>=this.maps.zoomSettings.minZoom:r-1>=this.maps.zoomSettings.minZoom;break;case"reset":t=Math.round(this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale)!==this.maps.zoomSettings.minZoom}f&&t?(this.handled=!0,this.performZoomingByToolBar(i)):"mousedown"!==n.type&&"pointerdown"!==n.type||this.handled||!t?this.handled=!1:(this.handled=!1,this.performZoomingByToolBar(i))},t.prototype.performZoomingByToolBar=function(n){var t=this.maps,r,i;t.isReset=!1;r=0;i=this.fillColor||this.maps.themeStyle.zoomFillColor;switch(n.toLowerCase()){case"zoom":this.panColor=i;this.zoomColor=this.maps.zoomSettings.enableSelectionZooming?this.selectionColor:i;this.applySelection(this.zoomElements,this.zoomColor);this.applySelection(this.panElements,this.panColor);this.isPan=!1;this.isZoomSelection=this.maps.zoomSettings.enableSelectionZooming;break;case"pan":this.panColor=this.maps.zoomSettings.enablePanning?this.selectionColor:i;this.zoomColor=i;this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor||i),this.applySelection(this.panElements,this.panColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor));this.isPan=this.maps.zoomSettings.enablePanning;this.isZoomSelection=!1;break;case"zoomin":t.staticMapZoom=t.tileZoomLevel;t.staticMapZoom>0&&t.staticMapZoom<t.zoomSettings.maxZoom&&(t.staticMapZoom+=1);t.isTileMap&&t.tileZoomLevel>=t.zoomSettings.minZoom&&t.tileZoomLevel<t.zoomSettings.maxZoom?this.toolBarZooming(t.tileZoomLevel+1,"ZoomIn"):t.isTileMap||this.toolBarZooming(t.scale+1,"ZoomIn");r=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);this.isZoomSelection||(r===t.zoomSettings.maxZoom||r>1||1===r&&this.maps.isTileMap?(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,t.zoomSettings.enablePanning?this.selectionColor:i)):1!==r||this.maps.isTileMap||(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,i)));break;case"zoomout":t.staticMapZoom=t.tileZoomLevel;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)-1,"ZoomOut");r=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);!this.isPan&&this.isZoomSelection?(this.panColor=i,this.zoomColor=this.selectionColor,this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor)):r<=1&&!t.isTileMap?this.applySelection(this.panElements,i):this.applySelection(this.panElements,t.zoomSettings.enablePanning?this.selectionColor:i);break;case"reset":t.staticMapZoom=t.zoomSettings.enable?t.zoomSettings.zoomFactor:0;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.isZoomSelection=!1;this.isPan=t.zoomSettings.enablePanning;this.toolBarZooming(t.zoomSettings.minZoom,"Reset");this.isPan&&!this.isZoomSelection||!this.isPan&&this.isZoomSelection?this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,this.selectionColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,i)):this.isPan||this.isZoomSelection||(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,i))}this.panningStyle(n.toLowerCase())},t.prototype.panningStyle=function(n){var t=r(this.maps.element.id+"_svg");"pan"===n||this.isPanModeEnabled&&"reset"!==n?t.setAttribute("class","e-maps-panning"):t.setAttribute("class","")},t.prototype.applySelection=function(n,t){if(n)for(var i,r=0;r<n.childElementCount;r++)"circle"!==(i=n.childNodes[r]).tagName&&(i.setAttribute("fill",n.id.indexOf("Pan")>-1?t:"transparent"),i.setAttribute("stroke",t))},t.prototype.showTooltip=function(t){var u=t.target.id.split("_Zooming_ToolBar_")[1].split("_")[0],i=this.maps.zoomSettings.toolbarSettings.tooltipSettings,r={visible:i.visible,fill:i.fill,borderOpacity:i.borderOpacity,borderWidth:i.borderWidth,borderColor:i.borderColor,fontColor:i.fontColor,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontSize:i.fontSize||"10px",fontOpacity:i.fontOpacity};r.fontFamily=this.maps.themeStyle.fontFamily;this.isTouch||(function(t,i,r,u,f){var e=o(t),s=uu(f.borderColor),h=uu(f.fontColor),c="top:"+r.toString()+"px;left:"+u.toString()+"px;color:"+(h?"rgba("+h.r+","+h.g+","+h.b+","+f.fontOpacity+")":f.fontColor)+";background:"+f.fill+";z-index: 2;position:absolute;border:"+f.borderWidth+"px solid "+(s?"rgba("+s.r+","+s.g+","+s.b+","+f.borderOpacity+")":f.borderColor)+";font-family:"+f.fontFamily+";font-style:"+f.fontStyle+";font-weight:"+f.fontWeight+";font-size:"+f.fontSize+";border-radius:"+f.borderWidth+"px;";!e&&f.visible?((e=n.createElement("div",{id:t})).innerHTML=n.SanitizeHtmlHelper.sanitize("&nbsp;"+i+"&nbsp;"),e.style.cssText=c,document.body.appendChild(e)):f.visible&&(e.innerHTML=n.SanitizeHtmlHelper.sanitize("&nbsp;"+i+"&nbsp;"),e.style.cssText=c)}("EJ2_Map_Toolbar_Tip",this.maps.getLocalizedLabel(u),t.pageY+10,t.pageX+10,r),this.maps.isDevice&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3)))},t.prototype.removeTooltip=function(){r("EJ2_Map_Toolbar_Tip")&&n.remove(r("EJ2_Map_Toolbar_Tip"))},t.prototype.alignToolBar=function(){var t=this.maps,f=n.createElement("div",{id:t.element.id+"_ToolBar"}),e,i;f.style.cssText="position:absolute;z-index:2";e=t.renderer.createSvg({id:t.element.id+"_Zooming_ToolBar",width:10,height:10});e.appendChild(this.toolBarGroup);f.appendChild(e);r(t.element.id+"_Secondary_Element")&&r(t.element.id+"_Secondary_Element").appendChild(f);i=this.toolBarGroup.getBoundingClientRect();e.setAttribute("height",(i.height+t.zoomSettings.toolbarSettings.borderWidth).toString());e.setAttribute("width",(i.width+t.zoomSettings.toolbarSettings.borderWidth).toString());var u=n.isNullOrUndefined(t.totalRect)?t.mapAreaRect:t.totalRect,o=0,s=0;switch(t.toolbarProperties.verticalAlignment){case"Near":s=u.y;break;case"Center":s=u.height/2-i.height/2;break;case"Far":s=u.height-i.height-10}switch(t.toolbarProperties.horizontalAlignment){case"Near":o=u.x;break;case"Center":o=u.width/2-i.width/2;break;case"Far":o=n.isNullOrUndefined(t.legendModule)||"Left"!==t.legendSettings.position?u.width-i.width-10:u.width+u.x-i.width-10}f.style.left=o+"px";f.style.top=s+"px";var h=this.maps.toolbarProperties.highlightColor||this.maps.themeStyle.zoomSelectionColor,l=" .e-maps-toolbar:hover > circle { stroke:"+h+"; } .e-maps-toolbar:hover > path { fill: "+h+" ;  stroke: "+h+"; }.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } .e-maps-popup-close { display: block; opacity: 0; }",c=document.createElement("style");c.appendChild(document.createTextNode(l));f.appendChild(c)},t.prototype.removeToolbarOpacity=function(t,i){if(!n.isNullOrUndefined(this.maps)&&this.maps.zoomModule&&this.maps.zoomSettings.enable)if(r(this.maps.element.id+"_Zooming_KitCollection")&&i.indexOf(this.maps.element.id+"_Zooming_")>-1){this.maps.isDevice?(r(this.maps.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"),this.removeToolbarClass("","","","","")):this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar");var u=this.maps.toolbarProperties.shapeOpacity,f=this.maps.toolbarProperties.borderOpacity;this.maps.isTileMap&&(t<=1.1||this.maps.zoomSettings.minZoom===t)?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"",""),this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming&&!this.maps.isReset&&(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)),this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?u:.3,this.maps.zoomSettings.enableSelectionZooming?f:.3,u,f,.3,.3,this.maps.zoomSettings.enablePanning?u:.3,this.maps.zoomSettings.enablePanning?f:.3,.3,.3)):t<=1.1||this.maps.zoomSettings.minZoom===t?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","","",""),!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming&&!this.maps.isReset&&(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)),this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?u:.3,this.maps.zoomSettings.enableSelectionZooming?f:.3,u,f,.3,.3,.3,.3,.3,.3)):t<this.maps.zoomSettings.maxZoom?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar"),this.maps.zoomModule.isZoomFinal?this.maps.zoomModule.isZoomFinal=!1:this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?u:.3,this.maps.zoomSettings.enableSelectionZooming?f:.3,u,f,u,f,this.maps.zoomSettings.enablePanning?u:.3,this.maps.zoomSettings.enablePanning?f:.3,u,f),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming?(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.maps.zoomModule.isPan&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)):!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&(this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.maps.zoomSettings.enableSelectionZooming&&this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor))):(this.maps.isDevice||this.removeToolbarClass("","","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar"),this.removeZoomOpacity(.3,.3,.3,.3,u,f,this.maps.zoomSettings.enablePanning?u:.3,this.maps.zoomSettings.enablePanning?f:.3,u,f),this.maps.zoomSettings.enableSelectionZooming&&this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor))}else this.maps.isDevice||(this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.removeZoomOpacity(1,1,1,1,1,1,1,1,1,1))},t.prototype.setOpacity=function(n,t,i,u){r(this.maps.element.id+n)&&(r(this.maps.element.id+n).setAttribute("stroke-opacity",i.toString()),r(this.maps.element.id+n).setAttribute("fill-opacity",i.toString()),r(this.maps.element.id+t).setAttribute("stroke-opacity",u.toString()),r(this.maps.element.id+t).setAttribute("fill-opacity",u.toString()))},t.prototype.removeZoomOpacity=function(n,t,i,r,u,f,e,o,s,h){this.setOpacity("_Zooming_ToolBar_Zoom_Rect","_Zooming_ToolBar_Zoom",t,n);this.setOpacity("_Zooming_ToolBar_ZoomIn_Rect","_Zooming_ToolBar_ZoomIn_Path",r,i);this.setOpacity("_Zooming_ToolBar_ZoomOut_Rect","_Zooming_ToolBar_ZoomOut",f,u);this.setOpacity("_Zooming_ToolBar_Pan_Rect","_Zooming_ToolBar_Pan",o,e);this.setOpacity("_Zooming_ToolBar_Reset_Rect","_Zooming_ToolBar_Reset",h,s)},t.prototype.removeToolbarClass=function(n,t,i,u,f){r(this.maps.element.id+"_Zooming_KitCollection")&&(document.getElementById(this.maps.element.id+"_Zooming_ToolBar_ZoomIn_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_ZoomIn_Group").setAttribute("class",t),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_ZoomOut_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_ZoomOut_Group").setAttribute("class",i),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Reset_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_Reset_Group").setAttribute("class",f),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Zoom_Group")&&this.maps.zoomSettings.enableSelectionZooming&&r(this.maps.element.id+"_Zooming_ToolBar_Zoom_Group").setAttribute("class",n),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Pan_Group")&&this.maps.zoomSettings.enablePanning&&r(this.maps.element.id+"_Zooming_ToolBar_Pan_Group").setAttribute("class",u))},t.prototype.removePanColor=function(n){r(this.maps.element.id+"_Zooming_ToolBar_Pan_Rect")&&this.maps.zoomSettings.enablePanning&&(r(this.maps.element.id+"_Zooming_ToolBar_Pan").setAttribute("fill",n),r(this.maps.element.id+"_Zooming_ToolBar_Pan").setAttribute("stroke",n))},t.prototype.removeZoomColor=function(n){r(this.maps.element.id+"_Zooming_ToolBar_Zoom_Rect")&&this.maps.zoomSettings.enableSelectionZooming&&(r(this.maps.element.id+"_Zooming_ToolBar_Zoom").setAttribute("fill","transparent"),r(this.maps.element.id+"_Zooming_ToolBar_Zoom").setAttribute("stroke",n))},t.prototype.wireEvents=function(t,i){n.EventHandler.add(t,n.Browser.touchStartEvent,i,this);n.EventHandler.add(t,"mouseover",this.showTooltip,this);n.EventHandler.add(t,"mouseout",this.removeTooltip,this)},t.prototype.mapMouseWheel=function(t){var i,f;if(this.maps.zoomSettings.enable&&this.maps.zoomSettings.mouseWheelZoom){i=this.maps;i.markerZoomedState=!1;i.zoomPersistence=i.enablePersistence;var r=this.getMousePosition(t.pageX,t.pageY),o=i.tileZoomLevel,s=i.scale,e=i.zoomSettings.maxZoom,u=i.isTileMap?o:s;(this.maps.mergeCluster(),r.x>i.mapAreaRect.x&&r.x<i.mapAreaRect.x+i.mapAreaRect.width&&r.y>i.mapAreaRect.y&&r.y<i.mapAreaRect.y+i.mapAreaRect.height)&&(t.preventDefault(),f="mozilla"!==this.browserName||this.isPointer?t.wheelDelta/120>0?"ZoomIn":"ZoomOut":-t.detail/3>0?"ZoomIn":"ZoomOut","ZoomIn"===f?(i.mapScaleValue=u+1,i.isTileMap?(i.staticMapZoom=i.tileZoomLevel,i.staticMapZoom>0&&i.staticMapZoom<e&&(i.staticMapZoom+=1,this.performZooming(r,u+1,f,!0))):this.performZooming(r,u+1,f,!0)):(i.mapScaleValue=u-1,i.isReset=i.mapScaleValue<1,i.staticMapZoom=i.tileZoomLevel,1===i.mapScaleValue&&(i.markerCenterLatitude=null,i.markerCenterLongitude=null),i.staticMapZoom>1&&i.staticMapZoom<e&&(i.staticMapZoom-=1),this.performZooming(r,u-1,f,!0)));this.removeToolbarOpacity(i.mapScaleValue,this.maps.isDevice?this.maps.element.id+"_Zooming_":n.isNullOrUndefined(t.target)?this.maps.element.id:t.target.id)}},t.prototype.doubleClick=function(t){var f=t.pageX,e=t.pageY,o=t.target.closest("#"+this.maps.element.id+"_mapsTooltipparent_template"),u;if(this.maps.zoomSettings.enable&&this.maps.zoomSettings.doubleClickZoom&&!(t.target.id.indexOf("_Zooming_")>-1)&&n.isNullOrUndefined(o)){var r=this.getMousePosition(f,e),i=this.maps,s=i.tileZoomLevel,h=i.scale;i.mapScaleValue=i.mapScaleValue+1;u=i.isTileMap?s:h;r.x>i.mapAreaRect.x&&r.x<i.mapAreaRect.x+i.mapAreaRect.width&&r.y>i.mapAreaRect.y&&r.y<i.mapAreaRect.y+i.mapAreaRect.height&&this.performZooming(r,u+1,"ZoomIn")}},t.prototype.mouseDownHandler=function(n){var i,r,t=null,u;n.target;"touchstart"===n.type?(this.isTouch=!0,t=n.touches,n.target,i=t[0].pageX,r=t[0].pageY):(i=n.pageX,r=n.pageY,n.target);this.isTouch||n.preventDefault();this.isPan=this.maps.zoomSettings.enablePanning?this.isPanModeEnabled=!this.isZoomSelection:this.isPanModeEnabled=this.panColor!==this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor===this.selectionColor;this.mouseDownLatLong={x:i,y:r};u=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);this.rectZoomingStart=this.isZoomSelection&&u<this.maps.zoomSettings.maxZoom&&this.maps.zoomSettings.enable;this.mouseDownPoints=this.getMousePosition(i,r);this.isTouch&&null!==t&&(this.firstMove=!0,this.pinchFactor=this.maps.scale,this.fingers=t.length);this.isSingleClick=!0},t.prototype.mouseMoveHandler=function(t){var u,f,o,e=this.maps,i=null,h=this.maps.zoomSettings,s;("touchmove"===t.type?(this.isTouch=!0,o=t.target,u=(i=t.touches)[0].pageX,f=i[0].pageY):(u=t.pageX,f=t.pageY,o=t.target),r(e.element.id+"_Zooming_KitCollection")&&(o.id.indexOf("_Zooming_")>-1?r(e.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"):e.isDevice||r(e.element.id+"_Zooming_KitCollection").setAttribute("opacity","fluentdark"===e.theme.toLowerCase()?"0.6":"0.3")),this.isTouch&&this.maps.zoomSettings.pinchZooming&&null!==i&&(this.firstMove&&2===i.length?(this.rectZoomingStart=!1,this.updateInteraction(),this.touchStartList=eu(t)):2===i.length&&2===this.touchStartList.length&&(this.touchMoveList=eu(t),t.preventDefault(),this.rectZoomingStart=!1,this.performPinchZooming(t)),this.firstMove=!1),this.mouseMovePoints=this.getMousePosition(u,f),h.enable&&this.isPanModeEnabled&&-1===this.maps.markerDragId.indexOf("_MarkerIndex_")&&(n.Browser.isDevice&&i.length>=1||!n.Browser.isDevice)&&(t.preventDefault(),this.maps.element.style.cursor="pointer",this.mouseMoveLatLong={x:u,y:f},this.mouseDownLatLong.x!==this.mouseMoveLatLong.x&&this.mouseDownLatLong.y!==this.mouseMoveLatLong.y&&(this.maps.zoomSettings.enablePanning&&this.panning("None",null,null,t),this.mouseDownLatLong.x=u,this.mouseDownLatLong.y=f)),this.isTouch?null!==i&&1===i.length&&this.rectZoomingStart:this.rectZoomingStart)&&(t.preventDefault(),s=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue),this.maps.zoomSettings.enableSelectionZooming&&s<this.maps.zoomSettings.maxZoom?this.drawZoomRectangle():(this.rectZoomingStart=!1,this.isPan=!0))},t.prototype.mouseUpHandler=function(t){var o,s,i,l,e,a;if(this.rectZoomingStart=!1,this.isSingleClick=!!this.isSingleClick,this.isTouch=!1,this.touchStartList=[],this.touchMoveList=[],this.lastScale=1,this.maps.element.style.cursor="auto",this.isPanModeEnabled&&this.maps.zoomSettings.enablePanning&&!n.isNullOrUndefined(this.maps.previousPoint)&&(this.maps.isTileMap?this.isPanningInProgress:this.maps.translatePoint.x!==this.maps.previousPoint.x&&this.maps.translatePoint.y!==this.maps.previousPoint.y)){var u=void 0,f=void 0,h=0,c=0,v=t.target;-1!==t.type.indexOf("touch")?(o=t,h=u=o.changedTouches[0].pageX,c=(f=o.changedTouches[0].pageY)-(this.maps.isTileMap?10:0),o.target,this.maps.mouseClickEvent={x:u,y:f}):(u=t.pageX,f=t.pageY,h=t.layerX,c=t.layerY-(this.maps.isTileMap?10:0),t.target);s=void 0;i=this.maps.getMinMaxLatitudeLongitude();this.maps.isTileMap?(l=this.maps.getTileGeoLocation(h,c),s={cancel:!1,name:"panComplete",maps:this.maps,tileTranslatePoint:{previous:this.maps.tileTranslatePoint,current:this.maps.tileTranslatePoint},translatePoint:{previous:this.maps.previousPoint,current:this.maps.translatePoint},scale:this.maps.scale,tileZoomLevel:this.maps.tileZoomLevel,latitude:l.latitude,longitude:l.longitude,minLatitude:i.minLatitude,maxLatitude:i.maxLatitude,minLongitude:i.minLongitude,maxLongitude:i.maxLongitude}):(this.maps.mouseClickEvent.x=this.maps.mouseDownEvent.x,this.maps.mouseClickEvent.y=this.maps.mouseDownEvent.y,e=this.maps.getClickLocation(v.id,u,f,v,u,f),s={cancel:!1,name:"panComplete",maps:this.maps,tileTranslatePoint:{},translatePoint:{previous:this.maps.previousPoint,current:this.maps.translatePoint},scale:this.maps.scale,tileZoomLevel:this.maps.tileZoomLevel,latitude:n.isNullOrUndefined(e)?0:e.latitude,longitude:n.isNullOrUndefined(e)?0:e.longitude,minLatitude:i.minLatitude,maxLatitude:i.maxLatitude,minLongitude:i.minLongitude,maxLongitude:i.maxLongitude});this.maps.trigger("panComplete",s)}this.isPanModeEnabled=!1;this.isPanningInProgress=!1;a=r(this.maps.element.id+"_Selection_Rect_Zooming");a&&this.maps.zoomSettings.enable&&this.maps.zoomSettings.enableSelectionZooming&&(n.remove(a),this.performRectZooming());this.mouseMoveLatLong={x:0,y:0};this.mouseDownLatLong={x:0,y:0};this.pinchDistance=null},t.prototype.mouseCancelHandler=function(){this.isPanModeEnabled=!1;this.isTouch=!1;this.rectZoomingStart=!1;var t=r(this.maps.element.id+"_Selection_Rect_Zooming");t&&this.maps.zoomSettings.enable&&(n.remove(t),this.performRectZooming())},t.prototype.click=function(t){var i=this.maps,f=t.target.closest("#"+this.maps.element.id+"_mapsTooltipparent_template"),u;if(i.markerModule&&i.markerModule.sameMarkerData.length>0||t.target.id.indexOf("MarkerIndex")>-1&&-1===t.target.id.indexOf("cluster")||!n.isNullOrUndefined(f))return null;if(this.isSingleClick&&i.zoomSettings.zoomOnClick&&!(t.target.id.indexOf("_Zooming_")>-1)&&!i.zoomSettings.doubleClickZoom&&this.zoomColor!==this.selectionColor){var e=t.pageX,o=t.pageY,r=this.getMousePosition(e,o),s=i.tileZoomLevel,h=i.scale;i.mapScaleValue=i.mapScaleValue+1;u=i.isTileMap?s:h;r.x>i.mapAreaRect.x&&r.x<i.mapAreaRect.x+i.mapAreaRect.width&&r.y>i.mapAreaRect.y&&r.y<i.mapAreaRect.y+i.mapAreaRect.height&&this.performZooming(r,u+1,"ZoomIn")}},t.prototype.getMousePosition=function(n,t){var i=this.maps,r=i.element.getBoundingClientRect(),u=i.element.ownerDocument.defaultView.pageXOffset,e=i.element.ownerDocument.defaultView.pageYOffset,o=i.element.ownerDocument.documentElement.clientTop,s=i.element.ownerDocument.documentElement.clientLeft,h=r.left+u-s,c=r.top+e-o;return new f(Math.abs(n-h),Math.abs(t-c))},t.prototype.addEventListener=function(){this.maps.isDestroyed||(n.EventHandler.add(this.maps.element,this.wheelEvent,this.mapMouseWheel,this),n.EventHandler.add(this.maps.element,"click",this.click,this),n.EventHandler.add(this.maps.element,"dblclick",this.doubleClick,this),this.maps.on(n.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.maps.on(n.Browser.touchStartEvent,this.mouseDownHandler,this),this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this),n.EventHandler.add(this.maps.element,this.cancelEvent,this.mouseCancelHandler,this))},t.prototype.removeEventListener=function(){var t,i;if(!this.maps.isDestroyed&&(n.EventHandler.remove(this.maps.element,this.wheelEvent,this.mapMouseWheel),n.EventHandler.remove(this.maps.element,"click",this.click),n.EventHandler.remove(this.maps.element,"dblclick",this.doubleClick),this.maps.off(n.Browser.touchMoveEvent,this.mouseMoveHandler),this.maps.off(n.Browser.touchStartEvent,this.mouseDownHandler),this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler),n.EventHandler.remove(this.maps.element,this.cancelEvent,this.mouseCancelHandler),t=document.getElementById(this.maps.element.id+"_Zooming_KitCollection"),t))for(i=0;i<t.childNodes.length;i++)"g"===t.childNodes[i].tagName&&(n.EventHandler.add(t.childNodes[i],n.Browser.touchStartEvent,this.performToolBarAction),n.EventHandler.add(t.childNodes[i],"mouseover",this.showTooltip),n.EventHandler.add(t.childNodes[i],"mouseout",this.removeTooltip))},t.prototype.getModuleName=function(){return"Zoom"},t.prototype.destroy=function(){this.toolBarGroup=null;this.currentToolbarEle=null;this.zoomingRect=null;this.zoomElements=null;this.panElements=null;this.baseTranslatePoint=null;this.touchStartList=null;this.touchMoveList=null;this.previousTouchMoveList=null;this.mouseDownPoints=null;this.mouseMovePoints=null;this.startTouches=[];this.mouseDownLatLong=null;this.mouseMoveLatLong=null;this.removeEventListener();this.layerCollectionEle=null;this.currentLayer=null;this.pinchDistance=null},t}();ejdashboard.pdfexport;df.Inject(lo,po,ao,wo,bo,ko,go,vo,yo,kf);si={};si.Maps=df;gf={maps:si=hi.C(window.ejdashboard?window.ejdashboard.maps:{},si)};window.ejdashboard=hi.C(window.ejdashboard||{},gf)})()})();
