/*!
*  filename: ej2.map.all.min.js
*  version : 11.2.7.7
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function t(r){var f=n[r],u;return void 0!==f?f.exports:(u=n[r]={exports:{}},i[r](u,u.exports,t),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},n={};(()=>{function kt(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function nr(t){t.element.style.height=n.isNullOrUndefined(t.height)?"auto":t.height;t.element.style.width=n.isNullOrUndefined(t.width)?"auto":t.width;t.element.style.setProperty("display","block");var i=t.element.clientWidth,r=t.element.clientHeight,u=kt(t.element.style.width,i),f=kt(t.element.style.height,r);return new w(0,0),"0px"===t.width||"0%"===t.width||"0%"===t.height||"0px"===t.height?new w(0,0):new w(kt(t.width,i)||i||u||600,kt(t.height,r)||r||f||(t.isDevice?Math.min(window.innerWidth,window.innerHeight):450))}function hi(n,t,i){var r=i.getBoundingClientRect(),u=i.ownerDocument.defaultView.pageXOffset,f=i.ownerDocument.defaultView.pageYOffset,e=i.ownerDocument.documentElement.clientTop,o=i.ownerDocument.documentElement.clientLeft,s=r.left+u-o,h=r.top+f-e;return new k(n-s,t-h)}function ci(n){return n*(Math.PI/180)}function tr(n){return n*(180/Math.PI)}function p(t,i,r,u,e){var a,v,y,s,h,l,p=new w(e.mapAreaRect.width,e.mapAreaRect.height),it=e.baseMapBounds.longitude,rt=e.baseMapBounds.latitude,o=ci(t),c=ci(i),k=e.projectionType,b=e.isTileMap?256*Math.pow(2,1):n.isNullOrUndefined(r)?Math.min(p.width,p.height):Math.min(p.width,p.height)*r,d,g,nt,tt;if("Normal"===u.geometryType)a=n.isNullOrUndefined(r)?i:Math.abs((i-it.min)*r),v=n.isNullOrUndefined(r)?t:Math.abs((rt.max-t)*r);else if("Geographic"===u.geometryType){switch(k){case"Mercator":d=new f(b/2,b/2);a=d.x+i*(b/360);g=function(t,i,r){return n.isNullOrUndefined(i)||(t=Math.max(t,i)),n.isNullOrUndefined(r)||(t=Math.min(t,r)),t}(Math.sin(ci(t)),-.9999,.9999);v=d.y+.5*Math.log((1+g)/(1-g))*(-b/(2*Math.PI));break;case"Winkel3":h=((y=ir(c,o)).x+c/(Math.PI/2))/2;s=(y.y+o)/2;break;case"Miller":h=c;s=1.25*Math.log(Math.tan(Math.PI/4+.4*o));break;case"Eckert3":h=2/(l=Math.sqrt(Math.PI*(4+Math.PI)))*c*(1+Math.sqrt(1-4*o*o/(Math.PI*Math.PI)));s=4/l*o;break;case"AitOff":h=(y=ir(c,o)).x;s=y.y;break;case"Eckert5":h=c*(1+Math.cos(o))/Math.sqrt(2+Math.PI);s=2*o/Math.sqrt(2+Math.PI);break;case"Equirectangular":h=c;s=o;break;case"Eckert6":for(l=(1+Math.PI/2)*Math.sin(o),nt=1/0,tt=0;tt<10&&Math.abs(nt)>1e-6;tt++)o-=nt=(o+Math.sin(o)-l)/(1+Math.cos(o));l=Math.sqrt(2+Math.PI);h=c*(1+Math.cos(o))/l;s=2*o/l}a="Mercator"===k?a:rr(function(t,i){var r=t.baseMapBounds.longitude,u=n.isNullOrUndefined(t.baseSize)?t.mapAreaRect.width:t.mapAreaRect.width+Math.abs(t.baseSize.width-t.mapAreaRect.width)/2;return Math.round(u*(i-r.min)/(r.max-r.min)*100)/100}(e,tr(h)),3);v="Mercator"===k?v:-rr(function(n,t){var i=n.baseMapBounds.latitude;return Math.round(n.mapAreaRect.height*(t-i.min)/(i.max-i.min)*100)/100}(e,tr(s)),3)}return new f(a,v)}function it(n,t,i,r){var u=256*Math.pow(2,t),s=(n.x+180)/360,f=Math.sin(n.y*Math.PI/180),h=.5-Math.log((1+f)/(1-f))/(4*Math.PI),e=n.x,o=n.y;return r&&(e=s*u+.5+i.x,o=h*u+.5+i.y),{x:e,y:o}}function ir(n,t){var i,r=Math.cos(t),u=function(n){return n/Math.sin(n)}((i=r*Math.cos(n/=2),Math.acos(i)));return new f(2*r*Math.sin(n)*u,Math.sin(t)*u)}function rr(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function l(t,i){var r=document.getElementById("mapsmeasuretext");return null===r&&(r=n.createElement("text",{id:"mapsmeasuretext"}),document.body.appendChild(r)),r.innerText=t,r.style.position="absolute",r.style.fontSize="number"==typeof i.size?i.size+"px":i.size,r.style.fontWeight=i.fontWeight,r.style.fontStyle=i.fontStyle,r.style.fontFamily=i.fontFamily,r.style.visibility="hidden",r.style.top="-100",r.style.left="0",r.style.whiteSpace="nowrap",r.style.lineHeight="normal",new w(r.clientWidth,r.clientHeight)}function st(n,t,i,r,u){var e,c;void 0===u&&(u=!1);var s,o,a={id:n.id,x:n.x,y:n.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":n.anchor,transform:n.transform,opacity:t.opacity,"dominant-baseline":n.baseLine},v="string"==typeof n.text||"number"==typeof n.text?n.text:u?n.text[n.text.length-1]:n.text[0],h=new ot.SvgRenderer(""),f=h.createText(a,v);if(f.style["user-select"]="none",f.style["font-family"]=t.fontFamily,f.style["font-size"]=t.size,f.style["font-weight"]=t.fontWeight,f.style["font-color"]=t.color,f.style["-moz-user-select"]="none",f.style["-webkit-touch-callout"]="none",f.style["-webkit-user-select"]="none",f.style["-khtml-user-select"]="none",f.style["-ms-user-select"]="none",f.style["-o-user-select"]="none","string"!=typeof n.text&&n.text.length>1)for(e=1,c=n.text.length;e<c;e++)o=l(n.text[e],t).height,s=h.createTSpan({x:n.x,id:n.id,y:n.y+(u?-e*o:e*o)},u?n.text[n.text.length-(e+1)]:n.text[e]),f.appendChild(s);return r.appendChild(f),f}function vt(n,t){return t.format&&!isNaN(Number(n))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(n)):n}function fr(n,t,i,r){for(var h,e,c,s=""===n?t:n,f=""===n?s.split("${"):s.split("{{:"),l=RegExp,u=0;u<f.length;u++)if(f[u].indexOf("}}")>-1&&f[u].indexOf(".")>-1||f[u].indexOf("}")>-1&&f[u].search(".")>-1)for(h=""===n?f[u].split("}"):f[u].split("}}"),e=0;e<h.length;e++)h[e].indexOf(".")>-1&&(c=o(i,h[e]).toString(),s=""===n?s.split("${"+h[e]+"}").join(vt(c,r)):s.replace(new l("{{:"+h[e]+"}}","g"),c));return s}function er(t,i,r,u,f,e,o){var h,c,l,d,s=f.size,g=f.borderColor,nt=parseFloat(f.borderWidth),tt=parseFloat(f.borderOpacity),a=f.fill,p=f.dashArray,it={color:g,width:nt,opacity:tt},w=f.opacity,k=new y(u,a,nt,g,w,tt,p,""),rt,ut;return(s.width="string"==typeof s.width?parseInt(s.width,10):s.width,s.height="string"==typeof s.height?parseInt(s.height,10):s.height,"Circle"===t)?(rt=(s.width+s.height)/4,ut=new at(u,a,it,w,r.x,r.y,rt,p),h=o.renderer.drawCircle(ut)):"Rectangle"===t?(c=r.x-s.width/2,l=r.y-s.height/2,d=new b(u,a,it,w,new v(c,l,s.width,s.height),null,null,"",p),h=o.renderer.drawRectangle(d)):"Image"===t?(c=r.x-s.width/2,l=r.y-(u.indexOf("cluster")>-1?s.height/2:s.height),n.merge(k,{href:i,height:s.height,width:s.width,x:c,y:l}),h=o.renderer.drawImage(k)):h=function(n,t,i,r,u,f){var o;switch(t){case"Balloon":o=lr(n,i,r,u,"Marker",f);break;case"Cross":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"Diamond":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+u.y+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+u.y+" Z";break;case"Star":i.d="M "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x-r.width/3)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" Z";break;case"Triangle":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/2)+" Z";break;case"HorizontalLine":i.d=" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"VerticalLine":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2);break;case"InvertedTriangle":i.d="M "+(u.x-r.width/2)+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" Z";break;case"Pentagon":for(var s=void 0,h=void 0,e=0;e<5;e++)s=r.width/2*Math.cos(Math.PI/180*72*e),h=r.height/2*Math.sin(Math.PI/180*72*e),i.d+=(0===e?"M ":"L ")+(u.x+s)+" "+(u.y+h);i.d+=" Z"}return"Cross"!==t&&"HorizontalLine"!==t&&"VerticalLine"!==t||(i.stroke="transparent"===i.stroke?i.fill:i.stroke),"Balloon"===t?o:n.renderer.drawPath(i)}(o,t,k,s,r,e),h}function o(t,i){var r,u;if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(i))if(r=i.replace(/\[/g,".").replace(/\]/g,"").split("."),1===r.length)t=t[r[0]];else for(u=0;u<r.length&&!n.isNullOrUndefined(t);u++)t=t[r[u]];return t}function ai(t,i){var r=n.isNullOrUndefined(t.colorValuePath)?i[t.colorValuePath]:t.colorValuePath.indexOf(".")>-1?o(i,t.colorValuePath).toString():i[t.colorValuePath];return t.fill=n.isNullOrUndefined(t.colorValuePath)||n.isNullOrUndefined(r)?t.fill:t.colorValuePath.indexOf(".")>-1?o(i,t.colorValuePath).toString():i[t.colorValuePath],t}function vi(t,i){var r,f,u;return n.isNullOrUndefined(t.shapeValuePath)||n.isNullOrUndefined(i[t.shapeValuePath])?(r=n.isNullOrUndefined(t.shapeValuePath)?t.shape:t.shapeValuePath.indexOf(".")>-1?o(i,t.shapeValuePath).toString():t.shape,t.shape=""!==r.toString()?r:t.shape,f=n.isNullOrUndefined(t.imageUrlValuePath)?t.imageUrl:t.imageUrlValuePath.indexOf(".")>-1?o(i,t.imageUrlValuePath).toString():n.isNullOrUndefined(i[t.imageUrlValuePath])?t.imageUrl:i[t.imageUrlValuePath],t.imageUrl=f):(u=t.shapeValuePath.indexOf(".")>-1?o(i,t.shapeValuePath).toString():i[t.shapeValuePath],t.shape=""!==u.toString()?u:t.shape,"Image"===i[t.shapeValuePath]&&(t.imageUrl=n.isNullOrUndefined(t.imageUrlValuePath)?t.imageUrl:t.imageUrlValuePath.indexOf(".")>-1?o(i,t.imageUrlValuePath).toString():n.isNullOrUndefined(i[t.imageUrlValuePath])?t.imageUrl:i[t.imageUrlValuePath])),t}function dt(t,i,u,e,s,h,c,l){var y,k,lt,at,ot,a,d,ht=[],g=[],nt=0,rt=0,vt=t.markerClusterSettings.labelStyle,ct=0,ft=[],et=t.markerClusterSettings,v=u.renderer.createGroup({id:u.element.id+"_LayerIndex_"+e+"_markerCluster"}),b={cancel:!1,name:de,fill:et.fill,height:et.height,width:et.width,imageUrl:et.imageUrl,shape:et.shape,data:void 0,maps:u,cluster:et,border:et.border};u.trigger("markerClusterRendering",b,function(){for(var pt,kt,et,oi,si,gt,bt,ri,ui,yt=0;yt<i.childElementCount;yt++)if(ft=[],"hidden"!==i.childNodes[yt].style.visibility){if(d=i.childNodes[yt],y=d.getBoundingClientRect(),ft.push(yt),!n.isNullOrUndefined(y)){for(pt=yt+1;pt<i.childElementCount;pt++)"hidden"!==i.childNodes[pt].style.visibility&&(d=i.childNodes[pt],k=d.getBoundingClientRect(),n.isNullOrUndefined(k)||y.left>k.right||y.right<k.left||y.top>k.bottom||y.bottom<k.top||(ht.push(k),i.childNodes[pt].style.visibility="hidden",ft.push(pt)));if(nt=y.left+y.width/2,rt=y.top+y.height,ht.length>0){ft=ft.filter(function(n,t,i){return i.indexOf(n)===t});kt=u.element.getBoundingClientRect();nt-=kt.left;rt-=u.availableSize.height<=kt.height?kt.top:kt.bottom-kt.top;u.isTileMap?{}:ut(u,t,!1);var ti=parseInt(i.childNodes[yt].id.split("_dataIndex_")[1].split("_")[0],10),ii=parseInt(i.childNodes[yt].id.split("_MarkerIndex_")[1].split("_")[0],10),dt=t.markerSettings[ii],wt=dt.dataSource[ti],ni=void 0,fi=n.isNullOrUndefined(dt.longitudeValuePath)?n.isNullOrUndefined(wt.longitude)?n.isNullOrUndefined(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.longitude):Number(o(wt,dt.longitudeValuePath)),ei=n.isNullOrUndefined(dt.latitudeValuePath)?n.isNullOrUndefined(wt.latitude)?n.isNullOrUndefined(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.latitude):Number(o(wt,dt.latitudeValuePath));u.isTileMap?u.isTileMap&&!u.zoomSettings.enable&&(ni=it(new f(fi,ei),u.tileZoomLevel,u.tileTranslatePoint,!0)):ni=p(ei,fi,u.mapLayerPanel.calculateFactor(t),t,u);i.childNodes[yt].style.visibility="hidden";et=t.markerClusterSettings;b.cancel?((a={size:new w(et.width,et.height),fill:et.fill,borderColor:et.border.color,borderWidth:et.border.width,opacity:et.opacity,dashArray:et.dashArray}).fill=et.fill,a.size.width=et.width,a.size.height=et.height,a.imageUrl=et.imageUrl,a.shape=et.shape,a.borderColor=et.border.color,a.borderWidth=et.border.width,a.borderOpacity=n.isNullOrUndefined(et.border.opacity)?et.opacity:et.border.opacity):((a={size:new w(et.width,et.height),fill:et.fill,borderColor:et.border.color,borderWidth:et.border.width,opacity:et.opacity,dashArray:et.dashArray}).fill=b.fill,a.size.width=b.width,a.size.height=b.height,a.imageUrl=b.imageUrl,a.shape=b.shape,a.borderColor=b.border.color,a.borderWidth=b.border.width,a.borderOpacity=n.isNullOrUndefined(b.border.opacity)?et.opacity:b.border.opacity);nt=u.isTileMap||i.id.indexOf("_Markers_Group")>-1?nt:nt+3.75-b.width/2;rt=u.isTileMap||i.id.indexOf("_Markers_Group")>-1?rt:rt-b.height/2;u.isTileMap&&!u.zoomSettings.enable&&(nt=ni.x,rt=ni.y);oi=u.element.id+"_LayerIndex_"+e+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct;si=u.element.id+"_LayerIndex_"+e+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct+"_datalabel_"+ct;ct++;gt=er(a.shape,a.imageUrl,{x:0,y:0},oi,a,s,u);gt.setAttribute("transform","translate( "+nt+" "+rt+" )");"Balloon"===b.shape?gt.children[0].textContent=ft.toString():gt.textContent=ft.toString();lt=new tt(si,0,3.75,"middle",(ht.length+1).toString(),"","");(at=st(lt,vt,vt.color,s)).setAttribute("transform","translate( "+nt+" "+rt+" )");v.appendChild(at);v.appendChild(gt)}}ht=[]}for(h.appendChild(v),u.svgObject.appendChild(h),u.element.appendChild(u.svgObject),yt=0;yt<v.childElementCount;yt++)if("hidden"!==v.childNodes[yt].style.visibility&&(d=v.childNodes[yt],y=d.getBoundingClientRect(),!(n.isNullOrUndefined(y)||d.id.indexOf("_datalabel_")>-1))){for(pt=yt+1;pt<v.childElementCount;pt++)"hidden"!==v.childNodes[pt].style.visibility&&(ot=v.childNodes[pt],k=ot.getBoundingClientRect(),n.isNullOrUndefined(k)||ot.id.indexOf("_datalabel_")>-1||y.left>k.right||y.right<k.left||y.top>k.bottom||y.bottom<k.top||(g.push(ot),g.push(v.childNodes[pt-1]),v.childNodes[pt].style.visibility="hidden",v.childNodes[pt-1].style.visibility="hidden",ft.push(pt)));if(g.length>0)for(d=v.childNodes[yt],bt=0;bt<g.length;bt++)"g"===d.tagName?d.childNodes[0].textContent=d.childNodes[0].textContent+","+g[bt].textContent:d.textContent=d.textContent+","+g[bt].textContent,v.childNodes[yt-1].textContent=(+v.childNodes[yt-1].textContent+ +g[bt+1].textContent).toString(),bt++;g=[]}for(;0<v.childNodes.length;)s.insertBefore(v.childNodes[0],s.firstChild);c||r(u.element.id+"_Secondary_Element").appendChild(s);h.appendChild(s);ri=document.getElementById(u.element.id+"_LayerIndex_"+e+"_markerCluster");(n.isNullOrUndefined(ri)||ri.remove(),l)&&(ui=document.getElementById(u.element.id+"_Layer_Collections"),n.isNullOrUndefined(ui)||ui.appendChild(h))})}function or(t,i){var u=t[0].layerIndex,h=t[0].targetClusterIndex,f=t[0].markerIndex,v=t[0].dataIndex,e=i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+f,c=i.layers[u].markerSettings[f],o=e+"_dataIndex_"+v+"_cluster_"+h,y="Balloon"===i.layers[u].markerClusterSettings.shape?s(o+"_Group"):s(o),p=s(o+"_datalabel_"+h),l,r;for(y.setAttribute("visibility","visible"),p.setAttribute("visibility","visible"),l=t[0].data.length,r=0;r<l;r++)("Balloon"===c.shape&&n.isNullOrUndefined(c.template)?s(e+"_dataIndex_"+t[0].data[r].index+"_Group"):s(e+"_dataIndex_"+t[0].data[r].index)).style.visibility="hidden";a(i.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+f+"_markerClusterConnectorLine")}function sr(t,i,r,u){var a=t[0].layerIndex,tt=t[0].markerIndex,ht=t[0].targetClusterIndex,it=t[0].dataIndex,e=u?s:r.querySelector.bind(r),o=u?"":"#",h=i.element.id+"_LayerIndex_"+a+"_MarkerIndex_"+tt,c=i.layers[a].markerSettings[tt],et=h+"_dataIndex_"+it+"_cluster_"+ht,ot="Balloon"===i.layers[a].markerClusterSettings.shape?e(o+""+et+"_Group"):e(o+""+et),pt=e(o+""+et+"_datalabel_"+ht),v,y,nt,yt,ft;ot.setAttribute("visibility","hidden");pt.setAttribute("visibility","hidden");var f="Balloon"===c.shape&&n.isNullOrUndefined(c.template)?e(o+""+h+"_dataIndex_"+it+"_Group"):e(o+""+h+"_dataIndex_"+it),p=f.parentElement.id.indexOf("Template_Group")>-1?f.getBoundingClientRect().height:c.height,w=f.parentElement.id.indexOf("Template_Group")>-1?f.getBoundingClientRect().width:c.width,ct=+ot.getAttribute("transform").split("translate(")[1].trim().split(" ")[0],lt=+ot.getAttribute("transform").split("translate(")[1].trim().split(" ")[1].split(")")[0].trim(),rt=w+5,b=6.28*rt,st=0,l=Math.round(b/w);st+=l;for(var ut=t[0].data.length,k=Math.round(p/b*100),at=(k=ut<l?100/ut:k)/100*360,d=ut<l?45:0,wt=1,bt="M "+ct+" "+lt+" ",vt="",g=0;g<ut;g++){if(st===g||Math.round(d)>=360){for(d=0,b=6.28*(rt=(w+5)*++wt),l=Math.round(b/p),k=Math.round(p/b*100);k*l<100;)l++;at=k/100*360;st+=l}v=ct+rt*Math.sin(2*Math.PI*d/360);y=lt+rt*Math.cos(2*Math.PI*d/360);vt+=bt+"L "+v+" "+y+" ";(f="Balloon"===c.shape&&n.isNullOrUndefined(c.template)?e(o+""+h+"_dataIndex_"+t[0].data[g].index+"_Group"):e(o+""+h+"_dataIndex_"+t[0].data[g].index)).parentElement.id.indexOf("Template_Group")>-1?(f.style.transform="",f.style.left=i.isTileMap?v-w/2+"px":v-w/2-10+"px",f.style.top=i.isTileMap?y-p/2+"px":y-p/2-10+"px",f.setAttribute("transform","translate( "+v+" "+y+")")):f.setAttribute("transform","translate( "+v+" "+y+")");f.style.visibility="visible";d+=at}nt=i.layers[a].markerClusterSettings.connectorLineSettings;yt={d:vt,id:i.element.id+"_LayerIndex_"+a+"_MarkerIndex_"+tt+"_dataIndex_"+it+"_markerClusterConnectorLine",stroke:nt.color,"fill-opacity":nt.opacity,"stroke-opacity":nt.opacity,"stroke-width":nt.width};r=u?e(i.element.id+"_Markers_Group"):r;ft=i.renderer.createGroup({id:i.element.id+"_LayerIndex_"+a+"_MarkerIndex_"+tt+"_markerClusterConnectorLine"});ft.appendChild(i.renderer.drawPath(yt));"Balloon"===c.shape?r.insertBefore(ft,r.querySelector("#"+h+"_dataIndex_0_Group")):r.insertBefore(ft,r.querySelector("#"+h+"_dataIndex_0"))}function hr(t,i,r,u,e,o,s,h,c,l,v){var g={size:new w(t.width,t.height),fill:t.fill,borderColor:t.border.color,borderWidth:t.border.width,opacity:i.opacity,dashArray:i.dashArray,borderOpacity:n.isNullOrUndefined(t.border.opacity)?i.opacity:t.border.opacity},k,d;a(s);var y=er(t.shape,t.imageUrl,{x:0,y:0},s,g,v,l),p=(l.isTileMap?e.x:(e.x+o.x)*c)+h.x,b=(l.isTileMap?e.y:(e.y+o.y)*c)+h.y;return y.setAttribute("transform","translate( "+p+" "+b+" )"),gt(l.selectedMarkerElementId,l.markerSelectionClass,y,"MarkerselectionMapStyle"),v.appendChild(y),k=r.length-1===u?"marker":null,d=new f(p,b),i.animationDuration>0&&wr(y,i.animationDelay,i.animationDuration,d,l,k),v}function cr(t,i,u,f,e,o,s,h,c,l,a){var v,w,p,y;if((i=ii(t.template,a))&&i(f,a,t.template,a.element.id+"_MarkerTemplate"+e,!1).length){for(v=function(t,i,r,u,f){var s=n.createElement("div",{id:i}),c;for(s.style.cssText="position: absolute;pointer-events: auto;",c=t.length;c>0;)s.appendChild(t[0]),c--;for(var h=s.innerHTML,o=Object.keys(r),l=RegExp,e=0;e<o.length;e++)"object"==typeof r[o[e]]?h=fr(h,"",r,f):"latitude"!==o[e].toLowerCase()&&"longitude"!==o[e].toLowerCase()&&(h=h.replace(new l("{{:"+o[e]+"}}","g"),r[o[e].toString()]));return s.innerHTML=h,s}(i(f,a,t.template,a.element.id+"_MarkerTemplate"+e,!1),u,f,0,a),w=0;w<v.children.length;w++)v.children[w].style.pointerEvents="none";(v.style.left=(a.isTileMap?s.x:(s.x+h.x)*c)+l.x-a.mapAreaRect.x+"px",v.style.top=(a.isTileMap?s.y:(s.y+h.y)*c)+l.y-a.mapAreaRect.y+"px",o.appendChild(v),"GoogleStaticMap"===a.layers[a.baseLayerIndex].layerType)&&(p=r(a.element.id+"_StaticGoogleMap").getBoundingClientRect(),y=v.getBoundingClientRect(),(p.x>y.x||p.x+640<y.x+y.width)&&(p.y>y.y||p.y+p.height<y.y+y.height)&&(v.style.display="none"))}return o}function gt(t,i,r,u){if(t)for(var f=0;f<t.length;f++)r.getAttribute("id")===t[f]&&(0!==f&&"g"!==r.tagName||(n.isNullOrUndefined(i)||n.isNullOrUndefined(i.id)||document.body.appendChild(i),r.id.indexOf("_MarkerIndex_")>-1&&r.childElementCount>0&&r.children[0].setAttribute("class",u)),r.setAttribute("class",u))}function ni(n,t){return t&&t.appendChild(n),n}function lr(n,t,i,r,u,f){var e,h=i.width,c=i.height,s;r.x-=h/2;r.y-=c/2;t.d="M15,0C8.8,0,3.8,5,3.8,11.2C3.8,17.5,9.4,24.4,15,30c5.6-5.6,11.2-12.5,11.2-18.8C26.2,5,21.2,0,15,0z M15,16c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S17.8,16,15,16z";var o=n.renderer.drawPath(t),l=i.width/30,a=i.height/30;return(o.setAttribute("transform","translate("+r.x+", "+r.y+") scale("+l+", "+a+")"),"Marker"===u)?(s=n.renderer.createGroup({id:t.id+"_Group"}),ni(o,s),e=ni(s,f)):e=o,e}function ht(t,i,r,u){var f,e,s;if(!n.isNullOrUndefined(i))for(f=0;f<t.length;f++)if(e=r.indexOf(".")>-1?o(t[f],r):t[f][r],s=ti(e,u,i),(!n.isNullOrUndefined(e)&&isNaN(i[s])&&"string"==typeof e?e.toLowerCase():e)===(!n.isNullOrUndefined(i[s])&&isNaN(i[s])?i[s].toLowerCase():i[s]))return f;return null}function ti(t,i,r){if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(r)&&!n.isNullOrUndefined(i))for(var f="[object Array]"===Object.prototype.toString.call(i)?i:[i],u=0;u<f.length;u++)if((n.isNullOrUndefined(t)||"string"!=typeof t?t:t.toLowerCase())===(!n.isNullOrUndefined(r[f[u]])&&isNaN(r[f[u]])?r[f[u]].toLowerCase():r[f[u]]))return f[u];return null}function yi(n,t,i){var b,r;if(!n.length)return null;for(var l,a,o,s,w=n.length,v=0,u=0,f=0,e=0;e<=w-1;e++)l=n[e].x,a="Mercator"===t||"Normal"===i?n[e].y:-n[e].y,e===w-1?(o=n[0].x,s="Mercator"===t||"Normal"===i?n[0].y:-n[0].y):(o=n[e+1].x,s="Mercator"===t||"Normal"===i?n[e+1].y:-n[e+1].y),v+=Math.abs(l*s-o*a),u+=Math.abs((l+o)*(l*s-o*a)),f+=Math.abs((a+s)*(l*s-o*a));v*=.5;b=n.some(function(n){return n.x<5&&n.y<5})&&"Normal"===i?6:4;u*=1/(b*v);f*=1/(b*v);var k={x:0,y:0},y={x:0,y:0},d={x:0,y:0},p={x:0,y:0},g={x:0,y:0},h={x:0,y:0},nt={x:0,y:0},c={x:0,y:0},tt=0;for(e=0;e<=w-1;e++)r=n[e],r.y="Mercator"===t||"Normal"===i?r.y:-r.y,r.y>f?r.x<u&&u-r.x<u-g.x?g={x:r.x,y:r.y}:r.x>u&&(0===h.x||r.x-u<h.x-u)&&(h={x:r.x,y:r.y}):r.x<u&&u-r.x<u-nt.x?nt={x:r.x,y:r.y}:r.x>u&&(0===c.x||r.x-u<c.x-u)&&(c={x:r.x,y:r.y}),tt=h.y-c.y+(h.y-c.y)/4,r.x>u?r.y<f&&f-r.y<f-k.y?k={x:r.x,y:r.y}:r.y>f&&(0===y.y||r.y-f<y.y-f)&&(y={x:r.x,y:r.y}):r.y<f&&f-r.y<f-d.y?d={x:r.x,y:r.y}:r.y>f&&(0===p.y||r.y-f<p.y-f)&&(p={x:r.x,y:r.y});return{x:u,y:f,rightMin:k,rightMax:y,leftMin:d,leftMax:p,points:n,topMax:c,topMin:nt,bottomMax:h,bottomMin:g,height:tt}}function ar(t){var i=!1;return"[object Array]"===Object.prototype.toString.call(t)&&Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(t.geometry)||"Path"!==t.geometry.type||(i=!0)}),i}function g(n,t,i){var r=t,f=l(t,i).width,u;if(f>n)for(u=t.length-1;u>=0;--u)if((f=l(r=t.substring(0,u)+"...",i).width)<=n||r.length<4)return r.length<4&&(r=" "),r;return r}function a(t){var i=document.getElementById(t);return i?n.remove(i):null}function vr(n,t){var i=p(n.minLatOfGivenLocation,n.minLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),r=p(n.maxLatOfGivenLocation,n.maxLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),u=(i.x+r.x)/2,e=(i.y+r.y)/2;return new f(u,e)}function ut(t,i,r){var e,v=t.zoomSettings.zoomFactor,k=t.centerPosition,y=k.latitude,w=k.longitude,d=!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&t.zoomNotApplied,h,c,u,ft,ot,b,it,rt,st;n.isNullOrUndefined(t.mapScaleValue)&&(t.mapScaleValue=v);t.zoomSettings.shouldZoomInitially&&t.zoomSettings.enable&&(t.mapScaleValue=e=v=(t.zoomSettings.shouldZoomInitially||t.enablePersistence)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?1:t.markerZoomFactor,t.mapScaleValue===t.markerZoomFactor||t.enablePersistence||(t.mapScaleValue=v=t.markerZoomFactor),n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(y=t.markerCenterLatitude,w=t.markerCenterLongitude));d&&(t.mapScaleValue=e=v=t.scaleOfGivenLocation);var l=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.min,g=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.max,ut=r?1:t.mapScaleValue;if(n.isNullOrUndefined(t.currentShapeDataLength)&&(t.currentShapeDataLength=n.isNullOrUndefined(i.shapeData.features)?i.shapeData.geometries.length:i.shapeData.features.length),u=t.totalRect&&t.legendSettings.visible?t.totalRect:t.mapAreaRect,ft=t.availableSize,!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(g)){var o=Math.abs(g.x-l.x),s=Math.abs(l.y-g.y),et=r?1:1===t.markerZoomFactor?t.mapScaleValue:v;if(k=t.zoomSettings.shouldZoomInitially&&t.markerZoomedState&&!t.zoomPersistence?t.markerZoomCenterPoint:t.centerPosition,(n.isNullOrUndefined(w)||0===w||n.isNullOrUndefined(y)||0===y)&&!d)if(n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType)0!==s&&0!==o&&s!==o||(o=u.width/2,s=u.height),o*=e=(e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)))>1.05?1:e,s*=e,ot=0!==l.x&&"layers"===t.translateType?ft.width-u.width:0,h=u.x+(-l.x+(u.width/2-o/2))-ot,c=u.y+(-l.y+(u.height/2-s/2)),t.previousTranslate=new f(h,c);else if(t.zoomSettings.shouldZoomInitially||1!==t.markerZoomFactor||1!==t.mapScaleValue)if(e=t.mapScaleValue<1?t.mapScaleValue+1:t.mapScaleValue,t.mapScaleValue=t.zoomSettings.enable&&1!==t.mapScaleValue?t.mapScaleValue:1,t.currentShapeDataLength!==(n.isNullOrUndefined(i.shapeData.features)?i.shapeData.geometries.length:i.shapeData.features.length)&&"SubLayer"!==i.type)b=parseFloat(Math.min(u.height/s,u.width/o).toFixed(2)),s*=b,o*=b,c=u.y+(-l.y+(u.height/2-s/2)),e=b,h=u.x+(-l.x+(u.width/2-o/2));else if(t.availableSize.height!==t.heightBeforeRefresh||t.widthBeforeRefresh!==t.availableSize.width){it=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2));rt=o;rt*=it;st=s*it;var ht=u.x+(-l.x+(u.width/2-rt/2)),ct=u.y+(-l.y+(u.height/2-st/2)),lt=(t.translatePoint.x-t.previousTranslate.x)/t.widthBeforeRefresh,at=(t.translatePoint.y-t.previousTranslate.y)/t.heightBeforeRefresh;h=ht+lt*t.availableSize.width;c=ct+at*t.availableSize.height;t.previousTranslate=new f(ht,ct);t.zoomTranslatePoint.x=h;t.zoomTranslatePoint.y=c}else n.isNullOrUndefined(t.previousProjection)||!(1===t.mapScaleValue||t.mapScaleValue<=1.05)||t.zoomModule.isDragZoom?(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y,e=t.scale):(o*=e=(e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)))>1.05?1:e,h=u.x+(-l.x+(u.width/2-o/2)),s*=e,c=u.y+(-l.y+(u.height/2-s/2)));else s*=e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)),o*=e,c=u.y+(-l.y+(u.height/2-s/2)),h=u.x+(-l.x+(u.width/2-o/2));else{var nt=((o+Math.abs(t.mapAreaRect.width-o))/2+t.mapAreaRect.x)/et,tt=((s+Math.abs(t.mapAreaRect.height-s))/2+t.mapAreaRect.y)/et,a=d?vr(t,i):p(y,w,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType?(h=-a.x+nt,c=-a.y+tt,e=ut):(1!==Math.floor(t.scale)&&t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt):t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt,e=ut):(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y),e=t.mapScaleValue)}n.isNullOrUndefined(t.translatePoint)||(h=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:h,c=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:c)}return e=t.enablePersistence?t.mapScaleValue>=1?t.mapScaleValue:1:e,t.widthBeforeRefresh=t.availableSize.width,t.heightBeforeRefresh=t.availableSize.height,{scale:e,location:new f(h,c)}}function yt(t,i,r){var e,o=t.zoomSettings.zoomFactor,et=t.centerPosition,k=et.latitude,d=et.longitude,tt=!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&t.zoomNotApplied,v,b,ft,y,nt,u;n.isNullOrUndefined(t.previousCenterLatitude)&&n.isNullOrUndefined(t.previousCenterLongitude)?(t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.previousCenterLatitude!==t.centerPosition.latitude&&t.previousCenterLongitude!==t.centerPosition.longitude?(t.centerPositionChanged=!0,t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.centerPositionChanged=!1;(n.isNullOrUndefined(t.mapScaleValue)||o>t.mapScaleValue)&&(t.mapScaleValue=t.isReset&&1===t.mapScaleValue?t.mapScaleValue:o);t.mapScaleValue=1!==t.zoomSettings.zoomFactor&&t.zoomSettings.zoomFactor===t.mapScaleValue||t.zoomSettings.zoomFactor===t.mapScaleValue||t.centerPositionChanged?t.zoomSettings.zoomFactor:t.mapScaleValue;t.zoomSettings.shouldZoomInitially&&!t.isZoomByPosition&&(t.mapScaleValue=o=e=(t.enablePersistence||t.zoomSettings.shouldZoomInitially)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?t.mapScaleValue:t.markerZoomFactor,o=t.mapScaleValue,n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(k=t.markerCenterLatitude,d=t.markerCenterLongitude));tt&&(t.mapScaleValue=e=o=t.scaleOfGivenLocation);var l,a,it=r?1:t.mapScaleValue,s=t.mapAreaRect,g=t.baseMapRectBounds.min,ot=t.baseMapRectBounds.max,st=r?1:t.mapScaleValue,rt=Math.abs(ot.x-g.x),ut=Math.abs(g.y-ot.y);if((n.isNullOrUndefined(d)||0===d||n.isNullOrUndefined(k)||0===k)&&!tt){if(v=0===t.zoomSettings.zoomFactor?1:t.zoomSettings.zoomFactor,b=t.zoomSettings.maxZoom,e=v=v>b?b:v,ft=0===t.mapScaleValue?1:t.mapScaleValue>b?b:t.mapScaleValue,c=s.x+(-g.x+(s.width/2-rt/2)),h=s.y+(-g.y+(s.height/2-ut/2)),!n.isNullOrUndefined(t.zoomTranslatePoint)||!n.isNullOrUndefined(t.previousProjection))if(t.previousProjection!==t.projectionType){for(y=[],nt={x:c,y:h},y.push(nt),u=1;u<b;u++)nt={x:y[u-1].x-(s.width/u-s.width/(u+1))/2,y:y[u-1].y-(s.height/u-s.height/(u+1))/2},y.push(nt);c=y[v-1].x;h=y[v-1].y}else c=t.zoomTranslatePoint.x,h=t.zoomTranslatePoint.y,v!==ft&&(e=ft);n.isNullOrUndefined(t.translatePoint)||(l=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:c,a=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:h)}else{var h=(ut+Math.abs(t.mapAreaRect.height-ut))/2/st,c=(rt+Math.abs(t.mapAreaRect.width-rt))/2/st,w=tt?vr(t,i):p(k,d,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.zoomTranslatePoint)&&n.isNullOrUndefined(t.previousProjection)||t.zoomNotApplied?(l=-w.x+c+t.mapAreaRect.x/it,a=-w.y+h+t.mapAreaRect.y/it):t.previousProjection!==t.projectionType?(l=-w.x+c,a=-w.y+h):(t.isZoomByPosition&&(t.zoomTranslatePoint.x=-w.x+c,t.zoomTranslatePoint.y=-w.y+h),l=t.zoomTranslatePoint.x,a=t.zoomTranslatePoint.y,o=it);n.isNullOrUndefined(t.translatePoint)||(a=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:a,l=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:l);e=0!==o?o:1}return e=t.enablePersistence?0===t.mapScaleValue?1:t.mapScaleValue:e,t.widthBeforeRefresh=t.availableSize.width,t.heightBeforeRefresh=t.availableSize.height,{scale:r?1:e,location:new f(l,a)}}function r(n){return document.getElementById(n)}function yr(n,t){return n.formatFunction=n.intl.getNumberFormat({format:n.format,useGrouping:n.useGroupingSeparator}),n.formatFunction(t)}function ii(t,i){var r=null;try{"function"!=typeof t&&document.querySelectorAll(t).length?r=n.compile(document.querySelector(t).innerHTML.trim()):(i.isVue||i.isVue3||"function"==typeof t)&&(r=n.compile(t))}catch(i){r=n.compile(t)}return r}function s(n){return document.getElementById(n)}function ct(n){return document.getElementsByClassName(n)}function e(n,t){var i=null;return document.getElementById(t)&&(i=document.getElementById(t).querySelector("#"+n)),i}function pr(n,t,i,r){for(var f,e=r.layers[n].shapeData.features,u=0;u<e.length;u++)if(e[u].properties.name===t){f=r.element.id+"_LayerIndex_"+n+"_shapeIndex_"+u+"_dataIndex_undefined";break}return s(f)}function pt(t,i,r){var u=n.createElement("style",{id:t});return u.innerText="."+i+"{fill:"+r.fill+";fill-opacity:"+r.opacity.toString()+";stroke-opacity:"+r.border.opacity.toString()+";stroke-width:"+r.border.width.toString()+";stroke:"+r.border.color+";}",u}function lt(t,i,r){var u=s(t);n.isNullOrUndefined(u)||(u.innerText="."+i+"{fill:"+r.fill+";fill-opacity:"+r.opacity.toString()+";stroke-width:"+r.border.width.toString()+";stroke-opacity:"+r.border.opacity.toString()+";stroke:"+r.border.color+"}")}function yf(t,i,r,u,f){var o={color:t.border.color,width:t.border.width/i.scale,opacity:t.border.opacity},e={opacity:t.opacity,fill:t.fill,border:o,name:of,target:r.id,cancel:!1,shapeData:u,data:f,maps:i};i.trigger("itemSelection",e,function(){e.border.opacity=n.isNullOrUndefined(t.border.opacity)?t.opacity:t.border.opacity;i.shapeSelectionItem.push(e.shapeData);s("ShapeselectionMap")?lt("ShapeselectionMap","ShapeselectionMapStyle",e):document.body.appendChild(pt("ShapeselectionMap","ShapeselectionMapStyle",e))})}function c(n){n.removeAttribute("class")}function wr(t,i,r,u,f,e,o){void 0===o&&(o=0);var h=u.x,c=u.y,s=0,l=t.getAttribute("transform")||"";new n.Animation({}).animate(t,{duration:r,delay:i,progress:function(i){if(i.timeStamp>i.delay){if(f.isTileMap&&0===s){var r=document.querySelector(".GroupElement");n.isNullOrUndefined(r)||(r.style.display="block")}s=(i.timeStamp-i.delay)/i.duration;t.setAttribute("transform","translate( "+(h-o*s)+" "+(c-o*s)+" ) scale("+s+")")}},end:function(){if(t.setAttribute("transform",l),e){var n={cancel:!1,name:ff,element:e,maps:f};f.trigger(ff,n)}}})}function pf(n){a(n)}function pi(t,i,r,u,f,e,o,s,h){var b=hi(r,u,s),w;n.isNullOrUndefined(b)||(r=b.x,u=b.y);for(var a=document.getElementById(o),c=l(t,{fontFamily:"Segoe UI",size:"8px",fontStyle:"Normal",fontWeight:"Regular"}).width,v=t.split(" "),y=v[0].length,p=1;p<v.length;p++)y<v[p].length&&(y=v[p].length);a||((a=n.createElement("div",{id:o})).style.cssText='background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(0, 0, 0); padding-left:5px;font-size:12px; font-family: "Segoe UI"; text-align:center');r<f-c||(r>f-c&&r<f-8*y?c=f-r:r>=f-8*y&&(r>c?r-=c:(c=r,r=0)));w=i.split("px");br(a,t,r,u,w,c,f,s);a.clientHeight+2*parseInt(w[0],10)>e&&(c=r,r=0);br(a,t,r,u,w,c,f,s);h&&setTimeout(pf,5e3,o)}function br(n,t,i,r,u,f,e,o){n.innerText=t;n.style.top=-1!==n.id.indexOf("_Legend")?(parseInt(u[0],10)+r).toString()+"px":(2*parseInt(u[0],10)).toString()+"px";n.style.left=i.toString()+"px";n.style.width=f.toString()+"px";n.style.maxWidth=e.toString()+"px";n.style.wordWrap="break-word";o.appendChild(n)}function kr(n){var i,t;return-1!==n.indexOf("#")&&-1===n.toLowerCase().indexOf("rgb")?(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n))?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null:-1!==n.toLowerCase().indexOf("rgb")?(t=n.match(/\d+/g).map(function(n){return parseInt(n,10)}))?{r:t[0],g:t[1],b:t[2]}:null:(i=document.createElement("div"),i.style.color=n,t=window.getComputedStyle(document.body.appendChild(i)).color.match(/\d+/g).map(function(n){return parseInt(n,10)}),document.body.removeChild(i),t?{r:t[0],g:t[1],b:t[2]}:null)}function dr(t,i,r,u){for(var e,f=0;f<t.childElementCount;f++)if((e=t.childNodes[f]).id.indexOf("_NavigationGroup")>-1)wf(e,i,r,u);else{var s,o=0,h=u.layersCollection[i].shapeSettings.borderWidthValuePath,c=u.layersCollection[i].shapeSettings.border.width,l=u.layersCollection[i].shapeSettings.circleRadius;s=u.layersCollection[i].shapeSettings.borderWidthValuePath&&null!==(o=ht(u.layersCollection[i].dataSource,u.layersCollection[i].layerData[f].property,u.layersCollection[i].shapeDataPath,u.layersCollection[i].shapePropertyPath,u.layersCollection[i]))&&u.layersCollection[i].dataSource[o][h]?u.layersCollection[i].dataSource[o][h]:n.isNullOrUndefined(c)?0:c;e.setAttribute("stroke-width",(s/r).toString());(t.id.indexOf("_Point")>-1||t.id.indexOf("_MultiPoint")>-1)&&e.setAttribute("r",(l/r).toString())}}function wf(n,t,i,r){for(var f,e,u=0;u<n.childElementCount;u++)"path"===(f=n.childNodes[u]).tagName&&(e=r.layersCollection[t].navigationLineSettings[parseFloat(f.id.split("_NavigationIndex_")[1].split("_")[0])].width,f.setAttribute("stroke-width",(e/i).toString()))}function gr(n){for(var r=[],i=n.touches,t=0;t<i.length;t++)r.push({pageX:i[t].pageX,pageY:i[t].pageY});return r}function nu(n,t){var i=n.pageX-t.pageX,r=n.pageY-t.pageY;return Math.sqrt(i*i+r*r)}function tu(n,t){return n+t}function bf(n,t,i,r,u,f,e){var c=0,o=e.previousPoint,l=e.previousScale,v=u-l,s=new k(0,0),h=1;if(u!==l){var a=function(n,t){return n.x===t.x?null:(t.y-n.y)/(t.x-n.x)}(o,r),y=function(n,t){return null===t?n.x:n.y-t*n.x}(o,a),p=r.x-o.x,w=r.y-o.y;iu(n,0,i,function(n){n.timeStamp>n.delay&&(c=(n.timeStamp-n.delay)/n.duration,h=l+c*v,s.x=o.x+c*p/(h/u),s.y=null==a?o.y+c*w:a*s.x+y,n.element.setAttribute("transform","scale( "+h+" ) translate( "+s.x+" "+s.y+" )"),e.translatePoint=s,e.scale=h,e.zoomModule.processTemplate(r.x,r.y,h,e))},function(){e.translatePoint=r;e.scale=u;n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )");e.zoomModule.processTemplate(r.x,r.y,u,e)})}else n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )")}function iu(n,t,i,u,f){var o,s=this,e=null,h=function(t){e||(e=t);var c=t-e;c<i?(u.call(s,{element:n,delay:0,timeStamp:c,duration:i}),window.requestAnimationFrame(h)):(window.cancelAnimationFrame(o),f.call(s,{element:n}),n.id.indexOf("Marker")>-1&&(r(n.id.split("_Layer")[0]+"_Markers_Group").style.cssText="visibility:visible"))};o=window.requestAnimationFrame(h)}function bi(n,t,i,r){var o=0,u=n.getAttribute("transform").split(" ");2===u.length&&(u[2]=u[1].split(")")[0],u[1]=u[0].split("(")[1]);var f=new k(parseInt(u[1],10),parseInt(u[2],10)),s=r.x-f.x,h=r.y-f.y,e=new k(0,0);iu(n,0,i,function(n){n.timeStamp>n.delay&&(o=(n.timeStamp-n.delay)/n.duration,e.x=f.x+o*s,e.y=f.y+o*h,n.element.setAttribute("transform","translate( "+e.x+" "+e.y+" )"))},function(){n.setAttribute("transform","translate( "+r.x+" "+r.y+" )")})}function ou(t,i){var u=n.isNullOrUndefined(i.shouldZoomPreviousFactor)?null:i.shouldZoomPreviousFactor,r=n.isNullOrUndefined(i.shouldZoomCurrentFactor)?null:i.shouldZoomCurrentFactor;n.isNullOrUndefined(r)?!n.isNullOrUndefined(u)&&n.isNullOrUndefined(r)&&i.shouldZoomPreviousFactor!==t?i.shouldZoomCurrentFactor=t:i.shouldZoomPreviousFactor=t:(i.shouldZoomCurrentFactor=null,i.shouldZoomPreviousFactor=null)}function su(n,t,i,r,u,f,e,o){var s,a,b=e.zoomSettings.maxZoom,v=Math.sin(t*Math.PI/180),k=Math.log((1+v)/(1-v))/2,d=Math.max(Math.min(k,Math.PI),-Math.PI)/2,y=Math.sin(n*Math.PI/180),g=Math.log((1+y)/(1-y))/2,nt=Math.max(Math.min(g,Math.PI),-Math.PI)/2,h,c;e.zoomNotApplied&&!e.isTileMap&&(h=Math.abs((e.baseMapBounds.latitude.max-e.baseMapBounds.latitude.min)/(t-n)),c=Math.abs((e.baseMapBounds.longitude.max-e.baseMapBounds.longitude.min)/(r-i)),a=o?(h+c)/2:Math.min(h,c));var tt=(d-nt)/Math.PI,l=r-i,it=(l<0?l+360:l)/360,p=Math.log(f/256/tt)/Math.LN2,w=Math.log(u/256/it)/Math.LN2,rt=e.zoomNotApplied&&!e.isTileMap?a:o&&!e.isTileMap?(p+w)/2:Math.min(p,w);return s=Math.min(rt,b),s=e.isTileMap||!e.zoomNotApplied?Math.floor(s):s,e.isTileMap||ou(s,e),s}function wt(t){var r,i=n.isNullOrUndefined(t.result)?t.actual:t.result;return n.isNullOrUndefined(i.length)?n.isNullOrUndefined(i.Items)||(r=i.Items):r=i,r}var oi,bt,si,w,rt,ru,uu,fu,eu,wi,ei,af;oi=t(864);const n=ejdashboard.base,ot=ejdashboard.svgbase;si=(bt=function(n,t){return bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},bt(n,t)},function(n,t){function i(){this.constructor=n}bt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});w=function(){return function(n,t){this.width=n;this.height=t}}();var f=function(){return function(n,t){this.x=n;this.y=t}}(),ur=function(){return function(n,t){this.min=n;this.max=t}}(),li=function(){return function(n,t){this.latitude=new ur(n.min,n.max);this.longitude=new ur(t.min,t.max)}}();var tt=function(){return function(n,t,i,r,u,f,e){void 0===f&&(f="");this.transform="";this.baseLine="auto";this.id=n;this.text=u;this.transform=f;this.anchor=r;this.x=t;this.y=i;this.baseLine=e}}(),y=function(){return function(n,t,i,r,u,f,e,o){this.id=n;this["fill-opacity"]=u;this["stroke-opacity"]=f;this.fill=t;this.stroke=r;this["stroke-width"]=i;this["stroke-dasharray"]=e;this.d=o}}(),vf=function(){return function(n,t,i){this.r=n;this.g=t;this.b=i}}(),b=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,r.opacity)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c["stroke-dasharray"]=h,c["fill-opacity"]=u,c["stroke-opacity"]=r.opacity,c}return si(t,n),t}(y),at=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,r.color,u,r.opacity,s)||this;return h.cy=e,h.cx=f,h.r=o,h["stroke-dasharray"]=s,h["fill-opacity"]=u,h["stroke-opacity"]=r.opacity,h}return si(t,n),t}(y),k=function(){return function(n,t){this.x=n;this.y=t}}(),v=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}();wi=function(){return function(n,t,i,r,u){this.dataOptions=n;this.type=t||"GET";this.async=i||!0;this.contentType=r;this.sendData=u}}();!function(n){n.mapsTitleFont={size:"14px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:null,fontStyle:"Regular",fontFamily:null};n.legendTitleFont={size:"12px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:null};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(rt||(rt={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"}}(ru||(ru={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"}}(uu||(uu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#000000",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(fu||(fu={})),function(n){n.mapsTitleFont={fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",size:"14px",fontStyle:"Medium",color:"#FFFFFF"};n.mapsSubTitleFont={size:"13px",color:"#FFFFFF",fontWeight:"Medium",fontFamily:"Roboto, Noto, Sans-serif",fontStyle:"Medium"};n.tooltipLabelFont={size:"12px",color:"#282727",fontWeight:"Regular",fontFamily:"Roboto",fontStyle:"Regular"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",color:"#DADADA",fontStyle:"Medium"}}(eu||(eu={}));var h=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},kf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"content",void 0),i([n.Property("0px")],r.prototype,"x",void 0),i([n.Property("0px")],r.prototype,"y",void 0),i([n.Property("None")],r.prototype,"verticalAlignment",void 0),i([n.Property("None")],r.prototype,"horizontalAlignment",void 0),i([n.Property("-1")],r.prototype,"zIndex",void 0),r}(n.ChildProperty),df=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("Start")],r.prototype,"position",void 0),i([n.Property("false")],r.prototype,"showArrow",void 0),i([n.Property(2)],r.prototype,"size",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"offSet",void 0),r}(n.ChildProperty),ft=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("12px")],r.prototype,"size",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property("Roboto, Noto, Sans-serif")],r.prototype,"fontFamily",void 0),i([n.Property("Medium")],r.prototype,"fontWeight",void 0),i([n.Property("Medium")],r.prototype,"fontStyle",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),gf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("transparent")],r.prototype,"fill",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property(null)],r.prototype,"borderColor",void 0),i([n.Property(30)],r.prototype,"radius",void 0),i([n.Property(null)],r.prototype,"selectionColor",void 0),i([n.Property(null)],r.prototype,"highlightColor",void 0),i([n.Property(5)],r.prototype,"padding",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(["ZoomIn","ZoomOut","Reset"])],r.prototype,"toolbarItems",void 0),r}(n.ChildProperty),ne=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("white")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property("#707070")],r.prototype,"borderColor",void 0),i([n.Property("black")],r.prototype,"fontColor",void 0),i([n.Property("")],r.prototype,"fontFamily",void 0),i([n.Property("")],r.prototype,"fontStyle",void 0),i([n.Property("")],r.prototype,"fontWeight",void 0),i([n.Property("")],r.prototype,"fontSize",void 0),i([n.Property(1)],r.prototype,"fontOpacity",void 0),r}(n.ChildProperty),te=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("transparent")],r.prototype,"backgroundColor",void 0),i([n.Property(1)],r.prototype,"borderOpacity",void 0),i([n.Property(1)],r.prototype,"borderWidth",void 0),i([n.Property("transparent")],r.prototype,"borderColor",void 0),i([n.Property("Far")],r.prototype,"horizontalAlignment",void 0),i([n.Property("Near")],r.prototype,"verticalAlignment",void 0),i([n.Property("Horizontal")],r.prototype,"orientation",void 0),i([n.Complex({},gf)],r.prototype,"buttonSettings",void 0),i([n.Complex({},ne)],r.prototype,"tooltipSettings",void 0),r}(n.ChildProperty),d=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"opacity",void 0),r}(n.ChildProperty),ie=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),ki=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("")],r.prototype,"template",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:"transparent",width:1},d)],r.prototype,"border",void 0),i([n.Complex({fontFamily:null,size:null,fontWeight:null},ft)],r.prototype,"textStyle",void 0),i([n.Property(null)],r.prototype,"format",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),r}(n.ChildProperty),re=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(10)],r.prototype,"left",void 0),i([n.Property(10)],r.prototype,"right",void 0),i([n.Property(10)],r.prototype,"top",void 0),i([n.Property(10)],r.prototype,"bottom",void 0),r}(n.ChildProperty),ue=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("#000000")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),fe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"allowClustering",void 0),i([n.Complex({color:"transparent",width:1},d)],r.prototype,"border",void 0),i([n.Property("#D2691E")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Rectangle")],r.prototype,"shape",void 0),i([n.Property(12)],r.prototype,"width",void 0),i([n.Property(12)],r.prototype,"height",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Complex({},ft)],r.prototype,"labelStyle",void 0),i([n.Property(!1)],r.prototype,"allowClusterExpand",void 0),i([n.Complex({},ue)],r.prototype,"connectorLineSettings",void 0),r}(n.ChildProperty),hu=(n.ChildProperty,function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"from",void 0),i([n.Property(null)],r.prototype,"to",void 0),i([n.Property(null)],r.prototype,"value",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"minOpacity",void 0),i([n.Property(null)],r.prototype,"maxOpacity",void 0),i([n.Property(null)],r.prototype,"label",void 0),i([n.Property(!0)],r.prototype,"showLegend",void 0),r}(n.ChildProperty)),ee=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),oe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"shapePath",void 0),i([n.Property(null)],r.prototype,"shapeValue",void 0),r}(n.ChildProperty),ri=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(!1)],r.prototype,"enableMultiSelect",void 0),i([n.Complex({color:"transparent",width:0},d)],r.prototype,"border",void 0),r}(n.ChildProperty),ui=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Complex({color:"transparent",width:0},d)],r.prototype,"border",void 0),r}(n.ChildProperty),se=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"angle",void 0),i([n.Complex({showArrow:!1,position:"Start",size:5,color:"black"},df)],r.prototype,"arrowSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),he=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({},d)],r.prototype,"border",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Property(10)],r.prototype,"minRadius",void 0),i([n.Property(20)],r.prototype,"maxRadius",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property("Circle")],r.prototype,"bubbleType",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Collection([],hu)],r.prototype,"colorMapping",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),di=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"text",void 0),i([n.Property("")],r.prototype,"description",void 0),r}(n.ChildProperty),ce=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({size:null,fontWeight:null,fontFamily:null},ft)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),r}(di),le=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({size:null,fontWeight:null,fontFamily:null},ft)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Complex({},ce)],r.prototype,"subtitleSettings",void 0),r}(di),ae=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"enablePanning",void 0),i([n.Property(!0)],r.prototype,"enableSelectionZooming",void 0),i([n.Property("Horizontal")],r.prototype,"toolBarOrientation",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"highlightColor",void 0),i([n.Property(null)],r.prototype,"selectionColor",void 0),i([n.Property("Far")],r.prototype,"horizontalAlignment",void 0),i([n.Property("Near")],r.prototype,"verticalAlignment",void 0),i([n.Property(["ZoomIn","ZoomOut","Reset"])],r.prototype,"toolbars",void 0),i([n.Property(!0)],r.prototype,"mouseWheelZoom",void 0),i([n.Property(!1)],r.prototype,"doubleClickZoom",void 0),i([n.Property(!0)],r.prototype,"pinchZooming",void 0),i([n.Property(!1)],r.prototype,"zoomOnClick",void 0),i([n.Property(1)],r.prototype,"zoomFactor",void 0),i([n.Property(10)],r.prototype,"maxZoom",void 0),i([n.Property(1)],r.prototype,"minZoom",void 0),i([n.Property(!1)],r.prototype,"shouldZoomInitially",void 0),i([n.Property(!0)],r.prototype,"resetToInitial",void 0),i([n.Complex({},te)],r.prototype,"toolbarSettings",void 0),r}(n.ChildProperty),cu=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"applyShapeSettings",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:"",width:0},d)],r.prototype,"border",void 0),r}(n.ChildProperty),ve=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"useMarkerShape",void 0),i([n.Property(!1)],r.prototype,"toggleVisibility",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("transparent")],r.prototype,"background",void 0),i([n.Property("Layers")],r.prototype,"type",void 0),i([n.Property(!1)],r.prototype,"invertedPointer",void 0),i([n.Property("After")],r.prototype,"labelPosition",void 0),i([n.Property("None")],r.prototype,"labelDisplayMode",void 0),i([n.Property("Circle")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"height",void 0),i([n.Complex({fontFamily:null,fontWeight:null},ft)],r.prototype,"textStyle",void 0),i([n.Property(15)],r.prototype,"shapeWidth",void 0),i([n.Property(15)],r.prototype,"shapeHeight",void 0),i([n.Property(10)],r.prototype,"shapePadding",void 0),i([n.Complex({color:"#000000",width:0},d)],r.prototype,"border",void 0),i([n.Complex({color:"#000000",width:0},d)],r.prototype,"shapeBorder",void 0),i([n.Complex({},di)],r.prototype,"title",void 0),i([n.Complex({size:null,color:rt.legendTitleFont.color,fontStyle:rt.legendTitleFont.fontStyle,fontWeight:null,fontFamily:null},ft)],r.prototype,"titleStyle",void 0),i([n.Property("Bottom")],r.prototype,"position",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Property("None")],r.prototype,"orientation",void 0),i([n.Property({x:0,y:0})],r.prototype,"location",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Default")],r.prototype,"mode",void 0),i([n.Property(null)],r.prototype,"showLegendPath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property(!1)],r.prototype,"removeDuplicateLegend",void 0),i([n.Complex({},cu)],r.prototype,"toggleLegendSettings",void 0),r}(n.ChildProperty),ye=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Complex({width:0,color:"transparent"},d)],r.prototype,"border",void 0),i([n.Property("black")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(5)],r.prototype,"rx",void 0),i([n.Property(5)],r.prototype,"ry",void 0),i([n.Complex({fontWeight:null},ft)],r.prototype,"textStyle",void 0),i([n.Property("")],r.prototype,"labelPath",void 0),i([n.Property("None")],r.prototype,"smartLabelMode",void 0),i([n.Property("None")],r.prototype,"intersectionAction",void 0),i([n.Property("")],r.prototype,"template",void 0),r}(n.ChildProperty),pe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property([])],r.prototype,"palette",void 0),i([n.Property(5)],r.prototype,"circleRadius",void 0),i([n.Complex({width:null,color:"#000000"},d)],r.prototype,"border",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"borderColorValuePath",void 0),i([n.Property(null)],r.prototype,"borderWidthValuePath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Collection([],hu)],r.prototype,"colorMapping",void 0),i([n.Property(!1)],r.prototype,"autofill",void 0),r}(n.ChildProperty),lu=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return h(t,n),t}(function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({color:"transparent",width:1},d)],r.prototype,"border",void 0),i([n.Property(null)],r.prototype,"dashArray",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(!1)],r.prototype,"enableDrag",void 0),i([n.Property("#FF471A")],r.prototype,"fill",void 0),i([n.Property(10)],r.prototype,"height",void 0),i([n.Property(10)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"shapeValuePath",void 0),i([n.Property(null)],r.prototype,"imageUrlValuePath",void 0),i([n.Property("Balloon")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"legendText",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property(null)],r.prototype,"template",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),i([n.Property(null)],r.prototype,"latitudeValuePath",void 0),i([n.Property(null)],r.prototype,"longitudeValuePath",void 0),i([n.Collection([],ee)],r.prototype,"initialMarkerSelection",void 0),r}(n.ChildProperty)),we=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.isBaseLayer=!1,n}return h(r,t),i([n.Property(null)],r.prototype,"shapeData",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},pe)],r.prototype,"shapeSettings",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property("Layer")],r.prototype,"type",void 0),i([n.Property("Geographic")],r.prototype,"geometryType",void 0),i([n.Property("Aerial")],r.prototype,"bingMapType",void 0),i([n.Property("RoadMap")],r.prototype,"staticMapType",void 0),i([n.Property("")],r.prototype,"key",void 0),i([n.Property("Geometry")],r.prototype,"layerType",void 0),i([n.Property("")],r.prototype,"urlTemplate",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("name")],r.prototype,"shapeDataPath",void 0),i([n.Property("name")],r.prototype,"shapePropertyPath",void 0),i([n.Property(0)],r.prototype,"animationDuration",void 0),i([n.Collection([],lu)],r.prototype,"markerSettings",void 0),i([n.Complex({},fe)],r.prototype,"markerClusterSettings",void 0),i([n.Complex({},ye)],r.prototype,"dataLabelSettings",void 0),i([n.Collection([],he)],r.prototype,"bubbleSettings",void 0),i([n.Collection([],se)],r.prototype,"navigationLineSettings",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),i([n.Complex({},cu)],r.prototype,"toggleLegendSettings",void 0),i([n.Collection([],oe)],r.prototype,"initialShapeSelection",void 0),r}(n.ChildProperty),be=function(){return function(n,t,i,r,u,f,e){void 0===i&&(i=256);void 0===r&&(r=256);void 0===u&&(u=0);void 0===f&&(f=0);void 0===e&&(e=null);this.x=n;this.y=t;this.top=u;this.left=f;this.height=i;this.width=r;this.src=e}}(),ke=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"background",void 0),i([n.Complex({color:"transparent",width:1},d)],r.prototype,"border",void 0),r}(n.ChildProperty),au=function(){function t(n){this.maps=n;this.trackElements=[];this.sameMarkerData=[]}return t.prototype.markerRender=function(t,i,u,f,e){var h=this,l=0,a=0,v=0,s,c;t.translateType="marker";s=t.layersCollection[u];this.markerSVGObject=t.renderer.createGroup({id:t.element.id+"_Markers_Group","class":"GroupElement"});this.markerSVGObject.style.pointerEvents="auto";c=n.createElement("div",{id:t.element.id+"_LayerIndex_"+u+"_Markers_Template_Group",className:t.element.id+"_template"});c.style.cssText="overflow: hidden; position: absolute;pointer-events: none;top:"+t.mapAreaRect.y+"px;left:"+t.mapAreaRect.x+"px;height:"+t.mapAreaRect.height+"px;width:"+t.mapAreaRect.width+"px;";s.markerSettings.map(function(y,w){var b=y.dataSource;Array.prototype.forEach.call(b,function(d,g){t.markerNullCount=w>0&&0===g?0:t.markerNullCount;var nt={cancel:!1,name:wu,fill:y.fill,height:y.height,width:y.width,imageUrl:y.imageUrl,shape:y.shape,template:y.template,data:d,maps:t,marker:y,border:y.border,colorValuePath:y.colorValuePath,shapeValuePath:y.shapeValuePath,imageUrlValuePath:y.imageUrlValuePath};t.trigger("markerRendering",nt,function(){var et;nt=vi(nt=ai(nt,d),d);var rt=n.isNullOrUndefined(y.longitudeValuePath)?n.isNullOrUndefined(d.longitude)?n.isNullOrUndefined(d.Longitude)?null:parseFloat(d.Longitude):parseFloat(d.longitude):Number(o(d,y.longitudeValuePath)),ft=n.isNullOrUndefined(y.latitudeValuePath)?n.isNullOrUndefined(d.latitude)?n.isNullOrUndefined(d.Latitude)?null:parseFloat(d.Latitude):parseFloat(d.latitude):Number(o(d,y.latitudeValuePath)),ot=y.offset;if(!nt.cancel&&y.visible&&!n.isNullOrUndefined(rt)&&!n.isNullOrUndefined(ft)){var st=t.element.id+"_LayerIndex_"+u+"_MarkerIndex_"+w+"_dataIndex_"+g,tt=t.isTileMap?it(new k(rt,ft),f,t.tileTranslatePoint,!0):p(ft,rt,f,s,t),ht=0!==s.animationDuration||n.isNullOrUndefined(t.zoomModule),ct=t.isTileMap?"SubLayer"===s.type&&n.isNullOrUndefined(t.zoomModule)?tt=it(new k(rt,ft),t.tileZoomLevel,t.tileTranslatePoint,!0):{}:!n.isNullOrUndefined(t.zoomModule)&&t.zoomSettings.zoomFactor>1?yt(t,s,ht):ut(t,s,ht),lt="AddMarker"===e?t.scale:ct.scale,at="AddMarker"===e?t.translatePoint:ct.location;!nt.template||isNaN(tt.x)||isNaN(tt.y)?nt.template||isNaN(tt.x)||isNaN(tt.y)||(l++,hr(nt,y,b,g,tt,at,st,ot,lt,t,h.markerSVGObject)):(v++,cr(nt,void 0,st,d,w,c,tt,at,lt,ot,t),t.renderReactTemplates())}a+=isNaN(ft)||isNaN(rt)?1:0;v+=nt.cancel?1:0;l+=nt.cancel?1:0;t.markerNullCount=n.isNullOrUndefined(rt)||n.isNullOrUndefined(ft)?t.markerNullCount+1:t.markerNullCount;et=b.length-t.markerNullCount;h.markerSVGObject.childElementCount===et-v-a&&"Template"!==e&&(i.appendChild(h.markerSVGObject),s.markerClusterSettings.allowClustering&&(t.svgObject.appendChild(h.markerSVGObject),t.element.appendChild(t.svgObject),("OSM"===s.layerType||-1!==s.urlTemplate.indexOf("openstreetmap")&&n.isNullOrUndefined(s.shapeData))&&t.zoomSettings.enable?i.appendChild(h.markerSVGObject):dt(s,h.markerSVGObject,t,u,h.markerSVGObject,i,!0,!1),t.renderReactTemplates()));c.childElementCount===et-l-a&&r(t.element.id+"_Secondary_Element")&&(r(t.element.id+"_Secondary_Element").appendChild(c),t.checkInitialRender&&s.markerClusterSettings.allowClustering&&(dt(s,c,t,u,h.markerSVGObject,i,!1,!1),t.renderReactTemplates()))})})})},t.prototype.calculateIndividualLayerMarkerZoomLevel=function(n,t,i){var r,u,o=Math.abs(this.maps.baseMapBounds.latitude.max-this.maps.baseMapBounds.latitude.min),s=Math.abs(this.maps.baseMapBounds.longitude.max-this.maps.baseMapBounds.longitude.min),e,f;return r=(r=Math.floor(Math.log(t/o)))>i?i:r,u=(u=Math.floor(Math.log(n/s)))>i?i:u,e=Math.min(r,u),f=Math.min(e,i-1),this.maps.isTileMap||ou(f,this.maps),f},t.prototype.calculateZoomCenterPositionAndFactor=function(t){var o;if(!n.isNullOrUndefined(this.maps))if(this.maps.zoomSettings.shouldZoomInitially&&this.maps.markerModule){var r,u,f,e,i=void 0,s=void 0,h=void 0,a=this.maps.zoomSettings.maxZoom,c=this.maps.mapAreaRect.width,l=this.maps.mapAreaRect.height;(this.maps.markerZoomedState=this.maps.markerZoomedState?this.maps.markerZoomedState:n.isNullOrUndefined(this.maps.markerZoomFactor)?!this.maps.markerZoomedState:this.maps.markerZoomFactor>1?this.maps.markerZoomedState:!this.maps.markerZoomedState,this.maps.defaultState=this.maps.markerZoomedState?!this.maps.markerZoomedState:this.maps.defaultState,Array.prototype.forEach.call(t,function(t){0!==t.markerSettings.length&&Array.prototype.forEach.call(t.markerSettings,function(t){var i=t.dataSource;Array.prototype.forEach.call(i,function(t,i){var o=n.isNullOrUndefined(t.latitude)?n.isNullOrUndefined(t.Latitude)?null:parseFloat(t.Latitude):parseFloat(t.latitude),s=n.isNullOrUndefined(t.longitude)?n.isNullOrUndefined(t.Longitude)?null:parseFloat(t.Longitude):parseFloat(t.longitude);r=n.isNullOrUndefined(r)&&0===i?s:r;u=n.isNullOrUndefined(u)&&0===i?o:u;f=n.isNullOrUndefined(f)&&0===i?o:f;e=n.isNullOrUndefined(e)&&0===i?s:e;r>s&&(r=s);f>o&&(f=o);e<s&&(e=s);u<o&&(u=o)})})}),n.isNullOrUndefined(f)||n.isNullOrUndefined(r)||n.isNullOrUndefined(e)||n.isNullOrUndefined(u))||(s=(f+u)/2,h=(r+e)/2,this.maps.markerCenterLatitude=s,this.maps.markerCenterLongitude=h,(n.isNullOrUndefined(this.maps.markerZoomCenterPoint)||this.maps.markerZoomedState)&&(this.maps.markerZoomCenterPoint={latitude:s,longitude:h}),o=void 0,this.maps.isTileMap||0===this.maps.baseMapRectBounds.min.x?(i=su(f,u,r,e,c,l,this.maps,!1),this.maps.isTileMap?o=n.isNullOrUndefined(this.maps.markerZoomFactor)||n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue>1&&1!==this.maps.markerZoomFactor?this.maps.mapScaleValue:i:(o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:1!==Math.floor(this.maps.scale)&&this.maps.mapScaleValue!==i&&n.isNullOrUndefined(this.maps.shouldZoomCurrentFactor)?this.maps.mapScaleValue:i)!==this.maps.mapScaleValue||1!==this.maps.markerZoomFactor&&1!==this.maps.mapScaleValue||this.maps.enablePersistence||(o=i)):(i=this.calculateIndividualLayerMarkerZoomLevel(c,l,a),o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue!==i?this.maps.mapScaleValue:i),this.maps.markerZoomFactor=o)}else this.maps.markerZoomedState=!1,this.maps.markerZoomFactor>1&&(this.maps.markerCenterLatitude=null,this.maps.markerCenterLongitude=null,this.maps.markerZoomFactor=1,this.maps.enablePersistence||(this.maps.mapScaleValue=1)),this.maps.isTileMap&&!this.maps.enablePersistence&&this.maps.mapScaleValue<=1&&(this.maps.tileZoomLevel=0===this.maps.mapScaleValue?this.maps.isZoomByPosition?this.maps.tileZoomLevel:1:this.maps.mapScaleValue,1===this.maps.mapScaleValue&&1===this.maps.markerZoomFactor&&(this.maps.tileTranslatePoint.x=0,this.maps.tileTranslatePoint.y=0))},t.prototype.markerClick=function(t){var r=t.target.id,i,s,c;if(!(-1===r.indexOf("_LayerIndex_")||r.indexOf("_cluster_")>0)&&(i=this.getMarker(r),!n.isNullOrUndefined(i)&&(i.marker.enableDrag&&(document.getElementById(this.maps.element.id+"_svg").style.cursor="grabbing"),s={cancel:!1,name:bu,data:i.data,maps:this.maps,marker:i.marker,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,value:i.data.name},this.maps.trigger(bu,s),i.marker.enableDrag))){var h=!1,u=parseInt(r.split("_LayerIndex_")[1].split("_")[0],10),f=parseInt(r.split("_MarkerIndex_")[1].split("_")[0],10),e=parseInt(r.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[u].markerSettings[f];(this.sameMarkerData.length>0&&(h=this.sameMarkerData[0].data.filter(function(n){return n.index==e}).length>0&&this.sameMarkerData[0].layerIndex===u&&this.sameMarkerData[0].markerIndex===f),h)||(c={name:ku,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,layerIndex:u,markerIndex:f,dataIndex:e},this.maps.trigger(ku,c),this.maps.markerDragArgument={targetId:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,shape:n.isNullOrUndefined(o.shapeValuePath)?o.shape:o.dataSource[e][o.shapeValuePath],layerIndex:u,markerIndex:f,dataIndex:e})}},t.prototype.markerClusterClick=function(t){var r=t.target.id,i,u;-1!==r.indexOf("_LayerIndex_")&&-1!==r.indexOf("_cluster_")&&(i=this.getMarker(r),n.isNullOrUndefined(i)||(i.clusterCollection.length>0&&this.maps.markerClusterExpand&&(s(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&a(this.maps.element.id+"_mapsTooltip"),this.sameMarkerData.length>0&&!this.maps.markerClusterExpandCheck?(this.maps.markerClusterExpandCheck=!0,or(this.sameMarkerData,this.maps,this.markerSVGObject)):(this.sameMarkerData=i.clusterCollection,this.maps.markerClusterExpandCheck=!1,sr(this.sameMarkerData,this.maps,this.markerSVGObject,!0))),u={cancel:!1,name:du,data:i,maps:this.maps,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,markerClusterCollection:i.markCollection},this.maps.trigger(du,u)))},t.prototype.getMarker=function(n){var i,t,s=n.split("_LayerIndex_"),h=parseInt(s[1].split("_")[0],10),r=this.maps.layers[h],v=[],y=[],f,c,u,l,p,e,a,o;if((this.maps.markerClusterExpand=r.markerClusterSettings.allowClusterExpand,n.indexOf("_MarkerIndex_")>-1)&&(f=parseInt(s[1].split("_MarkerIndex_")[1].split("_")[0],10),c=parseInt(s[1].split("_dataIndex_")[1].split("_")[0],10),t=r.markerSettings[f],!isNaN(f))){if(i=t.dataSource[c],u=[],!t.template&&n.indexOf("_cluster_")>-1&&this.maps.layers[h].markerClusterSettings.allowClusterExpand&&Array.prototype.forEach.call(t.dataSource,function(n,t){n.latitude===i.latitude&&n.longitude===i.longitude&&u.push({data:i,index:t})}),n.indexOf("_cluster_")>-1){for(l=document.getElementById(n.indexOf("_datalabel_")>-1?"Balloon"===r.markerClusterSettings.shape?n.split("_datalabel_")[0]+"_Group":n.split("_datalabel_")[0]:"Balloon"===r.markerClusterSettings.shape?n+"_Group":n),p="Balloon"===r.markerClusterSettings.shape?l.children[0].textContent.split(",").map(Number):l.textContent.split(",").map(Number),u=[],e=0,a=p;e<a.length;e++)o=a[e],u.push({data:t.dataSource[o],index:o}),v.push(t.dataSource[o]);y.push({data:u,layerIndex:h,markerIndex:f,dataIndex:c,targetClusterIndex:+(n.split("_cluster_")[1].indexOf("_datalabel_")>-1?n.split("_cluster_")[1].split("_datalabel_")[0]:n.split("_cluster_")[1]),isClusterSame:!1})}return{marker:t,data:i,clusterCollection:y,markCollection:v}}return null},t.prototype.markerMove=function(t){var i=t.target.id,r,u;-1===i.indexOf("_LayerIndex_")||i.indexOf("_cluster_")>0||(r=this.getMarker(i),n.isNullOrUndefined(r)||(r.marker.enableDrag&&(document.getElementById(this.maps.element.id+"_svg").style.cursor=n.isNullOrUndefined(this.maps.markerDragArgument)?"pointer":"grabbing"),u={cancel:!1,name:gu,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(gu,u)))},t.prototype.markerClusterMouseMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&-1!==i.indexOf("_cluster_")&&(r=this.getMarker(i),(this.maps.markerClusterExpand&&(t.target.style.cursor="pointer"),n.isNullOrUndefined(r))||(u={cancel:!1,name:nf,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(nf,u)))},t.prototype.getModuleName=function(){return"Marker"},t.prototype.destroy=function(){this.maps=null;this.trackElements=[];this.markerSVGObject=null;this.sameMarkerData=[]},t}(),et="click",vu="resize",yu="tooltipRender",pu="shapeHighlight",wu="markerRendering",de="markerClusterRendering",bu="markerClick",ku="markerDragStart",du="markerClusterClick",gu="markerMouseMove",nf="markerClusterMouseMove",tf="bubbleRendering",rf="bubbleClick",uf="bubbleMouseMove",ff="animationComplete",ef="annotationRendering",of="itemSelection",sf="itemHighlight",fi="pan",gi=function(){function t(n){this.maps=n}return t.prototype.getBingMap=function(t,i,r,u,f,e){for(var h,c,l,o="",s=Math.min(this.maps.tileZoomLevel,parseInt(this.maxZoom,10));s>0;s--)h=0,c=1<<s-1,t.x&c&&h++,t.y&c&&(h+=2),o=o+""+h;return n.isNullOrUndefined(e)?"":(l=e[Math.min(parseInt(o.substr(o.length-1,1),10),e.length)],(f=f.replace("{quadkey}",o).replace("{subdomain}",l))+"&mkt="+u+"&ur=IN&Key="+i)},t.prototype.destroy=function(){this.maps=null;this.subDomains=[]},t}(),hf=function(){function t(n){this.maps=n}return t.prototype.getShapeColorMapping=function(t,i,r){var u=t.colorValuePath?t.colorValuePath:t.valuePath,f=n.isNullOrUndefined(u)?i[u]:u.indexOf(".")>-1?o(i,u):i[u],s=Number(f),e=this.getColorByValue(t.colorMapping,s,f);return n.isNullOrUndefined(e)?r:e},t.prototype.getColorByValue=function(t,i,r){var u;if(isNaN(i)&&n.isNullOrUndefined(r))return null;for(var o,f="",e=0,s=t;e<s.length;e++)u=s[e],(!n.isNullOrUndefined(u.from)&&!n.isNullOrUndefined(u.to)&&i>=u.from&&i<=u.to||u.value===r)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?n.isNullOrUndefined(u.value)?this.getColor(u,i):u.color[0]:u.color),(i>=u.from&&i<=u.to||u.value===r)&&!n.isNullOrUndefined(u.minOpacity)&&!n.isNullOrUndefined(u.maxOpacity)&&f&&(o=this.deSaturationColor(u,f,i,r)),(""===f||n.isNullOrUndefined(f))&&n.isNullOrUndefined(u.from)&&n.isNullOrUndefined(u.to)&&n.isNullOrUndefined(u.minOpacity)&&n.isNullOrUndefined(u.maxOpacity)&&n.isNullOrUndefined(u.value)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?u.color[0]:u.color);return{fill:f||(t.length?null:r),opacity:o}},t.prototype.deSaturationColor=function(n,t,i,r){var u=1;return(i>=n.from&&i<=n.to||n.value===r)&&(u=(isNaN(i)?n.from/(n.to-n.from):(i-n.from)/(n.to-n.from))*(n.maxOpacity-n.minOpacity)+n.minOpacity),u},t.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},t.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},t.prototype.getColor=function(n,t){var i,r="";return Number(t)===n.from?r=n.color[0]:Number(t)===n.to?r=n.color[n.color.length-1]:(i=this.getGradientColor(Number(t),n),r=this.rgbToHex(i.r,i.g,i.b)),r},t.prototype.getGradientColor=function(n,t){var f,e,s=t.from,c=t.to,o=0,l=c-s,i;if(o=(n-s)/l,t.color.length<=2)f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]),e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);else{f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]);e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);for(var u=l/(t.color.length-1),v=t.color.length-1,r=[],a={},h=1;h<v;h++)a={b:s+h*u,color:t.color[h]},r.push(a);for(i=0;i<r.length;i++)s<=n&&n<=r[i].b&&0===i?(e="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u):r[i].b<=n&&n<=c&&i===r.length-1&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u),i!==r.length-1&&i<r.length&&r[i].b<=n&&n<=r[i+1].b&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),e="#"===r[i+1].color.charAt(0)?r[i+1].color:this._colorNameToHex(r[i+1].color),o=Math.abs(n-r[i+1].b)/u)}return this.getPercentageColor(o,f,e)},t.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new vf(f,e,o)},t.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},t.prototype._colorNameToHex=function(n){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",orchid:"#da70d6",papayawhip:"#ffefd5",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"[object Array]"===Object.prototype.toString.call(n)?n:void 0!==t[n.toLowerCase()]?t[n.toLowerCase()]:n},t}(),ge=function(){function t(t){this.isMapCoordinates=!0;this.horizontalPan=!1;this.horizontalPanXCount=0;this.mapObject=t;this.ajaxModule=new n.Fetch;this.ajaxResponse=[]}return t.prototype.measureLayerPanel=function(){var u=this,e=this.mapObject.layersCollection,t=this.mapObject.mapAreaRect,f=r(this.mapObject.element.id+"_Secondary_Element"),i;this.mapObject.isTileMap&&f&&(this.tileSvgObject=this.mapObject.renderer.createSvg({id:this.mapObject.element.id+"_Tile_SVG",width:t.width,height:t.height}),i=n.createElement("div",{id:this.mapObject.element.id+"_Tile_SVG_Parent"}),i.style.cssText="position: absolute; height: "+t.height+"px; width: "+t.width+"px;",i.appendChild(this.tileSvgObject),f.appendChild(i));this.layerGroup=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_Layer_Collections","clip-path":"url(#"+this.mapObject.element.id+"_MapArea_ClipRect)"});this.clipRectElement="GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?this.mapObject.renderer.drawClipPath(new b(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:(t.width-640)/2,y:0,width:640,height:t.height})):this.mapObject.renderer.drawClipPath(new b(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:this.mapObject.isTileMap?0:t.x,y:this.mapObject.isTileMap?0:t.y,width:t.width,height:t.height}));this.layerGroup.appendChild(this.clipRectElement);this.mapObject.baseMapBounds=null;this.mapObject.baseMapRectBounds=null;this.mapObject.baseSize=null;Array.prototype.forEach.call(e,function(n,t){u.currentLayer=n;u.processLayers(n,t)});n.isNullOrUndefined(this.mapObject.legendModule)||"Float"!==this.mapObject.legendSettings.position||(this.mapObject.isTileMap?this.layerGroup.appendChild(this.mapObject.legendModule.legendGroup):this.mapObject.svgObject.appendChild(this.mapObject.legendModule.legendGroup))},t.prototype.renderTileLayer=function(t,i,r,u){var s,o,e,l,a,h,c;t.currentFactor=t.calculateFactor(i);t.mapObject.defaultState=!(1!==t.mapObject.zoomSettings.zoomFactor&&!n.isNullOrUndefined(t.mapObject.tileZoomLevel)&&1!==t.mapObject.tileZoomLevel);n.isNullOrUndefined(t.mapObject.previousCenterLatitude)&&n.isNullOrUndefined(t.mapObject.previousCenterLongitude)&&!t.mapObject.isZoomByPosition?(t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.previousCenterLatitude!==t.mapObject.centerPosition.latitude&&t.mapObject.previousCenterLongitude!==t.mapObject.centerPosition.longitude||t.mapObject.isZoomByPosition?(t.mapObject.centerPositionChanged=!0,t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.centerPositionChanged=!1;s=new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude);o=s;this.mapObject.isTileMap&&t.mapObject.markerModule&&t.mapObject.zoomSettings.enable&&(t.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection),n.isNullOrUndefined(this.mapObject.markerCenterLatitude)||n.isNullOrUndefined(this.mapObject.markerCenterLongitude)||t.mapObject.isZoomByPosition||(o=new f(t.mapObject.markerCenterLongitude,t.mapObject.markerCenterLatitude)));s=!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.centerPosition.longitude&&t.mapObject.centerPosition.latitude&&!t.mapObject.zoomPersistence&&t.mapObject.defaultState?new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude):t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.markerZoomedState&&!t.mapObject.zoomPersistence&&!n.isNullOrUndefined(t.mapObject.markerZoomCenterPoint)?new f(t.mapObject.markerZoomCenterPoint.longitude,t.mapObject.markerZoomCenterPoint.latitude):{x:null,y:null};e=t.mapObject.zoomSettings.shouldZoomInitially&&!t.mapObject.isZoomByPosition?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?1:t.mapObject.markerZoomFactor:t.mapObject.zoomSettings.zoomFactor;(e=t.mapObject.enablePersistence?n.isNullOrUndefined(t.mapObject.mapScaleValue)?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?t.mapObject.zoomSettings.zoomFactor:t.mapObject.markerZoomFactor:t.mapObject.mapScaleValue:e,e=(e=t.mapObject.zoomSettings.enable?e:t.mapObject.zoomSettings.zoomFactor)>0?e:1,t.mapObject.defaultState=1===e,!t.mapObject.markerZoomedState&&t.mapObject.zoomSettings.shouldZoomInitially&&1===t.mapObject.zoomSettings.zoomFactor&&(t.mapObject.defaultState=!0),n.isNullOrUndefined(t.mapObject.tileZoomLevel))?(t.mapObject.tileZoomLevel=e,t.mapObject.previousZoomFactor=e):this.mapObject.isReset&&1===t.mapObject.tileZoomLevel&&!t.mapObject.zoomSettings.shouldZoomInitially?(l=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=l):1!==t.mapObject.zoomSettings.zoomFactor||t.mapObject.zoomSettings.shouldZoomInitially?(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=t.mapObject.defaultState&&t.mapObject.zoomSettings.enable?t.mapObject.tileZoomLevel:t.mapObject.zoomSettings.shouldZoomInitially||t.mapObject.centerPositionChanged?e:t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor?t.mapObject.zoomSettings.zoomFactor:t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=1===e&&0===t.mapObject.zoomSettings.zoomFactor?e:t.mapObject.tileZoomLevel,!n.isNullOrUndefined(t.mapObject.tileTranslatePoint)&&(t.mapObject.markerZoomFactor!==t.mapObject.mapScaleValue||n.isNullOrUndefined(t.mapObject.markerZoomFactor)&&n.isNullOrUndefined(t.mapObject.mapScaleValue))&&(t.mapObject.zoomSettings.zoomFactor<=1||t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor)&&(t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0)):t.mapObject.defaultState&&(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=e,t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0);(e<=1&&!n.isNullOrUndefined(t.mapObject.height)&&!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.tileZoomLevel===t.mapObject.tileZoomScale&&this.mapObject.initialCheck&&function(n){n.tileZoomScale=n.tileZoomLevel=Math.floor(n.availableSize.height/512)+1;var i="GoogleStaticMap"!==n.layers[n.baseLayerIndex].layerType?20:0,t=256*Math.pow(2,n.tileZoomLevel);n.tileTranslatePoint.x=n.availableSize.width/2-t/2;n.tileTranslatePoint.y=n.availableSize.height/2-t/2+i;n.previousTileWidth=n.availableSize.width;n.previousTileHeight=n.availableSize.height}(this.mapObject),n.isNullOrUndefined(t.mapObject.centerLatOfGivenLocation)||n.isNullOrUndefined(t.mapObject.centerLongOfGivenLocation)||!t.mapObject.zoomNotApplied||(o.y=t.mapObject.centerLatOfGivenLocation,o.x=t.mapObject.centerLongOfGivenLocation,t.mapObject.tileZoomLevel=t.mapObject.mapScaleValue=t.mapObject.scaleOfGivenLocation),t.mapObject.tileTranslatePoint=t.panTileMap(t.mapObject.availableSize.width,t.mapObject.availableSize.height,o),this.mapObject.zoomSettings.resetToInitial&&this.mapObject.initialCheck&&!n.isNullOrUndefined(t.mapObject.height)&&this.mapObject.availableSize.height>512)&&(this.mapObject.applyZoomReset=!0,this.mapObject.initialZoomLevel=Math.floor(this.mapObject.availableSize.height/512),a="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?20:0,h=256*Math.pow(2,this.mapObject.initialZoomLevel),this.mapObject.initialTileTranslate.x=this.mapObject.availableSize.width/2-h/2,this.mapObject.initialTileTranslate.y=this.mapObject.availableSize.height/2-h/2+a);(t.generateTiles(t.mapObject.tileZoomLevel,t.mapObject.tileTranslatePoint,null,u),n.isNullOrUndefined(t.mapObject.previousZoomFactor)||t.mapObject.previousZoomFactor===t.mapObject.zoomSettings.zoomFactor||(t.mapObject.previousZoomFactor=t.mapObject.zoomSettings.zoomFactor),t.mapObject.navigationLineModule)&&(c=t.mapObject.navigationLineModule.renderNavigation(t.currentLayer,t.mapObject.tileZoomLevel,r),n.isNullOrUndefined(c)||t.layerObject.appendChild(c));t.mapObject.markerModule&&t.mapObject.markerModule.markerRender(this.mapObject,t.layerObject,r,t.mapObject.tileZoomLevel,null);t.translateLayerElements(t.layerObject,r);t.layerGroup.appendChild(t.layerObject)},t.prototype.processLayers=function(t,i){var r=this,e,u,f;if((this.layerObject=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+i}),!this.mapObject.enablePersistence)&&(e=this.mapObject.getModuleName()+this.mapObject.element.id,-1===navigator.userAgent.indexOf("Edge"))){u=void 0;try{u=window.localStorage}catch(t){u=null}!n.isNullOrUndefined(u)&&window.localStorage.getItem(e)&&window.localStorage.removeItem(e)}f={cancel:!1,name:"layerRendering",index:i,layer:t,maps:this.mapObject,visible:t.visible};this.mapObject.trigger("layerRendering",f,function(){var h,o,e;if(!f.cancel&&f.visible)if("OSM"===t.layerType&&(t.urlTemplate="https://a.tile.openstreetmap.org/level/tileX/tileY.png"),"Google"===t.layerType&&(t.urlTemplate="https://mt1.google.com/vt/lyrs=m@129&hl=en&x=tileX&y=tileY&z=level"),"Geometry"!==t.layerType||n.isNullOrUndefined(t.shapeData)&&!n.isNullOrUndefined(t.urlTemplate)&&""!==t.urlTemplate){if("Bing"!==t.layerType||r.bing)!n.isNullOrUndefined(t.urlTemplate)&&t.urlTemplate.indexOf("quadkey")>-1?(h=new gi(r.mapObject),r.bingMapCalculation(t,i,r,h)):r.renderTileLayer(r,t,i);else if(t.key&&t.key.length>1){var s=r,u=new gi(r.mapObject),l="https://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+("AerialWithLabel"===t.bingMapType?"AerialWithLabelsOnDemand":t.bingMapType),c=new n.Fetch({url:l+"?output=json&include=ImageryProviders&urischeme=https&key="+t.key});c.onSuccess=function(n){var f=n.resourceSets[0].resources[0],e=f.imageUrl,o=f.imageUrlSubdomains,h=f.zoomMax;null!=e&&e!==u.imageUrl&&(u.imageUrl=e);null!=o&&o!==u.subDomains&&(u.subDomains=o);null!=h&&h!==u.maxZoom&&(u.maxZoom=h);s.mapObject.bingMap=u;s.renderTileLayer(s,t,i,u);r.mapObject.arrangeTemplate();r.mapObject.zoomModule&&r.mapObject.previousScale!==r.mapObject.scale&&r.mapObject.zoomModule.applyTransform(r.mapObject,!0)};c.send()}}else n.isNullOrUndefined(t.shapeData)||n.isNullOrUndefined(t.shapeData.geometries)&&n.isNullOrUndefined(t.shapeData.features)||(o=!n.isNullOrUndefined(t.shapeData.geometries)&&t.shapeData.geometries.length>0?t.shapeData.geometries:t.shapeData.features,t.layerData=[],e=t.shapeData.bbox,!n.isNullOrUndefined(e)&&t.isBaseLayer?r.mapObject.baseMapBounds=new li({min:e[0][1],max:e[1][1]},{min:e[0][0],max:e[1][0]}):n.isNullOrUndefined(r.mapObject.baseMapBounds)&&!ar(o)&&r.calculateRectBounds(o),r.calculatePathCollection(i,o))});this.mapObject.isTileMap?this.tileSvgObject&&(this.tileSvgObject.appendChild(this.layerGroup),this.mapObject.baseMapBounds=null):this.mapObject.svgObject.appendChild(this.layerGroup)},t.prototype.bingMapCalculation=function(n,t,i,r){r.imageUrl=n.urlTemplate;r.subDomains=["t0","t1","t2","t3"];r.maxZoom="21";i.mapObject.bingMap=r;i.renderTileLayer(i,n,t,r);this.mapObject.arrangeTemplate();this.mapObject.zoomModule&&this.mapObject.previousScale!==this.mapObject.scale&&this.mapObject.zoomModule.applyTransform(this.mapObject,!0)},t.prototype.bubbleCalculation=function(t,i){var f,r,u;if(null!=t.dataSource&&null!=t)for(f=t.dataSource,r=0;r<f.length;r++)u=n.isNullOrUndefined(t.valuePath)?parseFloat(t.dataSource[r][t.valuePath]):t.valuePath.indexOf(".")>-1?Number(o(t.dataSource[r],t.valuePath)):parseFloat(t.dataSource[r][t.valuePath]),0!==r?u>i.max?i.max=u:u<i.min&&(i.min=u):i.max=i.min=u},t.prototype.calculatePathCollection=function(t,i){var u=this,r,e,s;if(this.groupElements=[],ar(i)||(this.currentFactor=this.calculateFactor(this.currentLayer)),this.rectBounds=null,r=this.currentLayer.shapeSettings,this.currentLayer.bubbleSettings,Array.prototype.forEach.call(i,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var i=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,r=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates,f=t.geometry,e=t.properties;u.generatePoints(i,r,f,e)}}),this.currentLayer.rectBounds=this.rectBounds,n.isNullOrUndefined(this.mapObject.baseMapRectBounds)&&this.currentLayer.isBaseLayer&&(this.mapObject.baseMapRectBounds=this.rectBounds),e=r.palette.length>1?r.palette:function(n){var t;switch(n.toLowerCase()){case"tailwind":t=["#0369A1","#14B8A6","#15803D","#334155","#5A61F6","#65A30D","#8B5CF6","#9333EA","#F59E0B","#F97316"];break;case"tailwinddark":t=["#10B981","#22D3EE","#2DD4BF","#4ADE80","#8B5CF6","#E879F9","#F472B6","#F87171","#F97316","#FCD34D"];break;case"bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"bootstrap5dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;case"fluent":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;case"fluentdark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;case"material3":t=["#6200EE","#E77A16","#82C100","#7107DC","#05BB3D","#D21020","#FAD200","#0085FF","#9204EA","#08EE9B"];break;case"material3dark":t=["#4EAAFF","#FA4EAB","#FFF500","#17EA58","#38FFE7","#FF9E45","#B3F32F","#B93CE4","#FC5664","#9B55FF"];break;default:t=["#B5E485","#7BC1E8","#DF819C","#EC9B79","#78D0D3","#D6D572","#9178E3","#A1E5B4","#87A4B4","#E4C16C"]}return t}(this.mapObject.theme),s=n.createElement("div",{id:this.mapObject.element.id+"_LayerIndex_"+t+"_Label_Template_Group",className:this.mapObject.element.id+"_template"}),s.style.cssText="pointer-events: none; overflow: hidden; position: absolute;top:"+this.mapObject.mapAreaRect.y+"px;left:"+this.mapObject.mapAreaRect.x+"px;height:"+this.mapObject.mapAreaRect.height+"px;width:"+this.mapObject.mapAreaRect.width+"px;",0!==this.currentLayer.layerData.length)for(var c=function(h){var p,nt,w,a=void 0,g={color:r.border.color,width:r.border.width,opacity:r.border.opacity},c=f.currentLayer.layerData[h],l="",v=r.autofill?e[h%e.length]:r.fill||f.mapObject.themeStyle.shapeFill,b,k;null===r.colorValuePath||n.isNullOrUndefined(c.property)||(null!==(a=ht(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&0===r.colorMapping.length?v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?o(f.currentLayer.dataSource[a],r.colorValuePath):f.currentLayer.dataSource[a][r.colorValuePath]:c.property[r.colorValuePath]&&0===f.currentLayer.dataSource.length&&0===r.colorMapping.length&&(v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?o(c.property,r.colorValuePath):c.property[r.colorValuePath]),v=n.isNullOrUndefined(v)?r.fill||f.mapObject.themeStyle.shapeFill:v);b=f.mapObject.element.id+"_LayerIndex_"+t+"_shapeIndex_"+h+"_dataIndex_"+a;k=f.getShapeColorMapping(f.currentLayer,c.property,v);v="[object Object]"!==Object.prototype.toString.call(k)||n.isNullOrUndefined(k.fill)?v:k.fill;(f.currentLayer.shapeSettings.borderColorValuePath||f.currentLayer.shapeSettings.borderWidthValuePath)&&null!==(a=ht(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&(f.currentLayer.dataSource[a][r.borderColorValuePath]&&(g.color=f.currentLayer.dataSource[a][r.borderColorValuePath]),f.currentLayer.dataSource[a][r.borderWidthValuePath]&&(g.width=f.currentLayer.dataSource[a][r.borderWidthValuePath]));var d="[object Object]"!==Object.prototype.toString.call(k)||n.isNullOrUndefined(k.opacity)?r.opacity:k.opacity,it={cancel:!1,name:"shapeRendering",index:h,data:f.currentLayer.dataSource?f.currentLayer.dataSource[a]:null,maps:f.mapObject,shape:r,fill:v,border:{width:g.width,color:g.color,opacity:g.opacity}},tt=function(f){var a,o=n.isNullOrUndefined(c._isMultiPolygon)?n.isNullOrUndefined(c.type)?c[0].type:c.type:"MultiPolygon",k,g,tt,it;if(o="Polygon"===o||"MultiPolygon"===o?"Polygon":o,f.cancel?(f.fill=v,f.border.color=r.border.color,f.border.width=r.border.width,u.mapObject.layers[t].shapeSettings.border=r.border):(f.fill="#A6A6A6"===f.fill?f.shape.fill||u.mapObject.themeStyle.shapeFill:f.fill,f.border.color="#000000"===f.border.color?f.shape.border.color:f.border.color,f.border.width=0===f.border.width?f.shape.border.width:f.border.width,n.isNullOrUndefined(r.borderColorValuePath)&&(u.mapObject.layers[t].shapeSettings.border.color=f.border.color),n.isNullOrUndefined(r.borderWidthValuePath)&&(u.mapObject.layers[t].shapeSettings.border.width=f.border.width)),f.border.opacity=n.isNullOrUndefined(f.border.opacity)?d:f.border.opacity,u.groupElements.length<1)w=u.mapObject.renderer.createGroup({id:u.mapObject.element.id+"_LayerIndex_"+t+"_"+o+"_Group",transform:""}),u.groupElements.push(w);else for(k=0;k<u.groupElements.length;k++){if(g=u.groupElements[k],g.id.indexOf(o)>-1){w=g;break}if(k>=u.groupElements.length-1){w=u.mapObject.renderer.createGroup({id:u.mapObject.element.id+"_LayerIndex_"+t+"_"+o+"_Group"});u.groupElements.push(w);break}}switch(o){case"Polygon":c._isMultiPolygon?l=u.generateMultiPolygonPath(c):(l+="M"+c[0].point.x+" "+c[0].point.y,c.map(function(n){l+=" L "+n.point.x+" "+n.point.y}));(l+=" z ").length>3&&(p=new y(b,f.fill,f.border.width,f.border.color,d,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"LineString":c.map(function(n,t){l+=0===t?"M "+n.point.x+" "+n.point.y:"L"+n.point.x+" , "+n.point.y+" "});l.length>3&&(p=new y(b,"transparent",n.isNullOrUndefined(f.border.width)?1:f.border.width,n.isNullOrUndefined(f.fill)?f.border.color:f.fill,d,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"MultiLineString":c.map(function(n){n.map(function(n,t){l+=0===t?"M "+n.point.x+" "+n.point.y:"L"+n.point.x+" , "+n.point.y+" "})});l.length>3&&(p=new y(b,"transparent",n.isNullOrUndefined(f.border.width)?1:f.border.width,n.isNullOrUndefined(f.fill)?f.border.color:f.fill,d,f.border.opacity,r.dashArray,l),a=u.mapObject.renderer.drawPath(p));break;case"Point":tt=c.point;it="SubLayer"!==u.mapObject.layers[t].type?r.circleRadius:r.circleRadius/(u.mapObject.isTileMap?u.mapObject.scale:u.currentFactor);nt=new at(b,f.fill,f.border,d,tt.x,tt.y,it,r.dashArray);a=u.mapObject.renderer.drawCircle(nt);break;case"MultiPoint":c.map(function(n,i){var e=n.point,s="SubLayer"!==u.mapObject.layers[t].type?r.circleRadius:r.circleRadius/(u.mapObject.isTileMap?u.mapObject.scale:u.currentFactor);nt=new at(b+"_multiLine_"+i,f.fill,f.border,d,e.x,e.y,s,r.dashArray);a=u.mapObject.renderer.drawCircle(nt);u.pathAttributeCalculate(w,a,o,c,h)});break;case"Path":l=c.point;p=new y(b,f.fill,f.border.width,f.border.color,d,f.border.opacity,r.dashArray,l);a=u.mapObject.renderer.drawPath(p)}n.isNullOrUndefined(a)||"MultiPoint"===o||u.pathAttributeCalculate(w,a,o,c,h);h===u.currentLayer.layerData.length-1&&u.layerFeatures(t,e,i,s)};tt.bind(f);f.mapObject.trigger("shapeRendering",it,tt)},f=this,h=0;h<this.currentLayer.layerData.length;h++)c(h);else this.layerFeatures(t,e,i,s)},t.prototype.pathAttributeCalculate=function(t,i,r,u,f){for(var h,e,s="[object Array]"===Object.prototype.toString.call(this.currentLayer.shapePropertyPath)?this.currentLayer.shapePropertyPath:[this.currentLayer.shapePropertyPath],o=0;o<s.length;o++)if(!n.isNullOrUndefined(u.property)){h=s[o];break}if(i.setAttribute("aria-label",n.isNullOrUndefined(u.property)?"":u.property[h]),i.tabIndex=this.mapObject.tabIndex+f+3,i.setAttribute("role",""),"LineString"!==r&&"MultiLineString"!==r||(i.style.cssText="outline:none"),gt(this.mapObject.selectedElementId,this.mapObject.shapeSelectionClass,i,"ShapeselectionMapStyle"),this.mapObject.toggledShapeElementId)for(o=0;o<this.mapObject.toggledShapeElementId.length;o++)e=this.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings?this.currentLayer.shapeSettings:this.mapObject.legendSettings.toggleLegendSettings,this.mapObject.toggledShapeElementId[o]===i.id&&(i.setAttribute("fill",e.fill),i.setAttribute("stroke",e.border.color),i.setAttribute("fill-opacity",e.opacity.toString()),i.setAttribute("stroke-opacity",(n.isNullOrUndefined(e.border.opacity)?e.opacity:e.border.opacity).toString()),i.setAttribute("stroke-width",(n.isNullOrUndefined(e.border.width)?0:e.border.width).toString()));t.appendChild(i)},t.prototype.layerFeatures=function(n,t,i,r){var s,f=this,o,c;if(this.currentLayer.bubbleSettings.length&&this.mapObject.bubbleModule)for(var e,l=this.currentLayer.bubbleSettings.length,a=function(i){var r,o;e=u.currentLayer.bubbleSettings[i];s=u.mapObject.renderer.createGroup({id:u.mapObject.element.id+"_LayerIndex_"+n+"_bubble_Group_"+i});r={min:0,max:0};u.bubbleCalculation(e,r);o=e.dataSource;u.mapObject.bubbleModule.bubbleCollection=[];o.map(function(u,o){f.renderBubble(f.currentLayer,u,t[o%t.length],r,i,o,s,n,e)});u.groupElements.push(s)},u=this,h=0;h<l;h++)a(h);this.mapObject.markerModule&&!this.mapObject.isTileMap&&this.mapObject.zoomSettings.enable&&this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);o=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+n+"_dataLableIndex_Group"});(o.style.pointerEvents="none",this.mapObject.dataLabelModule&&this.currentLayer.dataLabelSettings.visible)&&(c=[],i.map(function(t,i){f.renderLabel(f.currentLayer,n,t,o,i,r,c)}),this.groupElements.push(o));this.mapObject.navigationLineModule&&this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer,this.currentFactor,n));this.groupElements.map(function(n){f.layerObject.appendChild(n)});this.mapObject.markerModule&&this.mapObject.markerModule.markerRender(this.mapObject,this.layerObject,n,this.mapObject.isTileMap?Math.floor(this.currentFactor):this.currentFactor,null);this.translateLayerElements(this.layerObject,n);this.layerGroup.appendChild(this.layerObject)},t.prototype.renderLabel=function(n,t,i,r,u,f,e){this.mapObject.dataLabelModule.renderLabel(n,t,i,n.layerData,r,f,u,e)},t.prototype.generateMultiPolygonPath=function(n){for(var i="",t=0;t<n.length;t++)i+="M"+n[t][0].point.x+" "+n[t][0].point.y,n[t].map(function(n){i+=" L "+n.point.x+" "+n.point.y});return i},t.prototype.renderBubble=function(t,i,r,u,f,e,o,s,h){if(n.isNullOrUndefined(this.mapObject.bubbleModule)||!h.visible)return null;r=h.fill?h.fill:r;this.mapObject.bubbleModule.id=this.mapObject.element.id+"_LayerIndex_"+s+"_BubbleIndex_"+f+"_dataIndex_"+e;this.mapObject.bubbleModule.renderBubble(h,i,r,u,f,e,s,t,o,this.mapObject.bubbleModule.id)},t.prototype.getShapeColorMapping=function(t,i,r){if(r=r||t.shapeSettings.fill,0===t.shapeSettings.colorMapping.length&&n.isNullOrUndefined(t.dataSource))return r;var u=ht(t.dataSource,i,t.shapeDataPath,t.shapePropertyPath),f=new hf(this.mapObject);return n.isNullOrUndefined(t.dataSource[u])?r:f.getShapeColorMapping(t.shapeSettings,t.dataSource[u],r)},t.prototype.generatePoints=function(t,i,r,u){var e,o,s=this,f=[],h,c,a,y,w,l,b,v,k;switch(t.toLowerCase()){case"polygon":(f=this.calculatePolygonBox(i[0],r,u)).length>0&&(f.property=u,f.type=t,f._isMultiPolygon=!1,this.currentLayer.layerData.push(f));break;case"multipolygon":for(h=[],c=0;c<i.length;c++)for(a=0;a<i[c].length;a++)(f=this.calculatePolygonBox(i[c][a],r,u)).length>0&&h.push(f);h.property=u;h.type=t;h._isMultiPolygon=!0;this.currentLayer.layerData.push(h);break;case"linestring":y=n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width;i.map(function(n){e=n[1];o=n[0];var t=p(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,y);f.push({point:t,lat:e,lng:o})});f.property=u;f.type=t;this.currentLayer.layerData.push(f);break;case"multilinestring":w=n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width;l=[];i.map(function(n){f=[];n.map(function(n){e=n[1];o=n[0];var t=p(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,w);f.push({point:t,lat:e,lng:o})});l.push(f)});l.property=u;l.type=t;this.currentLayer.layerData.push(l);break;case"point":b=(n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width)+2*this.currentLayer.shapeSettings.circleRadius;e=i[1];o=i[0];v=p(e,o,this.currentFactor,this.currentLayer,this.mapObject);this.calculateBox(v,b);this.currentLayer.layerData.push({point:v,type:t,lat:e,lng:o,property:u});break;case"multipoint":k=(n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:"string"==typeof this.currentLayer.shapeSettings.border.width?parseInt(this.currentLayer.shapeSettings.border.width,10):this.currentLayer.shapeSettings.border.width)+2*this.currentLayer.shapeSettings.circleRadius;f=[];i.map(function(n){e=n[1];o=n[0];var t=p(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,k);f.push({point:t,lat:e,lng:o})});f.property=u;f.type=t;this.currentLayer.layerData.push(f);break;case"path":this.currentLayer.layerData.push({point:r.d,type:t,property:u})}},t.prototype.calculateBox=function(t,i){n.isNullOrUndefined(this.rectBounds)?this.rectBounds={min:{x:t.x-i,y:t.y-i},max:{x:t.x+i,y:t.y+i}}:(this.rectBounds.min.x=Math.min(this.rectBounds.min.x,t.x-i),this.rectBounds.min.y=Math.min(this.rectBounds.min.y,t.y-i),this.rectBounds.max.x=Math.max(this.rectBounds.max.x,t.x+i),this.rectBounds.max.y=Math.max(this.rectBounds.max.y,t.y+i))},t.prototype.calculateFactor=function(n){var o,i,r,s,u=this.mapObject.baseMapBounds,t=new w(this.mapObject.mapAreaRect.width,this.mapObject.mapAreaRect.height-5),f,e;return u?(f=p(u.latitude.min,u.longitude.min,null,n,this.mapObject),e=p(u.latitude.max,u.longitude.max,null,n,this.mapObject),i=e.y-f.y,r=e.x-f.x,0!==i&&0!==r||(r=t.width/2,i=t.height)):i=r=500,o=i<t.height?parseFloat(Math.abs(100*Number(t.height/Number(i.toString()+"e+1"))).toString().split(".")[0])/10:t.height/i,s=r<t.width?parseFloat(Math.abs(100*Number(t.width/Number(r.toString()+"e+1"))).toString().split(".")[0])/10:t.width/r,Math.min(s,o)},t.prototype.translateLayerElements=function(t){var i,u,s,h,r,c,f,e,o;if(this.mapObject.translateType="layer",n.isNullOrUndefined(this.mapObject.baseMapRectBounds)){if(this.mapObject.isTileMap&&!n.isNullOrUndefined(this.mapObject.scale))for(u=0;u<t.childElementCount;u++)(i=t.childNodes[u]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||i.id.indexOf("_line_Group")>-1||(o="scale( "+this.mapObject.scale+" ) translate( "+this.mapObject.translatePoint.x+" "+this.mapObject.translatePoint.y+" ) ",i.setAttribute("transform",o))}else for(s=this.currentLayer.animationDuration,h=0!==s||n.isNullOrUndefined(this.mapObject.zoomModule),this.mapObject.baseTranslatePoint=this.mapObject.zoomTranslatePoint,r=void 0,r=this.mapObject.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.mapObject.zoomModule)?yt(this.mapObject,this.currentLayer,h):ut(this.mapObject,this.currentLayer,h),c=this.mapObject.previousScale=r.scale,f=this.mapObject.previousPoint=r.location,this.mapObject.baseTranslatePoint=this.mapObject.translatePoint=f,this.mapObject.baseScale=this.mapObject.scale=c,e=0;e<t.childElementCount;e++)(i=t.childNodes[e]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||(o="scale( "+c+" ) translate( "+f.x+" "+f.y+" ) ",i.setAttribute("transform",o),s>0&&!n.isNullOrUndefined(this.mapObject.zoomModule)&&(r=this.mapObject.zoomSettings.zoomFactor>1?yt(this.mapObject,this.currentLayer):ut(this.mapObject,this.currentLayer),this.mapObject.scale=r.scale,this.mapObject.zoomTranslatePoint=this.mapObject.translatePoint=r.location))},t.prototype.calculateRectBounds=function(t){var i=this;Array.prototype.forEach.call(t,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var u=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,r=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates;switch(u.toLowerCase()){case"polygon":i.calculateRectBox(r[0]);break;case"multipolygon":r.map(function(n){i.calculateRectBox(n[0])});break;case"multilinestring":r.map(function(n){n.map(function(n,t){i.calculateRectBox(n,"multilinestring",0===t)})});break;case"linestring":r.map(function(n,t){i.calculateRectBox(n,"linestring",0===t)});break;case"point":i.calculateRectBox(r,"point");break;case"multipoint":r.map(function(n,t){i.calculateRectBox(n,"multipoint",0===t)})}}})},t.prototype.calculatePolygonBox=function(t){var i=this,u=[],r=this.mapObject.baseMapBounds;return t.map(function(t){var e=t[1],o=t[0],f;o>=r.longitude.min&&o<=r.longitude.max&&e>=r.latitude.min&&e<=r.latitude.max&&(f=p(e,o,i.currentFactor,i.currentLayer,i.mapObject),n.isNullOrUndefined(i.rectBounds)?i.rectBounds={min:{x:f.x,y:f.y},max:{x:f.x,y:f.y}}:(i.rectBounds.min.x=Math.min(i.rectBounds.min.x,f.x),i.rectBounds.min.y=Math.min(i.rectBounds.min.y,f.y),i.rectBounds.max.x=Math.max(i.rectBounds.max.x,f.x),i.rectBounds.max.y=Math.max(i.rectBounds.max.y,f.y)),u.push({point:f,lat:e,lng:o}))}),u},t.prototype.calculateRectBox=function(t,i,r){var u=this;"linestring"!==i&&"multilinestring"!==i&&"point"!==i&&"multipoint"!==i?Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(u.mapObject.baseMapBounds)?u.mapObject.baseMapBounds=new li({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(u.mapObject.baseMapBounds.latitude.min=Math.min(u.mapObject.baseMapBounds.latitude.min,t[1]),u.mapObject.baseMapBounds.latitude.max=Math.max(u.mapObject.baseMapBounds.latitude.max,t[1]),u.mapObject.baseMapBounds.longitude.min=Math.min(u.mapObject.baseMapBounds.longitude.min,t[0]),u.mapObject.baseMapBounds.longitude.max=Math.max(u.mapObject.baseMapBounds.longitude.max,t[0]))}):(r||"point"===i)&&n.isNullOrUndefined(this.mapObject.baseMapBounds)?this.mapObject.baseMapBounds=new li({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(this.mapObject.baseMapBounds.latitude.min=Math.min(this.mapObject.baseMapBounds.latitude.min,t[1]),this.mapObject.baseMapBounds.latitude.max=Math.max(this.mapObject.baseMapBounds.latitude.max,t[1]),this.mapObject.baseMapBounds.longitude.min=Math.min(this.mapObject.baseMapBounds.longitude.min,t[0]),this.mapObject.baseMapBounds.longitude.max=Math.max(this.mapObject.baseMapBounds.longitude.max,t[0]))},t.prototype.generateTiles=function(t,i,r,u,f){var o,v,rt=this.mapObject.locale,h=this.mapObject.availableSize,p,w,c,l,a,b,k,d,s,ut,e,g,it,nt,y;this.tiles=[];o=v=Math.pow(2,t);p=0;w=0;i.x+256*o<h.width&&(p=i.x>0?Math.ceil(i.x/256):0,w=i.x+256*o<h.width?Math.ceil((h.width-(i.x+256*o))/256):0);o+=p+w;"Pan"===r?(o=this.horizontalPanXCount>=o?this.horizontalPanXCount:o,this.horizontalPan=!1):(this.horizontalPanXCount=o,this.horizontalPan=!0);c=this.mapObject.layers[this.mapObject.baseLayerIndex];this.urlTemplate=c.urlTemplate;var et=Math.min(v,(-i.y+h.height)/256+1),ot=Math.min(o,(-i.x+h.width+256*w)/256+1),st=-(i.x+256*p+256)/256,ht=-(i.y+256)/256;for(u=u||this.bing||this.mapObject.bingMap,l=Math.round(st);l<Math.round(ot);l++)for(a=Math.round(ht);a<Math.round(et);a++)b=256*l+i.x,k=256*a+i.y,b>-256&&b<=h.width&&k>-256&&k<h.height&&a>=0&&(d=l,l<0&&(d=d%v+v),s=new be(d%v,a),(s.left=Math.round(b),s.top=Math.round(k),"Bing"===c.layerType||u&&!n.isNullOrUndefined(c.urlTemplate)&&""!==c.urlTemplate)?(ut=c.key,s.src=u.getBingMap(s,ut,c.bingMapType,rt,u.imageUrl,u.subDomains)):s.src=this.urlTemplate.replace("level",t.toString()).replace("tileX",s.x.toString()).replace("tileY",s.y.toString()),this.tiles.push(s));n.isNullOrUndefined(r)||(r.indexOf("wheel")>1?(this.animateToZoomX=this.mapObject.availableSize.width/2-f.x-10,this.animateToZoomY=-f.y):(this.animateToZoomX=-10,this.animateToZoomY=10-(this.mapObject.availableSize.height/2+11.5)));for(var ct=n.extend([],this.tiles,[],!0),tt=0,ft=this.mapObject.layers;tt<ft.length;tt++)if(e=ft[tt],"SubLayer"===e.type&&e.visible&&("Geometry"!==e.layerType&&"GoogleStaticMap"!==e.layerType||"Geometry"===e.layerType&&n.isNullOrUndefined(e.shapeData)&&!n.isNullOrUndefined(e.urlTemplate)&&""!==e.urlTemplate))for(g=0,it=ct;g<it.length;g++)nt=it[g],y=n.extend({},nt,{},!0),"Bing"===e.layerType?(u=new gi(this.mapObject),y.src=u.getBingMap(y,e.key,e.bingMapType,rt,u.imageUrl,u.subDomains)):y.src=e.urlTemplate.replace("level",t.toString()).replace("tileX",nt.x.toString()).replace("tileY",nt.y.toString()),this.tiles.push(y);(this.mapObject.previousScale!==this.mapObject.scale||this.mapObject.isReset||this.mapObject.isZoomByPosition||this.mapObject.zoomNotApplied)&&this.arrangeTiles(r,this.animateToZoomX,this.animateToZoomY)},t.prototype.arrangeTiles=function(t,i,r){var o,u=this,f=document.getElementById(this.mapObject.element.id+"_tile_parent"),e=document.getElementById(this.mapObject.element.id+"_tiles");n.isNullOrUndefined(t)||"Pan"===t?o=0:(this.tileAnimation(t,i,r),o=this.mapObject.layersCollection[0].animationDuration);"GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?this.renderGoogleMap(this.mapObject.layers[0].key,this.mapObject.staticMapZoom):setTimeout(function(){var o,h,i,l,c,v,y;for(f&&(f.style.zIndex="1"),e&&(e.style.zIndex="0"),!document.getElementById(u.mapObject.element.id+"_animated_tiles")&&f?(o=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(o)):"Pan"!==t&&e&&f?(e.appendChild(f.children[0]),u.mapObject.isAddLayer||n.isNullOrUndefined(document.getElementById(u.mapObject.element.id+"_animated_tiles"))||(document.getElementById(u.mapObject.element.id+"_animated_tiles").id=u.mapObject.element.id+"_animated_tiles_old"),o=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(o)):o=f?f.children[0]:null,h=0;h<u.tiles.length;h++){var s=u.tiles[h],r=null,p=u.mapObject.element.id;"Pan"===t?(i=document.getElementById(p+"_tile_"+h),l=!1,n.isNullOrUndefined(i)?(l=!0,i=n.createElement("div",{id:p+"_tile_"+h}),r=n.createElement("img")):(i.style.removeProperty("display"),r=i.children[0]),!l&&r&&r.src!==s.src&&(r.src=s.src),i.style.position="absolute",i.style.left=s.left+"px",i.style.top=s.top+"px",i.style.height=s.height+"px",i.style.width=s.width+"px",l&&(r.setAttribute("height","256px"),r.setAttribute("width","256px"),r.setAttribute("src",s.src),r.setAttribute("alt",u.mapObject.getLocalizedLabel("ImageNotFound")),r.style.setProperty("user-select","none"),i.appendChild(r),o.appendChild(i))):((r=n.createElement("img")).setAttribute("height","256px"),r.setAttribute("width","256px"),r.setAttribute("src",s.src),r.style.setProperty("user-select","none"),r.setAttribute("alt",u.mapObject.getLocalizedLabel("ImageNotFound")),(i=n.createElement("div",{id:p+"_tile_"+h})).style.position="absolute",i.style.left=s.left+"px",i.style.top=s.top+"px",i.style.height=s.height+"px",i.style.width=s.width+"px",i.appendChild(r),o&&o.appendChild(i));h===u.tiles.length-1&&document.getElementById(u.mapObject.element.id+"_animated_tiles_old")&&a(u.mapObject.element.id+"_animated_tiles_old")}if(!n.isNullOrUndefined(u.mapObject.currentTiles))for(c=u.tiles.length;c<o.childElementCount;c++){for(v=!1,y=0;y<u.mapObject.currentTiles.childElementCount;y++)v||u.mapObject.currentTiles.children[y].id!==o.children[c].id||(v=!0);v?o.children[c].style.display="none":o.removeChild(o.children[c])}},o)},t.prototype.tileAnimation=function(t,i,r){var o=document.getElementById(this.mapObject.element.id+"_tile_parent"),f=document.getElementById(this.mapObject.element.id+"_animated_tiles"),u=document.getElementById(this.mapObject.element.id+"_tiles"),e="2";if(0===t.indexOf("ZoomOut")||"Reset"===t){for(u.style.zIndex="1",o.style.zIndex="0";u.childElementCount>=1;)u.removeChild(u.children[0]);i=0;r=document.getElementById(this.mapObject.element.id+"_tile_parent").getClientRects()[0].height/4;e=0===t.indexOf("ZoomOut")?"0.5":"0.2"}n.isNullOrUndefined(f)||(f.style.transition=this.mapObject.layersCollection[0].animationDuration+"ms",f.style.transform="translate("+i+"px, "+r+"px) scale("+e+")")},t.prototype.renderGoogleMap=function(t,i){var r=this.mapObject,u,e,o;i=this.mapObject.tileZoomLevel;var s=256*Math.pow(2,i),a=r.mapAreaRect.width/2-s/2,v=r.mapAreaRect.height/2-s/2,h=0,c=0,l=it(new f(null,null),i,{x:a,y:v},this.isMapCoordinates);r.zoomModule&&r.zoomSettings.enable&&(h=r.zoomModule.mouseDownLatLong.x-r.zoomModule.mouseMoveLatLong.x,c=r.zoomModule.mouseDownLatLong.y-r.zoomModule.mouseMoveLatLong.y);o=r.pointToLatLong(l.x-h,l.y-c);r.centerPosition.latitude=o.latitude;r.centerPosition.longitude=o.longitude;var y=(u=n.isNullOrUndefined(parseInt(r.width,10))?parseInt(r.width,10)-22:Math.round(r.mapAreaRect.width))>640?(u-640)/2:0,p=(e=n.isNullOrUndefined(parseInt(r.height,10))?parseInt(r.height,10)-22:Math.round(r.mapAreaRect.height))>640?(e-640)/2:0,w=r.layers[r.layers.length-1].staticMapType.toString().toLowerCase(),b="https://maps.googleapis.com/maps/api/staticmap?size="+u+"x"+e+"&zoom="+i+"&center="+(r.centerPosition.latitude&&r.centerPosition.longitude?r.centerPosition.latitude.toString()+","+r.centerPosition.longitude.toString():"0,0")+"&maptype="+w+"&key="+t;document.getElementById(this.mapObject.element.id+"_tile_parent").innerHTML='<div id="'+this.mapObject.element.id+'_StaticGoogleMap"style="position:absolute; left:'+y+"px; top:"+p+'px"><img src="'+b+'"alt="'+this.mapObject.getLocalizedLabel("ImageNotFound")+'"><\/div>'},t.prototype.panTileMap=function(t,i,r){var l,a;this.mapObject.tileZoomLevel<=this.mapObject.tileZoomScale&&this.mapObject.initialCheck&&(this.mapObject.tileZoomLevel=this.mapObject.tileZoomScale);var e,u,o=this.mapObject.tileZoomLevel,s="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.layers.length-1].layerType?20:0,h=256*Math.pow(2,o),c=it(r,o,{x:e=t/2-h/2,y:u=i/2-h/2},this.isMapCoordinates);return(s=this.mapObject.zoomNotApplied?0:s,e-=c.x-t/2,u=u-(c.y-i/2)+s,this.mapObject.scale=Math.pow(2,o-1),(n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||0===this.mapObject.tileTranslatePoint.y&&0===this.mapObject.tileTranslatePoint.x||n.isNullOrUndefined(this.mapObject.previousTileWidth)||n.isNullOrUndefined(this.mapObject.previousTileHeight))&&(this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||!n.isNullOrUndefined(r.x)||1!==this.mapObject.zoomSettings.zoomFactor&&this.mapObject.zoomSettings.zoomFactor===o&&this.mapObject.defaultState||t===this.mapObject.previousTileWidth&&i===this.mapObject.previousTileHeight)||(l=e-(this.mapObject.previousTileWidth/2-h/2),a=u-(this.mapObject.previousTileHeight/2-h/2+s),this.mapObject.tileTranslatePoint.x=this.mapObject.tileTranslatePoint.x+l,this.mapObject.tileTranslatePoint.y=this.mapObject.tileTranslatePoint.y+a),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||this.mapObject.zoomNotApplied||(0===this.mapObject.tileTranslatePoint.x||this.mapObject.tileTranslatePoint.x===e||this.mapObject.centerPositionChanged||(e=this.mapObject.tileTranslatePoint.x),0===this.mapObject.tileTranslatePoint.y||this.mapObject.tileTranslatePoint.y===u||this.mapObject.centerPositionChanged||(u=this.mapObject.tileTranslatePoint.y)),this.mapObject.translatePoint=new f((e-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale,(u-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale),this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i,new f(e,u)},t.prototype.destroy=function(){this.mapObject=null;this.groupElements=[];this.layerObject=null;this.currentLayer=null;this.rectBounds=null;this.tiles=[];this.clipRectElement=null;this.tileSvgObject=null;this.ajaxModule=null;this.ajaxResponse=[];this.layerGroup=null;n.isNullOrUndefined(this.bing)||this.bing.destroy();this.bing=null},t}(),cf=function(){function t(n){this.map=n}return t.prototype.renderAnnotationElements=function(){var u=this,i=this.map.element.id+"_Secondary_Element",t=n.createElement("div",{id:this.map.element.id+"_Annotations_Group"});t.style.position="absolute";t.style.top="0px";t.style.left="0px";this.map.annotations.map(function(n,i){null!==n.content&&u.createAnnotationTemplate(t,n,i)});t.childElementCount>0&&!n.isNullOrUndefined(r(i))&&r(i).appendChild(t);this.map.renderReactTemplates()},t.prototype.createAnnotationTemplate=function(t,i,r){var u,f,y,p,e=this,h=this.map,b=h.availableSize,o=(h.element.id,n.createElement("div",{id:h.element.id+"_Annotation_"+r})),s,l,a;o.style.cssText="position: absolute; z-index:"+i.zIndex+";";s={cancel:!1,name:ef,content:i.content,annotation:i};this.map.trigger(ef,s,function(){if(!s.cancel)if((y=ii(s.content,e.map))&&y(e.map,e.map,s.content,e.map.element.id+"_ContentTemplate_"+r).length)for(var i=(p=Array.prototype.slice.call(y(e.map,e.map,s.content,e.map.element.id+"_ContentTemplate_"+r))).length,t=0;t<i;t++)o.appendChild(p[t]);else o.appendChild(n.createElement("div",{innerHTML:s.content}))});var v=function(n,t){t.appendChild(n);var i=n.offsetWidth,r=n.offsetHeight;return t.removeChild(n),new w(i,r)}(o.cloneNode(!0),h.element),k=h.element.getBoundingClientRect(),c=h.svgObject.getBoundingClientRect();u=Math.abs(c.left-k.left);f=Math.abs(c.top-k.top);l=i.x.indexOf("%")>-1?b.width/100*parseFloat(i.x):parseFloat(i.x);a=i.y.indexOf("%")>-1?b.height/100*parseFloat(i.y):parseFloat(i.y);switch(u="None"===i.horizontalAlignment?u+l:u,f="None"===i.verticalAlignment?f+a:f,i.verticalAlignment){case"Near":f+=a;break;case"Center":f=f+a+(c.height/2-v.height/2);break;case"Far":f=f+c.height+a-v.height}switch(i.horizontalAlignment){case"Near":u+=l;break;case"Center":u=u+l+(c.width/2-v.width/2);break;case"Far":u=u+c.width+l-v.width}o.style.left=u+"px";o.style.top=f+"px";t.appendChild(o)},t.prototype.getModuleName=function(){return"Annotations"},t.prototype.destroy=function(){this.map=null},t}();const nt=ejdashboard.data;var no=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},lf=function(t){function i(i,r){var u=t.call(this,i,r)||this;return u.isTileMap=!1,u.isResize=!1,u.isReset=!1,u.baseSize=new w(0,0),u.translatePoint=new f(0,0),u.baseTranslatePoint=new f(0,0),u.zoomTranslatePoint=new f(0,0),u.markerZoomedState=!0,u.zoomPersistence=!1,u.defaultState=!0,u.centerPositionChanged=!1,u.isTileMapSubLayer=!1,u.markerNullCount=0,u.tileTranslatePoint=new f(0,0),u.baseTileTranslatePoint=new f(0,0),u.isDevice=!1,u.staticMapZoom=u.zoomSettings.enable?u.zoomSettings.zoomFactor:0,u.zoomNotApplied=!1,u.dataLabelShape=[],u.zoomShapeCollection=[],u.zoomLabelPositions=[],u.mouseDownEvent={x:null,y:null},u.mouseClickEvent={x:null,y:null},u.selectedElementId=[],u.selectedMarkerElementId=[],u.selectedBubbleElementId=[],u.selectedNavigationElementId=[],u.selectedLegendElementId=[],u.legendSelectionCollection=[],u.shapeSelections=!0,u.legendSelection=!0,u.toggledLegendId=[],u.toggledShapeElementId=[],u.checkInitialRender=!0,u.initialTileTranslate=new f(0,0),u.markerDragId="",u.initialCheck=!0,u.applyZoomReset=!1,u.markerClusterExpandCheck=!1,u.markerClusterExpand=!1,u.mouseMoveId="",u.shapeSelectionItem=[],u.markerDragArgument=null,n.setValue("mergePersistData",u.mergePersistMapsData,u),u}return no(i,t),Object.defineProperty(i.prototype,"isShapeSelected",{get:function(){return this.mapSelect},enumerable:!0,configurable:!0}),i.prototype.mergePersistMapsData=function(){var i,f,r,o,u,e,t;try{f=window.localStorage}catch(i){f=null}if(n.isNullOrUndefined(f)||(i=window.localStorage.getItem(this.getModuleName()+this.element.id)),!n.isNullOrUndefined(i)&&""!==i){for(r=JSON.parse(i),o=Object.keys(r),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)t=e[u],"object"!=typeof this[t]||n.isNullOrUndefined(this[t])?this[t]=r[t]:n.extend(this[t],r[t]);this.isProtectedOnChange=!1}},i.prototype.getLocalizedLabel=function(n){return this.localeObject.getConstant(n)},i.prototype.preRender=function(){this.isDevice=n.Browser.isDevice;this.initPrivateVariable();this.allowServerDataBinding=!1;this.unWireEVents();this.wireEVents();this.setCulture()},i.prototype.renderElements=function(){this.isDestroyed||(this.trigger("load",{maps:this}),this.createSVG(),this.findBaseAndSubLayers(),this.createSecondaryElement(),this.addTabIndex(),this.themeStyle=function(n){var t,i;switch(n.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(n.toLowerCase()){case"materialdark":case"fabricdark":case"bootstrapdark":t={backgroundColor:i,areaBackgroundColor:i,titleFontColor:"#FFFFFF",titleFontSize:"14px",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#DADADA",legendTextColor:"#DADADA",dataLabelFontColor:"#DADADA",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",zoomFillColor:"#FFFFFF",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",fontWeight:"Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"highcontrast":t={backgroundColor:"#000000",areaBackgroundColor:"#000000",titleFontColor:"#FFFFFF",titleFontSize:"14px",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#000000",tooltipFontColor:"#000000",tooltipFillColor:"#ffffff",zoomFillColor:"#FFFFFF",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",fontWeight:"Medium",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#5B6269",fontFamily:"HelveticaNeue-Medium",fontSize:"12px",fontWeight:"Medium",titleFontSize:"16px",legendFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"HelveticaNeue-Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"tailwind":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#374151",subTitleFontColor:"#374151",legendTitleFontColor:"#374151",legendTextColor:"#6B7280",dataLabelFontColor:"#505967",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#111827",zoomFillColor:"#6b7280",fontFamily:"Inter",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#374151",shapeFill:"#E5E7EB",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"tailwinddark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#D1D5DB",subTitleFontColor:"#D1D5DB",legendTitleFontColor:"#D1D5DB",legendTextColor:"#D1D5DB",dataLabelFontColor:"#D1D5DB",tooltipFontColor:"#1F2937",tooltipFillColor:"#F9FAFB",zoomFillColor:"#D1D5DB",fontFamily:"Inter",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#F3F4F6",shapeFill:"#374151",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"bootstrap5":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#212529",zoomFillColor:"#6C757D",fontFamily:"Helvetica Neue",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#343A40",shapeFill:"#E9ECEF",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"bootstrap5dark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#212529",tooltipFillColor:"#E9ECEF",zoomFillColor:"#B5BABE",fontFamily:"Helvetica Neue",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#DEE2E6",shapeFill:"#495057",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"fluent":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#201F1E",subTitleFontColor:"#201F1E",legendTitleFontColor:"#201F1E",legendTextColor:"#201F1E",dataLabelFontColor:"#201F1E",tooltipFontColor:"#323130",tooltipFillColor:"#FFFFFF",zoomFillColor:"#A19F9D",fontFamily:"Segoe UI",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#323130",shapeFill:"#F3F2F1",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"fluentdark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#F3F2F1",subTitleFontColor:"#F3F2F1",legendTitleFontColor:"#F3F2F1",legendTextColor:"#F3F2F1",dataLabelFontColor:"#F3F2F1",tooltipFontColor:"#F3F2F1",tooltipFillColor:"#252423",zoomFillColor:"#484644",fontFamily:"Segoe UI",fontSize:"12px",fontWeight:"Medium",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#F3F2F1",shapeFill:"#252423",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"};break;case"material3":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#1C1B1F",subTitleFontColor:"#1C1B1F",legendTitleFontColor:"#1C1B1F",legendTextColor:"#49454E",dataLabelFontColor:"#1C1B1F",tooltipFontColor:"#F4EFF4",tooltipFillColor:"#313033",zoomFillColor:"#49454E",fontFamily:"Roboto",fontSize:"14px",titleFontSize:"16px",subTitleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Roboto",titleFontWeight:"500",fontWeight:"400",zoomSelectionColor:"#49454E",shapeFill:"#E7E0EC",rectangleZoomFillColor:"#6750A4",rectangleZoomFillOpacity:.24,rectangleZoomBorderColor:"#6750A4"};break;case"material3dark":t={backgroundColor:"transparent",areaBackgroundColor:"transparent",titleFontColor:"#E6E1E5",subTitleFontColor:"#E6E1E5",legendTitleFontColor:"#E6E1E5",legendTextColor:"#CAC4D0",dataLabelFontColor:"#E6E1E5",tooltipFontColor:"#313033",tooltipFillColor:"#E6E1E5",zoomFillColor:"#E6E1E5",fontFamily:"Roboto",fontSize:"14px",titleFontSize:"16px",subTitleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Roboto",titleFontWeight:"500",fontWeight:"400",zoomSelectionColor:"#E6E1E5",shapeFill:"#49454F",rectangleZoomFillColor:"#D0BCFF",rectangleZoomFillOpacity:.24,rectangleZoomBorderColor:"#D0BCFF"};break;default:t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#424242",titleFontSize:"14px",subTitleFontColor:"#424242",legendTitleFontColor:"#757575",legendTextColor:"#757575",dataLabelFontColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#737373",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",fontSize:"12px",fontWeight:"Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6",rectangleZoomFillColor:"#d3d3d3",rectangleZoomFillOpacity:.5,rectangleZoomBorderColor:"#009900"}}return t}(this.theme),this.renderBorder(),this.renderTitle(this.titleSettings,"title",null,null),this.renderArea(),this.processRequestJsonData(),this.renderComplete(),this.isAddLayer=!!this.isTileMap&&this.isAddLayer)},i.prototype.render=function(){this.renderElements()},i.prototype.processRequestJsonData=function(){var i,r,t=this,u=this.layersCollection.length-1;this.serverProcess={request:0,response:0};Array.prototype.forEach.call(this.layersCollection,function(f,e){var s,o,h;if(f.shapeData instanceof nt.DataManager?(t.serverProcess.request++,r=f.shapeData,i=f.query instanceof nt.Query?f.query:new nt.Query,r.executeQuery(i).then(function(n){t.processResponseJsonData("DataManager",n,f,"ShapeData")})):(f.shapeData instanceof wi||f.shapeData)&&(n.isNullOrUndefined(f.shapeData.dataOptions)||t.processAjaxRequest(f,f.shapeData,"ShapeData")),f.dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.dataSource,i=f.query instanceof nt.Query?f.query:new nt.Query,r.executeQuery(i).then(function(n){f.dataSource=wt(n)})),f.markerSettings.length>0)for(s=function(n){f.markerSettings[n].dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.markerSettings[n].dataSource,i=f.markerSettings[n].query instanceof nt.Query?f.markerSettings[n].query:new nt.Query,r.executeQuery(i).then(function(t){f.markerSettings[n].dataSource=wt(t)}))},o=0;o<f.markerSettings.length;o++)s(o);if(f.bubbleSettings.length>0)for(h=function(n){f.bubbleSettings[n].dataSource instanceof nt.DataManager&&(t.serverProcess.request++,r=f.bubbleSettings[n].dataSource,i=f.bubbleSettings[n].query instanceof nt.Query?f.bubbleSettings[n].query:new nt.Query,r.executeQuery(i).then(function(t){f.bubbleSettings[n].dataSource=wt(t)}))},o=0;o<f.bubbleSettings.length;o++)h(o);(f.dataSource instanceof wi||!n.isNullOrUndefined(f.dataSource.dataOptions))&&t.processAjaxRequest(f,f.dataSource,"DataSource");t.serverProcess.request===t.serverProcess.response&&u===e&&t.processResponseJsonData(null)})},i.prototype.processAjaxRequest=function(t,i,r){var f=this,u;this.serverProcess.request++;u=new n.Fetch(i.dataOptions,i.type,i.contentType);u.onSuccess=function(n){f.processResponseJsonData("Fetch",n,t,r)};u.send(i.sendData)},i.prototype.processResponseJsonData=function(t,i,r,u){var f,e,o;if(this.serverProcess.response++,t&&("ShapeData"===u?r.shapeData="DataManager"===t?wt(i):i:r.dataSource="DataManager"===t?wt(i):i),n.isNullOrUndefined(t)||this.serverProcess.request!==this.serverProcess.response)n.isNullOrUndefined(t)&&this.renderMap();else{for(f=this.layersCollection,this.layersCollection=[],e=0;e<f.length;e++)f[e].isBaseLayer&&this.layersCollection.push(f[e]);for(o=0;o<f.length;o++)f[o].isBaseLayer||this.layersCollection.push(f[o]);this.renderMap()}},i.prototype.renderMap=function(){var t,a,v,r,u,s,o,c;for(this.legendModule&&this.legendSettings.visible&&this.legendModule.renderLegend(),this.createTile(),this.zoomSettings.enable&&this.zoomModule&&this.zoomModule.createZoomingToolbars(),n.isNullOrUndefined(this.dataLabelModule)||(this.dataLabelModule.dataLabelCollections=[]),this.mapLayerPanel.measureLayerPanel(),n.isNullOrUndefined(this.svgObject)||this.element.appendChild(this.svgObject),this.setSecondaryElementPosition(),t=0;t<this.layers.length;t++){if(this.layers[t].selectionSettings&&this.layers[t].selectionSettings.enable&&this.layers[t].initialShapeSelection.length>0&&this.checkInitialRender){for(a=this.layers[t].selectionSettings.enableMultiSelect,this.layers[t].selectionSettings.enableMultiSelect=a||!0,v=this.layers[t].initialShapeSelection,r=0;r<this.layers[t].initialShapeSelection.length;r++)this.shapeSelection(t,v[r].shapePath,v[r].shapeValue,!0);this.layers[t].selectionSettings.enableMultiSelect=a;t===this.layers.length-1&&(this.checkInitialRender=!1)}if(!this.isResize)for(u=0;u<this.layers[t].markerSettings.length;u++)if(this.layers[t].markerSettings[u].selectionSettings&&this.layers[t].markerSettings[u].selectionSettings.enable&&this.layers[t].markerSettings[u].initialMarkerSelection.length>0)for(s=this.layers[t].markerSettings[u].initialMarkerSelection,r=0;r<s.length;r++)this.markerInitialSelection(t,u,this.layers[t].markerSettings[u],s[r].latitude,s[r].longitude)}if(!n.isNullOrUndefined(document.getElementById(this.element.id+"_tile_parent"))){var f,p=this.svgObject.getBoundingClientRect(),w=document.getElementById(this.element.id),i=document.getElementById(this.element.id+"_tile_parent"),h=document.getElementById(this.element.id+"_tiles"),b=i.getBoundingClientRect(),y=void 0,e=void 0;e=parseFloat(i.style.left);o=l(this.titleSettings.text,this.titleSettings.textStyle);c=l(this.titleSettings.subtitleSettings.text,this.titleSettings.subtitleSettings.textStyle);this.isTileMap&&this.isTileMapSubLayer&&"Bottom"===this.legendSettings.position&&this.legendSettings.visible?"Default"!==this.legendSettings.mode?f=0!==o.width&&0!==o.height?parseFloat(i.style.top)+c.height/2-this.legendModule.legendBorderRect.height/2:parseFloat(i.style.top)-this.mapAreaRect.y:(e=this.legendModule.legendBorderRect.x,f=0!==o.width&&0!==o.height?parseFloat(i.style.top)+c.height/2-this.legendModule.legendBorderRect.y:parseFloat(i.style.top)+c.height/2):(y=p.bottom-b.bottom-w.offsetTop,f=parseFloat(i.style.top));f=y<=11?f:n.isNullOrUndefined(this.legendModule)||"Bottom"!==this.legendSettings.position?2*f:this.mapAreaRect.y;e=y<=11?e:n.isNullOrUndefined(this.legendModule)?2*e:e;i.style.top=f+"px";i.style.left=e+"px";h.style.top=f+"px";h.style.left=e+"px";!n.isNullOrUndefined(this.legendModule)&&this.legendModule.totalPages.length>0&&(i.style.height=h.style.height=this.legendModule.legendTotalRect.height+"px",i.style.width=h.style.width=this.legendModule.legendTotalRect.width+"px")}for(this.arrangeTemplate(),this.annotationsModule&&"0px"!==this.width&&"0px"!==this.height&&"0%"!==this.width&&"0%"!==this.height&&this.annotationsModule.renderAnnotationElements(),this.element.style.outline="none",this.element.style.position="relative",t=0;t<document.getElementsByTagName("path").length-1;t++)document.getElementsByTagName("path")[t].id.indexOf("shapeIndex")>-1&&(document.getElementsByTagName("path")[t].style.outline="none");this.zoomingChange();this.zoomModule&&this.isDevice&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,this.element.id+"_Zooming_");this.isZoomByPosition||this.zoomNotApplied||this.trigger("loaded",{maps:this,isResized:this.isResize});this.isResize=!1},i.prototype.markerSelection=function(n,t,i,r){var f={color:n.border.color,width:n.border.width/t.scale,opacity:n.border.opacity},u={opacity:n.opacity,fill:n.fill,border:f,target:i.id,cancel:!1,data:r,maps:t};s("MarkerselectionMap")?lt("MarkerselectionMap","MarkerselectionMapStyle",u):document.body.appendChild(pt("MarkerselectionMap","MarkerselectionMapStyle",u));(0===this.selectedMarkerElementId.length||n.enableMultiSelect)&&("g"===i.tagName?(i.children[0].setAttribute("class","MarkerselectionMapStyle"),this.selectedMarkerElementId.push(i.children[0].id)):(i.setAttribute("class","MarkerselectionMapStyle"),this.selectedMarkerElementId.push(i.id)))},i.prototype.markerInitialSelection=function(n,t,i,r,u){var o=i.selectionSettings,f,e,h;if(o.enable)for(f=0;f<i.dataSource.length;f++)e=i.dataSource[f],e.latitude===r&&e.longitude===u&&(h=this.element.id+"_LayerIndex_"+n+"_MarkerIndex_"+t+"_dataIndex_"+f,this.markerSelection(o,this,s(h),e))},i.prototype.renderArea=function(){var u=this.mapsArea.border.width,t=this.mapsArea.background,i,r;(u>0||t||this.themeStyle.areaBackgroundColor)&&(i={opacity:n.isNullOrUndefined(this.mapsArea.border.opacity)?1:this.mapsArea.border.opacity,color:this.mapsArea.border.color,width:this.mapsArea.border.width},r=new b(this.element.id+"_MapAreaBorder",t||this.themeStyle.areaBackgroundColor,i,1,this.mapAreaRect),this.svgObject.appendChild(this.renderer.drawRectangle(r)))},i.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"Maps Element");this.element.setAttribute("role","");this.element.tabIndex=this.tabIndex},i.prototype.setSecondaryElementPosition=function(){var i=r(this.element.id+"_Secondary_Element"),u=this.element.getBoundingClientRect(),f=r(this.element.id+"_svg"),t;n.isNullOrUndefined(f)||(t=f.getBoundingClientRect(),i.style.left=Math.max(t.left-u.left,0)+"px",i.style.top=Math.max(t.top-u.top,0)+"px")},i.prototype.zoomingChange=function(){var h,c,u,t,v,f,i,w,s,e;if(r(this.element.id+"_Layer_Collections")&&this.zoomModule&&(this.zoomModule.layerCollectionEle=r(this.element.id+"_Layer_Collections")),this.isTileMap&&r(this.element.id+"_Tile_SVG")&&r(this.element.id+"_tile_parent")){var l=r(this.element.id+"_tile_parent"),a=r(this.element.id+"_Tile_SVG"),o=r(this.element.id+"_Tile_SVG_Parent"),y=l.getBoundingClientRect(),p=a.getBoundingClientRect();if(h=y.left-p.left,c=y.top-p.top,o.style.left=h+"px",o.style.top=c+"px",!n.isNullOrUndefined(this.legendModule)&&this.legendModule.totalPages.length>0&&(l.style.width=a.style.width=this.legendModule.legendTotalRect.width.toString(),l.style.height=a.style.height=this.legendModule.legendTotalRect.height.toString(),o.style.width=this.legendModule.legendTotalRect.width+"px",o.style.height=this.legendModule.legendTotalRect.height+"px"),u=document.getElementsByClassName("template"),!n.isNullOrUndefined(u)&&u.length>0)for(t=0;t<u.length;t++)v=u[t],v.style.left=h+"px",v.style.top=c+"px"}if(this.zoomSettings.zoomFactor>=0){if(this.zoomModule&&this.zoomModule.toolBarGroup&&this.zoomSettings.enable&&this.zoomModule.alignToolBar(),f=document.getElementById(this.element.id+"_Layer_Collections"),!n.isNullOrUndefined(f)&&f.childElementCount>0)for(t=0;t<f.childNodes.length;t++)if(i=f.childNodes[t],"g"===i.tagName&&-1===i.id.indexOf("_Legend_Group"))for(w=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),s=0;s<i.childNodes.length;s++)e=i.childNodes[s],e.id.indexOf("_Markers_Group")>-1||e.id.indexOf("_bubble_Group")>-1||e.id.indexOf("_dataLableIndex_Group")>-1||dr(e,w,this.scale,this);this.zoomModule&&(this.previousScale!==this.scale||this.zoomNotApplied||this.isZoomByPosition)&&this.zoomModule.applyTransform(this,!0)}},i.prototype.createSecondaryElement=function(){if(n.isNullOrUndefined(document.getElementById(this.element.id+"_Secondary_Element"))){var t=n.createElement("div",{id:this.element.id+"_Secondary_Element"});t.style.cssText="position: relative;z-index:2;";this.element.appendChild(t)}},i.prototype.arrangeTemplate=function(){var e,o,i,u,s,t,h;if(document.getElementById(this.element.id+"_Legend_Border")&&(document.getElementById(this.element.id+"_Legend_Border").style.pointerEvents="none"),e=document.getElementsByClassName(this.element.id+"_template"),!n.isNullOrUndefined(e)&&e.length>0&&r(this.element.id+"_Layer_Collections")&&!this.isTileMap)for(o=0;o<e.length;o++){var c=0,l=0,f=e[o];if(!n.isNullOrUndefined(f)&&f.childElementCount>0)for(i=r(this.element.id+"_Layer_Collections").getBoundingClientRect(),u=r(f.id).getBoundingClientRect(),-1===f.id.indexOf("Marker")&&(c=this.isTileMap?0:i.left<u.left?-Math.abs(u.left-i.left):Math.abs(u.left-i.left),l=this.isTileMap?0:i.top<u.top?-Math.abs(u.top-i.top):Math.abs(u.top-i.top)),s=0;s<f.childElementCount;s++)t=f.childNodes[s],-1!==t.id.indexOf("Marker")?(h=r(t.id).getBoundingClientRect(),t.style.left=parseFloat(t.style.left)-(this.isTileMap?0:h.width/2)+"px",t.style.top=parseFloat(t.style.top)-(this.isTileMap?0:h.height/2)+"px"):(t.style.left=parseFloat(t.style.left)+c+"px",t.style.top=parseFloat(t.style.top)+l+"px",t.style.transform="translate(-50%, -50%)")}},i.prototype.createTile=function(){var t=this.layersCollection[0],i,r;t.isBaseLayer&&("OSM"===t.layerType||"Bing"===t.layerType||"GoogleStaticMap"===t.layerType||"Google"===t.layerType||!n.isNullOrUndefined(t.urlTemplate)&&""!==t.urlTemplate)&&(a(this.element.id+"_tile_parent"),a(this.element.id+"_tiles"),a("animated_tiles"),i=n.createElement("div",{id:this.element.id+"_tile_parent"}),i.style.cssText="position: absolute; left: "+this.mapAreaRect.x+"px; right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;",r=n.createElement("div",{id:this.element.id+"_tiles"}),r.style.cssText="position: absolute; left: "+this.mapAreaRect.x+"px;  right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;",this.element.appendChild(i),this.element.appendChild(r))},i.prototype.initPrivateVariable=function(){if(""===this.element.id){var n=document.getElementsByClassName("e-maps").length;this.element.id="maps_control_"+n}this.renderer=new ot.SvgRenderer(this.element.id);this.mapLayerPanel=new ge(this)},i.prototype.findBaseAndSubLayers=function(){var f=this,e=this.baseLayerIndex,r=[],u=[],t,i;for(this.layersCollection=[],Array.prototype.forEach.call(this.layers,function(n){"Layer"===n.type?r.push(n):u.push(n)}),t=0;t<r.length;t++){if(i=r[t],i.visible&&e===t){i.isBaseLayer=!0;this.isTileMap=!("Geometry"===i.layerType&&!n.isNullOrUndefined(i.shapeData));this.layersCollection.push(i);break}if(t===r.length-1){this.layersCollection.push(r[0]);break}}u.map(function(n){n.visible&&f.layersCollection.push(n)})},i.prototype.renderBorder=function(){var t=this.border.width,i=this.svgObject.querySelector("#"+this.element.id+"_MapBorder"),r,u;(t>0||this.background||this.themeStyle.backgroundColor)&&n.isNullOrUndefined(i)?(r={opacity:n.isNullOrUndefined(this.border.opacity)?1:this.border.opacity,color:this.border.color,width:this.border.width},u=new b(this.element.id+"_MapBorder",this.background||this.themeStyle.backgroundColor,r,1,new v(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t)),this.svgObject.appendChild(this.renderer.drawRectangle(u))):i.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},i.prototype.renderTitle=function(t,i,r,u){var o,e={size:t.textStyle.size,color:t.textStyle.color,fontFamily:t.textStyle.fontFamily,fontWeight:t.textStyle.fontWeight,fontStyle:t.textStyle.fontStyle,opacity:t.textStyle.opacity},h=Math.abs(this.margin.left+this.margin.right-this.availableSize.width);if(e.fontFamily=n.isNullOrUndefined(e.fontFamily)?this.themeStyle.fontFamily:e.fontFamily,e.fontWeight=e.fontWeight||this.themeStyle.titleFontWeight,e.size="title"===i?e.size||this.themeStyle.titleFontSize:e.size||this.themeStyle.subTitleFontSize||rt.mapsSubTitleFont.size,t.text){n.isNullOrUndefined(u)&&(u=this.renderer.createGroup({id:this.element.id+"_Title_Group"}));var y=g(h,t.text,e),c=l(y,e),s=function(n,t,i,r){var u,e;switch(t){case"Near":u=n.x;break;case"Center":u="title"===r?n.width/2-i.width/2:n.x+n.width/2-i.width/2;break;case"Far":u="title"===r?n.width-n.y-i.width:n.x+n.width-i.width}return e="title"===r?n.y+i.height/2:n.y+n.height/2+i.height/2,new f(u,e)}(n.isNullOrUndefined(r)?new v(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height):r,t.alignment,c,i),w=new tt(this.element.id+"_Map_"+i,s.x,s.y,"start",y),a=new v(s.x,s.y,c.width,c.height),p=st(w,e,e.color||("title"===i?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),u);p.setAttribute("aria-label",this.description||t.text);p.setAttribute("role","");("title"===i&&!t.subtitleSettings.text||"subtitle"===i)&&(o=Math.abs(a.y+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new v(this.margin.left,a.y+10,h,o-10));"subtitle"!==i&&t.subtitleSettings.text?this.renderTitle(t.subtitleSettings,"subtitle",a,u):this.svgObject.appendChild(u)}else o=Math.abs(this.margin.top+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new v(this.margin.left,this.margin.top,h,o)},i.prototype.createSVG=function(){this.removeSvg(),function(n){n.renderer=new ot.SvgRenderer(n.element.id);n.availableSize=nr(n);n.svgObject=n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height});"0px"!==n.width&&"0%"!==n.width&&"0%"!==n.height&&"0px"!==n.height||(n.svgObject.setAttribute("height","0"),n.svgObject.setAttribute("width","0"))}(this)},i.prototype.removeSvg=function(){if(a(this.element.id+"_Secondary_Element"),a(this.element.id+"_tile_parent"),a(this.element.id+"_tiles"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&n.remove(this.svgObject)}this.clearTemplate()},i.prototype.wireEVents=function(){n.EventHandler.add(this.element,"click",this.mapsOnClick,this);n.EventHandler.add(this.element,"contextmenu",this.mapsOnRightClick,this);n.EventHandler.add(this.element,"dblclick",this.mapsOnDoubleClick,this);n.EventHandler.add(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap,this);n.EventHandler.add(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap,this);n.EventHandler.add(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap,this);n.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap,this);n.EventHandler.add(this.element,"keydown",this.keyDownHandler,this);n.EventHandler.add(this.element,"keyup",this.keyUpHandler,this);this.resizeEvent=this.mapsOnResize.bind(this);window.addEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeEvent)},i.prototype.unWireEVents=function(){n.EventHandler.remove(this.element,"click",this.mapsOnClick);n.EventHandler.remove(this.element,"contextmenu",this.mapsOnRightClick);n.EventHandler.remove(this.element,"dblclick",this.mapsOnDoubleClick);n.EventHandler.remove(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap);n.EventHandler.remove(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap);n.EventHandler.remove(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap);n.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap);n.EventHandler.remove(this.element,"keydown",this.keyDownHandler);n.EventHandler.remove(this.element,"keyup",this.keyUpHandler);window.removeEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.resizeEvent)},i.prototype.mouseLeaveOnMap=function(){document.getElementsByClassName("highlightMapStyle").length>0&&this.legendModule&&(this.legendModule.removeShapeHighlightCollection(),c(document.getElementsByClassName("highlightMapStyle")[0]))},i.prototype.keyUpHandler=function(n){var t=n.target.id;this.isTileMap&&this.removeTileMap();"Tab"===n.code&&t.indexOf("_LayerIndex_")>-1&&t.indexOf("shapeIndex")>-1?this.keyboardHighlightSelection(t,n.type):-1===t.indexOf("_LayerIndex_")&&-1===t.indexOf("shapeIndex")&&ct("highlightMapStyle").length>0&&(c(ct("highlightMapStyle")[0]),this.legendSettings.visible&&this.legendModule&&this.legendModule.removeShapeHighlightCollection())},i.prototype.keyboardHighlightSelection=function(t,i){var r=parseInt(t.split("_LayerIndex_")[1].split("_")[0],10),u=parseInt(t.split("_shapeIndex_")[1].split("_")[0],10),f=this.layers[r].shapeData.features.length>u?this.layers[r].shapeData.features[u].properties:null,e=parseInt(t.split("_dataIndex_")[1].split("_")[0],10),o=n.isNullOrUndefined(e)?null:this.layers[r].dataSource[e];this.layers[r].selectionSettings.enable&&"keydown"===i&&this.selectionModule?(this.selectionModule.selectionsettings=this.layers[r].selectionSettings,this.selectionModule.selectionType="Shape",this.selectionModule.selectElement(event.target,r,o,f)):this.highlightModule&&this.layers[r].highlightSettings.enable&&"keyup"===i&&!event.target.classList.contains("ShapeselectionMapStyle")&&(this.highlightModule.highlightSettings=this.layers[r].highlightSettings,this.highlightModule.handleHighlight(event.target,r,o,f))},i.prototype.keyDownHandler=function(t){var i=this.zoomModule,r=t.target.id,f,u;("ArrowUp"===t.code||"ArrowDown"===t.code||"ArrowLeft"===t.code||"ArrowRight"===t.code)&&i&&(f=document.getElementById(this.element.id+"_animated_tiles"),this.isTileMap&&!n.isNullOrUndefined(f)&&(this.currentTiles=f.cloneNode(!0)));this.zoomSettings.enable&&i&&("+"===t.key||"Equal"===t.code)?i.performZoomingByToolBar("zoomin"):this.zoomSettings.enable&&i&&("-"===t.key||"Minus"===t.code)?i.performZoomingByToolBar("zoomout"):this.zoomSettings.enable&&i&&82===t.keyCode?(i.performZoomingByToolBar("reset"),i.isPanning=!1):this.zoomSettings.enable&&this.zoomSettings.enablePanning&&i&&("ArrowUp"===t.code||"ArrowDown"===t.code)?(t.preventDefault(),i.mouseDownLatLong.x=0,i.mouseMoveLatLong.y=this.mapAreaRect.height/7,i.panning("None",i.mouseDownLatLong.x,"ArrowUp"===t.code?-i.mouseMoveLatLong.y:i.mouseMoveLatLong.y,t),i.mouseDownLatLong.y=i.mouseMoveLatLong.y):this.zoomSettings.enable&&this.zoomSettings.enablePanning&&i&&("ArrowLeft"===t.code||"ArrowRight"===t.code)?(t.preventDefault(),i.mouseDownLatLong.y=0,i.mouseMoveLatLong.x=this.mapAreaRect.width/7,i.panning("None","ArrowLeft"===t.code?-i.mouseMoveLatLong.x:i.mouseMoveLatLong.x,i.mouseDownLatLong.y,t),i.mouseDownLatLong.x=i.mouseMoveLatLong.x):"Enter"===t.code&&((r=t.target.id,t.preventDefault(),this.legendModule&&(r.indexOf("_Left_Page_Rect")>-1||r.indexOf("_Right_Page_Rect")>-1))&&(this.mapAreaRect=this.legendModule.initialMapAreaRect,this.legendModule.currentPage=r.indexOf("_Left_Page_")>-1?this.legendModule.currentPage-1:this.legendModule.currentPage+1,this.legendModule.legendGroup=this.renderer.createGroup({id:this.element.id+"_Legend_Group"}),this.legendModule.drawLegendItem(this.legendModule.currentPage),u=document.getElementById(this.element.id+"_Paging_Text").textContent.split("/").map(Number),r.indexOf("_Left_Page_Rect")>-1?(1!==u[0]&&t.target.focus(),t.target.style.outlineColor=u[0]-1!==u[1]?"":"transparent"):r.indexOf("_Right_Page_Rect")>-1&&(u[0]!==u[1]&&t.target.focus(),t.target.style.outlineColor=u[0]!==u[1]+1?"":"transparent"),e(this.element.id+"_Legend_Border",this.element.id)&&(e(this.element.id+"_Legend_Border",this.element.id).style.pointerEvents="none")),r.indexOf("shapeIndex")>-1&&this.keyboardHighlightSelection(r,t.type));this.zoomModule&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,this.mouseMoveId)},i.prototype.SelectedElement=function(n){var t=!1;return"ShapeselectionMapStyle"===n.getAttribute("class")&&(t=!0),t},i.prototype.mapsOnClick=function(t){var e=this,i=t.target,f=i.id,o=null,s=null,u,r;(this.mouseClickEvent={x:t.x,y:t.y},-1===i.id.indexOf("_ToolBar"))&&(u=this.getClickLocation(f,t.pageX,t.pageY,i,t.layerX,t.layerY),n.isNullOrUndefined(u)||(o=u.latitude,s=u.longitude),r={cancel:!1,name:et,target:f,x:t.clientX,y:t.clientY,latitude:o,longitude:s,isShapeSelected:this.SelectedElement(i)},this.onclick?(r.name="onclick",this.trigger("onclick",r,function(){e.clickHandler(t,r,i)})):this.trigger("click",r,function(){e.clickHandler(t,r,i)}));this.zoomModule&&(this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.mapScaleValue,f),this.isDevice&&this.zoomModule.removeToolbarClass("","","","",""))},i.prototype.clickHandler=function(n,t,i){i.id.indexOf("shapeIndex")>-1&&(this.mergeCluster(),s(this.element.id+"_mapsTooltip")&&this.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&a(this.element.id+"_mapsTooltip"));this.markerModule&&this.markerModule.markerClusterClick(n);t.cancel||this.notify(et,i);t.cancel||-1===i.id.indexOf("shapeIndex")||this.triggerShapeSelection(i)},i.prototype.triggerShapeSelection=function(t){var r=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),i=function(t,i,r,u){var e=function(n,t){var r,f=parseInt(n.split("_LayerIndex_")[1].split("_")[0],10),e=parseInt(n.split("_shapeIndex_")[1].split("_")[0],10),i=t.layersCollection[f],u=i.layerData[e].property;return i.dataSource&&(r=i.dataSource[ht(i.dataSource,u,i.shapeDataPath,i.shapePropertyPath)]),{shapeData:u,data:r}}(t,r),o={color:i.border.color,opacity:i.border.opacity,width:i.border.width},f=i.enableMultiSelect?{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r,shapeDataCollection:r.shapeSelectionItem}:{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r};return r.trigger(u,f,function(){f.border.opacity=n.isNullOrUndefined(f.border.opacity)?f.opacity:f.border.opacity}),f}(t.id,this.layers[r].selectionSettings,this,"shapeSelected");i.cancel||!this.selectionModule||n.isNullOrUndefined(this.shapeSelected)?i.cancel&&this.selectionModule&&n.isNullOrUndefined(i.data)&&(c(t),this.selectionModule.removedSelectionList(t)):lt(this.selectionModule.selectionType+"selectionMap",this.selectionModule.selectionType+"selectionMapStyle",i)},i.prototype.getMarkerClickLocation=function(n,t,i,r,u,f){var o;document.getElementById(this.element.id+"_svg").style.cursor="grabbing";var h=s(u.targetId),e=this.getClickLocation(u.targetId,n,t,h,i,r),c=this.isTileMap?it(new k(e.longitude,e.latitude),this.scale,this.tileTranslatePoint,!0):p(e.latitude,e.longitude,this.mapLayerPanel.currentFactor,this.layersCollection[u.layerIndex],this),l=this.translatePoint,a=this.isTileMap?c.x:(c.x+l.x)*this.scale,v=this.isTileMap?c.y:(c.y+l.y)*this.scale;return("Balloon"!==this.markerDragArgument.shape?h.setAttribute("transform","translate( "+a+" "+v+" )"):h.parentElement.setAttribute("transform","translate( "+a+" "+v+" )"),f)&&(o=this.layers[u.layerIndex].markerSettings[u.markerIndex],e=this.getClickLocation(u.targetId,n-o.offset.x,t-o.offset.y,h,i-o.offset.x,r-o.offset.y)),e},i.prototype.getClickLocation=function(n,t,i,r,u,f){var e,h=0,v,y,p,o,s;if(-1===n.indexOf("_LayerIndex_")||this.isTileMap||parseInt(this.mouseDownEvent.x,10)!==parseInt(this.mouseClickEvent.x,10)||parseInt(this.mouseDownEvent.y,10)!==parseInt(this.mouseClickEvent.y,10))this.isTileMap&&parseInt(this.mouseDownEvent.x,10)===parseInt(this.mouseClickEvent.x,10)&&parseInt(this.mouseDownEvent.y,10)===parseInt(this.mouseClickEvent.y,10)&&(e=this.getTileGeoLocation(u,f));else if(h=parseFloat(n.split("_LayerIndex_")[1].split("_")[0]),"Normal"===this.layers[h].geometryType)if(n.indexOf("_shapeIndex_")>-1){var c=hi(t,i,r.parentElement),l=Math.abs(-this.baseMapBounds.longitude.min*this.mapLayerPanel.currentFactor),a=Math.abs(this.baseMapBounds.latitude.max*this.mapLayerPanel.currentFactor);e={latitude:Math.abs(this.baseMapBounds.latitude.max-c.y/this.mapLayerPanel.currentFactor),longitude:Math.abs(c.x/this.mapLayerPanel.currentFactor+this.baseMapBounds.longitude.min)};this.baseMapBounds.longitude.min<0&&l>c.x&&(e.longitude=-e.longitude);this.baseMapBounds.latitude.min<0&&a>c.y&&(e.latitude=-e.latitude)}else n.indexOf("_MarkerIndex_")>-1&&this.markerModule&&!this.markerDragArgument?(v=parseInt(n.split("_MarkerIndex_")[1].split("_")[0],10),y=parseInt(n.split("_dataIndex_")[1].split("_")[0],10),isNaN(v)||isNaN(y)?e={latitude:null,longitude:null}:(p=this.layers[h].markerSettings[v].dataSource[y],e={latitude:p.latitude,longitude:p.longitude})):n.indexOf("_MarkerIndex_")>-1&&this.markerModule&&this.markerDragArgument?(o=document.getElementById(this.element.id+"_LayerIndex_"+this.markerDragArgument.layerIndex).getBoundingClientRect(),s=new k(t>o.left?Math.abs(o.left-t):0,i>o.top?Math.abs(o.top-i):0),l=Math.abs(-this.baseMapBounds.longitude.min*this.mapLayerPanel.currentFactor),a=Math.abs(this.baseMapBounds.latitude.max*this.mapLayerPanel.currentFactor),e={latitude:Math.abs(this.baseMapBounds.latitude.max-s.y/(this.mapLayerPanel.currentFactor*this.scale)),longitude:Math.abs(s.x/(this.mapLayerPanel.currentFactor*this.scale)+this.baseMapBounds.longitude.min)},this.baseMapBounds.longitude.min<0&&l>s.x&&(e.longitude=-e.longitude),this.baseMapBounds.latitude.min<0&&a>s.y&&(e.latitude=-e.latitude)):e={latitude:null,longitude:null};else e=this.getGeoLocation(h,u,f);return e},i.prototype.removeTileMap=function(){var t=document.getElementById(this.element.id+"_animated_tiles"),i;if(!n.isNullOrUndefined(this.currentTiles)&&t.childElementCount<this.currentTiles.childElementCount)for(i=t.childElementCount-1;i>=this.currentTiles.childElementCount;i--)t.removeChild(t.children[i]);this.currentTiles=null},i.prototype.mouseEndOnMap=function(t){var u,f,s,h=t.target,v=h.id,c=0,l=0,o,i,r,e,a;return(this.element.getBoundingClientRect(),t.target,-1!==t.type.indexOf("touch")?(this.isTouch=!0,c=u=(s=t).changedTouches[0].pageX,l=(f=s.changedTouches[0].pageY)-(this.isTileMap?10:0),s.target,this.mouseClickEvent={x:u,y:f}):(this.isTouch="touch"===t.pointerType,u=t.pageX,f=t.pageY,c=t.layerX,l=t.layerY-(this.isTileMap?10:0),t.target),this.isTileMap&&this.removeTileMap(),this.isTouch)&&(-1===h.id.indexOf("_ToolBar")&&(o=this.getClickLocation(v,u,f,h,u,f),n.isNullOrUndefined(o)||(o.latitude,o.longitude)),this.titleTooltip(t,u,f,!0),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)),(this.notify(n.Browser.touchEndEvent,t),t.cancelable&&!this.isTouch&&t.preventDefault(),n.isNullOrUndefined(this.markerDragArgument))?document.getElementById(this.element.id+"_svg").style.cursor="auto":(i=this.markerDragArgument,this.mouseClickEvent.x=this.mouseDownEvent.x,this.mouseClickEvent.y=this.mouseDownEvent.y,o=this.getMarkerClickLocation(u,f,c,l,this.markerDragArgument,!0),r=this.layers[i.layerIndex].markerSettings[i.markerIndex],document.getElementById(this.element.id+"_svg").style.cursor=r.enableDrag?"pointer":"grabbing",e={name:"markerDragEnd",x:u,y:f,latitude:o.latitude,longitude:o.longitude,layerIndex:i.layerIndex,markerIndex:i.markerIndex,dataIndex:i.dataIndex},n.isNullOrUndefined(r.latitudeValuePath)&&n.isNullOrUndefined(r.longitudeValuePath)?(a=r.dataSource[i.dataIndex],n.isNullOrUndefined(a.Longitude)||n.isNullOrUndefined(a.Latitude)?(r.dataSource[i.dataIndex].latitude=e.latitude,r.dataSource[i.dataIndex].longitude=e.longitude):(r.dataSource[i.dataIndex].Latitude=e.latitude,r.dataSource[i.dataIndex].Longitude=e.longitude)):(r.dataSource[i.dataIndex][r.latitudeValuePath]=e.latitude,r.dataSource[i.dataIndex][r.longitudeValuePath]=e.longitude),this.markerDragId="",this.markerDragArgument=null,this.trigger("markerDragEnd",e)),this.zoomModule&&this.isDevice&&(this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.scale,this.element.id+"_Zooming_"),this.zoomModule.removeToolbarClass("","","","","")),!1},i.prototype.mouseDownOnMap=function(t){var i,u,r;this.mouseDownEvent={x:t.x,y:t.y};-1!==t.type.indexOf("touch")&&t.changedTouches&&(this.mouseDownEvent={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY});this.isDevice&&this.mapsTooltipModule.renderTooltip(t);this.element.getBoundingClientRect();i=t.target;this.markerDragId=i.id;u=document.getElementById(this.element.id+"_animated_tiles");(this.isTileMap&&!n.isNullOrUndefined(u)&&(this.currentTiles=u.cloneNode(!0)),-1===i.id.indexOf("_ToolBar"))&&(r=this.markerModule,(i.id.indexOf("shapeIndex")>-1||i.id.indexOf("Tile")>-1)&&this.mergeCluster(),r&&(r.markerClick(t),r.markerClusterClick(t)),this.bubbleModule&&this.bubbleModule.bubbleClick(t));this.notify(n.Browser.touchStartEvent,t)},i.prototype.mergeCluster=function(){this.markerModule&&this.markerModule.sameMarkerData.length>0&&(!this.zoomModule||this.zoomModule.isSingleClick)&&(or(this.markerModule.sameMarkerData,this,s(this.element.id+"_Markers_Group")),this.markerModule.sameMarkerData=[])},i.prototype.mapsOnRightClick=function(t){var r=t.target,u=r.id,f=null,e=null,i,o;(this.mouseClickEvent=this.mouseDownEvent={x:t.x,y:t.y},-1===r.id.indexOf("_ToolBar"))&&(i=this.getClickLocation(u,t.pageX,t.pageY,r,t.layerX,t.layerY),n.isNullOrUndefined(i)||(f=i.latitude,e=i.longitude),o={cancel:!1,name:"rightClick",target:u,x:t.clientX,y:t.clientY,latitude:f,longitude:e,isShapeSelected:!1},this.trigger("rightClick",o))},i.prototype.mapsOnDoubleClick=function(n){var e;this.notify("dblclick",n);var t,i=n.target,o=i.id,f=0,r=null,u=null;-1===i.id.indexOf("_ToolBar")&&(-1===i.id.indexOf("_LayerIndex_")||this.isTileMap||this.mouseDownEvent.x!==n.clientX||this.mouseDownEvent.y!==n.clientY?this.isTileMap&&this.mouseDownEvent.x===n.clientX&&this.mouseDownEvent.y===n.clientY&&(r=(t=this.getTileGeoLocation(n.layerX,n.layerY)).latitude,u=t.longitude):(f=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),r=(t=this.getGeoLocation(f,n.layerX,n.layerY)).latitude,u=t.longitude),e={cancel:!1,name:"doubleClick",x:n.clientX,y:n.clientY,target:o,latitude:r,longitude:u,isShapeSelected:null},this.trigger("doubleClick",e))},i.prototype.mouseMoveOnMap=function(t){var i;i="touchmove"===t.type?t.target:i=t.target;this.markerModule&&(this.markerModule.markerMove(t),this.markerModule.markerClusterMouseMove(t));this.bubbleModule&&this.bubbleModule.bubbleMove(t);-1==i.id.indexOf("MarkerIndex")&&(document.getElementById(this.element.id+"_svg").style.cursor="auto");this.onMouseMove(t);this.notify(n.Browser.touchMoveEvent,t)},i.prototype.onMouseMove=function(t){var i,r,s=t.target,o;this.mouseMoveId=s.id;var e=null,u=0,f=0;return(-1==t.type.indexOf("touch")?(i=t.pageX,r=t.pageY,u=t.layerX,f=t.layerY-(this.isTileMap?10:0),this.titleTooltip(t,t.pageX,t.pageY),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)):(u=i=(e=t.touches)[0].clientX,f=r=e[0].clientY-(this.isTileMap?10:0)),n.isNullOrUndefined(this.markerDragArgument))||(o=this.markerDragArgument,this.mouseClickEvent.x=this.mouseDownEvent.x,this.mouseClickEvent.y=this.mouseDownEvent.y,this.getMarkerClickLocation(i,r,u,f,o,!1)),this.zoomModule&&this.zoomModule.removeToolbarOpacity(this.isTileMap?Math.round(this.tileZoomLevel):this.scale,t.target.id),!1},i.prototype.legendTooltip=function(n,t,i,r){var h,c,e=n.target.id,o=this.legendModule.currentPage,u=n.target.id.split("_Index_")[1],l,f;for(o=this.legendModule.totalPages.length<=this.legendModule.currentPage?this.legendModule.totalPages.length-1:this.legendModule.currentPage<0?0:this.legendModule.currentPage,l=0!==this.legendModule.totalPages.length?this.legendModule.totalPages[o].Collection.length:this.legendModule.totalPages.length,f=0;f<l;f++)h=(c=this.legendModule.totalPages[o].Collection[f]).DisplayText,e=n.target.id,u=n.target.id.split("_Index_")[1],e===this.element.id+"_Legend_Text_Index_"+u&&n.target.textContent.indexOf("...")>-1&&c.idIndex===parseInt(u,10)&&pi(h,this.legendSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Legend_Text_Tooltip",s(this.element.id+"_Secondary_Element"),r);e!==this.element.id+"_Legend_Text_Index_"+u&&a(this.element.id+"_EJ2_Legend_Text_Tooltip")},i.prototype.titleTooltip=function(n,t,i,r){var u=n.target.id;u===this.element.id+"_LegendTitle"&&n.target.textContent.indexOf("...")>-1?pi(this.legendSettings.title.text,this.legendSettings.titleStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_LegendTitle_Tooltip",s(this.element.id+"_Secondary_Element"),r):a(this.element.id+"_EJ2_LegendTitle_Tooltip");u===this.element.id+"_Map_title"&&n.target.textContent.indexOf("...")>-1?pi(this.titleSettings.text,this.titleSettings.textStyle.size||this.themeStyle.titleFontSize,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Title_Tooltip",s(this.element.id+"_Secondary_Element"),r):a(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.mapsOnResize=function(){var t=this,i;return this.isDestroyed||this.isExportInitialTileMap||(this.isResize=this.isReset=!0,i={cancel:!1,name:vu,previousSize:this.availableSize,currentSize:nr(this),maps:this},this.trigger(vu,i),i.cancel||(this.resizeTo&&clearTimeout(this.resizeTo),!n.isNullOrUndefined(this.element)&&this.element.classList.contains("e-maps")&&(this.resizeTo=setTimeout(function(){t.unWireEVents();t.createSVG();t.refreshing=!0;t.wireEVents();t.render();t.refreshing=!1},500)))),!1},i.prototype.zoomByPosition=function(t,i){if(!this.isDestroyed){this.zoomNotApplied=!1;var r=this.zoomSettings.zoomFactor===i;!this.isTileMap&&this.zoomModule?n.isNullOrUndefined(t)?(this.zoomSettings.zoomFactor=i,this.isZoomByPosition=!0,this.mapScaleValue=null):(this.zoomSettings.zoomFactor=i,r=this.centerPosition.latitude===t.latitude&&this.centerPosition.longitude===t.longitude||r,this.centerPosition=t,this.isZoomByPosition=!0,this.mapScaleValue=null):this.zoomModule&&(this.tileZoomLevel=this.zoomSettings.zoomFactor=i,r=this.centerPosition.latitude===t.latitude&&this.centerPosition.longitude===t.longitude||r,this.centerPosition=t,this.isZoomByPosition=!0);r&&this.refresh()}},i.prototype.panByDirection=function(n,t){if(!this.isDestroyed){var i=0,r=0;switch(n){case"Left":i=-this.mapAreaRect.width/7;break;case"Right":i=this.mapAreaRect.width/7;break;case"Top":r=-this.mapAreaRect.height/7;break;case"Bottom":r=this.mapAreaRect.height/7}this.zoomModule&&this.zoomModule.panning(n,i,r,t)}},i.prototype.addLayer=function(n){if(!this.isDestroyed){var t=this.layers;t.push(n);this.isAddLayer=!0;this.layers=t}},i.prototype.removeLayer=function(n){if(!this.isDestroyed){var t=this.layers;t.splice(n,1);this.layers=t}},i.prototype.addMarker=function(n,t){var r,i,u,f;if(!this.isDestroyed&&(r=document.getElementById(this.element.id+"_LayerIndex_"+n),t.length>0&&r)){for(i=0,u=t;i<u.length;i++)f=u[i],this.layersCollection[n].markerSettings.push(new lu(this,"markerSettings",f));new au(this).markerRender(this,r,n,this.mapLayerPanel.currentFactor,"AddMarker");this.arrangeTemplate()}},i.prototype.shapeSelection=function(t,i,r,u){var o,e,h,y,nt,k;if(!this.isDestroyed){var f=void 0,d=void 0,a=Array.isArray(i)?i:Array(i);if(n.isNullOrUndefined(u)&&(u=!0),o=this.layers[t].selectionSettings,!o.enableMultiSelect&&this.legendSelection&&u&&this.removeShapeSelection(),"SubLayer"===this.layers[t].type)for(e=0;e<this.layersCollection.length;e++)if(this.layersCollection[e].shapeData===this.layers[t].shapeData){d=e;break}if(o.enable){var p=void 0,w=void 0,b=void 0,g=void 0,v=void 0,l=this.layers[t].shapeData.features;for(e=0;e<l.length;e++)for(h=0;h<a.length;h++)if(y=void 0,(!n.isNullOrUndefined(l[e].properties[a[h]])&&isNaN(l[e].properties[a[h]])?l[e].properties[a[h]].toLowerCase():l[e].properties[a[h]])===(n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toLowerCase()))if(n.isNullOrUndefined(this.layers[t].shapeSettings.colorValuePath)||(y=ht(this.layers[t].dataSource,l[e].properties,this.layers[t].shapeDataPath,this.layers[t].shapePropertyPath,this.layers[t])),nt=this.layers[t],this.baseLayerIndex>=0&&nt.isBaseLayer?b=0:"SubLayer"===this.layers[t].type&&(b=d),f=s(this.element.id+"_LayerIndex_"+b+"_shapeIndex_"+e+"_dataIndex_"+y),n.isNullOrUndefined(y)&&n.isNullOrUndefined(f)&&(f=s(this.element.id+"_LayerIndex_"+t+"_shapeIndex_"+e+"_dataIndex_null")),w=parseInt(f.id.split("_shapeIndex_")[1].split("_")[0],10),g=this.layers[t].shapeData.features.length>w?this.layers[t].shapeData.features[w].properties:null,p=parseInt(f.id.split("_dataIndex_")[1].split("_")[0],10),v=n.isNullOrUndefined(p)?null:this.layers[t].dataSource[p],u){if(yf(o,this,f,g,v),this.shapeSelectionClass=s("ShapeselectionMap"),this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&this.legendModule.shapeHighLightAndSelection(f,v,o,"selection",t),(!this.legendSettings.visible||this.legendModule.shapeToggled)&&(f.setAttribute("class","ShapeselectionMapStyle"),-1===this.selectedElementId.indexOf(f.getAttribute("id"))&&this.selectedElementId.push(f.getAttribute("id")),!o.enableMultiSelect))return}else(this.legendSelection=!o.enableMultiSelect&&!this.legendSelection||this.legendSelection,this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&"ShapeselectionMapStyle"===f.getAttribute("class")&&this.legendModule.shapeHighLightAndSelection(f,v,o,"selection",t),!this.legendSettings.visible||this.legendModule.shapeToggled)&&(c(f),k=this.selectedElementId.indexOf(f.getAttribute("id")),-1!==k&&(this.selectedElementId.splice(k,1),!o.enableMultiSelect&&this.legendSelection&&this.selectedElementId.length>0&&this.removeShapeSelection()))}}},i.prototype.zoomToCoordinates=function(t,i,r,u){var o,s,c;if(!this.isDestroyed){var f=void 0,e=void 0,h=!1;this.centerPosition={latitude:null,longitude:null};this.isZoomByPosition=!1;(n.isNullOrUndefined(r)&&n.isNullOrUndefined(u)||n.isNullOrUndefined(t)&&n.isNullOrUndefined(i))&&(t=n.isNullOrUndefined(t)?0:t,i=n.isNullOrUndefined(t)?0:i,r=n.isNullOrUndefined(r)?t:r,u=n.isNullOrUndefined(u)?i:u,h=!0);t>r&&(t=(o=[r,t])[0],r=o[1]);i>u&&(i=(s=[u,i])[0],u=s[1]);h?(f=t+r,e=i+u):(f=(t+r)/2,e=(i+u)/2);this.centerLatOfGivenLocation=f;this.centerLongOfGivenLocation=e;this.minLatOfGivenLocation=t;this.minLongOfGivenLocation=i;this.maxLatOfGivenLocation=r;this.maxLongOfGivenLocation=u;this.zoomNotApplied=!0;this.scaleOfGivenLocation=su(t,r,i,u,this.mapAreaRect.width,this.mapAreaRect.height,this,!0);c={cancel:!1,name:"zoom",type:"zoomIn",maps:this,tileTranslatePoint:{},translatePoint:{},tileZoomLevel:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{},scale:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{previous:this.scale,current:this.scaleOfGivenLocation}};this.trigger("zoom",c);this.refresh()}},i.prototype.removeShapeSelection=function(){for(var i,t=this.selectedElementId.length,n=0;n<t;n++)c(r(this.selectedElementId[0])),this.selectedElementId.splice(0,1);if(this.legendSettings.visible)for(i=this.legendSelectionCollection.length,n=0;n<i;n++)c(r(this.legendSelectionCollection[n].legendElement.id)),this.selectedLegendElementId.splice(0,1);this.shapeSelectionItem=[];this.legendSelectionCollection=[]},i.prototype.setCulture=function(){this.intl=new n.Internationalization;this.setLocaleConstants();this.localeObject=new n.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},i.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset",ImageNotFound:"Image Not Found"}},i.prototype.destroy=function(){this.unWireEVents();n.isNullOrUndefined(this.mapsTooltipModule)||this.mapsTooltipModule.removeEventListener();t.prototype.destroy.call(this);this.shapeSelectionItem=[];this.toggledShapeElementId=[];this.toggledLegendId=[];this.legendSelectionCollection=[];this.selectedLegendElementId=[];this.selectedNavigationElementId=[];this.selectedBubbleElementId=[];this.selectedMarkerElementId=[];this.selectedElementId=[];this.dataLabelShape=[];this.zoomShapeCollection=[];this.zoomLabelPositions=[];this.mouseDownEvent={x:null,y:null};this.mouseClickEvent={x:null,y:null};this.formatFunction=null;this.availableSize=new w(0,0);document.getElementById("mapsmeasuretext")&&document.getElementById("mapsmeasuretext").remove();this.removeSvg()},i.prototype.getModuleName=function(){return"maps"},i.prototype.getPersistData=function(){return this.addOnPersist(["translatePoint","zoomSettings","mapScaleValue","tileTranslatePoint","baseTranslatePoint","scale","zoomPersistence","defaultState","markerZoomedState","initialCheck","initialZoomLevel","initialTileTranslate","applyZoomReset","markerZoomFactor"])},i.prototype.onPropertyChanged=function(i,r){var w,e,h,c,b,u,o,l,s;if(!this.isDestroyed){var f=!1,v=!1,y=!1,p=!1;for(i.layers&&(w=Object.keys(i.layers).length,document.getElementById(this.element.id+"_LayerIndex_"+(w-1))),e=0,h=Object.keys(i);e<h.length;e++){c=h[e];switch(c){case"background":this.renderBorder();break;case"height":case"width":case"layers":case"projectionType":case"centerPosition":case"legendSettings":case"baseLayerIndex":if("layers"===c)for(y=!0,b=Object.keys(i.layers).length,u=0;u<b;u++)if(!n.isNullOrUndefined(i.layers[u]))for(o=0,l=Object.keys(i.layers[u]);o<l.length;o++)s=l[o],"layerType"===s&&"Geometry"!==i.layers[u].layerType||n.isNullOrUndefined(this.layers[u].shapeData)&&!n.isNullOrUndefined(this.layers[u].urlTemplate)&&""!==this.layers[u].urlTemplate?this.isReset=!0:"markerSettings"===s?v=!0:"staticMapType"===s&&(p=!0);f=!0;break;case"zoomSettings":n.isNullOrUndefined(r.zoomSettings)||(i.zoomSettings.zoomFactor===r.zoomSettings.zoomFactor||y?i.zoomSettings.shouldZoomInitially!==r.zoomSettings.shouldZoomInitially||i.zoomSettings.enable!==r.zoomSettings.enable?(this.zoomSettings.zoomFactor=1,f=!0):f=!0:f=!1);break;case"locale":case"currencyCode":t.prototype.refresh.call(this)}}f&&(i.layers&&v?(a(this.element.id+"_Markers_Group"),this.isTileMap?this.mapLayerPanel.renderTileLayer(this.mapLayerPanel,this.layers.currentFactor,this.layers.length-1):this.render()):i.layers&&p?this.mapLayerPanel.renderGoogleMap(this.layers[this.layers.length-1].key,this.staticMapZoom):(this.createSVG(),this.renderElements()))}},i.prototype.requiredModules=function(){var n=[],t=this.findVisibleLayers(this.layers),i=!1;return this.annotations.map(function(n){i=null!=n.content}),this.isBubbleVisible()&&n.push({member:"Bubble",args:[this]}),t.highlight&&n.push({member:"Highlight",args:[this]}),t.selection&&n.push({member:"Selection",args:[this]}),this.legendSettings.visible&&n.push({member:"Legend",args:[this]}),(this.zoomSettings.enable||this.zoomSettings.zoomFactor>this.zoomSettings.minZoom)&&n.push({member:"Zoom",args:[this]}),this.isMarkersVisible()&&n.push({member:"Marker",args:[this]}),this.isDataLabelVisible()&&n.push({member:"DataLabel",args:[this]}),this.isNavigationVisible()&&n.push({member:"NavigationLine",args:[this]}),t.tooltip&&n.push({member:"MapsTooltip",args:[this]}),i&&n.push({member:"Annotations",args:[this,cf]}),this.allowPrint&&n.push({member:"Print",args:[this]}),this.allowImageExport&&n.push({member:"ImageExport",args:[this]}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this]}),n},i.prototype.isMarkersVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.markerSettings.length;i++)if(t.markerSettings[i].visible){n=!0;break}}),n},i.prototype.isDataLabelVisible=function(){for(var t=!1,n=0;n<this.layers.length;n++)if(this.layers[n].dataLabelSettings.visible){t=!0;break}return t},i.prototype.isNavigationVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.navigationLineSettings.length;i++)if(t.navigationLineSettings[i].visible){n=!0;break}}),n},i.prototype.isBubbleVisible=function(){for(var r,t=!1,n=0,i=this.layers;n<i.length;n++)if(r=i[n],this.getBubbleVisible(r)){t=!0;break}return t},i.prototype.getBubbleVisible=function(n){for(var i=!1,t=0,r=n.bubbleSettings;t<r.length;t++)if(r[t].visible){i=!0;break}return i},i.prototype.print=function(n){this.allowPrint&&this.printModule&&!this.isDestroyed&&this.printModule.print(this,n)},i.prototype.export=function(t,i,r,u){var f=this;if(!this.isDestroyed){if(n.isNullOrUndefined(u)&&(u=!0),"PDF"!==t&&this.allowImageExport&&this.imageExportModule)return new Promise(function(n){n(f.imageExportModule.export(f,t,i,u))});if(this.allowPdfExport&&this.pdfExportModule)return new Promise(function(n){n(f.pdfExportModule.export(f,t,i,u,r))})}return null},i.prototype.getBingUrlTemplate=function(t){var i;return this.isDestroyed||(i=new Promise(function(i){var r=new n.Fetch({url:t});r.onSuccess=function(n){var t=n.resourceSets[0].resources[0];i(t.imageUrl)};r.send()})),i},i.prototype.findVisibleLayers=function(n,t,i,r,u,f){var k,d,h,y,e,c,p,l,a,w,o,v,b,s;for(void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),void 0===f&&(f=!1),h=0,y=n;h<y.length;h++){if(e=y[h],t=e.visible||t,e.visible){for(k=e.bubbleSettings,d=e.markerSettings,c=0,p=e.navigationLineSettings;c<p.length;c++)l=p[c],l.visible&&(u=l.highlightSettings.enable||u,f=l.selectionSettings.enable||f);for(a=0,w=d;a<w.length;a++)if(o=w[a],o.visible&&(r=o.tooltipSettings.visible||r,u=o.selectionSettings.enable||u,f=o.highlightSettings.enable||f),r)break;for(v=0,b=k;v<b.length;v++)if(s=b[v],s.visible&&(r=s.tooltipSettings.visible||r,u=s.selectionSettings.enable||u,f=s.highlightSettings.enable||f),r)break;r=e.tooltipSettings.visible||r;u=e.selectionSettings.enable||u;f=e.highlightSettings.enable||f}if(t&&i&&r)break}return{layer:t,bubble:i,tooltip:r,selection:u,highlight:f}},i.prototype.getGeoLocation=function(t,i,r){var f=0,e=0;if(!this.isDestroyed){var o=document.getElementById(this.element.id),h=i-(n.isNullOrUndefined(this.markerDragArgument)?o.offsetLeft:0),c=r-(n.isNullOrUndefined(this.markerDragArgument)?o.offsetTop:0),s=ut(this,this.layersCollection[t],!1).location,l=s.x*this.scale,a=s.y*this.scale,u=Math.min(this.mapAreaRect.height,this.mapAreaRect.width)*this.mapLayerPanel.currentFactor*this.scale,v=this.clip(h-l,0,u-1)/u-.5,y=.5-this.clip(c-a,0,u-1)/u;f=90-360*Math.atan(Math.exp(2*-y*Math.PI))/Math.PI;e=360*v}return{latitude:f,longitude:e}},i.prototype.clip=function(n,t,i){return Math.min(Math.max(n,t),i)},i.prototype.getTileGeoLocation=function(t,i){var r=0,u=0;if(!this.isDestroyed){var f=document.getElementById(this.element.id),e=document.getElementById(this.element.id+"_tile_parent"),o=this.pointToLatLong(t+this.mapAreaRect.x-(e.offsetLeft-(n.isNullOrUndefined(this.markerDragArgument)?f.offsetLeft:0)),i+this.mapAreaRect.y-(e.offsetTop-(n.isNullOrUndefined(this.markerDragArgument)?f.offsetTop:0)));r=o.latitude;u=o.longitude}return{latitude:r,longitude:u}},i.prototype.pointToLatLong=function(n,t){var r=0,u=0;if(!this.isDestroyed){t+="GoogleStaticMap"===this.layers[this.layers.length-1].layerType?0:10;var i=256*Math.pow(2,this.tileZoomLevel),f=this.clip(n-this.translatePoint.x*this.scale,0,i-1)/i-.5,e=.5-this.clip(t-this.translatePoint.y*this.scale,0,i-1)/i;r=90-360*Math.atan(Math.exp(2*-e*Math.PI))/Math.PI;u=360*f}return{latitude:r,longitude:u}},u([n.Property(null)],i.prototype,"background",void 0),u([n.Property(!1)],i.prototype,"useGroupingSeparator",void 0),u([n.Property(null)],i.prototype,"format",void 0),u([n.Property(null)],i.prototype,"width",void 0),u([n.Property(null)],i.prototype,"height",void 0),u([n.Property("MouseMove")],i.prototype,"tooltipDisplayMode",void 0),u([n.Property(!1)],i.prototype,"allowPrint",void 0),u([n.Property(!1)],i.prototype,"allowImageExport",void 0),u([n.Property(!1)],i.prototype,"allowPdfExport",void 0),u([n.Complex({},le)],i.prototype,"titleSettings",void 0),u([n.Complex({},ae)],i.prototype,"zoomSettings",void 0),u([n.Complex({},ve)],i.prototype,"legendSettings",void 0),u([n.Collection([],we)],i.prototype,"layers",void 0),u([n.Collection([],kf)],i.prototype,"annotations",void 0),u([n.Complex({},re)],i.prototype,"margin",void 0),u([n.Complex({color:"#DDDDDD",width:0},d)],i.prototype,"border",void 0),u([n.Property("Material")],i.prototype,"theme",void 0),u([n.Property("Mercator")],i.prototype,"projectionType",void 0),u([n.Property(0)],i.prototype,"baseLayerIndex",void 0),u([n.Property(null)],i.prototype,"description",void 0),u([n.Property(1)],i.prototype,"tabIndex",void 0),u([n.Complex({latitude:null,longitude:null},ie)],i.prototype,"centerPosition",void 0),u([n.Complex({},ke)],i.prototype,"mapsArea",void 0),u([n.Event()],i.prototype,"load",void 0),u([n.Event()],i.prototype,"beforePrint",void 0),u([n.Event()],i.prototype,"loaded",void 0),u([n.Event()],i.prototype,"click",void 0),u([n.Event()],i.prototype,"onclick",void 0),u([n.Event()],i.prototype,"doubleClick",void 0),u([n.Event()],i.prototype,"rightClick",void 0),u([n.Event()],i.prototype,"resize",void 0),u([n.Event()],i.prototype,"tooltipRender",void 0),u([n.Event()],i.prototype,"legendRendering",void 0),u([n.Event()],i.prototype,"tooltipRenderComplete",void 0),u([n.Event()],i.prototype,"shapeSelected",void 0),u([n.Event()],i.prototype,"itemSelection",void 0),u([n.Event()],i.prototype,"itemHighlight",void 0),u([n.Event()],i.prototype,"shapeHighlight",void 0),u([n.Event()],i.prototype,"layerRendering",void 0),u([n.Event()],i.prototype,"shapeRendering",void 0),u([n.Event()],i.prototype,"markerRendering",void 0),u([n.Event()],i.prototype,"markerClusterRendering",void 0),u([n.Event()],i.prototype,"markerClick",void 0),u([n.Event()],i.prototype,"markerDragStart",void 0),u([n.Event()],i.prototype,"markerDragEnd",void 0),u([n.Event()],i.prototype,"markerClusterClick",void 0),u([n.Event()],i.prototype,"markerClusterMouseMove",void 0),u([n.Event()],i.prototype,"markerMouseMove",void 0),u([n.Event()],i.prototype,"dataLabelRendering",void 0),u([n.Event()],i.prototype,"bubbleRendering",void 0),u([n.Event()],i.prototype,"bubbleClick",void 0),u([n.Event()],i.prototype,"bubbleMouseMove",void 0),u([n.Event()],i.prototype,"animationComplete",void 0),u([n.Event()],i.prototype,"annotationRendering",void 0),u([n.Event()],i.prototype,"zoom",void 0),u([n.Event()],i.prototype,"pan",void 0),u([n.NotifyPropertyChanges],i)}(n.Component),to=function(){function t(n){this.id="";this.maps=n;this.bubbleCollection=[]}return t.prototype.renderBubble=function(t,i,r,u,f,e,s,h,c,l){var ot,pt,y=this,g=h.layerData,nt=t.colorValuePath,ii=n.isNullOrUndefined(nt)?i[nt]:nt.indexOf(".")>-1?o(i,t.colorValuePath):i[nt],ri=n.isNullOrUndefined(nt)?Number(i[nt]):nt.indexOf(".")>-1?Number(o(i,t.colorValuePath)):Number(i[nt]),ui=n.isNullOrUndefined(t.valuePath)?Number(i[t.valuePath]):t.valuePath.indexOf(".")>-1?Number(o(i,t.valuePath)):Number(i[t.valuePath]),rt,wt,fi,st,ei,bt,w,it,p,tt,ft,dt,lt,et;if(isNaN(ui)&&isNaN(ri)&&n.isNullOrUndefined(ii))return null;w=(rt=t.minRadius,wt=t.maxRadius,fi=ui,st=u.min,bt=(wt-rt)/100*100/((ei=u.max)-st)*(fi-st)+rt,ei===st&&(bt=(wt-rt)/100+rt),bt);it=new hf(this.maps).getColorByValue(t.colorMapping,ri,ii);pt="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.fill)?r:it.fill;ot="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.opacity)?t.opacity:it.opacity;p=[[]];this.maps.translateType="bubble";for(var kt=0,ht=0,ct=0,d=0,hi=g.length;d<hi;d++)if(tt=g[d],tt=tt.property,ft=ti(i[h.shapeDataPath],h.shapePropertyPath,tt),(!n.isNullOrUndefined(i[h.shapeDataPath])&&isNaN(i[h.shapeDataPath])?i[h.shapeDataPath].toLowerCase():i[h.shapeDataPath])===(!n.isNullOrUndefined(tt[ft])&&isNaN(tt[ft])?tt[ft].toLowerCase():tt[ft])&&"LineString"!==g[d].type&&"MultiLineString"!==g[d].type&&"Point"!==g[d].type&&"MultiPoint"!==g[d].type)if(g[d]._isMultiPolygon)for(dt=g[d],lt=0;lt<dt.length;lt++)p.push(this.getPoints(dt[lt],[])),ht<(ct=p[p.length-1].length)&&(ht=ct,kt=p.length-1);else p.push(this.getPoints(g[d],[])),ht<(ct=p[p.length-1].length)&&(ht=ct,kt=p.length-1);var oi,a,ci=this.maps.projectionType,si={color:t.border.color,opacity:t.border.opacity,width:t.border.width},vt=yi(p[kt],ci,h.geometryType);if(t.visible){if(n.isNullOrUndefined(vt)){if(et=p.length-1,!p[et].x||!p[et].y)return;a={cancel:!1,name:tf,border:si,cx:p[et].x,cy:p[et].y,data:i,fill:pt,maps:this.maps,radius:w}}else oi="Mercator"===this.maps.projectionType?vt.y:-vt.y,a={cancel:!1,name:tf,border:si,cx:vt.x,cy:oi,data:i,fill:pt,maps:this.maps,radius:w};this.maps.trigger("bubbleRendering",a,function(){var i,u,p,d,g,o,it;if(!a.cancel){(a.border.opacity=n.isNullOrUndefined(a.border.opacity)?ot:a.border.opacity,"Circle"===t.bubbleType)?(p=new at(l,a.fill,a.border,ot,0,0,a.radius,null),i=function(n,t,i){return ni(n.renderer.drawCircle(t),i)}(y.maps,p,c)):(d="Mercator"===y.maps.projectionType?a.cy-w:a.cy+w,g=new b(l,a.fill,a.border,ot,new v(0,0,2*w,2*w),2,2),a.cx-=w,a.cy=d,i=function(n,t,i){return ni(n.renderer.drawRectangle(t),i)}(y.maps,g,c));gt(y.maps.selectedBubbleElementId,y.maps.bubbleSelectionClass,i,"BubbleselectionMapStyle");y.bubbleCollection.push({LayerIndex:s,BubbleIndex:f,DataIndex:e,element:i,center:{x:a.cx,y:a.cy}});o=0!==h.animationDuration||n.isNullOrUndefined(y.maps.zoomModule);u=y.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(y.maps.zoomModule)&&!y.maps.isTileMap?yt(y.maps,h,o):ut(y.maps,h,o);var rt=t.dataSource,nt=u.scale,tt=u.location,r=new k(y.maps.isTileMap?(a.cx+y.maps.translatePoint.x)*y.maps.tileZoomLevel:(a.cx+tt.x)*nt,y.maps.isTileMap?(a.cy+y.maps.translatePoint.y)*y.maps.tileZoomLevel:(a.cy+tt.y)*nt);i.setAttribute("transform","translate( "+r.x+" "+r.y+" )");it=rt.length-1===e?"bubble":null;"Square"===t.bubbleType?(r.x+=w,r.y+=w*("Mercator"===y.maps.projectionType?1:-1)):w=0;t.animationDuration>0&&wr(i,t.animationDelay,t.animationDuration,r,y.maps,it,w)}})}},t.prototype.getPoints=function(t,i){return n.isNullOrUndefined(t.map)?i=t.point:t.map(function(n){i.push(new f(n.point.x,n.point.y))}),i},t.prototype.bubbleClick=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:rf,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(rf,u)))},t.prototype.getbubble=function(n){var t=n.split("_LayerIndex_"),u=parseInt(t[1].split("_")[0],10),f=this.maps.layers[u],i,r;return n.indexOf("_BubbleIndex_")>-1&&(i=parseInt(t[1].split("_BubbleIndex_")[1],10),r=parseInt(t[1].split("_BubbleIndex_")[1].split("_dataIndex_")[1],10),!isNaN(i))?f.bubbleSettings[i].dataSource[r]:null},t.prototype.bubbleMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:uf,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(uf,u)))},t.prototype.getModuleName=function(){return"Bubble"},t.prototype.destroy=function(){this.bubbleCollection=[]},t}(),io=function(){function t(n){this.value={rightWidth:0,leftWidth:0,heightTop:0,heightBottom:0};this.maps=n;this.dataLabelCollections=[]}return t.prototype.getDataLabel=function(t,i,r,u){for(var o,f,s,e=0;e<t.length;e++)if(f=t[e],s=!n.isNullOrUndefined(f[u])&&isNaN(f[u])&&"string"==typeof f[u]?f[u].toLowerCase():f[u],r=n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toString(),s===(n.isNullOrUndefined(r)||"string"!=typeof r?r:r.toLowerCase())){o=f;break}return o},t.prototype.renderLabel=function(t,i,r,u,e,o,s,h){var ui,ct,wt,k,fi,a,ei,li,c=this,lt=t.dataLabelSettings,d=t.dataLabelSettings.textStyle,ot=t.dataLabelSettings,dt=t.dataLabelSettings.labelPath,it=[[]],gt=0,ni=0,ft=r,y="",ti=0,oi=!1,di=r.properties,at=this.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_LabelIndex_"+s,nt=new f(0,0),ai=u[s],ht,ci,bt,kt,w;d.fontFamily="material"!==this.maps.theme.toLowerCase()?this.maps.themeStyle.labelFontFamily:d.fontFamily;d.fontWeight=d.fontWeight||this.maps.themeStyle.fontWeight||rt.dataLabelFont.fontWeight;r=ai.property;var si,vi,hi="[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)?t.shapePropertyPath:[t.shapePropertyPath],pi=0!==t.animationDuration||n.isNullOrUndefined(this.maps.zoomModule),wi=this.maps.isTileMap?{}:this.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.maps.zoomModule)?yt(this.maps,t,pi):ut(this.maps,t,pi),p=this.maps.isTileMap?this.maps.scale:wi.scale,et=this.maps.isTileMap?this.maps.translatePoint:wi.location,ri=this.maps.zoomTranslatePoint,vt=n.isNullOrUndefined(this.maps.scale)?1:Math.floor(this.maps.scale),pt=this.maps.zoomSettings.enable?!n.isNullOrUndefined(this.maps.zoomShapeCollection)&&this.maps.zoomShapeCollection.length>0&&!this.maps.isAddLayer:this.maps.zoomSettings.enable;for(this.maps.translateType="labels",ht=0;ht<hi.length&&!(di[hi[ht]]&&(si=hi[ht],k=this.getDataLabel(t.dataSource,t.shapeDataPath,ft.properties[si],t.shapeDataPath)));ht++);if(k=this.getDataLabel(t.dataSource,t.shapeDataPath,ft.properties[si],t.shapeDataPath),!n.isNullOrUndefined(ai.property))if(it=[[]],u[s]._isMultiPolygon||"Point"===u[s].type||"MultiPoint"===u[s].type){if("Point"!==u[s].type&&"MultiPoint"!==u[s].type)for(ci=u[s],ht=0;ht<ci.length;ht++)it.push(this.getPoint(ci[ht],[])),ni<(ti=it[it.length-1].length)&&(ni=ti,gt=it.length-1)}else it.push(this.getPoint(u[s],[])),ni<(ti=it[it.length-1].length)&&(ni=ti,gt=it.length-1);if(y=n.isNullOrUndefined(k)?ft.properties[dt]:n.isNullOrUndefined(k[dt])?k[t.shapeDataPath]:k[dt].toString(),"[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)&&n.isNullOrUndefined(y)&&0===t.dataSource.length)for(bt=0;bt<t.shapePropertyPath.length;bt++)if(ft.properties[t.shapePropertyPath[bt]]){y=ft.properties[t.shapePropertyPath[bt]];break}n.isNullOrUndefined(y)&&""!==t.dataLabelSettings.template&&0===t.dataSource.length&&(y=ft.properties[t.shapePropertyPath]);n.isNullOrUndefined(y)&&t.dataSource.length>0&&(y="");var gi=y,bi=this.maps.projectionType,ki=a=yi(it[gt],bi,t.geometryType);if(!n.isNullOrUndefined(y)&&!n.isNullOrUndefined(a)){if(pt&&vt>1&&!this.maps.zoomNotApplied&&""===lt.template){if(i>0)for(kt=0;kt<this.maps.zoomLabelPositions.length;kt++)if(this.maps.zoomLabelPositions[kt].dataLabelText===y){fi=s;s=kt;oi=!0;break}ei=a.x;li=a.y;a.x=(a.x+ri.x)*p;a.y=(a.y+ri.y)*p}a.y="Mercator"===this.maps.projectionType||"Normal"===t.geometryType?a.y:-a.y;n.isNullOrUndefined(this.maps.format)||isNaN(parseFloat(y))||this.maps.useGroupingSeparator&&(y=yr(this.maps,parseFloat(y)),n.isNullOrUndefined(k)||(k[dt]=y));w={name:"dataLabelRendering",maps:this.maps,cancel:!1,border:{color:lt.border.color,width:lt.border.width,opacity:lt.border.opacity},datalabel:lt,fill:lt.fill,template:lt.template,text:y,offsetX:0,offsetY:0};this.maps.trigger("dataLabelRendering",w,function(r){var kt,ut,rt,lt,hi,ci,ni,yt,f,bt,pi,wi;if(!w.cancel){ut=pt&&vt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.dataLabelShape[s]*p:(a.rightMax.x-a.leftMax.x)*p;n.isNullOrUndefined(c.maps.dataLabelShape)||c.maps.isReset||(vi=ki.rightMax.x-ki.leftMax.x,c.maps.dataLabelShape.push(vi));w.text===y||w.cancel||(y=w.text);var u=l(y,d),ht=y,dt=u,di=a.y-u.height/4,nr=a.y+u.height/4,tr=(a.y+et.y)*p-u.height/4,ir=(a.y+et.y)*p+u.height/4;if((kt=function(n,t,i){for(var u,f=[],r=0;r<n.length;r++)u=n[r],t<=u.y&&i>=u.y&&f.push(u);return f}(it[gt],di,nr),kt.length>5&&"MultiPolygon"!==ft.geometry.type&&"MultiPolygon"!==ft.type)&&(rt=yi(kt,bi,t.geometryType),pt&&vt>1&&!c.maps.zoomNotApplied&&""===w.template&&(rt.x=(c.maps.zoomLabelPositions[s].location.x+ri.x)*p,rt.y=(c.maps.zoomLabelPositions[s].location.y+ri.y)*p),ei=rt.x,a.x=rt.x,ut=pt&&vt>1&&!c.maps.zoomNotApplied&&c.maps.zoomShapeCollection.length>s?c.maps.dataLabelShape[s]*p:(rt.rightMax.x-rt.leftMax.x)*p>0?(rt.rightMax.x-rt.leftMax.x)*p:ut),hi=(a.x+et.x)*p+u.width/2,ci=(a.x+et.x)*p-u.width/2,c.value[s]={rightWidth:hi,leftWidth:ci,heightTop:tr,heightBottom:ir},""!==w.template)ni=(ui=ii(w.template,c.maps))?ui(n.isNullOrUndefined(k)?ft.properties:k,c.maps,w.template,c.maps.element.id+"_LabelTemplate",!1):document.createElement("div"),ni.innerHTML=ui?"":w.template,lt=function(t,i,r){for(var o,f=(n.isNullOrUndefined(t.childElementCount)?t[0]:t).outerHTML,e=Object.keys(r),s=RegExp,u=0;u<e.length;u++)f=f.replace(new s("{{:"+e[u]+"}}","g"),r[e[u].toString()]);return o=n.createElement("div",{id:i,innerHTML:f}),o.style.position="absolute",o}(ni,at,n.isNullOrUndefined(k)?ft.properties:k,c.maps),c.maps.isTileMap?(lt.style.left=(a.x+et.x)*p-u.width/2+"px",lt.style.top=(a.y+et.y)*p-u.height+"px"):(lt.style.left=Math.abs(c.maps.baseMapRectBounds.min.x-a.x)*p+r.offsetX+"px",lt.style.top=Math.abs(c.maps.baseMapRectBounds.min.y-a.y)*p+r.offsetY+"px"),o.appendChild(lt);else{if("Trim"===ot.smartLabelMode&&(dt=l(ht=g(ut,"number"==typeof y?y.toString():y,d),d),ct=new tt(at,nt.x,nt.y,"middle",ht,"","")),"None"===ot.smartLabelMode&&(ct=new tt(at,nt.x,nt.y,"middle",y,"","")),"Hide"===ot.smartLabelMode&&(y=ut>=u.width?y:"",ct=new tt(at,nt.x,nt.y,"middle",y,"","")),y=ct.text,"Hide"===ot.intersectionAction){for(yt=0;yt<h.length;yt++)if(!n.isNullOrUndefined(h[yt])&&!(c.value[s].leftWidth>h[yt].rightWidth||c.value[s].rightWidth<h[yt].leftWidth||c.value[s].heightTop>h[yt].heightBottom||c.value[s].heightBottom<h[yt].heightTop)){y="";break}h.push(c.value[s]);ct=new tt(at,nt.x,nt.y,"middle",y,"","")}if("Trim"===ot.intersectionAction){for(f=0;f<h.length;f++)if(!n.isNullOrUndefined(h[f]))if(h[f].rightWidth<c.value[s].leftWidth||h[f].leftWidth>c.value[s].rightWidth||h[f].heightBottom<c.value[s].heightTop||h[f].heightTop>c.value[s].heightBottom)ht=y;else{if(c.value[s].leftWidth>h[f].leftWidth){ht=g((ut=h[f].rightWidth-c.value[s].leftWidth)-(c.value[s].rightWidth-c.value[s].leftWidth),y,d);break}if(c.value[s].leftWidth<h[f].leftWidth){ut=c.value[s].rightWidth-h[f].leftWidth;ht=g(Math.abs(ut-(c.value[s].rightWidth-c.value[s].leftWidth)),y,d);break}}dt=l(ht,d);h.push(c.value[s]);ct=new tt(at,nt.x,nt.y,"middle",ht,"","")}if(("None"===ot.intersectionAction&&(ct=new tt(at,nt.x,nt.y,"middle",y,"","")),ht.length>1)&&(bt=w.border,bt.width>1)){var rr=w.fill,ai=ot.opacity,ur=ot.rx,fr=ot.ry,ti=void 0,si=void 0;pt&&vt>1&&!c.maps.zoomNotApplied?(ti=a.x-u.width/2,si=a.y-u.height/2-5):(ti=(a.x+et.x)*p-u.width/2,si=(a.y+et.y)*p-u.height/2);bt.opacity=n.isNullOrUndefined(bt.opacity)?ai:bt.opacity;pi=new b(c.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_rectIndex_"+s,rr,bt,ai,new v(ti+r.offsetX,si+r.offsetY,u.width,u.height),ur,fr);wi=c.maps.renderer.drawRectangle(pi);e.appendChild(wi)}wt=st(ct,d,d.color||c.maps.themeStyle.dataLabelFontColor,e);pt&&vt>1&&!c.maps.zoomNotApplied?(wt.setAttribute("transform","translate( "+(a.x+r.offsetX)+" "+(a.y+r.offsetY)+" )"),a.x=ei,a.y=li):wt.setAttribute("transform","translate( "+((a.x+et.x)*p+r.offsetX)+" "+((a.y+et.y)*p+dt.height/4+r.offsetY)+" )");e.appendChild(wt)}c.dataLabelCollections.push({location:{x:a.x+r.offsetX,y:a.y+r.offsetY},element:n.isNullOrUndefined(lt)?wt:lt,layerIndex:i,shapeIndex:oi?fi:s,labelIndex:oi?fi:s,dataLabelText:gi});o.childElementCount>0&&!c.maps.element.contains(o)&&(document.getElementById(c.maps.element.id+"_Secondary_Element").appendChild(o),c.maps.renderReactTemplates())}})}},t.prototype.getPoint=function(n,t){return"MultiLineString"===n.type?n.map(function(n){n.map(function(n){t.push(new f(n.point.x,n.point.y))})}):n.map(function(n){t.push(new f(n.point.x,n.point.y))}),t},t.prototype.getModuleName=function(){return"DataLabel"},t.prototype.destroy=function(){this.dataLabelCollections=[];this.value=null;this.maps=null},t}(),ro=function(){function t(n){this.maps=n}return t.prototype.renderNavigation=function(t,i,r){var ot,s,v,kt,u,dt,nt,tt,ni,rt,l;if(!n.isNullOrUndefined(this.maps)){var a=void 0,h=t.navigationLineSettings,b=void 0,e=[],ut=void 0,at=void 0,o=void 0,st=void 0,ht=void 0,ct=void 0,ft=void 0,k=void 0,vt=void 0,yt=void 0,d=void 0,c=void 0,g=void 0,pt=void 0,wt=void 0,w=void 0,lt=void 0,et=void 0,bt=void 0;for(ot=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_line_Group"}),s=0;s<h.length;s++){if(ut=h[s].properties.latitude,b=h[s].properties.longitude,at=h[s].properties.visible,o=h[s].angle,st=h[s].width||1,ht=h[s].color,ct=h[s].properties.dashArray,c=h[s].properties.arrowSettings,vt=!n.isNullOrUndefined(c)&&c.properties.showArrow,b.length===ut.length&&at)for(v=0;v<b.length;v++)kt=this.maps.isTileMap?it(new f(b[v],ut[v]),i,this.maps.tileTranslatePoint,!0):p(ut[v],b[v],i,t,this.maps),e.push(kt);for(et=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_NavigationGroup"+s}),u=0;u<e.length-1;u++)o=1<(o=-1>o?-1:o)?1:o,dt=this.maps.element.id+"_LayerIndex_"+r+"_NavigationIndex_"+s+"_Line"+u,nt=this.convertRadius(e[u],e[u+1]),(o<=1&&o>0&&(k=0,e[u].x>e[u+1].x&&(k=1)),o>=-1&&o<0&&(k=1,e[u].x>e[u+1].x&&(k=0)),vt)&&(yt=c.properties.color,d=c.properties.size,lt=void 0===c.properties.offSet?0:c.properties.offSet,tt=Math.round(d/2),pt="Start"===(g=c.properties.position)?"url(#triangle"+s+")":null,wt="End"===g?"url(#triangle"+s+")":null,0!==w&&0===o&&(w="Start"===g?lt:-lt),w=n.isNullOrUndefined(w)?0:w,ni=this.maps.element.id+"_triangle",rt=this.maps.renderer.createDefs(),rt.innerHTML+='<marker id="triangle'+s+'"><\/marker>',l=rt.querySelector("#triangle"+s),l.setAttribute("markerWidth",d.toString()),l.setAttribute("markerHeight",d.toString()),l.setAttribute("refX",(tt-w).toString()),l.setAttribute("refY",tt.toString()),l.setAttribute("orient","auto"),ft=new y(ni,yt,st,ht,1,1,ct,"M 0,0  L 0,"+d+" L "+tt+", "+tt+" Z"),a=this.maps.renderer.drawPath(ft),l.appendChild(a),rt.appendChild(l),et.appendChild(rt)),bt=0===(o=Math.abs(o))?"M "+e[u].x+","+e[u].y+"L "+e[u+1].x+","+e[u+1].y+" ":"M "+e[u].x+","+e[u].y+" A "+(nt/2+(1-o)*nt/(10*o))+" "+(nt/2+(1-o)*nt/(10*o))+" 0,0,"+k+" , "+e[u+1].x+","+e[u+1].y+" ",ft=new y(dt,"none",st,ht,1,1,ct,bt),a=this.maps.renderer.drawPath(ft),n.isNullOrUndefined(g)||("Start"===g?a.setAttribute("marker-start",pt):a.setAttribute("marker-end",wt)),gt(this.maps.selectedNavigationElementId,this.maps.navigationSelectionClass,a,"navigationlineselectionMapStyle"),et.appendChild(a),ot.appendChild(et);e=[]}}return ot},t.prototype.convertRadius=function(n,t){var i=t.x-n.x,r=t.y-n.y;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))},t.prototype.getModuleName=function(){return"NavigationLine"},t.prototype.destroy=function(){this.maps=null},t}(),uo=function(){function t(n){this.legendBorderRect=new v(0,0,0,0);this.initialMapAreaRect=new v(0,0,0,0);this.legendTotalRect=new v(0,0,0,0);this.totalPages=[];this.page=0;this.currentPage=0;this.legendItemRect=new v(0,0,0,0);this.heightIncrement=0;this.widthIncrement=0;this.textMaxWidth=0;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.shapeToggled=!0;this.legendElement=null;this.maps=n;this.addEventListener()}return t.prototype.renderLegend=function(){this.legendRenderingCollections=[];this.legendCollection=[];this.totalPages=[];this.widthIncrement=0;this.heightIncrement=0;this.defsElement=this.maps.renderer.createDefs();this.maps.svgObject.appendChild(this.defsElement);this.initialMapAreaRect=this.maps.mapAreaRect;this.calculateLegendBounds();this.drawLegend()},t.prototype.calculateLegendBounds=function(){var ut=this,b=this.maps,t=b.legendSettings,ht,r,ft,ei,oi,ot,c,i,a,e,dt,ii,ri,ui,fi,gt;if(this.legendCollection=[],ht=b.mapAreaRect.y,this.legendRenderingCollections=[],Array.prototype.forEach.call(b.layersCollection,function(i,r){var o,h,u;if(!n.isNullOrUndefined(i.shapeData)){var c=i.shapeData.features,l=i.shapeDataPath,a=i.shapePropertyPath,s=i.dataSource,f=void 0,e=void 0;if("Layers"===t.type&&i.visible)f=i.shapeSettings.colorValuePath,e=i.shapeSettings.colorMapping,ut.getLegends(r,c,e,s,l,f,a);else if("Bubbles"===t.type)for(o=0,h=i.bubbleSettings;o<h.length;o++)u=h[o],u.visible&&(f=u.colorValuePath,e=u.colorMapping,s=u.dataSource,ut.getLegends(r,c,e,s,l,f,a))}"Markers"===t.type&&ut.getMarkersLegendCollections(r,i.markerSettings)}),this.legendCollection.length>0)for(r=0;r<this.legendCollection.length;r++)ft={name:"legendRendering",cancel:!1,fill:(a=this.legendCollection[r]).fill,shape:t.shape,shapeBorder:t.shapeBorder,text:"number"==typeof a.text?a.text.toString():a.text},b.trigger("legendRendering",ft),a.fill=ft.fill,a.shape=ft.shape,a.shapeBorder=ft.shapeBorder,a.text=ft.text,ft.cancel&&(this.legendCollection.splice(r,1),r--);if(ei=b.legendSettings.title.text,oi=b.legendSettings.titleStyle,this.legendCollection.length>0){var si,hi,vi=t.mode,k=0,d=0,ct=0,st=0,ni=t.shapePadding,y=t.shapeHeight,et=t.shapeWidth,o=[],nt=[],ci=t.position,li=t.labelDisplayMode,p="None"===t.orientation?"Top"===ci||"Bottom"===ci?"Horizontal":"Vertical":t.orientation,u=t.width.length>1?t.width.indexOf("%")>-1?b.availableSize.width/100*parseInt(t.width,10):parseInt(t.width,10):null,f=t.height.length>1?t.height.indexOf("%")>-1?b.availableSize.height/100*parseInt(t.height,10):parseInt(t.height,10):null,s=0,h=0,ai=l(ei,oi);if("Interactive"===vi){var ti=t.textStyle,lt=this.legendCollection.length,tt="Horizontal"===p?n.isNullOrUndefined(u)?b.mapAreaRect.width/lt:u/lt:n.isNullOrUndefined(u)?25:u,it="Horizontal"===p?n.isNullOrUndefined(f)?25:f:n.isNullOrUndefined(f)?b.mapAreaRect.height/lt:f/lt;s=0;h=ai.height+10;var at=t.labelPosition,vt=0,yt=0,rt=10,pt=0,wt=0,bt=0,kt=0;for(r=0;r<this.legendCollection.length;r++)s="Horizontal"===p?s+tt:s,h="Horizontal"===p?h:h+it,ot=this.legendCollection[r].text,c=new w(0,0),"None"===li?c=l(ot,ti):"Trim"===li?c=l(ot=g("Horizontal"===p?tt:it,ot,ti),ti):ot="",bt=Math.max(bt,c.height),kt=Math.max(kt,c.width),c.width>0&&c.height>0&&("Horizontal"===p?(vt=s+tt/2,yt="After"===at?h+it+c.height/2+rt:h-rt):(vt="After"===at?s-c.width/2-rt:s+tt+c.width/2+rt,yt=h+it/2+c.height/4)),0===r?(pt="Horizontal"===p?s:"After"===at?vt-c.width/2:s,wt="Horizontal"===p?"After"===at?h:yt-c.height/2:h,1===this.legendCollection.length&&(u="Horizontal"===p?Math.abs(s+tt-pt):tt+kt+rt,f="Horizontal"===p?it+bt/2+rt:Math.abs(h+it-wt))):r===this.legendCollection.length-1&&(u="Horizontal"===p?Math.abs(s+tt-pt):tt+kt+rt,f="Horizontal"===p?it+bt/2+rt:Math.abs(h+it-wt)),this.legendRenderingCollections.push({fill:this.legendCollection[r].fill,x:s,y:h,width:tt,height:it,text:ot,textX:vt,textY:yt,textWidth:c.width,textHeight:c.height,shapeBorder:this.legendCollection[r].shapeBorder});1===this.legendCollection.length&&(f=it,u=tt);this.legendItemRect={x:pt,y:wt,width:u,height:f}}else{for(u=n.isNullOrUndefined(u)?b.mapAreaRect.width:u,f=n.isNullOrUndefined(f)?b.mapAreaRect.height:f,i=0,this.page=0,r=0;r<this.legendCollection.length;r++)a=this.legendCollection[r],n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]}),e=l(a.text,t.textStyle),(this.textMaxWidth=Math.max(this.textMaxWidth,e.width),0===r)?(s=k=10+et/2,h=d=ht+ai.height+(y>e.height?y/2:e.height/4)):(dt=e.height>y?e.height:y,"Horizontal"===p?(ii=nt[i-1].x+nt[i-1].width+10+et,ii+ni+e.width>u?(ri=(nt[i-1].y>o[i-1].y+y/2?nt[i-1].y:o[i-1].y+y/2)+ht,ri+dt>f?(this.getPageChanged(),i=0,o=[],nt=[],k=s,d=h):(k=o[0].x,d=ri+dt/2)):(k=ii-et/2,d=o[i-1].y)):(ui=nt[i-1].y>o[i-1].y+y/2?nt[i-1].y:o[i-1].y+y/2,ui+ht+dt>f?(fi=nt[i-1].x+this.textMaxWidth+10,fi+ni+e.width>u?(k=s,d=h,nt=[],o=[],this.getPageChanged(),i=0):(k=fi+et/2,d=o[0].y)):(k=o[i-1].x,d=ui+10+y/2))),ct=k+et/2+ni,st=d+e.height/4,o.push({x:k,y:d}),nt.push({x:ct,y:st,width:e.width,height:e.height/2}),this.totalPages[this.page].Collection.push({DisplayText:a.text,ImageSrc:a.imageSrc,Shape:{x:k,y:d},Text:{x:ct,y:st},Fill:a.fill,legendShape:a.shape,shapeBorder:a.shapeBorder,idIndex:r,Rect:{x:o[i].x-et/2,y:o[i].y-y/2<st-e.height?o[i].y-y/2:st-e.height,width:Math.abs(o[i].x-et/2-(ct+e.width)),height:y>e.height?y:e.height}}),i++;gt=this.totalPages[0].Collection;Array.prototype.forEach.call(gt,function(n,t){var i=new v(n.Rect.x,n.Rect.y,n.Rect.width,n.Rect.height);0===t&&(si=i.x,hi=i.y);ut.widthIncrement=Math.max(ut.widthIncrement,Math.abs(si-(i.x+i.width)));ut.heightIncrement=Math.max(ut.heightIncrement,Math.abs(hi-(i.y+i.height)))});u=this.widthIncrement<u?this.widthIncrement:u;f=this.heightIncrement<f?this.heightIncrement:f;this.legendItemRect={x:gt[0].Rect.x,y:gt[0].Rect.y,width:u,height:f}}}},t.prototype.getLegends=function(n,t,i,r,u,f,e){this.getRangeLegendCollection(n,t,i,r,u,f,e);this.getEqualLegendCollection(n,t,i,r,u,f,e);this.getDataLegendCollection(n,t,i,r,u,f,e)},t.prototype.getPageChanged=function(){this.page++;n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},t.prototype.legendTextTrim=function(n,t,i,r){var u=t,e=l(t,i).width,o=r-e,f;if(r>n)for(f=t.length-1;f>=0;--f)if(o+(e=l(u=t.substring(0,f)+"...",i).width)<=n||u.length<4)return u.length<4&&(u=" "),u;return u},t.prototype.drawLegend=function(){var s,e=this.maps,r=e.legendSettings,h=e.renderer,t={size:r.textStyle.size,color:r.textStyle.color,fontFamily:r.textStyle.fontFamily,fontWeight:r.textStyle.fontWeight,fontStyle:r.textStyle.fontStyle,opacity:r.textStyle.opacity},u,o,c;if(this.legendGroup=h.createGroup({id:e.element.id+"_Legend_Group"}),"Interactive"===r.mode)for(u=0;u<this.legendRenderingCollections.length;u++){var l=e.element.id+"_Legend_Index_"+u,a=e.element.id+"_Legend_Index_"+u+"_Text",i=this.legendRenderingCollections[u],y=new v(i.x,i.y,i.width,i.height);0===u&&this.renderLegendBorder();o=new f(i.textX,i.textY);t.color=null!==t.color?t.color:this.maps.themeStyle.legendTextColor;c=new b(l,i.fill,i.shapeBorder,r.opacity,y);s=new tt(a,o.x,o.y,"middle",i.text,"","");t.fontFamily=n.isNullOrUndefined(t.fontFamily)?this.maps.themeStyle.fontFamily:t.fontFamily;t.size=e.themeStyle.legendFontSize||t.size;st(s,t,t.color,this.legendGroup);this.legendGroup.appendChild(h.drawRectangle(c));this.legendToggle()}else this.drawLegendItem(this.currentPage)},t.prototype.drawLegendItem=function(t){var bt,kt,dt,gt,ni,ct,it,r=this.maps,i=r.legendSettings,ti=new w(i.shapeWidth,i.shapeHeight),s=r.renderer,lt=i.shape,a,p,c,yt,k,fi,nt,ei,oi,si,wt;if(t>=0&&t<this.totalPages.length)for(e(this.legendGroup.id,this.maps.element.id)&&n.remove(e(this.legendGroup.id,this.maps.element.id)),a=0;a<this.totalPages[t].Collection.length;a++){var u=this.totalPages[t].Collection[a],d=u.shapeBorder,rt=s.createGroup({id:r.element.id+"_Legend_Index_"+u.idIndex}),at=u.DisplayText,hi=("Markers"===i.type?n.isNullOrUndefined(u.ImageSrc)&&i.shape:u.legendShape,"HorizontalLine"===i.shape||"VerticalLine"===i.shape||"Cross"===i.shape?n.isNullOrUndefined(i.fill)?"#000000":i.fill:d.color),ci="HorizontalLine"!==i.shape&&"VerticalLine"!==i.shape&&"Cross"!==i.shape||0!==d.width?d.width:1,li=r.element.id+"_Legend_Shape_Index_"+u.idIndex,ai=r.element.id+"_Legend_Text_Index_"+u.idIndex,vt=new f(u.Shape.x,u.Shape.y-4),ii=new f(u.Text.x,u.Text.y-4),ri=new y(li,u.Fill,ci,hi,i.opacity,n.isNullOrUndefined(d.opacity)?i.opacity:d.opacity,""),o={fontFamily:i.textStyle.fontFamily,fontStyle:i.textStyle.fontStyle,fontWeight:i.textStyle.fontWeight,size:i.textStyle.size,color:i.textStyle.color,opacity:i.textStyle.opacity};if((o.color=null!==o.color?o.color:this.maps.themeStyle.legendTextColor,o.fontFamily=n.isNullOrUndefined(o.fontFamily)?this.maps.themeStyle.fontFamily:o.fontFamily,o.size=r.themeStyle.legendFontSize||o.size,o.fontWeight=o.fontWeight||r.themeStyle.fontWeight,0===a&&this.renderLegendBorder(),"Markers"===i.type&&i.useMarkerShape)&&(p=this.legendCollection[u.idIndex].data[0],c=r.layers[p.layerIndex].markerSettings[p.markerIndex],lt=n.isNullOrUndefined(c.dataSource[p.dataIndex][c.shapeValuePath])||""===c.dataSource[p.dataIndex][c.shapeValuePath]?c.shape:c.dataSource[p.dataIndex][c.shapeValuePath]),"Balloon"===lt?rt.appendChild(lr(r,ri,ti,{x:vt.x,y:vt.y+5},"Legend")):rt.appendChild((bt=vt,kt=lt,dt=ti,gt=u.ImageSrc,ni=ri,ct=void 0,it=void 0,ct=new ot.SvgRenderer(""),it=function(t,i,r,u,f){var s,v="Path",c=i.width,o=i.height,h=t.x,e=t.y,l=t.x+-c/2,w=t.y+-o/2;switch(u.stroke="HorizontalLine"===r||"VerticalLine"===r||"Cross"===r?u.fill:u.stroke,u["stroke-width"]=0!==u["stroke-width"]||"HorizontalLine"!==r&&"VerticalLine"!==r&&"Cross"!==r?u["stroke-width"]:1,r){case"Circle":case"Bubble":v="Ellipse";n.merge(u,{rx:c/2,ry:o/2,cx:h,cy:e});break;case"VerticalLine":s="M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"HorizontalLine":s="M "+h+" "+e+" L "+(h+c/2)+" "+e;n.merge(u,{d:s});break;case"Diamond":s="M "+l+" "+e+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+e+" L "+h+" "+(e+o/2)+" L "+l+" "+e+" z";n.merge(u,{d:s});break;case"Rectangle":s="M "+l+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" L "+l+" "+(e+-o/2)+" z";n.merge(u,{d:s});break;case"Triangle":s="M "+l+" "+(e+o/2)+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" z";n.merge(u,{d:s});break;case"InvertedTriangle":s="M "+(h+c/2)+" "+(e-o/2)+" L "+h+" "+(e+o/2)+" L "+(h-c/2)+" "+(e-o/2)+" L "+(h+c/2)+" "+(e-o/2)+" z";n.merge(u,{d:s});break;case"Pentagon":for(var y=void 0,p=void 0,a=0;a<=5;a++)y=c/2*Math.cos(Math.PI/180*72*a),p=c/2*Math.sin(Math.PI/180*72*a),s=0===a?"M "+(h+y)+" "+(e+p)+" ":s.concat("L "+(h+y)+" "+(e+p)+" ");s=s.concat("Z");n.merge(u,{d:s});break;case"Star":s="M "+(t.x+i.width/3)+" "+(t.y-i.height/2)+" L "+(t.x-i.width/2)+" "+(t.y+i.height/6)+" L "+(t.x+i.width/2)+" "+(t.y+i.height/6)+" L "+(t.x-i.width/3)+" "+(t.y-i.height/2)+" L "+t.x+" "+(t.y+i.height/2)+" L "+(t.x+i.width/3)+" "+(t.y-i.height/2)+" Z";n.merge(u,{d:s});break;case"Cross":s="M "+l+" "+e+" L "+(h+c/2)+" "+e+" M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"Image":v="Image";n.merge(u,{href:f,height:o,width:c,x:l,y:w})}return{renderOption:u,functionName:v}}(bt,dt,kt,ni,gt),ct["draw"+it.functionName](it.renderOption))),yt=u.Rect.x+u.Rect.width,yt>this.legendBorderRect.width&&(at=this.legendTextTrim(this.legendBorderRect.width,at,o,yt)),st(new tt(ai,ii.x,ii.y,"start",at,"",""),o,o.color,rt),this.legendGroup.appendChild(rt),a===this.totalPages[t].Collection.length-1){if(k=void 0,0!==this.page){var ui=t+1+"/"+this.totalPages.length,ut=i.textStyle,pt=l(ui,ut),ft=this.legendItemRect.x+this.legendItemRect.width-pt.width-38,g=this.legendItemRect.x+this.legendItemRect.width,vi=g-10-pt.width/2-9,h=this.legendItemRect.y+this.legendItemRect.height+2.5+10;k=s.createGroup({id:r.element.id+"_Legend_Paging_Group"});var et=s.createGroup({id:r.element.id+"_Legend_Left_Paging_Group"}),ht=s.createGroup({id:r.element.id+"_Legend_Right_Paging_Group"}),yi=" M "+g+" "+h+" L "+(g-10)+" "+(h-5)+" L "+(g-10)+" "+(h+5)+" z ",pi=" M "+ft+" "+h+" L "+(ft+10)+" "+(h-5)+" L "+(ft+10)+" "+(h+5)+" z ",wi=new y(r.element.id+"_Left_Page",this.maps.themeStyle.legendTextColor,0,this.maps.themeStyle.legendTextColor,t+1===1?.5:1,1,"",pi);et.appendChild(s.drawPath(wi));fi=new b(r.element.id+"_Left_Page_Rect","transparent",{},1,new v(ft-5,h-10,20,20),null,null,"","");nt=s.drawRectangle(fi);nt.tabIndex=t+1===1?-1:r.tabIndex+1;et.appendChild(nt);this.wireEvents(et);ei=new y(r.element.id+"_Right_Page",this.maps.themeStyle.legendTextColor,0,this.maps.themeStyle.legendTextColor,t+1===this.totalPages.length?.5:1,1,"",yi);ht.appendChild(s.drawPath(ei));oi=new b(r.element.id+"_Right_Page_Rect","transparent",{},1,new v(g-15,h-10,20,20),null,null,"","");(nt=s.drawRectangle(oi)).tabIndex=t+1===this.totalPages.length?-1:r.tabIndex+2;ht.appendChild(nt);this.wireEvents(ht);k.appendChild(et);k.appendChild(ht);si={id:r.element.id+"_Paging_Text",x:vi,y:h+pt.height/4,fill:this.maps.themeStyle.legendTextColor,"font-size":"14px","font-style":ut.fontStyle,"font-family":ut.fontFamily,"font-weight":ut.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":""};wt=s.createText(si,ui);wt.style.cssText="user-select: none;";k.appendChild(wt);this.legendGroup.appendChild(k)}this.legendToggle()}}},t.prototype.legendHighLightAndSelection=function(t,i){var w,b,k,rt,s,ct="Default"===this.maps.legendSettings.mode?document.getElementById(t.id.replace("Shape","Text")):document.getElementById(t.id+"_Text"),h=this.maps.legendModule.legendCollection,a=!n.isNullOrUndefined(h[0].data[0].layerIndex)&&this.maps.layers[h[0].data[0].layerIndex].selectionSettings.enableMultiSelect,v=0,d=!0,ut=parseFloat(t.id.charAt(t.id.length-1)),ft,g,u,y,f,et,e,o,nt,p,st,ht,tt,it;if(this.updateLegendElement(),ft=this.maps.toggledLegendId.indexOf(ut),this.maps.legendSettings.toggleLegendSettings.enable&&"highlight"===i&&-1!==ft)return g=this.getIndexofLegend(this.legendHighlightCollection,t),-1!==g&&this.legendHighlightCollection.splice(g,1),this.removeLegendHighlightCollection(),null;if("selection"===i){if(this.shapeHighlightCollection=[],this.maps.shapeSelections||a||(this.removeAllSelections(),this.maps.shapeSelections=!0),this.maps.legendSelectionCollection.length>0&&(a||this.maps.shapeSelections))for(u=0;u<this.maps.legendSelectionCollection.length;u++){if(t===this.maps.legendSelectionCollection[u].legendElement){this.maps.legendSelectionCollection[u].legendElement=t;d=!1;this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement);this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(ut),1);this.maps.legendSelectionCollection.splice(u,1);this.maps.legendSelection=!(this.maps.legendSelectionCollection.length>0);break}if(!a)if(this.maps.legendSelectionCollection.length>1){for(y=0;y<this.maps.legendSelectionCollection.length;y++)this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[y].legendElement);this.maps.legendSelectionCollection=[]}else this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement),this.maps.legendSelectionCollection.splice(u,1)}}else{if(this.maps.legendSelectionCollection.length>0)for(u=0;u<this.maps.legendSelectionCollection.length;u++){if((t.id.indexOf("_Legend_Shape")>-1||t.id.indexOf("_Legend_Index"))&&t===this.maps.legendSelectionCollection[u].legendElement){d=!1;break}this.removeLegendHighlightCollection()}this.removeLegendHighlightCollection()}if(d)for(f=0;f<h.length;f++)if(et="Interactive"===this.maps.legendSettings.mode?parseFloat(t.id.split("_Legend_Index_")[1]):parseFloat(t.id.split("_Legend_Shape_Index_")[1]),ct.textContent===h[f].text&&h[f].data.length>0&&et===f){var c=this.maps.layers[h[f].data[0].layerIndex],ot=void 0,r=void 0,l=void 0;if(n.isNullOrUndefined(c)||(ot="selection"===i?c.selectionSettings.enable:c.highlightSettings.enable,r=void 0,r="selection"===i?c.selectionSettings:c.highlightSettings,l=h[f].data),ot)for(e=0;e<l.length;e++)if(o=void 0,w=l[e].shapeIndex,b=l[e].layerIndex,k=l[e].dataIndex,null!==(o=-1===(rt=l[e].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+b+"_shapeIndex_"+w+"_dataIndex_"+k):document.getElementById(this.maps.element.id+"_LayerIndex_"+b+"_shapeIndex_"+w+"_dataIndex_"+k+"_multiLine_"+rt))){if(nt=!0,null!==this.maps.legendSelectionCollection)for(p=0;p<this.maps.legendSelectionCollection.length;p++)if(this.maps.legendSelectionCollection[p].legendElement===t){nt=!1;break}if("highlight"===i&&nt){0===e&&(this.legendHighlightCollection=[],this.pushCollection(t,this.legendHighlightCollection,h[f],c.shapeSettings));s=this.legendHighlightCollection.length;st=this.legendHighlightCollection[s-1].legendOldFill;this.legendHighlightCollection[s-1].MapShapeCollection.Elements.push(o);var lt=this.legendHighlightCollection[s-1].MapShapeCollection.Elements.length-1,at=o.getAttribute("fill"),vt=o.getAttribute("fill-opacity");this.legendHighlightCollection[s-1].shapeOldFillColor.push(at);this.legendHighlightCollection[s-1].shapeOldOpacity=vt;ht=this.legendHighlightCollection[s-1].shapeOldFillColor[lt];tt=this.legendHighlightCollection[s-1].shapeOldOpacity;this.shapePreviousColor=this.legendHighlightCollection[s-1].shapeOldFillColor;this.setColor(o,n.isNullOrUndefined(r.fill)?ht:r.fill,n.isNullOrUndefined(r.opacity)?tt:r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight");this.setColor(t,n.isNullOrUndefined(r.fill)?st:r.fill,n.isNullOrUndefined(r.opacity)?tt:r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")}else"selection"===i&&(this.legendHighlightCollection=[],this.maps.legendSelectionClass=r,0===e&&(this.pushCollection(t,this.maps.legendSelectionCollection,h[f],c.shapeSettings),a||0===this.maps.selectedLegendElementId.length||(this.maps.selectedLegendElementId=[]),this.maps.selectedLegendElementId.push(f)),v=this.maps.legendSelectionCollection.length,it=this.maps.legendSelectionCollection[v-1].legendOldFill,this.maps.legendSelectionCollection[v-1].MapShapeCollection.Elements.push(o),this.maps.legendSelectionCollection[v-1].shapeOldFillColor=this.shapePreviousColor,this.setColor(t,n.isNullOrUndefined(r.fill)?it:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),this.setColor(o,n.isNullOrUndefined(r.fill)?it:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),-1===this.maps.selectedElementId.indexOf(o.getAttribute("id"))&&this.maps.selectedElementId.push(o.getAttribute("id")),e===l.length-1&&(this.maps.legendSelection=!1,this.removeLegend(this.maps.legendSelectionCollection)))}}},t.prototype.setColor=function(t,i,r,u,f,e){var o=t.parentElement.id.indexOf("LineString")>-1;"selection"===e?(function(t,i,r,u,f,e,o){if(!s(t)){var h=n.createElement("style",{id:t});h.innerText="."+i+"{fill:"+r+";opacity:"+u+";stroke-width:"+e+";stroke:"+f+";}";o.shapeSelectionClass=h;document.body.appendChild(h)}}(o?"LineselectionMap":"ShapeselectionMap",o?"LineselectionMapStyle":"ShapeselectionMapStyle",o?"transparent":i,r,o?i:u,f,this.maps),t.setAttribute("class",o?"LineselectionMapStyle":"ShapeselectionMapStyle")):(t.setAttribute("fill",o?"transparent":i),t.setAttribute("fill-opacity",r),t.setAttribute("stroke",o?i:u),t.setAttribute("stroke-width",(Number(f)/this.maps.scale).toString()))},t.prototype.pushCollection=function(n,t,i,r){t.push({legendElement:n,legendOldFill:i.fill,legendOldOpacity:i.opacity,legendOldBorderColor:i.borderColor,legendOldBorderWidth:i.borderWidth,shapeOpacity:r.opacity,shapeOldBorderColor:r.border.color,shapeOldBorderWidth:r.border.width});var u=t.length;t[u-1].MapShapeCollection={Elements:[]};t[u-1].shapeOldFillColor=[];t[u-1].shapeOldOpacity=null},t.prototype.removeLegend=function(t){for(var i,f,r,e,o,u=0;u<t.length;u++)for(i=t[u],this.setColor(i.legendElement,i.legendOldFill,i.legendOldOpacity,i.legendOldBorderColor,i.legendOldBorderWidth,"highlight"),f=i.MapShapeCollection.Elements.length,r=0;r<f;r++)e=-1!==i.legendOldFill.indexOf("url")?i.shapeOldFillColor[r]:i.legendOldFill,o=n.isNullOrUndefined(i.shapeOldOpacity)?i.shapeOpacity:i.shapeOldOpacity,this.setColor(i.MapShapeCollection.Elements[r],e,o,i.shapeOldBorderColor,i.shapeOldBorderWidth,"highlight")},t.prototype.removeLegendHighlightCollection=function(){this.legendHighlightCollection.length>0&&(this.removeLegend(this.legendHighlightCollection),this.legendHighlightCollection=[])},t.prototype.removeLegendSelectionCollection=function(n){var t,r;if(this.maps.legendSelectionCollection.length>0){c(n);for(var u=this.shapesOfLegend(n),f=u.length,i=0;i<f;i++)t=s(u[i]),("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&(c(t),r=this.maps.selectedElementId.indexOf(t.id),-1!==r&&this.maps.selectedElementId.splice(r,1))}},t.prototype.removeShapeHighlightCollection=function(){var t;if(this.shapeHighlightCollection.length>0)for(t=0;t<this.shapeHighlightCollection.length;t++){for(var n=this.shapeHighlightCollection[t],r=!0,i=0;i<this.maps.legendSelectionCollection.length;i++)this.maps.legendSelectionCollection[i].legendElement===n.legendElement&&(r=!1);r&&this.setColor(n.legendElement,n.legendOldFill,n.legendOldOpacity,n.legendOldBorderColor,n.legendOldBorderWidth,"highlight")}},t.prototype.shapeHighLightAndSelection=function(t,i,r,u,f){var b,y,h,p,v,d,o,a,it,rt,g,nt,tt;if(void 0!==i){this.updateLegendElement();this.shapeToggled=!0;var w=this.maps.legendModule.legendCollection,e=this.legendIndexOnShape(i,f),s=this.shapeDataOnLegend(t),ut=this.maps.toggledLegendId.indexOf(e.actualIndex);if(this.maps.legendSettings.toggleLegendSettings.enable&&-1!==ut)return this.shapeToggled=!1,this.legendHighlightCollection=[],b=this.getIndexofLegend(this.shapeHighlightCollection,s.LegendEle),-1!==b&&this.shapeHighlightCollection.splice(b,1),this.removeShapeHighlightCollection(),null;if(void 0===e.currentIndex&&void 0===e.actualIndex)return this.removeShapeHighlightCollection(),null;if(void 0!==e.currentIndex||"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||"ShapeselectionMapStyle"===t.getAttribute("class")||(this.maps.legendSelection=!1),"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||this.maps.legendSelection||(this.removeAllSelections(),this.maps.legendSelection=!0),void 0===e.currentIndex){if("selection"===u&&void 0!==e.actualIndex){for(y=0,h=0;h<s.Elements.length;h++)"ShapeselectionMapStyle"===s.Elements[h].getAttribute("class")&&y++;p=this.maps.selectedLegendElementId.indexOf(e.actualIndex);-1===p?(this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r):y<=1&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&(this.maps.layers[f].selectionSettings.enableMultiSelect?y<=1&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))&&this.maps.selectedLegendElementId.splice(p,1):this.maps.selectedLegendElementId.splice(p,1))}return this.removeShapeHighlightCollection(),null}var ft=w[e.actualIndex].text,k=void 0,l=void 0;if("Default"===this.maps.legendSettings.mode?void 0!==e.currentIndex&&(k=document.getElementById(this.maps.element.id+"_Legend_Text_Index_"+e.actualIndex).textContent,l=document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+e.actualIndex)):(k=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex+"_Text").textContent,l=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex)),this.oldShapeElement=s.LegendEle,v=this.maps.legendSelectionCollection.length,ft===k){if(d=!0,this.maps.legendSelectionCollection)for(h=0;h<this.maps.legendSelectionCollection.length;h++)if(this.maps.legendSelectionCollection[h].legendElement===s.LegendEle){d=!1;break}if("highlight"===u&&d){for((void 0===(a=this.isTargetSelected(s,this.shapeHighlightCollection))||a&&!a.IsSelected)&&this.pushCollection(l,this.shapeHighlightCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),o=0;o<this.shapeHighlightCollection.length;o++)s.LegendEle.id===this.shapeHighlightCollection[o].legendElement.id&&(this.shapeHighlightCollection[o].legendElement=s.LegendEle);if(v>0)for(o=0;o<v;o++){if(s.LegendEle===this.maps.legendSelectionCollection[o].legendElement){this.maps.legendSelectionCollection[o].legendElement=s.LegendEle;this.removeShapeHighlightCollection();break}o===v-1&&(this.removeShapeHighlightCollection(),this.setColor(l,n.isNullOrUndefined(r.fill)?l.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight"))}else this.removeShapeHighlightCollection(),this.setColor(l,n.isNullOrUndefined(r.fill)?l.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")}else if("selection"===u){if(a=this.isTargetSelected(s,this.maps.legendSelectionCollection),v>0)for(o=0;o<this.maps.legendSelectionCollection.length;)s.LegendEle===this.maps.legendSelectionCollection[o].legendElement||r.enableMultiSelect?o++:(it=this.maps.legendSelectionCollection[o],rt=this.maps.selectedLegendElementId.indexOf(e.actualIndex),this.maps.selectedLegendElementId.splice(rt,1),this.maps.legendSelectionCollection.splice(o,1),c(it.legendElement),this.maps.shapeSelections=!0,o=0);if(a&&a.IsSelected&&("ShapeselectionMapStyle"===t.getAttribute("class")||"LineselectionMapStyle"===t.getAttribute("class"))){if(g=0,r.enableMultiSelect)for(h=0;h<s.Elements.length;h++)t.getAttribute("class")===s.Elements[h].getAttribute("class")&&g++;g<=1&&(r.enableMultiSelect||this.maps.legendSelection)&&(this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(e.actualIndex),1),n.isNullOrUndefined(s.LegendEle)||c(s.LegendEle),this.maps.legendSelectionCollection.splice(a.SelectionIndex,1),this.maps.shapeSelections=!0)}else{for(void 0!==a&&(!a||a.IsSelected)||n.isNullOrUndefined(l)||-1===(tt=this.getIndexofLegend(this.maps.legendSelectionCollection,l))&&this.pushCollection(l,this.maps.legendSelectionCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),nt=!0,h=0;h<this.maps.selectedLegendElementId.length;h++)e.actualIndex===this.maps.selectedLegendElementId[h]&&(nt=!1);(nt&&this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r,this.removeLegend(this.shapeHighlightCollection),n.isNullOrUndefined(l))||(this.setColor(l,n.isNullOrUndefined(r.fill)?l.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),tt=this.getIndexofLegend(this.maps.legendSelectionCollection,l),this.maps.legendSelectionCollection[tt].MapShapeCollection.Elements.push(t));this.maps.shapeSelections=!1}}else document.getElementsByClassName("highlightMapStyle").length>0&&(this.removeShapeHighlightCollection(),c(document.getElementsByClassName("highlightMapStyle")[0]))}}else this.removeShapeHighlightCollection()},t.prototype.isTargetSelected=function(t,i){for(var u,r=0;r<i.length;r++)n.isNullOrUndefined(t.LegendEle.getAttribute("id"))||t.LegendEle.getAttribute("id")!==i[r].legendElement.getAttribute("id")||(u={IsSelected:!0,SelectionIndex:r});return u},t.prototype.updateLegendElement=function(){for(var n=0;n<this.maps.legendSelectionCollection.length;n++)document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id)&&(this.maps.legendSelectionCollection[n].legendElement=document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id))},t.prototype.getIndexofLegend=function(n,t){return n.map(function(n){return n.legendElement}).indexOf(t)},t.prototype.removeAllSelections=function(){for(var i,r,u,t=0;t<this.maps.selectedElementId.length;t++)c(r=document.getElementById(this.maps.selectedElementId[t]));for(i=0;i<this.maps.selectedLegendElementId.length;i++)r=("Interactive"===this.maps.legendSettings.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_")+this.maps.selectedLegendElementId[i],u=document.getElementById(r),n.isNullOrUndefined(u)||c(document.getElementById(r));this.maps.legendSelectionCollection=[];this.maps.selectedLegendElementId=[];this.maps.selectedElementId=[]},t.prototype.legendIndexOnShape=function(t,i){var c,l,o,a=t[this.maps.layers[i].shapeDataPath],s=this.maps.legendSettings.mode,h=this.maps.legendModule.legendCollection,v,u,f,e,r;for("Default"!==s||n.isNullOrUndefined(this.maps.legendModule.totalPages)||(o=this.maps.legendModule.totalPages[this.maps.legendModule.currentPage].Collection),v="Default"===s?o.length:1,u=0;u<h.length;u++){for(f=h[u].data,e=0;e<v;e++)if("Default"!==s||h[u].text===o[e].DisplayText)for(r=0;r<f.length;r++)a===f[r].name&&(c=e);for(r=0;r<f.length;r++)a===f[r].name&&(l=u)}return{currentIndex:c,actualIndex:l}},t.prototype.shapeDataOnLegend=function(t){for(var v,e,o,s,h,c=this.maps.legendModule.legendCollection,y=this.maps.legendSettings,r=0;r<c.length;r++){for(var u=c[r].data,l=!1,a=[],f={Elements:[]},i=0;i<u.length;i++)e=u[i].shapeIndex,o=u[i].layerIndex,s=u[i].dataIndex,t===(v=-1===(h=u[i].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+o+"_shapeIndex_"+e+"_dataIndex_"+s):document.getElementById(this.maps.element.id+"_LayerIndex_"+o+"_shapeIndex_"+e+"_dataIndex_"+s+"_multiLine_"+h))&&(l=!0),a.push(v);if(l)return n.isNullOrUndefined(f.LegendEle)&&(f.LegendEle="Default"===y.mode?document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+r):document.getElementById(this.maps.element.id+"_Legend_Index_"+r)),f.Elements=a,f}return null},t.prototype.shapesOfLegend=function(t){for(var o,u,f,e,s,c=parseFloat(t.id.charAt(t.id.length-1)),r=this.maps.legendModule.legendCollection[c].data,h=[],i=0;i<r.length;i++)u=r[i].shapeIndex,f=r[i].layerIndex,e=r[i].dataIndex,o=-1===(s=r[i].pointIndex)?document.getElementById(this.maps.element.id+"_LayerIndex_"+f+"_shapeIndex_"+u+"_dataIndex_"+e):document.getElementById(this.maps.element.id+"_LayerIndex_"+f+"_shapeIndex_"+u+"_dataIndex_"+e+"_multiLine_"+s),n.isNullOrUndefined(o)||h.push(o.id);return h},t.prototype.legendToggle=function(){var u=this.maps,f=u.legendSettings,t,s,i,h,r,c,l,e,a,o;if(this.maps.selectedLegendElementId)for(t=0;t<this.maps.selectedLegendElementId.length;t++)if(s="Interactive"===f.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_",i=u.svgObject.querySelector("#"+s+this.maps.selectedLegendElementId[t]),!n.isNullOrUndefined(i)){for(h=n.isNullOrUndefined(this.maps.legendSelectionClass.fill)?i.getAttribute("fill"):this.maps.legendSelectionClass.fill,this.setColor(i,h,this.maps.legendSelectionClass.opacity.toString(),this.maps.legendSelectionClass.border.color,this.maps.legendSelectionClass.border.width.toString(),"selection"),r=0;r<this.maps.legendSelectionCollection.length;r++)this.maps.legendSelectionCollection[r].legendElement.id===i.id&&(this.maps.legendSelectionCollection[r].legendElement=i);-1===this.getIndexofLegend(this.maps.legendSelectionCollection,i)&&(c=this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]].data[t].layerIndex,this.pushCollection(i,this.maps.legendSelectionCollection,this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]],this.maps.layers[c].shapeSettings))}if(this.maps.toggledLegendId)for(t=0;t<this.maps.toggledLegendId.length;t++)l="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]+"_Text":"#"+this.maps.element.id+"_Legend_Text_Index_"+this.maps.toggledLegendId[t],e=u.svgObject.querySelector(l),n.isNullOrUndefined(e)||e.setAttribute("fill","#E5E5E5"),a="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]:"#"+this.maps.element.id+"_Legend_Shape_Index_"+this.maps.toggledLegendId[t],o=u.svgObject.querySelector(a),n.isNullOrUndefined(o)||o.setAttribute("fill","#E5E5E5")},t.prototype.renderLegendBorder=function(){var r=this.maps,i=r.legendSettings,e=i.title.text,t={fontFamily:i.titleStyle.fontFamily,fontStyle:i.titleStyle.fontStyle,fontWeight:i.titleStyle.fontWeight,size:i.titleStyle.size,color:i.titleStyle.color,opacity:i.titleStyle.opacity},o=g(this.legendItemRect.width+20,e,t),f=l(o,t),u,s;this.legendBorderRect=new v(this.legendItemRect.x-10,this.legendItemRect.y-10-f.height,this.legendItemRect.width+20,this.legendItemRect.height+20+f.height+("Interactive"===i.mode?0:0!==this.page?10:0));u={color:i.border.color,width:i.border.width,opacity:i.border.opacity};u.opacity=n.isNullOrUndefined(u.opacity)?1:u.opacity;s=new b(r.element.id+"_Legend_Border",i.background,u,1,this.legendBorderRect,null,null,"","");this.legendGroup.appendChild(r.renderer.drawRectangle(s));this.getLegendAlignment(r,this.legendBorderRect.width,this.legendBorderRect.height,i);this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )");"Float"!==i.position&&r.svgObject.appendChild(this.legendGroup);e&&(t.color=null!==t.color?t.color:this.maps.themeStyle.legendTitleFontColor,t.fontFamily=n.isNullOrUndefined(t.fontFamily)?this.maps.themeStyle.fontFamily:t.fontFamily,t.size=n.isNullOrUndefined(t.size)?this.maps.themeStyle.subTitleFontSize||rt.legendTitleFont.size:t.size,t.fontWeight=n.isNullOrUndefined(t.fontWeight)?this.maps.themeStyle.titleFontWeight||rt.legendTitleFont.fontWeight:t.fontWeight,st(new tt(r.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-f.height/2-5,"middle",o,""),t,t.color,this.legendGroup))},t.prototype.changeNextPage=function(t){this.currentPage=t.target.id.indexOf("_Left_Page_")>-1?this.currentPage-1:this.currentPage+1;this.legendGroup=this.maps.renderer.createGroup({id:this.maps.element.id+"_Legend_Group"});this.maps.mapAreaRect=this.initialMapAreaRect;this.drawLegendItem(this.currentPage);n.isNullOrUndefined(this.maps.legendModule)||"Float"!==this.maps.legendSettings.position||(this.maps.isTileMap?this.maps.mapLayerPanel.layerGroup.appendChild(this.maps.legendModule.legendGroup):this.maps.svgObject.appendChild(this.maps.legendModule.legendGroup));e(this.maps.element.id+"_Legend_Border",this.maps.element.id)&&(e(this.maps.element.id+"_Legend_Border",this.maps.element.id).style.pointerEvents="none")},t.prototype.getLegendAlignment=function(t,i,r,u){var s,h,e,o=10,c=(e=n.extend({},t.mapAreaRect,e,!0)).x,l=e.y,a=e.height,b=e.width,v=t.availableSize.width,y=t.availableSize.height,p=n.isNullOrUndefined(u.location.x)?0:u.location.x,w=n.isNullOrUndefined(u.location.y)?0:u.location.y;if("Float"===u.position)this.translate=t.isTileMap?new f(p,w+2.5):new f(p+t.mapAreaRect.x,w+t.mapAreaRect.y),this.legendTotalRect=t.mapAreaRect;else{switch(u.position){case"Top":case"Bottom":e.height="Top"===u.position?a-r:a-r-20;s=v/2-i/2;h="Top"===u.position?l:l+e.height;e.y="Top"===u.position?l+r+(t.isTileMap?5:o):l-5;break;case"Left":case"Right":e.width=b-i-t.mapAreaRect.x;s="Left"===u.position?c+5:c+e.width+o;h=y/2-r/2;e.x="Left"===u.position?c+i+o:c}switch(u.alignment){case"Near":"Top"===u.position||"Bottom"===u.position?s=e.x-("Interactive"===u.mode?o:0):h=e.y-(u.height&&u.width||"Interactive"!==u.mode?0:t.mapAreaRect.x);break;case"Far":"Top"===u.position||"Bottom"===u.position?s=v-i-("Interactive"===u.mode?0:o):h=y-r-("Default"===u.mode?o:0)}(u.height||u.width)&&"Interactive"!==u.mode?this.legendTotalRect=t.mapAreaRect=t.totalRect=e:(t.totalRect=null,(u.height||u.width)&&"Interactive"===u.mode&&(t.totalRect=e),this.legendTotalRect=t.mapAreaRect=e);"Left"===u.position&&(t.mapAreaRect.width=e.width);this.translate=new f(s,h)}},t.prototype.getMarkersLegendCollections=function(t,i){var r=this;Array.prototype.forEach.call(i,function(i,u){var e=i.dataSource,f=i.legendText;Array.prototype.forEach.call(e,function(e,o){var a=!!n.isNullOrUndefined(e[r.maps.legendSettings.showLegendPath])||e[r.maps.legendSettings.showLegendPath],s;if(i.visible&&a&&!n.isNullOrUndefined(e.latitude)&&!n.isNullOrUndefined(e.longitude)){i.template&&(s=ii(i.template,r.maps)(r.maps),(n.isNullOrUndefined(s.childElementCount)?s[0]:s).querySelector("img").src);var h=n.isNullOrUndefined(e[f])?"":e[f],c=n.isNullOrUndefined(i.colorValuePath)?i.fill:e[i.colorValuePath],l=[];r.maps.legendSettings.removeDuplicateLegend?(l.push(r.getMarkerLegendData(t,h,c)),r.getOverallLegendItemsCollection(h,c,l,a)):(l.push({layerIndex:t,markerIndex:u,dataIndex:o,value:c,name:h,shape:n.isNullOrUndefined(i.shapeValuePath)||n.isNullOrUndefined(e[i.shapeValuePath])||""===e[i.shapeValuePath]?r.maps.legendSettings.useMarkerShape?i.shape:r.maps.legendSettings.shape:e[i.shapeValuePath]}),r.getOverallLegendItemsCollection(h,c,l,a))}})})},t.prototype.getMarkerLegendData=function(t,i,r){var f=this,u=[];return this.maps.layers[t].markerSettings.map(function(e,o){var s=e.dataSource;Array.prototype.forEach.call(s,function(e,s){var h=f.maps.layers[t].markerSettings[o];i!==e[h.legendText]&&""!==i||r!==e[h.colorValuePath]||u.push({layerIndex:t,markerIndex:o,dataIndex:s,value:r,name:i,shape:n.isNullOrUndefined(h.shapeValuePath)?h.shape:e[h.shapeValuePath]})})}),u},t.prototype.getRangeLegendCollection=function(t,i,r,u,f,e,s){for(var l,w=this,a=0,v=this.maps.legendSettings.fill,h=[],b=function(r){var c,p;n.isNullOrUndefined(r.from)||n.isNullOrUndefined(r.to)||(l=n.isNullOrUndefined(r.label)?r.from+" - "+r.to:r.label,h=[],c=!1,Array.prototype.forEach.call(u,function(n,u){var l=e.indexOf(".")>-1?Number(o(n,e)):parseFloat(n[e]);l>=r.from&&l<=r.to&&(c=!0,h.push(w.getLegendData(t,u,n,f,i,s,l)))}),c||h.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null}),p=n.isNullOrUndefined(v)?"[object Array]"===Object.prototype.toString.call(r.color)?n.isNullOrUndefined(r.value)?y.legendGradientColor(r,a):r.color[0]:r.color:v,a++,y.getOverallLegendItemsCollection(l,p,h,r.showLegend))},y=this,c=0,p=r;c<p.length;c++)b(p[c])},t.prototype.getOverallLegendItemsCollection=function(n,t,i,r){var f=[],s=this.maps.legendSettings,u,e,o;if(i.length>0&&r){for(u=0;u<i.length;u++){if(e=i[u],e.length>0)for(o=0;o<e.length;o++)f.push(e[o]);else f.push(i[u]);f._isVisible=!0}if(this.maps.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollection,n,t))for(u=0;u<this.legendCollection.length;u++)this.legendCollection[u].text===n&&this.legendCollection[u].fill===t&&this.legendCollection[u].data.push(f[0]);else this.legendCollection.push({text:n,fill:t,data:f,opacity:s.opacity,borderColor:s.shapeBorder.color,borderWidth:s.shapeBorder.width})}},t.prototype.removeDuplicates=function(n,t,i){for(var u=!1,r=0;r<n.length;r++)if((n[r].text===t||""===n[r].text)&&n[r].fill===i){u=!0;break}return u},t.prototype.getEqualLegendCollection=function(t,i,r,u,f,e,s){for(var l,v=this,w=this.maps.legendSettings.fill,c=[],a=[],h=[],y=[],d=function(p){var k,tt,nt,d,g,it,rt;if(n.isNullOrUndefined(p.value))n.isNullOrUndefined(p.minOpacity)&&n.isNullOrUndefined(p.maxOpacity)&&n.isNullOrUndefined(p.value)&&n.isNullOrUndefined(p.from)&&n.isNullOrUndefined(p.to)&&!n.isNullOrUndefined(p.color)&&((Array.prototype.forEach.call(u,function(n,r){for(var c=e.indexOf(".")>-1?o(n,e):n[e],u=0;u<h.length;u++)c===h[u]&&y.push(v.getLegendData(t,r,n,f,i,s,c))}),0===h.length)&&(k=!1,Array.prototype.forEach.call(u,function(u,o){k=!1;for(var h=u[e],c=0;c<r.length;c++)n.isNullOrUndefined(h)||isNaN(h)?k||(k=!1):h>=r[c].from&&h<=r[c].to&&(k=!0);k||y.push(v.getLegendData(t,o,u,f,i,s,h))})),l=n.isNullOrUndefined(p.label)?"Others":p.label,tt="[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color,b.getOverallLegendItemsCollection(l,tt,y,p.showLegend));else{for(l=n.isNullOrUndefined(p.label)?p.value:p.label,a=[],nt=!1,Array.prototype.forEach.call(u,function(n,r){var u=e.indexOf(".")>-1?o(n,e):n[e];u===p.value?(nt=!0,-1===c.indexOf(u)&&c.push(u),a.push(v.getLegendData(t,r,n,f,i,s,u))):-1===h.indexOf(u)&&h.push(u)}),d=0;d<c.length;d++)for(g=0;g<h.length;g++)c[d]===h[g]&&(it=h.indexOf(c[d]),h.splice(it,1));nt||a.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null});rt=n.isNullOrUndefined(w)?"[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color:w;b.getOverallLegendItemsCollection(l,rt,a,p.showLegend)}},b=this,p=0,k=r;p<k.length;p++)d(k[p])},t.prototype.getDataLegendCollection=function(t,i,r,u,f,e,s){var l,h=this,a=this.maps.legendSettings.fill,c=this.maps.legendSettings.valuePath;n.isNullOrUndefined(e)||n.isNullOrUndefined(u)||Array.prototype.forEach.call(u,function(u,v){var w=!!n.isNullOrUndefined(h.maps.legendSettings.showLegendPath)||!n.isNullOrUndefined(u[h.maps.legendSettings.showLegendPath])&&u[h.maps.legendSettings.showLegendPath],y=e.indexOf(".")>-1?o(u,e):u[e],p=[],b=n.isNullOrUndefined(a)?y:a;n.isNullOrUndefined(y)||0!==r.length||(l=n.isNullOrUndefined(u[c])?f.indexOf(".")>-1?o(u,f):u[f]:c.indexOf(".")>-1?o(u,c):u[c],p.push(h.getLegendData(t,v,u,f,i,s,y)));h.getOverallLegendItemsCollection(l,b,p,w)})},t.prototype.interactiveHandler=function(t){var o=t.target,i=this.maps.legendSettings,r=this.maps.element.id+"_Interactive_Legend",g="Layers"===i.type?"_shapeIndex_":"Markers"===i.type?"_MarkerIndex_":"_BubbleIndex_",l,b,a,u,h,f;if(o.id.indexOf(g)>1){var c=parseFloat(o.id.split("_LayerIndex_")[1].split("_")[0]),nt=parseFloat(o.id.split(/_dataIndex_/i)[1].split("_")[0]),y=void 0,p=void 0,w=void 0;if(n.isNullOrUndefined(e(r,this.maps.element.id))||n.remove(e(r,this.maps.element.id)),l=this.maps.layersCollection[c],b="Layers"===i.type?l.visible:"Markers"===i.type?l.markerSettings[parseFloat(o.id.split("_MarkerIndex_")[1].split("_")[0])].visible:this.maps.getBubbleVisible(this.maps.layersCollection[c]),i.visible&&this.legendRenderingCollections.length>0&&"Interactive"===i.mode&&b)for(a=this.maps.svgObject.getBoundingClientRect(),u=0;u<this.legendCollection.length;u++){var k=this.legendCollection[u],d=e(this.maps.element.id+"_Legend_Index_"+u,this.maps.element.id),s=d.getBoundingClientRect(),tt=new v(Math.abs(s.left-a.left),Math.abs(s.top-a.top),s.width,s.height);if(y=d.getAttribute("fill"),p=i.shapeBorder.color,w=i.shapeBorder.width,!n.isNullOrUndefined(k.data))for(h=k.data,f=0;f<h.length;f++)if(nt===h[f].dataIndex&&c===h[f].layerIndex){this.renderInteractivePointer(i,y,p,r,w,tt);break}}}else n.isNullOrUndefined(e(r,this.maps.element.id))||n.remove(e(r,this.maps.element.id))},t.prototype.renderInteractivePointer=function(n,t,i,r,u,f){var l,e,o,s=10,h=10,a="None"===n.orientation?"Top"===n.position||"Bottom"===n.position?"Horizontal":"Vertical":n.orientation,c;f.y="Float"===n.position&&this.maps.isTileMap?f.y-this.maps.mapAreaRect.y:f.y;l="Horizontal"===a?n.invertedPointer?" M "+(e=f.x+f.width/2-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height)+" L "+(e-h)+" "+(o+s)+" L "+(e+h)+" "+(o+s)+" Z ":" M "+(e=f.x+f.width/2-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y)+" L "+(e-h)+" "+(o-s)+" L "+(e+h)+" "+(o-s)+" Z ":n.invertedPointer?" M "+(e=f.x-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height/2)+" L "+(e-h)+" "+(o-s)+" L "+(e-h)+" "+(o+s)+" z ":" M "+(e=f.x+f.width-("Float"===n.position&&this.maps.isTileMap?this.maps.mapAreaRect.x:0))+" "+(o=f.y+f.height/2)+" L "+(e+h)+" "+(o-s)+" L "+(e+h)+" "+(o+s)+" z ";c=new y(r,t,u,i,1,1,"",l);"Float"===n.position&&this.maps.isTileMap?this.maps.mapLayerPanel.layerGroup.appendChild(this.maps.renderer.drawPath(c)):this.maps.svgObject.appendChild(this.maps.renderer.drawPath(c))},t.prototype.wireEvents=function(t){n.EventHandler.add(t,n.Browser.touchStartEvent,this.changeNextPage,this)},t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.interactiveHandler,this),this.maps.on(n.Browser.touchEndEvent,this.interactiveHandler,this),this.maps.on(et,this.legendClick,this))},t.prototype.markerToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].markerSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].markerSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].markerSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].markerSettings[r].border.opacity)?this.maps.layers[i].markerSettings[r].opacity:this.maps.layers[i].markerSettings[r].border.opacity).toString())},t.prototype.bubbleToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].bubbleSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].bubbleSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].bubbleSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].bubbleSettings[r].border.opacity)?this.maps.layers[i].bubbleSettings[r].opacity:this.maps.layers[i].bubbleSettings[r].border.opacity).toString())},t.prototype.legendClick=function(t){var f,s,p=this.maps.legendSettings.toggleLegendSettings.fill,k=this.maps.legendSettings.toggleLegendSettings.opacity,d=this.maps.legendSettings.toggleLegendSettings.border.color,g=this.maps.legendSettings.toggleLegendSettings.border.width,nt=n.isNullOrUndefined(this.maps.legendSettings.toggleLegendSettings.border.opacity)?this.maps.legendSettings.toggleLegendSettings.opacity:this.maps.legendSettings.toggleLegendSettings.border.opacity,i,u,o,h,it,tt,b,a,y,c,rt;if(t.parentNode.id.indexOf(this.maps.element.id+"_Legend_Index_")>-1){var v=void 0,r=parseFloat(t.parentElement.id.substr((this.maps.element.id+"_Legend_Index_").length)),w=(b=this.legendCollection[r].data)._isVisible,l=void 0;if(this.maps.legendSettings.toggleLegendSettings.enable&&("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type))for(i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(o=0;o<b.length;o++)l=this.legendCollection[r].data[o],v="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+l.dataIndex,this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_MarkerIndex_"+l.markerIndex+"_dataIndex_"+l.dataIndex,this.maps.element.id),n.isNullOrUndefined(l.shape)||"Balloon"!==l.shape||(v=(v="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+l.dataIndex+"_Group",this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_MarkerIndex_"+l.markerIndex+"_dataIndex_"+l.dataIndex+"_Group",this.maps.element.id)).children[0]),w&&null!==v?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(v.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),v.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color),v.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),v.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),v.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(v.setAttribute("fill",p),v.setAttribute("fill-opacity",k.toString()),v.setAttribute("stroke",d),v.setAttribute("stroke-width",g.toString()),v.setAttribute("stroke-opacity",nt.toString())),null!==t&&(f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[i].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[i].shapeSettings.border.color,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[i].shapeSettings.fill):this.setToggleAttributes(s,f,p,k,d,g,nt,p))):("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(v,i,u,r):this.bubbleToggleSelection(v,i,u,r),null!==t&&(f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,"#757575"),"HorizontalLine"!==this.maps.legendSettings.shape&&"VerticalLine"!==this.maps.legendSettings.shape&&"Cross"!==this.maps.legendSettings.shape||f.setAttribute("stroke",this.legendCollection[r].fill)));b._isVisible=!w}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(h=void 0,this.removeCollections(t,r),it=this.maps.toggledLegendId.indexOf(r),-1!==it&&(w=!1),u=0;u<this.maps.layers.length;u++)for(o=0;o<b.length;o++)(l=this.legendCollection[r].data[o],null!==(h=e(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_shapeIndex_"+l.shapeIndex+"_dataIndex_"+l.dataIndex,this.maps.element.id)))&&(tt=this.maps.toggledShapeElementId.indexOf(h.id),w?(0===o&&this.maps.toggledLegendId.push(r),-1===tt&&this.maps.toggledShapeElementId.push(h.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(h.setAttribute("fill",this.maps.layers[u].shapeSettings.fill),h.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),h.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),h.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),h.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString())):(h.setAttribute("fill",p),h.setAttribute("fill-opacity",k.toString()),h.setAttribute("stroke",d),h.setAttribute("stroke-width",g.toString()),h.setAttribute("stroke-opacity",nt.toString())),null!==t&&(s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[u].shapeSettings.fill,this.maps.layers[u].shapeSettings.opacity,this.maps.layers[u].shapeSettings.border.color,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity,this.maps.layers[u].shapeSettings.fill):this.setToggleAttributes(s,f,p,k,d,g,nt,p))):(-1!==it&&0===o&&this.maps.toggledLegendId.splice(it,1),-1!==tt&&this.maps.toggledShapeElementId.splice(tt,1),h.setAttribute("fill",this.legendCollection[r].fill),h.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString()),h.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),h.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),h.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),null!==t&&(s=e(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id),f=e(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,"#757575"))));b._isVisible=!w}}else if(!n.isNullOrUndefined(t.id)&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendSettings.visible&&-1===t.id.indexOf("_Text")){if(a=void 0,y=void(r=parseFloat(t.id.split(this.maps.element.id+"_Legend_Index_")[1])),w=(b=this.legendCollection[r].data)._isVisible,("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type)&&this.maps.legendSettings.toggleLegendSettings.enable)for(i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(o=0;o<b.length;o++)y=this.legendCollection[r].data[o],a="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+y.dataIndex,this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+y.dataIndex,this.maps.element.id),n.isNullOrUndefined(y.shape)||"Balloon"!==y.shape||(a=(a="Bubbles"===this.maps.legendSettings.type?e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+y.dataIndex+"_Group",this.maps.element.id):e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+y.dataIndex+"_Group",this.maps.element.id)).children[0]),w&&null!==a?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(a.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),a.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color),a.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),a.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),a.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString())):(a.setAttribute("fill",p),a.setAttribute("fill-opacity",k.toString()),a.setAttribute("stroke",d),a.setAttribute("stroke-width",g.toString()),a.setAttribute("stroke-opacity",nt.toString())),null!==t&&(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[i].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[i].shapeSettings.border.color,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[i].shapeSettings.fill):this.setToggleAttributes(s,f,p,k,d,g,nt,p))):("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(a,i,u,r):this.bubbleToggleSelection(a,i,u,r),null!==t&&((f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill),f.setAttribute("fill-opacity",this.legendCollection[r].opacity),f.setAttribute("stroke",this.legendCollection[r].shapeBorder.color),f.setAttribute("stroke-width",this.legendCollection[r].shapeBorder.width),f.setAttribute("stroke-opacity",this.legendCollection[r].shapeBorder.opacity),(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id)).setAttribute("fill","#757575")));b._isVisible=!w}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(c=void 0,this.removeCollections(t,r),rt=this.maps.toggledLegendId.indexOf(r),-1!==rt&&(w=!1),i=0;i<this.maps.layers.length;i++)for(o=0;o<b.length;o++)y=this.legendCollection[r].data[o],null!==(c=e(this.maps.element.id+"_LayerIndex_"+y.layerIndex+"_shapeIndex_"+y.shapeIndex+"_dataIndex_"+y.dataIndex,this.maps.element.id))&&(tt=this.maps.toggledShapeElementId.indexOf(c.id),w?(0===o&&this.maps.toggledLegendId.push(r),-1===tt&&this.maps.toggledShapeElementId.push(c.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(c.setAttribute("fill",this.maps.layers[0].shapeSettings.fill),c.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),c.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),c.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),c.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(c.setAttribute("fill",p),c.setAttribute("fill-opacity",k.toString()),c.setAttribute("stroke",d),c.setAttribute("stroke-width",g.toString()),c.setAttribute("stroke-opacity",nt.toString())),null!==t&&(f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?this.setToggleAttributes(s,f,this.maps.layers[0].shapeSettings.fill,this.maps.layers[i].shapeSettings.opacity,this.maps.layers[0].shapeSettings.border.color,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width,n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity,this.maps.layers[0].shapeSettings.fill):this.setToggleAttributes(s,f,p,k,d,g,nt,p))):(-1!==rt&&0===o&&this.maps.toggledLegendId.splice(rt,1),-1!==tt&&this.maps.toggledShapeElementId.splice(tt,1),c.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),c.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),c.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),c.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),c.setAttribute("fill",this.legendCollection[r].fill),null!==t&&(s=e(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id),f=e(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id),this.setToggleAttributes(s,f,this.legendCollection[r].fill,this.legendCollection[r].opacity,this.legendCollection[r].shapeBorder.color,this.legendCollection[r].shapeBorder.width,this.legendCollection[r].shapeBorder.opacity,"#757575"))));b._isVisible=!w}}},t.prototype.removeCollections=function(n,t){var i,r,u;this.removeLegendSelectionCollection(n);i=this.getIndexofLegend(this.maps.legendSelectionCollection,n);-1!==i&&this.maps.legendSelectionCollection.splice(i,1);-1!==this.getIndexofLegend(this.legendHighlightCollection,n)&&this.legendHighlightCollection.splice(i,1);r=this.getIndexofLegend(this.shapeHighlightCollection,n);-1!==r&&this.shapeHighlightCollection.splice(r,1);u=this.maps.selectedLegendElementId.indexOf(t);-1!==u&&this.maps.selectedLegendElementId.splice(u,1)},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(n.Browser.touchMoveEvent,this.interactiveHandler),this.maps.off(n.Browser.touchEndEvent,this.interactiveHandler),this.maps.off(et,this.legendClick))},t.prototype.getLegendData=function(t,i,r,u,f,e,s){var y=[],c,v;if("[object Array]"===Object.prototype.toString.call(f))for(c=0;c<f.length;c++){var h=f[c],l=u.indexOf(".")>-1?o(r,u):r[u],a=ti(r[u],e,h.properties),p=n.isNullOrUndefined(l)||"string"!=typeof l?l:l.toLowerCase();if((!n.isNullOrUndefined(h.properties[a])&&isNaN(h.properties[a])?h.properties[a].toLowerCase():h.properties[a])===p)if("MultiPoint"!==h.geometry.type)y.push({layerIndex:t,shapeIndex:c,dataIndex:i,name:r[u],value:s,pointIndex:-1});else for(v=0;v<h.geometry.coordinates.length;v++)y.push({layerIndex:t,shapeIndex:c,dataIndex:i,name:r[u],value:s,pointIndex:v})}return y},t.prototype.setToggleAttributes=function(t,i,r,u,f,e,o,s){t.setAttribute("fill",s);i.setAttribute("fill",r);i.setAttribute("fill-opacity",u.toString());i.setAttribute("stroke",f);i.setAttribute("stroke-width",e.toString());n.isNullOrUndefined(o)||i.setAttribute("stroke-opacity",o.toString())},t.prototype.legendGradientColor=function(t,i){var o,s="http://www.w3.org/2000/svg",u,h,f,c;if(!n.isNullOrUndefined(t.color)&&"object"==typeof t.color){var r=document.createElementNS(s,"linearGradient"),e=this.maps.legendSettings.position,l="Top"===e||"Bottom"===e?"100":"0",a="Top"===e||"Bottom"===e?"0":"100";for(r.setAttribute("id","linear_"+i+"_"+this.maps.element.id),r.setAttribute("x1","0%"),r.setAttribute("y1","0%"),r.setAttribute("x2",l+"%"),r.setAttribute("y2",a+"%"),u=0;u<t.color.length;u++)h=100/(t.color.length-1),f=document.createElementNS(s,"stop"),f.setAttribute("offset",u*h+"%"),f.setAttribute("stop-color",t.color[u]),f.setAttribute("stop-opacity",1..toString()),r.appendChild(f);this.legendLinearGradient=r;c="url(#linear_"+i+"_"+this.maps.element.id+")";this.defsElement.appendChild(r);o=c}return o},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.legendCollection=[];this.legendRenderingCollections=[];this.translate=null;this.legendBorderRect=null;this.initialMapAreaRect=null;this.legendTotalRect=null;this.totalPages=[];this.legendItemRect=null;this.legendGroup=null;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.legendLinearGradient=null;this.currentLayer=null;this.defsElement=null;this.legendElement=[];this.oldShapeElement=null;this.removeEventListener();this.maps=null},t}(),fo=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.mouseMove,this),this.maps.on(n.Browser.touchStartEvent,this.mouseMove,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(n.Browser.touchMoveEvent,this.mouseMove),this.maps.off(n.Browser.touchStartEvent,this.mouseMove))},t.prototype.addHighlight=function(n,t,i){var r=pr(n,t,0,this.maps);i?this.mapHighlight(r,null,null):c(r)},t.prototype.mouseMove=function(t){var r,i=t.target,y="touch"===t.pointerType||"2"===t.pointerType||t.type.indexOf("touch")>-1,l,a,u,f,v;if((-1!==i.id.indexOf("LayerIndex")||i.id.indexOf("NavigationIndex")>-1)&&"ShapeselectionMapStyle"!==i.getAttribute("class")&&!y&&"MarkerselectionMapStyle"!==i.getAttribute("class")&&"BubbleselectionMapStyle"!==i.getAttribute("class")&&"navigationlineselectionMapStyle"!==i.getAttribute("class")&&"LineselectionMapStyle"!==i.getAttribute("class")){r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10);var s=void 0,o=void 0,h=void 0,e=void 0;i.id.indexOf("shapeIndex")>-1?(h=parseInt(i.id.split("_shapeIndex_")[1].split("_")[0],10),s=this.maps.layers[r].shapeData.features&&!n.isNullOrUndefined(this.maps.layersCollection[r].layerData[h])?this.maps.layersCollection[r].layerData[h].property:null,e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=n.isNullOrUndefined(e)?null:this.maps.layers[r].dataSource[e],this.highlightSettings=this.maps.layers[r].highlightSettings):i.id.indexOf("BubbleIndex")>-1?(l=parseInt(i.id.split("_BubbleIndex_")[1].split("_")[0],10),e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].bubbleSettings[l].dataSource[e],this.highlightSettings=this.maps.layers[r].bubbleSettings[l].highlightSettings):i.id.indexOf("MarkerIndex")>-1?(a=parseInt(i.id.split("_MarkerIndex_")[1].split("_")[0],10),e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].markerSettings[a].dataSource[e],this.highlightSettings=this.maps.layers[r].markerSettings[a].highlightSettings):(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10),s=null,o={latitude:this.maps.layers[r].navigationLineSettings[u].latitude,longitude:this.maps.layers[r].navigationLineSettings[u].longitude},this.highlightSettings=this.maps.layers[r].navigationLineSettings[u].highlightSettings);this.highlightSettings.enable?this.handleHighlight(i,r,o,s):(f=document.getElementsByClassName("highlightMapStyle")[0],!n.isNullOrUndefined(f)&&(c(f),f.id.indexOf("NavigationIndex")>-1)&&(u=parseInt(f.id.split("_NavigationIndex_")[1].split("_")[0],10),v=parseInt(f.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),f.setAttribute("stroke-width",this.maps.layers[v].navigationLineSettings[u].width.toString()),f.setAttribute("stroke",this.maps.layers[v].navigationLineSettings[u].color)))}else ct("highlightMapStyle").length>0?((i=ct("highlightMapStyle")[0]).id.indexOf("NavigationIndex")>-1&&(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[r].navigationLineSettings[u].width.toString()),i.setAttribute("stroke",this.maps.layers[r].navigationLineSettings[u].color)),c(i),this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeShapeHighlightCollection()):(-1!==i.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")||-1!==i.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule&&this.maps.legendSettings.visible&&-1===i.id.indexOf("_Text")?this.maps.legendModule.legendHighLightAndSelection(i,"highlight"):this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeLegendHighlightCollection()},t.prototype.handleHighlight=function(n,t,i,r){this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule&&"Layers"===this.maps.legendSettings.type&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.highlightSettings,"highlight",t);n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule&&!this.maps.legendModule.shapeToggled||this.mapHighlight(n,r,i)},t.prototype.mapHighlight=function(t,i,r){var a=this,v=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),c=!1,l,u;t.id.indexOf("MarkerIndex")>-1&&(l=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),c=this.maps.layers[v].markerSettings[l].highlightSettings.enable);var o=-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.color:this.highlightSettings.fill||this.highlightSettings.border.color,s=-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.width/(c?1:this.maps.scale):this.highlightSettings.border.width/this.maps.scale,h=n.isNullOrUndefined(this.highlightSettings.border.opacity)?this.highlightSettings.opacity:this.highlightSettings.border.opacity,f={opacity:this.highlightSettings.opacity,fill:-1===t.parentElement.id.indexOf("LineString")?-1===t.id.indexOf("NavigationIndex")?n.isNullOrUndefined(this.highlightSettings.fill)?t.getAttribute("fill"):this.highlightSettings.fill:"none":"transparent",border:{color:o,width:s,opacity:h},cancel:!1},e={opacity:f.opacity,fill:f.fill,border:{color:o,width:s,opacity:h},name:pu,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};t.id.indexOf("shapeIndex")>-1&&this.maps.trigger(pu,e,function(){});u={opacity:f.opacity,fill:f.fill,border:{color:o,width:s,opacity:h},name:sf,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};this.maps.trigger(sf,u,function(){u.cancel=f.cancel!==u.cancel?u.cancel:t.id.indexOf("shapeIndex")>-1?e.cancel:f.cancel;u.fill=f.fill!==u.fill?u.fill:t.id.indexOf("shapeIndex")>-1?e.fill:f.fill;u.opacity=f.opacity!==u.opacity?u.opacity:t.id.indexOf("shapeIndex")>-1?e.opacity:f.opacity;u.border.color=f.border.color!==u.border.color?u.border.color:t.id.indexOf("shapeIndex")>-1?e.border.color:f.border.color;u.border.width=f.border.width!==u.border.width?u.border.width:t.id.indexOf("shapeIndex")>-1?e.border.width:f.border.width;u.border.opacity=f.border.opacity!==u.border.opacity?u.border.opacity:t.id.indexOf("shapeIndex")>-1?e.border.opacity:f.border.opacity;a.highlightMap(t,u)})},t.prototype.highlightMap=function(n,t){var i,r,u;"highlightMapStyle"===n.getAttribute("class")||t.cancel||(ct("highlightMapStyle").length>0&&(i=ct("highlightMapStyle")[0],(c(i),i.id.indexOf("NavigationIndex")>-1)&&(r=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),u=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[u].navigationLineSettings[r].width.toString()),i.setAttribute("stroke",this.maps.layers[u].navigationLineSettings[r].color))),s("highlightMap")?lt("highlightMap","highlightMapStyle",t):document.body.appendChild(pt("highlightMap","highlightMapStyle",t)),n.setAttribute("class","highlightMapStyle"))},t.prototype.getModuleName=function(){return"Highlight"},t.prototype.destroy=function(){this.highlightSettings=null;this.removeEventListener();this.maps=null},t}(),eo=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||this.maps.on(et,this.mouseClick,this)},t.prototype.removeEventListener=function(){this.maps.isDestroyed||this.maps.off(et,this.mouseClick)},t.prototype.mouseClick=function(t){var s,h,e;if(!n.isNullOrUndefined(t.type)&&-1!==t.type.indexOf("touch")&&n.isNullOrUndefined(t.id)&&(t=t.target),!n.isNullOrUndefined(t.id)&&(t.id.indexOf("LayerIndex")>-1||t.id.indexOf("NavigationIndex")>-1)){var o=void 0,u=void 0,f=void 0,r=void 0,i=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10);t.id.indexOf("shapeIndex")>-1?(f=parseInt(t.id.split("_shapeIndex_")[1].split("_")[0],10),o=!n.isNullOrUndefined(this.maps.layers[i].shapeData.features)&&this.maps.layers[i].shapeData.features.length>f?this.maps.layers[i].shapeData.features[f].properties:!n.isNullOrUndefined(this.maps.layers[i].shapeData.geometries)&&this.maps.layers[i].shapeData.geometries.length>f?this.maps.layers[i].shapeData.geometries[f].properties:null,r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=n.isNullOrUndefined(r)?null:this.maps.layers[i].dataSource[r],this.selectionsettings=this.maps.layers[i].selectionSettings,this.selectionType="Shape"):t.id.indexOf("BubbleIndex")>-1?(s=parseInt(t.id.split("_BubbleIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].bubbleSettings[s].dataSource[r],this.selectionsettings=this.maps.layers[i].bubbleSettings[s].selectionSettings,this.selectionType="Bubble"):t.id.indexOf("MarkerIndex")>-1?(h=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].markerSettings[h].dataSource[r],this.selectionsettings=this.maps.layers[i].markerSettings[h].selectionSettings,this.selectionType="Marker"):t.id.indexOf("NavigationIndex")>-1&&(e=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),o=null,u={latitude:this.maps.layers[i].navigationLineSettings[e].latitude,longitude:this.maps.layers[i].navigationLineSettings[e].longitude},this.selectionsettings=this.maps.layers[i].navigationLineSettings[e].selectionSettings,this.selectionType="navigationline");!n.isNullOrUndefined(this.selectionsettings)&&this.selectionsettings.enable&&this.selectElement(t,i,u,o)}else this.maps.legendSettings.visible&&!this.maps.legendSettings.toggleLegendSettings.enable&&this.maps.legendModule&&!n.isNullOrUndefined(t.id)&&-1===t.id.indexOf("_Text")&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule.legendHighLightAndSelection(t,"selection")},t.prototype.selectElement=function(n,t,i,r){this.maps.mapSelect=!!n;this.maps.legendModule&&this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.selectionsettings,"selection",t);(!(n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule)||this.maps.legendModule.shapeToggled)&&this.selectMap(n,r,i)},t.prototype.addSelection=function(n,t,i){var r=pr(n,t,0,this.maps);i?this.selectMap(r,null,null):c(r)},t.prototype.selectMap=function(t,i,u){var f=this,o=(parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),t.parentElement.id.indexOf("LineString")>-1),h=(this.selectionsettings,{color:o&&this.selectionsettings.fill||this.selectionsettings.border.color,width:o?this.selectionsettings.border.width/this.maps.scale:this.selectionsettings.border.width/("Marker"===this.selectionType?1:this.maps.scale),opacity:this.selectionsettings.border.opacity}),e={opacity:this.selectionsettings.opacity,fill:o?"transparent":"navigationline"!==this.selectionType?this.selectionsettings.fill:"none",border:h,name:of,target:t.id,cancel:!1,shapeData:i,data:u,maps:this.maps};this.maps.trigger("itemSelection",e,function(){var l,h,v,i,b,p,k,w;if(e.border.opacity=n.isNullOrUndefined(f.selectionsettings.border.opacity)?f.selectionsettings.opacity:f.selectionsettings.border.opacity,!e.cancel)if(t.getAttribute("class")===f.selectionType+"selectionMapStyle"||"LineselectionMapStyle"===t.getAttribute("class")){for(c(t),f.removedSelectionList(t),l=0;l<f.maps.shapeSelectionItem.length;l++)if(f.maps.shapeSelectionItem[l]===e.shapeData){f.maps.shapeSelectionItem.splice(l,1);break}t.id.indexOf("NavigationIndex")>-1&&(h=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),v=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),t.setAttribute("stroke-width",f.maps.layers[v].navigationLineSettings[h].width.toString()),t.setAttribute("stroke",f.maps.layers[v].navigationLineSettings[h].color))}else{if(i=r(f.maps.element.id+"_Layer_Collections"),!f.selectionsettings.enableMultiSelect&&(i.getElementsByClassName(f.selectionType+"selectionMapStyle").length>0||i.getElementsByClassName("LineselectionMapStyle").length>0)){for(var y=i.getElementsByClassName(f.selectionType+"selectionMapStyle").length,u=void 0,a=0;a<y;a++)c(u=i.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),f.removedSelectionList(u);if(i.getElementsByClassName("LineselectionMapStyle").length>0)for(y=i.getElementsByClassName("LineselectionMapStyle").length,a=0;a<y;a++)c(u=i.getElementsByClassName("LineselectionMapStyle")[0]),f.removedSelectionList(u);if("Shape"===f.selectionType)for(f.maps.shapeSelectionItem=[],b=f.maps.selectedElementId.length,p=0;p<b;p++)c(u=i.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),k=f.maps.selectedElementId.indexOf(u.getAttribute("id")),f.maps.selectedElementId.splice(k,1);u.id.indexOf("NavigationIndex")>-1&&(h=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),w=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),u.setAttribute("stroke-width",f.maps.layers[w].navigationLineSettings[h].width.toString()),u.setAttribute("stroke",f.maps.layers[w].navigationLineSettings[h].color))}o?(s("LineselectionMap")?lt("LineselectionMap","LineselectionMapStyle",e):document.body.appendChild(pt("LineselectionMap","LineselectionMapStyle",e)),t.setAttribute("class","LineselectionMapStyle")):(s(f.selectionType+"selectionMap")?lt(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e):document.body.appendChild(pt(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e)),t.setAttribute("class",f.selectionType+"selectionMapStyle"));"ShapeselectionMapStyle"===t.getAttribute("class")&&(f.maps.shapeSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedElementId.push(t.getAttribute("id")),f.maps.shapeSelectionItem.push(e.shapeData));"MarkerselectionMapStyle"===t.getAttribute("class")&&(f.maps.markerSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedMarkerElementId.push(t.getAttribute("id")));"BubbleselectionMapStyle"===t.getAttribute("class")&&(f.maps.bubbleSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedBubbleElementId.push(t.getAttribute("id")));"navigationlineselectionMapStyle"===t.getAttribute("class")&&(f.maps.navigationSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedNavigationElementId.push(t.getAttribute("id")))}})},t.prototype.removedSelectionList=function(n){"Shape"===this.selectionType&&this.maps.selectedElementId.splice(this.maps.selectedElementId.indexOf(n.getAttribute("id")),1);"Bubble"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1);"Marker"===this.selectionType&&this.maps.selectedMarkerElementId.splice(this.maps.selectedMarkerElementId.indexOf(n.getAttribute("id")),1);"navigationline"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1)},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.selectionsettings=null;this.removeEventListener();this.maps=null},t}(),oo=function(){function t(n){this.maps=n;this.tooltipId=this.maps.element.id+"_mapsTooltip";this.addEventListener()}return t.prototype.renderTooltip=function(t){var ut,ft,d,st,f,y,i,r=this,ht,w,k,tt,it,at,pt,a,rt;-1!==t.type.indexOf("touch")?(this.isTouch=!0,ut=(st=t).changedTouches[0].pageX,ft=st.changedTouches[0].pageY,d=st.target):(this.isTouch="touch"===t.pointerType,ut=t.pageX,ft=t.pageY,d=t.target);this.maps.isDevice&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3));var g,nt,ct,h="",e=d.id,p=[],c=e.indexOf("_LayerIndex_")>-1&&parseFloat(e.split("_LayerIndex_")[1].split("_")[0]),u=this.maps.layersCollection[c],wt=hi(ut,ft,this.maps.svgObject);if(this.tooltipTargetID=e,(e.indexOf("_shapeIndex_")>-1||e.indexOf("_MarkerIndex_")>-1||e.indexOf("_BubbleIndex_")>-1)&&null===this.maps.markerDragArgument){if(e.indexOf("_shapeIndex_")>-1){if(i=u.tooltipSettings,ht=parseInt(e.split("_shapeIndex_")[1].split("_")[0],10),n.isNullOrUndefined(u.layerData)||n.isNullOrUndefined(u.layerData[ht]))return;var l=u.layerData[ht].property,lt=!1,b="[object Array]"===Object.prototype.toString.call(u.shapePropertyPath)?u.shapePropertyPath:[u.shapePropertyPath];if(!n.isNullOrUndefined(b)){for(w=0;w<b.length;w++)for(k=0;k<u.dataSource.length;k++)if(tt=u.dataSource[k],it=u.shapeDataPath.indexOf(".")>-1?o(tt,u.shapeDataPath):tt[u.shapeDataPath],(!n.isNullOrUndefined(it)&&isNaN(tt[u.shapeDataPath])?it.toLowerCase():it)===(!n.isNullOrUndefined(l[b[w]])&&isNaN(l[b[w]])?l[b[w]].toLowerCase():l[b[w]])){lt=!0;c=k;w=b.length;break}if(c=lt?c:null,!n.isNullOrUndefined(u.dataSource[c]))for(nt in p=JSON.parse(JSON.stringify(u.dataSource[c])),l)p.hasOwnProperty(nt)||(p[nt]=l[nt])}!i.visible||(n.isNullOrUndefined(c)||isNaN(c))&&n.isNullOrUndefined(l)||(u.tooltipSettings.format?h=this.formatter(u.tooltipSettings.format,p):(at=ti(u.shapeDataPath,u.shapePropertyPath,l),h=n.isNullOrUndefined(u.dataSource)||n.isNullOrUndefined(c)?l[at]:vt(i.valuePath.indexOf(".")>-1?o(u.dataSource[c],i.valuePath):u.dataSource[c][i.valuePath],this.maps),n.isNullOrUndefined(h)&&(h=i.valuePath.indexOf(".")>-1?o(l,i.valuePath):l[i.valuePath])))}else if(e.indexOf("_MarkerIndex_")>-1){var yt=parseInt(e.split("_MarkerIndex_")[1].split("_")[0],10),v=parseInt(e.split("_MarkerIndex_")[1].split("_")[2],10),s=u.markerSettings[yt];i=s.tooltipSettings;p=s.dataSource[v];i.visible&&!isNaN(yt)&&(h=s.tooltipSettings.format?this.formatter(s.tooltipSettings.format,s.dataSource[v]):"function"!=typeof s.template&&s.template&&!s.tooltipSettings.valuePath?s.template.split(">")[1].split("<")[0]:vt(s.tooltipSettings.valuePath.indexOf(".")>-1?o(s.dataSource[v],s.tooltipSettings.valuePath):s.dataSource[v][s.tooltipSettings.valuePath],this.maps))}else e.indexOf("_BubbleIndex_")>-1&&(pt=parseInt(e.split("_BubbleIndex_")[1].split("_")[0],10),a=(v=parseInt(e.split("_BubbleIndex_")[1].split("_")[2],10),u.bubbleSettings[pt]),i=a.tooltipSettings,p=a.dataSource[v],i.visible&&!isNaN(v)&&(h=a.tooltipSettings.format?this.formatter(a.tooltipSettings.format,a.dataSource[v]):vt(a.tooltipSettings.valuePath.indexOf(".")>-1?o(a.dataSource[v],a.tooltipSettings.valuePath):a.dataSource[v][a.tooltipSettings.valuePath],this.maps)));document.getElementById(this.tooltipId)?g=document.getElementById(this.tooltipId):((g=n.createElement("div",{id:this.maps.element.id+"_mapsTooltip",className:"EJ2-maps-Tooltip"})).style.cssText="position: absolute;pointer-events:none;",document.getElementById(this.maps.element.id+"_Secondary_Element").appendChild(g));"function"!=typeof i.template&&null!==i.template&&1===Object.keys("object"==typeof i.template?i.template:{}).length&&(i.template=i.template[Object.keys(i.template)[0]]);rt={location:wt,text:[],data:p=this.setTooltipContent(i,p),textStyle:{color:i.textStyle.color,fontFamily:i.textStyle.fontFamily,fontStyle:i.textStyle.fontStyle,fontWeight:i.textStyle.fontWeight,opacity:i.textStyle.opacity,size:i.textStyle.size},template:i.template};f={cancel:!1,name:yu,options:rt,fill:i.fill,maps:this.maps,element:d,eventArgs:t,content:n.isNullOrUndefined(h)?"":h.toString()};this.maps.trigger(yu,f,function(){if(f.cancel||!i.visible||n.isNullOrUndefined(h)||-1!==e.indexOf("_cluster_")||-1!==e.indexOf("_dataLabel_"))r.clearTooltip(t.target);else if(r.maps.isProtectedOnChange=!0,f.options.textStyle.size=f.options.textStyle.size||r.maps.themeStyle.fontSize,f.options.textStyle.color=f.options.textStyle.color||r.maps.themeStyle.tooltipFontColor,f.options.textStyle.fontFamily=f.options.textStyle.fontFamily||r.maps.themeStyle.fontFamily,f.options.textStyle.fontWeight=f.options.textStyle.fontWeight||r.maps.themeStyle.fontWeight,f.options.textStyle.opacity=f.options.textStyle.opacity||r.maps.themeStyle.tooltipTextOpacity,r.svgTooltip=f.cancel?new ot.Tooltip({enable:!0,header:"",data:i.data,template:i.template,content:f.content.toString()!==h.toString()?[n.SanitizeHtmlHelper.sanitize(f.content.toString())]:[n.SanitizeHtmlHelper.sanitize(h.toString())],shapes:[],location:i.location,palette:[ct],areaBounds:r.maps.mapAreaRect,textStyle:i.textStyle,availableSize:r.maps.availableSize,fill:i.fill||r.maps.themeStyle.tooltipFillColor}):new ot.Tooltip({enable:!0,header:"",data:f.options.data,template:f.options.template,content:f.content.toString()!==h.toString()?[n.SanitizeHtmlHelper.sanitize(f.content.toString())]:[n.SanitizeHtmlHelper.sanitize(h.toString())],shapes:[],location:f.options.location,palette:[ct],areaBounds:r.maps.mapAreaRect,textStyle:f.options.textStyle,availableSize:r.maps.availableSize,fill:f.fill||r.maps.themeStyle.tooltipFillColor}),(r.maps.isVue||r.maps.isVue3)&&(r.svgTooltip.controlInstance=r.maps),r.svgTooltip.opacity=r.maps.themeStyle.tooltipFillOpacity||r.svgTooltip.opacity,r.svgTooltip.appendTo(g),r.maps.renderReactTemplates(),null!==(y=document.getElementById(r.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")){var u=y.getAttribute("style");u=u.replace("pointer-events: none;","position-events:all;");y.style.cssText=u}});this.svgTooltip&&this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:rt,element:this.svgTooltip.element});this.svgTooltip?this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:rt,element:this.svgTooltip.element}):this.clearTooltip(t.target)}else null!==(y=document.getElementById(this.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")?this.maps.notify(et,this):this.clearTooltip(t.target)},t.prototype.setTooltipContent=function(t,i){var r=n.extend({},i,null,!0);return this.maps.format&&!isNaN(Number(r[t.valuePath]))?r[t.valuePath]=yr(this.maps,Number(r[t.valuePath])):r=Object.keys(r).length?r:void 0,r},t.prototype.formatter=function(n,t){var i,u,r;for(void 0===t&&(t={}),i=0,u=Object.keys(t);i<u.length;i++)r=u[i],n="object"==typeof t[r]?fr("",n,t,this.maps):n.split("${"+r+"}").join(vt(t[r],this.maps));return n},t.prototype.mouseUpHandler=function(n){this.renderTooltip(n);"MouseMove"===this.maps.tooltipDisplayMode&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3))},t.prototype.removeTooltip=function(){var t=!1;return document.getElementsByClassName("EJ2-maps-Tooltip").length>0&&(n.remove(document.getElementsByClassName("EJ2-maps-Tooltip")[0]),t=!0),t},t.prototype.clearTooltip=function(t){var i=t.closest("#"+this.maps.element.id+"_mapsTooltipparent_template");n.isNullOrUndefined(i)&&this.removeTooltip()&&this.maps.clearTemplate()},t.prototype.addEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.on("dblclick",this.renderTooltip,this):"Click"===this.maps.tooltipDisplayMode?this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this):this.maps.on(n.Browser.touchMoveEvent,this.renderTooltip,this),this.maps.on(n.Browser.touchCancelEvent,this.removeTooltip,this),this.maps.element.addEventListener("contextmenu",this.removeTooltip))},t.prototype.removeEventListener=function(){if(this.maps){if(this.maps.isDestroyed)return;"DoubleClick"===this.maps.tooltipDisplayMode?this.maps.off("dblclick",this.removeTooltip):"Click"===this.maps.tooltipDisplayMode?this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler):this.maps.off(n.Browser.touchMoveEvent,this.renderTooltip);this.maps.off(n.Browser.touchCancelEvent,this.removeTooltip);this.maps.element.removeEventListener("contextmenu",this.removeTooltip)}},t.prototype.getModuleName=function(){return"MapsTooltip"},t.prototype.destroy=function(){n.isNullOrUndefined(this.svgTooltip)||this.svgTooltip.destroy();this.svgTooltip=null},t}(),so=function(){function t(t){this.isPanning=!1;this.mouseEnter=!1;this.isTouch=!1;this.rectZoomingStart=!1;this.browserName=n.Browser.info.name;this.isPointer=n.Browser.isPointer;this.handled=!1;this.isPan=!1;this.isZoomFinal=!1;this.isZoomSelection=!1;this.pinchFactor=1;this.startTouches=[];this.intersect=[];this.mouseDownLatLong={x:0,y:0};this.mouseMoveLatLong={x:0,y:0};this.isSingleClick=!1;this.maps=t;this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";this.cancelEvent=this.isPointer?"pointerleave":"mouseleave";this.selectionColor=null==this.maps.zoomSettings.toolbarSettings.buttonSettings.selectionColor?this.maps.zoomSettings.selectionColor:this.maps.zoomSettings.toolbarSettings.buttonSettings.selectionColor;this.fillColor=null==this.maps.zoomSettings.toolbarSettings.buttonSettings.color?this.maps.zoomSettings.color:this.maps.zoomSettings.toolbarSettings.buttonSettings.color;this.addEventListener()}return t.prototype.performZooming=function(n,t,i){var h=this,r=this.maps,a,w,g,b,k;r.previousProjection=r.projectionType;r.defaultState=!1;r.initialCheck=!1;r.markerZoomedState=!1;r.zoomPersistence=r.enablePersistence;var c=r.tileZoomLevel,d=r.previousScale=r.scale,l=r.zoomSettings.maxZoom,p=r.zoomSettings.minZoom;t=l>=t?t:l;a=!0;switch(i.toLowerCase()){case"zoomin":a=t<=this.maps.zoomSettings.maxZoom;break;case"zoomout":a=t>=this.maps.zoomSettings.minZoom}if(a)if(w=r.tileTranslatePoint,!r.isTileMap&&(("ZoomIn"===i?t>=p&&t<=l:t>=p)||r.isReset)){var u=r.mapAreaRect,s=r.baseMapRectBounds.min,nt=r.baseMapRectBounds.max,e=Math.abs(s.x-nt.x),o=Math.abs(s.y-nt.y),v=void 0,y=void 0;t<1.2&&"Eckert5"!==r.projectionType?(0!==e&&0!==o&&e!==o||(e=u.width/2,o=u.height),t=(t=parseFloat(Math.min(u.width/e,u.height/o).toFixed(2)))>1.05?1:t,r.translatePoint=this.calculateInitalZoomTranslatePoint(t,e,o,u,s,r)):(b=r.translatePoint,v=b.x-(u.width/d-u.width/t)/(u.width/n.x),y=b.y-(u.height/d-u.height/t)/(u.height/n.y),k=Math.abs(r.baseMapRectBounds.max.y-r.baseMapRectBounds.min.y)*t,v=k<r.mapAreaRect.height?u.x+(-s.x+(u.width/2-e/2)):v,y=k<r.mapAreaRect.height?u.y+(-s.y+(u.height/2-o/2)):y,r.translatePoint=new f(v,y));r.scale=t;this.triggerZoomEvent(w,c,i)?(r.translatePoint=r.previousPoint,r.scale=r.mapScaleValue=r.previousScale):this.applyTransform(r)}else r.isTileMap&&t>=p&&t<=l&&((this.getTileTranslatePosition(c,t,n,i),r.tileZoomLevel=t,r.zoomSettings.zoomFactor=t,r.scale=Math.pow(2,t-1),"ZoomOut"===i&&r.zoomSettings.resetToInitial&&r.applyZoomReset&&t<=r.initialZoomLevel&&(r.initialCheck=!0,r.zoomPersistence=!1,r.tileTranslatePoint.x=r.initialTileTranslate.x,r.tileTranslatePoint.y=r.initialTileTranslate.y,t=r.tileZoomLevel=r.mapScaleValue=r.initialZoomLevel,r.scale=Math.pow(2,t-1)),r.translatePoint.y=(r.tileTranslatePoint.y-.01*r.mapScaleValue)/r.scale,r.translatePoint.x=(r.tileTranslatePoint.x-.01*r.mapScaleValue)/r.scale,this.triggerZoomEvent(w,c,i))?(r.translatePoint=r.tileTranslatePoint=new f(0,0),r.scale=r.previousScale,r.tileZoomLevel=c,r.zoomSettings.zoomFactor=r.previousScale):(document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),this.markerLineAnimation(r),r.mapLayerPanel.generateTiles(t,r.tileTranslatePoint,i+"wheel",null,n),document.getElementById(this.maps.element.id+"_tiles"),g=this.maps.layersCollection[0].animationDuration,setTimeout(function(){h.applyTransform(h.maps);document.getElementById(h.maps.element.id+"_LayerIndex_1")&&(document.getElementById(h.maps.element.id+"_LayerIndex_1").style.display="block")},g)));this.maps.zoomNotApplied=!1;this.maps.isDevice&&this.removeToolbarOpacity(r.isTileMap?Math.round(r.tileZoomLevel):r.scale,r.element.id+"_Zooming_")},t.prototype.calculateInitalZoomTranslatePoint=function(n,t,i,r,u,e){t*=n;i*=n;var o=0!==u.x&&"layers"===e.translateType?e.availableSize.width-r.width:0,s=r.x+(-u.x+(r.width/2-t/2))-o,h=r.y+(-u.y+(r.height/2-i/2));return new f(s,h)},t.prototype.triggerZoomEvent=function(n,t,i){var u,r=this.maps;return u=r.isTileMap?{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{previous:n,current:r.tileTranslatePoint},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{previous:t,current:r.tileZoomLevel},scale:{previous:r.previousScale,current:r.scale}}:{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{},scale:{previous:r.previousScale,current:r.scale}},r.trigger("zoom",u),u.cancel},t.prototype.getTileTranslatePosition=function(n,t,i,r){var u=this.maps,s="ZoomOut"===r?10:"Reset"===r&&t>1?0:10,f=u.availableSize,e=256*Math.pow(2,n),o=256*Math.pow(2,t),h=(i.x-u.tileTranslatePoint.x)/e*100,c=(i.y-u.tileTranslatePoint.y)/e*100;u.tileTranslatePoint.x=1===t?f.width/2-256:i.x-h*o/100;u.tileTranslatePoint.y=1===t?f.height/2-256+2*s:i.y-c*o/100},t.prototype.performRectZooming=function(){var n,i,e,h,v,y;this.isDragZoom=!0;n=this.maps;i=n.availableSize;n.previousProjection=n.projectionType;var o,r=n.tileZoomLevel,c=n.tileTranslatePoint,u=this.zoomingRect,s=n.zoomSettings.maxZoom,p=n.zoomSettings.minZoom;if(u.height>0&&u.width>0){var l=this.zoomingRect.x+this.zoomingRect.width/2,a=this.zoomingRect.y+this.zoomingRect.height/2,t=void 0;n.isTileMap?(t=(t=r+Math.round(r+(i.width/u.width+i.height/u.height)/2))>=p&&t<=s?t:s,n.zoomSettings.zoomFactor=t,this.getTileTranslatePosition(r,t,{x:l,y:a}),n.tileZoomLevel=t,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,t))/Math.pow(2,t),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,t))/Math.pow(2,t),n.scale=Math.pow(2,t),(o=this.triggerZoomEvent(c,r,""))?(n.translatePoint=n.tileTranslatePoint=new f(0,0),n.scale=n.tileZoomLevel=n.zoomSettings.zoomFactor=r):n.mapLayerPanel.generateTiles(t,n.tileTranslatePoint)):(e=n.previousScale=n.scale,t=(t=e+Math.round((i.width/u.width+i.height/u.height)/2))<this.maps.zoomSettings.maxZoom?t:this.maps.zoomSettings.maxZoom,h=n.previousPoint=n.translatePoint,t<=s&&(v=h.x-(i.width/e-i.width/t)/(i.width/l),y=h.y-(i.height/e-i.height/t)/(i.height/a),n.translatePoint=new f(v,y)),n.scale=t<this.maps.zoomSettings.maxZoom?t:this.maps.zoomSettings.maxZoom,(o=this.triggerZoomEvent(c,r,""))&&(n.translatePoint=n.previousPoint,n.scale=n.previousScale));o||(n.mapScaleValue=t,this.applyTransform(n,!0),this.maps.zoomNotApplied=!1,this.zoomingRect=null)}this.isZoomFinal=this.isZoomSelection&&Math.round(n.scale)===this.maps.zoomSettings.maxZoom;this.removeToolbarOpacity(n.scale,this.maps.element.id+"_Zooming_")},t.prototype.setInteraction=function(n){this.lastScale=1;this.interaction=n},t.prototype.updateInteraction=function(){2===this.fingers?this.setInteraction("zoom"):this.setInteraction(null)},t.prototype.performPinchZooming=function(){var t=this.maps,c=t.tileZoomLevel,i=t.mapAreaRect,w,r,u,b;t.previousScale=t.scale;t.previousPoint=t.translatePoint;var y,p,k,s,d=t.tileTranslatePoint,g=(y=this.touchStartList,p=this.touchMoveList,k=nu(y[0],y[1]),nu(p[0],p[1])/k),l=(s=function(n,t){var i=t.element.getBoundingClientRect(),r=i.top+document.defaultView.pageXOffset,u=i.left+document.defaultView.pageYOffset;return Array.prototype.slice.call(n).map(function(n){return{x:n.pageX-u,y:n.pageY-r}})}(this.touchMoveList,this.maps),{x:s.map(function(n){return n.x}).reduce(tu)/s.length,y:s.map(function(n){return n.y}).reduce(tu)/s.length}),it=g/this.lastScale;if(this.lastScale=g,this.pinchFactor*=it,this.pinchFactor=Math.min(this.maps.zoomSettings.maxZoom,Math.max(this.pinchFactor,this.maps.zoomSettings.minZoom)),r=this.pinchFactor,t.isTileMap)u=r,this.getTileTranslatePosition(c,u,{x:l.x,y:l.y}),t.tileZoomLevel=u,t.translatePoint.x=(t.tileTranslatePoint.x-.5*Math.pow(2,u))/Math.pow(2,u),t.translatePoint.y=(t.tileTranslatePoint.y-.5*Math.pow(2,u))/Math.pow(2,u),t.scale=Math.pow(2,u),(w=this.triggerZoomEvent(d,c,""))?(t.translatePoint=t.tileTranslatePoint=new f(0,0),t.scale=t.previousScale,t.tileZoomLevel=c,t.zoomSettings.zoomFactor=t.previousScale):t.mapLayerPanel.generateTiles(u,t.tileTranslatePoint);else{var h=t.baseMapRectBounds.min,nt=t.baseMapRectBounds.max,e=Math.abs(h.y-nt.y),o=Math.abs(h.x-nt.x),tt=t.translatePoint,a=void 0,v=void 0;r<1.2&&"Eckert5"!==t.projectionType?(0!==o&&0!==e&&o!==e||(o=i.width/2,e=i.height),r=(r=parseFloat(Math.min(i.width/o,i.height/e).toFixed(2)))>1.05?1:r,t.translatePoint=this.calculateInitalZoomTranslatePoint(r,o,e,i,h,t)):(b=Math.abs(t.baseMapRectBounds.max.y-t.baseMapRectBounds.min.y)*r,a=tt.x-(i.width/t.scale-i.width/r)/(i.width/l.x),v=tt.y-(i.height/t.scale-i.height/r)/(i.height/l.y),a=b<t.mapAreaRect.height?i.x+(-h.x+(i.width/2-o/2)):a,v=b<t.mapAreaRect.height?i.y+(-h.y+(i.height/2-e/2)):v,t.translatePoint=new f(a,v));t.scale=r;(w=this.triggerZoomEvent(d,c,""))&&(t.translatePoint=t.previousPoint,t.scale=t.previousScale)}w||this.applyTransform(t);n.Browser.isDevice&&this.removeToolbarOpacity(t.isTileMap?Math.round(t.tileZoomLevel):t.scale,t.element.id+"_Zooming_")},t.prototype.drawZoomRectangle=function(){var n=this.maps,t=this.mouseDownPoints,i=this.mouseMovePoints,c={width:1,color:this.maps.themeStyle.rectangleZoomBorderColor},o=Math.abs(i.x-t.x),s=Math.abs(i.y-t.y),u=i.x>t.x?t.x:t.x-o,f=i.y>t.y?t.y:t.y-s,e,h;(r(n.element.id).getBoundingClientRect(),u>n.mapAreaRect.x&&u<n.mapAreaRect.x+n.mapAreaRect.width&&f>n.mapAreaRect.y&&f<n.mapAreaRect.y+n.mapAreaRect.height)&&(this.zoomingRect=new v(u,f,o,s),e=n.renderer.createSvg({id:n.element.id+"_Selection_Rect_Zooming",width:n.availableSize.width,height:n.availableSize.height,style:"position: absolute;"}),h=new b(n.element.id+"_ZoomRect",this.maps.themeStyle.rectangleZoomFillColor,c,this.maps.themeStyle.rectangleZoomFillOpacity,this.zoomingRect,0,0,"","3"),e.appendChild(n.renderer.drawRectangle(h)),r(n.element.id+"_Secondary_Element").appendChild(e))},t.prototype.animateTransform=function(n,t,i,r,u){var f=this.currentLayer.animationDuration;t&&0!==f&&!this.maps.isTileMap?this.maps.isTileMap||bf(n,0,f,new k(i,r),u,this.maps.mapAreaRect,this.maps):n.setAttribute("transform","scale("+u+") translate( "+i+" "+r+" )")},t.prototype.applyTransform=function(t,i){var ht,g,f,r,ut,u,p,o,ft,w,et,b,d,ot,st,v,ct,tt,y,yt,it,pt;this.templateCount=0;var e=t.scale,h=t.translatePoint.x,c=t.translatePoint.y;if(t.zoomShapeCollection=[],document.getElementById(t.element.id+"_mapsTooltip")&&a(t.element.id+"_mapsTooltip"),this.layerCollectionEle){for(g=0;g<this.layerCollectionEle.childElementCount;g++){if(f=this.layerCollectionEle.childNodes[g],"g"===f.tagName){this.templateCount++;this.index=f.id.indexOf("_LayerIndex_")>-1&&parseFloat(f.id.split("_LayerIndex_")[1].split("_")[0]);this.currentLayer=t.layersCollection[this.index];for(var rt=t.mapLayerPanel.calculateFactor(this.currentLayer),kt=f.childElementCount,nt=0;nt<kt;nt++)if(r=f.childNodes[nt],r.id.indexOf("_Markers_Group")>-1||r.id.indexOf("_bubble_Group")>-1||r.id.indexOf("_dataLableIndex_Group")>-1){if(r.id.indexOf("_Markers_Group")>-1){if(this.isPanning||n.isNullOrUndefined(r.childNodes[0])||this.markerTranslates(r.childNodes[0],rt,h,c,e,"Marker",f,i),r=f.childNodes[nt],ut=void 0,!n.isNullOrUndefined(r)&&-1!==r.id.indexOf("Markers")){for(u=0;u<r.childElementCount;u++){for(this.markerTranslate(r.childNodes[u],rt,h,c,e,"Marker",i),parseInt(r.childNodes[u].id.split("_LayerIndex_")[1].split("_")[0],10),p=parseInt(r.childNodes[u].id.split("_dataIndex_")[1].split("_")[0],10),o=parseInt(r.childNodes[u].id.split("_MarkerIndex_")[1].split("_")[0],10),ut=this.currentLayer.markerSettings[o].animationDuration>0,ft=this.currentLayer.markerSettings[o].dataSource[p],w=0;w<this.currentLayer.markerSettings[o].initialMarkerSelection.length;w++)this.currentLayer.markerSettings[o].initialMarkerSelection[w].latitude!==ft.latitude&&this.currentLayer.markerSettings[o].initialMarkerSelection[w].longitude!==ft.longitude||t.markerSelection(this.currentLayer.markerSettings[o].selectionSettings,t,r.children[u],this.currentLayer.markerSettings[o].dataSource[p]);(this.currentLayer.animationDuration>0||t.layersCollection[0].animationDuration>0&&"SubLayer"===this.currentLayer.type)&&!this.isPanning&&(t.isTileMap?(et=document.querySelector(".GroupElement"),et&&!document.querySelector(".ClusterGroupElement")&&ut&&(et.style.display="none")):r.style.cssText="visibility:hidden")}(this.isPanning&&t.markerModule.sameMarkerData.length>0?sr(t.markerModule.sameMarkerData,t,r,!0):t.markerModule.sameMarkerData.length>0&&(t.markerModule.sameMarkerData=[],document.getElementById(t.element.id+"_mapsTooltip")&&a(t.element.id+"_mapsTooltip")),document.getElementById(t.element.id+"_mapsTooltip")&&t.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")&&!this.isPanning)&&(b=t.mapsTooltipModule,d=r.querySelector("#"+b.tooltipTargetID),n.isNullOrUndefined(d)||("hidden"===d.style.visibility?a(t.element.id+"_mapsTooltip"):(ot=parseFloat(d.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[1]),st=parseFloat(d.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[2]),t.isTileMap&&(ot+=+s(t.element.id+"_tile_parent").style.left.split("px")[0],st+=+s(t.element.id+"_tile_parent").style.top.split("px")[0]),b.svgTooltip.location.x=ot,b.svgTooltip.location.y=st,b.svgTooltip.enableAnimation=!1)))}}else if(r.id.indexOf("_bubble_Group")>-1){for(v=void 0,u=0;u<r.childElementCount;u++)for(v=r.childNodes[u],ht=parseFloat(v.id.split("_LayerIndex_")[1].split("_")[0]),ct=parseFloat(v.id.split("_BubbleIndex_")[1].split("_")[0]),tt=(p=parseFloat(v.id.split("_BubbleIndex_")[1].split("_")[2]),0);tt<t.bubbleModule.bubbleCollection.length;tt++)if(y=t.bubbleModule.bubbleCollection[tt],y.LayerIndex===ht&&y.BubbleIndex===ct&&y.DataIndex===p){var lt=(y.center.x+h)*e,at=(y.center.y+c)*e,vt=this.currentLayer.animationDuration;i&&0!==vt?bi(v,0,vt,new k(lt,at)):v.setAttribute("transform","translate( "+lt+" "+at+" )");break}}else if(r.id.indexOf("_dataLableIndex_Group")>-1&&!n.isNullOrUndefined(t.layers[this.index]))for(this.intersect=[],t.zoomLabelPositions=[],t.zoomLabelPositions=t.dataLabelModule.dataLabelCollections,yt=!t.isTileMap&&i,u=0;u<r.childElementCount;u++)if(r.childNodes[u].id.indexOf("_LabelIndex_")>-1&&(it=parseFloat(r.childNodes[u].id.split("_LabelIndex_")[1].split("_")[0]),this.zoomshapewidth=r.childNodes[u].getBoundingClientRect(),t.zoomShapeCollection.push(this.zoomshapewidth),this.dataLabelTranslate(r.childNodes[u],rt,h,c,e,"DataLabel",yt),pt=t.layers[this.index].dataLabelSettings.border,u>0&&pt.width>1&&r.childNodes[u-1].id.indexOf("_rectIndex_")>-1&&!n.isNullOrUndefined(t.zoomLabelPositions[it]))){var dt=(t.zoomLabelPositions[it].location.x+h)*e,gt=(t.zoomLabelPositions[it].location.y+c)*e,wt=l(r.childNodes[u].textContent,t.layers[this.index].dataLabelSettings.textStyle),bt=r.childNodes[u-1],ni=dt-wt.width/2,ti=gt-wt.height/2-5;bt.setAttribute("x",ni);bt.setAttribute("y",ti)}}else t.isTileMap&&r.id.indexOf("_line_Group")>-1?(r.remove(),f.children.length>0&&f.children[0]?f.insertBefore(t.navigationLineModule.renderNavigation(this.currentLayer,t.tileZoomLevel,this.index),f.children[1]):f.appendChild(t.navigationLineModule.renderNavigation(this.currentLayer,t.tileZoomLevel,this.index))):-1===r.id.indexOf("Legend")&&(dr(r,this.index,e,t),t.zoomTranslatePoint=t.translatePoint,this.animateTransform(r,i,h,c,e))}t.arrangeTemplate()}n.isNullOrUndefined(this.currentLayer)||i&&0!==this.currentLayer.animationDuration&&!t.isTileMap||this.processTemplate(h,c,e,t)}},t.prototype.markerTranslates=function(t,i,u,f,e,s,h,c){var l=this,d,y,w;void 0===c&&(c=!1);var g=0,nt=0,tt=0,b=parseInt((t||h).id.split("_LayerIndex_")[1].split("_")[0],10),v=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement"});v.style.pointerEvents="auto";document.getElementById(v.id)&&a(v.id);d=this.maps.mapAreaRect;y=n.createElement("div",{id:this.maps.element.id+"_LayerIndex_"+b+"_Markers_Template_Group",className:"template"});y.style.cssText="overflow: hidden; position: absolute;pointer-events: none;top:"+d.y+"px;left:"+d.x+"px;height:"+d.height+"px;width:"+d.width+"px;";document.getElementById(y.id)&&a(y.id);w=this.maps.layersCollection[b];w.markerSettings.map(function(t,c){var a=t.dataSource;Array.prototype.forEach.call(a,function(d,rt){l.maps.markerNullCount=c>=0&&0===rt?0:l.maps.markerNullCount;var ut={template:t.template,data:d,maps:l.maps,marker:t,cancel:!1,name:wu,fill:t.fill,colorValuePath:t.colorValuePath,shapeValuePath:t.shapeValuePath,height:t.height,width:t.width,imageUrl:t.imageUrl,imageUrlValuePath:t.imageUrlValuePath,shape:t.shape,border:t.border};ut=ai(ut=vi(ut,d),d);l.maps.trigger("markerRendering",ut,function(){var st;t.shapeValuePath!==ut.shapeValuePath&&(ut=vi(ut,d));t.colorValuePath!==ut.colorValuePath&&(ut=ai(ut,d));var et=n.isNullOrUndefined(t.latitudeValuePath)?n.isNullOrUndefined(d.latitude)?n.isNullOrUndefined(d.Latitude)?null:d.Latitude:parseFloat(d.latitude):Number(o(d,t.latitudeValuePath)),ot=n.isNullOrUndefined(t.longitudeValuePath)?n.isNullOrUndefined(d.longitude)?n.isNullOrUndefined(d.Longitude)?null:d.Longitude:parseFloat(d.longitude):Number(o(d,t.longitudeValuePath)),ht=t.offset;if(!ut.cancel&&t.visible&&!n.isNullOrUndefined(ot)&&!n.isNullOrUndefined(et)){var ct=l.maps.element.id+"_LayerIndex_"+b+"_MarkerIndex_"+c+"_dataIndex_"+rt,ft=l.maps.isTileMap?it(new k(ot,et),l.maps.tileZoomLevel,l.maps.tileTranslatePoint,!0):p(et,ot,i,w,l.maps),lt={x:u,y:f};!ut.template||isNaN(ft.x)||isNaN(ft.y)?ut.template||isNaN(ft.x)||isNaN(ft.y)||(nt++,hr(ut,t,a,rt,ft,lt,ct,ht,e,l.maps,v)):(tt++,cr(ut,void 0,ct,d,c,y,ft,lt,e,ht,l.maps))}g+=isNaN(et)||isNaN(ot)?1:0;tt+=ut.cancel?1:0;nt+=ut.cancel?1:0;l.maps.markerNullCount=n.isNullOrUndefined(et)||n.isNullOrUndefined(ot)?l.maps.markerNullCount+1:l.maps.markerNullCount;st=a.length-l.maps.markerNullCount;v.childElementCount===st-tt-g&&"Template"!==s&&(h.appendChild(v),w.markerClusterSettings.allowClustering&&(l.maps.svgObject.appendChild(v),l.maps.element.appendChild(l.maps.svgObject),dt(w,v,l.maps,b,v,h,!0,!0)));y.childElementCount===st-nt-g&&r(l.maps.element.id+"_Secondary_Element")&&(r(l.maps.element.id+"_Secondary_Element").appendChild(y),e>=1&&w.markerClusterSettings.allowClustering&&dt(w,y,l.maps,b,v,h,!1,!0))})})})},t.prototype.processTemplate=function(t,i,u,f){for(var e,o=0;o<this.templateCount;o++){var c=f.mapLayerPanel.calculateFactor(this.currentLayer),s=r(f.element.id+"_LayerIndex_"+o+"_Markers_Template_Group"),h=r(f.element.id+"_LayerIndex_"+o+"_Label_Template_Group");if(!n.isNullOrUndefined(s)&&s.childElementCount>0)for(s.style.visibility="visible",e=0;e<s.childElementCount;e++)this.markerTranslate(s.childNodes[e],c,t,i,u,"Template");if(!n.isNullOrUndefined(h)&&h.childElementCount>0)for(e=0;e<h.childElementCount;e++)this.dataLabelTranslate(h.childNodes[e],c,t,i,u,"Template")}},t.prototype.dataLabelTranslate=function(t,i,u,f,e,o,s){var rt,b,tt,p,w,ut,ft,at,et,ot,vt,st,c,it,a,ht;void 0===s&&(s=!1);var h,v,y,d,ct,lt=this.maps.dataLabelModule.dataLabelCollections,nt=this.maps.layers[this.index].dataLabelSettings.textStyle,yt=parseFloat(t.id.split("_LayerIndex_")[1].split("_")[0]),pt=parseFloat(t.id.split("_shapeIndex_")[1].split("_")[0]);for(t.id.indexOf("_LabelIndex_")>-1&&(ct=parseFloat(t.id.split("_LabelIndex_")[1].split("_")[0])),rt=this.currentLayer.animationDuration,b=0;b<lt.length;b++)if(tt=lt[b],tt.layerIndex===yt&&tt.shapeIndex===pt&&tt.labelIndex===ct)if(p=tt.location.x,w=tt.location.y,"Template"===o)ut=0,ft=0,this.maps.isTileMap?(ut=(p+u)*e-(d=l(y=tt.dataLabelText,nt)).width/2,ft=(w+f)*e-d.height):(at=r(this.maps.element.id+"_Layer_Collections"),p=Math.abs(this.maps.baseMapRectBounds.min.x-p)*e,w=Math.abs(this.maps.baseMapRectBounds.min.y-w)*e,et=at.getBoundingClientRect(),ot=t.parentElement.getBoundingClientRect(),ut=p+(et.left-ot.left),ft=w+(et.top-ot.top)),t.style.left=ut+"px",t.style.top=ft+"px";else{if(p=(p+u)*e,vt=(w=(w+f)*e)-(d=l(y=tt.dataLabelText,nt)).height/4,st=w+d.height/4,w=st,c={rightWidth:p+d.width/2,leftWidth:p-d.width/2,heightTop:vt,heightBottom:st},s&&0!==rt||t.setAttribute("transform","translate( "+p+" "+w+" )"),"Hide"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(h=this.maps.dataLabelShape[b]*e>=d.width?y:"",t.textContent=h):(h=this.maps.dataLabelShape[b]>=d.width?y:"",t.textContent=h)),"Trim"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(h=g(this.maps.dataLabelShape[b]*e,y,nt),t.textContent=h):(h=g(this.maps.dataLabelShape[b],y,nt),t.textContent=h)),"Hide"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(it=0;it<this.intersect.length;it++)if(!n.isNullOrUndefined(this.intersect[it])){if(!(c.leftWidth>this.intersect[it].rightWidth||c.rightWidth<this.intersect[it].leftWidth||c.heightTop>this.intersect[it].heightBottom||c.heightBottom<this.intersect[it].heightTop)){h="";t.textContent=h;break}h=n.isNullOrUndefined(h)?y:h;t.textContent=h}this.intersect.push(c)}if("Trim"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(a=0;a<this.intersect.length;a++)if(!n.isNullOrUndefined(this.intersect[a]))if(c.rightWidth<this.intersect[a].leftWidth||c.leftWidth>this.intersect[a].rightWidth||c.heightBottom<this.intersect[a].heightTop||c.heightTop>this.intersect[a].heightBottom)v=n.isNullOrUndefined(h)?y:h,e>1&&(v=g(this.maps.dataLabelShape[b]*e,v,nt)),t.textContent=v;else{if(c.leftWidth>this.intersect[a].leftWidth){v=g((ht=this.intersect[a].rightWidth-c.leftWidth)-(c.rightWidth-c.leftWidth),h=n.isNullOrUndefined(h)?y:h,nt);t.textContent=v;break}if(c.leftWidth<this.intersect[a].leftWidth){ht=c.rightWidth-this.intersect[a].leftWidth;v=g(Math.abs(ht-(c.rightWidth-c.leftWidth)),h=n.isNullOrUndefined(h)?y:h,nt);t.textContent=v;break}}this.intersect.push(c);n.isNullOrUndefined(v)&&(v=g(this.maps.dataLabelShape[b]*e,y,nt),t.textContent=v)}(s||rt>0)&&bi(t,0,rt,new k(p,w))}},t.prototype.markerTranslate=function(t,i,u,e,s,h,c){var v,w,d,b;void 0===c&&(c=!1);var rt=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),ut=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),y=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),g=this.maps.layersCollection[rt],l=g.markerSettings[ut];if(!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(l.dataSource)&&!n.isNullOrUndefined(l.dataSource[y])){var nt=n.isNullOrUndefined(l.longitudeValuePath)?n.isNullOrUndefined(l.dataSource[y].longitude)?n.isNullOrUndefined(l.dataSource[y].Latitude)?0:parseFloat(l.dataSource[y].Latitude):parseFloat(l.dataSource[y].longitude):Number(o(l.dataSource[y],l.longitudeValuePath)),tt=n.isNullOrUndefined(l.latitudeValuePath)?n.isNullOrUndefined(l.dataSource[y].latitude)?n.isNullOrUndefined(l.dataSource[y].Latitude)?0:parseFloat(l.dataSource[y].Latitude):parseFloat(l.dataSource[y].latitude):Number(o(l.dataSource[y],l.latitudeValuePath)),k=this.currentLayer.animationDuration,a=this.maps.isTileMap?it(new f(nt,tt),this.maps.tileZoomLevel,this.maps.tileTranslatePoint,!0):p(tt,nt,i,g,this.maps);this.maps.isTileMap?"Template"===h?(v=t.getBoundingClientRect(),(t.style.left=a.x-v.width/2+l.offset.x+"px",t.style.top=a.y-v.height/2+l.offset.y+"px","GoogleStaticMap"===this.maps.layers[this.maps.baseLayerIndex].layerType)&&(w=r(this.maps.element.id+"_StaticGoogleMap").getBoundingClientRect(),"none"!==t.style.display&&((w.x>v.x||w.x+640<v.x+v.width)&&(w.y>v.y||w.y+w.height<v.y+v.height)||w.x>v.x||w.x+640<v.x+v.width)&&(t.style.display="none"))):(a.x+=l.offset.x,a.y+=l.offset.y,t.setAttribute("transform","translate( "+a.x+" "+a.y+" )")):"Template"===h?k>0?(a.x=Math.abs(this.maps.baseMapRectBounds.min.x-a.x)*s,a.y=Math.abs(this.maps.baseMapRectBounds.min.y-a.y)*s,d=r(this.maps.element.id+"_Layer_Collections").getBoundingClientRect(),b=t.parentElement.getBoundingClientRect(),t.style.left=a.x+(d.left-b.left)+l.offset.x+"px",t.style.top=a.y+(d.top-b.top)+l.offset.y+"px",t.style.transform="translate(-50%, -50%)"):(b=t.getBoundingClientRect(),t.style.left=(a.x+u)*s+l.offset.x-this.maps.mapAreaRect.x-b.width/2+"px",t.style.top=(a.y+e)*s+l.offset.y-this.maps.mapAreaRect.y-b.height/2+"px"):(a.x=(a.x+u)*s+l.offset.x,a.y=(a.y+e)*s+l.offset.y,c&&0!==k?bi(t,0,k,a):t.setAttribute("transform","translate( "+a.x+" "+a.y+" )"))}},t.prototype.markerLineAnimation=function(t){var i,u,f;if(t.isTileMap)for(i=0;i<t.layersCollection.length;i++)u=r(this.maps.element.id+"_LayerIndex_"+i+"_Markers_Template_Group"),f=r(this.maps.element.id+"_LayerIndex_"+i+"_line_Group"),n.isNullOrUndefined(u)||(u.style.visibility="hidden"),n.isNullOrUndefined(f)||(f.style.visibility="hidden")},t.prototype.panning=function(t,i,u,e){var l,o=this.maps,w=this.mouseDownPoints,b=this.mouseMovePoints,k=o.scale,s,h,a,d,y,p,g;if(o.markerZoomedState=!1,o.zoomPersistence=o.enablePersistence,o.defaultState=!1,o.initialCheck=!1,a=o.translatePoint,d=o.tileTranslatePoint,i=n.isNullOrUndefined(i)?w.x-b.x:i,u=n.isNullOrUndefined(u)?w.y-b.y:u,this.maps.mergeCluster(),o.isTileMap)this.maps.tileZoomLevel>1&&(s=o.tileTranslatePoint.x-i,h=o.tileTranslatePoint.y-u,this.distanceX=s-o.tileTranslatePoint.x,this.distanceY=h-o.tileTranslatePoint.y,o.tileTranslatePoint.x=s,o.tileTranslatePoint.y=h,(o.tileTranslatePoint.y>-10&&u<0||o.tileTranslatePoint.y<-256*(Math.pow(2,this.maps.tileZoomLevel)-2)&&u>0)&&(o.tileTranslatePoint.x=s+i,o.tileTranslatePoint.y=h+u),o.translatePoint.x=(o.tileTranslatePoint.x-i)/o.scale,o.translatePoint.y=(o.tileTranslatePoint.y-u)/o.scale,y=this.maps.getTileGeoLocation(e.layerX,e.layerY),l={cancel:!1,name:fi,maps:o,tileTranslatePoint:{previous:d,current:o.tileTranslatePoint},translatePoint:{previous:a,current:o.translatePoint},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:y.latitude,longitude:y.longitude},o.trigger(fi,l),o.mapLayerPanel.generateTiles(o.tileZoomLevel,o.tileTranslatePoint,"Pan"),this.applyTransform(o));else{p=document.getElementById(o.element.id+"_Legend_Group");g=n.isNullOrUndefined(p)?0:p.getClientRects()[0].height;s=a.x-i/k;h=a.y-u/k;var c=r(o.element.id+"_Layer_Collections").getBoundingClientRect(),v=r(o.element.id+"_svg").getBoundingClientRect(),nt=i<0?c.left<=v.left+o.mapAreaRect.x:c.left+c.width+o.mapAreaRect.x>=v.width,tt=u<0?c.top<=v.top+o.mapAreaRect.y:c.top+c.height+g+o.margin.top>=v.top+v.height,it=this.maps.getGeoLocation(this.maps.layersCollection.length-1,e.layerX,e.layerY);l={cancel:!1,name:fi,maps:o,tileTranslatePoint:{},translatePoint:{previous:a,current:new f(s,h)},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:it.latitude,longitude:it.longitude};o.trigger(fi,l);l.cancel||(nt&&tt?(o.translatePoint=new f(s,h),this.applyTransform(o)):nt?(o.translatePoint=new f(s,o.translatePoint.y),this.applyTransform(o)):tt&&(o.translatePoint=new f(o.translatePoint.x,h),this.applyTransform(o)));this.maps.zoomNotApplied=!1}o.zoomTranslatePoint=o.translatePoint;this.mouseDownPoints=this.mouseMovePoints;this.isSingleClick=!1},t.prototype.toAlignSublayer=function(){this.maps.translatePoint.x=n.isNullOrUndefined(this.distanceX)?this.maps.translatePoint.x:this.maps.translatePoint.x-this.distanceX/this.maps.scale;this.maps.translatePoint.y=n.isNullOrUndefined(this.distanceY)?this.maps.translatePoint.y:this.maps.translatePoint.y-this.distanceY/this.maps.scale;this.applyTransform(this.maps,!1)},t.prototype.toolBarZooming=function(n,t){var c=this,i=this.maps,o,y,p,e,g,nt;i.initialCheck=!1;i.defaultState="Reset"===t&&1===n&&!(i.zoomSettings.resetToInitial&&i.applyZoomReset)||"ZoomOut"===t&&1===n;o=i.tileZoomLevel;y=i.previousScale=i.scale;i.markerZoomedState=!1;i.zoomPersistence=i.enablePersistence;i.mapScaleValue=n;var w=i.zoomSettings.maxZoom,u=i.zoomSettings.minZoom,r=i.mapAreaRect,b=i.previousPoint=i.translatePoint,k=i.tileTranslatePoint;if(i.previousProjection=i.projectionType,n="ZoomOut"===t&&1===Math.round(n)?1:n,n=u>(n="Reset"===t?u:0===Math.round(n)?1:n)&&"ZoomIn"===t?u+1:n,!i.isTileMap&&("ZoomIn"===t?n>=u&&Math.round(n)<=w:n>=u||i.isReset)){var l=i.baseMapRectBounds.min,d=i.baseMapRectBounds.max,s=Math.abs(d.x-l.x),h=Math.abs(l.y-d.y),a=void 0,v=void 0;n<1.2&&"Eckert5"!==i.projectionType?(0!==h&&0!==s&&h!==s||(s=r.width/2,h=r.height),n=(n=parseFloat(Math.min(r.width/s,r.height/h).toFixed(2)))>1.05?1:n,i.translatePoint=this.calculateInitalZoomTranslatePoint(n,s,h,r,l,i)):(a=b.x-(r.width/y-r.width/n)/2,v=b.y-(r.height/y-r.height/n)/2,p=Math.abs(i.baseMapRectBounds.max.y-i.baseMapRectBounds.min.y)*n,a=p<i.mapAreaRect.height?r.x+(-l.x+(r.width/2-s/2)):a,v=p<i.mapAreaRect.height?r.y+(-l.y+(r.height/2-h/2)):v,i.translatePoint=new f(a,v));i.zoomTranslatePoint=i.translatePoint;i.scale=n;this.triggerZoomEvent(k,o,t)?(i.translatePoint=i.zoomTranslatePoint=i.previousPoint,i.scale=i.previousScale):this.applyTransform(i,!0)}else i.isTileMap&&(n>=u&&n<=w||i.isReset)&&(e=o<u&&!i.isReset?u:n,(i.scale=Math.pow(2,e-1),i.tileZoomLevel=e,i.previousScale!==i.scale||i.isReset)&&(i.zoomSettings.zoomFactor=n,g={x:i.availableSize.width/2,y:i.availableSize.height/2},(this.getTileTranslatePosition(o,e,g,t),(i.zoomSettings.resetToInitial&&i.applyZoomReset&&"Reset"===t||"ZoomOut"===t&&i.zoomSettings.resetToInitial&&i.applyZoomReset&&e<=i.initialZoomLevel)&&(i.initialCheck=!0,i.zoomPersistence=!1,i.tileTranslatePoint.x=i.initialTileTranslate.x,i.tileTranslatePoint.y=i.initialTileTranslate.y,e=i.tileZoomLevel=i.mapScaleValue=i.initialZoomLevel),this.triggerZoomEvent(k,o,t))?(i.translatePoint=i.tileTranslatePoint=new f(0,0),i.scale=i.previousScale,i.tileZoomLevel=o,i.zoomSettings.zoomFactor=i.previousScale):(i.translatePoint.y=(i.tileTranslatePoint.y-.01*i.mapScaleValue)/i.scale,i.translatePoint.x=(i.tileTranslatePoint.x-.01*i.mapScaleValue)/i.scale,document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),this.markerLineAnimation(i),i.mapLayerPanel.generateTiles(e,i.tileTranslatePoint,t),document.getElementById(this.maps.element.id+"_tiles"),nt=this.maps.layersCollection[0].animationDuration,setTimeout(function(){c.applyTransform(c.maps,!0);document.getElementById(c.maps.element.id+"_LayerIndex_1")&&(document.getElementById(c.maps.element.id+"_LayerIndex_1").style.display="block");c.maps.isAddLayer=!1},nt))),this.maps.zoomNotApplied=!1)},t.prototype.createZoomingToolbars=function(){var i=this.maps,st,f,d,r,h,c,l,nt,tt,it,p,rt,ut;this.toolBarGroup=i.renderer.createGroup({id:i.element.id+"_Zooming_KitCollection",opacity:"fluentdark"===i.theme.toLowerCase()?.6:.3});var w=15,k=15,u=i.zoomSettings.toolbarSettings,t=i.zoomSettings.toolbarSettings.buttonSettings;this.maps.toolbarProperties={toolBarOrientation:"Horizontal"===u.orientation?i.zoomSettings.toolBarOrientation:u.orientation,highlightColor:null==t.highlightColor?i.zoomSettings.highlightColor:t.highlightColor,selectionColor:null==t.selectionColor?i.zoomSettings.selectionColor:t.selectionColor,horizontalAlignment:"Far"===u.horizontalAlignment?i.zoomSettings.horizontalAlignment:u.horizontalAlignment,verticalAlignment:"Near"===u.verticalAlignment?i.zoomSettings.verticalAlignment:u.verticalAlignment,color:null==t.color?i.zoomSettings.color:t.color,shapeOpacity:1!==t.opacity?t.opacity:1,borderOpacity:1!==t.borderOpacity?t.borderOpacity:1};var ht=t.radius/4,ct=t.radius/4,lt=t.radius/2,e=t.padding,ft=this.maps.toolbarProperties.toolBarOrientation,g=i.zoomSettings.toolbarSettings.buttonSettings.toolbarItems.map(function(n){return n}),et=3===g.length?i.zoomSettings.toolbars:g;w=t.radius/4+t.borderWidth/2+e;k=t.radius/4+t.borderWidth/2+e;var a=g.length,vt="Horizontal"===ft?a*t.radius+a*e+e+a*t.borderWidth:t.radius+t.borderWidth+2*e,yt="Horizontal"===ft?t.radius+t.borderWidth+2*e:a*t.radius+a*e+e+a*t.borderWidth,ot=i.renderer.createDefs();for(ot.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/><\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',this.toolBarGroup.appendChild(ot),st=i.renderer.drawRectangle(new b(i.element.id+"_Zooming_Rect",u.backgroundColor,{color:u.borderColor,width:u.borderWidth,opacity:u.borderOpacity},u.borderOpacity,new v(u.borderWidth/2,u.borderWidth/2,vt-u.borderWidth,yt-u.borderWidth),0,0)),this.toolBarGroup.appendChild(st),f=(t.radius-t.borderWidth/2)/30,d=0;d<et.length;d++){0!==d&&(w="Horizontal"===i.toolbarProperties.toolBarOrientation?w+(t.radius+e)+t.borderWidth:w,k="Horizontal"===i.toolbarProperties.toolBarOrientation?k:k+(t.radius+e)+t.borderWidth);var o=et[d],s=n.isNullOrUndefined(this.maps.toolbarProperties.color)?this.maps.themeStyle.zoomFillColor:this.maps.toolbarProperties.color,pt=t.borderColor||this.maps.themeStyle.zoomFillColor;this.currentToolbarEle=i.renderer.createGroup({id:i.element.id+"_Zooming_ToolBar_"+o+"_Group",transform:"translate( "+w+" "+k+" ) "});this.currentToolbarEle.setAttribute("class","e-maps-toolbar");this.currentToolbarEle.appendChild(i.renderer.drawCircle(new at(i.element.id+"_Zooming_ToolBar_"+o+"_Rect",t.fill,{color:pt,width:t.borderWidth,opacity:t.borderOpacity},t.opacity,ht,ct,lt,"")));r="";h=t.fill;switch(this.selectionColor=this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor,o.toLowerCase()){case"zoom":c=void 0;l=void 0;r="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";r+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571";r+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,";this.currentToolbarEle.setAttribute("class",this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"");this.maps.zoomSettings.enablePanning&&!this.maps.zoomSettings.enableSelectionZooming||this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(c=h,l=s):this.maps.zoomSettings.enablePanning||this.maps.zoomSettings.enableSelectionZooming?!this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(c=this.maps.themeStyle.zoomFillColor,l=s):this.maps.zoomSettings.enablePanning||this.maps.zoomSettings.enableSelectionZooming?(c=this.selectionColor,l=this.selectionColor):(c=h,l=s):(c=h,l=s);nt=i.renderer.drawPath(new y(i.element.id+"_Zooming_ToolBar_"+o,c,1,l,1,1,null,r+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z"));nt.setAttribute("transform","scale( "+f+","+f+" )");this.currentToolbarEle.appendChild(nt);this.zoomElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomin":r="M 8, 0 L 8, 16 M 0, 8 L 16, 8";tt=i.renderer.drawPath(new y(i.element.id+"_Zooming_ToolBar_"+o+"_Path",h,3,s,1,1,null,r));tt.setAttribute("transform","scale( "+f+","+f+" )");this.currentToolbarEle.appendChild(tt);this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomout":r="M 0, 8 L 16, 8";it=i.renderer.drawPath(new y(i.element.id+"_Zooming_ToolBar_"+o,h,3,s,1,1,null,r));it.setAttribute("transform","scale( "+f+","+f+" )");this.currentToolbarEle.appendChild(it);this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"pan":p=void 0;r="M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,";r+="11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z";this.currentToolbarEle.setAttribute("class",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"");this.maps.zoomSettings.enablePanning&&this.maps.zoomModule.isDragZoom?p=this.selectionColor||this.maps.themeStyle.zoomFillColor:this.maps.zoomSettings.enablePanning?p=h||this.maps.themeStyle.zoomFillColor:(p=this.selectionColor||this.maps.themeStyle.zoomFillColor,this.currentToolbarEle.setAttribute("class",""));rt=i.renderer.drawPath(new y(i.element.id+"_Zooming_ToolBar_"+o,p,1,s,1,1,null,r));rt.setAttribute("transform","scale( "+f+","+f+" )");this.currentToolbarEle.appendChild(rt);this.panColor=p;this.panElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"reset":r="M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,";r+="1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,";r+="13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,";ut=i.renderer.drawPath(new y(i.element.id+"_Zooming_ToolBar_"+o,h,null,s,1,1,null,r+"3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z"));ut.setAttribute("transform","scale( "+f+","+f+" )");this.currentToolbarEle.appendChild(ut);this.wireEvents(this.currentToolbarEle,this.performToolBarAction)}this.toolBarGroup.appendChild(this.currentToolbarEle)}},t.prototype.performToolBarAction=function(n){var r=n.target;n.stopImmediatePropagation();var u="touch"===n.pointerType||"2"===n.pointerType||n.type.indexOf("touch")>-1,i=r.id.split("_Zooming_ToolBar_")[1].split("_")[0],t=!0;switch(i.toLowerCase()){case"zoomin":t=(this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale)+1<=this.maps.zoomSettings.maxZoom;break;case"zoomout":t=(this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale)-1>=this.maps.zoomSettings.minZoom;break;case"reset":t=Math.round(this.maps.isTileMap?this.maps.tileZoomLevel:this.maps.scale)!=this.maps.zoomSettings.minZoom}u&&t?(this.handled=!0,this.performZoomingByToolBar(i)):"mousedown"!==n.type&&"pointerdown"!==n.type||this.handled||!t?this.handled=!1:(this.handled=!1,this.performZoomingByToolBar(i))},t.prototype.performZoomingByToolBar=function(n){var t=this.maps,r,i;t.isReset=!1;r=0;i=this.fillColor||this.maps.themeStyle.zoomFillColor;switch(n.toLowerCase()){case"zoom":this.panColor=i;this.zoomColor=this.maps.zoomSettings.enableSelectionZooming?this.selectionColor:i;this.applySelection(this.zoomElements,this.zoomColor);this.applySelection(this.panElements,this.panColor);this.isPan=!1;this.isZoomSelection=this.maps.zoomSettings.enableSelectionZooming;break;case"pan":this.panColor=this.maps.zoomSettings.enablePanning?this.selectionColor:i;this.zoomColor=i;this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor||i),this.applySelection(this.panElements,this.panColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor));this.isPan=this.maps.zoomSettings.enablePanning;this.isZoomSelection=!1;break;case"zoomin":t.staticMapZoom=t.tileZoomLevel;t.staticMapZoom>0&&t.staticMapZoom<22&&(t.staticMapZoom+=1);this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)+1,"ZoomIn");r=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);this.isZoomSelection||(r===t.zoomSettings.maxZoom||r>1||1===r&&this.maps.isTileMap?(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,t.zoomSettings.enablePanning?this.selectionColor:i)):1!==r||this.maps.isTileMap||(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,i)));break;case"zoomout":t.staticMapZoom=t.tileZoomLevel;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)-1,"ZoomOut");r=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);!this.isPan&&this.isZoomSelection?(this.panColor=i,this.zoomColor=this.selectionColor,this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor)):r<=1&&!t.isTileMap?this.applySelection(this.panElements,i):this.applySelection(this.panElements,t.zoomSettings.enablePanning?this.selectionColor:i);break;case"reset":t.staticMapZoom=t.zoomSettings.enable?t.zoomSettings.zoomFactor:0;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.isZoomSelection=!1;this.isPan=t.zoomSettings.enablePanning;this.toolBarZooming(t.zoomSettings.minZoom,"Reset");this.isPan&&!this.isZoomSelection||!this.isPan&&this.isZoomSelection?this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,this.selectionColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,i)):this.isPan||this.isZoomSelection||(this.applySelection(this.zoomElements,i),this.applySelection(this.panElements,i))}this.panningStyle(n.toLowerCase())},t.prototype.panningStyle=function(n){var t=r(this.maps.element.id+"_svg");"pan"===n||this.isPanning&&"reset"!==n?t.setAttribute("class","e-maps-panning"):t.setAttribute("class","")},t.prototype.applySelection=function(n,t){if(n)for(var i,r=0;r<n.childElementCount;r++)"circle"!==(i=n.childNodes[r]).tagName&&(i.setAttribute("fill",n.id.indexOf("Pan")>-1?t:"transparent"),i.setAttribute("stroke",t))},t.prototype.showTooltip=function(t){var u=t.target.id.split("_Zooming_ToolBar_")[1].split("_")[0],i=this.maps.zoomSettings.toolbarSettings.tooltipSettings,r={visible:i.visible,fill:i.fill,borderOpacity:i.borderOpacity,borderWidth:i.borderWidth,borderColor:i.borderColor,fontColor:i.fontColor,fontFamily:i.fontFamily,fontStyle:i.fontStyle,fontWeight:i.fontWeight,fontSize:i.fontSize||"10px",fontOpacity:i.fontOpacity};r.fontFamily=this.maps.themeStyle.fontFamily;this.isTouch||(function(t,i,r,u,f){var e=s(t),o=kr(f.borderColor),h=kr(f.fontColor),c="top:"+r.toString()+"px;left:"+u.toString()+"px;color:"+(h?"rgba("+h.r+","+h.g+","+h.b+","+f.fontOpacity+")":f.fontColor)+";background:"+f.fill+";z-index: 2;position:absolute;border:"+f.borderWidth+"px solid "+(o?"rgba("+o.r+","+o.g+","+o.b+","+f.borderOpacity+")":f.borderColor)+";font-family:"+f.fontFamily+";font-style:"+f.fontStyle+";font-weight:"+f.fontWeight+";font-size:"+f.fontSize+";border-radius:"+f.borderWidth+"px;";!e&&f.visible?((e=n.createElement("div",{id:t})).innerHTML=n.SanitizeHtmlHelper.sanitize("&nbsp;"+i+"&nbsp;"),e.style.cssText=c,document.body.appendChild(e)):f.visible&&(e.innerHTML=n.SanitizeHtmlHelper.sanitize("&nbsp;"+i+"&nbsp;"),e.style.cssText=c)}("EJ2_Map_Toolbar_Tip",this.maps.getLocalizedLabel(u),t.pageY+10,t.pageX+10,r),this.maps.isDevice&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3)))},t.prototype.removeTooltip=function(){r("EJ2_Map_Toolbar_Tip")&&n.remove(r("EJ2_Map_Toolbar_Tip"))},t.prototype.alignToolBar=function(){var t=this.maps,f=n.createElement("div",{id:t.element.id+"_ToolBar"}),e,i;f.style.cssText="position:absolute;z-index:2";e=t.renderer.createSvg({id:t.element.id+"_Zooming_ToolBar",width:10,height:10});e.appendChild(this.toolBarGroup);f.appendChild(e);r(t.element.id+"_Secondary_Element")&&r(t.element.id+"_Secondary_Element").appendChild(f);i=this.toolBarGroup.getBoundingClientRect();e.setAttribute("height",(i.height+t.zoomSettings.toolbarSettings.borderWidth).toString());e.setAttribute("width",(i.width+t.zoomSettings.toolbarSettings.borderWidth).toString());var u=n.isNullOrUndefined(t.totalRect)?t.mapAreaRect:t.totalRect,o=0,s=0;switch(t.toolbarProperties.verticalAlignment){case"Near":s=u.y;break;case"Center":s=u.height/2-i.height/2;break;case"Far":s=u.height-i.height-10}switch(t.toolbarProperties.horizontalAlignment){case"Near":o=u.x;break;case"Center":o=u.width/2-i.width/2;break;case"Far":o=n.isNullOrUndefined(t.legendModule)||"Left"!==t.legendSettings.position?u.width-i.width-10:u.width+u.x-i.width-10}f.style.left=o+"px";f.style.top=s+"px";var h=this.maps.toolbarProperties.highlightColor||this.maps.themeStyle.zoomSelectionColor,l=" .e-maps-toolbar:hover > circle { stroke:"+h+"; } .e-maps-toolbar:hover > path { fill: "+h+" ;  stroke: "+h+"; }.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } .e-maps-popup-close { display: block; opacity: 0; }",c=document.createElement("style");c.appendChild(document.createTextNode(l));f.appendChild(c)},t.prototype.removeToolbarOpacity=function(n,t){if(this.maps.zoomModule&&this.maps.zoomSettings.enable)if(r(this.maps.element.id+"_Zooming_KitCollection")&&t.indexOf(this.maps.element.id+"_Zooming_")>-1){this.maps.isDevice?(r(this.maps.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"),this.removeToolbarClass("","","","","")):this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar");var i=this.maps.toolbarProperties.shapeOpacity,u=this.maps.toolbarProperties.borderOpacity;this.maps.isTileMap&&(n<=1.1||this.maps.zoomSettings.minZoom===n)?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"",""),this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming&&!this.maps.isReset&&(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)),this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?i:.3,this.maps.zoomSettings.enableSelectionZooming?u:.3,i,u,.3,.3,this.maps.zoomSettings.enablePanning?i:.3,this.maps.zoomSettings.enablePanning?u:.3,.3,.3)):n<=1.1||this.maps.zoomSettings.minZoom===n?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","","",""),!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming&&!this.maps.isReset&&(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)),this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?i:.3,this.maps.zoomSettings.enableSelectionZooming?u:.3,i,u,.3,.3,.3,.3,.3,.3)):n<this.maps.zoomSettings.maxZoom?(this.maps.isDevice||this.removeToolbarClass(this.maps.zoomSettings.enableSelectionZooming?"e-maps-toolbar":"","e-maps-toolbar","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar"),this.maps.zoomModule.isZoomFinal?this.maps.zoomModule.isZoomFinal=!1:this.removeZoomOpacity(this.maps.zoomSettings.enableSelectionZooming?i:.3,this.maps.zoomSettings.enableSelectionZooming?u:.3,i,u,i,u,this.maps.zoomSettings.enablePanning?i:.3,this.maps.zoomSettings.enablePanning?u:.3,i,u),this.isZoomSelection&&this.maps.zoomSettings.enableSelectionZooming?(this.removeZoomColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.maps.zoomModule.isPan&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor)):!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&(this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor),this.maps.zoomSettings.enableSelectionZooming&&this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor))):(this.maps.isDevice||this.removeToolbarClass("","","e-maps-toolbar",this.maps.zoomSettings.enablePanning?"e-maps-toolbar":"","e-maps-toolbar"),this.removeZoomOpacity(.3,.3,.3,.3,i,u,this.maps.zoomSettings.enablePanning?i:.3,this.maps.zoomSettings.enablePanning?u:.3,i,u),this.maps.zoomSettings.enableSelectionZooming&&this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),!this.isZoomSelection&&this.maps.zoomSettings.enablePanning&&this.removePanColor(this.maps.toolbarProperties.selectionColor||this.maps.themeStyle.zoomSelectionColor))}else this.maps.isDevice||(this.removePanColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.removeZoomColor(this.maps.toolbarProperties.color||this.maps.themeStyle.zoomFillColor),this.removeZoomOpacity(1,1,1,1,1,1,1,1,1,1))},t.prototype.setOpacity=function(n,t,i,u){r(this.maps.element.id+n)&&(r(this.maps.element.id+n).setAttribute("stroke-opacity",i.toString()),r(this.maps.element.id+n).setAttribute("fill-opacity",i.toString()),r(this.maps.element.id+t).setAttribute("stroke-opacity",u.toString()),r(this.maps.element.id+t).setAttribute("fill-opacity",u.toString()))},t.prototype.removeZoomOpacity=function(n,t,i,r,u,f,e,o,s,h){this.setOpacity("_Zooming_ToolBar_Zoom_Rect","_Zooming_ToolBar_Zoom",t,n);this.setOpacity("_Zooming_ToolBar_ZoomIn_Rect","_Zooming_ToolBar_ZoomIn_Path",r,i);this.setOpacity("_Zooming_ToolBar_ZoomOut_Rect","_Zooming_ToolBar_ZoomOut",f,u);this.setOpacity("_Zooming_ToolBar_Pan_Rect","_Zooming_ToolBar_Pan",o,e);this.setOpacity("_Zooming_ToolBar_Reset_Rect","_Zooming_ToolBar_Reset",h,s)},t.prototype.removeToolbarClass=function(n,t,i,u,f){r(this.maps.element.id+"_Zooming_KitCollection")&&(document.getElementById(this.maps.element.id+"_Zooming_ToolBar_ZoomIn_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_ZoomIn_Group").setAttribute("class",t),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_ZoomOut_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_ZoomOut_Group").setAttribute("class",i),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Reset_Group")&&r(this.maps.element.id+"_Zooming_ToolBar_Reset_Group").setAttribute("class",f),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Zoom_Group")&&this.maps.zoomSettings.enableSelectionZooming&&r(this.maps.element.id+"_Zooming_ToolBar_Zoom_Group").setAttribute("class",n),document.getElementById(this.maps.element.id+"_Zooming_ToolBar_Pan_Group")&&this.maps.zoomSettings.enablePanning&&r(this.maps.element.id+"_Zooming_ToolBar_Pan_Group").setAttribute("class",u))},t.prototype.removePanColor=function(n){r(this.maps.element.id+"_Zooming_ToolBar_Pan_Rect")&&this.maps.zoomSettings.enablePanning&&(r(this.maps.element.id+"_Zooming_ToolBar_Pan").setAttribute("fill",n),r(this.maps.element.id+"_Zooming_ToolBar_Pan").setAttribute("stroke",n))},t.prototype.removeZoomColor=function(n){r(this.maps.element.id+"_Zooming_ToolBar_Zoom_Rect")&&this.maps.zoomSettings.enableSelectionZooming&&(r(this.maps.element.id+"_Zooming_ToolBar_Zoom").setAttribute("fill","transparent"),r(this.maps.element.id+"_Zooming_ToolBar_Zoom").setAttribute("stroke",n))},t.prototype.wireEvents=function(t,i){n.EventHandler.add(t,n.Browser.touchStartEvent,i,this);n.EventHandler.add(t,"mouseover",this.showTooltip,this);n.EventHandler.add(t,"mouseout",this.removeTooltip,this)},t.prototype.mapMouseWheel=function(t){var i,f;if(this.maps.zoomSettings.enable&&this.maps.zoomSettings.mouseWheelZoom){i=this.maps;i.availableSize;i.markerZoomedState=!1;i.zoomPersistence=i.enablePersistence;var r=this.getMousePosition(t.pageX,t.pageY),e=i.tileZoomLevel,o=i.scale,u=i.isTileMap?e:o;r.x>i.mapAreaRect.x&&r.x<i.mapAreaRect.x+i.mapAreaRect.width&&r.y>i.mapAreaRect.y&&r.y<i.mapAreaRect.y+i.mapAreaRect.height&&(t.preventDefault(),f="mozilla"!==this.browserName||this.isPointer?t.wheelDelta/120>0?"ZoomIn":"ZoomOut":-t.detail/3>0?"ZoomIn":"ZoomOut","ZoomIn"===f?(i.mapScaleValue=u+1,i.staticMapZoom=i.tileZoomLevel,i.staticMapZoom>0&&i.staticMapZoom<22&&(i.staticMapZoom+=1),this.performZooming(r,u+1,f)):(i.mapScaleValue=u-1,i.isReset=i.mapScaleValue<1,i.staticMapZoom=i.tileZoomLevel,1===i.mapScaleValue&&(i.markerCenterLatitude=null,i.markerCenterLongitude=null),i.staticMapZoom>1&&i.staticMapZoom<22&&(i.staticMapZoom-=1),this.performZooming(r,u-1,f)));this.removeToolbarOpacity(i.mapScaleValue,this.maps.isDevice?this.maps.element.id+"_Zooming_":n.isNullOrUndefined(t.target)?this.maps.element.id:t.target.id)}},t.prototype.doubleClick=function(n){var u=n.pageX,f=n.pageY,r;if(n.target,this.maps.zoomSettings.enable&&this.maps.zoomSettings.doubleClickZoom&&!(n.target.id.indexOf("_Zooming_")>-1)){var i=this.getMousePosition(u,f),t=this.maps,e=(t.availableSize,t.tileZoomLevel),o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},t.prototype.mouseDownHandler=function(n){var t,i,r=null,u;n.target;"touchstart"===n.type?(this.isTouch=!0,r=n.touches,n.target,t=r[0].clientX,i=r[0].clientY):(t=n.pageX,i=n.pageY,n.target);this.isPan=this.maps.zoomSettings.enablePanning?this.isPanning=!this.isZoomSelection:this.isPanning=this.panColor!==this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor===this.selectionColor;this.mouseDownLatLong={x:t,y:i};u=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue);this.rectZoomingStart=this.isZoomSelection&&u<this.maps.zoomSettings.maxZoom&&this.maps.zoomSettings.enable;this.mouseDownPoints=this.getMousePosition(t,i);this.isTouch&&(this.firstMove=!0,this.pinchFactor=this.maps.scale,this.fingers=r.length);this.isSingleClick=!0},t.prototype.mouseMoveHandler=function(t){var u,f,o,e=this.maps,i=null,h=this.maps.zoomSettings,s;("touchmove"===t.type?(this.isTouch=!0,o=t.target,u=(i=t.touches)[0].clientX,f=i[0].clientY):(u=t.pageX,f=t.pageY,o=t.target),r(e.element.id+"_Zooming_KitCollection")&&(o.id.indexOf("_Zooming_")>-1?r(e.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"):e.isDevice||r(e.element.id+"_Zooming_KitCollection").setAttribute("opacity","fluentdark"===e.theme.toLowerCase()?"0.6":"0.3")),this.isTouch&&this.maps.zoomSettings.pinchZooming&&(this.firstMove&&2===i.length?(this.rectZoomingStart=!1,this.updateInteraction(),this.touchStartList=gr(t)):2===i.length&&2===this.touchStartList.length&&(this.touchMoveList=gr(t),t.preventDefault(),this.rectZoomingStart=!1,this.performPinchZooming(t)),this.firstMove=!1),this.mouseMovePoints=this.getMousePosition(u,f),t.target.id,t.target,h.enable&&this.isPanning&&-1==this.maps.markerDragId.indexOf("_MarkerIndex_")&&(n.Browser.isDevice&&i.length>=1||!n.Browser.isDevice)&&(t.preventDefault(),this.maps.element.style.cursor="pointer",this.mouseMoveLatLong={x:u,y:f},this.mouseDownLatLong.x!==this.mouseMoveLatLong.x&&this.mouseDownLatLong.y!==this.mouseMoveLatLong.y&&(this.maps.zoomSettings.enablePanning&&this.panning("None",null,null,t),this.mouseDownLatLong.x=u,this.mouseDownLatLong.y=f)),this.isTouch?1===i.length&&this.rectZoomingStart:this.rectZoomingStart)&&(t.preventDefault(),s=this.maps.isTileMap?Math.round(this.maps.tileZoomLevel):Math.round(this.maps.mapScaleValue),this.maps.zoomSettings.enableSelectionZooming&&s<this.maps.zoomSettings.maxZoom?this.drawZoomRectangle():(this.rectZoomingStart=!1,this.isPan=!0))},t.prototype.mouseUpHandler=function(){this.maps;this.rectZoomingStart=!1;this.isPanning=!1;this.isSingleClick=!!this.isSingleClick;this.isTouch=!1;this.touchStartList=[];this.touchMoveList=[];this.lastScale=1;this.maps.element.style.cursor="auto";n.isNullOrUndefined(this.distanceX)&&n.isNullOrUndefined(this.distanceY)||n.isNullOrUndefined(this.currentLayer)||"SubLayer"!==this.currentLayer.type||(this.toAlignSublayer(),this.distanceX=this.distanceY=null);var t=r(this.maps.element.id+"_Selection_Rect_Zooming");t&&this.maps.zoomSettings.enable&&this.maps.zoomSettings.enableSelectionZooming&&(n.remove(t),this.performRectZooming());this.mouseMoveLatLong={x:0,y:0};this.mouseDownLatLong={x:0,y:0}},t.prototype.mouseCancelHandler=function(){this.isPanning=!1;this.isTouch=!1;this.rectZoomingStart=!1;var t=r(this.maps.element.id+"_Selection_Rect_Zooming");t&&this.maps.zoomSettings.enable&&(n.remove(t),this.performRectZooming())},t.prototype.click=function(n){var t=this.maps,r;if(t.markerModule&&t.markerModule.sameMarkerData.length>0||n.target.id.indexOf("MarkerIndex")>-1&&-1===n.target.id.indexOf("cluster"))return null;if(this.isSingleClick&&t.zoomSettings.zoomOnClick&&!(n.target.id.indexOf("_Zooming_")>-1)&&!t.zoomSettings.doubleClickZoom&&this.zoomColor!==this.selectionColor){var u=n.pageX,f=n.pageY,i=this.getMousePosition(u,f),e=t.tileZoomLevel,o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},t.prototype.getMousePosition=function(n,t){var i=this.maps,r=i.element.getBoundingClientRect(),u=i.element.ownerDocument.defaultView.pageXOffset,e=i.element.ownerDocument.defaultView.pageYOffset,o=i.element.ownerDocument.documentElement.clientTop,s=i.element.ownerDocument.documentElement.clientLeft,h=r.left+u-s,c=r.top+e-o;return new f(Math.abs(n-h),Math.abs(t-c))},t.prototype.addEventListener=function(){this.maps.isDestroyed||(n.EventHandler.add(this.maps.element,this.wheelEvent,this.mapMouseWheel,this),n.EventHandler.add(this.maps.element,"click",this.click,this),n.EventHandler.add(this.maps.element,"dblclick",this.doubleClick,this),this.maps.on(n.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.maps.on(n.Browser.touchStartEvent,this.mouseDownHandler,this),this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this),n.EventHandler.add(this.maps.element,this.cancelEvent,this.mouseCancelHandler,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(n.EventHandler.remove(this.maps.element,this.wheelEvent,this.mapMouseWheel),n.EventHandler.remove(this.maps.element,"click",this.click),n.EventHandler.remove(this.maps.element,"dblclick",this.doubleClick),this.maps.off(n.Browser.touchMoveEvent,this.mouseMoveHandler),this.maps.off(n.Browser.touchStartEvent,this.mouseDownHandler),this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler),this.maps.off(this.cancelEvent,this.mouseCancelHandler))},t.prototype.getModuleName=function(){return"Zoom"},t.prototype.destroy=function(){this.toolBarGroup=null;this.currentToolbarEle=null;this.zoomingRect=null;this.zoomElements=null;this.panElements=null;this.baseTranslatePoint=null;this.touchStartList=null;this.touchMoveList=null;this.previousTouchMoveList=null;this.mouseDownPoints=null;this.mouseMovePoints=null;this.startTouches=[];this.zoomshapewidth=null;this.intersect=[];this.mouseDownLatLong=null;this.mouseMoveLatLong=null;this.removeEventListener();this.currentLayer=null},t}();ejdashboard.pdfexport;lf.Inject(to,uo,au,fo,eo,oo,so,io,ro,cf);ei={};ei.Maps=lf;af={maps:ei=oi.C(window.ejdashboard?window.ejdashboard.maps:{},ei)};window.ejdashboard=oi.C(window.ejdashboard||{},af)})()})();
