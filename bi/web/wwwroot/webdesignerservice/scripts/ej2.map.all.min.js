/*!
*  filename: ej2.map.all.min.js
*  version : 8.1.41.41
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function t(r){var f=n[r],u;return void 0!==f?f.exports:(u=n[r]={exports:{}},i[r](u,u.exports,t),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},n={};(()=>{function wt(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function gi(t){t.element.style.height=n.isNullOrUndefined(t.height)?"auto":t.height;t.element.style.width=n.isNullOrUndefined(t.width)?"auto":t.width;var i=t.element.clientWidth,r=t.element.clientHeight,u=wt(t.element.style.width,i),f=wt(t.element.style.height,r);return new w(0,0),"0px"===t.width||"0%"===t.width||"0%"===t.height||"0px"===t.height?new w(0,0):new w(wt(t.width,i)||i||u||600,wt(t.height,r)||r||f||(t.isDevice?Math.min(window.innerWidth,window.innerHeight):450))}function hi(n,t,i){var r=i.getBoundingClientRect(),u=i.ownerDocument.defaultView.pageXOffset,f=i.ownerDocument.defaultView.pageYOffset,e=i.ownerDocument.documentElement.clientTop,o=i.ownerDocument.documentElement.clientLeft,s=r.left+u-o,h=r.top+f-e;return new tt(n-s,t-h)}function ci(n){return n*(Math.PI/180)}function nr(n){return n*(180/Math.PI)}function y(t,i,r,u,e){var a,v,y,s,h,l,p=new w(e.mapAreaRect.width,e.mapAreaRect.height),it=e.baseMapBounds.longitude,rt=e.baseMapBounds.latitude,o=ci(t),c=ci(i),k=e.projectionType,b=e.isTileMap?256*Math.pow(2,1):n.isNullOrUndefined(r)?Math.min(p.width,p.height):Math.min(p.width,p.height)*r,d,g,nt,tt;if("Normal"===u.geometryType)a=n.isNullOrUndefined(r)?i:Math.abs((i-it.min)*r),v=n.isNullOrUndefined(r)?t:Math.abs((rt.max-t)*r);else if("Geographic"===u.geometryType){switch(k){case"Mercator":d=new f(b/2,b/2);a=d.x+i*(b/360);g=function(t,i,r){return n.isNullOrUndefined(i)||(t=Math.max(t,i)),n.isNullOrUndefined(r)||(t=Math.min(t,r)),t}(Math.sin(ci(t)),-.9999,.9999);v=d.y+.5*Math.log((1+g)/(1-g))*(-b/(2*Math.PI));break;case"Winkel3":h=((y=tr(c,o)).x+c/(Math.PI/2))/2;s=(y.y+o)/2;break;case"Miller":h=c;s=1.25*Math.log(Math.tan(Math.PI/4+.4*o));break;case"Eckert3":h=2/(l=Math.sqrt(Math.PI*(4+Math.PI)))*c*(1+Math.sqrt(1-4*o*o/(Math.PI*Math.PI)));s=4/l*o;break;case"AitOff":h=(y=tr(c,o)).x;s=y.y;break;case"Eckert5":h=c*(1+Math.cos(o))/Math.sqrt(2+Math.PI);s=2*o/Math.sqrt(2+Math.PI);break;case"Equirectangular":h=c;s=o;break;case"Eckert6":for(l=(1+Math.PI/2)*Math.sin(o),nt=1/0,tt=0;tt<10&&Math.abs(nt)>1e-6;tt++)o-=nt=(o+Math.sin(o)-l)/(1+Math.cos(o));l=Math.sqrt(2+Math.PI);h=c*(1+Math.cos(o))/l;s=2*o/l}a="Mercator"===k?a:ir(function(t,i){var r=t.baseMapBounds.longitude,u=n.isNullOrUndefined(t.baseSize)?t.mapAreaRect.width:t.mapAreaRect.width+Math.abs(t.baseSize.width-t.mapAreaRect.width)/2;return Math.round(u*(i-r.min)/(r.max-r.min)*100)/100}(e,nr(h)),3);v="Mercator"===k?v:-ir(function(n,t){var i=n.baseMapBounds.latitude;return Math.round(n.mapAreaRect.height*(t-i.min)/(i.max-i.min)*100)/100}(e,nr(s)),3)}return new f(a,v)}function it(n,t,i,r){var u=256*Math.pow(2,t),s=(n.x+180)/360,f=Math.sin(n.y*Math.PI/180),h=.5-Math.log((1+f)/(1-f))/(4*Math.PI),e=n.x,o=n.y;return r&&(e=s*u+.5+i.x,o=h*u+.5+i.y),{x:e,y:o}}function tr(n,t){var i,r=Math.cos(t),u=function(n){return n/Math.sin(n)}((i=r*Math.cos(n/=2),Math.acos(i)));return new f(2*r*Math.sin(n)*u,Math.sin(t)*u)}function ir(n,t){var i=Math.pow(10,t);return Math.round(n*i)/i}function v(t,i){var r=document.getElementById("mapsmeasuretext");return null===r&&(r=n.createElement("text",{id:"mapsmeasuretext"}),document.body.appendChild(r)),r.innerHTML=t,r.style.position="absolute",r.style.fontSize="number"==typeof i.size?i.size+"px":i.size,r.style.fontWeight=i.fontWeight,r.style.fontStyle=i.fontStyle,r.style.fontFamily=i.fontFamily,r.style.visibility="hidden",r.style.top="-100",r.style.left="0",r.style.whiteSpace="nowrap",r.style.lineHeight="normal",new w(r.clientWidth,r.clientHeight)}function ot(n,t,i,r,u){var e,c;void 0===u&&(u=!1);var s,o,l={id:n.id,x:n.x,y:n.y,fill:i,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight,"text-anchor":n.anchor,transform:n.transform,opacity:t.opacity,"dominant-baseline":n.baseLine},a="string"==typeof n.text||"number"==typeof n.text?n.text:u?n.text[n.text.length-1]:n.text[0],h=new et.SvgRenderer(""),f=h.createText(l,a);if(f.style["user-select"]="none",f.style["font-family"]=t.fontFamily,f.style["font-size"]=t.size,f.style["font-weight"]=t.fontWeight,f.style["font-color"]=t.color,f.style["-moz-user-select"]="none",f.style["-webkit-touch-callout"]="none",f.style["-webkit-user-select"]="none",f.style["-khtml-user-select"]="none",f.style["-ms-user-select"]="none",f.style["-o-user-select"]="none","string"!=typeof n.text&&n.text.length>1)for(e=1,c=n.text.length;e<c;e++)o=v(n.text[e],t).height,s=h.createTSpan({x:n.x,id:n.id,y:n.y+(u?-e*o:e*o)},u?n.text[n.text.length-(e+1)]:n.text[e]),f.appendChild(s);return r.appendChild(f),f}function lt(n,t){return t.format&&!isNaN(Number(n))?t.intl.getNumberFormat({format:t.format,useGrouping:t.useGroupingSeparator})(Number(n)):n}function ur(n,t,i,r){for(var h,o,c,s=""===n?t:n,f=""===n?s.split("${"):s.split("{{:"),u=0;u<f.length;u++)if(f[u].indexOf("}}")>-1&&f[u].indexOf(".")>-1||f[u].indexOf("}")>-1&&f[u].search(".")>-1)for(h=""===n?f[u].split("}"):f[u].split("}}"),o=0;o<h.length;o++)h[o].indexOf(".")>-1&&(c=e(i,h[o]).toString(),s=""===n?s.split("${"+h[o]+"}").join(lt(c,r)):s.replace(new RegExp("{{:"+h[o]+"}}","g"),c));return s}function fr(t,i,r,u,f,e,o){var h,l,a,d,s=f.size,g=f.borderColor,nt=parseFloat(f.borderWidth),tt=parseFloat(f.borderOpacity),v=f.fill,y=f.dashArray,it={color:g,width:nt,opacity:tt},w=f.opacity,k=new p(u,v,nt,g,w,tt,y,""),rt,ut;return"Circle"===t?(rt=(s.width+s.height)/4,ut=new bt(u,v,it,w,r.x,r.y,rt,y),h=o.renderer.drawCircle(ut)):"Rectangle"===t?(l=r.x-s.width/2,a=r.y-s.height/2,d=new b(u,v,it,w,new c(l,a,s.width,s.height),null,null,"",y),h=o.renderer.drawRectangle(d)):"Image"===t?(l=r.x-s.width/2,a=r.y-s.height,n.merge(k,{href:i,height:s.height,width:s.width,x:l,y:a}),h=o.renderer.drawImage(k)):h=function(n,t,i,r,u,f){var o;switch(t){case"Balloon":o=cr(n,i,r,u,"Marker",f);break;case"Cross":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"Diamond":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+u.y+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+u.y+" Z";break;case"Star":i.d="M "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/6)+" L "+(u.x-r.width/3)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" L "+(u.x+r.width/3)+" "+(u.y-r.height/2)+" Z";break;case"Triangle":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y+r.height/2)+" L "+(u.x-r.width/2)+" "+(u.y+r.height/2)+" Z";break;case"HorizontalLine":i.d=" M "+(u.x-r.width/2)+" "+u.y+" L "+(u.x+r.width/2)+" "+u.y;break;case"VerticalLine":i.d="M "+u.x+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2);break;case"InvertedTriangle":i.d="M "+(u.x-r.width/2)+" "+(u.y-r.height/2)+" L "+(u.x+r.width/2)+" "+(u.y-r.height/2)+" L "+u.x+" "+(u.y+r.height/2)+" Z";break;case"Pentagon":for(var s=void 0,h=void 0,e=0;e<5;e++)s=r.width/2*Math.cos(Math.PI/180*72*e),h=r.height/2*Math.sin(Math.PI/180*72*e),i.d+=(0===e?"M ":"L ")+(u.x+s)+" "+(u.y+h);i.d+=" Z"}return"Cross"!==t&&"HorizontalLine"!==t&&"VerticalLine"!==t||(i.stroke="transparent"===i.stroke?i.fill:i.stroke),"Balloon"===t?o:n.renderer.drawPath(i)}(o,t,k,s,r,e),h}function e(t,i){var r,u;if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(i))if(r=i.replace(/\[/g,".").replace(/\]/g,"").split("."),1===r.length)t=t[r[0]];else for(u=0;u<r.length&&!n.isNullOrUndefined(t);u++)t=t[r[u]];return t}function ai(t,i){var r=n.isNullOrUndefined(t.colorValuePath)?i[t.colorValuePath]:t.colorValuePath.indexOf(".")>-1?e(i,t.colorValuePath).toString():i[t.colorValuePath];return t.fill=n.isNullOrUndefined(t.colorValuePath)||n.isNullOrUndefined(r)?t.fill:t.colorValuePath.indexOf(".")>-1?e(i,t.colorValuePath).toString():i[t.colorValuePath],t}function vi(t,i){var r,f,u;return n.isNullOrUndefined(t.shapeValuePath)||n.isNullOrUndefined(i[t.shapeValuePath])?(r=n.isNullOrUndefined(t.shapeValuePath)?t.shape:t.shapeValuePath.indexOf(".")>-1?e(i,t.shapeValuePath).toString():t.shape,t.shape=""!==r.toString()?r:t.shape,f=n.isNullOrUndefined(t.imageUrlValuePath)?t.imageUrl:t.imageUrlValuePath.indexOf(".")>-1?e(i,t.imageUrlValuePath).toString():n.isNullOrUndefined(i[t.imageUrlValuePath])?t.imageUrl:i[t.imageUrlValuePath],t.imageUrl=f):(u=t.shapeValuePath.indexOf(".")>-1?e(i,t.shapeValuePath).toString():i[t.shapeValuePath],t.shape=""!==u.toString()?u:t.shape,"Image"===i[t.shapeValuePath]&&(t.imageUrl=n.isNullOrUndefined(t.imageUrlValuePath)?t.imageUrl:t.imageUrlValuePath.indexOf(".")>-1?e(i,t.imageUrlValuePath).toString():n.isNullOrUndefined(i[t.imageUrlValuePath])?t.imageUrl:i[t.imageUrlValuePath])),t}function kt(t,i,r,o,s,h,c,l){var p,k,lt,at,st,a,d,ht=[],g=[],rt=0,ft=0,vt=t.markerClusterSettings.labelStyle,ct=0,tt=[],et=t.markerClusterSettings,v=r.renderer.createGroup({id:r.element.id+"_LayerIndex_"+o+"_markerCluster"}),b={cancel:!1,name:ve,fill:et.fill,height:et.height,width:et.width,imageUrl:et.imageUrl,shape:et.shape,data:void 0,maps:r,cluster:et,border:et.border};r.trigger("markerClusterRendering",b,function(){for(var pt,kt,et,oi,si,hi,ni,bt,ri,yt=0;yt<i.childElementCount;yt++)if(tt=[],"hidden"!==i.childNodes[yt].style.visibility){if(d=i.childNodes[yt],p=d.getBoundingClientRect(),tt.push(yt),!n.isNullOrUndefined(p)){for(pt=yt+1;pt<i.childElementCount;pt++)"hidden"!==i.childNodes[pt].style.visibility&&(d=i.childNodes[pt],k=d.getBoundingClientRect(),n.isNullOrUndefined(k)||p.left>k.right||p.right<k.left||p.top>k.bottom||p.bottom<k.top||(ht.push(k),i.childNodes[pt].style.visibility="hidden",tt.push(pt)));if(rt=p.left+p.width/2,ft=p.top+p.height,ht.length>0){tt=tt.filter(function(n,t,i){return i.indexOf(n)===t});kt=r.element.getBoundingClientRect();rt-=kt.left;ft-=r.availableSize.height<=kt.height?kt.top:kt.bottom-kt.top;var ci=r.isTileMap?{}:ut(r,t,!1),ui=r.isTileMap?{x:0,y:0}:0!==r.translatePoint.x?r.translatePoint:ci.location,ti=parseInt(i.childNodes[yt].id.split("_dataIndex_")[1].split("_")[0],10),ii=parseInt(i.childNodes[yt].id.split("_MarkerIndex_")[1].split("_")[0],10),gt=t.markerSettings[ii],wt=gt.dataSource[ti],dt=void 0,fi=n.isNullOrUndefined(gt.longitudeValuePath)?n.isNullOrUndefined(wt.longitude)?n.isNullOrUndefined(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.longitude):Number(e(wt,gt.longitudeValuePath)),ei=n.isNullOrUndefined(gt.latitudeValuePath)?n.isNullOrUndefined(wt.latitude)?n.isNullOrUndefined(wt.Latitude)?0:parseFloat(wt.Latitude):parseFloat(wt.latitude):Number(e(wt,gt.latitudeValuePath));r.isTileMap?r.isTileMap&&!r.zoomSettings.enable&&(dt=it(new f(fi,ei),r.tileZoomLevel,r.tileTranslatePoint,!0)):dt=y(ei,fi,r.mapLayerPanel.calculateFactor(t),t,r);i.childNodes[yt].style.visibility="hidden";et=t.markerClusterSettings;b.cancel?((a={size:new w(et.width,et.height),fill:et.fill,borderColor:et.border.color,borderWidth:et.border.width,opacity:et.opacity,dashArray:et.dashArray}).fill=et.fill,a.size.width=et.width,a.size.height=et.height,a.imageUrl=et.imageUrl,a.shape=et.shape,a.borderColor=et.border.color,a.borderWidth=et.border.width,a.borderOpacity=n.isNullOrUndefined(et.border.opacity)?et.opacity:et.border.opacity):((a={size:new w(et.width,et.height),fill:et.fill,borderColor:et.border.color,borderWidth:et.border.width,opacity:et.opacity,dashArray:et.dashArray}).fill=b.fill,a.size.width=b.width,a.size.height=b.height,a.imageUrl=b.imageUrl,a.shape=b.shape,a.borderColor=b.border.color,a.borderWidth=b.border.width,a.borderOpacity=n.isNullOrUndefined(b.border.opacity)?et.opacity:b.border.opacity);rt=r.isTileMap||i.id.indexOf("_Markers_Group")>-1?rt:(dt.x+ui.x+b.width)*r.mapScaleValue;ft=r.isTileMap||i.id.indexOf("_Markers_Group")>-1?ft:(dt.y+ui.y+b.height/2)*r.mapScaleValue;r.isTileMap&&!r.zoomSettings.enable&&(rt=dt.x,ft=dt.y);oi=r.element.id+"_LayerIndex_"+o+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct;si=r.element.id+"_LayerIndex_"+o+"_MarkerIndex_"+ii+"_dataIndex_"+ti+"_cluster_"+ct+"_datalabel_"+ct;ct++;hi="Image"===a.shape?a.size.height/2:0;ni=fr(a.shape,a.imageUrl,{x:0,y:hi},oi,a,s,r);ni.setAttribute("transform","translate( "+rt+" "+ft+" )");"Balloon"===b.shape?ni.children[0].innerHTML=tt.toString():ni.innerHTML=tt.toString();lt=new nt(si,0,3.75,"middle",(ht.length+1).toString(),"","");(at=ot(lt,vt,vt.color,s)).setAttribute("transform","translate( "+rt+" "+ft+" )");v.appendChild(at);v.appendChild(ni)}}ht=[]}for(h.appendChild(v),r.svgObject.appendChild(h),r.element.appendChild(r.svgObject),yt=0;yt<v.childElementCount;yt++)if("hidden"!==v.childNodes[yt].style.visibility&&(d=v.childNodes[yt],p=d.getBoundingClientRect(),!(n.isNullOrUndefined(p)||d.id.indexOf("_datalabel_")>-1))){for(pt=yt+1;pt<v.childElementCount;pt++)"hidden"!==v.childNodes[pt].style.visibility&&(st=v.childNodes[pt],k=st.getBoundingClientRect(),n.isNullOrUndefined(k)||st.id.indexOf("_datalabel_")>-1||p.left>k.right||p.right<k.left||p.top>k.bottom||p.bottom<k.top||(g.push(st),g.push(v.childNodes[pt-1]),v.childNodes[pt].style.visibility="hidden",v.childNodes[pt-1].style.visibility="hidden",tt.push(pt)));if(g.length>0)for(d=v.childNodes[yt],bt=0;bt<g.length;bt++)"g"===d.tagName?d.childNodes[0].textContent=d.childNodes[0].textContent+","+g[bt].textContent:d.textContent=d.textContent+","+g[bt].textContent,v.childNodes[yt-1].textContent=(+v.childNodes[yt-1].textContent+ +g[bt+1].textContent).toString(),bt++;g=[]}for(;0<v.childNodes.length;)s.insertBefore(v.childNodes[0],s.firstChild);c||u(r.element.id+"_Secondary_Element").appendChild(s);h.appendChild(s);ri=document.getElementById(r.element.id+"_LayerIndex_0_markerCluster");n.isNullOrUndefined(ri)||ri.remove();l&&document.getElementById(r.element.id+"_Layer_Collections").appendChild(h)})}function er(n,t){var r=n[0].layerIndex,u=n[0].targetClusterIndex,f=n[0].markerIndex,c=n[0].dataIndex,e=t.element.id+"_LayerIndex_"+r+"_MarkerIndex_"+f,o=e+"_dataIndex_"+c+"_cluster_"+u,a=s(o),v=s(o+"_datalabel_"+u),h,i;for(a.setAttribute("visibility","visible"),v.setAttribute("visibility","visible"),h=n[0].data.length,i=0;i<h;i++)s(e+"_dataIndex_"+n[0].data[i].index).style.visibility="hidden";l(t.element.id+"_LayerIndex_"+r+"_MarkerIndex_"+f+"_markerClusterConnectorLine")}function or(n,t,i,r){var h=n[0].layerIndex,b=n[0].markerIndex,et=n[0].targetClusterIndex,it=n[0].dataIndex,c=r?s:i.querySelector.bind(i),k=r?"":"#",d=t.element.id+"_LayerIndex_"+h+"_MarkerIndex_"+b,ot=d+"_dataIndex_"+it+"_cluster_"+et,rt=c(k+""+ot),yt=c(k+""+ot+"_datalabel_"+et),e,o,w,vt,ft;rt.setAttribute("visibility","hidden");yt.setAttribute("visibility","hidden");var st=t.layers[h].markerSettings[b],u=c(k+""+d+"_dataIndex_"+it),l=u.parentElement.id.indexOf("Template_Group")>-1?u.getBoundingClientRect().height:st.height,a=u.parentElement.id.indexOf("Template_Group")>-1?u.getBoundingClientRect().width:st.width,ht=+rt.getAttribute("transform").split("translate(")[1].trim().split(" ")[0],ct=+rt.getAttribute("transform").split("translate(")[1].trim().split(" ")[1].split(")")[0].trim(),g=a+5,v=6.28*g,ut=0,f=Math.round(v/a);ut+=f;for(var nt=n[0].data.length,y=Math.round(l/v*100),lt=(y=nt<f?100/nt:y)/100*360,p=nt<f?45:0,pt=1,wt="M "+ht+" "+ct+" ",at="",tt=0;tt<nt;tt++){if(ut===tt||Math.round(p)>=360){for(p=0,v=6.28*(g=(a+5)*++pt),f=Math.round(v/l),y=Math.round(l/v*100);y*f<100;)f++;lt=y/100*360;ut+=f}e=ht+g*Math.sin(2*Math.PI*p/360);o=ct+g*Math.cos(2*Math.PI*p/360);at+=wt+"L "+e+" "+o+" ";(u=c(k+""+d+"_dataIndex_"+n[0].data[tt].index)).parentElement.id.indexOf("Template_Group")>-1?(u.style.transform="",u.style.left=t.isTileMap?e-a/2+"px":e-a/2-10+"px",u.style.top=t.isTileMap?o-l/2+"px":o-l/2-10+"px",u.setAttribute("transform","translate( "+e+" "+o+")")):u.setAttribute("transform","translate( "+e+" "+o+")");u.style.visibility="visible";p+=lt}w=t.layers[h].markerClusterSettings.connectorLineSettings;vt={d:at,id:t.element.id+"_LayerIndex_"+h+"_MarkerIndex_"+b+"_dataIndex_"+it+"_markerClusterConnectorLine",stroke:w.color,"fill-opacity":w.opacity,"stroke-opacity":w.opacity,"stroke-width":w.width};i=r?c(t.element.id+"_Markers_Group"):i;ft=t.renderer.createGroup({id:t.element.id+"_LayerIndex_"+h+"_MarkerIndex_"+b+"_markerClusterConnectorLine"});ft.appendChild(t.renderer.drawPath(vt));i.insertBefore(ft,i.querySelector("#"+d+"_dataIndex_0"))}function sr(t,i,r,u,e,o,s,h,c,l,a){var d={size:new w(t.width,t.height),fill:t.fill,borderColor:t.border.color,borderWidth:t.border.width,opacity:i.opacity,dashArray:i.dashArray,borderOpacity:n.isNullOrUndefined(t.border.opacity)?i.opacity:t.border.opacity},v=fr(t.shape,t.imageUrl,{x:0,y:0},s,d,a,l),y=(l.isTileMap?e.x:(e.x+o.x)*c)+h.x,p=(l.isTileMap?e.y:(e.y+o.y)*c)+h.y,b,k;return v.setAttribute("transform","translate( "+y+" "+p+" )"),dt(l.selectedMarkerElementId,l.markerSelectionClass,v,"MarkerselectionMapStyle"),a.appendChild(v),b=r.length-1===u?"marker":null,k=new f(y,p),i.animationDuration>0&&pr(v,i.animationDelay,i.animationDuration,k,l,b),a}function hr(t,i,r,f,e,o,s,h,c,l,a){var v,w,p,y;if((i=ti(t.template))&&i(f,a,t.template,a.element.id+"_MarkerTemplate"+e,!1).length){for(v=function(t,i,r,u,f){for(var s=n.createElement("div",{id:i,styles:"position: absolute;pointer-events: auto;"}),c=t.length;c>0;)s.appendChild(t[0]),c--;for(var h=s.innerHTML,o=Object.keys(r),e=0;e<o.length;e++)"object"==typeof r[o[e]]?h=ur(h,"",r,f):"latitude"!==o[e].toLowerCase()&&"longitude"!==o[e].toLowerCase()&&(h=h.replace(new RegExp("{{:"+o[e]+"}}","g"),r[o[e].toString()]));return s.innerHTML=h,s}(i(f,a,t.template,a.element.id+"_MarkerTemplate"+e,!1),r,f,0,a),w=0;w<v.children.length;w++)v.children[w].style.pointerEvents="none";(v.style.left=(a.isTileMap?s.x:(s.x+h.x)*c)+l.x-a.mapAreaRect.x+"px",v.style.top=(a.isTileMap?s.y:(s.y+h.y)*c)+l.y-a.mapAreaRect.y+"px",o.appendChild(v),"GoogleStaticMap"===a.layers[a.baseLayerIndex].layerType)&&(p=u(a.element.id+"_StaticGoogleMap").getBoundingClientRect(),y=v.getBoundingClientRect(),(p.x>y.x||p.x+640<y.x+y.width)&&(p.y>y.y||p.y+p.height<y.y+y.height)&&(v.style.display="none"))}return o}function dt(t,i,r,u){if(t)for(var f=0;f<t.length;f++)r.getAttribute("id")===t[f]&&((n.isNullOrUndefined(s(i.id))||0===f)&&(document.body.appendChild(i),r.id.indexOf("_MarkerIndex_")>-1&&r.childElementCount>0&&r.children[0].setAttribute("class",u)),r.setAttribute("class",u))}function gt(n,t){return t&&t.appendChild(n),n}function cr(n,t,i,r,u,f){var e,h=i.width,c=i.height,s;r.x-=h/2;r.y-=c;t.d="M15,0C8.8,0,3.8,5,3.8,11.2C3.8,17.5,9.4,24.4,15,30c5.6-5.6,11.2-12.5,11.2-18.8C26.2,5,21.2,0,15,0z M15,16c-2.8,0-5-2.2-5-5s2.2-5,5-5s5,2.2,5,5S17.8,16,15,16z";var o=n.renderer.drawPath(t),l=i.width/30,a=i.height/30;return(o.setAttribute("transform","translate("+r.x+", "+r.y+") scale("+l+", "+a+")"),"Marker"===u)?(s=n.renderer.createGroup({id:t.id}),gt(o,s),e=gt(s,f)):e=o,e}function st(t,i,r,u){var f,s,o;if(!n.isNullOrUndefined(i))for(f=0;f<t.length;f++)if(s=r.indexOf(".")>-1?e(t[f],r):t[f][r],o=ni(s,u,i),(!n.isNullOrUndefined(s)&&isNaN(i[o])?s.toLowerCase():s)===(!n.isNullOrUndefined(i[o])&&isNaN(i[o])?i[o].toLowerCase():i[o]))return f;return null}function ni(t,i,r){if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(r)&&!n.isNullOrUndefined(i))for(var f="[object Array]"===Object.prototype.toString.call(i)?i:[i],u=0;u<f.length;u++)if((n.isNullOrUndefined(t)?t:t.toLowerCase())===(!n.isNullOrUndefined(r[f[u]])&&isNaN(r[f[u]])?r[f[u]].toLowerCase():r[f[u]]))return f[u];return null}function yi(n,t,i){var r;if(!n.length)return null;for(var l,a,o,s,p=n.length,w=0,u=0,f=0,e=0;e<=p-1;e++)l=n[e].x,a="Mercator"===t||"Normal"===i?n[e].y:-n[e].y,e===p-1?(o=n[0].x,s="Mercator"===t||"Normal"===i?n[0].y:-n[0].y):(o=n[e+1].x,s="Mercator"===t||"Normal"===i?n[e+1].y:-n[e+1].y),w+=Math.abs(l*s-o*a),u+=Math.abs((l+o)*(l*s-o*a)),f+=Math.abs((a+s)*(l*s-o*a));u*=1/(4*(w*=.5));f*=1/(4*w);var b={x:0,y:0},v={x:0,y:0},k={x:0,y:0},y={x:0,y:0},d={x:0,y:0},h={x:0,y:0},g={x:0,y:0},c={x:0,y:0},nt=0;for(e=0;e<=p-1;e++)r=n[e],r.y="Mercator"===t||"Normal"===i?r.y:-r.y,r.y>f?r.x<u&&u-r.x<u-d.x?d={x:r.x,y:r.y}:r.x>u&&(0===h.x||r.x-u<h.x-u)&&(h={x:r.x,y:r.y}):r.x<u&&u-r.x<u-g.x?g={x:r.x,y:r.y}:r.x>u&&(0===c.x||r.x-u<c.x-u)&&(c={x:r.x,y:r.y}),nt=h.y-c.y+(h.y-c.y)/4,r.x>u?r.y<f&&f-r.y<f-b.y?b={x:r.x,y:r.y}:r.y>f&&(0===v.y||r.y-f<v.y-f)&&(v={x:r.x,y:r.y}):r.y<f&&f-r.y<f-k.y?k={x:r.x,y:r.y}:r.y>f&&(0===y.y||r.y-f<y.y-f)&&(y={x:r.x,y:r.y});return{x:u,y:f,rightMin:b,rightMax:v,leftMin:k,leftMax:y,points:n,topMax:c,topMin:g,bottomMax:h,bottomMin:d,height:nt}}function lr(t){var i=!1;return"[object Array]"===Object.prototype.toString.call(t)&&Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(t.geometry)||"Path"!==t.geometry.type||(i=!0)}),i}function d(n,t,i){var r=t,f=v(t,i).width,u;if(f>n)for(u=t.length-1;u>=0;--u)if((f=v(r=t.substring(0,u)+"...",i).width)<=n||r.length<4)return r.length<4&&(r=" "),r;return r}function l(t){var i=document.getElementById(t);return i?n.remove(i):null}function ar(n,t){var i=y(n.minLatOfGivenLocation,n.minLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),r=y(n.maxLatOfGivenLocation,n.maxLongOfGivenLocation,n.mapLayerPanel.calculateFactor(t),t,n),u=(i.x+r.x)/2,e=(i.y+r.y)/2;return new f(u,e)}function ut(t,i,r){var e,v=t.zoomSettings.zoomFactor,w=t.centerPosition,b=w.latitude,k=w.longitude,d=!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&t.zoomNotApplied,h,c,u,ft,ot,p,it,rt,st;n.isNullOrUndefined(t.mapScaleValue)&&(t.mapScaleValue=v);t.zoomSettings.shouldZoomInitially&&t.zoomSettings.enable&&(t.mapScaleValue=e=v=(t.zoomSettings.shouldZoomInitially||t.enablePersistence)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?1:t.markerZoomFactor,t.mapScaleValue===t.markerZoomFactor||t.enablePersistence||(t.mapScaleValue=v=t.markerZoomFactor),n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(b=t.markerCenterLatitude,k=t.markerCenterLongitude));d&&(t.mapScaleValue=e=v=t.scaleOfGivenLocation);var l=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.min,g=n.isNullOrUndefined(t.baseMapRectBounds)?null:t.baseMapRectBounds.max,ut=r?1:t.mapScaleValue;if(n.isNullOrUndefined(t.currentShapeDataLength)&&(t.currentShapeDataLength=n.isNullOrUndefined(i.shapeData.features)?i.shapeData.geometries.length:i.shapeData.features.length),u=t.totalRect&&t.legendSettings.visible?t.totalRect:t.mapAreaRect,ft=t.availableSize,!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(g)){var o=Math.abs(g.x-l.x),s=Math.abs(l.y-g.y),et=r?1:1===t.markerZoomFactor?t.mapScaleValue:v;if(w=t.zoomSettings.shouldZoomInitially&&t.markerZoomedState&&!t.zoomPersistence?t.markerZoomCenterPoint:t.centerPosition,(n.isNullOrUndefined(k)||n.isNullOrUndefined(b))&&!d)if(n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType)o*=e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)),s*=e,ot=0!==l.x&&"layers"===t.translateType?ft.width-u.width:0,h=u.x+(-l.x+(u.width/2-o/2))-ot,c=u.y+(-l.y+(u.height/2-s/2)),t.previousTranslate=new f(h,c);else if(t.zoomSettings.shouldZoomInitially||1!==t.markerZoomFactor||1!==t.mapScaleValue)if(e=t.mapScaleValue<1?t.mapScaleValue+1:t.mapScaleValue,t.mapScaleValue=t.zoomSettings.enable&&1!==t.mapScaleValue?t.mapScaleValue:1,t.currentShapeDataLength!==(n.isNullOrUndefined(i.shapeData.features)?i.shapeData.geometries.length:i.shapeData.features.length)&&"SubLayer"!==i.type)p=parseFloat(Math.min(u.height/s,u.width/o).toFixed(2)),s*=p,o*=p,c=u.y+(-l.y+(u.height/2-s/2)),e=p,h=u.x+(-l.x+(u.width/2-o/2));else if(t.availableSize.height!==t.heightBeforeRefresh||t.widthBeforeRefresh!==t.availableSize.width){it=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2));rt=o;rt*=it;st=s*it;var ht=u.x+(-l.x+(u.width/2-rt/2)),ct=u.y+(-l.y+(u.height/2-st/2)),lt=(t.translatePoint.x-t.previousTranslate.x)/t.widthBeforeRefresh,at=(t.translatePoint.y-t.previousTranslate.y)/t.heightBeforeRefresh;h=ht+lt*t.availableSize.width;c=ct+at*t.availableSize.height;t.previousTranslate=new f(ht,ct);t.zoomTranslatePoint.x=h;t.zoomTranslatePoint.y=c}else n.isNullOrUndefined(t.previousProjection)||1!==t.mapScaleValue||t.zoomModule.isDragZoom?(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y,e=t.scale):(o*=e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)),h=u.x+(-l.x+(u.width/2-o/2)),s*=e,c=u.y+(-l.y+(u.height/2-s/2)));else s*=e=parseFloat(Math.min(u.width/o,u.height/s).toFixed(2)),o*=e,c=u.y+(-l.y+(u.height/2-s/2)),h=u.x+(-l.x+(u.width/2-o/2));else{var nt=((o+Math.abs(t.mapAreaRect.width-o))/2+t.mapAreaRect.x)/et,tt=((s+Math.abs(t.mapAreaRect.height-s))/2+t.mapAreaRect.y)/et,a=d?ar(t,i):y(b,k,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.previousProjection)||t.previousProjection!==t.projectionType?(h=-a.x+nt,c=-a.y+tt,e=ut):(1!==Math.floor(t.scale)&&t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt):t.zoomSettings.shouldZoomInitially||t.zoomNotApplied?(h=-a.x+nt,c=-a.y+tt,e=ut):(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y),e=t.mapScaleValue)}n.isNullOrUndefined(t.translatePoint)||(h=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:h,c=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:c)}return e=t.enablePersistence?t.mapScaleValue>=1?t.mapScaleValue:1:e,t.widthBeforeRefresh=t.availableSize.width,t.heightBeforeRefresh=t.availableSize.height,{scale:e,location:new f(h,c)}}function at(t,i,r){var e,o=t.zoomSettings.zoomFactor,et=t.centerPosition,g=et.latitude,nt=et.longitude,tt=!n.isNullOrUndefined(t.centerLongOfGivenLocation)&&!n.isNullOrUndefined(t.centerLatOfGivenLocation)&&t.zoomNotApplied,v,w,ft,p,d,u;n.isNullOrUndefined(t.previousCenterLatitude)&&n.isNullOrUndefined(t.previousCenterLongitude)?(t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.previousCenterLatitude!==t.centerPosition.latitude&&t.previousCenterLongitude!==t.centerPosition.longitude?(t.centerPositionChanged=!0,t.previousCenterLatitude=t.centerPosition.latitude,t.previousCenterLongitude=t.centerPosition.longitude):t.centerPositionChanged=!1;(n.isNullOrUndefined(t.mapScaleValue)||o>t.mapScaleValue)&&(t.mapScaleValue=t.isReset&&1===t.mapScaleValue?t.mapScaleValue:o);t.mapScaleValue=1!==t.zoomSettings.zoomFactor&&t.zoomSettings.zoomFactor===t.mapScaleValue||t.zoomSettings.zoomFactor===t.mapScaleValue||t.centerPositionChanged?t.zoomSettings.zoomFactor:t.mapScaleValue;t.zoomSettings.shouldZoomInitially&&(t.mapScaleValue=o=e=(t.enablePersistence||t.zoomSettings.shouldZoomInitially)&&1===t.scale?t.scale:n.isNullOrUndefined(t.markerZoomFactor)?t.mapScaleValue:t.markerZoomFactor,o=t.mapScaleValue,n.isNullOrUndefined(t.markerCenterLatitude)||n.isNullOrUndefined(t.markerCenterLongitude)||(g=t.markerCenterLatitude,nt=t.markerCenterLongitude));tt&&(t.mapScaleValue=e=o=t.scaleOfGivenLocation);var h,c,it=r?1:t.mapScaleValue,s=t.mapAreaRect,b=t.baseMapRectBounds.min,ot=t.baseMapRectBounds.max,st=r?1:t.mapScaleValue,rt=Math.abs(ot.x-b.x),ut=Math.abs(b.y-ot.y);if((n.isNullOrUndefined(nt)||n.isNullOrUndefined(g))&&!tt){if(v=0===t.zoomSettings.zoomFactor?1:t.zoomSettings.zoomFactor,w=t.zoomSettings.maxZoom,e=v=v>w?w:v,ft=0===t.mapScaleValue?1:t.mapScaleValue>w?w:t.mapScaleValue,a=s.x+(-b.x+(s.width/2-rt/2)),l=s.y+(-b.y+(s.height/2-ut/2)),!n.isNullOrUndefined(t.zoomTranslatePoint)||!n.isNullOrUndefined(t.previousProjection))if(t.previousProjection!==t.projectionType){for(p=[],d={x:a,y:l},p.push(d),u=1;u<w;u++)d={x:p[u-1].x-(s.width/u-s.width/(u+1))/2,y:p[u-1].y-(s.height/u-s.height/(u+1))/2},p.push(d);a=p[v-1].x;l=p[v-1].y}else a=t.zoomTranslatePoint.x,l=t.zoomTranslatePoint.y,v!==ft&&(e=ft);n.isNullOrUndefined(t.translatePoint)||(h=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:a,c=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:l)}else{var l=(ut+Math.abs(t.mapAreaRect.height-ut))/2/st,a=(rt+Math.abs(t.mapAreaRect.width-rt))/2/st,k=tt?ar(t,i):y(g,nt,t.mapLayerPanel.calculateFactor(i),i,t);n.isNullOrUndefined(t.zoomTranslatePoint)&&n.isNullOrUndefined(t.previousProjection)||t.zoomNotApplied?(h=-k.x+a+t.mapAreaRect.x/it,c=-k.y+l+t.mapAreaRect.y/it):t.previousProjection!==t.projectionType?(h=-k.x+a,c=-k.y+l):(h=t.zoomTranslatePoint.x,c=t.zoomTranslatePoint.y,o=it);n.isNullOrUndefined(t.translatePoint)||(c=t.enablePersistence&&0!==t.translatePoint.y&&!t.zoomNotApplied?t.translatePoint.y:c,h=t.enablePersistence&&0!==t.translatePoint.x&&!t.zoomNotApplied?t.translatePoint.x:h);e=0!==o?o:1}return e=t.enablePersistence?0===t.mapScaleValue?1:t.mapScaleValue:e,{scale:r?1:e,location:new f(h,c)}}function u(n){return document.getElementById(n)}function vr(n,t){return n.formatFunction=n.intl.getNumberFormat({format:n.format,useGrouping:n.useGroupingSeparator}),n.formatFunction(t)}function ti(t){var i=null;try{document.querySelectorAll(t).length&&(i=n.compile(document.querySelector(t).innerHTML.trim()))}catch(r){i=n.compile(t)}return i}function s(n){return document.getElementById(n)}function ht(n){return document.getElementsByClassName(n)}function o(n,t){var i=null;return document.getElementById(t)&&(i=document.getElementById(t).querySelector("#"+n)),i}function yr(n,t,i,r){for(var f,e=r.layers[n].shapeData.features,u=0;u<e.length;u++)if(e[u].properties.name===t){f=r.element.id+"_LayerIndex_"+n+"_shapeIndex_"+u+"_dataIndex_undefined";break}return s(f)}function ii(t,i,r){return n.createElement("style",{id:t,innerHTML:"."+i+"{fill:"+r.fill+";fill-opacity:"+r.opacity.toString()+";stroke-opacity:"+r.border.opacity.toString()+";stroke-width:"+r.border.width.toString()+";stroke:"+r.border.color+";}"})}function vt(t,i,r){var u=s(t);n.isNullOrUndefined(u)||(u.innerHTML="."+i+"{fill:"+r.fill+";fill-opacity:"+r.opacity.toString()+";stroke-width:"+r.border.width.toString()+";stroke-opacity:"+r.border.opacity.toString()+";stroke:"+r.border.color+"}")}function af(t,i,r,u,f){var o={color:t.border.color,width:t.border.width/i.scale,opacity:t.border.opacity},e={opacity:t.opacity,fill:t.fill,border:o,name:uf,target:r.id,cancel:!1,shapeData:u,data:f,maps:i};i.trigger("itemSelection",e,function(){e.border.opacity=n.isNullOrUndefined(t.border.opacity)?t.opacity:t.border.opacity;i.shapeSelectionItem.push(e.shapeData);s("ShapeselectionMap")?vt("ShapeselectionMap","ShapeselectionMapStyle",e):document.body.appendChild(ii("ShapeselectionMap","ShapeselectionMapStyle",e))})}function a(n){n.removeAttribute("class")}function pr(t,i,r,u,f,e,o){void 0===o&&(o=0);var h=u.x,c=u.y,s=0,l=t.getAttribute("transform")||"";new n.Animation({}).animate(t,{duration:r,delay:i,progress:function(i){if(i.timeStamp>i.delay){if(f.isTileMap&&0===s){var r=document.querySelector(".GroupElement");n.isNullOrUndefined(r)||(r.style.display="block")}s=(i.timeStamp-i.delay)/i.duration;t.setAttribute("transform","translate( "+(h-o*s)+" "+(c-o*s)+" ) scale("+s+")")}},end:function(){if(t.setAttribute("transform",l),e){var n={cancel:!1,name:tf,element:e,maps:f};f.trigger(tf,n)}}})}function vf(n){l(n)}function pi(t,i,r,u,f,e,o,s,h){var b=hi(r,u,s),w;n.isNullOrUndefined(b)||(r=b.x,u=b.y);for(var l=document.getElementById(o),c=v(t,{fontFamily:"Segoe UI",size:"8px",fontStyle:"Normal",fontWeight:"Regular"}).width,a=t.split(" "),y=a[0].length,p=1;p<a.length;p++)y<a[p].length&&(y=a[p].length);l||(l=n.createElement("div",{id:o,styles:'background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(0, 0, 0); padding-left:5px;font-size:12px; font-family: "Segoe UI"; text-align:center'}));r<f-c||(r>f-c&&r<f-8*y?c=f-r:r>=f-8*y&&(r>c?r-=c:(c=r,r=0)));w=i.split("px");wr(l,t,r,u,w,c,f,s);l.clientHeight+2*parseInt(w[0],10)>e&&(c=r,r=0);wr(l,t,r,u,w,c,f,s);h&&setTimeout(vf,5e3,o)}function wr(n,t,i,r,u,f,e,o){n.innerHTML=t;n.style.top=-1!==n.id.indexOf("_Legend")?(parseInt(u[0],10)+r).toString()+"px":(2*parseInt(u[0],10)).toString()+"px";n.style.left=i.toString()+"px";n.style.width=f.toString()+"px";n.style.maxWidth=e.toString()+"px";n.style.wordWrap="break-word";o.appendChild(n)}function br(t,i,r,u){for(var e,f=0;f<t.childElementCount;f++)if((e=t.childNodes[f]).id.indexOf("_NavigationGroup")>-1)yf(e,i,r,u);else{var o=void 0,h=0,c=u.layersCollection[i].shapeSettings.borderWidthValuePath,s=u.layersCollection[i].shapeSettings.border.width;u.layersCollection[i].shapeSettings.borderWidthValuePath?null!==(h=st(u.layersCollection[i].dataSource,u.layersCollection[i].layerData[f].property,u.layersCollection[i].shapeDataPath,u.layersCollection[i].shapePropertyPath,u.layersCollection[i]))&&(o=u.layersCollection[i].dataSource[h][c]?u.layersCollection[i].dataSource[h][c]:n.isNullOrUndefined(s)?0:s):o=n.isNullOrUndefined(s)?0:s;e.setAttribute("stroke-width",(o/r).toString());t.id.indexOf("_LineString")>-1&&n.isNullOrUndefined(o)&&e.setAttribute("stroke-width",(1/r).toString())}}function yf(n,t,i,r){for(var f,e,u=0;u<n.childElementCount;u++)"path"===(f=n.childNodes[u]).tagName&&(e=r.layersCollection[t].navigationLineSettings[parseFloat(f.id.split("_NavigationIndex_")[1].split("_")[0])].width,f.setAttribute("stroke-width",(e/i).toString()))}function kr(n){for(var r=[],i=n.touches,t=0;t<i.length;t++)r.push({pageX:i[t].pageX,pageY:i[t].pageY});return r}function dr(n,t){var i=n.pageX-t.pageX,r=n.pageY-t.pageY;return Math.sqrt(i*i+r*r)}function gr(n,t){return n+t}function pf(n,t,i,r,u,f,e){var c=0,o=e.previousPoint,l=e.previousScale,v=u-l,s=new tt(0,0),h=1;if(u!==l){var a=function(n,t){return n.x===t.x?null:(t.y-n.y)/(t.x-n.x)}(o,r),y=function(n,t){return null===t?n.x:n.y-t*n.x}(o,a),p=r.x-o.x,w=r.y-o.y;nu(n,0,i,function(n){n.timeStamp>n.delay&&(c=(n.timeStamp-n.delay)/n.duration,h=l+c*v,s.x=o.x+c*p/(h/u),s.y=null==a?o.y+c*w:a*s.x+y,n.element.setAttribute("transform","scale( "+h+" ) translate( "+s.x+" "+s.y+" )"),e.translatePoint=s,e.scale=h,e.zoomModule.processTemplate(r.x,r.y,h,e))},function(){e.translatePoint=r;e.scale=u;n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )");e.zoomModule.processTemplate(r.x,r.y,u,e)})}else n.setAttribute("transform","scale( "+u+" ) translate( "+r.x+" "+r.y+" )")}function nu(n,t,i,r,u){var e,o=this,f=null,s=function(t){f||(f=t);var h=t-f;h<i?(r.call(o,{element:n,delay:0,timeStamp:h,duration:i}),window.requestAnimationFrame(s)):(window.cancelAnimationFrame(e),u.call(o,{element:n}),n.setAttribute("style","visibility:visible"))};e=window.requestAnimationFrame(s)}function bi(n,t,i,r){var o=0,u=n.getAttribute("transform").split(" ");2===u.length&&(u[2]=u[1].split(")")[0],u[1]=u[0].split("(")[1]);var f=new tt(parseInt(u[1],10),parseInt(u[2],10)),s=r.x-f.x,h=r.y-f.y,e=new tt(0,0);nu(n,0,i,function(n){n.timeStamp>n.delay&&(o=(n.timeStamp-n.delay)/n.duration,e.x=f.x+o*s,e.y=f.y+o*h,n.element.setAttribute("transform","translate( "+e.x+" "+e.y+" )"))},function(){n.setAttribute("transform","translate( "+r.x+" "+r.y+" )")})}function fu(t,i){var u=n.isNullOrUndefined(i.shouldZoomPreviousFactor)?null:i.shouldZoomPreviousFactor,r=n.isNullOrUndefined(i.shouldZoomCurrentFactor)?null:i.shouldZoomCurrentFactor;n.isNullOrUndefined(r)?!n.isNullOrUndefined(u)&&n.isNullOrUndefined(r)&&i.shouldZoomPreviousFactor!==t?i.shouldZoomCurrentFactor=t:i.shouldZoomPreviousFactor=t:(i.shouldZoomCurrentFactor=null,i.shouldZoomPreviousFactor=null)}function eu(n,t,i,r,u,f,e){var o,h,p=e.zoomSettings.maxZoom,c=Math.sin(t*Math.PI/180),w=Math.log((1+c)/(1-c))/2,b=Math.max(Math.min(w,Math.PI),-Math.PI)/2,l=Math.sin(n*Math.PI/180),k=Math.log((1+l)/(1-l))/2,d=Math.max(Math.min(k,Math.PI),-Math.PI)/2,a,v;e.zoomNotApplied&&!e.isTileMap&&(a=Math.abs((e.baseMapBounds.latitude.max-e.baseMapBounds.latitude.min)/(t-n)),v=Math.abs((e.baseMapBounds.longitude.max-e.baseMapBounds.longitude.min)/(r-i)),h=Math.min(a,v),y(n,i,1,e.layersCollection[0],e),y(t,r,1,e.layersCollection[0],e));var g=(b-d)/Math.PI,s=r-i,nt=(s<0?s+360:s)/360,tt=Math.log(f/256/g)/Math.LN2,it=Math.log(u/256/nt)/Math.LN2,rt=e.zoomNotApplied&&!e.isTileMap?h:Math.min(tt,it);return o=Math.min(rt,p),o=e.isTileMap||!e.zoomNotApplied?Math.floor(o):o,e.isTileMap||fu(o,e),o}function yt(t){var r,i=n.isNullOrUndefined(t.result)?t.actual:t.result;return n.isNullOrUndefined(i.length)?n.isNullOrUndefined(i.Items)||(r=i.Items):r=i,r}var oi,pt,si,w,ct,tu,iu,ru,uu,wi,ei,cf;oi=t(864);const n=ejdashboard.base,et=ejdashboard.svgbase;si=(pt=function(n,t){return pt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},pt(n,t)},function(n,t){function i(){this.constructor=n}pt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});w=function(){return function(n,t){this.width=n;this.height=t}}();var f=function(){return function(n,t){this.x=n;this.y=t}}(),rr=function(){return function(n,t){this.min=n;this.max=t}}(),li=function(){return function(n,t){this.latitude=new rr(n.min,n.max);this.longitude=new rr(t.min,t.max)}}();var nt=function(){return function(n,t,i,r,u,f,e){void 0===f&&(f="");this.transform="";this.baseLine="auto";this.id=n;this.text=u;this.transform=f;this.anchor=r;this.x=t;this.y=i;this.baseLine=e}}(),p=function(){return function(n,t,i,r,u,f,e,o){this.id=n;this["fill-opacity"]=u;this["stroke-opacity"]=f;this.fill=t;this.stroke=r;this["stroke-width"]=i;this["stroke-dasharray"]=e;this.d=o}}(),lf=function(){return function(n,t,i){this.r=n;this.g=t;this.b=i}}(),b=function(n){function t(t,i,r,u,f,e,o,s,h){var c=n.call(this,t,i,r.width,r.color,u,r.opacity)||this;return c.y=f.y,c.x=f.x,c.height=f.height,c.width=f.width,c.rx=e||0,c.ry=o||0,c.transform=s||"",c["stroke-dasharray"]=h,c["fill-opacity"]=u,c["stroke-opacity"]=r.opacity,c}return si(t,n),t}(p),bt=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,r.color,u,r.opacity,s)||this;return h.cy=e,h.cx=f,h.r=o,h["stroke-dasharray"]=s,h["fill-opacity"]=u,h["stroke-opacity"]=r.opacity,h}return si(t,n),t}(p),tt=function(){return function(n,t){this.x=n;this.y=t}}(),c=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}();wi=function(){return function(n,t,i,r,u){this.dataOptions=n;this.type=t||"GET";this.async=i||!0;this.contentType=r;this.sendData=u}}();!function(n){n.mapsTitleFont={size:"14px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:null,color:"#424242",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:null,fontStyle:"Regular",fontFamily:null};n.legendTitleFont={size:"12px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:null};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:null,fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(ct||(ct={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"SegoeUI, Helvetica Neue, Helvetica, Arial, sans-serif"}}(tu||(tu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Semibold",color:"#424242",fontStyle:"Semibold",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Regular",color:"#424242",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#757575",fontStyle:"Regular",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#757575",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Helvetica Neue, Helvetica, Arial, sans-serif"}}(iu||(iu={})),function(n){n.mapsTitleFont={size:"14px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.mapsSubTitleFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.tooltipLabelFont={size:"12px",fontWeight:"Regular",color:"#000000",fontStyle:"Regular",fontFamily:"Roboto"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontWeight:"Medium",color:"#FFFFFF",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"};n.dataLabelFont={size:"12px",fontWeight:"Medium",color:"#000000",fontStyle:"Medium",fontFamily:"Roboto, Noto, Sans-serif"}}(ru||(ru={})),function(n){n.mapsTitleFont={fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",size:"14px",fontStyle:"Medium",color:"#FFFFFF"};n.mapsSubTitleFont={size:"13px",color:"#FFFFFF",fontWeight:"Medium",fontFamily:"Roboto, Noto, Sans-serif",fontStyle:"Medium"};n.tooltipLabelFont={size:"12px",color:"#282727",fontWeight:"Regular",fontFamily:"Roboto",fontStyle:"Regular"};n.legendTitleFont={size:"14px",fontWeight:"Regular",color:"#FFFFFF",fontStyle:"Regular",fontFamily:"Roboto, Noto, Sans-serif"};n.legendLabelFont={size:"13px",fontFamily:"Roboto, Noto, Sans-serif",fontWeight:"Medium",color:"#DADADA",fontStyle:"Medium"}}(uu||(uu={}));var h=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},wf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"content",void 0),i([n.Property("0px")],r.prototype,"x",void 0),i([n.Property("0px")],r.prototype,"y",void 0),i([n.Property("None")],r.prototype,"verticalAlignment",void 0),i([n.Property("None")],r.prototype,"horizontalAlignment",void 0),i([n.Property("-1")],r.prototype,"zIndex",void 0),r}(n.ChildProperty),bf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("Start")],r.prototype,"position",void 0),i([n.Property("false")],r.prototype,"showArrow",void 0),i([n.Property(2)],r.prototype,"size",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"offSet",void 0),r}(n.ChildProperty),ft=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("12px")],r.prototype,"size",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property("Roboto, Noto, Sans-serif")],r.prototype,"fontFamily",void 0),i([n.Property("Medium")],r.prototype,"fontWeight",void 0),i([n.Property("Medium")],r.prototype,"fontStyle",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),k=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"opacity",void 0),r}(n.ChildProperty),kf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),ki=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("")],r.prototype,"template",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),i([n.Complex(ct.tooltipLabelFont,ft)],r.prototype,"textStyle",void 0),i([n.Property(null)],r.prototype,"format",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),r}(n.ChildProperty),df=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(10)],r.prototype,"left",void 0),i([n.Property(10)],r.prototype,"right",void 0),i([n.Property(10)],r.prototype,"top",void 0),i([n.Property(10)],r.prototype,"bottom",void 0),r}(n.ChildProperty),gf=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("#000000")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),ne=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"allowClustering",void 0),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),i([n.Property("#D2691E")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Rectangle")],r.prototype,"shape",void 0),i([n.Property(12)],r.prototype,"width",void 0),i([n.Property(12)],r.prototype,"height",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Complex({},ft)],r.prototype,"labelStyle",void 0),i([n.Property(!1)],r.prototype,"allowClusterExpand",void 0),i([n.Complex({},gf)],r.prototype,"connectorLineSettings",void 0),r}(n.ChildProperty),ou=(n.ChildProperty,function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"from",void 0),i([n.Property(null)],r.prototype,"to",void 0),i([n.Property(null)],r.prototype,"value",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"minOpacity",void 0),i([n.Property(null)],r.prototype,"maxOpacity",void 0),i([n.Property(null)],r.prototype,"label",void 0),i([n.Property(!0)],r.prototype,"showLegend",void 0),r}(n.ChildProperty)),te=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),r}(n.ChildProperty),ie=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"shapePath",void 0),i([n.Property(null)],r.prototype,"shapeValue",void 0),r}(n.ChildProperty),ri=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(!1)],r.prototype,"enableMultiSelect",void 0),i([n.Complex({color:"transparent",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),ui=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Complex({color:"transparent",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),re=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"longitude",void 0),i([n.Property(null)],r.prototype,"latitude",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property("black")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"angle",void 0),i([n.Complex({showArrow:!1,position:"Start",size:5,color:"black"},bf)],r.prototype,"arrowSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),ue=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({},k)],r.prototype,"border",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Property(10)],r.prototype,"minRadius",void 0),i([n.Property(20)],r.prototype,"maxRadius",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property("Circle")],r.prototype,"bubbleType",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Collection([],ou)],r.prototype,"colorMapping",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),r}(n.ChildProperty),di=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property("")],r.prototype,"text",void 0),i([n.Property("")],r.prototype,"description",void 0),r}(n.ChildProperty),fe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({size:ct.mapsSubTitleFont.size,fontWeight:null},ft)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),r}(di),ee=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({size:ct.mapsTitleFont.size,fontWeight:null},ft)],r.prototype,"textStyle",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Complex({},fe)],r.prototype,"subtitleSettings",void 0),r}(di),oe=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"enablePanning",void 0),i([n.Property(!0)],r.prototype,"enableSelectionZooming",void 0),i([n.Property("Horizontal")],r.prototype,"toolBarOrientation",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"highlightColor",void 0),i([n.Property(null)],r.prototype,"selectionColor",void 0),i([n.Property("Far")],r.prototype,"horizontalAlignment",void 0),i([n.Property("Near")],r.prototype,"verticalAlignment",void 0),i([n.Property(["ZoomIn","ZoomOut","Reset"])],r.prototype,"toolbars",void 0),i([n.Property(!0)],r.prototype,"mouseWheelZoom",void 0),i([n.Property(!1)],r.prototype,"doubleClickZoom",void 0),i([n.Property(!1)],r.prototype,"pinchZooming",void 0),i([n.Property(!1)],r.prototype,"zoomOnClick",void 0),i([n.Property(1)],r.prototype,"zoomFactor",void 0),i([n.Property(10)],r.prototype,"maxZoom",void 0),i([n.Property(1)],r.prototype,"minZoom",void 0),i([n.Property(!1)],r.prototype,"shouldZoomInitially",void 0),i([n.Property(!0)],r.prototype,"resetToInitial",void 0),r}(n.ChildProperty),su=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(!0)],r.prototype,"applyShapeSettings",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Complex({color:"",width:0},k)],r.prototype,"border",void 0),r}(n.ChildProperty),se=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"useMarkerShape",void 0),i([n.Property(!1)],r.prototype,"toggleVisibility",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("transparent")],r.prototype,"background",void 0),i([n.Property("Layers")],r.prototype,"type",void 0),i([n.Property(!1)],r.prototype,"invertedPointer",void 0),i([n.Property("After")],r.prototype,"labelPosition",void 0),i([n.Property("None")],r.prototype,"labelDisplayMode",void 0),i([n.Property("Circle")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"height",void 0),i([n.Complex({},ft)],r.prototype,"textStyle",void 0),i([n.Property(15)],r.prototype,"shapeWidth",void 0),i([n.Property(15)],r.prototype,"shapeHeight",void 0),i([n.Property(10)],r.prototype,"shapePadding",void 0),i([n.Complex({color:"#000000",width:0},k)],r.prototype,"border",void 0),i([n.Complex({color:"#000000",width:0},k)],r.prototype,"shapeBorder",void 0),i([n.Complex({},di)],r.prototype,"title",void 0),i([n.Complex(ct.legendTitleFont,ft)],r.prototype,"titleStyle",void 0),i([n.Property("Bottom")],r.prototype,"position",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Property("None")],r.prototype,"orientation",void 0),i([n.Property({x:0,y:0})],r.prototype,"location",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Default")],r.prototype,"mode",void 0),i([n.Property(null)],r.prototype,"showLegendPath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Property(!1)],r.prototype,"removeDuplicateLegend",void 0),i([n.Complex({},su)],r.prototype,"toggleLegendSettings",void 0),r}(n.ChildProperty),he=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Complex({width:0,color:"transparent"},k)],r.prototype,"border",void 0),i([n.Property("black")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(5)],r.prototype,"rx",void 0),i([n.Property(5)],r.prototype,"ry",void 0),i([n.Complex({},ft)],r.prototype,"textStyle",void 0),i([n.Property("")],r.prototype,"labelPath",void 0),i([n.Property("None")],r.prototype,"smartLabelMode",void 0),i([n.Property("None")],r.prototype,"intersectionAction",void 0),i([n.Property("")],r.prototype,"template",void 0),r}(n.ChildProperty),ce=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property([])],r.prototype,"palette",void 0),i([n.Property(5)],r.prototype,"circleRadius",void 0),i([n.Complex({width:null,color:"#000000"},k)],r.prototype,"border",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"borderColorValuePath",void 0),i([n.Property(null)],r.prototype,"borderWidthValuePath",void 0),i([n.Property(null)],r.prototype,"valuePath",void 0),i([n.Collection([],ou)],r.prototype,"colorMapping",void 0),i([n.Property(!1)],r.prototype,"autofill",void 0),r}(n.ChildProperty),hu=function(n){function t(t,i,r,u){return n.call(this,t,i,r,u)||this}return h(t,n),t}(function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),i([n.Property(null)],r.prototype,"dashArray",void 0),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("#FF471A")],r.prototype,"fill",void 0),i([n.Property(10)],r.prototype,"height",void 0),i([n.Property(10)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"colorValuePath",void 0),i([n.Property(null)],r.prototype,"shapeValuePath",void 0),i([n.Property(null)],r.prototype,"imageUrlValuePath",void 0),i([n.Property("Balloon")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"legendText",void 0),i([n.Property(new f(0,0))],r.prototype,"offset",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property(null)],r.prototype,"template",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Property(1e3)],r.prototype,"animationDuration",void 0),i([n.Property(0)],r.prototype,"animationDelay",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),i([n.Property(null)],r.prototype,"latitudeValuePath",void 0),i([n.Property(null)],r.prototype,"longitudeValuePath",void 0),i([n.Collection([],te)],r.prototype,"initialMarkerSelection",void 0),r}(n.ChildProperty)),cu=function(t){function r(){var n=null!==t&&t.apply(this,arguments)||this;return n.isBaseLayer=!1,n}return h(r,t),i([n.Property(null)],r.prototype,"shapeData",void 0),i([n.Property()],r.prototype,"query",void 0),i([n.Complex({},ce)],r.prototype,"shapeSettings",void 0),i([n.Property([])],r.prototype,"dataSource",void 0),i([n.Property("Layer")],r.prototype,"type",void 0),i([n.Property("Geographic")],r.prototype,"geometryType",void 0),i([n.Property("Aerial")],r.prototype,"bingMapType",void 0),i([n.Property("RoadMap")],r.prototype,"staticMapType",void 0),i([n.Property("")],r.prototype,"key",void 0),i([n.Property("Geometry")],r.prototype,"layerType",void 0),i([n.Property("https://a.tile.openstreetmap.org/level/tileX/tileY.png")],r.prototype,"urlTemplate",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("name")],r.prototype,"shapeDataPath",void 0),i([n.Property("name")],r.prototype,"shapePropertyPath",void 0),i([n.Property(0)],r.prototype,"animationDuration",void 0),i([n.Collection([],hu)],r.prototype,"markerSettings",void 0),i([n.Complex({},ne)],r.prototype,"markerClusterSettings",void 0),i([n.Complex({},he)],r.prototype,"dataLabelSettings",void 0),i([n.Collection([],ue)],r.prototype,"bubbleSettings",void 0),i([n.Collection([],re)],r.prototype,"navigationLineSettings",void 0),i([n.Complex({},ki)],r.prototype,"tooltipSettings",void 0),i([n.Complex({},ri)],r.prototype,"selectionSettings",void 0),i([n.Complex({},ui)],r.prototype,"highlightSettings",void 0),i([n.Complex({},su)],r.prototype,"toggleLegendSettings",void 0),i([n.Collection([],ie)],r.prototype,"initialShapeSelection",void 0),r}(n.ChildProperty),le=function(){return function(n,t,i,r,u,f,e){void 0===i&&(i=256);void 0===r&&(r=256);void 0===u&&(u=0);void 0===f&&(f=0);void 0===e&&(e=null);this.x=n;this.y=t;this.top=u;this.left=f;this.height=i;this.width=r;this.src=e}}(),ae=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return h(r,t),i([n.Property(null)],r.prototype,"background",void 0),i([n.Complex({color:"transparent",width:1},k)],r.prototype,"border",void 0),r}(n.ChildProperty),lu=function(){function t(n){this.maps=n;this.trackElements=[];this.sameMarkerData=[]}return t.prototype.markerRender=function(t,i,r,f){var o=this,c=0,l=0,a=0,s,h;this.maps.translateType="marker";s=this.maps.layersCollection[i];this.markerSVGObject=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement",style:"pointer-events: auto;"});h=n.createElement("div",{id:this.maps.element.id+"_LayerIndex_"+i+"_Markers_Template_Group",className:this.maps.element.id+"_template",styles:"overflow: hidden; position: absolute;pointer-events: none;top:"+this.maps.mapAreaRect.y+"px;left:"+this.maps.mapAreaRect.x+"px;height:"+this.maps.mapAreaRect.height+"px;width:"+this.maps.mapAreaRect.width+"px;"});s.markerSettings.map(function(v,p){var w=v.dataSource;Array.prototype.forEach.call(w,function(b,k){o.maps.markerNullCount=p>0&&0===k?0:o.maps.markerNullCount;var d={cancel:!1,name:yu,fill:v.fill,height:v.height,width:v.width,imageUrl:v.imageUrl,shape:v.shape,template:v.template,data:b,maps:o.maps,marker:v,border:v.border,colorValuePath:v.colorValuePath,shapeValuePath:v.shapeValuePath,imageUrlValuePath:v.imageUrlValuePath};o.maps.trigger("markerRendering",d,function(){var lt;d=vi(d=ai(d,b),b);var nt=n.isNullOrUndefined(v.longitudeValuePath)?n.isNullOrUndefined(b.longitude)?n.isNullOrUndefined(b.Longitude)?0:parseFloat(b.Longitude):parseFloat(b.longitude):Number(e(b,v.longitudeValuePath)),rt=n.isNullOrUndefined(v.latitudeValuePath)?n.isNullOrUndefined(b.latitude)?n.isNullOrUndefined(b.Latitude)?0:parseFloat(b.Latitude):parseFloat(b.latitude):Number(e(b,v.latitudeValuePath)),ft=v.offset;if(!d.cancel&&v.visible&&!n.isNullOrUndefined(nt)&&!n.isNullOrUndefined(rt)){var et=o.maps.element.id+"_LayerIndex_"+i+"_MarkerIndex_"+p+"_dataIndex_"+k,g=o.maps.isTileMap?it(new tt(nt,rt),r,o.maps.tileTranslatePoint,!0):y(rt,nt,r,s,o.maps),ot=0!==s.animationDuration||n.isNullOrUndefined(o.maps.zoomModule),st=o.maps.isTileMap?"SubLayer"===s.type&&n.isNullOrUndefined(o.maps.zoomModule)?g=it(new tt(nt,rt),o.maps.tileZoomLevel,o.maps.tileTranslatePoint,!0):{}:!n.isNullOrUndefined(o.maps.zoomModule)&&o.maps.zoomSettings.zoomFactor>1?at(o.maps,s,ot):ut(o.maps,s,ot),ht="AddMarker"===f?o.maps.scale:st.scale,ct="AddMarker"===f?o.maps.translatePoint:st.location;!d.template||isNaN(g.x)||isNaN(g.y)?d.template||isNaN(g.x)||isNaN(g.y)||(c++,sr(d,v,w,k,g,ct,et,ft,ht,o.maps,o.markerSVGObject)):(a++,hr(d,void 0,et,b,p,h,g,ct,ht,ft,o.maps),o.maps.renderReactTemplates())}l+=isNaN(rt)||isNaN(nt)?1:0;a+=d.cancel?1:0;c+=d.cancel?1:0;o.maps.markerNullCount=n.isNullOrUndefined(nt)||n.isNullOrUndefined(rt)?o.maps.markerNullCount+1:o.maps.markerNullCount;lt=w.length-o.maps.markerNullCount;o.markerSVGObject.childElementCount===lt-a-l&&"Template"!==f&&(t.appendChild(o.markerSVGObject),s.markerClusterSettings.allowClustering&&(o.maps.svgObject.appendChild(o.markerSVGObject),o.maps.element.appendChild(o.maps.svgObject),"OSM"===s.layerType&&o.maps.zoomSettings.enable?t.appendChild(o.markerSVGObject):kt(s,o.markerSVGObject,o.maps,i,o.markerSVGObject,t,!0,!1),o.maps.renderReactTemplates()));h.childElementCount===w.length-c-l&&u(o.maps.element.id+"_Secondary_Element")&&(u(o.maps.element.id+"_Secondary_Element").appendChild(h),o.maps.checkInitialRender&&s.markerClusterSettings.allowClustering&&(kt(s,h,o.maps,i,o.markerSVGObject,t,!1,!1),o.maps.renderReactTemplates()))})})})},t.prototype.calculateIndividualLayerMarkerZoomLevel=function(n,t,i){var r,u,o=Math.abs(this.maps.baseMapBounds.latitude.max-this.maps.baseMapBounds.latitude.min),s=Math.abs(this.maps.baseMapBounds.longitude.max-this.maps.baseMapBounds.longitude.min),e,f;return r=(r=Math.floor(Math.log(t/o)))>i?i:r,u=(u=Math.floor(Math.log(n/s)))>i?i:u,e=Math.min(r,u),f=Math.min(e,i-1),this.maps.isTileMap||fu(f,this.maps),f},t.prototype.calculateZoomCenterPositionAndFactor=function(t){var o;if(this.maps.zoomSettings.shouldZoomInitially&&this.maps.markerModule){var r,u,f,e,i=void 0,s=void 0,h=void 0,a=this.maps.zoomSettings.maxZoom,c=this.maps.mapAreaRect.width,l=this.maps.mapAreaRect.height;(this.maps.markerZoomedState=this.maps.markerZoomedState?this.maps.markerZoomedState:n.isNullOrUndefined(this.maps.markerZoomFactor)?!this.maps.markerZoomedState:this.maps.markerZoomFactor>1?this.maps.markerZoomedState:!this.maps.markerZoomedState,this.maps.defaultState=this.maps.markerZoomedState?!this.maps.markerZoomedState:this.maps.defaultState,Array.prototype.forEach.call(t,function(t){0!==t.markerSettings.length&&Array.prototype.forEach.call(t.markerSettings,function(t){var i=t.dataSource;Array.prototype.forEach.call(i,function(t,i){var o=n.isNullOrUndefined(t.latitude)?n.isNullOrUndefined(t.Latitude)?null:parseFloat(t.Latitude):parseFloat(t.latitude),s=n.isNullOrUndefined(t.longitude)?n.isNullOrUndefined(t.Longitude)?null:parseFloat(t.Longitude):parseFloat(t.longitude);r=n.isNullOrUndefined(r)&&0===i?s:r;u=n.isNullOrUndefined(u)&&0===i?o:u;f=n.isNullOrUndefined(f)&&0===i?o:f;e=n.isNullOrUndefined(e)&&0===i?s:e;r>s&&(r=s);f>o&&(f=o);e<s&&(e=s);u<o&&(u=o)})})}),n.isNullOrUndefined(f)||n.isNullOrUndefined(r)||n.isNullOrUndefined(e)||n.isNullOrUndefined(u))||(s=(f+u)/2,h=(r+e)/2,this.maps.markerCenterLatitude=s,this.maps.markerCenterLongitude=h,(n.isNullOrUndefined(this.maps.markerZoomCenterPoint)||this.maps.markerZoomedState)&&(this.maps.markerZoomCenterPoint={latitude:s,longitude:h}),o=void 0,this.maps.isTileMap||0===this.maps.baseMapRectBounds.min.x?(i=eu(f,u,r,e,c,l,this.maps),this.maps.isTileMap?o=n.isNullOrUndefined(this.maps.markerZoomFactor)||n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue>1&&1!==this.maps.markerZoomFactor?this.maps.mapScaleValue:i:(o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:1!==Math.floor(this.maps.scale)&&this.maps.mapScaleValue!==i&&n.isNullOrUndefined(this.maps.shouldZoomCurrentFactor)?this.maps.mapScaleValue:i)!==this.maps.mapScaleValue||1!==this.maps.markerZoomFactor&&1!==this.maps.mapScaleValue||this.maps.enablePersistence||(o=i)):(i=this.calculateIndividualLayerMarkerZoomLevel(c,l,a),o=n.isNullOrUndefined(this.maps.mapScaleValue)?i:this.maps.mapScaleValue!==i?this.maps.mapScaleValue:i),this.maps.markerZoomFactor=o)}else this.maps.markerZoomedState=!1,this.maps.markerZoomFactor>1&&(this.maps.markerCenterLatitude=null,this.maps.markerCenterLongitude=null,this.maps.markerZoomFactor=1,this.maps.enablePersistence||(this.maps.mapScaleValue=1)),this.maps.isTileMap&&!this.maps.enablePersistence&&this.maps.mapScaleValue<=1&&(this.maps.tileZoomLevel=0===this.maps.mapScaleValue?1:this.maps.mapScaleValue,1===this.maps.mapScaleValue&&1===this.maps.markerZoomFactor&&(this.maps.tileTranslatePoint.x=0,this.maps.tileTranslatePoint.y=0))},t.prototype.markerClick=function(t){var r=t.target.id,i,u;-1===r.indexOf("_LayerIndex_")||r.indexOf("_cluster_")>0||(i=this.getMarker(r),n.isNullOrUndefined(i)||(u={cancel:!1,name:pu,data:i.data,maps:this.maps,marker:i.marker,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,value:i.data.name},this.maps.trigger(pu,u)))},t.prototype.markerClusterClick=function(t){var r=t.target.id,i,u;-1!==r.indexOf("_LayerIndex_")&&-1!==r.indexOf("_cluster_")&&(i=this.getMarker(r),n.isNullOrUndefined(i)||(i.clusterCollection.length>0&&this.maps.markerClusterExpand&&(s(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&l(this.maps.element.id+"_mapsTooltip"),this.sameMarkerData.length>0&&!this.maps.markerClusterExpandCheck?(this.maps.markerClusterExpandCheck=!0,er(this.sameMarkerData,this.maps,this.markerSVGObject)):(this.sameMarkerData=i.clusterCollection,this.maps.markerClusterExpandCheck=!1,or(this.sameMarkerData,this.maps,this.markerSVGObject,!0))),u={cancel:!1,name:wu,data:i,maps:this.maps,target:r,x:t.clientX,y:t.clientY,latitude:i.data.latitude||i.data.Latitude,longitude:i.data.longitude||i.data.Longitude,markerClusterCollection:i.markCollection},this.maps.trigger(wu,u)))},t.prototype.getMarker=function(n){var i,t,o=n.split("_LayerIndex_"),s=parseInt(o[1].split("_")[0],10),l=this.maps.layers[s],a=[],v=[],u,h,r,y,f,c,e;if((this.maps.markerClusterExpand=l.markerClusterSettings.allowClusterExpand,n.indexOf("_MarkerIndex_")>-1)&&(u=parseInt(o[1].split("_MarkerIndex_")[1].split("_")[0],10),h=parseInt(o[1].split("_dataIndex_")[1].split("_")[0],10),t=l.markerSettings[u],!isNaN(u))){if(i=t.dataSource[h],r=[],!t.template&&n.indexOf("_cluster_")>-1&&this.maps.layers[s].markerClusterSettings.allowClusterExpand&&Array.prototype.forEach.call(t.dataSource,function(n,t){n.latitude===i.latitude&&n.longitude===i.longitude&&r.push({data:i,index:t})}),n.indexOf("_cluster_")>-1){for(y=document.getElementById(n.indexOf("_datalabel_")>-1?n.split("_datalabel_")[0]:n).innerHTML.split(",").map(Number),r=[],f=0,c=y;f<c.length;f++)e=c[f],r.push({data:t.dataSource[e],index:e}),a.push(t.dataSource[e]);v.push({data:r,layerIndex:s,markerIndex:u,dataIndex:h,targetClusterIndex:+(n.split("_cluster_")[1].indexOf("_datalabel_")>-1?n.split("_cluster_")[1].split("_datalabel_")[0]:n.split("_cluster_")[1]),isClusterSame:!1})}return{marker:t,data:i,clusterCollection:v,markCollection:a}}return null},t.prototype.markerMove=function(t){var i=t.target.id,r,u;-1===i.indexOf("_LayerIndex_")||i.indexOf("_cluster_")>0||(r=this.getMarker(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:bu,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(bu,u)))},t.prototype.markerClusterMouseMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&-1!==i.indexOf("_cluster_")&&(r=this.getMarker(i),(this.maps.markerClusterExpand&&t.target.setAttribute("style","cursor: pointer"),n.isNullOrUndefined(r))||(u={cancel:!1,name:ku,data:r.data,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(ku,u)))},t.prototype.getModuleName=function(){return"Marker"},t.prototype.destroy=function(){},t}(),rt="click",au="resize",vu="tooltipRender",yu="markerRendering",ve="markerClusterRendering",pu="markerClick",wu="markerClusterClick",bu="markerMouseMove",ku="markerClusterMouseMove",du="bubbleRendering",gu="bubbleClick",nf="bubbleMouseMove",tf="animationComplete",rf="annotationRendering",uf="itemSelection",ff="itemHighlight",fi="pan",ef=function(){function n(n){this.maps=n}return n.prototype.getBingMap=function(n,t,i,r,u,f){for(var s,h,c,e="",o=Math.min(this.maps.tileZoomLevel,parseInt(this.maxZoom,10));o>0;o--)s=0,h=1<<o-1,n.x&h&&s++,n.y&h&&(s+=2),e=e+""+s;return c=f[Math.min(parseInt(e.substr(e.length-1,1),10),f.length)],(u=u.replace("{quadkey}",e).replace("{subdomain}",c))+"&mkt="+r+"&ur=IN&Key="+t},n}(),of=function(){function t(n){this.maps=n}return t.prototype.getShapeColorMapping=function(t,i,r){var u=t.colorValuePath?t.colorValuePath:t.valuePath,f=n.isNullOrUndefined(u)?i[u]:u.indexOf(".")>-1?e(i,u):i[u],s=Number(f),o=this.getColorByValue(t.colorMapping,s,f);return n.isNullOrUndefined(o)?r:o},t.prototype.getColorByValue=function(t,i,r){var u;if(isNaN(i)&&n.isNullOrUndefined(r))return null;for(var o,f="",e=0,s=t;e<s.length;e++)u=s[e],(!n.isNullOrUndefined(u.from)&&!n.isNullOrUndefined(u.to)&&i>=u.from&&i<=u.to||u.value===r)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?n.isNullOrUndefined(u.value)?this.getColor(u,i):u.color[0]:u.color),(i>=u.from&&i<=u.to||u.value===r)&&!n.isNullOrUndefined(u.minOpacity)&&!n.isNullOrUndefined(u.maxOpacity)&&f&&(o=this.deSaturationColor(u,f,i,r)),(""===f||n.isNullOrUndefined(f))&&n.isNullOrUndefined(u.from)&&n.isNullOrUndefined(u.to)&&n.isNullOrUndefined(u.minOpacity)&&n.isNullOrUndefined(u.maxOpacity)&&n.isNullOrUndefined(u.value)&&(f="[object Array]"===Object.prototype.toString.call(u.color)?u.color[0]:u.color);return{fill:f||(t.length?null:r),opacity:o}},t.prototype.deSaturationColor=function(n,t,i,r){var u=1;return(i>=n.from&&i<=n.to||n.value===r)&&(u=(isNaN(i)?n.from/(n.to-n.from):(i-n.from)/(n.to-n.from))*(n.maxOpacity-n.minOpacity)+n.minOpacity),u},t.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},t.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},t.prototype.getColor=function(n,t){var i,r="";return Number(t)===n.from?r=n.color[0]:Number(t)===n.to?r=n.color[n.color.length-1]:(i=this.getGradientColor(Number(t),n),r=this.rgbToHex(i.r,i.g,i.b)),r},t.prototype.getGradientColor=function(n,t){var f,e,s=t.from,c=t.to,o=0,l=c-s,i;if(o=(n-s)/l,t.color.length<=2)f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]),e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);else{f="#"===t.color[0].charAt(0)?t.color[0]:this._colorNameToHex(t.color[0]);e="#"===t.color[t.color.length-1].charAt(0)?t.color[t.color.length-1]:this._colorNameToHex(t.color[t.color.length-1]);for(var u=l/(t.color.length-1),v=t.color.length-1,r=[],a={},h=1;h<v;h++)a={b:s+h*u,color:t.color[h]},r.push(a);for(i=0;i<r.length;i++)s<=n&&n<=r[i].b&&0===i?(e="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u):r[i].b<=n&&n<=c&&i===r.length-1&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),o=n<r[i].b?1-Math.abs((n-r[i].b)/u):(n-r[i].b)/u),i!==r.length-1&&i<r.length&&r[i].b<=n&&n<=r[i+1].b&&(f="#"===r[i].color.charAt(0)?r[i].color:this._colorNameToHex(r[i].color),e="#"===r[i+1].color.charAt(0)?r[i+1].color:this._colorNameToHex(r[i+1].color),o=Math.abs(n-r[i+1].b)/u)}return this.getPercentageColor(o,f,e)},t.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new lf(f,e,o)},t.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},t.prototype._colorNameToHex=function(n){var t={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c","indigo ":"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",orchid:"#da70d6",papayawhip:"#ffefd5",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};return"[object Array]"===Object.prototype.toString.call(n)?n:void 0!==t[n.toLowerCase()]?t[n.toLowerCase()]:n},t}(),ye=function(){function t(t){this.isMapCoordinates=!0;this.horizontalPan=!1;this.horizontalPanXCount=0;this.mapObject=t;this.ajaxModule=new n.Ajax;this.ajaxResponse=[]}return t.prototype.measureLayerPanel=function(){var r=this,e=this.mapObject.layersCollection,t=this.mapObject.mapAreaRect,f=u(this.mapObject.element.id+"_Secondary_Element"),i;this.mapObject.isTileMap&&f&&(this.tileSvgObject=this.mapObject.renderer.createSvg({id:this.mapObject.element.id+"_Tile_SVG",width:t.width,height:t.height}),i=n.createElement("div",{id:this.mapObject.element.id+"_Tile_SVG_Parent",styles:"position: absolute; height: "+t.height+"px; width: "+t.width+"px;"}),i.appendChild(this.tileSvgObject),f.appendChild(i));this.layerGroup=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_Layer_Collections","clip-path":"url(#"+this.mapObject.element.id+"_MapArea_ClipRect)"});this.clipRectElement="GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?this.mapObject.renderer.drawClipPath(new b(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:(t.width-640)/2,y:0,width:640,height:t.height})):this.mapObject.renderer.drawClipPath(new b(this.mapObject.element.id+"_MapArea_ClipRect","transparent",{width:1,color:"Gray"},1,{x:this.mapObject.isTileMap?0:t.x,y:this.mapObject.isTileMap?0:t.y,width:t.width,height:t.height<0?0:!n.isNullOrUndefined(this.mapObject.legendModule)&&this.mapObject.legendModule.totalPages.length>0?this.mapObject.legendModule.legendTotalRect.height:t.height}));this.layerGroup.appendChild(this.clipRectElement);this.mapObject.baseMapBounds=null;this.mapObject.baseMapRectBounds=null;this.mapObject.baseSize=null;Array.prototype.forEach.call(e,function(n,t){r.currentLayer=n;r.processLayers(n,t)})},t.prototype.renderTileLayer=function(t,i,r,u){var s,o,e,c,l,h;t.currentFactor=t.calculateFactor(i);t.mapObject.defaultState=!(1!==t.mapObject.zoomSettings.zoomFactor&&!n.isNullOrUndefined(t.mapObject.tileZoomLevel)&&1!==t.mapObject.tileZoomLevel);n.isNullOrUndefined(t.mapObject.previousCenterLatitude)&&n.isNullOrUndefined(t.mapObject.previousCenterLongitude)?(t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.previousCenterLatitude!==t.mapObject.centerPosition.latitude&&t.mapObject.previousCenterLongitude!==t.mapObject.centerPosition.longitude?(t.mapObject.centerPositionChanged=!0,t.mapObject.previousCenterLatitude=t.mapObject.centerPosition.latitude,t.mapObject.previousCenterLongitude=t.mapObject.centerPosition.longitude):t.mapObject.centerPositionChanged=!1;s=new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude);o=s;this.mapObject.isTileMap&&t.mapObject.markerModule&&t.mapObject.zoomSettings.enable&&(t.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection),n.isNullOrUndefined(this.mapObject.markerCenterLatitude)||n.isNullOrUndefined(this.mapObject.markerCenterLongitude)||(o=new f(t.mapObject.markerCenterLongitude,t.mapObject.markerCenterLatitude)));s=!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.centerPosition.longitude&&t.mapObject.centerPosition.latitude&&!t.mapObject.zoomPersistence&&t.mapObject.defaultState?new f(t.mapObject.centerPosition.longitude,t.mapObject.centerPosition.latitude):t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.markerZoomedState&&!t.mapObject.zoomPersistence&&!n.isNullOrUndefined(t.mapObject.markerZoomCenterPoint)?new f(t.mapObject.markerZoomCenterPoint.longitude,t.mapObject.markerZoomCenterPoint.latitude):{x:null,y:null};e=t.mapObject.zoomSettings.shouldZoomInitially?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?1:t.mapObject.markerZoomFactor:t.mapObject.zoomSettings.zoomFactor;(e=t.mapObject.enablePersistence?n.isNullOrUndefined(t.mapObject.mapScaleValue)?n.isNullOrUndefined(t.mapObject.markerZoomFactor)?t.mapObject.zoomSettings.zoomFactor:t.mapObject.markerZoomFactor:t.mapObject.mapScaleValue:e,e=(e=t.mapObject.zoomSettings.enable?e:t.mapObject.zoomSettings.zoomFactor)>0?e:1,t.mapObject.defaultState=1===e,!t.mapObject.markerZoomedState&&t.mapObject.zoomSettings.shouldZoomInitially&&1===t.mapObject.zoomSettings.zoomFactor&&(t.mapObject.defaultState=!0),n.isNullOrUndefined(t.mapObject.tileZoomLevel))?(t.mapObject.tileZoomLevel=e,t.mapObject.previousZoomFactor=e):this.mapObject.isReset&&1===t.mapObject.tileZoomLevel&&!t.mapObject.zoomSettings.shouldZoomInitially?(c=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=c):1!==t.mapObject.zoomSettings.zoomFactor||t.mapObject.zoomSettings.shouldZoomInitially?(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=t.mapObject.defaultState&&t.mapObject.zoomSettings.enable?t.mapObject.tileZoomLevel:t.mapObject.zoomSettings.shouldZoomInitially||t.mapObject.centerPositionChanged?e:t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor?t.mapObject.zoomSettings.zoomFactor:t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=1===e&&0===t.mapObject.zoomSettings.zoomFactor?e:t.mapObject.tileZoomLevel,!n.isNullOrUndefined(t.mapObject.tileTranslatePoint)&&(t.mapObject.markerZoomFactor!==t.mapObject.mapScaleValue||n.isNullOrUndefined(t.mapObject.markerZoomFactor)&&n.isNullOrUndefined(t.mapObject.mapScaleValue))&&(t.mapObject.zoomSettings.zoomFactor<=1||t.mapObject.previousZoomFactor!==t.mapObject.zoomSettings.zoomFactor)&&(t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0)):t.mapObject.defaultState&&(t.mapObject.previousZoomFactor=t.mapObject.tileZoomLevel,t.mapObject.tileZoomLevel=e,t.mapObject.tileTranslatePoint.x=0,t.mapObject.tileTranslatePoint.y=0);(e<=1&&!n.isNullOrUndefined(t.mapObject.height)&&!t.mapObject.zoomSettings.shouldZoomInitially&&t.mapObject.tileZoomLevel===t.mapObject.tileZoomScale&&this.mapObject.initialCheck&&function(n){n.tileZoomScale=n.tileZoomLevel=Math.floor(n.availableSize.height/512)+1;var i="GoogleStaticMap"!==n.layers[n.baseLayerIndex].layerType?20:0,t=256*Math.pow(2,n.tileZoomLevel);n.tileTranslatePoint.x=n.availableSize.width/2-t/2;n.tileTranslatePoint.y=n.availableSize.height/2-t/2+i;n.previousTileWidth=n.availableSize.width;n.previousTileHeight=n.availableSize.height}(this.mapObject),n.isNullOrUndefined(t.mapObject.centerLatOfGivenLocation)||n.isNullOrUndefined(t.mapObject.centerLongOfGivenLocation)||!t.mapObject.zoomNotApplied||(o.y=t.mapObject.centerLatOfGivenLocation,o.x=t.mapObject.centerLongOfGivenLocation,t.mapObject.tileZoomLevel=t.mapObject.mapScaleValue=t.mapObject.scaleOfGivenLocation),t.mapObject.tileTranslatePoint=t.panTileMap(t.mapObject.availableSize.width,t.mapObject.availableSize.height,o),this.mapObject.zoomSettings.resetToInitial&&this.mapObject.initialCheck&&!n.isNullOrUndefined(t.mapObject.height)&&this.mapObject.availableSize.height>512)&&(this.mapObject.applyZoomReset=!0,this.mapObject.initialZoomLevel=Math.floor(this.mapObject.availableSize.height/512),l="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?20:0,h=256*Math.pow(2,this.mapObject.initialZoomLevel),this.mapObject.initialTileTranslate.x=this.mapObject.availableSize.width/2-h/2,this.mapObject.initialTileTranslate.y=this.mapObject.availableSize.height/2-h/2+l);t.generateTiles(t.mapObject.tileZoomLevel,t.mapObject.tileTranslatePoint,null,u);n.isNullOrUndefined(t.mapObject.previousZoomFactor)||t.mapObject.previousZoomFactor===t.mapObject.zoomSettings.zoomFactor||(t.mapObject.previousZoomFactor=t.mapObject.zoomSettings.zoomFactor);t.mapObject.navigationLineModule&&t.layerObject.appendChild(t.mapObject.navigationLineModule.renderNavigation(t.currentLayer,t.mapObject.tileZoomLevel,r));t.mapObject.markerModule&&t.mapObject.markerModule.markerRender(t.layerObject,r,t.mapObject.tileZoomLevel,null);t.translateLayerElements(t.layerObject,r);t.layerGroup.appendChild(t.layerObject)},t.prototype.processLayers=function(t,i){var r=this,e,u,f;if((this.layerObject=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+i}),!this.mapObject.enablePersistence)&&(e=this.mapObject.getModuleName()+this.mapObject.element.id,-1===navigator.userAgent.indexOf("Edge"))){u=void 0;try{u=window.localStorage}catch(t){u=null}!n.isNullOrUndefined(u)&&window.localStorage.getItem(e)&&window.localStorage.removeItem(e)}f={cancel:!1,name:"layerRendering",index:i,layer:t,maps:this.mapObject,visible:t.visible};this.mapObject.trigger("layerRendering",f,function(){var s,e;if(!f.cancel&&f.visible)if("Geometry"!==t.layerType){if("Bing"!==t.layerType||r.bing)r.renderTileLayer(r,t,i);else if(t.key&&t.key.length>1){var o=r,u=new ef(r.mapObject),c="https://dev.virtualearth.net/REST/V1/Imagery/Metadata/"+("AerialWithLabel"===t.bingMapType?"AerialWithLabelsOnDemand":t.bingMapType),h=new n.Ajax({url:c+"?output=json&include=ImageryProviders&urischeme=https&key="+t.key});h.onSuccess=function(n){var f=JSON.parse(n).resourceSets[0].resources[0],e=f.imageUrl,s=f.imageUrlSubdomains,h=f.zoomMax;document.getElementById(o.mapObject.element.id+"_Markers_Group");null!=e&&e!==u.imageUrl&&(u.imageUrl=e);null!=s&&s!==u.subDomains&&(u.subDomains=s);null!=h&&h!==u.maxZoom&&(u.maxZoom=h);o.mapObject.bingMap=u;o.renderTileLayer(o,t,i,u);r.mapObject.arrangeTemplate();r.mapObject.zoomModule&&r.mapObject.previousScale!==r.mapObject.scale&&r.mapObject.zoomModule.applyTransform(!0)};h.send()}}else n.isNullOrUndefined(t.shapeData)||n.isNullOrUndefined(t.shapeData.geometries)&&n.isNullOrUndefined(t.shapeData.features)||(s=!n.isNullOrUndefined(t.shapeData.geometries)&&t.shapeData.geometries.length>0?t.shapeData.geometries:t.shapeData.features,t.layerData=[],e=t.shapeData.bbox,!n.isNullOrUndefined(e)&&t.isBaseLayer?r.mapObject.baseMapBounds=new li({min:e[0][1],max:e[1][1]},{min:e[0][0],max:e[1][0]}):n.isNullOrUndefined(r.mapObject.baseMapBounds)&&!lr(s)&&r.calculateRectBounds(s),r.calculatePathCollection(i,s))});this.mapObject.isTileMap?this.tileSvgObject&&(this.tileSvgObject.appendChild(this.layerGroup),this.mapObject.baseMapBounds=null):this.mapObject.svgObject.appendChild(this.layerGroup)},t.prototype.bubbleCalculation=function(t,i){var f,r,u;if(null!=t.dataSource&&null!=t)for(f=t.dataSource,r=0;r<f.length;r++)u=n.isNullOrUndefined(t.valuePath)?parseFloat(t.dataSource[r][t.valuePath]):t.valuePath.indexOf(".")>-1?Number(e(t.dataSource[r],t.valuePath)):parseFloat(t.dataSource[r][t.valuePath]),0!==r?u>i.max?i.max=u:u<i.min&&(i.min=u):i.max=i.min=u},t.prototype.calculatePathCollection=function(t,i){var r=this,u,o,s;if(this.groupElements=[],lr(i)||(this.currentFactor=this.calculateFactor(this.currentLayer)),this.rectBounds=null,u=this.currentLayer.shapeSettings,this.currentLayer.bubbleSettings,Array.prototype.forEach.call(i,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var i=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,u=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates,f=t.geometry,e=t.properties;r.generatePoints(i,u,f,e)}}),this.currentLayer.rectBounds=this.rectBounds,n.isNullOrUndefined(this.mapObject.baseMapRectBounds)&&this.currentLayer.isBaseLayer&&(this.mapObject.baseMapRectBounds=this.rectBounds),o=u.palette.length>1?u.palette:function(n){var t;switch(n.toLowerCase()){case"tailwind":t=["#0369A1","#14B8A6","#15803D","#334155","#5A61F6","#65A30D","#8B5CF6","#9333EA","#F59E0B","#F97316"];break;case"tailwinddark":t=["#10B981","#22D3EE","#2DD4BF","#4ADE80","#8B5CF6","#E879F9","#F472B6","#F87171","#F97316","#FCD34D"];break;case"bootstrap5":t=["#262E0B","#668E1F","#AF6E10","#862C0B","#1F2D50","#64680B","#311508","#4C4C81","#0C7DA0","#862C0B"];break;case"bootstrap5dark":t=["#5ECB9B","#A860F1","#EBA844","#557EF7","#E9599B","#BFC529","#3BC6CF","#7A68EC","#74B706","#EA6266"];break;case"fluentui":t=["#614570","#4C6FB1","#CC6952","#3F579A","#4EA09B","#6E7A89","#D4515C","#E6AF5D","#639751","#9D4D69"];break;case"fluentuidark":t=["#8AB113","#2A72D5","#43B786","#584EC6","#E85F9C","#6E7A89","#EA6266","#EBA844","#26BC7A","#BC4870"];break;default:t=["#B5E485","#7BC1E8","#DF819C","#EC9B79","#78D0D3","#D6D572","#9178E3","#A1E5B4","#87A4B4","#E4C16C"]}return t}(this.mapObject.theme),s=n.createElement("div",{id:this.mapObject.element.id+"_LayerIndex_"+t+"_Label_Template_Group",className:this.mapObject.element.id+"_template",styles:"pointer-events: none; overflow: hidden; position: absolute;top:"+this.mapObject.mapAreaRect.y+"px;left:"+this.mapObject.mapAreaRect.x+"px;height:"+this.mapObject.mapAreaRect.height+"px;width:"+this.mapObject.mapAreaRect.width+"px;"}),0!==this.currentLayer.layerData.length)for(var c=function(h){var w,nt,b,a=void 0,k={color:u.border.color,width:u.border.width,opacity:u.border.opacity},c=f.currentLayer.layerData[h],l="",v=u.autofill?o[h%o.length]:u.fill||f.mapObject.themeStyle.shapeFill,d,y;null===u.colorValuePath||n.isNullOrUndefined(c.property)||(null!==(a=st(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&0===u.colorMapping.length?v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?e(f.currentLayer.dataSource[a],u.colorValuePath):f.currentLayer.dataSource[a][u.colorValuePath]:c.property[u.colorValuePath]&&0===f.currentLayer.dataSource.length&&0===u.colorMapping.length&&(v=f.currentLayer.shapeSettings.colorValuePath.indexOf(".")>-1?e(c.property,u.colorValuePath):c.property[u.colorValuePath]),v=n.isNullOrUndefined(v)?u.fill||f.mapObject.themeStyle.shapeFill:v);d=f.mapObject.element.id+"_LayerIndex_"+t+"_shapeIndex_"+h+"_dataIndex_"+a;y=f.getShapeColorMapping(f.currentLayer,c.property,v);v="[object Object]"!==Object.prototype.toString.call(y)||n.isNullOrUndefined(y.fill)?v:y.fill;(f.currentLayer.shapeSettings.borderColorValuePath||f.currentLayer.shapeSettings.borderWidthValuePath)&&(f.currentLayer.shapeSettings.borderColorValuePath,f.currentLayer.shapeSettings.borderWidthValuePath,null!==(a=st(f.currentLayer.dataSource,c.property,f.currentLayer.shapeDataPath,f.currentLayer.shapePropertyPath,f.currentLayer))&&(f.currentLayer.dataSource[a][u.borderColorValuePath]&&(k.color=f.currentLayer.dataSource[a][u.borderColorValuePath]),f.currentLayer.dataSource[a][u.borderWidthValuePath]&&(k.width=f.currentLayer.dataSource[a][u.borderWidthValuePath])));var g="[object Object]"!==Object.prototype.toString.call(y)||n.isNullOrUndefined(y.opacity)?u.opacity:y.opacity,it={cancel:!1,name:"shapeRendering",index:h,data:f.currentLayer.dataSource?f.currentLayer.dataSource[a]:null,maps:f.mapObject,shape:u,fill:v,border:{width:k.width,color:k.color,opacity:k.opacity}},tt=function(f){var e,a=n.isNullOrUndefined(c._isMultiPolygon)?n.isNullOrUndefined(c.type)?c[0].type:c.type:"MultiPolygon",tt,it,rt,ut,y;if(a="Polygon"===a||"MultiPolygon"===a?"Polygon":a,f.cancel?(f.fill=v,f.border.color=u.border.color,f.border.width=u.border.width,r.mapObject.layers[t].shapeSettings.border=u.border):(f.fill="#A6A6A6"===f.fill?f.shape.fill||r.mapObject.themeStyle.shapeFill:f.fill,f.border.color="#000000"===f.border.color?f.shape.border.color:f.border.color,f.border.width=0===f.border.width?f.shape.border.width:f.border.width,n.isNullOrUndefined(u.borderColorValuePath)&&(r.mapObject.layers[t].shapeSettings.border.color=f.border.color),n.isNullOrUndefined(u.borderWidthValuePath)&&(r.mapObject.layers[t].shapeSettings.border.width=f.border.width)),f.border.opacity=n.isNullOrUndefined(f.border.opacity)?g:f.border.opacity,r.groupElements.length<1)b=r.mapObject.renderer.createGroup({id:r.mapObject.element.id+"_LayerIndex_"+t+"_"+a+"_Group",transform:""}),r.groupElements.push(b);else for(tt=0;tt<r.groupElements.length;tt++){if(it=r.groupElements[tt],it.id.indexOf(a)>-1){b=it;break}if(tt>=r.groupElements.length-1){b=r.mapObject.renderer.createGroup({id:r.mapObject.element.id+"_LayerIndex_"+t+"_"+a+"_Group"});r.groupElements.push(b);break}}switch(a){case"Polygon":c._isMultiPolygon?l=r.generateMultiPolygonPath(c):(l+="M"+c[0].point.x+" "+c[0].point.y,c.map(function(n){l+=" L "+n.point.x+" "+n.point.y}));(l+=" z ").length>3&&(w=new p(d,f.fill,f.border.width,f.border.color,g,f.border.opacity,u.dashArray,l),e=r.mapObject.renderer.drawPath(w));break;case"LineString":l+="M "+c[0].point.x+" "+c[0].point.y;c.map(function(n){l+="L"+n.point.x+" , "+n.point.y+" "});l.length>3&&(w=new p(d,"transparent",n.isNullOrUndefined(f.border.width)?1:f.border.width,f.border.color,g,f.border.opacity,u.dashArray,l),e=r.mapObject.renderer.drawPath(w));break;case"Point":rt=c.point;ut="SubLayer"!==r.mapObject.layers[t].type?u.circleRadius:u.circleRadius/r.currentFactor;nt=new bt(d,f.fill,f.border,g,rt.x,rt.y,ut,null);e=r.mapObject.renderer.drawCircle(nt);break;case"Path":l=c.point;w=new p(d,f.fill,f.border.width,f.border.color,g,f.border.opacity,u.dashArray,l);e=r.mapObject.renderer.drawPath(w)}if(!n.isNullOrUndefined(e)){for(var ft="[object Array]"===Object.prototype.toString.call(r.currentLayer.shapePropertyPath)?r.currentLayer.shapePropertyPath:[r.currentLayer.shapePropertyPath],et=void 0,k=0;k<ft.length;k++)if(!n.isNullOrUndefined(c.property)){et=ft[k];break}if(e.setAttribute("aria-label",n.isNullOrUndefined(c.property)?"":c.property[et]),e.setAttribute("tabindex",(r.mapObject.tabIndex+h+3).toString()),"LineString"===a&&e.setAttribute("style","outline:none"),dt(r.mapObject.selectedElementId,r.mapObject.shapeSelectionClass,e,"ShapeselectionMapStyle"),r.mapObject.toggledShapeElementId)for(k=0;k<r.mapObject.toggledShapeElementId.length;k++)y=r.mapObject.legendSettings.toggleLegendSettings.applyShapeSettings?r.currentLayer.shapeSettings:r.mapObject.legendSettings.toggleLegendSettings,r.mapObject.toggledShapeElementId[k]===e.id&&(e.setAttribute("fill",y.fill),e.setAttribute("stroke",y.border.color),e.setAttribute("fill-opacity",y.opacity.toString()),e.setAttribute("stroke-opacity",(n.isNullOrUndefined(y.border.opacity)?y.opacity:y.border.opacity).toString()),e.setAttribute("stroke-width",y.border.width.toString()));b.appendChild(e)}h===r.currentLayer.layerData.length-1&&r.layerFeatures(t,o,i,s)};tt.bind(f);f.mapObject.trigger("shapeRendering",it,tt)},f=this,h=0;h<this.currentLayer.layerData.length;h++)c(h);else this.layerFeatures(t,o,i,s)},t.prototype.layerFeatures=function(n,t,i,r){var o,u=this,h,c;if(this.currentLayer.bubbleSettings.length&&this.mapObject.bubbleModule)for(var e,l=this.currentLayer.bubbleSettings.length,a=function(i){e=f.currentLayer.bubbleSettings[i];o=f.mapObject.renderer.createGroup({id:f.mapObject.element.id+"_LayerIndex_"+n+"_bubble_Group_"+i});var r={min:0,max:0};f.bubbleCalculation(e,r);e.dataSource.map(function(f,s){u.renderBubble(u.currentLayer,f,t[s%t.length],r,i,s,o,n,e)});f.groupElements.push(o)},f=this,s=0;s<l;s++)a(s);this.mapObject.markerModule&&!this.mapObject.isTileMap&&this.mapObject.zoomSettings.enable&&this.mapObject.markerModule.calculateZoomCenterPositionAndFactor(this.mapObject.layersCollection);h=this.mapObject.renderer.createGroup({id:this.mapObject.element.id+"_LayerIndex_"+n+"_dataLableIndex_Group",style:"pointer-events: none;"});this.mapObject.dataLabelModule&&this.currentLayer.dataLabelSettings.visible&&(c=[],i.map(function(t,i){u.renderLabel(u.currentLayer,n,t,h,i,r,c)}),this.groupElements.push(h));this.mapObject.navigationLineModule&&this.groupElements.push(this.mapObject.navigationLineModule.renderNavigation(this.currentLayer,this.currentFactor,n));this.groupElements.map(function(n){u.layerObject.appendChild(n)});this.mapObject.markerModule&&this.mapObject.markerModule.markerRender(this.layerObject,n,this.mapObject.isTileMap?Math.floor(this.currentFactor):this.currentFactor,null);this.translateLayerElements(this.layerObject,n);this.layerGroup.appendChild(this.layerObject)},t.prototype.renderLabel=function(n,t,i,r,u,f,e){this.mapObject.dataLabelModule.renderLabel(n,t,i,n.layerData,r,f,u,e)},t.prototype.generateMultiPolygonPath=function(n){for(var i="",t=0;t<n.length;t++)i+="M"+n[t][0].point.x+" "+n[t][0].point.y,n[t].map(function(n){i+=" L "+n.point.x+" "+n.point.y});return i},t.prototype.renderBubble=function(t,i,r,u,f,e,o,s,h){if(n.isNullOrUndefined(this.mapObject.bubbleModule)||!h.visible)return null;r=h.fill?h.fill:r;this.mapObject.bubbleModule.id=this.mapObject.element.id+"_LayerIndex_"+s+"_BubbleIndex_"+f+"_dataIndex_"+e;this.mapObject.bubbleModule.renderBubble(h,i,r,u,f,e,s,t,o,this.mapObject.bubbleModule.id)},t.prototype.getShapeColorMapping=function(t,i,r){if(r=r||t.shapeSettings.fill,0===t.shapeSettings.colorMapping.length&&n.isNullOrUndefined(t.dataSource))return r;var u=st(t.dataSource,i,t.shapeDataPath,t.shapePropertyPath),f=new of(this.mapObject);return n.isNullOrUndefined(t.dataSource[u])?r:f.getShapeColorMapping(t.shapeSettings,t.dataSource[u],r)},t.prototype.generatePoints=function(t,i,r,u){var e,o,s=this,f=[],h,c,v,l,p,a;switch(t.toLowerCase()){case"polygon":(f=this.calculatePolygonBox(i[0],r,u)).length>0&&(f.property=u,f.type=t,f._isMultiPolygon=!1,this.currentLayer.layerData.push(f));break;case"multipolygon":for(h=[],c=0;c<i.length;c++)(f=this.calculatePolygonBox(i[c][0],r,u)).length>0&&h.push(f);h.property=u;h.type=t;h._isMultiPolygon=!0;this.currentLayer.layerData.push(h);break;case"linestring":v=n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:this.currentLayer.shapeSettings.border.width;i.map(function(n){e=n[1];o=n[0];var t=y(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.calculateBox(t,v);f.push({point:t,lat:e,lng:o})});f.property=u;f.type=t;this.currentLayer.layerData.push(f);break;case"point":l=!1;p=(n.isNullOrUndefined(this.currentLayer.shapeSettings.border.width)?1:this.currentLayer.shapeSettings.border.width)+2*this.currentLayer.shapeSettings.circleRadius;(i.map(function(n){if("[object Array]"===Object.prototype.toString.call(n)){e=n[1];o=n[0];l=!0;var i=y(e,o,s.currentFactor,s.currentLayer,s.mapObject);s.currentLayer.layerData.push({point:i,type:t,lat:e,lng:o,property:u})}}),l)||(e=i[1],o=i[0],a=y(e,o,this.currentFactor,this.currentLayer,this.mapObject),this.calculateBox(a,p),this.currentLayer.layerData.push({point:a,type:t,lat:e,lng:o,property:u}));break;case"path":this.currentLayer.layerData.push({point:r.d,type:t,property:u})}},t.prototype.calculateBox=function(t,i){n.isNullOrUndefined(this.rectBounds)?this.rectBounds={min:{x:t.x,y:t.y-i},max:{x:t.x,y:t.y+i}}:(this.rectBounds.min.x=Math.min(this.rectBounds.min.x,t.x),this.rectBounds.min.y=Math.min(this.rectBounds.min.y,t.y-i),this.rectBounds.max.x=Math.max(this.rectBounds.max.x,t.x),this.rectBounds.max.y=Math.max(this.rectBounds.max.y,t.y+i))},t.prototype.calculateFactor=function(n){var o,i,r,s,u=this.mapObject.baseMapBounds,t=new w(this.mapObject.mapAreaRect.width,this.mapObject.mapAreaRect.height-5),f,e;return u?(f=y(u.latitude.min,u.longitude.min,null,n,this.mapObject),e=y(u.latitude.max,u.longitude.max,null,n,this.mapObject),i=e.y-f.y,r=e.x-f.x):i=r=500,o=i<t.height?parseFloat(Math.abs(100*Number(t.height/Number(i.toString()+"e+1"))).toString().split(".")[0])/10:t.height/i,s=r<t.width?parseFloat(Math.abs(100*Number(t.width/Number(r.toString()+"e+1"))).toString().split(".")[0])/10:t.width/r,Math.min(s,o)},t.prototype.translateLayerElements=function(t){var i,u,s,h,r,c,f,e,o;if(this.mapObject.translateType="layer",n.isNullOrUndefined(this.mapObject.baseMapRectBounds)){if(this.mapObject.isTileMap&&!n.isNullOrUndefined(this.mapObject.scale))for(u=0;u<t.childElementCount;u++)(i=t.childNodes[u]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||i.id.indexOf("_line_Group")>-1||(o="scale( "+this.mapObject.scale+" ) translate( "+this.mapObject.translatePoint.x+" "+this.mapObject.translatePoint.y+" ) ",i.setAttribute("transform",o))}else for(s=this.currentLayer.animationDuration,h=0!==s||n.isNullOrUndefined(this.mapObject.zoomModule),this.mapObject.baseTranslatePoint=this.mapObject.zoomTranslatePoint,r=void 0,r=this.mapObject.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.mapObject.zoomModule)?at(this.mapObject,this.currentLayer,h):ut(this.mapObject,this.currentLayer,h),c=this.mapObject.previousScale=r.scale,f=this.mapObject.previousPoint=r.location,this.mapObject.baseTranslatePoint=this.mapObject.translatePoint=f,this.mapObject.baseScale=this.mapObject.scale=c,e=0;e<t.childElementCount;e++)(i=t.childNodes[e]).id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1||(o="scale( "+c+" ) translate( "+f.x+" "+f.y+" ) ",i.setAttribute("transform",o),s>0&&!n.isNullOrUndefined(this.mapObject.zoomModule)&&(r=this.mapObject.zoomSettings.zoomFactor>1?at(this.mapObject,this.currentLayer):ut(this.mapObject,this.currentLayer),this.mapObject.scale=r.scale,this.mapObject.zoomTranslatePoint=this.mapObject.translatePoint=r.location))},t.prototype.calculateRectBounds=function(t){var i=this;Array.prototype.forEach.call(t,function(t){if(!n.isNullOrUndefined(t.geometry)||!n.isNullOrUndefined(t.coordinates)){var u=n.isNullOrUndefined(t.geometry)?t.type:t.geometry.type,r=n.isNullOrUndefined(t.geometry)?t.coordinates:t.geometry.coordinates;switch(u.toLowerCase()){case"polygon":i.calculateRectBox(r[0]);break;case"multipolygon":r.map(function(n){i.calculateRectBox(n[0])});break;case"linestring":r.map(function(n,t){i.calculateRectBox(n,"LineString",0===t)});break;case"point":i.calculateRectBox(r,"point")}}})},t.prototype.calculatePolygonBox=function(t){var i=this,u=[],r=this.mapObject.baseMapBounds;return t.map(function(t){var e=t[1],o=t[0],f;o>=r.longitude.min&&o<=r.longitude.max&&e>=r.latitude.min&&e<=r.latitude.max&&(f=y(e,o,i.currentFactor,i.currentLayer,i.mapObject),n.isNullOrUndefined(i.rectBounds)?i.rectBounds={min:{x:f.x,y:f.y},max:{x:f.x,y:f.y}}:(i.rectBounds.min.x=Math.min(i.rectBounds.min.x,f.x),i.rectBounds.min.y=Math.min(i.rectBounds.min.y,f.y),i.rectBounds.max.x=Math.max(i.rectBounds.max.x,f.x),i.rectBounds.max.y=Math.max(i.rectBounds.max.y,f.y)),u.push({point:f,lat:e,lng:o}))}),u},t.prototype.calculateRectBox=function(t,i,r){var u=this;"LineString"!==i&&"point"!==i?Array.prototype.forEach.call(t,function(t){n.isNullOrUndefined(u.mapObject.baseMapBounds)?u.mapObject.baseMapBounds=new li({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(u.mapObject.baseMapBounds.latitude.min=Math.min(u.mapObject.baseMapBounds.latitude.min,t[1]),u.mapObject.baseMapBounds.latitude.max=Math.max(u.mapObject.baseMapBounds.latitude.max,t[1]),u.mapObject.baseMapBounds.longitude.min=Math.min(u.mapObject.baseMapBounds.longitude.min,t[0]),u.mapObject.baseMapBounds.longitude.max=Math.max(u.mapObject.baseMapBounds.longitude.max,t[0]))}):(r||"point"===i)&&n.isNullOrUndefined(this.mapObject.baseMapBounds)?this.mapObject.baseMapBounds=new li({min:t[1],max:t[1]},{min:t[0],max:t[0]}):(this.mapObject.baseMapBounds.latitude.min=Math.min(this.mapObject.baseMapBounds.latitude.min,t[1]),this.mapObject.baseMapBounds.latitude.max=Math.max(this.mapObject.baseMapBounds.latitude.max,t[1]),this.mapObject.baseMapBounds.longitude.min=Math.min(this.mapObject.baseMapBounds.longitude.min,t[0]),this.mapObject.baseMapBounds.longitude.max=Math.max(this.mapObject.baseMapBounds.longitude.max,t[0]))},t.prototype.generateTiles=function(t,i,r,u,f){var e,a,rt=this.mapObject.locale,h=this.mapObject.availableSize,y,p,v,c,l,w,b,k,o,ut,s,d,it,g,nt;this.tiles=[];e=a=Math.pow(2,t);y=0;p=0;i.x+256*e<h.width&&(y=i.x>0?Math.ceil(i.x/256):0,p=i.x+256*e<h.width?Math.ceil((h.width-(i.x+256*e))/256):0);e+=y+p;"Pan"===r?(e=this.horizontalPanXCount>=e?this.horizontalPanXCount:e,this.horizontalPan=!1):(this.horizontalPanXCount=e,this.horizontalPan=!0);v=this.mapObject.layers[this.mapObject.baseLayerIndex];this.urlTemplate=v.urlTemplate;var et=Math.min(a,(-i.y+h.height)/256+1),ot=Math.min(e,(-i.x+h.width+256*p)/256+1),st=-(i.x+256*y+256)/256,ht=-(i.y+256)/256;for(u=u||this.bing||this.mapObject.bingMap,c=Math.round(st);c<Math.round(ot);c++)for(l=Math.round(ht);l<Math.round(et);l++)w=256*c+i.x,b=256*l+i.y,w>-256&&w<=h.width&&b>-256&&b<h.height&&l>=0&&(k=c,c<0&&(k=k%a+a),o=new le(k%a,l),(o.left=w,o.top=b,"Bing"===v.layerType)?(ut=v.key,o.src=u.getBingMap(o,ut,v.bingMapType,rt,u.imageUrl,u.subDomains)):o.src=this.urlTemplate.replace("level",t.toString()).replace("tileX",o.x.toString()).replace("tileY",o.y.toString()),this.tiles.push(o));n.isNullOrUndefined(r)||(r.indexOf("wheel")>1?(this.animateToZoomX=this.mapObject.availableSize.width/2-f.x-10,this.animateToZoomY=-f.y):(this.animateToZoomX=-10,this.animateToZoomY=10-(this.mapObject.availableSize.height/2+11.5)));for(var ct=n.extend([],this.tiles,[],!0),tt=0,ft=this.mapObject.layers;tt<ft.length;tt++)if(s=ft[tt],"SubLayer"===s.type&&s.visible&&("OSM"===s.layerType||"Bing"===s.layerType))for(d=0,it=ct;d<it.length;d++)g=it[d],nt=n.extend({},g,{},!0),nt.src="Bing"===s.layerType?u.getBingMap(nt,s.key,s.bingMapType,rt,u.imageUrl,u.subDomains):s.urlTemplate.replace("level",t.toString()).replace("tileX",g.x.toString()).replace("tileY",g.y.toString()),this.tiles.push(nt);(this.mapObject.previousScale!==this.mapObject.scale||this.mapObject.isReset)&&this.arrangeTiles(r,this.animateToZoomX,this.animateToZoomY)},t.prototype.arrangeTiles=function(t,i,r){var o,u=this,f=document.getElementById(this.mapObject.element.id+"_tile_parent"),e=document.getElementById(this.mapObject.element.id+"_tiles");n.isNullOrUndefined(t)||"Pan"===t?o=0:(this.tileAnimation(t,i,r),o=this.mapObject.layersCollection[0].animationDuration);"GoogleStaticMap"===this.mapObject.layers[this.mapObject.baseLayerIndex].layerType?this.renderGoogleMap(this.mapObject.layers[0].key,this.mapObject.staticMapZoom):setTimeout(function(){var i;f&&(f.style.zIndex="1");e&&(e.style.zIndex="0");!document.getElementById(u.mapObject.element.id+"_animated_tiles")&&f?(i=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(i)):"Pan"!==t&&e&&f?(e.appendChild(f.children[0]),n.isNullOrUndefined(document.getElementById(u.mapObject.element.id+"_animated_tiles"))||(document.getElementById(u.mapObject.element.id+"_animated_tiles").id=u.mapObject.element.id+"_animated_tiles_old"),i=n.createElement("div",{id:u.mapObject.element.id+"_animated_tiles"}),f.appendChild(i)):i=f?f.children[0]:null;for(var r=0,h=function(f){var o=n.createElement("img"),e;o.setAttribute("src",f.src);e=u.mapObject.element.id;o.onload=function(){document.getElementById(e+"_tile_"+r)&&"Pan"===t&&l(e+"_tile_"+r);var s=n.createElement("div",{id:e+"_tile_"+r});s.style.position="absolute";s.style.left=f.left+"px";s.style.top=f.top+"px";s.style.height=f.height+"px";s.style.width=f.width+"px";s.appendChild(o);i&&i.appendChild(s);++r===u.tiles.length&&document.getElementById(u.mapObject.element.id+"_animated_tiles_old")&&l(u.mapObject.element.id+"_animated_tiles_old")}},o=0,s=u.tiles;o<s.length;o++)h(s[o])},o)},t.prototype.tileAnimation=function(t,i,r){var o=document.getElementById(this.mapObject.element.id+"_tile_parent"),f=document.getElementById(this.mapObject.element.id+"_animated_tiles"),u=document.getElementById(this.mapObject.element.id+"_tiles"),e="2";if(0===t.indexOf("ZoomOut")||"Reset"===t){for(u.style.zIndex="1",o.style.zIndex="0";u.childElementCount>=1;)u.removeChild(u.children[0]);i=0;r=document.getElementById(this.mapObject.element.id+"_tile_parent").getClientRects()[0].height/4;e=0===t.indexOf("ZoomOut")?"0.5":"0.2"}n.isNullOrUndefined(f)||(f.style.transition=this.mapObject.layersCollection[0].animationDuration+"ms",f.style.transform="translate("+i+"px, "+r+"px) scale("+e+")")},t.prototype.renderGoogleMap=function(t,i){var r=this.mapObject,u,e,o;i=this.mapObject.tileZoomLevel;var s=256*Math.pow(2,i),a=r.mapAreaRect.width/2-s/2,v=r.mapAreaRect.height/2-s/2,h=0,c=0,l=it(new f(null,null),i,{x:a,y:v},this.isMapCoordinates);r.zoomModule&&r.zoomSettings.enable&&(h=r.zoomModule.mouseDownLatLong.x-r.zoomModule.mouseMoveLatLong.x,c=r.zoomModule.mouseDownLatLong.y-r.zoomModule.mouseMoveLatLong.y);o=r.pointToLatLong(l.x-h,l.y-c);r.centerPosition.latitude=o.latitude;r.centerPosition.longitude=o.longitude;var y=(u=n.isNullOrUndefined(parseInt(r.width,10))?parseInt(r.width,10)-22:Math.round(r.mapAreaRect.width))>640?(u-640)/2:0,p=(e=n.isNullOrUndefined(parseInt(r.height,10))?parseInt(r.height,10)-22:Math.round(r.mapAreaRect.height))>640?(e-640)/2:0,w=r.layers[r.layers.length-1].staticMapType.toString().toLowerCase(),b="https://maps.googleapis.com/maps/api/staticmap?size="+u+"x"+e+"&zoom="+i+"&center="+(r.centerPosition.latitude&&r.centerPosition.longitude?r.centerPosition.latitude.toString()+","+r.centerPosition.longitude.toString():"0,0")+"&maptype="+w+"&key="+t;document.getElementById(this.mapObject.element.id+"_tile_parent").innerHTML='<div id="'+this.mapObject.element.id+'_StaticGoogleMap"style="position:absolute; left:'+y+"px; top:"+p+'px"><img src="'+b+'"><\/div>'},t.prototype.panTileMap=function(t,i,r){var l,a;this.mapObject.tileZoomLevel<=this.mapObject.tileZoomScale&&this.mapObject.initialCheck&&(this.mapObject.tileZoomLevel=this.mapObject.tileZoomScale);var e,u,o=this.mapObject.tileZoomLevel,s="GoogleStaticMap"!==this.mapObject.layers[this.mapObject.layers.length-1].layerType?20:0,h=256*Math.pow(2,o),c=it(r,o,{x:e=t/2-h/2,y:u=i/2-h/2},this.isMapCoordinates);return(s=this.mapObject.zoomNotApplied?0:s,e-=c.x-t/2,u=u-(c.y-i/2)+s,this.mapObject.scale=Math.pow(2,o-1),(n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||0===this.mapObject.tileTranslatePoint.y&&0===this.mapObject.tileTranslatePoint.x||n.isNullOrUndefined(this.mapObject.previousTileWidth)||n.isNullOrUndefined(this.mapObject.previousTileHeight))&&(this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||!n.isNullOrUndefined(r.x)||1!==this.mapObject.zoomSettings.zoomFactor&&this.mapObject.zoomSettings.zoomFactor===o&&this.mapObject.defaultState||t===this.mapObject.previousTileWidth&&i===this.mapObject.previousTileHeight)||(l=e-(this.mapObject.previousTileWidth/2-h/2),a=u-(this.mapObject.previousTileHeight/2-h/2+s),this.mapObject.tileTranslatePoint.x=this.mapObject.tileTranslatePoint.x+l,this.mapObject.tileTranslatePoint.y=this.mapObject.tileTranslatePoint.y+a),n.isNullOrUndefined(this.mapObject.tileTranslatePoint)||this.mapObject.zoomNotApplied||(0===this.mapObject.tileTranslatePoint.x||this.mapObject.tileTranslatePoint.x===e||this.mapObject.centerPositionChanged||(e=this.mapObject.tileTranslatePoint.x),0===this.mapObject.tileTranslatePoint.y||this.mapObject.tileTranslatePoint.y===u||this.mapObject.centerPositionChanged||(u=this.mapObject.tileTranslatePoint.y)),this.mapObject.translatePoint=new f((e-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale,(u-.01*this.mapObject.zoomSettings.zoomFactor)/this.mapObject.scale),this.mapObject.previousTileWidth=t,this.mapObject.previousTileHeight=i,new f(e,u)},t}(),sf=function(){function t(n){this.map=n}return t.prototype.renderAnnotationElements=function(){var r=this,i=this.map.element.id+"_Secondary_Element",t=n.createElement("div",{id:this.map.element.id+"_Annotations_Group"});t.style.position="absolute";t.style.top="0px";t.style.left="0px";this.map.annotations.map(function(n,i){null!==n.content&&r.createAnnotationTemplate(t,n,i)});t.childElementCount>0&&!n.isNullOrUndefined(u(i))&&u(i).appendChild(t);this.map.renderReactTemplates()},t.prototype.createAnnotationTemplate=function(t,i,r){var u,f,y,p,e=this,o=this.map,b=o.availableSize,s=(o.element.id,n.createElement("div",{id:o.element.id+"_Annotation_"+r,styles:"position: absolute; z-index:"+i.zIndex+";"})),h={cancel:!1,name:rf,content:i.content,annotation:i},l,a;this.map.trigger(rf,h,function(){if(!h.cancel)if((y=ti(h.content))&&y(e.map,e.map,h.content,e.map.element.id+"_ContentTemplate_"+r).length)for(var i=(p=Array.prototype.slice.call(y(e.map,e.map,h.content,e.map.element.id+"_ContentTemplate_"+r))).length,t=0;t<i;t++)s.appendChild(p[t]);else s.appendChild(n.createElement("div",{innerHTML:h.content}))});var v=function(n,t){t.appendChild(n);var i=n.offsetWidth,r=n.offsetHeight;return t.removeChild(n),new w(i,r)}(s.cloneNode(!0),o.element),k=o.element.getBoundingClientRect(),c=o.svgObject.getBoundingClientRect();u=Math.abs(c.left-k.left);f=Math.abs(c.top-k.top);l=i.x.indexOf("%")>-1?b.width/100*parseFloat(i.x):parseFloat(i.x);a=i.y.indexOf("%")>-1?b.height/100*parseFloat(i.y):parseFloat(i.y);switch(u="None"===i.horizontalAlignment?u+l:u,f="None"===i.verticalAlignment?f+a:f,i.verticalAlignment){case"Near":f+=a;break;case"Center":f=f+a+(c.height/2-v.height/2);break;case"Far":f=f+c.height+a-v.height}switch(i.horizontalAlignment){case"Near":u+=l;break;case"Center":u=u+l+(c.width/2-v.width/2);break;case"Far":u=u+c.width+l-v.width}s.style.left=u+"px";s.style.top=f+"px";t.appendChild(s)},t.prototype.getModuleName=function(){return"Annotations"},t.prototype.destroy=function(){},t}();const g=ejdashboard.data;var pe=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},hf=function(t){function i(i,r){var u=t.call(this,i,r)||this;return u.isTileMap=!1,u.isResize=!1,u.baseSize=new w(0,0),u.translatePoint=new f(0,0),u.baseTranslatePoint=new f(0,0),u.zoomTranslatePoint=new f(0,0),u.markerZoomedState=!0,u.zoomPersistence=!1,u.defaultState=!0,u.centerPositionChanged=!1,u.isTileMapSubLayer=!1,u.markerNullCount=0,u.tileTranslatePoint=new f(0,0),u.baseTileTranslatePoint=new f(0,0),u.isDevice=!1,u.staticMapZoom=u.zoomSettings.enable?u.zoomSettings.zoomFactor:0,u.zoomNotApplied=!1,u.dataLabelShape=[],u.zoomShapeCollection=[],u.zoomLabelPositions=[],u.mouseDownEvent={x:null,y:null},u.mouseClickEvent={x:null,y:null},u.selectedElementId=[],u.selectedMarkerElementId=[],u.selectedBubbleElementId=[],u.selectedNavigationElementId=[],u.selectedLegendElementId=[],u.legendSelectionCollection=[],u.shapeSelections=!0,u.legendSelection=!0,u.toggledLegendId=[],u.toggledShapeElementId=[],u.checkInitialRender=!0,u.initialTileTranslate=new f(0,0),u.initialCheck=!0,u.applyZoomReset=!1,u.markerClusterExpandCheck=!1,u.markerClusterExpand=!1,u.shapeSelectionItem=[],n.setValue("mergePersistData",u.mergePersistMapsData,u),u}return pe(i,t),Object.defineProperty(i.prototype,"isShapeSelected",{get:function(){return this.mapSelect},enumerable:!0,configurable:!0}),i.prototype.mergePersistMapsData=function(){var i,f,r,o,u,e,t;try{f=window.localStorage}catch(i){f=null}if(n.isNullOrUndefined(f)||(i=window.localStorage.getItem(this.getModuleName()+this.element.id)),!n.isNullOrUndefined(i)&&""!==i){for(r=JSON.parse(i),o=Object.keys(r),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)t=e[u],"object"!=typeof this[t]||n.isNullOrUndefined(this[t])?this[t]=r[t]:n.extend(this[t],r[t]);this.isProtectedOnChange=!1}},i.prototype.getLocalizedLabel=function(n){return this.localeObject.getConstant(n)},i.prototype.preRender=function(){this.isDevice=n.Browser.isDevice;this.initPrivateVariable();this.allowServerDataBinding=!1;this.unWireEVents();this.wireEVents();this.setCulture()},i.prototype.renderElements=function(){this.trigger("load",{maps:this});this.createSVG();this.findBaseAndSubLayers();this.createSecondaryElement();this.addTabIndex();this.themeStyle=function(n){var t,i;switch(n.toLowerCase()){case"materialdark":i="#303030";break;case"fabricdark":i="#201F1F";break;case"bootstrapdark":i="#1A1A1A"}switch(n.toLowerCase()){case"materialdark":case"fabricdark":case"bootstrapdark":t={backgroundColor:i,areaBackgroundColor:i,titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#DADADA",legendTextColor:"#DADADA",dataLabelFontColor:"#DADADA",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#363F4C",zoomFillColor:"#FFFFFF",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"highcontrast":t={backgroundColor:"#000000",areaBackgroundColor:"#000000",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#000000",tooltipFontColor:"#000000",tooltipFillColor:"#ffffff",zoomFillColor:"#FFFFFF",fontFamily:"Roboto, Noto, Sans-serif",labelFontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"bootstrap4":t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#5B6269",fontFamily:"HelveticaNeue-Medium",titleFontSize:"16px",legendFontSize:"14px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"HelveticaNeue-Medium",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"};break;case"tailwind":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#374151",subTitleFontColor:"#374151",legendTitleFontColor:"#374151",legendTextColor:"#6B7280",dataLabelFontColor:"#505967",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#111827",zoomFillColor:"#6b7280",fontFamily:"Inter",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#374151",shapeFill:"#E5E7EB"};break;case"tailwinddark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#D1D5DB",subTitleFontColor:"#D1D5DB",legendTitleFontColor:"#D1D5DB",legendTextColor:"#D1D5DB",dataLabelFontColor:"#D1D5DB",tooltipFontColor:"#1F2937",tooltipFillColor:"#F9FAFB",zoomFillColor:"#D1D5DB",fontFamily:"Inter",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:.9,labelFontFamily:"Inter",titleFontWeight:"500",zoomSelectionColor:"#F3F4F6",shapeFill:"#374151"};break;case"bootstrap5":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#212529",subTitleFontColor:"#212529",legendTitleFontColor:"#212529",legendTextColor:"#212529",dataLabelFontColor:"#212529",tooltipFontColor:"#F9FAFB",tooltipFillColor:"#212529",zoomFillColor:"#6C757D",fontFamily:"Helvetica Neue",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#343A40",shapeFill:"#E9ECEF"};break;case"bootstrap5dark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#FFFFFF",subTitleFontColor:"#FFFFFF",legendTitleFontColor:"#FFFFFF",legendTextColor:"#FFFFFF",dataLabelFontColor:"#FFFFFF",tooltipFontColor:"#212529",tooltipFillColor:"#E9ECEF",zoomFillColor:"#B5BABE",fontFamily:"Helvetica Neue",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Helvetica Neue",titleFontWeight:"normal",zoomSelectionColor:"#DEE2E6",shapeFill:"#495057"};break;case"fluentui":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#201F1E",subTitleFontColor:"#201F1E",legendTitleFontColor:"#201F1E",legendTextColor:"#201F1E",dataLabelFontColor:"#201F1E",tooltipFontColor:"#323130",tooltipFillColor:"#FFFFFF",zoomFillColor:"#A19F9D",fontFamily:"Segoe UI",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#323130",shapeFill:"#F3F2F1"};break;case"fluentuidark":t={backgroundColor:"rgba(255,255,255, 0.0)",areaBackgroundColor:"rgba(255,255,255, 0.0)",titleFontColor:"#F3F2F1",subTitleFontColor:"#F3F2F1",legendTitleFontColor:"#F3F2F1",legendTextColor:"#F3F2F1",dataLabelFontColor:"#F3F2F1",tooltipFontColor:"#F3F2F1",tooltipFillColor:"#252423",zoomFillColor:"#484644",fontFamily:"Segoe UI",titleFontSize:"14px",legendFontSize:"12px",tooltipFillOpacity:1,tooltipTextOpacity:1,labelFontFamily:"Segoe UI",titleFontWeight:"600",zoomSelectionColor:"#F3F2F1",shapeFill:"#252423"};break;default:t={backgroundColor:"#FFFFFF",areaBackgroundColor:"#FFFFFF",titleFontColor:"#424242",subTitleFontColor:"#424242",legendTitleFontColor:"#757575",legendTextColor:"#757575",dataLabelFontColor:"#000000",tooltipFontColor:"#FFFFFF",tooltipFillColor:"#000000",zoomFillColor:"#737373",labelFontFamily:"Roboto, Noto, Sans-serif",fontFamily:"Roboto, Noto, Sans-serif",titleFontWeight:"Medium",zoomSelectionColor:"#e61576",shapeFill:"#A6A6A6"}}return t}(this.theme);this.renderBorder();this.renderTitle(this.titleSettings,"title",null,null);this.renderArea();this.processRequestJsonData();this.renderComplete()},i.prototype.render=function(){this.renderElements()},i.prototype.processRequestJsonData=function(){var i,r,t=this,u=this.layersCollection.length-1;this.serverProcess={request:0,response:0};Array.prototype.forEach.call(this.layersCollection,function(f,e){var s,o,h;if(f.shapeData instanceof g.DataManager?(t.serverProcess.request++,r=f.shapeData,i=f.query instanceof g.Query?f.query:new g.Query,r.executeQuery(i).then(function(n){t.processResponseJsonData("DataManager",n,f,"ShapeData")})):(f.shapeData instanceof wi||f.shapeData)&&(n.isNullOrUndefined(f.shapeData.dataOptions)||t.processAjaxRequest(f,f.shapeData,"ShapeData")),f.dataSource instanceof g.DataManager&&(t.serverProcess.request++,r=f.dataSource,i=f.query instanceof g.Query?f.query:new g.Query,r.executeQuery(i).then(function(n){f.dataSource=yt(n)})),f.markerSettings.length>0)for(s=function(n){f.markerSettings[n].dataSource instanceof g.DataManager&&(t.serverProcess.request++,r=f.markerSettings[n].dataSource,i=f.markerSettings[n].query instanceof g.Query?f.markerSettings[n].query:new g.Query,r.executeQuery(i).then(function(t){f.markerSettings[n].dataSource=yt(t)}))},o=0;o<f.markerSettings.length;o++)s(o);if(f.bubbleSettings.length>0)for(h=function(n){f.bubbleSettings[n].dataSource instanceof g.DataManager&&(t.serverProcess.request++,r=f.bubbleSettings[n].dataSource,i=f.bubbleSettings[n].query instanceof g.Query?f.bubbleSettings[n].query:new g.Query,r.executeQuery(i).then(function(t){f.bubbleSettings[n].dataSource=yt(t)}))},o=0;o<f.bubbleSettings.length;o++)h(o);(f.dataSource instanceof wi||!n.isNullOrUndefined(f.dataSource.dataOptions))&&t.processAjaxRequest(f,f.dataSource,"DataSource");t.serverProcess.request===t.serverProcess.response&&u===e&&t.processResponseJsonData(null)})},i.prototype.processAjaxRequest=function(t,i,r){var f=this,u;this.serverProcess.request++;u=new n.Ajax(i.dataOptions,i.type,i.async,i.contentType);u.onSuccess=function(n){f.processResponseJsonData("Ajax",n,t,r)};u.send(i.sendData)},i.prototype.processResponseJsonData=function(t,i,r,u){var f,e,o;if(this.serverProcess.response++,t&&("ShapeData"===u?r.shapeData="DataManager"===t?yt(i):JSON.parse(i):r.dataSource="DataManager"===t?yt(i):JSON.parse("["+i+"]")[0]),n.isNullOrUndefined(t)||this.serverProcess.request!==this.serverProcess.response)n.isNullOrUndefined(t)&&this.renderMap();else{for(f=this.layersCollection,this.layersCollection=[],e=0;e<f.length;e++)f[e].isBaseLayer&&this.layersCollection.push(f[e]);for(o=0;o<f.length;o++)f[o].isBaseLayer||this.layersCollection.push(f[o]);this.renderMap()}},i.prototype.renderMap=function(){var b,s,t,c,y,p,i,r,l,h,a;for(this.legendModule&&this.legendSettings.visible&&(this.isTileMap?(b=this.layersCollection.length-1,this.layersCollection[b].isBaseLayer||(this.isTileMapSubLayer=!0,this.legendModule.renderLegend())):this.legendModule.renderLegend()),this.createTile(),this.zoomSettings.enable&&this.zoomModule&&this.zoomModule.createZoomingToolbars(),n.isNullOrUndefined(this.dataLabelModule)||(this.dataLabelModule.dataLabelCollections=[],this.dataLabelShape=[]),this.mapLayerPanel.measureLayerPanel(),this.element.appendChild(this.svgObject),s=this.getExtraPosition(),t=0;t<this.layers.length;t++){if((0!==s.x||0!==s.y)&&(c=document.getElementById(this.element.id+"_LayerIndex_"+t+"_Markers_Template_Group"),n.isNullOrUndefined(c)||(c.style.top=this.mapAreaRect.y+s.y+"px",c.style.left=this.mapAreaRect.x+s.x+"px")),this.layers[t].selectionSettings&&this.layers[t].selectionSettings.enable&&this.layers[t].initialShapeSelection.length>0&&this.checkInitialRender){for(y=this.layers[t].selectionSettings.enableMultiSelect,this.layers[t].selectionSettings.enableMultiSelect=y||!0,p=this.layers[t].initialShapeSelection,i=0;i<this.layers[t].initialShapeSelection.length;i++)this.shapeSelection(t,p[i].shapePath,p[i].shapeValue,!0);this.layers[t].selectionSettings.enableMultiSelect=y;t===this.layers.length-1&&(this.checkInitialRender=!1)}for(r=0;r<this.layers[t].markerSettings.length;r++)if(this.layers[t].markerSettings[r].selectionSettings&&this.layers[t].markerSettings[r].selectionSettings.enable&&this.layers[t].markerSettings[r].initialMarkerSelection.length>0)for(l=this.layers[t].markerSettings[r].initialMarkerSelection,i=0;i<l.length;i++)this.markerInitialSelection(t,r,this.layers[t].markerSettings[r],l[i].latitude,l[i].longitude)}if(!n.isNullOrUndefined(document.getElementById(this.element.id+"_tile_parent"))){var f,d=this.svgObject.getBoundingClientRect(),e=document.getElementById(this.element.id),u=document.getElementById(this.element.id+"_tile_parent"),k=document.getElementById(this.element.id+"_tiles"),g=u.getBoundingClientRect(),w=void 0,o=void 0;o=parseFloat(u.style.left)+e.offsetLeft;h=v(this.titleSettings.text,this.titleSettings.textStyle);a=v(this.titleSettings.subtitleSettings.text,this.titleSettings.subtitleSettings.textStyle);this.isTileMap&&this.isTileMapSubLayer&&"Bottom"===this.legendSettings.position&&this.legendSettings.visible?"Default"!==this.legendSettings.mode?f=0!==h.width&&0!==h.height?parseFloat(u.style.top)+e.offsetTop+a.height/2-this.legendModule.legendBorderRect.height/2:parseFloat(u.style.top)+e.offsetTop-this.mapAreaRect.y:(o=this.legendModule.legendBorderRect.x,f=0!==h.width&&0!==h.height?parseFloat(u.style.top)+e.offsetTop+a.height/2-this.legendModule.legendBorderRect.y:parseFloat(u.style.top)+e.offsetTop+a.height/2):(w=d.bottom-g.bottom-e.offsetTop,f=parseFloat(u.style.top)+e.offsetTop);f=w<=11?f:2*f;o=w<=11?o:2*o;u.style.top=f+"px";u.style.left=o+"px";k.style.top=f+"px";k.style.left=o+"px"}for(this.arrangeTemplate(),this.annotationsModule&&"0px"!==this.width&&"0px"!==this.height&&"0%"!==this.width&&"0%"!==this.height&&this.annotationsModule.renderAnnotationElements(),this.element.style.outline="none",t=0;t<document.getElementsByTagName("path").length-1;t++)document.getElementsByTagName("path")[t].id.indexOf("shapeIndex")>-1&&(document.getElementsByTagName("path")[t].style.outline="none");this.zoomingChange();this.trigger("loaded",{maps:this,isResized:this.isResize});this.isResize=!1},i.prototype.markerSelection=function(n,t,i,r){var f={color:n.border.color,width:n.border.width/t.scale},u={opacity:n.opacity,fill:n.fill,border:f,target:i.id,cancel:!1,data:r,maps:t};s("MarkerselectionMap")?vt("MarkerselectionMap","MarkerselectionMapStyle",u):document.body.appendChild(ii("MarkerselectionMap","MarkerselectionMapStyle",u));(0===this.selectedMarkerElementId.length||n.enableMultiSelect)&&("g"===i.tagName?i.children[0].setAttribute("class","MarkerselectionMapStyle"):i.setAttribute("class","MarkerselectionMapStyle"))},i.prototype.markerInitialSelection=function(n,t,i,r,u){var o=i.selectionSettings,f,e,h;if(o.enable)for(f=0;f<i.dataSource.length;f++)e=i.dataSource[f],e.latitude===r&&e.longitude===u&&(h=this.element.id+"_LayerIndex_"+n+"_MarkerIndex_"+t+"_dataIndex_"+f,this.markerSelection(o,this,s(h),e))},i.prototype.renderArea=function(){var u=this.mapsArea.border.width,t=this.mapsArea.background,i,r;(u>0||t||this.themeStyle.areaBackgroundColor)&&(i={opacity:n.isNullOrUndefined(this.mapsArea.border.opacity)?1:this.mapsArea.border.opacity,color:this.mapsArea.border.color,width:this.mapsArea.border.width},r=new b(this.element.id+"_MapAreaBorder",t||this.themeStyle.areaBackgroundColor,i,1,this.mapAreaRect),this.svgObject.appendChild(this.renderer.drawRectangle(r)))},i.prototype.addTabIndex=function(){this.element.setAttribute("aria-label",this.description||"Maps Element");this.element.setAttribute("tabindex",this.tabIndex.toString())},i.prototype.zoomingChange=function(){var s,h,c,l,i,t,a,r,f,v,o,e;if((u(this.element.id+"_Layer_Collections")&&this.zoomModule&&(this.zoomModule.layerCollectionEle=u(this.element.id+"_Layer_Collections")),this.isTileMap&&u(this.element.id+"_Tile_SVG")&&u(this.element.id+"_tile_parent"))&&(c=u(this.element.id+"_tile_parent").getBoundingClientRect(),l=u(this.element.id+"_Tile_SVG").getBoundingClientRect(),s=c.left-l.left,h=c.top-l.top,u(this.element.id+"_Tile_SVG_Parent").style.left=s+"px",u(this.element.id+"_Tile_SVG_Parent").style.top=h+"px",i=document.getElementsByClassName("template"),!n.isNullOrUndefined(i)&&i.length>0))for(t=0;t<i.length;t++)a=i[t],a.style.left=s+"px",a.style.top=h+"px";if(this.zoomSettings.zoomFactor>=0){if(this.zoomModule&&this.zoomModule.toolBarGroup&&this.zoomSettings.enable&&this.zoomModule.alignToolBar(),r=document.getElementById(this.element.id+"_Layer_Collections"),!n.isNullOrUndefined(r)&&r.childElementCount>0)for(t=0;t<r.childNodes.length;t++)if(f=r.childNodes[t],"g"===f.tagName)for(v=parseFloat(f.id.split("_LayerIndex_")[1].split("_")[0]),o=0;o<f.childNodes.length;o++)e=f.childNodes[o],e.id.indexOf("_Markers_Group")>-1||e.id.indexOf("_bubble_Group")>-1||e.id.indexOf("_dataLableIndex_Group")>-1||br(e,v,this.scale,this);this.zoomModule&&this.previousScale!==this.scale&&this.zoomModule.applyTransform(!0)}},i.prototype.createSecondaryElement=function(){if(n.isNullOrUndefined(document.getElementById(this.element.id+"_Secondary_Element"))){var t=n.createElement("div",{id:this.element.id+"_Secondary_Element",styles:"position: absolute;z-index:2;"});this.element.appendChild(t)}},i.prototype.arrangeTemplate=function(){var e,o,i,r,s,t,h;if(document.getElementById(this.element.id+"_Legend_Border")&&(document.getElementById(this.element.id+"_Legend_Border").style.pointerEvents="none"),e=document.getElementsByClassName(this.element.id+"_template"),!n.isNullOrUndefined(e)&&e.length>0&&u(this.element.id+"_Layer_Collections")&&"OSM"!==this.layers[this.layers.length-1].layerType)for(o=0;o<e.length;o++){var c=0,l=0,f=e[o];if(!n.isNullOrUndefined(f)&&f.childElementCount>0)for(i=u(this.element.id+"_Layer_Collections").getBoundingClientRect(),r=u(f.id).getBoundingClientRect(),-1===f.id.indexOf("Marker")&&(c=this.isTileMap?0:i.left<r.left?-Math.abs(r.left-i.left):Math.abs(r.left-i.left),l=this.isTileMap?0:i.top<r.top?-Math.abs(r.top-i.top):Math.abs(r.top-i.top)),s=0;s<f.childElementCount;s++)t=f.childNodes[s],-1!==t.id.indexOf("Marker")?(h=u(t.id).getBoundingClientRect(),t.style.left=parseFloat(t.style.left)-(this.isTileMap?0:h.width/2)+"px",t.style.top=parseFloat(t.style.top)-(this.isTileMap?0:h.height/2)+"px"):(t.style.left=parseFloat(t.style.left)+c+"px",t.style.top=parseFloat(t.style.top)+l+"px",t.style.transform="translate(-50%, -50%)")}},i.prototype.createTile=function(){var t=this.layersCollection[0],i,r;t.isBaseLayer&&("OSM"===t.layerType||"Bing"===t.layerType||"GoogleStaticMap"===t.layerType||"Google"===t.layerType)&&("Google"===t.layerType&&(t.urlTemplate="https://mt1.google.com/vt/lyrs=m@129&hl=en&x=tileX&y=tileY&z=level"),l(this.element.id+"_tile_parent"),l(this.element.id+"_tiles"),l("animated_tiles"),i=n.createElement("div",{id:this.element.id+"_tile_parent",styles:"position: absolute; left: "+this.mapAreaRect.x+"px; right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;"}),r=n.createElement("div",{id:this.element.id+"_tiles",styles:"position: absolute; left: "+this.mapAreaRect.x+"px;  right: "+this.margin.right+"px; top: "+(this.mapAreaRect.y+0)+"px; height: "+this.mapAreaRect.height+"px; width: "+this.mapAreaRect.width+"px; overflow: hidden;"}),this.element.appendChild(i),this.element.appendChild(r))},i.prototype.initPrivateVariable=function(){if(""===this.element.id){var n=document.getElementsByClassName("e-maps").length;this.element.id="maps_control_"+n}this.renderer=new et.SvgRenderer(this.element.id);this.mapLayerPanel=new ye(this)},i.prototype.findBaseAndSubLayers=function(){var u=this,f=this.baseLayerIndex,t=[],r=[],n,i;for(this.layersCollection=[],Array.prototype.forEach.call(this.layers,function(n){"Layer"===n.type?t.push(n):r.push(n)}),n=0;n<t.length;n++){if(i=t[n],i.visible&&f===n){i.isBaseLayer=!0;this.isTileMap="Geometry"!==i.layerType;this.layersCollection.push(i);break}if(n===t.length-1){this.layersCollection.push(t[0]);break}}r.map(function(n){n.visible&&u.layersCollection.push(n)})},i.prototype.renderBorder=function(){var t=this.border.width,i=this.svgObject.querySelector("#"+this.element.id+"_MapBorder"),r,u;(t>0||this.background||this.themeStyle.backgroundColor)&&n.isNullOrUndefined(i)?(r={opacity:n.isNullOrUndefined(this.border.opacity)?1:this.border.opacity,color:this.border.color,width:this.border.width},u=new b(this.element.id+"_MapBorder",this.background||this.themeStyle.backgroundColor,r,1,new c(t/2,t/2,this.availableSize.width-t,this.availableSize.height-t)),this.svgObject.appendChild(this.renderer.drawRectangle(u))):i.setAttribute("fill",this.background||this.themeStyle.backgroundColor)},i.prototype.renderTitle=function(t,i,r,u){var o,e=t.textStyle,h=Math.abs(this.margin.left+this.margin.right-this.availableSize.width);if(e.fontFamily=this.themeStyle.fontFamily||e.fontFamily,e.fontWeight=e.fontWeight||this.themeStyle.titleFontWeight,e.size=this.themeStyle.titleFontSize||e.size,t.text){n.isNullOrUndefined(u)&&(u=this.renderer.createGroup({id:this.element.id+"_Title_Group"}));var y=d(h,t.text,e),l=v(y,e),s=function(n,t,i,r){var u,e;switch(t){case"Near":u=n.x;break;case"Center":u="title"===r?n.width/2-i.width/2:n.x+n.width/2-i.width/2;break;case"Far":u="title"===r?n.width-n.y-i.width:n.x+n.width-i.width}return e="title"===r?n.y+i.height/2:n.y+n.height/2+i.height/2,new f(u,e)}(n.isNullOrUndefined(r)?new c(this.margin.left,this.margin.top,this.availableSize.width,this.availableSize.height):r,t.alignment,l,i),p=new nt(this.element.id+"_Map_"+i,s.x,s.y,"start",y),a=new c(s.x,s.y,l.width,l.height);ot(p,e,e.color||("title"===i?this.themeStyle.titleFontColor:this.themeStyle.subTitleFontColor),u).setAttribute("aria-label",this.description||t.text);("title"===i&&!t.subtitleSettings.text||"subtitle"===i)&&(o=Math.abs(a.y+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new c(this.margin.left,a.y+10,h,o-10));"subtitle"!==i&&t.subtitleSettings.text?this.renderTitle(t.subtitleSettings,"subtitle",a,u):this.svgObject.appendChild(u)}else o=Math.abs(this.margin.top+this.margin.bottom-this.availableSize.height),this.mapAreaRect=new c(this.margin.left,this.margin.top,h,o)},i.prototype.createSVG=function(){this.removeSvg(),function(n){n.renderer=new et.SvgRenderer(n.element.id);n.availableSize=gi(n);n.svgObject=n.renderer.createSvg({id:n.element.id+"_svg",width:n.availableSize.width,height:n.availableSize.height});"0px"!==n.width&&"0%"!==n.width&&"0%"!==n.height&&"0px"!==n.height||(n.svgObject.setAttribute("height","0"),n.svgObject.setAttribute("width","0"))}(this)},i.prototype.removeSvg=function(){if(l(this.element.id+"_Secondary_Element"),l(this.element.id+"_tile_parent"),l(this.element.id+"_tiles"),this.svgObject){for(;this.svgObject.childNodes.length>0;)this.svgObject.removeChild(this.svgObject.firstChild);!this.svgObject.hasChildNodes()&&this.svgObject.parentNode&&n.remove(this.svgObject)}this.clearTemplate()},i.prototype.wireEVents=function(){n.EventHandler.add(this.element,"click",this.mapsOnClick,this);n.EventHandler.add(this.element,"dblclick",this.mapsOnDoubleClick,this);n.EventHandler.add(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap,this);n.EventHandler.add(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap,this);n.EventHandler.add(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap,this);n.EventHandler.add(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap,this);n.EventHandler.add(this.element,"keydown",this.keyDownHandler,this);n.EventHandler.add(this.element,"keyup",this.keyUpHandler,this);window.addEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.mapsOnResize.bind(this))},i.prototype.unWireEVents=function(){n.EventHandler.remove(this.element,"click",this.mapsOnClick);n.EventHandler.remove(this.element,"dblclick",this.mapsOnDoubleClick);n.EventHandler.remove(this.element,n.Browser.touchStartEvent,this.mouseDownOnMap);n.EventHandler.remove(this.element,n.Browser.touchMoveEvent,this.mouseMoveOnMap);n.EventHandler.remove(this.element,n.Browser.touchEndEvent,this.mouseEndOnMap);n.EventHandler.remove(this.element,"pointerleave mouseleave",this.mouseLeaveOnMap);n.EventHandler.remove(this.element,"keydown",this.keyDownHandler);n.EventHandler.remove(this.element,"keyup",this.keyUpHandler);window.removeEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.mapsOnResize)},i.prototype.mouseLeaveOnMap=function(){document.getElementsByClassName("highlightMapStyle").length>0&&this.legendModule&&(this.legendModule.removeShapeHighlightCollection(),a(document.getElementsByClassName("highlightMapStyle")[0]))},i.prototype.keyUpHandler=function(n){var t=n.target.id;"Tab"===n.code&&t.indexOf("_LayerIndex_")>-1&&t.indexOf("shapeIndex")>-1?this.keyboardHighlightSelection(t,n.type):-1===t.indexOf("_LayerIndex_")&&-1===t.indexOf("shapeIndex")&&ht("highlightMapStyle").length>0&&(a(ht("highlightMapStyle")[0]),this.legendSettings.visible&&this.legendModule&&this.legendModule.removeShapeHighlightCollection())},i.prototype.keyboardHighlightSelection=function(t,i){var r=parseInt(t.split("_LayerIndex_")[1].split("_")[0],10),u=parseInt(t.split("_shapeIndex_")[1].split("_")[0],10),f=this.layers[r].shapeData.features.length>u?this.layers[r].shapeData.features[u].properties:null,e=parseInt(t.split("_dataIndex_")[1].split("_")[0],10),o=n.isNullOrUndefined(e)?null:this.layers[r].dataSource[e];this.layers[r].selectionSettings.enable&&"keydown"===i&&this.selectionModule?(this.selectionModule.selectionsettings=this.layers[r].selectionSettings,this.selectionModule.selectionType="Shape",this.selectionModule.selectElement(event.target,r,o,f)):this.highlightModule&&this.layers[r].highlightSettings.enable&&"keyup"===i&&!event.target.classList.contains("ShapeselectionMapStyle")&&(this.highlightModule.highlightSettings=this.layers[r].highlightSettings,this.highlightModule.handleHighlight(event.target,r,o,f))},i.prototype.keyDownHandler=function(n){var t=this.zoomModule,i,r;("+"===n.key||"Equal"===n.code)&&t?t.performZoomingByToolBar("zoomin"):("-"===n.key||"Minus"===n.code)&&t?t.performZoomingByToolBar("zoomout"):82===n.keyCode&&t?t.performZoomingByToolBar("reset"):("ArrowUp"===n.code||"ArrowDown"===n.code)&&t?(n.preventDefault(),t.mouseDownLatLong.x=0,t.mouseMoveLatLong.y=this.mapAreaRect.height/7,t.panning("None",t.mouseDownLatLong.x,"ArrowUp"===n.code?-t.mouseMoveLatLong.y:t.mouseMoveLatLong.y,n),t.mouseDownLatLong.y=t.mouseMoveLatLong.y):("ArrowLeft"===n.code||"ArrowRight"===n.code)&&t?(n.preventDefault(),t.mouseDownLatLong.y=0,t.mouseMoveLatLong.x=this.mapAreaRect.width/7,t.panning("None","ArrowLeft"===n.code?-t.mouseMoveLatLong.x:t.mouseMoveLatLong.x,t.mouseDownLatLong.y,n),t.mouseDownLatLong.x=t.mouseMoveLatLong.x):"Enter"===n.code&&(i=n.target.id,(n.preventDefault(),this.legendModule&&(i.indexOf("_Left_Page_Rect")>-1||i.indexOf("_Right_Page_Rect")>-1))&&(this.legendModule.currentPage=i.indexOf("_Left_Page_")>-1?this.legendModule.currentPage-1:this.legendModule.currentPage+1,this.legendModule.legendGroup=this.renderer.createGroup({id:this.element.id+"_Legend_Group"}),this.legendModule.drawLegendItem(this.legendModule.currentPage),r=document.getElementById(this.element.id+"_Paging_Text").textContent.split("/").map(Number),i.indexOf("_Left_Page_Rect")>-1?(1!==r[0]&&n.target.focus(),n.target.style.outlineColor=r[0]-1!==r[1]?"":"transparent"):i.indexOf("_Right_Page_Rect")>-1&&(r[0]!==r[1]&&n.target.focus(),n.target.style.outlineColor=r[0]!==r[1]+1?"":"transparent"),o(this.element.id+"_Legend_Border",this.element.id)&&(o(this.element.id+"_Legend_Border",this.element.id).style.pointerEvents="none")),i.indexOf("shapeIndex")>-1&&this.keyboardHighlightSelection(i,n.type))},i.prototype.SelectedElement=function(n){var t=!1;return"ShapeselectionMapStyle"===n.getAttribute("class")&&(t=!0),t},i.prototype.mapsOnClick=function(t){var i=this,r=t.target,e=r.id,o=null,h=null,u,f;(this.mouseClickEvent={x:t.x,y:t.y},-1===r.id.indexOf("_ToolBar"))&&(u=this.getClickLocation(e,t.pageX,t.pageY,r,t.layerX,t.layerY),n.isNullOrUndefined(u)||(o=u.latitude,h=u.longitude),f={cancel:!1,name:rt,target:e,x:t.clientX,y:t.clientY,latitude:o,longitude:h,isShapeSelected:this.SelectedElement(r)},this.trigger("click",f,function(){if(r.id.indexOf("shapeIndex")>-1&&(i.mergeCluster(),s(i.element.id+"_mapsTooltip")&&i.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")>-1&&l(i.element.id+"_mapsTooltip")),i.markerModule&&(i.markerModule.markerClick(t),i.markerModule.markerClusterClick(t)),i.bubbleModule&&i.bubbleModule.bubbleClick(t),f.cancel||i.notify(rt,r),!f.cancel&&-1!==r.id.indexOf("shapeIndex")){var o=parseInt(r.id.split("_LayerIndex_")[1].split("_")[0],10),u=function(t,i,r,u){var e=function(n,t){var r,f=parseInt(n.split("_LayerIndex_")[1].split("_")[0],10),e=parseInt(n.split("_shapeIndex_")[1].split("_")[0],10),i=t.layersCollection[f],u=i.layerData[e].property;return i.dataSource&&(r=i.dataSource[st(i.dataSource,u,i.shapeDataPath,i.shapePropertyPath)]),{shapeData:u,data:r}}(t,r),o={color:i.border.color,opacity:i.border.opacity,width:i.border.width},f=i.enableMultiSelect?{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r,shapeDataCollection:r.shapeSelectionItem}:{cancel:!1,name:u,fill:i.fill,opacity:i.opacity,border:o,shapeData:e.shapeData,data:e.data,target:t,maps:r};return r.trigger(u,f,function(){f.border.opacity=n.isNullOrUndefined(f.border.opacity)?f.opacity:f.border.opacity}),f}(e,i.layers[o].selectionSettings,i,"shapeSelected");u.cancel||!i.selectionModule||n.isNullOrUndefined(i.shapeSelected)?u.cancel&&i.selectionModule&&n.isNullOrUndefined(u.data)&&(a(r),i.selectionModule.removedSelectionList(r)):vt(i.selectionModule.selectionType+"selectionMap",i.selectionModule.selectionType+"selectionMapStyle",u)}}))},i.prototype.getClickLocation=function(n,t,i,r,u,f){var e,o=0,h,c,l;if(-1===n.indexOf("_LayerIndex_")||this.isTileMap||parseInt(this.mouseDownEvent.x)!==parseInt(this.mouseClickEvent.x)||parseInt(this.mouseDownEvent.y)!==parseInt(this.mouseClickEvent.y))this.isTileMap&&parseInt(this.mouseDownEvent.x)===parseInt(this.mouseClickEvent.x)&&parseInt(this.mouseDownEvent.y)===parseInt(this.mouseClickEvent.y)&&(e=this.getTileGeoLocation(u,f));else if(o=parseFloat(n.split("_LayerIndex_")[1].split("_")[0]),"Normal"===this.layers[o].geometryType)if(n.indexOf("_shapeIndex_")>-1){var s=hi(t,i,r.parentElement),a=Math.abs(-this.baseMapBounds.longitude.min*this.mapLayerPanel.currentFactor),v=Math.abs(this.baseMapBounds.latitude.max*this.mapLayerPanel.currentFactor);e={latitude:Math.abs(this.baseMapBounds.latitude.max-s.y/this.mapLayerPanel.currentFactor),longitude:Math.abs(s.x/this.mapLayerPanel.currentFactor+this.baseMapBounds.longitude.min)};this.baseMapBounds.longitude.min<0&&a>s.x&&(e.longitude=-e.longitude);this.baseMapBounds.latitude.min<0&&v>s.y&&(e.latitude=-e.latitude)}else n.indexOf("_MarkerIndex_")>-1&&this.markerModule?(h=parseInt(n.split("_MarkerIndex_")[1].split("_")[0],10),c=parseInt(n.split("_dataIndex_")[1].split("_")[0],10),isNaN(h)||isNaN(c)?e={latitude:null,longitude:null}:(l=this.layers[o].markerSettings[h].dataSource[c],e={latitude:l.latitude,longitude:l.longitude})):e={latitude:null,longitude:null};else e=this.getGeoLocation(o,u,f);return e},i.prototype.mouseEndOnMap=function(t){var i,r,e,u=t.target,o=u.id,s=null,h=null,f,c;return(this.element.getBoundingClientRect(),t.target,-1!==t.type.indexOf("touch")?(this.isTouch=!0,i=(e=t).changedTouches[0].pageX,r=e.changedTouches[0].pageY,e.target,this.mouseClickEvent={x:i,y:r}):(this.isTouch="touch"===t.pointerType,i=t.pageX,r=t.pageY,t.target),this.isTouch)&&(-1===u.id.indexOf("_ToolBar")&&(f=this.getClickLocation(o,i,r,u,i,r),n.isNullOrUndefined(f)||(s=f.latitude,h=f.longitude),c={cancel:!1,name:rt,target:o,x:t.clientX,y:t.clientY,latitude:s,longitude:h,isShapeSelected:this.SelectedElement(u)},this.trigger("click",c,function(){})),this.titleTooltip(t,i,r,!0),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)),this.notify(n.Browser.touchEndEvent,t),t.cancelable&&t.preventDefault(),!1},i.prototype.mouseDownOnMap=function(t){var i,r;this.mouseDownEvent={x:t.x,y:t.y};-1!==t.type.indexOf("touch")&&t.changedTouches&&(this.mouseDownEvent={x:t.changedTouches[0].pageX,y:t.changedTouches[0].pageY});this.element.getBoundingClientRect();i=t.target;-1===i.id.indexOf("_ToolBar")&&(r=this.markerModule,(i.id.indexOf("shapeIndex")>-1||i.id.indexOf("Tile")>-1)&&this.mergeCluster(),r&&(r.markerClick(t),r.markerClusterClick(t)),this.bubbleModule&&this.bubbleModule.bubbleClick(t));this.notify(n.Browser.touchStartEvent,t)},i.prototype.mergeCluster=function(){this.markerModule&&this.markerModule.sameMarkerData.length>0&&(!this.zoomModule||this.zoomModule.isSingleClick)&&(er(this.markerModule.sameMarkerData,this,s(this.element.id+"_Markers_Group")),this.markerModule.sameMarkerData=[])},i.prototype.mapsOnDoubleClick=function(n){var e;this.notify("dblclick",n);var t,i=n.target,o=i.id,f=0,r=null,u=null;-1===i.id.indexOf("_ToolBar")&&(-1===i.id.indexOf("_LayerIndex_")||this.isTileMap||this.mouseDownEvent.x!==n.clientX||this.mouseDownEvent.y!==n.clientY?this.isTileMap&&this.mouseDownEvent.x===n.clientX&&this.mouseDownEvent.y===n.clientY&&(r=(t=this.getTileGeoLocation(n.layerX,n.layerY)).latitude,u=t.longitude):(f=parseFloat(i.id.split("_LayerIndex_")[1].split("_")[0]),r=(t=this.getGeoLocation(f,n.layerX,n.layerY)).latitude,u=t.longitude),e={cancel:!1,name:"doubleClick",x:n.clientX,y:n.clientY,target:o,latitude:r,longitude:u,isShapeSelected:null},this.trigger("doubleClick",e))},i.prototype.mouseMoveOnMap=function(t){t.type;t.target;this.markerModule&&(this.markerModule.markerMove(t),this.markerModule.markerClusterMouseMove(t));this.bubbleModule&&this.bubbleModule.bubbleMove(t);this.onMouseMove(t);this.notify(n.Browser.touchMoveEvent,t)},i.prototype.onMouseMove=function(t){return t.target,this.isTouch||(this.titleTooltip(t,t.pageX,t.pageY),n.isNullOrUndefined(this.legendModule)||this.legendTooltip(t,t.pageX,t.pageY,!0)),!1},i.prototype.legendTooltip=function(n,t,i,r){var h,c,e=n.target.id,o=this.legendModule.currentPage,u=n.target.id.split("_Index_")[1],a,f;for(o=this.legendModule.totalPages.length<=this.legendModule.currentPage?this.legendModule.totalPages.length-1:this.legendModule.currentPage<0?0:this.legendModule.currentPage,a=0!==this.legendModule.totalPages.length?this.legendModule.totalPages[o].Collection.length:this.legendModule.totalPages.length,f=0;f<a;f++)h=(c=this.legendModule.totalPages[o].Collection[f]).DisplayText,e=n.target.id,u=n.target.id.split("_Index_")[1],e===this.element.id+"_Legend_Text_Index_"+u&&n.target.textContent.indexOf("...")>-1&&c.idIndex===parseInt(u,10)&&pi(h,this.legendSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Legend_Text_Tooltip",s(this.element.id+"_Secondary_Element"),r);e!==this.element.id+"_Legend_Text_Index_"+u&&l(this.element.id+"_EJ2_Legend_Text_Tooltip")},i.prototype.titleTooltip=function(n,t,i,r){var u=n.target.id;u===this.element.id+"_LegendTitle"&&n.target.textContent.indexOf("...")>-1?pi(this.legendSettings.title.text,this.legendSettings.titleStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_LegendTitle_Tooltip",s(this.element.id+"_Secondary_Element"),r):l(this.element.id+"_EJ2_LegendTitle_Tooltip");u===this.element.id+"_Map_title"&&n.target.textContent.indexOf("...")>-1?pi(this.titleSettings.text,this.titleSettings.textStyle.size,t,i,this.element.offsetWidth,this.element.offsetHeight,this.element.id+"_EJ2_Title_Tooltip",s(this.element.id+"_Secondary_Element"),r):l(this.element.id+"_EJ2_Title_Tooltip")},i.prototype.mapsOnResize=function(){var t=this,i;return this.isResize=this.isReset=!0,i={cancel:!1,name:au,previousSize:this.availableSize,currentSize:gi(this),maps:this},this.trigger(au,i),i.cancel||(this.resizeTo&&clearTimeout(this.resizeTo),!n.isNullOrUndefined(this.element)&&this.element.classList.contains("e-maps")&&(this.resizeTo=setTimeout(function(){t.unWireEVents();t.createSVG();t.refreshing=!0;t.wireEVents();t.render()},500))),!1},i.prototype.zoomByPosition=function(t,i){var r,o=this.mapLayerPanel.calculateFactor(this.layersCollection[0]),u=this.mapAreaRect;if(!this.isTileMap&&this.zoomModule)if(n.isNullOrUndefined(t))r={x:u.width/2,y:u.height/2},this.zoomModule.performZooming(r,i,i>this.scale?"ZoomIn":"ZoomOut");else{r=y(t.latitude,t.longitude,o,this.layersCollection[0],this);var f=document.getElementById(this.element.id+"_Layer_Collections").getBoundingClientRect(),e=this.svgObject.getBoundingClientRect(),s=Math.abs(f.left-e.left)/this.scale,h=Math.abs(f.top-e.top)/this.scale,c=this.translatePoint.x+s,l=this.translatePoint.y+h;this.scale=i;this.translatePoint.x=((f.left<e.left?c:0)+u.width/2-r.x*i)/i;this.translatePoint.y=((f.top<e.top?l:0)+u.height/2-r.y*i)/i;this.zoomModule.applyTransform()}else this.zoomModule&&(this.tileZoomLevel=i,this.tileTranslatePoint=this.mapLayerPanel.panTileMap(this.availableSize.width,this.availableSize.height,{x:t.longitude,y:t.latitude}),this.mapLayerPanel.generateTiles(i,this.tileTranslatePoint,null,new ef(this)))},i.prototype.panByDirection=function(n,t){var i=0,r=0;switch(n){case"Left":i=-this.mapAreaRect.width/7;break;case"Right":i=this.mapAreaRect.width/7;break;case"Top":r=-this.mapAreaRect.height/7;break;case"Bottom":r=this.mapAreaRect.height/7}this.zoomModule&&this.zoomModule.panning(n,i,r,t)},i.prototype.addLayer=function(n){this.layers.push(new cu(this.layers[0],"layers",n));this.refresh()},i.prototype.removeLayer=function(n){this.layers.splice(n,1);this.refresh()},i.prototype.addMarker=function(n,t){var u=document.getElementById(this.element.id+"_LayerIndex_"+n),i,r,f;if(t.length>0&&u){for(i=0,r=t;i<r.length;i++)f=r[i],this.layersCollection[n].markerSettings.push(new hu(this,"markerSettings",f));new lu(this).markerRender(u,n,this.mapLayerPanel.currentFactor,"AddMarker");this.arrangeTemplate()}},i.prototype.shapeSelection=function(t,i,r,u){var f,d,l=Array.isArray(i)?i:Array(i),o,e,h,y,nt,k;if(n.isNullOrUndefined(u)&&(u=!0),o=this.layers[t].selectionSettings,!o.enableMultiSelect&&this.legendSelection&&u&&this.removeShapeSelection(),"SubLayer"===this.layers[t].type)for(e=0;e<this.layersCollection.length;e++)if(this.layersCollection[e].shapeData===this.layers[t].shapeData){d=e;break}if(o.enable){var p=void 0,w=void 0,b=void 0,g=void 0,v=void 0,c=this.layers[t].shapeData.features;for(e=0;e<c.length;e++)for(h=0;h<l.length;h++)if(y=void 0,(!n.isNullOrUndefined(c[e].properties[l[h]])&&isNaN(c[e].properties[l[h]])?c[e].properties[l[h]].toLowerCase():c[e].properties[l[h]])===(n.isNullOrUndefined(r)?r:r.toLowerCase()))if(n.isNullOrUndefined(this.layers[t].shapeSettings.colorValuePath)||(y=st(this.layers[t].dataSource,c[e].properties,this.layers[t].shapeDataPath,this.layers[t].shapePropertyPath,this.layers[t])),nt=this.layers[t],this.baseLayerIndex>=0&&nt.isBaseLayer?b=0:"SubLayer"===this.layers[t].type&&(b=d),f=s(this.element.id+"_LayerIndex_"+b+"_shapeIndex_"+e+"_dataIndex_"+y),n.isNullOrUndefined(y)&&n.isNullOrUndefined(f)&&(f=s(this.element.id+"_LayerIndex_"+t+"_shapeIndex_"+e+"_dataIndex_null")),w=parseInt(f.id.split("_shapeIndex_")[1].split("_")[0],10),g=this.layers[t].shapeData.features.length>w?this.layers[t].shapeData.features[w].properties:null,p=parseInt(f.id.split("_dataIndex_")[1].split("_")[0],10),v=n.isNullOrUndefined(p)?null:this.layers[t].dataSource[p],u){if(af(o,this,f,g,v),this.shapeSelectionClass=s("ShapeselectionMap"),this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&this.legendModule.shapeHighLightAndSelection(f,v,o,"selection",t),(!this.legendSettings.visible||this.legendModule.shapeToggled)&&(f.setAttribute("class","ShapeselectionMapStyle"),-1===this.selectedElementId.indexOf(f.getAttribute("id"))&&this.selectedElementId.push(f.getAttribute("id")),!o.enableMultiSelect))return}else(this.legendSelection=!o.enableMultiSelect&&!this.legendSelection||this.legendSelection,this.legendSettings.visible&&-1===f.id.indexOf("_MarkerIndex_")&&"ShapeselectionMapStyle"===f.getAttribute("class")&&this.legendModule.shapeHighLightAndSelection(f,v,o,"selection",t),!this.legendSettings.visible||this.legendModule.shapeToggled)&&(a(f),k=this.selectedElementId.indexOf(f.getAttribute("id")),-1!==k&&(this.selectedElementId.splice(k,1),!o.enableMultiSelect&&this.legendSelection&&this.selectedElementId.length>0&&this.removeShapeSelection()))}},i.prototype.zoomToCoordinates=function(t,i,r,u){var o,s,f,e,h=!1,c;(n.isNullOrUndefined(r)&&n.isNullOrUndefined(u)||n.isNullOrUndefined(t)&&n.isNullOrUndefined(i))&&(t=n.isNullOrUndefined(t)?0:t,i=n.isNullOrUndefined(t)?0:i,r=n.isNullOrUndefined(r)?t:r,u=n.isNullOrUndefined(u)?i:u,h=!0);t>r&&(t=(o=[r,t])[0],r=o[1]);i>u&&(i=(s=[u,i])[0],u=s[1]);h?(f=t+r,e=i+u):(f=(t+r)/2,e=(i+u)/2);this.centerLatOfGivenLocation=f;this.centerLongOfGivenLocation=e;this.minLatOfGivenLocation=t;this.minLongOfGivenLocation=i;this.maxLatOfGivenLocation=r;this.maxLongOfGivenLocation=u;this.zoomNotApplied=!0;this.scaleOfGivenLocation=eu(t,r,i,u,this.mapAreaRect.width,this.mapAreaRect.height,this);c={cancel:!1,name:"zoom",type:"zoomIn",maps:this,tileTranslatePoint:{},translatePoint:{},tileZoomLevel:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{},scale:this.isTileMap?{previous:this.tileZoomLevel,current:this.scaleOfGivenLocation}:{previous:this.scale,current:this.scaleOfGivenLocation}};this.trigger("zoom",c);this.refresh()},i.prototype.removeShapeSelection=function(){for(var i,t=this.selectedElementId.length,n=0;n<t;n++)a(u(this.selectedElementId[0])),this.selectedElementId.splice(0,1);if(this.legendSettings.visible)for(i=this.legendSelectionCollection.length,n=0;n<i;n++)a(u(this.legendSelectionCollection[n].legendElement.id)),this.selectedLegendElementId.splice(0,1);this.shapeSelectionItem=[];this.legendSelectionCollection=[]},i.prototype.setCulture=function(){this.intl=new n.Internationalization;this.setLocaleConstants();this.localeObject=new n.L10n(this.getModuleName(),this.defaultLocalConstants,this.locale)},i.prototype.setLocaleConstants=function(){this.defaultLocalConstants={ZoomIn:"Zoom in",Zoom:"Zoom",ZoomOut:"Zoom out",Pan:"Pan",Reset:"Reset"}},i.prototype.destroy=function(){this.unWireEVents();this.shapeSelectionItem=[];this.toggledShapeElementId=[];this.toggledLegendId=[];this.legendSelectionCollection=[];this.selectedLegendElementId=[];this.selectedNavigationElementId=[];this.selectedBubbleElementId=[];this.selectedMarkerElementId=[];this.selectedElementId=[];this.dataLabelShape=[];this.zoomShapeCollection=[];this.zoomLabelPositions=[];this.mouseDownEvent={x:null,y:null};this.mouseClickEvent={x:null,y:null};document.getElementById("mapsmeasuretext")&&document.getElementById("mapsmeasuretext").remove();this.removeSvg();t.prototype.destroy.call(this)},i.prototype.getModuleName=function(){return"maps"},i.prototype.getPersistData=function(){return this.addOnPersist(["translatePoint","zoomSettings","mapScaleValue","tileTranslatePoint","baseTranslatePoint","scale","zoomPersistence","defaultState","markerZoomedState","initialCheck","initialZoomLevel","initialTileTranslate","applyZoomReset","markerZoomFactor"])},i.prototype.onPropertyChanged=function(i,r){var u=!1,v=!1,y=!1,p,e,s,h,w,f,o,c,a;for(i.layers&&(p=Object.keys(i.layers).length,document.getElementById(this.element.id+"_LayerIndex_"+(p-1))),e=0,s=Object.keys(i);e<s.length;e++){h=s[e];switch(h){case"background":this.renderBorder();break;case"height":case"width":case"layers":case"projectionType":case"centerPosition":case"legendSettings":case"baseLayerIndex":if("layers"===h)for(w=Object.keys(i.layers).length,f=0;f<w;f++)if(!n.isNullOrUndefined(i.layers[f]))for(o=0,c=Object.keys(i.layers[f]);o<c.length;o++)a=c[o],"markerSettings"===a?v=!0:"staticMapType"===a&&(y=!0);u=!0;break;case"zoomSettings":n.isNullOrUndefined(r.zoomSettings)||(i.zoomSettings.zoomFactor!==r.zoomSettings.zoomFactor?u=!1:i.zoomSettings.shouldZoomInitially!==r.zoomSettings.shouldZoomInitially||i.zoomSettings.enable!==r.zoomSettings.enable?(this.zoomSettings.zoomFactor=1,u=!0):u=!0);break;case"locale":case"currencyCode":t.prototype.refresh.call(this)}}u&&(i.layers&&v?(l(this.element.id+"_Markers_Group"),this.isTileMap?this.mapLayerPanel.renderTileLayer(this.mapLayerPanel,this.layers.currentFactor,this.layers.length-1):this.render()):i.layers&&y?this.mapLayerPanel.renderGoogleMap(this.layers[this.layers.length-1].key,this.staticMapZoom):(this.createSVG(),this.renderElements()))},i.prototype.requiredModules=function(){var n=[],t=this.findVisibleLayers(this.layers),i=!1;return this.annotations.map(function(n){i=null!=n.content}),this.isBubbleVisible()&&n.push({member:"Bubble",args:[this]}),t.highlight&&n.push({member:"Highlight",args:[this]}),t.selection&&n.push({member:"Selection",args:[this]}),this.legendSettings.visible&&n.push({member:"Legend",args:[this]}),(this.zoomSettings.enable||this.zoomSettings.zoomFactor>this.zoomSettings.minZoom)&&n.push({member:"Zoom",args:[this]}),this.isMarkersVisible()&&n.push({member:"Marker",args:[this]}),this.isDataLabelVisible()&&n.push({member:"DataLabel",args:[this]}),this.isNavigationVisible()&&n.push({member:"NavigationLine",args:[this]}),t.tooltip&&n.push({member:"MapsTooltip",args:[this]}),i&&n.push({member:"Annotations",args:[this,sf]}),this.allowPrint&&n.push({member:"Print",args:[this]}),this.allowImageExport&&n.push({member:"ImageExport",args:[this]}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this]}),n},i.prototype.isMarkersVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.markerSettings.length;i++)if(t.markerSettings[i].visible){n=!0;break}}),n},i.prototype.isDataLabelVisible=function(){for(var t=!1,n=0;n<this.layers.length;n++)if(this.layers[n].dataLabelSettings.visible){t=!0;break}return t},i.prototype.isNavigationVisible=function(){var n=!1;return Array.prototype.forEach.call(this.layers,function(t){for(var i=0;i<t.navigationLineSettings.length;i++)if(t.navigationLineSettings[i].visible){n=!0;break}}),n},i.prototype.getExtraPosition=function(){var e=0,o=0,h=s(this.element.id+"_svg"),t,i,r,u;return n.isNullOrUndefined(h)||(t=h.getClientRects(),i=s(this.element.id+"_Secondary_Element").getClientRects(),0!==t.length&&0!==i.length&&(r=t[0],u=i[0],e=r.top-u.top,o=r.left-u.left)),new f(o,e)},i.prototype.isBubbleVisible=function(){for(var r,t=!1,n=0,i=this.layers;n<i.length;n++)if(r=i[n],this.getBubbleVisible(r)){t=!0;break}return t},i.prototype.getBubbleVisible=function(n){for(var i=!1,t=0,r=n.bubbleSettings;t<r.length;t++)if(r[t].visible){i=!0;break}return i},i.prototype.print=function(n){this.allowPrint&&this.printModule&&this.printModule.print(n)},i.prototype.export=function(t,i,r,u){var f=this;return n.isNullOrUndefined(u)&&(u=!0),"PDF"!==t&&this.allowImageExport&&this.imageExportModule?new Promise(function(n){n(f.imageExportModule.export(t,i,u))}):this.allowPdfExport&&this.pdfExportModule?new Promise(function(n){n(f.pdfExportModule.export(t,i,u,r))}):null},i.prototype.findVisibleLayers=function(n,t,i,r,u,f){var k,d,h,y,e,c,p,l,a,w,o,v,b,s;for(void 0===t&&(t=!1),void 0===i&&(i=!1),void 0===r&&(r=!1),void 0===u&&(u=!1),void 0===f&&(f=!1),h=0,y=n;h<y.length;h++){if(e=y[h],t=e.visible||t,e.visible){for(k=e.bubbleSettings,d=e.markerSettings,c=0,p=e.navigationLineSettings;c<p.length;c++)l=p[c],l.visible&&(u=l.highlightSettings.enable||u,f=l.selectionSettings.enable||f);for(a=0,w=d;a<w.length;a++)if(o=w[a],o.visible&&(r=o.tooltipSettings.visible||r,u=o.selectionSettings.enable||u,f=o.highlightSettings.enable||f),r)break;for(v=0,b=k;v<b.length;v++)if(s=b[v],s.visible&&(r=s.tooltipSettings.visible||r,u=s.selectionSettings.enable||u,f=s.highlightSettings.enable||f),r)break;r=e.tooltipSettings.visible||r;u=e.selectionSettings.enable||u;f=e.highlightSettings.enable||f}if(t&&i&&r)break}return{layer:t,bubble:i,tooltip:r,selection:u,highlight:f}},i.prototype.getGeoLocation=function(n,t,i){var u=document.getElementById(this.element.id),e=t-u.offsetLeft,o=i-u.offsetTop,f=ut(this,this.layersCollection[n],!1).location,s=f.x*this.scale,h=f.y*this.scale,r=Math.min(this.mapAreaRect.height,this.mapAreaRect.width)*this.mapLayerPanel.currentFactor*this.scale,c=this.clip(e-s,0,r-1)/r-.5,l=.5-this.clip(o-h,0,r-1)/r;return{latitude:90-360*Math.atan(Math.exp(2*-l*Math.PI))/Math.PI,longitude:360*c}},i.prototype.clip=function(n,t,i){return Math.min(Math.max(n,t),i)},i.prototype.getTileGeoLocation=function(n,t){var i=document.getElementById(this.element.id),r=document.getElementById(this.element.id+"_tile_parent"),u=this.pointToLatLong(n+this.mapAreaRect.x-(r.offsetLeft-i.offsetLeft),t+this.mapAreaRect.y-(r.offsetTop-i.offsetTop));return{latitude:u.latitude,longitude:u.longitude}},i.prototype.pointToLatLong=function(n,t){var r="GoogleStaticMap"===this.layers[this.layers.length-1].layerType?0:10;t=this.zoomSettings.enable?t+r:t;var i=256*Math.pow(2,this.tileZoomLevel),u=this.clip(n-this.translatePoint.x*this.scale,0,i-1)/i-.5,f=.5-this.clip(t-this.translatePoint.y*this.scale,0,i-1)/i;return{latitude:90-360*Math.atan(Math.exp(2*-f*Math.PI))/Math.PI,longitude:360*u}},r([n.Property(null)],i.prototype,"background",void 0),r([n.Property(!1)],i.prototype,"useGroupingSeparator",void 0),r([n.Property(null)],i.prototype,"format",void 0),r([n.Property(null)],i.prototype,"width",void 0),r([n.Property(null)],i.prototype,"height",void 0),r([n.Property("MouseMove")],i.prototype,"tooltipDisplayMode",void 0),r([n.Property(!1)],i.prototype,"allowPrint",void 0),r([n.Property(!1)],i.prototype,"allowImageExport",void 0),r([n.Property(!1)],i.prototype,"allowPdfExport",void 0),r([n.Complex({},ee)],i.prototype,"titleSettings",void 0),r([n.Complex({},oe)],i.prototype,"zoomSettings",void 0),r([n.Complex({},se)],i.prototype,"legendSettings",void 0),r([n.Collection([],cu)],i.prototype,"layers",void 0),r([n.Collection([],wf)],i.prototype,"annotations",void 0),r([n.Complex({},df)],i.prototype,"margin",void 0),r([n.Complex({color:"#DDDDDD",width:0},k)],i.prototype,"border",void 0),r([n.Property("Material")],i.prototype,"theme",void 0),r([n.Property("Mercator")],i.prototype,"projectionType",void 0),r([n.Property(0)],i.prototype,"baseLayerIndex",void 0),r([n.Property(null)],i.prototype,"description",void 0),r([n.Property(1)],i.prototype,"tabIndex",void 0),r([n.Complex({latitude:null,longitude:null},kf)],i.prototype,"centerPosition",void 0),r([n.Complex({},ae)],i.prototype,"mapsArea",void 0),r([n.Event()],i.prototype,"load",void 0),r([n.Event()],i.prototype,"beforePrint",void 0),r([n.Event()],i.prototype,"loaded",void 0),r([n.Event()],i.prototype,"click",void 0),r([n.Event()],i.prototype,"doubleClick",void 0),r([n.Event()],i.prototype,"rightClick",void 0),r([n.Event()],i.prototype,"resize",void 0),r([n.Event()],i.prototype,"tooltipRender",void 0),r([n.Event()],i.prototype,"legendRendering",void 0),r([n.Event()],i.prototype,"tooltipRenderComplete",void 0),r([n.Event()],i.prototype,"shapeSelected",void 0),r([n.Event()],i.prototype,"itemSelection",void 0),r([n.Event()],i.prototype,"itemHighlight",void 0),r([n.Event()],i.prototype,"shapeHighlight",void 0),r([n.Event()],i.prototype,"layerRendering",void 0),r([n.Event()],i.prototype,"shapeRendering",void 0),r([n.Event()],i.prototype,"markerRendering",void 0),r([n.Event()],i.prototype,"markerClusterRendering",void 0),r([n.Event()],i.prototype,"markerClick",void 0),r([n.Event()],i.prototype,"markerClusterClick",void 0),r([n.Event()],i.prototype,"markerClusterMouseMove",void 0),r([n.Event()],i.prototype,"markerMouseMove",void 0),r([n.Event()],i.prototype,"dataLabelRendering",void 0),r([n.Event()],i.prototype,"bubbleRendering",void 0),r([n.Event()],i.prototype,"bubbleClick",void 0),r([n.Event()],i.prototype,"bubbleMouseMove",void 0),r([n.Event()],i.prototype,"animationComplete",void 0),r([n.Event()],i.prototype,"annotationRendering",void 0),r([n.Event()],i.prototype,"zoom",void 0),r([n.Event()],i.prototype,"pan",void 0),r([n.NotifyPropertyChanges],i)}(n.Component),we=function(){function t(n){this.id="";this.maps=n;this.bubbleCollection=[]}return t.prototype.renderBubble=function(t,i,r,u,f,o,s,h,l,a){var ot,yt,p=this,d=h.layerData,g=t.colorValuePath,ii=n.isNullOrUndefined(g)?i[g]:g.indexOf(".")>-1?e(i,t.colorValuePath):i[g],ri=n.isNullOrUndefined(g)?Number(i[g]):g.indexOf(".")>-1?Number(e(i,t.colorValuePath)):Number(i[g]),ui=n.isNullOrUndefined(t.valuePath)?Number(i[t.valuePath]):t.valuePath.indexOf(".")>-1?Number(e(i,t.valuePath)):Number(i[t.valuePath]),rt,pt,fi,st,ei,wt,w,it,y,nt,ft,ti,lt,et;if(isNaN(ui)&&isNaN(ri)&&n.isNullOrUndefined(ii))return null;w=(rt=t.minRadius,pt=t.maxRadius,fi=ui,st=u.min,wt=(pt-rt)/100*100/((ei=u.max)-st)*(fi-st)+rt,ei===st&&(wt=(pt-rt)/100+rt),wt);it=new of(this.maps).getColorByValue(t.colorMapping,ri,ii);yt="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.fill)?r:it.fill;ot="[object Object]"!==Object.prototype.toString.call(it)||n.isNullOrUndefined(it.opacity)?t.opacity:it.opacity;y=[[]];this.maps.translateType="bubble";for(var kt=0,ht=0,ct=0,k=0,hi=d.length;k<hi;k++)if(nt=d[k],nt=nt.property,ft=ni(i[h.shapeDataPath],h.shapePropertyPath,nt),(!n.isNullOrUndefined(i[h.shapeDataPath])&&isNaN(i[h.shapeDataPath])?i[h.shapeDataPath].toLowerCase():i[h.shapeDataPath])===(!n.isNullOrUndefined(nt[ft])&&isNaN(nt[ft])?nt[ft].toLowerCase():nt[ft])&&"LineString"!==d[k].type)if("Point"===d[k].type)y.push(this.getPoints(d[k],[]));else if(d[k]._isMultiPolygon)for(ti=d[k],lt=0;lt<ti.length;lt++)y.push(this.getPoints(ti[lt],[])),ht<(ct=y[y.length-1].length)&&(ht=ct,kt=y.length-1);else y.push(this.getPoints(d[k],[])),ht<(ct=y[y.length-1].length)&&(ht=ct,kt=y.length-1);var oi,v,ci=this.maps.projectionType,si={color:t.border.color,opacity:t.border.opacity,width:t.border.width},vt=yi(y[kt],ci,h.geometryType);if(t.visible){if(n.isNullOrUndefined(vt)){if(et=y.length-1,!y[et].x||!y[et].y)return;v={cancel:!1,name:du,border:si,cx:y[et].x,cy:y[et].y,data:i,fill:yt,maps:this.maps,radius:w}}else oi="Mercator"===this.maps.projectionType?vt.y:-vt.y,v={cancel:!1,name:du,border:si,cx:vt.x,cy:oi,data:i,fill:yt,maps:this.maps,radius:w};this.maps.trigger("bubbleRendering",v,function(){var i,u,y,k,d,e,it;if(!v.cancel){(v.border.opacity=n.isNullOrUndefined(v.border.opacity)?ot:v.border.opacity,"Circle"===t.bubbleType)?(y=new bt(a,v.fill,v.border,ot,0,0,v.radius,null),i=function(n,t,i){return gt(n.renderer.drawCircle(t),i)}(p.maps,y,l)):(k="Mercator"===p.maps.projectionType?v.cy-w:v.cy+w,d=new b(a,v.fill,v.border,ot,new c(0,0,2*w,2*w),2,2),v.cx-=w,v.cy=k,i=function(n,t,i){return gt(n.renderer.drawRectangle(t),i)}(p.maps,d,l));dt(p.maps.selectedBubbleElementId,p.maps.bubbleSelectionClass,i,"BubbleselectionMapStyle");p.bubbleCollection.push({LayerIndex:s,BubbleIndex:f,DataIndex:o,element:i,center:{x:v.cx,y:v.cy}});e=0!==h.animationDuration||n.isNullOrUndefined(p.maps.zoomModule);u=p.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(p.maps.zoomModule)?at(p.maps,h,e):ut(p.maps,h,e);var rt=t.dataSource,g=u.scale,nt=u.location,r=new tt(p.maps.isTileMap?v.cx:(v.cx+nt.x)*g,p.maps.isTileMap?v.cy:(v.cy+nt.y)*g);i.setAttribute("transform","translate( "+r.x+" "+r.y+" )");it=rt.length-1===o?"bubble":null;"Square"===t.bubbleType?(r.x+=w,r.y+=w*("Mercator"===p.maps.projectionType?1:-1)):w=0;t.animationDuration>0&&pr(i,t.animationDelay,t.animationDuration,r,p.maps,it,w)}})}},t.prototype.getPoints=function(t,i){return n.isNullOrUndefined(t.map)?i=t.point:t.map(function(n){i.push(new f(n.point.x,n.point.y))}),i},t.prototype.bubbleClick=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:gu,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(gu,u)))},t.prototype.getbubble=function(n){var t=n.split("_LayerIndex_"),u=parseInt(t[1].split("_")[0],10),f=this.maps.layers[u],i,r;return n.indexOf("_BubbleIndex_")>-1&&(i=parseInt(t[1].split("_BubbleIndex_")[1],10),r=parseInt(t[1].split("_BubbleIndex_")[1].split("_dataIndex_")[1],10),!isNaN(i))?f.bubbleSettings[i].dataSource[r]:null},t.prototype.bubbleMove=function(t){var i=t.target.id,r,u;-1!==i.indexOf("_LayerIndex_")&&(r=this.getbubble(i),n.isNullOrUndefined(r)||(u={cancel:!1,name:nf,data:r,maps:this.maps,target:i,x:t.clientX,y:t.clientY},this.maps.trigger(nf,u)))},t.prototype.getModuleName=function(){return"Bubble"},t.prototype.destroy=function(){},t}(),be=function(){function t(n){this.value={rightWidth:0,leftWidth:0,heightTop:0,heightBottom:0};this.maps=n;this.dataLabelCollections=[]}return t.prototype.getDataLabel=function(t,i,r,u){for(var o,f,s,e=0;e<t.length;e++)if(f=t[e],s=!n.isNullOrUndefined(f[u])&&isNaN(f[u])?f[u].toLowerCase():f[u],r=n.isNullOrUndefined(r)?r:r.toString(),s===(n.isNullOrUndefined(r)?r:r.toLowerCase())){o=f;break}return o},t.prototype.renderLabel=function(t,i,r,u,e,o,s,h){var ui,st,kt,g,fi,a,ei,ai,l=this,lt=t.dataLabelSettings,it=t.dataLabelSettings.textStyle,ft=t.dataLabelSettings,ni=t.dataLabelSettings.labelPath,p=[[]],ht=0,yt=0,rt=r,y="",pt=0,oi=!1,gi=r.properties,vt=this.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_LabelIndex_"+s,tt=new f(0,0),vi=u[s],et,ri,li,dt,gt,k;it.fontFamily="material"!==this.maps.theme.toLowerCase()?this.maps.themeStyle.labelFontFamily:it.fontFamily;r=vi.property;var si,pi,hi="[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)?t.shapePropertyPath:[t.shapePropertyPath],ci=!1,wi=0!==t.animationDuration||n.isNullOrUndefined(this.maps.zoomModule),bi=this.maps.isTileMap?{}:this.maps.zoomSettings.zoomFactor>1&&!n.isNullOrUndefined(this.maps.zoomModule)?at(this.maps,t,wi):ut(this.maps,t,wi),w=this.maps.isTileMap?this.maps.scale:bi.scale,ct=this.maps.isTileMap?this.maps.translatePoint:bi.location,ii=this.maps.zoomTranslatePoint,wt=n.isNullOrUndefined(this.maps.scale)?1:Math.floor(this.maps.scale),bt=this.maps.zoomSettings.enable?!n.isNullOrUndefined(this.maps.zoomShapeCollection)&&this.maps.zoomShapeCollection.length>0:this.maps.zoomSettings.enable;for(this.maps.translateType="labels",et=0;et<hi.length&&!(gi[hi[et]]&&(si=hi[et],g=this.getDataLabel(t.dataSource,t.shapeDataPath,rt.properties[si],t.shapeDataPath)));et++);if(g=this.getDataLabel(t.dataSource,t.shapeDataPath,rt.properties[si],t.shapeDataPath),!n.isNullOrUndefined(vi.property))if(p=[[]],u[s]._isMultiPolygon||"Point"===u[s].type)for(ri=u[s],"Point"===ri.type&&(ci=!0,li=[],li.push(this.getPoint(u,[])),yt<(pt=(p=li)[p.length-1].length)&&(yt=pt,ht=p.length-1)),et=0;et<ri.length;et++)p.push(this.getPoint(ri[et],[])),yt<(pt=p[p.length-1].length)&&(yt=pt,ht=p.length-1);else p.push(this.getPoint(u[s],[])),yt<(pt=p[p.length-1].length)&&(yt=pt,ht=p.length-1);if(y=n.isNullOrUndefined(g)?rt.properties[ni]:n.isNullOrUndefined(g[ni])?g[t.shapeDataPath]:g[ni].toString(),"[object Array]"===Object.prototype.toString.call(t.shapePropertyPath)&&n.isNullOrUndefined(y)&&0===t.dataSource.length)for(dt=0;dt<t.shapePropertyPath.length;dt++)if(rt.properties[t.shapePropertyPath[dt]]){y=rt.properties[t.shapePropertyPath[dt]];break}n.isNullOrUndefined(y)&&""!==t.dataLabelSettings.template&&0===t.dataSource.length&&(y=rt.properties[t.shapePropertyPath]);var nr=y,ki=this.maps.projectionType,di=a=ci?{x:p[ht][s].x,y:p[ht][s].y,rightMin:0,rightMax:0,leftMin:0,leftMax:0,points:p[ht][s],topMax:0,topMin:0,bottomMax:0,bottomMin:0,height:0}:yi(p[ht],ki,t.geometryType);if(!n.isNullOrUndefined(y)&&!n.isNullOrUndefined(a)){if(bt&&wt>1&&!this.maps.zoomNotApplied&&""===lt.template){if(i>0)for(gt=0;gt<this.maps.zoomLabelPositions.length;gt++)if(this.maps.zoomLabelPositions[gt].dataLabelText===y){fi=s;s=gt;oi=!0;break}ei=a.x;ai=a.y;a.x=(a.x+ii.x)*w;a.y=(a.y+ii.y)*w}a.y="Mercator"===this.maps.projectionType||"Normal"===t.geometryType?a.y:-a.y;n.isNullOrUndefined(this.maps.format)||isNaN(parseFloat(y))||this.maps.useGroupingSeparator&&(y=vr(this.maps,parseFloat(y)),n.isNullOrUndefined(g)||(g[ni]=y));k={name:"dataLabelRendering",maps:this.maps,cancel:!1,border:{color:lt.border.color,width:lt.border.width,opacity:lt.border.opacity},datalabel:lt,fill:lt.fill,template:lt.template,text:y};this.maps.trigger("dataLabelRendering",k,function(){var pt,et,lt,at,si,hi,gt,ut,u,yt,vi,wi;if(!k.cancel){et=bt&&wt>1&&!l.maps.zoomNotApplied&&l.maps.zoomShapeCollection.length>s?l.maps.zoomShapeCollection[s].width:(a.rightMax.x-a.leftMax.x)*w;n.isNullOrUndefined(l.maps.dataLabelShape)||(pi=di.rightMax.x-di.leftMax.x,l.maps.dataLabelShape.push(pi));k.text===y||k.cancel||(y=k.text);var r=v(y,it),f=y,dt=r,bi=a.y-r.height/4,gi=a.y+r.height/4,tr=(a.y+ct.y)*w-r.height/4,ir=(a.y+ct.y)*w+r.height/4;if((pt=function(n,t,i){for(var u,f=[],r=0;r<n.length;r++)u=n[r],t<=u.y&&i>=u.y&&f.push(u);return f}(p[ht],bi,gi),!ci&&pt.length>5&&"MultiPolygon"!==rt.geometry.type&&"MultiPolygon"!==rt.type)&&(lt=yi(pt,ki,t.geometryType),bt&&wt>1&&!l.maps.zoomNotApplied&&""===k.template&&(lt.x=(l.maps.zoomLabelPositions[s].location.x+ii.x)*w,lt.y=(l.maps.zoomLabelPositions[s].location.y+ii.y)*w),ei=lt.x,a.x=lt.x,et=bt&&wt>1&&!l.maps.zoomNotApplied&&l.maps.zoomShapeCollection.length>s?l.maps.zoomShapeCollection[s].width:(lt.rightMax.x-lt.leftMax.x)*w),si=(a.x+ct.x)*w+r.width/2,hi=(a.x+ct.x)*w-r.width/2,l.value[s]={rightWidth:si,leftWidth:hi,heightTop:tr,heightBottom:ir},""!==k.template)gt=(ui=ti(k.template))?ui(n.isNullOrUndefined(g)?rt.properties:g,l.maps,k.template,l.maps.element.id+"_LabelTemplate",!1):document.createElement("div"),gt.innerHTML=ui?"":k.template,at=function(t,i,r){for(var f=(n.isNullOrUndefined(t.childElementCount)?t[0]:t).outerHTML,e=Object.keys(r),u=0;u<e.length;u++)f=f.replace(new RegExp("{{:"+e[u]+"}}","g"),r[e[u].toString()]);return n.createElement("div",{id:i,innerHTML:f,styles:"position: absolute"})}(gt,vt,n.isNullOrUndefined(g)?rt.properties:g,l.maps),at.style.left=Math.abs(l.maps.baseMapRectBounds.min.x-a.x)*w+"px",at.style.top=Math.abs(l.maps.baseMapRectBounds.min.y-a.y)*w+"px",o.appendChild(at);else{if("Trim"===ft.smartLabelMode&&(dt=v(f=d(et,"number"==typeof y?y.toString():y,it),it),st=new nt(vt,tt.x,tt.y,"middle",f,"","")),"None"===ft.smartLabelMode&&(st=new nt(vt,tt.x,tt.y,"middle",y,"","")),"Hide"===ft.smartLabelMode&&(y=et>=r.width?y:"",st=new nt(vt,tt.x,tt.y,"middle",y,"","")),y=st.text,"Hide"===ft.intersectionAction){for(ut=0;ut<h.length;ut++)if(!n.isNullOrUndefined(h[ut])&&!(l.value[s].leftWidth>h[ut].rightWidth||l.value[s].rightWidth<h[ut].leftWidth||l.value[s].heightTop>h[ut].heightBottom||l.value[s].heightBottom<h[ut].heightTop)){y="";break}h.push(l.value[s]);st=new nt(vt,tt.x,tt.y,"middle",y,"","")}if("Trim"===ft.intersectionAction){for(u=0;u<h.length;u++)if(!n.isNullOrUndefined(h[u]))if(h[u].rightWidth<l.value[s].leftWidth||h[u].leftWidth>l.value[s].rightWidth||h[u].heightBottom<l.value[s].heightTop||h[u].heightTop>l.value[s].heightBottom)f=y;else{if(l.value[s].leftWidth>h[u].leftWidth){f=d((et=h[u].rightWidth-l.value[s].leftWidth)-(l.value[s].rightWidth-l.value[s].leftWidth),y,it);break}if(l.value[s].leftWidth<h[u].leftWidth){et=l.value[s].rightWidth-h[u].leftWidth;f=d(Math.abs(et-(l.value[s].rightWidth-l.value[s].leftWidth)),y,it);break}}dt=v(f,it);h.push(l.value[s]);st=new nt(vt,tt.x,tt.y,"middle",f,"","")}if(("None"===ft.intersectionAction&&(st=new nt(vt,tt.x,tt.y,"middle",y,"","")),f.length>1)&&(yt=k.border,yt.width>1)){var rr=k.fill,li=ft.opacity,ur=ft.rx,fr=ft.ry,ni=void 0,ri=void 0;bt&&wt>1&&!l.maps.zoomNotApplied?(ni=a.x-r.width/2,ri=a.y-r.height/2-5):(ni=(a.x+ct.x)*w-r.width/2,ri=(a.y+ct.y)*w-r.height/2);yt.opacity=n.isNullOrUndefined(yt.opacity)?li:yt.opacity;vi=new b(l.maps.element.id+"_LayerIndex_"+i+"_shapeIndex_"+s+"_rectIndex_"+s,rr,yt,li,new c(ni,ri,r.width,r.height),ur,fr);wi=l.maps.renderer.drawRectangle(vi);e.appendChild(wi)}kt=ot(st,it,it.color||l.maps.themeStyle.dataLabelFontColor,e);bt&&wt>1&&!l.maps.zoomNotApplied?(kt.setAttribute("transform","translate( "+a.x+" "+a.y+" )"),a.x=ei,a.y=ai):kt.setAttribute("transform","translate( "+(a.x+ct.x)*w+" "+((a.y+ct.y)*w+dt.height/4)+" )");e.appendChild(kt)}l.dataLabelCollections.push({location:{x:a.x,y:a.y},element:n.isNullOrUndefined(at)?kt:at,layerIndex:i,shapeIndex:oi?fi:s,labelIndex:oi?fi:s,dataLabelText:nr});o.childElementCount>0&&!l.maps.element.contains(o)&&(document.getElementById(l.maps.element.id+"_Secondary_Element").appendChild(o),l.maps.renderReactTemplates())}})}},t.prototype.getPoint=function(n,t){return n.map(function(n){t.push(new f(n.point.x,n.point.y))}),t},t.prototype.getModuleName=function(){return"DataLabel"},t.prototype.destroy=function(){},t}(),ke=function(){function t(n){this.maps=n}return t.prototype.renderNavigation=function(t,i,r){for(var v,kt,u,gt,nt,tt,ni,rt,l,a,b,ut,lt,o,ot,st,ht,ft,k,at,vt,d,c,g,yt,pt,w,ct,et,wt,h=t.navigationLineSettings,e=[],bt=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_line_Group"}),s=0;s<h.length;s++){if(ut=h[s].properties.latitude,b=h[s].properties.longitude,lt=h[s].properties.visible,o=h[s].angle,ot=h[s].width||1,st=h[s].color,ht=h[s].properties.dashArray,c=h[s].properties.arrowSettings,at=!n.isNullOrUndefined(c)&&c.properties.showArrow,b.length===ut.length&&lt)for(v=0;v<b.length;v++)kt=this.maps.isTileMap?it(new f(b[v],ut[v]),i,this.maps.tileTranslatePoint,!0):y(ut[v],b[v],i,t,this.maps),e.push(kt);for(et=this.maps.renderer.createGroup({id:this.maps.element.id+"_LayerIndex_"+r+"_NavigationGroup"+s}),u=0;u<e.length-1;u++)o=1<(o=-1>o?-1:o)?1:o,gt=this.maps.element.id+"_LayerIndex_"+r+"_NavigationIndex_"+s+"_Line"+u,nt=this.convertRadius(e[u],e[u+1]),(o<=1&&o>0&&(k=0,e[u].x>e[u+1].x&&(k=1)),o>=-1&&o<0&&(k=1,e[u].x>e[u+1].x&&(k=0)),e[u].x!==e[u+1].x)&&(at&&(vt=c.properties.color,d=c.properties.size,ct=void 0===c.properties.offSet?0:c.properties.offSet,tt=Math.round(d/2),yt="Start"===(g=c.properties.position)?"url(#triangle"+s+")":null,pt="End"===g?"url(#triangle"+s+")":null,0!==w&&0===o&&(w="Start"===g?ct:-ct),w=n.isNullOrUndefined(w)?0:w,ni=this.maps.element.id+"_triangle",rt=this.maps.renderer.createDefs(),rt.innerHTML+='<marker id="triangle'+s+'"><\/marker>',l=rt.querySelector("#triangle"+s),l.setAttribute("markerWidth",d.toString()),l.setAttribute("markerHeight",d.toString()),l.setAttribute("refX",(tt-w).toString()),l.setAttribute("refY",tt.toString()),l.setAttribute("orient","auto"),ft=new p(ni,vt,ot,st,1,1,ht,"M 0,0  L 0,"+d+" L "+tt+", "+tt+" Z"),a=this.maps.renderer.drawPath(ft),l.appendChild(a),rt.appendChild(l),et.appendChild(rt)),wt=0===(o=Math.abs(o))?"M "+e[u].x+","+e[u].y+"L "+e[u+1].x+","+e[u+1].y+" ":"M "+e[u].x+","+e[u].y+" A "+(nt/2+(1-o)*nt/(10*o))+" "+(nt/2+(1-o)*nt/(10*o))+" 0,0,"+k+" , "+e[u+1].x+","+e[u+1].y+" ",ft=new p(gt,"none",ot,st,1,1,ht,wt),a=this.maps.renderer.drawPath(ft),n.isNullOrUndefined(g)||("Start"===g?a.setAttribute("marker-start",yt):a.setAttribute("marker-end",pt)),dt(this.maps.selectedNavigationElementId,this.maps.navigationSelectionClass,a,"navigationlineselectionMapStyle"),et.appendChild(a),bt.appendChild(et));e=[]}return bt},t.prototype.convertRadius=function(n,t){var i=t.x-n.x,r=t.y-n.y;return Math.sqrt(Math.pow(i,2)+Math.pow(r,2))},t.prototype.getModuleName=function(){return"NavigationLine"},t.prototype.destroy=function(){},t}(),de=function(){function t(n){this.legendBorderRect=new c(0,0,0,0);this.legendTotalRect=new c(0,0,0,0);this.totalPages=[];this.page=0;this.currentPage=0;this.legendItemRect=new c(0,0,0,0);this.heightIncrement=0;this.widthIncrement=0;this.textMaxWidth=0;this.shapeHighlightCollection=[];this.legendHighlightCollection=[];this.shapePreviousColor=[];this.selectedNonLegendShapes=[];this.shapeToggled=!0;this.legendElement=null;this.maps=n;this.addEventListener()}return t.prototype.renderLegend=function(){this.legendRenderingCollections=[];this.legendCollection=[];this.totalPages=[];this.widthIncrement=0;this.heightIncrement=0;this.defsElement=this.maps.renderer.createDefs();this.maps.svgObject.appendChild(this.defsElement);this.calculateLegendBounds();this.drawLegend()},t.prototype.calculateLegendBounds=function(){var ut=this,b=this.maps,t=b.legendSettings,st,r,ft,ei,oi,ot,l,i,a,e,dt,ii,ri,ui,fi,gt;if(this.legendCollection=[],st=b.mapAreaRect.y,this.legendRenderingCollections=[],Array.prototype.forEach.call(b.layersCollection,function(i,r){var o,h,u;if(!n.isNullOrUndefined(i.shapeData)){var c=i.shapeData.features,l=i.shapeDataPath,a=i.shapePropertyPath,s=i.dataSource,f=void 0,e=void 0;if("Layers"===t.type&&i.visible)f=i.shapeSettings.colorValuePath,e=i.shapeSettings.colorMapping,ut.getLegends(r,c,e,s,l,f,a);else if("Bubbles"===t.type)for(o=0,h=i.bubbleSettings;o<h.length;o++)u=h[o],u.visible&&(f=u.colorValuePath,e=u.colorMapping,s=u.dataSource,ut.getLegends(r,c,e,s,l,f,a));else ut.getMarkersLegendCollections(r,i.markerSettings)}}),this.legendCollection.length>0)for(r=0;r<this.legendCollection.length;r++)ft={name:"legendRendering",cancel:!1,fill:(a=this.legendCollection[r]).fill,shape:t.shape,shapeBorder:t.shapeBorder,text:"number"==typeof a.text?a.text.toString():a.text},b.trigger("legendRendering",ft),a.fill=ft.fill,a.shape=ft.shape,a.shapeBorder=ft.shapeBorder,a.text=ft.text,ft.cancel&&(this.legendCollection.splice(r,1),r--);if(ei=b.legendSettings.title.text,oi=b.legendSettings.titleStyle,this.legendCollection.length>0){var si,hi,vi=t.mode,k=0,g=0,ct=0,ht=0,ni=t.shapePadding,y=t.shapeHeight,et=t.shapeWidth,o=[],nt=[],ci=t.position,li=t.labelDisplayMode,p="None"===t.orientation?"Top"===ci||"Bottom"===ci?"Horizontal":"Vertical":t.orientation,u=t.width.length>1?t.width.indexOf("%")>-1?b.availableSize.width/100*parseInt(t.width,10):parseInt(t.width,10):null,f=t.height.length>1?t.height.indexOf("%")>-1?b.availableSize.height/100*parseInt(t.height,10):parseInt(t.height,10):null,s=0,h=0,ai=v(ei,oi);if("Interactive"===vi){var ti=t.textStyle,lt=this.legendCollection.length,tt="Horizontal"===p?n.isNullOrUndefined(u)?b.mapAreaRect.width/lt:u/lt:n.isNullOrUndefined(u)?25:u,it="Horizontal"===p?n.isNullOrUndefined(f)?25:f:n.isNullOrUndefined(f)?b.mapAreaRect.height/lt:f/lt;s=0;h=ai.height+10;var at=t.labelPosition,vt=0,yt=0,rt=10,pt=0,wt=0,bt=0,kt=0;for(r=0;r<this.legendCollection.length;r++)s="Horizontal"===p?s+tt:s,h="Horizontal"===p?h:h+it,ot=this.legendCollection[r].text,l=new w(0,0),"None"===li?l=v(ot,ti):"Trim"===li?l=v(ot=d("Horizontal"===p?tt:it,ot,ti),ti):ot="",bt=Math.max(bt,l.height),kt=Math.max(kt,l.width),l.width>0&&l.height>0&&("Horizontal"===p?(vt=s+tt/2,yt="After"===at?h+it+l.height/2+rt:h-rt):(vt="After"===at?s-l.width/2-rt:s+tt+l.width/2+rt,yt=h+it/2+l.height/4)),0===r?(pt="Horizontal"===p?s:"After"===at?vt-l.width/2:s,wt="Horizontal"===p?"After"===at?h:yt-l.height/2:h,1===this.legendCollection.length&&(u="Horizontal"===p?Math.abs(s+tt-pt):tt+kt+rt,f="Horizontal"===p?it+bt/2+rt:Math.abs(h+it-wt))):r===this.legendCollection.length-1&&(u="Horizontal"===p?Math.abs(s+tt-pt):tt+kt+rt,f="Horizontal"===p?it+bt/2+rt:Math.abs(h+it-wt)),this.legendRenderingCollections.push({fill:this.legendCollection[r].fill,x:s,y:h,width:tt,height:it,text:ot,textX:vt,textY:yt,textWidth:l.width,textHeight:l.height,shapeBorder:this.legendCollection[r].shapeBorder});1===this.legendCollection.length&&(f=it,u=tt);this.legendItemRect={x:pt,y:wt,width:u,height:f}}else{for(u=n.isNullOrUndefined(u)?b.mapAreaRect.width:u,f=n.isNullOrUndefined(f)?b.mapAreaRect.height:f,i=0,this.page=0,r=0;r<this.legendCollection.length;r++)a=this.legendCollection[r],n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]}),e=v(a.text,t.textStyle),(this.textMaxWidth=Math.max(this.textMaxWidth,e.width),0===r)?(s=k=10+et/2,h=g=st+ai.height+(y>e.height?y/2:e.height/4)):(dt=e.height>y?e.height:y,"Horizontal"===p?(ii=nt[i-1].x+nt[i-1].width+10+et,ii+ni+e.width>u?(ri=(nt[i-1].y>o[i-1].y+y/2?nt[i-1].y:o[i-1].y+y/2)+st,ri+dt>f?(this.getPageChanged(),i=0,o=[],nt=[],k=s,g=h):(k=o[0].x,g=ri+dt/2)):(k=ii-et/2,g=o[i-1].y)):(ui=nt[i-1].y>o[i-1].y+y/2?nt[i-1].y:o[i-1].y+y/2,ui+st+dt>f?(fi=nt[i-1].x+this.textMaxWidth+10,fi+ni+e.width>u?(k=s,g=h,nt=[],o=[],this.getPageChanged(),i=0):(k=fi+et/2,g=o[0].y)):(k=o[i-1].x,g=ui+st+y/2))),ct=k+et/2+ni,ht=g+e.height/4,o.push({x:k,y:g}),nt.push({x:ct,y:ht,width:e.width,height:e.height/2}),this.totalPages[this.page].Collection.push({DisplayText:a.text,ImageSrc:a.imageSrc,Shape:{x:k,y:g},Text:{x:ct,y:ht},Fill:a.fill,legendShape:a.shape,shapeBorder:a.shapeBorder,idIndex:r,Rect:{x:o[i].x-et/2,y:o[i].y-y/2<ht-e.height?o[i].y-y/2:ht-e.height,width:Math.abs(o[i].x-et/2-(ct+e.width)),height:y>e.height?y:e.height}}),i++;gt=this.totalPages[0].Collection;Array.prototype.forEach.call(gt,function(n,t){var i=new c(n.Rect.x,n.Rect.y,n.Rect.width,n.Rect.height);0===t&&(si=i.x,hi=i.y);ut.widthIncrement=Math.max(ut.widthIncrement,Math.abs(si-(i.x+i.width)));ut.heightIncrement=Math.max(ut.heightIncrement,Math.abs(hi-(i.y+i.height)))});u=this.widthIncrement<u?this.widthIncrement:u;f=this.heightIncrement<f?this.heightIncrement:f;this.legendItemRect={x:gt[0].Rect.x,y:gt[0].Rect.y,width:u,height:f}}}},t.prototype.getLegends=function(n,t,i,r,u,f,e){this.getRangeLegendCollection(n,t,i,r,u,f,e);this.getEqualLegendCollection(n,t,i,r,u,f,e);this.getDataLegendCollection(n,t,i,r,u,f,e)},t.prototype.getPageChanged=function(){this.page++;n.isNullOrUndefined(this.totalPages[this.page])&&(this.totalPages[this.page]={Page:this.page+1,Collection:[]})},t.prototype.legendTextTrim=function(n,t,i,r){var u=t,e=v(t,i).width,o=r-e,f;if(r>n)for(f=t.length-1;f>=0;--f)if(o+(e=v(u=t.substring(0,f)+"...",i).width)<=n||u.length<4)return u.length<4&&(u=" "),u;return u},t.prototype.drawLegend=function(){var o,i=this.maps,u=i.legendSettings,s=i.renderer,n=u.textStyle,r,e,h;if(this.legendGroup=s.createGroup({id:i.element.id+"_Legend_Group"}),"Interactive"===u.mode)for(r=0;r<this.legendRenderingCollections.length;r++){var l=i.element.id+"_Legend_Index_"+r,a=i.element.id+"_Legend_Index_"+r+"_Text",t=this.legendRenderingCollections[r],v=new c(t.x,t.y,t.width,t.height);0===r&&this.renderLegendBorder();e=new f(t.textX,t.textY);n.color=null!==n.color?n.color:this.maps.themeStyle.legendTextColor;h=new b(l,t.fill,t.shapeBorder,u.opacity,v);o=new nt(a,e.x,e.y,"middle",t.text,"","");n.fontFamily=i.themeStyle.fontFamily||n.fontFamily;n.size=i.themeStyle.legendFontSize||n.size;ot(o,n,n.color,this.legendGroup);this.legendGroup.appendChild(s.drawRectangle(h));this.legendToggle()}else this.drawLegendItem(this.currentPage)},t.prototype.drawLegendItem=function(t){var wt,bt,kt,dt,gt,ct,it,r=this.maps,i=r.legendSettings,ni=new w(i.shapeWidth,i.shapeHeight),s=r.renderer,lt=i.shape,a,y,l,yt,k,ui,tt,fi,ei,oi;if(t>=0&&t<this.totalPages.length)for(o(this.legendGroup.id,this.maps.element.id)&&n.remove(o(this.legendGroup.id,this.maps.element.id)),a=0;a<this.totalPages[t].Collection.length;a++){var u=this.totalPages[t].Collection[a],d=u.shapeBorder,rt=s.createGroup({id:r.element.id+"_Legend_Index_"+u.idIndex}),at=u.DisplayText,si=("Markers"===i.type?n.isNullOrUndefined(u.ImageSrc)&&i.shape:u.legendShape,"HorizontalLine"===i.shape||"VerticalLine"===i.shape||"Cross"===i.shape?n.isNullOrUndefined(i.fill)?"#000000":i.fill:d.color),hi="HorizontalLine"!==i.shape&&"VerticalLine"!==i.shape&&"Cross"!==i.shape||0!==d.width?d.width:1,ci=r.element.id+"_Legend_Shape_Index_"+u.idIndex,li=r.element.id+"_Legend_Text_Index_"+u.idIndex,vt=new f(u.Shape.x,u.Shape.y-4),ti=new f(u.Text.x,u.Text.y-4),ii=(n.isNullOrUndefined(u.ImageSrc)?i.shape:u.ImageSrc,new p(ci,u.Fill,hi,si,i.opacity,n.isNullOrUndefined(d.opacity)?i.opacity:d.opacity,"")),e={fontFamily:i.textStyle.fontFamily,fontStyle:i.textStyle.fontStyle,fontWeight:i.textStyle.fontWeight,size:i.textStyle.size,color:i.textStyle.color,opacity:i.textStyle.opacity};if((e.color=null!==e.color?e.color:this.maps.themeStyle.legendTextColor,e.fontFamily=r.themeStyle.fontFamily||e.fontFamily,e.size=r.themeStyle.legendFontSize||e.size,0===a&&this.renderLegendBorder(),"Markers"===i.type&&i.useMarkerShape)&&(y=this.legendCollection[u.idIndex].data[0],l=r.layers[y.layerIndex].markerSettings[y.markerIndex],lt=n.isNullOrUndefined(l.dataSource[y.dataIndex][l.shapeValuePath])||""===l.dataSource[y.dataIndex][l.shapeValuePath]?l.shape:l.dataSource[y.dataIndex][l.shapeValuePath]),"Balloon"===lt?rt.appendChild(cr(r,ii,ni,{x:vt.x,y:vt.y+5},"Legend")):rt.appendChild((wt=vt,bt=lt,kt=ni,dt=u.ImageSrc,gt=ii,ct=void 0,it=void 0,ct=new et.SvgRenderer(""),it=function(t,i,r,u,f){var s,v="Path",c=i.width,o=i.height,h=t.x,e=t.y,l=t.x+-c/2,w=t.y+-o/2;switch(u.stroke="HorizontalLine"===r||"VerticalLine"===r||"Cross"===r?u.fill:u.stroke,u["stroke-width"]=0!==u["stroke-width"]||"HorizontalLine"!==r&&"VerticalLine"!==r&&"Cross"!==r?u["stroke-width"]:1,r){case"Circle":case"Bubble":v="Ellipse";n.merge(u,{rx:c/2,ry:o/2,cx:h,cy:e});break;case"VerticalLine":s="M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"HorizontalLine":s="M "+h+" "+e+" L "+(h+c/2)+" "+e;n.merge(u,{d:s});break;case"Diamond":s="M "+l+" "+e+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+e+" L "+h+" "+(e+o/2)+" L "+l+" "+e+" z";n.merge(u,{d:s});break;case"Rectangle":s="M "+l+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" L "+l+" "+(e+-o/2)+" z";n.merge(u,{d:s});break;case"Triangle":s="M "+l+" "+(e+o/2)+" L "+h+" "+(e+-o/2)+" L "+(h+c/2)+" "+(e+o/2)+" L "+l+" "+(e+o/2)+" z";n.merge(u,{d:s});break;case"InvertedTriangle":s="M "+(h+c/2)+" "+(e-o/2)+" L "+h+" "+(e+o/2)+" L "+(h-c/2)+" "+(e-o/2)+" L "+(h+c/2)+" "+(e-o/2)+" z";n.merge(u,{d:s});break;case"Pentagon":for(var y=void 0,p=void 0,a=0;a<=5;a++)y=c/2*Math.cos(Math.PI/180*72*a),p=c/2*Math.sin(Math.PI/180*72*a),s=0===a?"M "+(h+y)+" "+(e+p)+" ":s.concat("L "+(h+y)+" "+(e+p)+" ");s=s.concat("Z");n.merge(u,{d:s});break;case"Star":s="M "+(t.x+i.width/3)+" "+(t.y-i.height/2)+" L "+(t.x-i.width/2)+" "+(t.y+i.height/6)+" L "+(t.x+i.width/2)+" "+(t.y+i.height/6)+" L "+(t.x-i.width/3)+" "+(t.y-i.height/2)+" L "+t.x+" "+(t.y+i.height/2)+" L "+(t.x+i.width/3)+" "+(t.y-i.height/2)+" Z";n.merge(u,{d:s});break;case"Cross":s="M "+l+" "+e+" L "+(h+c/2)+" "+e+" M "+h+" "+(e+o/2)+" L "+h+" "+(e+-o/2);n.merge(u,{d:s});break;case"Image":v="Image";n.merge(u,{href:f,height:o,width:c,x:l,y:w})}return{renderOption:u,functionName:v}}(wt,kt,bt,gt,dt),ct["draw"+it.functionName](it.renderOption))),yt=u.Rect.x+u.Rect.width,yt>this.legendBorderRect.width&&(at=this.legendTextTrim(this.legendBorderRect.width,at,e,yt)),ot(new nt(li,ti.x,ti.y,"start",at,"",""),e,e.color,rt),this.legendGroup.appendChild(rt),a===this.totalPages[t].Collection.length-1){if(k=void 0,0!==this.page){var ri=t+1+"/"+this.totalPages.length,ut=i.textStyle,pt=v(ri,ut),ft=this.legendItemRect.x+this.legendItemRect.width-pt.width-38,g=this.legendItemRect.x+this.legendItemRect.width,ai=g-10-pt.width/2-9,h=this.legendItemRect.y+this.legendItemRect.height+2.5+10;k=s.createGroup({id:r.element.id+"_Legend_Paging_Group"});var st=s.createGroup({id:r.element.id+"_Legend_Left_Paging_Group"}),ht=s.createGroup({id:r.element.id+"_Legend_Right_Paging_Group"}),vi=" M "+g+" "+h+" L "+(g-10)+" "+(h-5)+" L "+(g-10)+" "+(h+5)+" z ",yi=" M "+ft+" "+h+" L "+(ft+10)+" "+(h-5)+" L "+(ft+10)+" "+(h+5)+" z ",pi=new p(r.element.id+"_Left_Page","#a6a6a6",0,"#a6a6a6",t+1===1?.5:1,1,"",yi);st.appendChild(s.drawPath(pi));ui=new b(r.element.id+"_Left_Page_Rect","transparent",{},1,new c(ft-5,h-10,20,20),null,null,"","");tt=s.drawRectangle(ui);tt.setAttribute("tabindex",(t+1===1?-1:r.tabIndex+1).toString());st.appendChild(tt);this.wireEvents(st);fi=new p(r.element.id+"_Right_Page","#a6a6a6",0,"#a6a6a6",t+1===this.totalPages.length?.5:1,1,"",vi);ht.appendChild(s.drawPath(fi));ei=new b(r.element.id+"_Right_Page_Rect","transparent",{},1,new c(g-15,h-10,20,20),null,null,"","");(tt=s.drawRectangle(ei)).setAttribute("tabindex",(t+1===this.totalPages.length?-1:r.tabIndex+2).toString());ht.appendChild(tt);this.wireEvents(ht);k.appendChild(st);k.appendChild(ht);oi={id:r.element.id+"_Paging_Text",x:ai,y:h+pt.height/4,fill:"#a6a6a6","font-size":"14px","font-style":ut.fontStyle,"font-family":ut.fontFamily,"font-weight":ut.fontWeight,"text-anchor":"middle",transform:"",opacity:1,"dominant-baseline":""};k.appendChild(s.createText(oi,ri));this.legendGroup.appendChild(k)}this.legendToggle()}}},t.prototype.legendHighLightAndSelection=function(t,i){var g,nt,tt,h,ct="Default"===this.maps.legendSettings.mode?document.getElementById(t.id.replace("Shape","Text")):document.getElementById(t.id+"_Text"),e=this.maps.legendModule.legendCollection,a=!n.isNullOrUndefined(e[0].data[0].layerIndex)&&this.maps.layers[e[0].data[0].layerIndex].selectionSettings.enableMultiSelect,v=0,w=!0,it=parseFloat(t.id.charAt(t.id.length-1)),rt,b,u,y,f,ut,o,s,k,p,et,ot,st,ht,d;if(this.updateLegendElement(),rt=this.maps.toggledLegendId.indexOf(it),this.maps.legendSettings.toggleLegendSettings.enable&&"highlight"===i&&-1!==rt)return b=this.getIndexofLegend(this.legendHighlightCollection,t),-1!==b&&this.legendHighlightCollection.splice(b,1),this.removeLegendHighlightCollection(),null;if("selection"===i){if(this.shapeHighlightCollection=[],this.maps.shapeSelections||a||(this.removeAllSelections(),this.maps.shapeSelections=!0),this.maps.legendSelectionCollection.length>0&&(a||this.maps.shapeSelections))for(u=0;u<this.maps.legendSelectionCollection.length;u++){if(t===this.maps.legendSelectionCollection[u].legendElement){this.maps.legendSelectionCollection[u].legendElement=t;w=!1;this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement);this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(it),1);this.maps.legendSelectionCollection.splice(u,1);this.maps.legendSelection=!(this.maps.legendSelectionCollection.length>0);break}if(!a)if(this.maps.legendSelectionCollection.length>1){for(y=0;y<this.maps.legendSelectionCollection.length;y++)this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[y].legendElement);this.maps.legendSelectionCollection=[]}else this.removeLegendSelectionCollection(this.maps.legendSelectionCollection[u].legendElement),this.maps.legendSelectionCollection.splice(u,1)}}else{if(this.maps.legendSelectionCollection.length>0)for(u=0;u<this.maps.legendSelectionCollection.length;u++){if((t.id.indexOf("_Legend_Shape")>-1||t.id.indexOf("_Legend_Index"))&&t===this.maps.legendSelectionCollection[u].legendElement){w=!1;break}this.removeLegendHighlightCollection()}this.removeLegendHighlightCollection()}if(w)for(f=0;f<e.length;f++)if(ut="Interactive"===this.maps.legendSettings.mode?parseFloat(t.id.split("_Legend_Index_")[1]):parseFloat(t.id.split("_Legend_Shape_Index_")[1]),ct.textContent===e[f].text&&e[f].data.length>0&&ut===f){var c=this.maps.layers[e[f].data[0].layerIndex],ft=void 0,r=void 0,l=void 0;if(n.isNullOrUndefined(c)||(ft="selection"===i?c.selectionSettings.enable:c.highlightSettings.enable,r=void 0,r="selection"===i?c.selectionSettings:c.highlightSettings,l=e[f].data),ft)for(o=0;o<l.length;o++)if(g=l[o].shapeIndex,nt=l[o].layerIndex,tt=l[o].dataIndex,s=document.getElementById(this.maps.element.id+"_LayerIndex_"+nt+"_shapeIndex_"+g+"_dataIndex_"+tt),null!==s){if(k=!0,null!==this.maps.legendSelectionCollection)for(p=0;p<this.maps.legendSelectionCollection.length;p++)if(this.maps.legendSelectionCollection[p].legendElement===t){k=!1;break}"highlight"===i&&k?(0===o&&(this.legendHighlightCollection=[],this.pushCollection(t,this.legendHighlightCollection,e[f],c.shapeSettings)),h=this.legendHighlightCollection.length,et=this.legendHighlightCollection[h-1].legendOldFill,this.legendHighlightCollection[h-1].MapShapeCollection.Elements.push(s),ot=this.legendHighlightCollection[h-1].MapShapeCollection.Elements.length-1,st=s.getAttribute("fill"),this.legendHighlightCollection[h-1].shapeOldFillColor.push(st),ht=this.legendHighlightCollection[h-1].shapeOldFillColor[ot],this.shapePreviousColor=this.legendHighlightCollection[h-1].shapeOldFillColor,this.setColor(s,n.isNullOrUndefined(r.fill)?ht:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight"),this.setColor(t,n.isNullOrUndefined(r.fill)?et:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")):"selection"===i&&(this.legendHighlightCollection=[],this.maps.legendSelectionClass=r,0===o&&(this.pushCollection(t,this.maps.legendSelectionCollection,e[f],c.shapeSettings),a||0===this.maps.selectedLegendElementId.length||(this.maps.selectedLegendElementId=[]),this.maps.selectedLegendElementId.push(f)),v=this.maps.legendSelectionCollection.length,d=this.maps.legendSelectionCollection[v-1].legendOldFill,this.maps.legendSelectionCollection[v-1].MapShapeCollection.Elements.push(s),this.maps.legendSelectionCollection[v-1].shapeOldFillColor=this.shapePreviousColor,this.setColor(t,n.isNullOrUndefined(r.fill)?d:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),this.setColor(s,n.isNullOrUndefined(r.fill)?d:r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),-1===this.maps.selectedElementId.indexOf(s.getAttribute("id"))&&this.maps.selectedElementId.push(s.getAttribute("id")),o===l.length-1&&(this.maps.legendSelection=!1,this.removeLegend(this.maps.legendSelectionCollection)))}}},t.prototype.setColor=function(t,i,r,u,f,e){"selection"===e?(function(t,i,r,u,f,e,o){if(!s(t)){var h=n.createElement("style",{id:t,innerHTML:".ShapeselectionMapStyle{fill:"+r+";opacity:"+u+";stroke-width:"+e+";stroke:"+f+";}"});o.shapeSelectionClass=h;document.body.appendChild(h)}}("ShapeselectionMap",0,i,r,u,f,this.maps),t.setAttribute("class","ShapeselectionMapStyle")):(t.setAttribute("fill",i),t.setAttribute("fill-opacity",r),t.setAttribute("stroke",u),t.setAttribute("stroke-width",(Number(f)/this.maps.scale).toString()))},t.prototype.pushCollection=function(n,t,i,r){t.push({legendElement:n,legendOldFill:i.fill,legendOldOpacity:i.opacity,legendOldBorderColor:i.borderColor,legendOldBorderWidth:i.borderWidth,shapeOpacity:r.opacity,shapeOldBorderColor:r.border.color,shapeOldBorderWidth:r.border.width});var u=t.length;t[u-1].MapShapeCollection={Elements:[]};t[u-1].shapeOldFillColor=[]},t.prototype.removeLegend=function(n){for(var t,u,i,f,r=0;r<n.length;r++)for(t=n[r],this.setColor(t.legendElement,t.legendOldFill,t.legendOldOpacity,t.legendOldBorderColor,t.legendOldBorderWidth,"highlight"),u=t.MapShapeCollection.Elements.length,i=0;i<u;i++)f=-1!==t.legendOldFill.indexOf("url")?t.shapeOldFillColor[i]:t.legendOldFill,this.setColor(t.MapShapeCollection.Elements[i],f,t.shapeOpacity,t.shapeOldBorderColor,t.shapeOldBorderWidth,"highlight")},t.prototype.removeLegendHighlightCollection=function(){this.legendHighlightCollection.length>0&&(this.removeLegend(this.legendHighlightCollection),this.legendHighlightCollection=[])},t.prototype.removeLegendSelectionCollection=function(n){var t,r;if(this.maps.legendSelectionCollection.length>0){a(n);for(var u=this.shapesOfLegend(n),f=u.length,i=0;i<f;i++)t=s(u[i]),"ShapeselectionMapStyle"===t.getAttribute("class")&&(a(t),r=this.maps.selectedElementId.indexOf(t.id),-1!==r&&this.maps.selectedElementId.splice(r,1))}},t.prototype.removeShapeHighlightCollection=function(){var t;if(this.shapeHighlightCollection.length>0)for(t=0;t<this.shapeHighlightCollection.length;t++){for(var n=this.shapeHighlightCollection[t],r=!0,i=0;i<this.maps.legendSelectionCollection.length;i++)this.maps.legendSelectionCollection[i].legendElement===n.legendElement&&(r=!1);r&&this.setColor(n.legendElement,n.legendOldFill,n.legendOldOpacity,n.legendOldBorderColor,n.legendOldBorderWidth,"highlight")}},t.prototype.shapeHighLightAndSelection=function(t,i,r,u,f){var b,y,h,p,v,d,o,l,g,rt,nt,tt,it;if(void 0!==i){this.updateLegendElement();this.shapeToggled=!0;var w=this.maps.legendModule.legendCollection,e=this.legendIndexOnShape(i,f),s=this.shapeDataOnLegend(t),ut=this.maps.toggledLegendId.indexOf(e.actualIndex);if(this.maps.legendSettings.toggleLegendSettings.enable&&-1!==ut)return this.shapeToggled=!1,this.legendHighlightCollection=[],b=this.getIndexofLegend(this.shapeHighlightCollection,s.LegendEle),-1!==b&&this.shapeHighlightCollection.splice(b,1),this.removeShapeHighlightCollection(),null;if(void 0===e.currentIndex&&void 0===e.actualIndex)return this.removeShapeHighlightCollection(),null;if(void 0!==e.currentIndex||"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||"ShapeselectionMapStyle"===t.getAttribute("class")||(this.maps.legendSelection=!1),"selection"!==u||this.maps.layers[f].selectionSettings.enableMultiSelect||this.maps.legendSelection||(this.removeAllSelections(),this.maps.legendSelection=!0),void 0===e.currentIndex){if("selection"===u&&void 0!==e.actualIndex){for(y=0,h=0;h<s.Elements.length;h++)"ShapeselectionMapStyle"===s.Elements[h].getAttribute("class")&&y++;p=this.maps.selectedLegendElementId.indexOf(e.actualIndex);-1===p?(this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r):y<=1&&"ShapeselectionMapStyle"===t.getAttribute("class")&&(this.maps.layers[f].selectionSettings.enableMultiSelect?y<=1&&"ShapeselectionMapStyle"===t.getAttribute("class")&&this.maps.selectedLegendElementId.splice(p,1):this.maps.selectedLegendElementId.splice(p,1))}return this.removeShapeHighlightCollection(),null}var ft=w[e.actualIndex].text,k=void 0,c=void 0;if("Default"===this.maps.legendSettings.mode?void 0!==e.currentIndex&&(k=document.getElementById(this.maps.element.id+"_Legend_Text_Index_"+e.actualIndex).textContent,c=document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+e.actualIndex)):(k=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex+"_Text").textContent,c=document.getElementById(this.maps.element.id+"_Legend_Index_"+e.actualIndex)),this.oldShapeElement=s.LegendEle,v=this.maps.legendSelectionCollection.length,ft===k){if(d=!0,this.maps.legendSelectionCollection)for(h=0;h<this.maps.legendSelectionCollection.length;h++)if(this.maps.legendSelectionCollection[h].legendElement===s.LegendEle){d=!1;break}if("highlight"===u&&d){for((void 0===(l=this.isTargetSelected(s,this.shapeHighlightCollection))||l&&!l.IsSelected)&&this.pushCollection(c,this.shapeHighlightCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),o=0;o<this.shapeHighlightCollection.length;o++)s.LegendEle.id===this.shapeHighlightCollection[o].legendElement.id&&(this.shapeHighlightCollection[o].legendElement=s.LegendEle);if(v>0)for(o=0;o<v;o++){if(s.LegendEle===this.maps.legendSelectionCollection[o].legendElement){this.maps.legendSelectionCollection[o].legendElement=s.LegendEle;this.removeShapeHighlightCollection();break}o===v-1&&(this.removeShapeHighlightCollection(),this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight"))}else this.removeShapeHighlightCollection(),this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"highlight")}else if("selection"===u){if(l=this.isTargetSelected(s,this.maps.legendSelectionCollection),v>0)for(o=0;o<this.maps.legendSelectionCollection.length;)s.LegendEle===this.maps.legendSelectionCollection[o].legendElement||r.enableMultiSelect?o++:(g=this.maps.legendSelectionCollection[o],rt=this.maps.selectedLegendElementId.indexOf(e.actualIndex),this.maps.selectedLegendElementId.splice(rt,1),this.maps.legendSelectionCollection.splice(o,1),a(g.legendElement),this.maps.shapeSelections=!0,o=0);if(l&&l.IsSelected&&"ShapeselectionMapStyle"===t.getAttribute("class")){if(g=this.maps.legendSelectionCollection[l.SelectionIndex],nt=0,r.enableMultiSelect)for(h=0;h<s.Elements.length;h++)t.getAttribute("class")===s.Elements[h].getAttribute("class")&&nt++;nt<=1&&(r.enableMultiSelect||this.maps.legendSelection)&&(this.maps.selectedLegendElementId.splice(this.maps.selectedLegendElementId.indexOf(e.actualIndex),1),n.isNullOrUndefined(s.LegendEle)||a(s.LegendEle),this.maps.legendSelectionCollection.splice(l.SelectionIndex,1),this.maps.shapeSelections=!0)}else{for(void 0!==l&&(!l||l.IsSelected)||n.isNullOrUndefined(c)||-1===(it=this.getIndexofLegend(this.maps.legendSelectionCollection,c))&&this.pushCollection(c,this.maps.legendSelectionCollection,w[e.actualIndex],this.maps.layers[f].shapeSettings),tt=!0,h=0;h<this.maps.selectedLegendElementId.length;h++)e.actualIndex===this.maps.selectedLegendElementId[h]&&(tt=!1);(tt&&this.maps.selectedLegendElementId.push(e.actualIndex),this.maps.legendSelectionClass=r,this.removeLegend(this.shapeHighlightCollection),n.isNullOrUndefined(c))||(this.setColor(c,n.isNullOrUndefined(r.fill)?c.getAttribute("fill"):r.fill,r.opacity.toString(),r.border.color,r.border.width.toString(),"selection"),it=this.getIndexofLegend(this.maps.legendSelectionCollection,c),this.maps.legendSelectionCollection[it].MapShapeCollection.Elements.push(t));this.maps.shapeSelections=!1}}else document.getElementsByClassName("highlightMapStyle").length>0&&(this.removeShapeHighlightCollection(),a(document.getElementsByClassName("highlightMapStyle")[0]))}}else this.removeShapeHighlightCollection()},t.prototype.isTargetSelected=function(t,i){for(var u,r=0;r<i.length;r++)n.isNullOrUndefined(t.LegendEle.getAttribute("id"))||t.LegendEle.getAttribute("id")!==i[r].legendElement.getAttribute("id")||(u={IsSelected:!0,SelectionIndex:r});return u},t.prototype.updateLegendElement=function(){for(var n=0;n<this.maps.legendSelectionCollection.length;n++)document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id)&&(this.maps.legendSelectionCollection[n].legendElement=document.getElementById(this.maps.legendSelectionCollection[n].legendElement.id))},t.prototype.getIndexofLegend=function(n,t){return n.map(function(n){return n.legendElement}).indexOf(t)},t.prototype.removeAllSelections=function(){for(var i,r,u,t=0;t<this.maps.selectedElementId.length;t++)a(r=document.getElementById(this.maps.selectedElementId[t]));for(i=0;i<this.maps.selectedLegendElementId.length;i++)r=("Interactive"===this.maps.legendSettings.mode?"container_Legend_Index_":"container_Legend_Shape_Index_")+this.maps.selectedLegendElementId[i],u=document.getElementById(r),n.isNullOrUndefined(u)||a(document.getElementById(r));this.maps.legendSelectionCollection=[];this.maps.selectedLegendElementId=[];this.maps.selectedElementId=[]},t.prototype.legendIndexOnShape=function(t,i){var c,l,o,a=t[this.maps.layers[i].shapeDataPath],s=this.maps.legendSettings.mode,h=this.maps.legendModule.legendCollection,v,u,f,e,r;for("Default"!==s||n.isNullOrUndefined(this.maps.legendModule.totalPages)||(o=this.maps.legendModule.totalPages[this.maps.legendModule.currentPage].Collection),v="Default"===s?o.length:1,u=0;u<h.length;u++){for(f=h[u].data,e=0;e<v;e++)if("Default"!==s||h[u].text===o[e].DisplayText)for(r=0;r<f.length;r++)a===f[r].name&&(c=e);for(r=0;r<f.length;r++)a===f[r].name&&(l=u)}return{currentIndex:c,actualIndex:l}},t.prototype.shapeDataOnLegend=function(t){for(var e,o,s,h,c=this.maps.legendModule.legendCollection,v=this.maps.legendSettings,i=0;i<c.length;i++){for(var u=c[i].data,l=!1,a=[],f={Elements:[]},r=0;r<u.length;r++)o=u[r].shapeIndex,s=u[r].layerIndex,h=u[r].dataIndex,e=document.getElementById(this.maps.element.id+"_LayerIndex_"+s+"_shapeIndex_"+o+"_dataIndex_"+h),t===e&&(l=!0),a.push(e);if(l)return n.isNullOrUndefined(f.LegendEle)&&(f.LegendEle="Default"===v.mode?document.getElementById(this.maps.element.id+"_Legend_Shape_Index_"+i):document.getElementById(this.maps.element.id+"_Legend_Index_"+i)),f.Elements=a,f}return null},t.prototype.shapesOfLegend=function(t){for(var u,f,e,o,h=parseFloat(t.id.charAt(t.id.length-1)),r=this.maps.legendModule.legendCollection[h].data,s=[],i=0;i<r.length;i++)f=r[i].shapeIndex,e=r[i].layerIndex,o=r[i].dataIndex,u=document.getElementById(this.maps.element.id+"_LayerIndex_"+e+"_shapeIndex_"+f+"_dataIndex_"+o),n.isNullOrUndefined(u)||s.push(u.id);return s},t.prototype.legendToggle=function(){var u=this.maps,f=u.legendSettings,t,s,i,h,r,c,l,e,a,o;if(this.maps.selectedLegendElementId)for(t=0;t<this.maps.selectedLegendElementId.length;t++)if(s="Interactive"===f.mode?this.maps.element.id+"_Legend_Index_":this.maps.element.id+"_Legend_Shape_Index_",i=u.svgObject.querySelector("#"+s+this.maps.selectedLegendElementId[t]),!n.isNullOrUndefined(i)){for(h=n.isNullOrUndefined(this.maps.legendSelectionClass.fill)?i.getAttribute("fill"):this.maps.legendSelectionClass.fill,this.setColor(i,h,this.maps.legendSelectionClass.opacity.toString(),this.maps.legendSelectionClass.border.color,this.maps.legendSelectionClass.border.width.toString(),"selection"),r=0;r<this.maps.legendSelectionCollection.length;r++)this.maps.legendSelectionCollection[r].legendElement.id===i.id&&(this.maps.legendSelectionCollection[r].legendElement=i);-1===this.getIndexofLegend(this.maps.legendSelectionCollection,i)&&(c=this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]].data[t].layerIndex,this.pushCollection(i,this.maps.legendSelectionCollection,this.maps.legendModule.legendCollection[this.maps.selectedLegendElementId[t]],this.maps.layers[c].shapeSettings))}if(this.maps.toggledLegendId)for(t=0;t<this.maps.toggledLegendId.length;t++)l="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]+"_Text":"#"+this.maps.element.id+"_Legend_Text_Index_"+this.maps.toggledLegendId[t],e=u.svgObject.querySelector(l),n.isNullOrUndefined(e)||e.setAttribute("fill","#E5E5E5"),a="Interactive"===f.mode?"#"+this.maps.element.id+"_Legend_Index_"+this.maps.toggledLegendId[t]:"#"+this.maps.element.id+"_Legend_Shape_Index_"+this.maps.toggledLegendId[t],o=u.svgObject.querySelector(a),n.isNullOrUndefined(o)||o.setAttribute("fill","#E5E5E5")},t.prototype.renderLegendBorder=function(){var r=this.maps,t=r.legendSettings,e=t.title.text,i={fontFamily:t.titleStyle.fontFamily,fontStyle:t.titleStyle.fontStyle,fontWeight:t.titleStyle.fontWeight,size:t.titleStyle.size,color:t.titleStyle.color,opacity:t.titleStyle.opacity},o=d(this.legendItemRect.width+20,e,i),f=v(o,i),u,s;this.legendBorderRect=new c(this.legendItemRect.x-10,this.legendItemRect.y-10-f.height,this.legendItemRect.width+20,this.legendItemRect.height+20+f.height+("Interactive"===t.mode?0:0!==this.page?10:0));u={color:t.border.color,width:t.border.width,opacity:t.border.opacity};u.opacity=n.isNullOrUndefined(u.opacity)?1:u.opacity;s=new b(r.element.id+"_Legend_Border",t.background,u,1,this.legendBorderRect,null,null,"","");this.legendGroup.appendChild(r.renderer.drawRectangle(s));this.getLegendAlignment(r,this.legendBorderRect.width,this.legendBorderRect.height,t);this.legendGroup.setAttribute("transform","translate( "+(this.translate.x+-this.legendBorderRect.x)+" "+(this.translate.y+-this.legendBorderRect.y)+" )");r.svgObject.appendChild(this.legendGroup);e&&(i.color=null!==i.color?i.color:this.maps.themeStyle.legendTitleFontColor,i.fontFamily=n.isNullOrUndefined(i.fontFamily)?this.maps.themeStyle.fontFamily:i.fontFamily,ot(new nt(r.element.id+"_LegendTitle",this.legendItemRect.x+this.legendItemRect.width/2,this.legendItemRect.y-f.height/2-5,"middle",o,""),i,i.color,this.legendGroup))},t.prototype.changeNextPage=function(n){this.currentPage=n.target.id.indexOf("_Left_Page_")>-1?this.currentPage-1:this.currentPage+1;this.legendGroup=this.maps.renderer.createGroup({id:this.maps.element.id+"_Legend_Group"});this.drawLegendItem(this.currentPage);o(this.maps.element.id+"_Legend_Border",this.maps.element.id)&&(o(this.maps.element.id+"_Legend_Border",this.maps.element.id).style.pointerEvents="none")},t.prototype.getLegendAlignment=function(t,i,r,u){var o,s,e,h=(e=n.extend({},t.mapAreaRect,e,!0)).x,c=e.y,v=e.height,y=e.width,l=t.availableSize.width,a=t.availableSize.height;if("Float"===u.position)this.translate=u.location;else{switch(u.position){case"Top":case"Bottom":e.height=v-r;o=l/2-i/2;s="Top"===u.position?c:c+e.height;e.y="Top"===u.position?c+r+10:c;break;case"Left":case"Right":e.width=y-i;o="Left"===u.position?h:h+e.width-10;s=a/2-r/2;e.x="Left"===u.position?h+i:h}switch(u.alignment){case"Near":"Top"===u.position||"Bottom"===u.position?o=e.x:s=e.y;break;case"Far":"Top"===u.position||"Bottom"===u.position?o=l-i-10:s=a-r}(u.height||u.width)&&"Interactive"!==u.mode?this.legendTotalRect=t.totalRect=e:((u.height||u.width)&&"Interactive"===u.mode&&(t.totalRect=e),this.legendTotalRect=t.mapAreaRect=e);this.translate=new f(o,s)}},t.prototype.getMarkersLegendCollections=function(t,i){var r=this;Array.prototype.forEach.call(i,function(i,u){var e=i.dataSource,f=i.legendText;Array.prototype.forEach.call(e,function(e,o){var a=!!n.isNullOrUndefined(e[r.maps.legendSettings.showLegendPath])||e[r.maps.legendSettings.showLegendPath],s;if(i.visible&&a&&!n.isNullOrUndefined(e.latitude)&&!n.isNullOrUndefined(e.longitude)){i.template&&(s=ti(i.template)(r.maps),(n.isNullOrUndefined(s.childElementCount)?s[0]:s).querySelector("img").src);var h=n.isNullOrUndefined(e[f])?"":e[f],c=n.isNullOrUndefined(i.colorValuePath)?i.fill:e[i.colorValuePath],l=[];r.maps.legendSettings.removeDuplicateLegend?(l.push(r.getMarkerLegendData(t,h,c)),r.getOverallLegendItemsCollection(h,c,l,a)):(l.push({layerIndex:t,markerIndex:u,dataIndex:o,value:c,name:h,shape:n.isNullOrUndefined(i.shapeValuePath)||n.isNullOrUndefined(e[i.shapeValuePath])||""===e[i.shapeValuePath]?r.maps.legendSettings.useMarkerShape?i.shape:r.maps.legendSettings.shape:e[i.shapeValuePath]}),r.getOverallLegendItemsCollection(h,c,l,a))}})})},t.prototype.getMarkerLegendData=function(t,i,r){var f=this,u=[];return this.maps.layers[t].markerSettings.map(function(e,o){var s=e.dataSource;Array.prototype.forEach.call(s,function(e,s){var h=f.maps.layers[t].markerSettings[o];i!==e[h.legendText]&&""!==i||r!==e[h.colorValuePath]||u.push({layerIndex:t,markerIndex:o,dataIndex:s,value:r,name:i,shape:n.isNullOrUndefined(h.shapeValuePath)?h.shape:e[h.shapeValuePath]})})}),u},t.prototype.getRangeLegendCollection=function(t,i,r,u,f,o,s){for(var l,w=this,a=0,v=this.maps.legendSettings.fill,h=[],b=function(r){var c,p;n.isNullOrUndefined(r.from)||n.isNullOrUndefined(r.to)||(l=n.isNullOrUndefined(r.label)?r.from+" - "+r.to:r.label,h=[],c=!1,Array.prototype.forEach.call(u,function(n,u){var l=o.indexOf(".")>-1?Number(e(n,o)):parseFloat(n[o]);l>=r.from&&l<=r.to&&(c=!0,h.push(w.getLegendData(t,u,n,f,i,s,l)))}),c||h.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null}),p=n.isNullOrUndefined(v)?"[object Array]"===Object.prototype.toString.call(r.color)?n.isNullOrUndefined(r.value)?y.legendGradientColor(r,a):r.color[0]:r.color:v,a++,y.getOverallLegendItemsCollection(l,p,h,r.showLegend))},y=this,c=0,p=r;c<p.length;c++)b(p[c])},t.prototype.getOverallLegendItemsCollection=function(n,t,i,r){var f=[],s=this.maps.legendSettings,u,e,o;if(i.length>0&&r){for(u=0;u<i.length;u++){if(e=i[u],e.length>0)for(o=0;o<e.length;o++)f.push(e[o]);else f.push(i[u]);f._isVisible=!0}this.maps.legendSettings.removeDuplicateLegend&&this.removeDuplicates(this.legendCollection,n,t)||this.legendCollection.push({text:n,fill:t,data:f,opacity:s.opacity,borderColor:s.shapeBorder.color,borderWidth:s.shapeBorder.width})}},t.prototype.removeDuplicates=function(n,t,i){for(var u=!1,r=0;r<n.length;r++)if((n[r].text===t||""===n[r].text)&&n[r].fill===i){u=!0;break}return u},t.prototype.getEqualLegendCollection=function(t,i,r,u,f,o,s){for(var l,v=this,w=this.maps.legendSettings.fill,c=[],a=[],h=[],y=[],d=function(p){var k,tt,nt,d,g,it,rt;if(n.isNullOrUndefined(p.value))n.isNullOrUndefined(p.minOpacity)&&n.isNullOrUndefined(p.maxOpacity)&&n.isNullOrUndefined(p.value)&&n.isNullOrUndefined(p.from)&&n.isNullOrUndefined(p.to)&&!n.isNullOrUndefined(p.color)&&((Array.prototype.forEach.call(u,function(n,r){for(var c=o.indexOf(".")>-1?e(n,o):n[o],u=0;u<h.length;u++)c===h[u]&&y.push(v.getLegendData(t,r,n,f,i,s,c))}),0===h.length)&&(k=!1,Array.prototype.forEach.call(u,function(u,e){k=!1;for(var h=u[o],c=0;c<r.length;c++)n.isNullOrUndefined(h)||isNaN(h)?k||(k=!1):h>=r[c].from&&h<=r[c].to&&(k=!0);k||y.push(v.getLegendData(t,e,u,f,i,s,h))})),l=n.isNullOrUndefined(p.label)?"Others":p.label,tt="[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color,b.getOverallLegendItemsCollection(l,tt,y,p.showLegend));else{for(l=n.isNullOrUndefined(p.label)?p.value:p.label,a=[],nt=!1,Array.prototype.forEach.call(u,function(n,r){var u=o.indexOf(".")>-1?e(n,o):n[o];u===p.value?(nt=!0,-1===c.indexOf(u)&&c.push(u),a.push(v.getLegendData(t,r,n,f,i,s,u))):-1===h.indexOf(u)&&h.push(u)}),d=0;d<c.length;d++)for(g=0;g<h.length;g++)c[d]===h[g]&&(it=h.indexOf(c[d]),h.splice(it,1));nt||a.push({layerIndex:t,shapeIndex:null,dataIndex:null,name:null,value:null});rt=n.isNullOrUndefined(w)?"[object Array]"===Object.prototype.toString.call(p.color)?p.color[0]:p.color:w;b.getOverallLegendItemsCollection(l,rt,a,p.showLegend)}},b=this,p=0,k=r;p<k.length;p++)d(k[p])},t.prototype.getDataLegendCollection=function(t,i,r,u,f,o,s){var l,h=this,a=this.maps.legendSettings.fill,c=this.maps.legendSettings.valuePath;n.isNullOrUndefined(o)||n.isNullOrUndefined(u)||Array.prototype.forEach.call(u,function(u,v){var w=!!n.isNullOrUndefined(h.maps.legendSettings.showLegendPath)||!n.isNullOrUndefined(u[h.maps.legendSettings.showLegendPath])&&u[h.maps.legendSettings.showLegendPath],y=o.indexOf(".")>-1?e(u,o):u[o],p=[],b=n.isNullOrUndefined(a)?y:a;n.isNullOrUndefined(y)||0!==r.length||(l=n.isNullOrUndefined(u[c])?f.indexOf(".")>-1?e(u,f):u[f]:c.indexOf(".")>-1?e(u,c):u[c],p.push(h.getLegendData(t,v,u,f,i,s,y)));h.getOverallLegendItemsCollection(l,b,p,w)})},t.prototype.interactiveHandler=function(t){var e=t.target,i=this.maps.legendSettings,r=this.maps.element.id+"_Interactive_Legend",g="Layers"===i.type?"_shapeIndex_":"Markers"===i.type?"_MarkerIndex_":"_BubbleIndex_",a,b,v,u,h,f;if(e.id.indexOf(g)>1){var l=parseFloat(e.id.split("_LayerIndex_")[1].split("_")[0]),nt=parseFloat(e.id.split(/_dataIndex_/i)[1].split("_")[0]),y=void 0,p=void 0,w=void 0;if(n.isNullOrUndefined(o(r,this.maps.element.id))||n.remove(o(r,this.maps.element.id)),a=this.maps.layersCollection[l],b="Layers"===i.type?a.visible:"Markers"===i.type?a.markerSettings[parseFloat(e.id.split("_MarkerIndex_")[1].split("_")[0])].visible:this.maps.getBubbleVisible(this.maps.layersCollection[l]),i.visible&&this.legendRenderingCollections.length>0&&"Interactive"===i.mode&&b)for(v=this.maps.svgObject.getBoundingClientRect(),u=0;u<this.legendCollection.length;u++){var k=this.legendCollection[u],d=o(this.maps.element.id+"_Legend_Index_"+u,this.maps.element.id),s=d.getBoundingClientRect(),tt=new c(Math.abs(s.left-v.left),Math.abs(s.top-v.top),s.width,s.height);if(y=d.getAttribute("fill"),p=i.shapeBorder.color,w=i.shapeBorder.width,!n.isNullOrUndefined(k.data))for(h=k.data,f=0;f<h.length;f++)if(nt===h[f].dataIndex&&l===h[f].layerIndex){this.renderInteractivePointer(i,y,p,r,w,tt);break}}}else n.isNullOrUndefined(o(r,this.maps.element.id))||n.remove(o(r,this.maps.element.id))},t.prototype.renderInteractivePointer=function(n,t,i,r,u,f){var c,e,o,s=10,h=10,l;c="Horizontal"===("None"===n.orientation?"Top"===n.position||"Bottom"===n.position?"Horizontal":"Vertical":n.orientation)?n.invertedPointer?" M "+(e=f.x+f.width/2)+" "+(o=f.y+f.height)+" L "+(e-h)+" "+(o+s)+" L "+(e+h)+" "+(o+s)+" Z ":" M "+(e=f.x+f.width/2)+" "+(o=f.y)+" L "+(e-h)+" "+(o-s)+" L "+(e+h)+" "+(o-s)+" Z ":n.invertedPointer?" M "+(e=f.x)+" "+(o=f.y+f.height/2)+" L "+(e-h)+" "+(o-s)+" L "+(e-h)+" "+(o+s)+" z ":" M "+(e=f.x+f.width)+" "+(o=f.y+f.height/2)+" L "+(e+h)+" "+(o-s)+" L "+(e+h)+" "+(o+s)+" z ";l=new p(r,t,u,i,1,1,"",c);this.maps.svgObject.appendChild(this.maps.renderer.drawPath(l))},t.prototype.wireEvents=function(t){n.EventHandler.add(t,n.Browser.touchStartEvent,this.changeNextPage,this)},t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.interactiveHandler,this),this.maps.on(n.Browser.touchEndEvent,this.interactiveHandler,this),this.maps.on(rt,this.legendClick,this))},t.prototype.markerToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].markerSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].markerSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].markerSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].markerSettings[r].border.opacity)?this.maps.layers[i].markerSettings[r].opacity:this.maps.layers[i].markerSettings[r].border.opacity).toString())},t.prototype.bubbleToggleSelection=function(t,i,r,u){t.setAttribute("fill",this.legendCollection[u].fill);t.setAttribute("stroke",this.maps.layers[i].bubbleSettings[r].border.color);t.setAttribute("fill-opacity",this.maps.layers[i].bubbleSettings[r].opacity.toString());t.setAttribute("stroke-width",this.maps.layers[i].bubbleSettings[r].border.width.toString());t.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].bubbleSettings[r].border.opacity)?this.maps.layers[i].bubbleSettings[r].opacity:this.maps.layers[i].bubbleSettings[r].border.opacity).toString())},t.prototype.legendClick=function(t){var y,b=this.maps.legendSettings.toggleLegendSettings.fill,k=this.maps.legendSettings.toggleLegendSettings.opacity,d=this.maps.legendSettings.toggleLegendSettings.border.color,g=this.maps.legendSettings.toggleLegendSettings.border.width,nt=n.isNullOrUndefined(this.maps.legendSettings.toggleLegendSettings.border.opacity)?this.maps.legendSettings.toggleLegendSettings.opacity:this.maps.legendSettings.toggleLegendSettings.border.opacity,i,u,f,e,tt,w,p,h,a,s,it;if(t.parentNode.id.indexOf(this.maps.element.id+"_Legend_Index_")>-1){var c=void 0,r=parseFloat(t.parentElement.id.substr((this.maps.element.id+"_Legend_Index_").length)),v=(p=this.legendCollection[r].data)._isVisible,l=void 0;if(this.maps.legendSettings.toggleLegendSettings.enable&&("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type))for(i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(f=0;f<p.length;f++)l=this.legendCollection[r].data[f],c="Bubbles"===this.maps.legendSettings.type?o(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+l.dataIndex,this.maps.element.id):o(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_MarkerIndex_"+l.markerIndex+"_dataIndex_"+l.dataIndex,this.maps.element.id),n.isNullOrUndefined(l.shape)||"Balloon"!==l.shape||(c=c.children[0]),v&&null!==c?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(c.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),c.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color),c.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),c.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),c.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(c.setAttribute("fill",b),c.setAttribute("fill-opacity",k.toString()),c.setAttribute("stroke",d),c.setAttribute("stroke-width",g.toString()),c.setAttribute("stroke-opacity",nt.toString())),null!==t&&((y=o(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id)).setAttribute("fill","#E5E5E5"),"HorizontalLine"!==this.maps.legendSettings.shape&&"VerticalLine"!==this.maps.legendSettings.shape&&"Cross"!==this.maps.legendSettings.shape||y.setAttribute("stroke","#E5E5E5"),o(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id).setAttribute("fill","#E5E5E5"))):("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(c,i,u,r):this.bubbleToggleSelection(c,i,u,r),null!==t&&((y=o(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill),"HorizontalLine"!==this.maps.legendSettings.shape&&"VerticalLine"!==this.maps.legendSettings.shape&&"Cross"!==this.maps.legendSettings.shape||y.setAttribute("stroke",this.legendCollection[r].fill),o(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id).setAttribute("fill","#757575")));p._isVisible=!v}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(e=void 0,this.removeCollections(t,r),tt=this.maps.toggledLegendId.indexOf(r),-1!==tt&&(v=!1),u=0;u<this.maps.layers.length;u++)for(f=0;f<p.length;f++)(l=this.legendCollection[r].data[f],null!==(e=o(this.maps.element.id+"_LayerIndex_"+l.layerIndex+"_shapeIndex_"+l.shapeIndex+"_dataIndex_"+l.dataIndex,this.maps.element.id)))&&(w=this.maps.toggledShapeElementId.indexOf(e.id),v?(0===f&&this.maps.toggledLegendId.push(r),-1===w&&this.maps.toggledShapeElementId.push(e.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(e.setAttribute("fill",this.maps.layers[u].shapeSettings.fill),e.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),e.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),e.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),e.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString())):(e.setAttribute("fill",b),e.setAttribute("fill-opacity",k.toString()),e.setAttribute("stroke",d),e.setAttribute("stroke-width",g.toString()),e.setAttribute("stroke-opacity",nt.toString())),null!==t&&(o(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id).setAttribute("fill","#E5E5E5"),(y=o(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id)).setAttribute("fill","#E5E5E5"))):(-1!==tt&&0===f&&this.maps.toggledLegendId.splice(tt,1),-1!==w&&this.maps.toggledShapeElementId.splice(w,1),e.setAttribute("fill",this.legendCollection[r].fill),e.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.opacity)?this.maps.layers[u].shapeSettings.opacity:this.maps.layers[u].shapeSettings.border.opacity).toString()),e.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[u].shapeSettings.border.width)?0:this.maps.layers[u].shapeSettings.border.width).toString()),e.setAttribute("fill-opacity",this.maps.layers[u].shapeSettings.opacity.toString()),e.setAttribute("stroke",this.maps.layers[u].shapeSettings.border.color),null!==t&&(o(this.maps.element.id+"_Legend_Text_Index_"+r,this.maps.element.id).setAttribute("fill","#757575"),(y=o(this.maps.element.id+"_Legend_Shape_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill))));p._isVisible=!v}}else if(!n.isNullOrUndefined(t.id)&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendSettings.visible&&-1===t.id.indexOf("_Text")){if(h=void 0,a=void(r=parseFloat(t.id.split(this.maps.element.id+"_Legend_Index_")[1])),v=(p=this.legendCollection[r].data)._isVisible,("Bubbles"===this.maps.legendSettings.type||"Markers"===this.maps.legendSettings.type)&&this.maps.legendSettings.toggleLegendSettings.enable)for(i=0;i<this.maps.layers.length;i++)for(u=0;u<("Bubbles"===this.maps.legendSettings.type?this.maps.layers[i].bubbleSettings.length:this.maps.layers[i].markerSettings.length);u++){for(f=0;f<p.length;f++)a=this.legendCollection[r].data[f],h="Bubbles"===this.maps.legendSettings.type?o(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_BubbleIndex_"+u+"_dataIndex_"+a.dataIndex,this.maps.element.id):o(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_MarkerIndex_"+u+"_dataIndex_"+a.dataIndex,this.maps.element.id),n.isNullOrUndefined(a.shape)||"Balloon"!==a.shape||(h=h.children[0]),v&&null!==h?(this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(h.setAttribute("fill",this.maps.layers[i].shapeSettings.fill),h.setAttribute("stroke",this.maps.layers[i].shapeSettings.border.color),h.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),h.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),h.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString())):(h.setAttribute("fill",b),h.setAttribute("fill-opacity",k.toString()),h.setAttribute("stroke",d),h.setAttribute("stroke-width",g.toString()),h.setAttribute("stroke-opacity",nt.toString())),null!==t&&(o(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id).setAttribute("fill","#E5E5E5"),(y=o(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill","#E5E5E5"))):("Markers"===this.maps.legendSettings.type?this.markerToggleSelection(h,i,u,r):this.bubbleToggleSelection(h,i,u,r),null!==t&&((y=o(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill),o(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id).setAttribute("fill","#757575")));p._isVisible=!v}if("Layers"===this.maps.legendSettings.type&&this.maps.legendSettings.toggleLegendSettings.enable){for(s=void 0,this.removeCollections(t,r),it=this.maps.toggledLegendId.indexOf(r),-1!==it&&(v=!1),i=0;i<this.maps.layers.length;i++)for(f=0;f<p.length;f++)a=this.legendCollection[r].data[f],null!==(s=o(this.maps.element.id+"_LayerIndex_"+a.layerIndex+"_shapeIndex_"+a.shapeIndex+"_dataIndex_"+a.dataIndex,this.maps.element.id))&&(w=this.maps.toggledShapeElementId.indexOf(s.id),v?(0===f&&this.maps.toggledLegendId.push(r),-1===w&&this.maps.toggledShapeElementId.push(s.id),this.maps.legendSettings.toggleLegendSettings.applyShapeSettings?(s.setAttribute("fill",this.maps.layers[0].shapeSettings.fill),s.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),s.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),s.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),s.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString())):(s.setAttribute("fill",b),s.setAttribute("fill-opacity",k.toString()),s.setAttribute("stroke",d),s.setAttribute("stroke-width",g.toString()),s.setAttribute("stroke-opacity",nt.toString())),null!==t&&((y=o(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill","#E5E5E5"),o(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id).setAttribute("fill","#E5E5E5"))):(-1!==it&&0===f&&this.maps.toggledLegendId.splice(it,1),-1!==w&&this.maps.toggledShapeElementId.splice(w,1),s.setAttribute("fill-opacity",this.maps.layers[i].shapeSettings.opacity.toString()),s.setAttribute("stroke-width",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.width)?0:this.maps.layers[i].shapeSettings.border.width).toString()),s.setAttribute("stroke",this.maps.layers[0].shapeSettings.border.color),s.setAttribute("stroke-opacity",(n.isNullOrUndefined(this.maps.layers[i].shapeSettings.border.opacity)?this.maps.layers[i].shapeSettings.opacity:this.maps.layers[i].shapeSettings.border.opacity).toString()),s.setAttribute("fill",this.legendCollection[r].fill),null!==t&&(o(this.maps.element.id+"_Legend_Index_"+r+"_Text",this.maps.element.id).setAttribute("fill","#757575"),(y=o(this.maps.element.id+"_Legend_Index_"+r,this.maps.element.id)).setAttribute("fill",this.legendCollection[r].fill))));p._isVisible=!v}}},t.prototype.removeCollections=function(n,t){var i,r,u;this.removeLegendSelectionCollection(n);i=this.getIndexofLegend(this.maps.legendSelectionCollection,n);-1!==i&&this.maps.legendSelectionCollection.splice(i,1);-1!==this.getIndexofLegend(this.legendHighlightCollection,n)&&this.legendHighlightCollection.splice(i,1);r=this.getIndexofLegend(this.shapeHighlightCollection,n);-1!==r&&this.shapeHighlightCollection.splice(r,1);u=this.maps.selectedLegendElementId.indexOf(t);-1!==u&&this.maps.selectedLegendElementId.splice(u,1)},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(n.Browser.touchMoveEvent,this.interactiveHandler),this.maps.off(n.Browser.touchEndEvent,this.interactiveHandler),this.maps.off(rt,this.legendClick))},t.prototype.getLegendData=function(t,i,r,u,f,o,s){var v=[],h;if("[object Array]"===Object.prototype.toString.call(f))for(h=0;h<f.length;h++){var c=f[h],a=u.indexOf(".")>-1?e(r,u):r[u],l=ni(r[u],o,c.properties),y=n.isNullOrUndefined(a)?a:a.toLowerCase();(!n.isNullOrUndefined(c.properties[l])&&isNaN(c.properties[l])?c.properties[l].toLowerCase():c.properties[l])===y&&v.push({layerIndex:t,shapeIndex:h,dataIndex:i,name:r[u],value:s})}return v},t.prototype.legendGradientColor=function(t,i){var o,s="http://www.w3.org/2000/svg",u,h,f,c;if(!n.isNullOrUndefined(t.color)&&"object"==typeof t.color){var r=document.createElementNS(s,"linearGradient"),e=this.maps.legendSettings.position,l="Top"===e||"Bottom"===e?"100":"0",a="Top"===e||"Bottom"===e?"0":"100";for(r.setAttribute("id","linear_"+i+"_"+this.maps.element.id),r.setAttribute("x1","0%"),r.setAttribute("y1","0%"),r.setAttribute("x2",l+"%"),r.setAttribute("y2",a+"%"),u=0;u<t.color.length;u++)h=100/(t.color.length-1),f=document.createElementNS(s,"stop"),f.setAttribute("offset",u*h+"%"),f.setAttribute("stop-color",t.color[u]),f.setAttribute("stop-opacity",1..toString()),r.appendChild(f);this.legendLinearGradient=r;c="url(#linear_"+i+"_"+this.maps.element.id+")";this.defsElement.appendChild(r);o=c}return o},t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){this.removeEventListener()},t}(),ge=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(n.Browser.touchMoveEvent,this.mouseMove,this),this.maps.on(n.Browser.touchStartEvent,this.mouseMove,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(n.Browser.touchMoveEvent,this.mouseMove),this.maps.off(n.Browser.touchStartEvent,this.mouseMove))},t.prototype.addHighlight=function(n,t,i){var r=yr(n,t,0,this.maps);i?this.mapHighlight(r,null,null):a(r)},t.prototype.mouseMove=function(t){var r,i=t.target,y="touch"===t.pointerType||"2"===t.pointerType||t.type.indexOf("touch")>-1,h,c,u,f,l;if((-1!==i.id.indexOf("LayerIndex")||i.id.indexOf("NavigationIndex")>-1)&&"ShapeselectionMapStyle"!==i.getAttribute("class")&&!y&&"MarkerselectionMapStyle"!==i.getAttribute("class")&&"BubbleselectionMapStyle"!==i.getAttribute("class")&&"navigationlineselectionMapStyle"!==i.getAttribute("class")){r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10);var s=void 0,o=void 0,v=void 0,e=void 0;i.id.indexOf("shapeIndex")>-1?(v=parseInt(i.id.split("_shapeIndex_")[1].split("_")[0],10),s=this.maps.layers[r].shapeData.features?this.maps.layers[r].shapeData.features[v].properties:null,e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=n.isNullOrUndefined(e)?null:this.maps.layers[r].dataSource[e],this.highlightSettings=this.maps.layers[r].highlightSettings):i.id.indexOf("BubbleIndex")>-1?(h=parseInt(i.id.split("_BubbleIndex_")[1].split("_")[0],10),e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].bubbleSettings[h].dataSource[e],this.highlightSettings=this.maps.layers[r].bubbleSettings[h].highlightSettings):i.id.indexOf("MarkerIndex")>-1?(c=parseInt(i.id.split("_MarkerIndex_")[1].split("_")[0],10),e=parseInt(i.id.split("_dataIndex_")[1].split("_")[0],10),o=this.maps.layers[r].markerSettings[c].dataSource[e],this.highlightSettings=this.maps.layers[r].markerSettings[c].highlightSettings):(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.id.split("_LayerIndex_")[1].split("_")[0],10),s=null,o={latitude:this.maps.layers[r].navigationLineSettings[u].latitude,longitude:this.maps.layers[r].navigationLineSettings[u].longitude},this.highlightSettings=this.maps.layers[r].navigationLineSettings[u].highlightSettings);this.highlightSettings.enable?this.handleHighlight(i,r,o,s):(f=document.getElementsByClassName("highlightMapStyle")[0],!n.isNullOrUndefined(f)&&(a(f),f.id.indexOf("NavigationIndex")>-1)&&(u=parseInt(f.id.split("_NavigationIndex_")[1].split("_")[0],10),l=parseInt(f.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),f.setAttribute("stroke-width",this.maps.layers[l].navigationLineSettings[u].width.toString()),f.setAttribute("stroke",this.maps.layers[l].navigationLineSettings[u].color)))}else ht("highlightMapStyle").length>0?((i=ht("highlightMapStyle")[0]).id.indexOf("NavigationIndex")>-1&&(u=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),r=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[r].navigationLineSettings[u].width.toString()),i.setAttribute("stroke",this.maps.layers[r].navigationLineSettings[u].color)),a(i),this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeShapeHighlightCollection()):(-1!==i.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")||-1!==i.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule&&this.maps.legendSettings.visible&&-1===i.id.indexOf("_Text")?this.maps.legendModule.legendHighLightAndSelection(i,"highlight"):this.maps.legendSettings.visible&&this.maps.legendModule&&this.maps.legendModule.removeLegendHighlightCollection()},t.prototype.handleHighlight=function(n,t,i,r){this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.highlightSettings,"highlight",t);n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule&&!this.maps.legendModule.shapeToggled||this.mapHighlight(n,r,i)},t.prototype.mapHighlight=function(t,i,r){var u=this,h=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),e=!1,o,s,f;t.id.indexOf("MarkerIndex")>-1&&(o=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),e=this.maps.layers[h].markerSettings[o].highlightSettings.enable);s={color:-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.color:this.highlightSettings.border.color||this.highlightSettings.fill,width:-1===t.parentElement.id.indexOf("LineString")?this.highlightSettings.border.width/(e?1:this.maps.scale):this.highlightSettings.border.width/this.maps.scale,opacity:this.highlightSettings.border.opacity};f={opacity:this.highlightSettings.opacity,fill:-1===t.parentElement.id.indexOf("LineString")?-1===t.id.indexOf("NavigationIndex")?n.isNullOrUndefined(this.highlightSettings.fill)?t.getAttribute("fill"):this.highlightSettings.fill:"none":"transparent",border:s,name:ff,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};this.maps.trigger(ff,f,function(){f.border.opacity=n.isNullOrUndefined(u.highlightSettings.border.opacity)?u.highlightSettings.opacity:u.highlightSettings.border.opacity;u.highlightMap(t,f)})},t.prototype.highlightMap=function(n,t){var i,r,u;"highlightMapStyle"!==n.getAttribute("class")&&(ht("highlightMapStyle").length>0&&(i=ht("highlightMapStyle")[0],(a(i),i.id.indexOf("NavigationIndex")>-1)&&(r=parseInt(i.id.split("_NavigationIndex_")[1].split("_")[0],10),u=parseInt(i.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",this.maps.layers[u].navigationLineSettings[r].width.toString()),i.setAttribute("stroke",this.maps.layers[u].navigationLineSettings[r].color))),s("highlightMap")?vt("highlightMap","highlightMapStyle",t):document.body.appendChild(ii("highlightMap","highlightMapStyle",t)),n.setAttribute("class","highlightMapStyle"))},t.prototype.getModuleName=function(){return"Highlight"},t.prototype.destroy=function(){this.removeEventListener()},t}(),no=function(){function t(n){this.maps=n;this.addEventListener()}return t.prototype.addEventListener=function(){this.maps.isDestroyed||(this.maps.on(rt,this.mouseClick,this),this.maps.on(n.Browser.touchEndEvent,this.mouseClick,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(this.maps.off(rt,this.mouseClick),this.maps.off(n.Browser.touchEndEvent,this.mouseClick))},t.prototype.mouseClick=function(t){var s,h,f;if(!n.isNullOrUndefined(t.type)&&-1!==t.type.indexOf("touch")&&n.isNullOrUndefined(t.id)&&(t=t.target),!n.isNullOrUndefined(t.id)&&(t.id.indexOf("LayerIndex")>-1||t.id.indexOf("NavigationIndex")>-1)){var e=void 0,u=void 0,o=void 0,r=void 0,i=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10);t.id.indexOf("shapeIndex")>-1?(o=parseInt(t.id.split("_shapeIndex_")[1].split("_")[0],10),e=this.maps.layers[i].shapeData.features.length>o?this.maps.layers[i].shapeData.features[o].properties:null,r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=n.isNullOrUndefined(r)?null:this.maps.layers[i].dataSource[r],this.selectionsettings=this.maps.layers[i].selectionSettings,this.selectionType="Shape"):t.id.indexOf("BubbleIndex")>-1?(s=parseInt(t.id.split("_BubbleIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].bubbleSettings[s].dataSource[r],this.selectionsettings=this.maps.layers[i].bubbleSettings[s].selectionSettings,this.selectionType="Bubble"):t.id.indexOf("MarkerIndex")>-1?(h=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),r=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),u=this.maps.layers[i].markerSettings[h].dataSource[r],this.selectionsettings=this.maps.layers[i].markerSettings[h].selectionSettings,this.selectionType="Marker"):(f=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),e=null,u={latitude:this.maps.layers[i].navigationLineSettings[f].latitude,longitude:this.maps.layers[i].navigationLineSettings[f].longitude},this.selectionsettings=this.maps.layers[i].navigationLineSettings[f].selectionSettings,this.selectionType="navigationline");this.selectionsettings.enable&&this.selectElement(t,i,u,e)}else this.maps.legendSettings.visible&&!this.maps.legendSettings.toggleLegendSettings.enable&&this.maps.legendModule&&!n.isNullOrUndefined(t.id)&&-1===t.id.indexOf("_Text")&&(t.id.indexOf(this.maps.element.id+"_Legend_Shape_Index")>-1||-1!==t.id.indexOf(this.maps.element.id+"_Legend_Index"))&&this.maps.legendModule.legendHighLightAndSelection(t,"selection")},t.prototype.selectElement=function(n,t,i,r){this.maps.mapSelect=!!n;this.maps.legendModule&&this.maps.legendSettings.visible&&-1===n.id.indexOf("_MarkerIndex_")&&this.maps.legendModule.shapeHighLightAndSelection(n,i,this.selectionsettings,"selection",t);(!(n.id.indexOf("shapeIndex")>-1&&this.maps.legendSettings.visible&&this.maps.legendModule)||this.maps.legendModule.shapeToggled)&&this.selectMap(n,r,i)},t.prototype.addSelection=function(n,t,i){var r=yr(n,t,0,this.maps);i?this.selectMap(r,null,null):a(r)},t.prototype.selectMap=function(t,i,r){var f=this,o=(parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),this.selectionsettings,{color:-1===t.parentElement.id.indexOf("LineString")?this.selectionsettings.border.color:this.selectionsettings.border.color||this.selectionsettings.fill,width:-1===t.parentElement.id.indexOf("LineString")?this.selectionsettings.border.width/("Marker"===this.selectionType?1:this.maps.scale):this.selectionsettings.border.width/this.maps.scale,opacity:this.selectionsettings.border.opacity}),e={opacity:this.selectionsettings.opacity,fill:-1===t.parentElement.id.indexOf("LineString")?"navigationline"!==this.selectionType?this.selectionsettings.fill:"none":"transparent",border:o,name:uf,target:t.id,cancel:!1,shapeData:i,data:r,maps:this.maps};this.maps.trigger("itemSelection",e,function(){var o,r,c,h,p,l,w,v;if(e.border.opacity=n.isNullOrUndefined(f.selectionsettings.border.opacity)?f.selectionsettings.opacity:f.selectionsettings.border.opacity,!e.cancel)if(t.getAttribute("class")===f.selectionType+"selectionMapStyle"){for(a(t),f.removedSelectionList(t),o=0;o<f.maps.shapeSelectionItem.length;o++)if(f.maps.shapeSelectionItem[o]===e.shapeData){f.maps.shapeSelectionItem.splice(o,1);break}t.id.indexOf("NavigationIndex")>-1&&(r=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),c=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),t.setAttribute("stroke-width",f.maps.layers[c].navigationLineSettings[r].width.toString()),t.setAttribute("stroke",f.maps.layers[c].navigationLineSettings[r].color))}else{if(h=u(f.maps.element.id+"_Layer_Collections"),!f.selectionsettings.enableMultiSelect&&h.getElementsByClassName(f.selectionType+"selectionMapStyle").length>0){for(var b=h.getElementsByClassName(f.selectionType+"selectionMapStyle").length,i=void 0,y=0;y<b;y++)a(i=h.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),f.removedSelectionList(i);if("Shape"===f.selectionType)for(f.maps.shapeSelectionItem=[],p=f.maps.selectedElementId.length,l=0;l<p;l++)a(i=h.getElementsByClassName(f.selectionType+"selectionMapStyle")[0]),w=f.maps.selectedElementId.indexOf(i.getAttribute("id")),f.maps.selectedElementId.splice(w,1);i.id.indexOf("NavigationIndex")>-1&&(r=parseInt(t.id.split("_NavigationIndex_")[1].split("_")[0],10),v=parseInt(t.parentElement.id.split("_LayerIndex_")[1].split("_")[0],10),i.setAttribute("stroke-width",f.maps.layers[v].navigationLineSettings[r].width.toString()),i.setAttribute("stroke",f.maps.layers[v].navigationLineSettings[r].color))}s(f.selectionType+"selectionMap")?vt(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e):document.body.appendChild(ii(f.selectionType+"selectionMap",f.selectionType+"selectionMapStyle",e));t.setAttribute("class",f.selectionType+"selectionMapStyle");"ShapeselectionMapStyle"===t.getAttribute("class")&&(f.maps.shapeSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedElementId.push(t.getAttribute("id")),f.maps.shapeSelectionItem.push(e.shapeData));"MarkerselectionMapStyle"===t.getAttribute("class")&&(f.maps.markerSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedMarkerElementId.push(t.getAttribute("id")));"BubbleselectionMapStyle"===t.getAttribute("class")&&(f.maps.bubbleSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedBubbleElementId.push(t.getAttribute("id")));"navigationlineselectionMapStyle"===t.getAttribute("class")&&(f.maps.navigationSelectionClass=s(f.selectionType+"selectionMap"),f.maps.selectedNavigationElementId.push(t.getAttribute("id")))}})},t.prototype.removedSelectionList=function(n){"Shape"===this.selectionType&&this.maps.selectedElementId.splice(this.maps.selectedElementId.indexOf(n.getAttribute("id")),1);"Bubble"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1);"Marker"===this.selectionType&&this.maps.selectedMarkerElementId.splice(this.maps.selectedMarkerElementId.indexOf(n.getAttribute("id")),1);"navigationline"===this.selectionType&&this.maps.selectedBubbleElementId.splice(this.maps.selectedBubbleElementId.indexOf(n.getAttribute("id")),1)},t.prototype.getModuleName=function(){return"Selection"},t.prototype.destroy=function(){this.removeEventListener()},t}(),to=function(){function t(n){this.maps=n;this.tooltipId=this.maps.element.id+"_mapsTooltip";this.addEventListener()}return t.prototype.renderTooltip=function(t){var ft,ot,d,st,o,y,i,u=this,ht,w,k,tt,it,vt,pt,l,ut;-1!==t.type.indexOf("touch")?(this.isTouch=!0,ft=(st=t).changedTouches[0].pageX,ot=st.changedTouches[0].pageY,d=st.target):(this.isTouch="touch"===t.pointerType,ft=t.pageX,ot=t.pageY,d=t.target);var g,nt,ct,v="",f=d.id,p=[],h=f.indexOf("_LayerIndex_")>-1&&parseFloat(f.split("_LayerIndex_")[1].split("_")[0]),r=this.maps.layersCollection[h],wt=hi(ft,ot,this.maps.svgObject);if(this.tooltipTargetID=f,f.indexOf("_shapeIndex_")>-1||f.indexOf("_MarkerIndex_")>-1||f.indexOf("_BubbleIndex_")>-1){if(f.indexOf("_shapeIndex_")>-1){if(i=r.tooltipSettings,ht=parseInt(f.split("_shapeIndex_")[1].split("_")[0],10),n.isNullOrUndefined(r.layerData)||n.isNullOrUndefined(r.layerData[ht]))return;var c=r.layerData[ht].property,at=!1,b="[object Array]"===Object.prototype.toString.call(r.shapePropertyPath)?r.shapePropertyPath:[r.shapePropertyPath];if(!n.isNullOrUndefined(b)){for(w=0;w<b.length;w++)for(k=0;k<r.dataSource.length;k++)if(tt=r.dataSource[k],it=r.shapeDataPath.indexOf(".")>-1?e(tt,r.shapeDataPath):tt[r.shapeDataPath],(!n.isNullOrUndefined(it)&&isNaN(tt[r.shapeDataPath])?it.toLowerCase():it)===(!n.isNullOrUndefined(c[b[w]])&&isNaN(c[b[w]])?c[b[w]].toLowerCase():c[b[w]])){at=!0;h=k;w=b.length;break}if(h=at?h:null,!n.isNullOrUndefined(r.dataSource[h]))for(nt in p=JSON.parse(JSON.stringify(r.dataSource[h])),c)p.hasOwnProperty(nt)||(p[nt]=c[nt])}!i.visible||(n.isNullOrUndefined(h)||isNaN(h))&&n.isNullOrUndefined(c)||(r.tooltipSettings.format?v=this.formatter(r.tooltipSettings.format,p):(vt=ni(r.shapeDataPath,r.shapePropertyPath,c),v=n.isNullOrUndefined(r.dataSource)||n.isNullOrUndefined(h)?c[vt]:lt(i.valuePath.indexOf(".")>-1?e(r.dataSource[h],i.valuePath):r.dataSource[h][i.valuePath],this.maps),n.isNullOrUndefined(v)&&(v=i.valuePath.indexOf(".")>-1?e(c,i.valuePath):c[i.valuePath])))}else if(f.indexOf("_MarkerIndex_")>-1){var yt=parseInt(f.split("_MarkerIndex_")[1].split("_")[0],10),a=parseInt(f.split("_MarkerIndex_")[1].split("_")[2],10),s=r.markerSettings[yt];i=s.tooltipSettings;p=s.dataSource[a];i.visible&&!isNaN(yt)&&(v=s.tooltipSettings.format?this.formatter(s.tooltipSettings.format,s.dataSource[a]):s.template&&!s.tooltipSettings.valuePath?s.template.split(">")[1].split("<")[0]:lt(s.tooltipSettings.valuePath.indexOf(".")>-1?e(s.dataSource[a],s.tooltipSettings.valuePath):s.dataSource[a][s.tooltipSettings.valuePath],this.maps))}else f.indexOf("_BubbleIndex_")>-1&&(pt=parseInt(f.split("_BubbleIndex_")[1].split("_")[0],10),l=(a=parseInt(f.split("_BubbleIndex_")[1].split("_")[2],10),r.bubbleSettings[pt]),i=l.tooltipSettings,p=l.dataSource[a],i.visible&&!isNaN(a)&&(v=l.tooltipSettings.format?this.formatter(l.tooltipSettings.format,l.dataSource[a]):lt(l.tooltipSettings.valuePath.indexOf(".")>-1?e(l.dataSource[a],l.tooltipSettings.valuePath):l.dataSource[a][l.tooltipSettings.valuePath],this.maps)));document.getElementById(this.tooltipId)?g=document.getElementById(this.tooltipId):(g=n.createElement("div",{id:this.maps.element.id+"_mapsTooltip",className:"EJ2-maps-Tooltip",styles:"position: absolute;pointer-events:none;"}),document.getElementById(this.maps.element.id+"_Secondary_Element").appendChild(g));null!==i.template&&1===Object.keys("object"==typeof i.template?i.template:{}).length&&(i.template=i.template[Object.keys(i.template)[0]]);ut={location:wt,text:[],data:p=this.setTooltipContent(i,p),textStyle:{color:i.textStyle.color,fontFamily:i.textStyle.fontFamily,fontStyle:i.textStyle.fontStyle,fontWeight:i.textStyle.fontWeight,opacity:i.textStyle.opacity,size:i.textStyle.size},template:i.template};o={cancel:!1,name:vu,options:ut,fill:i.fill,maps:this.maps,element:d,eventArgs:t};this.maps.trigger(vu,o,function(){if(o.cancel||!i.visible||n.isNullOrUndefined(v)||-1!==f.indexOf("_cluster_")||-1!==f.indexOf("_dataLabel_"))u.removeTooltip(),u.maps.clearTemplate();else if(u.maps.isProtectedOnChange=!0,o.options.textStyle.color=o.options.textStyle.color||u.maps.themeStyle.tooltipFontColor,o.options.textStyle.fontFamily=o.options.textStyle.fontFamily||u.maps.themeStyle.fontFamily,o.options.textStyle.opacity=o.options.textStyle.opacity||u.maps.themeStyle.tooltipTextOpacity,u.svgTooltip=o.cancel?new et.Tooltip({enable:!0,header:"",data:i.data,template:i.template,content:[v.toString()],shapes:[],location:i.location,palette:[ct],areaBounds:u.maps.mapAreaRect,textStyle:i.textStyle,availableSize:u.maps.availableSize,fill:i.fill||u.maps.themeStyle.tooltipFillColor}):new et.Tooltip({enable:!0,header:"",data:o.options.data,template:o.options.template,content:[v.toString()],shapes:[],location:o.options.location,palette:[ct],areaBounds:u.maps.mapAreaRect,textStyle:o.options.textStyle,availableSize:u.maps.availableSize,fill:o.fill||u.maps.themeStyle.tooltipFillColor}),u.svgTooltip.opacity=u.maps.themeStyle.tooltipFillOpacity||u.svgTooltip.opacity,u.svgTooltip.appendTo(g),u.maps.renderReactTemplates(),null!==(y=document.getElementById(u.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")){var t=y.getAttribute("style");t=t.replace("pointer-events: none;","position-events:all;");y.setAttribute("style",t)}});this.svgTooltip&&this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:ut,element:this.svgTooltip.element});this.svgTooltip?this.maps.trigger("tooltipRenderComplete",{cancel:!1,name:"tooltipRenderComplete",maps:this.maps,options:ut,element:this.svgTooltip.element}):(this.removeTooltip(),this.maps.clearTemplate())}else null!==(y=document.getElementById(this.maps.element.id+"_mapsTooltip"))&&-1!==y.innerHTML.indexOf("href")&&-1!==y.innerHTML.indexOf("<\/a>")?this.maps.notify(rt,this):(this.removeTooltip(),this.maps.clearTemplate())},t.prototype.setTooltipContent=function(t,i){var r=n.extend({},i,null,!0);return this.maps.format&&!isNaN(Number(r[t.valuePath]))?r[t.valuePath]=vr(this.maps,Number(r[t.valuePath])):r=Object.keys(r).length?r:void 0,r},t.prototype.formatter=function(n,t){var i,u,r;for(void 0===t&&(t={}),i=0,u=Object.keys(t);i<u.length;i++)r=u[i],n="object"==typeof t[r]?ur("",n,t,this.maps):n.split("${"+r+"}").join(lt(t[r],this.maps));return n},t.prototype.mouseUpHandler=function(n){this.renderTooltip(n);"MouseMove"===this.maps.tooltipDisplayMode&&(clearTimeout(this.clearTimeout),this.clearTimeout=setTimeout(this.removeTooltip.bind(this),2e3))},t.prototype.removeTooltip=function(){document.getElementsByClassName("EJ2-maps-Tooltip").length>0&&n.remove(document.getElementsByClassName("EJ2-maps-Tooltip")[0])},t.prototype.addEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.on("dblclick",this.renderTooltip,this):"Click"===this.maps.tooltipDisplayMode?this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this):this.maps.on(n.Browser.touchMoveEvent,this.renderTooltip,this),this.maps.element.addEventListener("contextmenu",this.removeTooltip),this.maps.on(n.Browser.touchCancelEvent,this.removeTooltip,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||("DoubleClick"===this.maps.tooltipDisplayMode?this.maps.off("dblclick",this.removeTooltip):"Click"===this.maps.tooltipDisplayMode?this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler):this.maps.off(n.Browser.touchMoveEvent,this.renderTooltip),this.maps.off(n.Browser.touchCancelEvent,this.removeTooltip))},t.prototype.getModuleName=function(){return"MapsTooltip"},t.prototype.destroy=function(){this.removeEventListener()},t}(),io=function(){function t(t){this.isPanning=!1;this.mouseEnter=!1;this.isTouch=!1;this.rectZoomingStart=!1;this.pinchRect=new c(0,0,0,0);this.browserName=n.Browser.info.name;this.isPointer=n.Browser.isPointer;this.handled=!1;this.pinchFactor=1;this.startTouches=[];this.shapeZoomLocation=[];this.intersect=[];this.mouseDownLatLong={x:0,y:0};this.mouseMoveLatLong={x:0,y:0};this.isSingleClick=!1;this.maps=t;this.wheelEvent="mozilla"===this.browserName?this.isPointer?"mousewheel":"DOMMouseScroll":"mousewheel";this.cancelEvent=this.isPointer?"pointerleave":"mouseleave";this.selectionColor=this.maps.zoomSettings.selectionColor;this.fillColor=this.maps.zoomSettings.color;this.addEventListener();this.groupElements=[]}return t.prototype.performZooming=function(n,t,i){var s=this,r=this.maps,c,k;r.previousProjection=r.projectionType;r.defaultState=!1;r.initialCheck=!1;r.markerZoomedState=!1;r.zoomPersistence=r.enablePersistence;var h=r.tileZoomLevel,v=r.previousScale=r.scale,y=r.zoomSettings.maxZoom,e=r.zoomSettings.minZoom;if(t=e>t&&"ZoomIn"===i?e+1:t,c=r.tileTranslatePoint,!r.isTileMap&&("ZoomIn"===i?t>=e&&t<=y:t>=e)){var u=r.mapAreaRect,o=r.baseMapRectBounds.min,p=r.baseMapRectBounds.max,d=Math.abs(o.x-p.x),g=Math.abs(o.y-p.y),w=r.translatePoint,l=w.x-(u.width/v-u.width/t)/(u.width/n.x),a=w.y-(u.height/v-u.height/t)/(u.height/n.y),b=Math.abs(r.baseMapRectBounds.max.y-r.baseMapRectBounds.min.y)*t;l=b<r.mapAreaRect.height?u.x+(-o.x+(u.width/2-d/2)):l;a=b<r.mapAreaRect.height?u.y+(-o.y+(u.height/2-g/2)):a;r.translatePoint=new f(l,a);r.scale=t;this.triggerZoomEvent(c,h,i);this.applyTransform()}else r.isTileMap&&t>=e&&t<=y&&(this.getTileTranslatePosition(h,t,n,i),r.tileZoomLevel=t,r.zoomSettings.zoomFactor=t,r.scale=Math.pow(2,t-1),"ZoomOut"===i&&r.zoomSettings.resetToInitial&&r.applyZoomReset&&t<=r.initialZoomLevel&&(r.initialCheck=!0,r.zoomPersistence=!1,r.tileTranslatePoint.x=r.initialTileTranslate.x,r.tileTranslatePoint.y=r.initialTileTranslate.y,t=r.tileZoomLevel=r.mapScaleValue=r.initialZoomLevel,r.scale=Math.pow(2,t-1)),r.translatePoint.y=(r.tileTranslatePoint.y-.01*r.mapScaleValue)/r.scale,r.translatePoint.x=(r.tileTranslatePoint.x-.01*r.mapScaleValue)/r.scale,this.triggerZoomEvent(c,h,i),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),this.markerLineAnimation(r),r.mapLayerPanel.generateTiles(t,r.tileTranslatePoint,i+"wheel",null,n),document.getElementById(this.maps.element.id+"_tiles"),k=this.maps.layersCollection[0].animationDuration,setTimeout(function(){s.applyTransform();document.getElementById(s.maps.element.id+"_LayerIndex_1")&&(document.getElementById(s.maps.element.id+"_LayerIndex_1").style.display="block")},k));this.maps.zoomNotApplied=!1},t.prototype.triggerZoomEvent=function(n,t,i){var u,r=this.maps;u=r.isTileMap?{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{previous:n,current:r.tileTranslatePoint},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{previous:t,current:r.tileZoomLevel},scale:{previous:r.previousScale,current:r.scale}}:{cancel:!1,name:"zoom",type:i,maps:r,tileTranslatePoint:{},translatePoint:{previous:r.previousPoint,current:r.translatePoint},tileZoomLevel:{},scale:{previous:r.previousScale,current:r.scale}};r.trigger("zoom",u)},t.prototype.getTileTranslatePosition=function(n,t,i,r){var u=this.maps,s="ZoomOut"===r?10:"Reset"===r&&t>1?0:10,f=u.availableSize,e=256*Math.pow(2,n),o=256*Math.pow(2,t),h=(i.x-u.tileTranslatePoint.x)/e*100,c=(i.y-u.tileTranslatePoint.y)/e*100;u.tileTranslatePoint.x=1===t?f.width/2-256:i.x-h*o/100;u.tileTranslatePoint.y=1===t?f.height/2-256+2*s:i.y-c*o/100},t.prototype.performRectZooming=function(){var n,i,e;this.isDragZoom=!0;n=this.maps;i=n.availableSize;n.previousProjection=n.projectionType;var u=n.tileZoomLevel,o=n.tileTranslatePoint,r=this.zoomingRect,s=n.zoomSettings.maxZoom,a=n.zoomSettings.minZoom;if(r.height>0&&r.width>0){var h=this.zoomingRect.x+this.zoomingRect.width/2,c=this.zoomingRect.y+this.zoomingRect.height/2,t=void 0;if(n.isTileMap)t=(t=u+Math.round(u+(i.width/r.width+i.height/r.height)/2))>=a&&t<=s?t:s,n.zoomSettings.zoomFactor=t,this.getTileTranslatePosition(u,t,{x:h,y:c}),n.tileZoomLevel=t,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,t))/Math.pow(2,t),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,t))/Math.pow(2,t),n.scale=Math.pow(2,t),this.triggerZoomEvent(o,u,""),n.mapLayerPanel.generateTiles(t,n.tileTranslatePoint);else{e=n.previousScale=n.scale;t=e+Math.round((i.width/r.width+i.height/r.height)/2);var l=n.previousPoint=n.translatePoint,v=l.x-(i.width/e-i.width/t)/(i.width/h),y=l.y-(i.height/e-i.height/t)/(i.height/c);n.translatePoint=new f(v,y);n.scale=t;this.triggerZoomEvent(o,u,"")}n.mapScaleValue=t;this.applyTransform(!0);this.maps.zoomNotApplied=!1;this.zoomingRect=null}},t.prototype.setInteraction=function(n){this.lastScale=1;this.interaction=n},t.prototype.updateInteraction=function(){2===this.fingers?this.setInteraction("zoom"):this.setInteraction(null)},t.prototype.performPinchZooming=function(){var n=this.maps,s=n.tileZoomLevel,t=n.mapAreaRect,r,i;n.previousScale=n.scale;n.previousPoint=n.translatePoint;var h,c,v,u,y=n.tileTranslatePoint,p=(h=this.touchStartList,c=this.touchMoveList,v=dr(h[0],h[1]),dr(c[0],c[1])/v),e=(u=function(n,t){var i=t.element.getBoundingClientRect(),r=i.top+document.defaultView.pageXOffset,u=i.left+document.defaultView.pageYOffset;return Array.prototype.slice.call(n).map(function(n){return{x:n.pageX-u,y:n.pageY-r}})}(this.touchMoveList,this.maps),{x:u.map(function(n){return n.x}).reduce(gr)/u.length,y:u.map(function(n){return n.y}).reduce(gr)/u.length}),d=p/this.lastScale;if(this.lastScale=p,this.pinchFactor*=d,this.pinchFactor=Math.min(this.maps.zoomSettings.maxZoom,Math.max(this.pinchFactor,this.maps.zoomSettings.minZoom)),r=this.pinchFactor,n.isTileMap)i=r,this.getTileTranslatePosition(s,i,{x:e.x,y:e.y}),n.tileZoomLevel=i,n.translatePoint.x=(n.tileTranslatePoint.x-.5*Math.pow(2,i))/Math.pow(2,i),n.translatePoint.y=(n.tileTranslatePoint.y-.5*Math.pow(2,i))/Math.pow(2,i),n.scale=Math.pow(2,i),this.triggerZoomEvent(y,s,""),n.mapLayerPanel.generateTiles(i,n.tileTranslatePoint);else{var o=n.baseMapRectBounds.min,w=n.baseMapRectBounds.max,g=Math.abs(o.y-w.y),nt=Math.abs(o.x-w.x),b=n.translatePoint,k=Math.abs(n.baseMapRectBounds.max.y-n.baseMapRectBounds.min.y)*r,l=b.x-(t.width/n.scale-t.width/r)/(t.width/e.x),a=b.y-(t.height/n.scale-t.height/r)/(t.height/e.y);l=k<n.mapAreaRect.height?t.x+(-o.x+(t.width/2-nt/2)):l;a=k<n.mapAreaRect.height?t.y+(-o.y+(t.height/2-g/2)):a;n.translatePoint=new f(l,a);n.scale=r;this.triggerZoomEvent(y,s,"")}this.applyTransform()},t.prototype.drawZoomRectangle=function(){var n=this.maps,t=this.mouseDownPoints,i=this.mouseMovePoints,o=Math.abs(i.x-t.x),s=Math.abs(i.y-t.y),r=i.x>t.x?t.x:t.x-o,f=i.y>t.y?t.y:t.y-s,e,h;(u(n.element.id).getBoundingClientRect(),r>n.mapAreaRect.x&&r<n.mapAreaRect.x+n.mapAreaRect.width&&f>n.mapAreaRect.y&&f<n.mapAreaRect.y+n.mapAreaRect.height)&&(this.zoomingRect=new c(r,f,o,s),e=n.renderer.createSvg({id:n.element.id+"_Selection_Rect_Zooming",width:n.availableSize.width,height:n.availableSize.height}),h=new b(n.element.id+"_ZoomRect","#d3d3d3",{width:1,color:"#009900"},.5,this.zoomingRect,0,0,"","3"),e.appendChild(n.renderer.drawRectangle(h)),u(n.element.id+"_Secondary_Element").appendChild(e))},t.prototype.animateTransform=function(n,t,i,r,u){var f=this.currentLayer.animationDuration;t&&0!==f&&!this.maps.isTileMap?this.maps.isTileMap||pf(n,0,f,new tt(i,r),u,this.maps.mapAreaRect,this.maps):n.setAttribute("transform","scale("+u+") translate( "+i+" "+r+" )")},t.prototype.applyTransform=function(t){var st,d,u,g,y,i,rt,r,p,e,ut,w,ft,b,k,et,ot,c,ht,nt,a,it,vt;this.templateCount=0;var f=this.maps.scale,o=this.maps.translatePoint.x,h=this.maps.translatePoint.y;if(this.maps.zoomShapeCollection=[],document.getElementById(this.maps.element.id+"_mapsTooltip")&&l(this.maps.element.id+"_mapsTooltip"),this.layerCollectionEle){for(d=0;d<this.layerCollectionEle.childElementCount;d++){if(u=this.layerCollectionEle.childNodes[d],"g"===u.tagName)for(this.templateCount++,this.index=u.id.indexOf("_LayerIndex_")>-1&&parseFloat(u.id.split("_LayerIndex_")[1].split("_")[0]),this.currentLayer=this.maps.layersCollection[this.index],g=this.maps.mapLayerPanel.calculateFactor(this.currentLayer),y=0;y<u.childElementCount;y++)if(i=u.childNodes[y],i.id.indexOf("_Markers_Group")>-1||i.id.indexOf("_bubble_Group")>-1||i.id.indexOf("_dataLableIndex_Group")>-1){if(i.id.indexOf("_Markers_Group")>-1){if(this.isPanning||this.markerTranslates(i.childNodes[0],g,o,h,f,"Marker",u,t),i=u.childNodes[y],rt=void 0,!n.isNullOrUndefined(i)&&-1!==i.id.indexOf("Markers")){for(r=0;r<i.childElementCount;r++){for(this.markerTranslate(i.childNodes[r],g,o,h,f,"Marker",t),parseInt(i.childNodes[r].id.split("_LayerIndex_")[1].split("_")[0],10),p=parseInt(i.childNodes[r].id.split("_dataIndex_")[1].split("_")[0],10),e=parseInt(i.childNodes[r].id.split("_MarkerIndex_")[1].split("_")[0],10),rt=this.currentLayer.markerSettings[e].animationDuration>0,ut=this.currentLayer.markerSettings[e].dataSource[p],w=0;w<this.currentLayer.markerSettings[e].initialMarkerSelection.length;w++)this.currentLayer.markerSettings[e].initialMarkerSelection[w].latitude!==ut.latitude&&this.currentLayer.markerSettings[e].initialMarkerSelection[w].longitude!==ut.longitude||this.maps.markerSelection(this.currentLayer.markerSettings[e].selectionSettings,this.maps,i.children[r],this.currentLayer.markerSettings[e].dataSource[p]);(this.currentLayer.animationDuration>0||this.maps.layersCollection[0].animationDuration>0&&"SubLayer"===this.currentLayer.type)&&!this.isPanning&&(this.maps.isTileMap?(ft=document.querySelector(".GroupElement"),ft&&!document.querySelector(".ClusterGroupElement")&&rt&&(ft.style.display="none")):i.setAttribute("style","visibility:hidden"))}(this.isPanning&&this.maps.markerModule.sameMarkerData.length>0?or(this.maps.markerModule.sameMarkerData,this.maps,i,!0):this.maps.markerModule.sameMarkerData.length>0&&(this.maps.markerModule.sameMarkerData=[],document.getElementById(this.maps.element.id+"_mapsTooltip")&&l(this.maps.element.id+"_mapsTooltip")),document.getElementById(this.maps.element.id+"_mapsTooltip")&&this.maps.mapsTooltipModule.tooltipTargetID.indexOf("_MarkerIndex_")&&!this.isPanning)&&(b=this.maps.mapsTooltipModule,k=i.querySelector("#"+b.tooltipTargetID),n.isNullOrUndefined(k)||("hidden"===k.style.visibility?l(this.maps.element.id+"_mapsTooltip"):(et=parseFloat(k.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[1]),ot=parseFloat(k.getAttribute("transform").split("(")[1].split(")")[0].split(" ")[2]),this.maps.isTileMap&&(et+=+s(this.maps.element.id+"_tile_parent").style.left.split("px")[0],ot+=+s(this.maps.element.id+"_tile_parent").style.top.split("px")[0]),b.svgTooltip.location.x=et,b.svgTooltip.location.y=ot,b.svgTooltip.enableAnimation=!1)))}}else if(i.id.indexOf("_bubble_Group")>-1){for(c=void 0,r=0;r<i.childElementCount;r++)for((c=i.childNodes[r]).getAttribute("transform"),st=parseFloat(c.id.split("_LayerIndex_")[1].split("_")[0]),ht=parseFloat(c.id.split("_BubbleIndex_")[1].split("_")[0]),nt=(p=parseFloat(c.id.split("_BubbleIndex_")[1].split("_")[2]),0);nt<this.maps.bubbleModule.bubbleCollection.length;nt++)if(a=this.maps.bubbleModule.bubbleCollection[nt],a.LayerIndex===st&&a.BubbleIndex===ht&&a.DataIndex===p){var ct=(a.center.x+o)*f,lt=(a.center.y+h)*f,at=this.currentLayer.animationDuration;t&&0!==at?bi(c,0,at,new tt(ct,lt)):c.setAttribute("transform","translate( "+ct+" "+lt+" )");break}}else if(i.id.indexOf("_dataLableIndex_Group")>-1)for(this.intersect=[],this.maps.zoomLabelPositions=[],this.maps.zoomLabelPositions=this.maps.dataLabelModule.dataLabelCollections,r=0;r<i.childElementCount;r++)if(i.childNodes[r].id.indexOf("_LabelIndex_")>-1&&(it=parseFloat(i.childNodes[r].id.split("_LabelIndex_")[1].split("_")[0]),this.zoomshapewidth=this.shapeZoomLocation[it].getBoundingClientRect(),this.maps.zoomShapeCollection.push(this.zoomshapewidth),this.dataLabelTranslate(i.childNodes[r],g,o,h,f,"DataLabel",t),vt=this.maps.layers[this.index].dataLabelSettings.border,r>0&&vt.width>1&&i.childNodes[r-1].id.indexOf("_rectIndex_")>-1)){var wt=(this.maps.zoomLabelPositions[it].location.x+o)*f,bt=(this.maps.zoomLabelPositions[it].location.y+h)*f,yt=v(i.childNodes[r].innerHTML,this.maps.layers[this.index].dataLabelSettings.textStyle),pt=i.childNodes[r-1],kt=wt-yt.width/2,dt=bt-yt.height/2-5;pt.setAttribute("x",kt);pt.setAttribute("y",dt)}}else this.maps.isTileMap&&i.id.indexOf("_line_Group")>-1?(i.remove(),u.children.length>0&&u.children[0]?u.insertBefore(this.maps.navigationLineModule.renderNavigation(this.currentLayer,this.maps.tileZoomLevel,this.index),u.children[0]):u.appendChild(this.maps.navigationLineModule.renderNavigation(this.currentLayer,this.maps.tileZoomLevel,this.index))):(br(i,this.index,f,this.maps),this.maps.zoomTranslatePoint=this.maps.translatePoint,this.animateTransform(i,t,o,h,f),this.shapeZoomLocation=i.childNodes);this.maps.arrangeTemplate()}n.isNullOrUndefined(this.currentLayer)||t&&0!==this.currentLayer.animationDuration&&!this.maps.isTileMap||this.processTemplate(o,h,f,this.maps)}},t.prototype.markerTranslates=function(t,i,r,f,o,s,h,c){var a=this,k,w,p;void 0===c&&(c=!1);var d=0,g=0,nt=0,b=parseInt((t||h).id.split("_LayerIndex_")[1].split("_")[0],10),v=this.maps.renderer.createGroup({id:this.maps.element.id+"_Markers_Group","class":"GroupElement",style:"pointer-events: auto;"});document.getElementById(v.id)&&l(v.id);k=this.maps.mapAreaRect;w=n.createElement("div",{id:this.maps.element.id+"_LayerIndex_"+b+"_Markers_Template_Group",className:"template",styles:"overflow: hidden; position: absolute;pointer-events: none;top:"+k.y+"px;left:"+k.x+"px;height:"+k.height+"px;width:"+k.width+"px;"});document.getElementById(w.id)&&l(w.id);p=this.maps.layersCollection[b];p.markerSettings.map(function(t,c){var l=t.dataSource;Array.prototype.forEach.call(l,function(k,rt){a.maps.markerNullCount=c>=0&&0===rt?0:a.maps.markerNullCount;var ut={template:t.template,data:k,maps:a.maps,marker:t,cancel:!1,name:yu,fill:t.fill,colorValuePath:t.colorValuePath,shapeValuePath:t.shapeValuePath,height:t.height,width:t.width,imageUrl:t.imageUrl,imageUrlValuePath:t.imageUrlValuePath,shape:t.shape,border:t.border};ut=ai(ut=vi(ut,k),k);a.maps.trigger("markerRendering",ut,function(){t.shapeValuePath!==ut.shapeValuePath&&(ut=vi(ut,k));t.colorValuePath!==ut.colorValuePath&&(ut=ai(ut,k));var et=n.isNullOrUndefined(t.latitudeValuePath)?n.isNullOrUndefined(k.latitude)?n.isNullOrUndefined(k.Latitude)?0:k.Latitude:parseFloat(k.latitude):Number(e(k,t.latitudeValuePath)),ot=n.isNullOrUndefined(t.longitudeValuePath)?n.isNullOrUndefined(k.longitude)?n.isNullOrUndefined(k.Longitude)?0:k.Longitude:parseFloat(k.longitude):Number(e(k,t.longitudeValuePath)),st=t.offset;if(!ut.cancel&&t.visible&&!n.isNullOrUndefined(ot)&&!n.isNullOrUndefined(et)){var ht=a.maps.element.id+"_LayerIndex_"+b+"_MarkerIndex_"+c+"_dataIndex_"+rt,ft=a.maps.isTileMap?it(new tt(ot,et),a.maps.tileZoomLevel,a.maps.tileTranslatePoint,!0):y(et,ot,i,p,a.maps),ct=(0!==p.animationDuration||n.isNullOrUndefined(a.maps.zoomModule),{x:r,y:f});!ut.template||isNaN(ft.x)||isNaN(ft.y)?ut.template||isNaN(ft.x)||isNaN(ft.y)||(g++,sr(ut,t,l,rt,ft,ct,ht,st,o,a.maps,v)):(nt++,hr(ut,void 0,ht,k,c,w,ft,ct,o,st,a.maps))}d+=isNaN(et)||isNaN(ot)?1:0;nt+=ut.cancel?1:0;g+=ut.cancel?1:0;a.maps.markerNullCount=n.isNullOrUndefined(et)&&n.isNullOrUndefined(ot)?a.maps.markerNullCount+1:a.maps.markerNullCount;l.length;a.maps.markerNullCount;v.childElementCount===l.length-nt-d&&"Template"!==s&&(h.appendChild(v),p.markerClusterSettings.allowClustering&&(a.maps.svgObject.appendChild(v),a.maps.element.appendChild(a.maps.svgObject),kt(p,v,a.maps,b,v,h,!0,!0)));w.childElementCount===l.length-g-d&&u(a.maps.element.id+"_Secondary_Element")&&(u(a.maps.element.id+"_Secondary_Element").appendChild(w),o>=1&&p.markerClusterSettings.allowClustering&&kt(p,w,a.maps,b,v,h,!1,!0))})})})},t.prototype.processTemplate=function(t,i,r,f){for(var e,o=0;o<this.templateCount;o++){var c=f.mapLayerPanel.calculateFactor(this.currentLayer),s=u(f.element.id+"_LayerIndex_"+o+"_Markers_Template_Group"),h=u(f.element.id+"_LayerIndex_"+o+"_Label_Template_Group");if(!n.isNullOrUndefined(s)&&s.childElementCount>0)for(e=0;e<s.childElementCount;e++)this.markerTranslate(s.childNodes[e],c,t,i,r,"Template");if(!n.isNullOrUndefined(h)&&h.childElementCount>0)for(e=0;e<h.childElementCount;e++)this.dataLabelTranslate(h.childNodes[e],c,t,i,r,"Template")}},t.prototype.dataLabelTranslate=function(t,i,r,f,e,o,s){var rt,it,g,p,w,ot,b,l,ut;void 0===s&&(s=!1);var h,a,y,nt,ft,et=this.maps.dataLabelModule.dataLabelCollections,k=(t.getBoundingClientRect(),this.maps.layers[this.index].dataLabelSettings.textStyle),lt=(this.maps.layers[this.index].dataLabelSettings.labelPath,parseFloat(t.id.split("_LayerIndex_")[1].split("_")[0])),at=parseFloat(t.id.split("_shapeIndex_")[1].split("_")[0]);for(t.id.indexOf("_LabelIndex_")>-1&&(ft=parseFloat(t.id.split("_LabelIndex_")[1].split("_")[0])),rt=this.currentLayer.animationDuration,it=0;it<et.length;it++)if(g=et[it],g.layerIndex===lt&&g.shapeIndex===at&&g.labelIndex===ft)if(p=g.location.x,w=g.location.y,"Template"===o){ot=u(this.maps.element.id+"_Layer_Collections");p=Math.abs(this.maps.baseMapRectBounds.min.x-p)*e;w=Math.abs(this.maps.baseMapRectBounds.min.y-w)*e;var st=t.getBoundingClientRect(),ht=ot.getBoundingClientRect(),ct=t.parentElement.getBoundingClientRect(),vt=p+(ht.left-ct.left)-st.width/2,yt=w+(ht.top-ct.top)-st.height/2;t.style.left=vt+"px";t.style.top=yt+"px"}else{p=(p+r)*e;var pt=(w=(w+f)*e)-(nt=v(y=g.dataLabelText,k)).height/4,wt=w+nt.height/4,c={rightWidth:p+nt.width/2,leftWidth:p-nt.width/2,heightTop:pt,heightBottom:wt};if(s&&0!==rt||t.setAttribute("transform","translate( "+p+" "+w+" )"),"Hide"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(h=this.zoomshapewidth.width>=nt.width?y:"",t.innerHTML=h):(h=this.maps.dataLabelShape[it]>=nt.width?y:"",t.innerHTML=h)),"Trim"===this.maps.layers[this.index].dataLabelSettings.smartLabelMode&&(e>1?(h=d(this.zoomshapewidth.width,y,k),t.innerHTML=h):(h=d(this.maps.dataLabelShape[it],y,k),t.innerHTML=h)),"Hide"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(b=0;b<this.intersect.length;b++)if(!n.isNullOrUndefined(this.intersect[b])){if(!(c.leftWidth>this.intersect[b].rightWidth||c.rightWidth<this.intersect[b].leftWidth||c.heightTop>this.intersect[b].heightBottom||c.heightBottom<this.intersect[b].heightTop)){h="";t.innerHTML=h;break}h=n.isNullOrUndefined(h)?y:h;t.innerHTML=h}this.intersect.push(c)}if("Trim"===this.maps.layers[this.index].dataLabelSettings.intersectionAction){for(l=0;l<this.intersect.length;l++)if(!n.isNullOrUndefined(this.intersect[l]))if(c.rightWidth<this.intersect[l].leftWidth||c.leftWidth>this.intersect[l].rightWidth||c.heightBottom<this.intersect[l].heightTop||c.heightTop>this.intersect[l].heightBottom)a=n.isNullOrUndefined(h)?y:h,e>1&&(a=d(this.zoomshapewidth.width,a,k)),t.innerHTML=a;else{if(c.leftWidth>this.intersect[l].leftWidth){a=d((ut=this.intersect[l].rightWidth-c.leftWidth)-(c.rightWidth-c.leftWidth),h=n.isNullOrUndefined(h)?y:h,k);t.innerHTML=a;break}if(c.leftWidth<this.intersect[l].leftWidth){ut=c.rightWidth-this.intersect[l].leftWidth;a=d(Math.abs(ut-(c.rightWidth-c.leftWidth)),h=n.isNullOrUndefined(h)?y:h,k);t.innerHTML=a;break}}this.intersect.push(c);n.isNullOrUndefined(a)&&(a=d(this.zoomshapewidth.width,y,k),t.innerHTML=a)}else bi(t,0,rt,new tt(p,w))}},t.prototype.markerTranslate=function(t,i,r,o,s,h,c){var v,w,d,b;void 0===c&&(c=!1);var rt=parseInt(t.id.split("_LayerIndex_")[1].split("_")[0],10),ut=parseInt(t.id.split("_MarkerIndex_")[1].split("_")[0],10),p=parseInt(t.id.split("_dataIndex_")[1].split("_")[0],10),g=this.maps.layersCollection[rt],l=g.markerSettings[ut];if(!n.isNullOrUndefined(l)&&!n.isNullOrUndefined(l.dataSource)&&!n.isNullOrUndefined(l.dataSource[p])){var nt=n.isNullOrUndefined(l.longitudeValuePath)?n.isNullOrUndefined(l.dataSource[p].longitude)?n.isNullOrUndefined(l.dataSource[p].Latitude)?0:parseFloat(l.dataSource[p].Latitude):parseFloat(l.dataSource[p].longitude):Number(e(l.dataSource[p],l.longitudeValuePath)),tt=n.isNullOrUndefined(l.latitudeValuePath)?n.isNullOrUndefined(l.dataSource[p].latitude)?n.isNullOrUndefined(l.dataSource[p].Latitude)?0:parseFloat(l.dataSource[p].Latitude):parseFloat(l.dataSource[p].latitude):Number(e(l.dataSource[p],l.latitudeValuePath)),k=this.currentLayer.animationDuration,a=this.maps.isTileMap?it(new f(nt,tt),this.maps.tileZoomLevel,this.maps.tileTranslatePoint,!0):y(tt,nt,i,g,this.maps);this.maps.isTileMap?"Template"===h?(v=t.getBoundingClientRect(),(t.style.left=a.x-v.width/2+l.offset.x+"px",t.style.top=a.y-v.height/2+l.offset.y+"px","GoogleStaticMap"===this.maps.layers[this.maps.baseLayerIndex].layerType)&&(w=u(this.maps.element.id+"_StaticGoogleMap").getBoundingClientRect(),"none"!==t.style.display&&((w.x>v.x||w.x+640<v.x+v.width)&&(w.y>v.y||w.y+w.height<v.y+v.height)||w.x>v.x||w.x+640<v.x+v.width)&&(t.style.display="none"))):(a.x+=l.offset.x,a.y+=l.offset.y,t.setAttribute("transform","translate( "+a.x+" "+a.y+" )")):"Template"===h?k>0?(a.x=Math.abs(this.maps.baseMapRectBounds.min.x-a.x)*s,a.y=Math.abs(this.maps.baseMapRectBounds.min.y-a.y)*s,d=u(this.maps.element.id+"_Layer_Collections").getBoundingClientRect(),b=t.parentElement.getBoundingClientRect(),t.style.left=a.x+(d.left-b.left)+l.offset.x+"px",t.style.top=a.y+(d.top-b.top)+l.offset.y+"px",t.style.transform="translate(-50%, -50%)"):(b=t.getBoundingClientRect(),t.style.left=(a.x+r)*s+l.offset.x-this.maps.mapAreaRect.x-b.width/2+"px",t.style.top=(a.y+o)*s+l.offset.y-this.maps.mapAreaRect.y-b.height/2+"px"):(a.x=(a.x+r)*s+l.offset.x,a.y=(a.y+o)*s+l.offset.y,c&&0!==k?bi(t,0,k,a):t.setAttribute("transform","translate( "+a.x+" "+a.y+" )"))}},t.prototype.markerLineAnimation=function(t){var i,r,f;if(t.isTileMap)for(i=0;i<t.layersCollection.length;i++)r=u(this.maps.element.id+"_LayerIndex_"+i+"_Markers_Template_Group"),f=u(this.maps.element.id+"_LayerIndex_"+i+"_line_Group"),n.isNullOrUndefined(r)||(r.style.visibility="hidden"),n.isNullOrUndefined(f)||(f.style.visibility="hidden")},t.prototype.panning=function(t,i,r,e){var a,o=this.maps,w=this.mouseDownPoints,b=this.mouseMovePoints,k=o.scale,s,h,v,d,y,p,g;if(o.markerZoomedState=!1,o.zoomPersistence=o.enablePersistence,o.defaultState=!1,o.initialCheck=!1,v=o.translatePoint,d=o.tileTranslatePoint,i=n.isNullOrUndefined(i)?w.x-b.x:i,r=n.isNullOrUndefined(r)?w.y-b.y:r,this.maps.mergeCluster(),o.isTileMap)this.maps.tileZoomLevel>1&&(s=o.tileTranslatePoint.x-i,h=o.tileTranslatePoint.y-r,this.distanceX=s-o.tileTranslatePoint.x,this.distanceY=h-o.tileTranslatePoint.y,o.tileTranslatePoint.x=s,o.tileTranslatePoint.y=h,(o.tileTranslatePoint.y>-10&&r<0||o.tileTranslatePoint.y<-256*(Math.pow(2,this.maps.tileZoomLevel)-2)&&r>0)&&(o.tileTranslatePoint.x=s+i,o.tileTranslatePoint.y=h+r),o.translatePoint.x=(o.tileTranslatePoint.x-i)/o.scale,o.translatePoint.y=(o.tileTranslatePoint.y-r)/o.scale,y=this.maps.getTileGeoLocation(e.layerX,e.layerY),a={cancel:!1,name:fi,maps:o,tileTranslatePoint:{previous:d,current:o.tileTranslatePoint},translatePoint:{previous:v,current:o.translatePoint},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:y.latitude,longitude:y.longitude},o.trigger(fi,a),o.mapLayerPanel.generateTiles(o.tileZoomLevel,o.tileTranslatePoint,"Pan"),this.applyTransform());else{p=document.getElementById(o.element.id+"_Legend_Group");g=n.isNullOrUndefined(p)?0:p.getClientRects()[0].height;s=v.x-i/k;h=v.y-r/k;var c=u(o.element.id+"_Layer_Collections").getBoundingClientRect(),l=u(o.element.id+"_svg").getBoundingClientRect(),nt=i<0?c.left<=l.left+o.mapAreaRect.x:c.left+c.width>=l.left+l.width+o.mapAreaRect.x+o.margin.left,tt=r<0?c.top<=l.top+o.mapAreaRect.y:c.top+c.height+g+o.margin.top>=l.top+l.height,it=this.maps.getGeoLocation(this.maps.layersCollection.length-1,e.layerX,e.layerY);a={cancel:!1,name:fi,maps:o,tileTranslatePoint:{},translatePoint:{previous:v,current:new f(s,h)},scale:o.scale,tileZoomLevel:o.tileZoomLevel,latitude:it.latitude,longitude:it.longitude};o.trigger(fi,a);a.cancel||(nt&&tt?(o.translatePoint=new f(s,h),this.applyTransform()):nt?(o.translatePoint=new f(s,o.translatePoint.y),this.applyTransform()):tt&&(o.translatePoint=new f(o.translatePoint.x,h),this.applyTransform()));this.maps.zoomNotApplied=!1}o.zoomTranslatePoint=o.translatePoint;this.mouseDownPoints=this.mouseMovePoints;this.maps.zoomNotApplied=!1;this.isSingleClick=!1},t.prototype.toAlignSublayer=function(){this.maps.translatePoint.x=n.isNullOrUndefined(this.distanceX)?this.maps.translatePoint.x:this.maps.translatePoint.x-this.distanceX/this.maps.scale;this.maps.translatePoint.y=n.isNullOrUndefined(this.distanceY)?this.maps.translatePoint.y:this.maps.translatePoint.y-this.distanceY/this.maps.scale;this.applyTransform(!1)},t.prototype.toolBarZooming=function(n,t){var h=this,i=this.maps,o,c,e,k,d;i.initialCheck=!1;i.defaultState="Reset"===t&&1===n&&!(i.zoomSettings.resetToInitial&&i.applyZoomReset)||"ZoomOut"===t&&1===n;o=i.tileZoomLevel;c=i.previousScale=i.scale;i.markerZoomedState=!1;i.zoomPersistence=i.enablePersistence;i.mapScaleValue=n;var v=i.zoomSettings.maxZoom,u=i.zoomSettings.minZoom,r=i.mapAreaRect,y=i.previousPoint=i.translatePoint,p=i.tileTranslatePoint;if(i.previousProjection=i.projectionType,n="ZoomOut"===t&&1===Math.round(n)?1:n,n=u>(n="Reset"===t||0===Math.round(n)?1:n)&&"ZoomIn"===t?u+1:n,!i.isTileMap&&("ZoomIn"===t?n>=u&&n<=v:n>=u||i.isReset)){var s=i.baseMapRectBounds.min,w=i.baseMapRectBounds.max,g=Math.abs(w.x-s.x),nt=Math.abs(s.y-w.y),l=y.x-(r.width/c-r.width/n)/2,a=y.y-(r.height/c-r.height/n)/2,b=Math.abs(i.baseMapRectBounds.max.y-i.baseMapRectBounds.min.y)*n;l=b<i.mapAreaRect.height?r.x+(-s.x+(r.width/2-g/2)):l;a=b<i.mapAreaRect.height?r.y+(-s.y+(r.height/2-nt/2)):a;i.translatePoint=new f(l,a);i.zoomTranslatePoint=i.translatePoint;i.scale=n;this.triggerZoomEvent(p,o,t);this.applyTransform(!0)}else i.isTileMap&&(n>=u&&n<=v||i.isReset)&&(e=o<u&&!i.isReset?u:n,(i.scale=Math.pow(2,e-1),i.tileZoomLevel=e,i.previousScale!==i.scale||i.isReset)&&(i.zoomSettings.zoomFactor=n,k={x:i.availableSize.width/2,y:i.availableSize.height/2},this.getTileTranslatePosition(o,e,k,t),(i.zoomSettings.resetToInitial&&i.applyZoomReset&&"Reset"===t||"ZoomOut"===t&&i.zoomSettings.resetToInitial&&i.applyZoomReset&&e<=i.initialZoomLevel)&&(i.initialCheck=!0,i.zoomPersistence=!1,i.tileTranslatePoint.x=i.initialTileTranslate.x,i.tileTranslatePoint.y=i.initialTileTranslate.y,e=i.tileZoomLevel=i.mapScaleValue=i.initialZoomLevel),this.triggerZoomEvent(p,o,t),i.translatePoint.y=(i.tileTranslatePoint.y-.01*i.mapScaleValue)/i.scale,i.translatePoint.x=(i.tileTranslatePoint.x-.01*i.mapScaleValue)/i.scale,document.getElementById(this.maps.element.id+"_LayerIndex_1")&&(document.getElementById(this.maps.element.id+"_LayerIndex_1").style.display="none"),document.querySelector(".GroupElement")&&(document.querySelector(".GroupElement").style.display="none"),this.markerLineAnimation(i),i.mapLayerPanel.generateTiles(e,i.tileTranslatePoint,t),document.getElementById(this.maps.element.id+"_tiles"),d=this.maps.layersCollection[0].animationDuration,setTimeout(function(){h.applyTransform(!0);document.getElementById(h.maps.element.id+"_LayerIndex_1")&&(document.getElementById(h.maps.element.id+"_LayerIndex_1").style.display="block")},d)),this.maps.zoomNotApplied=!1)},t.prototype.createZoomingToolbars=function(){var n=this.maps,a,v,l,i,u,t,f,e,r;this.toolBarGroup=n.renderer.createGroup({id:n.element.id+"_Zooming_KitCollection",opacity:"fluentuidark"===n.theme.toLowerCase()?.6:.3});var o=15,s=15,y=n.zoomSettings.toolBarOrientation,w=n.zoomSettings.toolbars,h=n.zoomSettings.toolbars.length,k="Horizontal"===n.zoomSettings.toolBarOrientation?16*h+20*h:32,d="Horizontal"===n.zoomSettings.toolBarOrientation?32:16*h+20*h;for(this.toolBarGroup.appendChild(n.renderer.drawRectangle(new b(n.element.id+"_Zooming_Rect","transparent",{color:"transparent",width:1},1,new c(0,0,k,d),0,0))),a=n.renderer.createDefs(),a.innerHTML='<filter id="chart_shadow" height="130%"><feGaussianBlur in="SourceAlpha" stdDeviation="5"/><feOffset dx="-3" dy="4" result="offsetblur"/><feComponentTransfer><feFuncA type="linear" slope="1"/><\/feComponentTransfer><feMerge><feMergeNode/><feMergeNode in="SourceGraphic"/><\/feMerge><\/filter>',this.toolBarGroup.appendChild(a),v=n.renderer.drawRectangle(new b(n.element.id+"_Zooming_Rect","transparent",{color:"transparent",width:1},.1,new c(0,0,k,d),0,0)),v.setAttribute("filter","url(#chart_shadow)"),this.toolBarGroup.appendChild(v),l=0;l<w.length;l++){i=w[l];this.currentToolbarEle=n.renderer.createGroup({id:n.element.id+"_Zooming_ToolBar_"+i+"_Group",transform:"translate( "+o+" "+s+" ) "});this.currentToolbarEle.setAttribute("class","e-maps-toolbar");u="transparent";t="";switch(this.selectionColor=this.maps.zoomSettings.selectionColor||this.maps.themeStyle.zoomSelectionColor,i.toLowerCase()){case"zoom":f=void 0;e=void 0;t="M0.001,14.629L1.372,16l4.571-4.571v-0.685l0.228-0.274c1.051,0.868,2.423,1.417,3.885,1.417c3.291,0,";t+="5.943-2.651,5.943-5.943S13.395,0,10.103,0S4.16,2.651,4.16,5.943c0,1.508,0.503,2.834,1.417,3.885l-0.274,0.228H4.571";t+="L0.001,14.629L0.001,14.629z M5.943,5.943c0-2.285,1.828-4.114,4.114-4.114s4.114,1.828,4.114,";this.maps.zoomSettings.enablePanning&&!this.maps.zoomSettings.enableSelectionZooming||this.maps.zoomSettings.enablePanning&&this.maps.zoomSettings.enableSelectionZooming?(f=u,e=this.maps.themeStyle.zoomFillColor):this.maps.zoomSettings.enablePanning||this.maps.zoomSettings.enableSelectionZooming?(f=this.selectionColor,e=this.selectionColor):(f=u,e=this.maps.themeStyle.zoomFillColor);this.currentToolbarEle.appendChild(n.renderer.drawPath(new p(n.element.id+"_Zooming_ToolBar_"+i,f,1,e,1,1,null,t+"4.114s-1.828,4.114-4.114,4.114S5.943,8.229,5.943,5.943z")));this.zoomElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomin":t="M 8, 0 L 8, 16 M 0, 8 L 16, 8";this.currentToolbarEle.appendChild(n.renderer.drawPath(new p(n.element.id+"_Zooming_ToolBar_"+i+"_Path",u,3,this.maps.themeStyle.zoomFillColor,1,1,null,t)));this.zoomInElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"zoomout":t="M 0, 8 L 16, 8";this.currentToolbarEle.appendChild(n.renderer.drawPath(new p(n.element.id+"_Zooming_ToolBar_"+i,u,3,this.maps.themeStyle.zoomFillColor,1,1,null,t)));this.zoomOutElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"pan":r=void 0;t="M5,3h2.3L7.275,5.875h1.4L8.65,3H11L8,0L5,3z M3,11V8.7l2.875,0.025v-1.4L3,7.35V5L0,8L3,";t+="11z M11,13H8.7l0.025-2.875h-1.4L7.35,13H5l3,3L11,13z M13,5v2.3l-2.875-0.025v1.4L13,8.65V11l3-3L13,5z";this.maps.zoomSettings.enablePanning&&this.maps.zoomModule.isDragZoom?r="#737373":this.maps.zoomSettings.enablePanning?r=this.selectionColor:(r="#737373",this.currentToolbarEle.setAttribute("class",""));this.currentToolbarEle.appendChild(n.renderer.drawPath(new p(n.element.id+"_Zooming_ToolBar_"+i,r,1,r,1,1,null,t)));this.panColor=r;this.panElements=this.currentToolbarEle;this.wireEvents(this.currentToolbarEle,this.performToolBarAction);break;case"reset":t="M12.364,8h-2.182l2.909,3.25L16,8h-2.182c0-3.575-2.618-6.5-5.818-6.5c-1.128,0-2.218,0.366-3.091,";t+="1.016l1.055,1.178C6.581,3.328,7.272,3.125,8,3.125C10.4,3.125,12.363,5.319,12.364,8L12.364,8z M11.091,";t+="13.484l-1.055-1.178C9.419,12.672,8.728,12.875,8,12.875c-2.4,0-4.364-2.194-4.364-4.875h2.182L2.909,4.75L0,8h2.182c0,";this.currentToolbarEle.appendChild(n.renderer.drawPath(new p(n.element.id+"_Zooming_ToolBar_"+i,this.fillColor,null,this.maps.themeStyle.zoomFillColor,1,1,null,t+"3.575,2.618,6.5,5.818,6.5C9.128,14.5,10.219,14.134,11.091,13.484L11.091,13.484z")));this.wireEvents(this.currentToolbarEle,this.performToolBarAction)}this.currentToolbarEle.appendChild(n.renderer.drawCircle(new bt(n.element.id+"_Zooming_ToolBar_"+i+"_Rect",u,{color:this.maps.themeStyle.zoomFillColor,width:1},1,8,8,16,"")));o="Horizontal"===y?o+36:o;s="Horizontal"===y?s:s+36;this.toolBarGroup.appendChild(this.currentToolbarEle)}},t.prototype.performToolBarAction=function(n){var r=n.target,i,t;n.stopImmediatePropagation();i="touch"===n.pointerType||"2"===n.pointerType||n.type.indexOf("touch")>-1;t=r.id.split("_Zooming_ToolBar_")[1].split("_")[0];i?(this.handled=!0,this.performZoomingByToolBar(t)):"mousedown"!==n.type&&"pointerdown"!==n.type||this.handled?this.handled=!1:(this.handled=!1,this.performZoomingByToolBar(t))},t.prototype.performZoomingByToolBar=function(n){var t=this.maps;switch(t.isReset=!1,n.toLowerCase()){case"zoom":this.panColor=this.fillColor;this.zoomColor=this.selectionColor;this.applySelection(this.zoomElements,this.selectionColor);this.applySelection(this.panElements,this.fillColor);break;case"pan":this.panColor=this.maps.zoomSettings.enablePanning?this.selectionColor:"#737373";this.zoomColor=this.fillColor;this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor),this.applySelection(this.panElements,this.panColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,this.panColor));break;case"zoomin":t.staticMapZoom=t.tileZoomLevel;t.staticMapZoom>0&&t.staticMapZoom<22&&(t.staticMapZoom+=1);this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)+1,"ZoomIn");break;case"zoomout":t.staticMapZoom=t.tileZoomLevel;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming((t.isTileMap?t.tileZoomLevel:t.scale)-1,"ZoomOut");break;case"reset":t.staticMapZoom=t.zoomSettings.enable?t.zoomSettings.zoomFactor:0;t.markerCenterLatitude=null;t.markerCenterLongitude=null;this.toolBarZooming(1,"Reset");this.maps.zoomSettings.enablePanning?(this.applySelection(this.zoomElements,this.fillColor),this.applySelection(this.panElements,this.selectionColor)):(this.applySelection(this.zoomElements,this.selectionColor),this.applySelection(this.panElements,"#737373"))}this.panningStyle(n.toLowerCase())},t.prototype.panningStyle=function(n){var t=u(this.maps.element.id+"_svg");"pan"===n||this.isPanning?t.setAttribute("class","e-maps-panning"):t.setAttribute("class","")},t.prototype.applySelection=function(n,t){if(n)for(var i,r=0;r<n.childElementCount;r++)"circle"!==(i=n.childNodes[r]).tagName&&(i.setAttribute("fill",t),i.setAttribute("stroke",t))},t.prototype.showTooltip=function(t){var i=t.target.id.split("_Zooming_ToolBar_")[1].split("_")[0];this.isTouch||function(t,i,r,u){var f=s(t),e="top:"+r.toString()+"px;left:"+u.toString()+"px;color: #000000; background:#FFFFFF;position:absolute;border:1px solid #707070;font-size:10px;border-radius:2px;";f?(f.setAttribute("innerHTML","&nbsp;"+i+"&nbsp;"),f.setAttribute("styles",e)):(f=n.createElement("div",{id:t,innerHTML:"&nbsp;"+i+"&nbsp;",styles:e}),document.body.appendChild(f))}("EJ2_Map_Toolbar_Tip",this.maps.getLocalizedLabel(i),t.pageY+10,t.pageX+10)},t.prototype.removeTooltip=function(){u("EJ2_Map_Toolbar_Tip")&&n.remove(u("EJ2_Map_Toolbar_Tip"))},t.prototype.alignToolBar=function(){var t=this.maps,f=n.createElement("div",{id:t.element.id+"_ToolBar",styles:"position:absolute;z-index:2"}),e=t.renderer.createSvg({id:t.element.id+"_Zooming_ToolBar",width:10,height:10}),i,h;e.appendChild(this.toolBarGroup);f.appendChild(e);u(t.element.id+"_Secondary_Element")&&u(t.element.id+"_Secondary_Element").appendChild(f);i=this.toolBarGroup.getBoundingClientRect();e.setAttribute("height",(i.height+5).toString());e.setAttribute("width",(i.width+5).toString());var r=n.isNullOrUndefined(t.totalRect)?t.mapAreaRect:t.totalRect,o=0,s=0;switch(t.zoomSettings.verticalAlignment){case"Near":s=r.y;break;case"Center":s=r.height/2-i.height/2;break;case"Far":s=r.height-i.height-10}switch(t.zoomSettings.horizontalAlignment){case"Near":o=r.x;break;case"Center":o=r.width/2-i.width/2;break;case"Far":o=r.width-i.width-10}h=t.getExtraPosition();f.style.left=o+h.x+"px";f.style.top=s+h.y+"px";var c=this.maps.zoomSettings.highlightColor||this.maps.themeStyle.zoomSelectionColor,a=" .e-maps-toolbar:hover > circle { stroke:"+c+"; } .e-maps-toolbar:hover > path { fill: "+c+" ;  stroke: "+c+"; }.e-maps-toolbar:hover { cursor: pointer; } .e-maps-cursor-disable:hover { cursor: not-allowed; } .e-maps-panning:hover { cursor: pointer; } .e-maps-popup-close { display: block; opacity: 0; }",l=document.createElement("style");l.appendChild(document.createTextNode(a));f.appendChild(l)},t.prototype.wireEvents=function(t,i){n.EventHandler.add(t,n.Browser.touchStartEvent,i,this);n.EventHandler.add(t,"mouseover",this.showTooltip,this);n.EventHandler.add(t,"mouseout",this.removeTooltip,this)},t.prototype.mapMouseWheel=function(n){var t,u;if(this.maps.zoomSettings.enable&&this.maps.zoomSettings.mouseWheelZoom){t=this.maps;t.availableSize;t.markerZoomedState=!1;t.zoomPersistence=t.enablePersistence;var i=this.getMousePosition(n.pageX,n.pageY),f=t.tileZoomLevel,e=t.scale,r=t.isTileMap?f:e;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&(n.preventDefault(),u="mozilla"!==this.browserName||this.isPointer?n.wheelDelta/120>0?"ZoomIn":"ZoomOut":-n.detail/3>0?"ZoomIn":"ZoomOut","ZoomIn"===u?(t.mapScaleValue=r+1,t.staticMapZoom=t.tileZoomLevel,t.staticMapZoom>0&&t.staticMapZoom<22&&(t.staticMapZoom+=1),this.performZooming(i,r+1,u)):(t.mapScaleValue=r-1,t.staticMapZoom=t.tileZoomLevel,1===t.mapScaleValue&&(t.markerCenterLatitude=null,t.markerCenterLongitude=null),t.staticMapZoom>1&&t.staticMapZoom<22&&(t.staticMapZoom-=1),this.performZooming(i,r-1,u)))}},t.prototype.doubleClick=function(n){var u=n.pageX,f=n.pageY,r;if(n.target,this.maps.zoomSettings.enable&&this.maps.zoomSettings.doubleClickZoom&&!(n.target.id.indexOf("_Zooming_")>-1)){var i=this.getMousePosition(u,f),t=this.maps,e=(t.availableSize,t.tileZoomLevel),o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},t.prototype.mouseDownHandler=function(n){var t,i,r=null;n.target;"touchstart"===n.type?(this.isTouch=!0,r=n.touches,n.target,t=r[0].clientX,i=r[0].clientY):(t=n.pageX,i=n.pageY,n.target);this.isPanning=this.maps.zoomSettings.enablePanning?this.panColor===this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor!==this.selectionColor:this.panColor!==this.selectionColor?this.maps.zoomSettings.enablePanning:this.zoomColor===this.selectionColor;this.mouseDownLatLong={x:t,y:i};this.rectZoomingStart=!this.isPanning&&this.maps.zoomSettings.enable;this.mouseDownPoints=this.getMousePosition(t,i);this.isTouch&&(this.firstMove=!0,this.pinchFactor=this.maps.scale,this.fingers=r.length);this.isSingleClick=!0},t.prototype.mouseMoveHandler=function(t){var f,e,o,i=this.maps,r=null,s=this.maps.zoomSettings;"touchmove"===t.type?(this.isTouch=!0,o=t.target,f=(r=t.touches)[0].clientX,e=r[0].clientY):(f=t.pageX,e=t.pageY,o=t.target);u(i.element.id+"_Zooming_KitCollection")&&(o.id.indexOf("_Zooming_")>-1?(u(i.element.id+"_Zooming_KitCollection").setAttribute("opacity","1"),document.getElementById(i.element.id+"_Zooming_ToolBar_Pan_Group")&&(this.maps.zoomSettings.enablePanning||(o.id.indexOf("_Zooming_ToolBar")>-1||o.id.indexOf("_Zooming_Rect")>-1)&&(u(i.element.id+"_Zooming_ToolBar_Pan_Rect").setAttribute("opacity","fluentuidark"===i.theme.toLowerCase()?"0.6":"0.3"),u(i.element.id+"_Zooming_ToolBar_Pan").setAttribute("opacity","fluentuidark"===i.theme.toLowerCase()?"0.6":"0.3")))):(u(i.element.id+"_Zooming_KitCollection").setAttribute("opacity","fluentuidark"===i.theme.toLowerCase()?"0.6":"0.3"),!this.maps.zoomSettings.enablePanning&&document.getElementById(i.element.id+"_Zooming_ToolBar_Pan_Group")&&(u(i.element.id+"_Zooming_ToolBar_Pan_Rect").setAttribute("opacity","1"),u(i.element.id+"_Zooming_ToolBar_Pan").setAttribute("opacity","1"))));this.isTouch&&this.maps.zoomSettings.pinchZooming&&(this.firstMove&&2===r.length?(this.rectZoomingStart=!1,this.updateInteraction(),this.touchStartList=kr(t)):2===r.length&&2===this.touchStartList.length&&(this.touchMoveList=kr(t),t.preventDefault(),this.rectZoomingStart=!1,this.performPinchZooming(t)),this.firstMove=!1);this.mouseMovePoints=this.getMousePosition(f,e);t.target.id;t.target;s.enable&&this.isPanning&&(n.Browser.isDevice&&r.length>=1||!n.Browser.isDevice)&&(t.preventDefault(),this.maps.element.style.cursor="pointer",this.mouseMoveLatLong={x:f,y:e},this.mouseDownLatLong.x!==this.mouseMoveLatLong.x&&this.mouseDownLatLong.y!==this.mouseMoveLatLong.y&&(this.maps.zoomSettings.enablePanning&&this.panning("None",null,null,t),this.mouseDownLatLong.x=f,this.mouseDownLatLong.y=e));(this.isTouch?1===r.length&&this.rectZoomingStart:this.rectZoomingStart)&&(t.preventDefault(),this.maps.zoomSettings.enableSelectionZooming&&this.drawZoomRectangle())},t.prototype.mouseUpHandler=function(){this.maps;this.rectZoomingStart=!1;this.isPanning=!1;this.isSingleClick=!!this.isSingleClick;this.isTouch=!1;this.touchStartList=[];this.touchMoveList=[];this.lastScale=1;this.maps.element.style.cursor="auto";n.isNullOrUndefined(this.distanceX)&&n.isNullOrUndefined(this.distanceY)||n.isNullOrUndefined(this.currentLayer)||"SubLayer"!==this.currentLayer.type||(this.toAlignSublayer(),this.distanceX=this.distanceY=null);var t=u(this.maps.element.id+"_Selection_Rect_Zooming");t&&this.maps.zoomSettings.enable&&this.maps.zoomSettings.enableSelectionZooming&&(n.remove(t),this.performRectZooming());this.mouseMoveLatLong={x:0,y:0};this.mouseDownLatLong={x:0,y:0}},t.prototype.mouseCancelHandler=function(){this.isPanning=!1;this.isTouch=!1;this.rectZoomingStart=!1;var t=u(this.maps.element.id+"_Selection_Rect_Zooming");t&&this.maps.zoomSettings.enable&&(n.remove(t),this.performRectZooming())},t.prototype.click=function(n){var t=this.maps,r;if(t.markerModule&&t.markerModule.sameMarkerData.length>0||n.target.id.indexOf("MarkerIndex")>-1&&-1===n.target.id.indexOf("cluster"))return null;if(this.isSingleClick&&t.zoomSettings.zoomOnClick&&!(n.target.id.indexOf("_Zooming_")>-1)&&!t.zoomSettings.doubleClickZoom&&this.zoomColor!==this.selectionColor){var u=n.pageX,f=n.pageY,i=this.getMousePosition(u,f),e=t.tileZoomLevel,o=t.scale;t.mapScaleValue=t.mapScaleValue+1;r=t.isTileMap?e:o;i.x>t.mapAreaRect.x&&i.x<t.mapAreaRect.x+t.mapAreaRect.width&&i.y>t.mapAreaRect.y&&i.y<t.mapAreaRect.y+t.mapAreaRect.height&&this.performZooming(i,r+1,"ZoomIn")}},t.prototype.getMousePosition=function(n,t){var i=this.maps,r=i.element.getBoundingClientRect(),u=i.element.ownerDocument.defaultView.pageXOffset,e=i.element.ownerDocument.defaultView.pageYOffset,o=i.element.ownerDocument.documentElement.clientTop,s=i.element.ownerDocument.documentElement.clientLeft,h=r.left+u-s,c=r.top+e-o;return new f(Math.abs(n-h),Math.abs(t-c))},t.prototype.addEventListener=function(){this.maps.isDestroyed||(n.EventHandler.add(this.maps.element,this.wheelEvent,this.mapMouseWheel,this),n.EventHandler.add(this.maps.element,"click",this.click,this),n.EventHandler.add(this.maps.element,"dblclick",this.doubleClick,this),this.maps.on(n.Browser.touchMoveEvent,this.mouseMoveHandler,this),this.maps.on(n.Browser.touchStartEvent,this.mouseDownHandler,this),this.maps.on(n.Browser.touchEndEvent,this.mouseUpHandler,this),n.EventHandler.add(this.maps.element,this.cancelEvent,this.mouseCancelHandler,this))},t.prototype.removeEventListener=function(){this.maps.isDestroyed||(n.EventHandler.remove(this.maps.element,this.wheelEvent,this.mapMouseWheel),n.EventHandler.remove(this.maps.element,"click",this.click),n.EventHandler.remove(this.maps.element,"dblclick",this.doubleClick),this.maps.off(n.Browser.touchMoveEvent,this.mouseMoveHandler),this.maps.off(n.Browser.touchStartEvent,this.mouseDownHandler),this.maps.off(n.Browser.touchEndEvent,this.mouseUpHandler),this.maps.off(this.cancelEvent,this.mouseCancelHandler))},t.prototype.getModuleName=function(){return"Zoom"},t.prototype.destroy=function(){this.removeEventListener()},t}();ejdashboard.pdfexport;hf.Inject(we,de,lu,ge,no,to,io,be,ke,sf);ei={};ei.Maps=hf;cf={maps:ei=oi.C(window.ejdashboard?window.ejdashboard.maps:{},ei)};window.ejdashboard=oi.C(window.ejdashboard||{},cf)})()})();
