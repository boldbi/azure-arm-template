/*!
*  filename: ej2.pivotgrid.all.min.js
*  version : 11.3.24.24
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(function(n,t){typeof exports=="object"&&typeof module!="undefined"?t():typeof define=="function"&&define.amd?define(t):t()})(this,function(){"use strict";function f(n){var t=this.constructor;return this.then(function(i){return t.resolve(n()).then(function(){return i})},function(i){return t.resolve(n()).then(function(){return t.reject(i)})})}function h(){}function c(n,t){return function(){n.apply(t,arguments)}}function n(t){if(!(this instanceof n))throw new TypeError("Promises must be constructed via new");if(typeof t!="function")throw new TypeError("not a function");this._state=0;this._handled=!1;this._value=undefined;this._deferreds=[];o(t,this)}function e(i,u){while(i._state===3)i=i._value;if(i._state===0){i._deferreds.push(u);return}i._handled=!0;n._immediateFn(function(){var n=i._state===1?u.onFulfilled:u.onRejected,f;if(n===null){(i._state===1?r:t)(u.promise,i._value);return}try{f=n(i._value)}catch(e){t(u.promise,e);return}r(u.promise,f)})}function r(i,r){try{if(r===i)throw new TypeError("A promise cannot be resolved with itself.");if(r&&(typeof r=="object"||typeof r=="function")){var f=r.then;if(r instanceof n){i._state=3;i._value=r;u(i);return}if(typeof f=="function"){o(c(f,r),i);return}}i._state=1;i._value=r;u(i)}catch(e){t(i,e)}}function t(n,t){n._state=2;n._value=t;u(n)}function u(t){t._state===2&&t._deferreds.length===0&&n._immediateFn(function(){t._handled||n._unhandledRejectionFn(t._value)});for(var i=0,r=t._deferreds.length;i<r;i++)e(t,t._deferreds[i]);t._deferreds=null}function l(n,t,i){this.onFulfilled=typeof n=="function"?n:null;this.onRejected=typeof t=="function"?t:null;this.promise=i}function o(n,i){var u=!1;try{n(function(n){u||(u=!0,r(i,n))},function(n){u||(u=!0,t(i,n))})}catch(f){if(u)return;u=!0;t(i,f)}}var s=setTimeout,i;n.prototype["catch"]=function(n){return this.then(null,n)};n.prototype.then=function(n,t){var i=new this.constructor(h);return e(this,new l(n,t,i)),i};n.prototype["finally"]=f;n.all=function(t){return new n(function(n,i){function e(t,u){try{if(u&&(typeof u=="object"||typeof u=="function")){var o=u.then;if(typeof o=="function"){o.call(u,function(n){e(t,n)},i);return}}r[t]=u;--f==0&&n(r)}catch(s){i(s)}}var r,f,u;if(!t||typeof t.length=="undefined")throw new TypeError("Promise.all accepts an array");if(r=Array.prototype.slice.call(t),r.length===0)return n([]);for(f=r.length,u=0;u<r.length;u++)e(u,r[u])})};n.resolve=function(t){return t&&typeof t=="object"&&t.constructor===n?t:new n(function(n){n(t)})};n.reject=function(t){return new n(function(n,i){i(t)})};n.race=function(t){return new n(function(n,i){for(var r=0,u=t.length;r<u;r++)t[r].then(n,i)})};n._immediateFn=typeof setImmediate=="function"&&function(n){setImmediate(n)}||function(n){s(n,0)};n._unhandledRejectionFn=function(n){typeof console!="undefined"&&console&&console.warn("Possible Unhandled Promise Rejection:",n)};i=function(){if(typeof self!="undefined")return self;if(typeof window!="undefined")return window;if(typeof global!="undefined")return global;throw new Error("unable to locate global object");}();"Promise"in i?i.Promise.prototype["finally"]||(i.Promise.prototype["finally"]=f):i.Promise=n});(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function re(n,t,i,r){r&&n?n.removeAttribute(t):n&&n.setAttribute(t,i)}function tht(){return["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"]}function urt(n,t){return n.prototype&&t in n.prototype}function tb(n,i){return t.isNullOrUndefined(n)||""===n?"":u.DataUtil.getObject(n,i)}function iht(n,i){return t.isNullOrUndefined(n)||""===n?"":u.DataUtil.getObject(n,i)}function ib(n,t){requestAnimationFrame(function(){try{t(null,n())}catch(n){t(n)}})}function hh(n){return!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.columns)&&n.columns.length>0}function rb(n,t){for(var u,f=n.columns,r=t.columns,i=0;i<f.length;i++)if(r.length-1>=i)if(r[parseInt(i.toString(),10)].columns)for(u=0;u<r[parseInt(i.toString(),10)].columns.length;u++)f[parseInt(i.toString(),10)].columns[parseInt(u.toString(),10)].type=r[parseInt(i.toString(),10)].columns[parseInt(u.toString(),10)].type;else f[parseInt(i.toString(),10)].type=r[parseInt(i.toString(),10)].type}function frt(n){for(var r=[],i=n.vRows,t=0;t<i.length;t++)i[parseInt(t.toString(),10)].isDataRow?r.push(i[parseInt(t.toString(),10)]):i[parseInt(t.toString(),10)].isDataRow||(r.push(i[parseInt(t.toString(),10)]),!i[parseInt(t.toString(),10)].isExpand&&i[parseInt(t.toString(),10)].isCaptionRow&&(t+=ert(i[parseInt(t.toString(),10)],n)));n.vcRows=r}function ert(n,i){var h,a,f;nr=0;var e="gSummary",o=i.groupSettings.columns.length,s="records",r="items",l=n[""+e],c=0,u="aggregatesCount";if(l===n.data.count)return i.groupSettings.columns.length&&!t.isNullOrUndefined(n[""+u])&&n[""+u]?1!==i.groupSettings.columns.length?nr+=0!==n.indent&&l<2?n[""+e]*(o-n.indent+(o-n.indent)*n[""+u]):n[""+e]*(o-n.indent+(o-n.indent-1)*n[""+u])+n[""+u]:1===i.groupSettings.columns.length&&(nr+=n[""+e]*(o-n.indent)+n[""+u]):i.groupSettings.columns.length&&(nr+=1!==i.groupSettings.columns.length?n[""+e]*(i.groupSettings.columns.length-n.indent):n[""+e]),nr;for(h=0,a=n.data[""+r].length;h<a;h++)f=n.data[""+r][parseInt(h.toString(),10)],nr+=f[""+r].length+(o===i.columns.length||t.isNullOrUndefined(f[""+r][""+s])?0:f[""+r][""+s].length),c+=t.isNullOrUndefined(f[""+r][""+s])||t.isNullOrUndefined(n[""+u])?f[""+r].length:f[""+r][""+s].length,f[""+r].GroupGuid&&0!==f[""+r].childLevels&&ub(f);return nr+=n.data[""+r].length,t.isNullOrUndefined(n[""+u])||n[""+u]&&nr&&0!==c&&(nr+=(nr-c)*n[""+u]+n[""+u]),nr}function ub(n){for(var t,i="items",r=0,u=n[""+i].length;r<u;r++)t=n[""+i][parseInt(r.toString(),10)],nr+=t.count,0!==t[""+i].childLevels&&ub(t)}function uf(n,i){for(var u,f=[],r=0,e=n.length;r<e;r++)u=i(n[parseInt(r.toString(),10)],r),t.isNullOrUndefined(u)||f.push(u);return f}function eo(n){for(var r=[],i=0;i<n.length;i++)r.push(t.extend({},oo(n[parseInt(i.toString(),10)]),{},!0));return r}function ri(n){if(n)try{var i="<"!==n[0];return"function"==typeof n?t.compile(n):i&&document.querySelectorAll(n).length?t.compile(document.querySelector(n).innerHTML.trim()):t.compile(n)}catch(i){return t.compile(n)}}function vr(n,i){var r={},u=["style","class"];t.extend(r,i,{});"style"in r&&(t.setStyleAttribute(n,r[u[0]]),delete r[u[0]]);"class"in r&&(t.addClass([n],r[u[1]]),delete r[u[1]]);t.attributes(n,r)}function ff(n,i,r,u){for(var e=t.extend(n,i,r),o=Object.keys(e),f=0;f<o.length;f++)u&&-1!==u.indexOf(o[parseInt(f.toString(),10)])&&delete e[o[parseInt(f.toString(),10)]];return e}function ch(n,i){void 0===i&&(i=0);for(var r=0,u=n.length;r<u;r++)n[parseInt(r.toString(),10)].columns?(n[parseInt(r.toString(),10)].index=t.isNullOrUndefined(n[parseInt(r.toString(),10)].index)?i:n[parseInt(r.toString(),10)].index,i++,i=ch(n[parseInt(r.toString(),10)].columns,i)):(n[parseInt(r.toString(),10)].index=t.isNullOrUndefined(n[parseInt(r.toString(),10)].index)?i:n[parseInt(r.toString(),10)].index,i++);return i}function ee(n,i,r){for(var u,f=0,e=n.length;f<e;f++)u=void 0,"string"==typeof n[parseInt(f.toString(),10)]?u=new hi({field:n[parseInt(f.toString(),10)]},r):n[parseInt(f.toString(),10)]instanceof hi&&!n[parseInt(f.toString(),10)].columns?u=n[parseInt(f.toString(),10)]:n[parseInt(f.toString(),10)].columns?(n[parseInt(f.toString(),10)].columns=ee(n[parseInt(f.toString(),10)].columns,null,r),u=new hi(n[parseInt(f.toString(),10)],r)):u=new hi(n[parseInt(f.toString(),10)],r),u.type&&"checkbox"===u.type.toLowerCase()&&(u.allowReordering=!1),u.headerText=t.isNullOrUndefined(u.headerText)?u.foreignKeyValue||u.field||"":u.headerText,u.foreignKeyField=u.foreignKeyField||u.field,u.valueAccessor=("string"==typeof u.valueAccessor?t.getValue(u.valueAccessor,window):u.valueAccessor)||tb,u.width=i&&t.isNullOrUndefined(u.width)?200:u.width,t.isNullOrUndefined(u.visible)&&(u.visible=!0),n[parseInt(f.toString(),10)]=u;return n}function fb(n,i,r){var o=n.querySelector("span"),f=n.parentElement.getBoundingClientRect(),e=i.target.getBoundingClientRect(),u;o.className=r;n.style.display="";u=(t.isNullOrUndefined(i.clientY)?i.changedTouches[0].clientY:i.clientY)>n.offsetHeight+10;n.style.top=e.top-f.top+(u?-(n.offsetHeight+10):n.offsetHeight+10)+"px";n.style.left=function(n,t,i,r){var u=n.offsetWidth/2,f=su(t).x;return f-i.left<u?i.left-r:i.right-f<u?i.right-r-2*u:f-r-u}(n,i,e,f.left)+"px";u?(n.querySelector(".e-downtail").style.display="",n.querySelector(".e-uptail").style.display="none"):(n.querySelector(".e-downtail").style.display="none",n.querySelector(".e-uptail").style.display="")}function oo(n){return n instanceof t.ChildProperty?t.getValue("properties",n):n}function i(n,t,i){for(var r=n;r&&!(i?r.id===t:r.classList.contains(t));)r=r.parentElement;return r}function rv(n,t){for(var r=-1,i=0,u=t.length;i<u;i++)if(t[parseInt(i.toString(),10)].isEqualNode(n)){r=i;break}return r}function so(n,t){for(var i=0,r=t.length;i<r;i++)if(t[parseInt(i.toString(),10)]===n)return i;return-1}function uv(n){for(var i=[],t=0,r=n.length;t<r;t++)n[parseInt(t.toString(),10)].hasOwnProperty("properties")?i.push(n[parseInt(t.toString(),10)].properties):i.push(n[parseInt(t.toString(),10)]);return i}function fv(n,i){for(var u=[].slice.call(n.querySelectorAll(i)),r=0;r<u.length;r++)t.remove(u[parseInt(r.toString(),10)])}function su(n){var i={};return i.x=t.isNullOrUndefined(n.clientX)?n.changedTouches[0].clientX:n.clientX,i.y=t.isNullOrUndefined(n.clientY)?n.changedTouches[0].clientY:n.clientY,i}function tr(n){return n+ort++}function kt(n,t){for(var i=0,r=t.length;i<r;i++)r===t.length?n.appendChild(t[parseInt(i.toString(),10)]):n.appendChild(t[0]);return n}function srt(n,t,i){for(var r=n,u=[];r;)(i?r.id===t:r.classList.contains(t))&&u.push(r),r=r.parentElement;return u}function eb(n,i,r,f){if("Custom"===n){var e=r.customAggregate;return"string"==typeof e&&(e=t.getValue(e,window)),e?e.call(f,i,r):""}return r.field in i||i instanceof Array?u.DataUtil.aggregates[n.toLowerCase()](i,r.field):null}function hu(){if(null!==ov)return ov;var t,n=document.createElement("div");return n.style.cssText="width:100px;height: 100px;overflow: scroll;position: absolute;top: -9999px;",document.body.appendChild(n),t=n.offsetWidth-n.clientWidth|0,document.body.removeChild(n),ov=t}function hrt(n){var i,r;return void 0!==ev?ev:(i=t.createElement("table",{className:k,styles:"visibility: hidden",attrs:{role:"grid"}}),i.innerHTML='<tr><td class="e-rowcell">A<td><\/tr>',n.appendChild(i),r=i.querySelector("td").getBoundingClientRect(),n.removeChild(i),ev=Math.ceil(r.height))}function uht(n){var i,r;return void 0!==rht?ev:(i=t.createElement("table",{className:k,styles:"visibility: hidden",attrs:{role:"grid"}}),i.innerHTML='<tr><td class="e-rowcell">A<td><\/tr>',n.appendChild(i),r=i.querySelector("tr").getBoundingClientRect(),n.removeChild(i),r.height)}function ir(n){return n.split(".").length>1}function wt(n){return void 0===n&&(n=""),n.replace(/\./g,"___")}function lh(n){return void 0===n&&(n=""),n.replace(/[^a-zA-Z0-9_.]/g,"\\$&")}function ah(n){return void 0===n&&(n=""),n.replace(/___/g,".")}function br(n,t,r){var u=i(r,y),f=!u||u&&!u.classList.contains("e-insertedrow");return"beginEdit"===t&&f?!(n.isIdentity||n.isPrimaryKey||!n.allowEditing):!("add"===t&&n.isIdentity||f&&!n.allowEditing&&!n.isIdentity&&!n.isPrimaryKey)}function sr(n){var i=t.select("#"+n.element.id+"EditConfirm",n.element);return"Batch"===n.editSettings.mode&&t.selectAll(".e-updatedtd",n.element).length&&n.editSettings.showConfirmDialog&&(!i||i.classList.contains("e-popup-close"))}function li(n,t){var r="e-wrap",i;for(n=n instanceof Array?n:[n],i=0;i<n.length;i++)t?n[parseInt(i.toString(),10)].classList.add(r):n[parseInt(i.toString(),10)].classList.remove(r)}function sv(n,t){var i,r=n.getService("valueFormatter");switch("date"!==t.type&&"datetime"!==t.type&&"dateonly"!==t.type||(i={type:"dateonly"===t.type?"date":t.type,skeleton:t.format},"string"==typeof t.format&&"yMd"!==t.format&&(i.format=t.format)),t.type){case"date":case"dateonly":case"datetime":t.setFormatter(r.getFormatFunction(i));t.setParser(r.getParserFunction(i));break;case"number":t.setFormatter(r.getFormatFunction({format:t.format}));t.setParser(r.getParserFunction({format:t.format}))}}function rr(n,i){for(var r,e,f=[],u=2;u<arguments.length;u++)f[u-2]=arguments[u];for(r=0,e=n.length;r<e;r++)i?(t.classList(n[parseInt(r.toString(),10)],f.slice(),[]),n[parseInt(r.toString(),10)].setAttribute("aria-selected","true")):(t.classList(n[parseInt(r.toString(),10)],[],f.slice()),n[parseInt(r.toString(),10)].removeAttribute("aria-selected"))}function crt(n){for(var i={},r=[],t=0;t<n.length;t++)n[parseInt(t.toString(),10)]in i||(r.push(n[parseInt(t.toString(),10)].toString()),i[n[parseInt(t.toString(),10)]]=1);return r}function ob(n,t){var f=t.element.style.display,r,u,i;t.element.style.display="block";r=t.width;u=bt.calculateRelativeBasedPosition(n,t.element);t.element.style.display=f;t.element.style.top=u.top+n.getBoundingClientRect().height-5+"px";i=u.left-r+n.clientWidth;t.element.style.left=i<1?r+i-16+"px":i+-4+"px"}function sb(n,t){n.popup.element.style.zIndex=(t.zIndex+1).toString()}function hb(n){var i=n.querySelector(".e-frame"),r=i.previousSibling;i.classList.contains("e-check")?(r.checked=!1,t.classList(i,["e-uncheck"],["e-check"])):(r.checked=!0,t.classList(i,["e-check"],["e-uncheck"]))}function ef(n,t){n.checked=t}function vh(n,i,r){var u=t.createElement("div",{className:r});return u.appendChild(i),u.setAttribute("uid",n),u}function ho(n,i){t.removeClass([n],["e-check","e-stop","e-uncheck"]);i?n.classList.add("e-check"):n.classList.add("e-uncheck")}function co(n,i,r){for(var f,u=0;u<i.length;u++)t.setValue(i[parseInt(u.toString(),10)].field,cu(i[parseInt(u.toString(),10)],r),n.foreignKeyData);for(f=n.cells,u=0;u<f.length;u++)f[parseInt(u.toString(),10)].isForeignKey&&t.setValue("foreignKeyData",t.getValue(f[parseInt(u.toString(),10)].column.field,n.foreignKeyData),f[parseInt(u.toString(),10)])}function cu(n,i,r,f){var s=n.foreignKeyField,e=t.isNullOrUndefined(r)?tb(n.field,i):r,o,h;return e=t.isNullOrUndefined(e)?"":e,o=new u.Query,h=f||(n.dataSource instanceof u.DataManager&&n.dataSource.dataSource.json.length?n.dataSource.dataSource.json:n.columnData),e.getDay?o.where(au({field:s,operator:"equal",value:e,matchCase:!1})):o.where(s,"==",e,!1),new u.DataManager(h).executeLocal(o)}function lo(n,t){var i;return t.some(function(t){return i=t,t.foreignKeyValue===n})&&i}function lu(n){return n<10?"0"+n:String(n)}function au(n,i,r){var o,c,h,f=t.extend({},oo(n)),s=t.extend({},oo(n)),e,l,a,v;return t.isNullOrUndefined(n.value)||""===n.value?new u.Predicate(f.field,f.operator,f.value,!1):(e=new Date(n.value),"dateonly"!==i||r?"equal"===n.operator||"notequal"===n.operator?("datetime"===i?(c=new Date(e.setSeconds(e.getSeconds()-1)),h=new Date(e.setSeconds(e.getSeconds()+2)),n.value=new Date(e.setSeconds(h.getSeconds()-1))):(c=new Date(e.setHours(0)-1),h=new Date(e.setHours(24))),f.value=c,s.value=h,"equal"===n.operator?(f.operator="greaterthan",s.operator="lessthan"):"notequal"===n.operator&&(f.operator="lessthanorequal",s.operator="greaterthanorequal"),l=new u.Predicate(f.field,f.operator,f.value,!1),a=new u.Predicate(s.field,s.operator,s.value,!1),o="equal"===n.operator?l.and(a):l.or(a)):("date"!==i||"lessthanorequal"!==n.operator&&"greaterthan"!==n.operator||(f.value=new Date(e.setHours(24)-1)),"string"==typeof f.value&&(f.value=new Date(f.value)),o=new u.Predicate(f.field,f.operator,f.value,!1)):("string"==typeof f.value&&(f.value=new Date(f.value)),v=f.value.getFullYear()+"-"+lu(f.value.getMonth()+1)+"-"+lu(f.value.getDate()),o=new u.Predicate(f.field,f.operator,v,!1)),n.setProperties?n.setProperties({ejpredicate:o},!0):n.ejpredicate=o,o)}function yh(n,t,i){var u,r,f;for(t=t&&i&&i.isRowDragable()?t+1:t,u=n.cloneNode(!0),r=0;r<t;r++)u.removeChild(u.children[0]);for(r=t,f=n.childElementCount;r<f;r++)n.removeChild(n.children[n.childElementCount-1]);return u}function et(n){return n.enableVirtualization&&n.groupSettings.columns.length>0&&n.isVirtualAdaptive&&!n.groupSettings.enableLazyLoading}function ut(n,i){var e;if(void 0===n&&(n=""),n){for(var r=i,f=n.split("."),u=0;u<f.length&&!t.isNullOrUndefined(r);u++)(r=r[f[parseInt(u.toString(),10)]],t.isUndefined(r))&&(e=f[parseInt(u.toString(),10)].charAt(0).toUpperCase()+f[parseInt(u.toString(),10)].slice(1),r=i[""+e]||i[(""+e).charAt(0).toLowerCase()+(""+e).slice(1)]);return r}}function ph(n,i){var r=new t.Internationalization,f="format",u="type";return"date"===i?"object"==typeof n?r.getDatePattern({type:n[""+u]?n[""+u]:"date",format:n[""+f]},!1):r.getDatePattern({type:"dateTime",skeleton:n},!1):"object"==typeof n?r.getDatePattern({type:n[""+u]?n[""+u]:"dateTime",format:n[""+f]},!1):r.getDatePattern({type:"dateTime",skeleton:n},!1)}function lrt(n,t){for(var i,u,r={},f=0,e=n.getRowsObject();f<e.length;f++)i=e[f],i.isExpand&&!i.isDetailRow&&(u=n.allowPaging&&"AllPages"===n.printMode?i.index+n.pageSettings.currentPage*n.pageSettings.pageSize-n.pageSettings.pageSize:i.index,r[parseInt(u.toString(),10)]={},r[parseInt(u.toString(),10)].isExpand=!0,r[parseInt(u.toString(),10)].gridModel=wh(i.childGrid,t),r[parseInt(u.toString(),10)].gridModel.query=n.childGrid.query);return r}function wh(n,t){var i,r;if(void 0===t&&(t="Expanded"),i={},!n)return i;for(var e=n.isFrozenGrid()&&!n.getFrozenColumns(),u=0,f=iv.printGridProp;u<f.length;u++)r=f[u],i[""+r]="columns"===r?uv(e?n.getColumns():n[""+r]):"allowPaging"===r?"CurrentPage"===n.printMode:oo(n[""+r]);return i.enableHover=!1,n.childGrid&&"None"!==t&&(i.expandedRows=lrt(n,t)),i}function bh(n,i,r,u){var s=n||{},a=arguments.length,h;for(u&&(a-=1),h=1;h<a;h++)if(arguments[parseInt(h.toString(),10)])for(var c=arguments[parseInt(h.toString(),10)],e=Object.keys(Object.getPrototypeOf(c)).length?Object.keys(c).concat(fht(c)):Object.keys(c),f=0;f<e.length;f++){var v=s[e[parseInt(f.toString(),10)]],o=c[e[parseInt(f.toString(),10)]],l=void 0;u&&(t.isObject(o)||Array.isArray(o))?t.isObject(o)?(l=v||{},s[e[parseInt(f.toString(),10)]]=t.extend({},l,o,u)):(l=v||[],s[e[parseInt(f.toString(),10)]]=t.extend([],l,o,u)):s[e[parseInt(f.toString(),10)]]=o}return s}function fht(n){for(var t=[];Object.getPrototypeOf(n)&&Object.keys(Object.getPrototypeOf(n)).length;)t=t.concat(Object.keys(Object.getPrototypeOf(n))),n=Object.getPrototypeOf(n);return t}function kh(n){for(var r,t=0,i=0;i<n.length;i++)r=cb(n[parseInt(i.toString(),10)],0),t<r&&(t=r);return t+1}function cb(n,t){var f=t,u=[],i,r;if(n.columns){for(t++,i=0;i<n.columns.length;i++)u[parseInt(i.toString(),10)]=cb(n.columns[parseInt(i.toString(),10)],t);for(r=0;r<u.length;r++)f<u[parseInt(r.toString(),10)]&&(f=u[parseInt(r.toString(),10)]);t=f}return t}function art(n,t){for(var i=0;i<t.length;i++)t[parseInt(i.toString(),10)].uid=t[parseInt(i.toString(),10)].isForeignKey?lo(t[parseInt(i.toString(),10)].field,n.getForeignKeyColumns()).uid:n.enableColumnVirtualization?wb(n,t[parseInt(i.toString(),10)].field).uid:n.getColumnByField(t[parseInt(i.toString(),10)].field).uid}function hv(n){var t=document.defaultView.getComputedStyle(n,null).getPropertyValue("transform").replace(/,/g,"");return{width:parseFloat(t.split(" ")[4]),height:parseFloat(t.split(" ")[5])}}function ao(n,t){n.classList.contains("e-bigger")&&t.classList.add("e-bigger")}function dh(n,i){if(n&&i){var r=t.closest(n,"."+y).getBoundingClientRect().height,u=t.closest(i,"."+y).getBoundingClientRect().height;r>u?i.style.height=r+"px":n.style.height=u+"px"}}function vrt(n,t){var i=t.getContent().firstElementChild.offsetHeight;return n&&n.getBoundingClientRect().top>i}function yrt(n,t){return n&&n.getBoundingClientRect().top<t}function prt(n,t){var i=t.getRowHeight(),r=t.getContent().firstElementChild.scrollTop/i;return n<r+t.getContent().firstElementChild.offsetHeight/i&&n>r}function cv(n,t){var r,i=n.getPrimaryKeyFieldNames()[0];return n.getCurrentViewRecords().filter(function(n,u){i.includes(".")?ut(i,n)===ut(i,t)&&(r=u):n[""+i]===t[""+i]&&(r=u)}),r}function lv(n,t){var i=wrt(t),r=new u.Deferred;return i.dataSource=r.resolve,i.action=n,{state:i,deffered:r}}function wrt(n){var t=new u.UrlAdaptor,i=new u.DataManager({url:"",adaptor:new u.UrlAdaptor}),r=t.processQuery(i,n);return JSON.parse(r.data)}function av(n){for(var r=n.getVisibleColumns(),u=0,f=0,i=0;i<r.length;i++)t.isUndefined(r[parseInt(i.toString(),10)].width)?f++:-1!==r[parseInt(i.toString(),10)].width.toString().indexOf("%")&&u++;return("auto"===n.width||"string"==typeof n.width&&-1!==n.width.indexOf("%"))&&!n.groupSettings.showGroupedColumn&&n.groupSettings.columns.length&&u&&!f}function of(n,t,i,r,u){for(var o,e=r||0,f=u||0;f<t.length;f++)if(t[parseInt(f.toString(),10)]&&t[parseInt(f.toString(),10)].isDataRow){for(t[parseInt(f.toString(),10)].index=e,t[parseInt(f.toString(),10)].isAltRow=!!n.enableAltRow&&e%2!=0,i[parseInt(f.toString(),10)].setAttribute(h,e.toString()),i[parseInt(f.toString(),10)].setAttribute(ne,(e+1).toString()),t[parseInt(f.toString(),10)].isAltRow?i[parseInt(f.toString(),10)].classList.add("e-altrow"):i[parseInt(f.toString(),10)].classList.remove("e-altrow"),o=0;o<i[parseInt(f.toString(),10)].cells.length;o++)i[parseInt(f.toString(),10)].cells[parseInt(o.toString(),10)].setAttribute("index",e.toString());e++}t.length||n.renderModule.emptyRow(!0)}function brt(n,t,i,r){var u=n.dataToBeUpdated[""+i].concat(t[""+i]).reduce(function(n,t){return n[t[""+r]]=void 0===n[t[""+r]]?t:Object.assign(n[t[""+r]],t),n},{});n.dataToBeUpdated[""+i]=Object.keys(u).map(function(n){return u[""+n]})}function oe(n){if(n.isFrozenGrid()){n.contentModule.rowElements=[].slice.call(n.element.querySelectorAll(".e-movableheader .e-row, .e-movablecontent .e-row"));var t=n.getFrozenMode()===s?".e-frozen-left-header .e-row, .e-frozen-left-content .e-row":".e-frozenheader .e-row, .e-frozencontent .e-row";n.contentModule.freezeRowElements=[].slice.call(n.element.querySelectorAll(t));n.getFrozenMode()===s&&(n.contentModule.frozenRightRowElements=[].slice.call(n.element.querySelectorAll(".e-frozen-right-header .e-row, .e-frozen-right-content .e-row")))}else n.contentModule.rowElements=[].slice.call(n.element.querySelectorAll(".e-row:not(.e-addedrow)"))}function gh(n,t,i){var r=n.getFrozenLeftCount(),o=n.getMovableColumnsCount(),f=n.getFrozenRightColumnsCount(),e=n.getFrozenMode(),u=n.isRowDragable()?1:0,s="Right"===e?r+o:r+o+u,h="Right"===e?r:r+u,c="Right"===e?t.length-f-u:f?t.length-f:t.length;return i===rt?t=t.slice(0,r?r+u:t.length):i===d?t=t.slice(s,t.length):"movable"===i&&(t=t.slice(h,c)),t}function krt(n,i){for(var u=n.getColumns(),f=[],e=[],o=[],r=0;r<u.length;r++)!t.isNullOrUndefined(i)&&i&&i!==u[parseInt(r.toString(),10)].visible||("Left"===u[parseInt(r.toString(),10)].freeze||"frozen-left"===u[parseInt(r.toString(),10)].freezeTable?e.push(u[parseInt(r.toString(),10)]):"Right"===u[parseInt(r.toString(),10)].freeze||"frozen-right"===u[parseInt(r.toString(),10)].freezeTable?o.push(u[parseInt(r.toString(),10)]):f.push(u[parseInt(r.toString(),10)]));return{frozenLeft:e,movable:f,frozenRight:o}}function vu(n,t,i,r,u){(i[0].length||r)&&(u?t(rt,i[0],u[0]):t(rt,i[0]));n.isFrozenGrid()&&(i[1].length||r)&&(u?t("movable",i[1],u[1]):t("movable",i[1]));n.getFrozenMode()!==s&&"Right"!==n.getFrozenMode()||!i[2].length&&!r||(u?t(d,i[2],u[2]):t(d,i[2]))}function nc(n){return["Right"!==n.getFrozenMode()?n.getRowsObject():[],n.getMovableRowsObject(),n.getFrozenRightRowsObject()]}function drt(n){return["Right"!==n.getFrozenMode()?n.getAllDataRows(!0):[],n.getAllMovableDataRows(!0),n.getAllFrozenRightDataRows(!0)]}function vv(n,t,i){for(var f=n.children.length,u=0,r=0;r<f;r++,u++)r>=t&&r<i||(n.removeChild(n.children[parseInt(u.toString(),10)]),u--)}function lb(n,t,i){return"movable"===t.getFreezeTableName()?[].slice.call(n.getMovableDataRows()[parseInt(i.toString(),10)].getElementsByClassName(a)):t.getFreezeTableName()===d?[].slice.call(n.getFrozenRightDataRows()[parseInt(i.toString(),10)].getElementsByClassName(a)):[].slice.call(n.getDataRows()[parseInt(i.toString(),10)].getElementsByClassName(a))}function yv(n,t,i,r){var u=n.getFrozenLeftCount(),f=n.getMovableColumnsCount();return r="movable"===t.getFreezeTableName()?r-u:t.getFreezeTableName()===d?r-(u+f):r,lb(n,t,i)[parseInt(r.toString(),10)]}function ab(n,t,i,r,u,f,e){e||n.getFreezeTableName()===rt||!t&&n.getFreezeTableName()===d||1===f?i[wt(n.field)]=n.validationRules:"movable"!==n.getFreezeTableName()&&n.getFreezeTableName()?n.getFreezeTableName()===d&&(u[wt(n.field)]=n.validationRules):r[wt(n.field)]=n.validationRules}function grt(n){var t;return n.isFrozenGrid()&&(t=n.frozenRows&&"Top"===n.editSettings.newRowPosition?n.getMovableHeaderTbody():n.getMovableContentTbody()),t}function nut(n){var t;return n.getFrozenMode()===s&&(t=n.frozenRows&&"Top"===n.editSettings.newRowPosition?n.getFrozenRightHeaderTbody():n.getFrozenRightContentTbody()),t}function vb(n,t,i,r,u,f,e){n&&r&&e(n,r);t&&u&&e(t,u);i&&f&&e(i,f)}function tut(n,i,r,u){var f,e=new t.Internationalization,o;if("number"===i)try{f=e.getNumberPattern({format:n,currency:u,useGrouping:!0},!0)}catch(i){f=n}else if("date"===i||"time"===i||"datetime"===i)try{if(f=e.getDatePattern({skeleton:n,type:i},r),t.isNullOrUndefined(f))throw"error";}catch(t){try{f=e.getDatePattern({format:n,type:i},r)}catch(i){f=n}}else f=n;return"number"!==i&&(o={G:"",H:"h",c:"d","'":'"'," a":" AM/PM",yy:"yy",y:"yyyy",EEEE:"dddd",E:"ddd"},f=f.replace(/G|H|c|'| a|yy|y|EEEE|E/g,function(n){return o[""+n]})),f}function yb(n){if(n.enableAdaptiveUI)for(var i=document.getElementsByClassName("e-responsive-dialog"),t=0;t<i.length;t++)i[parseInt(t.toString(),10)].classList.add("e-bigger")}function pv(n,t){for(var r,f=n.split(".").length,e=n.split("."),u=t,i=0;i<f;i++)u=r=u[e[parseInt(i.toString(),10)]];return r}function pb(n,i,r,u,f,e){for(var h,c,s=Object.keys(n),o=0;o<s.length;o++)h=n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(i.toString(),10)],n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell").length&&h&&((t.setStyleAttribute(n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(i.toString(),10)],{display:r}),n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(i.toString(),10)].classList.contains("e-hide")&&t.removeClass([n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(i.toString(),10)]],["e-hide"]),e&&f.isRowDragable())?(c=f.getFrozenColumns()?i:i+1,u[s[parseInt(o.toString(),10)]].cells[parseInt(c.toString(),10)].visible=""===r):(u[s[parseInt(o.toString(),10)]].cells[parseInt(i.toString(),10)].visible=""===r,!1===u[s[parseInt(o.toString(),10)]].cells[parseInt(i.toString(),10)].visible&&n[s[parseInt(o.toString(),10)]].querySelectorAll("td.e-rowcell")[parseInt(i.toString(),10)].classList.add("e-hide")))}function vt(n,t,i,r){for(var u,f=0,e=t;f<e.length;f++)u=e[f],i?n.on(u.event,u.handler,r):n.off(u.event,u.handler)}function vo(n,t,i,r){var u=wt(t.field);return r=Object.assign(r,{id:n.element.id+u,name:u,"e-mappinguid":t.uid}),n.createElement("input",{className:i,attrs:r})}function iut(n,t){for(var f,u,i=0,r=n.columnModel;i<r.length;i++)if(u=r[i],u.uid===t){f=u;break}return f}function wb(n,t){var f,i,r,u;for(n.columnModel||n.getColumns(),i=0,r=n.columnModel;i<r.length;i++)if(u=r[i],u.field===t){f=u;break}return f}function bb(n,t,i,r){r.eventHandlers[""+n]={};for(var u=0;u<t.length;u++)r.eventHandlers[""+n][t[parseInt(u.toString(),10)]]=i[t[parseInt(u.toString(),10)]]}function kb(n,t,i){for(var r=0;r<t.length&&!n.isDestroyed;r++)n.removeEventListener(t[parseInt(r.toString(),10)],i.eventHandlers[n.element.id][t[parseInt(r.toString(),10)]])}function yo(n,t){n.destroyTemplate(t);n.isReact&&n.renderTemplates()}function hr(n){return parseInt(n.getAttribute(h),10)}function wv(n,i,r){for(var f=[],u=0;u<n.length;u++){var o=r.parent.getColumnByField(n[parseInt(u.toString(),10)]),e="null"===i[parseInt(u.toString(),10)]?null:i[parseInt(u.toString(),10)],s={field:n[parseInt(u.toString(),10)],predicate:"or",uid:o.uid,operator:"equal",type:o.type,matchCase:r.allowCaseSensitive,ignoreAccent:r.parent.filterSettings.ignoreAccent};""===e||t.isNullOrUndefined(e)?f=f.concat(ru.generateNullValuePredicates(s)):f.push(ff({},{value:e},s))}return ru.getPredicate(f)}function bv(n){for(var u,i=[],t=0,r=Object.keys(n);t<r.length;t++)u=r[t],i.push(n[""+u]);return i}function po(n,t){for(var r=[],u=[],i=n;i>=0&&(!t[parseInt(i.toString(),10)].isCaptionRow||-1!==r.indexOf(t[parseInt(i.toString(),10)].data.field)||!(t[parseInt(i.toString(),10)].indent<t[parseInt(n.toString(),10)].indent||i===n)||(r.push(t[parseInt(i.toString(),10)].data.field),u.push(t[parseInt(i.toString(),10)].data.key),0!==t[parseInt(i.toString(),10)].indent));i--);return{fields:r,keys:u}}function yr(n,t,i){var e=n,o=t,f=!1,r,s,u;if(i)for(r=o[0];r<e.length;r++)for(s=e[parseInt(r.toString(),10)],u=0;u<s.length;u++){if(f&&1===e[parseInt(r.toString(),10)][parseInt(u.toString(),10)])return[r,u];f||o.toString()!==[r,u].toString()||(f=!0)}else for(r=o[0];r>=0;r--)for(u=(s=e[parseInt(r.toString(),10)]).length-1;u>=0;u--){if(f&&1===e[parseInt(r.toString(),10)][parseInt(u.toString(),10)])return[r,u];f||o.toString()!==[r,u].toString()||(f=!0)}return o}function rut(n){return n.charAt(0).toUpperCase()+n.slice(1)}function wut(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<n[parseInt(i.toString(),10)].columns.length;r++)t(n[parseInt(i.toString(),10)].columns[parseInt(r.toString(),10)],n[parseInt(i.toString(),10)])}function eft(n,t,i,r,u){var e="Dialog"!==t,o=ph(n.column.format,n.column.type),f=ut(n.column.field,n.rowData);return{floatLabelType:e?"Never":"Always",value:f=f?new Date(f):null,format:o,placeholder:e?"":n.column.headerText,enableRtl:i,enabled:br(n.column,n.requestType,n.element),cssClass:r||null,close:ect.bind(u)}}function ect(n){n.event&&"escape"===n.event.action&&(this.edit.editCellDialogClose=!0)}function ry(n,t,i,r,u,f,o,h){var y,c,v,l,a;for(r.clearSelection(),n.startIndex=0,y=new oi(f,null,r),c=u.generateRows(t,n),n.renderMovableContent?(o.vgenerator.movableCache[1]=c,c=r.getMovableRowsObject()):n.renderFrozenRightContent||n.renderMovableContent?n.renderFrozenRightContent&&(o.vgenerator.frozenRightCache[1]=c,c=r.getFrozenRightRowsObject()):(o.vgenerator.cache[1]=c,c=r.getRowsObject()),v=n.renderMovableContent||n.renderFrozenRightContent?n.renderMovableContent?r.getHeaderContent().querySelector("."+w).querySelector(e):r.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(e):r.getHeaderContent().querySelector("."+fr).querySelector(e),v.innerHTML="",l=0;l<r.frozenRows;l++)if(v.appendChild(y.render(c[parseInt(l.toString(),10)],r.getColumns())),i.indexOf(l)>-1)for(c[parseInt(l.toString(),10)].isSelected=!0,a=0;a<c[parseInt(l.toString(),10)].cells.length;a++)c[parseInt(l.toString(),10)].cells[parseInt(a.toString(),10)].isSelected=!0;n.renderMovableContent?h.mvblRows=o.vgenerator.movableCache[1]:n.renderMovableContent||n.renderFrozenRightContent?n.renderFrozenRightContent&&(h.frRows=o.vgenerator.frozenRightCache[1]):h.frzRows=o.vgenerator.cache[1];n.renderMovableContent=!n.renderMovableContent&&!n.renderFrozenRightContent;n.renderFrozenRightContent=r.getFrozenMode()===s&&!n.renderMovableContent&&!n.renderFrozenRightContent;(n.renderMovableContent||n.renderFrozenRightContent)&&(ry(n,t,i,r,u,f,o,h),n.renderMovableContent||n.renderFrozenRightContent||(n.isFrozenRowsRender=!1))}function yft(n,i,r){for(var f=[],u=0;u<n.length;u++)f.push(t.extend({},n[parseInt(u.toString(),10)])),f[parseInt(u.toString(),10)].cells=gh(r,f[parseInt(u.toString(),10)].cells,i);return f}function vk(n,t,i){var r,f=[],e,u;for(n===rt?r=t.vgenerator.cache:"movable"===n?r=t.vgenerator.movableCache:n===d&&(r="Right"===i.getFrozenMode()?t.vgenerator.cache:t.vgenerator.frozenRightCache),e=Object.keys(r),u=0;u<e.length;u++)f=f.concat(yft(r[e[parseInt(u.toString(),10)]],n,i));return f}function yk(n,t){for(var r=Object.keys(t.vgenerator.cache),u=Object.keys(t.vgenerator.movableCache),f=Object.keys(t.vgenerator.frozenRightCache),i=0;i<r.length;i++)uy(n,t.vgenerator.cache[r[parseInt(i.toString(),10)]]);for(i=0;i<u.length;i++)uy(n,t.vgenerator.movableCache[u[parseInt(i.toString(),10)]]);for(i=0;i<f.length;i++)uy(n,t.vgenerator.frozenRightCache[f[parseInt(i.toString(),10)]])}function uy(n,t){for(var f,u,r=t.filter(function(t){return n.clearAll||n.uid===t.uid}),i=0;i<r.length;i++)for(r[parseInt(i.toString(),10)].isSelected=n.set,f=r[parseInt(i.toString(),10)].cells,u=0;u<f.length;u++)f[parseInt(u.toString(),10)].isSelected=n.set}function pk(n,t,i,r,u){n.appendContent(i,r,u);t.refreshFrozenScrollbar()}function wk(n,i,r,u,f){var o,e;return o=n.vgenerator.generateRows(i,r).map(function(n){return t.extend({},n)}),e=u.generateRows(i,r,o),f.frozenRows&&"delete"===r.requestType&&1===f.pageSettings.currentPage&&(e=e.slice(f.frozenRows)),e}function bk(n,t,i,r,u){var o=n.virtualInfo.blockIndexes,s=n.virtualInfo.columnIndexes,h=n.virtualInfo.page,f,e;return n.virtualInfo.blockIndexes=[1,2],n.virtualInfo.page=1,n.renderMovableContent||(n.virtualInfo.columnIndexes=[]),f=i.getCurrentViewRecords().length,u=i.renderModule.data.dataManager.dataSource.json.slice(0,f),e=pft(t.vgenerator.generateRows(u,n),i,n),n.virtualInfo.blockIndexes=o,n.virtualInfo.columnIndexes=s,n.virtualInfo.page=h,e.splice(0,i.frozenRows)}function pft(n,t,i){var u,r,f;for(u=i.renderMovableContent?"movable":i.renderFrozenRightContent?"frozen-right":"frozen-left",r=0,f=n.length;r<f;r++)n[parseInt(r.toString(),10)].cells=gh(t,n[parseInt(r.toString(),10)].cells,u);return n}function he(n){var t=!1;return n&&(t="virtualscroll"===n.requestType&&"X"===n.currentInfo.sentinelInfo.axis),t}function kk(n,t){var i=he(n)?t.getMovableVirtualHeader():t.getHeaderContent();return i?[].slice.call(i.querySelectorAll(".e-headercell:not(.e-stackedheadercell)")):[]}function dk(n,t){return he(n)?t.getMovableVirtualHeader().querySelector("."+k+":not(.e-masked-table)"):t.getFrozenVirtualHeader().querySelector("."+k)}function gk(n,t){return t.columns.slice(0,t.getFrozenColumns()).concat(n)}function nd(n,i,r){return he(i)||(t.isNullOrUndefined(n)||(n.id="content-"+n.id),r.colgroup=n),r.colgroup}function td(n,t){n.virtualRenderer.vgenerator.cache[1]?n.virtualRenderer.vgenerator.cache[1][parseInt(t.toString(),10)]=n.frzRows[parseInt(t.toString(),10)]:n.virtualRenderer.vgenerator.cache[1]=n.frzRows;n.virtualRenderer.vgenerator.movableCache[1]?n.virtualRenderer.vgenerator.movableCache[1][parseInt(t.toString(),10)]=n.mvblRows[parseInt(t.toString(),10)]:n.virtualRenderer.vgenerator.movableCache[1]=n.mvblRows}function id(n,t,i,r){var f=n.dataSource instanceof u.DataManager&&!n.dataSource.dataSource.offline,e={container:t.content,pageHeight:2*t.getBlockHeight(),debounceEvent:f,axes:n.enableColumnVirtualization?["X","Y"]:["Y"],scrollbar:i,movableContainer:r};t.observer=new nk(t.virtualEle.wrapper,e,t.virtualEle.movableWrapper)}var rc,uc,iv,nr,ort,ev,rht,or,ov,ru,kft;rc={};n.r(rc);n.d(rc,{Aggregate:()=>dht,AutoCompleteEditCell:()=>rlt,BatchEdit:()=>uft,BatchEditRender:()=>kut,BooleanEditCell:()=>nft,BooleanFilterUI:()=>yut,Cell:()=>pi,CellRenderer:()=>si,CellRendererFactory:()=>uit,CellType:()=>o,CheckBoxFilter:()=>gb,CheckBoxFilterBase:()=>ru,Clipboard:()=>lit,Column:()=>hi,ColumnChooser:()=>hct,ColumnFreezeContentRenderer:()=>lk,ColumnFreezeHeaderRenderer:()=>lft,ColumnMenu:()=>yct,ColumnVirtualFreezeRenderer:()=>wft,ComboboxEditCell:()=>flt,CommandColumn:()=>lct,CommandColumnModel:()=>dft,CommandColumnRenderer:()=>sft,ContentRender:()=>fo,ContextMenu:()=>act,Data:()=>th,DateFilterUI:()=>kv,DatePickerEditCell:()=>ok,DefaultEditCell:()=>rft,DetailRow:()=>vht,DialogEdit:()=>fft,DialogEditRender:()=>dut,DropDownEditCell:()=>tft,Edit:()=>sct,EditCellBase:()=>gr,EditRender:()=>gut,EditSettings:()=>irt,ExcelExport:()=>hk,ExcelFilter:()=>put,ExcelFilterBase:()=>uut,ExportHelper:()=>hf,ExportValueFormatter:()=>sk,ExternalMessage:()=>sut,Filter:()=>dv,FilterCellRenderer:()=>cut,FilterSettings:()=>wit,FlMenuOptrUI:()=>lut,ForeignKey:()=>wct,Freeze:()=>vct,FreezeContentRender:()=>ty,FreezeRender:()=>iy,FreezeRowModelGenerator:()=>ic,Global:()=>or,Grid:()=>tv,GridColumn:()=>ed,Group:()=>sf,GroupCaptionCellRenderer:()=>tit,GroupCaptionEmptyCellRenderer:()=>iit,GroupLazyLoadRenderer:()=>rd,GroupModelGenerator:()=>eh,GroupSettings:()=>trt,HeaderCellRenderer:()=>ww,HeaderRender:()=>ka,IndentCellRenderer:()=>da,InfiniteScroll:()=>gct,InfiniteScrollSettings:()=>pit,InlineEdit:()=>ek,InlineEditRender:()=>uk,InterSectionObserver:()=>nk,LazyLoadGroup:()=>tlt,LoadingIndicator:()=>rrt,Logger:()=>bct,MaskedTextBoxCellEdit:()=>vlt,MultiSelectEditCell:()=>olt,NormalEdit:()=>fk,NumberFilterUI:()=>vut,NumericContainer:()=>fut,NumericEditCell:()=>ift,Page:()=>tc,Pager:()=>db,PagerDropDown:()=>out,PagerMessage:()=>eut,PdfExport:()=>ck,Predicate:()=>yit,Print:()=>iv,Render:()=>rit,RenderType:()=>at,Reorder:()=>lht,Resize:()=>gv,ResizeSettings:()=>nrt,ResponsiveDialogAction:()=>g,ResponsiveDialogRenderer:()=>kw,ResponsiveToolbarAction:()=>bu,Row:()=>lr,RowDD:()=>aht,RowDropSettings:()=>dit,RowModelGenerator:()=>er,RowRenderer:()=>oi,Scroll:()=>nb,Search:()=>hit,SearchSettings:()=>kit,Selection:()=>sit,SelectionSettings:()=>bit,ServiceLocator:()=>fit,Sort:()=>bo,SortDescriptor:()=>ait,SortSettings:()=>vit,StackedColumn:()=>gft,StackedHeaderCellRenderer:()=>bw,StringFilterUI:()=>aut,TextWrapSettings:()=>git,TimePickerEditCell:()=>hlt,ToggleEditCell:()=>llt,Toolbar:()=>yht,ToolbarItem:()=>oy,ValueFormatter:()=>wu,VirtualContentRenderer:()=>ny,VirtualElementHandler:()=>rk,VirtualFreezeHdrRenderer:()=>vft,VirtualFreezeRenderer:()=>aft,VirtualHeaderRenderer:()=>ik,VirtualRowModelGenerator:()=>tk,VirtualScroll:()=>ght,accessPredicate:()=>rot,actionBegin:()=>nt,actionComplete:()=>l,actionFailure:()=>lf,addBegin:()=>not,addBiggerDialog:()=>yb,addComplete:()=>tot,addDeleteAction:()=>op,addRemoveActiveClasses:()=>rr,addRemoveEventListener:()=>vt,addedRecords:()=>ar,addedRow:()=>ui,afterContentRender:()=>cot,afterFilterColumnMenuClose:()=>nh,alignFrozenEditForm:()=>dh,appendChildren:()=>kt,appendContent:()=>pk,appendInfiniteContent:()=>yl,applyBiggerTheme:()=>ao,ariaColIndex:()=>yw,ariaRowIndex:()=>ne,autoCol:()=>gu,batchAdd:()=>du,batchCancel:()=>pr,batchCnfrmDlgCancel:()=>wtt,batchDelete:()=>ts,batchEditFormRendered:()=>yn,batchForm:()=>ln,beforeAutoFill:()=>og,beforeBatchAdd:()=>yd,beforeBatchCancel:()=>vn,beforeBatchDelete:()=>pd,beforeBatchSave:()=>wd,beforeCellFocused:()=>pf,beforeCheckboxRenderer:()=>itt,beforeCheckboxRendererQuery:()=>vtt,beforeCheckboxfilterRenderer:()=>ptt,beforeCopy:()=>fg,beforeCustomFilterOpen:()=>pn,beforeDataBound:()=>is,beforeExcelExport:()=>wg,beforeFltrcMenuOpen:()=>wn,beforeFragAppend:()=>vp,beforeOpen:()=>pw,beforeOpenAdaptiveDialog:()=>vy,beforeOpenColumnChooser:()=>tg,beforePaste:()=>eg,beforePdfExport:()=>gg,beforePrint:()=>ly,beforeRefreshOnDataChange:()=>ta,beforeStartEdit:()=>an,beginEdit:()=>bd,bulkSave:()=>up,cBoxFltrBegin:()=>cl,cBoxFltrComplete:()=>df,calculateAggregate:()=>eb,cancelBegin:()=>hs,capitalizeFirstLetter:()=>rut,captionActionComplete:()=>la,cellDeselected:()=>cy,cellDeselecting:()=>hy,cellEdit:()=>kd,cellFocused:()=>us,cellSave:()=>dd,cellSaved:()=>vc,cellSelected:()=>ns,cellSelecting:()=>le,cellSelectionBegin:()=>bet,cellSelectionComplete:()=>yg,change:()=>te,changedRecords:()=>gf,checkBoxChange:()=>ug,checkDepth:()=>cb,checkScrollReset:()=>ftt,clearReactVueTemplates:()=>yo,click:()=>ii,closeBatch:()=>att,closeEdit:()=>cw,closeFilterDialog:()=>kl,closeInline:()=>ltt,colGroup:()=>c,colGroupRefresh:()=>rs,collectRows:()=>vk,columnChooserCancelBtnClick:()=>dn,columnChooserOpened:()=>cn,columnDataStateChange:()=>on,columnDeselected:()=>sd,columnDeselecting:()=>od,columnDrag:()=>ku,columnDragStart:()=>vf,columnDragStop:()=>dc,columnDrop:()=>yf,columnMenuClick:()=>fn,columnMenuOpen:()=>en,columnPositionChanged:()=>wf,columnSelected:()=>lc,columnSelecting:()=>cc,columnSelectionBegin:()=>pet,columnSelectionComplete:()=>wet,columnVisibilityChanged:()=>di,columnWidthChanged:()=>ae,columnsPrepared:()=>hl,commandClick:()=>hg,commandColumnDestroy:()=>ya,compareChanges:()=>brt,componentRendered:()=>fot,content:()=>ft,contentReady:()=>it,contextMenuClick:()=>rn,contextMenuOpen:()=>un,create:()=>ih,createCboxWithWrap:()=>vh,createEditElement:()=>vo,createVirtualValidationForm:()=>gs,created:()=>net,crudAction:()=>ep,customFilterClose:()=>sw,dataBound:()=>ti,dataColIndex:()=>lt,dataReady:()=>ki,dataRowIndex:()=>h,dataSourceChanged:()=>ap,dataSourceModified:()=>ve,dataStateChange:()=>be,dblclick:()=>ye,deleteBegin:()=>iot,deleteComplete:()=>gc,deletedRecords:()=>eu,destroy:()=>v,destroyChildGrid:()=>ca,destroyForm:()=>nl,destroyed:()=>tet,detailDataBound:()=>ac,detailIndentCellInfo:()=>kp,detailLists:()=>bft,detailStateChange:()=>bp,dialogDestroy:()=>os,distinctStringValues:()=>crt,doesImplementInterface:()=>urt,doubleTap:()=>tl,downArrow:()=>wa,editBegin:()=>det,editComplete:()=>get,editNextValCell:()=>cs,editReset:()=>vs,editedRow:()=>ni,endAdd:()=>iet,endDelete:()=>ret,endEdit:()=>uet,ensureFirstRow:()=>yrt,ensureFrozenCols:()=>gk,ensureLastRow:()=>vrt,enter:()=>ba,enterKeyHandler:()=>ks,eventPromise:()=>lv,excelAggregateQueryCellInfo:()=>ttt,excelExportComplete:()=>bg,excelHeaderQueryCellInfo:()=>dg,excelQueryCellInfo:()=>kg,expandChildGrid:()=>sl,exportDataBound:()=>hn,exportDetailDataBound:()=>sp,exportGroupCaption:()=>ky,exportRowDataBound:()=>yp,extend:()=>ff,extendObjWithFn:()=>bh,filterAfterOpen:()=>wy,filterBeforeOpen:()=>by,filterBegin:()=>oet,filterCboxValue:()=>kn,filterChoiceRequest:()=>py,filterCmenuSelect:()=>ow,filterComplete:()=>dy,filterDialogClose:()=>bs,filterDialogCreated:()=>we,filterMenuClose:()=>yi,filterOpen:()=>il,filterSearchBegin:()=>sg,findCellIndex:()=>yr,fltrPrevent:()=>ge,focus:()=>ie,foreignKeyData:()=>lp,freezeRefresh:()=>uot,freezeRender:()=>ei,frozenContent:()=>wi,frozenHeader:()=>fr,frozenHeight:()=>ke,frozenLeft:()=>rt,frozenRight:()=>d,generateExpandPredicates:()=>wv,generateQuery:()=>kf,generateRows:()=>wk,getActualPropFromColl:()=>uv,getActualProperties:()=>oo,getActualRowHeight:()=>uht,getAggregateQuery:()=>oot,getCellByColAndRowIndex:()=>yv,getCellsByTableName:()=>lb,getCloneProperties:()=>tht,getCollapsedRowsCount:()=>ert,getColumnByForeignKeyValue:()=>lo,getColumnModelByFieldName:()=>wb,getColumnModelByUid:()=>iut,getComplexFieldID:()=>wt,getCustomDateFormat:()=>ph,getDatePredicate:()=>au,getEditedDataIndex:()=>cv,getElementIndex:()=>rv,getExactFrozenMovableColumn:()=>krt,getExpandedState:()=>lrt,getFilterBarOperator:()=>gn,getFilterMenuPostion:()=>ob,getForeignData:()=>cu,getForeignKeyData:()=>ss,getFrozenRightTbody:()=>nut,getGridRowElements:()=>drt,getGridRowObjects:()=>nc,getGroupKeysAndFields:()=>po,getHeaderCells:()=>kk,getMovableTbody:()=>grt,getNumberFormat:()=>tut,getObject:()=>ut,getParsedFieldID:()=>lh,getPosition:()=>su,getPredicates:()=>bv,getPrintGridModel:()=>wh,getReorderedFrozenRows:()=>bk,getRowHeight:()=>hrt,getRowIndexFromElement:()=>hr,getScrollBarWidth:()=>hu,getStateEventArgument:()=>wrt,getTransformValues:()=>hv,getUid:()=>tr,getUpdateUsingRaf:()=>ib,getVirtualData:()=>iu,getVirtualFreezeHeader:()=>dk,getZIndexCalcualtion:()=>sb,gridActionHandler:()=>vu,gridChkBox:()=>rf,gridContent:()=>ot,gridFooter:()=>fu,gridHeader:()=>ct,groupAggregates:()=>uu,groupBegin:()=>aet,groupCollapse:()=>gl,groupComplete:()=>pc,headerCellInfo:()=>sc,headerContent:()=>st,headerDrop:()=>bf,headerRefreshed:()=>yt,headerValueAccessor:()=>iht,hierarchyPrint:()=>ol,immutableBatchCancel:()=>utt,inArray:()=>so,inBoundModelChanged:()=>gt,infiniteCrudCancel:()=>ctt,infiniteEditHandler:()=>ws,infinitePageQuery:()=>al,infiniteScrollHandler:()=>ps,infiniteShowHide:()=>vl,initForeignKeyColumn:()=>rl,initialCollapse:()=>bl,initialEnd:()=>dt,initialLoad:()=>cr,isActionPrevent:()=>sr,isComplexField:()=>ir,isEditable:()=>br,isExportColumns:()=>hh,isGroupAdaptive:()=>et,isRowEnteredInGrid:()=>prt,isXaxis:()=>he,ispercentageWidth:()=>av,iterateArrayOrObject:()=>uf,iterateExtend:()=>eo,keyPressed:()=>ht,lazyLoadGroupCollapse:()=>lg,lazyLoadGroupExpand:()=>cg,lazyLoadScrollHandler:()=>rw,leftRight:()=>s,load:()=>oc,measureColumnDepth:()=>kh,menuClass:()=>b,modelChanged:()=>pt,movableContent:()=>p,movableHeader:()=>w,nextCellIndex:()=>htt,onEmpty:()=>vi,onResize:()=>rg,open:()=>bi,padZero:()=>lu,pageBegin:()=>fet,pageComplete:()=>ag,pageDown:()=>dtt,pageUp:()=>ktt,pagerRefresh:()=>hw,parents:()=>srt,parentsUntil:()=>i,partialRefresh:()=>de,pdfAggregateQueryCellInfo:()=>ntt,pdfExportComplete:()=>hp,pdfHeaderQueryCellInfo:()=>tn,pdfQueryCellInfo:()=>nn,performComplexDataOperation:()=>pv,prepareColumns:()=>ee,preventBatch:()=>ci,preventFrozenScrollRefresh:()=>stt,printComplete:()=>ay,printGridInit:()=>sn,queryCellInfo:()=>cf,recordAdded:()=>el,recordClick:()=>ng,recordDoubleClick:()=>gd,recursive:()=>ub,refreshAggregateCell:()=>wc,refreshAggregates:()=>rp,refreshComplete:()=>pg,refreshCustomFilterClearBtn:()=>ew,refreshCustomFilterOkBtn:()=>ua,refreshExpandandCollapse:()=>wr,refreshFilteredColsUid:()=>art,refreshFooterRenderer:()=>nu,refreshForeignData:()=>co,refreshFrozenColumns:()=>uw,refreshFrozenHeight:()=>ett,refreshHandlers:()=>to,refreshInfiniteCurrentViewData:()=>ra,refreshInfiniteEditrowindex:()=>va,refreshInfiniteModeBlocks:()=>tw,refreshInfinitePersistSelection:()=>aa,refreshVirtualBlock:()=>es,refreshVirtualCache:()=>as,refreshVirtualEditFormCells:()=>aw,refreshVirtualFrozenHeight:()=>rtt,refreshVirtualFrozenRows:()=>ia,refreshVirtualLazyLoadCache:()=>pa,refreshVirtualMaxPage:()=>oa,registerEventHandlers:()=>bb,removeAddCboxClasses:()=>ho,removeElement:()=>fv,removeEventHandlers:()=>kb,removeInfiniteRows:()=>pl,renderFrozenRows:()=>ry,renderMovable:()=>yh,renderResponsiveCmenu:()=>fa,reorderBegin:()=>het,reorderComplete:()=>np,resetColumns:()=>dl,resetInfiniteBlocks:()=>ll,resetRowIndex:()=>of,resetVirtualFocus:()=>lw,resizeClassList:()=>ur,resizeStart:()=>ig,resizeStop:()=>yy,restoreFocus:()=>tf,row:()=>y,rowCell:()=>a,rowDataBound:()=>ko,rowDeselected:()=>go,rowDeselecting:()=>sy,rowDrag:()=>ld,rowDragAndDrop:()=>ket,rowDragAndDropBegin:()=>cet,rowDragAndDropComplete:()=>tp,rowDragStart:()=>cd,rowDragStartHelper:()=>hd,rowDrop:()=>ad,rowModeChange:()=>ea,rowPositionChanged:()=>pp,rowSelected:()=>af,rowSelecting:()=>hc,rowSelectionBegin:()=>yet,rowSelectionComplete:()=>vg,rowsAdded:()=>kc,rowsRemoved:()=>fs,rtlUpdated:()=>ul,saveComplete:()=>fp,scroll:()=>bc,scrollToEdit:()=>vw,searchBegin:()=>set,searchComplete:()=>gy,selectFreezeRows:()=>uy,selectRowOnContextOpen:()=>sa,selectVirtualRow:()=>wp,setCache:()=>td,setChecked:()=>ef,setColGroup:()=>nd,setColumnIndex:()=>ch,setComplexFieldID:()=>ah,setCssInGridPopUp:()=>fb,setDebounce:()=>id,setDisplayValue:()=>pb,setFormatter:()=>sv,setFreezeSelection:()=>na,setFreezeSelectionAction:()=>yk,setFullScreenDialog:()=>io,setGroupCache:()=>iw,setHeightToFrozenElement:()=>ott,setInfiniteCache:()=>wl,setInfiniteColFrozenHeight:()=>hot,setInfiniteFrozenHeight:()=>sot,setReorderDestinationElement:()=>fw,setRowElements:()=>oe,setRowsInTbody:()=>vb,setStyleAndAttributes:()=>vr,setValidationRuels:()=>ab,setVirtualPageQuery:()=>ds,shiftEnter:()=>rh,shiftTab:()=>aot,showEmptyGrid:()=>cp,sliceElements:()=>vv,sortBegin:()=>eet,sortComplete:()=>yc,splitCells:()=>yft,splitFrozenRowObjectCells:()=>gh,splitReorderedRows:()=>pft,stickyScrollComplete:()=>ytt,summaryIterator:()=>wut,tab:()=>lot,table:()=>k,tbody:()=>e,templateCompiler:()=>ri,textWrapRefresh:()=>fl,toogleCheckbox:()=>hb,toolbarClick:()=>vd,toolbarRefresh:()=>tu,tooltipDestroy:()=>nf,uiUpdate:()=>tt,ungroupBegin:()=>vet,ungroupComplete:()=>ip,upArrow:()=>ro,updateColumnTypeForExportColumns:()=>rb,updateData:()=>pe,updatecloneRow:()=>frt,valCustomPlacement:()=>bn,validateVirtualForm:()=>ha,valueAccessor:()=>tb,virtaulCellFocus:()=>dp,virtaulKeyHandler:()=>eot,virtualScrollAddActionBegin:()=>ys,virtualScrollEdit:()=>nw,virtualScrollEditActionBegin:()=>ls,virtualScrollEditCancel:()=>gp,virtualScrollEditSuccess:()=>no,wrap:()=>li});uc=n(864);const t=ejdashboard.base,u=ejdashboard.data;var fc,wu=function(){function n(n){this.intl=new t.Internationalization;t.isNullOrUndefined(n)||(this.intl.culture=n)}return n.prototype.getFormatFunction=function(n){return n.type?this.intl.getDateFormat(n):this.intl.getNumberFormat(n)},n.prototype.getParserFunction=function(n){return n.type?this.intl.getDateParser(n):this.intl.getNumberParser(n)},n.prototype.fromView=function(n,i,r){return"date"!==r&&"datetime"!==r&&"number"!==r||t.isNullOrUndefined(i)?n:i(n)},n.prototype.toView=function(n,i){var r=n;return t.isNullOrUndefined(i)||t.isNullOrUndefined(n)||(r=i(n)),r},n.prototype.setCulture=function(n){t.isNullOrUndefined(n)||t.setCulture(n)},n}(),fd=(fc=function(n,t){return fc=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},fc(n,t)},function(n,t){function i(){this.constructor=n}fc(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),ec=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},hi=function(){function n(n,i){var r=this,e,f;this.disableHtmlEncode=!0;this.allowSorting=!0;this.allowResizing=!0;this.allowFiltering=!0;this.allowGrouping=!0;this.allowReordering=!0;this.showColumnMenu=!0;this.enableGroupByFormat=!1;this.allowEditing=!0;this.filter={};this.showInColumnChooser=!0;this.edit={};this.allowSearching=!0;this.autoFit=!1;this.sortDirection="Descending";this.getEditTemplate=function(){return r.editTemplateFn};this.getFilterTemplate=function(){return r.filterTemplateFn};t.merge(this,n);this.parent=i;"none"===this.type?this.type=null:this.type&&(this.type="string"==typeof this.type?this.type.toLowerCase():void 0);this.editType&&(this.editType=this.editType.toLowerCase());t.isNullOrUndefined(this.uid)&&(this.uid=tr("grid-column"));e=new wu;(n.format&&(n.format.skeleton||n.format.format&&"string"==typeof n.format.format)&&(this.setFormatter(e.getFormatFunction(t.extend({},n.format))),this.setParser(e.getParserFunction(n.format))),this.toJSON=function(){for(var u,i={},f=["filter","dataSource","headerText","template","headerTemplate","edit","editTemplate","filterTemplate","commandsTemplate","parent"],t=Object.keys(r),n=0;n<t.length;n++)if("columns"===t[parseInt(n.toString(),10)])for(i[t[parseInt(n.toString(),10)]]=[],u=0;u<r[t[parseInt(n.toString(),10)]].length;u++)i[t[parseInt(n.toString(),10)]].push(r[t[parseInt(n.toString(),10)]][parseInt(u.toString(),10)].toJSON());else f.indexOf(t[parseInt(n.toString(),10)])<0&&(i[t[parseInt(n.toString(),10)]]=r[t[parseInt(n.toString(),10)]]);return i},this.field||(this.allowFiltering=!1,this.allowGrouping=!1,this.allowSorting=!1,this.columns&&(this.allowResizing=this.columns.some(function(n){return n.allowResizing}))),this.commands&&!this.textAlign&&(this.textAlign="Right"),(this.template||this.commandsTemplate)&&(this.templateFn=ri(this.template||this.commandsTemplate)),this.headerTemplate&&(this.headerTemplateFn=ri(this.headerTemplate)),!t.isNullOrUndefined(this.filter)&&this.filter.itemTemplate&&(this.fltrTemplateFn=ri(this.filter.itemTemplate)),this.editTemplate&&(this.editTemplateFn=ri(this.editTemplate)),this.filterTemplate&&(this.filterTemplateFn=ri(this.filterTemplate)),this.isForeignColumn()&&(t.isNullOrUndefined(this.editType)||"dropdownedit"===this.editType||"defaultedit"===this.editType)&&(this.editType="dropdownedit",this.edit.params&&this.edit.params.dataSource&&(this.edit.params.ddEditedData=!0),this.edit.params=t.extend({dataSource:this.dataSource,query:new u.Query,fields:{value:this.foreignKeyField||this.field,text:this.foreignKeyValue}},this.edit.params)),this.sortComparer)&&(f=this.sortComparer,this.sortComparer=function(n,t,i,u){var e,o;return("string"==typeof f&&(f=ut(f,window)),"Descending"===r.sortDirection)&&(e=n,n=t,t=e,o=i,i=u,u=o),f(n,t,i,u)});!this.sortComparer&&this.isForeignColumn()&&(this.sortComparer=function(n,t){return n=ut(r.foreignKeyValue,cu(r,{},n)[0]),t=ut(r.foreignKeyValue,cu(r,{},t)[0]),"Descending"===r.sortDirection?u.DataUtil.fnDescending(n,t):u.DataUtil.fnAscending(n,t)})}return n.prototype.getSortDirection=function(){return this.sortDirection},n.prototype.setSortDirection=function(n){this.sortDirection=n},n.prototype.getFreezeTableName=function(){return this.freezeTable},n.prototype.setProperties=function(n){for(var i=Object.keys(n),t=0;t<i.length;t++)this[i[parseInt(t.toString(),10)]]=n[i[parseInt(t.toString(),10)]],this.parent&&this.parent.isReact&&("template"===i[parseInt(t.toString(),10)]?(this.templateFn=ri(n[i[parseInt(t.toString(),10)]]),this.parent.refreshReactColumnTemplateByUid(this.uid,!0)):"headerTemplate"===i[parseInt(t.toString(),10)]?(this.headerTemplateFn=ri(n[i[parseInt(t.toString(),10)]]),this.parent.refreshReactHeaderTemplateByUid(this.uid)):"editTemplate"===i[parseInt(t.toString(),10)]&&(this.editTemplateFn=ri(n[i[parseInt(t.toString(),10)]])))},n.prototype.isForeignColumn=function(){return!(!this.dataSource||!this.foreignKeyValue)},n.prototype.getFormatter=function(){return this.formatFn},n.prototype.setFormatter=function(n){this.formatFn=n},n.prototype.getParser=function(){return this.parserFn},n.prototype.setParser=function(n){this.parserFn=n},n.prototype.getColumnTemplate=function(){return this.templateFn},n.prototype.getHeaderTemplate=function(){return this.headerTemplateFn},n.prototype.getFilterItemTemplate=function(){return this.fltrTemplateFn},n.prototype.getDomSetter=function(){return this.disableHtmlEncode?"textContent":"innerHTML"},n}(),dft=function(){function n(){}return ec([t.Property()],n.prototype,"title",void 0),ec([t.Property()],n.prototype,"type",void 0),ec([t.Property()],n.prototype,"buttonOption",void 0),n}(),ed=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return fd(i,n),ec([t.Property(null)],i.prototype,"columns",void 0),i}(hi),gft=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return fd(t,n),t}(ed);const bt=ejdashboard.popups;var o,at,oy,g,bu,net="create",tet="destroy",oc="load",ko="rowDataBound",cf="queryCellInfo",sc="headerCellInfo",nt="actionBegin",l="actionComplete",lf="actionFailure",ti="dataBound",hc="rowSelecting",af="rowSelected",sy="rowDeselecting",go="rowDeselected",le="cellSelecting",ns="cellSelected",hy="cellDeselecting",cy="cellDeselected",cc="columnSelecting",lc="columnSelected",od="columnDeselecting",sd="columnDeselected",vf="columnDragStart",ku="columnDrag",yf="columnDrop",hd="rowDragStartHelper",cd="rowDragStart",ld="rowDrag",ad="rowDrop",ly="beforePrint",ay="printComplete",ac="detailDataBound",vd="toolbarClick",du="batchAdd",pr="batchCancel",ts="batchDelete",yd="beforeBatchAdd",pd="beforeBatchDelete",wd="beforeBatchSave",bd="beginEdit",kd="cellEdit",dd="cellSave",vc="cellSaved",iet="endAdd",ret="endDelete",uet="endEdit",gd="recordDoubleClick",ng="recordClick",is="beforeDataBound",tg="beforeOpenColumnChooser",vy="beforeOpenAdaptiveDialog",ig="resizeStart",rg="resizing",yy="resizeStop",ug="checkBoxChange",fg="beforeCopy",eg="beforePaste",og="beforeAutoFill",py="filterchoicerequest",wy="filterafteropen",by="filterbeforeopen",sg="filtersearchbegin",hg="commandClick",ky="exportGroupCaption",cg="lazyLoadGroupExpand",lg="lazyLoadGroupCollapse",cr="initial-load",dt="initial-end",ki="data-ready",it="content-ready",tt="ui-update",vi="on-empty",gt="inbound-model-changed",pt="model-changed",rs="colgroup-refresh",yt="header-refreshed",fet="paging-begin",ag="paging-complete",eet="sorting-begin",yc="sorting-complete",oet="filtering-begin",dy="filtering-complete",set="searching-begin",gy="searching-complete",het="reorder-begin",np="reorder-complete",cet="rowdraganddrop-begin",tp="rowdraganddrop-complete",aet="grouping-begin",pc="grouping-complete",vet="ungrouping-begin",ip="ungrouping-complete",uu="group-aggregates",nu="refresh-footer-rendered",wc="refresh-aggregate-cell",rp="refresh-aggregates",yet="rowselecting",vg="rowselected",pet="columnselecting",wet="columnselected",bet="cellselecting",yg="cellselected",pf="beforecellfocused",us="cellfocused",ht="key-pressed",ii="click",v="destroy",di="column-visible-changed",bc="scroll",ae="column-width-changed",wf="column-position-changed",ket="row-drag-and-drop",kc="rows-added",fs="rows-removed",dc="column-drag-stop",bf="header-drop",ve="datasource-modified",pg="refresh-complete",es="refresh-virtual-block",ye="dblclick",tu="toolbar-refresh",up="bulk-save",gu="auto-col",nf="tooltip-destroy",pe="update-data",det="edit-begin",get="edit-complete",not="add-begin",tot="add-complete",fp="save-complete",iot="delete-begin",gc="delete-complete",ci="prevent-batch",os="dialog-destroy",ep="crud-Action",op="add-delete-Action",nl="destroy-form",tl="double-tap",wg="beforeExcelExport",bg="excelExportComplete",kg="excelQueryCellInfo",dg="excelHeaderQueryCellInfo",sp="exportDetailDataBound",gg="beforePdfExport",hp="pdfExportComplete",nn="pdfQueryCellInfo",tn="pdfHeaderQueryCellInfo",rot="access-predicate",rn="contextMenuClick",ei="freezerender",uot="freezerefresh",un="contextMenuOpen",fn="columnMenuClick",en="columnMenuOpen",il="filterOpen",we="filterDialogCreated",yi="filter-menu-close",rl="initForeignKeyColumn",ss="getForeignKeyData",kf="generateQuery",cp="showEmptyGrid",lp="foreignKeyData",on="columnDataStateChange",be="dataStateChange",ap="dataSourceChanged",ul="rtl-updated",vp="beforeFragAppend",ke="frozenHeight",fl="textWrapRefresh",el="recordAdded",hs="cancel-Begin",cs="editNextValCell",ol="hierarchyprint",sl="expandchildgrid",sn="printGrid-Init",yp="export-RowDataBound",hn="export-DataBound",pp="row-position-changed",cn="columnChooserOpened",ln="batchedit-form",an="edit-form",vn="before-batch-cancel",yn="batcheditform-rendered",de="partial-refresh",pn="beforeCustomFilterOpen",wp="select-virtual-Row",hl="columns-prepared",cl="cbox-filter-begin",df="cbox-filter-complete",ge="filter-Prevent",wn="before-filter-cmenu-open",bn="validation-custom-placement",kn="filter-cbox-value",fot="component-rendered",tf="restore-Focus",bp="detail-state-change",kp="detail-indentcell-info",eot="virtaul-key-handler",dp="virtaul-cell-focus",ls="virtual-scroll-edit-action-begin",no="virtual-scroll-edit-success",gp="virtual-scroll-edit-cancel",nw="virtual-scroll-edit",as="refresh-virtual-cache",vs="edit-reset",ys="virtual-scroll-add-action-begin",iu="get-virtual-data",tw="refresh-infinite-mode-blocks",ll="reset-infinite-blocks",ps="infinite-scroll-handler",al="infinite-page-query",vl="infinite-show-hide",yl="append-infinite-content",pl="remove-infinite-rows",wl="set-infinite-cache",ws="infinite-edit-handler",bl="initial-collapse",oot="get-aggregate-query",kl="close-filter-dialog",dn="columnChooserCancelBtnClick",gn="get-filterbar-operator",dl="reset-columns",ntt="pdfAggregateQueryCellInfo",ttt="excelAggregateQueryCellInfo",iw="group-cache",rw="lazy-load-scroll-handler",gl="group-collapse",itt="beforeCheckboxRenderer",to="refreshResizeHandlers",uw="refresh-frozen-columns",fw="set-reorder-destination-element",rtt="refresh-virtual-frozen-height",na="set-freeze-selection",sot="set-infinite-frozen-height",hot="set-infinite-col-frozen-height",ta="before-refresh-on-data-change",utt="immutable-batch-cancel",ia="refresh-virtual-frozenrows",ftt="check-scroll-reset",ett="refresh-frozen-height",ott="set-height-to-frozen-element",stt="prevent-frozen-scroll-refresh",htt="next-cell-index",ra="refresh-infinite-current-view-data",ctt="infinite-crud-cancel",bs="filter-dialog-close",ua="refresh-cutsom-filter-ok-button",ew="refresh-cutsom-filter-clear-button",fa="render-responsive-cmenu",ow="filter-cmenu-select",sw="custom-filter-close",io="set-fullscreen-dialog",wr="refresh-Expand-and-Collapse",ea="row-mode-change",ks="enter-key-handler",oa="refresh-virtual-max-page",ds="set-virtual-page-query",sa="select-row-on-context-open",hw="pager-refresh",ltt="closeinline",att="closebatch",cw="close-edit",lw="reset-virtual-focus",cot="after-content-renderer",aw="refresh-virtual-editform-cells",vw="scroll-to-edit",vtt="before-checkbox-renderer-query",gs="create-virtual-validation-form",ha="validate-virtual-form",ca="destroy-child-grid",ytt="sticky-scroll-complete",la="infinite-group-collapse",aa="refresh-infinite-persist-selection",va="refresh-infinite-editrowindex",nh="after-filter-column-menu-close",ptt="beforeCheckboxfilterRenderer",ya="commandColumnDestroy",wtt="cancelcnfrmDlg",pa="refresh-Virtual-LazyLoad-Cache";!function(n){n[n.Data=0]="Data";n[n.Header=1]="Header";n[n.Summary=2]="Summary";n[n.GroupSummary=3]="GroupSummary";n[n.CaptionSummary=4]="CaptionSummary";n[n.Filter=5]="Filter";n[n.Indent=6]="Indent";n[n.GroupCaption=7]="GroupCaption";n[n.GroupCaptionEmpty=8]="GroupCaptionEmpty";n[n.Expand=9]="Expand";n[n.HeaderIndent=10]="HeaderIndent";n[n.StackedHeader=11]="StackedHeader";n[n.DetailHeader=12]="DetailHeader";n[n.DetailExpand=13]="DetailExpand";n[n.CommandColumn=14]="CommandColumn";n[n.DetailFooterIntent=15]="DetailFooterIntent";n[n.RowDragIcon=16]="RowDragIcon";n[n.RowDragHIcon=17]="RowDragHIcon"}(o||(o={})),function(n){n[n.Header=0]="Header";n[n.Content=1]="Content";n[n.Summary=2]="Summary"}(at||(at={})),function(n){n[n.Add=0]="Add";n[n.Edit=1]="Edit";n[n.Update=2]="Update";n[n.Delete=3]="Delete";n[n.Cancel=4]="Cancel";n[n.Print=5]="Print";n[n.Search=6]="Search";n[n.ColumnChooser=7]="ColumnChooser";n[n.PdfExport=8]="PdfExport";n[n.ExcelExport=9]="ExcelExport";n[n.CsvExport=10]="CsvExport";n[n.WordExport=11]="WordExport"}(oy||(oy={})),function(n){n[n.isEdit=0]="isEdit";n[n.isAdd=1]="isAdd";n[n.isSort=2]="isSort";n[n.isFilter=3]="isFilter"}(g||(g={})),function(n){n[n.isInitial=0]="isInitial";n[n.isSearch=1]="isSearch"}(bu||(bu={}));var th=function(){function n(n,t){this.dataState={isPending:!1,resolver:null,group:[]};this.foreignKeyDataState={isPending:!1,resolver:null};this.parent=n;this.serviceLocator=t;this.initDataManager();this.parent.isDestroyed||"foreignKey"===this.getModuleName()||(this.parent.on(kc,this.addRows,this),this.parent.on(pp,this.reorderRows,this),this.parent.on(fs,this.removeRows,this),this.parent.on(ve,this.initDataManager,this),this.parent.on(v,this.destroy,this),this.parent.on(pe,this.crudActions,this),this.parent.on(op,this.getData,this),this.parent.on(gu,this.refreshFilteredCols,this),this.parent.on(hl,this.refreshFilteredCols,this))}return n.prototype.reorderRows=function(n){this.dataManager.dataSource.json.splice(n.toIndex,0,this.dataManager.dataSource.json.splice(n.fromIndex,1)[0])},n.prototype.getModuleName=function(){return"data"},n.prototype.initDataManager=function(){var n=this.parent;this.dataManager=n.dataSource instanceof u.DataManager?n.dataSource:t.isNullOrUndefined(n.dataSource)?new u.DataManager:new u.DataManager(n.dataSource);!n.isAngular||n.query instanceof u.Query?(this.isQueryInvokedFromData=!0,n.query=n.query instanceof u.Query?n.query:new u.Query):n.setProperties({query:new u.Query},!0)},n.prototype.generateQuery=function(n,i){var r=this.parent.getQuery().clone();if("ExcludeHidden"===this.parent.columnQueryMode)r.select(this.parent.getColumns().filter(function(n){return!(!0!==n.isPrimaryKey&&!1===n.visible||void 0===n.field)}).map(function(n){return n.field}));else if("Schema"===this.parent.columnQueryMode){for(var f=[],e=this.parent.columns,u=0;u<e.length;u++)f.push(e[parseInt(u.toString(),10)].field);r.select(f)}return this.filterQuery(r),this.searchQuery(r),this.aggregateQuery(r),this.sortQuery(r),et(this.parent)?this.virtualGroupPageQuery(r):this.pageQuery(r,n),!t.isNullOrUndefined(i)&&i||this.groupQuery(r),r},n.prototype.aggregateQuery=function(n){for(var f,i,u=this.parent.aggregates,t=0;t<u.length;t++)for(f=u[parseInt(t.toString(),10)],i=0;i<f.columns.length;i++)for(var r=f.columns[parseInt(i.toString(),10)],o=r.type instanceof Array?r.type:[r.type],e=0;e<o.length;e++)n.aggregate(o[parseInt(e.toString(),10)].toLowerCase(),r.field);return n},n.prototype.virtualGroupPageQuery=function(n){if(n.queries.length)for(var t=0;t<n.queries.length;t++)"onPage"===n.queries[parseInt(t.toString(),10)].fn&&n.queries.splice(t,1);return n},n.prototype.pageQuery=function(n,i){var r=this.parent,e={query:n,skipPage:!1},f;if(r.notify(ds,e),e.skipPage)return n;if((r.allowPaging||r.enableVirtualization||r.enableInfiniteScrolling)&&!0!==i){if(r.pageSettings.currentPage=Math.max(1,r.pageSettings.currentPage),r.pageSettings.pageCount<=0&&(r.pageSettings.pageCount=8),r.pageSettings.pageSize<=0&&(r.pageSettings.pageSize=12),n.queries.length)for(f=0;f<n.queries.length;f++)"onPage"===n.queries[parseInt(f.toString(),10)].fn&&n.queries.splice(f,1);!t.isNullOrUndefined(r.infiniteScrollModule)&&r.enableInfiniteScrolling?this.parent.notify(al,n):n.page(r.pageSettings.currentPage,!(r.allowPaging&&r.pagerModule&&r.pagerModule.pagerObj.isAllPage)||r.isManualRefresh||this.dataManager.dataSource.offline||this.dataManager.adaptor instanceof u.RemoteSaveAdaptor?r.pageSettings.pageSize:null)}return n},n.prototype.groupQuery=function(n){var u=this.parent,r,f,e;if(u.allowGrouping&&u.groupSettings.columns.length){this.parent.groupSettings.enableLazyLoading&&n.lazyLoad.push({key:"isLazyLoad",value:this.parent.groupSettings.enableLazyLoading});for(var i=u.groupSettings.columns,t=0,o=i.length;t<o;t++)r=this.getColumnByField(i[parseInt(t.toString(),10)]),r||this.parent.log("initial_action",{moduleName:"group",columnName:i[parseInt(t.toString(),10)]}),f=r.enableGroupByFormat,e=r.format,f?n.group(i[parseInt(t.toString(),10)],this.formatGroupColumn.bind(this),e):n.group(i[parseInt(t.toString(),10)],null)}return n},n.prototype.sortQuery=function(n){var f=this.parent,e,o,i;if((f.allowSorting||f.allowGrouping)&&f.sortSettings.columns.length){for(var r=f.sortSettings.columns,u=[],t=r.length-1;t>-1;t--){if(!(i=this.getColumnByField(r[parseInt(t.toString(),10)].field)))return this.parent.log("initial_action",{moduleName:"sort",columnName:r[parseInt(t.toString(),10)].field}),n;i.setSortDirection(r[parseInt(t.toString(),10)].direction);e=r[parseInt(t.toString(),10)].direction;i.sortComparer&&(this.parent.log("grid_sort_comparer"),e=this.isRemote()?r[parseInt(t.toString(),10)].direction:i.sortComparer.bind(i));-1===f.groupSettings.columns.indexOf(r[parseInt(t.toString(),10)].field)?i.isForeignColumn()||i.sortComparer?n.sortByForeignKey(i.field,e,void 0,r[parseInt(t.toString(),10)].direction.toLowerCase()):n.sortBy(i.field,e):u.push({direction:e,field:i.field})}for(t=0,o=u.length;t<o;t++)"string"==typeof u[parseInt(t.toString(),10)].direction?n.sortBy(u[parseInt(t.toString(),10)].field,u[parseInt(t.toString(),10)].direction):(i=this.getColumnByField(u[parseInt(t.toString(),10)].field),n.sortByForeignKey(u[parseInt(t.toString(),10)].field,u[parseInt(t.toString(),10)].direction,void 0,i.getSortDirection().toLowerCase()))}return n},n.prototype.searchQuery=function(n,t,i){var r=this.parent.searchSettings,f=r.fields.length?r.fields:this.getSearchColumnFieldNames(),o=[],l=!1,s,e,h,c;if(this.parent.searchSettings.key.length)if(l=this.parent.getForeignKeyColumns().some(function(n){return f.indexOf(n.field)>-1}),s=i?t.dataSource.adaptor:this.dataManager.adaptor,l||s.getModuleName&&"ODataV4Adaptor"===s.getModuleName()){for(f=i?[t.foreignKeyValue]:f,e=0;e<f.length;e++)h=i?t:this.getColumnByField(f[parseInt(e.toString(),10)]),h.isForeignColumn()&&!i?o=this.fGeneratePredicate(h,o):o.push(new u.Predicate(f[parseInt(e.toString(),10)],r.operator,r.key,r.ignoreCase,r.ignoreAccent));c=u.Predicate.or(o);c.key=r.key;n.where(c)}else n.search(r.key,f,r.operator,r.ignoreCase,r.ignoreAccent);return n},n.prototype.filterQuery=function(n,i,r){var tt,e=this.parent,s=[],ot=[],st=this.parent.getForeignKeyColumns(),c,h,ft,v,y,g,f,a,p,nt;if(e.allowFiltering&&e.filterSettings.columns.length){for(var it=i||e.filterSettings.columns,ht={},w=0,rt=e.getColumns();w<rt.length;w++)ht[(f=rt[w]).field]=f.filter.type?f.filter.type:e.filterSettings.type;for(var b=[],o=[],k=0,ut=it;k<ut.length;k++)c=(f=ut[k]).isForeignKey?e.getColumnByUid(f.uid):e.getColumnByField(f.field),t.isNullOrUndefined(f.type)&&c&&("date"===c.type||"datetime"===c.type||"dateonly"===c.type)&&(f.type=f.isForeignKey?e.getColumnByUid(f.uid).type:e.getColumnByField(f.field).type),f.isForeignKey?b.push(f):o.push(f);if(o.length){for(h=0,ft=o.length;h<ft;h++)o[parseInt(h.toString(),10)].uid=o[parseInt(h.toString(),10)].uid||this.parent.grabColumnByFieldFromAllCols(o[parseInt(h.toString(),10)].field).uid;for(var l=ru.getPredicate(o),d=0,et=Object.keys(l);d<et.length;d++)v=et[d],s.push(l[""+v])}if(b.length)for(y=0,g=b;y<g.length;y++)if((f=g[y]).uid=f.uid||this.parent.grabColumnByFieldFromAllCols(f.field).uid,a=this.parent.grabColumnByUidFromAllCols(f.uid),a||this.parent.log("initial_action",{moduleName:"filter",columnName:f.field}),a.isForeignColumn()&&lo(f.field,st)&&!r)ot.push(f),a.columnData.length||(tt=!0),s=this.fGeneratePredicate(a,s);else for(l=ru.getPredicate(it),p=0,nt=Object.keys(l);p<nt.length;p++)v=nt[p],s.push(l[""+v]);s.length&&!tt?n.where(u.Predicate.and(s)):this.parent.notify(cp,{})}return n},n.prototype.fGeneratePredicate=function(n,t){var i={};return n&&(this.parent.notify(kf,{predicate:i,column:n}),i.predicate.predicates.length&&t.push(i.predicate)),t},n.prototype.getData=function(n,i){var e=this,u,r,f;if(void 0===n&&(n={requestType:""}),u=this.getKey(n.foreignKeyData&&Object.keys(n.foreignKeyData).length?n.foreignKeyData:this.parent.getPrimaryKeyFieldNames()),this.parent.log("datasource_syntax_mismatch",{dataState:this.parent}),this.parent.dataSource&&"result"in this.parent.dataSource)return this.eventPromise(n,i,u).promise;r=void 0;switch(n.requestType){case"delete":(i=i||this.generateQuery(),1===Object.keys(n.data).length)?r=this.dataManager.remove(u,n.data[0],i.fromTable,i):(f={addedRecords:[],deletedRecords:[],changedRecords:[]},f.deletedRecords=n.data,r=this.dataManager.saveChanges(f,u,i.fromTable,i.requiresCount()));break;case"save":i=i||this.generateQuery();n.index=t.isNullOrUndefined(n.index)?0:n.index;r=this.dataManager.insert(n.data,i.fromTable,i,n.index)}return n.promise=r,!r||Array.isArray(r)||r.hasOwnProperty("deletedRecords")?this.insert(i,n):r.then(function(){return e.insert(i,n)})},n.prototype.insert=function(n,t){return"save"===t.requestType&&this.parent.notify(el,t),this.executeQuery(n)},n.prototype.executeQuery=function(n){var i=this,t;return this.dataManager.ready?(t=new u.Deferred,this.dataManager.ready.then(function(){i.dataManager.executeQuery(n).then(function(n){t.resolve(n)})}).catch(function(n){t.reject(n)}),t.promise):this.dataManager.executeQuery(n)},n.prototype.formatGroupColumn=function(n,i){var f=this.serviceLocator,r=this.getColumnByField(i),u=n;return r.type||(r.type=u.getDay?u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0||u.getMilliseconds()>0?"datetime":"date":typeof n),t.isNullOrUndefined(r.getFormatter())&&sv(f,r),wu.prototype.toView(n,r.getFormatter())},n.prototype.crudActions=function(n){var t=this.generateQuery(),i=null,r="promise",u=this.getKey(n.foreignKeyData&&Object.keys(n.foreignKeyData).length?n.foreignKeyData:this.parent.getPrimaryKeyFieldNames());this.parent.dataSource&&"result"in this.parent.dataSource&&this.eventPromise(n,t,u);"save"===n.requestType&&(i=this.dataManager.update(u,n.data,t.fromTable,t,n.previousData));n[""+r]=i||n[""+r];this.parent.notify(ep,n)},n.prototype.saveChanges=function(n,t,i,r){if(void 0===r&&(r=this.generateQuery()),r.requiresCount(),"result"in this.parent.dataSource){var f=new u.Deferred,e={requestType:"batchsave",changes:n,key:t,query:r,endEdit:f.resolve};return this.setState({isPending:!0,resolver:f.resolve}),this.parent.trigger(ap,e),f.promise}return this.dataManager.saveChanges(n,t,r.fromTable,r,i)},n.prototype.getKey=function(n){if(n&&n.length)return n[0]},n.prototype.isRemote=function(){return!0!==this.dataManager.dataSource.offline&&void 0!==this.dataManager.dataSource.url&&""!==this.dataManager.dataSource.url},n.prototype.addRows=function(n){for(var t=n.records.length;t>0;t--)this.dataManager.dataSource.json.splice(n.toIndex,0,n.records[t-1])},n.prototype.removeRows=function(n){var t=this.dataManager.dataSource.json;this.dataManager.dataSource.json=t.filter(function(t){return-1===n.records.indexOf(t)})},n.prototype.getColumnByField=function(n){var t;return this.parent.columnModel.some(function(i){return t=i,i.field===n})&&t},n.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(kc,this.addRows),this.parent.off(fs,this.removeRows),this.parent.off(ve,this.initDataManager),this.parent.off(v,this.destroy),this.parent.off(pe,this.crudActions),this.parent.off(op,this.getData),this.parent.off(gu,this.refreshFilteredCols),this.parent.off(hl,this.refreshFilteredCols))},n.prototype.getState=function(){return this.dataState},n.prototype.setState=function(n){return this.dataState=n},n.prototype.getForeignKeyDataState=function(){return this.foreignKeyDataState},n.prototype.setForeignKeyDataState=function(n){this.foreignKeyDataState=n},n.prototype.getStateEventArgument=function(n){var r=new u.UrlAdaptor,f=new u.DataManager({url:"",adaptor:new u.UrlAdaptor}),i=r.processQuery(f,n),e=JSON.parse(i.data);return t.extend(e,i.pvtData)},n.prototype.eventPromise=function(n,t,i){var s=this,h=n,r=this.getStateEventArgument(t),o=new u.Deferred,e=new u.Deferred,f;return void 0!==n.requestType&&!1!==this.dataState.isDataChanged?(r.action=n,"save"===n.requestType||"delete"===n.requestType)?(f=n,f.key=i,f.promise=e.promise,f.state=r,this.setState({isPending:!0,resolver:e.resolve}),h.endEdit=e.resolve,h.cancelEdit=e.reject,this.parent.trigger(ap,f),e.promise.then(function(){s.setState({isPending:!0,resolver:o.resolve,group:r.group,aggregates:r.aggregates});"save"===f.requestType&&s.parent.notify(el,f);s.parent.trigger(be,r)}).catch(function(){})):(this.setState({isPending:!0,resolver:o.resolve,group:r.group,aggregates:r.aggregates}),this.parent.trigger(be,r)):(this.setState({}),o.resolve(this.parent.dataSource)),o},n.prototype.getSearchColumnFieldNames=function(){for(var n,r=[],i=0,u=this.parent.getColumns();i<u.length;i++)n=u[i],n.allowSearching&&!t.isNullOrUndefined(n.field)&&r.push(n.field);return r},n.prototype.refreshFilteredCols=function(){this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&art(this.parent,this.parent.filterSettings.columns)},n}(),lr=function(){function n(n,i){t.merge(this,n);this.parent=i}return n.prototype.clone=function(){var i=new n({});return t.merge(i,this),i.cells=this.cells.map(function(n){return n.clone()}),i},n.prototype.setRowValue=function(n){if(this.parent){var t=this.data[this.parent.getPrimaryKeyFieldNames()[0]];this.parent.setRowData(t,n)}},n.prototype.setCellValue=function(n,t){if(this.parent&&this.data[""+n].toString()!==t.toString()){var i=this.parent.getPrimaryKeyFieldNames()[0],r=this.data[""+i];this.parent.setCellValue(r,n,t);this.makechanges(i,this.data)}},n.prototype.makechanges=function(n,t){this.parent&&this.parent.getDataModule().dataManager.update(n,t)},n}(),pi=function(){function n(n){this.isSpanned=!1;this.isRowSpanned=!1;t.merge(this,n)}return n.prototype.clone=function(){var i=new n({});return t.merge(i,this),i},n}(),btt=function(){function n(n,t){this.serviceLocator=n;this.parent=t}return n.prototype.render=function(n,i,r,u){var s,v=this.serviceLocator.getService("cellRendererFactory").getCellRenderer(i.cells[parseInt(r.toString(),10)].cellType||o.Data),f=i.cells[parseInt(r.toString(),10)].cellSpan?i.cells[parseInt(r.toString(),10)].cellSpan:n.colSpan+r<=i.cells.length?n.colSpan:i.cells.length-r,c=n.rowSpan,h=0,a,e;if(i.index>0){var l=this.parent.isFrozenGrid()?this.parent.contentModule.tempFreezeRows:this.parent.getRowsObject(),y=this.parent.groupSettings.columns.length>0&&!l[i.index-1].isDataRow?l[i.index].cells:l[i.index-1].cells,p=i.cells[parseInt(r.toString(),10)];s=y.filter(function(n){return n.column.uid===p.column.uid})[0]}for(a=s&&s.colSpanRange>1&&s.rowSpanRange>1?s.colSpanRange:f,e=r+1;e<r+a&&e<i.cells.length;e++)!1===i.cells[parseInt(e.toString(),10)].visible?h++:i.cells[parseInt(e.toString(),10)].isSpanned=!0;if(h>0){for(e=r+f;e<r+f+h&&e<i.cells.length;e++)i.cells[parseInt(e.toString(),10)].isSpanned=!0;r+f+h>=i.cells.length&&(f-=r+f+h-i.cells.length)}return i.cells[parseInt(r.toString(),10)].cellSpan&&(i.data[n.column.field]=i.cells[parseInt(r.toString(),10)].spanText,u=v.render(i.cells[parseInt(r.toString(),10)],i.data,{index:t.isNullOrUndefined(i.index)?"":i.index.toString()})),f>1&&t.attributes(u,{colSpan:f.toString(),"aria-colSpan":f.toString()}),c>1&&(t.attributes(u,{rowspan:c.toString(),"aria-rowspan":c.toString()}),i.cells[parseInt(r.toString(),10)].isRowSpanned=!0,i.cells[parseInt(r.toString(),10)].rowSpanRange=Number(c),f>1&&(i.cells[parseInt(r.toString(),10)].colSpanRange=Number(f))),i.index>0&&s.rowSpanRange>1&&(i.cells[parseInt(r.toString(),10)].isSpanned=!0,i.cells[parseInt(r.toString(),10)].rowSpanRange=Number(s.rowSpanRange-1),i.cells[parseInt(r.toString(),10)].colSpanRange=s.rowSpanRange>0?s.colSpanRange:1),!this.parent.enableColumnVirtualization||i.cells[parseInt(r.toString(),10)].cellSpan||this.containsKey(n.column.field,n.data[n.column.field])||this.backupMergeCells(n.column.field,n.data[n.column.field],n.colSpan),u},n.prototype.backupMergeCells=function(n,t,i){this.setMergeCells(this.generteKey(n,t),i)},n.prototype.generteKey=function(n,t){return n+"__"+t.toString()},n.prototype.splitKey=function(n){return n.split("__")},n.prototype.containsKey=function(n,t){return this.getMergeCells().hasOwnProperty(this.generteKey(n,t))},n.prototype.getMergeCells=function(){return this.parent.mergeCells},n.prototype.setMergeCells=function(n,t){this.parent.mergeCells[""+n]=t},n.prototype.updateVirtualCells=function(n){for(var i,f,r,e=this.getMergeCells(),u=0,o=Object.keys(e);u<o.length;u++){var s=o[u],a=e[""+s],t=this.splitKey(s),h=this.getIndexFromAllColumns(t[0]),c=this.parent.getColumnIndexesInView(),l=a-(c[0]-h);if(h<c[0]&&l>1)for(i=0,f=n;i<f.length;i++)if(r=f[i],r.data[t[0]].toString()===t[1].toString()){r.cells[0].cellSpan=l;r.cells[0].spanText=t[1];break}}return n},n.prototype.getIndexFromAllColumns=function(n){return uf(this.parent.getVisibleColumns(),function(t,i){if(t.field===n)return i})[0]},n}(),a="e-rowcell",ct="e-gridheader",ot="e-gridcontent",fu="e-gridfooter",st="e-headercontent",p="e-movablecontent",w="e-movableheader",wi="e-frozencontent",fr="e-frozenheader",ft="e-content",k="e-table",y="e-row",rf="e-gridchkbox",ni="e-editedrow",ui="e-addedrow",gf="changedRecords",ar="addedRecords",eu="deletedRecords",s="Left-Right",d="frozen-right",rt="frozen-left",lt="data-colindex",yw="aria-colindex",h="data-rowindex",ne="aria-rowindex",e="tbody",c="colgroup",bi="open",te="change",ie="focus",ih="created",pw="beforeOpen",wa="downArrow",ro="upArrow",ktt="PageUp",dtt="PageDown",ba="enter",rh="shiftEnter",lot="tab",aot="shiftTab",oi=function(){function n(n,t,i){this.isSpan=!1;this.cellType=t;this.serviceLocator=n;this.parent=i;this.element=this.parent.createElement("tr")}return n.prototype.render=function(n,t,i,r,u){return this.refreshRow(n,t,i,r,u)},n.prototype.refresh=function(n,t,i,r,u){var a=this,e,s,l;i&&(n.data=bh({},n.changes),this.refreshMergeCells(n));var f=this.parent.element.querySelector("[data-uid="+n.uid+"]"),h=this.refreshRow(n,t,r,u,null,i),v=[].slice.call(h.cells),y=[].slice.call(f.querySelectorAll(".e-templatecell"));if(this.parent.isReact&&y.length)for(var p=function(n){if(n.template)return setTimeout(function(){a.parent.refreshReactColumnTemplateByUid(n.uid,!0)},0),"break"},o=0,c=t;o<c.length&&"break"!==p(c[o]);o++);for([].slice.call(h.attributes).map(function(n){f.setAttribute(n.name,n.value)}),f.innerHTML="",e=0,s=v;e<s.length;e++)l=s[e],f.appendChild(l)},n.prototype.refreshRow=function(n,i,r,u,f,e){var c=t.isNullOrUndefined(f)?this.element.cloneNode():f,a={data:n.data},v={data:n.data},tt=this.parent.getColumns().filter(function(n){return"checkbox"===n.type&&n.field})[0],it=!1,p,w,l,rt,ft,b,et,g,nt,y,ht,ct;tt&&(it=ut(tt.field,a.data));p=this.parent.getSelectedRowIndexes();n.isDataRow&&(n.isSelected=p.indexOf(n.index)>-1||it);n.isDataRow&&this.parent.isCheckBoxSelection&&"Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(n.isSelected=!0,-1===p.indexOf(n.index)&&p.push(n.index));this.buildAttributeFromRow(c,n);t.attributes(c,t.extend({},r,{}));vr(c,n.attributes);for(var lt=this.serviceLocator.getService("cellRendererFactory"),at=function(i){var u=n.cells[parseInt(i.toString(),10)],p,a,r,w,f,y,h,l,b;u.isSelected=n.isSelected;u.isColumnSelected=u.column.isSelected;p=lt.getCellRenderer(n.cells[parseInt(i.toString(),10)].cellType||o.Data);a={index:t.isNullOrUndefined(n.index)?"":n.index.toString()};n.isExpand&&n.cells[parseInt(i.toString(),10)].cellType===o.DetailExpand&&(a.class=s.parent.isPrinting?"e-detailrowcollapse":"e-detailrowexpand");r=p.render(n.cells[parseInt(i.toString(),10)],n.data,a,n.isExpand,e);n.cells[parseInt(i.toString(),10)].cellType!==o.Filter&&((n.cells[parseInt(i.toString(),10)].cellType===o.Data||n.cells[parseInt(i.toString(),10)].cellType===o.CommandColumn)&&(w=s.parent.parentDetails&&s.parent.parentDetails.parentInstObj&&s.parent.parentDetails.parentInstObj.isReact,(s.parent.isReact&&s.parent.requireTemplateRef||w&&s.parent.parentDetails.parentInstObj.requireTemplateRef)&&u.isTemplate?(f=s,f.parent.renderTemplates(function(){var e=r.getAttribute("aria-label");r.setAttribute("aria-label",r.innerText+e);f.parent.trigger(cf,t.extend(v,{cell:r,column:u.column,colSpan:1,rowSpan:1,foreignKeyData:n.cells[parseInt(i.toString(),10)].foreignKeyData,requestType:f.parent.requestTypeAction}))})):s.parent.trigger(cf,t.extend(v,{cell:r,column:u.column,colSpan:1,rowSpan:1,foreignKeyData:n.cells[parseInt(i.toString(),10)].foreignKeyData,requestType:s.parent.requestTypeAction})),y=!1,n.index>0&&s.isSpan&&(h=s.parent.isFrozenGrid()?s.parent.contentModule.tempFreezeRows:s.parent.getRowsObject(),l=(s.parent.groupSettings.columns.length>0&&!h[n.index-1].isDataRow?h[n.index].cells:h[n.index-1].cells).filter(function(t){return t.column.uid===n.cells[parseInt(i.toString(),10)].column.uid})[0],y=l.isRowSpanned?l.isRowSpanned:l.rowSpanRange>1),(v.colSpan>1||n.cells[parseInt(i.toString(),10)].cellSpan>1||v.rowSpan>1||y)&&(s.isSpan=!0,b=new btt(s.serviceLocator,s.parent),r=b.render(v,n,i,r))),n.cells[parseInt(i.toString(),10)].isSpanned||c.appendChild(r))},s=this,h=0,vt=n.cells.length;h<vt;h++)at(h);if(w={row:c,rowHeight:this.parent.rowHeight},n.isDataRow){if(l=t.extend(a,w),l.isSelectable=!0,rt=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,ft=l.row.querySelectorAll(".e-templatecell"),(this.parent.isReact&&this.parent.requireTemplateRef||rt&&this.parent.parentDetails.parentInstObj.requireTemplateRef)&&ft.length?(b=this,b.parent.renderTemplates(function(){b.parent.trigger(ko,l)})):this.parent.trigger(ko,l),n.isSelectable=l.isSelectable,et=this.parent.isRowDragable(),this.parent.allowPaging&&this.parent.selectionSettings.persistSelection){var ot=this.parent.getPrimaryKeyFieldNames()[0],yt=n.data?n.data[""+ot]:null,st=l.isSelectable?this.parent.partialSelectedRecords:this.parent.disableSelectedRecords;st.some(function(n){return n[""+ot]===yt})||st.push(n.data)}if(!l.isSelectable){this.parent.selectionModule.isPartialSelection=!0;n.isSelected=!1;var k=w.row.querySelectorAll(".e-rowcell.e-gridchkbox"),d=l.row.querySelector(".e-rowdragdrop"),pt=this.parent.groupSettings.columns.length+(d||this.parent.isDetail()?1:0);for(h=0;h<k.length;h++)k[parseInt(h.toString(),10)].firstElementChild.classList.add("e-checkbox-disabled"),k[parseInt(h.toString(),10)].querySelector(".e-frame").classList.remove("e-check");if(n.cells.length)for(h=pt;h<n.cells.length;h++)g=l.row.querySelector('.e-rowcell[data-colindex="'+n.cells[parseInt(h.toString(),10)].index+'"]'),g&&t.removeClass([g],["e-selectionbackground","e-active"]);d&&t.removeClass([d],["e-selectionbackground","e-active"])}(this.parent.childGrid||et||this.parent.detailTemplate)&&(nt=c.querySelectorAll(".e-rowcell:not(.e-hide)")[0],nt&&nt.classList.add("e-detailrowvisible"))}if(this.parent.enableVirtualization&&(a.rowHeight=this.parent.rowHeight),a.rowHeight?c.style.height=a.rowHeight+"px":this.parent.rowHeight&&(c.querySelector(".e-headercell")||c.querySelector(".e-groupcaption"))&&(c.style.height=this.parent.rowHeight+"px"),n.cssClass&&c.classList.add(n.cssClass),n.lazyLoadCssClass&&c.classList.add(n.lazyLoadCssClass),"Vertical"!==this.parent.rowRenderingMode||!this.parent.allowTextWrap||"Header"!==this.parent.textWrapSettings.wrapMode&&"Both"!==this.parent.textWrapSettings.wrapMode||c.classList.add("e-verticalwrap"),(!this.parent.enableColumnVirtualization||0===this.parent.frozenColumns)&&this.parent.aggregates.length&&this.parent.element.scrollHeight>this.parent.height)for(h=0;h<this.parent.aggregates.length;h++)this.parent.aggregates[parseInt(h.toString(),10)].properties.columns[0].footerTemplate&&(y=[].slice.call(c.getElementsByClassName("e-summarycell")),y.length&&(ht=y[y.length-1],t.addClass([ht],["e-lastsummarycell"]),ct=y[0],t.addClass([ct],["e-firstsummarycell"])));return c},n.prototype.refreshMergeCells=function(n){for(var t=0,i=n.cells;t<i.length;t++)i[t].isSpanned=!1;return n},n.prototype.buildAttributeFromRow=function(n,i){var r={},f=h,u=[];i.isDataRow&&u.push(y);i.isAltRow&&u.push("e-altrow");i.isCaptionRow&&u.push("e-groupcaptionrow");i.isAggregateRow&&i.parentUid&&u.push("e-groupfooterrow");t.isNullOrUndefined(i.index)||(r[ne]=i.index+1,r[f]=i.index);i.rowSpan&&(r.rowSpan=i.rowSpan);i.uid&&(r["data-uid"]=i.uid);i.isSelected&&(r["aria-selected"]=!0);!1===i.visible&&u.push("e-hide");r.class=u;vr(n,r)},n}(),er=function(){function n(n){this.parent=n}return n.prototype.generateRows=function(n,t){var u=[],i=this.parent.enableVirtualization&&t?t.startIndex:0,r,f;for(i=this.parent.enableInfiniteScrolling&&t?this.getInfiniteIndex(t):i,this.parent.enableImmutableMode&&t&&t.startIndex&&(i=t.startIndex),r=0,f=Object.keys(n).length;r<f;r++,i++)u[parseInt(r.toString(),10)]=this.generateRow(n[parseInt(r.toString(),10)],i);return u},n.prototype.ensureColumns=function(){var n=[],t;return(this.parent.detailTemplate||this.parent.childGrid)&&(t={},this.parent.notify(kp,t),n.push(this.generateCell(t,null,o.DetailExpand))),this.parent.isRowDragable()&&n.push(this.generateCell({},null,o.RowDragIcon)),n},n.prototype.generateRow=function(n,t,i,r,u,f,e){var o={foreignKeyData:{}},s,h;return o.uid=tr("grid-row"),o.data=n,o.index=t,o.indent=r,o.tIndex=f,o.isDataRow=!0,o.parentGid=u,o.parentUid=e,this.parent.isPrinting&&("All"===this.parent.hierarchyPrintMode?o.isExpand=!0:"Expanded"===this.parent.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[parseInt(t.toString(),10)]&&(o.isExpand=this.parent.expandedRows[parseInt(t.toString(),10)].isExpand)),o.cssClass=i,o.isAltRow=!!this.parent.enableAltRow&&t%2!=0,o.isAltRow=!!this.parent.enableAltRow&&t%2!=0,o.isSelected=this.parent.getSelectedRowIndexes().indexOf(t)>-1,this.refreshForeignKeyRow(o),s=this.ensureColumns(),h=new lr(o,this.parent),h.cells="Right"===this.parent.getFrozenMode()?this.generateCells(o).concat(s):s.concat(this.generateCells(o)),h},n.prototype.refreshForeignKeyRow=function(n){for(var r=this.parent.getForeignKeyColumns(),i=0;i<r.length;i++)t.setValue(r[parseInt(i.toString(),10)].field,cu(r[parseInt(i.toString(),10)],n.data),n.foreignKeyData)},n.prototype.generateCells=function(n){for(var r=this.parent.getColumns(),u=[],i=0;i<r.length;i++)u.push(this.generateCell(r[parseInt(i.toString(),10)],n.uid,t.isNullOrUndefined(r[parseInt(i.toString(),10)].commands)?void 0:o.CommandColumn,null,i,n.foreignKeyData));return u},n.prototype.generateCell=function(n,i,r,u,f,e){var s={visible:n.visible,isDataCell:!t.isNullOrUndefined(n.field||n.template),isTemplate:!t.isNullOrUndefined(n.template),rowID:i,column:n,cellType:t.isNullOrUndefined(r)?o.Data:r,colSpan:u,commands:n.commands,isForeignKey:n.isForeignColumn&&n.isForeignColumn(),foreignKeyData:n.isForeignColumn&&n.isForeignColumn()&&t.getValue(n.field,e)};return(s.isDataCell||"checkbox"===s.column.type||s.commands)&&(s.index=f),new pi(s)},n.prototype.refreshRows=function(n){for(var t=0;t<n.length;t++)this.refreshForeignKeyRow(n[parseInt(t.toString(),10)]),n[parseInt(t.toString(),10)].cells=this.generateCells(n[parseInt(t.toString(),10)]);return n},n.prototype.getInfiniteIndex=function(n){return"infiniteScroll"===n.requestType||"delete"===n.requestType||"add"===n.action?t.isNullOrUndefined(n.startIndex)?n.index:n.startIndex:0},n}(),gtt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uh=function(){function n(n){this.parent=n}return n.prototype.getData=function(){for(var t,u=this,i=[],r=this.parent.aggregates.slice(),n=0;n<r.length;n++)t=r[parseInt(n.toString(),10)].columns.filter(function(n){return!(n.footerTemplate||n.groupFooterTemplate||n.groupCaptionTemplate)||u.columnSelector(n)}),t.length&&i.push({columns:t});return i},n.prototype.columnSelector=function(n){return void 0!==n.footerTemplate},n.prototype.getColumns=function(n,i){var r=[],u;if(!this.parent.detailTemplate&&t.isNullOrUndefined(this.parent.childGrid)||r.push(new hi({})),this.parent.allowGrouping)for(u=0;u<this.parent.groupSettings.columns.length;u++)r.push(new hi({}));return this.parent.isRowDragable()&&!n&&r.push(new hi({})),r.push.apply(r,this.parent.getColumns()),i=i&&!n?i+this.parent.getIndentCount():i,t.isNullOrUndefined(n)?r:r.slice(n,i)},n.prototype.generateRows=function(n,t,i,r,u){if(0===n.length&&(void 0===t||!t.count))return[];for(var s=this.buildSummaryData(n,t),e=[],o=this.getData(),f=0;f<o.length;f++)e.push(this.getGeneratedRow(o[parseInt(f.toString(),10)],s[parseInt(f.toString(),10)],t?t.level:void 0,i,r,t?t.parentUid:void 0,u));return e},n.prototype.getGeneratedRow=function(n,i,r,u,f,e,s){var l=[],a=this.getIndentByLevel(),y=!t.isNullOrUndefined(this.parent.childGrid),p=u?0:this.parent.getIndentCount(),v,h,c;for(this.parent.groupSettings.columns.length&&this.parent.allowRowDragAndDrop?a.push("e-indentcelltop"):this.parent.isRowDragable()&&!u&&(a=["e-indentcelltop"]),v=s||this.getColumns(u,f),h=0;h<v.length;h++)l.push(this.getGeneratedCell(v[parseInt(h.toString(),10)],n,h>=p?this.getCellType():0===h&&this.parent.childGrid?o.DetailFooterIntent:o.Indent,a[parseInt(h.toString(),10)],y));return c=new lr({data:i,attributes:{"class":"e-summaryrow"}}),c.cells=l,c.uid=tr("grid-row"),c.parentUid=e,c.isAggregateRow=!0,c.visible=l.some(function(n){return n.isDataCell&&n.visible}),c},n.prototype.getGeneratedCell=function(n,i,r,u,f){var e=i.columns.filter(function(t){return t.columnName===n.field})[0],o={style:{textAlign:n.textAlign},"e-mappinguid":n.uid,index:n.index},s;return u&&(o.class=u),t.isNullOrUndefined(u)&&f&&(o.class="e-detailindentcelltop"),s={visible:n.visible,isDataCell:!t.isNullOrUndefined(e),isTemplate:e&&!t.isNullOrUndefined(e.footerTemplate||e.groupFooterTemplate||e.groupCaptionTemplate),column:e||{},attributes:o,cellType:r},s.column.headerText=n.headerText,new pi(s)},n.prototype.buildSummaryData=function(n,t){for(var f,r,e=[],o=this.getData(),i={},u=0;u<o.length;u++){for(i={},f=o[parseInt(u.toString(),10)].columns,r=0;r<f.length;r++)i=this.setTemplate(f[parseInt(r.toString(),10)],t&&t.aggregates?t:n,i);e.push(i)}return e},n.prototype.getIndentByLevel=function(){return this.parent.groupSettings.columns.map(function(){return"e-indentcelltop"})},n.prototype.setTemplate=function(n,i,r){var f=n.type,c={},l=n.getFormatter()||function(n){return n},u=i,e;for(f instanceof Array||(f=[n.type]),e=0;e<f.length;e++){var s=n.field+" - "+f[parseInt(e.toString(),10)].toLowerCase(),o=n.columnName,h="Custom"!==f[parseInt(e.toString(),10)]&&u.aggregates&&s in u.aggregates?u.aggregates[""+s]:eb(f[parseInt(e.toString(),10)],u.aggregates?u:i,n,this.parent);r[""+o]=r[""+o]||{};r[""+o][""+s]=h;r[""+o][f[parseInt(e.toString(),10)]]=t.isNullOrUndefined(h)?" ":l(h);u.field&&(r[""+o].field=u.field,r[""+o].key=u.key)}return c.format=n.getFormatter(),n.setTemplate(c),r},n.prototype.getCellType=function(){return o.Summary},n}(),uo=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gtt(t,n),t.prototype.columnSelector=function(n){return void 0!==n.groupFooterTemplate},t.prototype.getIndentByLevel=function(n){return void 0===n&&(n=this.parent.groupSettings.columns.length),this.parent.allowRowDragAndDrop&&this.parent.groupSettings.columns.length&&(n-=1),this.parent.groupSettings.columns.map(function(t,i){return i<=n-1?"":"e-indentcelltop"})},t.prototype.getCellType=function(){return o.GroupSummary},t}(uh),fh=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return gtt(t,n),t.prototype.columnSelector=function(n){return void 0!==n.groupCaptionTemplate},t.prototype.getData=function(){return[n.prototype.getData.call(this).reduce(function(n,t){return n.columns=n.columns.concat(t.columns),n},{columns:[]})]},t.prototype.isEmpty=function(){return 0===(this.getData()[0].columns||[]).length},t.prototype.getCellType=function(){return o.CaptionSummary},t}(uh),vot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),eh=function(n){function i(t){var i=n.call(this,t)||this;return i.rows=[],i.index=0,i.infiniteChildCount=0,i.renderInfiniteAgg=!0,i.parent=t,i.summaryModelGen=new uo(t),i.captionModelGen=new fh(t),i}return vot(i,n),i.prototype.generateRows=function(t,i){if(0===this.parent.groupSettings.columns.length)return n.prototype.generateRows.call(this,t,i);this.isInfiniteScroll="infiniteScroll"===i.requestType;this.rows=[];this.index=this.parent.enableVirtualization||this.isInfiniteScroll?i.startIndex:0;for(var r=0,u=t.length;r<u;r++)this.infiniteChildCount=0,this.renderInfiniteAgg=!0,this.getGroupedRecords(0,t[parseInt(r.toString(),10)],t.level,r,void 0,this.rows.length);return this.index=0,this.parent.isCollapseStateEnabled()&&this.ensureRowVisibility(),this.rows},i.prototype.getGroupedRecords=function(n,i,r,u,f,e,o){var v,p=r,l,y,c,s,a,h;if(t.isNullOrUndefined(i.items))if(t.isNullOrUndefined(i.GroupGuid))this.rows=this.rows.concat(this.generateDataRows(i,n,u,this.rows.length,o));else for(l=0,y=i.length;l<y;l++)this.getGroupedRecords(n,i[parseInt(l.toString(),10)],i.level,u,n,this.rows.length,o);else{if(c=void 0,s=this.generateCaptionRow(i,n,u,f,e,o),this.isInfiniteScroll&&(c=this.getPreCaption(n,s.data.key)),c?s.uid=c.uid:this.rows=this.rows.concat(s),i.items&&i.items.length&&this.getGroupedRecords(n+1,i.items,i.items.level,u,n+1,this.rows.length,s.uid),this.parent.aggregates.length&&this.isRenderAggregate(s))for(a=this.rows.length,(v=this.rows).push.apply(v,this.summaryModelGen.generateRows(i,{level:p,parentUid:s.uid})),h=a-1;h>=0;h--)if(this.rows[parseInt(h.toString(),10)].isCaptionRow)this.rows[parseInt(h.toString(),10)].aggregatesCount=this.rows.length-a;else if(!this.rows[parseInt(h.toString(),10)].isCaptionRow&&!this.rows[parseInt(h.toString(),10)].isDataRow)break;c&&this.setInfiniteRowVisibility(c)}},i.prototype.isRenderAggregate=function(n){return this.parent.enableInfiniteScrolling?!!this.renderInfiniteAgg&&(this.getPreCaption(n.indent,n.data.key),this.renderInfiniteAgg=n.data.count===this.infiniteChildCount,this.renderInfiniteAgg):!this.parent.enableInfiniteScrolling},i.prototype.getPreCaption=function(n,t){var u,r=this.parent.getRowsObject().concat(this.rows),i;for(this.infiniteChildCount=0,i=r.length;i--&&(r[parseInt(i.toString(),10)].isCaptionRow&&r[parseInt(i.toString(),10)].indent===n&&r[parseInt(i.toString(),10)].data.key===t&&(u=r[parseInt(i.toString(),10)]),!(r[parseInt(i.toString(),10)].indent===n||r[parseInt(i.toString(),10)].indent<n));)r[parseInt(i.toString(),10)].indent===n+1&&this.infiniteChildCount++;return u},i.prototype.getCaptionRowCells=function(n,i,r){var f=[],u=[],h=this.parent.getColumnByField(n),p=this.parent.getColumnIndexesInView(),c,s,l,e,a,v,y;if(this.parent.enableColumnVirtualization&&(h=this.parent.columns.filter(function(t){return t.field===n})[0]),c=this.parent.groupSettings.columns.length,s=this.parent,!this.parent.enableColumnVirtualization||-1!==p.indexOf(i)){for(l=0;l<i;l++)f.push(this.generateIndentCell());f.push(this.generateCell({},null,o.Expand))}(i=this.parent.enableColumnVirtualization?1:this.parent.getVisibleColumns().length+c+(s.detailTemplate||s.childGrid?1:0)-i+(this.parent.getVisibleColumns().length?-1:0),this.parent.aggregates.length&&!this.captionModelGen.isEmpty())&&(e=this.captionModelGen.generateRows(r)[0],t.extend(r,e.data),a=0,e.cells.some(function(n,t){return a=t,n.visible&&n.isDataCell}),u=e.cells.slice(a).filter(function(n){return n.visible}),e.visible&&u[0].column.field===this.parent.getVisibleColumns()[0].field&&(u=u.slice(1)),1===this.parent.getVisibleColumns().length&&(u=[]),i-=u.length);for(var k=this.parent.enableColumnVirtualization?this.parent.getColumns():[h],w=!0,b=0;b<k.length;b++)v=w&&-1!==p.indexOf(i),v&&(w=!1),y=!this.parent.enableColumnVirtualization||v?o.GroupCaption:o.GroupCaptionEmpty,i=this.parent.enableColumnVirtualization&&y===o.GroupCaption?i+c:i,s.isRowDragable()&&i++,f.push(this.generateCell(h,null,y,i));return f.push.apply(f,u),f},i.prototype.generateCaptionRow=function(n,i,r,u,f,e){var o={},h="records",c=this.parent.getColumnByField(n.field),s;return o.data=t.extend({},n),c&&(o.data.field=n.field),o.isDataRow=!1,o.isExpand=!this.parent.groupSettings.enableLazyLoading&&!this.parent.isCollapseStateEnabled(),o.parentGid=r,o.childGid=u,o.tIndex=f,o.isCaptionRow=!0,o.parentUid=e,o.gSummary=t.isNullOrUndefined(n.items[""+h])?n.items.length:n.items[""+h].length,o.uid=tr("grid-row"),s=new lr(o),s.indent=i,this.getForeignKeyData(s),s.cells=this.getCaptionRowCells(n.field,i,s.data),s},i.prototype.getForeignKeyData=function(n){var r=n.data,i=this.parent.getColumnByField(r.field),u;i&&i.isForeignColumn&&i.isForeignColumn()&&(u=t.isNullOrUndefined(r.key)?"":i.valueAccessor(i.foreignKeyValue,cu(i,{},r.key)[0],i),t.setValue("foreignKey",u,n.data))},i.prototype.generateDataRows=function(n,t,i,r,u){for(var o,e=[],s=this.parent.getColumnIndexesInView(),f=0,h=n.length;f<h;f++,r++){for(e[parseInt(f.toString(),10)]=this.generateRow(n[parseInt(f.toString(),10)],this.index,f?void 0:"e-firstchildrow",t,i,r,u),o=0;o<t;o++)this.parent.enableColumnVirtualization&&-1===s.indexOf(t)||e[parseInt(f.toString(),10)].cells.unshift(this.generateIndentCell());this.index++}return e},i.prototype.generateIndentCell=function(){return this.generateCell({},null,o.Indent)},i.prototype.refreshRows=function(n){for(var i,u,r=this.parent.getColumnIndexesInView(),t=0;t<n.length;t++)if(n[parseInt(t.toString(),10)].isDataRow)for(n[parseInt(t.toString(),10)].cells=this.generateCells(n[parseInt(t.toString(),10)]),i=0;i<n[parseInt(t.toString(),10)].indent;i++)this.parent.enableColumnVirtualization&&-1===r.indexOf(n[parseInt(t.toString(),10)].indent)||n[parseInt(t.toString(),10)].cells.unshift(this.generateIndentCell());else u=this.generateCaptionRow(n[parseInt(t.toString(),10)].data,n[parseInt(t.toString(),10)].indent),n[parseInt(t.toString(),10)].cells=u.cells;return n},i.prototype.setInfiniteRowVisibility=function(n){var i,r,t;if(!n.isExpand||!1===n.visible)for(i=0,r=this.rows;i<r.length;i++)t=r[i],t.parentUid===n.uid&&(t.visible=!1,t.isCaptionRow&&this.setInfiniteRowVisibility(t))},i.prototype.ensureRowVisibility=function(){for(var i,t,r,n=0;n<this.rows.length;n++)if(i=this.rows[parseInt(n.toString(),10)],i.isCaptionRow)for(t=n+1;t<this.rows.length;t++)r=this.rows[parseInt(t.toString(),10)],i.uid===r.parentUid&&(this.rows[parseInt(t.toString(),10)].visible=i.isExpand)},i}(er),fo=function(){function n(n,i){var r=this;this.rows=[];this.freezeRows=[];this.movableRows=[];this.freezeRowElements=[];this.currentInfo={};this.prevCurrentView=[];this.isLoaded=!0;this.viewColIndexes=[];this.drop=function(n){r.parent.notify(yf,{target:n.target,droppedElement:n.droppedElement});t.remove(n.droppedElement)};this.infiniteCache={};this.isRemove=!1;this.visibleRows=[];this.visibleFrozenRows=[];this.rightFreezeRows=[];this.isAddRows=!1;this.isInfiniteFreeze=!1;this.useGroupCache=!1;this.tempFreezeRows=[];this.rafCallback=function(n){var t=n;return function(){var o,h,c,u,i,a,v,p,e,w,f,b;if(r.parent.isFrozenGrid()&&(r.parent.enableVirtualization||r.parent.enableInfiniteScrolling)&&(o=n.tableName,(r.isLoaded=r.parent.getFrozenMode()===s?"frozen-right"===o:"movable"===o,r.parent.enableColumnVirtualization&&"virtualscroll"===n.requestType&&r.isLoaded)&&(h=[].slice.call(r.parent.getMovableVirtualHeader().getElementsByClassName(y)),c=[].slice.call(r.parent.getFrozenVirtualHeader().getElementsByClassName(y)),r.isLoaded=h.length===c.length)),r.ariaService.setBusy(r.getPanel().querySelector("."+ft),!1),!r.parent.isDestroyed){if(u=r.rows.slice(0),r.parent.enableInfiniteScrolling){if(r.parent.groupSettings.enableLazyLoading)for(i=0;i<r.visibleRows.length;i++)r.setRowsInLazyGroup(r.visibleRows[parseInt(i.toString(),10)],i);if(u=r.parent.getRowsObject(),a=t.prevPage,r.parent.infiniteScrollSettings.enableCache&&a)for(v=r.parent.infiniteScrollSettings.maxBlocks,u=[],p=parseInt(r.rowElements[0].getAttribute("data-rowindex"),10)+1,e=(i=0,Math.ceil(p/r.parent.pageSettings.pageSize));i<v;i++,e++)r.infiniteCache[parseInt(e.toString(),10)]&&(u=u.concat(r.infiniteCache[parseInt(e.toString(),10)]))}(r.parent.isFrozenGrid()&&(u=n.isFrozen?r.freezeRows:n.renderFrozenRightContent?r.parent.getFrozenRightRowsObject():r.movableRows),r.parent.notify(it,{rows:u,args:t}),r.parent.autoFit&&r.parent.preventAdjustColumns(),r.parent.isInitialLoad||r.parent.focusModule.setFirstFocusableTabIndex(),r.isLoaded)&&(r.parent.isManualRefresh=!1,r.parent.enableInfiniteScrolling&&r.parent.groupSettings.enableLazyLoading&&"sorting"===n.requestType&&(r.parent.infiniteScrollModule.groupCaptionAction=void 0),w=r.parent.parentDetails&&r.parent.parentDetails.parentInstObj&&r.parent.parentDetails.parentInstObj.isReact,(r.parent.isReact||w)&&r.parent.element.querySelectorAll(".e-templatecell").length?(f=r,f.parent.renderTemplates(function(){f.parent.trigger(ti,{},function(){f.parent.allowTextWrap&&f.parent.notify(ei,{"case":"textwrap"})})})):r.parent.trigger(ti,{},function(){r.parent.allowTextWrap&&r.parent.notify(ei,{"case":"textwrap"})}),r.parent.allowTextWrap&&"auto"===r.parent.height&&(r.parent.getContentTable().scrollHeight>r.parent.getContent().clientHeight?r.parent.scrollModule.setPadding():r.parent.scrollModule.removePadding()));t&&(b=(t.requestType||"").toLowerCase()+"-complete",r.parent.notify(b,t),"batchsave"===n.requestType&&(n.cancel=!1,r.parent.trigger(l,n)));r.isLoaded&&r.parent.hideSpinner()}}};this.parent=n;this.serviceLocator=i;this.ariaService=this.serviceLocator.getService("ariaService");this.parent.enableDeepCompare=this.parent.getDataModule().isRemote();this.generator=this.getModelGenerator();this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.enableVirtualization||this.parent.groupSettings.enableLazyLoading||this.parent.on(di,this.setVisible,this),this.parent.on(rs,this.colGroupRefresh,this),this.parent.on(tt,this.enableAfterRender,this),this.parent.on(tw,this.refreshContentRows,this),this.parent.on(pf,this.beforeCellFocused,this),this.parent.on(v,this.droppableDestroy,this))}return n.prototype.beforeCellFocused=function(n){this.pressedKey=!n.byKey||"upArrow"!==n.keyArgs.action&&"downArrow"!==n.keyArgs.action?void 0:n.keyArgs.action},n.prototype.renderPanel=function(){var i=this.parent,n=this.parent.element.querySelector("."+ot),t;if(n)return this.ariaService.setOptions(this.parent.element.querySelector("."+ft),{busy:!1}),void this.setPanel(n);n=this.parent.createElement("div",{className:ot});t=this.parent.createElement("div",{className:ft});this.ariaService.setOptions(t,{busy:!1});n.appendChild(t);this.setPanel(n);i.element.appendChild(n)},n.prototype.renderTable=function(){var n=this.getPanel(),i=n.querySelector(".e-virtualtable"),r=n.querySelector(".e-virtualtrack");!this.parent.enableVirtualization||t.isNullOrUndefined(i)||t.isNullOrUndefined(r)||(t.remove(i),t.remove(r));n.appendChild(this.createContentTable("_content_table"));this.setTable(n.querySelector("."+k));this.ariaService.setOptions(this.getTable(),{multiselectable:"Multiple"===this.parent.selectionSettings.type});this.initializeContentDrop();this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont")},n.prototype.createContentTable=function(n){var i=this.getPanel().firstElementChild,r;return this.getTable()&&t.remove(this.getTable()),r=i.querySelector("."+k)?i.querySelector("."+k):this.parent.createElement("table",{className:k,attrs:{cellspacing:"0.25px",role:"grid",id:this.parent.element.id+n}}),this.setColGroup(this.parent.getHeaderTable().querySelector(c).cloneNode(!0)),r.appendChild(this.getColGroup()),r.appendChild(this.parent.createElement(e,{attrs:{role:"rowgroup"}})),i.appendChild(r),i},n.prototype.refreshContentRows=function(n){var r=this,i,lt,at,a,wt,ii,bt,c,ut,dt,ot,gt,st,g,fi,ei,si,ht,hi,ci;if(void 0===n&&(n={}),i=this.parent,0!==i.currentViewData.length){var y=this.currentMovableRows||i.currentViewData,w=this.parent.contentModule,ct=i.isReact&&!t.isNullOrUndefined(i.rowTemplate),l=ct?i.createElement(e,{attrs:{role:"rowgroup"}}):document.createDocumentFragment();this.initialPageRecords||(this.initialPageRecords=t.extend([],y));a=ct?i.createElement(e,{attrs:{role:"rowgroup"}}):document.createDocumentFragment();i.isReact&&i.rowTemplate&&(lt=l,at=a);var o,k,nt,vt=i.getColumns(),ti=i.getFrozenColumns(),b=this.parent.isFrozenGrid(),yt=new oi(this.serviceLocator,null,this.parent),tt=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType;i.notify(ca,{});this.rowElements=[];this.rows=[];this.tempFreezeRows=[];var it,h,u,li=this.getPanel().querySelector("."+wi),ai=this.getPanel().querySelector("."+p),pt=this.getPanel().querySelector("."+ft);if(et(i)&&["sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"].some(function(t){return n.requestType===t})&&this.emptyVcRows(),this.parent.enableVirtualization&&this.parent.isFrozenGrid()?(this.parent.enableColumnVirtualization&&"virtualscroll"===n.requestType&&"X"===n.virtualInfo.sentinelInfo.axis&&(u=this.parent.contentModule.generateRows(y,n),n.renderMovableContent=!0),u=this.parent.contentModule.generateRows(y,n)):(u=this.checkCache(u,n),this.isAddRows||this.useGroupCache||(u=this.generator.generateRows(y,n))),this.setGroupCache(u,n),this.parent.notify(wl,{isInfiniteScroll:tt,modelData:u,args:n}),wt=u[0].cells[0].index,b&&(h=w.setTbody(u,n),it=w.getTbody(h)),ii=this.parent.getFrozenMode()===s&&h===d,("infiniteScroll"!==n.requestType||this.parent.infiniteScrollSettings.enableCache)&&this.parent.registeredTemplate&&this.parent.registeredTemplate.template&&!n.isFrozen&&!ii){for(bt=[],c=0;c<this.parent.registeredTemplate.template.length;c++)for(ut=0;ut<this.parent.registeredTemplate.template[c].rootNodes.length;ut++)t.isNullOrUndefined(this.parent.registeredTemplate.template[c].rootNodes[ut].parentNode)&&bt.push(this.parent.registeredTemplate.template[c]);this.parent.destroyTemplate(["template"],bt)}if((this.parent.isReact||this.parent.isVue)&&("infiniteScroll"!==n.requestType||this.parent.infiniteScrollSettings.enableCache)&&!n.isFrozen&&(dt=[this.parent.isVue?"template":"columnTemplate","rowTemplate","detailTemplate","captionTemplate","commandsTemplate","groupFooterTemplate","groupCaptionTemplate"],"infiniteScroll"===n.requestType&&this.parent.infiniteScrollSettings.enableCache&&(dt=[this.parent.isVue?"template":"columnTemplate","commandsTemplate"]),yo(this.parent,dt)),this.parent.enableColumnVirtualization&&new btt(this.serviceLocator,this.parent).updateVirtualCells(u),b||(this.tbody=this.getTable().querySelector(e)),ot=0,gt=!0,et(i)&&i.vcRows.length&&(st=t.isNullOrUndefined(n.virtualInfo.offsets)?t.isNullOrUndefined(n.scrollTop)?0:n.scrollTop.top:n.virtualInfo.offsets.top,0!==st)){for(var ri=i.vGroupOffsets,ni=i.pageSettings.pageSize/2,ui=Object.keys(ri).map(function(n){return ri[""+n]}),v=0;v<ui.length;v++)if(st<ui[parseInt(v.toString(),10)]){if(t.isNullOrUndefined(n.virtualInfo)||"up"!==n.virtualInfo.direction){ot=v*ni;(this.parent.contentModule.isEndBlock(v)||this.parent.contentModule.isEndBlock(v+1))&&(n.virtualInfo.blockIndexes=[v,v+1]);break}ot=v>0?(v-1)*ni:v*ni;break}Math.round(st+this.contentPanel.firstElementChild.offsetHeight)>=this.contentPanel.firstElementChild.scrollHeight&&!n.rowObject&&(gt=!1)}if(g=i.frozenRows&&!i.isFrozenGrid()&&this.parent.enableVirtualization&&"reorder"===n.requestType,i.frozenRows&&"virtualscroll"===n.requestType&&"X"===n.virtualInfo.sentinelInfo.axis||g){for(fi=n.virtualInfo.blockIndexes,ei=n.virtualInfo.page,n.virtualInfo.blockIndexes=[1,2],g&&(n.virtualInfo.page=1),si=g?this.initialPageRecords:y,ht=this.vgenerator.generateRows(si,n),ht.splice(this.parent.frozenRows),c=0;c<this.parent.frozenRows;c++)ht[parseInt(c.toString(),10)].cells.splice(0,this.parent.getFrozenColumns()),o=yt.render(ht[parseInt(c.toString(),10)],vt),a.appendChild(o);n.virtualInfo.blockIndexes=fi;n.virtualInfo.page=ei;g&&1===n.virtualInfo.page&&u.splice(0,this.parent.frozenRows)}this.virtualFrozenHdrRefresh(a,u,yt,n,y,vt);this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&((this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage]=[]);this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading&&"delete"===n.requestType&&(this.visibleRows=[]);for(var vi=function(r){var v,e,w,k,s,c,p,d,g;if(f.rows.push(u[parseInt(r.toString(),10)]),b&&f.tempFreezeRows.push(u[parseInt(r.toString(),10)]),f.parent.groupSettings.enableLazyLoading&&!f.useGroupCache&&f.parent.groupSettings.columns.length&&((f.parent.enableVirtualization?f.parent.lazyLoadRender:f.parent.contentModule).refRowsObj[f.parent.pageSettings.currentPage].push(u[parseInt(r.toString(),10)]),f.setRowsInLazyGroup(u[parseInt(r.toString(),10)],r),t.isNullOrUndefined(u[parseInt(r.toString(),10)].indent)))return"continue";if(f.setInfiniteVisibleRows(n,u[parseInt(r.toString(),10)],h),et(i)&&n.virtualInfo&&n.virtualInfo.blockIndexes&&f.rowElements.length>=n.virtualInfo.blockIndexes.length*f.parent.contentModule.getBlockSize()&&gt)return f.parent.currentViewData.records=f.rows.map(function(n){return n.data}),"break";if(i.rowTemplate){if(v=i.element.id+"rowTemplate",e=void 0,i.isReact){if(w=i.frozenRows&&r<i.frozenRows,k=t.extend({index:r},y[parseInt(r.toString(),10)]),i.getRowTemplate()(k,i,"rowTemplate",v,null,null,w?a:l),i.requireTemplateRef)return s=f,s.parent.renderTemplates(function(){i.frozenRows&&r<i.frozenRows?o=at.childNodes[parseInt(r.toString(),10)]:nt=lt.childNodes[parseInt(r.toString(),10)];var n={data:u[parseInt(r.toString(),10)].data,row:nt||o};s.parent.trigger(ko,n);(u[parseInt(r.toString(),10)].isDataRow||s.parent.enableVirtualization&&s.parent.groupSettings.enableLazyLoading)&&s.rowElements.push(o);s.ariaService.setOptions(s.getTable(),{colcount:i.getColumns().length.toString()});r===u.length-1&&(lt=null,at=null)}),"continue"}else e=i.getRowTemplate()(t.extend({index:r},y[parseInt(r.toString(),10)]),i,"rowTemplate",v,void 0,void 0,void 0,f.parent.root);if(i.isReact||"TBODY"!==e[0].tagName)i.frozenRows&&r<i.frozenRows?o=i.isReact?a.lastElementChild:kt(a,e):(i.isReact||(o=kt(l,e)),nt=i.isReact?l.lastElementChild:o.lastElementChild);else{for(c=0;c<e.length;c++)p="tr"===e[parseInt(c.toString(),10)].nodeName.toLowerCase(),(p||e[parseInt(c.toString(),10)].querySelectorAll&&e[parseInt(c.toString(),10)].querySelectorAll("tr").length)&&(o=p?e[parseInt(c.toString(),10)]:e[parseInt(c.toString(),10)].querySelector("tr"));i.frozenRows&&r<i.frozenRows?a.appendChild(o):l.appendChild(o)}d={data:u[parseInt(r.toString(),10)].data,row:nt||o};f.parent.trigger(ko,d)}else o=yt.render(u[parseInt(r.toString(),10)],vt),g=f.ensureFrozenHeaderRender(n),i.frozenRows&&r<i.frozenRows&&!tt&&"virtualscroll"!==n.requestType&&g&&f.ensureVirtualFrozenHeaderRender(n)?a.appendChild(o):l.appendChild(o),u[parseInt(r.toString(),10)].isExpand&&i.notify(sl,o.cells[i.groupSettings.columns.length]);(u[parseInt(r.toString(),10)].isDataRow||f.parent.enableVirtualization&&f.parent.groupSettings.enableLazyLoading)&&f.rowElements.push(o);f.ariaService.setOptions(f.getTable(),{colcount:i.getColumns().length.toString()})},f=this,yi=(c=ot,u.length);c<yi&&"break"!==vi(c);c++);hi=i.parentDetails&&i.parentDetails.parentInstObj&&i.parentDetails.parentInstObj.isReact;(!i.isReact&&!hi||i.requireTemplateRef||i.renderTemplates(),this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading&&(this.parent.contentModule.refRowsObj[this.parent.pageSettings.currentPage]=this.parent.contentModule.groupCache[this.parent.pageSettings.currentPage]),this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&this.parent.notify(wr,{rows:(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).refRowsObj[this.parent.pageSettings.currentPage]}),b&&w.splitRows(h),i.removeMaskRow(),this.parent.notify("removeGanttShimmer",{requestType:"hideShimmer"}),i.frozenRows&&"virtualscroll"!==n.requestType&&!tt&&this.ensureVirtualFrozenHeaderRender(n)||"virtualscroll"===n.requestType&&n.virtualInfo.sentinelInfo&&"X"===n.virtualInfo.sentinelInfo.axis)&&((k=b?w.getFrozenHeader(h):i.getHeaderTable().querySelector(e),ct)?(ci=k.parentElement,t.remove(k),ci.appendChild(a)):(k.innerHTML="",k.appendChild(a)));!i.enableVirtualization&&i.frozenRows&&0===wt&&pt.offsetHeight===Number(i.height)&&(pt.style.height=pt.offsetHeight-k.offsetHeight+"px");n.rows=this.rows.slice(0);b&&w.setIsFrozen(n,h);this.index=wt;ib(function(){var u,f;r.parent.notify(vp,n);u=r.parent.enableVirtualization&&r.parent.isFrozenGrid();(r.parent.enableVirtualization||tt||(r.parent.isFrozenGrid()?(t.remove(w.getTbody(h)),it=r.parent.createElement(e,{attrs:{role:"rowgroup"}})):(i.isReact||(r.tbody.innerHTML=""),t.isNullOrUndefined(r.tbody.parentElement)?t.remove(i.getContentTable().querySelector(e)):t.remove(r.tbody),r.tbody=r.parent.createElement(e,{attrs:{role:"rowgroup"}}))),!b||u||r.parent.enableInfiniteScrolling)?(i.rowTemplate&&t.updateBlazorTemplate(i.element.id+"rowTemplate","RowTemplate",i),u)?(n.renderFrozenRightContent?(f=i.getContent().querySelector(".e-frozen-right-content").querySelector(e),r.appendContent(f,l,n)):n.renderMovableContent?(r.appendContent(ai.querySelector(e),l,n),n.renderMovableContent=!1):r.appendContent(li.querySelector(e),l,n),r.parent.getFrozenColumns()||w.renderNextFrozentPart(n,h)):!t.isNullOrUndefined(r.parent.infiniteScrollModule)&&r.parent.enableInfiniteScrolling?(r.isAddRows=!1,r.parent.notify(pl,{args:n}),r.parent.notify(yl,{tbody:it||r.tbody,frag:l,args:n,rows:r.rows,rowElements:r.rowElements,visibleRows:r.visibleRows,tableName:h}),!ti&&b&&((i.getFrozenMode()===s||h!==rt&&h!==d)&&(i.getFrozenMode()!==s||h!==rt&&"movable"!==h)||r.refreshContentRows(t.extend({},n)))):(r.useGroupCache=!1,r.appendContent(r.tbody,l,n)):r.appendContent(it,l,n,h);ti&&w.renderNextFrozentPart(n,h);l=null},this.rafCallback(t.extend({},n)))}},n.prototype.emptyVcRows=function(){this.parent.vcRows=[];this.parent.vRows=[]},n.prototype.appendContent=function(n,i){var u,r,f;if(this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?this.getTable().appendChild(i):(n.appendChild(i),this.getTable().appendChild(n)),"Vertical"===this.parent.rowRenderingMode&&this.parent.allowTextWrap&&("Header"===this.parent.textWrapSettings.wrapMode||"Both"===this.parent.textWrapSettings.wrapMode))for(u=n.querySelectorAll("td"),r=0;r<u.length;r++)f=parseFloat(document.defaultView.getComputedStyle(u[parseInt(r.toString(),10)],"::before").getPropertyValue("height")),f>u[parseInt(r.toString(),10)].offsetHeight&&(u[parseInt(r.toString(),10)].style.height=f+"px",u[parseInt(r.toString(),10)].style.boxSizing="content-box")},n.prototype.setRowsInLazyGroup=function(n,t){this.parent.groupSettings.enableLazyLoading&&!this.useGroupCache&&this.parent.groupSettings.columns.length&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).maintainRows(n,t)},n.prototype.setGroupCache=function(n,t){!this.useGroupCache&&this.parent.groupSettings.enableLazyLoading&&this.parent.notify(iw,{args:t,data:n})},n.prototype.ensureFrozenHeaderRender=function(n){return!(this.parent.enableVirtualization&&("reorder"===n.requestType||"refresh"===n.requestType)||this.parent.infiniteScrollSettings.enableCache&&this.parent.frozenRows&&"delete"===this.parent.infiniteScrollModule.requestType&&1!==this.parent.pageSettings.currentPage)},n.prototype.ensureVirtualFrozenHeaderRender=function(n){return!(this.parent.enableVirtualization&&"delete"===n.requestType)},n.prototype.checkCache=function(n,i){var r,u,f;return this.parent.infiniteScrollSettings.enableCache&&"infiniteScroll"===i.requestType?(r=i.isFrozen?1:0,u=this.parent.isFrozenGrid(),(this.isAddRows=!t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage]),u&&!t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.isAddRows=0!==this.infiniteCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)].length),this.isAddRows)&&(f=u?this.infiniteCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)]:this.infiniteCache[this.parent.pageSettings.currentPage],n=1===this.parent.pageSettings.currentPage?f.slice(this.parent.frozenRows):f),n):this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&("paging"===i.requestType||"columnstate"===i.requestType||"reorder"===i.requestType||"virtualscroll"===i.requestType)&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).getGroupCache()[this.parent.pageSettings.currentPage]?(this.parent.enableVirtualization||(this.useGroupCache=!0),this.parent.enableVirtualization?this.parent.getRowsObject():this.parent.contentModule.initialGroupRows("reorder"===i.requestType)):null},n.prototype.setInfiniteVisibleRows=function(n,t,i){var r=this.parent.isFrozenGrid();this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&(r?i===rt||"Right"===this.parent.getFrozenMode()&&i===d?this.visibleFrozenRows.push(t):"movable"===i?this.visibleRows.push(t):this.rightFreezeRows.push(t):this.parent.infiniteScrollSettings.enableCache||this.visibleRows.push(t))},n.prototype.getCurrentBlockInfiniteRecords=function(n){var t=[],e,u,i;if(this.parent.infiniteScrollSettings.enableCache){if(!Object.keys(this.infiniteCache).length)return[];var s=this.parent.isFrozenGrid(),r=this.parent.getRows(),f=parseInt(r[this.parent.frozenRows].getAttribute(h),10),o=Math.ceil((f+1)/this.parent.pageSettings.pageSize);if(f=parseInt(r[r.length-1].getAttribute(h),10),e=Math.ceil((f+(r.length?1:0))/this.parent.pageSettings.pageSize),s){for(u=n?0:1,i=o;i<=e;i++)t=t.length?t.concat(this.infiniteCache[parseInt(i.toString(),10)][parseInt(u.toString(),10)]):this.infiniteCache[parseInt(i.toString(),10)][parseInt(u.toString(),10)];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1][parseInt(u.toString(),10)].slice(0,this.parent.frozenRows).concat(t))}else{for(i=o;i<=e;i++)t=t.length?t.concat(this.infiniteCache[parseInt(i.toString(),10)]):this.infiniteCache[parseInt(i.toString(),10)];this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(t=this.infiniteCache[1].slice(0,this.parent.frozenRows).concat(t))}}return t},n.prototype.getReorderedVFRows=function(n){return this.parent.contentModule.getReorderedFrozenRows(n)},n.prototype.getReorderedRows=function(n){return this.parent.contentModule.getReorderedFrozenRows(n)},n.prototype.virtualFrozenHdrRefresh=function(n,t,i,r,u,f){var s,e,o;if(this.parent.frozenRows&&this.parent.enableVirtualization&&("reorder"===r.requestType||"refresh"===r.requestType)){for(s=void 0,e=[],this.parent.isFrozenGrid()?(this.currentMovableRows=u,e=this.getReorderedVFRows(r)):e=this.getReorderedRows(r),o=0;o<e.length;o++)s=i.render(e[parseInt(o.toString(),10)],f),n.appendChild(s);1===r.virtualInfo.page&&t.splice(0,this.parent.frozenRows);r.renderMovableContent&&(this.parent.currentViewData=this.currentMovableRows,this.currentMovableRows=null)}},n.prototype.getInfiniteRows=function(){var n=[],r=this.parent.isFrozenGrid(),i,t;if(this.parent.enableInfiniteScrolling)if(this.parent.infiniteScrollSettings.enableCache)for(i=Object.keys(this.infiniteCache),t=0;t<i.length;t++)n=r?n.concat(this.infiniteCache[i[parseInt(t.toString(),10)]][0]):n.concat(this.infiniteCache[i[parseInt(t.toString(),10)]]);else n=r?this.visibleFrozenRows:this.visibleRows;return n},n.prototype.getInfiniteMovableRows=function(){var n=this.getCurrentBlockInfiniteRecords();return this.parent.enableInfiniteScrolling?n.length?n:this.visibleRows:[]},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getTable=function(){return this.contentTable},n.prototype.setTable=function(n){this.contentTable=n},n.prototype.getRows=function(){var n=this.getInfiniteRows();return n.length?n:this.parent.getFrozenColumns()?this.freezeRows:this.rows},n.prototype.getMovableRows=function(){var n=this.getInfiniteMovableRows();return n.length?n:this.movableRows},n.prototype.getRowElements=function(){return this.parent.getFrozenColumns()?this.freezeRowElements:this.rowElements},n.prototype.getMovableRowElements=function(){return this.rowElements},n.prototype.setRowElements=function(n){this.rowElements=n},n.prototype.getColGroup=function(){return this.colgroup},n.prototype.setColGroup=function(n){return t.isNullOrUndefined(n)||(n.id="content-"+n.id),this.colgroup=n},n.prototype.setVisible=function(n){var l,i=this.parent,k=this.parent.isFrozenGrid(),st=i.getFrozenColumns(),g=[],u,e,ft,v,y,w,et,ot;if(k){var it=this.freezeRows,rt=this.movableRows,ht=it.length,ut=void 0,a=[];for(i.getFrozenMode()===s&&(a=i.getFrozenRightRowsObject()),u=0,e=void 0;u<ht;u++){for(ut=rt[parseInt(u.toString(),10)].cells.length,ft=a.length?a[parseInt(u.toString(),10)].cells.length:0,e=it[parseInt(u.toString(),10)].clone(),v=0;v<ut;v++)e.cells.push(rt[parseInt(u.toString(),10)].cells[parseInt(v.toString(),10)]);for(y=0;y<ft;y++)e.cells.push(a[parseInt(u.toString(),10)].cells[parseInt(y.toString(),10)]);g.push(e)}}else g=this.getRows();g.some(function(n){return n.isDataRow&&(l=n),n.isDataRow});w=!0;!i.groupSettings.columns.length&&l&&(w=!1);for(var b=i.getDataRows(),o=this.infiniteRowVisibility()||this.rows.filter(function(n){return!n.isDetailRow}),nt=0,ct=n.length;nt<ct;nt++){var f=n[parseInt(nt.toString(),10)],r=this.parent.getNormalizedColumnIndex(f.uid),tt=this.parent.getColumnIndexByUid(f.uid),h=!0===f.visible?"":"none";-1!==r&&l&&r<l.cells.length&&(k?"movable"!==f.getFreezeTableName()?f.getFreezeTableName()===d?(tt=r-=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount(),et=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(c),t.setStyleAttribute(et.childNodes[parseInt(r.toString(),10)],{display:h}),o=i.getFrozenRightRowsObject(),b=i.getFrozenRightDataRows()):(t.setStyleAttribute(this.getColGroup().childNodes[parseInt(r.toString(),10)],{display:h}),o=this.infiniteRowVisibility(!0)||this.freezeRows,b=i.getDataRows()):(ot=i.getContent().querySelector("."+p).querySelector(c),tt=r=r-st-this.parent.getFrozenLeftColumnsCount(),t.setStyleAttribute(ot.childNodes[parseInt(r.toString(),10)],{display:h}),b=i.getMovableDataRows(),o=this.infiniteRowVisibility()||this.movableRows):t.setStyleAttribute(this.getColGroup().childNodes[parseInt(r.toString(),10)],{display:h}));w||(this.setDisplayNone(b,tt,h,o),k&&this.parent.notify(ei,{"case":"refreshHeight",isModeChg:!0}));!this.parent.invokedFromMedia&&f.hideAtMedia&&this.parent.updateMediaColumns(f);this.parent.invokedFromMedia=!1}w?this.refreshContentRows({requestType:"refresh"}):this.parent.getFrozenColumns()?(this.parent.notify(de,{rows:this.freezeRows,args:{isFrozen:!0,rows:this.freezeRows}}),this.parent.notify(de,{rows:this.movableRows,args:{isFrozen:!1,rows:this.movableRows}})):this.parent.notify(de,{rows:o,args:{}})},n.prototype.setDisplayNone=function(n,t,i,r){pb(n,t,i,r,this.parent,this.parent.isRowDragable());this.parent.notify(vl,{visible:i,index:t,isFreeze:this.isInfiniteFreeze})},n.prototype.infiniteRowVisibility=function(n){var t;return this.parent.enableInfiniteScrolling&&(this.isInfiniteFreeze=n,t=this.parent.infiniteScrollSettings.enableCache?n?this.getCurrentBlockInfiniteRecords(!0):this.getCurrentBlockInfiniteRecords():n?this.visibleFrozenRows:this.visibleRows),t},n.prototype.colGroupRefresh=function(){if(this.getColGroup()){var n;n=this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()?this.parent.getMovableVirtualHeader().querySelector(c+":not(.e-masked-colgroup)").cloneNode(!0):this.getHeaderColGroup();this.getTable().replaceChild(n,this.getColGroup());this.setColGroup(n)}},n.prototype.getHeaderColGroup=function(){return this.parent.element.querySelector("."+ct).querySelector(c+":not(.e-masked-colgroup)").cloneNode(!0)},n.prototype.initializeContentDrop=function(){var n=this.parent;this.droppable=new t.Droppable(n.element,{accept:".e-dragclone",drop:this.drop})},n.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy()},n.prototype.canSkip=function(n,i,r){return t.isNullOrUndefined(i)||t.isNullOrUndefined(n.visible)||i.cells[parseInt(r.toString(),10)].visible===n.visible},n.prototype.getModelGenerator=function(){return this.generator=this.parent.allowGrouping?new eh(this.parent):new er(this.parent)},n.prototype.renderEmpty=function(n){this.getTable().appendChild(n);this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(e).innerHTML="")},n.prototype.setSelection=function(n,t,i){var o,s,u,f,r,h,e;if(this.parent.notify(na,{uid:n,set:t,clearAll:i}),o=this.parent.isFrozenGrid(),!o||!this.parent.enableVirtualization){if(o)for(s=this.getMovableRows().filter(function(t){return i||n===t.uid}),u=0;u<s.length;u++)s[parseInt(u.toString(),10)].isSelected=t;for(f=this.getRows().filter(function(t){return i||n===t.uid}),r=0;r<f.length;r++)for(f[parseInt(r.toString(),10)].isSelected=t,h=f[parseInt(r.toString(),10)].cells,e=0;e<h.length;e++)h[parseInt(e.toString(),10)].isSelected=t}},n.prototype.getRowByIndex=function(n){return n=this.getInfiniteRowIndex(n),t.isNullOrUndefined(n)?void 0:this.parent.getDataRows()[parseInt(n.toString(),10)]},n.prototype.getInfiniteRowIndex=function(n){if(this.parent.infiniteScrollSettings.enableCache){var t=this.parent.frozenRows,i=t>n?0:t,r=parseInt(this.parent.getRows()[parseInt(i.toString(),10)].getAttribute(h),10);n=t>n?n:n-r+t}return n},n.prototype.getVirtualRowIndex=function(n){return n},n.prototype.getMovableRowByIndex=function(n){return n=this.getInfiniteRowIndex(n),t.isNullOrUndefined(n)?void 0:this.parent.getMovableDataRows()[parseInt(n.toString(),10)]},n.prototype.enableAfterRender=function(n){"group"===n.module&&n.enable&&(this.generator=this.getModelGenerator())},n.prototype.setRowObjects=function(n){this.rows=n},n.prototype.immutableModeRendering=function(n){var nt=this,f,g,y,i,u,p,s,ut;void 0===n&&(n={});f=this.parent;f.hideSpinner();var o=f.getPrimaryKeyFieldNames()[0],w={},tt={},h=[],it={},c=f.getRowsObject().slice(),b=this.getBatchEditedRecords(o,c),v={},k=0!==Object.keys(b).length;if(f.getContent().querySelector(".e-emptyrow")||"reorder"===n.requestType||this.parent.groupSettings.columns.length)this.refreshContentRows(n);else{if(0===f.currentViewData.length)return;var d={},a=f.createElement(e,{attrs:{role:"rowgroup"}}),r=f.currentViewData,l=[].slice.call(this.getTable().querySelector(e).children);if(this.prevCurrentView.length)if(g=this.prevCurrentView.length,y=r.length,g===y)for(i=0;i<y;i++)"Batch"===this.parent.editSettings.mode&&l[parseInt(i.toString(),10)].classList.contains("e-insertedrow")?(l.splice(i,1),--i):(tt[r[parseInt(i.toString(),10)][""+o]]=w[this.prevCurrentView[parseInt(i.toString(),10)][""+o]]=i,v[parseInt(i.toString(),10)]=r[parseInt(i.toString(),10)][""+o],d[c[parseInt(i.toString(),10)].uid]=l[parseInt(i.toString(),10)],it[parseInt(i.toString(),10)]=this.prevCurrentView[parseInt(i.toString(),10)][""+o]);else{for(i=0;i<y;i++)tt[r[parseInt(i.toString(),10)][""+o]]=i,v[parseInt(i.toString(),10)]=r[parseInt(i.toString(),10)][""+o];for(i=0;i<g;i++)"Batch"===this.parent.editSettings.mode&&l[parseInt(i.toString(),10)].classList.contains("e-insertedrow")?(l.splice(i,1),--i):(d[c[parseInt(i.toString(),10)].uid]=l[parseInt(i.toString(),10)],w[this.prevCurrentView[parseInt(i.toString(),10)][""+o]]=i,it[parseInt(i.toString(),10)]=this.prevCurrentView[parseInt(i.toString(),10)][""+o])}for(i=0;i<r.length;i++)if(u=w[r[parseInt(i.toString(),10)][""+o]],t.isNullOrUndefined(u)){var ft=new oi(this.serviceLocator,null,f),et={startIndex:i},rt=this.generator.generateRows([r[parseInt(i.toString(),10)]],et);h.push(rt[0]);s=ft.render(rt[0],f.getColumns());a.appendChild(s);this.refreshImmutableContent(i,s,h[parseInt(i.toString(),10)])}else{if(p=!1,this.parent.enableDeepCompare&&(p=this.objectEqualityChecker(this.prevCurrentView[parseInt(u.toString(),10)],r[parseInt(i.toString(),10)])),s=d[c[parseInt(u.toString(),10)].uid],h.push(c[parseInt(u.toString(),10)]),this.rowElements[parseInt(u.toString(),10)]&&this.rowElements[parseInt(u.toString(),10)].getAttribute("data-uid")===h[parseInt(i.toString(),10)].uid&&(k&&t.isNullOrUndefined(b[v[parseInt(i.toString(),10)]])||!k&&(p||this.prevCurrentView[parseInt(u.toString(),10)]===r[parseInt(i.toString(),10)]))){u!==i&&this.refreshImmutableContent(i,s,h[parseInt(i.toString(),10)]);a.appendChild(s);continue}(!k||t.isNullOrUndefined(b[v[parseInt(i.toString(),10)]]))&&(this.parent.enableDeepCompare||r[parseInt(i.toString(),10)]===this.prevCurrentView[parseInt(u.toString(),10)])&&(!this.parent.enableDeepCompare||p)||c[parseInt(u.toString(),10)].setRowValue(r[parseInt(i.toString(),10)]);a.appendChild(s);this.refreshImmutableContent(i,s,h[parseInt(i.toString(),10)])}(this.rows=h,this.rowElements=[].slice.call(a.children),t.remove(this.getTable().querySelector(e)),this.getTable().appendChild(a),this.parent.trigger(ti,{},function(){nt.parent.allowTextWrap&&nt.parent.notify(ei,{"case":"textwrap"})}),n)&&(ut=(n.requestType||"").toLowerCase()+"-complete",this.parent.notify(ut,n))}},n.prototype.objectEqualityChecker=function(n,t){for(var r=Object.keys(n),u=!0,i=0;i<r.length;i++)if(!(n[r[parseInt(i.toString(),10)]]===t[r[parseInt(i.toString(),10)]]||n[r[parseInt(i.toString(),10)]]instanceof Date&&t[r[parseInt(i.toString(),10)]]instanceof Date&&n[r[parseInt(i.toString(),10)]].getTime()===t[r[parseInt(i.toString(),10)]].getTime())){u=!1;break}return u},n.prototype.getBatchEditedRecords=function(n,t){var o={},u=this.parent.getBatchChanges(),f=[],r=[],e,i;for(Object.keys(u).length&&(f=u.changedRecords,r=u.addedRecords),e={cancel:!1},this.parent.notify(utt,{rows:t,args:e}),r.length&&("Bottom"===this.parent.editSettings.newRowPosition?t.splice(t.length-1,r.length):e.cancel||t.splice(0,r.length)),i=0;i<f.length;i++)o[f[parseInt(i.toString(),10)][""+n]]=i;return o},n.prototype.refreshImmutableContent=function(n,t,i){i.isAltRow=!!this.parent.enableAltRow&&n%2!=0;i.isAltRow?t.classList.add("e-altrow"):t.classList.remove("e-altrow");i.index=n;i.edit=void 0;i.isDirty=!1;t.setAttribute(h,n.toString());t.setAttribute(ne,(n+1).toString());this.updateCellIndex(t,n)},n.prototype.updateCellIndex=function(n,t){for(var i=0;i<n.cells.length;i++)n.cells[parseInt(i.toString(),10)].setAttribute("index",t.toString())},n}();const fi=ejdashboard.buttons;var ka=function(){function n(n,r){var u=this;this.frzIdx=0;this.notfrzIdx=0;this.isFirstCol=!1;this.isReplaceDragEle=!0;this.helper=function(){var e=u.parent,s=u.draggable.currentStateTarget,h=i(s,"e-headercell"),n,r,f,c,o,l;if(!e.allowReordering&&!e.allowGrouping||!t.isNullOrUndefined(h)&&h.getElementsByClassName("e-checkselectall").length>0||(n=u.parent.createElement("div",{className:"e-cloneproperties e-dragclone e-headerclone"}),r=s.classList.contains("e-headercell")?s:h,!r||!e.allowReordering&&r.classList.contains("e-stackedheadercell")))return!1;if(c=r.offsetHeight,o=r.querySelector(".e-headercelldiv")||r.querySelector(".e-stackedheadercelldiv"),o){if(f=r.querySelector(".e-stackedheadercelldiv")?e.getStackedHeaderColumnByHeaderText(o.innerText.trim(),e.columns):e.getColumnByUid(o.getAttribute("e-mappinguid")),u.column=f,u.column.lockColumn)return!1;n.setAttribute("e-mappinguid",u.column.uid)}return f&&!t.isNullOrUndefined(f.headerTemplate)?t.isNullOrUndefined(f.headerTemplate)?n.innerHTML=f.headerTemplate:(l=e.getColumnIndexByField(f.field),kt(n,f.getHeaderTemplate()(t.extend({index:l},f),e,"headerTemplate"))):n.innerHTML=o?f.headerText:r.firstElementChild.innerHTML,n.style.width=r.offsetWidth+"px",n.style.height=r.offsetHeight+"px",n.style.lineHeight=(c-6).toString()+"px",e.element.appendChild(n),n};this.dragStart=function(n){var t=u.parent;t.element.querySelector(".e-gridpopup").style.display="none";t.notify(vf,{target:u.draggable.currentStateTarget,column:u.column,event:n.event})};this.drag=function(n){var i=u.parent,f=n.target,r,e;if(f){if(r=t.closest(f,".e-grid"),e=u.parent.element.querySelector(".e-cloneproperties"),!(r&&r.getAttribute("id")===i.element.getAttribute("id")||(t.classList(e,["e-notallowedcur"],["e-defaultcur"]),i.allowReordering&&(i.element.querySelector(".e-reorderuparrow").style.display="none",i.element.querySelector(".e-reorderdownarrow").style.display="none"),i.groupSettings.allowReordering)))return;i.notify(ku,{target:n.target,column:u.column,event:n.event})}};this.dragStop=function(n){var f,r=u.parent;r.element.querySelector(".e-gridpopup").style.display="none";(!i(n.target,"e-headercell")&&!i(n.target,"e-groupdroparea")||!r.allowReordering&&i(n.target,"e-headercell")||!n.helper.getAttribute("e-mappinguid")&&i(n.target,"e-groupdroparea"))&&(t.remove(n.helper),f=!0);r.notify(dc,{target:n.target,event:n.event,column:u.column,cancel:f})};this.drop=function(n){var i=u.parent,f=n.droppedElement.getAttribute("e-mappinguid"),r=t.closest(n.target,".e-grid");t.remove(n.droppedElement);(!r||r.getAttribute("id")===i.element.getAttribute("id"))&&(i.allowReordering||i.allowGrouping)&&i.notify(bf,{target:n.target,uid:f,droppedElement:n.droppedElement})};this.parent=n;this.serviceLocator=r;this.ariaService=this.serviceLocator.getService("ariaService");this.widthService=this.serviceLocator.getService("widthService");this.parent.isDestroyed||(this.parent.enableColumnVirtualization||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount()||this.parent.on(di,this.setVisible,this),this.parent.on(wf,this.colPosRefresh,this),this.parent.on(dt,this.renderCustomToolbar,this),"Vertical"===this.parent.rowRenderingMode&&this.parent.on(tt,this.updateCustomResponsiveToolbar,this))}return n.prototype.renderPanel=function(){var n=this.parent.element.querySelector("."+ct),t=null!=n,i;n=t?n:this.parent.createElement("div",{className:"e-gridheader"});i=t?n.querySelector("."+st):this.parent.createElement("div",{className:st});this.toggleStackClass(n);n.appendChild(i);this.setPanel(n);t||this.parent.element.appendChild(n)},n.prototype.renderTable=function(){var n=this.getPanel();n.appendChild(this.createHeaderTable());this.setTable(n.querySelector("."+k));this.parent.getFrozenColumns()||this.parent.getFrozenRightColumnsCount()||this.parent.getFrozenLeftColumnsCount()||(this.initializeHeaderDrag(),this.initializeHeaderDrop());this.parent.notify(yt,{rows:this.rows,args:{isFrozen:this.parent.isFrozenGrid()}})},n.prototype.getPanel=function(){return this.headerPanel},n.prototype.setPanel=function(n){this.headerPanel=n},n.prototype.getTable=function(){return this.headerTable},n.prototype.setTable=function(n){this.headerTable=n},n.prototype.getColGroup=function(){return this.colgroup},n.prototype.setColGroup=function(n){return this.colgroup=n},n.prototype.getRows=function(){return this.getTable().tHead.rows},n.prototype.createHeaderTable=function(){var t=this.createTable(),n=this.getPanel().querySelector("."+st);return n.appendChild(t),n},n.prototype.createHeader=function(n,i){var r,f,s,d,h;void 0===n&&(n=null);r=this.parent;f=r.isFrozenGrid();this.getTable()&&!f&&t.remove(this.getTable());var u=this.parent.createElement("table",{className:k,attrs:{cellspacing:"0.25px",role:"grid"}}),g=i||(r.getFrozenLeftCount()?"frozen-left":"frozen-right"),l=this.createHeaderContent(g),nt=l.thead,a=this.parent.createElement(e,{className:this.parent.frozenRows?"":"e-hide",attrs:{role:"rowgroup"}});this.caption=this.parent.createElement("caption",{innerHTML:this.parent.element.id+"_header_table",className:"e-hide"});for(var v,y=this.parent.createElement(c),w=this.parent.createElement("tr"),b=this.rows=l.rows,o=0,tt=b.length;o<tt;o++)for(s=0,d=b[parseInt(o.toString(),10)].cells.length;s<d;s++)v=this.parent.createElement("td"),w.appendChild(v);return((r.allowFiltering||r.allowSorting||r.allowGrouping)&&u.classList.add("e-sortfilter"),f&&r.allowResizing)&&(h=this.parent.getContent().querySelector("."+p).querySelector("."+k),"movable"!==i||t.isNullOrUndefined(h)||(u.style.width=h.style.width)),this.updateColGroup(y),a.appendChild(w),u.appendChild(this.setColGroup(y)),u.appendChild(nt),u.appendChild(a),u.appendChild(this.caption),this.ariaService.setOptions(u,{colcount:r.getColumns().length.toString()}),u},n.prototype.createTable=function(n){return void 0===n&&(n=null),this.createHeader(n)},n.prototype.createHeaderContent=function(n){var h=this.parent,l=1,r=h.getFrozenMode(),p=h.getColumns(),a=this.parent.createElement("thead",{attrs:{role:"rowgroup"}}),w=this.parent.createElement("tr",{className:"e-columnheader"}),v=new oi(this.serviceLocator,o.Header,h),c,t,i,u,y,f,e;for(v.element=w,t=[],this.colDepth=kh(h.columns),i=0,u=this.colDepth;i<u;i++)t[parseInt(i.toString(),10)]=this.generateRow(i),t[parseInt(i.toString(),10)].cells=[];if("Right"!==r&&(t=this.ensureColumns(t)),t=this.getHeaderCells(t,n),"Right"===r&&(l=0,t=this.ensureColumns(t)),y=this.parent.getFrozenColumns(),this.parent.isRowDragable()&&this.parent.isFrozenGrid()&&t[0].cells[parseInt(l.toString(),10)])if(f=t[0].cells[parseInt(l.toString(),10)].column.getFreezeTableName(),"movable"===n&&this.getStackedLockColsCount.length)for(e=0,u=t.length;e<u;e++)"Right"===r?t[parseInt(e.toString(),10)].cells.pop():t[parseInt(e.toString(),10)].cells.shift();else"movable"===f||r===s&&f===d?"Right"===r?t[0].cells.pop():t[0].cells.shift():y||f!==rt?"Right"===r&&f===d&&(t[0].cells[t[0].cells.length-1].column.freeze="Right"):t[0].cells[0].column.freeze=f===rt?"Left":"Right";for(i=0,u=this.colDepth;i<u;i++)c=v.render(t[parseInt(i.toString(),10)],p),this.parent.rowHeight&&c.querySelector(".e-headercell")&&(c.style.height=this.parent.rowHeight+"px"),a.appendChild(c);return{thead:a,rows:t}},n.prototype.updateColGroup=function(n){var i,f=this.parent.getColumns(),e=this.parent.getColumnIndexesInView(),r,u;if(this.parent.enableColumnVirtualization&&this.parent.getFrozenColumns()&&this.parent.contentModule.isXaxis()&&(f=t.extend([],this.parent.getColumns())).splice(0,this.parent.getFrozenColumns()),n.id=this.parent.element.id+c,this.parent.allowGrouping)for(r=0,u=this.parent.groupSettings.columns.length;r<u;r++)this.parent.enableColumnVirtualization&&-1===e.indexOf(r)||(i=this.parent.createElement("col",{className:"e-group-intent"}),n.appendChild(i));for((this.parent.detailTemplate||this.parent.childGrid)&&(i=this.parent.createElement("col",{className:"e-detail-intent"}),n.appendChild(i)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(i=this.parent.createElement("col",{className:"e-drag-intent"}),n.appendChild(i)),r=0,u=f.length;r<u;r++)i=this.parent.createElement("col"),!1===f[parseInt(r.toString(),10)].visible&&t.setStyleAttribute(i,{display:"none"}),n.appendChild(i);return this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&(i=this.parent.createElement("col",{className:"e-drag-intent"}),n.appendChild(i)),n},n.prototype.ensureColumns=function(n){for(var r,f,u,t=this.parent,e=this.parent.getColumnIndexesInView(),i=0,s=n.length;i<s;i++){if(t.allowGrouping)for(r=0,f=t.groupSettings.columns.length;r<f;r++)this.parent.enableColumnVirtualization&&-1===e.indexOf(r)||n[parseInt(i.toString(),10)].cells.push(this.generateCell({},o.HeaderIndent));(t.detailTemplate||t.childGrid)&&(u={},this.parent.notify(kp,u),n[parseInt(i.toString(),10)].cells.push(this.generateCell(u,o.DetailHeader)));t.isRowDragable()&&n[parseInt(i.toString(),10)].cells.push(this.generateCell({},o.RowDragHIcon))}return n},n.prototype.getHeaderCells=function(n,t){var f=this.parent.getHeaderTable()&&this.parent.getHeaderTable().querySelector("thead"),r=this.parent.enableColumnVirtualization?this.parent.getColumns(this.parent.enablePersistence):this.parent.columns,i,u;if(this.frzIdx=0,this.notfrzIdx=0,this.parent.lockcolPositionCount)for(i=0;i<r.length;i++)this.lockColsRendered=!1,n=this.appendCells(r[parseInt(i.toString(),10)],n,0,0===i,!1,i===r.length-1,f,t,!1);for(i=0,u=r.length;i<u;i++)this.notfrzIdx=0,this.lockColsRendered=!0,n=this.appendCells(r[parseInt(i.toString(),10)],n,0,0===i,!1,i===u-1,f,t,!1);return n},n.prototype.appendCells=function(n,t,i,r,u,f,e,s,h){var v,d=f?h?"e-laststackcell":"e-lastcell":"",l=this.parent.isFrozenGrid(),g=!this.parent.lockcolPositionCount||n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered,nt=!this.parent.lockcolPositionCount||n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered,b=this.parent.getContent().querySelector(".e-movablescrollbar"),a,c,p,k,w;if(l&&b&&this.parent.enableColumnVirtualization&&(v=b.scrollLeft),n.columns){if(this.isFirstCol=!1,a=this.getCellCnt(n,0),a){var y=this.getStackedLockColsCount(n,0),tt=0===this.parent.lockcolPositionCount||!this.lockColsRendered&&0!==y||this.lockColsRendered&&a-y!=0,it=l&&this.ensureStackedFrozen(n.columns,s,!1);(!l&&tt||it)&&t[parseInt(i.toString(),10)].cells.push(new pi({cellType:o.StackedHeader,column:n,colSpan:this.getColSpan(a,y,n.columns,s,l),className:r?"":u?"e-firstcell":""}))}if(this.parent.lockcolPositionCount&&!this.lockColsRendered)for(c=0;c<n.columns.length;c++)t=this.appendCells(n.columns[parseInt(c.toString(),10)],t,i+1,r,0===c,c===n.columns.length-1&&f,e,s,!1);if(this.lockColsRendered)for(c=0,p=n.columns.length;c<p;c++)r=r&&0===c,k=this.isFirstCol=n.columns[parseInt(c.toString(),10)].visible&&!r,w=c===p-1&&f,t=this.appendCells(n.columns[parseInt(c.toString(),10)],t,i+1,r,k&&!w,w,e,s,!0)}else(v&&v>0&&this.parent.contentModule.isXaxis()&&0!==this.parent.inViewIndexes[0]&&"movable"===n.getFreezeTableName()||!l&&g||l&&n.getFreezeTableName()===s&&nt)&&t[parseInt(i.toString(),10)].cells.push(this.generateCell(n,o.Header,this.colDepth-i,(r?"":u?"e-firstcell":"")+d,i,this.parent.getColumnIndexByUid(n.uid))),this.parent.lockcolPositionCount?this.frzIdx+this.notfrzIdx<this.parent.frozenColumns&&(n.lockColumn&&!this.lockColsRendered||!n.lockColumn&&this.lockColsRendered)?this.frzIdx++:this.notfrzIdx++:this.frzIdx++;return t},n.prototype.ensureStackedFrozen=function(n,t,i){for(var u=n.length,r=0;r<u;r++)if(n[parseInt(r.toString(),10)].columns)i=this.ensureStackedFrozen(n[parseInt(r.toString(),10)].columns,t,i);else if(n[parseInt(r.toString(),10)].getFreezeTableName()===t){i=!0;break}return i},n.prototype.getStackedLockColsCount=function(n,t){if(n.columns)for(var i=0;i<n.columns.length;i++)t=this.getStackedLockColsCount(n.columns[parseInt(i.toString(),10)],t);else n.lockColumn&&t++;return t},n.prototype.getColSpan=function(n,t,i,r,u){return u?n=this.getFrozenColSpan(i,r,0):this.parent.lockcolPositionCount&&(n=this.lockColsRendered?n-t:t),n},n.prototype.getFrozenColSpan=function(n,t,i){for(var u=n.length,r=0;r<u;r++)n[parseInt(r.toString(),10)].columns?i=this.getFrozenColSpan(n[parseInt(r.toString(),10)].columns,t,i):n[parseInt(r.toString(),10)].getFreezeTableName()===t&&n[parseInt(r.toString(),10)].visible&&i++;return i},n.prototype.generateRow=function(){return new lr({})},n.prototype.generateCell=function(n,i,r,u,f,e){var o={visible:n.visible,isDataCell:!1,isTemplate:!t.isNullOrUndefined(n.headerTemplate),rowID:"",column:n,cellType:i,rowSpan:r,className:u,index:f,colIndex:e};return(!o.rowSpan||o.rowSpan<2)&&delete o.rowSpan,new pi(o)},n.prototype.setVisible=function(n){for(var o,s,h,r,i,u=this.parent,f=u.getFrozenColumns(),e=0,l=n.length;e<l;e++)o=n[parseInt(e.toString(),10)],(i=u.getNormalizedColumnIndex(o.uid),r=o.visible?"":"none",f)?(s=this.parent.isRowDragable()?f+1:f,i<s?t.setStyleAttribute(this.getColGroup().children[parseInt(i.toString(),10)],{display:r}):(h=u.getHeaderContent().querySelector("."+w).querySelector(c),t.setStyleAttribute(h.children[i-s],{display:r}))):t.setStyleAttribute(this.getColGroup().children[parseInt(i.toString(),10)],{display:r});this.refreshUI()},n.prototype.colPosRefresh=function(){this.refreshUI()},n.prototype.refreshUI=function(){var r=this.parent.isFrozenGrid(),h=this.parent.enableColumnVirtualization&&r,l=this.getPanel(),n,u,e,o,y,f;if(this.toggleStackClass(l),n=this.freezeReorder?this.headerPanel.querySelector("."+w).querySelector("."+k):this.getTable(),u=this.parent.isFrozenGrid()?this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right":void 0,h&&(n=this.parent.contentModule.getVirtualFreezeHeader(),u=this.parent.contentModule.isXaxis()?"movable":u),n){t.remove(n);n.removeChild(n.firstChild);n.removeChild(n.childNodes[0]);e=this.parent.createElement(c);o=this.createHeaderContent(u);this.rows=o.rows;n.insertBefore(o.thead,n.firstChild);this.updateColGroup(e);n.insertBefore(this.setColGroup(e),n.firstChild);h||this.setTable(n);this.appendContent(n);this.parent.notify(rs,{});this.widthService.setWidthToColumns();this.parent.updateDefaultCursor();(!r||this.parent.enableColumnVirtualization&&r)&&this.initializeHeaderDrag();for(var a=[].slice.call(l.querySelectorAll("tr.e-columnheader")),s=0,v=a;s<v.length;s++)y=v[s],f=[].slice.call(y.getElementsByClassName("e-grouptopleftcell")),f.length&&f[f.length-1].classList.add("e-lastgrouptopleftcell");this.parent.notify(yt,{rows:this.rows,args:{isFrozen:r}});this.parent.enableColumnVirtualization&&i(n,w)&&this.parent.notify(yt,{rows:this.rows,args:{isFrozen:!1,isXaxis:!0}});this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&li(a,!0)}},n.prototype.toggleStackClass=function(n){this.parent.columns.some(function(n){return!t.isNullOrUndefined(n.columns)})?n.classList.add("e-stackedheader"):n.classList.remove("e-stackedheader")},n.prototype.appendContent=function(n){this.getPanel().querySelector("."+st).appendChild(n)},n.prototype.getCellCnt=function(n,t){if(n.columns)for(var i=0,r=n.columns.length;i<r;i++)t=this.getCellCnt(n.columns[parseInt(i.toString(),10)],t);else n.visible&&t++;return t},n.prototype.initializeHeaderDrag=function(){var n=this.parent;(this.parent.allowReordering||this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)&&(this.draggable=new t.Draggable(n.getHeaderContent(),{dragTarget:".e-headercell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,abort:".e-rhandler",isReplaceDragEle:this.isReplaceDragEle}),this.parent.on(v,this.droppableDestroy,this))},n.prototype.initializeHeaderDrop=function(){var n=this.parent;this.droppable=new t.Droppable(n.getHeaderContent(),{accept:".e-dragclone",drop:this.drop});this.parent.on(v,this.droppableDestroy,this)},n.prototype.droppableDestroy=function(){this.droppable&&!this.droppable.isDestroyed&&this.droppable.destroy();this.draggable&&!this.draggable.isDestroyed&&this.draggable.destroy()},n.prototype.renderCustomToolbar=function(){var r=this,n=this.parent;if("Vertical"===n.rowRenderingMode&&!n.toolbar&&(n.allowSorting||n.allowFiltering&&"FilterBar"!==n.filterSettings.type)){for(var u=n.createElement("div",{className:"e-res-toolbar e-toolbar"}),f=n.createElement("div",{className:"e-toolbar-items"}),e=n.createElement("div",{className:"e-toolbar-left"}),o=this.parent.allowFiltering&&this.parent.allowSorting?2:1,i=0;i<o;i++){var s=n.createElement("div",{className:"e-toolbar-item e-gridresponsiveicons e-icons e-tbtn-align"}),h=1===o?this.parent.allowSorting?"sort":"filter":1===i?"sort":"filter",t=n.createElement("button",{className:"e-tbar-btn e-control e-btn e-lib e-icon-btn"}),c=n.createElement("span",{className:"e-btn-icon e-res"+h+"-icon e-icons"});t.appendChild(c);new fi.Button({cssClass:this.parent.cssClass?this.parent.cssClass:""}).appendTo(t);t.onclick=function(n){n.target.classList.contains("e-ressort-btn")||n.target.classList.contains("e-ressort-icon")?r.parent.showResponsiveCustomSort():r.parent.showResponsiveCustomFilter()};s.appendChild(t);e.appendChild(s)}f.appendChild(e);u.appendChild(f);n.element.insertBefore(u,this.parent.element.querySelector("."+ct))}else n.enableAdaptiveUI&&!n.toolbar&&n.getContent().classList.add("e-responsive-header")},n.prototype.updateCustomResponsiveToolbar=function(n){var i=this.parent.element.querySelector(".e-responsive-toolbar");"toolbar"===n.module&&(i?t.remove(i):this.renderCustomToolbar())},n}(),si=function(){function n(n,t){this.localizer=t.getService("localization");this.formatter=t.getService("valueFormatter");this.parent=n;this.element=this.parent.createElement("TD",{className:a,attrs:{tabindex:"-1"}});this.rowChkBox=this.parent.createElement("input",{className:"e-checkselect",attrs:{type:"checkbox","aria-label":this.localizer.getConstant("CheckBoxLabel")}})}return n.prototype.getGui=function(){return""},n.prototype.format=function(n,i){return t.isNullOrUndefined(n.format)||("number"===n.type&&isNaN(parseInt(i,10))&&(i=null),i=this.formatter.toView(i,n.getFormatter())),t.isNullOrUndefined(i)?"":i.toString()},n.prototype.evaluate=function(n,i,r,u,f){var o,e,y;if(i.column.template){var s=this.parent.isReact&&"string"!=typeof i.column.template&&i.column.template.prototype&&!i.column.template.prototype.CSPTemplate,h=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,c=["index"],l=bh({},r,((o={})[lp]=f,o.column=i.column,o)),a=this.parent.element.id+i.column.uid,v="isStringTemplate";return s||h?(y={index:u[c[0]]},i.column.getColumnTemplate()(t.extend(y,l),this.parent,"columnTemplate",a,this.parent[""+v],null,n)):e=i.column.getColumnTemplate()(t.extend({index:u[c[0]]},l),this.parent,"template",a,this.parent[""+v],void 0,void 0,this.parent.root),s||h||kt(n,e),this.parent.notify("template-result",{template:e}),e=null,n.setAttribute("aria-label",n.innerText+this.localizer.getConstant("TemplateCell")+this.localizer.getConstant("ColumnHeader")+i.column.headerText),!1}return!0},n.prototype.invokeFormatter=function(n,i,r){return t.isNullOrUndefined(n.formatter)||(i=urt(n.formatter,"getValue")?(new n.formatter).getValue(n,r):"function"==typeof n.formatter?n.formatter(n,r):n.formatter.getValue(n,r)),i},n.prototype.render=function(n,t,i,r,u){return this.refreshCell(n,t,i,u)},n.prototype.refreshTD=function(n,i,r,u){var l="Batch"===this.parent.editSettings.mode&&n.classList.contains("e-editedbatchcell"),s,f,e,h,o,c,a;if(this.parent.isReact)s=n.cellIndex,f=n.parentElement,t.remove(n),e=this.refreshCell(i,r,u,l),this.cloneAttributes(e,n),f.cells.length!==s-1?f.insertBefore(e,f.cells[parseInt(s.toString(),10)]):f.appendChild(e);else for(h=this.refreshCell(i,r,u,l),n.innerHTML="",n.setAttribute("aria-label",h.getAttribute("aria-label")),o=0,c=[].slice.call(h.childNodes);o<c.length;o++)a=c[o],n.appendChild(a)},n.prototype.cloneAttributes=function(n,t){for(var i,r=t.attributes,u=r.length;u--;)i=r[parseInt(u.toString(),10)],n.setAttribute(i.name,i.value)},n.prototype.refreshCell=function(n,i,r,u){var y,c,o=this.element.cloneNode(),f=n.column,h,e,l,a,s,v;return n.isForeignKey&&(c=n.foreignKeyData[0]||((y={})[f.foreignKeyValue]=f.format?null:"",y)),h=this.getGui(),e=n.isForeignKey?this.getValue(f.foreignKeyValue,c,f):this.getValue(f.field,i,f),("date"!==f.type&&"datetime"!==f.type&&"dateonly"!==f.type||t.isNullOrUndefined(e)||(e=new Date(e)),h=(e=this.format(f,e,i)).toString(),"boolean"!==f.type||f.displayAsCheckBox)||(l="true"!==e&&"false"!==e?null:"true"===e?"True":"False",h=l?this.localizer.getConstant(l):h),a=this.invokeFormatter(f,e,i),(h=t.isNullOrUndefined(f.formatter)?h:t.isNullOrUndefined(a)?"":a.toString(),o.setAttribute("aria-label",h+this.localizer.getConstant("ColumnHeader")+n.column.headerText),this.evaluate(o,n,i,r,c,u)&&"checkbox"!==f.type)?this.appendHtml(o,this.parent.sanitize(h),f.getDomSetter?f.getDomSetter():"innerHTML"):"checkbox"===f.type&&(o.classList.add(rf),o.setAttribute("aria-label",this.localizer.getConstant("CheckBoxLabel")),e=!!this.parent.selectionSettings.persistSelection&&"true"===e,s=fi.createCheckBox(this.parent.createElement,!1,{checked:e,label:" "}),this.parent.cssClass&&t.addClass([s],[this.parent.cssClass]),this.rowChkBox.id="checkbox-"+n.rowID,s.insertBefore(this.rowChkBox.cloneNode(),s.firstChild),o.appendChild(s)),("Check"===this.parent.checkAllRows&&this.parent.enableVirtualization&&(n.isSelected=!0),this.setAttributes(o,n,r),"boolean"===f.type&&f.displayAsCheckBox)&&(v=isNaN(parseInt(e.toString(),10))?"true"===e:parseInt(e.toString(),10)>0,s=fi.createCheckBox(this.parent.createElement,!1,{checked:v,label:" "}),o.innerHTML="",o.classList.add("e-gridchkbox-cell"),s.classList.add("e-checkbox-disabled"),this.parent.cssClass&&t.addClass([s],[this.parent.cssClass]),o.appendChild(s),o.setAttribute("aria-label",v+this.localizer.getConstant("ColumnHeader")+n.column.headerText)),o},n.prototype.appendHtml=function(n,t,i){return void 0===i&&(i="innerHTML"),n[""+i]=t,n},n.prototype.setAttributes=function(n,t,i){var r=t.column;this.buildAttributeFromCell(n,t,"checkbox"===r.type);vr(n,i);vr(n,t.attributes);r.customAttributes&&vr(n,r.customAttributes);"Vertical"===this.parent.rowRenderingMode&&vr(n,{"data-cell":r.headerText});r.textAlign&&(n.style.textAlign=r.textAlign);"Clip"===r.clipMode||!r.clipMode&&"Clip"===this.parent.clipMode?n.classList.add("e-gridclip"):"EllipsisWithTooltip"!==r.clipMode&&(r.clipMode||"EllipsisWithTooltip"!==this.parent.clipMode||this.parent.allowTextWrap&&("Content"===this.parent.textWrapSettings.wrapMode||"Both"===this.parent.textWrapSettings.wrapMode))||"checkbox"!==r.type&&n.classList.add("e-ellipsistooltip")},n.prototype.buildAttributeFromCell=function(n,i,r){var u={},e=lt,f=[];i.colSpan&&(u.colSpan=i.colSpan);i.rowSpan&&(u.rowSpan=i.rowSpan);i.isTemplate&&f.push("e-templatecell");i.isSelected&&(f.push.apply(f,["e-selectionbackground","e-active"]),r&&n.querySelector(".e-frame").classList.add("e-check"));i.isColumnSelected&&f.push.apply(f,["e-columnselection"]);i.cellType===o.Header?(u[e]=i.colIndex,u[yw]=i.colIndex+1):t.isNullOrUndefined(i.index)||(u[e]=i.index,u[yw]=i.index+1);i.visible||f.push("e-hide");u.class=f;vr(n,u)},n.prototype.getValue=function(n,t,i){return i.valueAccessor(n,t,i)},n}(),oh=function(){function n(){}return n.prototype.setOptions=function(n,t){for(var r=Object.keys(t),i=0;i<r.length;i++)re(n,ue[r[parseInt(i.toString(),10)]],t[r[parseInt(i.toString(),10)]])},n.prototype.setExpand=function(n,t){re(n,ue.expand,t)},n.prototype.setSort=function(n,t){re(n,ue.sort,t,"boolean"==typeof t)},n.prototype.setBusy=function(n,t){re(n,ue.busy,t);re(n,ue.invalid,null,!0)},n.prototype.setGrabbed=function(n,t,i){re(n,ue.grabbed,t,i)},n.prototype.setDropTarget=function(n,t){re(n,ue.dropeffect,"copy",!t)},n}();var ue={expand:"aria-expanded",role:"role",datarole:"data-role",selected:"aria-selected",multiselectable:"aria-multiselectable",sort:"aria-sort",busy:"aria-busy",invalid:"aria-invalid",grabbed:"aria-grabbed",dropeffect:"aria-dropeffect",haspopup:"aria-haspopup",level:"aria-level",colcount:"aria-colcount",rowcount:"aria-rowcount"},yot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ww=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell",attrs:{tabindex:"-1"}}),t.ariaService=new oh,t.hTxtEle=t.parent.createElement("span",{className:"e-headertext"}),t.sortEle=t.parent.createElement("div",{className:"e-sortfilterdiv e-icons",attrs:{"aria-hidden":"true"}}),t.gui=t.parent.createElement("div"),t.chkAllBox=t.parent.createElement("input",{className:"e-checkselectall",attrs:{type:"checkbox","aria-label":t.localizer.getConstant("CheckBoxLabel")}}),t}return yot(i,n),i.prototype.getGui=function(){return this.gui.cloneNode()},i.prototype.render=function(n){var t=this.element.cloneNode(),i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter",attrs:{"aria-hidden":"true"}});return this.prepareHeader(n,t,i)},i.prototype.refresh=function(n,t){this.clean(t);var i=this.parent.createElement("div",{className:"e-filtermenudiv e-icons e-icon-filter",attrs:{"aria-hidden":"true"}});return this.prepareHeader(n,t,i)},i.prototype.clean=function(n){n.innerHTML=""},i.prototype.prepareHeader=function(n,i,r){var l,d,u=n.column,a={},f="",o=this.getGui(),v,y,h,p,g,w,c,e,b,rt,s,ut,k;if((t.attributes(o,{"e-mappinguid":u.uid,"class":"e-headercelldiv"}),t.isNullOrUndefined(u.headerValueAccessor)||(l=this.getValue(u.headerText,u)),"checkbox"!==u.type)?(v=u.headerText,t.isNullOrUndefined(l)||(v=l),y=this.hTxtEle.cloneNode(),y[u.getDomSetter()]=this.parent.sanitize(v),o.appendChild(y)):(u.editType="booleanedit",h=fi.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "}),this.chkAllBox.id="checkbox-"+u.uid,h.insertBefore(this.chkAllBox.cloneNode(),h.firstChild),this.parent.cssClass&&t.addClass([h],[this.parent.cssClass]),o.appendChild(h),o.classList.add("e-headerchkcelldiv")),this.buildAttributeFromCell(i,n),this.appendHtml(i,o),i.appendChild(this.sortEle.cloneNode()),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&u.allowFiltering&&!t.isNullOrUndefined(u.field)&&(!this.parent.showColumnMenu||!u.showColumnMenu)){if(t.attributes(r,{"e-mappinguid":"e-flmenu-"+u.uid}),f=f.length?f+". "+this.localizer.getConstant("FilterDescription"):this.localizer.getConstant("FilterDescription"),i.classList.add("e-fltr-icon"),p=[],this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==p.length)for(g=this.parent.getForeignKeyColumns(),w=0;w<this.parent.columns.length;w++)for(c=0;c<this.parent.filterSettings.columns.length;c++)if(this.parent.filterSettings.columns[parseInt(c.toString(),10)].field===u.field||g.length&&u.foreignKeyValue===this.parent.filterSettings.columns[parseInt(c.toString(),10)].field){r.classList.add("e-filtered");p.push(u.field);break}i.appendChild(r.cloneNode())}if(n.className&&i.classList.add(n.className),u.customAttributes&&vr(i,u.customAttributes),this.parent.allowSorting&&u.allowSorting&&(a.sort="none",f=f.length?f+". "+this.localizer.getConstant("SortDescription"):this.localizer.getConstant("SortDescription")),(this.parent.allowGrouping&&u.allowGrouping||this.parent.allowReordering&&u.allowReordering)&&(a.grabbed=!1,f=f.length?f+". "+this.localizer.getConstant("GroupDescription"):this.localizer.getConstant("GroupDescription")),this.parent.showColumnMenu&&(f=f.length?f+". "+this.localizer.getConstant("ColumnMenuDescription"):this.localizer.getConstant("ColumnMenuDescription")),i=this.extendPrepareHeader(u,i),e=this.parent,b=e.getColumnIndexByField(u.field),!t.isNullOrUndefined(u.headerTemplate)){var nt=e.element.id+u.uid+"headerTemplate",tt="isStringTemplate",it=u,ft=this.parent.isReact&&"string"!=typeof u.headerTemplate,et=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;ft||et?(rt={index:b},i.firstElementChild.innerHTML="",u.getHeaderTemplate()(t.extend(rt,it),e,"headerTemplate",nt,this.parent[""+tt],null,i.firstElementChild),this.parent.renderTemplates()):(d=u.getHeaderTemplate()(t.extend({index:b},it),e,"headerTemplate",nt,this.parent[""+tt],void 0,void 0,this.parent.root),i.firstElementChild.innerHTML="",kt(i.firstElementChild,d))}return(this.ariaService.setOptions(i,a),t.isNullOrUndefined(u.headerTextAlign)&&t.isNullOrUndefined(u.textAlign))||(s=u.headerTextAlign||u.textAlign,o.style.textAlign=s,"Right"===s||"Left"===s?i.classList.add("Right"===s?"e-rightalign":"e-leftalign"):"Center"===s&&i.classList.add("e-centeralign")),"Clip"===u.clipMode||!u.clipMode&&"Clip"===this.parent.clipMode?i.classList.add("e-gridclip"):"EllipsisWithTooltip"!==u.clipMode&&(u.clipMode||"EllipsisWithTooltip"!==this.parent.clipMode)||e.allowTextWrap&&("Header"===e.textWrapSettings.wrapMode||"Both"===e.textWrapSettings.wrapMode)||"checkbox"!==u.type&&i.classList.add("e-ellipsistooltip"),f&&i.setAttribute("aria-description",f),i.setAttribute("aria-rowspan",(t.isNullOrUndefined(n.rowSpan)?1:n.rowSpan).toString()),i.setAttribute("aria-colspan","1"),ut=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,(this.parent.isReact&&this.parent.requireTemplateRef||ut&&this.parent.parentDetails.parentInstObj.requireTemplateRef)&&!t.isNullOrUndefined(u.headerTemplate)?(k=this,k.parent.renderTemplates(function(){k.parent.trigger(sc,{cell:n,node:i})})):this.parent.trigger(sc,{cell:n,node:i}),i},i.prototype.getValue=function(n,t){return t.headerValueAccessor(n,t)},i.prototype.extendPrepareHeader=function(n,i){var u,f,e,r,o;if(this.parent.showColumnMenu&&n.showColumnMenu&&!t.isNullOrUndefined(n.field)){if(u=this.parent.createElement("div",{className:"e-icons e-columnmenu",attrs:{"aria-hidden":"true"}}),f=[],this.parent.filterSettings.columns.length&&this.parent.filterSettings.columns.length!==f.length)for(e=0;e<this.parent.columns.length;e++)for(r=0;r<this.parent.filterSettings.columns.length;r++)if(this.parent.filterSettings.columns[parseInt(r.toString(),10)].field===n.field){u.classList.add("e-filtered");f.push(n.field);break}i.classList.add("e-fltr-icon");i.appendChild(u)}return this.parent.allowResizing&&(o=this.parent.createElement("div"),o.className=n.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",i.appendChild(o)),i},i.prototype.appendHtml=function(n,t){return n.appendChild(t),n},i}(si),pot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bw=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-headercell e-stackedheadercell",attrs:{tabindex:"-1"}}),t}return pot(i,n),i.prototype.render=function(n){var i=this.element.cloneNode(),u=this.parent.createElement("div",{className:"e-stackedheadercelldiv",attrs:{"e-mappinguid":n.column.uid}}),r=n.column,f;return(i.appendChild(u),t.isNullOrUndefined(r.headerTemplate)?this.appendHtml(u,this.parent.sanitize(r.headerText),r.getDomSetter()):kt(u,r.getHeaderTemplate()(r,this.parent,"headerTemplate")),n.column.toolTip&&i.setAttribute("title",n.column.toolTip),"Clip"===r.clipMode||!r.clipMode&&"Clip"===this.parent.clipMode?i.classList.add("e-gridclip"):("EllipsisWithTooltip"===r.clipMode||!r.clipMode&&"EllipsisWithTooltip"===this.parent.clipMode)&&i.classList.add("e-ellipsistooltip"),t.isNullOrUndefined(n.column.textAlign)||(u.style.textAlign=n.column.textAlign),n.column.customAttributes&&vr(i,n.column.customAttributes),i.setAttribute("colspan",n.colSpan.toString()),i.setAttribute("aria-colspan",n.colSpan.toString()),i.setAttribute("aria-rowspan","1"),this.parent.allowResizing)&&(f=this.parent.createElement("div"),f.className=n.column.allowResizing?"e-rhandler e-rcursor":"e-rsuppress",i.appendChild(f)),n.className&&i.classList.add(n.className),this.parent.trigger(sc,{cell:n,node:i}),i},i}(si),wot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),da=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-indentcell"}),t}return wot(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return vr(t,n.attributes),t},t}(si),nit=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tit=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.cellUid=0,t.element=t.parent.createElement("TD",{className:"e-groupcaption",attrs:{id:t.parent.element.id+"captioncell",tabindex:"-1"}}),t}return nit(i,n),i.prototype.render=function(n,i){var s,u,f,h,c,y;this.element.id=this.parent.element.id+"captioncell"+this.cellUid++;var l,a,o,e=this.element.cloneNode(),r=this.parent,v=n.column,p=v.getDomSetter?v.getDomSetter():"innerHTML";for(i.headerText=n.column.headerText,n.isForeignKey&&(a=this.format(n.column,n.column.valueAccessor("foreignKey",i,n.column))),s=n.isForeignKey?a:n.column.enableGroupByFormat?i.key:this.format(n.column,n.column.valueAccessor("key",i,n.column)),u=0;u<r.aggregates.length;u++)for(f=0;f<r.aggregates[parseInt(u.toString(),10)].columns.length;f++)if(r.getVisibleColumns()[0].field===r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].field&&r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].groupCaptionTemplate){o=r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].groupCaptionTemplate.includes("$")?r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].groupCaptionTemplate.split("$")[0]+i[r.getVisibleColumns()[0].field][r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].type]+r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].groupCaptionTemplate.split("}")[1]:r.aggregates[parseInt(u.toString(),10)].columns[parseInt(f.toString(),10)].groupCaptionTemplate;break}return t.isNullOrUndefined(r.groupSettings.captionTemplate)?e[""+p]=r.groupSettings.enableLazyLoading?this.parent.sanitize(n.column.headerText)+": "+this.parent.sanitize(s)+(o?"   "+o:""):this.parent.sanitize(n.column.headerText)+": "+this.parent.sanitize(s)+" - "+i.count+" "+(i.count<2?this.localizer.getConstant("Item"):this.localizer.getConstant("Items"))+(o?"   "+o:""):(h=this.parent.isReact&&"string"!=typeof r.groupSettings.captionTemplate,c=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,h||c?(y=r.element.id+"captionTemplate",ri(r.groupSettings.captionTemplate)(i,this.parent,"captionTemplate",y,null,null,e),this.parent.renderTemplates()):l=this.parent.isVue?ri(r.groupSettings.captionTemplate)(i,this.parent):ri(r.groupSettings.captionTemplate)(i),h||c||kt(e,l)),e.setAttribute("colspan",n.colSpan.toString()),e.setAttribute("aria-label",e.innerHTML+this.localizer.getConstant("GroupCaption")),e.setAttribute("title",e.textContent),e},i}(si),iit=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-groupcaption"}),t}return nit(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return t.innerHTML="&nbsp;",t.setAttribute("colspan",n.colSpan.toString()),t},t}(si),bot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kot=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return bot(t,n),t.prototype.render=function(n,t,i,r){var u=this.element.cloneNode();return u.setAttribute("ej-mappingname",t.field),u.setAttribute("ej-mappingvalue",t.key),u.setAttribute("aria-expanded",r?"true":"false"),u.setAttribute("tabindex","-1"),this.parent.infiniteScrollSettings&&this.parent.infiniteScrollSettings.enableCache?(n.cellType=o.Indent,u.className=r?"e-recordplusexpand e-disablepointer":"e-recordpluscollapse e-disablepointer"):(u.className=r?"e-recordplusexpand":"e-recordpluscollapse",u.appendChild(this.parent.createElement("a",{className:r?"e-icons e-gdiagonaldown e-icon-gdownarrow":"e-icons e-gnextforward e-icon-grightarrow",attrs:{href:"#",title:r?"expanded":"collapsed"}}))),u},t}(da),dot=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),got=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-grouptopleftcell"}),t}return dot(t,n),t.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(this.parent.createElement("div",{className:"e-headercelldiv e-emptycell",innerHTML:""})),n},t}(si),nst=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tst=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-detailheadercell"}),t}return nst(t,n),t.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(this.parent.createElement("div",{className:"e-emptycell"})),n},t}(si),ist=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rst=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-detailrowcollapse",attrs:{"aria-expanded":"false",tabindex:"-1"}}),t}return ist(i,n),i.prototype.render=function(n,i,r){var u=this.element.cloneNode();return r&&!t.isNullOrUndefined(r.class)?(u.className="",u.className=r.class,u.appendChild(this.parent.createElement("a",{className:"e-icons e-dtdiagonaldown e-icon-gdownarrow",attrs:{href:"#",title:this.localizer.getConstant("Expanded")}}))):u.appendChild(this.parent.createElement("a",{className:"e-icons e-dtdiagonalright e-icon-grightarrow",attrs:{href:"#",title:this.localizer.getConstant("Collapsed")}})),u},i}(si),ust=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fst=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-rowdragdrop e-rowdragdropcell",attrs:{tabindex:"-1"}}),t}return ust(t,n),t.prototype.render=function(n){var t=this.element.cloneNode();return t.appendChild(this.parent.createElement("div",{className:"e-icons e-rowcelldrag e-dtdiagonalright e-icon-rowdragicon",attrs:{"aria-hidden":"true"}})),n.isSelected&&(t.classList.add("e-selectionbackground"),t.classList.add("e-active")),t},t}(si),est=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ost=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-rowdragheader"}),t}return est(i,n),i.prototype.render=function(){var n=this.element.cloneNode();return n.appendChild(t.createElement("div",{className:"e-emptycell"})),n},i}(si),rit=function(){function n(n,t){this.emptyGrid=!1;this.counter=0;this.parent=n;this.locator=t;this.data=new th(n,t);this.l10n=t.getService("localization");this.ariaService=this.locator.getService("ariaService");this.renderer=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.render=function(){var n=this.parent;this.headerRenderer=this.renderer.getRenderer(at.Header);this.contentRenderer=this.renderer.getRenderer(at.Content);this.headerRenderer.renderPanel();this.contentRenderer.renderPanel();n.getColumns().length&&(this.isLayoutRendered=!0,this.headerRenderer.renderTable(),this.contentRenderer.renderTable(),this.emptyRow(!1));this.parent.scrollModule.setWidth();this.parent.scrollModule.setHeight();"auto"!==this.parent.height&&this.parent.scrollModule.setPadding();this.refreshDataManager()},n.prototype.refresh=function(n){var i=this,t;void 0===n&&(n={requestType:"refresh"});t=this.parent;t.notify(n.requestType+"-begin",n);t.trigger(nt,n,function(n){if(void 0===n&&(n={requestType:"refresh"}),n.cancel)t.notify(hs,n);else{if(t.allowSelection&&("clearFilter"===n.action||"searching"===n.requestType&&""===n.searchString||"add"===n.action)&&(t.selectionModule.rmtHdrChkbxClicked=!1),t.allowPaging&&t.pageSettings.pageSizes&&t.pagerModule.pagerObj.isAllPage&&"add"===n.action&&"save"===n.requestType&&t.pagerModule.pagerObj.checkAll&&t.setProperties({pageSettings:{pageSize:t.pageSettings.pageSize+1}},!0),"delete"===n.requestType&&t.allowPaging){var u=n.data.length,r=t.pageSettings.totalRecordsCount-u;t.getCurrentViewRecords().length-u||!r||(t.pageSettings.currentPage-1)*t.pageSettings.pageSize!==r||(t.prevPageMoving=!0,t.setProperties({pageSettings:{totalRecordsCount:r,currentPage:Math.ceil(r/t.pageSettings.pageSize)}},!0),t.pagerModule.pagerObj.totalRecordsCount=r)}"reorder"===n.requestType&&i.parent.dataSource&&"result"in i.parent.dataSource||("paging"===n.requestType||"columnstate"===n.requestType||"reorder"===n.requestType)&&i.parent.groupSettings.enableLazyLoading&&i.parent.groupSettings.columns.length&&(i.parent.enableVirtualization?i.parent.lazyLoadRender:i.parent.contentModule).getGroupCache()[i.parent.pageSettings.currentPage]?i.contentRenderer.refreshContentRows(n):i.refreshDataManager(n)}})},n.prototype.resetTemplates=function(){var n=this.parent,f=n.getColumns(),s,i,o,r,u,e;for(n.detailTemplate&&(s=n.element.id+"detailTemplate",t.blazorTemplates[""+s]=[],t.resetBlazorTemplate(s,"DetailTemplate")),n.groupSettings.captionTemplate&&t.resetBlazorTemplate(n.element.id+"captionTemplate","CaptionTemplate"),n.rowTemplate&&t.resetBlazorTemplate(n.element.id+"rowTemplate","RowTemplate"),n.toolbarTemplate&&t.resetBlazorTemplate(n.element.id+"toolbarTemplate","ToolbarTemplate"),n.pageSettings.template&&t.resetBlazorTemplate(n.element.id+"_template","pageSettings"),i=0;i<f.length;i++)f[parseInt(i.toString(),10)].template&&(t.blazorTemplates[n.element.id+f[parseInt(i.toString(),10)].uid]=[],t.resetBlazorTemplate(n.element.id+f[parseInt(i.toString(),10)].uid,"Template")),f[parseInt(i.toString(),10)].headerTemplate&&t.resetBlazorTemplate(n.element.id+f[parseInt(i.toString(),10)].uid+"headerTemplate","HeaderTemplate"),f[parseInt(i.toString(),10)].filterTemplate&&t.resetBlazorTemplate(n.element.id+f[parseInt(i.toString(),10)].uid+"filterTemplate","FilterTemplate");for(o="guid",r=0;r<n.aggregates.length;r++)for(u=0;u<n.aggregates[parseInt(r.toString(),10)].columns.length;u++)n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)].footerTemplate&&(e=n.element.id+n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)][""+o]+"footerTemplate",t.resetBlazorTemplate(e,"FooterTemplate")),n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)].groupFooterTemplate&&(e=n.element.id+n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)][""+o]+"groupFooterTemplate",t.resetBlazorTemplate(e,"GroupFooterTemplate")),n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)].groupCaptionTemplate&&(e=n.element.id+n.aggregates[parseInt(r.toString(),10)].columns[parseInt(u.toString(),10)][""+o]+"groupCaptionTemplate",t.resetBlazorTemplate(e,"GroupCaptionTemplate"))},n.prototype.refreshComplete=function(n){this.parent.trigger(l,n)},n.prototype.refreshDataManager=function(n){var i=this,t,r,f,e,s,o;void 0===n&&(n={});r=this.parent;f="Shimmer"===r.loadingIndicator.indicatorType&&"virtualscroll"!==n.requestType&&"infiniteScroll"!==n.requestType||("virtualscroll"===n.requestType||"infiniteScroll"===n.requestType)&&r.enableVirtualMaskRow;"virtualscroll"===n.requestType||n.isCaptionCollapse||f||this.parent.showSpinner();f&&r.showMaskRow("virtualscroll"===n.requestType?n.virtualInfo.sentinelInfo.axis:"infiniteScroll"===n.requestType?n.direction:void 0);this.parent.notify(ll,n);this.emptyGrid=!1;e=this.isNeedForeignAction();(this.ariaService.setBusy(this.parent.getContent().querySelector("."+ft),!0),e)&&(s=new u.Deferred,t=this.getFData(s,n));(t=t?t.then(function(){var r=i.data.generateQuery().requiresCount(),t;return i.emptyGrid?(t=new u.Deferred,t.resolve({result:[],count:0}),t.promise):i.data.getData(n,r)}):this.data.getData(n,this.data.generateQuery().requiresCount()),this.parent.getForeignKeyColumns().length&&(!e||this.parent.searchSettings.key.length))&&(o=new u.Deferred,t=t.then(function(r){return i.parent.notify(ss,{dataManager:t,result:r,promise:o,action:n}),o.promise}));this.parent.groupSettings.disablePageWiseAggregates&&this.parent.groupSettings.columns.length&&(t=t.then(function(n){return i.validateGroupRecords(n)}));t.then(function(t){return i.dataManagerSuccess(t,n)}).catch(function(t){return i.dataManagerFailure(t,n)})},n.prototype.getFData=function(n,t){return this.parent.notify(ss,{isComplex:!0,promise:n,action:t}),n.promise},n.prototype.isNeedForeignAction=function(){var n=this.parent;return!!(n.allowFiltering&&n.filterSettings.columns.length||n.searchSettings.key.length)&&this.foreignKey(this.parent.getForeignKeyColumns())},n.prototype.foreignKey=function(n){var t=this;return n.some(function(n){return!(!t.parent.filterSettings.columns.some(function(t){return n.uid===t.uid})&&!t.parent.searchSettings.key.length)})},n.prototype.sendBulkRequest=function(n){var i=this,t,r,u,f;n.requestType="batchsave";t=this.parent;t.allowPaging&&t.pageSettings.pageSizes&&t.pagerModule.pagerObj.isAllPage&&t.pagerModule.pagerObj.checkAll&&(r=n.changes.addedRecords.length,r&&t.setProperties({pageSettings:{pageSize:t.pageSettings.pageSize+r}},!0));u=this.data.saveChanges(n.changes,this.parent.getPrimaryKeyFieldNames()[0],n.original);f=this.data.generateQuery().requiresCount();this.data.dataManager.dataSource.offline?this.refreshDataManager({requestType:"batchsave"}):u.then(function(){i.data.getData(n,f).then(function(t){return i.dmSuccess(t,n)}).catch(function(t){return i.dmFailure(t,n)})}).catch(function(t){return i.dmFailure(t,n)})},n.prototype.dmSuccess=function(n,t){this.dataManagerSuccess(n,t)},n.prototype.dmFailure=function(n,t){this.dataManagerFailure(n,t)},n.prototype.renderEmptyRow=function(){this.emptyRow(!0)},n.prototype.emptyRow=function(n){var r=this.parent,i=this.contentRenderer.getTable().querySelector(e),u,f;t.isNullOrUndefined(i)||t.remove(i);i=this.parent.createElement(e,{attrs:{role:"rowgroup"}});u=0;(r.detailTemplate||r.childGrid)&&++u;f=this.parent.createElement("tr",{className:"e-emptyrow"});f.appendChild(this.parent.createElement("td",{innerHTML:this.l10n.getConstant("EmptyRecord"),attrs:{colspan:(r.getVisibleColumns().length+u+r.groupSettings.columns.length).toString()}}));i.appendChild(f);this.contentRenderer.renderEmpty(i);n&&(this.parent.trigger(ti,{}),this.parent.notify(vi,{rows:[new lr({isDataRow:!0,cells:[new pi({isDataCell:!0,visible:!0})]})]}))},n.prototype.dynamicColumnChange=function(){this.parent.getCurrentViewRecords().length&&this.updateColumnType(this.parent.getCurrentViewRecords()[0])},n.prototype.updateColumnType=function(n){for(var e,u,r=this.parent.getColumns(),o="customFormat",f="equalTo",s=n&&n.items?n.items[0]:n,h=this.locator.getService("valueFormatter"),i=0,c=r.length;i<c;i++)u=ut(r[parseInt(i.toString(),10)].field||"",s),t.isNullOrUndefined(r[parseInt(i.toString(),10)][""+o])||(r[parseInt(i.toString(),10)].format=r[parseInt(i.toString(),10)][""+o]),t.isNullOrUndefined(r[parseInt(i.toString(),10)].validationRules)||t.isNullOrUndefined(r[parseInt(i.toString(),10)].validationRules[""+f])||(r[parseInt(i.toString(),10)].validationRules[""+f][0]=this.parent.element.id+r[parseInt(i.toString(),10)].validationRules[""+f][0]),r[parseInt(i.toString(),10)].isForeignColumn()&&r[parseInt(i.toString(),10)].columnData&&(u=ut(r[parseInt(i.toString(),10)].foreignKeyValue||"",r[parseInt(i.toString(),10)].columnData[0])),t.isNullOrUndefined(u)?r[parseInt(i.toString(),10)].type=r[parseInt(i.toString(),10)].type||null:(this.isColTypeDef=!0,r[parseInt(i.toString(),10)].type||(r[parseInt(i.toString(),10)].type=u.getDay?u.getHours()>0||u.getMinutes()>0||u.getSeconds()>0||u.getMilliseconds()>0?"datetime":"date":typeof u)),e=new wu,r[parseInt(i.toString(),10)].format&&(r[parseInt(i.toString(),10)].format.skeleton||r[parseInt(i.toString(),10)].format.format&&"string"==typeof r[parseInt(i.toString(),10)].format.format)&&(r[parseInt(i.toString(),10)].setFormatter(e.getFormatFunction(t.extend({},r[parseInt(i.toString(),10)].format))),r[parseInt(i.toString(),10)].setParser(e.getParserFunction(r[parseInt(i.toString(),10)].format))),"string"==typeof r[parseInt(i.toString(),10)].format?sv(this.locator,r[parseInt(i.toString(),10)]):r[parseInt(i.toString(),10)].format||"number"!==r[parseInt(i.toString(),10)].type||r[parseInt(i.toString(),10)].setParser(h.getParserFunction({format:"n2"})),"dateonly"!==r[parseInt(i.toString(),10)].type||r[parseInt(i.toString(),10)].format||(r[parseInt(i.toString(),10)].format="yMd",sv(this.locator,r[parseInt(i.toString(),10)]))},n.prototype.dataManagerSuccess=function(n,i){var r=this,u=this.parent,f;this.contentRenderer=this.renderer.getRenderer(at.Content);this.headerRenderer=this.renderer.getRenderer(at.Header);n.actionArgs=i;f=this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&!u.groupSettings.enableLazyLoading&&("delete"===i.requestType||"save"===i.requestType&&"add"===this.parent.infiniteScrollModule.requestType&&!(u.sortSettings.columns.length||u.filterSettings.columns.length||this.parent.groupSettings.columns.length||u.searchSettings.key));u.trigger(is,n,function(e){var o,s;if(!e.cancel&&(e.result=t.isNullOrUndefined(e.result)?[]:e.result,o=Object.keys(e.result).length,!r.parent.isDestroyed))if(u.getColumns().length||o||u.columns.length&&u.columns[0]instanceof hi)if(!r.isInfiniteEnd(i)||o){if(r.parent.isEdit=!1,r.parent.notify(vs,{}),r.parent.notify(nf,{}),i&&"infiniteScroll"!==i.requestType&&r.parent.notify(ya,{type:"refreshCommandColumn"}),r.contentRenderer.prevCurrentView=r.parent.currentViewData.slice(),u.currentViewData=e.result,u.notify(ra,{args:i,data:e.result}),e.count&&!u.allowPaging&&(u.enableVirtualization||u.enableInfiniteScrolling)&&(u.totalDataRecordsCount=e.count),!o&&e.count&&u.allowPaging&&i&&"delete"!==i.requestType)return!r.parent.groupSettings.enableLazyLoading||"grouping"!==i.requestType&&"ungrouping"!==i.requestType||r.parent.notify(pc,i),u.prevPageMoving=!0,u.pageSettings.totalRecordsCount=e.count,"paging"!==i.requestType&&(u.pageSettings.currentPage=Math.ceil(e.count/u.pageSettings.pageSize)),void u.dataBind();if((u.getColumns().length||!o)&&r.isLayoutRendered||et(u)||(u.removeMaskRow(),r.updatesOnInitialRender(e)),!r.isColTypeDef&&u.getCurrentViewRecords()&&(r.data.dataManager.dataSource.offline&&u.dataSource&&u.dataSource.length?r.updateColumnType(u.dataSource[0]):r.updateColumnType(u.getCurrentViewRecords()[0])),r.parent.isInitialLoad||!r.parent.groupSettings.disablePageWiseAggregates||r.parent.groupSettings.columns.length||(e.result=r.parent.dataSource instanceof Array?r.parent.dataSource:r.parent.currentViewData),!r.parent.isReact&&!r.parent.isVue||t.isNullOrUndefined(i)||"infiniteScroll"===i.requestType||i.isFrozen||yo(r.parent,["footerTemplate"]),r.parent.isAngular&&r.parent.allowGrouping&&r.parent.groupSettings.captionTemplate&&(t.isNullOrUndefined(i)||"infiniteScroll"!==i.requestType)&&r.parent.destroyTemplate(["groupSettings_captionTemplate"]),r.parent.notify(ki,t.extend({count:e.count,result:e.result,aggregates:e.aggregates},i)),(u.groupSettings.columns.length||i&&"ungrouping"===i.requestType)&&i&&"filtering"!==i.requestType&&r.headerRenderer.refreshUI(),o)et(u)&&(i.scrollTop={top:r.contentRenderer.content.scrollTop}),f?r.parent.notify(ws,{e:i,result:n.result,count:n.count,agg:n.aggregates}):r.parent.enableImmutableMode?r.contentRenderer.immutableModeRendering(i):r.contentRenderer.refreshContentRows(i);else{if(i&&i.isCaptionCollapse)return;if(!u.getColumns().length)return u.element.innerHTML="",void alert(r.l10n.getConstant("EmptyDataSourceError"));(r.contentRenderer.setRowElements([]),r.contentRenderer.setRowObjects([]),r.ariaService.setBusy(r.parent.getContent().querySelector("."+ft),!1),u.removeMaskRow(),r.renderEmptyRow(),u.enableColumnVirtualization&&!o&&r.parent.notify(it,{rows:u.getRowsObject(),args:{}}),i)&&(s=(i.requestType||"").toLowerCase()+"-complete",r.parent.notify(s,i),"batchsave"===i.requestType&&(i.cancel=!1,i.rows=[],i.isFrozen=0!==r.parent.getFrozenColumns()&&!i.isFrozen,r.parent.trigger(l,i)));r.parent.autoFit&&r.parent.preventAdjustColumns();r.parent.hideSpinner()}r.parent.notify(tu,{});r.setRowCount(r.parent.getCurrentViewRecords().length);"query"in n&&(r.parent.getDataModule().isQueryInvokedFromData=!1)}else r.parent.notify(ws,{e:i,result:n.result,count:n.count,agg:n.aggregates});else u.hideSpinner()})},n.prototype.dataManagerFailure=function(n,t){this.ariaService.setOptions(this.parent.getContent().querySelector("."+ft),{busy:!1,invalid:!0});this.setRowCount(1);this.parent.trigger(lf,{error:n});this.parent.hideSpinner();this.parent.removeMaskRow();"save"!==t.requestType&&"delete"!==t.requestType&&"bulk-save"!==t.name&&(this.parent.currentViewData=[],this.renderEmptyRow(),this.parent.isInitialLoad||this.parent.focusModule.setFirstFocusableTabIndex(),this.parent.log("actionfailure",{error:n}))},n.prototype.setRowCount=function(n){this.ariaService.setOptions(this.parent.getHeaderTable(),{rowcount:n?n.toString():"1"})},n.prototype.isInfiniteEnd=function(n){return this.parent.enableInfiniteScrolling&&!this.parent.infiniteScrollSettings.enableCache&&"delete"===n.requestType},n.prototype.updatesOnInitialRender=function(n){this.isLayoutRendered=!0;this.parent.columns.length<1&&this.buildColumns(n.result[0]);ee(this.parent.columns,null,this.parent);this.headerRenderer.renderTable();this.contentRenderer.renderTable();this.parent.isAutoGen=!0;this.parent.notify(gu,{})},n.prototype.iterateComplexColumns=function(n,t,i){for(var u=Object.keys(n),r=0;r<u.length;r++)("object"!=typeof n[u[parseInt(r.toString(),10)]]||!n[u[parseInt(r.toString(),10)]]||n[u[parseInt(r.toString(),10)]]instanceof Date?[]:Object.keys(n[u[parseInt(r.toString(),10)]])).length?this.iterateComplexColumns(n[u[parseInt(r.toString(),10)]],t+(u[parseInt(r.toString(),10)]+"."),i):(i[this.counter]=t+u[parseInt(r.toString(),10)],this.counter++)},n.prototype.buildColumns=function(n){var r=[],u={};this.iterateComplexColumns(n,"",u);for(var f=Object.keys(u).filter(function(n){return"BlazId"!==u[""+n]}).map(function(n){return u[""+n]}),i=0,e=f.length;i<e;i++)r[parseInt(i.toString(),10)]={field:f[parseInt(i.toString(),10)]},this.parent.enableColumnVirtualization&&(r[parseInt(i.toString(),10)].width=t.isNullOrUndefined(r[parseInt(i.toString(),10)].width)?200:r[parseInt(i.toString(),10)].width);this.parent.setProperties({columns:r},!0)},n.prototype.instantiateRenderer=function(){this.renderer.addRenderer(at.Header,new ka(this.parent,this.locator));this.renderer.addRenderer(at.Content,new fo(this.parent,this.locator));var n=this.locator.getService("cellRendererFactory");n.addCellRenderer(o.Header,new ww(this.parent,this.locator));n.addCellRenderer(o.Data,new si(this.parent,this.locator));n.addCellRenderer(o.StackedHeader,new bw(this.parent,this.locator));n.addCellRenderer(o.Indent,new da(this.parent,this.locator));n.addCellRenderer(o.GroupCaption,new tit(this.parent,this.locator));n.addCellRenderer(o.GroupCaptionEmpty,new iit(this.parent,this.locator));n.addCellRenderer(o.Expand,new kot(this.parent,this.locator));n.addCellRenderer(o.HeaderIndent,new got(this.parent,this.locator));n.addCellRenderer(o.StackedHeader,new bw(this.parent,this.locator));n.addCellRenderer(o.DetailHeader,new tst(this.parent,this.locator));n.addCellRenderer(o.RowDragHIcon,new ost(this.parent,this.locator));n.addCellRenderer(o.DetailExpand,new rst(this.parent,this.locator));n.addCellRenderer(o.DetailFooterIntent,new da(this.parent,this.locator));n.addCellRenderer(o.RowDragIcon,new fst(this.parent,this.locator))},n.prototype.addEventListener=function(){var n=this;this.parent.isDestroyed||(this.parent.on(cr,this.instantiateRenderer,this),this.parent.on("refreshdataSource",this.dataManagerSuccess,this),this.parent.on(pt,this.refresh,this),this.parent.on(pg,this.refreshComplete,this),this.parent.on(up,this.sendBulkRequest,this),this.parent.on(cp,function(){n.emptyGrid=!0},this),this.parent.on(gu,this.dynamicColumnChange,this))},n.prototype.validateGroupRecords=function(n){var e=this,o=n.result.length-1,i,t,r;if(o<0)return Promise.resolve(n);var s=n.result[0],h=n.result[parseInt(o.toString(),10)],c=[],l=function(n){for(var i=[s,h],t=0;t<i.length;t++)c.push(new u.Predicate("field","==",i[parseInt(t.toString(),10)].field).and(e.getPredicate("key","equal",i[parseInt(t.toString(),10)].key)));n.where(u.Predicate.or(c))},a=new u.Query;l(a);var y=new u.DataManager(n.result).executeLocal(a),f=this.data.generateQuery(!0),v=[];if(this.data.isRemote()){for(i=[s,h],t=0;t<i.length;t++)v.push(this.getPredicate(i[parseInt(t.toString(),10)].field,"equal",i[parseInt(t.toString(),10)].key));f.where(u.Predicate.or(v))}else l(f);return r=new u.Deferred,this.data.getData({},f).then(function(t){e.updateGroupInfo(y,t.result);r.resolve(n)}).catch(function(n){return r.reject(n)}),r.promise},n.prototype.getPredicate=function(n,t,i){return i instanceof Date?au({field:n,operator:t,value:i}):new u.Predicate(n,t,i)},n.prototype.updateGroupInfo=function(n,i){for(var s,a,y,p,v,o,f,l,h,b,c,k=new u.DataManager(i),e=n,r=0;r<e.length;r++)for(s=k.executeLocal((new u.Query).where(new u.Predicate("field","==",e[parseInt(r.toString(),10)].field).and(this.getPredicate("key","equal",e[parseInt(r.toString(),10)].key))))[0],e[parseInt(r.toString(),10)].count=s.count,a=e[parseInt(r.toString(),10)].items,y=s.items,a.GroupGuid&&(e[parseInt(r.toString(),10)].items=this.updateGroupInfo(e[parseInt(r.toString(),10)].items,s.items)),p=this.parent.aggregates,v=0;v<p.length;v++)for(o=p[parseInt(v.toString(),10)],f=0;f<o.columns.length;f++)for(l=o.columns[parseInt(f.toString(),10)].type instanceof Array?o.columns[parseInt(f.toString(),10)].type:[o.columns[parseInt(f.toString(),10)].type],h=0;h<l.length;h++){var w=o.columns[parseInt(f.toString(),10)].field+" - "+l[parseInt(h.toString(),10)].toLowerCase(),d=a.level?y.records:s.items,g=this.parent;"Custom"===l[parseInt(h.toString(),10)]?(b=a.level?y:s,c=o.columns[parseInt(f.toString(),10)].customAggregate,"string"==typeof c&&(c=t.getValue(c,window)),e[parseInt(r.toString(),10)].aggregates[""+w]=c?c.call(g,b,o.columns[parseInt(f.toString(),10)]):""):e[parseInt(r.toString(),10)].aggregates[""+w]=u.DataUtil.aggregates[l[parseInt(h.toString(),10)].toLowerCase()](d,o.columns[parseInt(f.toString(),10)].field)}return n},n}(),uit=function(){function n(){this.cellRenderMap={}}return n.prototype.addCellRenderer=function(n,i){n="string"==typeof n?n:t.getEnumValue(o,n);t.isNullOrUndefined(this.cellRenderMap[""+n])&&(this.cellRenderMap[""+n]=i)},n.prototype.getCellRenderer=function(n){if(n="string"==typeof n?n:t.getEnumValue(o,n),t.isNullOrUndefined(this.cellRenderMap[""+n]))throw"The cellRenderer "+n+" is not found";return this.cellRenderMap[""+n]},n}(),kw=function(){function n(n,t){this.sortedCols=[];this.sortPredicate=[];this.isCustomDialog=!1;this.parent=n;this.serviceLocator=t;this.addEventListener()}return n.prototype.addEventListener=function(){this.evtHandlers=[{event:bs,handler:this.closeCustomDialog},{event:ua,handler:this.refreshCustomFilterOkBtn},{event:fa,handler:this.renderResponsiveContextMenu},{event:ow,handler:this.renderCustomFilterDiv},{event:sw,handler:this.customExFilterClose},{event:ew,handler:this.refreshCustomFilterClearBtn}];vt(this.parent,this.evtHandlers,!0,this);this.onActionCompleteFn=this.editComplate.bind(this);this.parent.addEventListener(l,this.onActionCompleteFn)},n.prototype.customExFilterClose=function(){this.isCustomDlgRender=!1},n.prototype.renderCustomFilterDiv=function(){var n=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),i=n.querySelector(".e-dlg-custom-header"),r=n.querySelector(".e-dlg-closeicon-btn"),t;this.isCustomDlgRender=!0;this.parent.filterModule.filterModule.closeDialog();this.saveBtn.element.style.display="";this.refreshCustomFilterOkBtn({disabled:!1});this.backBtn.element.style.display="none";r.style.display="";i.innerHTML=this.parent.localeObj.getConstant("CustomFilter");t=this.customResponsiveDlg.element.querySelector(".e-dlg-content");this.customExcelFilterParent=this.parent.createElement("div",{className:"e-xl-customfilterdiv e-default-filter"});t.appendChild(this.customExcelFilterParent)},n.prototype.renderResponsiveContextMenu=function(n){var r,o;if(this.action===g.isFilter){var u=this.customResponsiveDlg.element.querySelector(".e-dlg-content"),f=this.customResponsiveDlg.element.querySelector(".e-dlg-header-content"),e=f.querySelector(".e-dlg-closeicon-btn"),i=f.querySelector(".e-dlg-custom-header");n.isOpen?(u.firstChild.style.display="none",u.appendChild(n.target),e.style.display="none",this.saveBtn.element.style.display="none",this.filterClearBtn.element.style.display="none",i.innerHTML=n.header,r=this.parent.createElement("button"),o=this.parent.createElement("span",{className:"e-btn-icon e-resfilterback e-icons"}),r.appendChild(o),this.backBtn=new fi.Button({cssClass:this.parent.cssClass?"e-res-back-btn "+this.parent.cssClass:"e-res-back-btn"}),this.backBtn.appendTo(r),i.parentElement.insertBefore(r,i)):this.backBtn&&!this.isCustomDlgRender&&(u.firstChild.style.display="",t.remove(this.backBtn.element),e.style.display="",this.saveBtn.element.style.display="",this.isFiltered&&(this.filterClearBtn.element.style.display=""),i.innerHTML=this.getHeaderTitle({action:g.isFilter},n.col))}},n.prototype.refreshCustomFilterClearBtn=function(n){this.filterClearBtn&&(this.isFiltered=n.isFiltered,this.filterClearBtn.element.style.display=n.isFiltered?"":"none")},n.prototype.refreshCustomFilterOkBtn=function(n){this.saveBtn&&(this.saveBtn.disabled=n.disabled)},n.prototype.renderResponsiveContent=function(n){var w=this,u=this.parent,r,i,f,y,h,c,l;if(n)return this.filterParent=this.parent.createElement("div",{className:"e-mainfilterdiv e-default-filter",id:n.uid+"-main-filter"}),this.filterParent;r=u.getColumns();this.customColumnDiv=u.createElement("div",{className:"columndiv",styles:"width: 100%"});var b=u.createElement("div",{className:"e-ressortbutton-parent"}),a=[],v=this.action===g.isSort,o=this.action===g.isFilter;if(o)for(i=0;i<u.filterSettings.columns.length;i++)a.push(u.filterSettings.columns[parseInt(i.toString(),10)].field);for(i=0;i<r.length;i++)if(!(!r[parseInt(i.toString(),10)].visible||!r[parseInt(i.toString(),10)].allowSorting&&v||!r[parseInt(i.toString(),10)].allowFiltering&&o)){if(f=u.createElement("div",{className:"e-responsivecoldiv"}),f.setAttribute("data-e-mappingname",r[parseInt(i.toString(),10)].field),f.setAttribute("data-e-mappinguid",r[parseInt(i.toString(),10)].uid),y=u.createElement("span",{innerHTML:r[parseInt(i.toString(),10)].headerText,className:"e-res-header-text"}),f.appendChild(y),this.customColumnDiv.appendChild(f),v){var s=this.getSortedFieldsAndDirections("field").indexOf(r[parseInt(i.toString(),10)].field),e=u.createElement("button",{id:u.element.id+r[parseInt(i.toString(),10)].field+"sortbutton"}),p=b.cloneNode();p.appendChild(e);f.appendChild(p);new fi.Button({cssClass:this.parent.cssClass?"e-ressortbutton "+this.parent.cssClass:"e-ressortbutton"}).appendTo(e);h=void 0;t.isNullOrUndefined(this.parent.sortSettings.columns[parseInt(s.toString(),10)])||(h="Ascending"===this.parent.sortSettings.columns[parseInt(s.toString(),10)].direction?this.parent.localeObj.getConstant("AscendingText"):this.parent.localeObj.getConstant("DescendingText"));e.innerHTML=s>-1?h:this.parent.localeObj.getConstant("NoneText");e.onclick=function(n){w.sortButtonClickHandler(n.target)}}o&&a.indexOf(r[parseInt(i.toString(),10)].field)>-1&&(c=u.createElement("div",{className:"e-icons e-res-icon e-filtersetdiv"}),l=u.createElement("span",{className:"e-icons e-res-icon e-filterset"}),l.setAttribute("colType",r[parseInt(i.toString(),10)].type),c.appendChild(l),f.appendChild(c))}return t.EventHandler.add(this.customColumnDiv,"click",this.customFilterColumnClickHandler,this),this.customColumnDiv},n.prototype.getSortedFieldsAndDirections=function(n){for(var i=[],t=0;t<this.parent.sortSettings.columns.length;t++)i.push(this.parent.sortSettings.columns[parseInt(t.toString(),10)][""+n]);return i},n.prototype.sortButtonClickHandler=function(n){var r;if(n){r=i(n,"e-responsivecoldiv").getAttribute("data-e-mappingname");this.parent.allowMultiSorting||(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1,this.resetSortButtons(n));var u=n.textContent,t=u===this.parent.localeObj.getConstant("NoneText")?this.parent.localeObj.getConstant("AscendingText"):u===this.parent.localeObj.getConstant("AscendingText")?this.parent.localeObj.getConstant("DescendingText"):this.parent.localeObj.getConstant("NoneText"),f=t===this.parent.localeObj.getConstant("AscendingText")?"Ascending":t===this.parent.localeObj.getConstant("DescendingText")?"Descending":"None";n.innerHTML=t;this.setSortedCols(r,f)}},n.prototype.resetSortButtons=function(n){for(var i=[].slice.call(this.customColumnDiv.getElementsByClassName("e-ressortbutton")),t=0;t<i.length;t++)i[parseInt(t.toString(),10)]!==n&&(i[parseInt(t.toString(),10)].innerHTML="None")},n.prototype.setSortedCols=function(n,t){var i=this.getCurrentSortedFields().indexOf(n);this.parent.allowMultiSorting&&i>-1&&(this.sortedCols.splice(i,1),this.sortPredicate.splice(i,1));this.isSortApplied=!0;"None"!==t&&(this.sortedCols.push(n),this.sortPredicate.push({field:n,direction:t}))},n.prototype.getCurrentSortedFields=function(){for(var t=[],n=0;n<this.sortedCols.length;n++)t.push(this.sortedCols[parseInt(n.toString(),10)]);return t},n.prototype.customFilterColumnClickHandler=function(n){var u,t,f,e,r;this.action===g.isFilter&&(u=this.parent,t=n.target,"FilterBar"!==u.filterSettings.type&&(t.classList.contains("e-responsivecoldiv")||t.parentElement.classList.contains("e-responsivecoldiv")?((r=t.getAttribute("data-e-mappingname"))||(r=t.parentElement.getAttribute("data-e-mappingname")),r)&&(f=u.getColumnByField(r),this.isRowResponsive=!0,this.showResponsiveDialog(f)):(t.classList.contains("e-filterset")||t.parentElement.classList.contains("e-filtersetdiv"))&&(e=i(t,"e-responsivecoldiv"),e&&(r=e.getAttribute("data-e-mappingname"),"Menu"!==(f=u.getColumnByField(r)).filter.type&&(f.filter.type||"Menu"!==u.filterSettings.type)||(this.isDialogClose=!0),this.parent.filterModule.filterModule.clearCustomFilter(f),this.removeCustomDlgFilterEle(t)))))},n.prototype.showResponsiveDialog=function(n){if(this.isCustomDialog&&this.action===g.isFilter&&!this.isRowResponsive)this.renderCustomFilterDialog();else{if(this.filteredCol=n,this.renderResponsiveDialog(n),this.parent.enableAdaptiveUI&&n&&(this.parent.filterModule.setFilterModel(n),this.parent.filterModule.filterModule.openDialog(this.parent.filterModule.createOptions(n,void 0))),this.action===g.isSort){var t={cancel:!1,dialogObj:this.customResponsiveDlg,requestType:"beforeOpenAptiveSortDialog"};if(this.parent.trigger(vy,t),t.cancel)return}this.customResponsiveDlg.show(!0);this.customResponsiveDlg.element.style.maxHeight="100%";this.setTopToChildDialog(this.customResponsiveDlg.element)}},n.prototype.setTopToChildDialog=function(n){var t=n.querySelector(".e-dialog"),i;t&&(i=n.querySelector(".e-dlg-header-content").getBoundingClientRect().height,t.style.top=i+"px")},n.prototype.renderCustomFilterDialog=function(n){var r=this.parent,t,i;(this.action!==g.isFilter||"FilterBar"!==r.filterSettings.type)&&(t=this.parent.createElement("div",{id:r.element.id+"customfilter",className:this.parent.cssClass?"e-customfilterdiv e-responsive-dialog "+this.parent.cssClass:"e-customfilterdiv e-responsive-dialog"}),this.parent.element.appendChild(t),this.customFilterDlg=this.getDialogOptions(n,!0),i={cancel:!1,dialogObj:this.customFilterDlg,requestType:"beforeOpenAptiveFilterDialog"},this.parent.trigger(vy,i),i.cancel||(this.customFilterDlg.appendTo(t),this.customFilterDlg.show(!0),this.customFilterDlg.element.style.maxHeight="100%"))},n.prototype.getDialogOptions=function(n,t,i){var r=new bt.Dialog({isModal:!0,showCloseIcon:!0,closeOnEscape:!1,locale:this.parent.locale,target:this.parent.adaptiveDlgTarget?this.parent.adaptiveDlgTarget:document.body,visible:!1,enableRtl:this.parent.enableRtl,content:this.renderResponsiveContent(n),open:this.dialogOpen.bind(this),created:this.dialogCreated.bind(this),close:this.beforeDialogClose.bind(this),width:"100%",height:"100%",animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});return r.isStringTemplate=!0,t?(r.header=this.renderResponsiveHeader(n,void 0,!0),r.cssClass="e-customfilter"):(r.header=this.renderResponsiveHeader(n),r.cssClass="Vertical"===this.parent.rowRenderingMode&&this.action===g.isFilter?"e-res"+i+" e-row-responsive-filter":"e-res"+i),r},n.prototype.renderResponsiveDialog=function(n){var r=this.parent,t,i;(this.action!==g.isFilter||"FilterBar"!==r.filterSettings.type)&&(t=this.action===g.isFilter?"filter":"sort",i=this.parent.createElement("div",{id:r.element.id+"responsive"+t,className:this.parent.cssClass?"e-res"+t+"div e-responsive-dialog "+this.parent.cssClass:"e-res"+t+"div e-responsive-dialog"}),this.parent.element.appendChild(i),this.customResponsiveDlg=this.getDialogOptions(n,!1,t),this.customResponsiveDlg.appendTo(i))},n.prototype.dialogCreated=function(){yb(this.parent)},n.prototype.dialogOpen=function(){var n,t,i;if(this.action===g.isSort&&this.parent.allowMultiSorting)for(n=0;n<this.parent.sortSettings.columns.length;n++)this.sortedCols.push(this.parent.sortSettings.columns[parseInt(n.toString(),10)].field),t=this.parent.sortSettings.columns[parseInt(n.toString(),10)].field,i=this.parent.sortSettings.columns[parseInt(n.toString(),10)].direction,this.sortPredicate.push({field:t,direction:i})},n.prototype.beforeDialogClose=function(n){this.isDialogClose=n.element&&!n.element.querySelector(".e-xl-customfilterdiv")&&n.element.classList.contains("e-resfilterdiv");this.action===g.isFilter?n.element.classList.contains("e-resfilterdiv")?this.parent.filterModule.filterModule.closeResponsiveDialog(this.isCustomDlgRender):n.element.classList.contains("e-customfilterdiv")&&this.closeCustomFilter():this.action===g.isSort&&this.closeCustomDialog();this.parent.off(ks,this.keyHandler)},n.prototype.sortColumn=function(){if(this.isSortApplied){this.sortPredicate.length&&this.parent.setProperties({sortSettings:{columns:[]}},!0);for(var n=0;n<this.sortPredicate.length;n++)this.parent.sortColumn(this.sortPredicate[parseInt(n.toString(),10)].field,this.sortPredicate[parseInt(n.toString(),10)].direction,this.parent.allowMultiSorting);this.sortPredicate.length||this.parent.clearSorting();this.closeCustomDialog()}else this.closeCustomDialog()},n.prototype.getHeaderTitle=function(n,t){var i,r=this.parent;return this.action===g.isEdit?i=r.localeObj.getConstant("EditFormTitle")+n.primaryKeyValue[0]:this.action===g.isAdd?i=r.localeObj.getConstant("AddFormTitle"):this.action===g.isFilter?i=t?t.headerText||t.field:r.localeObj.getConstant("FilterButton"):this.action===g.isSort&&(i=r.localeObj.getConstant("Sort")),i},n.prototype.getDialogName=function(n){var t;return n===g.isAdd||n===g.isEdit?t="dialogEdit_wrapper_title":n===g.isFilter&&(t="responsive_filter_dialog_wrapper"),t},n.prototype.getButtonText=function(n){var t;return n===g.isAdd||n===g.isEdit?t="Save":n!==g.isFilter&&this.action!==g.isSort||(t="OKButton"),t},n.prototype.renderResponsiveHeader=function(n,t,r){var f=this,u=this.parent,s,c,h,l,e,v;u.on(ks,this.keyHandler,this);var y=u.element.id+this.getDialogName(this.action),o=u.createElement("div",{className:"e-res-custom-element"}),a=u.createElement("div",{className:"e-dlg-custom-header",id:y});return a.innerHTML=this.getHeaderTitle(t,n),o.appendChild(a),s=u.createElement("button"),r||(this.saveBtn=new fi.Button({cssClass:this.parent.cssClass?"e-primary e-flat e-res-apply-btn "+this.parent.cssClass:"e-primary e-flat e-res-apply-btn"}),s.innerHTML=u.localeObj.getConstant(this.getButtonText(this.action)),this.saveBtn.appendTo(s),s.onclick=function(){f.dialogHdrBtnClickHandler()}),c=this.action===g.isSort,h=this.action===g.isFilter,(h||c)&&(l=c?"sort":"filter",e=u.createElement("button"),(this.filterClearBtn=new fi.Button({cssClass:this.parent.cssClass?"e-primary e-flat e-res-"+l+"-clear-btn "+this.parent.cssClass:"e-primary e-flat e-res-"+l+"-clear-btn"}),h)?(v=u.createElement("span",{className:"e-btn-icon e-icon-filter-clear e-icons"}),e.appendChild(v)):e.innerHTML=u.localeObj.getConstant("Clear"),o.appendChild(e),this.filterClearBtn.appendTo(e),e.onclick=function(n){i(n.target,"e-customfilter")?(f.parent.filterModule.clearFiltering(),f.removeCustomDlgFilterEle()):h?f.filterClear():(f.resetSortButtons(),f.sortedCols=[],f.sortPredicate=[],f.isSortApplied=!0)},o.appendChild(e)),r||o.appendChild(s),o},n.prototype.filterClear=function(){this.parent.filterModule.filterModule.clearCustomFilter(this.filteredCol);this.parent.filterModule.filterModule.closeResponsiveDialog()},n.prototype.dialogHdrBtnClickHandler=function(){this.action===g.isEdit||this.action===g.isAdd?this.parent.endEdit():this.action===g.isFilter?this.parent.filterModule.filterModule.applyCustomFilter({col:this.filteredCol,isCustomFilter:this.isCustomDlgRender}):this.action===g.isSort&&this.sortColumn()},n.prototype.closeCustomDialog=function(){if(this.isCustomDlgRender){var n=this.customResponsiveDlg.element.querySelector(".e-mainfilterdiv");t.remove(n)}else this.isRowResponsive=!1,this.isCustomDlgRender=!1,this.destroyCustomFilterDialog()},n.prototype.destroyCustomFilterDialog=function(){if(this.customResponsiveDlg){var n=document.getElementById(this.customResponsiveDlg.element.id);this.customResponsiveDlg&&!this.customResponsiveDlg.isDestroyed&&n&&(this.customResponsiveDlg.destroy(),t.remove(n));this.closeCustomFilter();this.action===g.isSort&&(this.sortPredicate=[],this.sortedCols=[],this.isSortApplied=!1)}},n.prototype.closeCustomFilter=function(){if(!this.isDialogClose&&this.customFilterDlg){var n=document.getElementById(this.customFilterDlg.element.id);this.customFilterDlg&&!this.customFilterDlg.isDestroyed&&n&&(this.customFilterDlg.destroy(),t.remove(n))}this.isCustomDialog=!1;this.isDialogClose=!1},n.prototype.removeCustomDlgFilterEle=function(n){if(n)n.parentElement.classList.contains("e-filtersetdiv")?t.remove(n.parentElement):t.remove(n);else for(var r=this.customColumnDiv.children,i=0;i<r.length;i++)(n=r[parseInt(i.toString(),10)].querySelector(".e-filtersetdiv"))&&(t.remove(n),i--)},n.prototype.keyHandler=function(n){13===n.keyCode&&(this.action===g.isFilter&&n.target.classList.contains("e-searchinput")||this.action===g.isEdit||this.action===g.isAdd)&&this.dialogHdrBtnClickHandler()},n.prototype.editComplate=function(n){"save"!==n.requestType&&"cancel"!==n.requestType||this.parent.off(ks,this.keyHandler)},n.prototype.removeEventListener=function(){this.customColumnDiv&&t.EventHandler.remove(this.customColumnDiv,"click",this.customFilterColumnClickHandler);vt(this.parent,this.evtHandlers,!0,this);this.parent.removeEventListener(l,this.onActionCompleteFn)},n}(),fit=function(){function n(){this.services={}}return n.prototype.register=function(n,i){t.isNullOrUndefined(this.services[""+n])&&(this.services[""+n]=i)},n.prototype.getService=function(n){if(t.isNullOrUndefined(this.services[""+n]))throw"The service "+n+" is not registered";return this.services[""+n]},n.prototype.registerAdaptiveService=function(n,t,i){t?(n.responsiveDialogRenderer=new kw(n.parent,n.serviceLocator),n.responsiveDialogRenderer.action=i):n.responsiveDialogRenderer&&(n.responsiveDialogRenderer.removeEventListener(),n.responsiveDialogRenderer=void 0)},n}(),sst=function(){function n(){this.rendererMap={}}return n.prototype.addRenderer=function(n,i){var r=t.getEnumValue(at,n);t.isNullOrUndefined(this.rendererMap[""+r])&&(this.rendererMap[""+r]=i)},n.prototype.getRenderer=function(n){var i=t.getEnumValue(at,n);if(t.isNullOrUndefined(this.rendererMap[""+i]))throw"The renderer "+i+" is not found";return this.rendererMap[""+i]},n}(),dw=function(){function n(n){this.parent=n}return n.prototype.setWidthToColumns=function(){var r,n=0,e=this.parent.getColumnIndexesInView(),u=!0,f,i,t;if(this.parent.allowGrouping)for(f=this.parent.groupSettings.columns.length;n<f;n++)this.parent.enableColumnVirtualization&&-1===e.indexOf(n)?u=!1:this.setColumnWidth(new hi({width:"30px"}),n);for((this.parent.detailTemplate||this.parent.childGrid)&&(this.setColumnWidth(new hi({width:"30px"}),n),n++),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&(this.setColumnWidth(new hi({width:"30px"}),n),n++),i=this.parent.getColumns(),t=0;t<i.length;t++)this.setColumnWidth(i[parseInt(t.toString(),10)],u&&this.parent.enableColumnVirtualization?void 0:t+n);this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&this.setColumnWidth(new hi({width:"30px"}),i.length);r=this.getTableWidth(this.parent.getColumns());"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(r)},n.prototype.setMinwidthBycalculation=function(n){var f=0,i=this.parent.getColumns().filter(function(n){return t.isNullOrUndefined(n.width)||"auto"===n.width}),u,r,s;if(i.length){f=t.isNullOrUndefined(this.parent.width)||"auto"===this.parent.width||"string"!=typeof this.parent.width||-1!==this.parent.width.indexOf("%")?this.parent.element.getBoundingClientRect().width-n:("string"==typeof this.parent.width?parseInt(this.parent.width,10):this.parent.width)-n;for(var e=0,o=0,h=i;o<h.length;o++)u=h[o],e+=t.isNullOrUndefined(u.minWidth)?0:"string"==typeof u.minWidth?parseInt(u.minWidth,10):u.minWidth;for(r=0;r<i.length;r++)0===n&&this.parent.allowResizing&&this.isWidthUndefined()&&r!==i.length-1&&this.setUndefinedColumnWidth(i),s=this.parent.getColumnIndexByField(i[parseInt(r.toString(),10)].field)+this.parent.getIndentCount(),0!==n&&f<e?this.setWidth(i[parseInt(r.toString(),10)].minWidth,s):0!==n&&f>e&&this.setWidth("",s,!0)}},n.prototype.setUndefinedColumnWidth=function(n){for(var t=0;t<n.length;t++)t!==n.length-1&&(n[parseInt(t.toString(),10)].width=200,this.setWidth(200,this.parent.getColumnIndexByField(n[parseInt(t.toString(),10)].field)))},n.prototype.setColumnWidth=function(n,i,r){if(!(this.parent.getColumns().length<1)){var f=t.isNullOrUndefined(i)?this.parent.getNormalizedColumnIndex(n.uid):i,u=this.getWidth(n),e=this.getTableWidth(this.parent.getColumns());null!==u&&(this.setWidth(u,f),"auto"!==this.parent.width&&-1===this.parent.width.toString().indexOf("%")&&this.setMinwidthBycalculation(e),(this.parent.allowResizing&&"resize"===r||this.parent.getFrozenColumns()&&this.parent.allowResizing)&&this.setWidthToTable(),this.parent.notify(ae,{index:f,width:u,column:n,module:r}))}},n.prototype.setWidth=function(n,r,u){var s,et,nt,ot,tt;this.parent.groupSettings.columns.length>r&&av(this.parent)&&(n=(3e3/this.parent.element.offsetWidth).toFixed(1)+"%");var h,k=this.parent.getHeaderTable(),d=this.parent.getContentTable(),it=t.formatUnit(n),e=this.parent.getFrozenColumns(),rt=this.parent.isRowDragable();e=e&&rt?e+1:e;var o,l=this.parent.getHeaderContent().querySelector("."+w),g=this.parent.getContent().querySelector("."+p),f=this.parent.getFrozenLeftColumnsCount(),a=this.parent.getFrozenRightColumnsCount(),v=this.parent.getMovableColumnsCount(),ft=0!==f||0!==a;if(e&&r>=e){if(!l||!l.querySelector(c))return;h=l.querySelector(c+":not(.e-masked-colgroup)").children[r-e]}else if(this.parent.enableColumnVirtualization&&e&&this.parent.contentModule.isXaxis()&&l.scrollLeft>0)h=(nt=l.querySelector(c)).children[nt.children.length-1-r];else if(ft){if(s=void 0,f&&!a?s=(r=rt?r-1:r)<f?k:l:!f&&a?s=r>=v?k:l:f&&a&&(r=rt?r-1:r,et=this.parent.getFrozenRightHeader(),s=r<f?k:r<f+v?l:et),!(h=this.getColumnLevelFrozenColgroup(r,f,v,s)))return}else h=k.querySelector(c).children[parseInt(r.toString(),10)];if((h&&!u?h.style.width=it:h&&u&&(h.style.width=""),e&&r>=e)?o=this.parent.getContent().querySelector("."+p).querySelector(c+":not(.e-masked-colgroup)").children[r-e]:this.parent.enableColumnVirtualization&&e&&this.parent.contentModule.isXaxis()&&g.scrollLeft>0?o=(nt=this.parent.getContent().querySelector("."+p).querySelector(c)).children[nt.children.length-1-r]:ft?((s=void 0,f&&!a&&(s=r<f?d:g),!f&&a&&(s=r>=v?d:g),f&&a)&&(ot=this.parent.getContent().querySelector(".e-frozen-right-content"),s=r<f?d:r<f+v?g:ot),o=this.getColumnLevelFrozenColgroup(r,f,v,s)):o=d.querySelector(c).children[parseInt(r.toString(),10)],o&&!u?(o.style.width!==h.style.width&&this.parent.isFrozenGrid()&&this.parent.reorderModule&&this.parent.reorderModule.element&&this.parent.reorderModule.destElement&&(o.style.display=this.parent.getColumnByIndex(r).visible?"":"none"),o.style.width=it):o&&u&&(o.style.width=""),!this.parent.enableColumnVirtualization){for(var y=this.parent.element.querySelectorAll(".e-table.e-inline-edit"),ut=[],b=0;b<y.length;b++)if(i(y[parseInt(b.toString(),10)],"e-grid").id===this.parent.element.id)for(tt=0;tt<y[parseInt(b.toString(),10)].querySelector("colgroup").children.length;tt++)ut.push(y[parseInt(b.toString(),10)].querySelector("colgroup").children[parseInt(tt.toString(),10)]);y.length&&ut.length&&(ut[parseInt(r.toString(),10)].style.width=it)}this.parent.isFrozenGrid()&&this.refreshFrozenScrollbar()},n.prototype.getColumnLevelFrozenColgroup=function(n,t,i,r){if(!r||!r.querySelector(c))return null;var e=this.parent.getColumns(),f=this.parent.isRowDragable(),o=this.parent.getFrozenMode(),u=[].slice.call(r.querySelector(c+":not(.e-masked-colgroup)").children);return"Right"===o&&f&&n===i+this.parent.getFrozenRightColumnsCount()?u[u.length-1]:f&&-1===n?u[0]:"Left"===e[parseInt(n.toString(),10)].freeze?u[f?n+1:n]:"Right"===e[parseInt(n.toString(),10)].freeze?u[n-(t+i)]:u[n-t]},n.prototype.refreshFrozenScrollbar=function(){var u={cancel:!1},e,i,r;if(this.parent.notify(stt,u),!u.cancel){var n=hu(),o=this.parent.element.querySelector(".e-frozenscrollbar"),h=this.parent.element.querySelector(".e-movablescrollbar"),c=this.parent.getContent().querySelector("."+wi),l=this.parent.getContent().querySelector("."+p),f=c.firstElementChild.getBoundingClientRect().width,t=l.firstElementChild.getBoundingClientRect().width;("Right"===this.parent.getFrozenMode()&&(f+=n),o.style.width=f+"px",this.parent.getFrozenMode()===s)?(e=this.parent.element.querySelector(".e-frozen-right-scrollbar"),i=this.parent.getContent().querySelector(".e-frozen-right-content").firstElementChild.getBoundingClientRect().width,"auto"!==this.parent.height&&(i+=n),e.style.width=i+"px"):(this.parent.enableColumnVirtualization&&(r=this.parent.getMovableVirtualContent().querySelector(".e-virtualtrack"),r&&(t=r.scrollWidth)),"Right"!==this.parent.getFrozenMode()&&"auto"!==this.parent.height&&(t+=n));h.firstElementChild.style.width=t+"px"}},n.prototype.getSiblingsHeight=function(n){return this.getHeightFromDirection(n,"previous")+this.getHeightFromDirection(n,"next")},n.prototype.getHeightFromDirection=function(n,t){for(var i=n[t+"ElementSibling"],r=0,u=[ct,fu,"e-groupdroparea","e-gridpager","e-toolbar","e-temp-toolbar"];i;)u.some(function(n){return i.classList.contains(n)})&&(r+=i.offsetHeight),i=i[t+"ElementSibling"];return r},n.prototype.isWidthUndefined=function(){var n=this.parent.getColumns().filter(function(n){return t.isNullOrUndefined(n.width)&&t.isNullOrUndefined(n.minWidth)}).length;return this.parent.getColumns().length===n},n.prototype.getWidth=function(n){if(t.isNullOrUndefined(n.width)&&this.parent.allowResizing&&t.isNullOrUndefined(n.minWidth)&&!this.isWidthUndefined()&&(n.width=200),this.parent.isFrozenGrid()&&t.isNullOrUndefined(n.width)&&(n.getFreezeTableName()===rt||n.getFreezeTableName()===d)&&(n.width=200),!n.width)return null;var i=parseInt(n.width.toString(),10);return n.minWidth&&i<parseInt(n.minWidth.toString(),10)?n.minWidth:n.maxWidth&&i>parseInt(n.maxWidth.toString(),10)?n.maxWidth:n.width},n.prototype.getTableWidth=function(n){for(var t,i,u=0,r=0,f=n;r<f.length;r++)t=f[r],i=this.getWidth(t),"auto"===t.width&&(i=0),!1!==t.visible&&null!==i&&(u+=parseInt(i.toString(),10));return u},n.prototype.calcMovableOrFreezeColWidth=function(n){var i=this.parent.getColumns().slice(),r=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),u=this.parent.getMovableColumnsCount(),f=this.parent.getFrozenRightColumnsCount();return"movable"===n?(f&&i.splice(r+u,i.length),r&&i.splice(0,r)):"freeze-left"===n?i.splice(r,i.length):"freeze-right"===n&&i.splice(0,r+u),t.formatUnit(this.getTableWidth(i))},n.prototype.setWidthToFrozenRightTable=function(){var n=this.calcMovableOrFreezeColWidth("freeze-right"),t,i;n=this.isAutoResize()?"100%":n;t=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector("."+k+":not(.e-masked-table)");i=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+k+":not(.e-masked-table)");t.style.width=n;i.style.width=n},n.prototype.setWidthToFrozenLeftTable=function(){var n=this.calcMovableOrFreezeColWidth("freeze-left");n=this.isAutoResize()?"100%":n;this.parent.getHeaderTable().style.width=n;this.parent.getContentTable().style.width=n},n.prototype.setWidthToMovableTable=function(){var n="",u=this.parent.getColumns().filter(function(n){return t.isNullOrUndefined(n.width)}).length>=1,f=this.parent.getColumns().filter(function(n){return"auto"===n.width}).length>=1,i=this.parent.getHeaderContent().querySelector("."+w),r=this.parent.getContent().querySelector("."+p);"number"!=typeof this.parent.width||u||f||this.parent.resizeModule.resizeProcess?u||f||(n=this.calcMovableOrFreezeColWidth("movable")):n=t.formatUnit(this.parent.width-parseInt(this.calcMovableOrFreezeColWidth("freeze").split("px")[0],10)-5);n=this.isAutoResize()?"100%":n;i.firstElementChild&&(i.firstElementChild.classList.contains("e-masked-table")?i.childNodes[1].style.width=n:i.firstElementChild.style.width=n);r.firstElementChild.classList.contains("e-masked-table")?r.childNodes[1].style.width=n:r.firstElementChild.style.width=n},n.prototype.setWidthToFrozenEditTable=function(){var n=this.calcMovableOrFreezeColWidth("freeze");n=this.isAutoResize()?"100%":n;this.parent.element.querySelectorAll(".e-table.e-inline-edit")[0].style.width=n},n.prototype.setWidthToMovableEditTable=function(){var n=this.calcMovableOrFreezeColWidth("movable");n=this.isAutoResize()?"100%":n;this.parent.element.querySelectorAll(".e-table.e-inline-edit")[1].style.width=n},n.prototype.setWidthToTable=function(){var n=t.formatUnit(this.getTableWidth(this.parent.getColumns())),i;this.parent.isFrozenGrid()?((this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&this.setWidthToFrozenLeftTable(),this.setWidthToMovableTable(),this.parent.getFrozenRightColumnsCount()&&this.setWidthToFrozenRightTable()):((this.parent.detailTemplate||this.parent.childGrid)&&this.setColumnWidth(new hi({width:"30px"})),n=this.isAutoResize()?"100%":n,this.parent.getHeaderTable().style.width=n,this.parent.getContentTable().style.width=n);i=this.parent.element.querySelector(".e-table.e-inline-edit");i&&this.parent.getFrozenColumns()?(this.setWidthToFrozenEditTable(),this.setWidthToMovableEditTable()):i&&(i.style.width=n)},n.prototype.isAutoResize=function(){return this.parent.allowResizing&&"Auto"===this.parent.resizeSettings.mode},n}(),sh=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hst=function(){function n(n){this.currentInfo={};this.oneTime=!0;this.swap={};this.isInfiniteScroll=!1;this.forget=!1;this.skipFocus=!0;this.focusByClick=!1;this.firstHeaderCellClick=!1;this.prevIndexes={};this.refMatrix=this.refreshMatrix(!0);this.actions=["downArrow","upArrow"];this.isVirtualScroll=!1;this.parent=n;this.rowModelGen=new er(this.parent);this.addEventListener()}return n.prototype.focusCheck=function(n){var t=n.target;this.focusByClick=!0;this.firstHeaderCellClick=!0;this.skipFocus=t.classList.contains("e-grid")},n.prototype.onFocus=function(n){if(!(this.parent.isDestroyed||t.Browser.isDevice||this.parent.enableVirtualization||this.parent.element.querySelector(".e-masked-table")||!this.parent.isInitialLoad&&n&&n.target===this.parent.element&&this.parent.element.querySelector(".e-spin-show"))){this.setActive(!this.parent.enableHeaderFocus&&0===this.parent.frozenRows,this.parent.isFrozenGrid());this.parent.enableHeaderFocus||this.parent.getCurrentViewRecords().length||"Batch"===this.parent.editSettings.mode&&("Batch"!==this.parent.editSettings.mode||!this.parent.editModule||this.parent.editModule.getBatchChanges()[ar].length)||this.getContent().matrix.generate(this.rowModelGen.generateRows({rows:[new lr({isDataRow:!0})]}),this.getContent().selector,!1);var i=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(i[0],i[1]);!this.skipFocus||n&&n.target===this.parent.element||(this.focus(n),this.skipFocus=!1)}},n.prototype.passiveFocus=function(n){if(!this.parent.isDestroyed){var r=this.parent.getHeaderContent().querySelector(".e-headercell");n.target!==r||!n.relatedTarget||i(n.relatedTarget,"e-grid")||this.firstHeaderCellClick||(this.currentInfo.element=n.target,this.currentInfo.elementToFocus=n.target,t.addClass([this.currentInfo.element],["e-focused","e-focus"]));this.firstHeaderCellClick=!1;n.target&&n.target.classList.contains("e-detailcell")&&(this.currentInfo.skipAction=!1,t.addClass([this.currentInfo.element],["e-focused","e-focus"]))}},n.prototype.onBlur=function(n){var r=!(!i(n.target,"e-gantt")||!n.target.classList.contains("e-rowcell")||t.isNullOrUndefined(n.target.nextElementSibling)||!n.target.nextElementSibling.classList.contains("e-rowcell"));(this.parent.isEdit||n&&(!n.relatedTarget||t.closest(n.relatedTarget,".e-grid"))&&(!this.parent.element.classList.contains("e-childgrid")||this.parent.element.matches(":focus-within")))&&(r||!t.isNullOrUndefined(n.relatedTarget)||0!==parseInt(n.target.getAttribute("data-colindex"),10)||0!==parseInt(n.target.getAttribute("index"),10))&&(r||!t.isNullOrUndefined(n.relatedTarget)||t.closest(document.activeElement,".e-grid")||t.isNullOrUndefined(n.sourceCapabilities))||(this.removeFocus(),this.skipFocus=!0,this.currentInfo.skipAction=!1,this.setLastContentCellTabIndex(),this.setFirstFocusableTabIndex(),this.firstHeaderCellClick=!1)},n.prototype.setFirstFocusableTabIndex=function(){var n=this.parent,r,f,e,u,i;(n.element.tabIndex=-1,n.allowGrouping&&n.groupSettings.showDropArea)?(r=n.groupModule,f=r.getFocusableGroupedItems(),f.length>0?(r.element.tabIndex=-1,f[0].tabIndex=0):r.element.tabIndex=0):n.toolbar||n.toolbarTemplate?(e=n.toolbarModule.element,u=this.parent.toolbarModule.getFocusableToolbarItems(),u.length>0&&u[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input")?(e.tabIndex=-1,u[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").tabIndex=0):e.tabIndex=0):n.getColumns().length&&(n.getHeaderContent().querySelector(".e-headercell").tabIndex=0,!this.parent.isFrozenGrid()||"Left"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==s?this.setActive(!1):this.setActive(!1,!0),!t.isNullOrUndefined(this.active))&&(i=[0,0],0===this.active.matrix.matrix[i[0]][i[1]]&&(i=yr(this.active.matrix.matrix,i,!0)),this.active.matrix.current=i)},n.prototype.setLastContentCellTabIndex=function(){var n=this.parent.getContentTable();n.rows[n.rows.length-1]&&(n.rows[n.rows.length-1].lastElementChild.tabIndex=0)},n.prototype.onClick=function(n,r){var u,o,f,e,h;if((!i(n.target,"e-filterbarcell")||!i(n.target,"e-multiselect")&&!n.target.classList.contains("e-input-group-icon"))&&(u=!t.isNullOrUndefined(t.closest(n.target,"."+ot)),o=!t.isNullOrUndefined(t.closest(n.target,"."+ct)),u=u&&o?!u:u,f=!t.isNullOrUndefined(t.closest(n.target,"."+wi))||!t.isNullOrUndefined(t.closest(n.target,"."+fr)),e=!1,this.parent.getFrozenMode()===s&&(e=!t.isNullOrUndefined(t.closest(n.target,".e-frozen-right-content"))||!t.isNullOrUndefined(t.closest(n.target,".e-frozen-right-header")),f=f&&!e),!(!u&&t.isNullOrUndefined(t.closest(n.target,"."+ct))||n.target.classList.contains(ft))&&t.isNullOrUndefined(t.closest(n.target,".e-unboundcell"))))if(this.setActive(u,f,e),u||!t.isNullOrUndefined(t.closest(n.target,"."+ct))){if(h={cancel:!1,byKey:!1,byClick:!t.isNullOrUndefined(n.target),clickArgs:n},this.parent.notify(pf,h),!h.cancel&&!t.closest(n.target,".e-inline-edit")&&(this.setActive(u,f,e),this.getContent())){if(!1===this.getContent().onClick(n,r))return;this.parent.isFrozenGrid()&&o&&n.target===this.parent.getHeaderContent().firstChild&&-1===this.active.matrix.current[0]&&this.active.matrix.current[1]===this.active.matrix.columns&&(this.active.matrix.current=[0,0]);this.focus()}}else this.clearOutline()},n.prototype.onKeyPress=function(n){var c=this.parent.isFrozenGrid(),tt,f,r,w,it,rt,b,ut,l,k,v,ft,d,g,o,h,nt,u,p;if(this.parent.allowPaging){if(tt=this.parent.pagerModule.pagerObj.element,f=this.parent.pagerModule.pagerObj.getFocusablePagerElements(tt,[]),this.parent.childGrid&&this.allowToPaging(n)&&f.length&&(f[0].tabIndex=0),this.parent.pagerModule.pagerObj.checkPagerHasFocus()){if("shiftTab"===n.action&&f.length&&f[0]===n.target)return this.setActive(!0),r=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1],0===this.active.matrix.matrix[r[0]][r[1]]&&(r=yr(this.active.matrix.matrix,r,!1)),this.active.matrix.current="Batch"===this.parent.editSettings.mode?this.isValidBatchEditCell(r)?r:this.findBatchEditCell(r,!1):r,n.preventDefault(),void this.focus(n);if("tab"!==n.action||!this.parent.element.classList.contains("e-childgrid")||(this.parent.pageSettings.pageSizes||!f.length||f[f.length-1]!==n.target)&&this.parent.pagerModule.pagerObj.getDropDownPage()!==n.target)return void this.parent.pagerModule.pagerObj.changePagerFocus(n);w=i(this.parent.element,"e-detailcell");t.removeClass([this.parent.element],["e-focus"]);t.removeClass([w],["e-focused"]);w.tabIndex=-1}if(0===this.parent.pagerModule.pagerObj.element.tabIndex&&(38===n.keyCode||n.shiftKey&&9===n.keyCode))return n.preventDefault(),void this.focus(n);if(0===this.parent.pagerModule.pagerObj.element.tabIndex&&9===n.keyCode)return n.preventDefault(),void this.parent.pagerModule.pagerObj.setPagerFocus();this.parent.pagerModule.pagerObj.checkFirstPagerFocus()&&(it=this.getContent().matrix.rows,rt=this.getContent().matrix.columns,this.getContent().matrix.current=[it,rt])}if(!this.skipOn(n)){if(n.target&&i(n.target,"e-gridcontent")&&!c&&(b=[].slice.call(this.parent.getContentTable().rows),ut=b[b.length-1].lastElementChild,n.target===ut&&(this.setActive(!0),this.setLastContentCellActive())),"shiftTab"===n.action&&n.target&&(n.target===this.parent.element||i(n.target,"e-toolbar")||i(n.target,"e-groupdroparea"))){if(n.target===this.parent.element)return void(this.parent.element.classList.contains("e-childgrid")&&this.focusOutFromChildGrid(n));if(i(n.target,"e-groupdroparea"))return void(this.parent.element.classList.contains("e-childgrid")&&(n.preventDefault(),this.parent.element.focus()));if(i(n.target,"e-toolbar")){this.parent.allowGrouping&&this.parent.groupSettings.showDropArea?(l=(v=this.parent.groupModule).getFocusableGroupedItems(),n.preventDefault(),l.length>0?l[l.length-1].focus():v.element.focus()):this.parent.element.classList.contains("e-childgrid")&&(n.preventDefault(),this.parent.element.focus());return}}if(k=!1,"tab"===n.action&&n.target&&(n.target===this.parent.element||i(n.target,"e-toolbar")||i(n.target,"e-groupdroparea"))){if(this.parent.allowGrouping&&this.parent.groupSettings.showDropArea&&(n.target===this.parent.element||n.target.classList.contains("e-groupdroparea"))){if((l=(v=this.parent.groupModule).getFocusableGroupedItems()).length>0)return n.preventDefault(),void l[0].focus();if(!n.target.classList.contains("e-groupdroparea"))return n.preventDefault(),void v.element.focus()}if((this.parent.toolbar||this.parent.toolbarTemplate)&&(n.target===this.parent.element||i(n.target,"e-groupdroparea")||n.target.classList.contains("e-toolbar"))){if(ft=this.parent.toolbarModule.element,d=this.parent.toolbarModule.getFocusableToolbarItems(),d.length>0)return n.preventDefault(),void d[0].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").focus();if(!n.target.classList.contains("e-toolbar"))return n.preventDefault(),void ft.focus()}(n.target===this.parent.element||i(n.target,"e-toolbar")||i(n.target,"e-groupdroparea"))&&(k=!0)}if(k&&(!c||"Left"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==s?this.parent.allowGrouping&&this.parent.groupSettings.columns.length===this.parent.columns.length?this.setActive(!0):this.setActive(!1):this.setActive(!1,!0),this.active.matrix.current=[0,-1]),this.activeKey=n.action,g={cancel:!1,byKey:!0,byClick:!1,keyArgs:n},this.parent.notify(pf,g),!g.cancel){var e=this.getContent().matrix.current,y=this.getActiveName(),a=this.active&&this.active.matrix.current?[this.active.matrix.current[0],this.active.matrix.current[1]]:void 0;if(this.currentInfo.outline=!0,o=this.getContent().jump(n.action,e),this.swap=o,o.swap&&(!c||"Batch"!==this.parent.editSettings.mode||"tab"!==n.action&&"shiftTab"!==n.action)&&(this.setActive(!o.toHeader,o.toFrozen,o.toFrozenRight),this.getContent().matrix.current=this.getContent().getNextCurrent(e,o,this.active,n.action),this.prevIndexes={}),this.setActiveByKey(n.action,this.getContent()),h=c&&"Batch"===this.parent.editSettings.mode&&n.target&&("tab"===n.action||"shiftTab"===n.action)&&(i(n.target,"e-gridheader")||i(n.target,"e-gridcontent"))?void 0:!this.content.lastIdxCell&&this.getContent().onKeyPress(n),n.target&&i(n.target,"e-gridheader"))if(c){if("Batch"!==this.parent.editSettings.mode||"tab"!==n.action&&"shiftTab"!==n.action||this.setFrozenBatchEditCell(y,a,"tab"===n.action),"shiftTab"===n.action&&e.toString()===this.active.matrix.current.toString()&&!o.swap&&("Batch"!==this.parent.editSettings.mode||this.getActiveName()===y))return void this.focusOutFromHeader(n)}else if("tab"===n.action&&e.toString()===this.active.matrix.current.toString()&&(nt=yr(this.active.matrix.matrix,this.active.matrix.current,!0),(r=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1],0===this.active.matrix.matrix[r[0]][r[1]]&&(r=yr(this.active.matrix.matrix,r,!1)),this.active.matrix.current.toString()===r.toString())?(h=!0,this.setActive(!0),u=[0,0],0===this.active.matrix.matrix[u[0]][u[1]]&&(u=yr(this.active.matrix.matrix,[0,0],!0)),this.active.matrix.current="Batch"===this.parent.editSettings.mode?this.isValidBatchEditCell(u)?u:this.findBatchEditCell(u,!0):u):this.active.matrix.current.toString()!==nt.toString()&&(this.active.matrix.current=nt)),"shiftTab"===n.action&&e.toString()===this.active.matrix.current.toString()){if(p=yr(this.active.matrix.matrix,this.active.matrix.current,!1),p.toString()===this.active.matrix.current.toString())return void this.focusOutFromHeader(n);this.active.matrix.current.toString()===p.toString()||h||(h=!0,this.active.matrix.current=p)}if(n.target&&i(n.target,"e-gridcontent"))if(c)"Batch"!==this.parent.editSettings.mode||"tab"!==n.action&&"shiftTab"!==n.action||(this.setFrozenBatchEditCell(y,a,"tab"===n.action),"tab"===n.action&&a.toString()===this.active.matrix.current.toString()&&this.getActiveName()===y&&(this.parent.editModule.editModule.addBatchRow=!0));else if("Batch"!==this.parent.editSettings.mode||"tab"!==n.action&&"shiftTab"!==n.action||(this.active.matrix.current=this.findBatchEditCell(a,"tab"===n.action),"tab"===n.action&&a.toString()===this.active.matrix.current.toString()&&(this.parent.editModule.editModule.addBatchRow=!0)),"shiftTab"===n.action&&e.toString()===this.active.matrix.current.toString()){if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length===this.parent.columns.length)return void this.focusOutFromHeader(n);u=[0,0];0===this.active.matrix.matrix[u[0]][u[1]]&&(u=yr(this.active.matrix.matrix,[0,0],!0));h||u.toString()!==this.active.matrix.current.toString()&&("Batch"!==this.parent.editSettings.mode||a.toString()!==this.active.matrix.current.toString())||(h=!0,this.setActive(!1),this.setLastContentCellActive())}if(!1!==h)n.preventDefault(),this.focus(n);else{if(this.clearIndicator(),"shiftTab"===n.action&&e.toString()===[0,0].toString()&&(this.parent.element.tabIndex=-1),this.parent.allowPaging&&!this.parent.pagerModule.pagerObj.checkPagerHasFocus()&&this.allowToPaging(n)&&e.toString()!==[0,0].toString()){if(n.preventDefault(),40===n.keyCode)return void this.parent.pagerModule.pagerObj.setPagerContainerFocus();if(9===n.keyCode)return void this.parent.pagerModule.pagerObj.setPagerFocus()}this.parent.element.classList.contains("e-childgrid")&&this.focusOutFromChildGrid(n)}}}},n.prototype.isValidBatchEditCell=function(n){var i=this.active.getTable().rows[n[0]].cells[n[1]],r=t.closest(i,"tr"),f=parseInt(i.getAttribute("data-colindex"),10),u=this.parent.getColumns()[parseInt(f.toString(),10)];return!((1!==this.active.matrix.matrix[n[0]][n[1]]||!r.classList.contains("e-insertedrow")&&u.isPrimaryKey||!u.allowEditing)&&r.classList.contains("e-row"))},n.prototype.findBatchEditCell=function(n,t,i){for(var f,e=n,r=n,u=!1;!u;)f=r,r=yr(this.active.matrix.matrix,r,t),f.toString()===r.toString()||i&&f[0]!==r[0]?u=!0:this.isValidBatchEditCell(r)&&(e=r,u=!0);return e},n.prototype.setFrozenBatchEditCell=function(n,t,i,r){var f,k=this.parent,h=!1,a,b;if((f=void 0!==r?[r,i?0:this.active.matrix.matrix[parseInt(r.toString(),10)].length-1]:i?[t[0],t[1]+1]:[t[0],t[1]-1],this.active.matrix.matrix[f[0]]&&this.active.matrix.matrix[f[0]][f[1]])?this.isValidBatchEditCell(f)?this.active.matrix.current=f:(a=f,f=this.findBatchEditCell(f,i,!0),a.toString()===f.toString()?h=!0:this.active.matrix.current=f):h=!0,h){var u=this.getActiveName(),e=k.getFrozenMode(),c=f[0],v=c-1,y=c+1,o=!i&&-1===v,s=i&&y>this.active.matrix.matrix.length-1;if(("FrozenLeftHeader"===u||"Movableheader"===u&&"Right"===e)&&o||("FrozenRightContent"===u||"MovableContent"===u&&"Left"===e)&&s)this.setActiveByName(n),this.active.matrix.current=t;else{var l="Left-Right"===e&&i,p="Left"===e&&s,d="Left"===e&&i,g="Right"===e&&!i,w="Right"===e&&o,nt="Movableheader"===u&&p||"FrozenRightHeader"===u&&s||"FrozenLeftContent"===u&&!o||"MovableContent"===u&&!w||"FrozenRightContent"===u,tt=("Movableheader"===u||"MovableContent"===u)&&!l||("FrozenRightHeader"===u||"FrozenRightContent"===u)&&l,it=("FrozenLeftHeader"===u||"FrozenLeftContent"===u)&&"Left-Right"===e&&!i||("Movableheader"===u||"MovableContent"===u)&&l;this.setActive(nt,tt,it);b="Movableheader"===u&&p||"FrozenRightHeader"===u&&s?0:("Movableheader"===u||"MovableContent"===u)&&d||("FrozenRightHeader"===u||"FrozenRightContent"===u)&&i?y:"FrozenLeftContent"===u&&o||"MovableContent"===u&&w?this.active.matrix.matrix.length-1:("FrozenLeftHeader"===u||"FrozenLeftContent"===u)&&!i||("Movableheader"===u||"MovableContent"===u)&&g?v:c;this.setFrozenBatchEditCell(n,t,i,b)}}},n.prototype.getActiveName=function(){var t,n;return this.active&&(n=this.active.getTable(),t=i(n,"e-frozen-left-header")?"FrozenLeftHeader":i(n,"e-movableheader")?"Movableheader":i(n,"e-frozen-right-header")?"FrozenRightHeader":i(n,"e-frozen-left-content")?"FrozenLeftContent":i(n,"e-movablecontent")?"MovableContent":i(n,"e-frozen-right-content")?"FrozenRightContent":void 0),t},n.prototype.setActiveByName=function(n){var t=this.parent.getFrozenMode();switch(n){case"FrozenLeftHeader":this.setActive(!1,!0);break;case"Movableheader":this.setActive(!1);break;case"FrozenRightHeader":this.setActive(!1,"Right"===t,"Right"!==t);break;case"FrozenLeftContent":this.setActive(!0,!0);break;case"MovableContent":this.setActive(!0);break;case"FrozenRightContent":this.setActive(!0,"Right"===t,"Right"!==t)}},n.prototype.setLastContentCellActive=function(){var n=[this.active.matrix.matrix.length-1,this.active.matrix.matrix[this.active.matrix.matrix.length-1].length-1];0===this.active.matrix.matrix[n[0]][n[1]]&&(n=yr(this.active.matrix.matrix,n,!1));this.active.matrix.current=n},n.prototype.focusOutFromChildGrid=function(n){var c=i(this.parent.element,"e-table"),u=i(c,"e-grid").ej2_instances[0],h=i(this.parent.element,"e-detailcell"),l=i(this.parent.element,"e-detailrow").getAttribute("data-uid"),o=[].slice.call(u.getContentTable().rows),f=o.map(function(n){return n.getAttribute("data-uid")}).indexOf(l),r,s,e;if(!("tab"===n.action&&f>=o.length-1)){if(t.removeClass([this.parent.element],["e-focus"]),t.removeClass([h],["e-focused"]),h.tabIndex=-1,n.preventDefault(),u.focusModule.removeFocus(),"shiftTab"===n.action){for(s=o[f-1].cells,e=s.length-1;e>=0;e--)if(!(r=s[parseInt(e.toString(),10)]).classList.contains("e-hide")){u.focusModule.active.matrix.current=[f-1,e];break}}else r=o[f+1].cells[0],u.focusModule.active.matrix.current=[f+1,0];u.focusModule.currentInfo.element=r;u.focusModule.currentInfo.elementToFocus=r;t.addClass([r],["e-focused","e-focus"]);r.tabIndex=0;r.focus()}},n.prototype.focusOutFromHeader=function(n){var u,t,r,i;if(this.removeFocus(),this.parent.toolbar||this.parent.toolbarTemplate)return u=this.parent.toolbarModule.element,t=this.parent.toolbarModule.getFocusableToolbarItems(),n.preventDefault(),void(t.length>0?t[t.length-1].querySelector(".e-toolbar-item-focus,.e-btn,.e-input").focus():u.focus());if(this.parent.allowGrouping&&this.parent.groupSettings.showDropArea)return r=this.parent.groupModule,i=r.getFocusableGroupedItems(),n.preventDefault(),void(i.length>0?i[i.length-1].focus():r.element.focus());this.parent.element.classList.contains("e-childgrid")&&(n.preventDefault(),this.parent.element.focus())},n.prototype.allowToPaging=function(n){return"Batch"!==this.parent.editSettings.mode||!this.parent.editSettings.allowAdding||40===n.keyCode},n.prototype.skipOn=function(n){var r=n.target,e,u,h,f,o,s;return r?this.currentInfo.skipAction?(this.clearIndicator(),!0):["pageUp","pageDown","altDownArrow"].indexOf(n.action)>-1?(this.clearIndicator(),!0):this.parent.allowGrouping&&(e=this.parent.groupModule.getFocusableGroupedItems(),i(n.target,"e-groupheadercell")&&!(n.target===e[0]&&"shiftTab"===n.action||n.target===e[e.length-1]&&"tab"===n.action))?!0:(this.parent.toolbar||this.parent.toolbarTemplate)&&(u=this.parent.toolbarModule.element.querySelectorAll(".e-toolbar-item:not(.e-overlay):not(.e-hidden)"),i(n.target,"e-toolbar-item")&&!(u.length>0&&(i(n.target,"e-toolbar-item")===u[0]&&"shiftTab"===n.action||i(n.target,"e-toolbar-item")===u[u.length-1]&&"tab"===n.action)))?!0:(h=t.closest(r,"th")&&!t.closest(r,"th").tabIndex,n.target.classList.contains("e-filterbaroperator")&&(13===n.keyCode||27===n.keyCode)&&t.closest(n.target,".e-filterbarcell").querySelector("input").focus(),h&&null!==t.closest(document.activeElement,".e-filterbarcell")&&this.removeFocus(),f=null!==t.closest(document.activeElement,".e-filterbarcell"),this.parent.enableHeaderFocus&&f&&(o=this.active.matrix,s=o.current,f=o.matrix[s[0]].lastIndexOf(1)!==s[1]),"delete"===n.action||"Batch"!==this.parent.editSettings.mode&&(this.parent.isEdit||["insert","f2"].indexOf(n.action)>-1)||f&&this.parent.enableHeaderFocus||f&&"tab"!==n.action&&"shiftTab"!==n.action||null!==t.closest(document.activeElement,"#"+this.parent.element.id+"_searchbar")&&["enter","leftArrow","rightArrow","shiftLeft","shiftRight","ctrlPlusA"].indexOf(n.action)>-1||null===t.closest(r,"."+ot)&&null===t.closest(r,"."+ct)&&!(n.target===this.parent.element||i(n.target,"e-toolbar")||i(n.target,"e-groupdroparea"))||"space"===n.action&&!r.classList.contains(rf)&&null===t.closest(r,"."+rf)&&null===t.closest(r,".e-headerchkcelldiv")||null!==t.closest(r,".e-filter-popup")):!1},n.prototype.focusVirtualElement=function(n){var u=this,t,i,r;(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&(t={virtualData:{},isAdd:!1,isCancel:!1},this.parent.notify(iu,t),i=this.actions.some(function(n){return n===u.activeKey}),r=!!this.parent.contentModule&&this.parent.contentModule.selectedRowIndex>-1,t.isAdd||Object.keys(t.virtualData).length||i||t.isCancel||r?(this.parent.notify(lw,{isCancel:!1}),t.isCancel=!1,this.parent.contentModule.selectedRowIndex=-1,i&&(this.activeKey=this.empty,this.parent.notify("virtaul-key-handler",n)),this.currentInfo.elementToFocus.focus({preventScroll:!0})):this.isVirtualScroll||this.isInfiniteScroll?this.currentInfo.elementToFocus.focus({preventScroll:!0}):this.currentInfo.elementToFocus.focus());this.isVirtualScroll=this.isInfiniteScroll=!1},n.prototype.getFocusedElement=function(){return this.currentInfo.elementToFocus},n.prototype.getContent=function(){return this.active||this.content},n.prototype.setActive=function(n,t,i){this.active=n?t?this.fContent:i?this.frContent:this.content:t?this.fHeader:i?this.frHeader:this.header},n.prototype.setFocusedElement=function(n,i){var r=this;this.currentInfo.elementToFocus=n;setTimeout(function(){t.isNullOrUndefined(r.currentInfo.elementToFocus)||(r.parent.enableVirtualization||r.parent.enableInfiniteScrolling?r.focusVirtualElement(i):r.currentInfo.elementToFocus.focus())},0)},n.prototype.focus=function(n){this.parent.notify(dp,n);this.removeFocus();this.addFocus(this.getContent().getFocusInfo(),n)},n.prototype.removeFocus=function(){this.currentInfo.element&&(t.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focused","e-focus"]),this.currentInfo.element.tabIndex=-1)},n.prototype.addOutline=function(){var n=this.getContent().getFocusInfo();n.element&&(t.addClass([n.element],["e-focused"]),t.addClass([n.elementToFocus],["e-focus"]))},n.prototype.focusHeader=function(){this.setActive(!1,this.parent.isFrozenGrid());this.resetFocus()},n.prototype.focusContent=function(){this.setActive(!0,this.parent.isFrozenGrid());this.resetFocus()},n.prototype.resetFocus=function(){var n=this.getContent().matrix.get(0,-1,[0,1],null,this.getContent().validator());this.getContent().matrix.select(n[0],n[1]);this.focus()},n.prototype.addFocus=function(n,i){var r;if((this.currentInfo=n,this.currentInfo.outline=n.outline&&(!t.isNullOrUndefined(i)||this.isVirtualScroll),this.isInfiniteScroll&&(this.currentInfo.outline=!0),n.element)&&(r=n.elementToFocus.classList.contains("e-focus"),!r)){this.currentInfo.outline&&t.addClass([n.element],["e-focused"]);t.addClass([n.elementToFocus],["e-focus"]);n.element.tabIndex=0;r||this.setFocusedElement(n.elementToFocus,i);this.parent.notify(us,{element:n.elementToFocus,parent:n.element,indexes:this.getContent().matrix.current,byKey:!t.isNullOrUndefined(i),byClick:t.isNullOrUndefined(i),keyArgs:i,isJump:this.swap.swap,container:this.getContent().getInfo(i),outline:!t.isNullOrUndefined(i),swapInfo:this.swap});var u=this.getContent().matrix.current,e=u[0],f=u[1];this.prevIndexes={rowIndex:e,cellIndex:f};this.focusedColumnUid=this.parent.getColumnByIndex(f).uid;this.focusByClick=!1}},n.prototype.refreshMatrix=function(n){var i=this;return function(r){var a,u,v,y,p,w,e,c,h;n&&r.args&&r.args.isFrozen&&!i.fContent?i.fContent=new lst(i.parent):n&&!i.frContent&&r.args&&r.args.renderFrozenRightContent?i.frContent=new vst(i.parent):n&&!i.content&&(i.content=new ga(i.parent));!n&&r.args&&r.args.isFrozen&&!i.fHeader?i.fHeader=new ast(i.parent):!n&&r.args&&r.args.renderFrozenRightContent&&!i.frHeader?i.frHeader=new yst(i.parent):n||i.header||(i.header=new gw(i.parent));var f=n?r.args&&r.args.isFrozen?i.fContent:r.args&&r.args.renderFrozenRightContent?i.frContent:i.content:r.args&&r.args.isFrozen?i.fHeader:r.args&&r.args.renderFrozenRightContent?i.frHeader:i.header,o=n?r.rows.slice(i.parent.frozenRows):r.rows,l=n?r.rows.slice(0,i.parent.frozenRows):r.rows;i.parent.isCollapseStateEnabled()&&n&&(o=o.filter(function(n){return!1!==n.visible}));u=!t.isNullOrUndefined(i.parent.rowTemplate);v=f.matrix.generate(l,f.selector,u);"batchAdd"===r.name&&i.parent.isFrozenGrid()?(y=i.parent.getMovableRowsObject().slice(i.parent.frozenRows).map(function(n){return n.clone()}),p=o.map(function(n){return n.clone()}),(i.fContent.matrix.generate(p,i.fContent.selector,u),i.content.matrix.generate(y,i.content.selector,u),i.parent.getFrozenMode()===s)&&(w=i.parent.getFrozenRightRowsObject().slice(i.parent.frozenRows).map(function(n){return n.clone()}),i.frContent.matrix.generate(w,i.frContent.selector,u))):f.matrix.generate(o,f.selector,u);(i.parent.isFrozenGrid()&&(r.args&&("sorting"===r.args.requestType||"batchsave"===r.args.requestType||"paging"===r.args.requestType)||"batchAdd"===r.name||"batchCancel"===r.name)||f.generateRows(l,{matrix:v,handlerInstance:r.args&&r.args.isFrozen?i.fHeader:r.args&&r.args.renderFrozenRightContent?i.frHeader:i.header}),!t.Browser.isDevice&&r&&r.args&&(i.focusByClick||"paging"!==r.args.requestType||i.parent.pagerModule.pagerObj.checkPagerHasFocus()||(i.skipFocus=!1,i.parent.element.focus()),"grouping"===r.args.requestType&&(i.skipFocus=!0)),r&&r.args&&"virtualscroll"===r.args.requestType)&&(i.currentInfo.uid?r.rows.some(function(n,t){return a=t,n.uid===i.currentInfo.uid})&&(i.content.matrix.current[0]=a,i.content.matrix.current[1]=i.parent.getColumnIndexByUid(i.focusedColumnUid)||0,h=i.getContent().getFocusInfo().elementToFocus)&&(e=h.getBoundingClientRect(),c=i.parent.element.getBoundingClientRect(),e.top>=0&&e.left>=0&&e.right<=Math.min(c.right,window.innerWidth||document.documentElement.clientWidth)&&e.bottom<=Math.min(c.bottom,window.innerHeight||document.documentElement.clientHeight)&&(i.isVirtualScroll=!0,i.focus())):r.args.focusElement&&r.args.focusElement.classList.contains("e-filtertext")&&(h=i.parent.element.querySelector("#"+r.args.focusElement.id))&&h.focus());r&&r.args&&"infiniteScroll"===r.args.requestType&&(i.isInfiniteScroll=!0)}},n.prototype.addEventListener=function(){var n=this;this.parent.isDestroyed||(t.EventHandler.add(this.parent.element,"mousedown",this.focusCheck,this),t.EventHandler.add(this.parent.element,"touchstart",this.focusCheck,this),t.EventHandler.add(this.parent.element,"focus",this.onFocus,this),this.parent.element.addEventListener("focus",this.passiveHandler=function(t){return n.passiveFocus(t)},!0),t.EventHandler.add(this.parent.element,"focusout",this.onBlur,this),this.evtHandlers=[{event:ht,handler:this.onKeyPress},{event:ii,handler:this.onClick},{event:it,handler:this.refMatrix},{event:de,handler:this.refMatrix},{event:wr,handler:this.refMatrix},{event:yt,handler:this.refreshMatrix()},{event:cw,handler:this.restoreFocus},{event:tf,handler:this.restoreFocus},{event:"start-edit",handler:this.clearIndicator},{event:"start-add",handler:this.clearIndicator},{event:"sorting-complete",handler:this.restoreFocus},{event:"filtering-complete",handler:this.filterfocus},{event:"grouping-complete",handler:this.restoreFocusWithAction},{event:"ungrouping-complete",handler:this.restoreFocusWithAction},{event:du,handler:this.refMatrix},{event:pr,handler:this.refMatrix},{event:ts,handler:this.refMatrix},{event:ac,handler:this.refMatrix},{event:vi,handler:this.refMatrix},{event:us,handler:this.internalCellFocus}],vt(this.parent,this.evtHandlers,!0,this))},n.prototype.filterfocus=function(){"FilterBar"!==this.parent.filterSettings.type&&this.restoreFocus()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(t.EventHandler.remove(this.parent.element,"mousedown",this.focusCheck),t.EventHandler.remove(this.parent.element,"touchstart",this.focusCheck),t.EventHandler.remove(this.parent.element,"focus",this.onFocus),t.EventHandler.remove(this.parent.element,"focusout",this.onBlur),this.parent.element.removeEventListener("focus",this.passiveHandler,!0),vt(this.parent,this.evtHandlers,!1))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.restoreFocus=function(){var n=this.parent.groupModule;if(this.parent.allowGrouping&&n&&(n.groupSortFocus||n.groupTextFocus))return n.groupSortFocus=!1,void(n.groupTextFocus=!1);this.firstHeaderCellClick=!0;this.addFocus(this.getContent().getFocusInfo())},n.prototype.restoreFocusWithAction=function(n){var f,i,r,u;if(!this.parent.enableInfiniteScrolling){f=this.getContent().matrix;i=f.current;switch(n.requestType){case"grouping":case"ungrouping":i[1]=!i.length||this.parent.groupSettings.showGroupedColumn||t.isNullOrUndefined(f.matrix[i[0]])?"grouping"===n.requestType?i[1]+1:i[1]-1:f.matrix[i[0]].indexOf(1)}if(this.getContent().matrix.current=i,r=this.parent.groupModule,this.parent.allowGrouping&&r&&r.groupCancelFocus)return u=r.getFocusableGroupedItems(),u.length?u[0].parentElement.getAttribute("ej-mappingname")===n.columnName?u[3].focus():u[0].focus():r.element.focus(),void(r.groupCancelFocus=!1);this.addFocus(this.getContent().getFocusInfo())}},n.prototype.clearOutline=function(){this.getContent().matrix.current=this.getContent().matrix.get(0,-1,[0,1],"downArrow",this.getContent().validator());this.clearIndicator()},n.prototype.clearIndicator=function(){this.currentInfo.element&&this.currentInfo.elementToFocus&&t.removeClass([this.currentInfo.element,this.currentInfo.elementToFocus],["e-focus","e-focused"])},n.prototype.getPrevIndexes=function(){var n=this.forget;return this.forget=!1,n||!Object.keys(this.prevIndexes).length?{rowIndex:null,cellIndex:null}:this.prevIndexes},n.prototype.forgetPrevious=function(){this.forget=!0},n.prototype.setActiveByKey=function(n,t){var f=this,i,r,u;(this.parent.isFrozenGrid()||0!==this.parent.frozenRows)&&(r={home:function(){return{toHeader:!i.isContent,toFrozen:!0}},end:function(){return{toHeader:!i.isContent,toFrozen:!1}},ctrlHome:function(){return{toHeader:!0,toFrozen:f.parent.isFrozenGrid()}},ctrlEnd:function(){return{toHeader:!1,toFrozen:!1}}},n in r&&(i=t.getInfo(),u=r[""+n](),this.setActive(!u.toHeader,u.toFrozen),this.getContent().matrix.current=t.matrix.current))},n.prototype.internalCellFocus=function(n){if(n.byKey&&n.container.isContent&&"enter"===n.keyArgs.action&&(n.parent.classList.contains("e-detailcell")||n.parent.classList.contains("e-unboundcell"))){this.clearIndicator();var t=this.getContent().getFocusable(this.getFocusedElement());this.setFocusedElement(t);this.currentInfo.skipAction=!0}},n}(),cst=function(){function n(){this.matrix=[];this.current=[]}return n.prototype.set=function(n,t,i){n=Math.max(0,Math.min(n,this.rows));t=Math.max(0,Math.min(t,this.columns));this.matrix[parseInt(n.toString(),10)]=this.matrix[parseInt(n.toString(),10)]||[];this.matrix[parseInt(n.toString(),10)][parseInt(t.toString(),10)]=i?1:0},n.prototype.get=function(n,i,r,u,f){var e=i,h,o,c,s;if(n+r[0]<0)return[n,i];if(n=Math.max(0,Math.min(n+r[0],this.rows)),h=!0,t.isNullOrUndefined(this.matrix[parseInt(n.toString(),10)]))return null;if(i=Math.max(0,Math.min(i+r[1],this.matrix[parseInt(n.toString(),10)].length-1)),e+r[1]>this.matrix[parseInt(n.toString(),10)].length-1&&f(n,i,u))return[n,e];if(o=this.first(this.matrix[parseInt(n.toString(),10)],i,r,!0,u),i=null===o?e:o,c=t.getValue(n+"."+i,this.matrix),n!==this.rows||"downArrow"!==u&&"enter"!==u||(r[0]=-1),null===o){for(s=0;s<this.rows;s++)if(this.matrix[parseInt(s.toString(),10)].some(function(n){return 1===n})){h=!1;break}if(h)return[n=this.current.length?this.current[0]:0,i]}return this.inValid(c)||!f(n,i,u)?this.get(n,e,r,u,f):[n,i]},n.prototype.first=function(n,t,i,r,u){return(t<0||t===n.length)&&this.inValid(n[parseInt(t.toString(),10)])&&"upArrow"!==u&&"downArrow"!==u||!n.some(function(n){return 1===n})?null:this.inValid(n[parseInt(t.toString(),10)])?this.first(n,-1!==["upArrow","downArrow","shiftUp","shiftDown"].indexOf(u)?r?0:++t:t+i[1],i,!1,u):t},n.prototype.select=function(n,t){n=Math.max(0,Math.min(n,this.rows));t=Math.max(0,Math.min(t,this.matrix[parseInt(n.toString(),10)].length-1));this.current=[n,t]},n.prototype.generate=function(n,t,i){var u,f,e,r;for(this.rows=n.length-1,this.matrix=[],u=0;u<n.length;u++){for(f=n[parseInt(u.toString(),10)].cells.filter(function(n){return!0!==n.isSpanned}),this.columns=Math.max(f.length-1,0|this.columns),e=0,r=0;r<f.length;r++)f[parseInt(r.toString(),10)].column&&f[parseInt(r.toString(),10)].column.columns?e=this.columnsCount(f[parseInt(r.toString(),10)].column.columns,e):e++,this.set(u,r,!1!==n[parseInt(u.toString(),10)].visible&&t(n[parseInt(u.toString(),10)],f[parseInt(r.toString(),10)],i));this.columns=Math.max(e-1,0|this.columns)}return this.matrix},n.prototype.columnsCount=function(n,t){for(var u=n,i=t,r=0;r<u.length;r++)u[parseInt(r.toString(),10)].columns?i=this.columnsCount(u[parseInt(r.toString(),10)].columns,i):i++;return i},n.prototype.inValid=function(n){return 0===n||void 0===n},n}(),ga=function(){function n(n){var t=this;this.matrix=new cst;this.lastIdxCell=!1;this.parent=n;this.keyActions={rightArrow:[0,1],tab:[0,1],leftArrow:[0,-1],shiftTab:[0,-1],upArrow:[-1,0],downArrow:[1,0],shiftUp:[-1,0],shiftDown:[1,0],shiftRight:[0,1],shiftLeft:[0,-1],enter:[1,0],shiftEnter:[-1,0]};this.indexesByKey=function(n){return{home:[t.matrix.current[0],-1,0,1],end:[t.matrix.current[0],t.matrix.columns+1,0,-1],ctrlHome:[0,-1,0,1],ctrlEnd:[t.matrix.rows,t.matrix.columns+1,0,-1]}[""+n]||null}}return n.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getContent().querySelector(".e-movablecontent .e-table"):this.parent.getContentTable()},n.prototype.onKeyPress=function(n){var i=this.keyActions[n.action],t=this.getCurrentFromAction(n.action,i,n.action in this.keyActions,n);if(t){if((["tab","shiftTab"].indexOf(n.action)>-1&&this.matrix.current||[]).toString()===t.toString()||this.parent.allowPaging&&!this.parent.pagerModule.pagerObj.checkPagerHasFocus()&&this.matrix.current[0]===this.matrix.rows&&("Batch"===this.parent.editSettings.mode&&this.parent.editSettings.allowAdding&&40===n.keyCode||40===n.keyCode)){if(t.toString()===[this.matrix.rows,this.matrix.columns].toString()||t.toString()===[0,0].toString()||this.matrix.current[0]===this.matrix.rows&&this.matrix.current.toString()===t.toString()||this.parent.allowGrouping&&this.parent.infiniteScrollSettings.enableCache&&t.toString()===[0,1].toString())return!1;t=this.editNextRow(t[0],t[1],n.action)}this.matrix.select(t[0],t[1])}},n.prototype.editNextRow=function(n,t,i){var r=this.parent,f=r.editSettings.allowNextRowEdit&&(r.isEdit||r.isLastCellPrimaryKey),e=r.getColumnIndexByField(r.getVisibleColumns()[0].field),u=this.getTable().rows[parseInt(n.toString(),10)].cells[parseInt(t.toString(),10)];return"tab"===i&&f&&(n++,t=e+(this.getTable().rows[parseInt(n.toString(),10)].getElementsByClassName("e-indentcell").length+this.getTable().rows[parseInt(n.toString(),10)].getElementsByClassName("e-detailrowcollapse").length)),"shiftTab"===i&&f&&(n--,t=r.getColumnIndexByField(r.getVisibleColumns()[r.getVisibleColumns().length-1].field)),u.classList.contains(a)||u.classList.contains("e-headercell")||u.classList.contains("e-groupcaption")||u.classList.contains("e-filterbarcell")?[n,t]:this.editNextRow(n,t,i)},n.prototype.getCurrentFromAction=function(n,t,i,r){var o,h,u;if(void 0===t&&(t=[0,0]),!i&&!this.indexesByKey(n)||0===this.matrix.current.length)return null;if(!this.shouldFocusChange(r))return this.matrix.current;var s=this.indexesByKey(n)||this.matrix.current.concat(t),f=s[0],e=s[1],c=s[2],l=s[3];if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&this.parent.aggregates.length&&"enter"===n)for(o=f;o<this.matrix.matrix.length;o++){if(h=this.getTable().rows[o+1],h&&h.cells[parseInt(e.toString(),10)]&&h.cells[parseInt(e.toString(),10)].classList.contains("e-rowcell"))return[o+1,e];if(o===this.matrix.matrix.length-1)return[f,e]}return("ctrlEnd"===n||"end"===n)&&(u=[this.matrix.matrix.length-1,this.matrix.matrix[this.matrix.matrix.length-1].length-1],"end"===n&&(u=[f,this.matrix.matrix[parseInt(f.toString(),10)].length-1]),0===this.matrix.matrix[u[0]][u[1]]&&(u=yr(this.matrix.matrix,u,!1)),f=u[0],e=u[1]+1),this.matrix.get(f,e,[c,l],n,this.validator())},n.prototype.onClick=function(n,r){var u=n.target;if(this.target=u,u=(u=u.classList.contains(a)?u:t.closest(u,"td"))||t.closest(n.target,"td.e-detailrowcollapse")||t.closest(n.target,"td.e-detailrowexpand"),!(u=(u=t.closest(n.target,"td.e-detailcell")&&t.isNullOrUndefined(t.closest(t.closest(n.target,".e-grid"),"td.e-detailcell"))?null:u)&&t.closest(u,"table").classList.contains(k)?u:null))return!1;var o=[u.parentElement.rowIndex,u.cellIndex],f=o[0],e=o[1],s=this.matrix.current,h=s[0],c=s[1],l=t.getValue(f+"."+e,this.matrix.matrix);if(this.matrix.inValid(l)||!r&&h===f&&c===e||!i(n.target,a)&&!i(n.target,"e-groupcaption")&&!i(n.target,"e-recordpluscollapse")&&!i(n.target,"e-recordplusexpand")&&!i(n.target,"e-detailrowcollapse")&&!i(n.target,"e-detailrowexpand")&&!i(n.target,"e-templatecell"))return!1;this.matrix.select(f,e)},n.prototype.getFocusInfo=function(){var n={},r=this.matrix.current,u=r[0],i=void 0===u?0:u,f=r[1],e=void 0===f?0:f;return this.matrix.current=[i,e],n.element=t.isNullOrUndefined(this.getTable().rows[parseInt(i.toString(),10)])?null:this.getTable().rows[parseInt(i.toString(),10)].cells[parseInt(e.toString(),10)],n.element?(n.elementToFocus=n.element.classList.contains("e-unboundcell")||n.element.classList.contains("e-detailcell")?n.element:this.getFocusable(n.element),n.elementToFocus=n.element.classList.contains("e-detailcell")&&n.element.querySelector(".e-childgrid")?n.element.querySelector(".e-childgrid"):n.elementToFocus,n.outline=!0,n.uid=n.element.parentElement.getAttribute("data-uid"),n):n},n.prototype.getFocusable=function(n){var r='button, [href], input:not([type="hidden"]), select, textarea, [tabindex]:not([tabindex="-1"])',u=!t.isNullOrUndefined(t.closest(n,".e-templatecell")),i;return this.parent.isEdit&&(r='input:not([type="hidden"]), select:not([aria-hidden="true"]), textarea'),i=[].slice.call(n.querySelectorAll(r)),i.length?u&&i.length>1?this.target?this.target:n:i[0]:n},n.prototype.selector=function(n,i,r){var u=[o.Expand,o.GroupCaption,o.CaptionSummary,o.GroupSummary];return(n.isDataRow&&i.visible&&(i.isDataCell||i.isTemplate)||n.isDataRow&&i.cellType===o.DetailExpand&&t.isNullOrUndefined(i.visible)||!n.isDataRow&&u.indexOf(i.cellType)>-1&&!!(i.cellType!==o.GroupSummary&&i.cellType!==o.CaptionSummary||i.isDataCell&&i.visible)||i.column&&i.visible&&"checkbox"===i.column.type||i.cellType===o.CommandColumn||n.isDataRow&&r)&&!("delete"===n.edit&&n.isDirty)},n.prototype.nextRowFocusValidate=function(n){for(var i=n,t=n,r=this.matrix.rows;t<=r;t++){if(-1!==this.matrix.matrix[parseInt(n.toString(),10)].indexOf(1))return n;n+=1}return this.lastIdxCell=!0,i},n.prototype.previousRowFocusValidate=function(n){for(var t=n,i=n;i>=0;i--){if(-1!==this.matrix.matrix[parseInt(n.toString(),10)].indexOf(1))return n;if((n-=1)<0)return this.lastIdxCell=!0,t}return t},n.prototype.jump=function(n,t){var i=this.parent.getFrozenLeftCount()&&("leftArrow"===n||"shiftTab"===n)&&0===t[1]||t[0]<this.matrix.matrix.length-1&&"tab"===n&&"Left"===this.parent.getFrozenMode()&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),e=("rightArrow"===n||"tab"===n)&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1)||"shiftTab"===n&&"Right"===this.parent.getFrozenMode()&&t[1]===this.matrix.matrix[t[0]].indexOf(1),o=this.parent.getFrozenMode()===s&&e,r,c,u,f;return"Right"===this.parent.getFrozenMode()&&(i=e),this.lastIdxCell=!1,r=0!==this.parent.frozenRows&&"shiftEnter"===n,c=("upArrow"===n||r)&&0===t[0]||"shiftTab"===n&&"Right"===this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1),this.parent.isFrozenGrid()||"tab"!==n||t[1]!==this.matrix.matrix[t[0]].lastIndexOf(1)||this.matrix.matrix.length-1===t[0]||(this.matrix.current[0]=this.nextRowFocusValidate(this.matrix.current[0]+1),this.matrix.current[1]=-1,i=this.parent.isFrozenGrid()),this.parent.isFrozenGrid()||"shiftTab"!==n||0===t[0]||this.matrix.matrix[t[0]].indexOf(1)!==t[1]||(this.matrix.current[0]=this.previousRowFocusValidate(this.matrix.current[0]-1),this.matrix.current[1]=this.matrix.matrix[t[0]].length),u=!1,f=document.activeElement.parentElement,(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&f.classList.contains(y)&&(u=parseInt(f.getAttribute(h),10)>0),"shiftTab"===n&&"Right"===this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1)&&(this.matrix.current[0]=-1),{swap:!u&&(("upArrow"===n||r)&&0===t[0]||i||o),toHeader:c,toFrozen:i,toFrozenRight:o}},n.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===s?("leftArrow"!==r&&"shiftTab"!==r||(u[0]=n[0],u[1]=this.matrix.matrix[u[0]].length),this.parent.getFrozenMode()!==s||"rightArrow"!==r&&"tab"!==r||(u[0]=n[0],u[1]=-1),"Right"===this.parent.getFrozenMode()&&"tab"===r&&(u[0]=n[0]+1,u[1]=-1)):"rightArrow"!==r&&"tab"!==r||(u[0]=n[0],u[1]=-1),"downArrow"!==r&&"enter"!==r||(u[0]=-1,u[1]=n[1]),"shiftTab"===r&&"Left"===this.parent.getFrozenMode()&&(u[0]=n[0]-1,u[1]=this.matrix.matrix[u[0]].length),u},n.prototype.generateRows=function(n,t){var r,u=t.matrix,i=t.handlerInstance,f=i.matrix.matrix.length,e=this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type?f+1:f;i.matrix.matrix=i.matrix.matrix.slice(0,e);i.matrix.rows=e;(r=i.matrix.matrix).push.apply(r,u);i.matrix.rows+=u.length},n.prototype.getInfo=function(n){var t=this.getFocusInfo(),r=this.matrix.current,e=r[0],o=r[1],i=t.element.classList.contains(a),s=i||n&&"enter"!==n.action&&(t.element.classList.contains("e-detailrowcollapse")||t.element.classList.contains("e-detailrowexpand")),u=[Math.min(parseInt(t.element.parentElement.getAttribute(h),10),e),Math.min(parseInt(t.element.getAttribute(lt),10),o)],f=u[0],c=u[1];return this.parent.allowGrouping&&this.parent.groupSettings.enableLazyLoading&&i&&(f=this.parent.getDataRows().indexOf(t.element.parentElement)),{isContent:!0,isDataCell:i,indexes:[f,c],isSelectable:s}},n.prototype.validator=function(){var n=this.getTable();return function(i,r,u){var f,e;if(!t.isNullOrUndefined(n.rows[parseInt(i.toString(),10)])){if(f=void 0,r=n.querySelector(".e-emptyrow")?0:r,e=0!==(f=n.rows[parseInt(i.toString(),10)].cells[0].classList.contains("e-editcell")?n.rows[parseInt(i.toString(),10)].cells[0].querySelectorAll("td")[parseInt(r.toString(),10)]:n.rows[parseInt(i.toString(),10)].cells[parseInt(r.toString(),10)]).getBoundingClientRect().width,"enter"===u||"shiftEnter"===u)return e&&f.classList.contains(a);if(("shiftUp"===u||"shiftDown"===u)&&f.classList.contains(a)||"shiftUp"!==u&&"shiftDown"!==u)return e}return!1}},n.prototype.shouldFocusChange=function(n){var r=this.matrix.current,u=r[0],f=void 0===u?-1:u,e=r[1],o=void 0===e?-1:e,i;return f<0||o<0?!0:(i=t.getValue(f+".cells."+o,this.getTable().rows),!i||"enter"!==n.action&&"shiftEnter"!==n.action||i.classList.contains(a)&&!i.classList.contains("e-unboundcell")||i.classList.contains("e-editedbatchcell")&&!i.classList.contains("e-detailcell"))},n.prototype.getGridSeletion=function(){return this.parent.allowSelection&&this.parent.selectionSettings.allowColumnSelection},n}(),gw=function(n){function i(t){return n.call(this,t)||this}return sh(i,n),i.prototype.getTable=function(){return this.parent.isFrozenGrid()?this.parent.getHeaderContent().querySelector(".e-movableheader .e-table"):this.parent.getHeaderTable()},i.prototype.onClick=function(n){var i=n.target;if(this.target=i,(i=i.classList.contains("e-headercell")?i:t.closest(i,"th"))||0===this.parent.frozenRows||(i=n.target.classList.contains(a)?n.target:t.closest(n.target,"td")),n.target.classList.contains("e-columnheader")||n.target.querySelector(".e-stackedheadercell"))return!1;if(i){var r=[i.parentElement.rowIndex,i.cellIndex],u=r[0],f=r[1],e=t.getValue(u+"."+f,this.matrix.matrix);if(this.matrix.inValid(e))return!1;this.matrix.select(i.parentElement.rowIndex,i.cellIndex)}},i.prototype.getFocusInfo=function(){var n={},i=this.matrix.current,r=i[0],f=void 0===r?0:r,u=i[1],e=void 0===u?0:u;return n.element=this.getTable().rows[parseInt(f.toString(),10)].cells[parseInt(e.toString(),10)],t.isNullOrUndefined(n.element)||(n.elementToFocus=this.getFocusable(n.element),n.outline=!n.element.classList.contains("e-filterbarcell")),n},i.prototype.selector=function(n,i){return i.visible&&(void 0!==i.column.field||i.isTemplate||!t.isNullOrUndefined(i.column.template)||!t.isNullOrUndefined(i.column.commands))||"checkbox"===i.column.type||i.cellType===o.StackedHeader},i.prototype.jump=function(n,i){var r=this.parent.getFrozenLeftCount()&&("leftArrow"===n||"shiftLeft"===n&&this.getGridSeletion()||"shiftTab"===n)&&(0===i[1]||i[1]===this.matrix.matrix[i[0]].indexOf(1))||"Left"===this.parent.getFrozenMode()&&"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1),o=("rightArrow"===n||"shiftRight"===n&&this.getGridSeletion()||"tab"===n)&&(i[1]===this.matrix.columns||i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))||i[0]>0&&"shiftTab"===n&&"Right"===this.parent.getFrozenMode()&&i[1]===this.matrix.matrix[i[0]].indexOf(1),f=this.parent.getFrozenMode()===s&&o;"Right"===this.parent.getFrozenMode()&&(r=o);var e,u,l=0!==this.parent.frozenRows&&"enter"===n,h=r&&!("Left"===this.parent.getFrozenMode()&&"tab"===n&&i[0]===this.matrix.matrix.length-1)||f,c=this.parent.focusModule.fHeader&&this.parent.focusModule.fHeader.matrix.matrix,a=c&&!t.isNullOrUndefined(c[i[0]]);return this.parent.enableHeaderFocus&&"tab"===n&&(u=this.matrix.matrix.length-1===i[0],(e=i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))&&(this.matrix.current[0]=u?0:this.matrix.current[0]+1,this.matrix.current[1]=-1),this.parent.isFrozenGrid()&&u&&e&&(r=!0,h=!1)),"tab"===n&&"Left"===this.parent.getFrozenMode()&&i[0]===this.matrix.matrix.length-1&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:("downArrow"===n||l)&&i[0]===this.matrix.matrix.length-1||a&&(r||f)||"tab"===n&&u&&e,toHeader:h,toFrozen:r,toFrozenRight:f}},i.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===s?(("leftArrow"===r||"shiftLeft"===r&&this.getGridSeletion()||"shiftTab"===r)&&(u[0]=n[0],u[1]=this.matrix.matrix[u[0]].length),this.parent.getFrozenMode()===s&&("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(u[0]=n[0],u[1]=-1)):("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(u[0]=n[0],u[1]=-1),"upArrow"!==r&&"shiftEnter"!==r||(u[0]=this.matrix.matrix.length,u[1]=n[1]),"Left"===this.parent.getFrozenMode()&&"shiftTab"===r&&(u[0]=-1===n[0]?this.matrix.matrix.length-1:n[0]-1,u[1]=this.matrix.matrix[u[0]].length),"Right"===this.parent.getFrozenMode()&&"tab"===r&&(u[0]=n[0]+1,u[1]=-1),u},i.prototype.generateRows=function(n){var u=this.matrix.matrix.length;if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type){this.matrix.rows=++this.matrix.rows;for(var i=n[0].cells,r=0,f="FixedHeaderFocus"===this.getHeaderType()&&"Right"!==this.parent.getFrozenMode()?rt:"FixedHeaderFocus"===this.getHeaderType()||"FixedRightHeaderFocus"===this.getHeaderType()?d:"movable",t=0;t<i.length;t++)i[parseInt(t.toString(),10)].column&&i[parseInt(t.toString(),10)].column.columns?r=this.checkFilterColumn(i[parseInt(t.toString(),10)].column.columns,u,r,f):(!this.parent.isFrozenGrid()||this.parent.isFrozenGrid()&&i[parseInt(t.toString(),10)].column.freezeTable===f)&&(this.matrix.set(u,r,i[parseInt(t.toString(),10)].visible&&!1!==i[parseInt(t.toString(),10)].column.allowFiltering),r++)}},i.prototype.checkFilterColumn=function(n,t,i,r){for(var f=n,e=i,u=0;u<f.length;u++)f[parseInt(u.toString(),10)].columns?e=this.checkFilterColumn(f[parseInt(u.toString(),10)].columns,t,e,r):(!this.parent.isFrozenGrid()||this.parent.isFrozenGrid()&&f[parseInt(u.toString(),10)].freezeTable===r)&&(this.matrix.set(t,e,f[parseInt(u.toString(),10)].visible&&!1!==f[parseInt(u.toString(),10)].allowFiltering),e++);return e},i.prototype.getInfo=function(i){return t.extend(n.prototype.getInfo.call(this,i),{isContent:!1,isHeader:!0})},i.prototype.validator=function(){return function(){return!0}},i.prototype.shouldFocusChange=function(n){var r=this.matrix.current,u=r[0],f=r[1],i;return u<0||f<0?!0:(i=t.getValue(u+".cells."+f,this.getTable().rows),!i||"enter"!==n.action&&"altDownArrow"!==n.action||!i.classList.contains("e-headercell"))},i.prototype.getHeaderType=function(){return"HeaderFocus"},i}(ga),lst=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return sh(t,n),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozencontent .e-table")},t.prototype.jump=function(n,t){var r=0!==this.parent.frozenRows&&"shiftEnter"===n,i=("upArrow"===n||r)&&0===t[0]||"shiftTab"===n&&"Right"!==this.parent.getFrozenMode()&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1),u=("upArrow"===n||r)&&0===t[0],f="shiftTab"===n&&this.parent.getFrozenMode()===s&&t[1]===this.matrix.matrix[t[0]].indexOf(1);return"Right"===this.parent.getFrozenMode()?{swap:i||("shiftTab"===n||"leftArrow"===n)&&0===t[1]||"tab"===n&&t[0]<this.matrix.matrix.length-1&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),toHeader:i,toFrozen:u}:("shiftTab"===n&&0===t[0]&&t[1]===this.matrix.matrix[t[0]].indexOf(1)&&(this.matrix.current[0]=-1),{swap:i||("tab"===n||"rightArrow"===n)&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1)||"shiftTab"===n&&t[1]===this.matrix.matrix[t[0]].indexOf(1),toHeader:i,toFrozen:u,toFrozenRight:f})},t.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"Right"===this.parent.getFrozenMode()?("rightArrow"!==r&&"tab"!==r||(u[0]=n[0],u[1]=-1),"shiftTab"===r&&(u[0]=n[0]-1,u[1]=this.matrix.matrix[u[0]].length)):("tab"===r&&this.parent.enableHeaderFocus&&(u[0]=n[0],u[1]=-1),"leftArrow"!==r&&"shiftTab"!==r||(u[0]=n[0],u[1]=this.matrix.matrix[n[0]].length)),"downArrow"!==r&&"enter"!==r||(u[0]=-1,u[1]=n[1]),"tab"===r&&"Right"!==this.parent.getFrozenMode()&&(u[0]=n[0]+1,u[1]=-1),u},t}(ga),ast=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return sh(i,n),i.prototype.jump=function(n,i){var r=0!==this.parent.frozenRows&&"enter"===n,u=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,f=u&&!t.isNullOrUndefined(u[i[0]]),o;if("Right"===this.parent.getFrozenMode()){var e=("leftArrow"===n||"shiftLeft"===n&&this.getGridSeletion()||"shiftTab"===n)&&(0===i[1]||i[1]===this.matrix.matrix[i[0]].indexOf(1))||i[0]<this.matrix.matrix.length-1&&"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1),h=("downArrow"===n||r||"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))&&i[0]===this.matrix.matrix.length-1||f&&e,c=("downArrow"===n||r)&&i[0]===this.matrix.matrix.length-1;return"tab"===n&&i[0]===this.matrix.matrix.length-1&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:h,toHeader:e,toFrozen:c}}return o=i[0]>0&&"shiftTab"===n&&this.parent.getFrozenMode()===s&&i[1]===this.matrix.matrix[i[0]].indexOf(1),{swap:("downArrow"===n||r)&&i[0]===this.matrix.matrix.length-1||("rightArrow"===n||"shiftRight"===n&&this.getGridSeletion()||"tab"===n)&&(i[1]===this.matrix.columns||i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))&&f||"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1)||"shiftTab"===n&&i[1]===this.matrix.matrix[i[0]].indexOf(1)&&i[0]>0,toHeader:("rightArrow"===n||"shiftRight"===n&&this.getGridSeletion()||"tab"===n)&&(i[1]===this.matrix.columns||i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))||"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1)||"shiftTab"===n&&i[1]===this.matrix.matrix[i[0]].indexOf(1)&&i[0]>0,toFrozen:("downArrow"===n||r)&&i[0]===this.matrix.matrix.length-1,toFrozenRight:o}},i.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozenheader .e-table")},i.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"Right"===this.parent.getFrozenMode()?(("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(u[0]=n[0],u[1]=-1),"shiftTab"===r&&(u[0]=-1===n[0]?this.matrix.matrix.length-1:n[0]-1,u[1]=this.matrix.matrix[u[0]].length)):("leftArrow"===r||"shiftLeft"===r&&this.getGridSeletion()||"shiftTab"===r)&&(u[0]=n[0],u[1]=this.matrix.matrix[u[0]].length),"upArrow"!==r&&"shiftEnter"!==r||(u[0]=this.matrix.matrix.length,u[1]=n[1]),"tab"===r&&"Right"!==this.parent.getFrozenMode()&&(u[0]=n[0]+1,u[1]=-1),u},i.prototype.getHeaderType=function(){return"FixedHeaderFocus"},i}(gw),eit=function(){function n(n){this.searchBox=n}return n.prototype.searchFocus=function(n){if(n.target.parentElement.classList.add("e-input-focus"),n.target.classList.contains("e-input")&&n.target.classList.contains("e-search")&&n.target.value){var t=n.target.parentElement.querySelector(".e-sicon");t.classList.add("e-clear-icon");t.setAttribute("title","Clear");t.style.cursor="pointer"}},n.prototype.searchBlur=function(n){var t=n.relatedTarget?n.relatedTarget:null,i;(t&&t.classList.contains("e-sicon")?t.classList.contains("e-clear-icon")&&n.target.parentElement.classList.remove("e-input-focus"):n.target.parentElement.classList.remove("e-input-focus"),n.target.classList.contains("e-search")&&t&&!t.classList.contains("e-sicon e-clear-icon")&&!t.classList.contains("e-sicon"))&&(i=n.target.parentElement.querySelector(".e-sicon"),i.classList.remove("e-clear-icon"),i.removeAttribute("title"),i.style.cursor="default")},n.prototype.wireEvent=function(){this.searchBox&&(t.EventHandler.add(this.searchBox,"focus",this.searchFocus,this),t.EventHandler.add(this.searchBox,"blur",this.searchBlur,this))},n.prototype.unWireEvent=function(){this.searchBox&&(t.EventHandler.remove(this.searchBox,"focus",this.searchFocus),t.EventHandler.remove(this.searchBox,"blur",this.searchBlur))},n}(),vst=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return sh(t,n),t.prototype.getTable=function(){return this.parent.getContent().querySelector(".e-frozen-right-content .e-table")},t.prototype.jump=function(n,t){var r=0!==this.parent.frozenRows&&"shiftEnter"===n,i=("upArrow"===n||r)&&0===t[0],u=this.parent.getFrozenMode()===s&&"tab"===n&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1);return{swap:i||("shiftTab"===n||"leftArrow"===n)&&0===t[1]||"tab"===n&&t[0]<this.matrix.matrix.length-1&&t[1]===this.matrix.matrix[t[0]].lastIndexOf(1),toHeader:i,toFrozenRight:i,toFrozen:u}},t.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return"rightArrow"!==r&&"tab"!==r||(u[0]=n[0],u[1]=-1),"downArrow"!==r&&"enter"!==r||(u[0]=-1,u[1]=n[1]),"shiftTab"===r&&(u[0]=n[0]-1,u[1]=this.matrix.matrix[u[0]].length),u},t}(ga),yst=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return sh(i,n),i.prototype.jump=function(n,i){var r=this.parent.focusModule.header&&this.parent.focusModule.header.matrix.matrix,e=r&&!t.isNullOrUndefined(r[i[0]]),u=0!==this.parent.frozenRows&&"enter"===n,f=("leftArrow"===n||"shiftLeft"===n&&this.getGridSeletion()||"shiftTab"===n)&&(0===i[1]||i[1]===this.matrix.matrix[i[0]].indexOf(1))||i[0]<this.matrix.matrix.length-1&&"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1),o=("downArrow"===n||u||"tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1))&&i[0]===this.matrix.matrix.length-1||e&&f,s="tab"===n&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1),h=("downArrow"===n||u)&&i[0]===this.matrix.matrix.length-1;return"tab"===n&&i[0]===this.matrix.matrix.length-1&&i[1]===this.matrix.matrix[i[0]].lastIndexOf(1)&&(this.matrix.current[0]=-1),{swap:o,toHeader:f,toFrozen:s,toFrozenRight:h}},i.prototype.getTable=function(){return this.parent.getHeaderContent().querySelector(".e-frozen-right-header .e-table")},i.prototype.getNextCurrent=function(n,t,i,r){void 0===n&&(n=[]);var u=[];return("rightArrow"===r||"shiftRight"===r&&this.getGridSeletion()||"tab"===r)&&(u[0]=n[0],u[1]=-1),"upArrow"!==r&&"shiftEnter"!==r||(u[0]=this.matrix.matrix.length,u[1]=n[1]),"shiftTab"===r&&(u[0]=-1===n[0]?this.matrix.matrix.length-1:n[0]-1,u[1]=this.matrix.matrix[u[0]].length),u},i.prototype.getHeaderType=function(){return"FixedRightHeaderFocus"},i}(gw),pst=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fe=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},wst=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return pst(i,n),fe([t.Property(12)],i.prototype,"pageSize",void 0),fe([t.Property(8)],i.prototype,"pageCount",void 0),fe([t.Property(1)],i.prototype,"currentPage",void 0),fe([t.Property()],i.prototype,"totalRecordsCount",void 0),fe([t.Property(!1)],i.prototype,"enableQueryString",void 0),fe([t.Property(!1)],i.prototype,"pageSizes",void 0),fe([t.Property(null)],i.prototype,"template",void 0),i}(t.ChildProperty),bst=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oit=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},kst=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return bst(i,n),oit([t.Property("startsWith")],i.prototype,"operator",void 0),oit([t.Property(!1)],i.prototype,"ignoreAccent",void 0),i}(t.ChildProperty),nv=function(){return nv=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n},nv.apply(this,arguments)},sit=function(){function n(n,t,i){this.selectedRowIndexes=[];this.selectedRowCellIndexes=[];this.selectedRecords=[];this.preventFocus=!1;this.selectedColumnsIndexes=[];this.checkBoxState=!1;this.isMultiShiftRequest=!1;this.isMultiCtrlRequest=!1;this.enableSelectMultiTouch=!1;this.clearRowCheck=!1;this.selectRowCheck=!1;this.selectedRowState={};this.unSelectedRowState={};this.totalRecordsCount=0;this.chkAllCollec=[];this.isCheckedOnAdd=!1;this.persistSelectedData=[];this.deSelectedData=[];this.isHdrSelectAllClicked=!1;this.needColumnSelection=!1;this.isCancelDeSelect=!1;this.isPreventCellSelect=!1;this.disableUI=!1;this.isPersisted=!1;this.cmdKeyPressed=!1;this.cellselected=!1;this.isMultiSelection=!1;this.isAddRowsToSelection=!1;this.initialRowSelection=!1;this.isPrevRowSelection=!1;this.isKeyAction=!1;this.isRowDragSelected=!1;this.isPartialSelection=!1;this.rmtHdrChkbxClicked=!1;this.isCheckboxReset=!1;this.autoFillRLselection=!0;this.bottom="0 0 2px 0";this.top="2px 0 0 0";this.right_bottom="0 2px 2px 0";this.bottom_left="0 0 2px 2px";this.top_right="2px 2px 0 0";this.top_left="2px 0 0 2px";this.top_bottom="2px 0 2px 0";this.top_right_bottom="2px 2px 2px 0";this.top_bottom_left="2px 0 2px 2px";this.top_right_left="2px 2px 0 2px";this.right_bottom_left="0 2px 2px 2px";this.all_border="2px";this.parent=n;this.selectionSettings=t;this.factory=i.getService("rendererFactory");this.focus=i.getService("focus");this.addEventListener();this.wireEvents()}return n.prototype.initializeSelection=function(){this.parent.log("selection_key_missing");this.render()},n.prototype.onActionBegin=function(n,t){this.parent.trigger(t,this.fDataUpdate(n))},n.prototype.fDataUpdate=function(n){if(!(this.isMultiSelection||t.isNullOrUndefined(n.cellIndex)&&t.isNullOrUndefined(n.rowIndex))){var i=this.getRowObj(t.isNullOrUndefined(n.rowIndex)?t.isNullOrUndefined(n.cellIndex)?this.currentIndex:n.cellIndex.rowIndex:n.rowIndex);n.foreignKeyData=i.foreignKeyData}return n},n.prototype.onActionComplete=function(n,t){this.parent.trigger(t,this.fDataUpdate(n));this.isMultiSelection=!1},n.prototype.getModuleName=function(){return"selection"},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.hidePopUp(),this.clearSelection(),this.removeEventListener(),this.unWireEvents(),t.EventHandler.remove(this.parent.getContent(),"mousedown",this.mouseDownHandler),t.EventHandler.remove(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler))},n.prototype.isEditing=function(){return("Normal"===this.parent.editSettings.mode||"Batch"===this.parent.editSettings.mode&&this.parent.editModule&&this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate())&&this.parent.isEdit&&!this.parent.isPersistSelection},n.prototype.getSelectedMovableRow=function(n){var t=this.parent;return t.isFrozenGrid()&&this.parent.getContent().querySelector("."+p)?t.getMovableRowByIndex(n):null},n.prototype.getSelectedFrozenRightRow=function(n){var t=this.parent;return t.isFrozenGrid()&&t.getFrozenMode()===s&&t.getFrozenRightContent()?t.getFrozenRightRowByIndex(n):null},n.prototype.getCurrentBatchRecordChanges=function(){var i=this.parent,n,t;if("Batch"===i.editSettings.mode&&i.editModule){n=eo(this.parent.getCurrentViewRecords());n="Bottom"===i.editSettings.newRowPosition?n.concat(this.parent.editModule.getBatchChanges()[ar]):this.parent.editModule.getBatchChanges()[ar].concat(n);for(var u=this.parent.editModule.getBatchChanges()[eu],f=this.parent.getPrimaryKeyFieldNames()[0],r=0;r<u.length;r++)for(t=0;t<n.length;t++)if(u[parseInt(r.toString(),10)][""+f]===n[parseInt(t.toString(),10)][""+f]){n.splice(t,1);break}return n}return i.getCurrentViewRecords()},n.prototype.selectRow=function(n,t){var o,s,u,h,c;if(this.selectedRowIndexes.length&&this.selectionSettings.enableSimpleMultiRowSelection)this.addRowsToSelection([n]);else{var i=this.parent,r=i.getRowByIndex(n),e=r&&i.getRowObjectFromUID(r.getAttribute("data-uid"));if(!(this.isPartialSelection&&e&&e.isDataRow)||e.isSelectable){var f,a=this.getSelectedMovableRow(n),v=this.getSelectedFrozenRightRow(n),l=!1;if(i.enableVirtualization&&n>-1){if(o={selectedIndex:n,isAvailable:!0},this.parent.notify(wp,o),s=i.isFrozenGrid()?i.contentModule.getRowObjectByIndex(n):null,!r||!i.getRowObjectFromUID(r.getAttribute("data-uid"))&&!s)return void(o.isAvailable&&!i.selectionSettings.persistSelection&&this.parent.getSelectedRecords().length>0&&this.clearRowSelection());f=s||i.getRowObjectFromUID(r.getAttribute("data-uid")).data}else f=this.getRowObj(n).data;this.isRowType()&&r&&!this.isEditing()&&(h=r.hasAttribute("aria-selected"),this.activeTarget(),t=t?!(!this.selectedRowIndexes.length||1!==this.selectedRowIndexes.length||this.isKeyAction&&this.parent.isCheckBoxSelection||n!==this.selectedRowIndexes[0]):t,this.isKeyAction=!1,c="cancel",t?this.rowSelectingCallBack(u,t,n,f,l,h,c)(u):(u={data:f,rowIndex:n,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,row:r,previousRow:i.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked},u=this.addMovableArgs(u,a,v),this.parent.trigger(hc,this.fDataUpdate(u),this.rowSelectingCallBack(u,t,n,f,l,h,c))))}}},n.prototype.rowSelectingCallBack=function(n,i,r,u,f,e,o){var s=this;return function(n){t.isNullOrUndefined(n)||!0!==n[""+o]?(s.index=r,s.toggle=i,s.data=u,s.removed=f,e&&s.selectionSettings.persistSelection&&"ResetOnRowClick"!==s.selectionSettings.checkboxMode?(s.clearSelectedRow(r),s.selectRowCallBack()):!e&&s.selectionSettings.persistSelection&&"ResetOnRowClick"!==s.selectionSettings.checkboxMode&&s.selectRowCallBack(),"ResetOnRowClick"===s.selectionSettings.checkboxMode&&(s.isCheckboxReset=!0,s.clearSelection()),(!s.selectionSettings.persistSelection||"ResetOnRowClick"===s.selectionSettings.checkboxMode||!s.parent.isCheckBoxSelection&&s.selectionSettings.persistSelection)&&(s.selectRowCheck=!0,s.clearRow())):s.disableInteracted()}},n.prototype.selectRowCallBack=function(){var t,i=this.parent,n=this.index,r=this.toggle,o=this.data,s=this.removed,u=i.getRowByIndex(n),f=this.getSelectedMovableRow(n),e=this.getSelectedFrozenRightRow(n);r||s||(this.selectedRowIndexes.indexOf(n)<=-1&&(this.updateRowSelection(u,n),this.selectMovableRow(f,e,n)),this.selectRowIndex(n));r||(t={data:o,rowIndex:n,row:u,previousRow:i.getRowByIndex(this.prevRowIndex),previousRowIndex:this.prevRowIndex,target:this.actualTarget,isInteracted:this.isInteracted,isHeaderCheckBoxClicked:this.isHeaderCheckboxClicked,rowIndexes:n},t=this.addMovableArgs(t,f,e),this.onActionComplete(t,af));this.isInteracted=!1;this.updateRowProps(n)},n.prototype.selectMovableRow=function(n,t,i){this.parent.isFrozenGrid()&&(this.updateRowSelection(n,i),this.parent.getFrozenMode()===s&&t&&this.updateRowSelection(t,i))},n.prototype.addMovableArgs=function(n,t,i){if(this.parent.isFrozenGrid()){var r={mRow:t,previousMovRow:this.parent.getMovableRows()[this.prevRowIndex]};this.parent.getFrozenMode()===s&&i&&(r.frozenRightRow=i,r.previousFrozenRightRow=this.parent.getFrozenRightDataRows()[this.prevRowIndex]);n=nv({},n,r)}return n},n.prototype.selectRowsByRange=function(n,t){this.selectRows(this.getCollectionFromIndexes(n,t));this.selectRowIndex(t)},n.prototype.selectedDataUpdate=function(n,t,i,r,u){for(var o,e,f=0,s=r.length;f<s;f++)o=this.parent.getDataRows()[r[parseInt(f.toString(),10)]],this.parent.enableVirtualization&&(o=this.parent.getRowByIndex(r[parseInt(f.toString(),10)])),e=this.getRowObj(o),e&&e.isDataRow&&e.isSelectable?(n.push(e.data),i.push(o),t.push(e.foreignKeyData)):this.isPartialSelection&&u&&u.splice(u.indexOf(r[parseInt(f.toString(),10)]),1)},n.prototype.selectRows=function(n){var i=this,r=this.parent,f=n.slice(),u=this.isSingleSel()?n[n.length-1]:n[0],e;this.isMultiSelection=!0;var o=[],h=[],c=this.getSelectedMovableRow(u),l=this.getSelectedFrozenRightRow(u),a=[];this.isRowType()&&!this.isEditing()&&(this.selectedDataUpdate(a,h,o,n,f),this.activeTarget(),e={cancel:!1,rowIndexes:f,row:o,rowIndex:u,target:this.actualTarget,prevRow:r.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isInteracted:this.isInteracted,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,data:a,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,foreignKeyData:h},e=this.addMovableArgs(e,c,l),this.parent.trigger(hc,this.fDataUpdate(e),function(n){var a,e,v;if(t.isNullOrUndefined(n)||!0!==n.cancel){if(i.clearRow(),i.selectRowIndex(f.slice(-1)[0]),a=function(n,t){if(i.updateRowSelection(r.getRowByIndex(n),n,t),r.isFrozenGrid()){var f=i.parent.getFrozenMode()===s?r.getFrozenRightRowByIndex(n):void 0;i.selectMovableRow(r.getMovableRowByIndex(n),f,n)}i.updateRowProps(u)},i.isSingleSel())a(u);else for(e=0,v=f;e<v.length;e++)a(v[e],!!r.enableVirtualization);n={rowIndexes:f,row:o,rowIndex:u,target:i.actualTarget,prevRow:r.getRows()[i.prevRowIndex],previousRowIndex:i.prevRowIndex,data:i.getSelectedRecords(),isInteracted:i.isInteracted,isHeaderCheckboxClicked:i.isHeaderCheckboxClicked,foreignKeyData:h};n=i.addMovableArgs(n,c,l);i.isRowSelected&&i.onActionComplete(n,af);i.isInteracted=!1}else i.disableInteracted()}))},n.prototype.addRowsToSelection=function(n){var s=this.parent,w=this.target,u,y,a,p;this.isMultiSelection=!0;var h=[],c=[],l=[],v=s.getSelectedRowIndexes().concat(n),f=this.isSingleSel()?s.getRowByIndex(n[n.length-1]):s.getRowByIndex(n[0]),e=this.isSingleSel()?this.getSelectedMovableRow(n[n.length-1]):this.getSelectedMovableRow(n[0]),o=this.isSingleSel()?this.getSelectedFrozenRightRow(n[n.length-1]):this.getSelectedFrozenRightRow(n[0]);if(this.isRowType()&&!this.isEditing()||this.selectionSettings.checkboxOnly)for(y=this.parent.getColumns().filter(function(n){return"checkbox"===n.type}),this.isMultiCtrlRequest&&!y.length&&this.selectedDataUpdate(l,c,h,v),a=0,p=n;a<p.length;a++){var i=p[a],r=this.getRowObj(i),b=this.selectedRowIndexes.indexOf(i)>-1;if(!(this.isPartialSelection&&r&&r.isDataRow)||r.isSelectable){if(this.selectRowIndex(i),b&&(y.length||this.selectionSettings.enableToggle||this.isMultiCtrlRequest)){if(this.isAddRowsToSelection=!0,this.rowDeselect(sy,[i],[r.data],[f],[r.foreignKeyData],w),this.isCancelDeSelect)return;this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(i),1);this.selectedRecords.splice(this.selectedRecords.indexOf(f),1);this.selectRowIndex(this.selectedRowIndexes.length?this.selectedRowIndexes[this.selectedRowIndexes.length-1]:-1);f.removeAttribute("aria-selected");this.addRemoveClassesForRow(f,!1,null,"e-selectionbackground","e-active");e&&(this.selectedRecords.splice(this.selectedRecords.indexOf(e),1),e.removeAttribute("aria-selected"),this.addRemoveClassesForRow(e,!1,null,"e-selectionbackground","e-active"));o&&(this.selectedRecords.splice(this.selectedRecords.indexOf(o),1),o.removeAttribute("aria-selected"),this.addRemoveClassesForRow(o,!1,null,"e-selectionbackground","e-active"));this.rowDeselect(go,[i],[r.data],[f],[r.foreignKeyData],w,[e],void 0,[o]);this.isInteracted=!1;this.isMultiSelection=!1;this.isAddRowsToSelection=!1;this.isHdrSelectAllClicked=!1}else{if(this.activeTarget(),u={cancel:!1,data:l.length?l:r.data,rowIndex:i,row:h.length?h:f,target:this.actualTarget,prevRow:s.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,foreignKeyData:c.length?c:r.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:v},u=this.addMovableArgs(u,e,o),this.parent.trigger(hc,this.fDataUpdate(u)),!t.isNullOrUndefined(u)&&!0===u.cancel)return void this.disableInteracted();this.isSingleSel()&&this.clearRow();this.updateRowSelection(f,i);this.selectMovableRow(e,o,i)}if(b||(u={data:l.length?l:r.data,rowIndex:i,row:h.length?h:f,target:this.actualTarget,prevRow:s.getRows()[this.prevRowIndex],previousRowIndex:this.prevRowIndex,foreignKeyData:c.length?c:r.foreignKeyData,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked,rowIndexes:v},u=this.addMovableArgs(u,e,o),this.onActionComplete(u,af)),this.isInteracted=!1,this.updateRowProps(i),this.isSingleSel())break}}},n.prototype.getCollectionFromIndexes=function(n,t){for(var i=[],u=n<=t?{i:n,max:t}:{i:t,max:n},r=u.i,f=u.max;r<=f;r++)i.push(r);return n>t&&i.reverse(),i},n.prototype.clearRow=function(){this.clearRowCheck=!0;this.clearRowSelection()},n.prototype.clearRowCallBack=function(){this.isCancelDeSelect&&"Check"!==this.parent.checkAllRows||(this.selectedRowIndexes=[],this.selectedRecords=[],this.selectRowIndex(-1),this.isSingleSel()&&this.parent.isPersistSelection&&(this.selectedRowState={}))},n.prototype.clearSelectedRow=function(n){if(this.toggle){var t=this.parent.getRowByIndex(n);this.disableUI||(t.removeAttribute("aria-selected"),this.addRemoveClassesForRow(t,!1,!0,"e-selectionbackground","e-active"));this.removed=!0;this.updatePersistCollection(t,!1);this.updateCheckBoxes(t);this.selectedRowIndexes.splice(this.selectedRowIndexes.indexOf(n),1);this.selectedRecords.splice(this.selectedRecords.indexOf(this.parent.getRowByIndex(n)),1)}},n.prototype.updateRowProps=function(n){this.prevRowIndex=n;this.isRowSelected=this.selectedRowIndexes.length&&!0},n.prototype.getPkValue=function(n,t){return n&&ir(n)?ut(n,t):t[""+n]},n.prototype.updatePersistCollection=function(n,i){var f=this,r,u;if((this.parent.isPersistSelection||this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0)&&!t.isNullOrUndefined(n)){if(this.parent.isPersistSelection||this.ensureCheckboxFieldSelection(),r=this.getRowObj(n),u=r.data?this.getPkValue(this.primaryKey,r.data):null,null===u)return;r.isSelected=i;i&&!this.isPartialSelection||this.isPartialSelection&&r.isSelectable&&r.isSelected?(this.selectedRowState[""+u]=i,delete this.unSelectedRowState[""+u],this.persistSelectedData.some(function(n){return f.getPkValue(f.primaryKey,n)===u})||this.persistSelectedData.push(r.data)):this.updatePersistDelete(u)}},n.prototype.updatePersistDelete=function(n,t){var i,r=this;delete this.selectedRowState[""+n];this.rmtHdrChkbxClicked&&(this.unSelectedRowState[""+n]=!0);this.persistSelectedData.some(function(t,u){return i=u,r.getPkValue(r.primaryKey,t)===n})&&(this.persistSelectedData.splice(i,1),t&&this.parent.partialSelectedRecords.splice(i,1))},n.prototype.updateCheckBoxes=function(n,i,r){if(!t.isNullOrUndefined(n)){var u=n.querySelector(".e-checkselect");t.isNullOrUndefined(u)||(ho(u.nextElementSibling,i),ef(u,i),(t.isNullOrUndefined(this.checkedTarget)||!t.isNullOrUndefined(this.checkedTarget)&&!this.checkedTarget.classList.contains("e-checkselectall"))&&this.setCheckAllState(r))}},n.prototype.updateRowSelection=function(n,t,i){var r,u;if(n&&(this.selectedRowIndexes.push(t),r=this.selectedRowIndexes.length,this.parent.isFrozenGrid()&&r>1&&this.selectedRowIndexes[r-2]===this.selectedRowIndexes[r-1]&&this.selectedRowIndexes.pop(),this.selectedRecords.push(n),n.setAttribute("aria-selected","true"),this.updatePersistCollection(n,!0),this.updateCheckBoxes(n,!0),this.addRemoveClassesForRow(n,!0,null,"e-selectionbackground","e-active"),!this.preventFocus)){if(u=this.focus.getPrevIndexes().cellIndex?n.cells[this.focus.getPrevIndexes().cellIndex]:n.querySelector(".e-selectionbackground:not(.e-hide):not(.e-detailrowcollapse):not(.e-detailrowexpand)"),this.parent.contextMenuModule&&2===this.mouseButton&&(u=this.parent.contextMenuModule.cell),!u||i)return;this.focus.onClick({target:u},!0)}},n.prototype.clearSelection=function(){if(this.checkSelectAllClicked=!0,this.selectionSettings.persistSelection&&this.persistSelectedData.length&&(this.deSelectedData=eo(this.persistSelectedData)),!this.parent.isPersistSelection||this.parent.isPersistSelection&&!this.parent.isEdit||!t.isNullOrUndefined(this.checkedTarget)&&this.checkedTarget.classList.contains("e-checkselectall")){var n=this.parent.element.querySelector(".e-gridpopup").querySelector("span");n.classList.contains("e-rowselect")&&n.classList.remove("e-spanclicked");this.parent.isPersistSelection&&(this.persistSelectedData=[],this.selectedRowState={});this.clearRowSelection();this.clearCellSelection();this.clearColumnSelection();this.prevRowIndex=void 0;this.prevCIdxs=void 0;this.prevECIdxs=void 0;this.enableSelectMultiTouch=!1;this.isInteracted=!1;this.checkSelectAllClicked=!1;this.isHdrSelectAllClicked=!1}},n.prototype.clearRowSelection=function(){var n=this,v,r,u,f;if(this.isRowSelected){for(var i=this.parent,p=this.parent.getDataRows(),e=[],o=[],h=[],c=[],l=[],a=[],y=this.target,t=0,w=this.selectedRowIndexes.length;t<w;t++)v="Batch"===this.parent.editSettings.mode?this.parent.getRows()[this.selectedRowIndexes[parseInt(t.toString(),10)]]:this.parent.getDataRows()[this.selectedRowIndexes[parseInt(t.toString(),10)]],r=this.getRowObj(v),(r&&(e.push(r.data),o.push(v),l.push(this.selectedRowIndexes[parseInt(t.toString(),10)]),a.push(r.foreignKeyData)),i.isFrozenGrid())&&(u=i.getMovableRows(),(u&&u.length&&h.push(u[this.selectedRowIndexes[parseInt(t.toString(),10)]]),i.getFrozenMode()===s)&&(f=i.getFrozenRightRows(),f&&f.length&&c.push(f[this.selectedRowIndexes[parseInt(t.toString(),10)]])));this.selectionSettings.persistSelection&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode&&(this.isRowClicked=!!this.checkSelectAllClicked);this.rowDeselect(sy,l,e,o,a,y,h,function(){var t,r,i,s,u,f;if(n.isCancelDeSelect&&(n.isRowClicked||n.checkSelectAllClicked||n.isInteracted&&!n.parent.isPersistSelection)){if(n.parent.isPersistSelection)if("Intermediate"===n.getCheckAllStatus(n.parent.element.querySelector(".e-checkselectall")))for(t=0;t<n.selectedRecords.length;t++)n.updatePersistCollection(n.selectedRecords[parseInt(t.toString(),10)],!0);else n.parent.checkAllRows="Check",n.updatePersistSelectedData(!0);n.clearRowCheck&&(n.clearRowCallBack(),n.clearRowCheck=!1,n.selectRowCheck&&(n.selectRowCallBack(),n.selectRowCheck=!1))}else{for(r=[].slice.call(p.filter(function(n){return n.hasAttribute("aria-selected")})),i=0;i<r.length;i++)n.disableUI||(r[parseInt(i.toString(),10)].removeAttribute("aria-selected"),n.addRemoveClassesForRow(r[parseInt(i.toString(),10)],!1,!0,"e-selectionbackground","e-active")),n.isPrevRowSelection||n.updatePersistCollection(r[parseInt(i.toString(),10)],!1),n.updateCheckBoxes(r[parseInt(i.toString(),10)]);for(t=0,s=n.selectedRowIndexes.length;t<s;t++)u=n.getSelectedMovableRow(n.selectedRowIndexes[parseInt(t.toString(),10)]),u&&(n.disableUI||(u.removeAttribute("aria-selected"),n.addRemoveClassesForRow(u,!1,!0,"e-selectionbackground","e-active")),n.updateCheckBoxes(u),n.isPrevRowSelection||n.updatePersistCollection(u,!1)),f=n.getSelectedFrozenRightRow(n.selectedRowIndexes[parseInt(t.toString(),10)]),f&&(n.disableUI||(f.removeAttribute("aria-selected"),n.addRemoveClassesForRow(f,!1,!0,"e-selectionbackground","e-active")),n.updateCheckBoxes(f),n.isPrevRowSelection||n.updatePersistCollection(f,!1));n.selectedRowIndexes=[];n.selectedRecords=[];n.isRowSelected=!1;n.selectRowIndex(-1);n.isPrevRowSelection=!1;n.rowDeselect(go,l,e,o,a,y,h,void 0,c);n.clearRowCheck&&(n.clearRowCallBack(),n.clearRowCheck=!1,n.selectRowCheck&&(n.selectRowCallBack(),n.selectRowCheck=!1))}},c)}else this.clearRowCheck&&(this.clearRowCallBack(),this.clearRowCheck=!1,this.selectRowCheck&&(this.selectRowCallBack(),this.selectRowCheck=!1))},n.prototype.rowDeselect=function(n,i,r,u,f,e,o,s,h){var l=this,v,c;if(this.selectionSettings.persistSelection&&(this.isRowClicked||this.checkSelectAllClicked||this.focus.activeKey&&this.focus.currentInfo.element.classList.contains("e-gridchkbox")&&"space"===this.focus.activeKey)||!this.selectionSettings.persistSelection){v=1===i.length&&1===this.deSelectedData.length;c={rowIndex:i[0],data:this.selectionSettings.persistSelection&&"Uncheck"===this.parent.checkAllRows&&!v&&"ResetOnRowClick"!==this.selectionSettings.checkboxMode?this.deSelectedData:r,foreignKeyData:f,cancel:!1,isInteracted:this.isInteracted,isHeaderCheckboxClicked:this.isHeaderCheckboxClicked};"rowDeselected"===n&&delete c.cancel;var a="row",y="rowIndexes",p="data",w="foreignKeyData";c[""+a]=u;c.target=this.actualTarget;this.actualTarget&&!t.isNullOrUndefined(t.closest(this.actualTarget,"thead"))||i.length>1?(c.rowIndex=i[0],c[""+y]=i):1===i.length&&(c[""+p]=c[""+p][0],c[""+a]=c[""+a][0],c[""+w]=c[""+w][0],this.isAddRowsToSelection&&(c[""+y]=i));this.parent.trigger(n,this.parent.isFrozenGrid()?nv({},c,{mRow:o,frozenRightRow:h}):c,function(n){l.isCancelDeSelect=n.cancel;l.isCancelDeSelect&&(l.isRowClicked||l.isInteracted||l.checkSelectAllClicked)||(l.updatePersistCollection(u[0],!1),l.updateCheckBoxes(u[0],void 0,i[0]),o&&l.updateCheckBoxes(o[0],void 0,i[0]),h&&l.updateCheckBoxes(h[0],void 0,i[0]));void 0!==s&&s()})}else this.selectionSettings.persistSelection&&!this.isInteracted&&void 0!==s&&s()},n.prototype.getRowObj=function(n){return void 0===n&&(n=this.currentIndex),t.isNullOrUndefined(n)?{}:("number"==typeof n&&(n=this.parent.getRowByIndex(n)),n&&this.parent.getRowObjectFromUID(n.getAttribute("data-uid"))||{})},n.prototype.getSelectedMovableCell=function(n){var t=this.parent,i=t.getColumnByIndex(n.cellIndex);return t.isFrozenGrid()&&"movable"===i.getFreezeTableName()?t.getMovableCellFromIndex(n.rowIndex,this.getColIndex(n.rowIndex,n.cellIndex)):null},n.prototype.selectCell=function(n,i){var u,e,r,f,o;this.isCellType()&&(e=this.parent,r=this.getSelectedMovableCell(n),r||(r=e.getCellFromIndex(n.rowIndex,this.getColIndex(n.rowIndex,n.cellIndex))),this.currentIndex=n.rowIndex,f=this.getCurrentBatchRecordChanges()[this.currentIndex],this.isCellType()&&r&&!this.isEditing()&&(o=r.classList.contains("e-cellselectionbackground"),(i=i?!t.isUndefined(this.prevCIdxs)&&n.rowIndex===this.prevCIdxs.rowIndex&&n.cellIndex===this.prevCIdxs.cellIndex&&o:i)?this.successCallBack(u,i,n,r,f)(u):((u={data:f,cellIndex:n,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,cancel:!1}).currentCell=r,u.previousRowCellIndex=this.prevECIdxs,this.parent.trigger(le,this.fDataUpdate(u),this.successCallBack(u,i,n,r,f)),this.cellselected=!0)))},n.prototype.successCallBack=function(n,i,r,u,f){var e=this;return function(n){var o="currentCell",s;(t.isNullOrUndefined(n)||!0!==n.cancel)&&(i||(n[""+o]=n[""+o]?n[""+o]:u),e.clearCell(),i||e.updateCellSelection(u,r.rowIndex,r.cellIndex),!i)&&(s={data:f,cellIndex:r,currentCell:u,selectedRowCellIndex:e.selectedRowCellIndexes,previousRowCell:e.prevECIdxs?e.getCellIndex(e.prevECIdxs.rowIndex,e.prevECIdxs.cellIndex):void 0},s.previousRowCellIndex=e.prevECIdxs,e.updateCellProps(r,r),e.onActionComplete(s,ns))}},n.prototype.getCellIndex=function(n,t){return this.parent.getFrozenColumns()&&t>=this.parent.getFrozenColumns()?this.parent.getMovableCellFromIndex(n,t):this.parent.getCellFromIndex(n,t)},n.prototype.selectCellsByRange=function(n,i){var r=this,h,v,s,c,l;if(this.isCellType()){var u,f,e=this.parent,o=this.getSelectedMovableCell(n),a=e.getFrozenColumns();o||(o=e.getCellFromIndex(n.rowIndex,n.cellIndex));v=n;s=i=i||n;this.currentIndex=n.rowIndex;c=this.getCurrentBatchRecordChanges()[this.currentIndex];this.isSingleSel()||!this.isCellType()||this.isEditing()||(l={data:c,cellIndex:n,currentCell:o,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},l.previousRowCellIndex=this.prevECIdxs,this.parent.trigger(le,this.fDataUpdate(l),function(l){var b,y,p,k,w;if(t.isNullOrUndefined(l)||!0!==l.cancel){for((r.clearCell(),n.rowIndex>i.rowIndex)&&(b=n,n=i,i=b),y=n.rowIndex;y<=i.rowIndex;y++){for(r.selectionSettings.cellSelectionMode.indexOf("Box")<0?(u=y===n.rowIndex?n.cellIndex:0,f=y===i.rowIndex?i.cellIndex:r.getLastColIndex(y)):(u=n.cellIndex,f=i.cellIndex),h=[],p=u<f?u:f,k=u>f?u:f;p<=k;p++)(o=a?p<a?e.getCellFromIndex(y,p):e.getMovableCellFromIndex(y,p):e.getCellFromIndex(y,p))&&(h.push(p),r.updateCellSelection(o),r.addAttribute(o));r.selectedRowCellIndexes.push({rowIndex:y,cellIndexes:h})}w={data:c,cellIndex:s,currentCell:e.getCellFromIndex(s.rowIndex,s.cellIndex),selectedRowCellIndex:r.selectedRowCellIndexes,previousRowCell:r.prevECIdxs?r.getCellIndex(r.prevECIdxs.rowIndex,r.prevECIdxs.cellIndex):void 0};w.previousRowCellIndex=r.prevECIdxs;r.isDragged||(r.onActionComplete(w,ns),r.cellselected=!0);r.updateCellProps(v,s)}}))}},n.prototype.selectCells=function(n){var f,e,t,h,i,c,o;if(this.isCellType()){var u=this.parent,r=this.getSelectedMovableCell(n[0]),s=u.getFrozenColumns();if(r||(r=u.getCellFromIndex(n[0].rowIndex,n[0].cellIndexes[0])),this.currentIndex=n[0].rowIndex,f=this.getCurrentBatchRecordChanges()[this.currentIndex],!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){for(e={data:f,cellIndex:n[0].cellIndexes[0],currentCell:r,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},e.previousRowCellIndex=this.prevECIdxs,this.onActionBegin(e,le),t=0,h=n.length;t<h;t++)for(i=0,c=n[parseInt(t.toString(),10)].cellIndexes.length;i<c;i++)(r=s?n[parseInt(t.toString(),10)].cellIndexes[parseInt(i.toString(),10)]<s?u.getCellFromIndex(n[parseInt(t.toString(),10)].rowIndex,n[parseInt(t.toString(),10)].cellIndexes[parseInt(i.toString(),10)]):u.getMovableCellFromIndex(n[parseInt(t.toString(),10)].rowIndex,n[parseInt(t.toString(),10)].cellIndexes[parseInt(i.toString(),10)]):u.getCellFromIndex(n[parseInt(t.toString(),10)].rowIndex,n[parseInt(t.toString(),10)].cellIndexes[parseInt(i.toString(),10)]))&&(this.updateCellSelection(r),this.addAttribute(r),this.addRowCellIndex({rowIndex:n[parseInt(t.toString(),10)].rowIndex,cellIndex:n[parseInt(t.toString(),10)].cellIndexes[parseInt(i.toString(),10)]}));this.updateCellProps({rowIndex:n[0].rowIndex,cellIndex:n[0].cellIndexes[0]},{rowIndex:n[0].rowIndex,cellIndex:n[0].cellIndexes[0]});o={data:f,cellIndex:n[0].cellIndexes[0],currentCell:r,selectedRowCellIndex:this.selectedRowCellIndexes,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0};o.previousRowCellIndex=this.prevECIdxs;this.onActionComplete(o,ns)}}},n.prototype.addCellsToSelection=function(n){var u,s,r,c,f,p,e,w,v,o,b;if(this.isCellType()){r=this.parent;this.currentIndex=n[0].rowIndex;var h=this.getCurrentBatchRecordChanges()[this.currentIndex],k=r.getFrozenLeftCount(),nt=r.getMovableColumnsCount();if(!this.isSingleSel()&&this.isCellType()&&!this.isEditing()){this.hideAutoFill();f=r.getColumnByIndex(n[0].cellIndex);vu(this.parent,function(t,i){c=i[n[0].rowIndex]},[f.getFreezeTableName()&&f.getFreezeTableName()!==rt?[]:r.getRowsObject(),"movable"===f.getFreezeTableName()?r.getMovableRowsObject():[],f.getFreezeTableName()===d?r.getFrozenRightRowsObject():[]]);r.groupSettings.columns.length>0&&(c=r.getRowObjectFromUID(this.target.parentElement.getAttribute("data-uid")));for(var l=[],y=0,g=n;y<g.length;y++){for(var i=g[y],a=0,tt=this.selectedRowCellIndexes.length;a<tt;a++)if(this.selectedRowCellIndexes[parseInt(a.toString(),10)].rowIndex===i.rowIndex){s=a;break}if((u=this.getSelectedMovableCell(i))||(u=r.getCellFromIndex(i.rowIndex,this.getColIndex(i.rowIndex,i.cellIndex))),p="movable"===f.getFreezeTableName()?i.cellIndex-k:f.getFreezeTableName()===d?i.cellIndex-(k+nt):i.cellIndex,r.groupSettings.columns.length>0?l.push(c.cells[p+r.groupSettings.columns.length].foreignKeyData):l.push(c.cells[parseInt(p.toString(),10)].foreignKeyData),e={cancel:!1,data:h,cellIndex:n[0],isShiftPressed:this.isMultiShiftRequest,currentCell:u,isCtrlPressed:this.isMultiCtrlRequest,previousRowCell:this.prevECIdxs?r.getCellFromIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0},w="previousRowCellIndex",e[""+w]=this.prevECIdxs,v=s>-1,v)o=this.selectedRowCellIndexes[parseInt(s.toString(),10)].cellIndexes,o.indexOf(i.cellIndex)>-1?(this.cellDeselect(hy,[{rowIndex:i.rowIndex,cellIndexes:[i.cellIndex]}],h,[u],l),o.splice(o.indexOf(i.cellIndex),1),0===o.length&&this.selectedRowCellIndexes.splice(s,1),u.classList.remove("e-cellselectionbackground"),u.removeAttribute("aria-selected"),this.cellDeselect(cy,[{rowIndex:i.rowIndex,cellIndexes:[i.cellIndex]}],h,[u],l)):(v=!1,this.onActionBegin(e,le),this.addRowCellIndex({rowIndex:i.rowIndex,cellIndex:i.cellIndex}),this.updateCellSelection(u),this.addAttribute(u));else{if(this.onActionBegin(e,le),!t.isNullOrUndefined(e)&&!0===e.cancel)return;this.updateCellSelection(u,i.rowIndex,i.cellIndex)}v||(b={data:h,cellIndex:n[0],currentCell:u,previousRowCell:this.prevECIdxs?this.getCellIndex(this.prevECIdxs.rowIndex,this.prevECIdxs.cellIndex):void 0,selectedRowCellIndex:this.selectedRowCellIndexes},b[""+w]=this.prevECIdxs,this.onActionComplete(b,ns),this.cellselected=!0);this.updateCellProps(i,i)}}}},n.prototype.getColIndex=function(n,t){var f=this.parent.isFrozenGrid(),r=this.parent.getColumnByIndex(t),u=lb(this.parent,r,n),i;if(u)for(i=0;i<u.length;i++)if(parseInt(u[parseInt(i.toString(),10)].getAttribute(lt),10)===t)return f&&("movable"===r.getFreezeTableName()?i+=this.parent.getFrozenLeftCount():r.getFreezeTableName()===d&&(i+=this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount())),i;return-1},n.prototype.getLastColIndex=function(n){var t=this.parent.getFrozenColumns()?this.parent.getMovableDataRows()[parseInt(n.toString(),10)].querySelectorAll("td.e-rowcell"):this.parent.getDataRows()[parseInt(n.toString(),10)].querySelectorAll("td.e-rowcell");return parseInt(t[t.length-1].getAttribute(lt),10)},n.prototype.clearCell=function(){this.clearCellSelection()},n.prototype.cellDeselect=function(n,i,r,u,f){u[0]&&u[0].classList.contains(rf)&&this.updateCheckBoxes(t.closest(u[0],"tr"));var e={cells:u,data:r,cellIndexes:i,foreignKeyData:f,cancel:!1};this.parent.trigger(n,e);this.isPreventCellSelect=e.cancel},n.prototype.updateCellSelection=function(n,i,r){t.isNullOrUndefined(i)||this.addRowCellIndex({rowIndex:i,cellIndex:r});n.classList.add("e-cellselectionbackground");n.classList.contains(rf)&&this.updateCheckBoxes(t.closest(n,"tr"),!0);this.addAttribute(n)},n.prototype.addAttribute=function(n){this.target=n;t.isNullOrUndefined(n)||(n.setAttribute("aria-selected","true"),this.preventFocus||this.focus.onClick({target:n},!0))},n.prototype.updateCellProps=function(n,t){this.prevCIdxs=n;this.prevECIdxs=t;this.isCellSelected=this.selectedRowCellIndexes.length&&!0},n.prototype.addRowCellIndex=function(n){for(var r,i,t=0,u=this.selectedRowCellIndexes.length;t<u;t++)if(this.selectedRowCellIndexes[parseInt(t.toString(),10)].rowIndex===n.rowIndex){r=!0;i=t;break}r?this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes.indexOf(n.cellIndex)<0&&this.selectedRowCellIndexes[parseInt(i.toString(),10)].cellIndexes.push(n.cellIndex):this.selectedRowCellIndexes.push({rowIndex:n.rowIndex,cellIndexes:[n.cellIndex]})},n.prototype.clearCellSelection=function(){var n,u,c;if(this.isCellSelected){var f=this.parent,e=this.getSelectedCellsElement(),t=this.selectedRowCellIndexes,o=[],r=[],s=[],l=this.getCurrentBatchRecordChanges(),a=f.isFrozenGrid();for(this.hideAutoFill(),n=0,u=t.length;n<u;n++){o.push(l[t[parseInt(n.toString(),10)].rowIndex]);for(var h=this.getRowObj(t[parseInt(n.toString(),10)].rowIndex),i=0,v=t[parseInt(n.toString(),10)].cellIndexes.length;i<v;i++)a?(c=f.getColumnByIndex(t[parseInt(n.toString(),10)].cellIndexes[parseInt(i.toString(),10)]),r.push(yv(this.parent,c,t[parseInt(n.toString(),10)].rowIndex,t[parseInt(n.toString(),10)].cellIndexes[parseInt(i.toString(),10)]))):(h.cells&&s.push(h.cells[t[parseInt(n.toString(),10)].cellIndexes[parseInt(i.toString(),10)]].foreignKeyData),r.push(f.getCellFromIndex(t[parseInt(n.toString(),10)].rowIndex,t[parseInt(n.toString(),10)].cellIndexes[parseInt(i.toString(),10)])))}if(this.cellDeselect(hy,t,o,r,s),!0===this.isPreventCellSelect)return;for(n=0,u=e.length;n<u;n++)e[parseInt(n.toString(),10)].classList.remove("e-cellselectionbackground"),e[parseInt(n.toString(),10)].removeAttribute("aria-selected");this.bdrElement&&this.showHideBorders("none");this.selectedRowCellIndexes=[];this.isCellSelected=!1;!this.isDragged&&this.cellselected&&this.cellDeselect(cy,t,o,r,s)}},n.prototype.getSelectedCellsElement=function(){var u,n=this.parent,t=n.getDataRows();n.isFrozenGrid()&&(u=n.getMovableDataRows(),t=n.addMovableRows(t,u),n.getFrozenMode()===s&&(t=n.addMovableRows(t,n.getFrozenRightDataRows())));for(var i=[],r=0,f=t.length;r<f;r++)i=i.concat([].slice.call(t[parseInt(r.toString(),10)].getElementsByClassName("e-cellselectionbackground")));return i},n.prototype.mouseMoveHandler=function(n){var c,l;n.preventDefault();var f,v=this.parent.element.getBoundingClientRect(),r=this.x,u=this.y,y=su(n),e=y.x-v.left,o=y.y-v.top,s=t.closest(n.target,"tr");(this.isDragged=!0,this.isCellDrag||(s||(s=t.closest(document.elementFromPoint(this.parent.element.offsetLeft+2,n.clientY),"tr")),r>e&&(f=e,e=r,r=f),u>o&&(f=o,o=u,u=f),this.element.style.left=r+"px",this.element.style.top=u+"px",this.element.style.width=e-r+"px",this.element.style.height=o-u+"px"),!s||n.ctrlKey||n.shiftKey)||(c=parseInt(s.getAttribute(h),10),this.isCellDrag?(l=i(n.target,a),l&&(this.startAFCell=this.startCell,this.endAFCell=i(n.target,a),this.selectLikeExcel(n,c,parseInt(l.getAttribute(lt),10)))):(this.hideAutoFill(),this.selectRowsByRange(this.startDIndex,c),this.isRowDragSelected=!0))},n.prototype.selectLikeExcel=function(n,t,i){this.isAutoFillSel?(this.showAFBorders(),this.selectLikeAutoFill(n)):(this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:t,cellIndex:i}),this.drawBorders())},n.prototype.drawBorders=function(){"BoxWithBorder"===this.selectionSettings.cellSelectionMode&&this.selectedRowCellIndexes.length&&!this.parent.isEdit?(this.parent.element.classList.add("e-enabledboxbdr"),this.bdrElement||this.createBorders(),this.positionBorders()):this.showHideBorders("none")},n.prototype.isLastCell=function(n){var t=[].slice.call(n.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"));return t[t.length-1]===n},n.prototype.isLastRow=function(n){var i=[].slice.call(t.closest(n,e).querySelectorAll(".e-row:not(.e-hiddenrow)"));return n.parentElement===i[i.length-1]},n.prototype.isFirstRow=function(n){var i=[].slice.call(t.closest(n,e).querySelectorAll(".e-row:not(.e-hiddenrow)"));return n.parentElement===i[0]},n.prototype.isFirstCell=function(n){return[].slice.call(n.parentElement.querySelectorAll(".e-rowcell:not(.e-hide)"))[0]===n},n.prototype.setBorders=function(n,t,i){var o=[].slice.call(n.getElementsByClassName("e-cellselectionbackground")).filter(function(n){return""===n.style.display});if(o.length){var y=this.parent.isFrozenGrid(),f=o[0],l=o[o.length-1],r=f.getBoundingClientRect(),u=l.getBoundingClientRect(),e=f.offsetParent.getBoundingClientRect(),a=!this.isLastRow(l)||"1"!==i&&"2"!==i&&"5"!==i?0:2,c=this.parent.frozenRows&&("1"===i||"2"===i)&&this.isFirstRow(f)?1.5:0,h=y&&("2"===i||"4"===i)&&this.isFirstCell(f)?1:0,v=("Right"!==this.parent.getFrozenMode()||"1"!==i&&"3"!==i)&&(this.parent.getFrozenMode()!==s||"5"!==i&&"6"!==i)||!this.isFirstCell(f)?0:1;this.parent.enableRtl?(t.style.right=e.right-r.right-h+"px",t.style.width=r.right-u.left+h+1+"px"):(t.style.left=r.left-e.left-h-v+"px",t.style.width=u.right-r.left+h-v+1+"px");t.style.top=r.top-e.top-c+"px";t.style.height=u.top-r.top>0?u.top-e.top+u.height+1-(r.top-e.top)-a+c+"px":u.height+c-a+1+"px";this.selectDirection+=i}else t.style.display="none"},n.prototype.positionBorders=function(){this.updateStartEndCells();this.startCell&&this.bdrElement&&this.selectedRowCellIndexes.length&&(this.selectDirection="",this.showHideBorders(""),this.setBorders(this.parent.getContentTable(),this.bdrElement,"1"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.contentModule.getMovableContent(),this.mcBdrElement,"2"),this.parent.getFrozenMode()===s&&this.setBorders(this.parent.contentModule.getFrozenRightContent(),this.frcBdrElement,"5")),this.parent.frozenRows&&(this.setBorders(this.parent.getHeaderTable(),this.fhBdrElement,"3"),this.parent.isFrozenGrid()&&(this.setBorders(this.parent.headerModule.getMovableHeader(),this.mhBdrElement,"4"),this.parent.getFrozenMode()===s&&this.setBorders(this.parent.headerModule.getFrozenRightHeader(),this.frhBdrElement,"6"))),this.applyBorders(this.selectDirection))},n.prototype.applyBothFrozenBorders=function(n){var t=this.parent.enableRtl;switch(n.length){case 6:this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left;this.mcBdrElement.style.borderWidth=this.bottom;this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left;this.mhBdrElement.style.borderWidth=this.top;this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom;this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right;break;case 4:n.includes("1")&&n.includes("2")&&n.includes("3")&&n.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom);n.includes("2")&&n.includes("4")&&n.includes("5")&&n.includes("6")&&(this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.frcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.frhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 3:this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left;this.mcBdrElement.style.borderWidth=this.top_bottom;this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom;this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.mhBdrElement.style.borderWidth=this.top_bottom,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom);break;case 2:n.includes("1")&&(this.mcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.top_right_left));n.includes("2")&&(this.bdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.parent.frozenRows&&(this.mhBdrElement.style.borderWidth=this.top_right_left));n.includes("3")&&(this.mhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.bdrElement.style.borderWidth=this.right_bottom_left);n.includes("4")&&(this.fhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frhBdrElement.style.borderWidth=t?this.top_bottom_left:this.top_right_bottom,this.mcBdrElement.style.borderWidth=this.right_bottom_left);n.includes("5")&&(this.mcBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.parent.frozenRows&&(this.frhBdrElement.style.borderWidth=this.top_right_left));n.includes("6")&&(this.mhBdrElement.style.borderWidth=t?this.top_right_bottom:this.top_bottom_left,this.frcBdrElement.style.borderWidth=this.right_bottom_left);break;default:this.bdrElement.style.borderWidth=this.all_border;this.mcBdrElement.style.borderWidth=this.all_border;this.frcBdrElement.style.borderWidth=this.all_border;this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.mhBdrElement.style.borderWidth=this.all_border,this.frhBdrElement.style.borderWidth=this.all_border)}},n.prototype.applyBorders=function(n){var t=this.parent.enableRtl;if(this.parent.getFrozenMode()===s)this.applyBothFrozenBorders(n);else switch(n.length){case 4:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.mcBdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.fhBdrElement.style.borderWidth=t?this.top_left:this.top_right,this.mhBdrElement.style.borderWidth=t?this.top_right:this.top_left):(this.bdrElement.style.borderWidth=t?this.right_bottom:this.bottom_left,this.mcBdrElement.style.borderWidth=t?this.bottom_left:this.right_bottom,this.fhBdrElement.style.borderWidth=t?this.top_right:this.top_left,this.mhBdrElement.style.borderWidth=t?this.top_left:this.top_right);break;case 2:"Right"===this.parent.getFrozenMode()?(this.bdrElement.style.borderWidth=n.includes("2")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left,this.mcBdrElement.style.borderWidth=n.includes("1")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=n.includes("1")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom,this.mhBdrElement.style.borderWidth=n.includes("2")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left)):(this.bdrElement.style.borderWidth=n.includes("2")?t?this.top_right_bottom:this.top_bottom_left:this.right_bottom_left,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=n.includes("1")?t?this.top_bottom_left:this.top_right_bottom:this.right_bottom_left),this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=n.includes("1")?this.top_right_left:t?this.top_right_bottom:this.top_bottom_left,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=n.includes("2")?this.top_right_left:t?this.top_bottom_left:this.top_right_bottom)));break;default:this.bdrElement.style.borderWidth=this.all_border;this.parent.isFrozenGrid()&&(this.mcBdrElement.style.borderWidth=this.all_border);this.parent.frozenRows&&(this.fhBdrElement.style.borderWidth=this.all_border,this.parent.isFrozenGrid()&&(this.mhBdrElement.style.borderWidth=this.all_border))}},n.prototype.createBorders=function(){this.bdrElement||(this.bdrElement=this.parent.getContentTable().parentElement.appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_bdr",styles:"width: 2px; border-width: 0;"})),this.parent.isFrozenGrid()&&(this.mcBdrElement=this.parent.contentModule.getMovableContent().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mcbdr",styles:"height: 2px; border-width: 0;"})),this.parent.getFrozenMode()===s&&(this.frcBdrElement=this.parent.contentModule.getFrozenRightContent().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frcbdr",styles:"height: 2px; border-width: 0;"})))),this.parent.frozenRows&&(this.fhBdrElement=this.parent.getHeaderTable().parentElement.appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_fhbdr",styles:"height: 2px;"}))),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement=this.parent.headerModule.getMovableHeader().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_mhbdr",styles:"height: 2px;"})),this.parent.getFrozenMode()===s&&(this.frhBdrElement=this.parent.headerModule.getFrozenRightHeader().appendChild(t.createElement("div",{className:"e-xlsel",id:this.parent.element.id+"_frhbdr",styles:"height: 2px;"})))))},n.prototype.showHideBorders=function(n){this.bdrElement&&(this.bdrElement.style.display=n,this.parent.isFrozenGrid()&&(this.mcBdrElement.style.display=n,this.parent.getFrozenMode()===s&&(this.frcBdrElement.style.display=n)),this.parent.frozenRows&&(this.fhBdrElement.style.display=n),this.parent.frozenRows&&this.parent.isFrozenGrid()&&(this.mhBdrElement.style.display=n,this.parent.getFrozenMode()===s&&(this.frhBdrElement.style.display=n)))},n.prototype.drawAFBorders=function(){this.bdrAFBottom||this.createAFBorders();this.positionAFBorders()},n.prototype.positionAFBorders=function(){var c,v,y,b;if(this.startCell&&this.bdrAFLeft){var t=this.startAFCell.getBoundingClientRect(),n=this.endAFCell.getBoundingClientRect(),k=n.top-t.top>0?1:0,s=n.top-t.top>=0&&(i(this.startAFCell,p)||i(this.startAFCell,"e-frozencontent"))&&this.isFirstRow(this.startAFCell)?1.5:0,e=(i(this.startAFCell,p)||i(this.startAFCell,w))&&this.isFirstCell(this.startAFCell)?1:0,l=this.isLastRow(this.endAFCell)&&(i(this.endAFCell,p)||i(this.endAFCell,"e-frozencontent"))?2:0,a=this.startAFCell.offsetParent.getBoundingClientRect(),r=this.parent.element.getBoundingClientRect(),d=this.startAFCell.offsetParent.parentElement.scrollTop,g=this.startAFCell.offsetParent.parentElement.scrollLeft,u=d-this.startAFCell.offsetTop,f=g-this.startAFCell.offsetLeft,h=this.parent.element.clientHeight,o=this.parent.element.clientWidth;u=u>0?Math.floor(u)-1:0;f=f>0?f:0;c=t.left-r.left;this.parent.enableRtl?(v=i(this.startAFCell,p)||i(this.startAFCell,w)?t.right-this.startAFCell.offsetParent.parentElement.getBoundingClientRect().width-r.left:0,this.bdrAFLeft.style.right=r.right-n.right-2+n.width+"px",this.bdrAFLeft.style.width=o<=parseInt(this.bdrAFLeft.style.right,10)?"0px":"2px",this.bdrAFRight.style.right=r.right-t.right-e+v-1+"px",this.bdrAFTop.style.left=n.left-r.left-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFLeft.style.right,10)-parseInt(this.bdrAFRight.style.right,10)-e+1+"px",parseInt(this.bdrAFTop.style.left,10)<0&&(this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)+"px",this.bdrAFTop.style.left="0px")):(this.bdrAFLeft.style.left=c-e+f-1+"px",this.bdrAFRight.style.left=n.left-r.left-2+n.width+"px",this.bdrAFRight.style.width=o<=parseInt(this.bdrAFRight.style.left,10)?"0px":"2px",this.bdrAFTop.style.left=c+f-.5+"px",this.bdrAFTop.style.width=parseInt(this.bdrAFRight.style.left,10)-parseInt(this.bdrAFLeft.style.left,10)-e+1+"px",o<=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10))&&(y=parseInt(this.bdrAFTop.style.width,10)+parseInt(this.bdrAFTop.style.left,10)-o,this.bdrAFTop.style.width=parseInt(this.bdrAFTop.style.width,10)-y+"px");(this.bdrAFLeft.style.top=t.top-r.top-s+u+"px",this.bdrAFLeft.style.height=n.top-t.top>0?n.top-a.top+n.height+1-(t.top-a.top)+s-l-u+"px":n.height+s-l-u+"px",this.bdrAFRight.style.top=this.bdrAFLeft.style.top,this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px",this.bdrAFTop.style.top=this.bdrAFRight.style.top,this.bdrAFBottom.style.left=this.bdrAFTop.style.left,this.bdrAFBottom.style.top=parseFloat(this.bdrAFLeft.style.top)+parseFloat(this.bdrAFLeft.style.height)-k-1+"px",this.bdrAFBottom.style.width=h<=parseFloat(this.bdrAFBottom.style.top)?"0px":this.bdrAFTop.style.width,h<=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10))&&(b=parseInt(this.bdrAFLeft.style.height,10)+parseInt(this.bdrAFLeft.style.top,10)-h,this.bdrAFLeft.style.height=parseInt(this.bdrAFLeft.style.height,10)-b+"px",this.bdrAFRight.style.height=parseInt(this.bdrAFLeft.style.height,10)+"px")}},n.prototype.createAFBorders=function(){this.bdrAFLeft||(this.bdrAFLeft=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafleft",styles:"width: 2px;"})),this.bdrAFRight=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafright",styles:"width: 2px;"})),this.bdrAFBottom=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdrafbottom",styles:"height: 2px;"})),this.bdrAFTop=this.parent.element.appendChild(t.createElement("div",{className:"e-xlselaf",id:this.parent.element.id+"_bdraftop",styles:"height: 2px;"})))},n.prototype.showAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="",this.bdrAFRight.style.display="",this.bdrAFBottom.style.display="",this.bdrAFTop.style.display="")},n.prototype.hideAFBorders=function(){this.bdrAFLeft&&(this.bdrAFLeft.style.display="none",this.bdrAFRight.style.display="none",this.bdrAFBottom.style.display="none",this.bdrAFTop.style.display="none")},n.prototype.updateValue=function(n,t,i){var u=this.createBeforeAutoFill(n,t,i),r;u.cancel||(r=this.parent.getColumnByIndex(t),this.parent.editModule&&i&&("number"===r.type?this.parent.editModule.updateCell(n,r.field,parseFloat(u.value)):this.parent.editModule.updateCell(n,r.field,u.value)))},n.prototype.createBeforeAutoFill=function(n,t,i){var r={column:this.parent.getColumnByIndex(t),value:i.innerText};return this.parent.trigger(og,r),r},n.prototype.getAutoFillCells=function(n){var i=".e-cellselectionbackground",t=[].slice.call(this.parent.getDataRows()[parseInt(n.toString(),10)].querySelectorAll(i));return this.parent.isFrozenGrid()&&(t=t.concat([].slice.call(this.parent.getMovableDataRows()[parseInt(n.toString(),10)].querySelectorAll(i))),this.parent.getFrozenMode()===s&&(t=t.concat([].slice.call(this.parent.getFrozenRightDataRows()[parseInt(n.toString(),10)].querySelectorAll(i))))),t},n.prototype.selectLikeAutoFill=function(n,t){var f=parseInt(i(this.startAFCell,y).getAttribute(h),10),r=parseInt(this.startAFCell.getAttribute(lt),10),o=parseInt(i(this.endAFCell,y).getAttribute(h),10),s=parseInt(this.endAFCell.getAttribute(lt),10),p=this.selectedRowCellIndexes.length-1,c=this.selectedRowCellIndexes[0].cellIndexes.length-1,d,u,v,b,k;switch(!0){case!t&&this.endAFCell.classList.contains("e-cellselectionbackground")&&!!i(n.target,a):this.startAFCell=this.parent.getCellFromIndex(f,r);this.endAFCell=this.parent.getCellFromIndex(f+p,r+c);this.drawAFBorders();break;case this.autoFillRLselection&&r+c<s&&s-r-c+1>o-f-p&&s-r-c+1>f-o:if(this.endAFCell=this.parent.getCellFromIndex(f+p,s),o=parseInt(i(this.endAFCell,y).getAttribute(h),10),s=parseInt(this.endAFCell.getAttribute(lt),10),t){for(d=parseInt(this.endCell.getAttribute(lt),10),u=f;u<=o;u++)for(var w=this.getAutoFillCells(u,r),e=0,l=d+1;l<=s;l++)e>c&&(e=0),this.updateValue(u,l,w[parseInt(e.toString(),10)]),e++;this.selectCellsByRange({rowIndex:f,cellIndex:this.startCellIndex},{rowIndex:o,cellIndex:s})}else this.drawAFBorders();break;case this.autoFillRLselection&&r>s&&r-s+1>o-f-p&&r-s+1>f-o:if(this.startAFCell=this.parent.getCellFromIndex(f,s),this.endAFCell=this.endCell,t){for(u=f;u<=f+p;u++)for((w=this.getAutoFillCells(u,r)).reverse(),e=0,l=this.startCellIndex-1;l>=s;l--)e>c&&(e=0),this.updateValue(u,l,w[parseInt(e.toString(),10)]),e++;this.selectCellsByRange({rowIndex:f,cellIndex:s},{rowIndex:f+p,cellIndex:this.startCellIndex+c})}else this.drawAFBorders();break;case f>o:if(this.startAFCell=this.parent.getCellFromIndex(o,r),this.endAFCell=this.endCell,t){for(v=b=parseInt(this.endCell.parentElement.getAttribute(h),10),u=f-1;u>=o;u--)for(v===this.startIndex-1&&(v=b),w=this.getAutoFillCells(v,r),e=0,v--,l=this.startCellIndex;l<=this.startCellIndex+c;l++)this.updateValue(u,l,w[parseInt(e.toString(),10)]),e++;this.selectCellsByRange({rowIndex:o,cellIndex:r+c},{rowIndex:f+p,cellIndex:r})}else this.drawAFBorders();break;default:if(this.endAFCell=this.parent.getCellFromIndex(o,r+c),t){for(b=parseInt(this.endCell.parentElement.getAttribute(h),10),v=this.startIndex,u=b+1;u<=o;u++)for(v===b+1&&(v=this.startIndex),w=this.getAutoFillCells(v,r),v++,e=0,k=this.startCellIndex;k<=this.startCellIndex+c;k++)this.updateValue(u,k,w[parseInt(e.toString(),10)]),e++;this.selectCellsByRange({rowIndex:b-p,cellIndex:r},{rowIndex:o,cellIndex:r+c})}else this.drawAFBorders()}},n.prototype.mouseUpHandler=function(n){var r,u,f,e;document.body.classList.remove("e-disableuserselect");this.element&&t.remove(this.element);this.mUPTarget=this.isDragged&&1===this.selectedRowCellIndexes.length&&1===this.selectedRowCellIndexes[0].cellIndexes.length?i(n.target,a):null;r=t.closest(n.target,".e-rowcell");this.isDragged&&!this.isAutoFillSel&&"Cell"===this.selectionSettings.mode&&r&&r.classList.contains(a)&&(u=parseInt(r.parentElement.getAttribute(h),10),f=parseInt(r.getAttribute(lt),10),this.isDragged=!1,this.clearCellSelection(),this.selectCellsByRange({rowIndex:this.startDIndex,cellIndex:this.startDCellIndex},{rowIndex:u,cellIndex:f}));(this.isDragged=!1,this.updateAutoFillPosition(),this.isAutoFillSel)&&(e=i(n.target,a),this.endAFCell=e||(this.endCell===this.endAFCell?this.startAFCell:this.endAFCell),this.startAFCell=this.startCell,this.updateStartCellsIndex(),this.selectLikeAutoFill(n,!0),this.updateAutoFillPosition(),this.hideAFBorders(),this.positionBorders(),this.isAutoFillSel=!1);t.EventHandler.remove(this.parent.getContent(),"mousemove",this.mouseMoveHandler);this.parent.frozenRows&&t.EventHandler.remove(this.parent.getHeaderContent(),"mousemove",this.mouseMoveHandler);t.EventHandler.remove(document,"mouseup",this.mouseUpHandler)},n.prototype.hideAutoFill=function(){this.autofill&&(this.autofill.style.display="none")},n.prototype.updateAutoFillPosition=function(){var n;if(this.parent.enableAutoFill&&!this.parent.isEdit&&this.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel()&&this.selectedRowCellIndexes.length){var f=parseInt(this.target.getAttribute(lt),10),a=parseInt(this.target.getAttribute("index"),10),v=this.selectedRowCellIndexes[this.selectedRowCellIndexes.length-1].rowIndex,e=this.getAutoFillCells(v,f).filter(function(n){return""===n.style.display}),o=this.parent.getColumnByIndex(f),h="movable"===o.getFreezeTableName(),c=a<this.parent.frozenRows,y=this.parent.getFrozenMode()===s&&o.getFreezeTableName()===d;if(t.select("#"+this.parent.element.id+"_autofill",i(this.target,k))||(t.select("#"+this.parent.element.id+"_autofill",this.parent.element)&&t.select("#"+this.parent.element.id+"_autofill",this.parent.element).remove(),this.autofill=t.createElement("div",{className:"e-autofill",id:this.parent.element.id+"_autofill"}),this.autofill.style.display="none",c?h?this.parent.headerModule.getMovableHeader().appendChild(this.autofill):this.parent.getHeaderTable().parentElement.appendChild(this.autofill):h?this.parent.contentModule.getMovableContent().appendChild(this.autofill):this.parent.getContentTable().parentElement.appendChild(this.autofill),y&&(c?this.parent.getFrozenRightHeader().appendChild(this.autofill):this.parent.getFrozenRightContent().appendChild(this.autofill))),n=e[e.length-1],n&&n.offsetParent){var r=n.getBoundingClientRect(),u=n.offsetParent.getBoundingClientRect(),l=this.isLastCell(n)?4:0,p=this.isLastRow(n)?3:0;this.parent.enableRtl?this.autofill.style.right=u.right-r.right+r.width-4-l+"px":this.autofill.style.left=r.left-u.left+r.width-4-l+"px";this.autofill.style.top=r.top-u.top+r.height-5-p+"px"}this.autofill.style.display=""}else this.hideAutoFill()},n.prototype.mouseDownHandler=function(n){this.mouseButton=n.button;var f,r=n.target,u=this.parent,e=i(r,"e-grid");if(!(e&&e.id!==u.element.id||i(r,st)&&!this.parent.frozenRows||i(r,"e-editedbatchcell")||i(r,ni))){if((n.shiftKey||n.ctrlKey)&&n.preventDefault(),i(r,a)&&!n.shiftKey&&!n.ctrlKey){if(u.selectionSettings.cellSelectionMode.indexOf("Box")>-1&&!this.isRowType()&&!this.isSingleSel())this.isCellDrag=!0,f=!0;else if(u.allowRowDragAndDrop&&!u.isEdit&&!this.parent.selectionSettings.checkboxOnly){if(this.isRowDragSelected=!1,!this.isRowType()||this.isSingleSel()||t.closest(r,"td").classList.contains("e-selectionbackground"))return void(this.isDragged=!1);f=!0;this.element=this.parent.createElement("div",{className:"e-griddragarea"});u.getContent().appendChild(this.element)}f&&this.enableDrag(n,!0)}this.updateStartEndCells();(r.classList.contains("e-autofill")||r.classList.contains("e-xlsel"))&&(this.isCellDrag=!0,this.isAutoFillSel=!0,this.enableDrag(n))}},n.prototype.updateStartEndCells=function(){var n=[].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground"));this.startCell=n[0];this.endCell=n[n.length-1];this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(h),10),this.startCellIndex=parseInt(i(this.startCell,a).getAttribute(lt),10))},n.prototype.updateStartCellsIndex=function(){this.startCell&&(this.startIndex=parseInt(this.startCell.parentElement.getAttribute(h),10),this.startCellIndex=parseInt(i(this.startCell,a).getAttribute(lt),10))},n.prototype.enableDrag=function(n,r){var u=this.parent,o,f,e;r&&(o=t.closest(n.target,"tr"),this.startDIndex=parseInt(o.getAttribute(h),10),this.startDCellIndex=parseInt(i(n.target,a).getAttribute(lt),10));document.body.classList.add("e-disableuserselect");f=u.element.getBoundingClientRect();e=su(n);this.x=e.x-f.left;this.y=e.y-f.top;t.EventHandler.add(u.getContent(),"mousemove",this.mouseMoveHandler,this);this.parent.frozenRows&&t.EventHandler.add(u.getHeaderContent(),"mousemove",this.mouseMoveHandler,this);t.EventHandler.add(document,"mouseup",this.mouseUpHandler,this)},n.prototype.clearSelAfterRefresh=function(n){var u=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType,i,r,t,f;if("virtualscroll"===n.requestType||this.parent.isPersistSelection||u||this.clearSelection(),("virtualscroll"===n.requestType||u)&&this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){for(i=this.parent.getRowsObject().filter(function(n){return n.isSelectable}),r=[],this.selectedRowState={},this.persistSelectedData=[],t=0;t<i.length;t++)r.push(i[parseInt(t.toString(),10)].index),f=this.getPkValue(this.primaryKey,i[parseInt(t.toString(),10)].data),this.selectedRowState[""+f]=!0,this.persistSelectedData.push(i[parseInt(t.toString(),10)].data);this.selectedRowIndexes=r}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:tt,handler:this.enableAfterRender},{event:dt,handler:this.initializeSelection},{event:vg,handler:this.onActionComplete},{event:yg,handler:this.onActionComplete},{event:gt,handler:this.onPropertyChanged},{event:us,handler:this.onCellFocused},{event:vp,handler:this.clearSelAfterRefresh},{event:wf,handler:this.columnPositionChanged},{event:it,handler:this.initialEnd},{event:fs,handler:this.rowsRemoved},{event:yt,handler:this.refreshHeader},{event:v,handler:this.destroy}],vt(this.parent,this.evtHandlers,!0,this),this.actionBeginFunction=this.actionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.parent.addEventListener(nt,this.actionBeginFunction),this.parent.addEventListener(l,this.actionCompleteFunction),this.addEventListener_checkbox())},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(vt(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(nt,this.actionBeginFunction),this.parent.removeEventListener(l,this.actionCompleteFunction),this.removeEventListener_checkbox())},n.prototype.wireEvents=function(){this.isMacOS=-1!==navigator.userAgent.indexOf("Mac OS");this.isMacOS?(t.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this),t.EventHandler.add(this.parent.element,"keyup",this.keyUpHandler,this)):this.parent.allowKeyboard||t.EventHandler.add(this.parent.element,"keydown",this.keyDownHandler,this)},n.prototype.unWireEvents=function(){this.isMacOS?(t.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler),t.EventHandler.remove(this.parent.element,"keyup",this.keyUpHandler)):this.parent.allowKeyboard||t.EventHandler.remove(this.parent.element,"keydown",this.keyDownHandler)},n.prototype.columnPositionChanged=function(){this.parent.isPersistSelection||this.clearSelection()},n.prototype.refreshHeader=function(){this.setCheckAllState()},n.prototype.rowsRemoved=function(n){for(var i,t=0;t<n.records.length;t++)i=this.getPkValue(this.primaryKey,n.records[parseInt(t.toString(),10)]),delete this.selectedRowState[""+i],--this.totalRecordsCount;this.setCheckAllState()},n.prototype.beforeFragAppend=function(n){"virtualscroll"===n.requestType||this.parent.isPersistSelection||this.clearSelection()},n.prototype.getCheckAllBox=function(){return this.parent.getHeaderContent().querySelector(".e-checkselectall")},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.render(),this.initPerisistSelection())},n.prototype.render=function(){t.EventHandler.add(this.parent.getContent(),"mousedown",this.mouseDownHandler,this);t.EventHandler.add(this.parent.getHeaderContent(),"mousedown",this.mouseDownHandler,this)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){var i=this.parent;t.isNullOrUndefined(n.properties.type)||"Single"!==this.selectionSettings.type||(this.selectedRowCellIndexes.length>1&&(this.clearCellSelection(),this.prevCIdxs=void 0),this.selectedRowIndexes.length>1&&(this.clearRowSelection(),this.prevRowIndex=void 0),this.selectedColumnsIndexes.length>1&&(this.clearColumnSelection(),this.prevColIndex=void 0),this.enableSelectMultiTouch=!1,this.hidePopUp());t.isNullOrUndefined(n.properties.mode)&&t.isNullOrUndefined(n.properties.cellSelectionMode)||(this.clearSelection(),this.prevRowIndex=void 0,this.prevCIdxs=void 0,this.prevColIndex=void 0);this.isPersisted=!0;this.checkBoxSelectionChanged();this.isPersisted=!1;this.parent.isCheckBoxSelection||this.initPerisistSelection();this.parent.getColumns().filter(function(n){return"checkbox"===n.type}).length&&(i.isCheckBoxSelection=!("ResetOnRowClick"===this.selectionSettings.checkboxMode));this.drawBorders()}},n.prototype.hidePopUp=function(){this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-rowselect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none")},n.prototype.initialEnd=function(n){var t=this.parent.isFrozenGrid(),i=this.parent.getFrozenMode()===s;t&&(!t||i||n.args.isFrozen)&&(!i||!n.args.renderFrozenRightContent)||this.selectedRowIndexes.length||(this.parent.off(it,this.initialEnd),this.selectRow(this.parent.selectedRowIndex))},n.prototype.checkBoxSelectionChanged=function(){var n=this.parent,i;n.off(it,this.checkBoxSelectionChanged);i=n.getColumns().filter(function(n){return"checkbox"===n.type});i.length>0&&(n.isCheckBoxSelection=!0,this.chkField=i[0].field,this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount,t.isNullOrUndefined(this.totalRecordsCount)&&(this.totalRecordsCount=this.getCurrentBatchRecordChanges().length),this.isSingleSel()?(n.selectionSettings.type="Multiple",n.dataBind()):this.initPerisistSelection());n.isCheckBoxSelection||this.isPersisted||(this.chkField=null,this.initPerisistSelection())},n.prototype.initPerisistSelection=function(){var n=this.parent;this.parent.selectionSettings.persistSelection&&this.parent.getPrimaryKeyFieldNames().length>0?(n.isPersistSelection=!0,this.ensureCheckboxFieldSelection()):this.parent.getPrimaryKeyFieldNames().length>0?(n.isPersistSelection=!1,this.ensureCheckboxFieldSelection()):(n.isPersistSelection=!1,this.selectedRowState={})},n.prototype.ensureCheckboxFieldSelection=function(){var i=this.parent,r,n,f,t;(this.primaryKey=this.parent.getPrimaryKeyFieldNames()[0],!i.enableVirtualization&&this.chkField&&(i.isPersistSelection&&0===Object.keys(this.selectedRowState).length||!i.isPersistSelection))&&(r=this.parent.getDataModule(),n=(new u.Query).where(this.chkField,"equal",!0),n.params||(n.params=this.parent.query.params),f=r.getData({},n),t=this,this.parent.showSpinner(),f.then(function(n){t.dataSuccess(n.result);t.refreshPersistSelection();t.parent.hideSpinner()}))},n.prototype.dataSuccess=function(n){for(var r,i=0;i<n.length;i++)r=this.getPkValue(this.primaryKey,n[parseInt(i.toString(),10)]),t.isNullOrUndefined(this.selectedRowState[""+r])&&n[parseInt(i.toString(),10)][this.chkField]&&(this.selectedRowState[""+r]=n[parseInt(i.toString(),10)][this.chkField]);this.persistSelectedData=n},n.prototype.setRowSelection=function(n){var v,y,r,s,h,u,c,p,f,e,l,i,o,a;if(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)if(n){if(v=Object.keys(this.selectedRowState),y=Object.keys(this.unSelectedRowState),!this.isCheckboxReset)for(r=0,s=this.parent.currentViewData;r<s.length;r++)(i=s[r],t.isNullOrUndefined(i[this.primaryKey]))||(h=i[this.primaryKey].toString(),-1===v.indexOf(h)&&-1===y.indexOf(h)&&(this.selectedRowState[i[this.primaryKey]]=!0))}else this.selectedRowState={},this.unSelectedRowState={},this.rmtHdrChkbxClicked=!1;else if(n)if(this.isPartialSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling))for(u=0,c=this.parent.getRowsObject().filter(function(n){return n.isSelectable});u<c.length;u++)p=c[u],this.selectedRowState[this.getPkValue(this.primaryKey,p.data)]=!0;else if(f=this.isPartialSelection?this.parent.partialSelectedRecords:this.getData(),this.parent.groupSettings.columns.length)for(e=0,l=this.isPartialSelection?f:f.records;e<l.length;e++)i=l[e],this.selectedRowState[this.getPkValue(this.primaryKey,i)]=!0;else for(o=0,a=f;o<a.length;o++)i=a[o],this.selectedRowState[this.getPkValue(this.primaryKey,i)]=!0;else this.selectedRowState={}},n.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},n.prototype.getAvailableSelectedData=function(){var n=new u.DataManager(this.persistSelectedData).executeLocal(this.parent.getDataModule().generateQuery(!0));return this.parent.groupSettings.columns.length&&n&&n.records&&(n=n.records.slice()),n},n.prototype.refreshPersistSelection=function(){var n=this.parent.getRows(),f,i,r,u,e,o;if(this.parent.isCheckBoxSelection&&this.parent.isFrozenGrid()&&(this.parent.getMovableContentTbody().querySelector(".e-checkselect")&&(n=this.parent.getMovableRows()),this.parent.getFrozenMode()===s&&this.parent.getFrozenRightContentTbody().querySelector(".e-checkselect")&&(n=this.parent.getFrozenRightRows())),this.totalRecordsCount=this.parent.getCurrentViewRecords().length,this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount),!t.isNullOrUndefined(n)&&n.length>0&&(this.parent.isPersistSelection||this.chkField)){for(f=[],i=0;i<n.length;i++){if(r=this.getRowObj(n[parseInt(i.toString(),10)]),u=r&&r.data?this.getPkValue(this.primaryKey,r.data):null,null===u)return;(!this.isPartialSelection||r.isSelectable)&&(e=void 0,o=n[parseInt(i.toString(),10)].querySelector(".e-checkselect"),this.selectedRowState[""+u]||"Check"===this.parent.checkAllRows&&this.selectedRowState[""+u]&&this.totalRecordsCount===Object.keys(this.selectedRowState).length&&this.chkAllCollec.indexOf(u)<0||"Uncheck"===this.parent.checkAllRows&&this.chkAllCollec.indexOf(u)>0&&!this.parent.selectedRowIndex||"Intermediate"===this.parent.checkAllRows&&!t.isNullOrUndefined(this.chkField)&&r.data[this.chkField]?(f.push(parseInt(n[parseInt(i.toString(),10)].getAttribute(h),10)),e=!0):(e=!1,this.checkedTarget!==o&&this.parent.isCheckBoxSelection&&o&&ho(o.nextElementSibling,e)),this.updatePersistCollection(n[parseInt(i.toString(),10)],e))}this.isSingleSel()&&f.length>0?this.selectRow(f[0],!0):this.selectRows(f)}(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode)&&this.getCurrentBatchRecordChanges().length>0&&this.setCheckAllState()},n.prototype.actionBegin=function(n){var i,r,u;if("save"===n.requestType&&this.parent.isPersistSelection&&(i=this.parent.element.querySelector(".e-edit-checkselect"),!t.isNullOrUndefined(i)))if(r=t.closest(i,"."+ni),r){if("Dialog"===this.parent.editSettings.mode&&(r=this.parent.element.querySelector(".e-dlgeditrow")),u=this.getRowObj(r),!u)return;this.selectedRowState[this.getPkValue(this.primaryKey,u.data)]=u.isSelected=i.checked}else this.isCheckedOnAdd=i.checked;this.parent.isPersistSelection&&this.isPartialSelection&&("paging"===n.requestType&&(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.selectedRowIndexes=[]),"filtering"!==n.requestType&&"searching"!==n.requestType||(this.parent.partialSelectedRecords=[],this.parent.disableSelectedRecords=[]))},n.prototype.actionComplete=function(n){var f,e,i,o,r,u;if("save"===n.requestType&&this.parent.isPersistSelection&&("add"===n.action&&(this.isCheckedOnAdd&&(f=this.parent.getRowObjectFromUID(this.parent.getRows()[n.selectedRow].getAttribute("data-uid")),this.selectedRowState[this.getPkValue(this.primaryKey,f.data)]=f.isSelected=this.isCheckedOnAdd),this.isHdrSelectAllClicked=!1,this.setCheckAllState()),this.refreshPersistSelection()),"delete"===n.requestType&&this.parent.isPersistSelection){for(e=n.data.slice(),i=0;i<e.length;i++)o=this.getPkValue(this.primaryKey,e[parseInt(i.toString(),10)]),t.isNullOrUndefined(o)||this.updatePersistDelete(o,this.isPartialSelection);this.isHdrSelectAllClicked=!1;this.setCheckAllState();this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount}if("paging"===n.requestType){if(this.parent.isPersistSelection&&this.isPartialSelection&&this.isHdrSelectAllClicked){for(r=this.parent.getRowsObject(),u=[],i=0;i<r.length;i++)r[parseInt(i.toString(),10)].isSelectable&&u.push(r[parseInt(i.toString(),10)].index);u.length&&this.selectRows(u)}this.prevRowIndex=void 0;this.prevCIdxs=void 0;this.prevECIdxs=void 0}},n.prototype.onDataBound=function(){if(!this.parent.enableVirtualization&&this.parent.isPersistSelection&&this.selectedRecords.length&&(this.isPrevRowSelection=!0),(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.rmtHdrChkbxClicked&&("Intermediate"===this.parent.checkAllRows?this.setRowSelection(!0):"Uncheck"===this.parent.checkAllRows&&this.setRowSelection(!1)),this.parent.enableVirtualization&&this.setCheckAllState(),this.parent.isPersistSelection&&this.refreshPersistSelection(),this.initialRowSelection=!!(this.isRowType()&&this.parent.element.querySelectorAll(".e-selectionbackground")&&this.parent.getSelectedRows().length),this.parent.isCheckBoxSelection&&!this.initialRowSelection){for(var r=this.parent.getRowsObject(),i=[],n=0;n<r.length;n++)r[parseInt(n.toString(),10)].isSelected&&i.push(n);i.length&&this.selectRows(i);this.initialRowSelection=!0}},n.prototype.updatePersistSelectedData=function(n){if(this.parent.isPersistSelection){for(var r=this.parent.getRows(),i=0;i<r.length;i++)this.updatePersistCollection(r[parseInt(i.toString(),10)],n);"Uncheck"===this.parent.checkAllRows?(this.setRowSelection(!1),this.persistSelectedData=this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?this.persistSelectedData:[]):"Check"===this.parent.checkAllRows&&(this.setRowSelection(!0),this.persistSelectedData=this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.isPartialSelection?this.persistSelectedData:this.parent.groupSettings.columns.length?this.getData().records.slice():this.getData().slice())}},n.prototype.checkSelectAllAction=function(n){var r=this.getRenderer(),u=this.parent.element.querySelector(".e-gridform"),i;(this.checkedTarget=this.getCheckAllBox(),n&&this.getCurrentBatchRecordChanges().length?(this.parent.checkAllRows="Check",this.updatePersistSelectedData(n),this.selectRowsByRange(r.getVirtualRowIndex(0),r.getVirtualRowIndex(this.getCurrentBatchRecordChanges().length-1))):(this.parent.checkAllRows="Uncheck",this.updatePersistSelectedData(n),this.clearSelection()),this.chkAllCollec=[],t.isNullOrUndefined(u))||(i=u.querySelector(".e-edit-checkselect"),t.isNullOrUndefined(i)||ho(i.nextElementSibling,n))},n.prototype.checkSelectAll=function(n){var r=this,u=this.getCheckAllStatus(n),i="Check"===u;this.isHeaderCheckboxClicked=!0;this.rmtHdrChkbxClicked=(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&("Uncheck"===u||this.isCheckboxReset)?!0:!1;this.rmtHdrChkbxClicked&&this.isCheckboxReset&&(this.unSelectedRowState={});this.isCheckboxReset=!1;"Intermediate"===u&&(i=this.getCurrentBatchRecordChanges().some(function(n){return r.getPkValue(r.primaryKey,n)in r.selectedRowState}),this.parent.enableVirtualization&&this.parent.isPersistSelection&&(i=!0));this.parent.isPersistSelection&&this.parent.allowPaging&&(this.totalRecordsCount=this.parent.pageSettings.totalRecordsCount);this.checkSelectAllAction(!i);this.target=null;this.getCurrentBatchRecordChanges().length>0&&(this.setCheckAllState(),this.updateSelectedRowIndexes());this.triggerChkChangeEvent(n,!i)},n.prototype.getCheckAllStatus=function(n){var t=n?n.nextElementSibling.classList:this.getCheckAllBox().nextElementSibling.classList;return t.contains("e-check")?"Check":t.contains("e-uncheck")?"Uncheck":t.contains("e-stop")?"Intermediate":"None"},n.prototype.checkSelect=function(n){var r=t.closest(this.checkedTarget,"."+a),u=this.parent,i,f;this.isMultiCtrlRequest=!0;i=0;(this.isHeaderCheckboxClicked=!1,et(u))?(f=r.parentElement.getAttribute("data-uid"),i=u.getRows().map(function(n){return n.getAttribute("data-uid")}).indexOf(f)):i=parseInt(r.parentElement.getAttribute(h),10);this.parent.isPersistSelection&&this.parent.element.getElementsByClassName(ui).length>0&&"Top"===this.parent.editSettings.newRowPosition&&++i;this.rowCellSelectionHandler(i,parseInt(r.getAttribute(lt),10));this.moveIntoUncheckCollection(t.closest(r,"."+y));this.setCheckAllState();this.isMultiCtrlRequest=!1;this.triggerChkChangeEvent(n,n.nextElementSibling.classList.contains("e-check"))},n.prototype.moveIntoUncheckCollection=function(n){if("Check"===this.parent.checkAllRows||"Uncheck"===this.parent.checkAllRows){var i=this.getRowObj(n),t=i&&i.data?this.getPkValue(this.primaryKey,i.data):null;if(!t)return;this.chkAllCollec.indexOf(t)<0?this.chkAllCollec.push(t):this.chkAllCollec.splice(this.chkAllCollec.indexOf(t),1)}},n.prototype.triggerChkChangeEvent=function(n,t){this.parent.trigger(ug,{checked:t,selectedRowIndexes:this.parent.getSelectedRowIndexes(),target:n});this.parent.isEdit||(this.checkedTarget=null)},n.prototype.updateSelectedRowIndexes=function(){var n,i,r;if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&this.isPartialSelection&&!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.parent.selectionSettings.persistSelection&&"Uncheck"!==this.parent.checkAllRows)for(n=0,i=this.parent.getRowsObject().filter(function(n){return n.isSelectable});n<i.length;n++)r=i[n],this.selectedRowIndexes.push(r.index)},n.prototype.updateSelectedRowIndex=function(n){var u,i,r,f;if(this.parent.isCheckBoxSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection)if("Check"===this.parent.checkAllRows)for(this.selectedRowIndexes=[],u=this.getData().length,i=0;i<u;i++)this.selectedRowIndexes.push(i);else"Uncheck"===this.parent.checkAllRows?this.selectedRowIndexes=[]:(r=this.parent.getRowByIndex(n),n&&r&&"false"===r.getAttribute("aria-selected")&&(f=this.selectedRowIndexes.indexOf(n),this.selectedRowIndexes.splice(f,1)))},n.prototype.isAllSelected=function(n){var r,i,u;if(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)return this.getAvailableSelectedData().length===(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling?this.parent.totalDataRecordsCount:this.totalRecordsCount);if(this.isPartialSelection){if(this.parent.allowPaging&&this.parent.pageSettings.pageSize<this.parent.pageSettings.totalRecordsCount){for(r=this.parent.partialSelectedRecords,i=0;i<r.length;i++)if(u=this.getPkValue(this.primaryKey,r[parseInt(i.toString(),10)]),!this.selectedRowState[""+u])return!1;return!0}return this.isSelectAllRowCount(n)}for(r=this.getData(),i=0;i<r.length;i++)if(u=this.getPkValue(this.primaryKey,r[parseInt(i.toString(),10)]),!this.selectedRowState[""+u])return!1;return!0},n.prototype.someDataSelected=function(){var r,n,i,u;if((this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&(this.parent.searchSettings.key.length||this.parent.filterSettings.columns.length))for(r=this.getAvailableSelectedData(),n=0;n<r.length;n++)if(i=this.getPkValue(this.primaryKey,r[parseInt(n.toString(),10)]),this.selectedRowState[""+i])return!1;for(u=this.isPartialSelection?this.parent.partialSelectedRecords:this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?[]:this.getData(),n=0;n<u.length;n++)if(i=this.getPkValue(this.primaryKey,u[parseInt(n.toString(),10)]),this.selectedRowState[""+i])return!1;return!0},n.prototype.setCheckAllState=function(n,i){var f,u;if(this.parent.isCheckBoxSelection||"ResetOnRowClick"===this.parent.selectionSettings.checkboxMode){var o=!1,e=!1,r=Object.keys(this.selectedRowState).length;this.parent.isPersistSelection||(r=this.selectedRowIndexes.length,this.totalRecordsCount=this.getCurrentBatchRecordChanges().length);this.parent.isPersistSelection&&(!this.parent.getDataModule().isRemote()&&(t.isNullOrUndefined(this.parent.dataSource)||!this.parent.dataSource.result)||!this.isPartialSelection)&&(this.parent.searchSettings.key.length||this.parent.filterSettings.columns.length)&&(e=!0,o=this.isAllSelected(r));f=this.getCheckAllBox();f&&(u=f.nextElementSibling,t.removeClass([u],["e-check","e-stop","e-uncheck"]),ef(f,!1),f.indeterminate=!1,o&&e&&(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.getData().length)||!e&&(r===this.totalRecordsCount&&this.totalRecordsCount&&!this.isPartialSelection&&(!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)||this.parent.allowPaging)||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&this.isPartialSelection&&(this.isSelectAllRowCount(r)||this.isHdrSelectAllClicked)||(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&!this.parent.allowPaging&&(!(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&this.getData().length&&r===this.getData().length||(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result)&&!this.isPartialSelection&&r===this.parent.totalDataRecordsCount||this.isPartialSelection&&(this.isHdrSelectAllClicked||this.isSelectAllRowCount(r))))?(t.addClass([u],["e-check"]),ef(f,!0),i&&this.getRenderer().setSelection(null,!0,!0),this.parent.checkAllRows="Check"):(!this.selectedRowIndexes.length&&(!this.parent.enableVirtualization||!this.persistSelectedData.length&&!e||e&&this.someDataSelected())||0===r&&0===this.getCurrentBatchRecordChanges().length)&&!this.parent.allowPaging||this.parent.allowPaging&&(0===r||r&&e&&this.someDataSelected())?(t.addClass([u],["e-uncheck"]),i&&this.getRenderer().setSelection(null,!1,!0),this.parent.checkAllRows="Uncheck"):(t.addClass([u],["e-stop"]),this.parent.checkAllRows="Intermediate",f.indeterminate=!0),0===r&&0===this.getCurrentBatchRecordChanges().length?t.addClass([u.parentElement],["e-checkbox-disabled"]):t.removeClass([u.parentElement],["e-checkbox-disabled"]),this.isPartialSelection&&(0===this.parent.getRowsObject().filter(function(n){return n.isSelectable}).length&&u.parentElement.querySelector(".e-frame").classList.contains("e-uncheck")?t.addClass([u.parentElement],["e-checkbox-disabled"]):t.removeClass([u.parentElement],["e-checkbox-disabled"])),!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling||this.parent.allowPaging||this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result||this.updateSelectedRowIndex(n))}},n.prototype.isSelectAllRowCount=function(n){var i=0,r=this.parent.getRowsObject();return this.parent.selectionSettings.persistSelection&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)?(this.parent.getDataModule().isRemote()||!t.isNullOrUndefined(this.parent.dataSource)&&this.parent.dataSource.result?this.parent.totalDataRecordsCount:this.getData()&&this.getData().length)===r.length&&(i=r.filter(function(n){return n.isSelectable}).length)&&n===i:this.parent.allowPaging&&this.parent.selectionSettings.persistSelection?(i=this.parent.partialSelectedRecords.length+this.parent.disableSelectedRecords.length)===this.totalRecordsCount&&this.parent.partialSelectedRecords.length&&n===this.parent.partialSelectedRecords.length:(i=r.filter(function(n){return n.isSelectable}).length)&&n===i},n.prototype.keyDownHandler=function(n){(("chrome"===t.Browser.info.name||"safari"===t.Browser.info.name)&&(91===n.keyCode||93===n.keyCode)||"opera"===t.Browser.info.name&&17===n.keyCode||"mozilla"===t.Browser.info.name&&224===n.keyCode)&&(this.cmdKeyPressed=!0);var r=i(n.target,"e-headercell"),u=i(n.target,a);(r?r.children[0].classList.contains("e-headerchkcelldiv"):u&&u.classList.contains("e-gridchkbox"))&&!this.parent.allowKeyboard&&32===n.keyCode&&n.preventDefault()},n.prototype.keyUpHandler=function(n){(("chrome"===t.Browser.info.name||"safari"===t.Browser.info.name)&&(91===n.keyCode||93===n.keyCode)||"opera"===t.Browser.info.name&&17===n.keyCode||"mozilla"===t.Browser.info.name&&224===n.keyCode)&&(this.cmdKeyPressed=!1)},n.prototype.clickHandler=function(n){var r=n.target,u,s,f,c,e,o;this.actualTarget=r;this.selectionSettings.persistSelection&&(this.deSelectedData=eo(this.persistSelectedData));(i(r,y)||i(r,"e-headerchkcelldiv")||this.selectionSettings.allowColumnSelection&&r.classList.contains("e-headercell"))&&(this.isInteracted=!0);this.isMultiCtrlRequest=n.ctrlKey||this.enableSelectMultiTouch||this.isMacOS&&this.cmdKeyPressed;this.parent.allowKeyboard?this.isMultiShiftRequest=n.shiftKey:(this.isMultiShiftRequest=!1,this.isMultiCtrlRequest=!1);this.popUpClickHandler(n);s=!1;this.preventFocus=!0;f=i(r,"e-checkbox-wrapper");(this.checkSelectAllClicked=!!(f&&f.getElementsByClassName("e-checkselectall")||this.selectionSettings.persistSelection&&i(r,y)),this.selectionSettings.persistSelection&&this.isPartialSelection&&i(r,"e-headerchkcelldiv")&&!r.querySelector(".e-checkbox-disabled")&&(this.isHdrSelectAllClicked=!0),f&&f.querySelectorAll(".e-checkselect,.e-checkselectall").length>0&&(u=f.querySelector('input[type="checkbox"]'),s=!0),this.drawBorders(),this.updateAutoFillPosition(),r=i(r,a),this.parent.isReact&&r&&!r.parentElement&&r.classList.contains("e-rowcell")&&(r=this.parent.getCellFromIndex(parseInt(r.getAttribute("index"),10),parseInt(r.getAttribute("data-colindex"),10))),(r&&r.parentElement.classList.contains(y)&&!this.parent.selectionSettings.checkboxOnly||s)&&!this.isRowDragSelected)?((this.parent.isCheckBoxSelection&&(this.isMultiCtrlRequest=!0),this.target=r,t.isNullOrUndefined(u))?(c=this.parent,e=0,et(c)?(o=r.parentElement.getAttribute("data-uid"),e=c.getRows().map(function(n){return n.getAttribute("data-uid")}).indexOf(o)):e=parseInt(r.parentElement.getAttribute(h),10),this.parent.isPersistSelection&&this.parent.element.getElementsByClassName(ui).length>0&&++e,this.mUPTarget&&this.mUPTarget.isEqualNode(r)||this.rowCellSelectionHandler(e,parseInt(r.getAttribute(lt),10)),this.parent.hoverFrozenRows(n),this.parent.isCheckBoxSelection&&(this.moveIntoUncheckCollection(t.closest(r,"."+y)),this.setCheckAllState())):(this.checkedTarget=u,u.classList.contains("e-checkselectall")?this.checkSelectAll(u):this.checkSelect(u)),this.parent.isCheckBoxSelection||!t.Browser.isDevice||this.isSingleSel()||this.showPopup(n)):n.target.classList.contains("e-headercell")&&!n.target.classList.contains("e-stackedheadercell")&&(o=n.target.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),this.headerSelectionHandler(this.parent.getColumnIndexByUid(o)));this.isMultiCtrlRequest=!1;this.isMultiShiftRequest=!1;t.isNullOrUndefined(t.closest(n.target,".e-unboundcell"))&&(this.preventFocus=!1)},n.prototype.popUpClickHandler=function(n){var i=n.target;t.closest(i,".e-headercell")||n.target.classList.contains(a)||t.closest(i,".e-gridpopup")?i.classList.contains("e-rowselect")&&(i.classList.contains("e-spanclicked")?(i.classList.remove("e-spanclicked"),this.enableSelectMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(i.classList.add("e-spanclicked"),this.enableSelectMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},n.prototype.showPopup=function(n){this.selectionSettings.enableSimpleMultiRowSelection||fb(this.parent.element.querySelector(".e-gridpopup"),n,"e-rowselect e-icons e-icon-rowselect"+(!this.isSingleSel()&&(this.selectedRecords.length>(this.parent.getFrozenColumns()?2:1)||this.selectedRowCellIndexes.length>1)?" e-spanclicked":""))},n.prototype.rowCellSelectionHandler=function(n,i){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?(this.isDragged||this.selectRow(n,this.selectionSettings.enableToggle),this.selectCell({rowIndex:n,cellIndex:i},this.selectionSettings.enableToggle),this.selectedRowCellIndexes.length&&this.updateAutoFillPosition(),this.drawBorders()):this.isMultiShiftRequest?(this.parent.isCheckBoxSelection||!this.parent.isCheckBoxSelection&&!t.closest(this.target,"."+a).classList.contains(rf)?this.selectRowsByRange(t.isUndefined(this.prevRowIndex)?n:this.prevRowIndex,n):this.addRowsToSelection([n]),this.selectCellsByRange(t.isUndefined(this.prevCIdxs)?{rowIndex:n,cellIndex:i}:this.prevCIdxs,{rowIndex:n,cellIndex:i}),this.updateAutoFillPosition(),this.drawBorders()):(this.addRowsToSelection([n]),this.addCellsToSelection([{rowIndex:n,cellIndex:i}]),this.showHideBorders("none"));this.isDragged=!1},n.prototype.onCellFocused=function(n){var l,o,v,s,f,e,p,c;if(this.parent.frozenRows&&n.container.isHeader&&n.byKey&&("upArrow"===n.keyArgs.action?n.isJump=this.parent.allowFiltering?"INPUT"===n.element.tagName:"TH"===n.element.tagName:"downArrow"===n.keyArgs.action?(l=Number(n.element.parentElement.getAttribute(h)),n.isJump=0===l):"ctrlHome"===n.keyArgs.action&&(n.isJump=!0)),o=this.parent.isFrozenGrid()?(n.container.isHeader&&"TD"!==n.element.tagName&&n.isJump&&!this.selectionSettings.allowColumnSelection||(n.container.isContent||"TD"===n.element.tagName)&&!(n.container.isSelectable||"TD"===n.element.tagName))&&!(n.byKey&&"space"===n.keyArgs.action):(n.container.isHeader&&n.isJump||n.container.isContent&&!n.container.isSelectable)&&!(n.byKey&&"space"===n.keyArgs.action)&&!(n.element.classList.contains("e-detailrowexpand")||n.element.classList.contains("e-detailrowcollapse")),v=n.container.isHeader&&"TD"!==n.element.tagName&&!t.closest(n.element,"."+a)&&!(n.byKey&&"space"===n.keyArgs.action),n.byKey&&!o){var y=n.container.isContent?n.container.indexes:n.indexes,r=y[0],u=y[1],i=this.focus.getPrevIndexes();if(this.parent.frozenRows&&(n.container.isHeader&&("TD"===n.element.tagName||t.closest(n.element,"."+a))?(s=this.parent.getHeaderTable().querySelector("thead").childElementCount,r-=s,i.rowIndex=t.isNullOrUndefined(i.rowIndex)?null:i.rowIndex-s):(r+=this.parent.frozenRows,i.rowIndex=0!==i.rowIndex&&t.isNullOrUndefined(i.rowIndex)?null:i.rowIndex+this.parent.frozenRows)),this.parent.isFrozenGrid()&&(f=Number(n.element.getAttribute(lt)),e=this.parent.getSelectedRowCellIndexes(),e.length&&0===i.cellIndex&&(i.cellIndex=e[e.length-1].cellIndexes[0]),i.cellIndex=t.isNullOrUndefined(i.cellIndex)?null:i.cellIndex===u?f:f-1,u=f),this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache&&(r=parseInt(n.element.parentElement.getAttribute("data-rowindex"),10)),!(v||-1===["ctrlPlusA","escape"].indexOf(n.keyArgs.action)&&"space"!==n.keyArgs.action&&r===i.rowIndex&&u===i.cellIndex)||this.selectionSettings.allowColumnSelection){this.preventFocus=!0;p=this.getKeyColIndex(n);(this.needColumnSelection&&(u=p),this.parent.element.classList.contains("e-gridcell-read")&&("tab"===n.keyArgs.action||"shiftTab"===n.keyArgs.action||"rightArrow"===n.keyArgs.action||"leftArrow"===n.keyArgs.action))&&(c=this.target.getAttribute("aria-label"),c=this.target.innerHTML+" column header "+this.parent.getColumnByIndex(u).field,this.target.setAttribute("aria-label",c));switch(n.keyArgs.action){case"downArrow":case"upArrow":case"enter":case"shiftEnter":this.target=n.element;this.isKeyAction=!0;this.applyDownUpKey(r,u);break;case"rightArrow":case"leftArrow":this.applyRightLeftKey(r,u);break;case"shiftDown":case"shiftUp":this.shiftDownKey(r,u);break;case"shiftLeft":case"shiftRight":this.applyShiftLeftRightKey(r,u);break;case"home":case"end":u="end"===n.keyArgs.action?this.getLastColIndex(r):0;this.applyHomeEndKey(r,u);break;case"ctrlHome":case"ctrlEnd":this.applyCtrlHomeEndKey(r,u);break;case"escape":this.clearSelection();break;case"ctrlPlusA":this.ctrlPlusA();break;case"space":this.applySpaceSelection(n.element);break;case"tab":this.parent.editSettings.allowNextRowEdit&&this.selectRow(r)}this.needColumnSelection=!1;this.preventFocus=!1;this.positionBorders();this.updateAutoFillPosition()}}else o&&!this.parent.isCheckBoxSelection&&this.clearSelection()},n.prototype.getKeyColIndex=function(n){var u,t=null,f=n.element.querySelector(".e-stackedheadercelldiv");if(this.selectionSettings.allowColumnSelection&&i(n.element,"e-columnheader"))if(this.needColumnSelection=!!n.container.isHeader,f){if("rightArrow"===n.keyArgs.action||"leftArrow"===n.keyArgs.action)return t;u=f.getAttribute("e-mappinguid");var r=this.getstackedColumns(this.parent.getColumnByUid(u).columns),e=this.parent.getColumnIndexByUid(r[r.length-1].uid),o=this.parent.getColumnIndexByUid(r[0].uid);t=this.prevColIndex>=e?o:e}else t=this.parent.getColumnIndexByUid(n.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));return t},n.prototype.ctrlPlusA=function(){this.isRowType()&&!this.isSingleSel()&&this.selectRowsByRange(0,this.getCurrentBatchRecordChanges().length-1);this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange({rowIndex:0,cellIndex:0},{rowIndex:this.parent.getRows().length-1,cellIndex:this.parent.getColumns().length-1})},n.prototype.applySpaceSelection=function(n){n.classList.contains("e-checkselectall")?(this.checkedTarget=n,this.checkSelectAll(this.checkedTarget)):n.classList.contains("e-checkselect")&&(this.checkedTarget=n,this.checkSelect(this.checkedTarget))},n.prototype.applyDownUpKey=function(n,t){var i=this.parent;!this.parent.isCheckBoxSelection||"Check"!==this.parent.checkAllRows||this.selectionSettings.persistSelection||this.selectionSettings.checkboxOnly||(this.checkSelectAllAction(!1),this.checkedTarget=null);this.isRowType()&&!this.selectionSettings.checkboxOnly&&(this.parent.frozenRows,this.selectRow(n,!0),this.applyUpDown(i.selectedRowIndex));this.isCellType()&&this.selectCell({rowIndex:n,cellIndex:t},!0);this.selectionSettings.allowColumnSelection&&this.needColumnSelection&&this.selectColumn(t)},n.prototype.applyUpDown=function(n){var t,i,r,u;n<0||(this.target||(this.target=this.parent.getRows()[0].children[this.parent.groupSettings.columns.length||0]),t=parseInt(this.target.getAttribute(lt),10),i=this.parent.getFrozenColumns(),i?this.target=t>=i?this.contentRenderer.getMovableRowByIndex(n).getElementsByClassName(a)[t-i]:this.contentRenderer.getRowByIndex(n).getElementsByClassName(a)[parseInt(t.toString(),10)]:(r=this.contentRenderer.getRowByIndex(n),r&&(this.target=r.getElementsByClassName(a)[parseInt(t.toString(),10)])),(this.addAttribute(this.target),this.parent.element.classList.contains("e-gridcell-read"))&&(u=this.target.getAttribute("aria-label"),u=this.target.innerHTML,this.target.setAttribute("aria-label",u)))},n.prototype.applyRightLeftKey=function(n,t){this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumn(t):this.isCellType()&&(this.selectCell({rowIndex:n,cellIndex:t},!0),this.addAttribute(this.target))},n.prototype.applyHomeEndKey=function(n,t){this.isCellType()?this.selectCell({rowIndex:n,cellIndex:t},!0):this.addAttribute(this.parent.getCellFromIndex(n,t))},n.prototype.shiftDownKey=function(n,i){this.isMultiShiftRequest=!0;this.isRowType()&&!this.isSingleSel()&&(t.isUndefined(this.prevRowIndex)?this.isPartialSelection?this.selectRow(n,!0):this.selectRow(0,!0):(this.selectRowsByRange(this.prevRowIndex,n),this.applyUpDown(n)));this.isCellType()&&!this.isSingleSel()&&this.selectCellsByRange(this.prevCIdxs||{rowIndex:0,cellIndex:0},{rowIndex:n,cellIndex:i});this.isMultiShiftRequest=!1},n.prototype.applyShiftLeftRightKey=function(n,t){this.isMultiShiftRequest=!0;this.selectionSettings.allowColumnSelection&&this.needColumnSelection?this.selectColumnsByRange(this.prevColIndex,t):this.selectCellsByRange(this.prevCIdxs,{rowIndex:n,cellIndex:t});this.isMultiShiftRequest=!1},n.prototype.getstackedColumns=function(n){for(var i=[],t=0,r=n.length;t<r;t++)n[parseInt(t.toString(),10)].columns?this.getstackedColumns(n[parseInt(t.toString(),10)].columns):i.push(n[parseInt(t.toString(),10)]);return i},n.prototype.applyCtrlHomeEndKey=function(n,t){this.isRowType()&&(this.selectRow(n,!0),this.addAttribute(this.parent.getCellFromIndex(n,t)));this.isCellType()&&this.selectCell({rowIndex:n,cellIndex:t},!0)},n.prototype.addRemoveClassesForRow=function(n,t,i){for(var u=[],r=3;r<arguments.length;r++)u[r-3]=arguments[r];if(n){var f=[].slice.call(n.getElementsByClassName(a)),e=n.querySelector(".e-detailrowcollapse")||n.querySelector(".e-detailrowexpand"),o=n.querySelector(".e-rowdragdrop");e&&f.push(e);o&&f.push(o);rr.apply(void 0,[f,t].concat(u))}this.getRenderer().setSelection(n?n.getAttribute("data-uid"):null,t,i)},n.prototype.isRowType=function(){return"Row"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},n.prototype.isCellType=function(){return"Cell"===this.selectionSettings.mode||"Both"===this.selectionSettings.mode},n.prototype.isSingleSel=function(){return"Single"===this.selectionSettings.type},n.prototype.getRenderer=function(){return t.isNullOrUndefined(this.contentRenderer)&&(this.contentRenderer=this.factory.getRenderer(at.Content)),this.contentRenderer},n.prototype.getSelectedRecords=function(){return!this.selectionSettings.persistSelection&&this.selectedRecords.length?this.parent.getRowsObject().filter(function(n){return n.isSelected}).map(function(n){return n.data}):this.persistSelectedData},n.prototype.selectColumn=function(n){var i=this.parent,f,e,s;if(!t.isNullOrUndefined(i.getColumns()[parseInt(n.toString(),10)])){var u=i.getColumnByIndex(n),r=i.getColumnHeaderByUid(u.uid),o=r.classList.contains("e-columnselection");if(i.selectionSettings.allowColumnSelection){if(f=this.selectedColumnsIndexes.length>1&&this.selectedColumnsIndexes.indexOf(n)>-1,this.clearColDependency(),!o||!this.selectionSettings.enableToggle||f){if(e={columnIndex:n,headerCell:r,column:u,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(e,cc),e.cancel)return void this.disableInteracted();i.selectionSettings.enableToggle&&n===this.prevColIndex&&o&&!f||this.updateColSelection(r,n);s={columnIndex:n,headerCell:r,column:u,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(s,lc)}this.updateColProps(n)}}},n.prototype.selectColumnsByRange=function(n,i){var e=this.parent,u,f,r;if(!t.isNullOrUndefined(e.getColumns()[parseInt(n.toString(),10)])){if(u=[],"Single"===e.selectionSettings.type||t.isNullOrUndefined(i))u[0]=n;else for(f=n<i,r=n;f?r<=i:r>=i;f?r++:r--)u.push(r);this.selectColumns(u)}},n.prototype.selectColumns=function(n){var t=this.parent,r=this.getselectedCols(),u,i,f,e;if("Single"===t.selectionSettings.type&&(n=[n[0]]),t.selectionSettings.allowColumnSelection)if(this.clearColDependency(),u={columnIndex:n[0],headerCell:r,columnIndexes:n,column:t.getColumnByIndex(n[0]),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(u,cc),u.cancel)this.disableInteracted();else{for(i=0,f=n.length;i<f;i++)this.updateColSelection(t.getColumnHeaderByUid(t.getColumnByIndex(n[parseInt(i.toString(),10)]).uid),n[parseInt(i.toString(),10)]);r=this.getselectedCols();e={columnIndex:n[0],headerCell:r,columnIndexes:n,column:t.getColumnByIndex(n[0]),target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(e,lc);this.updateColProps(n[0])}},n.prototype.selectColumnWithExisting=function(n){var i=this.parent,f,r,u,e;if(!t.isNullOrUndefined(i.getColumns()[parseInt(n.toString(),10)])&&(f=i.getColumnHeaderByUid(i.getColumnByIndex(n).uid),r=this.getselectedCols(),"Single"===i.selectionSettings.type&&this.clearColDependency(),i.selectionSettings.allowColumnSelection)){if(this.selectedColumnsIndexes.indexOf(n)>-1)this.clearColumnSelection(n);else{if(u={columnIndex:n,headerCell:r,columnIndexes:this.selectedColumnsIndexes,column:i.getColumnByIndex(n),cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex,isCtrlPressed:this.isMultiCtrlRequest,isShiftPressed:this.isMultiShiftRequest},this.onActionBegin(u,cc),u.cancel)return void this.disableInteracted();this.updateColSelection(f,n);e={columnIndex:n,headerCell:r=this.getselectedCols(),column:i.getColumnByIndex(n),columnIndexes:this.selectedColumnsIndexes,target:this.actualTarget,isInteracted:this.isInteracted,previousColumnIndex:this.prevColIndex};this.onActionComplete(e,lc)}this.updateColProps(n)}},n.prototype.clearColumnSelection=function(n){var i;if(this.isColumnSelected){if(i=this.parent,!t.isNullOrUndefined(n)&&-1===this.selectedColumnsIndexes.indexOf(n))return;var e,u=t.isNullOrUndefined(n)?this.selectedColumnsIndexes[this.selectedColumnsIndexes.length-1]:n,o=i.getColumnByIndex(u),s=i.getColumnByIndex(u),h={columnIndex:u,headerCell:e=o.getFreezeTableName()===d?i.getFrozenRightColumnHeaderByIndex(u):"movable"===o.getFreezeTableName()?i.getMovableColumnHeaderByIndex(u):i.getColumnHeaderByUid(s.uid),columnIndexes:this.selectedColumnsIndexes,column:s,cancel:!1,target:this.actualTarget,isInteracted:this.isInteracted};if(this.columnDeselect(h,od))return void this.disableInteracted();for(var c=t.isNullOrUndefined(n)?[].slice.call(i.getHeaderContent().getElementsByClassName("e-columnselection")):[e],l=this.getSelectedColumnCells(n),r=0,f=c.length;r<f;r++)rr([c[parseInt(r.toString(),10)]],!1,"e-columnselection");for(r=0,f=l.length;r<f;r++)rr([l[parseInt(r.toString(),10)]],!1,"e-columnselection");t.isNullOrUndefined(n)?(this.columnDeselect(h,sd),this.selectedColumnsIndexes=[],this.isColumnSelected=!1,this.parent.getColumns().filter(function(n){return n.isSelected=!1})):(this.selectedColumnsIndexes.splice(this.selectedColumnsIndexes.indexOf(n),1),this.parent.getColumns()[parseInt(n.toString(),10)].isSelected=!1)}},n.prototype.getselectedCols=function(){var n,t=this.parent,i;if(this.selectedColumnsIndexes.length>1)for(n=[],i=0;i<this.selectedColumnsIndexes.length;i++)n.push(t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[parseInt(i.toString(),10)]).uid));else n=t.getColumnHeaderByUid(t.getColumnByIndex(this.selectedColumnsIndexes[0]).uid);return n},n.prototype.getSelectedColumnCells=function(n){var o,h,i=this.parent,u=!t.isNullOrUndefined(this.parent.rowTemplate),r=u?i.getRows():i.getDataRows();i.isFrozenGrid()&&i.getContent().querySelector("."+p)&&(o=u?i.getMovableRows():i.getMovableDataRows(),r=i.addMovableRows(r,o),i.getFrozenMode()===s&&(h=u?i.getFrozenRightRows():i.getFrozenRightDataRows(),r=i.addMovableRows(r,h)));for(var f=[],c=t.isNullOrUndefined(n)?".e-columnselection":'[data-colindex="'+n+'"]',e=0,l=r.length;e<l;e++)f=f.concat([].slice.call(r[parseInt(e.toString(),10)].querySelectorAll(c)));return f},n.prototype.columnDeselect=function(n,t){return"columnDeselected"===t&&delete n.cancel,this.onActionComplete(n,t),n.cancel},n.prototype.updateColProps=function(n){this.prevColIndex=n;this.isColumnSelected=this.selectedColumnsIndexes.length&&!0},n.prototype.clearColDependency=function(){this.clearColumnSelection();this.selectedColumnsIndexes=[]},n.prototype.updateColSelection=function(n,i){var u,s;if(!t.isNullOrUndefined(this.parent.getColumns()[parseInt(i.toString(),10)])){var r,e=this.parent.getFrozenLeftCount(),h=this.parent.getMovableColumnsCount(),o=this.parent.getColumnByIndex(i),f=!t.isNullOrUndefined(this.parent.rowTemplate);for(this.selectedColumnsIndexes.push(i),this.parent.getColumns()[parseInt(i.toString(),10)].isSelected=!0,o.getFreezeTableName()===d?(i-=e+h,r=f?this.parent.getFrozenRightRows():this.parent.getFrozenRightDataRows()):"movable"===o.getFreezeTableName()?(i-=e,r=f?this.parent.getMovableRows():this.parent.getMovableDataRows()):(i+=this.parent.getIndentCount(),r=f?this.parent.getRows():this.parent.getDataRows()),rr([n],!0,"e-columnselection"),u=0,s=r.length;u<s;u++)r[parseInt(u.toString(),10)].classList.contains(y)&&(!r[parseInt(u.toString(),10)].classList.contains(ni)&&!r[parseInt(u.toString(),10)].classList.contains(ui)||"Normal"!==this.parent.editSettings.mode||t.isNullOrUndefined(r[parseInt(u.toString(),10)].querySelector("tr").childNodes[parseInt(i.toString(),10)])?t.isNullOrUndefined(r[parseInt(u.toString(),10)].childNodes[parseInt(i.toString(),10)])||rr([r[parseInt(u.toString(),10)].childNodes[parseInt(i.toString(),10)]],!0,"e-columnselection"):rr([r[parseInt(u.toString(),10)].querySelector("tr").childNodes[parseInt(i.toString(),10)]],!0,"e-columnselection"))}},n.prototype.headerSelectionHandler=function(n){!this.isMultiCtrlRequest&&!this.isMultiShiftRequest||this.isSingleSel()?this.selectColumn(n):this.isMultiShiftRequest?this.selectColumnsByRange(t.isUndefined(this.prevColIndex)?n:this.prevColIndex,n):this.selectColumnWithExisting(n)},n.prototype.addEventListener_checkbox=function(){var n=this;this.parent.on(ki,this.dataReady,this);this.onDataBoundFunction=this.onDataBound.bind(this);this.parent.addEventListener(ti,this.onDataBoundFunction);this.parent.on(aa,this.onDataBoundFunction);this.parent.on(it,this.checkBoxSelectionChanged,this);this.parent.on(ta,this.initPerisistSelection,this);this.parent.on(vi,this.setCheckAllForEmptyGrid,this);this.actionCompleteFunc=this.actionCompleteHandler.bind(this);this.parent.addEventListener(l,this.actionCompleteFunc);this.parent.on(ii,this.clickHandler,this);this.resizeEndFn=function(){n.updateAutoFillPosition();n.drawBorders()};this.resizeEndFn.bind(this);this.parent.addEventListener(yy,this.resizeEndFn)},n.prototype.removeEventListener_checkbox=function(){this.parent.off(ki,this.dataReady);this.parent.removeEventListener(ti,this.onDataBoundFunction);this.parent.removeEventListener(l,this.actionCompleteFunc);this.parent.off(aa,this.onDataBoundFunction);this.parent.off(vi,this.setCheckAllForEmptyGrid);this.parent.off(ii,this.clickHandler);this.parent.off(ta,this.initPerisistSelection)},n.prototype.setCheckAllForEmptyGrid=function(){var i=this.getCheckAllBox(),n;i&&(this.parent.isCheckBoxSelection=!0,n=i.nextElementSibling,t.removeClass([n],["e-check","e-stop","e-uncheck"]),t.addClass([n.parentElement],["e-checkbox-disabled"]))},n.prototype.dataReady=function(n){this.isHeaderCheckboxClicked=!1;var t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.requestType;"virtualscroll"===n.requestType||this.parent.isPersistSelection||t||(this.disableUI=!this.parent.enableImmutableMode,this.clearSelection(),this.setCheckAllState(),this.disableUI=!1)},n.prototype.actionCompleteHandler=function(n){"save"===n.requestType&&this.parent.isPersistSelection&&this.refreshPersistSelection()},n.prototype.selectRowIndex=function(n){this.parent.isSelectedRowIndexUpdating=!0;this.parent.selectedRowIndex=t.isNullOrUndefined(this.parent.selectedRowIndex)||-1===this.parent.selectedRowIndex||!this.parent.enablePersistence?n:-1},n.prototype.disableInteracted=function(){this.isInteracted=!1},n.prototype.activeTarget=function(){this.actualTarget=this.isInteracted?this.actualTarget:null},n}(),hit=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.search=function(n){var i=this.parent;n=t.isNullOrUndefined(n)?"":n;sr(i)?i.notify(ci,{instance:this,handler:this.search,arg1:n}):n!==i.searchSettings.key?(i.searchSettings.key=n.toString(),i.dataBind()):this.refreshSearch&&i.refresh()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(gt,this.onPropertyChanged,this),this.parent.on(gy,this.onSearchComplete,this),this.parent.on(v,this.destroy,this),this.actionCompleteFunc=this.onActionComplete.bind(this),this.parent.addEventListener(l,this.actionCompleteFunc),this.parent.on(hs,this.cancelBeginEvent,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(gt,this.onPropertyChanged),this.parent.off(gy,this.onSearchComplete),this.parent.off(v,this.destroy),this.parent.removeEventListener(l,this.actionCompleteFunc),this.parent.off(hs,this.cancelBeginEvent))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&(t.isNullOrUndefined(n.properties.key)?this.parent.notify(pt,{requestType:"searching",type:nt}):this.parent.notify(pt,{requestType:"searching",type:nt,searchString:this.parent.searchSettings.key}))},n.prototype.onSearchComplete=function(n){this.parent.trigger(l,t.extend(n,{searchString:this.parent.searchSettings.key,requestType:"searching",type:l}))},n.prototype.onActionComplete=function(n){this.refreshSearch="searching"!==n.requestType},n.prototype.cancelBeginEvent=function(n){"searching"===n.requestType&&this.parent.setProperties({searchSettings:{key:""}},!0)},n.prototype.getModuleName=function(){return"search"},n}(),dst=function(){function n(n){this.colName=[];this.isShowHide=!1;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:pr,handler:this.batchChanges},{event:wtt,handler:this.resetColumnState}],vt(this.parent,this.evtHandlers,!0,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||vt(this.parent,this.evtHandlers,!1)},n.prototype.batchChanges=function(){this.isShowHide&&(this.isShowHide=!1,this.setVisible(this.colName,this.changedCol),this.changedCol=this.colName=[])},n.prototype.show=function(n,t){var u=this.getToggleFields(n),r=this.getColumns(u,t),i;for(this.parent.notify(nf,{module:"edit"}),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].visible=!0;this.setVisible(r)},n.prototype.hide=function(n,t){var u=this.getToggleFields(n),r=this.getColumns(u,t),i;for(this.parent.notify(nf,{module:"edit"}),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].visible=!1;this.setVisible(r)},n.prototype.getToggleFields=function(n){return"string"==typeof n?[n]:n},n.prototype.getColumns=function(n,t){var i=this;return uf(n,function(n){return uf(i.parent.columnModel,function(i){if(i[""+t]===n)return i})[0]})},n.prototype.batchActionPrevent=function(n,t){return void 0===t&&(t=[]),!sr(this.parent)||(this.colName=n,this.changedCol=t,this.parent.closeEdit(),!1)},n.prototype.resetColumnState=function(){if(this.isShowHide)for(var n=0;n<this.colName.length;n++)this.colName[parseInt(n.toString(),10)].visible=!this.colName[parseInt(n.toString(),10)].visible},n.prototype.setVisible=function(n,i){var r=this,u;(void 0===i&&(i=[]),this.isShowHide=!0,this.batchActionPrevent(n,i))&&(u={requestType:"columnstate",cancel:!1,columns:i=i.length>0?i:n},this.parent.enableInfiniteScrolling&&this.parent.allowGrouping&&this.parent.groupModule.groupSettings.columns.length>0&&(this.parent.contentModule.visibleRows=[]),this.parent.trigger(nt,u,function(u){var f=r.parent.getColumns(),e;if(n=t.isNullOrUndefined(n)?f:n,u.cancel)return r.parent.notify(dl,{showHideArgs:u}),void(n.length>0&&(n[0].visible=!0));et(r.parent)&&r.parent.contentModule.emptyVcRows();r.parent.allowSelection&&r.parent.getSelectedRecords().length&&!r.parent.selectionSettings.persistSelection&&r.parent.clearSelection();r.parent.enableColumnVirtualization?n.filter(function(n){return f.some(function(t){return n.field===t.field})}).length&&r.parent.notify(di,n):r.parent.notify(di,n);e={requestType:"columnstate",columns:i};r.parent.trigger(l,e);"All"!==r.parent.columnQueryMode&&r.parent.refresh()}),this.parent.autoFit&&!this.parent.groupSettings.columns.length&&this.parent.preventAdjustColumns())},n}(),nb=function(){function n(n){this.previousValues={top:0,left:0};this.oneTimeReady=!0;this.parent=n;this.widthService=new dw(n);this.addEventListener()}return n.prototype.getModuleName=function(){return"scroll"},n.prototype.setWidth=function(n){if(this.parent.element.style.width=t.formatUnit(this.parent.width),n&&this.widthService.setWidthToColumns(),this.parent.toolbarModule&&this.parent.toolbarModule.toolbar&&this.parent.toolbarModule.toolbar.element){var i=this.parent.toolbarModule.toolbar.element,u=i.querySelector(".e-toolbar-left"),f=i.querySelector(".e-toolbar-center"),e=i.querySelector(".e-toolbar-right"),o=i.querySelector(".e-toolbar-items"),s=u?u.clientWidth:0,h=f?f.clientWidth:0,c=e?e.clientWidth:0,l=o?o.clientWidth:0,r=i?i.clientWidth:0;(!this.parent.enableAdaptiveUI||s>r||h>r||c>r||l>r)&&this.parent.toolbarModule.toolbar.refreshOverflow()}},n.prototype.setHeight=function(){var u=0,f=this.parent.getContent().querySelector("."+ft),i=this.parent.height,r;(this.parent.isFrozenGrid()&&"auto"!==this.parent.height&&this.parent.height.toString().indexOf("%")<0&&(i=parseInt(i,10)-n.getScrollBarWidth()),!this.parent.enableVirtualization&&this.parent.frozenRows&&"auto"!==this.parent.height)?(r=this.parent.getHeaderContent().querySelector(e+":not(.e-masked-tbody)"),u=r?r.offsetHeight:0,r&&u?u-=r.getElementsByClassName(ui).length*this.parent.getRowHeight():!this.parent.isInitialLoad&&"Shimmer"===this.parent.loadingIndicator.indicatorType&&this.parent.getHeaderContent().querySelector(".e-masked-table")&&(i=parseInt(i,10)-this.parent.frozenRows*this.parent.getRowHeight()),f.style.height=t.formatUnit(i-u)):f.style.height=t.formatUnit(i);this.ensureOverflow(f);this.parent.isFrozenGrid()&&this.refresh()},n.prototype.setPadding=function(){var i=this.parent.getHeaderContent(),t=n.getScrollBarWidth()-this.getThreshold(),r=this.getCssProperties(),u="Right"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===s?"0.5px":"1px";i.querySelector("."+st).style[r.border]=t>0?u:"0px";i.style[r.padding]=t>0?t+"px":"0px"},n.prototype.removePadding=function(n){var i=this.getCssProperties(n),r=this.parent.getHeaderContent().querySelector("."+st),t;r.style[i.border]="";r.parentElement.style[i.padding]="";t=this.parent.getFooterContent();t&&t.classList.contains("e-footerpadding")&&t.classList.remove("e-footerpadding")},n.prototype.refresh=function(){var n,t;"100%"===this.parent.height&&(n=this.parent.getContent(),this.parent.element.style.height="100%",t=this.widthService.getSiblingsHeight(n),n.style.height="calc(100% - "+t+"px)",this.parent.isFrozenGrid()&&(n.firstElementChild.style.height="calc(100% - "+hu()+"px)"))},n.prototype.getThreshold=function(){return"mozilla"===t.Browser.info.name?.5:1},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(vi,this.wireEvents,this),this.parent.on(it,this.wireEvents,this),this.parent.on(tt,this.onPropertyChanged,this),this.parent.on(fl,this.wireEvents,this),this.parent.on(yt,this.setScrollLeft,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(vi,this.wireEvents),this.parent.off(it,this.wireEvents),this.parent.off(tt,this.onPropertyChanged),this.parent.off(fl,this.wireEvents),this.parent.off(yt,this.setScrollLeft),this.unwireEvents())},n.prototype.unwireEvents=function(){var i,n,r=this.parent.isFrozenGrid(),u;this.content&&(i=this.content.querySelector("."+p));this.header&&(n=this.header.querySelector("."+w));u=this.parent.getContent()?this.parent.getContent().querySelector(".e-movablescrollbar"):null;this.parent.frozenRows&&(this.header&&!r||r&&n)&&(t.EventHandler.remove(r?n:this.header,"touchstart pointerdown",this.setPageXY),t.EventHandler.remove(r?n:this.header,"touchmove pointermove",this.onTouchScroll));this.parent.isFrozenGrid()?(u&&t.EventHandler.remove(u,"scroll",this.onCustomScrollbarScroll),i&&(t.EventHandler.remove(i,"scroll",this.onCustomScrollbarScroll),t.EventHandler.remove(i,"touchstart pointerdown",this.setPageXY),/macintosh|ipad/.test(t.Browser.userAgent.toLowerCase())&&t.Browser.isDevice||t.EventHandler.remove(i,"touchmove pointermove",this.onTouchScroll)),n&&(t.EventHandler.remove(n,"scroll",this.onCustomScrollbarScroll),t.EventHandler.remove(n,"touchstart pointerdown",this.setPageXY),t.EventHandler.remove(n,"touchmove pointermove",this.onTouchScroll)),this.content&&t.EventHandler.remove(this.content,"scroll",this.onFrozenContentScroll)):(this.content&&t.EventHandler.remove(this.content,"scroll",this.onContentScroll),this.header&&t.EventHandler.remove(this.header,"scroll",this.onContentScroll));this.parent.aggregates.length&&this.parent.getFooterContent()&&t.EventHandler.remove(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll)},n.prototype.setScrollLeft=function(){this.parent.isFrozenGrid()?this.parent.headerModule.getMovableHeader().scrollLeft=this.previousValues.left:this.parent.getHeaderContent().querySelector("."+st).scrollLeft=this.previousValues.left},n.prototype.onFrozenContentScroll=function(){var n=this;return function(i){null===n.content.querySelector(e)||n.parent.isPreventScrollEvent||(!t.isNullOrUndefined(n.parent.infiniteScrollModule)&&n.parent.enableInfiniteScrolling&&n.parent.notify(ps,i),n.previousValues.top=i.target.scrollTop)}},n.prototype.onContentScroll=function(n){var i=this,r=n,u=r.classList.contains(st);return function(n){var o,f,s,h;null===i.content.querySelector(e)||i.parent.isPreventScrollEvent||(o=n.target,f=o.scrollLeft,(t.isNullOrUndefined(i.parent.infiniteScrollModule)||!i.parent.enableInfiniteScrolling||i.parent.isEdit||i.parent.notify(ps,{target:n.target,isLeft:i.previousValues.left!==f}),i.parent.groupSettings.columns.length&&i.parent.groupSettings.enableLazyLoading)&&(s=i.previousValues.top<i.parent.getContent().firstElementChild.scrollTop,i.parent.notify(rw,{scrollDown:s})),i.parent.notify(nw,{}),h=o.classList.contains("e-summarycontent"),i.previousValues.left!==f?(i.parent.notify(kl,n),r.scrollLeft=f,h&&(i.header.scrollLeft=f),i.previousValues.left=f,i.parent.notify(bc,{left:f})):i.previousValues.top=u?o.scrollTop:i.previousValues.top)}},n.prototype.onCustomScrollbarScroll=function(n,t){var i=this,r=n,u=t;return function(n){if(null!==i.content.querySelector(e)){var t=n.target.scrollLeft;i.previousValues.left!==t&&(r.scrollLeft=t,u.scrollLeft=t,i.previousValues.left=t,i.parent.notify(bc,{left:t}),i.parent.isDestroyed)}}},n.prototype.onTouchScroll=function(n){var t=this,i=n;return function(n){if("mouse"!==n.pointerType){var u=t.parent.isFrozenGrid(),e=t.getPointXY(n),r=i.scrollLeft+(t.pageXY.x-e.x),f=u?t.parent.getHeaderContent().querySelector("."+w):t.parent.getHeaderContent().querySelector("."+st),o=u?t.parent.getContent().querySelector("."+p):t.parent.getContent().querySelector("."+ft);t.previousValues.left===r||r<0||f.scrollWidth-f.clientWidth<r||(n.preventDefault(),f.scrollLeft=r,o.scrollLeft=r,u&&(t.parent.getContent().querySelector(".e-movablescrollbar").scrollLeft=r),t.pageXY.x=e.x,t.previousValues.left=r)}}},n.prototype.setPageXY=function(){var n=this;return function(t){"mouse"!==t.pointerType&&(n.pageXY=n.getPointXY(t))}},n.prototype.getPointXY=function(n){var t={x:0,y:0};return n.touches&&n.touches.length?(t.x=n.touches[0].pageX,t.y=n.touches[0].pageY):(t.x=n.pageX,t.y=n.pageY),t},n.prototype.getScrollbleParent=function(n){if(null===n)return null;var i=t.isNullOrUndefined(n.tagName)?n.scrollingElement:n,r=document.defaultView.getComputedStyle(i,null).overflowY;return i.scrollHeight>i.clientHeight&&"hidden"!==r&&"visible"!==r||"HTML"===n.tagName||"BODY"===n.tagName?n:this.getScrollbleParent(n.parentNode)},n.prototype.addStickyListener=function(n){this.parentElement=this.getScrollbleParent(this.parent.element.parentElement);n&&this.parentElement?(this.eventElement="HTML"===this.parentElement.tagName||"BODY"===this.parentElement.tagName?document:this.parentElement,t.EventHandler.add(this.eventElement,"scroll",this.makeStickyHeader,this)):this.eventElement&&(t.EventHandler.remove(this.eventElement,"scroll",this.makeStickyHeader),this.eventElement=null)},n.prototype.wireEvents=function(){var n=this,u,e,o,s,h;if(this.oneTimeReady){u=this.parent.isFrozenGrid();this.content=this.parent.getContent().querySelector("."+ft);this.header=this.parent.getHeaderContent().querySelector("."+st);var r=this.content.querySelector("."+p),i=this.header.querySelector("."+w),f=this.parent.getContent().querySelector(".e-movablescrollbar");this.parent.frozenRows&&(t.EventHandler.add(u?i:this.header,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(u?i:this.header,"touchmove pointermove",this.onTouchScroll(u?r:this.content),this));this.parent.isFrozenGrid()?(t.EventHandler.add(f,"scroll",this.onCustomScrollbarScroll(r,i),this),t.EventHandler.add(r,"scroll",this.onCustomScrollbarScroll(f,i),this),t.EventHandler.add(i,"scroll",this.onCustomScrollbarScroll(f,r),this),t.EventHandler.add(this.content,"scroll",this.onFrozenContentScroll(),this),t.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),t.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(r),this),t.EventHandler.add(r,"touchstart pointerdown",this.setPageXY(),this),/macintosh|ipad/.test(t.Browser.userAgent.toLowerCase())&&t.Browser.isDevice||t.EventHandler.add(r,"touchmove pointermove",this.onTouchScroll(i),this)):(t.EventHandler.add(this.content,"scroll",this.onContentScroll(this.header),this),t.EventHandler.add(this.header,"scroll",this.onContentScroll(this.content),this));this.parent.aggregates.length&&t.EventHandler.add(this.parent.getFooterContent().firstChild,"scroll",this.onContentScroll(this.content),this);this.parent.enableStickyHeader&&this.addStickyListener(!0);this.refresh();this.oneTimeReady=!1}h=this.parent.getContentTable();ib(function(){e=n.header.scrollLeft;o=h.scrollHeight;s=n.parent.getContent().clientHeight},function(){var t={cancel:!1};n.parent.notify(ftt,t);o<s&&n.setLastRowCell();n.parent.enableVirtualization||n.parent.enableInfiniteScrolling||t.cancel||((n.parent.frozenRows>0||n.parent.isFrozenGrid())&&n.header.querySelector("."+w)?n.header.querySelector("."+w).scrollLeft=n.previousValues.left:n.header.scrollLeft=n.previousValues.left,n.content.scrollLeft=n.previousValues.left,n.content.scrollTop=n.previousValues.top);n.parent.enableColumnVirtualization||(n.content.scrollLeft=e);n.parent.isFrozenGrid()&&n.header.querySelector("."+w)&&(n.header.querySelector("."+w).scrollLeft=n.content.querySelector("."+p).scrollLeft)});this.parent.isPreventScrollEvent=!1},n.prototype.setLastRowCell=function(){var r=this.parent.getContentTable(),n,i;(r.querySelector("tr:nth-last-child(2)")&&t.removeClass(r.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(r.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.isFrozenGrid())&&(n=this.parent.getContent().querySelector("."+p),(n.querySelector("tr:nth-last-child(2)")&&t.removeClass(n.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(n.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.parent.getFrozenRightColumnsCount())&&(i=this.parent.getContent().querySelector(".e-frozen-right-content"),i.querySelector("tr:nth-last-child(2)")&&t.removeClass(i.querySelector("tr:nth-last-child(2)").querySelectorAll("td"),"e-lastrowcell"),t.addClass(i.querySelectorAll("tr:last-child td"),"e-lastrowcell")))},n.prototype.getCssProperties=function(n){var i={},r=t.isNullOrUndefined(n)?this.parent.enableRtl:n;return i.border=r?"borderLeftWidth":"borderRightWidth",i.padding=r?"paddingLeft":"paddingRight",i},n.prototype.ensureOverflow=function(n){n.style.overflowY="auto"===this.parent.height?"auto":"scroll"},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&(this.setPadding(),this.oneTimeReady=!0,"auto"===this.parent.height&&this.removePadding(),this.wireEvents(),this.setHeight(),this.setWidth(!t.isNullOrUndefined(n.properties.width)))},n.prototype.makeStickyHeader=function(){var n,f,h,l;if(this.parent.enableStickyHeader&&this.parent.element&&this.parent.getContent()&&(n=this.parent.getContent().getClientRects()[0],n)){var e=this.parent.getHeaderContent(),i=this.parent.element.querySelector(".e-toolbar"),r=this.parent.element.querySelector(".e-groupdroparea"),c=e.offsetHeight+(i?i.offsetHeight:0)+(r?r.offsetHeight:0),o=this.parentElement.getClientRects()[0].top,a=n.top-(o<0?0:o),s=n.left,u=document.body.querySelector("#"+this.parent.element.id+"_columnmenu");a<c&&n.bottom>0?(e.classList.add("e-sticky"),f=0,r&&this.parent.groupSettings.showDropArea&&(this.setSticky(r,f,n.width,s,!0),f+=r.getClientRects()[0].height),i&&(this.setSticky(i,f,n.width,s,!0),f+=i.getClientRects()[0].height),this.setSticky(e,f,n.width,s,!0),t.isNullOrUndefined(u)||(u.style.position="fixed",u.style.top=c+"px")):e.classList.contains("e-sticky")&&(this.setSticky(e,null,null,null,!1),i&&this.setSticky(i,null,null,null,!1),r&&this.setSticky(r,null,null,null,!1),h=this.parent.element.querySelector(".e-ccdlg"),(h&&h.classList.remove("e-sticky"),t.isNullOrUndefined(u))||(u.style.position="absolute",l=n.top-o,u.style.top=l+"px"));this.parent.notify(ytt,{})}},n.prototype.setSticky=function(n,t,i,r,u){u?(n.style.width=i+"px",n.classList.add("e-sticky")):n.classList.remove("e-sticky");n.style.top=null!=t?t+"px":"";n.style.left=null!==r?parseInt(n.style.left,10)!==r?r+"px":n.style.left:""},n.prototype.destroy=function(){var i=this.parent.element,n;i&&(i.querySelector("."+ct)||i.querySelector("."+ot))&&(this.removeEventListener(),n=this.parent.getContent().querySelector("."+ft),t.EventHandler.remove(n,"scroll",this.onContentScroll),this.parent.enableStickyHeader&&this.addStickyListener(!1),this.removePadding(),t.removeClass([this.parent.getHeaderContent().querySelector("."+st)],st),t.removeClass([n],ft),n.style.height="",this.parent.element.style.width="")},n.getScrollBarWidth=function(){return hu()},n}(),cit=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ou=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},gst=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.templateFn={},t}return cit(i,n),i.prototype.setFormatter=function(n){this.formatFn=n},i.prototype.getFormatter=function(){return this.formatFn},i.prototype.setTemplate=function(n){void 0===n&&(n={});void 0!==this.footerTemplate&&(this.templateFn[t.getEnumValue(o,o.Summary)]={fn:t.compile(this.footerTemplate,n),property:"footerTemplate"});void 0!==this.groupFooterTemplate&&(this.templateFn[t.getEnumValue(o,o.GroupSummary)]={fn:t.compile(this.groupFooterTemplate,n),property:"groupFooterTemplate"});void 0!==this.groupCaptionTemplate&&(this.templateFn[t.getEnumValue(o,o.CaptionSummary)]={fn:t.compile(this.groupCaptionTemplate,n),property:"groupCaptionTemplate"})},i.prototype.getTemplate=function(n){return this.templateFn[t.getEnumValue(o,n)]},i.prototype.setPropertiesSilent=function(n){this.setProperties(n,!0)},ou([t.Property()],i.prototype,"type",void 0),ou([t.Property()],i.prototype,"field",void 0),ou([t.Property()],i.prototype,"columnName",void 0),ou([t.Property()],i.prototype,"format",void 0),ou([t.Property()],i.prototype,"footerTemplate",void 0),ou([t.Property()],i.prototype,"groupFooterTemplate",void 0),ou([t.Property()],i.prototype,"groupCaptionTemplate",void 0),ou([t.Property()],i.prototype,"customAggregate",void 0),i}(t.ChildProperty),nht=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return cit(i,n),ou([t.Collection([],gst)],i.prototype,"columns",void 0),i}(t.ChildProperty),lit=function(){function n(n,t){this.copyContent="";this.isSelect=!1;this.parent=n;this.serviceLocator=t;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(it,this.initialEnd,this),this.parent.on(ht,this.keyDownHandler,this),this.parent.on(ii,this.clickHandler,this),this.parent.on(vi,this.initialEnd,this),t.EventHandler.add(this.parent.element,"keydown",this.pasteHandler,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ht,this.keyDownHandler),this.parent.off(it,this.initialEnd),this.parent.off(ii,this.clickHandler),this.parent.off(vi,this.initialEnd),t.EventHandler.remove(this.parent.element,"keydown",this.pasteHandler))},n.prototype.clickHandler=function(n){var t=n.target;t=i(t,"e-rowcell")},n.prototype.pasteHandler=function(n){var r=this,i=this.parent,u=/(Mac)/i.test(navigator.platform),f,e;if(67===n.keyCode&&u&&n.metaKey&&!i.isEdit&&this.copy(),86===n.keyCode&&(n.ctrlKey||u&&n.metaKey)&&!i.isEdit){if(!t.closest(document.activeElement,"."+a)||!i.editSettings.allowEditing||"Batch"!==i.editSettings.mode||"Cell"!==i.selectionSettings.mode||"Flow"===i.selectionSettings.cellSelectionMode||!this.clipBoardTextArea)return;this.activeElement=document.activeElement;this.clipBoardTextArea.value="";f=window.scrollX;e=window.scrollY;this.clipBoardTextArea.focus();setTimeout(function(){r.activeElement.focus();window.scrollTo(f,e);r.paste(r.clipBoardTextArea.value,r.parent.getSelectedRowCellIndexes()[0].rowIndex,r.parent.getSelectedRowCellIndexes()[0].cellIndexes[0])},10)}},n.prototype.paste=function(n,i,r){var o,w,c,u=this.parent,e=r,f=i,s,l,d,g,h,p;if(u.editSettings.allowEditing&&"Batch"===u.editSettings.mode&&"Cell"===u.selectionSettings.mode&&"Flow"!==u.selectionSettings.cellSelectionMode){var a,b,y,v=n.split("\n"),nt=u.getDataRows(),k=this.parent.isFrozenGrid();for(k&&(b=u.getMovableDataRows(),u.getFrozenRightColumnsCount()&&(y=u.getFrozenRightDataRows())),s=0;s<v.length;s++){if(a=v[parseInt(s.toString(),10)].split("\t"),e=r,s===v.length-1&&""===v[parseInt(s.toString(),10)]||t.isUndefined(u.getRowByIndex(f))){e++;break}for(l=0;l<a.length;l++){if((c=u.getCellFromIndex(f,e),k)&&(d=nt[parseInt(f.toString(),10)],g=b[parseInt(f.toString(),10)],c=!!d.querySelector('[data-colindex="'+e+'"]')||g.querySelector('[data-colindex="'+e+'"]'),y&&!c&&(c=y[parseInt(f.toString(),10)].querySelector('[data-colindex="'+e+'"]'))),!c){e++;break}(w=(o=u.getColumnByIndex(e)).getParser()?o.getParser()(a[parseInt(l.toString(),10)]):a[parseInt(l.toString(),10)],!o.allowEditing||o.isPrimaryKey||o.template)||(h={column:o,data:w,rowIndex:f},this.parent.trigger(eg,h),f=h.rowIndex,h.cancel||u.editModule&&("number"===o.type?this.parent.editModule.updateCell(f,o.field,parseFloat(h.data)):u.editModule.updateCell(f,o.field,h.data)));e++}f++}u.selectionModule.selectCellsByRange({rowIndex:i,cellIndex:r},{rowIndex:f-1,cellIndex:e-1});p=this.parent.getCellFromIndex(f-1,e-1);p&&t.classList(p,["e-focus","e-focused"],[])}},n.prototype.initialEnd=function(){this.l10n=this.serviceLocator.getService("localization");this.parent.off(it,this.initialEnd);this.clipBoardTextArea=this.parent.createElement("textarea",{className:"e-clipboard",styles:"opacity: 0",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("ClipBoard")}});this.parent.element.appendChild(this.clipBoardTextArea)},n.prototype.keyDownHandler=function(n){"ctrlPlusC"===n.action?this.copy():"ctrlShiftPlusH"===n.action&&this.copy(!0)},n.prototype.setCopyData=function(n){var o,f,v,i,w,r,u,b,l;if(""===window.getSelection().toString()){o=this.parent.isFrozenGrid();this.clipBoardTextArea.value=this.copyContent="";var a=void 0,h=void 0,c=this.parent.getDataRows();if(o&&(a=this.parent.getMovableDataRows(),this.parent.getFrozenMode()!==s&&"Right"!==this.parent.getFrozenMode()||(h=this.parent.getFrozenRightRows())),"Cell"!==this.parent.selectionSettings.mode){if(f=this.parent.getSelectedRowIndexes().sort(function(n,t){return n-t}),n){for(v=[],i=0;i<this.parent.getVisibleColumns().length;i++)v[parseInt(i.toString(),10)]=this.parent.getVisibleColumns()[parseInt(i.toString(),10)].headerText;this.getCopyData(v,!1,"\t",n);this.copyContent+="\n"}for(i=0;i<f.length;i++){i>0&&(this.copyContent+="\n");var e=[],y=[],p=[];o?(p.push.apply(p,[].slice.call(a[f[parseInt(i.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)"))),"Right"!==this.parent.getFrozenMode()&&this.parent.getFrozenMode()!==s||y.push.apply(y,[].slice.call(h[f[parseInt(i.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)"))),("Left"===this.parent.getFrozenMode()||this.parent.getFrozenMode()===s||this.parent.isFrozenGrid()&&!this.parent.getFrozenMode())&&e.push.apply(e,[].slice.call(c[f[parseInt(i.toString(),10)]].querySelectorAll(".e-rowcell:not(.e-hide)")))):(w=f[parseInt(i.toString(),10)],!et(this.parent)&&(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache||this.parent.groupSettings.columns.length&&this.parent.groupSettings.enableLazyLoading)&&(w=c.map(function(n){return n.getAttribute("data-rowindex")}).indexOf(f[parseInt(i.toString(),10)].toString())),e.push.apply(e,[].slice.call(c[parseInt(w.toString(),10)].querySelectorAll(".e-rowcell:not(.e-hide)"))));r=e.concat(p).concat(y);this.getCopyData(r,!1,"\t",n)}}else if(u=this.checkBoxSelection(),u.status){if(n){for(b=[],i=0;i<u.colIndexes.length;i++)b.push(this.parent.getColumnHeaderByIndex(u.colIndexes[parseInt(i.toString(),10)]));this.getCopyData(b,!1,"\t",n);this.copyContent+="\n"}for(i=0;i<u.rowIndexes.length;i++)i>0&&(this.copyContent+="\n"),r=[].slice.call(c[u.rowIndexes[parseInt(i.toString(),10)]].getElementsByClassName("e-cellselectionbackground")),o&&(r.push.apply(r,[].slice.call(a[u.rowIndexes[parseInt(i.toString(),10)]].getElementsByClassName("e-cellselectionbackground"))),h&&r.push.apply(r,[].slice.call(h[u.rowIndexes[parseInt(i.toString(),10)]].getElementsByClassName("e-cellselectionbackground")))),this.getCopyData(r,!1,"\t",n)}else this.getCopyData([].slice.call(this.parent.element.getElementsByClassName("e-cellselectionbackground")),!0,"\n",n);if(l={data:this.copyContent,cancel:!1},this.parent.trigger(fg,l),l.cancel)return;this.clipBoardTextArea.value=this.copyContent=l.data;t.Browser.userAgent.match(/ipad|ipod|iphone/i)?this.clipBoardTextArea.setSelectionRange(0,this.clipBoardTextArea.value.length):this.clipBoardTextArea.select();this.isSelect=!0}},n.prototype.getCopyData=function(n,t,i,r){for(var e,f="string"!=typeof n[0],u=0;u<n.length;u++)r&&t&&(e=parseInt(n[parseInt(u.toString(),10)].getAttribute(lt),10),this.copyContent+=this.parent.getColumns()[parseInt(e.toString(),10)].headerText+"\n"),f?n[parseInt(u.toString(),10)].classList.contains("e-hide")||(this.copyContent+=n[parseInt(u.toString(),10)].innerText):this.copyContent+=n[parseInt(u.toString(),10)],u<n.length-1&&(this.copyContent+=i)},n.prototype.copy=function(n){document.queryCommandSupported("copy")&&this.clipBoardTextArea&&(this.setCopyData(n),document.execCommand("copy"),this.clipBoardTextArea.blur());this.isSelect&&(window.getSelection().removeAllRanges(),this.isSelect=!1)},n.prototype.getModuleName=function(){return"clipboard"},n.prototype.destroy=function(){this.removeEventListener();this.clipBoardTextArea&&t.remove(this.clipBoardTextArea)},n.prototype.checkBoxSelection=function(){var u=this.parent,f={status:!1};if("Cell"===u.selectionSettings.mode){for(var t=u.getSelectedRowCellIndexes(),i=void 0,r=[],n=void 0,n=0;n<t.length&&(t[parseInt(n.toString(),10)].cellIndexes.length&&r.push(t[parseInt(n.toString(),10)].rowIndex),!t[parseInt(n.toString(),10)].cellIndexes.length||(i||(i=JSON.stringify(t[parseInt(n.toString(),10)].cellIndexes.sort())),i===JSON.stringify(t[parseInt(n.toString(),10)].cellIndexes.sort())));n++);r.sort(function(n,t){return n-t});n===t.length&&(f={status:!0,rowIndexes:r,colIndexes:t[0].cellIndexes})}return f},n}(),gi=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ait=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property()],i.prototype,"field",void 0),r([t.Property()],i.prototype,"direction",void 0),r([t.Property(!1)],i.prototype,"isFromGroup",void 0),i}(t.ChildProperty),vit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Collection([],ait)],i.prototype,"columns",void 0),r([t.Property(!0)],i.prototype,"allowUnsort",void 0),i}(t.ChildProperty),yit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property()],i.prototype,"field",void 0),r([t.Property()],i.prototype,"operator",void 0),r([t.Property()],i.prototype,"value",void 0),r([t.Property()],i.prototype,"matchCase",void 0),r([t.Property(!1)],i.prototype,"ignoreAccent",void 0),r([t.Property()],i.prototype,"predicate",void 0),r([t.Property({})],i.prototype,"actualFilterValue",void 0),r([t.Property({})],i.prototype,"actualOperator",void 0),r([t.Property()],i.prototype,"type",void 0),r([t.Property()],i.prototype,"ejpredicate",void 0),r([t.Property()],i.prototype,"uid",void 0),r([t.Property()],i.prototype,"isForeignKey",void 0),r([t.Property()],i.prototype,"condition",void 0),i}(t.ChildProperty),pit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property(!1)],i.prototype,"enableCache",void 0),r([t.Property(3)],i.prototype,"maxBlocks",void 0),r([t.Property(3)],i.prototype,"initialBlocks",void 0),i}(t.ChildProperty),wit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Collection([],yit)],i.prototype,"columns",void 0),r([t.Property("FilterBar")],i.prototype,"type",void 0),r([t.Property("OnEnter")],i.prototype,"mode",void 0),r([t.Property(!0)],i.prototype,"showFilterBarStatus",void 0),r([t.Property(1500)],i.prototype,"immediateModeDelay",void 0),r([t.Property()],i.prototype,"operators",void 0),r([t.Property(!1)],i.prototype,"ignoreAccent",void 0),r([t.Property(!1)],i.prototype,"enableCaseSensitivity",void 0),r([t.Property(!1)],i.prototype,"showFilterBarOperator",void 0),i}(t.ChildProperty),bit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property("Row")],i.prototype,"mode",void 0),r([t.Property("Flow")],i.prototype,"cellSelectionMode",void 0),r([t.Property("Single")],i.prototype,"type",void 0),r([t.Property(!1)],i.prototype,"checkboxOnly",void 0),r([t.Property(!1)],i.prototype,"persistSelection",void 0),r([t.Property("Default")],i.prototype,"checkboxMode",void 0),r([t.Property(!1)],i.prototype,"enableSimpleMultiRowSelection",void 0),r([t.Property(!0)],i.prototype,"enableToggle",void 0),r([t.Property(!1)],i.prototype,"allowColumnSelection",void 0),i}(t.ChildProperty),kit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property([])],i.prototype,"fields",void 0),r([t.Property("")],i.prototype,"key",void 0),r([t.Property("contains")],i.prototype,"operator",void 0),r([t.Property(!0)],i.prototype,"ignoreCase",void 0),r([t.Property(!1)],i.prototype,"ignoreAccent",void 0),i}(t.ChildProperty),dit=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property()],i.prototype,"targetID",void 0),i}(t.ChildProperty),git=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property("Both")],i.prototype,"wrapMode",void 0),i}(t.ChildProperty),nrt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property("Normal")],i.prototype,"mode",void 0),i}(t.ChildProperty),trt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property(!0)],i.prototype,"showDropArea",void 0),r([t.Property(!1)],i.prototype,"allowReordering",void 0),r([t.Property(!1)],i.prototype,"showToggleButton",void 0),r([t.Property(!1)],i.prototype,"showGroupedColumn",void 0),r([t.Property(!0)],i.prototype,"showUngroupButton",void 0),r([t.Property(!1)],i.prototype,"disablePageWiseAggregates",void 0),r([t.Property([])],i.prototype,"columns",void 0),r([t.Property()],i.prototype,"captionTemplate",void 0),r([t.Property(!1)],i.prototype,"enableLazyLoading",void 0),i}(t.ChildProperty),irt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property(!1)],i.prototype,"allowAdding",void 0),r([t.Property(!1)],i.prototype,"allowEditing",void 0),r([t.Property(!1)],i.prototype,"allowDeleting",void 0),r([t.Property("Normal")],i.prototype,"mode",void 0),r([t.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),r([t.Property(!0)],i.prototype,"showConfirmDialog",void 0),r([t.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),r([t.Property("")],i.prototype,"template",void 0),r([t.Property("")],i.prototype,"headerTemplate",void 0),r([t.Property("")],i.prototype,"footerTemplate",void 0),r([t.Property("Top")],i.prototype,"newRowPosition",void 0),r([t.Property({})],i.prototype,"dialog",void 0),r([t.Property(!1)],i.prototype,"allowNextRowEdit",void 0),i}(t.ChildProperty),rrt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return gi(i,n),r([t.Property("Spinner")],i.prototype,"indicatorType",void 0),i}(t.ChildProperty),tv=function(n){function f(i,r){var u=n.call(this,i,r)||this;return u.isPreventScrollEvent=!1,u.inViewIndexes=[],u.keyA=!1,u.frozenRightCount=0,u.frozenLeftCount=0,u.tablesCount=1,u.movableCount=0,u.visibleFrozenLeft=0,u.visibleFrozenRight=0,u.visibleMovable=0,u.frozenLeftColumns=[],u.frozenRightColumns=[],u.movableColumns=[],u.media={},u.isFreezeRefresh=!1,u.tableIndex=0,u.componentRefresh=t.Component.prototype.refresh,u.isVirtualAdaptive=!1,u.requireTemplateRef=!0,u.vRows=[],u.vcRows=[],u.vGroupOffsets={},u.rowUid=0,u.isManualRefresh=!1,u.isAutoFitColumns=!1,u.enableDeepCompare=!1,u.totalDataRecordsCount=0,u.disableSelectedRecords=[],u.partialSelectedRecords=[],u.islazyloadRequest=!1,u.lockcolPositionCount=0,u.prevPageMoving=!1,u.pageTemplateChange=!1,u.isAutoGen=!1,u.mediaBindInstance={},u.commandDelIndex=void 0,u.asyncTimeOut=50,u.isExportGrid=!1,u.enableLogger=!0,u.needsID=!0,o.Inject(sit),t.setValue("mergePersistData",u.mergePersistGridData,u),u}var o;return gi(f,n),o=f,f.prototype.getPersistData=function(){for(var e,r,o,n=["pageSettings","sortSettings","filterSettings","groupSettings","columns","searchSettings","selectedRowIndex","scrollPosition"],s={pageSettings:["template","pageSizes","enableQueryString","totalRecordsCount","pageCount"],filterSettings:["type","mode","showFilterBarStatus","immediateModeDelay","ignoreAccent"],groupSettings:["showDropArea","showToggleButton","showGroupedColumn","showUngroupButton","disablePageWiseAggregates","hideCaptionCount"],searchSettings:["fields","operator","ignoreCase"],sortSettings:[],columns:[],selectedRowIndex:[],scrollPosition:[]},i=0;i<n.length;i++)for(var h=this[n[parseInt(i.toString(),10)]],u=0,f=s[n[parseInt(i.toString(),10)]];u<f.length;u++)delete h[""+f[u]];return e=this.pageSettings.template,r=Object.assign({template:void 0},this.pageSettings),this.setProperties({pageSettings:r},!0),this.isAngular&&delete this.groupSettings.properties.captionTemplate,this.pageTemplateChange=!t.isNullOrUndefined(this.pagerTemplate),o=this.addOnPersist(n),r.template=e,this.setProperties({pageSettings:r},!0),o},f.prototype.requiredModules=function(){this.setFrozenCount();this.enableInfiniteAggrgate();var n=[];return this.isDestroyed||(this.allowFiltering&&n.push({member:"filter",args:[this,this.filterSettings,this.serviceLocator]}),this.allowExcelExport&&n.push({member:"ExcelExport",args:[this,this.serviceLocator]}),this.allowPdfExport&&n.push({member:"PdfExport",args:[this]}),this.allowSorting&&n.push({member:"sort",args:[this,this.sortSettings,this.sortedColumns,this.serviceLocator]}),this.allowPaging&&n.push({member:"pager",args:[this,this.pageSettings]}),this.allowSelection&&n.push({member:"selection",args:[this,this.selectionSettings,this.serviceLocator]}),n.push({member:"resize",args:[this]}),this.allowReordering&&n.push({member:"reorder",args:[this]}),this.allowRowDragAndDrop&&n.push({member:"rowDragAndDrop",args:[this]}),this.allowGrouping&&n.push({member:"group",args:[this,this.groupSettings,this.sortedColumns,this.serviceLocator]}),this.aggregates.length&&n.push({member:"aggregate",args:[this,this.serviceLocator]}),this.isDetail()&&n.push({member:"detailRow",args:[this,this.serviceLocator]}),(this.toolbar||this.toolbarTemplate)&&n.push({member:"toolbar",args:[this,this.serviceLocator]}),(this.enableVirtualization||this.enableColumnVirtualization)&&n.push({member:"virtualscroll",args:[this,this.serviceLocator]}),(this.getFrozenColumns()||this.frozenRows||this.frozenRightCount||this.frozenLeftCount)&&n.push({member:"freeze",args:[this,this.serviceLocator]}),this.isCommandColumn(this.columns)&&n.push({member:"commandColumn",args:[this,this.serviceLocator]}),(this.editSettings.allowAdding||this.editSettings.allowDeleting||this.editSettings.allowEditing)&&n.push({member:"edit",args:[this,this.serviceLocator]}),this.extendRequiredModules(n)),n},f.prototype.extendRequiredModules=function(n){this.enableInfiniteScrolling&&n.push({member:"infiniteScroll",args:[this,this.serviceLocator]});this.groupSettings.enableLazyLoading&&n.push({member:"lazyLoadGroup",args:[this,this.serviceLocator]});this.contextMenuItems&&n.push({member:"contextMenu",args:[this,this.serviceLocator]});this.showColumnMenu&&n.push({member:"columnMenu",args:[this,this.serviceLocator]});this.showColumnChooser&&n.push({member:"columnChooser",args:[this,this.serviceLocator]});this.isForeignKeyEnabled(this.columns)&&n.push({member:"foreignKey",args:[this,this.serviceLocator]});this.enableLogger&&n.push({member:"logger",args:[this]})},f.prototype.preRender=function(){this.serviceLocator=new fit;this.initProperties();this.initializeServices()},f.prototype.initProperties=function(){this.isInitial=!0;this.sortedColumns=[];this.inViewIndexes=[];this.mediaCol=[];this.isInitialLoad=!1;this.allowServerDataBinding=!1;this.ignoreCollectionWatch=!0;this.mergeCells={};this.isEdit=!1;this.checkAllRows="None";this.isCheckBoxSelection=!1;this.isPersistSelection=!1;this.componentRefresh=t.Component.prototype.refresh;this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith",wildCard:"wildcard",isNull:"isnull",notNull:"notnull",like:"like"};this.defaultLocale={EmptyRecord:"No records to display",True:"true",False:"false",InvalidFilterMessage:"Invalid Filter Data",GroupDropArea:"Drag a column header here to group its column",UnGroup:"Click here to ungroup",UnGroupButton:"Click here to ungroup",GroupDisable:"Grouping is disabled for this column",FilterbarTitle:"'s filter bar cell",EmptyDataSourceError:"DataSource must not be empty at initial load since columns are generated from dataSource in AutoGenerate Column Grid",Add:"Add",Edit:"Edit",Cancel:"Cancel",Update:"Update",Delete:"Delete",Print:"Print",Pdfexport:"PDF Export",Excelexport:"Excel Export",Wordexport:"Word Export",Csvexport:"CSV Export",Search:"Search",Columnchooser:"Columns",Save:"Save",Item:"item",Items:"items",EditOperationAlert:"No records selected for edit operation",DeleteOperationAlert:"No records selected for delete operation",SaveButton:"Save",OKButton:"OK",CancelButton:"Cancel",EditFormTitle:"Details of ",AddFormTitle:"Add New Record",BatchSaveConfirm:"Are you sure you want to save changes?",BatchSaveLostChanges:"Unsaved changes will be lost. Are you sure you want to continue?",ConfirmDelete:"Are you sure you want to Delete Record?",CancelEdit:"Are you sure you want to Cancel the changes?",ChooseColumns:"Choose Column",SearchColumns:"search columns",Matchs:"No matches found",FilterButton:"Filter",ClearButton:"Clear",StartsWith:"Starts With",NotStartsWith:"Does Not Start With",Like:"Like",EndsWith:"Ends With",NotEndsWith:"Does Not End With",Contains:"Contains",NotContains:"Does Not Contain",IsNull:"Null",NotNull:"Not Null",IsEmpty:"Empty",IsNotEmpty:"Not Empty",Equal:"Equal",NotEqual:"Not Equal",LessThan:"Less Than",LessThanOrEqual:"Less Than Or Equal",GreaterThan:"Greater Than",GreaterThanOrEqual:"Greater Than Or Equal",ChooseDate:"Choose a Date",EnterValue:"Enter the value",Copy:"Copy",Group:"Group by this column",Ungroup:"Ungroup by this column",GroupButton:"Group button",UnGroupAria:"ungroup button",GroupSeperator:"Separator for the grouped columns",UnGroupIcon:"ungroup the grouped column ",GroupedSortIcon:"sort the grouped column ",GroupedDrag:"Drag the grouped column",GroupCaption:" is groupcaption cell",CheckBoxLabel:"checkbox",autoFitAll:"Autofit all columns",autoFit:"Autofit this column",AutoFitAll:"Autofit all columns",AutoFit:"Autofit this column",Export:"Export",FirstPage:"First Page",LastPage:"Last Page",PreviousPage:"Previous Page",NextPage:"Next Page",SortAscending:"Sort Ascending",SortDescending:"Sort Descending",EditRecord:"Edit Record",DeleteRecord:"Delete Record",FilterMenu:"Filter",SelectAll:"Select All",AddCurrentSelection:"Add current selection to filter",Blanks:"Blanks",FilterTrue:"True",FilterFalse:"False",NoResult:"No matches found",ClearFilter:"Clear Filter",Clear:"Clear",NumberFilter:"Number Filters",TextFilter:"Text Filters",DateFilter:"Date Filters",DateTimeFilter:"DateTime Filters",MatchCase:"Match Case",Between:"Between",CustomFilter:"Custom Filter",CustomFilterPlaceHolder:"Enter the value",CustomFilterDatePlaceHolder:"Choose a date",AND:"AND",OR:"OR",ShowRowsWhere:"Show rows where:",FilterMenuDialogARIA:"Filter menu dialog",ExcelFilterDialogARIA:"Excel filter dialog",DialogEditARIA:"Edit dialog",ColumnChooserDialogARIA:"Column chooser",ColumnMenuDialogARIA:"Column menu dialog",CustomFilterDialogARIA:"Customer filter dialog",SortAtoZ:"Sort A to Z",SortZtoA:"Sort Z to A",SortByOldest:"Sort by Oldest",SortByNewest:"Sort by Newest",SortSmallestToLargest:"Sort Smallest to Largest",SortLargestToSmallest:"Sort Largest to Smallest",Sort:"Sort",FilterDescription:"Press Alt Down to open filter Menu",SortDescription:"Press Enter to sort",ColumnMenuDescription:"Press Alt Down to open Column Menu",GroupDescription:"Press Ctrl space to group",ColumnHeader:" column header ",TemplateCell:" is template cell",CommandColumnAria:"is Command column column header ",DialogEdit:"Dialog edit",ClipBoard:"clipboard",AscendingText:"Ascending",DescendingText:"Descending",NoneText:"None",Expanded:"Expanded",Collapsed:"Collapsed"};this.keyConfigs={downArrow:"downarrow",upArrow:"uparrow",rightArrow:"rightarrow",leftArrow:"leftarrow",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",shiftRight:"shift+rightarrow",shiftLeft:"shift+leftarrow",home:"home",end:"end",escape:"escape",ctrlHome:"ctrl+home",ctrlEnd:"ctrl+end",pageUp:"pageup",pageDown:"pagedown",ctrlAltPageUp:"ctrl+alt+pageup",ctrlAltPageDown:"ctrl+alt+pagedown",altPageUp:"alt+pageup",altPageDown:"alt+pagedown",altDownArrow:"alt+downarrow",altUpArrow:"alt+uparrow",ctrlDownArrow:"ctrl+downarrow",ctrlUpArrow:"ctrl+uparrow",ctrlPlusA:"ctrl+A",ctrlPlusP:"ctrl+P",insert:"insert","delete":"delete",f2:"f2",enter:"enter",ctrlEnter:"ctrl+enter",shiftEnter:"shift+enter",tab:"tab",shiftTab:"shift+tab",space:"space",ctrlPlusC:"ctrl+C",ctrlShiftPlusH:"ctrl+shift+H",ctrlSpace:"ctrl+space",ctrlLeftArrow:"ctrl+leftarrow",ctrlRightArrow:"ctrl+rightarrow"}},f.prototype.render=function(){if(this.log(["module_missing","promise_enabled","locale_missing","check_datasource_columns"]),this.ariaService.setOptions(this.element,{datarole:"grid"}),bt.createSpinner({target:this.element,cssClass:this.cssClass?this.cssClass:null},this.createElement),this.renderModule=new rit(this,this.serviceLocator),this.searchModule=new hit(this),this.scrollModule=new nb(this),this.notify(cr,{}),!0!==this.getDataModule().dataManager.dataSource.offline&&void 0!==this.getDataModule().dataManager.dataSource.url||(this.isVirtualAdaptive=!0),this.isReact){var n={requireTemplateRef:this.requireTemplateRef};this.trigger(oc,n);n.requireTemplateRef||(this.requireTemplateRef=n.requireTemplateRef)}else this.trigger(oc);ee(this.columns,this.enableColumnVirtualization,this);this.enablePersistence&&this.notify(hl,{});this.getMediaColumns();ch(this.columns);this.checkLockColumns(this.columns);this.getColumns();this.processModel();this.gridRender();this.wireEvents();this.addListener();this.updateDefaultCursor();this.updateStackedFilter();"Spinner"===this.loadingIndicator.indicatorType&&this.showSpinner();this.notify(dt,{});"Shimmer"===this.loadingIndicator.indicatorType&&this.refreshMaskRow();this.refreshing&&this.trigger("created")},f.prototype.showSpinner=function(){this.isExportGrid||bt.showSpinner(this.element)},f.prototype.hideSpinner=function(){this.isExportGrid||bt.hideSpinner(this.element)},f.prototype.showMaskRow=function(n,i){var l,a,v,y,r,o,s,h;if(!t.isNullOrUndefined(this.headerModule)&&!t.isNullOrUndefined(this.contentModule)){var f=this.getHeaderContent().firstChild,u=this.getContent().firstChild,c=this.getFooterContent();if(i){var e=i.querySelector(".e-checkboxlist"),p=Math.floor(e.getBoundingClientRect().height/this.getRowHeight()),w='<div class="e-ftrchk e-mask-ftrchk" style="width: 100%;"><div class="e-checkbox-wrapper" style="width: 100%;"><input class="e-chk-hidden">'+this.getShimmerTemplate()+this.getShimmerTemplate()+"<\/div><\/div>";for(e.innerHTML="",l=0;l<p;l++)e.innerHTML+=w,a=[].slice.call(e.querySelectorAll(".e-mask:not(.e-mask-checkbox-filter-intent):not(.e-mask-checkbox-filter-span-intent)")),a[0].classList.add("e-mask-checkbox-filter-intent"),a[1].classList.add("e-mask-checkbox-filter-span-intent")}else{if((!this.enableRtl&&!this.getHeaderContent().style.paddingRight||this.enableRtl&&!this.getHeaderContent().style.paddingLeft)&&(u.style.overflowY="hidden"),!this.isInitialLoad&&!this.getColumns().length)return v=0===(o=u.getBoundingClientRect().height)?this.allowPaging?this.pageSettings.pageSize*this.getRowHeight():window.innerHeight:o,y=Math.ceil(v/this.getRowHeight()),"Vertical"!==this.rowRenderingMode&&(this.headerMaskTable=this.createEmptyMaskTable(f,1)),void(this.contentMaskTable=this.createEmptyMaskTable(u,y));(this.maskRowContentScroll=!(!this.enableVirtualization||!n),this.contentMaskTable||this.isFrozenGrid()&&this.enableColumnVirtualization&&"X"===n)||(r=u,this.isFrozenGrid()?(this.isInitialLoad||this.enableVirtualization||!this.frozenRows||"auto"===this.height||(o=r.getBoundingClientRect().height-this.frozenRows*this.getRowHeight(),r.style.height=o+"px"),r=r.querySelector(".e-frozen-left-content, .e-frozen-right-content")):this.enableVirtualization&&(r=r.querySelector(".e-virtualtable")),t.isNullOrUndefined(r.querySelector("tbody"))||(this.contentMaskTable=this.createMaskTable(r,this.getContentMaskColumns(),n)));(this.headerMaskTable||!(this.isFrozenGrid()||this.enableColumnVirtualization&&"X"===n)||this.isFrozenGrid()&&(this.enableVirtualization&&"Y"===n||this.enableColumnVirtualization&&"X"===n||this.enableInfiniteScrolling&&"down"===n)||(r=f,this.isFrozenGrid()?r=r.querySelector(".e-frozen-left-header, .e-frozen-right-header"):this.enableColumnVirtualization&&"X"===n&&(r=r.querySelector(".e-virtualtable")),this.headerMaskTable=this.createMaskTable(r,this.getContentMaskColumns(),n)),this.movableHeaderMaskTable||!this.isFrozenGrid()||this.enableVirtualization&&"Y"===n||this.enableInfiniteScrolling&&"down"===n||(r=f.querySelector(".e-movableheader"),this.enableColumnVirtualization&&(r=r.querySelector(".e-virtualtable")),this.movableHeaderMaskTable=this.createMaskTable(r,this.getMovableContentMaskColumns(),n)),this.rightHeaderMaskTable||!this.isFrozenGrid()||"Left-Right"!==this.getFrozenMode()||this.enableVirtualization&&"Y"===n||this.enableInfiniteScrolling&&"down"===n||(this.rightHeaderMaskTable=this.createMaskTable(f.querySelector(".e-frozen-right-header"),this.getRightContentMaskColumns(),n)),!this.movableContentMaskTable&&this.isFrozenGrid()&&(r=u.querySelector(".e-movablecontent"),this.enableColumnVirtualization&&(r=r.querySelector(".e-virtualtable")),t.isNullOrUndefined(r.querySelector("tbody"))||(this.movableContentMaskTable=this.createMaskTable(r,this.getMovableContentMaskColumns(),n))),!this.rightContentMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&(this.rightContentMaskTable=this.createMaskTable(u.querySelector(".e-frozen-right-content"),this.getRightContentMaskColumns(),n)),c&&c.querySelector(".e-summaryrow"))&&(s=c.firstChild,this.footerContentMaskTable||(h=s,this.isFrozenGrid()&&(h=h.querySelector(".e-frozen-left-footercontent, .e-frozen-right-footercontent")),this.footerContentMaskTable=this.createMaskTable(h)),this.isFrozenGrid()&&(this.movableFooterContentMaskTable||(this.movableFooterContentMaskTable=this.createMaskTable(s.querySelector(".e-movablefootercontent"))),"Left-Right"!==this.getFrozenMode()||this.rightFooterContentMaskTable||(this.rightFooterContentMaskTable=this.createMaskTable(s.querySelector(".e-frozen-right-footercontent")))));this.enableVirtualization&&n||t.EventHandler.add(u,"scroll",this.translateMaskRow,this)}}},f.prototype.getContentMaskColumns=function(){var n=this.getColumns();return this.isFrozenGrid()&&("Left"===this.getFrozenMode()||"Left-Right"===this.getFrozenMode()?n=this.frozenColumns?n.slice(0,this.frozenColumns):this.getFrozenLeftColumns():"Right"===this.getFrozenMode()&&(n=this.getFrozenRightColumns())),n},f.prototype.getMovableContentMaskColumns=function(){var n=this.getColumns();return this.frozenColumns?n.slice(this.frozenColumns,n.length):this.getMovableColumns()},f.prototype.getRightContentMaskColumns=function(){return this.getFrozenRightColumns()},f.prototype.createEmptyMaskTable=function(n,t){var i=this.createElement("table",{className:"e-table e-masked-table"}),u=this.createElement("tbody",{className:"e-masked-tbody"}),f=this.createElement("tr",{className:"e-masked-row e-row",attrs:{style:"height: "+this.getRowHeight()+"px;"}}),e=this.createElement("td",{className:"e-masked-cell e-rowcell"}),r;for(e.innerHTML=this.getShimmerTemplate(),f.appendChild(e),r=0;r<t;r++)u.appendChild(f.cloneNode(!0));return i.appendChild(u),n.appendChild(i),i},f.prototype.createMaskTable=function(n,i,r){var o=n,c=!!t.closest(o,".e-gridheader"),b=!!t.closest(o,".e-gridcontent"),ct=!!t.closest(o,".e-gridfooter"),d=this.getContent().firstChild,lt=d.scrollHeight,s=o.querySelector("table"),u,y,h,f,l,a,et,it,ot,v,p,g,rt,nt,st,ht,w,ut;if(this.isFrozenGrid()&&(b&&(o.style.overflow="hidden"),o.style.position="relative"),u=s.cloneNode(),u.removeAttribute("role"),u.removeAttribute("id"),u.removeAttribute("aria-multiselectable"),u.removeAttribute("aria-colcount"),u.removeAttribute("aria-rowcount"),u.style.position="absolute",u.style.zIndex="1",u.style.width=s.getBoundingClientRect().width+"px",!c||this.enableColumnVirtualization&&"X"===r||(u.style.transform="translate(0px,"+s.querySelector("thead").getBoundingClientRect().height+"px)"),u.setAttribute("class","e-table e-masked-table"),y=s.querySelector("colgroup").cloneNode(!0),y.removeAttribute("id"),y.setAttribute("class","e-masked-colgroup"),u.appendChild(y),c&&this.enableColumnVirtualization&&"X"===r){var tt=this.createMaskRow(y,i),ft=s.querySelector("thead"),e=[].slice.call(ft.querySelectorAll("tr")),k=ft.cloneNode();for(k.removeAttribute("role"),k.setAttribute("class","e-masked-thead"),h=e.length,f=0;f<h;f++)k.appendChild(tt.cloneNode(!0)),k.childNodes[parseInt(f.toString(),10)].style.height=e[parseInt(f.toString(),10)].getBoundingClientRect().height+"px";u.appendChild(k)}if(l=s.querySelector("tbody").cloneNode(),l.removeAttribute("role"),l.setAttribute("class","e-masked-tbody"),a=s.querySelector("tbody"),b||c&&this.isFrozenGrid())if(et=d,h=c&&this.isFrozenGrid()?this.frozenRows:Math.ceil(et.getBoundingClientRect().height/this.getRowHeight()),a.querySelector(".e-emptyrow")||!a.childNodes.length||b&&this.childGrid)for(it=(tt=this.createMaskRow(y,i)).cloneNode(!0),it.classList.add("e-altrow"),f=0;f<h;f++)ot=b&&this.isFrozenGrid()&&this.frozenRows?this.frozenRows+1:1,l.appendChild((f+ot)%2==0?it.cloneNode(!0):tt.cloneNode(!0));else{for(e=[].slice.call(a.querySelectorAll('tr:not([style*="display:none"]):not([style*="display: none"])')),v=a.querySelector(".e-addedrow, .e-editedrow"),p=void 0,v&&(p=e.indexOf(v),v.classList.contains("e-addedrow")?e.splice(p,2):e.splice(p,1)),h=c&&this.isFrozenGrid()||this.enableVirtualization&&r?e.length:h<=e.length?h:e.length,f=0;f<h;f++)l.appendChild(this.applyMaskRow(e[parseInt(f.toString(),10)].cloneNode(!0),e[parseInt(f.toString(),10)].getBoundingClientRect().height));v&&v.classList.contains("e-editedrow")&&p<h&&(g=l.childNodes[parseInt(p.toString(),10)],g.style.height=this.getRowHeight()+"px",g.classList.add("e-row"),v.classList.contains("e-altrow")&&g.classList.add("e-altrow"))}if(u.appendChild(l),ct){for(rt=s.querySelector("tfoot"),nt=rt.cloneNode(),nt.setAttribute("class","e-masked-tfoot"),e=[].slice.call(rt.querySelectorAll("tr")),f=0;f<e.length;f++)nt.appendChild(this.applyMaskRow(e[parseInt(f.toString(),10)].cloneNode(!0),e[parseInt(f.toString(),10)].getBoundingClientRect().height));u.appendChild(nt)}return(o.insertBefore(u,o.firstChild),c&&this.isFrozenGrid()&&a.getBoundingClientRect().height<u.querySelector("tbody").getBoundingClientRect().height)?(st=u.querySelector("tbody").getBoundingClientRect().height-a.getBoundingClientRect().height,ht=this.createElement("div",{className:"e-masked-table-holder",attrs:{style:"height: "+st+"px;"}}),o.appendChild(ht)):c&&this.isFrozenGrid()&&(!this.enableColumnVirtualization||"X"!==r)&&(u.style.height=o.getBoundingClientRect().height-s.querySelector("thead").getBoundingClientRect().height+"px"),!b||this.enableVirtualization&&r||(w=lt-u.getBoundingClientRect().height,w=w<0?0:w,ut=d.scrollTop<=w?d.scrollTop:w,this.enableVirtualization&&(ut-=hv(t.closest(o,".e-virtualtable")).height),u.style.transform="translate(0px,"+ut+"px)"),u},f.prototype.applyMaskRow=function(n,t){var r=n,f,u,i,e;for(r.removeAttribute("role"),r.removeAttribute("aria-rowindex"),r.removeAttribute("data-rowindex"),r.removeAttribute("data-uid"),r.classList.add("e-masked-row"),r.style.height=t+"px",f=[].slice.call(r.childNodes),u=0;u<f.length;u++)i=f[parseInt(u.toString(),10)],e=i.firstChild&&i.firstChild.classList&&i.firstChild.classList.contains("e-checkbox-wrapper"),i.removeAttribute("role"),i.removeAttribute("tabindex"),i.removeAttribute("aria-label"),i.removeAttribute("data-colindex"),i.removeAttribute("aria-colindex"),i.removeAttribute("index"),i.removeAttribute("ej-mappingname"),i.removeAttribute("ej-mappingvalue"),i.removeAttribute("e-mappinguid"),i.removeAttribute("aria-expanded"),i.classList.add("e-masked-cell"),i.innerHTML=this.getShimmerTemplate(),i.classList.contains("e-recordplusexpand")||i.classList.contains("e-recordpluscollapse")?i.firstChild.classList.add("e-mask-group-intent"):i.classList.contains("e-gridchkbox")||e?i.firstChild.classList.add("e-mask-checkbox-intent"):i.classList.contains("e-rowdragdrop")?i.firstChild.classList.add("e-mask-drag-intent"):i.classList.contains("e-indentcell")&&(i.innerHTML="");return r},f.prototype.createMaskRow=function(n,t){var s=n,r=t,e=this.createElement("tr",{className:"e-masked-row e-row"}),f,u;"Vertical"!==this.rowRenderingMode&&(e.style.height=this.getRowHeight()+"px");for(var h=this.createElement("td",{className:"e-masked-cell e-rowcell"}),o=0,i=0;o<s.childNodes.length;o++)f=s.childNodes[parseInt(o.toString(),10)],u=h.cloneNode(),u.innerHTML=this.getShimmerTemplate(),f.classList.contains("e-group-intent")||f.classList.contains("e-detail-intent")||f.classList.contains("e-drag-intent")?f.classList.contains("e-group-intent")?u.firstChild.classList.add("e-mask-group-intent"):f.classList.contains("e-detail-intent")?u.firstChild.classList.add("e-mask-detail-intent"):f.classList.contains("e-drag-intent")&&u.firstChild.classList.add("e-mask-drag-intent"):("Vertical"===this.rowRenderingMode&&r[parseInt(i.toString(),10)]&&u.setAttribute("data-cell",r[parseInt(i.toString(),10)].headerText?r[parseInt(i.toString(),10)].headerText:r[parseInt(i.toString(),10)].field),"none"===f.style.display?u.classList.add("e-hide"):(u.style.textAlign=r[parseInt(i.toString(),10)]&&r[parseInt(i.toString(),10)].textAlign?r[parseInt(i.toString(),10)].textAlign.toLowerCase():this.enableRtl?"right":"left",r[parseInt(i.toString(),10)]&&("checkbox"===r[parseInt(i.toString(),10)].type||r[parseInt(i.toString(),10)].displayAsCheckBox)&&u.firstChild.classList.add("e-mask-checkbox-intent")),i++),e.appendChild(u);return e},f.prototype.getShimmerTemplate=function(){return this.maskRowContentScroll?'<span class="e-mask e-skeleton e-skeleton-text"><\/span>':'<span class="e-mask e-skeleton e-skeleton-text e-shimmer-wave"><\/span>'},f.prototype.addShimmerEffect=function(){this.maskRowContentScroll=!1;for(var t=[].slice.call(this.element.querySelectorAll(".e-mask:not(.e-shimmer-wave)")),n=0;n<t.length;n++)t[parseInt(n.toString(),10)]&&t[parseInt(n.toString(),10)].classList.add("e-shimmer-wave")},f.prototype.translateMaskRow=function(n){for(var r,i,e,u=n.target,o=u.querySelectorAll(".e-masked-table"),f=0;f<o.length;f++)r=o[parseInt(f.toString(),10)],r&&(i=u.scrollHeight-r.getBoundingClientRect().height,i=i<0?0:i,e=u.scrollTop<=i?u.scrollTop:i,this.enableVirtualization&&(e-=hv(t.closest(r,".e-virtualtable")).height),r.style.transform="translate(0px,"+e+"px)")},f.prototype.removeMaskRow=function(){var e=this.getContent().firstChild,u,i,n,r,f;for(t.EventHandler.remove(e,"scroll",this.translateMaskRow),u=[this.headerMaskTable,this.movableHeaderMaskTable,this.rightHeaderMaskTable,this.contentMaskTable,this.movableContentMaskTable,this.rightContentMaskTable,this.footerContentMaskTable,this.movableFooterContentMaskTable,this.rightFooterContentMaskTable],i=0;i<u.length;i++)n=u[parseInt(i.toString(),10)],n&&(this.isFrozenGrid()&&!t.closest(n,".e-gridfooter")&&(r=n.parentElement,(r.style.overflow="",r.style.position="",t.closest(n,".e-frozen-left-header")||t.closest(n,".e-movableheader")||t.closest(n,".e-frozen-right-header"))&&(f=r.querySelector(".e-masked-table-holder"),f&&t.remove(f))),t.remove(n));this.headerMaskTable=null;this.movableHeaderMaskTable=null;this.rightHeaderMaskTable=null;this.contentMaskTable=null;this.movableContentMaskTable=null;this.rightContentMaskTable=null;this.footerContentMaskTable=null;this.movableFooterContentMaskTable=null;this.rightFooterContentMaskTable=null},f.prototype.refreshMaskRow=function(){var i=this.getHeaderContent().firstChild,t=this.getContent().firstChild,n;(this.isInitialLoad||this.getColumns().length)&&(this.contentMaskTable&&t.querySelector(".e-masked-table")&&(n=t,this.isFrozenGrid()?n=n.querySelector(".e-frozen-left-content, .e-frozen-right-content"):this.enableVirtualization&&(n=n.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(n)),this.headerMaskTable&&this.isFrozenGrid()&&this.refreshMaskRowColgroupWidth(i.querySelector(".e-frozen-left-header, .e-frozen-right-header")),this.movableHeaderMaskTable&&this.isFrozenGrid()&&(n=i.querySelector(".e-movableheader"),this.enableColumnVirtualization&&(n=n.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(n)),this.rightHeaderMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&this.refreshMaskRowColgroupWidth(i.querySelector(".e-frozen-right-header")),this.movableContentMaskTable&&this.isFrozenGrid()&&(n=t.querySelector(".e-movablecontent"),this.enableColumnVirtualization&&(n=n.querySelector(".e-virtualtable")),this.refreshMaskRowColgroupWidth(n)),this.rightContentMaskTable&&this.isFrozenGrid()&&"Left-Right"===this.getFrozenMode()&&this.refreshMaskRowColgroupWidth(t.querySelector(".e-frozen-right-content")))},f.prototype.refreshMaskRowColgroupWidth=function(n){var f=n.querySelector("table:not(.e-masked-table)"),i=f.querySelector(c).cloneNode(!0),r=n.querySelector(".e-masked-table"),u;for(i.removeAttribute("id"),i.setAttribute("class","e-masked-colgroup"),u=0;u<i.childNodes.length;u++)i.childNodes[parseInt(u.toString(),10)].removeAttribute("class");t.remove(r.querySelector(".e-masked-colgroup"));r.insertBefore(i,r.firstChild);r.style.width=f.getBoundingClientRect().width+"px"},f.prototype.updateStackedFilter=function(){this.allowFiltering&&"FilterBar"===this.filterSettings.type&&this.getHeaderContent().getElementsByClassName("e-stackedheadercell").length?this.getHeaderContent().classList.add("e-stackedfilter"):this.getHeaderContent().classList.remove("e-stackedfilter")},f.prototype.getMediaColumns=function(){var i,n;if(!this.enableColumnVirtualization&&(i=this.getColumns(),this.getShowHideService=this.serviceLocator.getService("showHideService"),!t.isNullOrUndefined(i)))for(n=0;n<i.length;n++)!t.isNullOrUndefined(i[parseInt(n.toString(),10)].hideAtMedia)&&(t.isNullOrUndefined(i[parseInt(n.toString(),10)].visible)||i[parseInt(n.toString(),10)].visible)&&this.pushMediaColumn(i[parseInt(n.toString(),10)],n)},f.prototype.pushMediaColumn=function(n,t){this.mediaCol.push(n);this.media[n.uid]=window.matchMedia(n.hideAtMedia);this.mediaQueryUpdate(t,this.media[n.uid]);this.mediaBindInstance[parseInt(t.toString(),10)]=this.mediaQueryUpdate.bind(this,t);this.media[n.uid].addListener(this.mediaBindInstance[parseInt(t.toString(),10)])},f.prototype.updateMediaColumns=function(n){if(!this.enableColumnVirtualization){for(var i=this.getColumnIndexByUid(n.uid),t=0;t<this.mediaCol.length;t++)if(n.uid===this.mediaCol[parseInt(t.toString(),10)].uid)return void this.mediaCol.splice(t,1);this.pushMediaColumn(n,i)}},f.prototype.mediaQueryUpdate=function(n,t){var i=this.getColumns()[parseInt(n.toString(),10)];this.mediaCol.some(function(n){return n.uid===i.uid})&&(i.visible=t.matches,this.isInitialLoad&&(this.invokedFromMedia=!0,i.visible?this.showHider.show(i.headerText,"headerText"):this.showHider.hide(i.headerText,"headerText")))},f.prototype.refreshMediaCol=function(){this.isInitialLoad=!0;var n=this.element.querySelector("."+fu);this.aggregates.length&&this.element.scrollHeight>this.height&&n&&t.addClass([n],["e-footerpadding"]);this.getColumns().filter(function(n){return"checkbox"===n.type}).length&&"ResetOnRowClick"===this.selectionSettings.checkboxMode&&(this.isCheckBoxSelection=!1);"Vertical"===this.rowRenderingMode&&this.enableHover&&(this.setProperties({enableAdaptiveUI:!0,enableHover:!1},!0),t.removeClass([this.element],"e-gridhover"));this.enableAdaptiveUI&&this.scrollModule&&this.scrollModule.refresh()},f.prototype.removeMediaListener=function(){for(var n=0;n<this.mediaCol.length;n++)this.media[this.mediaCol[parseInt(n.toString(),10)].uid].removeListener(this.mediaBindInstance[this.mediaCol[parseInt(n.toString(),10)].index])},f.prototype.eventInitializer=function(){},f.prototype.destroy=function(){var u=this.element,f,r,i;if(u){for(f=!(!u.querySelector("."+ct)||!u.querySelector("."+ot)),f&&this.unwireEvents(),this.removeListener(),this.removeMediaListener(),this.notify(v,{}),this.destroyDependentModules(),(this.isReact||this.isVue)&&this.destroyTemplate(["template"]),f&&n.prototype.destroy.call(this),this.toolTipObj.destroy(),this.isReact&&!t.Browser.isIE&&(this.element.innerHTML=""),r=["renderModule","headerModule","contentModule","valueFormatterService","serviceLocator","ariaService","keyboardModule","widthService","searchModule","showHider","scrollModule","printModule","clipboardModule","focusModule"],i=0;i<r.length;i++)this[r[parseInt(i.toString(),10)]]&&(this[r[parseInt(i.toString(),10)]]=null);this.element.innerHTML="";t.classList(this.element,[],["e-rtl","e-gridhover","e-responsive","e-default","e-device","e-grid-min-height"]);this.isFreezeRefresh=!1}},f.prototype.destroyDependentModules=function(){var n=this.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.scrollModule.destroy(),this.keyboardModule.destroy(),this.focusModule.destroy(),this.clipboardModule.destroy(),this.printModule.destroy())},f.prototype.getModuleName=function(){return"grid"},f.prototype.enableBoxSelection=function(){this.enableAutoFill?(this.selectionSettings.cellSelectionMode="BoxWithBorder",this.element.classList.add("e-afenabled")):this.element.classList.remove("e-afenabled")},f.prototype.setCSSClass=function(n){this.cssClass&&t.addClass([this.element],this.cssClass.split(" "));n&&t.removeClass([this.element],n.split(" "))},f.prototype.onPropertyChanged=function(n,i){var e,r=!1,o=!1,y=!1,p=null,u=null,h,s,c,l,w,a,f,v;if(!this.isDestroyed){for(this.log("module_missing"),this.isEllipsisTooltip()&&this.toolTipObj.close(),h=Object.keys(n),h.indexOf("columns")>-1&&(this.enableColumnVirtualization&&(this.columnModel=[]),this.updateColumnObject(),o=!0),s=0,c=h;s<c.length;s++){l=c[s];switch(l){case"allowPaging":this.notify(tt,{module:"pager",enable:this.allowPaging});r=!0;break;case"pageSettings":if(this.pageTemplateChange){this.pageTemplateChange=!1;this.notify(gt,{module:"pager",properties:n.pageSettings});break}this.notify(gt,{module:"pager",properties:n.pageSettings});(t.isNullOrUndefined(n.pageSettings.currentPage)&&t.isNullOrUndefined(n.pageSettings.pageSize)&&t.isNullOrUndefined(n.pageSettings.totalRecordsCount)||!t.isNullOrUndefined(i.pageSettings)&&n.pageSettings.currentPage!==i.pageSettings.currentPage&&!this.enableColumnVirtualization&&!this.enableVirtualization&&this.pageSettings.totalRecordsCount<=this.pageSettings.pageSize)&&(r=!0);break;case"allowSorting":this.notify(tt,{module:"sort",enable:this.allowSorting});r=!0;e=!0;break;case"allowFiltering":this.updateStackedFilter();this.notify(tt,{module:"filter",enable:this.allowFiltering});r=!0;"FilterBar"!==this.filterSettings.type&&this.refreshHeader();break;case"height":case"width":this.notify(tt,{module:"scroll",properties:{width:n.width,height:n.height}});this.allowPaging&&this.pagerModule.refresh();break;case"allowReordering":this.headerModule.refreshUI();e=!0;break;case"allowRowDragAndDrop":this.notify(tt,{module:"rowDragAndDrop",enable:this.allowRowDragAndDrop});this.renderModule.refresh();this.headerModule.refreshUI();break;case"allowSelection":this.notify(tt,{module:"selection",enable:this.allowSelection});break;case"cssClass":this.setCSSClass(i.cssClass);break;case"enableAutoFill":this.selectionModule&&(this.enableBoxSelection(),this.selectionModule.updateAutoFillPosition());break;case"rowTemplate":this.rowTemplateFn=ri(this.rowTemplate);r=!0;break;case"detailTemplate":this.detailTemplateFn=ri(this.detailTemplate);r=!0;break;case"allowGrouping":this.notify(tt,{module:"group",enable:this.allowGrouping});this.headerModule.refreshUI();r=!0;e=!0;break;case"enableInfiniteScrolling":case"childGrid":if(r=!0,u=(p=this.parentDetails?document.querySelector("#"+this.parentDetails.parentID):null)?p.ej2_instances[0]:null,this.childGrid&&u&&t.isNullOrUndefined(u.childGrid.childGrid))for(w=Object.assign({},u.childGrid,{childGrid:n.childGrid}),u.setProperties({childGrid:w},!0);!t.isNullOrUndefined(u.parentDetails);)a=document.querySelector("#"+u.parentDetails.parentID),f=a?a.ej2_instances[0]:null,f&&(v=Object.assign({},f.childGrid),v.childGrid=u.childGrid,f.setProperties({childGrid:v},!0)),u=f;break;case"toolbar":this.notify(tt,{module:"toolbar"});break;case"groupSettings":this.notify(gt,{module:"group",properties:n.groupSettings,oldProperties:i.groupSettings});break;case"aggregates":!this.aggregates.length&&this.allowGrouping&&this.groupSettings.columns.length&&(r=!0);this.notify(tt,{module:"aggregate",properties:n});break;case"frozenColumns":case"frozenRows":case"enableVirtualization":case"currencyCode":case"locale":this.log("frozen_rows_columns");y=!0;o=!0;break;case"query":this.getDataModule().isQueryInvokedFromData||(r=!0);this.getDataModule().isQueryInvokedFromData=!1;break;case"autoFit":this.autoFit?this.preventAdjustColumns():this.restoreAdjustColumns();break;default:this.extendedPropertyChange(l,n,o)}}e&&this.updateDefaultCursor();o?y||this.getFrozenColumns()||this.frozenRows?this.freezeRefresh():this.refresh():r&&(this.notify(pt,{requestType:"refresh"}),r=!1,this.maintainSelection(n.selectedRowIndex))}},f.prototype.extendedPropertyChange=function(n,i,r){var e,o,h;switch(n){case"enableRtl":this.updateRTL();this.allowPaging&&(this.element.querySelector(".e-gridpager").ej2_instances[0].enableRtl=i.enableRtl,this.element.querySelector(".e-gridpager").ej2_instances[0].dataBind());"auto"!==this.height&&(this.scrollModule.removePadding(!i.enableRtl),this.scrollModule.setPadding());this.toolbar&&this.toolbarModule&&(this.toolbarModule.getToolbar().ej2_instances[0].enableRtl=i.enableRtl,this.toolbarModule.getToolbar().ej2_instances[0].dataBind());this.contextMenuItems&&this.contextMenuModule&&(this.contextMenuModule.getContextMenu().ej2_instances[0].enableRtl=i.enableRtl,this.contextMenuModule.getContextMenu().ej2_instances[0].dataBind());this.showColumnMenu&&this.columnMenuModule&&(this.columnMenuModule.getColumnMenu().ej2_instances[0].enableRtl=i.enableRtl,this.columnMenuModule.getColumnMenu().ej2_instances[0].dataBind());"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&this.refreshHeader();this.notify(ul,{});break;case"enableAltRow":this.renderModule.refresh();break;case"allowResizing":this.headerModule.refreshUI();this.updateResizeLines();break;case"rowHeight":this.rowHeight?t.addClass([this.element],"e-grid-min-height"):t.removeClass([this.element],"e-grid-min-height");this.renderModule.refresh();this.headerModule.refreshUI();break;case"gridLines":this.updateGridLines();break;case"showColumnMenu":this.headerModule.refreshUI();this.notify(tt,{module:"columnMenu",enable:!0});break;case"columnMenuItems":this.notify(tt,{module:"columnMenu",enable:this.columnMenuItems});break;case"contextMenuItems":this.notify(tt,{module:"contextMenu",enable:this.contextMenuItems});break;case"showColumnChooser":this.notify(tt,{module:"columnChooser",enable:this.showColumnChooser});break;case"filterSettings":this.updateStackedFilter();this.notify(gt,{module:"filter",properties:i.filterSettings});break;case"searchSettings":this.notify(gt,{module:"search",properties:i.searchSettings});break;case"sortSettings":this.notify(gt,{module:"sort"});break;case"selectionSettings":this.notify(gt,{module:"selection",properties:i.selectionSettings});break;case"editSettings":this.notify(gt,{module:"edit",properties:i.editSettings});break;case"allowTextWrap":case"textWrapSettings":this.allowTextWrap?this.applyTextWrap():this.removeTextWrap();this.notify(ei,{"case":"textwrap",isModeChg:"textWrapSettings"===n});break;case"dataSource":if(e=this.getDataModule().getState(),Object.getPrototypeOf(i).deepWatch)for(var c=this.getPrimaryKeyFieldNames()[0],f=0,s=Object.keys(i.dataSource);f<s.length;f++)this.setRowData(t.getValue(c,this.dataSource[s[parseInt(f.toString(),10)]]),this.dataSource[s[parseInt(f.toString(),10)]]);else if(e.isPending){for(o=t.isNullOrUndefined(this.dataSource)?[]:this.dataSource.result,h=e.group||[],f=0;f<h.length;f++)o=u.DataUtil.group(o,h[parseInt(f.toString(),10)],e.aggregates||[]);this.dataSource={result:o,count:this.dataSource.count,aggregates:this.dataSource.aggregates};this.getDataModule().setState({});e.resolver(this.dataSource)}else this.getDataModule().setState({isDataChanged:!1}),this.notify(ve,{}),r||(this.renderModule.refresh(),this.isCheckBoxSelection&&this.notify(ta,{}));this.scrollRefresh();break;case"enableHover":(i.enableHover?t.addClass:t.removeClass)([this.element],"e-gridhover");break;case"selectedRowIndex":this.isSelectedRowIndexUpdating||this.selectRow(i.selectedRowIndex);this.isSelectedRowIndexUpdating=!1;break;case"resizeSettings":this.widthService.setWidthToTable();break;case"enableAdaptiveUI":this.notify(io,{});break;case"rowRenderingMode":this.enableVerticalRendering();this.notify(ea,{});this.refresh();break;case"enableStickyHeader":this.scrollModule.addStickyListener(i.enableStickyHeader)}},f.prototype.maintainSelection=function(n){var i=this,t;if(-1!==n){t=function(){i.selectRow(n);i.off(it,t)};this.on(it,t,this)}},f.prototype.setProperties=function(t,i){n.prototype.setProperties.call(this,t,i);t.filterSettings&&this.filterModule&&i&&this.filterModule.refreshFilter()},f.prototype.setTablesCount=function(){var i=this.getFrozenColumns(),n=this.getFrozenLeftColumnsCount(),t=this.getFrozenRightColumnsCount();!i||n||t?i||!n&&!t||(n&&!t||t&&!n?this.tablesCount=2:n&&t&&(this.tablesCount=3)):this.tablesCount=2},f.prototype.getTablesCount=function(){return this.tablesCount},f.prototype.updateDefaultCursor=function(){var t=[].slice.call(this.getHeaderContent().querySelectorAll(".e-headercell:not(.e-stackedheadercell)")),e=[].slice.call(this.getHeaderContent().getElementsByClassName("e-stackedheadercell")),r=this.getColumns(),u,n,f,i;for(this.enableColumnVirtualization&&this.getFrozenColumns()&&(u=this.contentModule.getHeaderCells(),t=u.length?u:t),n=0;n<t.length;n++)f=t[parseInt(n.toString(),10)],(this.allowGrouping||this.allowReordering||this.allowSorting)&&(r[parseInt(n.toString(),10)].allowReordering&&r[parseInt(n.toString(),10)].allowSorting&&r[parseInt(n.toString(),10)].allowGrouping?f.classList.add("e-mousepointer"):f.classList.add("e-defaultcursor"));for(i=0;i<e.length;i++)this.allowReordering&&e[parseInt(i.toString(),10)].classList.add("e-mousepointer")},f.prototype.updateColumnModel=function(n,i){for(var r=0,u=n.length;r<u;r++)n[parseInt(r.toString(),10)].columns?this.updateColumnModel(n[parseInt(r.toString(),10)].columns,!0):this.columnModel.push(n[parseInt(r.toString(),10)]);!t.isNullOrUndefined(i)&&i||(this.updateColumnLevelFrozen(),this.updateFrozenColumns(),this.updateLockableColumns())},f.prototype.updateColumnLevelFrozen=function(){var i=this.columnModel,r=[],u=[],f=[],t,e,n;if(this.frozenLeftCount||this.frozenRightCount){for(t=0,e=i.length;t<e;t++)n=i[parseInt(t.toString(),10)],"Left"===n.freeze?(n.freezeTable=rt,r.push(n)):"Right"===n.freeze?(n.freezeTable=d,u.push(n)):(n.freezeTable="movable",f.push(n));this.columnModel=r.concat(f).concat(u)}},f.prototype.updateFrozenColumns=function(){var n;if(!this.frozenLeftCount&&!this.frozenRightCount)for(var u=this.columnModel,r=this.frozenColumns,f=this.getFrozenColumns(),e=0,i=0,o=u.length;i<o;i++)n=u[parseInt(i.toString(),10)],r&&(n.freezeTable=i<r?rt:"movable"),n.isFrozen&&i>=r?(n.freezeTable=rt,u.splice(this.frozenColumns+e,0,u.splice(i,1)[0]),e++):f&&!r&&(n.freezeTable="movable"),f||r||t.isNullOrUndefined(n.freezeTable)||(n.freezeTable=void 0)},f.prototype.getFrozenLeftCount=function(){return this.getFrozenColumns()||this.getFrozenLeftColumnsCount()},f.prototype.isFrozenGrid=function(){return 0!==this.getFrozenColumns()||0!==this.getFrozenLeftColumnsCount()||0!==this.getFrozenRightColumnsCount()},f.prototype.getFrozenMode=function(){return this.frozenName},f.prototype.updateLockableColumns=function(){for(var n=this.columnModel,i=0,r=0,u=this.getFrozenColumns(),t=0;t<n.length;t++)n[parseInt(t.toString(),10)].lockColumn&&(t<u?(n.splice(i,0,n.splice(t,1)[0]),i++):(n.splice(u+r,0,n.splice(t,1)[0]),r++))},f.prototype.checkLockColumns=function(n){for(var t=0;t<n.length;t++)n[parseInt(t.toString(),10)].columns?this.checkLockColumns(n[parseInt(t.toString(),10)].columns):n[parseInt(t.toString(),10)].lockColumn&&this.lockcolPositionCount++},f.prototype.getColumns=function(n){var f=this,i=this.inViewIndexes.map(function(n){return n-f.groupSettings.columns.length}).filter(function(n){return n>-1}),u=i.length,r;return(!this.enableColumnVirtualization||t.isNullOrUndefined(this.columnModel)||0===this.columnModel.length||n)&&(this.columnModel=[],this.updateColumnModel(this.columns)),r=0===u?this.columnModel:this.columnModel.slice(i[0],i[u-1]+1),this.contentModule&&this.enableColumnVirtualization&&this.isFrozenGrid()&&i.length&&i[0]>0&&(r=this.contentModule.ensureFrozenCols(r)),r},f.prototype.getStackedHeaderColumnByHeaderText=function(n,t){for(var i,r=0;r<t.length;r++){if(i=t[parseInt(r.toString(),10)],i.field===n||i.headerText===n){this.stackedColumn=i;break}i.columns&&this.getStackedHeaderColumnByHeaderText(n,i.columns)}return this.stackedColumn},f.prototype.getColumnIndexesInView=function(){return this.inViewIndexes},f.prototype.getQuery=function(){return this.query},f.prototype.getLocaleConstants=function(){return this.defaultLocale},f.prototype.setColumnIndexesInView=function(n){this.inViewIndexes=n},f.prototype.getVisibleColumns=function(){return this.getCurrentVisibleColumns()},f.prototype.getHeaderContent=function(){return this.headerModule.getPanel()},f.prototype.setGridHeaderContent=function(n){this.headerModule.setPanel(n)},f.prototype.getContentTable=function(){return this.contentModule.getTable()},f.prototype.setGridContentTable=function(n){this.contentModule.setTable(n)},f.prototype.getContent=function(){return this.contentModule.getPanel()},f.prototype.setGridContent=function(n){this.contentModule.setPanel(n)},f.prototype.getHeaderTable=function(){return this.headerModule.getTable()},f.prototype.setGridHeaderTable=function(n){this.headerModule.setTable(n)},f.prototype.getFooterContent=function(){return this.footerElement=this.element.getElementsByClassName(fu)[0],this.footerElement},f.prototype.getFooterContentTable=function(){return this.footerElement=this.element.getElementsByClassName(fu)[0],this.footerElement.firstChild.firstChild},f.prototype.getPager=function(){return this.gridPager},f.prototype.setGridPager=function(n){this.gridPager=n},f.prototype.getRowByIndex=function(n){return this.enableVirtualization&&this.groupSettings.enableLazyLoading?this.lazyLoadRender.getRowByIndex(n):this.contentModule.getRowByIndex(n)},f.prototype.getMovableRowByIndex=function(n){return this.contentModule.getMovableRowByIndex(n)},f.prototype.getFrozenRowByIndex=function(n){return this.getFrozenDataRows()[parseInt(n.toString(),10)]},f.prototype.getRows=function(){return this.contentModule.getRowElements()},f.prototype.getFrozenRightRowByIndex=function(n){return this.contentModule.getFrozenRightRowByIndex(n)},f.prototype.getRowInfo=function(n){var e=n,o={target:n},u,f,b,s,r;if(!t.isNullOrUndefined(n)&&t.isNullOrUndefined(i(e,"e-detailrowcollapse")&&t.isNullOrUndefined(i(e,"e-recordplusexpand")))){if(u=t.closest(e,"."+a),!u)return f=t.closest(e,"."+y),t.isNullOrUndefined(f)||f.classList.contains("e-addedrow")||(b=this.getRowObjectFromUID(f.getAttribute("data-uid")),s=parseInt(f.getAttribute(h),10),o={row:f,rowData:b.data,rowIndex:s}),o;if(r=parseInt(u.getAttribute(lt),10),!t.isNullOrUndefined(u)&&!isNaN(r)){var l=t.closest(u,"."+y),nt=(s=parseInt(l.getAttribute(h),10),this.getFrozenColumns()),v=this.columnModel[parseInt(r.toString(),10)].getFreezeTableName(),c=this.contentModule.getRows(),p=r+this.getIndentCount();this.isFrozenGrid()&&(v===rt?c=this.contentModule.getRows():"movable"===v?(p=r-nt-this.frozenLeftCount,c=this.contentModule.getMovableRows()):v===d&&(p=r-(this.frozenLeftCount+this.movableCount),c=this.contentModule.getFrozenRightRows()));var w=c.filter(function(n){return n.uid===l.getAttribute("data-uid")}),k={},g=void 0;Object.keys(w).length&&(k=w[0].data,g=w[0].cells[parseInt(p.toString(),10)].column);o={cell:u,cellIndex:r,row:l,rowIndex:s,rowData:k,column:g,target:n}}}return o},f.prototype.getMovableRows=function(){return this.contentModule.getMovableRowElements()},f.prototype.getFrozenRightRows=function(){return this.contentModule.getFrozenRightRowElements()},f.prototype.getDataRows=function(){return this.getAllDataRows()},f.prototype.getAllDataRows=function(n){var r,i,u,f;return t.isNullOrUndefined(this.getContentTable().querySelector(e))?[]:(r=this.isFrozenGrid()?this.getFrozenLeftContentTbody():this.getContentTable().querySelector(e),i=[].slice.call(r.children),this.frozenRows&&(u=this.isFrozenGrid()?this.getHeaderContent().querySelector("."+fr).querySelector(e):this.getHeaderTable().querySelector(e),f=[].slice.call(u.children),i=this.addMovableRows(f,i)),this.generateDataRows(i,n))},f.prototype.addMovableRows=function(n,t){for(var i=0,r=t.length;i<r;i++)n.push(t[parseInt(i.toString(),10)]);return n},f.prototype.generateDataRows=function(n,t){for(var r=[],i=0,u=n.length;i<u;i++)n[parseInt(i.toString(),10)].classList.contains(y)&&(!n[parseInt(i.toString(),10)].classList.contains("e-hiddenrow")||t)&&(this.isCollapseStateEnabled()?r[parseInt(n[parseInt(i.toString(),10)].getAttribute("data-rowindex"),10)]=n[parseInt(i.toString(),10)]:r.push(n[parseInt(i.toString(),10)]));return r},f.prototype.getMovableDataRows=function(){return this.getAllMovableDataRows()},f.prototype.getAllMovableDataRows=function(n){var t,i;return this.isFrozenGrid()?(t=[].slice.call(this.getContent().querySelector("."+p).querySelector(e).children),this.frozenRows&&(i=[].slice.call(this.getHeaderContent().querySelector("."+w).querySelector(e).children),t=this.addMovableRows(i,t)),this.generateDataRows(t,n)):[]},f.prototype.getFrozenDataRows=function(){return this.getAllFrozenDataRows()},f.prototype.getAllFrozenDataRows=function(n){var t=[].slice.call(this.getContent().querySelector("."+wi).querySelector(e).children),i;return this.frozenRows&&(i=[].slice.call(this.getHeaderContent().querySelector("."+fr).querySelector(e).children),t=this.addMovableRows(i,t)),this.generateDataRows(t,n)},f.prototype.getFrozenRightDataRows=function(){return this.getAllFrozenRightDataRows()},f.prototype.getAllFrozenRightDataRows=function(n){var t,i;return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()?[]:(t=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(e).children),this.frozenRows&&(i=[].slice.call(this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(e).children),t=this.addMovableRows(i,t)),this.generateDataRows(t,n))},f.prototype.setCellValue=function(n,i,r){var h="data",c="index",a="Right"===this.getFrozenMode(),b=this.getPrimaryKeyFieldNames()[0],k=new si(this,this.serviceLocator),f=this.getColumnIndexByField(i),e=this.getColumnByField(i),u=("movable"===e.getFreezeTableName()?this.contentModule.getMovableRows():"frozen-right"===e.getFreezeTableName()?this.getFrozenRightRowsObject():this.contentModule.getRows()).filter(function(i){return t.getValue(b,i.data)===n})[0],l=u?this.element.querySelector("[data-uid="+u.uid+"]"):null,s,v,y,o,p,w;t.isNullOrUndefined(l)||("string"==typeof r&&(r=this.sanitize(r)),t.setValue(i,r,u[""+h]),s=this.getFrozenLeftColumnsCount()||this.getFrozenColumns(),v=this.getMovableColumnsCount(),this.isRowDragable()&&!a&&s++,y=s+v,o=this.enableVirtualization?l.children[parseInt(f.toString(),10)]:this.getCellFromIndex(u[""+c],f),t.isNullOrUndefined(o)||(p="movable"===e.getFreezeTableName()?s:"frozen-right"===e.getFreezeTableName()?y:0,this.groupSettings.columns.length&&(f+=this.groupSettings.columns.length),(this.childGrid||this.detailTemplate)&&f++,this.isRowDragable()&&!a&&f++,w=u.cells[f-p],k.refreshTD(o,w,u[""+h],{index:u[""+c]}),this.isReact&&(o=this.enableVirtualization?l.children[parseInt(f.toString(),10)]:this.getCellFromIndex(u[""+c],f)),this.aggregates.length>0&&(this.notify(nu,{}),this.groupSettings.columns.length>0&&this.notify(uu,{})),t.isNullOrUndefined(u)||t.isNullOrUndefined(u.changes)||(u.changes[""+i]=r),this.trigger(cf,{cell:o,column:e,data:u[""+h]})))},f.prototype.refreshReactColumnTemplateByUid=function(n,t){var i=this;this.isReact&&this.clearTemplate(["columnTemplate"],void 0,function(){var n=!(!i.childGrid||!i.element.querySelectorAll(".e-childgrid").length),f=n?i.getContentTable().querySelectorAll(".e-row"):i.getDataRows(),r,u;i.refreshReactTemplateTD(f,n);r=i.getContent().querySelector("."+p);u=i.getContent().querySelector(".e-frozen-right-content");r&&r.querySelectorAll(".e-templatecell").length&&i.refreshReactTemplateTD(i.getMovableDataRows(),n,!0);u&&u.querySelectorAll(".e-templatecell").length&&i.refreshReactTemplateTD(i.getFrozenRightDataRows(),n,!0);t&&i.renderTemplates()})},f.prototype.refreshReactTemplateTD=function(n,r,u){for(var f,c,o,s,y,p,l="cells",a=this.getIndentCount(),v=0,h=!1,e=0;e<n.length;e++){if(f=this.getRowObjectFromUID(n[parseInt(e.toString(),10)].getAttribute("data-uid")),r&&!f&&i(n[parseInt(e.toString(),10)],"e-childgrid")&&(c=i(n[parseInt(e.toString(),10)],"e-childgrid").ej2_instances[0],f=c.getRowObjectFromUID(n[parseInt(e.toString(),10)].getAttribute("data-uid")),v=c.getIndentCount(),h=!0),f&&f.isDataRow&&!t.isNullOrUndefined(f.index)&&!n[parseInt(e.toString(),10)].classList.contains("e-editedrow"))for(o=0;o<f[""+l].length;o++)s=f[""+l][parseInt(o.toString(),10)],s.isTemplate&&(y=new si(this,this.serviceLocator),p=r?n[parseInt(e.toString(),10)].children[s.index+(h?v:a)]:this.getCellFromIndex(e,u?s.index:o-a),y.refreshTD(p,s,f.data,{index:f.index}));h=!1}},f.prototype.refreshGroupCaptionFooterTemplate=function(){for(var u,n,f,e=!(!this.childGrid||!this.element.querySelectorAll(".e-childgrid").length),r=this.getContentTable().querySelectorAll(".e-groupcaptionrow, .e-groupfooterrow"),t=0;t<r.length;t++)u=this,n=this.getRowObjectFromUID(r[parseInt(t.toString(),10)].getAttribute("data-uid")),(e&&!n&&i(r[parseInt(t.toString(),10)],"e-childgrid")&&(n=(u=i(r[parseInt(t.toString(),10)],"e-childgrid").ej2_instances[0]).getRowObjectFromUID(r[parseInt(t.toString(),10)].getAttribute("data-uid"))),n)&&(f={cells:n.cells.filter(function(n){return n.isDataCell}),data:n.data,dataUid:n.uid},u.notify(wc,f))},f.prototype.refreshReactHeaderTemplateByUid=function(n){var t,f,e;if(this.isReact)for(var u=this.headerModule.rows,o=this.getNormalizedColumnIndex(n),r=0;r<u.length;r++)t=u[parseInt(r.toString(),10)].cells[parseInt(o.toString(),10)],t&&t.column.uid===n&&(f=new ww(this,this.serviceLocator),e=i(this.element.querySelectorAll("[e-mappinguid="+n+"]")[0],"e-templatecell"),f.refresh(t,e))},f.prototype.setRowData=function(n,r){var f=this.contentModule.getRows(),a=this.getPrimaryKeyFieldNames()[0],u,e,h,c,l;if(this.groupSettings.columns.length>0&&this.aggregates.length>0&&(f=f.filter(function(n){return n.isDataRow})),u=f.filter(function(i){return t.getValue(a,i.data)===n})[0],e=u?[].slice.call(this.element.querySelectorAll("[data-uid="+u.uid+"]")):void 0,!t.isNullOrUndefined(u)&&e.length){if(u.changes=r,this.isFrozenGrid()){var o=i(e[0],"e-table"),s=o.parentElement.matches(".e-frozen-left-header,.e-frozen-left-content")?"left":o.parentElement.matches(".e-frozen-right-header,.e-frozen-right-content")?"right":"movable",v=this.getMovableRowsObject()[u.index];(this.setFrozenRowData(v,r),"left"===s)&&(h=this.getRowsObject()[u.index],this.setFrozenRowData(h,r));("right"===s||this.frozenRightColumns.length>0)&&(c=this.getFrozenRightRowsObject()[u.index],this.setFrozenRowData(c,r))}else this.frozenRows?(l=this.getRowsObject()[u.index],this.setFrozenRowData(l,r)):this.setFrozenRowData(u,r);this.aggregates.length>0&&(this.notify(nu,{}),this.groupSettings.columns.length>0&&this.notify(uu,{}))}},f.prototype.setFrozenRowData=function(n,t){var i=new oi(this.serviceLocator,null,this);n.changes=t;co(n,this.getForeignKeyColumns(),n.changes);i.refresh(n,this.getColumns(),!0)},f.prototype.getCellFromIndex=function(n,t){return yv(this,this.getColumnByIndex(t),n,t)},f.prototype.getMovableCellFromIndex=function(n,t){if(!("Left-Right"===this.frozenName&&t>=this.movableCount)){var i=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableDataRows()[parseInt(n.toString(),10)]&&this.getMovableDataRows()[parseInt(n.toString(),10)].getElementsByClassName(a)[t-i]}},f.prototype.getFrozenRightCellFromIndex=function(n,t){var r=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount(),i=this.getFrozenRightDataRows();return i[parseInt(n.toString(),10)]&&i[parseInt(n.toString(),10)].getElementsByClassName(a)[t-r]},f.prototype.getColumnHeaderByIndex=function(n){return this.getHeaderTable().getElementsByClassName("e-headercell")[parseInt(n.toString(),10)]},f.prototype.getMovableColumnHeaderByIndex=function(n){var t=this.getFrozenColumns()||this.getFrozenLeftColumnsCount();return this.getMovableVirtualHeader().getElementsByClassName("e-headercell")[n-t]},f.prototype.getFrozenRightColumnHeaderByIndex=function(n){var t=this.getFrozenLeftColumnsCount()+this.getMovableColumnsCount();return this.getFrozenRightHeader().getElementsByClassName("e-headercell")[n-t]},f.prototype.getFrozenLeftColumnHeaderByIndex=function(n){return this.getFrozenVirtualHeader().getElementsByClassName("e-headercell")[parseInt(n.toString(),10)]},f.prototype.getRowObjectFromUID=function(n,i,r){var f=this.contentModule.getRows(),u=this.rowObject(f,n);return this.isFrozenGrid()&&(!u||i||r)?((!(u=this.rowObject(this.contentModule.getMovableRows(),n))&&"Left-Right"===this.getFrozenMode()||r)&&(u=this.rowObject(this.contentModule.getFrozenRightRows(),n)),u):t.isNullOrUndefined(u)&&this.enableVirtualization&&this.groupSettings.columns.length>0?u=this.rowObject(this.vRows,n):u},f.prototype.rowObject=function(n,t){var i,r,u;if(n)for(i=0,r=n;i<r.length;i++)if(u=r[i],u.uid===t)return u;return null},f.prototype.getRowsObject=function(){return this.contentModule.getRows()},f.prototype.getMovableRowsObject=function(){var n=[];return this.isFrozenGrid()&&(n=this.contentModule.getMovableRows()),n},f.prototype.getFrozenRightRowsObject=function(){var n=[];return"Right"!==this.getFrozenMode()&&"Left-Right"!==this.getFrozenMode()||(n=this.contentModule.getFrozenRightRows()),n},f.prototype.getColumnHeaderByField=function(n){var t=this.getColumnByField(n);if(t)return this.getColumnHeaderByUid(t.uid)},f.prototype.getColumnHeaderByUid=function(n){var t=this.getHeaderContent().querySelector("[e-mappinguid="+n+"]");if(t)return t.parentElement},f.prototype.getColumnByIndex=function(n){var t;return this.getColumns().some(function(i,r){return t=i,r===n}),t},f.prototype.getColumnByField=function(n){return uf(this.getColumns(),function(t){if(t.field===n)return t})[0]},f.prototype.getColumnIndexByField=function(n){for(var i=this.getColumns(),t=0;t<i.length;t++)if(i[parseInt(t.toString(),10)].field===n)return t;return-1},f.prototype.getColumnByUid=function(n){return uf(this.getColumns().concat(this.getStackedColumns(this.columns)),function(t){if(t.uid===n)return t})[0]},f.prototype.getStackedColumns=function(n,t){var i,u,r;for(void 0===t&&(t=[]),i=0,u=n;i<u.length;i++)r=u[i],r.columns&&(t.push(r),this.getStackedColumns(r.columns,t));return t},f.prototype.getColumnIndexByUid=function(n){var i=uf(this.getColumns(),function(t,i){if(t.uid===n)return i})[0];return t.isNullOrUndefined(i)?-1:i},f.prototype.getUidByColumnField=function(n){return uf(this.getColumns(),function(t){if(t.field===n)return t.uid})[0]},f.prototype.getNormalizedColumnIndex=function(n){return this.getColumnIndexByUid(n)+this.getIndentCount()},f.prototype.getIndentCount=function(){var n=0;return this.allowGrouping&&(n+=this.groupSettings.columns.length),this.isDetail()&&n++,this.isRowDragable()&&t.isNullOrUndefined(this.rowDropSettings.targetID)&&n++,n},f.prototype.getColumnFieldNames=function(){for(var t,i=[],n=0,r=this.getColumns().length;n<r;n++)(t=this.getColumns()[parseInt(n.toString(),10)]).visible&&i.push(t.field);return i},f.prototype.getRowTemplate=function(){return this.rowTemplateFn},f.prototype.getDetailTemplate=function(){return this.detailTemplateFn},f.prototype.getEditTemplate=function(){return this.editTemplateFn},f.prototype.getEditHeaderTemplate=function(){return this.editHeaderTemplateFn},f.prototype.getEditFooterTemplate=function(){return this.editFooterTemplateFn},f.prototype.getPrimaryKeyFieldNames=function(){for(var t=[],n=0;n<this.columnModel.length;n++)this.columnModel[parseInt(n.toString(),10)].isPrimaryKey&&t.push(this.columnModel[parseInt(n.toString(),10)].field);return t},f.prototype.refresh=function(){this.isDestroyed||(this.isManualRefresh=!0,this.headerModule.refreshUI(),this.updateStackedFilter(),this.renderModule.refresh())},f.prototype.refreshHeader=function(){this.headerModule.refreshUI()},f.prototype.getSelectedRows=function(){return this.selectionModule?this.selectionModule.selectedRecords:[]},f.prototype.getSelectedRowIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowIndexes:[]},f.prototype.getSelectedRowCellIndexes=function(){return this.selectionModule?this.selectionModule.selectedRowCellIndexes:[]},f.prototype.getSelectedRecords=function(){return this.selectionModule?this.selectionModule.getSelectedRecords():[]},f.prototype.getSelectedColumnsUid=function(){var t=this,n=[];return this.selectionModule&&this.selectionModule.selectedColumnsIndexes.filter(function(i){return n.push(t.getColumns()[parseInt(i.toString(),10)].uid)}),n},f.prototype.getDataModule=function(){return this.renderModule.data},f.prototype.showColumns=function(n,t){t=t||"headerText";this.showHider.show(n,t)},f.prototype.hideColumns=function(n,t){t=t||"headerText";this.showHider.hide(n,t)},f.prototype.getFrozenColumns=function(){return this.frozenColumns+this.getFrozenCount(this.columns,0,0)},f.prototype.getFrozenRightColumnsCount=function(){return this.frozenRightCount},f.prototype.getFrozenLeftColumnsCount=function(){return this.frozenLeftCount},f.prototype.getMovableColumnsCount=function(){return this.movableCount},f.prototype.setFrozenCount=function(){this.frozenLeftCount=this.frozenRightCount=this.movableCount=0;this.visibleFrozenLeft=this.visibleFrozenRight=this.visibleMovable=0;this.frozenLeftColumns=[];this.frozenRightColumns=[];this.movableColumns=[];this.splitFrozenCount(this.columns);this.frozenColumns&&(this.frozenLeftCount||this.frozenRightCount)&&this.setProperties({frozenColumns:0},!0);this.setTablesCount();this.frozenName=this.frozenLeftCount&&!this.frozenRightCount?"Left":this.frozenRightCount&&!this.frozenLeftCount?"Right":this.frozenLeftCount&&this.frozenRightCount?"Left-Right":this.frozenColumns||this.frozenRows?"Left":void 0},f.prototype.getVisibleFrozenLeftCount=function(){return this.visibleFrozenLeft},f.prototype.getVisibleFrozenRightCount=function(){return this.visibleFrozenRight},f.prototype.getVisibleMovableCount=function(){return this.visibleMovable},f.prototype.getFrozenRightColumns=function(){return this.frozenRightColumns},f.prototype.getFrozenLeftColumns=function(){return this.frozenLeftColumns},f.prototype.getMovableColumns=function(){return this.movableColumns},f.prototype.splitFrozenCount=function(n){for(var t=0;t<n.length;t++)n[parseInt(t.toString(),10)].columns?this.splitFrozenCount(n[parseInt(t.toString(),10)].columns):"Right"===n[parseInt(t.toString(),10)].freeze?(!1!==n[parseInt(t.toString(),10)].visible&&this.visibleFrozenRight++,this.frozenRightColumns.push(n[parseInt(t.toString(),10)]),this.frozenRightCount++):"Left"===n[parseInt(t.toString(),10)].freeze?(!1!==n[parseInt(t.toString(),10)].visible&&this.visibleFrozenLeft++,this.frozenLeftColumns.push(n[parseInt(t.toString(),10)]),this.frozenLeftCount++):(!1!==n[parseInt(t.toString(),10)].visible&&this.visibleMovable++,this.movableColumns.push(n[parseInt(t.toString(),10)]),this.movableCount++)},f.prototype.getVisibleFrozenColumns=function(){return this.getVisibleFrozenColumnsCount()+this.getVisibleFrozenCount(this.columns,0)},f.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},f.prototype.getVisibleFrozenColumnsCount=function(){for(var i=0,t=this.columnModel,n=0;n<this.frozenColumns;n++)t[parseInt(n.toString(),10)].visible&&i++;if(this.frozenLeftCount||this.frozenRightCount)for(n=0;n<t.length;n++)t[parseInt(n.toString(),10)].visible&&("Left"===t[parseInt(n.toString(),10)].freeze||"Right"===t[parseInt(n.toString(),10)].freeze)&&i++;return i},f.prototype.getVisibleFrozenCount=function(n,t){if(!this.frozenLeftCount&&!this.frozenRightCount)for(var i=0,r=n.length;i<r;i++)n[parseInt(i.toString(),10)].columns?t=this.getVisibleFrozenCount(n[parseInt(i.toString(),10)].columns,t):n[parseInt(i.toString(),10)].isFrozen&&n[parseInt(i.toString(),10)].visible&&t++;return t},f.prototype.getFrozenCount=function(n,t,i){for(var r=0,u=n.length;r<u;r++)n[parseInt(r.toString(),10)].columns?t=this.getFrozenCount(n[parseInt(r.toString(),10)].columns,t,i):(n[parseInt(r.toString(),10)].isFrozen&&i>this.frozenColumns-1&&t++,i++);return t},f.prototype.goToPage=function(n){this.pagerModule&&this.pagerModule.goToPage(n)},f.prototype.updateExternalMessage=function(n){this.pagerModule&&this.pagerModule.updateExternalMessage(n)},f.prototype.sortColumn=function(n,t,i){this.sortModule&&this.sortModule.sortColumn(n,t,i)},f.prototype.changeDataSource=function(n,i){this.setProperties({sortSettings:{columns:[]}},!0);this.setProperties({filterSettings:{columns:[]}},!0);this.setProperties({searchSettings:{key:""}},!0);this.allowGrouping&&this.setProperties({groupSettings:{columns:[]}},!0);i&&i.length&&this.setProperties({columns:i},!0);n&&(t.isNullOrUndefined(i)&&this.setProperties({columns:[]},!0),this.setProperties({dataSource:n},!0));this.freezeRefresh()},f.prototype.clearSorting=function(){this.sortModule&&this.sortModule.clearSorting()},f.prototype.removeSortColumn=function(n){this.sortModule&&this.sortModule.removeSortColumn(n)},f.prototype.clearGridActions=function(){this.setProperties({sortSettings:{columns:[]}},!0);this.setProperties({filterSettings:{columns:[]}},!0);this.setProperties({searchSettings:{key:""}},!0);this.allowGrouping?this.setProperties({groupSettings:{columns:[]}},!1):this.freezeRefresh()},f.prototype.filterByColumn=function(n,t,i,r,u,f,e,o){this.filterModule&&this.filterModule.filterByColumn(n,t,i,r,u,f,e,o)},f.prototype.clearFiltering=function(n){this.filterModule&&this.filterModule.clearFiltering(n)},f.prototype.removeFilteredColsByField=function(n,t){this.filterModule&&this.filterModule.removeFilteredColsByField(n,t)},f.prototype.selectRow=function(n,t){this.selectionModule&&this.selectionModule.selectRow(n,t)},f.prototype.selectRows=function(n){this.selectionModule&&this.selectionModule.selectRows(n)},f.prototype.clearSelection=function(){this.selectionModule&&this.selectionModule.clearSelection()},f.prototype.selectCell=function(n,t){this.selectionModule&&this.selectionModule.selectCell(n,t)},f.prototype.selectCellsByRange=function(n,t){this.selectionModule.selectCellsByRange(n,t)},f.prototype.search=function(n){this.searchModule&&this.searchModule.search(n)},f.prototype.print=function(){this.printModule&&this.printModule.print()},f.prototype.deleteRecord=function(n,t){this.editModule&&this.editModule.deleteRecord(n,t)},f.prototype.startEdit=function(){this.editModule&&this.editModule.startEdit()},f.prototype.endEdit=function(){this.editModule&&this.editModule.endEdit()},f.prototype.closeEdit=function(){this.editModule&&this.editModule.closeEdit()},f.prototype.addRecord=function(n,t){this.editModule&&this.editModule.addRecord(n,t)},f.prototype.deleteRow=function(n){this.editModule&&this.editModule.deleteRow(n)},f.prototype.editCell=function(n,t){this.editModule&&this.editModule.editCell(n,t)},f.prototype.saveCell=function(){this.editModule&&this.editModule.saveCell()},f.prototype.updateCell=function(n,t,i){this.editModule&&this.editModule.updateCell(n,t,i)},f.prototype.updateRow=function(n,t){this.editModule&&this.editModule.updateRow(n,t)},f.prototype.getBatchChanges=function(){return this.editModule?this.editModule.getBatchChanges():{}},f.prototype.enableToolbarItems=function(n,t){this.toolbarModule&&this.toolbarModule.enableItems(n,t)},f.prototype.copy=function(n){this.clipboardModule&&this.clipboardModule.copy(n)},f.prototype.recalcIndentWidth=function(){var r=this;if(this.getHeaderTable().querySelector(".e-emptycell")&&(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&!this.getHeaderTable().querySelector(".e-emptycell").getAttribute("indentRefreshed")&&this.getContentTable()){var n=this.getHeaderTable().querySelector(".e-emptycell").parentElement.offsetWidth,u=[].slice.call(this.getHeaderTable().querySelector(c).childNodes),f=[].slice.call(this.getContentTable().querySelector(c).childNodes),e=n/30,t="Right"===this.getFrozenMode()?this.frozenRightCount:0,o=this.element.offsetWidth,i=function(n,t){if(av(r)){var i=(t/o*100).toFixed(1)+"%";u[parseInt(n.toString(),10)].style.width=i;f[parseInt(n.toString(),10)].style.width=i}else u[parseInt(n.toString(),10)].style.width=t+"px",f[parseInt(n.toString(),10)].style.width=t+"px";r.notify(ae,{index:n,width:t})};for(e>=1&&(n=30/e),n<1&&(n=1),(this.enableColumnVirtualization||this.isAutoGen||this.columns.length===this.groupSettings.columns.length)&&(n=30);t<this.groupSettings.columns.length;)i(t,n),t++;this.isDetail()&&(i(t,n),t++);this.isRowDragable()&&i(t,n);this.isAutoGen=!1;this.getHeaderTable().querySelector(".e-emptycell").setAttribute("indentRefreshed","true")}},f.prototype.resetIndentWidth=function(){if(av(this)&&(this.getHeaderTable().querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.widthService.setWidthToColumns(),this.recalcIndentWidth(),this.autoFit&&this.preventAdjustColumns()),("auto"===this.width||"string"==typeof this.width&&-1!==this.width.indexOf("%"))&&this.getColumns().filter(function(n){return(!n.width||"auto"===n.width)&&n.minWidth}).length>0){var n=this.widthService.getTableWidth(this.getColumns());this.widthService.setMinwidthBycalculation(n)}this.isFrozenGrid()&&this.widthService&&this.widthService.refreshFrozenScrollbar();this.allowTextWrap&&"Content"!==this.textWrapSettings.wrapMode&&this.notify(to,{})},f.prototype.isRowDragable=function(){return this.allowRowDragAndDrop&&!this.rowDropSettings.targetID},f.prototype.reorderColumns=function(n,t){this.reorderModule&&this.reorderModule.reorderColumns(n,t)},f.prototype.reorderColumnByIndex=function(n,t){this.reorderModule&&this.reorderModule.reorderColumnByIndex(n,t)},f.prototype.reorderColumnByTargetIndex=function(n,t){this.reorderModule&&this.reorderModule.reorderColumnByTargetIndex(n,t)},f.prototype.reorderRows=function(n,t){this.rowDragAndDropModule&&this.rowDragAndDropModule.reorderRows(n,t)},f.prototype.refreshDataSource=function(n){this.notify("refreshdataSource",n)},f.prototype.disableRowDD=function(n){var f=this.getHeaderTable(),o=this.getContentTable(),s=f.querySelectorAll("th.e-rowdragheader, th.e-mastercell"),h=this.getRows(),e=n?"none":"",r,i,u;for(t.setStyleAttribute(f.querySelector(c).childNodes[0],{display:e}),t.setStyleAttribute(o.querySelector(c).childNodes[0],{display:e}),r=0;r<this.getRows().length;r++)i=h[parseInt(r.toString(),10)].firstElementChild,n?t.addClass([i],"e-hide"):t.removeClass([i],["e-hide"]);for(u=0;u<f.querySelectorAll("th.e-rowdragheader, th.e-mastercell").length;u++)i=s[parseInt(u.toString(),10)],n?t.addClass([i],"e-hide"):t.removeClass([i],["e-hide"])},f.prototype.autoFitColumns=function(n){this.resizeModule&&this.resizeModule.autoFitColumns(n)},f.prototype.preventAdjustColumns=function(){var o;if(!(this.isFrozenGrid()||this.enableAdaptiveUI&&"Vertical"===this.rowRenderingMode||this.allowResizing&&"Auto"===this.resizeSettings.mode)){for(var r=this.getColumns(),u=this.getHeaderTable(),i=0,n=0;n<r.length;n++)if(r[parseInt(n.toString(),10)].visible){if(this.groupSettings.columns.length&&this.groupSettings.columns.indexOf(r[parseInt(n.toString(),10)].field)>-1&&"none"===[].slice.call(u.querySelector("colgroup").querySelectorAll(":not(.e-group-intent):not(.e-detail-intent):not(.e-drag-intent)"))[parseInt(n.toString(),10)].style.display)continue;if(!r[parseInt(n.toString(),10)].width){i=0;break}i+=parseFloat(r[parseInt(n.toString(),10)].width.toString())}if(i){var f=this.isPercentageWidthGrid(),s=this.widthUnit(f),e=this.getContentTable();if(this.groupSettings.columns.length||this.isDetail()||this.isRowDragable()){var h=this.defaultIndentWidth(f),c=h.toString()+s,l=[].slice.call(u.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent")),a=[].slice.call(e.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent"));for(n=0;n<l.length;n++)l[parseInt(n.toString(),10)].style.setProperty("width",c),a[parseInt(n.toString(),10)].style.setProperty("width",c),i+=h}(f&&i<100||!f&&i<e.parentElement.clientWidth)&&t.addClass([u,e],["e-tableborder"]);o=i.toString()+s;u.style.setProperty("width",o);e.style.setProperty("width",o)}else this.restoreAdjustColumns()}},f.prototype.restoreAdjustColumns=function(){var n,i,r,u;this.isFrozenGrid()||this.enableAdaptiveUI&&"Vertical"===this.rowRenderingMode||this.allowResizing&&"Auto"===this.resizeSettings.mode||(n=this.getHeaderTable(),i=this.getContentTable(),(t.removeClass([n,i],["e-tableborder"]),n.style.removeProperty("width"),i.style.removeProperty("width"),this.groupSettings.columns.length||this.isDetail()||this.isRowDragable())&&(r=this.isPercentageWidthGrid(),u=this.defaultIndentWidth(r).toString()+this.widthUnit(r),[].slice.call(n.querySelector("colgroup").querySelectorAll(".e-group-intent, .e-detail-intent, .e-drag-intent")).forEach(function(n){n.style.setProperty("width",u)}),n.querySelector(".e-emptycell").removeAttribute("indentRefreshed"),this.recalcIndentWidth()))},f.prototype.widthUnit=function(n){return n?"%":"px"},f.prototype.defaultIndentWidth=function(n){return n?parseFloat((3e3/this.element.offsetWidth).toFixed(1)):30},f.prototype.isPercentageWidthGrid=function(){return this.getColumns()[0].width.toString().indexOf("%")>-1},f.prototype.createColumnchooser=function(n,t,i){this.columnChooserModule&&this.columnChooserModule.renderColumnChooser(n,t,i)},f.prototype.initializeServices=function(){this.serviceLocator.register("widthService",this.widthService=new dw(this));this.serviceLocator.register("cellRendererFactory",new uit);this.serviceLocator.register("rendererFactory",new sst);this.serviceLocator.register("localization",this.localeObj=new t.L10n(this.getModuleName(),this.defaultLocale,this.locale));this.serviceLocator.register("valueFormatter",this.valueFormatterService=new wu(this.locale));this.serviceLocator.register("showHideService",this.showHider=new dst(this));this.serviceLocator.register("ariaService",this.ariaService=new oh);this.serviceLocator.register("focus",this.focusModule=new hst(this))},f.prototype.processModel=function(){var e,f,n=this.groupSettings.columns,i=this.sortSettings.columns,o;if(this.allowGrouping)for(var s=function(t){var o,u;for(f=0,o=i.length;f<o;f++)if(i[parseInt(f.toString(),10)].field===n[parseInt(t.toString(),10)]){e=!0;break}(e?r.allowSorting?r.sortedColumns.push(i[parseInt(f.toString(),10)].field):i[parseInt(f.toString(),10)].direction="Ascending":i.push({field:n[parseInt(t.toString(),10)],direction:"Ascending",isFromGroup:!0}),r.groupSettings.showGroupedColumn)||(u=r.enableColumnVirtualization?r.columns.filter(function(i){return i.field===n[parseInt(t.toString(),10)]})[0]:r.getColumnByField(n[parseInt(t.toString(),10)]),u?u.visible=!1:r.log("initial_action",{moduleName:"group",columnName:n[parseInt(t.toString(),10)]}))},r=this,u=0,h=n.length;u<h;u++)s(u);if(!n.length)for(u=0;u<i.length;u++)this.sortedColumns.push(i[parseInt(u.toString(),10)].field);(this.rowTemplateFn=ri(this.rowTemplate),this.detailTemplateFn=ri(this.detailTemplate),this.editTemplateFn=ri(this.editSettings.template),this.editHeaderTemplateFn=ri(this.editSettings.headerTemplate),this.editFooterTemplateFn=ri(this.editSettings.footerTemplate),t.isNullOrUndefined(this.parentDetails))||(o=t.isNullOrUndefined(this.parentDetails.parentKeyFieldValue)?"undefined":this.parentDetails.parentKeyFieldValue,this.query.where(this.queryString,"equal",o,!0));this.initForeignColumn()},f.prototype.initForeignColumn=function(){this.isForeignKeyEnabled(this.getColumns())&&this.notify(rl,this.getForeignKeyColumns())},f.prototype.enableVerticalRendering=function(){"Vertical"===this.rowRenderingMode?this.element.classList.add("e-row-responsive"):this.element.classList.remove("e-row-responsive")},f.prototype.gridRender=function(){this.updateRTL();"Vertical"===this.rowRenderingMode&&this.element.classList.add("e-row-responsive");this.enableHover&&this.element.classList.add("e-gridhover");t.Browser.isDevice&&this.element.classList.add("e-device");this.rowHeight&&this.element.classList.add("e-grid-min-height");this.cssClass&&this.element.classList.add(this.cssClass);this.allowRowDragAndDrop&&this.rowDropSettings.targetID&&"mozilla"===t.Browser.info.name&&this.element.classList.add("e-disableuserselect");t.classList(this.element,["e-responsive","e-default"],[]);var n=this.serviceLocator.getService("rendererFactory");this.headerModule=n.getRenderer(at.Header);this.contentModule=n.getRenderer(at.Content);this.printModule=new iv(this,this.scrollModule);this.clipboardModule=new lit(this,this.serviceLocator);this.renderModule.render();this.eventInitializer();this.createGridPopUpElement();this.widthService.setWidthToColumns();this.updateGridLines();this.applyTextWrap();this.createTooltip();this.enableBoxSelection()},f.prototype.dataReady=function(){this.scrollModule.setWidth();this.scrollModule.setHeight();"auto"!==this.height&&this.scrollModule.setPadding()},f.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},f.prototype.createGridPopUpElement=function(){var n=this.createElement("div",{className:"e-gridpopup",styles:"display:none;"}),i=this.createElement("div",{className:ft,attrs:{tabIndex:"-1"}});t.append([i,this.createElement("div",{className:"e-uptail e-tail"})],n);i.appendChild(this.createElement("span"));t.append([i,this.createElement("div",{className:"e-downtail e-tail"})],n);this.element.appendChild(n)},f.prototype.updateGridLines=function(){switch(t.classList(this.element,[],["e-verticallines","e-horizontallines","e-hidelines","e-bothlines"]),this.gridLines){case"Horizontal":this.element.classList.add("e-horizontallines");break;case"Vertical":this.element.classList.add("e-verticallines");break;case"None":this.element.classList.add("e-hidelines");break;case"Both":this.element.classList.add("e-bothlines")}this.updateResizeLines()},f.prototype.updateResizeLines=function(){this.allowResizing&&"Vertical"!==this.gridLines&&"Both"!==this.gridLines?this.element.classList.add("e-resize-lines"):this.element.classList.remove("e-resize-lines")},f.prototype.applyTextWrap=function(){if(this.allowTextWrap){var n=[].slice.call(this.element.getElementsByClassName("e-columnheader"));switch(this.textWrapSettings.wrapMode){case"Header":li(this.element,!1);li(this.getContent(),!1);li(n,!0);break;case"Content":li(this.getContent(),!0);li(this.element,!1);li(n,!1);break;default:li(this.element,!0);li(this.getContent(),!1);li(n,!1)}"Content"!==this.textWrapSettings.wrapMode&&this.notify(to,{})}},f.prototype.removeTextWrap=function(){li(this.element,!1);li([].slice.call(this.element.getElementsByClassName("e-columnheader")),!1);li(this.getContent(),!1);"Content"!==this.textWrapSettings.wrapMode&&this.notify(to,{})},f.prototype.createTooltip=function(){this.toolTipObj=new bt.Tooltip({opensOn:"custom",content:"",cssClass:this.cssClass?this.cssClass:null},this.element)},f.prototype.freezeRefresh=function(){this.isFreezeRefresh=!0;(this.enableVirtualization||this.enableInfiniteScrolling)&&(this.pageSettings.currentPage=1);this.componentRefresh()},f.prototype.getTooltipStatus=function(n){var r=this.getHeaderTable(),u="e-gridheader",f=this.createTable(r,u,"header"),e=this.createTable(r,u,"content"),t=n.classList.contains("e-headercell")?f:e,i=n.classList.contains("e-headercell")?"th":"tr",o;return t.querySelector(i).className=n.className,t.querySelector(i).innerHTML=n.innerHTML,o=t.querySelector(i).getBoundingClientRect().width,document.body.removeChild(f),document.body.removeChild(e),o>n.getBoundingClientRect().width},f.prototype.mouseMoveHandler=function(n){var r,f,s;if(this.isEllipsisTooltip()&&(r=i(n.target,"e-ellipsistooltip"),this.prevElement===r&&"mouseout"!==n.type||this.toolTipObj.close(),f=n.target.tagName,r&&"mouseout"!==n.type&&(!t.Browser.isDevice||-1===["A","BUTTON","INPUT"].indexOf(f)))){if(r.getAttribute("data-tooltip-id"))return;if(this.getTooltipStatus(r)){var e=this.getColumns()[parseInt(r.getAttribute(lt),10)],o=e.disableHtmlEncode?"innerText":"innerHTML",u=this.createElement("div");r.getElementsByClassName("e-headertext").length?(s=r.getElementsByClassName("e-headertext")[0],u[""+o]=this.sanitize(s.innerText),this.toolTipObj.content=u):(u[""+o]=this.sanitize(r.innerText),this.toolTipObj.content=u);this.prevElement=r;this.enableHtmlSanitizer&&(this.toolTipObj.enableHtmlSanitizer=!0);e.disableHtmlEncode&&(this.toolTipObj.enableHtmlParse=!1);this.toolTipObj.open(r)}}this.hoverFrozenRows(n)},f.prototype.hoverFrozenRows=function(n){var u,r,t;if(this.isFrozenGrid())if(u=i(n.target,y),[].slice.call(this.element.getElementsByClassName("e-frozenhover")).length&&"mouseout"===n.type)for(r=[].slice.call(this.element.getElementsByClassName("e-frozenhover")),t=0;t<r.length;t++)r[parseInt(t.toString(),10)].classList.remove("e-frozenhover");else if(u)for((r=[].slice.call(this.element.querySelectorAll('tr[data-rowindex="'+u.getAttribute(h)+'"]'))).splice(r.indexOf(u),1),t=0;t<r.length;t++)"true"!==u.getAttribute("aria-selected")&&r[parseInt(t.toString(),10)]?r[parseInt(t.toString(),10)].classList.add("e-frozenhover"):r[parseInt(t.toString(),10)]&&r[parseInt(t.toString(),10)].classList.remove("e-frozenhover")},f.prototype.isEllipsisTooltip=function(){var t=this.getColumns(),n;if("EllipsisWithTooltip"===this.clipMode)return!0;for(n=0;n<t.length;n++)if("EllipsisWithTooltip"===t[parseInt(n.toString(),10)].clipMode)return!0;return!1},f.prototype.scrollHandler=function(){this.isEllipsisTooltip()&&this.toolTipObj.close()},f.prototype.createTable=function(n,t,i){var r=this.createElement("div"),f,u;r.className=this.element.className;r.style.cssText="display: inline-block;visibility:hidden;position:absolute";f=this.createElement("div");f.className=t;u=this.createElement("table",{attrs:{role:"grid"}});u.className=n.className;u.style.cssText="table-layout: auto;width: auto";var o="header"===i?"th":"td",e=this.createElement("tr"),s=this.createElement(o);return e.appendChild(s),u.appendChild(e),f.appendChild(u),r.appendChild(f),document.body.appendChild(r),r},f.prototype.onKeyPressed=function(n){"tab"!==n.action&&"shiftTab"!==n.action||this.toolTipObj.close()},f.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.mouseClickHandler,this);t.EventHandler.add(this.element,"touchend",this.mouseClickHandler,this);t.EventHandler.add(this.element,"focusout",this.focusOutHandler,this);t.EventHandler.add(this.element,"dblclick",this.dblClickHandler,this);t.EventHandler.add(this.element,"keydown",this.keyPressHandler,this);t.EventHandler.add(window,"resize",this.resetIndentWidth,this);this.allowKeyboard&&(this.element.tabIndex=-1===this.element.tabIndex?0:this.element.tabIndex);this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});t.EventHandler.add(this.getContent().firstElementChild,"scroll",this.scrollHandler,this);t.EventHandler.add(this.element,"mousemove",this.mouseMoveHandler,this);t.EventHandler.add(this.element,"mouseout",this.mouseMoveHandler,this);t.EventHandler.add(this.getContent(),"touchstart",this.tapEvent,this);t.EventHandler.add(document.body,"keydown",this.keyDownHandler,this)},f.prototype.unwireEvents=function(){t.EventHandler.remove(this.element,"click",this.mouseClickHandler);t.EventHandler.remove(this.element,"touchend",this.mouseClickHandler);t.EventHandler.remove(this.element,"focusout",this.focusOutHandler);t.EventHandler.remove(this.element,"dblclick",this.dblClickHandler);t.EventHandler.remove(this.getContent().firstElementChild,"scroll",this.scrollHandler);t.EventHandler.remove(this.element,"mousemove",this.mouseMoveHandler);t.EventHandler.remove(this.element,"mouseout",this.mouseMoveHandler);t.EventHandler.remove(this.element,"keydown",this.keyPressHandler);t.EventHandler.remove(this.getContent(),"touchstart",this.tapEvent);t.EventHandler.remove(document.body,"keydown",this.keyDownHandler);t.EventHandler.remove(window,"resize",this.resetIndentWidth)},f.prototype.addListener=function(){this.isDestroyed||(this.on(ki,this.dataReady,this),this.on(it,this.recalcIndentWidth,this),this.on(yt,this.recalcIndentWidth,this),this.dataBoundFunction=this.refreshMediaCol.bind(this),this.addEventListener(ti,this.dataBoundFunction),this.on(ht,this.onKeyPressed,this))},f.prototype.removeListener=function(){this.isDestroyed||(this.off(ki,this.dataReady),this.off(it,this.recalcIndentWidth),this.off(yt,this.recalcIndentWidth),this.removeEventListener(ti,this.dataBoundFunction),this.off(ht,this.onKeyPressed))},f.prototype.getCurrentViewRecords=function(){return et(this)?t.isNullOrUndefined(this.currentViewData.records)?this.currentViewData:this.currentViewData.records:this.groupSettings.enableLazyLoading?this.currentViewData:this.allowGrouping&&this.groupSettings.columns.length&&this.currentViewData.length&&this.currentViewData.records?this.currentViewData.records:this.currentViewData},f.prototype.mouseClickHandler=function(n){var u,f,r,e;this.isChildGrid(n)||i(n.target,"e-gridpopup")&&n.touches||this.element.getElementsByClassName("e-cloneproperties").length||this.checkEdit(n)||(!this.allowRowDragAndDrop&&(i(n.target,ot)||"TD"===n.target.tagName)||!this.allowGrouping&&!this.allowReordering&&i(n.target,"e-gridheader"))&&n.touches||(i(n.target,"e-gridheader")&&this.allowRowDragAndDrop&&!i(n.target,"e-filterbarcell")&&n.target&&-1===["A","BUTTON","INPUT"].indexOf(n.target.tagName)&&n.preventDefault(),u=this.getRowInfo(n.target),u.cancel=!1,f=!1,r=t.closest(n.target,"tr"),r&&r.getAttribute("data-uid")&&(e=this.getRowObjectFromUID(r.getAttribute("data-uid")),f=!!e&&e.isDataRow),f&&this.trigger(ng,u),this.notify(ii,n))},f.prototype.checkEdit=function(n){var t=i(n.target,y),r="Batch"!==this.editSettings.mode&&this.isEdit&&t&&(t.classList.contains(ni)||t.classList.contains(ui));return!i(n.target,"e-unboundcelldiv")&&(r||i(n.target,a)&&i(n.target,a).classList.contains("e-editedbatchcell"))},f.prototype.dblClickHandler=function(n){var o=i(n.target,"e-grid"),u,r,f,e;t.isNullOrUndefined(o)||o.id!==this.element.id||t.closest(n.target,".e-unboundcelldiv")||(u=!1,r=t.closest(n.target,"tr"),r&&r.getAttribute("data-uid")&&(f=this.getRowObjectFromUID(r.getAttribute("data-uid")),u=!!f&&f.isDataRow),e=this.getRowInfo(n.target),e.target=n.target,u&&this.trigger(gd,e),this.notify(ye,n))},f.prototype.focusOutHandler=function(n){var u,r,f;this.isChildGrid(n)||(i(n.target,"e-grid")||(this.element.querySelector(".e-gridpopup").style.display="None"),u=this.element.querySelector(".e-cancel:not(.e-hide)"),u&&!u.parentElement.classList.contains("e-tbar-btn")&&u.classList.add("e-hide"),r=n.relatedTarget,f=r?r.getAttribute("aria-owns"):null,r&&(i(r,"e-grid")||(!t.isNullOrUndefined(f)&&f)===n.target.getAttribute("aria-owns"))||this.keyPress||!this.isEdit||t.Browser.isDevice||("Batch"!==this.editSettings.mode||(i(r,"e-ddl")||i(r,"e-ddt"))&&i(r,"e-input-group")||t.isNullOrUndefined(i(r,"e-input-group"))||(this.editModule.saveCell(),this.notify(cs,{})),"Normal"===this.editSettings.mode&&this.editModule.editFormValidate()),this.keyPress=!1)},f.prototype.isChildGrid=function(n){var r=i(n.target,"e-grid");return!!(r&&r.id!==this.element.id||i(n.target,"e-unboundcelldiv")&&t.isNullOrUndefined(r))},f.prototype.mergePersistGridData=function(n){var f=this.getLocalData(),r,o,u,e,i;if(!t.isNullOrUndefined(f)&&""!==f||!t.isNullOrUndefined(n)){for(r=t.isNullOrUndefined(n)?JSON.parse(f):n,this.enableVirtualization&&r.pageSettings&&(r.pageSettings.currentPage=1),o=Object.keys(r),this.isProtectedOnChange=!0,u=0,e=o;u<e.length;u++)i=e[u],"object"!=typeof this[""+i]||t.isNullOrUndefined(this[""+i])?this[""+i]=r[""+i]:Array.isArray(this[""+i])&&"columns"===i?(ch(this[""+i]),this.mergeColumns(r[""+i],this[""+i]),this[""+i]=r[""+i]):t.extend(this[""+i],r[""+i]);this.isProtectedOnChange=!1}},f.prototype.mergeColumns=function(n,i){for(var r=n,f=function(n){var u=i.filter(function(t){return t.index===r[parseInt(n.toString(),10)].index})[0];t.isNullOrUndefined(u)||(u.columns&&u.columns.length?(e.mergeColumns(r[parseInt(n.toString(),10)].columns,u.columns),r[parseInt(n.toString(),10)]=t.extend(u,r[parseInt(n.toString(),10)],{},!0)):r[parseInt(n.toString(),10)]=t.extend(u,r[parseInt(n.toString(),10)],{},!0))},e=this,u=0;u<r.length;u++)f(u)},f.prototype.isDetail=function(){return!t.isNullOrUndefined(this.detailTemplate)||!t.isNullOrUndefined(this.childGrid)},f.prototype.isCommandColumn=function(n){var t=this;return n.some(function(n){return n.columns?t.isCommandColumn(n.columns):!(!n.commands&&!n.commandsTemplate)})},f.prototype.isForeignKeyEnabled=function(n){var t=this;return n.some(function(n){return n.columns?t.isForeignKeyEnabled(n.columns):!(!n.dataSource||!n.foreignKeyValue)})},f.prototype.keyPressHandler=function(n){var i=t.extend(n,{cancel:!1});this.trigger("keyPressed",i);!0===i.cancel&&n.stopImmediatePropagation()},f.prototype.keyDownHandler=function(n){if(n.altKey){if(74===n.keyCode&&(this.keyA?(this.notify(gl,{target:n.target,collapse:!1}),this.keyA=!1):(this.focusModule&&this.focusModule.currentInfo&&this.focusModule.currentInfo.element&&(t.removeClass([this.focusModule.currentInfo.element,this.focusModule.currentInfo.elementToFocus],["e-focused","e-focus"]),this.focusModule.currentInfo.element.tabIndex=-1),this.element.classList.contains("e-childgrid")||this.element.focus())),87===n.keyCode){var i=this.focusModule;if(i){if(!this.currentViewData.length)return;i.focusContent();i.addOutline()}}65===n.keyCode&&(this.keyA=!0);72===n.keyCode&&this.keyA&&(this.notify(gl,{target:n.target,collapse:!0}),this.keyA=!1)}13===n.keyCode&&this.notify(ks,n)},f.prototype.keyActionHandler=function(n){this.isChildGrid(n)||this.isEdit&&"escape"!==n.action&&"enter"!==n.action&&"shiftEnter"!==n.action&&"tab"!==n.action&&"shiftTab"!==n.action||(this.keyPress=!0,this.allowKeyboard&&("ctrlPlusP"===n.action&&(n.preventDefault(),this.print()),this.notify(ht,n)))},f.prototype.setInjectedModules=function(n){this.injectedModules=n},f.prototype.updateColumnObject=function(){ee(this.columns,this.enableColumnVirtualization,this);ch(this.columns);this.initForeignColumn();this.notify(gu,{})},f.prototype.getForeignKeyColumns=function(){return this.getColumns().filter(function(n){return n.isForeignColumn()})},f.prototype.getRowHeight=function(){return this.rowHeight?this.rowHeight:hrt(this.element)},f.prototype.refreshColumns=function(){var i,o,r,s,u;this.setFrozenCount();var n=this.getContent().querySelector(".e-frozen-left-content"),f=this.getContent().querySelector(".e-frozen-right-content"),h=!this.frozenRightCount&&!this.frozenLeftCount;0===this.getFrozenColumns()&&(!n&&this.frozenLeftCount||!f&&this.frozenRightCount||n&&!this.frozenLeftCount||f&&!this.frozenRightCount)?(this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh()):h&&(1===this.getFrozenColumns()&&!n||0===this.getFrozenColumns()&&n)?(this.tableIndex=0,this.tablesCount=1,this.enableColumnVirtualization&&(this.columnModel=[],this.updateColumnModel(this.columns)),this.freezeRefresh()):(this.isPreventScrollEvent=!0,this.updateColumnObject(),this.checkLockColumns(this.getColumns()),this.refresh(),this.isFrozenGrid())&&(i=this.contentModule.getMovableContent().querySelector("."+k),t.remove(i.querySelector(c)),o=this.getHeaderContent().querySelector("."+w).querySelector(c).cloneNode(!0),(i.insertBefore(o,i.querySelector(e)),"Left-Right"===this.getFrozenMode())&&(r=this.contentModule.getFrozenRightContent().querySelector("."+k),t.remove(r.querySelector(c)),s=this.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c).cloneNode(!0),r.insertBefore(s,r.querySelector(e))));this.isFrozenGrid()&&(u=this.getContent().querySelector(".e-movablescrollbar").scrollLeft,this.headerModule.getMovableHeader().scrollLeft=u,this.contentModule.getMovableContent().scrollLeft=u)},f.prototype.excelExport=function(n,t,i,r){return this.excelExportModule?this.excelExportModule.Map(this,n,t,i,!1,r):null},f.prototype.csvExport=function(n,t,i,r){return this.excelExportModule?this.excelExportModule.Map(this,n,t,i,!0,r):null},f.prototype.pdfExport=function(n,t,i,r){return this.pdfExportModule?this.pdfExportModule.Map(this,n,t,i,r):null},f.prototype.groupColumn=function(n){this.groupModule&&this.groupModule.groupColumn(n)},f.prototype.groupExpandAll=function(){this.groupModule&&this.groupModule.expandAll()},f.prototype.groupCollapseAll=function(){this.groupModule&&this.groupModule.collapseAll()},f.prototype.clearGrouping=function(){this.groupModule&&this.groupModule.clearGrouping()},f.prototype.ungroupColumn=function(n){this.groupModule&&this.groupModule.ungroupColumn(n)},f.prototype.openColumnChooser=function(n,t){this.columnChooserModule&&this.columnChooserModule.openColumnChooser(n,t)},f.prototype.scrollRefresh=function(){var n=this,t=function(){n.scrollModule.refresh();n.off(it,t)};this.on(it,t,this)},f.prototype.detailCollapseAll=function(){this.detailRowModule&&this.detailRowModule.collapseAll()},f.prototype.detailExpandAll=function(){this.detailRowModule&&this.detailRowModule.expandAll()},f.prototype.clearCellSelection=function(){this.selectionModule&&this.selectionModule.clearCellSelection()},f.prototype.clearRowSelection=function(){this.selectionModule&&this.selectionModule.clearRowSelection()},f.prototype.selectCells=function(n){this.selectionModule&&this.selectionModule.selectCells(n)},f.prototype.selectRowsByRange=function(n,t){this.selectionModule&&this.selectionModule.selectRowsByRange(n,t)},f.prototype.isContextMenuOpen=function(){return this.contextMenuModule&&this.contextMenuModule.isOpen},f.prototype.ensureModuleInjected=function(n){return this.getInjectedModules().indexOf(n)>=0},f.prototype.destroyTemplate=function(n,t){this.clearTemplate(n,t)},f.prototype.log=function(n,t){this.loggerModule&&this.loggerModule.log(n,t)},f.prototype.applyBiggerTheme=function(n){this.element.classList.contains("e-bigger")&&n.classList.add("e-bigger")},f.prototype.getPreviousRowData=function(){return this.getRowsObject()[this.getRows().length-1].data},f.prototype.hideScroll=function(){var n=this.getContent().querySelector("."+ft),t=this.getContent().querySelector(".e-scrollbar"),i,r;(n.scrollHeight<=n.clientHeight&&(this.scrollModule.removePadding(),n.style.overflowY="auto"),this.isFrozenGrid()&&t)&&(i=this.getContent().querySelector(".e-movablescrollbar"),r=this.getContent().querySelector(".e-movablechild"),t.style.display="flex",i.offsetWidth>=r.offsetWidth&&(t.style.display="none",this.notify(ke,0)))},f.prototype.getRowIndexByPrimaryKey=function(n){var r=this.getPrimaryKeyFieldNames()[0],i,t,u;for(n="object"==typeof n?n[""+r]:n,i=this.getRowsObject(),t=0;t<i.length;t++)if(!i[parseInt(t.toString(),10)].isDetailRow&&!i[parseInt(t.toString(),10)].isCaptionRow&&(u=i[parseInt(t.toString(),10)].data[""+r],r.split(".").length>1&&(u=pv(r,i[parseInt(t.toString(),10)].data)),u===n))return i[parseInt(t.toString(),10)].index;return-1},f.prototype.grabColumnByFieldFromAllCols=function(n){var r,i,t;for(this.columnModel=[],this.updateColumnModel(this.columns),i=this.columnModel,t=0;t<i.length;t++)(n===i[parseInt(t.toString(),10)].field||i[parseInt(t.toString(),10)].isForeignColumn()&&n===i[parseInt(t.toString(),10)].foreignKeyValue)&&(r=i[parseInt(t.toString(),10)]);return r},f.prototype.grabColumnByUidFromAllCols=function(n){var r,i,t;for(this.columnModel=[],this.updateColumnModel(this.columns),i=this.columnModel,t=0;t<i.length;t++)n===i[parseInt(t.toString(),10)].uid&&(r=i[parseInt(t.toString(),10)]);return r},f.prototype.getFilteredRecords=function(){if(this.allowFiltering&&this.filterSettings.columns.length){var n=this.renderModule.data.generateQuery(!0);return this.dataSource&&this.renderModule.data.isRemote()&&this.dataSource instanceof u.DataManager?this.renderModule.data.getData(this.dataSource,n):this.dataSource instanceof u.DataManager?this.dataSource.executeLocal(n):new u.DataManager(this.dataSource,n).executeLocal(n)}return[]},f.prototype.getUserAgent=function(){var n=t.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad|macintosh/.test(n)},f.prototype.tapEvent=function(n){this.getUserAgent()&&(or.timer?(clearTimeout(or.timer),or.timer=null,this.dblClickHandler(n),this.notify(tl,n)):or.timer=setTimeout(function(){or.timer=null},300))},f.prototype.getRowUid=function(n){return""+n+this.rowUid++},f.prototype.getMovableVirtualContent=function(){return this.getContent().querySelector("."+p)},f.prototype.getFrozenVirtualContent=function(){return this.getContent().querySelector("."+wi)},f.prototype.getMovableVirtualHeader=function(){return this.getHeaderContent().querySelector("."+w)},f.prototype.getFrozenVirtualHeader=function(){return this.getHeaderContent().querySelector("."+fr)},f.prototype.getRowElementByUID=function(n){var s,t=[],l,u,i,f,o;if(this.isFrozenGrid()){var h=[].slice.call(this.getFrozenVirtualContent().querySelector(e).children),c=[].slice.call(this.getMovableVirtualContent().querySelector(e).children),r=[];(3===this.tablesCount&&(r=[].slice.call(this.getContent().querySelector(".e-frozen-right-content").querySelector(e).children)),this.frozenRows)?((t=(t=[].slice.call(this.getFrozenVirtualHeader().querySelector(e).children)).concat([].slice.call(this.getMovableVirtualHeader().querySelector(e).children)),3===this.tablesCount)&&(l=this.getHeaderContent().querySelector(".e-frozen-right-header"),t=t.concat([].slice.call(l.querySelector(e).children)).concat(r)),t=t.concat(h).concat(c)):t=h.concat(c).concat(r)}else u=[].slice.call(this.getContent().querySelector(e).children),t=this.frozenRows?(t=[].slice.call(this.getHeaderContent().querySelector(e).children)).concat(u):u;for(i=0,f=t;i<f.length;i++)if(o=f[i],o.getAttribute("data-uid")===n){s=o;break}return s},f.prototype.getHiddenColumns=function(){for(var t,i=[],n=0,r=this.columnModel;n<r.length;n++)t=r[n],!1===t.visible&&i.push(t);return i},f.prototype.calculatePageSizeByParentHeight=function(n){if(this.allowPaging&&(this.allowTextWrap&&"Header"===this.textWrapSettings.wrapMode||!this.allowTextWrap)){var t=0;if(-1!==n.indexOf("%")&&(n=parseInt(n,10)/100*this.element.clientHeight),n>this.getNoncontentHeight()+this.getRowHeight()&&(t=(n-this.getNoncontentHeight())/this.getRowHeight()),t>0)return Math.floor(t)}return 0},f.prototype.getNoncontentHeight=function(){var n=0,i;if(t.isNullOrUndefined(this.getHeaderContent().clientHeight)||(n+=this.getHeaderContent().clientHeight),this.toolbar&&!t.isNullOrUndefined(this.element.querySelector(".e-toolbar").clientHeight)&&(n+=this.element.querySelector(".e-toolbar").clientHeight),this.allowPaging&&!t.isNullOrUndefined(this.element.querySelector(".e-gridpager").clientHeight)&&(n+=this.element.querySelector(".e-gridpager").clientHeight),this.showColumnChooser&&!t.isNullOrUndefined(this.element.querySelector(".e-columnheader").clientHeight)&&(n+=this.element.querySelector(".e-columnheader").clientHeight),this.allowGrouping&&this.groupSettings.showDropArea&&!t.isNullOrUndefined(this.element.querySelector(".e-groupdroparea").clientHeight)&&(n+=this.element.querySelector(".e-groupdroparea").clientHeight),this.aggregates.length>0&&!t.isNullOrUndefined(this.element.querySelector(".e-summaryrow").clientHeight))for(i=0;i<this.element.getElementsByClassName("e-summaryrow").length;i++)n+=this.element.getElementsByClassName("e-summaryrow")[parseInt(i.toString(),10)].clientHeight;return n},f.prototype.getSummaryValues=function(n,t){return u.DataUtil.aggregates[n.type.toLowerCase()](t,n.field)},f.prototype.serverExcelExport=function(n){this.isExcel=!0;this.exportGrid(n)},f.prototype.serverPdfExport=function(n){this.isExcel=!1;this.exportGrid(n)},f.prototype.serverCsvExport=function(n){this.isExcel=!0;this.exportGrid(n)},f.prototype.exportGrid=function(n){var e=this.getDataModule().generateQuery(!0),o=(new u.UrlAdaptor).processQuery(new u.DataManager({url:""}),e),r=JSON.parse(o.data),i=JSON.parse(this.addOnPersist(["allowGrouping","allowPaging","pageSettings","sortSettings","allowPdfExport","allowExcelExport","aggregates","filterSettings","groupSettings","columns","locale","searchSettings"])),t,f;i.filterSettings.columns=r.where;i.searchSettings.fields=r.search&&r.search[0].fields||[];i.sortSettings.columns=r.sorted;i.columns=this.setHeaderText(i.columns,["field","headerText","type","format","visible","foreignKeyValue","foreignKeyField","template","index","width","textAlign","headerTextAlign","columns"]);t=this.createElement("form",{id:"ExportForm",styles:"display:none;"});f=this.createElement("input",{id:"gridInput",attrs:{name:"gridModel"}});f.value=JSON.stringify(i);t.method="POST";t.action=n;t.appendChild(f);document.body.appendChild(t);t.submit();t.remove()},f.prototype.setHeaderText=function(n,i){for(var e,f,u,r=0;r<n.length;r++)for(e=this.getColumnByUid(n[parseInt(r.toString(),10)].uid),n[parseInt(r.toString(),10)].headerText=e.headerText,t.isNullOrUndefined(e.template)||(n[parseInt(r.toString(),10)].template="true"),n[parseInt(r.toString(),10)].format&&(n[parseInt(r.toString(),10)].format=tut(this.getFormat(n[parseInt(r.toString(),10)].format),n[parseInt(r.toString(),10)].type,this.isExcel,this.currencyCode)),n[parseInt(r.toString(),10)].columns&&this.setHeaderText(n[parseInt(r.toString(),10)].columns,i),f=Object.keys(n[parseInt(r.toString(),10)]),u=0;u<f.length;u++)i.indexOf(f[parseInt(u.toString(),10)])<0&&delete n[parseInt(r.toString(),10)][f[parseInt(u.toString(),10)]];return n},f.prototype.getFormat=function(n){return"object"==typeof n?t.isNullOrUndefined(n.format)?n.skeleton:n.format:n},f.prototype.isCollapseStateEnabled=function(){return!1===this.isExpanded},f.prototype.updateRowValue=function(n,t){var i={requestType:"save",data:t};this.showSpinner();this.notify(pe,i);this.refresh()},f.prototype.setForeignKeyData=function(){this.dataBind();var n=this.getDataModule().getForeignKeyDataState();n.isPending?(this.getDataModule().setForeignKeyDataState({}),n.resolver()):(this.getDataModule().setForeignKeyDataState({isDataChanged:!1}),(this.contentModule||this.headerModule)&&this.renderModule.render())},f.prototype.resetFilterDlgPosition=function(n){var f=this.getColumnHeaderByField(n),u,t,i,r;f&&(u=f.querySelector(".e-filtermenudiv"),t=this.element.querySelector(".e-filter-popup"),u&&t&&(i=this.element.getBoundingClientRect(),r=u.getBoundingClientRect(),t&&(t.style.left=t.offsetWidth+r.right>i.right?(r.right-t.offsetWidth-i.left).toString()+"px":(r.right-i.left).toString()+"px")))},f.prototype.renderTemplates=function(n){this.parentDetails&&this.parentDetails.parentInstObj&&this.parentDetails.parentInstObj.isReact&&this.portals?(this.parentDetails.parentInstObj.portals=this.parentDetails.parentInstObj.portals.concat(this.portals),this.parentDetails.parentInstObj.renderTemplates(n),this.portals=void 0):(this.notify("reactTemplateRender",this.portals),this.renderReactTemplates(n))},f.prototype.batchUpdate=function(n){this.processRowChanges(n)},f.prototype.batchAsyncUpdate=function(n){this.processBulkRowChanges(n)},f.prototype.processBulkRowChanges=function(n){var i=this;if(this.dataToBeUpdated)for(var r=[ar,gf,eu],u=this.getPrimaryKeyFieldNames()[0],t=0;t<r.length;t++)n[r[parseInt(t.toString(),10)]]&&brt(this,n,r[parseInt(t.toString(),10)],u);else this.dataToBeUpdated=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},n),setTimeout(function(){i.processRowChanges(i.dataToBeUpdated);i.dataToBeUpdated=null},this.asyncTimeOut)},f.prototype.processRowChanges=function(n){var i=this,r=this.getPrimaryKeyFieldNames()[0],t;n=Object.assign({addedRecords:[],changedRecords:[],deletedRecords:[]},n);t=this.getDataModule().saveChanges(n,r,{},this.getDataModule().generateQuery().requiresCount());this.getDataModule().isRemote()?t.then(function(){i.setNewData()}):this.setNewData()},f.prototype.setNewData=function(){var n=this,t=JSON.parse(JSON.stringify(this.getCurrentViewRecords()));this.getDataModule().getData({},this.getDataModule().generateQuery().requiresCount()).then(function(i){n.bulkRefresh(i.result,t,i.count)})},f.prototype.deleteRowElement=function(n){var i=this.getRowElementByUID(n.uid),u=parseInt(i.getAttribute(h),10),r;(t.remove(i),this.getFrozenColumns())&&(r=this.getMovableRows()[parseInt(u.toString(),10)],t.remove(r))},f.prototype.bulkRefresh=function(n,t,i){for(var o,s,h,e,c=this,f=this.getRowsObject(),u=this.getPrimaryKeyFieldNames()[0],l=function(t){n.filter(function(n){return n[""+u]===f[parseInt(t.toString(),10)].data[""+u]}).length||(a.deleteRowElement(f[parseInt(t.toString(),10)]),f.splice(t,1),t--);e=t},a=this,r=0;r<f.length;r++)l(r),r=e;for(o=function(i){var r;t.filter(function(t){t[""+u]===n[parseInt(i.toString(),10)][""+u]&&(t!==n[parseInt(i.toString(),10)]&&c.setRowData(n[parseInt(i.toString(),10)][""+u],n[parseInt(i.toString(),10)]),r=!0)});r||s.renderRowElement(n[parseInt(i.toString(),10)],i)},s=this,r=0;r<n.length;r++)o(r);this.currentViewData=n;h=[].slice.call(this.getContentTable().getElementsByClassName(y));of(this,this.getRowsObject(),h);oe(this);this.allowPaging&&this.notify(gt,{module:"pager",properties:{totalRecordsCount:i}})},f.prototype.renderRowElement=function(n,t){var f,h=new oi(this.serviceLocator,null,this),o=new er(this).generateRows([n]),s=h.render(o[0],this.getColumns()),i,r,u;this.addRowObject(o[0],t);i=this.getContentTable().querySelector(e);i.querySelector(".e-emptyrow")&&(r=i.querySelector(".e-emptyrow"),(r.parentNode.removeChild(r),this.getFrozenColumns())&&(u=this.getContent().querySelector("."+p).querySelector(e),u.firstElementChild.parentNode.removeChild(u.firstElementChild)));this.getFrozenColumns()&&(f=yh(s,this.getFrozenColumns(),this),(this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector("."+w).querySelector(e):this.getContent().querySelector("."+p).querySelector(e)).appendChild(f),"auto"===this.height&&this.notify(ke,{}));i=this.frozenRows&&t<this.frozenRows?this.getHeaderContent().querySelector(e):this.getContent().querySelector(e);(i=this.getContent().querySelector(e)).appendChild(s)},f.prototype.addRowObject=function(n,t){var r=this.getFrozenColumns(),u,i;r&&(u=this.getMovableRowsObject(),i=n.clone(),i.cells=i.cells.slice(r),n.cells=n.cells.slice(0,r),u.splice(t,1,i));this.getRowsObject().splice(t,1,n)},f.prototype.updateVisibleExpandCollapseRows=function(){for(var t=this.getRowsObject(),n=0,i=t.length;n<i;n++)t[parseInt(n.toString(),10)].visible=(t[parseInt(n.toString(),10)].isDataRow||t[parseInt(n.toString(),10)].isAggregateRow)&&"none"===this.getRowElementByUID(t[parseInt(n.toString(),10)].uid).style.display?!1:!0},f.prototype.sanitize=function(n){return this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(n):n},f.prototype.getHeight=function(n){return Number.isInteger(n)||-1===n.indexOf("%")?Number.isInteger(n)||"auto"===this.height?this.height:parseInt(n,10):parseInt(n,10)/100*this.element.clientHeight},f.prototype.getFrozenRightContent=function(){return this.getContent().querySelector(".e-frozen-right-content")},f.prototype.getFrozenRightHeader=function(){return this.getHeaderContent().querySelector(".e-frozen-right-header")},f.prototype.getMovableHeaderTbody=function(){return this.getMovableVirtualHeader().querySelector(e)},f.prototype.getMovableContentTbody=function(){return this.getMovableVirtualContent().querySelector(e)},f.prototype.getFrozenHeaderTbody=function(){return this.getFrozenVirtualHeader().querySelector(e)},f.prototype.getFrozenLeftContentTbody=function(){return this.getFrozenVirtualContent().querySelector(e)},f.prototype.getFrozenRightHeaderTbody=function(){return this.getFrozenRightHeader().querySelector(e)},f.prototype.getFrozenRightContentTbody=function(){var n;return this.getFrozenRightContent()&&(n=this.getFrozenRightContent().querySelector(e)),n},f.prototype.showResponsiveCustomFilter=function(n){this.filterModule&&this.filterModule.showCustomFilter(n||"Vertical"===this.rowRenderingMode)},f.prototype.showResponsiveCustomSort=function(n){this.sortModule&&this.sortModule.showCustomSort(n||"Vertical"===this.rowRenderingMode)},f.prototype.showAdaptiveFilterDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomFilter(!0)},f.prototype.showAdaptiveSortDialog=function(){this.enableAdaptiveUI&&this.showResponsiveCustomSort(!0)},f.prototype.getCurrentVisibleColumns=function(n){for(var i,r=[],t=0,u=n?this.getColumns():this.columnModel;t<u.length;t++)i=u[t],i.visible&&r.push(i);return r},f.prototype.enableInfiniteAggrgate=function(){this.enableInfiniteScrolling&&this.groupSettings.columns.length&&!this.groupSettings.disablePageWiseAggregates&&!this.groupSettings.enableLazyLoading&&this.setProperties({groupSettings:{disablePageWiseAggregates:!0}},!0)},r([t.Property([])],f.prototype,"currentViewData",void 0),r([t.Property()],f.prototype,"parentDetails",void 0),r([t.Property()],f.prototype,"showHider",void 0),r([t.Property([])],f.prototype,"columns",void 0),r([t.Property(!0)],f.prototype,"enableAltRow",void 0),r([t.Property(!0)],f.prototype,"enableHover",void 0),r([t.Property(!1)],f.prototype,"enableAutoFill",void 0),r([t.Property(!0)],f.prototype,"allowKeyboard",void 0),r([t.Property(!1)],f.prototype,"enableStickyHeader",void 0),r([t.Property(!1)],f.prototype,"enableHtmlSanitizer",void 0),r([t.Property(!1)],f.prototype,"allowTextWrap",void 0),r([t.Complex({},git)],f.prototype,"textWrapSettings",void 0),r([t.Complex({},nrt)],f.prototype,"resizeSettings",void 0),r([t.Property(!1)],f.prototype,"allowPaging",void 0),r([t.Complex({},wst)],f.prototype,"pageSettings",void 0),r([t.Complex({},rrt)],f.prototype,"loadingIndicator",void 0),r([t.Property(!0)],f.prototype,"enableVirtualMaskRow",void 0),r([t.Property(!1)],f.prototype,"enableVirtualization",void 0),r([t.Property(!1)],f.prototype,"enableColumnVirtualization",void 0),r([t.Property(!1)],f.prototype,"enableInfiniteScrolling",void 0),r([t.Complex({},kit)],f.prototype,"searchSettings",void 0),r([t.Property(!1)],f.prototype,"allowSorting",void 0),r([t.Property("Ellipsis")],f.prototype,"clipMode",void 0),r([t.Property(!0)],f.prototype,"allowMultiSorting",void 0),r([t.Property(!1)],f.prototype,"allowExcelExport",void 0),r([t.Property(!1)],f.prototype,"allowPdfExport",void 0),r([t.Complex({},vit)],f.prototype,"sortSettings",void 0),r([t.Complex({},pit)],f.prototype,"infiniteScrollSettings",void 0),r([t.Property(!0)],f.prototype,"allowSelection",void 0),r([t.Property(-1)],f.prototype,"selectedRowIndex",void 0),r([t.Complex({},bit)],f.prototype,"selectionSettings",void 0),r([t.Property(!1)],f.prototype,"allowFiltering",void 0),r([t.Property("Horizontal")],f.prototype,"rowRenderingMode",void 0),r([t.Property(!1)],f.prototype,"enableAdaptiveUI",void 0),r([t.Property(!1)],f.prototype,"allowReordering",void 0),r([t.Property(!1)],f.prototype,"allowResizing",void 0),r([t.Property(!1)],f.prototype,"allowRowDragAndDrop",void 0),r([t.Complex({},dit)],f.prototype,"rowDropSettings",void 0),r([t.Complex({},wit)],f.prototype,"filterSettings",void 0),r([t.Property(!1)],f.prototype,"allowGrouping",void 0),r([t.Property(!1)],f.prototype,"enableImmutableMode",void 0),r([t.Property(!1)],f.prototype,"showColumnMenu",void 0),r([t.Property(!1)],f.prototype,"autoFit",void 0),r([t.Complex({},trt)],f.prototype,"groupSettings",void 0),r([t.Complex({},irt)],f.prototype,"editSettings",void 0),r([t.Collection([],nht)],f.prototype,"aggregates",void 0),r([t.Property(!1)],f.prototype,"showColumnChooser",void 0),r([t.Complex({},kst)],f.prototype,"columnChooserSettings",void 0),r([t.Property(!1)],f.prototype,"enableHeaderFocus",void 0),r([t.Property("auto")],f.prototype,"height",void 0),r([t.Property("auto")],f.prototype,"width",void 0),r([t.Property("Default")],f.prototype,"gridLines",void 0),r([t.Property()],f.prototype,"rowTemplate",void 0),r([t.Property()],f.prototype,"detailTemplate",void 0),r([t.Property()],f.prototype,"childGrid",void 0),r([t.Property()],f.prototype,"queryString",void 0),r([t.Property("AllPages")],f.prototype,"printMode",void 0),r([t.Property("Expanded")],f.prototype,"hierarchyPrintMode",void 0),r([t.Property([])],f.prototype,"dataSource",void 0),r([t.Property(null)],f.prototype,"rowHeight",void 0),r([t.Property()],f.prototype,"query",void 0),r([t.Property("USD")],f.prototype,"currencyCode",void 0),r([t.Property()],f.prototype,"toolbar",void 0),r([t.Property()],f.prototype,"contextMenuItems",void 0),r([t.Property()],f.prototype,"columnMenuItems",void 0),r([t.Property()],f.prototype,"toolbarTemplate",void 0),r([t.Property()],f.prototype,"pagerTemplate",void 0),r([t.Property(0)],f.prototype,"frozenRows",void 0),r([t.Property(0)],f.prototype,"frozenColumns",void 0),r([t.Property("")],f.prototype,"cssClass",void 0),r([t.Property("All")],f.prototype,"columnQueryMode",void 0),r([t.Property({})],f.prototype,"currentAction",void 0),r([t.Property("22.2.5")],f.prototype,"ej2StatePersistenceVersion",void 0),r([t.Event()],f.prototype,"created",void 0),r([t.Event()],f.prototype,"destroyed",void 0),r([t.Event()],f.prototype,"load",void 0),r([t.Event()],f.prototype,"rowDataBound",void 0),r([t.Event()],f.prototype,"queryCellInfo",void 0),r([t.Event()],f.prototype,"headerCellInfo",void 0),r([t.Event()],f.prototype,"actionBegin",void 0),r([t.Event()],f.prototype,"actionComplete",void 0),r([t.Event()],f.prototype,"actionFailure",void 0),r([t.Event()],f.prototype,"dataBound",void 0),r([t.Event()],f.prototype,"recordDoubleClick",void 0),r([t.Event()],f.prototype,"recordClick",void 0),r([t.Event()],f.prototype,"rowSelecting",void 0),r([t.Event()],f.prototype,"rowSelected",void 0),r([t.Event()],f.prototype,"rowDeselecting",void 0),r([t.Event()],f.prototype,"rowDeselected",void 0),r([t.Event()],f.prototype,"cellSelecting",void 0),r([t.Event()],f.prototype,"cellSelected",void 0),r([t.Event()],f.prototype,"cellDeselecting",void 0),r([t.Event()],f.prototype,"cellDeselected",void 0),r([t.Event()],f.prototype,"columnSelecting",void 0),r([t.Event()],f.prototype,"columnSelected",void 0),r([t.Event()],f.prototype,"columnDeselecting",void 0),r([t.Event()],f.prototype,"columnDeselected",void 0),r([t.Event()],f.prototype,"columnDragStart",void 0),r([t.Event()],f.prototype,"columnDrag",void 0),r([t.Event()],f.prototype,"columnDrop",void 0),r([t.Event()],f.prototype,"printComplete",void 0),r([t.Event()],f.prototype,"beforePrint",void 0),r([t.Event()],f.prototype,"pdfQueryCellInfo",void 0),r([t.Event()],f.prototype,"pdfHeaderQueryCellInfo",void 0),r([t.Event()],f.prototype,"pdfAggregateQueryCellInfo",void 0),r([t.Event()],f.prototype,"excelAggregateQueryCellInfo",void 0),r([t.Event()],f.prototype,"exportDetailDataBound",void 0),r([t.Event()],f.prototype,"excelQueryCellInfo",void 0),r([t.Event()],f.prototype,"excelHeaderQueryCellInfo",void 0),r([t.Event()],f.prototype,"beforeExcelExport",void 0),r([t.Event()],f.prototype,"excelExportComplete",void 0),r([t.Event()],f.prototype,"beforePdfExport",void 0),r([t.Event()],f.prototype,"pdfExportComplete",void 0),r([t.Event()],f.prototype,"rowDragStartHelper",void 0),r([t.Event()],f.prototype,"detailDataBound",void 0),r([t.Event()],f.prototype,"rowDragStart",void 0),r([t.Event()],f.prototype,"rowDrag",void 0),r([t.Event()],f.prototype,"rowDrop",void 0),r([t.Event()],f.prototype,"toolbarClick",void 0),r([t.Event()],f.prototype,"beforeOpenColumnChooser",void 0),r([t.Event()],f.prototype,"beforeOpenAdaptiveDialog",void 0),r([t.Event()],f.prototype,"batchAdd",void 0),r([t.Event()],f.prototype,"batchDelete",void 0),r([t.Event()],f.prototype,"batchCancel",void 0),r([t.Event()],f.prototype,"beforeBatchAdd",void 0),r([t.Event()],f.prototype,"beforeBatchDelete",void 0),r([t.Event()],f.prototype,"beforeBatchSave",void 0),r([t.Event()],f.prototype,"beginEdit",void 0),r([t.Event()],f.prototype,"commandClick",void 0),r([t.Event()],f.prototype,"cellEdit",void 0),r([t.Event()],f.prototype,"cellSave",void 0),r([t.Event()],f.prototype,"cellSaved",void 0),r([t.Event()],f.prototype,"resizeStart",void 0),r([t.Event()],f.prototype,"resizing",void 0),r([t.Event()],f.prototype,"resizeStop",void 0),r([t.Event()],f.prototype,"keyPressed",void 0),r([t.Event()],f.prototype,"beforeDataBound",void 0),r([t.Event()],f.prototype,"contextMenuOpen",void 0),r([t.Event()],f.prototype,"contextMenuClick",void 0),r([t.Event()],f.prototype,"columnMenuOpen",void 0),r([t.Event()],f.prototype,"columnMenuClick",void 0),r([t.Event()],f.prototype,"checkBoxChange",void 0),r([t.Event()],f.prototype,"beforeCopy",void 0),r([t.Event()],f.prototype,"beforePaste",void 0),r([t.Event()],f.prototype,"beforeAutoFill",void 0),r([t.Event()],f.prototype,"columnDataStateChange",void 0),r([t.Event()],f.prototype,"dataStateChange",void 0),r([t.Event()],f.prototype,"dataSourceChanged",void 0),r([t.Event()],f.prototype,"exportGroupCaption",void 0),r([t.Event()],f.prototype,"lazyLoadGroupExpand",void 0),r([t.Event()],f.prototype,"lazyLoadGroupCollapse",void 0),o=r([t.NotifyPropertyChanges],f)}(t.Component);iv=function(){function n(n,t){this.isAsyncPrint=!1;this.defered=new u.Deferred;this.parent=n;this.parent.isDestroyed||(this.parent.on(it,this.isContentReady(),this),this.actionBeginFunction=this.actionBegin.bind(this),this.parent.addEventListener(nt,this.actionBeginFunction),this.parent.on(vi,this.onEmpty.bind(this)),this.parent.on(ol,this.hierarchyPrint,this),this.scrollModule=t)}return n.prototype.isContentReady=function(){var n=this;return!this.isPrintGrid()||"None"!==this.parent.hierarchyPrintMode&&this.parent.childGrid?function(){n.defered.promise.then(function(){n.contentReady()});n.isPrintGrid()&&n.hierarchyPrint()}:this.contentReady},n.prototype.hierarchyPrint=function(){this.removeColGroup(this.parent);var n=window.printGridObj;n&&!n.element.querySelector("[aria-busy=true")&&n.printModule.defered.resolve()},n.prototype.print=function(){this.renderPrintGrid()},n.prototype.onEmpty=function(){this.isPrintGrid()&&this.contentReady()},n.prototype.actionBegin=function(){this.isPrintGrid()&&(this.isAsyncPrint=!0)},n.prototype.renderPrintGrid=function(){var i=this.parent,u=t.createElement("div",{id:this.parent.element.id+"_print",className:i.element.className+" e-print-grid"}),n,r,f,e;for(u.classList.remove("e-gridhover"),document.body.appendChild(u),n=new tv(wh(i,i.hierarchyPrintMode)),r=0;r<n.columns.length;r++)n.columns[parseInt(r.toString(),10)]=t.extend({},n.columns[parseInt(r.toString(),10)]),i.isFrozenGrid()&&!i.getFrozenColumns()&&(n.columns[parseInt(r.toString(),10)].freeze=void 0);this.parent.isAngular&&(n.viewContainerRef=this.parent.viewContainerRef);n.load=function(){};n.query=i.getQuery().clone();window.printGridObj=n;n.isPrinting=!0;f=n.getInjectedModules();e=i.getInjectedModules();f&&f.length===e.length||n.setInjectedModules(e);i.notify(sn,{element:u,printgrid:n});this.parent.log("exporting_begin",this.getModuleName());n.registeredTemplate=this.parent.registeredTemplate;n.isVue=this.parent.isVue;n.appendTo(u);i.isVue3||(n.trigger=i.trigger)},n.prototype.contentReady=function(){var n,i;if(this.isPrintGrid()){if(n=this.parent,this.isAsyncPrint)return void this.printGrid();if(i={requestType:"print",element:n.element,selectedRows:n.getContentTable().querySelectorAll('tr[aria-selected="true"]'),cancel:!1,hierarchyPrintMode:n.hierarchyPrintMode},this.isAsyncPrint||n.trigger(ly,i),i.cancel)return void t.detach(n.element);this.isAsyncPrint||this.printGrid()}},n.prototype.printGrid=function(){var n=this.parent,i,r,f,c;if("auto"!==n.height){var e=this.scrollModule.getCssProperties(),o=n.element.querySelector("."+ft),s=n.element.querySelector("."+ct);o.style.height="auto";o.style.overflowY="auto";s.style[e.padding]="";s.firstElementChild.style[e.border]=""}for(n.allowGrouping&&(n.groupSettings.columns.length?this.removeColGroup(n):n.element.querySelector(".e-groupdroparea").style.display="none"),i=0,r=[].slice.call(n.element.getElementsByClassName(ft));i<r.length;i++)(f=r[i]).style.overflowX="hidden";for(var l=[].slice.call(n.element.getElementsByClassName("e-spin-show")),u=0,h=[].slice.call(l);u<h.length;u++)f=h[u],t.classList(f,["e-spin-hide"],["e-spin-show"]);this.printGridElement(n);n.isPrinting=!1;delete window.printGridObj;c={element:n.element};n.trigger(ay,c);n.destroy();this.parent.log("exporting_complete",this.getModuleName())},n.prototype.printGridElement=function(n){t.classList(n.element,["e-print-grid-layout"],["e-print-grid"]);n.isPrinting&&t.detach(n.element);this.printWind=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no");this.printWind.moveTo(0,0);this.printWind.resizeTo(screen.availWidth,screen.availHeight);this.printWind=t.print(n.element,this.printWind)},n.prototype.removeColGroup=function(n){var i=n.groupSettings.columns.length,r=n.element,s="#"+n.element.id,e,o;if(i){for(var u=t.selectAll(".e-groupcaption",r),h=u[i-1].getAttribute("colspan"),f=0;f<u.length;f++)u[parseInt(f.toString(),10)].setAttribute("colspan",h);e=t.selectAll("colgroup"+s+"colgroup",r);o=t.selectAll(".e-content colgroup",r);this.hideColGroup(e,i);this.hideColGroup(o,i)}},n.prototype.hideColGroup=function(n,t){for(var r,i=0;i<n.length;i++)for(r=0;r<t;r++)n[parseInt(i.toString(),10)].children[parseInt(r.toString(),10)].style.display="none"},n.prototype.isPrintGrid=function(){return this.parent.element.id.indexOf("_print")>0&&this.parent.isPrinting},n.prototype.destroy=function(){this.parent.isDestroyed||(this.parent.off(it,this.contentReady.bind(this)),this.parent.removeEventListener(nt,this.actionBeginFunction),this.parent.off(vi,this.onEmpty.bind(this)),this.parent.off(ol,this.hierarchyPrint))},n.prototype.getModuleName=function(){return"print"},n.printGridProp=["aggregates","allowGrouping","allowFiltering","allowMultiSorting","allowReordering","allowSorting","allowTextWrap","childGrid","columns","currentViewData","dataSource","detailTemplate","enableAltRow","enableColumnVirtualization","filterSettings","gridLines","groupSettings","height","locale","pageSettings","printMode","query","queryString","enableRtl","rowHeight","rowTemplate","sortSettings","textWrapSettings","allowPaging","hierarchyPrintMode","searchSettings","queryCellInfo","beforeDataBound"].concat([ly,ay,oc]),n}();nr=0;ort=0;ov=null;!function(n){n.timer=null}(or||(or={}));const kr=ejdashboard.inputs;ru=function(){function n(n){this.isExecuteLocal=!1;this.existingPredicate={};this.foreignKeyQuery=new u.Query;this.filterState=!0;this.values={};this.renderEmpty=!1;this.isCheckboxFilterTemplate=!1;this.parent=n;this.id=this.parent.element.id;this.valueFormatter=new wu(this.parent.locale);this.cBoxTrue=fi.createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "});this.cBoxFalse=fi.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "});this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxTrue.firstChild);this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden",attrs:{type:"checkbox"}}),this.cBoxFalse.firstChild);this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck");this.parent.enableRtl&&t.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"]);this.parent.cssClass&&t.addClass([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass])}return n.prototype.destroy=function(){this.closeDialog()},n.prototype.wireEvents=function(){t.EventHandler.add(this.dlg,"click",this.clickHandler,this);t.EventHandler.add(this.dlg,"keyup",this.keyupHandler,this);this.searchHandler=t.debounce(this.searchBoxKeyUp,200);var n=this.dialogObj.element.querySelector(".e-searchinput");n&&t.EventHandler.add(n,"keyup",this.searchHandler,this)},n.prototype.unWireEvents=function(){t.EventHandler.remove(this.dlg,"click",this.clickHandler);t.EventHandler.remove(this.dlg,"keyup",this.keyupHandler);var n=this.dialogObj.element.querySelector(".e-searchinput");n&&t.EventHandler.remove(n,"keyup",this.searchHandler)},n.prototype.foreignKeyFilter=function(n,t,i){var r=this,u={},f=[],e=this.foreignKeyQuery.clone();this.options.column.dataSource.executeQuery(e.where(i)).then(function(i){r.options.column.columnData=i.result;r.parent.notify(kf,{predicate:u,column:r.options.column});n.ejpredicate=u.predicate.predicates;for(var o=u.predicate.predicates,e=0;e<o.length;e++)f.push({field:o[parseInt(e.toString(),10)].field,predicate:"or",matchCase:o[parseInt(e.toString(),10)].ignoreCase,ignoreAccent:o[parseInt(e.toString(),10)].ignoreAccent,operator:o[parseInt(e.toString(),10)].operator,value:o[parseInt(e.toString(),10)].value,type:r.options.type});n.filterCollection=f.length?f:t.filter(function(n){return n.field=r.options.field});r.options.handler(n)})},n.prototype.foreignFilter=function(n,t){var i=this.options.isRemote?"string"===this.options.column.type?"contains":"equal":this.options.column.type?"contains":"equal",r=new u.Predicate(this.options.column.foreignKeyValue,i,t,!0,this.options.ignoreAccent);this.foreignKeyFilter(n,[n.filterCollection],r)},n.prototype.searchBoxClick=function(n){var t=n.target;t.classList.contains("e-searchclear")&&(this.sInput.value=t.classList.contains("e-chkcancel-icon")?"":this.sInput.value,this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:n}):this.refreshCheckboxes(),this.updateSearchIcon(),this.sInput.focus())},n.prototype.searchBoxKeyUp=function(n){t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType||this.parent.showMaskRow(void 0,this.dialogObj.element);this.isCheckboxFilterTemplate?this.parent.notify("refreshCheckbox",{event:n}):this.refreshCheckboxes();this.updateSearchIcon()},n.prototype.updateSearchIcon=function(){this.sInput.value.length?(t.classList(this.sIcon,["e-chkcancel-icon"],["e-search-icon"]),document.body.querySelector(".e-chkcancel-icon").setAttribute("title",this.localeObj.getConstant("Clear"))):(t.classList(this.sIcon,["e-search-icon"],["e-chkcancel-icon"]),document.body.querySelector(".e-search-icon").setAttribute("title",this.localeObj.getConstant("Search")))},n.prototype.getLocalizedLabel=function(n){return this.localeObj.getConstant(n)},n.prototype.updateDataSource=function(){var n=this.options.dataSource,t,i;if(!(n instanceof u.DataManager))for(t=0;t<n.length;t++)"object"!=typeof n&&(i={},i[this.options.field]=n[parseInt(t.toString(),10)],n[parseInt(t.toString(),10)]=i)},n.prototype.updateModel=function(n){this.options=n;this.existingPredicate=n.actualPredicate||{};this.options.dataSource=n.dataSource;this.options.dataManager=n.dataManager?n.dataManager:n.dataSource;this.updateDataSource();this.options.type=n.type;this.options.format=n.format||"";this.options.ignoreAccent=n.ignoreAccent||!1;this.options.filteredColumns=n.filteredColumns||this.parent.filterSettings.columns;this.options.query=n.query||new u.Query;this.options.allowCaseSensitive=n.allowCaseSensitive||!1;this.options.uid=n.column.uid;this.options.disableHtmlEncode=n.column.disableHtmlEncode||!1;this.values={};this.localeObj=n.localeObj;this.isFiltered=n.filteredColumns.length},n.prototype.getAndSetChkElem=function(n){if(this.dlg=this.parent.createElement("div",{id:this.id+this.options.type+"_excelDlg",attrs:{uid:this.options.column.uid},className:"e-checkboxfilter e-filter-popup"}),this.sBox=this.parent.createElement("div",{className:"e-searchcontainer"}),!n.hideSearchbox){this.sInput=this.parent.createElement("input",{id:this.id+"_SearchBox",className:"e-searchinput"});this.sIcon=this.parent.createElement("span",{className:"e-searchclear e-search-icon e-icons e-input-group-icon",attrs:{type:"text",title:this.getLocalizedLabel("Search")}});this.searchBox=this.parent.createElement("span",{className:"e-searchbox e-fields"});this.searchBox.appendChild(this.sInput);this.sBox.appendChild(this.searchBox);var t={element:this.sInput,floatLabelType:"Never",properties:{placeholder:this.getLocalizedLabel("Search"),cssClass:this.parent.cssClass}};kr.Input.createInput(t,this.parent.createElement);this.searchBox.querySelector(".e-input-group").appendChild(this.sIcon)}return this.spinner=this.parent.createElement("div",{className:"e-spinner"}),this.cBox=this.parent.createElement("div",{id:this.id+this.options.type+"_CheckBoxList",className:"e-checkboxlist e-fields"}),this.spinner.appendChild(this.cBox),this.sBox.appendChild(this.spinner),this.sBox},n.prototype.showDialog=function(n){var r={requestType:by,columnName:this.options.field,columnType:this.options.type,cancel:!1};r.filterModel=this;this.parent.notify(cl,r);r.cancel?n.cancel=r.cancel:(this.dialogObj=new bt.Dialog({visible:!1,content:this.sBox,close:this.closeDialog.bind(this),enableRtl:this.parent.enableRtl,width:!t.isNullOrUndefined(i(n.target,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:255,target:this.parent.element,animationSettings:{effect:"None"},buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.getLocalizedLabel(this.isExcel?"CancelButton":"ClearButton")}}],created:this.dialogCreated.bind(this),open:this.dialogOpen.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""}),this.dialogObj.isStringTemplate=!0,this.renderResponsiveFilter(n),this.dlg.setAttribute("aria-label",this.getLocalizedLabel("ExcelFilterDialogARIA")),n.isResponsiveFilter?document.querySelector(".e-responsive-dialog > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlg):this.parent.element.appendChild(this.dlg),this.dialogObj.appendTo(this.dlg),this.dialogObj.element.style.maxHeight=n.isResponsiveFilter?"none":this.options.height+"px",this.dialogObj.show(),this.dialogObj.element.querySelector(".e-dlg-content").appendChild(this.sBox),this.wireEvents(),t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType?(bt.createSpinner({target:this.spinner,cssClass:this.parent.cssClass?this.parent.cssClass:null},this.parent.createElement),bt.showSpinner(this.spinner)):this.parent.showMaskRow(void 0,this.dialogObj.element),this.getAllData())},n.prototype.renderResponsiveFilter=function(n){n.isResponsiveFilter&&(this.dialogObj.buttons=[{}],this.dialogObj.position={X:"",Y:""},this.dialogObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dialogObj.width="100%")},n.prototype.dialogCreated=function(n){this.options.isResponsiveFilter?this.dialogObj.element.style.left="0px":t.Browser.isDevice?this.dialogObj.position={X:"center",Y:"center"}:ob(this.options.target,this.dialogObj);this.options.column.showColumnMenu&&this.parent.notify(we,n)},n.prototype.openDialog=function(n){this.updateModel(n);this.getAndSetChkElem(n);this.showDialog(n)},n.prototype.closeDialog=function(){if(this.dialogObj&&!this.dialogObj.isDestroyed){this.isBlanks=!1;var i=this.options.columns.filter(function(n){return n.getFilterItemTemplate()}),n=this.parent.registeredTemplate;i.length&&!t.isNullOrUndefined(n)&&n.filterItemTemplate&&this.parent.destroyTemplate(["filterItemTemplate"]);(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&yo(this.parent,["filterItemTemplate"]);this.parent.notify(yi,{field:this.options.field});this.dialogObj.destroy();this.unWireEvents();t.remove(this.dlg);this.dlg=null;this.parent.notify(bs,{})}},n.prototype.clearFilter=function(n){var t={instance:this,handler:this.clearFilter,cancel:!1};this.parent.notify(ge,t);t.cancel||this.options.handler({action:"clear-filter",field:n?n.field:this.options.field})},n.prototype.btnClick=function(n){if(this.filterState){if("input"===n.target.tagName.toLowerCase()&&n.target.classList.contains("e-searchinput")||13===n.keyCode)this.isCheckboxFilterTemplate||this.fltrBtnHandler();else{var t=n.target.firstChild.textContent.toLowerCase();this.getLocalizedLabel(this.isExcel?"OKButton":"FilterButton").toLowerCase()===t?this.isCheckboxFilterTemplate||this.fltrBtnHandler():this.getLocalizedLabel("ClearButton").toLowerCase()===t&&this.clearFilter()}this.closeDialog()}else"input"!==n.target.tagName.toLowerCase()&&(this.clearFilter(),this.closeDialog());this.options.column.showColumnMenu&&this.parent.notify(nh,{})},n.prototype.fltrBtnHandler=function(){var e,nt=this,u=[].slice.call(this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)")),v=u,c="equal",w=this.dialogObj.element.querySelector(".e-dropdownlist"),f,l,p,h,d,a,g;w&&(this.options.operator=c=w.ej2_instances[0].value);this.isMenuNotEqual="notequal"===this.options.operator;this.options.hideSearchbox||(e=this.searchBox.querySelector(".e-searchinput"));var o,b,k,r,tt=this.options.allowCaseSensitive,s={field:this.options.field,predicate:this.isMenuNotEqual?"and":"or",uid:this.options.uid,operator:c,type:this.options.type,matchCase:tt,ignoreAccent:this.options.ignoreAccent},y=this.itemsCnt!==u.length&&this.itemsCnt-u.length<u.length;if(y&&e&&""===e.value&&(c=this.isMenuNotEqual?"equal":"notequal",u=[].slice.call(this.cBox.querySelectorAll(".e-uncheck:not(.e-selectall)")),s.predicate=this.isMenuNotEqual?"or":"and",s.operator=c),f=[],u.length!==this.itemsCnt||e&&e.value&&""!==e.value){for(l=0;l<u.length;l++)if(o=this.values[i(u[parseInt(l.toString(),10)],"e-ftrchk").getAttribute("uid")],r=t.extend({},{value:o},s),o&&!o.toString().length&&(r.operator=y?"notequal":"equal"),""===o||t.isNullOrUndefined(o)?f=f.concat(n.generateNullValuePredicates(s)):f.push(r),p={instance:this,handler:this.fltrBtnHandler,arg1:r.field,arg2:r.predicate,arg3:r.operator,arg4:r.matchCase,arg5:r.ignoreAccent,arg6:r.value,cancel:!1},this.parent.notify(ge,p),p.cancel)return;if("date"!==this.options.type&&"datetime"!==this.options.type||!v.length||(k=v.length-1,b=this.values[i(v[parseInt(k.toString(),10)],"e-ftrchk").getAttribute("uid")],t.isNullOrUndefined(b)&&y&&f.push({field:s.field,matchCase:s.matchCase,operator:"equal",predicate:"and",value:null})),this.cBox.querySelector(".e-add-current")&&this.cBox.querySelector(".e-add-current").classList.contains("e-check")){if(h=this.existingPredicate[this.options.field],!h)return;for(d=function(n){f.some(function(t){return t.value===h[parseInt(n.toString(),10)].value})||f.push(h[parseInt(n.toString(),10)])},a=0;a<h.length;a++)d(a)}this.initiateFilter(f)}else g=this.options.filteredColumns.some(function(n){return nt.options.field===n.field}),g&&this.clearFilter()},n.generateNullValuePredicates=function(n){var t=[];return"string"===n.type&&t.push({field:n.field,ignoreAccent:n.ignoreAccent,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:""}),t.push({field:n.field,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:null}),t.push({field:n.field,matchCase:n.matchCase,operator:n.operator,predicate:n.predicate,value:void 0}),t},n.prototype.initiateFilter=function(n){var f,r=n[0],i,e;if(!t.isNullOrUndefined(r)){for(f=r.ejpredicate?r.ejpredicate:new u.Predicate(r.field,r.operator,r.value,!r.matchCase,r.ignoreAccent),i=1;i<n.length;i++)f=void 0!==n[parseInt(i.toString(),10)].ejpredicate?f[n[parseInt(i.toString(),10)].predicate](n[parseInt(i.toString(),10)].ejpredicate):f[n[parseInt(i.toString(),10)].predicate](n[parseInt(i.toString(),10)].field,n[parseInt(i.toString(),10)].operator,n[parseInt(i.toString(),10)].value,!n[parseInt(i.toString(),10)].matchCase,n[parseInt(i.toString(),10)].ignoreAccent);e={action:"filtering",filterCollection:n,field:this.options.field,ejpredicate:u.Predicate.or(f)};this.options.handler(e)}},n.prototype.isForeignColumn=function(n){return!!n.isForeignColumn&&n.isForeignColumn()},n.prototype.refreshCheckboxes=function(){var r=this,f=this.sInput.value,e=this.options.column,o=this.isForeignColumn(e)?this.foreignKeyQuery.clone():this.options.query.clone(),h=this.options.query.clone(),c=o.queries.filter(function(n){return n&&"onWhere"===n.fn})[0],d,b,k;o.queries=[];h.queries=[];var i="string"!==this.options.type&&parseFloat(f)?parseFloat(f):f,v=this.options.isRemote?"string"===this.options.type?"contains":"equal":this.options.type?"contains":"equal",y=!0,p=this.options.ignoreAccent,l=this.isForeignColumn(e)?e.foreignKeyValue:e.field;i=""===i||void 0===i?void 0:i;var s,w=[],g={field:l,predicate:"or",uid:this.options.uid,operator:"equal",type:this.options.type,matchCase:y,ignoreAccent:p},a=this.options.dataManager.adaptor.getModuleName;("boolean"===this.options.type&&(void 0!==i&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(i.toLowerCase())?i="true":void 0!==i&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(i.toLowerCase())&&(i="false"),void 0!==i&&-1!==this.getLocalizedLabel("FilterTrue").toLowerCase().indexOf(i.toLowerCase())&&a?(a(),i=!0):void 0!==i&&-1!==this.getLocalizedLabel("FilterFalse").toLowerCase().indexOf(i.toLowerCase())&&a&&(a(),i=!1),v="equal"),("date"===this.options.type||"datetime"===this.options.type||"dateonly"===this.options.type)&&this.options.format)&&(d=new t.Internationalization,b="string"==typeof this.options.format?this.options.format:this.options.format.format,i=b&&d.parseDate(f,{format:b})||new Date(f),"dateonly"===this.options.type&&(i=i.getFullYear()+"-"+lu(i.getMonth()+1)+"-"+lu(i.getDate())));this.addDistinct(o);k={requestType:sg,filterModel:this,columnName:l,column:e,operator:v,matchCase:y,ignoreAccent:p,filterChoiceCount:null,query:o,value:i};this.parent.trigger(nt,k,function(a){var nt,d,b;(a.operator=a.operator,s=new u.Predicate(l,a.operator,k.value,a.matchCase,a.ignoreAccent),"date"===r.options.type||"datetime"===r.options.type||"dateonly"===r.options.type)&&(nt={field:l,operator:v="equal",value:i,matchCase:y,ignoreAccent:p},t.isNullOrUndefined(i)||(s=au(nt,r.options.type)));f&&"string"==typeof f&&r.isBlanks&&r.getLocalizedLabel("Blanks").toLowerCase().indexOf(f.toLowerCase())>=0?(w=w.concat(n.generateNullValuePredicates(g)),d=n.generatePredicate(w),d.predicates.push(s),o.where(d)):f.length?(s=t.isNullOrUndefined(c)?s:s.and(c.e),o.where(s)):t.isNullOrUndefined(c)||o.where(c.e);a.filterChoiceCount=t.isNullOrUndefined(a.filterChoiceCount)?1e3:a.filterChoiceCount;b={};bt.showSpinner(r.spinner);r.renderEmpty=!1;r.isForeignColumn(e)&&f.length?("result"in e.dataSource?new u.DataManager(e.dataSource.result):e.dataSource).executeQuery(o).then(function(n){var t=r.options.column.columnData;r.options.column.columnData=n.result;r.parent.notify(kf,{predicate:b,column:e});b.predicate.predicates.length?h.where(b.predicate):r.renderEmpty=!0;r.options.column.columnData=t;h.take(a.filterChoiceCount);r.search(a,h)}):(o.take(a.filterChoiceCount),r.search(a,o))})},n.prototype.search=function(n,t){this.parent.dataSource&&"result"in this.parent.dataSource?this.filterEvent(n,t):this.processSearch(t)},n.prototype.getPredicateFromCols=function(t,i){for(var f,e,h=n.getPredicate(t,i),r=[],o={},c=void 0!==this.parent.getForeignKeyColumns,a=c?this.parent.getForeignKeyColumns():[],s=0,l=Object.keys(h);s<l.length;s++)f=l[s],e=void 0,c&&!this.parent.getColumnByField(f)&&(e=lo(f,a)),e?(this.parent.notify(kf,{predicate:o,column:e}),o.predicate.predicates.length&&r.push(u.Predicate.or(o.predicate.predicates))):r.push(h[""+f]);return r.length&&u.Predicate.and(r)},n.prototype.getQuery=function(){return this.parent.getQuery?this.parent.getQuery().clone():new u.Query},n.prototype.getAllData=function(){var i=this,n,r;this.customQuery=!1;n=this.getQuery();n.requiresCount();this.addDistinct(n);r={requestType:py,query:n,filterChoiceCount:null};r.filterModel=this;this.parent.trigger(nt,r,function(r){r.filterChoiceCount=t.isNullOrUndefined(r.filterChoiceCount)?1e3:r.filterChoiceCount;n.take(r.filterChoiceCount);r.query.distincts.length||(i.customQuery=!0,i.queryGenerate(n));i.parent.dataSource&&"result"in i.parent.dataSource?i.filterEvent(r,n):i.processDataOperation(n,!0)})},n.prototype.addDistinct=function(n){var t=u.DataUtil.distinct(this.options.filteredColumns,"field");return t.indexOf(this.options.column.field)<=-1&&(t=t.concat(this.options.column.field)),n.distinct(t),n},n.prototype.filterEvent=function(n,t){var r=this,i=lv(n,t);this.parent.trigger(be,i.state);i.deffered.promise.then(function(n){r.dataSuccess(n)})},n.prototype.processDataOperation=function(n,t){var o=this,i,r,f,e;this.options.dataSource=this.options.dataSource instanceof u.DataManager?this.options.dataSource:new u.DataManager(this.options.dataSource);i=[];r=[];this.isForeignColumn(this.options.column)&&t&&(f="result"in this.options.column.dataSource?new u.DataManager(this.options.column.dataSource.result):this.options.column.dataSource,this.foreignKeyQuery.params=n.params,i.push(f.executeQuery(this.foreignKeyQuery)),r.push(function(n){return o.foreignKeyData=n}));i.push(this.options.dataSource.executeQuery(n));r.push(this.dataSuccess.bind(this));e=0;Promise.all(i).then(function(n){for(var t=0;t<n.length;t++)r[e++](n[parseInt(t.toString(),10)].result)})},n.prototype.dataSuccess=function(t){var i,r,e,o,s,f;this.fullData=t;i={dataSource:this.fullData,executeQuery:!0,field:this.options.field};(this.parent.notify(itt,i),i.executeQuery)&&(r=new u.Query,this.customQuery||(this.isExecuteLocal=!0,this.queryGenerate(r),this.isExecuteLocal=!1),e=new u.DataManager(i.dataSource).executeLocal(r),o=this.options.column,this.filteredData=n.getDistinct(e,this.options.field,o,this.foreignKeyData).records||[]);s=i.executeQuery?this.filteredData:i.dataSource;this.processDataSource(null,!0,s,i);this.sInput&&this.sInput.focus();f={requestType:wy,columnName:this.options.field,columnType:this.options.type};f.filterModel=this;this.parent.notify(df,f);this.isCheckboxFilterTemplate&&bt.hideSpinner(this.spinner)},n.prototype.queryGenerate=function(n){var t,e,u,i,r,f;if(this.parent.searchSettings&&this.parent.searchSettings.key.length&&(t=this.parent.searchSettings,e=t.fields.length?t.fields:this.options.columns.map(function(n){return n.field}),n.search(t.key,e,t.operator,t.ignoreCase,t.ignoreAccent)),this.options.filteredColumns.length){for(u=[],i=0;i<this.options.filteredColumns.length;i++)r=this.options.filteredColumns[parseInt(i.toString(),10)],this.options.uid?(r.uid=r.uid||this.parent.getColumnByField(r.field).uid,r.uid!==this.options.uid&&u.push(this.options.filteredColumns[parseInt(i.toString(),10)])):r.field!==this.options.field&&u.push(this.options.filteredColumns[parseInt(i.toString(),10)]);f=this.getPredicateFromCols(u,this.isExecuteLocal);f&&n.where(f)}},n.prototype.processDataSource=function(n,t,i,r){bt.showSpinner(this.spinner);this.isExecuteLocal=!0;this.updateResult();this.isExecuteLocal=!1;var u={dataSource:this.fullData,isCheckboxFilterTemplate:!1,column:this.options.column,element:this.cBox,type:this.options.type,format:this.options.type,btnObj:this.options.isResponsiveFilter?null:this.dialogObj.btnObj[0],searchBox:this.searchBox};this.parent.notify(ptt,u);this.isCheckboxFilterTemplate=u.isCheckboxFilterTemplate;this.isCheckboxFilterTemplate||this.createFilterItems(i,t,r)},n.prototype.processSearch=function(n){this.processDataOperation(n)},n.prototype.updateResult=function(){var i,n,t,r,f;for(this.result={},i=this.getPredicateFromCols(this.options.filteredColumns,this.isExecuteLocal),n=new u.Query,i&&n.where(i),this.parent.notify(vtt,{query:n}),t=0,r=new u.DataManager(this.fullData).executeLocal(n);t<r.length;t++)f=r[t],this.result[ut(this.options.field,f)]=!0},n.prototype.clickHandler=function(n){var u=n.target,r,f;(t.isNullOrUndefined(this.parent.loadingIndicator)||"Shimmer"!==this.parent.loadingIndicator.indicatorType||!i(u,"e-mask-ftrchk"))&&(r=i(u,"e-checkbox-wrapper"),(i(u,"e-searchbox")&&this.searchBoxClick(n),r&&!this.isCheckboxFilterTemplate)&&(f=r.querySelector(".e-selectall"),f?this.updateAllCBoxes(!f.classList.contains("e-check")):hb(r.parentElement),this.updateIndeterminatenBtn(),r.querySelector(".e-chk-hidden").focus()),this.setFocus(i(r,"e-ftrchk")))},n.prototype.keyupHandler=function(n){this.setFocus(i(n.target,"e-ftrchk"))},n.prototype.setFocus=function(n){var t=this.dlg.querySelector(".e-chkfocus");t&&t.classList.remove("e-chkfocus");n&&n.classList.add("e-chkfocus")},n.prototype.updateAllCBoxes=function(n){for(var r,t=0,i=[].slice.call(this.cBox.querySelectorAll(".e-frame:not(.e-add-current)"));t<i.length;t++)r=i[t],ho(r,n),ef(r.previousSibling,n)},n.prototype.dialogOpen=function(){this.parent.element.classList.contains("e-device")&&(this.dialogObj.element.querySelector(".e-input-group").classList.remove("e-input-focus"),this.options.isResponsiveFilter||this.dialogObj.element.querySelector(".e-btn").focus())},n.prototype.createCheckbox=function(n,i,r){var f=i?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0),u,e,o,s;return ef(f.querySelector("input"),i),u=f.querySelector(".e-label"),e=bh({},r,{column:this.options.column,parent:this.parent}),(u[this.options.disableHtmlEncode?"textContent":"innerHTML"]=!t.isNullOrUndefined(n)&&n.toString().length?this.parent.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(n):n:this.getLocalizedLabel("Blanks"),u.innerHTML===this.getLocalizedLabel("Blanks")&&(this.isBlanks=!0),"boolean"==typeof n&&(u.innerHTML=!0===n?this.getLocalizedLabel("FilterTrue"):this.getLocalizedLabel("FilterFalse")),t.addClass([u],["e-checkboxfiltertext"]),this.options.template&&r[this.options.column.field]!==this.getLocalizedLabel("SelectAll")&&r[this.options.column.field]!==this.getLocalizedLabel("AddCurrentSelection"))&&(u.innerHTML="",o=this.parent.isReact&&this.options.column.filter&&"string"!=typeof this.options.column.filter.itemTemplate,s=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,o||s?(this.options.template(e,this.parent,"filterItemTemplate",null,null,null,u),this.parent.renderTemplates()):kt(u,this.options.template(e,this.parent,"filterItemTemplate"))),f},n.prototype.updateIndeterminatenBtn=function(){var n,f=this.cBox.children.length-1,r=[],e=!1,u=this.cBox.querySelector(".e-selectall"),o=this.cBox.querySelectorAll(".e-check:not(.e-selectall):not(.e-add-current)").length,i;this.cBox.querySelector(".e-add-current")&&(f-=1);this.options.isResponsiveFilter||((n=this.dialogObj.btnObj[0]).disabled=!1);i=u.previousSibling;ef(i,!1);i.indeterminate=!1;f===o?(r=["e-check"],ef(i,!0)):o?(r=["e-stop"],i.indeterminate=!0):(r=["e-uncheck"],e=!0,n&&(n.disabled=!0));n&&(this.filterState=!n.disabled,n.dataBind());t.removeClass([u],["e-check","e-stop","e-uncheck"]);t.addClass([u],r);this.parent.notify(ua,{disabled:e})},n.prototype.createFilterItems=function(n,i,r){var rt,ut,e,s=this.parent.createElement("div"),v=!1,h,c,f,y,p,w,b,k,l,ft,d,g,nt,a,o,tt,et,it;for(this.options.isResponsiveFilter||(e=this.dialogObj.btnObj[0]),h=-1,c="ejValue",r.executeQuery||(c=r.field),f=0;f<n.length;f++)y=t.getValue(c,n[parseInt(f.toString(),10)]),(""===y||t.isNullOrUndefined(y))&&(h+=1);if(this.itemsCnt=-1!==h?n.length-h:n.length,n.length&&!this.renderEmpty){for(p=this.getLocalizedLabel("SelectAll"),w=this.cBox.querySelector(".e-checkfltrnmdiv"),w&&w.classList.remove("e-checkfltrnmdiv"),b=this.createCheckbox(p,!1,((rt={})[this.options.field]=p,rt)),this.parent.cssClass&&t.addClass([b],[this.parent.cssClass]),k=vh(tr("cbox"),b,"e-ftrchk"),k.querySelector(".e-frame").classList.add("e-selectall"),s.appendChild(k),l=new u.Predicate("field","equal",this.options.field),this.options.foreignKeyValue&&(l=l.or("field","equal",this.options.foreignKeyValue)),ft=new u.DataManager(this.options.filteredColumns).executeLocal((new u.Query).where(l)).length,this.sInput.value&&(d=this.createCheckbox(this.getLocalizedLabel("AddCurrentSelection"),!1,((ut={})[this.options.field]=this.getLocalizedLabel("AddCurrentSelection"),ut)),this.parent.cssClass&&t.addClass([d],[this.parent.cssClass]),g=vh(tr("cbox"),d,"e-ftrchk"),g.querySelector(".e-frame").classList.add("e-add-current"),s.appendChild(g)),nt=void 0,f=0;f<n.length;f++){if(a=tr("cbox"),this.values[""+a]=t.getValue(c,n[parseInt(f.toString(),10)]),o=t.getValue(this.options.field,n[parseInt(f.toString(),10)]),this.options.formatFn&&(o=this.valueFormatter.toView(o,this.options.formatFn)),tt={value:o,column:this.options.column,data:n[parseInt(f.toString(),10)]},this.parent.notify(kn,tt),""===(o=tt.value)||t.isNullOrUndefined(o)){if(nt)continue;nt=!0}et=this.createCheckbox(o,this.getCheckedState(ft,this.values[""+a]),t.getValue("dataObj",n[parseInt(f.toString(),10)]));s.appendChild(vh(a,et,"e-ftrchk"))}this.cBox.innerHTML="";kt(this.cBox,[].slice.call(s.children));this.updateIndeterminatenBtn();e&&(e.disabled=!1);v=!1}else s.appendChild(this.parent.createElement("span",{innerHTML:this.getLocalizedLabel("NoResult")})),this.cBox.innerHTML="",this.cBox.appendChild(this.parent.createElement("div",{className:"e-checkfltrnmdiv"})),kt(this.cBox.children[0],[].slice.call(s.children)),e&&(e.disabled=!0),v=!0;e&&n.length&&(this.filterState=!e.disabled,e.dataBind());it={requestType:py,dataSource:this.renderEmpty?[]:n};it.filterModel=this;this.parent.notify(df,it);this.parent.notify(ua,{disabled:v});bt.hideSpinner(this.spinner)},n.prototype.getCheckedState=function(n,t){if(this.isFiltered&&n){var i=!!this.sInput.value||this.result[""+t];return"notequal"===this.options.operator?!i:i}return!0},n.getDistinct=function(n,i,r,f){for(var o,h,e,s=n.length,c=[],l={},a=!(!r||!r.isForeignColumn)&&r.isForeignColumn();s--;)(e=ut(i,e=n[parseInt(s.toString(),10)]))in l||(o={},(o.ejValue=e,l[""+e]=!0,a)&&(h=cu(r,{},e,f)[0],t.setValue(lp,h,n[parseInt(s.toString(),10)]),e=t.getValue(r.foreignKeyValue,h)),t.setValue(i,t.isNullOrUndefined(e)?null:e,o),t.setValue("dataObj",n[parseInt(s.toString(),10)],o),c.push(o));return u.DataUtil.group(u.DataUtil.sort(c,i,u.DataUtil.fnAscending),"ejValue")},n.getPredicate=function(t,i){for(var f=u.DataUtil.distinct(t,"field",!0)||[],e=[],o={},r=0;r<f.length;r++)0!==(e=new u.DataManager(t).executeLocal((new u.Query).where("field","equal",f[parseInt(r.toString(),10)].field))).length&&(o[f[parseInt(r.toString(),10)].field]=n.generatePredicate(e,i));return o},n.generatePredicate=function(i,r){var o,s=i?i.length:0,e=n.updateDateFilter(i[0]),f;for(e.ignoreAccent=!t.isNullOrUndefined(e.ignoreAccent)&&e.ignoreAccent,o="date"===e.type||"datetime"===e.type||"dateonly"===e.type?au(e,e.type,r):e.ejpredicate?e.ejpredicate:new u.Predicate(e.field,e.operator,e.value,!n.getCaseValue(e),e.ignoreAccent),f=1;f<s;f++)i[parseInt(f.toString(),10)]=n.updateDateFilter(i[parseInt(f.toString(),10)]),s>2&&f>1&&"or"===i[parseInt(f.toString(),10)].predicate?"date"===i[parseInt(f.toString(),10)].type||"datetime"===i[parseInt(f.toString(),10)].type||"dateonly"===i[parseInt(f.toString(),10)].type?o.predicates.push(au(i[parseInt(f.toString(),10)],i[parseInt(f.toString(),10)].type,r)):o.predicates.push(new u.Predicate(i[parseInt(f.toString(),10)].field,i[parseInt(f.toString(),10)].operator,i[parseInt(f.toString(),10)].value,!n.getCaseValue(i[parseInt(f.toString(),10)]),i[parseInt(f.toString(),10)].ignoreAccent)):o="date"===i[parseInt(f.toString(),10)].type||"datetime"===i[parseInt(f.toString(),10)].type||"dateonly"===i[parseInt(f.toString(),10)].type?"and"===i[parseInt(f.toString(),10)].predicate&&"equal"===i[parseInt(f.toString(),10)].operator?o.or(au(i[parseInt(f.toString(),10)],i[parseInt(f.toString(),10)].type,r),i[parseInt(f.toString(),10)].type,i[parseInt(f.toString(),10)].ignoreAccent):o[i[parseInt(f.toString(),10)].predicate](au(i[parseInt(f.toString(),10)],i[parseInt(f.toString(),10)].type,r),i[parseInt(f.toString(),10)].type,i[parseInt(f.toString(),10)].ignoreAccent):i[parseInt(f.toString(),10)].ejpredicate?o[i[parseInt(f.toString(),10)].predicate](i[parseInt(f.toString(),10)].ejpredicate):o[i[parseInt(f.toString(),10)].predicate](i[parseInt(f.toString(),10)].field,i[parseInt(f.toString(),10)].operator,i[parseInt(f.toString(),10)].value,!n.getCaseValue(i[parseInt(f.toString(),10)]),i[parseInt(f.toString(),10)].ignoreAccent);return o||null},n.getCaseValue=function(n){return t.isNullOrUndefined(n.matchCase)?!("string"===n.type||t.isNullOrUndefined(n.type)&&"string"==typeof n.value):n.matchCase},n.updateDateFilter=function(n){return("date"===n.type||"datetime"===n.type||"dateonly"===n.type||n.value instanceof Date)&&(n.type=n.type||"date"),n},n}();const dr=ejdashboard.dropdowns,se=ejdashboard.calendars,wo=ejdashboard.navigations;var eht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uut=function(n){function r(t,i){var r=n.call(this,t)||this;return r.childRefs=[],r.eventHandlers={},r.isDevice=!1,r.customFilterOperators=i,r.isExcel=!0,r}return eht(r,n),r.prototype.getCMenuDS=function(n,t){var i={number:["Equal","NotEqual","","LessThan","LessThanOrEqual","GreaterThan","GreaterThanOrEqual","Between","","CustomFilter"],string:["Equal","NotEqual","","StartsWith","EndsWith","","Contains","NotContains","","CustomFilter"]},u,r;for(i.date=i.number,i.datetime=i.number,i.dateonly=i.number,u=[],r=0;r<i[""+n].length;r++)i[""+n][parseInt(r.toString(),10)].length?t?u.push({text:this.getLocalizedLabel(i[""+n][parseInt(r.toString(),10)])+"...",iconCss:"e-icons e-icon-check "+(t===i[""+n][parseInt(r.toString(),10)].toLowerCase()?"":"e-emptyicon")}):u.push({text:this.getLocalizedLabel(i[""+n][parseInt(r.toString(),10)])+"..."}):u.push({separator:!0});return u},r.prototype.destroy=function(){if(this.dlg&&(this.unwireExEvents(),n.prototype.closeDialog.call(this)),!this.isDevice&&this.menuObj){var t=this.menuObj.element.querySelector("li.e-focused");t&&i(t,"e-excel-menu")||this.destroyCMenu()}this.dlgObj&&!this.dlgObj.isDestroyed&&this.removeDialog()},r.prototype.createMenu=function(n,t,i,r){var u,f,s;if(this.menu=this.parent.createElement("div",{className:"e-contextmenu-wrapper"}),this.parent.enableRtl?this.menu.classList.add("e-rtl"):this.menu.classList.remove("e-rtl"),this.parent.cssClass&&this.menu.classList.add(this.parent.cssClass),u=this.parent.createElement("ul"),f=t?"e-excl-filter-icon e-filtered":"e-excl-filter-icon",this.parent.allowSorting&&"grid"===this.parent.getModuleName()&&!this.options.isResponsiveFilter){var e=this.parent.getColumnHeaderByUid(r.uid).getAttribute("aria-sort"),o=this.parent.getColumnByField(r.field).allowSorting,h=o&&"ascending"!==e?"e-excel-ascending":"e-disabled e-excel-ascending",c=o&&"descending"!==e?"e-excel-descending":"e-disabled e-excel-descending",l="string"===n?this.getLocalizedLabel("SortAtoZ"):"datetime"===n||"date"===n?this.getLocalizedLabel("SortByOldest"):this.getLocalizedLabel("SortSmallestToLargest"),a="string"===n?this.getLocalizedLabel("SortZtoA"):"datetime"===n||"date"===n?this.getLocalizedLabel("SortByNewest"):this.getLocalizedLabel("SortLargestToSmallest");u.appendChild(this.createMenuElem(l,h,"e-sortascending"));u.appendChild(this.createMenuElem(a,c,"e-sortdescending"));s=this.parent.createElement("li",{className:"e-separator e-menu-item e-excel-separator"});u.appendChild(s)}this.options.isResponsiveFilter||u.appendChild(this.createMenuElem(this.getLocalizedLabel("ClearFilter"),t?"":"e-disabled",f));"boolean"!==n&&u.appendChild(this.createMenuElem(this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",dateonly:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[""+n]),"e-submenu",i&&this.ensureTextFilter()?"e-icon-check":f+" e-emptyicon",!0));this.menu.appendChild(u);this.parent.notify(wn,{element:this.menu});this.parent.notify(ew,{isFiltered:t})},r.prototype.createMenuElem=function(n,t,i,r){var u=this.parent.createElement("li",{className:t+" e-menu-item"});return u.innerHTML=n,u.insertBefore(this.parent.createElement("span",{className:"e-menu-icon e-icons "+i,attrs:{"aria-hidden":"true"}}),u.firstChild),r&&u.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),u},r.prototype.wireExEvents=function(){t.EventHandler.add(this.dlg,"mouseover",this.hoverHandler,this);t.EventHandler.add(this.dlg,"click",this.clickExHandler,this)},r.prototype.unwireExEvents=function(){t.EventHandler.remove(this.dlg,"mouseover",this.hoverHandler);t.EventHandler.remove(this.dlg,"click",this.clickExHandler)},r.prototype.clickExHandler=function(n){var t=i(n.target,"e-menu-item");t&&(this.getLocalizedLabel("ClearFilter")===t.innerText.trim()?(this.clearFilter(),this.closeDialog()):this.options.isResponsiveFilter&&this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[this.options.type])===t.innerText.trim()&&this.hoverHandler(n))},r.prototype.destroyCMenu=function(){this.isCMenuOpen=!1;this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),t.remove(this.cmenu),this.parent.notify(fa,{target:null,header:"",isOpen:!1,col:this.options.column}))},r.prototype.hoverHandler=function(n){var e,o,a,s,r,h,v,c;if(!this.options.isResponsiveFilter||"mouseover"!==n.type){var f,y=n.target.querySelector(".e-contextmenu"),u=i(n.target,"e-menu-item"),l=this.menu.querySelector(".e-focused");(l&&l.classList.remove("e-focused"),u&&(u.classList.add("e-focused"),f=u.classList.contains("e-submenu")),y)||(f||(e=this.menu.querySelector(".e-submenu"),t.isNullOrUndefined(e)||e.classList.remove("e-selected"),this.destroyCMenu()),o=this.ensureTextFilter(),!this.isCMenuOpen&&f&&(u.classList.add("e-selected"),this.isCMenuOpen=!0,a={items:this.getCMenuDS(this.options.type,o?o.replace(/\s/g,""):void 0),select:this.selectHandler.bind(this),onClose:this.destroyCMenu.bind(this),enableRtl:this.parent.enableRtl,animationSettings:{effect:"None"},beforeClose:this.preventClose.bind(this),cssClass:this.options.isResponsiveFilter&&this.parent.cssClass?"e-res-contextmenu-wrapper "+this.parent.cssClass:this.options.isResponsiveFilter?"e-res-contextmenu-wrapper":this.parent.cssClass?this.parent.cssClass:""},this.parent.element.appendChild(this.cmenu),this.menuObj=new wo.ContextMenu(a,this.cmenu),s=this.menu.querySelector(".e-submenu").getBoundingClientRect(),r={top:0,left:0},this.options.isResponsiveFilter?(h=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4,this.menuObj.element.style.height="calc(100% - "+h+"px)",this.menuObj.open(h,0,document.body),v=this.getLocalizedLabel({string:"TextFilter",date:"DateFilter",datetime:"DateTimeFilter",number:"NumberFilter"}[this.options.type]),this.parent.notify(fa,{target:this.menuObj.element.parentElement,header:v,isOpen:!0})):(t.Browser.isDevice?(this.isDevice=!0,c=this.getContextBounds(),r.top=(window.innerHeight-c.height)/2,r.left=(window.innerWidth-c.width)/2,this.closeDialog(),this.isDevice=!1):(r.top=t.Browser.isIE?window.pageYOffset+s.top:window.scrollY+s.top,r.left=this.getCMenuYPosition(this.dlg)),this.menuObj.open(r.top,r.left,n.target)),ao(this.parent.element,this.menuObj.element.parentElement)))}},r.prototype.ensureTextFilter=function(){var t,n=this.existingPredicate[this.options.field];return n&&2===n.length?t="greaterthanorequal"===n[0].operator&&"lessthanorequal"===n[1].operator?"between":"customfilter":n&&1===n.length&&(this.optrData=this.customFilterOperators[this.options.type+"Operator"],t=n[0].operator),t},r.prototype.preventClose=function(n){if(this.options&&this.options.isResponsiveFilter&&n.event){var t=n.event.target,i=t.classList.contains("e-resfilterback")||t.classList.contains("e-res-back-btn")||t.classList.contains("e-menu-item");n.cancel=!i}else n.event instanceof MouseEvent&&n.event.target.classList.contains("e-submenu")&&(n.cancel=!0)},r.prototype.getContextBounds=function(){return this.menuObj.element.style.display="block",this.menuObj.element.getBoundingClientRect()},r.prototype.getCMenuYPosition=function(n){var r=this.getContextBounds().width,i=n.getBoundingClientRect(),u=i.right+r-this.parent.element.clientWidth,t=n.offsetWidth-n.clientWidth;return t=t?t+1:0,u<1?i.right+1-t:i.left-r-1+t},r.prototype.openDialog=function(n){var i=this,t;(this.updateModel(n),this.getAndSetChkElem(n),this.showDialog(n),n.cancel)||(this.dialogObj.dataBind(),t=this.existingPredicate[n.field]&&this.existingPredicate[n.field].length||this.options.filteredColumns.filter(function(n){return i.options.field===n.field}).length,this.createMenu(n.type,t>0,1===t||2===t,n),this.dlg.insertBefore(this.menu,this.dlg.firstChild),this.dlg.classList.add("e-excelfilter"),this.parent.enableRtl&&this.dlg.classList.add("e-rtl"),this.dlg.classList.remove("e-checkboxfilter"),this.cmenu=this.parent.createElement("ul",{className:"e-excel-menu"}),n.column.showColumnMenu&&this.parent.notify(we,{}),this.wireExEvents())},r.prototype.closeDialog=function(){this.destroy()},r.prototype.selectHandler=function(n){n.item&&(this.parent.notify(ow,{}),this.menuItem=n.item,this.renderDialogue(n))},r.prototype.renderDialogue=function(n){var i=this,e=n?n.element:void 0,r=this.options.field,u=!t.isNullOrUndefined(r)&&ir(r),f=!t.isNullOrUndefined(r)&&wt(r),o=this.parent.createElement("div",{className:"e-xlfl-maindiv",id:u?f+"-xlflmenu":r+"-xlflmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-xlflmenu",id:u?f+"-xlfldlg":r+"-xlfldlg"});this.options.isResponsiveFilter?document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new bt.Dialog({header:this.getLocalizedLabel("CustomFilter"),isModal:!0,overlayClick:this.removeDialog.bind(this),showCloseIcon:!0,closeOnEscape:!1,target:document.body,visible:!1,enableRtl:this.parent.enableRtl,open:function(){var n=i.dlgObj.element.querySelector("table.e-xlfl-table>tr");if(i.options.column.filterTemplate){var t=ir(i.options.column.field)?wt(i.options.column.field):i.options.column.field,r=i.parent.isReact&&"string"!=typeof i.options.column.filterTemplate,u=i.parent.parentDetails&&i.parent.parentDetails.parentInstObj&&i.parent.parentDetails.parentInstObj.isReact;r||u?i.parent.renderTemplates(function(){n.querySelector("#"+t+"-xlfl-frstvalue").focus()}):n.querySelector("#"+t+"-xlfl-frstvalue").focus()}},close:this.removeDialog.bind(this),created:this.createdDialog.bind(this,e,r),buttons:[{click:this.filterBtnClick.bind(this,r),buttonModel:{content:this.getLocalizedLabel("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-xlfl-okbtn "+this.parent.cssClass:"e-xlfl-okbtn"}},{click:this.removeDialog.bind(this),buttonModel:{content:this.getLocalizedLabel("CancelButton"),cssClass:this.parent.cssClass?"e-xlfl-cancelbtn "+this.parent.cssClass:"e-xlfl-cancelbtn"}}],content:o,width:430,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""});this.dlgObj.isStringTemplate=!0;this.renderResponsiveDialog();this.dlgDiv.setAttribute("aria-label",this.getLocalizedLabel("CustomFilterDialogARIA"));this.childRefs.push(this.dlgObj);this.dlgObj.appendTo(this.dlgDiv)},r.prototype.renderResponsiveDialog=function(){if(this.options.isResponsiveFilter){var n=document.querySelector(".e-row-responsive-filter");n&&n.classList.remove("e-row-responsive-filter");this.dlgObj.buttons=[{}];this.dlgObj.header=void 0;this.dlgObj.position={X:"",Y:""};this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-xl-customfilterdiv");this.dlgObj.width="100%";this.dlgObj.isModal=!1;this.dlgObj.showCloseIcon=!1}},r.prototype.removeDialog=function(){this.parent.notify(sw,{});(this.parent.isReact||this.parent.isVue)&&void 0!==this.parent.destroyTemplate&&yo(this.parent,["filterTemplate"]);this.removeObjects(this.childRefs);t.remove(this.dlgDiv);this.parent.notify(bs,{})},r.prototype.createdDialog=function(n,i){if(this.renderCustomFilter(n,i),this.dlgObj.element.style.left="0px",this.options.isResponsiveFilter){var r=document.querySelector(".e-responsive-dialog > .e-dlg-header-content").offsetHeight+4;this.dlgObj.element.style.top=r+"px"}else this.dlgObj.element.style.top="0px";!this.options.isResponsiveFilter&&t.Browser.isDevice&&window.innerWidth<440&&(this.dlgObj.element.style.width="90%");this.parent.notify(pn,{column:i,dialog:this.dialogObj});this.dlgObj.show();ao(this.parent.element,this.dlgObj.element.parentElement)},r.prototype.renderCustomFilter=function(n,t){var i=this.dlgObj.element.querySelector(".e-xlfl-maindiv"),u=this.parent.createElement("div",{innerHTML:this.getLocalizedLabel("ShowRowsWhere"),className:"e-xlfl-dlgfields"}),r;i.appendChild(u);r=this.parent.createElement("div",{innerHTML:this.options.displayName,className:"e-xlfl-fieldset"});i.appendChild(r);this.renderFilterUI(t,i)},r.prototype.filterBtnClick=function(n){var u,e=!t.isNullOrUndefined(n)&&ir(n),o=!t.isNullOrUndefined(n)&&wt(n),i=e?o:n,s=this.dlgDiv.querySelector("#"+i+"-xlfl-frstvalue").ej2_instances[0],h=this.dlgDiv.querySelector("#"+i+"-xlfl-frstoptr").ej2_instances[0],f=this.dlgDiv.querySelector("#"+i+"-xlfl-secndvalue").ej2_instances[0],c=this.dlgDiv.querySelector("#"+i+"-xlfl-secndoptr").ej2_instances[0],r;"string"===this.options.type&&(u=this.dlgDiv.querySelector("#"+i+"-xlflmtcase").ej2_instances[0].checked);r=this.dlgDiv.querySelector("#"+i+"e-xlfl-frstpredicate").ej2_instances[0].checked?"and":"or";null===f.value&&(r="or");this.filterByColumn(this.options.field,h.value,s.value,r,u,this.options.ignoreAccent,c.value,f.value);this.removeDialog()},r.prototype.filterByColumn=function(n,i,r,f,e,o,s,h){var c,y=this.parent.getColumnByField?this.parent.getColumnByField(n):this.options.column,v=this.isForeignColumn(y)?y.foreignKeyValue:n,l=[],a={instance:this,handler:this.filterByColumn,arg1:n,arg2:i,arg3:r,arg4:f,arg5:e,arg6:o,arg7:s,arg8:h,cancel:!1},p;(this.parent.notify(ge,a),a.cancel)||(l.push({field:v,predicate:f,matchCase:e,ignoreAccent:o,operator:i,value:a.arg3,type:this.options.type}),c=new u.Predicate(v,i.toLowerCase(),a.arg3,!e,o),t.isNullOrUndefined(h)||t.isNullOrUndefined(s)||(l.push({field:v,predicate:f,matchCase:e,ignoreAccent:o,operator:s,value:a.arg8,type:this.options.type}),c=c[""+f](v,s.toLowerCase(),h,!e,o)),p={action:"filtering",filterCollection:l,field:this.options.field,ejpredicate:c,actualPredicate:l},this.isForeignColumn(y)?this.foreignKeyFilter(p,l,c):this.options.handler(p))},r.prototype.renderOperatorUI=function(n,i,r,u,f){var c=this.parent.createElement("tr",{className:"e-xlfl-fields"}),l,y,a,o,h,p,s,w;i.appendChild(c);l=this.parent.createElement("td",{className:"e-xlfl-optr"});c.appendChild(l);var v=this.parent.createElement("div",{className:"e-xlfl-optrdiv"}),b=!t.isNullOrUndefined(n)&&ir(n),k=!t.isNullOrUndefined(n)&&wt(n),e=this.parent.createElement("input",{id:b?k+r:n+r});return v.appendChild(e),l.appendChild(v),y=this.options.type+"Operator",a=this.customFilterOperators[""+y],this.optrData=a,o=this.dropSelectedVal(this.options.column,u,f),h="",this.menuItem&&((h=this.menuItem.text.slice(0,-3))!==this.getLocalizedLabel("CustomFilter")&&(o=f?h:void 0),h===this.getLocalizedLabel("Between")&&(o=this.getLocalizedLabel(f?"GreaterThanOrEqual":"LessThanOrEqual"))),p=this.options.column,s=new dr.DropDownList(ff({dataSource:a,fields:{text:"text",value:"value"},text:o,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:null},p.filter.params)),this.childRefs.push(s),w={open:this.dropDownOpen.bind(this),change:this.dropDownValueChange.bind(this)},bb(e.id,[bi,te],w,this),s.addEventListener(bi,this.eventHandlers[e.id][bi]),s.addEventListener(te,this.eventHandlers[e.id][te]),s.appendTo(e),{fieldElement:c,operator:this.getSelectedValue(o)}},r.prototype.removeHandlersFromComponent=function(n){n.element.classList.contains("e-dropdownlist")?kb(n,[bi,te],this):n.element.classList.contains("e-autocomplete")&&kb(n,[l,ie],this)},r.prototype.dropDownOpen=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},r.prototype.dropDownValueChange=function(n){n.element.id.includes("-xlfl-frstoptr")?this.firstOperator=n.value.toString():this.secondOperator=n.value.toString()},r.prototype.getFilterUIInfo=function(){return{firstOperator:this.firstOperator,secondOperator:this.secondOperator,field:this.options.field}},r.prototype.getSelectedValue=function(n){var i=new u.DataManager(this.optrData).executeLocal((new u.Query).where("text","equal",n));return t.isNullOrUndefined(i[0])?"":i[0].value},r.prototype.dropSelectedVal=function(n,t,i){var r;return r=t&&t.length>0?2===t.length?i?t[0].operator:t[1].operator:i?t[0].operator:void 0:i&&"string"===n.type&&!n.filter.operator?"startswith":i?n.filter.operator||"equal":void 0,this.getSelectedText(r)},r.prototype.getSelectedText=function(n){var i=new u.DataManager(this.optrData).executeLocal((new u.Query).where("value","equal",n));return t.isNullOrUndefined(i[0])?"":i[0].text},r.prototype.renderFilterUI=function(n,t){var r=this.existingPredicate[""+n],u=this.parent.createElement("table",{className:"e-xlfl-table",attrs:{role:"grid"}}),f,i,e;t.appendChild(u);f=this.parent.createElement(c);f.innerHTML='<col style="width: 50%"><\/col><col style="width: 50%"><\/col>';u.appendChild(f);i=this.renderOperatorUI(n,u,"-xlfl-frstoptr",r,!0);this.firstOperator=i.operator;this.renderFlValueUI(n,i,"-xlfl-frstvalue",r,!0);e=this.parent.createElement("tr",{className:"e-xlfl-predicate"});u.appendChild(e);this.renderRadioButton(n,e,r);i=this.renderOperatorUI(n,u,"-xlfl-secndoptr",r,!1);this.secondOperator=i.operator;this.renderFlValueUI(n,i,"-xlfl-secndvalue",r,!1)},r.prototype.renderRadioButton=function(n,i,r){var e=this.parent.createElement("td",{className:"e-xlfl-radio",attrs:{colSpan:"2"}}),u,f;i.appendChild(e);var o=this.parent.createElement("div",{className:"e-xlfl-radiodiv",attrs:{style:"display: inline-block"}}),s=!t.isNullOrUndefined(n)&&ir(n),h=!t.isNullOrUndefined(n)&&wt(n),c=this.parent.createElement("input",{id:s?h+"e-xlfl-frstpredicate":n+"e-xlfl-frstpredicate",attrs:{type:"radio"}}),l=this.parent.createElement("input",{id:s?h+"e-xlfl-secndpredicate":n+"e-xlfl-secndpredicate",attrs:{type:"radio"}});o.appendChild(c);o.appendChild(l);e.appendChild(o);"string"===this.options.type&&this.renderMatchCase(n,i,e,"-xlflmtcase",r);u=new fi.RadioButton({label:this.getLocalizedLabel("AND"),name:"default",checked:!0,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(u);f=new fi.RadioButton({label:this.getLocalizedLabel("OR"),name:"default",enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(f);"and"===(r&&2===r.length?r[1].predicate:"and")?(u.checked=!0,f.checked=!1):(f.checked=!0,u.checked=!1);u.appendTo(c);f.appendTo(l);u.element.nextElementSibling.classList.add("e-xlfl-radio-and");f.element.nextElementSibling.classList.add("e-xlfl-radio-or")},r.prototype.removeObjects=function(n){for(var t,i=0,r=n;i<r.length;i++)t=r[i],t&&!t.isDestroyed&&(this.removeHandlersFromComponent(t),t.destroy())},r.prototype.renderFlValueUI=function(n,i,r,u,f){var h=this.parent.createElement("td",{className:"e-xlfl-value"}),o,v,k,y,s,c;i.fieldElement.appendChild(h);var l=!t.isNullOrUndefined(n)&&ir(n),a=!t.isNullOrUndefined(n)&&wt(n),e=this.parent.createElement("div",{className:"e-xlfl-valuediv"}),d=this.options.filteredColumns.some(function(t){return n===t.field}),g=this.options.filteredColumns.filter(function(t){return t.field===n});if(this.options.column.filterTemplate){o={};v=this.options.column;d&&r&&(o=this.getExcelFilterData(r,o,v,u,g));var p=this.parent.isReact&&"string"!=typeof this.options.column.filterTemplate,w=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,b=this.parent.element.id+v.uid+"filterTemplate";p||w?this.options.column.getFilterTemplate()(o,this.parent,"filterTemplate",b,null,null,e):(k=this.options.column.getFilterTemplate()(o,this.parent,"filterTemplate",b),kt(e,k));p||w?this.parent.renderTemplates(function(){e.querySelector("input").id=l?a+r:n+r;h.appendChild(e)}):((this.parent.isAngular?e.children[0]:e.querySelector("input")).id=l?a+r:n+r,h.appendChild(e))}else y=this.parent.createElement("input",{id:l?a+r:n+r}),e.appendChild(y),h.appendChild(e),s=void 0,c=void 0,u&&u.length>0&&(s=(c=2===u.length?f?u[0]:u[1]:f?u[0]:void 0)&&c.operator===i.operator?c.value:void 0,t.isNullOrUndefined(s)&&(s=void 0)),{string:this.renderAutoComplete.bind(this),number:this.renderNumericTextBox.bind(this),date:this.renderDate.bind(this),dateonly:this.renderDate.bind(this),datetime:this.renderDateTime.bind(this)}[this.options.type](this.options,n,y,s,this.parent.enableRtl)},r.prototype.getExcelFilterData=function(n,t,i,r,u){var e="-xlfl-frstvalue"===n?0:1,f;return("-xlfl-frstvalue"===n||u.length>1)&&(t={column:r instanceof Array?r[parseInt(e.toString(),10)]:r},f=this.options.column.columnData&&u.length>1?1===this.options.column.columnData.length?0:1:e,t[this.options.field]=i.foreignKeyValue?this.options.column.columnData[parseInt(f.toString(),10)][i.foreignKeyValue]:u[parseInt(f.toString(),10)].value,this.options.foreignKeyValue&&(t[this.options.foreignKeyValue]=this.options.column.columnData[parseInt(f.toString(),10)][i.foreignKeyValue])),t},r.prototype.renderMatchCase=function(n,i,r,u,f){var o=this.parent.createElement("div",{className:"e-xlfl-matchcasediv",attrs:{style:"display: inline-block"}}),c=!t.isNullOrUndefined(n)&&ir(n),l=!t.isNullOrUndefined(n)&&wt(n),s=this.parent.createElement("input",{id:c?l+u:n+u,attrs:{type:"checkbox"}}),h,e;o.appendChild(s);r.appendChild(o);h=!!(f&&f.length>0)&&(f&&2===f.length?f[1].matchCase:f[0].matchCase);e=new fi.CheckBox({label:this.getLocalizedLabel("MatchCase"),enableRtl:this.parent.enableRtl,checked:h,cssClass:this.parent.cssClass?this.parent.cssClass:""});this.childRefs.push(e);e.appendTo(s)},r.prototype.renderDate=function(n,t,i,r,u){var e=ph(n.format,n.type)||n.format,f=new se.DatePicker(ff({format:e,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:u,value:new Date(r),locale:this.parent.locale},n.column.filter.params));this.childRefs.push(f);f.appendTo(i)},r.prototype.renderDateTime=function(n,t,i,r,u){var e=ph(n.format,n.type),f=new se.DateTimePicker(ff({format:e,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:this.getLocalizedLabel("CustomFilterDatePlaceHolder"),width:"100%",enableRtl:u,value:new Date(r),locale:this.parent.locale},n.column.filter.params));this.childRefs.push(f);f.appendTo(i)},r.prototype.completeAction=function(n){n.result=crt(n.result)},r.prototype.renderNumericTextBox=function(n,t,i,r,u){var f=new kr.NumericTextBox(ff({format:n.format,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:u,value:r,locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},n.column.filter.params));this.childRefs.push(f);f.appendTo(i)},r.prototype.renderAutoComplete=function(n,t,i,r,f){var s=this.options.column,c=this.isForeignColumn(s),o=c?s.dataSource:n.dataSource,v={value:c?s.foreignKeyValue:t},e=new dr.AutoComplete(ff({dataSource:o instanceof u.DataManager?o:new u.DataManager(o),fields:v,query:this.getQuery(),sortOrder:"Ascending",locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:this.getLocalizedLabel("CustomFilterPlaceHolder"),enableRtl:f,text:r},s.filter.params)),h,a;o&&"result"in o&&(h=lv({requestType:"stringfilterrequest"},this.getQuery()),this.parent.trigger(be,h.state),h.deffered.promise.then(function(n){e.dataSource=new u.DataManager(n)}));this.childRefs.push(e);a={actionComplete:this.acActionComplete(e,t),focus:this.acFocus(e,t,n,i)};bb(i.id,[l,ie],a,this);e.addEventListener(ie,this.eventHandlers[i.id][ie]);e.addEventListener(l,this.eventHandlers[i.id][l]);e.appendTo(i)},r.prototype.acActionComplete=function(n,i){return function(r){var u=!t.isNullOrUndefined(i)&&ir(i);r.result=r.result.filter(function(t,i,r){return r.map(function(t){return u?pv(n.fields.value,t):t[n.fields.value]}).indexOf(u?pv(n.fields.value,t):t[n.fields.value])===i})}},r.prototype.acFocus=function(n,i,r,u){var f=this;return function(){var o=!t.isNullOrUndefined(i)&&ir(i),s=!t.isNullOrUndefined(i)&&wt(i),e=o?s:i;n.filterType=f.dlgDiv.querySelector("#"+e+(u.id===e+"-xlfl-frstvalue"?"-xlfl-frstoptr":"-xlfl-secndoptr")).ej2_instances[0].value;n.ignoreCase="string"!==r.type||!f.dlgDiv.querySelector("#"+e+"-xlflmtcase").ej2_instances[0].checked;n.filterType=t.isNullOrUndefined(n.filterType)?"equal":n.filterType}},r}(ru),bo=function(){function n(n,t,i,r){this.contentRefresh=!0;this.isModelChanged=!0;this.aria=new oh;this.currentTarget=null;this.parent=n;this.sortSettings=t;this.sortedColumns=i;this.serviceLocator=r;this.focus=r.getService("focus");this.addEventListener();this.setFullScreenDialog()}return n.prototype.updateModel=function(){var f,r={field:this.columnName,direction:this.direction},n=this.parent.groupSettings.columns,e=!1,u;if(this.isMultiSort)(f=this.getSortedColsIndexByField(this.columnName))>-1&&this.sortSettings.columns.splice(f,1),this.sortSettings.columns.push(r),this.sortSettings.columns=this.sortSettings.columns;else if(n.length){for(var t=[],i=0,o=n.length;i<o;i++)(f=this.getSortedColsIndexByField(n[parseInt(i.toString(),10)],t),this.columnName===n[parseInt(i.toString(),10)])?(e=!0,t.push(r)):(u=this.getSortColumnFromField(n[parseInt(i.toString(),10)]),t.push({field:u.field,direction:u.direction,isFromGroup:u.isFromGroup}));e||t.push(r);this.sortSettings.columns=t}else this.sortSettings.columns=[r];this.parent.dataBind();this.lastSortedCol=this.columnName},n.prototype.onActionComplete=function(n){var i=this.isRemove?{requestType:"sorting",type:l}:{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:l};this.isRemove=!1;this.parent.trigger(l,t.extend(n,i))},n.prototype.sortColumn=function(n,t,i){var r=this.parent;!1===this.parent.getColumnByField(n).allowSorting||this.parent.isContextMenuOpen()?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:n}):(r.allowMultiSorting||(i=r.allowMultiSorting),this.isActionPrevent()?r.notify(ci,{instance:this,handler:this.sortColumn,arg1:n,arg2:t,arg3:i}):(this.backupSettings(),this.columnName=n,this.direction=t,this.isMultiSort=i,this.removeSortIcons(),this.updateSortedCols(n,i),this.updateModel()))},n.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,g.isSort)},n.prototype.backupSettings=function(){this.lastSortedCols=eo(this.sortSettings.columns);this.lastCols=this.sortedColumns},n.prototype.restoreSettings=function(){this.isModelChanged=!1;this.isMultiSort=!0;this.parent.setProperties({sortSettings:{columns:this.lastSortedCols}},!0);this.sortedColumns=this.lastCols;this.isModelChanged=!0},n.prototype.updateSortedCols=function(n,t){if(!t)if(this.parent.allowGrouping)for(var i=0,r=this.sortedColumns.length;i<r;i++)this.parent.groupSettings.columns.indexOf(this.sortedColumns[parseInt(i.toString(),10)])<0&&(this.sortedColumns.splice(i,1),r--,i--);else this.sortedColumns.splice(0,this.sortedColumns.length);this.sortedColumns.indexOf(n)<0&&this.sortedColumns.push(n)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){if(this.contentRefresh){var t=this.sortSettings.columns.length?{columnName:this.columnName,direction:this.direction,requestType:"sorting",type:nt,target:this.currentTarget,cancel:!1}:{requestType:"sorting",type:nt,cancel:!1,target:this.currentTarget};this.parent.notify(pt,t)}this.refreshSortSettings();this.removeSortIcons();this.addSortIcons()}},n.prototype.refreshSortSettings=function(){this.sortedColumns.length=0;for(var t=this.sortSettings.columns,n=0;n<t.length;n++)t[parseInt(n.toString(),10)].isFromGroup||this.sortedColumns.push(t[parseInt(n.toString(),10)].field)},n.prototype.clearSorting=function(){var t=uv(this.sortSettings.columns),n,i;if(this.isActionPrevent())this.parent.notify(ci,{instance:this,handler:this.clearSorting});else for(n=0,i=t.length;n<i;n++)this.removeSortColumn(t[parseInt(n.toString(),10)].field)},n.prototype.isActionPrevent=function(){return sr(this.parent)},n.prototype.removeSortColumn=function(n){var r=this.parent,t=this.sortSettings.columns;if(!(0===t.length&&this.sortedColumns.indexOf(n)<0))if(this.isActionPrevent())this.parent.notify(ci,{instance:this,handler:this.removeSortColumn,arg1:n});else{this.backupSettings();this.removeSortIcons();for(var u={requestType:"sorting",type:nt,target:this.currentTarget},i=0,f=t.length;i<f;i++)if(t[parseInt(i.toString(),10)].field===n){if(r.allowGrouping&&r.groupSettings.columns.indexOf(t[parseInt(i.toString(),10)].field)>-1)continue;this.sortedColumns.splice(this.sortedColumns.indexOf(t[parseInt(i.toString(),10)].field),1);t.splice(i,1);this.isRemove=!0;this.isModelChanged&&this.parent.notify(pt,u);break}u.cancel||this.addSortIcons()}},n.prototype.getSortedColsIndexByField=function(n,t){for(var r=t||this.sortSettings.columns,i=0,u=r.length;i<u;i++)if(r[parseInt(i.toString(),10)].field===n)return i;return-1},n.prototype.getModuleName=function(){return"sort"},n.prototype.initialEnd=function(){var r,n,i,t;if(this.parent.off(it,this.initialEnd),this.parent.getColumns().length&&this.sortSettings.columns.length){for(r=this.parent,this.contentRefresh=!1,this.isMultiSort=this.sortSettings.columns.length>1,n=0,i=r.sortSettings.columns.slice();n<i.length;n++)t=i[n],this.sortedColumns.indexOf(t.field)>-1&&this.sortColumn(t.field,t.direction,!0);this.isMultiSort=!1;this.contentRefresh=!0}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:io,handler:this.setFullScreenDialog},{event:it,handler:this.initialEnd},{event:yc,handler:this.onActionComplete},{event:gt,handler:this.onPropertyChanged},{event:ii,handler:this.clickHandler},{event:yt,handler:this.refreshSortIcons},{event:ht,handler:this.keyPressed},{event:hs,handler:this.cancelBeginEvent},{event:v,handler:this.destroy}],vt(this.parent,this.evtHandlers,!0,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||vt(this.parent,this.evtHandlers,!1)},n.prototype.destroy=function(){this.isModelChanged=!1;var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.parent.element.querySelector(".e-gridpopup").getElementsByClassName("e-sortdirect").length&&(this.parent.element.querySelector(".e-gridpopup").style.display="none"),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowSorting||this.clearSorting(),this.isModelChanged=!0,this.removeEventListener())},n.prototype.cancelBeginEvent=function(n){"sorting"===n.requestType&&(this.restoreSettings(),this.refreshSortIcons(),this.isMultiSort=!0)},n.prototype.clickHandler=function(n){var u=this.parent,r,f,e,o;this.currentTarget=null;this.popUpClickHandler(n);r=t.closest(n.target,".e-headercell");!r||n.target.classList.contains("e-grptogglebtn")||r.classList.contains("e-resized")||n.target.classList.contains("e-rhandler")||n.target.classList.contains("e-columnmenu")||n.target.classList.contains("e-filtermenudiv")||i(n.target,"e-stackedheadercell")||u.allowSelection&&u.selectionSettings.allowColumnSelection&&n.target.classList.contains("e-headercell")||(f=this.parent.getColumnByUid(r.querySelector(".e-headercelldiv").getAttribute("e-mappinguid")),"checkbox"!==f.type&&(this.initiateSort(r,n,f),t.Browser.isDevice&&this.showPopUp(n)));(r&&r.classList.remove("e-resized"),i(n.target,"e-excel-ascending")||i(n.target,"e-excel-descending"))&&(e=t.closest(n.target,".e-filter-popup").getAttribute("uid"),o=t.isNullOrUndefined(i(n.target,"e-excel-descending"))?"Ascending":"Descending",this.sortColumn(u.getColumnByUid(e).field,o,!1))},n.prototype.keyPressed=function(n){var u=n.target,i,r;if(!this.parent.isEdit&&("enter"===n.action||"ctrlEnter"===n.action||"shiftEnter"===n.action)&&t.closest(u,".e-headercell")){if(i=this.focus.getFocusedElement(),t.isNullOrUndefined(i)||!i.classList.contains("e-headercell")||!i.querySelector(".e-headercelldiv"))return;r=this.parent.getColumnByUid(i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"));this.initiateSort(i,n,r)}},n.prototype.initiateSort=function(n,t,i){var f=this.parent,r=i.field,u;this.currentTarget=t.target;u=n.getElementsByClassName("e-ascending").length?"Descending":"Ascending";this.isMultiSort=t.ctrlKey||this.enableSortMultiTouch||-1!==navigator.userAgent.indexOf("Mac OS")&&t.metaKey;t.shiftKey||this.sortSettings.allowUnsort&&n.getElementsByClassName("e-descending").length&&!(f.groupSettings.columns.indexOf(r)>-1)?this.removeSortColumn(r):this.sortColumn(r,u,this.isMultiSort)},n.prototype.showPopUp=function(n){var i=t.closest(n.target,".e-headercell");this.parent.allowMultiSorting&&(!t.isNullOrUndefined(i)||this.parent.isContextMenuOpen())&&fb(this.parent.element.querySelector(".e-gridpopup"),n,"e-sortdirect e-icons e-icon-sortdirect"+(this.sortedColumns.length>1?" e-spanclicked":""))},n.prototype.popUpClickHandler=function(n){var i=n.target;t.closest(i,".e-headercell")||n.target.classList.contains(a)||t.closest(i,".e-gridpopup")?i.classList.contains("e-sortdirect")&&(i.classList.contains("e-spanclicked")?(i.classList.remove("e-spanclicked"),this.enableSortMultiTouch=!1,this.parent.element.querySelector(".e-gridpopup").style.display="none"):(i.classList.add("e-spanclicked"),this.enableSortMultiTouch=!0)):this.parent.element.querySelector(".e-gridpopup").style.display="none"},n.prototype.addSortIcons=function(){for(var i,u,f=this.parent,r=this.sortSettings.columns,e=this.parent.getColumns().map(function(n){return n.field}),n=0,o=r.length;n<o;n++)i=f.getColumnHeaderByField(r[parseInt(n.toString(),10)].field),-1===e.indexOf(r[parseInt(n.toString(),10)].field)||t.isNullOrUndefined(i)||(this.aria.setSort(i,r[parseInt(n.toString(),10)].direction.toLowerCase()),r.length>1&&i.querySelector(".e-headercelldiv").insertBefore(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(n+1).toString()}),i.querySelector(".e-headertext")),u=i.querySelector(".e-sortfilterdiv"),"Ascending"===r[parseInt(n.toString(),10)].direction?t.classList(u,["e-ascending","e-icon-ascending"],[]):t.classList(u,["e-descending","e-icon-descending"],[]))},n.prototype.removeSortIcons=function(n){for(var i,f=this.parent,u=this.sortSettings.columns,e=this.parent.getColumns().map(function(n){return n.field}),r=n||0,o=t.isNullOrUndefined(n)?u.length:n+1;r<o;r++)i=f.getColumnHeaderByField(u[parseInt(r.toString(),10)].field),t.isNullOrUndefined(i)||f.allowGrouping&&f.groupSettings.columns.indexOf(u[parseInt(r.toString(),10)].field)>-1&&!i.querySelector(".e-sortfilterdiv")||-1!==e.indexOf(u[parseInt(r.toString(),10)].field)&&(this.aria.setSort(i,"none"),t.classList(i.querySelector(".e-sortfilterdiv"),[],["e-descending","e-icon-descending","e-ascending","e-icon-ascending"]),i.querySelector(".e-sortnumber")&&i.querySelector(".e-headercelldiv").removeChild(i.querySelector(".e-sortnumber")))},n.prototype.getSortColumnFromField=function(n){for(var t=0,i=this.sortSettings.columns.length;t<i;t++)if(this.sortSettings.columns[parseInt(t.toString(),10)].field===n)return this.sortSettings.columns[parseInt(t.toString(),10)];return!1},n.prototype.updateAriaAttr=function(){for(var n,r,u=this.parent.getColumns().map(function(n){return n.field}),t=0,i=this.sortedColumns;t<i.length;t++)n=i[t],-1!==u.indexOf(n)&&(r=this.parent.getColumnHeaderByField(n),this.aria.setSort(r,this.getSortColumnFromField(n).direction))},n.prototype.refreshSortIcons=function(n){void 0===n&&(n={args:{isFrozen:!1}});n.args.isFrozen||(this.removeSortIcons(),this.isMultiSort=!0,this.removeSortIcons(),this.addSortIcons(),this.isMultiSort=!1,this.updateAriaAttr())},n.prototype.showCustomSort=function(n){this.responsiveDialogRenderer.isCustomDialog=n;this.responsiveDialogRenderer.showResponsiveDialog()},n}(),fut=function(){function n(n){this.pagerModule=n}return n.prototype.render=function(){this.pagerElement=this.pagerModule.element;this.renderNumericContainer();this.refreshNumericLinks();this.wireEvents()},n.prototype.refresh=function(){this.pagerModule.updateTotalPages();this.links.length&&this.updateLinksHtml();this.refreshAriaAttrLabel();this.updateStyles()},n.prototype.refreshNumericLinks=function(){var r,n=this.pagerModule,u=n.element.querySelector(".e-numericcontainer"),f=document.createDocumentFragment(),i;for(u.innerHTML="",i=1;i<=n.pageCount;i++)r=t.createElement("a",{className:"e-link e-numericitem e-spacing e-pager-default",attrs:{role:"link",tabindex:"-1","aria-label":n.getLocalizedLabel("Page")+i+n.getLocalizedLabel("Of")+n.totalPages+n.getLocalizedLabel("Pages"),href:"#",name:"Goto page"+i}}),n.currentPage===i&&(t.classList(r,["e-currentitem","e-active"],["e-pager-default"]),r.setAttribute("aria-current","page")),f.appendChild(r);u.appendChild(f);this.links=[].slice.call(u.childNodes)},n.prototype.wireEvents=function(){t.EventHandler.add(this.pagerElement,"click",this.clickHandler,this)},n.prototype.unwireEvents=function(){t.EventHandler.remove(this.pagerModule.element,"click",this.clickHandler)},n.prototype.destroy=function(){this.unwireEvents()},n.prototype.refreshAriaAttrLabel=function(){for(var t=this.pagerModule,i=t.element.querySelector(".e-numericcontainer").querySelectorAll("a"),n=0;n<i.length;n++)i[parseInt(n.toString(),10)].hasAttribute("aria-label")&&i[parseInt(n.toString(),10)].hasAttribute("index")&&i[parseInt(n.toString(),10)].setAttribute("aria-label",t.getLocalizedLabel("Page")+i[parseInt(n.toString(),10)].getAttribute("index")+t.getLocalizedLabel("Of")+t.totalPages+t.getLocalizedLabel("Pages"))},n.prototype.renderNumericContainer=function(){this.element=t.createElement("div",{className:"e-pagercontainer",attrs:{role:"navigation"}});this.renderFirstNPrev(this.element);this.renderPrevPagerSet(this.element);this.element.appendChild(t.createElement("div",{className:"e-numericcontainer"}));this.renderNextPagerSet(this.element);this.renderNextNLast(this.element);this.pagerModule.element.appendChild(this.element)},n.prototype.renderFirstNPrev=function(n){this.first=t.createElement("div",{className:"e-first e-icons e-icon-first",attrs:{title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip"),tabindex:"-1",role:"button"}});this.prev=t.createElement("div",{className:"e-prev e-icons e-icon-prev",attrs:{title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip"),tabindex:"-1",role:"button"}});t.append([this.first,this.prev],n)},n.prototype.renderPrevPagerSet=function(n){var i=t.createElement("div");this.PP=t.createElement("a",{className:"e-link e-pp e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),href:"#"}});i.appendChild(this.PP);n.appendChild(i)},n.prototype.renderNextPagerSet=function(n){var i=t.createElement("div");this.NP=t.createElement("a",{className:"e-link e-np e-spacing",innerHTML:"...",attrs:{title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),role:"link","aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip"),tabindex:"-1",name:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),href:"#"}});i.appendChild(this.NP);n.appendChild(i)},n.prototype.renderNextNLast=function(n){this.next=t.createElement("div",{className:"e-next e-icons e-icon-next",attrs:{title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip"),tabindex:"-1",role:"button"}});this.last=t.createElement("div",{className:"e-last e-icons e-icon-last",attrs:{title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip"),tabindex:"-1",role:"button"}});t.append([this.next,this.last],n)},n.prototype.clickHandler=function(n){var i=this.pagerModule;return this.target=n.target,this.target.classList.contains("e-numericitem")&&n.preventDefault(),i.previousPageNo=i.currentPage,this.target.classList.contains("e-disable")||t.isNullOrUndefined(this.target.getAttribute("index"))||(i.currentPage=parseInt(this.target.getAttribute("index"),10),i.dataBind()),!1},n.prototype.updateLinksHtml=function(){var e,c,f,n=this.pagerModule,r=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)'),i,u,b,h,k;for(n.currentPage=1===n.totalPages?1:n.currentPage,n.currentPage>n.totalPages&&n.totalPages&&(n.currentPage=n.totalPages),e=parseInt((n.currentPage/n.pageCount).toString(),10),n.currentPage%n.pageCount==0&&e>0&&(e-=1),i=0;i<n.pageCount;i++){if(n.isPagerResized){var d=this.pagerElement.querySelector(".e-focus"),l=this.target?this.target:d||null,o=!1,a=!1,v=!1,s=!1,y=!1,p=!1,w=!1;if(l)if(u=l.classList,u.contains("e-icons"))switch(!0){case u.contains("e-prev"):o=!0;break;case u.contains("e-next"):a=!0;break;case u.contains("e-first"):v=!0;break;case u.contains("e-last"):s=!0}else if(u.contains("e-numericitem"))switch(!0){case u.contains("e-np"):p=!0;break;case u.contains("e-pp"):w=!0;break;default:y=u.contains("e-numericitem")}c=s||"End"===this.pagerModule.keyAction;r=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)');b=Array.from(r).some(function(t){return parseInt(t.getAttribute("index"),10)===n.currentPage});f=v||"Home"===this.pagerModule.keyAction?1+i:s||"End"===this.pagerModule.keyAction?e*n.pageCount+1+i:a||"ArrowRight"===this.pagerModule.keyAction||o||"ArrowLeft"===this.pagerModule.keyAction?b?parseInt(r[0].getAttribute("index"),10)+i:o||"ArrowLeft"===this.pagerModule.keyAction?parseInt(this.PP.getAttribute("index"),10)+i:n.currentPage+i:p||w?n.currentPage+i:y?parseInt(r[0].getAttribute("index"),10)+i:e*n.pageCount+1+i}else f=e*n.pageCount+1+i;f<=n.totalPages?(this.links[parseInt(i.toString(),10)].classList.remove("e-hide"),this.links[parseInt(i.toString(),10)].style.display="",this.links[parseInt(i.toString(),10)].setAttribute("index",f.toString()),this.links[parseInt(i.toString(),10)].innerHTML=n.customText?n.customText+f:f.toString(),n.currentPage!==f?this.links[parseInt(i.toString(),10)].classList.add("e-pager-default"):this.links[parseInt(i.toString(),10)].classList.remove("e-pager-default")):(this.links[parseInt(i.toString(),10)].innerHTML=n.customText?n.customText+f:f.toString(),this.links[parseInt(i.toString(),10)].style.display="none");t.classList(this.links[parseInt(i.toString(),10)],[],["e-currentitem","e-active"]);this.links[parseInt(i.toString(),10)].removeAttribute("aria-current");this.links[parseInt(i.toString(),10)].setAttribute("role","link")}t.attributes(this.first,{index:"1",title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip")});t.attributes(this.pagerElement.querySelector(".e-mfirst"),{index:"1",title:this.pagerModule.getLocalizedLabel("firstPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("firstPageTooltip")});t.attributes(this.last,{index:n.totalPages.toString(),title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip")});t.attributes(this.pagerElement.querySelector(".e-mlast"),{index:n.totalPages.toString(),title:this.pagerModule.getLocalizedLabel("lastPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("lastPageTooltip")});t.attributes(this.prev,{index:(n.currentPage-1).toString(),title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip")});t.attributes(this.pagerElement.querySelector(".e-mprev"),{index:(n.currentPage-1).toString(),title:this.pagerModule.getLocalizedLabel("previousPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPageTooltip")});t.attributes(this.next,{index:(n.currentPage+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip")});t.attributes(this.pagerElement.querySelector(".e-mnext"),{index:(n.currentPage+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPageTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPageTooltip")});h=this.pagerModule.isPagerResized&&r.length?c?parseInt(r[0].getAttribute("index"),10)-n.avgNumItems:parseInt(r[0].getAttribute("index"),10)-r.length:parseInt(this.links[0].getAttribute("index"),10)-n.pageCount;t.attributes(this.PP,{index:h<1?"1":h.toString(),title:this.pagerModule.getLocalizedLabel("previousPagerTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("previousPagerTooltip")});k=this.pagerModule.isPagerResized&&r.length?parseInt(r[r.length-1].getAttribute("index"),10):parseInt(this.links[this.links.length-1].getAttribute("index"),10);t.attributes(this.NP,{index:(k+1).toString(),title:this.pagerModule.getLocalizedLabel("nextPagerTooltip"),"aria-label":this.pagerModule.getLocalizedLabel("nextPagerTooltip")});this.target=void 0},n.prototype.updateStyles=function(){var r=this,i,n;(this.updateFirstNPrevStyles(),this.updatePrevPagerSetStyles(),this.updateNextPagerSetStyles(),this.updateNextNLastStyles(),this.links.length)&&(i=this.links.findIndex(function(n){return n.getAttribute("index")===r.pagerModule.currentPage.toString()}),n=this.pagerModule.isPagerResized&&-1!==i?i:(this.pagerModule.currentPage-1)%this.pagerModule.pageCount,t.classList(this.links[parseInt(n.toString(),10)],["e-currentitem","e-active"],[]),this.links[parseInt(n.toString(),10)].setAttribute("aria-current","page"),this.links[parseInt(n.toString(),10)].removeAttribute("role"))},n.prototype.updateFirstNPrevStyles=function(){var n=["e-firstpage","e-pager-default"],i=["e-firstpagedisabled","e-disable"],r=["e-prevpage","e-pager-default"],u=["e-prevpagedisabled","e-disable"];this.pagerModule.totalPages>0&&this.pagerModule.currentPage>1?(t.classList(this.prev,r,u),t.classList(this.first,n,i),t.classList(this.pagerElement.querySelector(".e-mfirst"),n,i),t.classList(this.pagerElement.querySelector(".e-mprev"),r,u)):(t.classList(this.prev,u,r),t.classList(this.first,i,n),t.classList(this.pagerElement.querySelector(".e-mprev"),u,r),t.classList(this.pagerElement.querySelector(".e-mfirst"),i,n))},n.prototype.updatePrevPagerSetStyles=function(){this.pagerModule.currentPage>this.pagerModule.pageCount||this.pagerModule.isPagerResized&&this.links.findIndex(function(n){return 1===parseInt(n.getAttribute("index"),10)})?t.classList(this.PP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]):t.classList(this.PP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"])},n.prototype.updateNextPagerSetStyles=function(){var n=this.pagerModule,i=this.links[0].innerHTML.replace(n.customText,""),r=this.pagerElement.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)');!i.length||!this.links.length||parseInt(i,10)+n.pageCount>n.totalPages||n.isPagerResized&&Array.from(r).some(function(t){return parseInt(t.getAttribute("index"),10)===n.totalPages})?t.classList(this.NP,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]):t.classList(this.NP,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])},n.prototype.updateNextNLastStyles=function(){var n=["e-lastpage","e-pager-default"],i=["e-lastpagedisabled","e-disable"],r=["e-nextpage","e-pager-default"],u=["e-nextpagedisabled","e-disable"],f=this.pagerModule;f.currentPage===f.totalPages||0===f.totalRecordsCount?(t.classList(this.last,i,n),t.classList(this.next,u,r),t.classList(this.pagerElement.querySelector(".e-mlast"),i,n),t.classList(this.pagerElement.querySelector(".e-mnext"),u,r)):(t.classList(this.last,n,i),t.classList(this.next,r,u),t.classList(this.pagerElement.querySelector(".e-mlast"),n,i),t.classList(this.pagerElement.querySelector(".e-mnext"),r,u))},n}(),eut=function(){function n(n){this.pagerModule=n}return n.prototype.render=function(){var n=t.createElement("div",{className:"e-parentmsgbar",attrs:{"aria-label":this.pagerModule.getLocalizedLabel("Information")}});this.pageNoMsgElem=t.createElement("span",{className:"e-pagenomsg",styles:"textalign:right"});this.pageCountMsgElem=t.createElement("span",{className:"e-pagecountmsg",styles:"textalign:right"});t.append([this.pageNoMsgElem,this.pageCountMsgElem],n);this.pagerModule.element.appendChild(n);this.refresh()},n.prototype.refresh=function(){var n=this.pagerModule;this.pageNoMsgElem.textContent=this.format(n.getLocalizedLabel("currentPageInfo"),[0===n.totalRecordsCount?0:n.currentPage,n.totalPages||0,n.totalRecordsCount||0])+" ";this.pageCountMsgElem.textContent=this.format(n.getLocalizedLabel(n.totalRecordsCount<=1?"totalItemInfo":"totalItemsInfo"),[n.totalRecordsCount||0,n.totalRecordsCount?n.pageSize*(n.currentPage-1)+1:0,n.pageSize*n.currentPage>n.totalRecordsCount?n.totalRecordsCount:n.pageSize*n.currentPage]);this.pageNoMsgElem.parentElement.setAttribute("aria-label",this.pageNoMsgElem.textContent+this.pageCountMsgElem.textContent);this.pageNoMsgElem.parentElement.classList.remove("e-hide")},n.prototype.hideMessage=function(){this.pageNoMsgElem&&(this.pageNoMsgElem.style.display="none");this.pageCountMsgElem&&(this.pageCountMsgElem.style.display="none")},n.prototype.showMessage=function(){this.pageNoMsgElem||this.render();this.pageNoMsgElem.style.display="";this.pageCountMsgElem.style.display=""},n.prototype.destroy=function(){},n.prototype.format=function(n,t){for(var r,i=0;i<t.length;i++)r=new RegExp("\\{"+i+"\\}","gm"),n=n.replace(r,t[parseInt(i.toString(),10)].toString());return n},n}(),oht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ai=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},db=function(n){function r(t,i,r){var u=n.call(this,t,i)||this;return u.hasParent=!1,u.checkAll=!0,u.pageRefresh="pager-refresh",u.firstPagerFocus=!1,u.parent=r,u}return oht(r,n),r.prototype.requiredModules=function(){var n=[];return this.enableExternalMessage&&n.push({member:"externalMessage",args:[this]}),this.checkpagesizes()&&n.push({member:"pagerdropdown",args:[this]}),n},r.prototype.preRender=function(){this.defaultConstants={currentPageInfo:"{0} of {1} pages",totalItemsInfo:"({0} items)",totalItemInfo:"({0} item)",firstPageTooltip:"Go to first page",lastPageTooltip:"Go to last page",nextPageTooltip:"Go to next page",previousPageTooltip:"Go to previous page",nextPagerTooltip:"Go to next pager items",previousPagerTooltip:"Go to previous pager items",pagerDropDown:"Items per page",pagerAllDropDown:"Items",CurrentPageInfo:"{0} of {1} pages",TotalItemsInfo:"({0} items)",FirstPageTooltip:"Go to first page",LastPageTooltip:"Go to last page",NextPageTooltip:"Go to next page",PreviousPageTooltip:"Go to previous page",NextPagerTooltip:"Go to next pager items",PreviousPagerTooltip:"Go to previous pager items",PagerDropDown:"Items per page",PagerAllDropDown:"Items",All:"All",Container:"Pager Container",Information:"Pager Information",ExternalMsg:"Pager external message",Page:"Page ",Of:" of ",Pages:" Pages"};this.containerModule=new fut(this);this.pagerMessageModule=new eut(this)},r.prototype.render=function(){this.element.setAttribute("data-role","pager");this.element.setAttribute("tabindex","-1");this.initLocalization();this.element.setAttribute("aria-label",this.getLocalizedLabel("Container"));this.cssClass&&t.addClass([this.element],[this.cssClass]);this.hasParent||this.element.setAttribute("tabindex","0");this.template?this.isReactTemplate()?(this.on(this.pageRefresh,this.pagerTemplate,this),this.notify(this.pageRefresh,{})):this.pagerTemplate():(this.updateRTL(),this.totalRecordsCount=this.totalRecordsCount||0,this.renderFirstPrevDivForDevice(),this.containerModule.render(),this.enablePagerMessage&&this.pagerMessageModule.render(),this.renderNextLastDivForDevice(),this.checkpagesizes()&&this.pagerdropdownModule&&this.pagerdropdownModule.render(),this.addAriaLabel(),this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render(),this.refresh(),this.trigger("created",{currentPage:this.currentPage,totalRecordsCount:this.totalRecordsCount}));this.wireEvents();this.addListener()},r.prototype.getPersistData=function(){return this.addOnPersist(["currentPage","pageSize"])},r.prototype.destroy=function(){this.isDestroyed||(this.isReactTemplate()&&(this.off(this.pageRefresh,this.pagerTemplate),this.hasParent||this.destroyTemplate(["template"])),this.removeListener(),this.unwireEvents(),n.prototype.destroy.call(this),this.containerModule.destroy(),this.pagerMessageModule.destroy(),this.isReactTemplate()||(this.element.innerHTML=""))},r.prototype.destroyTemplate=function(n,t){this.clearTemplate(n,t)},r.prototype.getModuleName=function(){return"pager"},r.prototype.onPropertyChanged=function(n,t){if(!this.isDestroyed)if(n.pageSize!==this.getLocalizedLabel("All")||t.pageSize!==this.totalRecordsCount){n.pageCount!==t.pageCount&&(this.containerModule.refreshNumericLinks(),this.containerModule.refresh());for(var i=0,r=Object.keys(n);i<r.length;i++)switch(r[i]){case"currentPage":this.checkGoToPage(n.currentPage,t.currentPage)&&this.currentPageChanged(n,t);break;case"pageSize":case"totalRecordsCount":case"customText":this.checkpagesizes()&&this.pagerdropdownModule&&(t.pageSize!==n.pageSize&&(this.currentPage=1),this.pagerdropdownModule.setDropDownValue("value",this.pageSize));n.pageSize!==t.pageSize?(this.pageSize=n.pageSize,this.currentPageChanged(n,t)):this.refresh();break;case"pageSizes":this.checkpagesizes()&&this.pagerdropdownModule&&(this.pagerdropdownModule.destroy(),this.pagerdropdownModule.render());this.refresh();break;case"template":this.templateFn=this.compile(this.template);this.refresh();break;case"locale":this.initLocalization();this.refresh();break;case"enableExternalMessage":this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.render();break;case"externalMessage":this.externalMessageModule&&this.externalMessageModule.refresh();break;case"enableRtl":this.updateRTL();break;case"enablePagerMessage":this.enablePagerMessage?this.pagerMessageModule.showMessage():this.pagerMessageModule.hideMessage()}this.resizePager()}else this.pageSize=this.totalRecordsCount},r.prototype.wireEvents=function(){this.hasParent||(t.EventHandler.add(this.element,"keydown",this.keyPressHandler,this),t.EventHandler.add(document.body,"keydown",this.keyDownHandler,this));t.EventHandler.add(this.element,"focusin",this.onFocusIn,this);t.EventHandler.add(this.element,"focusout",this.onFocusOut,this);t.EventHandler.add(window,"resize",this.resizePager,this);t.EventHandler.add(window,"load",this.resizePager,this)},r.prototype.unwireEvents=function(){this.hasParent||(t.EventHandler.remove(this.element,"keydown",this.keyPressHandler),t.EventHandler.remove(document.body,"keydown",this.keyDownHandler));t.EventHandler.remove(this.element,"focusin",this.onFocusIn);t.EventHandler.remove(this.element,"focusout",this.onFocusOut);t.EventHandler.remove(window,"resize",this.resizePager);t.EventHandler.remove(window,"load",this.resizePager)},r.prototype.onFocusIn=function(n){var f=this.getFocusedTabindexElement(),i,r,u;if(t.isNullOrUndefined(f)){if(i=n.target,r=this.getDropDownPage(),this.hasParent||(this.element.tabIndex=-1),i===this.element&&!this.hasParent)return u=this.getFocusablePagerElements(this.element,[]),void this.addFocus(u[0],!0);if(i===this.element)return void(this.element.tabIndex=0);i===r||i.classList.contains("e-disable")||this.addFocus(i,!0)}},r.prototype.onFocusOut=function(){var i=this.getFocusedElement(),n=this.getDropDownPage();t.isNullOrUndefined(i)||this.removeFocus(i,!0);this.pageSizes&&n&&n.classList.contains("e-input-focus")&&this.removeFocus(n,!0);this.setTabIndexForFocusLastElement();this.hasParent||(this.element.tabIndex=0);this.hasParent&&(this.element.tabIndex=-1)},r.prototype.keyDownHandler=function(n){if(n.altKey&&74===n.keyCode){var t=this.getFocusablePagerElements(this.element,[]);t.length>0&&t[0].focus()}},r.prototype.keyPressHandler=function(n){var i=t.extend(n,{cancel:!1});this.notify(ht,i);!0===i.cancel&&n.stopImmediatePropagation()},r.prototype.addListener=function(){this.isDestroyed||this.hasParent||this.on(ht,this.onKeyPress,this)},r.prototype.removeListener=function(){this.isDestroyed||this.hasParent||this.off(ht,this.onKeyPress)},r.prototype.onKeyPress=function(n){this.hasParent||(this.checkPagerHasFocus()?this.changePagerFocus(n):(n.preventDefault(),this.setPagerFocus()))},r.prototype.checkPagerHasFocus=function(){return!!this.getFocusedTabindexElement()},r.prototype.setPagerContainerFocus=function(){this.element.focus()},r.prototype.setPagerFocus=function(){var n=this.getFocusablePagerElements(this.element,[]);n.length>0&&n[0].focus()},r.prototype.setPagerFocusForActiveElement=function(){var n=this.getActiveElement();n&&n.focus()},r.prototype.setTabIndexForFocusLastElement=function(){var n=this.getFocusablePagerElements(this.element,[]),i=this.getDropDownPage();this.pageSizes&&i&&!t.isNullOrUndefined(i.offsetParent)?i.tabIndex=0:n.length>0&&(n[n.length-1].tabIndex=0)},r.prototype.changePagerFocus=function(n){this.keyAction=n.key;n.shiftKey&&9===n.keyCode?this.changeFocusByShiftTab(n):9===n.keyCode?this.changeFocusByTab(n):13===n.keyCode||32===n.keyCode?this.navigateToPageByEnterOrSpace(n):37!==n.keyCode&&39!==n.keyCode&&35!==n.keyCode&&36!==n.keyCode||this.navigateToPageByKey(n);this.keyAction=""},r.prototype.getFocusedTabindexElement=function(){for(var r,n,i=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])'),t=0;t<i.length;t++)if(n=i[parseInt(t.toString(),10)],n&&(n.classList.contains("e-focused")||n.classList.contains("e-input-focus"))){r=n;break}return r},r.prototype.changeFocusByTab=function(n){var u=this.getFocusedTabindexElement(),t=this.getFocusablePagerElements(this.element,[]),f=this.getDropDownPage(),i,r;if(t.length>0)if(this.pageSizes&&f&&u===t[t.length-1])f.tabIndex=0;else for(i=0;i<t.length;i++)if(u===t[parseInt(i.toString(),10)]){r=i+1;r<t.length&&(n.preventDefault(),t[parseInt(r.toString(),10)].focus());break}},r.prototype.changeFocusByShiftTab=function(n){var o=this.getFocusedTabindexElement(),t=this.getFocusablePagerElements(this.element,[]),r=this.getDropDownPage(),i,u,f,e;if(this.pageSizes&&r&&r.classList.contains("e-input-focus"))r.tabIndex=-1,this.addFocus(t[t.length-1],!0);else if(t.length>0)for(i=0;i<t.length;i++)if(o===t[parseInt(i.toString(),10)]){u=i-1;u>=0?(n.preventDefault(),t[parseInt(u.toString(),10)].focus()):this.hasParent&&(f=this.parent.getRows(),e=f[f.length-1].lastChild,n.preventDefault(),e.focus(),this.firstPagerFocus=!0);break}},r.prototype.checkFirstPagerFocus=function(){return!!this.firstPagerFocus&&(this.firstPagerFocus=!1,!0)},r.prototype.navigateToPageByEnterOrSpace=function(){var t=this.getFocusedElement();if(t){this.goToPage(parseInt(t.getAttribute("index"),10));var r=this.getActiveElement(),n=this.getClass(t),i=this.getElementByClass(n);"e-first"!==n&&"e-prev"!==n&&"e-next"!==n&&"e-last"!==n&&"e-pp"!==n&&"e-np"!==n||!i||i.classList.contains("e-disable")?this.checkFocusInAdaptiveMode(t)?this.changeFocusInAdaptiveMode(t):r&&r.focus():i.focus()}},r.prototype.navigateToPageByKey=function(n){var f=37===n.keyCode?".e-prev":39===n.keyCode?".e-next":35===n.keyCode?".e-last":36===n.keyCode?".e-first":"",i=this.element.querySelector(f),u=this.getFocusedElement(),r;t.isNullOrUndefined(i)||!i.hasAttribute("index")||isNaN(parseInt(i.getAttribute("index"),10))||(this.goToPage(parseInt(i.getAttribute("index"),10)),r=this.getActiveElement(),this.checkFocusInAdaptiveMode(u)?this.changeFocusInAdaptiveMode(u):r&&r.focus())},r.prototype.checkFocusInAdaptiveMode=function(n){var t=this.getClass(n);return"e-mfirst"===t||"e-mprev"===t||"e-mnext"===t||"e-mlast"===t},r.prototype.changeFocusInAdaptiveMode=function(n){var t=this.getClass(n),i=this.getElementByClass(t);i&&i.classList.contains("e-disable")&&("e-mnext"===t||"e-mlast"===t?this.element.querySelector(".e-mprev").focus():this.setPagerFocus())},r.prototype.removeTabindexLastElements=function(){var t=this.element.querySelectorAll('[tabindex]:not([tabindex="-1"])'),n,i;if(t.length>1)for(n=1;n<t.length;n++)i=t[parseInt(n.toString(),10)],i&&(i.tabIndex=-1)},r.prototype.getActiveElement=function(){return this.element.querySelector(".e-active")},r.prototype.getDropDownPage=function(){var n,t=this.element.querySelector(".e-pagerdropdown");return t&&(n=t.children[0]),n},r.prototype.getFocusedElement=function(){return this.element.querySelector(".e-focused")},r.prototype.getClass=function(n){for(var r,i=["e-mfirst","e-mprev","e-first","e-prev","e-pp","e-np","e-next","e-last","e-mnext","e-mlast"],t=0;t<i.length;t++)if(n&&n.classList.contains(i[parseInt(t.toString(),10)]))return i[parseInt(t.toString(),10)];return r},r.prototype.getElementByClass=function(n){return this.element.querySelector("."+n)},r.prototype.getFocusablePagerElements=function(n,i){for(var r,o,e=n.children,u=i,f=0;f<e.length;f++)r=e[parseInt(f.toString(),10)],r.children.length>0&&!r.classList.contains("e-pagesizes")?u=this.getFocusablePagerElements(r,u):(o=e[parseInt(f.toString(),10)],!o.hasAttribute("tabindex")||r.classList.contains("e-disable")||"none"===r.style.display||t.isNullOrUndefined(r.offsetParent)||u.push(o));return u},r.prototype.addFocus=function(n,i){i&&t.addClass([n],["e-focused","e-focus"]);n.tabIndex=0},r.prototype.removeFocus=function(n,i){i&&t.removeClass([n],["e-focused","e-focus"]);n.tabIndex=-1},r.prototype.getLocalizedLabel=function(n){return this.localeObj.getConstant(n)},r.prototype.goToPage=function(n){this.checkGoToPage(n)&&(this.currentPage=n,this.dataBind())},r.prototype.setPageSize=function(n){this.pageSize=n;this.dataBind()},r.prototype.checkpagesizes=function(){return!(!0!==this.pageSizes&&!this.pageSizes.length)},r.prototype.checkGoToPage=function(n,i){return n!==this.currentPage&&(this.previousPageNo=this.currentPage),t.isNullOrUndefined(i)||(this.previousPageNo=i),this.previousPageNo!==n&&n>=1&&n<=this.totalPages},r.prototype.currentPageChanged=function(n,t){if(this.enableQueryString&&this.updateQueryString(this.currentPage),n.currentPage!==t.currentPage||n.pageSize!==t.pageSize){var i={currentPage:this.currentPage,newProp:n,oldProp:t,cancel:!1};this.trigger("click",i);i.cancel?t.pageSize&&this.pageSize!==t.pageSize&&(this.setProperties({pageSize:t.pageSize},!1),this.pagerdropdownModule.dropDownListObject.text=t.pageSize+""):this.refresh()}},r.prototype.pagerTemplate=function(){var t,n,i;this.isReactTemplate()&&this.hasParent||(this.element.classList.add("e-pagertemplate"),this.compile(this.template),n={currentPage:this.currentPage,pageSize:this.pageSize,pageCount:this.pageCount,totalRecordsCount:this.totalRecordsCount,totalPages:this.totalPages},i=this.element.parentElement.id+"_template",this.isReactTemplate()&&!this.isVue?(this.getPagerTemplate()(n,this,"template",i,null,null,this.element),this.renderReactTemplates()):(t=this.isVue?this.getPagerTemplate()(n,this,"template"):this.getPagerTemplate()(n),kt(this.element,t)))},r.prototype.updateTotalPages=function(){this.totalPages=this.isAllPage?1:this.totalRecordsCount%this.pageSize==0?this.totalRecordsCount/this.pageSize:parseInt((this.totalRecordsCount/this.pageSize).toString(),10)+1},r.prototype.getPagerTemplate=function(){return this.templateFn},r.prototype.compile=function(n){if(n)try{"function"==typeof n?this.templateFn=t.compile(n):document.querySelectorAll(n).length&&(this.templateFn=t.compile(document.querySelector(n).innerHTML.trim()))}catch(i){this.templateFn=t.compile(n)}},r.prototype.refresh=function(){if(this.template)this.isReactTemplate()?(this.updateTotalPages(),this.notify(this.pageRefresh,{})):(this.element.innerHTML="",this.updateTotalPages(),this.pagerTemplate());else{this.updateRTL();var n=this.getFocusedTabindexElement();this.containerModule.refresh();this.removeTabindexLastElements();n&&n.classList.contains("e-disable")&&(this.checkFocusInAdaptiveMode(n)?this.changeFocusInAdaptiveMode(n):this.setPagerFocusForActiveElement());this.enablePagerMessage&&this.pagerMessageModule.refresh();this.pagerdropdownModule&&this.pagerdropdownModule.refresh();this.enableExternalMessage&&this.externalMessageModule&&this.externalMessageModule.refresh();this.setTabIndexForFocusLastElement();this.resizePager()}},r.prototype.updateRTL=function(){this.enableRtl?this.element.classList.add("e-rtl"):this.element.classList.remove("e-rtl")},r.prototype.initLocalization=function(){this.localeObj=new t.L10n(this.getModuleName(),this.defaultConstants,this.locale)},r.prototype.updateQueryString=function(n){var t=this.getUpdatedURL(window.location.href,"page",n.toString());window.history.pushState({path:t},"",t)},r.prototype.getUpdatedURL=function(n,t,i){var u=new RegExp("([?|&])"+t+"=.*?(&|#|$)","i"),r;return n.match(u)?n.replace(u,"$1"+t+"="+i+"$2"):(r="",-1!==n.indexOf("#")&&(r=n.replace(/.*#/,"#"),n=n.replace(/#.*/,"")),n+(-1!==n.indexOf("?")?"&":"?")+t+"="+i+r)},r.prototype.renderFirstPrevDivForDevice=function(){this.element.appendChild(t.createElement("div",{className:"e-mfirst e-icons e-icon-first",attrs:{title:this.getLocalizedLabel("firstPageTooltip"),tabindex:"-1"}}));this.element.appendChild(t.createElement("div",{className:"e-mprev e-icons e-icon-prev",attrs:{title:this.getLocalizedLabel("previousPageTooltip"),tabindex:"-1"}}))},r.prototype.renderNextLastDivForDevice=function(){this.element.appendChild(t.createElement("div",{className:"e-mnext e-icons e-icon-next",attrs:{title:this.getLocalizedLabel("nextPageTooltip"),tabindex:"-1"}}));this.element.appendChild(t.createElement("div",{className:"e-mlast e-icons e-icon-last",attrs:{title:this.getLocalizedLabel("lastPageTooltip"),tabindex:"-1"}}))},r.prototype.addAriaLabel=function(){var r=[".e-mfirst",".e-mprev",".e-mnext",".e-mlast"],n,i;if(!t.Browser.isDevice)for(n=0;n<r.length;n++)i=this.element.querySelector(r[parseInt(n.toString(),10)]),i.setAttribute("aria-label",i.getAttribute("title"))},r.prototype.isReactTemplate=function(){return(this.isReact||this.isVue)&&this.template&&"string"!=typeof this.template},r.prototype.calculateActualWidth=function(){for(var i,t=this.element.querySelectorAll(".e-mfirst, .e-mprev, .e-icon-first, .e-icon-prev, .e-pp:not(.e-disable), .e-numericitem:not(.e-hide), .e-numericitem.e-active.e-hide, .e-np:not(.e-disable), .e-icon-next, .e-icon-last, .e-parentmsgbar, .e-mnext, .e-mlast, .e-pagerdropdown, .e-pagerconstant"),r=0,n=0;n<t.length;n++)"none"!==getComputedStyle(t[parseInt(n.toString(),10)]).display&&(r+=t[parseInt(n.toString(),10)].offsetWidth+parseFloat(getComputedStyle(t[parseInt(n.toString(),10)]).marginLeft)+parseFloat(getComputedStyle(t[parseInt(n.toString(),10)]).marginRight));return i=this.element.querySelector(".e-pagercontainer"),r+(parseFloat(getComputedStyle(i).marginLeft)+parseFloat(getComputedStyle(i).marginRight))},r.prototype.resizePager=function(){var k=this,st=this.element.classList.contains("e-pager")?getComputedStyle(this.element).getPropertyValue("border-style").includes("solid"):null,tt,r,a,o,s,h,it,v,y,p,b,rt,ut;if(!this.template&&st){var f=this.element.querySelector(".e-pagercontainer"),c=this.calculateActualWidth(),e=this.element.clientWidth-parseFloat(getComputedStyle(this.element).paddingLeft)-parseFloat(getComputedStyle(this.element).paddingRight)-parseFloat(getComputedStyle(this.element).marginLeft)-parseFloat(getComputedStyle(this.element).marginRight),n=f.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)'),l=f.querySelectorAll('.e-numericitem.e-hide:not([style*="display: none"])'),ht=n.length,ft=t.isNullOrUndefined(i(this.element,"e-bigger"))?5:10,d=f.querySelector(".e-np"),g=f.querySelector(".e-pp"),u=this.element.querySelectorAll('.e-parentmsgbar:not(.e-hide):not([style*="display: none"]), .e-pagesizes:not(.e-hide):not([style*="display: none"])'),nt=0;for(u.length&&(u.forEach(function(n){nt+=n.offsetWidth}),this.averageDetailWidth=nt/u.length),tt=0,r=0;r<n.length;r++)tt+=n[parseInt(r.toString(),10)].offsetWidth+parseFloat(getComputedStyle(n[parseInt(r.toString(),10)]).marginLeft)+parseFloat(getComputedStyle(n[parseInt(r.toString(),10)]).marginRight);if(a=tt/n.length,c>=e-(a||0)){for(this.isPagerResized=!0,this.currentPage!==this.totalPages&&t.classList(d,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"]),c=this.calculateActualWidth(),o=Math.abs(c-e),s=Math.ceil(o/a),s=0===s?1:s>n.length?n.length-1:s,r=1;r<=s;r++)h=ht-parseInt(r.toString(),10),n=f.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)'),1===this.currentPage||parseInt(n[Math.abs(h)].getAttribute("index"),10)!==this.currentPage&&parseInt(n[n.length-1].getAttribute("index"),10)!==this.currentPage||(h=0,t.classList(g,["e-numericitem","e-pager-default"],["e-nextprevitemdisabled","e-disable"])),n[Math.abs(h)]&&!n[Math.abs(h)].classList.contains("e-currentitem")&&n[Math.abs(h)].classList.add("e-hide");if((n=f.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)')).length<=1&&u.length&&window.innerWidth>=768&&(it=this.calculateActualWidth(),it>e-ft))for(v=Math.floor((e-(it-nt))/this.averageDetailWidth),v=u.length-v,r=0;r<(v>u.length?u.length:v);r++)u[parseInt(r.toString(),10)].classList.add("e-hide")}else if(c<e&&l.length&&(o=Math.abs(e-c),y=this.element.querySelectorAll(".e-parentmsgbar.e-hide, .e-pagesizes.e-hide"),y.length&&o>this.averageDetailWidth+this.averageDetailWidth/4&&y[y.length-1].classList.remove("e-hide"),o>2*a&&!y.length&&window.innerWidth>=768)){p=Math.floor(o/(a+ft));p=p>l.length?l.length:p-1;var et=Array.from(l).filter(function(n){return parseInt(n.getAttribute("index"),10)<k.currentPage}).sort(function(n,t){return parseInt(t.getAttribute("index"),10)-parseInt(n.getAttribute("index"),10)}),ot=Array.from(l).filter(function(n){return parseInt(n.getAttribute("index"),10)>k.currentPage}),w=et.length&&et||ot.length&&ot;for(r=1;r<=p;r++)b=w&&w[Math.abs(1-r)],b&&(b.classList.remove("e-hide"),b===w[w.length-1]&&(w=null))}(n=f.querySelectorAll('.e-numericitem:not(.e-hide):not([style*="display: none"]):not(.e-np):not(.e-pp)')).length&&(parseInt(n[n.length-1].getAttribute("index"),10)===this.totalPages&&t.classList(d,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]),1===parseInt(n[0].getAttribute("index"),10)&&t.classList(g,["e-nextprevitemdisabled","e-disable"],["e-numericitem","e-pager-default"]),rt=Array.from(n).some(function(n){return parseInt(n.getAttribute("index"),10)===k.totalPages}),ut=parseInt(n[0].getAttribute("index"),10)-(rt?this.avgNumItems:n.length),g.setAttribute("index",ut<1?"1":ut.toString()),d.setAttribute("index",(parseInt(n[n.length-1].getAttribute("index"),10)+1).toString()),this.avgNumItems=rt?this.avgNumItems:n.length)}},ai([t.Property(!1)],r.prototype,"enableQueryString",void 0),ai([t.Property(!1)],r.prototype,"enableExternalMessage",void 0),ai([t.Property(!0)],r.prototype,"enablePagerMessage",void 0),ai([t.Property(12)],r.prototype,"pageSize",void 0),ai([t.Property(10)],r.prototype,"pageCount",void 0),ai([t.Property(1)],r.prototype,"currentPage",void 0),ai([t.Property()],r.prototype,"totalRecordsCount",void 0),ai([t.Property()],r.prototype,"externalMessage",void 0),ai([t.Property(!1)],r.prototype,"pageSizes",void 0),ai([t.Property()],r.prototype,"template",void 0),ai([t.Property("")],r.prototype,"customText",void 0),ai([t.Event()],r.prototype,"click",void 0),ai([t.Property("")],r.prototype,"cssClass",void 0),ai([t.Event()],r.prototype,"dropDownChanged",void 0),ai([t.Event()],r.prototype,"created",void 0),ai([t.NotifyPropertyChanges],r)}(t.Component),out=function(){function n(n){this.pagerModule=n}return n.prototype.getModuleName=function(){return"pagerdropdown"},n.prototype.render=function(){var n=this.pagerModule;this.pagerDropDownDiv=t.createElement("div",{className:"e-pagesizes"});var u=t.createElement("div",{className:"e-pagerdropdown"}),f=t.createElement("div",{className:"e-pagerconstant"}),e=t.createElement("input",{attrs:{type:"text",tabindex:"-1"}});this.pagerCons=t.createElement("span",{className:"e-constant",innerHTML:this.pagerModule.getLocalizedLabel("pagerDropDown")});u.appendChild(e);f.appendChild(this.pagerCons);this.pagerDropDownDiv.appendChild(u);this.pagerDropDownDiv.appendChild(f);this.pagerModule.element.appendChild(this.pagerDropDownDiv);var i=this.pagerModule.pageSizes,o=i.length?this.convertValue(i):[this.pagerModule.getLocalizedLabel("All"),"5","10","12","20"],r=this.pagerModule.pageSize;this.dropDownListObject=new dr.DropDownList({dataSource:o,value:r.toString(),change:this.onChange.bind(this),placeholder:this.pagerModule.getLocalizedLabel("pagerDropDown"),cssClass:this.pagerModule.cssClass?"e-alldrop "+this.pagerModule.cssClass:"e-alldrop"});this.dropDownListObject.appendTo(e);i.length&&(this.dropDownListObject.element.value=this.pagerModule.pageSize.toString());n.pageSize=r;n.dataBind();n.trigger("dropDownChanged",{pageSize:r});this.addEventListener()},n.prototype.onChange=function(n){this.dropDownListObject.value===this.pagerModule.getLocalizedLabel("All")?(this.pagerModule.pageSize=this.pagerModule.totalRecordsCount,this.pagerModule.isAllPage=!0,this.refresh(),n.value=this.pagerModule.pageSize,document.getElementsByClassName("e-popup-open e-alldrop").length&&(document.getElementsByClassName("e-popup-open e-alldrop")[0].style.display="none")):(this.pagerModule.pageSize=parseInt(this.dropDownListObject.value,10),this.pagerModule.isAllPage=!1,this.pagerCons.innerHTML!==this.pagerModule.getLocalizedLabel("pagerDropDown")&&this.refresh());this.pagerModule.dataBind();this.pagerModule.trigger("dropDownChanged",{pageSize:this.pagerModule.isAllPage?this.pagerModule.totalRecordsCount:parseInt(this.dropDownListObject.value,10)})},n.prototype.refresh=function(){this.pagerCons&&(this.pagerCons.innerHTML=this.isPageSizeAll(this.pagerModule.pageSize)?this.pagerModule.getLocalizedLabel("pagerAllDropDown"):this.pagerModule.getLocalizedLabel("pagerDropDown"),this.pagerDropDownDiv.classList.remove("e-hide"))},n.prototype.beforeValueChange=function(n){if("number"==typeof n.newProp.value){var t=n.newProp.value.toString();n.newProp.value=t}},n.prototype.convertValue=function(n){for(var t=n,i=0;i<t.length;i++)t[parseInt(i.toString(),10)]=parseInt(t[parseInt(i.toString(),10)],10)?t[parseInt(i.toString(),10)].toString():""!==this.pagerModule.getLocalizedLabel(t[parseInt(i.toString(),10)])?this.pagerModule.getLocalizedLabel(t[parseInt(i.toString(),10)]):t[parseInt(i.toString(),10)];return t},n.prototype.isPageSizeAll=function(n){return("string"==typeof n&&n!==this.pagerModule.getLocalizedLabel("All")?parseInt(n,10):n)===this.pagerModule.totalRecordsCount||n===this.pagerModule.getLocalizedLabel("All")},n.prototype.setDropDownValue=function(n,t){if(this.dropDownListObject){var i=this.pagerModule.isAllPage;this.pagerModule.isAllPage=this.isPageSizeAll(t);this.pagerModule.checkAll=!(!i||!this.pagerModule.isAllPage);this.dropDownListObject[""+n]=this.pagerModule.isAllPage?this.pagerModule.getLocalizedLabel("All"):t}},n.prototype.addEventListener=function(){this.dropDownListObject.on("beforeValueChange",this.beforeValueChange,this)},n.prototype.removeEventListener=function(){this.dropDownListObject.off("beforeValueChange",this.beforeValueChange)},n.prototype.destroy=function(){this.dropDownListObject&&!this.dropDownListObject.isDestroyed&&(this.removeEventListener(),this.dropDownListObject.destroy(),t.remove(this.pagerDropDownDiv))},n}(),sut=function(){function n(n){this.pagerModule=n}return n.prototype.getModuleName=function(){return"externalMessage"},n.prototype.render=function(){this.element=t.createElement("div",{className:"e-pagerexternalmsg",attrs:{"aria-label":this.pagerModule.getLocalizedLabel("ExternalMsg")}});this.pagerModule.element.appendChild(this.element);this.refresh()},n.prototype.refresh=function(){this.pagerModule.externalMessage&&this.pagerModule.externalMessage.toString().length?(this.showMessage(),this.element.innerHTML=this.pagerModule.externalMessage):this.hideMessage()},n.prototype.hideMessage=function(){t.isNullOrUndefined(this.element)||(this.element.style.display="none")},n.prototype.showMessage=function(){this.element.style.display=""},n.prototype.destroy=function(){t.remove(this.element)},n}(),tc=function(){function n(n,t){this.isInitialRender=!0;this.isCancel=!1;db.Inject(sut,out);this.parent=n;this.pageSettings=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"pager"},n.prototype.render=function(){var i=this.parent,n;this.pagerDestroy();t.isNullOrUndefined(this.parent.pagerTemplate)||(this.pageSettings.template=this.parent.pagerTemplate,this.parent.pageTemplateChange=!0);this.element=this.parent.createElement("div",{className:"e-gridpager"});n=ff({},t.extend({},oo(this.pageSettings)),{click:this.clickHandler.bind(this),dropDownChanged:this.onSelect.bind(this),enableRtl:i.enableRtl,locale:i.locale,created:this.addAriaAttr.bind(this)},["parentObj","propName"]);n.cssClass=this.parent.cssClass?this.parent.cssClass:"";this.pagerObj=new db(n,void 0,this.parent);this.pagerObj.hasParent=!0;this.pagerObj.on(hw,this.renderReactPagerTemplate,this);this.pagerObj.allowServerDataBinding=!1},n.prototype.onSelect=function(n){this.pageSettings.pageSize=n.pageSize;this.isInitialLoad||(this.pageSettings.currentPage=1)},n.prototype.addAriaAttr=function(){var r,u,i,s;if(!this.pageSettings.template){for(var f=this.parent.createElement("div",{className:"e-numericcontainer"}),h=this.element.querySelector(".e-pagercontainer"),e=document.createDocumentFragment(),o=this.element.querySelector(".e-numericcontainer"),t=o.querySelectorAll("a"),n=0;n<t.length;n++)this.parent.getContentTable()?t[parseInt(n.toString(),10)].setAttribute("aria-owns",this.parent.getContentTable().id):t[parseInt(n.toString(),10)].setAttribute("aria-owns",this.parent.element.getAttribute("id")+"_content_table"),r=this.parent.createElement("div"),r.appendChild(t[parseInt(n.toString(),10)]),e.appendChild(r);for(f.appendChild(e),h.replaceChild(f,o),u=[".e-mfirst",".e-mprev",".e-first",".e-prev",".e-next",".e-last",".e-mnext",".e-mlast"],i=0;i<u.length;i++)s=this.element.querySelector(u[parseInt(i.toString(),10)]),this.parent.getContentTable()&&s.setAttribute("aria-owns",this.parent.getContentTable().id)}},n.prototype.dataReady=function(n){this.updateModel(n)},n.prototype.refresh=function(){this.pagerObj.refresh()},n.prototype.goToPage=function(n){this.pagerObj.goToPage(n)},n.prototype.setPageSize=function(n){this.pagerObj.setPageSize(n)},n.prototype.updateModel=function(n){this.parent.pageSettings.totalRecordsCount=n.count;("add"===n.action&&"save"===n.requestType||"batchsave"===n.requestType)&&this.pagerObj.isAllPage&&n.count===this.pageSettings.pageSize&&this.pagerObj.setProperties({pageSize:n.count},!0);this.parent.dataBind()},n.prototype.onActionComplete=function(n){this.parent.trigger(l,t.extend(n,{currentPage:this.parent.pageSettings.currentPage,requestType:"paging",type:l}))},n.prototype.onPropertyChanged=function(n){var i;if(n.module===this.getModuleName()){for(var r=n.properties,t=0,u=Object.keys(r);t<u.length;t++)i=u[t],this.pagerObj[""+i]=r[""+i];this.pagerObj.dataBind()}},n.prototype.clickHandler=function(n){var i=this.parent,r,u;if(this.isForceCancel||sr(i)&&!i.prevPageMoving&&!this.isCancel)return this.isForceCancel?this.isForceCancel=!1:(t.isNullOrUndefined(n.newProp)||t.isNullOrUndefined(n.newProp.pageSize)?n.currentPage&&(i.notify(ci,{instance:this,handler:this.goToPage,arg1:n.currentPage}),this.pagerObj.currentPage=i.pageSettings.currentPage===this.pagerObj.currentPage?this.pagerObj.previousPageNo:i.pageSettings.currentPage):(i.notify(ci,{instance:this,handler:this.setPageSize,arg1:n.newProp.pageSize}),this.pagerObj.pageSize=n.oldProp.pageSize,i.pageSettings.pageSize=n.newProp.pageSize),this.isForceCancel=!0,this.pagerObj.dataBind()),void(n.cancel=!0);if(i.pageSettings.pageSize=this.pagerObj.pageSize,i.prevPageMoving=!1,r=this.pageSettings.currentPage,u={cancel:!1,requestType:"paging",previousPage:r,currentPage:n.currentPage,pageSize:i.pageSettings.pageSize,type:nt},this.isCancel||(this.pageSettings.currentPage=n.currentPage,this.parent.notify(pt,u)),u.cancel)return n.cancel=!0,this.pageSettings.currentPage=r,this.pagerObj.currentPage=r,void(this.isCancel=!0);this.isCancel=!1;this.parent.requestTypeAction="paging"},n.prototype.keyPressHandler=function(n){n.action in hut&&(n.preventDefault(),this.element.querySelector(hut[n.action]).click())},n.prototype.updateExternalMessage=function(n){this.pagerObj.enableExternalMessage||(this.pagerObj.enableExternalMessage=!0,this.pagerObj.dataBind());this.pagerObj.externalMessage=n;this.pagerObj.dataBind()},n.prototype.appendToElement=function(){this.isInitialLoad=!0;this.parent.element.appendChild(this.element);this.parent.setGridPager(this.element);this.pagerObj.isReact=this.parent.isReact;this.pagerObj.isVue=this.parent.isVue;this.pagerObj.appendTo(this.element);this.isInitialLoad=!1},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.render(),this.appendToElement(),this.isReactTemplate()&&(this.pagerObj.updateTotalPages(),this.created()))},n.prototype.addEventListener=function(){this.handlers={load:this.render,end:this.appendToElement,ready:this.dataReady,complete:this.onActionComplete,updateLayout:this.enableAfterRender,inboundChange:this.onPropertyChanged,keyPress:this.keyPressHandler,created:this.created};this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.addEventListener(ih,this.handlers.created.bind(this)),this.evtHandlers=[{event:cr,handler:this.handlers.load},{event:dt,handler:this.handlers.end},{event:ki,handler:this.handlers.ready},{event:ag,handler:this.handlers.complete},{event:tt,handler:this.handlers.updateLayout},{event:gt,handler:this.handlers.inboundChange},{event:ht,handler:this.handlers.keyPress},{event:v,handler:this.destroy}],vt(this.parent,this.evtHandlers,!0,this))},n.prototype.created=function(){this.isInitialRender&&this.isReactTemplate()&&(this.isInitialRender=!1,this.renderReactPagerTemplate())},n.prototype.isReactTemplate=function(){return(this.parent.isReact||this.parent.isVue)&&this.pagerObj.template&&"string"!=typeof this.pagerObj.template},n.prototype.renderReactPagerTemplate=function(){var t;if(!this.isInitialRender&&this.isReactTemplate()){t=void 0;this.parent.destroyTemplate(["pagerTemplate"]);this.element.classList.add("e-pagertemplate");this.pagerObj.compile(this.pagerObj.template);var n=this.parent.pageSettings,i={currentPage:n.currentPage,pageSize:n.pageSize,pageCount:n.pageCount,totalRecordsCount:n.totalRecordsCount,totalPages:this.pagerObj.totalPages},r=this.parent.id+"_pagertemplate";this.parent.isReact?(this.pagerObj.templateFn(i,this.parent,"pagerTemplate",r,null,null,this.pagerObj.element),this.parent.renderTemplates()):(t=this.pagerObj.templateFn(i,this.parent,"pagerTemplate"),kt(this.pagerObj.element,t))}},n.prototype.removeEventListener=function(){this.parent.isDestroyed||((this.parent.isReact||this.parent.isVue)&&this.parent.removeEventListener(ih,this.handlers.created),this.parent.off(hw,this.renderReactPagerTemplate),vt(this.parent,this.evtHandlers,!1))},n.prototype.destroy=function(){this.removeEventListener();this.isReactTemplate()&&this.parent.destroyTemplate(["pagerTemplate"]);this.pagerObj.destroy()},n.prototype.pagerDestroy=function(){this.pagerObj&&!this.pagerObj.isDestroyed&&(this.pagerObj.destroy(),t.remove(this.element))},n}(),hut={pageUp:".e-prev",pageDown:".e-next",ctrlAltPageDown:".e-last",ctrlAltPageUp:".e-first",altPageUp:".e-pp",altPageDown:".e-np"},sht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),cut=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TH",{className:"e-filterbarcell"}),t}return sht(i,n),i.prototype.getGui=function(){return this.parent.createElement("div")},i.prototype.render=function(n,i){var u,y=this.parent.element.querySelector(".e-filterbar"),f=this.element.cloneNode(),e=this.getGui(),r=n.column,s,o,h,l,a,c;if(y.appendChild(f),f.setAttribute("e-mappinguid",r.uid),r.filterTemplate)if(s={},i&&(s[r.field]=i[r.field]),s.column=r,r.visible){var p=this.parent.isReact&&"string"!=typeof r.filterTemplate,w=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,v=this.parent.element.id+r.uid+"filterTemplate";p||w?(r.getFilterTemplate()(s,this.parent,"filterTemplate",v,null,null,f),this.parent.renderTemplates()):kt(f,r.getFilterTemplate()(s,this.parent,"filterTemplate",v))}else f.classList.add("e-hide");else"checkbox"!==r.type&&((t.isNullOrUndefined(r.allowFiltering)||r.allowFiltering)&&!t.isNullOrUndefined(r.filterBarTemplate)?(f.classList.add("e-fltrtemp"),t.attributes(e,{"class":"e-fltrtempdiv"}),t.isNullOrUndefined(r.filterBarTemplate.create))?(u=this.parent.createElement("input",{id:r.field+"_filterBarcell",className:"e-filterUi_input e-filtertext e-fltrTemp",attrs:{type:"search",title:r.headerText}}),e.appendChild(u)):(o={column:r,node:Element},h=r.filterBarTemplate.create,("string"==typeof h&&(h=t.getValue(h,window)),"string"==typeof(u=h(o)))&&(l=this.parent.createElement("div"),l.innerHTML=u,u=l.firstChild),t.attributes(e,{"class":"e-filterUi_input e-filtertext e-fltrTemp",title:r.headerText,id:r.field+"_filterBarcell"}),e.appendChild(u)):(t.attributes(e,{"class":"e-filterdiv e-fltrinputdiv"}),u=this.parent.createElement("input",{id:r.field+"_filterBarcell",className:"e-filtertext",attrs:{type:"search",title:r.headerText+n.attributes.title,value:i[n.column.field]?i[n.column.field]:"",role:"search"}}),e.appendChild(u),o={element:u,floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0,cssClass:this.parent.cssClass}},kr.Input.createInput(o,this.parent.createElement)),(!1===r.allowFiltering||""===r.field||t.isNullOrUndefined(r.field))&&(u.setAttribute("disabled","true"),u.classList.add("e-disable")),a=e.querySelector(".e-clear-icon"),(a&&a.setAttribute("title",this.parent.localeObj.getConstant("ClearButton")),r.visible||f.classList.add("e-hide"),this.appendHtml(f,e),this.parent.filterSettings.showFilterBarOperator&&"FilterBar"===this.parent.filterSettings.type&&!this.parent.isPrinting&&t.isNullOrUndefined(r.filterTemplate)&&t.isNullOrUndefined(r.filterBarTemplate)&&this.operatorIconRender(e,r,n),(t.isNullOrUndefined(r.allowFiltering)||r.allowFiltering)&&!t.isNullOrUndefined(r.filterBarTemplate))&&(c=r.filterBarTemplate.write,o={element:u,column:r},"string"==typeof c&&(c=t.getValue(c,window)),c.call(this,o)));return f},i.prototype.appendHtml=function(n,t){return n.appendChild(t),n},i.prototype.operatorIconRender=function(n,i,r){var f,u=this.parent,c=this.parent.createElement("input",{className:" e-filterbaroperator e-icons e-icon-filter",id:r.column.uid}),e,o,s,h;if(n.querySelector("span").appendChild(c),i.filter&&i.filter.operator)f=i.filter.operator;else if(u.filterSettings.columns.length)for(e=0,o=u.filterSettings.columns;e<o.length;e++)s=o[parseInt(e.toString(),10)],f=s.field===i.field?s.operator:"equal";else f="equal";t.isNullOrUndefined(u.filterModule.operators[i.field])||(f=u.filterModule.operators[i.field]);this.dropOptr=new dr.DropDownList({fields:{text:"text",value:"value"},popupHeight:"auto",value:f,width:"0px",enabled:i.allowFiltering,popupWidth:"auto",enableRtl:this.parent.enableRtl,change:this.internalEvent.bind(this),beforeOpen:function(){var r=u.filterModule.customOperators,n;for(this.dataSource=r[u.getColumnByUid(this.element.id).type+"Operator"],n=0;n<this.dataSource.length;n++)i.filter&&i.filter.operator&&t.isNullOrUndefined(u.filterModule.operators[i.field])&&this.dataSource[parseInt(n.toString(),10)].value===i.filter.operator&&(this.value=i.filter.operator)},cssClass:this.parent.cssClass?"e-popup-flbar "+this.parent.cssClass:"e-popup-flbar"});this.dropOptr.appendTo(c);h=t.closest(this.dropOptr.element,"span");h.classList.add("e-filterbardropdown");h.removeAttribute("tabindex")},i.prototype.internalEvent=function(n){var t=this.parent,i=t.getColumnByUid(n.element.getAttribute("id"));n.column=i;t.filterModule.operators[i.field]=n.value;t.notify(gn,n)},i}(si),lut=function(){function n(n,t,i,r){this.ddOpen=this.dropDownOpen.bind(this);this.parent=n;this.serviceLocator=i;this.filterSettings=r;this.customFilterOperators=t;this.parent&&(this.parent.on(yi,this.destroyDropDownList,this),this.parent.on(v,this.destroyDropDownList,this))}return n.prototype.renderOperatorUI=function(n,i,r,u,f){var e,s;this.dialogObj=u;e=r.type+"Operator";this.optrData=this.customOptr=t.isNullOrUndefined(f)?t.isNullOrUndefined(this.parent.filterSettings.operators)||t.isNullOrUndefined(this.parent.filterSettings.operators[""+e])?this.customFilterOperators[""+e]:this.parent.filterSettings.operators[""+e]:f;var h=this.customOptr,c=this.dropSelectedVal(r,e),o=this.parent.createElement("div",{className:"e-flm_optrdiv"});n.appendChild(o);s=this.parent.createElement("input",{id:r.uid+"-floptr"});o.appendChild(s);this.dropOptr=new dr.DropDownList({dataSource:h,fields:{text:"text",value:"value"},cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",enableRtl:this.parent.enableRtl,text:c,change:function(){var n=document.querySelector(".e-flmenu-valuediv").querySelector("input");"isempty"===this.value||"isnotempty"===this.value||"isnull"===this.value||"isnotnull"===this.value?n.ej2_instances[0].enabled=!1:t.isNullOrUndefined(n.getAttribute("disabled"))||(n.ej2_instances[0].enabled=!0)}});this.dropOptr.addEventListener(bi,this.ddOpen);this.dropOptr.appendTo("#"+r.uid+"-floptr")},n.prototype.renderResponsiveDropDownList=function(n){n.popup.element.style.width="100%"},n.prototype.dropDownOpen=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString();this.parent.enableAdaptiveUI&&this.renderResponsiveDropDownList(n)},n.prototype.dropSelectedVal=function(n){for(var f,o,h,r,i="",e=0,s=this.parent.filterSettings.columns;e<s.length;e++)f=s[e],(n.field===f.field||n.isForeignColumn()&&n.foreignKeyValue===f.field)&&(o=new u.DataManager(this.optrData).executeLocal((new u.Query).where("value","equal",f.operator)),i=t.isNullOrUndefined(o[0])?"":o[0].text);if(""===i)if(n.filter.operator)for(h=Object.keys(this.optrData).length,r=0;r<h;r++)this.optrData[parseInt(r.toString(),10)].value===n.filter.operator&&(i=this.optrData[parseInt(r.toString(),10)].text);else i=this.optrData[0].text;return i},n.prototype.getFlOperator=function(){return this.dropOptr.value},n.prototype.destroyDropDownList=function(){this.dropOptr.isDestroyed||(this.dropOptr.removeEventListener(bi,this.ddOpen),this.dropOptr.destroy(),this.parent.off(yi,this.destroyDropDownList),this.parent.off(v,this.destroyDropDownList))},n}(),aut=function(){function n(n,t,i){this.parent=n;this.serLocator=t;this.filterSettings=i;this.parent&&(this.parent.on(yi,this.destroy,this),this.parent.on(v,this.destroy,this))}return n.prototype.create=function(n){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"strui-"+n.column.uid});n.target.appendChild(this.instance);this.dialogObj=n.dialogObj;this.processDataOperation(n)},n.prototype.processDataOperation=function(n){var t=this;n.column.isForeignColumn()?this.parent.getDataModule().dataManager.executeQuery(this.parent.getDataModule().generateQuery(!0)).then(function(i){t.getAutoCompleteOptions(n,i)}):this.getAutoCompleteOptions(n)},n.prototype.getAutoCompleteOptions=function(n,i){var a,f=n.column.isForeignColumn(),c;if(f){for(var h=ru.getDistinct(i.result,n.column.field).records||[],o=void 0,s=0;s<h.length;s++)o=o?o.or(n.column.field,"contains",h[parseInt(s.toString(),10)][n.column.field],this.parent.filterSettings.enableCaseSensitivity,this.parent.filterSettings.ignoreAccent):new u.Predicate(n.column.field,"contains",h[parseInt(s.toString(),10)][n.column.field],this.parent.filterSettings.enableCaseSensitivity,this.parent.filterSettings.ignoreAccent);(a=(new u.Query).where(o)).params=this.parent.query.params}var e=f?n.column.dataSource:this.parent.dataSource,v={value:f?n.column.foreignKeyValue:n.column.field},r=new dr.AutoComplete(t.extend({dataSource:e instanceof u.DataManager?e:new u.DataManager(e),fields:v,locale:this.parent.locale,enableRtl:this.parent.enableRtl,query:f?a:this.parent.getDataModule().generateQuery(!0,!0),sortOrder:"Ascending",cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",autofill:!0,placeholder:n.localizeText.getConstant("EnterValue"),actionBegin:function(){if(this.query.queries.length&&"onWhere"===this.query.queries[0].fn&&this.query.queries[0].e&&this.query.queries[0].e.predicates){for(var n=0;n<this.query.queries[0].e.predicates.length;n++)this.properties.fields.value===this.query.queries[0].e.predicates[""+n].field&&(this.query.queries[0].e.predicates.splice(n,1),n-=1);this.query.queries[0].e.predicates.length||this.query.queries.splice(0,1)}}},n.column.filter.params));(this.acFocus=this.focus(r,n),this.acComplete=this.actionComplete(r),this.acOpen=this.openPopup.bind(this),r.addEventListener(ie,this.acFocus),r.addEventListener(bi,this.acOpen),r.addEventListener(l,this.acComplete),e&&"result"in e)&&(c=lv({requestType:"stringfilterrequest"},this.parent.getQuery?this.parent.getQuery().clone():new u.Query),this.parent.trigger(be,c.state),c.deffered.promise.then(function(n){r.dataSource=new u.DataManager(n)}));this.actObj=r;this.actObj.appendTo(this.instance);f&&this.parent.filterModule.filterModule.afterRenderFilterUI()},n.prototype.write=function(n){""===n.filteredValue||t.isNullOrUndefined(n.filteredValue)||(document.querySelector("#strui-"+n.column.uid).ej2_instances[0].value=n.filteredValue)},n.prototype.read=function(n,i,r,u){var e=document.querySelector("#strui-"+i.uid).ej2_instances[0],f;t.Browser.isDevice&&(e.hidePopup(),e.focusOut());f=e.value;(t.isNullOrUndefined(f)||""===f)&&(f=null);u.filterByColumn(i.field,r,f,"and",this.parent.filterSettings.enableCaseSensitivity)},n.prototype.openPopup=function(n){sb(n,this.dialogObj)},n.prototype.focus=function(n,t){return function(){n.filterType=t.getOptrInstance.getFlOperator()}},n.prototype.actionComplete=function(n){return function(i){i.result=i.result.filter(function(i,r,u){return u.map(function(i){return t.getValue(n.fields.value,i)}).indexOf(t.getValue(n.fields.value,i))===r})}},n.prototype.destroy=function(){this.actObj&&!this.actObj.isDestroyed&&(this.actObj.removeEventListener(ie,this.acFocus),this.actObj.removeEventListener(bi,this.acOpen),this.actObj.removeEventListener(l,this.acComplete),this.actObj.destroy(),this.parent.off(yi,this.destroy),this.parent.off(v,this.destroy))},n}(),vut=function(){function n(n,t,i){this.filterSettings=i;this.parent=n;this.serviceLocator=t;this.parent&&(this.parent.on(yi,this.destroy,this),this.parent.on(v,this.destroy,this))}return n.prototype.keyEventHandler=function(n){if(13===n.keyCode||9===n.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0);this.dispatchEvent(t)}},n.prototype.create=function(n){this.instance=this.parent.createElement("input",{className:"e-flmenu-input",id:"numberui-"+n.column.uid});n.target.appendChild(this.instance);this.numericTxtObj=new kr.NumericTextBox(t.extend({format:"string"==typeof n.column.format||t.isUndefined(n.column.format)?n.column.format:n.column.format.format,locale:this.parent.locale,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("EnterValue"),enableRtl:this.parent.enableRtl},n.column.filter.params));this.numericTxtObj.appendTo(this.instance)},n.prototype.write=function(n){var t=document.querySelector("#numberui-"+n.column.uid).ej2_instances[0];t.element.addEventListener("keydown",this.keyEventHandler);t.value=n.filteredValue},n.prototype.read=function(n,t,i,r){var u=document.querySelector("#numberui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,u,"and",!0)},n.prototype.destroy=function(){this.numericTxtObj&&!this.numericTxtObj.isDestroyed&&(this.numericTxtObj.destroy(),this.parent.off(yi,this.destroy),this.parent.off(v,this.destroy))},n}(),yut=function(){function n(n,t,i){this.parent=n;this.serviceLocator=t;this.filterSettings=i;this.parent&&(this.parent.on(yi,this.destroy,this),this.parent.on(v,this.destroy,this))}return n.prototype.create=function(n){var f=n.column.isForeignColumn(),r=f?n.column.dataSource:this.parent.dataSource,i=f?n.column.foreignKeyValue:n.column.field;this.elem=this.parent.createElement("input",{className:"e-flmenu-input",id:"bool-ui-"+n.column.uid});n.target.appendChild(this.elem);this.dialogObj=n.dialogObj;this.dropInstance=new dr.DropDownList(t.extend({dataSource:r instanceof u.DataManager?r:new u.DataManager(r),query:(new u.Query).select(i),fields:{text:i,value:i},placeholder:n.localizeText.getConstant("SelectValue"),cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",locale:this.parent.locale,enableRtl:this.parent.enableRtl},n.column.filter.params));this.ddOpen=this.openPopup.bind(this);this.ddComplete=this.actionComplete(i);this.dropInstance.addEventListener(bi,this.ddOpen);this.dropInstance.addEventListener(l,this.ddComplete);this.dropInstance.appendTo(this.elem)},n.prototype.write=function(n){var i=document.querySelector("#bool-ui-"+n.column.uid).ej2_instances[0];t.isNullOrUndefined(n.filteredValue)||(i.value=n.filteredValue)},n.prototype.read=function(n,t,i,r){var u=document.querySelector("#bool-ui-"+t.uid).ej2_instances[0].value;r.filterByColumn(t.field,i,u,"and",!1)},n.prototype.openPopup=function(n){sb(n,this.dialogObj)},n.prototype.actionComplete=function(n){return function(t){t.result=u.DataUtil.distinct(t.result,n,!0)}},n.prototype.destroy=function(){this.dropInstance&&!this.dropInstance.isDestroyed&&(this.dropInstance.removeEventListener(bi,this.ddOpen),this.dropInstance.removeEventListener(l,this.ddComplete),this.dropInstance.destroy(),this.parent.off(yi,this.destroy),this.parent.off(v,this.destroy))},n}(),kv=function(){function n(n,t,i){this.dpOpen=this.openPopup.bind(this);this.parent=n;this.locator=t;this.fltrSettings=i;this.parent&&(this.parent.on(yi,this.destroy,this),this.parent.on(v,this.destroy,this))}return n.prototype.create=function(n){var i=ph(n.column.format,n.column.type);this.dialogObj=n.dialogObj;this.inputElem=this.parent.createElement("input",{className:"e-flmenu-input",id:"dateui-"+n.column.uid});n.target.appendChild(this.inputElem);"date"===n.column.type||"dateonly"===n.column.type?this.datePickerObj=new se.DatePicker(t.extend({format:i,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},n.column.filter.params)):"datetime"===n.column.type&&(this.datePickerObj=new se.DateTimePicker(t.extend({format:i,cssClass:this.parent.cssClass?"e-popup-flmenu "+this.parent.cssClass:"e-popup-flmenu",placeholder:n.localizeText.getConstant("ChooseDate"),width:"100%",locale:this.parent.locale,enableRtl:this.parent.enableRtl},n.column.filter.params)));this.datePickerObj.addEventListener(bi,this.dpOpen);this.datePickerObj.appendTo(this.inputElem)},n.prototype.write=function(n){document.querySelector("#dateui-"+n.column.uid).ej2_instances[0].value=t.isNullOrUndefined(n.filteredValue)?null:new Date(n.filteredValue)},n.prototype.read=function(n,i,r,u){var f=document.querySelector("#dateui-"+i.uid).ej2_instances[0].value;f=t.isNullOrUndefined(f)?null:f;u.filterByColumn(i.field,r,f,"and",!0)},n.prototype.openPopup=function(n){n.popup.element.style.zIndex=(this.dialogObj.zIndex+1).toString()},n.prototype.destroy=function(){this.parent.off(yi,this.destroy);this.parent.off(v,this.destroy);t.isNullOrUndefined(this.datePickerObj)||this.datePickerObj.isDestroyed||(this.datePickerObj.removeEventListener(bi,this.dpOpen),this.datePickerObj.destroy())},n}(),hht=function(){function n(n,t,i,r,u){this.isDialogOpen=!1;this.maxHeight="350px";this.isMenuCheck=!1;this.colTypes={string:aut,number:vut,date:kv,dateonly:kv,boolean:yut,datetime:kv};this.parent=n;this.filterSettings=t;this.serviceLocator=i;this.customFilterOperators=r;this.filterObj=u;this.flMuiObj=new lut(this.parent,this.customFilterOperators,this.serviceLocator);this.l10n=this.serviceLocator.getService("localization");this.menuFilterBase=new ru(n)}return n.prototype.clearCustomFilter=function(n){this.clearBtnClick(n)},n.prototype.applyCustomFilter=function(n){this.filterBtnClick(n.col)},n.prototype.openDialog=function(n){this.options=n;this.col=this.parent.getColumnByField(n.field);(t.isNullOrUndefined(this.col.filter)||t.isNullOrUndefined(this.col.filter.type)||"Menu"===this.col.filter.type)&&this.renderDlgContent(n.target,this.col)},n.prototype.closeDialog=function(n){var i,r;if(this.dlgObj){if((this.parent.isReact||this.parent.isVue)&&yo(this.parent,["filterTemplate"]),i=document.getElementById(this.dlgObj.element.id),this.dlgObj&&!this.dlgObj.isDestroyed&&i){if(r={cancel:!1,column:this.col,target:n,element:i},this.parent.notify(yi,r),r.cancel)return;this.isDialogOpen=!1;this.isMenuCheck&&(this.menuFilterBase.unWireEvents(),this.parent.off(df,this.actionComplete),this.isMenuCheck=!1);this.dlgObj.destroy();t.remove(i)}this.parent.notify(bs,{})}},n.prototype.renderDlgContent=function(n,r){var u={requestType:by,columnName:r.field,columnType:r.type},f;u.filterModel=this;this.parent.trigger(nt,u);f=this.parent.createElement("div",{className:"e-flmenu-maindiv",id:r.uid+"-flmenu"});this.dlgDiv=this.parent.createElement("div",{className:"e-flmenu",id:r.uid+"-flmdlg"});this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("FilterMenuDialogARIA"));this.parent.enableAdaptiveUI?document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv").appendChild(this.dlgDiv):this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new bt.Dialog({showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,created:this.dialogCreated.bind(this,n,r),position:this.parent.element.classList.contains("e-device")?{X:"center",Y:"center"}:{X:"",Y:""},target:this.parent.element.classList.contains("e-device")?document.body:this.parent.element,buttons:[{click:this.filterBtnClick.bind(this,r),buttonModel:{content:this.l10n.getConstant("FilterButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-flmenu-okbtn "+this.parent.cssClass:"e-flmenu-okbtn"}},{click:this.clearBtnClick.bind(this,r),buttonModel:{content:this.l10n.getConstant("ClearButton"),cssClass:this.parent.cssClass?"e-flmenu-cancelbtn "+this.parent.cssClass:"e-flmenu-cancelbtn"}}],content:f,width:!t.isNullOrUndefined(i(n,"e-bigger"))||this.parent.element.classList.contains("e-device")?260:250,animationSettings:{effect:"None"},cssClass:this.parent.cssClass?"e-filter-popup "+this.parent.cssClass:"e-filter-popup"});this.dlgObj.isStringTemplate=!0;this.renderResponsiveDialog();this.dlgObj.appendTo(this.dlgDiv)},n.prototype.renderResponsiveDialog=function(){this.parent.enableAdaptiveUI&&(this.dlgObj.position={X:"",Y:""},this.dlgObj.target=document.querySelector(".e-resfilter > .e-dlg-content > .e-mainfilterdiv"),this.dlgObj.width="100%",this.dlgObj.isModal=!1,this.dlgObj.buttons=[{}])},n.prototype.dialogCreated=function(n,i){!t.Browser.isDevice&&n&&ob(n,this.dlgObj);this.currentDialogCreatedColumn=i;this.renderFilterUI(n,i);i.isForeignColumn()&&(t.isNullOrUndefined(i.filter)||t.isNullOrUndefined(i.filter.ui)||t.isNullOrUndefined(i.filter.ui.create))||this.afterRenderFilterUI()},n.prototype.afterRenderFilterUI=function(){var n=this.currentDialogCreatedColumn,i,r,u;n.showColumnMenu&&this.parent.notify(we,{});this.parent.enableAdaptiveUI?(this.dlgObj.element.style.left="0px",this.dlgObj.element.style.maxHeight="none"):this.dlgObj.element.style.maxHeight=this.maxHeight;this.dlgObj.show();i=this.dlgObj.element.querySelector(".e-flm_optrdiv").querySelector("input");r=this.dlgObj.element.querySelector(".e-flmenu-valuediv").querySelector("input");"Empty"===i.value||"Not Empty"===i.value||"Null"===i.value||"Not Null"===i.value?r.ej2_instances[0].enabled=!1:t.isNullOrUndefined(r&&r.getAttribute("disabled"))||(r.ej2_instances[0].enabled=!0);n.filterTemplate||this.writeMethod(n,this.dlgObj.element.querySelector("#"+n.uid+"-flmenu"));u={requestType:wy,columnName:n.field,columnType:n.type};u.filterModel=this;this.isDialogOpen=!0;this.isMenuCheck||this.parent.trigger(l,u)},n.prototype.renderFilterUI=function(n,t){var i=this.dlgObj.element.querySelector(".e-flmenu-maindiv");this.parent.log("column_type_missing",{column:t});this.renderOperatorUI(i,n,t);this.renderFlValueUI(i,n,t)},n.prototype.renderOperatorUI=function(n,t,i){this.flMuiObj.renderOperatorUI(n,t,i,this.dlgObj,this.filterObj.menuOperator)},n.prototype.renderFlValueUI=function(n,i,r){var f=this.parent.createElement("div",{className:"e-flmenu-valuediv"}),o=this.filterObj,s,u,e;if(n.appendChild(f),s=new this.colTypes[r.type](this.parent,this.serviceLocator,this.parent.filterSettings),r.filterTemplate){u={};u[r.field]=u.value=o.values[r.field];r.foreignKeyValue&&(u[r.foreignKeyValue]=o.values[r.field],u[r.field]=void 0);u.column=r;var c=this.parent.isReact&&"string"!=typeof r.filterTemplate,l=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,h=this.parent.element.id+r.uid+"filterTemplate";c||l?(r.getFilterTemplate()(u,this.parent,"filterTemplate",h,null,null,f),this.parent.renderTemplates()):kt(f,r.getFilterTemplate()(u,this.parent,"filterTemplate",h));this.isMenuCheck&&(this.menuFilterBase.cBox=this.dlgObj.element.querySelector(".e-checkboxlist.e-fields"),this.menuFilterBase.wireEvents(),this.parent.on(df,this.actionComplete,this),this.menuFilterBase.getAllData())}else t.isNullOrUndefined(r.filter)||t.isNullOrUndefined(r.filter.ui)||t.isNullOrUndefined(r.filter.ui.create)?s.create({column:r,target:f,getOptrInstance:this.flMuiObj,localizeText:this.l10n,dialogObj:this.dlgObj}):(e=r.filter.ui.create,"string"==typeof e&&(e=t.getValue(e,window)),e({column:r,target:f,getOptrInstance:this.flMuiObj,dialogObj:this.dlgObj}))},n.prototype.writeMethod=function(n,i){for(var e,r,u,o=i.querySelector(".e-flmenu-valinput"),h=new this.colTypes[n.type](this.parent,this.serviceLocator,this.parent.filterSettings),f=0,s=this.filterSettings.columns;f<s.length;f++)e=s[f],n.uid===e.uid&&(u=e.value);t.isNullOrUndefined(n.filter)||t.isNullOrUndefined(n.filter.ui)||t.isNullOrUndefined(n.filter.ui.write)?h.write({column:n,target:o,parent:this.parent,filteredValue:u}):(r=n.filter.ui.write,"string"==typeof r&&(r=t.getValue(r,window)),r({column:n,target:o,parent:this.parent,filteredValue:u}))},n.prototype.filterBtnClick=function(n){var o=this.dlgObj.element.querySelector(".e-flmenu-valuediv input"),e=this.flMuiObj.getFlOperator(),s=new this.colTypes[n.type](this.parent,this.serviceLocator,this.parent.filterSettings),i,u,r,f;n.filterTemplate?(i=this.dlgDiv.querySelector(".e-flmenu-valuediv"),u=void 0,i.children[0].value?u=i.children[0].value:t.isNullOrUndefined(i.children[0].ej2_instances)?(r=i.querySelector(".e-control"),t.isNullOrUndefined(r)||(u="boolean"===n.type?r.checked:t.isNullOrUndefined(r.ej2_instances)?r.value:r.ej2_instances[0].value)):u=(this.parent.isAngular?i.children[0]:i.querySelector("input")).ej2_instances[0].value,this.filterObj.filterByColumn(n.field,e,u)):t.isNullOrUndefined(n.filter)||t.isNullOrUndefined(n.filter.ui)||t.isNullOrUndefined(n.filter.ui.read)?s.read(o,n,e,this.filterObj):(f=n.filter.ui.read,"string"==typeof f&&(f=t.getValue(f,window)),f({element:o,column:n,operator:e,fltrObj:this.filterObj}));this.closeDialog();this.parent.showColumnMenu&&this.parent.notify(nh,{})},n.prototype.closeResponsiveDialog=function(){this.closeDialog()},n.prototype.clearBtnClick=function(n){this.filterObj.removeFilteredColsByField(n.field);this.closeDialog();var i=this.parent.showColumnMenu&&n.showColumnMenu?".e-columnmenu":".e-icon-filter",t=this.parent.element.querySelector('[e-mappinguid="'+n.uid+'"]').parentElement.querySelector(i);t&&t.classList.remove("e-filtered")},n.prototype.destroy=function(){this.closeDialog()},n.prototype.getFilterUIInfo=function(){return{field:this.col.field,operator:this.flMuiObj.getFlOperator()}},n.prototype.renderCheckBoxMenu=function(){return this.isMenuCheck=!0,this.menuFilterBase.updateModel(this.options),this.menuFilterBase.getAndSetChkElem(this.options),this.dlgObj.buttons=[{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{content:this.menuFilterBase.getLocalizedLabel("FilterButton"),cssClass:"e-primary",isPrimary:!0}},{click:this.menuFilterBase.btnClick.bind(this.menuFilterBase),buttonModel:{cssClass:"e-flat",content:this.menuFilterBase.getLocalizedLabel("ClearButton")}}],this.menuFilterBase.dialogObj=this.dlgObj,this.menuFilterBase.dlg=this.dlgObj.element,this.menuFilterBase.dlg.classList.add("e-menucheckbox"),this.menuFilterBase.dlg.classList.remove("e-checkboxfilter"),this.maxHeight="800px",this.menuFilterBase.sBox.innerHTML},n.prototype.actionComplete=function(n){this.isMenuCheck&&this.parent.trigger(l,n)},n}(),gb=function(){function n(n){this.parent=n;this.isresetFocus=!0;this.checkBoxBase=new ru(n);this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener();this.checkBoxBase.closeDialog()},n.prototype.openDialog=function(n){this.checkBoxBase.openDialog(n);this.parent.log("column_type_missing",{column:n.column})},n.prototype.closeDialog=function(){this.destroy();this.isresetFocus&&this.parent.notify(tf,{})},n.prototype.closeResponsiveDialog=function(){this.checkBoxBase.closeDialog()},n.prototype.getModuleName=function(){return"checkboxFilter"},n.prototype.actionBegin=function(n){this.parent.trigger(nt,n)},n.prototype.actionComplete=function(n){this.parent.trigger(l,n)},n.prototype.actionPrevent=function(n){sr(this.parent)&&(this.parent.notify(ci,n),n.cancel=!0)},n.prototype.clearCustomFilter=function(n){this.checkBoxBase.clearFilter(n)},n.prototype.applyCustomFilter=function(){this.checkBoxBase.fltrBtnHandler();this.checkBoxBase.closeDialog()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(cl,this.actionBegin,this),this.parent.on(df,this.actionComplete,this),this.parent.on(ge,this.actionPrevent,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cl,this.actionBegin),this.parent.off(df,this.actionComplete),this.parent.off(ge,this.actionPrevent))},n}(),cht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),put=function(n){function t(t,i,r,u){var f=n.call(this,t,i,r)||this;return f.parent=t,f.isresetFocus=!0,f.excelFilterBase=new uut(t,u),f}return cht(t,n),t.prototype.destroy=function(){this.excelFilterBase.closeDialog()},t.prototype.openDialog=function(n){this.excelFilterBase.openDialog(n)},t.prototype.closeDialog=function(){this.excelFilterBase.closeDialog();this.isresetFocus&&this.parent.notify(tf,{})},t.prototype.clearCustomFilter=function(n){this.excelFilterBase.clearFilter(n)},t.prototype.closeResponsiveDialog=function(n){n?this.excelFilterBase.removeDialog():this.closeDialog()},t.prototype.applyCustomFilter=function(n){n.isCustomFilter?this.excelFilterBase.filterBtnClick(n.col.field):(this.excelFilterBase.fltrBtnHandler(),this.excelFilterBase.closeDialog())},t.prototype.filterByColumn=function(n,t,i,r,u,f,e,o){this.excelFilterBase.filterByColumn(n,t,i,r,u,f,e,o)},t.prototype.getFilterUIInfo=function(){return this.excelFilterBase.getFilterUIInfo()},t.prototype.getModuleName=function(){return"excelFilter"},t}(gb),dv=function(){function n(n,t,i){this.predicate="and";this.contentRefresh=!0;this.filterByMethod=!0;this.refresh=!0;this.values={};this.operators={};this.cellText={};this.nextFlMenuOpen="";this.type={Menu:hht,CheckBox:gb,Excel:put};this.filterOperators={contains:"contains",endsWith:"endswith",equal:"equal",greaterThan:"greaterthan",greaterThanOrEqual:"greaterthanorequal",lessThan:"lessthan",lessThanOrEqual:"lessthanorequal",notEqual:"notequal",startsWith:"startswith",wildCard:"wildcard",isNull:"isnull",notNull:"notnull",like:"like"};this.fltrDlgDetails={field:"",isOpen:!1};this.skipNumberInput=["="," ","!"];this.skipStringInput=[">","<","="];this.actualPredicate={};this.parent=n;this.filterSettings=t;this.serviceLocator=i;this.addEventListener();this.setFullScreenDialog()}return n.prototype.render=function(n){var i,e,r,h,c,l,f;u.DataUtil.getObject("args.isFrozen",n)||this.parent.getFrozenMode()===s&&u.DataUtil.getObject("args.renderFrozenRightContent",n)||(i=this.parent,(this.l10n=this.serviceLocator.getService("localization"),this.getLocalizedCustomOperators(),"FilterBar"===this.parent.filterSettings.type&&i.columns.length)&&(e=this.parent.element.querySelector(".e-filterbar"),e&&t.remove(e),r=new oi(this.serviceLocator,o.Filter,i),this.serviceLocator.getService("cellRendererFactory").addCellRenderer(o.Filter,new cut(this.parent,this.serviceLocator)),this.valueFormatter=this.serviceLocator.getService("valueFormatter"),r.element=this.parent.createElement("tr",{className:"e-filterbar"}),h=this.generateRow(),h.data=this.values,"Right"===i.getFrozenMode()?i.getFrozenRightHeader().querySelector("thead").appendChild(r.element):this.parent.getHeaderContent().querySelector("thead:not(.e-masked-thead)").appendChild(r.element),c=this.parent.element.querySelector(".e-rowdragheader"),this.element=r.render(h,i.getColumns(),null,null,r.element),l=this.element.querySelector(".e-detailheadercell"),l&&(l.className="e-filterbarcell e-mastercell"),c&&(c.className="e-dragheadercell e-mastercell"),f=[].slice.call(this.element.getElementsByClassName("e-grouptopleftcell")),f.length&&f[f.length-1].classList.add("e-lastgrouptopleftcell"),this.wireEvents(),this.parent.notify(ei,{"case":"filter"})))},n.prototype.showCustomFilter=function(n){this.responsiveDialogRenderer.isCustomDialog=n;this.responsiveDialogRenderer.showResponsiveDialog(this.column)},n.prototype.setFilterModel=function(n){var t=n.filter.type||this.parent.filterSettings.type;this.filterModule=new this.type[""+t](this.parent,this.parent.filterSettings,this.serviceLocator,this.customOperators,this)},n.prototype.destroy=function(){var r=this.parent.element,i,n,u;if(r&&(r.querySelector("."+ct)||r.querySelector("."+ot))){if(this.filterModule&&this.filterModule.destroy(),this.parent.refreshing||!this.parent.isDestroyed&&this.parent.allowFiltering||(this.filterSettings.columns=[]),this.updateFilterMsg(),this.removeEventListener(),this.unWireEvents(),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator)for(i=[].slice.call(this.element.getElementsByClassName("e-filterbaroperator")),n=0;n<i.length;n++)i[parseInt(n.toString(),10)].ej2_instances[0]&&i[parseInt(n.toString(),10)].ej2_instances[0].destroy();this.element&&(this.element.parentElement&&t.remove(this.element),u=this.parent.getHeaderContent().querySelector(".e-filterbar"),this.parent.isFrozenGrid()&&u&&t.remove(u))}},n.prototype.setFullScreenDialog=function(){this.serviceLocator&&this.serviceLocator.registerAdaptiveService(this,this.parent.enableAdaptiveUI,g.isFilter)},n.prototype.generateRow=function(){var n=new lr({});return n.cells=this.generateCells(),n},n.prototype.generateCells=function(){var n=[],i,u,t,r,f;if(this.parent.allowGrouping)for(i=0,u=this.parent.groupSettings.columns.length;i<u;i++)n.push(this.generateCell({},o.HeaderIndent));for((this.parent.detailTemplate||this.parent.childGrid)&&n.push(this.generateCell({},o.DetailHeader)),this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()&&n.push(this.generateCell({},o.RowDragHIcon)),t=0,r=this.parent.getColumns();t<r.length;t++)f=r[t],n.push(this.generateCell(f));return"Right"===this.parent.getFrozenMode()&&n.push(this.generateCell({},o.RowDragHIcon)),n},n.prototype.generateCell=function(n,t){var i={visible:n.visible,isDataCell:!1,rowId:"",column:n,cellType:t||o.Filter,attributes:{title:this.l10n.getConstant("FilterbarTitle")}};return new pi(i)},n.prototype.updateModel=function(){var i=this.column.isForeignColumn()?this.parent.getColumnByUid(this.column.uid):this.parent.getColumnByField(this.fieldName),r,u,e,n;this.filterObjIndex=this.getFilteredColsIndexByField(i);this.prevFilterObject=this.filterSettings.columns[this.filterObjIndex];for(var o=Array.isArray(this.value)?this.value:[this.value],s=this.parent.dataSource.adaptor&&this.parent.dataSource.adaptor.getModuleName?this.parent.dataSource.adaptor.getModuleName():void 0,f=0,h=o.length;f<h;f++)if(r=i.isForeignColumn()?i.foreignKeyValue:this.fieldName,u="notequal"===this.operator,this.currentFilterObject={field:r,uid:i.uid,isForeignKey:i.isForeignColumn(),operator:this.operator,value:o[parseInt(f.toString(),10)],predicate:this.predicate,matchCase:this.matchCase,ignoreAccent:this.ignoreAccent,actualFilterValue:{},actualOperator:{}},e=this.getFilteredColsIndexByField(i),e>-1&&!Array.isArray(this.value)?this.filterSettings.columns[parseInt(e.toString(),10)]=this.currentFilterObject:this.filterSettings.columns.push(this.currentFilterObject),!this.column.isForeignColumn()&&t.isNullOrUndefined(this.value)&&("equal"===this.operator||"notequal"===this.operator)&&"ODataAdaptor"!==s&&"ODataV4Adaptor"!==s){for(n=0;n<this.filterSettings.columns.length;n++)this.filterSettings.columns[""+n].field===r&&("equal"===this.filterSettings.columns[""+n].operator||"notequal"===this.filterSettings.columns[""+n].operator)&&t.isNullOrUndefined(this.filterSettings.columns[""+n].value)&&(this.filterSettings.columns.splice(n,1),n-=1);"string"===i.type&&this.filterSettings.columns.push({field:r,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:u?"and":"or",value:""});this.filterSettings.columns.push({field:r,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:u?"and":"or",value:void 0});this.filterSettings.columns.push({field:r,ignoreAccent:this.ignoreAccent,matchCase:this.matchCase,operator:this.operator,predicate:u?"and":"or",value:null})}this.filterSettings.columns=this.filterSettings.columns;this.parent.dataBind()},n.prototype.getFilteredColsIndexByField=function(n){for(var i=this.filterSettings.columns,t=0,r=i.length;t<r;t++)if(i[parseInt(t.toString(),10)].uid===n.uid||n.isForeignColumn()&&this.parent.getColumnByUid(n.uid).field===n.foreignKeyValue)return t;return-1},n.prototype.onActionComplete=function(n){var i=this.isRemove?{requestType:"filtering",type:l}:{currentFilterObject:this.currentFilterObject,currentFilteringColumn:t.isNullOrUndefined(this.column)?void 0:this.column.field,columns:this.filterSettings.columns,requestType:"filtering",type:l};this.parent.trigger(l,t.extend(n,i));this.isRemove=!1},n.prototype.wireEvents=function(){t.EventHandler.add(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate,this)},n.prototype.unWireEvents=function(){t.EventHandler.remove(this.parent.getHeaderContent(),"keyup",this.keyUpHandlerImmediate)},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&(this.parent.getHeaderTable().classList.add("e-sortfilter"),this.render())},n.prototype.refreshFilterValue=function(){this.parent.removeEventListener(is,this.refreshFilterValueFn);"FilterBar"===this.filterSettings.type&&this.filterSettings.columns.length&&!this.parent.getCurrentViewRecords().length&&this.initialEnd()},n.prototype.initialEnd=function(){var r,t,i,n;if(this.parent.off(it,this.initialEnd),this.parent.getColumns().length&&this.filterSettings.columns.length){for(r=this.parent,this.contentRefresh=!1,this.initialLoad=!0,t=0,i=r.filterSettings.columns;t<i.length;t++)n=i[t],this.filterByColumn(n.field,n.operator,n.value,n.predicate,n.matchCase,n.ignoreAccent,n.actualFilterValue,n.actualOperator);this.initialLoad=!1;this.updateFilterMsg();this.contentRefresh=!0}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(io,this.setFullScreenDialog,this),this.parent.on(tt,this.enableAfterRender,this),this.parent.on(dy,this.onActionComplete,this),this.parent.on(gt,this.onPropertyChanged,this),this.parent.on(ht,this.keyUpHandler,this),this.parent.on(wf,this.columnPositionChanged,this),this.parent.on(yt,this.render,this),this.parent.on(it,this.initialEnd,this),this.parent.on(yi,this.filterMenuClose,this),this.docClickHandler=this.clickHandler.bind(this),t.EventHandler.add(document,"click",this.docClickHandler,this),t.EventHandler.add(this.parent.element,"mousedown",this.refreshClearIcon,this),this.parent.on(il,this.columnMenuFilter,this),this.parent.on(ii,this.filterIconClickHandler,this),this.parent.on("persist-data-changed",this.initialEnd,this),this.parent.on(kl,this.clickHandler,this),this.parent.on(v,this.destroy,this),this.refreshFilterValueFn=this.refreshFilterValue.bind(this),this.parent.addEventListener(is,this.refreshFilterValueFn))},n.prototype.removeEventListener=function(){t.EventHandler.remove(document,"click",this.docClickHandler);t.EventHandler.remove(this.parent.element,"mousedown",this.refreshClearIcon);this.parent.isDestroyed||(this.parent.off(io,this.setFullScreenDialog),this.parent.off(tt,this.enableAfterRender),this.parent.off(dy,this.onActionComplete),this.parent.off(gt,this.onPropertyChanged),this.parent.off(ht,this.keyUpHandler),this.parent.off(wf,this.columnPositionChanged),this.parent.off(yt,this.render),this.parent.off(il,this.columnMenuFilter),this.parent.off(yi,this.filterMenuClose),this.parent.off(ii,this.filterIconClickHandler),this.parent.off(kl,this.clickHandler),this.parent.off(v,this.destroy))},n.prototype.refreshClearIcon=function(n){if(this.parent.allowFiltering&&"FilterBar"===this.parent.filterSettings.type&&n.target.closest("th")&&n.target.closest("th").classList.contains("e-filterbarcell")&&n.target.classList.contains("e-clear-icon")){var t=n.target.previousElementSibling;kr.Input.setValue(null,t,"Never",!0);"Immediate"===this.filterSettings.mode&&this.removeFilteredColsByField(t.id.slice(0,-14))}},n.prototype.filterMenuClose=function(){this.fltrDlgDetails.isOpen=!1},n.prototype.filterByColumn=function(n,i,r,u,f,e,o,s){var h,a=this,c=this.parent,l;if(this.column=c.grabColumnByFieldFromAllCols(n),"FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&t.isNullOrUndefined(this.column.filterBarTemplate)&&t.isNullOrUndefined(this.column.filterTemplate)&&(i=this.getOperatorName(n)),"like"===i&&-1===r.indexOf("%")&&(r="%"+r+"%"),this.column)if("FilterBar"===this.filterSettings.type&&(h=c.getHeaderContent().querySelector("[id='"+this.column.field+"_filterBarcell']")),t.isNullOrUndefined(this.column.allowFiltering)||this.column.allowFiltering)if(sr(c))c.notify(ci,{instance:this,handler:this.filterByColumn,arg1:n,arg2:i,arg3:r,arg4:u,arg5:f,arg6:e,arg7:o,arg8:s});else{if(this.predicate=u||(Array.isArray(r)?"or":"and"),this.value=r,this.matchCase=f||!1,this.ignoreAccent=this.ignoreAccent=t.isNullOrUndefined(e)?this.parent.filterSettings.ignoreAccent:e,this.fieldName=n,this.operator=i,""===(r=t.isNullOrUndefined(r)?r:r.toString())&&(r=null),"number"!==this.column.type&&"date"!==this.column.type||(this.matchCase=!0),c.getColumnHeaderByField(this.column.isForeignColumn()?this.column.field:n).setAttribute("aria-filtered","true"),h&&"FilterBar"===this.filterSettings.type){if(r&&r.length<1||!this.filterByMethod&&this.checkForSkipInput(this.column,r))return this.filterStatusMsg=r&&r.length<1?"":this.l10n.getConstant("InvalidFilterMessage"),void this.updateFilterMsg();h.value!==r&&(h.value=r)}t.isNullOrUndefined(this.column.format)?this.values[this.column.field]=r:(this.applyColumnFormat(r),this.initialLoad&&"FilterBar"===this.filterSettings.type&&(h.value=this.values[this.column.field]));l={field:this.fieldName,predicate:u,matchCase:f,ignoreAccent:e,operator:this.operator,value:this.value,type:this.column.type};this.parent.filterSettings.columns.filter(function(n){return n.field===a.fieldName}).length>1&&!t.isNullOrUndefined(this.actualPredicate[this.fieldName])?this.actualPredicate[this.fieldName].push(l):this.actualPredicate[this.fieldName]=[l];this.checkAlreadyColFiltered(this.column.field)||this.updateModel()}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:this.column.headerText})},n.prototype.applyColumnFormat=function(n){var t=this,i="date"===this.column.type||"datetime"===this.column.type||"dateonly"===this.column.type?new Date(n):parseFloat(n);this.values[this.column.field]=("date"===this.column.type||"datetime"===this.column.type||"dateonly"===this.column.type)&&n&&Array.isArray(this.value)&&n.split(",").length>1?n.split(",").map(function(n){return""===n&&(n=null),t.setFormatForFlColumn(new Date(n),t.column)}):this.setFormatForFlColumn(i,this.column)},n.prototype.skipUid=function(n){for(var i,r=!0,u=Object.keys(n),t=0;t<u.length;t++)i=Object.keys(n[u[parseInt(t.toString(),10)]]),1===i.length&&"uid"===i[0]&&(r=!1);return r},n.prototype.onPropertyChanged=function(n){var i,r,u,f;if(n.module===this.getModuleName())for(i=0,r=Object.keys(n.properties);i<r.length;i++){u=r[i];switch(u){case"columns":if(f={currentFilterObject:this.currentFilterObject,currentFilteringColumn:this.column?this.column.field:void 0,action:"filter",columns:this.filterSettings.columns,requestType:"filtering",type:nt,cancel:!1},this.contentRefresh&&this.skipUid(n.properties.columns)){if(this.parent.notify(pt,f),f.cancel)return void(t.isNullOrUndefined(this.prevFilterObject)?this.filterSettings.columns.splice(this.filterSettings.columns.length-1,1):this.filterSettings.columns[this.filterObjIndex]=this.prevFilterObject);this.updateFilterIcon();this.refreshFilterSettings();this.updateFilterMsg();this.updateFilter()}break;case"showFilterBarStatus":n.properties[""+u]?this.updateFilterMsg():this.parent.allowPaging&&this.parent.updateExternalMessage("");break;case"showFilterBarOperator":case"type":this.parent.refreshHeader();this.refreshFilterSettings()}}},n.prototype.refreshFilterSettings=function(){var n,i,f,u,r;if("FilterBar"===this.filterSettings.type){for(n=0;n<this.filterSettings.columns.length;n++)this.column=this.parent.grabColumnByUidFromAllCols(this.filterSettings.columns[parseInt(n.toString(),10)].uid),i=this.filterSettings.columns[parseInt(n.toString(),10)].value,(i=!t.isNullOrUndefined(i)&&i.toString(),t.isNullOrUndefined(this.column.format))?(f=this.filterSettings.columns[parseInt(n.toString(),10)].field,this.values[""+f]=this.filterSettings.columns[parseInt(n.toString(),10)].value):this.applyColumnFormat(i),(r=this.getFilterBarElement(this.column.field))&&(r.value=""===this.cellText[this.filterSettings.columns[parseInt(n.toString(),10)].field]||t.isNullOrUndefined(this.cellText[this.filterSettings.columns[parseInt(n.toString(),10)].field])?this.filterSettings.columns[parseInt(n.toString(),10)].value:this.cellText[this.column.field]);if(0===this.filterSettings.columns.length)for(u=this.parent.getColumns(),n=0;n<u.length;n++)(r=this.getFilterBarElement(u[parseInt(n.toString(),10)].field))&&""!==r.value&&(r.value="",delete this.values[u[parseInt(n.toString(),10)].field])}},n.prototype.updateFilterIcon=function(){if(0===this.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(var t=[].slice.call(this.parent.element.getElementsByClassName("e-filtered")),n=0,i=t.length;n<i;n++)t[parseInt(n.toString(),10)].removeAttribute("aria-filtered"),t[parseInt(n.toString(),10)].classList.remove("e-filtered")},n.prototype.getFilterBarElement=function(n){var i,r="[id='"+n+"_filterBarcell']";return r&&!t.isNullOrUndefined(this.element)&&(i=this.element.querySelector(r)),i},n.prototype.refreshFilter=function(){this.refreshFilterSettings();this.updateFilterMsg()},n.prototype.clearFiltering=function(n){var s=this,r=uv(this.filterSettings.columns),i,o,u,f,e;if(!t.isNullOrUndefined(n))return this.refresh=!1,n.forEach(function(n){s.removeFilteredColsByField(n,!1)}),this.parent.setProperties({filterSettings:{columns:this.filterSettings.columns}},!0),this.parent.renderModule.refresh(),void(this.refresh=!0);if(sr(this.parent))this.parent.notify(ci,{instance:this,handler:this.clearFiltering});else{for(i=0;i<r.length;i++)r[parseInt(i.toString(),10)].uid=r[parseInt(i.toString(),10)].uid||this.parent.getColumnByField(r[parseInt(i.toString(),10)].field).uid;for(o=r.map(function(n){return n.uid}),u=o.filter(function(n,t){return o.indexOf(n)===t}),this.refresh=!1,i=0,f=u.length;i<f;i++)this.removeFilteredColsByField(this.parent.getColumnByUid(u[parseInt(i.toString(),10)]).field,!1);if(this.refresh=!0,u.length&&this.parent.renderModule.refresh(),0===this.parent.filterSettings.columns.length&&this.parent.element.querySelector(".e-filtered"))for(e=[].slice.call(this.parent.element.getElementsByClassName("e-filtered")),i=0,f=e.length;i<f;i++)e[0].removeAttribute("aria-filtered"),e[0].classList.remove("e-filtered");this.isRemove=!0;this.filterStatusMsg="";this.updateFilterMsg()}},n.prototype.checkAlreadyColFiltered=function(n){for(var t,i=0,r=this.filterSettings.columns;i<r.length;i++)if(t=r[i],t.field===n&&t.value===this.value&&t.operator===this.operator&&t.predicate===this.predicate)return!0;return!1},n.prototype.columnMenuFilter=function(n){this.column=n.col;var i=t.closest(n.target,"#"+n.id);n.isClose&&!i?this.filterModule.closeDialog():i&&this.filterDialogOpen(this.column,n.target)},n.prototype.filterDialogOpen=function(n,t,i,r){this.filterModule&&this.filterModule.closeDialog();this.setFilterModel(n);this.filterModule.openDialog(this.createOptions(n,t,i,r))},n.prototype.createOptions=function(n,i,r,u){var f=this.parent,e=n.filter.dataSource||f.dataSource&&"result"in f.dataSource?f.dataSource:f.getDataModule().dataManager,o=n.filter.type||this.parent.filterSettings.type;return{type:n.type,field:n.field,displayName:n.headerText,dataSource:e,format:n.format,height:800,columns:f.getColumns(),filteredColumns:f.filterSettings.columns,target:i,dataManager:f.getDataModule().dataManager,formatFn:n.getFormatter(),ignoreAccent:f.filterSettings.ignoreAccent,parserFn:n.getParser(),query:f.query,template:n.getFilterItemTemplate(),hideSearchbox:!t.isNullOrUndefined(n.filter.hideSearchbox)&&n.filter.hideSearchbox,handler:this.filterHandler.bind(this),localizedStrings:f.getLocaleConstants(),position:{X:r,Y:u},column:n,foreignKeyValue:n.foreignKeyValue,actualPredicate:this.actualPredicate,localeObj:f.localeObj,isRemote:f.getDataModule().isRemote(),allowCaseSensitive:this.filterSettings.enableCaseSensitivity,isResponsiveFilter:this.parent.enableAdaptiveUI,operator:this.actualPredicate[n.field]&&"Menu"===o?this.actualPredicate[n.field][0].operator:"equal"}},n.prototype.removeFilteredColsByField=function(n,t){var f,r=this.filterSettings.columns,e;if(sr(this.parent))e={instance:this,handler:this.removeFilteredColsByField,arg1:n,arg2:t},this.parent.notify(ci,e);else{for(var o=r.map(function(n){return n.uid}),s=o.filter(function(n,t){return o.indexOf(n)===t}),h=function(u){var o,e,c,l,h,a;if(r[parseInt(u.toString(),10)].uid=r[parseInt(u.toString(),10)].uid||i.parent.getColumnByField(r[parseInt(u.toString(),10)].field).uid,o=r.length,e=i.parent.grabColumnByUidFromAllCols(s[parseInt(u.toString(),10)]),e.field===n||e.field===e.foreignKeyValue&&e.isForeignColumn()){for(c=i.filterSettings.columns.filter(function(n){return n.uid===e.uid})[0],"FilterBar"!==i.filterSettings.type||t||(l="[id='"+e.field+"_filterBarcell']",(f=i.parent.getHeaderContent().querySelector(l))&&(f.value="",delete i.values[""+n]));o--;)r[parseInt(o.toString(),10)].uid===e.uid&&r.splice(o,1);return h=i.parent.getColumnHeaderByField(e.field),(h.removeAttribute("aria-filtered"),"FilterBar"!==i.filterSettings.type||i.parent.showColumnMenu)&&(a=i.parent.showColumnMenu&&e.showColumnMenu?".e-columnmenu":".e-icon-filter",h.querySelector(a).classList.remove("e-filtered")),i.isRemove=!0,i.actualPredicate[""+n]&&delete i.actualPredicate[""+n],i.values[""+n]&&delete i.values[""+n],i.refresh&&i.parent.notify(pt,{requestType:"filtering",type:nt,currentFilterObject:c,currentFilterColumn:e,action:"clearFilter"}),"break"}},i=this,u=0,c=s.length;u<c&&"break"!==h(u);u++);this.updateFilterMsg()}},n.prototype.getModuleName=function(){return"filter"},n.prototype.keyUpHandlerImmediate=function(n){13!==n.keyCode&&this.keyUpHandler(n)},n.prototype.keyUpHandler=function(n){var r=this.parent,i=n.target,e,f,u,o;if(i&&t.matches(i,".e-filterbar input")){if(e=t.closest(i,"th.e-filterbarcell"),this.column=r.getColumnByUid(e.getAttribute("e-mappinguid")),!this.column)return;"altDownArrow"===n.action&&this.parent.filterSettings.showFilterBarOperator&&(f=t.closest(i,"span").querySelector(".e-filterbaroperator"),f.ej2_instances[0].showPopup(),f.focus());"Immediate"!==this.filterSettings.mode&&(13!==n.keyCode||n.target.classList.contains("e-filterbaroperator"))||9===n.keyCode||this.column.filterTemplate||(this.value=i.value.trim(),this.processFilter(n))}"altDownArrow"===n.action&&"FilterBar"!==this.filterSettings.type&&(u=r.focusModule.currentInfo.element,u&&u.classList.contains("e-headercell")&&(o=r.getColumnByUid(u.firstElementChild.getAttribute("e-mappinguid")),this.openMenuByField(o.field),this.parent.focusModule.clearIndicator()));"escape"===n.action&&"Menu"===this.filterSettings.type&&this.filterModule&&(this.filterModule.closeDialog(),r.notify(tf,{}))},n.prototype.updateCrossIcon=function(n){n.value.length&&n.nextElementSibling.classList.remove("e-hide")},n.prototype.updateFilterMsg=function(){var i,f;if("FilterBar"===this.filterSettings.type){var r=this.parent,e=void 0,u=this.filterSettings.columns,n=void 0;if(!this.filterSettings.showFilterBarStatus)return;if(u.length>0&&this.filterStatusMsg!==this.l10n.getConstant("InvalidFilterMessage"))for(this.filterStatusMsg="",i=0;i<u.length;i++)(n=r.grabColumnByUidFromAllCols(u[parseInt(i.toString(),10)].uid)||r.grabColumnByFieldFromAllCols(u[parseInt(i.toString(),10)].field),i&&(this.filterStatusMsg+=" && "),t.isNullOrUndefined(n.format))?this.filterStatusMsg+=n.headerText+": "+this.values[n.field]:(f="date"===n.type||"datetime"===n.type||"dateonly"===n.type?this.valueFormatter.fromView(this.values[n.field],n.getParser(),"dateonly"===n.type?"date":n.type):this.values[n.field],e="date"!==n.type&&"datetime"!==n.type&&"dateonly"!==n.type?this.serviceLocator.getService("valueFormatter").toView(f,n.getParser()).toString():this.setFormatForFlColumn(f,n),this.filterStatusMsg+=n.headerText+": "+e);r.allowPaging&&r.updateExternalMessage(this.filterStatusMsg);this.filterStatusMsg=""}},n.prototype.setFormatForFlColumn=function(n,t){return this.serviceLocator.getService("valueFormatter").toView(n,t.getFormatter()).toString()},n.prototype.checkForSkipInput=function(n,t){var r,i,f,e;if("number"===n.type)(u.DataUtil.operatorSymbols[""+t]||this.skipNumberInput.indexOf(t)>-1)&&(r=!0);else if("string"===n.type)for(i=0,f=t;i<f.length;i++)e=f[i],this.skipStringInput.indexOf(e)>-1&&(r=!0);return r},n.prototype.processFilter=function(n){this.stopTimer();this.startTimer(n)},n.prototype.startTimer=function(n){var t=this;this.timer=window.setInterval(function(){t.onTimerTick()},13===n.keyCode?0:this.filterSettings.immediateModeDelay)},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.onTimerTick=function(){var r,u="[id='"+this.column.field+"_filterBarcell']",n=this.element.querySelector(u),i;(!n&&this.parent.isFrozenGrid()&&(n=this.parent.getHeaderContent().querySelector(u)),this.cellText[this.column.field]=n.value,this.stopTimer(),t.isNullOrUndefined(this.column.filterBarTemplate))?r=JSON.parse(JSON.stringify(n.value)):(i=this.column.filterBarTemplate.read,"string"==typeof i&&(i=t.getValue(i,window)),t.isNullOrUndefined(i)||(this.value=i.call(this,n)));t.isNullOrUndefined(this.value)||""===this.value?this.removeFilteredColsByField(this.column.field):(this.validateFilterValue(this.value),this.filterByMethod=!1,this.filterByColumn(this.column.field,this.operator,this.value,this.predicate,this.filterSettings.enableCaseSensitivity,this.ignoreAccent),this.filterByMethod=!0,n.value=r,this.updateFilterMsg())},n.prototype.validateFilterValue=function(n){var u,r,i;switch(this.matchCase=this.filterSettings.enableCaseSensitivity,this.column.type){case"number":for(this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal,u=[">","<","=","!"],i=0;i<n.length;i++)if(u.indexOf(n[parseInt(i.toString(),10)])>-1){r=i;break}this.getOperator(n.substring(r));0!==r&&(this.value=n.substring(0,r));""!==this.value&&n.length>=1&&(this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type));isNaN(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));break;case"date":case"datetime":this.operator=this.filterOperators.equal;""===this.value||this.value instanceof Date||(this.getOperator(n),this.value=this.valueFormatter.fromView(this.value,this.column.getParser(),this.column.type),t.isNullOrUndefined(this.value)&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage")));break;case"string":this.matchCase=!1;this.operator=this.column.filter.operator?this.column.filter.operator:-1!==n.indexOf("*")||-1!==n.indexOf("?")||-1!==n.indexOf("%3f")?this.filterOperators.wildCard:-1!==n.indexOf("%")?this.filterOperators.like:this.filterOperators.startsWith;break;case"boolean":"true"===n.toLowerCase()||"1"===n?this.value=!0:"false"===n.toLowerCase()||"0"===n?this.value=!1:n.length&&(this.filterStatusMsg=this.l10n.getConstant("InvalidFilterMessage"));this.operator=this.filterOperators.equal;break;default:this.operator=this.column.filter.operator?this.column.filter.operator:this.filterOperators.equal}},n.prototype.getOperator=function(n){var r=n.charAt(0),f=n.slice(0,2),i=t.extend({"=":this.filterOperators.equal,"!":this.filterOperators.notEqual},u.DataUtil.operatorSymbols);(i.hasOwnProperty(r)||i.hasOwnProperty(f))&&(this.operator=i[""+r],this.value=n.substring(1),this.operator||(this.operator=i[""+f],this.value=n.substring(2)));this.operator!==this.filterOperators.lessThan&&this.operator!==this.filterOperators.greaterThan||"="===this.value.charAt(0)&&(this.operator=this.operator+"orequal",this.value=this.value.substring(1))},n.prototype.columnPositionChanged=function(){this.parent.filterSettings.type},n.prototype.getLocalizedCustomOperators=function(){var n=[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"greaterthan",text:this.l10n.getConstant("GreaterThan")},{value:"greaterthanorequal",text:this.l10n.getConstant("GreaterThanOrEqual")},{value:"lessthan",text:this.l10n.getConstant("LessThan")},{value:"lessthanorequal",text:this.l10n.getConstant("LessThanOrEqual")},{value:"notequal",text:this.l10n.getConstant("NotEqual")},{value:"isnull",text:this.l10n.getConstant("IsNull")},{value:"isnotnull",text:this.l10n.getConstant("NotNull")}];this.customOperators={stringOperator:[{value:"startswith",text:this.l10n.getConstant("StartsWith")},{value:"endswith",text:this.l10n.getConstant("EndsWith")},{value:"contains",text:this.l10n.getConstant("Contains")},{value:"equal",text:this.l10n.getConstant("Equal")},{value:"isempty",text:this.l10n.getConstant("IsEmpty")},{value:"doesnotstartwith",text:this.l10n.getConstant("NotStartsWith")},{value:"doesnotendwith",text:this.l10n.getConstant("NotEndsWith")},{value:"doesnotcontain",text:this.l10n.getConstant("NotContains")},{value:"notequal",text:this.l10n.getConstant("NotEqual")},{value:"isnotempty",text:this.l10n.getConstant("IsNotEmpty")},{value:"like",text:this.l10n.getConstant("Like")}],numberOperator:n,dateOperator:n,datetimeOperator:n,dateonlyOperator:n,booleanOperator:[{value:"equal",text:this.l10n.getConstant("Equal")},{value:"notequal",text:this.l10n.getConstant("NotEqual")}]}},n.prototype.openMenuByField=function(n){var t=this.parent,f,i,r,u;t.enableAdaptiveUI?this.showCustomFilter(!1):(f=t.getColumnByField(n),i=t.getColumnHeaderByField(n).querySelector(".e-filtermenudiv"),i&&(r=t.element.getBoundingClientRect(),u=i.getBoundingClientRect(),this.filterDialogOpen(f,i,u.right-r.left,u.bottom-r.top)))},n.prototype.filterIconClickHandler=function(n){var r=n.target,t;if(r.classList.contains("e-filtermenudiv")&&("Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type)){if(t=this.parent.getColumnByUid(i(r,"e-headercell").firstElementChild.getAttribute("e-mappinguid")),this.column=t,this.fltrDlgDetails.field===t.field&&this.fltrDlgDetails.isOpen)return;this.filterModule&&this.filterModule.closeDialog();this.fltrDlgDetails={field:t.field,isOpen:!0};this.openMenuByField(t.field)}},n.prototype.clickHandler=function(n){var u,f;if("FilterBar"===this.filterSettings.type&&this.filterSettings.showFilterBarOperator&&(i(n.target,"e-filterbarcell")&&n.target.classList.contains("e-input-group-icon")&&(u=t.closest(n.target,"div").querySelector(".e-filterbaroperator"),u?u.focus():n.target.focus()),n.target.classList.contains("e-list-item")&&(f=document.querySelector(".e-popup-open").getAttribute("id").replace("_popup",""),-1!==f.indexOf("grid-column")&&t.closest(document.getElementById(f),"div").querySelector(".e-filtertext").focus())),"Immediate"===this.filterSettings.mode||"Menu"===this.parent.filterSettings.type||"CheckBox"===this.parent.filterSettings.type||"Excel"===this.parent.filterSettings.type){var r=n.target,c=r.classList.contains("e-day"),o=i(this.parent.element,"e-dialog"),s=!1,e=i(r,"e-popup"),h=this.parent.element.classList.contains("e-device")?document.querySelector(".e-filter-popup"):this.parent.element.querySelector(".e-filter-popup");if(o&&e&&(s=o.id===e.id),h&&(i(r,"e-excel-ascending")||i(r,"e-excel-descending"))&&this.filterModule.closeDialog(r),i(r,"e-filter-popup")||r.classList.contains("e-filtermenudiv"))return;!this.filterModule||i(r,"e-popup-wrapper")||t.closest(r,".e-filter-item.e-menu-item")||c||(s&&!i(r,"e-filter-popup")&&!i(r,"e-popup-flmenu")||!e&&h)&&(this.filterModule.isresetFocus=i(r,"e-grid")&&i(r,"e-grid").id===this.parent.element.id,this.filterModule.closeDialog(r))}},n.prototype.filterHandler=function(n){var i,t;this.actualPredicate[n.field]=n.actualPredicate;for(var o=new u.DataManager(this.filterSettings.columns),s=(new u.Query).where("field",this.filterOperators.equal,n.field),e=o.executeLocal(s),f=0;f<e.length;f++){for(i=-1,t=0;t<this.filterSettings.columns.length;t++)if(e[parseInt(f.toString(),10)].field===this.filterSettings.columns[parseInt(t.toString(),10)].field){i=t;break}-1!==i&&this.filterSettings.columns.splice(i,1)}this.values[n.field]&&delete this.values[n.field];var h=this.parent.getColumnByField(n.field),c=this.parent.showColumnMenu&&h.showColumnMenu?".e-columnmenu":".e-icon-filter",r=this.parent.getColumnHeaderByField(n.field).querySelector(c);"filtering"===n.action?(this.filterSettings.columns=this.filterSettings.columns.concat(n.filterCollection),this.filterSettings.columns.length&&r&&r.classList.add("e-filtered")):(r&&r.classList.remove("e-filtered"),n.requestType="filtering",this.parent.renderModule.refresh(n));this.parent.dataBind()},n.prototype.updateFilter=function(){var t=this.filterSettings.columns,n,i;for(this.actualPredicate={},n=0;n<t.length;n++)this.column=this.parent.getColumnByField(t[parseInt(n.toString(),10)].field)||lo(t[parseInt(n.toString(),10)].field,this.parent.getForeignKeyColumns()),i=t[parseInt(n.toString(),10)].field,this.parent.getColumnByField(t[parseInt(n.toString(),10)].field)||(i=lo(t[parseInt(n.toString(),10)].field,this.parent.getForeignKeyColumns()).field),this.refreshFilterIcon(i,t[parseInt(n.toString(),10)].operator,t[parseInt(n.toString(),10)].value,t[parseInt(n.toString(),10)].type,t[parseInt(n.toString(),10)].predicate,t[parseInt(n.toString(),10)].matchCase,t[parseInt(n.toString(),10)].ignoreAccent,t[parseInt(n.toString(),10)].uid)},n.prototype.refreshFilterIcon=function(n,t,i,r,u,f,e,o){var s={field:n,predicate:u,matchCase:f,ignoreAccent:e,operator:t,value:i,type:r},h;this.actualPredicate[""+n]?this.actualPredicate[""+n].push(s):this.actualPredicate[""+n]=[s];h=o?this.parent.grabColumnByUidFromAllCols(o).field:n;this.addFilteredClass(h)},n.prototype.addFilteredClass=function(n){var t,i=this.parent.getColumnByField(n);this.parent.showColumnMenu&&i.showColumnMenu?t=this.parent.getColumnHeaderByField(n).querySelector(".e-columnmenu"):i&&(t=this.parent.getColumnHeaderByField(n).querySelector(".e-icon-filter"));t&&t.classList.add("e-filtered")},n.prototype.getFilterUIInfo=function(){return this.filterModule?this.filterModule.getFilterUIInfo():{}},n.prototype.getOperatorName=function(n){return document.getElementById(this.parent.getColumnByField(n).uid).ej2_instances[0].value},n.prototype.renderCheckboxOnFilterMenu=function(){return this.filterModule.renderCheckBoxMenu()},n}(),ur={root:"e-rhandler",suppress:"e-rsuppress",icon:"e-ricon",helper:"e-rhelper",header:"th.e-headercell",cursor:"e-rcursor"},gv=function(){function n(n){this.tapped=!1;this.isDblClk=!0;this.resizeProcess=!1;this.parent=n;this.parent.isDestroyed||(this.widthService=new dw(n),this.addEventListener())}return n.prototype.autoFitColumns=function(n){var t=null==n||n.length<=0?this.parent.getColumns().map(function(n){return n.field}):"string"==typeof n?[n]:n;this.parent.isAutoFitColumns=!0;this.findColumn(t)},n.prototype.autoFit=function(){var n=this.parent.getColumns().filter(function(n){return!0===n.autoFit}).map(function(n){return n.field||n.headerText});n.length>0&&this.autoFitColumns(n);"Auto"===this.parent.resizeSettings.mode&&this.widthService.setWidthToTable()},n.prototype.resizeColumn=function(n,i,r){var e,o,s,b,l,a,u=this.parent,ut=0,wt=ot,bt=fu,ft=0,k=r||this.parent.getUidByColumnField(n),h=this.parent.getNormalizedColumnIndex(k),ht=this.parent.getColumnIndexByField(n),g=u.getFrozenColumns()||u.getFrozenLeftColumnsCount(),ct=u.getMovableColumnsCount(),nt,tt,f,et,y,it,c,pt;if((t.isNullOrUndefined(u.getFooterContent())||(s=u.getFooterContentTable()),u.isFrozenGrid())?(nt=u.getColumnByField(n),nt.getFreezeTableName()===rt?(e=u.getHeaderTable(),o=u.getContentTable(),b=e.querySelector('[e-mappinguid="'+k+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(h+1)+")"),s&&(a=s.querySelectorAll("td:nth-child("+(h+1)+")"))):"movable"===nt.getFreezeTableName()?(e=u.getHeaderContent().querySelector("."+w).children[0],o=u.getContent().querySelector("."+p).children[0],b=e.querySelector('[e-mappinguid="'+k+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(h-g+1)+")"),s&&(a=(s=u.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(h-g+1)+")"))):nt.getFreezeTableName()===d&&(e=u.getHeaderContent().querySelector(".e-frozen-right-header").children[0],o=u.getContent().querySelector(".e-frozen-right-content").children[0],b=e.querySelector('[e-mappinguid="'+k+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td:nth-child("+(h-(g+ct)+1)+")"),s&&(a=(s=u.getFooterContent().querySelector(".e-movablefootercontent").children[0]).querySelectorAll("td:nth-child("+(h-(g+ct)+1)+")")))):(e=u.getHeaderTable(),o=u.getContentTable(),b=e.querySelector('[e-mappinguid="'+k+'"]').parentElement.cloneNode(!0),l=o.querySelectorAll("td.e-rowcell:nth-child("+(h+1)+"):not(.e-groupcaption):not(.e-detailcell)"),s&&(a=s.querySelectorAll("td:nth-child("+(h+1)+"):not(.e-groupcaption)"))),tt=[].slice.call(e.querySelector("tr").getElementsByClassName("e-grouptopleftcell")),tt.length>0)for(f=0;f<tt.length;f++)ft+=tt[parseInt(f.toString(),10)].offsetWidth;et=o.querySelector(".e-detailrowcollapse")||o.querySelector(".e-detailrowexpand");(this.parent.detailTemplate||this.parent.childGrid)&&et&&(ft+=et.offsetWidth);var kt=[b],lt=[],st=[];if(s)for(f=0;f<a.length;f++)st[parseInt(f.toString(),10)]=a[parseInt(f.toString(),10)].cloneNode(!0);for(f=0;f<l.length;f++)lt[parseInt(f.toString(),10)]=l[parseInt(f.toString(),10)].cloneNode(!0);var dt=this.createTable(e,kt,"e-gridheader"),at=null,vt=null;u.getCurrentViewRecords().length&&(vt=this.createTable(o,lt,wt));st.length&&(at=this.createTable(s,st,bt));var v=u.getColumns()[parseInt(ht.toString(),10)],gt=v.width=t.formatUnit(Math.max(dt,vt,at)),yt=v.maxWidth&&parseFloat(v.maxWidth.toString());if(parseInt(gt,10)>yt&&(v.width=yt),this.widthService.setColumnWidth(u.getColumns()[parseInt(ht.toString(),10)]),!1===u.getColumns().some(function(n){return null===n.width||void 0===n.width||n.width.length<=0}))for(y=void 0,this.parent.isAutoFitColumns&&u.isFrozenGrid()?(it=krt(this.parent),y="frozen-left"===v.freezeTable?it.frozenLeft:"movable"===v.freezeTable?it.movable:it.frozenRight):y=u.getColumns(),f=0;f<y.length;f++)y[parseInt(f.toString(),10)].visible&&(ut+=parseFloat(y[parseInt(f.toString(),10)].width));c=ut+ft;ut>0&&!u.isFrozenGrid()&&((this.parent.detailTemplate||this.parent.childGrid)&&this.widthService.setColumnWidth(new hi({width:"30px"})),"Auto"===this.parent.resizeSettings.mode&&(c="100%"),e.style.width=t.formatUnit(c),o.style.width=t.formatUnit(c),t.isNullOrUndefined(s)||(s.style.width=t.formatUnit(c)));u.isFrozenGrid()&&(this.parent.isAutoFitColumns&&(e.style.width=t.formatUnit(c),o.style.width=t.formatUnit(c)),this.widthService.refreshFrozenScrollbar());pt=e.offsetWidth;u.getContent().scrollWidth>pt?(e.classList.add("e-tableborder"),o.classList.add("e-tableborder")):(e.classList.remove("e-tableborder"),o.classList.remove("e-tableborder"));t.isNullOrUndefined(s)||s.classList.add("e-tableborder")},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.widthService=null,this.unwireEvents(),this.removeEventListener())},n.prototype.getModuleName=function(){return"resize"},n.prototype.findColumn=function(n){for(var i=0;i<n.length;i++){var u=n[parseInt(i.toString(),10)],r=this.parent.getColumnIndexByField(u),f=this.parent.getColumns()[parseInt(r.toString(),10)];r>-1&&!t.isNullOrUndefined(f)&&!0===f.visible&&this.resizeColumn(u,r)}this.parent.allowTextWrap&&this.parent.notify(ei,{"case":"refreshHeight",isModeChg:!0})},n.prototype.createTable=function(n,t,i){var u=this.parent.createElement("div"),f,r,s,e,o,h;for(u.className=this.parent.element.className,u.style.cssText="display: inline-block;visibility:hidden;position:absolute",f=this.parent.createElement("div"),f.className=i,r=this.parent.createElement("table",{attrs:{role:"grid"}}),r.className=n.className,r.classList.add("e-resizetable"),r.style.cssText="table-layout: auto;width: auto",s=this.parent.createElement("tr"),e=0;e<t.length;e++)o=s.cloneNode(),o.className=n.querySelector("tr").className,o.appendChild(t[parseInt(e.toString(),10)]),r.appendChild(o);return f.appendChild(r),u.appendChild(f),document.body.appendChild(u),h=r.getBoundingClientRect().width,document.body.removeChild(u),Math.ceil(h)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(yt,this.refreshHeight,this),this.parent.on(dt,this.wireEvents,this),this.parent.on(it,this.autoFit,this),this.parent.on(to,this.refreshHeight,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(yt,this.refreshHeight),this.parent.off(dt,this.wireEvents),this.parent.off(to,this.refreshHeight),this.parent.off(v,this.destroy))},n.prototype.render=function(){this.unwireEvents();this.wireEvents();this.setHandlerHeight()},n.prototype.refreshHeight=function(){if(this.parent.getHeaderTable()){for(var t=this.getResizeHandlers(),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].parentElement.offsetHeight>0&&(t[parseInt(n.toString(),10)].style.height=t[parseInt(n.toString(),10)].parentElement.offsetHeight+"px");this.setHandlerHeight()}},n.prototype.wireEvents=function(){t.EventHandler.add(this.parent.getHeaderContent(),t.Browser.touchStartEvent,this.touchResizeStart,this);t.EventHandler.add(this.parent.getHeaderContent(),ye,this.callAutoFit,this)},n.prototype.unwireEvents=function(){t.EventHandler.remove(this.parent.getHeaderContent(),t.Browser.touchStartEvent,this.touchResizeStart);t.EventHandler.remove(this.parent.getHeaderContent(),ye,this.callAutoFit)},n.prototype.getResizeHandlers=function(){return this.parent.isFrozenGrid()?[].slice.call(this.parent.getHeaderContent().getElementsByClassName(ur.root)):[].slice.call(this.parent.getHeaderTable().getElementsByClassName(ur.root))},n.prototype.setHandlerHeight=function(){for(var t=[].slice.call(this.parent.getHeaderTable().getElementsByClassName(ur.suppress)),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].style.height=t[parseInt(n.toString(),10)].parentElement.offsetHeight+"px"},n.prototype.callAutoFit=function(n){if(n.target.classList.contains("e-rhandler")){var i=this.getTargetColumn(n);if(i.columns)return;this.resizeColumn(i.field,this.parent.getNormalizedColumnIndex(i.uid),i.uid);t.closest(n.target,ur.header).classList.add("e-resized")}},n.prototype.touchResizeStart=function(n){if(!or.timer)return or.timer=setTimeout(function(){or.timer=null},300),this.resizeStart(n);clearTimeout(or.timer);or.timer=null;this.callAutoFit(n)},n.prototype.resizeStart=function(n){var i=this,r,u,f,e,l,a,v;if(n.target.classList.contains("e-rhandler")){if(!this.helper){if(0===this.getScrollBarWidth()){if(this.resizeProcess=!0,this.parent.allowGrouping)for(r=0;r<this.parent.groupSettings.columns.length;r++)this.widthService.setColumnWidth(new hi({width:"30px"}),r);for(u=0,f=this.refreshColumnWidth();u<f.length;u++)e=f[u],this.widthService.setColumnWidth(e);this.widthService.setWidthToTable();this.resizeProcess=!1}if(this.refreshStackedColumnWidth(),this.element=n.target,this.parent.getVisibleFrozenColumns()){var y=this.parent.getMovableContentTbody(),p=this.parent.getFrozenLeftContentTbody(),o=this.parent.getFrozenRightContentTbody(),h=[].slice.call(y.childNodes),w=[].slice.call(p.childNodes),c=[];for(this.parent.getFrozenMode()===s&&o&&(c=[].slice.call(o.childNodes)),l=function(n){vu(a.parent,function(t,r){i.parent.rowHeight?r[parseInt(n.toString(),10)].style.height=i.parent.rowHeight+"px":r[parseInt(n.toString(),10)].style.removeProperty("height")},[w,h,c])},a=this,r=0;r<h.length;r++)l(r)}this.parentElementWidth=this.parent.element.getBoundingClientRect().width;this.appendHelper();this.column=this.getTargetColumn(n);this.pageX=this.getPointX(n);this.minMove=this.column.getFreezeTableName()===d?this.parent.enableRtl?(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString()):parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):this.parent.enableRtl?parseFloat(this.column.width.toString())-(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0):(this.column.minWidth?parseFloat(this.column.minWidth.toString()):0)-parseFloat(t.isNullOrUndefined(this.column.width)?"":this.column.width.toString());this.minMove+=this.pageX}t.Browser.isDevice&&!this.helper.classList.contains(ur.icon)?(this.helper.classList.add(ur.icon),t.EventHandler.add(document,t.Browser.touchStartEvent,this.removeHelper,this),t.EventHandler.add(this.helper,t.Browser.touchStartEvent,this.resizeStart,this)):(v={e:n,column:this.column},this.parent.trigger(ig,v,function(n){n.cancel||i.parent.isEdit?i.cancelResizeAction():(t.EventHandler.add(document,t.Browser.touchEndEvent,i.resizeEnd,i),t.EventHandler.add(i.parent.element,t.Browser.touchMoveEvent,i.resizing,i),i.updateCursor("add"))}))}},n.prototype.cancelResizeAction=function(n){n&&(t.EventHandler.remove(this.parent.element,t.Browser.touchMoveEvent,this.resizing),t.EventHandler.remove(document,t.Browser.touchEndEvent,this.resizeEnd),this.updateCursor("remove"));t.Browser.isDevice&&(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart));t.detach(this.helper);this.refresh()},n.prototype.getWidth=function(n,t,i){return t&&n<t?t:i&&n>i?i:n},n.prototype.updateResizeEleHeight=function(){for(var t=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].style.height=this.element.parentElement.offsetHeight+"px"},n.prototype.getColData=function(n,i){return{width:parseFloat(t.isNullOrUndefined(this.widthService.getWidth(n))||"auto"===this.widthService.getWidth(n)?"0":this.widthService.getWidth(n).toString())+i,minWidth:n.minWidth?parseFloat(n.minWidth.toString()):null,maxWidth:n.maxWidth?parseFloat(n.maxWidth.toString()):null}},n.prototype.resizing=function(n){var h,r,e,u,f,c,o,l,s,a,v;if(!t.isNullOrUndefined(this.column)){if(h=0,t.isNullOrUndefined(this.column)&&(h=i(this.element,"th").offsetWidth),this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.setHelperHeight()),r=this.getPointX(n),e=this.parent.enableRtl?-(r-this.pageX):r-this.pageX,this.column.getFreezeTableName()===d&&(e=this.parent.enableRtl?r-this.pageX:this.pageX-r),u=this.getColData(this.column,e),u.width||(u.width=t.closest(this.element,"th").offsetWidth),f=this.getWidth(u.width,u.minWidth,u.maxWidth),this.parent.log("resize_min_max",{column:this.column,width:f}),this.column.getFreezeTableName()===d&&(this.parent.enableRtl&&this.minMove>=r||!this.parent.enableRtl&&this.minMove<=r)&&(f=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=r=this.minMove),(this.column.getFreezeTableName()!==d&&(!this.parent.enableRtl&&this.minMove>=r||this.parent.enableRtl&&this.minMove<=r)||this.column.getFreezeTableName()===d&&(this.parent.enableRtl&&this.minMove>=r||!this.parent.enableRtl&&this.minMove<=r))&&(f=this.column.minWidth?parseFloat(this.column.minWidth.toString()):10,this.pageX=r=this.minMove),f!==parseFloat(t.isNullOrUndefined(this.column.width)||"auto"===this.column.width?h.toString():this.column.width.toString())){if(this.pageX=r,this.column.width=t.formatUnit(f),c={e:n,column:this.column},this.parent.trigger(rg,c),c.cancel)return void this.cancelResizeAction(!0);for(o=[this.column],l=[this.column],this.column.columns&&(o=this.getSubColumns(this.column,[]),o=this.calulateColumnsWidth(o,!1,e),l=this.calulateColumnsWidth(o,!0,e)),this.resizeProcess=!0,s=0,a=l;s<a.length;s++)v=a[s],this.widthService.setColumnWidth(v,null,"resize");this.resizeProcess=!1;this.updateHelper()}this.isDblClk=!1}},n.prototype.calulateColumnsWidth=function(n,i,r){for(var f,e,h=[],o=0,c=n;o<c.length;o++){for(var u=c[o],l=0,s=0;s<n.length;s++)l+=parseFloat(n[parseInt(s.toString(),10)].width.toString());f=this.getColData(u,parseFloat(u.width)*r/l);e=this.getWidth(f.width,f.minWidth,f.maxWidth);e!==parseFloat(u.width.toString())&&(i&&(u.width=t.formatUnit(e<1?1:e)),h.push(u))}return h},n.prototype.getSubColumns=function(n,t){for(var i,r=0,u=n.columns;r<u.length;r++)i=u[r],!1!==i.visible&&i.allowResizing&&(i.columns?this.getSubColumns(i,t):t.push(i));return t},n.prototype.resizeEnd=function(n){var r,h,c;if(this.helper&&!this.parent.isDestroyed){r=this.parent;t.EventHandler.remove(this.parent.element,t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(document,t.Browser.touchEndEvent,this.resizeEnd);this.updateCursor("remove");t.detach(this.helper);var u,f,e,l={e:n,column:this.column},o=this.parent.getContent().querySelector("."+ft),s=o.querySelector("."+p)?o.querySelector("."+p):o;s.scrollHeight>s.clientHeight&&(this.parent.scrollModule.setPadding(),s.style.overflowY="scroll");this.parent.trigger(yy,l);t.closest(this.element,".e-headercell").classList.add("e-resized");this.isFrozenColResized=i(this.element,"e-frozenheader")?!0:!1;this.parent.isFrozenGrid()&&this.parent.notify(ei,{"case":"textwrap"});this.parent.allowTextWrap&&(this.updateResizeEleHeight(),this.parent.notify(fl,{"case":"textwrap"}));h=r.getFrozenRightColumnsCount();t.isNullOrUndefined(r.getFooterContent())||(e=r.getFooterContentTable());r.isFrozenGrid()?h>0?(u=r.getHeaderContent().querySelector(".e-frozen-right-header").children[0],f=r.getContent().querySelector(".e-frozen-right-content").children[0]):(u=r.getHeaderContent().querySelector("."+w).children[0],f=r.getContent().querySelector("."+p).children[0]):(u=r.getHeaderTable(),f=r.getContentTable());c=u.offsetWidth;r.getContent().scrollWidth>c?t.addClass([u,f],["e-tableborder"]):t.removeClass([u,f],["e-tableborder"]);t.isNullOrUndefined(e)||e.classList.add("e-tableborder");this.refresh();this.doubleTapEvent(n);this.isDblClk=!0}},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.refreshColumnWidth=function(){for(var n,u=this.parent.getColumns(),t=0,f=[].slice.apply(this.parent.getHeaderContent().querySelectorAll("th.e-headercell"));t<f.length;t++)for(var i=f[t],r=0,e=u;r<e.length;r++)if(n=e[r],i.querySelector("[e-mappinguid]")&&i.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===n.uid&&n.visible){n.width=i.getBoundingClientRect().width;break}return u},n.prototype.refreshStackedColumnWidth=function(){for(var i,n=0,t=this.parent.getStackedColumns(this.parent.columns);n<t.length;n++)i=t[n],i.width=this.getStackedWidth(i,0)},n.prototype.getStackedWidth=function(n,t){for(var i,r=0,u=n.columns;r<u.length;r++)i=u[r],!1!==i.visible&&(i.columns?this.getStackedWidth(i,t):t+=i.width);return t},n.prototype.getTargetColumn=function(n){var i=t.closest(n.target,ur.header),r=(i=i.querySelector(".e-headercelldiv")||i.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid");return this.parent.getColumnByUid(r)},n.prototype.updateCursor=function(n){var r=[].slice.call(this.parent.getHeaderContent().querySelectorAll("th")),t,i;for(r.push(this.parent.element),t=0,i=r;t<i.length;t++)i[t].classList[""+n](ur.cursor)},n.prototype.refresh=function(){this.column=null;this.pageX=null;this.element=null;this.helper=null},n.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:ur.helper});this.parent.element.appendChild(this.helper);this.setHelperHeight()},n.prototype.setHelperHeight=function(){var e=this.parent.isFrozenGrid(),o=e?this.parent.getContent().querySelector("."+ft).offsetHeight:this.parent.getContent().offsetHeight-this.getScrollBarWidth(),n=t.closest(this.element,ur.header),u=[].slice.call(this.parent.getHeaderContent().querySelectorAll("tr")),s=this.parent.getFrozenRightColumnsCount(),r,f;for(e&&(u=i(n,w)?[].slice.call(this.parent.getHeaderContent().querySelector("."+w).querySelectorAll("tr")):s&&i(n,"e-frozen-right-header")?[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelectorAll("tr")):[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelectorAll("tr"))),r=u.indexOf(n.parentElement);r<u.length&&r>-1;r++)o+=u[parseInt(r.toString(),10)].offsetHeight;f=this.calcPos(n);f.left+=i(n,"e-frozen-right-header")?this.parent.enableRtl?n.offsetWidth-2:-1:this.parent.enableRtl?-1:n.offsetWidth-2;this.helper.style.cssText="height: "+o+"px; top: "+f.top+"px; left:"+Math.floor(f.left)+"px;";this.parent.enableVirtualization&&this.helper.classList.add("e-virtual-rhandler")},n.prototype.getScrollBarWidth=function(n){var t=this.parent.getContent().firstChild;return t.scrollHeight>t.clientHeight&&n||t.scrollWidth>t.clientWidth?hu():0},n.prototype.removeHelper=function(n){var i=n.target.classList;i.contains(ur.root)||i.contains(ur.icon)||!this.helper||(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart),t.detach(this.helper),this.refresh())},n.prototype.updateHelper=function(){var r,n=t.closest(this.element,ur.header),u;((r=i(n,"e-frozen-right-header")?Math.floor(this.calcPos(n).left+(this.parent.enableRtl?n.offsetWidth-2:-1)):Math.floor(this.calcPos(n).left+(this.parent.enableRtl?-1:n.offsetWidth-2)))>this.parentElementWidth&&(r=this.parentElementWidth-2),this.parent.isFrozenGrid())&&(u=t.closest(n,"."+k).offsetLeft,r<u&&(r=u));this.helper.style.left=r+"px"},n.prototype.calcPos=function(n){for(var r={top:0,left:0},f=n.getBoundingClientRect(),u=n.ownerDocument,t=i(n,"e-grid")||u.documentElement;t&&(t===u.body||t===u.documentElement)&&"static"===t.style.position;)t=t.parentNode;return t&&t!==n&&1===t.nodeType&&(r=t.getBoundingClientRect()),{top:f.top-r.top,left:f.left-r.left}},n.prototype.doubleTapEvent=function(n){var t=this;this.getUserAgent()&&this.isDblClk&&(this.tapped?(clearTimeout(this.tapped),this.callAutoFit(n),this.tapped=null):this.tapped=setTimeout(function(){t.tapped=null},300))},n.prototype.getUserAgent=function(){var n=t.Browser.userAgent.toLowerCase();return/iphone|ipod|ipad/.test(n)},n.prototype.timeoutHandler=function(){this.tapped=null},n}(),lht=function(){function n(n){this.parent=n;this.parent.isDestroyed||(this.parent.on(bf,this.headerDrop,this),this.parent.on(tt,this.enableAfterRender,this),this.parent.on(np,this.onActionComplete,this),this.parent.on(ku,this.drag,this),this.parent.on(vf,this.dragStart,this),this.parent.on(dc,this.dragStop,this),this.parent.on(bf,this.headerDrop,this),this.parent.on(yt,this.createReorderElement,this),this.parent.on(ht,this.keyPressHandler,this),this.parent.on(v,this.destroy,this))}return n.prototype.chkDropPosition=function(n,i){var r=this.parent.getColumnByUid(i.firstElementChild.getAttribute("e-mappinguid")),u=!r||!r.lockColumn;return(n.parentElement.isEqualNode(i.parentElement)||this.parent.enableColumnVirtualization||this.parent.isFrozenGrid()&&Array.prototype.indexOf.call(t.closest(n,"thead").children,n.parentElement)===Array.prototype.indexOf.call(t.closest(i,"thead").children,i.parentElement))&&this.targetParentContainerIndex(n,i)>-1&&u},n.prototype.chkDropAllCols=function(n,t){for(var i,r=this.getHeaderCells();!i&&r.length>0;)i=n!==r.pop()&&this.targetParentContainerIndex(n,t)>-1;return i},n.prototype.findColParent=function(n,t,i){for(var u,r=0,f=t.length;r<f;r++){if(n===t[parseInt(r.toString(),10)])return!0;if(t[parseInt(r.toString(),10)].columns){if(u=i.length,i.push(t[parseInt(r.toString(),10)]),this.findColParent(n,t[parseInt(r.toString(),10)].columns,i))return!0;i.splice(u,i.length-u)}}return!1},n.prototype.getColumnsModel=function(n,i){var u=[],f=[],r,e;if(!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid())return this.parent.getColumns();for(r=0,e=n.length;r<e;r++)t.isNullOrUndefined(n[parseInt(r.toString(),10)])||((n[parseInt(r.toString(),10)].visible||i)&&u.push(n[parseInt(r.toString(),10)]),n[parseInt(r.toString(),10)].columns&&(f=f.concat(n[parseInt(r.toString(),10)].columns)));return f.length&&(u=u.concat(this.getColumnsModel(f))),u},n.prototype.headerDrop=function(n){var c=this.parent,y=(this.element.querySelector(".e-headercelldiv")||this.element.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),r=c.getColumnByUid(y),i,f,u,s,h,a,v;if(t.closest(n.target,"th")&&(t.isNullOrUndefined(r)||r.allowReordering&&!r.lockColumn)){if(i=t.closest(n.target,".e-headercell"),f=(i.querySelector(".e-headercelldiv")||i.querySelector(".e-stackedheadercelldiv")).getAttribute("e-mappinguid"),!t.isNullOrUndefined(f)&&(u=c.getColumnByUid(f),t.isNullOrUndefined(u)||!u.allowReordering||u.lockColumn))return void this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:r,destColumn:u});if(i&&this.chkDropPosition(this.element,i)&&this.chkDropAllCols(this.element,i))if(this.parent.enableColumnVirtualization){var e=this.parent.columns,p=this.element.querySelector(".e-headercelldiv").getAttribute("e-mappinguid"),w=this.parent.columns.filter(function(n){return n.uid===p}),o=null,b=w[0],l=i.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");e.some(function(n,t){return n.uid===l&&(o=t,n.uid===l)});t.isNullOrUndefined(o)||this.moveColumns(o,b)}else s=this.targetParentContainerIndex(this.element,i),h=this.element.firstElementChild.getAttribute("e-mappinguid"),(this.destElement=i,this.parent.notify(fw,{ele:i}),h)?this.moveColumns(s,this.parent.getColumnByUid(h)):(a=this.getHeaderCells(),v=rv(this.element,a),e=this.getColumnsModel(this.parent.columns),this.moveColumns(s,e[parseInt(v.toString(),10)]))}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:r})},n.prototype.isActionPrevent=function(n){return sr(n)},n.prototype.moveColumns=function(n,t,i,r){var e=this.parent,u,h,c;if(this.isActionPrevent(e))e.notify(ci,{instance:this,handler:this.moveColumns,arg1:n,arg2:t});else{var l=!e.getFrozenColumns()&&e.isFrozenGrid(),s=this.getColParent(t,this.parent.columns),f=s?s.columns:l?this.parent.getColumns():this.parent.columns,o=so(t,f);if((this.parent.isFrozenGrid()&&s||this.parent.lockcolPositionCount)&&!i&&!this.parent.enableColumnVirtualization){for(u=0;u<f.length;u++)if(f[parseInt(u.toString(),10)].field===t.field){o=u;break}if(h=this.parent.getColumnByUid(this.destElement.firstElementChild.getAttribute("e-mappinguid")),h){for(u=0;u<f.length;u++)if(f[parseInt(u.toString(),10)].field===h.field){n=u;break}}else for(u=0;u<f.length;u++)f[parseInt(u.toString(),10)].headerText===this.destElement.innerText.trim()&&(n=u)}e.allowReordering&&o!==n&&-1!==o&&-1!==n&&(f.splice(n,0,f.splice(o,1)[0]),c={column:t,destIndex:n,columns:f,parent:s,cancel:!1},e.notify(uw,c),c.cancel||(e.getColumns(!0),e.notify(wf,{fromIndex:n,toIndex:o}),!1!==r&&e.notify(pt,{type:nt,requestType:"reorder",fromIndex:n,toIndex:o,toColumnUid:t.uid})))}},n.prototype.targetParentContainerIndex=function(n,t){var i=!this.parent.getFrozenColumns()&&this.parent.isFrozenGrid()?this.parent.getColumns():this.parent.columns,r=this.getHeaderCells(),o=this.parent.getStackedColumns(i),u=[],f,e;return o.length&&(u=this.getAllStackedheaderParentColumns(r)),f=o.length&&u.length?this.getColumnsModel(u):this.getColumnsModel(i,!0),e=this.getColParent(f[rv(n,r)],i),i=e?e.columns:i,so(f[rv(t,r)],i)},n.prototype.getAllStackedheaderParentColumns=function(n){for(var i=[],t=0;t<n.length;t++)n[parseInt(t.toString(),10)].classList.contains("e-hide")?(n.splice(t,1),t--):n[parseInt(t.toString(),10)].closest("thead").firstChild===n[parseInt(t.toString(),10)].parentElement&&i.push(this.parent.getColumnByUid(n[parseInt(t.toString(),10)].firstElementChild.getAttribute("e-mappinguid")));return i},n.prototype.getHeaderCells=function(){var h=this.parent.getFrozenColumns(),c,i,f,r,t,l,s;if(h||this.parent.isFrozenGrid()||this.parent.lockcolPositionCount){var e=void 0,n=void 0,u=[],o=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-columnheader"));if(h||this.parent.isFrozenGrid()){for(c=[].slice.call(this.parent.getHeaderContent().querySelector("."+w).getElementsByClassName("e-columnheader")),i=0;i<o.length;i++){for(e=[].slice.call(o[parseInt(i.toString(),10)].getElementsByClassName("e-headercell")),n=[].slice.call(c[parseInt(i.toString(),10)].getElementsByClassName("e-headercell")),f=void 0,r=0;r<e.length;r++){for(t=0;t<n.length;t++)if(n[parseInt(t.toString(),10)].innerText===e[parseInt(r.toString(),10)].innerText&&parseInt(n[parseInt(t.toString(),10)].getAttribute("data-colindex"),10)===parseInt(e[parseInt(r.toString(),10)].getAttribute("data-colindex"),10)){f=!0;break}f||(u=u.concat([e[parseInt(r.toString(),10)]]))}for(t=0;t<n.length;t++)u.push(n[parseInt(t.toString(),10)])}if(this.parent.getFrozenRightColumnsCount())for(l=[].slice.call(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").getElementsByClassName("e-columnheader")),s=[].slice.call(l[0].getElementsByClassName("e-headercell")),i=0;i<s.length;i++)u.push(s[parseInt(i.toString(),10)])}else for(i=0;i<o.length;i++)for(n=[].slice.call(o[parseInt(i.toString(),10)].getElementsByClassName("e-headercell")),r=0;r<n.length;r++){for(f=void 0,t=r+1;t<n.length;t++)if(n[parseInt(t.toString(),10)].innerText===n[parseInt(r.toString(),10)].innerText&&parseInt(n[parseInt(t.toString(),10)].getAttribute("data-colindex"),10)===parseInt(n[parseInt(r.toString(),10)].getAttribute("data-colindex"),10)){f=!0;break}f||(u=u.concat([n[parseInt(r.toString(),10)]]))}return u}return[].slice.call(this.parent.element.getElementsByClassName("e-headercell"))},n.prototype.getColParent=function(n,t){var i=[];return this.findColParent(n,t,i),i[i.length-1]},n.prototype.reorderSingleColumn=function(n,i){var r=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===n})[0]:this.parent.getColumnByField(n),u=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(n){return n.field===i})[0]:this.parent.getColumnByField(i);if((t.isNullOrUndefined(r)||r.allowReordering&&!r.lockColumn)&&(t.isNullOrUndefined(u)||u.allowReordering&&!r.lockColumn)){var f=u,e=this.getColParent(f,this.parent.columns),o=so(f,e?e.columns:this.parent.columns);o>-1&&this.moveColumns(o,r,!0)}else this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),column:r,destColumn:u})},n.prototype.reorderMultipleColumns=function(n,i){var e=this.parent.getColumnIndexByField(i),o=this.parent.getColumnByField(i),r,u,s,f;if(!(e<0)&&(t.isNullOrUndefined(o)||o.allowReordering&&!o.lockColumn)){for(r=0;r<n.length;r++)if(u=this.parent.getColumnByField(n[parseInt(r.toString(),10)]),!t.isNullOrUndefined(u)&&(!u.allowReordering||u.lockColumn))return;for(r=0;r<n.length;r++)u=this.parent.getColumnByIndex(e),s=this.getColParent(u,this.parent.columns),f=so(u,s?s.columns:this.parent.columns),f>-1&&this.moveColumns(f,this.parent.getColumnByField(n[parseInt(r.toString(),10)]),!0,!0),this.parent.getColumnIndexByField(n[r+1])>=f&&e++}},n.prototype.moveTargetColumn=function(n,t){t>-1&&this.moveColumns(t,n,!0)},n.prototype.reorderSingleColumnByTarget=function(n,t){this.moveTargetColumn(this.parent.getColumnByField(n),t)},n.prototype.reorderMultipleColumnByTarget=function(n,t){for(var i=0;i<n.length;i++)this.reorderSingleColumnByTarget(n[parseInt(i.toString(),10)],t)},n.prototype.reorderColumns=function(n,t){"string"==typeof n?(this.reorderSingleColumn(n,t),this.fromCol=n):(this.reorderMultipleColumns(n,t),this.fromCol=n[0])},n.prototype.reorderColumnByIndex=function(n,t){this.moveTargetColumn(this.parent.getColumnByIndex(n),t)},n.prototype.reorderColumnByTargetIndex=function(n,t){"string"==typeof n?this.reorderSingleColumnByTarget(n,t):this.reorderMultipleColumnByTarget(n,t)},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.createReorderElement()},n.prototype.createReorderElement=function(n){n&&n.args.isXaxis&&this.setDisplay("none");var t=this.parent.element.querySelector("."+st);this.upArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderuparrow e-reorderuparrow",attrs:{style:"display:none"}}));this.downArrow=t.appendChild(this.parent.createElement("div",{className:"e-icons e-icon-reorderdownarrow e-reorderdownarrow",attrs:{style:"display:none"}}))},n.prototype.onActionComplete=function(n){this.parent.trigger(l,t.extend(n,{type:l}));var i=this.fromCol&&this.parent.getColumnHeaderByField(this.fromCol);i&&this.parent.focusModule.onClick({target:i},!0)},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.upArrow.parentNode&&t.remove(this.upArrow),this.downArrow.parentNode&&t.remove(this.downArrow),this.parent.off(bf,this.headerDrop),this.parent.off(tt,this.enableAfterRender),this.parent.off(np,this.onActionComplete),this.parent.off(ku,this.drag),this.parent.off(vf,this.dragStart),this.parent.off(dc,this.dragStop),this.parent.off(yt,this.createReorderElement),this.parent.off(ht,this.keyPressHandler),this.parent.off(v,this.destroy))},n.prototype.keyPressHandler=function(n){var i=this.parent,t;switch(n.action){case"ctrlLeftArrow":case"ctrlRightArrow":if(t=i.focusModule.currentInfo.element,t&&t.classList.contains("e-headercell")){var r=i.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),u=i.getVisibleColumns(),e=u.indexOf(r),f="ctrlLeftArrow"===n.action?u[e-1]:u[e+1];f&&f.field&&r.field&&this.reorderColumns(r.field,f.field)}}},n.prototype.drag=function(n){var r=this.parent,u=n.target;if(n.column.allowReordering&&!n.column.lockColumn){var f=t.closest(u,".e-headercell:not(.e-stackedHeaderCell)"),e=r.element.querySelector(".e-cloneproperties"),o=r.isFrozenGrid()?r.getMovableVirtualContent():r.getContent().firstElementChild,s=this.x>su(n.event).x+o.scrollLeft;t.removeClass([].slice.call(r.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"]);this.setDisplay("none");this.stopTimer();t.classList(e,["e-defaultcur"],["e-notallowedcur"]);this.updateScrollPostion(n.event);f&&!f.isEqualNode(this.element)&&(u=f,this.chkDropPosition(this.element,u)&&this.chkDropAllCols(this.element,u)?(this.updateArrowPosition(u,s),t.classList(u,["e-allowDrop","e-reorderindicate"],[])):r.allowGrouping&&i(n.target,"e-groupdroparea")||t.classList(e,["e-notallowedcur"],["e-defaultcur"]));r.trigger(ku,{target:u,draggableType:"headercell",column:n.column})}},n.prototype.updateScrollPostion=function(n){var f=this,t=su(n).x,i=this.parent.element.getBoundingClientRect(),e=i.right,r,u;this.parent.isFrozenGrid()?this.updateFrozenScrollPosition(t,i):(r=i.left,u=this.parent.getContent().firstElementChild,t>r&&t<r+35?this.timer=window.setInterval(function(){f.setScrollLeft(u,!0)},50):t<e&&t>e-35&&(this.timer=window.setInterval(function(){f.setScrollLeft(u,!1)},50)))},n.prototype.updateFrozenScrollPosition=function(n,t){var i=this,r=this.parent.getContent().querySelector("."+p),u=this.parent.element.querySelector("."+w).getBoundingClientRect(),o=this.parent.getFrozenLeftCount(),f=this.parent.getFrozenRightColumnsCount()?u.right:t.right,e=o?u.left:t.left;n>e&&n<e+35?this.timer=window.setInterval(function(){i.setScrollLeft(r,!0)},50):n<f&&n>f-35&&(this.timer=window.setInterval(function(){i.setScrollLeft(r,!1)},50))},n.prototype.setScrollLeft=function(n,t){var i=n.scrollLeft;n.scrollLeft=n.scrollLeft+(t?-5:5);i!==n.scrollLeft&&this.setDisplay("none")},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.updateArrowPosition=function(n,t){var i=n.getBoundingClientRect(),r=this.parent.element.getBoundingClientRect(),u;if(!(t&&i.left<r.left||!t&&i.right>r.right)){if(this.parent.isFrozenGrid()&&n.classList.contains("e-headercell")){var f=this.parent.getFrozenLeftCount(),o=this.parent.getFrozenRightColumnsCount(),s=this.element.querySelector(".e-headercelldiv"),h=s?this.parent.getColumnByUid(s.getAttribute("data-uid")):null,e=this.parent.getColumnByUid(n.firstElementChild.getAttribute("e-mappinguid")),c=Math.round(this.parent.getFrozenVirtualHeader().getBoundingClientRect().right),l=Math.round(this.parent.getMovableVirtualHeader().getBoundingClientRect().right);if(e){if(f&&!o&&this.parent.getNormalizedColumnIndex(e.uid)>=f&&(t&&Math.round(i.left)<c||!t&&l<i.right))return;if(!f&&o&&h&&h.getFreezeTableName()!==e.getFreezeTableName()&&!t&&Math.round(i.right)<c)return}}u=this.parent.getHeaderContent().classList.contains("e-sticky");this.upArrow.style.top=u?i.top+i.height+"px":i.top+i.height-r.top+"px";this.downArrow.style.top=u?i.top-7+"px":i.top-r.top-7+"px";this.upArrow.style.left=this.downArrow.style.left=u?(t?i.left:i.right)-4+"px":(t?i.left:i.right)-r.left-4+"px";this.setDisplay("")}},n.prototype.dragStart=function(n){var t=this.parent,r=n.target,u;(this.element=r.classList.contains("e-headercell")?r:i(r,"e-headercell"),n.column.allowReordering&&!n.column.lockColumn)&&(u=t.isFrozenGrid()?t.getMovableVirtualContent():t.getContent().firstElementChild,this.x=su(n.event).x+u.scrollLeft,t.trigger(vf,{target:r,draggableType:"headercell",column:n.column}))},n.prototype.dragStop=function(n){var i=this.parent;this.setDisplay("none");this.stopTimer();n.cancel||i.trigger(yf,{target:n.target,draggableType:"headercell",column:n.column});t.removeClass([].slice.call(i.getHeaderTable().getElementsByClassName("e-reorderindicate")),["e-reorderindicate"])},n.prototype.setDisplay=function(n){this.upArrow.style.display=n;this.downArrow.style.display=n},n.prototype.getModuleName=function(){return"reorder"},n}(),aht=function(){function n(n){var r=this;this.selectedRows=[];this.isOverflowBorder=!0;this.selectedRowColls=[];this.isRefresh=!0;this.isReplaceDragEle=!0;this.istargetGrid=!1;this.helper=function(){var n=r.parent,u=r.draggable.currentStateTarget,f=r.parent.createElement("div",{className:"e-cloneproperties e-draganddrop e-grid e-dragclone",styles:'height:"auto", z-index:2, width:'+n.element.offsetWidth}),y=r.parent.createElement("table",{styles:"width:"+n.element.offsetWidth,attrs:{role:"grid"}}),p=r.parent.createElement(e,{attrs:{role:"rowgroup"}}),c,o,l,a,w,b,k,v;return document.getElementsByClassName("e-griddragarea").length||n.rowDropSettings.targetID&&(!u.classList.contains("e-selectionbackground")&&"Single"!==n.selectionSettings.type||!i(u,"e-rowcell"))||!n.rowDropSettings.targetID&&!i(u,"e-rowdragdrop")?!1:(n.rowDropSettings.targetID&&"Row"===n.selectionSettings.mode&&"Single"===n.selectionSettings.type&&n.selectRow(parseInt(r.draggable.currentStateTarget.parentElement.getAttribute(h),10)),r.startedRow=t.closest(u,"tr").cloneNode(!0),c=r.parent.isFrozenGrid(),c&&(o=parseInt(t.closest(u,"tr").getAttribute(h),10),r.startedRow.innerHTML="",r.startedRow.innerHTML+=n.getRowByIndex(o).innerHTML,r.startedRow.innerHTML+=n.getMovableRowByIndex(o).innerHTML,n.getFrozenMode()===s&&(r.startedRow.innerHTML+=n.getFrozenRightRowByIndex(o).innerHTML)),r.processArgs(u),l={selectedRow:r.rows,dragelement:u,cloneElement:f,cancel:!1,data:r.rowData},a=n.getSelectedRows(),n.trigger(hd,l),l.cancel)?!1:(fv(r.startedRow,".e-indentcell"),fv(r.startedRow,".e-detailrowcollapse"),fv(r.startedRow,".e-detailrowexpand"),r.removeCell(r.startedRow,rf),w=new RegExp("e-active","g"),(r.startedRow.innerHTML=r.startedRow.innerHTML.replace(w,""),p.appendChild(r.startedRow),n.getSelectedRowIndexes().length>1&&r.startedRow.hasAttribute("aria-selected"))&&(b=n.getFrozenMode()===s?3:2,k=r.parent.createElement("span",{className:"e-dropitemscount",innerHTML:c?""+a.length/b:""+a.length}),f.appendChild(k)),v=t.closest(u,"tr").querySelector(".e-icon-rowdragicon"),v&&v.classList.add("e-dragstartrow"),y.appendChild(p),f.appendChild(y),n.element.appendChild(f),f)};this.dragStart=function(n){var i=r.parent,e,l,a,s,u;if(i.enableVirtualization&&i.allowGrouping&&i.groupSettings.columns.length&&!t.isNullOrUndefined(n.target.closest("tr")))for(var o=n.dragElement.querySelectorAll("tr"),c=n.target.closest("tr").querySelectorAll(".e-indentcell"),f=0;f<o.length;f++)for(e=0;e<c.length;e++)l=c[parseInt(e.toString(),10)].cloneNode(!0),o[parseInt(f.toString(),10)].insertBefore(l,o[parseInt(f.toString(),10)].firstElementChild);(i.element.classList.contains("e-childgrid")&&(r.getParentGrid(i.element).appendChild(n.dragElement),i.element.appendChild(i.createElement("div",{className:"e-drag-ref"}))),document.body.classList.add("e-prevent-select"),document.getElementsByClassName("e-griddragarea").length)||(a=n.target,s=r.parent.element.querySelector(".e-dropitemscount"),r.parent.getSelectedRecords().length>1&&s&&(s.style.left=r.parent.element.querySelector(".e-cloneproperties table").offsetWidth-5+"px"),r.processArgs(a),i.trigger(cd,{rows:r.rows,target:n.target,draggableType:"rows",fromIndex:parseInt(r.rows[0].getAttribute(h),10),data:Object.keys(r.rowData[0]).length>0?r.rowData:r.currentViewData()}),r.dragStartData=r.rowData,u=document.getElementById(i.rowDropSettings.targetID),i.rowDropSettings.targetID&&u&&u.ej2_instances&&"grid"===u.ej2_instances[0].getModuleName()&&u.ej2_instances[0].getContent().classList.add("e-allowRowDrop"))};this.drag=function(n){var o=r.parent,b,e,u,f,v,y,p,c,w,s,l;if((r.isDropGrid=r.parent,r.istargetGrid=!1,r.parent.rowDropSettings.targetID)&&(b=document.getElementById(o.rowDropSettings.targetID),r.isDropGrid=b.ej2_instances[0],i(n.target,"e-grid")&&(r.istargetGrid=r.parent.rowDropSettings.targetID===i(n.target,"e-grid").id)),e=r.parent.element.querySelector(".e-cloneproperties"),o.element.classList.contains("e-childgrid")&&(e=r.getParentGrid(o.element).querySelector(".e-cloneproperties")),u=r.getElementFromPosition(e,n.event),t.classList(e,["e-defaultcur"],["e-notallowedcur","e-movecur","e-grabcur"]),r.isOverflowBorder=!0,r.hoverState=o.enableHover,f=i(u,"e-grid")?t.closest(n.target,"tr"):null,n.target&&(r.processArgs(u),v={rows:r.rows,target:u,draggableType:"rows",data:r.rowData,originalEvent:n,cancel:!1},(o.trigger(ld,v),r.stopTimer(),!v.cancel)&&((o.element.classList.add("e-rowdrag"),r.dragTarget=f&&(i(u,"e-grid").id===e.parentElement.id||i(u,"e-grid").id)?r.isDropGrid.element.querySelector(".e-emptyrow")?0:parseInt(f.getAttribute("data-rowindex"),10):parseInt(r.startedRow.getAttribute("data-rowindex"),10),o.rowDropSettings.targetID)?(y=document.querySelector(".e-drag-ref"),!i(u,"e-grid")||i(e.parentElement,"e-grid").id===i(u,"e-grid").id||y&&i(y.parentElement,"e-grid").id===i(u,"e-grid").id?t.classList(e,["e-notallowedcur"],["e-defaultcur"]):t.classList(e,["e-grabcur"],["e-notallowedcur"])):(p=i(u,"e-grid"),p&&p.id===e.parentElement.id?t.classList(e,["e-movecur"],["e-defaultcur"]):t.classList(e,["e-notallowedcur"],["e-movecur"])),i(r.isDropGrid.element,"e-grid")&&((!r.isDropGrid.groupSettings.columns.length||r.isDropGrid.groupSettings.columns.length||n.target.classList.contains("e-selectionbackground"))&&!r.isDropGrid.element.querySelector(".e-emptyrow")&&((i(u,"e-grid")&&i(u,"e-grid").id===r.isDropGrid.element.id&&r.updateScrollPostion(n.event),(r.isOverflowBorder||r.parent.frozenRows>r.dragTarget)&&(parseInt(r.startedRow.getAttribute(h),10)!==r.dragTarget||r.istargetGrid)||r.istargetGrid&&f&&r.isDropGrid.getRowByIndex(r.isDropGrid.getCurrentViewRecords().length-1).getAttribute("data-uid")===f.getAttribute("data-uid"))?r.moveDragRows(n,r.startedRow,f):(c=void 0,r.parent.enableVirtualization?c=f&&parseInt(f.getAttribute(h),10)===r.parent.renderModule.data.dataManager.dataSource.json.length-1:(w=r.parent.getRowByIndex(r.parent.getCurrentViewRecords().length-1).getAttribute("data-uid"),c=f&&w===f.getAttribute("data-uid")&&w!==r.startedRow.getAttribute("data-uid")),c&&!r.parent.rowDropSettings.targetID&&(s=r.parent.createElement("div",{className:"e-lastrow-dragborder"}),l=r.parent.getContent(),s.style.width=r.parent.element.offsetWidth-r.getScrollWidth()+"px",r.parent.enableVirtualization&&(s.style.zIndex="1"),l.getElementsByClassName("e-lastrow-dragborder").length||!t.isNullOrUndefined(f.nextSibling)&&o.allowGrouping&&o.groupSettings.columns.length||(l.classList.add("e-grid-relative"),l.appendChild(s),s.style.bottom=r.getScrollWidth()+"px")),r.removeBorder(f))),u&&u.classList.contains(ft)&&!r.isDropGrid.element.querySelector(".e-emptyrow")&&r.istargetGrid)))){r.removeBorder(f);var k=r.isDropGrid.getCurrentViewRecords().length-1,d=".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse",a=[];a=[].slice.call(r.isDropGrid.getRowByIndex(k).querySelectorAll(d));r.isDropGrid.isFrozenGrid()&&(a=r.borderRowElement(k,d));a.length>0&&rr(a,!0,"e-dragborder")}};this.dragStop=function(n){document.body.classList.remove("e-prevent-select");sr(r.parent)?r.parent.notify(ci,{instance:r,handler:r.processDragStop,arg1:n}):r.processDragStop(n)};this.processDragStop=function(n){var u=r.parent,e,f,o,c,s;r.parent.isDestroyed||(e=r.getElementFromPosition(n.helper,n.event),f=e&&!e.classList.contains("e-dlg-overlay")?e:n.target,u.element.classList.remove("e-rowdrag"),o=document.getElementById(u.rowDropSettings.targetID),(u.rowDropSettings.targetID&&o&&o.ej2_instances&&"grid"===o.ej2_instances[0].getModuleName()&&o.ej2_instances[0].getContent().classList.remove("e-allowRowDrop"),i(r.isDropGrid.element,"e-grid"))&&(r.stopTimer(),r.isDropGrid.enableHover=r.hoverState,r.isDropGrid.getContent().classList.remove("e-grid-relative"),r.removeBorder(e),c=r.isDropGrid.element.querySelector(".e-dragstartrow"),c&&c.classList.remove("e-dragstartrow")),r.processArgs(f),s={target:f,draggableType:"rows",cancel:!1,fromIndex:parseInt(r.rows[0].getAttribute(h),10),dropIndex:r.dragTarget,rows:r.rows,data:Object.keys(r.dragStartData[0]).length>0?r.dragStartData:r.currentViewData()},u.trigger(ad,s,function(){if(!(i(f,y)||i(f,"e-emptyrow")||i(f,ot))||s.cancel)return r.dragTarget=null,void t.remove(n.helper);r.isRefresh=!1;var e=r.parent.getSelectedRowIndexes();u.isRowDragable()&&(!r.parent.rowDropSettings.targetID&&r.startedRow.querySelector("td.e-selectionbackground")&&e.length>1&&e.length!==r.parent.getCurrentViewRecords().length?r.reorderRows(e,s.dropIndex):r.reorderRows([parseInt(r.startedRow.getAttribute(h),10)],r.dragTarget),r.dragTarget=null,u.rowDropSettings.targetID||(n.helper.classList.contains("e-cloneproperties")&&document.querySelector("."+n.helper.classList[0])&&t.remove(n.helper),!u.enableVirtualization||r.parent.allowGrouping&&u.groupSettings.columns.length?r.rowOrder(s):u.refresh()),r.parent.getContentTable().scrollHeight<r.parent.getContent().clientHeight&&r.parent.scrollModule.setLastRowCell());r.isRefresh=!0}))};this.removeCell=function(n,t){return[].slice.call(n.querySelectorAll("td")).filter(function(i){i.classList.contains(t)&&n.deleteCell(i.cellIndex)})};this.parent=n;this.parent.isDestroyed||(this.parent.on(dt,this.initializeDrag,this),this.parent.on(yf,this.columnDrop,this),this.parent.on(tp,this.onActionComplete,this),this.onDataBoundFn=this.onDataBound.bind(this),this.parent.addEventListener(ti,this.onDataBoundFn),this.parent.on(tt,this.enableAfterRender,this),this.parent.on(v,this.destroy,this))}return n.prototype.getParentGrid=function(n){for(var t=n,i=!1;!i;)t.ej2_instances[0].parentDetails&&(t=document.getElementById(t.ej2_instances[0].parentDetails.parentID)),t.classList.contains("e-childgrid")||(i=!0);return t},n.prototype.refreshRow=function(n,i,r,u,f,o,h){var d,g,nt,tt,c=this.parent,w=c.isFrozenGrid(),it=c.getFrozenMode()===s,st=c.getContentTable().querySelector(e),ht=c.getHeaderTable().querySelector(e),k,v,p,a,et,ot;w&&(d=c.getMovableHeaderTbody(),g=c.getMovableContentTbody(),it&&(nt=c.getFrozenRightHeaderTbody(),tt=c.getFrozenRightContentTbody()));for(var rt=c.getFrozenMode()===s?3:2,l=0,b=n.rows.length;l<b;l++)if(w)l%rt==0?i.insertBefore(n.rows[parseInt(l.toString(),10)],f):l%rt==1?r.insertBefore(n.rows[parseInt(l.toString(),10)],o):u.insertBefore(n.rows[parseInt(l.toString(),10)],h);else if(c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length&&1===n.rows.length&&(k=c.getRowElementByUID(n.rows[parseInt(l.toString(),10)].getAttribute("data-uid")),t.isNullOrUndefined(k)||t.remove(k)),i.insertBefore(n.rows[parseInt(l.toString(),10)],f),c.allowGrouping&&c.groupSettings.columns.length){var ct=n.rows[parseInt(l.toString(),10)].getAttribute("data-uid"),lt=n.target.parentElement.getAttribute("data-uid"),ut=c.getRowObjectFromUID(ct),ft=c.getRowObjectFromUID(lt);ut.parentUid!==ft.parentUid&&c.groupModule.groupReorderHandler(ut,ft)}if(a=[].slice.call(i.getElementsByClassName(y)),w&&(v=[].slice.call(r.getElementsByClassName(y)),it&&(p=[].slice.call(u.getElementsByClassName(y)))),!c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length?(c.groupModule.groupReorderRowObject(n,a),of(this.parent,c.getRowsObject().filter(function(n){return n.isDataRow}),a),this.parent.notify(wr,{rows:this.parent.getRowsObject()})):c.enableVirtualization&&c.allowGrouping&&c.groupSettings.columns.length?(c.groupModule.groupReorderRowObject(n,a),c.groupModule.vGroupResetRowIndex(),this.parent.notify(wr,{rows:this.parent.vRows})):this.refreshData(a,v,p),this.parent.frozenRows)for(et=function(n){n<ot.parent.frozenRows?vb(ht,d,nt,a,v,p,function(t,i){t.appendChild(i[parseInt(n.toString(),10)])}):vb(st,g,tt,a,v,p,function(t,i){t.appendChild(i[parseInt(n.toString(),10)])})},ot=this,l=0,b=a.length;l<b;l++)et(l)},n.prototype.updateFrozenRowreOrder=function(n){var h,c,l,a,t=this.parent,r=this.parent.isFrozenGrid(),u=t.getFrozenMode()===s,d=t.getContentTable().querySelector(e),g=t.getHeaderTable().querySelector(e),v,p,f;r&&(h=t.getMovableHeaderTbody(),c=t.getMovableContentTbody(),u&&(l=t.getFrozenRightHeaderTbody(),a=t.getFrozenRightContentTbody()));f=[].slice.call(g.getElementsByClassName(y)).concat([].slice.call(d.getElementsByClassName(y)));r&&(v=[].slice.call(h.getElementsByClassName(y)).concat([].slice.call(c.getElementsByClassName(y))),u&&(p=[].slice.call(l.getElementsByClassName(y)).concat([].slice.call(a.getElementsByClassName(y)))));var w=t.createElement(e,{attrs:{role:"rowgroup"}}),b=t.createElement(e,{attrs:{role:"rowgroup"}}),k=t.createElement(e,{attrs:{role:"rowgroup"}});this.parent.clearSelection();for(var o=this.refreshRowTarget(n),i=0,nt=f.length;i<nt;i++)w.appendChild(f[parseInt(i.toString(),10)]),r&&(b.appendChild(v[parseInt(i.toString(),10)]),u&&k.appendChild(p[parseInt(i.toString(),10)]));this.refreshRow(n,w,b,k,o.target,o.mTarget,o.frTarget)},n.prototype.refreshRowTarget=function(n){var r,u,t=this.parent,i=parseInt(n.target.parentElement.getAttribute(h),10),f;return t.enableVirtualization&&t.allowGrouping&&t.groupSettings.columns.length&&(i=this.parent.getDataRows().indexOf(n.target.parentElement)),(n.fromIndex<n.dropIndex||n.fromIndex===n.dropIndex)&&(!t.allowGrouping||!t.groupSettings.columns.length)&&(i+=1),f=t.allowGrouping&&t.groupSettings.columns.length&&-1!==i&&n.fromIndex<n.dropIndex?t.getRowByIndex(i).nextSibling:t.getRowByIndex(i),t.isFrozenGrid()&&(r=t.getMovableRowByIndex(i),t.getFrozenMode()===s&&(u=t.getFrozenRightRowByIndex(i))),{target:f,mTarget:r,frTarget:u}},n.prototype.updateFrozenColumnreOrder=function(n){var r,u,t=this.parent,f=this.parent.isFrozenGrid(),o=t.getContentTable().querySelector(e),i;f&&(r=t.getMovableContentTbody(),t.getFrozenMode()===s&&(u=t.getFrozenRightContentTbody()));this.parent.clearSelection();i=this.refreshRowTarget(n);this.refreshRow(n,o,r,u,i.target,i.mTarget,i.frTarget)},n.prototype.refreshData=function(n,t,i){for(var u,p,w,b,c={},l={},a={},v={},f=this.parent.getRowsObject(),e=this.parent.getMovableRowsObject(),o=this.parent.getFrozenRightRowsObject(),y=this.parent.getCurrentViewRecords(),r=0,s=n.length;r<s;r++)u=parseInt(n[parseInt(r.toString(),10)].getAttribute(h),10),c[parseInt(r.toString(),10)]=f[parseInt(u.toString(),10)],v[parseInt(r.toString(),10)]=y[parseInt(u.toString(),10)],this.parent.isFrozenGrid()&&(l[parseInt(r.toString(),10)]=e[parseInt(u.toString(),10)],i&&(a[parseInt(r.toString(),10)]=o[parseInt(u.toString(),10)]));for(b=this.parent.getRows(),this.parent.isFrozenGrid()&&(p=this.parent.getMovableRows(),i&&(w=this.parent.getFrozenRightRows())),r=0,s=n.length;r<s;r++)b[parseInt(r.toString(),10)]=n[parseInt(r.toString(),10)],f[parseInt(r.toString(),10)]=c[parseInt(r.toString(),10)],y[parseInt(r.toString(),10)]=v[parseInt(r.toString(),10)],this.parent.isFrozenGrid()&&(p[parseInt(r.toString(),10)]=t[parseInt(r.toString(),10)],e[parseInt(r.toString(),10)]=l[parseInt(r.toString(),10)],i&&(w[parseInt(r.toString(),10)]=i[parseInt(r.toString(),10)],o[parseInt(r.toString(),10)]=a[parseInt(r.toString(),10)]));of(this.parent,f,n);this.parent.isFrozenGrid()&&(of(this.parent,e,t),i&&of(this.parent,o,i))},n.prototype.rowOrder=function(n){var o,r,t,u,f;if(n.dropIndex!==n.fromIndex&&!isNaN(n.dropIndex)){if(this.parent.isDetail())for(this.parent.detailCollapseAll(),o=[].slice.call(this.parent.getContentTable().querySelector(e).children),r=this.parent.getRowsObject(),o.filter(function(n){n.classList.contains("e-detailrow")&&n.remove()}),t=0,u=r.length;t<u&&r[parseInt(t.toString(),10)];t++)r[parseInt(t.toString(),10)].isDetailRow&&(this.parent.getRowsObject().splice(t,1),t--);if((n.target.classList.contains("e-rowcelldrag")||n.target.classList.contains("e-dtdiagonalright")||n.target.classList.contains("e-dtdiagonaldown"))&&(n.target=n.target.parentElement),!n.target.classList.contains("e-rowcell")&&i(n.target,"e-rowcell")&&(n.target=i(n.target,"e-rowcell")),this.parent.frozenRows?this.updateFrozenRowreOrder(n):this.updateFrozenColumnreOrder(n),this.selectedRowColls.length>0&&(!this.parent.allowGrouping||!this.parent.groupSettings.columns.length)){if(this.parent.selectRows(this.selectedRowColls),f=[],this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length){for(t=0,u=n.rows.length;t<u;t++)f.push(parseInt(n.rows[parseInt(t.toString(),10)].getAttribute(h),10));this.selectedRowColls=f}this.selectedRowColls=[]}}},n.prototype.currentViewData=function(){for(var t=this.parent.getSelectedRowIndexes(),i=[],r=parseInt(this.startedRow.getAttribute(h),10),n=0,u=t.length;n<u;n++)i[parseInt(n.toString(),10)]=this.parent.currentViewData[t[parseInt(n.toString(),10)]];return this.parent.rowDropSettings.targetID||0!==t.length||(i[0]=this.parent.currentViewData[parseInt(r.toString(),10)]),i},n.prototype.saveChange=function(n,i){var r=this;this.parent.getDataModule().saveChanges(n,this.parent.getPrimaryKeyFieldNames()[0],{},i).then(function(){r.parent.notify(pt,{type:nt,requestType:"rowdraganddrop"})}).catch(function(n){var i="error",u="message";t.isNullOrUndefined(n[""+i])||t.isNullOrUndefined(n[""+i][""+u])||(n[""+i]=n[""+i][""+u]);r.parent.trigger(lf,n)})},n.prototype.reorderRows=function(n,t){for(var r,e,s=this.parent.getSelectedRowIndexes(),c=[],h=[],o=this.parent.renderModule.data.dataManager.dataSource.json,u=this.parent.allowPaging?this.parent.pageSettings.currentPage*this.parent.pageSettings.pageSize-this.parent.pageSettings.pageSize:0,a=t+u,l=n[0]+u,i=0,f=n.length;i<f;i++)h[parseInt(i.toString(),10)]=o[n[parseInt(i.toString(),10)]+u];for(i=0,f=s.length;i<f;i++)c[parseInt(i.toString(),10)]=o[s[parseInt(i.toString(),10)]+u];for(i=0,f=h.length;i<f;i++){if(0!==i){for(r=0,e=o.length;r<e;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(r.toString(),10)])===JSON.stringify(h[parseInt(i.toString(),10)])){l=r;break}for(r=0,e=o.length;r<e;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(r.toString(),10)])===JSON.stringify(h[i-1])){l>r&&(a=r+1);break}}this.reorderRow(l-u,a-u)}for(this.isRefresh&&this.parent.notify(pt,{type:nt,requestType:"rowdraganddrop"}),i=0,f=c.length;i<f;i++)for(r=0,e=o.length;r<e;r++)if(JSON.stringify(this.parent.renderModule.data.dataManager.dataSource.json[parseInt(r.toString(),10)])===JSON.stringify(c[parseInt(i.toString(),10)])){s[parseInt(i.toString(),10)]=r-u;break}this.selectedRowColls=s},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.onActionComplete=function(n){this.parent.trigger(l,t.extend(n,{type:l,requestType:"rowdraganddrop"}))},n.prototype.initializeDrag=function(){var n=this.parent;this.draggable=new t.Draggable(n.element,{dragTarget:".e-rowcelldrag, .e-rowdragdrop, .e-rowcell",distance:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop,isReplaceDragEle:this.isReplaceDragEle,isPreventSelect:!1})},n.prototype.updateScrollPostion=function(n){var t=this,i=su(n).y,r=this.isDropGrid.getContent().getBoundingClientRect(),o=this.isDropGrid.getRowHeight()-15,u=this.isDropGrid.getContent().firstElementChild,s=this.parent.enableVirtualization?20:0,f,e;r.top>=i?(f=-this.isDropGrid.getRowHeight(),this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(u,f)},200)):r.top+this.isDropGrid.getContent().clientHeight-o-33-s<=i&&(e=this.isDropGrid.getRowHeight(),this.isOverflowBorder=!1,this.timer=window.setInterval(function(){t.setScrollDown(u,e)},200))},n.prototype.setScrollDown=function(n,t){n.scrollTop=n.scrollTop+t},n.prototype.moveDragRows=function(n,r,u){var e=this.parent.element.querySelector(".e-cloneproperties"),f,o;this.parent.element.classList.contains("e-childgrid")&&(e=this.getParentGrid(this.parent.element).querySelector(".e-cloneproperties"));f=t.closest(n.target,"tr");i(f,"e-grid")&&(i(e.parentElement,"e-grid").id===i(f,"e-grid").id||this.istargetGrid)&&(o=f||this.startedRow,this.setBorder(o,n.event,r,u))},n.prototype.setBorder=function(n,r,u,f){var c=this.parent.element,a,e,o,l,s,v,p;this.istargetGrid&&(c=this.isDropGrid.element);a=this.parent.element.querySelector(".e-cloneproperties");(this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.removeBorder(n):(this.removeFirstRowBorder(n),this.removeLastRowBorder(n)),i(n,"e-grid")&&n.classList.contains(y)&&(!this.parent.rowDropSettings.targetID&&i(a.parentElement,"e-grid").id===i(n,"e-grid").id||this.istargetGrid))&&(t.removeClass(c.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"),["e-dragborder"]),e=[],o=parseInt(f.getAttribute(h),10),f&&0===o?this.parent.allowGrouping&&this.parent.groupSettings.columns.length?(n=f.previousSibling,e=[].slice.call(n.querySelectorAll(".e-groupcaption,.e-summarycell,.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):(l=this.parent.createElement("div",{className:"e-firstrow-dragborder"}),s=this.isDropGrid.getHeaderContent(),s.classList.add("e-grid-relative"),l.style.width=c.offsetWidth-this.getScrollWidth()+"px",s.getElementsByClassName("e-firstrow-dragborder").length||s.appendChild(l)):this.parent.rowDropSettings.targetID&&f?(n=this.isDropGrid.getRowByIndex(o-1),e=[].slice.call(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):f&&parseInt(u.getAttribute(h),10)>o?(this.parent.enableVirtualization&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(o=this.parent.getDataRows().indexOf(f)),this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&f.previousSibling.classList.contains("e-groupcaptionrow")?(n=f.previousSibling,e=[].slice.call(n.querySelectorAll(".e-groupcaption,.e-summarycell,.e-rowcell,.e-rowdragdrop,.e-detailrowcollapse"))):(n=this.parent.getRowByIndex(o-1),e=[].slice.call(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")))):e=[].slice.call(n.querySelectorAll(".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")),v=this.parent.isFrozenGrid(),f&&0!==o&&v&&(p=parseInt(n.getAttribute(h),10),e=this.borderRowElement(p,".e-rowcell,.e-rowdragdrop,.e-detailrowcollapse")),e.length>0&&rr(e,!0,"e-dragborder"))},n.prototype.borderRowElement=function(n,t){var i=[];return i=[].slice.call(this.isDropGrid.getRowByIndex(n).querySelectorAll(t)).concat([].slice.call(this.isDropGrid.getMovableRowByIndex(n).querySelectorAll(t))),this.isDropGrid.getFrozenMode()===s&&(i=i.concat([].slice.call(this.isDropGrid.getFrozenRightRowByIndex(n).querySelectorAll(t)))),i},n.prototype.getScrollWidth=function(){var n=this.parent.getContent().firstElementChild;return n.scrollWidth>n.offsetWidth?nb.getScrollBarWidth():0},n.prototype.removeFirstRowBorder=function(n){this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder").length>0&&n&&0!==n.rowIndex&&t.remove(this.isDropGrid.element.getElementsByClassName("e-firstrow-dragborder")[0])},n.prototype.removeLastRowBorder=function(n){var i;i=this.parent.enableVirtualization?n&&parseInt(n.getAttribute(h),10)!==this.parent.renderModule.data.dataManager.dataSource.json.length-1:n&&this.parent.getRowByIndex(this.parent.getCurrentViewRecords().length-1).getAttribute("data-uid")!==n.getAttribute("data-uid");this.parent.element.getElementsByClassName("e-lastrow-dragborder").length>0&&n&&i&&t.remove(this.parent.element.getElementsByClassName("e-lastrow-dragborder")[0])},n.prototype.removeBorder=function(n){var t,i;(this.removeFirstRowBorder(n),this.parent.rowDropSettings.targetID||this.removeLastRowBorder(n),n=this.parent.allowGrouping&&this.parent.groupSettings.columns.length?[].slice.call(this.isDropGrid.getContentTable().querySelectorAll("tr")).filter(function(n){return n.querySelector("td.e-dragborder")})[0]:(this.isDropGrid.isFrozenGrid()?this.isDropGrid.getMovableRows():this.isDropGrid.getRows()).filter(function(n){return n.querySelector("td.e-dragborder")})[0])&&(t=[].slice.call(n.getElementsByClassName("e-dragborder")),this.parent.isFrozenGrid()&&(i=parseInt(n.getAttribute(h),10),t=this.borderRowElement(i,".e-dragborder")),rr(t,!1,"e-dragborder"))},n.prototype.getElementFromPosition=function(n,t){var i=su(t),r;return n.style.display="none",r=document.elementFromPoint(i.x,i.y),n.style.display="",r},n.prototype.onDataBound=function(){this.selectedRowColls.length>0&&(this.parent.enableVirtualization||this.parent.allowRowDragAndDrop)&&(this.parent.selectRows(this.selectedRowColls),this.selectedRowColls=[])},n.prototype.getTargetIdx=function(n){return n?parseInt(n.getAttribute(h),10):0},n.prototype.singleRowDrop=function(n){var i=t.closest(n.target,"tr"),r=n.droppedElement.parentElement.ej2_instances[0],u=i?i.rowIndex:r.currentViewData.length-1;this.reorderRow(this.startedRowIndex,u)},n.prototype.columnDrop=function(n){var r=this.parent,o,f,h,c,s,l;if("grouping"!==n.droppedElement.getAttribute("action")&&(i(n.target,y)||i(n.target,"e-emptyrow")||i(n.target,ot))){var a=t.closest(n.target,"tr"),u=void 0,e=document.querySelector(".e-drag-ref");if("true"!==n.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&(n.droppedElement.parentElement.id===r.element.id||e&&e.parentElement.id===r.element.id)||"true"===n.droppedElement.querySelector("tr").getAttribute("single-dragrow")&&n.droppedElement.parentElement.id!==r.element.id)return;if(n.droppedElement.parentElement.id!==r.element.id)e?(u=e.parentElement.ej2_instances[0],t.remove(e)):u=n.droppedElement.parentElement.ej2_instances[0];else if(this.isSingleRowDragDrop||"true"===n.droppedElement.querySelector("tr").getAttribute("single-dragrow"))return void this.singleRowDrop(n);if(u.element.id!==r.element.id&&u.rowDropSettings.targetID!==r.element.id)return;for(o=u.getSelectedRecords(),f=this.getTargetIdx(a),isNaN(f)&&(f=0),r.allowPaging&&(f=f+r.pageSettings.currentPage*r.pageSettings.pageSize-r.pageSettings.pageSize),r.notify(kc,{toIndex:f,records:o}),r.notify(pt,{type:nt,requestType:"rowdraganddrop"}),h=u.getSelectedRowIndexes(),c=u.allowPaging?u.pageSettings.currentPage*u.pageSettings.pageSize-u.pageSettings.pageSize:0,this.selectedRows=[],s=0,l=o.length;s<l;s++)this.selectedRows.push(c+h[parseInt(s.toString(),10)]);u.notify(fs,{indexes:this.selectedRows,records:o});u.notify(pt,{type:nt,requestType:"rowdraganddrop"})}},n.prototype.reorderRow=function(n,t){var i=this.parent,r;i.sortSettings.columns.length||i.groupSettings.columns.length||i.filterSettings.columns.length||(r=i.allowPaging?i.pageSettings.currentPage*i.pageSettings.pageSize-i.pageSettings.pageSize:0,t+=r,this.selectedRows=i.getSelectedRowIndexes(),i.notify(pp,{fromIndex:n+r,toIndex:t}))},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.initializeDrag()},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.draggable.destroy(),this.parent.off(dt,this.initializeDrag),this.parent.off(yf,this.columnDrop),this.parent.off(tp,this.onActionComplete),this.parent.removeEventListener(ti,this.onDataBoundFn),this.parent.off(tt,this.enableAfterRender),this.parent.off(v,this.destroy))},n.prototype.getModuleName=function(){return"rowDragAndDrop"},n.prototype.processArgs=function(){var n=this.parent,t=parseInt(this.startedRow.getAttribute(h),10);n.getSelectedRecords().length>0&&!1===this.startedRow.cells[0].classList.contains("e-selectionbackground")||0===n.getSelectedRecords().length?(this.parent.enableVirtualization?this.rows=[this.startedRow]:(this.rows=[this.parent.getRowByIndex(t)],n.isFrozenGrid()&&(this.rows=[n.getRowByIndex(t),n.getMovableRowByIndex(t)],n.getFrozenMode()===s&&(this.rows=[n.getRowByIndex(t),n.getMovableRowByIndex(t),n.getFrozenRightRowByIndex(t)]))),this.rowData=[this.parent.getRowInfo(this.startedRow.querySelector("."+a)).rowData],n.enableVirtualization&&n.allowGrouping&&n.groupSettings.columns.length&&n.getSelectedRows().length&&(this.rows=n.getSelectedRows(),this.rowData=n.getSelectedRecords())):(this.rows=n.getSelectedRows(),this.rowData=n.getSelectedRecords())},n}(),sf=function(){function n(n,r,u,f){var e=this;this.sortRequired=!0;this.groupSortFocus=!1;this.groupTextFocus=!1;this.groupCancelFocus=!1;this.isAppliedGroup=!1;this.isAppliedUnGroup=!1;this.isAppliedCaptionRowBorder=!1;this.reorderingColumns=[];this.visualElement=t.createElement("div",{className:"e-cloneproperties e-dragclone e-gdclone",styles:"line-height:23px",attrs:{action:"grouping"}});this.helper=function(n){var u=e.parent,r=n.sender.target,t=r.classList.contains("e-groupheadercell")?r:i(r,"e-groupheadercell");return!(!t||!r.classList.contains("e-drag")&&e.groupSettings.allowReordering)&&(e.column=u.getColumnByField(t.firstElementChild.getAttribute("ej-mappingname")),e.visualElement.textContent=t.textContent,e.visualElement.style.width=t.offsetWidth+2+"px",e.visualElement.style.height=t.offsetHeight+2+"px",e.visualElement.setAttribute("e-mappinguid",e.column.uid),u.element.appendChild(e.visualElement),e.visualElement)};this.dragStart=function(){e.parent.element.classList.add("e-ungroupdrag")};this.drag=function(n){e.groupSettings.allowReordering&&e.animateDropper(n);var r=n.target,u=e.parent.element.querySelector(".e-cloneproperties");e.parent.trigger(ku,{target:r,draggableType:"headercell",column:e.column});e.groupSettings.allowReordering||(t.classList(u,["e-defaultcur"],["e-notallowedcur"]),i(r,ot)||i(r,"e-headercell")||t.classList(u,["e-notallowedcur"],["e-defaultcur"]))};this.dragStop=function(n){var r,u;e.parent.element.classList.remove("e-ungroupdrag");r=!(i(n.target,ot)||i(n.target,"e-gridheader"));e.groupSettings.allowReordering&&r?(t.remove(n.helper),i(n.target,"e-groupdroparea"))?e.rearrangeGroup():i(n.target,"e-grid")||(u=e.parent.getColumnByUid(n.helper.getAttribute("e-mappinguid")).field,-1!==e.groupSettings.columns.indexOf(u)&&e.ungroupColumn(u)):r&&t.remove(n.helper)};this.animateDropper=function(n){var a=e.parent.element.querySelector(".e-cloneproperties").getAttribute("e-mappinguid"),r=e.parent.getColumnByUid(a).field,h=i(n.target,"e-groupdroparea"),u=i(n.target,"e-group-animator"),v=[].slice.call(e.element.getElementsByClassName("e-groupheadercell")).map(function(n){return n.querySelector("div").getAttribute("ej-mappingname")}),t=JSON.parse(JSON.stringify(v)),c,f,o,l,s;if(u||h)for(u?(c=u.querySelector("div[ej-mappingname]").getAttribute("ej-mappingname"),f=+u.getAttribute("index"),c!==r&&(o=t.indexOf(r),-1!==o&&t.splice(o,1),l=-1!==f&&o===f,t.splice(f+(l?1:0),0,r))):h&&-1===t.indexOf(r)&&t.push(r),e.element.innerHTML="",t.length&&!e.element.classList.contains("e-grouped")&&e.element.classList.add("e-grouped"),e.reorderingColumns=t,s=0;s<t.length;s++)e.addColToGroupDrop(t[parseInt(s.toString(),10)]);else e.addLabel(),e.removeColFromGroupDrop(r)};this.drop=function(n){var u=e.parent,r=u.getColumnByUid(n.droppedElement.getAttribute("e-mappinguid"));e.element.classList.remove("e-hover");t.remove(n.droppedElement);e.aria.setDropTarget(e.parent.element.querySelector(".e-groupdroparea"),!1);e.aria.setGrabbed(e.parent.getHeaderTable().querySelector("[aria-grabbed=true]"),!1);t.isNullOrUndefined(r)||!1===r.allowGrouping||i(u.getColumnHeaderByUid(r.uid),"e-grid").getAttribute("id")!==u.element.getAttribute("id")?e.parent.log("action_disabled_column",{moduleName:e.getModuleName(),columnName:r.headerText}):e.groupColumn(r.field)};this.contentRefresh=!0;this.aria=new oh;this.parent=n;this.groupSettings=r;this.serviceLocator=f;this.sortedColumns=u;this.focus=f.getService("focus");this.addEventListener();this.groupGenerator=new eh(this.parent)}return n.prototype.addLabel=function(){if(!this.element.getElementsByClassName("e-group-animator").length){var n=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=n;this.element.classList.remove("e-grouped")}},n.prototype.rearrangeGroup=function(){this.sortRequired=!1;this.updateModel()},n.prototype.columnDrag=function(n){this.groupSettings.allowReordering&&n.column.allowGrouping&&this.animateDropper(n);var r=this.parent.element.querySelector(".e-cloneproperties");t.classList(r,["e-defaultcur"],["e-notallowedcur"]);i(n.target,"e-groupdroparea")||this.parent.allowReordering&&i(n.target,"e-headercell")||t.classList(r,["e-notallowedcur"],["e-defaultcur"]);n.target.classList.contains("e-groupdroparea")?this.element.classList.add("e-hover"):this.element.classList.remove("e-hover")},n.prototype.columnDragStart=function(n){var t,r;n.target.classList.contains("e-stackedheadercell")||(t=this.parent.element.querySelector(".e-groupdroparea"),this.aria.setDropTarget(t,n.column.allowGrouping),r=n.target.classList.contains("e-headercell")?n.target:i(n.target,"e-headercell"),this.aria.setGrabbed(r,!0,!n.column.allowGrouping))},n.prototype.columnDrop=function(n){var u=this.parent,r;if("grouping"===n.droppedElement.getAttribute("action")){if(r=u.getColumnByUid(n.droppedElement.getAttribute("e-mappinguid")),t.isNullOrUndefined(r)||!1===r.allowGrouping||i(u.getColumnHeaderByUid(r.uid),"e-grid").getAttribute("id")!==u.element.getAttribute("id"))return;this.ungroupColumn(r.field)}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(tt,this.enableAfterRender,this),this.parent.on(pc,this.onActionComplete,this),this.parent.on(ip,this.onActionComplete,this),this.parent.on(gt,this.onPropertyChanged,this),this.parent.on(ii,this.clickHandler,this),this.parent.on(ku,this.columnDrag,this),this.parent.on(vf,this.columnDragStart,this),this.parent.on(bf,this.columnDrop,this),this.parent.on(yf,this.columnDrop,this),this.parent.on(yt,this.refreshSortIcons,this),this.parent.on(yc,this.refreshSortIcons,this),this.parent.on(ht,this.keyPressHandler,this),this.parent.on(it,this.initialEnd,this),this.parent.on(vi,this.initialEnd,this),this.parent.on(dt,this.render,this),this.parent.on(uu,this.onGroupAggregates,this),this.parent.on(v,this.destroy,this),this.parent.on("group-expand-collapse",this.updateExpand,this),this.parent.on("persist-data-changed",this.initialEnd,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(dt,this.render),this.parent.off(tt,this.enableAfterRender),this.parent.off(pc,this.onActionComplete),this.parent.off(ip,this.onActionComplete),this.parent.off(gt,this.onPropertyChanged),this.parent.off(ii,this.clickHandler),this.parent.off(ku,this.columnDrag),this.parent.off(vf,this.columnDragStart),this.parent.off(yf,this.columnDrop),this.parent.off(bf,this.columnDrop),this.parent.off(yt,this.refreshSortIcons),this.parent.off(yc,this.refreshSortIcons),this.parent.off(ht,this.keyPressHandler),this.parent.off(uu,this.onGroupAggregates),this.parent.off(v,this.destroy),this.parent.off("group-expand-collapse",this.updateExpand))},n.prototype.initialEnd=function(){var r=this.parent,n,t,i;if(this.parent.off(it,this.initialEnd),this.parent.off(vi,this.initialEnd),this.parent.getColumns().length&&this.groupSettings.columns.length){for(this.contentRefresh=!1,n=0,t=r.groupSettings.columns;n<t.length;n++)i=t[n],this.groupColumn(i);this.contentRefresh=!0}},n.prototype.keyPressHandler=function(n){var f=this.parent,o,r,p,h,c,a,u,v,l,s;if(n.target&&i(n.target,"e-groupheadercell")&&("tab"===n.action||"shiftTab"===n.action)){if(o=this.getFocusableGroupedItems(),"tab"===n.action&&n.target===o[o.length-1]||"shiftTab"===n.action&&n.target===o[0])return;for(r=0;r<o.length;r++)if(n.target===o[parseInt(r.toString(),10)])return n.preventDefault(),p="tab"===n.action?r+1:r-1,void o[parseInt(p.toString(),10)].focus()}if("ctrlSpace"===n.action||this.groupSettings.columns.length&&-1!==["altDownArrow","altUpArrow","ctrlDownArrow","ctrlUpArrow","enter"].indexOf(n.action))switch(n.preventDefault(),n.action){case"altDownArrow":case"altUpArrow":if(h=f.allowSelection?f.getSelectedRowIndexes():[],h.length){for(c=f.getContentTable().querySelector(e).children,a=void 0,r=f.getDataRows()[h[h.length-1]].rowIndex;r>=0;r--)if(!c[parseInt(r.toString(),10)].classList.contains(y)&&!c[parseInt(r.toString(),10)].classList.contains("e-detailrow")){a=c[parseInt(r.toString(),10)];break}this.expandCollapseRows(a.querySelector("altUpArrow"===n.action?".e-recordplusexpand":".e-recordpluscollapse"))}break;case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"enter":if(n.target.classList.contains("e-groupsort")){this.groupSortFocus=!0;this.applySortFromTarget(n.target);break}if(n.target.classList.contains("e-ungroupbutton")){this.groupCancelFocus=!0;this.unGroupFromTarget(n.target);break}if(this.parent.isEdit||null!==t.closest(n.target,"#"+this.parent.element.id+"_searchbar")||i(n.target,"e-pager")||i(n.target,"e-toolbar"))return;if(u=this.focus.getFocusedElement(),u&&(u.classList.contains("e-icon-grightarrow")||u.classList.contains("e-icon-gdownarrow"))&&(u=u.parentElement),v=u?u.parentElement.querySelector('[class^="e-record"]'):null,!v)break;u.children.length&&(u.children[0].classList.contains("e-icon-grightarrow")||u.children[0].classList.contains("e-icon-gdownarrow"))&&this.expandCollapseRows(v);break;case"ctrlSpace":l=f.focusModule.currentInfo.element;l&&l.classList.contains("e-headercell")&&(s=f.getColumnByUid(l.firstElementChild.getAttribute("e-mappinguid")),s.field&&f.groupSettings.columns.indexOf(s.field)<0?this.groupColumn(s.field):this.ungroupColumn(s.field))}},n.prototype.getFocusableGroupedItems=function(){var i=[],t,n;if(this.groupSettings.columns.length)for(t=this.element.querySelectorAll(".e-groupheadercell"),n=0;n<t.length;n++)i.push(t[parseInt(n.toString(),10)].querySelector(".e-grouptext")),i.push(t[parseInt(n.toString(),10)].querySelector(".e-groupsort")),i.push(t[parseInt(n.toString(),10)].querySelector(".e-ungroupbutton"));return i},n.prototype.wireEvent=function(){t.EventHandler.add(this.element,"focusin",this.onFocusIn,this);t.EventHandler.add(this.element,"focusout",this.onFocusOut,this)},n.prototype.unWireEvent=function(){t.EventHandler.remove(this.element,"focusin",this.onFocusIn);t.EventHandler.remove(this.element,"focusout",this.onFocusOut)},n.prototype.onFocusIn=function(n){this.parent.focusModule.currentInfo&&this.parent.focusModule.currentInfo.element&&(t.removeClass([this.parent.focusModule.currentInfo.element,this.parent.focusModule.currentInfo.elementToFocus],["e-focused","e-focus"]),this.parent.focusModule.currentInfo.element.tabIndex=-1);this.addOrRemoveFocus(n)},n.prototype.onFocusOut=function(n){this.addOrRemoveFocus(n)},n.prototype.addOrRemoveFocus=function(n){if(n.target.classList.contains("e-groupdroparea")||n.target.classList.contains("e-grouptext")||n.target.classList.contains("e-groupsort")||n.target.classList.contains("e-ungroupbutton")){var i=n.target.classList.contains("e-grouptext")?n.target.parentElement.parentElement:n.target;"focusin"===n.type?(this.parent.focusModule.currentInfo.element=n.target,this.parent.focusModule.currentInfo.elementToFocus=n.target,t.addClass([i],["e-focused","e-focus"]),n.target.tabIndex=0):(t.removeClass([i],["e-focused","e-focus"]),n.target.tabIndex=-1)}},n.prototype.clickHandler=function(n){n.target.classList.contains("e-grouptext")&&(this.groupTextFocus=!0);n.target.classList.contains("e-groupsort")&&(this.groupSortFocus=!0);n.target.classList.contains("e-ungroupbutton")&&(this.groupCancelFocus=!0);(n.target.classList.contains("e-icon-grightarrow")||n.target.classList.contains("e-icon-gdownarrow"))&&n.preventDefault();var t=i(n.target,"e-recordplusexpand")||i(n.target,"e-recordpluscollapse");t&&(t.children[0].classList.contains("e-icon-gdownarrow")||t.children[0].classList.contains("e-icon-grightarrow"))&&this.expandCollapseRows(n.target);this.applySortFromTarget(n.target);this.unGroupFromTarget(n.target);this.toogleGroupFromHeader(n.target)},n.prototype.unGroupFromTarget=function(n){n.classList.contains("e-ungroupbutton")&&this.ungroupColumn(n.parentElement.getAttribute("ej-mappingname"))},n.prototype.toogleGroupFromHeader=function(n){this.groupSettings.showToggleButton&&(n.classList.contains("e-grptogglebtn")?n.classList.contains("e-toggleungroup")?this.ungroupColumn(this.parent.getColumnByUid(n.parentElement.getAttribute("e-mappinguid")).field):this.groupColumn(this.parent.getColumnByUid(n.parentElement.getAttribute("e-mappinguid")).field):n.classList.contains("e-toggleungroup")&&this.ungroupColumn(n.parentElement.getAttribute("ej-mappingname")))},n.prototype.applySortFromTarget=function(n){var i=this.parent,u=t.closest(n,".e-groupheadercell"),r;i.allowSorting&&u&&!n.classList.contains("e-ungroupbutton")&&!n.classList.contains("e-toggleungroup")&&(r=u.firstElementChild.getAttribute("ej-mappingname"),i.getColumnHeaderByField(r).getElementsByClassName("e-ascending").length?i.sortColumn(r,"Descending",!0):i.sortColumn(r,"Ascending",!0))},n.prototype.expandCollapseRows=function(n){var o=i(n,"e-recordplusexpand")||i(n,"e-recordpluscollapse"),c;if(o){var s=this.parent.getContentTable().querySelector(e).children,l=void 0,y=void 0,p=void 0,h=this.parent,d=o.parentElement.getElementsByClassName("e-indentcell").length,w=o.parentElement.getAttribute("data-uid"),a=h.getRowObjectFromUID(w),v=!1;if(o.classList.contains("e-recordpluscollapse")?(t.addClass([o],"e-recordplusexpand"),t.removeClass([o],"e-recordpluscollapse"),o.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",o.firstElementChild.setAttribute("title","expanded"),v=!0,a.isExpand=!0,et(h)&&this.updateVirtualRows(h,n,v,p,y),this.parent.groupSettings.enableLazyLoading&&((this.parent.filterSettings.columns.length||this.parent.sortSettings.columns.length||this.parent.searchSettings.key.length)&&0===this.parent.getContent().firstElementChild.scrollTop&&(this.parent.contentModule.isTop=!0),(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).captionExpand(o.parentElement))):(l=!0,a.isExpand=!1,t.removeClass([o],"e-recordplusexpand"),t.addClass([o],"e-recordpluscollapse"),o.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",o.firstElementChild.setAttribute("title","collapsed"),et(h)&&this.updateVirtualRows(h,n,!l,p,y),this.parent.groupSettings.enableLazyLoading&&(this.parent.enableVirtualization?this.parent.lazyLoadRender:this.parent.contentModule).captionCollapse(o.parentElement)),this.aria.setExpand(o,v),!et(h)&&!this.parent.groupSettings.enableLazyLoading){for(var u=h.getRowsObject(),b=u.indexOf(a),k={},f=h.enableInfiniteScrolling&&h.infiniteScrollSettings&&h.infiniteScrollSettings.enableCache&&u.length!==s.length?Array.from(s).indexOf(o.parentElement):void 0,r=b;r<u.length&&!(r>b&&u[parseInt(r.toString(),10)].indent===d);r++){if(u[parseInt(r.toString(),10)].isDetailRow)c=u[r-1].isExpand&&u[r-1].visible,f&&f>0&&f<s.length?s[parseInt(f.toString(),10)].style.display=c?"":"none":t.isNullOrUndefined(f)&&(s[parseInt(r.toString(),10)].style.display=c?"":"none");else if(!1===k[u[parseInt(r.toString(),10)].parentUid])u[parseInt(r.toString(),10)].visible=!1,f&&f>0&&f<s.length?s[parseInt(f.toString(),10)].style.display="none":t.isNullOrUndefined(f)&&(s[parseInt(r.toString(),10)].style.display="none");else{if(!(u[parseInt(r.toString(),10)].isDataRow||u[parseInt(r.toString(),10)].isCaptionRow||u[parseInt(r.toString(),10)].isDetailRow||u[parseInt(r.toString(),10)].isAggregateRow)&&(c=u[parseInt(r.toString(),10)].cells.some(function(n){return n.isDataCell&&n.visible}))===u[parseInt(r.toString(),10)].visible)continue;u[parseInt(r.toString(),10)].visible=!0;f&&f>0&&f<s.length?(s[parseInt(f.toString(),10)].style.display="",s[parseInt(f.toString(),10)].classList.remove("e-hide")):t.isNullOrUndefined(f)&&(s[parseInt(r.toString(),10)].style.display="",s[parseInt(r.toString(),10)].classList.remove("e-hide"))}u[parseInt(r.toString(),10)].isCaptionRow&&(k[u[parseInt(r.toString(),10)].uid]=u[parseInt(r.toString(),10)].isExpand&&u[parseInt(r.toString(),10)].visible);t.isNullOrUndefined(f)||f++}this.lastCaptionRowBorder();this.parent.notify(wr,{rows:this.parent.getRowsObject()})}this.parent.enableInfiniteScrolling&&this.parent.groupSettings.enableLazyLoading||this.parent.notify(la,{isCollapse:l,parentUid:w})}},n.prototype.lastCaptionRowBorder=function(){var r=this.parent.getContentTable(),o=this.parent.getContent().clientHeight,i,f;if(!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling&&(r.scrollHeight<o||this.isAppliedCaptionRowBorder)){if(this.isAppliedCaptionRowBorder){for(var s=r.querySelectorAll(".e-lastrowcell"),n=0,u=s.length;n<u;n++)t.removeClass([s[parseInt(n.toString(),10)]],"e-lastrowcell");this.isAppliedCaptionRowBorder=!1}if(i=this.parent.getContentTable().querySelector(e).children,f=i[i.length-1],"none"===f.style.display||f.classList.contains("e-groupcaptionrow")){for(n=i.length-1,u=0;n>u;n--)if("none"!==i[parseInt(n.toString(),10)].style.display&&i[parseInt(n.toString(),10)].classList.contains("e-groupcaptionrow")&&i[parseInt(n.toString(),10)].querySelector(".e-recordpluscollapse")){t.addClass(i[parseInt(n.toString(),10)].childNodes,"e-lastrowcell");this.isAppliedCaptionRowBorder=!0;break}}else r.scrollHeight<o&&(t.addClass(r.querySelectorAll("tr:last-child td"),"e-lastrowcell"),this.isAppliedCaptionRowBorder=!0)}},n.prototype.updateVirtualRows=function(n,t,i,r){var f=n.getRowObjectFromUID(t.closest("tr").getAttribute("data-uid")),u;f.isExpand=i;frt(n);this.parent.notify(oa,{});(r=n.getDataModule().generateQuery(!1)).queries=n.getDataModule().aggregateQuery(n.getQuery().clone()).queries;u={requestType:"virtualscroll",rowObject:f};n.contentModule&&(u.virtualInfo=n.contentModule.prevInfo);n.getDataModule().getData(u,r.requiresCount()).then(function(t){return n.renderModule.dataManagerSuccess(t,u)})},n.prototype.expandCollapse=function(n){if(this.parent.groupSettings.columns.length){n||this.parent.notify(bl,n);for(var i,r=this.parent.getContentTable().querySelector(e).children,u=this.parent.getRowsObject(),t=0,f=r.length;t<f;t++)r[parseInt(t.toString(),10)].querySelectorAll(".e-recordplusexpand, .e-recordpluscollapse").length?((i=r[parseInt(t.toString(),10)].querySelector(n?".e-recordpluscollapse":".e-recordplusexpand"))&&(n?(i.className="e-recordplusexpand",i.firstElementChild.className="e-icons e-gdiagonaldown e-icon-gdownarrow",i.setAttribute("aria-expanded","true"),i.firstElementChild.setAttribute("title","expanded")):(i.className="e-recordpluscollapse",i.firstElementChild.className="e-icons e-gnextforward e-icon-grightarrow",i.setAttribute("aria-expanded","false"),i.firstElementChild.setAttribute("title","collapsed"))),r[parseInt(t.toString(),10)].firstElementChild.classList.contains("e-recordplusexpand")||r[parseInt(t.toString(),10)].firstElementChild.classList.contains("e-recordpluscollapse")||(r[parseInt(t.toString(),10)].style.display=n?"":"none")):r[parseInt(t.toString(),10)].style.display=n?"":"none",u[parseInt(t.toString(),10)].isCaptionRow&&(u[parseInt(t.toString(),10)].isExpand=!!n);this.parent.updateVisibleExpandCollapseRows();this.lastCaptionRowBorder();this.parent.notify(wr,{rows:this.parent.getRowsObject()})}},n.prototype.expandAll=function(){this.expandCollapse(!0)},n.prototype.collapseAll=function(){this.expandCollapse(!1)},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.renderGroupDropArea();this.initDragAndDrop();this.refreshToggleBtn();this.wireEvent()},n.prototype.renderGroupDropArea=function(){var n=this.parent.element.querySelector(".e-groupdroparea");n&&t.remove(n);this.element=this.parent.createElement("div",{className:"e-groupdroparea",attrs:{tabindex:"-1"}});this.groupSettings.allowReordering&&this.element.classList.add("e-group-animate");this.updateGroupDropArea();this.parent.element.insertBefore(this.element,this.parent.element.firstChild);this.groupSettings.showDropArea||(this.element.style.display="none")},n.prototype.updateGroupDropArea=function(n){if(this.groupSettings.showDropArea&&!this.groupSettings.columns.length){var t=this.l10n.getConstant("GroupDropArea");this.element.innerHTML=t;this.element.classList.remove("e-grouped")}else(this.element.innerHTML!==this.l10n.getConstant("GroupDropArea")||1!==this.groupSettings.columns.length&&(this.isAppliedGroup||this.isAppliedUnGroup))&&!n||(this.element.innerHTML=""),this.element.classList.add("e-grouped")},n.prototype.initDragAndDrop=function(){this.initializeGHeaderDrop();this.initializeGHeaderDrag()},n.prototype.initializeGHeaderDrag=function(){new t.Draggable(this.element,{dragTarget:this.groupSettings.allowReordering?".e-drag":".e-groupheadercell",distance:this.groupSettings.allowReordering?-10:5,helper:this.helper,dragStart:this.dragStart,drag:this.drag,dragStop:this.dragStop})},n.prototype.initializeGHeaderDrop=function(){new t.Droppable(this.element,{accept:".e-dragclone",drop:this.drop})},n.prototype.groupColumn=function(n){var i=this.parent,r=i.getColumnByField(n);t.isNullOrUndefined(r)||!1===r.allowGrouping||this.contentRefresh&&this.groupSettings.columns.indexOf(n)>-1?this.parent.log("action_disabled_column",{moduleName:this.getModuleName(),columnName:r.headerText}):sr(i)?i.notify(ci,{instance:this,handler:this.groupColumn,arg1:n}):(r.visible=i.groupSettings.showGroupedColumn,this.colName=n,this.isAppliedGroup=!0,this.contentRefresh?this.updateModel():this.addColToGroupDrop(n),this.updateGroupDropArea(),this.isAppliedGroup=!1)},n.prototype.ungroupColumn=function(n){var i=this.parent,f=this.parent.enableColumnVirtualization?this.parent.columns.filter(function(t){return t.field===n})[0]:i.getColumnByField(n),r,u,e;if(!(t.isNullOrUndefined(f)||!1===f.allowGrouping||this.groupSettings.columns.indexOf(n)<0))if(sr(i))i.notify(ci,{instance:this,handler:this.ungroupColumn,arg1:n});else{if(f.visible=!0,this.colName=f.field,r=JSON.parse(JSON.stringify(this.groupSettings.columns)),r.splice(r.indexOf(this.colName),1),this.sortedColumns.indexOf(n)<0)for(u=0,e=i.sortSettings.columns.length;u<e;u++)if(n===i.sortSettings.columns[parseInt(u.toString(),10)].field){i.sortSettings.columns.splice(u,1);break}this.groupSettings.allowReordering&&(this.reorderingColumns=r);this.groupSettings.columns=r;i.allowGrouping&&(this.isAppliedUnGroup=!0,this.parent.dataBind())}},n.prototype.updateModel=function(){var n=JSON.parse(JSON.stringify(this.groupSettings.columns));n=this.reorderingColumns.length?JSON.parse(JSON.stringify(this.reorderingColumns)):n;this.sortRequired&&(-1===n.indexOf(this.colName)&&n.push(this.colName),this.groupAddSortingQuery(this.colName));this.sortRequired=!0;this.parent.groupSettings.columns=n;this.parent.dataBind()},n.prototype.onActionComplete=function(n){"grouping"===n.requestType?this.addColToGroupDrop(this.colName):this.removeColFromGroupDrop(this.colName);var i=this.groupSettings.columns.indexOf(this.colName)>-1?{columnName:this.colName,requestType:"grouping",type:l}:{requestType:"ungrouping",type:l};this.parent.trigger(l,t.extend(n,i));this.colName=null},n.prototype.groupAddSortingQuery=function(n){for(var t=0;t<this.parent.sortSettings.columns.length&&this.parent.sortSettings.columns[parseInt(t.toString(),10)].field!==n;)t++;this.parent.sortSettings.columns.length===t?this.parent.sortSettings.columns.push({field:n,direction:"Ascending",isFromGroup:!0}):this.parent.allowSorting||(this.parent.sortSettings.columns[parseInt(t.toString(),10)].direction="Ascending")},n.prototype.createElement=function(n){var o=this.parent,u="Ascending",f=this.parent.createElement("div",{className:"e-grid-icon e-group-animator"}),r=this.parent.createElement("div",{className:"e-grid-icon e-groupheadercell"}),t=this.parent.createElement("div",{attrs:{"ej-mappingname":n}}),i,e;return ir(n)&&t.setAttribute("ej-complexname",wt(n)),i=this.parent.getColumnByField(n),e=o.getColumnHeaderByUid(i.uid),this.groupSettings.allowReordering&&t.appendChild(this.parent.createElement("span",{className:"e-drag e-icons e-icon-drag",innerHTML:"&nbsp;",attrs:{title:"Drag",tabindex:"-1","aria-label":this.l10n.getConstant("GroupedDrag")}})),t.appendChild(this.parent.createElement("span",{className:"e-grouptext",innerHTML:i.headerText,attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupedSortIcon")+i.headerText}})),this.groupSettings.showToggleButton&&t.appendChild(this.parent.createElement("span",{className:"e-togglegroupbutton e-icons e-icon-ungroup e-toggleungroup",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("UnGroupAria")}})),e.querySelectorAll(".e-ascending,.e-descending").length&&(u=e.querySelector(".e-ascending")?"Ascending":"Descending"),t.appendChild(this.parent.createElement("span",{className:"e-groupsort e-icons e-"+u.toLowerCase()+" e-icon-"+u.toLowerCase(),innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupedSortIcon")+i.headerText,role:"button"}})),t.appendChild(this.parent.createElement("span",{className:"e-ungroupbutton e-icons e-icon-hide",innerHTML:"&nbsp;",attrs:{title:this.l10n.getConstant("UnGroup"),tabindex:"-1","aria-label":this.l10n.getConstant("UnGroupIcon")+i.headerText,role:"button"},styles:this.groupSettings.showUngroupButton?"":"display:none"})),r.appendChild(t),this.groupSettings.allowReordering&&(f.appendChild(r),f.appendChild(this.createSeparator()),r=f),r},n.prototype.addColToGroupDrop=function(n){var o=ir(n)?this.parent.element.querySelector(".e-groupdroparea div[ej-complexname="+lh(wt(n))+"]"):this.parent.element.querySelector(".e-groupdroparea div[ej-mappingname="+lh(n)+"]"),f,u,e,i,r;this.groupSettings.allowReordering&&o||(f=this.parent.getColumnByField(n),t.isNullOrUndefined(f)||(u=this.createElement(n),this.groupSettings.allowReordering&&(e=this.element.getElementsByClassName("e-group-animator").length,u.setAttribute("index",e.toString())),this.element.appendChild(u),i=this.parent.focusModule,i.setActive(!0),r=[0,0],0===i.active.matrix.matrix[r[0]][r[1]]&&(r=yr(i.active.matrix.matrix,r,!0)),i.active.matrix.current=r,i.active.getTable().rows[i.active.matrix.current[0]].cells[i.active.matrix.current[1]].focus()))},n.prototype.createSeparator=function(){return this.parent.createElement("span",{className:"e-nextgroup e-icons e-icon-next",innerHTML:"&nbsp;",attrs:{tabindex:"-1","aria-label":this.l10n.getConstant("GroupSeperator")},styles:this.groupSettings.showUngroupButton?"":"display:none"})},n.prototype.refreshToggleBtn=function(n){var u;if(this.groupSettings.showToggleButton)for(var r=[].slice.call(this.parent.getHeaderTable().getElementsByClassName("e-headercelldiv")),i=0,f=r.length;i<f;i++)r[parseInt(i.toString(),10)].classList.contains("e-emptycell")||r[parseInt(i.toString(),10)].classList.contains("e-headerchkcelldiv")||(u=this.parent.getColumnByUid(r[parseInt(i.toString(),10)].getAttribute("e-mappinguid")),this.parent.showColumnMenu&&(!this.parent.showColumnMenu||u.showColumnMenu)||(r[parseInt(i.toString(),10)].getElementsByClassName("e-grptogglebtn").length&&t.remove(r[parseInt(i.toString(),10)].querySelectorAll(".e-grptogglebtn")[0]),n||r[parseInt(i.toString(),10)].appendChild(this.parent.createElement("span",{className:"e-grptogglebtn e-icons "+(this.groupSettings.columns.indexOf(u.field)>-1?"e-toggleungroup e-icon-ungroup":"e-togglegroup e-icon-group"),attrs:{tabindex:"-1","aria-label":t.isNullOrUndefined(this.l10n)?this.parent.localeObj.getConstant("GroupButton"):this.l10n.getConstant("GroupButton")}}))))},n.prototype.removeColFromGroupDrop=function(n){var r,u;t.isNullOrUndefined(this.getGHeaderCell(n))||(r=this.getGHeaderCell(n),this.groupSettings.allowReordering?(u=i(r,"e-group-animator"),t.remove(u)):t.remove(r),this.updateGroupDropArea());this.isAppliedUnGroup=!1},n.prototype.onPropertyChanged=function(n){var u,o,r,f,i,t,e;if(n.module===this.getModuleName())for(u=0,o=Object.keys(n.properties);u<o.length;u++){r=o[u];switch(r){case"columns":if(f=void 0,this.contentRefresh){if(this.isAppliedUnGroup)f={columnName:this.colName,requestType:"ungrouping",type:nt};else{if(!this.isAppliedGroup){for(this.updateGroupDropArea(!0),i=0;i<this.parent.sortSettings.columns.length;i++)this.parent.sortSettings.columns[parseInt(i.toString(),10)].isFromGroup&&(this.parent.sortSettings.columns.splice(i,1),i--);for(t=0;t<this.groupSettings.columns.length;t++)this.colName=this.groupSettings.columns[parseInt(t.toString(),10)],this.parent.getColumnByField(this.colName).visible=this.parent.groupSettings.showGroupedColumn,this.groupAddSortingQuery(this.colName),t<this.groupSettings.columns.length-1&&this.addColToGroupDrop(this.groupSettings.columns[parseInt(t.toString(),10)])}f={columnName:this.colName,requestType:n.properties[""+r].length?"grouping":"ungrouping",type:nt}}if(!this.groupSettings.showGroupedColumn)for(e=n.oldProperties[""+r],t=0;t<e.length;t++)-1===n.properties[""+r].indexOf(e[parseInt(t.toString(),10)])&&(this.parent.getColumnByField(e[parseInt(t.toString(),10)]).visible=!0);this.parent.notify(pt,f)}break;case"showDropArea":this.updateGroupDropArea();this.groupSettings.showDropArea?(this.element.style.display="",this.parent.headerModule.refreshUI()):this.element.style.display="none";break;case"showGroupedColumn":this.updateGroupedColumn(this.groupSettings.showGroupedColumn);this.parent.notify(pt,{requestType:"refresh"});break;case"showUngroupButton":this.updateButtonVisibility(this.groupSettings.showUngroupButton,"e-ungroupbutton");break;case"showToggleButton":this.updateButtonVisibility(this.groupSettings.showToggleButton,"e-togglegroupbutton ");this.parent.refreshHeader();break;case"enableLazyLoading":this.parent.freezeRefresh()}}},n.prototype.updateGroupedColumn=function(n){for(var t=0;t<this.groupSettings.columns.length;t++)this.parent.getColumnByField(this.groupSettings.columns[parseInt(t.toString(),10)]).visible=n},n.prototype.updateButtonVisibility=function(n,t){for(var r=[].slice.call(this.element.getElementsByClassName(t)),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].style.display=n?"":"none"},n.prototype.enableAfterRender=function(n){n.module===this.getModuleName()&&n.enable&&this.render()},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(!this.parent.isDestroyed&&this.parent.allowGrouping||this.parent.refreshing||this.clearGrouping(),this.unWireEvent(),this.removeEventListener(),this.refreshToggleBtn(!0),this.element.parentNode&&t.remove(this.element))},n.prototype.clearGrouping=function(){var i=JSON.parse(JSON.stringify(this.groupSettings.columns)),n,t;for(this.contentRefresh=!1,n=0,t=i.length;n<t;n++)n===t-1&&(this.contentRefresh=!0),this.ungroupColumn(i[parseInt(n.toString(),10)]);this.contentRefresh=!0},n.prototype.getModuleName=function(){return"group"},n.prototype.refreshSortIcons=function(){var f,r=this.parent,i=r.sortSettings.columns,e=r.groupSettings.columns,o=this.parent.getColumns().map(function(n){return n.field}),n,u;for(this.refreshToggleBtn(),n=0,u=i.length;n<u;n++)-1!==o.indexOf(i[parseInt(n.toString(),10)].field)&&(f=r.getColumnHeaderByField(i[parseInt(n.toString(),10)].field),!r.allowSorting&&(this.sortedColumns.indexOf(i[parseInt(n.toString(),10)].field)>-1||this.groupSettings.columns.indexOf(i[parseInt(n.toString(),10)].field)>-1)?(t.classList(f.querySelector(".e-sortfilterdiv"),["e-ascending","e-icon-ascending"],[]),i.length>1&&f.querySelector(".e-headercelldiv").appendChild(this.parent.createElement("span",{className:"e-sortnumber",innerHTML:(n+1).toString()}))):this.getGHeaderCell(i[parseInt(n.toString(),10)].field)&&this.getGHeaderCell(i[parseInt(n.toString(),10)].field).getElementsByClassName("e-groupsort").length&&("Ascending"===i[parseInt(n.toString(),10)].direction?t.classList(this.getGHeaderCell(i[parseInt(n.toString(),10)].field).querySelector(".e-groupsort"),["e-ascending","e-icon-ascending"],["e-descending","e-icon-descending"]):t.classList(this.getGHeaderCell(i[parseInt(n.toString(),10)].field).querySelector(".e-groupsort"),["e-descending","e-icon-descending"],["e-ascending","e-icon-ascending"])));for(n=0,u=e.length;n<u;n++)-1!==o.indexOf(e[parseInt(n.toString(),10)])&&r.getColumnHeaderByField(e[parseInt(n.toString(),10)]).setAttribute("aria-grouped","true")},n.prototype.getGHeaderCell=function(n){return this.element&&this.element.querySelector('[ej-mappingname="'+n+'"]')?this.element.querySelector('[ej-mappingname="'+n+'"]').parentElement:null},n.prototype.onGroupAggregates=function(n){var t,i,f;if(this.parent.groupSettings.enableLazyLoading)"Batch"!==this.parent.editSettings.mode&&this.updateLazyLoadGroupAggregates(n);else{var e=this.iterateGroupAggregates(n),o=this.groupGenerator.generateRows(e,{}),r=this.parent.getRowsObject().filter(function(n){return!n.isDataRow}),u=o.filter(function(n){return!n.isDataRow});for((this.parent.isReact||this.parent.isVue)&&this.parent.destroyTemplate(["groupFooterTemplate","groupCaptionTemplate","footerTemplate"]),t=0;t<u.length;t++)i=u[parseInt(t.toString(),10)],f={cells:i.cells.filter(function(n){return n.isDataCell}),data:i.data,dataUid:r[parseInt(t.toString(),10)]?r[parseInt(t.toString(),10)].uid:""},this.parent.notify(wc,f)}},n.prototype.updateLazyLoadGroupAggregates=function(n,t){var e=this,o=this.getGroupAggregateTemplates(!0),s=this.getGroupAggregateTemplates(!1);if(o.length||s.length)for(var i=this.parent,u=i.getDataModule().isRemote(),h=n[0],y=n.row,r=i.groupSettings.columns,a=i.contentModule,c=a.getGroupCache()[i.pageSettings.currentPage],f=t||[],p=function(t){var g=r[parseInt(t.toString(),10)],w=h[""+g],l=v.getGroupCaptionRowObject(y,r.length-t),b,k,p;if(u&&f.length)0!==t&&(b=r[t-1],k=h[""+b],f=f.find(function(n){return n.key===k}).items),v.updateLazyLoadGroupAggregatesRow(f,w,l,c,o,s);else{if(p=i.renderModule.data.generateQuery(),0!==t){var nt=c.filter(function(n){return n.isCaptionRow&&n.parentUid===l.parentUid}),tt=nt.indexOf(l),d=i.groupSettings.columns.slice(0,t).reverse(),it=d.map(function(n){return h[""+n]}),rt=bv(wv(d,it,a)),ut={level:t,skip:tt,take:1,where:rt};p.lazyLoad.push({key:"onDemandGroupInfo",value:ut})}if(i.renderModule.data.getData({},p).then(function(i){u?e.updateLazyLoadGroupAggregates(n,i.result):e.updateLazyLoadGroupAggregatesRow(i.result,w,l,c,o,s);(t===r.length-1||u)&&e.destroyRefreshGroupCaptionFooterTemplate()}).catch(function(n){return i.renderModule.dataManagerFailure(n,{requestType:"grouping"})}),u)return"break"}},v=this,l=0;l<r.length&&"break"!==p(l);l++);},n.prototype.destroyRefreshGroupCaptionFooterTemplate=function(){var n=this.parent;(n.isAngular||n.isReact||n.isVue)&&n.destroyTemplate(["groupCaptionTemplate","groupFooterTemplate"]);n.refreshGroupCaptionFooterTemplate();n.removeMaskRow();n.hideSpinner()},n.prototype.updateLazyLoadGroupAggregatesRow=function(n,t,i,r,u,f){var e=n.find(function(n){return n.key===t}),o;(u.length&&this.updateLazyLoadGroupAggregatesCell(e,i,u),f.length)&&(o=r.find(function(n){return n.isAggregateRow&&n.parentUid===i.uid}),this.updateLazyLoadGroupAggregatesCell(e,o,f))},n.prototype.updateLazyLoadGroupAggregatesCell=function(n,t,i){var s=t.data,u=n.aggregates,f;for(t.isCaptionRow&&(s.aggregates=u),f=0;f<i.length;f++){var r=i[parseInt(f.toString(),10)],e=r.field+" - "+r.type,o=s[r.field];o[""+e]=u[""+e];o[rut(r.type)]=u[""+e];o[r.type]&&(o[r.type]=u[""+e])}},n.prototype.getGroupCaptionRowObject=function(n,t){for(var r=this.parent,f=n.getAttribute("data-uid"),i=r.getRowObjectFromUID(f),u=0;u<t;u++)i=r.getRowObjectFromUID(i.parentUid);return i},n.prototype.getGroupAggregateTemplates=function(n){for(var i,t,e,u=[],f=this.parent.aggregates,r=0;r<f.length;r++)for(i=f[parseInt(r.toString(),10)],t=0;t<i.columns.length;t++)(n&&i.columns[parseInt(t.toString(),10)].groupCaptionTemplate||!n&&i.columns[parseInt(t.toString(),10)].groupFooterTemplate)&&(e={type:i.columns[parseInt(t.toString(),10)].type.toString().toLowerCase(),field:i.columns[parseInt(t.toString(),10)].field},u.push(e));return u},n.prototype.groupedRowReorder=function(n,i){var r=this.parent.getRowElementByUID(n.uid),u=this.parent.getRowElementByUID(i.uid),f={rows:[r],target:u,fromIndex:n.index,dropIndex:i.index},o;t.isNullOrUndefined(n)||t.isNullOrUndefined(i)||n.parentUid===i.parentUid||(u?("none"===u.style.display&&(r.style.display="none"),f.fromIndex>f.dropIndex?this.parent.getContentTable().querySelector(e).insertBefore(r,u):this.parent.getContentTable().querySelector(e).insertBefore(r,u.nextSibling)):t.remove(r),this.groupReorderHandler(n,i),o=[].slice.call(this.parent.getContentTable().getElementsByClassName(y)),this.groupReorderRowObject(f,o,i),this.parent.enableVirtualization?this.vGroupResetRowIndex():of(this.parent,this.parent.getRowsObject().filter(function(n){return n.isDataRow}),o),this.parent.notify(wr,{rows:this.parent.getRowsObject()}))},n.prototype.vGroupResetRowIndex=function(){for(var n,f,e=this.parent,r=e.vRows,s=this.parent.getRows(),i=0,u=0,o=0;i<r.length;i++)if(r[parseInt(i.toString(),10)].isDataRow){if(r[parseInt(i.toString(),10)].index=u,r[parseInt(i.toString(),10)].isAltRow=!!e.enableAltRow&&u%2!=0,n=e.getRowElementByUID(r[parseInt(i.toString(),10)].uid),!t.isNullOrUndefined(n)){for(s[parseInt(o.toString(),10)]=n,n.setAttribute(h,u.toString()),n.setAttribute(ne,(u+1).toString()),r[parseInt(i.toString(),10)].isAltRow?n.classList.add("e-altrow"):n.classList.remove("e-altrow"),f=0;f<n.cells.length;f++)n.cells[parseInt(f.toString(),10)].setAttribute("index",u.toString());o++}u++}},n.prototype.groupReorderHandler=function(n,i){for(var e,r,o=this.parent,a=n.data,g=i.data,v=o.groupModule.getGroupAggregateTemplates(!1),b=o.getRowObjectFromUID(i.parentUid),k=o.getRowObjectFromUID(n.parentUid),u=[b],f=[k],y=o.groupSettings.columns,s=0;s<y.length;s++)a[y[parseInt(s.toString(),10)]]=g[y[parseInt(s.toString(),10)]],s>0&&(u.push(o.getRowObjectFromUID(u[s-1].parentUid)),f.push(o.getRowObjectFromUID(f[s-1].parentUid)));n.parentUid=i.parentUid;n.visible=i.visible;n.parentGid=i.parentGid;n.changes!==a&&(n.changes=a);var h=this.iterateGroupAggregates([{dragRowObjects:f,dropRowObjects:u}]),c=h.filter(function(n){return n.key===f[f.length-1].data.key||n.key instanceof Date&&n.key.toString()===f[f.length-1].data.key.toString()}),l=h.filter(function(n){return n.key===u[u.length-1].data.key||n.key instanceof Date&&n.key.toString()===u[u.length-1].data.key.toString()});for(h=[],t.isNullOrUndefined(c[0])||h.push(c[0]),t.isNullOrUndefined(l[0])||h.push(l[0]),e=o.currentViewData,r=0;r<e.length;r++)t.isNullOrUndefined(c[0])&&e[parseInt(r.toString(),10)].key===f[f.length-1].data.key||t.isNullOrUndefined(l[0])&&e[parseInt(r.toString(),10)].key===u[u.length-1].data.key?(e.splice(r,1),r--):t.isNullOrUndefined(c[0])||e[parseInt(r.toString(),10)].key!==c[0].key?t.isNullOrUndefined(l[0])||e[parseInt(r.toString(),10)].key!==l[0].key||(e[parseInt(r.toString(),10)]=l[0]):e[parseInt(r.toString(),10)]=c[0];var d=this.groupGenerator.generateRows(h,{}),p=[],w=[];for(r=0;r<f.length;r++)p.push.apply(p,this.getGroupParentFooterAggregateRowObject(f[parseInt(r.toString(),10)].uid));for(r=0;r<u.length;r++)w.push.apply(w,this.getGroupParentFooterAggregateRowObject(u[parseInt(r.toString(),10)].uid));f.push.apply(f,p);u.push.apply(u,w);this.updatedRowObjChange(f,d,v);this.updatedRowObjChange(u,d,v);this.groupReorderRefreshHandler(n,k,b,v)},n.prototype.updatedRowObjChange=function(n,i,r){var o=this.parent,s=o.getRowsObject(),v={},e=[],f,l,u,y,h,c,p,a,w;for(o.enableVirtualization&&(v=o.contentModule.vgenerator.cache,e=o.vcRows),f=0;f<n.length;f++){for(l=!1,u=0;u<i.length;u++){if(!(t.isNullOrUndefined(i[parseInt(u.toString(),10)])||t.isNullOrUndefined(n[parseInt(f.toString(),10)].data.key)||t.isNullOrUndefined(i[parseInt(u.toString(),10)].data.key))&&(n[parseInt(f.toString(),10)].data.key===i[parseInt(u.toString(),10)].data.key||n[parseInt(f.toString(),10)].data.key instanceof Date&&n[parseInt(f.toString(),10)].data.key.toString()===i[parseInt(u.toString(),10)].data.key.toString())){-1!==(h=s.indexOf(n[parseInt(f.toString(),10)]))&&(s[parseInt(h.toString(),10)].data=i[parseInt(u.toString(),10)].data,s[parseInt(h.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary);o.enableVirtualization&&-1!==(c=e.indexOf(n[parseInt(f.toString(),10)]))&&(e[parseInt(c.toString(),10)].data=i[parseInt(u.toString(),10)].data,e[parseInt(c.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary);n[parseInt(f.toString(),10)].data=i[parseInt(u.toString(),10)].data;n[parseInt(f.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary;i.splice(u,1);u--;l=!0;break}if(n[parseInt(f.toString(),10)].isAggregateRow&&i[parseInt(u.toString(),10)].isAggregateRow){for(y=0;y<r.length;y++)if(this.evaluateGroupAggregateValueChange(n[parseInt(f.toString(),10)],i[parseInt(u.toString(),10)],r[parseInt(y.toString(),10)])){-1!==(h=s.indexOf(n[parseInt(f.toString(),10)]))&&(s[parseInt(h.toString(),10)].data=i[parseInt(u.toString(),10)].data,s[parseInt(h.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary);o.enableVirtualization&&-1!==(c=e.indexOf(n[parseInt(f.toString(),10)]))&&(e[parseInt(c.toString(),10)].data=i[parseInt(u.toString(),10)].data,e[parseInt(c.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary);n[parseInt(f.toString(),10)].data=i[parseInt(u.toString(),10)].data;n[parseInt(f.toString(),10)].gSummary=i[parseInt(u.toString(),10)].gSummary;l=!0;break}if(l)break}}if(!l&&(p=o.getRowElementByUID(n[parseInt(f.toString(),10)].uid),t.isNullOrUndefined(p)||t.remove(p),s.splice(s.indexOf(n[parseInt(f.toString(),10)]),1),o.enableVirtualization))for(e.splice(e.indexOf(n[parseInt(f.toString(),10)]),1),a=1;a<=Object.keys(v).length;a++)w=v[parseInt(a.toString(),10)].indexOf(n[parseInt(f.toString(),10)]),-1!==w&&v[parseInt(a.toString(),10)].splice([parseInt(w.toString(),10)],1)}},n.prototype.groupReorderRefreshHandler=function(n,i,r,u){var f=this.parent,o=new oi(f.serviceLocator,null,f),c;for(t.isNullOrUndefined(n)||t.isNullOrUndefined(f.getRowElementByUID(n.uid))||o.refresh(n,f.getColumns(),!1),c=0;c<f.groupSettings.columns.length;c++){if(t.isNullOrUndefined(i)||t.isNullOrUndefined(f.getRowElementByUID(i.uid))||o.refresh(i,f.getColumns(),!1),t.isNullOrUndefined(r)||t.isNullOrUndefined(f.getRowElementByUID(r.uid))||o.refresh(r,f.getColumns(),!1),u.length){for(var s=t.isNullOrUndefined(i)?[]:this.getGroupParentFooterAggregateRowObject(i.uid),h=t.isNullOrUndefined(r)?[]:this.getGroupParentFooterAggregateRowObject(r.uid),e=0;e<h.length;e++)t.isNullOrUndefined(h[parseInt(e.toString(),10)])||t.isNullOrUndefined(f.getRowElementByUID(h[parseInt(e.toString(),10)].uid))||o.refresh(h[parseInt(e.toString(),10)],f.getColumns(),!1);for(e=0;e<s.length;e++)t.isNullOrUndefined(s[parseInt(e.toString(),10)])||t.isNullOrUndefined(f.getRowElementByUID(s[parseInt(e.toString(),10)].uid))||o.refresh(s[parseInt(e.toString(),10)],f.getColumns(),!1)}t.isNullOrUndefined(i)||(i=f.getRowObjectFromUID(i.parentUid));t.isNullOrUndefined(r)||(r=f.getRowObjectFromUID(r.parentUid))}},n.prototype.getGroupParentFooterAggregateRowObject=function(n){for(var i=this.parent.getRowsObject(),r=[],t=0;t<i.length;t++)i[parseInt(t.toString(),10)].parentUid===n&&i[parseInt(t.toString(),10)].isAggregateRow&&r.push(i[parseInt(t.toString(),10)]);return r},n.prototype.evaluateGroupAggregateValueChange=function(n,t,i){var r=!1;return n.data[i.field].field===t.data[i.field].field&&n.data[i.field].key===t.data[i.field].key&&n.data[i.field].hasOwnProperty(i.field+" - "+i.type)&&t.data[i.field].hasOwnProperty(i.field+" - "+i.type)&&(r=!0),r},n.prototype.groupReorderRowObject=function(n,i,r){for(var l,p,w,e,o=this.parent,f=o.enableVirtualization?o.vRows:o.getRowsObject(),s=[],c=r||o.getRowObjectFromUID(n.target.closest("tr").getAttribute("data-uid")),u=0;u<n.rows.length;u++)l=o.getRowObjectFromUID(n.rows[parseInt(u.toString(),10)].getAttribute("data-uid")),c===l&&(e=f.indexOf(c)),s.push(f.splice(f.indexOf(l),1)[0]);if(t.isNullOrUndefined(e)?(e=f.indexOf(c),n.fromIndex>n.dropIndex?f.splice.apply(f,[e,0].concat(s)):f.splice.apply(f,[e+1,0].concat(s))):f.splice.apply(f,[e,0].concat(s)),!o.enableVirtualization){for(var v={},y=this.parent.getCurrentViewRecords(),a=(u=0,i.length);u<a;u++)p=parseInt(i[parseInt(u.toString(),10)].getAttribute(h),10),v[parseInt(u.toString(),10)]=y[parseInt(p.toString(),10)];for(w=this.parent.getRows(),u=0,a=i.length;u<a;u++)w[parseInt(u.toString(),10)]=i[parseInt(u.toString(),10)],y[parseInt(u.toString(),10)]=v[parseInt(u.toString(),10)]}},n.prototype.gettingVirtualData=function(n,i,r){for(var u=[],e=function(f){var e,h,s;if(-1===i.indexOf(n[parseInt(f.toString(),10)].data)&&u.push(n[parseInt(f.toString(),10)].data),n[parseInt(f.toString(),10)].data.field===o.parent.groupSettings.columns[0])for(e=n[parseInt(f.toString(),10)].data.items,t.isNullOrUndefined(e.records)||(e=e.records),h=function(n){r&&-1===i.findIndex(function(t){return t[r.toString()]===e[parseInt(n.toString(),10)][r.toString()]})&&u.push(e[parseInt(n.toString(),10)])},s=0;s<e.length;s++)h(s)},o=this,f=0;f<n.length;f++)e(f);return u},n.prototype.iterateGroupAggregates=function(n){var k=n instanceof Array?n:[],rt=this.parent.getRowsObject(),i=this.parent.getCurrentViewRecords(),e=this.parent.getPrimaryKeyFieldNames()[0],a,v,r,o,s,y,h,d,c,f,it,b,l;if(this.parent.enableVirtualization&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(!t.isNullOrUndefined(n[0].dragRowObjects)||!t.isNullOrUndefined(n[0].dropRowObjects))&&(a=n[0].dragRowObjects,v=n[0].dropRowObjects,a&&i.push.apply(i,this.gettingVirtualData(a,i,e)),v&&i.push.apply(i,this.gettingVirtualData(v,i,e))),r=[],o=rt.map(function(n){return"delete"===n.edit&&r.push(n.data),n.changes instanceof Object?n.changes:n.data}),o=0===k.length?o:k,s=i.map(function(n){var t,i=u.DataUtil.getObject(e,n);return o.some(function(n){return t=n,i===u.DataUtil.getObject(e,n)})?t:n}),y=n,(!y.type||"cancel"!==y.type)&&r.length>0)for(h=0;h<r.length;h++)d=s.indexOf(r[parseInt(h.toString(),10)]),s.splice(d,1);for(var p,g,nt=[],tt=this.parent.aggregates,w=0;w<tt.length;w++)for(c=tt[parseInt(w.toString(),10)],f=0;f<c.columns.length;f++)it={type:c.columns[parseInt(f.toString(),10)].type.toString().toLowerCase(),field:c.columns[parseInt(f.toString(),10)].field},nt.push(it);for(b=this.parent.groupSettings.columns,l=0;l<b.length;l++)g=p||s,p=u.DataUtil.group(g,b[parseInt(l.toString(),10)],nt,null,null);return p},n.prototype.updateExpand=function(n){for(var r,o,f,e=n.uid,s=n.isExpand,i=this.parent.getRowsObject(),u=0;u<i.length;u++)if(r=i[parseInt(u.toString(),10)],r.uid===e||t.isNullOrUndefined(e))for(r.isExpand=s,o=function(n){var u=i[parseInt(n.toString(),10)],f=void 0;if(u.parentUid!==r.uid&&(f=i.filter(function(n){return n.uid===u.parentUid})[0]),u.parentUid===r.uid?u.visible=r.isExpand:t.isNullOrUndefined(f)||u.parentUid!==f.uid||(f.isExpand&&!0===f.visible?u.visible=!0:f.isExpand&&!1===f.visible&&(u.visible=!1)),t.isNullOrUndefined(e))return"break"},f=u+1;f<i.length&&"break"!==o(f);f++);this.parent.notify(it,{rows:i,args:{isFrozen:!1,rows:i}})},n}(),vht=function(){function n(n,t){this.aria=new oh;this.childRefs=[];this.parent=n;this.parent.isDestroyed||(this.focus=t.getService("focus"),this.parent.on(ii,this.clickHandler,this),this.parent.on(v,this.destroy,this),this.parent.on(ht,this.keyPressHandler,this),this.parent.on(sl,this.expand,this),this.parent.on(di,this.refreshColSpan,this),this.parent.on(v,this.destroyChildGrids,this),this.parent.on(ca,this.destroyChildGrids,this),this.serviceLocator=t)}return n.prototype.clickHandler=function(n){(n.target.classList.contains("e-icon-grightarrow")||n.target.classList.contains("e-icon-gdownarrow")&&!this.parent.allowGrouping)&&n.preventDefault();this.toogleExpandcollapse(t.closest(n.target,"td"))},n.prototype.toogleExpandcollapse=function(n){var s,v,b,et,k,d,g,nt,y,st;this.l10n=this.serviceLocator.getService("localization");var r,i=this.parent,p=this.parent.getContentTable(),ht=this.parent.getCurrentViewRecords().length-1,tt=n&&n.classList.contains("e-detailrowcollapse");if(!(!n||!n.classList.contains("e-detailrowcollapse")&&!n.classList.contains("e-detailrowexpand")||n&&n.classList.contains("e-masked-cell"))){var u=n.parentElement,ct=u.getAttribute("data-uid"),f=i.getRowObjectFromUID(ct),w=!1,a=this.parent.getContentTable().querySelector(e).children[u.rowIndex+1];if(n.classList.contains("e-detailrowcollapse")){if(s=f.data,this.isDetailRow(a))a.style.display="",i.notify(bp,{data:s,childGrid:i.childGrid,detailElement:n,isExpanded:tt}),w=!0;else if(i.getDetailTemplate()||i.childGrid){var rt=tr("grid-row"),c=this.parent.createElement("tr",{className:"e-detailrow",attrs:{"data-uid":rt}}),l=this.parent.createElement("th",{className:"e-detailcell",attrs:{scope:"col"}}),ft=this.parent.getVisibleColumns().length;for(this.parent.allowRowDragAndDrop&&ft++,l.setAttribute("colspan",ft.toString()),v=new lr({isDataRow:!0,isExpand:!0,uid:rt,isDetailRow:!0,cells:[new pi({cellType:o.Indent}),new pi({isDataCell:!0,visible:!0})]}),v.parentUid=f.uid,b=0,et=i.groupSettings.columns.length;b<et;b++)c.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),v.cells.unshift(new pi({cellType:o.Indent}));if(c.appendChild(this.parent.createElement("th",{className:"e-detailindentcell",attrs:{scope:"col"}})),c.appendChild(l),u.parentNode.insertBefore(c,u.nextSibling),i.detailTemplate){var lt=this.parent.isReact&&"string"!=typeof i.detailTemplate,at=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,ot=i.element.id+"detailTemplate";lt||at?(i.getDetailTemplate()(s,i,"detailTemplate",ot,null,null,l),this.parent.renderTemplates()):kt(l,i.getDetailTemplate()(s,i,"detailTemplate",ot,void 0,void 0,void 0,this.parent.root))}else r=new tv(this.getGridModel(i,f,i.printMode)),this.childRefs.push(r),r.query&&(r.query=r.query.clone()),r.parentDetails={parentID:i.element.id,parentPrimaryKeys:i.getPrimaryKeyFieldNames(),parentKeyField:i.childGrid.queryString,parentKeyFieldValue:i.childGrid.queryString&&ir(i.childGrid.queryString)?ut(i.childGrid.queryString,s):s[i.childGrid.queryString],parentRowData:s},i.isReact?r.parentDetails.parentInstObj=i:i.parentDetails&&i.parentDetails.parentInstObj&&i.parentDetails.parentInstObj.isReact&&(r.parentDetails.parentInstObj=i.parentDetails.parentInstObj),r.isLegacyTemplate=i.isReact||i.isLegacyTemplate,i.isPrinting&&(r.isPrinting=!0,r.on(it,this.promiseResolve(r),this),r.on(vi,this.promiseResolve(r),this)),f.childGrid=r,k=r.getInjectedModules(),d=i.getInjectedModules(),k&&k.length===d.length||r.setInjectedModules(d),g=this.parent.createElement("div",{id:"child"+srt(u,"e-grid").length+"_grid"+u.rowIndex+tr(""),className:"e-childgrid"}),l.appendChild(g),r.appendTo(g);c.appendChild(l);u.nextSibling?u.parentNode.insertBefore(c,u.nextSibling):u.parentNode.appendChild(c);nt=i.getRows();y=i.getRowsObject();nt.splice(nt.indexOf(u)+1,0,c);y.splice(y.indexOf(f)+1,0,v);i.trigger(ac,{detailElement:l,data:s,childGrid:r});i.notify(ac,{rows:y})}(t.classList(n,["e-detailrowexpand"],["e-detailrowcollapse"]),t.classList(n.firstElementChild,["e-dtdiagonaldown","e-icon-gdownarrow"],["e-dtdiagonalright","e-icon-grightarrow"]),f.isExpand=!0,n.classList.contains("e-lastrowcell")&&this.parent.getContent().clientHeight>p.scrollHeight)&&(t.removeClass(n.parentElement.querySelectorAll("td"),"e-lastrowcell"),st=p.querySelector(e).getElementsByClassName("e-detailrow").length-1,t.addClass(p.querySelector(e).getElementsByClassName("e-detailrow")[parseInt(st.toString(),10)].childNodes,["e-lastrowcell"]),this.lastrowcell=!0);this.aria.setExpand(n,!0);n.firstElementChild.setAttribute("title",this.l10n.getConstant("Expanded"))}else this.isDetailRow(a)&&(a.style.display="none",i.notify(bp,{data:f.data,childGrid:i.childGrid,detailElement:n,isExpanded:tt})),t.classList(n,["e-detailrowcollapse"],["e-detailrowexpand"]),t.classList(n.firstElementChild,["e-dtdiagonalright","e-icon-grightarrow"],["e-dtdiagonaldown","e-icon-gdownarrow"]),parseInt(u.getAttribute(h),10)===ht&&this.lastrowcell&&(t.addClass(n.parentElement.querySelectorAll("td"),"e-lastrowcell"),this.lastrowcell=!1),f.isExpand=!1,w=!0,this.aria.setExpand(n,!1),n.firstElementChild.setAttribute("title",this.l10n.getConstant("Collapsed"));(!t.isNullOrUndefined(i.detailTemplate)||i.childGrid&&w)&&(i.updateVisibleExpandCollapseRows(),i.notify(wr,{rows:i.getRowsObject()}));this.parent.allowTextWrap&&"auto"===this.parent.height&&(this.parent.getContentTable().scrollHeight>this.parent.getContent().clientHeight?this.parent.scrollModule.setPadding():this.parent.scrollModule.removePadding())}},n.prototype.getGridModel=function(n,i,r){var u;return n.isPrinting&&i.isExpand&&n.expandedRows&&n.expandedRows[i.index]&&n.expandedRows[i.index].gridModel?(n.expandedRows[i.index].gridModel.hierarchyPrintMode=n.childGrid.hierarchyPrintMode,u=t.extend({},n.expandedRows[i.index].gridModel,n.childGrid,!0)):(n.isPrinting&&n.childGrid.allowPaging&&(n.childGrid.allowPaging="CurrentPage"===r),u=t.extend({},{},n.childGrid,!0)),u},n.prototype.promiseResolve=function(n){var t=this;return function(){n.off(it,t.promiseResolve);n.off(vi,t.promiseResolve);n.notify(ol,{})}},n.prototype.isDetailRow=function(n){return n&&n.classList.contains("e-detailrow")},n.prototype.destroy=function(){var n=this.parent.element;!this.parent.isDestroyed&&n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.parent.off(ii,this.clickHandler),this.parent.off(v,this.destroy),this.parent.off(ht,this.keyPressHandler),this.parent.off(sl,this.expand),this.parent.off(di,this.refreshColSpan),this.parent.off(v,this.destroyChildGrids),this.parent.off(ca,this.destroyChildGrids))},n.prototype.getTDfromIndex=function(n,i){var r=t.isNullOrUndefined(n)?void 0:this.parent.getDataRows()[parseInt(n.toString(),10)];return r&&r.querySelector(i)?r.querySelector(i):null},n.prototype.expand=function(n){isNaN(n)||(n=this.getTDfromIndex(n,".e-detailrowcollapse"));n&&n.classList.contains("e-detailrowcollapse")&&this.toogleExpandcollapse(n)},n.prototype.collapse=function(n){isNaN(n)||(n=this.getTDfromIndex(n,".e-detailrowexpand"));n&&n.classList.contains("e-detailrowexpand")&&this.toogleExpandcollapse(n)},n.prototype.expandAll=function(){this.expandCollapse(!0);this.parent.trigger(l,{requestType:"expandAllComplete",type:l,moduleObj:this})},n.prototype.collapseAll=function(){this.expandCollapse(!1);this.parent.trigger(l,{requestType:"collapseAllComplete",type:l,moduleObj:this})},n.prototype.expandCollapse=function(n){for(var t,r=this.parent.getDataRows(),i=0,u=r.length;i<u;i++)t=r[parseInt(i.toString(),10)].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),n?this.expand(t):this.collapse(t)},n.prototype.keyPressHandler=function(n){var r=this.parent,i,u,t;switch(n.action){case"ctrlDownArrow":this.expandAll();break;case"ctrlUpArrow":this.collapseAll();break;case"altUpArrow":case"altDownArrow":i=r.allowSelection?r.getSelectedRowIndexes():[];i.length&&(u=r.getDataRows()[i[i.length-1]].querySelector(".e-detailrowcollapse, .e-detailrowexpand"),"altDownArrow"===n.action?this.expand(u):this.collapse(u));break;case"enter":if(this.parent.isEdit)return;if(t=this.focus.getFocusedElement(),t&&(t.classList.contains("e-icon-grightarrow")||t.classList.contains("e-icon-gdownarrow"))&&(t=t.parentElement),t&&!t.classList.contains("e-detailrowcollapse")&&!t.classList.contains("e-detailrowexpand"))break;this.toogleExpandcollapse(t)}},n.prototype.refreshColSpan=function(){for(var t=this.parent.contentModule.getTable().querySelectorAll("tr.e-detailrow"),i=this.parent.getVisibleColumns().length,n=0;n<t.length;n++)t[parseInt(n.toString(),10)].querySelector(".e-detailcell").setAttribute("colspan",i+"")},n.prototype.destroyChildGrids=function(){for(var t=this.parent.getRowsObject(),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].childGrid=null;for(n=0;n<this.childRefs.length;n++)this.childRefs[parseInt(n.toString(),10)].isDestroyed||this.childRefs[parseInt(n.toString(),10)].destroy();this.childRefs=[]},n.prototype.getModuleName=function(){return"detailRow"},n}(),yht=function(){function n(n,t){this.predefinedItems={};this.isSearched=!1;this.items=["Add","Edit","Update","Delete","Cancel","Print","Search","ColumnChooser","PdfExport","ExcelExport","CsvExport","WordExport"];this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");for(var r=this.parent.enableAdaptiveUI,e=["Edit","Delete","Update","Cancel"],i=0,u=["Add","Edit","Update","Delete","Cancel","Print","PdfExport","ExcelExport","WordExport","CsvExport"];i<u.length;i++){var n=u[i],t=n.toLowerCase(),f=t[0].toUpperCase()+t.slice(1);this.predefinedItems[""+n]={id:this.gridID+"_"+t,prefixIcon:"e-"+t,text:this.l10n.getConstant(f),tooltipText:this.l10n.getConstant(f)};r&&(this.predefinedItems[""+n].text="",this.predefinedItems[""+n].visible=-1===e.indexOf(n))}this.predefinedItems.Search={id:this.gridID+"_search",tooltipText:this.l10n.getConstant("Search"),align:"Right",cssClass:"e-search-wrapper",type:"Input"};this.predefinedItems.ColumnChooser={id:this.gridID+"_columnchooser",cssClass:"e-cc e-ccdiv e-cc-toolbar",suffixIcon:"e-columnchooser-btn",text:r?"":this.l10n.getConstant("Columnchooser"),tooltipText:this.l10n.getConstant("Columnchooser"),align:"Right"};"Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&(this.predefinedItems.responsiveFilter={id:this.gridID+"_responsivefilter",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resfilter-icon",tooltipText:this.l10n.getConstant("FilterButton")}),this.parent.allowSorting&&(this.predefinedItems.responsiveSort={id:this.gridID+"_responsivesort",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-ressort-icon",tooltipText:this.l10n.getConstant("Sort")}));this.parent.enableAdaptiveUI&&this.parent.toolbar&&this.parent.toolbar.indexOf("Search")>-1&&(this.predefinedItems.responsiveBack={id:this.gridID+"_responsiveback",cssClass:"e-gridresponsiveicons e-icons",suffixIcon:"e-resback-icon",visible:!1});this.createToolbar()},n.prototype.getToolbar=function(){return this.toolbar.element},n.prototype.destroy=function(){this.toolbar&&!this.toolbar.isDestroyed&&(this.toolbar.element?(this.toolbar.off("render-react-toolbar-template",this.addReactToolbarPortals),this.toolbar.destroy()):(this.parent.destroyTemplate(["toolbarTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),this.unWireEvent(),this.removeEventListener(),this.element.parentNode&&t.remove(this.element))},n.prototype.bindSearchEvents=function(){this.searchElement=t.select("#"+this.gridID+"_searchbar",this.element);this.wireEvent();this.refreshToolbarItems();this.parent.searchSettings&&this.updateSearchBox()},n.prototype.toolbarCreated=function(n){if(this.element.querySelector(".e-search-wrapper"))if(!this.parent.enableAdaptiveUI||n){var t=this.parent.cssClass?"e-input-group e-search "+this.parent.cssClass:"e-input-group e-search";this.element.querySelector(".e-search-wrapper").innerHTML='<div class="'+t+'" role="search">                    <input id="'+this.gridID+'_searchbar" class="e-input e-search" name="input" type="search"                     placeholder= "'+this.l10n.getConstant("Search")+'"/>                    <span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" aria-label= "clear" role= "clear" style="cursor: default"><\/span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search" role= "search"><\/span>                     <\/div>'}else this.element.querySelector(".e-search-wrapper").innerHTML='<span id="'+this.gridID+'_clearbutton" class="e-input-group-icon e-icons e-sicon"                     tabindex="-1" aria-label= "clear" style="cursor: default"><\/span>                    <span id="'+this.gridID+'_searchbutton" class="e-input-group-icon e-search-icon e-icons"                     tabindex="-1" title="'+this.l10n.getConstant("Search")+'" aria-label= "search"><\/span>                     <\/div>';this.bindSearchEvents()},n.prototype.createToolbar=function(){var o=this.getItems(),n;if(this.toolbar=new wo.Toolbar({items:o,clicked:this.toolbarClickHandler.bind(this),enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,created:this.toolbarCreated.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""}),this.toolbar.isReact=this.parent.isReact,this.toolbar.on("render-react-toolbar-template",this.addReactToolbarPortals,this),this.toolbar.isStringTemplate=!0,n="viewContainerRef",this.parent[""+n]&&(this.toolbar.registeredTemplate={},this.toolbar[""+n]=this.parent[""+n]),this.element=this.parent.createElement("div",{id:this.gridID+"_toolbarItems"}),this.parent.enableAdaptiveUI&&this.element.classList.add("e-res-toolbar"),this.parent.toolbarTemplate){if("string"==typeof this.parent.toolbarTemplate)this.toolbar.appendTo(this.parent.toolbarTemplate),this.element=this.toolbar.element;else{var s=this.parent.isReact&&"string"!=typeof this.parent.toolbarTemplate,h=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,c=this.parent.element.id+"toolbarTemplate";s||h?(ri(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate",c,null,null,this.element),this.parent.renderTemplates()):kt(this.element,ri(this.parent.toolbarTemplate)({},this.parent,"toolbarTemplate"))}this.element.classList.add("e-temp-toolbar")}else this.toolbar.appendTo(this.element);this.parent.element.insertBefore(this.element,this.parent.getHeaderContent());var i=this.element.querySelector(".e-toolbar-left"),r=this.element.querySelector(".e-toolbar-center"),u=this.element.querySelector(".e-toolbar-right"),f=this.element.querySelector(".e-toolbar-items"),e=this.element,l=i?i.clientWidth:0,a=r?r.clientWidth:0,v=u?u.clientWidth:0,y=f?f.clientWidth:0,t=e?e.clientWidth:0;(l>t||a>t||v>t||y>t)&&this.toolbar.refreshOverflow()},n.prototype.addReactToolbarPortals=function(n){this.parent.isReact&&n&&(this.parent.portals=this.parent.portals.concat(n),this.parent.renderTemplates())},n.prototype.renderResponsiveSearch=function(n){n?(this.toolbarCreated(!0),this.refreshResponsiveToolbarItems(bu.isSearch),this.searchElement=t.select("#"+this.gridID+"_searchbar",this.element),i(this.searchElement,"e-toolbar-right").classList.add("e-responsive-right"),this.parent.searchSettings&&this.updateSearchBox(),this.searchBoxObj.searchFocus({target:this.searchElement}),this.searchElement.focus()):this.refreshResponsiveToolbarItems(bu.isInitial)},n.prototype.refreshResponsiveToolbarItems=function(n){var f,s,t,r;if(n===bu.isInitial){for(var u=this.parent.element.id,e=[u+"_edit",u+"_delete"],c=this.parent.getSelectedRowIndexes(),l=[u+"_responsiveback",u+"_update",u+"_cancel"],o=0,h=this.toolbar.items;o<h.length;o++)(t=(r=h[o]).template.length?this.toolbar.element.querySelector(r.template):this.toolbar.element.querySelector("#"+r.id))&&(e.indexOf(r.id)>-1?c.length?t.parentElement.classList.remove("e-hidden"):t.parentElement.classList.add("e-hidden"):-1===l.indexOf(r.id)?t.parentElement.classList.remove("e-hidden"):t.parentElement.classList.add("e-hidden"));this.searchElement&&(i(this.searchElement,"e-toolbar-right").classList.remove("e-responsive-right"),this.toolbarCreated(!1),this.unWireEvent(),this.searchElement=void 0)}if(n===bu.isSearch)for(e=[this.parent.element.id+"_responsiveback",this.parent.element.id+"_search"],f=0,s=this.toolbar.items;f<s.length;f++)r=s[f],(t=this.toolbar.element.querySelector("#"+r.id))&&(e.indexOf(r.id)>-1?t.parentElement.classList.remove("e-hidden"):t.parentElement.classList.add("e-hidden"))},n.prototype.refreshToolbarItems=function(){var r=this.parent,t=[],n=[],i=r.editSettings,u=r.currentViewData&&r.currentViewData.length;i.allowAdding?t.push(this.gridID+"_add"):n.push(this.gridID+"_add");i.allowEditing&&u?t.push(this.gridID+"_edit"):n.push(this.gridID+"_edit");i.allowDeleting&&u?t.push(this.gridID+"_delete"):n.push(this.gridID+"_delete");"Batch"===r.editSettings.mode?r.element.getElementsByClassName("e-updatedtd").length&&(i.allowAdding||i.allowEditing)?(t.push(this.gridID+"_update"),t.push(this.gridID+"_cancel")):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel")):r.isEdit&&(i.allowAdding||i.allowEditing)?(t=[this.gridID+"_update",this.gridID+"_cancel"],n=[this.gridID+"_add",this.gridID+"_edit",this.gridID+"_delete"]):(n.push(this.gridID+"_update"),n.push(this.gridID+"_cancel"));this.enableItems(t,!0);this.enableItems(n,!1)},n.prototype.getItems=function(){var n=[],u=this.parent.toolbar||[],i,r,t;if("string"==typeof this.parent.toolbar)return[];for("Vertical"===this.parent.rowRenderingMode&&(this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&n.push(this.getItemObject("responsiveFilter")),this.parent.allowSorting&&n.push(this.getItemObject("responsiveSort"))),i=0,r=u;i<r.length;i++){t=r[i];switch(typeof t){case"number":n.push(this.getItemObject(this.items[t]));break;case"string":n.push(this.getItemObject(t));break;default:n.push(this.getItem(t))}}return this.parent.enableAdaptiveUI&&this.parent.toolbar&&this.parent.toolbar.indexOf("Search")>-1&&n.push(this.getItemObject("responsiveBack")),n},n.prototype.getItem=function(n){var i=this.predefinedItems[n.text];return i?t.extend(i,i,n):n},n.prototype.getItemObject=function(n){return this.predefinedItems[""+n]||{text:n,id:this.gridID+"_"+n}},n.prototype.enableItems=function(n,i){for(var e,f,r=0,u=n;r<u.length;r++)e=u[r],f=t.select("#"+e,this.element),f&&this.toolbar.enableItems(f.parentElement,i)},n.prototype.toolbarClickHandler=function(n){var i=this,u=this.parent,r=this.gridID,f,e;t.extend(n,{cancel:!1});f=n;e=n.originalEvent;u.trigger(vd,f,function(n){if(n.originalEvent=n.originalEvent?n.originalEvent:e,!n.cancel)switch(!t.isNullOrUndefined(n.item)&&n.item.id){case r+"_print":u.print();break;case r+"_edit":u.startEdit();break;case r+"_update":u.endEdit();break;case r+"_cancel":u.closeEdit();break;case r+"_add":u.addRecord();break;case r+"_delete":u.deleteRecord();break;case r+"_search":n.originalEvent.target.id===r+"_searchbutton"&&i.searchElement?i.search():!u.enableAdaptiveUI||i.searchElement||!n.originalEvent.target.classList.contains("e-search-wrapper")&&n.originalEvent.target.id!==r+"_searchbutton"?n.originalEvent.target.classList.contains("e-clear-icon")&&n.originalEvent.target.id===r+"_clearbutton"&&i.searchElement&&(i.searchElement.value="",i.searchElement&&(i.sIcon=i.searchElement.parentElement.querySelector(".e-sicon"),i.sIcon.classList.remove("e-clear-icon"),i.sIcon.removeAttribute("title"),i.sIcon.style.cursor="default"),(i.isSearched||i.parent.searchSettings.key.length)&&(i.parent.search(i.searchElement.value),i.isSearched=!1)):i.renderResponsiveSearch(!0);break;case r+"_columnchooser":var f=i.parent.element.querySelector(".e-ccdiv"),o=f.getBoundingClientRect().top,s=f.getBoundingClientRect().left,h=n.originalEvent.target;o=f.getBoundingClientRect().top+f.offsetTop;u.createColumnchooser(s,o,h);break;case r+"_responsivefilter":u.showResponsiveCustomFilter();break;case r+"_responsivesort":u.showResponsiveCustomSort();break;case r+"_responsiveback":i.renderResponsiveSearch(!1)}})},n.prototype.modelChanged=function(n){"edit"===n.module&&this.refreshToolbarItems()},n.prototype.onPropertyChanged=function(n){n.module===this.getModuleName()&&this.parent.toolbar&&(this.element&&t.remove(this.element),this.render())},n.prototype.keyUpHandler=function(n){13===n.keyCode&&this.search();this.searchElement&&(this.sIcon=this.searchElement.parentElement.querySelector(".e-sicon"),this.searchElement.value.length&&!t.isNullOrUndefined(this.sIcon)?(this.sIcon.classList.add("e-clear-icon"),this.sIcon.setAttribute("title","Clear"),this.sIcon.style.cursor="pointer"):(this.sIcon.classList.remove("e-clear-icon"),this.sIcon.removeAttribute("title"),this.sIcon.style.cursor="default"))},n.prototype.search=function(){this.isSearched=!0;this.parent.search(this.searchElement.value)},n.prototype.updateSearchBox=function(){this.searchElement&&(this.searchElement.value=this.parent.searchSettings.key)},n.prototype.wireEvent=function(){this.searchElement&&(this.searchBoxObj=new eit(this.searchElement),t.EventHandler.add(this.searchElement,"keyup",this.keyUpHandler,this),this.searchBoxObj.wireEvent());t.EventHandler.add(this.element,"focusin",this.onFocusIn,this);t.EventHandler.add(this.element,"focusout",this.onFocusOut,this)},n.prototype.unWireEvent=function(){this.searchElement&&(t.EventHandler.remove(this.searchElement,"keyup",this.keyUpHandler),this.searchBoxObj.unWireEvent());t.EventHandler.remove(this.element,"focusin",this.onFocusIn);t.EventHandler.remove(this.element,"focusout",this.onFocusOut)},n.prototype.onFocusIn=function(n){var i=this.parent.focusModule.currentInfo;i&&i.element&&(t.removeClass([i.element,i.elementToFocus],["e-focused","e-focus"]),i.element.tabIndex=-1);n.target.tabIndex=0},n.prototype.onFocusOut=function(n){n.target.tabIndex=-1},n.prototype.setFocusToolbarItem=function(n){var t=n.querySelector(".e-btn,.e-input,.e-toolbar-item-focus");!t&&this.parent.enableAdaptiveUI&&!this.searchElement&&n.classList.contains("e-search-wrapper")&&(t=n.querySelector("#"+this.gridID+"_searchbutton"));t.focus()},n.prototype.getFocusableToolbarItems=function(){for(var i=[].slice.call(this.element.querySelectorAll(".e-toolbar-item:not(.e-overlay):not(.e-hidden)")),r=[],n=0;n<i.length;n++)t.isNullOrUndefined(i[parseInt(n.toString(),10)].querySelector(".e-btn,.e-input,.e-toolbar-item-focus"))||r.push(i[parseInt(n.toString(),10)]);return r},n.prototype.keyPressedHandler=function(n){var u,t,r,f;if(n.target&&i(n.target,"e-toolbar-item")){if(u=i(n.target,"e-toolbar-item"),t=this.getFocusableToolbarItems(),"tab"===n.action||"shiftTab"===n.action){if("tab"===n.action&&u===t[t.length-1]||"shiftTab"===n.action&&u===t[0])return;for(r=0;r<t.length;r++)if(u===t[parseInt(r.toString(),10)])return n.preventDefault(),f="tab"===n.action?r+1:r-1,void this.setFocusToolbarItem(t[parseInt(f.toString(),10)])}"enter"===n.action&&this.parent.enableAdaptiveUI&&!this.searchElement&&n.target.id===this.gridID+"_searchbutton"&&this.renderResponsiveSearch(!0)}},n.prototype.reRenderToolbar=function(){this.element&&t.remove(this.element);this.render()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:io,handler:this.reRenderToolbar},{event:dt,handler:this.render},{event:tt,handler:this.onPropertyChanged},{event:gt,handler:this.updateSearchBox.bind(this)},{event:pt,handler:this.refreshToolbarItems},{event:tu,handler:this.refreshToolbarItems},{event:gt,handler:this.modelChanged},{event:ti,handler:this.refreshToolbarItems},{event:ii,handler:this.removeResponsiveSearch},{event:ea,handler:this.reRenderToolbar},{event:v,handler:this.destroy},{event:ht,handler:this.keyPressedHandler}],vt(this.parent,this.evtHandlers,!0,this),this.rowSelectedFunction=this.rowSelected.bind(this),this.rowDeSelectedFunction=this.rowSelected.bind(this),this.parent.addEventListener(af,this.rowSelectedFunction),this.parent.addEventListener(go,this.rowDeSelectedFunction))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(vt(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(af,this.rowSelectedFunction),this.parent.removeEventListener(go,this.rowDeSelectedFunction))},n.prototype.removeResponsiveSearch=function(n){var t=n.target,r=t.classList.contains("e-search-icon")||t.classList.contains("e-search-wrapper");this.parent.enableAdaptiveUI&&!r&&this.searchElement&&!i(n.target,"e-res-toolbar")&&this.renderResponsiveSearch(!1)},n.prototype.rowSelected=function(){this.parent.enableAdaptiveUI&&this.refreshResponsiveToolbarItems(bu.isInitial)},n.prototype.getModuleName=function(){return"toolbar"},n}(),pht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wht=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.aggregates={},r.parent=t,r.locator=i,r.modelGenerator=new uh(r.parent),r.addEventListener(),r}return pht(i,n),i.prototype.renderPanel=function(){var i=this.parent.createElement("div",{className:fu}),n=this.parent.createElement("div",{className:"e-summarycontent"}),u=n;if(this.parent.isFrozenGrid()){var f=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-left-footercontent"}),r=this.parent.createElement("div",{className:"e-movablefootercontent"}),e=this.parent.createElement("div",{className:"e-frozenfootercontent e-frozen-right-footercontent"});(this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount())&&(n.appendChild(f),this.frozenContent=f);n.appendChild(r);this.movableContent=r;u=r;this.parent.getFrozenRightColumnsCount()&&(n.appendChild(e),this.frozenRightContent=e)}t.Browser.isDevice&&(u.style.overflowX="scroll");i.appendChild(n);this.setPanel(i);null!=this.parent.getPager()?this.parent.element.insertBefore(i,this.parent.getPager()):this.parent.element.appendChild(i)},i.prototype.renderTable=function(){var o=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),n=this.createContentTable("_footer_table").querySelector("."+k),s=this.parent.createElement("tfoot"),r,i,f,u;(n.appendChild(s),this.parent.isFrozenGrid())&&(r=n.cloneNode(!0),i=n.cloneNode(!0),(o&&(this.frozenContent.appendChild(r),this.freezeTable=r),this.parent.getFrozenRightColumnsCount())&&(t.remove(i.querySelector(c)),f=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c).cloneNode(!0),i.insertBefore(f,i.querySelector(e)),this.frozenRightContent.appendChild(i),this.frTable=i),this.movableContent.appendChild(n),t.remove(n.querySelector(c)),u=this.parent.getHeaderContent().querySelector("."+w).querySelector(c).cloneNode(!0),n.insertBefore(u,n.querySelector(e)),this.setColGroup(u));this.setTable(n)},i.prototype.renderSummaryContent=function(n,i,r,u){var o=this.parent.dataSource instanceof Array?!this.parent.getDataModule().isRemote()&&this.parent.parentDetails?this.getData():this.parent.dataSource:this.parent.currentViewData,a=this.modelGenerator.getData(),v=t.isNullOrUndefined(r)?this.modelGenerator.getColumns():this.modelGenerator.getColumns(r,u),y=t.isNullOrUndefined(r)?this.modelGenerator.generateRows(o,n||this.aggregates):this.modelGenerator.generateRows(o,n||this.aggregates,r,u),s=document.createDocumentFragment(),h=new oi(this.locator,null,this.parent),f,c,e,l;for(h.element=this.parent.createElement("TR",{className:"e-summaryrow"}),f=0,c=a.length;f<c;f++)e=y[parseInt(f.toString(),10)],e&&(l=h.render(e,v),s.appendChild(l));i.tFoot.appendChild(s);this.aggregates=t.isNullOrUndefined(n)?this.aggregates:n},i.prototype.refresh=function(n){var i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),e=this.parent.getMovableColumnsCount(),o=this.parent.getFrozenRightColumnsCount(),u,f,s,r,h,c,l;if((this.parent.isFrozenGrid()&&(t.remove(this.getPanel()),this.renderPanel(),this.renderTable(),i&&(this.freezeTable.tFoot.innerHTML="",this.renderSummaryContent(n,this.freezeTable,0,i))),this.getTable().tFoot.innerHTML="",this.renderSummaryContent(n,this.getTable(),i,o?i+e:void 0),this.parent.getFrozenRightColumnsCount())&&(this.frTable.tFoot.innerHTML="",this.renderSummaryContent(n,this.frTable,i+e,i+e+o),u=[].slice.call(this.getTable().getElementsByClassName("e-lastsummarycell")),u.length))for(f=0;f<u.length;f++)u[parseInt(f.toString(),10)].style.borderRight="0px";this.parent.isFrozenGrid()&&(s=[].slice.call(this.parent.element.querySelector(".e-movablefootercontent").getElementsByClassName("e-summaryrow")),r=void 0,i&&(r=[].slice.call(this.parent.element.querySelector(".e-frozen-left-footercontent").getElementsByClassName("e-summaryrow")),this.refreshHeight(r,s),h=this.frozenContent,h.offsetHeight||(h.style.height=this.getTable().offsetHeight+"px")),o&&(c=[].slice.call(this.parent.element.querySelector(".e-frozen-right-footercontent").getElementsByClassName("e-summaryrow")),this.refreshHeight(c,s),r&&this.refreshHeight(c,r),l=this.frTable,l.offsetHeight||(l.style.height=this.getTable().offsetHeight+"px")),this.parent.allowResizing&&this.updateFooterTableWidth(this.getTable()));t.isNullOrUndefined(n)&&this.parent.isAutoFitColumns&&this.parent.autoFitColumns();this.onScroll()},i.prototype.refreshHeight=function(n,t){for(var r,u,i=0;i<n.length;i++)r=n[parseInt(i.toString(),10)].getBoundingClientRect().height,u=t[parseInt(i.toString(),10)].getBoundingClientRect().height,r<u?(n[parseInt(i.toString(),10)].classList.remove("e-hide"),n[parseInt(i.toString(),10)].style.height=u+"px"):r>u&&(t[parseInt(i.toString(),10)].classList.remove("e-hide"),t[parseInt(i.toString(),10)].style.height=r+"px")},i.prototype.refreshCol=function(){var n,t=n=this.parent.element.querySelector("."+ct).querySelector(c).cloneNode(!0);this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()?n=this.parent.getMovableVirtualHeader().querySelector(c).cloneNode(!0):(n=yh(t,this.parent.getFrozenColumns(),this.parent),this.freezeTable.replaceChild(t,this.freezeTable.querySelector(c))));this.getTable().replaceChild(n,this.getColGroup());this.setColGroup(n)},i.prototype.onWidthChange=function(n){this.getColFromIndex(n.index).style.width=t.formatUnit(n.width);this.parent.allowResizing&&"resize"===n.module&&this.updateFooterTableWidth(this.getTable())},i.prototype.onScroll=function(n){void 0===n&&(n={left:this.parent.isFrozenGrid()?this.parent.getContent().querySelector("."+p).scrollLeft:this.parent.getContent().firstChild.scrollLeft});this.getTable().parentElement.scrollLeft=n.left},i.prototype.getColFromIndex=function(n){var t=this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenColumns(),r=this.parent.getMovableColumnsCount(),u=this.parent.getFrozenRightColumnsCount(),i=this.parent.isRowDragable()&&"Right"!==this.parent.getFrozenMode()?1:0;return t&&n<t+i?this.freezeTable.querySelector(c).children[parseInt(n.toString(),10)]:u&&n>=t+r+i?this.frTable.querySelector(c).children[n-(t?t+r+i:t+r)]:this.getColGroup().children[n-(t?t+i:t)]},i.prototype.columnVisibilityChanged=function(){this.refresh()},i.prototype.addEventListener=function(){this.evtHandlers=[{event:rs,handler:this.refreshCol},{event:ae,handler:this.onWidthChange},{event:bc,handler:this.onScroll},{event:di,handler:this.columnVisibilityChanged},{event:nu,handler:this.refreshFooterRenderer}];vt(this.parent,this.evtHandlers,!0,this)},i.prototype.removeEventListener=function(){vt(this.parent,this.evtHandlers,!1)},i.prototype.updateFooterTableWidth=function(n){var t=this.parent.getHeaderTable();t&&n&&(n.style.width=t.style.width)},i.prototype.refreshFooterRenderer=function(n){var t=this.onAggregates(n);this.refresh(t)},i.prototype.getIndexByKey=function(n,t){for(var r=this.parent.getPrimaryKeyFieldNames()[0],i=0;i<t.length;i++)if(t[parseInt(i.toString(),10)][""+r]===n[""+r])return i;return-1},i.prototype.getData=function(){return this.parent.getDataModule().dataManager.executeLocal(this.parent.getDataModule().generateQuery(!0))},i.prototype.onAggregates=function(n){var r,t,h,p,c,e,o,l;n=n instanceof Array?n:[];var a=this.parent.getPrimaryKeyFieldNames()[0],f=[],s=!1,i={},v="dataSource",y=!1;if(!this.parent.renderModule.data.isRemote()&&this.parent.allowFiltering&&this.parent.filterSettings.columns.length&&(y=!0),r=this.parent.dataSource instanceof Array?y?this.parent.getFilteredRecords():this.parent.dataSource:this.parent.dataSource[""+v].json.length?this.parent.dataSource[""+v].json:this.parent.getCurrentViewRecords(),this.parent.parentDetails&&!this.parent.getDataModule().isRemote()&&(r=this.getData()),this.parent.editModule&&(i=this.parent.editModule.getBatchChanges()),Object.keys(i).length){for(t=0;t<r.length;t++)s=!1,i[gf].length&&this.getIndexByKey(r[parseInt(t.toString(),10)],i[gf])>-1&&(s=!0,f.push(i[gf][this.getIndexByKey(r[parseInt(t.toString(),10)],i[gf])])),i[eu].length&&this.getIndexByKey(r[parseInt(t.toString(),10)],i[eu])>-1?s=!0:s||f.push(r[parseInt(t.toString(),10)]);if(i[ar].length)for(t=0;t<i[ar].length;t++)f.push(i[ar][parseInt(t.toString(),10)])}else f=n.length?eo(r).map(function(t){var i,r=u.DataUtil.getObject(a,t);return n.some(function(n){return i=n,r===u.DataUtil.getObject(a,n)})?i:t}):r;for(h=n,h.type&&"cancel"===h.type&&(f=r),c={},e=this.parent.aggregates,t=0;t<e.length;t++)for(o=0;o<e[parseInt(t.toString(),10)].columns.length;o++)l=e[parseInt(t.toString(),10)].columns[parseInt(o.toString(),10)].type.toString(),p=eb(l,f,e[parseInt(t.toString(),10)].columns[parseInt(o.toString(),10)],this.parent),c[e[parseInt(t.toString(),10)].columns[parseInt(o.toString(),10)].field+" - "+l.toLowerCase()]=p;return{result:f,count:f.length,aggregates:c}},i}(fo),bht=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kht=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.element=t.parent.createElement("TD",{className:"e-summarycell",attrs:{tabindex:"-1"}}),t}return bht(i,n),i.prototype.getValue=function(n,i,r){var u=t.isNullOrUndefined(r.type)?r.columnName:r.field+" - "+("string"==typeof r.type?r.type.toLowerCase():"");return i[r.columnName]?i[r.columnName][""+u]:""},i.prototype.evaluate=function(n,i,r){var u=i.column,f,e,s,h,c,o;return(this.parent.on(wc,this.refreshWithAggregate(n,i),this),!(u.footerTemplate||u.groupFooterTemplate||u.groupCaptionTemplate))?("Vertical"===this.parent.rowRenderingMode&&(n.style.display="none"),!0):("Vertical"===this.parent.rowRenderingMode&&n.classList.add("e-lastsummarycell"),f=u.getTemplate(i.cellType),e=this.parent.getColumnByField(r[u.columnName].field),!t.isNullOrUndefined(e)&&(r[u.columnName].headerText=e.headerText,e.isForeignColumn())&&(s=e.columnData.filter(function(n){return n[e.foreignKeyField]===r[u.columnName].key})[0],s&&(r[u.columnName].foreignKey=s[e.foreignKeyValue])),h=this.parent.isReact&&(u.footerTemplate?"string"!=typeof u.footerTemplate:u.groupFooterTemplate?"string"!=typeof u.groupFooterTemplate:!!u.groupCaptionTemplate&&"string"!=typeof u.groupCaptionTemplate),c=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,h||c?(o=r[u.columnName],"groupCaptionTemplate"!==f.property&&"groupFooterTemplate"!==f.property||(o.groupKey=o.key),f.fn(o,this.parent,f.property,"",null,null,n),this.parent.renderTemplates()):kt(n,f.fn(r[u.columnName],this.parent,f.property,"")),!1)},i.prototype.refreshWithAggregate=function(n,i){var r=this,u=i;return function(i){var e=u,f=e.column.columnName?e.column.columnName:null,o=t.isNullOrUndefined(f)?null:i.cells.filter(function(n){return n.column.columnName===f})[0];n.parentElement&&n.parentElement.getAttribute("data-uid")===i.dataUid&&f&&f===o.column.columnName&&r.refreshTD(n,o,i.data)}},i}(si),dht=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"aggregate"},n.prototype.initiateRender=function(){for(var i,r,u=this,e=this.locator.getService("cellRendererFactory"),s=new kht(this.parent,this.locator),f=[o.Summary,o.CaptionSummary,o.GroupSummary],n=0;n<f.length;n++)e.addCellRenderer(f[parseInt(n.toString(),10)],s);this.footerRenderer=new wht(this.parent,this.locator);this.footerRenderer.renderPanel();this.footerRenderer.renderTable();i=this.footerRenderer.getPanel();this.parent.element.scrollHeight>=this.parent.getHeight(this.parent.height)&&i&&t.addClass([i],["e-footerpadding"]);this.locator.register("footerRenderer",this.footerRenderer);r=function(){u.prepareSummaryInfo();u.parent.off(ki,r)};this.parent.on(ki,r,this);this.parent.on(ki,this.footerRenderer.refresh,this.footerRenderer)},n.prototype.prepareSummaryInfo=function(){var n=this;wut(this.parent.aggregates,function(i){var r=t.getValue("customFormat",i),u,f;(t.isNullOrUndefined(r)||i.setPropertiesSilent({format:r}),"object"==typeof i.format)?(u=new wu,i.setFormatter(u.getFormatFunction(t.extend({},i.format)))):"string"==typeof i.format&&(f=n.locator.getService("valueFormatter"),i.setFormatter(f.getFormatFunction({format:i.format})));i.setPropertiesSilent({columnName:i.columnName||i.field})})},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()){t.isNullOrUndefined(this.footerRenderer)&&this.initiateRender();this.prepareSummaryInfo();this.footerRenderer.refresh();var i=new fh(this.parent);0===new uo(this.parent).getData().length&&i.isEmpty()||this.parent.notify(pt,{})}},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(dt,this.initiateRender,this),this.parent.on(tt,this.onPropertyChanged,this),this.parent.on(rp,this.refresh,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.footerRenderer.removeEventListener(),this.parent.off(dt,this.initiateRender),this.parent.off(ki,this.footerRenderer.refresh),this.parent.off(tt,this.onPropertyChanged),this.parent.off(rp,this.refresh),this.parent.off(v,this.destroy),this.parent.element.querySelector("."+fu)&&t.remove(this.parent.element.querySelector("."+fu)))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.refresh=function(n,t){var i=n instanceof Array?n:[n];this.parent.notify(nu,i);t&&(i.row=t);this.parent.groupSettings.columns.length>0&&this.parent.notify(uu,i)},n}();var nk=function(){function n(n,t,i){var r=this;this.fromWheel=!1;this.touchMove=!1;this.options={};this.sentinelInfo={up:{check:function(n,t){var i=n.top-r.containerRect.top,u=r.containerRect.bottom>n.bottom?r.containerRect.bottom-n.bottom:0;return t.entered=i>=0,i+r.options.pageHeight/2>=0||u>0&&n.bottom>0},axis:"Y"},down:{check:function(n,t){var i=n.bottom;return t.entered=n.bottom<=r.containerRect.bottom,i-r.containerRect.top-r.options.pageHeight/2<=r.options.pageHeight/2},axis:"Y"},right:{check:function(n,t){var i=n.right;return r.movableEle?(t.entered=i<r.movableContainerRect.right,i-r.movableContainerRect.width<=r.movableContainerRect.right):(t.entered=i<r.containerRect.right,i-r.containerRect.width<=r.containerRect.right)},axis:"X"},left:{check:function(n,t){var i=n.left;return t.entered=i>0,r.movableEle?i+r.movableContainerRect.width>=r.movableContainerRect.left:i+r.containerRect.width>=r.containerRect.left},axis:"X"}};this.element=n;this.options=t;this.movableEle=i}return n.prototype.observe=function(n,i){var r=this;this.containerRect=this.options.container.getBoundingClientRect();t.EventHandler.add(this.options.container,"wheel",function(){return r.fromWheel=!0},this);t.EventHandler.add(this.options.container,"scroll",this.virtualScrollHandler(n,i),this);this.options.movableContainer&&(this.movableContainerRect=this.options.movableContainer.getBoundingClientRect(),t.EventHandler.add(this.options.scrollbar,"wheel",function(){return r.fromWheel=!0},this),t.EventHandler.add(this.options.scrollbar,"scroll",this.virtualScrollHandler(n,i),this))},n.prototype.check=function(n){var t=this.sentinelInfo[""+n];return!this.movableContainerRect||"left"!==n&&"right"!==n?t.check(this.element.getBoundingClientRect(),t):t.check(this.movableEle.getBoundingClientRect(),t)},n.prototype.virtualScrollHandler=function(n,i){var r=this,u="chrome"===t.Browser.info.name?200:100,f=t.debounce(n,u),e=t.debounce(n,50);return this.options.prevTop=this.options.prevLeft=0,function(n){var s=r.options.movableContainer?r.options.container.scrollTop:n.target.scrollTop,o=r.options.movableContainer?r.options.scrollbar.scrollLeft:n.target.scrollLeft,t=r.options.prevTop<s?"down":"up",u,h,c;t=r.options.prevLeft===o?t:r.options.prevLeft<o?"right":"left";r.options.prevTop=s;r.options.prevLeft=o;u=r.sentinelInfo[""+t];-1!==r.options.axes.indexOf(u.axis)&&(r.containerRect=r.options.container.getBoundingClientRect(),h=r.check(t),(u.entered&&(!r.movableEle||"right"!==t&&"left"!==t?i(r.element,u,t,{top:s,left:o},r.fromWheel,h):i(r.movableEle,u,t,{top:s,left:o},r.fromWheel,h)),h)&&(c=f,"X"===u.axis&&(c=e),c({direction:t,sentinel:u,offset:{top:s,left:o},focusElement:document.activeElement})),r.fromWheel=!1)}},n.prototype.setPageHeight=function(n){this.options.pageHeight=n},n}(),tk=function(){function n(n){this.cOffsets={};this.cache={};this.movableCache={};this.frozenRightCache={};this.rowCache={};this.data={};this.groups={};this.currentInfo={};this.parent=n;this.model=this.parent.pageSettings;this.rowModelGenerator=this.parent.allowGrouping?new eh(this.parent):new er(this.parent)}return n.prototype.generateRows=function(n,i){var d=this,y=this.parent.isFrozenGrid(),p=!1,u=i.virtualInfo=i.virtualInfo||this.getData(),w=u.sentinelInfo&&"X"===u.sentinelInfo.axis,g=w||!u.loadNext||u.loadSelf?u.page:u.nextInfo.page,h=[],e=this.getBlockIndexes(g),b=[],k,r,f,v,o,l,c,a;if((this.currentInfo.blockIndexes&&(e=u.blockIndexes=i.virtualInfo.blockIndexes=this.includePrevPage?this.currentInfo.blockIndexes.slice(1):this.currentInfo.blockIndexes.slice(0,this.currentInfo.blockIndexes.length-1),p=!0),(y&&this.parent.getFrozenMode()!==s&&!i.renderMovableContent||this.parent.getFrozenMode()===s&&!i.renderMovableContent&&!i.renderFrozenRightContent||!y)&&this.checkAndResetCache(i.requestType),et(this.parent)&&this.parent.vcRows.length)&&(k=this.parent.vcRows.filter(function(n){return n.isDataRow}),this.parent.isManualRefresh&&k.length===n.records.length||!this.parent.isManualRefresh))return this.parent.vcRows;if(this.parent.enableColumnVirtualization)for(r=0;r<u.blockIndexes.length;r++)this.isBlockAvailable(u.blockIndexes[parseInt(r.toString(),10)])&&(this.cache[u.blockIndexes[parseInt(r.toString(),10)]]=this.rowModelGenerator.refreshRows(this.cache[u.blockIndexes[parseInt(r.toString(),10)]])),(i.renderMovableContent&&this.isMovableBlockAvailable(u.blockIndexes[parseInt(r.toString(),10)])||i.renderFrozenRightContent&&this.isFrozenRightBlockAvailable(u.blockIndexes[parseInt(r.toString(),10)]))&&((c=i.renderMovableContent?this.movableCache:this.frozenRightCache)[u.blockIndexes[parseInt(r.toString(),10)]]=this.rowModelGenerator.refreshRows(c[u.blockIndexes[parseInt(r.toString(),10)]]));for(f=u.blockIndexes,r=0;r<f.length;r++)this.isBlockAvailable(f[parseInt(r.toString(),10)])||(v=t.isNullOrUndefined(this.startIndex)?this.getStartIndex(f[parseInt(r.toString(),10)],n):this.startIndex,o=this.rowModelGenerator.generateRows(n,{virtualInfo:u,startIndex:v}),et(this.parent)&&!this.parent.vcRows.length&&(this.parent.vRows=o,this.parent.vcRows=o,this.parent.notify(oa,{})),l=void 0,et(this.parent)?this.getGroupVirtualRecordsByIndex(o):p?this.setBlockForManualRefresh(this.cache,e,o):(l=~~Math.max(o.length,this.model.pageSize)/2,this.isBlockAvailable(e[0])||(this.cache[e[0]]=o.slice(0,l)),this.isBlockAvailable(e[1])||(this.cache[e[1]]=o.slice(l)))),(this.parent.groupSettings.columns.length&&!w&&this.cache[f[parseInt(r.toString(),10)]]&&!this.parent.groupSettings.enableLazyLoading&&(this.cache[f[parseInt(r.toString(),10)]]=this.updateGroupRow(this.cache[f[parseInt(r.toString(),10)]],f[parseInt(r.toString(),10)])),i.renderMovableContent&&!this.isMovableBlockAvailable(f[parseInt(r.toString(),10)])||i.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(f[parseInt(r.toString(),10)]))&&(c=i.renderMovableContent?this.movableCache:this.frozenRightCache,v=t.isNullOrUndefined(this.startIndex)?this.getStartIndex(f[parseInt(r.toString(),10)],n):this.startIndex,o=this.rowModelGenerator.generateRows(n,{virtualInfo:u,startIndex:v}),p?this.setBlockForManualRefresh(c,e,o):(l=~~Math.max(o.length,this.model.pageSize)/2,(i.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(e[0])||i.renderMovableContent&&!this.isMovableBlockAvailable(e[0]))&&(c[e[0]]=o.slice(0,l)),(i.renderFrozenRightContent&&!this.isFrozenRightBlockAvailable(e[1])||i.renderMovableContent&&!this.isMovableBlockAvailable(e[1]))&&(c[e[1]]=o.slice(l)))),i.renderMovableContent||i.renderFrozenRightContent||!this.cache[f[parseInt(r.toString(),10)]]?(c=i.renderMovableContent?this.movableCache:this.frozenRightCache)[f[parseInt(r.toString(),10)]]&&h.push.apply(h,c[f[parseInt(r.toString(),10)]]):h.push.apply(h,this.cache[f[parseInt(r.toString(),10)]]),this.isBlockAvailable(f[parseInt(r.toString(),10)])&&b.push(f[parseInt(r.toString(),10)]);return u.blockIndexes=b,a="records",this.parent.allowGrouping&&this.parent.groupSettings.columns.length?this.parent.currentViewData[""+a]=h.map(function(n){return n.data}):y?(i.renderMovableContent&&("Left"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode()||this.parent.getFrozenColumns())||i.renderFrozenRightContent)&&(this.parent.currentViewData=h.map(function(n){return n.data})):this.parent.currentViewData=h.map(function(n){return n.data}),"grouping"===i.requestType&&(this.parent.currentViewData[""+a]=this.parent.currentViewData[""+a].filter(function(n,t){return d.parent.currentViewData[""+a].indexOf(n)===t})),et(this.parent)&&this.parent.vcRows.length&&["save","delete"].some(function(n){return i.requestType===n})?this.parent.vcRows:h},n.prototype.setBlockForManualRefresh=function(n,t,i){var r=this.model.pageSize/2;this.includePrevPage?(n[t[0]-1]=i.slice(0,r),n[t[0]]=i.slice(r,2*r),n[t[1]]=i.slice(2*r,3*r),n[t[2]]=i.slice(3*r,4*r)):(n[t[0]]=i.slice(0,r),n[t[1]]=i.slice(r,2*r),n[t[2]]=i.slice(2*r,3*r),n[t[2]+1]=i.slice(3*r,4*r))},n.prototype.getBlockIndexes=function(n){return[n+(n-1),2*n]},n.prototype.getPage=function(n){return n%2==0?n/2:(n+1)/2},n.prototype.isBlockAvailable=function(n){return n in this.cache},n.prototype.isMovableBlockAvailable=function(n){return n in this.movableCache},n.prototype.isFrozenRightBlockAvailable=function(n){return n in this.frozenRightCache},n.prototype.getData=function(){return{page:this.model.currentPage,blockIndexes:this.getBlockIndexes(this.model.currentPage),direction:"down",columnIndexes:this.parent.getColumnIndexesInView()}},n.prototype.getStartIndex=function(n,t,i){void 0===i&&(i=!0);var u=n%2==0,r=(this.getPage(n)-1)*this.model.pageSize;return i||!u?r:r+~~(this.model.pageSize/2)},n.prototype.getColumnIndexes=function(n){var s=this,r,e;void 0===n&&(n=this.parent.getHeaderContent().querySelector("."+st));this.parent.isFrozenGrid()&&(n=n.querySelector("."+w));var f=[],i=0|n.scrollLeft,o=Object.keys(this.cOffsets),u=n.getBoundingClientRect().width;return i=Math.min(this.cOffsets[o.length-1]-u,i),r=t.Browser.isDevice?2*u:u/2,e=i+u+(0===i?r:0),o.some(function(n){var u=Number(n),t=s.cOffsets[""+n];return i-r<=t&&e+r>=t&&f.push(u),e+r<t}),this.addFrozenIndex(f),f},n.prototype.addFrozenIndex=function(n){if(this.parent.getFrozenColumns()&&this.parent.enableColumnVirtualization&&0===n[0])for(var t=0;t<this.parent.getFrozenColumns();t++)n.push(n[n.length-1]+1)},n.prototype.checkAndResetCache=function(n){var t=["paging","refresh","sorting","filtering","searching","grouping","ungrouping","reorder","save","delete"],i;return this.parent.getFrozenColumns()&&this.parent.frozenRows&&this.parent.enableColumnVirtualization&&"reorder"===n&&t.splice(t.indexOf(n),1),i=t.some(function(t){return n===t}),i&&(this.cache={},this.data={},this.groups={},this.movableCache={},this.frozenRightCache={}),i},n.prototype.refreshColOffsets=function(){var f=0,u,t,n;this.cOffsets={};for(var e=this.parent.groupSettings.columns.length,r=this.parent.columns,o=r.length,s=this.parent.groupSettings.columns,i=0;i<s.length;i++)this.cOffsets[parseInt(i.toString(),10)]=30+(0|this.cOffsets[i-1]);for(t=Array.apply(null,Array(o)).map(function(){return f++}),n=0;n<t.length;n++)t[parseInt(n.toString(),10)]=t[parseInt(n.toString(),10)]+e,this.cOffsets[t[parseInt(n.toString(),10)]]=(0|this.cOffsets[t[parseInt(n.toString(),10)]-1])+((u=r[parseInt(n.toString(),10)]).visible&&(this.parent.groupSettings.showGroupedColumn?u.visible:this.parent.groupSettings.columns.indexOf(u.field)<0)?parseInt(r[parseInt(n.toString(),10)].width,10):0)},n.prototype.updateGroupRow=function(n,t){for(var f=n[0],r=[],u=Object.keys(this.cache),i=0;i<u.length;i++)Number(u[parseInt(i.toString(),10)])<t&&(r=r.concat(this.cache[u[parseInt(i.toString(),10)]]));return f&&f.isDataRow||t%2==0?n:this.iterateGroup(n,r)},n.prototype.iterateGroup=function(n,t){var i=n[0],r=0;return i&&i.isDataRow||n.some(function(n){return t.some(function(t,i){var u=t&&void 0!==t.data.field&&t.data.field===n.data.field&&t.data.key===n.data.key;return u&&(r=i),u})})&&(n.shift(),n=this.iterateGroup(n,t.slice(r))),n},n.prototype.getRows=function(){for(var n=[],i=Object.keys(this.cache),t=0;t<i.length;t++)n=n.concat(this.cache[i[parseInt(t.toString(),10)]]);return n},n.prototype.generateCells=function(n){for(var i=[],r=this.parent.columnModel,t=0;t<r.length;t++)i.push(this.rowModelGenerator.generateCell(r[parseInt(t.toString(),10)],null,null,null,null,n));return i},n.prototype.getGroupVirtualRecordsByIndex=function(n){for(var r,i,f=this.parent.contentModule.getGroupedTotalBlocks(),u=this.parent.contentModule.getBlockSize(),t=1;t<=f;t++)for(r=0,this.cache[parseInt(t.toString(),10)]=[],i=(t-1)*u;i<n.length&&r!==u;i++)this.cache[parseInt(t.toString(),10)].push(n[parseInt(i.toString(),10)]),n[parseInt(i.toString(),10)].isDataRow&&r++},n}(),but=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ny=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.prevHeight=0,r.startIndex=0,r.preStartIndex=0,r.preventEvent=!1,r.actions=["filtering","searching","grouping","ungrouping"],r.offsets={},r.tmpOffsets={},r.virtualEle=new rk,r.offsetKeys=[],r.isFocused=!1,r.isSelection=!1,r.isBottom=!1,r.isTop=!1,r.rndrCount=0,r.diff=0,r.heightChange=!1,r.empty=void 0,r.isCancel=!1,r.requestTypes=["beginEdit","cancel","delete","add","save"],r.isNormaledit="Normal"===r.parent.editSettings.mode,r.virtualData={},r.emptyRowData={},r.vfColIndex=[],r.frzIdx=1,r.isContextMenuOpen=!1,r.isSelectionScroll=!1,r.validationCheck=!1,r.locator=i,r.eventListener("on"),r.parent.on(di,r.setVisible,r),r.vgenerator=r.generator,r}return but(i,n),i.prototype.renderTable=function(){this.header=this.locator.getService("rendererFactory").getRenderer(at.Header);n.prototype.renderTable.call(this);this.virtualEle.table=this.getTable();this.virtualEle.content=this.content=this.getPanel().querySelector("."+ft);this.virtualEle.renderWrapper(this.parent.height);this.virtualEle.renderPlaceHolder();this.virtualEle.wrapper.style.position="absolute";var t=this.parent.dataSource instanceof u.DataManager&&!this.parent.dataSource.dataSource.offline,i={container:this.content,pageHeight:2*this.getBlockHeight(),debounceEvent:t,axes:this.parent.enableColumnVirtualization?["X","Y"]:["Y"]};this.observer=new nk(this.virtualEle.wrapper,i)},i.prototype.renderEmpty=function(n){this.getTable().appendChild(n);this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(e).innerHTML="");this.virtualEle.adjustTable(0,0)},i.prototype.getReorderedFrozenRows=function(n){var t=n.virtualInfo.blockIndexes,i=n.virtualInfo.columnIndexes,r=n.virtualInfo.page;n.virtualInfo.blockIndexes=[1,2];n.virtualInfo.page=1;n.renderMovableContent||(n.virtualInfo.columnIndexes=[]);var u=this.parent.getCurrentViewRecords().length,f=this.parent.renderModule.data.dataManager.dataSource.json.slice(0,u),e=this.vgenerator.generateRows(f,n);return n.virtualInfo.blockIndexes=t,n.virtualInfo.columnIndexes=i,n.virtualInfo.page=r,e.splice(0,this.parent.frozenRows)},i.prototype.scrollListener=function(n){if(this.scrollAfterEdit(),this.parent.enablePersistence&&(this.parent.scrollPosition=n.offset),this.preventEvent||this.parent.isDestroyed)this.preventEvent=!1;else{if(this.parent.islazyloadRequest&&"down"===n.direction)return this.parent.removeMaskRow(),void(this.parent.islazyloadRequest=!1);this.isFocused=t.isNullOrUndefined(document.activeElement)?!1:this.content===t.closest(document.activeElement,"."+ft)||this.content===document.activeElement;var r=n.sentinel,i=this.currentInfo=this.getInfoFromView(n.direction,r,n.offset);if(et(this.parent))return i.blockIndexes&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()?void this.parent.removeMaskRow():(i.event="refresh-virtual-block",t.isNullOrUndefined(i.offsets)||(i.offsets.top=this.content.scrollTop),this.parent.pageSettings.currentPage=i.page,this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(r.axis),this.parent.addShimmerEffect()),void this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:n.focusElement}));if(this.prevInfo&&("Y"===r.axis&&this.prevInfo.blockIndexes.toString()===i.blockIndexes.toString()||"X"===r.axis&&this.prevInfo.columnIndexes.toString()===i.columnIndexes.toString()))return this.parent.removeMaskRow(),t.Browser.isIE&&this.parent.hideSpinner(),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,"Y"===r.axis&&this.restoreEdit(),void(this.parent.groupSettings.enableLazyLoading&&1===this.prevInfo.blockIndexes[0]&&1===i.blockIndexes[0]&&"up"===n.direction&&this.virtualEle.adjustTable(0,i.offsets.top<this.offsets[1]?0:this.getBlockHeight()));this.parent.setColumnIndexesInView(this.parent.enableColumnVirtualization?i.columnIndexes:[]);this.parent.pageSettings.currentPage=i.loadNext&&!i.loadSelf?i.nextInfo.page:i.page;this.requestType="virtualscroll";this.parent.enableVirtualMaskRow&&(this.parent.showMaskRow(r.axis),this.parent.addShimmerEffect());this.parent.islazyloadRequest=!1;this.parent.notify(i.event,{requestType:"virtualscroll",virtualInfo:i,focusElement:n.focusElement});this.parent.enableColumnVirtualization&&!this.parent.getContentTable().querySelector("tr.e-row")&&(this.parent.removeMaskRow(),this.appendContent(void 0,void 0,{requestType:"virtualscroll",virtualInfo:i,focusElement:n.focusElement}),this.prevInfo=i)}},i.prototype.block=function(n){return this.vgenerator.isBlockAvailable(n)},i.prototype.getInfoFromView=function(n,t,i){var o=!1,e=[],r={direction:n,sentinelInfo:t,offsets:i,startIndex:this.preStartIndex,endIndex:this.preEndIndex},u,s,f;return r.page=this.getPageFromTop(i.top,r),r.blockIndexes=e=this.vgenerator.getBlockIndexes(r.page),r.loadSelf=!this.vgenerator.isBlockAvailable(e[r.block]),u=this.ensureBlocks(r),"upArrow"===this.activeKey&&r.blockIndexes.toString()!==u.toString()&&(s=u[u.length-1],-1===r.blockIndexes.indexOf(s)&&(o=!0)),(r.blockIndexes=u,r.loadNext=!u.filter(function(n){return-1===e.indexOf(n)}).every(this.block.bind(this)),r.event=r.loadNext||r.loadSelf?pt:es,r.nextInfo=r.loadNext?{page:Math.max(1,r.page+("down"===n?1:-1))}:{},o&&(r.blockIndexes=[r.blockIndexes[0]-1,r.blockIndexes[0],r.blockIndexes[0]+1]),"downArrow"!==this.activeKey||isNaN(this.rowIndex))||(f=Math.ceil(this.rowIndex/this.getBlockSize()),1!==f&&(r.blockIndexes[1]!==f||r.blockIndexes.length<3)&&(r.blockIndexes=[f-1,f,f+1])),r.columnIndexes="X"===t.axis?this.vgenerator.getColumnIndexes():this.parent.getColumnIndexesInView(),this.parent.enableColumnVirtualization&&"X"===t.axis&&(r.event=es),r},i.prototype.setKeyboardNavIndex=function(){this.blazorDataLoad=!0;"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey||(this.blzRowIndex="downArrow"===this.activeKey?this.rowIndex+1:this.rowIndex-1,document.activeElement.blur())},i.prototype.ensureBlocks=function(n){var r,u=this,i=n.blockIndexes[n.block],e=i,f=Math.max,t="down"===n.direction?[f(i,1),++i,++i]:[f(i-1,1),i,i+1];return this.prevInfo=this.prevInfo||this.vgenerator.getData(),this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&("X"===n.sentinelInfo.axis||"Y"===n.sentinelInfo.axis&&n.page===this.prevInfo.page)&&(t=this.prevInfo.blockIndexes),t=t.filter(function(n,i){return t.indexOf(n)===i}),this.prevInfo.blockIndexes.toString()===t.toString()||((n.loadSelf||"down"===n.direction&&this.isEndBlock(e))&&(t=this.vgenerator.getBlockIndexes(n.page)),t.some(function(n,t){var i=n===(et(u.parent)?u.getGroupedTotalBlocks():u.getTotalBlocks());return i&&(r=t),i}),void 0!==r&&(t=t.slice(0,r+1),0===n.block&&1===t.length&&this.vgenerator.isBlockAvailable(t[0]-1)&&(t=[t[0]-1,t[0]]))),t},i.prototype.appendContent=function(n,i,r){var ot=this,c=this.parent.isFrozenGrid(),d=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),f=this.parent.enableColumnVirtualization&&c,u,p,l,a,o,g,nt,y,h,w,tt,it,v,rt,b,ut;if(this.checkFirstBlockColIndexes(r),u=r.virtualInfo.sentinelInfo&&"Y"===r.virtualInfo.sentinelInfo.axis&&this.currentInfo.page&&this.currentInfo.page!==r.virtualInfo.page?this.currentInfo:r.virtualInfo,this.prevInfo=this.prevInfo||r.virtualInfo,p=u.columnIndexes[0]-1,f&&u.columnIndexes[0]===d&&(p=u.columnIndexes[0]-d-1),a=this.getColumnOffset(p),o=u.blockIndexes,this.parent.groupSettings.columns.length&&this.refreshOffsets(),"100%"===this.parent.height&&(this.parent.element.style.height="100%"),g=this.parent.height.toString().indexOf("%")<0?this.content.getBoundingClientRect().height:this.parent.element.getBoundingClientRect().height,this.requestTypes.some(function(n){return n===ot.requestType})||(nt=this.getTranslateY(this.content.scrollTop,g,u),this.parent.groupSettings.enableLazyLoading&&u&&this.prevInfo&&1===this.prevInfo.blockIndexes[0]&&1===u.blockIndexes[0]&&"up"===u.direction?this.virtualEle.adjustTable(0,this.content.scrollTop<this.offsets[1]?0:this.getBlockHeight()):this.virtualEle.adjustTable(f?0:a,nt),f&&this.virtualEle.adjustMovableTable(a,0)),(this.parent.enableColumnVirtualization&&(this.header.virtualEle.adjustTable(f?0:a,0),f&&this.header.virtualEle.adjustMovableTable(a,0)),this.parent.enableColumnVirtualization)&&(y=u.columnIndexes,l=this.getColumnOffset(y[y.length-1])-this.getColumnOffset(y[0]-1)+"",f?this.header.virtualEle.setMovableWrapperWidth(l):this.header.virtualEle.setWrapperWidth(l)),f?this.virtualEle.setMovableWrapperWidth(l,t.Browser.isIE||"edge"===t.Browser.info.name):this.virtualEle.setWrapperWidth(l,t.Browser.isIE||"edge"===t.Browser.info.name),!(this.parent.enableColumnVirtualization&&t.isNullOrUndefined(n)&&t.isNullOrUndefined(i))){if(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.parentNode)||t.remove(n),c?r.renderFrozenRightContent?h=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(e):r.renderMovableContent?r.renderMovableContent&&(h=this.parent.getMovableVirtualContent().querySelector(e)):h=this.parent.getFrozenVirtualContent().querySelector(e):h=this.parent.element.querySelector("."+ft).querySelector(e),h&&(t.remove(h),n=null),this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?n=i:(n=this.parent.createElement(e,{attrs:{role:"rowgroup"}})).appendChild(i),this.parent.frozenRows&&"virtualscroll"===r.requestType&&1===this.parent.pageSettings.currentPage)for(w=0;w<this.parent.frozenRows;w++)n.children[0].remove();(c?(r.renderFrozenRightContent?(this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+k).appendChild(n),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,this.parent.notify(ei,{"case":"refreshHeight"})):r.renderMovableContent?r.renderMovableContent&&(this.parent.getMovableVirtualContent().querySelector("."+k).appendChild(n),this.parent.getFrozenMode()!==s&&(this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType,this.parent.notify(ei,{"case":"refreshHeight"}))):this.parent.getFrozenVirtualContent().querySelector("."+k).appendChild(n),this.vfColIndex.length&&(r.virtualInfo.columnIndexes=u.columnIndexes=t.extend([],this.vfColIndex),this.vfColIndex=r.renderMovableContent?[]:this.vfColIndex)):(this.getTable().appendChild(n),this.requestType="virtualscroll"===this.requestType?this.empty:this.requestType),this.parent.groupSettings.columns.length)&&(et(this.parent)||"up"!==u.direction||(tt=this.offsets[this.getTotalBlocks()]-this.prevHeight,this.parent.groupSettings.enableLazyLoading||(this.preventEvent=!0),it=this.content.scrollTop,this.content.scrollTop=it+tt),this.setVirtualHeight(),this.parent.groupSettings.enableLazyLoading||this.observer.setPageHeight(this.getOffset(o[o.length-1])-this.getOffset(o[0]-1)));this.prevInfo=u;this.isFocused&&"downArrow"!==this.activeKey&&"upArrow"!==this.activeKey&&this.content.focus();v=Math.ceil(this.getTotalBlocks()/2);(this.isBottom&&(this.isBottom=!1,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage+1!==v&&this.parent.pageSettings.currentPage!==v||2!==o.length||"delete"!==r.requestType||(this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-1]),this.parent.pageSettings.currentPage===v&&1===o.length&&(this.isBottom=!0,this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-2]),this.parent.isFrozenGrid()&&this.parent.pageSettings.currentPage===v-1&&"up"===u.direction&&(this.parent.getContent().firstElementChild.scrollTop=this.offsets[this.offsetKeys.length-3]),this.isTop&&(this.parent.getContent().firstElementChild.scrollTop=0,this.isTop=!1),"virtualscroll"===r.requestType&&"X"===r.virtualInfo.sentinelInfo.axis&&this.parent.notify(gu,{}),this.focusCell(r),this.restoreEdit(r),this.restoreAdd(r),this.ensureSelectedRowPosition(),this.validationScrollLeft(r,c),this.initialRowTop)||(rt=this.parent.element.getBoundingClientRect().top,this.parent.getRowByIndex(0)&&(this.initialRowTop=this.parent.getRowByIndex(0).getBoundingClientRect().top-rt));b=r.tableName;ut="Left-Right"===this.parent.getFrozenMode()?"frozen-right"===b:"movable"===b;c&&!ut||(this.vgenerator.startIndex=null,this.vgenerator.currentInfo={},this.vgenerator.includePrevPage=null)}},i.prototype.validationScrollLeft=function(n,t){var u=this.parent.getFrozenColumns(),r=this.parent.getFrozenMode(),f=!t||n&&(u||"Left"===r||"Right"===r?n.renderMovableContent:n.renderFrozenRightContent),i;this.validationCheck&&f&&(this.validationCol?(i=this.vgenerator.cOffsets[this.validationCol.index-this.parent.getVisibleFrozenColumns()-1],this.validationCol=null,this.parent.isFrozenGrid()?this.movableContent.scrollLeft=i:this.content.scrollLeft=i):(this.validationCheck=!1,this.parent.editModule.editFormValidate()))},i.prototype.ensureSelectedRowPosition=function(){if(!this.isSelection&&this.isSelectionScroll&&!t.isNullOrUndefined(this.selectRowIndex)){this.isSelectionScroll=!1;var n=this.parent.getRowByIndex(this.selectRowIndex);n&&!this.isRowInView(n)&&this.rowSelected({rowIndex:this.selectRowIndex,row:n},!0)}},i.prototype.checkFirstBlockColIndexes=function(n){var u,i,r;if(this.parent.enableColumnVirtualization&&this.parent.isFrozenGrid()&&0===n.virtualInfo.columnIndexes[0])if(u=[],i=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount(),!n.renderMovableContent&&n.virtualInfo.columnIndexes.length>i){for(this.vfColIndex=n.virtualInfo.columnIndexes,r=0;r<i;r++)u.push(r);n.virtualInfo.columnIndexes=u}else n.renderMovableContent&&(this.vfColIndex.length||(this.vfColIndex=t.extend([],n.virtualInfo.columnIndexes)),n.virtualInfo.columnIndexes=t.extend([],this.vfColIndex),n.virtualInfo.columnIndexes.splice(0,i))},i.prototype.focusCell=function(){if("upArrow"===this.activeKey||"downArrow"===this.activeKey){var n=this.parent.getRowByIndex(this.rowIndex);n.cells[this.cellIndex].focus({preventScroll:!0});this.parent.selectionSettings.checkboxOnly||this.parent.selectRow(parseInt(n.getAttribute(h),10));this.activeKey=this.empty}},i.prototype.restoreEdit=function(n){var u,h;if(this.isNormaledit){var c=this.parent.getFrozenColumns(),r=n&&this.parent.isFrozenGrid(),f=this.parent.getFrozenMode(),l=n&&(c||"Left"===f||"Right"===f?n.renderMovableContent:n.renderFrozenRightContent);if((!r||r&&l)&&this.parent.editSettings.allowEditing&&this.parent.editModule&&!t.isNullOrUndefined(this.editedRowIndex)){var i=this.getRowByIndex(this.editedRowIndex),e=this.content,o=Object.keys(this.virtualData),s=n&&n.virtualInfo&&"X"===n.virtualInfo.sentinelInfo.axis;(r&&s&&(i=this.parent.getMovableRowByIndex(this.editedRowIndex),e=this.movableContent),o.length&&i&&!e.querySelector("."+ni))&&(u=i.getBoundingClientRect().top,(s||u<this.content.offsetHeight&&u>this.parent.getRowHeight())&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(i)));i&&this.content.querySelector("."+ni)&&!o.length&&(h=t.extend({},this.getRowObjectByIndex(this.editedRowIndex)),this.virtualData=this.getVirtualEditedData(h))}this.restoreAdd(n)}},i.prototype.getVirtualEditedData=function(n){var i=[].slice.call(this.parent.element.getElementsByClassName("e-gridform")),t;if(!(this.parent.editModule&&this.parent.editModule.formObj&&this.parent.editModule.formObj.isDestroyed))for(t=0;t<i.length;t++)n=this.parent.editModule.getCurrentEditedData(i[parseInt(t.toString(),10)],n);return n},i.prototype.restoreAdd=function(n){var f=this.parent.getFrozenColumns(),t=n&&this.parent.isFrozenGrid(),i=this.parent.getFrozenMode(),e=n&&n.virtualInfo&&n.virtualInfo.sentinelInfo&&"X"===n.virtualInfo.sentinelInfo.axis&&t?!(this.parent.getMovableVirtualHeader().querySelector("."+ui)||this.parent.getMovableVirtualContent().querySelector("."+ui)):!this.parent.element.querySelector("."+ui),o=n&&(f||"Left"===i||"Right"===i?n.renderMovableContent:n.renderFrozenRightContent),r,u;(!t||t&&o)&&this.isNormaledit&&this.isAdd&&e&&(r="Top"===this.parent.editSettings.newRowPosition&&this.content.scrollTop<this.parent.getRowHeight(),u="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.pageSettings.currentPage===this.maxPage,(r||u)&&(this.parent.isEdit=!1,this.parent.addRecord()))},i.prototype.onDataReady=function(n){t.isNullOrUndefined(n.count)||(this.count=n.count,this.maxPage=Math.ceil(n.count/this.parent.pageSettings.pageSize));this.vgenerator.checkAndResetCache(n.requestType);["refresh","filtering","searching","grouping","ungrouping","reorder",void 0].some(function(t){return n.requestType===t})&&this.refreshOffsets();this.setVirtualHeight();this.resetScrollPosition(n.requestType)},i.prototype.setVirtualHeight=function(){var n=this.parent.enableColumnVirtualization?this.getColumnOffset(this.parent.columns.length+this.parent.groupSettings.columns.length-1)+"px":"100%",i;if(this.parent.isFrozenGrid())i=1===this.parent.pageSettings.currentPage&&Object.keys(this.offsets).length<=2?this.offsets[1]:this.offsets[this.getTotalBlocks()-2],i=i>this.content.clientHeight?i:0,this.virtualEle.setVirtualHeight(i,n);else{var r=this.offsets[et(this.parent)&&0!==this.count?this.getGroupedTotalBlocks():this.getTotalBlocks()],u=Math.ceil(this.getTotalBlocks()/2),f=Math.round(this.virtualEle.placeholder.getBoundingClientRect().bottom),e=Math.round(this.virtualEle.wrapper.getBoundingClientRect().bottom);(this.currentInfo.page===u||this.currentInfo.page+1===u)&&"down"===this.currentInfo.direction&&f>e&&!this.diff&&(this.diff=f-e);this.diff&&this.currentInfo.page===u&&f>e?(r-=this.diff,this.heightChange=!0):this.diff&&this.heightChange&&"virtualscroll"===this.requestType&&(r-=this.diff,this.heightChange=!1);this.virtualEle.setVirtualHeight(r,n);this.virtualEle&&this.virtualEle.wrapper&&(this.virtualEle.wrapper.style.minHeight=t.isNullOrUndefined(r)?"0px":t.formatUnit(this.parent.height))}this.parent.enableColumnVirtualization&&(this.header.virtualEle.setVirtualHeight(1,n),this.parent.isFrozenGrid()&&(this.virtualEle.setMovableVirtualHeight(1,n),this.header.virtualEle.setMovableVirtualHeight(1,n)))},i.prototype.getPageFromTop=function(n,t){var i=this,u=et(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),r=0;return this.offsetKeys.some(function(f){var e=Number(f),o=n<=i.offsets[""+f]||e===u&&n>i.offsets[""+f];return o&&(i.offsetKeys.length%2!=0&&e.toString()===i.offsetKeys[i.offsetKeys.length-2]&&n<=i.offsets[i.offsetKeys.length-1]&&(e+=1),t.block=e%2==0?1:0,r=Math.max(1,Math.min(i.vgenerator.getPage(e),i.maxPage))),o}),r},i.prototype.getTranslateY=function(n,t,i,r){void 0===i&&((i={page:this.getPageFromTop(n,{})}).blockIndexes=this.vgenerator.getBlockIndexes(i.page));var f=(i.blockIndexes[0]||1)-1,e=this.getOffset(f),h=this.getOffset(i.blockIndexes[i.blockIndexes.length-1]);r&&(i=this.prevInfo);var u=e>n?this.getOffset(f-1):h<n+t?this.getOffset(f+1):e,o=this.offsets[i.blockIndexes[i.blockIndexes.length-1]]-this.tmpOffsets[i.blockIndexes[0]],s=et(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return u+o>this.offsets[parseInt(s.toString(),10)]&&(u-=u+o-this.offsets[parseInt(s.toString(),10)]),u},i.prototype.getOffset=function(n){return Math.min(0|this.offsets[parseInt(n.toString(),10)],0|this.offsets[this.maxBlock])},i.prototype.onEntered=function(){var n=this;return function(i,r,u,f,e,o){var h,v,a,y;if(!t.Browser.isIE||e||!o||n.preventEvent||n.parent.enableVirtualMaskRow||n.parent.showSpinner(),n.parent.enableVirtualMaskRow&&!n.preventEvent){var p=parseInt(n.offsetKeys[0],10),w=parseInt(n.offsetKeys[n.offsetKeys.length-1],10),c=n.currentInfo.blockIndexes;c&&c[0]===p&&"up"===u||c&&c[c.length-1]===w&&"down"===u||setTimeout(function(){n.parent.showMaskRow(r.axis)},0)}h=n.parent.enableColumnVirtualization&&n.parent.isFrozenGrid();n.prevInfo=n.prevInfo||n.vgenerator.getData();var l="X"===r.axis,b=n.prevInfo.offsets?n.prevInfo.offsets.top:null,k=n.content.getBoundingClientRect().height,s=n.getColumnOffset(l?n.vgenerator.getColumnIndexes()[0]-1:n.prevInfo.columnIndexes[0]-1);l&&!h&&(v=Object.keys(n.vgenerator.cOffsets).length-n.prevInfo.columnIndexes.length,a=n.vgenerator.cOffsets[v-1],s=s>a?a:s);y=n.getTranslateY(f.top,k,l&&b===f.top?n.prevInfo:void 0,!0);n.virtualEle.adjustTable(h?0:s,Math.min(y,n.offsets[n.maxBlock]));h&&n.virtualEle.adjustMovableTable(s,0);n.parent.enableColumnVirtualization&&(n.header.virtualEle.adjustTable(h?0:s,0),h&&n.header.virtualEle.adjustMovableTable(s,0))}},i.prototype.dataBound=function(){this.parent.notify(rtt,{});this.isSelection&&"upArrow"!==this.activeKey&&"downArrow"!==this.activeKey?this.parent.selectRow(this.selectedRowIndex):this.activeKey=this.empty},i.prototype.rowSelected=function(n,t){if((this.isSelection||t)&&!this.isLastBlockRow(n.rowIndex)){var i=hv(this.content.firstElementChild),u=this.parent.element.getBoundingClientRect().top,f=n.row.getBoundingClientRect().top-u,r=this.content.getBoundingClientRect().height,o=r<f,s=o?f-r:this.initialRowTop-f,e=o?i.height-s:i.height+s;this.virtualEle.adjustTable(i.width,e);this.content.querySelector("tbody").lastElementChild.getBoundingClientRect().top-u<r&&(e+=r-(n.row.getBoundingClientRect().top-u),this.virtualEle.adjustTable(i.width,e-this.parent.getRowHeight()/2))}this.isSelection=!1},i.prototype.isLastBlockRow=function(n){var t=this.parent.getContent().firstElementChild,i=Math.floor(t.offsetHeight/this.parent.getRowHeight())-1;return n>=this.maxPage*this.parent.pageSettings.pageSize-i},i.prototype.refreshMaxPage=function(){this.parent.groupSettings.columns.length&&this.parent.vcRows.length&&(this.maxPage=Math.ceil(this.parent.vcRows.length/this.parent.pageSettings.pageSize))},i.prototype.setVirtualPageQuery=function(n){var i=this.parent.getContent().querySelector(".e-row"),r,u;i&&this.parent.isManualRefresh&&this.currentInfo.blockIndexes&&3===this.currentInfo.blockIndexes.length&&(this.vgenerator.startIndex=parseInt(i.getAttribute("data-rowindex"),10),this.vgenerator.currentInfo=t.extend({},this.currentInfo),this.vgenerator.currentInfo.blockIndexes=this.currentInfo.blockIndexes.slice(),(this.vgenerator.includePrevPage=this.currentInfo.blockIndexes[0]%2==0)?(this.vgenerator.startIndex=this.vgenerator.startIndex-this.getBlockSize(),this.vgenerator.currentInfo.blockIndexes.unshift(this.currentInfo.blockIndexes[0]-1)):this.vgenerator.currentInfo.blockIndexes.push(this.currentInfo.blockIndexes[this.currentInfo.blockIndexes.length-1]+1),r=(this.vgenerator.currentInfo.blockIndexes[0]-1)*this.getBlockSize(),u=this.vgenerator.currentInfo.blockIndexes.length*this.getBlockSize(),n.query.skip(r),n.query.take(u),n.skipPage=!0)},i.prototype.eventListener=function(n){var t=this,r,i,u;for(this.parent[""+n](ki,this.onDataReady,this),this.parent.addEventListener(ti,this.dataBound.bind(this)),this.parent.addEventListener(nt,this.actionBegin.bind(this)),this.parent.addEventListener(l,this.actionComplete.bind(this)),this.parent.addEventListener(af,this.rowSelected.bind(this)),this.parent[""+n](es,this.refreshContentRows,this),this.parent[""+n](pa,this.refreshVirtualLazyLoadCache,this),this.parent[""+n](wp,this.selectVirtualRow,this),this.parent[""+n](dp,this.virtualCellFocus,this),this.parent[""+n](ls,this.editActionBegin,this),this.parent[""+n](ys,this.addActionBegin,this),this.parent[""+n](nw,this.restoreEdit,this),this.parent[""+n](no,this.editSuccess,this),this.parent[""+n](as,this.refreshCache,this),this.parent[""+n](vs,this.resetIsedit,this),this.parent[""+n](iu,this.getVirtualData,this),this.parent[""+n](gp,this.editCancel,this),this.parent[""+n](oa,this.refreshMaxPage,this),this.parent[""+n](ds,this.setVirtualPageQuery,this),this.parent[""+n](sa,this.selectRowOnContextOpen,this),this.parent[""+n](lw,this.resetVirtualFocus,this),this.parent[""+n](aw,this.refreshCells,this),this.parent[""+n](vw,this.scrollToEdit,this),r=this.actions,i=0;i<r.length;i++)this.parent[""+n](r[parseInt(i.toString(),10)]+"-begin",this.onActionBegin,this);u=function(){var n,i;t.observer.observe(function(n){return t.scrollListener(n)},t.onEntered());n=t.parent;n.enablePersistence&&n.scrollPosition&&(t.content.scrollTop=n.scrollPosition.top,i={direction:"down",sentinel:t.observer.sentinelInfo.down,offset:n.scrollPosition,focusElement:n.element},t.scrollListener(i),n.enableColumnVirtualization&&(t.content.scrollLeft=n.scrollPosition.left));t.parent.off(it,u)};this.parent.on(it,u,this)},i.prototype.refreshVirtualLazyLoadCache=function(n){var s,u,f,e=this.currentInfo.blockIndexes,i,o,r;for(t.isNullOrUndefined(this.currentInfo.blockIndexes)&&(e=[1,2]),i=0;i<e.length;i++)for(o=this.vgenerator.cache[e[parseInt(i.toString(),10)]],r=0;r<o.length;r++)if(o[parseInt(r.toString(),10)].uid===n.uid){s=e[parseInt(i.toString(),10)];u=r;f=o;break}n.count?this.vgenerator.cache[parseInt(s.toString(),10)].splice(u+1,n.count):n.rows&&n.rows.length&&(this.vgenerator.cache[parseInt(s.toString(),10)]=[].slice.call(f.slice(0,u+1)).concat([].slice.call(n.rows)).concat([].slice.call(f.slice(u+1,f.length))));this.refreshOffsets()},i.prototype.scrollToEdit=function(n){var o=this.parent.isFrozenGrid(),r=!0,s,u,h,f,i,e;(this.validationCheck=!0,this.isAdd&&this.content.scrollTop>0)&&(r=!1,s=Object.keys(this.offsets),this.content.scrollTop="Top"===this.parent.editSettings.newRowPosition?0:this.offsets[s.length-1]);u=this.parent.getRowByIndex(this.editedRowIndex);u||t.isNullOrUndefined(this.editedRowIndex)||u&&this.isRowInView(u)||(h=this.parent.getRowHeight(),f=this.editedRowIndex*h,t.isNullOrUndefined(f)||(r=!1,this.content.scrollTop=f));n&&r&&(i=this.vgenerator.cOffsets[n.index-this.parent.getVisibleFrozenColumns()-1],this.parent.enableColumnVirtualization||(e=this.parent.getHeaderContent().querySelector('.e-headercelldiv[e-mappinguid="'+n.uid+'"]'),i=o?e.parentElement.offsetLeft-this.parent.getFrozenVirtualHeader().offsetWidth:e.parentElement.offsetLeft),o?this.parent.getMovableVirtualContent().scrollLeft=this.parent.enableRtl?-Math.abs(i):i:this.content.scrollLeft=this.parent.enableRtl?-Math.abs(i):i);n&&!r&&(this.validationCol=n)},i.prototype.refreshCells=function(n){n.cells=this.vgenerator.generateCells(n.foreignKeyData)},i.prototype.resetVirtualFocus=function(n){this.isCancel=n.isCancel},i.prototype.getVirtualData=function(n){if(this.isNormaledit){var i=this.parent.element.querySelector('.e-griderror:not([style*="display: none"])'),t=Object.keys(this.virtualData);if(n.isScroll=0!==t.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis,i)return;this.virtualData=t.length?this.virtualData:n.virtualData;this.getVirtualEditedData(this.virtualData);n.virtualData=this.virtualData;n.isAdd=this.isAdd;n.isCancel=this.isCancel}},i.prototype.selectRowOnContextOpen=function(n){this.isContextMenuOpen=n.isOpen},i.prototype.editCancel=function(n){var i=cv(this.parent,n.data);t.isNullOrUndefined(i)||(n.data=this.parent.getCurrentViewRecords()[parseInt(i.toString(),10)])},i.prototype.editSuccess=function(n){this.isNormaledit&&(!this.isAdd&&n.data&&this.updateCurrentViewData(n.data),this.isAdd=!1)},i.prototype.updateCurrentViewData=function(n){var i=cv(this.parent,n);t.isNullOrUndefined(i)||(this.parent.getCurrentViewRecords()[parseInt(i.toString(),10)]=n)},i.prototype.actionBegin=function(n){"virtualscroll"!==n.requestType&&(this.requestType=n.requestType);n.cancel||this.parent.notify(ia,n)},i.prototype.virtualCellFocus=function(n){var i=document.activeElement,r,u;if((!i.classList.contains(a)&&i instanceof HTMLInputElement&&(i=i.closest(".e-rowcell")),i&&i.classList.contains(a)&&n&&("upArrow"===n.action||"downArrow"===n.action))&&(r=parseInt(i.parentElement.getAttribute(h),10),n&&("downArrow"===n.action||"upArrow"===n.action))){u=this.parent.getContent().firstElementChild;"downArrow"===n.action?r+=1:r-=1;this.rowIndex=r;this.cellIndex=parseInt(i.getAttribute(lt),10);var f=this.parent.getRowByIndex(r),o=this.parent.pageSettings.currentPage,s=Math.floor(u.offsetHeight/this.parent.getRowHeight())-1,e=!1;t.isNullOrUndefined(f)&&(e=!0,("downArrow"===n.action&&o===this.maxPage-1||"upArrow"===n.action&&1===o)&&(e=!1));e||vrt(f,this.parent)&&"downArrow"===n.action||yrt(f,2*this.parent.getRowHeight())&&"upArrow"===n.action?(this.activeKey=n.action,u.scrollTop="downArrow"===n.action?(r-s)*this.parent.getRowHeight():r*this.parent.getRowHeight()):this.activeKey=this.empty;this.parent.selectionSettings.checkboxOnly||this.parent.selectRow(r)}},i.prototype.editActionBegin=function(n){this.editedRowIndex=n.index;var r=t.extend({},this.getRowObjectByIndex(n.index)),i=Object.keys(this.virtualData);n.data=i.length?this.virtualData:r;n.isScroll=0!==i.length&&this.currentInfo.sentinelInfo&&"X"===this.currentInfo.sentinelInfo.axis},i.prototype.getEditedRowObject=function(){for(var i,t=this.parent.vcRows,n=0;n<t.length;n++)t[parseInt(n.toString(),10)].index===this.editedRowIndex&&(i=t[parseInt(n.toString(),10)]);return i},i.prototype.refreshCache=function(n){var t=Math.ceil((this.editedRowIndex+1)/this.getBlockSize()),i=this.editedRowIndex-(t-1)*this.getBlockSize();this.parent.groupSettings.columns.length?this.getEditedRowObject().data=n.data:(this.vgenerator.cache[parseInt(t.toString(),10)][parseInt(i.toString(),10)].data=n.data,this.vgenerator.movableCache[parseInt(t.toString(),10)]&&(this.vgenerator.movableCache[parseInt(t.toString(),10)][parseInt(i.toString(),10)].data=n.data),this.vgenerator.frozenRightCache[parseInt(t.toString(),10)]&&(this.vgenerator.frozenRightCache[parseInt(t.toString(),10)][parseInt(i.toString(),10)].data=n.data))},i.prototype.actionComplete=function(n){if(this.parent.enableVirtualization){var t=["delete","save","cancel"];t.some(function(t){return t===n.requestType})&&(this.refreshOffsets(),this.parent.isFrozenGrid()?(this.vgenerator.refreshColOffsets(),this.parent.contentModule.virtualRenderer.virtualEle.setVirtualHeight()):this.refreshVirtualElement());this.isNormaledit&&(["sorting","filtering","grouping","refresh","searching","ungrouping","reorder"].some(function(t){return t===n.requestType})||t.some(function(t){return t===n.requestType}))&&(this.isCancel=!0,this.isAdd=!1,this.editedRowIndex=this.empty,this.virtualData={},this.parent.editModule&&(this.parent.editModule.editModule.previousData=void 0));this.parent.enableColumnVirtualization&&"filterafteropen"===n.requestType&&this.currentInfo.columnIndexes&&this.currentInfo.columnIndexes[0]>0&&this.parent.resetFilterDlgPosition(n.columnName)}},i.prototype.resetIsedit=function(){this.parent.enableVirtualization&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&Object.keys(this.virtualData).length||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},i.prototype.scrollAfterEdit=function(){var n,i,r,u;this.parent.editModule&&this.parent.editSettings.allowEditing&&this.isNormaledit&&this.parent.element.querySelector(".e-gridform")&&(n=this.parent.element.querySelector("."+ni),i=this.parent.element.querySelector("."+ui),(n||i)&&(r=n?t.extend({},this.getRowObjectByIndex(this.editedRowIndex)):t.extend({},this.emptyRowData),u=Object.keys(this.virtualData),this.virtualData=u.length?this.getVirtualEditedData(this.virtualData):this.getVirtualEditedData(r)))},i.prototype.createEmptyRowdata=function(){var n=this;this.parent.columnModel.filter(function(t){n.emptyRowData[t.field]=n.empty})},i.prototype.addActionBegin=function(n){if(this.isNormaledit){Object.keys(this.emptyRowData).length||this.createEmptyRowdata();this.isAdd=!0;var t=this.parent.pageSettings.currentPage;!this.parent.frozenRows&&this.content.scrollTop>0&&"Top"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.onActionBegin(),n.startEdit=!1,this.content.scrollTop=0);t<this.maxPage-1&&"Bottom"===this.parent.editSettings.newRowPosition&&(this.isAdd=!0,this.parent.setProperties({pageSettings:{currentPage:this.maxPage-1}},!0),n.startEdit=!1,this.content.scrollTop=this.offsets[this.offsetKeys.length])}},i.prototype.getRowObjectByIndex=function(n){return this.getRowCollection(n,!1,!0)},i.prototype.getBlockSize=function(){return this.parent.pageSettings.pageSize>>1},i.prototype.getBlockHeight=function(){return this.getBlockSize()*this.parent.getRowHeight()},i.prototype.isEndBlock=function(n){var t=et(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks();return n>=t||n===t-1},i.prototype.getGroupedTotalBlocks=function(){var n=this.parent.vcRows;return Math.floor(n.length/this.getBlockSize()<1?1:n.length/this.getBlockSize())},i.prototype.getTotalBlocks=function(){return Math.ceil(this.count/this.getBlockSize())},i.prototype.getColumnOffset=function(n){return 0|this.vgenerator.cOffsets[parseInt(n.toString(),10)]},i.prototype.getModelGenerator=function(){return new tk(this.parent)},i.prototype.resetScrollPosition=function(n){this.actions.some(function(t){return t===n})&&(this.preventEvent=0!==this.content.scrollTop,this.content.scrollTop=0);"virtualscroll"!==n&&(this.isAdd=!1)},i.prototype.onActionBegin=function(){this.parent.setProperties({pageSettings:{currentPage:1}},!0)},i.prototype.getRows=function(){return this.vgenerator.getRows()},i.prototype.getRowByIndex=function(n){var i;return et(this.parent)?i=t.isNullOrUndefined(n)?void 0:this.parent.getDataRows()[parseInt(n.toString(),10)]:this.prevInfo&&(i=this.getRowCollection(n,!1)),i},i.prototype.getMovableVirtualRowByIndex=function(n){return this.getRowCollection(n,!0)},i.prototype.getFrozenRightVirtualRowByIndex=function(n){return this.getRowCollection(n,!1,!1,!0)},i.prototype.getRowCollection=function(n,i,r,u){var e=(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize(),f,o,s;return this.parent.pageSettings.pageSize%2!=0&&(e+=Math.floor(e/this.getBlockSize()/2)),f=i?this.parent.getMovableDataRows():this.parent.getDataRows(),f=u?this.parent.getFrozenRightDataRows():f,o=r?this.parent.getCurrentViewRecords():f,r&&this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(e=parseInt(this.parent.getRows()[0].getAttribute(h),10),o=o.filter(function(n){return t.isNullOrUndefined(n.items)})),s=o[n-e],this.parent.frozenRows&&this.parent.pageSettings.currentPage>1&&(s=r?n<=this.parent.frozenRows?this.parent.getRowsObject()[parseInt(n.toString(),10)].data:s:n<=this.parent.frozenRows?f[parseInt(n.toString(),10)]:f[n-e+this.parent.frozenRows]),s},i.prototype.getVirtualRowIndex=function(n){return(this.prevInfo.blockIndexes[0]-1)*this.getBlockSize()+n},i.prototype.refreshOffsets=function(){var f=this.parent,e=0,r=this.getBlockSize(),i=et(this.parent)?this.getGroupedTotalBlocks():this.getTotalBlocks(),t,n;for(this.prevHeight=this.offsets[parseInt(i.toString(),10)],this.maxBlock=i%2==0?i-2:i-1,this.offsets={},t=Array.apply(null,Array(i)).map(function(){return++e}),n=0;n<t.length;n++){var o=(this.vgenerator.cache[t[parseInt(n.toString(),10)]]||[]).length,u=et(this.parent)?f.vcRows.length%r:this.count%r,s=!et(this.parent)&&t[parseInt(n.toString(),10)]in this.vgenerator.cache?o*this.parent.getRowHeight():u&&t[parseInt(n.toString(),10)]===i?u*this.parent.getRowHeight():this.getBlockHeight();this.offsets[t[parseInt(n.toString(),10)]]=(0|this.offsets[t[parseInt(n.toString(),10)]-1])+s;this.tmpOffsets[t[parseInt(n.toString(),10)]]=0|this.offsets[t[parseInt(n.toString(),10)]-1]}this.offsetKeys=Object.keys(this.offsets);et(this.parent)&&(this.parent.vGroupOffsets=this.offsets);this.parent.enableColumnVirtualization&&this.vgenerator.refreshColOffsets()},i.prototype.refreshVirtualElement=function(){this.vgenerator.refreshColOffsets();this.setVirtualHeight()},i.prototype.setVisible=function(n){var l,a,e=this.parent,o=this.parent.getFrozenColumns(),s,u,f,c;o&&(l=[].slice.call(this.parent.getFrozenVirtualContent().querySelectorAll("col")),a=[].slice.call(this.parent.getMovableVirtualContent().querySelectorAll("col")));u=[];(u=this.getRows()).some(function(n){return n.isDataRow&&(s=n),n.isDataRow});f=!0;!e.groupSettings.columns.length&&s&&(f=!1);for(var y=e.getDataRows(),v=0,w=n.length;v<w;v++){var i=n[parseInt(v.toString(),10)],r=e.getNormalizedColumnIndex(i.uid),p=!0===i.visible?"":"none",h=void 0;(l&&a?r>=o?(h=a,y=this.parent.getMovableRows(),r-=o):h=l:h=this.getColGroup().children,-1!==r&&s&&r<s.cells.length&&t.setStyleAttribute(h[parseInt(r.toString(),10)],{display:p}),f)||(c=void 0,i.width&&(c=i.visible?this.virtualEle.wrapper.offsetWidth+parseInt(i.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(i.width.toString(),10)),c>e.width?(this.setDisplayNone(y,r,p,u),this.parent.enableColumnVirtualization&&this.virtualEle.setWrapperWidth(c+""),this.refreshVirtualElement()):f=!0);!this.parent.invokedFromMedia&&i.hideAtMedia&&this.parent.updateMediaColumns(i);this.parent.invokedFromMedia=!1}f||o?this.refreshContentRows({requestType:"refresh"}):this.parent.notify(de,{rows:u,args:{isFrozen:!1,rows:u}})},i.prototype.selectVirtualRow=function(n){var e=this,r,u,i,f;(n.isAvailable=n.selectedIndex<this.count,!n.isAvailable||this.isContextMenuOpen||"upArrow"===this.activeKey||"downArrow"===this.activeKey||this.isSelection||this.requestTypes.some(function(n){return n===e.requestType})||this.parent.selectionModule.isInteracted)||(r=this.parent.getRowByIndex(n.selectedIndex),u=this.parent.getRowHeight(),r&&this.isRowInView(r)||(this.isSelection=!0,this.selectedRowIndex=n.selectedIndex,i=(n.selectedIndex+1)*u,t.isNullOrUndefined(i)||(f=this.content.scrollTop<i?"down":"up",this.selectRowIndex=n.selectedIndex,this.content.scrollTop=i,this.isSelectionScroll=this.observer.check(f))));this.parent.isFrozenGrid()&&this.requestType?this.parent.getTablesCount()===this.frzIdx?(this.requestType=this.empty,this.frzIdx=1):this.frzIdx++:this.requestType=this.empty},i.prototype.isRowInView=function(n){var t=n.getBoundingClientRect().top,i=n.getBoundingClientRect().bottom;return t>=this.content.getBoundingClientRect().top&&i<=this.content.getBoundingClientRect().bottom},i}(fo),ik=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.virtualEle=new rk,r.isMovable=!1,r.gen=new tk(r.parent),r.parent.on(di,r.setVisible,r),r.parent.on(es,function(n){return"X"===n.virtualInfo.sentinelInfo.axis?r.refreshUI():null},r),r}return but(i,n),i.prototype.renderTable=function(){this.gen.refreshColOffsets();this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+st)));n.prototype.renderTable.call(this);this.virtualEle.table=this.getTable();this.virtualEle.content=this.getPanel().querySelector("."+st);this.virtualEle.content.style.position="relative";this.virtualEle.renderWrapper();this.virtualEle.renderPlaceHolder("absolute")},i.prototype.appendContent=function(n){this.isMovable?(this.virtualEle.movableWrapper.appendChild(n),this.isMovable=!1):this.virtualEle.wrapper.appendChild(n)},i.prototype.refreshUI=function(){this.isMovable=this.parent.isFrozenGrid();this.setFrozenTable(this.parent.getMovableVirtualContent());this.gen.refreshColOffsets();this.parent.setColumnIndexesInView(this.gen.getColumnIndexes(this.getPanel().querySelector("."+st)));n.prototype.refreshUI.call(this);this.setFrozenTable(this.parent.getFrozenVirtualContent())},i.prototype.setVisible=function(n){var s,f,h,c,l,e=this.parent,r=this.parent.getFrozenColumns(),o,a,i,u,v;for(r&&(c=[].slice.call(this.parent.getFrozenVirtualHeader().querySelectorAll("col")),l=[].slice.call(this.parent.getMovableVirtualHeader().querySelectorAll("col"))),o=0,a=n.length;o<a;o++)i=n[parseInt(o.toString(),10)],f=e.getNormalizedColumnIndex(i.uid),s=i.visible?"":"none",u=void 0,(c&&l?f>=r?(u=l,f-=r):u=c:u=this.getColGroup().children,t.setStyleAttribute(u[parseInt(f.toString(),10)],{display:s}),e.enableColumnVirtualization&&!e.groupSettings.columns.length)?(v=i.visible?this.virtualEle.wrapper.offsetWidth+parseInt(i.width.toString(),10):this.virtualEle.wrapper.offsetWidth-parseInt(i.width.toString(),10))>e.width?(this.setDisplayNone(i,s),this.virtualEle.setWrapperWidth(v+""),this.gen.refreshColOffsets()):h=!0:h=!0,h&&!r&&this.refreshUI();r&&this.parent.notify(wf,{})},i.prototype.setFrozenTable=function(n){this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&this.parent.contentModule.isXaxis()&&this.parent.contentModule.setTable(n.querySelector("."+k+":not(.e-masked-table)"))},i.prototype.setDisplayNone=function(n,i){var o=this.parent.isFrozenGrid(),e=this.getTable(),u,f,r;for(o&&"movable"===n.getFreezeTableName()&&(e=this.parent.getMovableVirtualHeader().querySelector("."+k)),u=0,f=[].slice.apply(e.querySelectorAll("th.e-headercell"));u<f.length;u++)if(r=f[u],r.querySelector("[e-mappinguid]")&&r.querySelector("[e-mappinguid]").getAttribute("e-mappinguid")===n.uid){t.setStyleAttribute(r,{display:i});""===i&&t.removeClass([r],"e-hide");break}},i}(ka),rk=function(){function n(){}return n.prototype.renderWrapper=function(n){this.wrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(n)});this.wrapper.appendChild(this.table);this.content.appendChild(this.wrapper)},n.prototype.renderPlaceHolder=function(n){void 0===n&&(n="relative");this.placeholder=t.createElement("div",{className:"e-virtualtrack",styles:"position:"+n});this.content.appendChild(this.placeholder)},n.prototype.renderFrozenWrapper=function(n){this.wrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(n)+"; display: flex"});this.content.appendChild(this.wrapper)},n.prototype.renderFrozenPlaceHolder=function(){this.placeholder=t.createElement("div",{className:"e-virtualtrack"});this.content.appendChild(this.placeholder)},n.prototype.renderMovableWrapper=function(n){this.movableWrapper=t.createElement("div",{className:"e-virtualtable",styles:"min-height:"+t.formatUnit(n)});this.movableContent.appendChild(this.movableWrapper)},n.prototype.renderMovablePlaceHolder=function(){this.movablePlaceholder=t.createElement("div",{className:"e-virtualtrack"});this.movableContent.appendChild(this.movablePlaceholder)},n.prototype.adjustTable=function(n,t){this.wrapper.style.transform="translate("+n+"px, "+t+"px)"},n.prototype.adjustMovableTable=function(n,t){this.movableWrapper.style.transform="translate("+n+"px, "+t+"px)"},n.prototype.setMovableWrapperWidth=function(n,t){this.movableWrapper.style.width=n?n+"px":t?"100%":""},n.prototype.setMovableVirtualHeight=function(n,t){this.movablePlaceholder.style.height=n+"px";this.movablePlaceholder.style.width=t},n.prototype.setWrapperWidth=function(n,t){this.wrapper.style.width=n?n+"px":t?"100%":""},n.prototype.setVirtualHeight=function(n,i){this.placeholder.style.height=t.isNullOrUndefined(n)?"0px":n+"px";this.placeholder.style.width=i},n.prototype.setFreezeWrapperWidth=function(n,t,i){n.style.width=t?t+"px":i?"100%":""},n}(),ght=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"virtualscroll"},n.prototype.instantiateRenderer=function(){this.parent.log(["limitation","virtual_height"],"virtualization");var n=this.locator.getService("rendererFactory");this.parent.isFrozenGrid()||(this.parent.enableColumnVirtualization&&n.addRenderer(at.Header,new ik(this.parent,this.locator)),n.addRenderer(at.Content,new ny(this.parent,this.locator)));this.ensurePageSize()},n.prototype.ensurePageSize=function(){var i=this.parent.getRowHeight(),r=this.parent.height.toString().indexOf("%")<0?this.parent.height:this.parent.element.getBoundingClientRect().height,n,t;this.blockSize=~~(r/i);n=2*this.blockSize;t=this.parent.pageSettings.pageSize;this.parent.setProperties({pageSettings:{pageSize:t<n?n:t}},!0)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(cr,this.instantiateRenderer,this),this.parent.on(ae,this.refreshVirtualElement,this),this.parent.on(gs,this.createVirtualValidationForm,this),this.parent.on(ha,this.virtualEditFormValidation,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cr,this.instantiateRenderer),this.parent.off(ae,this.refreshVirtualElement),this.parent.off(gs,this.createVirtualValidationForm),this.parent.off(ha,this.virtualEditFormValidation),this.parent.off(v,this.destroy))},n.prototype.getCurrentEditedData=function(n){var i={virtualData:t.extend({},{},n,!0),isAdd:!1,isScroll:!1,endEdit:!0};return this.parent.notify(iu,i),i.virtualData},n.prototype.createVirtualValidationForm=function(n){var i=this.parent,u,e,f;if(i.enableVirtualization&&"Normal"===i.editSettings.mode){var r=i.columns,s=new oi(this.locator,null,this.parent),o=t.extend({},{},i.getRowObjectFromUID(n.uid),!0);for(i.notify(aw,o),u=n.argsCreator(this.getCurrentEditedData(n.prevData),{},!1),u.isCustomFormValidation=!0,u.row=s.render(o,r),n.renderer.update(u),e={},f=0;f<r.length;f++)r[parseInt(f.toString(),10)].visible&&r[parseInt(f.toString(),10)].validationRules&&ab(r[parseInt(f.toString(),10)],0,e,{},{},r.length,!0);u.form.classList.add("e-virtual-validation");i.editModule.virtualFormObj=i.editModule.createFormObj(u.form,e)}},n.prototype.virtualEditFormValidation=function(n){var i=this.parent,r=i.element.querySelector('.e-griderror:not([style*="display: none"])'),f,o,e;if(i.editModule.virtualFormObj)if(r&&"none"!==r.style.display){var s=r.getBoundingClientRect(),u=i.element.querySelectorAll(".e-gridform"),h=u[0],c=i.getContent().getBoundingClientRect().left;(u.length>1&&(h="Right"!==i.getFrozenMode()?u[1]:u[0],c=i.getMovableVirtualContent().getBoundingClientRect().left),s.left<c||s.right>i.element.offsetWidth)&&(f=h.querySelector('.e-tooltip-wrap:not([style*="display: none"])'),this.scrollToEdit(f,{editIdx:n.editIdx,addIdx:n.addIdx},!0))}else if(i.editModule.virtualFormObj&&(!r||"none"===r.style.display)){for(o=i.editModule.virtualFormObj.element.querySelectorAll('.e-tooltip-wrap:not([style*="display: none"])'),e=0;e<o.length;e++)t.remove(o[parseInt(e.toString(),10)]);this.setEditedDataToValidationForm(i.editModule.virtualFormObj.element,this.getCurrentEditedData(n.prevData));n.isValid=i.editModule.virtualFormObj.validate();n.isValid||(f=i.editModule.virtualFormObj.element.querySelector('.e-tooltip-wrap:not([style*="display: none"])'),this.scrollToEdit(f,{editIdx:n.editIdx,addIdx:n.addIdx}))}},n.prototype.scrollToEdit=function(n,i,r){var e=this.parent,f,u;if(n){var o=e.columnModel,h=ah(n.id).split("_")[0],s=e.getColumnByField(h),c=this.parent.getContent().firstElementChild.scrollTop,l=e.getRowByIndex(i.editIdx);if(r||!s||!t.isNullOrUndefined(i.addIdx)&&c>0||!t.isNullOrUndefined(i.editIdx)&&!l){for(f=void 0,u=0;u<o.length&&!s;u++)if(o[parseInt(u.toString(),10)].field===h){f=o[parseInt(u.toString(),10)];break}r&&(f=s);this.parent.notify(vw,f)}}},n.prototype.setEditedDataToValidationForm=function(n,i){for(var e,r,f=[].slice.call(n.getElementsByClassName("e-field")),u=0,o=f.length;u<o;u++)e=iut(this.parent,f[parseInt(u.toString(),10)].getAttribute("e-mappinguid")),r=t.getValue(e.field,i),r=t.isNullOrUndefined(r)?"":r,f[parseInt(u.toString(),10)].value=r},n.prototype.refreshVirtualElement=function(n){this.parent.enableColumnVirtualization&&"resize"===n.module&&this.locator.getService("rendererFactory").getRenderer(at.Content).refreshVirtualElement()},n.prototype.destroy=function(){this.removeEventListener()},n}(),uk=function(){function n(n){this.parent=n}return n.prototype.addNew=function(n,t){var i,l,a,v,f,o,y;this.isEdit=!1;var h=grt(this.parent),r=nut(this.parent),c=this.parent.isFrozenGrid(),u=c&&this.parent.enableColumnVirtualization&&t.isScroll;(i=this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition?u?this.parent.getMovableHeaderTbody():this.parent.getHeaderTable().querySelector(e):u?this.parent.getMovableContentTbody():this.parent.getContentTable().querySelector(e),t.row=this.parent.createElement("tr",{className:"e-row e-addedrow"}),i.querySelector(".e-emptyrow"))&&(l=i.querySelector(".e-emptyrow"),(l.parentNode.removeChild(l),c&&!u)&&(a=this.parent.getContent().querySelector("."+p).querySelector(e),(a.firstElementChild.parentNode.removeChild(a.firstElementChild),this.parent.getFrozenMode()===s)&&(v=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(e),v.firstElementChild.parentNode.removeChild(v.firstElementChild))));("Top"===this.parent.editSettings.newRowPosition?i.insertBefore(t.row,i.firstChild):i.appendChild(t.row),t.row.appendChild(this.getEditElement(n,!1,void 0,t,!0)),this.parent.editModule.checkLastRow(t.row,t),c&&!u)&&(f=this.renderMovableform(t.row,t),("Top"===this.parent.editSettings.newRowPosition?h.insertBefore(f,h.firstChild):h.appendChild(f),t.row.querySelector(".e-normaledit").setAttribute("colspan",this.parent.getVisibleFrozenColumns()+""),f.querySelector(".e-normaledit").setAttribute("colspan",""+(this.parent.getVisibleColumns().length-this.parent.getVisibleFrozenColumns())),r)&&(o=this.renderFrozenRightForm(t.row,t),"Top"===this.parent.editSettings.newRowPosition?r.insertBefore(o,r.firstChild):r.appendChild(o),y=this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount(),t.row.querySelector(".e-normaledit").setAttribute("colspan",y+""),o.querySelector(".e-normaledit").setAttribute("colspan",""+this.parent.getFrozenRightColumnsCount())),"auto"===this.parent.height&&this.parent.notify(ke,{}))},n.prototype.renderFrozenRightForm=function(n,t){var i=n.cloneNode(!0),r=t.frozenRightForm=i.querySelector("form");return this.parent.editSettings.template?(r.innerHTML="",this.appendChildren(r,t.rowData,!1),i):(this.renderRightFrozen(n,i),i.querySelector(c).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c).innerHTML,i)},n.prototype.renderMovableform=function(n,t){var i=n.cloneNode(!0),r=t.movableForm=i.querySelector("form");return this.parent.editSettings.template?(r.innerHTML="",this.appendChildren(r,t.rowData,!1),i):(this.renderMovable(n,i),i.querySelector(c).innerHTML=this.parent.getHeaderContent().querySelector("."+w).querySelector(c).innerHTML,i)},n.prototype.updateFreezeEdit=function(n,t){return t=t.concat([].slice.call(this.getFreezeRow(n).querySelectorAll("td.e-rowcell"))),this.parent.getFrozenMode()===s&&(t=t.concat([].slice.call(this.getFreezeRightRow(n).querySelectorAll("td.e-rowcell")))),t},n.prototype.getFreezeRightRow=function(n){var t=parseInt(n.getAttribute(h),10),i=this.parent.getFrozenLeftContentTbody(),r=this.parent.getFrozenHeaderTbody(),u=this.parent.getFrozenRightHeaderTbody(),f=this.parent.getFrozenRightContentTbody();return i.contains(n)||r.contains(n)?this.parent.getFrozenRightRowByIndex(t):f.contains(n)||u.contains(n)?this.parent.getRowByIndex(t):n},n.prototype.getFreezeRow=function(n){if(this.parent.isFrozenGrid()){var t=parseInt(n.getAttribute(h),10),i=this.parent.getFrozenLeftContentTbody(),r=this.parent.getMovableContentTbody(),u=this.parent.getFrozenHeaderTbody(),f=this.parent.getMovableHeaderTbody();if(i.contains(n)||u.contains(n))return this.parent.getMovableRowByIndex(t);if(r.contains(n)||f.contains(n))return this.parent.getRowByIndex(t)}return n},n.prototype.update=function(n,i){var u,f,e,r;this.isEdit=!0;u=i.isCustomFormValidation;f=i.isScroll;!f&&(t.closest(i.row,"."+p)||t.closest(i.row,"."+w))&&(i.row=this.getFreezeRow(i.row));(t.closest(i.row,".e-frozen-right-content")||t.closest(i.row,".e-frozen-right-header"))&&(i.row=this.getFreezeRightRow(i.row));e=this.parent.isFrozenGrid()&&this.parent.enableColumnVirtualization&&f;r=[].slice.call(i.row.querySelectorAll("td.e-rowcell"));i.row.innerHTML="";e||u||(r=this.updateFreezeEdit(i.row,r));i.row.appendChild(this.getEditElement(n,!0,r,i,!0));i.row.classList.add(ni);this.parent.editModule.checkLastRow(i.row,i);e||u||this.refreshFreezeEdit(i.row,i)},n.prototype.refreshFreezeEdit=function(n,t){var l,a,i=n.firstChild,f,r,u;if(this.parent.getVisibleFrozenColumns()&&this.parent.editSettings.template&&(i.querySelector(c).innerHTML=this.parent.getHeaderContent().querySelector("."+fr).querySelector(c).innerHTML),f=parseInt(n.getAttribute(h),10),this.parent.isFrozenGrid()){f<this.parent.frozenRows?(a=this.parent.getHeaderContent(),l="."+fr):(a=this.parent.getContent(),l="."+wi);var o=i.cloneNode(!0),e=i.cloneNode(!0),v=t.movableForm=o.querySelector("form");this.parent.editSettings.template&&this.refreshEditForm(v,t.rowData);r=void 0;u=void 0;a.querySelector(l).contains(n)?(r=this.parent.getMovableRowByIndex(f),this.updateFrozenCont(r,i,o),this.parent.getFrozenMode()===s&&(t.frozenRightForm=e.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),u=this.parent.getFrozenRightRowByIndex(f),this.updateFrozenRightCont(u,i,e))):(r=this.parent.getRowByIndex(f),this.updateFrozenCont(r,o,i),this.parent.getFrozenMode()===s&&(t.frozenRightForm=e.querySelector("form"),this.refreshEditForm(t.frozenRightForm,t.rowData),u=this.parent.getFrozenRightRowByIndex(f),this.updateFrozenRightCont(u,e,i)));r.appendChild(o);r.classList.add(ni);this.parent.getFrozenMode()===s&&(u.appendChild(e),u.classList.add(ni),dh(t.frozenRightForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)")));dh(t.movableForm.querySelector("td:not(.e-hide)"),t.form.querySelector("td:not(.e-hide)"))}},n.prototype.refreshEditForm=function(n,t){this.parent.editSettings.template&&(n.innerHTML="",this.appendChildren(n,t,!1))},n.prototype.updateFrozenRightCont=function(n,t,i){n.innerHTML="";this.renderRightFrozen(t,i);i.querySelector(c).innerHTML=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c).innerHTML;t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()-this.parent.getFrozenRightColumnsCount()+"");i.setAttribute("colspan",this.parent.getFrozenRightColumnsCount()+"")},n.prototype.updateFrozenCont=function(n,t,i){n.innerHTML="";this.renderMovable(t,i);i.querySelector(c).innerHTML=this.parent.getHeaderContent().querySelector("."+w).querySelector(c).innerHTML;t.setAttribute("colspan",this.parent.getVisibleFrozenColumns()+"");i.setAttribute("colspan",this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-this.parent.getVisibleFrozenColumns()+"")},n.prototype.renderRightFrozen=function(n,t){var f;t.querySelector("tr").innerHTML="";for(var u=this.parent.getColumns(),i=0,r=0;r<u.length;r++,i++)u[parseInt(r.toString(),10)].getFreezeTableName()===d&&(f=i-this.parent.getMovableColumnsCount(),t.querySelector("tr").appendChild(n.querySelector("tr").removeChild(n.querySelector("tr").children[parseInt(f.toString(),10)])),i--)},n.prototype.renderMovable=function(n,t){t.querySelector("tr").innerHTML="";for(var u=this.parent.getColumns(),i=this.parent.isRowDragable()?1:0,r=0;r<u.length;r++,i++)"movable"===u[parseInt(r.toString(),10)].getFreezeTableName()&&(t.querySelector("tr").appendChild(n.querySelector("tr").removeChild(n.querySelector("tr").children[parseInt(i.toString(),10)])),i--)},n.prototype.getEditElement=function(n,i,r,u,f){var s=this.parent,g=0,it=t.isNullOrUndefined(s.detailTemplate)&&t.isNullOrUndefined(s.childGrid)?0:1,y,p,w,b,tt,k,d,o,l;if(s.allowGrouping&&(g=s.groupSettings.columns.length),y=this.parent.createElement("td",{className:"e-editcell e-normaledit",attrs:{colspan:(s.getCurrentVisibleColumns(this.parent.enableColumnVirtualization).length-s.getVisibleFrozenColumns()+this.parent.getIndentCount()).toString()}}),p=u.form=this.parent.createElement("form",{id:s.element.id+"EditForm",className:"e-gridform"}),this.parent.editSettings.template)return this.appendChildren(p,u.rowData,f),y.appendChild(p),y;w=this.parent.createElement("table",{className:"e-table e-inline-edit",attrs:{cellspacing:"0.25",role:"grid"}});w.appendChild(s.getContentTable().querySelector(c).cloneNode(!0));var nt=this.parent.createElement(e,{attrs:{role:"rowgroup"}}),v=this.parent.createElement("tr"),h=0;for(it&&v.insertBefore(this.parent.createElement("td",{className:"e-detailrowcollapse"}),v.firstChild),s.isRowDragable()&&v.appendChild(this.parent.createElement("td",{className:"e-dragindentcell"}));h<g;)v.appendChild(this.parent.createElement("td",{className:"e-indentcell"})),h++;for(b=0,h=0,tt=s.isFrozenGrid()&&s.enableColumnVirtualization&&u.isScroll,k=u.isCustomFormValidation?this.parent.columnModel:s.getColumns();i&&b<r.length&&h<k.length||h<k.length;)d=i?r[parseInt(b.toString(),10)].getAttribute("colspan"):null,o=k[parseInt(h.toString(),10)],tt&&"movable"!==o.getFreezeTableName()||u.isCustomFormValidation&&(o.commands||o.commandsTemplate||!o.field)?h++:(l=this.parent.createElement("td",{className:a,attrs:{style:"text-align:"+(o.textAlign?o.textAlign:""),colspan:d||""}}),o.visible?(l.appendChild(n[o.uid]),"Vertical"===this.parent.rowRenderingMode&&(vr(l,{"data-cell":o.headerText}),0===h&&l.classList.add("e-responsive-editcell")),"booleanedit"===o.editType?l.classList.add("e-boolcell"):(o.commands||o.commandsTemplate)&&t.addClass([l],"e-unboundcell")):l.classList.add("e-hide"),v.appendChild(l),h=d?h+parseInt(d,10):h+1,b++);return nt.appendChild(v),w.appendChild(nt),p.appendChild(w),y.appendChild(p),y},n.prototype.removeEventListener=function(){},n.prototype.appendChildren=function(n,i,r){var u=t.extend({},i,{isAdd:!this.isEdit,isFrozen:r},!0),f=this.parent.element.id+"editSettingsTemplate";this.parent.isReact&&"string"!=typeof this.parent.editSettings.template?(this.parent.getEditTemplate()(u,this.parent,"editSettingsTemplate",f,null,null,n),this.parent.renderTemplates()):kt(n,this.parent.getEditTemplate()(u,this.parent,"editSettingsTemplate",f))},n}(),kut=function(){function n(n){this.parent=n}return n.prototype.update=function(n,i){if(this.parent.isReact&&i.columnObject&&i.columnObject.template){var u=i.cell.parentElement,r=i.cell.cloneNode(!0);u.insertBefore(r,i.cell);r.focus();i.cell.remove();i.cell=r}i.cell.innerHTML="";i.cell.appendChild(this.getEditElement(n,i));i.cell.classList.add("e-editedbatchcell");t.classList(i.row,[ni,"e-batchrow"],[])},n.prototype.getEditElement=function(n,t){var r=this.parent,i=this.parent.createElement("form",{id:r.element.id+"EditForm",className:"e-gridform"});return i.appendChild(n[t.columnObject.uid]),"booleanedit"===t.columnObject.editType&&t.cell.classList.add("e-boolcell"),t.columnObject.editType||t.cell.classList.add("e-inputbox"),i},n.prototype.removeEventListener=function(){},n}(),dut=function(){function n(n,t){this.parent=n;this.serviceLocator=t;this.parent.isDestroyed||(this.parent.on(os,this.destroy,this),this.parent.on(v,this.destroy,this))}return n.prototype.setLocaleObj=function(){this.l10n=this.serviceLocator.getService("localization")},n.prototype.addNew=function(n,t){this.isEdit=!1;this.createDialog(n,t)},n.prototype.update=function(n,t){this.isEdit=!0;this.createDialog(n,t)},n.prototype.createDialogHeader=function(n){var r=this,u=this.parent,i;return this.parent.enableAdaptiveUI?(i=new kw(this.parent,this.serviceLocator),i.action=this.isEdit?g.isEdit:g.isAdd,i.renderResponsiveHeader(void 0,n)):u.editSettings.headerTemplate?t.initializeCSPTemplate(function(){return r.getDialogEditTemplateElement("HeaderTemplate",n).outerHTML}):this.isEdit?this.l10n.getConstant("EditFormTitle")+n.primaryKeyValue[0]:this.l10n.getConstant("AddFormTitle")},n.prototype.createDialog=function(n,i){var u=this,r=this.parent;this.dialog=this.parent.createElement("div",{id:r.element.id+"_dialogEdit_wrapper",styles:"width: auto"});r.enableAdaptiveUI&&this.dialog.classList.add("e-responsive-dialog");r.element.appendChild(this.dialog);this.setLocaleObj();this.dialog.setAttribute("aria-label",this.l10n.getConstant("DialogEdit"));this.dialogObj=new bt.Dialog(t.extend({header:this.createDialogHeader(i),isModal:!0,visible:!0,cssClass:this.parent.cssClass?"e-edit-dialog "+this.parent.cssClass:"e-edit-dialog",content:this.getEditElement(n,i),showCloseIcon:!0,allowDragging:!0,close:this.dialogClose.bind(this),created:this.dialogCreated.bind(this),closeOnEscape:!0,width:r.editSettings.template?"auto":"330px",target:i.target?i.target:document.body,animationSettings:{effect:"None"},footerTemplate:r.editSettings.footerTemplate?t.initializeCSPTemplate(function(){return u.getDialogEditTemplateElement("FooterTemplate",i).outerHTML}):null,buttons:[{click:this.btnClick.bind(this),buttonModel:{content:this.l10n.getConstant("SaveButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.btnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}]},r.editSettings.dialog&&r.editSettings.dialog.params||{}));i.dialog=this.dialogObj;this.dialogObj.isStringTemplate=!0;this.renderResponsiveDialog();this.dialogObj.appendTo(this.dialog);ao(this.parent.element,this.dialogObj.element.parentElement);r.enableAdaptiveUI&&this.dialogObj.show(!0)},n.prototype.dialogCreated=function(){yb(this.parent)},n.prototype.renderResponsiveDialog=function(){var n=this;this.parent.enableAdaptiveUI&&(this.parent.adaptiveDlgTarget&&(this.dialogObj.target=this.parent.adaptiveDlgTarget),this.dialogObj.buttons=[{}],this.dialogObj.showCloseIcon=!0,this.dialogObj.visible=!1,this.dialogObj.width="100%",this.dialogObj.open=function(){n.dialogObj.element.style.maxHeight="100%"})},n.prototype.btnClick=function(n){this.l10n.getConstant("CancelButton").toLowerCase()===n.target.innerText.trim().toLowerCase()?this.dialogClose():this.parent.endEdit()},n.prototype.dialogClose=function(){this.parent.closeEdit()},n.prototype.destroy=function(){for(var r,u,i=["template","headerTemplate","footerTemplate"],n=0;n<i.length;n++)this.parent.editSettings[i[parseInt(n.toString(),10)]]&&(r=i[parseInt(n.toString(),10)].charAt(0).toUpperCase()+i[parseInt(n.toString(),10)].slice(1),u=this.parent.element.id+"editSettings"+r,t.updateBlazorTemplate(u,r,this.parent.editSettings));this.parent.notify(nl,{});this.parent.isEdit=!1;this.parent.notify(tu,{});this.dialog&&!this.dialogObj.isDestroyed&&(this.dialogObj.destroy(),t.remove(this.dialog))},n.prototype.getDialogEditTemplateElement=function(n,i){var r=this.parent.createElement("div",{className:"e-dialog"+n}),f=t.extend({},i.rowData,{isAdd:!this.isEdit},!0),u=this.parent.element.id+"editSettings"+n;return kt(r,("HeaderTemplate"===n?this.parent.getEditHeaderTemplate():this.parent.getEditFooterTemplate())(f,this.parent,"editSettings"+n,u)),t.updateBlazorTemplate(u,n,this.parent.editSettings),r},n.prototype.getEditElement=function(n,i){var l=this,v=this.parent,o=this.parent.createElement("div",{className:this.isEdit?ni:"e-insertedrow"}),f=i.form=this.parent.createElement("form",{id:v.element.id+"EditForm",className:"e-gridform"}),h,c;if(this.parent.editSettings.template){var s=this.parent.element.id+"editSettingsTemplate",y=t.extend({},i.rowData,{isAdd:!this.isEdit},!0),b=this.parent.isReact&&"string"!=typeof this.parent.editSettings.template,d=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;return b||d?(this.parent.getEditTemplate()(y,this.parent,"editSettingsTemplate",s,null,null,f),this.parent.renderTemplates()):kt(f,this.parent.getEditTemplate()(y,this.parent,"editSettingsTemplate",s)),t.updateBlazorTemplate(s,"Template",this.parent.editSettings,!0,function(){for(var t=l.parent.getColumns(),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].validationRules&&(l.parent.editModule.formObj.rules[t[parseInt(n.toString(),10)].field]=t[parseInt(n.toString(),10)].validationRules)}),o.appendChild(f),o}for(var p=this.parent.createElement("table",{className:k,attrs:{cellspacing:"6px",role:"grid"}}),w=this.parent.createElement(e,{attrs:{role:"rowgroup"}}),u=v.getColumns(),r=0;r<u.length;r++)this.parent.editModule.checkColumnIsGrouped(u[parseInt(r.toString(),10)])||u[parseInt(r.toString(),10)].commands||u[parseInt(r.toString(),10)].commandsTemplate||"checkbox"===u[parseInt(r.toString(),10)].type||(h=this.parent.createElement("tr"),c=this.parent.createElement("td",{className:a,attrs:{style:"text-align:"+(this.parent.enableRtl?"right":"left")+";width:190px"}}),n[u[parseInt(r.toString(),10)].uid].classList.remove("e-input"),c.appendChild(n[u[parseInt(r.toString(),10)].uid]),h.appendChild(c),w.appendChild(h));return p.appendChild(w),f.appendChild(p),o.appendChild(f),o},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(os,this.destroy),this.parent.off(v,this.destroy))},n}(),gut=function(){function n(n,t){this.editType={Inline:uk,Normal:uk,Batch:kut,Dialog:dut};this.parent=n;this.serviceLocator=t;this.renderer=new this.editType[this.parent.editSettings.mode](n,t);this.focus=t.getService("focus")}return n.prototype.addNew=function(n){this.renderer.addNew(this.getEditElements(n),n);this.convertWidget(n)},n.prototype.update=function(n){this.renderer.update(this.getEditElements(n),n);n.isCustomFormValidation||(this.parent.notify(an,n),this.convertWidget(n))},n.prototype.convertWidget=function(n){var nt,e,f,o,u=this.parent,v=u.isFrozenGrid(),it="Right"===u.getFrozenMode()&&"Normal"===u.editSettings.mode?1:0,y="Dialog"===u.editSettings.mode?t.select("#"+u.element.id+"_dialogEdit_wrapper .e-gridform",document):u.element.getElementsByClassName("e-gridform")[parseInt(it.toString(),10)],rt=v&&this.parent.enableColumnVirtualization&&n.isScroll,tt,b,g,r,k,c,l,a;for(v&&"Normal"===u.editSettings.mode&&(tt=parseInt(n.row.getAttribute(h),10),u.frozenRows&&("add"===n.requestType&&"Top"===u.editSettings.newRowPosition||tt<u.frozenRows)?(f=u.element.querySelector("."+w).querySelector(".e-gridform"),this.parent.getFrozenMode()===s&&(o=n.frozenRightForm)):(f=u.element.querySelector("."+p).querySelector(".e-gridform"),this.parent.getFrozenMode()===s&&(o=n.frozenRightForm))),b=0,g="Batch"!==u.editSettings.mode?u.getColumns():[u.getColumnByField(n.columnName)];b<g.length;b++)r=g[b],rt&&"movable"!==r.getFreezeTableName()||(!this.parent.editSettings.template||t.isNullOrUndefined(r.field)?this.parent.editModule.checkColumnIsGrouped(r)||r.commands||(r.valueAccessor(r.field,n.rowData,r),e=f&&"movable"===r.getFreezeTableName()&&"Normal"===u.editSettings.mode?f.querySelector("[e-mappinguid="+r.uid+"]"):o&&r.getFreezeTableName()===d&&"Normal"===u.editSettings.mode?o.querySelector("[e-mappinguid="+r.uid+"]"):y.querySelector("[e-mappinguid="+r.uid+"]"),k=r.edit.write,t.isNullOrUndefined(e)||("string"==typeof k?(k=ut(k,window))({rowData:n.rowData,element:e,column:r,requestType:n.requestType,row:n.row,foreignKeyData:r.isForeignColumn()&&ut(r.field,n.foreignKeyData)}):r.edit.write({rowData:n.rowData,element:e,column:r,requestType:n.requestType,row:n.row,foreignKeyData:r.isForeignColumn()&&ut(r.field,n.foreignKeyData)}),nt||e.getAttribute("disabled")||i(e,"e-checkbox-disabled")||(this.focusElement(e,n.type),nt=!0))):(c=t.extend({},n),c.element=y.querySelector("[name="+wt(r.field)+"]"),t.isNullOrUndefined(c.element)&&v&&(c.element=f.querySelector("[name="+wt(r.field)+"]")),"string"==typeof r.edit.write?ut(r.edit.write,window)(c):r.edit.write(c)));!v||this.parent.allowTextWrap||"add"!==n.requestType&&"beginEdit"!==n.requestType||"Dialog"===this.parent.editSettings.mode||t.isNullOrUndefined(y)||t.isNullOrUndefined(f)||(l=f.querySelector("tr").children[0],a=y.querySelector("tr").children[0],a.offsetHeight>l.offsetHeight?(l.style.height=a.offsetHeight+"px",o&&(f.querySelector("tr").children[0].style.height=a.offsetHeight+"px")):(a.style.height=l.offsetHeight+"px",o&&(f.querySelector("tr").children[0].style.height=l.offsetHeight+"px")))},n.prototype.focusElement=function(n){var r=this.parent.element.querySelector(".e-edit-checkselect");!t.isNullOrUndefined(r)&&r.nextElementSibling&&r.nextElementSibling.classList.add("e-focus");"Batch"===this.parent.editSettings.mode?this.focus.onClick({target:t.closest(n,"td")},!0):!this.parent.enableVirtualization||"Normal"!==this.parent.editSettings.mode||this.parent.enableVirtualization&&"Bottom"===this.parent.editSettings.newRowPosition&&i(n,ui)?n.focus():n.focus({preventScroll:!0});n.classList.contains("e-defaultcell")&&n.setSelectionRange(n.value.length,n.value.length)},n.prototype.getEditElements=function(n){var u=this.parent,l={},e="Batch"!==u.editSettings.mode?u.getColumns():[u.getColumnByField(n.columnName)],i,s,c,k,v;if(n.isCustomFormValidation&&(e=this.parent.columnModel),this.parent.editSettings.template)return{};for(var d=u.isFrozenGrid()&&u.enableColumnVirtualization&&n.isScroll,f=0,g=e.length;f<g;f++)if(i=e[parseInt(f.toString(),10)],!(this.parent.editModule.checkColumnIsGrouped(i)||d&&"movable"!==e[parseInt(f.toString(),10)].getFreezeTableName()||n.isCustomFormValidation&&(i.commands||i.commandsTemplate||!i.field)))if(i.commands||i.commandsTemplate){var nt=this.serviceLocator.getService("cellRendererFactory"),tt=new er(this.parent),it=nt.getCellRenderer(o.CommandColumn),rt=tt.generateRows(n.rowData)[0].cells.filter(function(n){return n.rowID}),y=it.render(rt[parseInt(f.toString(),10)],n.rowData,{index:n.row?n.row.getAttribute(h):0},this.parent.enableVirtualization);(c=y.firstElementChild).setAttribute("textAlign",y.getAttribute("textAlign"));l[i.uid]=c}else{"dateonly"===i.type&&n.rowData[i.field]instanceof Date&&(s=n.rowData[i.field],n.rowData[i.field]=s.getFullYear()+"-"+lu(s.getMonth()+1)+"-"+lu(s.getDate()));var ft=i.valueAccessor(i.field,n.rowData,i),p={column:i,value:ft,type:n.requestType,data:n.rowData},a=i.edit.create,r=void 0;if(i.editTemplate){r=this.parent.createElement("span",{attrs:{"e-mappinguid":i.uid}});var w=this.parent.element.id+i.uid+"editTemplate",b=bh({},n.rowData,{column:i}),et=this.parent.isReact&&"string"!=typeof i.editTemplate,ot=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact;et||ot?(i.getEditTemplate()(t.extend({index:n.rowIndex},b),this.parent,"editTemplate",w,null,null,r),this.parent.renderTemplates()):kt(r,i.getEditTemplate()(t.extend({index:n.rowIndex},b),this.parent,"editTemplate",w))}else"string"==typeof(r="string"==typeof a?(a=ut(a,window))(p):i.edit.create(p))&&((c=this.parent.createElement("div")).innerHTML=r,r=c.firstChild),k="input"!==r.tagName&&r.querySelectorAll("input").length,v=wt(i.field),t.attributes(k?r.querySelector("input"):r,{name:v,"e-mappinguid":i.uid,id:u.element.id+v}),t.classList(r,["e-input","e-field"],[]),"Right"===i.textAlign&&r.classList.add("e-ralign"),((i.isPrimaryKey||i.isIdentity)&&"beginEdit"===n.requestType||i.isIdentity&&"add"===n.requestType)&&r.setAttribute("disabled","");l[i.uid]=r}return l},n.prototype.destroy=function(){this.renderer.removeEventListener()},n}(),gr=function(){function n(n){this.parent=n}return n.prototype.create=function(n){return vo(this.parent,n.column,"e-field",{type:"text"})},n.prototype.read=function(n){return n.ej2_instances[0].value},n.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.removeEventHandler&&this.removeEventHandler(),this.obj.destroy())},n}(),nct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nft=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return nct(i,n),i.prototype.create=function(n){var t="e-field e-boolcell";return"checkbox"===n.column.type&&(t="e-field e-boolcell e-edit-checkselect"),this.removeEventHandler=this.removeEventListener,vo(this.parent,n.column,t,{type:"checkbox",value:n.value})},i.prototype.read=function(n){return n.checked},i.prototype.write=function(n){var u,i,r;(t.isNullOrUndefined(n.row)||(u=n.row.querySelector(".e-edit-checkselect")),ut(n.column.field,n.rowData)&&(i=JSON.parse(ut(n.column.field,n.rowData).toString().toLowerCase())),t.isNullOrUndefined(u)||"checkbox"!==n.column.type)||((this.editType=this.parent.editSettings.mode,this.editRow=n.row,"add"!==n.requestType)&&(r=this.parent.getRowObjectFromUID(n.row.getAttribute("data-uid")),i=!!r&&r.isSelected),rr.apply(void 0,[[].slice.call(n.row.getElementsByClassName(a)),i].concat(this.activeClasses)));this.obj=new fi.CheckBox(t.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":n.column.headerText,checked:i,disabled:!br(n.column,n.requestType,n.element),enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass?this.parent.cssClass:""},n.column.edit.params));this.addEventListener();this.obj.appendTo(n.element)},i.prototype.addEventListener=function(){this.cbChange=this.checkBoxChange.bind(this);this.obj.addEventListener(te,this.cbChange)},i.prototype.removeEventListener=function(){this.obj.isDestroyed||this.obj.removeEventListener(te,this.cbChange)},i.prototype.checkBoxChange=function(n){if(this.editRow&&"Dialog"!==this.editType){var t=!1;n.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected");rr.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(a)),t].concat(this.activeClasses))}},i}(gr),tct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tft=function(n){function r(t){var i=n.call(this)||this;return i.parent=t,i.flag=!1,i.removeEventHandler=i.removeEventListener,i}return tct(r,n),r.prototype.write=function(n){var e="Dialog"!==this.parent.editSettings.mode,o,f,r,i;if(this.column=n.column,o=new u.Predicate(n.column.field,"notequal",null,!0,!1),f={},n.column.edit.params)for(r=Object.keys(n.column.edit.params),i=0;i<r.length;i++)f[r[parseInt(i.toString(),10)]]="query"===r[parseInt(i.toString(),10)]?n.column.edit.params[r[parseInt(i.toString(),10)]].clone():n.column.edit.params[r[parseInt(i.toString(),10)]];this.obj=new dr.DropDownList(t.extend({dataSource:this.parent.dataSource instanceof u.DataManager?this.parent.dataSource:new u.DataManager(this.parent.dataSource),query:(new u.Query).where(o).select(n.column.field),enabled:br(n.column,n.requestType,n.element),fields:{value:n.column.field},value:ut(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,placeholder:e?"":n.column.headerText,popupHeight:"200px",floatLabelType:e?"Never":"Always",sortOrder:"Ascending",cssClass:this.parent.cssClass?this.parent.cssClass:null,close:this.dropDownClose.bind(this)},f));this.parent.enableVirtualization&&(this.obj.dataSource=f.dataSource?f.dataSource:n.column.isForeignColumn()?[n.foreignKeyData[0]]:[n.rowData]);this.addEventListener();this.obj.query.params=this.parent.query.params;this.obj.appendTo(n.element);n.element.setAttribute("name",wt(n.column.field))},r.prototype.dropDownClose=function(n){n.event&&"escape"===n.event.action&&(this.parent.editModule.editCellDialogClose=!0)},r.prototype.addEventListener=function(){this.ddCreated=this.dropdownCreated.bind(this);this.ddOpen=this.dropDownOpen.bind(this);this.ddBeforeOpen=this.dropdownBeforeOpen.bind(this);this.ddComplete=this.ddActionComplete.bind(this);this.obj.addEventListener(ih,this.ddCreated);this.obj.addEventListener(bi,this.ddOpen);this.obj.addEventListener(pw,this.ddBeforeOpen);this.obj.addEventListener(l,this.ddComplete)},r.prototype.removeEventListener=function(){this.obj.isDestroyed||(this.obj.removeEventListener(ih,this.ddCreated),this.obj.removeEventListener(bi,this.ddOpen),this.obj.removeEventListener(pw,this.ddBeforeOpen),this.obj.removeEventListener(l,this.ddComplete))},r.prototype.dropdownCreated=function(){this.flag=!0},r.prototype.dropdownBeforeOpen=function(){this.parent.enableVirtualization&&(this.obj.dataSource=this.column.edit.params&&this.column.edit.params.dataSource?this.column.edit.params.dataSource:this.column.isForeignColumn()?this.column.dataSource instanceof u.DataManager?this.column.dataSource:new u.DataManager(this.column.dataSource):this.parent.dataSource instanceof u.DataManager?this.parent.dataSource:new u.DataManager(this.parent.dataSource))},r.prototype.ddActionComplete=function(n){n.result=u.DataUtil.distinct(n.result,this.obj.fields.value,!0);!this.flag||!this.column.dataSource||this.column.edit.params&&this.column.edit.params.ddEditedData||("result"in this.column.dataSource?this.column.dataSource.result=n.result:this.column.dataSource instanceof u.DataManager&&(this.column.dataSource.dataSource.json=n.result));this.flag=!1},r.prototype.dropDownOpen=function(n){var r=i(this.obj.element,"e-dialog"),u;"Dialog"!==this.parent.editSettings.mode||t.isNullOrUndefined(r)||(u=t.select("#"+r.id,document).ej2_instances[0],n.popup.element.style.zIndex=(u.zIndex+1).toString())},r}(gr),ift=function(){function n(n){this.parent=n}return n.prototype.keyEventHandler=function(n){if(13===n.keyCode||9===n.keyCode){var t=document.createEvent("HTMLEvents");t.initEvent("change",!1,!0);this.dispatchEvent(t)}},n.prototype.create=function(n){return this.instances=new t.Internationalization(this.parent.locale),vo(this.parent,n.column,"e-field",{})},n.prototype.read=function(){return this.obj.value},n.prototype.write=function(n){var i=n.column,r="Dialog"!==this.parent.editSettings.mode;this.obj=new kr.NumericTextBox(t.extend({value:parseFloat(ut(n.column.field,n.rowData)),enableRtl:this.parent.enableRtl,placeholder:r?"":n.column.headerText,enabled:br(n.column,n.requestType,n.element),floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",locale:this.parent.locale,cssClass:this.parent.cssClass?this.parent.cssClass:null},i.edit.params));n.element.setAttribute("name",wt(n.column.field));this.obj.appendTo(n.element);this.obj.element.addEventListener("keydown",this.keyEventHandler)},n.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},n}(),ict=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rft=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ict(i,n),i.prototype.create=function(n){var i={type:"text",value:t.isNullOrUndefined(n.value)?"":n.value,style:"text-align:"+n.column.textAlign};return vo(this.parent,n.column,"e-field e-input e-defaultcell",i)},i.prototype.read=function(n){return n.value},i.prototype.write=function(n){var i=n.column,r="Dialog"!==this.parent.editSettings.mode;this.obj=new kr.TextBox(t.extend({element:n.element,floatLabelType:"Dialog"!==this.parent.editSettings.mode?"Never":"Always",enableRtl:this.parent.enableRtl,enabled:br(n.column,n.requestType,n.element),placeholder:r?"":n.column.headerText,cssClass:this.parent.cssClass?this.parent.cssClass:""},i.edit.params));this.obj.appendTo(n.element);"Batch"===this.parent.editSettings.mode&&this.obj.element.addEventListener("keydown",this.keyEventHandler)},i.prototype.keyEventHandler=function(n){if("Enter"===n.key||"Tab"===n.key){var t=new Event("change",{bubbles:!1,cancelable:!0});this.dispatchEvent(t)}},i.prototype.destroy=function(){this.obj&&!this.obj.isDestroyed&&(this.obj.element.removeEventListener("keydown",this.keyEventHandler),this.obj.destroy())},i}(gr),fk=function(){function n(n,t,i){this.args={};this.currentVirtualData={};this.parent=n;this.renderer=i;this.serviceLocator=t;this.addEventListener()}return n.prototype.clickHandler=function(n){var t=n.target,r=this.parent;(i(t,ot)&&i(i(t,ot),"e-grid").id===r.element.id||r.frozenRows&&i(t,st))&&!i(t,"e-unboundcelldiv")&&(this.rowIndex=i(t,a)?parseInt(t.parentElement.getAttribute(h),10):-1,r.isEdit&&r.editModule.endEdit())},n.prototype.dblClickHandler=function(n){i(n.target,a)&&this.parent.editSettings.allowEditOnDblClick&&this.parent.editModule.startEdit(i(n.target,y))},n.prototype.editComplete=function(n){switch(this.parent.isEdit=!1,n.requestType){case"save":(this.parent.isCheckBoxSelection||"Multiple"===this.parent.selectionSettings.type)&&this.parent.isPersistSelection||"edit"!==n.action&&this.parent.selectRow(0);this.parent.trigger(l,t.extend(n,{requestType:"save",type:l}));break;case"delete":this.parent.trigger(l,t.extend(n,{requestType:"delete",type:l}));this.parent.isCheckBoxSelection||this.parent.selectRow(this.editRowIndex)}},n.prototype.getEditArgs=function(n,t,i){for(var r=this.parent.getPrimaryKeyFieldNames(),f=[],u=0;u<r.length;u++)f.push(ut(r[parseInt(u.toString(),10)],n));return{primaryKey:r,primaryKeyValue:f,requestType:"beginEdit",rowData:n,rowIndex:this.rowIndex,type:"edit",cancel:!1,foreignKeyData:t&&t.foreignKeyData,target:void 0,isScroll:i}},n.prototype.startEdit=function(n){var c=this,i=this.parent,f,r,e,o,s,u;(this.rowIndex=this.editRowIndex=parseInt(n.getAttribute(h),10),i.enableVirtualization||i.enableInfiniteScrolling)&&(f='.e-row[data-rowindex="'+this.rowIndex+'"]',!this.parent.element.querySelector(f))||(r={data:void 0,index:this.rowIndex,isScroll:!1},(this.parent.notify(ls,r),et(i))?(e=i.getRowObjectFromUID(n.getAttribute("data-uid")),this.previousData=e.data):this.previousData||!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling?this.parent.enableVirtualization||(this.previousData=t.extend({},{},i.getCurrentViewRecords()[this.rowIndex],!0)):this.previousData=r.data,o=t.extend({},{},r.data||this.previousData,!0),this.uid=n.getAttribute("data-uid"),s=i.getRowObjectFromUID(this.uid),u=this.getEditArgs(o,s,r.isScroll),u.row=n,u.isScroll?this.inlineEditHandler(u,n):(this.parent.notify(gs,{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),i.trigger(bd,u,function(t){t.type="actionBegin";i.trigger(nt,t,function(t){t.cancel||c.inlineEditHandler(t,n)})})))},n.prototype.inlineEditHandler=function(n,t){var i=this.parent;i.isEdit=!0;n.row=n.row?n.row:t;"Dialog"!==i.editSettings.mode&&i.clearSelection();"Dialog"===i.editSettings.mode&&i.selectionModule&&(i.selectionModule.preventFocus=!0,n.row.classList.add("e-dlgeditrow"));this.renderer.update(n);this.uid=t.getAttribute("data-uid");i.editModule.applyFormValidation();n.type="actionComplete";i.trigger(l,n);i.editSettings.template&&i.editModule.applyFormValidation(void 0,n.form.ej2_instances[0].rules);this.args=n;this.parent.allowTextWrap&&this.parent.notify(ei,{"case":"textwrap"})},n.prototype.updateRow=function(n,t){var f=this,i=this.parent,r,u;this.editRowIndex=n;r={requestType:"save",action:"edit",type:nt,data:t,cancel:!1,previousData:i.getCurrentViewRecords()[parseInt(n.toString(),10)],row:i.getRowByIndex(n)};(i.showSpinner(),i.enableInfiniteScrolling)&&(this.uid=r.row.getAttribute("data-uid"),u=parseInt(r.row.getAttribute("data-rowindex"),10),this.parent.notify(va,{index:u}));i.notify(pe,r);r.promise?r.promise.then(function(){return i.refresh()}).catch(function(n){return f.edFail(n)}):i.enableInfiniteScrolling||i.refresh()},n.prototype.editFormValidate=function(){var n=this.parent,i=n.editModule.editFormValidate(),t={prevData:this.previousData,isValid:!0,editIdx:this.editRowIndex,addIdx:this.addedRowIndex};return n.notify(ha,t),i&&t.isValid},n.prototype.endEdit=function(){var e=this,n=this.parent,f;if(this.parent.isEdit&&this.editFormValidate()){var r=t.extend({},{},this.previousData,!0),i=t.extend(this.args,{requestType:"save",type:nt,data:r,cancel:!1,previousData:this.previousData,selectedRow:n.selectedRowIndex,foreignKeyData:{}}),v="Right"===n.getFrozenMode()?1:0,o="Dialog"===n.editSettings.mode,h=t.select("#"+n.element.id+"_dialogEdit_wrapper",document),y=o?h.querySelector(".e-gridform"):n.element.getElementsByClassName("e-gridform")[parseInt(v.toString(),10)],u={virtualData:t.extend({},{},this.previousData,!0),isAdd:!1,isScroll:!1,endEdit:!0};if(this.parent.notify(iu,u),(this.parent.enableVirtualization||this.parent.enableInfiniteScrolling)&&"Normal"===this.parent.editSettings.mode&&Object.keys(u.virtualData).length?this.parent.isEdit&&(this.currentVirtualData=r=i.data=u.virtualData):r=n.editModule.getCurrentEditedData(y,r),n.isFrozenGrid()&&"Normal"===n.editSettings.mode){var p=n.getMovableVirtualHeader().querySelector(".e-gridform"),w=n.getMovableVirtualContent().querySelector(".e-gridform"),b=[p||w],c=void 0,l=void 0,a=[];n.getFrozenMode()===s&&(c=n.getFrozenRightHeader().querySelector(".e-gridform"),l=n.getFrozenRightContent().querySelector(".e-gridform"),a=[c||l]);vu(this.parent,function(t,i){for(var e,u=0,f=i;u<f.length;u++)e=f[u],e&&(r=n.editModule.getCurrentEditedData(e,r))},[[],b,a])}if(f=[].slice.call(n.element.getElementsByClassName(ni)).length,u.isAdd||!Object.keys(this.currentVirtualData).length||f||(f=1),o?h.getElementsByClassName(ni).length:f)i.action="edit",n.trigger(nt,i,function(t){t.cancel||("Spinner"===e.parent.loadingIndicator.indicatorType&&n.showSpinner(),"Shimmer"===e.parent.loadingIndicator.indicatorType&&e.parent.showMaskRow(),n.notify(pe,t))});else if(i.action="add",i.selectedRow=0,i.index=this.addedRowIndex,n.notify(no,{}),n.notify(pt,i),this.addedRowIndex=null,i.cancel)return;n.editModule.resetMovableContentValidation()}},n.prototype.destroyElements=function(){var n=this.parent;n.editModule.destroyWidgets();n.editModule.destroyForm();this.parent.notify(os,{})},n.prototype.editHandler=function(n){var t=this;n.promise?n.promise.then(function(i){return t.edSucc(i,n)}).catch(function(n){return t.edFail(n)}):this.editSuccess(n.data,n)},n.prototype.edSucc=function(n,t){this.editSuccess(n,t)},n.prototype.edFail=function(n){this.editFailure(n)},n.prototype.updateCurrentViewData=function(n){this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(this.parent.getCurrentViewRecords()[this.editRowIndex]=n)},n.prototype.requestSuccess=function(n){this.parent.editModule.formObj&&!this.parent.editModule.formObj.isDestroyed&&(this.destroyElements(),this.stopEditStatus(),"Dialog"===this.parent.editSettings.mode&&"add"!==n.action&&this.parent.selectionModule&&this.parent.element.querySelector(".e-dlgeditrow").classList.remove("e-dlgeditrow"))},n.prototype.editSuccess=function(n,i){var o=this,u;if(t.isNullOrUndefined(n)||n instanceof Array||(i.data=t.extend({},t.extend({},i.rowData,i.data),n)),this.requestSuccess(i),this.parent.trigger(is,i),i.type=l,this.parent.isEdit=!1,this.refreshRow(i.data),this.parent.notify(no,i),this.parent.editModule.checkLastRow(i.row),this.parent.editModule.isLastRow=!1,this.updateCurrentViewData(i.data),this.blazorTemplate(),this.editRowIndex=null,this.parent.allowGrouping&&this.parent.groupSettings.columns.length){for(var s=i.row,f=this.parent.getRowsObject(),h=s.getAttribute("data-uid"),r=this.parent.getRowObjectFromUID(h),c=function(n){f=f.filter(function(t){return t.isDataRow&&t.data[o.parent.groupSettings.columns[parseInt(n.toString(),10)]]===i.data[o.parent.groupSettings.columns[parseInt(n.toString(),10)]]&&t!==r})},e=0;e<this.parent.groupSettings.columns.length;e++)c(e);u=f[0];t.isNullOrUndefined(r)||t.isNullOrUndefined(u)||r.parentUid===u.parentUid?this.parent.aggregates.length&&this.parent.aggregateModule.refresh(i.data,this.parent.groupSettings.enableLazyLoading?i.row:void 0):this.parent.groupModule.groupedRowReorder(r,u)}else this.parent.aggregates.length&&this.parent.aggregateModule.refresh(i.data,this.parent.groupSettings.enableLazyLoading?i.row:void 0);this.parent.trigger(l,i);(!this.parent.isCheckBoxSelection&&"Multiple"!==this.parent.selectionSettings.type||!this.parent.isPersistSelection&&!this.parent.selectionSettings.checkboxOnly)&&"Dialog"!==this.parent.editSettings.mode&&this.parent.selectRow(this.rowIndex>-1?this.rowIndex:this.editRowIndex);this.parent.aggregates.length&&this.parent.groupSettings.enableLazyLoading&&this.parent.groupSettings.columns.length&&(this.parent.groupModule.getGroupAggregateTemplates(!0).length||this.parent.groupModule.getGroupAggregateTemplates(!1).length)||(this.parent.removeMaskRow(),this.parent.hideSpinner())},n.prototype.closeForm=function(){!this.cloneRow&&this.parent.isEdit&&this.stopEditStatus();this.cloneRow&&(this.cloneRow.remove(),this.cloneRow=null,this.originalRow.classList.remove("e-hiddenrow"));this.parent.isFrozenGrid()&&this.cloneFrozen&&(this.cloneFrozen.remove(),this.frozen.classList.remove("e-hiddenrow"))},n.prototype.blazorTemplate=function(){var r=this.parent.getColumns(),i,n;for(this.parent.editSettings.template&&"Normal"===this.parent.editSettings.mode&&t.updateBlazorTemplate(this.parent.element.id+"editSettingsTemplate","Template",this.parent.editSettings),i=0;i<r.length;i++)n=r[parseInt(i.toString(),10)],n.template&&t.updateBlazorTemplate(this.parent.element.id+n.uid,"Template",n,!1),n.editTemplate&&t.updateBlazorTemplate(this.parent.element.id+n.uid+"editTemplate","EditTemplate",n)},n.prototype.editFailure=function(n){this.parent.removeMaskRow();this.parent.trigger(lf,{error:n});this.parent.hideSpinner();this.parent.log("actionfailure",{error:n})},n.prototype.needRefresh=function(){var n=!0,t=this.parent.element.querySelector(".e-gridform");return!this.parent.enableVirtualization&&!this.parent.infiniteScrollSettings.enableCache||"Normal"!==this.parent.editSettings.mode||t||(n=!1),n},n.prototype.refreshRow=function(n){var e=this.parent.isFrozenGrid(),f=new oi(this.serviceLocator,null,this.parent),t=this.parent.getRowObjectFromUID(this.uid),i,r,u;if(t&&(t.changes=n,this.parent.notify(as,{data:n}),co(t,this.parent.getForeignKeyColumns(),t.changes),this.needRefresh()&&f.refresh(t,this.parent.getColumns(),!0),i=[].slice.call(this.parent.element.querySelectorAll('[data-rowindex="'+t.index+'"]')),e&&i.length))for(r=0;r<i.length;r++)u=i[parseInt(r.toString(),10)].getAttribute("data-uid"),u!==this.uid&&((t=this.parent.getRowObjectFromUID(u)).changes=n,co(t,this.parent.getForeignKeyColumns(),t.changes),f.refresh(t,this.parent.getColumns(),!0),this.parent.editModule.checkLastRow(i[parseInt(r.toString(),10)]))},n.prototype.closeEdit=function(){var i=this,n,r;this.parent.isEdit&&(n=this.parent,r=t.extend(this.args,{requestType:"cancel",type:nt,cancel:!1,data:this.previousData,selectedRow:n.selectedRowIndex}),n.notify(gp,r),this.blazorTemplate(),n.trigger(nt,r,function(t){if(!t.cancel){"Dialog"===i.parent.editSettings.mode&&i.parent.notify(os,{});n.isEdit=!1;i.stopEditStatus();t.type=l;"Dialog"!==n.editSettings.mode&&i.refreshRow(t.data);var r=n.groupSettings.enableLazyLoading&&n.groupSettings.columns.length&&!n.getContentTable().querySelector("tr.e-emptyrow");n.getContentTable().querySelector("tr.e-emptyrow")||n.getContentTable().querySelector("tr.e-row")||r||n.renderModule.emptyRow();"Dialog"!==n.editSettings.mode&&n.selectRow(i.rowIndex);n.editModule.resetMovableContentValidation();n.trigger(l,t)}}))},n.prototype.addRecord=function(n,i){var h=this,s=this.parent,f,e,r,o;if(this.addedRowIndex=i=t.isNullOrUndefined(i)?0:i,n)s.notify(pt,{requestType:"save",type:nt,data:n,selectedRow:0,action:"add",index:i});else if(!s.isEdit){for(this.previousData={},this.uid="",f=s.getColumns(),e={virtualData:{},isScroll:!1},this.parent.notify(iu,e),r=0;r<f.length;r++)e.isScroll&&"movable"!==f[parseInt(r.toString(),10)].getFreezeTableName()||f[parseInt(r.toString(),10)].field&&("string"===f[parseInt(r.toString(),10)].type&&(f[parseInt(r.toString(),10)].defaultValue=this.parent.sanitize(f[parseInt(r.toString(),10)].defaultValue)),u.DataUtil.setValue(f[parseInt(r.toString(),10)].field,f[parseInt(r.toString(),10)].defaultValue,this.previousData));o={cancel:!1,foreignKeyData:{},requestType:"add",data:this.previousData,type:nt,index:i,rowData:this.previousData,target:void 0,isScroll:e.isScroll};(this.parent.enableVirtualization||this.parent.infiniteScrollSettings.enableCache)&&Object.keys(e.virtualData).length&&(o.data=o.rowData=e.virtualData);o.isScroll?this.inlineAddHandler(o):(this.parent.notify(gs,{uid:this.uid,prevData:this.previousData,argsCreator:this.getEditArgs.bind(this),renderer:this.renderer}),s.trigger(nt,o,function(n){n.cancel||h.inlineAddHandler(n)}))}},n.prototype.inlineAddHandler=function(n){var t=this.parent;t.isEdit=!0;"Dialog"!==t.editSettings.mode&&t.clearSelection();this.renderer.addNew(n);t.editModule.applyFormValidation();n.type=l;n.row=t.element.querySelector("."+ui);t.trigger(l,n);t.editSettings.template&&t.editModule.applyFormValidation(void 0,n.form.ej2_instances[0].rules);this.args=n},n.prototype.deleteRecord=function(n,i){var f,e,o,u,r,s;if(this.editRowIndex=this.parent.selectedRowIndex,i)for(i=i instanceof Array?i:[i],f=this.parent,e=Object.keys(i).length,n=n||this.parent.getPrimaryKeyFieldNames()[0],o=function(t){var r,u,e=f.currentViewData.some(function(r){return u=r,i[parseInt(t.toString(),10)]===ut(n,r)||i[parseInt(t.toString(),10)]===r});i[parseInt(t.toString(),10)]=e?u:i[parseInt(t.toString(),10)][""+n]?i[parseInt(t.toString(),10)]:((r={})[n]=i[parseInt(t.toString(),10)],r)},u=0;u<e;u++)o(u);r={requestType:"delete",type:nt,foreignKeyData:{},data:i||this.parent.getSelectedRecords(),tr:this.parent.getSelectedRows(),cancel:!1};(t.isNullOrUndefined(this.parent.commandDelIndex)||(r.data[0]=this.parent.getRowObjectFromUID(this.parent.getRowByIndex(this.parent.commandDelIndex).getAttribute("data-uid")).data),this.parent.enableVirtualization&&r.data.length>1)&&(s=this.parent.getSelectedRows()[0].getAttribute("data-uid"),r.data=[this.parent.getRowObjectFromUID(s).data]);this.parent.notify(pt,r)},n.prototype.stopEditStatus=function(){for(var i=this.parent,r=[].slice.call(i.element.getElementsByClassName(ui)),u=[].slice.call(i.element.getElementsByClassName(ni)),n=0;n<r.length;n++)t.remove(r[parseInt(n.toString(),10)]);for(n=0;n<u.length;n++)u[parseInt(n.toString(),10)].classList.remove(ni)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:ep,handler:this.editHandler},{event:tl,handler:this.dblClickHandler},{event:ii,handler:this.clickHandler},{event:el,handler:this.requestSuccess},{event:ye,handler:this.dblClickHandler},{event:gc,handler:this.editComplete},{event:fp,handler:this.editComplete},{event:ea,handler:this.closeEdit},{event:ltt,handler:this.closeForm}],vt(this.parent,this.evtHandlers,!0,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||vt(this.parent,this.evtHandlers,!1)},n.prototype.destroy=function(){this.removeEventListener();this.renderer.destroy()},n}(),rct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ek=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.parent=t,u.serviceLocator=i,u.renderer=r,u}return rct(t,n),t.prototype.closeEdit=function(){n.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){n.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){n.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){n.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){n.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){n.prototype.startEdit.call(this,t)},t}(fk),uft=function(){function n(n,t,i){this.cellDetails={};this.originalCell={};this.cloneCell={};this.editNext=!1;this.preventSaveCell=!1;this.initialRender=!0;this.validationColObj=[];this.addBatchRow=!1;this.prevEditedBatchCell=!1;this.parent=n;this.serviceLocator=t;this.renderer=i;this.focus=t.getService("focus");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.evtHandlers=[{event:ii,handler:this.clickHandler},{event:ye,handler:this.dblClickHandler},{event:pf,handler:this.onBeforeCellFocused},{event:us,handler:this.onCellFocused},{event:tl,handler:this.dblClickHandler},{event:ht,handler:this.keyDownHandler},{event:cs,handler:this.editNextValCell},{event:att,handler:this.closeForm},{event:v,handler:this.destroy}],vt(this.parent,this.evtHandlers,!0,this),this.dataBoundFunction=this.dataBound.bind(this),this.batchCancelFunction=this.batchCancel.bind(this),this.parent.addEventListener(ti,this.dataBoundFunction),this.parent.addEventListener(pr,this.batchCancelFunction))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(vt(this.parent,this.evtHandlers,!1),this.parent.removeEventListener(ti,this.dataBoundFunction),this.parent.removeEventListener(pr,this.batchCancelFunction))},n.prototype.batchCancel=function(){this.parent.focusModule.restoreFocus()},n.prototype.dataBound=function(){this.parent.notify(tu,{})},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.clickHandler=function(n){i(n.target,this.parent.element.id+"_add",!0)||(this.parent.isEdit&&t.closest(this.form,"td")!==t.closest(n.target,"td")&&(this.saveCell(),this.editNextValCell()),i(n.target,a)&&!this.parent.isEdit&&this.setCellIdx(n.target))},n.prototype.dblClickHandler=function(n){var r=i(n.target,a),e=i(n.target,y),u=e&&parseInt(e.getAttribute(h),10),f=r&&parseInt(r.getAttribute(lt),10);t.isNullOrUndefined(r)||t.isNullOrUndefined(u)||isNaN(f)||r.parentElement.classList.contains(ni)||!this.parent.getColumns()[parseInt(f.toString(),10)].allowEditing||this.editCell(u,this.parent.getColumns()[parseInt(f.toString(),10)].field,this.isAddRow(u))},n.prototype.onBeforeCellFocused=function(n){this.parent.isEdit&&this.validateFormObj()&&(n.byClick||["tab","shiftTab","enter","shiftEnter"].indexOf(n.keyArgs.action)>-1)&&(n.cancel=!0,n.byClick?n.clickArgs.preventDefault():n.keyArgs.preventDefault())},n.prototype.onCellFocused=function(n){var f=this.parent.getFrozenLeftCount(),a=this.parent.getFrozenRightColumnsCount(),v=this.parent.getContent().querySelector("."+p),y=this.parent.getHeaderContent().querySelector("."+w),s=!(n.container.isContent&&n.container.isDataCell||this.parent.frozenRows&&n.container.isHeader),c,u,l,e,o;if(this.parent.focusModule.active&&(this.prevEditedBatchCell=this.parent.focusModule.active.matrix.current.toString()===this.prevEditedBatchCellMatrix().toString(),this.crtRowIndex=[].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(t.closest(n.element,"tr"))),!n.byKey||s||this.parent.isFrozenGrid()&&n.element&&t.closest(n.element,".e-gridheader")&&t.closest(n.element,"thead"))(this.parent.isEdit&&s||this.parent.isFrozenGrid()&&this.parent.isEdit&&n.byKey)&&this.saveCell();else{var h=n.container.indexes,i=h[0],r=h[1];if((f&&(v.contains(n.element)||this.parent.frozenRows&&y.contains(n.element))&&(r+=f),a)&&(c=this.parent.getHeaderContent().querySelector(".e-frozen-right-header"),(this.parent.getContent().querySelector(".e-frozen-right-content").contains(n.element)||this.parent.frozenRows&&c.contains(n.element))&&(r+=f+this.parent.getMovableColumnsCount())),this.parent.frozenRows&&n.container.isContent&&(i+=this.parent.frozenRows),u=this.parent.isEdit,!this.parent.element.getElementsByClassName("e-popup-open").length)switch(u=u&&!this.validateFormObj(),n.keyArgs.action){case"tab":case"shiftTab":l=this.parent.isRowDragable()&&this.parent.isDetail()?2:this.parent.isRowDragable()||this.parent.isDetail()?1:0;e=this.parent.getColumns()[r-l];e&&!this.parent.isEdit&&this.editCell(i,e.field);(u||this.parent.isLastCellPrimaryKey)&&this.editCellFromIndex(i,r);break;case"enter":case"shiftEnter":n.keyArgs.preventDefault();o={cancel:!1,keyArgs:n.keyArgs};this.parent.notify("beforeFocusCellEdit",o);!o.cancel&&u&&this.editCell(i,this.cellDetails.column.field);break;case"f2":this.editCellFromIndex(i,r);this.focus.focus()}}},n.prototype.isAddRow=function(n){return this.parent.getDataRows()[parseInt(n.toString(),10)].classList.contains("e-insertedrow")},n.prototype.editCellFromIndex=function(n,t){this.cellDetails.rowIndex=n;this.cellDetails.cellIndex=t;this.editCell(n,this.parent.getColumns()[parseInt(t.toString(),10)].field,this.isAddRow(n))},n.prototype.closeEdit=function(){var e=this,n=this.parent,r=this.parent.getRowsObject(),u={cancel:!1,batchChanges:this.getBatchChanges()},i;if(n.notify(vn,u),!u.cancel){n.isEdit&&this.saveCell(!0);this.isAdded=!1;n.clearSelection();for(var f,o=nc(this.parent),s=function(n){var t=!1,i=r[parseInt(n.toString(),10)].isDirty;vu(h.parent,function(r,u){(t=e.removeBatchElementChanges(u[parseInt(n.toString(),10)],i))&&u.splice(n,1)},o);t&&n--;f=n},h=this,t=0;t<r.length;t++)s(t),t=f;n.getContentTable().querySelector("tr.e-row")||n.renderModule.renderEmptyRow();i=this.parent.getRowsObject();this.parent.isFrozenGrid()?(this.parent.getRowsObject().length&&n.notify(pr,{rows:this.parent.getRowsObject(),args:{isFrozen:!0}}),this.parent.getMovableRowsObject().length&&n.notify(pr,{rows:this.parent.getMovableRowsObject()}),this.parent.getFrozenRightRowsObject().length&&n.notify(pr,{rows:this.parent.getFrozenRightRowsObject(),args:{renderFrozenRightContent:!0}})):n.notify(pr,{rows:this.parent.getRowsObject().length?this.parent.getRowsObject():[new lr({isDataRow:!0,cells:[new pi({isDataCell:!0,visible:!0})]})]});n.selectRow(this.cellDetails.rowIndex);this.refreshRowIdx();n.editModule.resetMovableContentValidation();n.notify(tu,{});this.parent.notify(nf,{});i={requestType:"batchCancel",rows:this.parent.getRowsObject()};n.trigger(pr,i)}},n.prototype.removeBatchElementChanges=function(n,i){var f=this.parent,o=new oi(this.serviceLocator,null,this.parent),e=!1,r,u;return i&&(n.isDirty=i,r=f.getRowElementByUID(n.uid),r&&(r.classList.contains("e-insertedrow")?(t.remove(r),e=!0):(co(n,this.parent.getForeignKeyColumns(),n.data),delete n.changes,delete n.edit,n.isDirty=!1,t.classList(r,[],["e-hiddenrow","e-updatedtd"]),o.refresh(n,f.getColumns(),!1)),this.parent.aggregates.length>0)&&(u=[],u.type="cancel",this.parent.notify(nu,u),this.parent.groupSettings.columns.length>0&&this.parent.notify(uu,u))),e},n.prototype.removeHideAndSelection=function(n){if(n.classList.contains("e-hiddenrow")){n.removeAttribute("aria-selected");for(var r=[].slice.call(n.getElementsByClassName("e-selectionbackground")),i=0;i<r.length;i++)t.removeClass([r[parseInt(i.toString(),10)]],["e-selectionbackground","e-active"])}t.classList(n,[],["e-hiddenrow","e-updatedtd"])},n.prototype.deleteRecord=function(n,t){this.saveCell();this.validateFormObj()&&this.saveCell(!0);this.isAdded=!1;this.bulkDelete(n,t);this.parent.aggregates.length>0&&(this.parent.notify(nu,{}),this.parent.groupSettings.columns.length>0&&this.parent.notify(uu,{}))},n.prototype.addRecord=function(n){this.bulkAddRow(n)},n.prototype.endEdit=function(){this.parent.isEdit&&this.validateFormObj()||this.batchSave()},n.prototype.closeForm=function(){for(var t,n=0;n<Object.keys(this.originalCell).length;n++)for(t=0;t<Object.keys(this.cloneCell).length;t++)Object.keys(this.originalCell)[parseInt(n.toString(),10)]===Object.keys(this.cloneCell)[parseInt(t.toString(),10)]&&(this.cloneCell[Object.keys(this.cloneCell)[parseInt(t.toString(),10)]].replaceWith(this.originalCell[Object.keys(this.originalCell)[parseInt(n.toString(),10)]]),this.originalCell[Object.keys(this.originalCell)[parseInt(n.toString(),10)]].classList.contains("e-selectionbackground")&&this.originalCell[Object.keys(this.originalCell)[parseInt(n.toString(),10)]].classList.remove("e-selectionbackground","e-cellselectionbackground","e-active"));this.cloneCell={};this.originalCell={}},n.prototype.validateFormObj=function(){return this.parent.editModule.formObj&&!this.parent.editModule.formObj.validate()},n.prototype.batchSave=function(){var n=this.parent,u="deletedRecords",r,i,f,e;n.isCheckBoxSelection&&(r=n.element.querySelector(".e-checkselectall").parentElement,r.classList.contains("e-checkbox-disabled")&&n.pageSettings.totalRecordsCount>n.currentViewData.length&&t.removeClass([r],["e-checkbox-disabled"]));(this.saveCell(),n.isEdit||this.editNextValCell()||n.isEdit)||(i=this.getBatchChanges(),"Multiple"===this.parent.selectionSettings.type&&i[""+u].length&&this.parent.selectionSettings.persistSelection&&(i[""+u]=this.removeSelectedData,this.removeSelectedData=[]),f={changedRecords:this.parent.getRowsObject().filter(function(n){return n.isDirty&&-1===["add","delete"].indexOf(n.edit)}).map(function(n){return n.data})},e={batchChanges:i,cancel:!1},n.trigger(wd,e,function(t){t.cancel||(n.showSpinner(),n.notify(up,{changes:i,original:f}))}),n.editModule.resetMovableContentValidation())},n.prototype.getBatchChanges=function(){for(var n,t={addedRecords:[],deletedRecords:[],changedRecords:[]},i=0,r=this.parent.getRowsObject();i<r.length;i++)if(n=r[i],n.isDirty)switch(n.edit){case"add":t.addedRecords.push(n.changes);break;case"delete":t.deletedRecords.push(n.data);break;default:t.changedRecords.push(n.changes)}return t},n.prototype.removeRowObjectFromUID=function(n){for(var i=this.parent.getRowsObject(),t=0,r=i.length;t<r&&i[parseInt(t.toString(),10)].uid!==n;t++);vu(this.parent,function(n,i){i.splice(t,1)},nc(this.parent))},n.prototype.addRowObject=function(n,t){var i=this.parent,r="Top"===i.editSettings.newRowPosition;vu(this.parent,function(u,f){var e=n.clone();i.isFrozenGrid()?t===u&&(r?f.unshift(e):f.push(e)):r?f.unshift(e):f.push(e)},nc(this.parent),!0)},n.prototype.bulkDelete=function(n,i){var o=this;this.removeSelectedData=[];var r=this.parent,f=r.selectedRowIndex,u=r.getSelectedRows(),c={primaryKey:this.parent.getPrimaryKeyFieldNames(),rowIndex:f,rowData:i||r.getSelectedRecords()[0],cancel:!1};c.row=i?r.editModule.deleteRowUid?r.getRowElementByUID(r.editModule.deleteRowUid):r.getRows()[r.getCurrentViewRecords().indexOf(i)]:i?r.getRows()[parseInt(f.toString(),10)]:u[0];c.row&&r.trigger(pd,c,function(n){var c,l,v,y,a;if(!n.cancel){if(o.removeSelectedData=r.getSelectedRecords(),r.clearSelection(),n.row=n.row?n.row:i?r.getRows()[parseInt(f.toString(),10)]:u[0],o.parent.isFrozenGrid())for(i&&(f=parseInt(n.row.getAttribute(h),10),(u=[]).push(r.getRowByIndex(f)),u.push(r.getMovableRowByIndex(f)),r.getFrozenMode()===s&&u.push(r.getFrozenRightRowByIndex(f))),c=0;c<u.length;c++)l=u[parseInt(c.toString(),10)].getAttribute("data-uid"),u[parseInt(c.toString(),10)].classList.contains("e-insertedrow")?(o.removeRowObjectFromUID(l),t.remove(u[parseInt(c.toString(),10)])):((a=r.getRowObjectFromUID(l)).isDirty=!0,a.edit="delete",t.classList(u[parseInt(c.toString(),10)],["e-hiddenrow","e-updatedtd"],[]),r.frozenRows&&f<r.frozenRows&&r.getMovableDataRows().length>=r.frozenRows&&(r.getMovableHeaderTbody().appendChild(r.getMovableRowByIndex(r.frozenRows-1)),r.getFrozenHeaderTbody().appendChild(r.getRowByIndex(r.frozenRows-1)),r.getFrozenMode()===s&&r.getFrozenRightHeaderTbody().appendChild(r.getFrozenRightRowByIndex(r.frozenRows-1))),r.frozenRows&&f<r.frozenRows&&r.getDataRows().length>=r.frozenRows&&r.getHeaderTable().querySelector(e).appendChild(r.getRowByIndex(r.frozenRows-1))),delete u[parseInt(c.toString(),10)];else if(o.parent.isFrozenGrid()||1!==u.length&&!i)for(c=0;c<u.length;c++)v=u[parseInt(c.toString(),10)].getAttribute("data-uid"),u[parseInt(c.toString(),10)].classList.contains("e-insertedrow")?(o.removeRowObjectFromUID(v),t.remove(u[parseInt(c.toString(),10)])):(t.classList(u[parseInt(c.toString(),10)],["e-hiddenrow","e-updatedtd"],[]),y=r.getRowObjectFromUID(v),y.isDirty=!0,y.edit="delete",delete u[parseInt(c.toString(),10)]);else l=n.row.getAttribute("data-uid"),l=i&&o.parent.editModule.deleteRowUid?l=o.parent.editModule.deleteRowUid:l,n.row.classList.contains("e-insertedrow")?(o.removeRowObjectFromUID(l),t.remove(n.row)):((a=r.getRowObjectFromUID(l)).isDirty=!0,a.edit="delete",t.classList(n.row,["e-hiddenrow","e-updatedtd"],[])),delete n.row;o.refreshRowIdx();i&&(r.editModule.deleteRowUid=void 0,r.getSelectedRows().length&&(f=parseInt(r.getSelectedRows()[0].getAttribute(h),10)));r.isCheckBoxSelection||r.selectRow(f);r.trigger(ts,n);r.notify(ts,{rows:o.parent.getRowsObject()});r.notify(tu,{})}})},n.prototype.refreshRowIdx=function(){for(var i,n=this.parent.getAllDataRows(!0),r=drt(this.parent),u=nc(this.parent),o=function(t,e){n[parseInt(t.toString(),10)].classList.contains(y)&&!n[parseInt(t.toString(),10)].classList.contains("e-hiddenrow")?(vu(f.parent,function(n,i,r){i[parseInt(t.toString(),10)].setAttribute(h,e.toString());i[parseInt(t.toString(),10)].setAttribute(ne,(e+1).toString());r[parseInt(t.toString(),10)].index=e},r,null,u),e++):vu(f.parent,function(n,i,r){i[parseInt(t.toString(),10)].removeAttribute(h);i[parseInt(t.toString(),10)].removeAttribute(ne);r[parseInt(t.toString(),10)].index=-1},r,null,u);i=e},f=this,t=0,e=0,s=n.length;t<s;t++)o(t,e),e=i},n.prototype.getIndexFromData=function(n){return so(n,this.parent.getCurrentViewRecords())},n.prototype.bulkAddRow=function(n){var i=this,r=this.parent,f,u,s,h;if(r.editSettings.allowAdding){if(r.isEdit&&(this.saveCell(),this.parent.notify(cs,{})),!r.isEdit){if(this.initialRender){for(f=r.getVisibleColumns(),u=0;u<f.length;u++)f[parseInt(u.toString(),10)].validationRules&&f[parseInt(u.toString(),10)].validationRules.required&&(s={field:f[parseInt(u.toString(),10)].field.slice(),cellIdx:u},this.validationColObj.push(s));this.initialRender=!1}this.parent.element.classList.add("e-editing");h={defaultData:n||this.getDefaultData(),primaryKey:r.getPrimaryKeyFieldNames(),cancel:!1};r.trigger(yd,h,function(u){var p,f,nt,ht,et,w,ot,st,v;if(!u.cancel)if(i.isAdded=!0,r.clearSelection(),r.isFrozenGrid()){for(var b=i.parent.getMovableColumnsCount(),k=i.parent.getFrozenLeftCount(),tt=i.parent.getFrozenRightColumnsCount(),y=r.getContentTable().querySelector(e),it=b+k+tt,h=void 0,rt=[],ut=[],c=void 0,l=void 0,s=void 0,d=void 0,g=void 0,ft=0;ft<it;){for(p=new oi(i.serviceLocator,null,i.parent),f=new er(i.parent).generateRows([u.defaultData]),k>0?(h="frozen-left",it=(k=0)+tt+b):b>0?(h="movable",it=k+tt+(b=0)):(h="frozen-right",it=k+(tt=0)+b),nt=0;nt<f.length;nt++)f[parseInt(nt.toString(),10)].cells=gh(i.parent,f[parseInt(nt.toString(),10)].cells,h);for("frozen-left"===h?(s=p.render(f[0],r.getColumns())).classList.add("e-insertedrow"):"movable"===h?(d=p.render(f[0],r.getColumns())).classList.add("e-insertedrow"):(g=p.render(f[0],r.getColumns())).classList.add("e-insertedrow"),ht=0;ht<i.parent.groupSettings.columns.length;ht++)s.insertBefore(i.parent.createElement("td",{className:"e-indentcell"}),s.firstChild),f[0].cells.unshift(new pi({cellType:o.Indent}));y.querySelector(".e-emptyrow")&&((st=y.querySelector(".e-emptyrow")).parentNode.removeChild(st),i.removeFrozenTbody());"frozen-left"===h&&(y=r.frozenRows&&"Top"===r.editSettings.newRowPosition?r.getHeaderTable().querySelector(e):r.getContentTable().querySelector(e),"Top"===i.parent.editSettings.newRowPosition?(y.insertBefore(s,y.firstChild),t.addClass([].slice.call(s.getElementsByClassName(a)),["e-updatedtd"])):(y.appendChild(s),t.addClass([].slice.call(s.getElementsByClassName(a)),["e-updatedtd"])));"movable"!==h&&"frozen-right"!==h||i.renderFrozenAddRow(d,g,h);f[0].isDirty=!0;f[0].changes=t.extend({},{},f[0].data,!0);f[0].edit="add";i.addRowObject(f[0],h)}i.refreshRowIdx();i.focus.forgetPrevious();r.notify(du,{rows:i.parent.getRowsObject(),args:{isFrozen:i.parent.isFrozenGrid()}});et=i.getBatchChanges();w=i.getBottomIndex();"Top"===i.parent.editSettings.newRowPosition?r.selectRow(0):r.selectRow(w);n||(l=i.findNextEditableCell(0,!0),c=r.getColumns()[parseInt(l.toString(),10)],"Top"===i.parent.editSettings.newRowPosition?i.editCell(0,c.field,!0):i.editCell(w,c.field,!0));i.parent.aggregates.length>0&&(n||et[ar].length)&&i.parent.notify(nu,{});s&&(dh(d.querySelector("td:not(.e-hide)"),s.querySelector("td:not(.e-hide)")),rt.push(s),ut.push(s.cells));rt.push(d);ut.push(d.cells);g&&(rt.push(g),ut.push(g.cells));ot={defaultData:u.defaultData,row:rt,columnObject:c,columnIndex:l,primaryKey:u.primaryKey,cell:ut};r.trigger(du,ot)}else{for(p=new oi(i.serviceLocator,null,i.parent),f=new er(i.parent).generateRows([u.defaultData]),s=p.render(f[0],r.getColumns()),c=void 0,l=void 0,ft=0;ft<i.parent.groupSettings.columns.length;ft++)s.insertBefore(i.parent.createElement("td",{className:"e-indentcell"}),s.firstChild),f[0].cells.unshift(new pi({cellType:o.Indent}));v=r.getContentTable().querySelector(e);s.classList.add("e-insertedrow");v.querySelector(".e-emptyrow")&&((st=v.querySelector(".e-emptyrow")).parentNode.removeChild(st),i.removeFrozenTbody());v=r.frozenRows&&"Top"===r.editSettings.newRowPosition?r.getHeaderTable().querySelector(e):r.getContentTable().querySelector(e);"Top"===i.parent.editSettings.newRowPosition?v.insertBefore(s,v.firstChild):v.appendChild(s);t.addClass([].slice.call(s.getElementsByClassName(a)),["e-updatedtd"]);f[0].isDirty=!0;f[0].changes=t.extend({},{},f[0].data,!0);f[0].edit="add";i.addRowObject(f[0]);i.refreshRowIdx();i.focus.forgetPrevious();r.notify(du,{rows:i.parent.getRowsObject(),args:{isFrozen:i.parent.isFrozenGrid()}});et=i.getBatchChanges();w=i.getBottomIndex();"Top"===i.parent.editSettings.newRowPosition?r.selectRow(0):r.selectRow(w);n||(l=i.findNextEditableCell(0,!0),c=r.getColumns()[parseInt(l.toString(),10)],"Top"===i.parent.editSettings.newRowPosition?i.editCell(0,c.field,!0):i.editCell(w,c.field,!0));i.parent.aggregates.length>0&&(n||et[ar].length)&&i.parent.notify(nu,{});ot={defaultData:u.defaultData,row:s,columnObject:c,columnIndex:l,primaryKey:u.primaryKey,cell:t.isNullOrUndefined(l)?void 0:s.cells[parseInt(l.toString(),10)]};r.trigger(du,ot)}})}}else r.isEdit&&this.saveCell()},n.prototype.renderFrozenAddRow=function(n,i,r){var f,o,u=this.parent;"movable"===r&&(f=u.frozenRows&&"Top"===u.editSettings.newRowPosition?this.parent.getMovableHeaderTbody():this.parent.getContent().querySelector(".e-movablecontent").querySelector(e),"Top"===u.editSettings.newRowPosition?f.insertBefore(n,f.firstChild):f.appendChild(n),t.addClass([].slice.call(n.getElementsByClassName(a)),["e-updatedtd"]));"frozen-right"===r&&(o=u.frozenRows&&"Top"===u.editSettings.newRowPosition?this.parent.getFrozenRightHeaderTbody():this.parent.getContent().querySelector(".e-frozen-right-content").querySelector(e),"Top"===u.editSettings.newRowPosition?o.insertBefore(i,o.firstChild):o.appendChild(i),t.addClass([].slice.call(i.getElementsByClassName(a)),["e-updatedtd"]),dh(i.querySelector("td:not(.e-hide)"),n.querySelector("td:not(.e-hide)")));"auto"===u.height&&u.notify(ke,{})},n.prototype.removeFrozenTbody=function(){var n=this.parent,t,i;n.isFrozenGrid()&&(t=n.getContent().querySelector("."+p).querySelector(e),(t.firstElementChild.parentNode.removeChild(t.firstElementChild),n.getFrozenMode()===s)&&(i=n.getContent().querySelector(".e-frozen-right-content").querySelector(e),i.firstElementChild.parentNode.removeChild(i.firstElementChild)))},n.prototype.renderMovable=function(n,t){var i=n.cloneNode(!0),f=this.parent.getMovableColumnsCount(),r=this.parent.getFrozenLeftCount(),u=this.parent.getFrozenRightColumnsCount();return vv(n,0,r),vv(i,r,u?i.children.length-u:i.children.length),vv(t,r+f,t.children.length),i},n.prototype.findNextEditableCell=function(n,i,r){for(var e,f=this.parent.getColumns(),o=f.length,u=n;u<o;u++)if((e=!!r&&t.isNullOrUndefined(f[parseInt(u.toString(),10)].validationRules),!i&&this.checkNPCell(f[parseInt(u.toString(),10)]))||i&&(!f[parseInt(u.toString(),10)].template||f[parseInt(u.toString(),10)].field)&&f[parseInt(u.toString(),10)].visible&&(!f[parseInt(u.toString(),10)].isIdentity||!f[parseInt(u.toString(),10)].isPrimaryKey)&&!e)return u;return-1},n.prototype.checkNPCell=function(n){return!n.template&&n.visible&&!n.isPrimaryKey&&!n.isIdentity&&n.allowEditing},n.prototype.getDefaultData=function(){for(var n,r={},f={number:0,string:null,boolean:!1,date:null,datetime:null},i=0,u=this.parent.columnModel;i<u.length;i++)n=u[i],n.field&&t.setValue(n.field,Object.keys(n).indexOf("defaultValue")>=0?n.defaultValue:f[n.type],r);return r},n.prototype.setCellIdx=function(n){var t=0;this.parent.allowGrouping&&(t=this.parent.groupSettings.columns.length);this.cellDetails.cellIndex=n.cellIndex-t;this.cellDetails.rowIndex=parseInt(n.getAttribute("index"),10)},n.prototype.editCell=function(n,t,i){var r=this.parent,f=r.getColumnByField(t),u;this.index=n;this.field=t;this.isAdd=i;u=r.isEdit&&!(this.cellDetails.column.field===t&&this.cellDetails.rowIndex===n&&this.parent.getDataRows().length-1!==n&&this.prevEditedBatchCell);r.editSettings.allowEditing&&(!u&&(f.allowEditing||!f.allowEditing&&r.focusModule.active&&r.focusModule.active.getTable().rows[this.crtRowIndex]&&r.focusModule.active.getTable().rows[this.crtRowIndex].classList.contains("e-insertedrow"))?this.editCellExtend(n,t,i):u&&(this.editNext=!0,this.saveCell()))},n.prototype.editCellExtend=function(n,i,r){var e=this,f=this.parent,u=f.getColumnByField(i),a=f.getPrimaryKeyFieldNames(),o,l,s;if(!f.isEdit)if(s=t.extend({},{},this.getDataByIndex(n),!0),"movable"===u.getFreezeTableName()||u.getFreezeTableName()===d?(o="movable"===u.getFreezeTableName()?f.getMovableDataRows()[parseInt(n.toString(),10)]:f.getFrozenRightDataRows()[parseInt(n.toString(),10)],l=this.parent.getRowObjectFromUID(o.getAttribute("data-uid")),s=l.changes?t.extend({},{},l.changes,!0):s):(o=f.getDataRows()[parseInt(n.toString(),10)],s=t.extend({},{},this.getDataByIndex(n),!0)),a[0]===u.field&&!o.classList.contains("e-insertedrow")||u.columns||u.isPrimaryKey&&u.isIdentity||u.commands)this.parent.isLastCellPrimaryKey=!0;else{this.parent.isLastCellPrimaryKey=!1;this.parent.element.classList.add("e-editing");var v=f.getRowObjectFromUID(o.getAttribute("data-uid")),c=[].slice.apply(o.cells),h={columnName:u.field,isForeignKey:!t.isNullOrUndefined(u.foreignKeyValue),primaryKey:a,rowData:s,validationRules:t.extend({},u.validationRules?u.validationRules:{}),value:ut(u.field,s),type:r?"add":"edit",cancel:!1,foreignKeyData:v&&v.foreignKeyData};h.cell=c[this.getColIndex(c,this.getCellIdx(u.uid))];h.row=o;h.columnObject=u;h.cell&&f.trigger(kd,h,function(i){i.cancel||(i.cell=i.cell?i.cell:c[e.getColIndex(c,e.getCellIdx(u.uid))],i.row=i.row?i.row:o,i.columnObject=i.columnObject?i.columnObject:u,i.columnObject.index=t.isNullOrUndefined(i.columnObject.index)?0:i.columnObject.index,e.cellDetails={rowData:s,column:u,value:i.value,isForeignKey:i.isForeignKey,rowIndex:n,cellIndex:parseInt(i.cell.getAttribute(lt),10),foreignKeyData:i.foreignKeyData},i.cell.classList.contains("e-updatedtd")&&(e.isColored=!0,i.cell.classList.remove("e-updatedtd")),f.isEdit=!0,f.clearSelection(),f.isCheckBoxSelection&&f.isPersistSelection||f.selectRow(e.cellDetails.rowIndex,!0),e.renderer.update(i),e.parent.notify(yn,i),e.form=t.select("#"+f.element.id+"EditForm",f.element),f.editModule.applyFormValidation([u]),e.parent.element.querySelector(".e-gridpopup").style.display="none")})}},n.prototype.updateCell=function(n,t,i){var e=this.parent,r=e.getColumnByField(t),c=e.getColumnIndexByField(t),u,f,o,s,h;r&&!r.isPrimaryKey&&r.allowEditing&&(u=yv(this.parent,r,n,c),f="movable"===r.getFreezeTableName()?this.parent.getMovableRowsObject()[parseInt(n.toString(),10)]:r.getFreezeTableName()===d?e.getFrozenRightRowsObject()[parseInt(n.toString(),10)]:e.getRowObjectFromUID(u.parentElement.getAttribute("data-uid")),this.refreshTD(u,r,f,i),o=this.parent.parentDetails&&this.parent.parentDetails.parentInstObj&&this.parent.parentDetails.parentInstObj.isReact,(this.parent.isReact&&this.parent.requireTemplateRef||o&&this.parent.parentDetails.parentInstObj.requireTemplateRef)&&r.template?(s=this,h=this.newReactTd,s.parent.renderTemplates(function(){s.parent.trigger(cf,{cell:h||u,column:r,data:f.changes})})):(this.parent.isReact||o)&&r.template?(this.parent.renderTemplates(),this.parent.trigger(cf,{cell:this.newReactTd||u,column:r,data:f.changes})):this.parent.trigger(cf,{cell:this.newReactTd||u,column:r,data:f.changes}))},n.prototype.setChanges=function(n,i,r){var f,a,e,o,c,l;this.parent.isFrozenGrid()?(a=this.parent.getRowElementByUID(n.uid),e=parseInt(a.getAttribute(h),10),(f=this.parent.getRowsObject()[parseInt(e.toString(),10)]).changes||(f.changes=t.extend({},{},n.data,!0)),t.isNullOrUndefined(i)||t.setValue(i,r,f.changes),o=this.parent.getMovableRowsObject()[parseInt(e.toString(),10)],(o.changes=t.extend({},{},f.changes,!0),n.data[""+i]!==r&&(o.isDirty=!0,f.isDirty=!0),this.parent.getFrozenMode()===s)&&(c=this.parent.getFrozenRightRowsObject()[parseInt(e.toString(),10)],c.changes=t.extend({},{},f.changes,!0),n.data[""+i]!==r&&(c.isDirty=!0))):(n.changes||(n.changes=t.extend({},{},n.data,!0)),t.isNullOrUndefined(i)||("string"==typeof r&&(r=this.parent.sanitize(r)),u.DataUtil.setValue(i,r,n.changes)),n.data[""+i]!==r)&&(l=this.parent.getColumnByField(i).type,"date"===l||"datetime"===l?new Date(n.data[""+i]).toString()!==new Date(r).toString()&&(n.isDirty=!0):n.isDirty=!0)},n.prototype.updateRow=function(n,t){for(var u,i=0,r=Object.keys(t);i<r.length;i++)u=r[i],this.updateCell(n,u,t[""+u])},n.prototype.getCellIdx=function(n){var i=this.parent.getColumnIndexByUid(n)+this.parent.groupSettings.columns.length;return t.isNullOrUndefined(this.parent.detailTemplate)&&t.isNullOrUndefined(this.parent.childGrid)||i++,this.parent.isRowDragable()&&i++,i},n.prototype.refreshTD=function(n,i,r,u){var h,c=new si(this.parent,this.serviceLocator),o,s,f,e;u="number"!==i.type||t.isNullOrUndefined(u)?u:parseFloat(u);this.setChanges(r,i.field,u);f=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();f=f&&this.parent.isRowDragable()?f+1:f;co(r,this.parent.getForeignKeyColumns(),r.changes);h=f&&"movable"===i.getFreezeTableName()&&this.parent.getColumns().length===r.cells.length?r.cells.slice(f,r.cells.length):r.cells;this.parent.isReact&&(o=n.parentElement,s=n.cellIndex);e=0;f&&(e="movable"===i.getFreezeTableName()&&"Right"!==this.parent.getFrozenMode()?f:i.getFreezeTableName()===d?this.parent.getFrozenLeftColumnsCount()+this.parent.getMovableColumnsCount():e);c.refreshTD(n,h[this.getCellIdx(i.uid)-e],r.changes,{index:this.getCellIdx(i.uid)});this.parent.isReact?(this.newReactTd=o.cells[parseInt(s.toString(),10)],o.cells[parseInt(s.toString(),10)].classList.add("e-updatedtd")):n.classList.add("e-updatedtd");n.classList.add("e-updatedtd");this.parent.notify(tu,{})},n.prototype.getColIndex=function(n,i){var u=0,r;for(this.parent.allowGrouping&&this.parent.groupSettings.columns&&(u=this.parent.groupSettings.columns.length),t.isNullOrUndefined(this.parent.detailTemplate)&&t.isNullOrUndefined(this.parent.childGrid)||u++,this.parent.isRowDragable()&&u++,r=0;r<n.length;r++)if(parseInt(n[parseInt(r.toString(),10)].getAttribute(lt),10)===i-u)return r;return-1},n.prototype.editNextValCell=function(){var n=this.parent,u=n.element.querySelectorAll(".e-insertedrow"),s=1===u.length||(n.getFrozenColumns()>0||n.getFrozenRightColumnsCount()>0||n.getFrozenLeftColumnsCount()>0)&&(2===u.length||3===u.length),l,i,a,f,h,r,o,t;if(s&&this.isAdded&&!n.isEdit){for(l=this.getBottomIndex(),i=this.cellDetails.cellIndex;i<n.getColumns().length;i++){if(n.isEdit)return;a=this.findNextEditableCell(this.cellDetails.cellIndex+1,!0,!0);f=n.getColumns()[parseInt(a.toString(),10)];f&&("Bottom"===this.parent.editSettings.newRowPosition?this.editCell(l,f.field,!0):(h={index:0,column:f},this.parent.notify(htt,h),this.editCell(h.index,f.field,!0)),this.saveCell())}n.isEdit||(this.isAdded=!1)}else if(s||!this.isAdded||n.isEdit||n.isFrozenGrid()){if(!s&&this.isAdded&&!n.isEdit&&n.isFrozenGrid()){var v=n.getFrozenLeftContentTbody()?n.getFrozenLeftContentTbody().querySelectorAll(".e-insertedrow"):void 0,y=n.getFrozenRightContentTbody()?n.getFrozenRightContentTbody().querySelectorAll(".e-insertedrow"):void 0,c=n.getMovableContentTbody().querySelectorAll(".e-insertedrow"),e=(r=0,n.getVisibleFrozenLeftCount()?n.getVisibleFrozenLeftCount():n.getFrozenColumns()),w=n.getVisibleFrozenRightCount(),p=n.getVisibleMovableCount();for("Bottom"===n.editSettings.newRowPosition?(o=this.getBatchChanges(),r=n.getCurrentViewRecords().length-o[eu].length):"Top"===n.editSettings.newRowPosition&&n.frozenRows&&(v=n.getFrozenHeaderTbody()?n.getFrozenHeaderTbody().querySelectorAll(".e-insertedrow"):void 0,y=n.getFrozenRightHeader()?n.getFrozenRightHeader().querySelectorAll(".e-insertedrow"):void 0,c=n.getMovableHeaderTbody().querySelectorAll(".e-insertedrow")),i=0;i<c.length&&!n.isEdit;i++,r++)for(t=0;t<this.validationColObj.length&&!n.isEdit;t++)e&&this.validationColObj[parseInt(t.toString(),10)].cellIdx<e?""===v[parseInt(i.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(t.toString(),10)].cellIdx].innerText&&(this.editCell(r,this.validationColObj[parseInt(t.toString(),10)].field),n.editModule.formObj.validate()&&this.saveCell()):w&&p<=this.validationColObj[parseInt(t.toString(),10)].cellIdx?""===y[parseInt(i.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(t.toString(),10)].cellIdx-(p+e)].innerText&&(this.editCell(r,this.validationColObj[parseInt(t.toString(),10)].field),n.editModule.formObj.validate()&&this.saveCell()):""===c[parseInt(i.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(t.toString(),10)].cellIdx-e].innerText&&(this.editCell(r,this.validationColObj[parseInt(t.toString(),10)].field),n.editModule.formObj.validate()&&this.saveCell());n.isEdit||(this.isAdded=!1)}}else{for(r=0,"Bottom"===n.editSettings.newRowPosition&&(o=this.getBatchChanges(),r=n.getCurrentViewRecords().length-o[eu].length),i=0;i<u.length&&!n.isEdit;i++,r++)for(t=0;t<this.validationColObj.length&&!n.isEdit;t++)""===u[parseInt(i.toString(),10)].querySelectorAll("td")[this.validationColObj[parseInt(t.toString(),10)].cellIdx].innerText&&(this.editCell(r,this.validationColObj[parseInt(t.toString(),10)].field),this.validateFormObj()&&this.saveCell());n.isEdit||(this.isAdded=!1)}},n.prototype.escapeCellEdit=function(){var n=this.generateCellArgs();n.value=n.previousValue;!n.value&&this.cellDetails.column.validationRules||this.successCallBack(n,n.cell.parentElement,n.column,!0)(n)},n.prototype.generateCellArgs=function(){var o=this.parent,n,u,i,e,f,r;return this.parent.element.classList.remove("e-editing"),n=this.cellDetails.column,u={},u[n.field]=ut(n.field,this.cellDetails.rowData),i=o.editModule.getCurrentEditedData(this.form,u),e=t.extend({},i),i=t.extend({},i,this.cellDetails.rowData),f=ut(n.field,e),t.isNullOrUndefined(n.field)||t.isUndefined(f)||t.setValue(n.field,f,i),r={columnName:n.field,value:ut(n.field,i),rowData:this.cellDetails.rowData,column:n,previousValue:this.cellDetails.value,isForeignKey:this.cellDetails.isForeignKey,cancel:!1},r.cell=this.form.parentElement,r.columnObject=n,r},n.prototype.saveCell=function(n){var i;if(!this.preventSaveCell&&this.form&&(i=this.parent,n||i.isEdit&&!this.validateFormObj())){this.preventSaveCell=!0;var t=this.generateCellArgs(),r=t.cell.parentElement,u=t.column;n?this.successCallBack(t,r,u)(t):(i.trigger(dd,t,this.successCallBack(t,r,u)),i.notify(ln,{formObj:this.form}))}},n.prototype.successCallBack=function(n,r,u,f){var e=this;return function(n){var o=e.parent,h,l,a,c;if(n.cell=n.cell?n.cell:e.form.parentElement,n.columnObject=n.columnObject?n.columnObject:u,n.columnObject.index=t.isNullOrUndefined(n.columnObject.index)?0:n.columnObject.index,n.cancel){if(e.preventSaveCell=!1,e.editNext){if(e.editNext=!1,e.cellDetails.rowIndex===e.index&&e.cellDetails.column.field===e.field)return;e.editCellExtend(e.index,e.field,e.isAdd)}}else{if(o.editModule.destroyWidgets([u]),o.isEdit=!1,o.editModule.destroyForm(),e.parent.notify(nf,{}),h=i(n.cell,p)||i(n.cell,w)?o.getRowObjectFromUID(r.getAttribute("data-uid"),!0):o.getRowObjectFromUID(r.getAttribute("data-uid")),(o.getFrozenMode()===s&&(i(n.cell,"e-frozen-right-header")||i(n.cell,"e-frozen-right-content"))&&(h=o.getRowObjectFromUID(r.getAttribute("data-uid"),!1,!0)),e.refreshTD(n.cell,u,h,n.value),e.parent.isReact&&(n.cell=e.newReactTd),t.removeClass([r],[ni,"e-batchrow"]),t.removeClass([n.cell],["e-editedbatchcell","e-boolcell"]),(!t.isNullOrUndefined(n.value)&&n.value.toString()===(t.isNullOrUndefined(e.cellDetails.value)?"":e.cellDetails.value).toString()&&!e.isColored||t.isNullOrUndefined(n.value)&&t.isNullOrUndefined(h.data[u.field])&&t.isNullOrUndefined(e.cellDetails.value)&&!n.cell.parentElement.classList.contains("e-insertedrow"))&&n.cell.classList.remove("e-updatedtd"),t.isNullOrUndefined(f))&&(l=o.isReact&&u.template&&"string"!=typeof u.template,a=o.parentDetails&&o.parentDetails.parentInstObj&&o.parentDetails.parentInstObj.isReact,l||a?o.requireTemplateRef?o.renderTemplates(function(){o.trigger(vc,n)}):(o.renderTemplates(),o.trigger(vc,n)):o.trigger(vc,n)),o.notify(tu,{}),e.isColored=!1,e.parent.aggregates.length>0&&(e.parent.notify(nu,{}),e.parent.groupSettings.columns.length>0&&!e.isAddRow(e.cellDetails.rowIndex)&&e.parent.notify(uu,{})),e.preventSaveCell=!1,e.editNext){if(e.editNext=!1,e.cellDetails.rowIndex===e.index&&e.cellDetails.column.field===e.field&&e.prevEditedBatchCell)return;c=o.getColumnByField(e.field);c&&(c.allowEditing||!c.allowEditing&&o.focusModule.active&&o.focusModule.active.getTable().rows[e.crtRowIndex]&&o.focusModule.active.getTable().rows[e.crtRowIndex].classList.contains("e-insertedrow"))&&e.editCellExtend(e.index,e.field,e.isAdd)}f&&o.notify(tf,{})}}},n.prototype.prevEditedBatchCellMatrix=function(){var i=[],r=this.parent,n=r.focusModule.active?r.focusModule.active.getTable().querySelector(".e-editedbatchcell"):void 0,t;return n&&(t=n.parentElement,i=[[].slice.call(this.parent.focusModule.active.getTable().rows).indexOf(t),[].slice.call(t.cells).indexOf(n)]),i},n.prototype.getDataByIndex=function(n){var t=this.parent.getRowObjectFromUID(this.parent.getDataRows()[parseInt(n.toString(),10)].getAttribute("data-uid"));return t.changes?t.changes:t.data},n.prototype.keyDownHandler=function(n){var u,f,e;if(this.addBatchRow||("tab"===n.action||"shiftTab"===n.action)&&this.parent.isEdit){var t=this.parent,o=this.getBottomIndex(),r=i(n.target,a);(this.addBatchRow||r)&&(u=r?r.querySelector(".e-field"):void 0,(this.addBatchRow||u)&&(f=this.parent.getVisibleColumns(),e="tab"===n.action?f.length-1:0,(this.addBatchRow||f[parseInt(e.toString(),10)].field===u.getAttribute("id").slice(this.parent.element.id.length))&&(this.cellDetails.rowIndex===o&&"tab"===n.action?("Top"===t.editSettings.newRowPosition?(t.editSettings.newRowPosition="Bottom",this.addRecord(),t.editSettings.newRowPosition="Top"):this.addRecord(),this.addBatchRow=!1):this.saveCell())))}},n.prototype.addCancelWhilePaging=function(){this.validateFormObj()&&(this.parent.notify(nl,{}),this.parent.isEdit=!1,this.isColored=!1)},n.prototype.getBottomIndex=function(){var n=this.getBatchChanges();return this.parent.getCurrentViewRecords().length+n[ar].length-n[eu].length-1},n}(),uct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),fft=function(n){function t(t,i,r){var u=n.call(this,t,i)||this;return u.parent=t,u.serviceLocator=i,u.renderer=r,u}return uct(t,n),t.prototype.closeEdit=function(){n.prototype.closeEdit.call(this)},t.prototype.addRecord=function(t,i){n.prototype.addRecord.call(this,t,i)},t.prototype.endEdit=function(){n.prototype.endEdit.call(this)},t.prototype.updateRow=function(t,i){n.prototype.updateRow.call(this,t,i)},t.prototype.deleteRecord=function(t,i){n.prototype.deleteRecord.call(this,t,i)},t.prototype.startEdit=function(t){n.prototype.startEdit.call(this,t)},t}(fk),fct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ok=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return fct(i,n),i.prototype.write=function(n){this.edit=this.parent.editModule;"datepickeredit"===n.column.editType?this.obj=new se.DatePicker(t.extend(eft(n,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),n.column.edit.params)):"datetimepickeredit"===n.column.editType&&(this.obj=new se.DateTimePicker(t.extend(eft(n,this.parent.editSettings.mode,this.parent.enableRtl,this.parent.cssClass,this),n.column.edit.params)));this.obj.appendTo(n.element)},i}(gr);var oct=function(){function n(n){this.parent=n}return n.prototype.read=function(n,t){return t},n.prototype.write=function(){},n.prototype.destroy=function(){},n}(),sct=function(){function n(n,t){this.editType={Inline:ek,Normal:ek,Batch:uft,Dialog:fft};this.isValidationApplied=!1;this.editCellDialogClose=!1;this.parent=n;this.serviceLocator=t;this.l10n=this.serviceLocator.getService("localization");this.addEventListener();this.updateEditObj();this.createAlertDlg();this.createConfirmDlg()}return n.prototype.updateColTypeObj=function(){for(var r=this.parent.columnModel,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].edit=this.parent.editSettings.template||r[parseInt(i.toString(),10)].editTemplate?t.extend(new n.editCellType.templateedit(this.parent),r[parseInt(i.toString(),10)].edit||{}):t.extend(new n.editCellType[r[parseInt(i.toString(),10)].editType&&n.editCellType[r[parseInt(i.toString(),10)].editType]?r[parseInt(i.toString(),10)].editType:"defaultedit"](this.parent,this.serviceLocator),r[parseInt(i.toString(),10)].edit||{});this.parent.log("primary_column_missing")},n.prototype.getModuleName=function(){return"edit"},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName())for(var t=this.parent,i=0,r=Object.keys(n.properties);i<r.length;i++)switch(r[i]){case"allowAdding":case"allowDeleting":case"allowEditing":(t.editSettings.allowAdding||t.editSettings.allowEditing||t.editSettings.allowDeleting)&&this.initialEnd();break;case"mode":this.updateEditObj();t.isEdit=!1;t.refresh()}},n.prototype.updateEditObj=function(){this.editModule&&this.editModule.destroy();this.renderer=new gut(this.parent,this.serviceLocator);this.editModule=new this.editType[this.parent.editSettings.mode](this.parent,this.serviceLocator,this.renderer)},n.prototype.initialEnd=function(){this.updateColTypeObj()},n.prototype.startEdit=function(n){var t=this.parent,i;if(t.editSettings.allowEditing&&!t.isEdit&&"Batch"!==t.editSettings.mode){if(this.parent.element.classList.add("e-editing"),t.getSelectedRows().length)n||(n=t.getSelectedRows()[0]);else if(!n)return void this.showDialog("EditOperationAlert",this.alertDObj);this.parent.enableVirtualization&&"Normal"===this.parent.editSettings.mode&&(i=parseInt(n.getAttribute("data-rowindex"),10),n=this.parent.getRowByIndex(i));this.isLastRow=n.rowIndex===this.parent.getContent().querySelector("tr:last-child").rowIndex;"none"!==n.style.display&&(this.editModule.startEdit(n),this.refreshToolbar(),t.element.querySelector(".e-gridpopup").style.display="none",this.parent.notify("start-edit",{}))}},n.prototype.checkLastRow=function(n,i){var r=this.isLastRow;"auto"!==this.parent.height&&"Bottom"===this.parent.editSettings.newRowPosition&&i&&"add"===i.requestType&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight?t.addClass([].slice.call(n.getElementsByClassName(a)),"e-lastrowadded"):r&&n&&n.classList&&t.addClass([].slice.call(n.getElementsByClassName(a)),"e-lastrowcell")},n.prototype.closeEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&this.parent.element.getElementsByClassName("e-updatedtd").length?this.showDialog("CancelEdit",this.dialogObj):(this.parent.element.classList.remove("e-editing"),this.editModule.closeEdit(),this.refreshToolbar(),this.parent.notify(cw,{}))},n.prototype.refreshToolbar=function(){this.parent.notify(tu,{})},n.prototype.addRecord=function(n,t){if(this.parent.editSettings.allowAdding){var i={startEdit:!0};n||this.parent.notify(ys,i);i.startEdit&&(this.parent.element.classList.add("e-editing"),this.editModule.addRecord(n,t),this.refreshToolbar(),this.parent.notify("start-add",{}))}},n.prototype.deleteRecord=function(n,i){var r=this.parent;r.editSettings.allowDeleting&&(i||r.getSelectedRecords().length||!t.isNullOrUndefined(r.commandDelIndex)?r.editSettings.showDeleteConfirmDialog?this.showDialog("ConfirmDelete",this.dialogObj):this.editModule.deleteRecord(n,i):this.showDialog("DeleteOperationAlert",this.alertDObj))},n.prototype.deleteRow=function(n){this.deleteRowUid=n.getAttribute("data-uid");var i=this.parent.getRowObjectFromUID(this.deleteRowUid);t.isNullOrUndefined(i)||this.deleteRecord(null,i.data)},n.prototype.endEdit=function(){"Batch"===this.parent.editSettings.mode&&this.parent.editSettings.showConfirmDialog&&(t.isNullOrUndefined(this.formObj)||this.formObj.validate())&&(this.parent.editModule.saveCell(),this.parent.notify(cs,{}),t.isNullOrUndefined(this.formObj)||this.formObj.validate())?this.showDialog("BatchSaveConfirm",this.dialogObj):this.endEditing()},n.prototype.updateCell=function(n,t,i){this.editModule.updateCell(n,t,i)},n.prototype.updateRow=function(n,t){this.editModule.updateRow(n,t)},n.prototype.batchCancel=function(){this.closeEdit()},n.prototype.batchSave=function(){this.endEdit()},n.prototype.editCell=function(n,t){this.editModule.editCell(n,t)},n.prototype.editFormValidate=function(){var n=!this.formObj||this.formObj.validate(),t=!this.mFormObj||this.mFormObj.validate(),i=!this.frFormObj||this.frFormObj.validate();return n&&t&&i},n.prototype.getBatchChanges=function(){return this.editModule.getBatchChanges?this.editModule.getBatchChanges():{}},n.prototype.getCurrentEditCellData=function(){var n=this.getCurrentEditedData(this.formObj.element,{});return n[Object.keys(n)[0]]},n.prototype.saveCell=function(){this.editModule.saveCell()},n.prototype.endEditing=function(){this.parent.element.classList.remove("e-editing");this.editModule.endEdit();this.refreshToolbar()},n.prototype.showDialog=function(n,t){t.content="<div>"+this.l10n.getConstant(n)+"<\/div>";t.dataBind();t.show()},n.prototype.getValueFromType=function(n,t){var i=t;switch(n.type){case"number":i=isNaN(parseFloat(t))?null:parseFloat(t);break;case"boolean":"booleanedit"!==n.editType&&(i=t===this.l10n.getConstant("True")||!0===t);break;case"date":case"datetime":"datepickeredit"!==n.editType&&"datetimepickeredit"!==n.editType&&t&&t.length?i=new Date(t):""===t&&(i=null);break;case"dateonly":i=t&&(t=new Date(t))?t.getFullYear()+"-"+lu(t.getMonth()+1)+"-"+lu(t.getDate()):null}return i},n.prototype.destroyToolTip=function(){for(var r,n=0,i=[].slice.call(this.parent.element.getElementsByClassName("e-griderror"));n<i.length;n++)r=i[n],t.remove(r);this.parent.getContent().firstElementChild.style.position="relative"},n.prototype.createConfirmDlg=function(){this.dialogObj=this.dlgWidget([{click:this.dlgOk.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-primary "+this.parent.cssClass:"e-primary",isPrimary:!0}},{click:this.dlgCancel.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",content:this.l10n.getConstant("CancelButton")}}],"EditConfirm")},n.prototype.createAlertDlg=function(){this.alertDObj=this.dlgWidget([{click:this.alertClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),cssClass:this.parent.cssClass?"e-flat "+this.parent.cssClass:"e-flat",isPrimary:!0}}],"EditAlert")},n.prototype.alertClick=function(){this.alertDObj.hide()},n.prototype.dlgWidget=function(n,t){var u=this.parent.createElement("div",{id:this.parent.element.id+t}),r,i;return this.parent.element.appendChild(u),r={showCloseIcon:!1,isModal:!0,visible:!1,closeOnEscape:!0,target:this.parent.element,width:"320px",animationSettings:{effect:"None"},cssClass:this.parent.cssClass?this.parent.cssClass:""},r.buttons=n,i=new bt.Dialog(r),i.isStringTemplate=!0,i.appendTo(u),i},n.prototype.dlgCancel=function(){this.parent.focusModule.clearIndicator();this.parent.focusModule.restoreFocus();this.dialogObj.hide();this.parent.notify("cancelcnfrmDlg",{})},n.prototype.dlgOk=function(){switch(this.dialogObj.element.querySelector(".e-dlg-content").firstElementChild.innerText){case this.l10n.getConstant("ConfirmDelete"):this.editModule.deleteRecord();break;case this.l10n.getConstant("CancelEdit"):this.editModule.closeEdit();break;case this.l10n.getConstant("BatchSaveConfirm"):this.endEditing();break;case this.l10n.getConstant("BatchSaveLostChanges"):"Batch"===this.parent.editSettings.mode&&this.editModule.addCancelWhilePaging();this.executeAction()}this.dlgCancel()},n.prototype.destroyEditComponents=function(){this.parent.isEdit&&(this.destroyWidgets(),this.destroyForm());this.destroy()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.eventDetails=[{event:gt,handler:this.onPropertyChanged},{event:dt,handler:this.initialEnd},{event:ht,handler:this.keyPressHandler},{event:gu,handler:this.updateColTypeObj},{event:nf,handler:this.destroyToolTip},{event:ci,handler:this.preventBatch},{event:nl,handler:this.destroyForm},{event:v,handler:this.destroyEditComponents}],vt(this.parent,this.eventDetails,!0,this),this.actionBeginFunction=this.onActionBegin.bind(this),this.actionCompleteFunction=this.actionComplete.bind(this),this.onDataBoundFunction=this.onDataBound.bind(this),this.parent.addEventListener(nt,this.actionBeginFunction),this.parent.addEventListener(l,this.actionCompleteFunction),this.parent.addEventListener(ti,this.onDataBoundFunction))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(vt(this.parent,this.eventDetails,!1),this.parent.removeEventListener(l,this.actionCompleteFunction),this.parent.removeEventListener(nt,this.actionBeginFunction),this.parent.removeEventListener(ti,this.onDataBoundFunction))},n.prototype.onDataBound=function(){this.resetMovableContentValidation()},n.prototype.actionComplete=function(n){["add","beginEdit","save","delete","cancel","filterafteropen","filterchoicerequest"].indexOf(n.requestType)<0&&(this.parent.isEdit=!1);"batchsave"===n.requestType&&this.parent.focusModule.restoreFocus();this.refreshToolbar()},n.prototype.getCurrentEditedData=function(n,r){var a=this.parent,e,f,c,h,v,y,l;if(a.editSettings.template){for(e=[].slice.call(n.elements),f=0;f<e.length;f++)if((e[parseInt(f.toString(),10)].hasAttribute("name")&&"e-multi-hidden"!==e[parseInt(f.toString(),10)].className||e[parseInt(f.toString(),10)].classList.contains("e-multiselect"))&&("hidden"!==e[parseInt(f.toString(),10)].type||!i(e[parseInt(f.toString(),10)],"e-switch-wrapper")&&!i(e[parseInt(f.toString(),10)],"e-checkbox-wrapper"))){var b=e[parseInt(f.toString(),10)].hasAttribute("name")?ah(e[parseInt(f.toString(),10)].getAttribute("name")):ah(e[parseInt(f.toString(),10)].getAttribute("id")),s=a.getColumnByField(b)||{field:b,type:e[parseInt(f.toString(),10)].getAttribute("type")},o=void 0;"checkbox"===s.type||"boolean"===s.type?o=e[parseInt(f.toString(),10)].checked:e[parseInt(f.toString(),10)].value?(o=e[parseInt(f.toString(),10)].value,e[parseInt(f.toString(),10)].ej2_instances&&e[parseInt(f.toString(),10)].ej2_instances.length&&!t.isNullOrUndefined(e[parseInt(f.toString(),10)].ej2_instances[0].value)&&(e[parseInt(f.toString(),10)].blur(),o=e[parseInt(f.toString(),10)].ej2_instances[0].value)):e[parseInt(f.toString(),10)].ej2_instances&&(o=e[parseInt(f.toString(),10)].ej2_instances[0].value);s.edit&&"string"==typeof s.edit.read?o=t.getValue(s.edit.read,window)(e[parseInt(f.toString(),10)],o):s.edit&&s.edit.read&&(o=s.edit.read(e[parseInt(f.toString(),10)],o));o=a.editModule.getValueFromType(s,o);"radio"===e[parseInt(f.toString(),10)].type?e[parseInt(f.toString(),10)].checked&&u.DataUtil.setValue(s.field,o,r):("string"==typeof o&&this.parent.sanitize(o),u.DataUtil.setValue(s.field,o,r))}return r}for(c=a.columnModel.filter(function(n){return n.editTemplate}),h=0;h<c.length;h++)if(n[wt(c[parseInt(h.toString(),10)].field)])for(v=[].slice.call(n[wt(c[parseInt(h.toString(),10)].field)]),y=(v=v.length?v:[n[wt(c[parseInt(h.toString(),10)].field)]]).filter(function(n){return!t.isNullOrUndefined(n.ej2_instances)}),0===y.length&&(y=v.filter(function(n){return n.hasAttribute("name")})),f=0;f<y.length;f++)o=this.getValue(c[parseInt(h.toString(),10)],y[parseInt(f.toString(),10)],r),"string"===c[parseInt(h.toString(),10)].type&&(o=this.parent.sanitize(o)),u.DataUtil.setValue(c[parseInt(h.toString(),10)].field,o,r);for(var w=[].slice.call(n.getElementsByClassName("e-field")),p=0,k=w.length;p<k;p++)l=a.getColumnByUid(w[parseInt(p.toString(),10)].getAttribute("e-mappinguid")),l&&l.field&&(o=this.getValue(l,w[parseInt(p.toString(),10)],r),"string"===l.type&&(o=this.parent.sanitize(o)),u.DataUtil.setValue(l.field,o,r));return r},n.prototype.getValue=function(n,i,r){var u=i.ej2_instances?i.ej2_instances[0].value:i.value,e=this.parent,f=n.edit.read;return"checkbox"!==n.type&&"boolean"!==n.type||(u=i.checked),"string"==typeof f?(f=t.getValue(f,window),u=e.editModule.getValueFromType(n,f(i,u))):u=e.editModule.getValueFromType(n,n.edit.read(i,u)),t.isNullOrUndefined(r[n.field])&&""===u&&(u=r[n.field]),u},n.prototype.onActionBegin=function(n){var t,u,r,f;if("columnstate"===n.requestType&&this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode)this.closeEdit();else{if(t=this.parent.element.querySelector("."+ni),u=this.parent.element.querySelector("."+ui),t&&this.parent.frozenRows&&"virtualscroll"===n.requestType&&parseInt(i(t,y).getAttribute(h),10)<this.parent.frozenRows)return;r=-1===["filterafteropen","filterbeforeopen","filterchoicerequest","filtersearchbegin","save","infiniteScroll","virtualscroll"].indexOf(n.requestType);f=this.parent.enableVirtualization&&this.formObj&&!this.formObj.isDestroyed&&(t||u||"cancel"===n.requestType)&&r;(!this.parent.enableVirtualization&&"Batch"!==this.parent.editSettings.mode&&this.formObj&&!this.formObj.isDestroyed&&r&&!n.cancel||f)&&(this.destroyWidgets(),this.destroyForm())}},n.prototype.destroyWidgets=function(n){var u,o,f,e,r,i;for(this.parent.editSettings.template&&(this.parent.destroyTemplate(["editSettingsTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),(n=n||this.parent.getCurrentVisibleColumns(this.parent.enableColumnVirtualization)).some(function(n){return!t.isNullOrUndefined(n.editTemplate)})&&(this.parent.destroyTemplate(["editTemplate"]),this.parent.isReact&&this.parent.renderTemplates()),u=0,o=n;u<o.length;u++)f=o[u],e=f.edit.destroy,f.edit.destroy&&("string"==typeof e?(e=t.getValue(e,window))():f.edit.destroy());for(r=[].slice.call(this.formObj.element.elements),i=0;i<r.length;i++)r[parseInt(i.toString(),10)].hasAttribute("name")&&r[parseInt(i.toString(),10)].ej2_instances&&r[parseInt(i.toString(),10)].ej2_instances.length&&!r[parseInt(i.toString(),10)].ej2_instances[0].isDestroyed&&r[parseInt(i.toString(),10)].ej2_instances[0].destroy()},n.prototype.destroyForm=function(){this.destroyToolTip();for(var t=[this.formObj,this.mFormObj,this.frFormObj,this.virtualFormObj],n=0;n<t.length;n++)t[parseInt(n.toString(),10)]&&t[parseInt(n.toString(),10)].element&&!t[parseInt(n.toString(),10)].isDestroyed&&t[parseInt(n.toString(),10)].destroy();this.destroyToolTip()},n.prototype.destroy=function(){var i=this.parent.element,r,n;i&&(r=!(!i.querySelector("."+ct)||!i.querySelector("."+ot)),r&&this.destroyForm(),this.removeEventListener(),n=this.dialogObj.element,n.childElementCount>0&&(this.dialogObj.destroy(),t.remove(n)),(n=this.alertDObj.element).childElementCount>0&&(this.alertDObj.destroy(),t.remove(n)),r&&this.editModule&&this.editModule.destroy())},n.prototype.keyPressHandler=function(n){switch(n.action){case"insert":this.addRecord();break;case"delete":"INPUT"===n.target.tagName&&!n.target.classList.contains("e-checkselect")||document.querySelector(".e-popup-open.e-edit-dialog")||this.deleteRecord();break;case"f2":this.startEdit();break;case"enter":!i(n.target,"e-unboundcelldiv")&&"Batch"!==this.parent.editSettings.mode&&(i(n.target,ot)||this.parent.frozenRows&&i(n.target,st))&&!document.getElementsByClassName("e-popup-open").length&&(n.preventDefault(),this.endEdit());break;case"escape":this.parent.isEdit&&!this.editCellDialogClose&&("Batch"===this.parent.editSettings.mode?this.editModule.escapeCellEdit():this.curretRowFocus(n));this.editCellDialogClose&&(this.editCellDialogClose=!1);break;case"tab":case"shiftTab":this.curretRowFocus(n)}},n.prototype.curretRowFocus=function(n){var u,e,l,a,v,y,o,p,s,h;if(this.parent.isEdit&&"Batch"!==this.parent.editSettings.mode&&(u=i(n.target,"e-editedrow")||i(n.target,"e-addedrow"),u)){var f=u.classList.contains("e-addedrow")?"e-addedrow":"e-editedrow",r=[].slice.call(u.querySelectorAll(".e-input:not(.e-disabled)")),c=[].slice.call(u.querySelectorAll(".e-unboundcell"));if(c)for(e=0;e<c.length;e++)r=r.concat([].slice.call(c[parseInt(e.toString(),10)].querySelectorAll(".e-btn:not(.e-hide)")));this.parent.isFrozenGrid()&&(t.isNullOrUndefined(this.parent.frozenRows)||t.isNullOrUndefined(i(n.target,"e-frozenheader"))&&t.isNullOrUndefined(i(n.target,"e-movableheader"))?(l=this.parent.getContent().querySelector(".e-movablecontent ."+f),(r.push.apply(r,[].slice.call(l.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode())&&(a=this.parent.getContent().querySelector(".e-frozen-right-content ."+f),r.push.apply(r,[].slice.call(a.querySelectorAll(".e-input:not(.e-disabled)"))))):(v=this.parent.getHeaderContent().querySelector(".e-movableheader ."+f),(r.push.apply(r,[].slice.call(v.querySelectorAll(".e-input:not(.e-disabled)"))),"Left-Right"===this.parent.getFrozenMode()||"Right"===this.parent.getFrozenMode())&&(y=this.parent.getHeaderContent().querySelector(".e-frozen-right-header ."+f),r.push.apply(r,[].slice.call(y.querySelectorAll(".e-input:not(.e-disabled)"))))));o=i(n.target,"e-rowcell");(o!==i(r[r.length-1],"e-rowcell")||"tab"!==n.action||o.classList.contains("e-unboundcell"))&&(o!==i(r[0],"e-rowcell")||"shiftTab"!==n.action)&&"escape"!==n.action||(p=u.getAttribute("data-uid"),s=this.parent.getRows(),"Left-Right"!==this.parent.getFrozenMode()&&"Right"!==this.parent.getFrozenMode()||(s=this.parent.getFrozenRightRows()),(this.parent.getFrozenColumns()||"Left"===this.parent.getFrozenMode())&&(s=this.parent.getMovableRows()),h=s.map(function(n){return n.getAttribute("data-uid")}).indexOf(p),this.parent.frozenRows&&i(u,"e-content")&&(h-=this.parent.frozenRows),u.classList.contains("e-addedrow")&&(h=0),"escape"===n.action?this.closeEdit():this.endEdit(),this.parent.focusModule.active&&(this.parent.focusModule.active.matrix.current=[h,0]))}},n.prototype.preventBatch=function(n){this.preventObj=n;this.showDialog("BatchSaveLostChanges",this.dialogObj)},n.prototype.executeAction=function(){this.preventObj.handler.call(this.preventObj.instance,this.preventObj.arg1,this.preventObj.arg2,this.preventObj.arg3,this.preventObj.arg4,this.preventObj.arg5,this.preventObj.arg6,this.preventObj.arg7,this.preventObj.arg8)},n.prototype.applyFormValidation=function(n,i){var r=this.parent,a=r.isFrozenGrid(),h="Normal"===this.parent.editSettings.mode,v="Right"===this.parent.getFrozenMode()&&h?1:0,y="Dialog"!==this.parent.editSettings.mode?r.element.getElementsByClassName("e-gridform")[parseInt(v.toString(),10)]:t.select("#"+r.element.id+"_dialogEdit_wrapper .e-gridform",document),c="Right"===this.parent.getFrozenMode()&&h?0:1,p=r.element.getElementsByClassName("e-gridform")[parseInt(c.toString(),10)],f={},e={},o={},u,l;for(n=n||r.getColumns(),u=0;u<n.length;u++)(n[parseInt(u.toString(),10)].visible||"Dialog"===r.editSettings.mode&&(-1!==r.groupSettings.columns.indexOf(n[parseInt(u.toString(),10)].field)||"Dialog"!==r.editSettings.mode))&&n[parseInt(u.toString(),10)].validationRules&&t.isNullOrUndefined(i)&&ab(n[parseInt(u.toString(),10)],c,f,e,o,n.length);a&&"Dialog"!==this.parent.editSettings.mode?(this.parent.editModule.mFormObj=this.createFormObj(p,e),this.parent.getFrozenMode()===s)&&(l=r.element.getElementsByClassName("e-gridform")[2],this.parent.editModule.frFormObj=this.createFormObj(l,o)):f=t.extend(f,e,o);this.parent.editModule.formObj=this.createFormObj(y,i||f)},n.prototype.createFormObj=function(n,t){var i=this;return new kr.FormValidator(n,{rules:t,locale:this.parent.locale,validationComplete:function(n){i.validationComplete(n)},customPlacement:function(n,t){var r=n.getAttribute("e-mappinguid"),u={column:i.parent.getColumnByUid(r),error:t,inputElement:n,value:n.value};i.valErrorPlacement(n,t);i.parent.notify(bn,u)}})},n.prototype.valErrorPlacement=function(n,t){if(this.parent.isEdit){var i=t.getAttribute("for"),r=this.getElemTable(n).querySelector("#"+lh(i)+"_Error");r?r.querySelector(".e-tip-content").innerHTML=t.outerHTML:this.createTooltip(n,t,i,"")}},n.prototype.getElemTable=function(n){var f,r,i=this.parent,e,u;return"Dialog"!==i.editSettings.mode?(f=i.frozenRows&&i.frozenRows>(parseInt(t.closest(n,"."+y).getAttribute(h),10)||0),e=n.name,u=void 0,e&&(u=wb(this.parent,ah(e))),u&&i.isFrozenGrid()?"frozen-left"===u.getFreezeTableName()?r=f?i.getFrozenVirtualHeader().querySelector("table"):i.getFrozenVirtualContent().querySelector("table"):"frozen-right"===u.getFreezeTableName()?r=f?i.getFrozenRightHeader().querySelector("table"):i.getFrozenRightContent().querySelector("table"):"movable"===u.getFreezeTableName()&&(r=f?i.getMovableVirtualHeader().querySelector("table"):i.getMovableVirtualContent().querySelector("table")):r=f?i.getHeaderTable():i.getContentTable()):r=t.select("#"+i.element.id+"_dialogEdit_wrapper",document),r},n.prototype.resetElemPosition=function(n,t){var f=i(t.element,a),r,u,e;f&&(r=f.getBoundingClientRect().right,u=n.getBoundingClientRect().right,u>r&&(e=u-r,n.style.left=n.offsetLeft-e+"px"))},n.prototype.validationComplete=function(n){if(this.parent.isEdit){var t=this.getElemTable(n.element).querySelector("#"+lh(n.inputName)+"_Error");t&&("failure"===n.status?(t.style.display="",this.resetElemPosition(t,n)):t.style.display="none")}},n.prototype.resetMovableContentValidation=function(){if(this.isValidationApplied&&this.parent.getMovableVirtualContent()&&!this.parent.enableVirtualization&&!this.parent.enableInfiniteScrolling){var n=this.parent.getContent().querySelector("."+p);n.style.overflowX="auto";n.style.overflowY="hidden";this.isValidationApplied=!1}},n.prototype.createTooltip=function(n,r,u,f){var fi=this.parent.getColumnByField(u),vt=this.parent.getFrozenMode()===s&&"Normal"===this.parent.editSettings.mode&&fi.getFreezeTableName()===d?this.frFormObj.element:this.formObj.element,ft=i(n,"e-virtual-validation"),c,v,ot,b,ct,lt,dt,gt,at,ni,ti,ii,ri;ft&&(vt=this.virtualFormObj.element);c=this.parent.getContent().firstElementChild;v=this.parent.getFrozenColumns()||this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount();v&&(c=this.parent.getMovableVirtualContent());var et,it,yt=c.scrollHeight>c.clientHeight||c.scrollWidth>c.clientWidth,g="Dialog"!==this.parent.editSettings.mode,ei=t.closest(n,"."+a),rt=t.closest(n,"."+y),pt=this.parent.getContent().querySelector("."+wi),wt=!1,kt=!1,oi="Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstElementChild.offsetHeight>this.parent.getContentTable().scrollHeight,nt=Math.round(this.parent.getContent().clientHeight/this.parent.getRowHeight())-1,w=pt?[].slice.call(this.parent.getFrozenVirtualContent().getElementsByClassName(y)):[].slice.call(this.parent.getContent().getElementsByClassName(y));("Batch"===this.parent.editSettings.mode&&nt>1&&w.length>=nt&&!oi&&w[w.length-1].getAttribute(h)===rt.getAttribute(h)&&(kt=!0),g)&&(this.parent.frozenRows&&(ot=v?this.parent.getFrozenVirtualHeader().querySelector(e).children:this.parent.getHeaderTable().querySelector(e).children,wt=(et=ot.length>(parseInt(rt.getAttribute(h),10)||0))&&parseInt(rt.getAttribute(h),10)===ot.length-1),(wt||nt>1&&w.length>=nt&&("Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType||ei.classList.contains("e-lastrowcell")&&!rt.classList.contains(ui))||kt)&&(it=!0));var st=g?et?this.parent.getHeaderTable():this.parent.getContentTable():t.select("#"+this.parent.element.id+"_dialogEdit_wrapper .e-dlg-content",document),ut=st.getBoundingClientRect(),ht=g?this.parent.element.getBoundingClientRect().left:ut.left,tt=t.closest(n,"td"),l=tt?tt.getBoundingClientRect():n.parentElement.getBoundingClientRect(),o=this.parent.createElement("div",{className:"e-tooltip-wrap e-lib e-control e-popup e-griderror",id:u+"_Error",styles:"display:"+f+";top:"+((et?l.top+l.height:l.bottom-ut.top-(v?pt.scrollTop:0))+st.scrollTop+9)+"px;left:"+(l.left-ht+st.scrollLeft+l.width/2)+"px;max-width:"+l.width+"px;text-align:center;"});this.parent.cssClass&&o.classList.add(this.parent.cssClass);g&&ut.left<ht&&(o.style.left=parseInt(o.style.left,10)-ut.left+ht+"px");ct=this.parent.createElement("div",{className:"e-tip-content"});(ct.appendChild(r),it?((b=this.parent.createElement("div",{className:"e-arrow-tip e-tip-bottom"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-bottom"})),b.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-bottom"}))):((b=this.parent.createElement("div",{className:"e-arrow-tip e-tip-top"})).appendChild(this.parent.createElement("div",{className:"e-arrow-tip-outer e-tip-top"})),b.appendChild(this.parent.createElement("div",{className:"e-arrow-tip-inner e-tip-top"}))),o.appendChild(ct),o.appendChild(b),ft||!v&&!this.parent.frozenRows||"Dialog"===this.parent.editSettings.mode?ft?this.virtualFormObj.element.appendChild(o):this.formObj.element.appendChild(o):(("Normal"===this.parent.editSettings.mode?t.closest(n,".e-editcell"):t.closest(n,"."+k)).style.position="relative",o.style.position="absolute","Batch"===this.parent.editSettings.mode||t.closest(n,"."+wi)||t.closest(n,"."+fr)||this.parent.frozenRows&&!v?vt.appendChild(o):this.mFormObj.element.appendChild(o)),!it&&g&&c.getBoundingClientRect().bottom<l.bottom+l.height)&&(lt=this.parent.getContent().querySelector(".e-content"),v&&0===this.parent.currentViewData.length&&0===lt.scrollTop?lt.scrollTop=o.offsetHeight+b.scrollHeight:c.scrollTop=c.scrollTop+o.offsetHeight+b.scrollHeight);dt=parseInt(document.defaultView.getComputedStyle(o,null).getPropertyValue("font-size"),10);(o.getBoundingClientRect().width<l.width&&o.querySelector("label").getBoundingClientRect().height/(1.2*dt)>=2&&(o.style.width=o.style.maxWidth),o.style.left=(v||this.parent.frozenRows)&&"Dialog"!==this.parent.editSettings.mode?tt.offsetLeft+(tt.offsetWidth/2-o.offsetWidth/2)+"px":parseInt(o.style.left,10)-o.offsetWidth/2+"px",g&&!yt&&!this.parent.allowPaging||v||this.parent.frozenRows)&&(c.style.position="static",gt=bt.calculateRelativeBasedPosition(tt,o),o.style.top=gt.top+l.height+9+"px");!t.closest(n,"."+p)||this.parent.enableVirtualization||this.parent.enableInfiniteScrolling||(at=this.parent.getContent().querySelector("."+p),at.style.overflowX="visible",at.style.overflowY="visible",this.isValidationApplied=!0);it&&(!yt||v||"auto"===this.parent.height||this.parent.frozenRows||this.parent.enableVirtualization?o.style.bottom=l.height+9+"px":(ni=c.scrollWidth>c.offsetWidth?hu():0,ti=-1===this.parent.height.toString().indexOf("%")?parseInt(this.parent.height,10):c.offsetHeight,o.style.bottom=ti-c.querySelector("table").offsetHeight-ni+l.height+9+"px"),w.length<nt&&"Bottom"===this.parent.editSettings.newRowPosition&&this.editModule.args&&"add"===this.editModule.args.requestType&&(ii=(this.parent.frozenRows?this.parent.frozenRows+(w.length-1):w.length-1)*this.parent.getRowHeight(),ri=this.parent.getContent().clientHeight-ii,o.style.bottom=ri+9+"px"),o.style.top=null)},n.prototype.checkColumnIsGrouped=function(n){return!(n.visible||this.parent.groupSettings.columns.indexOf(n.field)>-1)},n.AddEditors=function(i){n.editCellType=t.extend(n.editCellType,i)},n.editCellType={dropdownedit:tft,numericedit:ift,datepickeredit:ok,datetimepickeredit:ok,booleanedit:nft,defaultedit:rft,templateedit:oct},n}(),hct=function(){function n(n,i){this.showColumn=[];this.hideColumn=[];this.changedColumns=[];this.unchangedColumns=[];this.isDlgOpen=!1;this.initialOpenDlg=!0;this.stateChangeColumns=[];this.changedStateColumns=[];this.isInitialOpen=!1;this.isCustomizeOpenCC=!1;this.searchOperator="startswith";this.prevShowedCols=[];this.hideDialogFunction=this.hideDialog.bind(this);this.parent=n;this.serviceLocator=i;this.addEventListener();this.cBoxTrue=fi.createCheckBox(this.parent.createElement,!1,{checked:!0,label:" "});this.cBoxFalse=fi.createCheckBox(this.parent.createElement,!1,{checked:!1,label:" "});this.cBoxTrue.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox","aria-checked":"true"}}),this.cBoxTrue.firstChild);this.cBoxFalse.insertBefore(this.parent.createElement("input",{className:"e-chk-hidden e-cc e-cc-chbox",attrs:{type:"checkbox","aria-checked":"false"}}),this.cBoxFalse.firstChild);this.cBoxFalse.querySelector(".e-frame").classList.add("e-uncheck");this.parent.enableRtl&&t.addClass([this.cBoxTrue,this.cBoxFalse],["e-rtl"]);this.parent.cssClass&&t.addClass([this.cBoxTrue,this.cBoxFalse],[this.parent.cssClass])}return n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.removeEventListener(),this.unWireEvents(),t.isNullOrUndefined(this.dlgObj)||!this.dlgObj.element||this.dlgObj.isDestroyed||this.dlgObj.destroy())},n.prototype.rtlUpdate=function(){this.parent.enableRtl?t.addClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"]):t.removeClass([].slice.call(this.innerDiv.getElementsByClassName("e-checkbox-wrapper")),["e-rtl"])},n.prototype.addEventListener=function(){this.parent.isDestroyed||(t.EventHandler.add(document,"click",this.clickHandler,this),this.parent.on(tt,this.enableAfterRenderEle,this),this.parent.on(dt,this.render,this),this.parent.addEventListener(ti,this.hideDialogFunction),this.parent.on(v,this.destroy,this),this.parent.on(ul,this.rtlUpdate,this),this.parent.on(dl,this.onResetColumns,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(t.EventHandler.remove(document,"click",this.clickHandler),this.parent.off(dt,this.render),this.parent.off(v,this.destroy),this.parent.off(tt,this.enableAfterRenderEle),this.parent.off(ul,this.rtlUpdate),this.parent.off(dl,this.onResetColumns),this.parent.removeEventListener(ti,this.hideDialogFunction))},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.renderDlgContent();this.getShowHideService=this.serviceLocator.getService("showHideService")},n.prototype.clickHandler=function(n){var i=n.target;if(!this.isCustomizeOpenCC){if(t.isNullOrUndefined(t.closest(i,".e-cc"))&&t.isNullOrUndefined(t.closest(i,".e-cc-toolbar")))t.isNullOrUndefined(this.dlgObj)||!this.dlgObj.visible||i.classList.contains("e-toolbar-items")||(this.dlgObj.hide(),this.clearActions(),this.refreshCheckboxState(),this.isDlgOpen=!1);else if(i.classList.contains("e-columnchooser-btn")||i.classList.contains("e-cc-toolbar")){if(this.initialOpenDlg&&this.dlgObj.visible||!this.isDlgOpen)return void(this.isDlgOpen=!0)}else i.classList.contains("e-cc-cancel")&&(i.parentElement.querySelector(".e-ccsearch").value="",this.columnChooserSearch(""),this.removeCancelIcon(),this.refreshCheckboxButton());(this.parent.detailTemplate||this.parent.childGrid)&&(this.targetdlg=n.target)}this.isCustomizeOpenCC&&n.target.classList.contains("e-cc-cancel")&&this.refreshCheckboxState();this.rtlUpdate()},n.prototype.hideDialog=function(){!t.isNullOrUndefined(this.dlgObj)&&this.dlgObj.visible&&(this.dlgObj.hide(),this.isDlgOpen=!1)},n.prototype.renderColumnChooser=function(n,i,r){var f;if(this.dlgObj.visible||!this.parent.detailTemplate&&!this.parent.childGrid||this.hideOpenedDialog(),this.dlgObj.visible)this.hideDialog(),this.addcancelIcon(),this.clearActions(),this.refreshCheckboxState();else{if(this.beforeOpenColumnChooserEvent().cancel)return;r&&(this.targetdlg=r);this.refreshCheckboxState();this.dlgObj.dataBind();this.dlgObj.element.style.maxHeight="430px";f=this.dlgObj.element.style.display;this.dlgObj.element.style.display="block";var o=this.parent.getHeaderContent().classList.contains("e-sticky"),e=t.closest(r,".e-toolbar-item"),u=void 0;o?(u=e.getBoundingClientRect(),this.dlgObj.element.classList.add("e-sticky")):(this.dlgObj.element.classList.remove("e-sticky"),u=bt.calculateRelativeBasedPosition(e,this.dlgObj.element));this.dlgObj.element.style.display=f;this.dlgObj.element.style.top=u.top+t.closest(r,".e-cc-toolbar").getBoundingClientRect().height+"px";t.isNullOrUndefined(t.closest(r,".e-bigger"))||(this.dlgObj.width=258);t.Browser.isDevice?(this.dlgObj.target=document.body,this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition(),this.dlgObj.open=this.mOpenDlg.bind(this)):this.dlgObj.element.style.left=this.parent.enableRtl?r.offsetLeft+"px":u.left-250+t.closest(r,".e-cc-toolbar").clientWidth+2+"px";this.removeCancelIcon();this.dlgObj.show();this.parent.notify(cn,{dialog:this.dlgObj})}this.rtlUpdate()},n.prototype.openColumnChooser=function(n,i){this.isCustomizeOpenCC=!0;this.dlgObj.visible?this.hideDialog():this.beforeOpenColumnChooserEvent().cancel||(this.isInitialOpen?this.refreshCheckboxState():(this.dlgObj.content=this.renderChooserList(),this.updateIntermediateBtn()),this.dlgObj.dataBind(),this.dlgObj.position={X:"center",Y:"center"},t.isNullOrUndefined(n)?(this.dlgObj.position={X:"center",Y:"center"},this.dlgObj.refreshPosition()):(this.dlgObj.element.style.top="",this.dlgObj.element.style.left="",this.dlgObj.element.style.top=i+"px",this.dlgObj.element.style.left=n+"px"),this.dlgObj.beforeOpen=this.customDialogOpen.bind(this),this.dlgObj.show(),this.isInitialOpen=!0,this.dlgObj.beforeClose=this.customDialogClose.bind(this))},n.prototype.enableAfterRenderEle=function(n){n.module===this.getModuleName()&&n.enable&&this.render()},n.prototype.keyUpHandler=function(n){"Escape"===n.key&&this.hideDialog();this.setFocus(i(n.target,"e-cclist"))},n.prototype.setFocus=function(n){var t=this.dlgDiv.querySelector(".e-colfocus");t&&t.classList.remove("e-colfocus");n&&n.classList.add("e-colfocus")},n.prototype.customDialogOpen=function(){var n=this.dlgObj.content.querySelector("input.e-ccsearch");t.EventHandler.add(n,"keyup",this.columnChooserManualSearch,this)},n.prototype.customDialogClose=function(){var n=this.dlgObj.content.querySelector("input.e-ccsearch");t.EventHandler.remove(n,"keyup",this.columnChooserManualSearch)},n.prototype.getColumns=function(){return this.parent.getColumns().filter(function(n){return"checkbox"!==n.type&&!0===n.showInColumnChooser||"checkbox"===n.type&&void 0!==n.field})},n.prototype.renderDlgContent=function(){this.dlgDiv=this.parent.createElement("div",{className:"e-ccdlg e-cc",id:this.parent.element.id+"_ccdlg"});this.dlgDiv.setAttribute("aria-label",this.l10n.getConstant("ColumnChooserDialogARIA"));this.parent.element.appendChild(this.dlgDiv);this.dlgObj=new bt.Dialog({header:this.l10n.getConstant("ChooseColumns"),showCloseIcon:!1,closeOnEscape:!1,locale:this.parent.locale,visible:!1,enableRtl:this.parent.enableRtl,target:document.getElementById(this.parent.element.id),buttons:[{click:this.confirmDlgBtnClick.bind(this),buttonModel:{content:this.l10n.getConstant("OKButton"),isPrimary:!0,cssClass:this.parent.cssClass?"e-cc e-cc_okbtn "+this.parent.cssClass:"e-cc e-cc_okbtn"}},{click:this.clearBtnClick.bind(this),buttonModel:{cssClass:this.parent.cssClass?"e-flat e-cc e-cc-cnbtn "+this.parent.cssClass:"e-flat e-cc e-cc-cnbtn",content:this.l10n.getConstant("CancelButton")}}],content:this.renderChooserList(),width:250,cssClass:this.parent.cssClass?"e-cc "+this.parent.cssClass:"e-cc",animationSettings:{effect:"None"}});this.dlgObj.isStringTemplate=!0;this.dlgObj.appendTo(this.dlgDiv);this.wireEvents()},n.prototype.renderChooserList=function(){var r;this.mainDiv=this.parent.createElement("div",{className:"e-main-div e-cc"});var n=this.parent.createElement("div",{className:"e-cc-searchdiv e-cc e-input-group"}),t=this.parent.createElement("input",{className:"e-ccsearch e-cc e-input",attrs:{placeholder:this.l10n.getConstant("Search"),cssClass:this.parent.cssClass}}),u=this.parent.createElement("span",{className:"e-ccsearch-icon e-icons e-cc e-input-group-icon",attrs:{title:this.l10n.getConstant("Search")}}),i=this.parent.createElement("div",{className:"e-cc-contentdiv"});return this.innerDiv=this.parent.createElement("div",{className:"e-innerdiv e-cc"}),n.appendChild(t),n.appendChild(u),this.searchBoxObj=new eit(t),r=this.refreshCheckboxList(this.parent.getColumns()),this.innerDiv.appendChild(r),i.appendChild(this.innerDiv),this.mainDiv.appendChild(n),this.mainDiv.appendChild(i),this.mainDiv},n.prototype.confirmDlgBtnClick=function(n){this.stateChangeColumns=[];this.changedStateColumns=[];this.changedColumns=this.changedColumns.length>0?this.changedColumns:this.unchangedColumns;this.changedColumnState(this.changedColumns);var i=this.ulElement.querySelector(".e-uncheck")&&this.ulElement.querySelectorAll(".e-uncheck:not(.e-selectall)").length;t.isNullOrUndefined(n)||i<this.parent.getColumns().length&&(this.hideColumn.length&&this.columnStateChange(this.hideColumn,!1),this.showColumn.length&&this.columnStateChange(this.showColumn,!0),this.getShowHideService.setVisible(this.stateChangeColumns,this.changedStateColumns),this.clearActions(),this.parent.notify(nf,{module:"edit"}),0===this.parent.getCurrentViewRecords().length&&this.parent.element.querySelector(".e-emptyrow").querySelector("td").setAttribute("colSpan",this.parent.getVisibleColumns().length.toString()))},n.prototype.onResetColumns=function(n){"columnstate"!==n.requestType||this.resetColumnState()},n.prototype.resetColumnState=function(){this.showColumn=[];this.hideColumn=[];this.hideDialog()},n.prototype.changedColumnState=function(n){for(var i,r,t=0;t<n.length;t++)i=n[parseInt(t.toString(),10)],r=this.parent.getColumnByUid(i),this.changedStateColumns.push(r)},n.prototype.columnStateChange=function(n,t){for(var u,r,i=0;i<n.length;i++)u=n[parseInt(i.toString(),10)],r=this.parent.getColumnByUid(u),"checkbox"!==r.type&&(r.visible=t),this.stateChangeColumns.push(r)},n.prototype.clearActions=function(){this.resetColumnState();this.addcancelIcon()},n.prototype.clearBtnClick=function(){this.clearActions();this.parent.notify(dn,{dialog:this.dlgObj})},n.prototype.checkstatecolumn=function(n,t,i){void 0===i&&(i=!1);var r=this.parent.getColumnByUid(t);n?(-1!==this.hideColumn.indexOf(t)&&this.hideColumn.splice(this.hideColumn.indexOf(t),1),-1!==this.showColumn.indexOf(t)||r&&r.visible||this.showColumn.push(t)):(-1!==this.showColumn.indexOf(t)&&this.showColumn.splice(this.showColumn.indexOf(t),1),-1===this.hideColumn.indexOf(t)&&r&&r.visible&&this.hideColumn.push(t));i?n?this.unchangedColumns.push(t):this.changedColumns.push(t):-1!==this.changedColumns.indexOf(t)?this.changedColumns.splice(this.changedColumns.indexOf(t),1):this.changedColumns.push(t)},n.prototype.columnChooserSearch=function(n){var i,t,f=!1,e=this.dlgDiv.querySelector(".e-footer-content"),o=this.ulElement.querySelector(".e-check")&&this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,r;(this.isInitialOpen=!0,e&&(t=e.querySelector(".e-btn").ej2_instances[0]),""===n?(this.removeCancelIcon(),i=this.getColumns(),f=!0):i=new u.DataManager(this.getColumns()).executeLocal((new u.Query).where("headerText",this.searchOperator,n,!0,this.parent.columnChooserSettings.ignoreAccent)),i.length)?(this.innerDiv.innerHTML=" ",this.innerDiv.classList.remove("e-ccnmdiv"),this.innerDiv.appendChild(this.refreshCheckboxList(i)),f?t&&o&&(t.disabled=!1):(this.addcancelIcon(),this.refreshCheckboxButton())):(r=this.parent.createElement("span",{className:"e-cc e-nmatch"}),r.innerHTML=this.l10n.getConstant("Matchs"),this.innerDiv.innerHTML=" ",this.innerDiv.appendChild(r),this.innerDiv.classList.add("e-ccnmdiv"),t&&(t.disabled=!0));this.flag=!0;this.stopTimer()},n.prototype.wireEvents=function(){t.EventHandler.add(this.dlgObj.element,"click",this.checkBoxClickHandler,this);t.EventHandler.add(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch,this);t.EventHandler.add(this.dlgObj.element,"keyup",this.keyUpHandler,this);this.searchBoxObj.wireEvent()},n.prototype.unWireEvents=function(){this.parent.isDestroyed||(this.dlgObj.element&&(t.EventHandler.remove(this.dlgObj.element,"click",this.checkBoxClickHandler),t.EventHandler.remove(this.dlgObj.element,"keyup",this.keyUpHandler)),t.EventHandler.remove(this.searchBoxObj.searchBox,"keyup",this.columnChooserManualSearch),this.searchBoxObj.unWireEvent())},n.prototype.checkBoxClickHandler=function(n){var u,t=i(n.target,"e-checkbox-wrapper"),e,f,r;if(t){if(t.querySelector(".e-selectall")?this.updateSelectAll(!t.querySelector(".e-check")):hb(t.parentElement),t.querySelector(".e-chk-hidden").focus(),t.querySelector(".e-check"))u=!0,t.firstChild.setAttribute("aria-checked","true");else{if(!t.querySelector(".e-uncheck"))return;u=!1;t.firstChild.setAttribute("aria-checked","false")}if(this.updateIntermediateBtn(),e=i(t,"e-ccheck").getAttribute("uid"),f=this.parent.getColumns(),"grid-selectAll"===e)for(this.changedColumns=[],this.unchangedColumns=[],r=0;r<f.length;r++)f[parseInt(r.toString(),10)].showInColumnChooser&&this.checkstatecolumn(u,f[parseInt(r.toString(),10)].uid,!0);else this.checkstatecolumn(u,e);this.refreshCheckboxButton();this.setFocus(i(n.target,"e-cclist"))}},n.prototype.updateIntermediateBtn=function(){var e=this.ulElement.children.length-1,n=[],i=this.ulElement.children[0].querySelector(".e-frame"),f=this.ulElement.querySelectorAll(".e-check:not(.e-selectall)").length,r=this.dlgObj.btnObj[0],u=i.parentElement.querySelector("input");r.disabled=!1;e===f?(n=["e-check"],u.setAttribute("aria-checked","true")):f?(n=["e-stop"],u.setAttribute("aria-checked","mixed")):(n=["e-uncheck"],u.setAttribute("aria-checked","false"),r.disabled=!0);r.dataBind();t.removeClass([i],["e-check","e-stop","e-uncheck"]);t.addClass([i],n)},n.prototype.updateSelectAll=function(n){for(var t,u,i=0,r=[].slice.call(this.ulElement.getElementsByClassName("e-frame"));i<r.length;i++)t=r[i],ho(t,n),u=t.parentElement.querySelector("input"),t.classList.contains("e-check")?u.setAttribute("aria-checked","true"):t.classList.contains("e-uncheck")&&u.setAttribute("aria-checked","false")},n.prototype.refreshCheckboxButton=function(){for(var t,f,e,r,h,u=this.parent.getVisibleColumns(),n=0;n<u.length;n++)t=u[parseInt(n.toString(),10)].uid,-1===this.prevShowedCols.indexOf(t)&&this.prevShowedCols.push(t);for(n=0;n<this.hideColumn.length;n++)f=this.prevShowedCols.indexOf(this.hideColumn[parseInt(n.toString(),10)]),-1!==f&&this.prevShowedCols.splice(f,1);e=0!==this.showColumn.length?1:this.prevShowedCols.length;r=this.dlgDiv.querySelector(".e-footer-content").querySelector(".e-btn").ej2_instances[0];r.disabled=!1;for(var o=[],s=[].slice.call(this.parent.element.getElementsByClassName("e-cc-chbox")),c=(n=0,s.length);n<c;n++)t=i(s[parseInt(n.toString(),10)],"e-ccheck").getAttribute("uid"),o.push(t);h=this.showColumn.filter(function(n){return-1!==o.indexOf(n)});0===e&&0===h.length&&(r.disabled=!0);r.dataBind()},n.prototype.refreshCheckboxList=function(n){var r,f;this.ulElement=this.parent.createElement("ul",{className:"e-ccul-ele e-cc"});var e=this.l10n.getConstant("SelectAll"),u=this.parent.createElement("li",{className:"e-cclist e-cc e-cc-selectall"}),i=this.createCheckBox(e,!1,"grid-selectAll");for(n.length&&(i.querySelector(".e-checkbox-wrapper").firstElementChild.classList.add("e-selectall"),i.querySelector(".e-frame").classList.add("e-selectall"),this.checkState(i.querySelector(".e-icons"),!0),u.appendChild(i),this.ulElement.appendChild(u)),this.parent.cssClass&&t.addClass([i],[this.parent.cssClass]),r=0;r<n.length;r++)f=n[parseInt(r.toString(),10)],this.renderCheckbox(f);return this.ulElement},n.prototype.refreshCheckboxState=function(){var u,n,f,e;this.dlgObj.element.querySelector(".e-cc.e-input").value="";this.columnChooserSearch("");for(var o=this.parent,r=this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)"),t=0,s=r.length;t<s;t++)n=r[parseInt(t.toString(),10)],u=this.parent.childGrid||this.parent.detailTemplate?i(this.dlgObj.element.querySelectorAll(".e-cc-chbox:not(.e-selectall)")[parseInt(t.toString(),10)],"e-ccheck").getAttribute("uid"):i(n,"e-ccheck").getAttribute("uid"),f=o.getColumnByUid(u),e=[].slice.call(n.parentElement.getElementsByClassName("e-uncheck")),f.visible&&!e.length?(n.checked=!0,this.checkState(n.parentElement.querySelector(".e-icons"),!0)):(n.checked=!1,this.checkState(n.parentElement.querySelector(".e-icons"),!1))},n.prototype.checkState=function(n,i){i?t.classList(n,["e-check"],["e-uncheck"]):t.classList(n,["e-uncheck"],["e-check"])},n.prototype.createCheckBox=function(n,t,i){var r=t?this.cBoxTrue.cloneNode(!0):this.cBoxFalse.cloneNode(!0);return r.querySelector(".e-label").innerHTML=n,vh(i,r,"e-ccheck")},n.prototype.renderCheckbox=function(n){var i,u,f,r;n.showInColumnChooser&&(i=this.parent.createElement("li",{className:"e-cclist e-cc",styles:"list-style:None",id:"e-ccli_"+n.uid}),u=-1!==this.hideColumn.indexOf(n.uid),f=-1!==this.showColumn.indexOf(n.uid),r=this.createCheckBox(n.headerText,n.visible&&!u||f,n.uid),i.appendChild(r),this.parent.cssClass&&t.addClass([r],[this.parent.cssClass]),this.ulElement.appendChild(i));this.isInitialOpen&&this.updateIntermediateBtn()},n.prototype.columnChooserManualSearch=function(n){this.addcancelIcon();this.searchValue=n.target.value;this.stopTimer();this.startTimer(n)},n.prototype.startTimer=function(n){var t=this,i=t.flag||13===n.keyCode?0:500;this.timer=window.setInterval(function(){t.columnChooserSearch(t.searchValue)},i)},n.prototype.stopTimer=function(){window.clearInterval(this.timer)},n.prototype.addcancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.add("e-cc-cancel");this.dlgDiv.querySelector(".e-cc-cancel").setAttribute("title",this.l10n.getConstant("Clear"))},n.prototype.removeCancelIcon=function(){this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").classList.remove("e-cc-cancel");this.dlgDiv.querySelector(".e-cc.e-ccsearch-icon").setAttribute("title",this.l10n.getConstant("Search"))},n.prototype.mOpenDlg=function(){t.Browser.isDevice&&(this.dlgObj.element.querySelector(".e-cc-searchdiv").classList.remove("e-input-focus"),this.dlgObj.element.querySelectorAll(".e-cc-chbox")[0].focus())},n.prototype.getModuleName=function(){return"columnChooser"},n.prototype.hideOpenedDialog=function(){for(var t=[].slice.call(document.getElementsByClassName("e-ccdlg")).filter(function(n){return n.classList.contains("e-popup-open")}),n=0,i=t.length;n<i;n++)(t[parseInt(n.toString(),10)].classList.contains("e-dialog")||this.parent.element.id+"_ccdlg"!==t[parseInt(n.toString(),10)].id)&&t[parseInt(n.toString(),10)].ej2_instances[0].hide()},n.prototype.beforeOpenColumnChooserEvent=function(){var n={requestType:"beforeOpenColumnChooser",element:this.parent.element,columns:this.getColumns(),cancel:!1,searchOperator:this.parent.columnChooserSettings.operator};return this.parent.trigger(tg,n),this.searchOperator=n.searchOperator,n},n}();const oft=ejdashboard.excelexport;var hf=function(){function n(n,t){this.hideColumnInclude=!1;this.foreignKeyData={};this.parent=n;!n.parentDetails&&t&&(this.foreignKeyData=t)}return n.getQuery=function(n,t){var i=t.generateQuery(!0).requiresCount();return t.isRemote()&&(n.groupSettings.enableLazyLoading&&n.groupSettings.columns.length?i.lazyLoad=[]:i.take(n.pageSettings.totalRecordsCount)),i},n.prototype.getFData=function(n,t){return cu(t,{},n,this.foreignKeyData[t.field])[0]},n.prototype.getGridRowModel=function(n,t,i,r){var f,o,e,u,s;if(void 0===r&&(r=0),f=[],o=t.length,o){for(e=0;e<o;e++,r++)u={isExpand:!1},u.data=t[parseInt(e.toString(),10)],u.index=r,i.childGrid&&("All"===i.hierarchyPrintMode?u.isExpand=!0:"Expanded"===i.hierarchyPrintMode&&this.parent.expandedRows&&this.parent.expandedRows[parseInt(r.toString(),10)]&&(u.isExpand=i.expandedRows[parseInt(r.toString(),10)].isExpand)),s=new lr(u),s.cells=this.generateCells(n,i),f.push(s);this.processColumns(f)}return f},n.prototype.generateCells=function(n,t){var r=[],e,u,i,f,s;if(t.childGridLevel)for(e=t.childGridLevel,u=0;e>u;u++)r.push(this.generateCell({},o.Indent));for(i=0,f=n;i<f.length;i++)s=f[i],r.push(this.generateCell(s,o.Data));return r},n.prototype.getColumnData=function(n){var r,o=this,f=[],t=n.getForeignKeyColumns(),i,e;if(t.length){for(i=0;i<t.length;i++)e="result"in t[parseInt(i.toString(),10)].dataSource?new u.DataManager(t[parseInt(i.toString(),10)].dataSource.result):t[parseInt(i.toString(),10)].dataSource,f.push(e.executeQuery(new u.Query));r=Promise.all(f).then(function(n){for(var i=0;i<t.length;i++)o.foreignKeyData[t[parseInt(i.toString(),10)].field]=n[parseInt(i.toString(),10)].result})}return r},n.prototype.getHeaders=function(n,t){this.hideColumnInclude=!!t;this.colDepth=kh(n);for(var i=[],r=0;r<this.colDepth;r++)i[parseInt(r.toString(),10)]=new lr({}),i[parseInt(r.toString(),10)].cells=[];return i=this.processColumns(i),{rows:i=this.processHeaderCells(i,n),columns:this.generateActualColumns(n)}},n.prototype.getConvertedWidth=function(n){var t=parseFloat(n);return-1!==n.indexOf("%")?this.parent.element.getBoundingClientRect().width*t/100:t},n.prototype.generateActualColumns=function(n,t){var r,u,i;for(void 0===t&&(t=[]),r=0,u=n;r<u.length;r++)i=u[r],i.commands||(i.columns?(i.visible||this.hideColumnInclude)&&0!==this.getCellCount(i,0)&&this.generateActualColumns(i.columns,t):(i.visible||this.hideColumnInclude)&&t.push(i));return t},n.prototype.processHeaderCells=function(n,t){for(var r=t,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].commands||(n=this.appendGridCells(r[parseInt(i.toString(),10)],n,0));return n},n.prototype.appendGridCells=function(n,t,i){var u;if(n.columns||!1===n.visible&&!this.hideColumnInclude||n.commands){if(n.columns){u=this.getCellCount(n,0);u&&t[parseInt(i.toString(),10)].cells.push(new pi({cellType:o.StackedHeader,column:n,colSpan:u}));for(var f=void 0,r=0,e=n.columns.length;r<e;r++)n.columns[parseInt(r.toString(),10)].visible&&!f&&(f=!0),t=this.appendGridCells(n.columns[parseInt(r.toString(),10)],t,i+1)}}else t[parseInt(i.toString(),10)].cells.push(this.generateCell(n,o.Header,this.colDepth-i,i));return t},n.prototype.generateCell=function(n,t,i,r){var u={visible:n.visible,isDataCell:t===o.Data,column:n,cellType:t,rowSpan:i,index:r};return(!u.rowSpan||u.rowSpan<2)&&delete u.rowSpan,new pi(u)},n.prototype.processColumns=function(n){var t=this.parent,u=[],i,f,r,e;for(t.enableColumnVirtualization&&(u=t.getColumnIndexesInView()),i=0,f=n.length;i<f;i++)if(t.allowGrouping)for(r=0,e=t.groupSettings.columns.length-1;r<e;r++)t.enableColumnVirtualization&&-1===u.indexOf(r)||n[parseInt(i.toString(),10)].cells.splice(0,0,this.generateCell({},o.HeaderIndent));return n},n.prototype.getCellCount=function(n,t){if(n.columns)for(var i=0;i<n.columns.length;i++)t=this.getCellCount(n.columns[parseInt(i.toString(),10)],t);else(n.visible||this.hideColumnInclude)&&t++;return t},n.prototype.checkAndExport=function(n,t){Object.keys(n).some(function(t){return!n[""+t]})||t()},n.prototype.failureHandler=function(n,t,i){var r=this;return function(){n[t.id]=!0;r.checkAndExport(n,i)}},n.prototype.createChildGrid=function(n,i,r,u){var f=new tv(this.parent.detailRowModule.getGridModel(n,i,r)),e,o;return n.isPrinting=!1,f.parentDetails={parentID:n.element.id,parentPrimaryKeys:n.getPrimaryKeyFieldNames(),parentKeyField:n.childGrid.queryString,parentKeyFieldValue:t.getValue(f.queryString,i.data),parentRowData:i.data},e=tr("child-grid"),o=t.createElement("div",{id:e,styles:"display: none"}),document.body.appendChild(o),f.id=e,u[""+e]=!1,f.isExportGrid=!0,{childGrid:f,element:o}},n.prototype.getGridExportColumns=function(n){for(var r=[],t=0,i=n;t<i.length;t++)"checkbox"!==i[parseInt(t.toString(),10)].type&&r.push(i[parseInt(t.toString(),10)]);return r},n.prototype.getForeignKeyData=function(){return this.foreignKeyData},n}(),sk=function(){function n(n){this.valueFormatter=new wu(n);this.internationalization=new t.Internationalization(n)}return n.prototype.returnFormattedValue=function(n,i){return!t.isNullOrUndefined(n.value)&&n.value?this.valueFormatter.getFormatFunction(i)(n.value):""},n.prototype.formatCellValue=function(n){var r,i,u;return(n.isForeignKey&&(n.value=t.getValue(n.column.foreignKeyValue,cu(n.column,{},n.value)[0])),"number"===n.column.type&&void 0!==n.column.format&&""!==n.column.format)?("string"==typeof n.column.format&&(n.column.format={format:n.column.format}),n.value||0===n.value?this.internationalization.getNumberFormat(n.column.format)(n.value):""):"boolean"===n.column.type&&""!==n.value?n.value?"true":"false":"date"!==n.column.type&&"dateonly"!==n.column.type&&"datetime"!==n.column.type&&"time"!==n.column.type||void 0===n.column.format?(t.isNullOrUndefined(n.column.type)||t.isNullOrUndefined(n.value))&&t.isNullOrUndefined(n.value)?"":n.value.toString():("string"==typeof n.value&&(n.value=new Date(n.value)),"string"==typeof n.column.format)?(i=n.column.format,r="date"===n.column.type||"dateonly"===n.column.type?{type:"date",skeleton:i}:"time"===n.column.type?{type:"time",skeleton:i}:{type:"dateTime",skeleton:i},this.returnFormattedValue(n,r)):n.column.format instanceof Object&&void 0===n.column.format.type?n.value.toString():(u="date"===n.column.type||"dateonly"===n.column.type?{type:n.column.format.type,format:n.column.format.format,skeleton:n.column.format.skeleton}:"time"===n.column.type?{type:"time",format:n.column.format.format,skeleton:n.column.format.skeleton}:{type:"dateTime",format:n.column.format.format,skeleton:n.column.format.skeleton},this.returnFormattedValue(n,u))},n}(),hk=function(){function n(n,t){this.book={};this.workSheet=[];this.rows=[];this.columns=[];this.styles=[];this.rowLength=1;this.expType="AppendToSheet";this.includeHiddenColumn=!1;this.isCsvExport=!1;this.isChild=!1;this.isElementIdChanged=!1;this.gridPool={};this.sheet={};this.grpFooterTemplates=[];this.footerTemplates=[];this.aggIndex=0;this.totalAggregates=0;this.parent=n;this.helper=new hf(n);this.locator=t;this.l10n=this.locator.getService("localization")}return n.prototype.getModuleName=function(){return"ExcelExport"},n.prototype.init=function(n){null!==n.element&&""===n.element.id&&(n.element.id=(new Date).toISOString(),this.isElementIdChanged=!0);this.parent=n;this.parent.isDestroyed||(this.isExporting=void 0,this.book={},this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.rowLength=1,this.footer=void 0,this.expType="AppendToSheet",this.includeHiddenColumn=!1,this.exportValueFormatter=new sk(n.locale),n.id=tr("main-grid"),this.gridPool[n.id]=!1)},n.prototype.Map=function(n,i,r,u,f,e){var s=n,h="isCsv",o;return this.gridPool={},n.childGrid&&(t.isNullOrUndefined(i)||"None"!==i.hierarchyExportMode)&&(n.expandedRows=wh(n).expandedRows),o={requestType:"beforeExcelExport",gridObject:s,cancel:!1,isMultipleExport:r,workbook:u,isCsv:f,isBlob:e,isChild:this.isChild,grpFooterTemplates:this.grpFooterTemplates},s.trigger(wg,o),o.cancel?new Promise(function(n){return n()}):(this.parent.log("exporting_begin",this.getModuleName()),this.data=new th(s),this.isExporting=!0,this.isBlob=o.isBlob,this.isChild=o.isChild,this.grpFooterTemplates=o.grpFooterTemplates,this.isCsvExport=!!o[""+h]&&o[""+h],hh(i)&&rb(i,s),this.processRecords(s,i,o.isMultipleExport,o.workbook))},n.prototype.exportingSuccess=function(n){this.isExporting=!1;this.parent.trigger(bg,this.isBlob?{promise:this.blobPromise}:{});this.parent.log("exporting_complete",this.getModuleName());n(this.book)},n.prototype.processRecords=function(n,i,r,f){var e=this,o,s;return(n.allowGrouping&&n.groupSettings.enableLazyLoading&&n.groupSettings.columns.length&&(t.isNullOrUndefined(i)?i={hierarchyExportMode:"All"}:i.hierarchyExportMode=i.hierarchyExportMode||"All"),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.dataSource))?t.isNullOrUndefined(i)||"CurrentPage"!==i.exportType?(o=[],o.push(this.data.getData({},hf.getQuery(n,this.data))),o.push(this.helper.getColumnData(n)),new Promise(function(t,u){Promise.all(o).then(function(u){e.init(n);e.processInnerRecords(n,i,r,f,u[0]).then(function(){e.exportingSuccess(t)})}).catch(function(n){u(e.book);e.parent.trigger(lf,n)})})):new Promise(function(t){e.init(n);e.processInnerRecords(n,i,r,f,e.parent.getCurrentViewRecords());e.exportingSuccess(t)}):(i.dataSource=i.dataSource instanceof u.DataManager?i.dataSource:new u.DataManager(i.dataSource),s=i.query?i.query:new u.Query,(t.isNullOrUndefined(s.isCountRequired)||n.aggregates)&&(s.isCountRequired=!0),new Promise(function(t){i.dataSource.executeQuery(s).then(function(u){e.init(n);e.processInnerRecords(n,i,r,f,u).then(function(){e.exportingSuccess(t)})})}))},n.prototype.processInnerRecords=function(n,i,r,u,f){var e=this;this.groupedColLength=n.groupSettings.columns.length;var h,c=5,s=[],l=kh(n.columns),o=!t.isNullOrUndefined(i);return o&&!t.isNullOrUndefined(i.multipleExport)&&(this.expType=t.isNullOrUndefined(i.multipleExport.type)?"AppendToSheet":i.multipleExport.type,t.isNullOrUndefined(i.multipleExport.blankRows)||(c=i.multipleExport.blankRows)),t.isNullOrUndefined(u)?(this.workSheet=[],this.rows=[],this.columns=[],this.styles=[],this.sheet.images=[]):"NewSheet"===this.expType?(this.workSheet=u.worksheets,this.rows=[],this.columns=[],this.sheet.images=[],this.styles=u.styles):(this.workSheet=[],this.rows=u.worksheets[0].rows,this.columns=u.worksheets[0].columns,this.styles=u.styles,this.sheet.images=u.worksheets[0].images,this.rowLength=this.rows[this.rows.length-1].index+c,this.rowLength++),o&&(t.isNullOrUndefined(r)?(t.isNullOrUndefined(i.header)||this.processExcelHeader(JSON.parse(JSON.stringify(i.header))),t.isNullOrUndefined(i.footer)||(this.footer=JSON.parse(JSON.stringify(i.footer)))):(t.isNullOrUndefined(i.header)||!r&&"NewSheet"!==this.expType||this.processExcelHeader(JSON.parse(JSON.stringify(i.header))),t.isNullOrUndefined(i.footer)||"AppendToSheet"===this.expType&&r||(this.footer=JSON.parse(JSON.stringify(i.footer))))),this.includeHiddenColumn=!!o&&i.includeHiddenColumn,new Promise(function(t){n.childGridLevel=0;s=e.processGridExport(n,i,f);e.globalResolve=t;e.gridPool[n.id]=!0;e.helper.checkAndExport(e.gridPool,e.globalResolve)}).then(function(){var c=[],a,v,f;return(e.organiseRows(s,s[0].index,c),e.rows=e.rows.concat(c),t.isNullOrUndefined(e.footer)||("AppendToSheet"===e.expType&&!r||"NewSheet"===e.expType)&&e.processExcelFooter(e.footer),e.columns.length>0&&(e.sheet.columns=e.columns),e.sheet.rows=e.rows,e.sheet.enableRtl=e.parent.enableRtl,e.parent.allowFiltering&&n.getVisibleColumns().length&&o&&i.enableFilter)&&(a=i.header?i.header.headerRows||i.header.rows.length:0,v={row:l+a,column:e.groupedColLength?e.groupedColLength+1:e.sheet.columns[0].index,lastRow:e.sheet.rows.length,lastColumn:e.sheet.columns.length},e.sheet.autoFilters=v),(e.workSheet.push(e.sheet),e.book.worksheets=e.workSheet,e.book.styles=e.styles,n.notify("finalPageSetup",e.book),r)||(e.isCsvExport?(o&&!t.isNullOrUndefined(i.separator)&&","!==i.separator&&(h=i.separator),f=new oft.Workbook(e.book,"csv",n.locale,t.defaultCurrencyCode,h),e.isBlob?e.blobPromise=f.saveAsBlob("text/csv"):o&&i.fileName?f.save(i.fileName):f.save("Export.csv")):(f=new oft.Workbook(e.book,"xlsx",n.locale,t.defaultCurrencyCode),e.isBlob?e.blobPromise=f.saveAsBlob("application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"):o&&i.fileName?f.save(i.fileName):f.save("Export.xlsx")),e.isElementIdChanged&&(n.element.id=""),delete n.expandedRows),u})},n.prototype.organiseRows=function(n,t,i){var u,r,f;if(!n.length)return t;for(u=0;u<n.length;u++)r=n[parseInt(u.toString(),10)],f=r.childRows,f?(r.index=t++,delete r.childRows,i.push(r),t=this.organiseRows(f,t,i)):(r.index=t++,i.push(r));return t},n.prototype.processGridExport=function(n,i,r){var u=[],p=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns(),e,f,a,y,c;t.isNullOrUndefined(i)||t.isNullOrUndefined(i.theme)||(this.theme=i.theme);n.childGrid&&!t.isNullOrUndefined(i)&&(n.hierarchyPrintMode=i.hierarchyExportMode||"Expanded");var s=new hf(n,this.helper.getForeignKeyData()),w=hh(i)?ee(i.columns,n.enableColumnVirtualization):s.getGridExportColumns(p?n.getColumns():n.columns),h=s.getHeaders(w,this.includeHiddenColumn),b=n.groupSettings.columns.length?n.groupSettings.columns.length-1:0;if(u=this.processHeaderContent(n,h,b,u),!t.isNullOrUndefined(i)&&Object.keys(i).length&&t.isNullOrUndefined(i.dataSource))if("CurrentPage"!==i.exportType||n.groupSettings.enableLazyLoading&&!n.getDataModule().isRemote())if(n.groupSettings.enableLazyLoading&&!n.getDataModule().isRemote()){if(e=void 0,!t.isNullOrUndefined(i)&&Object.keys(i).length){var v="CurrentPage"!==i.exportType,o=n.getDataModule().generateQuery(v),l=n.getDataModule().dataManager.executeLocal(o);if(o.lazyLoad=[],!v)for(f=0;f<o.queries.length;f++)"onPage"===o.queries[parseInt(f.toString(),10)].fn&&(o.queries[parseInt(f.toString(),10)].e.pageSize=l.reduce(function(n,t){return n+t.count},0));if("All"===i.hierarchyExportMode)e=n.getDataModule().dataManager.executeLocal(o);else if("Expanded"===i.hierarchyExportMode||"None"===i.hierarchyExportMode||t.isNullOrUndefined(i.hierarchyExportMode)){for(e=n.getDataModule().dataManager.executeLocal(o),a=this.parent.contentModule.lazyLoadQuery,f=0;f<a.length;f++)for(y=a[parseInt(f.toString(),10)][0],c=0;c<e.length;c++)e[parseInt(c.toString(),10)].key===y.value&&(l[parseInt(f.toString(),10)]=e[parseInt(c.toString(),10)]);e=l}}else e=n.currentViewData;u=this.processRecordContent(n,r,h,i,e,u,s)}else u=this.processRecordContent(n,r,h,i,void 0,u,s);else u=this.processRecordContent(n,r,h,i,n.currentViewData,u,s);else u=this.processRecordContent(n,r,h,i,void 0,u,s);return n.notify(hn,{excelRows:u,type:"excel"}),this.capTemplate=void 0,this.footerTemplates=[],this.grpFooterTemplates=[],this.aggIndex=0,this.totalAggregates=0,u},n.prototype.processRecordContent=function(n,i,r,u,f,e,o){var s,h;return(s=!t.isNullOrUndefined(f)&&f.length?f:i.result,t.isNullOrUndefined(s.level)?this.processRecordRows(n,s,r,0,0,u,e,o):this.processGroupedRows(n,s,r,s.level,0,u,e,o),!t.isNullOrUndefined(i.aggregates)&&Object.keys(i.aggregates).length>0)&&(t.isNullOrUndefined(f)||this.parent.groupSettings.enableLazyLoading?(h=i.result.GroupGuid?i.result.records:i.result,this.processAggregates(n,h,e)):this.processAggregates(n,i.result,e,f)),e},n.prototype.processGroupedRows=function(n,i,r,u,f,e,o,s){for(var v,g,l,b,et,p=0,k=i;p<k.length;p++){var h=k[p],a=[],c={};c.index=1+u-1;var d=n.getColumnByField(h.field),ot={value:h.key,column:d,style:void 0,isForeignKey:d.isForeignColumn()},it=n.getColumnByField(h.field).headerText+": "+(d.enableGroupByFormat?h.key:this.exportValueFormatter.formatCellValue(ot))+" - ";if(it+=h.count>1?h.count+" items":h.count+" item",v={captionText:it,type:this.isCsvExport?"CSV":"Excel",data:h},this.parent.trigger(ky,v),c.value=v.captionText,c.style=this.getCaptionThemeStyle(this.theme),t.isNullOrUndefined(v.style)||(c.style=this.mergeOptions(c.style,v.style)),g=new fh(n).generateRows(h),this.fillAggregates(n,g,i.level+i.childLevels-1,o,this.rowLength),a.push(c),o[o.length-1].cells.length>0){for(var w=i.level+i.childLevels+g[0].cells.length,y=0,nt=0,rt=o[o.length-1].cells;nt<rt.length;nt++)l=rt[nt],l.index<w&&(w=l.index),l.index>y&&(y=l.index),a[a.length-1].index!==l.index&&a.push(l);for(w-c.index>1&&(c.colSpan=w-c.index);y<r.columns.length+u+i.childLevels;)b={},b.index=y+1,b.style=this.getCaptionThemeStyle(this.theme),a.push(b),y++}else{for(var ut=0,tt=0,ft=r.columns;tt<ft.length;tt++)ft[tt].visible&&ut++;c.colSpan=i.childLevels+ut}(o[o.length-1].cells=a,this.rowLength++,this.groupedColLength<8&&u>1)&&(et={outlineLevel:u-1,isCollapsed:!0},o[o.length-1].grouping=et);!t.isNullOrUndefined(i.childLevels)&&i.childLevels>0?(this.processGroupedRows(n,h.items,r,h.items.level,f,e,o,s),this.processAggregates(n,h,o,void 0,u-1+i.childLevels,!0)):(f=this.processRecordRows(n,h.items,r,u-1,f,e,o,s),this.processAggregates(n,h,o,void 0,u-1,!0))}},n.prototype.processRecordRows=function(n,i,r,u,f,e,s,h){for(var l,tt,ot,w,ht,p=1,d=[],ct=r.columns,g=0,rt=h.getGridRowModel(ct,i,n,f);g<rt.length;g++){l=rt[g];d=[];f++;p=1;for(var b=void 0,nt=0,lt=l.cells.length;nt<lt;nt++)if(tt=l.cells[parseInt(nt.toString(),10)],tt.cellType===o.Data){var v=tt.column,ut=v.field,ft=t.isNullOrUndefined(ut)?"":v.valueAccessor(ut,l.data,v),k=t.isNullOrUndefined(ft)?"":ft,it=void 0;if(v.isForeignColumn&&v.isForeignColumn()&&(it=h.getFData(k,v),k=t.getValue(v.foreignKeyValue,it)),!t.isNullOrUndefined(k)){var a={},et=p+u+n.childGridLevel,c={data:l.data,column:v,foreignKeyData:it,value:k,style:void 0,colSpan:1,cell:a};(n.trigger(kg,c),t.isNullOrUndefined(c.image)||t.isNullOrUndefined(c.image.base64)||(b=this.setImage(c,et),c.image.height&&""!==c.value&&(b+=30)),t.isNullOrUndefined(c.hyperLink)||(c.cell.hyperlink={target:c.hyperLink.target},c.value=c.hyperLink.displayText||c.value),(a=c.cell).index=et,a.value=c.value,""===c.data&&n.childGridLevel&&1===p)&&(c={style:{hAlign:"left"}},a.colSpan=n.getVisibleColumns().length,a.value=this.l10n.getConstant("EmptyRecord"));(c.colSpan>1&&(a.colSpan=c.colSpan),t.isNullOrUndefined(c.style))?a.style={name:n.element.id+"column"+(p+u)}:(ot=this.getColumnStyle(n,p+u),a.style=this.mergeOptions(this.styles[parseInt(ot.toString(),10)],c.style));d.push(a)}p++}if(w={index:this.rowLength++,cells:d},t.isNullOrUndefined(b)||(w.height=b),this.groupedColLength&&this.groupedColLength<8&&u+1>0?(w.grouping={outlineLevel:u+1,isCollapsed:!0},s.push(w)):s.push(w),(l.isExpand||this.isChild)&&!t.isNullOrUndefined(n.childGrid)){n.isPrinting=!0;var at=!t.isNullOrUndefined(e)&&e.exportType?e.exportType:"AllPages",st=this.helper.createChildGrid(n,l,at,this.gridPool),y=st.childGrid,vt=st.element;y.actionFailure=h.failureHandler(this.gridPool,y,this.globalResolve);y.childGridLevel=n.childGridLevel+1;ht={childGrid:y,row:l,exportProperties:e};this.parent.trigger(sp,ht);y.beforeDataBound=this.childGridCell(w,y,e,l);y.appendTo(vt)}n.notify(yp,{rowObj:l,type:"excel",excelRows:s})}return f},n.prototype.setImage=function(n,i){t.isNullOrUndefined(this.sheet.images)&&(this.sheet.images=[]);var r={image:n.image.base64,row:this.rowLength,column:i,lastRow:this.rowLength,lastColumn:i};return n.image.width&&n.image.height&&(r.width=n.image.width,r.height=n.image.height),this.sheet.images.push(r),this.columns[i-1].width=n.image.width||this.columns[i-1].width,n.image.height||50},n.prototype.childGridCell=function(n,i,r,u){var f=this;return function(e){i.beforeDataBound=null;e.cancel=!0;0===e.result.length&&(e.result=[""]);n.childRows=f.processGridExport(i,r,e);for(var h=f.parent.groupSettings.columns.length,s=n.childRows,o=0;o<s.length;o++)s[parseInt(o.toString(),10)].grouping={outlineLevel:h+i.childGridLevel,isCollapsed:!u.isExpand,isHidden:!u.isExpand};return i.destroy(),t.detach(i.element),f.gridPool[i.id]=!0,f.helper.checkAndExport(f.gridPool,f.globalResolve),n}},n.prototype.processAggregates=function(n,i,r,u,f,e){var l=new uh(n),s=l.getColumns(),o,h,c;return s=s.filter(function(n){return t.isNullOrUndefined(n.commands)&&"checkbox"!==n.type}),n.aggregates.length&&this.parent!==n&&n.aggregateModule.prepareSummaryInfo(),(o=t.isNullOrUndefined(u)?i:u,void 0===f&&(f=0),n.groupSettings.columns.length>0&&e)?(h=new uo(n).generateRows(o,{level:o.level}),h.length>0&&(r=this.fillAggregates(n,h,f,r))):(f=n.groupSettings.columns.length>0&&!e?n.groupSettings.columns.length:f,c=l.generateRows(o,i.aggregates,null,null,s),c.length>0&&!e&&(f=n.groupSettings.columns.length?f-1:f,r=this.fillAggregates(n,c,f,r))),r},n.prototype.fillAggregates=function(n,i,r,u,f){for(var e,h,a,b,k,rt,v,d,ut,l=0,y=i;l<y.length;l++){for(var s=y[l],c=[],g=!0,p=0,w=0,nt=s.cells;w<nt.length;w++)if(e=nt[w],h={},e.cellType!==o.DetailFooterIntent&&(e.visible||this.includeHiddenColumn))if(p++,e.isDataCell){g=!1;var tt=!t.isNullOrUndefined(e.column.footerTemplate),it=!t.isNullOrUndefined(e.column.groupFooterTemplate),ft=!t.isNullOrUndefined(e.column.groupCaptionTemplate);if(h.index=p+r+n.childGridLevel,tt)h.value=this.getAggreateValue(n,o.Summary,e.column.footerTemplate,e,s);else if(it)h.value=this.getAggreateValue(n,o.GroupSummary,e.column.groupFooterTemplate,e,s);else if(ft)h.value=this.getAggreateValue(n,o.CaptionSummary,e.column.groupCaptionTemplate,e,s);else for(a=0,b=Object.keys(s.data[e.column.field]);a<b.length;a++)b[a]===e.column.type&&(t.isNullOrUndefined(s.data[e.column.field].Sum)?t.isNullOrUndefined(s.data[e.column.field].Average)?t.isNullOrUndefined(s.data[e.column.field].Max)?t.isNullOrUndefined(s.data[e.column.field].Min)?t.isNullOrUndefined(s.data[e.column.field].Count)?t.isNullOrUndefined(s.data[e.column.field].TrueCount)?t.isNullOrUndefined(s.data[e.column.field].FalseCount)?t.isNullOrUndefined(s.data[e.column.field].Custom)||(h.value=s.data[e.column.field].Custom):h.value=s.data[e.column.field][e.column.field+" - falsecount"]:h.value=s.data[e.column.field][e.column.field+" - truecount"]:h.value=s.data[e.column.field][e.column.field+" - count"]:h.value=s.data[e.column.field][e.column.field+" - min"]:h.value=s.data[e.column.field][e.column.field+" - max"]:h.value=s.data[e.column.field][e.column.field+" - average"]:h.value=s.data[e.column.field][e.column.field+" - sum"]);h.style=this.getCaptionThemeStyle(this.theme);this.aggregateStyle(e.column,h.style,e.column.field);k=e.attributes.style;k.textAlign&&(h.style.hAlign=k.textAlign.toLowerCase());rt={row:s,type:tt?"Footer":it?"GroupFooter":"GroupCaption",style:h,cell:e};this.parent.trigger(ttt,rt);c.push(h)}else void 0===f&&(h.index=p+r+n.childGridLevel,h.style=this.getCaptionThemeStyle(this.theme),c.push(h));t.isNullOrUndefined(f)?(v={},d="grouping",this.groupedColLength<8&&this.groupedColLength>0&&(!n.groupSettings.enableLazyLoading||!t.isNullOrUndefined(u[u.length-1][""+d]))?(ut={outlineLevel:u[u.length-1][""+d].outlineLevel,isCollapsed:!0},v={index:this.rowLength++,cells:c,grouping:ut}):v={index:this.rowLength++,cells:c},g||u.push(v)):u.push({index:f,cells:c})}return u},n.prototype.aggregateStyle=function(n,i,r){var f=this.parent.getColumnByField(r),u;"object"==typeof n.format?(u=n.format,i.numberFormat=t.isNullOrUndefined(u.format)?u.skeleton:u.format,t.isNullOrUndefined(u.type)||(i.type=u.type.toLowerCase())):i.numberFormat=n.format;!t.isNullOrUndefined(f)&&t.isNullOrUndefined(i.type)&&(i.type=f.type.toLowerCase())},n.prototype.getAggreateValue=function(n,i,r,u,f){var e,h={},s;return h[t.getEnumValue(o,u.cellType)]=t.compile(r),s=f.data[u.column.field?u.column.field:u.column.columnName],(this.parent.isReact||this.parent.isVue||this.parent.isVue3||this.parent.isAngular)&&"string"!=typeof u.column.footerTemplate&&"string"!=typeof u.column.groupFooterTemplate&&"string"!=typeof u.column.groupCaptionTemplate?(e=s[u.column.type],t.isNullOrUndefined(e)?"":e):(e=h[t.getEnumValue(o,u.cellType)](s),t.isNullOrUndefined(e[0])?"":e[0].textContent)},n.prototype.mergeOptions=function(n,t){for(var u={},r=Object.keys(n),i=0;i<r.length;i++)"name"!==r[parseInt(i.toString(),10)]&&(u[r[parseInt(i.toString(),10)]]=n[r[parseInt(i.toString(),10)]]);for(r=Object.keys(t),i=0;i<r.length;i++)"name"!==r[parseInt(i.toString(),10)]&&(u[r[parseInt(i.toString(),10)]]=t[r[parseInt(i.toString(),10)]]);return u},n.prototype.getColumnStyle=function(n,t){for(var r=0,i=0,u=this.styles;i<u.length;i++){if(u[i].name===n.element.id+"column"+t)return r;r++}},n.prototype.headerRotation=function(n){var t=n.style.rotation;t<=90&&t>=0?n.style.hAlign="Left":(t>90&&t<=180||(t=180),n.style.hAlign="Right");n.style.rotation=t},n.prototype.processHeaderContent=function(n,i,r,u){var b,k=i.rows,nt=i.columns,tt=[],v,c,l,a,p,w,e,g;if(r>0)for(v=0;v!==r;)this.columns.push({index:v+1,width:30}),v++;for(c=0;c<nt.length;c++)this.parseStyles(n,nt[parseInt(c.toString(),10)],this.getRecordThemeStyle(this.theme),r+c+1);for(l=0;l<k.length;l++){for(var h=1+r,it=[],d=0;d<k[parseInt(l.toString(),10)].cells.length;d++){var y={},s={},f=k[parseInt(l.toString(),10)].cells[parseInt(d.toString(),10)];if(f.cellType!==o.HeaderIndent&&f.cellType!==o.DetailHeader){for(a={contains:!0,index:1};a.contains;)if(h=(a=this.getIndex(tt,1,h)).index,!a.contains){s.index=a.index+n.childGridLevel;break}if(!t.isNullOrUndefined(f.rowSpan)&&1!==f.rowSpan)for(s.rowSpan=f.rowSpan,p=1;p<f.rowSpan+1;p++)w={rowIndex:0,columnIndex:0},w.rowIndex=p,w.columnIndex=h,tt.push(w);t.isNullOrUndefined(f.colSpan)||1===f.colSpan||(s.colSpan=f.colSpan,h=h+s.colSpan-1);s.value=f.column.headerText;y=this.getHeaderThemeStyle(this.theme);t.isNullOrUndefined(f.column.textAlign)||(y.hAlign=f.column.textAlign.toLowerCase());t.isNullOrUndefined(f.column.headerTextAlign)||(y.hAlign=f.column.headerTextAlign.toLowerCase());e={cell:s,gridCell:f,style:y};n.trigger(dg,e);e.style.rotation&&this.headerRotation(e);t.isNullOrUndefined(e.image)||t.isNullOrUndefined(e.image.base64)||(b=this.setImage(e,h));t.isNullOrUndefined(e.hyperLink)||(e.cell.hyperlink={target:e.hyperLink.target},s.value=e.hyperLink.displayText||s.value);s.style=e.style;it.push(s);h++}}g={index:this.rowLength++,cells:it};t.isNullOrUndefined(b)||(g.height=b);u.push(g)}return u},n.prototype.getHeaderThemeStyle=function(n){var i={fontSize:12,borders:{color:"#E0E0E0"},bold:!0};return t.isNullOrUndefined(n)||t.isNullOrUndefined(n.header)||(i=this.updateThemeStyle(n.header,i)),i},n.prototype.updateThemeStyle=function(n,i){return t.extend(i,n)},n.prototype.getCaptionThemeStyle=function(n){var i={fontSize:13,backColor:"#F6F6F6"};return t.isNullOrUndefined(n)||t.isNullOrUndefined(n.caption)||(i=this.updateThemeStyle(n.caption,i)),i},n.prototype.getRecordThemeStyle=function(n){var i={fontSize:13,borders:{color:"#E0E0E0"}};return t.isNullOrUndefined(n)||t.isNullOrUndefined(n.record)||(i=this.updateThemeStyle(n.record,i)),i},n.prototype.processExcelHeader=function(n){var u,i,r;if(!t.isNullOrUndefined(n.rows)&&("NewSheet"===this.expType||1===this.rowLength))for(this.rowLength=void 0===n.headerRows?n.rows.length:n.headerRows,u=this.rowLength<n.rows.length?this.rowLength:n.rows.length,this.rowLength++,i=0;i<u;i++)r=n.rows[parseInt(i.toString(),10)],(null===r.index||t.isNullOrUndefined(r.index))&&(r.index=i+1),this.updatedCellIndex(r)},n.prototype.updatedCellIndex=function(n){for(var r,u=n.cells.length,i=0;i<u;i++)r=n.cells[parseInt(i.toString(),10)],(null===r.index||t.isNullOrUndefined(r.index))&&(r.index=i+1);this.rows.push(n)},n.prototype.processExcelFooter=function(n){var r,u,i;if(!t.isNullOrUndefined(n.rows))for(r=void 0,void 0===n.footerRows?this.rowLength+=n.rows.length:n.footerRows>n.rows.length?(this.rowLength+=n.footerRows-n.rows.length,r=n.rows.length):r=n.footerRows,u=0;u<r;u++)i=n.rows[parseInt(u.toString(),10)],null===i.index||void 0===i.index?i.index=this.rowLength++:i.index+=this.rowLength,this.updatedCellIndex(i)},n.prototype.getIndex=function(n,t,i){for(var f,r=0,u=n;r<u.length;r++)if(f=u[r],f.rowIndex===t&&f.columnIndex===i)return{contains:!0,index:i+=1};return{contains:!1,index:i}},n.prototype.parseStyles=function(n,i,r,u){if(!t.isNullOrUndefined(i.format))if("object"==typeof i.format){var f=i.format;r.numberFormat=t.isNullOrUndefined(f.format)?f.skeleton:f.format;t.isNullOrUndefined(f.type)||(r.type=f.type.toLowerCase())}else r.numberFormat=i.format,r.type=i.type;t.isNullOrUndefined(i.textAlign)||(r.hAlign=i.textAlign.toLowerCase());Object.keys(r).length>0&&(r.name=n.element.id+"column"+u,this.styles.push(r));t.isNullOrUndefined(i.width)||"auto"===i.width||n.childGridLevel||this.columns.push({index:u+n.childGridLevel,width:"number"==typeof i.width?i.width:this.helper.getConvertedWidth(i.width)})},n.prototype.destroy=function(){},n}();const f=ejdashboard.pdfexport;var ck=function(){function n(n){this.hideColumnInclude=!1;this.currentViewData=!1;this.customDataSource=!1;this.isGrouping=!1;this.headerOnPages=[];this.drawPosition={xPosition:0,yPosition:0};this.parent=n;this.helper=new hf(n);this.gridPool={}}return n.prototype.getModuleName=function(){return"PdfExport"},n.prototype.init=function(n){this.exportValueFormatter=new sk(n.locale);this.pdfDocument=void 0;this.hideColumnInclude=!1;this.currentViewData=!1;this.parent=n;this.isGrouping=!1;this.isExporting=!0;n.id=tr("main-grid");this.gridPool[n.id]=!1;this.pdfPageSettings=new f.PdfPageSettings},n.prototype.exportWithData=function(n,i,r,u,e,o,s){var h=this;this.init(n);this.pdfDocument=t.isNullOrUndefined(i)?new f.PdfDocument:i;this.processExport(n,u,e,o).then(function(){h.isExporting=!1;n.trigger(hp,h.isBlob?{promise:h.blobPromise}:{});h.parent.log("exporting_complete",h.getModuleName());r(h.pdfDocument)}).catch(function(n){s(h.pdfDocument);h.parent.trigger(lf,n)})},n.prototype.Map=function(n,i,r,e,o){var s=this,l,h,c;return(this.data=new th(this.parent),this.isBlob=o,this.gridPool={},l=i&&i.query?i.query:new u.Query,n.childGrid&&(t.isNullOrUndefined(i)||"None"!==i.hierarchyExportMode)&&(n.expandedRows=wh(n).expandedRows),h={requestType:"beforePdfExport",cancel:!1,headerPageNumbers:[],gridDrawPosition:{xPosition:0,yPosition:0},generateQuery:!1},h.gridObject=n,n.trigger(gg,h),!0===h.cancel)?new Promise(function(n){return n()}):(hh(i)&&rb(i,n),h.generateQuery&&(l=hf.getQuery(n,this.data)),this.headerOnPages=h.headerPageNumbers,this.drawPosition=h.gridDrawPosition,this.parent.log("exporting_begin",this.getModuleName()),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.dataSource))?t.isNullOrUndefined(i)||"CurrentPage"!==i.exportType?(c=[],c.push(this.data.getData({},hf.getQuery(n,this.data))),c.push(this.helper.getColumnData(n)),new Promise(function(u,o){Promise.all(c).then(function(h){s.init(n);s.pdfDocument=t.isNullOrUndefined(e)?new f.PdfDocument:e;s.processExport(n,h[0],i,r).then(function(){s.isExporting=!1;n.trigger(hp,s.isBlob?{promise:s.blobPromise}:{});s.parent.log("exporting_complete",s.getModuleName());u(s.pdfDocument)}).catch(function(n){o(s.pdfDocument);s.parent.trigger(lf,n)})})})):new Promise(function(t,u){s.exportWithData(n,e,t,s.parent.getCurrentViewRecords(),i,r,u)}):(i.dataSource=i.dataSource instanceof u.DataManager?i.dataSource:new u.DataManager(i.dataSource),new Promise(function(t,u){i.dataSource.executeQuery(l).then(function(f){s.exportWithData(n,e,t,f,i,r,u)})}))},n.prototype.processExport=function(n,i,r,u){var e,f=this,o=this.pdfDocument.sections.add(),s;return this.processSectionExportProperties(o,r),s=o.pages.add(),new Promise(function(t){e=f.processGridExport(n,i,r);f.globalResolve=t;f.gridPool[n.id]=!0;f.helper.checkAndExport(f.gridPool,f.globalResolve)}).then(function(){return e.draw(s,f.drawPosition.xPosition,f.drawPosition.yPosition),f.drawHeader(r),u||(f.isBlob?f.blobPromise=f.pdfDocument.save():!t.isNullOrUndefined(r)&&r.fileName?f.pdfDocument.save(r.fileName):f.pdfDocument.save("Export.pdf"),f.pdfDocument.destroy(),delete n.expandedRows),f.pdfDocument})},n.prototype.processSectionExportProperties=function(n,i){return t.isNullOrUndefined(i)||t.isNullOrUndefined(i.pageOrientation)&&t.isNullOrUndefined(i.pageSize)||(this.pdfPageSettings.orientation="Landscape"===i.pageOrientation?f.PdfPageOrientation.Landscape:f.PdfPageOrientation.Portrait,this.pdfPageSettings.size=this.getPageSize(i.pageSize),n.setPageSettings(this.pdfPageSettings)),n},n.prototype.processGridExport=function(n,i,r){var p=!0,d=this.parent.isFrozenGrid()&&!this.parent.getFrozenColumns(),l,u,k,h,y;t.isNullOrUndefined(r)||(this.gridTheme=r.theme,p=!!t.isNullOrUndefined(r.allowHorizontalOverflow)||r.allowHorizontalOverflow);var c=new hf(n,this.helper.getForeignKeyData()),o=this.processExportProperties(r,i.result),a=hh(r)?ee(r.columns,n.enableColumnVirtualization):c.getGridExportColumns(d?n.getColumns():n.columns);a=a.filter(function(n){return t.isNullOrUndefined(n.commands)});l=!1;n.groupSettings.columns.length&&(l=!0);n.childGrid&&!t.isNullOrUndefined(r)&&(n.hierarchyPrintMode=r.hierarchyExportMode||"Expanded");var e=new f.PdfGrid,w=this.getHeaderThemeStyle(),s=w.border,g=w.font,nt=w.brush,b=c.getHeaders(a,this.hideColumnInclude),v=b.columns;return e=this.processGridHeaders(n.groupSettings.columns.length,e,b.rows,v,s,g,nt,n,p,a),this.setColumnProperties(v,e,c,n,p),u=this.getSummaryCaptionThemeStyle(),!t.isNullOrUndefined(o)&&o.length?(l?(t.isNullOrUndefined(u.border)||(s=u.border),this.processGroupedRecords(e,o,v,n,s,0,u.font,u.brush,u.backgroundBrush,i,r,c,0)):this.processRecord(s,v,n,o,e,0,r,c,0),t.isNullOrUndefined(i.aggregates))||(h=new uh(n),y=h.getColumns(),y=y.filter(function(n){return t.isNullOrUndefined(n.commands)&&"checkbox"!==n.type}),n.aggregates.length&&this.parent!==n&&n.aggregateModule.prepareSummaryInfo(),k=this.customDataSource?h.generateRows(o,i.aggregates):this.currentViewData?h.generateRows(this.parent.getCurrentViewRecords(),i.aggregates):l?h.generateRows(o.records,i.aggregates):h.generateRows(i.result,i.aggregates,null,null,y),this.processAggregates(k,e,s,u.font,u.brush,u.backgroundBrush,!1,null,null,null,!l)):e.rows.addRow().style.setBorder(s),e},n.prototype.getSummaryCaptionThemeStyle=function(){var n,u,i;if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.caption))return{font:new f.PdfStandardFont(f.PdfFontFamily.Helvetica,9.75),brush:new f.PdfSolidBrush(new f.PdfColor(0,0,0)),backgroundBrush:new f.PdfSolidBrush(new f.PdfColor(246,246,246))};var e=t.isNullOrUndefined(this.gridTheme.caption.fontSize)?9.75:this.gridTheme.caption.fontSize,o=t.isNullOrUndefined(this.gridTheme.caption.fontName)?f.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.caption.fontName),s=this.getFontStyle(this.gridTheme.caption),r=new f.PdfColor(0,0,0);return t.isNullOrUndefined(this.gridTheme.caption.fontColor)||(n=this.hexToRgb(this.gridTheme.caption.fontColor),r=new f.PdfColor(n.r,n.g,n.b)),u=this.gridTheme.caption.border?this.getBorderStyle(this.gridTheme.caption.border):null,i=new f.PdfStandardFont(o,e,s),t.isNullOrUndefined(this.gridTheme.caption.font)||(i=this.gridTheme.caption.font),{font:i,brush:new f.PdfSolidBrush(r),backgroundBrush:new f.PdfSolidBrush(new f.PdfColor(246,246,246)),border:u}},n.prototype.getGridPdfFont=function(n){var r="fontFamily",u="fontSize",e="fontStyle",o="isTrueType",i=0,v,w,d;if(n.header&&n.header.font){var s=n.header.font[""+r],l=n.header.font[""+u],a=n.header.font[""+e];(i=t.isNullOrUndefined(f.PdfFontStyle[""+a])?0:f.PdfFontStyle[""+a],n.header.font[""+o])?n.header.font=new f.PdfTrueTypeFont(s,l,i):(v=t.isNullOrUndefined(s)?f.PdfFontFamily.Helvetica:this.getFontFamily(s),n.header.font=new f.PdfStandardFont(v,l,i))}if(n.caption&&n.caption.font){var h=n.caption.font[""+r],y=n.caption.font[""+u],p=n.caption.font[""+e];(i=t.isNullOrUndefined(f.PdfFontStyle[""+p])?0:f.PdfFontStyle[""+p],n.caption.font[""+o])?n.caption.font=new f.PdfTrueTypeFont(h,y,i):(w=t.isNullOrUndefined(h)?f.PdfFontFamily.Helvetica:this.getFontFamily(h),n.caption.font=new f.PdfStandardFont(w,y,i))}if(n.record&&n.record.font){var c=n.record.font[""+r],b=n.record.font[""+u],k=n.record.font[""+e];(i=t.isNullOrUndefined(f.PdfFontStyle[""+k])?0:f.PdfFontStyle[""+k],n.record.font[""+o])?n.record.font=new f.PdfTrueTypeFont(c,b,i):(d=t.isNullOrUndefined(c)?f.PdfFontFamily.Helvetica:this.getFontFamily(c),n.record.font=new f.PdfStandardFont(d,b,i))}},n.prototype.getHeaderThemeStyle=function(){var r=new f.PdfBorders,n,i;if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.header))return r.all=new f.PdfPen(new f.PdfColor(234,234,234)),{border:r,font:new f.PdfStandardFont(f.PdfFontFamily.Helvetica,10.5),brush:new f.PdfSolidBrush(new f.PdfColor(102,102,102))};var e=t.isNullOrUndefined(this.gridTheme.header.fontName)?f.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.header.fontName),o=this.getFontStyle(this.gridTheme.header),s=t.isNullOrUndefined(this.gridTheme.header.fontSize)?10.5:this.gridTheme.header.fontSize,u=new f.PdfColor;return t.isNullOrUndefined(this.gridTheme.header.fontColor)||(n=this.hexToRgb(this.gridTheme.header.fontColor),u=new f.PdfColor(n.r,n.g,n.b)),i=new f.PdfStandardFont(e,s,o),t.isNullOrUndefined(this.gridTheme.header.font)||(i=this.gridTheme.header.font),{border:this.getBorderStyle(this.gridTheme.header.border),font:i,brush:new f.PdfSolidBrush(u)}},n.prototype.processGroupedRecords=function(n,i,r,u,e,o,s,h,c,l,a,v,y){for(var w=this,p=o,g=function(o){var b=n.rows.addRow(),d=u.getColumnByField(o.field),g={value:o.key,column:d,style:void 0,isForeignKey:d.isForeignColumn()},nt={captionText:u.getColumnByField(o.field).headerText+": "+(d.enableGroupByFormat?o.key:k.exportValueFormatter.formatCellValue(g))+" - "+o.count+(i.count>1?" items":" item"),type:"PDF",data:o,style:void 0};k.parent.trigger(ky,nt,function(k){var d,g;b.cells.getCell(p).value=k.captionText;b.cells.getCell(p).style.stringFormat=new f.PdfStringFormat(f.PdfTextAlignment.Left);b.style.setBorder(e);b.style.setFont(s);b.style.setTextBrush(h);b.style.setBackgroundBrush(c);t.isNullOrUndefined(k.style)||w.processCellStyle(b.cells.getCell(p),k);g=new fh(u);d=t.isNullOrUndefined(o.items.records)?g.generateRows(o.items,o):g.generateRows(o.items.records,o);t.isNullOrUndefined(d)||0!==d.length||(b.cells.getCell(p+1).columnSpan=n.columns.count-(p+1));!t.isNullOrUndefined(i.childLevels)&&i.childLevels>0?(w.processAggregates(d,n,e,s,h,c,!0,b,p,null,null,u),w.processGroupedRecords(n,o.items,r,u,e,p+1,s,h,c,l,a,v,y),y=w.rowIndex,d=new uo(u).generateRows(o.items.records,o),w.processAggregates(d,n,e,s,h,c,!1)):(w.processAggregates(d,n,e,s,h,c,!0,b,p,null,null,u),y=w.processRecord(e,r,u,o.items,n,p+1,a,v,y),d=new uo(u).generateRows(o.items,o),w.processAggregates(d,n,e,s,h,c,!1,null,null,!0,null,u))})},k=this,b=0,d=i;b<d.length;b++)g(d[b])},n.prototype.processGridHeaders=function(n,i,r,u,e,s,h,c,l,a){for(var b,k,v=this,d=u.length+n,g=kh(a),nt=a,p=0,y=[],w=0;w<r.length;w++)y[parseInt(w.toString(),10)]=0;return c.groupSettings.columns.length&&(p=c.groupSettings.columns.length-1,d-=1),i.columns.add(d),i.headers.add(r.length),b=function(n,u,l,a,p){var b=i.headers.getHeader(n),w=b.cells.getCell(u),g=r[parseInt(n.toString(),10)].cells[c.groupSettings.columns.length?u:y[parseInt(n.toString(),10)]],k;y[parseInt(n.toString(),10)]=y[parseInt(n.toString(),10)]+1;t.isNullOrUndefined(l.headerTextAlign)||(w.style.stringFormat=v.getHorizontalAlignment(l.headerTextAlign));a>0&&(w.rowSpan=a,w.style.stringFormat=v.getVerticalAlignment("Bottom",w.style.stringFormat,l.textAlign));p>0&&(w.columnSpan=p);b.style.setBorder(e);b.style.setFont(s);b.style.setTextBrush(h);w.value=l.headerText;t.isNullOrUndefined(g)||g.cellType!==o.HeaderIndent&&g.cellType!==o.DetailHeader||(w.value="",w.width=20);k={cell:w,gridCell:g,style:w.style};v.parent.trigger(tn,k);var d=k,nt=k.style.borders,tt=k.style.font,it=k.style.textBrush;t.isNullOrUndefined(nt)||b.style.setBorder(nt);t.isNullOrUndefined(tt)||b.style.setFont(tt);t.isNullOrUndefined(it)||b.style.setTextBrush(it);t.isNullOrUndefined(d.style.verticalAlignment)||(w.style.stringFormat=v.getVerticalAlignment(d.style.verticalAlignment,w.style.stringFormat));t.isNullOrUndefined(d.image)||(w.value=new f.PdfBitmap(d.image.base64));t.isNullOrUndefined(d.hyperLink)||(w.value=v.setHyperLink(d))},k=function(n,t,i,r,u,f){for(var o,s=0,e=0;e<n.length;e++)(f&&(r=s=s+i+(0===e?0:-1),i=0),f||n[parseInt(e.toString(),10)].visible||(r-=1),n[parseInt(e.toString(),10)].columns&&n[parseInt(e.toString(),10)].columns.length)?(o=k(n[parseInt(e.toString(),10)].columns,t-1,0,e+r,u+1,!1),b(u,e+r+p,n[parseInt(e.toString(),10)],0,o),i+=o,r=r+o-1):(n[parseInt(e.toString(),10)].visible||v.hideColumnInclude)&&(i++,b(u,e+r+p,n[parseInt(e.toString(),10)],t,0));return i},k(nt,g,0,0,0,!0),i.columns.count>=6&&l&&(i.style.allowHorizontalOverflow=!0),i},n.prototype.processExportProperties=function(n,i){var r;if(t.isNullOrUndefined(n))this.currentViewData=!1,this.customDataSource=!1;else{if(t.isNullOrUndefined(n.theme)||(this.gridTheme=n.theme),r=this.pdfPageSettings.size,this.drawHeader(n),!t.isNullOrUndefined(n.footer)){var u=n.footer,e=new f.PointF(0,r.width-80-.75*u.fromBottom),o=new f.SizeF(r.width-80,.75*u.height),s=new f.RectangleF(e,o);this.pdfDocument.template.bottom=this.drawPageTemplate(new f.PdfPageTemplateElement(s),u)}t.isNullOrUndefined(n.includeHiddenColumn)||this.isGrouping||(this.hideColumnInclude=n.includeHiddenColumn);t.isNullOrUndefined(n.dataSource)?t.isNullOrUndefined(n.exportType)?(this.currentViewData=!1,this.customDataSource=!1):"CurrentPage"===n.exportType?(i=this.parent.currentViewData,this.currentViewData=!0,this.customDataSource=!1):(this.currentViewData=!1,this.customDataSource=!1):(this.customDataSource=!0,this.currentViewData=!1)}return i},n.prototype.drawHeader=function(n){var r=this,o=this.pdfPageSettings.size,e;if(!t.isNullOrUndefined(n)&&!t.isNullOrUndefined(n.header)){var i=n.header,s=new f.PointF(0,i.fromTop),h=new f.SizeF(o.width-80,.75*i.height),u=new f.RectangleF(s,h);this.headerOnPages.length?(e=this.drawPageTemplate(new f.PdfPageTemplateElement(u),i),this.headerOnPages.filter(function(n){n-1>=0&&n-1<=r.pdfDocument.pages.count-1&&r.pdfDocument.pages.getPageByIndex(n-1).graphics.drawPdfTemplate(e.template,new f.PointF(0,0))})):this.pdfDocument.template.top=this.drawPageTemplate(new f.PdfPageTemplateElement(u),i)}},n.prototype.drawPageTemplate=function(n,t){for(var i,r=0,u=t.contents;r<u.length;r++){i=u[r];switch(this.processContentValidation(i),i.type){case"Text":if(""===i.value||void 0===i.value||null===i.value||"string"!=typeof i.value)throw new Error("please enter the valid input value in text content...");this.drawText(n,i);break;case"PageNumber":this.drawPageNumber(n,i);break;case"Image":if(void 0===i.src||null===i.src||""===i.src)throw new Error("please enter the valid base64 string in image content...");this.drawImage(n,i);break;case"Line":this.drawLine(n,i);break;default:throw new Error("Please set valid content type...");}}return n},n.prototype.processContentValidation=function(n){if(void 0===n.type||null===n.type)throw new Error("please set valid content type...");if("Line"===n.type){if(void 0===n.points||null===n.points)throw new Error("please enter valid points in "+n.type+" content...");if(void 0===n.points.x1||null===n.points.x1||"number"!=typeof n.points.x1)throw new Error("please enter valid x1 co-ordinate in "+n.type+" points...");if(void 0===n.points.y1||null===n.points.y1||"number"!=typeof n.points.y1)throw new Error("please enter valid y1 co-ordinate in "+n.type+" points...");if(void 0===n.points.x2||null===n.points.x2||"number"!=typeof n.points.x2)throw new Error("please enter valid x2 co-ordinate in "+n.type+" points...");if(void 0===n.points.y2||null===n.points.y2||"number"!=typeof n.points.y2)throw new Error("please enter valid y2 co-ordinate in "+n.type+" points...");}else{if(void 0===n.position||null===n.position)throw new Error("please enter valid position in "+n.type+" content...");if(void 0===n.position.x||null===n.position.x||"number"!=typeof n.position.x)throw new Error("please enter valid x co-ordinate in "+n.type+" position...");if(void 0===n.position.y||null===n.position.y||"number"!=typeof n.position.y)throw new Error("please enter valid y co-ordinate in "+n.type+" position...");}},n.prototype.drawText=function(n,i){var h=this.getFont(i),u=this.getBrushFromContent(i),e=null,o,r;t.isNullOrUndefined(i.style.textPenColor)||(o=this.hexToRgb(i.style.textPenColor),e=new f.PdfPen(new f.PdfColor(o.r,o.g,o.b)));null==u&&null==e&&(u=new f.PdfSolidBrush(new f.PdfColor(0,0,0)));var c=i.value.toString(),l=.75*i.position.x,a=.75*i.position.y,s=new f.PdfStringFormat;t.isNullOrUndefined(i.style.stringFormat)||(s.alignment=i.style.stringFormat.alignment);r=this.setContentFormat(i,s);null===r||t.isNullOrUndefined(r.format)||t.isNullOrUndefined(r.size)?n.graphics.drawString(c,h,e,u,l,a,s):n.graphics.drawString(c,h,e,u,l,a,r.size.width,r.size.height,r.format)},n.prototype.drawPageNumber=function(n,i){var e=this.getFont(i),o=null,a,u,r,l,s,h,v;t.isNullOrUndefined(i.style.textBrushColor)?o=new f.PdfSolidBrush(new f.PdfColor(0,0,0)):(a=this.hexToRgb(i.style.textBrushColor),o=new f.PdfSolidBrush(new f.PdfColor(a.r,a.g,a.b)));l=new f.PdfPageNumberField(e,o);(l.numberStyle=this.getPageNumberStyle(i.pageNumberType),t.isNullOrUndefined(i.format))?(r="{0}",u=new f.PdfCompositeField(e,o,r,l)):(s="$total",h="$current",-1!==i.format.indexOf(s)&&-1!==i.format.indexOf(h)?((v=new f.PdfPageCountField(e)).numberStyle=this.getPageNumberStyle(i.pageNumberType),r=i.format.indexOf(s)>i.format.indexOf(h)?(r=i.format.replace(h,"0")).replace(s,"1"):(r=i.format.replace(h,"1")).replace(s,"0"),u=new f.PdfCompositeField(e,o,r,l,v)):-1!==i.format.indexOf(h)&&-1===i.format.indexOf(s)?(r=i.format.replace(h,"0"),u=new f.PdfCompositeField(e,o,r,l)):(v=new f.PdfPageCountField(e),r=i.format.replace(s,"0"),u=new f.PdfCompositeField(e,o,r,v)));var y=.75*i.position.x,p=.75*i.position.y,c=this.setContentFormat(i,u.stringFormat);null===c||t.isNullOrUndefined(c.format)||t.isNullOrUndefined(c.size)||(u.stringFormat=c.format,u.bounds=new f.RectangleF(y,p,c.size.width,c.size.height));u.draw(n.graphics,y,p)},n.prototype.drawImage=function(n,i){var r=.75*i.position.x,u=.75*i.position.y,e=t.isNullOrUndefined(i.size)?void 0:.75*i.size.width,s=t.isNullOrUndefined(i.size)?void 0:.75*i.size.height,o=new f.PdfBitmap(i.src);t.isNullOrUndefined(e)?n.graphics.drawImage(o,r,u):n.graphics.drawImage(o,r,u,e,s)},n.prototype.drawLine=function(n,i){var u=.75*i.points.x1,f=.75*i.points.y1,e=.75*i.points.x2,o=.75*i.points.y2,r=this.getPenFromContent(i);t.isNullOrUndefined(i.style)||null===i.style||(t.isNullOrUndefined(i.style.penSize)||null===i.style.penSize||"number"!=typeof i.style.penSize||(r.width=.75*i.style.penSize),r.dashStyle=this.getDashStyle(i.style.dashStyle));n.graphics.drawLine(r,u,f,e,o)},n.prototype.processAggregates=function(n,i,r,u,f,e,s,h,c,l,a,v){for(var y,p,b,et,ot,it,rt=0,ut=n;rt<ut.length;rt++){var d=ut[rt],g=-1,k=0,tt=!0,w=[],ct=a?0:1,nt=void 0;for(t.isNullOrUndefined(h)&&((nt=i.rows.addRow()).style.setBorder(r),nt.style.setFont(u),nt.style.setTextBrush(f),nt.style.setBackgroundBrush(e)),y=0;y<i.columns.count+ct;y++)if(p=d.cells[parseInt(k.toString(),10)],p.cellType!==o.DetailFooterIntent){if(!this.hideColumnInclude){for(;void 0===p.visible;)p.cellType!==o.DetailFooterIntent&&(t.isNullOrUndefined(h)||t.isNullOrUndefined(h.cells.getCell(y).value)?w.push(""):(w.push(h.cells.getCell(y).value),tt=!1,s||(y+=1)),y+=1,k+=1,p=d.cells[parseInt(k.toString(),10)]);for(;!t.isNullOrUndefined(p.visible)&&!p.visible;)k+=1,p=d.cells[parseInt(k.toString(),10)]}if(p.isDataCell){var ft={},st=!t.isNullOrUndefined(p.column.footerTemplate),ht=!t.isNullOrUndefined(p.column.groupFooterTemplate),lt=!t.isNullOrUndefined(p.column.groupCaptionTemplate);st||lt||ht?(ft=(it=this.getTemplateFunction(ft,y,g,p)).templateFunction,g=it.leastCaptionSummaryIndex,b=void 0,et=d.data[p.column.field?p.column.field:p.column.columnName],(this.parent.isReact||this.parent.isVue||this.parent.isVue3||this.parent.isAngular)&&"string"!=typeof p.column.footerTemplate&&"string"!=typeof p.column.groupFooterTemplate&&"string"!=typeof p.column.groupCaptionTemplate?(b=et[p.column.type],b=t.isNullOrUndefined(b)?"":b):(b=ft[t.getEnumValue(o,p.cellType)](et,this.parent),b=t.isNullOrUndefined(b[0])?"":b[0].textContent),tt=!1,ot={row:d,type:st?"Footer":ht?"GroupFooter":"GroupCaption",style:t.isNullOrUndefined(h)?nt.cells:h.cells,cell:p,value:b},this.parent.trigger(ntt,ot),w.push(ot.value)):(it=this.getSummaryWithoutTemplate(d.data[p.column.field]),t.isNullOrUndefined(it)||w.push(it))}else w.push("");tt&&""!==w[parseInt(y.toString(),10)]&&!t.isNullOrUndefined(w[parseInt(y.toString(),10)])&&null!==w[parseInt(y.toString(),10)]&&(tt=!1);k+=1}else y--,k++;if(!a)if(s)for(y=v.groupSettings.columns.length;y<w.length-1;y++)w[parseInt(y.toString(),10)]=w[y+1],w[y+1]=w[y+2]?w[y+2]:"";else w.splice(0,1);if(!tt)if(s)for(y=0;y<i.columns.count;y++)h.cells.getCell(y).value=w[parseInt(y.toString(),10)].toString(),y===c&&-1!==g&&1!==g?h.cells.getCell(y).columnSpan=g-1-c:y===c&&-1===g&&(h.cells.getCell(y).columnSpan=i.columns.count-c);else for(y=0;y<i.columns.count;y++)nt.cells.getCell(y).value=w[parseInt(y.toString(),10)].toString()}},n.prototype.getTemplateFunction=function(n,i,r,u){return t.isNullOrUndefined(u.column.footerTemplate)||u.cellType!==o.Summary?t.isNullOrUndefined(u.column.groupCaptionTemplate)?n[t.getEnumValue(o,o.GroupSummary)]=t.compile(u.column.groupFooterTemplate):(-1===r&&(r=i),n[t.getEnumValue(o,o.CaptionSummary)]=t.compile(u.column.groupCaptionTemplate)):n[t.getEnumValue(o,o.Summary)]=t.compile(u.column.footerTemplate),{templateFunction:n,leastCaptionSummaryIndex:r}},n.prototype.getSummaryWithoutTemplate=function(n){return t.isNullOrUndefined(n.Sum)?t.isNullOrUndefined(n.Average)?t.isNullOrUndefined(n.Max)?t.isNullOrUndefined(n.Min)?t.isNullOrUndefined(n.Count)?t.isNullOrUndefined(n.TrueCount)?t.isNullOrUndefined(n.FalseCount)?t.isNullOrUndefined(n.Custom)?void 0:n.Custom:n.FalseCount:n.TrueCount:n.Count:n.Min:n.Max:n.Average:n.Sum},n.prototype.setColumnProperties=function(n,i,r,u,f){for(var o=u.groupSettings.columns.length?u.groupSettings.columns.length-1:0,e=0;e<o;e++)i.columns.getColumn(e).width=20;for(e=0;e<n.length;e++)t.isNullOrUndefined(n[parseInt(e.toString(),10)].textAlign)||(i.columns.getColumn(e+o).format=this.getHorizontalAlignment(n[parseInt(e.toString(),10)].textAlign)),i.style.allowHorizontalOverflow&&!t.isNullOrUndefined(n[parseInt(e.toString(),10)].width)&&f&&(i.columns.getColumn(e+o).width="number"==typeof n[parseInt(e.toString(),10)].width?.75*n[parseInt(e.toString(),10)].width:.75*r.getConvertedWidth(n[parseInt(e.toString(),10)].width))},n.prototype.setRecordThemeStyle=function(n,i){var u,r,o;if(t.isNullOrUndefined(this.gridTheme)||t.isNullOrUndefined(this.gridTheme.record))n.style.setTextBrush(new f.PdfSolidBrush(new f.PdfColor(0,0,0)));else{var s=t.isNullOrUndefined(this.gridTheme.record.fontName)?f.PdfFontFamily.Helvetica:this.getFontFamily(this.gridTheme.record.fontName),h=t.isNullOrUndefined(this.gridTheme.record.fontSize)?9.75:this.gridTheme.record.fontSize,c=this.getFontStyle(this.gridTheme.record),e=new f.PdfStandardFont(s,h,c);t.isNullOrUndefined(this.gridTheme.record.font)||(e=this.gridTheme.record.font);n.style.setFont(e);u=new f.PdfColor;t.isNullOrUndefined(this.gridTheme.record.fontColor)||(r=this.hexToRgb(this.gridTheme.record.fontColor),u=new f.PdfColor(r.r,r.g,r.b));n.style.setTextBrush(new f.PdfSolidBrush(u))}return o=this.gridTheme&&this.gridTheme.record&&this.gridTheme.record.border?this.getBorderStyle(this.gridTheme.record.border):i,n.style.setBorder(o),n},n.prototype.processRecord=function(n,i,r,u,e,s,h,c,l){for(var y,tt,g,v,rt,ut,a,k=0,nt=c.getGridRowModel(i,u,r,l);k<nt.length;k++){y=nt[k];l++;this.rowIndex=l;for(var d=this.setRecordThemeStyle(e.rows.addRow(),n),ht=y.cells.length,p=0;p<ht;p++)if(tt=y.cells[parseInt(p.toString(),10)],tt.cellType===o.Data){var w=tt.column,ft=w.field,et=t.isNullOrUndefined(ft)?"":w.valueAccessor(ft,y.data,w),it=t.isNullOrUndefined(et)?"":et,ot=void 0;if(w.isForeignColumn&&w.isForeignColumn()&&(ot=c.getFData(it,w),it=t.getValue(w.foreignKeyValue,ot)),(a={data:y.data,value:it,column:w,style:void 0,colSpan:1,cell:v=d.cells.getCell(p)}).value="boolean"===a.column.type&&"string"==typeof a.value?a.value:this.exportValueFormatter.formatCellValue(a),this.parent.trigger(nn,a),t.isNullOrUndefined(a.image)||(a.value=new f.PdfBitmap(a.image.base64),a.value.height=a.image.height||a.value.height,a.value.width=a.image.width||a.value.width),v.value=a.value,t.isNullOrUndefined(a.hyperLink)||(v.value=this.setHyperLink(a)),t.isNullOrUndefined(a.style)||this.processCellStyle(v,a),a.colSpan>1){for(p+1+a.colSpan>d.cells.count&&(a.colSpan=d.cells.count-(p+1)),v.columnSpan=a.colSpan,g=1;g<v.columnSpan;g++)d.cells.getCell(p+g).value="";p+=a.colSpan-1}}if(y.isExpand){rt=this.setRecordThemeStyle(e.rows.addRow(),n);ut=this.parent.childGrid?0:s;(v=rt.cells.getCell(ut)).columnSpan=rt.cells.count-ut;v.style.cellPadding=new f.PdfPaddings(10,10,10,10);r.isPrinting=!0;var ct=!t.isNullOrUndefined(h)&&h.exportType?h.exportType:"AllPages",st=this.helper.createChildGrid(r,y,ct,this.gridPool),b=st.childGrid,lt=st.element;b.actionFailure=c.failureHandler(this.gridPool,b,this.globalResolve);a={childGrid:b,row:y,cell:v,exportProperties:h};this.parent.trigger(sp,a);b.beforeDataBound=this.childGridCell(v,b,h);b.appendTo(lt)}this.parent.notify(yp,{type:"pdf",rowObj:y})}return l},n.prototype.setHyperLink=function(n){var t=new f.PdfTextWebLink;return t.url=n.hyperLink.target,t.text=n.hyperLink.displayText||n.hyperLink.target,t.font=new f.PdfStandardFont(f.PdfFontFamily.Helvetica,9.75),t.brush=new f.PdfSolidBrush(new f.PdfColor(51,102,187)),t},n.prototype.childGridCell=function(n,i,r){var u=this;return function(f){return i.beforeDataBound=null,f.cancel=!0,n.value=u.processGridExport(i,f,r),i.destroy(),t.detach(i.element),u.gridPool[i.id]=!0,u.helper.checkAndExport(u.gridPool,u.globalResolve),n}},n.prototype.processCellStyle=function(n,i){var r,u,e,o,h;if(t.isNullOrUndefined(i.style.backgroundColor)||(r=this.hexToRgb(i.style.backgroundColor),n.style.backgroundBrush=new f.PdfSolidBrush(new f.PdfColor(r.r,r.g,r.b))),(t.isNullOrUndefined(i.style.textAlignment)||(n.style.stringFormat=this.getHorizontalAlignment(i.style.textAlignment)),t.isNullOrUndefined(i.style.cellPadding)||(n.style.cellPadding=i.style.cellPadding),t.isNullOrUndefined(i.style.verticalAlignment)||(n.style.stringFormat=this.getVerticalAlignment(i.style.verticalAlignment,n.style.stringFormat)),t.isNullOrUndefined(i.style.textBrushColor))||(u=this.hexToRgb(i.style.textBrushColor),n.style.textBrush=new f.PdfSolidBrush(new f.PdfColor(u.r,u.g,u.b))),t.isNullOrUndefined(i.style.textPenColor)||(e=this.hexToRgb(i.style.textPenColor),n.style.textPen=new f.PdfPen(new f.PdfColor(e.r,e.g,e.b))),t.isNullOrUndefined(i.style.fontFamily)&&t.isNullOrUndefined(i.style.fontSize)&&t.isNullOrUndefined(i.style.bold)&&t.isNullOrUndefined(i.style.italic)&&t.isNullOrUndefined(i.style.underline)&&t.isNullOrUndefined(i.style.strikeout)||(n.style.font=this.getFont(i)),!t.isNullOrUndefined(i.style.border)){var c=new f.PdfBorders,s=i.style.border.width,a=t.isNullOrUndefined(s)||"number"!=typeof s?void 0:.75*s,l=new f.PdfColor(196,196,196);t.isNullOrUndefined(i.style.border.color)||(o=this.hexToRgb(i.style.border.color),l=new f.PdfColor(o.r,o.g,o.b));h=new f.PdfPen(l,a);t.isNullOrUndefined(i.style.border.dashStyle)||(h.dashStyle=this.getDashStyle(i.style.border.dashStyle));c.all=h;n.style.borders=c}t.isNullOrUndefined(i.style.paragraphIndent)||(n.style.stringFormat=new f.PdfStringFormat,n.style.stringFormat.paragraphIndent=i.style.paragraphIndent)},n.prototype.getHorizontalAlignment=function(n,t){switch(void 0===t&&(t=new f.PdfStringFormat),n){case"Right":t.alignment=f.PdfTextAlignment.Right;break;case"Center":t.alignment=f.PdfTextAlignment.Center;break;case"Justify":t.alignment=f.PdfTextAlignment.Justify;break;case"Left":t.alignment=f.PdfTextAlignment.Left}return t},n.prototype.getVerticalAlignment=function(n,t,i){switch(void 0===t&&(t=new f.PdfStringFormat,t=this.getHorizontalAlignment(i,t)),n){case"Bottom":t.lineAlignment=f.PdfVerticalAlignment.Bottom;break;case"Middle":t.lineAlignment=f.PdfVerticalAlignment.Middle;break;case"Top":t.lineAlignment=f.PdfVerticalAlignment.Top}return t},n.prototype.getFontFamily=function(n){switch(n){case"TimesRoman":return 2;case"Courier":return 1;case"Symbol":return 3;case"ZapfDingbats":return 4;default:return 0}},n.prototype.getFont=function(n){if(n.font)return n.font;var r=t.isNullOrUndefined(n.style.fontSize)?9.75:.75*n.style.fontSize,u=t.isNullOrUndefined(n.style.fontFamily)?f.PdfFontFamily.TimesRoman:this.getFontFamily(n.style.fontFamily),i=f.PdfFontStyle.Regular;return!t.isNullOrUndefined(n.style.bold)&&n.style.bold&&(i|=f.PdfFontStyle.Bold),!t.isNullOrUndefined(n.style.italic)&&n.style.italic&&(i|=f.PdfFontStyle.Italic),!t.isNullOrUndefined(n.style.underline)&&n.style.underline&&(i|=f.PdfFontStyle.Underline),!t.isNullOrUndefined(n.style.strikeout)&&n.style.strikeout&&(i|=f.PdfFontStyle.Strikeout),new f.PdfStandardFont(u,r,i)},n.prototype.getPageNumberStyle=function(n){switch(n){case"LowerLatin":return 2;case"LowerRoman":return 3;case"UpperLatin":return 4;case"UpperRoman":return 5;default:return 1}},n.prototype.setContentFormat=function(n,i){if(!t.isNullOrUndefined(n.size)){var r=.75*n.size.width,u=.75*n.size.height;if(i=new f.PdfStringFormat(f.PdfTextAlignment.Left,f.PdfVerticalAlignment.Middle),!t.isNullOrUndefined(n.style.hAlign))switch(n.style.hAlign){case"Right":i.alignment=f.PdfTextAlignment.Right;break;case"Center":i.alignment=f.PdfTextAlignment.Center;break;case"Justify":i.alignment=f.PdfTextAlignment.Justify;break;default:i.alignment=f.PdfTextAlignment.Left}return t.isNullOrUndefined(n.style.vAlign)||(i=this.getVerticalAlignment(n.style.vAlign,i)),{format:i,size:new f.SizeF(r,u)}}return null},n.prototype.getPageSize=function(n){switch(n){case"Letter":return new f.SizeF(612,792);case"Note":return new f.SizeF(540,720);case"Legal":return new f.SizeF(612,1008);case"A0":return new f.SizeF(2380,3368);case"A1":return new f.SizeF(1684,2380);case"A2":return new f.SizeF(1190,1684);case"A3":return new f.SizeF(842,1190);case"A5":return new f.SizeF(421,595);case"A6":return new f.SizeF(297,421);case"A7":return new f.SizeF(210,297);case"A8":return new f.SizeF(148,210);case"A9":return new f.SizeF(105,148);case"B0":return new f.SizeF(2836,4008);case"B1":return new f.SizeF(2004,2836);case"B2":return new f.SizeF(1418,2004);case"B3":return new f.SizeF(1002,1418);case"B4":return new f.SizeF(709,1002);case"B5":return new f.SizeF(501,709);case"Archa":return new f.SizeF(648,864);case"Archb":return new f.SizeF(864,1296);case"Archc":return new f.SizeF(1296,1728);case"Archd":return new f.SizeF(1728,2592);case"Arche":return new f.SizeF(2592,3456);case"Flsa":return new f.SizeF(612,936);case"HalfLetter":return new f.SizeF(396,612);case"Letter11x17":return new f.SizeF(792,1224);case"Ledger":return new f.SizeF(1224,792);default:return new f.SizeF(595,842)}},n.prototype.getDashStyle=function(n){switch(n){case"Dash":return 1;case"Dot":return 2;case"DashDot":return 3;case"DashDotDot":return 4;default:return 0}},n.prototype.getPenFromContent=function(n){var r=new f.PdfPen(new f.PdfColor(0,0,0)),i;return t.isNullOrUndefined(n.style)||null===n.style||t.isNullOrUndefined(n.style.penColor)||(i=this.hexToRgb(n.style.penColor),r=new f.PdfPen(new f.PdfColor(i.r,i.g,i.b))),r},n.prototype.getBrushFromContent=function(n){var r=null,i;return t.isNullOrUndefined(n.style.textBrushColor)||(i=this.hexToRgb(n.style.textBrushColor),r=new f.PdfSolidBrush(new f.PdfColor(i.r,i.g,i.b))),r},n.prototype.hexToRgb=function(n){if(null===n||""===n||7!==n.length)throw new Error("please set valid hex value for color...");n=n.substring(1);var t=parseInt(n,16);return{r:t>>16&255,g:t>>8&255,b:255&t}},n.prototype.getFontStyle=function(n){var i=f.PdfFontStyle.Regular;return!t.isNullOrUndefined(n)&&n.bold&&(i|=f.PdfFontStyle.Bold),!t.isNullOrUndefined(n)&&n.italic&&(i|=f.PdfFontStyle.Italic),!t.isNullOrUndefined(n)&&n.underline&&(i|=f.PdfFontStyle.Underline),!t.isNullOrUndefined(n)&&n.strikeout&&(i|=f.PdfFontStyle.Strikeout),i},n.prototype.getBorderStyle=function(n){var r=new f.PdfBorders,i,e;if(t.isNullOrUndefined(n))r.all=new f.PdfPen(new f.PdfColor(234,234,234));else{var u=n.width,s=t.isNullOrUndefined(u)||"number"!=typeof u?void 0:.75*u,o=new f.PdfColor(196,196,196);t.isNullOrUndefined(n.color)||(i=this.hexToRgb(n.color),o=new f.PdfColor(i.r,i.g,i.b));e=new f.PdfPen(o,s);t.isNullOrUndefined(n.dashStyle)||(e.dashStyle=this.getDashStyle(n.dashStyle));r.all=e}return r},n.prototype.destroy=function(){},n}(),cct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),sft=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.buttonElement=r.parent.createElement("button",{}),r.unbounDiv=r.parent.createElement("div",{className:"e-unboundcelldiv",styles:"display: inline-block"}),r.childRefs=[],r.element=r.parent.createElement("TD",{className:"e-rowcell e-unboundcell",attrs:{tabindex:"-1"}}),r.parent.on(v,r.destroyButtons,r),r.parent.on(ya,r.destroyButtons,r),r}return cct(i,n),i.prototype.destroyButtons=function(n){for(var i,t=0;t<this.childRefs.length;t++)this.childRefs[parseInt(t.toString(),10)]&&!this.childRefs[parseInt(t.toString(),10)].isDestroyed&&(this.childRefs[parseInt(t.toString(),10)].destroy(),this.childRefs[parseInt(t.toString(),10)].element&&(this.childRefs[parseInt(t.toString(),10)].element.innerHTML=""));if(this.childRefs=[],"refreshCommandColumn"===n.type){if(i=this.parent.element.querySelectorAll(".e-unboundcell"),i.length){for(t=0;t<i.length;t++)i[parseInt(t.toString(),10)]&&(i[parseInt(t.toString(),10)].querySelector(".e-unboundcelldiv")&&(i[parseInt(t.toString(),10)].querySelector(".e-unboundcelldiv").innerHTML=""),i[parseInt(t.toString(),10)].innerHTML="");i=null}}else this.parent.off(v,this.destroyButtons),this.parent.off(ya,this.destroyButtons)},i.prototype.render=function(n,i,r,u){var f=this.element.cloneNode(),h,e,o,s;if(f.appendChild(this.unbounDiv.cloneNode()),f.setAttribute("aria-label",this.localizer.getConstant("CommandColumnAria")+n.column.headerText),n.column.commandsTemplate)this.parent.isReact&&"string"!=typeof n.column.commandsTemplate?(h=this.parent+"commandsTemplate",n.column.getColumnTemplate()(i,this.parent,"commandsTemplate",h,null,null,f.firstElementChild),this.parent.renderTemplates()):kt(f.firstElementChild,n.column.getColumnTemplate()(i));else for(e=0,o=n.commands;e<o.length;e++)s=o[e],f=this.renderButton(f,s,r.index,s.uid);return this.setAttributes(f,n,r),!this.parent.enableVirtualization&&this.parent.isEdit||u?(t.addClass([].slice.call(f.getElementsByClassName("e-edit-delete")),"e-hide"),t.removeClass([].slice.call(f.getElementsByClassName("e-save-cancel")),"e-hide")):(t.addClass([].slice.call(f.getElementsByClassName("e-save-cancel")),"e-hide"),t.removeClass([].slice.call(f.getElementsByClassName("e-edit-delete")),"e-hide")),f},i.prototype.renderButton=function(n,i,r,u){var f=this.buttonElement.cloneNode(),e;t.attributes(f,{id:this.parent.element.id+(i.type||"")+"_"+r+"_"+u,type:"button",title:t.isNullOrUndefined(i.title)?i.buttonOption.content||this.localizer.getConstant(i.type)||i.type:i.title,"data-uid":u});f.onclick=i.buttonOption.click;i.buttonOption.cssClass=this.parent.cssClass?i.buttonOption.cssClass+" "+this.parent.cssClass:i.buttonOption.cssClass;e=new fi.Button(i.buttonOption,f);switch(this.childRefs.push(e),e.commandType=i.type,n.firstElementChild.appendChild(e.element),i.type){case"Edit":case"Delete":t.addClass([f],["e-edit-delete","e-"+i.type.toLowerCase()+"button"]);break;case"Cancel":case"Save":t.addClass([f],["e-save-cancel","e-"+i.type.toLowerCase()+"button"])}return n},i}(si),lct=function(){function n(n,t){this.parent=n;this.locator=t;this.initiateRender();this.addEventListener()}return n.prototype.initiateRender=function(){this.locator.getService("cellRendererFactory").addCellRenderer(o.CommandColumn,new sft(this.parent,this.locator))},n.prototype.commandClickHandler=function(n){var i=this.parent,r=t.closest(n.target,"button"),u,f,a,o,b;if(r&&t.closest(n.target,".e-unboundcell")){for(var s,v=r.ej2_instances[0],c=v.commandType,p=r.getAttribute("data-uid"),w=i.getRowObjectFromUID(t.closest(r,"."+y).getAttribute("data-uid")),l=this.parent.columnModel,e=0;e<l.length;e++)if(l[parseInt(e.toString(),10)].commands)for(u=l[parseInt(e.toString(),10)].commands,f=0;f<u.length;f++)a="type",u[parseInt(f.toString(),10)].uid===p&&u[parseInt(f.toString(),10)][""+a]===c?s=u[parseInt(f.toString(),10)]:(o=[].slice.call(t.closest(r,".e-unboundcell").querySelectorAll("button")).findIndex(function(n){return n===r}),o<u.length&&u[parseInt(o.toString(),10)][""+a]===c&&String(u[parseInt(f.toString(),10)].uid)===p&&(s=u[parseInt(o.toString(),10)]));b={cancel:!1,target:r,commandColumn:s,rowData:t.isNullOrUndefined(w)?void 0:w.data};this.parent.trigger(hg,b,function(n){if(!v.disabled&&i.editModule&&!n.cancel)switch(c){case"Edit":i.editModule.endEdit();i.editModule.startEdit(t.closest(r,"tr"));break;case"Cancel":i.editModule.closeEdit();break;case"Save":i.editModule.endEdit();break;case"Delete":"Batch"!==i.editSettings.mode&&i.editModule.endEdit();i.commandDelIndex=parseInt(t.closest(r,"tr").getAttribute(h),10);i.clearSelection();i.selectRow(i.commandDelIndex,!1);i.editModule.deleteRecord();i.commandDelIndex=void 0}})}},n.prototype.getModuleName=function(){return"commandColumn"},n.prototype.destroy=function(){this.parent.isDestroyed||this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ii,this.commandClickHandler),this.parent.off(ht,this.keyPressHandler),this.parent.off(dt,this.load),this.parent.off(v,this.destroy))},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(ii,this.commandClickHandler,this),this.parent.on(ht,this.keyPressHandler,this),this.parent.on(dt,this.load,this),this.parent.on(v,this.destroy,this))},n.prototype.keyPressHandler=function(n){"enter"===n.action&&t.closest(n.target,".e-unboundcelldiv")&&(this.commandClickHandler(n),n.preventDefault())},n.prototype.load=function(){for(var r,i,t=this.parent.columnModel,n=0;n<t.length;n++)if(t[parseInt(n.toString(),10)].commands)for(r=t[parseInt(n.toString(),10)].commands,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].uid=tr("gridcommand")},n}(),b={header:"."+ct,content:"."+ot,edit:".e-inline-edit",batchEdit:".e-editedbatchcell",editIcon:"e-edit",pager:".e-gridpager","delete":"e-delete",save:"e-save",cancel:"e-cancel",copy:"e-copy",pdf:"e-pdfexport",group:"e-icon-group",ungroup:"e-icon-ungroup",csv:"e-csvexport",excel:"e-excelexport",fPage:"e-icon-first",nPage:"e-icon-next",lPage:"e-icon-last",pPage:"e-icon-prev",ascending:"e-icon-ascending",descending:"e-icon-descending",groupHeader:"e-groupdroparea",touchPop:"e-gridpopup"},act=function(){function n(n,t){this.defaultItems={};this.disableItems=[];this.hiddenItems=[];this.localeText=this.setLocaleKey();this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(tt,this.enableAfterRenderMenu,this),this.parent.on(cr,this.render,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cr,this.render),this.parent.off(tt,this.enableAfterRenderMenu),this.parent.off(v,this.destroy),t.EventHandler.remove(this.element,"keydown",this.keyDownHandler.bind(this)))},n.prototype.keyDownHandler=function(n){"Tab"!==n.code&&9!==n.which||this.contextMenu.close();"Escape"===n.code&&(this.contextMenu.close(),this.parent.notify(tf,{}))},n.prototype.render=function(){this.parent.element.classList.add("e-noselect");this.l10n=this.serviceLocator.getService("localization");this.element=this.parent.createElement("ul",{id:this.gridID+"_cmenu"});t.EventHandler.add(this.element,"keydown",this.keyDownHandler.bind(this));this.parent.element.appendChild(this.element);var n="#"+this.gridID;this.contextMenu=new wo.ContextMenu({items:this.getMenuItems(),enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,target:n,select:this.contextMenuItemClick.bind(this),beforeOpen:this.contextMenuBeforeOpen.bind(this),onOpen:this.contextMenuOpen.bind(this),onClose:this.contextMenuOnClose.bind(this),cssClass:this.parent.cssClass?"e-grid-menu "+this.parent.cssClass:"e-grid-menu"});this.contextMenu.appendTo(this.element)},n.prototype.enableAfterRenderMenu=function(n){n.module===this.getModuleName()&&n.enable&&(this.contextMenu&&(this.contextMenu.destroy(),t.remove(this.element),this.parent.element.classList.remove("e-noselect")),this.render())},n.prototype.getMenuItems=function(){for(var n,u,t=[],i=[],r=0,f=this.parent.contextMenuItems;r<f.length;r++)n=f[r],"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toLocaleLowerCase().indexOf("export")?i.push(this.buildDefaultItems(n)):t.push(this.buildDefaultItems(n)):"string"!=typeof n&&t.push(n);return i.length>0&&(u=this.buildDefaultItems("export"),u.items=i,t.push(u)),t},n.prototype.getLastPage=function(){var n=Math.floor(this.parent.pageSettings.totalRecordsCount/this.parent.pageSettings.pageSize);return this.parent.pageSettings.totalRecordsCount%this.parent.pageSettings.pageSize&&(n+=1),n},n.prototype.contextMenuOpen=function(){this.isOpen=!0},n.prototype.contextMenuItemClick=function(n){switch(this.getKeyFromId(n.item.id)){case"AutoFitAll":this.parent.autoFitColumns([]);break;case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Edit":this.parent.editModule&&("Batch"===this.parent.editSettings.mode?this.row&&this.cell&&!isNaN(parseInt(this.cell.getAttribute(lt),10))&&this.parent.editModule.editCell(parseInt(this.row.getAttribute(h),10),this.parent.getColumns()[parseInt(this.cell.getAttribute(lt),10)].field):(this.parent.editModule.endEdit(),this.parent.editModule.startEdit(this.row)));break;case"Delete":this.parent.editModule&&("Batch"!==this.parent.editSettings.mode&&this.parent.editModule.endEdit(),1===this.parent.getSelectedRecords().length?this.parent.editModule.deleteRow(this.row):this.parent.deleteRecord());break;case"Save":this.parent.editModule&&this.parent.editModule.endEdit();break;case"Cancel":this.parent.editModule&&this.parent.editModule.closeEdit();break;case"Copy":this.parent.copy();break;case"PdfExport":this.parent.pdfExport();break;case"ExcelExport":this.parent.excelExport();break;case"CsvExport":this.parent.csvExport();break;case"SortAscending":this.isOpen=!1;this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.isOpen=!1;this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"FirstPage":this.parent.goToPage(1);break;case"PrevPage":this.parent.goToPage(this.parent.pageSettings.currentPage-1);break;case"LastPage":this.parent.goToPage(this.getLastPage());break;case"NextPage":this.parent.goToPage(this.parent.pageSettings.currentPage+1)}n.column=this.targetColumn;n.rowInfo=this.targetRowdata;this.parent.trigger(rn,n)},n.prototype.contextMenuOnClose=function(n){n.items.length>0&&n.items[0].parentObj instanceof wo.ContextMenu&&this.updateItemStatus();this.parent.notify(sa,{isOpen:!1})},n.prototype.getLocaleText=function(n){return this.l10n.getConstant(this.localeText[""+n])},n.prototype.updateItemStatus=function(){this.contextMenu.showItems(this.hiddenItems);this.contextMenu.enableItems(this.disableItems);this.hiddenItems=[];this.disableItems=[];this.isOpen=!1},n.prototype.contextMenuBeforeOpen=function(n){var s=t.closest(n.event.target,".e-grid");if(n.event&&s&&s!==this.parent.element)n.cancel=!0;else if(n.event&&(t.closest(n.event.target,"."+b.groupHeader)||t.closest(n.event.target,"."+b.touchPop)||t.closest(n.event.target,".e-summarycell")||t.closest(n.event.target,".e-groupcaption")||t.closest(n.event.target,".e-filterbarcell")))n.cancel=!0;else{this.targetColumn=this.getColumn(n.event);i(n.event.target,"e-grid")&&(this.targetRowdata=this.parent.getRowInfo(n.event.target));t.isNullOrUndefined(n.parentItem)&&this.targetColumn&&this.targetRowdata.cell&&(this.parent.notify(sa,{isOpen:!0}),this.selectRow(n.event,!this.targetRowdata.cell.classList.contains("e-selectionbackground")||"Multiple"!==this.parent.selectionSettings.type));for(var f=[],e=[],o=0,h=n.items;o<h.length;o++){var r=h[o],u=this.getKeyFromId(r.id),c=this.defaultItems[""+u];if(-1!==this.getDefaultItems().indexOf(u))if(this.ensureDisabledStatus(u)&&this.disableItems.push(r.text),n.event&&(this.ensureTarget(n.event.target,b.edit)||this.ensureTarget(n.event.target,b.batchEdit)))"Save"!==u&&"Cancel"!==u&&this.hiddenItems.push(r.text);else{if(this.parent.editModule&&"Batch"===this.parent.editSettings.mode&&(t.closest(n.event.target,".e-gridform")||this.parent.editModule.getBatchChanges()[gf].length||this.parent.editModule.getBatchChanges()[ar].length||this.parent.editModule.getBatchChanges()[eu].length)&&("Save"===u||"Cancel"===u))continue;t.isNullOrUndefined(n.parentItem)&&n.event&&!this.ensureTarget(n.event.target,c.target)&&this.hiddenItems.push(r.text)}else r.target&&n.event&&!this.ensureTarget(n.event.target,r.target)?r.separator?f.push(r.id):this.hiddenItems.push(r.text):this.ensureTarget(n.event.target,r.target)&&r.separator&&e.push(r.id)}e.length>0&&this.contextMenu.showItems(e,!0);this.contextMenu.enableItems(this.disableItems,!1);this.contextMenu.hideItems(this.hiddenItems);f.length>0&&this.contextMenu.hideItems(f,!0);this.eventArgs=n.event;n.column=this.targetColumn;n.rowInfo=this.targetRowdata;this.parent.trigger(un,n);(n.cancel||this.hiddenItems.length===n.items.length&&!n.parentItem)&&(this.updateItemStatus(),n.cancel=!0)}ao(this.parent.element,this.contextMenu.element.parentElement)},n.prototype.ensureTarget=function(n,r){var u;return(u=!this.ensureFrozenHeader(n)||r!==b.header&&r!==b.content?r===b.content||r===b.header?i(t.closest(n,"."+k),r.substr(1,r.length)):t.closest(n,r):t.closest(n,r===b.header?"thead":e))&&i(u,"e-grid")===this.parent.element},n.prototype.ensureFrozenHeader=function(n){return!(!this.parent.isFrozenGrid()&&!this.parent.frozenRows||!t.closest(n,b.header))},n.prototype.ensureDisabledStatus=function(n){var t=!1,r,i;switch(n){case"AutoFitAll":case"AutoFit":t=!(this.parent.ensureModuleInjected(gv)&&!this.parent.isEdit)||this.targetColumn&&!this.targetColumn.field&&"AutoFit"===n;break;case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(sf)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.field)&&(t=!0);break;case"Ungroup":(!this.parent.allowGrouping||!this.parent.ensureModuleInjected(sf)||this.parent.ensureModuleInjected(sf)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"Edit":case"Delete":case"Save":case"Cancel":this.parent.editModule&&0!==this.parent.getDataRows().length||(t=!0);break;case"Copy":(0===this.parent.getSelectedRowIndexes().length&&0===this.parent.getSelectedRowCellIndexes().length||0===this.parent.getCurrentViewRecords().length)&&(t=!0);break;case"export":this.parent.allowExcelExport&&this.parent.excelExport&&(this.parent.ensureModuleInjected(ck)||this.parent.ensureModuleInjected(hk))||(t=!0);break;case"PdfExport":this.parent.allowPdfExport&&this.parent.ensureModuleInjected(ck)||(t=!0);break;case"ExcelExport":case"CsvExport":this.parent.allowExcelExport&&this.parent.ensureModuleInjected(hk)||(t=!0);break;case"SortAscending":case"SortDescending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(bo)&&(!this.targetColumn||this.targetColumn.field)){if(this.parent.ensureModuleInjected(bo)&&this.parent.sortSettings.columns.length>0&&this.targetColumn)for(r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].field===this.targetColumn.field&&r[parseInt(i.toString(),10)].direction.toLowerCase()===n.toLowerCase().replace("sort","").toLocaleLowerCase()&&(t=!0)}else t=!0;break;case"FirstPage":case"PrevPage":this.parent.allowPaging&&this.parent.ensureModuleInjected(tc)&&0!==this.parent.getCurrentViewRecords().length&&(!this.parent.ensureModuleInjected(tc)||1!==this.parent.pageSettings.currentPage)||(t=!0);break;case"LastPage":case"NextPage":this.parent.allowPaging&&this.parent.ensureModuleInjected(tc)&&0!==this.parent.getCurrentViewRecords().length&&(!this.parent.ensureModuleInjected(tc)||this.parent.pageSettings.currentPage!==this.getLastPage())||(t=!0)}return t},n.prototype.getContextMenu=function(){return this.element},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.contextMenu.destroy(),this.element.parentNode&&t.remove(this.element),this.removeEventListener(),this.parent.element.classList.remove("e-noselect"))},n.prototype.getModuleName=function(){return"contextMenu"},n.prototype.generateID=function(n){return this.gridID+"_cmenu_"+n},n.prototype.getKeyFromId=function(n){return n.replace(this.gridID+"_cmenu_","")},n.prototype.buildDefaultItems=function(n){var t;switch(n){case"AutoFitAll":case"AutoFit":t={target:b.header};break;case"Group":t={target:b.header,iconCss:b.group};break;case"Ungroup":t={target:b.header,iconCss:b.ungroup};break;case"Edit":t={target:b.content,iconCss:b.editIcon};break;case"Delete":t={target:b.content,iconCss:b.delete};break;case"Save":t={target:b.edit,iconCss:b.save};break;case"Cancel":t={target:b.edit,iconCss:b.cancel};break;case"Copy":t={target:b.content,iconCss:b.copy};break;case"export":t={target:b.content};break;case"PdfExport":t={target:b.content,iconCss:b.pdf};break;case"ExcelExport":t={target:b.content,iconCss:b.excel};break;case"CsvExport":t={target:b.content,iconCss:b.csv};break;case"SortAscending":t={target:b.header,iconCss:b.ascending};break;case"SortDescending":t={target:b.header,iconCss:b.descending};break;case"FirstPage":t={target:b.pager,iconCss:b.fPage};break;case"PrevPage":t={target:b.pager,iconCss:b.pPage};break;case"LastPage":t={target:b.pager,iconCss:b.lPage};break;case"NextPage":t={target:b.pager,iconCss:b.nPage}}return this.defaultItems[""+n]={text:this.getLocaleText(n),id:this.generateID(n),target:t.target,iconCss:t.iconCss?"e-icons "+t.iconCss:""},this.defaultItems[""+n]},n.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","Group","Ungroup","Edit","Delete","Save","Cancel","Copy","export","PdfExport","ExcelExport","CsvExport","SortAscending","SortDescending","FirstPage","PrevPage","LastPage","NextPage"]},n.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Copy:"Copy",Group:"Group",Ungroup:"Ungroup",Edit:"EditRecord",Delete:"DeleteRecord",Save:"Save",Cancel:"CancelButton",PdfExport:"Pdfexport",ExcelExport:"Excelexport",CsvExport:"Csvexport","export":"Export",SortAscending:"SortAscending",SortDescending:"SortDescending",FirstPage:"FirstPage",LastPage:"LastPage",PrevPage:"PreviousPage",NextPage:"NextPage"}},n.prototype.getColumn=function(n){var i=t.closest(n.target,"th.e-headercell"),r;return i?(r=i.querySelector(".e-headercelldiv, .e-stackedheadercelldiv").getAttribute("e-mappinguid"),this.parent.getColumnByUid(r)):this.parent.getRowInfo(n.target).column||null},n.prototype.selectRow=function(n,r){this.cell=n.target;this.row=t.closest(n.target,"tr.e-row")||this.row;this.row&&r&&!i(n.target,"e-gridpager")&&this.parent.selectRow(parseInt(this.row.getAttribute(h),10))},n}(),ic=function(){function n(n){this.parent=n;this.rowModelGenerator=new er(this.parent)}return n.prototype.generateRows=function(n,t,i){var f;if(f=t.renderFrozenRightContent||t.renderMovableContent&&!this.parent.enableVirtualization?"frozen-right":t.renderMovableContent||t.isFrozen?"movable":this.parent.getFrozenLeftCount()?"frozen-left":"frozen-right","virtualscroll"===t.requestType&&"X"===t.virtualInfo.sentinelInfo.axis&&"movable"!==f)return null;for(var r=this.parent.enableVirtualization&&!t.isFrozenRowsRender?i:this.rowModelGenerator.generateRows(n,t),u=0,e=r.length;u<e;u++)r[parseInt(u.toString(),10)].cells=gh(this.parent,r[parseInt(u.toString(),10)].cells,f);return r},n}(),hft=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ty=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.isInitialRender=!0,r.widthService=i.getService("widthService"),r.addEventListener(),r}return hft(i,n),i.prototype.addEventListener=function(){this.parent.addEventListener(l,this.actionComplete.bind(this));this.parent.addEventListener(du,this.batchAdd.bind(this));this.parent.on(pr,this.batchAdd.bind(this));this.parent.addEventListener(ts,this.batchAdd.bind(this));this.parent.on(ott,this.refreshScrollOffset);this.parent.on(di,this.widthService.refreshFrozenScrollbar,this)},i.prototype.batchAdd=function(n){var i="batchCancel"!==n.name&&!(this.parent.frozenRows&&"Top"===this.parent.editSettings.newRowPosition),t;"auto"!==this.parent.height&&(i||"batchCancel"===n.name||"batchDelete"===n.name)&&(this.refreshScrollOffset(),t=this.getTable().offsetHeight,"add"===n.name&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t))},i.prototype.setHeightToContent=function(n){this.getFrozenContent().style.height=n.toString()+"px";this.getMovableContent().style.height=n.toString()+"px"},i.prototype.actionComplete=function(n){if("Dialog"!==this.parent.editSettings.mode&&("add"===n.requestType||"cancel"===n.requestType&&n.row.classList.contains(ui))&&(!this.parent.frozenRows||"Bottom"===this.parent.editSettings.newRowPosition)&&"auto"!==this.parent.height){this.refreshScrollOffset();var t=this.getTable().offsetHeight;"add"===n.requestType&&"Bottom"===this.parent.editSettings.newRowPosition&&this.parent.getContent().firstChild.scroll(0,t)}},i.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.removeEventListener(l,this.actionComplete),this.parent.removeEventListener(du,this.batchAdd),this.parent.off(di,this.widthService.refreshFrozenScrollbar))},i.prototype.renderPanel=function(){n.prototype.renderPanel.call(this);var i=this.parent.element.querySelector("."+wi),r=this.parent.element.querySelector("."+p);t.isNullOrUndefined(i)&&(i=this.parent.createElement("div",{className:"e-frozencontent e-frozen-left-content"}),r=this.parent.createElement("div",{className:p}),this.getPanel().querySelector("."+ft).appendChild(i),this.getPanel().querySelector("."+ft).appendChild(r),r.style.scrollbarWidth="none");this.setFrozenContent(i);this.setMovableContent(r);t.Browser.userAgent.indexOf("Mac OS")>-1&&"safari"===t.Browser.info.name&&!this.parent.enableVirtualization&&this.getPanel().firstElementChild.classList.add("e-mac-safari")},i.prototype.renderFrozenRigthPanel=function(){n.prototype.renderPanel.call(this)},i.prototype.renderEmpty=function(i){n.prototype.renderEmpty.call(this,i);this.getMovableContent().querySelector(e).innerHTML="<tr><td><\/td><\/tr>";t.addClass([this.getMovableContent().querySelector(e).querySelector("tr")],["e-emptyrow"]);this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenColumns();this.getFrozenContent().style.borderRightWidth="0px";this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector("."+fr).querySelector(e).innerHTML="",this.parent.getHeaderContent().querySelector("."+w).querySelector(e).innerHTML="")},i.prototype.renderFrozenRightEmpty=function(t){n.prototype.renderEmpty.call(this,t)},i.prototype.setFrozenContent=function(n){this.frozenContent=n},i.prototype.setMovableContent=function(n){this.movableContent=n},i.prototype.getFrozenContent=function(){return this.frozenContent},i.prototype.getMovableContent=function(){return this.movableContent},i.prototype.getModelGenerator=function(){return new ic(this.parent)},i.prototype.renderFrozenRightTable=function(){n.prototype.renderTable.call(this)},i.prototype.renderTable=function(){var i,r,u;null==this.getFrozenContent().querySelector("."+k)?(n.prototype.renderTable.call(this),this.getFrozenContent().appendChild(this.getTable()),i=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(i)):(this.setTable(this.getFrozenContent().querySelector("."+k)),this.setColGroup(this.parent.element.querySelector("."+ct).querySelector(c).cloneNode(!0)),this.getFrozenContent().querySelector("."+k).appendChild(this.getColGroup()),i=this.getMovableContent().querySelector("."+k),this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"));this.getMovableContent().querySelector(c)&&t.remove(this.getMovableContent().querySelector(c));r=this.parent.getHeaderContent().querySelector("."+w).querySelector(c).cloneNode(!0);i.insertBefore(r,i.querySelector(e));u=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=u;this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-left-scrollbar",this.getScrollbarDisplay())},i.prototype.getScrollbarDisplay=function(){var n="";return(this.parent.getFrozenColumns()&&!this.parent.getVisibleFrozenColumns()||this.parent.getFrozenLeftColumnsCount()&&!this.parent.getVisibleFrozenLeftCount())&&(n="none"),n},i.prototype.renderHorizontalScrollbar=function(n,t,i){var e=this.parent.createElement("div",{className:n,styles:"display:"+t}),r=this.parent.createElement("div",{className:"e-movablescrollbar"}),u=this.parent.createElement("div",{className:"e-movablechild"}),f=hu().toString();this.setScrollbarHeight(r,f);this.setScrollbarHeight(u,f);r.appendChild(u);this.appendScrollbar(e,r,i)},i.prototype.appendScrollbar=function(n,t){var i=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});i.appendChild(n);i.appendChild(t);this.parent.getContent().appendChild(i)},i.prototype.setScrollbarHeight=function(n,t){n.style.minHeight=t+"px";n.style.maxHeight=t+"px"},i.prototype.setIsFrozen=function(n){n.isFrozen=!n.isFrozen},i.prototype.setTbody=function(n,i){var f,r,u;return t.isNullOrUndefined(n[0].cells[0])&&(this.getMovableContent().querySelector(e).innerHTML=""),r=n[0].cells[0],u=r.index,t.isUndefined(u)&&this.parent.isRowDragable()&&(u=(r=n[0].cells[1]).index),0===u&&(this.getPanel().firstChild.style.overflowX="hidden",this.parent.enableColumnVirtualization&&(this.getMovableContent().style.overflowX="hidden")),this.parent.enableColumnVirtualization&&i.renderMovableContent&&"virtualscroll"===i.requestType&&this.getMovableContent().scrollLeft>0&&0!==i.virtualInfo.columnIndexes[0]&&(u=this.parent.getFrozenColumns()),r&&r.column&&(f=r.column.getFreezeTableName()),this.setIdx(u),i.tableName=f,f},i.prototype.splitRows=function(n){n===rt?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows},i.prototype.renderNextFrozentPart=function(n,i){var r=this.parent.enableVirtualization;i===rt&&(r&&(n.renderMovableContent=!0),this.refreshContentRows(t.extend({},n)))},i.prototype.appendContent=function(n,i,r,u){this.parent.isReact&&!t.isNullOrUndefined(this.parent.rowTemplate)?n=i:n.appendChild(i);u===rt?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(n)):(this.refreshTbody(n),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(n),this.refreshHeight(),this.refreshScrollOffset(),this.widthService.refreshFrozenScrollbar());this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1)},i.prototype.refreshScrollOffset=function(){if("auto"!==this.parent.height){var n=this.getTable().offsetHeight+1;this.setHeightToContent(n)}this.parent.notify(ett,{})},i.prototype.getFrozenHeader=function(n){return n===rt?this.parent.getHeaderContent().querySelector("."+fr).querySelector(e):this.parent.getHeaderContent().querySelector("."+w).querySelector(e)},i.prototype.refreshTbody=function(n){n.childElementCount<1&&n.appendChild(this.parent.createElement("tr").appendChild(this.parent.createElement("td")))},i.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify(ei,{"case":"refreshHeight"});this.getFrozenContent().style.borderRightWidth="1px"},i.prototype.setIdx=function(n){this.idx=n},i.prototype.getIdx=function(){return this.idx},i.prototype.getTbody=function(n){return n===rt?this.getTable().querySelector(e):this.getMovableContent().querySelector(e)},i}(fo),iy=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.addEventListener(),r}return hft(i,n),i.prototype.addEventListener=function(){this.eventHandler=[{event:ei,handler:this.refreshFreeze},{event:ke,handler:this.setFrozenHeight},{event:tt,handler:this.enableAfterRender}];vt(this.parent,this.eventHandler,!0,this)},i.prototype.removeEventListener=function(){this.parent.isDestroyed||vt(this.parent,this.eventHandler,!1)},i.prototype.renderTable=function(){n.prototype.renderTable.call(this);this.rfshMovable();this.updateColgroup();this.initializeHeaderDrag();this.initializeHeaderDrop();this.parent.notify(yt,{rows:this.rows,args:{isFrozen:!1}})},i.prototype.renderPanel=function(){var i=this.parent.element.querySelector("."+fr),r=this.parent.element.querySelector("."+w);n.prototype.renderPanel.call(this);t.isNullOrUndefined(i)&&(i=this.parent.createElement("div",{className:"e-frozenheader e-frozen-left-header"}),r=this.parent.createElement("div",{className:w}),this.getPanel().querySelector("."+st).appendChild(i),this.getPanel().querySelector("."+st).appendChild(r));this.setFrozenHeader(i);this.setMovableHeader(r)},i.prototype.renderFrozenRightPanel=function(){n.prototype.renderPanel.call(this)},i.prototype.renderFrozenRightTable=function(){n.prototype.renderTable.call(this)},i.prototype.refreshUI=function(){var i=this.getMovableHeader().querySelector(e);t.remove(this.getMovableHeader().querySelector("table"));n.prototype.refreshUI.call(this);this.rfshMovable();this.getMovableHeader().querySelector(e).innerHTML=i.innerHTML;this.updateColgroup();this.widthService.setWidthToColumns();this.parent.enableVirtualization||this.parent.isFrozenGrid()||this.widthService.setWidthToTable();this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&li([].slice.call(this.movableHeader.querySelectorAll("tr.e-columnheader")),!0);this.parent.updateDefaultCursor();yh(this.parent.getContentTable().querySelector(c),this.parent.getFrozenColumns(),this.parent);this.widthService.refreshFrozenScrollbar();this.initializeHeaderDrag();this.parent.notify(yt,{rows:this.rows,args:{isFrozen:!1}})},i.prototype.refreshFrozenLeftUI=function(){n.prototype.refreshUI.call(this)},i.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable());this.getMovableHeader().appendChild(this.createHeader(void 0,"movable"));this.refreshStackedHdrHgt();this.addMovableFirstCls()},i.prototype.addMovableFirstCls=function(){var r,u;if(this.parent.getVisibleFrozenColumns())for(var i=[].slice.call(this.parent.element.querySelector("."+w).querySelector("thead").getElementsByClassName("e-columnheader")),f=i.length,n=0;n<f;n++)r="cells",u=i[parseInt(n.toString(),10)][""+r][0],u&&(t.addClass([u],["e-movablefirst"]),i[parseInt(n.toString(),10)][""+r][0].rowSpan>1&&(n+=i[parseInt(n.toString(),10)][""+r][0].rowSpan-1))},i.prototype.refreshFreeze=function(n){var i,t,r,u;if("filter"===n.case){if(i=this.getTable().querySelector(".e-filterbar"),this.parent.allowFiltering&&i&&this.getMovableHeader().querySelector("thead"))for(this.getMovableHeader().querySelector("thead:not(.e-masked-thead)").appendChild(this.filterRenderer(i,this.parent.getFrozenColumns())),t=0,r=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));t<r.length;t++)u={element:r[t],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},kr.Input.bindInitialEvent(u)}else"textwrap"!==n.case&&"refreshHeight"!==n.case||(this.refreshHeight(n),this.parent.contentModule.refreshScrollOffset())},i.prototype.refreshHeight=function(n){var t,i,f=this.getFrozenHeader(),o=this.getMovableHeader(),u=this.parent.getContent(),r=this.parent.textWrapSettings.wrapMode,s=this.parent.getHeaderContent().querySelector("."+st).classList;"textwrap"===n.case?(("Header"!==r||n.isModeChg)&&(t=u.querySelector("."+wi).querySelector("tbody").childNodes,i=u.querySelector("."+p).querySelector("tbody").childNodes,this.setWrapHeight(t,i,n.isModeChg,!0)),"Content"===r&&this.parent.allowTextWrap?s.add("e-wrap"):s.remove("e-wrap"),"Both"===r||n.isModeChg?(t=f.querySelectorAll("tr"),i=o.querySelectorAll("tr")):(i=o.querySelector("Content"===r?e:"thead").querySelectorAll("tr"),t=f.querySelector("Content"===r?e:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,i,n.isModeChg,!1,this.colDepth>1),this.refreshStackedHdrHgt()):"refreshHeight"===n.case&&(this.setWrapHeight(u.querySelector("."+wi).querySelectorAll("tr"),u.querySelector("."+p).querySelectorAll("tr"),n.isModeChg),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(f.querySelectorAll("tr"),o.querySelectorAll("tr"),n.isModeChg))},i.prototype.enableAfterRender=function(n){"scroll"===n.module&&this.setFrozenHeight()},i.prototype.updateResizeHandler=function(){for(var t=[].slice.call(this.parent.getHeaderContent().getElementsByClassName("e-rhandler")),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].style.height=t[parseInt(n.toString(),10)].parentElement.offsetHeight+"px"},i.prototype.setWrapHeight=function(n,i,r,u,f){for(var s,h,c=this.parent.allowTextWrap,l=this.parent.textWrapSettings.wrapMode,p=this.parent.getHeaderContent().querySelector("thead"),a=this.parent.getHeaderContent().querySelector(e),v=[],y=[],o=0,w=n.length;o<w;o++)(r&&(!this.parent.rowHeight&&"e-hide"===a.className||"Header"===l&&u||"Content"===l&&p.contains(n[parseInt(o.toString(),10)])||"Header"===l&&a.contains(n[parseInt(o.toString(),10)]))||f)&&(n[parseInt(o.toString(),10)].style.height=null,i[parseInt(o.toString(),10)].style.height=null),t.isNullOrUndefined(n[parseInt(o.toString(),10)])||t.isNullOrUndefined(i[parseInt(o.toString(),10)])||(v[parseInt(o.toString(),10)]=n[parseInt(o.toString(),10)].getBoundingClientRect().height,y[parseInt(o.toString(),10)]=i[parseInt(o.toString(),10)].getBoundingClientRect().height),s=v[parseInt(o.toString(),10)],h=y[parseInt(o.toString(),10)],!t.isNullOrUndefined(n[parseInt(o.toString(),10)])&&n[parseInt(o.toString(),10)].childElementCount&&(c&&s<h||!c&&s<h||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(n[parseInt(o.toString(),10)].style.height=h+"px"),i&&!t.isNullOrUndefined(i[parseInt(o.toString(),10)])&&i[parseInt(o.toString(),10)].childElementCount&&(c&&s>h||!c&&s>h||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(i[parseInt(o.toString(),10)].style.height=s+"px");c&&"auto"!==this.parent.height&&this.setFrozenHeight()},i.prototype.setFrozenHeight=function(n){void 0===n&&(n=hu());var r=this.parent.element.querySelector("."+p).getBoundingClientRect().height,i=this.parent.element.querySelector("."+p),t=this.parent.element.querySelector("."+wi),u=this.parent.getContent().scrollWidth,f=this.parent.element.querySelector(".e-movablecontent table").scrollWidth+this.parent.getContentTable().scrollWidth;i.scrollWidth-i.clientWidth?(t.style.height=r-n+"px",t.style.borderBottom=""):(t.style.height=r+"px",(t.scrollHeight<=t.clientHeight||i.scrollHeight<=i.clientHeight)&&u===f&&this.parent.scrollModule.removePadding(),t.style.borderBottom="0px")},i.prototype.refreshStackedHdrHgt=function(){for(var o,s,r,u,i=[].slice.call(this.getFrozenHeader().getElementsByClassName("e-columnheader")),f=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),n=0,e=i.length;n<e;n++)r=this.getRowSpan(i[parseInt(n.toString(),10)]),u=this.getRowSpan(f[parseInt(n.toString(),10)]),r.min>1||this.parent.isRowDragable()&&t.isNullOrUndefined(this.parent.getFrozenVirtualHeader().querySelector(".e-stackedheadercell"))?this.updateStackedHdrRowHgt(n,r.max,i[parseInt(n.toString(),10)],f):u.min>1&&this.updateStackedHdrRowHgt(n,u.max,f[parseInt(n.toString(),10)],i);for(this.parent.allowResizing&&this.updateResizeHandler(),o=this.parent.columns,n=0,e=o.length;n<e;n++)if(this.parent.isRowDragable()&&!t.isNullOrUndefined(o[parseInt(n.toString(),10)].columns)&&t.isNullOrUndefined(this.parent.getFrozenVirtualHeader().querySelector(".e-stackedheadercell"))){s=this.frozenHeader.querySelectorAll(".e-columnheader").length-1;this.frozenHeader.querySelectorAll(".e-columnheader")[parseInt(s.toString(),10)].remove();break}},i.prototype.getRowSpan=function(n){var r,t,u,e=n.childElementCount-1,i,f;for(this.parent.isRowDragable()&&"Right"===this.parent.getFrozenMode()&&n.children[parseInt(e.toString(),10)].remove(),i=0,f=n.childElementCount;i<f;i++)0===i&&(t=n.children[0].rowSpan),r=n.children[parseInt(i.toString(),10)].rowSpan,t=Math.min(r,t),u=Math.max(r,t);return{min:t,max:u}},i.prototype.updateStackedHdrRowHgt=function(n,t,i,r){for(var f=0,u=0;u<t;u++)f+=r[n+u].style.height?parseInt(r[n+u].style.height,10):r[n+u].offsetHeight;i.style.height=f+"px"},i.prototype.setFrozenHeader=function(n){this.frozenHeader=n},i.prototype.setMovableHeader=function(n){this.movableHeader=n},i.prototype.getFrozenHeader=function(){return this.frozenHeader},i.prototype.getMovableHeader=function(){return this.movableHeader},i.prototype.updateColgroup=function(){var n=this.getMovableHeader().querySelector("table");t.remove(this.getMovableHeader().querySelector(c));n.insertBefore(yh(this.getFrozenHeader().querySelector(c),this.parent.getFrozenColumns(),this.parent),n.querySelector("thead"))},i.prototype.filterRenderer=function(n,t,i){var r=n.cloneNode(!0),f,u;for(r.innerHTML="",f=i||this.parent.getColumns().length,u=t;u<f;u++)r.appendChild(n.removeChild(n.children[parseInt(t.toString(),10)]));return r},i}(ka),cft=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),lft=function(n){function r(t,i){var r=n.call(this,t,i)||this;return r.addEventListener(),r}return cft(r,n),r.prototype.addEventListener=function(){this.evtHandlers=[{event:ei,handler:this.refreshFreeze},{event:uw,handler:this.refreshFrozenColumns},{event:fw,handler:this.setReorderElement},{event:di,handler:this.setVisible}];vt(this.parent,this.evtHandlers,!0,this)},r.prototype.removeEventListener=function(){this.parent.isDestroyed||vt(this.parent,this.evtHandlers,!1)},r.prototype.setReorderElement=function(n){this.destEle=n.ele},r.prototype.refreshFrozenColumns=function(n){n.parent||this.parent.setProperties({columns:n.columns},!0);var t=i(this.destEle,"e-frozen-left-header"),r=i(this.destEle,"e-frozen-right-header"),u=this.parent.getFrozenLeftColumnsCount(),f=this.parent.getFrozenRightColumnsCount();n.column.freeze=null;t?n.column.freeze="Left":r&&(n.column.freeze="Right");this.parent.setFrozenCount();n.cancel=u!==this.parent.getFrozenLeftColumnsCount()||f!==this.parent.getFrozenRightColumnsCount();n.cancel&&this.parent.refreshColumns()},r.prototype.setWrapHeight=function(n,i,r,u,f,o){for(var h,l,a,v,c=this.parent.allowTextWrap,d=this.parent.getHeaderContent().querySelector(e),y=this.parent.textWrapSettings.wrapMode,g=this.parent.getHeaderContent().querySelector("thead"),b=[],k=[],p=[],s=0,w=n.length;s<w;s++)t.isNullOrUndefined(n[parseInt(s.toString(),10)])||t.isNullOrUndefined(i[parseInt(s.toString(),10)])||(o&&(p[parseInt(s.toString(),10)]=o[parseInt(s.toString(),10)].getBoundingClientRect().height),k[parseInt(s.toString(),10)]=i[parseInt(s.toString(),10)].getBoundingClientRect().height,b[parseInt(s.toString(),10)]=n[parseInt(s.toString(),10)].getBoundingClientRect().height);for(s=0,w=n.length;s<w;s++)(r&&("Content"===y&&g.contains(n[parseInt(s.toString(),10)])||"Header"===y&&d.contains(n[parseInt(s.toString(),10)])||"Header"===y&&u)||f)&&(!t.isNullOrUndefined(o)&&o[parseInt(s.toString(),10)]&&(o[parseInt(s.toString(),10)].style.height=null),n[parseInt(s.toString(),10)].style.height=null,i[parseInt(s.toString(),10)].style.height=null),l=b[parseInt(s.toString(),10)],a=k[parseInt(s.toString(),10)],v=p[parseInt(s.toString(),10)]?p[parseInt(s.toString(),10)]:0,h=Math.max(l,a,v),!t.isNullOrUndefined(n[parseInt(s.toString(),10)])&&n[parseInt(s.toString(),10)].childElementCount&&(c&&l<h||!c&&l<h||this.parent.allowResizing&&this.parent.resizeModule&&!1===this.parent.resizeModule.isFrozenColResized)&&(n[parseInt(s.toString(),10)].style.height=h+"px"),i&&!t.isNullOrUndefined(i[parseInt(s.toString(),10)])&&i[parseInt(s.toString(),10)].childElementCount&&(c&&h>a||!c&&h>a||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(i[parseInt(s.toString(),10)].style.height=h+"px"),o&&!t.isNullOrUndefined(o[parseInt(s.toString(),10)])&&o[parseInt(s.toString(),10)].childElementCount&&(c&&h>v||!c&&h>v||this.parent.allowResizing&&this.parent.resizeModule&&!0===this.parent.resizeModule.isFrozenColResized)&&(o[parseInt(s.toString(),10)].style.height=h+"px");c&&this.setFrozenHeight()},r.prototype.refreshHeight=function(n){var t,i,r,o=this.parent.getFrozenMode()===s,h=this.getFrozenRightHeader(),c=this.parent.getHeaderContent().querySelector("."+fr),u=this.parent.getContent(),l=this.getMovableHeader(),a=this.parent.getHeaderContent().querySelector("."+st).classList,f=this.parent.textWrapSettings.wrapMode;"textwrap"===n.case?(("Header"!==f||n.isModeChg)&&(o&&(i=u.querySelector(".e-frozen-right-content").querySelectorAll("tr")),r=u.querySelector("."+p).querySelectorAll("tr"),t=u.querySelector("."+wi).querySelectorAll("tr"),this.setWrapHeight(t,r,n.isModeChg,!0,!1,i)),"Content"===f&&this.parent.allowTextWrap?a.add("e-wrap"):a.remove("e-wrap"),"Both"===f||n.isModeChg?(o&&(i=h.querySelectorAll("tr")),t=c.querySelectorAll("tr"),r=l.querySelectorAll("tr")):(o&&(i=h.querySelector("Content"===f?e:"thead").querySelectorAll("tr")),t=c.querySelector("Content"===f?e:"thead").querySelectorAll("tr"),r=l.querySelector("Content"===f?e:"thead").querySelectorAll("tr")),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||this.setWrapHeight(t,r,n.isModeChg,!1,this.colDepth>1,i),this.refreshStackedHdrHgt()):"refreshHeight"===n.case&&(r=u.querySelector("."+p).querySelectorAll("tr"),t=u.querySelector("."+wi).querySelectorAll("tr"),o&&(i=u.querySelector(".e-frozen-right-content").querySelectorAll("tr")),this.setWrapHeight(t,r,n.isModeChg,!1,!1,i),this.parent.getHeaderContent().getElementsByClassName("e-stackedheadercell").length||(o&&(i=h.querySelectorAll("tr")),t=c.querySelectorAll("tr"),r=l.querySelectorAll("tr"),this.setWrapHeight(t,r,n.isModeChg,!1,!1,i)))},r.prototype.setVisible=function(n){for(var i,h,l,a,r,u,f=this.parent,e=this.parent.getFrozenLeftColumnsCount(),s=this.parent.getFrozenRightColumnsCount(),v=this.parent.getMovableColumnsCount(),o=0,y=n.length;o<y;o++)i=n[parseInt(o.toString(),10)],(u=f.getNormalizedColumnIndex(i.uid),r=i.visible?"":"none","Left"===i.freeze||"Right"===i.freeze)?e&&!s?(h=f.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(c),t.setStyleAttribute(h.children[parseInt(u.toString(),10)],{display:r})):!e&&s&&(l=f.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c),t.setStyleAttribute(l.children[u-v],{display:r})):(a=f.getHeaderContent().querySelector("."+w).querySelector(c),t.setStyleAttribute(a.children[u-e],{display:r}));this.refreshUI()},r.prototype.filterRenderer=function(t,i,r){return n.prototype.filterRenderer.call(this,t,i,r)},r.prototype.refreshUI=function(){var r,h=this.getMovableHeader().querySelector(e),u,f,i,o;t.remove(this.getMovableHeader().querySelector("table"));this.parent.getFrozenMode()===s&&(r=this.getFrozenRightHeader().querySelector(e),t.remove(this.getFrozenRightHeader().querySelector("table")));n.prototype.refreshFrozenLeftUI.call(this);this.rfshMovable();this.getMovableHeader().querySelector(e).innerHTML=h.innerHTML;r&&(this.getFrozenRightHeader().querySelector(e).innerHTML=r.innerHTML);this.updateColgroup();this.widthService.setWidthToColumns();this.parent.notify(rs,{});this.parent.allowTextWrap&&"Header"===this.parent.textWrapSettings.wrapMode&&li([].slice.call(this.getMovableHeader().querySelectorAll("tr.e-columnheader")),!0);this.parent.updateDefaultCursor();u=this.parent.getContent().querySelector("."+p).querySelector("."+k);t.remove(u.querySelector(c));f=this.getMovableHeader().querySelector(c).cloneNode(!0);(u.insertBefore(f,u.querySelector(e)),r)&&(i=this.parent.getContent().querySelector(".e-frozen-right-content").querySelector("."+k),t.remove(i.querySelector(c)),o=this.getFrozenRightHeader().querySelector(c).cloneNode(!0),i.insertBefore(o,i.querySelector(e)),this.getFrozenRightHeader().querySelector("table").style.width=i.style.width);this.widthService.refreshFrozenScrollbar();this.initializeHeaderDrag();this.parent.notify(yt,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.refreshFreeze=function(n){var t=this.parent.getFrozenLeftColumnsCount(),o=this.parent.getFrozenRightColumnsCount(),h=this.parent.getMovableColumnsCount(),i,f,e;if("filter"===n.case){if(i=this.getTable().querySelector(".e-filterbar"),this.parent.allowFiltering&&i&&this.getMovableHeader().querySelector("thead")){var u=this.parent.isRowDragable(),r=t?u?t+1:t:0,c=t+h+(t&&u?1:0);(this.getMovableHeader().querySelector("thead").appendChild(this.filterRenderer(i,r,c)),this.parent.getFrozenMode()===s)&&(f=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input")),this.getFrozenRightHeader().querySelector("thead").appendChild(this.filterRenderer(i,r,r+o)),this.adjudtFilterBarCell(f));e=[].slice.call(this.getMovableHeader().querySelectorAll("thead .e-filterbarcell .e-input"));this.adjudtFilterBarCell(e)}}else"textwrap"!==n.case&&"refreshHeight"!==n.case||(this.refreshHeight(n),this.parent.contentModule.refreshScrollOffset())},r.prototype.updateFrozenColGroup=function(n,i){n&&!1===n.visible&&t.setStyleAttribute(i,{display:"none"})},r.prototype.adjudtFilterBarCell=function(n){for(var r,t=0,i=n;t<i.length;t++)r={element:i[t],floatLabelType:"Never",properties:{enableRtl:this.parent.enableRtl,showClearButton:!0}},kr.Input.bindInitialEvent(r)},r.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(n.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderLeftWithRightFrozenPanel()):this.renderRightFrozenPanelAlone();this.getPanel().firstChild.style.display="flex";this.getMovableHeader().style.flex="1"},r.prototype.renderTable=function(){this.parent.getFrozenLeftColumnsCount()?n.prototype.renderTable.call(this):this.renderFrozenRightTableAlone()},r.prototype.rfshMovable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(n.prototype.rfshMovable.call(this),this.parent.getFrozenRightColumnsCount()){var t=this.rows;this.getFrozenRightHeader().appendChild(this.createHeader(void 0,"frozen-right"));this.refreshStackedHdrHgt();this.parent.notify(yt,{rows:this.rows,args:{renderFrozenRightContent:!0}});this.rows=t}}else this.getFrozenRightHeader().appendChild(this.getTable()),this.getMovableHeader().appendChild(this.createHeader(void 0,"movable")),this.refreshStackedHdrHgt(),this.addMovableFirstCls()},r.prototype.refreshStackedHdrHgt=function(){this.parent.getFrozenLeftColumnsCount()?(n.prototype.refreshStackedHdrHgt.call(this),this.parent.getFrozenRightColumnsCount()&&this.refreshFrozenRightStackedHdrHgt()):this.refreshFrozenRightStackedHdrHgt()},r.prototype.refreshFrozenRightStackedHdrHgt=function(){for(var i,t=[].slice.call(this.getFrozenRightHeader().getElementsByClassName("e-columnheader")),r=[].slice.call(this.getMovableHeader().getElementsByClassName("e-columnheader")),n=0,u=t.length;n<u;n++)(i=this.getRowSpan(t[parseInt(n.toString(),10)])).min>1&&this.updateStackedHdrRowHgt(n,i.max,t[parseInt(n.toString(),10)],r)},r.prototype.updateColgroup=function(){this.updateMovableColGroup();this.parent.getFrozenLeftColumnsCount()&&this.updateFrozenLeftColGroup();this.parent.getFrozenRightColumnsCount()&&this.updateFrozenRightColGroup()},r.prototype.renderRightFrozenPanelAlone=function(){var r=this.parent.element.querySelector("."+w),i=this.parent.element.querySelector(".e-frozen-right-header");n.prototype.renderFrozenRightPanel.call(this);t.isNullOrUndefined(i)&&(r=this.parent.createElement("div",{className:w}),i=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+st).appendChild(r),this.getPanel().querySelector("."+st).appendChild(i));n.prototype.setMovableHeader.call(this,r);this.setFrozenRightHeader(i)},r.prototype.renderLeftWithRightFrozenPanel=function(){var i=this.parent.element.querySelector(".e-frozen-right-header");n.prototype.renderFrozenRightPanel.call(this);t.isNullOrUndefined(i)&&(i=this.parent.createElement("div",{className:"e-frozenheader e-frozen-right-header"}),this.getPanel().querySelector("."+st).appendChild(i));this.setFrozenRightHeader(i)},r.prototype.renderFrozenRightTableAlone=function(){n.prototype.renderFrozenRightTable.call(this);this.rfshMovable();this.updateColgroup();this.initializeHeaderDrag();this.initializeHeaderDrop();this.parent.notify(yt,{rows:this.rows,args:{isFrozen:!1}})},r.prototype.updateFrozenLeftColGroup=function(){for(var i=this.getFrozenHeader().querySelector(c).children,r=this.parent.isRowDragable()?1:0,u=this.parent.isRowDragable()?this.parent.getFrozenLeftColumnsCount()+1:this.parent.getFrozenLeftColumnsCount(),n=r;n<i.length;n++)n>=u&&(t.remove(i[parseInt(n.toString(),10)]),n--)},r.prototype.updateMovableColGroup=function(){var i=this.getMovableHeader().querySelector(c).children;this.parent.isRowDragable()&&t.remove(i[0]);for(var f=i.length,u=this.parent.getFrozenLeftColumnsCount(),e=this.parent.getMovableColumnsCount(),r=0,n=0;n<f;n++,r++)(n<u||n>=u+e)&&(t.remove(i[parseInt(r.toString(),10)]),r--)},r.prototype.updateFrozenRightColGroup=function(){var u=this.parent.isRowDragable(),f=this.parent.getFrozenRightColumns(),n=this.getFrozenRightHeader().querySelector(c).children;this.parent.getFrozenMode()===s&&u&&t.remove(n[0]);for(var e=n.length,o=this.parent.getFrozenLeftColumnsCount(),h=this.parent.getMovableColumnsCount(),i=0,r=0;r<e;r++)r<o+h?t.remove(n[0]):(this.updateFrozenColGroup(f[parseInt(i.toString(),10)],n[parseInt(i.toString(),10)]),i++)},r.prototype.setFrozenRightHeader=function(n){this.frozenRightHeader=n},r.prototype.getFrozenRightHeader=function(){return this.frozenRightHeader},r}(iy),lk=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.frzCount=0,r.isColGroupRefresh=!1,r.widthService=i.getService("widthService"),r}return cft(i,n),i.prototype.renderPanel=function(){this.parent.getFrozenLeftColumnsCount()?(n.prototype.renderPanel.call(this),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightPanel()):this.renderFrozenRightPanelAlone();var t=this.parent.enableVirtualization?"":"flex";this.getPanel().firstChild.style.display=t},i.prototype.renderTable=function(){if(this.parent.getFrozenLeftColumnsCount()){if(n.prototype.renderTable.call(this),this.parent.getFrozenRightColumnsCount()){this.renderFrozenLeftWithRightTable();var t=this.parent.getVisibleFrozenRightCount()?"":"none";this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t,!0)}}else this.renderFrozenRightTableAlone(),t=this.parent.getVisibleFrozenRightCount()?"":"none",this.renderHorizontalScrollbar("e-frozenscrollbar e-frozen-right-scrollbar",t);this.getMovableContent().style.flex="1"},i.prototype.appendScrollbar=function(n,t,i){var r=this.parent.createElement("div",{className:"e-scrollbar",styles:"display: flex"});if(this.parent.getFrozenLeftColumnsCount()){if(i)return void this.parent.getContent().querySelector(".e-scrollbar").appendChild(n);r.appendChild(n);r.appendChild(t)}else r.appendChild(t),r.appendChild(n);this.parent.getContent().appendChild(r)},i.prototype.renderFrozenRightPanelAlone=function(){this.renderFrozenRigthPanel();var r=this.parent.element.querySelector("."+p),i=this.parent.element.querySelector(".e-frozen-right-content");t.isNullOrUndefined(i)&&(r=this.parent.createElement("div",{className:p}),i=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+ft).appendChild(r),this.getPanel().querySelector("."+ft).appendChild(i));n.prototype.setMovableContent.call(this,r);this.setFrozenRightContent(i)},i.prototype.renderFrozenLeftWithRightPanel=function(){this.renderFrozenRigthPanel();var n=this.parent.element.querySelector(".e-frozen-right-content");t.isNullOrUndefined(n)&&(n=this.parent.createElement("div",{className:"e-frozencontent e-frozen-right-content"}),this.getPanel().querySelector("."+ft).appendChild(n));this.setFrozenRightContent(n)},i.prototype.renderFrozenRightTableAlone=function(){var i,r;null==this.getFrozenRightContent().querySelector("."+k)?(n.prototype.renderFrozenRightTable.call(this),this.getFrozenRightContent().appendChild(this.getTable()),i=this.getTable().cloneNode(!0),this.getMovableContent().appendChild(i)):(this.parent.frozenRows&&this.parent.getHeaderContent().classList.add("e-frozenhdrcont"),this.setTable(this.getFrozenRightContent().querySelector("."+k)),this.setColGroup(this.getFrozenRightHeaderColGroup()),i=this.getMovableContent().querySelector("."+k),this.getFrozenRightContent().querySelector("."+k).appendChild(this.getColGroup()));this.getMovableContent().querySelector(c)&&t.remove(this.getMovableContent().querySelector(c));r=this.parent.getHeaderContent().querySelector("."+w).querySelector(c).cloneNode(!0);i.insertBefore(r,i.querySelector(e))},i.prototype.renderFrozenLeftWithRightTable=function(){var r=this.getTable().cloneNode(!0),n,i;this.getFrozenRightContent().appendChild(r);n=this.getFrozenRightContent().querySelector(c);n&&t.remove(n);i=this.getFrozenRightContent().querySelector("."+k);i.insertBefore(this.getFrozenRightHeaderColGroup(),i.querySelector(e))},i.prototype.renderFrozenRightEmptyRowAlone=function(i){n.prototype.renderFrozenRightEmpty.call(this,i);this.getMovableContent().querySelector(e).innerHTML="<tr><td><\/td><\/tr>";t.addClass([this.parent.getMovableContentTbody().querySelector("tr")],["e-emptyrow"]);this.getFrozenRightContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenRightCount();this.parent.frozenRows&&(this.parent.getFrozenRightHeaderTbody().innerHTML="",this.parent.getMovableHeaderTbody().innerHTML="")},i.prototype.getFrozenHeader=function(n){return n===rt?this.parent.getHeaderContent().querySelector(".e-frozen-left-header").querySelector(e):"movable"===n?this.parent.getHeaderContent().querySelector("."+w).querySelector(e):this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(e)},i.prototype.renderFrozenLeftWithRightEmptyRow=function(){this.getFrozenRightContent().querySelector(e).innerHTML="<tr><td><\/td><\/tr>";t.addClass([this.getFrozenRightContent().querySelector(e).querySelector("tr")],["e-emptyrow"]);this.parent.frozenRows&&(this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(e).innerHTML="")},i.prototype.setFrozenRightContent=function(n){this.frozenRigthContent=n},i.prototype.getFrozenRightContent=function(){return this.frozenRigthContent},i.prototype.getHeaderColGroup=function(){var n=this.parent.element.querySelector("."+ct).querySelector(c).cloneNode(!0),t;return this.parent.getFrozenLeftColumnsCount()||(t=this.getFrozenRightHeaderColGroup(),n=t&&this.frzCount?t.cloneNode(!0):n,this.frzCount++,this.isColGroupRefresh=!0),n},i.prototype.getFrozenRightHeaderColGroup=function(){var n=this.parent.getHeaderContent().querySelector(".e-frozen-right-header").querySelector(c);return n||(n=this.parent.getHeaderContent().querySelector(c)),n.cloneNode(!0)},i.prototype.setColGroup=function(i){return this.parent.getFrozenLeftColumnsCount()?n.prototype.setColGroup.call(this,i):(i=this.isColGroupRefresh?i:this.getFrozenRightHeaderColGroup(),t.isNullOrUndefined(i)||(i.id="content-"+i.id),this.isColGroupRefresh=!1,2===this.frzCount&&(this.frzCount=0),this.colgroup=i)},i.prototype.renderEmpty=function(t){this.parent.getFrozenLeftColumnsCount()?(n.prototype.renderEmpty.call(this,t),this.getFrozenContent().querySelector(".e-emptyrow").querySelector("td").colSpan=this.parent.getVisibleFrozenLeftCount(),this.parent.getFrozenRightColumnsCount()&&this.renderFrozenLeftWithRightEmptyRow()):this.renderFrozenRightEmptyRowAlone(t);this.parent.notify(ei,{"case":"refreshHeight"})},i.prototype.setHeightToContent=function(n){this.parent.getFrozenRightColumnsCount()&&(this.getFrozenRightContent().style.height=n.toString()+"px");this.parent.getFrozenLeftColumnsCount()&&(this.getFrozenContent().style.height=n.toString()+"px");this.getMovableContent().style.height=n.toString()+"px"},i.prototype.actionComplete=function(t){n.prototype.actionComplete.call(this,t)},i.prototype.batchAdd=function(t){n.prototype.batchAdd.call(this,t)},i.prototype.getTbody=function(n){var t;return n===rt?t=this.parent.getFrozenLeftContentTbody():"movable"===n?t=this.parent.getMovableContentTbody():n===d&&(t=this.parent.getFrozenRightContentTbody()),t},i.prototype.setIsFrozen=function(n,t){n.isFrozen=t===rt||"Right"===this.parent.getFrozenMode()&&t===d;n.renderFrozenRightContent=this.parent.getFrozenMode()===s&&t===d;n.renderMovableContent="movable"===t},i.prototype.appendContent=function(n,i,r,u){!t.isNullOrUndefined(this.parent.rowTemplate)&&this.parent.isReact?n=i:n.appendChild(i);"Left"===this.parent.getFrozenMode()?u===rt?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(n),this.refreshContentRows(t.extend({},r))):(this.refreshTbody(n),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(n),this.refreshHeight(),this.refreshScrollOffset()):"Right"===this.parent.getFrozenMode()?"movable"===u?(this.refreshTbody(n),this.isLoaded=!0,this.getMovableContent().querySelector("table").appendChild(n),this.refreshHeight(),this.refreshScrollOffset()):(this.isLoaded=!1,this.getFrozenRightContent().querySelector("table").appendChild(n),this.refreshContentRows(t.extend({},r))):this.parent.getFrozenMode()===s&&(u===rt?(this.isLoaded=!1,this.getFrozenContent().querySelector("table").appendChild(n),this.refreshContentRows(t.extend({},r))):"movable"===u?(this.refreshTbody(n),this.isLoaded=!1,this.getMovableContent().querySelector("table").appendChild(n),this.refreshContentRows(t.extend({},r))):(this.isLoaded=!0,this.getFrozenRightContent().querySelector("table").appendChild(n),this.refreshHeight(),this.refreshScrollOffset()));this.isInitialRender&&(this.parent.scrollModule.setHeight(),this.isInitialRender=!1);this.widthService.refreshFrozenScrollbar()},i.prototype.refreshHeight=function(){this.parent.allowTextWrap||this.parent.notify(ei,{"case":"refreshHeight"})},i.prototype.splitRows=function(n){var t=this.parent.getFrozenLeftColumnsCount(),i=this.parent.getFrozenRightColumnsCount();t&&!i?n===rt?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):this.movableRows=this.rows:!t&&i?"movable"===n?this.movableRows=this.rows:(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):t&&i&&(n===rt?(this.freezeRows=this.rows,this.freezeRowElements=this.rowElements):"movable"===n?(this.movableRows=this.rows,this.movableRowElements=this.rowElements):(this.frozenRightRows=this.rows,this.frozenRightRowElements=this.rowElements))},i.prototype.getMovableRowElements=function(){return this.parent.getFrozenMode()!==s?this.rowElements:this.movableRowElements},i.prototype.getFrozenRightRowElements=function(){return this.parent.getFrozenMode()!==s?this.freezeRowElements:this.frozenRightRowElements},i.prototype.getFrozenRightRows=function(){return this.parent.getFrozenMode()===s?this.parent.enableInfiniteScrolling?this.rightFreezeRows:this.frozenRightRows:this.getRows()},i.prototype.getFrozenRightRowByIndex=function(n){if(!t.isNullOrUndefined(n))return this.parent.getFrozenRightDataRows()[parseInt(n.toString(),10)]},i.prototype.getRows=function(){var n=this.getInfiniteRows();return n.length?n:this.freezeRows},i.prototype.getRowElements=function(){return this.freezeRowElements},i}(ty),ak=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),aft=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.frzRows=[],r.mvblRows=[],r.frRows=[],r.serviceLoc=i,r.eventListener("on"),r.rowModelGenerator=new er(r.parent),r}return ak(t,n),t.prototype.eventListener=function(n){this.parent[""+n](iu,this.getVirtualData,this);this.parent[""+n](na,this.setFreezeSelection,this);this.parent[""+n](ia,this.refreshVirtualFrozenRows,this);this.parent.addEventListener(l,this.actionComplete.bind(this))},t.prototype.actionComplete=function(n){if("delete"===n.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++)td(this,t)},t.prototype.refreshVirtualFrozenRows=function(n){var i=this,t=this.parent,r;"delete"===n.requestType&&t.frozenRows&&(n.isFrozenRowsRender=!0,r=t.renderModule.data.generateQuery(!0).clone(),r.page(1,t.pageSettings.pageSize),t.renderModule.data.getData({},r).then(function(r){ry(n,r.result,t.getSelectedRowIndexes(),t,i.rowModelGenerator,i.serviceLoc,i.virtualRenderer,i)}))},t.prototype.getVirtualData=function(n){this.virtualRenderer.getVirtualData(n)},t.prototype.setFreezeSelection=function(n){yk(n,this.virtualRenderer)},t.prototype.renderTable=function(){var t,i,r;this.freezeRowGenerator=new ic(this.parent);this.virtualRenderer=new ny(this.parent,this.serviceLoc);this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(at.Header).virtualHdrRenderer;n.prototype.renderTable.call(this);this.virtualRenderer.setPanel(this.parent.getContent());this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");t=this.getMovableContent();i=this.parent.height;(this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+ft),this.virtualRenderer.virtualEle.content.style.overflowX="hidden",this.virtualRenderer.virtualEle.renderFrozenWrapper(i),this.virtualRenderer.virtualEle.renderFrozenPlaceHolder(),this.parent.enableColumnVirtualization)&&(this.virtualRenderer.virtualEle.movableContent=this.virtualRenderer.movableContent=this.getPanel().querySelector("."+p),this.virtualRenderer.virtualEle.renderMovableWrapper(i),this.virtualRenderer.virtualEle.renderMovablePlaceHolder(),r=t.querySelector("table"),this.virtualRenderer.virtualEle.movableTable=r,this.virtualRenderer.virtualEle.movableWrapper.appendChild(r),t.appendChild(this.virtualRenderer.virtualEle.movableWrapper),t.appendChild(this.virtualRenderer.virtualEle.movablePlaceholder));this.virtualRenderer.virtualEle.wrapper.appendChild(this.getFrozenContent());this.virtualRenderer.virtualEle.wrapper.appendChild(t);this.virtualRenderer.virtualEle.table=this.getTable();id(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},t.prototype.appendContent=function(n,t,i){pk(this.virtualRenderer,this.widthService,n,t,i)},t.prototype.generateRows=function(n,t){return this.firstPageRecords||(this.firstPageRecords=n),wk(this.virtualRenderer,n,t,this.freezeRowGenerator,this.parent)},t.prototype.getRowByIndex=function(n){return this.virtualRenderer.getRowByIndex(n)},t.prototype.getMovableRowByIndex=function(n){return this.virtualRenderer.getMovableVirtualRowByIndex(n)},t.prototype.collectRows=function(n){return vk(n,this.virtualRenderer,this.parent)},t.prototype.getMovableRows=function(){return this.collectRows("movable")},t.prototype.getRows=function(){return this.collectRows("frozen-left")},t.prototype.getColGroup=function(){var n=this.parent.getMovableVirtualContent();return this.isXaxis()?n.querySelector(c+":not(.e-masked-colgroup)"):this.colgroup},t.prototype.getReorderedFrozenRows=function(n){return bk(n,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},t.prototype.isXaxis=function(){return he(this.virtualRenderer)},t.prototype.getHeaderCells=function(){return kk(this.virtualRenderer,this.parent)},t.prototype.getVirtualFreezeHeader=function(){return dk(this.virtualRenderer,this.parent)},t.prototype.ensureFrozenCols=function(n){return gk(n,this.parent)},t.prototype.getRowObjectByIndex=function(n){return this.virtualRenderer.getRowObjectByIndex(n)},t.prototype.setColGroup=function(n){return nd(n,this.virtualRenderer,this)},t}(ty),vft=function(n){function t(t,i){var r=n.call(this,t,i)||this;return r.serviceLoc=i,r}return ak(t,n),t.prototype.renderTable=function(){this.virtualHdrRenderer=new ik(this.parent,this.serviceLoc);this.virtualHdrRenderer.gen.refreshColOffsets();this.parent.setColumnIndexesInView(this.virtualHdrRenderer.gen.getColumnIndexes(this.getPanel().querySelector("."+st)));this.virtualHdrRenderer.virtualEle.content=this.getPanel().querySelector("."+st);this.virtualHdrRenderer.virtualEle.renderFrozenWrapper();this.virtualHdrRenderer.virtualEle.renderFrozenPlaceHolder();this.parent.enableColumnVirtualization&&(this.virtualHdrRenderer.virtualEle.movableContent=this.getPanel().querySelector("."+w),this.virtualHdrRenderer.virtualEle.renderMovableWrapper(),this.virtualHdrRenderer.virtualEle.renderMovablePlaceHolder());n.prototype.renderTable.call(this);this.virtualHdrRenderer.setPanel(this.parent.getHeaderContent())},t.prototype.rfshMovable=function(){this.getFrozenHeader().appendChild(this.getTable());this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getFrozenHeader());this.parent.enableColumnVirtualization?this.virtualHdrRenderer.virtualEle.movableWrapper.appendChild(this.createHeader(void 0,"movable")):this.getMovableHeader().appendChild(this.createTable());this.virtualHdrRenderer.virtualEle.wrapper.appendChild(this.getMovableHeader())},t}(iy);var wft=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.frRows=[],r.frzRows=[],r.mvblRows=[],r.serviceLoc=i,r.eventListener("on"),r.rowModelGenerator=new er(r.parent),r}return ak(i,n),i.prototype.actionComplete=function(n){if("delete"===n.requestType&&this.parent.frozenRows)for(var t=0;t<this.parent.frozenRows;t++){if(!this.virtualRenderer.vgenerator.frozenRightCache[1]){this.virtualRenderer.vgenerator.frozenRightCache[1]=this.frRows.length?this.frRows:this.frzRows;break}this.virtualRenderer.vgenerator.frozenRightCache[1][parseInt(t.toString(),10)]=this.frRows.length?this.frRows[parseInt(t.toString(),10)]:this.frzRows[parseInt(t.toString(),10)];td(this,t)}},i.prototype.eventListener=function(n){this.parent.addEventListener(l,this.actionComplete.bind(this));this.parent[""+n](ia,this.refreshVirtualFrozenRows,this);this.parent[""+n](iu,this.getVirtualData,this);this.parent[""+n](na,this.setFreezeSelection,this)},i.prototype.refreshVirtualFrozenRows=function(n){var t=this,i,r;"delete"===n.requestType&&this.parent.frozenRows&&(n.isFrozenRowsRender=!0,i=this.parent.renderModule.data.generateQuery(!0).clone(),i.page(1,this.parent.pageSettings.pageSize),r=this.parent.getSelectedRowIndexes(),this.parent.renderModule.data.getData({},i).then(function(i){ry(n,i.result,r,t.parent,t.rowModelGenerator,t.serviceLoc,t.virtualRenderer,t)}))},i.prototype.setFreezeSelection=function(n){yk(n,this.virtualRenderer)},i.prototype.getVirtualData=function(n){this.virtualRenderer.getVirtualData(n)},i.prototype.renderNextFrozentPart=function(n,i){n.renderMovableContent=this.parent.getFrozenLeftCount()?i===rt:i===d;n.renderFrozenRightContent=this.parent.getFrozenMode()===s&&"movable"===i;(n.renderMovableContent||n.renderFrozenRightContent)&&this.refreshContentRows(t.extend({},n))},i.prototype.renderTable=function(){var u;this.virtualRenderer=new ny(this.parent,this.serviceLoc);this.virtualRenderer.header=this.serviceLoc.getService("rendererFactory").getRenderer(at.Header).virtualHdrRenderer;this.freezeRowGenerator=new ic(this.parent);n.prototype.renderTable.call(this);this.virtualRenderer.setPanel(this.parent.getContent());this.scrollbar=this.parent.getContent().querySelector(".e-movablescrollbar");var r=this.getFrozenRightContent(),t=this.getFrozenContent(),i=this.getMovableContent();"Right"===this.parent.getFrozenMode()&&(t=r);this.virtualRenderer.virtualEle.content=this.virtualRenderer.content=this.getPanel().querySelector("."+ft);this.virtualRenderer.virtualEle.content.style.overflowX="hidden";u=this.parent.height;this.virtualRenderer.virtualEle.renderFrozenWrapper(u);this.virtualRenderer.virtualEle.renderFrozenPlaceHolder();this.renderVirtualFrozenLeft(t,i);this.renderVirtualFrozenRight(t,i);this.renderVirtualFrozenLeftRight(t,i,r);this.virtualRenderer.virtualEle.table=this.getTable();id(this.parent,this.virtualRenderer,this.scrollbar,this.getMovableContent())},i.prototype.renderVirtualFrozenLeft=function(n,t){"Left"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(n),this.virtualRenderer.virtualEle.wrapper.appendChild(t))},i.prototype.renderVirtualFrozenRight=function(n,t){"Right"===this.parent.getFrozenMode()&&(this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(n))},i.prototype.renderVirtualFrozenLeftRight=function(n,t,i){this.parent.getFrozenMode()===s&&(this.virtualRenderer.virtualEle.wrapper.appendChild(n),this.virtualRenderer.virtualEle.wrapper.appendChild(t),this.virtualRenderer.virtualEle.wrapper.appendChild(i))},i.prototype.appendContent=function(n,t,i){pk(this.virtualRenderer,this.widthService,n,t,i);this.refreshScrollOffset()},i.prototype.generateRows=function(n,t){return this.firstPageRecords||(this.firstPageRecords=n),wk(this.virtualRenderer,n,t,this.freezeRowGenerator,this.parent)},i.prototype.getRowByIndex=function(n){return this.virtualRenderer.getRowByIndex(n)},i.prototype.getFrozenRightRowByIndex=function(n){return this.virtualRenderer.getFrozenRightVirtualRowByIndex(n)},i.prototype.collectRows=function(n){return vk(n,this.virtualRenderer,this.parent)},i.prototype.getMovableRowByIndex=function(n){return this.virtualRenderer.getMovableVirtualRowByIndex(n)},i.prototype.getFrozenRightRows=function(){return this.collectRows("frozen-right")},i.prototype.getMovableRows=function(){return this.collectRows("movable")},i.prototype.getColGroup=function(){var n=this.parent.getMovableVirtualContent();return he(this.virtualRenderer)?n.querySelector(c):this.colgroup},i.prototype.getRows=function(){return this.collectRows("Right"===this.parent.getFrozenMode()?"frozen-right":"frozen-left")},i.prototype.getReorderedFrozenRows=function(n){return bk(n,this.virtualRenderer,this.parent,this.freezeRowGenerator,this.firstPageRecords)},i.prototype.getHeaderCells=function(){return kk(this.virtualRenderer,this.parent)},i.prototype.isXaxis=function(){return he(this.virtualRenderer)},i.prototype.getVirtualFreezeHeader=function(){return dk(this.virtualRenderer,this.parent)},i.prototype.getRowObjectByIndex=function(n){return this.virtualRenderer.getRowObjectByIndex(n)},i.prototype.ensureFrozenCols=function(n){return gk(n,this.parent)},i.prototype.setColGroup=function(n){return nd(n,this.virtualRenderer,this)},i}(lk),vct=function(){function n(n,t){this.parent=n;this.locator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"freeze"},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(cr,this.instantiateRenderer,this),this.parent.on(v,this.destroy,this))},n.prototype.instantiateRenderer=function(){this.parent.log("limitation",this.getModuleName());var n=this.locator.getService("rendererFactory");this.parent.getFrozenColumns()&&(this.parent.enableColumnVirtualization?n.addRenderer(at.Header,new vft(this.parent,this.locator)):n.addRenderer(at.Header,new iy(this.parent,this.locator)),this.parent.enableVirtualization?n.addRenderer(at.Content,new aft(this.parent,this.locator)):n.addRenderer(at.Content,new ty(this.parent,this.locator)));(this.parent.getFrozenLeftColumnsCount()||this.parent.getFrozenRightColumnsCount())&&(n.addRenderer(at.Header,new lft(this.parent,this.locator)),this.parent.enableVirtualization?n.addRenderer(at.Content,new wft(this.parent,this.locator)):n.addRenderer(at.Content,new lk(this.parent,this.locator)))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cr,this.instantiateRenderer),this.parent.off(v,this.destroy))},n.prototype.destroy=function(){this.removeEventListener()},n}(),yct=function(){function n(n,t){this.defaultItems={};this.localeText=this.setLocaleKey();this.disableItems=[];this.hiddenItems=[];this.isOpen=!1;this.GROUP="e-icon-group";this.UNGROUP="e-icon-ungroup";this.ASCENDING="e-icon-ascending";this.DESCENDING="e-icon-descending";this.ROOT="e-columnmenu";this.FILTER="e-icon-filter";this.POP="e-filter-popup";this.WRAP="e-col-menu";this.CHOOSER="_chooser_";this.parent=n;this.gridID=n.element.id;this.serviceLocator=t;this.addEventListener()}return n.prototype.wireEvents=function(){for(var i=this.getColumnMenuHandlers(),n=0;n<i.length;n++)t.EventHandler.add(i[parseInt(n.toString(),10)],"mousedown",this.columnMenuHandlerDown,this)},n.prototype.unwireEvents=function(){for(var i=this.getColumnMenuHandlers(),n=0;n<i.length;n++)t.EventHandler.remove(i[parseInt(n.toString(),10)],"mousedown",this.columnMenuHandlerDown)},n.prototype.destroy=function(){var n=this.parent.element;n&&(n.querySelector("."+ct)||n.querySelector("."+ot))&&(this.columnMenu.destroy(),this.removeEventListener(),this.unwireFilterEvents(),this.unwireEvents(),this.element.parentNode&&t.remove(this.element))},n.prototype.columnMenuHandlerClick=function(n){n.target.classList.contains("e-columnmenu")&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.isOpen&&this.headerCell!==this.getHeaderCell(n)||document.querySelector(".e-grid-menu .e-menu-parent.e-ul")?(this.columnMenu.close(),this.openColumnMenu(n)):this.isOpen?this.columnMenu.close():this.openColumnMenu(n))},n.prototype.openColumnMenuByField=function(n){this.openColumnMenu({target:this.parent.getColumnHeaderByField(n).querySelector(".e-columnmenu")})},n.prototype.afterFilterColumnMenuClose=function(){this.columnMenu&&(this.columnMenu.items=this.getItems(),this.columnMenu.dataBind(),this.columnMenu.close())},n.prototype.openColumnMenu=function(n){var f=this.parent.getContent().getClientRects()[0],r=this.parent.getHeaderContent(),i=r.getBoundingClientRect(),t={top:0,left:0},u,e;this.element.style.cssText="display:block;visibility:hidden";u=this.element.getBoundingClientRect();e=this.parent.element.getBoundingClientRect();this.element.style.cssText="display:none;visibility:visible";this.headerCell=this.getHeaderCell(n);this.parent.enableRtl?t=this.parent.enableStickyHeader?bt.calculatePosition(this.headerCell,"left","bottom",!0):bt.calculatePosition(this.headerCell,"left","bottom"):((t=this.parent.enableStickyHeader?bt.calculatePosition(this.headerCell,"right","bottom",!0):bt.calculatePosition(this.headerCell,"right","bottom")).left-=u.width,r.classList.contains("e-sticky")?(t.top=this.parent.element.offsetTop+i.top+i.height,i.top+i.height>f.top&&(t.top+=i.top+i.height-f.top)):this.parent.enableStickyHeader&&(t.top=this.parent.element.offsetTop+r.offsetTop+i.height),t.left+u.width+1>=e.right&&(t.left-=35));this.columnMenu.open(t.top,t.left);n.preventDefault&&n.preventDefault();ao(this.parent.element,this.columnMenu.element.parentElement)},n.prototype.columnMenuHandlerDown=function(){this.isOpen=!("none"===this.element.style.display||""===this.element.style.display)},n.prototype.getColumnMenuHandlers=function(){return[].slice.call(this.parent.getHeaderTable().getElementsByClassName(this.ROOT))},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(yt,this.wireEvents,this),this.parent.on(tt,this.enableAfterRenderMenu,this),this.parent.on(dt,this.render,this),this.isFilterItemAdded()&&this.parent.on(we,this.filterPosition,this),this.parent.on(ii,this.columnMenuHandlerClick,this),this.parent.on(nh,this.afterFilterColumnMenuClose,this),this.parent.on(ht,this.keyPressHandler,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(yt,this.unwireEvents),this.parent.off(tt,this.enableAfterRenderMenu),this.parent.off(dt,this.render),this.isFilterItemAdded()&&this.parent.off(we,this.filterPosition),this.parent.off(ii,this.columnMenuHandlerClick),this.parent.on(nh,this.afterFilterColumnMenuClose),this.parent.off(ht,this.keyPressHandler),this.parent.off(v,this.destroy))},n.prototype.keyPressHandler=function(n){var i=this.parent,t,r;"altDownArrow"===n.action&&(t=i.focusModule.currentInfo.element,t&&t.classList.contains("e-headercell")&&(r=i.getColumnByUid(t.firstElementChild.getAttribute("e-mappinguid")),this.openColumnMenuByField(r.field)))},n.prototype.enableAfterRenderMenu=function(n){n.module===this.getModuleName()&&n.enable&&(this.columnMenu&&(this.columnMenu.destroy(),t.remove(this.element)),this.render())},n.prototype.render=function(){this.l10n=this.serviceLocator.getService("localization");this.element=this.parent.createElement("ul",{id:this.gridID+"_columnmenu",className:"e-colmenu"});this.element.setAttribute("aria-label",this.l10n.getConstant("ColumnMenuDialogARIA"));this.parent.element.appendChild(this.element);this.columnMenu=new wo.ContextMenu({cssClass:this.parent.cssClass?"e-grid-menu "+this.parent.cssClass:"e-grid-menu",enableRtl:this.parent.enableRtl,enablePersistence:this.parent.enablePersistence,locale:this.parent.locale,items:this.getItems(),select:this.columnMenuItemClick.bind(this),beforeOpen:this.columnMenuBeforeOpen.bind(this),onOpen:this.columnMenuOnOpen.bind(this),onClose:this.columnMenuOnClose.bind(this),beforeItemRender:this.beforeMenuItemRender.bind(this),beforeClose:this.columnMenuBeforeClose.bind(this)});this.columnMenu.appendTo(this.element);this.wireFilterEvents()},n.prototype.wireFilterEvents=function(){!t.Browser.isDevice&&this.isFilterItemAdded()&&t.EventHandler.add(this.element,"mouseover",this.appendFilter,this)},n.prototype.unwireFilterEvents=function(){!t.Browser.isDevice&&this.isFilterItemAdded()&&t.EventHandler.remove(this.element,"mouseover",this.appendFilter)},n.prototype.beforeMenuItemRender=function(n){if(this.isChooserItem(n.item)){var i=this.getKeyFromId(n.item.id,this.CHOOSER),r=this.parent.columnModel.filter(function(n){return n.field===i}),t=fi.createCheckBox(this.parent.createElement,!1,{label:n.item.text,checked:r[0].visible});this.parent.enableRtl&&t.classList.add("e-rtl");this.parent.cssClass&&t.classList.add(this.parent.cssClass);n.element.innerHTML="";n.element.appendChild(t)}else n.item.id&&"Filter"===this.getKeyFromId(n.item.id)&&(n.element.appendChild(this.parent.createElement("span",{className:"e-icons e-caret"})),n.element.className+="e-filter-item e-menu-caret-icon")},n.prototype.columnMenuBeforeClose=function(n){var r=n.event?t.closest(n.event.target,".e-menu-item"):null;(!t.isNullOrUndefined(n.parentItem)&&"ColumnChooser"===this.getKeyFromId(n.parentItem.id)&&r&&this.isChooserItem(r)||n.event&&(t.closest(n.event.target,"."+this.POP)||n.event.currentTarget&&n.event.currentTarget.activeElement&&i(n.event.currentTarget.activeElement,"e-filter-popup")||i(n.event.target,"e-popup")||i(n.event.target,"e-popup-wrapper"))&&!t.Browser.isDevice)&&(n.cancel=!0)},n.prototype.isChooserItem=function(n){return n.id&&n.id.indexOf("_colmenu_")>=0&&-1===this.getKeyFromId(n.id,this.CHOOSER).indexOf("_colmenu_")},n.prototype.columnMenuBeforeOpen=function(n){var t,r;for(n.column=this.targetColumn=this.getColumn(),this.parent.trigger(en,n),t=0,r=n.items;t<r.length;t++){var i=r[t],u=this.getKeyFromId(i.id),f=this.defaultItems[""+u];-1!==this.getDefaultItems().indexOf(u)&&this.ensureDisabledStatus(u)&&!f.hide&&this.disableItems.push(i.text);i.hide&&this.hiddenItems.push(i.text)}this.columnMenu.enableItems(this.disableItems,!1);this.columnMenu.hideItems(this.hiddenItems)},n.prototype.columnMenuOnOpen=function(n){"e-menu-parent e-ul "===n.element.className&&(n.element.offsetHeight>window.innerHeight||this.parent.element.offsetHeight>window.innerHeight)&&(n.element.style.maxHeight=.8*window.innerHeight+"px",n.element.style.overflowY="auto",this.parent.enableStickyHeader&&(n.element.style.position="fixed"))},n.prototype.ensureDisabledStatus=function(n){var t=!1,r,i;switch(n){case"Group":(!this.parent.allowGrouping||this.parent.ensureModuleInjected(sf)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)>=0||this.targetColumn&&!this.targetColumn.allowGrouping)&&(t=!0);break;case"AutoFitAll":case"AutoFit":t=!this.parent.ensureModuleInjected(gv);break;case"Ungroup":(!this.parent.ensureModuleInjected(sf)||this.parent.ensureModuleInjected(sf)&&this.targetColumn&&this.parent.groupSettings.columns.indexOf(this.targetColumn.field)<0)&&(t=!0);break;case"SortDescending":case"SortAscending":if(this.parent.allowSorting&&this.parent.ensureModuleInjected(bo)&&this.parent.sortSettings.columns.length>0&&this.targetColumn&&this.targetColumn.allowSorting)for(r=this.parent.sortSettings.columns,i=0;i<r.length;i++)r[parseInt(i.toString(),10)].field===this.targetColumn.field&&r[parseInt(i.toString(),10)].direction.toLocaleLowerCase()===n.toLocaleLowerCase().replace("sort","")&&(t=!0);else this.parent.allowSorting&&this.parent.ensureModuleInjected(bo)&&(!this.parent.allowSorting||!this.targetColumn||this.targetColumn.allowSorting)||(t=!0);break;case"Filter":this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(dv)&&this.targetColumn&&this.targetColumn.allowFiltering?t=!1:this.parent.ensureModuleInjected(dv)&&this.parent.allowFiltering&&this.targetColumn&&(!this.targetColumn.allowFiltering||"FilterBar"===this.parent.filterSettings.type)&&(t=!0)}return t},n.prototype.columnMenuItemClick=function(n){switch(this.isChooserItem(n.item)?"ColumnChooser":this.getKeyFromId(n.item.id)){case"AutoFit":this.parent.autoFitColumns(this.targetColumn.field);break;case"AutoFitAll":this.parent.autoFitColumns([]);break;case"Ungroup":this.parent.ungroupColumn(this.targetColumn.field);break;case"Group":this.parent.groupColumn(this.targetColumn.field);break;case"SortAscending":this.parent.sortColumn(this.targetColumn.field,"Ascending");break;case"SortDescending":this.parent.sortColumn(this.targetColumn.field,"Descending");break;case"ColumnChooser":var i=this.getKeyFromId(n.item.id,this.CHOOSER),t=n.element.querySelector(".e-checkbox-wrapper .e-frame");t&&t.classList.contains("e-check")?(t.classList.remove("e-check"),this.parent.hideColumns(i,"field")):t&&(this.parent.showColumns(i,"field"),t.classList.add("e-check"));break;case"Filter":this.getFilter(n.element,n.item.id)}n.column=this.targetColumn;this.parent.trigger(fn,n)},n.prototype.columnMenuOnClose=function(n){n.items.length>0&&n.items[0].parentObj instanceof wo.ContextMenu&&(this.columnMenu.enableItems(this.disableItems,!1),this.disableItems=[],this.columnMenu.showItems(this.hiddenItems),this.hiddenItems=[],this.isFilterPopupOpen()&&this.getFilter(n.element,n.element.id,!0));this.parent.isFrozenGrid()||this.parent.notify(tf,{})},n.prototype.getDefaultItems=function(){return["AutoFitAll","AutoFit","SortAscending","SortDescending","Group","Ungroup","ColumnChooser","Filter"]},n.prototype.getItems=function(){for(var n,r,t=[],i=0,u=this.parent.columnMenuItems?this.parent.columnMenuItems:this.getDefault();i<u.length;i++)n=u[i],"string"==typeof n?"ColumnChooser"===n?(r=this.getDefaultItem(n),r.items=this.createChooserItems(),t.push(r)):t.push(this.getDefaultItem(n)):t.push(n);return t},n.prototype.getDefaultItem=function(n){var t={};switch(n){case"SortAscending":t={iconCss:this.ASCENDING};break;case"SortDescending":t={iconCss:this.DESCENDING};break;case"Group":t={iconCss:this.GROUP};break;case"Ungroup":t={iconCss:this.UNGROUP};break;case"Filter":t={iconCss:this.FILTER}}return this.defaultItems[""+n]={text:this.getLocaleText(n),id:this.generateID(n),iconCss:t.iconCss?"e-icons "+t.iconCss:null},this.defaultItems[""+n]},n.prototype.getLocaleText=function(n){return this.l10n.getConstant(this.localeText[""+n])},n.prototype.generateID=function(n,t){return this.gridID+"_colmenu_"+(t?t+n:n)},n.prototype.getKeyFromId=function(n,t){return n.indexOf("_colmenu_")>0&&n.replace(this.gridID+"_colmenu_"+(t||""),"")},n.prototype.getColumnMenu=function(){return this.element},n.prototype.getModuleName=function(){return"columnMenu"},n.prototype.setLocaleKey=function(){return{AutoFitAll:"autoFitAll",AutoFit:"autoFit",Group:"Group",Ungroup:"Ungroup",SortAscending:"SortAscending",SortDescending:"SortDescending",ColumnChooser:"Columnchooser",Filter:"FilterMenu"}},n.prototype.getHeaderCell=function(n){return t.closest(n.target,"th.e-headercell")},n.prototype.getColumn=function(){if(this.headerCell){var n=this.headerCell.querySelector(".e-headercelldiv").getAttribute("e-mappinguid");return this.parent.getColumnByUid(n)}return null},n.prototype.createChooserItems=function(){for(var n,i=[],t=0,r=this.parent.columnModel;t<r.length;t++)n=r[t],n.showInColumnChooser&&n.field&&i.push({id:this.generateID(n.field,this.CHOOSER),text:n.headerText?n.headerText:n.field});return i},n.prototype.appendFilter=function(n){var r="Filter",i;this.defaultItems[""+r]&&(i=this.defaultItems[""+r].id,t.closest(n.target,"#"+i)&&!this.isFilterPopupOpen()?this.getFilter(n.target,i):!t.closest(n.target,"#"+i)&&this.isFilterPopupOpen()&&this.getFilter(n.target,i,!0))},n.prototype.getFilter=function(n,i,r){var u=this.getFilterPop();u?u.style.display=!t.Browser.isDevice&&r?"none":"block":this.parent.notify(il,{col:this.targetColumn,target:n,isClose:r,id:i})},n.prototype.setPosition=function(n,t){var r=this.parent.element.getBoundingClientRect(),u=n.getBoundingClientRect(),f=u.left-r.left,i=u.top-r.top;r.height<i?i=i-t.offsetHeight+u.height:r.height<i+t.offsetHeight&&(i=r.height-t.offsetHeight);window.innerHeight<t.offsetHeight+i+r.top&&(i=window.innerHeight-t.offsetHeight-r.top);i+r.top<0&&(i=0);f+=this.parent.enableRtl?-t.offsetWidth:u.width;r.width<=f+t.offsetWidth?(f-=u.width+t.offsetWidth,u.left<t.offsetWidth&&(f=u.left+t.offsetWidth/2)):f<0&&(f+=t.offsetWidth+u.width);t.style.top=i+"px";t.style.left=f+"px"},n.prototype.filterPosition=function(){var n=this.getFilterPop(),r,i;(n.classList.add(this.WRAP),t.Browser.isDevice)||(r=n.style.display,n.style.cssText+="display:block;visibility:hidden",i=this.element.querySelector("."+this.FILTER),i&&(this.setPosition(i.parentElement,n),n.style.cssText+="display:"+r+";visibility:visible"))},n.prototype.getDefault=function(){var n=[];return this.parent.ensureModuleInjected(gv)&&(n.push("AutoFitAll"),n.push("AutoFit")),this.parent.allowGrouping&&this.parent.ensureModuleInjected(sf)&&(n.push("Group"),n.push("Ungroup")),this.parent.allowSorting&&this.parent.ensureModuleInjected(bo)&&(n.push("SortAscending"),n.push("SortDescending")),n.push("ColumnChooser"),this.parent.allowFiltering&&"FilterBar"!==this.parent.filterSettings.type&&this.parent.ensureModuleInjected(dv)&&n.push("Filter"),n},n.prototype.isFilterPopupOpen=function(){var n=this.getFilterPop();return n&&"none"!==n.style.display},n.prototype.getFilterPop=function(){return t.Browser.isDevice&&null!==this.targetColumn&&"Menu"===this.parent.filterSettings.type?document.getElementById(this.targetColumn.uid+"-flmdlg"):this.parent.element.querySelector("."+this.POP)},n.prototype.isFilterItemAdded=function(){return this.parent.columnMenuItems&&this.parent.columnMenuItems.indexOf("Filter")>=0||!this.parent.columnMenuItems},n}(),pct=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),wct=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.parent=t,r.serviceLocator=i,r.initEvent(),r}return pct(i,n),i.prototype.initEvent=function(){this.parent.isDestroyed||(this.parent.on(rl,this.initForeignKeyColumns,this),this.parent.on(ss,this.getForeignKeyData,this),this.parent.on(kf,this.generateQueryFormData,this))},i.prototype.initForeignKeyColumns=function(n){for(var i=0;i<n.length;i++)n[parseInt(i.toString(),10)].dataSource=n[parseInt(i.toString(),10)].dataSource instanceof u.DataManager?n[parseInt(i.toString(),10)].dataSource:t.isNullOrUndefined(n[parseInt(i.toString(),10)].dataSource)?new u.DataManager:"result"in n[parseInt(i.toString(),10)].dataSource?n[parseInt(i.toString(),10)].dataSource:new u.DataManager(n[parseInt(i.toString(),10)].dataSource)},i.prototype.eventfPromise=function(n,i,r,f){var o=this.getStateEventArgument(i),s=new u.Deferred,h=new u.Deferred,e;return o.action=n.action,e=this.parent.getDataModule(),!t.isNullOrUndefined(n.action)&&n.action.requestType&&!1!==e.foreignKeyDataState.isDataChanged?(e.setForeignKeyDataState({isPending:!0,resolver:h.resolve}),h.promise.then(function(){s.resolve(f.dataSource)}),o.setColumnData=this.parent.setForeignKeyData.bind(this.parent),this.parent.trigger(on,o)):(e.setForeignKeyDataState({}),s.resolve(r)),s},i.prototype.getForeignKeyData=function(n){for(var o=this,i=n.column?[n.column]:this.parent.getForeignKeyColumns(),e=[],s=function(t){var o=void 0,f=n.isComplex?r.genarateColumnQuery(i[parseInt(t.toString(),10)]):r.genarateQuery(i[parseInt(t.toString(),10)],n.result.result,!1,!0),u;f.params=r.parent.query.params;u=i[parseInt(t.toString(),10)].dataSource;o=u&&"result"in u?r.eventfPromise(n,f,u,i[parseInt(t.toString(),10)]).promise:!u.ready||u.dataSource.offline?u.executeQuery(f):u.ready.then(function(){return u.executeQuery(f)});e.push(o)},r=this,f=0;f<i.length;f++)s(f);Promise.all(e).then(function(r){for(var f=0;f<r.length;f++)i[parseInt(f.toString(),10)].columnData=r[parseInt(f.toString(),10)].result,"dropdownedit"===i[parseInt(f.toString(),10)].editType&&"result"in i[parseInt(f.toString(),10)].dataSource&&(i[parseInt(f.toString(),10)].edit.params=t.extend(i[parseInt(f.toString(),10)].edit.params,{dataSource:r[parseInt(f.toString(),10)].result,query:new u.Query,fields:{value:i[parseInt(f.toString(),10)].foreignKeyField||i[parseInt(f.toString(),10)].field,text:i[parseInt(f.toString(),10)].foreignKeyValue}}));n.promise.resolve(n.result)}).catch(function(t){return o.parent.log(["actionfailure","foreign_key_failure"]),n.promise&&n.promise.reject&&n.promise.reject(t),t})},i.prototype.generateQueryFormData=function(n){n.predicate.predicate=this.genarateQuery(n.column,n.column.columnData,!0)},i.prototype.genarateQuery=function(n,t,i,r){var h=this.parent,e=[],c=new u.Query,s=i?n.foreignKeyField:n.field,o,f;if(h.allowPaging||h.enableVirtualization||i)for(t=new u.DataManager(h.allowGrouping&&h.groupSettings.columns.length&&!i?t.records:t).executeLocal((new u.Query).select(s)),o=u.DataUtil.distinct(t,s,!1),s=i?n.field:n.foreignKeyField,f=0;f<o.length;f++)o[parseInt(f.toString(),10)]&&o[parseInt(f.toString(),10)].getDay?e.push(au({field:s,operator:"equal",value:o[parseInt(f.toString(),10)],matchCase:!1})):e.push(new u.Predicate(s,"equal",o[parseInt(f.toString(),10)],!1));return r?e.length?c.where(u.Predicate.or(e)):c:e.length?u.Predicate.or(e):{predicates:[]}},i.prototype.genarateColumnQuery=function(n){var r=this.parent,t=new u.Query,f=this.isFiltered(n),i;return(f.isTrue&&(t=this.filterQuery(t,f.column,!0)),r.searchSettings.key.length)&&(i=r.searchSettings,n.dataSource instanceof u.DataManager&&n.dataSource.adaptor.getModuleName&&"ODataV4Adaptor"===n.dataSource.adaptor.getModuleName()?t=this.searchQuery(t,n,!0):t.search(i.key,n.foreignKeyValue,i.operator,i.ignoreCase)),t},i.prototype.isFiltered=function(n){var t=this.parent.filterSettings.columns.filter(function(t){return t.field===n.foreignKeyValue&&t.uid===n.uid});return{column:t,isTrue:!!t.length}},i.prototype.getModuleName=function(){return"foreignKey"},i.prototype.destroy=function(){this.destroyEvent()},i.prototype.destroyEvent=function(){this.parent.isDestroyed||(this.parent.off(rl,this.initForeignKeyColumns),this.parent.off(ss,this.getForeignKeyData),this.parent.off(kf,this.generateQueryFormData))},i}(th),yu="https://ej2.syncfusion.com/documentation/grid",fy="https://ej2.syncfusion.com/documentation/",pu="[EJ2Grid.Warning]",ce="[EJ2Grid.Error]",ey="[EJ2Grid.Info]",bct=function(){function n(n){this.parent=n;this.parent.on("initial-end",this.patchadaptor,this)}return n.prototype.getModuleName=function(){return"logger"},n.prototype.log=function(n,t){var u,i,r,f;for(n instanceof Array||(n=[n]),u=n,i=0;i<u.length;i++)r=bft[u[parseInt(i.toString(),10)]],f=r.check(t,this.parent),f.success&&console[r.logType](r.generateMessage(t,this.parent,f.options))},n.prototype.patchadaptor=function(){var n=this.parent.getDataModule().dataManager.adaptor,t=n.beforeSend;t&&(n.beforeSend=function(i,r,u){t.call(n,i,r,u)})},n.prototype.destroy=function(){this.parent.isDestroyed||this.parent.off("initial-end",this.patchadaptor)},n}(),bft={module_missing:{type:"module_missing",logType:"warn",check:function(n,t){var r=t.getInjectedModules().map(function(n){return n.prototype.getModuleName()}),i=t.requiredModules().map(function(n){return n.member}).filter(function(n){return-1===r.indexOf(n)});return{success:i.filter(function(n){return"resize"!==n}).length>0,options:i}},generateMessage:function(n,t,i){return i=i.filter(function(n){return"resize"!==n}).reduce(function(n,t){return n+"* "+t+"\n"},""),pu+": MODULES MISSING\nThe following modules are not injected:.\n"+i+"Refer to "+yu+"/module.html for documentation on importing feature modules."}},promise_enabled:{type:"promise_enabled",logType:"error",check:function(){return{success:"undefined"==typeof Promise}},generateMessage:function(){return ce+": PROMISE UNDEFINED\nPromise object is not present in the global environment,please use polyfil to support Promise object in your environment.\nRefer to "+fy+"/base/browser.html?#required-polyfills for more information."}},primary_column_missing:{type:"primary_column_missing",logType:"warn",check:function(n,t){return{success:0===t.getColumns().filter(function(n){return n.isPrimaryKey}).length}},generateMessage:function(){return pu+": PRIMARY KEY MISSING\nEditing is enabled but primary key column is not specified.\nRefer to "+yu+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},selection_key_missing:{type:"selection_key_missing",logType:"warn",check:function(n,t){return{success:t.selectionSettings.persistSelection&&0===t.getColumns().filter(function(n){return n.isPrimaryKey}).length}},generateMessage:function(){return pu+": PRIMARY KEY MISSING\nselectionSettings.persistSelection property is enabled. It requires one primary key column to persist selection.\nRefer to "+yu+"/api-column.html?#isprimarykey for documentation on providing primary key columns."}},actionfailure:{type:"actionfailure",logType:"error",check:function(){return{success:!0}},generateMessage:function(n,t){var i,r=kct(n,t),u=dct(n,t);return i=""!==u?u:""!==r?r:n.error,pu+": "+i}},locale_missing:{type:"locale_missing",logType:"warn",check:function(n,i){var r=u.DataUtil.getObject("locale."+i.locale+".grid",t.L10n);return{success:"en-US"!==i.locale&&t.isNullOrUndefined(r)}},generateMessage:function(n,t){return pu+": LOCALE CONFIG MISSING\nLocale configuration for '"+t.locale+"' is not provided.\nRefer to "+yu+"/globalization-and-localization.html?#localization \n             for documentation on setting locale configuration."}},limitation:{type:"limitation",logType:"warn",check:function(n,i){var r;switch(n){case"freeze":r={success:i.allowGrouping||!t.isUndefined(i.detailTemplate)||!t.isUndefined(i.childGrid)||!t.isUndefined(i.rowTemplate)||i.enableVirtualization,options:{name:"freeze"}};break;case"virtualization":r={success:!t.isUndefined(i.detailTemplate)||!t.isUndefined(i.childGrid)||0!==i.frozenRows||0!==i.frozenColumns,options:{name:"virtualization"}};break;default:r={success:!1}}return r},generateMessage:function(n,t,i){var r,u=i.name;switch(u){case"freeze":r="Frozen rows and columns do not support the following features:\n* Virtualization\n* Row Template\n* Details Template\n* Hierarchy Grid\n* Grouping";break;case"virtualization":r="Virtualization does not support the following features.\n* Freeze rows and columns.\n* Details Template.\n* Hierarchy Grid.\n";break;default:r=""}return pu+": "+u.toUpperCase()+" LIMITATIONS\n"+r}},check_datasource_columns:{type:"check_datasource_columns",logType:"warn",check:function(n,t){return{success:!(t.columns.length||t.dataSource instanceof u.DataManager||t.dataSource.length)}},generateMessage:function(){return pu+": GRID CONFIG MISSING\ndataSource and columns are not provided in the grid. At least one of either must be provided for grid configuration.\nRefer to "+yu+"/columns.html for documentation on configuring the grid data and columns."}},virtual_height:{type:"virtual_height",logType:"error",check:function(n,i){return{success:t.isNullOrUndefined(i.height)||"auto"===i.height}},generateMessage:function(){return ce+": GRID HEIGHT MISSING \nheight property is required to use virtualization.\nRefer to "+yu+"/virtual.html for documentation on configuring the virtual grid."}},grid_remote_edit:{type:"grid_remote_edit",logType:"error",check:function(n){return{success:Array.isArray(n)||Array.isArray(n.result)}},generateMessage:function(){return ce+": RETRUN VALUE MISSING  \nRemote service returns invalid data. \nRefer to "+yu+"/edit.html for documentation on configuring editing with remote data."}},grid_sort_comparer:{type:"grid_sort_comparer",logType:"warn",check:function(n,t){return{success:t.getDataModule().isRemote()}},generateMessage:function(){return pu+": SORT COMPARER NOT WORKING  \nSort comparer will not work with remote data.Refer to "+yu+"/sorting/#custom-sort-comparer for documentation on using the sort comparer."}},resize_min_max:{type:"resize_min_max",logType:"info",check:function(n){return{success:n.column.minWidth&&n.column.minWidth>=n.width||n.column.maxWidth&&n.column.maxWidth<=n.width}},generateMessage:function(){return ey+": RESIZING COLUMN REACHED MIN OR MAX  \nThe column resizing width is at its min or max."}},action_disabled_column:{type:"action_disabled_column",logType:"info",check:function(n){var i;switch(n.moduleName){case"reorder":i=t.isNullOrUndefined(n.destColumn)?"reordering action is disabled for the "+n.column.headerText+" column":"reordering action is disabled for the "+(n.column.allowReordering?n.destColumn.headerText:n.column.headerText)+" column";break;case"group":i="grouping action is disabled for the "+n.columnName+" column.";break;case"filter":i="filtering action is disabled for the "+n.columnName+" column.";break;case"sort":i="sorting action is disabled for the "+n.columnName+" column."}return{success:!0,options:{fn:i}}},generateMessage:function(n,t,i){return ey+": ACTION DISABLED \n "+i.fn}},exporting_begin:{type:"exporting_begin",logType:"info",check:function(n){return{success:!0,options:{args:n}}},generateMessage:function(n,t,i){return ey+": EXPORTNIG INPROGRESS \n Grid "+i.args+"ing is in progress"}},exporting_complete:{type:"exporting_complete",logType:"info",check:function(n){return{success:!0,options:{args:n}}},generateMessage:function(n,t,i){return ey+": EXPORTNIG COMPLETED \n Grid "+i.args+"ing is complete"}},foreign_key_failure:{type:"foreign_key_failure",logType:"error",check:function(){return{success:!0}},generateMessage:function(){return ce+": FOREIGNKEY CONFIG \n  Grid foreign key column needs a valid data source/service.Refer to "+yu+"/columns/#foreign-key-column for documentation on configuring foreign key columns."}},initial_action:{type:"initial_action",logType:"error",check:function(n){var t;switch(n.moduleName){case"group":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to group the column";break;case"filter":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to filter the column.";break;case"sort":t="The "+n.columnName+" column is not available in the grid's column model.Please provide a valid field name to sort the column."}return{success:!0,options:{fn:t}}},generateMessage:function(n,t,i){return ce+": INITIAL ACTION FAILURE \n "+i.fn}},frozen_rows_columns:{type:"frozen_rows_columns",logType:"error",check:function(n,t){return{success:t.getColumns().length<=t.frozenColumns||t.frozenRows>=t.currentViewData.length}},generateMessage:function(n,t){return ce+": OUT OF RANGE ERROR-\n "+(t.getColumns().length<=t.frozenColumns?"FROZEN COLUMNS,":"")+(t.frozenRows>=t.currentViewData.length?"FROZEN ROWS":"")+" invalid"}},column_type_missing:{type:"column_type_missing",logType:"error",check:function(n){return{success:t.isNullOrUndefined(n.column.type),options:n.column.headerText}},generateMessage:function(n,t,i){return ce+": COLUMN TYPE MISSING-\n  "+i+" column type was invalid or not defined.Please go through below help link: "+fy+"/grid/columns/#column-type"}},datasource_syntax_mismatch:{type:"datasource_syntax_mismatch",logType:"warn",check:function(n){return{success:n.dataState.dataSource&&!(n.dataState.dataSource instanceof u.DataManager||"result"in n.dataState.dataSource||n.dataState.dataSource instanceof Array)&&!t.isNullOrUndefined(n.dataState.dataStateChange)}},generateMessage:function(){return pu+": DATASOURCE SYNTAX WARNING\nDataSource should be in the form of {result: Object[], count: number}when dataStateChangeEvent used"}}},kct=function(n){var t=n.error;return t.indexOf&&0!==t.indexOf("Format options")?"":"INVALID FORMAT\nFor more information, refer to the following documentation links:\nNumber format: "+fy+"/base/intl.html?#supported-format-string.\nDate format: "+fy+"/base/intl.html?#manipulating-datetime.\nMessage: "+t},dct=function(n){var i=u.DataUtil.getObject("error.error",n),r;if(t.isNullOrUndefined(i))return"";r="";try{r=JSON.parse(i.responseText)}catch(n){r=""}return"XMLHTTPREQUEST FAILED\nUrl: "+i.responseURL+"\nStatus: "+i.status+" - "+i.statusText+"\n"+(""!==r?"Message: "+r:"")},gct=function(){function n(n,t){this.infiniteCache={};this.infiniteCurrentViewData={};this.infiniteFrozenCache={};this.isDownScroll=!1;this.isUpScroll=!1;this.isScroll=!0;this.enableContinuousScroll=!1;this.initialRender=!0;this.isRemove=!1;this.isInitialCollapse=!1;this.prevScrollTop=0;this.actions=["filtering","searching","grouping","ungrouping","reorder","sorting","refresh"];this.keys=[wa,ro,ba,rh];this.rowTop=0;this.isInitialMovableRender=!0;this.virtualInfiniteData={};this.isCancel=!1;this.emptyRowData={};this.isNormaledit=!1;this.isInfiniteScroll=!1;this.isLastPage=!1;this.isInitialRender=!0;this.isFocusScroll=!1;this.isGroupCollapse=!1;this.parent=n;this.serviceLocator=t;this.isNormaledit="Normal"===this.parent.editSettings.mode;this.addEventListener();this.widthService=t.getService("widthService");this.rowModelGenerator=this.parent.isFrozenGrid()?new ic(this.parent):new er(this.parent)}return n.prototype.getModuleName=function(){return"infiniteScroll"},n.prototype.addEventListener=function(){this.parent.on(ki,this.onDataReady,this);this.parent.on(ve,this.dataSourceModified,this);this.parent.on(al,this.infinitePageQuery,this);this.parent.on(ps,this.infiniteScrollHandler,this);this.parent.on(pf,this.infiniteCellFocus,this);this.parent.on(yl,this.appendInfiniteRows,this);this.parent.on(pl,this.removeInfiniteCacheRows,this);this.parent.on(ll,this.resetInfiniteBlocks,this);this.parent.on(wl,this.setCache,this);this.parent.on(bl,this.ensureIntialCollapse,this);this.parent.on(ht,this.infiniteCellFocus,this);this.parent.on(vl,this.setDisplayNone,this);this.parent.on(ls,this.editActionBegin,this);this.parent.on(iu,this.getVirtualInfiniteData,this);this.parent.on(vs,this.resetInfiniteEdit,this);this.parent.on(no,this.infiniteEditSuccess,this);this.parent.on(as,this.refreshInfiniteCache,this);this.parent.on(va,this.refreshInfiniteEditrowindex,this);this.parent.on(ws,this.infiniteEditHandler,this);this.parent.on(ys,this.infiniteAddActionBegin,this);this.parent.on(pt,this.modelChanged,this);this.parent.on(ra,this.refreshInfiniteCurrentViewData,this);this.parent.on(v,this.destroy,this);this.parent.on(it,this.selectNewRow,this);this.parent.on(la,this.captionActionComplete,this);this.parent.on(ds,this.setGroupCollapsePageQuery,this);this.actionBeginFunction=this.actionBegin.bind(this);this.actionCompleteFunction=this.actionComplete.bind(this);this.dataBoundFunction=this.dataBound.bind(this);this.parent.on(gc,this.deleteComplate,this);this.parent.addEventListener(nt,this.actionBeginFunction);this.parent.addEventListener(l,this.actionCompleteFunction);this.parent.addEventListener(ti,this.dataBoundFunction)},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ki,this.onDataReady),this.parent.off(ve,this.dataSourceModified),this.parent.off(al,this.infinitePageQuery),this.parent.off(ps,this.infiniteScrollHandler),this.parent.off(pf,this.infiniteCellFocus),this.parent.off(yl,this.appendInfiniteRows),this.parent.off(pl,this.removeInfiniteCacheRows),this.parent.off(ll,this.resetInfiniteBlocks),this.parent.off(wl,this.setCache),this.parent.off(bl,this.ensureIntialCollapse),this.parent.off(ht,this.infiniteCellFocus),this.parent.off(vl,this.setDisplayNone),this.parent.off(ls,this.editActionBegin),this.parent.off(iu,this.getVirtualInfiniteData),this.parent.off(vs,this.resetInfiniteEdit),this.parent.off(no,this.infiniteEditSuccess),this.parent.off(as,this.refreshInfiniteCache),this.parent.on(va,this.refreshInfiniteEditrowindex),this.parent.off(ws,this.infiniteEditHandler),this.parent.off(ys,this.infiniteAddActionBegin),this.parent.off(pt,this.modelChanged),this.parent.off(ra,this.refreshInfiniteCurrentViewData),this.parent.off(v,this.destroy),this.parent.off(it,this.selectNewRow),this.parent.off(la,this.captionActionComplete),this.parent.off(ds,this.setGroupCollapsePageQuery),this.parent.removeEventListener(nt,this.actionBeginFunction),this.parent.removeEventListener(l,this.actionCompleteFunction),this.parent.removeEventListener(ti,this.dataBoundFunction))},n.prototype.dataBound=function(){"collapse"===this.groupCaptionAction?(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest()):"refresh"===this.groupCaptionAction&&(this.parent.hideSpinner(),this.groupCaptionAction=this.empty)},n.prototype.setGroupCollapsePageQuery=function(n){var i=this.parent;if(!i.infiniteScrollSettings.enableCache&&this.isGroupCollapse)if(n.skipPage=!0,this.isGroupCollapse=!1,"collapse"===this.groupCaptionAction){for(var s=i.getRowObjectFromUID(this.parentCapUid),r=i.getRowsObject(),h=0,t=r.length-1;t>=0&&r[parseInt(t.toString(),10)].indent!==s.indent;t--)r[parseInt(t.toString(),10)].isDataRow&&h++;var c=po(r.indexOf(s),r),u=wv(c.fields,c.keys,this),e=bv(u);for(u=e[e.length-1],t=e.length-2;t>=0;t--)u=u.and(e[parseInt(t.toString(),10)]);n.query.where(u);n.query.skip(h);this.parentCapUid=this.empty}else{var l=i.getRows(),o=i.pageSettings.pageSize,f=hr(l[l.length-1])+1,a=f-f%o+o-f;f%o==0&&(a=0);n.query.skip(f);n.query.take(i.infiniteScrollSettings.initialBlocks*i.pageSettings.pageSize+a)}},n.prototype.captionActionComplete=function(n){var t=this.parent,i,r,u;!t.infiniteScrollSettings.enableCache&&n.isCollapse&&(i=t.getContent().firstElementChild.getBoundingClientRect(),r=t.contentModule.getTable().getBoundingClientRect(),Math.round(r.bottom-t.getRowHeight())<=Math.round(i.bottom)&&(this.parentCapUid=n.parentUid,this.groupCaptionAction="collapse",t.showSpinner(),u=t.getRowObjectFromUID(n.parentUid),this.getCaptionChildCount(u)?this.makeGroupCollapseRequest(n.parentUid):(this.groupCaptionAction="refresh",this.makeGroupCollapseRequest())))},n.prototype.makeGroupCollapseRequest=function(n){var t=this.parent,e=[].slice.call(t.getContentTable().querySelectorAll("tr")),i=t.groupSettings.enableLazyLoading?e:t.getRows(),r=t.groupSettings.enableLazyLoading?t.contentModule.visibleRows.length-1:hr(i[i.length-1]),u=this.parent.pageSettings.currentPage,f;u>=this.maxPage?t.hideSpinner():(this.parent.pageSettings.currentPage=Math.ceil(r/this.parent.pageSettings.pageSize)+1,f={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:u,startIndex:r+1,direction:"down",isCaptionCollapse:!0,parentUid:n},this.isGroupCollapse=!0,this.parent.notify("model-changed",f))},n.prototype.getCaptionChildCount=function(n){for(var t=this.parent.getRowsObject(),r=!1,i=t.indexOf(n);i<t.length&&(!(t[parseInt(i.toString(),10)].indent===n.indent||t[parseInt(i.toString(),10)].indent<n.indent)||t[parseInt(i.toString(),10)].data.key===n.data.key);i++)if(t[parseInt(i.toString(),10)].isCaptionRow&&!this.childCheck(t,t[parseInt(i.toString(),10)],i)){r=!0;break}return r},n.prototype.childCheck=function(n,t,i){for(var u=0,r=i+1;r<n.length&&n[parseInt(r.toString(),10)].indent!==t.indent;r++)n[parseInt(r.toString(),10)].indent===t.indent+1&&n[parseInt(r.toString(),10)].parentUid===t.uid&&u++;return t.data.count===u},n.prototype.updateCurrentViewData=function(){var n=this.parent,u;if(!n.groupSettings.columns.length){u=Object.keys(this.infiniteCurrentViewData);n.currentViewData=[];for(var t=n.pageSettings.currentPage,f=n.infiniteScrollSettings.enableCache,i=n.infiniteScrollSettings.maxBlocks,e=f&&(t>i||this.isUpScroll&&t>1),o=e?this.isUpScroll?t:t-i+1:1,s=e?o+i-1:f?i:u.length,r=o;r<=s;r++)this.infiniteCurrentViewData[parseInt(r.toString(),10)]&&(n.currentViewData=n.currentViewData.concat(this.infiniteCurrentViewData[parseInt(r.toString(),10)]))}},n.prototype.refreshInfiniteCurrentViewData=function(n){var r,o,u,t;"add"===n.args.action&&"save"===n.args.requestType&&(this.parent.pageSettings.currentPage=Math.ceil(n.args.index/this.parent.pageSettings.pageSize)?Math.ceil(n.args.index/this.parent.pageSettings.pageSize):1);var s=this.parent.pageSettings.currentPage,h=this.parent.pageSettings.pageSize,f=this.parent.infiniteScrollSettings.initialBlocks,i=Object.keys(this.infiniteCurrentViewData),e=this.parent.infiniteScrollSettings.enableCache;if(!this.parent.groupSettings.columns.length)if(r="save"===n.args.requestType&&!(this.parent.sortSettings.columns.length||this.parent.filterSettings.columns.length||this.parent.groupSettings.columns.length||this.parent.searchSettings.key),o="delete"===n.args.requestType,!e&&(r||o))if(r){for(u=0,t=1;t<=i.length;t++)if(u+=this.infiniteCurrentViewData[parseInt(t.toString(),10)].length-1,n.args.index<=u){this.resetCurrentViewData(t);this.infiniteCurrentViewData[parseInt(t.toString(),10)].splice(n.args.index,0,n.args.data);break}}else this.infiniteCurrentViewData[i[i.length-1]].push(n.data[0]);else f>1&&n.data.length===f*h?this.setInitialCache(n.data.slice(),{},e&&"delete"===n.args.requestType,!0):this.infiniteCurrentViewData[parseInt(s.toString(),10)]=n.data.slice()},n.prototype.resetCurrentViewData=function(n){for(var r,i=Object.keys(this.infiniteCurrentViewData),t=n;t<=i.length;t++)r=this.infiniteCurrentViewData[parseInt(t.toString(),10)][this.infiniteCurrentViewData[parseInt(t.toString(),10)].length-1],this.infiniteCurrentViewData[t+1]&&this.infiniteCurrentViewData[t+1].splice(0,0,r),this.infiniteCurrentViewData[parseInt(t.toString(),10)].pop()},n.prototype.deleteComplate=function(){this.parent.isFrozenGrid()&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.contentModule.refreshScrollOffset()},n.prototype.modelChanged=function(n){var t=this.parent.getRows(),i;("save"===n.requestType&&n.index&&n.data&&(this.addRowIndex=n.index),t&&t.length&&"infiniteScroll"!==n.requestType&&("delete"===n.requestType||"add"===this.requestType))&&((this.firstIndex=hr(t[0]),this.firstBlock=Math.ceil((this.firstIndex+1)/this.parent.pageSettings.pageSize),this.lastIndex=hr(t[t.length-1]),"delete"===n.requestType)?(i=this.parent.getRowsObject(),n.startIndex=this.parent.infiniteScrollSettings.enableCache?(this.firstBlock-1)*this.parent.pageSettings.pageSize:i[i.length-1].index):n.startIndex=this.firstIndex,this.parent.infiniteScrollSettings.enableCache||this.parent.pageSettings.currentPage!==this.maxPage||"delete"!==n.requestType||(this.isLastPage=!0,this.lastIndex=this.lastIndex-1))},n.prototype.infiniteAddActionBegin=function(n){this.isNormaledit&&(this.isAdd=!0,this.parent.infiniteScrollSettings.enableCache&&(Object.keys(this.emptyRowData).length||this.createEmptyRowdata(),this.parent.pageSettings.currentPage>1&&(n.startEdit=!1,this.resetInfiniteBlocks({},!0),this.makeRequest({currentPage:1}))))},n.prototype.infiniteEditHandler=function(n){var f,e,o,h;if(!this.parent.infiniteScrollSettings.enableCache&&("delete"===n.e.requestType||"save"===n.e.requestType&&"add"===this.requestType)){var u=this.parent.isFrozenGrid(),i=this.parent.getRows(),r=this.parent.getRowsObject();this.ensureRowAvailability(r,n.result[0])&&(!i.length||this.addRowIndex&&this.addRowIndex>=i.length||(this.resetRowIndex(r,n.e,i,"add"===this.requestType,!0),!u)||(f=this.parent.getMovableRowsObject(),(this.resetRowIndex(f,n.e,this.parent.getMovableDataRows(),"add"===this.requestType),this.parent.getFrozenMode()===s)&&(e=this.parent.getFrozenRightRowsObject(),this.resetRowIndex(e,n.e,this.parent.getFrozenRightRows(),"add"===this.requestType))),this.isLastPage?(this.isLastPage=!1,this.parent.pageSettings.currentPage=this.maxPage,this.parent.selectionModule.index<this.parent.frozenRows)&&((t.remove(i[this.parent.frozenRows-1]),this.createRow([r[this.parent.frozenRows-1]],n,!1,!0),u)&&(o=this.parent.getMovableDataRows(),(t.remove(o[this.parent.frozenRows]),this.createRow([this.parent.getMovableRowsObject()[this.parent.frozenRows-1]],n,!0,!0),this.parent.getFrozenMode()===s)&&(h=this.parent.getFrozenRightDataRows(),t.remove(h[this.parent.frozenRows]),this.createRow([this.parent.getFrozenRightRowsObject()[this.parent.frozenRows-1]],n,!1,!0,!0))),oe(this.parent)):this.createRow(r,n));this.parent.hideSpinner();this.parent.notify(aa,{});"delete"===this.requestType?this.parent.notify(gc,n.e):this.parent.notify(fp,n.e)}this.parent.notify(ei,{"case":"refreshHeight"})},n.prototype.createRow=function(n,i,r,u,f){var o=u?n:this.generateRows(i.result,i.e),a=new oi(this.serviceLocator,null,this.parent),h,l,c,v,y;if(this.parent.removeMaskRow(),!("save"===i.e.requestType&&i.e.index&&i.e.data&&(o[0].index=this.addRowIndex,this.addRowIndex=null,o[0].index>=n.length))){if(h=f?this.parent.element.querySelector(".e-frozen-right-content").querySelector(e):this.parent.isFrozenGrid()?r?this.parent.getMovableVirtualContent().querySelector(e):this.parent.getFrozenVirtualContent().querySelector(e):this.parent.getContent().querySelector(e),this.parent.frozenRows&&(h=u&&"add"!==this.requestType||!u&&"add"===this.requestType?this.parent.isFrozenGrid()?r?this.parent.getMovableVirtualHeader().querySelector(e):f?this.parent.element.querySelector(".e-frozen-right-header").querySelector(e):this.parent.getFrozenVirtualHeader().querySelector(e):this.parent.getHeaderContent().querySelector(e):h),l={rows:n,cancel:!1,args:i,isMovable:r,isFrozenRows:u,isFrozenRight:u,row:o},this.parent.notify(ctt,l),!l.cancel)for(c=o.length-1;c>=0;c--)"delete"===this.requestType?h.appendChild(a.render(o[parseInt(c.toString(),10)],this.parent.getColumns())):h.insertBefore(a.render(o[parseInt(c.toString(),10)],this.parent.getColumns()),h.rows[i.e.index]);!u&&this.parent.frozenRows&&(this.parent.selectionModule.index<this.parent.frozenRows||"add"===this.requestType)&&(v=r?this.parent.getMovableDataRows():f?this.parent.getFrozenRightDataRows():this.parent.getRows(),y=(r||f)&&"add"===this.requestType?this.parent.frozenRows:this.parent.frozenRows-1,t.remove(v[parseInt(y.toString(),10)]),this.createRow([n[this.parent.frozenRows-1]],i,r,!0,f));this.parent.infiniteScrollSettings.enableCache||u||(f?(oe(this.parent),this.parent.contentModule.rightFreezeRows="add"===this.requestType?o.concat(n):n.concat(o)):!this.parent.isFrozenGrid()||r?(oe(this.parent),this.parent.contentModule.visibleRows="add"===this.requestType?o.concat(n):n.concat(o),this.parent.getFrozenMode()===s&&(i.e.renderMovableContent=!0,this.createRow(this.parent.getFrozenRightRowsObject(),i,!1,!1,!0))):(this.parent.contentModule.visibleFrozenRows="add"===this.requestType?o.concat(n):n.concat(o),i.e.isFrozen=!0,this.createRow(this.parent.getMovableRowsObject(),i,!0)))}},n.prototype.ensureRowAvailability=function(n,t){var u=!0,r,i;if(this.parent.frozenRows&&!this.parent.infiniteScrollSettings.enableCache&&this.parent.sortSettings.columns&&"add"===this.requestType)for(r=this.parent.getPrimaryKeyFieldNames()[0],i=0;i<n.length;i++)if(n[parseInt(i.toString(),10)].data[""+r]===t[""+r]){u=!1;break}return u},n.prototype.generateRows=function(n,t){return this.rowModelGenerator.generateRows(n,t)},n.prototype.resetRowIndex=function(n,i,r,u,f){var e=this,o=this.parent.getPrimaryKeyFieldNames()[0],h=!(r.length%this.parent.pageSettings.pageSize),s;u?h&&(f&&!this.parent.groupSettings.columns.length&&this.swapCurrentViewData(1,!0),t.remove(r[n.length-1]),r.splice(n.length-1,1),n.splice(n.length-1,1)):n.filter(function(u,s){if(u.data[""+o]===i.data[0][""+o]){if(f&&!e.parent.groupSettings.columns.length){var h=Math.ceil((s+1)/e.parent.pageSettings.pageSize);e.resetInfiniteCurrentViewData(h,s)}n.splice(s,1);t.remove(r[parseInt(s.toString(),10)]);r.splice(s,1)}});s=u?this.addRowIndex?this.addRowIndex+1:1:0;of(this.parent,n,r,s,this.addRowIndex?this.addRowIndex:0)},n.prototype.resetInfiniteCurrentViewData=function(n,t){t-=(n-1)*this.parent.pageSettings.pageSize;this.infiniteCurrentViewData[parseInt(n.toString(),10)].splice(t,1);this.swapCurrentViewData(n,!1)},n.prototype.swapCurrentViewData=function(n,t){for(var r=Object.keys(this.infiniteCurrentViewData),u=t?r.length+1:r.length,i=n;i<u;i++)if(this.infiniteCurrentViewData[i+1]){var e=t?i:i+1,o=t?this.infiniteCurrentViewData[parseInt(i.toString(),10)].length-1:0,f=this.infiniteCurrentViewData[parseInt(e.toString(),10)].splice(o,1);t?(this.infiniteCurrentViewData[i+1]=f.concat(this.infiniteCurrentViewData[i+1]),i+1===u-1&&this.infiniteCurrentViewData[i+1].splice(this.infiniteCurrentViewData[i+1].length-1,1)):this.infiniteCurrentViewData[parseInt(i.toString(),10)].push(f[0])}this.updateCurrentViewData()},n.prototype.setDisplayNone=function(n){if(this.parent.infiniteScrollSettings.enableCache){for(var i=this.parent.isFrozenGrid(),r=i?Object.keys(this.infiniteFrozenCache):Object.keys(this.infiniteCache),t=1;t<=r.length;t++)(i?n.isFreeze?this.infiniteFrozenCache[parseInt(t.toString(),10)][0]:this.infiniteFrozenCache[parseInt(t.toString(),10)][1]:this.infiniteCache[parseInt(t.toString(),10)]).filter(function(t){t.cells[n.index].visible=""===n.visible});this.resetContentModuleCache(i?this.infiniteFrozenCache:this.infiniteCache)}},n.prototype.refreshInfiniteCache=function(n){this.getEditedRowObject().data=n.data},n.prototype.refreshInfiniteCacheRowVisibleLength=function(n,i){var e=n[parseInt(i.toString(),10)];if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){for(var r=0,u=0,f=0,o=0;o<e.length;o++)e[parseInt(o.toString(),10)].visible||t.isNullOrUndefined(e[parseInt(o.toString(),10)].visible)?u++:f++;return f>u?(r=f-u)>u&&(r=u):(r=u-f)>f&&(r=f),0===r&&(r=1),r}return e.length},n.prototype.refreshInfiniteEditrowindex=function(n){this.editRowIndex=n.index},n.prototype.getEditedRowObject=function(){for(var i,t=this.parent.getRowsObject(),n=0;n<t.length;n++)t[parseInt(n.toString(),10)].index===this.editRowIndex&&(i=t[parseInt(n.toString(),10)]);return i},n.prototype.infiniteEditSuccess=function(n){this.isNormaledit&&(!this.isAdd&&n.data&&this.updateCurrentViewRecords(n.data),this.isAdd=!1)},n.prototype.updateCurrentViewRecords=function(n){var i=cv(this.parent,n);t.isNullOrUndefined(i)||(this.parent.getCurrentViewRecords()[parseInt(i.toString(),10)]=n)},n.prototype.actionBegin=function(n){"add"===n.requestType||"delete"===n.requestType?this.requestType=n.requestType:"add"===n.action&&"save"===n.requestType&&(this.requestType=n.action);(this.parent.isFrozenGrid()&&!n.cancel&&"searching"===n.requestType||"sorting"===n.requestType||"filtering"===n.requestType)&&(this.isInitialRender=!0)},n.prototype.actionComplete=function(n){"delete"!==n.requestType&&"save"!==n.requestType&&"cancel"!==n.requestType||(this.requestType=this.empty,this.isCancel="cancel"===n.requestType||"save"===n.requestType,this.isAdd=this.isEdit=!1,this.isNormaledit&&(this.editRowIndex=this.empty,this.virtualInfiniteData={},this.parent.editModule.previousVirtualData={}))},n.prototype.resetInfiniteEdit=function(){this.parent.enableInfiniteScrolling&&this.isNormaledit&&(this.parent.editSettings.allowEditing&&this.isEdit||this.parent.editSettings.allowAdding&&this.isAdd)&&(this.parent.isEdit=!0)},n.prototype.getVirtualInfiniteData=function(n){this.parent.infiniteScrollSettings.enableCache&&this.parent.isEdit&&t.isNullOrUndefined(n.endEdit)?this.parent.editModule.closeEdit():(this.getVirtualInfiniteEditedData(),n.virtualData=this.virtualInfiniteData,n.isAdd=this.isAdd,n.isCancel=this.isCancel)},n.prototype.editActionBegin=function(n){this.isEdit=!0;this.editRowIndex=n.index;var i=t.extend({},this.getEditedRowObject().data);n.data=Object.keys(this.virtualInfiniteData).length?this.virtualInfiniteData:i},n.prototype.dataSourceModified=function(){this.resetInfiniteBlocks({requestType:this.empty},!0)},n.prototype.onDataReady=function(n){t.isNullOrUndefined(n.count)||"infiniteScroll"===n.requestType||(this.maxPage=Math.ceil(n.count/this.parent.pageSettings.pageSize))},n.prototype.ensureIntialCollapse=function(n){this.isInitialCollapse=!n},n.prototype.infiniteScrollHandler=function(n){var i,r,c,f,a,p;if(this.restoreInfiniteEdit(),this.restoreInfiniteAdd(),i=n.target,i.classList.contains(ft)&&this.parent.enableInfiniteScrolling&&!n.isLeft){if(r=this.parent.getContent().firstElementChild,c=[].slice.call(this.parent.getContentTable().querySelectorAll("tr")),this.prevScrollTop=r.scrollTop,f=this.parent.groupSettings.enableLazyLoading?c:this.parent.getRows(),!f.length)return;var w=hr(f[f.length-1])+1,l=this.parent.pageSettings.currentPage,u=void 0,e=i.scrollHeight-i.scrollTop,b=Math.round(i.scrollHeight-i.scrollTop),o=e<i.clientHeight?Math.ceil(e):Math.floor(e);if(o>i.clientHeight&&(o-=1),a=o===i.clientHeight||b===i.clientHeight,!t.isNullOrUndefined(this.groupCaptionAction))return;if(this.isScroll&&a&&(this.parent.pageSettings.currentPage<=this.maxPage-1||this.enableContinuousScroll)){this.parent.infiniteScrollSettings.enableCache&&(this.isUpScroll=!1,this.isDownScroll=!0);var v=[].slice.call(r.querySelectorAll(".e-row:not(.e-addedrow)")),s=v[v.length-1],h=this.parent.groupSettings.enableLazyLoading?this.parent.contentModule.visibleRows.length-1:hr(s);this.parent.pageSettings.currentPage=Math.ceil(h/this.parent.pageSettings.pageSize)+1;u={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:w,direction:"down"};this.makeRequest(u)}this.isScroll&&this.parent.infiniteScrollSettings.enableCache&&0===i.scrollTop&&1!==this.parent.pageSettings.currentPage&&(this.parent.infiniteScrollSettings.enableCache&&(this.isDownScroll=!1,this.isUpScroll=!0),h=hr((s=[].slice.call(r.getElementsByClassName(y)))[this.parent.pageSettings.pageSize-1]),p=hr(s[0])-this.parent.pageSettings.pageSize,this.parent.pageSettings.currentPage=Math.ceil(h/this.parent.pageSettings.pageSize)-1,this.parent.pageSettings.currentPage&&(u={requestType:"infiniteScroll",currentPage:this.parent.pageSettings.currentPage,prevPage:l,startIndex:p,direction:"up"},this.makeRequest(u)));this.parent.infiniteScrollSettings.enableCache&&!this.isScroll&&t.isNullOrUndefined(u)&&(this.isDownScroll||this.isUpScroll)&&(r.scrollTop=this.top)}},n.prototype.makeRequest=function(n){var i=this;this.parent.pageSettings.currentPage!==n.prevPage&&(this.parent.infiniteScrollSettings.initialBlocks<this.maxPage&&this.parent.pageSettings.currentPage<=this.maxPage?(this.isInfiniteScroll=!0,t.isNullOrUndefined(this.infiniteCache[n.currentPage])?setTimeout(function(){i.getVirtualInfiniteEditedData();i.parent.notify("model-changed",n)},100):setTimeout(function(){i.getVirtualInfiniteEditedData();i.parent.notify(tw,n)},100)):this.parent.pageSettings.currentPage=this.maxPage)},n.prototype.infinitePageQuery=function(n){this.initialRender?(this.initialRender=!1,this.intialPageQuery(n)):"delete"===this.requestType||"add"===this.requestType?this.isInfiniteScroll||this.parent.groupSettings.enableLazyLoading?this.parent.groupSettings.enableLazyLoading&&!this.parent.infiniteScrollSettings.enableCache?this.parent.infiniteScrollSettings.initialBlocks<this.parent.pageSettings.currentPage?n.page(1,this.parent.pageSettings.pageSize*this.parent.pageSettings.currentPage):n.page(1,this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks):n.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize):this.editPageQuery(n):n.page(this.parent.pageSettings.currentPage,this.parent.pageSettings.pageSize)},n.prototype.editPageQuery=function(n){var i=this.parent.infiniteScrollSettings.initialBlocks,r;this.parent.infiniteScrollSettings.enableCache?(this.infiniteCache={},this.infiniteFrozenCache={},this.infiniteCurrentViewData={},n.skip(this.firstIndex),n.take(i*this.parent.pageSettings.pageSize)):("Dialog"===this.parent.editSettings.mode&&this.parent.clearSelection(),r="delete"===this.requestType?this.lastIndex:this.addRowIndex?this.addRowIndex:this.firstIndex,n.skip(r),t.isNullOrUndefined(this.parent.getDataModule().dataManager.dataSource.url)||""===this.parent.getDataModule().dataManager.dataSource.url||"delete"!==this.requestType&&"add"!==this.requestType?n.take(1):n.take(i*this.parent.pageSettings.pageSize))},n.prototype.intialPageQuery=function(n){this.parent.infiniteScrollSettings.enableCache&&this.parent.infiniteScrollSettings.initialBlocks>this.parent.infiniteScrollSettings.maxBlocks&&(this.parent.infiniteScrollSettings.initialBlocks=this.parent.infiniteScrollSettings.maxBlocks);var t=this.parent.pageSettings.pageSize*this.parent.infiniteScrollSettings.initialBlocks;n.page(1,t)},n.prototype.scrollToLastFocusedCell=function(n){var i=this.parent,f=this.lastFocusInfo.rowIdx+(n.keyArgs.action===ro?-1:1),y=this.lastFocusInfo.cellIdx,c=i.getRowByIndex(f),l,r,a,u,e,h;if(!c){l=new oi(this.serviceLocator,null,this.parent);r=Math.floor(f/this.parent.pageSettings.pageSize)+1;i.pageSettings.currentPage=r;a=i.getColumns();t.remove(i.getContent().querySelector("tbody"));i.getContent().querySelector("table").appendChild(i.createElement("tbody",{attrs:{role:"rowgroup"}}));for(var o=[],s=1===r||this.maxPage===r?0:-1,v=0;v<i.infiniteScrollSettings.maxBlocks;this.maxPage===r?s--:s++,v++)if(u=this.infiniteCache[r+s],u)for(o=o.concat(u),e=0;e<u.length;e++)i.getContent().querySelector("tbody").appendChild(l.render(u[parseInt(e.toString(),10)],a));i.notify(it,{rows:o,args:{}});oe(i)}h=(c=i.getRowByIndex(f)).cells[parseInt(y.toString(),10)];i.focusModule.isInfiniteScroll=!0;i.focusModule.onClick({target:h},!0);i.selectRow(f);h.focus();this.isFocusScroll=!1;n.cancel=!0},n.prototype.setLastCellFocusInfo=function(n){var t=n.byClick&&n.clickArgs.target||n.byKey&&n.keyArgs.target||(!this.isFocusScroll&&n).target,i,r;t&&t.classList.contains("e-rowcell")&&(i=parseInt(t.getAttribute("data-colindex"),10),r=parseInt(t.parentElement.getAttribute("data-rowindex"),10),this.lastFocusInfo={rowIdx:r,cellIdx:i})},n.prototype.infiniteCellFocus=function(n){var u=this.parent,e=u.infiniteScrollSettings.enableCache,f,t,i,r;if(n.byKey){if(e&&this.isFocusScroll)return void this.scrollToLastFocusedCell(n);f=document.activeElement;t=hr(f.parentElement);this.cellIndex=parseInt(f.getAttribute(lt),10);var o=u.getContent().firstElementChild,h=this.maxPage*u.pageSettings.pageSize-1,c=Math.floor(o.offsetHeight/this.parent.getRowHeight()),s=o.getBoundingClientRect();isNaN(t)||(n.keyArgs.action===wa||n.keyArgs.action===ba?(this.rowIndex=t+=1,i=(r=u.getRowByIndex(t))&&r.getBoundingClientRect(),e&&(t=f.parentElement.rowIndex+1),this.isFocusScroll||!r&&t<h||i&&i.bottom>=s.bottom?(this.isFocusScroll||(this.pressedKey=n.keyArgs.action),this.isFocusScroll=!1,o.scrollTop=(t-c+1)*this.parent.getRowHeight()):!e&&r&&i&&(i.bottom>=s.bottom||i.top<s.top)&&r.cells[this.cellIndex].scrollIntoView()):(n.keyArgs.action===ro||n.keyArgs.action===rh)&&(this.rowIndex=t-=1,i=(r=u.getRowByIndex(t))&&r.getBoundingClientRect(),e&&(t=f.parentElement.rowIndex-1),(!r||i.top<=s.top)&&(this.pressedKey=n.keyArgs.action,o.scrollTop=t*this.parent.getRowHeight())))}else"PageDown"!==n.key&&"PageUp"!==n.key||(this.pressedKey=n.key);this.setLastCellFocusInfo(n)},n.prototype.createEmptyRowdata=function(){var n=this;this.parent.getColumns().filter(function(t){n.emptyRowData[t.field]=n.empty})},n.prototype.getVirtualInfiniteEditedData=function(){var u=this.parent.element.querySelector("."+ni),f=this.parent.element.querySelector("."+ui),e=this.parent.element.querySelector(".e-gridform"),r,i,n;if(this.parent.infiniteScrollSettings.enableCache&&(u||f)){for(r=u?t.extend({},this.getEditedRowObject().data):t.extend({},this.emptyRowData),this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(e,r),i=this.parent.getHiddenColumns(),n=0;n<i.length;n++)i[parseInt(n.toString(),10)].defaultValue&&(this.virtualInfiniteData[i[parseInt(n.toString(),10)].field]=i[parseInt(n.toString(),10)].defaultValue);this.parent.isFrozenGrid()&&(this.virtualInfiniteData=this.parent.editModule.getCurrentEditedData(this.parent.getMovableVirtualContent().querySelector(".e-gridform"),r))}},n.prototype.restoreInfiniteEdit=function(){var r=this.parent.getContent().firstElementChild,u=!this.parent.frozenRows||this.editRowIndex>=this.parent.frozenRows,n,i;this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&u&&this.parent.editSettings.allowEditing&&!t.isNullOrUndefined(this.editRowIndex)&&(n=this.parent.getRowByIndex(this.editRowIndex),Object.keys(this.virtualInfiniteData).length&&n&&!this.parent.getContent().querySelector("."+ni)&&(i=n.getBoundingClientRect().top,i<r.offsetHeight&&i>this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.editModule.startEdit(n))))},n.prototype.restoreInfiniteAdd=function(){var n=this.parent.getContent().firstElementChild;this.parent.getCurrentViewRecords().length&&this.parent.getRowByIndex(0)&&this.isNormaledit&&this.parent.infiniteScrollSettings.enableCache&&this.isAdd&&!n.querySelector("."+ui)&&n.scrollTop<this.parent.getRowHeight()&&(this.parent.isEdit=!1,this.parent.addRecord())},n.prototype.appendInfiniteRows=function(n){var c=this.parent.isFrozenGrid(),l=this.parent.getContent().firstElementChild,t=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.args.requestType,a=this.parent.getFrozenMode()===s&&"movable"===n.tableName,r,f,o,h,u,i;(this.parent.isAngular||this.parent.isReact||this.parent.isVue||this.parent.isVue3)&&t&&!n.args.isFrozen&&this.parent.infiniteScrollSettings.enableCache&&(r=!(!this.parent.childGrid||!this.parent.element.querySelectorAll(".e-childgrid").length),f=this.parent.getDataRows(),c?(this.parent.contentModule.freezeRowElements=f,o=this.parent.getContent().querySelector("."+p),h=this.parent.getContent().querySelector(".e-frozen-left-content"),o&&o.querySelectorAll(".e-templatecell").length&&this.parent.refreshReactTemplateTD(this.parent.getMovableDataRows(),r,!0),h&&h.querySelectorAll(".e-templatecell").length&&this.parent.refreshReactTemplateTD(this.parent.getDataRows(),r,!0),this.parent.contentModule.freezeRowElements=this.parent.getRows()):this.parent.refreshReactTemplateTD(f,r));((!t||n.args.isFrozen||a)&&t||(t&&"up"===n.args.direction?n.tbody.insertBefore(n.frag,n.tbody.firstElementChild):n.tbody.appendChild(n.frag)),c)?t?n.tableName===rt||"Right"===this.parent.getFrozenMode()&&n.tableName===d?this.frozenFrag=n.frag:this.parent.getFrozenMode()===s&&"movable"===n.tableName?this.movableFrag=n.frag:(u=this.parent.getFrozenVirtualContent().querySelector(e),"up"===n.args.direction?u.insertBefore(this.frozenFrag,u.firstElementChild):u.appendChild(this.frozenFrag),n.tableName===d?(this.parent.getMovableVirtualContent().querySelector(e).appendChild(this.movableFrag),this.parent.element.querySelector(".e-frozen-right-content").querySelector(e).appendChild(n.frag)):this.parent.getMovableVirtualContent().querySelector("."+k).appendChild(n.tbody),this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData()):(i=void 0,n.tableName===rt?i=this.parent.getFrozenVirtualContent().querySelector("."+k):"movable"===n.tableName?(i=this.parent.getMovableVirtualContent().querySelector("."+k),this.parent.getFrozenMode()!==s&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())):(i=this.parent.element.querySelector(".e-frozen-right-content").querySelector("."+k),this.parent.getFrozenMode()===s&&(this.parent.contentModule.refreshScrollOffset(),this.updateCurrentViewData())),i.appendChild(n.tbody),this.widthService.refreshFrozenScrollbar()):(this.parent.contentModule.getTable().appendChild(n.tbody),this.updateCurrentViewData());this.isInitialRender&&!n.args.isFrozen&&(this.isInitialRender=!1,this.parent.scrollModule.setHeight());n.args.isFrozen||(this.rowTop=this.rowTop?this.rowTop:this.parent.getRows()[0].getBoundingClientRect().top,t&&(this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(l.scrollTop=this.top),oe(this.parent)),this.restoreInfiniteAdd(),this.isScroll=!0);this.isInfiniteScroll=!1},n.prototype.selectNewRow=function(){var e=this,n=this.parent,u=n.getRowByIndex(this.rowIndex),t=n.infiniteScrollSettings.enableCache,r;if(u&&this.keys.some(function(n){return n===e.pressedKey})){var f=n.getContent().firstElementChild,o=n.getRowHeight(),i=u.cells[this.cellIndex];(this.pressedKey===wa||this.pressedKey===ba||t&&(this.pressedKey===ro||this.pressedKey===rh))&&(t||this.pressedKey===ro||this.pressedKey===rh||(f.scrollTop=f.scrollTop+o),n.focusModule.isInfiniteScroll=!0,n.focusModule.onClick({target:i},!0),n.selectRow(this.rowIndex))}else this.lastFocusInfo&&(this.pressedKey===dtt||this.pressedKey===ktt)&&(r=t?0:this.lastFocusInfo.rowIdx,n.getRowByIndex(r)&&(i=n.getCellFromIndex(r,this.lastFocusInfo.cellIdx))&&(this.isFocusScroll=!0,t?i.focus({preventScroll:!0}):(n.focusModule.isInfiniteScroll=!0,n.focusModule.onClick({target:i},!0))));this.pressedKey=void 0},n.prototype.removeInfiniteCacheRows=function(n){var u=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.args.requestType,t,i,r;!n.args.isFrozen&&u&&this.parent.infiniteScrollSettings.enableCache&&this.isRemove&&(t=[].slice.call(this.parent.getContentTable().getElementsByClassName(y)),"down"===n.args.direction&&(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&(i=[].slice.call(this.parent.getContentTable().querySelectorAll("tr")),this.removeCaptionRows(i,n.args)),r=this.parent.element.querySelector("."+ui)?0:1,this.removeTopRows(t,this.parent.pageSettings.pageSize-r)),"up"===n.args.direction&&(this.parent.allowGrouping&&this.parent.groupSettings.columns.length?(i=[].slice.call(this.parent.getContentTable().querySelectorAll("tr")),this.removeCaptionRows(i,n.args)):this.removeBottomRows(t,t.length-1,n.args)),this.isScroll=!1,this.top=this.calculateScrollTop(n.args))},n.prototype.calculateScrollTop=function(n){var i=0,h=this.parent.getContent().firstElementChild,u,f,e,o;if("down"===n.direction){this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse&&(i=this.captionRowHeight());u=[].slice.call(this.parent.getContent().firstElementChild.querySelectorAll("tr:not(.e-row)"));f=0;this.isInitialCollapse&&!t.isNullOrUndefined(u)&&(f=Math.round((u.length-1)/this.parent.groupSettings.columns.length));for(var c=f||this.parent.pageSettings.pageSize*(this.parent.infiniteScrollSettings.maxBlocks-1),s=0,r=0;s<h.clientHeight;)s=++r*this.parent.getRowHeight();i+=(c-(r-=1))*this.parent.getRowHeight()}if("up"===n.direction)if(this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!this.isInitialCollapse)i=this.refreshInfiniteCacheRowVisibleLength(this.infiniteCache,this.parent.pageSettings.currentPage)*this.parent.getRowHeight();else if(this.isInitialCollapse){for(e=this.infiniteCache[this.parent.pageSettings.currentPage],o=0,r=0;r<e.length;r++)e[parseInt(r.toString(),10)].isCaptionRow&&o++;i+=Math.round(o/this.parent.groupSettings.columns.length)*this.parent.getRowHeight()}else i+=this.parent.pageSettings.pageSize*this.parent.getRowHeight()+hu();return i},n.prototype.captionRowHeight=function(){return[].slice.call(this.parent.getContent().querySelectorAll("tr:not(.e-row)")).length*this.parent.getRowHeight()},n.prototype.removeTopRows=function(n,i){for(var e=this.parent.isFrozenGrid(),u=this.parent.getFrozenMode()===s?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(y)):null,f=e?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(y)):null,r=0;r<=i;r++)this.parent.frozenRows&&this.parent.pageSettings.currentPage===this.parent.infiniteScrollSettings.maxBlocks+1&&r>i-this.parent.frozenRows||(t.remove(n[parseInt(r.toString(),10)]),f&&t.remove(f[parseInt(r.toString(),10)]),u&&t.remove(u[parseInt(r.toString(),10)]))},n.prototype.removeBottomRows=function(n,i,r){var f=0,e=this.parent.isFrozenGrid(),h=e?[].slice.call(this.parent.getMovableVirtualContent().getElementsByClassName(y)):null,c=this.parent.getFrozenMode()===s?[].slice.call(this.parent.element.querySelector(".e-frozen-right-content").getElementsByClassName(y)):null,o=this.parent.pageSettings.pageSize,u;for(!e&&this.infiniteCache[r.prevPage].length<o&&(f=this.parent.pageSettings.pageSize-this.infiniteCache[r.prevPage].length),e&&this.infiniteFrozenCache[r.prevPage][1].length<o&&(f=this.parent.pageSettings.pageSize-this.infiniteFrozenCache[r.prevPage][1].length),u=i;f<o;u--)f++,t.remove(n[parseInt(u.toString(),10)]),h&&t.remove(h[parseInt(u.toString(),10)]),c&&t.remove(c[parseInt(u.toString(),10)])},n.prototype.removeCaptionRows=function(n,i){var u=[].slice.call(this.parent.getContent().getElementsByClassName(y));if("down"===i.direction)for(var o=hr(u[this.parent.pageSettings.pageSize-1])-1,f=0,r=0;f<o;r++)n[parseInt(r.toString(),10)].classList.contains(y)?f=hr(n[parseInt(r.toString(),10)]):t.remove(n[parseInt(r.toString(),10)]);if("up"===i.direction){var s=hr(u[u.length-1]),h=Math.ceil(s/this.parent.pageSettings.pageSize),e=0;for(r=this.parent.pageSettings.currentPage+1;r<h;r++)e+=this.infiniteCache[parseInt(r.toString(),10)].length;for(r=e;r<n.length;r++)t.remove(n[parseInt(r.toString(),10)])}},n.prototype.resetInfiniteBlocks=function(n,i){var u=this.parent.enableInfiniteScrolling&&"infiniteScroll"!==n.requestType,r;!this.initialRender&&!t.isNullOrUndefined(this.parent.infiniteScrollModule)&&u&&(this.actions.some(function(t){return t===n.requestType})||i||"save"===n.requestType&&(this.parent.sortSettings.columns.length||this.parent.filterSettings.columns.length||this.parent.groupSettings.columns.length||this.parent.searchSettings.key))&&(r=this.parent.getContent().firstElementChild,this.initialRender=!0,r.scrollTop=0,this.parent.pageSettings.currentPage=1,this.infiniteCache=this.infiniteFrozenCache={},this.infiniteCurrentViewData={},this.resetContentModuleCache({}),this.isRemove=!1,this.top=0,this.isInitialMovableRender=!0,this.isInitialCollapse=!1,this.parent.contentModule.isRemove=this.isRemove,this.parent.contentModule.isAddRows=this.isRemove,this.parent.contentModule.visibleRows=[],this.parent.contentModule.visibleFrozenRows=[])},n.prototype.setCache=function(n){if(this.parent.enableInfiniteScrolling&&this.parent.infiniteScrollSettings.enableCache){var r=this.parent.isFrozenGrid(),u=n.args.isFrozen?1:0,f="infiniteScroll"!==n.args.requestType&&("delete"===this.requestType||"add"===this.requestType),i=this.parent.pageSettings.currentPage;(r&&this.isInitialMovableRender||!r&&!Object.keys(this.infiniteCache).length||f)&&(this.isInitialMovableRender=!n.args.isFrozen,this.setInitialCache(n.modelData,n.args,f));!r&&t.isNullOrUndefined(this.infiniteCache[this.parent.pageSettings.currentPage])&&(this.infiniteCache[this.parent.pageSettings.currentPage]=n.modelData,this.resetContentModuleCache(this.infiniteCache));r&&(0===u&&t.isNullOrUndefined(this.infiniteFrozenCache[parseInt(i.toString(),10)])||!this.infiniteFrozenCache[parseInt(i.toString(),10)][parseInt(u.toString(),10)].length)&&(this.createFrozenCache(i),this.infiniteFrozenCache[parseInt(i.toString(),10)][parseInt(u.toString(),10)]=n.modelData,1===u&&this.resetContentModuleCache(this.infiniteFrozenCache));n.isInfiniteScroll&&!this.isRemove&&(this.isRemove=(i-1)%this.parent.infiniteScrollSettings.maxBlocks==0,this.parent.contentModule.isRemove=this.isRemove)}},n.prototype.setInitialCache=function(n,i,r,u){for(var e,o,h=this.parent.isFrozenGrid(),c=i.isFrozen?1:0,f=r?t.isNullOrUndefined(this.firstBlock)?1:this.firstBlock:1,s=1;s<=this.parent.infiniteScrollSettings.initialBlocks;s++)e=(s-1)*this.parent.pageSettings.pageSize,o=s*this.parent.pageSettings.pageSize,this.parent.allowGrouping&&this.parent.groupSettings.columns.length&&!u?this.setInitialGroupCache(n,f,e,o):u?this.infiniteCurrentViewData[parseInt(f.toString(),10)]=n.slice(e,o):h?(this.createFrozenCache(f),this.infiniteFrozenCache[parseInt(f.toString(),10)][parseInt(c.toString(),10)]=n.slice(e,o),this.resetContentModuleCache(this.infiniteFrozenCache)):(this.infiniteCache[parseInt(f.toString(),10)]=n.slice(e,o),this.resetContentModuleCache(this.infiniteCache)),f++},n.prototype.createFrozenCache=function(n){this.infiniteFrozenCache[parseInt(n.toString(),10)]||(this.infiniteFrozenCache[parseInt(n.toString(),10)]=[[],[]])},n.prototype.setInitialGroupCache=function(n,t,i,r){for(var f,e=[],o=0,u=1;u<=Object.keys(this.infiniteCache).length;u++)o+=this.infiniteCache[parseInt(u.toString(),10)].length;for(f=i,u=o;u<n.length&&f<r&&((n[parseInt(u.toString(),10)].index<r||n[parseInt(u.toString(),10)].isCaptionRow)&&(f=n[parseInt(u.toString(),10)].isCaptionRow?f:n[parseInt(u.toString(),10)].index,e.push(n[parseInt(u.toString(),10)])),!(n[parseInt(u.toString(),10)].index>=r||n[parseInt(u.toString(),10)].index===r-1));u++);this.infiniteCache[parseInt(t.toString(),10)]=e;this.resetContentModuleCache(this.infiniteCache)},n.prototype.resetContentModuleCache=function(n){this.parent.contentModule.infiniteCache=n},n.prototype.destroy=function(){this.removeEventListener()},n}(),nlt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rd=function(n){function r(t,i){var r=n.call(this,t,i)||this;return r.childCount=0,r.scrollData=[],r.isFirstChildRow=!1,r.isScrollDown=!1,r.isScrollUp=!1,r.groupCache={},r.cacheRowsObj={},r.startIndexes={},r.captionCounts={},r.rowsByUid={},r.objIdxByUid={},r.initialGroupCaptions={},r.requestType=["paging","columnstate","reorder","cancel","save","beginEdit","add","delete","filterbeforeopen","filterchoicerequest","infiniteScroll","virtualscroll"],r.scrollTopCache=void 0,r.refRowsObj={},r.cacheMode=!1,r.cacheBlockSize=5,r.ignoreAccent=!!r.parent.allowFiltering&&r.parent.filterSettings.ignoreAccent,r.allowCaseSensitive=!1,r.lazyLoadQuery=[],r.locator=i,r.groupGenerator=new eh(r.parent),r.summaryModelGen=new uo(r.parent),r.captionModelGen=new fh(r.parent),r.rowRenderer=new oi(r.locator,null,r.parent),r.eventListener(),r}return nlt(r,n),r.prototype.eventListener=function(){this.parent.addEventListener(nt,this.actionBegin.bind(this));this.parent.addEventListener(l,this.actionComplete.bind(this));this.parent.on(dt,this.setLazyLoadPageSize,this);this.parent.on(iw,this.setCache,this);this.parent.on(rw,this.scrollHandler,this);this.parent.on(di,this.setVisible,this);this.parent.on(gl,this.collapseShortcut,this)},r.prototype.captionExpand=function(n){var i=this,e=this.parent.pageSettings.currentPage,r=this.groupCache[parseInt(e.toString(),10)],o=n.getAttribute("data-uid"),t,u;this.refreshCaches();(!this.scrollTopCache||this.parent.scrollModule.content.scrollTop>this.scrollTopCache)&&!this.parent.enableVirtualization&&(this.scrollTopCache=this.parent.scrollModule.content.scrollTop);t=this.getRowObjectIndexByUid(o);u=!!r[t+1]&&r[parseInt(t.toString(),10)].indent<r[t+1].indent;this.parent.enableVirtualization&&(u=!!this.cacheRowsObj[""+o]);var f=r[parseInt(t.toString(),10)],s=po(t,r),h={captionRowElement:n,groupInfo:f,enableCaching:!0,cancel:!1};this.parent.trigger(cg,h,function(t){t.cancel||(t.keys=s.keys,t.fields=s.fields,t.rowIndex=n.rowIndex,t.makeRequest=!t.enableCaching||!u,!t.enableCaching&&u&&i.clearCache([o]),t.skip=0,t.take=i.pageSize,f.isExpand=!0,i.rowsByUid[parseInt(e.toString(),10)][f.uid]&&(i.rowsByUid[parseInt(e.toString(),10)][f.uid].isExpand=!0),i.captionRowExpand(t))})},r.prototype.captionCollapse=function(n){var i=this,e=this.groupCache[this.parent.pageSettings.currentPage],o=n.rowIndex,u=n.getAttribute("data-uid"),r,f;this.refreshCaches();r=this.getRowObjectIndexByUid(u);f={captionRowElement:n,groupInfo:e[parseInt(r.toString(),10)],cancel:!1};this.parent.trigger(lg,f,function(n){var f,e;if(!n.cancel){for(n.isExpand=!1,f=0;f<i.lazyLoadQuery.length;f++)e=i.lazyLoadQuery[parseInt(f.toString(),10)][0],n.groupInfo.data.key===e.value&&i.lazyLoadQuery.splice(f,1);i.removeRows(r,o,u);(i.parent.enableInfiniteScrolling||i.parent.enableVirtualization)&&(i.groupCache[i.parent.pageSettings.currentPage]=t.extend([],i.refRowsObj[i.parent.pageSettings.currentPage]),i.refreshRowObjects([],r))}})},r.prototype.setLazyLoadPageSize=function(){var n=this.parent.getContent().firstElementChild,t=Math.floor(n.offsetHeight/this.parent.getRowHeight())-1;this.pageSize=this.pageSize?this.pageSize:3*t;this.blockSize=Math.ceil(this.pageSize/2)},r.prototype.clearLazyGroupCache=function(){this.clearCache()},r.prototype.clearCache=function(n){var t,e,o,r,u,s,i,f,h,c;if(n=n||this.getInitialCaptionIndexes(),t=this.groupCache[this.parent.pageSettings.currentPage],n.length)for(e=0;e<n.length;e++)if(o=this.getRowObjectIndexByUid(n[parseInt(e.toString(),10)]),r=t[parseInt(o.toString(),10)],r){if(this.captionCounts[this.parent.pageSettings.currentPage][r.uid])for(u=o+1;u<t.length;u++){if(t[parseInt(u.toString(),10)].indent===r.indent||t[parseInt(u.toString(),10)].indent<r.indent){delete this.captionCounts[this.parent.pageSettings.currentPage][r.uid];break}t[parseInt(u.toString(),10)].isCaptionRow&&delete this.captionCounts[this.parent.pageSettings.currentPage][t[parseInt(u.toString(),10)].uid]}if(r.isExpand){if(s=this.parent.getRowElementByUID(r.uid),!s)return;this.parent.groupModule.expandCollapseRows(s.querySelector(".e-recordplusexpand"))}i=this.getNextChilds(o);i.length&&(f=[],i[i.length-1].isCaptionRow&&(f=this.getChildRowsByParentIndex(t.indexOf(i[i.length-1]),!1,!1,null,!0,!0)),h=t.indexOf(i[0]),c=f.length?t.indexOf(f[f.length-1]):t.indexOf(i[i.length-1]),t.splice(h,c-(h-1)),this.refreshCaches())}},r.prototype.refreshCaches=function(){var t=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(t.toString(),10)],n;for(this.parent.enableInfiniteScrolling?(this.rowsByUid[parseInt(t.toString(),10)]=[],this.objIdxByUid[parseInt(t.toString(),10)]=[]):(this.rowsByUid={},this.objIdxByUid={}),n=0;n<i.length;n++)this.maintainRows(i[parseInt(n.toString(),10)],n)},r.prototype.getInitialCaptionIndexes=function(){for(var t=this.parent.pageSettings.currentPage,i=[],n=0;n<this.initialGroupCaptions[parseInt(t.toString(),10)].length;n++)i.push(this.initialGroupCaptions[parseInt(t.toString(),10)][parseInt(n.toString(),10)].uid);return i},r.prototype.getRowObjectIndexByUid=function(n){return this.objIdxByUid[this.parent.pageSettings.currentPage][""+n]},r.prototype.collapseShortcut=function(n){var r,u,f,t;if(this.parent.groupSettings.columns.length&&n.target&&i(n.target,ft)&&"TR"===n.target.parentElement.tagName){if(!n.collapse&&i(n.target,y))return;r=n.target.parentElement.getAttribute("data-uid");n.collapse?(u=this.getRowByUid(r),(t=this.getRowByUid(u.parentUid)).isCaptionRow&&t.isExpand&&(f=this.getRowElementByUid(u.parentUid),this.parent.groupModule.expandCollapseRows(f.cells[u.indent-1]))):(t=this.getRowByUid(r)).isCaptionRow&&!t.isExpand&&(f=this.getRowElementByUid(r),this.parent.groupModule.expandCollapseRows(f.cells[t.indent]))}},r.prototype.getRowByUid=function(n){return this.rowsByUid[this.parent.pageSettings.currentPage][""+n]},r.prototype.actionBegin=function(n){var u,r,i,t,f,e;if(!n.cancel){if(this.requestType.some(function(t){return t===n.requestType})||(this.groupCache={},this.resetRowMaintenance(),this.parent.enableVirtualization&&(this.parent.contentModule.currentInfo={})),"reorder"===n.requestType&&this.parent.groupSettings.columns.length)for(u=Object.keys(this.groupCache),r=0;r<u.length;r++)for(i=this.groupCache[u[parseInt(r.toString(),10)]],t=0;t<i.length;t++)(i[parseInt(t.toString(),10)].isCaptionRow&&!this.captionModelGen.isEmpty()&&this.changeCaptionRow(i[parseInt(t.toString(),10)],null,u[parseInt(r.toString(),10)]),i[parseInt(t.toString(),10)].isDataRow)&&(f=n.fromIndex+i[parseInt(t.toString(),10)].indent,e=n.toIndex+i[parseInt(t.toString(),10)].indent,this.moveCells(i[parseInt(t.toString(),10)].cells,f,e));("delete"===n.requestType||"add"===n.action&&"save"===n.requestType)&&(this.groupCache={},this.resetRowMaintenance(),this.parent.enableVirtualization&&(this.parent.contentModule.currentInfo={}))}},r.prototype.actionComplete=function(n){n.cancel||"columnstate"===n.requestType||"beginEdit"===n.requestType||"delete"===n.requestType||"save"===n.requestType||"reorder"===n.requestType||this.scrollReset()},r.prototype.resetRowMaintenance=function(){this.startIndexes={};this.captionCounts={};this.rowsByUid={};this.objIdxByUid={};this.initialGroupCaptions={}},r.prototype.moveCells=function(n,t,i){if(t>=n.length)for(var r=t-n.length;1+r--;)n.push(void 0);n.splice(t,0,n.splice(i,1)[0])},r.prototype.removeRows=function(n,i,r){var l,e=this.parent.pageSettings.currentPage,f=this.groupCache[parseInt(e.toString(),10)],o=[].slice.call(this.parent.getContent().querySelectorAll("tr")),s=0,h,a,c,u;for(this.parent.aggregates.length&&(h=this.getAggregateByCaptionIndex(n),l=h.length?h[h.length-1].uid:void 0),c=f[parseInt(n.toString(),10)].indent,this.addClass(this.getNextChilds(parseInt(n.toString(),10))),f[parseInt(n.toString(),10)].isExpand=!1,this.rowsByUid[parseInt(e.toString(),10)][f[parseInt(n.toString(),10)].uid]&&(this.rowsByUid[parseInt(e.toString(),10)][f[parseInt(n.toString(),10)].uid].isExpand=!1),u=n+1;u<f.length;u++){if(f[parseInt(u.toString(),10)].indent===c||f[parseInt(u.toString(),10)].indent<c){a=f[parseInt(u.toString(),10)].uid;break}f[parseInt(u.toString(),10)].isCaptionRow&&f[parseInt(u.toString(),10)].isExpand&&this.addClass(this.getNextChilds(u))}for(u=i+1;u<o.length&&o[parseInt(u.toString(),10)].getAttribute("data-uid")!==a;u++){if(o[parseInt(u.toString(),10)].getAttribute("data-uid")===l){t.remove(o[parseInt(u.toString(),10)]);break}t.remove(o[parseInt(u.toString(),10)]);this.refRowsObj[parseInt(e.toString(),10)].splice(i+1,1);s+=1}this.parent.enableVirtualization&&(this.cacheRowsObj[""+r]=this.groupCache[parseInt(e.toString(),10)].slice(n+1,n+1+s),this.groupCache[parseInt(e.toString(),10)].splice(n+1,s),this.parent.notify(pa,{rows:[],uid:f[parseInt(n.toString(),10)].uid,count:s}),this.parent.contentModule.setVirtualHeight(),this.parent.islazyloadRequest=!1);this.parent.scrollModule.content.scrollTop>this.scrollTopCache&&!this.parent.enableVirtualization&&(this.parent.scrollModule.content.scrollTop=this.scrollTopCache);this.parent.notify(wr,{rows:this.refRowsObj[parseInt(e.toString(),10)]})},r.prototype.addClass=function(n){var t=n[this.blockSize];t&&(t.lazyLoadCssClass="e-lazyload-middle-down")},r.prototype.getNextChilds=function(n,t){for(var u=this.groupCache[this.parent.pageSettings.currentPage],r=t||u,f=u[parseInt(n.toString(),10)].indent+1,e=[],i=t?0:n+1;i<r.length&&!(r[parseInt(i.toString(),10)].indent<f);i++)r[parseInt(i.toString(),10)].indent===f&&e.push(r[parseInt(i.toString(),10)]);return e},r.prototype.lazyLoadHandler=function(n){var i,o,h,c;this.setStartIndexes();var e=this.parent.getContent().querySelectorAll("tr")[n.index].getAttribute("data-uid"),r=this.getRowObjectIndexByUid(e),u=this.groupCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)],t=n.isRowExist?n.isScroll?this.scrollData:this.parent.enableVirtualization?this.cacheRowsObj[""+e]:this.getChildRowsByParentIndex(r,!0,!0,null,!0):[];if(this.scrollData=[],!n.isRowExist)if(this.setRowIndexes(r,u),this.refreshCaptionRowCount(this.groupCache[this.parent.pageSettings.currentPage][parseInt(r.toString(),10)],n.count),-1!==Object.keys(n.data).indexOf("GroupGuid"))for(i=0;i<n.data.length;i++)o=this.groupGenerator.generateCaptionRow(n.data[parseInt(i.toString(),10)],n.level,u.parentGid,void 0,0,u.uid),t.push(o),this.parent.aggregates.length&&(t=t.concat(this.summaryModelGen.generateRows(n.data[parseInt(i.toString(),10)],{level:n.level+1,parentUid:o.uid})));else this.groupGenerator.index=this.getStartIndex(r,n.isScroll),t=this.groupGenerator.generateDataRows(n.data,n.level,u.parentGid,0,u.uid);var l=n.isScroll?this.rowIndex:n.index,f=this.getNextChilds(r,t),s=!!n.up||this.hasLastChildRow(n.isScroll,n.count,f.length);for(n.isRowExist||s||(f[this.blockSize].lazyLoadCssClass="e-lazyload-middle-down"),s||(f[f.length-1].lazyLoadCssClass="e-not-lazyload-end"),h=n.isScroll||n.isRowExist?[]:this.getAggregateByCaptionIndex(r),(n.up||(!n.isRowExist||this.parent.enableVirtualization&&n.isRowExist&&this.cacheRowsObj[""+e])&&this.refreshRowObjects(t,n.isScroll?this.rowObjectIndex:r),this.parent.enableVirtualization)&&(c=n.isScroll?this.groupCache[this.parent.pageSettings.currentPage][this.rowIndex].uid:u.uid,this.parent.notify(pa,{rows:t,uid:c}),this.parent.contentModule.setVirtualHeight(),this.parent.contentModule.isTop=!1),this.render(l,t,s,h),this.isFirstChildRow&&!n.up&&(this.parent.getContent().firstElementChild.scrollTop=t.length*this.parent.getRowHeight()),this.isFirstChildRow=!1,this.rowIndex=void 0,this.rowObjectIndex=void 0,this.childCount=0,i=0;i<t.length;i++)this.refRowsObj[this.parent.pageSettings.currentPage].splice(r+i+1,0,t[parseInt(i.toString(),10)]);this.parent.notify(wr,{rows:this.refRowsObj[this.parent.pageSettings.currentPage]});this.parent.enableVirtualMaskRow&&this.parent.removeMaskRow()},r.prototype.setRowIndexes=function(n,t){this.captionCounts[this.parent.pageSettings.currentPage]||(this.captionCounts[this.parent.pageSettings.currentPage]={});t.isCaptionRow&&(this.captionCounts[this.parent.pageSettings.currentPage][t.uid]=t.data.count)},r.prototype.getStartIndex=function(n,t){var u=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(u.toString(),10)],r;if(t)return i[this.rowObjectIndex].index+1;var f=0,e=0,o=this.getRowByUid(i[parseInt(n.toString(),10)].parentUid);if(o&&(e=this.prevCaptionCount(o)),i[parseInt(n.toString(),10)].indent>0)for(r=n-1;r>=0&&!(i[parseInt(r.toString(),10)].indent<i[parseInt(n.toString(),10)].indent);r--)i[parseInt(r.toString(),10)].isCaptionRow&&i[parseInt(r.toString(),10)].indent===i[parseInt(n.toString(),10)].indent&&(f+=i[parseInt(r.toString(),10)].data.count);return f+e+this.startIndexes[parseInt(u.toString(),10)][i[parseInt(n.toString(),10)].parentGid]},r.prototype.prevCaptionCount=function(n){for(var u,f=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(f.toString(),10)],r=0,t=i.indexOf(n)-1;t>=0&&0!==i[parseInt(t.toString(),10)].indent&&!(i[parseInt(t.toString(),10)].indent<n.indent);t--)i[parseInt(t.toString(),10)].isCaptionRow&&i[parseInt(t.toString(),10)].indent===n.indent&&(r+=this.captionCounts[parseInt(f.toString(),10)][i[parseInt(t.toString(),10)].uid]||i[parseInt(t.toString(),10)].data.count);return u=this.getRowByUid(n.parentUid),u&&(r+=this.prevCaptionCount(u)),r},r.prototype.setStartIndexes=function(){var i=this.groupCache[this.parent.pageSettings.currentPage];if(!this.startIndexes[this.parent.pageSettings.currentPage]){for(var n=[],r=void 0,t=0;t<i.length;t++)i[parseInt(t.toString(),10)].isCaptionRow&&(n.length?n.push(i[parseInt(r.toString(),10)].data.count+n[n.length-1]):n.push(0),r=t);this.startIndexes[this.parent.pageSettings.currentPage]=n}},r.prototype.hasLastChildRow=function(n,t,i){return n?t===this.childCount+i:t===i},r.prototype.refreshCaptionRowCount=function(n,t){n.data.count=t},r.prototype.render=function(n,t,i,r){var f=this.parent.getContent().querySelectorAll("tr")[parseInt(n.toString(),10)],e=this.parent.getContent().firstElementChild,o=this.parent.getRowHeight(),u;if(f&&r.length)for(u=r.length-1;u>=0;u--)f.insertAdjacentElement("afterend",this.rowRenderer.render(r[parseInt(u.toString(),10)],this.parent.getColumns()));if(f&&t.length)for(u=t.length-1;u>=0;u--)this.confirmRowRendering(t[parseInt(u.toString(),10)])&&(f.insertAdjacentElement("afterend",this.rowRenderer.render(t[parseInt(u.toString(),10)],this.parent.getColumns())),this.isScrollDown&&(e.scrollTop=e.scrollTop-o),this.isScrollUp&&(e.scrollTop=e.scrollTop+o));this.isScrollDown=!1;this.isScrollUp=!1},r.prototype.maintainRows=function(n,t){var i=this.parent.pageSettings.currentPage;this.rowsByUid[parseInt(i.toString(),10)]||(this.rowsByUid[parseInt(i.toString(),10)]={},this.objIdxByUid[parseInt(i.toString(),10)]={});n.uid&&(this.rowsByUid[parseInt(i.toString(),10)][n.uid]=n);this.objIdxByUid[parseInt(i.toString(),10)][n.uid]=t},r.prototype.confirmRowRendering=function(n){var r=!0,i;return!t.isNullOrUndefined(n.indent)||n.isDataRow||n.isCaptionRow||(i=this.getRowByUid(n.parentUid),i.isCaptionRow&&!i.isExpand&&(r=!1)),r},r.prototype.refreshRowObjects=function(n,i){var s=this.parent.pageSettings.currentPage,f=this.groupCache[parseInt(s.toString(),10)],e;this.rowsByUid[parseInt(s.toString(),10)]={};this.objIdxByUid[parseInt(s.toString(),10)]={};for(var o=[],u=0,r=0;r<f.length;r++)if(r===i)for(this.maintainRows(f[parseInt(r.toString(),10)],u),o.push(f[parseInt(r.toString(),10)]),u++,e=0;e<n.length;e++)this.maintainRows(n[parseInt(e.toString(),10)],u),o.push(n[parseInt(e.toString(),10)]),u++;else this.maintainRows(f[parseInt(r.toString(),10)],u),o.push(f[parseInt(r.toString(),10)]),u++;this.groupCache[this.parent.pageSettings.currentPage]=t.extend([],o);this.updateCurrentViewData()},r.prototype.getAggregateByCaptionIndex=function(n){for(var i=this.groupCache[this.parent.pageSettings.currentPage],u=i[parseInt(n.toString(),10)],e=u.indent,o=u.uid,f=[],r=n+1;r<i.length&&i[parseInt(r.toString(),10)].indent!==e;r++)t.isNullOrUndefined(i[parseInt(r.toString(),10)].indent)&&i[parseInt(r.toString(),10)].parentUid===o&&f.push(i[parseInt(r.toString(),10)]);return f},r.prototype.getChildRowsByParentIndex=function(n,i,r,u,f,e){var s=u||this.groupCache[this.parent.pageSettings.currentPage],h=s[parseInt(n.toString(),10)],l=[];if(!h.isCaptionRow||h.isCaptionRow&&!h.isExpand&&!e)return[];f&&this.parent.aggregates.length&&(l=this.getAggregateByCaptionIndex(n));for(var v=h.indent,y=h.uid,c=[],a=0,o=n+1;o<s.length;o++){if(s[parseInt(o.toString(),10)].parentUid===y){if(t.isNullOrUndefined(s[parseInt(o.toString(),10)].indent))continue;if(a++,c.push(s[parseInt(o.toString(),10)]),i&&s[parseInt(o.toString(),10)].isCaptionRow&&(c=c.concat(this.getChildRowsByParentIndex(o,i,r,u,f))),r&&a===this.pageSize)break}if(s[parseInt(o.toString(),10)].indent===v)break}return c.concat(l)},r.prototype.initialGroupRows=function(n){var i=[],r=this.groupCache[this.parent.pageSettings.currentPage],t;if(n)return this.getRenderedRowsObject();for(t=0;t<r.length;t++)0===r[parseInt(t.toString(),10)].indent&&(i.push(r[parseInt(t.toString(),10)]),i=i.concat(this.getChildRowsByParentIndex(t,!0,!0,r,!0)));return i},r.prototype.getRenderedRowsObject=function(){for(var t=[],i=[].slice.call(this.parent.getContent().querySelectorAll("tr")),n=0;n<i.length;n++)t.push(this.getRowByUid(i[parseInt(n.toString(),10)].getAttribute("data-uid")));return t},r.prototype.getCacheRowsOnDownScroll=function(n){for(var u=[],i=this.groupCache[this.parent.pageSettings.currentPage],r=n,f=0;f<this.pageSize&&i[parseInt(r.toString(),10)]&&!(i[parseInt(r.toString(),10)].indent<i[parseInt(n.toString(),10)].indent);f++)i[parseInt(r.toString(),10)].indent===i[parseInt(n.toString(),10)].indent&&(u.push(i[parseInt(r.toString(),10)]),i[parseInt(r.toString(),10)].isCaptionRow&&i[parseInt(r.toString(),10)].isExpand&&(u=u.concat(this.getChildRowsByParentIndex(r,!0,!0,null,!0)))),(i[parseInt(r.toString(),10)].indent>i[parseInt(n.toString(),10)].indent||t.isNullOrUndefined(i[parseInt(r.toString(),10)].indent))&&f--,r++;return u},r.prototype.getCacheRowsOnUpScroll=function(n,t,i){for(var f=[],r=this.groupCache[this.parent.pageSettings.currentPage],e=!1,u=0;u<r.length&&(!e||r[parseInt(u.toString(),10)]&&!(r[parseInt(u.toString(),10)].indent<r[parseInt(i.toString(),10)].indent)&&r[parseInt(u.toString(),10)].uid!==t);u++)e||r[parseInt(u.toString(),10)].uid!==n||(e=!0),e&&r[parseInt(u.toString(),10)].indent===r[parseInt(i.toString(),10)].indent&&(f.push(r[parseInt(u.toString(),10)]),r[parseInt(u.toString(),10)].isCaptionRow&&r[parseInt(u.toString(),10)].isExpand&&(f=f.concat(this.getChildRowsByParentIndex(u,!0,!0,null,!0))));return f},r.prototype.scrollHandler=function(n){var i,o,l;if(!this.parent.isDestroyed&&!this.childCount){var t,r,s=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-down")),h=[].slice.call(this.parent.getContent().getElementsByClassName("e-lazyload-middle-up")),u=[].slice.call(this.parent.getContent().getElementsByClassName("e-not-lazyload-end")),e=!1,c=!1,f=!1;if(n.scrollDown&&s.length&&(t=(r=this.findRowElements(s)).tr,e=r.entered),!n.scrollDown&&u)for(i=0;i<u.length;i++)if(o=u[parseInt(i.toString(),10)].getBoundingClientRect().top,l=this.parent.getContent().scrollHeight,o>0&&o<l){t=u[parseInt(i.toString(),10)];f=!0;this.rowIndex=t.rowIndex;break}n.scrollDown||!h.length||f||(t=(r=this.findRowElements(h)).tr,c=r.entered);t&&!t.classList.contains("e-masked-row")&&(e&&n.scrollDown&&e&&t&&this.scrollDownHandler(t),!n.scrollDown&&f&&t&&this.scrollUpEndRowHandler(t),this.cacheMode&&!n.scrollDown&&!f&&c&&t&&this.scrollUpHandler(t))}},r.prototype.scrollUpEndRowHandler=function(n){var v=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(v.toString(),10)],l=n.getAttribute("data-uid"),t=this.rowObjectIndex=this.getRowObjectIndexByUid(l),y=t,r=i[parseInt(t.toString(),10)],u=this.getRowByUid(r.parentUid),e=this.getRowObjectIndexByUid(u.uid),p=this.parent.getContent().querySelector("tr[data-uid="+u.uid+"]").rowIndex,w=this.getChildRowsByParentIndex(e).indexOf(r),a=Math.ceil(w/this.pageSize),f,o,s,h,c;1!==a&&((this.childCount=a*this.pageSize,t=this.getCurrentBlockEndIndex(r,t),this.childCount<u.data.count)?(n.classList.remove("e-not-lazyload-end"),r.lazyLoadCssClass="",f=!!i[t+1]&&r.indent===i[t+1].indent,this.scrollData=f?this.getCacheRowsOnDownScroll(t+1):[],o=po(e,i),s={rowIndex:p,makeRequest:!f,groupInfo:u,fields:o.fields,keys:o.keys,skip:this.childCount,take:this.pageSize,isScroll:!0},this.cacheMode&&this.childCount>=this.pageSize*this.cacheBlockSize&&(h=this.getChildRowsByParentIndex(e),c=Math.ceil(h.indexOf(i[parseInt(y.toString(),10)])/this.pageSize)-(this.cacheBlockSize-1),this.removeBlock(l,f,c,h),s.cachedRowIndex=c*this.pageSize),this.captionRowExpand(s)):this.childCount=0)},r.prototype.scrollDownHandler=function(n){var k=this.parent.pageSettings.currentPage,r=this.groupCache[parseInt(k.toString(),10)],w=n.getAttribute("data-uid"),i=this.getRowObjectIndexByUid(w),d=i,s=r[parseInt(i.toString(),10)],u=this.getRowByUid(s.parentUid),h=this.getRowObjectIndexByUid(u.uid),g=this.getRowElementByUid(u.uid).rowIndex,o=this.getChildRowsByParentIndex(h),b,c,f,l,e,a,v,y,p;if(0!==o.length&&(b=o.indexOf(s),c=Math.ceil(b/this.pageSize),this.childCount=c*this.pageSize,!t.isNullOrUndefined(o[this.childCount-1])))if(this.parent.enableVirtualization&&(this.parent.islazyloadRequest=!0),i=this.rowObjectIndex=this.getRowObjectIndexByUid(o[this.childCount-1].uid),f=r[parseInt(i.toString(),10)],l=this.getRowElementByUid(f.uid),this.rowIndex=l.rowIndex,i=this.getCurrentBlockEndIndex(f,i),this.childCount===u.data.count&&(this.parent.islazyloadRequest=!1),this.childCount<u.data.count){if(e=!!r[i+1]&&s.indent===r[i+1].indent,e&&!t.isNullOrUndefined(this.getRowElementByUid(r[i+1].uid)))return this.parent.islazyloadRequest=!1,void(this.childCount=0);(c>1||!this.cacheMode)&&(n.classList.remove("e-lazyload-middle-down"),l.classList.remove("e-not-lazyload-end"),f.lazyLoadCssClass="");this.scrollData=e?this.getCacheRowsOnDownScroll(this.rowObjectIndex+1):[];a=po(h,r);v={rowIndex:g,makeRequest:!e,groupInfo:u,fields:a.fields,keys:a.keys,skip:this.childCount,take:this.pageSize,isScroll:!0};this.cacheMode&&this.childCount-this.pageSize>=this.pageSize*this.cacheBlockSize&&(this.isScrollDown=!0,y=this.getChildRowsByParentIndex(h),p=Math.ceil(y.indexOf(r[parseInt(d.toString(),10)])/this.pageSize)-1-(this.cacheBlockSize-1)+1,this.removeBlock(w,e,p,y,f),v.cachedRowIndex=p*this.pageSize);this.captionRowExpand(v)}else this.childCount=0,this.parent.islazyloadRequest=!1},r.prototype.getCurrentBlockEndIndex=function(n,t){var o=this.parent.pageSettings.currentPage,i=this.groupCache[parseInt(o.toString(),10)],f,e,u,r;if(n.isCaptionRow)for(n.isExpand&&(f=this.getChildRowsByParentIndex(t,!0).length,this.rowIndex=this.rowIndex+f),e=this.getAggregateByCaptionIndex(t),this.rowObjectIndex=this.rowObjectIndex+e.length,u=t,r=u+1;r<i.length;r++){if(i[parseInt(r.toString(),10)].indent===i[parseInt(t.toString(),10)].indent||i[parseInt(r.toString(),10)].indent<i[parseInt(t.toString(),10)].indent){t=u;break}u++}return t},r.prototype.removeBlock=function(n,t,i,r,u){var s=this.parent.pageSettings.currentPage,h=this.groupCache[parseInt(s.toString(),10)],o=r[(i+1)*this.pageSize-1-this.blockSize].uid,e=r[i*this.pageSize-this.pageSize].uid,f=r[i*this.pageSize].uid,c=this.getRowObjectIndexByUid(o);h[parseInt(c.toString(),10)].lazyLoadCssClass="e-lazyload-middle-up";this.getRowElementByUid(o).classList.add("e-lazyload-middle-up");u&&(this.getRowElementByUid(f).classList.add("e-not-lazyload-first"),this.getRowByUid(f).lazyLoadCssClass="e-not-lazyload-first",this.getRowByUid(e).lazyLoadCssClass="");t?this.removeTopRows(u?u.uid:n,e,f):(this.uid1=e,this.uid2=f,this.uid3=u?u.uid:n)},r.prototype.scrollUpHandler=function(n){var p=this.parent.pageSettings.currentPage,e=this.groupCache[parseInt(p.toString(),10)],w=n.getAttribute("data-uid"),rt=this.getRowByUid(w),b=this.rowObjectIndex=this.getRowObjectIndexByUid(w),i=this.getRowByUid(rt.parentUid),ut=this.rowIndex=this.getRowObjectIndexByUid(i.uid),ft=this.parent.getRowElementByUID(i.uid).rowIndex,r=this.getChildRowsByParentIndex(ut),h=r.indexOf(e[parseInt(b.toString(),10)]),k=Math.floor(h/this.pageSize),u=this.blockSize,c,o,f,v,y,it;if(2*this.blockSize>this.pageSize&&(u=2*this.blockSize-this.pageSize,u=this.blockSize-u),c=r[h-(u-1)-this.pageSize].uid,o=r[h-(u-1)].uid,this.scrollData=this.getCacheRowsOnUpScroll(c,o,b-(u-1)),this.isFirstChildRow=k>1,this.isFirstChildRow&&(this.scrollData[0].lazyLoadCssClass="e-not-lazyload-first"),this.getRowByUid(o).lazyLoadCssClass="",this.getRowElementByUid(o).classList.remove("e-not-lazyload-first"),f=k+this.cacheBlockSize,r.length!==i.data.count&&f*this.pageSize>r.length)return this.isFirstChildRow=!1,this.scrollData[0].lazyLoadCssClass="",void this.getRowElementByUid(o).classList.add("e-not-lazyload-first");var s=f*this.pageSize>i.data.count?i.data.count:f*this.pageSize,d=f*this.pageSize>i.data.count?this.pageSize-(this.pageSize*f-i.data.count):this.pageSize,l=this.getChildRowsByParentIndex(e.indexOf(r[s-1]),!0,!1,null,!0),g=l.length?l[l.length-1].uid:r[s-1].uid,nt=r[s-d].uid,a=r[s-d-1].uid,tt=this.objIdxByUid[parseInt(p.toString(),10)][""+nt]-u;if("e-lazyload-middle-down"===e[parseInt(tt.toString(),10)].lazyLoadCssClass&&(v=this.getRowElementByUid(e[parseInt(tt.toString(),10)].uid),v&&v.classList.add("e-lazyload-middle-down")),this.getRowByUid(g).lazyLoadCssClass="",this.getRowByUid(a).lazyLoadCssClass="e-not-lazyload-end",this.getRowElementByUid(a).classList.add("e-not-lazyload-end"),this.removeBottomRows(g,nt,a),this.rowIndex=n.rowIndex-u,n.classList.length>1?n.classList.remove("e-lazyload-middle-up"):n.removeAttribute("class"),!t.isNullOrUndefined(this.getRowElementByUid(c)))return this.childCount=0,void(this.scrollData=[]);y=po(this.getRowObjectIndexByUid(i.uid),e);it={rowIndex:ft,makeRequest:!1,groupInfo:i,fields:y.fields,keys:y.keys,skip:this.childCount,take:this.pageSize,isScroll:!0,scrollUp:!0};this.isScrollUp=!0;this.captionRowExpand(it)},r.prototype.findRowElements=function(n){for(var f,r,i,u=!1,t=0;t<n.length;t++)if(r=n[parseInt(t.toString(),10)].rowIndex,this.parent.enableVirtualization&&(i=this.parent.contentModule.currentInfo,i&&i.blockIndexes&&i.blockIndexes[0]>1&&(r+=this.parent.contentModule.offsets[i.blockIndexes[0]-1]/this.parent.getRowHeight())),prt(r,this.parent)){u=!0;this.rowIndex=r;f=n[parseInt(t.toString(),10)];break}return{entered:u,tr:f}},r.prototype.getRowElementByUid=function(n){return this.parent.getContent().querySelector("tr[data-uid="+n+"]")},r.prototype.removeTopRows=function(n,i,r){for(var e,f=[].slice.call(this.parent.getContent().querySelectorAll("tr")),o=!1,u=0;u<f.length;u++){if(f[parseInt(u.toString(),10)].getAttribute("data-uid")===r){e=this.parent.getContent().querySelector("tr[data-uid="+n+"]");e&&(this.rowIndex=e.rowIndex);break}f[parseInt(u.toString(),10)].getAttribute("data-uid")===i&&(o=!0);o&&t.remove(f[parseInt(u.toString(),10)])}},r.prototype.removeBottomRows=function(n,i){for(var u=[].slice.call(this.parent.getContent().querySelectorAll("tr")),f=!1,r=0;r<u.length&&(u[parseInt(r.toString(),10)].getAttribute("data-uid")===i&&(f=!0),!f||(t.remove(u[parseInt(r.toString(),10)]),u[parseInt(r.toString(),10)].getAttribute("data-uid")!==n));r++);},r.prototype.setCache=function(n){var i=this.parent.pageSettings.currentPage;this.parent.enableVirtualization&&(this.parent.lazyLoadRender=this);this.groupCache[parseInt(i.toString(),10)]=this.parent.enableInfiniteScrolling&&"infiniteScroll"===n.args.requestType&&n.args.prevPage!==n.args.currentPage?this.initialGroupCaptions[parseInt(i.toString(),10)]=this.groupCache[n.args.prevPage].concat(t.extend([],n.data)):this.initialGroupCaptions[parseInt(i.toString(),10)]=t.extend([],n.data)},r.prototype.captionRowExpand=function(n){var t=this,f=n.groupInfo,r=this.parent.groupSettings.columns.indexOf(f.data.field)+1,e=bv(wv(n.fields,n.keys,this)),u={level:r,skip:n.skip,take:n.take,where:e},i;n.makeRequest?(i=this.parent.renderModule.data.generateQuery(!0),i.isCountRequired||(i.isCountRequired=!0),i.lazyLoad.push({key:"onDemandGroupInfo",value:u}),this.lazyLoadQuery.push(u.where),n.isScroll&&this.parent.enableVirtualMaskRow?this.parent.showMaskRow():this.parent.showSpinner(),this.parent.renderModule.data.getData({},i).then(function(i){t.parent.enableVirtualization&&(t.parent.islazyloadRequest=!0);t.parent.hideSpinner();t.parent.removeMaskRow();0!==i.result.length&&(t.cacheMode&&t.uid1&&t.uid2&&(t.removeTopRows(t.uid3,t.uid1,t.uid2),t.uid1=t.uid2=t.uid3=void 0),t.lazyLoadHandler({data:i.result,count:i.count,level:r,index:n.rowIndex,isRowExist:!1,isScroll:n.isScroll,up:!1,rowIndex:n.cachedRowIndex}))}).catch(function(n){return t.parent.renderModule.dataManagerFailure(n,{requestType:"grouping"})})):this.lazyLoadHandler({data:null,count:n.groupInfo.data.count,level:r,index:n.rowIndex,isRowExist:!0,isScroll:n.isScroll,up:n.scrollUp,rowIndex:n.cachedRowIndex})},r.prototype.scrollReset=function(n){this.parent.getContent().firstElementChild.scrollTop=n?this.parent.getContent().firstElementChild.scrollTop+n:0},r.prototype.updateCurrentViewData=function(){var n=[];this.getRows().filter(function(t){t.isDataRow&&(n[t.index]=t.data)});this.parent.currentViewData=n.length?n:this.parent.currentViewData},r.prototype.getGroupCache=function(){return this.groupCache},r.prototype.getRows=function(){return this.groupCache[this.parent.pageSettings.currentPage]||[]},r.prototype.getRowElements=function(){return[].slice.call(this.parent.getContent().getElementsByClassName(y))},r.prototype.getRowByIndex=function(n){for(var u,r=[].slice.call(this.parent.getContent().getElementsByClassName(y)),i=0;!t.isNullOrUndefined(n)&&i<r.length;i++)if(r[parseInt(i.toString(),10)].getAttribute(h)===n.toString()){u=r[parseInt(i.toString(),10)];break}return u},r.prototype.setVisible=function(n){var f,s=this.parent,e,r;for(this.getRows().some(function(n){return n.isDataRow&&(f=n),n.isDataRow}),e=this.getRows().filter(function(n){return!n.isDetailRow}),r=0;r<n.length;r++){var i=n[parseInt(r.toString(),10)],u=this.parent.getNormalizedColumnIndex(i.uid),h=this.parent.getColumnIndexByUid(i.uid),o=!0===i.visible?"":"none";-1!==u&&f&&u<f.cells.length&&t.setStyleAttribute(this.getColGroup().childNodes[parseInt(u.toString(),10)],{display:o});this.setDisplayNone(s.getDataRows(),h,o,e,u);!this.parent.invokedFromMedia&&i.hideAtMedia&&this.parent.updateMediaColumns(i);this.parent.invokedFromMedia=!1}},r.prototype.setDisplayNone=function(n,i,r,u,f){var h,s,o,e;if(this.parent.groupSettings.columns.length)for(h=Object.keys(this.groupCache),s=0;s<h.length;s++)for(var a=this.rowsByUid[h[parseInt(s.toString(),10)]],l=Object.keys(a),c=0;c<l.length;c++)o=this.parent.getContent().querySelector("tr[data-uid="+l[parseInt(c.toString(),10)]+"]"),e=a[l[parseInt(c.toString(),10)]],e.isCaptionRow&&(this.captionModelGen.isEmpty()?(e.cells[e.indent+1].colSpan=""===r?e.cells[e.indent+1].colSpan+1:e.cells[e.indent+1].colSpan-1,o&&(o.cells[e.indent+1].colSpan=e.cells[e.indent+1].colSpan)):this.changeCaptionRow(e,o,h[parseInt(s.toString(),10)])),e.isDataRow&&(this.showAndHideCells(o,i,r,!1),e.cells[parseInt(f.toString(),10)].visible=""===r),e.isCaptionRow||e.isDataRow||!t.isNullOrUndefined(e.indent)||(e.cells[parseInt(f.toString(),10)].visible=""===r,e.visible=e.cells.some(function(n){return n.isDataCell&&n.visible}),this.showAndHideCells(o,i,r,!0,e));else pb(n,i,r,u)},r.prototype.changeCaptionRow=function(n,t,i){var u=n,f=n.data,r=this.groupGenerator.generateCaptionRow(f,u.indent,u.parentGid,void 0,u.tIndex,u.parentUid);r.uid=n.uid;r.isExpand=n.isExpand;r.lazyLoadCssClass=n.lazyLoadCssClass;this.rowsByUid[parseInt(i.toString(),10)][n.uid]=r;this.groupCache[parseInt(i.toString(),10)][this.objIdxByUid[parseInt(i.toString(),10)][n.uid]]=r;t&&this.parent.getContentTable().querySelector(e).replaceChild(this.rowRenderer.render(r,this.parent.getColumns()),t)},r.prototype.showAndHideCells=function(n,i,r,u,f){if(n){var e=u?"td.e-summarycell":"td.e-rowcell";t.setStyleAttribute(n.querySelectorAll(e)[parseInt(i.toString(),10)],{display:r});n.querySelectorAll(e)[parseInt(i.toString(),10)].classList.contains("e-hide")&&t.removeClass([n.querySelectorAll(e)[parseInt(i.toString(),10)]],["e-hide"]);u&&(f.visible&&n.classList.contains("e-hide")?t.removeClass([n],["e-hide"]):f.visible||t.addClass([n],["e-hide"]))}},r}(fo),tlt=function(){function n(n,t){this.parent=n;this.serviceLocator=t;this.addEventListener()}return n.prototype.getModuleName=function(){return"lazyLoadGroup"},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(cr,this.instantiateRenderer,this),this.parent.on(v,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(cr,this.instantiateRenderer),this.parent.off(v,this.destroy))},n.prototype.instantiateRenderer=function(){"auto"===this.parent.height&&(this.parent.height=this.parent.pageSettings.pageSize*this.parent.getRowHeight());var n=this.serviceLocator.getService("rendererFactory");this.parent.groupSettings.enableLazyLoading&&n.addRenderer(at.Content,new rd(this.parent,this.serviceLocator));this.parent.enableVirtualization&&(this.parent.lazyLoadRender=new rd(this.parent,this.serviceLocator))},n.prototype.destroy=function(){this.removeEventListener()},n}(),ilt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),rlt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ilt(i,n),i.prototype.write=function(n){this.column=n.column;var i="Dialog"!==this.parent.editSettings.mode;this.object=new dr.AutoComplete(t.extend({dataSource:this.parent.dataSource instanceof u.DataManager?this.parent.dataSource:new u.DataManager(this.parent.dataSource),query:(new u.Query).select(n.column.field),enabled:br(n.column,n.requestType,n.element),fields:{value:n.column.field},value:ut(n.column.field,n.rowData),actionComplete:this.selectedValues.bind(this),placeholder:i?"":n.column.headerText,floatLabelType:i?"Never":"Always"},n.column.edit.params));this.object.appendTo(n.element);n.element.setAttribute("name",wt(n.column.field))},i.prototype.selectedValues=function(n){n.result=u.DataUtil.distinct(n.result,this.object.fields.value,!0);this.column.dataSource&&(this.column.dataSource.dataSource.json=n.result)},i}(gr),ult=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),flt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ult(i,n),i.prototype.write=function(n){this.column=n.column;var i="Dialog"!==this.parent.editSettings.mode;this.obj=new dr.ComboBox(t.extend({dataSource:this.parent.dataSource instanceof u.DataManager?this.parent.dataSource:new u.DataManager(this.parent.dataSource),query:(new u.Query).select(n.column.field),fields:{value:n.column.field},value:ut(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,actionComplete:this.finalValue.bind(this),placeholder:i?"":n.column.headerText,floatLabelType:i?"Never":"Always",enabled:br(n.column,n.requestType,n.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},n.column.edit.params));this.obj.appendTo(n.element)},i.prototype.finalValue=function(n){n.result=u.DataUtil.distinct(n.result,this.obj.fields.value,!0);this.column.dataSource&&(this.column.dataSource.dataSource.json=n.result)},i}(gr),elt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),olt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return elt(i,n),i.prototype.write=function(n){this.column=n.column;var i="Dialog"!==this.parent.editSettings.mode;this.obj=new dr.MultiSelect(t.extend({fields:{text:n.column.field,value:n.column.field},value:t.getValue(n.column.field,n.rowData),enableRtl:this.parent.enableRtl,placeholder:i?"":n.column.headerText,popupHeight:"200px",floatLabelType:i?"Never":"Always",cssClass:this.parent.cssClass?this.parent.cssClass:null},n.column.edit.params));this.obj.appendTo(n.element);n.element.setAttribute("name",wt(n.column.field))},i}(gr),slt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),hlt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return slt(i,n),i.prototype.write=function(n){var r="Dialog"!==this.parent.editSettings.mode,i=ut(n.column.field,n.rowData);i=i?new Date(i):null;this.obj=new se.TimePicker(t.extend({floatLabelType:r?"Never":"Always",value:i,placeholder:r?"":n.column.headerText,enableRtl:this.parent.enableRtl,enabled:br(n.column,n.requestType,n.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},n.column.edit.params));this.obj.appendTo(n.element)},i}(gr),clt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),llt=function(n){function i(){var t=null!==n&&n.apply(this,arguments)||this;return t.activeClasses=["e-selectionbackground","e-active"],t}return clt(i,n),i.prototype.create=function(n){var t="e-field e-boolcell";return"checkbox"===n.column.type&&(t="e-field e-boolcell e-edit-checkselect"),vo(this.parent,n.column,t,{type:"checkbox",value:n.value})},i.prototype.read=function(n){return n.checked},i.prototype.write=function(n){var f=!t.isNullOrUndefined(n.row)&&n.row.querySelector(".e-edit-checkselect"),u=ut(n.column.field,n.rowData),i=u&&JSON.parse(u.toString().toLowerCase()),r;t.isNullOrUndefined(f)||((this.editType=this.parent.editSettings.mode,this.editRow=n.row,"add"!==n.requestType)&&(r=this.parent.getRowObjectFromUID(n.row.getAttribute("data-uid")),i=!!r&&r.isSelected),rr.apply(void 0,[[].slice.call(n.row.getElementsByClassName(a)),i].concat(this.activeClasses)));this.obj=new fi.Switch(t.extend({label:"Dialog"!==this.parent.editSettings.mode?" ":n.column.headerText,checked:i,disabled:!br(n.column,n.requestType,n.element),enableRtl:this.parent.enableRtl,change:this.switchModeChange.bind(this),cssClass:this.parent.cssClass?this.parent.cssClass:""},n.column.edit.params));this.obj.appendTo(n.element)},i.prototype.switchModeChange=function(n){if(this.editRow&&"Dialog"!==this.editType){var t=!1;n.checked?(t=!0,this.editRow.setAttribute("aria-selected",t.toString())):this.editRow.removeAttribute("aria-selected");rr.apply(void 0,[[].slice.call(this.editRow.getElementsByClassName(a)),t].concat(this.activeClasses))}},i}(gr),alt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vlt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return alt(i,n),i.prototype.write=function(n){this.column=n.column;var i="Dialog"!==this.parent.editSettings.mode;this.obj=new kr.MaskedTextBox(t.extend({fields:{value:n.column.field},value:ut(n.column.field,n.rowData),floatLabelType:i?"Never":"Always",mask:"000-000-0000",enabled:br(n.column,n.requestType,n.element),cssClass:this.parent.cssClass?this.parent.cssClass:null},n.column.edit.params));this.obj.appendTo(n.element)},i}(gr),ud={};uc.C(ud,rc);kft={grids:ud=uc.C(window.ejdashboard?window.ejdashboard.grids:{},ud)};window.ejdashboard=uc.C(window.ejdashboard||{},kft)})()})();(()=>{function t(r){var f=n[r],u;return void 0!==f?f.exports:(u=n[r]={exports:{}},i[r](u,u.exports,t),u.exports)}var i={864:(n,t)=>{t.C=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},n={};(()=>{var pe,di,le,dl,ye,sa;pe=t(864);const n=ejdashboard.base,ut=ejdashboard.data,a=ejdashboard.pdfexport;var r=function(){function t(){}return t.getType=function(n){var t=new Date(n);return"boolean"==typeof n?"boolean":isNaN(Number(n))?t instanceof Date&&!isNaN(t.valueOf())?t&&t.getDay()&&(t.getHours()>0||t.getMinutes()>0||t.getSeconds()>0||t.getMilliseconds()>0)?"datetime":"date":typeof n:"number"},t.resetTime=function(n){return n.setHours(0,0,0,0),n},t.getClonedData=function(n){var f=[],t,r;if(n)for(t=0,r=n;t<r.length;t++){for(var e=r[t],u=Object.keys(e),i=0,o={};i<u.length;)o[u[i]]=e[u[i]],i++;f.push(o)}return f},t.getDefinedObj=function(n){var t=0,r={},i;if(null!=n)for(i=Object.keys(n);t<i.length;)null!==n[i[t]]&&void 0!==n[i[t]]&&(r[i[t]]=n[i[t]]),t++;else r=n;return r},t.inArray=function(n,t){if(t)for(var i=0,r=t.length;i<r;i++)if(t[i]===n)return i;return-1},t.setPivotProperties=function(n,t){n.allowServerDataBinding=!1;n.pivotGridModule&&(n.pivotGridModule.allowServerDataBinding=!1);n.setProperties(t,!0);n.allowServerDataBinding=!0;n.pivotGridModule&&(n.pivotGridModule.allowServerDataBinding=!0)},t.getClonedDataSourceSettings=function(t){return this.getDefinedObj({type:t.type,catalog:t.catalog,cube:t.cube,providerType:t.providerType,url:t.url,localeIdentifier:t.localeIdentifier,excludeFields:n.isNullOrUndefined(t.excludeFields)?[]:t.excludeFields.slice(),expandAll:t.expandAll,allowLabelFilter:t.allowLabelFilter,allowValueFilter:t.allowValueFilter,allowMemberFilter:t.allowMemberFilter,enableSorting:!!t.enableSorting,rows:this.cloneFieldSettings(t.rows),columns:this.cloneFieldSettings(t.columns),filters:this.cloneFieldSettings(t.filters),values:this.cloneFieldSettings(t.values),filterSettings:this.cloneFilterSettings(t.filterSettings),sortSettings:this.cloneSortSettings(t.sortSettings),drilledMembers:this.cloneDrillMemberSettings(t.drilledMembers),valueSortSettings:this.CloneValueSortObject(t.valueSortSettings),valueAxis:t.valueAxis,grandTotalsPosition:t.grandTotalsPosition,formatSettings:this.cloneFormatSettings(t.formatSettings),calculatedFieldSettings:this.cloneCalculatedFieldSettings(t.calculatedFieldSettings),fieldMapping:this.cloneFieldSettings(t.fieldMapping),showSubTotals:t.showSubTotals,showRowSubTotals:t.showRowSubTotals,showColumnSubTotals:t.showColumnSubTotals,subTotalsPosition:t.subTotalsPosition,showGrandTotals:t.showGrandTotals,showRowGrandTotals:t.showRowGrandTotals,showColumnGrandTotals:t.showColumnGrandTotals,showHeaderWhenEmpty:t.showHeaderWhenEmpty,alwaysShowValueHeader:t.alwaysShowValueHeader,conditionalFormatSettings:this.cloneConditionalFormattingSettings(t.conditionalFormatSettings),emptyCellsTextContent:t.emptyCellsTextContent,groupSettings:this.cloneGroupSettings(t.groupSettings),showAggregationOnValueField:t.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(t.authentication)})},t.getClonedFieldList=function(n){for(var t,r=Object.keys(n),u={},i=0,f=r.length;i<f;i++)t=n[r[i]],n[r[i]]&&(u[r[i]]={type:t.type,caption:t.caption,id:t.id,isSelected:t.isSelected,sort:t.sort,filterType:t.filterType,index:t.index,filter:t.filter,isCustomField:t.isCustomField,showRemoveIcon:t.showRemoveIcon,showFilterIcon:t.showFilterIcon,showSortIcon:t.showSortIcon,showNoDataItems:t.showNoDataItems,isCalculatedField:t.isCalculatedField,showEditIcon:t.showEditIcon,showValueTypeIcon:t.showValueTypeIcon,allowDragAndDrop:t.allowDragAndDrop,showSubTotals:t.showSubTotals,expandAll:t.expandAll,pid:t.pid,aggregateType:t.aggregateType,baseField:t.baseField,baseItem:t.baseItem,dateMember:this.cloneDateMembers(t.dateMember),formattedMembers:this.cloneFormatMembers(t.formattedMembers),members:this.cloneFormatMembers(t.members),formatString:t.formatString,format:t.format,formula:t.formula,isExcelFilter:t.isExcelFilter,membersOrder:t.membersOrder?t.membersOrder.slice():t.membersOrder,isAlphanumeric:t.isAlphanumeric,tag:t.tag,expanded:t.expanded,spriteCssClass:t.spriteCssClass,name:t.name,defaultHierarchy:t.defaultHierarchy,hasAllMember:t.hasAllMember,allMember:t.allMember,isChecked:t.isChecked,filterMembers:this.cloneFieldMembers(t.filterMembers),childMembers:this.cloneFieldMembers(t.childMembers),searchMembers:this.cloneFieldMembers(t.searchMembers),htmlAttributes:this.getDefinedObj(t.htmlAttributes),currrentMembers:this.cloneFormatMembers(t.currrentMembers),isHierarchy:t.isHierarchy,isNamedSets:t.isNamedSets,actualFilter:t.actualFilter?t.actualFilter.slice():t.actualFilter,levels:this.cloneFieldMembers(t.levels),levelCount:t.levelCount,fieldType:t.fieldType,memberType:t.memberType,parentHierarchy:t.parentHierarchy});return u},t.cloneDateMembers=function(n){var i;if(n){for(var r=[],t=0,u=n;t<u.length;t++)i=u[t],r.push({formattedText:i.formattedText,actualText:i.actualText});return r}return n},t.cloneFormatMembers=function(n){var t;if(n){for(var r=Object.keys(n),u={},i=0,f=r.length;i<f;i++)t=n[r[i]],u[r[i]]={index:t.index?t.index.slice():t.index,isDrilled:t.isDrilled,ordinal:t.ordinal};return u}return n},t.cloneFieldMembers=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push({caption:t.caption,hasChildren:t.hasChildren,id:t.id,isSelected:t.isSelected,name:t.name,tag:t.tag,htmlAttributes:this.getDefinedObj(t.htmlAttributes),type:t.type,spriteCssClass:t.spriteCssClass,pid:t.pid,isChecked:t.isChecked});return r}return n},t.updateDataSourceSettings=function(t,i){t&&this.setPivotProperties(t,{dataSourceSettings:this.getDefinedObj({type:i.type,catalog:i.catalog,cube:i.cube,providerType:i.providerType,url:i.url,localeIdentifier:i.localeIdentifier,excludeFields:n.isNullOrUndefined(i.excludeFields)?[]:i.excludeFields,expandAll:i.expandAll,allowLabelFilter:i.allowLabelFilter,allowValueFilter:i.allowValueFilter,allowMemberFilter:i.allowMemberFilter,enableSorting:!!i.enableSorting,rows:i.rows,columns:i.columns,filters:i.filters,values:i.values,filterSettings:i.filterSettings,sortSettings:i.sortSettings,drilledMembers:i.drilledMembers,valueSortSettings:i.valueSortSettings,valueAxis:i.valueAxis,grandTotalsPosition:i.grandTotalsPosition,formatSettings:i.formatSettings,calculatedFieldSettings:i.calculatedFieldSettings,fieldMapping:i.fieldMapping,showSubTotals:i.showSubTotals,showRowSubTotals:i.showRowSubTotals,showColumnSubTotals:i.showColumnSubTotals,subTotalsPosition:i.subTotalsPosition,showGrandTotals:i.showGrandTotals,showRowGrandTotals:i.showRowGrandTotals,showColumnGrandTotals:i.showColumnGrandTotals,showHeaderWhenEmpty:i.showHeaderWhenEmpty,alwaysShowValueHeader:i.alwaysShowValueHeader,conditionalFormatSettings:i.conditionalFormatSettings,emptyCellsTextContent:i.emptyCellsTextContent,groupSettings:i.groupSettings,showAggregationOnValueField:i.showAggregationOnValueField,authentication:this.CloneAuthenticationObject(i.authentication)})})},t.cloneFieldSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,caption:t.caption,axis:t.axis,baseField:t.baseField,baseItem:t.baseItem,isCalculatedField:t.isCalculatedField,isNamedSet:t.isNamedSet,showNoDataItems:t.showNoDataItems,showSubTotals:t.showSubTotals,type:t.type,dataType:t.dataType,showFilterIcon:t.showFilterIcon,showSortIcon:t.showSortIcon,showRemoveIcon:t.showRemoveIcon,showValueTypeIcon:t.showValueTypeIcon,showEditIcon:t.showEditIcon,allowDragAndDrop:t.allowDragAndDrop,expandAll:t.expandAll,groupName:t.groupName}));return r}return n},t.cloneOlapFieldSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({caption:t.caption,hasChildren:t.hasChildren,id:t.id,isSelected:t.isSelected,name:t.name,spriteCssClass:t.spriteCssClass,tag:t.tag,type:t.type,pid:t.pid,expanded:t.expanded,defaultHierarchy:t.defaultHierarchy,hasAllMember:t.hasAllMember,allMember:t.allMember,isChecked:t.isChecked,filterMembers:t.filterMembers,childMembers:t.childMembers,searchMembers:t.searchMembers,htmlAttributes:this.getDefinedObj(t.htmlAttributes),currrentMembers:t.currrentMembers,isHierarchy:t.isHierarchy,isNamedSets:t.isNamedSets,formatString:t.formatString,actualFilter:t.actualFilter,levels:t.levels,levelCount:t.levelCount,memberType:t.memberType,fieldType:t.fieldType,parentHierarchy:t.parentHierarchy}));return r}return n},t.cloneFilterSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,type:t.type,condition:t.condition,items:t.items?t.items.slice():t.items,levelCount:t.levelCount,measure:t.measure,selectedField:t.selectedField,showDateFilter:t.showDateFilter,showLabelFilter:t.showLabelFilter,showNumberFilter:t.showNumberFilter,value1:t.value1,value2:t.value2}));return r}return n},t.cloneSortSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,order:t.order,membersOrder:t.membersOrder?t.membersOrder.slice():t.membersOrder}));return r}return n},t.cloneDrillMemberSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,delimiter:t.delimiter,items:t.items?t.items.slice():t.items}));return r}return n},t.cloneFormatSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,calendar:t.calendar,currency:t.currency,format:t.format,maximumFractionDigits:t.maximumFractionDigits,maximumSignificantDigits:t.maximumSignificantDigits,minimumFractionDigits:t.minimumFractionDigits,minimumIntegerDigits:t.minimumIntegerDigits,minimumSignificantDigits:t.minimumSignificantDigits,skeleton:t.skeleton,type:t.type,useGrouping:t.useGrouping}));return r}return n},t.CloneValueSortObject=function(n){return n?{columnIndex:n.columnIndex,headerDelimiter:n.headerDelimiter,headerText:n.headerText,measure:n.measure,sortOrder:n.sortOrder,columnHeader:n.columnHeader,rowHeader:n.rowHeader,rowOrder:n.rowOrder,columnOrder:n.columnOrder}:n},t.CloneAuthenticationObject=function(n){return n?{userName:n.userName,password:n.password}:n},t.cloneCalculatedFieldSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,formatString:t.formatString,formula:t.formula,hierarchyUniqueName:t.hierarchyUniqueName}));return r}return n},t.cloneConditionalFormattingSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({applyGrandTotals:t.applyGrandTotals,conditions:t.conditions,label:t.label,measure:t.measure,style:t.style?{backgroundColor:t.style.backgroundColor,color:t.style.color,fontFamily:t.style.fontFamily,fontSize:t.style.fontSize}:t.style,value1:t.value1,value2:t.value2}));return r}return n},t.cloneGroupSettings=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({name:t.name,caption:t.caption,customGroups:this.cloneCustomGroups(t.customGroups),endingAt:t.endingAt,startingAt:t.startingAt,groupInterval:t.groupInterval,rangeInterval:t.rangeInterval,type:t.type}));return r}return n},t.cloneCustomGroups=function(n){var t;if(n){for(var r=[],i=0,u=n;i<u.length;i++)t=u[i],r.push(this.getDefinedObj({groupName:t.groupName,items:t.items?t.items.slice():t.items}));return r}return n},t.getFilterItemByName=function(n,t){var i=new ut.DataManager({json:t}).executeLocal((new ut.Query).where("name","equal",n));if(i&&i.length>0)return i[i.length-1]},t.getFieldByName=function(n,t){return new ut.DataManager({json:t}).executeLocal((new ut.Query).where("name","equal",n))[0]},t.getFieldInfo=function(n,t,i){var f,o,r;if(!i)for(var e=[this.cloneFieldSettings(t.dataSourceSettings.rows),this.cloneFieldSettings(t.dataSourceSettings.columns),this.cloneFieldSettings(t.dataSourceSettings.values),this.cloneFieldSettings(t.dataSourceSettings.filters)],u=0,s=e.length;u<s;u++)for(f=0,o=e[u]?e[u].length:0;f<o;f++)if(e[u][f]&&e[u][f].name===n)return{fieldName:n,fieldItem:e[u][f],axis:0===u?"rows":1===u?"columns":2===u?"values":"filters",position:f};return r="olap"===t.dataType?t.olapEngineModule.fieldList[n]:t.engineModule.fieldList[n],{fieldName:n,fieldItem:r?{name:n,caption:r.caption,baseField:r.baseField,baseItem:r.baseItem,isCalculatedField:r.isCalculatedField,isNamedSet:r.isNamedSets,showNoDataItems:r.showNoDataItems,showSubTotals:r.showSubTotals,type:r.aggregateType,showFilterIcon:r.showFilterIcon,showSortIcon:r.showSortIcon,showRemoveIcon:r.showRemoveIcon,showValueTypeIcon:r.showValueTypeIcon,showEditIcon:r.showEditIcon,allowDragAndDrop:r.allowDragAndDrop,expandAll:r.expandAll}:void 0,axis:"fieldlist",position:-1}},t.isButtonIconRefesh=function(t,i,r){var l=!1,v,u,y,e,p,s,c;try{if("dataSourceSettings"===t&&i.dataSourceSettings&&r.dataSourceSettings){var o=["notAvail","notAvail","notAvail","notAvail"],a=Object.keys(i.dataSourceSettings),f=Object.keys(r.dataSourceSettings);if(a&&f&&f.length>0&&a.length===f.length)for(v=["rows","columns","values","filters"],u=0;u<f.length;u++){if(y=f[u]in i.dataSourceSettings&&!n.isNullOrUndefined(i.dataSourceSettings[f[u]])?Object.keys(i.dataSourceSettings[f[u]]):[],e=f[u]in r.dataSourceSettings&&!n.isNullOrUndefined(r.dataSourceSettings[f[u]])?Object.keys(r.dataSourceSettings[f[u]]):[],-1!==v.indexOf(f[u])&&-1!==v.indexOf(a[u])&&y&&e&&e.length>0&&y.length===e.length)for(p=["showFilterIcon","showSortIcon","showRemoveIcon","showValueTypeIcon","showEditIcon","allowDragAndDrop","expandAll"],s=0;s<e.length;s++){for(var tt=Object.keys(i.dataSourceSettings[f[u]][e[s]]),d=Object.keys(r.dataSourceSettings[f[u]][e[s]]),h=0;h<d.length;h++){if(-1===p.indexOf(d[h])||-1===p.indexOf(tt[h])){o[u]="break";break}o[u]="update"}if("break"===o[u])break}else o[u]="break";if("break"===o[u])break}for(var w=0,b=0,g=0,k=0,nt=o;k<nt.length;k++)c=nt[k],"break"===c&&w++,"notAvail"===c&&b++,"update"===c&&g++;l=!(w>0||4===b)&&0===w&&b<4&&g>0}}catch(t){l=!1}return l},t.formatPivotValues=function(n){for(var i,r=[],t=0;t<n.length;t++)if(n[t])for(r[t]=[],i=0;i<n[t].length;i++)n[t][i]&&(r[t][i]={axis:n[t][i].Axis,actualText:n[t][i].ActualText,indexObject:n[t][i].IndexObject,index:n[t][i].Index,rowHeaders:n[t][i].RowHeaders,columnHeaders:n[t][i].ColumnHeaders,formattedText:n[t][i].FormattedText,actualValue:n[t][i].ActualValue,rowIndex:n[t][i].RowIndex,colIndex:n[t][i].ColIndex,colSpan:n[t][i].ColSpan,level:n[t][i].Level,rowSpan:n[t][i].RowSpan,isSum:n[t][i].IsSum,isGrandSum:n[t][i].IsGrandSum,valueSort:n[t][i].ValueSort,ordinal:n[t][i].Ordinal,hasChild:n[t][i].HasChild,isDrilled:n[t][i].IsDrilled,value:n[t][i].Value,type:n[t][i].Type,members:n[t][i].Members});return r},t.formatFieldList=function(n){for(var i=Object.keys(n),r={},t=0;t<i.length;t++)n[i[t]]&&(r[i[t]]={id:n[i[t]].Id,caption:n[i[t]].Caption,type:n[i[t]].Type,formatString:n[i[t]].FormatString,index:n[i[t]].Index,members:n[i[t]].Members,formattedMembers:n[i[t]].FormattedMembers,dateMember:n[i[t]].DateMember,filter:n[i[t]].Filter,sort:n[i[t]].Sort,aggregateType:n[i[t]].AggregateType,baseField:n[i[t]].BaseField,baseItem:n[i[t]].BaseItem,filterType:n[i[t]].FilterType,format:n[i[t]].Format,formula:n[i[t]].Formula,isSelected:n[i[t]].IsSelected,isExcelFilter:n[i[t]].IsExcelFilter,showNoDataItems:n[i[t]].ShowNoDataItems,isCustomField:n[i[t]].IsCustomField,showFilterIcon:n[i[t]].ShowFilterIcon,showSortIcon:n[i[t]].ShowSortIcon,showRemoveIcon:n[i[t]].ShowRemoveIcon,showEditIcon:n[i[t]].ShowEditIcon,showValueTypeIcon:n[i[t]].ShowValueTypeIcon,allowDragAndDrop:n[i[t]].AllowDragAndDrop,isCalculatedField:n[i[t]].IsCalculatedField,showSubTotals:n[i[t]].ShowSubTotals,expandAll:n[i[t]].expandAll,groupName:n[i[t]].groupName});return r},t.frameContent=function(n,t,i,r){var s=[],e=r,f;if(e.dataSourceSettings.values.length>0&&!e.engineModule.isEmptyData&&(e.enableValueSorting||!e.engineModule.isEngineUpdated))for(var o=0,h="value"===t?i:0,c="value"===t?n.length:i,u=h;u<c;u++)if(n[u]){for(s[o="header"===t?u:o]={},f=0;f<n[u].length;f++)n[u][f]&&(s[o][f]=n[u][f]);o++}return s},t.getLocalizedObject=function(n){var t={};return t.Null=n.localeObj.getConstant("null"),t.Years=n.localeObj.getConstant("Years"),t.Quarters=n.localeObj.getConstant("Quarters"),t.Months=n.localeObj.getConstant("Months"),t.Days=n.localeObj.getConstant("Days"),t.Hours=n.localeObj.getConstant("Hours"),t.Minutes=n.localeObj.getConstant("Minutes"),t.Seconds=n.localeObj.getConstant("Seconds"),t.QuarterYear=n.localeObj.getConstant("QuarterYear"),t.Of=n.localeObj.getConstant("of"),t.Qtr=n.localeObj.getConstant("qtr"),t.Undefined=n.localeObj.getConstant("undefined"),t.GroupOutOfRange=n.localeObj.getConstant("groupOutOfRange"),t.Group=n.localeObj.getConstant("group"),t},t.updateReport=function(n,t){n.setProperties({dataSourceSettings:{rows:[]}},!0);n.setProperties({dataSourceSettings:{columns:[]}},!0);n.setProperties({dataSourceSettings:{formatSettings:[]}},!0);for(var i=0;i<t.Rows.length;i++)n.dataSourceSettings.rows.push({name:t.Rows[i].Name,caption:t.Rows[i].Caption,showNoDataItems:t.Rows[i].ShowNoDataItems,baseField:t.Rows[i].BaseField,baseItem:t.Rows[i].BaseItem,showFilterIcon:t.Rows[i].ShowFilterIcon,showSortIcon:t.Rows[i].ShowSortIcon,showEditIcon:t.Rows[i].ShowEditIcon,showRemoveIcon:t.Rows[i].ShowRemoveIcon,showSubTotals:t.Rows[i].ShowValueTypeIcon,allowDragAndDrop:t.Rows[i].AllowDragAndDrop,axis:t.Rows[i].Axis,dataType:t.Rows[i].DataType,isCalculatedField:t.Rows[i].IsCalculatedField,showValueTypeIcon:t.Rows[i].ShowValueTypeIcon,type:t.Rows[i].Type,expandAll:t.Rows[i].expandAll});for(i=0;i<t.Columns.length;i++)n.dataSourceSettings.columns.push({name:t.Columns[i].Name,caption:t.Columns[i].Caption,showNoDataItems:t.Columns[i].ShowNoDataItems,baseField:t.Columns[i].BaseField,baseItem:t.Columns[i].BaseItem,showFilterIcon:t.Columns[i].ShowFilterIcon,showSortIcon:t.Columns[i].ShowSortIcon,showEditIcon:t.Columns[i].ShowEditIcon,showRemoveIcon:t.Columns[i].ShowRemoveIcon,showSubTotals:t.Columns[i].ShowValueTypeIcon,allowDragAndDrop:t.Columns[i].AllowDragAndDrop,axis:t.Columns[i].Axis,dataType:t.Columns[i].DataType,isCalculatedField:t.Columns[i].IsCalculatedField,showValueTypeIcon:t.Columns[i].ShowValueTypeIcon,type:t.Columns[i].Type,expandAll:t.Columns[i].expandAll});for(i=0;i<t.FormatSettings.length;i++)n.dataSourceSettings.formatSettings.push({name:t.FormatSettings[i].Name,format:t.FormatSettings[i].Format,type:t.FormatSettings[i].Type,currency:t.FormatSettings[i].Currency,maximumFractionDigits:t.FormatSettings[i].MaximumFractionDigits,maximumSignificantDigits:t.FormatSettings[i].MaximumSignificantDigits,minimumFractionDigits:t.FormatSettings[i].MinimumFractionDigits,minimumIntegerDigits:t.FormatSettings[i].MinimumIntegerDigits,minimumSignificantDigits:t.FormatSettings[i].MinimumSignificantDigits,skeleton:t.FormatSettings[i].Skeleton,useGrouping:t.FormatSettings[i].UseGrouping})},t.generateUUID=function(){var n=(new Date).getTime(),t=performance&&performance.now&&1e3*performance.now()||0;return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(i){var r=16*Math.random();return n>0?(r=(n+r)%16|0,n=Math.floor(n/16)):(r=(t+r)%16|0,t=Math.floor(t/16)),("x"===i?r:3&r|8).toString(16)})},t.applyCustomSort=function(n,t,i,r,u){var c,l,o,a,f,h,e,s;for(l=n.IsOrderChanged?n.members:"Ascending"===n.sortOrder||"None"===n.sortOrder||void 0===n.sortOrder?[].concat(n.members):[].concat(n.members).reverse(),o=[],a=void 0===i||"string"===i||"number"===i,"Grand Total"===t[0].actualText&&(c=t[0],t.shift()),f=0,h=0;f<t.length;f++){if(e=t[f],s=u?e.formattedText:a?e.actualText:!0===i?e.actualText.toString():e.dateText,l[h]===s){if(t.splice(h++,0,e),t.splice(++f,1),!(h<l.length)){r||o.splice(--h,0,s);break}f=-1}f>=0&&!r&&(o[f]=s)}if(!r){for(f=o.length;f<t.length;f++)e=t[f],s=u?e.formattedText:a?e.actualText:!0===i?e.actualText.toString():e.dateText,o[f]=s;"Grand Total"===o[o.length-1]&&o.pop();n.members=o}return c&&t.splice(0,0,c),t},t.applyHeadersSort=function(n,t,i){return"datetime"===i||"date"===i||"time"===i?"Ascending"===t?n.sort(function(n,t){return n.dateText>t.dateText?1:t.dateText>n.dateText?-1:0}):"Descending"===t?n.sort(function(n,t){return n.dateText<t.dateText?1:t.dateText<n.dateText?-1:0}):n:!0===i?"Ascending"===t?n.sort(function(n,t){return"Grand Total"===n.actualText||"Grand Total"===t.actualText?0:"Out of Range"===n.actualText?1:"Out of Range"===t.actualText?-1:Number(n.actualText.toString().match(/\d+/))>Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))>Number(n.actualText.toString().match(/\d+/))?-1:0}):"Descending"===t?n.sort(function(n,t){return"Grand Total"===n.actualText||"Grand Total"===t.actualText?0:"Out of Range"===n.actualText?-1:"Out of Range"===t.actualText||Number(n.actualText.toString().match(/\d+/))<Number(t.actualText.toString().match(/\d+/))?1:Number(t.actualText.toString().match(/\d+/))<Number(n.actualText.toString().match(/\d+/))?-1:0}):n:"Ascending"===t?n.sort(function(n,t){return"Grand Total"===n.actualText||"Grand Total"===t.actualText?0:n.actualText>t.actualText?1:t.actualText>n.actualText?-1:0}):"Descending"===t?n.sort(function(n,t){return"Grand Total"===n.actualText||"Grand Total"===t.actualText?0:n.actualText<t.actualText?1:t.actualText<n.actualText?-1:0}):n},t.frameHeaderWithKeys=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],t++;return r},t.getPageSize=function(n){switch(n){case"Letter":return new a.SizeF(612,792);case"Note":return new a.SizeF(540,720);case"Legal":return new a.SizeF(612,1008);case"A0":return new a.SizeF(2380,3368);case"A1":return new a.SizeF(1684,2380);case"A2":return new a.SizeF(1190,1684);case"A3":return new a.SizeF(842,1190);case"A5":return new a.SizeF(421,595);case"A6":return new a.SizeF(297,421);case"A7":return new a.SizeF(210,297);case"A8":return new a.SizeF(148,210);case"A9":return new a.SizeF(105,148);case"B0":return new a.SizeF(2836,4008);case"B1":return new a.SizeF(2004,2836);case"B2":return new a.SizeF(1418,2004);case"B3":return new a.SizeF(1002,1418);case"B4":return new a.SizeF(709,1002);case"B5":return new a.SizeF(501,709);case"Archa":return new a.SizeF(648,864);case"Archb":return new a.SizeF(864,1296);case"Archc":return new a.SizeF(1296,1728);case"Archd":return new a.SizeF(1728,2592);case"Arche":return new a.SizeF(2592,3456);case"Flsa":return new a.SizeF(612,936);case"HalfLetter":return new a.SizeF(396,612);case"Letter11x17":return new a.SizeF(792,1224);case"Ledger":return new a.SizeF(1224,792);default:return new a.SizeF(595,842)}},t}(),we=function(){return we=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n},we.apply(this,arguments)},ls=function(){function t(){this.aggregatedValueMatrix=[];this.valueContent=[];this.formatFields={};this.groupingFieldsInfo={};this.dateFormatFunction={};this.calculatedFields={};this.calculatedFormulas={};this.valueAxis=0;this.saveDataHeaders={};this.columnCount=0;this.rowCount=0;this.columnPageCount=0;this.rowPageCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.rowStartPos=0;this.colStartPos=0;this.enableValueSorting=!1;this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0};this.rMembers=[];this.cMembers=[];this.groupingFields={};this.isLastHeaderHasMeasures=!0;this.measureIndex=-1;this.isPagingOrVirtualizationEnabled=!1;this.valueMatrix=[];this.indexMatrix=[];this.memberCnt=-1;this.pageInLimit=!1;this.endPos=0;this.removeCount=0;this.colHdrBufferCalculated=!1;this.colValuesLength=1;this.rowValuesLength=1;this.slicedHeaders=[];this.fieldFilterMem={};this.filterPosObj={};this.selectedHeaders={selectedHeader:[],values:[]};this.rowGrandTotal=null;this.columnGrandTotal=null;this.removeRowGrandTotal=!1;this.removeColumnGrandTotal=!1;this.isValueHasAdvancedAggregate=!1;this.rawIndexObject={};this.valueAxisFields={};this.reformAxisCount=0;this.isEditing=!1;this.data=[];this.actualData=[];this.groupRawIndex={};this.fieldKeys={};this.allowDataCompression=!1;this.dataSourceSettings={};this.frameHeaderObjectsCollection=!1;this.headerObjectsCollection={};this.columnKeys={};this.fieldDrillCollection={};this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i;this.measureNames={};this.enablePaging=!1;this.enableVirtualization=!1;this.enableHtmlSanitizer=!1;this.isParentLevelAdded=!0}return t.prototype.clearProperties=function(){this.isPagingOrVirtualizationEnabled||(this.columnKeys={},this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0});this.enableValueSorting&&(this.valueContent=[]);this.saveDataHeaders=this.allowValueFilter?this.saveDataHeaders:{};this.rMembers=[];this.cMembers=[];this.slicedHeaders=[];this.fieldFilterMem={};this.filterPosObj={};this.selectedHeaders={selectedHeader:[],values:[]};this.rowGrandTotal=null;this.columnGrandTotal=null;this.rawIndexObject={};this.dataSourceSettings.valueIndex>-1&&(this.valueAxisFields={});this.headerObjectsCollection={};this.fieldDrillCollection={}},t.prototype.renderEngine=function(t,i,u,f){var l,e,s,h,c,o;if(this.getValueCellInfo=u,this.getHeaderSortInfo=f,this.formatFields={},this.dateFormatFunction={},this.calculatedFields={},this.calculatedFormulas={},this.valueAxis=0,this.saveDataHeaders={},this.columnCount=0,this.rowCount=0,this.columnPageCount=0,this.rowPageCount=0,this.colFirstLvl=0,this.rowFirstLvl=0,this.rowStartPos=0,this.colStartPos=0,this.dataSourceSettings.excludeFields=n.isNullOrUndefined(t.excludeFields)?[]:t.excludeFields,this.enableValueSorting=!1,this.headerCollection={rowHeaders:[],columnHeaders:[],rowHeadersCount:0,columnHeadersCount:0},this.valueMatrix=[],this.indexMatrix=[],this.aggregatedValueMatrix=[],this.rMembers=[],this.cMembers=[],this.memberCnt=-1,this.pageInLimit=!1,this.endPos=0,this.removeCount=0,this.colHdrBufferCalculated=!1,this.colValuesLength=1,this.rowValuesLength=1,this.slicedHeaders=[],this.fieldFilterMem={},this.filterPosObj={},this.selectedHeaders={selectedHeader:[],values:[]},this.rowGrandTotal=null,this.columnGrandTotal=null,this.removeRowGrandTotal=!1,this.removeColumnGrandTotal=!1,this.isValueHasAdvancedAggregate=!1,this.rawIndexObject={},this.isLastHeaderHasMeasures=!0,this.isEditing=!1,this.globalize=i&&i.globalize?i.globalize:new n.Internationalization,this.currencyCode=i&&i.currenyCode?i.currenyCode:void 0,this.localeObj=i?i.localeObj:void 0,this.fieldsType=i?i.fieldsType:{},this.clonedReport=i?i.clonedReport&&i.clonedReport.properties?i.clonedReport.properties:i.clonedReport:{},this.enablePaging=i.enablePaging,this.enableVirtualization=i.enableVirtualization,this.enableHtmlSanitizer=i.enableHtmlSanitizer,this.isPagingOrVirtualizationEnabled=this.enablePaging||this.enableVirtualization,this.enableSort=t.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=t.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!n.isNullOrUndefined(t.showHeaderWhenEmpty)||t.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!n.isNullOrUndefined(t.showSubTotals)||t.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!n.isNullOrUndefined(t.showRowSubTotals)||t.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!n.isNullOrUndefined(t.showColumnSubTotals)||t.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!n.isNullOrUndefined(t.showGrandTotals)||t.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=n.isNullOrUndefined(t.grandTotalsPosition)?"Bottom":t.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!n.isNullOrUndefined(t.showRowGrandTotals)||t.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!n.isNullOrUndefined(t.showColumnGrandTotals)||t.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&"Top"===t.subTotalsPosition,this.showSubTotalsAtBottom=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&"Bottom"===t.subTotalsPosition,this.allowValueFilter=t.allowValueFilter,this.isValueFilterEnabled=!1,this.enableValueSorting=!!i&&i.enableValueSorting,this.isDrillThrough=!!i&&!!i.isDrillThrough&&i.isDrillThrough,this.valueContent=[],this.dataSourceSettings=r.getClonedDataSourceSettings(t),t.dataSource instanceof ut.DataManager||(this.data=t.dataSource),this.data&&this.data[0]){if(!this.fieldList)for(this.fields="CSV"===t.type?this.data.shift():Object.keys(this.data[0]),e=0;e<this.fields.length;e++)this.fieldKeys[this.fields[e]]="CSV"===t.type?e:this.fields[e];for(i&&i.pageSettings&&i.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(t)),this.dataSourceSettings.rows=t.rows?t.rows:[],this.dataSourceSettings.columns=t.columns?t.columns:[],this.dataSourceSettings.filters=t.filters?t.filters:[],this.dataSourceSettings.values=t.values?t.values:[],this.dataSourceSettings.formatSettings=t.formatSettings?t.formatSettings:[],this.dataSourceSettings.groupSettings=t.groupSettings?t.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[],this.enableSort=void 0===t.enableSorting||t.enableSorting,this.dataSourceSettings.fieldMapping=t.fieldMapping?t.fieldMapping:[],s=0,h=this.dataSourceSettings.values;s<h.length;s++)c=h[s],this.valueAxisFields[c.name]=c;for(l=this.getGroupData(this.data),e=0;e<this.fields.length;e++)this.fieldKeys[this.fields[e]]="CSV"===t.type?e:this.fields[e];for(this.validateFilters(t),this.isExpandAll=!(!this.isValueFiltersAvail||!t.allowValueFilter)||t.expandAll,this.drilledMembers=t.drilledMembers?this.isValueFiltersAvail&&t.allowValueFilter?[]:t.drilledMembers:[],this.isMultiMeasures=this.dataSourceSettings.values.length>1,this.valueAxis="row"===t.valueAxis?1:0,this.measureIndex=n.isNullOrUndefined(t.valueIndex)?-1:t.valueIndex,this.emptyCellTextContent=t.emptyCellsTextContent?t.emptyCellsTextContent:"",this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.valueSortSettings=t.valueSortSettings||{rowOrder:"None",rowHeader:"",columnOrder:"None",columnHeader:"",headerDelimiter:".",columnIndex:void 0},this.valueSortData=[],this.pageSettings=i?i.pageSettings?i.pageSettings:this.pageSettings:void 0,this.allowDataCompression=i&&i.allowDataCompression,this.savedFieldList=i?i.savedFieldList:void 0,this.getFieldList(l,this.enableSort,t.allowValueFilter),this.removeIrrelevantFields(Object.keys(this.fieldList)),this.fillFieldMembers(this.data,this.indexMatrix),this.updateSortSettings(t.sortSettings,this.enableSort),this.valueMatrix=this.generateValueMatrix(this.data),this.filterMembers=[],o=this.dataSourceSettings.columns.length-1,this.columnKeys={};o>-1;)this.columnKeys[this.dataSourceSettings.columns[o].name]=this.dataSourceSettings.columns[o],o--;this.updateFilterMembers(t);this.generateGridData(t)}},t.prototype.removeIrrelevantFields=function(t){var i={},r,u,f;for(i[0]=this.dataSourceSettings.rows,i[1]=this.dataSourceSettings.columns,i[2]=this.dataSourceSettings.values,i[3]=this.dataSourceSettings.filters,r=0;r<4;){if(i[r])for(u=0;u<i[r].length;u++)f=i[r][u].name,this.dataSourceSettings.excludeFields.indexOf(f)>-1||!n.isNullOrUndefined(t)&&-1===t.indexOf(f)?(i[r].splice(u,1),u--):2===r&&(this.measureNames[f]=i[r][u].caption?i[r][u].caption:f,this.measureNames[i[r][u].caption?i[r][u].caption:f]=f);r++}this.isMultiMeasures=this.dataSourceSettings.values.length>1;this.measureIndex=-1===this.measureIndex?this.valueAxis?i[0].length:i[1].length:this.measureIndex},t.prototype.updateDataSourceSettings=function(t,i){i&&(this.emptyCellTextContent=t.emptyCellsTextContent?t.emptyCellsTextContent:"",this.valueAxis="row"===t.valueAxis?1:0,this.rowValuesLength=1===this.valueAxis?this.dataSourceSettings.values.length:1,this.colValuesLength=0===this.valueAxis?this.dataSourceSettings.values.length:1,this.measureIndex=n.isNullOrUndefined(t.valueIndex)?-1:t.valueIndex,this.enableSort=t.enableSorting,this.dataSourceSettings.alwaysShowValueHeader=t.alwaysShowValueHeader,this.dataSourceSettings.showHeaderWhenEmpty=!!n.isNullOrUndefined(t.showHeaderWhenEmpty)||t.showHeaderWhenEmpty,this.dataSourceSettings.showSubTotals=!!n.isNullOrUndefined(t.showSubTotals)||t.showSubTotals,this.dataSourceSettings.showRowSubTotals=!!n.isNullOrUndefined(t.showRowSubTotals)||t.showRowSubTotals,this.dataSourceSettings.showColumnSubTotals=!!n.isNullOrUndefined(t.showColumnSubTotals)||t.showColumnSubTotals,this.dataSourceSettings.showGrandTotals=!!n.isNullOrUndefined(t.showGrandTotals)||t.showGrandTotals,this.dataSourceSettings.grandTotalsPosition=n.isNullOrUndefined(t.grandTotalsPosition)?"Bottom":t.grandTotalsPosition,this.dataSourceSettings.showRowGrandTotals=!!n.isNullOrUndefined(t.showRowGrandTotals)||t.showRowGrandTotals,this.dataSourceSettings.showColumnGrandTotals=!!n.isNullOrUndefined(t.showColumnGrandTotals)||t.showColumnGrandTotals,this.showSubTotalsAtTop=this.dataSourceSettings.showSubTotals&&"Top"===t.subTotalsPosition&&t.showColumnSubTotals,this.showSubTotalsAtBottom=this.dataSourceSettings.showSubTotals&&"Bottom"===t.subTotalsPosition&&t.showRowSubTotals,this.allowValueFilter=t.allowValueFilter,this.dataSourceSettings.formatSettings=t.formatSettings?t.formatSettings:[],this.dataSourceSettings.groupSettings=t.groupSettings?t.groupSettings:[],this.dataSourceSettings.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[],this.enableSort=void 0===t.enableSorting||t.enableSorting,this.dataSourceSettings.fieldMapping=t.fieldMapping?t.fieldMapping:[],this.removeIrrelevantFields(Object.keys(this.fieldList)))},t.prototype.getGroupedRawData=function(t){var a,y,k,o,b,f,v,h;for(this.data=[],a=0,y=this.actualData;a<y.length;a++)k=y[a],this.data[this.data.length]=r.frameHeaderWithKeys(k);var c=t.values.filter(function(n){return"Count"===n.type||"DistinctCount"===n.type}).map(function(n){return n.name}),it=c.length>0,d=this.data,g=t.rows.concat(t.columns.concat(t.filters)).map(function(n){return n.name}),p={},nt=[];this.groupRawIndex={};for(var tt={},w=0,l=0;l<d.length;l++){if(o=d[l],b=[],it)for(f=0;f<c.length;f++)o[this.fieldKeys[c[f]]]=n.isNullOrUndefined(o[this.fieldKeys[c[f]]])?o[this.fieldKeys[c[f]]]:1;for(v=0;v<g.length;v++)b.push(o[this.fieldKeys[g[v]]]);if(h=b.join("-"),p[h]){for(f=0;f<t.values.length;f++){var i=t.values[f].name,s=o[this.fieldKeys[i]],u=p[h],e=t.values[f].type;n.isNullOrUndefined(s)||("number"==typeof s&&"DistinctCount"!==e||(e="Count"),n.isNullOrUndefined(u[i])?u[i]="Product"===e?1:"Min"===e||"Max"===e?void 0:0:"number"!=typeof u[i]&&(u[i]=1),"Count"===e?u[i]+=1:"Min"===e?n.isNullOrUndefined(u[i])||(u[i]=u[i]>s?s:u[i]):"Max"===e?n.isNullOrUndefined(u[i])||(u[i]=u[i]<s?s:u[i]):"Product"===e?u[i]*=s:u[i]+=s)}this.isDrillThrough&&this.groupRawIndex[tt[h]].push(l)}else p[h]=o,nt.push(o),this.isDrillThrough&&(this.groupRawIndex[w]=[l],tt[h]=w,w++)}return nt},t.prototype.getGroupData=function(t){for(var o,f=this,u=t[0],h=function(e){var s=e.name,st=e.caption,w,ni,li,l,g,h,tr,ti,rr,ht,ur,ri,v,nt,c,it,fi,kt,k,dt,or,sr,pt,y,gt,rt,lt,hr,ot,ut,wi,oi,si,bi,hi,ki,at,cr,lr,vt,wt,di,ci;if(!(i.fields.indexOf(s)>-1))return{value:u};if(w={},ni=void 0,"Date"===e.type&&i.groupingFields[s]||"Custom"===e.type&&i.groupingFields[s])return{value:u};if("Number"===e.type){if("number"!==r.getType(u[s])&&i.groupingFields[s])return{value:u};e.rangeInterval&&t.sort(function(n,t){return Number(n[f.fieldKeys[s]])>Number(t[f.fieldKeys[s]])?1:Number(t[f.fieldKeys[s]])>Number(n[f.fieldKeys[s]])?-1:0})}for(li=t.length;li--;){if(l=t[li],l[i.fieldKeys[s]]&&"Date"===e.type){if(g=new Date(l[i.fieldKeys[s]].toString()),!n.isNullOrUndefined(g)&&e.groupInterval.length>0)for(h=0,tr=e.groupInterval.length;h<tr;h++){var ft=e.groupInterval[h],tt=i.getRange(e,g.getTime()),yt=r.resetTime(new Date);switch(ft){case"Years":w[o=h===e.groupInterval.length-1?s:s+"_date_group_years"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setFullYear(g.getFullYear())).toString();break;case"Quarters":w[o=h===e.groupInterval.length-1?s:s+"_date_group_quarters"]=ft;ti=Math.ceil((g.getMonth()+1)/3);i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:(i.localeObj?i.localeObj.getConstant("qtr"):"Qtr")+ti.toString();break;case"QuarterYear":w[o=h===e.groupInterval.length-1?s:s+"_date_group_quarterYear"]=ft;ti=Math.ceil((g.getMonth()+1)/3);i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:(i.localeObj?i.localeObj.getConstant("qtr"):"Qtr")+ti.toString()+" "+(i.localeObj?i.localeObj.getConstant("of"):"of")+" "+g.getFullYear().toString();break;case"Months":w[o=h===e.groupInterval.length-1?s:s+"_date_group_months"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setMonth(g.getMonth(),1)).toString();break;case"Days":w[o=h===e.groupInterval.length-1?s:s+"_date_group_days"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setMonth(g.getMonth(),g.getDate())).toString();break;case"Hours":w[o=h===e.groupInterval.length-1?s:s+"_date_group_hours"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setHours(g.getHours())).toString();break;case"Minutes":w[o=h===e.groupInterval.length-1?s:s+"_date_group_minutes"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setMinutes(g.getMinutes())).toString();break;case"Seconds":w[o=h===e.groupInterval.length-1?s:s+"_date_group_seconds"]=ft;i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o;-1===i.fields.indexOf(o)&&i.fields.push(o);l[i.fieldKeys[o]]=tt?void 0:new Date(yt.setSeconds(g.getSeconds())).toString()}}}else if(isNaN(Number(l[i.fieldKeys[s]]))||"Number"!==e.type){if(l[i.fieldKeys[s]]&&"Custom"===e.type&&e.customGroups&&e.customGroups.length>0){var o=s+"_custom_group",ir=e.customGroups,ii=void 0;for(i.groupingFieldsInfo[s]=s,i.groupingFieldsInfo[o]=s,h=0,rr=ir.length;h<rr;h++)ht=ir[h],ht.items&&ht.items.length>1&&(ni=o,i.fieldKeys[o]="CSV"===i.dataSourceSettings.type?i.fieldKeys[o]?i.fieldKeys[o]:i.fields.length:o,-1===i.fields.indexOf(o)&&i.fields.push(o),ur=-1!==r.inArray(l[i.fieldKeys[s]].toString(),ht.items),l[i.fieldKeys[o]]=ur?ht.groupName&&""!==ht.groupName?ht.groupName:i.localeObj.getConstant("group")+" "+h:ii&&ii!==l[i.fieldKeys[s]].toString()?ii:l[i.fieldKeys[s]].toString(),ii=l[i.fieldKeys[o]])}}else tt=i.getRange(e,Number(l[i.fieldKeys[s]])),l[i.fieldKeys[s]]=tt?void 0:l[i.fieldKeys[s]];for(var bt=[],ai=0,fr=oi=Object.keys(l);ai<fr.length;ai++)ri=fr[ai],bt.push(!!l[ri]);u=-1===bt.indexOf(!1)&&oi.length===Object.keys(t[0]).length?l:u}if("Date"===e.type){for(var et=!1,ui=[i.dataSourceSettings.rows,i.dataSourceSettings.columns,i.dataSourceSettings.values,i.dataSourceSettings.filters],d=Object.keys(w),b=Object.keys(d).length,a=void 0,vi=0,er=ui;vi<er.length;vi++)if(v=er[vi],!et&&v){for(nt=v.length,h=0;h<nt;){if(v[h].name===s){for(et=!0,c=v[h],v.splice(h,1),vt=(vt=i.dataSourceSettings.rows).concat(i.dataSourceSettings.columns,i.dataSourceSettings.values,i.dataSourceSettings.filters);b--;)it=c.caption?c.caption:c.name,i.clonedReport&&(fi=i.clonedReport.rows,fi=fi.concat(i.clonedReport.columns,i.clonedReport.values,i.clonedReport.filters),kt=r.getFieldByName(d[b],fi),kt&&(it=kt.caption?kt.caption:kt.name)),r.getFieldByName(d[b],vt)||(a=w[d[b]],it=-1!==it.indexOf(" (")&&-1!==it.indexOf(")")?it.slice(it.indexOf("(")+1,it.length-1):it,k={name:d[b],caption:(i.localeObj?i.localeObj.getConstant(a):a)+" ("+it+")",type:"Count",showNoDataItems:c.showNoDataItems,baseField:c.baseField,baseItem:c.baseItem,showFilterIcon:c.showFilterIcon,showSortIcon:c.showSortIcon,showEditIcon:c.showEditIcon,showRemoveIcon:c.showRemoveIcon,showSubTotals:c.showValueTypeIcon,allowDragAndDrop:c.allowDragAndDrop,expandAll:c.expandAll,groupName:c.groupName},v.splice(h,0,k),i.groupingFieldsInfo[k.name]=s);break}if(v[h].name.indexOf(s)>-1){var vr=w[v[h].name],ct=v.filter(function(n){return n.name===s})[0],yr=-1!==ct.caption.indexOf(" (")&&-1!==ct.caption.indexOf(")")?ct.caption.slice(ct.caption.indexOf("(")+1,ct.caption.length-1):ct.caption;v[h].caption=(i.localeObj?i.localeObj.getConstant(vr):ct)+" ("+yr+")"}h++}if(et)break}for(b=Object.keys(d).length,dt=(at=i.getMappingField(s,i.clonedReport?i.clonedReport.fieldMapping:i.dataSourceSettings.fieldMapping)).caption?at.caption:s;b--;){for(a=w[d[b]],h=0,or=i.dataSourceSettings.formatSettings.length;h<or;h++)if(i.dataSourceSettings.formatSettings[h].name===d[b]){i.dataSourceSettings.formatSettings.splice(h,1);break}"Quarters"!==a&&"QuarterYear"!==a&&(sr={name:d[b],type:["Years","Months","Days"].indexOf(a)>-1?"date":"time",format:"Years"===a?"yyyy":"Months"===a?"MMM":"Days"===a?"d-MMM":"Hours"===a?"hh a":"Minutes"===a?":mm":"Seconds"===a?":ss":void 0},i.dataSourceSettings.formatSettings.push(sr));et||(pt=i.getMappingField(d[b],i.dataSourceSettings.fieldMapping),d[b]!==s&&n.isNullOrUndefined(pt.name)?(k={name:d[b],caption:(i.localeObj?i.localeObj.getConstant(a):a)+" ("+dt+")"},i.dataSourceSettings.fieldMapping.push(k),i.groupingFieldsInfo[k.name]=s):d[b]!==s&&(pt.caption=(i.localeObj?i.localeObj.getConstant(a):a)+" ("+dt+")"))}et||(pt=i.getMappingField(s,i.dataSourceSettings.fieldMapping),a=w[s],d[b]!==s&&n.isNullOrUndefined(pt.name)?(k={name:s,caption:(i.localeObj?i.localeObj.getConstant(a):a)+" ("+dt+")"},i.dataSourceSettings.fieldMapping.push(k),i.groupingFieldsInfo[k.name]=s):pt.caption=(i.localeObj?i.localeObj.getConstant(a):a)+" ("+dt+")")}else if("Number"===e.type&&e.rangeInterval){var ei=void 0,yi=[],pr=[],pi=t.length;for(nt=0,i.groupingFields[s]=s,y=[];nt<pi;)gt=Number(t[nt][s]),pr.push(gt),isNaN(gt)||-1!==yi.indexOf(gt)||yi.push(gt),nt++;for(pi=t.length,nt=0;nt<pi;){if(rt=t[nt],rt&&!isNaN(Number(rt[s]))){if(ei=("string"==typeof e.endingAt?parseInt(e.endingAt,10):e.endingAt)||Math.max.apply(Math,yi),lt=Math.round(Number(rt[s])),hr=Math.round(lt+(e.rangeInterval-1)),lt>=y[0]&&lt<=y[y.length-1])ot=y[0],ut=y[y.length-1],rt[s]=i.getNumberGroupHeaders(ot,ut,ei);else if(0===y.length){for(h=lt;h<=hr;h++)y.push(h);ot=y[0];ut=y[y.length-1];rt[s]=i.getNumberGroupHeaders(ot,ut,ei)}else for(ut=(ot=y[y.length-1]+1)+(e.rangeInterval-1),wi=!0,y.splice(0,y.length);wi;)lt>=ot&&lt<=ut&&(rt[s]=i.getNumberGroupHeaders(ot,ut,ei),y.push(ot),y.push(ut),wi=!1),ut=(ot=ut+1)+(e.rangeInterval-1);for(bt=[],si=0,bi=oi=Object.keys(rt);si<bi.length;si++)ri=bi[si],bt.push(!!rt[ri]);u=-1===bt.indexOf(!1)&&oi.length===Object.keys(t[0]).length?rt:u}nt++}for(hi=0,ki=ui=[i.dataSourceSettings.rows,i.dataSourceSettings.columns,i.dataSourceSettings.values,i.dataSourceSettings.filters];hi<ki.length;hi++)cr=ki[hi],(at=r.getFieldByName(s,cr))&&((at=at.properties?at.properties:at).type="Count");for(h=0,lr=i.dataSourceSettings.formatSettings.length;h<lr;h++)if(i.dataSourceSettings.formatSettings[h].name===s){i.dataSourceSettings.formatSettings.splice(h,1);break}}else if("Custom"===e.type&&ni){wt=ni;et=!1;ui=[i.dataSourceSettings.rows,i.dataSourceSettings.columns,i.dataSourceSettings.values,i.dataSourceSettings.filters];vt=(vt=i.dataSourceSettings.rows).concat(i.dataSourceSettings.columns,i.dataSourceSettings.values,i.dataSourceSettings.filters);di=[];st&&""!==st||(di=wt.match(/_custom_group/g));for(var gi=r.getFieldByName(s.replace(/_custom_group/g,""),vt),p=r.getFieldByName(wt,vt),nr=0,ar=ui;nr<ar.length;nr++)if(v=ar[nr],!et&&v){for(nt=v.length,h=0;h<nt;){if(v[h].name===e.name&&!p){et=!0;c=v[h];k={name:wt,caption:st&&""!==st?st:(gi.caption?gi.caption:gi.name)+(di.length+1),type:"Count",showNoDataItems:c.showNoDataItems,baseField:c.baseField,baseItem:c.baseItem,showSubTotals:c.showValueTypeIcon,allowDragAndDrop:c.allowDragAndDrop,showFilterIcon:c.showFilterIcon,showSortIcon:c.showSortIcon,showRemoveIcon:c.showRemoveIcon,showEditIcon:c.showEditIcon,expandAll:c.expandAll,groupName:c.groupName};v.splice(h,0,k);i.groupingFieldsInfo[k.name]=s;i.groupingFieldsInfo[s]=s;break}if(v[h].name===wt&&p){k={name:p.name,caption:st&&""!==st?st:p.caption,type:p.type,showNoDataItems:p.showNoDataItems,baseField:p.baseField,baseItem:p.baseItem,showRemoveIcon:p.showRemoveIcon,showSubTotals:p.showValueTypeIcon,allowDragAndDrop:p.allowDragAndDrop,showFilterIcon:p.showFilterIcon,showSortIcon:p.showSortIcon,showEditIcon:p.showEditIcon,expandAll:p.expandAll,groupName:p.groupName};v.splice(h,1,k);i.groupingFieldsInfo[k.name]=s;i.groupingFieldsInfo[s]=s;break}h++}if(et)break}ci=r.getFieldByName(s,r.cloneFormatSettings(i.dataSourceSettings.formatSettings));ci&&(ci.name=wt,i.dataSourceSettings.formatSettings.push(ci));i.groupingFields[s]=s}i.groupingFields=n.extend(i.groupingFields,w)},i=this,e=0,s=this.dataSourceSettings.groupSettings;e<s.length;e++)if(o=h(s[e]),"object"==typeof o)return o.value;return u},t.prototype.getNumberGroupHeaders=function(n,t,i){return n===t?n.toString():i>=n&&i<=t?i===n?n.toString():n.toString()+"-"+i.toString():n.toString()+"-"+t.toString()},t.prototype.frameData=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=void 0,t++;return r},t.prototype.getRange=function(n,t){var i,r,u;if("Date"===n.type){var f=new Date(t),e="string"==typeof n.startingAt?new Date(n.startingAt):n.startingAt,o="string"==typeof n.endingAt?new Date(n.endingAt):n.endingAt;i=!!(e&&f.getTime()<e.getTime()||o&&f.getTime()>o.getTime())}else r="string"==typeof n.startingAt?parseInt(n.startingAt,10):n.startingAt,u="string"==typeof n.endingAt?parseInt(n.endingAt,10):n.endingAt,i=!isNaN(r)&&t<r||!isNaN(u)&&t>u;return i},t.prototype.getPercentFormat=function(t,i){var r=n.isNullOrUndefined(t[i])||n.isNullOrUndefined(this.formatFields[i].format)?void 0:this.formatFields[i].format.toLowerCase().match(/p[0-9]/);return n.isNullOrUndefined(r)?2:Number(this.formatFields[i].format.replace(/[^0-9]/g,""))},t.prototype.getFormattedFields=function(){for(var n=this.dataSourceSettings.formatSettings.length;n--;)this.formatFields[this.dataSourceSettings.formatSettings[n].name]=this.dataSourceSettings.formatSettings[n],this.dataSourceSettings.formatSettings[n].type&&(this.dateFormatFunction[this.dataSourceSettings.formatSettings[n].name]={exactFormat:this.globalize.getDateFormat(this.dataSourceSettings.formatSettings[n]),fullFormat:this.globalize.getDateFormat({format:"yyyy/MM/dd/HH/mm/ss",type:this.dataSourceSettings.formatSettings[n].type})})},t.prototype.getFieldList=function(t,i,u){for(var o,a,c,l,s,v,e,f,h=this.dataSourceSettings.excludeFields.length-1;h>-1;)a=this.fields.indexOf(this.dataSourceSettings.excludeFields[h]),-1!==a&&this.fields.splice(a,1),this.fieldList&&delete this.fieldList[this.dataSourceSettings.excludeFields[h]],h--;if(c=this.fields,l=n.extend([],this.dataSourceSettings.rows,null,!0),l=l.concat(this.dataSourceSettings.columns,this.dataSourceSettings.values,this.dataSourceSettings.filters),this.getFormattedFields(l),this.getCalculatedField(c),s=(c=this.fields).length,v=["string","number","datetime","date","boolean"],this.savedFieldList)for(this.fieldList=this.savedFieldList;s--;)e=c[s],f=this.getMappingField(e,this.dataSourceSettings.fieldMapping),this.fieldList[e]?(this.fieldList[e].isSelected=!1,this.fieldList[e].index=s,this.fieldList[e].filter=[],this.fieldList[e].sort=i?"Ascending":"None",this.fieldList[e].isExcelFilter=!1,this.fieldList[e].filterType="",this.fieldList[e].showFilterIcon=!f||!("showFilterIcon"in f)||f.showFilterIcon,this.fieldList[e].showRemoveIcon=!f||!("showRemoveIcon"in f)||f.showRemoveIcon,this.fieldList[e].showSortIcon=!f||!("showSortIcon"in f)||f.showSortIcon,this.fieldList[e].showEditIcon=!f||!("showEditIcon"in f)||f.showEditIcon,this.fieldList[e].showValueTypeIcon=!f||!("showValueTypeIcon"in f)||f.showValueTypeIcon,this.fieldList[e].allowDragAndDrop=!f||!("allowDragAndDrop"in f)||f.allowDragAndDrop,this.fieldList[e].isCalculatedField=!(!f||!("isCalculatedField"in f))&&f.isCalculatedField,this.fieldList[e].showNoDataItems=!(!f||!("showNoDataItems"in f))&&f.showNoDataItems,this.fieldList[e].showSubTotals=!f||!("showSubTotals"in f)||f.showSubTotals,this.fieldList[e].expandAll=!(!f||!("expandAll"in f))&&f.expandAll,this.fieldList[e].pid=f&&"groupName"in f&&f.groupName?f.groupName:this.groupingFieldsInfo[e]?this.groupingFieldsInfo[e]:void 0,this.isValueFiltersAvail&&u&&(this.fieldList[e].dateMember=[],this.fieldList[e].formattedMembers={},this.fieldList[e].members={}),this.updateMembersOrder(e)):(o=f&&"dataType"in f&&f.dataType&&v.indexOf(f.dataType.toLowerCase())>-1?f.dataType.toLowerCase():o,this.fieldList[e]={caption:f&&"caption"in f&&f.caption?f.caption:e,id:e,type:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o,isSelected:!1,sort:i?"Ascending":"None",filterType:"",index:s,filter:[],isCustomField:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group"),showRemoveIcon:!f||!("showRemoveIcon"in f)||f.showRemoveIcon,showFilterIcon:!f||!("showFilterIcon"in f)||f.showFilterIcon,showSortIcon:!f||!("showSortIcon"in f)||f.showSortIcon,showNoDataItems:!(!f||!("showNoDataItems"in f))&&f.showNoDataItems,isCalculatedField:!(!f||!("isCalculatedField"in f))&&f.isCalculatedField,showEditIcon:!f||!("showEditIcon"in f)||f.showEditIcon,showValueTypeIcon:!f||!("showValueTypeIcon"in f)||f.showValueTypeIcon,allowDragAndDrop:!f||!("allowDragAndDrop"in f)||f.allowDragAndDrop,showSubTotals:!f||!("showSubTotals"in f)||f.showSubTotals,expandAll:!(!f||!("expandAll"in f))&&f.expandAll,pid:f&&"groupName"in f&&f.groupName?f.groupName:this.groupingFieldsInfo[e]?this.groupingFieldsInfo[e]:void 0,aggregateType:f&&"type"in f?f.type:"number"===(-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o)?"Sum":"Count",baseField:f&&"baseField"in f?f.baseField:void 0,baseItem:f&&"baseItem"in f?f.baseItem:void 0},this.updateMembersOrder(e));else for(this.fieldList={};s--;)e=c[s],o=(f=this.getMappingField(e,this.dataSourceSettings.fieldMapping))&&"dataType"in f&&f.dataType&&v.indexOf(f.dataType.toLowerCase())>-1?f.dataType.toLowerCase():r.getType(t[this.fieldKeys[e]]),this.fieldList[e]={id:e,pid:f&&"groupName"in f&&f.groupName?f.groupName:this.groupingFieldsInfo[e]?this.groupingFieldsInfo[e]:void 0,caption:f&&"caption"in f&&f.caption?f.caption:e,type:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o,filterType:"",index:s,filter:[],sort:i?"Ascending":"None",isSelected:!1,isCustomField:-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group"),showFilterIcon:!f||!("showFilterIcon"in f)||f.showFilterIcon,showRemoveIcon:!f||!("showRemoveIcon"in f)||f.showRemoveIcon,showSortIcon:!f||!("showSortIcon"in f)||f.showSortIcon,showEditIcon:!f||!("showEditIcon"in f)||f.showEditIcon,showValueTypeIcon:!f||!("showValueTypeIcon"in f)||f.showValueTypeIcon,allowDragAndDrop:!f||!("allowDragAndDrop"in f)||f.allowDragAndDrop,showSubTotals:!f||!("showSubTotals"in f)||f.showSubTotals,showNoDataItems:!(!f||!("showNoDataItems"in f))&&f.showNoDataItems,isCalculatedField:!(!f||!("isCalculatedField"in f))&&f.isCalculatedField,expandAll:!(!f||!("expandAll"in f))&&f.expandAll,aggregateType:f&&"type"in f?f.type:"number"===(-1!==e.indexOf("_custom_group")||-1!==e.indexOf("_date_group")?"string":void 0===o||"undefined"===o?"number":o)?"Sum":"Count",baseField:f&&"baseField"in f?f.baseField:void 0,baseItem:f&&"baseItem"in f?f.baseItem:void 0},this.updateMembersOrder(e);this.updateTreeViewData(l)},t.prototype.updateMembersOrder=function(n){for(var i,t=0,r=this.dataSourceSettings.sortSettings;t<r.length;t++)if(i=r[t],n===i.name&&i.membersOrder){this.fieldList[n].membersOrder=i.membersOrder;break}},t.prototype.getMappingField=function(n,t){var r={},i,u;if(t.length>0)for(i=0,u=t.length;i<u;i++)if(t[i].name===n){r=t[i];break}return r},t.prototype.updateFieldList=function(n){for(var t=this.fields,i=t.length;i--;)this.fieldList[t[i]].isExcelFilter=n[t[i]].isExcelFilter},t.prototype.updateTreeViewData=function(n){for(var i,t=n.length,r=this.dataSourceSettings.calculatedFieldSettings.length;t--;)this.fieldList[n[t].name]&&(i=this.fieldList[n[t].name],i.type=n[t].dataType?n[t].dataType.toLowerCase():i.type,i.caption=n[t].caption?n[t].caption:n[t].name,i.isSelected=!0,i.showNoDataItems=n[t].showNoDataItems,i.aggregateType=n[t].type,i.baseField=n[t].baseField,i.baseItem=n[t].baseItem,i.allowDragAndDrop=n[t].allowDragAndDrop,i.showFilterIcon=n[t].showFilterIcon,i.showSortIcon=n[t].showSortIcon,i.showRemoveIcon=n[t].showRemoveIcon,i.showValueTypeIcon=n[t].showValueTypeIcon,i.showEditIcon=n[t].showEditIcon,i.showSubTotals=n[t].showSubTotals,i.expandAll=n[t].expandAll);for(;r--;)this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name]&&(this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].aggregateType="CalculatedField",this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].isCalculatedField=!0,this.fieldList[this.dataSourceSettings.calculatedFieldSettings[r].name].formula=this.dataSourceSettings.calculatedFieldSettings[r].formula)},t.prototype.getCalculatedField=function(t){for(var i,u=0,f=this.dataSourceSettings.calculatedFieldSettings;u<f.length;u++)i=f[u],this.calculatedFields[i.name]=n.extend({},i,null,!0),this.calculatedFields[i.name].actualFormula=i.formula;for(var o=Object.keys(this.calculatedFields),s=function(n){var i=r.calculatedFields[o[n]],f=i.properties,a=(f?f.formula:i.formula).trim(),s=a.replace(/"/g,""),l;i.formula=s.indexOf("^")>-1?r.powerFunction(s):s;-1===i.formula.indexOf("Math.min(")&&i.formula.indexOf("min(")>-1&&(i.formula=i.formula.replace(/min\(/g,"Math.min("));-1===i.formula.indexOf("Math.max(")&&i.formula.indexOf("max(")>-1&&(i.formula=i.formula.replace(/max\(/g,"Math.max("));-1===i.formula.indexOf("Math.abs(")&&i.formula.indexOf("abs(")>-1&&(i.formula=i.formula.replace(/abs\(/g,"Math.abs("));i.name=f?f.name:i.name;(t=t.filter(function(n){return n!==i.name})).push(i.name);for(var v=a.split('"'),h=0,p=v.length;h<p;h++){var e=v[h].trim(),u=e.split(/[ .:;?!~,`"&|()<>{}\[\]\r\n/\\]+/),y=e.match(/^([^()]+)\((.*)\)$/),c="DistinctCount"===u[0]?"DistinctCount":"PopulationStDev"===u[0]?"PopulationStDev":"SampleStDev"===u[0]?"SampleStDev":"PopulationVar"===u[0]?"PopulationVar":"SampleVar"===u[0]?"SampleVar":u[0];-1!==["Sum","Count","Min","Max","Avg","Product","DistinctCount","PopulationStDev","SampleStDev","PopulationVar","SampleVar","Median"].indexOf(c)&&(l=-1===t.indexOf(u[1])&&y[2]?t.indexOf(y[2]):t.indexOf(u[1]),r.calculatedFormulas[i.name]?r.calculatedFormulas[i.name].push({index:l,type:c,formula:e}):r.calculatedFormulas[i.name]=[{index:l,type:c,formula:e}])}},r=this,e=0,h=o.length;e<h;e++)s(e);this.fields=t},t.prototype.validateFilters=function(t){var e,i,r,u,h;for(this.isValueFiltersAvail=!1,e=t.filterSettings?t.filterSettings:[],i=n.extend([],this.dataSourceSettings.rows,null,!0),i=i.concat(this.dataSourceSettings.columns),r=0,u=e;r<u.length;r++){for(var o=u[r],f=0,s=i;f<s.length;f++)if(h=s[f],o.name===h.name&&"Value"===o.type){this.isValueFiltersAvail=!0;break}if(this.isValueFiltersAvail)break}},t.prototype.validateValueFields=function(){var n,t,i;for(this.isValueHasAdvancedAggregate=!1,n=0,t=this.dataSourceSettings.values;n<t.length;n++)if(i=t[n],-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(i.type)){this.isValueHasAdvancedAggregate=!0;break}},t.prototype.fillFieldMembers=function(t,i){for(var u,r,h,o,a=this.fields,w=t.length,f=this.fieldList,b=a.length,c=0;c<b;c++){u=a[c];f[u].members&&!this.allowDataCompression||(f[u].members={});f[u].formattedMembers&&!this.allowDataCompression||(f[u].formattedMembers={});f[u].dateMember&&!this.allowDataCompression||(f[u].dateMember=[]);for(var s=f[u].members,k=Object.keys(s).length>0,l=f[u].formattedMembers,d=f[u].dateMember,v=0,y=0,p=f[u].expandAll,e=0;e<w;e++)r=t[e][this.fieldKeys[u]],(r=this.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(r):r,k)||(h=r,o=this.pageSettings&&this.formatFields[u]&&!this.valueAxisFields[u]?this.getFormattedValue(r,u):{formattedText:null===r?this.localeObj?this.localeObj.getConstant("null"):String(r):void 0===r?this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(r):r.toString(),actualText:null===r?this.localeObj?this.localeObj.getConstant("null"):String(r):void 0===r?this.localeObj?u in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(r):r},o.formattedText&&(h=o.formattedText),s.hasOwnProperty(r)?s[r].index.push(e):(v++,s[r]={index:[e],ordinal:v,isDrilled:!(!this.isExpandAll&&!p)},d.push({formattedText:o.formattedText,actualText:o.dateText?o.dateText:o.actualText})),l.hasOwnProperty(h)?l[h].index.push(e):(y++,l[h]={index:[e],ordinal:y,isDrilled:!(!this.isExpandAll&&!p)})),i[e]||(i[e]=[]),i[e][c]=s[r].ordinal}},t.prototype.generateValueMatrix=function(t){for(var u,r,e=this.fields,i=t.length,f=[],o=e.length,s=this.fieldList;i--;)for(u=o,f[i]=[];u--;)r=e[u],f[i][u]="number"===s[r].type||n.isNullOrUndefined(t[i][this.fieldKeys[r]])?n.isNullOrUndefined(t[i][this.fieldKeys[r]])?t[i][this.fieldKeys[r]]:isNaN(Number(t[i][this.fieldKeys[r]]))?void 0:Number(t[i][this.fieldKeys[r]]):1;return f},t.prototype.updateSortSettings=function(n,t){for(var i=0,r=n?n.length:0;i<r&&t;i++)this.fieldList[n[i].name]&&(this.fieldList[n[i].name].sort=n[i].order)},t.prototype.updateFilterMembers=function(n){var u=this.filterMembers,i={},f=this.getFilters(n,i),e=this.indexMatrix.length,r,t;if(f)for(r=i.include.index,t=0;t<r.length;t++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[r[t]]||u.push(r[t]);else for(t=0;t<e;t++)void 0!==i.exclude&&void 0!==i.exclude.indexObject[t]||u.push(t)},t.prototype.getFilters=function(n,t){for(var i,u=n.filterSettings?n.filterSettings:[],f=!1,e=[],r=0,o=u.length;r<o;r++)i=u[r].properties?u[r].properties:u[r],this.fieldList[i.name]&&this.fieldList[i.name].isSelected&&this.isValidFilterField(i,n.allowMemberFilter,n.allowLabelFilter)&&(this.applyLabelFilter(i),i&&(e=i.items),i.type&&"Include"===i.type?(this.frameFilterList(e,i.name,t,"include",i.showLabelFilter,f),f=!0):this.frameFilterList(e,i.name,t,"exclude",i.showLabelFilter),i.showLabelFilter&&(i.items=[],i.type=i.showDateFilter?"Date":i.showNumberFilter?"Number":"Label"));return f},t.prototype.isValidFilterField=function(t,i,r){var o=t.name,u=!1,s=n.extend([],this.dataSourceSettings.rows,null,!0),f,h,e,c;if(s=s.concat(this.dataSourceSettings.columns),this.fieldList[o].isSelected&&i&&["Include","Exclude"].indexOf(t.type)>=0){for(u=!0,f=0,h=this.dataSourceSettings.values;f<h.length;f++)if(o===h[f].name){u=!1;break}}else if(r)for(e=0,c=s;e<c.length;e++)if(o===c[e].name&&["Label","Date","Number"].indexOf(t.type)>=0){u=!0;break}return u},t.prototype.applyLabelFilter=function(n){var t,u,f,i,r;if(["Label","Date","Number"].indexOf(n.type)>=0){if(t=Object.keys(this.fieldList[n.name].members),n.showLabelFilter=!0,"Label"===n.type)n.items=this.getLabelFilterMembers(t,n.condition,n.value1,n.value2);else if("Date"===n.type)n.showDateFilter=!0,u="string"==typeof n.value1?new Date(n.value1):n.value1,f="string"==typeof n.value2?new Date(n.value2):n.value2,n.items=this.getDateFilterMembers(t,n.name,n.condition,u,f);else for(n.showNumberFilter=!0,n.items=[],i=0,r=t;i<r.length;i++){var e=r[i],o=this.getParsedValue(n.name,n.value1),s=this.getParsedValue(n.name,n.value2),h=this.getParsedValue(n.name,e);this.validateFilterValue(h,n.condition,o,s)&&n.items.push(e)}n.type=n.condition?["DoesNotBeginWith","DoesNotContains","DoesNotEndsWith","DoesNotEquals","NotBetween"].indexOf(n.condition)>-1&&!n.showNumberFilter?"Exclude":"Include":"Exclude"}else n.showLabelFilter=!1},t.prototype.getLabelFilterMembers=function(n,t,i,r){for(var u,f,e=[],o=0,s=n;o<s.length;o++)if(u=s[o],f=u.toLowerCase(),i.toString())switch(t){case"Equals":case"DoesNotEquals":default:f===i.toLowerCase()&&e.push(u);break;case"BeginWith":case"DoesNotBeginWith":0===f.indexOf(i.toLowerCase())&&e.push(u);break;case"EndsWith":case"DoesNotEndsWith":null!==f.match(i.toLowerCase()+"$")&&e.push(u);break;case"Contains":case"DoesNotContains":f.indexOf(i.toLowerCase())>-1&&e.push(u);break;case"GreaterThan":f>i.toLowerCase()&&e.push(u);break;case"GreaterThanOrEqualTo":f>=i.toLowerCase()&&e.push(u);break;case"LessThan":f<i.toLowerCase()&&e.push(u);break;case"LessThanOrEqualTo":f<=i.toLowerCase()&&e.push(u);break;case"Between":case"NotBetween":f>=i.toLowerCase()&&f<=r.toLowerCase()&&e.push(u)}return e},t.prototype.getDateFilterMembers=function(n,t,i,r,u){for(var f,e,o=[],s=0,h=n;s<h.length;s++)if(f=h[s],e=new Date(f),r)switch(i){case"Equals":case"DoesNotEquals":default:this.getFormattedValue(e.toString(),t).formattedText===this.getFormattedValue(r.toString(),t).formattedText&&o.push(this.getFormattedValue(f,t).formattedText);break;case"After":e.getTime()>r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"AfterOrEqualTo":e.getTime()>=r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"Before":e.getTime()<r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"BeforeOrEqualTo":e.getTime()<=r.getTime()&&o.push(this.getFormattedValue(f,t).formattedText);break;case"Between":case"NotBetween":e.getTime()>=r.getTime()&&e.getTime()<=u.getTime()&&o.push(this.getFormattedValue(f,t).formattedText)}return o},t.prototype.validateFilterValue=function(n,t,i,r){var u=!1;if("number"==typeof i)switch(t){case"Equals":n===i&&(u=!0);break;case"DoesNotEquals":default:n!==i&&(u=!0);break;case"GreaterThan":n>i&&(u=!0);break;case"GreaterThanOrEqualTo":n>=i&&(u=!0);break;case"LessThan":n<i&&(u=!0);break;case"LessThanOrEqualTo":n<=i&&(u=!0);break;case"Between":n>=i&&n<=r&&(u=!0);break;case"NotBetween":n>=i&&n<=r||(u=!0)}return u},t.prototype.frameFilterList=function(n,t,i,r,u,f){i[r]||(i[r]={indexObject:{},index:[]});this.updateFilter(n,t,i,r,u,f)},t.prototype.updateFilter=function(t,i,r,u,f,e){var h=0,l=this.fieldList[i],s,o,c,a;l.filter=t;l.filterType=u;l.isExcelFilter=f;var v=this.formatFields[i]&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1||i in this.groupingFields?l.formattedMembers:l.members,w=e,y={},p={};for(y[u]={indexObject:{},index:[]},this.fieldFilterMem[i]={memberObj:{}};!n.isNullOrUndefined(t[h]);){if(v[t[h]])if(s=v[t[h]].index,"include"===u)for(o=0,c=s.length;o<c;o++)w&&void 0===r[u].indexObject[s[o]]||(y[u].indexObject[s[o]]=s[o],y[u].index.push(s[o]));else{for(o=0,c=s.length;o<c;o++)void 0===r[u].indexObject[s[o]]&&(r[u].indexObject[s[o]]=s[o],r[u].index.push(s[o]));this.fieldFilterMem[i].memberObj[t[h]]=t[h]}h++}if("include"===u){for(r[u]=y[u],o=0;o<t.length;o++)v[t[o]]&&(p[t[o]]=t[o]);for(a=Object.keys(v),o=0,c=a.length;o<c;o++)void 0===p[a[o]]&&(this.fieldFilterMem[i].memberObj[a[o]]=a[o])}},t.prototype.applyValueFiltering=function(t,i,r,u,f,e,o){this.isValueFiltered=!1;var s=n.extend({},"row"===o&&this.rowGrandTotal?this.rowGrandTotal:"column"===o&&this.columnGrandTotal?this.columnGrandTotal:"Top"!==this.dataSourceSettings.grandTotalsPosition?r[r.length-1]:r[0],null,!0);return this.getFilteredData(r,u,f,e,i,t.name,s,o),this.isValueFiltered&&(("row"===o&&null===this.rowGrandTotal||"column"===o&&null===this.columnGrandTotal)&&e.push(s),r=e),r},t.prototype.getFilteredData=function(t,i,r,u,f,e,o,s){for(var v,w,b,k,y=t.length,h=0;h<y;h++)if(r[e])if(t[h].level===f){this.isValueFiltered=!0;this.fieldList[e].isExcelFilter=!0;var l=0,c=r[e].measure,p=this.fieldList[c].index,a=this.fieldList[c].aggregateType;this.rawIndexObject={};l="row"===s?this.getAggregateValue(t[h].index,i.indexObject,p,a,!1):this.getAggregateValue(i.index,t[h].indexObject,p,a,!1);v={fieldName:c,row:t[h],column:i,value:l,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:t[h].hasChild&&t[h].isDrilled?"subTotal":"grand sum"===t[h].type?"grandTotal":"value",columnCellType:i.hasChild&&i.isDrilled?"subTotal":"grand sum"===i.type?"grandTotal":"value",aggregateType:a,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(v);l=v.value;this.rawIndexObject={};w=this.getParsedValue(c,r[e].value1);b=this.getParsedValue(c,r[e].value2);this.validateFilterValue(l,r[e].condition,w,b)||"grand sum"===t[h].type?"grand sum"!==t[h].type&&(u.push(n.extend({},t[h],null,!0)),u[u.length-1].isLevelFiltered=!0):(k=this.removefilteredData(t[h],this.valueFilteredData)||t[h],this.validateFilteredParentData(k,this.valueFilteredData,o,0,f,s))}else t[h].hasChild&&t[h].members.length>0&&"grand sum"!==t[h].type&&(u.push(n.extend({},t[h],null,!0)),u[u.length-1].members=[],u[u.length-1].isLevelFiltered=!0,this.getFilteredData(t[h].members,i,r,u[u.length-1].members,f,e,o,s))},t.prototype.getParsedValue=function(t,i){var u=i?i.toString():"",r;return this.formatFields[t]&&i?(r=n.extend({},this.formatFields[t],null,!0),delete r.name,this.globalize.parseNumber(u,r)):this.globalize.parseNumber(u,{format:"N"})},t.prototype.removefilteredData=function(t,i){for(var f,u=n.extend([],i,null,!0),r=0;r<u.length;r++){if(t.isLevelFiltered&&t.axis===u[r].axis&&t.valueSort.levelName===u[r].valueSort.levelName&&t.actualText===u[r].actualText&&t.axis===u[r].axis&&t.level===u[r].level&&t.ordinal===u[r].ordinal){f=u[r];i.splice(r,1);break}i[r].hasChild&&i[r].members.length>0&&this.removefilteredData(t,i[r].members)}return f},t.prototype.validateFilteredParentData=function(n,t,i,r,u,f){var h,v,e,c,y,o,l,w,a,b;if(t.length>0){for(h=0,v=t;h<v.length;h++)if(e=v[h],e.level===r){if("row"===f)for(c=0,y=s=n.index;c<y.length;c++)o=y[c],i.index.indexOf(o)>=0&&i.index.splice(i.index.indexOf(o),1),n.valueSort.levelName.toString().indexOf(e.valueSort.levelName.toString())>=0&&e.level!==u&&e.index.indexOf(o)>=0&&e.index.splice(e.index.indexOf(o),1);else for(var s=n.indexObject,p=0,k=Object.keys(s);p<k.length;p++)o=k[p],s.hasOwnProperty(o)&&(delete i.indexObject[o],n.valueSort.levelName.toString().indexOf(e.valueSort.levelName.toString())>=0&&e.level!==u&&delete e.indexObject[o]);e&&e.members.length>0&&e.members[0].level===r+1&&e.members[0].level!==u&&this.validateFilteredParentData(n,e.members,i,r+1,u,f)}}else if("row"===f)for(l=0,w=s=n.index;l<w.length;l++)o=w[l],i.index.indexOf(o)>=0&&i.index.splice(i.index.indexOf(o),1);else for(s=n.indexObject,a=0,b=Object.keys(s);a<b.length;a++)o=b[a],s.hasOwnProperty(o)&&delete i.indexObject[o]},t.prototype.updateFramedHeaders=function(t,i,r,u,f){for(var e,o=0,s=t;o<s.length;o++)e=s[o],this.isHeaderAvail=!1,(this.validateFilteredHeaders(e,r,f)||"grand sum"===e.type)&&("row"===f?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength,u.push(n.extend({},e,null,!0)),u[u.length-1].members=[],e.hasChild&&e.isDrilled&&e.members.length>0&&this.updateFramedHeaders(e.members,i,r,u[u.length-1].members,f));return this.filterFramedHeaders},t.prototype.validateFilteredHeaders=function(n,t,i){for(var r,u=0,f=t;u<f.length;u++)if(r=f[u],!this.isHeaderAvail){if(n.actualText===r.actualText&&n.level===r.level&&n.valueSort.levelName===r.valueSort.levelName)return"row"===i?r.index.length>0?(this.isHeaderAvail=!0,n.index=r.index,!0):(this.isHeaderAvail=!1,n.index=r.index,!1):Object.keys(r.indexObject).length>0?(this.isHeaderAvail=!0,n.indexObject=r.indexObject,!0):(this.isHeaderAvail=!1,n.indexObject=r.indexObject,!1);r.hasChild&&r.members.length>0&&"grand sum"!==r.type&&this.validateFilteredHeaders(n,r.members,i)}return this.isHeaderAvail},t.prototype.isEmptyDataAvail=function(n,t){this.isEmptyData=!1;n.length>0&&"grand sum"===n[n.length-1].type&&0===n[n.length-1].index.length&&(this.isEmptyData=!0);t.length>0&&"grand sum"===t[t.length-1].type&&0===Object.keys(t[t.length-1].indexObject).length&&(this.isEmptyData=!0);0!==n.length&&0!==t.length||(this.isEmptyData=!0)},t.prototype.updateGridData=function(n){var t,r,i;for(this.updateDataSourceSettings(n,!0),this.data=n.dataSource,this.allowDataCompression&&(this.actualData=this.data,this.data=this.getGroupedRawData(n)),this.indexMatrix=[],t=0,r=this.fields;t<r.length;t++)i=r[t],this.fieldList[i].members={},this.fieldList[i].formattedMembers={},this.fieldList[i].dateMember=[];this.fillFieldMembers(this.data,this.indexMatrix);this.valueMatrix=this.generateValueMatrix(this.data);this.filterMembers=[];this.cMembers=[];this.rMembers=[];this.updateFilterMembers(n);this.isEditing=!0;this.isDrillThrough=!0;this.generateGridData(n);this.isEditing=!1},t.prototype.generateGridData=function(t,i,u){var y,o,c,l,ft,k,et,a,v,p,lt,at;void 0===i&&(i=!1);this.updateDataSourceSettings(t,i);var f=t.columns?t.columns:[],b=this.data,e=t.rows?t.rows:[],ot=t.filterSettings,g=t.values?t.values:[];if(this.removeCount=0,this.isExpandAll=t.expandAll,this.drilledMembers=t.drilledMembers?t.drilledMembers:[],this.isEmptyData=!1,y=[],e[0]&&e[0].showNoDataItems||f[0]&&f[0].showNoDataItems)for(o=0;o<this.indexMatrix.length;o++)y.push(o);for(o=0;o<this.filterMembers.length;o++)this.filterPosObj[this.filterMembers[o]]=this.filterMembers[o];this.valueSortSettings.columnIndex=void 0;this.validateValueFields();this.frameDrillObject();this.isValueFilterEnabled&&!this.isEditing||u||(this.isLastHeaderHasMeasures=!0,this.columnCount=0,this.rowCount=0,this.cMembers=[],this.rMembers=[],0!==e.length&&(this.rMembers=this.getIndexedHeaders(e,b,0,e[0].showNoDataItems?y:this.filterMembers,"row","",this.allowValueFilter)),0!==f.length&&(this.cMembers=this.getIndexedHeaders(f,b,0,f[0].showNoDataItems?y:this.filterMembers,"column","",this.allowValueFilter)),this.insertAllMembersCommon(),this.saveDataHeaders=this.isValueFiltersAvail&&t.allowValueFilter?{rowHeaders:n.extend([],this.rMembers,null,!0),columnHeaders:n.extend([],this.cMembers,null,!0)}:{});this.pivotValues=[];this.headerContent=[];this.valueContent=[];this.valueFilteredData=[];this.filterFramedHeaders=[];var st=[],nt=[],s=[],h=[],tt=[],ht=this.dataSourceSettings.values.length;if(this.isValueFiltersAvail&&t.allowValueFilter&&!u){if(this.valueFilteredData=[],c=this.saveDataHeaders.rowHeaders?this.saveDataHeaders.rowHeaders:[],l=this.saveDataHeaders.columnHeaders?this.saveDataHeaders.columnHeaders:[],ot.length>0){for(var it={},rt={},ut=0,ct=g;ut<ct.length;ut++)ft=ct[ut],rt[ft.name]=ft;for(k=0,et=ot;k<et.length;k++)if(a=et[k],c=s.length>0?s:c,l=h.length>0?h:l,this.valueFilteredData=[],v=a.properties?a.properties:a,"Value"===v.type&&this.fieldList[a.name]&&this.fieldList[a.name].isSelected){it[a.name]=a;v.items=[];for(var d=!1,vt=e.length,yt=f.length,w=0;w<vt;w++)if(v.name===e[w].name&&rt[v.measure]&&!d){d=!0;s=this.applyValueFiltering(e[w],w,c,this.columnGrandTotal?this.columnGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?l[0]:l[l.length-1],it,this.valueFilteredData,"row");break}for(p=0;p<yt;p++)if(v.name===f[p].name&&rt[v.measure]&&!d){d=!0;h=this.applyValueFiltering(f[p],p,l,this.rowGrandTotal?this.rowGrandTotal:"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?c[0]:c[c.length-1],it,this.valueFilteredData,"column");break}}}s=s.length>0?s:c;h=h.length>0?h:l;this.isEmptyDataAvail(s,h);lt=r.getClonedFieldList(this.fieldList);this.indexMatrix=[];at=this.data[0];this.getFieldList(at,this.enableSort,t.allowValueFilter);this.fillFieldMembers(this.data,this.indexMatrix);this.updateSortSettings(t.sortSettings,this.enableSort);this.valueMatrix=this.generateValueMatrix(this.data);this.filterMembers=[];this.updateFilterMembers(t);this.isLastHeaderHasMeasures=!0;this.rMembers=0!==e.length?this.getIndexedHeaders(e,b,0,e[0].showNoDataItems?y:this.filterMembers,"row",""):[];this.cMembers=0!==f.length?this.getIndexedHeaders(f,b,0,f[0].showNoDataItems?y:this.filterMembers,"column",""):[];this.insertAllMembersCommon();this.updateFieldList(lt);this.rowCount=0;this.columnCount=0;this.rMembers=this.updateFramedHeaders(this.rMembers,this.rMembers,s,this.filterFramedHeaders,"row");this.filterFramedHeaders=[];this.cMembers=this.updateFramedHeaders(this.cMembers,this.cMembers,h,this.filterFramedHeaders,"column");this.isValueFilterEnabled=!0}u||this.applyValueSorting();this.isPagingOrVirtualizationEnabled&&(u?(this.rMembers=u.rowHeaders,this.cMembers=u.columnHeaders,this.rowCount=u.rowHeadersCount,this.columnCount=u.columnHeadersCount):(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeadersCount=this.columnCount),this.calculatePagingValues());!this.valueAxis&&this.isLastHeaderHasMeasures&&this.getAggregatedHeaders(e,f,this.rMembers,this.cMembers,g);this.getHeaderData(e,f,g,tt,this.cMembers,nt,this.pivotValues,0,this.valueAxis?1:ht);this.insertSubTotals();this.getTableData(tt.length>0?tt:this.rMembers,st,nt,0,this.pivotValues,ht,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]);this.applyAdvancedAggregate(st,nt,this.pivotValues);this.isEngineUpdated=!0;this.isEmptyDataAvail(this.rMembers,this.cMembers);this.clearProperties()},t.prototype.updateHeaders=function(t,i){t=n.isNullOrUndefined(t)?!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)&&this.dataSourceSettings.rows.length>0):t;(this.pageSettings&&this.removeRowGrandTotal||!t&&!this.rowGrandTotal)&&"grand sum"===this.rMembers[this.rMembers.length-1].type&&(this.rMembers=this.rMembers.slice(0,this.rMembers.length-1));i=n.isNullOrUndefined(i)?!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)&&this.dataSourceSettings.columns.length>0):i;(this.pageSettings&&this.removeColumnGrandTotal||!i&&!this.columnGrandTotal)&&"grand sum"===this.cMembers[this.cMembers.length-1].type&&(this.cMembers=this.cMembers.slice(0,this.cMembers.length-1))},t.prototype.updatePivotValues=function(n){var u=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)&&this.dataSourceSettings.rows.length>0),f=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)&&this.dataSourceSettings.columns.length>0),t,i,r;if((n&&this.updateHeaders(u,f),(this.pageSettings&&this.removeRowGrandTotal||!u&&!this.rowGrandTotal)&&this.valueContent.length>0)&&(t=1,this.valueAxis&&this.dataSourceSettings.values.length>0&&(t=1+this.dataSourceSettings.values.length),this.pivotValues[this.pivotValues.length-t]&&"grand sum"===this.pivotValues[this.pivotValues.length-t][0].type&&(this.pivotValues=this.pivotValues.slice(0,this.pivotValues.length-t),this.valueContent=this.valueContent.slice(0,this.valueContent.length-t))),(this.pageSettings&&this.removeColumnGrandTotal||!f&&!this.columnGrandTotal)&&this.headerContent.length>0&&(t=this.dataSourceSettings.values.length,this.valueAxis&&this.dataSourceSettings.values.length>0&&(t=1),this.pivotValues[0][this.pivotValues[0].length-t]&&"grand sum"===this.pivotValues[0][this.pivotValues[0].length-t].type))for(i=0;i<this.pivotValues.length;i++)if(this.pivotValues[i]&&(this.pivotValues[i]=this.pivotValues[i].slice(0,this.pivotValues[i].length-t)),this.headerContent[i])for(r=this.pivotValues[i].length;r<this.pivotValues[i].length+t;r++)delete this.headerContent[i][r];this.removeRowGrandTotal=this.removeColumnGrandTotal=!1},t.prototype.onDrill=function(n){this.frameDrillObject(n);var t=this.getHeadersInfo(n.fieldName,n.axis);this.performDrillOperation(t.headers,n,t.fields,t.position,0);this.headerCollection.rowHeadersCount=this.rowCount;this.headerCollection.columnHeadersCount=this.columnCount;"row"===t.axis?this.headerCollection.rowHeaders=t.headers:this.headerCollection.columnHeaders=t.headers;this.updateEngine()},t.prototype.onSort=function(n){var t=this.getHeadersInfo(n.name,"");this.fieldList[n.name].sort=n.order;this.performSortOperation(t.headers,n,t,0);this.updateEngine()},t.prototype.onFilter=function(n,t){var u,e,s,h,i;this.updateDataSourceSettings(t,!0);u=this.getHeadersInfo(n.name,"");this.isLastHeaderHasMeasures=!!(this.valueAxis&&"row"===u.axis||!this.valueAxis&&"column"===u.axis)||this.isLastHeaderHasMeasures;"Include"===n.type&&n.items.length===this.fieldList[n.name].dateMember.length?(this.fieldList[n.name].filter=[],this.fieldList[n.name].filterType=""):(this.fieldList[n.name].filter=n.items,this.fieldList[n.name].filterType=n.type);for(var c={},f=0,l=this.filterMembers;f<l.length;f++)e=l[f],c[e]=e;this.filterMembers=[];this.fieldFilterMem={};this.updateFilterMembers(t);for(var r=this.filterMembers.filter(function(n){return void 0===c[n]}),v={},o=0,a=n.items;o<a.length;o++)s=a[o],v[s]=s;if(this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems){for(h=[],this.filterPosObj={},i=0;i<r.length;i++)this.filterPosObj[r[i]]=r[i];for(i=0;i<this.indexMatrix.length;i++)h.push(i);r=h}this.performFilterCommonUpdate(n,u,r);this.frameHeaderObjectsCollection=!1;this.headerObjectsCollection={};this.updateEngine()},t.prototype.onAggregation=function(n){this.fieldList[n.name].aggregateType=n.type;this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;this.allowDataCompression&&(this.data=this.getGroupedRawData(this.dataSourceSettings),this.valueMatrix=this.generateValueMatrix(this.data));this.updateEngine()},t.prototype.onCalcOperation=function(n,t){this.dataSourceSettings.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[];this.dataSourceSettings.values=t.values?t.values:[];this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;this.getCalculatedField(this.fields);this.fieldList[n.name]?this.fieldList[n.name].formula=n.formula:(this.fieldList[n.name]={id:n.name,caption:n.name,type:"number",aggregateType:"CalculatedField",filterType:"",index:this.fields.length-1,filter:[],sort:this.enableSort?"Ascending":"None",isSelected:!0,isExcelFilter:!1,formula:n.formula},1===this.valueAxis?this.headerCollection.rowHeadersCount=this.rowCount=this.rowCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length:this.headerCollection.columnHeadersCount=this.columnCount=this.columnCount/(this.dataSourceSettings.values.length-1)*this.dataSourceSettings.values.length);this.updateEngine()},t.prototype.performDrillOperation=function(n,t,i,r,u){for(var o,e,s,f=0;f<n.length;){if(r===u){if(o=n[f].valueSort.levelName.split(this.valueSortSettings.headerDelimiter),t.memberName===o.join(t.delimiter?t.delimiter:"**")){"down"===t.action?(n[f].isDrilled=!0,n[f].members=this.getIndexedHeaders(i,this.data,r+1,n[f].index,t.axis,t.memberName.split(t.delimiter?t.delimiter:"**").join(this.valueSortSettings.headerDelimiter)),e=void 0,"row"===t.axis?(e=this.applyValueSorting(n[f].members,this.cMembers),n[f].members=e.rMembers):(s=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&i[r].showSubTotals,this.columnCount-=s?0:this.colValuesLength,e=this.applyValueSorting(this.rMembers,n[f].members),n[f].members=e.cMembers)):(n[f].isDrilled=!1,this.updateHeadersCount(n[f].members,t.axis,r,i,"minus",!0),n[f].members=[]);break}}else n[f].members.length>0&&(n[f].members=this.performDrillOperation(n[f].members,t,i,r,u+1));f++}return n},t.prototype.performSortOperation=function(n,t,i,r){for(var u=0;u<n.length;){if(i.position===r){n=this.getSortedHeaders(n,t.order.toString());break}n[u].members.length>0&&(n[u].members=this.performSortOperation(n[u].members,t,i,r+1));u++}return n},t.prototype.performFilterDeletion=function(n,t,i,r,u){for(var s,f=0,e=!0,h=function(){if(i.position===u){var s=o;n=n.filter(function(n){return!s.fieldFilterMem[t.name].memberObj[n.formattedText]||"grand sum"===n.type});e=!1}else n[f].members.length>0&&(n[f].members=o.performFilterDeletion(n[f].members,t,i,r,u+1));f++},o=this;f<n.length&&e;)h();return s=this,n.filter(function(n){return n.members.length>0||"grand sum"===n.type||s.matchIndexes(n.indexObject,r)})},t.prototype.matchIndexes=function(n,t){var r=Object.keys(n),i=r.length;if(0===i)return!0;for(;i>-1;){if(void 0!==t[n[r[i]]])return!0;i--}return!1},t.prototype.performFilterAddition=function(n,t,i){for(var r=0,f=function(){var f=n[r].valueSort.levelName,o,c;if(u.headerObjectsCollection[f]){for(var s={},e=0,h=n[r].members;e<h.length;e++)o=h[e],s[o.valueSort.levelName.toString()]=o.valueSort.levelName.toString();c=u.headerObjectsCollection[f].filter(function(n){return!s[n.valueSort.levelName.toString()]});n[r].members=n[r].members.concat(c);n[r].members=u.getSortedHeaders(n[r].members,u.fieldList[i.fields[n[r].members[0].level].name].sort);delete u.headerObjectsCollection[f]}n[r].members.length>0&&(n[r].members=u.performFilterAddition(n[r].members,t,i));r++},u=this;r<n.length;)f();return n},t.prototype.performFilterCommonUpdate=function(n,t,i){var o,u,h,p,c,f;if("row"===t.axis||"column"===t.axis){for(var r="row"===t.axis?this.rMembers:this.cMembers,l={},e=0,a=this.filterMembers;e<a.length;e++)o=a[e],l[o]=o;if(this.fieldFilterMem[n.name]&&(r=this.performFilterDeletion(t.headers,n,t,l,0)),i.length>0&&t.fields.length>0){if(this.frameHeaderObjectsCollection=!0,t.fields.filter(function(n){return n.showNoDataItems}).length>0)for(u=0;u<this.data.length;u++)i.push(u);this.headerObjectsCollection.parent=this.getIndexedHeaders(t.fields,this.data,0,i,t.axis,"");r=this.performFilterAddition(r,t.fields,t);for(var v={},s=0,y=r;s<y.length;s++)h=y[s],v[h.valueSort.levelName.toString()]=h.valueSort.levelName.toString();p=this.headerObjectsCollection.parent.filter(function(n){return!v[n.valueSort.levelName.toString()]});c=r.filter(function(n){return"grand sum"===n.type});c.length>0&&r.pop();r=this.getSortedHeaders(r.concat(p),this.fieldList[t.fields[0].name].sort).concat(c);"row"===t.axis?(this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column",""),this.insertAllMember(this.cMembers,this.filterMembers,"","column")):(this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row",""),this.insertAllMember(this.rMembers,this.filterMembers,"","row"))}"row"===t.axis?this.rowCount=0:this.columnCount=0;this.updateHeadersCount(r,t.axis,0,t.fields,"plus",!1);"row"===t.axis?(t.position>0&&this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",r),this.insertTotalPosition(r),this.rMembers=this.headerCollection.rowHeaders=r,this.headerCollection.rowHeadersCount=this.rowCount):(t.position>0&&this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",r),this.insertTotalPosition(r),this.cMembers=this.headerCollection.columnHeaders=r,this.headerCollection.columnHeadersCount=this.columnCount)}else f=this.dataSourceSettings.rows[0]&&this.dataSourceSettings.rows[0].showNoDataItems||this.dataSourceSettings.columns[0]&&this.dataSourceSettings.columns[0].showNoDataItems,this.dataSourceSettings.rows.length>0&&(this.rMembers=this.getIndexedHeaders(this.dataSourceSettings.rows,this.data,0,f?i:this.filterMembers,"row","")),this.dataSourceSettings.columns.length>0&&(this.cMembers=this.getIndexedHeaders(this.dataSourceSettings.columns,this.data,0,f?i:this.filterMembers,"column","")),this.insertAllMembersCommon(),this.rowCount=0,this.columnCount=0,this.updateHeadersCount(this.cMembers,"column",0,this.dataSourceSettings.columns,"plus",!1),this.updateHeadersCount(this.rMembers,"row",0,this.dataSourceSettings.rows,"plus",!1),f&&(this.insertPosition(this.dataSourceSettings.rows,this.data,0,this.filterMembers,"row","",this.rMembers),this.insertPosition(this.dataSourceSettings.columns,this.data,0,this.filterMembers,"column","",this.cMembers)),this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.rowHeadersCount=this.rowCount,this.headerCollection.columnHeaders=this.cMembers,this.headerCollection.columnHeadersCount=this.columnCount;this.applyValueSorting()},t.prototype.getHeadersInfo=function(n,t){this.rMembers=this.headerCollection.rowHeaders;this.cMembers=this.headerCollection.columnHeaders;for(var e="row"===(t=""===t?this.getAxisByFieldName(n):t)?this.rMembers:this.cMembers,r="row"===t?this.dataSourceSettings.rows:this.dataSourceSettings.columns,u=0,i=0,f=r;i<f.length&&f[i].name!==n;i++)u++;return{axis:t,fields:r,headers:e,position:u}},t.prototype.updateEngine=function(){this.removeCount=0;this.validateValueFields();this.calculatePagingValues();this.pivotValues=[];this.headerContent=[];this.valueContent=[];var i=[],n=[],t=[],r=this.dataSourceSettings.values.length;this.getAggregatedHeaders(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.rMembers,this.cMembers,this.dataSourceSettings.values);this.getHeaderData(this.dataSourceSettings.rows,this.dataSourceSettings.columns,this.dataSourceSettings.values,t,this.cMembers,n,this.pivotValues,0,this.valueAxis?1:r);this.insertSubTotals();this.getTableData(t.length>0?t:this.rMembers,i,n,0,this.pivotValues,r,0,this.rowGrandTotal?this.rowGrandTotal:this.rMembers[this.rMembers.length-1],this.columnGrandTotal?this.columnGrandTotal:this.cMembers[this.cMembers.length-1]);this.applyAdvancedAggregate(i,n,this.pivotValues);this.isEngineUpdated=!0;this.isEmptyDataAvail(this.rMembers,this.cMembers)},t.prototype.getAxisByFieldName=function(n){for(var i=0,t="";i<4&&""===t;){switch(i){case 0:t=this.getFieldByName(n,this.dataSourceSettings.rows)?"row":"";break;case 1:t=this.getFieldByName(n,this.dataSourceSettings.columns)?"column":""}i++}return t},t.prototype.getFieldByName=function(n,t){return new ut.DataManager({json:t}).executeLocal((new ut.Query).where("name","equal",n))[0]},t.prototype.updateHeadersCount=function(n,t,i,r,u,f){for(var e=0,o=r[i],s="column"===t?this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&o.showSubTotals:!(this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals&&o)||o.showSubTotals;e<n.length;)"row"===t?this.rowCount=this.rowCount-("plus"===u?-(1===this.valueAxis?this.dataSourceSettings.values.length:1):1===this.valueAxis?this.dataSourceSettings.values.length:1):this.columnCount=this.columnCount-("plus"===u?-(1===this.valueAxis?1:this.dataSourceSettings.values.length):1===this.valueAxis?1:this.dataSourceSettings.values.length),n[e].members.length>0&&this.updateHeadersCount(n[e].members,t,i+1,r,u,!0),e++;"column"===t&&!s&&f&&(this.columnCount+="plus"===u?-this.colValuesLength:this.colValuesLength)},t.prototype.getSortedHeaders=function(n,t){var u="Grand Total"!==n[0].actualText?n[0].valueSort.axis:n[1].valueSort.axis,e=!(this.formatFields&&this.formatFields[u]&&this.formatFields[u].type),i=this.fieldList[u];if(e){if(i&&"number"===i.type&&n.length>0&&"string"==typeof n[0].actualText){for(var o=[],f=[],s=[],r=0;r<n.length;r++)if(isNaN(n[r].actualText.toString().charAt(0)))o.push(n[r]);else{if(""!==n[r].actualText){f.push(n[r]);break}s.push(n[r])}return f.length>0&&(f=this.sortHeaders(u,i,n,i.sort,i.isAlphanumeric)),n}return this.sortHeaders(u,i,n,t,i.type)}return this.sortHeaders(u,i,n,t,i.type)},t.prototype.sortHeaders=function(n,t,i,u,f){var c=!1,e=this.fieldList[n]&&this.fieldList[n].membersOrder?this.fieldList[n].membersOrder.slice():[],o={fieldName:n,sortOrder:u,members:e&&e.length>0?e:Object.keys(t.members),IsOrderChanged:!1},v="datetime"===(f="datetime"===f||"date"===f||"time"===f?this.formatFields[n]&&["date","dateTime","time"].indexOf(this.formatFields[n].type)>-1?f:"string":f)||"date"===f||"time"===f,s,a;if(e&&e.length>0?r.applyCustomSort(o,i,f):(r.applyHeadersSort(i,u,f),c=!0),c&&this.getHeaderSortInfo){for(var l=[],h=0,y=0;h<i.length;h++)s=i[h],a=v?s.dateText:s.actualText,"Grand Total"!==s.actualText&&(l[y++]=a);o.members=l}return this.getHeaderSortInfo&&this.getHeaderSortInfo(o),o.IsOrderChanged&&r.applyCustomSort(o,i,f,!0),i},t.prototype.applyValueSorting=function(t,i){var l=!1,a,u,v,f,e;if(this.enableValueSorting&&(this.valueSortSettings.rowHeader||this.valueSortSettings.columnHeader)){if(void 0!==t&&void 0!==i||(this.rowValueSortHeaderText=void 0,this.columnValueSortHeaderText=void 0,!this.rowValueSortHeaderText&&!n.isNullOrUndefined(this.valueSortSettings.rowHeader)&&""!==this.valueSortSettings.rowHeader&&this.dataSourceSettings.values.length>0&&(this.rowValueSortHeaderText=this.prepareValueSortHeaderText(this.valueSortSettings.rowHeader,this.rowValueSortHeaderText)),!this.columnValueSortHeaderText&&!n.isNullOrUndefined(this.valueSortSettings.columnHeader)&&""!==this.valueSortSettings.columnHeader&&this.dataSourceSettings.values.length>0&&(this.columnValueSortHeaderText=this.prepareValueSortHeaderText(this.valueSortSettings.columnHeader,this.columnValueSortHeaderText)),t=this.rMembers,i=this.cMembers,l=!0),this.rowValueSortHeaderText){a=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)&&this.dataSourceSettings.rows.length>0);u=!0;-1!==this.rowValueSortHeaderText.indexOf(this.localeObj.getConstant("grandTotal"))&&!a&&u&&(t.push(this.rowGrandTotal),u=!1);var o=this.getHeaderDetails(this.rowValueSortHeaderText,!0),s=o.hText,h=o.mIndex,c=o.mType,r=void 0;""!==this.valueSortSettings.rowHeader&&(r=this.getMember(t,s))&&(i=this.sortByValueRow(i,r,this.valueSortSettings.rowOrder,h,c));u||t.pop()}this.columnValueSortHeaderText&&(v=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)&&this.dataSourceSettings.columns.length>0),f=!0,-1!==this.columnValueSortHeaderText.indexOf(this.localeObj.getConstant("grandTotal"))&&!v&&f&&(i.push(this.columnGrandTotal),f=!1),e=this.getHeaderDetails(this.columnValueSortHeaderText,!1),s=e.hText,h=e.mIndex,c=e.mType,r=void 0,""!==this.valueSortSettings.columnHeader&&(r=this.getMember(i,s))&&(t=this.sortByValueRow(t,r,this.valueSortSettings.columnOrder,h,c)),f||i.pop());l&&(this.rMembers=t,this.cMembers=i,this.isPagingOrVirtualizationEnabled&&(this.headerCollection.rowHeaders=this.rMembers,this.headerCollection.columnHeaders=this.cMembers))}return{rMembers:t,cMembers:i}},t.prototype.prepareValueSortHeaderText=function(n,t){for(var i=(t=n).split(this.valueSortSettings.headerDelimiter),r=0,f=this.dataSourceSettings.values;r<f.length;r++){var u=f[r],e=u.caption?u.caption:u.name,o=i.indexOf(e);if(o>-1){i.splice(o,1);i.push(e);t=i.join(this.valueSortSettings.headerDelimiter);break}}return t},t.prototype.getHeaderDetails=function(t,i){for(var o,s,e,u=t.split(this.valueSortSettings.headerDelimiter),f="",r=0;r<this.dataSourceSettings.values.length;r++){if(this.dataSourceSettings.values[r].caption===u[u.length-1]){e=this.dataSourceSettings.values[r].name;break}e=u[u.length-1]}if((1===this.dataSourceSettings.values.length&&0===this.dataSourceSettings.columns.length||this.dataSourceSettings.values.length>1)&&e&&this.fieldList[e]){for(r=0;r<u.length-1;r++)f=""===f?u[r]:f+this.valueSortSettings.headerDelimiter+u[r];o=this.fieldList[e].index;s=this.fieldList[e].aggregateType}else{if(this.dataSourceSettings.alwaysShowValueHeader&&1!==u.length&&(!i||"row"===this.dataSourceSettings.valueAxis)&&(i||"column"===this.dataSourceSettings.valueAxis))for(r=0;r<u.length-1;r++)f=""===f?u[r]:f+this.valueSortSettings.headerDelimiter+u[r];else f=t;if(n.isNullOrUndefined(this.dataSourceSettings.valueSortSettings.measure)||""===this.dataSourceSettings.valueSortSettings.measure)o=this.fieldList[this.dataSourceSettings.values[0].name].index,s=this.fieldList[this.dataSourceSettings.values[0].name].aggregateType;else for(r=0;r<this.dataSourceSettings.values.length;r++){if(this.dataSourceSettings.valueSortSettings.measure==this.dataSourceSettings.values[r].name){o=this.fieldList[this.dataSourceSettings.valueSortSettings.measure].index;s=this.fieldList[this.dataSourceSettings.valueSortSettings.measure].aggregateType;break}o=this.fieldList[this.dataSourceSettings.values[0].name].index;s=this.fieldList[this.dataSourceSettings.values[0].name].aggregateType}}return{hText:f,mIndex:o,mType:s}},t.prototype.getMember=function(n,t){for(var r,u=n.length,i=0;i<u;i++){if(n[i].valueSort.levelName===t){r=n[i];break}if(n[i].members.length>0&&(r=this.getMember(n[i].members,t)),r)return r}return r},t.prototype.sortByValueRow=function(n,t,i,r,u){for(var o,c,s,l,f,e=[],h=0,a=n;h<a.length;h++)"grand sum"===(f=a[h]).type?e.push({header:f}):(this.rawIndexObject={},o=this.getAggregateValue(f.index,t.indexObject,r,u,!1),c={fieldName:this.fields[r],row:f,column:t,value:o,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:f.hasChild&&f.isDrilled?"subTotal":"grand sum"===f.type?"grandTotal":"value",columnCellType:t.hasChild&&t.isDrilled?"subTotal":"grand sum"===t.type?"grandTotal":"value",aggregateType:u,skipFormatting:!1},this.getValueCellInfo&&this.getValueCellInfo(c),o=c.value,this.rawIndexObject={},e.push({header:f,value:o}));for(e.sort(function(n,t){return"Descending"===i?(t.value||"grand sum"===t.header.type?t.value:0)-(n.value||"grand sum"===n.header.type?n.value:0):(n.value||"grand sum"===n.header.type?n.value:0)-(t.value||"grand sum"===t.header.type?t.value:0)}),s=0,l=n=e.map(function(n){return n.header});s<l.length;s++)(f=l[s]).members.length>0&&(f.members=this.sortByValueRow(f.members,t,i,r,u));return n},t.prototype.insertAllMembersCommon=function(){this.rowGrandTotal=this.columnGrandTotal=null;var n=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showRowGrandTotals)&&this.dataSourceSettings.rows.length>0),t=!((!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)&&this.dataSourceSettings.columns.length>0);this.isValueHasAdvancedAggregate?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),n&&(this.rowCount+=this.rowValuesLength),this.insertAllMember(this.cMembers,this.filterMembers,"","column"),t&&(this.columnCount+=this.colValuesLength)):(n?(this.insertAllMember(this.rMembers,this.filterMembers,"","row"),this.rowCount+=this.rowValuesLength):this.rowGrandTotal=this.insertAllMember([],this.filterMembers,"","row")[0],t?(this.insertAllMember(this.cMembers,this.filterMembers,"","column"),this.columnCount+=this.colValuesLength):this.columnGrandTotal=this.insertAllMember([],this.filterMembers,"","column")[0])},t.prototype.insertSubTotals=function(){for(var e,i,f,s,v,y,p,w=this.pivotValues.length,r=0;r<w;r++)if(e=this.pivotValues[r],e)for(var u=void 0,o=1,k=e.length,h=void 0,c=1,b=this.showSubTotalsAtTop?this.reformAxisCount:k,t=this.showSubTotalsAtTop?c:b-1,l=void 0,a=void 0;c<b;){if(i=e[t],i){for(u&&(u.colSpan=o,u.colIndex=this.showSubTotalsAtTop?u.colIndex+(o-1):u.colIndex-(o-1)),this.showSubTotalsAtTop&&(l=a=this.getMemberSpanCount(this.pivotValues[r],t)),h={index:i.index,indexObject:i.indexObject},i.index=[],i.indexObject={},u=n.extend({},i,null,!0),i.index=h.index,i.indexObject=h.indexObject,f=r+1;this.pivotValues[f]&&!this.pivotValues[f][t];)s=this.pivotValues[r][t],s.isDrilled||!this.valueAxis&&!this.isLastHeaderHasMeasures&&s.members&&s.members.length>0&&f>this.measureIndex||(s.rowSpan=f-r+1,u.rowSpan=f-r+1),v="sum"===i.type||"grand sum"===i.type?i.type:"sum",this.pivotValues[f][t]=this.headerContent[f][t]={type:v,formattedText:"sum"===i.type||"grand sum"===i.type?i.formattedText:i.formattedText+" Total",axis:"column",hierarchyName:i.hierarchyName,level:-1,colIndex:t,rowIndex:f,valueSort:i.valueSort},i.valueSort&&(i.valueSort[this.valueSortSettings.rowHeader]||i.valueSort[this.valueSortSettings.columnHeader])&&(this.valueSortSettings.columnIndex=t),y=!1,"grand sum"===v?(s.rowSpan=f-r+1,u.rowSpan=f-r+1):"sum"!==s.type&&(s.isDrilled||this.valueAxisFields[s.actualText]&&!this.valueAxis&&!this.isLastHeaderHasMeasures&&s.members&&s.members.length>0)?(this.pivotValues[r+1][t].rowSpan=f-r,y=!0):this.pivotValues[f][t].rowSpan=-1,f>r+1&&("sum"===s.type||y)&&(this.pivotValues[f][t].rowSpan=-1),f++;o=1}else e[t]=this.headerContent[r][t]=n.extend({},u,null,!0),e[t].index=this.headerContent[r][t].index=h.index,e[t].indexObject=this.headerContent[r][t].indexObject=h.indexObject,o++,this.showSubTotalsAtTop?(a--,e[t].colSpan=a,e[t].colIndex=e[t].colIndex+(o-1)):(e[t].colSpan=o,e[t].colIndex=e[t].colIndex-(o-1));(1===t&&u&&(this.showSubTotalsAtTop?(u.colSpan=l,u.colIndex=u.colIndex+(o-1)):(u.colSpan=o,u.colIndex=u.colIndex-(o-1))),this.showSubTotalsAtTop&&(e[t+1]||t+1===this.reformAxisCount))&&(p=this.pivotValues[r][t-o+1],p.colSpan=l,this.pivotValues[r][t-o+1]=p);t=this.showSubTotalsAtTop?t+1:t-1;c++}},t.prototype.getMemberSpanCount=function(n,t){for(var r=1,i=t+1;i<this.reformAxisCount&&!n[i];i++)r++;return r},t.prototype.frameDrillObject=function(n){var f,e,o,w,s,r,u,h,c,b,l,d;for(void 0===n&&(n=null),this.fieldDrillCollection={},f=0;f<this.drilledMembers.length;f++){for(var i=this.drilledMembers[f],a=!1,v=1,y=!1,k=this.fieldList[i.name],p=k&&k.expandAll,t=0;t<this.dataSourceSettings.rows.length;t++)if(this.dataSourceSettings.rows[t].name===i.name){v=((e=this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=t)?t+1:t)+1;a=!!e;y=!0;break}if(!y)for(t=0;t<this.dataSourceSettings.columns.length;t++)if(this.dataSourceSettings.columns[t].name===i.name){v=((e=!this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.measureIndex>-1&&this.measureIndex<=t)?t+1:t)+1;a=!!e;y=!0;break}for(o=0,w=i.items;o<w.length;o++)if(s=w[o],r=s.split(i.delimiter),v===r.length&&(u=i.name+this.valueSortSettings.headerDelimiter+r.join(this.valueSortSettings.headerDelimiter),this.fieldDrillCollection[u]=u,a)){if(h=!1,this.isExpandAll||p)for(c=0,b=this.dataSourceSettings.values;c<b.length;c++){if(l=b[c],d=l.caption?l.caption:l.name,r[this.measureIndex]=d,!(i.items.indexOf(r.join(i.delimiter))>-1)){h=!1;break}h=!0}((this.isExpandAll||p)&&h||!this.isExpandAll||!p)&&((r=s.split(i.delimiter)).splice(this.measureIndex,1),n&&n.memberName===s&&(n.memberName=r.join(i.delimiter)),u=i.name+this.valueSortSettings.headerDelimiter+r.join(this.valueSortSettings.headerDelimiter),this.fieldDrillCollection[u]=u)}}},t.prototype.getIndexedHeaders=function(t,i,r,u,f,e,o){var h=[],at=0,c,s,w,l,ut,ot,vt,st,y,yt,ht,lt;if(t&&t.length>0){at++;var ft=t.length,b={},p=t[r].name,rt=t[r],v=this.fieldList[p];if(n.isNullOrUndefined(this.reportDataType)){for(this.reportDataType={},c=0;c<this.dataSourceSettings.rows.length;c++)this.reportDataType[this.dataSourceSettings.rows[c].name]=this.dataSourceSettings.rows[c].dataType;for(c=0;c<this.dataSourceSettings.columns.length;c++)this.reportDataType[this.dataSourceSettings.columns[c].name]=this.dataSourceSettings.columns[c].dataType;for(c=0;c<this.dataSourceSettings.values.length;c++)this.reportDataType[this.dataSourceSettings.values[c].name]=this.dataSourceSettings.values[c].dataType}v.type=n.isNullOrUndefined(this.reportDataType[v.id])?v.type:this.reportDataType[v.id];var k=!1,et=this.formatFields[p]&&["date","dateTime","time"].indexOf(this.formatFields[p].type)>-1,nt=u.length<1&&r>0||rt.showNoDataItems,d={};if(nt){for(var tt=Object.keys(v.members),a=0,it=tt.length;a<it;a++)(this.dataSourceSettings.showHeaderWhenEmpty||this.localeObj&&tt[a]!==this.localeObj.getConstant("undefined"))&&(d[tt[a]]=tt[a]);u.length<1&&(k=!0,u.length=tt.length)}for(f===this.dataSourceSettings.valueAxis&&this.measureIndex===r&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&(this.isLastHeaderHasMeasures=!1),a=0,it=u.length;a<it;a++)s={},n.isNullOrUndefined(t[r].showSubTotals)||t[r].showSubTotals||(s.showSubTotals=!1),s.hasChild=r<ft-1,s.level=r,s.axis=f,s.colSpan=1,w=k?v.members[Object.keys(d)[0]].ordinal:this.indexMatrix[u[a]][v.index],l=k?Object.keys(d)[0]:i[u[a]][this.fieldKeys[p]],(l=this.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(l):l,(n.isNullOrUndefined(l)||this.localeObj&&l===this.localeObj.getConstant("undefined"))&&!this.dataSourceSettings.showHeaderWhenEmpty)?nt&&!k&&r>0&&a+1===u.length&&Object.keys(d).length>0&&(it=Object.keys(d).length,k=!0,a=-1):(delete d[l],nt&&this.fieldFilterMem[p]&&this.fieldFilterMem[p].memberObj[l]===l)||(ut=et||this.formatFields[p]?{actualText:l,formattedText:v.dateMember[w-1].formattedText,dateText:v.dateMember[w-1].actualText}:{formattedText:null===l?this.localeObj?this.localeObj.getConstant("null"):String(l):void 0===l&&this.localeObj?p in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(l),actualText:null===l?this.localeObj?this.localeObj.getConstant("null"):String(l):void 0===l?this.localeObj?p in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(l):l},s.actualText=ut.actualText,s.formattedText=ut.formattedText,et&&(s.dateText=ut.dateText),ot=!nt||void 0!==this.filterPosObj[u[a]]&&!k,b&&b[w]?ot&&(b[w].index.push(u[a]),b[w].indexObject[u[a]]=u[a]):(b[w]={index:[],indexObject:{}},s.index=b[w].index,s.indexObject=b[w].indexObject,ot&&(s.index=b[w].index=[u[a]],b[w].indexObject[u[a]]=u[a],s.indexObject=b[w].indexObject),s.ordinal=w,s.valueSort={},s.valueSort.axis=p,0!==r?(s.valueSort.levelName=e+this.valueSortSettings.headerDelimiter+s.formattedText,s.valueSort[e+this.valueSortSettings.headerDelimiter+s.formattedText]=1,s.valueSort.uniqueName=e+this.valueSortSettings.headerDelimiter+(s.actualText?s.actualText:s.formattedText),s.valueSort[e+this.valueSortSettings.headerDelimiter+(s.actualText?s.actualText:s.formattedText)]=1):(s.valueSort[s.formattedText]=1,s.valueSort.levelName=s.formattedText,s.valueSort[s.actualText?s.actualText:s.formattedText]=1,s.valueSort.uniqueName=s.actualText?s.actualText:s.formattedText),vt=s.valueSort.axis+this.valueSortSettings.headerDelimiter+s.valueSort.levelName,st=this.isExpandAll||rt&&rt.expandAll,s.isDrilled=!(!o||!this.isValueFiltersAvail)||(s.hasChild&&this.fieldDrillCollection[vt]?!st||!this.valueAxis&&!this.isLastHeaderHasMeasures&&at>=this.measureIndex:st),s.members=[],h.push(s)),nt&&!k&&r>0&&a+1===u.length&&Object.keys(d).length>0&&(k=!0,it=Object.keys(d).length,a=-1));for(y=0,yt=h.length;y<yt;y++){if(this.frameHeaderObjectsCollection||("row"===f?this.rowCount+=this.rowValuesLength:this.columnCount+=this.colValuesLength),ht=null,h[y].valueSort&&h[y].valueSort.levelName&&(ht=h[y].valueSort.levelName),e=ht||h[y].formattedText,!this.dataSourceSettings.showHeaderWhenEmpty&&ft-1>r&&h[y].index&&h[y].index.length>0)if(nt&&t[r+1]&&t[r+1].name&&Object.keys(this.fieldList[t[r+1].name].members).length>0)h[y].hasChild=!0;else{for(var pt=h[y].index.length,wt=0,ct=0;ct<pt;ct++)l=i[h[y].index[ct]][this.fieldKeys[t[r+1].name]],(n.isNullOrUndefined(l)||this.localeObj&&l===this.localeObj.getConstant("undefined"))&&wt++;h[y].hasChild=wt!==pt}ft-1>r&&h[y].isDrilled&&(this.columnCount-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&rt.showSubTotals||"column"!==f?0:this.colValuesLength,lt=h[y].index,h[y].members=this.getIndexedHeaders(t,i,r+1,void 0===lt?[]:lt,f,e,o),this.frameHeaderObjectsCollection&&(this.headerObjectsCollection[e]=h[y].members))}if(this.enableSort){if(et)return this.sortHeaders(p,v,h,v.sort,"date");if("number"===v.type.toLowerCase()&&h.length>0&&"string"==typeof h[0].actualText&&h[0].actualText.match(/[a-zA-Z]+/g)){var kt=[],g=void 0,bt=[],dt=[];for(c=0;c<h.length;c++)if(n.isNullOrUndefined(h[c].actualText.toString().match(/\d+/)))kt.push(h[c]),g||"None"===v.sort||"Out of Range"===h[c].actualText&&(g=h[c],h.splice(c,1));else{if(""!==h[c].actualText){this.fieldList[p].isAlphanumeric=!0;bt.push(h[c]);break}dt.push(h[c])}return g&&("Ascending"===v.sort?"Grand Total"===h[0].actualText?h.splice(1,0,g):h.splice(0,0,g):"Grand Total"===h[h.length-1].actualText?h.splice(h.length-1,0,g):h.splice(h.length,0,g)),bt.length>0&&this.sortHeaders(p,v,h,v.sort,v.isAlphanumeric),h}return this.sortHeaders(p,v,h,v.sort,v.type)}return h}return h},t.prototype.getOrderedIndex=function(n){for(var i={},t=0;t<n.length;t++)"grand sum"!==n[t].type&&(i[n[t].ordinal]=t);return i},t.prototype.insertPosition=function(n,t,i,r,u,f,e){var a=[],g=this.getOrderedIndex(e),k,p,s,d,w;if(n){for(var c={},y=n[i].name,nt=this.fieldList[y],h=0,tt=r.length;h<tt;h++){var b={},l=this.indexMatrix[r[h]][nt.index],o=e[g[l]],v=t[r[h]][this.fieldKeys[y]];v=null===v?this.localeObj?this.localeObj.getConstant("null"):String(v):v;k=this.formatFields[y]&&["date","dateTime","time"].indexOf(this.formatFields[y].type)>-1?this.getFormattedValue(v,y):{formattedText:v.toString(),actualText:v.toString()};o&&o.formattedText===k.formattedText&&(c&&c[l]?(c[l].index.push(r[h]),c[l].indexObject[r[h]]=r[h]):(c[l]={index:[],indexObject:{}},o.index=c[l].index=[r[h]],c[l].indexObject[r[h]]=r[h],o.indexObject=c[l].indexObject,o.valueSort={},o.valueSort.axis=y,0!==i?(o.valueSort.levelName=f+this.valueSortSettings.headerDelimiter+o.formattedText,o.valueSort[f+this.valueSortSettings.headerDelimiter+o.formattedText]=1,o.valueSort.uniqueName=f+this.valueSortSettings.headerDelimiter+(o.actualText?o.actualText:o.formattedText),o.valueSort[f+this.valueSortSettings.headerDelimiter+(o.actualText?o.actualText:o.formattedText)]=1):(o.valueSort[o.formattedText]=1,o.valueSort.levelName=o.formattedText,o.valueSort[o.actualText?o.actualText:o.formattedText]=1,o.valueSort.uniqueName=o.actualText?o.actualText:o.formattedText),b.members=[],a.push(b)))}for(p=e.length-a.length;p>0;)a.push({members:[]}),p--;for(s=0,d=a.length;s<d;s++)e[s].members.length>0&&(w=null,e[s].valueSort&&e[s].valueSort.levelName&&(w=e[s].valueSort.levelName),f=w||e[s].formattedText,a[s].members=this.insertPosition(n,t,i+1,e[s].index,u,f,e[s].members));return a}return a},t.prototype.insertTotalPosition=function(n){var t=n[n.length-1],i,r;if(t&&"grand sum"===t.type)for(t.index=this.filterMembers,t.indexObject={},i=0,r=this.filterMembers.length;i<r;i++)t.indexObject[this.filterMembers[i]]=this.filterMembers[i];return n},t.prototype.calculatePagingValues=function(){var t,n;this.isPagingOrVirtualizationEnabled&&(1===this.valueAxis?this.rowValuesLength=this.dataSourceSettings.values.length:this.colValuesLength=this.dataSourceSettings.values.length,this.columnPageCount=Math.ceil(this.columnCount/this.pageSettings.columnPageSize),this.rowPageCount=Math.ceil(this.rowCount/this.pageSettings.rowPageSize),this.pageSettings.currentColumnPage=this.pageSettings.currentColumnPage>=this.columnPageCount?this.columnPageCount:this.pageSettings.currentColumnPage,this.pageSettings.currentRowPage=this.pageSettings.currentRowPage>=this.rowPageCount?this.rowPageCount:this.pageSettings.currentRowPage,t=this.enablePaging?1:3,this.memberCnt=this.enablePaging?0:-this.rowValuesLength,this.rowStartPos=(this.pageSettings.currentRowPage*this.pageSettings.rowPageSize-this.pageSettings.rowPageSize)*(this.enablePaging?1:this.rowValuesLength)+(this.enablePaging?1:0),n=this.enablePaging?this.rowStartPos:this.rowStartPos+this.pageSettings.rowPageSize*t*this.rowValuesLength>this.rowCount?this.rowCount-this.pageSettings.rowPageSize*t*this.rowValuesLength:this.rowStartPos,n<0&&(n=this.rowStartPos=0,this.pageSettings.currentRowPage=1),this.rowFirstLvl=(this.rowStartPos-n)%this.pageSettings.rowPageSize,this.rowStartPos=n,this.endPos=this.rowStartPos+this.pageSettings.rowPageSize*t*(this.enablePaging?1:this.rowValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.rowCount+1?this.rowCount+1:this.endPos,this.rMembers=this.performSlicing(this.rMembers,[],this.rowStartPos,"row"),this.memberCnt=this.enablePaging?0:-this.colValuesLength,this.pageInLimit=!1,this.colHdrBufferCalculated=!1,this.colStartPos=(this.pageSettings.currentColumnPage*this.pageSettings.columnPageSize-this.pageSettings.columnPageSize)*(this.enablePaging?1:this.colValuesLength)+(this.enablePaging?1:0),(n=this.enablePaging?this.colStartPos:this.colStartPos+this.pageSettings.columnPageSize*t*this.colValuesLength>this.columnCount?this.columnCount-this.pageSettings.columnPageSize*t*this.colValuesLength:this.colStartPos)<0&&(n=this.colStartPos=0,this.pageSettings.currentColumnPage=1),this.colFirstLvl=(this.colStartPos-n)%this.pageSettings.columnPageSize,this.colStartPos=n,this.endPos=this.colStartPos+this.pageSettings.columnPageSize*t*(this.enablePaging?1:this.colValuesLength)-(this.enablePaging?1:0),this.endPos=this.endPos>this.columnCount+1?this.columnCount+1:this.endPos,this.cMembers=this.performSlicing(this.cMembers,[],this.colStartPos,"column"),this.memberCnt=-1,this.pageInLimit=!1,this.isValueHasAdvancedAggregate?("grand sum"!==this.rMembers[this.rMembers.length-1].type&&"grand sum"===this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1].type&&(this.rMembers.push(this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1]),this.removeRowGrandTotal=!0),"grand sum"!==this.cMembers[this.cMembers.length-1].type&&"grand sum"===this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1].type&&(this.cMembers.push(this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]),this.removeColumnGrandTotal=!0)):(this.rowGrandTotal=this.rowGrandTotal?this.rowGrandTotal:this.headerCollection.rowHeaders[this.headerCollection.rowHeaders.length-1],this.columnGrandTotal=this.columnGrandTotal?this.columnGrandTotal:this.headerCollection.columnHeaders[this.headerCollection.columnHeaders.length-1]))},t.prototype.performSlicing=function(n,t,i,r){for(var u=0;n[u]&&!(this.enablePaging&&this.endPos<=this.memberCnt&&0!==u);){if(this.memberCnt+=n[u].level<=this.measureIndex?"column"===r?this.colValuesLength:this.rowValuesLength:1,i<=this.memberCnt&&this.endPos>=this.memberCnt&&!this.pageInLimit&&("column"===r?this.colFirstLvl=this.colFirstLvl+n[u].level:this.rowFirstLvl=this.rowFirstLvl+n[u].level,this.isParentLevelAdded="column"===r?!(this.colFirstLvl>0):!(this.rowFirstLvl>0),this.pageInLimit=!0),this.pageInLimit&&!this.enablePaging&&this.endPos<=this.memberCnt){if("column"!==r)break;if(0===n[u].members.length){if(this.colHdrBufferCalculated)break;this.colHdrBufferCalculated=!0;this.endPos+=n[u].level*this.colValuesLength}else if(this.colHdrBufferCalculated)break}if(t.push(n[u].members.length>0?this.removeChildMembers(n[u]):n[u]),n[u].members.length>0&&("column"===r?this.memberCnt-=this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals&&this.columnKeys[n[u].valueSort.axis].showSubTotals?0:this.colValuesLength:this.showSubTotalsAtBottom&&this.memberCnt++,t[t.length-1].members=this.performSlicing(n[u].members,[],i,r)),!this.isParentLevelAdded&&this.enablePaging&&(this.memberCnt+=(t[t.length-1].level<=this.measureIndex?"column"===r?this.colValuesLength:this.rowValuesLength:1)*t[t.length-1].level,this.isParentLevelAdded=!0),this.pageInLimit||t.pop(),0===n[u].level&&this.pageInLimit&&this.endPos<=this.memberCnt)break;u++}return t},t.prototype.removeChildMembers=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],"members"===i[t]&&(r.members=[]),t++;return r},t.prototype.insertAllMember=function(n,t,i,r){var u={hasChild:!1,index:t,level:0,axis:r,isDrilled:!1,indexObject:{},members:[],actualText:"Grand Total",formattedText:"Grand Total",ordinal:n.length,type:"grand sum",valueSort:{}},f,e;for(u.valueSort[u.formattedText]=1,u.valueSort.levelName=u.formattedText,u.valueSort[u.actualText]=1,u.valueSort.uniqueName=u.actualText,f=0,e=t.length;f<e;f++)u.indexObject[t[f]]=t[f];return"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals?n.unshift(u):n.push(u),n},t.prototype.getTableData=function(t,i,u,f,e,o,s,h,c,l){for(var a,v,d,k,tt,it,rt,nt,ut,st,ht,et=t.length,b=0;b<et;b++)if(a=!this.valueAxis&&!this.isLastHeaderHasMeasures&&e.length<this.dataSourceSettings.columns.length+1?this.dataSourceSettings.columns.length+1:e.length,v=t[b],i[a]=v,d=a-Number(Object.keys(i)[0]),k=!i[a].members.length,v.colIndex=0,v.rowIndex=a,tt=!1,it=this.dataSourceSettings.valueSortSettings.headerDelimiter,this.valueAxis&&0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1&&(this.rowIndex=n.isNullOrUndefined(this.rowIndex)&&!k&&0===this.dataSourceSettings.rows.length?v.index:this.rowIndex,tt=this.valueAxis&&0===this.dataSourceSettings.rows.length&&v.valueSort.levelName&&0!==v.valueSort.levelName.toString().indexOf("Grand Total"+it),this.valueAxis&&0===this.dataSourceSettings.rows.length&&0===v.valueSort.levelName.toString().indexOf("Grand Total"+it)&&(v.index=this.rowIndex)),tt)k||this.recursiveRowData(t,i,u,a,e,o,k,b,0,s,h,c);else{if(rt=!1,this.showSubTotalsAtBottom&&i[f]&&i[f].hasChild)for(nt=0,ut=i[f].members;nt<ut.length;nt++)if("value"===ut[nt].type){rt=!0;break}if(rt&&!i[a].isSum&&i[a].members&&0===i[a].members.length)continue;if(e[a]||(e[a]=[],this.valueContent[d]={}),e[a][0]=this.valueContent[d][0]=r.frameHeaderWithKeys(v),this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)){var ct=a,lt=d,at=a,ft=!1;if(((0!==s||0!==this.measureIndex)&&!k||k)&&"value"===v.type&&!v.valueSort.axis||s>this.measureIndex&&"row"===v.axis&&v.valueSort.axis)for(var p=0,ot=!1,vt=v.valueSort.uniqueName?v.valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[],y=0,w=1,g=u.length;y<g;++y){if(!ot)for(p=0;p<o;p++)if(vt.indexOf(this.dataSourceSettings.values[p].name)>-1){ot=!0;ft=!0;break}if(s>this.measureIndex&&"row"===v.axis&&v.valueSort.axis)this.updateRowData(t,u,a,e,p,b,y,w,d,h,c);else{if(!i[f]){ft=!1;break}st=this.showSubTotalsAtBottom&&l?l:f;this.updateRowData(i,u,a,e,p,st,y,w,d,h,c)}w=e[a].length}if(!ft)for(y=0,w=1,g=u.length;y<g;++y)w=e[a].length,e[ct][w]=this.valueContent[lt][w]={axis:"value",actualText:"",colSpan:1,colIndex:w,formattedText:"",hasChild:!1};this.recursiveRowData(t,i,u,at,e,o,k,b,o,s,h,c)}else{for(y=0,w=1,g=u.length;y<g;++y)for(ht=u[y].valueSort.uniqueName?u[y].valueSort.uniqueName.toString().split(this.valueSortSettings.headerDelimiter):[],p=0;p<o;p++)(this.valueAxis||this.isLastHeaderHasMeasures||ht.indexOf(this.dataSourceSettings.values[p].name)>-1)&&(this.updateRowData(t,u,a,e,p,b,y,w,d,h,c),w=e[a].length);this.recursiveRowData(t,i,u,a,e,o,k,b,0,s,h,c)}}},t.prototype.insertRowSubTotals=function(n,t,i,u,f,e,o,s){var nt=!!n[i].type&&"value"===n[i].type&&n[i].valueSort.levelName!==n[i].actualText,l,h,k,a,c,g,p;if(n[i].hasChild&&n[i].isDrilled&&n[i].members.length>0){if(l=[],h=r.frameHeaderWithKeys(n[i]),"value"===n[i].members[0].type){for(var w=0,y=[],v=1,b=0,d=h.members;b<d.length;b++)k=d[b],"value"===k.type&&(y[y.length]=k);for(;w<y.length;){for(a=r.frameHeaderWithKeys(y[w]),c=void 0;v<n.length;v++)if(n[v]&&n[v].valueSort.levelName===a.valueSort.levelName){c=n.indexOf(n[v]);break}c>-1&&(l[l.length]=c);a.formattedText=h.formattedText+" "+a.formattedText;a.isSum=!0;a.members=[];this.getTableData([a],n,t,i,u,f,e,o,s);w++}}else h.formattedText=h.formattedText+" Total",h.members=[],h.isDrilled=!1,h.hasChild=!1,h.isSum=!0,h.type="sum",g=nt?this.getParentIndex(n,h):0,this.getTableData([h],n,t,i,u,f,e,o,s,g),l=[i];for(c=0;c<l.length;c++)p=u[l[c]],p=p.map(function(n){return n.formattedText=0===n.colIndex?n.formattedText:"",n}),u[l[c]]=p}},t.prototype.getParentIndex=function(n,t){for(var r=0,i=n.length-1;i>0;i--)if(t.level===n[i].level&&n[i].index){r=i;break}return r},t.prototype.getAggregatedHeaders=function(n,t,i,r,u){var p,f,o,s,l,y,a,e,c;for(this.selectedHeaders={selectedHeader:[],values:[]},p=u.length,f=0;f<p;f++)switch(u[f].type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":o=void 0;s=void 0;this.selectedHeaders.values.push(u[f].name);u[f].baseField&&u[f].baseItem?(o=u[f].baseField,s=u[f].baseItem):this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?(o=t[0].name,s=Object.keys(this.fieldList[t[0].name].members)[0]):n.length>0&&(o=n[0].name,s=Object.keys(this.fieldList[n[0].name].members)[0]);for(var h=!1,v=0,w=n;v<w.length;v++)if(w[v].name===o){this.getAggregatedHeaderData(i,u[f].name,s,!1,"row",u[f].type,this.selectedHeaders.selectedHeader,f);h=!0;break}if(!h)for(l=0,y=t;l<y.length;l++)if(y[l].name===o){this.getAggregatedHeaderData(r,u[f].name,s,!1,"column",u[f].type,this.selectedHeaders.selectedHeader,f);break}break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":this.selectedHeaders.values.push(u[f].name);this.getAggregatedHeaderData("PercentageOfParentRowTotal"===u[f].type?i:r,u[f].name,void 0,!1,"PercentageOfParentRowTotal"===u[f].type?"row":"column",u[f].type,this.selectedHeaders.selectedHeader,f);break;case"RunningTotals":this.selectedHeaders.values.push(u[f].name);this.getAggregatedHeaderData(this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?r:i,u[f].name,void 0,!1,this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)?"column":"row",u[f].type,this.selectedHeaders.selectedHeader,f);break;case"PercentageOfParentTotal":for(o=void 0,this.selectedHeaders.values.push(u[f].name),u[f].baseField?o=u[f].baseField:this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&t.length>0?o=t[0].name:n.length>0&&(o=n[0].name),h=!1,a=n.length,e=0;e<a;e++)if(n[e].name===o){c=e>=this.measureIndex?e+1:e;this.getAggregatedHeaderData(i,u[f].name,void 0,!1,"row",u[f].type,this.selectedHeaders.selectedHeader,f,c);h=!0;break}if(!h)for(a=t.length,e=0;e<a;e++)if(t[e].name===o){c=e;this.valueAxis||this.isLastHeaderHasMeasures||(c=e>=this.measureIndex?e+1:e);this.getAggregatedHeaderData(r,u[f].name,void 0,!1,"column",u[f].type,this.selectedHeaders.selectedHeader,f,c);break}}},t.prototype.getAggregatedHeaderData=function(t,i,r,u,f,e,o,s,h){for(var c,k,v,d,g,y,p,w,nt,l,ut,a=0,b=t;a<b.length;a++){c=b[a];switch(e){case"DifferenceFrom":case"PercentageOfDifferenceFrom":if(-1!==c.valueSort.levelName.toString().split(this.valueSortSettings.headerDelimiter).indexOf(r)){if(k=[],!u&&"row"===f)for(v=0,d=t;v<d.length;v++)g=d[v],g.level>=c.level&&k.push(g);if(o.push(this.updateSelectedHeaders(r,c.level,f,u,i,e,c.valueSort.levelName,u?[c]:"column"===f?t:k,s+1)),c.members.length>0){if(y=!1,p=[],"row"===f)for(w=0,nt=c.members;w<nt.length;w++){if("value"!==(l=nt[w]).type||0!==l.members.length){p.push(l);y=!1;break}y=!0}(!y&&p.length>0||"column"===f)&&this.getAggregatedHeaderData("column"===f?c.members:p,i,r,!0,f,e,o[o.length-1].childMembers,s)}}else c.members.length>0&&this.getAggregatedHeaderData(c.members,i,r,!1,f,e,o,s);break;case"RunningTotals":case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":"grand sum"===c.type?o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,i,e,c.valueSort.levelName,t,s+1)):c.members.length>0&&(o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,i,e,c.valueSort.levelName,c.members,s+1)),this.getAggregatedHeaderData(c.members,i,void 0,!1,f,e,o,s));break;case"PercentageOfParentTotal":if("grand sum"!==c.type)if(c.valueSort.levelName.split(this.valueSortSettings.headerDelimiter).length-1===h)if(c.members.length>0){if(u)for(var it=o[o.length-1].aggregateHeaders,tt=0,rt=c.members;tt<rt.length;tt++)l=rt[tt],it.push(n.extend({},l,null,!0));else ut=n.extend([],c.members,null,!0),o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,i,e,c.valueSort.levelName,ut,s+1)),(it=o[o.length-1].aggregateHeaders).push(n.extend({},c,null,!0));this.getAggregatedHeaderData(c.members,i,void 0,!0,f,e,o,s,h+1)}else u||o.push(this.updateSelectedHeaders(void 0,c.level,f,!1,i,e,c.valueSort.levelName,[c],s+1));else c.members.length>0&&this.getAggregatedHeaderData(c.members,i,void 0,!1,f,e,o,s,h)}}},t.prototype.updateSelectedHeaders=function(t,i,r,u,f,e,o,s,h){return{name:t,level:i,axis:r,isChild:u,value:f,type:e,uniqueName:o,aggregateHeaders:n.extend([],s,null,!0),childMembers:[],valueCount:h}},t.prototype.applyAdvancedAggregate=function(n,t,i){var y,o,p,s,c,h,l,f;if(this.aggregatedValueMatrix=[],this.selectedHeaders.values.length>0){for(var u={},e=[],a=[],v=!1,w=i.length,r=0;r<w;r++)if(void 0!==i[r]&&void 0!==i[r][0]){if(!v)for(y=i[r].length,o=0;o<y;o++)p=i[r][o].actualText,"value"===i[r][o].axis&&-1!==this.selectedHeaders.values.indexOf(p)&&(e.push(o),v=!0);if(!(this.showSubTotalsAtBottom&&i[r][0].isDrilled&&i[r][0].hasChild)&&e.length>0&&"value"===i[r][e[0]].axis&&-1!==this.selectedHeaders.values.indexOf(i[r][e[0]].actualText))for(a.push(r),s=0,c=e;s<c.length;s++)u[r+","+(f=c[s])]=[r,f]}for(this.updateAggregates(n,t,i,this.selectedHeaders.selectedHeader,e,a,u),h=0,l=Object.keys(u);h<l.length;h++)i[u[f=l[h]][0]][u[f][1]].formattedText=this.selectedHeaders.selectedHeader.length>0?this.emptyCellTextContent:"#N/A",this.aggregatedValueMatrix[u[f][0]]||(this.aggregatedValueMatrix[u[f][0]]=[]),this.aggregatedValueMatrix[u[f][0]][u[f][1]]=0;this.updatePivotValues(!0)}},t.prototype.updateAggregates=function(t,i,r,u,f,e,o){for(var wt,gi,eu,a,lt,ou,nt,l,k,su,hu,d,ut,nr,bt,ir,kt,rr,dt,fr,h,gt,er,ft,ni,sr,ti,hr,ii,cr,lr,ri,ar,ui,fi,ei,vr,oi,yr,si,pr,hi,wr,au,ci,br,li,kr,dr,ai,gr,vi,ot,yi,nu,pi,tu,wi,iu,p,bi,ru,v,ki,uu,vu,vt=0,di=u;vt<di.length;vt++){var w=di[vt],st=w.aggregateHeaders,b=w.value,fu=w.type,ct=w.uniqueName,yt="row"===w.axis,tt=void 0,it=[],y=[],pt=[],ht=[],et=[],rt=[];if(-1!==["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal","RunningTotals"].indexOf(w.type))if(yt){if("RunningTotals"!==w.type)for(wt=0,gi=e;wt<gi.length;wt++)if(void 0!==t[v=gi[wt]]&&t[v].valueSort[ct]){tt=t[v];et=0===this.valueAxis||this.valueAxis&&r[v]&&r[v][1]&&r[v][1].actualText===b?r[v]:[];break}}else{for(eu=r.length,a=0;a<eu&&void 0!==r[a]&&void 0===r[a][0];a++)pt.push(r[a]);for(lt=pt.length;lt--;)ou=(ut=pt[lt][f[0]]).actualText,-1===this.selectedHeaders.values.indexOf(ou)&&(y=pt[lt],lt=0);if("RunningTotals"!==w.type){for(nt=y.length,l=0;l<nt;l++)if(k=!1,void 0!==y[l]&&y[l].valueSort[ct]){for(tt=y[l],su=r.length,a=0;a<su;a++)void 0!==(ut=r[a])&&void 0!==ut[0]&&"value"===ut[l].axis&&-1!==this.selectedHeaders.values.indexOf(ut[l].actualText)&&(k=!0,rt[a]=ut[l],ht.push(a));if(k)break}if(0===rt.length&&0===ht.length)for(nt=y.length,l=0;l<nt;l++)if(k=!1,void 0!==y[l]&&0===y[l].valueSort.levelName.indexOf(ct)){for(tt=y[l],hu=r.length,d=0;d<hu;d++)void 0!==(ut=r[d])&&void 0!==ut[0]&&"value"===ut[l].axis&&-1!==this.selectedHeaders.values.indexOf(ut[l].actualText)&&(k=!0,ht.push(d));if(k)break}}}switch(w.type){case"DifferenceFrom":case"PercentageOfDifferenceFrom":if(nr=w.isChild,yt){if(nr){for(var at=ct.split(this.valueSortSettings.headerDelimiter),tr=0,cu=e;tr<cu.length;tr++)if(void 0!==t[p=cu[tr]]&&-1!==t[p].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(at[at.length-1])&&tt&&t[p].level===tt.level)for(bt=0,ir=f;bt<ir.length;bt++)h=ir[bt],"value"===(s=r[p][h]).axis&&s.actualText===b&&(it.push([p,h]),o[p+","+h]&&delete o[p+","+h])}else for(kt=0,rr=st;kt<rr.length;kt++)for(var g=rr[kt],ur=0,lu=e;ur<lu.length;ur++)if(void 0!==t[v=lu[ur]]&&t[v].valueSort[g.valueSort.levelName]&&t[v].level===tt.level&&"grand sum"!==t[v].type)for(dt=0,fr=f;dt<fr.length;dt++)h=fr[dt],"value"===(s=r[v][h]).axis&&s.actualText===b&&(it.push([v,h]),o[v+","+h]&&delete o[v+","+h]);for(gt=0,er=it;gt<er.length;gt++){var s=r[(h=er[gt])[0]][h[1]],or=n.isNullOrUndefined(et[h[1]].actualValue)?0:et[h[1]].actualValue,c=(n.isNullOrUndefined(s.actualValue)?0:s.actualValue)-or;c=isNaN(c)||0===s.value&&0===et[h[1]].value?0:c;this.aggregatedValueMatrix[h[0]]||(this.aggregatedValueMatrix[h[0]]=[]);"DifferenceFrom"===fu?(this.aggregatedValueMatrix[h[0]][h[1]]=c,s.formattedText=0===c?this.emptyCellTextContent:this.getFormattedValue(c,b).formattedText):(c=0===or?0:c/or,this.aggregatedValueMatrix[h[0]][h[1]]=c,s.formattedText=s.showSubTotals?0!==c?this.globalize.formatNumber(c,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,s.actualText)}):this.emptyCellTextContent:s.formattedText)}}else{if(nr){for(at=ct.split(this.valueSortSettings.headerDelimiter),nt=y.length,ft=0;ft<nt;ft++)if(k=!1,void 0!==y[ft]&&-1!==y[ft].valueSort.levelName.split(this.valueSortSettings.headerDelimiter).indexOf(at[at.length-1])&&y[ft].level===tt.level){for(ni=0,sr=ht;ni<sr.length;ni++)"value"===(s=r[h=sr[ni]][ft]).axis&&s.actualText===b&&(k=!0,it.push([h,ft]),o[h+","+ft]&&delete o[h+","+ft]);if(k)break}}else for(ti=0,hr=st;ti<hr.length;ti++)for(g=hr[ti],nt=y.length,l=0;l<nt;l++)if(k=!1,void 0!==y[l]&&y[l].valueSort[g.valueSort.levelName]&&tt&&y[l].level===tt.level&&"grand sum"!==y[l].type){for(ii=0,cr=ht;ii<cr.length;ii++)"value"===(s=r[h=cr[ii]][l]).axis&&s.actualText===b&&(k=!0,it.push([h,l]),o[h+","+l]&&delete o[h+","+l]);if(k)break}for(lr=void 0,0===rt.length&&(lr=this.getSelectedColumn(w.uniqueName,i)),ri=0,ar=it;ri<ar.length;ri++)s=r[(h=ar[ri])[0]][h[1]],ui=0,0===rt.length?(fi=this.getSelectedRow(s.rowHeaders,t),ui=this.getAggregateValue(fi.index,lr.indexObject,this.fieldList[b].index,w.type,!1)):ui=rt[h[0]].value,c=s.value-ui,c=isNaN(c)?0:c,this.aggregatedValueMatrix[h[0]]||(this.aggregatedValueMatrix[h[0]]=[]),"DifferenceFrom"===fu?(s.formattedText=0===c?this.emptyCellTextContent:this.getFormattedValue(c,b).formattedText,this.aggregatedValueMatrix[h[0]][h[1]]=c):(c=0===rt[h[0]].value?0:c/rt[h[0]].value,s.formattedText=0!==c?this.globalize.formatNumber(c,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,s.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[h[0]][h[1]]=c)}w.childMembers.length>0&&this.updateAggregates(t,i,r,w.childMembers,f,e,o);break;case"PercentageOfParentRowTotal":case"PercentageOfParentColumnTotal":case"PercentageOfParentTotal":if(yt){for(ei=0,vr=st;ei<vr.length;ei++)for(g=vr[ei],oi=0,yr=e;oi<yr.length;oi++)if(void 0!==t[a=yr[oi]]&&t[a].valueSort[g.valueSort.levelName]&&t[a].level===g.level)for(si=0,pr=f;si<pr.length;si++)h=pr[si],"value"===(s=r[a][h]).axis&&s.actualText===b&&(it.push([a,h]),o[a+","+h]&&delete o[a+","+h]);for(hi=0,wr=it;hi<wr.length;hi++)s=r[(a=wr[hi])[0]][a[1]],au=0===et.length&&tt?this.getAggregateValue(tt.index,i[a[1]-1].indexObject,this.fieldList[b].index,w.type,!1):et[a[1]]?et[a[1]].actualValue:0,c=s.value/au,c=isNaN(c)?0:c,s.formattedText=s.showSubTotals?0!==c?this.globalize.formatNumber(c,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,s.actualText)}):this.emptyCellTextContent:s.formattedText,this.aggregatedValueMatrix[a[0]]||(this.aggregatedValueMatrix[a[0]]=[]),this.aggregatedValueMatrix[a[0]][a[1]]=c}else{for(ci=0,br=st;ci<br.length;ci++)for(g=br[ci],nt=y.length,d=0;d<nt;d++)if(k=!1,void 0!==y[d]&&y[d].valueSort[g.valueSort.levelName]){for(li=0,kr=ht;li<kr.length;li++)h=kr[li],this.showSubTotalsAtBottom&&r[h][0].isDrilled&&r[h][0].hasChild||"value"===(s=r[h][d]).axis&&s.actualText===b&&(k=!0,it.push([h,d]),o[h+","+d]&&delete o[h+","+d]);if(k)break}for(dr=void 0,0===rt.length&&(dr=this.getSelectedColumn(w.uniqueName,i)),ai=0,gr=it;ai<gr.length;ai++)s=r[(a=gr[ai])[0]][a[1]],vi=0,0===rt.length?(fi=this.getSelectedRow(s.rowHeaders,t),vi=this.getAggregateValue(fi.index,dr.indexObject,this.fieldList[b].index,w.type,!1)):vi=rt[a[0]].value,ot=s.value/vi,ot=isNaN(ot)?0:ot,s.formattedText=0!==ot?this.globalize.formatNumber(ot,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,s.actualText)}):this.emptyCellTextContent,this.aggregatedValueMatrix[a[0]]||(this.aggregatedValueMatrix[a[0]]=[]),this.aggregatedValueMatrix[a[0]][a[1]]=ot}break;case"RunningTotals":if(yt){for(yi=0,nu=f;yi<nu.length;yi++)for(h=nu[yi],c=0,pi=0,tu=st;pi<tu.length;pi++)for(g=tu[pi],wi=0,iu=e;wi<iu.length;wi++)if(void 0!==t[p=iu[wi]]&&(s=r[p][h],void 0!==t[p]&&t[p].valueSort[g.valueSort.levelName]&&t[p].level===g.level&&"value"===s.axis&&s.actualText===b)){"grand sum"!==t[p].type&&(c+=s.showSubTotals||!n.isNullOrUndefined(s.actualValue)&&isNaN(s.actualValue)?n.isNullOrUndefined(s.value)||isNaN(s.value)?null:s.value:s.actualValue,s.formattedText=s.showSubTotals?0===c&&s.actualValue&&0!==s.actualValue?"":this.getFormattedValue(c,b).formattedText:s.formattedText,this.aggregatedValueMatrix[p]||(this.aggregatedValueMatrix[p]=[]),this.aggregatedValueMatrix[p][h]=c);o[p+","+h]&&delete o[p+","+h];break}}else for(bi=0,ru=e;bi<ru.length;bi++)if(void 0!==r[v=ru[bi]])for(c=0,ki=0,uu=st;ki<uu.length;ki++)for(g=uu[ki],vu=t[v].hasChild&&t[v].isDrilled&&(!n.isNullOrUndefined(t[v].showSubTotals)&&!t[v].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals),nt=y.length,l=0;l<nt;l++)if(s=r[v][l],void 0!==y[l]&&y[l].valueSort[g.valueSort.levelName]&&"value"===s.axis&&s.actualText===b){"grand sum"!==y[l].type&&(n.isNullOrUndefined(s.value)||(c+=s.value),s.formattedText=vu?"":this.getFormattedValue(c,b).formattedText,this.aggregatedValueMatrix[v]||(this.aggregatedValueMatrix[v]=[]),this.aggregatedValueMatrix[v][l]=c);o[v+","+l]&&delete o[v+","+l];break}}}},t.prototype.getSelectedColumn=function(n,t){for(var i,r={axis:"column",index:[],indexObject:{}},u=0,f=t;u<f.length;u++)i=f[u],i&&i.valueSort&&0===i.valueSort.levelName.indexOf(n)&&(r.index=r.index.concat(i.index).sort(function(n,t){return n-t}),r.indexObject=we({},r.indexObject,i.indexObject));return r},t.prototype.getSelectedRow=function(n,t){for(var i,r=0,u=t;r<u.length;r++)if(i=u[r],i&&(i.valueSort&&i.valueSort.levelName===n||""===n&&"grand sum"===i.type))return i;return null},t.prototype.recursiveRowData=function(t,i,r,u,f,e,o,s,h,c,l,a){o||this.getTableData(i[u].members,i,r,u,f,e,c+1,l,a);this.showSubTotalsAtBottom&&(n.isNullOrUndefined(t[s].showSubTotals)||t[s].showSubTotals)&&this.insertRowSubTotals(i,r,u,f,e,c,l,a);this.isPagingOrVirtualizationEnabled||(i[u].members=[])},t.prototype.updateRowData=function(t,i,r,u,f,e,o,s,h,c,l){var tt=this.fieldList[this.dataSourceSettings.values[f].name].index,p=this.fieldList[this.dataSourceSettings.values[f].name].aggregateType,ot=this.dataSourceSettings.values[f].name,it=[],v={},a=0,g=0,b,y,nt,ft,k;switch(p){case"Index":for(var rt=["cVal","rTotalVal","cTotalVal","gTotalVal"],w=0,ut=0,st=it=[[t[e],i[o]],[t[e],l],[c,i[o]],[c,l]];ut<st.length;ut++)b=st[ut],v[rt[w]]=this.getAggregateValue(b[0].index,b[1].indexObject,tt,p,0!==w),w++;y=v.cVal*v.gTotalVal/(v.rTotalVal*v.cTotalVal);a=!(t[e].members.length>0&&t[e].hasChild&&t[e].isDrilled)||(n.isNullOrUndefined(t[e].showSubTotals)||t[e].showSubTotals)&&this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals?n.isNullOrUndefined(v.cVal)?v.cVal:isNaN(y)?0:y:void 0;g=n.isNullOrUndefined(v.cVal)?v.cVal:isNaN(y)?0:y;break;case"PercentageOfGrandTotal":case"PercentageOfColumnTotal":case"PercentageOfRowTotal":for((it=[[t[e],i[o]]]).push("PercentageOfGrandTotal"===p?[c,l]:"PercentageOfColumnTotal"===p?[c,i[o]]:[t[e],l]),rt=["cVal","gTotalVal"],w=0,nt=0,ft=it;nt<ft.length;nt++)b=ft[nt],v[rt[w]]=this.getAggregateValue(b[0].index,b[1].indexObject,tt,p,0!==w),w++;y=v.cVal/v.gTotalVal;a=!(t[e].members.length>0&&t[e].hasChild&&t[e].isDrilled)||(n.isNullOrUndefined(t[e].showSubTotals)||t[e].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?n.isNullOrUndefined(v.cVal)?v.cVal:isNaN(y)?0:y:void 0;g=n.isNullOrUndefined(v.cVal)?v.cVal:isNaN(y)?0:y;break;default:y=this.getAggregateValue(t[e].index,i[o].indexObject,tt,p,!1);a=!(t[e].members.length>0&&t[e].hasChild&&t[e].isDrilled)||(n.isNullOrUndefined(t[e].showSubTotals)||t[e].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals?y:void 0;g=y}k={fieldName:this.dataSourceSettings.values[f].name,row:t[e],column:i[o],value:a,cellSets:this.getValueCellInfo?this.getCellSet(this.rawIndexObject):[],rowCellType:t[e].hasChild&&t[e].isDrilled?"subTotal":"grand sum"===t[e].type?"grandTotal":"value",columnCellType:i[o].hasChild&&i[o].isDrilled?"subTotal":"grand sum"===i[o].type?"grandTotal":"value",aggregateType:p,skipFormatting:!1};this.getValueCellInfo&&this.getValueCellInfo(k);a=k.value;var ht=t[e].hasChild||i[o].hasChild||"grand sum"===t[e].type||"grand sum"===i[o].type||this.showSubTotalsAtBottom&&t[e].isSum,ct="grand sum"===t[e].type||"grand sum"===i[o].type,et=t[e].members.length>0&&t[e].hasChild&&t[e].isDrilled&&(!n.isNullOrUndefined(t[e].showSubTotals)&&!t[e].showSubTotals||!this.dataSourceSettings.showSubTotals||!this.dataSourceSettings.showRowSubTotals),d=et?"":void 0===a?this.emptyCellTextContent:"Count"===p||"DistinctCount"===p?a.toLocaleString():this.getFormattedValue(a,ot).formattedText;!isNaN(a)&&!n.isNullOrUndefined(a)&&["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal"].indexOf(p)>=0?d=this.globalize.formatNumber(a,{format:"P",maximumFractionDigits:this.getPercentFormat(this.formatFields,k.fieldName)}):et||!isNaN(a)||n.isNullOrUndefined(a)||-1===["PopulationStDev","SampleStDev","PopulationVar","SampleVar"].indexOf(p)||(d="#DIV/0!",a=0);d=k.skipFormatting?n.isNullOrUndefined(a)?this.emptyCellTextContent:a.toString():d;u[r][s]=this.valueContent[h][s]={axis:"value",actualText:ot,indexObject:this.isDrillThrough?this.rawIndexObject:{},rowHeaders:"grand sum"===t[e].type?"":t[e].valueSort.levelName,columnHeaders:"grand sum"===i[o].type?"":i[o].valueSort.levelName,formattedText:d,value:a,hierarchyName:i[o].hierarchyName,actualValue:g,rowIndex:r,colIndex:s,isSum:ht,isGrandSum:ct,showSubTotals:!et};this.rawIndexObject={}},t.prototype.getCellSet=function(n){for(var i,r=[],t=0,u=Object.keys(n);t<u.length;t++)i=u[t],this.data[parseInt(i,10)]&&r.push(this.data[parseInt(i,10)]);return r},t.prototype.updateValueMembers=function(t,i,u,f,e,o,s){var a=u&&!n.isNullOrUndefined(u.levelName)?u.levelName.toString():void 0,v=u&&!n.isNullOrUndefined(u.uniqueName)?u.uniqueName.toString():void 0,w,p,l,nt,h,c,d,g;if(t)for(w=0;w<o;w++){var y=this.dataSourceSettings.values[w],k=y.caption?y.caption:y.name,b={axis:this.valueAxis?"row":"column",rowIndex:this.valueAxis?0:i&&s<=i.rowIndex?i.rowIndex+1:s,actualText:y.name,formattedText:k,level:0,valueSort:{},members:[],type:this.valueAxis?"value":i?i.type:null,index:!this.valueAxis&&i?i.index:null,indexObject:!this.valueAxis&&i?i.indexObject:null};e.length>0&&(b.showSubTotals=y.showSubTotals);p=b.valueSort;p.axis=this.valueAxis?void 0:y.name;p[(a?a+this.valueSortSettings.headerDelimiter:"")+k]=1;p[(v?v+this.valueSortSettings.headerDelimiter:"")+y.name]=1;p.levelName=(a?a+this.valueSortSettings.headerDelimiter:"")+k;p.uniqueName=(v?v+this.valueSortSettings.headerDelimiter:"")+y.name;f.push(b);this.updateValueMembers(!1,i,p,b.members,e,o,s+1)}else for(l=0,nt=e.length;l<nt;l++)h=r.frameHeaderWithKeys(e[l]),h.members=[],h.rowIndex=this.valueAxis?h.rowIndex:s<0?0:s,c={},c.axis=h.valueSort.axis,c[(a?a+this.valueSortSettings.headerDelimiter:"")+h.formattedText]=1,c[(v?v+this.valueSortSettings.headerDelimiter:"")+h.actualText]=1,c.levelName=(a?a+this.valueSortSettings.headerDelimiter:"")+h.formattedText,c.uniqueName=(v?v+this.valueSortSettings.headerDelimiter:"")+h.actualText,h.hierarchyName=h.valueSort.uniqueName,h.valueSort=c,d=c.axis+this.valueSortSettings.headerDelimiter+c.levelName,g=this.fieldList[c.axis],h.isDrilled&&((this.isExpandAll||g.expandAll)&&this.fieldDrillCollection[d]||!this.isExpandAll&&!g.expandAll&&!this.fieldDrillCollection[d])&&(h.isDrilled=!1),f.push(h),h.isDrilled&&e[l].members.length>0?(this.valueAxis&&s<this.measureIndex&&this.measureIndex!==s+1&&(!e[l].hasChild||(n.isNullOrUndefined(e[l].showSubTotals)||e[l].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showRowSubTotals)&&this.updateValueMembers(!0,h,c,f[f.length-1].members,[],o,s),this.updateValueMembers(this.measureIndex===s+1,h,c,f[f.length-1].members,e[l].members,o,s+1),!this.valueAxis&&s<this.measureIndex&&this.measureIndex!==s+1&&(!e[l].hasChild||(n.isNullOrUndefined(e[l].showSubTotals)||e[l].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals)&&this.updateValueMembers(!0,h,c,f[f.length-1].members,[],o,s)):s<this.measureIndex&&this.updateValueMembers(!0,h,c,f[f.length-1].members,[],o,s)},t.prototype.reArrangeValueMember=function(n){for(var r,t=[],i=0,u=n;i<u.length;i++)r=u[i],this.valueAxisFields[r.actualText]&&(t[t.length]=r);return t.concat(n).slice(0,n.length)},t.prototype.frameDefinedHeaderData=function(t,i,u,f,e,o){for(var h,a,l,v,c,s=0,y=t.length;s<y;s++)h=!0,!(t[s].members.length>0)||(n.isNullOrUndefined(t[s].showSubTotals)||t[s].showSubTotals)&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals||(h=!1),a=this.measureIndex<f&&h?1:this.measureIndex>f&&t[s].members.length>0||this.measureIndex!==f+1||!t[s].isDrilled?this.measureIndex===f&&0!==this.measureIndex&&h||this.measureIndex>f&&h&&t[s].valueSort&&t[s].valueSort.axis&&this.measureNames[t[s].valueSort.axis.toString()]?1:0:0!==this.measureIndex&&h?1:0,t[s].members.length&&(l=void 0,v=t[s].members,this.showSubTotalsAtTop?f+1<this.measureIndex&&h?(l=e,v=this.reArrangeValueMember(v)):l=e+a:l=e,this.frameDefinedHeaderData(v,i,u,f+1,l,o)),c=this.measureIndex>f&&t[s].valueSort&&t[s].valueSort.axis&&this.measureNames[t[s].valueSort.axis.toString()]?this.measureIndex:f,i[(e=this.showSubTotalsAtTop?e+1:i.length+a)-1]||(i[e-1]=r.frameHeaderWithKeys(t[s])),t[s].colIndex=e,u[c]||(u[c]=[],this.headerContent[c]={}),u[c][e]=this.headerContent[c][e]=r.frameHeaderWithKeys(t[s]),this.isPagingOrVirtualizationEnabled||this.showSubTotalsAtTop&&0===a||i[e-1]&&(i[e-1].members=[]),this.showSubTotalsAtTop&&(e=i.length,s+1===y&&0===t[s].level&&(this.reformAxisCount=i.length+1))},t.prototype.getHeaderData=function(t,i,u,f,e,o,s,h,c){var st,it,rt,w,ut,ht,ct,g,ft,pt,y,et,wt,nt,k,lt,tt,p,l,bt,a,ot,at,b;if(this.valueAxis||this.isLastHeaderHasMeasures){if(0===f.length&&this.valueAxis&&(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader)&&this.dataSourceSettings.values.length>0&&(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&"grand sum"===this.rMembers[this.rMembers.length-1].type?(this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,f,this.rMembers.slice(0,this.rMembers.length-1),this.dataSourceSettings.values.length,0),this.updateValueMembers(!1,null,null,f,this.rMembers.slice(this.rMembers.length-1,this.rMembers.length),this.dataSourceSettings.values.length,-1)):"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex?(this.updateValueMembers(!1,null,null,f,this.rMembers.slice(0,1),this.dataSourceSettings.values.length,-1),this.updateValueMembers(0===this.measureIndex&&this.rMembers.length>1,null,null,f,this.rMembers.slice(1,this.rMembers.length),this.dataSourceSettings.values.length,0)):(st=0===t.length&&1===this.rMembers.length&&"grand sum"===this.rMembers[0].type,this.updateValueMembers(!st&&0===this.measureIndex,null,null,f,this.rMembers,this.dataSourceSettings.values.length,st?-1:0)),this.getAggregatedHeaders(t,i,f,e,u),this.selectedHeaders.values.length>0))for(tt=this.selectedHeaders.selectedHeader.length,p=0;p<tt;p++)if("row"===(l=this.selectedHeaders.selectedHeader[p]).axis)for(it=l.aggregateHeaders.length,a=0;a<it;a++)if(l.aggregateHeaders[a].actualText===l.value)if(-1!==l.aggregateHeaders[a].valueSort.levelName.indexOf(l.uniqueName))l.uniqueName=l.aggregateHeaders[a].valueSort.levelName,l.aggregateHeaders.splice(a,1),a--,it--;else for(rt=l.aggregateHeaders[a].members.length,w=0;w<rt;w++)"value"!==(b=l.aggregateHeaders[a].members[w]).type&&b.level===l.aggregateHeaders[a].level&&(ut=n.extend([],l.aggregateHeaders[a].members,null,!0),l.aggregateHeaders=[].concat(l.aggregateHeaders,ut,l.aggregateHeaders.splice(a)),l.aggregateHeaders.splice(ut.length+a,1),a=ut.length+a-1,it=l.aggregateHeaders.length);else if(l.aggregateHeaders[a].actualText!==l.value&&l.aggregateHeaders[a].members.length>0)for(rt=l.aggregateHeaders[a].members.length,w=0;w<rt;w++)if((b=l.aggregateHeaders[a].members[w]).actualText===l.value){l.uniqueName===l.aggregateHeaders[a].valueSort.levelName&&(l.uniqueName=b.valueSort.levelName);l.aggregateHeaders[a].members.splice(w,1);l.aggregateHeaders[a]=b;break}for(var vt=e.length,d=this.dataSourceSettings.columns.length,yt=""!==this.valueSortSettings.rowHeader?this.valueSortSettings.rowHeader:this.valueSortSettings.columnHeader,v=0;v<vt;v++){if(ht=!n.isNullOrUndefined(e[v].showSubTotals)&&!e[v].showSubTotals,e[v].members.length&&this.getHeaderData(t,i,u,f,e[v].members,o,s,this.showSubTotalsAtTop&&!ht?h+1:h,c),ct=!0,h=this.showSubTotalsAtTop?h:o.length,!ht&&this.dataSourceSettings.showSubTotals&&this.dataSourceSettings.showColumnSubTotals?o[h]=r.frameHeaderWithKeys(e[v]):(e[v].members.length>0?(this.removeCount++,ct=!1):o[this.showSubTotalsAtTop?h:o.length]=r.frameHeaderWithKeys(e[v]),h=this.showSubTotalsAtTop?h:o.length-1),g=e[v].level,e[v].rowIndex=g,ft=h*c+(this.showSubTotalsAtTop?1:c),e[v].colIndex=ft,s[g]||(s[g]=[],this.headerContent[g]={}),s[g][ft]=this.headerContent[g][ft]=r.frameHeaderWithKeys(e[v]),pt=0===this.dataSourceSettings.columns.length&&1===this.dataSourceSettings.values.length,(this.isMultiMeasures||this.dataSourceSettings.alwaysShowValueHeader||pt)&&!this.valueAxis&&ct)for(y=0;y<c;y++)et=this.dataSourceSettings.values[y].caption?this.dataSourceSettings.values[y].caption:this.dataSourceSettings.values[y].name,wt={axis:"column",actualText:this.dataSourceSettings.values[y].name,formattedText:et,level:0,valueSort:{},colIndex:h*c+1+y,rowIndex:d},s[d]||(s[d]=[],this.headerContent[d]={}),s[d][h*c+1+y]=this.headerContent[d][h*c+1+y]=wt,nt=s[d][h*c+1+y].valueSort,nt[e[v].valueSort.levelName+this.valueSortSettings.headerDelimiter+et]=1,nt.levelName=e[v].valueSort.levelName+this.valueSortSettings.headerDelimiter+et,nt[e[v].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[y].name]=1,nt.uniqueName=e[v].valueSort.uniqueName+this.valueSortSettings.headerDelimiter+this.dataSourceSettings.values[y].name,nt&&nt[yt]&&(this.valueSortSettings.columnIndex=h*c+1+y);else e[v].valueSort&&e[v].valueSort[yt]&&(this.valueSortSettings.columnIndex=h*c+1);this.isPagingOrVirtualizationEnabled||(o[h].members=[]);this.showSubTotalsAtTop&&(h=o.length,0===e[v].level&&v+1===vt&&(this.reformAxisCount=o.length*c+1))}}else{if(k=[],this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals&&"grand sum"===e[e.length-1].type?(this.updateValueMembers(0===this.measureIndex&&e.length>1,null,null,k,e.slice(0,e.length-1),c,0),this.updateValueMembers(!1,null,null,k,e.slice(e.length-1,e.length),c,-1)):"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&0===this.measureIndex?(this.updateValueMembers(!1,null,null,k,e.slice(0,1),c,-1),this.updateValueMembers(0===this.measureIndex&&e.length>1,null,null,k,e.slice(1,e.length),c,0)):(lt=0===i.length&&1===e.length&&"grand sum"===e[0].type,this.updateValueMembers(!lt&&0===this.measureIndex,null,null,k,e,c,lt?-1:0)),this.getAggregatedHeaders(t,i,this.rMembers,k,u),this.selectedHeaders.values.length>0)for(tt=this.selectedHeaders.selectedHeader.length,p=0;p<tt;p++)if("column"===(l=this.selectedHeaders.selectedHeader[p]).axis)if(l.uniqueName===l.value)this.selectedHeaders.selectedHeader.splice(p,1),p--,tt--;else if("Grand Total"===l.uniqueName)for(bt=l.aggregateHeaders.length,a=0;a<bt;a++)if(l.aggregateHeaders[a]&&l.aggregateHeaders[a].members.length>0)for(ot=0,at=l.aggregateHeaders[a].members;ot<at.length;ot++)(b=at[ot]).actualText===l.value&&(l.aggregateHeaders[a]=b,"grand sum"===b.type&&(l.uniqueName=b.valueSort.levelName));this.frameDefinedHeaderData(k,o,s,0,this.showSubTotalsAtTop?0:1,c)}},t.prototype.getAggregateValue=function(t,i,r,u,f){var e=0,o=0,ft=0,d=!0,h=!1,a,b,p,c,s,k,nt,ht,tt,it,y,w,at;switch(u.toLowerCase()){case"median":for(a=[],b=0;void 0!==t[e];)void 0!==i[t[e]]&&(h=!0,this.rawIndexObject[t[e]]=t[e],n.isNullOrUndefined(this.valueMatrix[t[e]][r])||a.push(this.valueMatrix[t[e]][r])),e++;(l=a.length)>0&&(a.sort(function(n,t){return n-t}),o=l%2==0?(a[b=l/2<=1?0:l/2-1]+a[b+1])/2:a[b=(l+1)/2<=1?0:(l+1)/2-1]);break;case"count":for(;void 0!==t[e];)void 0!==i[t[e]]&&(h=!0,this.rawIndexObject[t[e]]=t[e],o+=n.isNullOrUndefined(this.valueMatrix[t[e]][r])?0:this.allowDataCompression?this.valueMatrix[t[e]][r]:1),e++;break;case"distinctcount":for(p=[];void 0!==t[e];)void 0!==i[t[e]]&&(this.rawIndexObject[t[e]]=t[e],h=!0,c=this.data[t[e]][this.fieldKeys[this.fields[r]]],n.isNullOrUndefined(c)||(s=c.toString(),(0===p.length||p.length>0&&-1===p.indexOf(s))&&(o+=this.allowDataCompression&&"number"==typeof c?c:1,p.push(s)))),e++;break;case"product":for(;void 0!==t[e];)void 0!==i[t[e]]&&(this.rawIndexObject[t[e]]=t[e],h=!0,s=this.valueMatrix[t[e]][r],n.isNullOrUndefined(s)?d&&(o=s):(o=d||n.isNullOrUndefined(o)?1:o,o*=s),d=!1),e++;break;case"populationstdev":case"samplestdev":case"populationvar":case"samplevar":for(var v=0,et=(c=0,[]),ot=0,st=0,g=0;void 0!==t[e];)void 0!==i[t[e]]&&(h=!0,this.rawIndexObject[t[e]]=t[e],s=this.valueMatrix[t[e]][r],n.isNullOrUndefined(s)||(c+=s,et.push(s),v++)),e++;if(v>0){for(ot=c/v,k=0,nt=et;k<nt.length;k++)ht=nt[k],g+=Math.pow(ht-ot,2);o=0===(st=-1!==["populationstdev","samplestdev"].indexOf(u.toLowerCase())?Math.sqrt(g/("populationstdev"===u.toLowerCase()?v:v-1)):g/("populationvar"===u.toLowerCase()?v:v-1))?NaN:st}else o=c;break;case"min":for(tt=!0,o=void 0;void 0!==t[e];)void 0!==i[t[e]]&&void 0!==this.valueMatrix[t[e]][r]&&(h=!0,this.rawIndexObject[t[e]]=t[e],n.isNullOrUndefined(o)&&n.isNullOrUndefined(this.valueMatrix[t[e]][r])?o=this.valueMatrix[t[e]][r]:tt?(o=this.valueMatrix[t[e]][r],tt=!1):o=this.valueMatrix[t[e]][r]<o?this.valueMatrix[t[e]][r]:o),e++;break;case"max":for(it=!0;void 0!==t[e];)void 0!==i[t[e]]&&void 0!==this.valueMatrix[t[e]][r]&&(h=!0,this.rawIndexObject[t[e]]=t[e],it?(o=this.valueMatrix[t[e]][r],it=!1):o=this.valueMatrix[t[e]][r]>o?this.valueMatrix[t[e]][r]:o),e++;break;case"calculatedfield":h=!0;var rt=this.calculatedFields[this.fields[r]],ut=rt.formula,ct={};if(this.calculatedFormulas[rt.name])for(var lt=this.calculatedFormulas[rt.name],l=0,vt=lt.length;l<vt;l++)y=lt[l],w=ct[y.formula],void 0===w&&(at=y.type,w=this.getAggregateValue(t,i,y.index,at,!1),ct[y.formula]=w),ut=ut.replace(y.formula,String(w));o=(o=this.evaluate(ut))===1/0||o===-1/0?1/0:void 0===o||isNaN(o)?void 0:JSON.parse(String(o));break;default:for(o=void 0;void 0!==t[e];)void 0!==i[t[e]]&&(h=!0,f||(this.rawIndexObject[t[e]]=t[e]),s=this.valueMatrix[t[e]][r],n.isNullOrUndefined(o)&&n.isNullOrUndefined(s)?o=s:(n.isNullOrUndefined(o)&&(o=0),o+=n.isNullOrUndefined(s)?0:s),n.isNullOrUndefined(s)||ft++),e++}return u&&"avg"===u.toLowerCase()&&0!==o&&!n.isNullOrUndefined(o)?o/ft:h?o:void 0},t.prototype.evaluate=function(n){return Function('"use strict";return ('+n+")")()},t.prototype.getFormattedValue=function(t,i){var f=null===t?this.localeObj?this.localeObj.getConstant("null"):String(t):void 0===t?this.localeObj?i in this.groupingFields?this.localeObj.getConstant("groupOutOfRange"):this.localeObj.getConstant("undefined"):String(t):t,u={formattedText:f.toString(),actualText:f,dateText:f},s,r,e,o,h;if(this.formatFields[i]&&(this.formatFields[i].format||this.formatFields[i].skeleton)&&!n.isNullOrUndefined(t))try{s=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i];r=n.extend({},s,null,!0);(delete r.name,!r.minimumSignificantDigits&&r.minimumSignificantDigits<1&&delete r.minimumSignificantDigits,!r.maximumSignificantDigits&&r.maximumSignificantDigits<1&&delete r.maximumSignificantDigits,r.type)?(u.formattedText=this.dateFormatFunction[i].exactFormat(new Date(t)),u.actualText=t):((delete r.type,r.format&&!this.formatRegex.test(r.format))&&(e=r.format.match(/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/),o=!0,(n.isNullOrUndefined(r.minimumFractionDigits)&&delete r.minimumFractionDigits,n.isNullOrUndefined(r.maximumFractionDigits)&&delete r.maximumFractionDigits,n.isNullOrUndefined(r.minimumIntegerDigits)&&delete r.minimumIntegerDigits,n.isNullOrUndefined(e)&&(e=r.format.match(/^(('[^']+'|''|[^*@0])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@,.E])*)$/),delete r.useGrouping,o=!1),e&&e.length>5)&&(h=e[6],o&&(r.useGrouping=-1!==h.indexOf(",")))),u.formattedText=this.globalize.formatNumber(isNaN(Number(t))?t:Number(t),r),u.actualText=isNaN(Number(t))?t:Number(t),u.dateText=isNaN(Number(t))?t:Number(t));"None"!==this.fieldList[i].sort&&r.type&&["date","dateTime","time"].indexOf(this.formatFields[i].type)>-1&&(u.dateText=this.dateFormatFunction[i].fullFormat(new Date(t)));this.fieldList[i].isCustomField&&(u.formattedText="NaN"===u.formattedText?f.toString():u.formattedText,u.dateText="NaN"===u.dateText?f.toString():u.dateText)}catch(t){if(!this.fieldList[i].isCustomField)throw t;}finally{this.fieldList[i].isCustomField&&(u.formattedText=n.isNullOrUndefined(u.formattedText)||"NaN"===u.formattedText?f.toString():u.formattedText,u.dateText=n.isNullOrUndefined(u.dateText)||"NaN"===u.dateText?f.toString():u.dateText)}return u},t.prototype.powerFunction=function(n){if(n.indexOf("^")>-1){for(var t=[];n.indexOf("(")>-1;)n=n.replace(/(\([^\(\)]*\))/g,function(n,i){return t.push(i),"~"+(t.length-1)});for(t.push(n),n="~"+(t.length-1);n.indexOf("~")>-1;)n=n.replace(new RegExp("~(\\d+)","g"),function(n,i){return t[i].replace(/(\w*)\^(\w*)/g,"Math.pow($1,$2)")})}return n},t}();const b=ejdashboard.popups;var as="load",ni="enginePopulating",ti="enginePopulated",be="fieldDrop",ou="beforeExport",ke="exportComplete",hf="dataBound",cf="cellSelecting",lf="drill",vs="editCompleted",ys="aggregateCellInfo",su="onHeadersSort",ps="memberFiltering",de="fieldRemove",ge="aggregateMenuOpen",ws="fieldDragStart",bs="beforeServiceInvoke",ks="afterServiceInvoke",ds="actionBegin",gs="actionComplete",nh="actionFailure",ei="initial-load",oi="ui-update",th="vertical-scroll",ih="horizontal-scroll",vi="content-ready",wt="data-ready",af="init-groupingbar",nr="tree-view-update",vf="pivot-button-update",tr="init-calculatedfield",yf="init-pivotPager",rh="Sort value",uh="Sort field tree",pf="Edit calculated field",no="Sort field",to="Filter field",wf="Remove field",io="Open calculated field dialog",fh="Edit record",eh="Save edited records",oh="Add new record",sh="Remove record",bf="Aggregate field",ro="Window resize",uo="Calculated field applied",fo="Calculated field edited",hh="Field sorted",ch="Field filtered",lh="Field removed",ah="Field aggregated",eo="e-pivotfieldlist",ii="e-rtl",ir="e-device",e="e-icons",o="e-disable",sr="e-hide",hr="e-dropdown-icon",vh="e-pivotfieldlist-container",rt="e-toggle-field-list",oo="e-static",et="e-field-list",yh="e-field-list-tree-outer-div",ph="e-field-list-tree-outer-div-searchMode",wh="e-search-mode",bh="e-pivot-parent",kh="e-pivot-child",so="e-field-list-footer",dh="e-left-axis-fields",gh="e-right-axis-fields",yi="e-all-fields-axis",rr="e-axis-content",kf="e-draggable-prompt",ur="e-pvt-btn-div",v="e-pivot-button",df="e-pvt-btn-content",hu="e-sort",gf="e-member-sort",pr="e-descend",bt="e-btn-filter",ne="e-pv-filter",cu="e-pv-filtered",pi="e-remove",lu="e-drag",te="e-disable-drag",ot="e-drop-indicator",yt="e-drop-hover",ie="e-member-editor-outer-container",wr="e-member-editor-container",ho="e-drillthrough-body-header",co="e-drillthrough-body-header-common",lo="e-drillthrough-body-header-value",au="e-check",ao="e-stop",lt="e-ok-btn",br="e-cancel-btn",nc="e-pivot-error-dialog",si="e-droppable",kr="e-rows",dr="e-columns",cr="e-values",gr="e-filters",kt="e-grouping-bar",vo="e-group-all-fields",ri="e-group-rows",vu="e-group-columns",yu="e-group-values",re="e-group-filters",nu="e-drag-restrict",tu="e-list-selected",tc="e-title-header",lr="e-text-content",iu="e-field-list-btn",pu="e-calculated-field-btn",ue="e-small",fe="e-round",wu="e-add-icon",ee="e-flat",dt="e-list-text",ar="e-selected-node",ic="e-selected-option-icon",rc="e-selected-level-icon",uc="e-between-text-div",fc="e-filter-input-div-2",yo="e-value-options",ec="e-filter-operator",oc="e-filter-sort",sc="e-sort-ascend-icon",hc="e-sort-descend-icon",wi="e-active",bi="e-collapse",fr="e-expand",hi="e-table",bu="e-columnsheader",ci="e-rowsheader",po="e-cellvalue",wo="e-tooltipheader",bo="e-tooltipcontent",ku="e-nextspan",ko="e-lastspan",cc="e-editor-search-container",lc="e-editor-search",go="e-select-all",ac="e-pivot-calc-check",oe="e-pivot-calc-input",ns="e-custom-format-input",ts="e-olap-calc-hierarchy-list-div",is="e-pivot-calc-format-type-div",rs="e-olap-calc-member-type-div",us="e-member-options",se="e-flat",ki="e-format",ru="e-pivot-formula",vc="e-pivot-treeview",yc="e-pivot-treeview-outer",pc="e-treeContainer",wc="e-pivot-ok-button",bc="e-pivot-button-div",vr="e-axis",fs="e-axis-filter",yr="e-grid",kc="e-pivotview",dc="e-pivot-all-field-title",l="e-disabled",gt="e-menu-hide",du="e-member-prompt",k="e-edit",nt="e-edited",gc="e-info",es="e-empty-field",nl="e-format-condition-button",tl="e-format-table",os="e-input",il="e-format-color-picker",ui="e-virtualtrack",at="e-movablecontent",pt="e-movablescrollbar",gu="e-frozencontent",li="e-movableheader",tt="e-cellselectionbackground",d="e-selectionbackground",rl="e-field-list-back-icon",he="e-rowcell",g="e-active",ss="e-spanclicked",hs="e-rowselect",nf="e-gridheader",vt="e-remove-report",uu="e-pivot-toolbar",ft="e-pivotchart",cs="e-group-chart-rows",tf="e-group-chart-columns",rf="e-group-chart-values",ul="e-group-chart-values-drodown-div",fl="e-group-chart-columns-dropdown-div",uf="e-chart-grouping-bar",er="e-pivot-grouping-bar",ff="e-pivotchart-inner",ef="e-group-pivot-rows",el="e-pivot-pager",ol="e-node-limit";const s=ejdashboard.grids,st=ejdashboard.navigations,it=ejdashboard.inputs,y=ejdashboard.dropdowns;var sl=function(){function t(n){this.menuInfo=[];this.stringAggregateTypes=["Count","DistinctCount"];this.parent=n}return t.prototype.render=function(n,t){this.parentElement=t;this.openContextMenu(n)},t.prototype.openContextMenu=function(n){var t=this,u=n.target.parentElement.getAttribute("data-uid"),o=r.getFieldInfo(u,this.parent),i,f,e;if(this.buttonElement=n.target.parentElement,i="number"!==this.parent.engineModule.fieldList[u].type?1:0,this.summaryTypes=this.getMenuItem(i).slice(),this.parent.actionObj.actionName=bf,this.parent.actionObj.fieldInfo=o.fieldItem,!this.parent.actionBeginMethod()){f={cancel:!1,fieldName:u,aggregateTypes:this.summaryTypes,displayMenuCount:7};e="pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent;try{e.trigger(ge,f,function(r){if(!r.cancel){t.summaryTypes=r.aggregateTypes;t.createContextMenu(i,r.displayMenuCount);t.currentMenu=n.target;var u=t.currentMenu.getBoundingClientRect();t.parent.enableRtl?t.menuInfo[i].open(u.top+(window.scrollY||document.documentElement.scrollTop),u.left-105):t.menuInfo[i].open(u.top+(window.scrollY||document.documentElement.scrollTop),u.left)}})}catch(n){this.parent.actionFailureMethod(n)}}},t.prototype.createContextMenu=function(t,i){var s=this,u=[],e,o,r,h,f;for(u[t]=[],this.menuInfo[t]&&!this.menuInfo[t].isDestroyed&&this.menuInfo[t].destroy(),e=[],o=0;o<this.summaryTypes.length;o++)r=this.summaryTypes[o],t?this.stringAggregateTypes.indexOf(r)>-1&&e.indexOf(r)<0&&(u[t].push({text:this.parent.localeObj.getConstant(r),id:this.parent.element.id+"StringMenu_"+r}),e.push(r)):this.parent.getAllSummaryType().indexOf(r)>-1&&e.indexOf(r)<0&&(u[t].push({text:this.parent.localeObj.getConstant(r),id:this.parent.element.id+"_"+r}),e.push(r));u[t].length>i&&(u[t].splice(i),u[t].push({text:this.parent.localeObj.getConstant("MoreOption"),id:this.parent.element.id+"_MoreOption"}));h={items:u[t],enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:this.parent.cssClass,beforeOpen:this.beforeMenuOpen.bind(this,t),onClose:function(){n.select("#"+s.buttonElement.id,s.parentElement).focus()},select:this.selectOptionInContextMenu.bind(this)};f=document.getElementById(this.parent.element.id+(t?"valueFieldStringContextMenu":"valueFieldContextMenu"));null!==f?f.innerHTML="":f=n.createElement("ul",{id:this.parent.element.id+(t?"valueFieldStringContextMenu":"valueFieldContextMenu")});this.parent.element.appendChild(f);this.menuInfo[t]=new st.ContextMenu(h);this.menuInfo[t].isStringTemplate=!0;this.menuInfo[t].appendTo(f)},t.prototype.getMenuItem=function(n){for(var t,i=[],r=0;r<this.parent.aggregateTypes.length;r++)t=this.parent.aggregateTypes[r],n?this.stringAggregateTypes.indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t):this.parent.getAllSummaryType().indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t);return i},t.prototype.beforeMenuOpen=function(n,t){t.element.style.zIndex=(this.menuInfo[n].element.style.zIndex+3).toString();t.element.style.display="inline"},t.prototype.createValueSettingsDialog=function(t,i,r){var f=this,u;this.parentElement=i;u=n.createElement("div",{id:this.parentElement.id+"_ValueDialog",className:"e-value-field-settings",attrs:{"data-field":t.getAttribute("data-uid")?t.getAttribute("data-uid"):t.getAttribute("data-field")}});this.parentElement.appendChild(u);this.valueDialog=new b.Dialog({animationSettings:{effect:"Fade"},allowDragging:!0,header:this.parent.localeObj.getConstant("valueFieldSettings"),content:this.createFieldOptions(t,r),isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:this.updateValueSettings.bind(this),buttonModel:{cssClass:lt+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:function(){f.valueDialog.hide()},buttonModel:{cssClass:br+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"pivotfieldlist"!==this.parent.getModuleName()||"Popup"!==this.parent.renderMode,target:this.parentElement,overlayClick:function(){f.removeDialog()},close:this.removeDialog.bind(this),cssClass:this.parent.cssClass});this.valueDialog.isStringTemplate=!0;this.valueDialog.appendTo(u)},t.prototype.createFieldOptions=function(t,i){var ct=t.getAttribute("data-caption"),e=i&&"MoreOption"!==i?i:t.getAttribute("data-type"),u=t.getAttribute("data-basefield"),l=t.getAttribute("data-baseitem"),v,tt,rt,ut,ft,ot,st,p,r,ht;e="undefined"!==e.toString()?e:"Sum";for(var lt=[],s=this.parent.aggregateTypes,at=[],o=0;o<s.length;o++)this.parent.getAllSummaryType().indexOf(s[o])>-1&&at.indexOf(s[o])<0&&(lt.push({value:s[o],text:this.parent.localeObj.getConstant(s[o])}),at.push(s[o]));var vt=["DifferenceFrom","PercentageOfDifferenceFrom"],yt=["DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"],w=n.extend([],this.parent.dataSourceSettings.rows,null,!0);w=w.concat(this.parent.dataSourceSettings.columns);for(var h=[],f=[],b=0,pt=w;b<pt.length;b++){var a=pt[b],ti=a.name,ii=a.caption?a.caption:a.name;h.push({value:ti,text:ii})}0===Object.keys(h).length?(h.push({value:"",text:""}),u="",f=[]):(u=u&&"undefined"!==u.toString()&&"null"!==u.toString()?u:h[0].value,f=Object.keys(this.parent.engineModule.fieldList["undefined"!==u.toString()?u:h[0].value].formattedMembers));l="undefined"!==l.toString()?l:f[0];var wt=n.createElement("div",{className:"e-value-field-div-content",id:this.parentElement.id+"_field_div_content",attrs:{"data-type":e,"data-caption":ct,"data-basefield":u,"data-baseitem":l}}),k=n.createElement("div",{className:"e-field-name-text-container"}),c=n.createElement("div",{className:"e-field-option-container"}),d=n.createElement("div",{className:"e-type-option-container"}),g=n.createElement("div",{className:"e-base-field-option-container"}),nt=n.createElement("div",{className:"e-base-item-option-container"}),bt=n.createElement("div",{className:"e-field-name-title"});bt.innerText=this.parent.localeObj.getConstant("sourceName")+" ";v=n.createElement("div",{className:"e-field-name-content"});v.innerText=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(t.getAttribute("data-uid")?t.getAttribute("data-uid"):t.getAttribute("data-field")):t.getAttribute("data-uid")?t.getAttribute("data-uid"):t.getAttribute("data-field");this.buttonElement=this.buttonElement?this.buttonElement:document.querySelector("."+v.innerText);tt=n.createElement("div",{className:"e-type-option-text"});tt.innerText=this.parent.localeObj.getConstant("sourceCaption");rt=n.createElement("div",{className:"e-base-field-option-text"});rt.innerText=this.parent.localeObj.getConstant("summarizeValuesBy");ut=n.createElement("div",{className:"e-base-item-option-text"});ut.innerText=this.parent.localeObj.getConstant("baseField");ft=n.createElement("div",{className:"e-type-option-text"});ft.innerText=this.parent.localeObj.getConstant("baseItem");var et=n.createElement("div",{className:"e-caption-input-container"}),kt=n.createElement("div",{id:this.parentElement.id+"_type_option"}),dt=n.createElement("div",{id:this.parentElement.id+"_base_field_option"}),gt=n.createElement("div",{id:this.parentElement.id+"_base_item_option"}),ni=n.createElement("input",{id:this.parentElement.id+"type_input_option",className:"e-caption-input-text",attrs:{type:"text"}});return k.appendChild(bt),k.appendChild(v),et.appendChild(tt),et.appendChild(ni),d.appendChild(rt),g.appendChild(ut),nt.appendChild(ft),d.appendChild(kt),g.appendChild(dt),nt.appendChild(gt),c.appendChild(k),c.appendChild(et),c.appendChild(d),c.appendChild(g),c.appendChild(nt),wt.appendChild(c),ot=this,st=new y.DropDownList({dataSource:lt,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:e,cssClass:yo+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(n){p.enabled=-1!==yt.indexOf(n.value);r.enabled=-1!==vt.indexOf(n.value);r.enabled&&1===r.dataSource.length&&(r.dataSource=f,r.dataBind())}}),st.isStringTemplate=!0,st.appendTo(kt),p=new y.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:u,enabled:-1!==yt.indexOf(e),cssClass:yo+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(n){f=Object.keys(ot.parent.engineModule.fieldList[n.value].formattedMembers);r.dataSource=f;r.value=f[0];r.filterBarPlaceholder=ot.parent.localeObj.getConstant("example")+" "+f[0];r.itemData=null;r.dataBind()}}),p.isStringTemplate=!0,p.appendTo(dt),r=new y.DropDownList({dataSource:f,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:l,allowFiltering:!0,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+f[0],enabled:-1!==vt.indexOf(e),cssClass:ec+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%"}),r.isStringTemplate=!0,r.appendTo(gt),ht=new it.MaskedTextBox({placeholder:"Enter field caption",enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:ct,width:"100%",cssClass:this.parent.cssClass}),ht.isStringTemplate=!0,ht.appendTo(ni),wt},t.prototype.selectOptionInContextMenu=function(t){var f,c,i,u,s;if(null!==t.item.text){if(f=this.currentMenu.parentElement,c=r.getFieldInfo(f?f.getAttribute("data-uid"):"",this.parent),this.parent.actionObj.actionName=bf,this.parent.actionObj.fieldInfo=c.fieldItem,this.parent.actionBeginMethod())return;i=t.item.id.split("_").pop();try{if("MoreOption"===i||"PercentageOfDifferenceFrom"===i||"PercentageOfParentTotal"===i||"DifferenceFrom"===i)this.createValueSettingsDialog(f,this.parentElement,i);else{var h=f.getAttribute("data-uid"),o=this.parent.dataSourceSettings.values,l=f.querySelector("."+df),e=t.item.text+" "+this.parent.localeObj.getConstant("of")+" "+this.parent.engineModule.fieldList[h].caption;for(e=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(e):e,l.innerText=e,l.setAttribute("title",e),f.setAttribute("data-type",i),u=0;u<this.parent.dataSourceSettings.values.length;u++)this.parent.dataSourceSettings.values[u].name===h&&(s=n.extend({},o[u].properties?o[u].properties:o[u],null,!0),s.type=i,this.parent.engineModule.fieldList[h].aggregateType=i,o.splice(u,1,s),this.parent.lastAggregationInfo=s);this.updateDataSource()}}catch(t){this.parent.actionFailureMethod(t)}}},t.prototype.updateDataSource=function(n){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&"Popup"===this.parent.renderMode?(this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(oi,this),this.parent.pivotGridModule.engineModule=this.parent.engineModule):this.parent.triggerPopulateEvent():this.parent.updateDataSource(n)},t.prototype.updateValueSettings=function(){var i,l=this.valueDialog.element,f=n.getInstance(n.select("#"+this.parentElement.id+"type_input_option"),it.MaskedTextBox),e=n.getInstance(n.select("#"+this.parentElement.id+"_type_option"),y.DropDownList),s=n.getInstance(n.select("#"+this.parentElement.id+"_base_field_option"),y.DropDownList),h=n.getInstance(n.select("#"+this.parentElement.id+"_base_item_option"),y.DropDownList),c=l.getAttribute("data-field"),o,u,t;(this.parentElement.querySelector("."+v)&&(i=this.parentElement.querySelector("."+v+"."+c.replace(/[^A-Z0-9]/gi,""))),i)&&(o=i.querySelector("."+df),u=this.parent.localeObj.getConstant(e.value)+" "+this.parent.localeObj.getConstant("of")+" "+f.value,u=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(u):u,o.innerText=u,o.setAttribute("title",u),i.setAttribute("data-type",e.value),i.setAttribute("data-caption",f.value),i.setAttribute("data-basefield",s.value),i.setAttribute("data-baseitem",h.value));t=r.getFieldByName(c,this.parent.dataSourceSettings.values);(t=t.properties?t.properties:t).caption=f.value;t.type=e.value;t.baseField=s.value;t.baseItem=h.value;this.valueDialog.close();this.parent.lastAggregationInfo=t;this.updateDataSource(!0)},t.prototype.removeDialog=function(){this.buttonElement&&n.select("#"+this.buttonElement.id,this.parentElement)&&n.select("#"+this.buttonElement.id,this.parentElement).focus();this.valueDialog&&!this.valueDialog.isDestroyed&&this.valueDialog.destroy();document.getElementById(this.parentElement.id+"_ValueDialog")&&n.remove(document.getElementById(this.parentElement.id+"_ValueDialog"))},t.prototype.destroy=function(){this.parent.isDestroyed||this.menuInfo&&(void 0===this.menuInfo[1]||this.menuInfo[1].isDestroyed||this.menuInfo[1].destroy(),void 0===this.menuInfo[0]||this.menuInfo[0].isDestroyed||this.menuInfo[0].destroy())},t}(),hl=function(){function t(n){this.isAutoFitEnabled=!1;this.pivotColumns=[];this.indentCollection={};this.colPos=0;this.lastSpan=0;this.lvlCollection={};this.hierarchyCollection={};this.lvlPosCollection={};this.hierarchyPosCollection={};this.position=0;this.measurePos=0;this.maxMeasurePos=0;this.hierarchyCount=0;this.actualText="";this.parent=n;this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule;this.gridSettings=this.parent.gridSettings;this.formatList=this.getFormatList();this.aggMenu=new sl(this.parent)}return t.prototype.render=function(t){if(t&&this.initProperties(),this.resColWidth=this.parent.showGroupingBar&&this.parent.groupingBarModule?this.parent.isAdaptive?180:250:this.parent.isAdaptive?140:200,this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.gridSettings=this.parent.gridSettings,this.formatList=this.getFormatList(),this.parent.gridHeaderCellInfo=[],this.parent.gridCellCollection={},this.injectGridModules(this.parent),this.rowStartPos=this.getRowStartPos(),this.parent.grid&&this.parent.grid.element&&this.parent.element.querySelector(".e-grid")){if(this.parent.notEmpty=!0,this.engine.isEngineUpdated?(this.parent.enableValueSorting&&(this.engine.valueContent=this.frameDataSource("value")),this.engine.isEngineUpdated=!1):(this.engine.headerContent=this.frameDataSource("header"),this.engine.valueContent=this.frameDataSource("value")),this.parent.grid.setProperties({columns:this.frameStackedHeaders(),dataSource:("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0&&this.parent.dataSourceSettings.values.length>0)&&!this.engine.isEmptyData?this.engine.valueContent:this.frameDataSource("value")},!0),"auto"===this.parent.grid.height){var i=this.parent.element.querySelector("."+at).offsetHeight,r=this.parent.grid.dataSource.length*this.parent.gridSettings.rowHeight;i>50&&i<r&&this.parent.grid.contentModule.setHeightToContent(r)}this.parent.grid.notify("datasource-modified",{});this.parent.isScrolling&&(this.parent.resizeInfo={});this.parent.grid.refreshColumns();this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+kt)&&this.parent.groupingBarModule.setGridRowWidth();this.parent.element.querySelector(".e-movablecontent").querySelector("colGroup").innerHTML=this.parent.grid.getHeaderContent().querySelector(".e-movableheader").querySelector("colgroup").innerHTML;this.parent.grid.width=this.calculateGridWidth();!this.gridSettings.allowAutoResizing&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+kt)&&this.parent.groupingBarModule.refreshUI();this.parent.isScrolling||this.calculateGridHeight(!0)}else this.parent.element.innerHTML="",this.bindGrid(this.parent,!!this.engine.isEmptyData),this.parent.element.appendChild(n.createElement("div",{id:this.parent.element.id+"_grid"})),this.parent.grid.isStringTemplate=!0,this.parent.grid.appendTo("#"+this.parent.element.id+"_grid");this.parent.grid.on(s.headerRefreshed,this.refreshHeader,this)},t.prototype.initProperties=function(){this.rowStartPos=void 0;this.maxIndent=void 0;this.resColWidth=void 0;this.isOverflows=void 0;this.indentCollection={};this.formatList=void 0;this.colPos=0;this.colGrandPos=void 0;this.rowGrandPos=void 0;this.lastSpan=0;this.field=void 0;this.fieldCaption=void 0;this.lvlCollection={};this.hierarchyCollection={};this.lvlPosCollection={};this.hierarchyPosCollection={};this.position=0;this.measurePos=0;this.maxMeasurePos=0;this.hierarchyCount=0;this.actualText="";this.timeOutObj=void 0},t.prototype.refreshHeader=function(){var u;if(this.parent.enableVirtualization){var t=this.parent.element.querySelector("."+li),i=this.parent.element.querySelector("."+at),r=i.querySelector("."+ui);this.parent.virtualHeaderDiv=t.querySelector("."+ui);t.querySelector("."+ui)?n.remove(t.querySelector("."+ui)):this.parent.virtualHeaderDiv=n.createElement("div",{className:ui});t.appendChild(this.parent.virtualHeaderDiv);r&&n.setStyleAttribute(this.parent.virtualHeaderDiv,{height:0,width:r.style.width});t.querySelector(".e-table")&&n.setStyleAttribute(t.querySelector(".e-table"),{transform:i.querySelector(".e-table").style.transform.split(",")[0]+",0px)"});u=this.parent.isAdaptive?i:i.parentElement.parentElement.querySelector("."+pt);t.scrollLeft=u.scrollLeft}},t.prototype.bindGrid=function(n,t){this.injectGridModules(n);this.parent.grid=new s.Grid({cssClass:this.parent.cssClass,frozenColumns:1,frozenRows:0,enableHover:!1,dataSource:t?this.frameEmptyData():this.frameDataSource("value"),columns:t?this.frameEmptyColumns():this.frameStackedHeaders(),height:t?"auto":this.calculateGridHeight(),width:t?this.gridSettings.allowAutoResizing?this.parent.width:400:this.calculateGridWidth(),locale:n.locale,enableRtl:n.enableRtl,allowExcelExport:n.allowExcelExport,allowPdfExport:n.allowPdfExport,allowResizing:this.gridSettings.allowResizing,allowTextWrap:this.gridSettings.allowTextWrap,clipMode:this.gridSettings.clipMode,allowReordering:!this.parent.showGroupingBar&&this.gridSettings.allowReordering,allowSelection:this.gridSettings.allowSelection,contextMenuItems:this.gridSettings.contextMenuItems,selectedRowIndex:this.gridSettings.selectedRowIndex,selectionSettings:this.gridSettings.selectionSettings,textWrapSettings:this.gridSettings.textWrapSettings,printMode:this.gridSettings.printMode,rowHeight:this.gridSettings.rowHeight,gridLines:this.gridSettings.gridLines,contextMenuClick:this.contextMenuClick.bind(this),contextMenuOpen:this.contextMenuOpen.bind(this),beforeCopy:this.gridSettings.beforeCopy?this.gridSettings.beforeCopy.bind(this.parent):void 0,beforePrint:this.gridSettings.beforePrint?this.gridSettings.beforePrint.bind(this.parent):void 0,printComplete:this.gridSettings.printComplete?this.gridSettings.printComplete.bind(this.parent):void 0,rowSelecting:this.gridSettings.rowSelecting?this.gridSettings.rowSelecting.bind(this.parent):void 0,rowSelected:this.rowSelected.bind(this),rowDeselecting:this.gridSettings.rowDeselecting?this.gridSettings.rowDeselecting.bind(this.parent):void 0,rowDeselected:this.rowDeselected.bind(this),cellSelecting:this.gridSettings.cellSelecting?this.gridSettings.cellSelecting.bind(this.parent):void 0,cellSelected:this.cellSelected.bind(this),cellDeselecting:this.gridSettings.cellDeselecting?this.gridSettings.cellDeselecting.bind(this.parent):void 0,cellDeselected:this.cellDeselected.bind(this),resizeStart:this.gridSettings.resizeStart?this.gridSettings.resizeStart.bind(this.parent):void 0,columnDragStart:this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0,columnDrag:this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0,columnDrop:this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0,beforeExcelExport:this.beforeExcelExport.bind(this),resizing:this.setGroupWidth.bind(this),resizeStop:this.onResizeStop.bind(this),queryCellInfo:this.queryCellInfo.bind(this),dataBound:this.dataBound.bind(this),headerCellInfo:this.headerCellInfo.bind(this),excelHeaderQueryCellInfo:this.excelHeaderQueryCellInfo.bind(this),pdfHeaderQueryCellInfo:this.pdfHeaderQueryCellInfo.bind(this),excelQueryCellInfo:this.excelQueryCellInfo.bind(this),pdfQueryCellInfo:this.pdfQueryCellInfo.bind(this),beforePdfExport:this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0,pdfExportComplete:this.pdfExportComplete.bind(this),excelExportComplete:this.excelExportComplete.bind(this)});this.parent.grid.on("header-refreshed",this.headerRefreshed.bind(this));this.parent.grid.on("export-DataBound",this.excelDataBound.bind(this))},t.prototype.headerRefreshed=function(){var t=this.parent.element.querySelector("."+li);this.parent.lastGridSettings&&Object.keys(this.parent.lastGridSettings).indexOf("allowResizing")>-1&&!n.isNullOrUndefined(t)&&t.querySelector(".e-table")&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+kt)&&(this.parent.lastGridSettings=void 0,this.parent.groupingBarModule.setGridRowWidth())},t.prototype.beforeExcelExport=function(t){n.isNullOrUndefined(t.gridObject.columns)||n.isNullOrUndefined(this.parent.pivotColumns)||(t.gridObject.columns[t.gridObject.columns.length-1].width=this.parent.pivotColumns[this.parent.pivotColumns.length-1].width);this.parent.trigger("beforeExcelExport",t)},t.prototype.rowSelected=function(n){this.parent.renderModule.selected();this.parent.trigger("rowSelected",n)},t.prototype.rowDeselected=function(n){this.parent.renderModule.selected();this.parent.trigger("rowDeselected",n)},t.prototype.cellSelected=function(n){this.parent.rowRangeSelection.enable?(this.parent.grid.selectionModule.selectRowsByRange(this.parent.rowRangeSelection.startIndex,this.parent.rowRangeSelection.endIndex),this.parent.rowRangeSelection.enable=!1):(this.parent.renderModule.selected(),this.parent.trigger("selected",n))},t.prototype.cellSelecting=function(n){this.parent.trigger(cf,n)},t.prototype.cellDeselected=function(n){this.parent.renderModule.selected();this.parent.trigger("cellDeselected",n)},t.prototype.queryCellInfo=function(n){this.parent.renderModule.rowCellBoundEvent(n)},t.prototype.headerCellInfo=function(n){this.parent.renderModule.columnCellBoundEvent(n)},t.prototype.excelHeaderQueryCellInfo=function(n){this.parent.renderModule.excelColumnEvent(n)},t.prototype.pdfQueryCellInfo=function(n){this.parent.renderModule.pdfRowEvent(n)},t.prototype.excelQueryCellInfo=function(n){this.parent.renderModule.excelRowEvent(n)},t.prototype.pdfHeaderQueryCellInfo=function(n){this.parent.renderModule.pdfColumnEvent(n)},t.prototype.pdfExportComplete=function(n){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"PDF",promise:n.promise};this.parent.trigger(ke,t)},t.prototype.excelExportComplete=function(n){void 0!==this.parent.lastColumn&&"auto"!==this.parent.lastColumn.width&&(this.parent.lastColumn.width="auto",this.parent.lastColumn=void 0);var t={type:"Excel/CSV",promise:n.promise};this.parent.trigger(ke,t)},t.prototype.dataBound=function(){var r,u,i,t;if(this.parent.cellTemplate){for(r=0,u=this.parent.gridHeaderCellInfo;r<u.length;r++)i=u[r],this.parent.cellTemplate&&(t=this.parent.getCellTemplate()(i,this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,i.targetCell),t&&""!==t&&t.length>0&&(this.parent.enableHtmlSanitizer?this.parent.isVue||this.parent.isVue3?n.append(n.SanitizeHtmlHelper.sanitize(t),i.targetCell):this.parent.appendHtml(i.targetCell,n.SanitizeHtmlHelper.sanitize(t[0].outerHTML)):this.parent.isVue||this.parent.isVue3?n.append(t,i.targetCell):this.parent.appendHtml(i.targetCell,t[0].outerHTML)));this.parent.gridHeaderCellInfo=[]}!this.isAutoFitEnabled&&this.parent.grid&&this.parent.grid.widthService&&this.parent.grid.widthService.setWidthToTable();this.parent.notEmpty&&this.calculateGridHeight(!0);this.parent.isScrolling=!1;this.setFocusOnLastCell();n.isNullOrUndefined(this.parent.renderReactTemplates)||this.parent.renderReactTemplates();this.parent.isInitial&&(this.parent.isInitial=!1,this.parent.refreshData());this.parent.notify(vi,{})},t.prototype.setFocusOnLastCell=function(){if(this.parent.keyboardModule&&this.parent.keyboardModule.event&&"TD"===this.parent.keyboardModule.event.target.nodeName){var t=this.parent.grid.serviceLocator.getService("focus");t.setFocusedElement(this.parent.keyboardModule.event.target);t.focus(this.parent.keyboardModule.event);n.addClass([this.parent.keyboardModule.event.target],["e-focused","e-focus"]);this.parent.keyboardModule.event.target.setAttribute("tabindex","0");this.parent.keyboardModule.event=void 0}},t.prototype.getCellElement=function(t){var i=n.closest(t,"td");return n.isNullOrUndefined(i)&&(i=n.closest(t,"th")),i},t.prototype.contextMenuOpen=function(t){var u=this,e;t.element&&this.parent.cssClass&&n.addClass([t.element.parentElement],this.parent.cssClass);for(var s=function(f){var nt=i.parent.lastCellClicked?i.parent.lastCellClicked:i.parent.isAdaptive?t.event.target:i.parent.lastCellClicked,e=i.getCellElement(nt),a=void 0,c=void 0,h,y,d,w,g;if(!e||e&&0===Number(e.getAttribute("index"))&&0===Number(e.getAttribute("data-colindex")))return t.cancel=!0,{value:void 0};(e.classList.contains("e-valuesheader")||e.classList.contains("e-stot"))&&(a=!0);i.parent.allowGrouping&&i.parent.groupingModule&&!i.validateField(e)&&(c=!0);var tt=Number(e.getAttribute("index")),it=Number(e.getAttribute("data-colindex")),b=i.parent.pivotValues[tt][it];switch(f.id){case i.parent.element.id+"_expand":e.querySelectorAll("."+fr).length>0?(n.selectAll("#"+i.parent.element.id+"_expand",t.element)&&n.select("#"+i.parent.element.id+"_expand",t.element).classList.add(l),n.select("#"+i.parent.element.id+"_expand",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_expand",t.element).classList.remove(l),n.select("#"+i.parent.element.id+"_expand",t.element).classList.contains(gt)&&(n.select("#"+i.parent.element.id+"_expand",t.element).classList.remove(gt),n.select("#"+i.parent.element.id+"_collapse",t.element).classList.remove(gt))):a?n.select("#"+i.parent.element.id+"_expand",t.element).classList.add(gt):n.select("#"+i.parent.element.id+"_expand",t.element).classList.add(l);break;case i.parent.element.id+"_collapse":e.querySelectorAll("."+bi).length>0?(n.select("#"+i.parent.element.id+"_expand",t.element)&&n.select("#"+i.parent.element.id+"_expand",t.element).classList.add(l),n.select("#"+i.parent.element.id+"_collapse",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_collapse",t.element).classList.remove(l),n.select("#"+i.parent.element.id+"_collapse",t.element).classList.contains(gt)&&(n.select("#"+i.parent.element.id+"_collapse",t.element).classList.remove(gt),n.select("#"+i.parent.element.id+"_expand",t.element).classList.remove(gt))):a?n.select("#"+i.parent.element.id+"_collapse",t.element).classList.add(gt):n.select("#"+i.parent.element.id+"_collapse",t.element).classList.add(l);break;case i.parent.element.id+"_custom_group":c||2!==t.items.length||(t.cancel=!0);n.selectAll("#"+i.parent.element.id+"_custom_group",t.element)&&n.addClass([n.select("#"+i.parent.element.id+"_custom_group",t.element)],gt);c&&n.selectAll("#"+i.parent.element.id+"_custom_group",t.element)&&n.removeClass([n.select("#"+i.parent.element.id+"_custom_group",t.element)],gt);break;case i.parent.element.id+"_custom_ungroup":if(n.selectAll("#"+i.parent.element.id+"_custom_ungroup",t.element)&&n.addClass([n.select("#"+i.parent.element.id+"_custom_ungroup",t.element)],gt),c){var v=!1,o=e.getAttribute("fieldname"),s=r.getFieldByName(o,i.parent.dataSourceSettings.groupSettings);if(s&&"Custom"===s.type||i.parent.engineModule.fieldList[o].isCustomField&&o.indexOf("_custom_group")>-1){if(s=r.getFieldByName(o.replace("_custom_group",""),i.parent.dataSourceSettings.groupSettings)){h=i.parent.engineModule.pivotValues[Number(e.getAttribute("index"))][Number(e.getAttribute("data-colindex"))];y=i.parent.groupingModule.getSelectedCells(h.axis,o,h.actualText.toString());y.push({axis:h.axis,fieldName:o,name:h.actualText.toString(),cellInfo:h});for(var rt=i.parent.groupingModule.getSelectedOptions(y),p=0,k=s.customGroups;p<k.length;p++)if(d=k[p],rt.indexOf(d.groupName)>-1){v=!0;break}}}else(s&&("Date"===s.type||"Number"===s.type)||i.parent.engineModule.fieldList[o].isCustomField&&o.indexOf("_date_group")>-1)&&(v=!0);n.selectAll("#"+i.parent.element.id+"_custom_ungroup",t.element)&&v&&n.removeClass([n.select("#"+i.parent.element.id+"_custom_ungroup",t.element)],gt)}break;case i.parent.element.id+"_drillthrough":i.parent.allowDrillThrough?e.classList.contains("e-summary")?n.select("#"+i.parent.element.id+"_drillthrough",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_drillthrough",t.element).classList.remove(l):""===e.innerText&&n.select("#"+i.parent.element.id+"_drillthrough",t.element)&&n.select("#"+i.parent.element.id+"_drillthrough",t.element).classList.add(l):n.select("#"+i.parent.element.id+"_drillthrough",t.element)&&n.select("#"+i.parent.element.id+"_drillthrough",t.element).classList.add(l);break;case i.parent.element.id+"_sortasc":i.parent.enableValueSorting?e.querySelectorAll(".e-icon-descending").length>0?(n.select("#"+i.parent.element.id+"_sortdesc",t.element)?n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.add(l):n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.remove(l),n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.remove(l)):n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.remove(l):n.select("#"+i.parent.element.id+"_sortasc",t.element)&&n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.add(l);break;case i.parent.element.id+"_sortdesc":i.parent.enableValueSorting?e.querySelectorAll(".e-icon-ascending").length>0?(n.select("#"+i.parent.element.id+"_sortasc",t.element)?n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.add(l):n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.remove(l),n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.remove(l)):n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_sortasc",t.element).classList.remove(l):n.select("#"+i.parent.element.id+"_sortdesc",t.element)&&n.select("#"+i.parent.element.id+"_sortdesc",t.element).classList.add(l);break;case i.parent.element.id+"_CalculatedField":i.parent.allowCalculatedField||n.select("#"+i.parent.element.id+"_CalculatedField",t.element).classList.add(l);break;case i.parent.element.id+"_pdf":i.parent.allowPdfExport||n.select("#"+i.parent.element.id+"_pdf",t.element).classList.add(l);break;case i.parent.element.id+"_excel":i.parent.allowExcelExport||n.select("#"+i.parent.element.id+"_excel",t.element).classList.add(l);break;case i.parent.element.id+"_csv":i.parent.allowExcelExport||n.select("#"+i.parent.element.id+"_csv",t.element).classList.add(l);break;case i.parent.element.id+"_exporting":i.parent.allowExcelExport||i.parent.allowPdfExport||n.select("#"+i.parent.element.id+"_exporting",t.element).classList.add(l);break;case i.parent.element.id+"_aggregate":(n.select("#"+i.parent.element.id+"_aggregate",t.element)&&!n.select("#"+i.parent.element.id+"_aggregate",t.element).classList.contains(l)&&n.select("#"+i.parent.element.id+"_aggregate",t.element).classList.add(l),(e.classList.contains("e-valuesheader")||e.classList.contains("e-valuescontent")||e.classList.contains("e-stot")&&e.classList.contains("e-rowsheader"))&&"olap"!==i.parent.dataType)&&(""!==e.innerText&&(w=i.parent.engineModule.fieldList[b.actualText.toString()].type),g={cancel:!1,fieldName:b.actualText.toString(),aggregateTypes:i.getMenuItem(w).slice(),displayMenuCount:7},i.parent.trigger(ge,g,function(i){var r;if(!i.cancel&&""!==e.innerText){for(var o=[],s=[],h=0;h<i.aggregateTypes.length;h++)r=i.aggregateTypes[h],"number"!==w?["Count","DistinctCount"].indexOf(r)>-1&&s.indexOf(r)<0&&(o.push({text:u.parent.localeObj.getConstant(r),id:u.parent.element.id+"_Agg"+r}),s.push(r)):u.parent.getAllSummaryType().indexOf(r)>-1&&s.indexOf(r)<0&&(o.push({text:u.parent.localeObj.getConstant(r),id:u.parent.element.id+"_Agg"+r}),s.push(r));o.length>i.displayMenuCount&&(o.splice(i.displayMenuCount),o.push({text:u.parent.localeObj.getConstant("MoreOption"),id:u.parent.element.id+"_AggMoreOption"}));o&&o.length>=1&&(f.items=o,n.select("#"+u.parent.element.id+"_aggregate",t.element).classList.remove(l))}}))}},i=this,f=0,o=t.items;f<o.length;f++)if(e=s(o[f]),"object"==typeof e)return e.value;this.parent.trigger("contextMenuOpen",t)},t.prototype.getMenuItem=function(n){for(var t,i=[],r=0;r<this.parent.aggregateTypes.length;r++)t=this.parent.aggregateTypes[r],"string"!==n?this.parent.getAllSummaryType().indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t):["Count","DistinctCount"].indexOf(t)>-1&&-1===i.indexOf(t)&&i.push(t);return i},t.prototype.contextMenuClick=function(n){var u,f=this,c=this.parent.lastCellClicked,e=n.item.id,l=new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0}),r={},t=this.getCellElement(c),a=Number(t.getAttribute("index")),v=Number(t.getAttribute("data-colindex")),i=this.parent.pivotValues[a][v],o,s,h;switch(n.item.id.indexOf(this.parent.element.id+"_Agg")>-1&&(this.field=this.parent.engineModule.fieldList[i.actualText.toString()].id,this.fieldCaption=this.parent.engineModule.fieldList[i.actualText.toString()].caption,u=n.item.id.split("_Agg")[1]),e){case this.parent.element.id+"_pdf":r={pdfDoc:void 0,isBlob:!1,isMultipleExport:!1,pdfExportProperties:{fileName:"Export.pdf"}};this.parent.trigger(ou,r,function(n){f.parent.pdfExport(n.pdfExportProperties,n.isMultipleExport,n.pdfDoc,n.isBlob)});break;case this.parent.element.id+"_excel":r={isBlob:!1,isMultipleExport:!1,workbook:void 0,excelExportProperties:{fileName:"Export.xlsx"}};this.parent.trigger(ou,r,function(n){f.parent.excelExport(n.excelExportProperties,n.isMultipleExport,n.workbook,n.isBlob)});break;case this.parent.element.id+"_csv":r={isBlob:!1,workbook:void 0,isMultipleExport:!1,excelExportProperties:{fileName:"Export.csv"}};this.parent.trigger(ou,r,function(n){f.parent.csvExport(n.excelExportProperties,n.isMultipleExport,n.workbook,n.isBlob)});break;case this.parent.element.id+"_drillthrough_menu":t.dispatchEvent(l);break;case this.parent.element.id+"_sortasc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{columnHeader:i.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}});this.parent.dataSourceSettings.valueSortSettings.sortOrder="Ascending";break;case this.parent.element.id+"_sortdesc":this.parent.setProperties({dataSourceSettings:{valueSortSettings:{columnHeader:i.valueSort.levelName,headerDelimiter:this.parent.dataSourceSettings.valueSortSettings.headerDelimiter}}});this.parent.dataSourceSettings.valueSortSettings.sortOrder="Descending";break;case this.parent.element.id+"_expand":if(t.querySelectorAll("."+fr)){o=t.querySelectorAll("."+fr)[0];this.parent.onDrill(o)}break;case this.parent.element.id+"_collapse":if(t.querySelectorAll("."+bi)){s=t.querySelectorAll("."+bi)[0];this.parent.onDrill(s)}break;case this.parent.element.id+"_CalculatedField":this.parent.calculatedFieldModule.createCalculatedFieldDialog();break;case this.parent.element.id+"_AggMoreOption":case this.parent.element.id+"_AggDifferenceFrom":case this.parent.element.id+"_AggPercentageOfDifferenceFrom":case this.parent.element.id+"_AggPercentageOfParentTotal":t.setAttribute("id",this.field);t.setAttribute("data-caption",this.fieldCaption);t.setAttribute("data-field",this.field);t.setAttribute("data-type",this.engine.fieldList[i.actualText.toString()].aggregateType);t.setAttribute("data-basefield",this.engine.fieldList[i.actualText.toString()].baseField);t.setAttribute("data-baseItem",this.engine.fieldList[i.actualText.toString()].baseItem);this.aggMenu.createValueSettingsDialog(t,this.parent.element,u);break;case this.parent.element.id+"_Agg"+u:this.updateAggregate(u);break;case this.parent.element.id+"_custom_group":case this.parent.element.id+"_custom_ungroup":this.parent.groupingModule&&(h={target:t,option:e,parentElement:this.parent.element},this.parent.notify("init-grouping",h),this.parent.grid.contextMenuModule.contextMenu.close())}this.parent.trigger("contextMenuClick",n)},t.prototype.validateColumnTotalcell=function(n){for(var t,f=Object.keys(this.engine.headerContent),i=!1,r="",u=f.length-1;u>=0;u--){if(t=this.engine.headerContent[f[u]][n],!t)return!1;if(i=!(!i||""===r)&&r===t.valueSort.axis,r=t.valueSort.axis?t.valueSort.axis.toString():"","sum"===t.type&&(i=!0),i&&t.members&&t.members.length>0)return!0}return!1},t.prototype.validateField=function(n){var r=!1,t,u,f,e,i;if(n.classList.contains("e-stot")||n.classList.contains("e-gtot")||n.classList.contains("e-valuescontent")||n.classList.contains("e-valuesheader"))r=!0;else for(t=n.getAttribute("fieldName"),t&&""!==t||(u=Number(n.getAttribute("index")),f=Number(n.getAttribute("data-colindex")),t=this.engine.pivotValues[u][f].actualText),e=this.parent.dataSourceSettings.values,i=0;i<e.length;i++)if(this.parent.dataSourceSettings.values[i].name===t){r=!0;break}return r},t.prototype.updateAggregate=function(n){if(this.parent.getAllSummaryType().indexOf(n)>-1)for(var i=this.parent.dataSourceSettings.values,t=0;t<this.parent.dataSourceSettings.values.length;t++)this.parent.dataSourceSettings.values[t].name===this.field&&(i[t].type=n)},t.prototype.injectGridModules=function(n){s.Grid.Inject(s.Freeze);n.allowExcelExport&&s.Grid.Inject(s.ExcelExport);n.allowPdfExport&&s.Grid.Inject(s.PdfExport);s.Grid.Inject(s.Selection,s.Reorder,s.Resize);this.gridSettings.contextMenuItems&&s.Grid.Inject(s.ContextMenu)},t.prototype.updateGridSettings=function(){if(this.injectGridModules(this.parent),this.parent.grid.allowResizing=this.gridSettings.allowResizing,this.parent.grid.clipMode=this.gridSettings.clipMode,this.parent.grid.allowTextWrap=this.gridSettings.allowTextWrap,this.parent.grid.allowReordering=!this.parent.showGroupingBar&&this.gridSettings.allowReordering,this.parent.grid.allowSelection=this.gridSettings.allowSelection,this.parent.grid.contextMenuItems=this.gridSettings.contextMenuItems,this.parent.grid.selectedRowIndex=this.gridSettings.selectedRowIndex,this.parent.grid.selectionSettings=this.gridSettings.selectionSettings,this.parent.grid.textWrapSettings=this.gridSettings.textWrapSettings,this.parent.grid.printMode=this.gridSettings.printMode,this.parent.grid.rowHeight=this.gridSettings.rowHeight,this.parent.grid.gridLines=this.gridSettings.gridLines,this.parent.lastGridSettings){var n=Object.keys(this.parent.lastGridSettings);n.indexOf("height")>-1&&(this.parent.grid.height=this.gridSettings.height);n.indexOf("width")>-1&&(this.parent.grid.width=this.gridSettings.width);this.updatePivotColumns();(n.indexOf("allowTextWrap")>-1||n.indexOf("clipMode")>-1)&&this.parent.layoutRefresh()}this.clearColumnSelection()},t.prototype.updatePivotColumns=function(){for(var f,i,r,u=Object.keys(this.parent.lastGridSettings),t=0;t<this.parent.pivotColumns.length;t++)for(f=this.parent.pivotColumns[t],i=0;i<u.length;i++)r=u[i],n.isNullOrUndefined(this.parent.pivotColumns[t][r])||(f[r]=this.parent.lastGridSettings[r]);this.parent.fillGridColumns(this.parent.grid.columns)},t.prototype.clearColumnSelection=function(){n.removeClass(this.parent.element.querySelectorAll("."+g),[g,d])},t.prototype.appendValueSortIcon=function(t,i,r,u,f){var o="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,e=this.parent.dataSourceSettings.valueSortSettings,s=e&&"pivot"==this.parent.dataType?e.columnHeader:e.headerText,h,c;return this.parent.enableValueSorting&&e&&""!==s&&(h="grand sum"!==t.type||1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?this.parent.dataSourceSettings.values.length>1||this.parent.dataSourceSettings.alwaysShowValueHeader?o.headerContent.length-1:0===this.parent.dataSourceSettings.columns.length?0:o.headerContent.length-1:0,c=e&&s?t.valueSort.levelName===s:u===e.columnIndex,void 0!==e&&c&&(r===h||r+1===h&&t.level>-1&&o.headerContent[r+1][u]&&-1===o.headerContent[r+1][u].level)&&i.querySelector("div div").appendChild(n.createElement("span",{className:("Descending"===e.columnOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(t.hasChild?" e-value-sort-align":""),styles:"Right"===f.headerTextAlign?"float : left":""}))),i},t.prototype.onResizeStop=function(t){var r="0.formattedText"===t.column.field?"0.formattedText":t.column.customAttributes.cell.valueSort.levelName,i;(this.parent.resizeInfo[r]=Number(t.column.width.toString().split("px")[0]),this.parent.enableVirtualization&&"0.formattedText"===t.column.field)&&(this.parent.dataSourceSettings.values.length>1&&!n.isNullOrUndefined(this.parent.grid.columns[this.parent.grid.columns.length-1].columns)?(i=this.parent.grid.columns[this.parent.grid.columns.length-1].columns,i[i.length-1].minWidth=this.parent.gridSettings.columnWidth):this.parent.grid.columns[this.parent.grid.columns.length-1].minWidth=this.parent.gridSettings.columnWidth,this.parent.layoutRefresh());this.setGroupWidth(t);this.calculateGridHeight(!0);this.parent.grid.hideScroll()},t.prototype.setGroupWidth=function(n){var t,i,r;(this.parent.enableVirtualization&&"0.formattedText"===n.column.field&&(this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+kt)&&Number(n.column.width.toString().split("px")[0])<250?n.cancel=!0:this.parent.element.querySelector(".e-frozenscrollbar").style.width=n.column.width.toString().split("px")[0]+"px"),this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector("."+kt))&&((this.parent.groupingBarModule.refreshUI(),this.parent.element.querySelector(".e-group-row").offsetWidth<245&&!this.parent.firstColWidth)&&(n.cancel=!0,t=this.parent.grid.columns,t&&t.length>0&&(t[0].width=this.resColWidth),this.parent.element.querySelector(".e-frozenheader").querySelector("col").style.width=this.resColWidth+"px",this.parent.element.querySelector(".e-frozencontent").querySelector("col").style.width=this.resColWidth+"px"),this.parent.element.querySelector(".e-group-rows").style.height="auto",this.parent.element.querySelector(".e-group-values").style.width=this.parent.element.querySelector(".e-group-row").offsetWidth+"px",i=this.parent.element.querySelector(".e-headercontent").offsetHeight,this.parent.element.querySelector(".e-group-rows").style.height=i+"px");n.cancel&&(r="0.formattedText"===n.column.field?"0.formattedText":n.column.customAttributes.cell.valueSort.levelName,this.parent.resizeInfo[r]=Number(n.column.width.toString().split("px")[0]),this.parent.enableVirtualization&&this.parent.layoutRefresh());this.parent.enableVirtualization&&(this.parent.resizedValue=n.cancel||"0.formattedText"!==n.column.field?this.parent.resizedValue:Number(n.column.width.toString().split("px")[0]));this.parent.trigger("touchend"===n.e.type||"mouseup"===n.e.type?"resizeStop":"resizing",n)},t.prototype.selected=function(){clearTimeout(this.timeOutObj);this.timeOutObj=setTimeout(this.onSelect.bind(this),300)},t.prototype.onSelect=function(){for(var t={selectedCellsInfo:[],pivotValues:this.parent.pivotValues,currentCell:null},i=0,r=this.parent.element.querySelectorAll("."+tt+",."+d);i<r.length;i++){var u=r[i],f=Number(u.getAttribute("data-colindex")),e=Number(u.getAttribute("index")),n=this.engine.pivotValues[e][f];n&&("value"===n.axis?t.selectedCellsInfo.push({currentCell:n,value:n.value,columnHeaders:n.columnHeaders,rowHeaders:n.rowHeaders,measure:n.actualText.toString()}):"column"===n.axis?t.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:n.valueSort.levelName,rowHeaders:"",measure:""}):t.selectedCellsInfo.push({currentCell:n,value:n.formattedText,columnHeaders:"",rowHeaders:n.valueSort.levelName,measure:""}))}this.parent.trigger("cellSelected",t)},t.prototype.rowCellBoundEvent=function(t){var r=t.cell,p,a,v,b,l,tt,o,u,h,k,y,it,s;if(r&&this.parent.notEmpty&&this.engine.headerContent){var d=this.parent.hyperlinkSettings.cssClass,i=t.data[0],g=i.valueSort&&i.valueSort.levelName===(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText);if(r.setAttribute("index",i.rowIndex?i.rowIndex.toString():"0"),"0"===r.getAttribute("data-colindex")){if("pivot"===this.parent.dataType){p=i.type&&"value"===i.type;r.innerText="";var nt=i.valueSort?i.valueSort.levelName.toString():"",w=i.actualText?i.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,c=nt.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(w?w-1:w),f=c?c-1:0;f=i.isSum?f-1:f;do f>0&&r.appendChild(n.createElement("span",{className:0===f?"":ku})),f--;while(f>-1);if(f=c?c-1:0,this.lastSpan=c?this.lastSpan:0,!i.hasChild&&(p?0:f)>0&&r.appendChild(n.createElement("span",{className:ko})),a=void 0,this.parent.dataSourceSettings.rows.length>0&&(!i.valueSort||Object.keys(i.valueSort).length>0)){if(p){for(v=0,b=this.parent.dataSourceSettings.values;v<b.length;v++)if(l=b[v],tt=l.caption?l.caption:l.name,nt.indexOf(tt)>-1){a=l.name;break}}else a=i.level>-1&&this.parent.dataSourceSettings.rows[i.level]?this.parent.dataSourceSettings.rows[i.level].name:"";r.setAttribute("fieldname",a)}}else r=this.onOlapRowCellBoundEvent(r,i);o=i.formattedText;i.type&&("grand sum"===i.type?(this.rowGrandPos=i.rowIndex,r.classList.add("e-gtot"),u=this.parent.dataSourceSettings.values,o=n.isNullOrUndefined(i.valueSort.axis)?0===this.parent.dataSourceSettings.rows.length&&1===u.length&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(u[u.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+(n.isNullOrUndefined(u[u.length-1].caption)?u[u.length-1].name:u[u.length-1].caption):this.parent.localeObj.getConstant("grandTotal"):i.formattedText):i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText?(r.classList.add("e-gtot"),o=g?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[i.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+i.formattedText:o):"sum"===i.type&&3!==i.memberType?o=i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):r.classList.add("e-stot"));r.classList.add(ci);!0!==i.hasChild||i.isNamedSet||r.appendChild(n.createElement("div",{className:(!0===i.isDrilled?bi:fr)+" "+e,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}}));r.appendChild(n.createElement("span",{className:po,innerHTML:this.parent.isRowCellHyperlink||i.enableHyperlink?'<a  data-url="'+o+'" class="e-hyperlinkcell '+d+'">'+o+"<\/a>":o}));h=this.parent.pivotView.dataSourceSettings.valueSortSettings;this.parent.enableValueSorting&&(k=h&&"pivot"===this.parent.dataType?h.rowHeader:h.headerText,h&&k&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.pivotValues[Number(r.getAttribute("index"))][0]&&this.parent.pivotValues[Number(r.getAttribute("index"))][0].valueSort.levelName&&this.parent.pivotValues[Number(r.getAttribute("index"))][0].valueSort.levelName===k&&r.appendChild(n.createElement("span",{className:("Descending"===h.rowOrder?"e-icon-descending e-icons e-descending e-sortfilterdiv e-value-sort-icon":"e-icon-ascending e-icons e-ascending e-sortfilterdiv e-value-sort-icon")+(i.hasChild?" e-value-sort-align":""),styles:"right"===r.style.textAlign?"float: left":""})))}else y=r.innerText,r.innerText="",r.classList.add("e-valuescontent"),i=t.data[Number(r.getAttribute("data-colindex"))],(i=n.isNullOrUndefined(i)?t.column.customAttributes.cell:i).isGrandSum=!!g||i.isGrandSum,i.isSum&&r.classList.add("e-summary"),it=n.isNullOrUndefined(i.isGrandSum)&&!n.isNullOrUndefined(this.parent.olapEngineModule)&&"column"===this.parent.olapEngineModule.olapValueAxis&&"olap"===this.parent.dataType&&this.colGrandPos-this.parent.dataSourceSettings.values.length<Number(r.getAttribute("data-colindex")),i.isGrandSum||it||this.colGrandPos===Number(r.getAttribute("data-colindex"))||this.rowGrandPos===Number(r.getAttribute("index"))?r.classList.add("e-gtot"):("olap"===this.parent.dataType?i.isSum:this.validateColumnTotalcell(i.colIndex))&&r.classList.add("e-colstot"),i.cssClass&&r.classList.add(i.cssClass),r.appendChild(n.createElement("span",{className:po,innerHTML:-1!==r.className.indexOf("e-summary")&&this.parent.isSummaryCellHyperlink||-1===r.className.indexOf("e-summary")&&this.parent.isValueCellHyperlink||i.enableHyperlink?'<a data-url="'+y+'" class="e-hyperlinkcell '+d+'">'+y+"<\/a>":y})),this.parent.gridSettings.allowReordering&&!this.parent.showGroupingBar&&r.setAttribute("data-colindex",t.column.customAttributes?t.column.customAttributes.cell.colIndex.toString():t.column.index.toString());this.parent.cellTemplate&&(s=this.parent.getCellTemplate()({targetCell:r,cellInfo:i},this.parent,"cellTemplate",this.parent.element.id+"_cellTemplate",null,null,r),s&&""!==s&&s.length>0&&(this.parent.enableHtmlSanitizer?this.parent.isVue||this.parent.isVue3?n.append(n.SanitizeHtmlHelper.sanitize(s),r):this.parent.appendHtml(r,n.SanitizeHtmlHelper.sanitize(s[0].outerHTML)):this.parent.isVue||this.parent.isVue3?n.append(s,r):this.parent.appendHtml(r,s[0].outerHTML)));this.unWireEvents(r);this.wireEvents(r)}t.pivotview=this.parent;this.parent.trigger("queryCellInfo",t)},t.prototype.onOlapRowCellBoundEvent=function(t,i){var y,a,u,l,p,v,w,e,b,it,s,h,rt;if(t.innerText="",y=this.engine.rowMeasurePos,this.parent.enableVirtualization){if(i.ordinal>-1&&this.parent.olapEngineModule.tupRowInfo.length>0){var c=this.parent.olapEngineModule.tupRowInfo[i.ordinal],ut=c.uNameCollection.indexOf(i.actualText.toString()),k=(c.uNameCollection.substring(0,ut)+(3===i.memberType?"":i.actualText.toString())).split("::[").map(function(n){return"["===n[0]?n:"["+n});3===i.memberType&&y&&k.push(i.actualText.toString());for(var d=-1,nt=0,g=!1,r=0;r<k.length;r++)d+=k[r].split("~~").length,a="2"!==c.typeCollection[r]&&(!!(this.engine.fieldList[c.members[r].getAttribute("Hierarchy")]&&this.engine.fieldList[c.members[r].getAttribute("Hierarchy")].isHierarchy&&r<this.parent.dataSourceSettings.rows.length-1&&!this.parent.dataSourceSettings.rows[r+1].isNamedSet&&this.parent.dataSourceSettings.rows[r+1].name.indexOf("[Measures]")<0&&this.engine.fieldList[this.parent.dataSourceSettings.rows[r+1].name]&&this.engine.fieldList[this.parent.dataSourceSettings.rows[r+1].name].hasAllMember)||Number(c.members[r].querySelector("CHILDREN_CARDINALITY").textContent)>0),nt+=r>0&&g&&!a?1:0,g=a;for(u=0,l=0;l<d;l++)t.appendChild(n.createElement("span",{className:ku})),u++;for(l=0;l<nt&&d>0;l++)t.appendChild(n.createElement("span",{className:ko}));this.indentCollection[i.rowIndex]=u;this.maxIndent=this.maxIndent>u?this.maxIndent:u}}else{var o=i.hierarchy,f=3===i.memberType?this.measurePos+"."+i.levelUniqueName:i.levelUniqueName,tt=(a=i.hasChild,!1);if(i.isSum&&3===i.memberType){for(p=this.lvlCollection[i.parentUniqueName].position,v=p+1;v<this.position;v++)delete this.lvlCollection[this.lvlPosCollection[v]],delete this.lvlPosCollection[v];this.position=this.position>p+1?p+1:this.position;tt=!0;this.measurePos=this.lvlCollection[i.parentUniqueName].position}if(!this.lvlCollection[f]&&f)this.lvlPosCollection[this.position]=f,this.lvlCollection[f]={position:this.position,hasChild:a},this.position++;else if(f){for(w=this.lvlCollection[f].position,e=w+1;e<this.position;e++)delete this.lvlCollection[this.lvlPosCollection[e]],delete this.lvlPosCollection[e];this.position=this.position>w+1?w+1:this.position}if(!this.hierarchyCollection[o]&&o)this.hierarchyPosCollection[this.hierarchyCount]=o,this.hierarchyCollection[o]={lvlPosition:this.position-1,hierarchyPOs:this.hierarchyCount},this.hierarchyCount++;else if(o){for(b=this.hierarchyCollection[o].hierarchyPOs,e=b+1;e<this.hierarchyCount;e++)delete this.hierarchyCollection[this.hierarchyPosCollection[e]],delete this.hierarchyPosCollection[e];this.hierarchyCount=this.hierarchyCount>b+1?b+1:this.hierarchyCount}for(3!==i.memberType&&f&&this.lvlCollection[f]&&(it=this.hierarchyCollection[o]?this.hierarchyCollection[o].hierarchyPOs:-1,this.measurePos=y<=it&&this.hierarchyPosCollection[y+1]?this.measurePos:this.lvlCollection[f].position),s=this.lvlCollection[f]?this.lvlCollection[f].position:-1,s=tt?s-1:s,h=0,u=0;h<=s&&s>0&&i.level>-1;)rt=this.lvlCollection[this.lvlPosCollection[h]].hasChild,(g=h>0&&this.lvlCollection[this.lvlPosCollection[h-1]].hasChild)&&!rt&&t.appendChild(n.createElement("span",{className:ko})),h!==s&&(t.appendChild(n.createElement("span",{className:ku})),u++),h++;"Top"!==this.parent.dataSourceSettings.grandTotalsPosition||n.isNullOrUndefined(this.parent.olapEngineModule)||"row"!==this.parent.olapEngineModule.olapValueAxis||"olap"!==this.parent.dataType||0!==i.valueSort.levelName.toString().indexOf(this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter)||t.appendChild(n.createElement("span",{className:ku}));3===i.memberType&&-1===i.level&&Object.keys(this.lvlCollection).length>1&&(t.appendChild(n.createElement("span",{className:ku})),u++);this.indentCollection[i.rowIndex]=u;this.maxIndent=this.maxIndent>u?this.maxIndent:u}return t.setAttribute("fieldname",i.hierarchy),!!this.parent.olapEngineModule.tupRowInfo[i.ordinal]&&(0===this.parent.olapEngineModule.tupRowInfo[i.ordinal].measurePosition?1===this.parent.olapEngineModule.tupRowInfo[i.ordinal].allStartPos:0===this.parent.olapEngineModule.tupRowInfo[i.ordinal].allStartPos)&&t.classList.add("e-gtot"),t},t.prototype.columnCellBoundEvent=function(t){var i,r,l,a,v,f,u,o,w,b,s;if(t.cell.column&&t.cell.column.customAttributes&&(i=t.cell.column.customAttributes.cell,r=t.node,i)){for(var y=this.parent.hyperlinkSettings.cssClass,h=!1,c=0,p=this.parent.dataSourceSettings.values;c<p.length;c++)l=p[c],l.name===i.actualText&&(h=!0,r.setAttribute("fieldname",l.name));for(-1===i.level&&!i.rowSpan||-1===i.rowSpan?t.node.style.display="none":i.rowSpan>1&&(t.node.setAttribute("rowspan",i.rowSpan.toString()),t.node.setAttribute("aria-rowspan",i.rowSpan.toString()),i.rowIndex+i.rowSpan===this.engine.headerContent.length&&(t.node.style.borderBottomWidth="0px")),t.node.setAttribute("data-colindex",i.colIndex.toString()),t.node.setAttribute("index",i.rowIndex.toString()),a=void 0,"pivot"===this.parent.dataType?(!h&&!(this.parent.dataSourceSettings.values&&"column"===this.parent.dataSourceSettings.valueAxis&&this.parent.dataSourceSettings.values.length>1&&h&&i.rowIndex===this.engine.headerContent.length-1)&&this.parent.dataSourceSettings.columns&&this.parent.dataSourceSettings.columns.length>0&&(a=i.level>-1&&this.parent.dataSourceSettings.columns[i.level]?this.parent.dataSourceSettings.columns[i.level].name:"",r.setAttribute("fieldname",a)),this.validateColumnTotalcell(i.colIndex)&&r.classList.add("e-colstot")):r=this.onOlapColumnCellBoundEvent(r,i),v=0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&i.valueSort&&i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText,(i.type||v)&&(r.classList.add("grand sum"===i.type?"e-gtot":"e-stot"),"grand sum"===i.type?this.colGrandPos=i.colIndex:i.type&&r.classList.add("e-colstot"),f="grand sum"===i.type?n.isNullOrUndefined(i.valueSort.axis)||"olap"===this.parent.dataType?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:i.formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"),f=v&&this.parent.engineModule.fieldList?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[i.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+i.formattedText:f,null!==r.querySelector(".e-headertext")?r.querySelector(".e-headertext").innerText=f:r.querySelector(".e-stackedheadercelldiv").innerText=f),(r.classList.add(bu),this.parent.isColumnCellHyperlink||i.enableHyperlink)&&(r.querySelector(".e-stackedheadercelldiv")?(u=r.querySelector(".e-stackedheadercelldiv").innerText,r.querySelector(".e-stackedheadercelldiv").innerHTML='<a data-url="'+u+'" class="e-hyperlinkcell '+y+'">'+u+"<\/a>"):r.querySelector(".e-headertext")&&(u=r.querySelector(".e-headertext").innerText,r.querySelector(".e-headertext").innerHTML='<a data-url="'+u+'" class="e-hyperlinkcell '+y+'">'+u+"<\/a>")),!0!==i.hasChild||i.isNamedSet?this.updateWrapper(r):(o=r.querySelector(".e-headercelldiv"),o&&(o.style.height="auto",o.style.lineHeight="normal"),w=n.createElement("div",{className:(!0===i.isDrilled?bi:fr)+" "+e,attrs:{title:!0===i.isDrilled?this.parent.localeObj.getConstant("collapse"):this.parent.localeObj.getConstant("expand")}}),r.children[0].style.display=window.navigator.userAgent.indexOf("Edge")>-1||window.navigator.userAgent.indexOf("Trident")>-1?"table":"block",this.updateWrapper(r,w)),r=this.appendValueSortIcon(i,r,i.rowIndex,i.colIndex,t.cell.column),this.parent.cellTemplate&&this.parent.gridHeaderCellInfo.push({targetCell:r}),b=this.parent.dataSourceSettings.values.length,s=0;s<b;s++)this.parent.dataSourceSettings.values[s].name===i.actualText&&("olap"===this.parent.dataType&&this.parent.olapEngineModule.tupColumnInfo[i.ordinal]&&(0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].measurePosition?1===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos:0===this.parent.olapEngineModule.tupColumnInfo[i.ordinal].allStartPos)&&r.classList.add("e-gtot"),i.valueSort.levelName===this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText||i.valueSort.levelName==="Grand Total"+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+i.formattedText?r.classList.add("e-gtot"):r.classList.add("e-valuesheader"));this.unWireEvents(r);this.wireEvents(r)}this.parent.trigger("headerCellInfo",t)},t.prototype.updateWrapper=function(t,i){if(t.querySelectorAll(".e-headercelldiv").length>0||t.querySelectorAll(".e-stackedheadercelldiv").length>0){var r=n.createElement("div",{className:"e-pivotcell-container"}),u=n.createElement("div",{className:(i?"e-stackedheadertext":"e-headertext")+" "+po,innerHTML:t.querySelectorAll(".e-headercelldiv").length>0?t.querySelector(".e-headercelldiv").innerHTML:t.querySelector(".e-stackedheadercelldiv").innerHTML});i&&r.append(i);r.append(u);t.children[0].innerHTML="";t.children[0].append(r)}return t},t.prototype.onOlapColumnCellBoundEvent=function(n,t){n.setAttribute("fieldname",3===t.memberType?t.actualText.toString():t.hierarchy);var i=this.engine.headerContent[t.rowIndex]?this.engine.headerContent[t.rowIndex][t.colIndex-1]:void 0;return i&&i.actualText===t.actualText&&i.type===t.type&&i.colSpan>1&&(n.style.display="none"),t.rowIndex===this.engine.headerContent.length-1&&2===t.memberType&&(n.style.display=this.isSpannedCell(this.engine.headerContent.length,t)?"none":n.style.display),n},t.prototype.isSpannedCell=function(n,t){for(var r,u,i=this.engine.headerContent[t.rowIndex-1]?this.engine.headerContent[t.rowIndex-1][t.colIndex]:void 0;i&&(i.memberType===t.memberType||i.type&&t.type);)i.rowSpan>0&&(r=i.rowSpan,u=i.rowIndex),i=this.engine.headerContent[i.rowIndex-1]?this.engine.headerContent[i.rowIndex-1][t.colIndex]:void 0;return u+r>=n},t.prototype.onHyperCellClick=function(t){var i=t.target.parentElement.parentElement,r={currentCell:i=i.className.indexOf("e-headercelldiv")>-1?i.parentElement:i,data:this.engine.pivotValues[Number(i.getAttribute("index"))][Number(i.getAttribute("data-colindex"))],cancel:!0,nativeEvent:t};this.parent.trigger("hyperlinkCellClick",r,function(t){if(!t.cancel){r.currentCell=n.getElement(r.currentCell);var i=r.currentCell.getAttribute("data-url")?r.currentCell.getAttribute("data-url"):r.currentCell.querySelector("a").getAttribute("data-url");window.open(i)}})},t.prototype.getRowStartPos=function(){for(var i,t=this.parent.pivotValues,n=0;n<(t?t.length:0);n++)if(t[n]&&t[n][0]&&"row"===t[n][0].axis){i=n;break}return i},t.prototype.frameDataSource=function(n){var u=[],r;if(("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&this.parent.dataSourceSettings.values.length>0&&!this.engine.isEmptyData)if(this.parent.enableValueSorting||!this.engine.isEngineUpdated){for(var f=0,i=this.parent.pivotValues,e="value"===n?this.rowStartPos:0,o="value"===n?i?i.length:0:this.rowStartPos,t=e;t<o;t++)if(i[t]){for(u[f="header"===n?t:f]={},r=0;r<i[t].length;r++)i[t][r]&&(u[f][r]=i[t][r]);f++}}else u="value"===n?this.engine.valueContent:this.engine.headerContent;else u=this.frameEmptyData();return u},t.prototype.frameEmptyData=function(){return[{0:{formattedText:this.parent.localeObj.getConstant("grandTotal")},1:{formattedText:this.parent.localeObj.getConstant("emptyData")}}]},t.prototype.calculateColWidth=function(t){var r,i,u;return n.isNullOrUndefined(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=n.isNullOrUndefined(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue,r=this.parent.element.offsetWidth?this.parent.element.offsetWidth:this.parent.element.getBoundingClientRect().width,i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*r:r:Number(this.parent.width),i=i-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,t-=1,this.isOverflows=!(t*this.gridSettings.columnWidth<i),u=t*this.gridSettings.columnWidth<i?i/t:this.gridSettings.columnWidth,this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(u):this.gridSettings.columnWidth},t.prototype.resizeColWidth=function(t){var i,r;return n.isNullOrUndefined(this.parent.resizedValue)||(this.parent.resizedValue=this.parent.showGroupingBar&&this.parent.resizedValue<250?250:this.parent.resizedValue),this.resColWidth=n.isNullOrUndefined(this.parent.resizedValue)?this.resColWidth:this.parent.resizedValue,i=isNaN(this.parent.width)?this.parent.width.toString().indexOf("%")>-1?parseFloat(this.parent.width.toString())/100*this.parent.element.offsetWidth:this.parent.element.offsetWidth:Number(this.parent.width),t-=1,i=i-(this.gridSettings.columnWidth>this.resColWidth?this.gridSettings.columnWidth:this.resColWidth)-2,this.isOverflows=!(t*this.gridSettings.columnWidth<i),r=t*this.gridSettings.columnWidth<i?i/t:this.gridSettings.columnWidth,this.isOverflows||this.gridSettings.allowAutoResizing?Math.floor(r):this.gridSettings.columnWidth},t.prototype.calculateGridWidth=function(){var n=this.parent.width,t=this.parent.element.getBoundingClientRect().width?this.parent.element.getBoundingClientRect().width:this.parent.element.offsetWidth;return 0===t&&(t=this.parent.element.parentElement.getBoundingClientRect().width?this.parent.element.parentElement.getBoundingClientRect().width:this.parent.element.parentElement.offsetWidth),"auto"===this.gridSettings.width?"auto"===this.parent.width?n=t:this.parent.width.toString().indexOf("%")>-1&&(n=parseFloat(this.parent.width.toString())/100*t):n=this.gridSettings.width,!this.gridSettings.allowAutoResizing&&n>this.parent.totColWidth?this.parent.totColWidth:n},t.prototype.calculateGridHeight=function(n){var t=this.parent.height,i=this.parent.getHeightAsNumber();if(isNaN(i)&&(i=i>this.parent.minHeight?i:this.parent.minHeight),this.parent.showToolbar&&"Chart"!==this.parent.currentView||!this.parent.showToolbar&&"Chart"!==this.parent.displayOption.view)if("auto"===this.gridSettings.height&&i&&this.parent.element.querySelector("."+nf))if(t=(t=i-(this.parent.element.querySelector("."+nf).offsetHeight+(this.parent.element.querySelector("."+er)?this.parent.element.querySelector("."+er).offsetHeight:0)+(this.parent.element.querySelector("."+uu)?42:0)+(this.parent.element.querySelector("."+el)?this.parent.element.querySelector("."+el).offsetHeight:0))-1)<40?40:t,n){var r=this.parent.element.querySelector("."+gu+" ."+hi).offsetHeight,f=this.parent.element.querySelector("."+at).offsetHeight,e=this.parent.element.querySelector("."+at+" ."+hi).offsetWidth,u=this.parent.element.querySelector("."+at).offsetWidth<e;t>=r&&(!u||t>=f)&&!(u&&t-r<18)?this.parent.grid.height="auto":(this.parent.grid.height=t,this.parent.grid.dataBind());this.parent.grid.widthService.refreshFrozenScrollbar()}else t>this.engine.valueContent.length*this.gridSettings.rowHeight&&(t="auto");else t=this.gridSettings.height;return t<this.parent.gridSettings.rowHeight?this.parent.gridSettings.rowHeight:t},t.prototype.frameStackedHeaders=function(){var c=this.parent.pivotColumns,l=this.parent.grid.columnModel,f=!1,p=!(!this.parent.toolbarModule||!this.parent.toolbarModule.isReportChange)||!!this.parent.actionObj&&("Sort value"===this.parent.actionObj.actionName&&1===this.parent.engineModule.valueAxis||"Sort field"===this.parent.actionObj.actionName&&"columns"===this.parent.actionObj.fieldInfo.axis||this.parent.pivotFieldListModule&&"Sort field"===this.parent.pivotFieldListModule.actionObj.actionName&&"columns"===this.parent.pivotFieldListModule.actionObj.fieldInfo.axis),k=1!==this.parent.dataSourceSettings.values.length||this.parent.dataSourceSettings.alwaysShowValueHeader?void 0:this.formatList[this.parent.dataSourceSettings.values[0].name],u,r,i,w,t,e,s,o;if(this.pivotColumns=[],("olap"===this.parent.dataType&&""!==this.parent.dataSourceSettings.url||this.parent.dataSourceSettings.values.length>0&&this.parent.dataSourceSettings.dataSource&&this.parent.engineModule.data.length>0||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url&&this.engine.pivotValues.length>0)&&!this.engine.isEmptyData){var a=this.engine.headerContent.length,v=[],y=[],d=this.calculateColWidth(this.engine.pivotValues?this.engine.pivotValues[0].length:0);do{if(u=[],r=0,a--,i=this.engine.headerContent[a],w=i?Object.keys(i).length:0,i)for(t=0;t<Object.keys(i).length+(i[0]?0:1);t++){if(e=i[t]&&i[t].colSpan?3!==i[t].memberType||0===a?i[t].colSpan:v[t]:1,e="olap"===this.parent.dataType&&n.isNullOrUndefined(e)?1:e,s=i[t]?"grand sum"===i[t].type?n.isNullOrUndefined(i[t].valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):i[t].formattedText:"sum"===i[t].type?i[t].formattedText.split("Total")[0]+this.parent.localeObj.getConstant("total"):i[t].formattedText:"",s=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(s):s,a===this.engine.headerContent.length-1)e=1,f=c.length-1===w&&!p&&!this.parent.isEmptyGrid&&c[r]&&c[r].autoFit,u[r]={field:t+".formattedText",headerText:s,customAttributes:{cell:i[t]},width:f?l[r].width:i[t]&&i[t].valueSort?this.setSavedWidth(i[t].valueSort.levelName,d):this.resColWidth,minWidth:f&&r===w?l[l.length-1].minWidth:30,format:0===t?"":n.isNullOrUndefined(k)?this.formatList[i[t].actualText]:k,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,textAlign:this.parent.enableRtl?"Left":"Right",headerTextAlign:this.parent.enableRtl?"Right":"Left"};else if(v[t]){for(var g=e,b=[],h=t;g>0;){if(u[r]){if(!this.pivotColumns[y[h]])break;b.push(this.pivotColumns[y[h]])}else u[r]={headerText:s,field:i[t]?i[t].valueSort.levelName:"",customAttributes:{cell:i[t]},width:f&&0===r&&!p&&!this.parent.isEmptyGrid&&c[0].autoFit?l[0].width:i[t]?this.setSavedWidth(i[t].valueSort.levelName,d):this.resColWidth,minWidth:30,allowReordering:!this.parent.showGroupingBar&&this.parent.gridSettings.allowReordering,allowResizing:this.parent.gridSettings.allowResizing,visible:!0},b=[this.pivotColumns[y[h]]];this.isAutoFitEnabled=!!this.isAutoFitEnabled||f;g-=v[h];h+=v[h]}u[r].columns=b}u[r]&&(u[r].clipMode=this.gridSettings.clipMode);v[t]=e;y[t]=r;r++;t=t+e-1}this.pivotColumns=u.length>0?u:this.pivotColumns}while(a>0);this.pivotColumns[0]={field:"0.formattedText",width:f&&!p&&!this.parent.isEmptyGrid&&c[0].autoFit?l[0].width:this.resColWidth,minWidth:30,headerText:"",allowReordering:!1,allowResizing:this.parent.gridSettings.allowResizing,visible:!0,clipMode:this.parent.gridSettings.clipMode}}else this.pivotColumns=this.frameEmptyColumns();return(this.parent.toolbarModule&&this.parent.showToolbar&&(this.parent.toolbarModule.isReportChange=!1),this.parent.triggerColumnRenderEvent(this.pivotColumns),f=this.parent.pivotColumns.length>0&&this.parent.pivotColumns[this.parent.pivotColumns.length-1].autoFit,this.pivotColumns.length>1&&!f)&&(o=this.pivotColumns[this.pivotColumns.length-1],o.minWidth=o.width,o.width="auto",o.columns&&o.columns.length>0&&this.configLastColumnWidth(o.columns[o.columns.length-1])),this.pivotColumns},t.prototype.configLastColumnWidth=function(n){n.minWidth=n.width;n.width="auto";n.columns&&n.columns.length>0&&this.configLastColumnWidth(n.columns[n.columns.length-1])},t.prototype.setSavedWidth=function(t,i){return"0.formattedText"!==t||n.isNullOrUndefined(this.parent.resizedValue)?this.parent.resizeInfo[t]?this.parent.resizeInfo[t]:i:this.parent.resizedValue},t.prototype.frameEmptyColumns=function(){var n=[],t=this.calculateColWidth(2);return n.push({field:"0.formattedText",headerText:"",minWidth:30,width:this.resColWidth}),n.push({field:"1.formattedText",headerText:this.parent.localeObj.getConstant("grandTotal"),minWidth:30,width:t}),n},t.prototype.getFormatList=function(){for(var t,i,u,f,o,e={},r=0;r<this.parent.dataSourceSettings.values.length;r++){if(t=this.parent.dataSourceSettings.values[r],i="N","olap"===this.parent.dataType)this.parent.olapEngineModule.fieldList[t.name]&&!n.isNullOrUndefined(this.parent.olapEngineModule.fieldList[t.name].formatString)&&(u=this.parent.olapEngineModule.fieldList[t.name].formatString,i=u.indexOf("#")>-1?u:u[0]+"2");else if(["PercentageOfDifferenceFrom","PercentageOfRowTotal","PercentageOfColumnTotal","PercentageOfGrandTotal","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"].indexOf(t.type)>-1?i="P2":["PopulationStDev","SampleStDev","PopulationVar","SampleVar","Index"].indexOf(t.type)>-1&&(i=void 0),this.parent.dataSourceSettings.formatSettings.length>0)for(f=0;f<this.parent.dataSourceSettings.formatSettings.length;f++)if(o=this.parent.dataSourceSettings.formatSettings[f],t.name===o.name){i=o.format;break}e[t.name]=i}return e},t.prototype.getValidHeader=function(t,i){var u=this.parent.dataSourceSettings.values,r;if("row"===i){if(r=t,0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length){if(0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+r.value===r.data[0].valueSort.levelName)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[r.value.toString()].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+r.value.toString();if(1===u.length&&0===this.parent.dataSourceSettings.rows.length)return this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(u[u.length-1].type)+" "+this.parent.localeObj.getConstant("of")+" "+(n.isNullOrUndefined(u[u.length-1].caption)?u[u.length-1].name:u[u.length-1].caption)}return r.value}if("column"===i)return r=t,0!==this.parent.dataSourceSettings.rows.length&&0!==this.parent.dataSourceSettings.columns.length||n.isNullOrUndefined(t.gridCell.column.customAttributes)||0!==this.parent.dataSourceSettings.columns.length||"column"!==this.parent.dataSourceSettings.valueAxis||this.parent.localeObj.getConstant("grandTotal")+this.parent.dataSourceSettings.valueSortSettings.headerDelimiter+r.gridCell.column.customAttributes.cell.formattedText!==r.gridCell.column.customAttributes.cell.valueSort.levelName?r.cell.value:this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(this.parent.engineModule.fieldList[r.gridCell.column.customAttributes.cell.actualText].aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+r.gridCell.column.customAttributes.cell.formattedText},t.prototype.excelColumnEvent=function(n){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(n.cell.value=this.getValidHeader(n,"column"));void 0!==n.gridCell&&"auto"===n.gridCell.column.width&&(this.parent.lastColumn=n.gridCell.column,n.gridCell.column.width=n.gridCell.column.minWidth);n=this.exportHeaderEvent(n);this.parent.trigger("excelHeaderQueryCellInfo",n)},t.prototype.pdfColumnEvent=function(n){0===this.parent.dataSourceSettings.columns.length&&"column"===this.parent.dataSourceSettings.valueAxis&&(n.cell.value=this.getValidHeader(n,"column"));void 0!==n.gridCell&&"auto"===n.gridCell.column.width&&(this.parent.lastColumn=n.gridCell.column,n.gridCell.column.width=n.gridCell.column.minWidth);this.parent.trigger("pdfHeaderQueryCellInfo",n)},t.prototype.excelRowEvent=function(t){var i,u;if("0.formattedText"===t.column.field){var r=t.data[0],s=r.type&&"value"===r.type,f=0;if("olap"===this.parent.dataType)f=this.indentCollection[r.rowIndex];else{var h=r.valueSort?r.valueSort.levelName.toString():"",e=r.actualText?r.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,o=h.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(e?e-1:e);f=o?o-1:0}this.colPos=0;t.style={hAlign:"Left",indent:2*f};this.lastSpan=s?this.lastSpan:f}else this.colPos++,i=t.data[t.column.customAttributes.cell?t.column.customAttributes.cell.colIndex:this.colPos],n.isNullOrUndefined(i.value)||n.isNullOrUndefined(i.formattedText)||""===i.formattedText?t.value="Excel"===this.parent.exportType?null:"":(u="pivot"===this.parent.dataType&&this.parent.engineModule?this.parent.engineModule.aggregatedValueMatrix:void 0,t.value=u&&u[i.rowIndex]&&u[i.rowIndex][i.colIndex]?u[i.rowIndex][i.colIndex]:n.isNullOrUndefined(i.value)||"#DIV/0!"===i.formattedText?i.formattedText:i.value);t=this.exportContentEvent(t);0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(t.value="0.formattedText"===t.column.field?this.getValidHeader(t,"row"):t.value);this.parent.trigger("excelQueryCellInfo",t)},t.prototype.pdfRowEvent=function(n){if("0.formattedText"===(n=this.exportContentEvent(n)).column.field){var i=0,t=n.data[0],f=t.type&&"value"===t.type;if("olap"===this.parent.dataType)i=this.indentCollection[t.rowIndex];else{var e=t.valueSort?t.valueSort.levelName.toString():"",r=t.actualText?t.actualText.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,u=e.split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).length-(r?r-1:r);i=u?u-1:0}n.style={paragraphIndent:10*i};this.lastSpan=f?this.lastSpan:i;0===this.parent.dataSourceSettings.rows.length&&"row"===this.parent.dataSourceSettings.valueAxis&&(n.value=this.getValidHeader(n,"row"))}this.parent.trigger("pdfQueryCellInfo",n)},t.prototype.excelDataBound=function(n){for(var u=n.excelRows,e=Object.keys(this.engine.headerContent).length,t=0;t<e;t++){for(var r=u[t].cells,f=[],i=0;i<r.length;i++)-1!==r[i].rowSpan&&f.push(r[i]);u[t].cells=f}},t.prototype.exportHeaderEvent=function(t){var r=1,i;return t.gridCell.column.customAttributes?(i=t.gridCell.column.customAttributes.cell,r=i.rowSpan>-1?i.rowSpan:1,"excelHeaderQueryCellInfo"===t.name&&(i.rowSpan>-1?r=i.rowSpan:n.isNullOrUndefined(i.type)||0===i.level||(r=-1,t.cell.rowSpan=-1)),this.actualText=i.actualText):r=Object.keys(this.engine.headerContent).length,t.cell.rowSpan!==r&&r>-1&&(t.cell.rowSpan=r),t},t.prototype.exportContentEvent=function(t){var i=t.data[Number(t.column.field.split(".formattedText")[0])];return t.value="grand sum"===i.type?n.isNullOrUndefined(i.valueSort.axis)?this.parent.localeObj.getConstant("grandTotal"):i.formattedText:t.value,t},t.prototype.unWireEvents=function(t){t.querySelector(".e-hyperlinkcell")&&n.EventHandler.remove(t.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick)},t.prototype.wireEvents=function(t){t.querySelector(".e-hyperlinkcell")&&n.EventHandler.add(t.querySelector(".e-hyperlinkcell"),this.parent.isAdaptive?"touchend":"click",this.onHyperCellClick,this)},t}(),ha=function(){function t(t){this.keyConfigs={shiftF:"shift+F",shiftS:"shift+S",shiftE:"shift+E","delete":"delete",enter:"enter",escape:"escape",upArrow:"upArrow",downArrow:"downArrow",altJ:"alt+J"};this.parent=t;this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex;this.keyboardModule=new n.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return t.prototype.keyActionHandler=function(n){switch(n.action){case"shiftF":this.processFilter(n);break;case"shiftS":this.processSort(n);break;case"shiftE":this.processEdit(n);break;case"delete":this.processDelete(n);break;case"enter":this.processEnter(n);break;case"escape":this.processClose(n);break;case"upArrow":case"downArrow":this.processFilterNodeSelection(n);break;case"altJ":this.processComponentFocus(n)}},t.prototype.processComponentFocus=function(n){if(this.parent.element)return this.parent.element.focus(),n.stopPropagation(),void n.preventDefault()},t.prototype.getButtonElement=function(n){for(var i=[].slice.call(this.parent.element.querySelectorAll("."+v)),t=0,r=i.length;t<r;t++)if(i[t].getAttribute("data-uid")===n.getAttribute("data-uid"))return i[t];return n},t.prototype.processEnter=function(t){var i=t.target;if(i&&n.closest(i,"."+v))return i.querySelector("."+hr)&&n.closest(i,"."+cr)?i.querySelector("."+hr).click():i.querySelector("."+k)?i.querySelector("."+k).click():!i.querySelector("."+hu)||n.closest(i,"."+cr)||n.closest(i,"."+fs)?i.querySelector("."+bt)&&!n.closest(i,"."+cr)&&i.querySelector("."+bt).click():(i.querySelector("."+hu).click(),this.getButtonElement(i).focus()),void t.preventDefault()},t.prototype.processSort=function(t){var i=t.target;if(i&&n.closest(i,"."+v)&&i.querySelector("."+hu)&&!n.closest(i,"."+cr)&&!n.closest(i,"."+fs))return i.querySelector("."+hu).click(),this.getButtonElement(i).focus(),void t.preventDefault()},t.prototype.processEdit=function(t){var i=t.target;if(i&&n.closest(i,"."+v)&&i.querySelector("."+k))return i.querySelector("."+k).click(),void t.preventDefault()},t.prototype.processFilter=function(t){var r=t.target,i,u;r&&n.closest(r,"."+v)&&r.querySelector("."+bt)&&!n.closest(r,"."+cr)&&((r.querySelector("."+bt).click(),this.parent&&this.parent.control&&"pivotview"===this.parent.moduleName&&this.parent.control.grid&&this.parent.control.showGroupingBar&&this.parent.control.groupingBarModule&&n.closest(r,"."+ri)&&this.parent.filterDialog&&this.parent.filterDialog.dialogPopUp&&!this.parent.filterDialog.dialogPopUp.isDestroyed&&this.parent.filterDialog.dialogPopUp.element)&&(i=this.parent.filterDialog.dialogPopUp.element,u=this.parent.filterDialog.allowExcelLikeFilter,clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){i&&i.classList.contains("e-popup-open")&&(u&&i.querySelector(".e-dlg-closeicon-btn")?i.querySelector(".e-dlg-closeicon-btn").focus():i.querySelector("input")&&i.querySelector("input").focus())})),t.preventDefault())},t.prototype.processFilterNodeSelection=function(t){var r=t.target,u,i,f;if(r&&n.closest(r,"."+go)&&40===t.keyCode){if((i=n.closest(r,"."+ie).querySelector("."+wr))&&i.querySelector("li"))return u=i.querySelector("li"),i.querySelector("li#_active")&&(n.removeClass([i.querySelector("li#_active")],["e-node-focus"]),i.querySelector("li#_active").removeAttribute("id")),u.setAttribute("id","_active"),n.addClass([u],["e-node-focus"]),u.focus(),void t.preventDefault()}else if(r&&n.closest(r,"."+wr)&&38===t.keyCode){if((i=n.closest(r,"."+wr)).querySelector("li#_active.e-node-focus")&&i.querySelector("li")&&i.querySelector("li").classList.contains("e-prev-active-node")&&i.querySelector("li")===i.querySelector("li#_active.e-node-focus")&&(n.removeClass(i.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),f=n.closest(r,"."+ie).querySelector("."+go),f&&f.querySelector("li")))return(u=f.querySelector("li")).setAttribute("id","_active"),n.addClass([u],["e-node-focus"]),u.focus(),void t.preventDefault()}else r&&r.id===this.parent.parentID+"_inputbox"&&("upArrow"===t.action?r.parentElement.querySelector(".e-spin-up").click():"downArrow"===t.action&&r.parentElement.querySelector(".e-spin-down").click())},t.prototype.processDelete=function(t){var i=t.target;if(i&&n.closest(i,"."+v)&&i.querySelector("."+pi))return i.querySelector("."+pi).click(),void t.preventDefault()},t.prototype.processClose=function(t){var u=t.target,i,o,r,f,e;if(u&&n.closest(u,".e-popup.e-popup-open")&&(i=n.closest(u,".e-popup.e-popup-open").ej2_instances[0],i&&!i.closeOnEscape)){if(o=i.element.getAttribute("data-fieldName"),i.hide(),this.parent.element)for(r=0,f=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));r<f.length;r++)if(e=f[r],e.getAttribute("data-uid")===o){e.focus();break}return void t.preventDefault()}},t.prototype.destroy=function(){this.keyboardModule&&this.keyboardModule.destroy()},t}(),ca=function(){function t(n){this.searchListItem=[];this.parent=n}return t.prototype.updateSorting=function(t){var f,c,e,s;if(!t.target.classList.contains(bt)&&!t.target.classList.contains(pi)){this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();var o,u=t.target,i=void 0,h=void 0;if(u.id?(i=u.getAttribute("data-uid"),h=[].slice.call(u.querySelectorAll("."+pr))):(i=u.parentElement.getAttribute("data-uid"),h=[].slice.call(u.parentElement.querySelectorAll("."+pr))),o=0!==h.length,f=r.getFieldByName(i,this.parent.dataSourceSettings.sortSettings),c=this.parent.engineModule&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].membersOrder?this.parent.engineModule.fieldList[i].membersOrder.slice():[],n.isNullOrUndefined(f))s={name:i,order:o?"Ascending":"Descending",membersOrder:f?f.membersOrder:c},this.parent.dataSourceSettings.sortSettings.push(s);else{for(e=0;e<this.parent.dataSourceSettings.sortSettings.length;e++)if(this.parent.dataSourceSettings.sortSettings[e].name===i){this.parent.dataSourceSettings.sortSettings.splice(e,1);break}s={name:i,order:o?"Ascending":"Descending",membersOrder:f?f.membersOrder:c};this.parent.dataSourceSettings.sortSettings.push(s)}this.parent.control.lastSortInfo=this.parent.dataSourceSettings.sortSettings[this.parent.dataSourceSettings.sortSettings.length-1];o?n.removeClass([u],pr):n.addClass([u],pr)}},t.prototype.updateFiltering=function(t){var p=t.target,u=p.parentElement.getAttribute("data-uid"),d=p.parentElement.textContent,a=!1,w=[],v=[],s,l;if(this.parent.dataSourceSettings.allowMemberFilter)if("olap"===this.parent.dataType)v=this.getOlapData(u,a);else{var f=this.parent.engineModule.fieldList[u],i=r.getClonedData(f.dateMember),h=f&&f.membersOrder?f.membersOrder.slice():[],e=void 0;"Out of Range"===i[0].actualText?(e=i[0],i.splice(0,1)):"Out of Range"===i[i.length-1].actualText&&(e=i[i.length-1],i.splice(i.length-1,1));var o={fieldName:u,sortOrder:f.sort,members:h&&h.length>0?h:Object.keys(i),IsOrderChanged:!1},b=!1,y=!(!f||!f.isAlphanumeric)||void 0;if(h&&h.length>0?i=r.applyCustomSort(o,i,y):(i=r.applyHeadersSort(i,o.sortOrder,y),b=!0),s=r.getFilterItemByName(u,this.parent.dataSourceSettings.filterSettings),n.isNullOrUndefined(s)||(a=!(!this.isValidFilterItemsAvail(u,s)||"Include"!==s.type),w=s.items?s.items:[]),e&&("Ascending"===o.sortOrder?"Grand Total"===i[i.length-1].actualText?i.splice(i.length-1,0,e):i.splice(i.length,0,e):"Grand Total"===i[0].actualText?i.splice(1,0,e):i.splice(0,0,e)),b){for(var k=[],c=0,g=0;c<i.length;c++)"Grand Total"!==i[c].actualText&&(k[g++]=i[c].actualText);o.members=k}this.parent.control.trigger(su,o);o.IsOrderChanged&&(i=r.applyCustomSort(o,i,y,!0));v=this.getTreeData(a,i,w,u)}this.parent.filterDialog.dialogPopUp&&this.parent.filterDialog.dialogPopUp.close();l=this.parent.control.filterTargetID;n.isNullOrUndefined(l)&&(l="pivotfieldlist"!==this.parent.moduleName?this.parent.element:document.getElementById(this.parent.parentID+"_Container"));this.parent.filterDialog.createFilterDialog(v,u,d,l)},t.prototype.isValidFilterItemsAvail=function(n,t){var i=!1;if(t&&["Include","Exclude"].indexOf(t.type)>=0)if("Include"===t.type&&0===t.items.length)i=!0;else for(var r=this.parent.engineModule,f=r.fieldList[n],o=r.formatFields[n]&&["date","dateTime","time"].indexOf(r.formatFields[n].type)>-1?f.formattedMembers:f.members,u=0,e=t.items;u<e.length;u++)if(o[e[u]]){i=!0;break}return i},t.prototype.getOlapData=function(t,i){var o=[],c=[],u,f,l,e;this.parent.filterDialog.isSearchEnabled=!1;u=this.parent.engineModule;f=r.getFilterItemByName(t,this.parent.dataSourceSettings.filterSettings);0===u.fieldList[t].filterMembers.length?this.parent.control.loadOnDemandInMemberEditor?f&&f.levelCount>1&&u.fieldList[t].levels.length>1?u.getFilterMembers(this.parent.dataSourceSettings,t,f.levelCount):(u.fieldList[t].levelCount=1,u.getMembers(this.parent.dataSourceSettings,t)):u.getMembers(this.parent.dataSourceSettings,t,!0):(u.fieldList[t].currrentMembers={},u.fieldList[t].searchMembers=[]);l=u.fieldList[t].isHierarchy;o=u.fieldList[t].filterMembers;n.isNullOrUndefined(f)||(i=!f.type||"Include"===f.type,c=f.items?f.items:[]);for(var a={},s={},y=u.fieldList[t].members,h=0,v=c;h<v.length;h++)e=v[h],a[e]=e,s[e]=e,y[e]&&(s=this.getParentNode(t,e,s));return o=this.getFilteredTreeNodes(t,o,s,[]),o=this.getOlapTreeData(i,r.getClonedData(o),a,t,l),this.sortOlapFilterData(o,u.fieldList[t].sort)},t.prototype.sortOlapFilterData=function(n,t){if(n.length>0){for(var o=!1,s=[],f=0;f<n.length;f++)s.push(n[f].caption);var h="Grand Total"!==n[0].caption||void 0===n[0].caption?n[0].htmlAttributes["data-fieldName"]:n[1].htmlAttributes["data-fieldName"],e=this.parent.engineModule.fieldList[h],i=e&&e.membersOrder?e.membersOrder.slice():[],r={fieldName:h,sortOrder:t,members:i&&i.length>0?i:s,IsOrderChanged:!1};if(i&&i.length>0?this.applyFilterCustomSort(n,r):(n="Ascending"===t?n.sort(function(n,t){return n.caption>t.caption?1:t.caption>n.caption?-1:0}):"Descending"===t?n.sort(function(n,t){return n.caption<t.caption?1:t.caption<n.caption?-1:0}):n,o=!0),o){for(var c=[],u=0,l=0;u<n.length;u++)"Grand Total"!==n[u].caption&&(c[l++]=n[u].caption);r.members=c}this.parent.control.trigger(su,r);r.IsOrderChanged&&this.applyFilterCustomSort(n,r,!0)}return n},t.prototype.applyFilterCustomSort=function(n,t,i){var e,o,u=[],r,f,s;for(o=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===n[0].caption&&(e=n[0],n.shift()),r=0,f=0;r<n.length;r++){if(s=n[r].caption,o[f]===s){if(n.splice(f++,0,n[r]),n.splice(++r,1),!(f<o.length)){i||u.splice(--f,0,s);break}r=-1}r>=0&&!i&&(u[r]=n[r].caption)}if(!i){for(r=u.length;r<n.length;r++)u[r]=n[r].caption;"Grand Total"===u[u.length-1]&&u.pop();t.members=u}return e&&n.splice(0,0,e),n},t.prototype.getParentIDs=function(n,t,i){for(var r,e,u=0,f=n.fields.dataSource;u<f.length;u++)if(e=f[u],e.id===t){r=e.pid;break}return r&&(i.push(r),this.getParentIDs(n,r,i)),i},t.prototype.getChildIDs=function(n,t,i){for(var r,e,u=0,f=n.fields.dataSource;u<f.length;u++)if(e=f[u],e.pid===t){r=e.id;break}return r&&(i.push(r),this.getParentIDs(n,r,i)),i},t.prototype.searchTreeNodes=function(t,i,u,f){var l,a,d,y,g,c,p,nt,s,w,tt,b;if(u){for(var e=[],h=[],k=0,it=[].slice.call(i.element.querySelectorAll("li"));k<it.length;k++)l=it[k],l.querySelector(".e-list-text").textContent.toLowerCase().indexOf(t.value.toLowerCase())>-1?e.push(l):h.push(l);if(i.enableNodes(e),n.removeClass(e,o),i.disableNodes(h),n.addClass(h,o),e.length>0&&h.length>0)for(a=0,d=e;a<d.length;a++){var rt=d[a].getAttribute("data-uid"),ut=this.getParentIDs(i,rt,[]),ft=this.getChildIDs(i,rt,[]),v=[];if(ut.length>0)for(y=0,g=h;y<g.length;y++)c=g[y],-1!==r.inArray(c.getAttribute("data-uid"),ut)&&v.push(c);if(ft.length>0)for(p=0,nt=h;p<nt.length;p++)c=nt[p],-1!==r.inArray(c.getAttribute("data-uid"),ft)&&v.push(c);i.enableNodes(v);n.removeClass(v,o)}0===[].slice.call(i.element.querySelectorAll("li."+o)).length?i.collapseAll():i.expandAll(void 0,void 0,!0);this.searchListItem=e}else if(this.parent.searchTreeItems=[],"olap"!==this.parent.dataType||f){for(e=[],s=0,s=1,w=0,tt=this.parent.currentTreeItems;w<tt.length;w++)b=tt[w],b.name.toLowerCase().indexOf(t.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(b),s<=this.parent.control.maxNodeLimitInMemberEditor&&e.push(b),s++);--s>this.parent.control.maxNodeLimitInMemberEditor?(this.parent.editorLabelElement.innerText=s-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"),this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"440px":"400px",this.parent.isDataOverflow=!0):(this.parent.editorLabelElement.innerText="",this.parent.filterDialog.dialogPopUp.height=this.parent.filterDialog.allowExcelLikeFilter?"400px":"350px",this.parent.isDataOverflow=!1);this.parent.isDataOverflow=s>this.parent.control.maxNodeLimitInMemberEditor;this.parent.editorLabelElement.parentElement.style.display=this.parent.isDataOverflow?"block":"none";i.fields={dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};i.dataBind()}else this.updateOlapSearchTree(t,i,f)},t.prototype.updateOlapSearchTree=function(n,t,i){var e=[],f=this.parent.filterDialog.dialogPopUp.element.getAttribute("data-fieldname"),h,a,u,c;if(""===n.value.toLowerCase()){this.parent.filterDialog.isSearchEnabled=!1;this.parent.engineModule.fieldList[f].searchMembers=[];for(var v={},s={},o=this.parent.engineModule.fieldList[f].members,y=[],l=0,p=Object.keys(o);l<p.length;l++)o[u=p[l]].isSelected&&(o[u].parent&&o[o[u].parent].isSelected||y.push(u));for(h=0,a=y;h<a.length;h++)v[u=a[h]]=u,s[u]=u,o[u]&&(s=this.getParentNode(f,u,s));c=this.parent.engineModule.fieldList[f].filterMembers;e=this.getFilteredTreeNodes(f,c,s,[]);e=this.getOlapTreeData(!0,r.getClonedData(e),v,f,i,!0)}else this.parent.filterDialog.isSearchEnabled=!0,c=this.parent.engineModule.fieldList[f].searchMembers,e=r.getClonedData(c),e=this.getOlapSearchTreeData(!0,e,f);t.fields={dataSource:e,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};t.dataBind()},t.prototype.getTreeData=function(t,i,r,u){var c,a,s,o,h,f;this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];this.parent.currentTreeItemsPos={};this.parent.savedTreeFilterPos={};c=this.parent.engineModule;this.parent.isDateField=c.formatFields[u]&&["date","dateTime","time"].indexOf(c.formatFields[u].type)>-1;for(var y=[],e=1,p={},l=0,w=r;l<w.length;l++)a=w[l],p[a]=a;for(var k=u.replace(/[^a-zA-Z0-9 ]/g,"_"),v=0,b=i;v<b.length;v++)s=b[v],o=c.formatFields[u]?s.formattedText:s.actualText.toString(),o=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(o):o,h=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(s.actualText):s.actualText,f={id:k+"_"+e,htmlAttributes:{"data-fieldName":u,"data-memberId":h.toString()},actualText:h,name:o,isSelected:!t},void 0!==p[h]&&(f.isSelected=!!t),e<=this.parent.control.maxNodeLimitInMemberEditor&&y.push(f),f.isSelected||(this.parent.savedTreeFilterPos[e-1]=o),this.parent.currentTreeItems.push(f),this.parent.searchTreeItems.push(f),this.parent.currentTreeItemsPos[h]={index:e-1,isSelected:f.isSelected},e++;return this.parent.isDataOverflow=e-1>this.parent.control.maxNodeLimitInMemberEditor,y},t.prototype.getOlapTreeData=function(n,t,i,r,u,f){var o=this.parent.engineModule.fieldList[r];this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];this.parent.currentTreeItemsPos={};for(var a=[],h=1,l=0,v=t;l<v.length;l++){var c=v[l],e=c,s=c.id.toString();f||(e.isSelected=!n);void 0!==i[s]&&(e.isSelected=!!n);!f&&c.hasChildren&&this.updateChildNodeStates(o.filterMembers,r,c.id,e.isSelected);o.members[s].isSelected=e.isSelected;o.currrentMembers&&o.currrentMembers[s]&&(o.currrentMembers[s].isSelected=e.isSelected);h<=this.parent.control.maxNodeLimitInMemberEditor&&u&&a.push(e);this.parent.currentTreeItems.push(e);this.parent.searchTreeItems.push(e);this.parent.currentTreeItemsPos[s]={index:h-1,isSelected:e.isSelected};h++}return this.parent.isDataOverflow=!!u&&h-1>this.parent.control.maxNodeLimitInMemberEditor,u?a:t},t.prototype.getOlapSearchTreeData=function(n,t,i){for(var r,f,e=this.parent.engineModule.fieldList[i].members,u=0,o=t;u<o.length;u++)r=o[u],f=r.id.toString(),e[f]&&(r.isSelected=e[f].isSelected),this.parent.searchTreeItems.push(r);return t},t.prototype.updateChildNodeStates=function(n,t,i,r){for(var u,s=this.parent.engineModule.fieldList[t].members,f=this.parent.engineModule.fieldList[t].currrentMembers,e=0,o=n;e<o.length;e++)u=o[e],u.pid&&u.pid.toString()===i&&(s[u.id].isSelected=r,f&&f[u.id]&&(f[u.id].isSelected=r),u.hasChildren&&this.updateChildNodeStates(n,t,u.id,r))},t.prototype.getParentNode=function(n,t,i){var u=this.parent.engineModule.fieldList[n].members,r;return u[t].parent&&t!==u[t].parent&&(r=u[t].parent,i[r]=r,this.getParentNode(n,r,i)),i},t.prototype.getFilteredTreeNodes=function(t,i,u,f){for(var a,h,c,v,e,s=[],o=this.parent.engineModule.fieldList[t].members,l=0,y=u?Object.keys(u):[];l<y.length;l++)a=y[l],h=o[a]?o[a].parent:void 0,void 0!==h&&-1===r.inArray(h,s)&&s.push(h);for(c=0,v=i;c<v.length;c++)e=v[c],n.isNullOrUndefined(e.pid)||-1!==r.inArray(e.pid,s)?(f.push(e),n.isNullOrUndefined(e.pid)&&-1!==r.inArray(e.id,s)?o[e.id].isNodeExpand=!0:n.isNullOrUndefined(e.pid)||-1===r.inArray(e.pid,s)?o[e.id].isNodeExpand=!1:(o[e.id].isNodeExpand=!1,o[e.pid].isNodeExpand=!0)):o[e.id].isNodeExpand=!1;return f},t}(),la=function(){function t(n){this.parent=n}return t.prototype.onStateModified=function(t,i){var r="",o=n.closest(t.target,"."+si),s=-1,u,f,e;if(this.parent.dataSourceUpdate.btnElement=t.element?t.element.parentElement:void 0,o&&(r=o.classList[1]===kr?"rows":o.classList[1]===dr?"columns":o.classList[1]===cr?"values":o.classList[1]===gr?"filters":""),"olap"===this.parent.dataType||"pivot"===this.parent.dataType){if(u="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i,t.cancel&&""===r)return!1;if(this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&u.toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===r||"rows"===r||"columns"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===u.toLowerCase().indexOf("[measures].")&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&("filters"===r||"values"===r)||this.parent.dataSourceUpdate.btnElement&&"false"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&"olap"===this.parent.dataType&&-1===u.toLowerCase().indexOf("[measures].")&&"values"===r)return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("fieldDropErrorAction"),this.parent.errorDialog.createErrorDialog(f,e),!1}else if(t.cancel&&""===r||this.parent.dataSourceUpdate.btnElement&&"true"===this.parent.dataSourceUpdate.btnElement.getAttribute("isValue")&&("filters"===r||"values"===r||r.indexOf(this.parent.dataSourceSettings.valueAxis)>-1))return!1;if(""!==r){if(("olap"===this.parent.dataType||"pivot"===this.parent.dataType)&&((u="olap"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isCalculatedField?this.parent.engineModule.fieldList[i].tag:i).toLowerCase().indexOf("[measures].")>-1&&"olap"===this.parent.dataType&&("filters"===r||"rows"===r||"columns"===r)||this.parent.engineModule.fieldList[i]&&this.parent.engineModule.fieldList[i].isNamedSets&&"filters"===r||"olap"===this.parent.dataType&&"values"===r&&-1===u.toLowerCase().indexOf("[measures].")))return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("fieldDropErrorAction"),this.parent.errorDialog.createErrorDialog(f,e),!1;if("pivot"===this.parent.dataType&&this.parent.engineModule.fieldList[i]&&"CalculatedField"===this.parent.engineModule.fieldList[i].aggregateType&&"values"!==r)return f=this.parent.localeObj.getConstant("warning"),e=this.parent.localeObj.getConstant("dropAction"),this.parent.errorDialog.createErrorDialog(f,e),!1;s=this.getButtonPosition(t.target,r)}else this.parent.engineModule.fieldList[i]&&(this.parent.engineModule.fieldList[i].isSelected=!1,"olap"===this.parent.dataType&&this.parent.engineModule.updateFieldlistData(i));return this.parent.dataSourceUpdate.updateDataSource(i,r,s)},t.prototype.getButtonPosition=function(t,i){var f=-1,r=n.closest(t,"."+ur);if(!n.isNullOrUndefined(r)){r=r.querySelector("."+v);for(var o=this.parent.element.querySelector(".e-"+i),e=[].slice.call(o.querySelectorAll("."+v)),u=0,s=e.length;u<s;u++)if(e[u].id===r.id){f=u;break}}return f},t}(),aa=function(){function t(n){this.parent=n}return t.prototype.updateDataSource=function(t,i,u){for(var s,y,p,l,e,h,f=this,a=-1,v=!0,c=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],o=0,w=c.length;o<w;o++)if(c[o])for(s=0,y=c[o].length;s<y;s++)(c[o][s].name===t||"olap"===this.parent.dataType&&"[measures]"===c[o][s].name.toLowerCase()&&c[o][s].name.toLowerCase()===t)&&(h=0===o?"rows":1===o?"columns":2===o?"values":"filters",a=s),h||(h="fieldList");return p={fieldName:t,dropField:r.getFieldInfo(t,this.control).fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:i,dropPosition:u,draggedAxis:h,cancel:!1},l="pivotfieldlist"===this.control.getModuleName()&&this.control.isPopupView?this.control.pivotGridModule:this.control,l.trigger(be,p,function(o){var s,c;if(o.cancel)v=!1;else{if(i=o.dropAxis,u=o.dropPosition,t=o.dropField?o.dropField.name:o.fieldName,e=o.dropField,f.control&&f.btnElement&&"true"===f.btnElement.getAttribute("isvalue"))switch(i){case"":f.control.setProperties({dataSourceSettings:{values:[]}},!0);break;case"rows":u=u===f.parent.dataSourceSettings.rows.length?-1:u;f.control.setProperties({dataSourceSettings:{valueAxis:"row",valueIndex:u}},!0);break;case"columns":u=u===f.parent.dataSourceSettings.columns.length?-1:u;f.control.setProperties({dataSourceSettings:{valueAxis:"column",valueIndex:u}},!0)}else(f.removeFieldFromReport(t.toString()),"pivot"===f.parent.dataType&&f.control.showValuesButton&&f.parent.dataSourceSettings.values.length>1)&&(s="row"===f.parent.dataSourceSettings.valueAxis&&"rows"===i?f.parent.dataSourceSettings.rows:"column"===f.parent.dataSourceSettings.valueAxis&&"columns"===i?f.parent.dataSourceSettings.columns:void 0,a<f.parent.dataSourceSettings.valueIndex&&("row"===f.parent.dataSourceSettings.valueAxis&&"rows"===h||"column"===f.parent.dataSourceSettings.valueAxis&&"columns"===h)&&f.control.setProperties({dataSourceSettings:{valueIndex:f.parent.dataSourceSettings.valueIndex-1}},!0),n.isNullOrUndefined(s)||(-1===u&&-1===f.parent.dataSourceSettings.valueIndex?f.control.setProperties({dataSourceSettings:{valueIndex:s.length}},!0):u>-1&&u<=f.parent.dataSourceSettings.valueIndex?f.control.setProperties({dataSourceSettings:{valueIndex:f.parent.dataSourceSettings.valueIndex+1}},!0):f.parent.dataSourceSettings.valueIndex>-1&&u>f.parent.dataSourceSettings.valueIndex&&(u-=1))),"CalculatedField"===(e=f.getNewField(t.toString(),o.dropField)).type&&""!==i&&(i="values");("olap"===f.parent.dataType&&(f.removeFieldFromReport(t.toString()),e=f.getNewField(t.toString(),o.dropField),0===f.parent.dataSourceSettings.values.length&&f.removeFieldFromReport("[measures]"),"CalculatedField"===e.type&&""!==i&&(i="values")),f.control)&&(c={fieldName:t,droppedField:e,dataSourceSettings:r.getClonedDataSourceSettings(f.parent.dataSourceSettings),droppedAxis:i,droppedPosition:u},l.trigger("onFieldDropped",c,function(n){if(e=n.droppedField)switch(u=n.droppedPosition,i=n.droppedAxis){case"filters":-1!==u?f.parent.dataSourceSettings.filters.splice(u,0,e):f.parent.dataSourceSettings.filters.push(e);break;case"rows":-1!==u?f.parent.dataSourceSettings.rows.splice(u,0,e):f.parent.dataSourceSettings.rows.push(e);break;case"columns":-1!==u?f.parent.dataSourceSettings.columns.splice(u,0,e):f.parent.dataSourceSettings.columns.push(e);break;case"values":-1!==u?f.parent.dataSourceSettings.values.splice(u,0,e):f.parent.dataSourceSettings.values.push(e);"olap"!==f.parent.dataType||f.parent.engineModule.isMeasureAvail||f.parent.dataSourceSettings.values.length>1||("row"===f.parent.dataSourceSettings.valueAxis?f.parent.dataSourceSettings.rows:f.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0})}}))}}),v},t.prototype.removeFieldFromReport=function(n){for(var r,s,u,f,e=!1,i=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],o=this.parent.engineModule.fieldList[n],t=0,h=i.length;t<h;t++)if(!e&&i[t])for(r=0,s=i[t].length;r<s;r++)if(i[t][r].name===n||"olap"===this.parent.dataType&&"[measures]"===i[t][r].name.toLowerCase()&&i[t][r].name.toLowerCase()===n){((f=i[t][r].properties?i[t][r].properties:i[t][r]).type=o&&"number"===o.type?f.type:"Count",i[t].splice(r,1),"olap"===this.parent.dataType)&&(u=this.parent.engineModule,u&&u.fieldList[n]&&(u.fieldList[n].currrentMembers={},u.fieldList[n].searchMembers=[]));e=!0;break}return f},t.prototype.getNewField=function(n,t){var r,i;return"olap"===this.parent.dataType?(i=this.parent.engineModule.fieldList[n],r={name:t?t.name:n,caption:t?t.caption:i.caption,isNamedSet:t?t.isNamedSet:i.isNamedSets,isCalculatedField:t?t.isCalculatedField:i.isCalculatedField,type:t?void 0===t.type?"number"===i.type?"Sum":"Count":t.type:void 0===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType,showFilterIcon:t?t.showFilterIcon:i.showFilterIcon,showSortIcon:t?t.showSortIcon:i.showSortIcon,showEditIcon:t?t.showEditIcon:i.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:i.showValueTypeIcon,allowDragAndDrop:t?t.allowDragAndDrop:i.allowDragAndDrop,showSubTotals:t?t.showSubTotals:i.showSubTotals,expandAll:t?t.expandAll:i.expandAll}):(i=this.parent.engineModule.fieldList[n],r={name:t?t.name:n,caption:t?t.caption:i.caption,type:t?void 0===t.type||null===t.type?"number"===i.type?"Sum":"Count":t.type:void 0===i.aggregateType||null===i.aggregateType?"number"===i.type?"Sum":"Count":i.aggregateType,showNoDataItems:t?t.showNoDataItems:i.showNoDataItems,baseField:t?t.baseField:i.baseField,baseItem:t?t.baseItem:i.baseItem,allowDragAndDrop:t?t.allowDragAndDrop:i.allowDragAndDrop,showSubTotals:t?t.showSubTotals:i.showSubTotals,showFilterIcon:t?t.showFilterIcon:i.showFilterIcon,showSortIcon:t?t.showSortIcon:i.showSortIcon,showEditIcon:t?t.showEditIcon:i.showEditIcon,showRemoveIcon:t?t.showRemoveIcon:i.showRemoveIcon,showValueTypeIcon:t?t.showValueTypeIcon:i.showValueTypeIcon,expandAll:t?t.expandAll:i.expandAll}),r},t}(),va=function(){function t(n){this.parent=n}return t.prototype.createErrorDialog=function(t,i,r){var u=n.createElement("div",{id:this.parent.parentID+"_ErrorDialog",className:nc}),f;this.parent.element.appendChild(u);f=r?Number(r.style.zIndex)+1:"pivotfieldlist"===this.parent.moduleName&&"Popup"===this.parent.renderMode&&this.parent.control?this.parent.control.dialogRenderer.fieldListDialog.zIndex+1:"pivotfieldlist"===this.parent.moduleName&&"Fixed"===this.parent.renderMode&&this.parent.control||"pivotview"===this.parent.moduleName&&this.parent.control?1000002:1000001;this.errorPopUp=new b.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:t,content:i,isModal:!0,visible:!0,showCloseIcon:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",zIndex:f,position:{X:"center",Y:"center"},buttons:[{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:lt+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}}],cssClass:this.parent.cssClass,closeOnEscape:!0,target:document.body,close:this.removeErrorDialog.bind(this)});this.errorPopUp.isStringTemplate=!0;this.errorPopUp.appendTo(u)},t.prototype.closeErrorDialog=function(){this.errorPopUp.close()},t.prototype.removeErrorDialog=function(){this.errorPopUp&&!this.errorPopUp.isDestroyed&&this.errorPopUp.destroy();document.getElementById(this.parent.parentID+"_ErrorDialog")&&n.remove(document.getElementById(this.parent.parentID+"_ErrorDialog"))},t}();const cl=ejdashboard.calendars,ya=ejdashboard.splitbuttons,ht=ejdashboard.buttons;var ce,pa=function(){function t(n){this.parent=n}return t.prototype.createFilterDialog=function(t,i,r,u){var f=this,e=n.createElement("div",{id:this.parent.parentID+"_EditorTreeView",className:"e-member-editor-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")+(this.parent.isDataOverflow?" "+ol:""),attrs:{"data-fieldName":i,"aria-label":r}}),h=this.parent.engineModule.fieldList[i].caption,c=this.parent.localeObj.getConstant("filter")+' "'+r+'" '+this.parent.localeObj.getConstant("by"),s;this.filterObject=this.getFilterObject(i);this.isSearchEnabled=!1;this.allowExcelLikeFilter=this.isExcelFilter(i);this.parent.element.appendChild(e);this.dialogPopUp=new b.Dialog({animationSettings:{effect:this.allowExcelLikeFilter?"None":"Fade"},allowDragging:!1,header:this.allowExcelLikeFilter?c:h,content:"",isModal:!0,visible:!0,showCloseIcon:!!this.allowExcelLikeFilter,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"320px",height:this.parent.isDataOverflow?this.allowExcelLikeFilter?"440px":"400px":this.allowExcelLikeFilter?"400px":"350px",position:{X:"center",Y:"center"},buttons:[{buttonModel:{cssClass:"e-clear-filter-button"+(this.allowExcelLikeFilter?"":" "+o)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.filterObject}},{buttonModel:{cssClass:lt+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeFilterDialog.bind(this),buttonModel:{cssClass:br+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}],closeOnEscape:"Popup"!==this.parent.renderMode,target:u,cssClass:this.parent.cssClass,close:this.removeFilterDialog.bind(this)});this.dialogPopUp.isStringTemplate=!0;this.dialogPopUp.appendTo(e);s={cancel:!1,fieldName:i,fieldMembers:this.parent.dataSourceSettings.allowMemberFilter?t:[],filterSetting:this.filterObject};("pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control).trigger("memberEditorOpen",s,function(u){u.cancel?(f.dialogPopUp.close(),f.dialogPopUp=void 0):(t=u.fieldMembers,f.allowExcelLikeFilter?(f.createTabMenu(t,r,i),n.addClass([f.dialogPopUp.element],"e-excel-filter"),f.updateCheckedState()):(f.dialogPopUp.content=f.createTreeView(t,r,i),f.updateCheckedState()),n.setStyleAttribute(f.dialogPopUp.element,{visibility:"visible"}),f.allowExcelLikeFilter&&f.dialogPopUp.element.querySelector(".e-dlg-closeicon-btn").focus(),f.memberTreeView.nodeChecked=f.parent.control.pivotButtonModule.nodeStateModified.bind(f.parent.control.pivotButtonModule),f.allMemberSelect.nodeChecked=f.parent.control.pivotButtonModule.nodeStateModified.bind(f.parent.control.pivotButtonModule))})},t.prototype.createTreeView=function(t,i,r){var u=this,e=n.createElement("div",{id:this.parent.parentID+"EditorDiv",className:ie+(this.allowExcelLikeFilter?" e-excelfilter":"")}),l=n.createElement("button",{id:this.parent.parentID+"_LevelDiv",className:"e-level-container-class",attrs:{type:"button"}}),h=n.createElement("div",{id:this.parent.parentID+"_SearchDiv",attrs:{tabindex:"-1"},className:cc}),g=this.parent.engineModule.fieldList[r].caption,a=n.createElement("input",{attrs:{type:"text",className:"e-editor-search-input"}}),v=this.parent.isDataOverflow?this.parent.currentTreeItems.length-this.parent.control.maxNodeLimitInMemberEditor+this.parent.control.localeObj.getConstant("editorDataLimitMsg"):"",c=n.createElement("div",{id:this.parent.parentID+"_LabelDiv",attrs:{tabindex:"-1",title:v},className:"e-editor-label-container"}),k,d,f;this.parent.editorLabelElement=n.createElement("label",{className:"e-editor-label"});this.parent.editorLabelElement.innerText=v;c.style.display=this.parent.isDataOverflow?"block":"none";c.appendChild(this.parent.editorLabelElement);h.appendChild(a);this.createSortOptions(r,h,t);var y=n.createElement("div",{id:this.parent.parentID+"_AllDiv",attrs:{tabindex:"-1"},className:"e-select-all-container"}),p=n.createElement("div",{id:this.parent.parentID+"_SelectAllContainer",className:go}),w=n.createElement("div",{className:wr+"-outer-div"}),b=n.createElement("div",{className:wr}),s=n.createElement("div",{className:du+" "+o});if(s.innerText=this.parent.localeObj.getConstant("noMatches"),"olap"!==this.parent.dataType||!this.parent.control.loadOnDemandInMemberEditor||this.parent.engineModule.fieldList[r].isHierarchy||this.parent.engineModule.fieldList[r].isNamedSets||(h.appendChild(l),this.createLevelWrapper(l,r)),y.appendChild(p),e.appendChild(h),e.appendChild(y),e.appendChild(s),this.editorSearch=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("search")+" &#8220"+g+"&#8220",enableRtl:this.parent.enableRtl,cssClass:lc+(this.parent.cssClass?" "+this.parent.cssClass:""),showClearButton:!0,change:function(t){if("olap"===u.parent.dataType)u.searchOlapTreeView(t,s);else{u.parent.eventBase.searchTreeNodes(t,u.memberTreeView,!1);var i=u.dialogPopUp.element;0===[].slice.call(u.memberTreeView.element.querySelectorAll("li")).length?(u.allMemberSelect.disableNodes([u.allMemberSelect.element.querySelector("li")]),i.querySelector("."+lt).setAttribute("disabled","disabled"),n.removeClass([s],o)):(u.allMemberSelect.enableNodes([u.allMemberSelect.element.querySelector("li")]),i.querySelector("."+lt).removeAttribute("disabled"),n.addClass([s],o));u.updateCheckedState()}}}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(a),k={"data-fieldName":r,"data-memberId":"all"},d=[{id:"all",name:this.parent.localeObj.getConstant("all"),isSelected:!0,htmlAttributes:k}],this.allMemberSelect=new st.TreeView({fields:{dataSource:d,id:"id",text:"name",isChecked:"isSelected"},showCheckBox:!0,expandOn:"None",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.nodeCheck.bind(this,!0),keyPress:this.nodeCheck.bind(this,!0),nodeSelected:function(t){n.removeClass([t.node],"e-active");t.cancel=!0},cssClass:this.parent.cssClass}),this.allMemberSelect.isStringTemplate=!0,!n.isNullOrUndefined(this.parent.currentTreeItems))for(f=0;f<this.parent.currentTreeItems.length;f++)(this.parent.currentTreeItems[f].id.indexOf("\n")||this.parent.currentTreeItems[f].id.startsWith("\n"))&&(this.parent.currentTreeItems[f].id=this.parent.currentTreeItems[f].id.replace("\n"," "));return this.allMemberSelect.appendTo(p),w.appendChild(b),e.appendChild(w),this.memberTreeView=new st.TreeView({fields:{dataSource:t,id:"id",text:"name",isChecked:"isSelected",parentID:"pid"},showCheckBox:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeChecking:this.validateTreeNode.bind(this),nodeClicked:this.nodeCheck.bind(this,!1),keyPress:this.nodeCheck.bind(this,!1),nodeExpanding:this.updateChildNodes.bind(this),nodeSelected:function(t){n.removeClass([t.node],"e-active");t.cancel=!0},expandOn:"None",cssClass:this.parent.cssClass}),this.memberTreeView.isStringTemplate=!0,this.memberTreeView.appendTo(b),this.parent.isDataOverflow&&this.parent.control.maxNodeLimitInMemberEditor<this.parent.currentTreeItems.length&&e.appendChild(c),e},t.prototype.createSortOptions=function(t,i,r){var s,u;if("pivot"===this.parent.dataType&&r&&r.length>0){s=this.parent.engineModule.fieldList[t].sort;u=n.createElement("div",{className:oc+" e-btn-group"+(this.parent.enableRtl?" "+ii:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),id:this.parent.element.id+"_Member_Sort"});this.parent.element.appendChild(u);var f=n.createElement("button",{className:("Ascending"===s?wi+" ":"")+gf,id:this.parent.element.id+"_Sort_Ascend",attrs:{type:"button","aria-label":"button"}}),o=n.createElement("button",{className:("Descending"===s?wi+" ":"")+gf,id:this.parent.element.id+"_Sort_Descend",attrs:{type:"button","aria-label":"button"}}),h=new ht.Button({iconCss:e+" "+sc,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});h.appendTo(f);(h=new ht.Button({iconCss:e+" "+hc,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass,enableHtmlSanitizer:this.parent.enableHtmlSanitizer})).appendTo(o);u.appendChild(f);u.appendChild(o);i.appendChild(u);this.unWireEvent(f);this.unWireEvent(o);this.wireEvent(f,t);this.wireEvent(o,t)}},t.prototype.createLevelWrapper=function(t,i){for(var r=this,o=this.parent.engineModule,u=o.fieldList[i].levels,s=o.fieldList[i].levelCount,f=[],e=0,h=u.length;e<h;e++)f.push({id:u[e].id,text:u[e].name});this.dropMenu=new ya.DropDownButton({cssClass:"e-level-drop e-caret-hide"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:f,iconCss:"e-icons e-dropdown-icon",disabled:s===u.length,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeOpen:function(t){var f=[].slice.call(t.element.querySelectorAll("li")),o=r.parent.engineModule.fieldList[i].levelCount,u,e;for(n.removeClass(f,l),u=0,e=f.length;u<e;u++)u<o&&n.addClass([f[u]],l)},select:function(n){for(var i,u=r.dialogPopUp.element.getAttribute("data-fieldname"),e=r.parent.engineModule,t=0,o=f.length;t<o;t++)f[t].id===n.item.id&&(i=t);e.getFilterMembers(r.parent.dataSourceSettings,u,i+1,!1,!0)},close:function(){var n=r.parent.engineModule,t=n.fieldList[i].levels;n.fieldList[i].levelCount===t.length?(r.dropMenu.disabled=!0,r.dropMenu.dataBind()):r.dropMenu.disabled=!1}});this.dropMenu.appendTo(t)},t.prototype.searchOlapTreeView=function(t,i){var r=this;clearTimeout(this.timeOutObj);this.timeOutObj=setTimeout(function(){var u=r.parent.engineModule,e=r.dialogPopUp.element,f=e.getAttribute("data-fieldname"),s=r.parent.control.maxNodeLimitInMemberEditor?r.parent.control.maxNodeLimitInMemberEditor:5e3,h;u.fieldList[f].isHierarchy?r.parent.eventBase.searchTreeNodes(t,r.memberTreeView,!1,!0):((r.dropMenu.disabled=r.dropMenu&&""!==t.value?!0:!1,r.parent.control.loadOnDemandInMemberEditor)?(h=u.fieldList[f].levelCount?u.fieldList[f].levelCount:1,u.getSearchMembers(r.parent.dataSourceSettings,f,t.value.toLowerCase(),s,!1,h)):u.getSearchMembers(r.parent.dataSourceSettings,f,t.value.toLowerCase(),s,!0),r.parent.eventBase.searchTreeNodes(t,r.memberTreeView,!1,!1));0===[].slice.call(r.memberTreeView.element.querySelectorAll("li")).length?(r.allMemberSelect.disableNodes([r.allMemberSelect.element.querySelector("li")]),e.querySelector("."+lt).setAttribute("disabled","disabled"),n.removeClass([i],o)):(r.allMemberSelect.enableNodes([r.allMemberSelect.element.querySelector("li")]),e.querySelector("."+lt).removeAttribute("disabled"),n.addClass([i],o));r.updateCheckedState()},500)},t.prototype.nodeCheck=function(t,i){var u=[i.node],r;i.event.target.classList.contains("e-fullrow")||"Enter"===i.event.key?(r=t?this.allMemberSelect:this.memberTreeView,"true"===r.getNode(i.node).isChecked?r.uncheckAll(u):r.checkAll(u)):38!==i.event.keyCode||t||(n.removeClass(this.memberTreeView.element.querySelectorAll("li.e-prev-active-node"),"e-prev-active-node"),n.addClass(u,"e-prev-active-node"))},t.prototype.applySorting=function(t,i){var r=n.closest(i.target,"."+gf),u;r&&(u=[].slice.call(n.closest(r,"."+oc).querySelectorAll("."+gf)),r.querySelector("."+sc)&&!r.classList.contains(wi)?(this.updateFilterMembers("Ascending",t),n.addClass([r],wi),n.removeClass([u[1]],wi)):r.querySelector("."+hc)&&!r.classList.contains(wi)?(this.updateFilterMembers("Descending",t),n.addClass([r],wi),n.removeClass([u[0]],wi)):(this.updateFilterMembers("None",t),n.removeClass(u,wi)))},t.prototype.updateFilterMembers=function(n,t){var o=this.parent.engineModule.fieldList[t],i="None"===n?r.getClonedData(o.dateMember):this.parent.currentTreeItems.slice(),l=!!o.isAlphanumeric||void 0,a=!1,s=o&&o.membersOrder?o.membersOrder.slice():[],e={fieldName:t,sortOrder:n,members:s&&s.length>0?s:Object.keys(i),IsOrderChanged:!1},v,p,f,w;if(s&&s.length>0?i=r.applyCustomSort(e,i,l):(i=r.applyHeadersSort(i,e.sortOrder,l),a=!0),v="pivotfieldlist"===this.parent.moduleName&&this.parent.control.isPopupView?this.parent.control.pivotGridModule:this.parent.control,a){for(var y=[],c=0,b=0;c<i.length;c++)"Grand Total"!==i[c].actualText&&(y[b++]=i[c].actualText);e.members=y}v.trigger(su,e);e.IsOrderChanged&&(i=r.applyCustomSort(e,i,l,!0));this.parent.currentTreeItems=[];this.parent.searchTreeItems=[];for(var h=[],k=t.replace(/[^a-zA-Z0-9 ]/g,"_"),u=0,d=i.length;u<d;u++)"None"===n?(p=(this.parent.isDateField?i[u].formattedText:i[u].actualText).toString(),f={id:k+"_"+(u+1),htmlAttributes:{"data-fieldName":t,"data-memberId":i[u].actualText.toString()},actualText:i[u].actualText,name:p,isSelected:this.parent.currentTreeItemsPos[i[u].actualText].isSelected},this.parent.currentTreeItems.push(f),""!==this.editorSearch.value?f.name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(f),h.push(f)):(this.parent.searchTreeItems.push(f),h.push(f))):(this.parent.currentTreeItems.push(i[u]),""!==this.editorSearch.value?i[u].name.toLowerCase().indexOf(this.editorSearch.value.toLowerCase())>-1&&(this.parent.searchTreeItems.push(i[u]),h.push(i[u])):(this.parent.searchTreeItems.push(i[u]),h.push(i[u]))),this.parent.currentTreeItemsPos[i[u].actualText].index=u;w=this.memberTreeView.fields.dataSource.length;this.memberTreeView.fields={dataSource:h.slice(0,w),id:"id",text:"name",isChecked:"isSelected",parentID:"pid"};this.memberTreeView.dataBind()},t.prototype.updateChildNodes=function(t){var c,o,l,p;if("olap"===this.parent.dataType){var s=this.parent.engineModule,f=t.node.getAttribute("data-fieldname"),i=s.fieldList[f],a=[];if(i&&i.filterMembers.length>0&&!this.isSearchEnabled&&!i.members[t.nodeData.id].isNodeExpand){for(var e=[],h=0,v=i.filterMembers;h<v.length;h++)c=v[h],c.pid===t.nodeData.id.toString()&&e.push(c);0===e.length&&(i.childMembers=[],s.getChildMembers(this.parent.dataSourceSettings,t.nodeData.id.toString(),f),e=i.childMembers,i.childMembers=[]);var u=r.getClonedData(e),w=this.memberTreeView.fields.dataSource,y=!1;for(n.isNullOrUndefined(this.filterObject)||(y="Include"===this.filterObject.type,a=this.filterObject.items?this.filterObject.items:[]),u=this.updateChildData(y,u,a,f,t.nodeData),o=0,l=u=this.parent.eventBase.sortOlapFilterData(u,s.fieldList[f].sort);o<l.length;o++)p=l[o],w.push(p);i.members[t.nodeData.id].isNodeExpand=!0;this.memberTreeView.addNodes(u,t.node)}}},t.prototype.updateChildData=function(n,t,i,r,u){for(var s=Object.keys(this.parent.currentTreeItemsPos).length,v=this.parent.engineModule.fieldList[r],h=[],c=1,e=0,l=t;e<l.length;e++){var o=l[e],f=o,a=o.id.toString();v.members[a].isNodeExpand=!1;o.isSelected="true"===u.isChecked;c<=this.parent.control.maxNodeLimitInMemberEditor&&h.push(f);this.parent.currentTreeItems.push(f);this.parent.searchTreeItems.push(f);this.parent.currentTreeItemsPos[a]={index:s,isSelected:f.isSelected};s++;c++}return this.parent.isDataOverflow=!1,h},t.prototype.createTabMenu=function(t,i,u){var c=n.createElement("div",{id:this.parent.parentID+"_FilterTabContainer",className:"e-filter-tab-container",attrs:{tabindex:"-1"}}),o,s,w,f;this.dialogPopUp.content=c;this.dialogPopUp.dataBind();for(var l=["Label","Value","Include","Exclude"],a="((-|\\+)?[0-9]+(\\.[0-9]+)?)+",e=Object.keys(this.parent.engineModule.fieldList[u].members)[0],b=this.parent.engineModule.fieldList[u].type,v=r.getFieldByName(u,this.parent.dataSourceSettings.formatSettings),y=[{header:{text:this.parent.localeObj.getConstant("member"),iconCss:this.filterObject&&l.indexOf(this.filterObject.type)>1?ic:""},content:this.createTreeView(t,i,u)}],h=0,p=l;h<p.length;h++)o=p[h],("Label"===o&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===o&&this.parent.dataSourceSettings.allowValueFilter)&&(s="Label"===o&&e&&e.match(a)&&e.match(a)[0].length===e.length&&"number"===b?"Number":"Label"===o&&e&&"Invalid Date"!==new Date(e).toString()&&(v&&v.type||this.filterObject&&"Date"===this.filterObject.type)?"Date":o,w={header:{text:"Number"===s?this.parent.localeObj.getConstant("label"):this.parent.localeObj.getConstant(s.toLowerCase()),iconCss:this.filterObject&&this.filterObject.type===s?ic:""},content:this.createCustomFilter(u,this.filterObject&&this.filterObject.type===s?this.filterObject:void 0,s.toLowerCase())},y.push(w));f=this.filterObject?["Label","Date","Number"].indexOf(this.filterObject.type)>=0?1:"Value"===this.filterObject.type?this.parent.dataSourceSettings.allowLabelFilter&&this.parent.dataSourceSettings.allowValueFilter?2:1:0:0;f=this.parent.dataSourceSettings.allowMemberFilter||0!==f?f:1;this.tabObj=new st.Tab({heightAdjustMode:"Auto",items:y,height:"100%",selectedItem:f,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});this.tabObj.isStringTemplate=!0;this.tabObj.appendTo(c);this.parent.dataSourceSettings.allowMemberFilter||this.tabObj.hideTab(0);f>0&&n.addClass([this.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===f&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab")},t.prototype.createCustomFilter=function(t,i,r){for(var w,s,ft,l,b,h,wt,k,ot,d,y,st,ht,at=[],vt=[],u=[],c=this.parent.dataSourceSettings.values,f="DoesNotEquals",p=0,a=0,tt={label:["Equals","DoesNotEquals","BeginWith","DoesNotBeginWith","EndsWith","DoesNotEndsWith","Contains","DoesNotContains","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"],date:["Equals","DoesNotEquals","Before","BeforeOrEqualTo","After","AfterOrEqualTo","Between","NotBetween"],value:["Equals","DoesNotEquals","GreaterThan","GreaterThanOrEqualTo","LessThan","LessThanOrEqualTo","Between","NotBetween"]},it=["Between","NotBetween"],rt="label"===r?tt.label:"date"===r?tt.date:tt.value,ut=0,yt=rt;ut<yt.length;ut++)w=yt[ut],f=i&&w===i.condition?rt.indexOf(i.condition)>=0?i.condition:rt[0]:f,at.push({value:w,text:this.parent.localeObj.getConstant(w)});for(s=c.length;s--;)vt.unshift({value:c[s].name,text:c[s].caption?c[s].caption:c[s].name}),p=i&&"Value"===i.type&&i.measure===c[s].name&&i.condition===f?s:p;if("olap"===this.parent.dataType)if(ft=this.parent.engineModule,l=ft.fieldList[t].levels,this.parent.engineModule.fieldList[t].isHierarchy){for(var v=void 0,et=0,pt=this.parent.engineModule.fieldListData;et<pt.length;et++)if(b=pt[et],b&&b.pid===t){v=b;break}u.push({value:v?v.id:t,text:v?v.caption:ft.fieldList[t].name});a=0;i&&i.name===t&&i.type.toLowerCase()===r&&(u[u.length-1].iconClass=e+" "+rc)}else for(h=0,wt=l.length;h<wt;h++)for(a=i&&i.selectedField===l[h].id?h:a,u.push({value:l[h].id,text:l[h].name}),k=0,ot=this.parent.dataSourceSettings.filterSettings;k<ot.length;k++)if(d=ot[k],d.name===t&&d.selectedField===l[h].id&&d.type.toLowerCase()===r){u[u.length-1].iconClass=e+" "+rc;break}y=n.createElement("div",{className:"e-filter-div-content e-"+(["date","number"].indexOf(r)>=0?"label":r)+"-filter"+(this.parent.isDataOverflow?" "+ol:""),id:this.parent.parentID+"_"+r+"_filter_div_content",attrs:{"data-type":r,"data-fieldName":t,"data-operator":f,"data-selectedField":"olap"===this.parent.dataType&&u.length>0?u[a].value.toString():"","data-measure":this.parent.dataSourceSettings.values.length>0?this.parent.dataSourceSettings.values[p].name:"","data-value1":i&&f===i.condition&&i.value1?i.value1.toString():"","data-value2":i&&f===i.condition&&i.value2?i.value2.toString():""}});st=n.createElement("div",{className:"e-filter-text-div"});st.innerText=this.parent.localeObj.getConstant(r+"TextContent");ht=n.createElement("div",{className:uc+" "+(-1===it.indexOf(f)?o:"")});ht.innerText=this.parent.localeObj.getConstant("And");var bt=n.createElement("div",{className:"e-separator-div"}),g=n.createElement("div",{className:"e-filter-option-container-1"}),ct=n.createElement("div",{className:"e-level-option-container "+("olap"===this.parent.dataType?"":o)}),lt=n.createElement("div",{className:"e-measure-option-container "+(["label","date","number"].indexOf(r)>=0?o:"")}),kt=n.createElement("div",{className:"e-condition-option-container"}),nt=n.createElement("div",{className:"e-filter-option-container-2"}),dt=n.createElement("div",{id:this.parent.parentID+"_"+r+"_level_option_container"}),gt=n.createElement("div",{id:this.parent.parentID+"_"+r+"_measure_option_container"}),ni=n.createElement("div",{id:this.parent.parentID+"_"+r+"_contition_option_container"}),ti=n.createElement("div",{className:"e-filter-input-div-1"}),ii=n.createElement("div",{className:fc+" "+(-1===it.indexOf(f)?o:"")}),ri=n.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_1",attrs:{type:"text"}}),ui=n.createElement("input",{id:this.parent.parentID+"_"+r+"_input_option_2",attrs:{type:"text"}});return ti.appendChild(ri),ii.appendChild(ui),ct.appendChild(dt),ct.appendChild(bt.cloneNode(!0)),lt.appendChild(gt),lt.appendChild(bt),kt.appendChild(ni),g.appendChild(ct),g.appendChild(lt),g.appendChild(kt),nt.appendChild(ti),nt.appendChild(ht),nt.appendChild(ii),this.createElements(i,it,gt,ni,ri,ui,vt,at,p,f,r,dt,u,a),y.appendChild(st),y.appendChild(g),y.appendChild(nt),y},t.prototype.createElements=function(t,i,r,u,f,e,h,c,l,a,v,p,w,b){var k=this,ot,tt,d,rt,ut,g,nt,ft,et;"olap"===this.parent.dataType&&(ot=new y.DropDownList({dataSource:w,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text",iconCss:"iconClass"},index:b,cssClass:"e-level-options"+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(t){var o=k.dialogPopUp.element.querySelector(".e-selected-tab"),y=o.getAttribute("data-fieldName"),c=o.getAttribute("data-type"),i,l,v,a,r,u;if(!n.isNullOrUndefined(o)){for(k.updateInputValues(o,c,f,e),s.setStyleAndAttributes(o,{"data-selectedField":t.value}),l=0,v=k.parent.dataSourceSettings.filterSettings;l<v.length;l++)if(a=v[l],a.name===y&&a.selectedField===t.value){i=a;break}i&&("value"===c&&i.measure&&""!==i.measure&&(tt.value=i.measure?i.measure:h[0].value),d.value=i.condition?i.condition?i.condition:"DoesNotEquals":"DoesNotEquals",r=void 0,u=void 0,"value"===c?(r=f.ej2_instances[0],u=e.ej2_instances[0],r&&(r.value=i.value1?parseInt(i.value1,10):void 0),u&&(u.value=i.value2?parseInt(i.value2,10):void 0)):(r=f.ej2_instances[0],u=e.ej2_instances[0],r&&(r.value=i.value1?i.value1:""),u&&(u.value=i.value2?i.value2:"")));k.updateInputValues(o,c,f,e)}}}),ot.isStringTemplate=!0,ot.appendTo(p));tt=new y.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},index:l,cssClass:yo+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||(k.updateInputValues(i,v,f,e),s.setStyleAndAttributes(i,{"data-measure":t.value}))}});tt.isStringTemplate=!0;tt.appendTo(r);d=new y.DropDownList({dataSource:c,enableRtl:this.parent.enableRtl,fields:{value:"value",text:"text"},value:a,cssClass:ec+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(t){var r=k.dialogPopUp.element.querySelector(".e-selected-tab"),u,h,c;if(!n.isNullOrUndefined(r)){for(k.updateInputValues(r,v,f,e),u=0,h=[uc,fc];u<h.length;u++)c=h[u],i.indexOf(t.value)>=0?n.removeClass([r.querySelector("."+c)],o):n.addClass([r.querySelector("."+c)],o);s.setStyleAndAttributes(r,{"data-operator":t.value})}}});(d.isStringTemplate=!0,d.appendTo(u),"date"===v)?(rt=new cl.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:t&&a===t.condition?"string"==typeof t.value1?new Date(t.value1):t.value1:null,change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":t.value,"data-value2":ut.value})},width:"100%",cssClass:this.parent.cssClass}),ut=new cl.DateTimePicker({placeholder:this.parent.localeObj.getConstant("chooseDate"),enableRtl:this.parent.enableRtl,format:"dd/MM/yyyy hh:mm:ss a",showClearButton:!0,value:t&&a===t.condition?"string"==typeof t.value2?new Date(t.value2):t.value2:null,change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":rt.value,"data-value2":t.value})},width:"100%",cssClass:this.parent.cssClass}),rt.isStringTemplate=!0,rt.appendTo(f),ut.isStringTemplate=!0,ut.appendTo(e)):"value"===v?(g=new it.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:t&&a===t.condition?parseInt(t.value1,10):void 0,change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":t.value?t.value.toString():"0","data-value2":nt.value?nt.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass}),nt=new it.NumericTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,format:"###.##",value:t&&a===t.condition?parseInt(t.value2,10):void 0,change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":g.value?g.value.toString():"0","data-value2":t.value?t.value.toString():"0"})},width:"100%",cssClass:this.parent.cssClass}),g.isStringTemplate=!0,g.appendTo(f),nt.isStringTemplate=!0,nt.appendTo(e)):(ft=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:t&&a===t.condition?t.value1:"",change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":t.value,"data-value2":et.value})},width:"100%",cssClass:this.parent.cssClass}),et=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("enterValue"),enableRtl:this.parent.enableRtl,showClearButton:!0,value:t&&a===t.condition?t.value2:"",change:function(t){var i=k.dialogPopUp.element.querySelector(".e-selected-tab");n.isNullOrUndefined(i)||s.setStyleAndAttributes(i,{"data-value1":ft.value,"data-value2":t.value})},width:"100%",cssClass:this.parent.cssClass}),ft.isStringTemplate=!0,ft.appendTo(f),et.isStringTemplate=!0,et.appendTo(e))},t.prototype.updateInputValues=function(t,i,r,u){var o,h,f,e;"date"===i?(f=r.ej2_instances[0],e=u.ej2_instances[0],o=n.isNullOrUndefined(f.value)?"":f.value.toString(),h=n.isNullOrUndefined(e.value)?"":e.value.toString()):(f=r.ej2_instances[0],e=u.ej2_instances[0],o=f.value,h=e.value);s.setStyleAndAttributes(t,{"data-value1":o,"data-value2":h})},t.prototype.validateTreeNode=function(n){n.node.classList.contains(o)&&(n.cancel=!0)},t.prototype.updateCheckedState=function(){var i=this.dialogPopUp.element,e=[].slice.call(this.memberTreeView.element.querySelectorAll("li")),r=i.getAttribute("data-fieldname"),u=this.getUnCheckedNodes(r),f=this.getCheckedNodes(r),t=this.allMemberSelect.element.querySelector("li").querySelector("span.e-frame");e.length>0?f>0?(u>0?(n.removeClass([t],au),n.addClass([t],ao)):0===u&&(n.removeClass([t],ao),n.addClass([t],au)),this.dialogPopUp.buttons[0].buttonModel.disabled=!1,i.querySelector("."+lt).removeAttribute("disabled")):u>0&&0===f&&(n.removeClass([t],[au,ao]),this.getCheckedNodes(r)===f&&(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector("."+lt).setAttribute("disabled","disabled"))):(this.dialogPopUp.buttons[0].buttonModel.disabled=!0,i.querySelector("."+lt).setAttribute("disabled","disabled"))},t.prototype.getCheckedNodes=function(n){var u=this.parent.engineModule,f=[],t,i,r;if("olap"===this.parent.dataType&&u&&!u.fieldList[n].isHierarchy)return this.memberTreeView.getAllCheckedNodes().length;for(t=0,i=this.parent.searchTreeItems;t<i.length;t++)r=i[t],r.isSelected&&f.push(r);return f.length},t.prototype.getUnCheckedNodes=function(n){var u=[],f=[],e=this.parent.engineModule,t,i,r;if("olap"===this.parent.dataType&&e&&!e.fieldList[n].isHierarchy)return f=this.memberTreeView.getAllCheckedNodes(),this.memberTreeView.fields.dataSource.length-f.length;for(t=0,i=this.parent.searchTreeItems;t<i.length;t++)r=i[t],r.isSelected||u.push(r);return u.length},t.prototype.isExcelFilter=function(n){for(var i=!1,t=0,r=this.parent.dataSourceSettings.filters;t<r.length;t++)if(r[t].name===n){i=!0;break}return!(i||!this.parent.dataSourceSettings.allowLabelFilter&&!this.parent.dataSourceSettings.allowValueFilter)},t.prototype.getFilterObject=function(n){var t=r.getFilterItemByName(n,r.cloneFilterSettings(this.parent.dataSourceSettings.filterSettings));if(t&&(["Label","Date","Number"].indexOf(t.type)>=0&&this.parent.dataSourceSettings.allowLabelFilter||"Value"===t.type&&this.parent.dataSourceSettings.allowValueFilter||["Include","Exclude"].indexOf(t.type)>=0&&this.parent.eventBase.isValidFilterItemsAvail(n,t)))return t},t.prototype.wireEvent=function(t,i){n.EventHandler.add(t,"click",this.applySorting.bind(this,i),this)},t.prototype.unWireEvent=function(t){n.EventHandler.remove(t,"click",this.applySorting)},t.prototype.closeFilterDialog=function(){this.allowExcelLikeFilter&&this.tabObj&&!this.tabObj.isDestroyed&&this.tabObj.destroy();this.dropMenu&&!this.dropMenu.isDestroyed&&this.dropMenu.destroy();this.memberTreeView&&!this.memberTreeView.isDestroyed&&this.memberTreeView.destroy();this.allMemberSelect&&!this.allMemberSelect.isDestroyed&&this.allMemberSelect.destroy();this.editorSearch&&!this.editorSearch.isDestroyed&&this.editorSearch.destroy();document.getElementById(this.parent.parentID+"_LevelDiv-popup")&&n.remove(document.getElementById(this.parent.parentID+"_LevelDiv-popup"));this.dialogPopUp.close()},t.prototype.removeFilterDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.dialogPopUp.destroy(),setTimeout(this.setFocus.bind(this)));document.getElementById(this.parent.parentID+"_EditorTreeView")&&n.remove(document.getElementById(this.parent.parentID+"_EditorTreeView"))},t.prototype.setFocus=function(){var n,t,i;if(this.parent.control.pivotButtonModule.parentElement)for(n=0,t=[].slice.call(this.parent.control.pivotButtonModule.parentElement.querySelectorAll(".e-pivot-button"));n<t.length;n++)if(i=t[n],i.getAttribute("data-uid")===this.parent.control.pivotButtonModule.fieldName){i.focus();break}},t}(),ll=function(){function n(n){return this.currentTreeItems=[],this.savedTreeFilterPos={},this.currentTreeItemsPos={},this.searchTreeItems=[],this.isDataOverflow=!1,this.isDateField=!1,this.element=n.element,this.moduleName=n.moduleName,this.dataSourceSettings=n.dataSourceSettings,this.engineModule=n.pivotEngine,this.enableRtl=n.enableRtl,this.enableHtmlSanitizer=n.enableHtmlSanitizer,this.isAdaptive=n.isAdaptive,this.renderMode=n.renderMode,this.parentID=n.id,this.localeObj=n.localeObj,this.dataType=n.dataType,this.cssClass=n.cssClass,this.nodeStateModified=new la(this),this.dataSourceUpdate=new aa(this),this.eventBase=new ca(this),this.filterDialog=new pa(this),this.errorDialog=new va(this),this.keyboardModule=new ha(this),this}return n.prototype.destroy=function(){this.keyboardModule&&(this.keyboardModule.destroy(),this.keyboardModule=null)},n}(),wa=function(){function t(n){this.parent=n;this.parent.commonModule=this;this.addEventListener()}return t.prototype.getModuleName=function(){return"common"},t.prototype.initiateCommonModule=function(){if(this.parent.pivotCommon)this.parent.pivotCommon.element=this.parent.element,this.parent.pivotCommon.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.pivotCommon.parentID=this.parent.element.id,this.parent.pivotCommon.dataSourceSettings=this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,this.parent.pivotCommon.moduleName=this.parent.getModuleName(),this.parent.pivotCommon.enableRtl=this.parent.enableRtl,this.parent.pivotCommon.isAdaptive=n.Browser.isDevice,this.parent.pivotCommon.renderMode="Popup",this.parent.pivotCommon.localeObj=this.parent.localeObj,this.parent.pivotCommon.dataType=this.parent.dataType,this.parent.pivotCommon.cssClass=this.parent.cssClass;else{var t={pivotEngine:"olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,dataSourceSettings:this.parent.dataSourceSettings.properties?this.parent.dataSourceSettings.properties:this.parent.dataSourceSettings,id:this.parent.element.id,element:this.parent.element,moduleName:this.parent.getModuleName(),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isAdaptive:n.Browser.isDevice,renderMode:"Popup",localeObj:this.parent.localeObj,dataType:this.parent.dataType,cssClass:this.parent.cssClass};this.parent.pivotCommon=new ll(t)}this.parent.pivotCommon.control=this.parent},t.prototype.addEventListener=function(){this.handlers={load:this.initiateCommonModule};this.parent.isDestroyed||(this.parent.on(ei,this.handlers.load,this),this.parent.on(oi,this.handlers.load,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ei,this.handlers.load),this.parent.off(oi,this.handlers.load))},t.prototype.destroy=function(){this.removeEventListener();this.parent.pivotCommon&&(this.parent.pivotCommon.destroy(),this.parent.pivotCommon=null)},t}(),fi=(ce=function(n,t){return ce=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},ce(n,t)},function(n,t){function i(){this.constructor=n}ce(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},of=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property()],i.prototype,"caption",void 0),f([n.Property("Sum")],i.prototype,"type",void 0),f([n.Property()],i.prototype,"axis",void 0),f([n.Property(!1)],i.prototype,"showNoDataItems",void 0),f([n.Property()],i.prototype,"baseField",void 0),f([n.Property()],i.prototype,"baseItem",void 0),f([n.Property(!0)],i.prototype,"showSubTotals",void 0),f([n.Property(!1)],i.prototype,"isNamedSet",void 0),f([n.Property(!1)],i.prototype,"isCalculatedField",void 0),f([n.Property(!0)],i.prototype,"showFilterIcon",void 0),f([n.Property(!0)],i.prototype,"showSortIcon",void 0),f([n.Property(!0)],i.prototype,"showRemoveIcon",void 0),f([n.Property(!0)],i.prototype,"showValueTypeIcon",void 0),f([n.Property(!0)],i.prototype,"showEditIcon",void 0),f([n.Property(!0)],i.prototype,"allowDragAndDrop",void 0),f([n.Property()],i.prototype,"dataType",void 0),f([n.Property(!1)],i.prototype,"expandAll",void 0),f([n.Property()],i.prototype,"groupName",void 0),i}(n.ChildProperty),ba=(n.ChildProperty,function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property("Include")],i.prototype,"type",void 0),f([n.Property()],i.prototype,"items",void 0),f([n.Property("DoesNotEquals")],i.prototype,"condition",void 0),f([n.Property()],i.prototype,"value1",void 0),f([n.Property()],i.prototype,"value2",void 0),f([n.Property()],i.prototype,"measure",void 0),f([n.Property(1)],i.prototype,"levelCount",void 0),f([n.Property()],i.prototype,"selectedField",void 0),i}(n.ChildProperty)),ka=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"measure",void 0),f([n.Property()],i.prototype,"label",void 0),f([n.Property()],i.prototype,"conditions",void 0),f([n.Property()],i.prototype,"value1",void 0),f([n.Property()],i.prototype,"value2",void 0),f([n.Property()],i.prototype,"style",void 0),f([n.Property(!0)],i.prototype,"applyGrandTotals",void 0),i}(n.ChildProperty),da=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property("Ascending")],i.prototype,"order",void 0),f([n.Property([])],i.prototype,"membersOrder",void 0),i}(n.ChildProperty),ga=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property()],i.prototype,"minimumFractionDigits",void 0),f([n.Property()],i.prototype,"maximumFractionDigits",void 0),f([n.Property()],i.prototype,"minimumSignificantDigits",void 0),f([n.Property()],i.prototype,"maximumSignificantDigits",void 0),f([n.Property(!0)],i.prototype,"useGrouping",void 0),f([n.Property()],i.prototype,"skeleton",void 0),f([n.Property()],i.prototype,"type",void 0),f([n.Property()],i.prototype,"currency",void 0),f([n.Property()],i.prototype,"minimumIntegerDigits",void 0),f([n.Property()],i.prototype,"format",void 0),i}(n.ChildProperty),nv=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property()],i.prototype,"groupInterval",void 0),f([n.Property()],i.prototype,"startingAt",void 0),f([n.Property()],i.prototype,"endingAt",void 0),f([n.Property("Date")],i.prototype,"type",void 0),f([n.Property()],i.prototype,"rangeInterval",void 0),f([n.Property()],i.prototype,"caption",void 0),f([n.Property()],i.prototype,"customGroups",void 0),i}(n.ChildProperty),tv=(n.ChildProperty,function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property()],i.prototype,"formula",void 0),f([n.Property()],i.prototype,"hierarchyUniqueName",void 0),f([n.Property()],i.prototype,"formatString",void 0),i}(n.ChildProperty)),iv=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"name",void 0),f([n.Property()],i.prototype,"items",void 0),f([n.Property()],i.prototype,"delimiter",void 0),i}(n.ChildProperty),rv=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"headerText",void 0),f([n.Property("None")],i.prototype,"sortOrder",void 0),f([n.Property()],i.prototype,"rowHeader",void 0),f([n.Property("None")],i.prototype,"rowOrder",void 0),f([n.Property()],i.prototype,"columnHeader",void 0),f([n.Property("None")],i.prototype,"columnOrder",void 0),f([n.Property(".")],i.prototype,"headerDelimiter",void 0),f([n.Property()],i.prototype,"measure",void 0),i}(n.ChildProperty),uv=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property()],i.prototype,"userName",void 0),f([n.Property()],i.prototype,"password",void 0),i}(n.ChildProperty),al=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fi(i,t),f([n.Property("Local")],i.prototype,"mode",void 0),f([n.Property()],i.prototype,"catalog",void 0),f([n.Property()],i.prototype,"cube",void 0),f([n.Property()],i.prototype,"roles",void 0),f([n.Property("Relational")],i.prototype,"providerType",void 0),f([n.Property()],i.prototype,"url",void 0),f([n.Property(1033)],i.prototype,"localeIdentifier",void 0),f([n.Property()],i.prototype,"dataSource",void 0),f([n.Collection([],of)],i.prototype,"rows",void 0),f([n.Collection([],of)],i.prototype,"columns",void 0),f([n.Collection([],of)],i.prototype,"values",void 0),f([n.Collection([],of)],i.prototype,"filters",void 0),f([n.Collection([],of)],i.prototype,"fieldMapping",void 0),f([n.Property([])],i.prototype,"excludeFields",void 0),f([n.Property(!1)],i.prototype,"expandAll",void 0),f([n.Property("column")],i.prototype,"valueAxis",void 0),f([n.Property(-1)],i.prototype,"valueIndex",void 0),f([n.Collection([],ba)],i.prototype,"filterSettings",void 0),f([n.Collection([],da)],i.prototype,"sortSettings",void 0),f([n.Property(!0)],i.prototype,"enableSorting",void 0),f([n.Property("JSON")],i.prototype,"type",void 0),f([n.Property(!0)],i.prototype,"allowMemberFilter",void 0),f([n.Property(!1)],i.prototype,"allowLabelFilter",void 0),f([n.Property(!1)],i.prototype,"allowValueFilter",void 0),f([n.Property(!0)],i.prototype,"showSubTotals",void 0),f([n.Property(!0)],i.prototype,"showRowSubTotals",void 0),f([n.Property(!0)],i.prototype,"showColumnSubTotals",void 0),f([n.Property("Auto")],i.prototype,"subTotalsPosition",void 0),f([n.Property(!0)],i.prototype,"showGrandTotals",void 0),f([n.Property("Bottom")],i.prototype,"grandTotalsPosition",void 0),f([n.Property(!0)],i.prototype,"showRowGrandTotals",void 0),f([n.Property(!0)],i.prototype,"showColumnGrandTotals",void 0),f([n.Property(!1)],i.prototype,"alwaysShowValueHeader",void 0),f([n.Property(!0)],i.prototype,"showHeaderWhenEmpty",void 0),f([n.Property(!0)],i.prototype,"showAggregationOnValueField",void 0),f([n.Collection([],ga)],i.prototype,"formatSettings",void 0),f([n.Collection([],iv)],i.prototype,"drilledMembers",void 0),f([n.Complex({},rv)],i.prototype,"valueSortSettings",void 0),f([n.Collection([],tv)],i.prototype,"calculatedFieldSettings",void 0),f([n.Collection([],ka)],i.prototype,"conditionalFormatSettings",void 0),f([n.Property()],i.prototype,"emptyCellsTextContent",void 0),f([n.Collection([],nv)],i.prototype,"groupSettings",void 0),f([n.Complex({},uv)],i.prototype,"authentication",void 0),i}(n.ChildProperty),fv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),c=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ev=(n.ChildProperty,function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return fv(i,t),c([n.Property("auto")],i.prototype,"height",void 0),c([n.Property("auto")],i.prototype,"width",void 0),c([n.Property("Both")],i.prototype,"gridLines",void 0),c([n.Property(!1)],i.prototype,"allowTextWrap",void 0),c([n.Property(!1)],i.prototype,"allowReordering",void 0),c([n.Property(!0)],i.prototype,"allowResizing",void 0),c([n.Property(!0)],i.prototype,"allowAutoResizing",void 0),c([n.Property(null)],i.prototype,"rowHeight",void 0),c([n.Property(110)],i.prototype,"columnWidth",void 0),c([n.Property("Ellipsis")],i.prototype,"clipMode",void 0),c([n.Property(!1)],i.prototype,"allowSelection",void 0),c([n.Property(-1)],i.prototype,"selectedRowIndex",void 0),c([n.Property({mode:"Row",cellSelectionMode:"Flow",type:"Single"})],i.prototype,"selectionSettings",void 0),c([n.Property({wrapMode:"Both"})],i.prototype,"textWrapSettings",void 0),c([n.Property("AllPages")],i.prototype,"printMode",void 0),c([n.Property()],i.prototype,"contextMenuItems",void 0),c([n.Event()],i.prototype,"beforeCopy",void 0),c([n.Event()],i.prototype,"printComplete",void 0),c([n.Event()],i.prototype,"beforePrint",void 0),c([n.Event()],i.prototype,"beforePdfExport",void 0),c([n.Event()],i.prototype,"beforeExcelExport",void 0),c([n.Event()],i.prototype,"contextMenuOpen",void 0),c([n.Event()],i.prototype,"contextMenuClick",void 0),c([n.Event()],i.prototype,"queryCellInfo",void 0),c([n.Event()],i.prototype,"headerCellInfo",void 0),c([n.Event()],i.prototype,"rowSelecting",void 0),c([n.Event()],i.prototype,"rowSelected",void 0),c([n.Event()],i.prototype,"rowDeselecting",void 0),c([n.Event()],i.prototype,"rowDeselected",void 0),c([n.Event()],i.prototype,"cellSelecting",void 0),c([n.Event()],i.prototype,"cellSelected",void 0),c([n.Event()],i.prototype,"cellDeselecting",void 0),c([n.Event()],i.prototype,"cellDeselected",void 0),c([n.Event()],i.prototype,"resizeStart",void 0),c([n.Event()],i.prototype,"resizing",void 0),c([n.Event()],i.prototype,"resizeStop",void 0),c([n.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),c([n.Event()],i.prototype,"pdfQueryCellInfo",void 0),c([n.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),c([n.Event()],i.prototype,"excelQueryCellInfo",void 0),c([n.Event()],i.prototype,"columnDragStart",void 0),c([n.Event()],i.prototype,"columnDrag",void 0),c([n.Event()],i.prototype,"columnDrop",void 0),c([n.Event()],i.prototype,"columnRender",void 0),i}(n.ChildProperty)),ov=function(){function t(t){this.keyConfigs={tab:"tab",shiftTab:"shift+tab",enter:"enter",shiftUp:"shift+upArrow",shiftDown:"shift+downArrow",shiftLeft:"shift+leftArrow",shiftRight:"shift+rightArrow",shiftEnter:"shift+enter",ctrlEnter:"ctrl+enter",upArrow:"upArrow",downArrow:"downArrow",leftArrow:"leftArrow",rightArrow:"rightArrow",escape:"escape",ctrlShiftF:"ctrl+shift+f"};this.parent=t;this.event=void 0;this.parent.element.tabIndex=-1===this.parent.element.tabIndex?0:this.parent.element.tabIndex;this.pivotViewKeyboardModule=new n.KeyboardEvents(this.parent.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})}return t.prototype.keyActionHandler=function(n){switch(n.action){case"tab":this.processTab(n);break;case"shiftTab":this.processShiftTab(n);break;case"enter":case"shiftEnter":case"ctrlEnter":this.processEnter(n);break;case"shiftUp":case"shiftDown":case"shiftLeft":case"shiftRight":case"upArrow":case"downArrow":case"leftArrow":case"rightArrow":this.processSelection(n);break;case"escape":this.clearSelection();break;case"ctrlShiftF":this.toggleFieldList(n)}},t.prototype.getNextButton=function(t){var r=this.allpivotButtons(t),u,i;if(n.removeClass(r,"e-btn-focused"),this.parent.grid.element.querySelector("."+v))for(u=r.length,i=0;i<u;i++)if(r[i].getAttribute("data-uid")===t.getAttribute("data-uid"))return r[i+1]?r[i+1]:t;return t},t.prototype.getPrevButton=function(t){var r=this.allpivotButtons(t),u,i;if(n.removeClass(r,"e-btn-focused"),this.parent.grid.element.querySelector("."+v))for(u=r.length,i=0;i<u;i++)if(r[i].getAttribute("data-uid")===t.getAttribute("data-uid"))return r[i-1]?r[i-1]:t;return t},t.prototype.allpivotButtons=function(t){var i=[],h,c;if(t&&this.parent.showGroupingBar){var r=n.closest(t,"."+er),u=n.closest(t,"."+ef),f=n.closest(t,"."+uf),l=t.classList.contains(ci),e=void 0,o=void 0,s=void 0;(null!==r?o=r.classList.contains(er):null!==u?s=u.classList.contains(ef):null!==f&&(e=f.classList.contains(uf)),o||s||l)?(h=[].slice.call(this.parent.element.querySelector("."+er).querySelectorAll("."+v)),c=[].slice.call(this.parent.element.querySelector("."+ef).querySelectorAll("."+v)),i=h.concat(c)):e&&(i=[].slice.call(this.parent.element.querySelector("."+uf).querySelectorAll("."+v)))}return i},t.prototype.processTab=function(t){var i=t.target,r,u,f,o,e;if(i&&(n.closest(i,"."+v)||i.classList.contains("e-group-row"))){if(this.parent.grid){if(r=this.parent.grid.serviceLocator.getService("focus"),i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row"))return r.focus(),u=r.getFocusedElement(),n.addClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0"),void t.preventDefault();return f=this.getNextButton(i),f.getAttribute("data-uid")!==i.getAttribute("data-uid")?(this.parent.element.querySelector(".e-focused")?(this.parent.element.querySelector(".e-focused").setAttribute("tabindex","-1"),n.removeClass(this.parent.element.querySelectorAll(".e-focus"),"e-focus"),n.removeClass(this.parent.element.querySelectorAll(".e-focused"),"e-focused"),r.setFocusedElement(this.parent.element.querySelector(".e-headercell")),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","0")):r.currentInfo.skipAction=!0,n.addClass([f],"e-btn-focused"),f.focus()):(r.focus(),u=r.getFocusedElement(),n.addClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0")),void t.preventDefault()}}else if(!this.parent.showGroupingBar&&this.parent.showFieldList&&i&&n.closest(i,"."+rt)){if(this.parent.grid)return(r=this.parent.grid.serviceLocator.getService("focus")).focus(),u=r.getFocusedElement(),n.addClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0"),void t.preventDefault()}else if(this.parent.showGroupingBar||this.parent.showFieldList||!i||!n.closest(i,"."+kc)||n.closest(i,".e-popup.e-popup-open"))i&&n.closest(i,"."+uu)&&this.parent.toolbar&&this.parent.toolbarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){n.removeClass(n.closest(i,"."+uu).querySelectorAll(".e-menu-item.e-focused"),"e-focused");document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&n.addClass([document.activeElement],"e-focused")})):i.classList.contains("e-numerictextbox")&&((r=this.parent.grid.serviceLocator.getService("focus")).focus(),u=r.getFocusedElement(),n.removeClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0"),t.preventDefault());else if(this.parent.grid){if(o=n.closest(i,"."+kc),e=(r=this.parent.grid.serviceLocator.getService("focus"),[].slice.call(o.getElementsByTagName("tr"))),i.innerHTML!==e[e.length-1].lastChild.innerHTML)return r.focus(),u=r.getFocusedElement(),n.addClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0"),void t.preventDefault();r.currentInfo.skipAction=!0}},t.prototype.processShiftTab=function(t){var i=t.target,u,r,o,e,f;if(i&&(n.closest(i,"."+v)||i.classList.contains("e-group-row"))){if(this.parent.grid){if(u=this.parent.grid.serviceLocator.getService("focus"),i.classList.contains("e-group-row")&&i.querySelector(".e-btn-focused"))i=i.querySelector(".e-btn-focused");else if(i.classList.contains("e-group-row")&&(i=this.parent.element.querySelector(".e-btn-focused")?this.parent.element.querySelector(".e-btn-focused"):this.parent.element.querySelector("."+er),r=this.allpivotButtons(i),r.length>0&&r[r.length-1]))return u.currentInfo.skipAction=!0,r[r.length-1].focus(),n.removeClass(r,"e-btn-focused"),n.addClass([r[r.length-1]],"e-btn-focused"),void t.preventDefault();if(o=this.getPrevButton(i),o.getAttribute("data-uid")!==i.getAttribute("data-uid"))return u.currentInfo.skipAction=!0,o.focus(),void t.preventDefault()}}else if(i&&this.parent.grid&&(i.classList.contains("e-movablefirst")||i.classList.contains("e-rowsheader")&&n.closest(i,"tr").getAttribute("data-uid")===this.parent.grid.element.querySelector(".e-frozencontent tr").getAttribute("data-uid"))){if((u=this.parent.grid.serviceLocator.getService("focus"),i.classList.contains("e-movablefirst"))&&(i=this.parent.element.querySelector("."+ri+" .e-btn-focused")?this.parent.element.querySelector("."+ri+" .e-btn-focused"):this.parent.element.querySelector("."+ri),e=u.getFocusedElement(),n.removeClass([e],["e-focused","e-focus"])),f=this.allpivotButtons(i),f.length>0)return u.currentInfo.skipAction=!0,setTimeout(function(){f[f.length-1].focus()}),n.removeClass(f,"e-btn-focused"),n.addClass([f[f.length-1]],"e-btn-focused"),void t.preventDefault()}else i&&n.closest(i,"."+uu)&&this.parent.toolbar&&this.parent.toolbarModule?(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(function(){n.removeClass(n.closest(i,"."+uu).querySelectorAll(".e-menu-item.e-focused"),"e-focused");document.activeElement&&document.activeElement.classList.contains("e-menu-item")&&n.addClass([document.activeElement],"e-focused")})):i.classList.contains("e-numerictextbox")&&((u=this.parent.grid.serviceLocator.getService("focus")).focus(),e=u.getFocusedElement(),n.removeClass([e],["e-focused","e-focus"]),e.setAttribute("tabindex","0"),t.preventDefault())},t.prototype.processEnter=function(t){var i=t.target,u,r;i&&n.closest(i,"."+yr)&&(u=this.parent.grid.serviceLocator.getService("focus"),13!==t.keyCode||t.shiftKey||t.ctrlKey?13===t.keyCode&&t.shiftKey&&!t.ctrlKey?this.parent.enableValueSorting&&(this.event=t,i.click(),u.focus(),r=u.getFocusedElement(),n.addClass([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")):13===t.keyCode&&!t.shiftKey&&t.ctrlKey&&this.parent.hyperlinkSettings&&i.querySelector("a")&&i.querySelector("a").click():i.querySelector("."+e)?(this.event=t,i.querySelector("."+e).click(),u.focus(),r=u.getFocusedElement(),n.addClass([r],["e-focused","e-focus"]),r.setAttribute("tabindex","0")):i.classList.contains("e-valuescontent")?(i.dispatchEvent(new MouseEvent("dblclick",{view:window,bubbles:!0,cancelable:!0})),i.querySelector(".e-numerictextbox")&&i.click()):i.classList.contains("e-numerictextbox")&&(u.focus(),r=u.getFocusedElement(),n.removeClass([r],["e-focused","e-focus"])),t.preventDefault())},t.prototype.clearSelection=function(){var t=this.parent;n.removeClass(t.element.querySelectorAll("."+tt+",."+d),[d,tt,g]);this.parent.renderModule.selected()},t.prototype.processSelection=function(t){var u=t.target,o,s;if(this.parent.grid&&this.parent.gridSettings.allowSelection&&"Row"!==this.parent.gridSettings.selectionSettings.mode&&!u.classList.contains("e-numerictextbox")){var i,f=this.parent,e=Number(t.target.getAttribute("data-colindex")),r=Number(t.target.getAttribute("index"));("TH"!==u.nodeName&&"TD"!==u.nodeName||(i="shiftUp"===t.action||"upArrow"===t.action?0===r||0===e||"TH"!==u.nodeName&&f.renderModule.rowStartPos!==r?null:this.getParentElement(f,i,e,r-1):"shiftDown"===t.action||"downArrow"===t.action?f.element.querySelector('th[data-colindex="'+e+'"][index="'+(r+1)+'"]'):"shiftLeft"===t.action||"leftArrow"===t.action?t.target.previousSibling:t.target.nextSibling),n.isNullOrUndefined(i))?("upArrow"===t.action?(i=f.element.querySelector('[data-colindex="'+e+'"][index="'+(r-1)+'"]'),r--):"downArrow"===t.action&&(i=f.element.querySelector('[data-colindex="'+e+'"][index="'+(r+1)+'"]'),r++),n.isNullOrUndefined(i)||f.clearSelection(i,t,e,r)):"Both"===f.gridSettings.selectionSettings.mode&&i.classList.contains(he)?f.clearSelection(i,t,e,r):(e=Number(i.getAttribute("data-colindex")),r=Number(i.getAttribute("index")),o=Number(i.getAttribute("aria-colspan")),f.clearSelection(i,t,e,r),s={cancel:!1,isCellClick:!0,currentCell:i,data:f.pivotValues[r][e]},f.trigger(cf,s,function(n){n.cancel||f.applyColumnSelection(t,i,e,e+(o>0?o-1:0),r)}))}else if(u&&(37===t.keyCode||38===t.keyCode)&&this.parent&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&!u.classList.contains("e-numerictextbox")){if(this.parent.grid&&this.parent.element.querySelector(".e-frozenheader")&&this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus").length>0)return n.removeClass(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focus"),"e-focus"),n.removeClass(this.parent.element.querySelector(".e-frozenheader").querySelectorAll(".e-focused"),"e-focused"),this.parent.element.querySelector(".e-headercell").setAttribute("tabindex","-1"),this.parent.grid.serviceLocator.getService("focus").setFocusedElement(u),n.addClass([u],["e-focused","e-focus"]),u.setAttribute("tabindex","0"),u.focus(),void t.preventDefault()}else u.classList.contains("e-numerictextbox")&&("rightArrow"===t.action||"leftArrow"===t.action)&&u.click()},t.prototype.getParentElement=function(n,t,i,r){for(;!t;)t=n.element.querySelector('[data-colindex="'+i+'"][index="'+r+'"]'),i--;return t},t.prototype.toggleFieldList=function(n){if(this.parent&&!this.parent.isDestroyed&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed&&this.parent.element.querySelector("."+rt)){if(!this.parent.element.querySelector("."+rt).classList.contains(sr))return this.parent.element.querySelector("."+rt).click(),void n.preventDefault();this.parent.element.querySelector("."+rt).classList.contains(sr)&&this.parent.pivotFieldListModule.dialogRenderer&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog&&!this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.isDestroyed&&this.parent.pivotFieldListModule.dialogRenderer.fieldListDialog.hide()}},t.prototype.destroy=function(){this.pivotViewKeyboardModule&&this.pivotViewKeyboardModule.destroy()},t}(),sv=function(){function t(n){this.parent=n;this.parent.contextMenuModule=this}return t.prototype.render=function(){this.renderContextMenu()},t.prototype.renderContextMenu=function(){var i=[{text:this.parent.localeObj.getConstant("addToFilter"),id:this.parent.element.id+"_Filters"},{text:this.parent.localeObj.getConstant("addToRow"),id:this.parent.element.id+"_Rows"},{text:this.parent.localeObj.getConstant("addToColumn"),id:this.parent.element.id+"_Columns"},{text:this.parent.localeObj.getConstant("addToValue"),id:this.parent.element.id+"_Values"}],r={cssClass:"e-pivot-context-menu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:i,enableRtl:this.parent.enableRtl,locale:this.parent.locale,beforeOpen:this.onBeforeMenuOpen.bind(this),select:this.onSelectContextMenu.bind(this)},t=n.createElement("ul",{id:this.parent.element.id+"_PivotContextMenu"});this.parent.element.appendChild(t);this.menuObj=new st.ContextMenu(r);this.menuObj.isStringTemplate=!0;this.menuObj.appendTo(t)},t.prototype.onBeforeMenuOpen=function(t){var r=[].slice.call(t.element.querySelectorAll("li")),o="olap"===this.parent.dataType?this.fieldElement.getAttribute("data-type"):this.fieldElement.querySelector("."+df).getAttribute("data-type"),u,s,f,h,e,c,i;if(n.removeClass(r,l),"CalculatedField"===o||"isMeasureFieldsAvail"===o)for(u=0,s=r;u<s.length;u++)(i=s[u]).textContent!==this.parent.localeObj.getConstant("addToValue")&&n.addClass([i],l);else if("isMeasureAvail"===o)for(f=0,h=r;f<h.length;f++)(i=h[f]).textContent!==this.parent.localeObj.getConstant("addToRow")&&i.textContent!==this.parent.localeObj.getConstant("addToColumn")&&n.addClass([i],l);else if("olap"===this.parent.dataType)for(e=0,c=r;e<c.length;e++)if((i=c[e]).textContent===this.parent.localeObj.getConstant("addToValue")){n.addClass([i],l);break}},t.prototype.onSelectContextMenu=function(n){if(null!==n.element.textContent){var t=this.fieldElement.getAttribute("data-uid"),i=n.item.id.replace(this.parent.element.id+"_","").toLowerCase();this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;this.parent.pivotCommon.dataSourceUpdate.btnElement=this.fieldElement;this.parent.pivotCommon.dataSourceUpdate.updateDataSource(t,i,-1);this.parent.updateDataSource(!0);this.fieldElement=void 0}},t.prototype.destroy=function(){this.parent.isDestroyed&&this.menuObj&&!this.menuObj.isDestroyed&&(this.menuObj.destroy(),n.select("#"+this.parent.element.id+"_PivotContextMenu",document)&&n.remove(n.select("#"+this.parent.element.id+"_PivotContextMenu",document)))},t}(),vl=function(){function t(t){this.previousValues={top:0,left:0};this.frozenPreviousValues={top:0,left:0};this.eventType="";this.isFireFox=n.Browser.userAgent.toLowerCase().indexOf("firefox")>-1;this.parent=t;this.addInternalEvents()}return t.prototype.getModuleName=function(){return"virtualscroll"},t.prototype.addInternalEvents=function(){this.parent.on(vi,this.wireEvents,this)},t.prototype.wireEvents=function(){var f;if(this.engineModule="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,"Chart"!==this.parent.displayOption.view&&!this.parent.isVirtualScrollEventsAdded){var t=this.parent.element.querySelector("."+at),r=this.parent.element.querySelector("."+gu),i=this.parent.element.querySelector("."+li),u=t.parentElement.parentElement.querySelector("."+pt);(0===this.parent.mScrollBarEvents.length&&(this.parent.mScrollBarEvents=u.__eventList.events.slice()),n.EventHandler.clearEvents(t),n.EventHandler.clearEvents(r),this.isFireFox&&n.EventHandler.clearEvents(i),this.engineModule)&&(f=this.parent.isAdaptive?t:t.parentElement.parentElement.querySelector("."+pt),n.EventHandler.add(f,"scroll touchmove pointermove",this.onHorizondalScroll(i,t,r),this),n.EventHandler.add(t.parentElement,"scroll wheel touchmove pointermove keyup keydown",this.onVerticalScroll(r,t),this),this.isFireFox?n.EventHandler.add(t,"mouseup touchend scroll",this.common(i,t,r),this):n.EventHandler.add(t.parentElement.parentElement,"mouseup touchend",this.common(i,t,r),this),n.EventHandler.add(u,"scroll",this.onCustomScrollbarScroll(t,i),this),n.EventHandler.add(t,"scroll",this.onCustomScrollbarScroll(u,i),this),n.EventHandler.add(i,"scroll",this.onCustomScrollbarScroll(u,t),this),n.EventHandler.add(i,"touchstart pointerdown",this.setPageXY(),this),n.EventHandler.add(i,"touchmove pointermove",this.onTouchScroll(i,t,r),this),n.EventHandler.add(t,"touchstart pointerdown",this.setPageXY(),this),n.EventHandler.add(t,"touchmove pointermove",this.onTouchScroll(i,t,r),this));this.parent.grid.on("check-scroll-reset",function(n){n.cancel=!0});this.parent.grid.on("prevent-frozen-scroll-refresh",function(n){n.cancel=!0});this.parent.grid.isPreventScrollEvent=!0;this.parent.isVirtualScrollEventsAdded=!0}},t.prototype.onWheelScroll=function(n){var t=this,i=n;return function(n){var r=i.parentElement.scrollTop+(1===n.deltaMode?30*n.deltaY:n.deltaY);t.frozenPreviousValues.top!==r&&(n.preventDefault(),t.frozenPreviousValues.top=r,t.eventType=n.type)}},t.prototype.getPointXY=function(n){var t={x:0,y:0};return n.touches&&n.touches.length?(t.x=n.touches[0].pageX,t.y=n.touches[0].pageY):(t.x=n.pageX,t.y=n.pageY),t},t.prototype.onCustomScrollbarScroll=function(n,t){var i=this,r=n,u=t;return function(n){if(null!==i.parent.element.querySelector("."+at).parentElement.querySelector("tbody")){var f=n.target,t=f.scrollLeft;i.previousValues.left===t||i.isFireFox&&f.classList.contains(li)||(r.scrollLeft=t,u.scrollLeft=t,i.previousValues.left=t,i.parent.isDestroyed)}}},t.prototype.onTouchScroll=function(n,t){var i=this,r=t;return function(u){if("mouse"!==u.pointerType){var e=i.getPointXY(u),o=r.parentElement.scrollTop+(i.pageXY.y-e.y),s=i.parent.isAdaptive?t:r.parentElement.parentElement.querySelector("."+pt),f=s.scrollLeft+(i.pageXY.x-e.x);i.frozenPreviousValues.left===f||f<0||(n.scrollLeft=f,s.scrollLeft=f,i.pageXY.x=e.x,i.frozenPreviousValues.left=f,i.frozenPreviousValues.top===o||o<0||(i.pageXY.y=e.y,i.frozenPreviousValues.top=o,i.eventType=u.type))}}},t.prototype.update=function(n,t,i,u){var f=this,o,y,c,l,a,e,v;if(this.parent.isScrolling=!0,o="pivot"===this.parent.dataType?this.parent.engineModule:this.parent.olapEngineModule,y={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)},this.parent.pageSettings&&o.pageSettings){if("vertical"===this.direction){var p="pivot"===this.parent.dataType&&"row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,h=this.parent.pageSettings.rowPageSize*p*this.parent.gridSettings.rowHeight,s=Math.ceil(i/h);if(this.parent.scrollPosObject.vertical===s||o.pageSettings.rowPageSize>=o.rowCount)return;this.parent.actionObj.actionName=th;this.parent.actionBeginMethod();this.parent.showWaitingPopup();this.parent.scrollPosObject.vertical=s;this.parent.pageSettings.currentRowPage=o.pageSettings.currentRowPage=s>1?s:1;c=0;this.parent.trigger(ni,y,function(){"pivot"===f.parent.dataType?"Server"===f.parent.dataSourceSettings.mode?f.parent.getEngine("onScroll",null,null,null,null,null,null):(f.parent.engineModule.generateGridData(f.parent.dataSourceSettings,!0,f.parent.engineModule.headerCollection),c=f.parent.engineModule.rowStartPos):(f.parent.olapEngineModule.scrollPage(),c=f.parent.olapEngineModule.pageRowStartPos);f.enginePopulatedEventMethod(o)});l=h*Math.ceil(c/(this.parent.pageSettings.rowPageSize*p))-o.rowFirstLvl*p*this.parent.gridSettings.rowHeight;this.parent.scrollPosObject.verticalSection=l}else{if(a="pivot"===this.parent.dataType&&"column"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.values.length:1,h=this.parent.pageSettings.columnPageSize*a*this.parent.gridSettings.columnWidth,s=Math.ceil(u/h),this.parent.scrollPosObject.horizontal===s)return;this.parent.actionObj.actionName=ih;this.parent.actionBeginMethod();this.parent.showWaitingPopup();e=this.parent;e.scrollPosObject.horizontal=s;this.parent.pageSettings.currentColumnPage=o.pageSettings.currentColumnPage=s>1?s:1;v=0;this.parent.trigger(ni,y,function(){"pivot"===e.dataType?"Server"===f.parent.dataSourceSettings.mode?f.parent.getEngine("onScroll",null,null,null,null,null,null):(e.engineModule.generateGridData(e.dataSourceSettings,!0,e.engineModule.headerCollection),v=e.engineModule.colStartPos):(e.olapEngineModule.scrollPage(),v=e.olapEngineModule.pageColStartPos);f.enginePopulatedEventMethod(o)});l=h*Math.ceil(v/(e.pageSettings.columnPageSize*a))-o.colFirstLvl*a*e.gridSettings.columnWidth;e.scrollPosObject.horizontalSection=l}this.parent.actionObj.actionName=this.parent.getActionCompleteName();this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},t.prototype.enginePopulatedEventMethod=function(n,t){var r=this,i=t||this.parent,u={dataSourceSettings:i.dataSourceSettings,pivotValues:n.pivotValues};i.trigger(ti,u,function(n){r.parent.pivotValues=n.pivotValues})},t.prototype.setPageXY=function(){var n=this;return function(t){"mouse"!==t.pointerType&&(n.pageXY=n.getPointXY(t))}},t.prototype.common=function(n,t){var i=this;return function(r){var u=i.parent.isAdaptive?t:t.parentElement.parentElement.querySelector("."+pt);i.update(n,t,t.parentElement.scrollTop*i.parent.verticalScrollScale,u.scrollLeft*i.parent.horizontalScrollScale,r)}},t.prototype.onHorizondalScroll=function(t,i){var u,r=this;return function(f){var s=r.parent.isAdaptive?i:i.parentElement.parentElement.querySelector("."+pt),e=s.scrollLeft*r.parent.horizontalScrollScale,o,l,h,p,c,a,v,y,w;("wheel"!==f.type&&"touchmove"!==f.type&&"wheel"!==r.eventType&&"touchmove"!==r.eventType||(clearTimeout(u),u=setTimeout(function(){e="touchmove"===f.type?s.scrollLeft:e;r.update(t,i,i.parentElement.scrollTop*r.parent.verticalScrollScale,e,f)},300)),r.previousValues.left!==e)&&(r.parent.scrollDirection=r.direction="horizondal",o=-(e-r.parent.scrollPosObject.horizontalSection-s.scrollLeft),l=i.querySelector("."+hi).style.transform.split(",").length>1?i.querySelector("."+hi).style.transform.split(",")[1].trim():"0px)",s.scrollLeft<r.parent.scrollerBrowserLimit&&(n.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+o+"px,"+l}),n.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate("+o+"px,0px)"})),h=r.parent.scrollPosObject.horizontalSection>e?-(r.parent.scrollPosObject.horizontalSection-e):e+t.offsetWidth-(r.parent.scrollPosObject.horizontalSection+i.querySelector(".e-table").offsetWidth),p=Math.ceil(r.parent.scrollPosObject.horizontalSection/r.parent.horizontalScrollScale)<r.parent.scrollerBrowserLimit,(r.parent.scrollPosObject.horizontalSection>e||h>1&&p)&&(e>t.clientWidth?(r.parent.scrollPosObject.left<1&&(r.parent.scrollPosObject.left=t.clientWidth),r.parent.scrollPosObject.left=r.parent.scrollPosObject.left-50,h=r.parent.scrollPosObject.horizontalSection>e?h-r.parent.scrollPosObject.left:h+r.parent.scrollPosObject.left):h=-r.parent.scrollPosObject.horizontalSection,o=-(e-(r.parent.scrollPosObject.horizontalSection+h)-i.parentElement.parentElement.querySelector("."+pt).scrollLeft),c=r.parent.gridSettings.columnWidth*r.engineModule.columnCount,c>r.parent.scrollerBrowserLimit&&(r.parent.horizontalScrollScale=c/r.parent.scrollerBrowserLimit,c=r.parent.scrollerBrowserLimit),o>c&&o>e&&(o=e,h=0),n.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+o+"px,"+l}),n.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate("+o+"px,0px)"}),r.parent.scrollPosObject.horizontalSection=r.parent.scrollPosObject.horizontalSection+h),a=s.scrollWidth-(s.scrollLeft+s.offsetWidth),a<=0&&(v=i.querySelector("."+ui),v.style.display="none",y=i.scrollWidth-(i.scrollLeft+i.offsetWidth),v.style.display="",w=i.scrollWidth-(i.scrollLeft+i.offsetWidth),r.parent.scrollPosObject.horizontalSection-=y>a?y:-w,o=s.scrollLeft>r.parent.scrollerBrowserLimit?Number(i.querySelector("."+hi).style.transform.split(",")[0].split("px")[0].trim()):-(s.scrollLeft*r.parent.horizontalScrollScale-r.parent.scrollPosObject.horizontalSection-s.scrollLeft),n.setStyleAttribute(i.querySelector(".e-table"),{transform:"translate("+o+"px,"+l}),n.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate("+o+"px,0px)"})),r.previousValues.left=e,r.frozenPreviousValues.left=e,r.eventType="",t.scrollLeft=s.scrollLeft)}},t.prototype.onVerticalScroll=function(t,i){var u,r=this;return function(f){var e=i.parentElement.scrollTop*r.parent.verticalScrollScale,l,o,c,s,a,v,h;("wheel"===f.type||"touchmove"===f.type||"wheel"===r.eventType||"touchmove"===r.eventType||"keyup"===f.type||"keydown"===f.type)&&(l=r.parent.isAdaptive?i:i.parentElement.parentElement.querySelector("."+pt),clearTimeout(u),u=setTimeout(function(){r.update(null,i,i.parentElement.scrollTop*r.parent.verticalScrollScale,l.scrollLeft*r.parent.horizontalScrollScale,f)},300));r.previousValues.top!==e&&(r.parent.scrollDirection=r.direction="vertical",o=-(e-r.parent.scrollPosObject.verticalSection-i.parentElement.scrollTop),c=i.querySelector("."+hi).style.transform.split(",")[0].trim(),o>r.parent.virtualDiv.clientHeight&&(o=r.parent.virtualDiv.clientHeight),i.parentElement.scrollTop<r.parent.scrollerBrowserLimit&&(n.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate(0px,"+o+"px)"}),n.setStyleAttribute(i.querySelector(".e-table"),{transform:c+","+o+"px)"})),s=r.parent.scrollPosObject.verticalSection>e?-(r.parent.scrollPosObject.verticalSection-e):e+t.parentElement.clientHeight-(r.parent.scrollPosObject.verticalSection+t.querySelector(".e-table").offsetHeight),a=Math.ceil(r.parent.scrollPosObject.verticalSection/r.parent.verticalScrollScale)<r.parent.scrollerBrowserLimit,(r.parent.scrollPosObject.verticalSection>e||s>1&&a)&&(e>t.parentElement.clientHeight?(r.parent.scrollPosObject.top<1&&(r.parent.scrollPosObject.top=t.parentElement.clientHeight),r.parent.scrollPosObject.top=r.parent.scrollPosObject.top-50,s=r.parent.scrollPosObject.verticalSection>e?s-r.parent.scrollPosObject.top:s+r.parent.scrollPosObject.top):s=-r.parent.scrollPosObject.verticalSection,v=r.parent.element.querySelector("."+at).querySelector(".e-table"),o=-(e-(r.parent.scrollPosObject.verticalSection+s)-i.parentElement.scrollTop),h=r.parent.gridSettings.rowHeight*r.engineModule.rowCount+.1-v.clientHeight,h>r.parent.scrollerBrowserLimit&&(r.parent.verticalScrollScale=h/r.parent.scrollerBrowserLimit,h=r.parent.scrollerBrowserLimit),o>h&&o>e&&(o=e,s=0),o>r.parent.virtualDiv.clientHeight&&(o=r.parent.virtualDiv.clientHeight),n.setStyleAttribute(t.querySelector(".e-table"),{transform:"translate(0px,"+o+"px)"}),n.setStyleAttribute(i.querySelector(".e-table"),{transform:c+","+o+"px)"}),r.parent.scrollPosObject.verticalSection=r.parent.scrollPosObject.verticalSection+s),r.previousValues.top=e,r.frozenPreviousValues.top=e,r.eventType="")}},t.prototype.removeInternalEvents=function(){this.parent.isDestroyed||this.parent.off(vi,this.wireEvents)},t.prototype.destroy=function(){this.removeInternalEvents()},t}(),hv=function(){function t(n){this.indexString=[];this.clonedData=[];this.isUpdated=!1;this.gridIndexObjects={};this.gridData=[];this.formatList={};this.drillKeyConfigs={escape:"escape"};this.parent=n;this.engine="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule}return t.prototype.frameHeaderWithKeys=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],t++;return r},t.prototype.showDrillThroughDialog=function(t){var i=this,r,u;for(this.gridData=t.rawData,r=0;r<t.rawData.length;r++)this.clonedData.push(this.frameHeaderWithKeys(t.rawData[r]));try{if("Table"===this.parent.currentView&&this.parent.editSettings.allowInlineEditing&&this.parent.editSettings.allowEditing&&1===t.rawData.length){if(this.parent.actionObj.actionName=fh,this.parent.actionBeginMethod())return;this.editCell(t)}else this.removeDrillThroughDialog(),u=n.createElement("div",{id:this.parent.element.id+"_drillthrough",className:"e-drillthrough-dialog"}),this.parent.element.appendChild(u),this.dialogPopUp=new b.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("details"),content:this.createDrillThroughGrid(t),cssClass:this.parent.cssClass,beforeOpen:function(){i.drillThroughGrid.setProperties({dataSource:i.parent.editSettings.allowEditing?i.dataWithPrimarykey(t):i.gridData,height:i.parent.editSettings.allowEditing?220:300},!1)},beforeClose:function(){var d,t,e,v,y,p,b,rt;if(i.parent.editSettings.allowEditing&&i.isUpdated){"CSV"===i.parent.dataSourceSettings.type&&i.updateData(i.drillThroughGrid.dataSource);for(var s=[],h=0,k=Object.keys(i.gridIndexObjects);h<k.length;h++)d=k[h],s.push(i.gridIndexObjects[d]);for(var f=Object.keys(i.gridIndexObjects).length,c=[],g=[],l=0,a=0,nt=i.drillThroughGrid.dataSource;a<nt.length;a++){if(t=nt[a],n.isNullOrUndefined(t.__index)||""===t.__index){for(e=0,v=i.engine.fields;e<v.length;e++)y=v[e],n.isNullOrUndefined(t[y])&&delete t[y];delete t.__index;c.push(t)}else f>0&&(delete i.gridIndexObjects[t.__index.toString()],g.push(t),f--);"Server"===i.parent.dataSourceSettings.mode&&(t.__index&&delete t.__index,i.gridData[l].__index&&delete i.gridData[l].__index);l++}if(f=0,"Server"===i.parent.dataSourceSettings.mode){for(var tt=[],u=Object.keys(i.gridIndexObjects),r=0;r<u.length;r++)delete i.parent.drillThroughValue.indexObject[i.gridIndexObjects[u[r]]],tt.push({Key:u[r],Value:i.gridIndexObjects[u[r]]});for(p=[],u=Object.keys(i.parent.drillThroughValue.indexObject),r=0;r<u.length;r++)p.push({Key:u[r],Value:i.parent.drillThroughValue.indexObject[u[r]]});i.parent.getEngine("updateRawData",null,null,null,null,null,null,null,{addedData:c,removedData:tt,updatedData:g,indexObject:p})}else{for(var o=[],w=0,it=i.parent.allowDataCompression?i.parent.engineModule.actualData:i.parent.engineModule.data;w<it.length;w++)delete(t=it[w]).__index,void 0===i.gridIndexObjects[f.toString()]&&o.push(t),f++;o=o.concat(c);b={currentData:i.drillThroughGrid.dataSource,previousData:i.clonedData,previousPosition:s,cancel:!1};i.parent.trigger(vs,b);b.cancel||(i.parent.setProperties({dataSourceSettings:{dataSource:o}},!0),i.engine.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.engine.pivotValues)}i.parent.actionObj.actionName="Records updated";rt={editInfo:{type:i.drillThroughGrid.editSettings.mode,action:"Update",currentData:i.drillThroughGrid.dataSource,previousData:i.clonedData,previousPosition:s}};i.parent.actionObj.actionInfo=rt}i.isUpdated=!1;i.gridIndexObjects={}},isModal:!0,visible:!0,showCloseIcon:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.isAdaptive?"100%":"60%",position:{X:"center",Y:"center"},closeOnEscape:!this.parent.editSettings.allowEditing,target:document.body,close:this.removeDrillThroughDialog.bind(this)}),this.dialogPopUp.isStringTemplate=!0,this.dialogPopUp.appendTo(u),n.setStyleAttribute(this.dialogPopUp.element,{visibility:"visible"}),this.parent.editSettings.allowEditing&&(this.drillthroughKeyboardModule=new n.KeyboardEvents(this.dialogPopUp.element,{keyAction:this.drillthroughKeyActionHandler.bind(this),keyConfigs:this.drillKeyConfigs,eventName:"keydown"}))}catch(t){this.parent.actionFailureMethod(t)}},t.prototype.editCell=function(t){var i=this,e=this.parent.gridSettings.allowResizing,u=t.currentCell.actualText.toString(),o=Number(Object.keys(t.currentCell.indexObject)),r;t.currentTarget.firstElementChild.style.display="none";var s=Number(t.rawData[0][u]),h=this.frameHeaderWithKeys(t.rawData[t.rawData.length-1]),f=t.rawData[t.rawData.length-1],c={editInfo:{type:"Inline editing",action:"update",data:this.gridData}};this.parent.actionObj.actionInfo=c;this.numericTextBox=new it.NumericTextBox({value:s,enableRtl:this.parent.enableRtl,enabled:!0,format:"####.##",locale:this.parent.locale,cssClass:this.parent.cssClass,change:function(){var r=n.isNullOrUndefined(i.numericTextBox.value)?0:i.numericTextBox.value,f=t.currentCell.indexObject[o];t.rawData[0][u]=r;i.parent.engineModule.data[f]=t.rawData[0]},blur:function(){var n={currentData:f,previousData:h,previousPosition:f.index,cancel:!1};i.parent.trigger(vs,n);n.cancel||(i.parent.setProperties({dataSourceSettings:{dataSource:i.parent.engineModule.data}},!0),i.engine.updateGridData(i.parent.dataSourceSettings),i.parent.pivotValues=i.engine.pivotValues,i.parent.gridSettings.allowResizing=e)}});r=n.createElement("input",{id:this.parent.element.id+"_inputbox"});t.currentTarget.appendChild(r);this.numericTextBox.appendTo(r);t.currentCell.value=this.numericTextBox.value;this.numericTextBox.focusIn();this.parent.gridSettings.allowResizing=!1},t.prototype.updateData=function(t){for(var i=0,u=this.parent.allowDataCompression?this.parent.engineModule.actualData:this.parent.engineModule.data;i<t.length;){for(var f=Object.keys(t[i]),r=0,e=[];r<f.length;)n.isNullOrUndefined(this.parent.engineModule.fieldKeys[f[r]])||(e[this.parent.engineModule.fieldKeys[f[r]]]=t[i][f[r]]),r++;u[t[i].__index]=e;i++}this.parent.allowDataCompression?this.parent.engineModule.actualData=u:this.parent.engineModule.data=u},t.prototype.removeDrillThroughDialog=function(){this.dialogPopUp&&!this.dialogPopUp.isDestroyed&&(this.parent.actionObj.actionName="Drill-through closed",this.parent.actionObj.actionName&&this.parent.actionCompleteMethod(),this.dialogPopUp.destroy());var t=document.getElementById(this.parent.element.id+"_drillthrough");t&&n.remove(t);document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg")&&n.remove(document.getElementById(this.parent.element.id+"_drillthroughgrid_ccdlg"))},t.prototype.createDrillThroughGrid=function(t){var i=this,e=n.createElement("div",{id:this.parent.element.id+"_drillthroughbody",className:"e-drillthrough-body"}),u=n.createElement("div",{id:this.parent.element.id+"_drillthroughbodyheader",className:"e-drillthrough-body-header-container"}),c,o,h,f,r;if((""!==t.rowHeaders&&(u.innerHTML="<span class="+co+"><span class="+ho+">"+this.parent.localeObj.getConstant("row")+"<\/span> : <span class="+lo+">"+t.rowHeaders+"<\/span><\/span>"),""!==t.columnHeaders&&(u.innerHTML=u.innerHTML+"<span class="+co+"><span class="+ho+">"+this.parent.localeObj.getConstant("column")+"<\/span> : <span class="+lo+">"+t.columnHeaders+"<\/span><\/span>"),""!==t.value)&&(c=t.value.split("(")[0],o=t.value.split("(")[1].split(")")[0],"0"!==o&&(u.innerHTML=u.innerHTML+"<span class="+co+"><span class="+ho+">"+c+"<\/span> : <span class="+lo+">"+o+"<\/span><\/span>")),h=["ColumnChooser"],this.parent.editSettings.allowEditing&&(h=this.parent.editSettings.allowCommandColumns?["ColumnChooser","Add"]:"Batch"===this.parent.editSettings.mode?["ColumnChooser","Add","Delete","Update","Cancel"]:"Dialog"===this.parent.editSettings.mode?["ColumnChooser","Add","Edit","Delete"]:["ColumnChooser","Add","Edit","Delete","Update","Cancel"]),f=n.createElement("div",{id:this.parent.element.id+"_drillthroughgrid",className:"e-drillthrough-grid"}),s.Grid.Inject(s.Selection,s.Reorder,s.Resize,s.Toolbar,s.ColumnChooser),this.drillThroughGrid=new s.Grid({cssClass:this.parent.cssClass,gridLines:"Default",allowResizing:!0,allowReordering:!0,showColumnChooser:!0,enableHover:!1,toolbar:h,columns:t.gridColumns,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableVirtualization:!this.parent.editSettings.allowEditing,allowPaging:this.parent.editSettings.allowEditing,pageSettings:{pageSize:20},rowHeight:this.parent.gridSettings.rowHeight}),"olap"===this.parent.dataType&&this.formatData(),r=this,this.parent.trigger("beginDrillThrough",{cellInfo:t,gridObj:this.drillThroughGrid,type:"editing"}),this.drillThroughGrid.allowExcelExport&&s.Grid.Inject(s.ExcelExport),this.drillThroughGrid.allowPdfExport&&s.Grid.Inject(s.PdfExport),this.parent.editSettings.allowEditing){s.Grid.Inject(s.Edit,s.Page);try{this.drillThroughGrid.editSettings=this.parent.editSettings;this.drillThroughGrid.actionBegin=function(n){var t="save"===n.requestType?eh:"add"===n.requestType?oh:"delete"===n.requestType?sh:"";i.parent.actionObj.actionName=t;i.parent.actionObj.actionName&&i.parent.actionBeginMethod()};this.parent.editSettings.allowCommandColumns?(this.drillThroughGrid.editSettings.mode="Normal",this.drillThroughGrid.editSettings.allowEditOnDblClick=!1,s.Grid.Inject(s.CommandColumn),this.drillThroughGrid.columns.push({headerText:this.parent.localeObj.getConstant("manageRecords"),width:160,showInColumnChooser:!1,commands:[{type:"Edit",buttonOption:{iconCss:" e-icons e-edit",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Delete",buttonOption:{iconCss:"e-icons e-delete",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Save",buttonOption:{iconCss:"e-icons e-update",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}},{type:"Cancel",buttonOption:{iconCss:"e-icons e-cancel-icon",cssClass:"e-flat"+(this.parent.cssClass?" "+this.parent.cssClass:"")}}]})):this.drillThroughGrid.editSettings.allowEditOnDblClick=this.parent.editSettings.allowEditOnDblClick;this.drillThroughGrid.columns.push({field:"__index",visible:!1,isPrimaryKey:!0,type:"string",showInColumnChooser:!1})}catch(t){this.parent.actionFailureMethod(t)}this.drillThroughGrid.actionComplete=function(n){"batchsave"!==n.requestType&&"save"!==n.requestType&&"delete"!==n.requestType||(r.isUpdated=!0);i.parent.actionObj.actionName=i.parent.getActionCompleteName();var t={editInfo:{type:i.drillThroughGrid.editSettings.mode,action:n.requestType,data:i.gridData}};i.parent.actionObj.actionInfo=t;i.parent.actionObj.actionName&&i.parent.actionCompleteMethod();("Normal"===r.drillThroughGrid.editSettings.mode&&"save"===n.requestType&&r.drillThroughGrid.element.querySelectorAll(".e-tbar-btn:hover").length>0&&!r.parent.editSettings.allowCommandColumns||"batchsave"===n.requestType)&&r.dialogPopUp.hide()};this.drillThroughGrid.beforeBatchSave=function(){r.isUpdated=!0}}else s.Grid.Inject(s.VirtualScroll);return document.body.appendChild(f),this.drillThroughGrid.isStringTemplate=!0,this.drillThroughGrid.appendTo(f),e.appendChild(u),e.appendChild(f),e},t.prototype.frameGridColumns=function(t){var c="olap"===this.parent.dataType?t[0]?Object.keys(t[0]):[]:Object.keys(this.engine.fieldList),e=[],r,u,o,i,f,s,l,h,a;if(this.parent.dataSourceSettings.formatSettings.length>0)for(r=0;r<this.parent.dataSourceSettings.formatSettings.length;r++)this.formatList[this.parent.dataSourceSettings.formatSettings[r].name]=this.parent.dataSourceSettings.formatSettings[r].format;if("olap"===this.parent.dataType)for(u=0,o=c;u<o.length;u++)i=o[u],e.push({field:i.replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join(""),headerText:i.replace(/_x005B_|_x005D_|_x0024_/g,"").replace(/_x0020_/g," ").replace("].[","").split(".").reverse().join("."),width:120,visible:!0,validationRules:{required:!0},format:n.isNullOrUndefined(this.formatList[i])?null:this.formatList[i],type:n.isNullOrUndefined(this.formatList[i])?"string":null});else for(f=0,s=c;f<s.length;f++)(i=s[f],"CalculatedField"!==this.engine.fieldList[i].aggregateType)&&(h=!("date"!==this.engine.fieldList[i].type&&"datetime"!==this.engine.fieldList[i].type||!(this.isDateFieldExist(i)||t[0]&&t[0][i]&&-1===t[0][i].toString().indexOf(" "))),l="number"===this.engine.fieldList[i].type?"numericedit":"date"===this.engine.fieldList[i].type&&h?"datepickeredit":"datetime"===this.engine.fieldList[i].type&&h?"datetimepickeredit":"defaultedit",a=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(this.engine.fieldList[i].caption):this.engine.fieldList[i].caption,e.push({field:i,headerText:a,width:120,visible:this.engine.fieldList[i].isSelected,validationRules:{required:!0},editType:l,format:n.isNullOrUndefined(this.formatList[i])?void 0:this.formatList[i],type:n.isNullOrUndefined(this.formatList[i])?"string":null}));return e},t.prototype.isDateFieldExist=function(n){for(var t=0;t<this.parent.dataSourceSettings.formatSettings.length;t++)if(this.parent.dataSourceSettings.formatSettings[t].name===n&&this.parent.dataSourceSettings.formatSettings[t].type.indexOf("date")>-1)return!0;for(t=0;t<this.parent.dataSourceSettings.fieldMapping.length;t++)if(this.parent.dataSourceSettings.fieldMapping[t].name===n&&this.parent.dataSourceSettings.fieldMapping[t].dataType&&this.parent.dataSourceSettings.fieldMapping[t].dataType.indexOf("date")>-1)return!0;return!1},t.prototype.formatData=function(){for(var n=0;n<this.gridData.length;){for(var u=this.gridData[n],i=Object.keys(this.gridData[n]),r={},t=0;t<i.length;)r[i[t].replace(/_x005B_|_x0020_|_x005D_|_x0024_/g,"").replace("].[","").split(".").reverse().join("")]=u[i[t]],t++;this.gridData[n]=r;n++}},t.prototype.dataWithPrimarykey=function(n){for(var i=this.indexString.length>0?this.indexString:Object.keys(n.currentCell.indexObject),u=this.gridData,t=0,r=0,f=u;r<f.length;r++)f[r].__index=i[t],this.gridIndexObjects[i[t].toString()]=Number(i[t]),t++;return u},t.prototype.drillthroughKeyActionHandler=function(n){"escape"===n.action&&this.processClose(n)},t.prototype.processClose=function(t){var u=t.target,i,o,r,f,e;if(u&&n.closest(u,".e-popup.e-popup-open")&&(i=n.closest(u,".e-popup.e-popup-open").ej2_instances[0],i&&!i.closeOnEscape)){if(o=i.element.getAttribute("data-fieldName"),i.hide(),this.parent.element)for(r=0,f=[].slice.call(this.parent.element.querySelectorAll(".e-pivot-button"));r<f.length;r++)if(e=f[r],e.getAttribute("data-uid")===o){e.focus();break}return void t.preventDefault()}},t.prototype.destroy=function(){this.parent.isDestroyed||this.drillthroughKeyboardModule&&!this.drillthroughKeyboardModule.isDestroyed&&(this.drillthroughKeyboardModule.destroy(),this.drillthroughKeyboardModule=null)},t}(),cv=function(){function t(n){this.parent=n;this.drillThroughDialog=new hv(this.parent);this.addInternalEvents()}return t.prototype.getModuleName=function(){return"drillThrough"},t.prototype.addInternalEvents=function(){this.parent.on(vi,this.wireEvents,this)},t.prototype.wireEvents=function(){this.unWireEvents();n.EventHandler.add(this.parent.element,"dblclick",this.mouseClickHandler,this)},t.prototype.unWireEvents=function(){this.parent.isDestroyed||n.EventHandler.remove(this.parent.element,"dblclick",this.mouseClickHandler)},t.prototype.mouseClickHandler=function(n){var t=n.target,i=null,r,u;(t.classList.contains("e-stackedheadercelldiv")||t.classList.contains("e-cellvalue")||t.classList.contains("e-headercelldiv")?i=t.parentElement:t.classList.contains("e-headercell")||t.classList.contains("e-rowcell")?i=t:t.classList.contains("e-headertext")&&(i=t.parentElement.parentElement),i&&(this.parent.allowDrillThrough&&i.classList.contains("e-valuescontent")||this.parent.editSettings.allowEditing))&&(r=Number(i.getAttribute("data-colindex")),u=Number(i.getAttribute("index")),this.executeDrillThrough(this.parent.pivotValues[u][r],u,r,i))},t.prototype.executeDrillThrough=function(n,t,i,r){var w,f,l,o,a,y,s,p,k;this.parent.drillThroughElement=r;this.parent.drillThroughValue=n;var u="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,h="",c="",e=[];if(void 0!==n.rowHeaders&&void 0!==n.columnHeaders){if("olap"===this.parent.dataType){if(f=(w="row"===this.parent.dataSourceSettings.valueAxis?u.tupRowInfo[n.rowOrdinal]:u.tupColumnInfo[n.colOrdinal])?u.getUniqueName(w.measureName):n.actualText,u.fieldList[f]&&u.fieldList[f].isCalculatedField)return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("drillError"));h=u.fieldList[f||n.actualText].caption;c=u.fieldList[f||n.actualText].aggregateType;this.parent.olapEngineModule.getDrillThroughData(n,this.parent.maxRowsInDrillThrough);try{e=JSON.parse(u.gridJSON)}catch(n){return void this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),u.gridJSON)}}else if(h=u.fieldList[n.actualText.toString()]?u.fieldList[n.actualText.toString()].caption:n.actualText.toString(),c=u.fieldList[n.actualText]?u.fieldList[n.actualText].aggregateType:"","Server"===this.parent.dataSourceSettings.mode)this.parent.getEngine("fetchRawData",null,null,null,null,null,null,{rowIndex:t,columnIndex:i});else if(this.parent.allowDataCompression)for(l=Object.keys(n.indexObject),this.drillThroughDialog.indexString=[],o=0,a=l;o<a.length;o++)for(var d=a[o],v=0,b=this.parent.engineModule.groupRawIndex[Number(d)];v<b.length;v++)y=b[v],e.push(this.parent.engineModule.actualData[y]),this.drillThroughDialog.indexString.push(y.toString());else for(s=0,p=l=Object.keys(n.indexObject);s<p.length;s++)k=p[s],e.push(this.parent.engineModule.data[Number(k)]);"Server"!==this.parent.dataSourceSettings.mode&&this.triggerDialog(h,c,e,n,r)}},t.prototype.getCalcualtedFieldValue=function(t,i){for(var o,u,s,f,e,r=0;r<t.length;r++)for(o={},o[t[r]]=t[r],u=0;u<this.parent.dataSourceSettings.calculatedFieldSettings.length;u++){for(s=void 0,f=this.parent.engineModule.fields.length-1;f>=0;f--)if(this.parent.engineModule.fields[f]===this.parent.dataSourceSettings.calculatedFieldSettings[u].name){s=f;break}n.isNullOrUndefined(i[r])||(e=this.parent.engineModule.getAggregateValue([Number(t[r])],o,s,"calculatedfield",!1),i[r][this.parent.dataSourceSettings.calculatedFieldSettings[u].name]=isNaN(e)&&n.isNullOrUndefined(e)?"#DIV/0!":e)}return i},t.prototype.frameData=function(n){for(var r,t=0,i=0,u=[];i<n.rawData.length;){for(r={};t<n.gridColumns.length;)r[n.gridColumns[t].field]="Server"===this.parent.dataSourceSettings.mode?n.rawData[i][-1!==this.parent.engineModule.fields.indexOf(n.gridColumns[t].field)?this.parent.engineModule.fields.indexOf(n.gridColumns[t].field):0]:n.rawData[i][this.parent.engineModule.fieldKeys[n.gridColumns[t].field]],t++;u.push(r);i++;t=0}return n.rawData=u,n},t.prototype.triggerDialog=function(t,i,r,u,f){var o="CalculatedField"===i?t.toString():""!==i?this.parent.localeObj.getConstant(i)+" "+this.parent.localeObj.getConstant("of")+" "+t:t,s,e,h;o=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(o):o;s="row"===this.parent.dataSourceSettings.valueAxis?this.parent.getRowText(Number(f.getAttribute("index")),0):""===u.rowHeaders?"":u.rowHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");e={currentTarget:f,currentCell:u,rawData:r,rowHeaders:s,columnHeaders:""===u.columnHeaders?"":u.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),value:o+"("+u.formattedText+")",gridColumns:this.drillThroughDialog.frameGridColumns(r),cancel:!1};"CSV"===this.parent.dataSourceSettings.type&&(e=this.frameData(e));h=this;this.parent.trigger("drillThrough",e,function(n){e.cancel||h.drillThroughDialog.showDrillThroughDialog(n)})},t.prototype.destroy=function(){this.unWireEvents();this.drillThroughDialog&&(this.drillThroughDialog.destroy(),this.drillThroughDialog=null)},t}();const h=ejdashboard.charts;le=function(){function t(){this.headerColl={};this.maxLevel=0;this.columnGroupObject={};this.selectedLegend=0;this.chartSeriesInfo={};this.fieldPosition=[];this.measurePos=-1;this.measuresNames={};this.accumulationType=["Pie","Pyramid","Doughnut","Funnel"]}return t.prototype.getModuleName=function(){return"pivotChart"},t.prototype.loadChart=function(t,i){var ht,ni,p,u,o,pt,ri,li,e,y,et,wt,ui,r,nt,kt,l,dt,fi,tt,gt,si;if(this.parent=t,this.measuresNames={},this.engineModule="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.dataSourceSettings=this.parent.dataSourceSettings,this.chartSettings=i,"olap"===t.dataType?""!==t.dataSourceSettings.url&&!t.olapEngineModule.isEmptyData&&t.olapEngineModule.tupColumnInfo.length>0&&t.olapEngineModule.tupRowInfo.length>0&&(!n.isNullOrUndefined(t.olapEngineModule.colMeasurePos)||!n.isNullOrUndefined(t.olapEngineModule.rowMeasurePos)):"Server"===this.parent.dataSourceSettings.mode?!n.isNullOrUndefined(t.dataSourceSettings.url)&&""!==t.dataSourceSettings.url&&t.dataSourceSettings.values.length>0&&!t.engineModule.isEmptyData:t.dataSourceSettings.values.length>0&&t.dataSourceSettings.dataSource&&(t.dataSourceSettings.dataSource.length>0||t.dataSourceSettings.dataSource instanceof ut.DataManager)&&!t.engineModule.isEmptyData){for(!this.parent.chart&&(this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))&&n.remove(n.select("#"+this.parent.element.id+"_chart",this.parent.element)),this.measureList=this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(i.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.dataSourceSettings.values.map(function(n){return n.name}):[""===i.value?this.dataSourceSettings.values[0].name:i.value],ht=0,ni=this.dataSourceSettings.values;ht<ni.length;ht++)p=(o=ni[ht]).name.replace(/[^A-Z0-9]+/gi,"_"),this.measuresNames[o.name]=p,this.measuresNames[p]=o.name,"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type||(this.measuresNames[o.caption?o.caption:o.name]=o.name);this.columnGroupObject={};this.accEmptyPoint=!1;u=this.engineModule.pivotValues;this.currentMeasure=i.enableMultipleAxis&&this.accumulationType.indexOf(i.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?this.measureList[0]:(""===i.value||0===this.dataSourceSettings.values.filter(function(n){return n.name===i.value}).length)&&this.dataSourceSettings.values.length>0?this.dataSourceSettings.values[0].name:i.value;var ct,lt,a,ki=this.getColumnTotalIndex(u),di=Object.keys(u),it={},v=0,rt=-.5;this.headerColl={};this.maxLevel=0;var s,hi={},ti="",at="",d="";this.chartSeriesInfo={};this.selectedLegend=0;for(var vt=!1,yt={},w=!1,g=this.parent.dataSourceSettings.valueSortSettings.headerDelimiter,ii=0,ci=this.dataSourceSettings.values;ii<ci.length;ii++)yt[p=(o=ci[ii]).name]=o.caption?o.caption:p,yt[o.caption?o.caption:p]=p;for("olap"===this.parent.dataType&&(hi=this.groupHierarchyWithLevels(u),ti=this.fieldPosition[this.fieldPosition.length-1],d=at=this.measurePos===this.fieldPosition.length-1&&this.fieldPosition.length>1?this.fieldPosition[this.fieldPosition.length-2]:ti),pt=0,ri=di;pt<ri.length;pt++)if(li=ri[pt],e=Number(li),!n.isNullOrUndefined(u[e])){if(y=u[e][0],et=y&&y.valueSort&&!n.isNullOrUndefined(y.valueSort.levelName)?y.valueSort.levelName.toString().split(g):void 0,w=!1,et&&"Grand Total"!==et[0]&&((i.enableMultipleAxis&&this.accumulationType.indexOf(i.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||et.indexOf(yt[this.currentMeasure])>-1)&&(w=!0),!w)){for(wt=0,ui=et;wt<ui.length;wt++)if(yt[wi=ui[wt]]){w=!0;break}w=!w}if(y&&"row"===y.axis&&(0===this.dataSourceSettings.rows.length||"grand sum"!==y.type&&w)){if(r=u[e][0],r.isSum)continue;var c="olap"===this.parent.dataType?this.engineModule.tupRowInfo[r.ordinal]:void 0,ai=-1,b=r.level;"olap"===this.parent.dataType?(vt="[Measures]"===r.hierarchy?vt:this.isAttributeDrill(r.hierarchy,c.drillInfo),d=d===at||"[Measures]"===r.hierarchy||r.isNamedSet||this.engineModule.fieldList[r.hierarchy]&&!this.engineModule.fieldList[r.hierarchy].hasAllMember?at:d,ai=c.drillInfo.length-1,3===r.memberType||c.measureName&&c.measureName!==this.dataSourceSettings.values[0].name||(it=0===(v=(lt=void 0===lt?r.levelUniqueName:lt)===r.levelUniqueName?0:v)?{}:it,v=a&&lt!==r.levelUniqueName?a.hierarchy===r.hierarchy?v+(r.level-a.level):n.isNullOrUndefined(it[r.levelUniqueName])?hi[r.hierarchy].start:it[r.levelUniqueName]:v,it[r.levelUniqueName]=v,b=v,rt+=!a||d!==a.hierarchy||a.isDrilled&&a.hasChild?0:1,d=vt?r.hierarchy:at,ct=v,a=r)):"value"!==r.type&&(void 0===ct||ct<b||rt++,ct=b);this.maxLevel=b>this.maxLevel?b:this.maxLevel;var yi="olap"===this.parent.dataType?r.formattedText:r.actualText?r.actualText.toString():r.formattedText.toString(),bt=this.engineModule.fieldList[this.currentMeasure],pi=0===this.parent.dataSourceSettings.rows.length?this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(bt.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+(n.isNullOrUndefined(bt.caption)?bt.name:bt.caption):r.formattedText?r.formattedText.toString():yi,gi=r.hasChild&&!r.isNamedSet?(r.isDrilled?" - ":" + ")+pi:pi,wi=c?c.uNameCollection:r.valueSort.levelName.toString(),nr={name:yi,text:gi,hasChild:r.hasChild,isDrilled:r.isDrilled,levelName:wi,level:b,fieldName:r.valueSort.axis?r.valueSort.axis.toString():"",rowIndex:e,colIndex:0,cell:r};("olap"===this.parent.dataType?3!==r.memberType:"value"!==r.type)&&(this.headerColl[rt]||(this.headerColl[rt]={}),this.headerColl[rt][b]=nr);var tr=u[e],ir=Object.keys(tr),k=void 0;if("olap"===this.parent.dataType)s=3!==r.memberType?r:s;else if(s="value"!==r.type?r:s,"value"!==r.type)s=r;else if(nt=r&&r.valueSort&&r.valueSort.levelName&&r.valueSort.levelName.toString().split(g),kt=void 0,nt&&nt.length>0&&(nt.splice(nt.length-1,1),kt=nt.join(g)),!(this.parent.dataSourceSettings.valueIndex<=0)&&(!this.engineModule.valueAxis||this.dataSourceSettings.rows.length!==this.engineModule.measureIndex)&&!n.isNullOrUndefined(s.valueSort)&&kt!==s.valueSort.levelName)for(l=e;l>-1;)u[l]&&u[l][0]&&u[l][0].valueSort&&u[l][0].valueSort.levelName===kt&&(s=u[l][0],l=0),l--;for(dt=0,fi=ir;dt<fi.length;dt++){var rr=fi[dt],ot=Number(rr),f=u[e][ot],ur=!n.isNullOrUndefined(f.rowHeaders)||0===this.dataSourceSettings.rows.length,ei="olap"===this.parent.dataType&&c&&c.measureName?c.measureName:f.actualText;if(("olap"!==this.parent.dataType||!f.isGrandSum)&&!ki[f.colIndex]&&"value"===f.axis&&"header"!==r.type&&""!==ei&&(i.enableMultipleAxis&&this.accumulationType.indexOf(i.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type||ei===this.currentMeasure)){if(n.isNullOrUndefined(r.members)&&(r.members=[]),"olap"===this.parent.dataType?ti!==r.hierarchy&&!vt||(3===r.memberType&&k?ai!==this.measurePos||k.isDrilled&&k.hasChild:r.isDrilled&&r.hasChild):("value"===r.type&&k?k.members.length>0&&k.isDrilled:r.members.length>0&&r.isDrilled)||!ur)break;var st="olap"===this.parent.dataType?f.columnHeaders.toString().split(/~~|::/).join(" - "):f.columnHeaders.toString().split(g).join(" - "),bi="olap"===this.parent.dataType?f.rowHeaders.toString().split(/~~|::/).join(" - "):f.rowHeaders.toString().split(g).join(" - "),oi=st+" | "+ei;this.chartSeriesInfo[st]={uniqueName:st,caption:f.hierarchyName&&f.hierarchyName.toString().split(g).join(" - "),colorIndex:[]};this.chartSeriesInfo[this.chartSeriesInfo[st].caption]=this.chartSeriesInfo[st];tt="pivot"===this.parent.dataType&&this.engineModule.aggregatedValueMatrix[e]&&!n.isNullOrUndefined(this.engineModule.aggregatedValueMatrix[e][ot])?Number(this.engineModule.aggregatedValueMatrix[e][ot]):n.isNullOrUndefined(f.value)?f.value:Number(f.value);0===(tt=tt===1/0?null:tt)&&(this.accEmptyPoint=!0);this.columnGroupObject[oi]?this.columnGroupObject[oi].push({x:0===this.dataSourceSettings.rows.length?r.formattedText:bi,y:tt,rIndex:e,cIndex:ot}):this.columnGroupObject[oi]=[{x:0===this.dataSourceSettings.rows.length?r.formattedText:bi,y:tt,rIndex:e,cIndex:ot}]}k=s}}}this.refreshChart()}else{if(this.parent.chart)return this.parent.element.querySelector(".e-chart")?(this.parent.chart.series=[],this.parent.chart.rows=[],this.parent.chart.primaryXAxis.title="",this.parent.chart.primaryYAxis.title="",this.parent.chart.primaryXAxis.multiLevelLabels=[],this.parent.chart.primaryYAxis.multiLevelLabels=[],this.parent.chart.axes.length>0&&(this.parent.chart.axes[0].title=""),this.parent.chart.primaryXAxis.zoomFactor=n.isNullOrUndefined(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor):this.parent.element.querySelector(".e-accumulationchart")&&(this.parent.chart.series[0].dataSource=[{}],this.parent.chart.series[0].dataLabel={}),void this.parent.chart.refresh();n.select("#"+this.parent.element.id+"_chart",this.parent.element)||("Both"===this.parent.displayOption.view&&"Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(n.createElement("div",{className:ft,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector("."+yr)):this.parent.element.appendChild(n.createElement("div",{className:ft,id:this.parent.element.id+"_chart"})),gt=this.parent.width.toString(),this.parent.showToolbar&&this.parent.grid&&(gt=this.parent.getGridWidthAsNumber().toString()),si=this.getChartHeight(),(this.chartSettings&&this.chartSettings.chartSeries&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)>-1?new h.AccumulationChart({width:gt,height:si}):new h.Chart({width:gt,height:si})).appendTo("#"+this.parent.element.id+"_chart"),this.parent.showToolbar&&("Both"===this.parent.displayOption.view&&"Chart"===this.parent.currentView&&(this.parent.grid.element.style.display="none"),"Chart"!==this.parent.currentView&&(n.select("#"+this.parent.element.id+"_chart",this.parent.element).style.display="none")));this.parent.notify(vi,{})}},t.prototype.refreshChart=function(){var t,a,b,r,e,k,u,d,o,g,s;this.chartSeries=[];var f=0,v={},c=Object.keys(this.columnGroupObject);this.persistSettings=JSON.parse(this.parent.getChartSettings()).chartSettings;for(var y=this.persistSettings.palettes&&this.persistSettings.palettes.length>0?this.persistSettings.palettes:h.getSeriesColor(this.chartSettings.theme),nt=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",p=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(nt).join(" - "):"",l=this.chartSettings.chartSeries?this.chartSettings.chartSeries.type:void 0,w={},i=0;i<this.parent.dataSourceSettings.values.length;i++)w[this.parent.dataSourceSettings.values[i].name]=n.isNullOrUndefined(this.parent.dataSourceSettings.values[i].caption)?void 0:this.parent.dataSourceSettings.values[i].caption;if(this.accumulationType.indexOf(l)>-1&&c.length>0)this.currentColumn=c.indexOf(p+" | "+this.currentMeasure)>-1&&void 0!==p?p+" | "+this.currentMeasure:c[0],t={},t=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):t,(n.isNullOrUndefined(t.palettes)||0===t.palettes.length)&&!n.isNullOrUndefined(this.persistSettings.palettes)&&this.persistSettings.palettes.length>0&&(t.palettes=this.persistSettings.palettes),t.dataSource=this.columnGroupObject[this.currentColumn],t.xName="x",t.yName="y",this.persistSettings.chartSeries&&this.persistSettings.chartSeries.dataLabel?(t.dataLabel=this.persistSettings.chartSeries.dataLabel,t.dataLabel.name="x"):(t.dataLabel={visible:!0,position:"Outside",name:"x"},this.parent.setProperties({chartSettings:{chartSeries:{dataLabel:{visible:!0,position:"Outside"}}}},!0)),this.accEmptyPoint&&t.emptyPointSettings?t.emptyPointSettings.mode="Zero":this.accEmptyPoint&&(t.emptyPointSettings={mode:"Zero"}),t.name=this.currentColumn,"Doughnut"===l?(t.type="Pie",t.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"40%"):"Pie"===l&&(t.innerRadius=this.chartSettings.chartSeries.innerRadius?this.chartSettings.chartSeries.innerRadius:"0"),this.chartSeries=this.chartSeries.concat(t);else for(a=0,b=c;a<b.length;a++){for(r=b[a],t={},t=this.persistSettings.chartSeries?this.frameChartSeries(this.persistSettings.chartSeries):t,!n.isNullOrUndefined(t.palettes)&&t.palettes.length>0&&(n.isNullOrUndefined(this.persistSettings.palettes)||0===this.persistSettings.palettes.length)&&(this.chartSettings.palettes=t.palettes),i=0;i<this.columnGroupObject[r].length;i++)e=this.engineModule.fieldList[this.currentMeasure],this.columnGroupObject[r][i].x=0!==this.parent.dataSourceSettings.rows.length||this.chartSettings.showMultiLevelLabels?""===this.columnGroupObject[r][i].x?this.parent.localeObj.getConstant("blank"):this.columnGroupObject[r][i].x:this.parent.localeObj.getConstant("total")+" "+this.parent.localeObj.getConstant(e.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" "+(n.isNullOrUndefined(e.caption)?e.name:e.caption);t.dataSource=this.columnGroupObject[r];t.xName="x";t.yName="y";t.visible=!0;k=void 0;this.chartSettings.enableMultipleAxis&&(u=r.split(" | ")[1],u=n.isNullOrUndefined(w[u])?u:w[u],k=r.split(" | ")[0]+" | "+u);(t.name=this.chartSettings.enableMultipleAxis?k:r.split(" | ")[0],this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis)&&(t.name=t.name.split(" |")[0],d=this.chartSeriesInfo[t.name].caption,t.name=null!=d?d:t.name,v[t.name]?(t.fill=v[t.name].color,this.chartSeriesInfo[t.name].colorIndex.push(this.selectedLegend++),t.name=void 0):(f=y[f]?f:0,v[t.name]={name:t.name,color:y[f]},t.fill=y[f++],this.chartSeriesInfo[t.name].colorIndex.push(this.selectedLegend++)));["Radar","Polar"].indexOf(l)<0&&(o=r.split(" | ")[1],t.tooltipMappingName=this.measuresNames[o],t.yAxisName=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[o]?this.measuresNames[o]:o);this.persistSettings.chartSeries&&this.persistSettings.chartSeries.emptyPointSettings&&(t.emptyPointSettings=this.persistSettings.chartSeries.emptyPointSettings);t.emptyPointSettings||(t.emptyPointSettings={mode:"Zero"});this.chartSeries=this.chartSeries.concat(t)}g={series:this.chartSeries,cancel:!1};s=this;this.parent.trigger("chartSeriesCreated",g,function(t){t.cancel?(s.element&&n.remove(s.element),s.parent.notify(vi,{})):s.bindChart()})},t.prototype.frameObjectWithKeys=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)r[i[t]]=n[i[t]],t++;return r},t.prototype.frameChartSeries=function(n){for(var i=Object.keys(n),t=0,r={};t<i.length;)this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)>-1&&["fill","dashArray","width","segmentAxis","drawType","isClosed","segments","stackingGroup","marker","errorBar","trendlines","minRadius","splineType","maxRadius","cardinalSplineTension","columnWidth","columnSpacing","cornerRadius"].indexOf(i[t])>-1||this.accumulationType.indexOf(this.parent.chartSettings.chartSeries.type)<0&&["endAngle","explode","explodeAll","explodeIndex","explodeOffset","gapRatio","groupMode","groupTo","neckHeight","neckWidth","pyramidMode","startAngle","dataLabel","innerRadius"].indexOf(i[t])>-1||(r[i[t]]=n[i[t]]),t++;return r},t.prototype.bindChart=function(){var u,i;this.parent.showWaitingPopup();var f=this.configXAxis(),o=this.configTooltipSettings(),e=this.configLegendSettings(),s=this.configZoomSettings(),r=this.frameAxesWithRows(),t=this.chartSettings.chartSeries.type;"Both"===this.parent.displayOption.view?this.element="Chart"===this.parent.displayOption.primary?this.parent.element.insertBefore(this.element?this.element:n.createElement("div",{className:ft,id:this.parent.element.id+"_chart"}),this.parent.element.querySelector("."+yr)):this.parent.element.appendChild(this.element?this.element:n.createElement("div",{className:ft,id:this.parent.element.id+"_chart"})):this.element||(this.element=this.parent.element.appendChild(n.createElement("div",{className:ft,id:this.parent.element.id+"_chart"})));!this.chartElement&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ft).innerHTML="",this.chartElement=this.parent.element.querySelector("."+ft).appendChild(n.createElement("div",{className:ff,id:this.parent.element.id+"_chartInner"})));this.parent.element.querySelector("."+ff)&&(this.parent.element.querySelector("."+ff).innerHTML="");this.element.style.minWidth=this.parent.showGroupingBar?"400px !important":"310px !important";u=this.parent.width.toString();this.parent.showToolbar&&this.parent.grid&&(u=this.parent.getGridWidthAsNumber().toString());i=this.getChartHeight();this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(t)<0&&"Pareto"!==this.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ft).style.height=("auto"===i?this.getChartAutoHeight():i)+"px",this.parent.element.querySelector("."+ft).style.width=u+"px","Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&(this.parent.element.querySelector("."+ft).style.overflow="auto",this.parent.element.querySelector("."+ft).style.overflowX="hidden"));this.parent.chart&&("accumulationchart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(t)<0||"chart"===this.parent.chart.getModuleName()&&this.accumulationType.indexOf(t)>-1&&"Pareto"!==this.chartSettings.chartSeries.type)&&(this.parent.chart.destroy(),n.select("#"+this.parent.element.id+"_chart",this.parent.element)&&(n.select("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",n.select("#"+this.parent.element.id+"_chart",this.parent.element).appendChild(n.createElement("div",{className:ff,id:this.parent.element.id+"_chartInner"}))));!(this.parent.chart&&this.parent.chart.element&&this.parent.element.querySelector(".e-chart")||this.parent.element.querySelector(".e-accumulationchart"))||this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange?(this.parent.toolbarModule&&this.parent.toolbarModule.isMultiAxisChange&&this.parent.chart&&(this.parent.chart.isDestroyed||this.parent.chart.destroy(),this.parent.chart=void 0,n.select("#"+this.parent.element.id+"_chart",this.parent.element).innerHTML="",n.select("#"+this.parent.element.id+"_chart",this.parent.element).appendChild(n.createElement("div",{className:ff,id:this.parent.element.id+"_chartInner"})),this.parent.toolbarModule.isMultiAxisChange=!1),h.Chart.Inject(h.ColumnSeries,h.StackingColumnSeries,h.RangeColumnSeries,h.BarSeries,h.StackingBarSeries,h.ScatterSeries,h.BubbleSeries,h.LineSeries,h.StepLineSeries,h.SplineSeries,h.SplineAreaSeries,h.MultiColoredLineSeries,h.PolarSeries,h.RadarSeries,h.AreaSeries,h.RangeAreaSeries,h.StackingAreaSeries,h.StepAreaSeries,h.StackingLineSeries,h.MultiColoredAreaSeries,h.ParetoSeries,h.Legend,h.Tooltip,h.Category,h.MultiLevelLabel,h.ScrollBar,h.Zoom,h.Export,h.Crosshair,h.Selection,h.StripLine,h.DataLabel),h.AccumulationChart.Inject(h.PieSeries,h.FunnelSeries,h.PyramidSeries,h.AccumulationDataLabel,h.AccumulationLegend,h.AccumulationTooltip,h.Export),this.parent.chart=this.accumulationType.indexOf(t)>-1?new h.AccumulationChart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:e,tooltip:o,width:u,height:i.toString(),title:this.chartSettings.title,enableSmartLabels:this.chartSettings.enableSmartLabels,center:this.chartSettings.pieCenter,enableBorderOnMouseMove:this.chartSettings.enableBorderOnMouseMove,highlightMode:this.chartSettings.highlightMode,highlightPattern:this.chartSettings.highlightPattern,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,theme:this.chartSettings.theme,selectionMode:this.chartSettings.accumulationSelectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,enableAnimation:this.chartSettings.enableAnimation,useGroupingSeparator:this.chartSettings.useGroupingSeparator,locale:this.parent.locale,enableRtl:this.parent.enableRtl,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this)}):new h.Chart({series:this.chartSeries.length>0?this.chartSeries:[{}],legendSettings:e,tooltip:o,zoomSettings:s,axes:"Polar"===t||"Radar"===t?[]:r.axes,rows:"Polar"===t||"Radar"===t?[{}]:"Bar"===t||"StackingBar"===t||"StackingBar100"===t||"Pareto"===t&&this.chartSettings.enableMultipleAxis?[{height:"100%"}]:r.rows,columns:"Polar"===t||"Radar"===t?[{}]:"Bar"===t||"StackingBar"===t||"StackingBar100"===t&&this.chartSettings.enableMultipleAxis?r.columns:[{width:"100%"}],primaryYAxis:"Polar"===t||"Radar"===t?r.axes[0]:{visible:!1},primaryXAxis:f,width:u,height:"Polar"!==this.parent.chartSettings.chartSeries.type&&"Radar"!==this.parent.chartSettings.chartSeries.type&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&"Pareto"!==this.parent.chartSettings.chartSeries.type&&this.parent.dataSourceSettings.values.length>0?Number(i)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(i))?i.toString():(Number(i)-5).toString():!isNaN(Number(i))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():i.toString():i.toString(),title:this.chartSettings.title,titleStyle:this.chartSettings.titleStyle,subTitle:this.chartSettings.subTitle,subTitleStyle:this.chartSettings.subTitleStyle,margin:this.chartSettings.margin,border:this.chartSettings.border,background:this.chartSettings.background,chartArea:this.chartSettings.chartArea,palettes:this.chartSettings.palettes,theme:this.chartSettings.theme,crosshair:this.chartSettings.crosshair,selectionMode:this.chartSettings.selectionMode,isMultiSelect:this.chartSettings.isMultiSelect,enableExport:this.chartSettings.enableExport,selectedDataIndexes:this.chartSettings.selectedDataIndexes,isTransposed:this.chartSettings.isTransposed,enableAnimation:this.chartSettings.enableAnimation,enableCanvas:this.chartSettings.enableCanvas,useGroupingSeparator:this.chartSettings.useGroupingSeparator,description:this.chartSettings.description,tabIndex:this.chartSettings.tabIndex,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableSideBySidePlacement:this.chartSettings.enableSideBySidePlacement,beforePrint:this.chartSettings.beforePrint?this.chartSettings.beforePrint.bind(this):void 0,animationComplete:this.chartSettings.animationComplete?this.chartSettings.animationComplete.bind(this):void 0,legendRender:this.chartSettings.legendRender?this.chartSettings.legendRender.bind(this):void 0,textRender:this.chartSettings.textRender?this.chartSettings.textRender.bind(this):void 0,pointRender:this.chartSettings.pointRender?this.chartSettings.pointRender.bind(this):void 0,seriesRender:this.chartSettings.seriesRender?this.chartSettings.seriesRender.bind(this):void 0,chartMouseMove:this.chartSettings.chartMouseMove?this.chartSettings.chartMouseMove.bind(this):void 0,chartMouseClick:this.chartSettings.chartMouseClick?this.chartSettings.chartMouseClick.bind(this):void 0,pointMove:this.chartSettings.pointMove?this.chartSettings.pointMove.bind(this):void 0,pointClick:this.pointClick.bind(this),chartMouseLeave:this.chartSettings.chartMouseLeave?this.chartSettings.chartMouseLeave.bind(this):void 0,chartMouseDown:this.chartSettings.chartMouseDown?this.chartSettings.chartMouseDown.bind(this):void 0,chartMouseUp:this.chartSettings.chartMouseUp?this.chartSettings.chartMouseUp.bind(this):void 0,dragComplete:this.chartSettings.dragComplete?this.chartSettings.dragComplete.bind(this):void 0,zoomComplete:this.chartSettings.zoomComplete?this.chartSettings.zoomComplete.bind(this):void 0,scrollStart:this.chartSettings.scrollStart?this.chartSettings.scrollStart.bind(this):void 0,scrollEnd:this.chartSettings.scrollEnd?this.chartSettings.scrollEnd.bind(this):void 0,scrollChanged:this.chartSettings.scrollChanged?this.chartSettings.scrollChanged.bind(this):void 0,tooltipRender:this.tooltipRender.bind(this),legendClick:this.legendClick.bind(this),loaded:this.loaded.bind(this),load:this.load.bind(this),resized:this.resized.bind(this),axisLabelRender:this.axisLabelRender.bind(this),multiLevelLabelClick:this.multiLevelLabelClick.bind(this),axisMultiLabelRender:this.multiLevelLabelRender.bind(this)}),this.parent.chart.isStringTemplate=!0):(this.parent.chart.series=this.chartSeries,this.parent.chart.title=this.parent.chartSettings.title,this.parent.chart.subTitle=this.parent.chartSettings.subTitle,this.parent.chart.background=this.parent.chartSettings.background,this.parent.chart.theme=this.parent.chartSettings.theme,this.parent.chart.legendSettings=e,this.parent.chart.selectionMode=this.parent.chartSettings.selectionMode,this.parent.chart.enableExport=this.parent.chartSettings.enableExport,this.parent.chart.isMultiSelect=this.parent.chartSettings.isMultiSelect,this.parent.chart.enableAnimation=this.parent.chartSettings.enableAnimation,this.parent.chart.useGroupingSeparator=this.parent.chartSettings.useGroupingSeparator,this.parent.chart.highlightPattern=this.parent.chartSettings.highlightPattern,this.accumulationType.indexOf(t)>-1?(this.parent.chart.enableBorderOnMouseMove=this.parent.chartSettings.enableBorderOnMouseMove,this.parent.chart.highlightMode=this.parent.chartSettings.highlightMode,this.parent.chart.enableSmartLabels=this.parent.chartSettings.enableSmartLabels):(this.parent.chart.palettes=this.parent.chartSettings.palettes,this.parent.chart.isTransposed=this.parent.chartSettings.isTransposed,this.parent.chart.enableSideBySidePlacement=this.parent.chartSettings.enableSideBySidePlacement,this.parent.chart.tabIndex=this.parent.chartSettings.tabIndex,this.parent.chart.description=this.parent.chartSettings.description,this.parent.chart.enableCanvas=this.parent.chartSettings.enableCanvas),"Polar"===t||"Radar"===t?(this.parent.chart.primaryXAxis=f,this.parent.chart.primaryYAxis.visible=!0,this.parent.chart.primaryYAxis=r.axes[0],this.parent.chart.axes=[],this.parent.chart.rows=[{}]):this.accumulationType.indexOf(t)<0&&"chart"===this.parent.chart.getModuleName()&&(this.parent.chart.primaryYAxis.visible=!1,this.parent.chart.primaryXAxis=f,this.parent.chart.axes=r.axes,"Bar"===t||"StackingBar"===t||"StackingBar100"===t&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=r.columns):"Pareto"===t&&this.chartSettings.enableMultipleAxis?(this.parent.chart.rows=[{height:"100%"}],this.parent.chart.columns=[{width:"100%"}]):(this.parent.chart.rows=r.rows,this.parent.chart.columns=[{width:"100%"}])),this.parent.chart.refresh(),this.accumulationType.indexOf(t)>-1&&"accumulationchart"===this.parent.chart.getModuleName()&&(0===this.parent.dataSourceSettings.rows.length||0===this.parent.dataSourceSettings.columns.length)&&(this.parent.hideWaitingPopup(),this.parent.pivotFieldListModule&&b.hideSpinner(this.parent.pivotFieldListModule.fieldListSpinnerElement)));this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis?this.parent.chart.appendTo("#"+this.parent.element.id+"_chartInner"):this.parent.chart.appendTo("#"+this.parent.element.id+"_chart")},t.prototype.legendClick=function(n){if(this.chartSettings.showPointColorByMembers&&this.chartSettings.enableMultipleAxis)for(var i=this.chartSeriesInfo[n.legendText].colorIndex,t=1;t<i.length;t++)n.chart.series[i[t]].visible=!n.chart.series[i[t]].visible;this.parent.trigger("chartLegendClick",n)},t.prototype.pointClick=function(n){var t=n.series.dataSource?n.series.dataSource:this.parent.chart.series[n.seriesIndex].dataSource,i,f,r,u;(["Pie","Funnel","Doughnut","Pyramid","Radar","Polar"].indexOf(this.parent.chartSettings.chartSeries.type)>-1||!this.parent.chartSettings.showMultiLevelLabels)&&("olap"===this.parent.dataType||this.parent.dataSourceSettings.rows.length>1)?(this.pivotIndex={rIndex:t?t[n.pointIndex].rIndex:void 0,cIndex:t?t[n.pointIndex].cIndex:void 0},this.creatMenu(),i=this.parent.element.getBoundingClientRect(),f=(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:0)+(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:0)+(window.scrollY||document.documentElement.scrollTop)+i.top,this.accumulationMenu.open(f+n.y,n.x+i.left+(window.scrollX||document.documentElement.scrollLeft))):(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule&&(r=t[n.pointIndex].rIndex,u=t[n.pointIndex].cIndex,this.parent.drillThroughModule.executeDrillThrough(this.parent.pivotValues[r][u],r,u));this.parent.trigger("chartPointClick",n)},t.prototype.frameAxesWithRows=function(){var f=[],o=[],s=[],k=[],d=this.persistSettings.chartSeries&&("StackingColumn100"===this.persistSettings.chartSeries.type||"StackingBar100"===this.persistSettings.chartSeries.type||"StackingArea100"===this.persistSettings.chartSeries.type||"StackingLine100"===this.persistSettings.chartSeries.type),g=["PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfDifferenceFrom","PercentageOfParentRowTotal","PercentageOfParentColumnTotal","PercentageOfParentTotal"],y,c,w,b;if(this.chartSettings.enableMultipleAxis)for(var l=0,nt=100/this.dataSourceSettings.values.length+"%",a=0,tt=this.dataSourceSettings.values;a<tt.length;a++){var e=tt[a],u=this.engineModule.fieldList[e.name],h=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(u.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+u.caption;k.push(h);for(var i=void 0,v=0,it=this.dataSourceSettings.formatSettings;v<it.length;v++)if(y=it[v],y.name===e.name){i=y;break}var p=-1!==r.inArray(u.aggregateType,g)?"P2":i?null===i.format.toLowerCase().match(/n|p|c/)?"N":i.format:"olap"===this.parent.dataType?this.getFormat(u.formatString):"N",rt="Polar"===this.chartSettings.chartSeries.type||"Radar"===this.chartSettings.chartSeries.type,t={};(t=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):t).labelFormat=t.labelFormat?t.labelFormat:d?"":rt?"N":p;t.title="Combined"===this.chartSettings.multipleAxisMode?k.join(" - "):t.title?t.title:h;t.zoomFactor=n.isNullOrUndefined(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor;t.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement;"Bar"===this.chartSettings.chartSeries.type||"StackingBar"===this.chartSettings.chartSeries.type||"StackingBar100"===this.chartSettings.chartSeries.type?t.plotOffsetRight=t.plotOffsetRight?t.plotOffsetRight:30:t.plotOffsetTop=t.plotOffsetTop?t.plotOffsetTop:30;rt||(t.name="Combined"===this.chartSettings.multipleAxisMode?this.measureList.join("_"):this.measuresNames[e.name]?this.measuresNames[e.name]:e.name);f=f.concat(t);"Combined"===this.chartSettings.multipleAxisMode&&(f=[f[f.length-1]]);"Stacked"===this.chartSettings.multipleAxisMode?(t.rowIndex=l,t.columnIndex=l,o.push({height:nt}),s.push({width:nt})):(t.rowIndex=0,t.columnIndex=0,o=[{height:"100%"}],s=[{width:"100%"}]);l++}else{for(u=this.engineModule.fieldList[this.currentMeasure],h=("olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(u.aggregateType)+" "+this.parent.localeObj.getConstant("of")+" ")+u.caption,i=void 0,c=0,w=this.dataSourceSettings.formatSettings;c<w.length;c++)if((e=w[c]).name===this.currentMeasure){i=e;break}b=void 0;i&&(b=i.format.length);t={};p=-1!==r.inArray(u.aggregateType,g)?"P2":i?null===i.format.toLowerCase().match(/n[0-10]|p[0-10]|c[0-10]/)||b>3?"N":i.format:"olap"===this.parent.dataType?this.getFormat(u.formatString):"N";(t=this.persistSettings.primaryYAxis?this.frameObjectWithKeys(this.persistSettings.primaryYAxis):t).zoomFactor=n.isNullOrUndefined(this.chartSettings.primaryYAxis.zoomFactor)?1:this.chartSettings.primaryYAxis.zoomFactor;t.rowIndex=0;t.columnIndex=0;t.edgeLabelPlacement=this.chartSettings.primaryYAxis.edgeLabelPlacement?this.chartSettings.primaryYAxis.edgeLabelPlacement:this.persistSettings.primaryYAxis.edgeLabelPlacement;"Polar"!==this.chartSettings.chartSeries.type&&"Radar"!==this.chartSettings.chartSeries.type&&(t.name=this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure);t.labelFormat=t.labelFormat?t.labelFormat:d?"":p;t.title=t.title?t.title:h;f=f.concat(t);o.push({height:"100%"});s.push({width:"100%"})}return{axes:f,rows:o,columns:s}},t.prototype.getFormat=function(n){return"Currency"===n?"C":"Percent"===n?"P":"N"},t.prototype.getColumnTotalIndex=function(t){for(var h,r,u,o,c,i,f={},e=0,s=Object.keys(t);e<s.length;e++)if(h=s[e],r=t[Number(h)],!n.isNullOrUndefined(r))for(u=0,o=Object.keys(r);u<o.length;u++)if(c=o[u],i=r[Number(c)],!n.isNullOrUndefined(i)){if("column"!==i.axis)return f;("sum"===i.type||0!==this.dataSourceSettings.columns.length&&"grand sum"===i.type)&&-1!==i.rowSpan&&(f[i.colIndex]=i.colIndex)}return f},t.prototype.groupHierarchyWithLevels=function(t){var h,c,e,i,o,r;this.fieldPosition=[];var u={},f=0,s={};for(this.measurePos=this.engineModule.tupRowInfo[0].measurePosition,e=0;e<t.length;e++)i=t[e][0],i&&"row"===i.axis&&"grand sum"!==i.type&&(n.isNullOrUndefined(u[i.hierarchy])?(3===i.memberType?f===this.measurePos?(this.fieldPosition[this.measurePos]=i.hierarchy,u[i.hierarchy]=((h={})[i.levelUniqueName]=i.levelUniqueName,h)):f--:(this.fieldPosition[f]=i.hierarchy,u[i.hierarchy]=((c={})[i.levelUniqueName]=i.levelUniqueName,c)),f++):u[i.hierarchy][i.levelUniqueName]=i.levelUniqueName);for(o=-1,r=0;r<this.fieldPosition.length;r++)this.measurePos!==r&&(s[this.fieldPosition[r]]={start:o+1,end:o+Object.keys(u[this.fieldPosition[r]]).length},o=s[this.fieldPosition[r]].end);return s},t.prototype.frameMultiLevelLabels=function(){for(var e,l,k,i,a,v,o,y=Object.keys(this.headerColl),f=this.headerColl[-.5],s=0,p=y;s<p.length;s++){for(var h=p[s],r=Number(h),n=this.headerColl[r],t=0,w=!1;t<=this.maxLevel;)w?n[t]||(n[t]={name:n[t-1].name,text:"",hasChild:n[t-1].hasChild,isDrilled:n[t-1].isDrilled,levelName:n[t-1].levelName,level:n[t-1].level,fieldName:n[t-1].fieldName,rowIndex:n[t-1].rowIndex,colIndex:n[t-1].colIndex,span:-1}):n[t]?w=!0:n[t]=f[t],t++;f=this.headerColl[r]}for(var u={},c=0,b=y;c<b.length;c++){for(h=b[c],r=Number(h),n=this.headerColl[r],e=0,l=Object.keys(n);e<l.length;e++)k=l[e],i=Number(k),u[i]?(a=u[i].length,n[i].levelName===f[i].levelName?u[i][a-1].end=u[i][a-1].end+1:u[i].push({start:r,end:r+1,text:n[i].text,type:-1===n[i].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[i]})):u[i]=[{start:r,end:r+1,text:n[i].text,type:-1===n[i].span?"WithoutTopandBottomBorder":"WithoutTopBorder",customAttributes:n[i]}];f=n}for(v=[],o=Object.keys(u).length-1;o>-1;o--)v.push({categories:u[o],border:{width:1},overflow:"Trim"});return v},t.prototype.getZoomFactor=function(){this.calculatedWidth=this.getCalulatedWidth();var t=10*this.chartSeries.length>120?10*this.chartSeries.length:120,n=this.chartSeries.length>0?this.calculatedWidth/(Object.keys(this.chartSeries[0].dataSource).length*t):1;return n<1&&n>0?n:1},t.prototype.getCalulatedWidth=function(){return this.calculatedWidth=isNaN(Number(this.parent.width))?this.parent.width.indexOf("%")>-1?this.parent.element.clientWidth*(parseFloat(this.parent.width)/100):this.parent.width.indexOf("px")>-1?Number(this.parent.width.toString().split("px")[0]):this.parent.element.clientWidth:Number(this.parent.width),this.calculatedWidth},t.prototype.configTooltipSettings=function(){var n=this.persistSettings.tooltip?this.persistSettings.tooltip:this.chartSettings.tooltip;return n.enable=void 0===n.enable||n.enable,n.enable&&n.template&&(this.templateFn=this.parent.templateParser(n.template)),this.parent.tooltipTemplate&&(n.template=n.template?n.template:this.parent.tooltipTemplate),n.header=n.header?n.header:"",n.enableMarker=void 0===n.enableMarker||n.enableMarker,n},t.prototype.configLegendSettings=function(){var n={},t,i;if(this.chartSettings.legendSettings)for(t=0,i=Object.keys(this.chartSettings.legendSettings);t<i.length;)n[i[t]]=this.chartSettings.legendSettings[i[t]],t++;return n.visible=!1!==n.visible,n.padding=n.padding?n.padding:25,n.shapePadding=n.shapePadding?n.shapePadding:10,n},t.prototype.configXAxis=function(){var t={};return(t=this.persistSettings.primaryXAxis?this.frameObjectWithKeys(this.persistSettings.primaryXAxis):t).valueType="Category",t.labelIntersectAction=t.labelIntersectAction?t.labelIntersectAction:"Rotate45",t.title=t.title?t.title:this.dataSourceSettings.rows.map(function(n){return n.caption||n.name}).join(" / "),t.zoomFactor=n.isNullOrUndefined(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(t.zoomFactor=1),this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type?(t.multiLevelLabels=this.frameMultiLevelLabels(),t.border={width:1,type:"WithoutTopandBottomBorder"},t.majorTickLines={width:0,height:-10}):(t.multiLevelLabels=[],t.border={width:1,type:"Rectangle"},t.majorTickLines={width:0,height:5}),t},t.prototype.configZoomSettings=function(){var n=this.chartSettings.zoomSettings;return n.enableSelectionZooming=void 0===n.enableSelectionZooming||n.enableSelectionZooming,n.enableScrollbar=void 0===n.enableScrollbar||n.enableScrollbar,n},t.prototype.tooltipRender=function(t){var e=this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Radar"!==this.chartSettings.chartSeries.type&&"Polar"!==this.chartSettings.chartSeries.type?t.series.tooltipMappingName:t.series.yAxisName?t.series.yAxisName.split("_CumulativeAxis")[0]:this.chartSettings.enableMultipleAxis&&this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&"Pareto"!==this.chartSettings.chartSeries.type?t.series.name?t.series.name.split(" | ")[1]:t.data.seriesName?t.data.seriesName.split(" | ")[1]:this.currentMeasure:this.measuresNames[this.currentMeasure]?this.measuresNames[this.currentMeasure]:this.currentMeasure,i=t.series.dataSource?t.series.dataSource:this.parent.chart.series[t.data.seriesIndex].dataSource,u=i?i[t.data.pointIndex].rIndex:void 0,f=i?i[t.data.pointIndex].cIndex:void 0,r=this.engineModule.fieldList[this.measuresNames[e]?this.measuresNames[e]:e],h="olap"===this.parent.dataType?"":this.parent.localeObj.getConstant(r.aggregateType),b=("olap"===this.parent.dataType?"":h+" "+this.parent.localeObj.getConstant("of")+" ")+r.caption,c=this.engineModule.pivotValues[u][f].formattedText,o=this.engineModule.formatFields[r.id],l=this.engineModule.getFormattedValue(t.point.y,r.id,c),a=o&&o.format&&null!==o.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?l.toString():l.formattedText:c,s=this.parent.pivotValues[u][f].columnHeaders,v=n.isNullOrUndefined(s)?void 0:"olap"===this.parent.dataType?this.chartSeriesInfo[s.toString().split(/~~|::/).join(" - ")].uniqueName:this.chartSeriesInfo[s.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ")].uniqueName,y=t.point.x;if(this.parent.tooltipTemplate&&void 0!==this.parent.getTooltipTemplate()||this.chartSettings.tooltip.template){var p,k=i?this.parent.getHeaderField(u,f,"row"):"",d=i?this.parent.getHeaderField(u,f,"Column"):"",w={rowHeaders:y,columnHeaders:v,aggregateType:h,value:a,valueField:r.caption,rowFields:k,columnFields:d};p=this.parent.chartSettings&&this.parent.chartSettings.tooltip&&this.parent.chartSettings.tooltip.enable&&this.parent.chartSettings.tooltip.template?this.tooltipTemplateFn()(w,this,"tooltipTemplate",this.element.id+"1tooltipTemplate")[0].outerHTML:this.parent.getTooltipTemplate()(w,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML;t.template=p}else t.text=b+": "+a+(0===this.dataSourceSettings.columns.length?"":" <br/>"+this.parent.localeObj.getConstant("column")+": "+v)+(0===this.dataSourceSettings.rows.length?"":" <br/>"+this.parent.localeObj.getConstant("row")+": "+y),this.parent.trigger("chartTooltipRender",t)},t.prototype.tooltipTemplateFn=function(){return this.templateFn},t.prototype.loaded=function(t){var u,i;this.parent.isChartLoaded=!0;u=this.parent.grid?this.parent.getGridWidthAsNumber().toString():this.parent.getWidthAsNumber().toString();(this.parent.chart&&this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.showFieldList&&"Chart"===this.parent.currentView&&this.parent.groupingBarModule.alignIcon(),this.chartSettings.showMultiLevelLabels)&&(i=r.inArray(this.chartSettings.chartSeries.type,["Bar","StackingBar","StackingBar100"])>-1?"_chartYAxisMultiLevelLabel0":"_chartXAxisMultiLevelLabel0",n.isNullOrUndefined(n.select("#"+this.parent.element.id+i,this.parent.element))||this.parent.element.querySelector("#"+this.parent.element.id+i).setAttribute("cursor","pointer"));this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&(["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)>=0?this.parent.element.querySelector("."+ft).style.overflow="visible":(this.parent.element.querySelector("."+ft).style.overflow="auto",this.parent.element.querySelector("."+ft).style.overflowX="hidden"),this.parent.element.querySelector("."+ft).style.width=u+"px");this.updateView();this.parent.notify(vi,{});this.parent.trigger("chartLoaded",t);("Server"===this.parent.dataSourceSettings.mode&&this.parent.isServerWaitingPopup||"Local"===this.parent.dataSourceSettings.mode)&&this.parent.hideWaitingPopup()},t.prototype.updateView=function(){var n,t;this.parent.grid&&this.parent.chart&&this.parent.showToolbar&&("Table"===this.parent.currentView?((this.parent.grid.element.style.display="",this.parent.chart.element.style.display="none",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar"))&&(n=this.parent.element.querySelector(".e-pivot-grouping-bar"),n.style.display="",n&&n.querySelector("."+yi)&&null!=this.parent.groupingBarModule.gridPanel&&!this.parent.groupingBarModule.gridPanel.isDestroyed&&this.parent.groupingBarModule.gridPanel.refreshOverflow(),this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none"),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="none")):((this.parent.grid.element.style.display="none",this.parent.chart.element.style.display="",this.parent.showGroupingBar&&this.parent.groupingBarModule&&this.parent.element.querySelector(".e-pivot-grouping-bar")&&this.parent.element.querySelector(".e-chart-grouping-bar"))&&(this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none",t=this.parent.element.querySelector(".e-chart-grouping-bar"),t.style.display="",t&&t.querySelector("."+yi)&&null!=this.parent.groupingBarModule.chartPanel&&!this.parent.groupingBarModule.chartPanel.isDestroyed&&this.parent.groupingBarModule.chartPanel.refreshOverflow()),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.enableScrollOnMultiAxis&&(this.parent.element.querySelector(".e-pivotchart").style.display="")))},t.prototype.creatMenu=function(){var u,s;this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&this.accumulationMenu.destroy();for(var f=(this.parent.allowDrillThrough||this.parent.editSettings.allowEditing)&&this.parent.drillThroughModule?["expand","collapse","drillThrough","exit"]:["expand","collapse","exit"],r=[],t=0;t<f.length;t++)r.push({id:this.parent.element.id+"_DrillMenuChart_"+f[t],text:this.parent.localeObj.getConstant(f[t]),items:[]});var i=this.getMenuItems(),e=[],o=[];for(t=0;t<i.length;t++)"expand"===i[t].type?e.push({id:this.element.id+"drillExpand_"+i[t].key,text:i[t].value}):o.push({id:this.element.id+"drillCollapse_"+i[t].key,text:i[t].value});e.length>0&&(r[0].items=e);o.length>0&&(r[1].items=o);s={cssClass:this.parent.element.id+"_accumulationChart"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:r,enableRtl:this.parent.enableRtl,beforeOpen:this.drillMenuOpen.bind(this),select:this.drillMenuSelect.bind(this),locale:this.parent.locale};this.accumulationMenu=new st.ContextMenu(s);n.select("#"+this.parent.element.id+"_accumulationChart",this.parent.element)?(u=n.select("#"+this.parent.element.id+"_accumulationChart",this.parent.element)).innerHTML="":(u=n.createElement("ul",{id:this.parent.element.id+"_accumulationChart"}),this.parent.element.appendChild(u));this.accumulationMenu.isStringTemplate=!0;this.accumulationMenu.appendTo(u)},t.prototype.drillMenuOpen=function(n){n.items[0]&&n.items[0].text===this.parent.localeObj.getConstant("expand")&&n.items[0].items&&0===n.items[0].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("expand")],!1);n.items[1]&&n.items[1].text===this.parent.localeObj.getConstant("collapse")&&n.items[1].items&&0===n.items[1].items.length&&this.accumulationMenu.enableItems([this.parent.localeObj.getConstant("collapse")],!1)},t.prototype.getMenuItems=function(){for(var o,t=this.pivotIndex.rIndex,f=[],r=this.engineModule.pivotValues,e=[],n=r[t][this.pivotIndex.cIndex],i=!r[t][0].isNamedSet&&r[t][0].hasChild?r[t][0].level:void 0,u="olap"===this.parent.dataType?n.rowHeaders.toString().split(/~~|::/):n.rowHeaders.toString().split(this.engineModule.valueSortSettings.headerDelimiter);r[t][0];)(n=r[t][0],0!==u.length&&u.indexOf(n.formattedText.toString())===u.length-1)&&(n.hasChild&&!n.isNamedSet&&e.indexOf(n.level)<0&&(i?i>=n.level:0!==i||0===n.level)&&(n.isDrilled&&n.hasChild?f.push({key:t,type:"collapse",value:n.formattedText}):f.push({key:t,type:"expand",value:n.formattedText}),e.push(n.level),i=i?i-1:n.level-1),o=u.indexOf(n.formattedText.toString()),u.splice(o,1)),0===n.level&&n.hasChild&&!n.isNamedSet&&(i=void 0,e=[]),t--;return f},t.prototype.drillMenuSelect=function(n){var i="olap"===this.parent.dataType?this.parent.olapEngineModule.pivotValues:this.parent.engineModule.pivotValues,r=n.element.id.split("_DrillMenuChart_")[1];if(0===n.element.id.indexOf(this.element.id+"drill")){var h=n.element.id.split(this.element.id+"drill")[1].indexOf("Expand")>=0?"drillExpand":"drillCollapse",u=Number(n.element.id.split(this.element.id+h+"_")[1]),t=i[u][0],f="olap"===this.parent.dataType?t.formattedText:t.actualText?t.actualText.toString():t.formattedText.toString(),e=t.formattedText?t.formattedText.toString():f,c=t.hasChild&&!t.isNamedSet?(t.isDrilled?" - ":" + ")+e:e,o="olap"===this.parent.dataType?this.engineModule.tupRowInfo[t.ordinal]:void 0,l=o?o.uNameCollection:t.valueSort.levelName.toString(),s={fieldName:t.valueSort.axis,level:t.level,hasChild:t.hasChild,levelName:l,name:f,text:c,rowIndex:u,colIndex:0,isDrilled:t.isDrilled,cell:t};"olap"===this.parent.dataType?this.parent.onDrill(void 0,s):this.onDrill({customAttributes:s})}else"drillThrough"===r?this.parent.drillThroughModule.executeDrillThrough(i[this.pivotIndex.rIndex][this.pivotIndex.cIndex],this.pivotIndex.rIndex,this.pivotIndex.rIndex):"exit"===r&&this.accumulationMenu.close()},t.prototype.getChartHeight=function(){var t,i,r,u;return n.isNullOrUndefined(this.parent.getHeightAsNumber())?t="auto":(r=this.parent.showToolbar?6:5,t=(this.parent.getHeightAsNumber()-r).toString(),i=this.parent.getHeightAsNumber()-r),n.isNullOrUndefined(this.parent.getHeightAsNumber())?t="auto":(u=!1,null!==this.parent.element.querySelector(".e-chart-grouping-bar")&&"none"===this.parent.element.querySelector(".e-chart-grouping-bar").style.display.toLowerCase()&&(u=!0,this.parent.element.querySelector(".e-chart-grouping-bar").style.display="block"),this.parent.showToolbar&&this.parent.showGroupingBar?t=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():this.parent.showToolbar?t=(i-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)).toString():this.parent.showGroupingBar?t=(i-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62)).toString():(this.parent.chart&&parseInt(this.parent.chart.height,10)<200||i<200)&&(t="200"),u&&(this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none")),t},t.prototype.getChartAutoHeight=function(){var n=this.parent.element.offsetHeight<this.parent.minHeight?this.parent.minHeight:this.parent.element.offsetHeight;return this.parent.showToolbar&&this.parent.showGroupingBar?n=n-(this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42)-(this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62):this.parent.showToolbar?n-=this.parent.element.querySelector(".e-pivot-toolbar")?this.parent.element.querySelector(".e-pivot-toolbar").clientHeight:42:this.parent.showGroupingBar&&(n-=this.parent.element.querySelector(".e-chart-grouping-bar")?this.parent.element.querySelector(".e-chart-grouping-bar").clientHeight:62),n},t.prototype.axisLabelRender=function(n){if(this.chartSettings.showMultiLevelLabels&&"Pareto"!==this.chartSettings.chartSeries.type&&"primaryXAxis"===n.axis.name&&(n.text=""),"primaryXAxis"!==n.axis.name){var t=this.engineModule.formatFields[this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:n.axis.name],i=this.engineModule.getFormattedValue(n.value,this.chartSettings.enableMultipleAxis&&"Combined"===this.chartSettings.multipleAxisMode?this.currentMeasure:n.axis.name,n.text),r=t&&t.format&&null!==t.format.toLowerCase().match(/n|p|c/)&&this.chartSettings.useGroupingSeparator?"olap"===this.parent.dataType?i.toString():i.formattedText:n.value.toString();n.text=r}this.parent.trigger("chartAxisLabelRender",n)},t.prototype.multiLevelLabelClick=function(t){var i={axis:t.axis,text:t.text,cell:n.isNullOrUndefined(t.customAttributes)?void 0:t.customAttributes.cell,cancel:!1};this.parent.trigger("multiLevelLabelClick",i);!i.cancel&&t.customAttributes&&t.customAttributes.hasChild&&!t.customAttributes.cell.isNamedSet&&("olap"===this.parent.dataType?this.parent.onDrill(void 0,t.customAttributes):this.onDrill(t))},t.prototype.onDrill=function(n){var e=n.customAttributes,u=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",o=e.fieldName,v=this.engineModule.pivotValues[e.rowIndex][e.colIndex],f=v.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(u),y=!1,s,i,c,l,a;if(0===this.dataSourceSettings.drilledMembers.length)this.parent.setProperties({dataSourceSettings:{drilledMembers:[{name:o,items:[f],delimiter:u}]}},!0);else{for(s=0;s<this.dataSourceSettings.drilledMembers.length;s++)i=this.dataSourceSettings.drilledMembers[s],(f=f.split(u).join(i.delimiter?i.delimiter:u),u=i.delimiter=i.delimiter?i.delimiter:u,i.name===o)&&(y=!0,c=i.items.indexOf(f),c>-1?i.items.splice(c,1):i.items.push(f));y||this.dataSourceSettings.drilledMembers.push({name:o,items:[f],delimiter:u})}this.parent.showWaitingPopup();var t=this,h={fieldName:o,memberName:f,delimiter:u,axis:"row",action:e.isDrilled?"up":"down",currentCell:v},p={drillInfo:h,pivotview:t.parent};t.parent.trigger(lf,p);l={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)};this.parent.trigger(ni,l);this.parent.setProperties({dataSourceSettings:l.dataSourceSettings},!0);t.parent.enableVirtualization||t.parent.enablePaging?"Server"===t.parent.dataSourceSettings.mode?t.parent.getEngine("onDrill",h,null,null,null,null,null):(t.engineModule.drilledMembers=t.dataSourceSettings.drilledMembers,t.engineModule.onDrill(h)):"Server"===t.parent.dataSourceSettings.mode?t.parent.getEngine("onDrill",h,null,null,null,null,null):t.engineModule.generateGridData(t.dataSourceSettings,!0);t.parent.allowServerDataBinding=!1;t.parent.setProperties({pivotValues:t.engineModule.pivotValues},!0);delete t.parent.bulkChanges.pivotValues;t.parent.allowServerDataBinding=!0;a={dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),pivotValues:this.parent.pivotValues};this.parent.trigger(ti,a);t.engineModule.pivotValues=a.pivotValues;t.parent.renderPivotGrid()},t.prototype.isAttributeDrill=function(n,t){for(var u,e=!1,i=0;i<this.dataSourceSettings.drilledMembers.length;i++)if(this.dataSourceSettings.drilledMembers[i].name===n)for(u=0;u<this.dataSourceSettings.drilledMembers[i].items.length;u++){for(var o=this.dataSourceSettings.drilledMembers[i].items[u].split(this.dataSourceSettings.drilledMembers[i].delimiter),f="",r=0;r<o.length;r++)t[r]&&t[r].uName&&(f=f+(""===f?"":this.dataSourceSettings.drilledMembers[i].delimiter)+(t[r].uName.indexOf("[Measures]")>-1?"[Measures]":t[r].uName));if(f===this.dataSourceSettings.drilledMembers[i].items[u]){e=!0;break}}return e},t.prototype.load=function(n){n.chart.zoomModule&&(n.chart.zoomModule.isZoomed=!0);this.parent.trigger("chartLoad",n)},t.prototype.multiLevelLabelRender=function(n){this.parent.trigger("multiLevelLabelRender",n)},t.prototype.resized=function(t){this.accumulationType.indexOf(this.chartSettings.chartSeries.type)<0&&(t.chart.primaryXAxis.zoomFactor=n.isNullOrUndefined(this.parent.chartSettings.primaryXAxis.zoomFactor)?this.getZoomFactor():this.parent.chartSettings.primaryXAxis.zoomFactor,this.parent.chartSettings.zoomSettings.enableScrollbar||(t.chart.primaryXAxis.zoomFactor=n.isNullOrUndefined(this.parent.chartSettings.primaryXAxis.zoomFactor)?1:this.parent.chartSettings.primaryXAxis.zoomFactor));this.parent.trigger("chartResized",t)},t.prototype.getResizedChartHeight=function(){return["Pie","Funnel","Pyramid","Doughnut","Radar","Polar","Pareto"].indexOf(this.parent.chartSettings.chartSeries.type)<0&&this.parent.chartSettings.enableScrollOnMultiAxis&&this.parent.chartSettings.enableMultipleAxis&&this.parent.dataSourceSettings.values.length>0?Number(this.parent.chart.height)>235*this.parent.dataSourceSettings.values.length+100?isNaN(Number(this.getChartHeight()))?this.getChartHeight().toString():(Number(this.getChartHeight())-5).toString():!isNaN(Number(this.getChartHeight()))||this.parent.dataSourceSettings.values.length>1?(235*this.parent.dataSourceSettings.values.length+100).toString():this.getChartHeight().toString():this.getChartHeight().toString()},t.prototype.destroy=function(){this.parent&&this.parent.isDestroyed||(this.engineModule&&!this.parent.destroyEngine&&(this.engineModule.fieldList={},this.engineModule={}),this.chartSeries&&(this.chartSeries=null),this.columnGroupObject&&(this.columnGroupObject=null),this.chartSeriesInfo&&(this.chartSeriesInfo={},this.selectedLegend=null),this.chartSettings&&(this.chartSettings=null),this.dataSourceSettings&&(this.dataSourceSettings=null),this.accumulationMenu&&!this.accumulationMenu.isDestroyed&&(this.accumulationMenu.destroy(),this.accumulationMenu=null),this.parent&&this.parent.chart&&!this.parent.chart.isDestroyed&&(this.parent.chart.destroy(),this.parent.chart=null))},t}();!function(n){n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisTitleFont={size:"14px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.chartSubTitleFont={size:"11px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.crosshairLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.tooltipLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.stripLineLabelFont={size:"12px",fontWeight:"Regular",color:"#353535",fontStyle:"Normal",fontFamily:"Segoe UI"};n.stockEventFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"}}(di||(di={}));var w=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},yl=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!0)],r.prototype,"enable",void 0),i([n.Property(1e3)],r.prototype,"duration",void 0),i([n.Property(0)],r.prototype,"delay",void 0),r}(n.ChildProperty),lv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(null)],r.prototype,"value",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property("0")],r.prototype,"dashArray",void 0),r}(n.ChildProperty),gi=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("Normal")],r.prototype,"fontStyle",void 0),i([n.Property("16px")],r.prototype,"size",void 0),i([n.Property("Normal")],r.prototype,"fontWeight",void 0),i([n.Property("")],r.prototype,"color",void 0),i([n.Property("Center")],r.prototype,"textAlignment",void 0),i([n.Property("Segoe UI")],r.prototype,"fontFamily",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Trim")],r.prototype,"textOverflow",void 0),r}(n.ChildProperty),pl=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(10)],r.prototype,"left",void 0),i([n.Property(10)],r.prototype,"right",void 0),i([n.Property(10)],r.prototype,"top",void 0),i([n.Property(10)],r.prototype,"bottom",void 0),r}(n.ChildProperty),ai=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),r}(n.ChildProperty),av=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(0)],r.prototype,"x",void 0),i([n.Property(0)],r.prototype,"y",void 0),r}(n.ChildProperty),vv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(0)],r.prototype,"series",void 0),i([n.Property(0)],r.prototype,"point",void 0),r}(n.ChildProperty),yv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Complex({},ai)],r.prototype,"border",void 0),i([n.Property("transparent")],r.prototype,"background",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"backgroundImage",void 0),r}(n.ChildProperty),pv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Complex({color:null,width:1},ai)],r.prototype,"line",void 0),i([n.Property("Both")],r.prototype,"lineType",void 0),r}(n.ChildProperty),wv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property(null)],r.prototype,"name",void 0),i([n.Property("transparent")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property(0)],r.prototype,"angle",void 0),i([n.Property(!1)],r.prototype,"enableRotation",void 0),i([n.Property("Auto")],r.prototype,"position",void 0),i([n.Property(5)],r.prototype,"rx",void 0),i([n.Property(5)],r.prototype,"ry",void 0),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Complex({width:null,color:null},ai)],r.prototype,"border",void 0),i([n.Complex({left:5,right:5,top:5,bottom:5},pl)],r.prototype,"margin",void 0),i([n.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},gi)],r.prototype,"font",void 0),i([n.Property(null)],r.prototype,"template",void 0),r}(n.ChildProperty),bv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("Line")],r.prototype,"type",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"length",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),r}(n.ChildProperty),kv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Complex({width:null,color:null},ai)],r.prototype,"border",void 0),i([n.Complex({size:"11px",color:"",fontStyle:"Normal",fontWeight:"Normal",fontFamily:"Segoe UI"},gi)],r.prototype,"font",void 0),i([n.Property("transparent")],r.prototype,"fill",void 0),i([n.Property(0)],r.prototype,"angle",void 0),i([n.Property(!1)],r.prototype,"enableRotation",void 0),i([n.Property("Outside")],r.prototype,"position",void 0),i([n.Property(5)],r.prototype,"rx",void 0),i([n.Property(5)],r.prototype,"ry",void 0),i([n.Property(null)],r.prototype,"template",void 0),i([n.Complex({},bv)],r.prototype,"connectorStyle",void 0),r}(n.ChildProperty),wl=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("Circle")],r.prototype,"shape",void 0),i([n.Property("")],r.prototype,"imageUrl",void 0),i([n.Property(5)],r.prototype,"width",void 0),i([n.Property(5)],r.prototype,"height",void 0),i([n.Complex({width:2,color:null},ai)],r.prototype,"border",void 0),i([n.Complex({x:0,y:0},av)],r.prototype,"offset",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Complex({},wv)],r.prototype,"dataLabel",void 0),r}(n.ChildProperty),dv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(10)],r.prototype,"length",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),gv=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"visible",void 0),i([n.Property("Fixed")],r.prototype,"type",void 0),i([n.Property("Both")],r.prototype,"direction",void 0),i([n.Property("Vertical")],r.prototype,"mode",void 0),i([n.Property(1)],r.prototype,"verticalError",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(1)],r.prototype,"horizontalError",void 0),i([n.Property(3)],r.prototype,"verticalNegativeError",void 0),i([n.Property(3)],r.prototype,"verticalPositiveError",void 0),i([n.Property(1)],r.prototype,"horizontalNegativeError",void 0),i([n.Property(1)],r.prototype,"horizontalPositiveError",void 0),i([n.Complex(null,dv)],r.prototype,"errorBarCap",void 0),r}(n.ChildProperty),ny=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("")],r.prototype,"name",void 0),i([n.Property("0")],r.prototype,"dashArray",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property(2)],r.prototype,"period",void 0),i([n.Property("Linear")],r.prototype,"type",void 0),i([n.Property(0)],r.prototype,"backwardForecast",void 0),i([n.Property(0)],r.prototype,"forwardForecast",void 0),i([n.Property(2)],r.prototype,"polynomialOrder",void 0),i([n.Complex({},wl)],r.prototype,"marker",void 0),i([n.Property(!0)],r.prototype,"enableTooltip",void 0),i([n.Complex({},yl)],r.prototype,"animation",void 0),i([n.Property("")],r.prototype,"fill",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(null)],r.prototype,"intercept",void 0),i([n.Property("SeriesType")],r.prototype,"legendShape",void 0),r}(n.ChildProperty),ty=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Complex({color:"transparent",width:0},ai)],r.prototype,"border",void 0),i([n.Property("Zero")],r.prototype,"mode",void 0),r}(n.ChildProperty),iy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(0)],r.prototype,"topLeft",void 0),i([n.Property(0)],r.prototype,"topRight",void 0),i([n.Property(0)],r.prototype,"bottomLeft",void 0),i([n.Property(0)],r.prototype,"bottomRight",void 0),r}(n.ChildProperty),ry=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"enable",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Complex(di.crosshairLabelFont,gi)],r.prototype,"textStyle",void 0),r}(n.ChildProperty),uy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property(!1)],r.prototype,"startFromAxis",void 0),i([n.Property(null)],r.prototype,"start",void 0),i([n.Property(null)],r.prototype,"end",void 0),i([n.Property(null)],r.prototype,"size",void 0),i([n.Property("#808080")],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"dashArray",void 0),i([n.Property("Auto")],r.prototype,"sizeType",void 0),i([n.Property(!1)],r.prototype,"isRepeat",void 0),i([n.Property(null)],r.prototype,"repeatEvery",void 0),i([n.Property(null)],r.prototype,"repeatUntil",void 0),i([n.Property(!1)],r.prototype,"isSegmented",void 0),i([n.Property(null)],r.prototype,"segmentStart",void 0),i([n.Property(null)],r.prototype,"segmentEnd",void 0),i([n.Property(null)],r.prototype,"segmentAxisName",void 0),i([n.Complex({color:"transparent",width:1},ai)],r.prototype,"border",void 0),i([n.Property("")],r.prototype,"text",void 0),i([n.Property(null)],r.prototype,"rotation",void 0),i([n.Property("Middle")],r.prototype,"horizontalAlignment",void 0),i([n.Property("Middle")],r.prototype,"verticalAlignment",void 0),i([n.Complex(di.stripLineLabelFont,gi)],r.prototype,"textStyle",void 0),i([n.Property("Behind")],r.prototype,"zIndex",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),r}(n.ChildProperty),fy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("Rectangle")],r.prototype,"type",void 0),r}(n.ChildProperty),ey=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),oy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(.7)],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),sy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"dashArray",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),hy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property(5)],r.prototype,"height",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),cy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(.7)],r.prototype,"width",void 0),i([n.Property(5)],r.prototype,"height",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),ly=(n.ChildProperty,function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(null)],r.prototype,"endAngle",void 0),i([n.Property(!1)],r.prototype,"explode",void 0),i([n.Property(!1)],r.prototype,"explodeAll",void 0),i([n.Property(null)],r.prototype,"explodeIndex",void 0),i([n.Property(null)],r.prototype,"innerRadius",void 0),i([n.Property("30%")],r.prototype,"explodeOffset",void 0),i([n.Property(0)],r.prototype,"gapRatio",void 0),i([n.Property("Value")],r.prototype,"groupMode",void 0),i([n.Property(null)],r.prototype,"groupTo",void 0),i([n.Property("20%")],r.prototype,"neckHeight",void 0),i([n.Property("20%")],r.prototype,"neckWidth",void 0),i([n.Property("Linear")],r.prototype,"pyramidMode",void 0),i([n.Property([])],r.prototype,"palettes",void 0),i([n.Property(0)],r.prototype,"startAngle",void 0),i([n.Complex(null,yl)],r.prototype,"animation",void 0),i([n.Complex(null,kv)],r.prototype,"dataLabel",void 0),i([n.Property("0")],r.prototype,"dashArray",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("X")],r.prototype,"segmentAxis",void 0),i([n.Property("Line")],r.prototype,"drawType",void 0),i([n.Property(!0)],r.prototype,"isClosed",void 0),i([n.Collection([],lv)],r.prototype,"segments",void 0),i([n.Property("")],r.prototype,"stackingGroup",void 0),i([n.Complex({color:"transparent",width:0},ai)],r.prototype,"border",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property(1)],r.prototype,"opacity",void 0),i([n.Property("Line")],r.prototype,"type",void 0),i([n.Complex(null,wl)],r.prototype,"marker",void 0),i([n.Complex(null,gv)],r.prototype,"errorBar",void 0),i([n.Property(!0)],r.prototype,"enableTooltip",void 0),i([n.Collection([],ny)],r.prototype,"trendlines",void 0),i([n.Property("")],r.prototype,"tooltipMappingName",void 0),i([n.Property("SeriesType")],r.prototype,"legendShape",void 0),i([n.Property(1)],r.prototype,"minRadius",void 0),i([n.Property(null)],r.prototype,"selectionStyle",void 0),i([n.Property("Natural")],r.prototype,"splineType",void 0),i([n.Property(3)],r.prototype,"maxRadius",void 0),i([n.Property(.5)],r.prototype,"cardinalSplineTension",void 0),i([n.Property(null)],r.prototype,"columnWidth",void 0),i([n.Complex(null,ty)],r.prototype,"emptyPointSettings",void 0),i([n.Complex(null,iy)],r.prototype,"cornerRadius",void 0),i([n.Property(0)],r.prototype,"columnSpacing",void 0),r}(n.ChildProperty)),bl=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("Rotate45")],r.prototype,"labelIntersectAction",void 0),i([n.Complex(di.axisLabelFont,gi)],r.prototype,"labelStyle",void 0),i([n.Property("")],r.prototype,"title",void 0),i([n.Property(null)],r.prototype,"zoomFactor",void 0),i([n.Complex({},ry)],r.prototype,"crosshairTooltip",void 0),i([n.Property("")],r.prototype,"labelFormat",void 0),i([n.Complex(di.axisTitleFont,gi)],r.prototype,"titleStyle",void 0),i([n.Property(!1)],r.prototype,"isIndexed",void 0),i([n.Property(0)],r.prototype,"plotOffset",void 0),i([n.Property("Shift")],r.prototype,"edgeLabelPlacement",void 0),i([n.Property("BetweenTicks")],r.prototype,"labelPlacement",void 0),i([n.Property("Outside")],r.prototype,"tickPosition",void 0),i([n.Property(!1)],r.prototype,"opposedPosition",void 0),i([n.Property(!0)],r.prototype,"visible",void 0),i([n.Property("Outside")],r.prototype,"labelPosition",void 0),i([n.Property(0)],r.prototype,"labelRotation",void 0),i([n.Property(0)],r.prototype,"minorTicksPerInterval",void 0),i([n.Property(null)],r.prototype,"maximum",void 0),i([n.Property(null)],r.prototype,"minimum",void 0),i([n.Property(34)],r.prototype,"maximumLabelWidth",void 0),i([n.Property(null)],r.prototype,"interval",void 0),i([n.Complex({},hy)],r.prototype,"majorTickLines",void 0),i([n.Property(!1)],r.prototype,"enableTrim",void 0),i([n.Complex({},ey)],r.prototype,"majorGridLines",void 0),i([n.Complex({},cy)],r.prototype,"minorTickLines",void 0),i([n.Complex({},sy)],r.prototype,"lineStyle",void 0),i([n.Complex({},oy)],r.prototype,"minorGridLines",void 0),i([n.Property(!1)],r.prototype,"isInversed",void 0),i([n.Property(null)],r.prototype,"description",void 0),i([n.Property(0)],r.prototype,"startAngle",void 0),i([n.Property(100)],r.prototype,"coefficient",void 0),i([n.Collection([],uy)],r.prototype,"stripLines",void 0),i([n.Property(2)],r.prototype,"tabIndex",void 0),i([n.Complex({color:null,width:0,type:"Rectangle"},fy)],r.prototype,"border",void 0),r}(n.ChildProperty),ay=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"enableMarker",void 0),i([n.Property(!0)],r.prototype,"enable",void 0),i([n.Property(null)],r.prototype,"fill",void 0),i([n.Property(!1)],r.prototype,"shared",void 0),i([n.Property(.75)],r.prototype,"opacity",void 0),i([n.Property(null)],r.prototype,"header",void 0),i([n.Property(null)],r.prototype,"format",void 0),i([n.Complex(di.tooltipLabelFont,gi)],r.prototype,"textStyle",void 0),i([n.Property(null)],r.prototype,"template",void 0),i([n.Complex({color:"#cccccc",width:.5},ai)],r.prototype,"border",void 0),i([n.Property(!0)],r.prototype,"enableAnimation",void 0),r}(n.ChildProperty),vy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property("50%")],r.prototype,"x",void 0),i([n.Property("50%")],r.prototype,"y",void 0),r}(n.ChildProperty),yy=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Property(!1)],r.prototype,"enablePinchZooming",void 0),i([n.Property(!0)],r.prototype,"enableSelectionZooming",void 0),i([n.Property(!1)],r.prototype,"enableDeferredZooming",void 0),i([n.Property(!1)],r.prototype,"enableMouseWheelZooming",void 0),i([n.Property("XY")],r.prototype,"mode",void 0),i([n.Property(["Zoom","ZoomIn","ZoomOut","Pan","Reset"])],r.prototype,"toolbarItems",void 0),i([n.Property(!0)],r.prototype,"enableScrollbar",void 0),i([n.Property(!1)],r.prototype,"enablePan",void 0),r}(n.ChildProperty),py=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return w(r,t),i([n.Complex({},ly)],r.prototype,"chartSeries",void 0),i([n.Complex({},bl)],r.prototype,"primaryXAxis",void 0),i([n.Complex({},bl)],r.prototype,"primaryYAxis",void 0),i([n.Property("")],r.prototype,"value",void 0),i([n.Property("")],r.prototype,"columnHeader",void 0),i([n.Property("-")],r.prototype,"columnDelimiter",void 0),i([n.Property(!1)],r.prototype,"enableMultipleAxis",void 0),i([n.Property("Stacked")],r.prototype,"multipleAxisMode",void 0),i([n.Property(!1)],r.prototype,"enableScrollOnMultiAxis",void 0),i([n.Property(!1)],r.prototype,"showMemberSeries",void 0),i([n.Property(!1)],r.prototype,"showPointColorByMembers",void 0),i([n.Complex(di.chartTitleFont,gi)],r.prototype,"titleStyle",void 0),i([n.Property("")],r.prototype,"title",void 0),i([n.Complex(di.chartSubTitleFont,gi)],r.prototype,"subTitleStyle",void 0),i([n.Property("")],r.prototype,"subTitle",void 0),i([n.Complex({color:"#DDDDDD",width:0},ai)],r.prototype,"border",void 0),i([n.Complex({},pl)],r.prototype,"margin",void 0),i([n.Complex({border:{color:null,width:.5},background:"transparent"},yv)],r.prototype,"chartArea",void 0),i([n.Property(null)],r.prototype,"background",void 0),i([n.Property("Material")],r.prototype,"theme",void 0),i([n.Property([])],r.prototype,"palettes",void 0),i([n.Complex({},pv)],r.prototype,"crosshair",void 0),i([n.Complex({},ay)],r.prototype,"tooltip",void 0),i([n.Complex(null,vy)],r.prototype,"pieCenter",void 0),i([n.Complex({},yy)],r.prototype,"zoomSettings",void 0),i([n.Property()],r.prototype,"legendSettings",void 0),i([n.Property("None")],r.prototype,"selectionMode",void 0),i([n.Property("None")],r.prototype,"accumulationSelectionMode",void 0),i([n.Property(!0)],r.prototype,"enableSmartLabels",void 0),i([n.Property(!0)],r.prototype,"enableBorderOnMouseMove",void 0),i([n.Property("None")],r.prototype,"highlightMode",void 0),i([n.Property("None")],r.prototype,"highlightPattern",void 0),i([n.Property(!0)],r.prototype,"enableExport",void 0),i([n.Property(!1)],r.prototype,"isMultiSelect",void 0),i([n.Collection([],vv)],r.prototype,"selectedDataIndexes",void 0),i([n.Property(!0)],r.prototype,"enableAnimation",void 0),i([n.Property(!1)],r.prototype,"enableCanvas",void 0),i([n.Property(!0)],r.prototype,"useGroupingSeparator",void 0),i([n.Property(!1)],r.prototype,"isTransposed",void 0),i([n.Property(1)],r.prototype,"tabIndex",void 0),i([n.Property(null)],r.prototype,"description",void 0),i([n.Event()],r.prototype,"resized",void 0),i([n.Property(!0)],r.prototype,"enableSideBySidePlacement",void 0),i([n.Event()],r.prototype,"loaded",void 0),i([n.Event()],r.prototype,"beforePrint",void 0),i([n.Event()],r.prototype,"animationComplete",void 0),i([n.Event()],r.prototype,"load",void 0),i([n.Event()],r.prototype,"textRender",void 0),i([n.Event()],r.prototype,"legendRender",void 0),i([n.Event()],r.prototype,"seriesRender",void 0),i([n.Event()],r.prototype,"multiLevelLabelRender",void 0),i([n.Event()],r.prototype,"pointRender",void 0),i([n.Event()],r.prototype,"tooltipRender",void 0),i([n.Event()],r.prototype,"legendClick",void 0),i([n.Event()],r.prototype,"axisLabelRender",void 0),i([n.Event()],r.prototype,"multiLevelLabelClick",void 0),i([n.Event()],r.prototype,"chartMouseClick",void 0),i([n.Event()],r.prototype,"chartMouseMove",void 0),i([n.Event()],r.prototype,"pointMove",void 0),i([n.Event()],r.prototype,"pointClick",void 0),i([n.Event()],r.prototype,"chartMouseDown",void 0),i([n.Event()],r.prototype,"chartMouseLeave",void 0),i([n.Event()],r.prototype,"dragComplete",void 0),i([n.Event()],r.prototype,"chartMouseUp",void 0),i([n.Event()],r.prototype,"scrollStart",void 0),i([n.Event()],r.prototype,"zoomComplete",void 0),i([n.Event()],r.prototype,"scrollChanged",void 0),i([n.Event()],r.prototype,"scrollEnd",void 0),i([n.Property(!0)],r.prototype,"showMultiLevelLabels",void 0),r}(n.ChildProperty),fu=function(){function t(){}return t.getCellSets=function(t,i,r,u,f){var s;this.engine=i;this.isMondrian=i.isMondrian;this.isMeasureAvail=i.isMeasureAvail;this.isPaging=i.isPaging;this.pageSettings=i.pageSettings;this.rows=i.rows;this.columns=i.columns;this.values=i.values;this.filters=i.filters;this.allowLabelFilter=i.allowLabelFilter;this.allowValueFilter=i.allowValueFilter;this.valueSortSettings=t.valueSortSettings?t.valueSortSettings:void 0;this.drilledMembers=i.updateDrilledItems(t.drilledMembers);this.calculatedFieldSettings=i.calculatedFieldSettings;this.valueAxis="row"===t.valueAxis?"rows":"columns";u&&(u.axis="row"===u.axis?"rows":"columns");this.filterMembers=n.extend({},i.filterMembers,null,!0);this.fieldDataObj=i.fieldListObj;this.fieldList=i.fieldList;this.cellSetInfo="\nDIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE";var h=this.getMeasuresQuery(this.values),e=this.getDimensionsQuery(this.rows,h,"rows",u).replace(/\&/g,"&amp;"),o=this.getDimensionsQuery(this.columns,h,"columns",u).replace(/\&/g,"&amp;");this.isPaging&&r&&void 0!==this.pageSettings?(e=(s=this.getPagingQuery(e,o)).rowQuery,o=s.columnQuery):this.isPaging&&!r&&void 0!==this.pageSettings&&(e=(s=this.getPagingCountQuery(e,o)).rowQuery,o=s.columnQuery);e=e.length>0?e+(this.isPaging&&!r?"":this.cellSetInfo+" ON ROWS"):"";o=o.length>0?o+(this.isPaging&&!r?"":this.cellSetInfo+" ON COLUMNS"):"";var l=this.getSlicersQuery(this.filters,"filters").replace(/\&/g,"&amp;"),a=this.getfilterQuery(this.filterMembers,t.cube).replace(/\&/g,"&amp;").replace(/\>/g,"&gt;").replace(/\</g,"&lt;"),v=this.getCalculatedFieldQuery(this.calculatedFieldSettings).replace(/\&/g,"&amp;"),c=this.frameMDXQuery(e,o,l,a,v,r),y={catalog:t.catalog,cube:t.cube,url:t.url,request:c,LCID:t.localeIdentifier.toString(),roles:t.roles};i.mdxQuery=c.replace(/\&amp;/g,"&").replace(/\&gt;/g,">").replace(/\&lt;/g,"<").replace(/%280/g,'"');u&&(u.axis="rows"===u.axis?"row":"column");f||this.getTableCellData(y,this.isPaging&&!r?this.engine.generatePagingData.bind(this.engine):this.engine.generateEngine.bind(this.engine),u?{action:u.action,drillInfo:u}:{dataSourceSettings:t,action:"loadTableElements"})},t.getTableCellData=function(n,t,i){var r=this.engine.getConnectionInfo(n.url,n.LCID),u='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header><\/Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement>'+n.request+"<\/Statement> <\/Command> <Properties> <PropertyList> <Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+r.LCID+"<\/LocaleIdentifier>"+(n.roles?"<Roles>"+n.roles+"<\/Roles>":"")+"<\/PropertyList> <\/Properties><\/Execute> <\/Body> <\/Envelope>";this.engine.doAjaxPost("POST",r.url,u,t,i)},t.frameMDXQuery=function(n,t,i,r,u,f){var e=this.isPaging&&!f?""!==u?"":"\nWITH":"\nSelect ";return t.length>0&&(e+=t),n.length>0&&(e=e+(t.length>0?this.isPaging&&!f?"":", ":"")+n),u+e+(this.isPaging&&!f?"\nMEMBER [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] AS Count([e16a30d0-2174-4874-8dae-a5085a75a3e2]) MEMBER [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] AS Count ([d1876d2b-e50e-4547-85fe-5b8ed9d629de])\nSELECT { [Measures].[3d268ce0-664d-4092-b9cb-fece97175006] , [Measures].[8d7fe8c1-f09f-410e-b9ba-eaab75a1fc3e] } ON AXIS(0)":"")+r+i+"\nCELL PROPERTIES VALUE, FORMAT_STRING, FORMATTED_VALUE\n"},t.getPagingQuery=function(n,t){n=n.replace("NON EMPTY ( ","").slice(0,-1);t=t.replace("NON EMPTY ( ","").slice(0,-1);var e=n,i=(this.pageSettings.currentRowPage-1)*this.pageSettings.rowPageSize,r=(this.pageSettings.currentColumnPage-1)*this.pageSettings.columnPageSize,u=3*this.pageSettings.rowPageSize,f=3*this.pageSettings.columnPageSize;return i=this.engine.rowCount<i+u?this.engine.rowCount>u?this.engine.rowCount-u:0:i,this.engine.pageRowStartPos=i,r=this.engine.columnCount<r+f?this.engine.columnCount>f?this.engine.columnCount-f:0:r,this.engine.pageColStartPos=r,{rowQuery:""!==n?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+n+(this.isMondrian||""===t?"":","+t)+")},"+i+","+u+")":"",columnQuery:""!==t?"\nSUBSET ({ "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===e?"":","+e)+")},"+r+","+f+")":""}},t.getPagingCountQuery=function(n,t){n=n.replace("NON EMPTY ( ","").slice(0,-1);t=t.replace("NON EMPTY ( ","").slice(0,-1);var i=n;return{rowQuery:""!==n?"SET [d1876d2b-e50e-4547-85fe-5b8ed9d629de] as "+(this.isMondrian?"":"NONEMPTY")+" ("+n+(this.isMondrian||""===t?"":","+t)+")\n":"",columnQuery:""!==t?"\nSET [e16a30d0-2174-4874-8dae-a5085a75a3e2] as "+(this.isMondrian?"":"NONEMPTY")+" ("+t+(this.isMondrian||""===i?"":","+i)+")\n":""}},t.getDimensionsQuery=function(n,t,i,r){var u="",f,o,e;if(n.length>0){for(u="\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":""),f=0;f<n.length;)0===f?"[measures]"===n[f].name.toLowerCase()?""!==t&&(u+=t):u+="({"+this.getDimensionQuery(n[f],i)+"})":"[measures]"===n[f].name.toLowerCase()?""!==t&&(u=u+" * "+t):u=u+" * ({"+this.getDimensionQuery(n[f],i)+"})",f++;o=this.getDrillQuery(n,t,i,r);u=r&&r.axis===i?"\nNON EMPTY ( "+(this.drilledMembers.length>0?"HIERARCHIZE ({":"")+o.query:u+(""!==o.query?",":"")+o.query;e=this.getAttributeDrillQuery(n,t,i,r);u=(this.valueAxis!==i?this.updateValueSortQuery(u,this.valueSortSettings):u)+(this.isPaging?(""!==e?"-":"")+e:"")+(this.drilledMembers.length>0?"})":"")+(this.isPaging?"":(""!==e?"-":"")+e)+")"}return u},t.getAttributeDrillQuery=function(n,t,i,r){var y,h="",f,c,a,o,u;y=r&&r.axis===i&&"down"===r.action.toLowerCase()?[{name:r.fieldName,items:[r.memberName],delimiter:"~~"}]:this.drilledMembers;for(var p=i===this.valueAxis?this.getMeasurePos(i):0,l=0,w=y;l<w.length;l++)if(f=w[l],this.engine.fieldList[f.name]&&this.engine.fieldList[f.name].isHierarchy)for(c=0,a=f.items;c<a.length;c++){for(var b=a[c],v=[],e=b.split(f.delimiter?f.delimiter:"~~"),s=this.getDrillLevel(n,e),k=this.getDimensionPos(i,f.name),d=n.length-(p>k?1:0),g=!!this.isPaging&&this.isAttributeMemberExist(f.name,b.split(f.delimiter?f.delimiter:"~~"),f.delimiter,e,i);s.level>0&&s.isDrill&&k+1!==p&&!g;){for(o=[],u=0;u<n.length;){if("[measures]"===n[u].name.toLowerCase())""!==t&&o.push(e[u]?"({{"+e[u]+"}})":"("+t+")");else if(e[u]&&(-1!==e[u].indexOf(n[u].name)||n[u].isNamedSet&&this.fieldList[n[u].name]&&-1!==e[u].indexOf(this.fieldList[n[u].name].pid.split("Sets_")[1])))o.push(this.getHierarchyQuery(e[u],!1,!1,!1,s.level,!0));else{if(e[u]||!n[u]){o=[];break}o.push(this.getHierarchyQuery(n[u].name,!!(this.isPaging&&2===s.level||!this.isPaging&&d>u),n[u].isNamedSet,n[u].isCalculatedField,s.level,!1))}u++}o.length>0&&v.push("("+o.join("*")+")");s.level--;d--}v.length>0&&(h=h+(""!==h?"-":"")+v.join(this.isPaging?"+":"-"))}return h},t.getDimensionPos=function(n,t){for(var r=0,u="rows"===n?this.rows:this.columns,i=0;i<u.length;i++)if(u[i].name===t){r=i;break}return r},t.getMeasurePos=function(n){for(var i=0,r="rows"===n?this.rows:this.columns,t=0;t<r.length;t++)if(0===r[t].name.indexOf("[Measures]")){i=t;break}return i},t.getDrillLevel=function(n,t){for(var r=n.length,u=!1,i=0;i<n.length;)t[i]&&-1!==t[i].indexOf(n[i].name)?(r-=1,n[i+1]&&!(n[i+1].isNamedSet||0===n[i+1].name.indexOf("[Measures]")||this.fieldList[n[i+1].name]&&!this.fieldList[n[i+1].name].hasAllMember)&&(u=!0)):(n[i].isNamedSet||0===n[i].name.indexOf("[Measures]")||this.fieldList[n[i].name]&&!this.fieldList[n[i].name].hasAllMember)&&(r-=1),i++;return{level:this.isPaging?2:r,isDrill:u}},t.getHierarchyQuery=function(n,t,i,r,u,f){return n=r?this.fieldList[n].tag:n,!this.fieldList[n]||this.fieldList[n].hasAllMember||i||r?i||r?"({"+n+"})":this.isPaging?"({"+n+(t?".CHILDREN})":f||1!==u?"})":".[All]})"):"({DrilldownLevel({"+n+(t?".CHILDREN":"")+"},,,INCLUDE_CALC_MEMBERS)})":"(("+n+").levels(0).AllMembers)"},t.isAttributeMemberExist=function(n,t,i,r,u){var o,s,f,h,e,c;if(t.splice(r.length-1,1),o=!1,""!==t.join(i)&&(!this.isPaging||1!==t.length||"[Measures]"!==t.join(i))&&this.engine.fieldList[n]&&this.engine.fieldList[n].hasAllMember)for(s=this.getDimensionPos(u,n),f=0;f<this.drilledMembers.length;f++)if(n!==this.drilledMembers[f].name&&this.engine.fieldList[this.drilledMembers[f].name]&&this.engine.fieldList[this.drilledMembers[f].name].isHierarchy)for(h=this.getDimensionPos(u,this.drilledMembers[f].name),e=0;e<this.drilledMembers[f].items.length;e++)if(c=this.getDrillLevel("rows"===u?this.rows:this.columns,this.drilledMembers[f].items[e].split(this.drilledMembers[f].delimiter?this.drilledMembers[f].delimiter:"~~")),(!this.isPaging||h<s&&c.isDrill)&&(0===this.drilledMembers[f].items[e].indexOf(t.join(i))||0===t.join(i).indexOf(this.drilledMembers[f].items[e]))){o=!0;break}return o},t.getDrillQuery=function(n,t,i,r){var l="",b=[],y=[],h=!1,f="",a,p,s,v,w;for(r&&r.axis===i&&"down"===r.action.toLowerCase()?(h=!0,y=[{name:r.fieldName,items:[r.memberName],delimiter:"~~"}]):y=this.drilledMembers,a=0,p=y;a<p.length;a++)if(s=p[a],!this.engine.fieldList[s.name]||!this.engine.fieldList[s.name].isHierarchy)for(v=0,w=s.items;v<w.length;v++){for(var k=w[v],o=[],c=[],u=0,e=k.split(s.delimiter?s.delimiter:"~~"),d=this.isAttributeMemberExist(s.name,k.split(s.delimiter?s.delimiter:"~~"),s.delimiter?s.delimiter:"~~",e,i);u<n.length&&!d;){if(e[u]&&-1!==e[u].indexOf(n[u].name))-1!==e[e.length-1].indexOf(n[u].name)?h?f=f+(""!==f?" * ":"")+"({"+e[u]+".CHILDREN})":(o.push("("+e[u]+".CHILDREN)"),c.push("("+e[u]+")")):"[measures]"===e[u].toLowerCase()&&""!==t?h?f=f+(""!==f?" * ":"")+"("+t+")":(o.push("("+t+")"),c.push("("+t+")")):-1!==e[u].toLowerCase().indexOf("[measures]")?h?f=f+(""!==f?" * ":"")+"({"+e[u]+"})":(o.push("({"+e[u]+"})"),c.push("({"+e[u]+"})")):h?f=f+(""!==f?" * ":"")+"({"+e[u]+"})":(o.push("("+e[u]+")"),c.push("("+e[u]+")"));else{if(e[u]||!n[u]){o=[];break}"[measures]"===n[u].name.toLowerCase()&&""!==t?h?f=f+(""!==f?" * ":"")+"("+t+")":(o.push("("+t+")"),c.push("("+t+")")):h?f=f+(""!==f?" * ":"")+"({"+this.getDimensionQuery(n[u],i)+"})":(o.push("("+this.getDimensionQuery(n[u],i)+")"),c.push("("+this.getDimensionQuery(n[u],i)+")"))}u++}o.length>0&&o.length<e.length&&(o=[],c=[]);l=l+(""!==l&&o.length>0?",":"")+(o.length>0?"("+o.toString()+")":"");c.length>0&&b.push("("+c.toString()+")")}return{query:h?f:l,collection:h?[f]:b}},t.updateValueSortQuery=function(n,t){if(t&&t.measure&&""!==t.measure){var i=this.drilledMembers.length>0?"HIERARCHIZE ({":"",r=this.fieldList[t.measure].isCalculatedField?this.fieldList[t.measure].tag:t.measure;switch(t.sortOrder){case"Ascending":n=(n=n.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), ASC)";break;case"Descending":n=(n=n.replace("NON EMPTY ( "+i,"NON EMPTY ( "+i+" ORDER ({"))+"},("+r+"), DESC)"}}return n},t.getSlicersQuery=function(t,i){var f=this,r="",e=n.extend([],this.rows,null,!0),u;if(e=e.concat(this.columns),t.length>0){for(u=0;u<t.length;)e.filter(function(n){var i=f.getDimensionUniqueName(n.name),r=f.getDimensionUniqueName(t[u].name);return i===r&&!(f.isMondrian&&""===r&&""===i)}).length>0||(void 0===t[u].name||this.filterMembers[t[u].name]?this.filterMembers[t[u].name]&&(r=r+(""!==r?" * ":"")+"{"+this.filterMembers[t[u].name].toString()+"}"):r=r+(""!==r?" * ":"")+"{"+this.getDimensionQuery(t[u],i)+"}"),u++;r=""===r?"":"\nWHERE ("+r.replace(/DrilldownLevel/g,"")+")"}return r},t.getDimensionQuery=function(n,t){var i=n.isCalculatedField?this.fieldList[n.name].tag:n.name;return this.fieldList[n.name].hasAllMember||n.isNamedSet||n.isCalculatedField?n.isNamedSet||n.isCalculatedField?"{"+i+"}":this.isPaging?i+".CHILDREN":"DrilldownLevel({"+i+"}"+("rows"===t||"columns"===t?",,,INCLUDE_CALC_MEMBERS":"")+")":"(("+i+").levels(0).AllMembers)"},t.getDimensionUniqueName=function(n){var f=this.fieldDataObj.hierarchy,i=[],t,r,u;if(f){for(t=0,r=f;t<r.length;t++)u=r[t],u.id.toLowerCase()===n.toLowerCase()&&i.push(u);return i.length>0?i[0].pid:""}return n.split(".")[0]},t.getMeasuresQuery=function(n){var t="",r,f;if(n.length>0){t="{{";for(var i="",u=0,e=n;u<e.length;u++)r=e[u],f=r.isCalculatedField?this.fieldList[r.name].tag:r.name,i=i.length>0?i+", "+f:f;t=t+i+"}}"}return t},t.getfilterQuery=function(n,t){for(var a,d,g,v,nt,ot,y,it,st,p,rt,o,u,w,b,s="\nFROM ["+t+"]",r="\nFROM( SELECT (",c=[],l=[],f=[],e=[],k=0,ft=this.rows;k<ft.length;k++)n[(i=ft[k]).name]&&n[i.name].length>0&&("string"==typeof n[i.name][0]?f.push(n[i.name]):(n[i.name][1]=n[i.name][0].type,c.push(n[i.name]),delete n[i.name]));for(a=0,d=this.columns;a<d.length;a++)n[(i=d[a]).name]&&n[i.name].length>0&&("string"==typeof n[i.name][0]?e.push(n[i.name]):(g=n[i.name],g[1]=g[0].type,c.push(n[i.name]),delete n[i.name]));for(v=0,nt=this.filters;v<nt.length;v++){for(var i=nt[v],h=!1,tt=0,et=this.columns;tt<et.length;tt++)ot=et[tt],h||this.getDimensionUniqueName(ot.name)!==this.getDimensionUniqueName(i.name)||n[i.name]&&(e.push(n[i.name]),h=!0);if(!h)for(y=0,it=this.rows;y<it.length;y++)st=it[y],h||this.getDimensionUniqueName(st.name)!==this.getDimensionUniqueName(i.name)||n[i.name]&&(f.push(n[i.name]),h=!0)}if((this.allowLabelFilter||this.allowValueFilter)&&c.length>0)for(p=0,rt=["Value","Label"];p<rt.length;p++)for(var ct=rt[p],ut=0,ht=c;ut<ht.length;ut++)o=ht[ut],o&&2===o.length&&"string"==typeof o[1]&&o[1]===ct&&l.push(this.getAdvancedFilterQuery(o[0],r,"COLUMNS"));for(u=0,w=e.length;u<w;u++)r=0===u?r+"{"+e[u].toString()+"}":r+",{"+e[u].toString()+"}";for(e.length>0&&(r=f.length>0?r+" ) ON COLUMNS ,(":r+" ) ON COLUMNS"),u=0,w=f.length;u<w;u++)r=u>0?r+",{"+f[u].toString()+"}":r+"{"+f[u].toString()+"}";return r=e.length>0&&f.length>0?r+=") ON ROWS ":0===e.length&&f.length>0?r+") ON COLUMNS ":r,b="",l.length>0&&(b=l.join(" ")+" "+(e.length>0||f.length>0?r:"")+" "+s+Array(l.length+1+(e.length>0||f.length>0?1:0)).join(")")),s=0===e.length&&0===f.length?s:r+s+")",b.length>0?b:s},t.getAdvancedFilterQuery=function(n,t,i){return"\nFROM (SELECT Filter("+n.selectedField+".AllMembers, "+this.getAdvancedFilterCondtions(n.name,n.condition,n.value1,n.value2,n.type,n.measure)+")) on "+i},t.getAdvancedFilterCondtions=function(n,t,i,r,u,f){var e="";switch(t){case"Equals":e="("+("Value"!==u?n+'.CurrentMember.member_caption ="'+i+'"':f+" = "+i);break;case"DoesNotEquals":e="("+("Value"!==u?n+'.CurrentMember.member_caption <>"'+i+'"':f+" <>"+i);break;case"Contains":default:e="( InStr (1,"+n+'.CurrentMember.member_caption,"'+i+'") >0';break;case"DoesNotContains":e="( InStr (1,"+n+'.CurrentMember.member_caption,"'+i+'")=0';break;case"BeginWith":e="( Left ("+n+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotBeginWith":e="( Left ("+n+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"EndsWith":e="( Right ("+n+".CurrentMember.member_caption,"+i.length+')="'+i+'"';break;case"DoesNotEndsWith":e="( Right ("+n+".CurrentMember.member_caption,"+i.length+') <>"'+i+'"';break;case"GreaterThan":e="("+("Value"!==u?n+'.CurrentMember.member_caption >"'+i+'"':f+" >"+i);break;case"GreaterThanOrEqualTo":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"':f+" >="+i);break;case"LessThan":e="("+("Value"!==u?n+'.CurrentMember.member_caption <"'+i+'"':f+" <"+i);break;case"LessThanOrEqualTo":e="("+("Value"!==u?n+'.CurrentMember.member_caption <="'+i+'"':f+" <="+i);break;case"Between":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"AND '+n+'.CurrentMember.member_caption <="'+r+'"':f+" >="+i+" AND "+f+" <="+r);break;case"NotBetween":e="("+("Value"!==u?n+'.CurrentMember.member_caption >="'+i+'"OR '+n+'.CurrentMember.member_caption <="'+r+'"':f+" >="+i+" OR "+f+" <="+r)}return e},t.getCalculatedFieldQuery=function(t){var u="",r,f;if(t.length>0)for(u="\nWITH",r=0,f=t;r<f.length;r++){var i=f[r],o=(i.formula.indexOf("Measure")>-1?"[Measures].":i.hierarchyUniqueName+".")+"["+i.name+"]",e=n.isNullOrUndefined(i.formatString)?null:i.formatString;u+="\nMEMBER "+o+"as ("+i.formula+") "+(n.isNullOrUndefined(e)?"":', FORMAT_STRING ="'+e.trim()+'"')}return u},t}(),kl=function(){function t(){this.fieldList={};this.columnCount=0;this.rowCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.pageColStartPos=0;this.enableSort=!1;this.enableValueSorting=!1;this.dataFields={};this.formatFields={};this.filterMembers={};this.drilledSets={};this.aggregatedValueMatrix=[];this.mappingFields={};this.customRegex=/^(('[^']+'|''|[^*#@0,.])*)(\*.)?((([0#,]*[0,]*[0#]*)(\.[0#]*)?)|([#,]*@+#*))(E\+?0+)?(('[^']+'|''|[^*#@0,.E])*)$/;this.formatRegex=/(^[ncpae]{1})([0-1]?[0-9]|20)?$/i;this.pivotValues=[];this.valueContent=[];this.headerContent=[];this.rowStartPos=0;this.pageRowStartPos=0;this.tupColumnInfo=[];this.tupRowInfo=[];this.gridJSON="";this.namedSetsPosition={};this.colDepth=0;this.totalCollection=[];this.parentObjCollection={};this.curDrillEndPos=-1;this.headerGrouping={};this.lastLevel=[];this.showRowSubTotals=!0;this.showColumnSubTotals=!0;this.hideRowTotalsObject={};this.hideColumnTotalsObject={};this.sortObject={};this.isColDrill=!1}return t.prototype.renderEngine=function(t,i,r){this.isEmptyData=!1;this.getHeaderSortInfo=r;this.mdxQuery="";this.isMeasureAvail=!1;this.allowMemberFilter=!1;this.allowLabelFilter=!1;this.allowValueFilter=!1;this.isMondrian=!1;this.aggregatedValueMatrix=[];this.measureReportItems=[];this.calcChildMembers=[];this.selectedItems=[];this.savedFieldList=void 0;this.savedFieldListData=void 0;this.formatFields={};this.filterMembers={};this.dataFields={};this.valueAxis="";this.columnCount=0;this.rowCount=0;this.colFirstLvl=0;this.rowFirstLvl=0;this.pageColStartPos=0;this.enableValueSorting=!1;this.sortObject={};this.globalize=new n.Internationalization;this.locale=this.globalize.getCulture();this.localeObj=i?i.localeObj:void 0;this.enableValueSorting=!!i&&i.enableValueSorting;t.url&&(this.dataSourceSettings=t,this.valueAxis="row"===t.valueAxis?"row":"column",this.getAxisFields(),this.formats=t.formatSettings?t.formatSettings:[],this.enableSort=void 0===t.enableSorting||t.enableSorting,this.valueSortSettings=t.valueSortSettings?t.valueSortSettings:void 0,this.filterSettings=t.filterSettings?t.filterSettings:[],this.sortSettings=t.sortSettings?t.sortSettings:[],this.allowMemberFilter=!!t.allowMemberFilter,this.allowLabelFilter=!!t.allowLabelFilter,this.allowValueFilter=!!t.allowValueFilter,this.drilledMembers=t.drilledMembers?this.updateDrilledItems(t.drilledMembers):[],this.calculatedFieldSettings=t.calculatedFieldSettings?t.calculatedFieldSettings:[],this.emptyCellTextContent=t.emptyCellsTextContent?t.emptyCellsTextContent:"",this.pageSettings=i?i.pageSettings?i.pageSettings:this.pageSettings:void 0,this.isPaging=!(!this.pageSettings||!i.enablePaging&&!i.enableVirtualization),this.frameSortObject(),this.getFormattedFields(this.formats),this.savedFieldList=i?i.savedFieldList:void 0,this.savedFieldListData=i?i.savedFieldListData:void 0,this.fieldListData=[],this.fieldListObj={},this.setNamedSetsPosition(),this.savedFieldList&&this.savedFieldListData?this.updateFieldlist(!0):this.getFieldList(t),this.loadCalculatedMemberElements(this.calculatedFieldSettings),this.measureReportItems=[],this.updateFilterItems(this.filterSettings),this.generateGridData(t))},t.prototype.generateGridData=function(n,t){var i=!(!t||"navPaging"!==t||!this.isPaging||void 0===this.pageSettings);this.rows.length>0||this.columns.length>0||this.values.length>0||this.filters.length>0?fu.getCellSets(n,this,i):(fu.getCellSets(n,this,!0,void 0,!0),this.generateEngine(void 0,void 0,{dataSourceSettings:n,action:"loadTableElements"}))},t.prototype.generatePagingData=function(n,t,i){var u=[].slice.call(n.querySelectorAll("Axes, CellData")),r=u[1]?u[1].querySelectorAll("FmtValue"):null,f;r&&r.length>0&&(this.columnCount=Number(r[0].textContent),this.rowCount=Number(r[1].textContent));f=i.dataSourceSettings;fu.getCellSets(f,this,!0)},t.prototype.scrollPage=function(){fu.getCellSets(this.dataSourceSettings,this,!0)},t.prototype.generateEngine=function(t,i,r){var h,e,o;"down"!==r.action&&(this.pivotValues=[],this.valueContent=[],this.headerContent=[],this.colDepth=0,this.tupColumnInfo=[],this.tupRowInfo=[],this.colMeasures={},this.colMeasurePos=void 0,this.rowMeasurePos=void 0,this.rowStartPos=-1);this.xmlDoc=t?t.cloneNode(!0):void 0;this.request=i;this.customArgs=r;this.totalCollection=[];this.parentObjCollection={};this.curDrillEndPos=-1;this.onDemandDrillEngine=[];this.getSubTotalsVisibility();this.xmlaCellSet=t?t.querySelectorAll("Axes, CellData"):void 0;var u=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis0"] Tuple')):[],s=this.xmlaCellSet&&this.xmlaCellSet.length>0?[].slice.call(this.xmlaCellSet[0].querySelectorAll('Axis[name|="Axis1"] Tuple')):[],f=this.xmlaCellSet&&this.xmlaCellSet.length>1?[].slice.call(this.xmlaCellSet[1].querySelectorAll("Cell")):[];if(this.drilledMembers.length>0&&(h=this.getMeasureInfo(),e=void 0,u=(e=this.frameMeasureOrder(h,"column",u,f,u.length)).orderedHeaderTuples,f=e.orderedValueTuples,s=(e=this.frameMeasureOrder(h,"row",s,f,u.length)).orderedHeaderTuples,f=e.orderedValueTuples),"down"===r.action&&this.updateTupCollection("row"===r.drillInfo.axis?s.length:u.length),"down"===r.action&&"column"!==r.drillInfo.axis||(this.olapValueAxis=n.isNullOrUndefined(this.getValueAxis(void 0,void 0))?"column":"row",this.frameColumnHeader(u),this.isPaging||this.performColumnSorting()),"down"===r.action&&"row"!==r.drillInfo.axis||(this.frameRowHeader(s),this.isPaging||this.performRowSorting()),this.frameValues(f,u.length),this.performColumnSpanning(),!this.isPaging&&this.enableSort)for(o=0;o<this.headerContent.length;o++)this.headerContent[o]=this.pivotValues[o];this.isEngineUpdated=!0;this.isEmptyData=0===u.length},t.prototype.getSubTotalsVisibility=function(){var i,n,t;this.showRowSubTotals=this.dataSourceSettings.showRowSubTotals&&this.dataSourceSettings.showSubTotals;this.showColumnSubTotals=this.dataSourceSettings.showColumnSubTotals&&this.dataSourceSettings.showSubTotals;this.showSubTotalsAtTop=this.showColumnSubTotals&&"Top"===this.dataSourceSettings.subTotalsPosition;this.showSubTotalsAtBottom=this.showRowSubTotals&&"Bottom"===this.dataSourceSettings.subTotalsPosition;this.hideRowTotalsObject={};this.hideColumnTotalsObject={};i=1;do{if(1===i){if(this.showColumnSubTotals)for(n=0;n<this.dataSourceSettings.columns.length;n++)!1===this.dataSourceSettings.columns[n].showSubTotals&&(this.hideColumnTotalsObject[this.dataSourceSettings.columns[n].name]=n)}else if(this.showRowSubTotals)for(t=0;t<this.dataSourceSettings.rows.length;t++)!1===this.dataSourceSettings.rows[t].showSubTotals&&(this.hideRowTotalsObject[this.dataSourceSettings.rows[t].name]=t);i++}while(i<3)},t.prototype.frameRowHeader=function(n){var wt=this,u,at,w,v,vt,tt,ni,g,ti,yt,et,pt,f,ot;this.headerGrouping={};this.lastLevel=[];var bt=!0,r=this.pivotValues.length,e=[],c=[];"down"!==this.customArgs.action?(e=this.pivotValues,c=this.valueContent):r=this.customArgs.drillInfo.currentCell.rowIndex+1;this.rowStartPos=this.rowStartPos>0?this.rowStartPos:r;for(var st,ht,o,y,i=0,rt=[],p={},ui=[],ct=!1,ut=-1,lt=-1,kt=[],h=[{axis:"row",colIndex:0,formattedText:"Grand Total",hasChild:!1,level:-1,rowIndex:0,index:[],type:"grand sum",ordinal:0,colSpan:1,rowSpan:1,memberType:2,isDrilled:!1,valueSort:{"Grand Total":1,levelName:"Grand Total"}}],dt=[],fi=this.customArgs.drillInfo&&"row"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<n.length;)u=n[i].querySelectorAll("Member"),dt=this.frameTupCollection(u,dt,i+fi,this.tupRowInfo,this.showRowSubTotals,this.hideRowTotalsObject,"row"),i++;i=0;at=n.length;"down"===this.customArgs.action&&(w=this.customArgs.drillInfo.currentCell.ordinal+1,i=w,at+=w,ht=this.tupRowInfo[w-1].allCount,st=this.tupRowInfo[w-1].allStartPos,y=this.tupRowInfo[w-1]);for(var ei=i,l=0,gt=!1,ft=[];i<at;){u=n["down"===this.customArgs.action?i-(this.customArgs.drillInfo.currentCell.ordinal+1):i].querySelectorAll("Member");var t=0,b=void 0,k=this.tupRowInfo[i].allCount,a=this.tupRowInfo[i].allStartPos,d=this.tupRowInfo[i].measure,s=this.tupRowInfo[i].typeCollection,nt=this.tupRowInfo[i].drillStartPos,oi=this.tupRowInfo[i].startDrillUniquename;if(0===i||i===ei){for(v="down"===this.customArgs.action?this.tupRowInfo[0].members:u;t<v.length;)kt[t]="1"===v[t].querySelector("MEMBER_TYPE").textContent&&0===Number(v[t].querySelector("LNum").textContent)?0:Number(v[t].querySelector("LNum").textContent),"1"===v[t].querySelector("MEMBER_TYPE").textContent?(p[t]=0,ut=-1===ut?t:ut,lt=t):(p[t]=1,ct="3"!==v[t].querySelector("MEMBER_TYPE").textContent||ct),t++;o=s.indexOf("3")}if(t=0,0===i&&(u.length>k+(d?1:0)||1===u.length&&d)&&h.pop(),0===i&&this.isPaging?0===h.length:!ct||k===ht||a!==st||1===u.length&&d){if(vt=this.checkAttributeDrill(this.tupRowInfo[i].drillInfo,"rows"),tt=!(nt>-1)||!(k>0)||vt||a>nt,tt=y&&tt&&nt>-1?y.startDrillUniquename!==oi||!(lt>y.measurePosition||y.measureName===this.tupRowInfo[i].measureName||a!==nt+1&&this.tupRowInfo[i].measurePosition!==nt+1):tt,ni=!(ut>-1&&k>0)||vt||a>lt,(gt="Top"===this.dataSourceSettings.grandTotalsPosition&&0===this.olapRowValueIndex&&"row"===this.olapValueAxis&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1))&&1===h.length&&(h=this.frameGrandTotalValues(n,h,s,o)),u.length===k+(d?1:0)&&d&&!gt)g="Grand Total."+u[o].querySelector("Caption").textContent,ti="3"===s[o]&&this.dataFields[this.getUniqueName(u[o].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(u[o].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(u[o].querySelector("UName").textContent)].caption:u[o].querySelector("Caption").textContent,(h=this.frameGrandTotalAxisSet(h,this.getUniqueName(u[o].querySelector("UName").textContent),ti,r,i,Number(s[o]),u[o].querySelector("PARENT_UNIQUE_NAME")?u[o].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,u[o].querySelector("LName").textContent,u[o].getAttribute("Hierarchy"),{levelName:g,axis:u[o].getAttribute("Hierarchy")}))[h.length-1].valueSort["Grand Total."+u[o].querySelector("Caption").textContent]=1;else if(0!==a&&(0!==o||1!==a)&&tt&&ni){for("Top"===this.dataSourceSettings.grandTotalsPosition&&bt&&this.dataSourceSettings.showGrandTotals&&("row"!==this.olapValueAxis||this.dataSourceSettings.rows.length>1)&&(this.insertRowGrandTotal(h,c,e,n,r),r=this.pivotValues.length,bt=!1),y=this.tupRowInfo[i],yt=r,et=t,b={},pt=!1;t<u.length;){if(f=u[t],f.querySelector("UName").textContent===rt[t]||"2"===s[t]||(Object.keys(b).length>0?b.isDrilled&&!this.fieldList[b.hierarchy].isHierarchy:pt)&&("3"!==s[t]||!p[t-1]||0===p[t+1]))"2"===s[t]?et=t:this.tupRowInfo[i].drillInfo[t].isDrilled&&0===p[t]&&(pt=!0);else{var ii=Number(f.querySelector("LNum").textContent)-(p[t]&&"3"!==s[t]?1:kt[t]),si=!!this.namedSetsPosition.row[t],it=this.getUniqueName(f.querySelector("UName").textContent),ri=this.getDepth(this.tupRowInfo[i],it,Number(s[t]));if(g=this.getCaptionCollectionWithMeasure(this.tupRowInfo[i]),this.showSubTotalsAtBottom&&r>this.rowStartPos&&(yt=r=this.insertRowSubTotal(e,c,ft,r,ii,g)),!(this.isPaging&&e[l][0]&&this.fieldList[e[l][0].hierarchy]&&this.fieldList[e[l][0].hierarchy].isHierarchy&&e[l][0].hasChild&&!e[l][0].isDrilled&&!this.rows[t].isNamedSet&&(0===this.rows[t].name.indexOf("[Measures]")||this.fieldList[f.getAttribute("Hierarchy")]&&(this.fieldList[f.getAttribute("Hierarchy")].isHierarchy||this.fieldList[f.getAttribute("Hierarchy")].hasAllMember))&&e[l][0].depth<ri)){for(e[r]=[{axis:"row",actualText:it,colIndex:0,formattedText:"3"===s[t]&&this.dataFields[it]&&this.dataFields[it].caption?this.dataFields[it].caption:f.querySelector("Caption").textContent,hasChild:!!(this.fieldList[f.getAttribute("Hierarchy")]&&this.fieldList[f.getAttribute("Hierarchy")].isHierarchy&&t<this.rows.length-1&&!this.rows[t+1].isNamedSet&&this.rows[t+1].name.indexOf("[Measures]")<0&&this.fieldList[this.rows[t+1].name]&&this.fieldList[this.rows[t+1].name].hasAllMember)||Number(f.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:ii,depth:ri,rowIndex:r,index:[],ordinal:i,type:"header",colSpan:1,rowSpan:1,memberType:Number(s[t]),isDrilled:!(!this.fieldList[f.getAttribute("Hierarchy")]||!this.fieldList[f.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(f.getAttribute("Hierarchy"),this.tupRowInfo[i].drillInfo,"rows"))||this.tupRowInfo[i].drillInfo[t].isDrilled,parentUniqueName:f.querySelector("PARENT_UNIQUE_NAME")?f.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:f.querySelector("LName").textContent,hierarchy:f.getAttribute("Hierarchy"),isNamedSet:si,valueSort:{levelName:"",axis:f.getAttribute("Hierarchy")}}],(b="3"!==s[t]?e[r][0]:b)||ui.push(f.querySelector("Caption").textContent),e[r][0].valueSort.levelName=g,e[r][0].valueSort[g]=1,c[r-this.rowStartPos]={},c[r-this.rowStartPos][0]=e[r][0],d&&o>t&&(rt[o]=""),ot=t+1;ot<u.length;ot++)rt[ot]="";rt[t]=f.querySelector("UName").textContent;l=3!==Number(s[t])?r:l;r++;et=t}}this.tupRowInfo[i].drillInfo[t].isDrilled&&this.tupRowInfo[i].showTotals&&(this.tupRowInfo[i].showTotals=!!this.showRowSubTotals&&void 0===this.hideRowTotalsObject[this.tupRowInfo[i].drillInfo[t].hierarchy]);t++}yt<r&&et>=u.length-1&&(e[r-1][0].ordinal=i,"header"===e[r-1][0].type&&delete e[r-1][0].type)}ht=k;st=a}i++}this.showSubTotalsAtBottom&&ft.length>0&&(ft.reverse(),ft.forEach(function(n){e[r]=[n];c[r-wt.rowStartPos]={};c[r-wt.rowStartPos][0]=e[r][0];r++}));("Top"!==this.dataSourceSettings.grandTotalsPosition||"row"===this.olapValueAxis&&1===this.dataSourceSettings.rows.length&&"Top"===this.dataSourceSettings.grandTotalsPosition||0===this.dataSourceSettings.rows.length)&&this.insertRowGrandTotal(h,c,e,n,r)},t.prototype.insertRowSubTotal=function(n,t,i,u,f,e){var o=r.frameHeaderWithKeys(n[u-1][0]),s,c,h,a;if(o.level<f&&"grand sum"!==o.type&&(o.isDrilled||3===o.memberType))if(3===o.memberType){for(s=[],c=1;3===n[u-c][0].memberType;)s[s.length]=n[u-c][0],c++;if(n[u-c][0].isDrilled&&0!==s.length){for(h=0,a=s.length;h<a;h++)s[h].formattedText=n[u-c][0].formattedText+" "+s[h].formattedText,s[h].isSum=!0,s[h].type="sum",s[h].parentUniqueName=n[u-c][0].levelUniqueName,i[i.length]=s[h];u-=--c}}else o.hasChild=!1,o.isDrilled=!1,o.isSum=!0,o.type="sum",o.formattedText=o.formattedText+" Total",i[Object.keys(i).length]=o;if(i.length>0)for(var l=i.length-1,v=i[l].valueSort.levelName.split(".").length,y=e.split(".").length;v>=y&&(n[u]=[i[l]],t[u-this.rowStartPos]={},t[u-this.rowStartPos][0]=n[u][0],u++,i.splice(i.length-1,1),Object.keys(i).length>0);)v=i[--l].valueSort.levelName.split(".").length;return u},t.prototype.insertRowGrandTotal=function(n,t,i,r,u){if(n.length>1&&3!==n[0].memberType&&(n[0].ordinal=-1),"down"!==this.customArgs.action){if(this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals)for(var f=0;f<n.length;f++)n[f].rowIndex=u,i[u]=[n[f]],t[u-this.rowStartPos]={},t[u-this.rowStartPos][0]=i[u][0],u++}else this.updateRowEngine(i,t,r.length),this.onDemandDrillEngine=i;return n},t.prototype.getValueAxis=function(n,t){this.olapValueAxis=n;this.olapRowValueIndex=t;for(var i=0;i<this.dataSourceSettings.rows.length;i++)if("[Measures]"===this.dataSourceSettings.rows[i].name){this.olapValueAxis="row";this.olapRowValueIndex=i;break}return this.olapValueAxis},t.prototype.frameGrandTotalAxisSet=function(n,t,i,r,u,f,e,o,s,h){return n.push({axis:"row",actualText:t,colIndex:0,formattedText:i,hasChild:!1,level:-1,rowIndex:r,index:[],ordinal:u,colSpan:1,rowSpan:1,memberType:f,isDrilled:!1,parentUniqueName:e,levelUniqueName:o,hierarchy:s,valueSort:h}),n},t.prototype.getDepth=function(n,t,i){var e=n.uNameCollection.indexOf(t),r=(n.uNameCollection.substring(0,e)+(3===i?"":t)).split("::[").map(function(n){return"["===n[0]?n:"["+n}),f,u;for(3===i&&this.rowMeasurePos===r.length&&r.push(t),f=-1,u=0;u<r.length;u++)f+=r[u].split("~~").length;return f},t.prototype.checkAttributeDrill=function(n,t){for(var r=!1,i=0;i<n.length&&!(r=this.isAttributeDrill(n[i].hierarchy,n,t));i++);return r},t.prototype.frameTupCollection=function(t,i,r,u,f,e,o){for(var k,a,ht,ct,d,v,kt,lt,p,g,at,vt,gt,rt,ut,w,yt,pt,nt,s=0,ft=0,et=[],wt=[],ot=[],b="",tt="",bt=!0,st=-1;s<t.length;){var c=t[s],h=Number(c.querySelector("LNum").textContent),y=c.querySelector("UName").textContent;if(Number(c.querySelector("MEMBER_TYPE").textContent)>3&&(c.querySelector("MEMBER_TYPE").textContent=0===y.indexOf("[Measures]")?"3":"1"),k=0===y.indexOf("[Measures]")?"3":Number(c.querySelector("MEMBER_TYPE").textContent)>3?"1":c.querySelector("MEMBER_TYPE").textContent,a=c.querySelector("Caption").textContent,this.fieldList[a]&&"CalculatedField"===this.fieldList[a].type&&(a=this.fieldList[a].caption,c.querySelector("Caption").textContent=a),ht=c.getAttribute("Hierarchy"),ct=c.querySelector("PARENT_UNIQUE_NAME")?c.querySelector("PARENT_UNIQUE_NAME").textContent:"","2"===k?(this.isPaging||ft++,w=n.isNullOrUndefined(w)?s:w):"3"===k?(yt=c,pt=y,nt=s,"column"===o?(this.colMeasures[y]=c,this.colMeasurePos=s):this.rowMeasurePos=s):st=e[ht],"2"!==k){if(this.headerGrouping[s]){if(h>this.lastLevel[s])this.lastLevel[s]=h;else if(h<this.lastLevel[s]){for(d=this.lastLevel[s];d>=h;)delete this.headerGrouping[s].UName[d],delete this.headerGrouping[s].Caption[d],d--;this.lastLevel[s]=h}this.headerGrouping[s].UName[h]=y;this.headerGrouping[s].Caption[h]=a}else this.lastLevel[s]=h,this.headerGrouping[s]={UName:(rt={},rt[h]=y,rt),Caption:(ut={},ut[h]=a,ut)};if(this.isPaging)for(v=ct;this.drilledSets[v];)kt=this.drilledSets[v].querySelector("Caption").textContent,lt=Number(this.drilledSets[v].querySelector("LNum").textContent),this.headerGrouping[s].UName[lt]=v,this.headerGrouping[s].Caption[lt]=kt,v=null===this.drilledSets[v].querySelector("PARENT_UNIQUE_NAME")?"":this.drilledSets[v].querySelector("PARENT_UNIQUE_NAME").textContent;for(var it="",dt=Object.keys(this.headerGrouping[s].UName),l=0;l<dt.length;l++)p=dt[l],it=0===l?this.headerGrouping[s].UName[p]:it+"~~"+this.headerGrouping[s].UName[p];for(b=""===b?it:b+"::"+it,g="",at=Object.keys(this.headerGrouping[s].Caption),l=0;l<at.length;l++)p=at[l],g=0===l?this.headerGrouping[s].Caption[p]:g+"~~"+this.headerGrouping[s].Caption[p];s!==nt&&(tt=""===tt?g:tt+"::"+g)}(et.push(k),wt.push(h),(n.isNullOrUndefined(i[s])||i[s]<h)&&(i[s]=h),ot.push({level:h,uName:y,hierarchy:ht,isDrilled:!1}),u[r-1]&&"1"===u[r-1].typeCollection[s]&&ot[s].level>u[r-1].drillInfo[s].level)&&(vt=b.split(/~~|::\[/).map(function(n){return"["===n[0]?n:"["+n}),vt.pop(),gt=vt.join("~~"),this.setDrillInfo(ct,gt,s,r,u));s++}return st>-1&&(bt="2"!==et[st+1]),u[r]={allCount:ft,allStartPos:w,measure:yt,measureName:pt,measurePosition:nt,members:t,typeCollection:et,uNameCollection:b,captionCollection:tt,levelCollection:wt,drillInfo:ot,drillStartPos:-1,drillEndPos:-1,showTotals:!(!f&&ft>0&&w>(0===nt?1:0))&&bt},i},t.prototype.getCaptionCollectionWithMeasure=function(n){var t=n.captionCollection,r,u,i;return n.measure?(r=n.measure.querySelector("Caption").textContent,u=n.uNameCollection.split(/[~~::]+/g).indexOf(n.measureName),(i=n.captionCollection.split(/[~~::]+/g)).splice(u,0,r),t=i.join(".")):t=(i=n.captionCollection.split(/[~~::]+/g)).join("."),t},t.prototype.setNamedSetsPosition=function(){var n;this.namedSetsPosition={};n=0;do{for(var r={},i=n?this.dataSourceSettings.rows:this.dataSourceSettings.columns,t=0;t<i.length;t++)i[t].isNamedSet&&(r[t]=i[t].name);this.namedSetsPosition[n?"row":"column"]=r;n++}while(n<2)},t.prototype.updateRowEngine=function(n,t,i){for(var u,r=this.pivotValues.length-1,f=Object.keys(n).length;r>this.customArgs.drillInfo.currentCell.rowIndex;)this.pivotValues[r+f]=this.pivotValues[r],this.pivotValues[r+f][0].ordinal+=i,this.pivotValues[r+f][0].rowIndex+=f,this.valueContent[r+f-this.rowStartPos]=this.valueContent[r-this.rowStartPos],r--;for(u=0;u<n.length;u++)this.pivotValues[u]=n[u],this.valueContent[Number(u)-this.rowStartPos]=t[Number(u)-this.rowStartPos];this.pivotValues[this.customArgs.drillInfo.currentCell.rowIndex][0].isDrilled=!0},t.prototype.updateTupCollection=function(n){for(var i="row"===this.customArgs.drillInfo.axis?this.tupRowInfo:this.tupColumnInfo,t=i.length-1;t>this.customArgs.drillInfo.currentCell.ordinal;)i[t+n]=i[t],t--},t.prototype.frameGrandTotalValues=function(n,t,i,r){for(var c,l,u=0,o=!1;u<n.length&&!o;){var f=n["down"===this.customArgs.action?u-(this.customArgs.drillInfo.currentCell.ordinal+1):u].querySelectorAll("Member"),s=this.tupRowInfo[u].allCount,e=(this.tupRowInfo[u].allStartPos,this.tupRowInfo[u].measure),h=this.tupRowInfo[u].typeCollection;(this.tupRowInfo[u].drillStartPos,this.tupRowInfo[u].startDrillUniquename,0===u&&(f.length>s+(e?1:0)||1===f.length&&e)&&t.pop(),(0!==u||!this.isPaging||0===t.length)&&(this.checkAttributeDrill(this.tupRowInfo[u].drillInfo,"rows"),f.length===s+(e?1:0)&&e))&&(c="Grand Total."+f[r].querySelector("Caption").textContent,l="3"===h[r]&&this.dataFields[this.getUniqueName(f[r].querySelector("UName").textContent)]&&this.dataFields[this.getUniqueName(f[r].querySelector("UName").textContent)].caption?this.dataFields[this.getUniqueName(f[r].querySelector("UName").textContent)].caption:f[r].querySelector("Caption").textContent,(t=this.frameGrandTotalAxisSet(t,this.getUniqueName(f[r].querySelector("UName").textContent),l,this.pivotValues.length,u,Number(h[r]),f[r].querySelector("PARENT_UNIQUE_NAME")?f[r].querySelector("PARENT_UNIQUE_NAME").textContent:void 0,f[r].querySelector("LName").textContent,f[r].getAttribute("Hierarchy"),{levelName:c,axis:f[r].getAttribute("Hierarchy")}))[t.length-1].valueSort["Grand Total."+f[r].querySelector("Caption").textContent]=1);o=this.dataSourceSettings.values.length+1===t.length;u++}return t},t.prototype.frameColumnHeader=function(n){var d=this,h,f,p,b,c,k;this.headerGrouping={};this.lastLevel=[];for(var i=0,e=[],o=[],s=[],v=-1,y=-1,g=this.customArgs.drillInfo&&"column"===this.customArgs.drillInfo.axis?this.customArgs.drillInfo.currentCell.ordinal+1:0;i<n.length;)h=n[i].querySelectorAll("Member"),e=this.frameTupCollection(h,e,i+g,this.tupColumnInfo,this.showColumnSubTotals,this.hideColumnTotalsObject,"column"),i++;if(n.length>0)for(h=n[0].querySelectorAll("Member"),f=0;f<h.length;)s[f]="1"===h[f].querySelector("MEMBER_TYPE").textContent&&0===Number(h[f].querySelector("LNum").textContent)?0:Number(h[f].querySelector("LNum").textContent),"1"!==h[f].querySelector("MEMBER_TYPE").textContent||!this.isPaging&&0!==Number(h[f].querySelector("LNum").textContent)?o[f]=1:(o[f]=0,v=-1===v?f:v,y=f),f++;i=0;for(var w,u=1,r={},l=!0,a=!1,nt=function(){var p=n[i].querySelectorAll("Member"),f=t.tupColumnInfo[i].allCount,c=t.tupColumnInfo[i].allStartPos,lt=t.tupColumnInfo[i].measure,tt=t.tupColumnInfo[i].typeCollection,k=t.tupColumnInfo[i].drillInfo,b=t.tupColumnInfo[i].drillStartPos,it=t.tupColumnInfo[i].startDrillUniquename,ut=t.tupColumnInfo[i].endDrillUniquename,at=t.tupColumnInfo[i].drillEndPos,ot=t.tupColumnInfo[i].levelCollection,nt="2"!==tt[0]&&("3"!==tt[0]||"2"!==tt[1]),ft=0,g,et,rt,h,st,ht,ct;if(e.map(function(n,t){ft+=0===o[t]?n+(1-(s[t]>1?1:s[t])):0===n?d.isPaging&&"2"===tt[t]?0:1:n}),t.colDepth=t.colDepth>ft?t.colDepth:ft,0===i&&p.length>f+(lt?1:0)&&(a=!0,nt=f>0&&nt?c>v:nt),g=!1,"Top"===t.dataSourceSettings.grandTotalsPosition&&t.dataSourceSettings.showGrandTotals&&t.dataSourceSettings.showColumnGrandTotals){for(et=0,rt=0;rt<p.length;rt++)0===p[rt].querySelector("Caption").textContent.indexOf("All")&&et++;g=et===("column"===t.olapValueAxis?t.dataSourceSettings.columns.length-1:t.dataSourceSettings.columns.length)}(nt||g)&&(0===f||g)&&(h=[-1,-1,-1],t.tupColumnInfo[i-1]&&0===t.tupColumnInfo[i-1].allCount?h=t.levelCompare(ot,t.tupColumnInfo[i-1].levelCollection):a&&w&&(h=t.levelCompare(ot,w.levelCollection)),t.tupColumnInfo[i].drillStartPos<0||t.showSubTotalsAtTop?(!l&&h[0]>-1&&h[2]>-1&&(u=t.mergeTotCollection(u,f,e,s,o,c,k,h)),t.setParentCollection(p),t.frameCommonColumnLoop(p,i,u,e,o,s),t.tupColumnInfo[i].showTotals||u--,!l&&h[0]>-1&&h[2]>-1&&(u=t.mergeTotCollection(u,f,e,s,o,c,k,h)),l=!1,t.isColDrill?t.isColDrill=!1:u++):r.drillStartPos===b&&r.startDrillUniquename===it&&r.allCount!==f||(!l&&h[0]>-1&&h[2]>-1&&(u=t.mergeTotCollection(u,f,e,s,o,c,k,h),l=!0),t.setParentCollection(p),(!a||y<=b)&&(g||(t.totalCollection[t.totalCollection.length]={allCount:f,ordinal:i,members:p,drillInfo:k}),r.allCount=f,r.allStartPos=c,r.drillStartPos=b,r.startDrillUniquename=it,r.endDrillUniquename=ut)),w=t.tupColumnInfo[i]);st=t.checkAttributeDrill(t.tupColumnInfo[i].drillInfo,"columns");f>0&&(!a||nt&&(st||y<c))&&(f===r.allCount||c!==r.allStartPos)&&(ht=at===b||r.endDrillUniquename===ut,ct=c!==r.allStartPos?r.startDrillUniquename!==it:ht,b>-1&&!ct||(l||(u=t.mergeTotCollection(u,f,e,s,o,c,k),l=!0),t.setParentCollection(p),a&&b>-1&&!(y<=b)||(g||(t.totalCollection[t.totalCollection.length]={allCount:f,ordinal:i,members:p,allStartPos:c,drillInfo:k}),r.allCount=f,r.allStartPos=c,r.drillStartPos=b,r.startDrillUniquename=it,r.endDrillUniquename=ut)));i++},t=this;i<n.length;)nt();if(this.totalCollection.length>0)if(Object.keys(this.colMeasures).length>1)this.orderTotals(u,e,o,s);else for(this.totalCollection=this.totalCollection.reverse(),p=0,b=this.totalCollection;p<b.length;p++)c=b[p],(0===this.tupColumnInfo[c.ordinal].measurePosition?1===this.tupColumnInfo[c.ordinal].allStartPos:0===this.tupColumnInfo[c.ordinal].allStartPos)&&(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||(this.frameCommonColumnLoop(c.members,c.ordinal,u,e,s,o),k=this.checkAttributeDrill(this.tupColumnInfo[c.ordinal].drillInfo,"columns"),(this.tupColumnInfo[c.ordinal].showTotals||k)&&u++)},t.prototype.orderTotals=function(n,t,i,r){for(var u,e,v,s,h,l,f={},o=1,c=0,a=this.totalCollection;c<a.length;c++)u=a[c],(0===this.tupColumnInfo[u.ordinal].measurePosition?1===this.tupColumnInfo[u.ordinal].allStartPos:0===this.tupColumnInfo[u.ordinal].allStartPos)&&(!this.dataSourceSettings.showGrandTotals||!this.dataSourceSettings.showColumnGrandTotals)||(e=this.tupColumnInfo[u.ordinal].measure.querySelector("UName").textContent,f[e]?(f[e].coll.push(u),f[e].count++,o=o<f[e].count?f[e].count:o):f[e]={coll:[u],count:1});for(v=Object.keys(f),s=o-1;s>-1;){for(h=0,l=v;h<l.length;h++)(u=f[l[h]].coll[s])&&(this.frameCommonColumnLoop(u.members,u.ordinal,n,t,i,r),this.tupColumnInfo[u.ordinal].showTotals&&n++);s--}},t.prototype.setParentCollection=function(n){for(var o,u,t=0;n.length>t;){var i=n[t],s=Number(i.querySelector("MEMBER_TYPE").textContent)>2?"3":i.querySelector("MEMBER_TYPE").textContent,r=Number(i.querySelector("LNum").textContent),h=i.querySelector("UName").textContent,c=i.querySelector("PARENT_UNIQUE_NAME")?i.querySelector("PARENT_UNIQUE_NAME").textContent:"",f=!0,e=!1;this.parentObjCollection[t]&&(o=Object.keys(this.parentObjCollection[t]),u=this.parentObjCollection[t][r-1],f=u?c===u.querySelector("UName").textContent:0===o.length,e="1"===this.tupColumnInfo[0].typeCollection[t]);"2"===s?delete this.parentObjCollection[t]:(!this.isPaging&&!e||f||delete this.parentObjCollection[t],this.parentObjCollection[t]?this.parentObjCollection[t][r]&&this.parentObjCollection[t][r].querySelector("UName").textContent===h||(this.parentObjCollection[t][r]=i):(this.parentObjCollection[t]={},this.parentObjCollection[t][r]=i));t++}},t.prototype.setDrillInfo=function(n,t,i,r,u){for(r--;u[r]&&u[r].drillInfo[i].uName===n&&!(u[r].uNameCollection.split(/~~|::\[/).map(function(n){return"["===n[0]?n:"["+n}).join("~~").indexOf(t)<0);)u[r].drillInfo[i].isDrilled=!0,this.curDrillEndPos<=i&&(u[r].drillEndPos=this.curDrillEndPos=i,u[r].endDrillUniquename=n),(u[r].drillStartPos>i||-1===u[r].drillStartPos)&&(u[r].drillStartPos=i),u[r].startDrillUniquename=n,r--},t.prototype.levelCompare=function(n,t){for(var r=[-1,0],i=0;i<t.length;i++)if(n[i]!==t[i]){r=[i,n[i],t[i]-n[i]];break}return r},t.prototype.mergeTotCollection=function(t,i,r,u,f,e,o,s){for(var h,a,tt,p,w,k,l,v=n.isNullOrUndefined(e)?s[0]:e-(this.colMeasurePos===e-1?2:1),d=o[v]&&o[v].level,it=this.getLevelsAsString(v-1,o),c={},y=1,g=!1,b=0,nt=this.totalCollection;b<nt.length;b++)h=nt[b],(g||h.allCount<=i&&(!(d>-1&&h.drillInfo[v])||h.drillInfo[v].level>=d&&this.getLevelsAsString(v-1,h.drillInfo)===it))&&(a=this.tupColumnInfo[h.ordinal].measure?this.tupColumnInfo[h.ordinal].measure.querySelector("UName").textContent:"measure",c[a]?(c[a].coll.push(h),c[a].count++,y=y<c[a].count?c[a].count:y):c[a]={coll:[h],count:1},g=!1);for(tt=Object.keys(c),p=y-1;p>-1;){for(w=0,k=tt;w<k.length;w++)l=c[k[w]].coll[p],l&&((!(0===this.tupColumnInfo[l.ordinal].measurePosition?1===this.tupColumnInfo[l.ordinal].allStartPos:0===this.tupColumnInfo[l.ordinal].allStartPos)||this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showColumnGrandTotals)&&(this.frameCommonColumnLoop(l.members,l.ordinal,t,r,f,u),this.tupColumnInfo[l.ordinal].showTotals&&t++),this.totalCollection.pop());p--}return t},t.prototype.getLevelsAsString=function(n,t){for(var r=[],i=0;i<n;i++)r[i]=t[i].level;return r.length>0?r.toString():""},t.prototype.frameCommonColumnLoop=function(n,t,i,r,u,f){var y,k=-1,s,c,nt,d,g;if(this.tupColumnInfo[t].showTotals)for(s=0,c=0;s<n.length;)c+=f[s]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==s?r[s]:r[s]+(1-u[s]),this.tupColumnInfo[t].drillInfo[s].isDrilled&&this.tupColumnInfo[t].showTotals&&(this.tupColumnInfo[t].showTotals=!!this.showColumnSubTotals&&void 0===this.hideColumnTotalsObject[this.tupColumnInfo[t].drillInfo[s].hierarchy],c-=r[s]-this.tupColumnInfo[t].levelCollection[s],k=this.tupColumnInfo[t].showTotals?-1:c-1),s++;if(nt=this.checkAttributeDrill(this.tupColumnInfo[t].drillInfo,"columns"),this.tupColumnInfo[t].showTotals||nt)for(var o=0,h=0,p={};o<n.length;){for(var e=n[o],l=Number(e.querySelector("MEMBER_TYPE").textContent)>2?"3":e.querySelector("MEMBER_TYPE").textContent,tt=0,a="2"!==l?f[o]?1:u[o]:1;a<=("3"===l?1:r[o]);a++){d=!1;this.pivotValues[h]||(this.pivotValues[h]=[]);Number(n[o].querySelector("LNum").textContent)>a&&"2"!==l?(this.parentObjCollection[o][a]||this.getDrilledParent(n[o],a,this.parentObjCollection[o]),this.parentObjCollection[o][a]&&(e=this.parentObjCollection[o][a]),d=!0):(e=n[o],tt++);"2"!==l&&(p[e.querySelector("UName").textContent]=e.querySelector("Caption").textContent);for(var w="",it=Object.keys(p),b=0;b<it.length;b++)g=it[b],w=0===b?p[g]:w+this.valueSortSettings.headerDelimiter+p[g];var ut=!!this.namedSetsPosition.column[o],v=this.getUniqueName(e.querySelector("UName").textContent),rt=this.getDepth(this.tupColumnInfo[t],v,Number(l));if(this.isPaging&&this.pivotValues[h-1]&&this.pivotValues[h-1][i]&&this.fieldList[this.pivotValues[h-1][i].hierarchy]&&this.fieldList[this.pivotValues[h-1][i].hierarchy].isHierarchy&&this.pivotValues[h-1][i].hasChild&&!this.pivotValues[h-1][i].isDrilled&&!this.columns[o].isNamedSet&&this.fieldList[e.getAttribute("Hierarchy")]&&(this.fieldList[e.getAttribute("Hierarchy")].isHierarchy||this.fieldList[e.getAttribute("Hierarchy")].hasAllMember)&&this.pivotValues[h-1][i].depth<rt){this.isColDrill=!0;break}this.pivotValues[h][i]={axis:"column",actualText:v,colIndex:i,formattedText:"3"===l&&this.dataFields[v]&&this.dataFields[v].caption?this.dataFields[v].caption:e.querySelector("Caption").textContent,hasChild:!!(this.fieldList[e.getAttribute("Hierarchy")]&&this.fieldList[e.getAttribute("Hierarchy")].isHierarchy&&o<this.columns.length-1&&!this.columns[o+1].isNamedSet&&this.columns[o+1].name.indexOf("[Measures]")<0&&this.fieldList[this.columns[o+1].name]&&this.fieldList[this.columns[o+1].name].hasAllMember)||Number(e.querySelector("CHILDREN_CARDINALITY").textContent)>0,level:tt>1?-1:Number(e.querySelector("LNum").textContent)-(f[o]&&"3"!==l?1:0),rowIndex:h,ordinal:t,memberType:Number(l),depth:rt,isDrilled:!(!this.fieldList[e.getAttribute("Hierarchy")]||!this.fieldList[e.getAttribute("Hierarchy")].isHierarchy||this.isAttributeDrill(e.getAttribute("Hierarchy"),this.tupColumnInfo[t].drillInfo,"columns"))||d||this.tupColumnInfo[t].drillInfo[o].isDrilled,parentUniqueName:e.querySelector("PARENT_UNIQUE_NAME")?e.querySelector("PARENT_UNIQUE_NAME").textContent:void 0,levelUniqueName:e.querySelector("LName").textContent,hierarchy:e.getAttribute("Hierarchy"),isNamedSet:ut,valueSort:(y={levelName:w},y[w]=1,y.axis=e.getAttribute("Hierarchy"),y)};this.headerContent[h]||(this.headerContent[h]={});this.headerContent[h][i]=this.pivotValues[h][i];h++}o++}else if(k>-1)this.pivotValues[k][i-1].ordinal=t;else if(this.tupColumnInfo[t].allCount>0){for(s=0,c=0;s<this.tupColumnInfo[t].allStartPos;)c+=f[s]>0&&this.getMeasurePosition(this.tupColumnInfo[t].uNameCollection,this.tupColumnInfo[t].measurePosition)!==s?r[s]:r[s]+(1-u[s]),s++;c-=this.tupColumnInfo[t].allStartPos===this.tupColumnInfo[t].measurePosition+1?r[this.tupColumnInfo[t].allStartPos-2]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-2]+1:r[this.tupColumnInfo[t].allStartPos-1]-this.tupColumnInfo[t].levelCollection[this.tupColumnInfo[t].allStartPos-1];this.pivotValues[c-1]&&(this.pivotValues[c-1][i-1].ordinal=t)}},t.prototype.isAttributeDrill=function(n,t,i){var o=!1,r,u;if(!this.isAdjacentToMeasure(n,i))for(r=0;r<this.drilledMembers.length;r++)if(this.drilledMembers[r].name===n)for(u=0;u<this.drilledMembers[r].items.length;u++){for(var s=this.drilledMembers[r].delimiter,h=this.drilledMembers[r].items[u].split(s),e="",f=0;f<h.length;f++)t[f]&&t[f].uName&&(e=e+(""===e?"":this.drilledMembers[r].delimiter)+t[f].uName);if(e===this.drilledMembers[r].items[u]){o=!0;break}}return o},t.prototype.isAdjacentToMeasure=function(n,t){for(var u=!1,r="rows"===t?this.rows:this.columns,i=0;i<r.length;i++)if(r[i].name===n&&r[i+1]&&("[Measures]"===r[i+1].name||r[i+1].isNamedSet||this.fieldList[r[i+1].name]&&!this.fieldList[r[i+1].name].hasAllMember)){u=!0;break}return u},t.prototype.getDrilledParent=function(n,t,i){for(var r,e=Number(n.querySelector("LNum").textContent),f=n,u=e-1;u>=t;u--){if(r=this.drilledSets[f.querySelector("PARENT_UNIQUE_NAME").textContent],!r)break;i[u]=r;f=r}},t.prototype.performRowSorting=function(){var pt,t,d,p,ot,v,e,y,u,at,it,vt,b,i,ct,yt;if(this.enableSort&&this.tupRowInfo.length>0){for(var wt=this.pivotValues.length,nt={},f={},et=[],k=!1,lt=this.tupRowInfo[0].typeCollection.lastIndexOf("1"),bt=void 0,s=this.colDepth;s<wt;s++)t=this.pivotValues[s][0],this.showSubTotalsAtBottom&&t.isSum&&3!==t.memberType||(d=this.tupRowInfo[t.ordinal],p=d?0===d.measurePosition&&3===t.memberType?d.measureName:d.uNameCollection:"",""!==p&&(lt>-1&&(p=this.frameUniqueName(p,t,d)),ot=p.split(/~~|::\[/).length,3===t.memberType&&this.tupRowInfo[0].measurePosition>0?f[i=this.getParentUname(p,t,!0,!0)]?f[i].push(t):f[i]=[t]:nt[ot]?nt[ot][p]=[t]:nt[ot]=((pt={})[p]=[t],pt)),k&&et.push(t),"grand sum"===t.type&&(k=!0));for(var st=Object.keys(f).length>0&&this.tupRowInfo[0].measurePosition>0,a=Object.keys(nt).map(function(n){return Number(n)}).sort(function(n,t){return n>t?1:t>n?-1:0}),w={},c=a.length-1;c>=0;c--){for(var l={},ht=nt[a[c]],tt=Object.keys(ht),g=0;g<tt.length;g++)l[i=0===c?"parent":this.getParentUname(tt[g],ht[tt[g]][0],st,!1)]?l[i].push(ht[tt[g]][0]):l[i]=ht[tt[g]];for(v=Object.keys(l),e=0;e<v.length;e++)l[v[e]]=this.sortRowHeaders(l[v[e]]);if(w[a[c+1]])for(e=0;e<v.length;e++){for(var n=[],h=l[v[e]],o=0;o<h.length;o++){if(y=this.tupRowInfo[h[o].ordinal],u=0===y.measurePosition&&3===h[o].memberType?y.measureName:y.uNameCollection,n.push(h[o]),lt>-1&&(u=this.frameUniqueName(u,h[o],y)),at=!1,st&&f[i=this.getParentUname(u,h[o],st,!0)]){f[i]=this.sortRowHeaders(f[i]);var ni=u.lastIndexOf("::[")===u.indexOf("::[Measures]"),ti=u.split("::[").length-1===y.measurePosition,ii=!y.drillInfo[y.measurePosition-1].isDrilled,ri=y.members.length>y.measurePosition+1;if(ni&&ti&&ii&&ri)for(at=!0,it=0;it<f[i].length;it++)n.push(f[i][it]),vt=u.substring(0,u.indexOf("::[Measures]"))+"::"+f[i][it].actualText,w[a[c+1]][vt]&&(n=n.concat(w[a[c+1]][vt]));else bt=this.showSubTotalsAtBottom&&n[n.length-1].isDrilled,n=n.concat(f[i])}if(!at&&w[a[c+1]][u])if(this.showSubTotalsAtBottom&&3===n[n.length-1].memberType&&n[n.length-1].level>-1&&bt){for(var rt=[],kt=0,ut=n.length-1;ut>=0;ut--){if(3!==n[ut].memberType){rt=rt.reverse();kt=ut+1;break}rt[rt.length]=n[ut]}n=n.slice(0,kt).concat(w[a[c+1]][u]).concat(rt)}else t=n[n.length-1],b=void 0,this.showSubTotalsAtBottom&&t.isDrilled&&((b=r.frameHeaderWithKeys(t)).hasChild=!1,b.isDrilled=!1,b.isSum=!0,b.formattedText=b.formattedText+" Total"),n=n.concat(w[a[c+1]][u]),b&&(n[n.length]=b)}l[v[e]]=n}else if(st)for(e=0;e<v.length;e++){for(h=l[v[e]],n=[],o=0;o<h.length;o++)n.push(h[o]),u=this.tupRowInfo[h[o].ordinal].uNameCollection,lt>-1&&(u=this.frameUniqueName(u,h[o],this.tupRowInfo[h[o].ordinal])),f[i=this.getParentUname(u,h[o],!0,!0)]&&(f[i]=this.sortRowHeaders(f[i]),n=n.concat(f[i]));l[v[e]]=n}w[a[c]]=l}var ft=0,dt=0,gt=0;for(k=!1,et=this.sortRowHeaders(et),s=this.colDepth;s<wt;s++)"Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&("column"===this.olapValueAxis&&this.colDepth+1===s||"row"===this.olapValueAxis&&this.colDepth+this.dataSourceSettings.values.length+1===s)&&(ft=0,k=!1),ct=k?et:w[a[0]].parent,yt="Top"===this.dataSourceSettings.grandTotalsPosition&&this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals&&this.colDepth===s?ct.length:k?ft-dt:ft,ct[yt]&&(this.pivotValues[s]=[ct[yt]],this.pivotValues[s][0].rowIndex=s,this.valueContent[gt][0]=this.pivotValues[s][0]),ft++,gt++,"grand sum"===this.pivotValues[s][0].type&&(k=!0,dt=ft)}},t.prototype.performColumnSorting=function(){var ut,l,v,ht,g,y,ct,c,ot,lt,nt,st,tt,at,p,vt,d,w,b,it,a,rt;if(this.enableSort)for(ut=0;ut<this.dataSourceSettings.columns.length;ut++){for(var f=[],i=0,e=[],s=0;s<this.pivotValues.length;s++){var t=this.pivotValues[s],h=void 0,k=void 0,u={},o=1;e[i]=[];f[i]=[];for(var r=1,ft=t[r].hierarchy,et=t[r].levelUniqueName;r<t.length;r++)if(!t[r].isNamedSet){if(2!==t[r].memberType&&"[Measures]"!==t[r].hierarchy&&-1!==t[r].level){if(n.isNullOrUndefined(u[t[r].formattedText])||n.isNullOrUndefined(this.pivotValues[s-1]))u[t[r].formattedText]=u[t[r].formattedText]?u[t[r].formattedText]:[],u[t[r].formattedText][t[r].colIndex]=t[r];else if(u[t[r].formattedText]&&this.pivotValues[s-1]){var yt=this.pivotValues[s-1][t[r].colIndex],pt=Number(Object.keys(u[t[r].formattedText])[0]),wt=u[t[r].formattedText][pt].colIndex,bt=this.pivotValues[s-1][wt];if(yt.formattedText!==bt.formattedText){for(l=Object.keys(u),l=this.sortColumnHeaders(l,this.sortObject[t[r-1].levelUniqueName]||this.sortObject[t[r].hierarchy],ft,et),f[i]=n.isNullOrUndefined(f[i])?[]:f[i],v=0;v<l.length;v++)for(ht=Object.keys(u[l[v]]).length,g=0;g<ht;g++)o=0===f[i].length?1:0,f[i][f[i].length+o]=u[l[v]][Number(Object.keys(u[l[v]])[g])];(u={})[t[r].formattedText]=[];u[t[r].formattedText][t[r].colIndex]=t[r]}else u[t[r].formattedText][t[r].colIndex]=t[r]}}else if(Object.keys(u).length>0)for(e[i][e[i].length+o]=t[r],h=Object.keys(u),h=this.sortColumnHeaders(h,this.sortObject[t[r-1].levelUniqueName]||this.sortObject[t[r].hierarchy],ft,et),f[i]=n.isNullOrUndefined(f[i])?[]:f[i],y=0;y<h.length;y++)for(ct=Object.keys(u[h[y]]).length,c=0;c<ct;c++)o=0===f[i].length?1:0,f[i][f[i].length+o]=u[h[y]][Number(Object.keys(u[h[y]])[c])];else(-1===t[r].level||0===t[r].level)&&Object.keys(u).length>=0&&"[Measures]"!==t[r].hierarchy&&(e[i][e[i].length+o]=t[r]);if(-1!==t[r].level&&1===Object.keys(u).length&&"[Measures]"!==t[r].hierarchy&&!n.isNullOrUndefined(t[r+1])&&-1===t[r+1].level)if(ot=Object.keys(u[t[r].formattedText]).length,lt=Object.keys(u[t[r].formattedText]),ot>1)for(nt=0;nt<ot;nt++)o=0===e[i].length?1:0,e[i][e[i].length+o]=u[t[r].formattedText][Number(lt[nt])];else e[i][e[i].length+o]=t[r];if(Object.keys(e[i]).length>0){if(o=0===f[i].length?1:0,st=e[i].length,st>2)for(tt=1;tt<st;tt++)o=0===f[i].length?1:0,f[i][f[i].length+o]=e[i][tt];else f[i][f[i].length+o]=e[i][1]||e[i][0];u={};e[i]=[]}}if(Object.keys(u).length>0)for(e[i][e[i].length+o]=t[r],k=Object.keys(u),at=this.sortObject[t[r-1].levelUniqueName]||this.sortObject[t[r-1].hierarchy],h=this.sortColumnHeaders(k,at,ft,et),f[i]=n.isNullOrUndefined(f[i])?[]:f[i],p=0;p<k.length;p++)for(vt=Object.keys(u[k[p]]).length,c=0;c<vt;c++)o=0===f[i].length?1:0,f[i][f[i].length+o]=u[h[p]][Number(Object.keys(u[k[p]])[c])];for(d=1;d<f[i].length;d++)this.pivotValues[i][d]=f[i][d];for(w=s;w<this.pivotValues.length;w++)if(b=n.extend({},this.pivotValues[w+1],null,!0),it=n.extend({},this.pivotValues[w],null,!0),Object.keys(b).length===Object.keys(it).length&&Object.keys(b).length>2){for(a=1;a<this.pivotValues[s].length;a++)Object.keys(b).length>0&&it[a].colIndex!==b[a].colIndex&&(this.pivotValues[w+1][a]=b[it[a].colIndex]);break}i++;u={}}for(rt=0;rt<this.pivotValues.length;rt++)for(t=this.pivotValues[rt],s=1;s<t.length;s++)t[s].colIndex=s}},t.prototype.frameUniqueName=function(n,t,i){var r=n.indexOf(t.actualText.toString()+"::[Measures]")>-1,u=(n=n.substring(0,n.indexOf(t.actualText.toString()))+t.actualText.toString()).split("::[").length<=this.getMeasurePosition(n,i.measurePosition);return n+(r||u?"::"+i.measureName:"")},t.prototype.getMeasurePosition=function(n,t){for(var u=t,r=n.split("::["),i=0;i<r.length;i++)if(r[i]&&r[i].indexOf("Measures")>-1){u=i;break}return u},t.prototype.sortRowHeaders=function(n){var o,i;if(n.length>0&&3!==n[0].memberType&&!n[0].isNamedSet){for(o=[],i=0;i<n.length;i++)o[i]=n[i].actualText;var s=!1,f="Grand Total"!==n[0].actualText?n[0].hierarchy:n[1].hierarchy,u=this.fieldList[f]&&this.fieldList[f].membersOrder?this.fieldList[f].membersOrder.slice():[],t={fieldName:f,levelName:n[0].levelUniqueName,sortOrder:this.sortObject[n[0].hierarchy]||this.sortObject[n[0].levelUniqueName],members:u&&u.length>0?u:o,IsOrderChanged:!1};if(u&&u.length>0?r.applyCustomSort(t,n,"string",!1,!0):("Ascending"===t.sortOrder||void 0===t.sortOrder?n.sort(function(n,t){return n.formattedText>t.formattedText?1:t.formattedText>n.formattedText?-1:0}):"Descending"===t.sortOrder&&n.sort(function(n,t){return n.formattedText<t.formattedText?1:t.formattedText<n.formattedText?-1:0}),s=!0),s&&this.getHeaderSortInfo){for(var h=[],e=0,c=0;e<n.length;e++)"Grand Total"!==n[e].actualText&&(h[c++]=n[e].formattedText);t.members=h}return this.getHeaderSortInfo&&this.getHeaderSortInfo(t),t.IsOrderChanged&&r.applyCustomSort(t,n,"string",!0,!0),n}return n},t.prototype.sortColumnHeaders=function(n,t,i,r){var o=!1,f=this.fieldList[i]&&this.fieldList[i].membersOrder?this.fieldList[i].membersOrder.slice():[],u={fieldName:i,levelName:r,sortOrder:t,members:f&&f.length>0?f:n,IsOrderChanged:!1};if(f&&f.length>0?this.applyCustomSort(n,u):("Ascending"===u.sortOrder||void 0===u.sortOrder?n.sort(function(n,t){return n>t?1:t>n?-1:0}):"Descending"===u.sortOrder&&n.sort(function(n,t){return n<t?1:t<n?-1:0}),o=!0),o&&this.getHeaderSortInfo){for(var s=[],e=0,h=0;e<n.length;e++)"Grand Total"!==n[e]&&(s[h++]=n[e]);u.members=s}return this.getHeaderSortInfo&&this.getHeaderSortInfo(u),u.IsOrderChanged&&this.applyCustomSort(n,u,!0),n},t.prototype.applyCustomSort=function(n,t,i){var o,s,u=[],r,f,e;for(s=t.IsOrderChanged?t.members:"Ascending"===t.sortOrder||"None"===t.sortOrder||void 0===t.sortOrder?[].concat(t.members):[].concat(t.members).reverse(),"Grand Total"===n[0]&&(o=n[0],n.shift()),r=0,f=0;r<n.length;r++){if(e=n[r],s[f]===e){if(n.splice(f++,0,e),n.splice(++r,1),!(f<s.length)){i||u.splice(--f,0,e);break}r=-1}r>=0&&!i&&(u[r]=n[r])}if(!i){for(r=u.length;r<n.length;r++)u[r]=n[r];"Grand Total"===u[u.length-1]&&u.pop();t.members=u}return o&&n.splice(0,0,o),n},t.prototype.frameSortObject=function(){if(this.enableSort)for(var n=0;n<this.sortSettings.length;n++)this.sortObject[this.sortSettings[n].name]=this.sortSettings[n].order},t.prototype.getParentUname=function(n,t,i,r){var o="",e;if(i&&!r){for(var s=this.tupRowInfo[t.ordinal],f=[],h={},u=0;u<n.length;u++)"~"!==n[u]&&":"!==n[u]||(f.push(u),h[u]=n[u]+n[u],u++);o=this.getMeasurePosition(n,s.measurePosition)>=n.split("::[").length-1?f[f.length-2]>-1?n.substring(0,f[f.length-2])+h[f[f.length-1]]+s.measureName:"parent":(e=n.lastIndexOf("~~")>n.lastIndexOf("::[")?n.lastIndexOf("~~"):n.lastIndexOf("::["))>-1?n.substring(0,e):"parent"}else o=(e=n.lastIndexOf("~~")>n.lastIndexOf("::[")?n.lastIndexOf("~~"):n.lastIndexOf("::["))>-1?n.substring(0,e):"parent";return o},t.prototype.performColumnSpanning=function(){for(var r,o,u={},t=this.rowStartPos-1,h=Object.keys(this.colMeasures).length;t>-1;){for(u[t]={},r=this.pivotValues[t].length-1;r>0;){u[t][r]=1;var f=this.pivotValues[t][r+1],i=this.pivotValues[t+1]&&this.rowStartPos-t>1?this.pivotValues[t+1][r]:void 0,n=this.pivotValues[t][r],c=!1,s=!1,e=this.tupColumnInfo[n.ordinal],l=e.allStartPos>("3"===e.typeCollection[0]?1:0),a=this.checkAttributeDrill(e.drillInfo,"columns");(this.showSubTotalsAtTop&&n.isDrilled&&f&&f.actualText!==n.actualText&&n.level>-1&&(n.ordinal=this.getOrdinal(n,this.pivotValues[t+1])),i&&f&&(2===n.memberType||-1===n.level?f.actualText===n.actualText:3===n.memberType&&n.actualText===f.actualText||f.valueSort.levelName===n.valueSort.levelName)&&(2===n.memberType?n.colSpan=l&&"sum"!==f.type?1:f.colSpan+1>(e.measurePosition>t?h:0)?1:f.colSpan+1:(n.colSpan=f.colSpan+1,n.ordinal=f.ordinal),c=!0),2===n.memberType)?(l?(a||(n.type="sum"),n.formattedText="Total",n.valueSort[n.valueSort.levelName.toString()]=1):(o="Grand Total",i&&h>0&&(o=3===i.memberType?"Grand Total."+i.formattedText:i.valueSort.levelName),n.type="grand sum",n.formattedText="Grand Total",n.valueSort.levelName=o,n.valueSort[o.toString()]=1),n.hasChild=!1):-1===n.level&&(n.type="sum",n.formattedText="Total",n.hasChild=!1,n.valueSort[n.valueSort.levelName.toString()]=1);i?2===n.memberType&&2===i.memberType||i.actualText===n.actualText?(u[t][r]=u[t+1]?u[t+1][r]+1:1,0===t||1===n.memberType&&n.level>-1&&1===i.memberType&&-1===i.level?(n.rowSpan=!n.isDrilled||this.fieldList[n.hierarchy]&&this.fieldList[n.hierarchy].isHierarchy&&!n.hasChild?u[t+1][r]+1:1,i.rowSpan=!i.isDrilled||this.fieldList[i.hierarchy]&&this.fieldList[i.hierarchy].isHierarchy&&!i.hasChild||-1!==i.level?i.rowSpan:u[t+1][r]):n.rowSpan=3===n.memberType?1:-1,s=!0):!n.isDrilled||this.fieldList[n.hierarchy]&&this.fieldList[n.hierarchy].isHierarchy&&!n.hasChild||-1!==n.level||2!==i.memberType?(n.rowSpan=0===t?u[t][r]:-1,i.rowSpan=i.level>-1&&(!i.isDrilled||this.fieldList[i.hierarchy]&&this.fieldList[i.hierarchy].isHierarchy&&!i.hasChild)||2!==n.memberType&&2===i.memberType?u[t+1][r]:1):(u[t][r]=u[t+1]?u[t+1][r]+1:1,n.rowSpan=-1,s=!0):n.rowSpan=n.level>-1||1===this.rowStartPos?u[t][r]:-1;c||(n.colSpan=1);s||(u[t][r]=1);r--}t--}},t.prototype.getOrdinal=function(n,t){for(var r=0,i=n.colIndex;i>0;i--)if(-1===t[i].level){r=t[i].ordinal;break}return r},t.prototype.frameValues=function(t,i){var v=this.colDepth,w=this.pivotValues.length,b=0,l,y,r,o,u,f,s,nt,tt;for("down"===this.customArgs.action&&(l=Object.keys(this.onDemandDrillEngine),v=Number(l[0]),w=Number(l[l.length-1])+1,b=this.onDemandDrillEngine[v][0].ordinal),y={},r=0;r<t.length;r++)n.isNullOrUndefined(t[r])||(y[Number(t[r].getAttribute("CellOrdinal"))]=t[r]);for(o=v;o<w;o++)for(u=this.pivotValues[o],f=u[0].ordinal,r=1;r<this.pivotValues[0].length;r++)if(this.pivotValues[this.colDepth-1][r]){var e=this.pivotValues[this.colDepth-1][r].ordinal,p=this.pivotValues[this.colDepth-1][r],k=3===u[0].memberType?u[0].actualText.toString():this.tupColumnInfo[p.ordinal]&&this.tupColumnInfo[p.ordinal].measure?this.tupColumnInfo[p.ordinal].measure.querySelector("UName").textContent:u[0].actualText;if("header"===u[0].type)u[r]={axis:"value",actualText:this.getUniqueName(k),formattedText:"",value:0,colIndex:r,rowIndex:o};else{var h,a,c=void 0,d=this.getUniqueName(k),g=!this.fieldList[u[0].hierarchy]||!this.fieldList[u[0].hierarchy].isHierarchy||u[0].isDrilled;a=this.tupRowInfo[f]?this.tupRowInfo[f].showTotals:this.dataSourceSettings.showGrandTotals&&this.dataSourceSettings.showRowGrandTotals;s=y[(f-b)*i+e];c=this.showSubTotalsAtBottom&&u[0].isDrilled||!a&&g?"":n.isNullOrUndefined(s)||n.isNullOrUndefined(s.querySelector("FmtValue"))?this.emptyCellTextContent:s.querySelector("FmtValue").textContent;h=!a&&g?"0":n.isNullOrUndefined(s)||n.isNullOrUndefined(s.querySelector("Value"))?null:s.querySelector("Value").textContent;c=this.showSubTotalsAtBottom&&u[0].isDrilled?"":a&&!n.isNullOrUndefined(h)?this.getFormattedValue(Number(h),d,""!==c?c:h):c;nt=!this.tupColumnInfo[e]||this.tupColumnInfo[e].allCount>0||this.tupColumnInfo[e].drillStartPos>-1||!this.tupRowInfo[f]||this.tupRowInfo[f].allCount>0||this.tupRowInfo[f].drillStartPos>-1;tt=!!this.tupRowInfo[f]&&(0===this.tupRowInfo[f].measurePosition?1===this.tupRowInfo[f].allStartPos:0===this.tupRowInfo[f].allStartPos)||!!this.tupColumnInfo[e]&&(0===this.tupColumnInfo[e].measurePosition?1===this.tupColumnInfo[e].allStartPos:0===this.tupColumnInfo[e].allStartPos);u[r]={axis:"value",actualText:d,formattedText:c,colOrdinal:e,rowOrdinal:f,columnHeaders:this.tupColumnInfo[e]?this.tupColumnInfo[e].captionCollection:"",rowHeaders:this.tupRowInfo[f]?this.tupRowInfo[f].captionCollection:"",value:n.isNullOrUndefined(h)?null:Number(h),colIndex:r,rowIndex:o,isSum:nt,isGrandSum:tt}}this.valueContent[o-this.rowStartPos][r]=u[r]}},t.prototype.getFormattedValue=function(t,i,r){var f=r,e,u,o;return this.formatFields[i]&&!n.isNullOrUndefined(t)&&(e=this.formatFields[i].properties?this.formatFields[i].properties:this.formatFields[i],u=n.extend({},e,null,!0),(delete u.name,!u.minimumSignificantDigits&&u.minimumSignificantDigits<1&&delete u.minimumSignificantDigits,!u.maximumSignificantDigits&&u.maximumSignificantDigits<1&&delete u.maximumSignificantDigits,u.type)?f=this.globalize.formatDate(new Date(t.toString()),u):((delete u.type,u.format&&!this.formatRegex.test(u.format))&&(o=u.format.match(this.customRegex)[6],u.useGrouping=-1!==o.indexOf(",")),f=this.globalize.formatNumber(t,u))),f},t.prototype.getMeasureInfo=function(){for(var u,i,t="column",r=[],f=0,s=this.values;f<s.length;f++)u=s[f],r[r.length]=u.isCalculatedField?this.fieldList[u.name].tag:u.name;if(r.length>1){if(this.isMeasureAvail){for(var e=!1,n=0,o=this.rows.length;n<o;n++)if("[measures]"===this.rows[n].name.toLowerCase()){t="row";i=n;e=!0;break}if(!e)for(n=0,o=this.columns.length;n<o;n++)if("[measures]"===this.columns[n].name.toLowerCase()){t="column";i=n;e=!0;break}}else i="row"===(t=this.valueAxis)?this.rows.length-1:this.columns.length-1;return{measureAxis:t,measureIndex:i,valueInfo:r}}return{measureAxis:t,measureIndex:-1,valueInfo:[]}},t.prototype.frameMeasureOrder=function(t,i,r,u,f){var p=[],tt=[],c=[],w={},ot=[],wt=t.measureAxis,b=t.measureIndex,st=t.valueInfo,it,ht,rt,lt,ut,at,nt,ft,et;if(wt===i&&st.length>0){for(var l={},k=[],e=0,ti=r.length;e<ti;e++){for(var bt=r[e],kt=[].slice.call(bt.querySelectorAll("Member")),s="",a="",o=0;o<kt.length;)s=s+(""!==s?"~~":"")+kt[o].querySelector("UName").textContent,(o===b&&0===b||o===b-1)&&(a=s),o++;l[a]?l[a][l[a].length]=s:(l[a]=[s],k[k.length]=a);w[s]={index:e,node:bt};ot[ot.length]=s}if(ot.length>0&&k.length>0)if(0===b){for(it=0,ht=st;it<ht.length;it++)for(var ii=ht[it],ct=0,dt=k;ct<dt.length;ct++)if((vt=dt[ct])===ii)for(rt=0,lt=l[vt];rt<lt.length;rt++)s=lt[rt],c[c.length]=w[s].index,p[p.length]=w[s].node}else for(ut=0,at=k;ut<at.length;ut++)for(var vt=at[ut],yt=0,gt=st;yt<gt.length;yt++)for(var ri=gt[yt],pt=0,ni=l[vt];pt<ni.length;pt++)(s=ni[pt]).split("~~")[b]===ri&&(c[c.length]=w[s].index,p[p.length]=w[s].node);if(u.length>0){for(var h=[],d=[],v=0,y=0,g=(e=0,u.length);e<g;e++)v>f-1?(v=0,h[++y]||(h[y]=[]),h[y][v]=e,v++):(h[y]||(h[y]=[]),h[y][v]=e,v++),d[d.length]=Number(u[e].getAttribute("CellOrdinal"));if("column"===wt){if(h.length>0&&h[0].length===c.length)for(o=0,g=c.length;o<g;o++)for(e=0;e<h.length;)nt=e*f+o,n.isNullOrUndefined(d[nt])||n.isNullOrUndefined(h[e])||n.isNullOrUndefined(c[o])||(ft=d[nt].toString(),(et=u[Number(h[e][c[o]])]).setAttribute("CellOrdinal",ft.toString()),tt[nt]=et),e++}else if(h.length===c.length)for(o=0,g=c.length;o<g;o++)for(e=0;e<h[c[o]].length;)ft=d[nt=o*f+e].toString(),(et=u[Number(h[c[o]][e])]).setAttribute("CellOrdinal",ft.toString()),tt[tt.length]=et,e++}return{orderedHeaderTuples:p,orderedValueTuples:tt}}return{orderedHeaderTuples:r,orderedValueTuples:u}},t.prototype.getDrilledSets=function(t,i,r,u){for(var y,l,f,nt,p,s,rt,ut,w=[],ft=i.actualText.toString(),e="row"===u?this.tupRowInfo:this.tupColumnInfo,lt=e[i.ordinal],at=0===e[0].typeCollection.indexOf("3")?1:0,h=0,vt="1"===e[0].typeCollection[r];h<e.length;)(n.isNullOrUndefined(e[h].allStartPos)||e[h].allStartPos>at)&&(w[w.length]=e[h].uNameCollection),h++;for(var v=t.split("::[").map(function(n){return"["===n[0]?n:"["+n}),c=[],o=0;o<=r;o++)if(v[o])if((vt||this.isPaging)&&o===r){for(var et=v[o].split("~~"),yt=et.indexOf(ft),b=[],k=0;k<=yt;k++)b.push(et[k]);c[c.length]=b.length>0?b.join("~~"):v[o]}else c[c.length]=v[o];t=c.join("::");for(var d=[],ot={},g=0,st=w;g<st.length;g++)if(y=st[g],0===y.indexOf(t)&&(d.push(y),this.isPaging))for(l=y.split("::[")[r],f=(s=(l="["===l[0]?l:"["+l).split("~~")).indexOf(ft);f<s.length;f++)ot[s[f]]=s[f];if(this.isPaging){for(nt=lt.uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}),p=[],f=0;f<nt.length;f++)f!==r&&(p[f]=nt[f]);for(s=Object.keys(ot),f=0;f<s.length;f++)p[r]=s[f],d.push(p.join("::"))}for(var ht={},tt=0,ct=d;tt<ct.length;tt++){for(var pt=ct[tt].split("::[").map(function(n){return"["===n[0]?n:"["+n}),a="",it=0;it<=r;it++)rt=pt[it],rt&&(ut=rt.split("~~"),a=a+(""!==a?"~~":"")+ut[ut.length-1]);ht[a]=a}return ht},t.prototype.updateDrilledInfo=function(n){this.dataSourceSettings=n;this.drilledMembers=n.drilledMembers?this.updateDrilledItems(n.drilledMembers):[];this.generateGridData(n)},t.prototype.updateCalcFields=function(n,t){this.dataSourceSettings=n;this.calculatedFieldSettings=n.calculatedFieldSettings?n.calculatedFieldSettings:[];this.getAxisFields();this.updateFieldlist();this.loadCalculatedMemberElements(this.calculatedFieldSettings);this.dataFields[t.name]?this.generateGridData(n):fu.getCellSets(n,this,!0,void 0,!0)},t.prototype.onSort=function(n){this.dataSourceSettings=n;this.sortSettings=n.sortSettings?n.sortSettings:[];this.getAxisFields();this.frameSortObject();this.updateFieldlist();this.xmlaCellSet.length>0&&this.xmlDoc?this.generateEngine(this.xmlDoc,this.request,this.customArgs):this.generateGridData(n)},t.prototype.updateFieldlist=function(n){for(var t,u,e,r,f,s,i=0;i<this.savedFieldListData.length;){if(t=this.savedFieldListData[i].id,u=this.savedFieldListData[i].pid,this.savedFieldList[t]&&(e=this.enableSort?this.sortObject[t]?this.sortObject[t]:"Ascending":"None",this.savedFieldList[t].isSelected=!1,this.savedFieldList[t].isExcelFilter=!1,this.savedFieldList[t].sort=e,this.savedFieldList[t].allowDragAndDrop=!0,this.savedFieldList[t].showFilterIcon=!0,this.savedFieldList[t].showSortIcon=!0,this.savedFieldList[t].showEditIcon=!0,this.savedFieldList[t].showRemoveIcon=!0,this.savedFieldList[t].showValueTypeIcon=!0,this.savedFieldList[t].showSubTotals=!0,this.savedFieldListData[i].sort=e,this.savedFieldListData[i].allowDragAndDrop=!0,this.savedFieldListData[i].showFilterIcon=!0,this.savedFieldListData[i].showSortIcon=!0,this.savedFieldListData[i].showEditIcon=!0,this.savedFieldListData[i].showRemoveIcon=!0,this.savedFieldListData[i].showValueTypeIcon=!0,this.savedFieldListData[i].showSubTotals=!0,n&&(this.savedFieldList[t].filter=[],this.savedFieldList[t].actualFilter=[])),this.dataFields[t]&&this.savedFieldList[t]&&this.selectedItems.indexOf(t)>-1?(this.savedFieldList[t].isSelected=!0,this.savedFieldList[t].allowDragAndDrop=!this.dataFields[t]||this.dataFields[t].allowDragAndDrop,this.savedFieldList[t].showFilterIcon=!this.dataFields[t]||this.dataFields[t].showFilterIcon,this.savedFieldList[t].showSortIcon=!this.dataFields[t]||this.dataFields[t].showSortIcon,this.savedFieldList[t].showEditIcon=!this.dataFields[t]||this.dataFields[t].showEditIcon,this.savedFieldList[t].showRemoveIcon=!this.dataFields[t]||this.dataFields[t].showRemoveIcon,this.savedFieldList[t].showValueTypeIcon=!this.dataFields[t]||this.dataFields[t].showValueTypeIcon,this.savedFieldList[t].showSubTotals=!this.dataFields[t]||this.dataFields[t].showSubTotals,this.savedFieldListData[i].isSelected=!0,this.savedFieldListData[i].allowDragAndDrop=!this.dataFields[t]||this.dataFields[t].allowDragAndDrop,this.savedFieldListData[i].showFilterIcon=!this.dataFields[t]||this.dataFields[t].showFilterIcon,this.savedFieldListData[i].showSortIcon=!this.dataFields[t]||this.dataFields[t].showSortIcon,this.savedFieldListData[i].showEditIcon=!this.dataFields[t]||this.dataFields[t].showEditIcon,this.savedFieldListData[i].showRemoveIcon=!this.dataFields[t]||this.dataFields[t].showRemoveIcon,this.savedFieldListData[i].showValueTypeIcon=!this.dataFields[t]||this.dataFields[t].showValueTypeIcon,this.savedFieldListData[i].showSubTotals=!this.dataFields[t]||this.dataFields[t].showSubTotals):this.savedFieldListData[i].isSelected=this.dataFields[u]&&this.savedFieldList[u]&&this.selectedItems.indexOf(u)>-1?!0:!1,this.savedFieldList[t]&&this.savedFieldList[t].isCalculatedField||"[calculated members].[_0]"===t.toLowerCase()){for(var h=!1,o=0,c=this.calculatedFieldSettings;o<c.length;o++)r=c[o],t===r.name&&(f=r.formula,s=r.formatString,this.savedFieldListData[i].formula=f,this.savedFieldListData[i].formatString=s,this.savedFieldListData[i].parentHierarchy=f.toLowerCase().indexOf("measure")>-1?void 0:r.hierarchyUniqueName,this.savedFieldList[t].formula=f,this.savedFieldList[t].formatString=s,this.savedFieldList[t].parentHierarchy=this.savedFieldListData[i].parentHierarchy,h=!0);(h||"[calculated members].[_0]"===t.toLowerCase())&&("[calculated members].[_0]"!==t.toLowerCase()||0!==this.calculatedFieldSettings.length)||(this.savedFieldListData.splice(i,1),i--,this.savedFieldList[t]&&delete this.savedFieldList[t])}i++}this.fieldList=this.savedFieldList;this.fieldListData=this.savedFieldListData},t.prototype.updateFieldlistData=function(n,t){for(var u,i=0,r=this.fieldListData;i<r.length;i++)if(u=r[i],u.id===n){u.isSelected=!!t;break}},t.prototype.getFormattedFields=function(n){this.formatFields={};for(var t=n.length;t--;)this.formatFields[n[t].name]=n[t]},t.prototype.getFieldList=function(n){var t={catalog:n.catalog,cube:n.cube,url:n.url,LCID:n.localeIdentifier.toString(),request:"MDSCHEMA_HIERARCHIES",roles:n.roles};this.getTreeData(t,this.getFieldListItems.bind(this),{dataSourceSettings:n,action:"loadFieldElements"})},t.prototype.getTreeData=function(n,t,i){var r=this.getConnectionInfo(n.url,n.LCID),u='<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"><Header/><Body><Discover xmlns="urn:schemas-microsoft-com:xml-analysis"><RequestType>'+n.request+"<\/RequestType><Restrictions><RestrictionList><CATALOG_NAME>"+n.catalog+"<\/CATALOG_NAME><CUBE_NAME>"+n.cube+"<\/CUBE_NAME><\/RestrictionList><\/Restrictions><Properties><PropertyList><Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+r.LCID+"<\/LocaleIdentifier>"+(n.roles?"<Roles>"+n.roles+"<\/Roles>":"")+"<\/PropertyList><\/Properties><\/Discover><\/Body><\/Envelope>";this.doAjaxPost("POST",r.url,u,t,i)},t.prototype.getAxisFields=function(){var t,i,r,u,f,e;for(this.rows=this.dataSourceSettings.rows?this.dataSourceSettings.rows:[],this.columns=this.dataSourceSettings.columns?this.dataSourceSettings.columns:[],this.filters=this.dataSourceSettings.filters?this.dataSourceSettings.filters:[],this.values=this.dataSourceSettings.values?this.dataSourceSettings.values:[],t=n.extend([],this.rows,null,!0),i=(t=t.concat(this.columns,this.values,this.filters)).length;i--;)this.dataFields[t[i].name]=t[i],"[measures]"===t[i].name.toLowerCase()?this.isMeasureAvail=!0:this.selectedItems.push(t[i].name);if(this.mappingFields={},this.dataSourceSettings.fieldMapping)for(r=0,u=this.dataSourceSettings.fieldMapping;r<u.length;r++)f=u[r],this.mappingFields[f.name]=f;!this.isMeasureAvail&&this.values.length>0&&(e={name:"[Measures]",caption:"Measures",showRemoveIcon:!0,allowDragAndDrop:!0},"row"===this.valueAxis?this.rows.push(e):this.columns.push(e),this.isMeasureAvail=!0)},t.prototype.getAggregateType=function(n,t){var i;switch(t){case"1":i="Sum";break;case"2":i="Count";break;case"3":i="Min";break;case"4":i="Max";break;case"5":i="Avg";break;case"8":i="DistinctCount";break;case"127":i="CalculatedField";break;default:i=void 0}return i||void 0},t.prototype.getUniqueName=function(n){for(var t,r=n,i=0,u=this.calculatedFieldSettings;i<u.length;i++)if(t=u[i],n===(t.formula.toLowerCase().indexOf("measure")>-1?"[Measures].":t.hierarchyUniqueName+".")+"["+t.name+"]"){r=t.name;break}return r},t.prototype.updateFilterItems=function(t){var c=n.extend([],this.rows,null,!0),e,l,i,f,a,v,o,g,p,s,h,b,u;for(c=c.concat(this.columns),e=0,l=t;e<l.length;e++)if(i=l[e],"Include"===i.type&&this.allowMemberFilter){if(f=this.fieldList[i.name].members,a=f&&Object.keys(f).length>0,this.fieldList[i.name].actualFilter=i.items.slice(),v=n.extend([],i.items,null,!0),a)for(o=0;o<v.length;){for(var k=[],y=0,d=k=this.getParentNode(v[o],f,k);y<d.length;y++)g=d[y],p=r.inArray(g,i.items),-1!==p&&i.items.splice(p,1);o++}for(var nt=[],w=0,tt=i.items;w<tt.length;w++)s=tt[w],nt.push(s),a?this.fieldList[i.name].filter.push(f[s].caption):this.fieldList[i.name].filter.push(s);this.filterMembers[i.name]=nt;this.fieldList[i.name].isExcelFilter=!1}else if((this.allowValueFilter||this.allowLabelFilter)&&-1!==["Date","Label","Number","Value"].indexOf(i.type))for(h=0,b=c;h<b.length;h++)if(b[h].name===i.name){u=this.filterMembers[i.name];u&&"object"==typeof u[0]&&u[0].type===i.type?u[u.length]=i:this.filterMembers[i.name]=[i];this.fieldList[i.name].isExcelFilter=!0;break}},t.prototype.getParentNode=function(n,t,i){if(t[n].parent&&n!==t[n].parent){var r=t[n].parent;i.push(r);this.getParentNode(r,t,i)}return i},t.prototype.updateDrilledItems=function(t){var e=[],r=n.extend([],this.rows,null,!0),i,u,h;for(r=r.concat(this.columns),i=0,u=t;i<u.length;i++)for(var o=u[i],f=0,s=r;f<s.length;f++)if(h=s[f],o.name===h.name){e.push(o);break}return e},t.prototype.getDrillThroughData=function(n,t){for(var s,u,f,l,a,v,h,e=this.tupColumnInfo[n.colOrdinal]&&this.tupColumnInfo[n.colOrdinal].uNameCollection&&""!==this.tupColumnInfo[n.colOrdinal].uNameCollection?this.tupColumnInfo[n.colOrdinal].uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}):[],o=this.tupRowInfo[n.rowOrdinal]&&this.tupRowInfo[n.rowOrdinal].uNameCollection&&""!==this.tupRowInfo[n.rowOrdinal].uNameCollection?this.tupRowInfo[n.rowOrdinal].uNameCollection.split("::[").map(function(n){return"["===n[0]?n:"["+n}):[],c=[],r="",i=0;i<this.filters.length;i++)if(h=this.filterMembers[this.filters[i].name]){for(s=0;s<h.length;s++)r+=h[s],r=s<h.length-1?r+",":r+"";c[i]=r;r=""}for(i=0;i<c.length;i++)r=""===r?"{"+c[i]+"}":r+",{"+c[i]+"}";for(u="",f="",i=0;i<e.length;i++)u=(u.length>0?u+",":"")+(e[i].split("~~").length>1?e[i].split("~~")[e[i].split("~~").length-1]:e[i]);for(i=0;i<o.length;i++)f=(f.length>0?f+",":"")+(o[i].split("~~").length>1?o[i].split("~~")[o[i].split("~~").length-1]:o[i]);l="DRILLTHROUGH MAXROWS "+t+" Select("+(u.length>0?u:"")+(u.length>0&&f.length>0?",":"")+(f.length>0?f:"")+") on 0 from "+(""===r?"["+this.dataSourceSettings.cube+"]":"(SELECT ("+r+") ON COLUMNS FROM ["+this.dataSourceSettings.cube+"])");l=l.replace(/&/g,"&amp;");a=this.getSoapMsg(this.dataSourceSettings,l);v=this.getConnectionInfo(this.dataSourceSettings.url,this.dataSourceSettings.localeIdentifier);this.doAjaxPost("POST",v.url,a,this.drillThroughSuccess.bind(this),{dataSourceSettings:this.dataSourceSettings,action:"drillThrough"})},t.prototype.drillThroughSuccess=function(n){var o=[].slice.call(n.querySelectorAll("row")),u="",t,i,e,f,h,r,s;if(o.length>0){for(t=[],i=0;i<o.length;){for(e=[].slice.call(o[i].children),f=0;f<e.length;)t.push('"'+e[f].tagName+'":"'+e[f].textContent+'"'),f++;i++}for(h=t[0],r=0;r<t.length;)Object.keys(JSON.parse("[{"+t[r]+"}]")[0])[0]!==Object.keys(JSON.parse("[{"+h+"}]")[0])[0]?(u+=","+t[r],r++):(u+=""===u?"[{"+t[r]:"}, {"+t[r],r++);u+="}]"}else for(s=[].slice.call(n.querySelectorAll("faultstring")),i=0;i<s.length;)u+=s[i].textContent,i++;this.gridJSON=u},t.prototype.getFilterMembers=function(n,t,i,r,u){var e,f=this.fieldList[t].levels,o=this.fieldList[t].levelCount;return e=u?"Descendants({"+f[o].id+"}, "+f[i-1].id+", "+(i-o==1?"SELF)":"SELF_AND_BEFORE)"):t+", Descendants({"+f[0].id+"}, "+f[i-1].id+", SELF_AND_BEFORE)",this.fieldList[t].levelCount=i,r||this.getMembers(n,t,!1,e,u),e},t.prototype.getMembers=function(n,t,i,r,u){var e,o="DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE",s=this.fieldList[t].hasAllMember,f=(s?t:t+".LEVELS(0)").replace(/\&/g,"&amp;"),h,c;e=i?"SELECT ({"+f+".ALLMEMBERS})"+o+" ON 0 FROM ["+n.cube+"]":"SELECT ({"+(r||(s?f+", "+f+".CHILDREN":f+".ALLMEMBERS"))+"})"+o+" ON 0 FROM ["+n.cube+"]";h=this.getSoapMsg(n,e);c=this.getConnectionInfo(n.url,n.localeIdentifier);u||(this.fieldList[t].filterMembers=[],this.fieldList[t].childMembers=[],this.fieldList[t].searchMembers=[],this.fieldList[t].members={},this.fieldList[t].currrentMembers={});this.doAjaxPost("POST",c.url,h,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:t,loadLevelMembers:u,action:"fetchMembers"})},t.prototype.getChildMembers=function(n,t,i){var r="SELECT ({"+t.replace(/\&/g,"&amp;")+".CHILDREN})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",u=this.getSoapMsg(n,r),f=this.getConnectionInfo(n.url,n.localeIdentifier);this.doAjaxPost("POST",f.url,u,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:i,action:"fetchChildMembers"})},t.prototype.getCalcChildMembers=function(n,t){this.calcChildMembers=[];var i="SELECT ({"+t.replace(/\&/g,"&amp;")+".MEMBERS})DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",r=this.getConnectionInfo(n.url,n.localeIdentifier),u=this.getSoapMsg(n,i);this.doAjaxPost("POST",r.url,u,this.generateMembers.bind(this),{dataSourceSettings:n,action:"fetchCalcChildMembers"})},t.prototype.getSearchMembers=function(n,t,i,r,u,f){if(this.fieldList[t].searchMembers=[],this.fieldList[t].currrentMembers={},""!==i){var e=t.replace(/\&/g,"&amp;"),o="WITH SET [SearchMembersSet] AS &#39;FILTER("+(u?e+".ALLMEMBERS, ":"{"+(f>1?this.getFilterMembers(n,t,f,!0):e+", "+e+".CHILDREN")+"},")+"(INSTR(1, "+e+'.CurrentMember.member_caption, "'+i+'") > 0))&#39;SET [SearchParentsSet] AS &#39;GENERATE([SearchMembersSet], ASCENDANTS([SearchMembersSet].Current))&#39;SET [SearchSet] AS &#39;HIERARCHIZE(DISTINCT({[SearchMembersSet], [SearchParentsSet]}))&#39;SELECT SUBSET([SearchSet], 0, '+r+")DIMENSION PROPERTIES PARENT_UNIQUE_NAME, HIERARCHY_UNIQUE_NAME, CHILDREN_CARDINALITY, MEMBER_TYPE, MEMBER_VALUE ON 0 FROM ["+n.cube+"]",s=this.getSoapMsg(n,o),h=this.getConnectionInfo(n.url,n.localeIdentifier);this.doAjaxPost("POST",h.url,s,this.generateMembers.bind(this),{dataSourceSettings:n,fieldName:t,action:"fetchSearchMembers"})}},t.prototype.generateMembers=function(n,t,i){for(var p,v,w=[].slice.call(n.querySelectorAll('Axis[name="Axis0"] Tuple')),u=i.fieldName,f={},l=0,y=w;l<y.length;l++){var o=y[l],h=o.querySelector("Member"),c=h.querySelector("MEMBER_TYPE").textContent,r=h.querySelector("UName").textContent,e=h.querySelector("Caption").textContent,s=h.querySelector("PARENT_UNIQUE_NAME")?h.querySelector("PARENT_UNIQUE_NAME").textContent:"",a={"data-fieldName":u,"data-memberId":r};if(""===s&&"1"===c)f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,isSelected:!1,id:r,tag:r,name:e,caption:e,htmlAttributes:a},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].members[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f)):"fetchSearchMembers"===i.action?(this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1},this.fieldList[u].searchMembers.push(f),f.expanded=!0):this.calcChildMembers.push(f);else if(""!==s&&"1"===c)if(s===v&&"1"===c)f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,id:r,name:e,isSelected:!1,caption:e,htmlAttributes:a,tag:r},"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f),this.fieldList[u].members[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1}):"fetchSearchMembers"===i.action?(f.expanded=!0,this.fieldList[u].searchMembers.push(f),this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:void 0,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(f);else{if("fetchMembers"===i.action&&this.fieldList[u].members[r])continue;p=!!i.loadLevelMembers&&this.fieldList[u].members[s].isSelected;f={hasChildren:!!o.querySelector("CHILDREN_CARDINALITY")&&"0"!==o.querySelector("CHILDREN_CARDINALITY").textContent,htmlAttributes:a,isSelected:!1,id:r,pid:s,name:e,caption:e,tag:r};"fetchMembers"===i.action||"fetchChildMembers"===i.action?(this.fieldList[u].isHierarchy=!1,this.fieldList[u].filterMembers.push(f),this.fieldList[u].childMembers.push(f),this.fieldList[u].members[r]={name:r,caption:e,parent:s,isNodeExpand:!1,isSelected:p}):"fetchSearchMembers"===i.action?(this.fieldList[u].searchMembers.push(f),f.expanded=!0,this.fieldList[u].currrentMembers[r]={name:r,caption:e,parent:s,isNodeExpand:!1,isSelected:!1}):this.calcChildMembers.push(f)}else"2"===c&&(v=r)}},t.prototype.getFieldListItems=function(n,t,i){for(var l,o,s=[],e=0,h=[].slice.call(n.querySelectorAll("row"));e<h.length;e++){var r=h[e],c=[].slice.call(r.querySelectorAll("ALL_MEMBER")).length>0,u=r.querySelector("DIMENSION_UNIQUE_NAME").textContent,f=r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,a=u===f&&"[measures]"!==u.toLowerCase()&&"[measures]"!==f.toLowerCase();s.push({pid:this.isMondrian||a?u+"~#^Dim":u,id:f,name:r.querySelector("HIERARCHY_CAPTION").textContent,caption:r.querySelector("HIERARCHY_CAPTION").textContent,tag:f,hasAllMember:c,allMember:c?r.querySelectorAll("ALL_MEMBER")[0].textContent:void 0,type:"string"})}o={hierarchy:s,hierarchySuccess:n,measures:[]};this.fieldListObj=o;l={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_DIMENSIONS",roles:i.dataSourceSettings.roles};this.getTreeData(l,this.loadDimensionElements.bind(this),i)},t.prototype.loadCalculatedMemberElements=function(n){var i,s,u,f,t;if(n.length>0)for(i=this.fieldListData,s={hasChildren:!0,isSelected:!1,id:"[Calculated Members].[_0]",name:"[Calculated Members].[_0]",caption:"Calculated Members",spriteCssClass:"e-calcMemberGroupCDB "+e,tag:"[Calculated Members].[_0]",type:"string"},i.length>0&&"[measures]"===i[0].id.toLowerCase()&&i.splice(0,0,s),u=0,f=n;u<f.length;u++)if(t=f[u],!this.fieldList[t.name]){var r=t.formula,h=(r.toLowerCase().indexOf("measure")>-1?"[Measures].":t.hierarchyUniqueName+".")+"["+t.name+"]",c=this.dataFields[t.name]&&this.dataFields[t.name].caption?this.dataFields[t.name].caption:this.mappingFields[t.name]&&this.mappingFields[t.name].caption?this.mappingFields[t.name].caption:t.name,l=t.formatString,o={hasChildren:!1,isSelected:!1,id:t.name,pid:"[Calculated Members].[_0]",name:t.name,caption:c,spriteCssClass:"e-calc-member "+(r.toLowerCase().indexOf("measure")>-1?"e-calc-measure-icon":"e-calc-dimension-icon")+" "+e,tag:h,formula:r,formatString:l,aggregateType:void 0,type:"CalculatedField",filter:[],dateMember:[],sort:"Ascending",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,isCalculatedField:!0,allowDragAndDrop:this.dataFields[t.name]?this.dataFields[t.name].allowDragAndDrop:!this.mappingFields[t.name]||this.mappingFields[t.name].allowDragAndDrop,showFilterIcon:this.dataFields[t.name]?this.dataFields[t.name].showFilterIcon:!this.mappingFields[t.name]||this.mappingFields[t.name].showFilterIcon,showSortIcon:this.dataFields[t.name]?this.dataFields[t.name].showSortIcon:!this.mappingFields[t.name]||this.mappingFields[t.name].showSortIcon,showEditIcon:this.dataFields[t.name]?this.dataFields[t.name].showEditIcon:!this.mappingFields[t.name]||this.mappingFields[t.name].showEditIcon,showRemoveIcon:this.dataFields[t.name]?this.dataFields[t.name].showRemoveIcon:!this.mappingFields[t.name]||this.mappingFields[t.name].showRemoveIcon,showValueTypeIcon:this.dataFields[t.name]?this.dataFields[t.name].showValueTypeIcon:!this.mappingFields[t.name]||this.mappingFields[t.name].showValueTypeIcon,showSubTotals:this.dataFields[t.name]?this.dataFields[t.name].showSubTotals:!this.mappingFields[t.name]||this.mappingFields[t.name].showSubTotals,fieldType:r.toLowerCase().indexOf("measure")>-1?"Measure":"Dimension",parentHierarchy:r.toLowerCase().indexOf("measure")>-1?void 0:t.hierarchyUniqueName};i.push(o);this.fieldList[o.id]=o;this.updateMembersOrder(t.name)}},t.prototype.loadDimensionElements=function(t,i,r){for(var v,o=[],h=[].slice.call(t.querySelectorAll("row")),c={},s=0,l=h;s<l.length;s++){var f=l[s],u=f.querySelector("DIMENSION_UNIQUE_NAME").textContent,y=f.querySelector("DEFAULT_HIERARCHY").textContent,a=f.querySelector("DIMENSION_CAPTION").textContent,p=u===y;u.toLowerCase().indexOf("[measure")>=0?c={hasChildren:!0,isSelected:!1,id:u,name:u,caption:a,spriteCssClass:"[measures]"===u.toLowerCase()?"e-measureGroupCDB-icon "+e:"e-dimensionCDB-icon "+e,tag:u,type:"string"}:n.isNullOrUndefined(h[0].querySelector("HIERARCHY_CAPTION"))&&o.push({hasChildren:!0,isSelected:!1,id:this.isMondrian||p?u+"~#^Dim":u,name:u,caption:a,spriteCssClass:"e-dimensionCDB-icon "+e,tag:u,defaultHierarchy:f.querySelector("DEFAULT_HIERARCHY").textContent,type:"string"})}o.splice(0,0,c);this.fieldListData=o;v={catalog:r.dataSourceSettings.catalog,cube:r.dataSourceSettings.cube,url:r.dataSourceSettings.url,LCID:r.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_SETS",roles:r.dataSourceSettings.roles};this.getTreeData(v,this.loadNamedSetElements.bind(this),r)},t.prototype.loadNamedSetElements=function(t,i,r){var o=n.extend([],this.rows,null,!0),f,u,c;o=o.concat(this.columns,this.filters);for(var l=this.fieldListData,a=[],s=0,v=o;s<v.length;s++)f=v[s],a.push(f.name);for(var y=[],h=0,p=[].slice.call(t.querySelectorAll("row"));h<p.length;h++)f=p[h],y.indexOf(f.querySelector("DIMENSIONS").textContent.split(".")[0])>=0||(l.push({hasChildren:!0,isSelected:!1,pid:f.querySelector("DIMENSIONS").textContent.split(".")[0],id:f.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+f.querySelector("DIMENSIONS").textContent.split(".")[0],name:f.querySelector("SET_DISPLAY_FOLDER").textContent,spriteCssClass:"e-folderCDB-icon "+e+" namedSets",caption:f.querySelector("SET_DISPLAY_FOLDER").textContent,type:"string"}),y.push(f.querySelector("DIMENSIONS").textContent.split(".")[0])),u="["+f.querySelector("SET_NAME").textContent.trim()+"]",c={hasChildren:!0,isNamedSets:!0,isSelected:a.indexOf("["+f.querySelector("SET_NAME").textContent+"]")>=0,pid:f.querySelector("SET_DISPLAY_FOLDER").textContent+"_"+f.querySelector("DIMENSIONS").textContent.split(".")[0],id:u,name:f.querySelector("SET_CAPTION").textContent,caption:this.dataFields[u]&&this.dataFields[u].caption?this.dataFields[u].caption:this.mappingFields[u]&&this.mappingFields[u].caption?this.mappingFields[u].caption:f.querySelector("SET_CAPTION").textContent,spriteCssClass:"e-namedSetCDB-icon "+e,tag:f.querySelector("EXPRESSION").textContent,type:"string",filter:[],dateMember:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},isHierarchy:!0,isExcelFilter:!1,allowDragAndDrop:this.dataFields[u]?this.dataFields[u].allowDragAndDrop:!this.mappingFields[u]||this.mappingFields[u].allowDragAndDrop,showFilterIcon:this.dataFields[u]?this.dataFields[u].showFilterIcon:!this.mappingFields[u]||this.mappingFields[u].showFilterIcon,showSortIcon:this.dataFields[u]?this.dataFields[u].showSortIcon:!this.mappingFields[u]||this.mappingFields[u].showSortIcon,showEditIcon:this.dataFields[u]?this.dataFields[u].showEditIcon:!this.mappingFields[u]||this.mappingFields[u].showEditIcon,showRemoveIcon:this.dataFields[u]?this.dataFields[u].showRemoveIcon:!this.mappingFields[u]||this.mappingFields[u].showRemoveIcon,showValueTypeIcon:this.dataFields[u]?this.dataFields[u].showValueTypeIcon:!this.mappingFields[u]||this.mappingFields[u].showValueTypeIcon,showSubTotals:this.dataFields[u]?this.dataFields[u].showSubTotals:!this.mappingFields[u]||this.mappingFields[u].showSubTotals},l.push(c),this.fieldList[u]=c,this.updateMembersOrder(u);r.hierarchy=this.fieldListData;r.hierarchySuccess=this.fieldListObj.hierarchySuccess;this.loadHierarchyElements(r)},t.prototype.loadHierarchyElements=function(t){for(var r,s,y,w,c,l,f,ot,d,st,ht=t.hierarchySuccess,o=t.hierarchy,g=n.extend([],this.rows,null,!0),nt=[],v=0,tt=g=g.concat(this.columns,this.filters);v<tt.length;v++)r=tt[v],nt.push(r.name);for(s=0,y=[].slice.call(ht.querySelectorAll("row"));s<y.length;s++){var u=(r=y[s]).querySelector("DIMENSION_UNIQUE_NAME").textContent,i=r.querySelector("HIERARCHY_UNIQUE_NAME").textContent,it=[].slice.call(r.querySelectorAll("ALL_MEMBER")).length>0,p=void 0;it?(w=r.querySelectorAll("ALL_MEMBER")[0].textContent.replace(/[\]']+/g,"").split("."),p=w[w.length-1].trim()):p=void 0;for(var h=r.querySelector("HIERARCHY_DISPLAY_FOLDER")?r.querySelector("HIERARCHY_DISPLAY_FOLDER").textContent:"",rt=[],b=0,ut=o;b<ut.length;b++)(f=ut[b]).tag===u&&rt.push(f);if(rt.length>0&&(c=u===i&&"[measures]"!==u.toLowerCase()&&"[measures]"!==i.toLowerCase(),"[measures]"!==u.toLowerCase()&&"[measures]"!==i.toLowerCase())){if(l=u+(this.isMondrian||c?"~#^Dim":""),""!==h){for(var a=u+(this.isMondrian||c?"~#^Dim":"")+"_"+h,ft=[],k=0,et=o;k<et.length;k++)(f=et[k]).tag===a&&f.pid===l&&ft.push(f);0===ft.length&&(ot={hasChildren:!0,isSelected:!1,pid:u+(this.isMondrian||c?"~#^Dim":""),id:a,name:h,spriteCssClass:"e-folderCDB-icon "+e,tag:a,caption:h,type:"string"},o.push(ot));l=a}d={hasChildren:!r.querySelector("HIERARCHY_ORIGIN")||"2"!==r.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==r.querySelector("HIERARCHY_ORIGIN").textContent,isSelected:nt.indexOf(i)>=0,pid:l,id:i,name:r.querySelector("HIERARCHY_CAPTION").textContent,spriteCssClass:(r.querySelector("HIERARCHY_ORIGIN")?"2"!==r.querySelector("HIERARCHY_ORIGIN").textContent&&"6"!==r.querySelector("HIERARCHY_ORIGIN").textContent?"e-hierarchyCDB-icon":"e-attributeCDB-icon":"e-hierarchyCDB-icon")+" "+e,hasAllMember:it,allMember:p,tag:i,caption:this.dataFields[i]&&this.dataFields[i].caption?this.dataFields[i].caption:this.mappingFields[i]&&this.mappingFields[i].caption?this.mappingFields[i].caption:r.querySelector("HIERARCHY_CAPTION").textContent,type:"string",filter:[],dateMember:[],sort:this.enableSort?this.sortObject[i]?this.sortObject[i]:"Ascending":"None",actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},levels:[],levelCount:1,isHierarchy:!!r.querySelector("HIERARCHY_ORIGIN")&&("2"===r.querySelector("HIERARCHY_ORIGIN").textContent||"6"===r.querySelector("HIERARCHY_ORIGIN").textContent),isExcelFilter:!1,allowDragAndDrop:this.dataFields[i]?this.dataFields[i].allowDragAndDrop:!this.mappingFields[i]||this.mappingFields[i].allowDragAndDrop,showFilterIcon:this.dataFields[i]?this.dataFields[i].showFilterIcon:!this.mappingFields[i]||this.mappingFields[i].showFilterIcon,showSortIcon:this.dataFields[i]?this.dataFields[i].showSortIcon:!this.mappingFields[i]||this.mappingFields[i].showSortIcon,showEditIcon:this.dataFields[i]?this.dataFields[i].showEditIcon:!this.mappingFields[i]||this.mappingFields[i].showEditIcon,showRemoveIcon:this.dataFields[i]?this.dataFields[i].showRemoveIcon:!this.mappingFields[i]||this.mappingFields[i].showRemoveIcon,showValueTypeIcon:this.dataFields[i]?this.dataFields[i].showValueTypeIcon:!this.mappingFields[i]||this.mappingFields[i].showValueTypeIcon,showSubTotals:this.dataFields[i]?this.dataFields[i].showSubTotals:!this.mappingFields[i]||this.mappingFields[i].showSubTotals};o.push(d);this.fieldList[i]=d;this.updateMembersOrder(i)}}st={catalog:t.dataSourceSettings.catalog,cube:t.dataSourceSettings.cube,url:t.dataSourceSettings.url,LCID:t.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_LEVELS",roles:t.dataSourceSettings.roles};this.getTreeData(st,this.loadLevelElements.bind(this),t)},t.prototype.updateMembersOrder=function(n){for(var i,t=0,r=this.sortSettings;t<r.length;t++)if(i=r[t],n===i.name&&i.membersOrder){this.fieldList[n].membersOrder=i.membersOrder;break}},t.prototype.loadLevelElements=function(n,t,i){var o=[],h=this.fieldListData,f,s,u,v;for(o=[],f=0,s=[].slice.call(n.querySelectorAll("row"));f<s.length;f++)if(u=s[f],1!==parseInt(u.querySelector("LEVEL_TYPE").textContent,10)&&"[measures]"!==u.querySelector("HIERARCHY_UNIQUE_NAME").textContent.toLowerCase()){var r=u.querySelector("HIERARCHY_UNIQUE_NAME").textContent,c=u.querySelector("LEVEL_UNIQUE_NAME").textContent,l=u.querySelector("LEVEL_CAPTION").textContent,a={hasChildren:!1,isChecked:!1,isSelected:this.fieldList[r].isSelected,pid:r,id:c,name:l,tag:c,spriteCssClass:"e-level-members e-hierarchy-level-"+parseInt(u.querySelector("LEVEL_NUMBER").textContent,10)+"-icon "+e,caption:l,type:"string"};o.push(a);this.fieldList[r]&&this.fieldList[r].spriteCssClass&&-1===this.fieldList[r].spriteCssClass.indexOf("e-attributeCDB-icon")?(this.fieldList[r].levels.push(a),this.fieldList[r].isHierarchy=!1):this.fieldList[r].isHierarchy=!0}this.fieldListData=h=h.concat(o);v={catalog:i.dataSourceSettings.catalog,cube:i.dataSourceSettings.cube,url:i.dataSourceSettings.url,LCID:i.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASURES",roles:i.dataSourceSettings.roles};this.getTreeData(v,this.loadMeasureElements.bind(this),i)},t.prototype.loadMeasureElements=function(t,i,r){for(var f,g,c,a,p,w,h,b=this.fieldListData,k=[],s=[],l=0,d=n.extend([],this.values,null,!0);l<d.length;l++)f=d[l],s.push(f.name);for("en-US"!==this.locale&&(g={catalog:r.dataSourceSettings.catalog,cube:r.dataSourceSettings.cube,url:r.dataSourceSettings.url,LCID:r.dataSourceSettings.localeIdentifier.toString(),request:"MDSCHEMA_MEASUREGROUPS",roles:r.dataSourceSettings.roles},this.getTreeData(g,this.loadMeasureGroups.bind(this),r)),c=0,a=[].slice.call(t.querySelectorAll("row"));c<a.length;c++){f=a[c];var o=n.isNullOrUndefined(f.querySelector("MEASUREGROUP_NAME"))?"":f.querySelector("MEASUREGROUP_NAME").textContent,u=f.querySelector("MEASURE_UNIQUE_NAME").textContent,it=f.querySelector("DEFAULT_FORMAT_STRING")?f.querySelector("DEFAULT_FORMAT_STRING").textContent:"#,#",nt=f.querySelector("MEASURE_AGGREGATOR")?f.querySelector("MEASURE_AGGREGATOR").textContent:"1";if(!(k.indexOf(o)>=0)){if("en-US"!==this.locale){for(var v=[],y=0,tt=this.fieldListObj.measuresGroups;y<tt.length;y++)p=tt[y],p.querySelector("MEASUREGROUP_NAME").textContent===o&&v.push(p);h=v.length>0?v[0].querySelector("MEASUREGROUP_CAPTION").textContent:o}else h=o;""!==o&&(b.push({hasChildren:!0,isChecked:!1,isSelected:!1,pid:"[Measures]",id:o,name:h,spriteCssClass:"e-measureCDB e-folderCDB-icon "+e,tag:o,caption:h,aggregateType:this.getAggregateType(o,nt),type:"string"}),k.push(o))}w={hasChildren:!1,isSelected:s.indexOf(u)>=0,pid:""===o?"[Measures]":o,id:u,name:f.querySelector("MEASURE_CAPTION").textContent,spriteCssClass:"e-measure-icon "+e,tag:u,caption:this.dataFields[u]&&this.dataFields[u].caption?this.dataFields[u].caption:this.mappingFields[u]&&this.mappingFields[u].caption?this.mappingFields[u].caption:f.querySelector("MEASURE_CAPTION").textContent,aggregateType:this.getAggregateType(u,nt),type:"number",filter:[],actualFilter:[],filterMembers:[],childMembers:[],searchMembers:[],members:{},currrentMembers:{},formatString:it,allowDragAndDrop:this.dataFields[u]?this.dataFields[u].allowDragAndDrop:!this.mappingFields[u]||this.mappingFields[u].allowDragAndDrop,showFilterIcon:this.dataFields[u]?this.dataFields[u].showFilterIcon:!this.mappingFields[u]||this.mappingFields[u].showFilterIcon,showSortIcon:this.dataFields[u]?this.dataFields[u].showSortIcon:!this.mappingFields[u]||this.mappingFields[u].showSortIcon,showEditIcon:this.dataFields[u]?this.dataFields[u].showEditIcon:!this.mappingFields[u]||this.mappingFields[u].showEditIcon,showRemoveIcon:this.dataFields[u]?this.dataFields[u].showRemoveIcon:!this.mappingFields[u]||this.mappingFields[u].showRemoveIcon,showValueTypeIcon:this.dataFields[u]?this.dataFields[u].showValueTypeIcon:!this.mappingFields[u]||this.mappingFields[u].showValueTypeIcon,showSubTotals:this.dataFields[u]?this.dataFields[u].showSubTotals:!this.mappingFields[u]||this.mappingFields[u].showSubTotals};b.push(w);this.fieldList[u]=w;s.indexOf(u)>=0&&s.splice(s.indexOf(u),1)}this.measureReportItems=s},t.prototype.loadMeasureGroups=function(t){n.isNullOrUndefined(this.fieldListObj)&&(this.fieldListObj={});this.fieldListObj.measuresGroups=[].slice.call(t.querySelectorAll("row"))},t.prototype.doAjaxPost=function(t,i,r,u,f){new n.Ajax({mode:!1,contentType:"text/xml",url:i,data:r,dataType:"xml",type:t,beforeSend:this.beforeSend.bind(this),onSuccess:function(n,t){var i=(new DOMParser).parseFromString(n,"text/xml");u(i,t,f)},onFailure:function(n){return n}}).send()},t.prototype.beforeSend=function(n){this.dataSourceSettings.authentication.userName&&this.dataSourceSettings.authentication.password&&n.httpRequest.setRequestHeader("Authorization","Basic "+btoa(this.dataSourceSettings.authentication.userName+":"+this.dataSourceSettings.authentication.password))},t.prototype.getSoapMsg=function(n,t){var i=this.getConnectionInfo(n.url,n.localeIdentifier);return this.isMondrian?'<SOAP-ENV:Envelope xmlns:SOAP-ENV="http://schemas.xmlsoap.org/soap/envelope/" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" SOAP-ENV:encodingStyle="http://schemas.xmlsoap.org/soap/encoding/"><SOAP-ENV:Body><Execute xmlns="urn:schemas-microsoft-com:xml-analysis"><Command><Statement><![CDATA['+t+"]\]><\/Statement><\/Command><Properties><PropertyList><DataSourceInfo><\/DataSourceInfo><Catalog>"+n.catalog+"<\/Catalog><AxisFormat>TupleFormat<\/AxisFormat><Content>Data<\/Content><Format>Multidimensional<\/Format><\/PropertyList><\/Properties><\/Execute><\/SOAP-ENV:Body><\/SOAP-ENV:Envelope>":'<Envelope xmlns="http://schemas.xmlsoap.org/soap/envelope/"> <Header><\/Header> <Body> <Execute xmlns="urn:schemas-microsoft-com:xml-analysis"> <Command> <Statement> '+t+" <\/Statement> <\/Command> <Properties> <PropertyList> <Catalog>"+n.catalog+"<\/Catalog> <LocaleIdentifier>"+i.LCID+"<\/LocaleIdentifier>"+(n.roles?"<Roles>"+n.roles+"<\/Roles>":"")+"<\/PropertyList> <\/Properties> <\/Execute> <\/Body> <\/Envelope>"},t.prototype.getConnectionInfo=function(t,i){var u={url:"",LCID:n.isNullOrUndefined(i)?"1033":i.toString()},f,e,r;if(""!==t)for(f=0,e=t.split(";");f<e.length;f++)r=e[f],r.toLowerCase().indexOf("locale")<0&&0===u.url.length?u.url=r:r.toLowerCase().indexOf("locale")>=0&&(u.LCID=r.replace(/ /g,"").split("=")[1]);return u},t.prototype.getMDXQuery=function(n){return fu.getCellSets(n,this,!0,void 0,!0),this.mdxQuery},t}();const wy=ejdashboard.svgbase;dl=function(){function t(n){this.parent=n}return t.prototype.getModuleName=function(){return"chartExport"},t.prototype.pdfChartExport=function(t,i,r,u){var f=this,v=[this.parent.chart],e=this.getChartInfo(v),h=e.width,c=e.height,o=this.parent.chart.svgObject;this.parent.chart.enableCanvas||(o=n.createElement("canvas",{id:"ej2-canvas",attrs:{width:h.toString(),height:c.toString()}}));var l=window.URL.createObjectURL(new Blob([(new XMLSerializer).serializeToString(e.svg)],{type:"image/svg+xml"})),s=new Image,y=o.getContext("2d");return s.src=l,new Promise(function(e){s.onload=function(){f.pdfDocument=n.isNullOrUndefined(i)?new a.PdfDocument:i;y.drawImage(s,0,0);window.URL.revokeObjectURL(l);f.exportPdf(o,r,u,h,c,t);e(f.pdfDocument)}})},t.prototype.getChartInfo=function(t,i){var e,u=0,f=0,o=this.parent.chart.enableCanvas,r=new wy.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200});return t.map(function(t){var s=t.svgObject.cloneNode(!0),h=t.renderer.createGroup({style:n.isNullOrUndefined(i)||i?"transform: translateY("+f+"px)":"transform: translateX("+u+"px)"});"transparent"===(e=s.childNodes[0]?s.childNodes[0].getAttribute("fill"):"transparent")&&(e=t.theme.indexOf("Dark")>-1||"HighContrast"===t.theme?"rgba(0, 0, 0, 1)":"rgba(255, 255, 255, 1)");o||h.appendChild(s);u=t.availableSize.width;f=t.availableSize.height;o||r.appendChild(h)}),o||(r.setAttribute("width",u+""),r.setAttribute("height",f+""),r.setAttribute("style","background-color: "+e+";")),{width:u,height:f,svg:r}},t.prototype.exportPdf=function(t,i,u,f,e,o){var g=this,v=this.pdfDocument.sections.add(),y=this.pdfDocument.pageSettings.width,h=this.pdfDocument.pageSettings.height,p=this.pdfDocument.pageSettings.margins,w=f+p.left+p.right,b,s,c,k,l,d;return this.pdfDocument.pageSettings.size=new a.SizeF(w,h),b=this.exportProperties.fileName?this.exportProperties.fileName:n.isNullOrUndefined(o)||n.isNullOrUndefined(o.fileName)?"default":o.fileName,(this.exportProperties.width||this.exportProperties.height?(this.pdfDocument.pageSettings.orientation=this.exportProperties.width>this.exportProperties.height||!this.exportProperties.height&&this.exportProperties.width>h||!this.exportProperties.width&&y>this.exportProperties.height?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,this.pdfDocument.pageSettings.size=new a.SizeF(this.exportProperties.width?this.exportProperties.width:y,this.exportProperties.height?this.exportProperties.height:h)):(this.pdfDocument.pageSettings.orientation=0===this.exportProperties.orientation||this.exportProperties.orientation?this.exportProperties.orientation:n.isNullOrUndefined(o)||n.isNullOrUndefined(o.pageOrientation)||"Landscape"===o.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,n.isNullOrUndefined(o)||n.isNullOrUndefined(o.pageSize)||(this.pdfDocument.pageSettings.size=r.getPageSize(o.pageSize))),n.isNullOrUndefined(this.exportProperties.pdfMargins))||(s=this.pdfDocument.pageSettings.margins,s.top=n.isNullOrUndefined(this.exportProperties.pdfMargins.top)?s.top:this.exportProperties.pdfMargins.top,s.bottom=n.isNullOrUndefined(this.exportProperties.pdfMargins.bottom)?s.bottom:this.exportProperties.pdfMargins.bottom,s.left=n.isNullOrUndefined(this.exportProperties.pdfMargins.left)?s.left:this.exportProperties.pdfMargins.left,s.right=n.isNullOrUndefined(this.exportProperties.pdfMargins.right)?s.right:this.exportProperties.pdfMargins.right),v.setPageSettings(this.pdfDocument.pageSettings),h=this.pdfDocument.pageSettings.height,c=t.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),c=c.slice(c.indexOf(",")+1),k=new a.PdfBitmap(c),l=v.pages.add(),l.graphics.drawImage(k,0,0,h<e||this.exportProperties.width||this.pdfDocument.pageSettings.size?l.getClientSize().width:w,h<e?l.getClientSize().height:e),u||i?u&&(this.blobPromise=this.pdfDocument.save()):(this.pdfDocument.save(b+".pdf"),this.pdfDocument.destroy()),d={type:"PDF",promise:u?this.blobPromise:null},this.parent.trigger(ke,d),new Promise(function(){g.pdfDocument})},t.prototype.destroy=function(){this.pdfDocument&&(this.pdfDocument.destroy(),this.pdfDocument=null);this.blobPromise&&(this.blobPromise=null);this.exportProperties&&(this.exportProperties=null)},t}();const by=ejdashboard.fileutils;var or=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ky=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property(!0)],i.prototype,"showFilterIcon",void 0),u([n.Property(!0)],i.prototype,"showSortIcon",void 0),u([n.Property(!0)],i.prototype,"showRemoveIcon",void 0),u([n.Property(!0)],i.prototype,"showValueTypeIcon",void 0),u([n.Property("Both")],i.prototype,"displayMode",void 0),u([n.Property(!0)],i.prototype,"allowDragAndDrop",void 0),u([n.Property(!1)],i.prototype,"showFieldsPanel",void 0),i}(n.ChildProperty),dy=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property(!1)],i.prototype,"allowAdding",void 0),u([n.Property(!1)],i.prototype,"allowEditing",void 0),u([n.Property(!1)],i.prototype,"allowDeleting",void 0),u([n.Property(!1)],i.prototype,"allowCommandColumns",void 0),u([n.Property(!1)],i.prototype,"allowInlineEditing",void 0),u([n.Property("Normal")],i.prototype,"mode",void 0),u([n.Property(!0)],i.prototype,"allowEditOnDblClick",void 0),u([n.Property(!0)],i.prototype,"showConfirmDialog",void 0),u([n.Property(!1)],i.prototype,"showDeleteConfirmDialog",void 0),i}(n.ChildProperty),gy=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property()],i.prototype,"measure",void 0),u([n.Property()],i.prototype,"label",void 0),u([n.Property("NotEquals")],i.prototype,"conditions",void 0),u([n.Property()],i.prototype,"value1",void 0),u([n.Property()],i.prototype,"value2",void 0),i}(n.ChildProperty),np=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property(!1)],i.prototype,"showHyperlink",void 0),u([n.Property(!1)],i.prototype,"showRowHeaderHyperlink",void 0),u([n.Property(!1)],i.prototype,"showColumnHeaderHyperlink",void 0),u([n.Property(!1)],i.prototype,"showValueCellHyperlink",void 0),u([n.Property(!1)],i.prototype,"showSummaryCellHyperlink",void 0),u([n.Collection([],gy)],i.prototype,"conditionalSettings",void 0),u([n.Property()],i.prototype,"headerText",void 0),u([n.Property("")],i.prototype,"cssClass",void 0),i}(n.ChildProperty),tp=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property(5)],i.prototype,"columnPageSize",void 0),u([n.Property(5)],i.prototype,"rowPageSize",void 0),u([n.Property(1)],i.prototype,"currentColumnPage",void 0),u([n.Property(1)],i.prototype,"currentRowPage",void 0),i}(n.ChildProperty),ip=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property("Bottom")],i.prototype,"position",void 0),u([n.Property(!1)],i.prototype,"isInversed",void 0),u([n.Property(!0)],i.prototype,"showRowPager",void 0),u([n.Property(!0)],i.prototype,"showColumnPager",void 0),u([n.Property(!0)],i.prototype,"showRowPageSize",void 0),u([n.Property(!0)],i.prototype,"showColumnPageSize",void 0),u([n.Property([10,50,100,200])],i.prototype,"rowPageSizes",void 0),u([n.Property([5,10,20,50,100])],i.prototype,"columnPageSizes",void 0),u([n.Property(!1)],i.prototype,"enableCompactView",void 0),u([n.Property()],i.prototype,"template",void 0),i}(n.ChildProperty),rp=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return or(i,t),u([n.Property("Table")],i.prototype,"view",void 0),u([n.Property("Table")],i.prototype,"primary",void 0),i}(n.ChildProperty),gl=function(t){function i(i,r){var u=t.call(this,i,r)||this;return u.verticalScrollScale=1,u.horizontalScrollScale=1,u.scrollerBrowserLimit=8e6,u.lastSortInfo={},u.lastFilterInfo={},u.lastAggregationInfo={},u.lastCalcFieldInfo={},u.isScrolling=!1,u.allowEngineExport=!1,u.isInitial=!0,u.shiftLockedPos=[],u.savedSelectedCellsPos=[],u.cellSelectionPos=[],u.isPopupClicked=!1,u.isMouseDown=!1,u.isMouseUp=!1,u.fieldsType={},u.remoteData=[],u.defaultItems={},u.isCellBoxMultiSelection=!1,u.gridHeaderCellInfo=[],u.gridCellCollection={},u.rowRangeSelection={enable:!1,startIndex:0,endIndex:0},u.isStaticRefresh=!1,u.resizeInfo={},u.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}},u.pivotColumns=[],u.totColWidth=0,u.posCount=0,u.isModified=!1,u.isInitialRendering=!1,u.needsID=!0,u.pivotRefresh=n.Component.prototype.refresh,u.isServerWaitingPopup=!1,u.actionObj={},u.defaultFieldListOrder="None",u.isVirtualScrollEventsAdded=!1,u.mScrollBarEvents=[],u.destroyEngine=!1,u.pivotView=u,n.setValue("mergePersistData",u.mergePersistPivotData,u),u}return or(i,t),i.prototype.requiredModules=function(){var n=[];return this.showGroupingBar&&n.push({args:[this],member:"groupingBar"}),this.allowConditionalFormatting&&n.push({args:[this],member:"conditionalFormatting"}),this.allowNumberFormatting&&n.push({args:[this],member:"numberFormatting"}),this.allowCalculatedField&&n.push({args:[this],member:"calculatedField"}),this.showToolbar&&(this.toolbar.length>0||this.toolbarTemplate)&&n.push({args:[this],member:"toolbar"}),this.showFieldList&&n.push({args:[this],member:"fieldList"}),this.allowExcelExport&&n.push({args:[this],member:"excelExport"}),this.allowPdfExport&&(n.push({args:[this],member:"pdfExport"}),n.push({args:[this],member:"chartExport"})),this.enableVirtualization&&n.push({args:[this],member:"virtualscroll"}),this.allowGrouping&&n.push({args:[this],member:"grouping"}),(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&n.push({args:[this],member:"drillThrough"}),"Table"!==this.displayOption.view&&n.push({args:[this],member:"pivotChart"}),this.enablePaging&&n.push({args:[this],member:"pager"}),n},i.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.dataType="olap",this.olapEngineModule=new kl):(this.dataType="pivot",this.engineModule=new ls);this.isAdaptive=n.Browser.isDevice;n.Browser.isIE||"edge"===n.Browser.info.name?this.scrollerBrowserLimit=15e5:"chrome"===n.Browser.info.name&&(this.scrollerBrowserLimit=15e6);this.isTouchMode=!!n.closest(this.element,"e-bigger");this.initProperties();this.renderToolTip();this.keyboardModule=new ov(this);this.contextMenuModule=new sv(this);this.globalize=new n.Internationalization(this.locale);(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.commonModule=new wa(this));!this.allowPdfExport||"Both"!==this.displayOption.view&&"Chart"!==this.displayOption.view||(this.chartExportModule=new dl(this));this.defaultLocale={grandTotal:"Grand Total",total:"Total",value:"Value",noValue:"No value",row:"Row",column:"Column",collapse:"Collapse",expand:"Expand",rowAxisPrompt:"Drop row here",columnAxisPrompt:"Drop column here",valueAxisPrompt:"Drop value here",filterAxisPrompt:"Drop filter here",filter:"Filter",filtered:"Filtered",sort:"Sort",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",close:"Close",cancel:"Cancel","delete":"Delete",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",alert:"Alert",warning:"Warning",ok:"OK",search:"Search",drag:"Drag",remove:"Remove",allFields:"All Fields",formula:"Formula",addToRow:"Add to Row",addToColumn:"Add to Column",addToValue:"Add to Value",addToFilter:"Add to Filter",emptyData:"No records to display",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",all:"All",multipleItems:"Multiple items",member:"Member",label:"Label",date:"Date",enterValue:"Enter value",chooseDate:"Enter date",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",MoreOption:"More...",NotEquals:"Not Equals",AllValues:"All Values",conditionalFormating:"Conditional Formatting",apply:"Apply",condition:"Add Condition",formatLabel:"Format",valueFieldSettings:"Value field settings",baseField:"Base field",baseItem:"Base item",summarizeValuesBy:"Summarize values by",sourceName:"Field name :",sourceCaption:"Field caption",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",details:"Details",manageRecords:"Manage Records",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",save:"Save a report","new":"Create a new report",load:"Load",saveAs:"Save as current report",rename:"Rename a current report",deleteReport:"Delete a current report","export":"Export",subTotals:"Sub totals",grandTotals:"Grand totals",reportName:"Report Name :",pdf:"PDF",excel:"Excel",csv:"CSV",png:"PNG",jpeg:"JPEG",svg:"SVG",mdxQuery:"MDX Query",showSubTotals:"Show subtotals",doNotShowSubTotals:"Do not show subtotals",showSubTotalsRowsOnly:"Show subtotals rows only",showSubTotalsColumnsOnly:"Show subtotals columns only",showGrandTotals:"Show grand totals",doNotShowGrandTotals:"Do not show grand totals",showGrandTotalsRowsOnly:"Show grand totals rows only",showGrandTotalsColumnsOnly:"Show grand totals columns only",fieldList:"Show fieldlist",grid:"Show table",toolbarFormatting:"Conditional formatting",chart:"Chart",reportMsg:"Please enter vaild report name!!!",reportList:"Report list",removeConfirm:"Are you sure you want to delete this report?",emptyReport:"No reports found!!",bar:"Bar",pie:"Pie",funnel:"Funnel",doughnut:"Doughnut",pyramid:"Pyramid",stackingcolumn:"Stacked Column",stackingarea:"Stacked Area",stackingbar:"Stacked Bar",stackingline:"Stacked Line",stepline:"Step Line",steparea:"Step Area",splinearea:"Spline Area",spline:"Spline",stackingcolumn100:"100% Stacked Column",stackingbar100:"100% Stacked Bar",stackingarea100:"100% Stacked Area",stackingline100:"100% Stacked Line",bubble:"Bubble",pareto:"Pareto",radar:"Radar",line:"Line",area:"Area",scatter:"Scatter",polar:"Polar",of:"of",emptyFormat:"No format found!!!",emptyInput:"Enter a value",newReportConfirm:"Do you want to save the changes to this report?",emptyReportName:"Enter a report name",qtr:"Qtr","null":"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",aggregate:"Aggregate",drillThrough:"Drill Through",ascending:"Ascending",descending:"Descending",number:"Number",currency:"Currency",percentage:"Percentage",formatType:"Format Type",customText:"Currency Symbol",symbolPosition:"Symbol Position",left:"Left",right:"Right",grouping:"Grouping","true":"True","false":"False",decimalPlaces:"Decimal Places",numberFormat:"Number Formatting",memberType:"Field Type",formatString:"Format",expressionField:"Expression",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",selectedHierarchy:"Parent Hierarchy",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",Percent:"Percent",Currency:"Currency",Custom:"Custom",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",drillError:"Cannot show the raw items of calculated fields.",caption:"Field Caption",copy:"Copy",defaultReport:"Sample Report",customFormatString:"Custom Format",invalidFormat:"Invalid Format.",group:"Group",unGroup:"Ungroup",invalidSelection:"Cannot group that selection.",groupName:"Enter the caption to display in header",captionName:"Enter the caption for group field",selectedItems:"Selected items",groupFieldCaption:"Field caption",groupTitle:"Group name",startAt:"Starting at",endAt:"Ending at",groupBy:"Interval by",selectGroup:"Select groups",multipleAxes:"Multiple Axis",showLegend:"Show Legend",exit:"Exit",chartTypeSettings:"Chart Type Settings",ChartType:"Chart Type",yes:"Yes",no:"No",numberFormatMenu:"Number Formatting...",conditionalFormatingMenu:"Conditional Formatting...",removeCalculatedField:"Are you sure you want to delete this calculated field?",replaceConfirmBefore:"A report named ",replaceConfirmAfter:" already exists. Do you want to replace it?",invalidJSON:"Invalid JSON data",invalidCSV:"Invalid CSV data",stacked:"Stacked",single:"Single",combined:"Combined",multipleAxisMode:"Multiple Axis Mode",grandTotalPosition:"Grand totals position",top:"Top",bottom:"Bottom",None:"None",rowPage:"Row pager",rowPerPage:"Rows per page",columnPage:"Column pager",columnPerPage:"Columns per page",goToFirstPage:"Go to first page",goToPreviousPage:"Go to previous page",goToNextPage:"Go to next page",goToLastPage:"Go to last page",subTotalPosition:"Subtotals position",auto:"Auto"};this.localeObj=new n.L10n(this.getModuleName(),this.defaultLocale,this.locale);this.renderContextMenu();this.isDragging=!1;this.addInternalEvents()},i.prototype.onBeforeTooltipOpen=function(n){n.element.classList.add("e-pivottooltipwrap")},i.prototype.renderToolTip=function(){this.showTooltip?(this.tooltip=this.tooltipTemplate?new b.Tooltip({target:"td.e-valuescontent",cssClass:"e-pivottooltiptemplate"+(this.cssClass?" "+this.cssClass:""),showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}):new b.Tooltip({target:"td.e-valuescontent",cssClass:this.cssClass,showTipPointer:!1,position:"BottomRight",mouseTrail:!0,enableRtl:this.enableRtl,locale:this.locale,enableHtmlSanitizer:this.enableHtmlSanitizer,beforeRender:this.setToolTip.bind(this),beforeOpen:this.onBeforeTooltipOpen}),this.tooltip.isStringTemplate=!0,this.tooltip.appendTo(this.element)):this.tooltip&&this.tooltip.destroy()},i.prototype.renderContextMenu=function(){var i,f,n,e,o,t;if(this.gridSettings.contextMenuItems||this.allowGrouping&&"pivot"===this.dataType){var s=[],r=[],h=[],u=[],c=[],l=[],a=[];if(this.gridSettings.contextMenuItems)for(i=0,f=this.gridSettings.contextMenuItems;i<f.length;i++)n=f[i],"string"==typeof n&&-1!==this.getDefaultItems().indexOf(n)?-1!==n.toString().toLowerCase().indexOf("aggregate")&&"pivot"===this.dataType?(a=[{text:this.localeObj.getConstant("Sum")}],e=this.buildDefaultItems("Aggregate"),e.items=a,c.push(e)):-1!==n.toString().toLowerCase().indexOf("export")?u.push(this.buildDefaultItems(n)):s.push(this.buildDefaultItems(n)):"string"!=typeof n&&h.push(n);(this.allowGrouping&&"pivot"===this.dataType&&(this.getFieldByID(this.element.id+"_custom_group",this.gridSettings.contextMenuItems)||r.push(this.buildDefaultItems("Group")),this.getFieldByID(this.element.id+"_custom_ungroup",this.gridSettings.contextMenuItems)||r.push(this.buildDefaultItems("Ungroup"))),u.length>0)&&(o=this.buildDefaultItems("export"),o.items=u,l.push(o));t=[];Array.prototype.push.apply(t,c);Array.prototype.push.apply(t,s);Array.prototype.push.apply(t,r);Array.prototype.push.apply(t,l);Array.prototype.push.apply(t,h);this.setProperties({gridSettings:{contextMenuItems:t}},!0)}},i.prototype.getFieldByID=function(n,t){return new ut.DataManager({json:t}).executeLocal((new ut.Query).where("id","equal",n))[0]},i.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},i.prototype.getDefaultItems=function(){return["Drillthrough","Expand","Collapse","Pdf Export","Excel Export","Csv Export","Sort Ascending","Sort Descending","Aggregate","CalculatedField"]},i.prototype.buildDefaultItems=function(n){var t;switch(n){case"Aggregate":t={text:this.localeObj.getConstant("aggregate"),target:"th.e-valuesheader,td.e-valuescontent,.e-stot.e-rowsheader",id:this.element.id+"_aggregate"};break;case"CalculatedField":t={text:this.localeObj.getConstant("CalculatedField"),target:"td.e-valuescontent",id:this.element.id+"_CalculatedField"};break;case"Drillthrough":t={text:this.localeObj.getConstant("drillThrough"),target:"td.e-valuescontent",id:this.element.id+"_drillthrough_menu",iconCss:"e-pivotview-grid "+e};break;case"export":t={text:this.localeObj.getConstant("export"),target:"td.e-valuescontent",id:this.element.id+"_exporting",iconCss:"e-pivotview-export "+e};break;case"Pdf Export":t={text:this.localeObj.getConstant("pdf"),id:this.element.id+"_pdf",iconCss:"e-pivotview-pdf-export "+e};break;case"Excel Export":t={text:this.localeObj.getConstant("excel"),id:this.element.id+"_excel",iconCss:"e-pivotview-excel-export "+e};break;case"Csv Export":t={text:this.localeObj.getConstant("csv"),id:this.element.id+"_csv",iconCss:"e-pivotview-csv-export "+e};break;case"Expand":t={text:this.localeObj.getConstant("expand"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_expand",iconCss:"e-pivotview-expand "+e};break;case"Collapse":t={text:this.localeObj.getConstant("collapse"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_collapse",iconCss:"e-pivotview-collapse "+e};break;case"Sort Ascending":t={text:this.localeObj.getConstant("ascending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortasc",iconCss:"e-icon-ascending "+e};break;case"Sort Descending":t={text:this.localeObj.getConstant("descending"),target:"th.e-valuesheader,.e-stot",id:this.element.id+"_sortdesc",iconCss:"e-icon-descending "+e};break;case"Group":t={text:this.localeObj.getConstant("group"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_group",iconCss:"e-pivotview-group "+e};break;case"Ungroup":t={text:this.localeObj.getConstant("unGroup"),target:"td.e-rowsheader,.e-columnsheader",id:this.element.id+"_custom_ungroup",iconCss:"e-pivotview-ungroup "+e}}return this.defaultItems[n]={text:t.text,id:t.id,target:t.target,iconCss:t.iconCss},this.defaultItems[n]},i.prototype.initProperties=function(){this.pivotRefresh=n.Component.prototype.refresh;this.minHeight=n.isNullOrUndefined(this.minHeight)?300:this.minHeight<10?10:this.minHeight;this.isScrolling=!1;this.allowServerDataBinding=!1;this.isStaticRefresh=!1;this.setProperties({pivotValues:[]},!0);delete this.bulkChanges.pivotValues;this.allowServerDataBinding=!0;this.scrollPosObject={vertical:0,horizontal:0,verticalSection:0,horizontalSection:0,top:0,left:0,scrollDirection:{direction:"",position:0}};this.queryCellInfo=this.gridSettings.queryCellInfo?this.gridSettings.queryCellInfo.bind(this):void 0;this.headerCellInfo=this.gridSettings.headerCellInfo?this.gridSettings.headerCellInfo.bind(this):void 0;this.resizing=this.gridSettings.resizing?this.gridSettings.resizing.bind(this):void 0;this.resizeStop=this.gridSettings.resizeStop?this.gridSettings.resizeStop.bind(this):void 0;this.pdfHeaderQueryCellInfo=this.gridSettings.pdfHeaderQueryCellInfo?this.gridSettings.pdfHeaderQueryCellInfo:void 0;this.pdfQueryCellInfo=this.gridSettings.pdfQueryCellInfo?this.gridSettings.pdfQueryCellInfo:void 0;this.excelHeaderQueryCellInfo=this.gridSettings.excelHeaderQueryCellInfo?this.gridSettings.excelHeaderQueryCellInfo:void 0;this.excelQueryCellInfo=this.gridSettings.excelQueryCellInfo?this.gridSettings.excelQueryCellInfo:void 0;this.columnDragStart=this.gridSettings.columnDragStart?this.gridSettings.columnDragStart.bind(this):void 0;this.columnDrag=this.gridSettings.columnDrag?this.gridSettings.columnDrag.bind(this):void 0;this.columnDrop=this.gridSettings.columnDrop?this.gridSettings.columnDrop.bind(this):void 0;this.beforeColumnsRender=this.gridSettings.columnRender?this.gridSettings.columnRender:void 0;this.selected=this.gridSettings.cellSelected?this.gridSettings.cellSelected:void 0;this.cellDeselected=this.gridSettings.cellDeselected?this.gridSettings.cellDeselected:void 0;this.rowSelected=this.gridSettings.rowSelected?this.gridSettings.rowSelected:void 0;this.rowDeselected=this.gridSettings.rowDeselected?this.gridSettings.rowDeselected:void 0;this.chartTooltipRender=this.chartSettings.tooltipRender?this.chartSettings.tooltipRender:void 0;this.chartLegendClick=this.chartSettings.legendClick?this.chartSettings.legendClick:void 0;this.chartLoaded=this.chartSettings.loaded?this.chartSettings.loaded:void 0;this.chartLoad=this.chartSettings.load?this.chartSettings.load:void 0;this.chartResized=this.chartSettings.resized?this.chartSettings.resized:void 0;this.chartAxisLabelRender=this.chartSettings.axisLabelRender?this.chartSettings.axisLabelRender:void 0;this.multiLevelLabelClick=this.chartSettings.multiLevelLabelClick?this.chartSettings.multiLevelLabelClick:void 0;this.chartPointClick=this.chartSettings.pointClick?this.chartSettings.pointClick:void 0;this.contextMenuClick=this.gridSettings.contextMenuClick?this.gridSettings.contextMenuClick:void 0;this.contextMenuOpen=this.gridSettings.contextMenuOpen?this.gridSettings.contextMenuOpen:void 0;this.beforePdfExport=this.gridSettings.beforePdfExport?this.gridSettings.beforePdfExport.bind(this):void 0;this.beforeExcelExport=this.gridSettings.beforeExcelExport?this.gridSettings.beforeExcelExport.bind(this):void 0;this.multiLevelLabelRender=this.chartSettings.multiLevelLabelRender?this.chartSettings.multiLevelLabelRender:void 0;null===this.gridSettings.rowHeight&&(this.isTouchMode?this.setProperties({gridSettings:{rowHeight:36}},!0):this.setProperties({gridSettings:{rowHeight:this.isAdaptive?36:30}},!0));this.chartSettings&&this.chartSettings.showMemberSeries&&!this.chartSettings.showPointColorByMembers&&this.setProperties({chartSettings:{showPointColorByMembers:!0}},!0);this.element.style.height="100%";this.enableVirtualization&&this.updatePageSettings(!0);this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;this.allowGrouping&&!this.isCellBoxMultiSelection&&(this.isCellBoxMultiSelection=!0,this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0));"Table"!==this.displayOption.view&&(this.pivotChartModule=new le);this.currentView=this.currentView?this.currentView:"Both"===this.displayOption.view?this.displayOption.primary:this.displayOption.view},i.prototype.updatePageSettings=function(n){var i,r,t;this.enableVirtualization&&(i=1,r=1,this.dataSourceSettings.values.length>1&&"pivot"===this.dataType&&("row"===this.dataSourceSettings.valueAxis?r=this.dataSourceSettings.values.length:i=this.dataSourceSettings.values.length),t=this.getHeightAsNumber(),isNaN(t)&&(t=this.element.offsetHeight),this.pageSettings={currentColumnPage:n?1:this.pageSettings.currentColumnPage,currentRowPage:n?1:this.pageSettings.currentRowPage,columnPageSize:Math.ceil((Math.floor(this.getWidthAsNumber()/this.gridSettings.columnWidth)-1)/i),rowPageSize:Math.ceil(Math.floor(t/this.gridSettings.rowHeight)/r)})},i.prototype.render=function(){this.loadData()},i.prototype.loadData=function(){if(this.dataSourceSettings.formatSettings.length>0)for(var i=this.dataSourceSettings.formatSettings,t=0;t<i.length;t++)n.isNullOrUndefined(i[t].maximumFractionDigits)&&n.isNullOrUndefined(i[t].minimumFractionDigits)||null!==i[t].format.match(/^(P|N|C|P[0-9]|C[0-9]|N[0-9])$/g)||(i[t].maximumFractionDigits=void 0,i[t].minimumIntegerDigits=void 0);"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.initialLoad(),"Chart"!==this.displayOption.view&&this.renderEmptyGrid(),this.showWaitingPopup()):new n.Fetch(this.dataSourceSettings.url,"GET").send().then(function(n){return"string"==typeof n?n:n.text()}).then(this.onReadyStateChange.bind(this)):this.initialLoad()},i.prototype.onSuccess=function(t){var w,b,k,i,o,f,e,a,v,y;if(this.request.readyState===XMLHttpRequest.DONE)if("onExcelExport"===this.currentAction||"onCsvExport"===this.currentAction)"OK"===this.request.statusText&&(w=this.request.response,b=n.isNullOrUndefined(t.fileName)?"onExcelExport"===this.currentAction?"default.xlsx":"default.csv":t.fileName,by.Save.save(b,w));else{this.isServerWaitingPopup=!0;try{if(k={action:this.currentAction,response:this.request.responseText},this.trigger(ks,k),i=JSON.parse(this.request.responseText),"fetchFieldMembers"===this.currentAction){for(var c=JSON.parse(i.members),d=[],g={},nt={},u=0;u<c.length;u++)d.push({formattedText:c[u].FormattedText,actualText:c[u].ActualText}),g[c[u].FormattedText]={},nt[c[u].ActualText]={};this.engineModule.fieldList[i.memberName].dateMember=d;this.engineModule.fieldList[i.memberName].formattedMembers=g;this.engineModule.fieldList[i.memberName].members=nt;this.showGroupingBar?this.pivotButtonModule.updateFilterEvents():this.pivotFieldListModule.pivotButtonModule.updateFilterEvents()}else if("fetchRawData"===this.currentAction){for(var rt=this.engineModule.fieldList[this.drillThroughValue.actualText.toString()]?this.engineModule.fieldList[this.drillThroughValue.actualText.toString()].caption:this.drillThroughValue.actualText.toString(),ut=this.engineModule.fieldList[this.drillThroughValue.actualText]?this.engineModule.fieldList[this.drillThroughValue.actualText].aggregateType:"",ft=JSON.parse(i.rawData),p=JSON.parse(i.indexObject),tt={},l=0;l<p.length;l++)tt[p[l].Key]=p[l].Value;this.drillThroughValue.indexObject=tt;this.drillThroughModule.triggerDialog(rt,ut,ft,this.drillThroughValue,this.drillThroughElement);this.hideWaitingPopup()}else{if(o=r.formatFieldList(JSON.parse(i.fieldList)),this.engineModule.fieldList)for(f=Object.keys(this.engineModule.fieldList),u=0;u<f.length;u++)this.engineModule.fieldList[f[u]]&&o[f[u]]&&(o[f[u]].dateMember=this.engineModule.fieldList[f[u]].dateMember,o[f[u]].formattedMembers=this.engineModule.fieldList[f[u]].formattedMembers,o[f[u]].members=this.engineModule.fieldList[f[u]].members);this.engineModule.fieldList=o;this.engineModule.fields=JSON.parse(i.fields);this.engineModule.rowCount=JSON.parse(i.pivotCount).RowCount;this.engineModule.columnCount=JSON.parse(i.pivotCount).ColumnCount;this.engineModule.rowStartPos=JSON.parse(i.pivotCount).RowStartPosition;this.engineModule.colStartPos=JSON.parse(i.pivotCount).ColumnStartPosition;this.engineModule.rowFirstLvl=JSON.parse(i.pivotCount).RowFirstLevel;this.engineModule.colFirstLvl=JSON.parse(i.pivotCount).ColumnFirstLevel;this.engineModule.columnPageCount=JSON.parse(i.pivotCount).ColumnPageCount;this.engineModule.rowPageCount=JSON.parse(i.pivotCount).RowPageCount;for(var it=void 0,s=r.formatPivotValues(JSON.parse(i.pivotValue)),h=0;h<s.length;h++)if(s[h]&&s[h][0]&&"row"===s[h][0].axis){it=h;break}this.engineModule.headerContent=r.frameContent(s,"header",it,this);this.engineModule.pageSettings=this.pageSettings;this.dataSourceSettings.groupSettings.length>0&&r.updateReport(this,JSON.parse(i.dataSourceSettings));e=JSON.parse(i.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={rowHeader:e.RowHeader,columnHeader:e.ColumnHeader,headerDelimiter:e.HeaderDelimiter,rowOrder:e.RowOrder,columnOrder:e.ColumnOrder,columnIndex:e.ColumnIndex};this.engineModule.pivotValues=s;this.engineModule.isEmptyData=0===this.dataSourceSettings.values.length}}catch(t){this.engineModule.pivotValues=[]}"onScroll"===this.currentAction&&("vertical"===this.scrollDirection?(a="row"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,v=this.pageSettings.rowPageSize*a*this.gridSettings.rowHeight*Math.ceil(this.engineModule.rowStartPos/(this.pageSettings.rowPageSize*a))-this.engineModule.rowFirstLvl*a*this.gridSettings.rowHeight,this.scrollPosObject.verticalSection=v):"horizondal"===this.scrollDirection&&(y="column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,v=this.pageSettings.columnPageSize*y*this.gridSettings.columnWidth*Math.ceil(this.engineModule.colStartPos/(this.pageSettings.columnPageSize*y))-this.engineModule.colFirstLvl*y*this.gridSettings.columnWidth,this.scrollPosObject.horizontalSection=v));"fetchFieldMembers"!==this.currentAction&&"fetchRawData"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotFieldListModule&&this.pivotFieldListModule.calculatedFieldModule&&this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate&&(this.pivotFieldListModule.calculatedFieldModule.endDialog(),this.pivotFieldListModule.calculatedFieldModule.isRequireUpdate=!1))}},i.prototype.getEngine=function(t,i,u,f,e,o,s,h,c,l){var y=this,v,a;this.engineModule.isEmptyData=!1;this.element.querySelector(".e-spin-hide")&&"onExcelExport"!==t&&"onCsvExport"!==t&&this.showWaitingPopup();this.currentAction=t;this.isServerWaitingPopup=!1;v={pageSettings:JSON.parse(this.getPageSettings()).pageSettings,enableValueSorting:this.enableValueSorting,enablePaging:this.enablePaging,enableVirtualization:this.enableVirtualization,enableDrillThrough:this.allowDrillThrough||this.editSettings.allowEditing,locale:JSON.stringify(r.getLocalizedObject(this))};this.request=n.isNullOrUndefined(this.request)?new XMLHttpRequest:this.request;this.request.open("POST",this.dataSourceSettings.url,!0);a={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:t,customProperties:{},internalProperties:v,drillItem:i,sortItem:u,aggregatedItem:f,calculatedItem:e,filterItem:o,memberName:s,fetchRawDataArgs:h,editArgs:c,hash:this.guid,excelExportProperties:l,exportAllPages:this.exportAllPages,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!!this.groupingModule&&this.groupingModule.isUpdate};this.trigger(bs,a,function(n){y.request=n.request;a.internalProperties=n.internalProperties;a.customProperties=n.customProperties;a.dataSourceSettings=n.dataSourceSettings;a.calculatedItem=n.calculatedItem;a.drillItem=n.drillItem;a.editArgs=n.editArgs;a.fetchRawDataArgs=n.fetchRawDataArgs;a.filterItem=n.filterItem;a.hash=n.hash;a.memberName=n.memberName;a.sortItem=n.sortItem;a.excelExportProperties=n.excelExportProperties;a.exportAllPages=n.exportAllPages});this.request.withCredentials=!1;this.request.onreadystatechange=this.onSuccess.bind(this,a.excelExportProperties);this.request.responseType="onExcelExport"===a.action||"onCsvExport"===a.action?"blob":"";this.request.setRequestHeader("Content-type","application/json");this.request.send(JSON.stringify(a))},i.prototype.getChartSettings=function(){var t=this.chartSettings.load,i=this.chartSettings.loaded,r=this.chartSettings.textRender,u=this.chartSettings.pointRender,f=this.chartSettings.seriesRender,e=this.chartSettings.legendRender,o=this.chartSettings.pointClick,s=this.chartSettings.tooltipRender,h=this.chartSettings.legendClick,c=this.chartSettings.multiLevelLabelRender,n;return this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,n=this.addOnPersist(["chartSettings"]),this.chartSettings.load=t,this.chartSettings.loaded=i,this.chartSettings.textRender=r,this.chartSettings.pointRender=u,this.chartSettings.seriesRender=f,this.chartSettings.legendRender=e,this.chartSettings.pointClick=o,this.chartSettings.tooltipRender=s,this.chartSettings.legendClick=h,this.chartSettings.multiLevelLabelRender=c,n},i.prototype.getPageSettings=function(){return this.addOnPersist(["pageSettings"])},i.prototype.onReadyStateChange=function(t){var i=[],u,r;if("CSV"===this.dataSourceSettings.type)for(u=t.split(/\r?\n|\r/),r=0;r<u.length;r++)n.isNullOrUndefined(u[r])||""===u[r]||i.push(u[r].split(","));else try{i=JSON.parse(t)}catch(t){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0);this.initialLoad()},i.prototype.initialLoad=function(){var n=this,t;try{this.cellTemplateFn=this.templateParser(this.cellTemplate);this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate);this.spinnerTemplate?b.createSpinner({target:this.element,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):b.createSpinner({target:this.element,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);t={dataSourceSettings:this.dataSourceSettings,pivotview:this,fieldsType:{},defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(as,t,function(i){n.dataSourceSettings=i.dataSourceSettings;n.fieldsType=i.fieldsType;n.defaultFieldListOrder=t.defaultFieldListOrder;n.updateClass();n.notify(af,{});"Server"!==n.dataSourceSettings.mode&&n.notify(ei,{});n.isAdaptive&&n.contextMenuModule.render();n.notify("init-toolbar",{});n.notify(yf,{})})}catch(n){this.actionFailureMethod(n)}},i.prototype.addInternalEvents=function(){this.on(ei,this.generateData,this);this.on(wt,this.renderPivotGrid,this);this.on(vi,this.onContentReady,this)},i.prototype.removeInternalEvents=function(){this.off(ei,this.generateData);this.off(wt,this.renderPivotGrid);this.off(vi,this.onContentReady)},i.prototype.getPersistData=function(n){var r=this.gridSettings.columnRender,u=this.gridSettings.excelQueryCellInfo,f=this.gridSettings.excelHeaderQueryCellInfo,e=this.gridSettings.pdfQueryCellInfo,o=this.gridSettings.pdfHeaderQueryCellInfo,s=this.chartSettings.load,h=this.chartSettings.loaded,c=this.chartSettings.textRender,l=this.chartSettings.pointRender,a=this.chartSettings.seriesRender,v=this.chartSettings.legendRender,y=this.chartSettings.pointClick,p=this.chartSettings.tooltipRender,w=this.chartSettings.legendClick,b=this.chartSettings.multiLevelLabelRender,t,i;return this.gridSettings.columnRender=void 0,this.gridSettings.excelQueryCellInfo=void 0,this.gridSettings.excelHeaderQueryCellInfo=void 0,this.gridSettings.pdfQueryCellInfo=void 0,this.gridSettings.pdfHeaderQueryCellInfo=void 0,this.chartSettings.tooltipRender=void 0,this.chartSettings.legendClick=void 0,this.chartSettings.multiLevelLabelRender=void 0,this.chartSettings.load=void 0,this.chartSettings.loaded=void 0,this.chartSettings.textRender=void 0,this.chartSettings.pointRender=void 0,this.chartSettings.seriesRender=void 0,this.chartSettings.legendRender=void 0,this.chartSettings.pointClick=void 0,t=[],n&&(t=!this.dataSourceSettings.dataSource||this.dataSourceSettings.dataSource instanceof ut.DataManager?this.dataSourceSettings.dataSource:this.dataSourceSettings.dataSource.slice(),this.setProperties({dataSourceSettings:{dataSource:[]}},!0)),i=this.addOnPersist(["dataSourceSettings","pivotValues","gridSettings","chartSettings","displayOption","pageSettings"]),this.gridSettings.columnRender=r,this.gridSettings.excelQueryCellInfo=u,this.gridSettings.excelHeaderQueryCellInfo=f,this.gridSettings.pdfQueryCellInfo=e,this.gridSettings.pdfHeaderQueryCellInfo=o,this.chartSettings.load=s,this.chartSettings.loaded=h,this.chartSettings.textRender=c,this.chartSettings.pointRender=l,this.chartSettings.seriesRender=a,this.chartSettings.legendRender=v,this.chartSettings.pointClick=y,this.chartSettings.tooltipRender=p,this.chartSettings.legendClick=w,this.chartSettings.multiLevelLabelRender=b,n&&this.setProperties({dataSourceSettings:{dataSource:t}},!0),i},i.prototype.loadPersistData=function(n){var t=JSON.parse(n);this.allowServerDataBinding=!1;this.setProperties({gridSettings:t.gridSettings,pivotValues:t.pivotValues,chartSettings:t.chartSettings,displayOption:t.displayOption},!0);this.currentView="Chart"===t.displayOption.primary?"Chart":"Table";delete this.bulkChanges.pivotValues;this.allowServerDataBinding=!0;this.dataSourceSettings=t.dataSourceSettings},i.prototype.mergePersistPivotData=function(){var t=window.localStorage.getItem(this.getModuleName()+this.element.id);n.isNullOrUndefined(t)||""===t||this.setProperties(JSON.parse(t),!0)},i.prototype.showConditionalFormattingDialog=function(){this.conditionalFormattingModule&&this.conditionalFormattingModule.showConditionalFormattingDialog()},i.prototype.createCalculatedFieldDialog=function(){this.calculatedFieldModule&&this.calculatedFieldModule.createCalculatedFieldDialog()},i.prototype.getModuleName=function(){return"pivotview"},i.prototype.copy=function(n){this.grid.copy(n)},i.prototype.onPropertyChanged=function(i,u){for(var s,h,f,l,e=!1,o=0,c=Object.keys(i);o<c.length;o++){s=c[o];switch(s){case"dataSourceSettings":case"hyperlinkSettings":case"allowDrillThrough":case"editSettings":case"allowDataCompression":if(i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&i.dataSourceSettings.groupSettings&&"pivot"===this.dataType&&this.updateGroupingReport(i.dataSourceSettings.groupSettings,"Date"),i.dataSourceSettings&&1===Object.keys(i.dataSourceSettings).length&&"dataSource"===Object.keys(i.dataSourceSettings)[0])!n.isNullOrUndefined(this.savedDataSourceSettings)&&this.dataSourceSettings.dataSource.length>0&&(r.updateDataSourceSettings(this,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),0===(i.dataSourceSettings.dataSource&&i.dataSourceSettings.dataSource).length&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.dataSourceSettings),this.setProperties({dataSourceSettings:{rows:[]}},!0),this.setProperties({dataSourceSettings:{columns:[]}},!0),this.setProperties({dataSourceSettings:{values:[]}},!0),this.setProperties({dataSourceSettings:{filters:[]}},!0)),this.isStaticRefresh||(this.pivotValues=[],"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[]):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0)),this.dataSourceSettings.groupSettings.length>0&&(this.clonedDataSet=i.dataSourceSettings.dataSource,this.updateGroupingReport(this.dataSourceSettings.groupSettings,"Date")),this.showWaitingPopup(),this.notify(ei,{});else if(r.isButtonIconRefesh(s,u,i)){if(this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule.render(),this.showFieldList&&this.pivotFieldListModule){var a=r.cloneFieldSettings(this.dataSourceSettings.rows),v=r.cloneFieldSettings(this.dataSourceSettings.columns),y=r.cloneFieldSettings(this.dataSourceSettings.values),p=r.cloneFieldSettings(this.dataSourceSettings.filters);this.pivotFieldListModule.setProperties({dataSourceSettings:{rows:a,columns:v,values:y,filters:p}},!0);this.pivotFieldListModule.axisFieldModule.render();this.pivotFieldListModule.treeViewModule.fieldTable&&!this.isAdaptive&&this.pivotFieldListModule.notify(nr,{})}}else this.remoteData=[],"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url&&("type"in i.dataSourceSettings||"url"in i.dataSourceSettings)?(this.engineModule.fieldList=null,this.loadData()):(i.dataSourceSettings&&("pivot"===this.dataType&&"dataSource"in i.dataSourceSettings||"olap"===this.dataType&&"url"in i.dataSourceSettings)&&(this.isStaticRefresh||("pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[]):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),this.pivotValues=[])),this.notify(ei,{}));break;case"height":case"width":this.layoutRefresh();break;case"pivotValues":case"displayOption":!this.showToolbar&&i.displayOption&&1===Object.keys(i.displayOption).length&&i.displayOption.view?(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view,(this.showGroupingBar||this.showFieldList)&&(this.showFieldList&&this.pivotFieldListModule&&(this.pivotFieldListModule.destroyEngine=!0,this.pivotFieldListModule.destroy(),null!==n.select("#"+this.element.id+"_PivotFieldList",this.element)&&n.remove(n.select("#"+this.element.id+"_PivotFieldList",this.element)),this.pivotFieldListModule.destroyEngine=!1),this.notify(af,this)),this.grid||"Chart"===i.displayOption.view?this.pivotChartModule||"Table"===this.displayOption.view||(this.grid&&(this.grid.destroy(),this.grid=void 0),this.pivotChartModule=new le):(this.renderEmptyGrid(),"Table"===i.displayOption.view&&this.pivotChartModule&&(this.destroyEngine=!0,this.pivotChartModule.destroy(),this.destroyEngine=!1,this.chart=void 0,this.pivotChartModule=void 0))):this.showToolbar&&!n.isNullOrUndefined(i.displayOption)&&i.displayOption.view&&(this.currentView="Both"===i.displayOption.view?this.displayOption.primary:i.displayOption.view);h="pivot"===this.dataType?this.engineModule:this.olapEngineModule;n.isNullOrUndefined(h.fieldList)&&n.isNullOrUndefined(h.pivotValues)||this.notify(wt,{});break;case"gridSettings":this.lastGridSettings=i.gridSettings;this.isCellBoxMultiSelection=this.gridSettings.allowSelection&&"Box"===this.gridSettings.selectionSettings.cellSelectionMode&&"Cell"===this.gridSettings.selectionSettings.mode&&"Multiple"===this.gridSettings.selectionSettings.type;this.allowGrouping&&this.groupingModule&&!this.isCellBoxMultiSelection&&(this.setProperties({gridSettings:{allowSelection:!0,selectionSettings:{cellSelectionMode:"Box",mode:"Cell",type:"Multiple"}}},!0),this.isCellBoxMultiSelection=!0);this.renderModule.updateGridSettings();break;case"chartSettings":this.showGroupingBar&&this.groupingBarModule&&(-1!==Object.keys(i.chartSettings).indexOf("enableMultipleAxis")||i.chartSettings.chartSeries&&-1!==Object.keys(i.chartSettings.chartSeries).indexOf("type"))&&this.groupingBarModule.renderLayout();n.isNullOrUndefined(this.pivotChartModule)&&"Table"!==this.displayOption.view&&(this.pivotChartModule=new le);f="pivot"===this.dataType?this.engineModule:this.olapEngineModule;n.isNullOrUndefined(this.pivotChartModule)||n.isNullOrUndefined(f.pivotValues)||this.pivotChartModule.loadChart(this,this.chartSettings);n.isNullOrUndefined(f.pivotValues)||n.isNullOrUndefined(f.fieldList)||this.notify(oi,this);break;case"locale":case"currencyCode":case"enableRtl":(this.tooltip&&this.tooltip.destroy(),this.dataSourceSettings.groupSettings&&this.dataSourceSettings.groupSettings.length>0&&this.clonedDataSet)&&(l=r.getClonedData(this.clonedDataSet),this.setProperties({dataSourceSettings:{dataSource:l}},!0));t.prototype.refresh.call(this);this.updateClass();break;case"enableValueSorting":this.enableValueSorting=i.enableValueSorting;this.updateDataSource();break;case"showGroupingBar":this.element.querySelector(".e-grouping-bar")?this.element.querySelector(".e-grouping-bar").remove():this.groupingBarModule&&this.groupingBarModule.renderLayout();n.isNullOrUndefined(i.showFieldList)&&this.renderPivotGrid();break;case"showFieldList":this.initialLoad();break;case"groupingBarSettings":this.showGroupingBar&&this.groupingBarModule&&(i.groupingBarSettings&&Object.keys(i.groupingBarSettings).indexOf("showFieldsPanel")>-1?(this.groupingBarModule.RefreshFieldsPanel(),this.layoutRefresh()):this.axisFieldModule.render());break;case"showValuesButton":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render();this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"showTooltip":this.renderToolTip();break;case"toolbar":this.toolbarModule&&this.toolbarModule.refreshToolbar();break;case"chartTypes":this.toolbarModule&&this.toolbarModule.createChartMenu();break;case"aggregateTypes":this.showGroupingBar&&this.groupingBarModule&&this.axisFieldModule&&this.axisFieldModule.render();this.showFieldList&&this.pivotFieldListModule&&this.pivotFieldListModule.axisFieldModule&&(this.pivotFieldListModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotFieldListModule.axisFieldModule.render());break;case"enableFieldSearching":this.pivotFieldListModule&&(this.pivotFieldListModule.enableFieldSearching=this.enableFieldSearching);break;case"pageSettings":this.enableVirtualization||(this.engineModule.pageSettings=this.pageSettings,this.refreshPageData());break;case"pagerSettings":case"enablePaging":this.notify(yf,this);break;case"cellTemplate":this.cellTemplateFn=this.templateParser(this.cellTemplate);e=!0;break;case"tooltipTemplate":this.tooltipTemplateFn=this.templateParser(this.tooltipTemplate);e=!0;break;case"enableVirtualization":this.removeVirtualizationEvents();this.initialLoad()}}e&&this.grid&&this.grid.refreshColumns()},i.prototype.templateParser=function(t){if(t)try{return"function"!=typeof t&&document.querySelectorAll(t).length?n.compile(document.querySelector(t).innerHTML.trim()):n.compile(t)}catch(i){return n.compile(t)}},i.prototype.getCellTemplate=function(){return this.cellTemplateFn},i.prototype.appendHtml=function(t,i){var r=document.createElement("div");return r.innerHTML=i,n.isNullOrUndefined(r.firstChild)||t.appendChild(r.firstChild),t},i.prototype.renderPivotGrid=function(){this.clearTemplate();this.pivotChartModule&&(this.pivotChartModule.engineModule=this.engineModule,this.pivotChartModule.loadChart(this,this.chartSettings),this.enableRtl&&this.chart&&"rtl"!==document.body.getAttribute("dir")&&n.addClass([this.chart.element],"e-ltr"));(this.showFieldList||this.showGroupingBar||this.allowNumberFormatting||this.allowCalculatedField||this.toolbar||this.allowGrouping||this.gridSettings.contextMenuItems)&&(this.notify(oi,this),this.pivotFieldListModule&&this.allowDeferLayoutUpdate&&(this.pivotFieldListModule.clonedDataSource=n.extend({},this.dataSourceSettings,null,!0)));this.enableVirtualization&&(this.virtualscrollModule=new vl(this));(this.allowDrillThrough||this.editSettings.allowEditing)&&(this.drillThroughModule=new cv(this));this.enablePaging&&this.notify(yf,this);"Chart"!==this.displayOption.view?(this.hyperlinkSettings&&(this.isRowCellHyperlink=!!this.hyperlinkSettings.showRowHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isColumnCellHyperlink=!!this.hyperlinkSettings.showColumnHeaderHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isValueCellHyperlink=!!this.hyperlinkSettings.showValueCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.isSummaryCellHyperlink=!!this.hyperlinkSettings.showSummaryCellHyperlink||!!this.hyperlinkSettings.showHyperlink,this.applyHyperlinkSettings()),this.renderModule=this.renderModule?this.renderModule:new hl(this),this.renderModule.render(!0)):this.grid&&n.remove(this.grid.element);this.allowConditionalFormatting&&this.applyFormatting(this.pivotValues);this.showToolbar&&"Both"===this.displayOption.view&&this.chart&&this.grid&&(this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+kt)&&this.groupingBarModule.refreshUI(),this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.getGridWidthAsNumber()-2),this.chartSettings.enableScrollOnMultiAxis&&this.chartSettings.enableMultipleAxis&&(this.element.querySelector("."+ft).style.width=n.formatUnit(this.getGridWidthAsNumber())),this.chart.width=n.formatUnit(this.getGridWidthAsNumber()),"Table"===this.currentView?(this.grid.element.style.display="",this.chart.element.style.display="none",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="none")):(this.grid.element.style.display="none",this.chart.element.style.display="",this.chartSettings.enableMultipleAxis&&this.chartSettings.enableScrollOnMultiAxis&&(this.element.querySelector(".e-pivotchart").style.display="")));this.toolbarModule&&(this.showFieldList&&n.select("#"+this.element.id+"_PivotFieldList",this.element)&&(this.toolbar&&-1!==this.toolbar.indexOf("FieldList")?n.select("#"+this.element.id+"_PivotFieldList",this.element).style.display="none":(n.select("#"+this.element.id+"_PivotFieldList",this.element).style.top=this.element.querySelector("."+uu).offsetHeight.toString()+"px",n.select("#"+this.element.id+"_PivotFieldList",this.element).style.position="relative")),this.toolbar&&-1!==this.toolbar.indexOf("FieldList")&&this.showToolbar&&this.element.querySelector(".e-toggle-field-list")&&(this.element.querySelector(".e-toggle-field-list").style.display="none"),this.toolbarModule&&"New"!==this.toolbarModule.action&&"Load"!==this.toolbarModule.action&&"Remove"!==this.toolbarModule.action&&(this.isModified=!0),this.isInitialRendering||(this.isModified=!1,this.isInitialRendering=!this.isInitialRendering),this.toolbarModule.action="")},i.prototype.showWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?b.showSpinner(this.grid.element):b.showSpinner(this.element)},i.prototype.hideWaitingPopup=function(){this.grid&&this.grid.element&&!this.spinnerTemplate&&"Table"===this.currentView?b.hideSpinner(this.grid.element):b.hideSpinner(this.element)},i.prototype.updateDataSource=function(){var t=this;this.showWaitingPopup();var n=this,i=Object.keys(n.lastSortInfo).length>0,f=Object.keys(n.lastFilterInfo).length>0,e=Object.keys(n.lastAggregationInfo).length>0,u=Object.keys(n.lastCalcFieldInfo).length>0,o={dataSourceSettings:r.getClonedDataSourceSettings(n.dataSourceSettings)};n.trigger(ni,o,function(o){if((n.enableVirtualization||n.enablePaging)&&(i||f||e||u)||r.updateDataSourceSettings(n,o.dataSourceSettings),n.updatePageSettings(!1),"pivot"===n.dataType&&(n.enableVirtualization||n.enablePaging)&&(i||f||e||u))i&&(n.setProperties({dataSourceSettings:{valueSortSettings:{rowHeader:"",columnHeader:""}}},!0),"Server"===t.dataSourceSettings.mode?n.getEngine("onSort",null,n.lastSortInfo,null,null,null,null):n.engineModule.onSort(n.lastSortInfo),n.lastSortInfo={}),e&&("Server"===t.dataSourceSettings.mode?n.getEngine("onAggregation",null,null,n.lastAggregationInfo,null,null,null):n.engineModule.onAggregation(n.lastAggregationInfo),n.lastAggregationInfo={}),u&&("Server"===t.dataSourceSettings.mode?n.getEngine("onCalcOperation",null,null,null,n.lastCalcFieldInfo,null,null):n.engineModule.onCalcOperation(n.lastCalcFieldInfo,n.dataSourceSettings),n.lastCalcFieldInfo={}),f&&("Server"===t.dataSourceSettings.mode?n.getEngine("onFilter",null,null,null,null,n.lastFilterInfo,null):n.engineModule.onFilter(n.lastFilterInfo,n.dataSourceSettings),n.lastFilterInfo={}),n.allowServerDataBinding=!1,n.setProperties({pivotValues:n.engineModule.pivotValues},!0),delete n.bulkChanges.pivotValues,n.allowServerDataBinding=!0,"Server"!==n.dataSourceSettings.mode&&n.enginePopulatedEventMethod("updateDataSource");else if("olap"===n.dataType){var s={mode:"",savedFieldList:n.olapEngineModule.fieldList,savedFieldListData:n.olapEngineModule.fieldListData,pageSettings:n.pageSettings,enableValueSorting:n.enableValueSorting,isDrillThrough:n.allowDrillThrough||n.editSettings.allowEditing,localeObj:n.localeObj,enableVirtualization:t.enableVirtualization};u||i?(n.olapEngineModule.savedFieldList=n.olapEngineModule.fieldList,n.olapEngineModule.savedFieldListData=n.olapEngineModule.fieldListData,u?(n.olapEngineModule.updateCalcFields(n.dataSourceSettings,n.lastCalcFieldInfo),n.lastCalcFieldInfo={}):(n.olapEngineModule.onSort(n.dataSourceSettings),n.lastSortInfo={})):n.olapEngineModule.renderEngine(n.dataSourceSettings,s,n.onHeadersSort?n.getHeaderSortInfo.bind(n):void 0);n.allowServerDataBinding=!1;n.setProperties({pivotValues:n.olapEngineModule.pivotValues},!0);delete n.bulkChanges.pivotValues;n.allowServerDataBinding=!0;n.enginePopulatedEventMethod("updateDataSource")}else s={mode:"",savedFieldList:n.engineModule.fieldList,pageSettings:n.pageSettings,enableValueSorting:n.enableValueSorting,isDrillThrough:n.allowDrillThrough||n.editSettings.allowEditing,localeObj:n.localeObj,fieldsType:n.fieldsType,clonedReport:n.clonedReport,globalize:n.globalize,currenyCode:n.currencyCode,enablePaging:t.enablePaging,enableVirtualization:t.enableVirtualization,allowDataCompression:t.allowDataCompression,enableHtmlSanitizer:t.enableHtmlSanitizer},"Server"===n.dataSourceSettings.mode?i?n.getEngine("onSort",null,n.lastSortInfo,null,null,null,null):e?n.getEngine("onAggregation",null,null,n.lastAggregationInfo,null,null,null):u?n.getEngine("onCalcOperation",null,null,null,n.lastCalcFieldInfo,null,null):f?n.getEngine("onFilter",null,null,null,null,n.lastFilterInfo,null):n.getEngine("onDrop",null,null,null,null,null,null):(i&&""!==n.dataSourceSettings.valueSortSettings.headerText&&n.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),n.engineModule.renderEngine(n.dataSourceSettings,s,n.aggregateCellInfo?n.getValueCellInfo.bind(n):void 0,n.onHeadersSort?n.getHeaderSortInfo.bind(n):void 0),n.allowServerDataBinding=!1,n.setProperties({pivotValues:n.engineModule.pivotValues},!0),delete n.bulkChanges.pivotValues,n.allowServerDataBinding=!0,n.enginePopulatedEventMethod("updateDataSource")),n.lastSortInfo={},n.lastAggregationInfo={},n.lastCalcFieldInfo={},n.lastFilterInfo={}})},i.prototype.refreshPageData=function(){var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};this.actionBeginMethod();this.showWaitingPopup();this.trigger(ni,n);"pivot"===this.dataType&&("Server"===this.dataSourceSettings.mode?this.getEngine("onPageChange",null,null,null,null,null,null):this.engineModule.generateGridData(this.dataSourceSettings,!0,this.engineModule.headerCollection),this.setProperties({pivotValues:this.engineModule.pivotValues},!0),this.enginePopulatedEventMethod("updateDataSource"));this.actionObj.actionName=this.getActionCompleteName();this.actionObj.actionName&&this.actionCompleteMethod()},i.prototype.excelExport=function(n,t,i,r,u){if(u&&"Server"===this.dataSourceSettings.mode)this.getEngine("onExcelExport",null,null,null,null,null,null,null,null,n);else{(this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("Excel",n,r):(this.exportType="Excel",this.grid.excelExport(n,t,i,r));this.actionObj.actionName=this.getActionCompleteName();var f={exportInfo:{type:this.exportType,info:n}};this.actionObj.actionInfo=f;this.actionObj.actionName&&this.actionCompleteMethod()}},i.prototype.csvExport=function(n,t,i,r,u){if(u&&"Server"===this.dataSourceSettings.mode)this.getEngine("onCsvExport",null,null,null,null,null,null,null,null,n);else{(this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0)&&"Server"!==this.dataSourceSettings.mode?this.excelExportModule.exportToExcel("CSV",n,r):(this.exportType="CSV",this.grid.csvExport(n,t,i,r));this.actionObj.actionName=this.getActionCompleteName();var f={exportInfo:{type:this.exportType,info:n}};this.actionObj.actionInfo=f;this.actionObj.actionName&&this.actionCompleteMethod()}},i.prototype.gridPdfExport=function(n,t,i,r){var f,u={pdfExportProperties:n,isMultipleExport:t,isBlob:r,pdfDoc:i,currentExportView:"Table",pdfMargins:{}},e;return this.trigger(ou,u),this.pdfExportModule&&(this.pdfExportModule.exportProperties=u),f=(this.enableVirtualization||this.enablePaging||this.allowEngineExport||this.allowConditionalFormatting&&this.dataSourceSettings.conditionalFormatSettings.length>0||u.height||u.width||Object.keys(u.pdfMargins).length>0)&&"Server"!==this.dataSourceSettings.mode?this.pdfExportModule.exportToPDF(u.pdfExportProperties,u.isMultipleExport,u.pdfDoc,u.isBlob):this.grid.pdfExport(u.pdfExportProperties,u.isMultipleExport,u.pdfDoc,u.isBlob),this.actionObj.actionName=this.getActionCompleteName(),e={exportInfo:{type:"PDF",info:n}},this.actionObj.actionInfo=e,this.actionObj.actionName&&this.actionCompleteMethod(),f},i.prototype.chartExport=function(t,i,r,u,f){var o,e={pdfExportProperties:i,isMultipleExport:r,isBlob:f,pdfDoc:u,type:t,currentExportView:"Chart",pdfMargins:{}},s,h,c;return this.trigger(ou,e),this.chartExportModule.exportProperties=e,s=e.fileName?e.fileName:n.isNullOrUndefined(i)||n.isNullOrUndefined(i.fileName)?"default":i.fileName,"PDF"===t?o=this.chartExportModule.pdfChartExport(e.pdfExportProperties,e.pdfDoc,e.isMultipleExport,e.isBlob):(h=0===e.orientation||e.orientation?e.orientation:n.isNullOrUndefined(i)||n.isNullOrUndefined(i.pageOrientation)||"Landscape"===i.pageOrientation?a.PdfPageOrientation.Landscape:a.PdfPageOrientation.Portrait,o=this.chart.exportModule.export(e.type,s,h,null)),this.actionObj.actionName=this.getActionCompleteName(),c={exportInfo:{type:t,info:s}},this.actionObj.actionInfo=c,this.actionObj.actionName&&this.actionCompleteMethod(),o},i.prototype.pdfExport=function(n,t,i,r,u){var f=this,e=null;return new Promise(function(o){if(u&&"Both"===f.displayOption.view)"Chart"===f.displayOption.primary?f.chartExport("PDF",n,!0,i,!1).then(function(i){e=f.gridPdfExport(n,t,i,r);o(e)}):f.gridPdfExport(n,!0,i,!1).then(function(i){e=f.chartExport("PDF",n,t,i,r);o(e)});else{var s=f.gridPdfExport(n,t,i,r);o(s)}})},i.prototype.printChart=function(){this.chart&&this.chart.print()},i.prototype.onDrill=function(t,i){var f=this,o=this.dataSourceSettings.drilledMembers[0]&&this.dataSourceSettings.drilledMembers[0].delimiter?this.dataSourceSettings.drilledMembers[0].delimiter:"**",s="",c="",a="",v,y,e,p;if(i?(s=i.fieldName,c=i.cell.axis,a=i.isDrilled?"up":"down"):(s="row"==(c=t.parentElement.classList.contains(ci)?"row":"column")?n.closest(t,"td").getAttribute("fieldname"):n.closest(t,"th").getAttribute("fieldname"),a=t.classList.contains(bi)?"up":"down"),"pivot"===this.dataType){var k=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),d=Number("row"===c?n.closest(t,"td").getAttribute("data-colindex"):n.closest(t,"th").getAttribute("data-colindex")),g=Number("row"===c?n.closest(t,"td").getAttribute("index"):n.closest(t,"th").getAttribute("index")),w=i?i.cell:this.engineModule.pivotValues[g][d],h=w.valueSort.levelName.split(this.engineModule.valueSortSettings.headerDelimiter).join(o),b=!1;if(0===this.dataSourceSettings.drilledMembers.length)this.setProperties({dataSourceSettings:{drilledMembers:[{name:s,items:[h],delimiter:o}]}},!0);else{for(v=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),y=0;y<v.length;y++)e=v[y],(h=h.split(o).join(e.delimiter?e.delimiter:o),o=e.delimiter=e.delimiter?e.delimiter:o,e.name===s)&&(b=!0,p=e.items.indexOf(h),p>-1?e.items.splice(p,1):e.items.push(h));this.setProperties({dataSourceSettings:{drilledMembers:v}},!0);b||this.dataSourceSettings.drilledMembers.push({name:s,items:[h],delimiter:o})}this.showWaitingPopup();var u=this,l={fieldName:s,memberName:h,delimiter:o,axis:c,action:a,currentCell:w},nt={drillInfo:l,pivotview:u,cancel:!1};u.trigger(lf,nt,function(n){var t,i,e;n.cancel?(f.hideWaitingPopup(),f.setProperties({dataSourceSettings:{drilledMembers:k}},!0)):(t={dataSourceSettings:r.getClonedDataSourceSettings(f.dataSourceSettings)},u.trigger(ni,t),u.setProperties({dataSourceSettings:t.dataSourceSettings},!0),u.enableVirtualization||u.enablePaging?"Server"===f.dataSourceSettings.mode?f.getEngine("onDrill",l,null,null,null,null,null):(u.engineModule.drilledMembers=u.dataSourceSettings.drilledMembers,u.engineModule.onDrill(l)):"Server"===f.dataSourceSettings.mode?f.getEngine("onDrill",l,null,null,null,null,null):u.engineModule.generateGridData(u.dataSourceSettings,!0),u.allowServerDataBinding=!1,u.setProperties({pivotValues:u.engineModule.pivotValues},!0),delete u.bulkChanges.pivotValues,u.allowServerDataBinding=!0,i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:f.pivotValues},f.trigger(ti,i),u.engineModule.pivotValues=i.pivotValues,e={drillInfo:l},f.actionObj.actionInfo=e,u.renderPivotGrid())})}else this.onOlapDrill(s,c,a,o,t,i)},i.prototype.onOlapDrill=function(t,i,u,f,e,o){var a,s=this,tt=this,gt=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers),ii,ri,g,v,k,et,w,p,nt,pt,ot,st,ht,wt,d,bt,dt;o?a=o.cell:(ii=Number("row"===i?n.closest(e,"td").getAttribute("data-colindex"):n.closest(e,"th").getAttribute("data-colindex")),ri=Number("row"===i?n.closest(e,"td").getAttribute("index"):n.closest(e,"th").getAttribute("index")),a=this.olapEngineModule.pivotValues[ri][ii]);g="row"===i?this.olapEngineModule.tupRowInfo[a.ordinal]:this.olapEngineModule.tupColumnInfo[a.ordinal];v={axis:i,action:u,fieldName:t,delimiter:"~~",memberName:g.uNameCollection,currentCell:a};this.showWaitingPopup();var ct={drillInfo:v,pivotview:tt,cancel:!1},ut=this.olapEngineModule.fieldList[v.fieldName]&&this.olapEngineModule.fieldList[v.fieldName].isHierarchy,it=g.drillInfo.map(function(n){return n.hierarchy}).indexOf(a.hierarchy.toString()),l=r.cloneDrillMemberSettings(this.dataSourceSettings.drilledMembers);if(v&&"down"===v.action){for(var lt=g.drillInfo.map(function(n){return n.uName}),h="",b=0;b<=it;b++)h=h+(""!==h?"~~":"")+(st=(ot=lt[b]).split("~~"))[st.length-1];for(var rt=this.olapEngineModule.getDrilledSets(v.memberName,a,this.olapEngineModule.fieldList[a.hierarchy]&&!this.olapEngineModule.fieldList[a.hierarchy].hasAllMember?a.valueSort.levelName.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-1:it,i),at=0,ui=pt=Object.keys(rt);at<ui.length;at++)for(var ft=rt[ui[at]],y=0,vt=l.length;y<vt;y++){for(k=l[y],et=ft,k.delimiter&&(et=et.replace(/~~/g,k.delimiter)),w=[],p=0;p<k.items.length;p++)0!==k.items[p].indexOf(et)&&(w[w.length]=k.items[p]);k.items=w}this.olapEngineModule.drilledSets[a.actualText]=g.members[it];v.memberName=h;for(var c=[],yt=0,fi=l;yt<fi.length;yt++)(ot=fi[yt]).name===v.fieldName&&c.push(ot);if(c.length>0){if(c[0].delimiter&&(h=h.replace(/~~/g,c[0].delimiter)),-1===r.inArray(h,c[0].items)&&c[0].items.push(h),ut)for(y=0;y<c[0].items.length;)c[0].items[y]===h?c[0].items.splice(y,1):++y}else ut||(nt={name:v.fieldName,items:[h],delimiter:"~~"},l?l.push(nt):l=[nt]);ct.drillInfo.memberName=h;this.setProperties({dataSourceSettings:{drilledMembers:l}},!0);tt.trigger(lf,ct,function(n){var t,i;n.cancel?(s.hideWaitingPopup(),s.setProperties({dataSourceSettings:{drilledMembers:gt}},!0)):(t={dataSourceSettings:r.getClonedDataSourceSettings(s.dataSourceSettings)},s.trigger(ni,t),s.setProperties({dataSourceSettings:t.dataSourceSettings},!0),s.olapEngineModule.updateDrilledInfo(s.dataSourceSettings),s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.olapEngineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0,i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:tt.olapEngineModule.pivotValues},s.trigger(ti,i),s.olapEngineModule.pivotValues=i.pivotValues,s.renderPivotGrid())})}else{for(delete this.olapEngineModule.drilledSets[a.actualText],rt=this.olapEngineModule.getDrilledSets(v.memberName,a,it,i),pt=Object.keys(rt),lt=g.drillInfo.map(function(n){return n.uName}),h="",b=0;b<=it;b++)h=h+(""!==h?"~~":"")+(st=(ot=lt[b]).split("~~"))[st.length-1];for(ht=0,wt=pt;ht<wt.length;ht++){for(ft=rt[wt[ht]],d=[],y=0,vt=l.length;y<vt;y++)if(bt=ft,(c=l[y]).name===v.fieldName&&d.push(c),c.delimiter&&(bt=ft.replace(/~~/g,c.delimiter)),!ut){for(w=[],p=0;p<c.items.length;p++)0!==c.items[p].indexOf(bt)&&(w[w.length]=c.items[p]);c.items=w}ut&&(d.length>0?(d[0].delimiter&&(h=h.replace(/~~/g,d[0].delimiter)),-1===r.inArray(h,d[0].items)&&d[0].items.push(h)):(nt={name:v.fieldName,items:[h],delimiter:"~~"},l?l.push(nt):l=[nt]))}for(var ei=[],kt=0,oi=l;kt<oi.length;kt++)dt=oi[kt],dt.items.length>0&&ei.push(dt);this.setProperties({dataSourceSettings:{drilledMembers:l}},!0);tt.trigger(lf,ct,function(n){var t,i;n.cancel?(s.hideWaitingPopup(),s.setProperties({dataSourceSettings:{drilledMembers:gt}},!0)):(t={dataSourceSettings:r.getClonedDataSourceSettings(s.dataSourceSettings)},s.trigger(ni,t),s.setProperties({dataSourceSettings:t.dataSourceSettings},!0),s.setProperties({dataSourceSettings:{drilledMembers:ei}},!0),s.olapEngineModule.updateDrilledInfo(s.dataSourceSettings),s.allowServerDataBinding=!1,s.setProperties({pivotValues:s.olapEngineModule.pivotValues},!0),delete s.bulkChanges.pivotValues,s.allowServerDataBinding=!0,i={dataSourceSettings:r.getClonedDataSourceSettings(t.dataSourceSettings),pivotValues:tt.olapEngineModule.pivotValues},s.trigger(ti,i),s.olapEngineModule.pivotValues=i.pivotValues,s.renderPivotGrid())})}},i.prototype.onContentReady=function(){var h,c,f,r,u,o;if(this.isPopupClicked=!1,this.showFieldList&&this.pivotFieldListModule?(this.pivotFieldListModule.element.style.display="block",b.hideSpinner(this.pivotFieldListModule.fieldListSpinnerElement)):this.fieldListSpinnerElement&&b.hideSpinner(this.fieldListSpinnerElement),this.isEmptyGrid?(this.isEmptyGrid=!1,this.notEmpty=!0):("Server"===this.dataSourceSettings.mode&&this.isServerWaitingPopup||"Local"===this.dataSourceSettings.mode)&&this.hideWaitingPopup(),this.grid){if(h="pivot"===this.dataType?this.engineModule:this.olapEngineModule,this.enableVirtualization&&h){this.element.querySelector("."+at)&&!this.element.querySelector("."+at).querySelector("."+ui)&&(this.virtualDiv=n.createElement("div",{className:ui}),this.element.querySelector("."+at).appendChild(this.virtualDiv));this.element.querySelector("."+li)&&!this.element.querySelector("."+li).querySelector("."+ui)?(this.virtualHeaderDiv=n.createElement("div",{className:ui}),this.element.querySelector("."+li).appendChild(this.virtualHeaderDiv)):this.virtualHeaderDiv=this.element.querySelector("."+li).querySelector("."+ui);c=this.element.querySelector("."+at).querySelector(".e-table");f=this.gridSettings.rowHeight*h.rowCount+.1-c.clientHeight;f>this.scrollerBrowserLimit&&(this.verticalScrollScale=f/this.scrollerBrowserLimit,f=this.scrollerBrowserLimit);r=this.gridSettings.columnWidth*h.columnCount;r>this.scrollerBrowserLimit&&(this.horizontalScrollScale=r/this.scrollerBrowserLimit,r=this.scrollerBrowserLimit);n.setStyleAttribute(this.virtualDiv,{height:(f>.1?f:.1)+"px",width:(r>.1?r:.1)+"px"});n.setStyleAttribute(this.virtualHeaderDiv,{height:0,width:(r>.1?r:.1)+"px"});var t=this.element.querySelector("."+at),y=this.element.querySelector("."+gu),a=this.element.querySelector("."+li);this.isAdaptive&&(t.parentElement.parentElement.querySelector("."+pt).children[0].style.minHeight="1px",t.parentElement.parentElement.querySelector("."+pt).style.minHeight="1px");var i=this.isAdaptive?t:t.parentElement.parentElement.querySelector("."+pt),l=t.parentElement.scrollTop>this.scrollerBrowserLimit?t.querySelector("."+hi).style.transform.split(",")[1].trim():-(t.parentElement.scrollTop*this.verticalScrollScale-this.scrollPosObject.verticalSection-t.parentElement.scrollTop)+"px)",s=i.scrollLeft>this.scrollerBrowserLimit?t.querySelector("."+hi).style.transform.split(",")[0].trim()+",":"translate("+-(i.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-i.scrollLeft)+"px,";n.setStyleAttribute(y.querySelector(".e-table"),{transform:"translate(0px,"+l});n.setStyleAttribute(t.querySelector(".e-table"),{transform:s+l});n.setStyleAttribute(a.querySelector(".e-table"),{transform:s+0+"px)"});n.isNullOrUndefined(this.resizedValue)||(this.element.querySelector(".e-frozenscrollbar").style.width=this.resizedValue+"px");this.grid.element.querySelector(".e-movablechild").style.width=r+(t.parentElement.offsetWidth-t.parentElement.clientWidth)+"px";var p="pivot"===this.dataType&&"column"===this.dataSourceSettings.valueAxis?this.dataSourceSettings.values.length:1,v=this.pageSettings.columnPageSize*p*this.gridSettings.columnWidth,e=i.scrollWidth-(i.scrollLeft+i.offsetWidth);this.virtualscrollModule&&v>0&&e<=v&&i.scrollLeft>0&&(this.virtualDiv.style.display="none",u=t.scrollWidth-(t.scrollLeft+t.offsetWidth),this.virtualDiv.style.display="",o=t.scrollWidth-(t.scrollLeft+t.offsetWidth),u>1&&(this.scrollPosObject.horizontalSection-=e<=0?u>e?u:-o:o===u?u-e:u<o&&(e===o||e>u)?-(o-u):0),s=i.scrollLeft>this.scrollerBrowserLimit?t.querySelector("."+hi).style.transform.split(",")[0].trim()+",":"translate("+-(i.scrollLeft*this.horizontalScrollScale-this.scrollPosObject.horizontalSection-i.scrollLeft)+"px,",n.setStyleAttribute(t.querySelector(".e-table"),{transform:s+l}),n.setStyleAttribute(a.querySelector(".e-table"),{transform:s+0+"px)"}));"auto"!==this.grid.height?this.grid.contentModule.setHeightToContent(this.virtualDiv.offsetHeight+c.clientHeight):this.grid.contentModule.setHeightToContent(this.element.querySelector("."+gu+" ."+hi).offsetHeight)}"Chart"!==this.currentView&&this.grid.hideScroll();this.showGroupingBar?(this.element.style.minWidth="400px",this.grid.element.style.minWidth="400px"):(this.element.style.minWidth="310px",this.grid.element.style.minWidth="310px")}this.unwireEvents();this.wireEvents();this.isChartLoaded=!1;this.isEmptyGrid||this.trigger(hf);this.actionObj.actionName=this.getActionCompleteName();this.actionObj.actionName&&this.actionObj.actionName!==ro&&this.actionCompleteMethod();this.groupingModule&&(this.groupingModule.isUpdate=!1);this.engineModule&&this.engineModule.clearProperties()},i.prototype.removeVirtualizationEvents=function(){var t=this.element.querySelector("."+at),i=this.element.querySelector("."+li),r=t.parentElement.parentElement.querySelector("."+pt);if(!this.enableVirtualization){var u=this.element.querySelector("."+gu),f=this.isAdaptive?t:t.parentElement.parentElement.querySelector("."+pt),e=t.parentElement,o=t.parentElement.parentElement;n.EventHandler.clearEvents(t);n.EventHandler.clearEvents(i);n.EventHandler.clearEvents(r);n.EventHandler.clearEvents(f);n.EventHandler.clearEvents(e);n.EventHandler.clearEvents(o);i.querySelector(".e-table").style.transform="";u.querySelector(".e-table").style.transform="";t.querySelector(".e-table").style.transform="";this.mScrollBarEvents.forEach(function(t){n.EventHandler.add(r,t.name,t.listener)});this.grid.on("check-scroll-reset",function(n){n.cancel=!1});this.grid.on("prevent-frozen-scroll-refresh",function(n){n.cancel=!1});this.grid.isPreventScrollEvent=!1;this.isVirtualScrollEventsAdded=!1}},i.prototype.setToolTip=function(t){var e,h,a=this,o=Number(t.target.getAttribute("data-colindex")),f=Number(t.target.getAttribute("index")),i=this.dataSourceSettings.values.length>0&&this.pivotValues&&this.pivotValues[f]&&this.pivotValues[f][o]?this.pivotValues[f][o]:void 0,c,r,s,u,v,l,y,k;if(this.tooltip.content="",c=!1,i&&"olap"===this.dataType?(r=i.actualText,n.isNullOrUndefined(r)||!this.olapEngineModule.fieldList||this.olapEngineModule.fieldList[r]||(s=this.olapEngineModule.tupRowInfo,r=i.rowOrdinal>-1&&s.length>0&&s[i.rowOrdinal]&&!n.isNullOrUndefined(s[i.rowOrdinal].measureName)?s[i.rowOrdinal].measureName:r),this.olapEngineModule.fieldList&&this.olapEngineModule.fieldList[r]&&(e=(u=this.olapEngineModule.fieldList[r]).isCalculatedField?u.type:u.aggregateType,h=this.olapEngineModule.dataFields[r]&&this.olapEngineModule.dataFields[r].caption?this.olapEngineModule.dataFields[r].caption:u.caption,c=!0)):i&&this.engineModule.fieldList&&this.engineModule.fieldList[i.actualText]&&(e="DistinctCount"===(e=(u=this.engineModule.fieldList[i.actualText]).aggregateType)||"number"===u.type&&"include"!==u.type&&"exclude"!==u.type?void 0===e?"Sum":u.aggregateType:"Count",h=u.caption,c=!0),i&&c){var p=this.getRowText(f,0),w=this.getColText(0,o,f),b=""===i.formattedText?this.localeObj.getConstant("noValue"):i.formattedText;this.tooltipTemplate&&void 0!==this.getTooltipTemplate()?(v={rowHeaders:p,columnHeaders:w,aggregateType:e,valueField:h,value:b,rowFields:this.getHeaderField(f,o,"row"),columnFields:this.getHeaderField(f,o,"column")},"function"==typeof this.tooltipTemplate&&this.isReact?(l=document.createElement("div"),this.getTooltipTemplate()(v,this,"tooltipTemplate",this.element.id+"tooltipTemplate",null,null,l),this.renderReactTemplates(function(){a.tooltip.content=a.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(l.outerHTML):l.outerHTML})):(y=this.getTooltipTemplate()(v,this,"tooltipTemplate",this.element.id+"tooltipTemplate")[0].outerHTML,this.tooltip.content=this.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(y):y)):(k="<div class=e-pivottooltip><p class="+wo+">"+this.localeObj.getConstant("row")+":<\/p><p class="+bo+">"+p+"<\/p><\/br><p class="+wo+">"+this.localeObj.getConstant("column")+":<\/p><p class="+bo+">"+w+"<\/p><\/br>"+(""!==i.actualText?"<p class="+wo+">"+("olap"===this.dataType?"":this.localeObj.getConstant(e)+" "+this.localeObj.getConstant("of")+" ")+h+":<\/p><p class="+bo+">"+b+"<\/p><\/div>":""),this.tooltip.content=n.initializeCSPTemplate(function(){return k}))}else t.cancel=!0},i.prototype.getTooltipTemplate=function(){return this.tooltipTemplateFn},i.prototype.getHeaderField=function(n,t,i){var f,e="",o="olap"===this.dataType?this.olapEngineModule:this.engineModule,s=o.valueSortSettings.headerDelimiter,r,h,u;if("row"===i)for(f=this.pivotValues[n][0].valueSort.levelName.toString().split(s).length,r=0;r<f&&this.dataSourceSettings.rows.length>0&&this.dataSourceSettings.rows[r];r++)e+=(r?" - ":"")+(this.dataSourceSettings.rows[r].caption?this.dataSourceSettings.rows[r].caption:this.dataSourceSettings.rows[r].name);else for(this.dataSourceSettings.columns.length>0&&(h=0===this.dataSourceSettings.values.length?0:Number(Object.keys(o.headerContent)[Object.keys(o.headerContent).length-1]),f=this.pivotValues[h][t].valueSort.levelName.toString().split(s).length,f=this.dataSourceSettings.values.length>1?f-1:f),u=0;u<f&&this.dataSourceSettings.columns.length>0&&this.dataSourceSettings.columns[u];u++)e+=(u?" - ":"")+(this.dataSourceSettings.columns[u].caption?this.dataSourceSettings.columns[u].caption:this.dataSourceSettings.columns[u].name);return e},i.prototype.getLevel=function(n){var r=n.valueSort?n.valueSort.levelName.toString():"",t=n.actualText?n.actualText.toString().split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length:0,i=r.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).length-(t?t-1:t);return i?i-1:0},i.prototype.getRowText=function(t,i){var r=this.pivotValues[t][i],u="",f;if(r){if(f=this.getLevel(r),u="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText,"row"===this.dataSourceSettings.valueAxis)u=(u=0===this.dataSourceSettings.rows.length&&this.dataSourceSettings.values.length>1?this.pivotValues[t][0].valueSort.levelName.toString().slice((this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter).length).toString():1===this.dataSourceSettings.values.length?n.isNullOrUndefined(this.dataSourceSettings.values[0].caption)?this.dataSourceSettings.values[0].name:this.dataSourceSettings.values[0].caption:this.pivotValues[t][0].valueSort.levelName.toString()).split(this.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - ");else for(;f>0||void 0===r.index;)t--,void 0!==(r=this.pivotValues[t][i]).index&&f>r.level&&(u=u+this.dataSourceSettings.valueSortSettings.headerDelimiter+r.formattedText,f-=1);u=u.split(this.dataSourceSettings.valueSortSettings.headerDelimiter).reverse().join(" - ")}return u},i.prototype.getColText=function(n,t,i){for(var r=this.pivotValues[0][t],u=r.axis,f="grand sum"===r.type?this.localeObj.getConstant("grandTotal"):r.formattedText;"value"!==u&&i>n;)n++,this.pivotValues[n]&&(u=(r=this.pivotValues[n][t]).axis,"sum"!==r.type&&"grand sum"!==r.type&&"value"!==u&&(f=f+" - "+r.formattedText));return f},i.prototype.updateClass=function(){this.enableRtl?n.addClass([this.element],ii):n.removeClass([this.element],ii);this.isAdaptive?n.addClass([this.element],ir):n.removeClass([this.element],ir);this.cssClass&&n.addClass([this.element],this.cssClass.split(" "))},i.prototype.mouseRclickHandler=function(n){(3===n.which||0===n.which)&&(this.lastCellClicked=n.target);this.lastCellClicked=n.target},i.prototype.mouseDownHandler=function(n){3===n.which&&(this.lastCellClicked=n.target);this.isCellBoxMultiSelection&&(this.isMouseDown=!0,this.isMouseUp=!1,this.lastSelectedElement=void 0)},i.prototype.mouseMoveHandler=function(t){var r=this,i,u;if(this.isCellBoxMultiSelection&&(t.preventDefault(),this.isMouseDown&&t.target)&&(i=t.target,u=i.parentElement.classList.contains(ci)||i.classList.contains(ci)?"row":"column",i="column"===u?n.closest(i,"th"):n.closest(i,"td"))){var f=Number(i.getAttribute("data-colindex")),e=Number(i.getAttribute("index")),o={cancel:!1,isCellClick:!0,currentCell:i,data:this.pivotValues[e][f]};this.trigger(cf,o,function(n){if(!n.cancel){r.grid.clearSelection();var t=r.parentAt(i,"TH");r.lastSelectedElement&&r.lastSelectedElement!==t&&t.classList.contains(d)?(r.lastSelectedElement.classList.remove(g),r.lastSelectedElement.classList.remove(d),r.lastSelectedElement=t):(r.lastSelectedElement=t,t.classList.add(g),t.classList.add(d));r.renderModule.selected()}})}},i.prototype.mouseUpHandler=function(){this.isCellBoxMultiSelection&&(this.isMouseDown=!1,this.isMouseUp=!0)},i.prototype.parentAt=function(n,t){for(;n.tagName!==t&&n.parentElement;)n=n.parentElement;return n},i.prototype.mouseClickHandler=function(t){var f,i,y,w,b,h,c,k,l,s,e,o,u,a,p,d,g;if((3===t.which||0===t.which)&&(this.lastCellClicked=t.target),f=t.target,!n.closest(f,"."+v))if(i=null,y=f.parentElement.classList.contains(ci)||f.classList.contains(ci)?"row":"column",i="column"===y?n.closest(f,"th"):n.closest(f,"td"),"column"!==y||i||"Row"===this.gridSettings.selectionSettings.mode||(i=n.closest(f,"td")),f.classList.contains(bi)||f.classList.contains(fr)||!this.enableValueSorting||"pivot"!==this.dataType){if(!f.classList.contains(bi)&&!f.classList.contains(fr))return void this.cellClicked(f,i,t);if(w=f.parentElement.getAttribute("fieldname"),b=(l=r.getFieldInfo(w,this),f.classList.contains(bi)?this.actionObj.actionName="Drill up":f.classList.contains(fr)?this.actionObj.actionName="Drill down":""),this.actionObj.actionName=b,this.actionObj.fieldInfo=l.fieldItem,this.actionBeginMethod())return;try{this.onDrill(f)}catch(t){this.actionFailureMethod(t)}}else{this.cellClicked(f,i,t);h=i&&i.parentElement.parentElement.parentElement.parentElement.classList.contains("e-movableheader");c=i&&(i.parentElement.classList.contains("e-row")||i.classList.contains("e-rowsheader")||i.classList.contains("e-stot"));try{if(i&&(h||c)&&!this.allowGrouping||this.allowGrouping&&(h&&"column"===this.dataSourceSettings.valueAxis||i.parentElement.classList.contains("e-row")&&"row"===this.dataSourceSettings.valueAxis&&(i.classList.contains("e-rowsheader")||i.classList.contains("e-stot")))){if(k=i.getAttribute("fieldname"),l=r.getFieldInfo(k,this),this.actionObj.actionName=rh,this.actionObj.fieldInfo=l.fieldItem,this.actionBeginMethod())return;if(s=Number(i.getAttribute("data-colindex")),e=Number(i.getAttribute("index")),"row"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&c?(o=this.pivotValues[e][s],e=-1===this.dataSourceSettings.valueIndex?"value"===o.type||3===o.memberType?e:e+1:this.getLevel(o)<=this.engineModule.measureIndex&&o.members&&o.members.length>0?o.members[0].rowIndex:e):"column"===this.dataSourceSettings.valueAxis&&(this.dataSourceSettings.values.length>1||this.dataSourceSettings.alwaysShowValueHeader)&&h&&(s=Number(i.getAttribute("data-colindex"))+Number(i.getAttribute("aria-colspan"))-1,e=this.engineModule.headerContent.length-1),h&&"pivot"===this.dataType?this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("data-colindex"))+Number(i.getAttribute("aria-colspan"))-1,columnHeader:this.pivotValues[e][s].valueSort.levelName,columnOrder:"Descending"===this.dataSourceSettings.valueSortSettings.columnOrder?"Ascending":"Descending",headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0):c&&"pivot"===this.dataType&&this.setProperties({dataSourceSettings:{valueSortSettings:{rowIndex:Number(i.getAttribute("index"))+Number(i.getAttribute("aria-rowspan"))-1,rowOrder:"Descending"===this.dataSourceSettings.valueSortSettings.rowOrder?"Ascending":"Descending",rowHeader:this.pivotValues[e][s].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),"pivot"!==this.dataType&&this.setProperties({dataSourceSettings:{valueSortSettings:{columnIndex:Number(i.getAttribute("data-colindex"))+Number(i.getAttribute("aria-colspan"))-1,sortOrder:"Descending"===this.dataSourceSettings.valueSortSettings.sortOrder?"Ascending":"Descending",headerText:this.pivotValues[e][s].valueSort.levelName,headerDelimiter:this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:"."}}},!0),this.showWaitingPopup(),u=this,u.engineModule.enableValueSorting=!0,u.enableVirtualization||u.enablePaging){if(u.dataSourceSettings.enableSorting){for(a=0,p=Object.keys(u.engineModule.fieldList);a<p.length;a++)d=p[a],u.engineModule.fieldList[d].sort="Ascending";u.setProperties({dataSourceSettings:{sortSettings:[]}},!0)}"Server"===u.dataSourceSettings.mode?u.getEngine("onValueSort",null,null,null,null,null,null):(u.engineModule.rMembers=u.engineModule.headerCollection.rowHeaders,u.engineModule.cMembers=u.engineModule.headerCollection.columnHeaders,u.engineModule.applyValueSorting(),u.engineModule.updateEngine())}else"Server"===u.dataSourceSettings.mode?u.getEngine("onValueSort",null,null,null,null,null,null):u.engineModule.generateGridData(u.dataSourceSettings,!0);u.allowServerDataBinding=!1;u.setProperties({pivotValues:u.engineModule.pivotValues},!0);delete u.bulkChanges.pivotValues;u.allowServerDataBinding=!0;g={valueSortInfo:this.engineModule.valueSortSettings};this.actionObj.actionInfo=g;u.renderPivotGrid()}}catch(t){this.actionFailureMethod(t)}}},i.prototype.updateTotColWidth=function(){var n,t,i;for(this.totColWidth=0,n=0,t=this.pivotColumns;n<t.length;n++)i=t[n],this.totColWidth=this.totColWidth+i.width},i.prototype.framePivotColumns=function(n){for(var t,u,f,i=0,r=n;i<r.length;i++)t=r[i],t.columns&&t.columns.length>0?this.framePivotColumns(t.columns):(u="0.formattedText"===t.field?"":t.customAttributes&&t.customAttributes.cell&&t.customAttributes.cell.valueSort?t.customAttributes.cell.valueSort.levelName:"",f=this.renderModule.setSavedWidth("0.formattedText"===t.field?t.field:u,Number("auto"===t.width?t.minWidth:t.width)),this.pivotColumns.push({allowReordering:t.allowReordering,allowResizing:t.allowResizing,headerText:u,width:f,autoFit:t.autoFit}),this.totColWidth=this.totColWidth+Number(f))},i.prototype.setGridColumns=function(t){var r,u,i,e,f;if(!n.isNullOrUndefined(this.totColWidth)&&this.totColWidth>0||this.renderModule.isAutoFitEnabled){for(r=0,u=t;r<u.length;r++)i=u[r],i.columns&&i.columns.length>0?this.setGridColumns(i.columns):this.renderModule.isAutoFitEnabled?(i.autoFit=this.pivotColumns[this.posCount].autoFit,this.posCount++):(e="0.formattedText"===i.field?"":i.customAttributes?i.customAttributes.cell.valueSort.levelName:"",i.allowReordering=this.pivotColumns[this.posCount].allowReordering,i.allowResizing=this.pivotColumns[this.posCount].allowResizing,i.autoFit=this.pivotColumns[this.posCount].autoFit,f=this.renderModule.setSavedWidth("0.formattedText"===i.field?i.field:e,Number(this.pivotColumns[this.posCount].width)),i.autoFit?this.renderModule.isAutoFitEnabled=!0:"auto"!==i.width?i.width=f:i.minWidth=f,this.posCount++,i.allowReordering&&(this.gridSettings.allowReordering=!0),i.allowResizing&&(this.gridSettings.allowResizing=!0));this.gridSettings.allowReordering&&s.Grid.Inject(s.Reorder);this.gridSettings.allowResizing&&s.Grid.Inject(s.Resize)}},i.prototype.fillGridColumns=function(n){for(var t,i=0,r=n;i<r.length;i++)t=r[i],t.allowReordering=this.gridSettings.allowReordering,t.allowResizing=this.gridSettings.allowResizing,t.clipMode=this.gridSettings.clipMode,this.posCount++,t.columns&&t.columns.length>0&&this.fillGridColumns(t.columns)},i.prototype.triggerColumnRenderEvent=function(n){this.pivotColumns=[];this.totColWidth=0;this.framePivotColumns(n);var i=this.pivotColumns[0].width,t={columns:this.pivotColumns,dataSourceSettings:this.dataSourceSettings,stackedColumns:this.getStackedColumns(n,[])};this.trigger("beforeColumnsRender",t);this.enableVirtualization&&t.columns.length>0&&t.columns[0].width!==n[0].width&&(this.element.querySelector(".e-frozenscrollbar").style.width=Number(t.columns[0].width.toString().split("px")[0])+"px");this.updateTotColWidth();i!==this.pivotColumns[0].width&&(this.firstColWidth=this.pivotColumns[0].width,this.renderModule.resColWidth=parseInt(this.firstColWidth.toString()));this.posCount=0;this.setGridColumns(n)},i.prototype.setCommonColumnsWidth=function(n,t){for(var i,r=0,u=n;r<u.length;r++)i=u[r],"0.formattedText"!==i.field?i.columns?this.setCommonColumnsWidth(i.columns,t):i.autoFit||("auto"!==i.width?i.width=t:i.minWidth=t):i.width=this.firstColWidth?this.firstColWidth:i.width},i.prototype.getHeightAsNumber=function(){var n;return isNaN(this.height)?this.height.toString().indexOf("%")>-1?n=parseFloat(this.height.toString())/100*this.element.offsetHeight:this.height.toString().indexOf("px")>-1&&(n=Number(this.height.toString().split("px")[0])):n=Number(this.height),n<this.minHeight&&(n=this.minHeight),n},i.prototype.getWidthAsNumber=function(){var n;return isNaN(this.width)?(this.width.toString().indexOf("%")>-1?n=parseFloat(this.width.toString())/100*this.element.offsetWidth:this.width.toString().indexOf("px")>-1&&(n=Number(this.width.toString().split("px")[0])),isNaN(n)&&(n=this.element.offsetWidth)):n=Number(this.width),n<400&&(n=400),n},i.prototype.getGridWidthAsNumber=function(){var n,t=this.element.offsetWidth?this.element.offsetWidth:this.element.getBoundingClientRect().width;return isNaN(this.grid.width)?(this.grid.width.toString().indexOf("%")>-1?n=parseFloat(this.grid.width.toString())/100*t:this.grid.width.toString().indexOf("px")>-1&&(n=Number(this.grid.width.toString().split("px")[0])),isNaN(n)&&(n=t)):n=Number(this.grid.width),n},i.prototype.onWindowResize=function(){this.actionObj.actionName=ro;this.actionBeginMethod()||(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.layoutRefresh.bind(this),500),this.actionObj.actionName=this.getActionCompleteName(),this.actionObj.actionName&&this.actionCompleteMethod())},i.prototype.refresh=function(){this.pivotRefresh()},i.prototype.layoutRefresh=function(){if(this.element&&this.element.classList.contains("e-pivotview")&&("olap"===this.dataType?this.olapEngineModule&&this.olapEngineModule.pivotValues:this.engineModule&&this.engineModule.pivotValues)){if(this.grid){var n="olap"===this.dataType&&this.olapEngineModule.pivotValues.length>0?this.olapEngineModule.pivotValues[0].length:this.dataSourceSettings.values.length>0&&this.engineModule.pivotValues.length>0?this.engineModule.pivotValues[0].length:2,t=this.renderModule.resizeColWidth(n);this.grid.width=this.renderModule.calculateGridWidth();this.renderModule.calculateGridHeight(!0);this.gridSettings.allowAutoResizing&&this.setCommonColumnsWidth(this.grid.columns,t);this.pivotColumns=[];this.totColWidth=0;this.framePivotColumns(this.grid.columns);this.posCount=0;this.showGroupingBar||this.setGridColumns(this.grid.columns);this.grid.refreshColumns();this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+kt)&&this.groupingBarModule.setGridRowWidth();(this.chart||this.pivotChartModule)&&(this.chart.height=this.pivotChartModule.getResizedChartHeight())}this.showToolbar&&this.toolbarModule&&this.toolbarModule.toolbar&&(this.toolbarModule.toolbar.width=this.grid?this.getGridWidthAsNumber()-2:this.getWidthAsNumber()-2);this.enablePaging&&this.notify(yf,this);this.chart&&(this.showToolbar&&"Chart"===this.currentView||!this.showToolbar)&&(this.chart.width=this.showToolbar&&this.grid||"Both"===this.displayOption.view&&this.grid?this.getGridWidthAsNumber().toString():this.getWidthAsNumber().toString(),this.chart.height=this.pivotChartModule.getResizedChartHeight(),"Chart"===this.displayOption.view&&this.showGroupingBar&&this.groupingBarModule&&this.element.querySelector("."+uf)&&this.groupingBarModule.refreshUI())}},i.prototype.cellClicked=function(t,i,r){var u=this;if(t.classList.contains(hs)&&(this.isPopupClicked=t.classList.contains(ss)?!1:!0),i&&!n.isNullOrUndefined(this.pivotValues)&&this.pivotValues.length>0){var e=Number(i.getAttribute("data-colindex")),f=Number(i.getAttribute("index")),o=Number(i.getAttribute("aria-colspan")),s={cancel:!1,isCellClick:!0,currentCell:i,data:this.pivotValues[f][e]};this.trigger(cf,s,function(n){u.gridSettings.allowSelection&&(("Both"===u.gridSettings.selectionSettings.mode?i.classList.contains(he):"Row"===u.gridSettings.selectionSettings.mode)?u.clearSelection(i,r,e,f):n.cancel||(u.clearSelection(i,r,e,f),u.applyColumnSelection(r,i,e,e+(o>0?o-1:0),f)),"Column"===u.gridSettings.selectionSettings.mode||i.classList.contains(bu)||u.rowDeselect(i,r,f,u.gridSettings.selectionSettings.mode,n),"Column"===u.gridSettings.selectionSettings.mode||n.cancel||(("Multiple"===u.gridSettings.selectionSettings.type?r.ctrlKey||r.shiftKey:u.selectedRowIndex===f)?u.selectedRowIndex=void 0:(u.selectedRowIndex=f,u.grid.selectionModule.selectRow(f-u.renderModule.rowStartPos))));u.cellClick&&n.isCellClick&&u.trigger("cellClick",{currentCell:i,data:u.pivotValues[f][e],nativeEvent:r});u.getSelectedCellsPos()})}else this.clearSelection(null,r,null,null)},i.prototype.rowDeselect=function(t,i,r,u,f){if((i.shiftKey||i.ctrlKey||"Both"===this.gridSettings.selectionSettings.mode)&&"Single"!==this.gridSettings.selectionSettings.type)(i.shiftKey||i.ctrlKey||"Both"===this.gridSettings.selectionSettings.mode)&&f.cancel&&(n.removeClass(this.element.querySelectorAll("."+tt),tt),n.removeClass(this.element.querySelectorAll("."+d),d),n.removeClass(this.element.querySelectorAll("."+g),g),this.setSavedSelectedCells());else if(t.classList.contains(tt)||t.classList.contains(d)||t.classList.contains(g)){if(n.removeClass(this.element.querySelectorAll("."+tt),tt),n.removeClass(this.element.querySelectorAll("."+d),d),n.removeClass(this.element.querySelectorAll("."+g),g),f.cancel)this.setSavedSelectedCells();else if("Cell"===u)n.addClass([t],[tt]);else if("Row"===u||"Single"===this.gridSettings.selectionSettings.type){var e='[index="'+r+'"]';n.addClass(this.element.querySelectorAll(e),[d,g]);"Row"!==u&&t.classList.add(tt)}}else f.cancel?this.setSavedSelectedCells():(n.removeClass(this.element.querySelectorAll("."+tt),tt),n.removeClass(this.element.querySelectorAll("."+d),d),n.removeClass(this.element.querySelectorAll("."+g),g))},i.prototype.clearSelection=function(t,i){var r,u,f;if(!i.shiftKey&&!i.ctrlKey||"Single"===this.gridSettings.selectionSettings.type)if("Cell"===this.gridSettings.selectionSettings.mode)t&&t.classList.contains(bu)?n.removeClass(this.element.querySelectorAll("."+he+"."+tt),tt):n.removeClass(this.element.querySelectorAll("."+bu+"."+g),[g,d]);else if("Both"===this.gridSettings.selectionSettings.mode)if(t&&t.classList.contains(he))for(r=0,u=[].slice.call(this.element.querySelectorAll("."+d+", ."+tt));r<u.length;r++)f=u[r],n.removeClass([f],[g,d,tt]);else n.removeClass(this.element.querySelectorAll("."+tt),tt)},i.prototype.applyRowSelection=function(n,t,i){var u=this.engineModule.pivotValues[t][n],e,f,r;if(i.ctrlKey||i.shiftKey||!u||this.selectedRowIndex===t)this.selectedRowIndex=void 0;else{this.selectedRowIndex=t;e=u.level;f=t;do f++,u=this.engineModule.pivotValues[f][n];while(u&&e<u.level);r=this;this.isAdaptive?this.rowRangeSelection={enable:!0,startIndex:t-r.renderModule.rowStartPos,endIndex:f-(1+r.renderModule.rowStartPos)}:r.grid.selectionModule.selectRowsByRange(t-r.renderModule.rowStartPos,f-(1+r.renderModule.rowStartPos))}},i.prototype.applyColumnSelection=function(t,i,r,u,f){var o,h,w,e,b,k,c,nt,l;if(!i.classList.contains(ci)&&("Cell"!==this.gridSettings.selectionSettings.mode||i.classList.contains(bu))){o=t.ctrlKey;this.isAdaptive&&"Multiple"===this.gridSettings.selectionSettings.type&&(this.grid.selectionModule.showPopup(t),this.isPopupClicked?(this.element.querySelector("."+hs).classList.add(ss),o=!0):(this.element.querySelector("."+hs).classList.remove(ss),o=!1));for(var rt=[],a=this.gridSettings.selectionSettings.type,v=i.classList.contains(g),s=[],y={},p=r;p<=u;p++)s.push(p.toString());if(o&&"Single"!==a)v=!1;else{for(h=0,w=[].slice.call(this.element.querySelectorAll("."+g));h<w.length;h++)e=w[h],n.removeClass([e],[g,d]),-1===s.indexOf(e.getAttribute("data-colindex"))&&(v=!1),b=Number(e.getAttribute("data-colindex")),y[b]=b;s=Object.keys(y).length>0?Object.keys(y).sort(function(n,t){return n-t}):s}if("Multiple"===a&&t.shiftKey?(this.shiftLockedPos=0===this.shiftLockedPos.length?s:this.shiftLockedPos,Number(this.shiftLockedPos[0])<=r?r=Number(this.shiftLockedPos[0]):u=u<Number(this.shiftLockedPos[this.shiftLockedPos.length-1])?Number(this.shiftLockedPos[this.shiftLockedPos.length-1]):u):this.shiftLockedPos=[],k=[],t.ctrlKey&&"Both"===this.gridSettings.selectionSettings.mode&&"Multiple"===a&&!i.classList.contains(ci))for(c=0,nt=[].slice.call(this.element.querySelectorAll("."+ci+"."+tt));c<nt.length;c++)e=nt[c],k.push(e.getAttribute("index"));for(l=r;l<=u;)rt.push('[data-colindex="'+l+'"]'+("Cell"===this.gridSettings.selectionSettings.mode?'[index="'+f+'"]':"")),l++;if(!v){f=i.classList.contains("e-headercell")?f:this.renderModule.rowStartPos-1;for(var ft=i.classList.contains(g),it=0,ut=[].slice.call(this.element.querySelectorAll(rt.toString()));it<ut.length;it++)e=ut[it],Number(e.getAttribute("index"))>=f&&(ft&&o&&-1===k.indexOf(e.getAttribute("index"))?n.removeClass([e],[g,d]):n.addClass([e],[g,d]))}this.renderModule.selected()}},i.prototype.getSelectedCellsPos=function(){var t=this,i,u,n,r,f;for(t.savedSelectedCellsPos=[],t.cellSelectionPos=[],i=0,u=[].slice.call(this.element.querySelectorAll("."+d));i<u.length;i++)n=u[i],t.savedSelectedCellsPos.push({rowIndex:n.getAttribute("index"),colIndex:n.getAttribute("data-colindex")});for(r=0,f=[].slice.call(this.element.querySelectorAll("."+tt));r<f.length;r++)n=f[r],t.cellSelectionPos.push({rowIndex:n.getAttribute("index"),colIndex:n.getAttribute("data-colindex")})},i.prototype.setSavedSelectedCells=function(){for(var i,r,e,u,t=0,f=[].slice.call(this.savedSelectedCellsPos);t<f.length;t++)i='[data-colindex="'+(u=f[t]).colIndex+'"][index="'+u.rowIndex+'"]',n.addClass([this.element.querySelector(i)],[g,d]);for(r=0,e=[].slice.call(this.cellSelectionPos);r<e.length;r++)i='[data-colindex="'+(u=e[r]).colIndex+'"][index="'+u.rowIndex+'"]',n.addClass([this.element.querySelector(i)],[tt])},i.prototype.renderEmptyGrid=function(){var t=this,i;(this.isEmptyGrid=!0,this.notEmpty=!1,this.isInitial=!0,this.renderModule=this.renderModule?this.renderModule:new hl(this),this.grid&&this.grid.element&&this.element.querySelector(".e-grid"))?(this.notEmpty=!0,this.grid.setProperties({columns:this.renderModule.frameEmptyColumns(),dataSource:this.renderModule.frameEmptyData()},!0),this.grid.notify("datasource-modified",{}),this.grid.refreshColumns()):(this.element.querySelector("."+yr)&&n.remove(this.element.querySelector("."+yr)),this.renderModule.bindGrid(this,!0),this.grid.showSpinner=function(){},this.grid.hideSpinner=function(){},i=n.createElement("div",{id:this.element.id+"_grid"}),this.element.appendChild(i),this.grid.isStringTemplate=!0,this.grid.appendTo(i),this.grid.on("refresh-frozen-height",function(){t.enableVirtualization||t.grid.contentModule.setHeightToContent(t.grid.contentModule.getTable().offsetHeight)}),this.grid.off("data-ready",this.grid.dataReady),this.grid.on("data-ready",function(){t.grid.scrollModule.setWidth();t.grid.scrollModule.setHeight()}))},i.prototype.initEngine=function(){var t=this,i,u,f;if((this.element.querySelector(".e-spin-hide")&&this.showWaitingPopup(),"pivot"===this.dataType)&&(i=n.isNullOrUndefined(this.dataSourceSettings.dataSource)?n.isNullOrUndefined(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0],i&&this.pivotCommon)){if(u="[object Array]"===Object.prototype.toString.call(i),u&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!u&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}f={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};this.trigger(ni,f,function(n){var i,f,u;r.updateDataSourceSettings(t,n.dataSourceSettings);t.updatePageSettings(!1);i={mode:"",savedFieldList:void 0,pageSettings:t.pageSettings,enableValueSorting:t.enableValueSorting,isDrillThrough:t.allowDrillThrough||t.editSettings.allowEditing,localeObj:t.localeObj,fieldsType:t.fieldsType,clonedReport:t.clonedReport,globalize:t.globalize,currenyCode:t.currencyCode,enablePaging:t.enablePaging,enableVirtualization:t.enableVirtualization,allowDataCompression:t.allowDataCompression,enableHtmlSanitizer:t.enableHtmlSanitizer};"pivot"===t.dataType?(t.dataSourceSettings.groupSettings&&t.dataSourceSettings.groupSettings.length>0&&(f=t.engineModule.data,t.clonedDataSet=t.clonedDataSet?t.clonedDataSet:r.getClonedData(f),u=JSON.parse(t.getPersistData()).dataSourceSettings,u.dataSource=[],t.clonedReport=t.clonedReport?t.clonedReport:u),"Server"!==t.dataSourceSettings.mode&&t.engineModule.renderEngine(t.dataSourceSettings,i,t.aggregateCellInfo?t.getValueCellInfo.bind(t):void 0,t.onHeadersSort?t.getHeaderSortInfo.bind(t):void 0),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.engineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("initEngine")):"SSAS"===t.dataSourceSettings.providerType&&"olap"===t.dataType&&(i.savedFieldList=t.olapEngineModule.fieldList,i.savedFieldListData=t.olapEngineModule.fieldListData,t.olapEngineModule.renderEngine(t.dataSourceSettings,i,t.onHeadersSort?t.getHeaderSortInfo.bind(t):void 0),t.allowServerDataBinding=!1,t.setProperties({pivotValues:t.olapEngineModule.pivotValues},!0),delete t.bulkChanges.pivotValues,t.allowServerDataBinding=!0,t.enginePopulatedEventMethod("initEngine"))})},i.prototype.enginePopulatedEventMethod=function(n,t){var r,i,u;"initEngine"===n?(r=t||this,this.trigger(ti,{pivotValues:this.pivotValues},function(n){"olap"===r.dataType?(r.olapEngineModule.pivotValues=n.pivotValues,r.pivotValues=r.olapEngineModule.pivotValues):(r.engineModule.pivotValues=n.pivotValues,r.pivotValues=r.engineModule.pivotValues);r.notify(wt,{});r.notEmpty=!0})):(i=t||this,u={dataSourceSettings:i.dataSourceSettings,pivotValues:i.pivotValues},i.trigger(ti,u,function(n){i.dataSourceSettings=n.dataSourceSettings;"olap"===i.dataType?(i.olapEngineModule.pivotValues=n.pivotValues,i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.olapEngineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0):(i.engineModule.pivotValues=n.pivotValues,i.allowServerDataBinding=!1,i.setProperties({pivotValues:i.engineModule.pivotValues},!0),delete i.bulkChanges.pivotValues,i.allowServerDataBinding=!0);i.pivotCommon.engineModule="olap"===i.dataType?i.olapEngineModule:i.engineModule;i.pivotCommon.dataSourceSettings=i.dataSourceSettings;i.renderPivotGrid()}))},i.prototype.generateData=function(){this.isStaticRefresh||("Chart"!==this.displayOption.view&&n.isNullOrUndefined(this.grid)?(this.renderEmptyGrid(),this.showWaitingPopup()):(this.showWaitingPopup(),clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.refreshData.bind(this),100)))},i.prototype.refreshData=function(){var n=this;n.isStaticRefresh?(n.isStaticRefresh=!1,n.hideWaitingPopup()):n.dataSourceSettings&&(n.dataSourceSettings.dataSource||n.dataSourceSettings.url)?n.dataSourceSettings.dataSource instanceof ut.DataManager?"pivot"===n.dataType&&n.remoteData.length>0?(this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup(),this.engineModule.data=n.remoteData,this.initEngine()):setTimeout(n.getData.bind(n),100):""!==this.dataSourceSettings.url&&"olap"===this.dataType||n.dataSourceSettings.dataSource&&n.dataSourceSettings.dataSource.length>0||this.engineModule.data.length>0?("pivot"===n.dataType&&(this.hideWaitingPopup(),n.engineModule.data=n.dataSourceSettings.dataSource),n.initEngine()):"Server"===this.dataSourceSettings.mode?this.getEngine("onRefresh"):(this.notify(wt,{}),this.hideWaitingPopup()):(this.notify(wt,{}),this.hideWaitingPopup())},i.prototype.getValueCellInfo=function(n){var t=n;return this.trigger(ys,t),t},i.prototype.getHeaderSortInfo=function(n){var t=n;return this.trigger(su,t),t},i.prototype.bindTriggerEvents=function(n){this.trigger(s.getObject("name",n),n)},i.prototype.getData=function(){this.dataSourceSettings.dataSource.defaultQuery?this.dataSourceSettings.dataSource.executeQuery(this.dataSourceSettings.dataSource.defaultQuery).then(this.executeQuery.bind(this)):this.dataSourceSettings.dataSource.executeQuery(new ut.Query).then(this.executeQuery.bind(this))},i.prototype.executeQuery=function(t){this.element.querySelector(".e-spinner-pane")||this.showWaitingPopup();var i=this;i.engineModule.data=t.result;!n.isNullOrUndefined(i.engineModule.data)&&i.engineModule.data.length>0?i.initEngine():this.hideWaitingPopup()},i.prototype.applyFormatting=function(t){var f,r,i,e;if(t){for(var s=[],h=t.length,u=0;u<h;u++)void 0!==t[u]&&void 0===t[u][0]&&s.push(u);for(u=0;u<t.length;u++)for(f=1;t[u]&&f<t[u].length;f++)if("value"===t[u][f].axis&&""!==t[u][f].formattedText)for(t[u][f].style=void 0,t[u][f].cssClass=void 0,r=this.dataSourceSettings.conditionalFormatSettings,i=0;i<r.length;i++)(!0===r[i].applyGrandTotals||n.isNullOrUndefined(r[i].applyGrandTotals)||""!==t[u][f].rowHeaders&&""!==t[u][f].columnHeaders)&&this.checkCondition(t[u][f].value,r[i].conditions,r[i].value1,r[i].value2)&&(r[i].measure&&t[u][f].actualText!==r[i].measure||void 0!==r[i].measure&&""===r[i].measure||void 0!==r[i].label&&""===r[i].label||!(!r[i].label||t[u][0].valueSort.levelName.indexOf(r[i].label)>-1||t[u][f].rowHeaders.indexOf(r[i].label)>-1||t[u][f].columnHeaders.indexOf(r[i].label)>-1)||(r[i].style&&r[i].style.backgroundColor&&(r[i].style.backgroundColor=this.conditionalFormattingModule.isHex(r[i].style.backgroundColor.substr(1))?r[i].style.backgroundColor:this.conditionalFormattingModule.colourNameToHex(r[i].style.backgroundColor)),r[i].style&&r[i].style.color&&(r[i].style.color=this.conditionalFormattingModule.isHex(r[i].style.color.substr(1))?r[i].style.color:this.conditionalFormattingModule.colourNameToHex(r[i].style.color)),t[u][f].style=r[i].style,t[u][f].cssClass="format"+this.element.id+i));for(e=this.dataSourceSettings.conditionalFormatSettings,i=0;i<e.length;i++){var c=this.createStyleSheet.bind(this)(),l="color: "+e[i].style.color+"!important;background-color: "+e[i].style.backgroundColor+"!important;font-size: "+e[i].style.fontSize+"!important;font-family: "+e[i].style.fontFamily+" !important;",o=".format"+this.element.id+i;c.insertRule(o+", "+o+" .e-cellvalue{"+l+"}",0)}}},i.prototype.createStyleSheet=function(){var n=document.createElement("style");return n.appendChild(document.createTextNode("")),document.head.appendChild(n),n.sheet},i.prototype.applyHyperlinkSettings=function(){var u,f,r,s,h,c,o,l;if(this.pivotValues){for(var t=this.pivotValues,e=[],a=t.length,i=0;i<a;i++)n.isNullOrUndefined(t[i])||void 0!==t[i][0]||e.push(i);if(this.hyperlinkSettings.conditionalSettings.length>0)for(i=0;i<t.length;i++)for(u=1;t[i]&&u<t[i].length;u++)if("value"===t[i][u].axis)for(t[i][u].enableHyperlink=!1,f=this.hyperlinkSettings.conditionalSettings,r=0;r<f.length;r++)this.checkCondition(t[i][u].value,f[r].conditions,f[r].value1,f[r].value2)&&(s="row"===this.dataSourceSettings.valueAxis?i:"pivot"===this.dataType?this.engineModule.headerContent.length-1:this.olapEngineModule.headerContent.length-1,h="row"===this.dataSourceSettings.valueAxis?0:u,(!f[r].measure||1===this.dataSourceSettings.values.length||t[s][h].valueSort&&t[s][h].actualText===f[r].measure)&&(!f[r].label||t[e[f[r].label.split(".").length-1]]&&t[e[f[r].label.split(".").length-1]][u]&&t[e[f[r].label.split(".").length-1]][u].valueSort&&t[e[f[r].label.split(".").length-1]][u].valueSort[f[r].label]||t[i][0].valueSort.levelName.indexOf(f[r].label)>-1)&&(t[i][u].enableHyperlink=!0));if(n.isNullOrUndefined(this.hyperlinkSettings.headerText))return;for(c=this.dataSourceSettings.valueSortSettings.headerDelimiter?this.dataSourceSettings.valueSortSettings.headerDelimiter:".",i=0;i<t.length;i++)for(u=1;t[i]&&u<t[i].length;u++)if("value"===t[i][u].axis)if(o=this.hyperlinkSettings.headerText,t[i][0].valueSort.levelName.indexOf(o)>-1)t[i][0].enableHyperlink=!0,t[i][u].enableHyperlink=!0;else{for(l=!1,r=0;r<e.length;r++)o=c+this.hyperlinkSettings.headerText,(c+t[e[r]][u].valueSort.levelName).indexOf(o)>-1&&(t[e[r]][u].enableHyperlink=!0,l=!0);t[i][u].enableHyperlink=l}}},i.prototype.checkCondition=function(n,t,i,r){switch(t){case"LessThan":return n<i;case"LessThanOrEqualTo":return n<=i;case"GreaterThan":return n>i;case"GreaterThanOrEqualTo":return n>=i;case"Equals":return n===i;case"NotEquals":return n!==i;case"Between":return i<r&&n>=i&&n<=r||i>r&&n<=i&&n>=r;case"NotBetween":return!(i<r&&n>=i&&n<=r||i>r&&n<=i&&n>=r);default:return!1}},i.prototype.updateGroupingReport=function(t,i){var ut,k,w,g,v,b;this.clonedDataSet||this.clonedReport||(ut=this.engineModule.data,this.clonedDataSet=r.getClonedData(ut),k=JSON.parse(this.getPersistData()).dataSourceSettings,k.dataSource=[],this.clonedReport=this.clonedReport?this.clonedReport:k);var ft=/_date_group_years|_date_group_quarters|_date_group_quarterYear|_date_group_months|_date_group_days|_date_group_hours|_date_group_minutes|_date_group_seconds/g,ct=r.getClonedData(this.clonedDataSet),e=this.dataSourceSettings,h=this.clonedReport.properties?this.clonedReport.properties:this.clonedReport,s=[e.rows,e.columns,e.values,e.filters],o=[e.filterSettings,e.sortSettings,e.formatSettings,e.drilledMembers],l=h.rows;if(l=l.concat(h.columns,h.values,h.filters),0===t.length||t.length>0){this.engineModule.groupingFields={};this.setProperties({dataSourceSettings:{dataSource:ct,groupSettings:t.length>0?e.groupSettings:[]}},!0);for(var y,et="Date"===i,a=[],u=0,d=s.length;u<d;u++)for(var ot,st,lt=function(t,i){var f=s[u][t].name,v,h,c,o;if(-1===a.indexOf(f)&&a.push(f),v=a.indexOf(f),(n.isNullOrUndefined(f.match(ft))||!et)&&(-1===f.indexOf("_custom_group")||r.getFieldByName(f.replace("_custom_group",""),e.groupSettings)))(o=r.getFieldByName(f,l))?s[u].splice(t,1,o):y===f&&s[u].splice(t,1);else{for(s[u].splice(t,1),a.splice(v,1),t--,i--,f=f.split("_")[0],h=!1,c=0;c<s.length&&!(h=s[c].filter(function(n){return n.name===f}).length>0);c++);h||(y=f.split("_")[0],o=r.getFieldByName(y,l),l=l.filter(function(n){return n.name!==y}),a.push(y),o&&(h?s[u].splice(t,1,o):s[u].splice(++t,0,o)))}ot=t;st=i},f=0,c=s[u].length;f<c;f++)lt(f,c),f=ot,c=st;for(w=0,g=a;w<g.length;w++){var p=g[w],nt=r.getFilterItemByName(p,h.filterSettings),tt=r.getFieldByName(p,h.sortSettings),it=r.getFieldByName(p,h.formatSettings),rt=r.getFieldByName(p,h.drilledMembers),ht=[nt,tt,it,rt];for(u=0,d=o.length;u<d;u++){for(v=!1,f=0,c=o[u].length;f<c;f++)if(b=o[u][f].name,(n.isNullOrUndefined(b.match(ft))||!et)&&(-1===b.indexOf("_custom_group")||r.getFieldByName(b.replace("_custom_group",""),e.groupSettings))){if(p===o[u][f].name){v=!0;ht[u]?o[u].splice(f,1,ht[u]):(o[u].splice(f,1),f--,c--);break}}else o[u].splice(f,1),f--,c--;!v&&0===u&&nt&&o[u].push(nt);!v&&1===u&&tt&&o[u].push(tt);!v&&2===u&&it&&o[u].push(it);!v&&3===u&&rt&&o[u].push(rt)}}}},i.prototype.removeButtonFocus=function(){document.querySelectorAll(".e-btn-focused")&&n.removeClass(document.querySelectorAll(".e-btn-focused"),"e-btn-focused")},i.prototype.wireEvents=function(){"Chart"!==this.displayOption.view&&(n.EventHandler.add(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler,this),n.EventHandler.add(this.element,"mousedown",this.mouseDownHandler,this),n.EventHandler.add(this.element.querySelector("."+nf),"mousemove",this.mouseMoveHandler,this),n.EventHandler.add(this.element,"mouseup",this.mouseUpHandler,this),n.EventHandler.add(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler,this));n.EventHandler.add(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus,this);window.addEventListener("resize",this.onWindowResize.bind(this),!0)},i.prototype.unwireEvents=function(){"Chart"!==this.displayOption.view&&(n.EventHandler.remove(this.element,this.isAdaptive?"touchend":"click",this.mouseClickHandler),n.EventHandler.remove(this.element,"mousedown",this.mouseDownHandler),this.element.querySelector("."+nf)&&n.EventHandler.remove(this.element.querySelector("."+nf),"mousemove",this.mouseMoveHandler),n.EventHandler.remove(this.element,"mouseup",this.mouseUpHandler),n.EventHandler.remove(this.element,this.isAdaptive?"touchend":"contextmenu",this.mouseRclickHandler));n.EventHandler.remove(document,this.isAdaptive?"touchend":"click",this.removeButtonFocus);window.removeEventListener("resize",this.onWindowResize.bind(this),!0)},i.prototype.actionBeginMethod=function(){var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return this.trigger(ds,n),n.cancel},i.prototype.actionCompleteMethod=function(){var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};this.trigger(gs,n);this.actionObj.actionName="";this.actionObj.actionInfo=void 0;this.actionObj.fieldInfo=void 0},i.prototype.actionFailureMethod=function(n){var t={actionName:this.actionObj.actionName,errorInfo:n};this.trigger(nh,t)},i.prototype.getActionCompleteName=function(){var n;switch(this.actionObj.actionName){case"Open conditional formatting dialog":n="Conditional formatting applied";break;case"Open number formatting dialog":n="Number formatting applied";break;case"Show table view":n="Table view shown";break;case"Show chart view":n="Chart view shown";break;case"Hide sub-totals":n="Sub-totals hidden";break;case"Show row sub-totals":n="Row sub-totals shown";break;case"Show column sub-totals":n="Column sub-totals shown";break;case"Show sub-totals":n="Sub-totals shown";break;case"Hide grand totals":n="Grand totals hidden";break;case"Show row grand totals":n="Row grand totals shown";break;case"Show column grand totals":n="Column grand totals shown";break;case"Show grand totals":n="Grand totals shown";break;case rh:n="Value sorted";break;case io:n=uo;break;case pf:n=fo;break;case no:n=hh;break;case to:n=ch;break;case wf:n=lh;break;case bf:n=ah;break;case fh:n="Record edited";break;case"Report change":n="Report changed";break;case eh:n="Edited records saved";break;case oh:n="New record added";break;case sh:n="Record removed";break;case"PNG export":n="PNG exported";break;case"JPEG export":n="JPEG exported";break;case"SVG export":n="SVG exported";break;case"PDF export":n="PDF exported";break;case"CSV export":n="CSV exported";break;case"Excel export":n="Excel exported";break;case ro:n="Window resized";break;case"Save current report":n="Report saved";break;case"Add new report":n="New report added";break;case"Save as current report":n="Report re-saved";break;case"Rename current report":n="Report renamed";break;case ih:n="Horizontally scrolled";break;case th:n="Vertically scrolled";break;case"Navigate row page":n="Row page navigated";break;case"Navigate column page":n="Column page navigated";break;default:n=this.actionObj.actionName}return n},i.prototype.getStackedColumns=function(n,t){for(var i,r=0,u=n;r<u.length;r++)i=u[r],t.push(i),i.columns&&i.columns.length>0&&this.getStackedColumns(i.columns,t);return t},i.prototype.destroy=function(){this.removeInternalEvents();this.engineModule&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=null,this.engineModule.indexMatrix=null,this.engineModule={});this.olapEngineModule&&(this.olapEngineModule.fieldList={},this.olapEngineModule={});this.showGroupingBar&&this.groupingBarModule&&this.groupingBarModule.destroy();this.allowGrouping&&this.groupingModule&&this.groupingModule.destroy();this.showToolbar&&this.toolbarModule&&this.toolbarModule.destroy();this.enablePaging&&this.pagerModule&&this.pagerModule.destroy();this.enableVirtualization&&this.virtualscrollModule&&this.virtualscrollModule.destroy();this.allowConditionalFormatting&&this.conditionalFormattingModule&&this.conditionalFormattingModule.destroy();this.allowNumberFormatting&&this.numberFormattingModule&&this.numberFormattingModule.destroy();this.contextMenuModule&&this.contextMenuModule.destroy();this.keyboardModule&&this.keyboardModule.destroy();this.tooltip&&!this.tooltip.isDestroyed&&this.tooltip.destroy();this.calculatedFieldModule&&this.calculatedFieldModule.destroy();this.chart&&!this.chart.isDestroyed&&(this.chart.destroy(),this.chart.isDestroyed&&n.select("#"+this.element.id+"_chart",this.element)&&n.remove(n.select("#"+this.element.id+"_chart",this.element)));this.grid&&!this.grid.isDestroyed&&(this.grid.destroy(),this.grid.isDestroyed&&n.select("#"+this.element.id+"_grid",this.element)&&n.remove(n.select("#"+this.element.id+"_grid",this.element)));this.commonModule&&this.commonModule.destroy();this.pivotChartModule&&this.pivotChartModule.destroy();this.pivotButtonModule&&!this.pivotButtonModule.isDestroyed&&this.pivotButtonModule.destroy();this.pivotFieldListModule&&!this.pivotFieldListModule.isDestroyed&&(this.pivotFieldListModule.destroy(),this.pivotFieldListModule.isDestroyed&&null!==n.select("#"+this.element.id+"_PivotFieldList",this.element)&&n.remove(n.select("#"+this.element.id+"_PivotFieldList",this.element)));(this.allowDrillThrough||this.editSettings&&this.editSettings.allowEditing)&&this.drillThroughModule&&this.drillThroughModule.destroy();this.chartExportModule&&this.chartExportModule.destroy();this.unwireEvents();t.prototype.destroy.call(this);this.groupingBarModule&&(this.groupingBarModule=null);this.groupingModule&&(this.groupingModule=null);this.pivotFieldListModule&&(this.pivotFieldListModule=null);this.calculatedFieldModule&&(this.calculatedFieldModule=null);this.conditionalFormattingModule&&(this.conditionalFormattingModule=null);this.numberFormattingModule&&(this.numberFormattingModule=null);this.toolbarModule&&(this.toolbarModule=null);this.pagerModule&&(this.pagerModule=null);this.virtualscrollModule&&(this.virtualscrollModule=null);this.contextMenuModule&&(this.contextMenuModule=null);this.keyboardModule&&(this.keyboardModule=null);this.tooltip&&(this.tooltip=null);this.chart&&(this.chart=null);this.grid&&(this.grid=null);this.commonModule&&(this.commonModule=null);this.pivotChartModule&&(this.pivotChartModule=null);this.pivotButtonModule&&(this.pivotButtonModule=null);this.renderModule&&(this.renderModule=null);this.axisFieldModule&&(this.axisFieldModule=null);this.pdfExportModule&&(this.pdfExportModule=null);this.excelExportModule&&(this.excelExportModule=null);this.drillThroughModule&&(this.drillThroughModule=null);this.clonedDataSet&&(this.clonedDataSet=null);this.clonedReport&&(this.clonedReport=null);this.pagerModule&&(this.pagerModule=null);this.chartExportModule&&(this.chartExportModule=null);this.mScrollBarEvents=null;this.element.innerHTML="";n.removeClass([this.element],eo);n.removeClass([this.element],ii);n.removeClass([this.element],ir)},i.prototype.showNumberFormattingDialog=function(){this.allowNumberFormatting&&this.numberFormattingModule.showNumberFormattingDialog()},i.prototype.getValuesHeader=function(t,i){var r=this.dataSourceSettings.values;return"value"===i&&!n.isNullOrUndefined(t.valueSort)&&this.localeObj.getConstant("grandTotal")+this.dataSourceSettings.valueSortSettings.headerDelimiter+t.formattedText===t.valueSort.levelName&&("column"===t.axis&&0===this.dataSourceSettings.columns.length&&"column"===this.dataSourceSettings.valueAxis||"row"===t.axis&&0===this.dataSourceSettings.rows.length&&"row"===this.dataSourceSettings.valueAxis)?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(this.engineModule.fieldList[t.actualText].aggregateType)+" "+this.localeObj.getConstant("of")+" "+t.formattedText:"grandTotal"===i&&1===r.length&&"row"===this.dataSourceSettings.valueAxis&&t.formattedText===this.localeObj.getConstant("grandTotal")?this.localeObj.getConstant("total")+" "+this.localeObj.getConstant(r[r.length-1].type)+" "+this.localeObj.getConstant("of")+" "+(n.isNullOrUndefined(r[r.length-1].caption)?r[r.length-1].name:r[r.length-1].caption):t.formattedText},u([n.Property("USD")],i.prototype,"currencyCode",void 0),u([n.Property(!1)],i.prototype,"showFieldList",void 0),u([n.Complex({},ev)],i.prototype,"gridSettings",void 0),u([n.Complex({},py)],i.prototype,"chartSettings",void 0),u([n.Complex({},ky)],i.prototype,"groupingBarSettings",void 0),u([n.Complex({},np)],i.prototype,"hyperlinkSettings",void 0),u([n.Complex({},tp)],i.prototype,"pageSettings",void 0),u([n.Complex({},ip)],i.prototype,"pagerSettings",void 0),u([n.Complex({},al)],i.prototype,"dataSourceSettings",void 0),u([n.Complex({},dy)],i.prototype,"editSettings",void 0),u([n.Complex({},rp)],i.prototype,"displayOption",void 0),u([n.Property()],i.prototype,"pivotValues",void 0),u([n.Property(!1)],i.prototype,"showGroupingBar",void 0),u([n.Property(!0)],i.prototype,"showTooltip",void 0),u([n.Property(!1)],i.prototype,"showToolbar",void 0),u([n.Property([])],i.prototype,"toolbar",void 0),u([n.Property(!1)],i.prototype,"showValuesButton",void 0),u([n.Property(!1)],i.prototype,"allowCalculatedField",void 0),u([n.Property(!1)],i.prototype,"enableFieldSearching",void 0),u([n.Property(!1)],i.prototype,"enableValueSorting",void 0),u([n.Property(!1)],i.prototype,"allowConditionalFormatting",void 0),u([n.Property(!1)],i.prototype,"allowNumberFormatting",void 0),u([n.Property("auto")],i.prototype,"height",void 0),u([n.Property("auto")],i.prototype,"width",void 0),u([n.Property(!1)],i.prototype,"allowExcelExport",void 0),u([n.Property(!1)],i.prototype,"enableVirtualization",void 0),u([n.Property(!1)],i.prototype,"enablePaging",void 0),u([n.Property(!1)],i.prototype,"allowDrillThrough",void 0),u([n.Property(!1)],i.prototype,"allowPdfExport",void 0),u([n.Property(!1)],i.prototype,"allowDeferLayoutUpdate",void 0),u([n.Property(!1)],i.prototype,"allowDataCompression",void 0),u([n.Property(1e3)],i.prototype,"maxNodeLimitInMemberEditor",void 0),u([n.Property(1e4)],i.prototype,"maxRowsInDrillThrough",void 0),u([n.Property(!0)],i.prototype,"loadOnDemandInMemberEditor",void 0),u([n.Property(!1)],i.prototype,"enableHtmlSanitizer",void 0),u([n.Property()],i.prototype,"cellTemplate",void 0),u([n.Property()],i.prototype,"toolbarTemplate",void 0),u([n.Property()],i.prototype,"tooltipTemplate",void 0),u([n.Property()],i.prototype,"spinnerTemplate",void 0),u([n.Property(!1)],i.prototype,"allowGrouping",void 0),u([n.Property(!0)],i.prototype,"exportAllPages",void 0),u([n.Property(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],i.prototype,"aggregateTypes",void 0),u([n.Property(["Column","Bar","Line","Area","Scatter","Polar","StackingColumn","StackingArea","StackingBar","StackingLine","StepLine","StepArea","SplineArea","Spline","StackingColumn100","StackingBar100","StackingArea100","StackingLine100","Bubble","Pareto","Radar","Pie","Doughnut","Funnel","Pyramid"])],i.prototype,"chartTypes",void 0),u([n.Property("")],i.prototype,"cssClass",void 0),u([n.Event()],i.prototype,"queryCellInfo",void 0),u([n.Event()],i.prototype,"headerCellInfo",void 0),u([n.Event()],i.prototype,"resizing",void 0),u([n.Event()],i.prototype,"resizeStop",void 0),u([n.Event()],i.prototype,"pdfHeaderQueryCellInfo",void 0),u([n.Event()],i.prototype,"pdfQueryCellInfo",void 0),u([n.Event()],i.prototype,"excelHeaderQueryCellInfo",void 0),u([n.Event()],i.prototype,"excelQueryCellInfo",void 0),u([n.Event()],i.prototype,"columnDragStart",void 0),u([n.Event()],i.prototype,"columnDrag",void 0),u([n.Event()],i.prototype,"columnDrop",void 0),u([n.Event()],i.prototype,"beforePdfExport",void 0),u([n.Event()],i.prototype,"beforeExcelExport",void 0),u([n.Event()],i.prototype,"beforeColumnsRender",void 0),u([n.Event()],i.prototype,"selected",void 0),u([n.Event()],i.prototype,"cellDeselected",void 0),u([n.Event()],i.prototype,"rowSelected",void 0),u([n.Event()],i.prototype,"rowDeselected",void 0),u([n.Event()],i.prototype,"chartTooltipRender",void 0),u([n.Event()],i.prototype,"chartLegendClick",void 0),u([n.Event()],i.prototype,"multiLevelLabelRender",void 0),u([n.Event()],i.prototype,"chartLoaded",void 0),u([n.Event()],i.prototype,"chartLoad",void 0),u([n.Event()],i.prototype,"chartResized",void 0),u([n.Event()],i.prototype,"chartAxisLabelRender",void 0),u([n.Event()],i.prototype,"multiLevelLabelClick",void 0),u([n.Event()],i.prototype,"chartPointClick",void 0),u([n.Event()],i.prototype,"contextMenuClick",void 0),u([n.Event()],i.prototype,"contextMenuOpen",void 0),u([n.Event()],i.prototype,"onPdfCellRender",void 0),u([n.Event()],i.prototype,"saveReport",void 0),u([n.Event()],i.prototype,"fetchReport",void 0),u([n.Event()],i.prototype,"loadReport",void 0),u([n.Event()],i.prototype,"renameReport",void 0),u([n.Event()],i.prototype,"removeReport",void 0),u([n.Event()],i.prototype,"newReport",void 0),u([n.Event()],i.prototype,"toolbarRender",void 0),u([n.Event()],i.prototype,"toolbarClick",void 0),u([n.Event()],i.prototype,"load",void 0),u([n.Event()],i.prototype,"enginePopulating",void 0),u([n.Event()],i.prototype,"enginePopulated",void 0),u([n.Event()],i.prototype,"onFieldDropped",void 0),u([n.Event()],i.prototype,"fieldDrop",void 0),u([n.Event()],i.prototype,"fieldDragStart",void 0),u([n.Event()],i.prototype,"dataBound",void 0),u([n.Event()],i.prototype,"created",void 0),u([n.Event()],i.prototype,"destroyed",void 0),u([n.Event()],i.prototype,"beforeExport",void 0),u([n.Event()],i.prototype,"exportComplete",void 0),u([n.Event()],i.prototype,"conditionalFormatting",void 0),u([n.Event()],i.prototype,"memberFiltering",void 0),u([n.Event()],i.prototype,"cellClick",void 0),u([n.Event()],i.prototype,"drillThrough",void 0),u([n.Event()],i.prototype,"editCompleted",void 0),u([n.Event()],i.prototype,"beginDrillThrough",void 0),u([n.Event()],i.prototype,"hyperlinkCellClick",void 0),u([n.Event()],i.prototype,"cellSelecting",void 0),u([n.Event()],i.prototype,"drill",void 0),u([n.Event()],i.prototype,"cellSelected",void 0),u([n.Event()],i.prototype,"chartSeriesCreated",void 0),u([n.Event()],i.prototype,"aggregateCellInfo",void 0),u([n.Event()],i.prototype,"fieldListRefreshed",void 0),u([n.Event()],i.prototype,"memberEditorOpen",void 0),u([n.Event()],i.prototype,"calculatedFieldCreate",void 0),u([n.Event()],i.prototype,"numberFormatting",void 0),u([n.Event()],i.prototype,"aggregateMenuOpen",void 0),u([n.Event()],i.prototype,"fieldRemove",void 0),u([n.Event()],i.prototype,"beforeServiceInvoke",void 0),u([n.Event()],i.prototype,"afterServiceInvoke",void 0),u([n.Event()],i.prototype,"actionBegin",void 0),u([n.Event()],i.prototype,"actionComplete",void 0),u([n.Event()],i.prototype,"actionFailure",void 0),u([n.Event()],i.prototype,"onHeadersSort",void 0),u([n.NotifyPropertyChanges],i)}(n.Component);ejdashboard.excelexport;var up=function(){function t(n){this.parent=n}return t.prototype.render=function(){var t=n.createElement("div",{id:this.parent.element.id+"_Container",className:vh+" "+("olap"===this.parent.dataType?"e-olapfieldlist-container":""),styles:"width:"+this.parent.element.style.width});this.parent.isAdaptive?n.addClass([t],ir):n.removeClass([t],ir);this.parent.enableRtl?n.addClass([t],ii):n.removeClass([t],ii);this.parent.cssClass&&n.addClass([t],this.parent.cssClass.split(" "));this.parent.enableFieldSearching?n.addClass([t],wh):n.removeClass([t],wh);this.parentElement=n.createElement("div",{className:"e-field-list-container"});this.parent.element.appendChild(t);this.parent.isAdaptive&&(t.removeAttribute("style"),this.parentElement=n.createElement("div",{className:"e-adaptive-container"}),this.renderAdaptiveLayout(t));"Popup"===this.parent.renderMode?(this.renderFieldListDialog(t),this.unWireDialogEvent(this.parent.element.querySelector("."+rt)),this.wireDialogEvent(this.parent.element.querySelector("."+rt))):this.renderStaticLayout(t)},t.prototype.renderStaticLayout=function(t){if(!this.parent.isAdaptive){var i=n.createElement("div",{className:"e-field-list-title"}),r=n.createElement("div",{className:"e-title-content"});r.innerText=this.parent.localeObj.getConstant("staticFieldList");i.appendChild(r);i.appendChild(this.createCalculatedButton());n.addClass([t],oo);t.appendChild(i);t.appendChild(this.parentElement);n.addClass([t],oo);this.parent.allowDeferLayoutUpdate&&(t.appendChild(this.createDeferUpdateButtons()),this.renderDeferUpdateButtons())}},t.prototype.renderDeferUpdateButtons=function(){this.parent.allowDeferLayoutUpdate&&(this.deferUpdateCheckBox=new ht.CheckBox({label:this.parent.localeObj.getConstant("deferLayoutUpdate"),checked:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,change:this.onCheckChange.bind(this),cssClass:this.parent.cssClass}),this.deferUpdateCheckBox.isStringTemplate=!0,this.deferUpdateCheckBox.appendTo("#"+this.parent.element.id+"DeferUpdateCheckBox"),this.deferUpdateApplyButton=new ht.Button({cssClass:"e-defer-apply-button e-defer-update-btn"+("Popup"===this.parent.renderMode?" "+ee:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,isPrimary:!0}),this.deferUpdateApplyButton.isStringTemplate=!0,this.deferUpdateApplyButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton1"),this.deferUpdateApplyButton.element.onclick="Fixed"===this.parent.renderMode?this.applyButtonClick.bind(this):this.onDeferUpdateClick.bind(this));this.deferUpdateCancelButton=new ht.Button({cssClass:"e-defer-cancel-button "+br+("Popup"===this.parent.renderMode?" "+ee:"")+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.allowDeferLayoutUpdate?this.parent.localeObj.getConstant("cancel"):this.parent.localeObj.getConstant("close"),enableRtl:this.parent.enableRtl,isPrimary:!this.parent.allowDeferLayoutUpdate,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});this.deferUpdateCancelButton.isStringTemplate=!0;this.deferUpdateCancelButton.appendTo("#"+this.parent.element.id+"_DeferUpdateButton2");this.deferUpdateCancelButton.element.onclick=this.onCloseFieldList.bind(this)},t.prototype.createDeferUpdateButtons=function(){var i=n.createElement("div",{className:"e-layout-footer"}),r,u,t,f,e;return this.parent.allowDeferLayoutUpdate&&(r=n.createElement("div",{className:"e-checkbox-layout",attrs:{title:this.parent.localeObj.getConstant("deferLayoutUpdate")}}),u=n.createElement("input",{id:this.parent.element.id+"DeferUpdateCheckBox"}),r.appendChild(u),i.appendChild(r)),t=n.createElement("div",{className:"e-button-layout"}),this.parent.allowDeferLayoutUpdate&&(f=n.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton1",attrs:{type:"button",title:this.parent.localeObj.getConstant("apply")}}),t.appendChild(f)),e=n.createElement("button",{id:this.parent.element.id+"_DeferUpdateButton2",attrs:{type:"button",title:this.parent.localeObj.getConstant("cancel")}}),t.appendChild(e),i.appendChild(t),i},t.prototype.onCheckChange=function(t){t.checked&&(this.parent.clonedDataSource=n.extend({},this.parent.dataSourceSettings,null,!0),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=r.getClonedFieldList(this.parent.pivotFieldList));this.parent.allowDeferLayoutUpdate=!this.parent.allowDeferLayoutUpdate;"Fixed"===this.parent.renderMode?(this.deferUpdateApplyButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate}),this.deferUpdateCancelButton.setProperties({disabled:!this.parent.allowDeferLayoutUpdate})):this.parent.allowDeferLayoutUpdate?(this.deferUpdateApplyButton.element.style.display="",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("cancel")}),this.deferUpdateCancelButton.isPrimary=!1):(this.deferUpdateApplyButton.element.style.display="none",this.deferUpdateCancelButton.setProperties({content:this.parent.localeObj.getConstant("close")}),this.deferUpdateCancelButton.isPrimary=!0);this.onCloseFieldList(null,!0)},t.prototype.applyButtonClick=function(){"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!1);this.parent.isDeferUpdateApplied=!0;this.parent.updateDataSource(!1);var t=this.parent;t.axisFieldModule.render();t.clonedDataSource=n.extend({},t.dataSourceSettings,null,!0);"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData));t.clonedFieldList=r.getClonedFieldList(t.pivotFieldList)},t.prototype.onCloseFieldList=function(n,t){var i,u,e,f;if((this.parent.allowDeferLayoutUpdate||t)&&(!this.parent.isPopupView||this.parent.pivotGridModule&&""!==this.parent.pivotGridModule.actionObj.actionName||""!==this.parent.actionObj.actionName)){if(this.parent.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0),"olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList=r.getClonedFieldList(this.parent.clonedFieldList),this.parent.olapEngineModule.fieldListData=r.cloneOlapFieldSettings(this.parent.clonedFieldListData),this.parent.isPopupView)this.parent.isPopupView&&this.parent.clonedFieldListData&&Object.keys(this.parent.clonedFieldListData).length>0&&(this.parent.olapEngineModule.fieldListData=this.parent.clonedFieldListData);else for(i=0,u=Object.keys(this.parent.clonedFieldList);i<u.length;i++)e=u[i],f=this.parent.clonedFieldList[e],this.parent.olapEngineModule.updateFieldlistData(f.id,f.isSelected);else this.parent.engineModule.fieldList=r.getClonedFieldList(this.parent.clonedFieldList);this.parent.updateDataSource(!1,!0)}!this.parent.allowDeferLayoutUpdate&&t&&(this.parent.pivotChange=!1);this.parent.allowDeferLayoutUpdate&&this.parent.isPopupView&&this.parent.pivotGridModule&&!this.parent.isAdaptive&&(this.parent.pivotGridModule.actionObj.actionName="",this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.clonedDataSource.properties},!0));"Popup"!==this.parent.renderMode||t?this.parent.actionObj.actionName="Action dropped":(this.parent.dialogRenderer.fieldListDialog.hide(),this.parent.actionObj.actionName="Field list closed");this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()},t.prototype.renderFieldListDialog=function(t){var s=n.createElement("div",{className:rt+" "+e+" e-select-table",attrs:{tabindex:"0",title:this.parent.localeObj.getConstant("fieldList"),"aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldList"),role:"button"}}),i,u,r,f;(this.parent.element.appendChild(s),this.parent.isAdaptive)?(i='<div class=e-title-mobile-header><span class="'+e+" "+rl+'"><\/span><div class=e-title-mobile-content>'+this.parent.localeObj.getConstant("fieldList")+"<\/div><\/div>",u=[{click:this.showFieldListDialog.bind(this),buttonModel:{cssClass:iu+" "+ue+" "+fe+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:e+" "+wu,isPrimary:!0}},{click:this.showCalculatedField.bind(this),buttonModel:{cssClass:pu+" "+ue+" "+fe+" "+o+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:e+" "+wu,enableRtl:this.parent.enableRtl,isPrimary:!0}}],this.fieldListDialog=new b.Dialog({animationSettings:{effect:this.parent.enableRtl?"SlideRight":"SlideLeft"},header:i,content:this.parentElement,isModal:!0,showCloseIcon:!1,visible:!1,allowDragging:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"100%",height:"100%",position:{X:"center",Y:"center"},buttons:u,target:document.body,cssClass:this.parent.cssClass,close:this.removeFieldListIcon.bind(this),open:this.dialogOpen.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(t),n.setStyleAttribute(n.select("#"+t.id+"_dialog-content",t),{padding:"0"}),r=t.querySelector(".e-footer-content"),n.addClass([r],so),n.removeClass([r.querySelector("."+pu)],ee),n.removeClass([r.querySelector("."+iu)],ee),this.fieldListDialog.element.querySelector("."+rl).onclick=this.parent.allowDeferLayoutUpdate?this.onDeferUpdateClick.bind(this):this.onCloseFieldList.bind(this)):(f=this.createDeferUpdateButtons().outerHTML,i="<div class="+tc+"><div class=e-title-content>"+this.parent.localeObj.getConstant("fieldList")+"<\/div><\/div>",this.fieldListDialog=new b.Dialog({animationSettings:{effect:"Zoom"},header:i,content:this.parentElement,isModal:!1,showCloseIcon:!1,visible:!1,allowDragging:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:this.parent.element.style.width,position:{X:"center",Y:this.parent.element.offsetTop},footerTemplate:f,closeOnEscape:!1,cssClass:this.parent.cssClass,target:n.isNullOrUndefined(this.parent.target)?document.body:"string"==typeof this.parent.target?document.querySelector(this.parent.target):this.parent.target,close:this.removeFieldListIcon.bind(this)}),this.fieldListDialog.isStringTemplate=!0,this.fieldListDialog.appendTo(t),this.renderDeferUpdateButtons(),n.setStyleAttribute(n.select("#"+t.id+"_title",t),{width:"100%"}),t.querySelector("."+tc).appendChild(this.createCalculatedButton()))},t.prototype.dialogOpen=function(){4===this.lastTabIndex?(this.adaptiveElement.items[this.lastTabIndex].content="",this.adaptiveElement.dataBind(),this.parent.notify(tr,{})):this.adaptiveElement.refresh()},t.prototype.updateDataSource=function(n){for(var r,u,f=["filters","columns","rows","values"],t=0,i=n;t<i.length;t++)r=i[t],u=f[this.adaptiveElement.selectedItem],this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.dataSourceUpdate.updateDataSource(r,u,-1);this.parent.axisFieldModule.render();this.parent.allowDeferLayoutUpdate?this.parent.triggerPopulateEvent():this.parent.updateDataSource(!0)},t.prototype.onDeferUpdateClick=function(){this.parent.updateDataSource();this.parent.dialogRenderer.fieldListDialog.hide()},t.prototype.renderAdaptiveLayout=function(t){var r=n.createElement("div",{className:so}),i;t.appendChild(this.parentElement);i=[{header:{text:this.parent.localeObj.getConstant("filters")},content:this.createAxisTable("filters")},{header:{text:this.parent.localeObj.getConstant("columns")},content:this.createAxisTable("columns")},{header:{text:this.parent.localeObj.getConstant("rows")},content:this.createAxisTable("rows")},{header:{text:this.parent.localeObj.getConstant("values")},content:this.createAxisTable("values")},{header:{text:this.parent.localeObj.getConstant("createCalculatedField")},content:"Calculated Field Related UI"}];this.parent.allowCalculatedField||i.pop();this.adaptiveElement=new st.Tab({heightAdjustMode:"Auto",items:i,height:"100%",enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,selected:this.tabSelect.bind(this),cssClass:this.parent.cssClass});"Fixed"===this.parent.renderMode?(r.appendChild(this.createAddButton()),n.addClass([t],oo),this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement),this.parentElement.appendChild(r)):(this.adaptiveElement.isStringTemplate=!0,this.adaptiveElement.appendTo(this.parentElement))},t.prototype.tabSelect=function(t){var i=n.closest(this.parentElement,"."+vh);this.lastTabIndex=t.selectedIndex;i&&i.querySelector("."+iu)&&(4!==t.selectedIndex?(n.addClass([i.querySelector("."+pu)],o),n.removeClass([i.querySelector("."+iu)],o)):(n.removeClass([i.querySelector("."+pu)],o),n.addClass([i.querySelector("."+iu)],o)));4===t.selectedIndex?(this.adaptiveElement.items[4].content="",this.adaptiveElement.dataBind(),this.parent.notify(tr,{})):this.parent.axisFieldModule.render()},t.prototype.createCalculatedButton=function(){var t=n.createElement("button",{id:this.parent.element.id+"_CalculatedField",attrs:{type:"button",tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("CalculatedField")}}),i=new ht.Button({cssClass:"e-calculated-field "+o+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("CalculatedField"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return i.isStringTemplate=!0,i.appendTo(t),this.parent.calculatedFieldModule&&n.removeClass([t],o),i.element.onclick=this.showCalculatedField.bind(this),t},t.prototype.createAddButton=function(){var t=n.createElement("div",{className:so+"-content"}),u=n.createElement("div",{}),f=n.createElement("div",{}),i=new ht.Button({cssClass:pu+" "+ue+" "+fe+" "+o+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:e+" "+wu,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),r=new ht.Button({cssClass:iu+" "+ue+" "+fe+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:e+" "+wu,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});return r.isStringTemplate=!0,r.appendTo(u),i.isStringTemplate=!0,i.appendTo(f),t.appendChild(u),t.appendChild(f),i.element.onclick=this.showCalculatedField.bind(this),r.element.onclick=this.showFieldListDialog.bind(this),t},t.prototype.createAxisTable=function(t){var i=n.createElement("div",{className:et+"-"+t}),u=n.createElement("div",{className:rr+" e-"+t}),r=n.createElement("span",{className:kf});return r.innerText=this.parent.localeObj.getConstant("addPrompt"),i.appendChild(u),i.appendChild(r),i},t.prototype.showCalculatedField=function(t){try{if(!this.parent.isAdaptive){if(this.parent.actionObj.actionName=io,this.parent.actionBeginMethod())return;this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),n.addClass([this.parent.element.querySelector("."+rt)],sr))}this.parent.notify(tr,{})}catch(t){this.parent.actionFailureMethod(t)}},t.prototype.showFieldListDialog=function(){var n=this.adaptiveElement.selectedItem;this.parent.treeViewModule.render(n)},t.prototype.onShowFieldList=function(){if(this.parent.actionObj.actionName="Open field list",!this.parent.actionBeginMethod()){this.parent.actionObj.actionName="";try{this.parent.allowDeferLayoutUpdate&&(this.parent.isAdaptive&&this.parent.axisFieldModule.render(),this.parent.clonedDataSource=n.extend({},this.parent.dataSourceSettings,null,!0),"olap"===this.parent.dataType&&(this.parent.clonedFieldListData=r.cloneOlapFieldSettings(this.parent.olapEngineModule.fieldListData)),this.parent.clonedFieldList=r.getClonedFieldList(this.parent.pivotFieldList));n.addClass([this.parent.element.querySelector("."+rt)],sr);this.parent.dialogRenderer.fieldListDialog.show();this.parent.dialogRenderer.fieldListDialog.element.style.top=parseInt(this.parent.dialogRenderer.fieldListDialog.element.style.top,10)<0?"0px":this.parent.dialogRenderer.fieldListDialog.element.style.top}catch(t){this.parent.actionFailureMethod(t)}}},t.prototype.removeFieldListIcon=function(){this.parent.isAdaptive&&this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&this.adaptiveElement&&4===this.adaptiveElement.selectedItem&&(n.select("#"+this.parent.element.id+"droppable",this.adaptiveElement.element)?this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!1):this.parent.notify(tr,{edit:!1}));document.getElementById(this.parent.element.id+"calculateddialog")||n.removeClass([this.parent.element.querySelector("."+rt)],sr)},t.prototype.keyPress=function(n){if(13===n.keyCode&&n.target)return n.target.click(),void n.preventDefault()},t.prototype.wireDialogEvent=function(t){n.EventHandler.add(t,"keydown",this.keyPress,this);n.EventHandler.add(t,"click",this.onShowFieldList,this)},t.prototype.unWireDialogEvent=function(t){n.EventHandler.remove(t,"keydown",this.keyPress);n.EventHandler.remove(t,"click",this.onShowFieldList)},t.prototype.destroy=function(){"Popup"===this.parent.renderMode&&this.unWireDialogEvent(this.parent.element.querySelector("."+rt));this.deferUpdateCheckBox&&!this.deferUpdateCheckBox.isDestroyed&&(this.deferUpdateCheckBox.destroy(),this.deferUpdateCheckBox=null);this.deferUpdateApplyButton&&!this.deferUpdateApplyButton.isDestroyed&&(this.deferUpdateApplyButton.destroy(),this.deferUpdateApplyButton=null);this.deferUpdateCancelButton&&!this.deferUpdateCancelButton.isDestroyed&&(this.deferUpdateCancelButton.destroy(),this.deferUpdateCancelButton=null);"Popup"===this.parent.renderMode&&(this.fieldListDialog&&!this.fieldListDialog.isDestroyed&&(this.fieldListDialog.destroy(),this.fieldListDialog=null),document.getElementById(this.parent.element.id+"_Container")&&n.remove(document.getElementById(this.parent.element.id+"_Container")))},t}(),fp=function(){function t(n){this.selectedNodes=[];this.isSearching=!1;this.parentIDs=[];this.parent=n;this.addEventListener()}return t.prototype.render=function(t){var i,u,f,s,h,c,r,a,l;(this.parentElement=this.parent.dialogRenderer.parentElement,this.fieldListSort=this.parent.pivotGridModule?this.parent.pivotGridModule.defaultFieldListOrder:this.parent.defaultFieldListOrder,this.fieldListSort="Ascending"===this.fieldListSort?"Ascend":"Descending"===this.fieldListSort?"Descend":"None",this.parent.isAdaptive)?this.renderTreeDialog(t):(i=n.createElement("div",{className:"e-field-table "+("olap"===this.parent.dataType?"e-olap-field-table":"")}),u=n.createElement("div",{className:"e-field-header"}),u.innerText=this.parent.localeObj.getConstant("allFields"),f=n.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:"e-field-list-search"}),s=n.createElement("input",{attrs:{type:"text"}}),f.appendChild(s),this.fieldSearch=new it.TextBox({placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:"e-field-list-search-input"+(this.parent.cssClass?" "+this.parent.cssClass:""),input:this.textChange.bind(this),showClearButton:!0}),this.fieldSearch.isStringTemplate=!0,this.fieldSearch.appendTo(s),this.fieldSearch.addIcon("append","e-field-list-search-icon "+e),h=n.createElement("div",{className:du+" "+o}),h.innerText=this.parent.localeObj.getConstant("noMatches"),c=n.createElement("div",{className:yh+" "+pc}),this.treeViewElement=n.createElement("div",{id:this.parent.element.id+"_TreeView",className:et+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")}),r=n.createElement("div",{className:"e-field-header-container"}),(r.appendChild(u),i.appendChild(r),this.updateSortElements(r),this.parent.enableFieldSearching&&(i.appendChild(f),i.appendChild(h)),c.appendChild(this.treeViewElement),i.appendChild(c),this.parentElement.appendChild(i),"Fixed"===this.parent.renderMode)&&(a=n.createElement("div",{className:"e-center-div"}),l=n.createElement("div",{className:"e-center-title"}),l.innerText=this.parent.localeObj.getConstant("centerHeader"),this.parentElement.appendChild(a),this.parentElement.appendChild(l)),this.renderTreeView())},t.prototype.updateSortElements=function(t){for(var i,r,f={None:"sortNone",Ascend:"sortAscending",Descend:"sortDescending"},u=0,o=Object.keys(f);u<o.length;u++)i=o[u],r=n.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":"Sort "+i,"data-sort":i,title:this.parent.localeObj.getConstant(f[i]),role:"button"},className:e+" e-sort-"+i.toLowerCase()+" "+(this.fieldListSort===i?"e-selected":"")}),t.appendChild(r),this.unWireFieldListEvent(r),this.wireFieldListEvent(r)},t.prototype.renderTreeView=function(){this.fieldTable=new st.TreeView({fields:{dataSource:this.getTreeData(),id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},nodeChecked:this.nodeStateChange.bind(this),cssClass:"e-field-list-tree"+(this.parent.cssClass?" "+this.parent.cssClass:""),showCheckBox:!0,allowDragAndDrop:!0,sortOrder:"None",autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeDragStart:this.dragStart.bind(this),nodeDragStop:this.dragStop.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(t){n.removeClass([t.node],"e-active");t.cancel=!0}});this.treeViewElement.innerHTML="";this.fieldTable.isStringTemplate=!0;this.fieldTable.appendTo(this.treeViewElement);var t="Fixed"===this.parent.renderMode?this.parent.element:this.parentElement;n.isNullOrUndefined(t.querySelector("."+et))||(t.querySelector("."+et).ej2_instances[0].dragObj.enableAutoScroll=!1)},t.prototype.updateNodeIcon=function(t){if("olap"===this.parent.dataType)if(t.node&&t.node.querySelector(".e-list-icon")&&t.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1){var i=t.node.querySelector(".e-list-icon");n.removeClass([i],"e-folderCDB-icon");n.addClass([i],"e-folderCDB-open-icon")}else t.node&&t.node.querySelector(".e-list-icon")&&t.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1&&(i=t.node.querySelector(".e-list-icon"),n.removeClass([i],"e-folderCDB-open-icon"),n.addClass([i],"e-folderCDB-icon"))},t.prototype.updateTreeNode=function(t){var f=!1,s,a,h,v,i,c,l,p,w;if("olap"===this.parent.dataType?f=this.updateOlapTreeNode(t):t.nodeData.hasChildren?(f=!1,t.node.querySelector(".e-checkbox-wrapper").style.display="none",n.addClass([t.node],bh)):f=!0,n.isNullOrUndefined(t.nodeData.pid)||n.addClass([t.node],kh),s=t.node.querySelector("."+lr),t.node.querySelector(".e-list-icon")&&s&&(a=t.node.querySelector(".e-list-icon"),s.insertBefore(a,t.node.querySelector(".e-list-text"))),f&&!this.parent.isAdaptive&&(h=r.getFieldInfo(t.nodeData.id,this.parent),f=!1,v=n.createElement("span",{attrs:{tabindex:"-1",title:h.fieldItem?h.fieldItem.allowDragAndDrop?this.parent.localeObj.getConstant("drag"):"":this.parent.localeObj.getConstant("drag"),"aria-disabled":"false"},className:e+" "+lu+" "+(h.fieldItem?h.fieldItem.allowDragAndDrop?"":te:"")}),t.node.querySelector(".e-checkbox-wrapper")&&!t.node.querySelector(".cls.DRAG_CLASS")&&s&&s.insertBefore(v,t.node.querySelector(".e-checkbox-wrapper"))),t.node.querySelector("."+au)&&n.addClass([t.node.querySelector("."+dt)],ar),this.parent.enableFieldSearching&&this.isSearching)if(i=t.node,"olap"===this.parent.dataType){for(var y=i.getAttribute("data-uid"),b=this.parent.pivotCommon.eventBase.searchListItem,u=0;u<this.parentIDs.length;u++)for(y===this.parentIDs[u]&&n.addClass([i],o),c=0,l=b;c<l.length;c++)if(p=l[c],w=this.parent.pivotCommon.eventBase.getParentIDs(this.fieldTable,p.getAttribute("data-uid"),[]),r.inArray(y,w)>-1){n.removeClass([i],o);break}}else for(u=0;u<this.nonSearchList.length;u++){if(i.textContent===this.nonSearchList[u].textContent){n.addClass([i],o);break}if(i.innerText===this.nonSearchList[u].textContent){n.addClass([i],o);break}}},t.prototype.updateOlapTreeNode=function(n){var t=!1;return"olap"===this.parent.dataType?(n.node&&n.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon,.e-folderCDB-open-icon,.e-dimensionCDB-icon,.e-kpiCDB-icon")&&(n.node.querySelector(".e-checkbox-wrapper").style.display="none"),n.node&&n.node.querySelector(".e-list-icon")&&n.node.querySelector(".e-list-icon").className.indexOf("e-level-members")>-1&&(this.parent.isAdaptive?n.node.querySelector(".e-checkbox-wrapper").style.display="none":n.node.querySelector(".e-checkbox-wrapper").style.visibility="hidden"),n.node&&(n.node.querySelector(".e-hierarchyCDB-icon,.e-attributeCDB-icon,.e-namedSetCDB-icon")||n.node.querySelector(".e-measure-icon,.e-kpiGoal-icon,.e-kpiStatus-icon,.e-kpiTrend-icon,.e-kpiValue-icon")||n.node.querySelector(".e-calc-measure-icon,.e-calc-dimension-icon"))&&(n.node.querySelector(".e-measure-icon")?(n.node.querySelector(".e-list-icon").style.display="none",t=!0):t=!0)):t=!0,t},t.prototype.renderTreeDialog=function(t){var i=n.createElement("div",{id:this.parent.element.id+"_FieldListTreeView",className:"e-adaptive-field-list-dialog "+("olap"===this.parent.dataType?"e-olap-editor-dialog":"")});this.parentElement.appendChild(i);this.fieldDialog=new b.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,header:this.parent.localeObj.getConstant("adaptiveFieldHeader"),content:this.createTreeView(this.getTreeData(t)),isModal:!0,visible:!0,showCloseIcon:!1,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,width:"320px",height:"350px",position:{X:"center",Y:"center"},buttons:[{click:this.closeTreeDialog.bind(this),buttonModel:{cssClass:br+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}},{click:this.onFieldAdd.bind(this),buttonModel:{cssClass:lt+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("add"),isPrimary:!0}}],closeOnEscape:!1,cssClass:this.parent.cssClass,target:this.parentElement.parentElement,close:this.dialogClose.bind(this)});this.fieldDialog.isStringTemplate=!0;this.fieldDialog.appendTo(i)},t.prototype.dialogClose=function(){document.getElementById(this.parent.element.id+"_FieldListTreeView")&&n.remove(document.getElementById(this.parent.element.id+"_FieldListTreeView"))},t.prototype.createTreeView=function(t){var i=n.createElement("div",{id:this.parent.element.id+"EditorDiv",className:ie}),e=n.createElement("div",{id:this.parent.element.id+"_SearchDiv",attrs:{tabindex:"-1"},className:cc}),s=n.createElement("input",{attrs:{type:"text"}}),r,u,f;return e.appendChild(s),r=n.createElement("div",{className:yh}),u=n.createElement("div",{className:wr+" "+("olap"===this.parent.dataType?"e-olap-field-list-tree":"")}),i.appendChild(e),this.editorSearch=new it.MaskedTextBox({showClearButton:!0,placeholder:this.parent.localeObj.getConstant("search"),enableRtl:this.parent.enableRtl,locale:this.parent.locale,cssClass:lc+(this.parent.cssClass?" "+this.parent.cssClass:""),change:this.textChange.bind(this)}),this.editorSearch.isStringTemplate=!0,this.editorSearch.appendTo(s),f=n.createElement("div",{className:du+" "+o}),f.innerText=this.parent.localeObj.getConstant("noMatches"),i.appendChild(f),r.appendChild(u),i.appendChild(r),this.fieldTable=new st.TreeView({fields:{dataSource:t,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,loadOnDemand:"olap"!==this.parent.dataType,sortOrder:"olap"===this.parent.dataType?"None":"Ascending",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass,nodeChecked:this.addNode.bind(this),drawNode:this.updateTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(t){n.removeClass([t.node],"e-active");t.cancel=!0}}),this.fieldTable.isStringTemplate=!0,this.fieldTable.appendTo(u),i},t.prototype.textChange=function(t){var f,i,r,e,u,s;if(this.parent.pivotCommon.eventBase.searchTreeNodes(t,this.fieldTable,!0),this.parent.isAdaptive?f=this.fieldDialog.element.querySelector("."+du):(f=this.parentElement.querySelector("."+du),i=this.parentElement.querySelector("."+pc)),r=[].slice.call(this.fieldTable.element.querySelectorAll("li")),e=[].slice.call(this.fieldTable.element.querySelectorAll("li."+o)),r.length===e.length?(n.removeClass([f],o),this.parent.isAdaptive||(n.addClass([i],o),n.removeClass([i],ph))):(n.addClass([f],o),this.parent.isAdaptive||(n.removeClass([i],o),n.addClass([i],ph))),this.isSearching=e.length>0,this.nonSearchList=e,"olap"===this.parent.dataType)for(this.parentIDs=[],u=0;u<r.length;u++)r[u].classList.contains("e-level-1")&&(s=r[u].getAttribute("data-uid"),this.parentIDs.push(s))},t.prototype.dragStart=function(t){var i=this,u,f;t.event.target.classList.contains(lu)&&!t.event.target.classList.contains(te)?(u=r.getFieldInfo(t.draggedNode.getAttribute("data-uid"),this.parent),f={fieldName:u.fieldName,fieldItem:u.fieldItem,axis:u.axis,dataSourceSettings:this.parent.dataSourceSettings,cancel:!1},(this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ws,f,function(r){var f,s,u,e,h,o;if(r.cancel)i.parent.isDragging=!1,t.cancel=!0;else{if(i.parent.isDragging=!0,n.addClass([t.draggedNode.querySelector("."+dt)],tu),f="olap"===i.parent.dataType?i.parent.olapEngineModule.fieldList[t.draggedNode.getAttribute("data-uid")]:i.parent.engineModule.fieldList[t.draggedNode.getAttribute("data-uid")],s=[kr,dr,gr],f&&"CalculatedField"===f.aggregateType)for(u=0,e=s;u<e.length;u++)h=e[u],n.addClass([i.parentElement.querySelector("."+h)],nu);o=t.clonedNode;o&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode)&&(o.style.zIndex=(i.parent.dialogRenderer.fieldListDialog.zIndex+1).toString())}})):(this.parent.isDragging=!1,t.cancel=!0)},t.prototype.dragStop=function(t){var i,u,f,r,e;for(t.cancel=!0,this.parent.isDragging=!1,i=0,u=[kr,dr,gr];i<u.length;i++)f=u[i],n.removeClass([this.parentElement.querySelector("."+f)],nu);n.removeClass([t.draggedNode.querySelector("."+dt)],tu);this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();r=t.draggedNodeData.id.toString();this.isNodeDropped(t,r)&&(e=this.parent.pivotFieldList[r],this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(t,r)&&(this.parent.allowDeferLayoutUpdate?(e.isSelected=!0,this.updateDataSource()):this.parent.updateDataSource(),this.parent.axisFieldModule.render()))},t.prototype.isNodeDropped=function(t,i){var s=!0,l,a;if("true"===t.draggedNodeData.isChecked){var f=this.getButton(i),h=n.closest(f,"."+si),y=n.closest(t.target,"."+si);if(f&&h===y){for(var u=[].slice.call(h.querySelectorAll("."+v)),c=n.closest(t.target,"."+ur),e=void 0,o=-1,r=0,p=u.length;r<p;r++)(u[r].id===f.id&&(e=r),c)&&(l=c.querySelector("."+v),u[r].id===l.id&&(o=r));(e===o||e===u.length-1&&-1===o)&&(a=document.getElementById(this.parent.element.id+"_Container"),n.removeClass([].slice.call(a.querySelectorAll("."+ot)),yt),s=!1)}}return s},t.prototype.getButton=function(n){for(var r,u=document.getElementById(this.parent.element.id+"_Container"),i=[].slice.call(u.querySelectorAll("."+v)),t=0,f=i.length;t<f;t++)if(i[t].getAttribute("data-uid")===n){r=i[t];break}return r},t.prototype.nodeStateChange=function(t){var i=this,o,h,u,l,a;if(t.isInteracted&&(o=n.closest(t.node,"."+lr),!n.isNullOrUndefined(o))){h=n.closest(o,"li");u=h.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();var e=this.parent.pivotFieldList[u],f=r.getFieldInfo(u,this.parent),c=this.parent.isPopupView?this.parent.pivotGridModule:this.parent,s=o.closest("."+bh);"check"===t.action?(l={fieldName:u,dropField:f.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:"number"===e.type||"CalculatedField"===e.type&&e.formula&&e.formula.indexOf("Measure")>-1&&"olap"===this.parent.dataType?"values":"rows",dropPosition:f.position,draggedAxis:"fieldlist",cancel:!1},c.trigger(be,l,function(r){if(r.cancel)i.updateCheckState(e,t.action);else{n.addClass([o.querySelector("."+dt)],ar);s&&n.addClass([s.querySelector("."+dt)],ar);i.updateSelectedNodes(h,t.action);var c=i.parent.pivotCommon.dataSourceUpdate.getNewField(u,f.fieldItem);i.updateReportSettings(c,r);i.updateNodeStateChange(u,t,e)}})):(a={cancel:!1,fieldName:u,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:f.fieldItem,axis:f.axis},c.trigger(de,a,function(r){r.cancel?i.updateCheckState(e,t.action):(n.removeClass([o.querySelector("."+dt)],ar),s&&n.isNullOrUndefined(s.querySelector("."+kh+" ."+au))&&n.removeClass([s.querySelector("."+dt)],ar),i.updateSelectedNodes(h,t.action),i.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(u),"pivot"===i.parent.dataType&&i.parent.showValuesButton&&i.parent.dataSourceSettings.values.length>1&&f&&f.position<i.parent.dataSourceSettings.valueIndex&&("row"===i.parent.dataSourceSettings.valueAxis&&"rows"===f.axis||"column"===i.parent.dataSourceSettings.valueAxis&&"columns"===f.axis)&&c.setProperties({dataSourceSettings:{valueIndex:i.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===i.parent.dataType&&0===i.parent.dataSourceSettings.values.length&&i.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]"),i.updateNodeStateChange(u,t,e))}))}},t.prototype.updateReportSettings=function(t,i){var r=i.dropPosition,u=i.dropAxis,f;"pivot"===this.parent.dataType&&this.parent.showValuesButton&&this.parent.dataSourceSettings.values.length>1&&(f="row"===this.parent.dataSourceSettings.valueAxis&&"rows"===u?this.parent.dataSourceSettings.rows:"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===u?this.parent.dataSourceSettings.columns:void 0,n.isNullOrUndefined(f)||(-1===r&&-1===this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:f.length}},!0):r>-1&&r<=this.parent.dataSourceSettings.valueIndex?this.parent.setProperties({dataSourceSettings:{valueIndex:this.parent.dataSourceSettings.valueIndex+1}},!0):this.parent.dataSourceSettings.valueIndex>-1&&r>this.parent.dataSourceSettings.valueIndex&&(r-=1)));switch(u){case"filters":-1!==r?this.parent.dataSourceSettings.filters.splice(r,0,t):this.parent.dataSourceSettings.filters.push(t);break;case"rows":-1!==r?this.parent.dataSourceSettings.rows.splice(r,0,t):this.parent.dataSourceSettings.rows.push(t);break;case"columns":-1!==r?this.parent.dataSourceSettings.columns.splice(r,0,t):this.parent.dataSourceSettings.columns.push(t);break;case"values":(-1!==r?this.parent.dataSourceSettings.values.splice(r,0,t):this.parent.dataSourceSettings.values.push(t),"olap"!==this.parent.dataType||!this.parent.olapEngineModule||this.parent.olapEngineModule.isMeasureAvail||this.parent.dataSourceSettings.values.length>1)||("row"===this.parent.dataSourceSettings.valueAxis?this.parent.dataSourceSettings.rows:this.parent.dataSourceSettings.columns).push({name:"[Measures]",caption:"Measures",baseField:void 0,baseItem:void 0})}},t.prototype.updateCheckState=function(n,t){for(var r=this.fieldTable.element.querySelectorAll(".e-checkbox-wrapper"),u=this.fieldTable.element.querySelectorAll(".e-list-text"),i=0;i<r.length;i++)n.caption===u[i].textContent&&("check"===t?this.fieldTable.uncheckAll([n.id]):this.fieldTable.checkAll([n.id]))},t.prototype.updateNodeStateChange=function(t,i,r){var u,f;this.parent.allowDeferLayoutUpdate?(r.isSelected="check"===i.action,"olap"===this.parent.dataType&&this.parent.olapEngineModule.updateFieldlistData(t,"check"===i.action),this.updateDataSource()):this.parent.updateDataSource(!0);u=this.treeViewElement.querySelector('[data-uid="'+t+'"]');u.focus();n.removeClass([u],"e-hover");f=this.parent;setTimeout(function(){f.axisFieldModule.render()})},t.prototype.updateSelectedNodes=function(t,i){var r,u,f;if(t&&t.querySelector("ul"))for(r=0,u=[].slice.call(t.querySelectorAll("li"));r<u.length;r++)f=u[r],"check"===i?n.addClass([f.querySelector("."+dt)],ar):n.removeClass([f.querySelector("."+dt)],ar)},t.prototype.updateDataSource=function(){this.parent.isPopupView?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0),this.parent.pivotGridModule.notify(oi,this)):this.parent.triggerPopulateEvent()},t.prototype.addNode=function(n){var t=this,e,o;if(n.isInteracted){var i=this.parent.pivotFieldList[n.data[0].id.toString()],u=r.getFieldInfo(i.id.toString(),this.parent),f=this.parent.isPopupView?this.parent.pivotGridModule:this.parent;"check"===n.action?(e={fieldName:u.fieldName,dropField:u.fieldItem,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),dropAxis:["filters","columns","rows","values"][this.parent.dialogRenderer.adaptiveElement.selectedItem],draggedAxis:"fieldlist",cancel:!1},f.trigger(be,e,function(r){r.cancel?t.updateCheckState(i,n.action):t.selectedNodes.push(i.id.toString())})):(o={cancel:!1,fieldName:u.fieldName,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:u.fieldItem,axis:u.axis},f.trigger(de,o,function(r){if(r.cancel)t.updateCheckState(i,n.action);else for(var u=t.selectedNodes.length;u--;)if(t.selectedNodes[u]===i.id.toString()){t.selectedNodes.splice(u,1);break}}))}},t.prototype.refreshTreeView=function(){if(this.fieldTable){var n=this.getUpdatedData();this.fieldTable.fields={dataSource:n,id:"id",text:"caption",isChecked:"isSelected",parentID:"pid",iconCss:"spriteCssClass"};this.fieldTable.dataBind()}},t.prototype.getUpdatedData=function(){var n=this.getTreeData(),t=this.fieldTable.expandedNodes;return this.updateExpandedNodes(n,t),this.applySorting(n,this.fieldListSort)},t.prototype.getTreeData=function(t){var s=[],f,r,u,p,l,e,a,o,v,w;if("olap"===this.parent.dataType)s=this.getOlapTreeData(t);else{for(var h=this.parent.pivotFieldList?Object.keys(this.parent.pivotFieldList):[],i={},c=0,y=h;c<y.length;c++)f=y[c],r=this.parent.pivotFieldList[f],(i[f]={id:r.id,pid:r.pid,caption:r.caption,isSelected:r.isSelected},n.isNullOrUndefined(r.pid)||i[f].hasChildren)||(u=r.pid+"_group_name",i[f].pid=u,i[u]={id:u,caption:r.pid,isSelected:i[u]&&i[u].isSelected?i[u].isSelected:r.isSelected,hasChildren:!0});if(this.parent.isAdaptive){for(p=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][t],l=h.length;l--;)i[h[l]].isSelected=!1;for(e=0,a=p;e<a.length;e++)i[a[e].name].isSelected=!0}for(o=0,v=Object.keys(i);o<v.length;o++)w=i[r=v[o]],s.push(w)}return s},t.prototype.getOlapTreeData=function(t){var f=[],a=this.parent.olapEngineModule.fieldListData?this.parent.olapEngineModule.fieldListData:[],h,e,i,u,o,c,v,s,l,y;if(this.parent.isAdaptive)for(h=[this.parent.dataSourceSettings.filters,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.values][t],e=0;e<a.length;){if(i=a[e],u=void 0,3===t){if("[measures]"!==i.id.toLowerCase()&&(0===i.id.toLowerCase().indexOf("[measures]")||i.spriteCssClass&&-1!==i.spriteCssClass.indexOf("e-measureCDB"))||"[calculated members].[_0]"===i.id.toLowerCase()||i.spriteCssClass&&-1!==i.spriteCssClass.indexOf("e-calc-measure-icon")){for((u={id:i.id,caption:i.caption,hasChildren:i.hasChildren,type:i.type,aggregateType:i.aggregateType,isSelected:i.isSelected,pid:i.pid,spriteCssClass:i.spriteCssClass}).isSelected=!1,u.spriteCssClass&&-1!==u.spriteCssClass.indexOf("e-measureCDB")&&(u.spriteCssClass=u.spriteCssClass.replace("e-folderCDB-icon","e-measureGroupCDB-icon"),u.pid=void 0),o=0,c=h;o<c.length;o++)if(v=c[o],u.id===v.name){u.isSelected=!0;break}f.push(u)}}else if(!(0===i.id.toLowerCase().indexOf("[measures]")||i.spriteCssClass&&-1!==i.spriteCssClass.indexOf("e-measureCDB")||i.spriteCssClass&&-1!==i.spriteCssClass.indexOf("e-calc-measure-icon"))){for((u={id:i.id,caption:i.caption,hasChildren:i.hasChildren,type:i.type,aggregateType:i.aggregateType,isSelected:i.isSelected,pid:i.pid,spriteCssClass:i.spriteCssClass}).isSelected=!1,s=0,l=h;s<l.length;s++)if(y=l[s],u.id===y.name){u.isSelected=!0;break}f.push(u)}e++}else f=n.isNullOrUndefined(this.parent.olapEngineModule.fieldListData)?[]:r.getClonedData(this.parent.olapEngineModule.fieldListData);return f},t.prototype.updateExpandedNodes=function(n,t){var i;if(t.length>0)for(var u=0,r=0,f=n;r<f.length;r++)if(i=f[r],t.indexOf(i.id)>-1&&(u++,i.expanded=!0,i.spriteCssClass=i.spriteCssClass&&i.spriteCssClass.toString().indexOf("e-folderCDB-icon")>-1?i.spriteCssClass.toString().replace("e-folderCDB-icon","e-folderCDB-open-icon"):i.spriteCssClass,u===t.length))break},t.prototype.updateSorting=function(t){var i=t.target,r=i.getAttribute("data-sort");if(this.parent.actionObj.actionName=uh,!this.parent.actionBeginMethod()){try{if(-1===i.className.indexOf("e-selected")){switch(r){case"None":this.fieldListSort="None";n.addClass([i],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Ascend":this.fieldListSort="Ascend";n.addClass([i],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-descend")],"e-selected");break;case"Descend":this.fieldListSort="Descend";n.addClass([i],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-ascend")],"e-selected");n.removeClass([this.parentElement.querySelector(".e-sort-none")],"e-selected")}this.refreshTreeView()}}catch(t){this.parent.actionFailureMethod(t)}this.parent.actionObj.actionName=this.parent.getActionCompleteName();this.parent.actionObj.actionName&&this.parent.actionCompleteMethod()}},t.prototype.applySorting=function(n,t){if(n.length>0)if("olap"===this.parent.dataType){var i=void 0,r=void 0;this.parent.dataSourceSettings.calculatedFieldSettings.length>0&&"[calculated members].[_0]"===n[0].id.toLowerCase()?(r=n[0],i=n[1],n.splice(0,2)):(i=n[0],n.splice(0,1));n="Ascend"===t?n.sort(function(n,t){return n.caption>t.caption?1:t.caption>n.caption?-1:0}):"Descend"===t?n.sort(function(n,t){return n.caption<t.caption?1:t.caption<n.caption?-1:0}):n;r?n.splice(0,0,r,i):n.splice(0,0,i)}else this.fieldTable.sortOrder="Ascend"===t?"Ascending":"Descend"===t?"Descending":"None";return n},t.prototype.onFieldAdd=function(){this.parent.dialogRenderer.updateDataSource(this.selectedNodes);this.closeTreeDialog()},t.prototype.closeTreeDialog=function(){this.selectedNodes=[];this.fieldDialog.hide()},t.prototype.keyPress=function(n){if(13===n.keyCode&&n.target)return n.target.click(),void n.preventDefault()},t.prototype.wireFieldListEvent=function(t){n.EventHandler.add(t,"keydown",this.keyPress,this);n.EventHandler.add(t,"click",this.updateSorting,this)},t.prototype.unWireFieldListEvent=function(t){n.EventHandler.remove(t,"keydown",this.keyPress);n.EventHandler.remove(t,"click",this.updateSorting)},t.prototype.addEventListener=function(){this.parent.on(nr,this.refreshTreeView,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(nr,this.refreshTreeView)},t.prototype.destroy=function(){this.removeEventListener();this.fieldTable&&!this.fieldTable.isDestroyed&&(this.fieldTable.destroy(),this.fieldTable=null);this.fieldDialog&&!this.fieldDialog.isDestroyed&&(this.fieldDialog.destroy(),this.fieldDialog=null);this.editorSearch&&!this.editorSearch.isDestroyed&&(this.editorSearch.destroy(),this.editorSearch=null);this.fieldSearch&&!this.fieldSearch.isDestroyed&&(this.fieldSearch.destroy(),this.fieldSearch=null)},t}(),ep=function(){function t(n){this.parent=n}return t.prototype.render=function(){if(!this.parent.isAdaptive){var t=n.createElement("div",{className:"e-axis-table "+("olap"===this.parent.dataType?"e-olap-axis-table":"")});this.leftAxisPanel=n.createElement("div",{className:dh});this.rightAxisPanel=n.createElement("div",{className:gh});this.parent.dialogRenderer.parentElement.appendChild(t);t.appendChild(this.leftAxisPanel);t.appendChild(this.rightAxisPanel);this.axisTable=t;this.renderAxisTable()}this.parent.axisFieldModule.render()},t.prototype.renderAxisTable=function(){for(var s,u,e,i=["filters","rows","columns","values"],t=0,h=i.length;t<h;t++){var r=n.createElement("div",{className:et+"-"+i[t]}),f=n.createElement("div",{className:vr+"-container"}),o=n.createElement("div",{className:"e-axis-header",attrs:{title:this.parent.localeObj.getConstant(i[t])}});o.innerText=this.parent.localeObj.getConstant(i[t]);f.appendChild(this.getIconupdate(i[t]));f.appendChild(o);u=n.createElement("div",{className:rr+" e-"+i[t]});s="rows"===i[t]?this.parent.localeObj.getConstant("dropRowPrompt"):"columns"===i[t]?this.parent.localeObj.getConstant("dropColPrompt"):"values"===i[t]?this.parent.localeObj.getConstant("dropValPrompt"):this.parent.localeObj.getConstant("dropFilterPrompt");e=n.createElement("span",{className:kf});e.innerText=s;new n.Droppable(u,{});r.appendChild(f);r.appendChild(u);r.appendChild(e);t<=1?this.leftAxisPanel.appendChild(r):this.rightAxisPanel.appendChild(r);this.unWireEvent(u);this.wireEvent(u)}},t.prototype.getIconupdate=function(t){var i=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:vr+"-icon-container"}),r=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:e+" "+vr+"-"+t});return i.appendChild(r),i},t.prototype.wireEvent=function(t){n.EventHandler.add(t,"mouseover",this.updateDropIndicator,this);n.EventHandler.add(t,"mouseleave",this.updateDropIndicator,this)},t.prototype.unWireEvent=function(t){n.EventHandler.remove(t,"mouseover",this.updateDropIndicator);n.EventHandler.remove(t,"mouseleave",this.updateDropIndicator)},t.prototype.updateDropIndicator=function(t){var i=this.parent.dialogRenderer.parentElement,r;this.parent.isDragging&&t.target.classList.contains(rr)&&"mouseover"===t.type?(n.removeClass([].slice.call(i.querySelectorAll("."+ot)),yt),n.removeClass([].slice.call(i.querySelectorAll("."+ot+"-last")),yt),r=[].slice.call(t.target.querySelectorAll("."+ur)),r.length>0&&n.addClass([r[r.length-1].querySelector("."+ot+"-last")],yt)):this.parent.isDragging&&(t.target.classList.contains(si)||"mouseleave"!==t.type)||(n.removeClass([].slice.call(i.querySelectorAll("."+ot)),yt),n.removeClass([].slice.call(i.querySelectorAll("."+ot+"-last")),yt))},t}(),na=function(){function t(n){this.parent=n;this.menuOption=new sl(this.parent);this.parent.pivotButtonModule=this;this.addEventListener();this.parent instanceof sf&&(this.axisField=new ta(this.parent));this.isDestroyed=!1}return t.prototype.renderPivotButton=function(t){var vt,st,yt=this,i=n.extend([],t.field,null,!0),f=t.axis,l=-1,ki="pivot"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule.showValuesButton:this.parent.showValuesButton),b,pt,tt,ct,wt,u,ui,lt,bt,a,g,at,nt,kt,vi,d,ft,ri;if(("row"===this.parent.dataSourceSettings.valueAxis&&"rows"===t.axis||"column"===this.parent.dataSourceSettings.valueAxis&&"columns"===t.axis)&&ki&&this.parent.dataSourceSettings.values.length>1&&n.isNullOrUndefined(r.getFieldByName("[Measures]",i))&&(b=r.getFieldByName("[Measures]",this.parent.dataSourceSettings.fieldMapping),pt={name:"[Measures]",caption:this.parent.localeObj.getConstant("values"),axis:t.axis,showRemoveIcon:!b||!("showRemoveIcon"in b)||b.showRemoveIcon,allowDragAndDrop:!b||!("allowDragAndDrop"in b)||b.allowDragAndDrop},-1===this.parent.dataSourceSettings.valueIndex||this.parent.dataSourceSettings.valueIndex>i.length?(l=i.length,i.push(pt),this.parent.setProperties({dataSourceSettings:{valueIndex:-1}},!0)):(l=this.parent.dataSourceSettings.valueIndex,i.splice(l,0,pt))),this.parentElement="pivotview"===this.parent.getModuleName()?this.parent.element:document.getElementById(this.parent.element.id+"_Container"),"pivotfieldlist"===this.parent.getModuleName()){if(this.parentElement=document.getElementById(this.parent.element.id+"_Container"),!this.parentElement.querySelector("."+et+"-"+f))return;tt=this.parentElement.querySelector("."+et+"-"+f).querySelector("."+kf);0===i.length?n.removeClass([tt],o):n.addClass([tt],o);st=this.parentElement.querySelector("."+et+"-"+f).querySelector("."+rr)}else this.parentElement=this.parent.element,st=this.parentElement.querySelector(".e-group-"+f);if(st)if("pivotview"===this.parent.getModuleName()&&0===i.length)for(ct=0,wt=this.parentElement.querySelectorAll(".e-group-"+f);ct<wt.length;ct++)(h=wt[ct]).classList.contains(rf)||h.classList.contains(tf)||((tt=n.createElement("span",{className:kf})).innerText=this.parent.groupingBarSettings.allowDragAndDrop?"rows"===f?this.parent.localeObj.getConstant("rowAxisPrompt"):"columns"===f?this.parent.localeObj.getConstant("columnAxisPrompt"):"values"===f?this.parent.localeObj.getConstant("valueAxisPrompt"):"filters"===f?this.parent.localeObj.getConstant("filterAxisPrompt"):this.parent.localeObj.getConstant("allFields"):"",h.appendChild(tt));else{for(u=0,ui=i.length;u<ui;u++)for(lt=0,bt="pivotfieldlist"===this.parent.getModuleName()?[st]:this.parentElement.querySelectorAll(".e-group-"+f);lt<bt.length;lt++){var h=bt[lt],it="olap"===this.parent.dataType&&("[measures]"===i[u].name.toLowerCase()||"values"===f),fi="olap"===this.parent.dataType&&"values"===f;if(!h.classList.contains(rf)&&!h.classList.contains(tf)){a=n.createElement("div",{className:ur+(0===u&&"all-fields"!==f?" e-first-btn":""),attrs:{"data-tag":f+":"+i[u].name}});g=i[u].caption?i[u].caption:i[u].name;g=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(g):g;var c=n.createElement("div",{id:this.parent.element.id+"_"+i[u].name,className:v+" "+i[u].name.replace(/[^A-Z0-9]/gi,""),attrs:{"data-uid":i[u].name,tabindex:"pivotview"===this.parent.getModuleName()&&this.parent.grid&&"rows"===f&&!h.classList.contains(cs)?"-1":"0",isvalue:u===l||it&&!fi?"true":"false","aria-disabled":"false","aria-label":g,"data-type":"olap"===this.parent.dataType?fi?"isMeasureFieldsAvail":it?"isMeasureAvail":i[u].type:i[u].type,"data-caption":g,"data-basefield":this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(i[u].baseField):i[u].baseField,"data-baseitem":this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(i[u].baseItem):i[u].baseItem,role:"button"}}),ei=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:ot}),di=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"},className:ot+"-last"}),gi=this.createButtonDragIcon(i[u],c),oi=this.createButtonText(i,u,f,l);(c.appendChild(oi),"all-fields"!==f)?((it||i[u].isNamedSet||i[u].isCalculatedField||(-1!==["filters","values"].indexOf(f)||l===u||"olap"===this.parent.dataType&&("pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization||"pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization)||this.createSortOption(c,i[u].name,i[u]),"values"!==f&&l!==u&&this.createFilterOption(c,i[u].name,f,i[u]),"values"===f&&this.getTypeStatus(i,u,c)),i[u].isCalculatedField||"CalculatedField"===i[u].type)&&(at=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("editCalculatedField")},className:e+" "+k}),this.parent.allowCalculatedField&&this.parent.calculatedFieldModule&&(i[u].showEditIcon||void 0===i[u].showEditIcon)?n.removeClass([at],o):n.addClass([at],o),c.appendChild(at)),nt=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("remove")},className:e+" "+pi}),"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showRemoveIcon&&(i[u].showRemoveIcon||void 0===i[u].showRemoveIcon)?n.removeClass([nt],o):n.addClass([nt],o):i[u].showRemoveIcon||void 0===i[u].showRemoveIcon?n.removeClass([nt],o):n.addClass([nt],o),c.appendChild(nt),a.appendChild(ei),a.appendChild(c),a.appendChild(di)):(a.appendChild(ei),a.appendChild(c));h.appendChild(a);kt=new ht.Button({enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass});kt.isStringTemplate=!0;kt.appendTo(c);this.unWireEvent(a,u===l&&"all-fields"!==f?"values":f,it);this.wireEvent(a,u===l&&"all-fields"!==f?"values":f,it);("pivotview"===this.parent.getModuleName()&&!this.parent.isAdaptive||"pivotfieldlist"===this.parent.getModuleName())&&(this.createDraggable(i[u],"pivotview"===this.parent.getModuleName()?oi:gi),c.querySelector(".e-draggable").ej2_instances[0].enableAutoScroll=!1)}}if("values"===f)for(var nr=function(t){var u,r,f;t.classList.contains(rf)&&s.parent.pivotChartModule&&(u=i.map(function(n){return{text:n.caption?n.caption:n.name,value:n.name}}),r=s.parent,s.valueFiedDropDownList&&t.querySelector("."+ul)?(s.valueFiedDropDownList.dataSource=u,s.valueFiedDropDownList.value=r.chartSettings.enableMultipleAxis?u[0].value:r.pivotChartModule.currentMeasure):(f=n.createElement("div",{className:ul}),t.appendChild(f),s.valueFiedDropDownList=new y.DropDownList({dataSource:u,enableRtl:s.parent.enableRtl,locale:s.parent.locale,value:r.chartSettings.enableMultipleAxis?u[0].value:r.pivotChartModule.currentMeasure,width:200,fields:{value:"value",text:"text"},cssClass:"e-group-chart-values-drodown"+(s.parent.cssClass?" "+s.parent.cssClass:""),change:function(n){n.e&&null!==n.e&&(r.chartSettings.value=n.value)}}),s.valueFiedDropDownList.isStringTemplate=!0,s.valueFiedDropDownList.appendTo(f)))},s=this,dt=0,si=this.parentElement.querySelectorAll(".e-group-"+f);dt<si.length;dt++)nr(h=si[dt]);else if("columns"===f)for(var rt=void 0,gt=0,hi=this.parentElement.querySelectorAll(".e-group-"+f);gt<hi.length;gt++)if((h=hi[gt]).classList.contains(tf)&&this.parent.pivotChartModule){for(var tr=this.parent.pivotChartModule.currentMeasure,ir=this.parent.chartSettings.columnDelimiter?this.parent.chartSettings.columnDelimiter:"-",fr=this.parent.chartSettings.columnHeader&&""!==this.parent.chartSettings.columnHeader?this.parent.chartSettings.columnHeader.split(ir).join(" - "):"",ci="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,w=ci.pivotValues,er=this.parent.pivotChartModule.getColumnTotalIndex(w),p=[],li=!1,ni=0,ai=Object.keys(w);ni<ai.length;ni++){if(vi=ai[ni],li)break;if(d=Number(vi),w[d][0]&&"row"===w[d][0].axis&&(0===this.parent.dataSourceSettings.rows.length||"grand sum"!==w[d][0].type))for(var yi=w[d][0],ti="olap"===this.parent.dataType?ci.tupRowInfo[yi.ordinal]:void 0,or=w[d],ii=0,wi=Object.keys(or);ii<wi.length;ii++){var sr=wi[ii],hr=Number(sr),ut=w[d][hr],bi="olap"===this.parent.dataType&&ti&&ti.measureName?ti.measureName:ut.actualText;er[ut.colIndex]||"value"!==ut.axis||"header"===yi.type||""===bi||bi!==tr||(li=!0,ft="olap"===this.parent.dataType?ut.columnHeaders.toString().split(/~~|::/).join(" - "):ut.columnHeaders.toString().split(this.parent.dataSourceSettings.valueSortSettings.headerDelimiter).join(" - "),p.push({value:ft,text:ft,title:(vt={},vt.title=ft,vt)}),ft===fr&&(rt=p.length))}}this.columnFieldDropDownList&&h.querySelector("."+fl)?(this.columnFieldDropDownList.dataSource=p,this.columnFieldDropDownList.value=void 0!==rt?p[rt-1].value:p[0].value):(ri=n.createElement("div",{className:fl}),h.appendChild(ri),this.columnFieldDropDownList=new y.DropDownList({dataSource:p,enableRtl:this.parent.enableRtl,locale:this.parent.locale,value:rt?p[rt-1].value:p[0]?p[0].value:"",width:"200",fields:{value:"value",text:"text",htmlAttributes:"title"},cssClass:"e-group-chart-columns-dropdown"+(this.parent.cssClass?" "+this.parent.cssClass:""),change:function(n){if(n.e&&null!==n.e){var t=yt.parent.chartSettings.columnDelimiter?yt.parent.chartSettings.columnDelimiter:"-";yt.parent.chartSettings.columnHeader=n.value.split(" - ").join(t)}}}),this.columnFieldDropDownList.isStringTemplate=!0,this.columnFieldDropDownList.appendTo(ri))}}},t.prototype.createButtonText=function(t,i,r,u){var e,s,o,f,h;return"filters"===r&&(s=this.updateButtontext(t[i].name)),void 0!==(o="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[t[i].name]&&(e="DistinctCount"===(e=o.fieldList[t[i].name].aggregateType)||"number"===o.fieldList[t[i].name].type&&"include"!==o.fieldList[t[i].name].type&&"exclude"!==o.fieldList[t[i].name].type?void 0===e?"Sum":o.fieldList[t[i].name].aggregateType:"Count"),f=t[i].caption?t[i].caption:t[i].name,f=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(f):f,h=n.createElement("span",{attrs:{title:"filters"===r?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[t[i].name].type?f:f+" ("+s+")":"olap"===this.parent.dataType?f:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==e?this.parent.localeObj.getConstant(e)+" "+this.parent.localeObj.getConstant("of")+" "+f:f,tabindex:"-1","aria-disabled":"false",oncontextmenu:"return false;","data-type":u===i?"":e},className:df+" "+("pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&(t[i].allowDragAndDrop||void 0===t[i].allowDragAndDrop)?"":te:"")}),h.innerText="filters"===r?"olap"===this.parent.dataType&&"CalculatedField"===o.fieldList[t[i].name].type?f:f+" ("+s+")":"olap"===this.parent.dataType?f:this.parent.dataSourceSettings.showAggregationOnValueField&&"values"===r&&"CalculatedField"!==e?this.parent.localeObj.getConstant(e)+" "+this.parent.localeObj.getConstant("of")+" "+f:f,h},t.prototype.getTypeStatus=function(n,t,i){var r=("olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[n[t].name];"CalculatedField"!==r.aggregateType&&this.validateDropdown(r.type)&&this.createSummaryType(i,n[t].name,n[t])},t.prototype.validateDropdown=function(n){var t=this.parent.aggregateTypes,i;if("number"!==n)return t.indexOf("Count")>-1||t.indexOf("DistinctCount")>-1;for(i=0;i<t.length;i++)if(this.parent.getAllSummaryType().indexOf(t[i])>-1)return!0;return!1},t.prototype.createSummaryType=function(t,i,r){var u=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("format")},className:e+" "+hr});return"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.showValueTypeIcon&&r.showValueTypeIcon?n.removeClass([u],o):n.addClass([u],o):r.showValueTypeIcon?n.removeClass([u],o):n.addClass([u],o),t.appendChild(u),u},t.prototype.createMenuOption=function(n){this.menuOption.render(n,this.parentElement);this.parent.pivotButtonModule=this},t.prototype.openCalculatedFieldDialog=function(t){var i=t.target.parentElement.getAttribute("data-uid"),u=r.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=pf,this.parent.actionObj.fieldInfo=u,!this.parent.actionBeginMethod())try{"pivotview"===this.parent.getModuleName()?this.parent.isAdaptive&&this.parent.showFieldList&&this.parent.pivotFieldListModule&&!this.parent.pivotFieldListModule.isDestroyed?(this.parent.pivotFieldListModule.element.querySelector("."+rt).click(),this.parent.pivotFieldListModule.dialogRenderer.adaptiveElement.select(4),this.parent.pivotFieldListModule.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i)):(this.parent.isAdaptive||(this.parent.calculatedFieldModule.buttonCall=!0),this.parent.notify(tr,{edit:!0,fieldName:i})):"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.isAdaptive?(this.parent.dialogRenderer.adaptiveElement.select(4),this.parent.calculatedFieldModule.updateAdaptiveCalculatedField(!0,i),this.parent.calculatedFieldModule.buttonCall=!0):(this.parent.dialogRenderer.fieldListDialog&&(this.parent.dialogRenderer.fieldListDialog.hide(),n.addClass([this.parent.element.querySelector("."+rt)],sr)),this.parent.notify(tr,{edit:!0,fieldName:i}),this.parent.calculatedFieldModule&&(this.parent.calculatedFieldModule.buttonCall=!0)))}catch(t){this.parent.actionFailureMethod(t)}},t.prototype.createDraggable=function(t,i){this.draggable=new n.Draggable(i,{clone:!0,enableTailMode:!0,enableAutoScroll:!0,helper:this.createDragClone.bind(this),dragStart:this.onDragStart.bind(this),drag:this.onDragging.bind(this),dragStop:this.onDragStop.bind(this),abort:"pivotview"===this.parent.getModuleName()?this.parent.groupingBarSettings.allowDragAndDrop&&t.allowDragAndDrop?"":"."+v:t.allowDragAndDrop?"":"."+v})},t.prototype.createButtonDragIcon=function(t,i){var r=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false"}}),u=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("drag")},className:e+" "+lu+" "+(t.allowDragAndDrop||void 0===t.allowDragAndDrop?"":te)});return r.appendChild(u),"pivotfieldlist"===this.parent.getModuleName()&&i.appendChild(r),r},t.prototype.createSortOption=function(t,i,r){var s,u,h,f;if(h="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,this.parent.allowDeferLayoutUpdate)for(s="",f=0;f<this.parent.dataSourceSettings.sortSettings.length;f++)this.parent.dataSourceSettings.sortSettings[f].name===i&&(s="Descending"===this.parent.dataSourceSettings.sortSettings[f].order?pr:"");else s="Descending"===h.fieldList[i].sort?pr:"";return u="None"===h.fieldList[i].sort?n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:e}):n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("sort")},className:e+" "+hu+" "+s}),this.parent.dataSourceSettings.enableSorting?"pivotview"===this.parent.getModuleName()?r.showSortIcon&&this.parent.groupingBarSettings.showSortIcon?n.removeClass([u],o):n.addClass([u],o):r.showSortIcon?n.removeClass([u],o):n.addClass([u],o):n.addClass([u],o),t.appendChild(u),u},t.prototype.createFilterOption=function(t,i,u,f){var c,h,a,l,s;if(h="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,a=r.getFieldByName(i,this.parent.dataSourceSettings.filterSettings),this.parent.allowDeferLayoutUpdate)for(c=ne,l=0;l<this.parent.dataSourceSettings.filterSettings.length;l++)this.parent.dataSourceSettings.filterSettings[l].name===i&&(c=cu);else h.fieldList[i].filter=null===h.fieldList[i].filter?[]:h.fieldList[i].filter,c="Server"===this.parent.dataSourceSettings.mode&&!a||"Local"===this.parent.dataSourceSettings.mode&&0===h.fieldList[i].filter.length?h.fieldList[i].isExcelFilter?cu:ne:cu;return s=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("filter")},className:bt+" "+e+" "+c}),(this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==u||this.parent.dataSourceSettings.allowMemberFilter?n.removeClass([s],o):n.addClass([s],o),"pivotview"===this.parent.getModuleName()?((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==u||this.parent.dataSourceSettings.allowMemberFilter)&&this.parent.groupingBarSettings.showFilterIcon&&f.showFilterIcon?n.removeClass([s],o):n.addClass([s],o):f.showFilterIcon&&((this.parent.dataSourceSettings.allowLabelFilter||this.parent.dataSourceSettings.allowValueFilter)&&"filters"!==u||this.parent.dataSourceSettings.allowMemberFilter)?n.removeClass([s],o):n.addClass([s],o),t.appendChild(s),s},t.prototype.updateButtontext=function(n){var t,i,r=(t="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule).fieldList[n].filter.length,o=t.fieldList[n].filterType,s=t.fieldList[n].dateMember.length,f=t.fieldList[n].filter[0],h;if("olap"===this.parent.dataType)i=this.updateOlapButtonText(t,n,f,r);else if("include"===o)1===r?i=f:r>1&&(i=r===s?this.parent.localeObj.getConstant("all"):this.parent.localeObj.getConstant("multipleItems"));else if("exclude"===o){if(1===r)i=2===s?f!==t.fieldList[n].dateMember[0].actualText?f:t.fieldList[n].dateMember[0].actualText:this.parent.localeObj.getConstant("multipleItems");else if(r>1){var u=void 0,e=Object.keys(t.fieldList[n].members),c=t.fieldList[n].filter;if(r===e.length-1){n:for(u=0;u<e.length;u++)if(h=e[u],-1===c.indexOf(h)){i=e[u];break n}}else i=this.parent.localeObj.getConstant("multipleItems")}}else i=this.parent.localeObj.getConstant("all");return i},t.prototype.updateOlapButtonText=function(n,t,i,r){var s,a=n.fieldList[t].actualFilter,f,e,h,l,u;if(a.length>0){if(f=n.fieldList[t].members,e=[],n.fieldList[t].filterMembers.length>0){for(var o={},c=0,v=a;c<v.length;c++)o[u=v[c]]=u,f[u]&&(o=this.parent.pivotCommon.eventBase.getParentNode(t,u,o));for(h=0,l=o?Object.keys(o):[];h<l.length;h++)f[u=l[h]].isSelected&&(f[u].parent&&f[f[u].parent].isSelected||e.push(u));i=1===e.length?f[e[0]].caption:i}r=0===e.length?r:e.length}return 0===r?s=n.fieldList[t].allMember?n.fieldList[t].allMember:this.parent.localeObj.getConstant("all"):1===r?s=i:r>1&&(s=this.parent.localeObj.getConstant("multipleItems")),s},t.prototype.createDragClone=function(t){var r=n.closest(t.element,"."+v),i=n.createElement("div",{id:this.parent.element.id+"_DragClone",className:"e-button-drag-clone"+(this.parent.cssClass?" "+this.parent.cssClass:"")}),u=n.createElement("span",{className:lr});return u.innerText=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(r.textContent):r.textContent,i.appendChild(u),document.body.appendChild(i),i},t.prototype.onDragStart=function(t){var i=this,u=n.closest(t.element,"."+v),f=document.getElementById(this.parent.element.id+"_DragClone"),e=r.getFieldInfo(u.getAttribute("data-uid"),this.parent),o={fieldName:e.fieldName,fieldItem:e.fieldItem,axis:e.axis,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ws,o,function(r){var o,h,c,e,s,l;if(r.cancel)i.parent.isDragging=!1,i.draggable.intDestroy(t.event),n.detach(f);else if(i.parent.isDragging=!0,o=("olap"===i.parent.dataType?i.parent.olapEngineModule:i.parent.engineModule).fieldList[u.getAttribute("data-uid")],h=[kr,dr,gr],(n.addClass([u],tu),f&&"Popup"===("pivotfieldlist"===i.parent.getModuleName()&&i.parent.renderMode))&&(c=i.parent,f.style.zIndex=(c.dialogRenderer.fieldListDialog.zIndex+1).toString()),o&&"CalculatedField"===o.aggregateType)for(e=0,s=h;e<s.length;e++)l=s[e],n.addClass([i.parentElement.querySelector("."+l)],nu)})},t.prototype.onDragging=function(t){this.draggable.setProperties({cursorAt:{top:!n.isNullOrUndefined(t.event.targetTouches)||n.Browser.isDevice?60:-20}})},t.prototype.onDragStop=function(t){var r,i,u,f;for(this.parent.isDragging=!1,t.target&&t.element&&n.closest(t.element,"."+vo)&&!n.closest(t.target,"."+si)&&(t.cancel=!0),r=n.closest(t.element,"."+v),n.removeClass([].slice.call(this.parentElement.querySelectorAll("."+v)),tu),n.removeClass([].slice.call(this.parentElement.querySelectorAll("."+ot)),yt),i=0,u=[kr,dr,gr];i<u.length;i++)f=u[i],n.removeClass([this.parentElement.querySelector("."+f)],nu);this.parent.pivotCommon.filterDialog.dialogPopUp&&this.parent.pivotCommon.filterDialog.dialogPopUp.close();document.getElementById(this.parent.element.id+"_DragClone")&&n.remove(document.getElementById(this.parent.element.id+"_DragClone"));document.body.style.cursor="auto";this.isButtonDropped(t.target,r)&&!t.cancel&&(this.parent.pivotCommon.dataSourceUpdate.control="pivotview"===this.parent.getModuleName()?this.parent:this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,this.parent.pivotCommon.nodeStateModified.onStateModified(t,r.getAttribute("data-uid")))&&(this.updateDataSource(),this.parent.axisFieldModule.render())},t.prototype.isButtonDropped=function(t,i){var f=n.closest(i,"."+si),l=n.closest(t,"."+si),s=!0,c;if(f&&f===l){for(var u=[].slice.call(f.querySelectorAll("."+v)),h=n.closest(t,"."+ur),e=void 0,o=-1,r=0,a=u.length;r<a;r++)(u[r].id===i.id&&(e=r),h)&&(c=h.querySelector("."+v),u[r].id===c.id&&(o=r));(e===o||e===u.length-1&&-1===o)&&(n.removeClass([].slice.call(this.parentElement.querySelectorAll("."+ot)),yt),s=!1)}return s},t.prototype.updateSorting=function(t){var u=n.closest(t.target,"."+v),i=r.getFieldInfo(u?u.getAttribute("data-uid"):"",this.parent),f;if(!t.target.classList.contains(bt)&&!t.target.classList.contains(pi)&&!t.target.classList.contains(lu)&&u&&i.fieldItem&&(i.fieldItem.showSortIcon||n.isNullOrUndefined(i.fieldItem.showSortIcon))&&!i.fieldItem.isCalculatedField){if(this.parent.actionObj.actionName=no,this.parent.actionObj.fieldInfo=i,this.parent.actionBeginMethod())return;try{!(this.parent instanceof sf||this.parent.groupingBarSettings.showSortIcon)||!this.parent.dataSourceSettings.enableSorting||"olap"===this.parent.dataType&&("pivotfieldlist"===this.parent.getModuleName()&&void 0!==this.parent.pivotGridModule&&this.parent.pivotGridModule.enableVirtualization||"pivotview"===this.parent.getModuleName()&&this.parent.enableVirtualization)||((this.parent.pivotCommon.eventBase.updateSorting(t),this.parent.staticPivotGridModule&&(this.parent.staticPivotGridModule.actionObj=this.parent.actionObj),this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName())||(f={sortInfo:this.parent.lastSortInfo},this.parent.actionObj.actionInfo=f,this.updateDataSource(!0)),this.parent instanceof sf&&this.axisField.render())}catch(t){this.parent.actionFailureMethod(t)}}},t.prototype.updateDataSource=function(n){this.parent.allowDeferLayoutUpdate&&"pivotview"!==this.parent.getModuleName()?"pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView&&this.parent.pivotGridModule?("olap"===this.parent.dataType?this.parent.pivotGridModule.olapEngineModule=this.parent.olapEngineModule:this.parent.pivotGridModule.engineModule=this.parent.engineModule,this.parent.pivotGridModule.notify(oi,this),this.parent.pivotGridModule.setProperties({dataSourceSettings:this.parent.dataSourceSettings.properties},!0)):this.parent.triggerPopulateEvent():this.parent.updateDataSource(n)},t.prototype.updateFiltering=function(n){var t=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,i=n.target.parentElement.getAttribute("data-uid"),u=r.getFieldInfo(i,this.parent);if(this.parent.actionObj.actionName=to,this.parent.actionObj.fieldInfo=u,!this.parent.actionBeginMethod())try{"pivotfieldlist"===t.getModuleName()?b.showSpinner(t.fieldListSpinnerElement):t.showWaitingPopup();t.mouseEventArgs=n;t.filterTargetID="pivotfieldlist"!==this.parent.pivotCommon.moduleName?this.parent.element:document.getElementById(this.parent.pivotCommon.parentID+"_Container");"Server"===t.dataSourceSettings.mode?this.parent.engineModule.fieldList[i].members&&Object.keys(this.parent.engineModule.fieldList[i].members).length>0?this.updateFilterEvents():t.getEngine("fetchFieldMembers",null,null,null,null,null,i):this.updateFilterEvents()}catch(n){this.parent.actionFailureMethod(n)}},t.prototype.updateFilterEvents=function(){var n=this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent,t;this.parent.pivotCommon.eventBase.updateFiltering(n.mouseEventArgs);t=n.mouseEventArgs.target;this.fieldName=t.parentElement.getAttribute("data-uid");this.parent.pivotCommon.filterDialog.dialogPopUp&&this.bindDialogEvents();"pivotfieldlist"===n.getModuleName()?b.hideSpinner(n.fieldListSpinnerElement):n.hideWaitingPopup()},t.prototype.bindDialogEvents=function(){this.parent.pivotCommon.filterDialog.allowExcelLikeFilter&&this.parent.pivotCommon.filterDialog.tabObj?(this.index=this.parent.pivotCommon.filterDialog.tabObj.selectedItem,this.updateDialogButtonEvents(),this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel(),this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind(),this.parent.pivotCommon.filterDialog.tabObj.selected=this.tabSelect.bind(this)):this.parent.dataSourceSettings.allowMemberFilter&&(this.index=0,this.updateDialogButtonEvents())},t.prototype.buttonModel=function(){return[{buttonModel:{cssClass:"e-clear-filter-button"+(this.parent.pivotCommon.filterDialog.allowExcelLikeFilter?"":" "+o)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:"e-icons e-clear-filter-icon",enableRtl:this.parent.enableRtl,content:this.parent.localeObj.getConstant("clearFilter"),disabled:!this.parent.pivotCommon.filterDialog.filterObject},click:this.ClearFilter.bind(this)},{buttonModel:{cssClass:lt+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("ok"),isPrimary:!0},click:0===this.index?this.updateFilterState.bind(this,this.fieldName):this.updateCustomFilter.bind(this)},{click:this.parent.pivotCommon.filterDialog.closeFilterDialog.bind(this.parent.pivotCommon.filterDialog),buttonModel:{cssClass:br+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}]},t.prototype.tabSelect=function(t){this.index=t.selectedIndex;this.updateDialogButtonEvents();n.removeClass([].slice.call(this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelectorAll(".e-selected-tab")),"e-selected-tab");t.selectedIndex>0&&n.addClass([this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-filter-div-content."+(1===t.selectedIndex&&this.parent.dataSourceSettings.allowLabelFilter?"e-label-filter":"e-value-filter"))],"e-selected-tab");0===t.selectedIndex?this.parent.pivotCommon.filterDialog.updateCheckedState():(this.parent.pivotCommon.filterDialog.dialogPopUp.buttons[0].buttonModel.disabled=!1,this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector("."+lt).removeAttribute("disabled"))},t.prototype.updateDialogButtonEvents=function(){this.parent.pivotCommon.filterDialog.dialogPopUp.buttons=this.buttonModel();this.parent.pivotCommon.filterDialog.dialogPopUp.dataBind()},t.prototype.updateCustomFilter=function(){var t,f=this,u=this.parent.pivotCommon.filterDialog.dialogPopUp.element.querySelector(".e-selected-tab"),e=u.getAttribute("data-fieldname"),v=u.getAttribute("data-selectedField"),s=u.getAttribute("data-type"),d=u.getAttribute("data-measure"),w=u.getAttribute("data-operator"),o=u.getAttribute("data-value1"),h=u.getAttribute("data-value2"),c="value"===s?"Value":"date"===s?"Date":"number"===s?"Number":"Label",i={name:e,type:c,measure:d,condition:w,value1:"date"===s?new Date(o):o,value2:"date"===s?new Date(h):h},l,y,a,b,p,k;if("olap"===this.parent.dataType)for(i.selectedField=v,this.removeDataSourceSettings(e,v,c),l=0,y=this.parent.dataSourceSettings.filterSettings;l<y.length;l++)a=y[l],a.name===e&&a.selectedField===v&&(t=a);else t=r.getFilterItemByName(e,this.parent.dataSourceSettings.filterSettings);if(n.isNullOrUndefined(o)||""===o||["Between","NotBetween"].indexOf(w)>-1&&(n.isNullOrUndefined(h)||""===h))return b=c.toLowerCase()+(n.isNullOrUndefined(o)||""===o?"_input_option_1":"_input_option_2"),p=n.select("#"+this.parent.element.id+"_"+b,u),n.addClass([p],es),void p.focus();k={cancel:!1,filterSettings:i,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings)};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ps,k,function(n){n.cancel||(i=n.filterSettings,t?((t=t.properties?t.properties:t).type=i.type,t.measure=i.measure,t.condition=i.condition,t.value1=i.value1,t.value2=i.value2,"olap"===f.parent.dataType&&(t.selectedField=i.selectedField)):f.parent.dataSourceSettings.filterSettings.push(i));"Value"!==c&&(f.parent.lastFilterInfo=r.getFilterItemByName(e,f.parent.dataSourceSettings.filterSettings));f.parent.pivotCommon.filterDialog.dialogPopUp.close();n.cancel||(f.refreshPivotButtonState(e,!0),f.updateDataSource(!0))})},t.prototype.ClearFilter=function(){var t=this.parent.pivotCommon.filterDialog.dialogPopUp.element,n=t.getAttribute("data-fieldname"),i=t.querySelector(".e-selected-tab"),u,f;(this.parent.pivotCommon.filterDialog.dialogPopUp.close(),"olap"===this.parent.dataType&&i)?(u=i.getAttribute("data-selectedField"),this.removeDataSourceSettings(n,u)):this.removeDataSourceSettings(n);f=r.getFilterItemByName(n,this.parent.dataSourceSettings.filterSettings);this.refreshPivotButtonState(n,!!f);this.updateDataSource(!0)},t.prototype.removeButton=function(n){var t=this,f=n.target,u=f.parentElement.getAttribute("data-uid"),i=r.getFieldInfo(u,this.parent),e;if(this.parent.actionObj.actionName=wf,this.parent.actionObj.fieldInfo=i,!this.parent.actionBeginMethod()){e={cancel:!1,fieldName:u,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),fieldItem:i.fieldItem,axis:i.axis};try{("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(de,e,function(n){n.cancel||("true"===f.parentElement.getAttribute("isvalue")?(t.parent.setProperties({dataSourceSettings:{values:[]}},!0),"olap"===t.parent.dataType&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")):(t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport(u),"pivot"===t.parent.dataType&&t.parent.showValuesButton&&t.parent.dataSourceSettings.values.length>1&&i.position<t.parent.dataSourceSettings.valueIndex&&("row"===t.parent.dataSourceSettings.valueAxis&&"rows"===n.axis||"column"===t.parent.dataSourceSettings.valueAxis&&"columns"===n.axis)&&t.parent.setProperties({dataSourceSettings:{valueIndex:t.parent.dataSourceSettings.valueIndex-1}},!0),"olap"===t.parent.dataType&&0===t.parent.dataSourceSettings.values.length&&t.parent.pivotCommon.dataSourceUpdate.removeFieldFromReport("[Measures]")),"pivotfieldlist"===t.parent.getModuleName()&&t.parent.axisFieldModule.render(),t.updateDataSource())})}catch(n){this.parent.actionFailureMethod(n)}}},t.prototype.nodeStateModified=function(t){var i=n.closest(t.node,"li"),r=i.getAttribute("data-fieldname"),f,u;"all"===i.getAttribute("data-memberId")?(this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=null,"check"===t.action?this.parent.pivotCommon.filterDialog.memberTreeView.checkAll():this.parent.pivotCommon.filterDialog.memberTreeView.uncheckAll(),"olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[r].isHierarchy&&this.updateNodeStates(this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),r),this.checkedStateAll(t.action),this.parent.pivotCommon.filterDialog.memberTreeView.nodeChecked=this.nodeStateModified.bind(this)):("olap"===this.parent.dataType&&this.parent.olapEngineModule&&!this.parent.olapEngineModule.fieldList[r].isHierarchy&&(f=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),this.updateNodeStates(f,r)),u=this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].index,this.parent.pivotCommon.currentTreeItems[u]&&(this.parent.pivotCommon.currentTreeItems[u].isSelected="check"===t.action,this.parent.pivotCommon.currentTreeItemsPos[i.getAttribute("data-memberId")].isSelected="check"===t.action));this.parent.pivotCommon.filterDialog.updateCheckedState()},t.prototype.checkedStateAll=function(n){for(var i,u,t,f={},r=0,e=this.parent.pivotCommon.searchTreeItems;r<e.length;r++)(t=e[r]).isSelected="check"===n,f[t.htmlAttributes["data-memberId"]]=t.htmlAttributes["data-memberId"];for(i=0,u=this.parent.pivotCommon.currentTreeItems;i<u.length;i++)void 0!==f[(t=u[i]).htmlAttributes["data-memberId"]]&&(t.isSelected="check"===n,this.parent.pivotCommon.currentTreeItemsPos[t.htmlAttributes["data-memberId"]].isSelected="check"===n)},t.prototype.updateNodeStates=function(n,t){var f=this.parent.pivotCommon.engineModule.fieldList[t],r=f.members,e=f.currrentMembers,o,a,s,v,h,c,y,u,l,p,i;if(f.searchMembers.length>0){for(o=0,a=Object.keys(e);o<a.length;o++)e[u=a[o]]&&(e[u].isSelected=!1),r[u]&&(r[u].isSelected=!1,this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]')&&(h=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+u+'"]'))&&!h.querySelector("ul")&&this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,u,!1));for(s=0,v=n;s<v.length;s++)r[i=v[s]]&&this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+i+'"]')&&(h=this.parent.pivotCommon.filterDialog.memberTreeView.element.querySelector('li[data-memberId="'+i+'"]'))&&!h.querySelector("ul")&&(r[i].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,i,!0)),e[i]&&(e[i].isSelected=!0)}else{for(c=0,y=Object.keys(r);c<y.length;c++)r[u=y[c]].isSelected&&(r[u].isSelected=!1);for(l=0,p=n;l<p.length;l++)r[i=p[l]]&&(r[i].isSelected=!0,this.parent.pivotCommon.eventBase.updateChildNodeStates(f.filterMembers,t,i,!0))}},t.prototype.updateFilterState=function(n){var i=this,f=!1,t={items:[],name:n,type:"Include"},u="olap"===this.parent.dataType?this.parent.olapEngineModule:this.parent.engineModule,o,s,v,w,h,y,e,c,p,l,a,b;if("olap"===this.parent.dataType&&u&&!u.fieldList[n].isHierarchy)for(o=u.fieldList[n].members,s=u.fieldList[n].currrentMembers,(t.items=this.parent.pivotCommon.filterDialog.memberTreeView.getAllCheckedNodes(),t.levelCount=u.fieldList[n].levelCount,f=t.items.length!==this.parent.pivotCommon.filterDialog.memberTreeView.fields.dataSource.length,u.fieldList[n].searchMembers.length>0&&!f)&&(v=Object.keys(o).length,w=Object.keys(s).length,f=v!==w||v!==t.items.length),h=0,y=t.items;h<y.length;h++)e=y[h],u.fieldList[n].searchMembers.length>0&&s[e]?s[e].isSelected=!0:o[e]&&(o[e].isSelected=!0);else{for(c=0,p=this.parent.pivotCommon.searchTreeItems;c<p.length;c++)l=p[c],l.isSelected&&(this.parent.pivotCommon.isDateField?t.items.push(l.name):t.items.push(l.htmlAttributes["data-memberId"]));f=t.items.length!==this.parent.pivotCommon.currentTreeItems.length}if("olap"===this.parent.dataType&&this.removeDataSourceSettings(n),this.parent.allowDeferLayoutUpdate)for(u.fieldList[t.name].filterType=t.type.toLowerCase(),u.fieldList[t.name].filter=[],a=0;a<t.items.length;a++)u.fieldList[t.name].filter.push(t.items[a]);b={filterSettings:t,dataSourceSettings:r.getClonedDataSourceSettings(this.parent.dataSourceSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ps,b,function(u){var e,l,s,o,h,c;if(t=u.filterSettings,!u.cancel){if(r.getFilterItemByName(n,i.parent.dataSourceSettings.filterSettings))for(e=0;e<i.parent.dataSourceSettings.filterSettings.length;e++)if(i.parent.dataSourceSettings.filterSettings[e].name===n){i.parent.dataSourceSettings.filterSettings.splice(e,1);break}i.parent.dataSourceSettings.filterSettings.push(t)}for((i.parent.pivotCommon.filterDialog.dialogPopUp.close(),u.cancel)||(i.refreshPivotButtonState(n,f),f||(i.removeDataSourceSettings(n),t={}),i.parent.lastFilterInfo=t,l={filterInfo:i.parent.lastFilterInfo},i.parent.actionObj.actionInfo=l,i.updateDataSource(!0),s=i,s.parent instanceof sf&&s.axisField.render()),o=0,h=[].slice.call(i.parentElement.querySelectorAll(".e-pivot-button"));o<h.length;o++)if(c=h[o],c.getAttribute("data-uid")===n){c.focus();break}})},t.prototype.refreshPivotButtonState=function(t,i){for(var r,e,u=0,f=[].slice.call(this.parentElement.querySelectorAll(".e-pivot-button"));u<f.length;u++)if(e=f[u],e.getAttribute("data-uid")===t){r=e.querySelector("."+bt);break}i?(n.removeClass([r],ne),n.addClass([r],cu)):(n.removeClass([r],cu),n.addClass([r],ne))},t.prototype.removeDataSourceSettings=function(n,t,i){for(var u=this.parent.dataSourceSettings.filterSettings,r=0,f=u.length;r<f;r++)if("olap"===this.parent.dataType&&t){if(!i&&u[r].name===n&&u[r].selectedField===t){u.splice(r,1);break}i&&u[r].type!==i&&u[r].name===n&&(u.splice(r,1),f--,r--)}else if(u[r].name===n){if(u.splice(r,1),"olap"!==this.parent.dataType)break;f--;r--}},t.prototype.updateDropIndicator=function(t){if(this.parent.isDragging&&(n.removeClass([].slice.call(this.parentElement.querySelectorAll("."+ot+"-last")),yt),n.removeClass([].slice.call(this.parentElement.querySelectorAll("."+ot)),yt),n.closest(t.target,"."+si))){var i=n.closest(t.target,"."+ur);n.addClass([i.querySelector("."+ot)],yt)}},t.prototype.wireEvent=function(t,i,r){n.EventHandler.add(t,"mouseover",this.updateDropIndicator,this);r||(-1===["filters","values"].indexOf(i)&&null!==t.querySelector("."+v)&&n.EventHandler.add(t.querySelector("."+v),"click",this.updateSorting,this),"values"!==i&&null!==t.querySelector("."+bt)&&n.EventHandler.add(t.querySelector("."+bt),"click",this.updateFiltering,this),"values"===i&&null!==t.querySelector("."+hr)&&n.EventHandler.add(t.querySelector("."+hr),"click",this.createMenuOption,this));null!==t.querySelector("."+k)&&n.EventHandler.add(t.querySelector("."+k),"click",this.openCalculatedFieldDialog,this);null!==t.querySelector("."+pi)&&n.EventHandler.add(t.querySelector("."+pi),"click",this.removeButton,this)},t.prototype.unWireEvent=function(t,i,r){n.EventHandler.remove(t,"mouseover",this.updateDropIndicator);r||(-1===["filters","values"].indexOf(i)&&null!==t.querySelector("."+v)&&n.EventHandler.remove(t.querySelector("."+v),"click",this.updateSorting),"values"!==i&&null!==t.querySelector("."+bt)&&n.EventHandler.remove(t.querySelector("."+bt),"click",this.updateFiltering),"values"===i&&null!==t.querySelector("."+hr)&&n.EventHandler.remove(t.querySelector("."+hr),"click",this.createMenuOption));null!==t.querySelector("."+k)&&n.EventHandler.remove(t.querySelector("."+k),"click",this.openCalculatedFieldDialog);null!==t.querySelector("."+pi)&&n.EventHandler.remove(t.querySelector("."+pi),"click",this.removeButton)},t.prototype.addEventListener=function(){this.handlers={load:this.renderPivotButton};this.parent.isDestroyed||this.parent.on(vf,this.handlers.load,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(vf,this.handlers.load)},t.prototype.destroy=function(){this.menuOption&&this.menuOption.destroy();this.valueFiedDropDownList&&!this.valueFiedDropDownList.isDestroyed&&(this.valueFiedDropDownList.destroy(),this.valueFiedDropDownList=null);this.columnFieldDropDownList&&!this.columnFieldDropDownList.isDestroyed&&(this.columnFieldDropDownList.destroy(),this.columnFieldDropDownList=null);this.draggable&&!this.draggable.isDestroyed&&(this.draggable.destroy(),this.draggable=null);this.axisField&&(this.axisField=null);this.removeEventListener();this.isDestroyed=!0},t}(),ta=function(){function n(n){this.parent=n}return n.prototype.render=function(){(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new na(this.parent);this.createPivotButtons()},n.prototype.createPivotButtons=function(){var i=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],n=this.parent.dialogRenderer.parentElement,r;if(n.querySelector("."+et+"-filters")&&(n.querySelector("."+et+"-filters").querySelector("."+rr).innerHTML=""),n.querySelector("."+et+"-rows")&&(n.querySelector("."+et+"-rows").querySelector("."+rr).innerHTML=""),n.querySelector("."+et+"-columns")&&(n.querySelector("."+et+"-columns").querySelector("."+rr).innerHTML=""),n.querySelector("."+et+"-values")&&(n.querySelector("."+et+"-values").querySelector("."+rr).innerHTML=""),"pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof ut.DataManager)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&""!==this.parent.dataSourceSettings.url)for(var u=["rows","columns","values","filters"],t=0,f=i.length;t<f;t++)i[t]&&(r={field:i[t],axis:u[t].toString()},this.parent.notify(vf,r))},n}(),op=function(){function n(n){this.parent=n;this.parent.dialogRenderer=new up(this.parent);this.parent.treeViewModule=new fp(this.parent);this.parent.axisTableModule=new ep(this.parent);this.parent.axisFieldModule=new ta(this.parent)}return n.prototype.render=function(){this.parent.dialogRenderer.render();this.parent.isAdaptive||this.parent.treeViewModule.render();this.parent.axisTableModule.render()},n}(),sp=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),p=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},sf=function(t){function i(n,i){var r=t.call(this,n,i)||this;return r.pivotChange=!1,r.isRequiredUpdate=!0,r.lastSortInfo={},r.lastFilterInfo={},r.lastAggregationInfo={},r.lastCalcFieldInfo={},r.isPopupView=!1,r.enableValueSorting=!1,r.remoteData=[],r.actionObj={},r.destroyEngine=!1,r.defaultFieldListOrder="None",r.isDeferUpdateApplied=!1,r}return sp(i,t),i.prototype.requiredModules=function(){var n=[];return this.allowCalculatedField&&n.push({args:[this],member:"calculatedField"}),n},i.prototype.getAllSummaryType=function(){return["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"]},i.prototype.preRender=function(){this.dataSourceSettings&&"SSAS"===this.dataSourceSettings.providerType?(this.olapEngineModule=new kl,this.dataType="olap"):(this.engineModule=new ls,this.dataType="pivot");this.isAdaptive=n.Browser.isDevice;this.globalize=new n.Internationalization(this.locale);this.renderModule=new op(this);this.defaultLocale={staticFieldList:"Pivot Field List",fieldList:"Field List",dropFilterPrompt:"Drop filter here",dropColPrompt:"Drop column here",dropRowPrompt:"Drop row here",dropValPrompt:"Drop value here",addPrompt:"Add field here",adaptiveFieldHeader:"Choose field",centerHeader:"Drag fields between axes below:",add:"add",drag:"Drag",filter:"Filter",filtered:"Filtered",sort:"Sort",remove:"Remove",filters:"Filters",rows:"Rows",columns:"Columns",values:"Values",CalculatedField:"Calculated Field",createCalculatedField:"Create Calculated Field",fieldName:"Enter the field name",error:"Error",invalidFormula:"Invalid formula.",dropText:'Example: ("Sum(Order_Count)" + "Sum(In_Stock)") * 250',dropTextMobile:"Add fields and edit formula here.",dropAction:"Calculated field cannot be place in any other region except value axis.",search:"Search",close:"Close",cancel:"Cancel","delete":"Delete",alert:"Alert",warning:"Warning",ok:"OK",allFields:"All Fields",formula:"Formula",fieldExist:"A field already exists in this name. Please enter a different name.",confirmText:"A calculation field already exists in this name. Do you want to replace it?",noMatches:"No matches",format:"Summaries values by",edit:"Edit",clear:"Clear",clearCalculatedField:"Clear edited field info",editCalculatedField:"Edit calculated field",sortAscending:"Sort ascending order",sortDescending:"Sort descending order",sortNone:"Sort data order",formulaField:"Drag and drop fields to formula",dragField:"Drag field to formula",clearFilter:"Clear",by:"by",enterValue:"Enter value",chooseDate:"Enter date",all:"All",multipleItems:"Multiple items",Equals:"Equals",DoesNotEquals:"Does Not Equal",BeginWith:"Begins With",DoesNotBeginWith:"Does Not Begin With",EndsWith:"Ends With",DoesNotEndsWith:"Does Not End With",Contains:"Contains",DoesNotContains:"Does Not Contain",GreaterThan:"Greater Than",GreaterThanOrEqualTo:"Greater Than Or Equal To",LessThan:"Less Than",LessThanOrEqualTo:"Less Than Or Equal To",Between:"Between",NotBetween:"Not Between",Before:"Before",BeforeOrEqualTo:"Before Or Equal To",After:"After",AfterOrEqualTo:"After Or Equal To",member:"Member",label:"Label",date:"Date",value:"Value",labelTextContent:"Show the items for which the label",dateTextContent:"Show the items for which the date",valueTextContent:"Show the items for which",And:"and",Sum:"Sum",Count:"Count",DistinctCount:"Distinct Count",Product:"Product",Avg:"Avg",Median:"Median",Min:"Min",Max:"Max",Index:"Index",SampleStDev:"Sample StDev",PopulationStDev:"Population StDev",SampleVar:"Sample Var",PopulationVar:"Population Var",RunningTotals:"Running Totals",DifferenceFrom:"Difference From",PercentageOfDifferenceFrom:"% of Difference From",PercentageOfGrandTotal:"% of Grand Total",PercentageOfColumnTotal:"% of Column Total",PercentageOfRowTotal:"% of Row Total",PercentageOfParentTotal:"% of Parent Total",PercentageOfParentColumnTotal:"% of Parent Column Total",PercentageOfParentRowTotal:"% of Parent Row Total",MoreOption:"More...",Years:"Years",Quarters:"Quarters",Months:"Months",Days:"Days",Hours:"Hours",Minutes:"Minutes",Seconds:"Seconds",apply:"Apply",valueFieldSettings:"Value field settings",sourceName:"Field name :",sourceCaption:"Field caption",summarizeValuesBy:"Summarize values by",baseField:"Base field",baseItem:"Base item",example:"e.g:",editorDataLimitMsg:" more items. Search to refine further.",deferLayoutUpdate:"Defer Layout Update","null":"null",undefined:"undefined",groupOutOfRange:"Out of Range",fieldDropErrorAction:"The field you are moving cannot be placed in that area of the report",memberType:"Field Type",selectedHierarchy:"Parent Hierarchy",formatString:"Format",expressionField:"Expression",olapDropText:"Example: [Measures].[Order Quantity] + ([Measures].[Order Quantity] * 0.10)",customFormat:"Enter custom format string",numberFormatString:"Example: C, P, 0000 %, ###0.##0#, etc.",Measure:"Measure",Dimension:"Dimension",Standard:"Standard",Currency:"Currency",Percent:"Percent",Custom:"Custom",blank:"(Blank)",fieldTooltip:'Drag and drop fields to create an expression. And, if you want to edit the existing calculated fields! You can achieve it by simply selecting the field under "Calculated Members".',fieldTitle:"Field Name",QuarterYear:"Quarter Year",caption:"Field Caption",copy:"Copy",of:"of",group:"Group",removeCalculatedField:"Are you sure you want to delete this calculated field?",yes:"Yes",no:"No",None:"None"};this.localeObj=new n.L10n(this.getModuleName(),this.defaultLocale,this.locale);this.isDragging=!1;this.captionData=[];this.wireEvent()},i.prototype.frameCustomProperties=function(n,t){this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);var i=this.pivotGridModule?this.pivotGridModule.pageSettings:this.pageSettings,s=!!this.pivotGridModule&&this.pivotGridModule.enablePaging,r=!!this.pivotGridModule&&this.pivotGridModule.enableVirtualization,h=this.pivotGridModule?this.pivotGridModule.enableHtmlSanitizer:this.enableHtmlSanitizer,u=this.pivotGridModule?this.pivotGridModule.localeObj:this.staticPivotGridModule?this.staticPivotGridModule.localeObj:this.localeObj,f=!this.pivotGridModule||this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing,e=this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,o=!(!this.pivotGridModule||!this.pivotGridModule.allowDataCompression)&&this.pivotGridModule.allowDataCompression;return"olap"===this.dataType?{mode:"",savedFieldList:t||void 0,savedFieldListData:n||void 0,pageSettings:i,enableValueSorting:e,isDrillThrough:f,localeObj:u,enableVirtualization:r,allowDataCompression:o}:{mode:"",savedFieldList:void 0,pageSettings:i,enableValueSorting:e,isDrillThrough:f,localeObj:u,clonedReport:this.clonedReport,globalize:this.globalize,currenyCode:this.currencyCode,enablePaging:s,enableVirtualization:r,enableHtmlSanitizer:h,allowDataCompression:o}},i.prototype.render=function(){"pivot"===this.dataType&&this.dataSourceSettings.url&&""!==this.dataSourceSettings.url?"Server"===this.dataSourceSettings.mode?(this.guid=r.generateUUID(),this.getEngine("initialRender",null,null,null,null,null,null)):new n.Fetch(this.dataSourceSettings.url,"GET").send().then(function(n){return"string"==typeof n?n:n.text()}).then(this.onReadyStateChange.bind(this)):this.initialLoad()},i.prototype.getEngine=function(t,i,u,f,e,o,s,h,c){var v=this,a,l;this.currentAction=t;this.pivotGridModule&&this.pivotGridModule.updatePageSettings(!1);a={pageSettings:this.pivotGridModule?JSON.parse(this.pivotGridModule.getPageSettings()).pageSettings:void 0,enableValueSorting:this.pivotGridModule?this.pivotGridModule.enableValueSorting:void 0,enableDrillThrough:!this.pivotGridModule||this.pivotGridModule.allowDrillThrough||this.pivotGridModule.editSettings.allowEditing,locale:JSON.stringify(r.getLocalizedObject(this))};this.request=n.isNullOrUndefined(this.request)?new XMLHttpRequest:this.request;this.request.open("POST",this.dataSourceSettings.url,!0);l={request:this.request,dataSourceSettings:JSON.parse(this.getPersistData()).dataSourceSettings,action:t,customProperties:{},internalProperties:a,drillItem:i,sortItem:u,aggregatedItem:f,calculatedItem:e,filterItem:o,memberName:s,fetchRawDataArgs:h,editArgs:c,hash:this.guid,isGroupingUpdated:"onRefresh"===this.currentAction&&this.dataSourceSettings.groupSettings.length>0||!(!this.pivotGridModule||!this.pivotGridModule.groupingModule)&&this.pivotGridModule.groupingModule.isUpdate};this.trigger(bs,l,function(n){v.request=n.request;l.internalProperties=n.internalProperties;l.customProperties=n.customProperties;l.dataSourceSettings=n.dataSourceSettings;l.calculatedItem=n.calculatedItem;l.drillItem=n.drillItem;l.editArgs=n.editArgs;l.fetchRawDataArgs=n.fetchRawDataArgs;l.filterItem=n.filterItem;l.hash=n.hash;l.memberName=n.memberName;l.sortItem=n.sortItem});this.request.withCredentials=!1;this.request.onreadystatechange=this.onSuccess.bind(this);this.request.setRequestHeader("Content-type","application/json");this.request.send(JSON.stringify(l))},i.prototype.onSuccess=function(){var h,t,u,i,s;if(this.request.readyState===XMLHttpRequest.DONE){try{if(h={action:this.currentAction,response:this.request.responseText},this.trigger(ks,h),t=JSON.parse(this.request.responseText),"fetchFieldMembers"===this.currentAction){for(var o=JSON.parse(t.members),c=[],l={},a={},n=0;n<o.length;n++)c.push({formattedText:o[n].FormattedText,actualText:o[n].ActualText}),l[o[n].FormattedText]={},a[o[n].ActualText]={};this.engineModule.fieldList[t.memberName].dateMember=c;this.engineModule.fieldList[t.memberName].formattedMembers=l;this.engineModule.fieldList[t.memberName].members=a;this.pivotButtonModule.updateFilterEvents()}else{if(u=r.formatFieldList(JSON.parse(t.fieldList)),this.engineModule.fieldList)for(i=Object.keys(this.engineModule.fieldList),n=0;n<i.length;n++)this.engineModule.fieldList[i[n]]&&u[i[n]]&&(u[i[n]].dateMember=this.engineModule.fieldList[i[n]].dateMember,u[i[n]].formattedMembers=this.engineModule.fieldList[i[n]].formattedMembers,u[i[n]].members=this.engineModule.fieldList[i[n]].members);this.engineModule.fieldList=u;this.engineModule.fields=JSON.parse(t.fields);this.engineModule.rowCount=JSON.parse(t.pivotCount).RowCount;this.engineModule.columnCount=JSON.parse(t.pivotCount).ColumnCount;this.engineModule.rowStartPos=JSON.parse(t.pivotCount).RowStartPosition;this.engineModule.colStartPos=JSON.parse(t.pivotCount).ColumnStartPosition;this.engineModule.rowFirstLvl=JSON.parse(t.pivotCount).RowFirstLevel;this.engineModule.colFirstLvl=JSON.parse(t.pivotCount).ColumnFirstLevel;for(var v=void 0,f=r.formatPivotValues(JSON.parse(t.pivotValue)),e=0;e<f.length;e++)if(f[e]&&f[e][0]&&"row"===f[e][0].axis){v=e;break}this.engineModule.headerContent=r.frameContent(f,"header",v,this);this.engineModule.pageSettings=this.pivotGridModule?this.pivotGridModule.pageSettings:void 0;s=JSON.parse(t.dataSourceSettings).ValueSortSettings;this.engineModule.valueSortSettings={headerText:s.HeaderText,headerDelimiter:s.HeaderDelimiter,sortOrder:s.SortOrder,columnIndex:s.ColumnIndex};this.engineModule.pivotValues=f}}catch(h){this.engineModule.pivotValues=[]}"fetchFieldMembers"!==this.currentAction&&(this.initEngine(),this.calculatedFieldModule&&this.calculatedFieldModule.isRequireUpdate&&(this.calculatedFieldModule.endDialog(),this.calculatedFieldModule.isRequireUpdate=!1),this.pivotGridModule&&this.pivotGridModule.calculatedFieldModule&&this.pivotGridModule.calculatedFieldModule.isRequireUpdate&&(this.pivotGridModule.calculatedFieldModule.endDialog(),this.pivotGridModule.calculatedFieldModule.isRequireUpdate=!1))}},i.prototype.onReadyStateChange=function(t){var i=[],u,r;if("CSV"===this.dataSourceSettings.type)for(u=t.split(/\r?\n|\r/),r=0;r<u.length;r++)n.isNullOrUndefined(u[r])||""===u[r]||i.push(u[r].split(","));else try{i=JSON.parse(t)}catch(t){i=[]}i&&i.length>0&&this.setProperties({dataSourceSettings:{dataSource:i}},!0);this.initialLoad()},i.prototype.initialLoad=function(){var t=this,i={dataSourceSettings:this.dataSourceSettings,defaultFieldListOrder:this.defaultFieldListOrder};this.trigger(as,i,function(r){t.dataSourceSettings=r.dataSourceSettings;t.defaultFieldListOrder=i.defaultFieldListOrder;n.addClass([t.element],eo);t.enableRtl?n.addClass([t.element],ii):n.removeClass([t.element],ii);t.isAdaptive?n.addClass([t.element],ir):n.removeClass([t.element],ir);t.cssClass&&n.addClass([t.element],t.cssClass.split(" "));t.notify(ei,{})})},i.prototype.wireEvent=function(){this.on(ei,this.generateData,this);this.on(wt,this.fieldListRender,this)},i.prototype.unWireEvent=function(){this.pivotGridModule&&this.pivotGridModule.isDestroyed||(this.off(ei,this.generateData),this.off(wt,this.fieldListRender))},i.prototype.getPersistData=function(){return this.addOnPersist(["dataSourceSettings"])},i.prototype.getModuleName=function(){return"pivotfieldlist"},i.prototype.onPropertyChanged=function(i,u){for(var o,f,a=!1,e=0,v=Object.keys(i);e<v.length;e++){o=v[e];switch(o){case"locale":t.prototype.refresh.call(this);break;case"dataSourceSettings":if((n.isNullOrUndefined(i.dataSourceSettings.dataSource)||i.dataSourceSettings.groupSettings&&i.dataSourceSettings.groupSettings.length>0)&&("olap"!==this.dataType||n.isNullOrUndefined(i.dataSourceSettings.url))||("olap"!==this.dataType&&(n.isNullOrUndefined(this.savedDataSourceSettings)||(r.updateDataSourceSettings(this.staticPivotGridModule,this.savedDataSourceSettings),this.savedDataSourceSettings=void 0),i.dataSourceSettings.dataSource&&0===i.dataSourceSettings.dataSource.length&&!n.isNullOrUndefined(this.staticPivotGridModule)&&(this.savedDataSourceSettings=r.getClonedDataSourceSettings(this.staticPivotGridModule.dataSourceSettings),this.staticPivotGridModule.setProperties({dataSourceSettings:{rows:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{columns:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{values:[]}},!0),this.staticPivotGridModule.setProperties({dataSourceSettings:{filters:[]}},!0))),"pivot"===this.dataType?(this.engineModule.fieldList=null,this.engineModule.isEmptyData=!0,this.engineModule.data=[]):"olap"===this.dataType&&(this.olapEngineModule.fieldList={},this.olapEngineModule.fieldListData=void 0,this.olapEngineModule.isEmptyData=!0),n.isNullOrUndefined(this.staticPivotGridModule)||(this.staticPivotGridModule.pivotValues=[]),this.initialLoad()),r.isButtonIconRefesh(o,u,i)){if(this.isPopupView&&this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule){var s=r.cloneFieldSettings(this.dataSourceSettings.filters),h=r.cloneFieldSettings(this.dataSourceSettings.values),c=r.cloneFieldSettings(this.dataSourceSettings.rows),l=r.cloneFieldSettings(this.dataSourceSettings.columns);this.pivotGridModule.setProperties({dataSourceSettings:{rows:c,columns:l,values:h,filters:s}},!0);this.pivotGridModule.axisFieldModule.render()}else this.isPopupView||!this.staticPivotGridModule||this.staticPivotGridModule.isDestroyed||(f=this.staticPivotGridModule,f.showGroupingBar&&f.groupingBarModule&&f.axisFieldModule.render(),f.showFieldList&&f.pivotFieldListModule&&(c=r.cloneFieldSettings(f.dataSourceSettings.rows),l=r.cloneFieldSettings(f.dataSourceSettings.columns),h=r.cloneFieldSettings(f.dataSourceSettings.values),s=r.cloneFieldSettings(f.dataSourceSettings.filters),f.pivotFieldListModule.setProperties({dataSourceSettings:{rows:c,columns:l,values:h,filters:s}},!0),f.pivotFieldListModule.axisFieldModule.render(),f.pivotFieldListModule.treeViewModule.fieldTable&&!f.isAdaptive&&f.pivotFieldListModule.notify(nr,{})));this.axisFieldModule.render();this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(nr,{})}break;case"aggregateTypes":this.axisFieldModule&&this.axisFieldModule.render();this.pivotGridModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({aggregateTypes:i.aggregateTypes},!0),this.pivotGridModule.axisFieldModule.render());break;case"showValuesButton":this.axisFieldModule&&this.axisFieldModule.render();this.pivotGridModule&&this.pivotGridModule.showGroupingBar&&this.pivotGridModule.groupingBarModule&&this.pivotGridModule.axisFieldModule&&(this.pivotGridModule.setProperties({showValuesButton:i.showValuesButton},!0),this.pivotGridModule.axisFieldModule.render());break;case"enableRtl":this.enableRtl?n.addClass([this.element],ii):n.removeClass([this.element],ii);a=!0;break;case"enableFieldSearching":this.refresh()}a&&this.fieldListRender()}},i.prototype.initEngine=function(){var t=this,u,f,e,i;if("pivot"===this.dataType&&(u=n.isNullOrUndefined(this.dataSourceSettings.dataSource)?n.isNullOrUndefined(this.engineModule.data)?void 0:this.engineModule.data[0]:this.dataSourceSettings.dataSource[0],u&&this.pivotCommon)){if(f="[object Array]"===Object.prototype.toString.call(u),f&&"JSON"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidJSON"));if(!f&&"CSV"===this.dataSourceSettings.type)return void this.pivotCommon.errorDialog.createErrorDialog(this.localeObj.getConstant("error"),this.localeObj.getConstant("invalidCSV"))}e={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings)};i=this.isPopupView?this.pivotGridModule:this;i.trigger(ni,e,function(n){var h,o,s,e,u,f;(r.updateDataSourceSettings(t,n.dataSourceSettings),"pivot"===t.dataType)?(t.dataSourceSettings.groupSettings&&t.dataSourceSettings.groupSettings.length>0&&(h=t.dataSourceSettings.dataSource,t.clonedDataSet=t.clonedDataSet?t.clonedDataSet:r.getClonedData(h),o=JSON.parse(t.getPersistData()).dataSourceSettings,o.dataSource=[],t.clonedReport=t.clonedReport?t.clonedReport:o),s=t.frameCustomProperties(),s.enableValueSorting=t.staticPivotGridModule?t.staticPivotGridModule.enableValueSorting:t.enableValueSorting,"Server"!==t.dataSourceSettings.mode&&t.engineModule.renderEngine(t.dataSourceSettings,s,t.aggregateCellInfo?t.getValueCellInfo.bind(t):void 0,t.onHeadersSort?t.getHeaderSortInfo.bind(t):void 0),t.pivotFieldList=t.engineModule.fieldList,e={pivotFieldList:t.pivotFieldList,pivotValues:t.engineModule.pivotValues},u=t,i.trigger(ti,e,function(n){u.pivotFieldList=n.pivotFieldList;u.engineModule.pivotValues=n.pivotValues;u.notify(wt,{});u.trigger(hf)})):"olap"===t.dataType&&(t.olapEngineModule.renderEngine(t.dataSourceSettings,t.frameCustomProperties(t.olapEngineModule.fieldListData,t.olapEngineModule.fieldList),t.onHeadersSort?t.getHeaderSortInfo.bind(t):void 0),t.pivotFieldList=t.olapEngineModule.fieldList,e={pivotFieldList:t.pivotFieldList,pivotValues:t.olapEngineModule.pivotValues},f=t,i.trigger(ti,e,function(n){f.pivotFieldList=n.pivotFieldList;f.olapEngineModule.pivotValues=n.pivotValues;f.notify(wt,{});f.trigger(hf)}))});"None"!==this.defaultFieldListOrder&&this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(nr,{})},i.prototype.generateData=function(){this.pivotFieldList={};this.dataSourceSettings&&(this.dataSourceSettings.dataSource||this.dataSourceSettings.url)?""!==this.dataSourceSettings.url&&"olap"===this.dataType||this.dataSourceSettings.dataSource.length>0?("pivot"===this.dataType&&(this.engineModule.data=this.dataSourceSettings.dataSource),this.initEngine()):this.dataSourceSettings.dataSource instanceof ut.DataManager?"pivot"===this.dataType&&this.remoteData.length>0?(this.engineModule.data=this.remoteData,this.initEngine()):setTimeout(this.getData.bind(this),100):this.notify(wt,{}):(this.notify(wt,{}),this.trigger(hf))},i.prototype.getValueCellInfo=function(n){var t=n;return this.trigger(ys,t),t},i.prototype.getHeaderSortInfo=function(n){var t=n;return this.trigger(su,t),t},i.prototype.getData=function(){this.dataSourceSettings.dataSource.executeQuery(new ut.Query).then(this.executeQuery.bind(this))},i.prototype.executeQuery=function(n){this.engineModule.data=n.result;this.initEngine()},i.prototype.fieldListRender=function(){var t,i;this.element.innerHTML="";"Popup"===this.renderMode&&this.dialogRenderer.fieldListDialog&&!this.dialogRenderer.fieldListDialog.isDestroyed&&(t=this.dialogRenderer.fieldListDialog.visible,this.dialogRenderer.fieldListDialog.destroy(),n.remove(document.getElementById(this.element.id+"_Container")));this.renderModule.render();"Popup"===this.renderMode?(this.fieldListSpinnerElement=this.dialogRenderer.fieldListDialog.element,t&&this.dialogRenderer.fieldListDialog.show()):this.fieldListSpinnerElement=this.element.querySelector(".e-pivotfieldlist-container");this.spinnerTemplate?b.createSpinner({target:this.fieldListSpinnerElement,template:this.spinnerTemplate,cssClass:this.cssClass?this.cssClass:void 0},this.createElement):b.createSpinner({target:this.fieldListSpinnerElement,cssClass:this.cssClass?this.cssClass:void 0},this.createElement);i={pivotEngine:"olap"===this.dataType?this.olapEngineModule:this.engineModule,dataSourceSettings:this.dataSourceSettings,id:this.element.id,element:document.getElementById(this.element.id+"_Container"),moduleName:this.getModuleName(),enableRtl:this.enableRtl,enableHtmlSanitizer:this.enableHtmlSanitizer,isAdaptive:this.isAdaptive,renderMode:this.renderMode,localeObj:this.localeObj,dataType:this.dataType,cssClass:this.cssClass};this.pivotCommon=new ll(i);this.pivotCommon.control=this;this.allowDeferLayoutUpdate&&(this.clonedDataSource=n.extend({},this.dataSourceSettings,null,!0),"olap"===this.dataType&&(this.clonedFieldListData=r.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=r.getClonedFieldList(this.pivotFieldList))},i.prototype.getFieldCaption=function(n){var i,r,u,f,t;if(this.getFields(n),i="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.captionData.length>0&&i&&i.fieldList)for(r=this.captionData.length;r--;)if(this.captionData[r])for(u=0,f=this.captionData[r];u<f.length;u++)t=f[u],t&&i.fieldList[t.name]&&(i.fieldList[t.name].caption=t.caption?t.caption:t.name)},i.prototype.getFields=function(n){this.captionData=[n.rows,n.columns,n.values,n.filters]},i.prototype.updateDataSource=function(t,i){this.pivotGridModule&&this.pivotGridModule.showWaitingPopup();b.showSpinner(this.fieldListSpinnerElement);var u=this,f=u.isPopupView?u.pivotGridModule:u,c=!1,l=u.pivotGridModule&&(u.pivotGridModule.enableVirtualization||u.pivotGridModule.enablePaging)?u.pivotGridModule.pageSettings:void 0,o=Object.keys(u.lastCalcFieldInfo).length>0,e=Object.keys(u.lastSortInfo).length>0,s=Object.keys(u.lastAggregationInfo).length>0,h=Object.keys(u.lastFilterInfo).length>0,a={dataSourceSettings:r.getClonedDataSourceSettings(u.dataSourceSettings)};f.trigger(ni,a,function(a){var y,v;(l&&(e||h||s||o)||(r.updateDataSourceSettings(u,a.dataSourceSettings),r.updateDataSourceSettings(u.pivotGridModule,a.dataSourceSettings)),n.isNullOrUndefined(i))?(y=!e&&(u.pivotGridModule?u.pivotGridModule.enableValueSorting:u.staticPivotGridModule?u.staticPivotGridModule.enableValueSorting:u.enableValueSorting),"pivot"===u.dataType?(v=u.frameCustomProperties(),v.enableValueSorting=y,e?(u.pivotGridModule&&u.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),u.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),v.enableValueSorting=!1):v.enableValueSorting=u.staticPivotGridModule?u.staticPivotGridModule.enableValueSorting:u.enableValueSorting,v.savedFieldList=u.pivotFieldList,l&&(e||h||s||o)&&!u.allowDeferLayoutUpdate?(e&&(u.pivotGridModule.setProperties({dataSourceSettings:{valueSortSettings:{headerText:""}}},!0),"Server"===f.dataSourceSettings.mode?f.getEngine("onSort",null,u.lastSortInfo,null,null,null,null):u.engineModule.onSort(u.lastSortInfo),u.lastSortInfo={}),h&&("Server"===f.dataSourceSettings.mode?f.getEngine("onFilter",null,null,null,null,u.lastFilterInfo,null):u.engineModule.onFilter(u.lastFilterInfo,u.dataSourceSettings),u.lastFilterInfo={}),s&&("Server"===f.dataSourceSettings.mode?f.getEngine("onAggregation",null,null,u.lastAggregationInfo,null,null,null):u.engineModule.onAggregation(u.lastAggregationInfo),u.lastAggregationInfo={}),o&&("Server"===f.dataSourceSettings.mode?f.getEngine("onCalcOperation",null,null,null,u.lastCalcFieldInfo,null,null):u.engineModule.onCalcOperation(u.lastCalcFieldInfo,u.dataSourceSettings),u.lastCalcFieldInfo={})):("Server"===u.dataSourceSettings.mode?e?f.getEngine("onSort",null,u.lastSortInfo,null,null,null,null):s?f.getEngine("onAggregation",null,null,u.lastAggregationInfo,null,null,null):o?f.getEngine("onCalcOperation",null,null,null,u.lastCalcFieldInfo,null,null):h?f.getEngine("onFilter",null,null,null,null,u.lastFilterInfo,null):f.getEngine("onDrop",null,null,null,null,null,null):u.engineModule.renderEngine(u.dataSourceSettings,v,u.aggregateCellInfo?u.getValueCellInfo.bind(u):void 0,u.onHeadersSort?u.getHeaderSortInfo.bind(u):void 0),u.lastSortInfo={},u.lastAggregationInfo={},u.lastCalcFieldInfo={},u.lastFilterInfo={})):c=u.updateOlapDataSource(u,e,o,c),u.getFieldCaption(u.dataSourceSettings)):(u.axisFieldModule.render(),u.isRequiredUpdate=!1);u.enginePopulatedEventMethod(u,t,c)})},i.prototype.enginePopulatedEventMethod=function(t,i,u){var f=this,o=t.isPopupView?t.pivotGridModule:t,s={dataSourceSettings:t.dataSourceSettings,pivotFieldList:"pivot"===t.dataType?t.engineModule.fieldList:t.olapEngineModule.fieldList,pivotValues:"pivot"===t.dataType?t.engineModule.pivotValues:t.olapEngineModule.pivotValues},e;o.trigger(ti,s,function(e){t.dataSourceSettings=e.dataSourceSettings;t.pivotCommon.dataSourceSettings=t.dataSourceSettings;t.pivotFieldList=e.pivotFieldList;"olap"===t.dataType?(t.olapEngineModule.pivotValues=e.pivotValues,t.pivotCommon.engineModule=t.olapEngineModule):(t.engineModule.pivotValues=e.pivotValues,t.pivotCommon.engineModule=t.engineModule);i||!t.treeViewModule.fieldTable||t.isAdaptive||t.notify(nr,{});t.isRequiredUpdate?(t.allowDeferLayoutUpdate&&(t.clonedDataSource=n.extend({},t.dataSourceSettings,null,!0),"olap"===f.dataType&&(f.clonedFieldListData=r.cloneOlapFieldSettings(f.olapEngineModule.fieldListData)),t.clonedFieldList=r.getClonedFieldList(t.pivotFieldList)),t.updateView(t.pivotGridModule)):f.isPopupView&&t.allowDeferLayoutUpdate&&(t.pivotGridModule.engineModule=t.engineModule,t.pivotGridModule.setProperties({dataSourceSettings:t.dataSourceSettings.properties},!0),t.pivotGridModule.notify(oi,t),b.hideSpinner(t.fieldListSpinnerElement));f.isPopupView&&t.pivotGridModule&&t.pivotGridModule.allowDeferLayoutUpdate&&!t.isRequiredUpdate&&(b.hideSpinner(t.fieldListSpinnerElement),t.pivotGridModule.hideWaitingPopup());t.isRequiredUpdate=!0;!t.pivotGridModule||u?b.hideSpinner(t.fieldListSpinnerElement):t.pivotGridModule.fieldListSpinnerElement=t.fieldListSpinnerElement});e=this.getActionCompleteName();this.actionObj.actionName=e;this.actionObj.actionName&&this.actionCompleteMethod()},i.prototype.updateOlapDataSource=function(n,t,i,r){var u=n.frameCustomProperties(n.olapEngineModule.fieldListData,n.olapEngineModule.fieldList);return u.savedFieldList=n.pivotFieldList,i||t?(n.olapEngineModule.savedFieldList=n.pivotFieldList,n.olapEngineModule.savedFieldListData=n.olapEngineModule.fieldListData,i?(n.olapEngineModule.updateCalcFields(n.dataSourceSettings,n.lastCalcFieldInfo),n.lastCalcFieldInfo={},r=!n.olapEngineModule.dataFields[n.lastCalcFieldInfo.name],n.pivotGridModule&&n.pivotGridModule.hideWaitingPopup()):n.olapEngineModule.onSort(n.dataSourceSettings)):n.olapEngineModule.renderEngine(n.dataSourceSettings,u,n.onHeadersSort?n.getHeaderSortInfo.bind(n):void 0),n.lastSortInfo={},n.lastAggregationInfo={},n.lastCalcFieldInfo={},n.lastFilterInfo={},r},i.prototype.update=function(t){t&&(this.clonedDataSet=t.clonedDataSet,this.clonedReport=t.clonedReport,this.setProperties({dataSourceSettings:t.dataSourceSettings,showValuesButton:t.showValuesButton},!0),this.engineModule=t.engineModule,this.olapEngineModule=t.olapEngineModule,this.dataType=t.dataType,this.pivotFieldList="olap"===this.dataType?t.olapEngineModule.fieldList:t.engineModule.fieldList,this.isPopupView?this.pivotGridModule=t:this.staticPivotGridModule=t,this.getFieldCaption(t.dataSourceSettings),this.pivotCommon.engineModule="olap"===this.dataType?this.olapEngineModule:this.engineModule,this.pivotCommon.dataSourceSettings=this.dataSourceSettings,this.pivotCommon.control=this,this.treeViewModule.fieldTable&&!this.isAdaptive&&this.notify(nr,{}),this.axisFieldModule.render(),!this.isPopupView&&this.allowDeferLayoutUpdate&&(this.clonedDataSource=n.extend({},this.dataSourceSettings,null,!0),"olap"===this.dataType&&(this.clonedFieldListData=r.cloneOlapFieldSettings(this.olapEngineModule.fieldListData)),this.clonedFieldList=r.getClonedFieldList(this.pivotFieldList)))},i.prototype.updateView=function(n){var t,i;n&&(t="Calculated field applied"===this.actionObj.actionName&&"olap"===n.dataType,n.element.querySelector(".e-spin-hide")&&!t&&(!this.allowDeferLayoutUpdate||this.isDeferUpdateApplied||n.isInitial)&&n.showWaitingPopup(),n.clonedDataSet=this.clonedDataSet,n.clonedReport=this.clonedReport,n.setProperties({dataSourceSettings:this.dataSourceSettings,showValuesButton:this.showValuesButton},!0),n.engineModule=this.engineModule,n.olapEngineModule=this.olapEngineModule,n.dataType=this.dataType,this.pivotChange||(n.pivotValues="olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues),i={dataSourceSettings:r.getClonedDataSourceSettings(n.dataSourceSettings),pivotValues:n.pivotValues},n.trigger("fieldListRefreshed",i),this.isPopupView||(this.staticPivotGridModule=n,n.isStaticRefresh=!0),this.isDeferUpdateApplied=!1,this.staticPivotGridModule&&(this.staticPivotGridModule.isServerWaitingPopup=!0),n.dataBind())},i.prototype.triggerPopulateEvent=function(){var n=this,t=this.isPopupView?this.pivotGridModule:this,i={dataSourceSettings:this.dataSourceSettings,pivotFieldList:"olap"===this.dataType?this.olapEngineModule.fieldList:this.engineModule.fieldList,pivotValues:"olap"===this.dataType?this.olapEngineModule.pivotValues:this.engineModule.pivotValues};t.trigger(ti,i,function(t){n.dataSourceSettings=t.dataSourceSettings;n.pivotFieldList=t.pivotFieldList;"olap"===n.dataType?n.olapEngineModule.pivotValues=t.pivotValues:n.engineModule.pivotValues=t.pivotValues})},i.prototype.actionBeginMethod=function(){var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,cancel:!1};return(this.isPopupView?this.pivotGridModule:this).trigger(ds,n),n.cancel},i.prototype.actionCompleteMethod=function(){var n={dataSourceSettings:r.getClonedDataSourceSettings(this.dataSourceSettings),actionName:this.actionObj.actionName,fieldInfo:this.actionObj.fieldInfo,actionInfo:this.actionObj.actionInfo};(this.isPopupView?this.pivotGridModule:this).trigger(gs,n);this.actionObj.actionName="";this.actionObj.actionInfo=void 0;this.actionObj.fieldInfo=void 0},i.prototype.actionFailureMethod=function(n){var t={actionName:this.actionObj.actionName,errorInfo:n};(this.isPopupView?this.pivotGridModule:this).trigger(nh,t)},i.prototype.getActionCompleteName=function(){return this.actionObj.actionName===io?uo:this.actionObj.actionName===pf?fo:this.actionObj.actionName===no?hh:this.actionObj.actionName===to?ch:this.actionObj.actionName===wf?lh:this.actionObj.actionName===bf?ah:this.actionObj.actionName===uh?"Field tree sorted":this.actionObj.actionName},i.prototype.destroy=function(){this.unWireEvent();this.engineModule&&!this.destroyEngine&&(this.engineModule.fieldList={},this.engineModule.rMembers=null,this.engineModule.cMembers=null,this.engineModule.valueMatrix=null,this.engineModule.indexMatrix=null,this.engineModule={});this.olapEngineModule&&!this.destroyEngine&&(this.olapEngineModule.fieldList={},this.olapEngineModule={});this.pivotFieldList&&(this.pivotFieldList={});this.captionData&&(this.captionData=null);this.contextMenuModule&&this.contextMenuModule.destroy();this.treeViewModule&&this.treeViewModule.destroy();this.pivotButtonModule&&this.pivotButtonModule.destroy();this.pivotCommon&&this.pivotCommon.destroy();this.dialogRenderer&&this.dialogRenderer.destroy();this.calculatedFieldModule&&this.calculatedFieldModule.destroy();t.prototype.destroy.call(this);this.contextMenuModule&&(this.contextMenuModule=null);this.treeViewModule&&(this.treeViewModule=null);this.pivotButtonModule&&(this.pivotButtonModule=null);this.pivotCommon&&(this.pivotCommon=null);this.dialogRenderer&&(this.dialogRenderer=null);this.calculatedFieldModule&&(this.calculatedFieldModule=null);this.axisFieldModule&&(this.axisFieldModule=null);this.axisTableModule&&(this.axisTableModule=null);this.renderModule&&(this.renderModule=null);this.clonedDataSet&&(this.clonedDataSet=null);this.clonedReport&&(this.clonedReport=null);this.clonedFieldList&&(this.clonedFieldList=null);this.clonedFieldListData&&(this.clonedFieldListData=null);this.localeObj&&(this.localeObj=null);this.defaultLocale&&(this.defaultLocale=null);this.element.innerHTML="";n.removeClass([this.element],eo);n.removeClass([this.element],ii);n.removeClass([this.element],ir)},p([n.Complex({},al)],i.prototype,"dataSourceSettings",void 0),p([n.Property("Popup")],i.prototype,"renderMode",void 0),p([n.Property()],i.prototype,"target",void 0),p([n.Property("")],i.prototype,"cssClass",void 0),p([n.Property(!1)],i.prototype,"enableHtmlSanitizer",void 0),p([n.Property(!1)],i.prototype,"allowCalculatedField",void 0),p([n.Property(!1)],i.prototype,"enableFieldSearching",void 0),p([n.Property(!1)],i.prototype,"showValuesButton",void 0),p([n.Property(!1)],i.prototype,"allowDeferLayoutUpdate",void 0),p([n.Property(1e3)],i.prototype,"maxNodeLimitInMemberEditor",void 0),p([n.Property(!0)],i.prototype,"loadOnDemandInMemberEditor",void 0),p([n.Property()],i.prototype,"spinnerTemplate",void 0),p([n.Property(["Sum","Count","DistinctCount","Product","Min","Max","Avg","Median","Index","PopulationVar","SampleVar","PopulationStDev","SampleStDev","RunningTotals","PercentageOfGrandTotal","PercentageOfColumnTotal","PercentageOfRowTotal","PercentageOfParentColumnTotal","PercentageOfParentRowTotal","DifferenceFrom","PercentageOfDifferenceFrom","PercentageOfParentTotal"])],i.prototype,"aggregateTypes",void 0),p([n.Property("USD")],i.prototype,"currencyCode",void 0),p([n.Event()],i.prototype,"load",void 0),p([n.Event()],i.prototype,"enginePopulating",void 0),p([n.Event()],i.prototype,"memberFiltering",void 0),p([n.Event()],i.prototype,"enginePopulated",void 0),p([n.Event()],i.prototype,"onFieldDropped",void 0),p([n.Event()],i.prototype,"fieldDrop",void 0),p([n.Event()],i.prototype,"fieldDragStart",void 0),p([n.Event()],i.prototype,"aggregateCellInfo",void 0),p([n.Event()],i.prototype,"memberEditorOpen",void 0),p([n.Event()],i.prototype,"calculatedFieldCreate",void 0),p([n.Event()],i.prototype,"aggregateMenuOpen",void 0),p([n.Event()],i.prototype,"fieldRemove",void 0),p([n.Event()],i.prototype,"dataBound",void 0),p([n.Event()],i.prototype,"created",void 0),p([n.Event()],i.prototype,"destroyed",void 0),p([n.Event()],i.prototype,"beforeServiceInvoke",void 0),p([n.Event()],i.prototype,"afterServiceInvoke",void 0),p([n.Event()],i.prototype,"actionBegin",void 0),p([n.Event()],i.prototype,"actionComplete",void 0),p([n.Event()],i.prototype,"actionFailure",void 0),p([n.Event()],i.prototype,"onHeadersSort",void 0),p([n.NotifyPropertyChanges],i)}(n.Component),eu="Count",ia="Median",ae="Sum",ve="DistinctCount",ra="Product",ua="SampleStDev",fa="PopulationStDev",ea="SampleVar",oa="PopulationVar",ct="CalculatedField",hp=function(){function t(n){this.isFormula=!1;this.isRequireUpdate=!1;this.formatTypes=["Standard","Currency","Percent","Custom","None"];this.parent=n;this.existingReport=null;this.parent.calculatedFieldModule=this;this.removeEventListener();this.addEventListener();this.parentID=this.parent.element.id;this.dialog=null;this.inputObj=null;this.treeObj=null;this.droppable=null;this.menuObj=null;this.newFields=null;this.isFieldExist=!0;this.formulaText=null;this.fieldText=null;this.formatText=null;this.formatType=null;this.fieldType=null;this.parentHierarchy=null;this.isEdit=!1;this.currentFieldName=null;this.confirmPopUp=null}return t.prototype.getModuleName=function(){return"calculatedField"},t.prototype.keyActionHandler=function(t){var i=t.currentTarget.querySelector(".e-node-focus");if(i)switch(t.action){case"moveRight":case"shiftE":"pivot"===this.parent.dataType&&this.displayMenu(i);break;case"delete":"LI"===i.tagName&&!i.querySelector(".e-list-icon.e-format")&&!i.querySelector(".e-list-icon").classList.contains(".e-icons")&&i.querySelector("."+vt)&&i.querySelector("."+vt).classList.contains("e-list-icon")&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,i);break;case"enter":var u=i.getAttribute("data-field"),f=i.getAttribute("data-type"),r=n.select("#"+this.parentID+"droppable",this.dialog.element);"pivot"===this.parent.dataType?""===r.value?r.value=f===ct?i.getAttribute("data-uid"):'"'+f+"("+u+')"':""!==r.value&&(r.value=f===ct?r.value+i.getAttribute("data-uid"):r.value+'"'+f+"("+u+')"'):(this.parent.olapEngineModule&&this.parent.olapEngineModule.fieldList[u]&&this.parent.olapEngineModule.fieldList[u].isCalculatedField&&(u=this.parent.olapEngineModule.fieldList[u].tag),""===r.value?r.value=u:""!==r.value&&(r.value=r.value+u))}},t.prototype.fieldClickHandler=function(t){var i=n.closest(t.event.target,"li");(t.event.target.classList.contains(ki)||t.event.target.classList.contains(k)||t.event.target.classList.contains(nt)||t.event.target.classList.contains(vt))&&(this.parent.isAdaptive?"olap"===this.parent.dataType&&this.parent.isAdaptive&&("LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(k)&&t.event.target.classList.contains(k)?(this.isEdit=!0,this.currentFieldName=i.getAttribute("data-field"),this.fieldText=i.getAttribute("data-caption"),this.formulaText=i.getAttribute("data-formula"),this.formatType=i.getAttribute("data-formatString"),this.formatText="Custom"===this.formatType?i.getAttribute("data-customformatstring"):null,this.fieldType=i.getAttribute("data-membertype"),this.parentHierarchy="Dimension"===this.fieldType?i.getAttribute("data-hierarchy"):null,n.addClass([i.querySelector(".e-list-edit-icon")],nt),n.removeClass([i.querySelector(".e-list-edit-icon")],k),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):"LI"===i.tagName&&i.querySelector(".e-list-edit-icon").classList.contains(nt)&&t.event.target.classList.contains(nt)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,this.parentHierarchy=this.fieldType=this.formatType=null,n.addClass([i.querySelector(".e-list-edit-icon")],k),n.removeClass([i.querySelector(".e-list-edit-icon")],nt)):"LI"===i.tagName&&i.querySelector("."+vt).classList.contains("e-icons")&&t.event.target.classList.contains(vt)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,t.node)):this.displayMenu(i,t.node,t.event.target))},t.prototype.accordionClickHandler=function(t){var o,s;if(t.item&&-1!==t.item.iconCss.indexOf("e-list-icon")&&n.closest(t.originalEvent.target,".e-acrdn-header-icon")){var e=n.closest(t.originalEvent.target,".e-acrdn-header").querySelector("."+ac),f=e.getAttribute("data-field"),h=e.getAttribute("data-caption"),u=r.getFieldByName(f,this.parent.dataSourceSettings.formatSettings),i=n.closest(t.originalEvent.target,".e-acrdn-header-icon");u&&(o=this.getFormat(u.format),s=o?this.formatTypes.indexOf(o)>-1?u.format:"Custom":"None",this.formatType=s);i.querySelector("."+k)&&t.originalEvent.target.classList.contains(k)?(this.isEdit=!0,this.currentFieldName=f,this.fieldText=h||f,this.formulaText=this.parent.engineModule.fieldList[f].formula,this.formatText=u?u.format:"",n.addClass([i.querySelector(".e-list-icon")],nt),n.removeClass([i.querySelector(".e-list-icon")],k),this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)):i.querySelector("."+nt)&&t.originalEvent.target.classList.contains(nt)?(this.isEdit=!1,this.fieldText=this.formatText=this.formulaText=this.currentFieldName=null,n.addClass([i.querySelector(".e-list-icon")],k),n.removeClass([i.querySelector(".e-list-icon")],nt)):i.querySelector("."+vt)&&t.originalEvent.target.classList.contains(vt)&&this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),{},!0,e)}},t.prototype.accordionCreated=function(){for(var r,i=this.accordion.element.querySelectorAll(".e-acrdn-item"),t=0;t<i.length;t++)(i[t].querySelector("."+k)||i[t].querySelector("."+nt))&&(r=n.createElement("span",{className:"e-list-icon "+vt+" e-icons"}),n.append([r],i[t].querySelector(".e-acrdn-header-icon")),n.addClass([i[t]],"e-select"))},t.prototype.clearFormula=function(){this.treeObj&&this.treeObj.element.querySelector("li")&&(n.removeClass(this.treeObj.element.querySelectorAll("li"),"e-active"),this.displayMenu(this.treeObj.element.querySelector("li")))},t.prototype.displayMenu=function(t,i,r){var c=!r||r.classList.contains(k),l=!r||r.classList.contains(nt),a,v,d,g;try{if("pivot"!==this.parent.dataType||!t.querySelector(".e-list-icon.e-format")||!t.querySelector(".e-list-icon.e-format").classList.contains(e)||t.querySelector(".e-list-icon").classList.contains(nt)||t.querySelector(".e-list-icon").classList.contains(vt)||t.querySelector(".e-list-icon").classList.contains(k)||"LI"!==t.tagName){if("LI"===t.tagName&&(t.querySelector("."+k)&&t.querySelector("."+k).classList.contains("e-list-icon")&&c||"olap"===this.parent.dataType&&t.getAttribute("data-type")===ct&&t.classList.contains("e-active")&&(r&&!r.classList.contains(vt)||!r))){this.isEdit=!0;a=t.getAttribute("data-field");v=t.getAttribute("data-caption");this.currentFieldName=a;this.inputObj.value=v;this.inputObj.dataBind();var p=t.getAttribute("data-formatString"),u=this.dialog.element,o=n.getInstance(n.select("#"+this.parentID+"Format_Div",u),y.DropDownList),s=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",u),it.MaskedTextBox),tt=t.getAttribute("data-customformatstring");if("olap"===this.parent.dataType){var w=t.getAttribute("data-membertype"),rt=t.getAttribute("data-hierarchy"),ut=t.getAttribute("data-formula"),b=n.select("#"+this.parentID+"_FieldNameTitle",u),f=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",u),y.DropDownList),h=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",u),y.DropDownList);b.innerText=this.parent.localeObj.getConstant("caption");n.select("#"+this.parentID+"droppable",document).value=ut;f.readonly=!0;f.value=w;f.dataBind();"Dimension"===w&&(h.value=rt)}else n.addClass(this.treeObj.element.querySelectorAll("."+nt),k),n.removeClass(this.treeObj.element.querySelectorAll("."+nt),nt),n.addClass([t.querySelector(".e-list-icon")],nt),n.removeClass([t.querySelector(".e-list-icon")],k),t.querySelector("."+nt).setAttribute("title",this.parent.localeObj.getConstant("clearCalculatedField")),n.select("#"+this.parentID+"droppable",document).value=t.getAttribute("data-uid");""!==p&&(o.value=p,o.dataBind());s.value=tt;s.dataBind()}else if("LI"===t.tagName&&(t.querySelector("."+nt)&&t.querySelector("."+nt).classList.contains("e-list-icon")&&l||"olap"===this.parent.dataType&&!t.classList.contains("e-active")))this.isEdit=!1,this.inputObj.value="",this.inputObj.dataBind(),u=this.dialog.element,(s=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",u),it.MaskedTextBox)).value="",s.dataBind(),"olap"===this.parent.dataType?(h=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",u),y.DropDownList),o=n.getInstance(n.select("#"+this.parentID+"Format_Div",u),y.DropDownList),f=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",u),y.DropDownList),(b=n.select("#"+this.parentID+"_FieldNameTitle",u)).innerText=this.parent.localeObj.getConstant("fieldTitle"),h.index=0,h.dataBind(),o.index=0,o.dataBind(),f.index=0,f.readonly=!1,f.dataBind()):(n.addClass(this.treeObj.element.querySelectorAll("."+nt),k),n.removeClass(this.treeObj.element.querySelectorAll("."+nt),nt),t.querySelector("."+k).setAttribute("title",this.parent.localeObj.getConstant("edit"))),n.select("#"+this.parentID+"droppable",document).value="";else if("LI"===t.tagName&&t.querySelector("."+vt)&&t.querySelector("."+vt).classList.contains("e-list-icon")&&!c&&!l){if(this.parent.actionObj.actionName=wf,this.parent.actionBeginMethod())return;d=n.select("#"+this.parentID+"droppable",document);g={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:d.value};this.createConfirmDialog(this.parent.localeObj.getConstant("alert"),this.parent.localeObj.getConstant("removeCalculatedField"),g,!0,i)}}else this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy(),this.curMenu=t.querySelector("."+dt),this.openContextMenu(t)}catch(t){this.parent.actionFailureMethod(t)}},t.prototype.removeCalcField=function(n){var i,u=this.parent.dataSourceSettings,r=n.getAttribute("data-field"),f=u.calculatedFieldSettings,t,h,a,y,e,o,p,s,w;for("pivot"===this.parent.dataType&&(this.parent.isAdaptive?"number"==typeof(h=parseInt(n.getAttribute("id").split(this.parentID+"_")[1],10))&&this.accordion.hideItem(h):this.treeObj.removeNodes([n])),t=0;t<f.length;t++)if(f[t]&&f[t].name===r){f.splice(t,1);break}if("olap"===this.parent.dataType){for(var c=(i=this.parent.olapEngineModule).fieldListData?i.fieldListData:[],l=0,v=Object.keys(c);l<v.length;l++)if(a=v[l],c[a].name===r&&"number"==typeof(h=parseInt(a,10))){c.splice(h,1);break}y=this.treeObj.getNode(n).parentID;this.treeObj.removeNodes([n]);f.length<=0&&this.treeObj.removeNodes([y])}else i=this.parent.engineModule;if(i.fields)for(t=0;t<i.fields.length;t++)if(i.fields[t]===r){i.fields.splice(t,1);break}for(i.savedFieldList&&i.savedFieldList[r]&&delete i.savedFieldList[r],i.fieldList&&i.fieldList[r]&&delete i.fieldList[r],e=u.formatSettings,t=0;t<e.length;t++)if(e[t]&&e[t].name===r){e.splice(t,1);break}for(o=[u.values,u.rows,u.columns,u.filters],p=(t=0,o.length);t<p;t++)for(s=0,w=o[t].length;s<w;s++)if(o[t][s].name===r){o[t].splice(s,1);break}this.isEdit&&this.currentFieldName===r&&(this.isEdit=!1,this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null);this.parent.allowDeferLayoutUpdate&&"pivotfieldlist"===this.parent.getModuleName()||this.parent.updateDataSource();this.closeErrorDialog()},t.prototype.openContextMenu=function(n){var t=this,i=n.getAttribute("data-field"),r="number"!==this.parent.engineModule.fieldList[i].type?"string":"number",u="string"===r?this.getValidSummaryType().slice(0,2):this.getValidSummaryType(),f={cancel:!1,fieldName:i,aggregateTypes:this.getMenuItems(r).slice()};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger(ge,f,function(i){var r,f,o;if(!i.cancel){for(var s=[],h=[],e=0,c=i.aggregateTypes;e<c.length;e++)r=c[e],u.indexOf(r)>-1&&-1===s.indexOf(r)&&(s.push(r),h.push({id:t.parent.element.id+"Calc_"+r,text:t.parent.localeObj.getConstant(r)}));t.createMenu(h,n);f=n.getBoundingClientRect();o=window.scrollY||document.documentElement.scrollTop;t.parent.enableRtl?t.menuObj.open(f.top+o,f.left-100):t.menuObj.open(f.top+o,f.left+150)}})},t.prototype.selectContextMenu=function(t){if(null!==t.element.textContent){var i=n.closest(this.curMenu,".e-list-item").getAttribute("data-caption");n.closest(this.curMenu,".e-list-item").setAttribute("data-type",t.element.id.split("_").pop());this.curMenu.textContent=i+" ("+t.element.textContent+")";n.addClass([this.curMenu.parentElement.parentElement],["e-node-focus","e-hover"]);this.curMenu.parentElement.parentElement.setAttribute("tabindex","0");this.curMenu.parentElement.parentElement.focus()}},t.prototype.createMenu=function(t,i){var r,u=this,f={cssClass:this.parentID+"calculatedmenu"+(this.parent.cssClass?" "+this.parent.cssClass:""),items:t,enableRtl:this.parent.enableRtl,locale:this.parent.locale,select:this.selectContextMenu.bind(this),onClose:function(){u.treeObj.element.focus();n.addClass([i],["e-hover","e-node-focus"])}};r=n.select("#"+this.parentID+"CalcContextmenu",document)?n.select("#"+this.parentID+"CalcContextmenu",document):n.createElement("ul",{id:this.parentID+"CalcContextmenu"});this.dialog.element.appendChild(r);this.menuObj=new st.ContextMenu(f);this.menuObj.isStringTemplate=!0;this.menuObj.appendTo(r)},t.prototype.applyFormula=function(){var t=this,i=this,u=!1,f;n.removeClass([document.getElementById(this.parentID+"ddlelement")],es);this.newFields=n.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);f={fieldName:this.isEdit?this.currentFieldName:this.inputObj.value,calculatedField:this.getCalculatedFieldInfo(),calculatedFieldSettings:r.cloneCalculatedFieldSettings(this.parent.dataSourceSettings.calculatedFieldSettings),cancel:!1};("pivotfieldlist"===this.parent.getModuleName()&&this.parent.isPopupView?this.parent.pivotGridModule:this.parent).trigger("calculatedFieldCreate",f,function(r){var f,o,c,y,p,e,l,b,a,s,v,h;if(r.cancel)t.endDialog(),t.parent.lastCalcFieldInfo={},t.isFormula=!1;else{if(f=r.calculatedField,!t.isEdit)if("olap"===i.parent.dataType)o=f.name,i.parent.olapEngineModule.fieldList[o]&&"CalculatedField"!==i.parent.olapEngineModule.fieldList[o].type&&(u=!0);else for(c=0,y=Object.keys(i.parent.engineModule.fieldList);c<y.length;c++)p=y[c],f.name&&f.name===p&&"CalculatedField"!==i.parent.engineModule.fieldList[p].aggregateType&&(u=!0);if(u)return void i.parent.pivotCommon.errorDialog.createErrorDialog(i.parent.localeObj.getConstant("error"),i.parent.localeObj.getConstant("fieldExist"));if(t.existingReport=n.extend({},t.parent.dataSourceSettings,null,!0),e=t.parent.dataSourceSettings,n.isNullOrUndefined(f.name)||""===f.name||n.isNullOrUndefined(f.caption)||""===f.caption||!f.formula||""===f.formula)n.isNullOrUndefined(f.name)||""===f.name||n.isNullOrUndefined(f.caption)||""===f.caption?(t.inputObj.value="",n.addClass([document.getElementById(t.parentID+"ddlelement")],es),document.getElementById(t.parentID+"ddlelement").focus()):t.parent.pivotCommon.errorDialog.createErrorDialog(t.parent.localeObj.getConstant("error"),t.parent.localeObj.getConstant("invalidFormula"));else{if(o=void 0,"olap"===t.parent.dataType){if(o={name:f.name,formula:f.formula,formatString:f.formatString},n.isNullOrUndefined(f.hierarchyUniqueName)||(o.hierarchyUniqueName=f.hierarchyUniqueName),t.isFieldExist=!1,t.isEdit){for(s=0;s<e.calculatedFieldSettings.length;s++)if(e.calculatedFieldSettings[s].name===o.name&&t.isEdit){e.calculatedFieldSettings[s].hierarchyUniqueName=f.hierarchyUniqueName;t.parent.olapEngineModule.fieldList[o.name].caption=f.caption;e.calculatedFieldSettings[s].formatString=o.formatString;e.calculatedFieldSettings[s].formula=o.formula;o=e.calculatedFieldSettings[s];t.isFieldExist=!0;break}for(var k=!1,w=0,d=[e.rows,e.columns,e.values,e.filters];w<d.length;w++){for(l=0,b=d[w];l<b.length;l++)if(a=b[l],a.isCalculatedField&&null!==o.name&&a.name===o.name&&t.isEdit){a.caption=f.caption;t.isFieldExist=!0;k=!0;break}if(k)break}}else for(s=0;s<e.calculatedFieldSettings.length;s++)if(e.calculatedFieldSettings[s].name===o.name)return void t.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),f);t.isFieldExist||e.calculatedFieldSettings.push(o);t.parent.lastCalcFieldInfo=o}else{if(o={name:f.name,caption:f.caption,type:"CalculatedField"},v={name:f.name,formula:f.formula},n.isNullOrUndefined(f.formatString)||(v.formatString=f.formatString),t.isFieldExist=!0,t.isEdit){for(s=0;s<e.values.length;s++)if(e.values[s].type===ct&&null!==o.name&&e.values[s].name===o.name&&t.isEdit)for(h=0;h<e.calculatedFieldSettings.length;h++)e.calculatedFieldSettings[h].name===o.name&&(e.values[s].caption=f.caption,t.currentFormula=e.calculatedFieldSettings[h].formula,e.calculatedFieldSettings[h].formula=f.formula,t.parent.engineModule.fieldList[o.name].caption=f.caption,t.updateFormatSettings(e,o.name,f.formatString),t.isFieldExist=!1)}else for(s=0;s<e.values.length;s++)if(e.values[s].type===ct&&e.values[s].name===o.name){for(h=0;h<e.calculatedFieldSettings.length;h++)if(e.calculatedFieldSettings[h].name===o.name)return void t.createConfirmDialog(i.parent.localeObj.getConstant("alert"),i.parent.localeObj.getConstant("confirmText"),f);t.isFieldExist=!1}t.isFieldExist&&(e.values.push(o),e.calculatedFieldSettings.push(v),t.updateFormatSettings(e,o.name,f.formatString));t.parent.lastCalcFieldInfo=v}t.addFormula(e,o.name)}}})},t.prototype.getCalculatedFieldInfo=function(){var e=n.select("#"+this.parentID+"droppable",document),t=this.parent.isAdaptive?this.parent.dialogRenderer.adaptiveElement.element:this.dialog.element,o=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",t),it.MaskedTextBox),i={name:this.isEdit?this.currentFieldName:this.inputObj.value,caption:this.inputObj.value,formula:e.value},r=n.getInstance(n.select("#"+this.parentID+"Format_Div",t),y.DropDownList),u,f;return(i.formatString="Custom"===r.value?o.value:"None"===r.value?null:r.value,"olap"===this.parent.dataType)&&(u=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",t),y.DropDownList),f=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",t),y.DropDownList),"Dimension"===u.value&&(i.hierarchyUniqueName=f.value)),i},t.prototype.updateFormatSettings=function(t,i,r){for(var e,o={name:i,format:r,useGrouping:!0},f=!1,u=0;u<t.formatSettings.length;u++)if(t.formatSettings[u].name===i){if("undefined"===r||void 0===r||""===r){t.formatSettings.splice(u,1);f=!0;break}e=t.formatSettings[u].properties?t.formatSettings[u].properties:t.formatSettings[u];e.format=r;t.formatSettings.splice(u,1,e);f=!0;break}f||""===r||n.isNullOrUndefined(r)||t.formatSettings.push(o)},t.prototype.addFormula=function(n,t){var u,f,i;this.isFormula=!0;this.field=t;"Server"===this.parent.dataSourceSettings.mode?r.updateDataSourceSettings(this.parent,r.getClonedDataSourceSettings(n)):this.parent.setProperties({dataSourceSettings:n},!0);"pivotfieldlist"===this.parent.getModuleName()&&this.parent.allowDeferLayoutUpdate&&(this.parent.isRequiredUpdate=!1);try{u={calculatedFieldInfo:this.parent.lastCalcFieldInfo};this.parent.actionObj.actionInfo=u;f=this.parent.actionObj.actionName===pf?fo:uo;this.parent.actionObj.actionName=f;this.parent.updateDataSource(!1);i="pivotfieldlist"===this.parent.getModuleName()&&this.parent.pivotGridModule?this.parent.pivotGridModule:this.parent;i&&"Server"!==i.dataSourceSettings.mode?this.endDialog():this.isRequireUpdate=!0;"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode&&this.parent.allowDeferLayoutUpdate&&(this.parent.pivotChange=!0)}catch(n){this.showError()}},t.prototype.endDialog=function(){var t,i,r,u,f;(this.isEdit=!1,this.dialog)?this.dialog.close():(this.inputObj.value="",this.currentFieldName=this.formatText=this.fieldText=this.formatType=null,this.formulaText=this.fieldType=this.parentHierarchy=null,t=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,(this.parent.dialogRenderer.parentElement.querySelector("."+oe).value="",n.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value="",n.select("#"+this.parentID+"Custom_Format_Element",this.parent.dialogRenderer.parentElement).value="","olap"===this.parent.dataType)&&(i=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",t),y.DropDownList),r=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",t),y.DropDownList),i.index=0,i.readonly=!1,i.dataBind(),r.index=0,r.enabled=!1,r.dataBind()),u=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",t),it.MaskedTextBox),f=n.getInstance(n.select("#"+this.parentID+"Format_Div",t),y.DropDownList),f.index="olap"===this.parent.dataType?0:4,f.dataBind(),u.enabled=!1,u.dataBind())},t.prototype.showError=function(){if(this.parent.engineModule.fieldList[this.field]&&delete this.parent.engineModule.fieldList[this.field],this.parent.pivotCommon.errorDialog.createErrorDialog(this.parent.localeObj.getConstant("error"),this.parent.localeObj.getConstant("invalidFormula")),this.parent.setProperties({dataSourceSettings:this.existingReport},!0),this.isEdit){for(var t=this.parent.dataSourceSettings.calculatedFieldSettings,n=0;t&&n<t.length;n++)if(t[n].name===this.field){t[n].formula=this.currentFormula;break}}else if(this.parent.engineModule.fields)for(n=0;n<this.parent.engineModule.fields.length;n++)if(this.parent.engineModule.fields[n]===this.field){this.parent.engineModule.fields.splice(n,1);break}this.parent.lastCalcFieldInfo={};this.parent.updateDataSource(!1);this.isFormula=!1},t.prototype.getFieldListData=function(t){var h=[],o,c,u,s,l,v,a,f,i;if("olap"===this.parent.dataType)for(o=0,c=h=r.getClonedData(t.olapEngineModule.fieldListData?t.olapEngineModule.fieldListData:[]);o<c.length;o++)u=c[o],u.spriteCssClass&&(u.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||u.spriteCssClass.indexOf("e-level-members")>-1)?u.hasChildren=!0:u.spriteCssClass&&u.spriteCssClass.indexOf("e-namedSetCDB-icon")>-1?u.hasChildren=!1:u.spriteCssClass&&u.spriteCssClass.indexOf("e-calcMemberGroupCDB")>-1&&(u.expanded=this.isEdit);else for(s=0,l=t.engineModule.fieldList?Object.keys(t.engineModule.fieldList):[];s<l.length;s++)f=l[s],i=t.engineModule.fieldList[f],a="number"===i.type&&"include"!==t.engineModule.fieldList[f].type&&"exclude"!==t.engineModule.fieldList[f].type||"DistinctCount"===i.aggregateType?void 0!==i.aggregateType?i.aggregateType:ae:eu,v=this.parent.localeObj.getConstant(a),h.push({index:i.index,name:(this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(i.caption):i.caption)+" ("+v+")",type:a,icon:ki+" "+e,formula:this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(i.formula):i.formula,field:this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(f):f,caption:this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(i.caption?i.caption:f):i.caption?i.caption:f});return h},t.prototype.fieldDropped=function(t){var i,r,o,f;if(t.cancel=!0,i=n.select("#"+this.parentID+"droppable",this.dialog.element),n.removeClass([i],"e-copy-drop"),n.removeClass([t.draggedNode.querySelector("."+dt)],tu),r=t.draggedNode.getAttribute("data-field"),"olap"===this.parent.dataType)if(this.parent.olapEngineModule.fieldList[r]&&this.parent.olapEngineModule.fieldList[r].isCalculatedField&&(r=this.parent.olapEngineModule.fieldList[r].tag),t.target.id===this.parentID+"droppable"&&""===i.value)i.value=r,i.focus();else if(t.target.id===this.parentID+"droppable"&&""!==i.value){var e=i.value,s=i.selectionStart,h=e.substring(s,e.length),u=(f=e.substring(0,s))+r;i.value=f+r+h;i.focus();i.setSelectionRange(u.length,u.length)}else t.cancel=!0;else o=t.draggedNode.getAttribute("data-type"),t.target.id===this.parentID+"droppable"&&""===i.value?(i.value=o===ct?t.draggedNodeData.id.toString():'"'+o+"("+r+')"',i.focus()):t.target.id===this.parentID+"droppable"&&""!==i.value?(u=void 0,s=i.selectionStart,f=(e=i.value).substring(0,s),h=e.substring(s,e.length),o===ct?(u=f+t.draggedNodeData.id.toString(),i.value=f+t.draggedNodeData.id.toString()+h):(u=f+'"'+o+"("+r+')"',i.value=f+'"'+o+"("+r+')"'+h),i.focus(),i.setSelectionRange(u.length,u.length)):t.cancel=!0},t.prototype.createDialog=function(){var t=this,i,r;if(null!==n.select("#"+this.parentID+"calculateddialog",document))for(n.remove(n.select("#"+this.parentID+"calculateddialog",document));!n.isNullOrUndefined(document.querySelector("."+this.parentID+"calculatedmenu"));)n.remove(document.querySelector("."+this.parentID+"calculatedmenu"));this.parent.element.appendChild(n.createElement("div",{id:this.parentID+"calculateddialog",className:"e-pivot-calc-dialog-div "+("olap"===this.parent.dataType?"e-olap-calc-dialog-div":"")}));i=[{click:this.applyFormula.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("ok"),isPrimary:!0,cssClass:this.parent.cssClass}},{click:this.cancelClick.bind(this),buttonModel:{content:this.parent.localeObj.getConstant("cancel"),cssClass:this.parent.cssClass}}];"olap"===this.parent.dataType&&(r={click:this.clearFormula.bind(this),buttonModel:{cssClass:"e-calc-clear-btn"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("clear")}},i.splice(0,0,r));this.dialog=new b.Dialog({allowDragging:!0,position:{X:"center",Y:"center"},buttons:i,close:this.closeDialog.bind(this),beforeOpen:this.beforeOpen.bind(this),open:function(){n.select("#"+t.parentID+"ddlelement",t.dialog.element)&&n.select("#"+t.parentID+"ddlelement",t.dialog.element).focus()},animationSettings:{effect:"Zoom"},width:"25%",isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("createCalculatedField"),target:document.body,cssClass:this.parent.cssClass});this.dialog.isStringTemplate=!0;this.dialog.appendTo("#"+this.parentID+"calculateddialog")},t.prototype.cancelClick=function(){this.dialog.close();this.isEdit=!1},t.prototype.beforeOpen=function(){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("createCalculatedField"))},t.prototype.closeDialog=function(){"pivotfieldlist"===this.parent.getModuleName()&&(this.parent.axisFieldModule.render(),"Fixed"!==this.parent.renderMode&&(n.addClass([this.parent.element.querySelector("."+rt)],sr),this.parent.dialogRenderer.fieldListDialog.show()));this.destroy();n.isNullOrUndefined(document.getElementById(this.parentID+"calculateddialog"))||n.remove(document.getElementById(this.parentID+"calculateddialog"));n.isNullOrUndefined(document.querySelector("."+this.parentID+"calculatedmenu"))||n.remove(document.querySelector("."+this.parentID+"calculatedmenu"));var t="pivotview"===this.parent.getModuleName()||"pivotfieldlist"===this.parent.getModuleName()&&"Fixed"===this.parent.renderMode?0:500;this.buttonCall&&(this.buttonCall=!1,setTimeout(this.setFocus.bind(this),t))},t.prototype.setFocus=function(){var n,t,i,r;if("pivotview"===this.parent.getModuleName()&&this.parent.element?n=this.parent.element:document.getElementById(this.parent.element.id+"_Container")&&(n=document.getElementById(this.parent.element.id+"_Container")),n)for(t=0,i=[].slice.call(n.querySelectorAll(".e-pivot-button"));t<i.length;t++)if(r=i[t],r.getAttribute("data-uid")===this.currentFieldName){r.focus();break}},t.prototype.renderDialogElements=function(){var t=n.createElement("div",{id:this.parentID+"outerDiv",className:("olap"===this.parent.dataType?"e-olap-calc-outer-div ":"")+"e-pivot-calc-outer-div"}),it=n.createElement("div",{id:this.parentID+"Olap_Tree_Div",className:"e-olap-field-tree-div"}),i=n.createElement("div",{id:this.parentID+"Pivot_Calc_Div",className:"e-pivot-calculated-div"}),rt,r,a,v,h,ut,u,c,f,ft,o,y,p,w,k,d,g,nt,tt,s,et,l;return"pivotfieldlist"===this.parent.getModuleName()&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+ru)&&this.parent.isAdaptive?(rt=n.createElement("div",{id:this.parentID+"accordDiv",className:"e-pivot-accord"}),t.appendChild(rt),r=n.createElement("div",{id:this.parentID+"buttonDiv",className:bc}),a=n.createElement("button",{id:this.parentID+"addBtn",className:"e-pivot-add-button",attrs:{type:"button"}}),a.innerText=this.parent.localeObj.getConstant("add"),v=n.createElement("button",{id:this.parentID+"cancelBtn",className:"e-pivot-cancel-button",attrs:{type:"button"}}),v.innerText=this.parent.localeObj.getConstant("cancel"),r.appendChild(v),r.appendChild(a),t.appendChild(r)):(this.parent.isAdaptive||"olap"!==this.parent.dataType||((o=n.createElement("div",{className:"e-pivot-field-name-title",id:this.parentID+"_FieldNameTitle"})).innerText=this.parent.localeObj.getConstant("fieldTitle"),i.appendChild(o)),h=n.createElement("div",{id:this.parentID+"innerDiv",className:"e-pivot-calc-input-div"}),ut=n.createElement("input",{id:this.parentID+"ddlelement",attrs:{type:"text"},className:oe}),h.appendChild(ut),"olap"!==this.parent.dataType||this.parent.isAdaptive?t.appendChild(h):i.appendChild(h),u=n.createElement("div",{id:this.parentID+"control_container",className:yc}),this.parent.isAdaptive||(c=n.createElement("div",{className:dc}),(c.innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("allFields"):this.parent.localeObj.getConstant("formulaField"),"olap"===this.parent.dataType)?(f=n.createElement("div",{className:dc+"-container"}),f.appendChild(c),ft=n.createElement("span",{attrs:{tabindex:"0","aria-disabled":"false","aria-label":this.parent.localeObj.getConstant("fieldTooltip"),role:"button"},className:e+" "+gc}),f.appendChild(ft),new b.Tooltip({content:this.parent.localeObj.getConstant("fieldTooltip"),position:this.parent.enableRtl?"RightCenter":"LeftCenter",target:"."+gc,offsetY:(this.parent.enableRtl,-10),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:220,cssClass:this.parent.cssClass}).appendTo(f),u.appendChild(f)):t.appendChild(c)),y=n.createElement("div",{className:vc+"-outer-div"}),u.appendChild(y),y.appendChild(n.createElement("div",{id:this.parentID+"tree",className:vc})),"olap"!==this.parent.dataType||this.parent.isAdaptive?t.appendChild(u):it.appendChild(u),this.parent.isAdaptive||((o=n.createElement("div",{className:"e-pivot-formula-title"})).innerText="olap"===this.parent.dataType?this.parent.localeObj.getConstant("expressionField"):this.parent.localeObj.getConstant("formula"),"olap"===this.parent.dataType?i.appendChild(o):t.appendChild(o)),p=n.createElement("textarea",{id:this.parentID+"droppable",className:ru+" e-control e-textbox e-input",attrs:{placeholder:this.parent.isAdaptive?this.parent.localeObj.getConstant("dropTextMobile"):"olap"===this.parent.dataType?this.parent.localeObj.getConstant("olapDropText"):this.parent.localeObj.getConstant("dropText")}}),("olap"!==this.parent.dataType||this.parent.isAdaptive?t.appendChild(p):i.appendChild(p),this.parent.isAdaptive&&(r=n.createElement("div",{id:this.parentID+"buttonDiv",className:bc}),(l=n.createElement("button",{id:this.parentID+"okBtn",className:wc,attrs:{type:"button"}})).innerText=this.parent.localeObj.getConstant("apply"),r.appendChild(l),t.appendChild(r)),"olap"===this.parent.dataType)&&(this.parent.isAdaptive||(w=n.createElement("div",{className:"e-olap-member-title"}),w.innerText=this.parent.localeObj.getConstant("memberType"),i.appendChild(w)),k=n.createElement("div",{id:this.parentID+"Member_Type_Div",className:rs}),this.parent.isAdaptive?t.appendChild(k):(i.appendChild(k),d=n.createElement("div",{className:"e-olap-hierarchy-title"}),d.innerText=this.parent.localeObj.getConstant("selectedHierarchy"),i.appendChild(d)),g=n.createElement("div",{id:this.parentID+"Hierarchy_List_Div",className:ts}),this.parent.isAdaptive?t.appendChild(g):i.appendChild(g)),this.parent.isAdaptive||(nt=n.createElement("div",{className:"e-pivot-format-title"}),nt.innerText=this.parent.localeObj.getConstant("formatString"),i.appendChild(nt)),tt=n.createElement("div",{id:this.parentID+"Format_Div",className:is}),this.parent.isAdaptive?t.appendChild(tt):i.appendChild(tt),s=n.createElement("div",{id:this.parentID+"custom_Format_Div",className:"e-pivot-calc-custom-format-div"}),et=n.createElement("input",{id:this.parentID+"Custom_Format_Element",attrs:{type:"text"},className:ns}),(s.appendChild(et),i.appendChild(s),this.parent.isAdaptive?t.appendChild(s):i.appendChild(s),"pivotfieldlist"===this.parent.getModuleName()&&null===this.parent.dialogRenderer.parentElement.querySelector("."+ru)&&this.parent.isAdaptive)?(l=t.querySelector("."+wc),t.appendChild(l)):("olap"===this.parent.dataType&&t.appendChild(it),t.appendChild(i))),t},t.prototype.renderAdaptiveLayout=function(t){var i=this.parent.dialogRenderer.adaptiveElement,r,u,f,e;t?((n.select("#"+this.parentID+"droppable",i.element)&&(this.formulaText=n.select("#"+this.parentID+"droppable",document).value,this.fieldText=this.inputObj.value),i.element.querySelector("."+rs))&&(r=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",i.element),y.DropDownList),this.fieldType=r.value),i.element.querySelector("."+ts)&&(u=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",i.element),y.DropDownList),this.parentHierarchy="Dimension"===this.fieldType?u.value:null),i.element.querySelector("."+is)&&(f=n.getInstance(n.select("#"+this.parentID+"Format_Div",i.element),y.DropDownList),this.formatType=f.value),i.element.querySelector("."+ns)&&(e=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",i.element),it.MaskedTextBox),this.formatText="Custom"===("olap"===this.parent.dataType?this.formatType:this.getFormat(this.formatType))?e.value:null)):(this.currentFieldName=this.formulaText=this.fieldText=this.formatText=null,this.fieldType=this.formatType=this.parentHierarchy=null);this.renderMobileLayout(i)},t.prototype.updateAdaptiveCalculatedField=function(t,i){var f=this.parent.dialogRenderer.adaptiveElement.element,u,e,o,c,s,h;this.isEdit=t;u=t?"pivot"===this.parent.dataType?this.parent.engineModule.fieldList[i]:this.parent.olapEngineModule.fieldList[i]:{id:null,caption:null,formula:null,fieldType:"Measure",formatString:"pivot"===this.parent.dataType?null:"Standard",parentHierarchy:null};(this.currentFieldName=u.id,n.select("#"+this.parentID+"droppable",document)&&(this.formulaText=n.select("#"+this.parentID+"droppable",document).value=u.formula,this.fieldText=this.inputObj.value=u.caption,this.inputObj.dataBind()),f.querySelector("."+rs))&&(e=n.getInstance(n.select("#"+this.parentID+"Member_Type_Div",f),y.DropDownList),this.fieldType=e.value=u.fieldType,e.readonly=!!t,e.dataBind());f.querySelector("."+ts)&&(o=n.getInstance(n.select("#"+this.parentID+"Hierarchy_List_Div",f),y.DropDownList),"Dimension"===this.fieldType?this.parentHierarchy=o.value=u.parentHierarchy:(this.parentHierarchy=null,o.index=0),o.dataBind());f.querySelector("."+is)&&(c=n.getInstance(n.select("#"+this.parentID+"Format_Div",f),y.DropDownList),this.formatType=c.value=this.formatTypes.indexOf(u.formatString)>-1?u.formatString:"Custom");f.querySelector("."+ns)&&(s=n.getInstance(n.select("#"+this.parentID+"Custom_Format_Element",f),it.MaskedTextBox),h=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),this.formatText="pivot"===this.parent.dataType?s.value=h?h.format:null:s.value="Custom"===this.formatType?u.formatString:null,s.dataBind())},t.prototype.createDropElements=function(){for(var c,b,l,k,i,u,f,e,o,t=this,a=this.parent.isAdaptive?this.parent.dialogRenderer.parentElement:this.dialog.element,s=[],h=[],v=0,d=this.formatTypes;v<d.length;v++)c=d[v],s.push({value:"pivot"===this.parent.dataType?this.getFormat(c):c,text:this.parent.localeObj.getConstant(c)});if("olap"===this.parent.dataType){for(var p=[],w=0,g=["Measure","Dimension"];w<g.length;w++)b=g[w],p.push({value:b,text:this.parent.localeObj.getConstant(b)});for(l=0,k=r.getClonedData(this.parent.olapEngineModule.fieldListData);l<k.length;l++)i=k[l],i.spriteCssClass&&(i.spriteCssClass.indexOf("e-attributeCDB-icon")>-1||i.spriteCssClass.indexOf("e-hierarchyCDB-icon")>-1)&&h.push({value:i.id,text:i.caption});u=new y.DropDownList({dataSource:p,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:null!==this.fieldType?this.fieldType:p[0].value,readonly:this.isEdit,cssClass:us+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){f.enabled="Dimension"===i.value;t.fieldType=i.value;t.formulaText=n.select("#"+t.parentID+"droppable",document).value;f.dataBind()}});u.isStringTemplate=!0;u.appendTo(n.select("#"+this.parentID+"Member_Type_Div",a));f=new y.DropDownList({dataSource:h,enableRtl:this.parent.enableRtl,locale:this.parent.locale,allowFiltering:!0,enabled:"Dimension"===u.value,filterBarPlaceholder:this.parent.localeObj.getConstant("example")+" "+h[0].text.toString(),fields:{value:"value",text:"text"},value:null!==this.parentHierarchy&&"Dimension"===u.value?this.parentHierarchy:h[0].value,cssClass:us+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){t.parentHierarchy=i.value;t.formulaText=n.select("#"+t.parentID+"droppable",document).value}});f.isStringTemplate=!0;f.appendTo(n.select("#"+this.parentID+"Hierarchy_List_Div",a))}e=new y.DropDownList({dataSource:s,enableRtl:this.parent.enableRtl,locale:this.parent.locale,fields:{value:"value",text:"text"},value:this.parent.isAdaptive&&null!==this.formatType?this.formatType:"olap"===this.parent.dataType?s[0].value:s[4].value,cssClass:us+(this.parent.cssClass?" "+this.parent.cssClass:""),width:"100%",change:function(i){o.enabled="Custom"===i.value;t.formatType=i.value;t.formulaText=n.select("#"+t.parentID+"droppable",document).value;o.dataBind()}});e.isStringTemplate=!0;e.appendTo(n.select("#"+this.parentID+"Format_Div",a));o=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("customFormat"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,value:null!==this.formatText&&"Custom"===e.value?this.formatText:null,enabled:"Custom"===e.value,change:function(i){t.formatText=i.value;t.formulaText=n.select("#"+t.parentID+"droppable",document).value},cssClass:this.parent.cssClass});o.isStringTemplate=!0;o.appendTo("#"+this.parentID+"Custom_Format_Element")},t.prototype.getFormat=function(n){var t=n;switch(t){case"Standard":t="N";break;case"Currency":t="C";break;case"Percent":t="P";break;case"N":t="Standard";break;case"C":t="Currency";break;case"P":t="Percent"}return t},t.prototype.createTreeView=function(){var t=this;this.treeObj="olap"===this.parent.dataType?new st.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,nodeDragStart:this.dragStart.bind(this),nodeDragging:function(t){t.event.target&&t.event.target.classList.contains(ru)?(n.removeClass([t.clonedNode],nu),n.addClass([t.event.target],"e-copy-drop")):(n.addClass([t.clonedNode],nu),n.removeClass([t.event.target],"e-copy-drop"),t.dropIndicator="e-no-drop",n.addClass([t.clonedNode.querySelector("."+e)],"e-icon-expandable"),n.removeClass([t.clonedNode.querySelector("."+e)],"e-list-icon"))},nodeClicked:this.fieldClickHandler.bind(this),nodeSelected:function(i){i.node.getAttribute("data-type")===ct?t.displayMenu(i.node):(n.removeClass([i.node],"e-active"),i.cancel=!0)},nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),sortOrder:"None",cssClass:this.parent.cssClass}):new st.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"formula",text:"name",iconCss:"icon"},allowDragAndDrop:!0,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,locale:this.parent.locale,cssClass:this.parent.cssClass,nodeCollapsing:this.nodeCollapsing.bind(this),nodeDragStart:this.dragStart.bind(this),nodeClicked:this.fieldClickHandler.bind(this),nodeDragStop:this.fieldDropped.bind(this),drawNode:this.drawTreeNode.bind(this),keyPress:function(n){39===n.event.keyCode&&(n.cancel=!0)},sortOrder:"Ascending"});this.treeObj.isStringTemplate=!0;this.treeObj.appendTo("#"+this.parentID+"tree")},t.prototype.updateNodeIcon=function(t){var i,e,u,o;if(t.node&&t.node.querySelector(".e-list-icon")&&t.node.querySelector(".e-icon-expandable.e-process")&&t.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-icon")>-1)i=t.node.querySelector(".e-list-icon"),n.removeClass([i],"e-folderCDB-icon"),n.addClass([i],"e-folderCDB-open-icon");else if(t.node&&t.node.querySelector(".e-list-icon")&&t.node.querySelector(".e-icon-expandable")&&t.node.querySelector(".e-list-icon").className.indexOf("e-folderCDB-open-icon")>-1)i=t.node.querySelector(".e-list-icon"),n.removeClass([i],"e-folderCDB-open-icon"),n.addClass([i],"e-folderCDB-icon");else{for(var s=this.treeObj.fields.dataSource,r=[],f=0,h=s;f<h.length;f++)e=h[f],e.pid===t.nodeData.id.toString()&&r.push(e);if(0!==r.length)return;for(this.parent.olapEngineModule.calcChildMembers=[],this.parent.olapEngineModule.getCalcChildMembers(this.parent.dataSourceSettings,t.nodeData.id.toString()),r=this.parent.olapEngineModule.calcChildMembers,this.parent.olapEngineModule.calcChildMembers=[],u=0,o=r;u<o.length;u++)(i=o[u]).pid=t.nodeData.id.toString(),i.hasChildren=!1,i.spriteCssClass="e-level-members",i.caption=""===i.caption?this.parent.localeObj.getConstant("blank"):i.caption,s.push(i);this.treeObj.addNodes(r,t.node)}},t.prototype.nodeCollapsing=function(n){n.cancel=!0},t.prototype.dragStart=function(t){var r=!1,i=t.clonedNode;i&&("olap"===this.parent.dataType&&(i.querySelector(".e-calc-dimension-icon,.e-calc-measure-icon,.e-measure-icon")||i.querySelector(".e-dimensionCDB-icon,.e-attributeCDB-icon,.e-hierarchyCDB-icon")||i.querySelector(".e-level-members,.e-namedSetCDB-icon"))||"pivot"===this.parent.dataType&&t.event.target.classList.contains(lu))&&(r=!0);r?(n.addClass([t.draggedNode.querySelector("."+dt)],tu),n.addClass([i],"e-pivot-calc"),i.style.zIndex=(this.dialog.zIndex+1).toString(),i.style.display="inline"):t.cancel=!0},t.prototype.drawTreeNode=function(t){var i,o,f,c,a,s,l,v,u,h,y,p;"olap"===this.parent.dataType?(t.node.querySelector(".e-measure-icon")&&(t.node.querySelector(".e-list-icon").style.display="none"),i=t.nodeData,t.node.setAttribute("data-field",i.id),t.node.setAttribute("data-caption",i.caption),o=t.node.querySelector("."+lr),t.nodeData&&t.nodeData.type===ct&&o&&t.node.querySelector(".e-list-icon.e-calc-member")&&(t.node.setAttribute("data-type",i.type),t.node.setAttribute("data-membertype",i.fieldType),t.node.setAttribute("data-hierarchy",i.parentHierarchy?i.parentHierarchy:""),t.node.setAttribute("data-formula",i.formula),f=i.formatString?this.formatTypes.indexOf(i.formatString)>-1?i.formatString:"Custom":"None",t.node.setAttribute("data-formatString",f),t.node.setAttribute("data-customformatstring","Custom"===f?i.formatString:""),c=n.createElement("span",{className:vt+" e-icons e-list-icon"}),(o.classList.add("e-calcfieldmember"),this.parent.isAdaptive)?(a=n.createElement("span",{className:"e-list-edit-icon"+(this.isEdit&&this.currentFieldName===i.id?" e-edited ":" e-edit ")+e}),s=n.createElement("div",{className:"e-list-header-icon"}),s.appendChild(a),s.appendChild(c),o.appendChild(s)):o.appendChild(c)),this.parent.isAdaptive&&(l=t.node.querySelector("."+lr),t.node&&t.node.querySelector(".e-list-icon")&&l&&(v=t.node.querySelector(".e-list-icon"),l.insertBefore(v,t.node.querySelector(".e-list-text"))),t.node&&t.node.querySelector(".e-calcMemberGroupCDB,.e-measureGroupCDB-icon,.e-folderCDB-icon")&&(t.node.querySelector(".e-checkbox-wrapper").style.display="none"),t.node&&t.node.querySelector(".e-level-members")&&(t.node.querySelector(".e-list-icon").style.display="none"))):(i=t.nodeData.field,t.node.setAttribute("data-field",i),t.node.setAttribute("data-caption",t.nodeData.caption),t.node.setAttribute("data-type",t.nodeData.type),u=r.getFieldByName(i,this.parent.dataSourceSettings.formatSettings),(t.node.setAttribute("data-formatString",u?u.format:""),u)&&(h=this.getFormat(u.format),f=h?this.formatTypes.indexOf(h)>-1?u.format:"Custom":"None",t.node.setAttribute("data-customformatstring","Custom"===f?h:""),t.node.setAttribute("data-formatString",u?f:"")),y=n.createElement("span",{attrs:{tabindex:"-1","aria-disabled":"false",title:this.parent.localeObj.getConstant("dragField")},className:e+" e-drag"}),p=n.createElement("div",{className:" e-iconspace"}),n.prepend([y],t.node.querySelector("."+lr)),n.append([p,t.node.querySelector("."+ki)],t.node.querySelector("."+lr)),this.getMenuItems(this.parent.engineModule.fieldList[i].type).length<=0?n.removeClass([t.node.querySelector("."+ki)],e):t.node.querySelector("."+ki).setAttribute("title",this.parent.localeObj.getConstant("format")),this.parent.engineModule.fieldList[i].aggregateType===ct&&(t.node.querySelector("."+ki).setAttribute("title",this.parent.localeObj.getConstant("remove")),n.addClass([t.node.querySelector("."+ki)],vt),n.addClass([t.node.querySelector(".e-iconspace")],[k,e,"e-list-icon"]),t.node.querySelector("."+k).setAttribute("title",this.parent.localeObj.getConstant("edit")),t.node.querySelector("."+k).setAttribute("aria-disabled","false"),t.node.querySelector("."+k).setAttribute("tabindex","-1"),n.removeClass([t.node.querySelector("."+ki)],ki),n.removeClass([t.node.querySelector(".e-iconspace")],"e-iconspace")))},t.prototype.createTypeContainer=function(t){for(var f,u=n.createElement("div",{id:this.parentID+"control_container",className:yc}),r=this.getMenuItems(this.parent.engineModule.fieldList[t].type),i=0;i<r.length;i++)f=n.createElement("input",{id:this.parentID+"radio"+t+r[i],attrs:{type:"radio","data-ftxt":t,"data-value":r[i]},className:"e-pivot-calc-radio"}),u.appendChild(f);return u},t.prototype.getMenuItems=function(t,i){for(var u=n.isNullOrUndefined(i)?this.parent.aggregateTypes:i,f=[],e=this.getValidSummaryType(),r=0;r<u.length;r++)e.indexOf(u[r])>-1&&f.indexOf(u[r])<0&&((u[r]!==eu&&u[r]!==ve||"number"===t)&&"number"!==t||f.push(u[r]));return f},t.prototype.getValidSummaryType=function(){return[eu,ve,ae,"Avg",ia,"Min","Max",ra,ua,fa,ea,oa]},t.prototype.getAccordionData=function(n){for(var t,r=[],u=Object.keys(n.engineModule.fieldList),i=0,f=u.length;i<f;i++)t=u[i],r.push({header:"<input id="+this.parentID+"_"+i+" class="+ac+' type="checkbox" data-field='+t+' data-caption="'+this.parent.engineModule.fieldList[t].caption+'" data-type='+this.parent.engineModule.fieldList[t].type+"/>",content:this.parent.engineModule.fieldList[t].aggregateType===ct||this.getMenuItems(this.parent.engineModule.fieldList[t].type).length<1?"":this.createTypeContainer(t).outerHTML,iconCss:this.parent.engineModule.fieldList[t].aggregateType===ct?"e-list-icon "+(this.isEdit&&this.currentFieldName===t?"e-edited":"e-edit"):""});return r},t.prototype.renderMobileLayout=function(t){var f=this,i,r,u;t.items[4].content=this.renderDialogElements().outerHTML;t.dataBind();this.parent.isAdaptive&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+ru)&&this.createDropElements();i=new ht.Button({cssClass:se+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});(i.isStringTemplate=!0,i.appendTo("#"+this.parentID+"cancelBtn"),i.element&&(i.element.onclick=this.cancelBtnClick.bind(this)),null!==this.parent.dialogRenderer.parentElement.querySelector("."+ru)&&this.parent.isAdaptive)?(r=new ht.Button({cssClass:se+" e-outline"+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),r.isStringTemplate=!0,r.appendTo("#"+this.parentID+"okBtn"),this.inputObj=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:function(t){f.fieldText=t.value;f.formulaText=n.select("#"+f.parentID+"droppable",document).value},cssClass:this.parent.cssClass}),this.inputObj.isStringTemplate=!0,this.inputObj.appendTo("#"+this.parentID+"ddlelement"),null!==this.formulaText&&null!==n.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement)&&(n.select("#"+this.parentID+"droppable",this.parent.dialogRenderer.parentElement).value=this.formulaText),null!==this.fieldText&&null!==this.parent.dialogRenderer.parentElement.querySelector("."+oe)&&(this.parent.dialogRenderer.parentElement.querySelector("."+oe).value=this.fieldText,this.inputObj.value=this.fieldText),r.element&&(r.element.onclick=this.applyFormula.bind(this))):this.parent.isAdaptive&&(u=new ht.Button({cssClass:se+(this.parent.cssClass?" "+this.parent.cssClass:""),isPrimary:!0,locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer}),u.isStringTemplate=!0,u.appendTo("#"+this.parentID+"addBtn"),"olap"===this.parent.dataType?(this.treeObj=new st.TreeView({fields:{dataSource:this.getFieldListData(this.parent),id:"id",text:"caption",parentID:"pid",iconCss:"spriteCssClass"},showCheckBox:!0,autoCheck:!1,sortOrder:"None",enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeClicked:this.fieldClickHandler.bind(this),drawNode:this.drawTreeNode.bind(this),nodeExpanding:this.updateNodeIcon.bind(this),nodeCollapsed:this.updateNodeIcon.bind(this),nodeSelected:function(t){n.removeClass([t.node],"e-active");t.cancel=!0},cssClass:this.parent.cssClass}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parentID+"accordDiv")):(this.accordion=new st.Accordion({items:this.getAccordionData(this.parent),enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,expanding:this.accordionExpand.bind(this),clicked:this.accordionClickHandler.bind(this),created:this.accordionCreated.bind(this)}),this.accordion.isStringTemplate=!0,this.accordion.appendTo("#"+this.parentID+"accordDiv"),this.updateType()),u.element&&(u.element.onclick=this.addBtnClick.bind(this)))},t.prototype.accordionExpand=function(n){var t;if(0===n.element.querySelectorAll(".e-radio-wrapper").length)for(var f=Object.keys(this.parent.engineModule.fieldList),u=0,o=f.length;u<o;u++){var i=f[u],r="number"!==this.parent.engineModule.fieldList[i].type?[eu,ve]:[ae,eu,"Avg",ia,"Min","Max",ve,ra,ua,fa,ea,oa],e=void 0;if(i===n.element.querySelector("[data-field").getAttribute("data-field"))for(t=0;t<r.length;t++)(e=new ht.RadioButton({label:this.parent.localeObj.getConstant(r[t]),name:"AggregateType"+i,checked:n.element.querySelector("[data-type").getAttribute("data-type")===r[t],change:this.onChange.bind(this),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass})).isStringTemplate=!0,e.appendTo("#"+this.parentID+"radio"+i+r[t])}},t.prototype.onChange=function(n){var t=n.event.target.parentElement.querySelector(".e-label").innerText,i=n.event.target.closest(".e-acrdn-item").querySelector("[data-field").getAttribute("data-caption");n.event.target.closest(".e-acrdn-item").querySelector(".e-label").innerText=i+" ("+t+")";n.event.target.closest(".e-acrdn-item").querySelector("[data-type").setAttribute("data-type",n.event.target.getAttribute("data-value"))},t.prototype.updateType=function(){for(var r,t,u,f=Object.keys(this.parent.engineModule.fieldList),i=0,e=f.length;i<e;i++)t=f[i],r="number"===this.parent.engineModule.fieldList[t].type&&"include"!==this.parent.engineModule.fieldList[t].type&&"exclude"!==this.parent.engineModule.fieldList[t].type||"DistinctCount"===this.parent.engineModule.fieldList[t].aggregateType?void 0!==this.parent.engineModule.fieldList[t].aggregateType?this.parent.engineModule.fieldList[t].aggregateType:ae:eu,u=new ht.CheckBox({label:this.parent.engineModule.fieldList[t].caption+" ("+this.parent.localeObj.getConstant(r)+")",locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,cssClass:this.parent.cssClass}),u.isStringTemplate=!0,u.appendTo("#"+this.parentID+"_"+i),n.select("#"+this.parentID+"_"+i,document).setAttribute("data-field",t),n.select("#"+this.parentID+"_"+i,document).setAttribute("data-type",r)},t.prototype.cancelBtnClick=function(){this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},t.prototype.addBtnClick=function(){var n="",f=null,s=null,u,t,i,r;if("pivot"===this.parent.dataType){for(u=document.querySelectorAll(".e-accordion .e-check"),t=0;t<u.length;t++)if(f=u[t].parentElement.querySelector("[data-field]").getAttribute("data-field"),-1===(s=u[t].parentElement.querySelector("[data-field]").getAttribute("data-type")).indexOf(ct))n=n+'"'+s+"("+f+')"';else for(i=0;i<this.parent.dataSourceSettings.calculatedFieldSettings.length;i++)if(this.parent.dataSourceSettings.calculatedFieldSettings[i].name===f){n+=this.parent.dataSourceSettings.calculatedFieldSettings[i].formula;break}}else for(var c=this.treeObj.getAllCheckedNodes(),e=this.parent.olapEngineModule,o=0,h=c;o<h.length;o++)r=h[o],n+=e.fieldList[r]&&e.fieldList[r].type===ct?e.fieldList[r].tag:r;this.formulaText=null!==this.formulaText?this.formulaText+n:n;this.renderMobileLayout(this.parent.dialogRenderer.adaptiveElement)},t.prototype.createCalculatedFieldDialog=function(t){var i,r;this.parent.isAdaptive&&"pivotfieldlist"===this.parent.getModuleName()?(this.renderAdaptiveLayout(!t||void 0===t.edit||t.edit),this.isEdit=t&&void 0!==t.edit?t.edit:this.isEdit):this.parent.isAdaptive||((this.isEdit=!(!t||void 0===t.edit)&&t.edit,this.renderDialogLayout(),t&&t.edit)&&(i=this.treeObj.element.querySelector('li[data-field="'+t.fieldName+'"]'),i&&((n.addClass([i],["e-active","e-node-focus"]),i.setAttribute("aria-selected","true"),i.id=this.treeObj.element.id+"_active","pivot"===this.parent.dataType)?(r={event:{target:i.querySelector(".e-list-icon.e-edit.e-icons")}},this.fieldClickHandler(r)):this.displayMenu(i))),this.dialog.element.style.top=parseInt(this.dialog.element.style.top,10)<0?"0px":this.dialog.element.style.top)},t.prototype.renderDialogLayout=function(){this.newFields=n.extend([],this.parent.dataSourceSettings.calculatedFieldSettings,null,!0);this.createDialog();this.dialog.content=this.renderDialogElements();this.dialog.refresh();this.inputObj=new it.MaskedTextBox({placeholder:this.parent.localeObj.getConstant("fieldName"),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass});this.inputObj.isStringTemplate=!0;this.inputObj.appendTo("#"+this.parentID+"ddlelement");this.createDropElements();this.createTreeView();this.droppable=new n.Droppable(n.select("#"+this.parentID+"droppable"));this.keyboardEvents=new n.KeyboardEvents(this.parent.calculatedFieldModule.dialog.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:{moveRight:"rightarrow",enter:"enter",shiftE:"shift+E","delete":"delete"},eventName:"keydown"})},t.prototype.createConfirmDialog=function(t,i,r,u,f){var e=n.createElement("div",{id:this.parentID+"_CalculatedFieldErrorDialog",className:nc});this.parent.element.appendChild(e);this.confirmPopUp=new b.Dialog({animationSettings:{effect:"Fade"},allowDragging:!1,showCloseIcon:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,width:"auto",height:"auto",position:{X:"center",Y:"center"},buttons:[{click:u?this.removeCalcField.bind(this,f):this.replaceFormula.bind(this,r),buttonModel:{cssClass:lt+" e-flat e-primary"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:u?this.parent.localeObj.getConstant("yes"):this.parent.localeObj.getConstant("ok"),isPrimary:!0}},{click:this.closeErrorDialog.bind(this),buttonModel:{cssClass:br+(this.parent.cssClass?" "+this.parent.cssClass:""),content:u?this.parent.localeObj.getConstant("no"):this.parent.localeObj.getConstant("cancel"),isPrimary:!0}}],header:t,content:i,isModal:!0,visible:!0,closeOnEscape:!0,target:document.body,cssClass:this.parent.cssClass,close:this.removeErrorDialog.bind(this)});this.confirmPopUp.isStringTemplate=!0;this.confirmPopUp.appendTo(e)},t.prototype.replaceFormula=function(t){var i=this.parent.dataSourceSettings,r,u;if("olap"===this.parent.dataType){for(r=0;r<i.calculatedFieldSettings.length;r++)if(i.calculatedFieldSettings[r].name===t.name){n.isNullOrUndefined(t.hierarchyUniqueName)||(i.calculatedFieldSettings[r].hierarchyUniqueName=t.hierarchyUniqueName);i.calculatedFieldSettings[r].formatString=t.formatString;i.calculatedFieldSettings[r].formula=t.formula;this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[r];break}}else for(u=0;u<i.values.length;u++)if(i.values[u].type===ct&&i.values[u].name===t.name)for(r=0;r<i.calculatedFieldSettings.length;r++)i.calculatedFieldSettings[r].name===t.name&&(i.calculatedFieldSettings[r].formula=t.formula,this.parent.lastCalcFieldInfo=i.calculatedFieldSettings[r],this.updateFormatSettings(i,t.name,t.formatString));this.addFormula(i,t.name);this.removeErrorDialog()},t.prototype.removeErrorDialog=function(){this.confirmPopUp&&!this.confirmPopUp.isDestroyed&&this.confirmPopUp.destroy();null!==n.select("#"+this.parentID+"_CalculatedFieldErrorDialog",document)&&n.remove(n.select("#"+this.parentID+"_CalculatedFieldErrorDialog",document))},t.prototype.closeErrorDialog=function(){this.confirmPopUp.close()},t.prototype.addEventListener=function(){this.parent.isDestroyed||this.parent.on(tr,this.createCalculatedFieldDialog,this)},t.prototype.removeEventListener=function(){this.parent.isDestroyed||this.parent.off(tr,this.createCalculatedFieldDialog)},t.prototype.destroy=function(){this.menuObj&&!this.menuObj.isDestroyed&&this.menuObj.destroy();this.treeObj&&!this.treeObj.isDestroyed&&this.treeObj.destroy();this.dialog&&!this.dialog.isDestroyed&&this.dialog.destroy();this.inputObj&&!this.inputObj.isDestroyed&&this.inputObj.destroy();this.confirmPopUp&&!this.confirmPopUp.isDestroyed&&this.confirmPopUp.destroy();this.accordion&&!this.accordion.isDestroyed&&this.accordion.destroy();this.menuObj&&(this.menuObj=null);this.treeObj&&(this.treeObj=null);this.dialog&&(this.dialog=null);this.inputObj&&(this.inputObj=null);this.newFields&&(this.newFields=null);this.confirmPopUp&&(this.confirmPopUp=null);this.accordion&&(this.accordion=null);this.curMenu&&(this.curMenu=null)},t}();sf.Inject(hp);var cp=function(){function t(n){this.parent=n}return t.prototype.render=function(){var u,e,t,o;(!this.parent.pivotButtonModule||this.parent.pivotButtonModule&&this.parent.pivotButtonModule.isDestroyed)&&new na(this.parent);this.createPivotButtons();for(var i=[],r=0,f=this.parent.element.querySelectorAll("."+ri);r<f.length;r++)u=f[r],u.classList.contains(cs)||(i=i.concat([].slice.call(u.querySelectorAll("."+ur))));for(e=i.length,t=0;t<e;t++)o=n.createElement("span",{className:"e-indent-div",styles:"width:"+24*t+"px"}),n.prepend([o],i[t])},t.prototype.createPivotButtons=function(){for(var i,o,u,s,f,t,c,l,n=[this.parent.dataSourceSettings.rows,this.parent.dataSourceSettings.columns,this.parent.dataSourceSettings.values,this.parent.dataSourceSettings.filters],e=0,h=this.parent.element.querySelectorAll("."+vo+",."+ri+",."+vu+",."+yu+",."+re);e<h.length;e++)i=h[e],this.parent.dataSourceSettings.values.length>0&&i.classList.contains(rf)&&this.parent.dataSourceSettings.columns.length>0&&i.classList.contains(tf)||(i.innerHTML="");if("pivot"===this.parent.dataType&&this.parent.dataSourceSettings.dataSource&&(this.parent.dataSourceSettings.dataSource.length>0||this.parent.dataSourceSettings.dataSource instanceof ut.DataManager)||"olap"===this.parent.dataType&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url||"Server"===this.parent.dataSourceSettings.mode&&this.parent.dataSourceSettings.url&&""!==this.parent.dataSourceSettings.url){if(o=["rows","columns","values","filters"],"pivot"===this.parent.dataType&&this.parent.groupingBarSettings.showFieldsPanel)for(o.push("all-fields"),n.push([]),u=0,s=this.parent.engineModule&&this.parent.engineModule.fieldList?Object.keys(this.parent.engineModule.fieldList):[];u<s.length;u++)f=s[u],this.parent.engineModule.fieldList[f]&&!this.parent.engineModule.fieldList[f].isSelected&&n[n.length-1].push(r.getFieldInfo(f,this.parent,!0).fieldItem);for(t=0,c=n.length;t<c;t++)n[t]&&(l={field:n[t],axis:o[t].toString()},this.parent.notify(vf,l))}},t}(),lp=function(){function t(t){this.parent=t;this.parent.groupingBarModule=this;this.resColWidth=this.parent.isAdaptive?180:249;this.addEventListener();this.parent.axisFieldModule=new cp(this.parent);this.touchObj=new n.Touch(this.parent.element,{tapHold:this.tapHoldHandler.bind(this)})}return t.prototype.getModuleName=function(){return"groupingBar"},t.prototype.renderLayout=function(){var t,o,i;this.groupingTable=n.createElement("div",{className:kt});this.leftAxisPanel=n.createElement("div",{className:dh});this.rightAxisPanel=n.createElement("div",{className:gh});var r=n.createElement("div",{className:"e-axis-row "+vr+"container"}),u=n.createElement("div",{className:"e-axis-column "+vr+"container"}),f=n.createElement("div",{className:"e-axis-value "+vr+"container"}),e=n.createElement("div",{className:fs+" "+vr+"container"});for(this.rowPanel=n.createElement("div",{className:ri+" "+kr}),this.columnPanel=n.createElement("div",{className:vu+" "+dr}),this.valuePanel=n.createElement("div",{className:yu+" "+cr}),this.filterPanel=n.createElement("div",{className:re+" "+gr}),r.appendChild(this.rowPanel),u.appendChild(this.columnPanel),f.appendChild(this.valuePanel),e.appendChild(this.filterPanel),this.rowAxisPanel=r,this.columnAxisPanel=u,this.valueAxisPanel=f,this.filterAxisPanel=e,this.leftAxisPanel.appendChild(f),this.leftAxisPanel.appendChild(r),this.rightAxisPanel.appendChild(e),this.rightAxisPanel.appendChild(u),this.groupingTable.appendChild(n.createElement("div",{styles:"display:flex;"})),this.groupingTable.firstElementChild.appendChild(this.leftAxisPanel),this.groupingTable.firstElementChild.appendChild(this.rightAxisPanel),"pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings&&this.parent.groupingBarSettings.showFieldsPanel&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.groupingTable.classList.add(er),this.groupingTable.querySelector("."+ri).classList.add(ef),t=0,o=[this.rowPanel,this.columnPanel,this.valuePanel,this.filterPanel];t<o.length;t++)i=o[t],this.parent.groupingBarSettings.allowDragAndDrop&&new n.Droppable(i,{}),this.unWireEvent(i),this.wireEvent(i);"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode?(this.groupingChartTable=this.groupingTable.cloneNode(!0),n.select("#"+this.parent.element.id+"_AllFields",this.groupingChartTable)&&(n.select("#"+this.parent.element.id+"_AllFields",this.groupingChartTable).remove(),this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingChartTable.classList.add(uf),this.groupingChartTable.classList.remove(er),this.groupingChartTable.querySelector("."+ri).classList.add(cs),this.groupingChartTable.querySelector("."+ri).classList.remove(ef),this.parent.chartSettings.enableMultipleAxis&&this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)<0?this.groupingChartTable.querySelector("."+yu).classList.add("e-group-chart-multi-values"):this.groupingChartTable.querySelector("."+yu).classList.add(rf),this.parent.chartSettings.chartSeries&&["Pie","Pyramid","Doughnut","Funnel"].indexOf(this.parent.chartSettings.chartSeries.type)>-1?this.groupingChartTable.querySelector("."+vu).classList.add(tf):this.groupingChartTable.querySelector("."+vu).classList.add("e-group-chart-accumulation-column"),this.groupingChartTable.querySelector("."+re).classList.add("e-group-chart-filters")):this.groupingChartTable=void 0;"Chart"!==this.parent.displayOption.view&&"Chart"!==this.parent.groupingBarSettings.displayMode||(this.groupingTable=void 0)},t.prototype.appendToElement=function(){var r,o,i,s,v,t,h,c,y,u,f,e,a,k;if((this.parent.element.querySelector("."+yr)||this.parent.element.querySelector("."+ft))&&this.parent.showGroupingBar){if(this.parent.element.querySelector("."+kt))for(r=0,o=this.parent.element.querySelectorAll("."+kt);r<o.length;r++)i=o[r],n.remove(i);if(this.groupingChartTable&&(n.select("#"+this.parent.element.id+"_chart",this.parent.element)?(n.setStyleAttribute(this.groupingChartTable,{width:n.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.parent.element.insertBefore(this.groupingChartTable,n.select("#"+this.parent.element.id+"_chart",this.parent.element)),this.groupingChartTable.querySelector("."+yi)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed)&&(s=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2,this.chartPanel.width=s<400?"398px":s,this.chartPanel.refreshOverflow(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))):this.groupingChartTable=void 0),"Chart"!==this.parent.displayOption.view&&this.groupingTable){this.parent.isAdaptive&&(this.leftAxisPanel.style.minWidth="180px",this.valuePanel.style.minWidth="180px");this.parent.firstColWidth&&(this.leftAxisPanel.style.minWidth="auto",this.valuePanel.style.minWidth="auto");this.filterPanel.removeAttribute("style");this.columnPanel.removeAttribute("style");this.rowPanel.removeAttribute("style");this.filterPanel.removeAttribute("style");(v="olap"===this.parent.dataType?this.parent.olapEngineModule.headerContent?Object.keys(this.parent.olapEngineModule.headerContent).length:0:this.parent.engineModule.headerContent?Object.keys(this.parent.engineModule.headerContent).length:0,n.isNullOrUndefined(v))||(t=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader"),t.removeAttribute("style"),n.addClass([t.querySelector(".e-headercell")],"e-group-row"),t.querySelector(".e-group-row").appendChild(this.rowAxisPanel),t.querySelector(".e-group-row").querySelector(".e-headercelldiv").style.display="none",t.querySelector(".e-group-row").querySelector(".e-sortfilterdiv").style.display="none");(this.parent.element.insertBefore(this.groupingTable,this.parent.element.querySelector("."+yr)),n.setStyleAttribute(this.groupingTable,{width:n.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+yi)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed)&&(h=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2,this.gridPanel.width=h<400?"398px":h,this.gridPanel.refreshOverflow());this.groupingTable.style.minWidth="400px";this.parent.axisFieldModule.render();this.setGridRowWidth();c=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0];y=n.formatUnit(this.groupingTable.offsetWidth-parseInt(c.style.width,10));n.setStyleAttribute(this.valuePanel,{width:c.style.width});n.setStyleAttribute(this.rightAxisPanel,{width:y});u=this.valuePanel.offsetHeight/2;u>this.columnPanel.offsetHeight&&(n.setStyleAttribute(this.filterPanel,{height:n.formatUnit(u)}),n.setStyleAttribute(this.columnPanel,{height:n.formatUnit(u+2)}));f=this.parent.element.querySelector(".e-headercontent").offsetHeight;n.setStyleAttribute(this.rowPanel,{height:f+"px"});this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=f+"px");for(var p=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(n){return n.childNodes.length>0}),w=f/p.length,l=0,b=p;l<b.length;l++)for(i=b[l],n.setStyleAttribute(i,{height:w+"px"}),e=0,a=[].slice.call(i.querySelectorAll(".e-rhandler"));e<a.length;e++)k=a[e],n.setStyleAttribute(k,{height:w+"px"})}else this.parent.axisFieldModule.render(),this.updateChartAxisHeight();this.parent.showToolbar&&"Both"===this.parent.displayOption.view&&("Table"===this.parent.currentView?this.parent.element.querySelector(".e-chart-grouping-bar").style.display="none":this.parent.element.querySelector(".e-pivot-grouping-bar").style.display="none")}},t.prototype.updateChartAxisHeight=function(){var f;if(this.groupingChartTable&&n.select("#"+this.parent.element.id+"_chart",this.parent.element)){var t=this.groupingChartTable.querySelector("."+ri),i=this.groupingChartTable.querySelector("."+yu),r=this.groupingChartTable.querySelector("."+re),u=this.groupingChartTable.querySelector("."+vu);t&&u&&(t.style.height="auto",u.style.height="auto",t.offsetHeight>0&&u.offsetHeight>0)&&(f=t.offsetHeight>u.offsetHeight?t.offsetHeight:u.offsetHeight,n.setStyleAttribute(t,{height:n.formatUnit(f)}),n.setStyleAttribute(u,{height:n.formatUnit(f)}));i&&r&&(i.style.height="auto",r.style.height="auto",i.offsetHeight>0&&r.offsetHeight>0)&&(f=i.offsetHeight>r.offsetHeight?i.offsetHeight:r.offsetHeight,n.setStyleAttribute(i,{height:n.formatUnit(f)}),n.setStyleAttribute(r,{height:n.formatUnit(f)}))}},t.prototype.refreshUI=function(){var u,f,e,c,t,i,s,r,h,y;if(this.groupingChartTable&&((n.setStyleAttribute(this.groupingChartTable,{width:n.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingChartTable.querySelector("."+yi)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed)&&(u=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2,this.chartPanel.width=u<400?"398px":u,this.chartPanel.refreshOverflow()),this.updateChartAxisHeight(),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this)))),this.groupingTable&&((n.setStyleAttribute(this.groupingTable,{width:n.formatUnit(this.parent.grid?this.parent.getGridWidthAsNumber():this.parent.getWidthAsNumber())}),this.groupingTable&&this.groupingTable.querySelector("."+yi)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed)&&(f=this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2,this.gridPanel.width=f<400?"398px":f,this.gridPanel.refreshOverflow()),this.groupingTable.style.minWidth="400px",e=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],c=n.formatUnit(this.groupingTable.offsetWidth-parseInt(e.style.width,10)),n.setStyleAttribute(this.valuePanel,{width:e.style.width}),n.setStyleAttribute(this.rightAxisPanel,{width:c}),this.parent.showFieldList&&this.parent.pivotFieldListModule&&this.parent.pivotFieldListModule.element&&(clearTimeout(this.timeOutObj),this.timeOutObj=setTimeout(this.alignIcon.bind(this))),!this.parent.grid.element.querySelector(".e-group-row"))){t=this.parent.element.querySelector(".e-frozenheader").querySelector(".e-columnheader");n.addClass([t.querySelector(".e-headercell")],"e-group-row");n.setStyleAttribute(this.rowPanel,{height:this.parent.element.querySelector(".e-headercontent").offsetHeight+"px"});t.querySelector(".e-group-row").appendChild(this.rowAxisPanel);n.setStyleAttribute(t.querySelector(".e-group-row").querySelector(".e-headercelldiv"),{display:"none"});n.setStyleAttribute(t.querySelector(".e-group-row").querySelector(".e-sortfilterdiv"),{display:"none"});i=this.parent.element.querySelector(".e-headercontent").offsetHeight;n.setStyleAttribute(this.rowPanel,{height:i+"px"});this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler")&&(this.parent.element.querySelector(".e-frozenheader").querySelector(".e-rhandler").style.height=i+"px");for(var l=[].slice.call(this.parent.element.querySelector(".e-movableheader").querySelector("thead").querySelectorAll("tr")).filter(function(n){return n.childNodes.length>0}),a=i/l.length,o=0,v=l;o<v.length;o++)for(s=v[o],n.setStyleAttribute(s,{height:a+"px"}),r=0,h=[].slice.call(s.querySelectorAll(".e-rhandler"));r<h.length;r++)y=h[r],n.setStyleAttribute(y,{height:a+"px"})}},t.prototype.alignIcon=function(){var t,i=this.parent.pivotFieldListModule.element,r;(t="Table"===this.parent.currentView?this.parent.grid?this.parent.grid.element.offsetWidth:t:this.parent.chart?this.parent.pivotChartModule.getCalulatedWidth():t)&&(r=t<400?400:t,n.setStyleAttribute(i.querySelector("."+rt),{left:n.formatUnit(this.parent.enableRtl?-Math.abs(r-i.querySelector("."+rt).offsetWidth):r-i.querySelector("."+rt).offsetWidth),top:this.parent.element.querySelector(".e-hscroll")?this.parent.element.querySelector("."+rt).offsetHeight.toString()+"px":""}))},t.prototype.setGridRowWidth=function(){var a=this.parent.element.querySelector(".e-frozenheader").querySelector("colgroup").children[0],u,i,l;if(this.rowPanel.querySelector("."+v))if(this.parent.isAdaptive)this.parent.firstColWidth||((t=this.parent.grid.columns)&&t.length>0&&(t[0].width=this.resColWidth),this.parent.posCount=0,this.parent.grid.headerModule.refreshUI());else{var t,f=[].slice.call(this.rowPanel.querySelectorAll("."+ur)),e=f[f.length-1],o=e.querySelector("."+v).offsetWidth+e.querySelector(".e-indent-div").offsetWidth+20,r=n.formatUnit(o<this.resColWidth?this.resColWidth:o),s=this.parent.element.querySelector(".e-frozenheader").querySelector("table"),h=this.parent.element.querySelector(".e-frozencontent").querySelector("table"),y=this.parent.element.querySelector(".e-frozencontent").querySelector("colgroup").children[0],c=parseInt(r,10),p=this.parent.pivotColumns.length>0;for((t=this.parent.grid.columns)&&t.length>0&&(t[0].width=t[0].autoFit?t[0].width:(t[0].width,this.resColWidth,c>this.resColWidth?c:this.resColWidth)),u="olap"===this.parent.dataType?this.parent.renderModule.calculateColWidth(this.parent.olapEngineModule.pivotValues.length>0?this.parent.olapEngineModule.pivotValues[0].length:2):this.parent.renderModule.calculateColWidth(this.parent.dataSourceSettings.values.length>0&&this.parent.engineModule.pivotValues.length>0?this.parent.engineModule.pivotValues[0].length:2),i=0;i<t.length;i++)0!==i&&(t[i].columns?this.setColWidth(this.parent.renderModule.pivotColumns[i].columns,u):"auto"!==t[i].width?(l=t[i].customAttributes?t[i].customAttributes.cell.valueSort.levelName:"",t[i].width=t[i].autoFit||p&&this.parent.pivotColumns[i].autoFit?t[i].width:this.parent.renderModule.setSavedWidth(l,u)):t[i].minWidth=u);this.parent.posCount=0;this.parent.setGridColumns(this.parent.grid.columns);this.parent.grid.headerModule.refreshUI();this.parent.firstColWidth||(r=t[0].autoFit?t[0].width.toString():r,a.style.width=r,y.style.width=r,s.style.width=r,h.style.width=r,n.setStyleAttribute(s,{width:r}),n.setStyleAttribute(h,{width:r}))}else this.parent.grid.columns&&this.parent.grid.columns.length>0&&(this.parent.grid.columns[0].width=this.parent.grid.columns[0].width>this.resColWidth?this.parent.grid.columns[0].width:this.resColWidth),this.parent.grid.headerModule.refreshUI();this.groupingTable&&this.refreshUI()},t.prototype.setColWidth=function(n,t){for(var i=0;i<n.length;i++)n[i].columns?this.setColWidth(n[i].columns,t):n[i].autoFit||("auto"!==n[i].width?n[i].width=t:n[i].minWidth=t)},t.prototype.wireEvent=function(t){n.EventHandler.add(t,"mouseover",this.dropIndicatorUpdate,this);n.EventHandler.add(t,"mouseleave",this.dropIndicatorUpdate,this)},t.prototype.unWireEvent=function(t){n.EventHandler.remove(t,"mouseover",this.dropIndicatorUpdate);n.EventHandler.remove(t,"mouseleave",this.dropIndicatorUpdate)},t.prototype.dropIndicatorUpdate=function(t){(this.parent.isDragging&&t.target.classList.contains(si)&&"mouseover"===t.type||!this.parent.isDragging||!t.target.classList.contains(si)&&"mouseleave"===t.type)&&(n.removeClass([].slice.call(this.parent.element.querySelectorAll("."+ot)),yt),n.removeClass([].slice.call(this.parent.element.querySelectorAll("."+ot+"-last")),yt))},t.prototype.tapHoldHandler=function(t){var i=n.closest(t.originalEvent.target,"."+v),r;if(!n.isNullOrUndefined(i)&&this.parent.isAdaptive)return r=i.getBoundingClientRect(),this.parent.contextMenuModule.fieldElement=i,void this.parent.contextMenuModule.menuObj.open(r.top,r.left)},t.prototype.RefreshFieldsPanel=function(){if("pivot"===this.parent.dataType&&null!=this.parent.groupingBarSettings){if(n.selectAll("#"+this.parent.element.id+"_AllFields",this.parent.element).length>0)for(var t=0,i=n.selectAll("#"+this.parent.element.id+"_AllFields",this.parent.element);t<i.length;t++)i[t].remove();this.parent.groupingBarSettings.showFieldsPanel&&(this.groupingChartTable&&"Table"!==this.parent.displayOption.view&&"Table"!==this.parent.groupingBarSettings.displayMode&&(this.chartPanel=this.createToolbarUI(this.groupingChartTable)),this.groupingTable&&(this.gridPanel=this.createToolbarUI(this.groupingTable)),this.parent.axisFieldModule.render(),this.refreshUI())}},t.prototype.createToolbarUI=function(t){n.select("#"+this.parent.element.id+"_AllFields",t)&&n.select("#"+this.parent.element.id+"_AllFields",t).remove();t.prepend(n.createElement("div",{id:this.parent.element.id+"_AllFields"}));var i=new st.Toolbar({cssClass:yi+(this.parent.cssClass?" "+this.parent.cssClass:""),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,items:[{template:"<div class="+vo+"><\/div>"}],allowKeyboard:!1,width:this.parent.grid?this.parent.getGridWidthAsNumber()-2:this.parent.getWidthAsNumber()-2});return i.appendTo(n.select("#"+this.parent.element.id+"_AllFields",t)),i},t.prototype.addEventListener=function(){this.handlers={load:this.renderLayout,end:this.appendToElement};this.parent.isDestroyed||(this.parent.on(af,this.handlers.load,this),this.parent.on(oi,this.handlers.end,this))},t.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(oi,this.handlers.end),this.parent.off(af,this.handlers.load))},t.prototype.destroy=function(){this.removeEventListener();this.parent.pivotButtonModule&&this.parent.pivotButtonModule.destroy();this.groupingTable&&this.groupingTable.querySelector("."+yi)&&null!=this.gridPanel&&!this.gridPanel.isDestroyed&&(this.gridPanel.destroy(),this.gridPanel=null);this.groupingChartTable&&this.groupingChartTable.querySelector("."+yi)&&null!=this.chartPanel&&!this.chartPanel.isDestroyed&&(this.chartPanel.destroy(),this.chartPanel=null);this.touchObj&&!this.touchObj.isDestroyed&&this.touchObj.destroy();this.parent.element.querySelector("."+kt)&&n.remove(this.parent.element.querySelector("."+kt))},t}(),ap=function(){function t(n){this.parent=n;this.parent.conditionalFormattingModule=this;this.parentID=this.parent.element.id;this.dialog=null;this.fieldsDropDown=[];this.conditionsDropDown=[];this.fontNameDropDown=[];this.fontSizeDropDown=[];this.fontColor=[];this.backgroundColor=[];this.newFormat=[]}return t.prototype.getModuleName=function(){return"conditionalFormatting"},t.prototype.createDialog=function(){null!==n.select("#"+this.parentID+"conditionalformatting",document)&&n.remove(n.select("#"+this.parentID+"conditionalformatting",document));this.parent.element.appendChild(n.createElement("div",{id:this.parentID+"conditionalformatting",className:"e-pivot-formatting-dialog"}));var t=[{click:this.addButtonClick.bind(this),buttonModel:{cssClass:(this.parent.isAdaptive?"e-small e-round "+nl:nl)+(this.parent.cssClass?" "+this.parent.cssClass:""),iconCss:e+" "+wu,content:this.parent.isAdaptive?"":this.parent.localeObj.getConstant("condition")}},{click:this.applyButtonClick.bind(this),isFlat:!0,buttonModel:{isPrimary:!0,cssClass:"e-format-apply-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("apply")}},{click:this.cancelButtonClick.bind(this),isFlat:!0,buttonModel:{cssClass:"e-format-cancel-button"+(this.parent.cssClass?" "+this.parent.cssClass:""),content:this.parent.localeObj.getConstant("cancel")}}];this.dialog=this.parent.isAdaptive?new b.Dialog({animationSettings:{effect:"Zoom"},isModal:!0,width:"100%",height:"100%",showCloseIcon:!1,closeOnEscape:!1,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,position:{X:"center",Y:"center"},allowDragging:!0,buttons:t,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,header:this.parent.localeObj.getConstant("conditionalFormating"),target:document.body}):new b.Dialog({allowDragging:!0,position:{X:"center",Y:this.parent.element.offsetTop},buttons:t,beforeOpen:this.beforeOpen.bind(this),close:this.removeDialog.bind(this),cssClass:this.parent.cssClass,isModal:!0,closeOnEscape:!0,enableRtl:this.parent.enableRtl,locale:this.parent.locale,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,showCloseIcon:!0,header:this.parent.localeObj.getConstant("conditionalFormating"),target:this.parent.element});this.dialog.isStringTemplate=!0;this.dialog.appendTo("#"+this.parentID+"conditionalformatting")},t.prototype.beforeOpen=function(){this.dialog.element.querySelector(".e-dlg-header").setAttribute("title",this.parent.localeObj.getConstant("conditionalFormating"))},t.prototype.addButtonClick=function(){var t=this,n=this;this.parent.trigger("conditionalFormatting",{conditions:"LessThan",value1:0,applyGrandTotals:!0,style:{backgroundColor:"white",color:"black",fontFamily:"Arial",fontSize:"12px"}},function(i){n.refreshConditionValues();t.destroyColorPickers();n.newFormat.push(i);n.addFormat()})},t.prototype.applyButtonClick=function(){if(this.refreshConditionValues()){this.parent.setProperties({dataSourceSettings:{conditionalFormatSettings:this.newFormat}},!0);var n={conditionalFormattingInfo:this.parent.dataSourceSettings.conditionalFormatSettings};this.parent.actionObj.actionInfo=n;this.parent.dataSourceSettings.values.length>0&&this.parent.renderPivotGrid();this.dialog.close()}},t.prototype.cancelButtonClick=function(){this.dialog.close();this.newFormat=[]},t.prototype.refreshConditionValues=function(){for(var t=0;t<this.newFormat.length;t++){if(""===n.select("#"+this.parentID+"conditionvalue1"+t,document).value||""===n.select("#"+this.parentID+"conditionvalue2"+t,document).value)return""===n.select("#"+this.parentID+"conditionvalue1"+t,document).value?n.select("#"+this.parentID+"conditionvalue1"+t,document).focus():n.select("#"+this.parentID+"conditionvalue2"+t,document).focus(),!1;this.newFormat[t].value1=Number(n.select("#"+this.parentID+"conditionvalue1"+t,document).value);this.newFormat[t].value2=Number(n.select("#"+this.parentID+"conditionvalue2"+t,document).value)}return!0},t.prototype.addFormat=function(){for(var r,u,i=n.createElement("div",{id:this.parentID+"formatDiv",className:"e-new-format"}),t=0;t<this.newFormat.length;t++)i.appendChild(this.createDialogElements(t));for(0===this.newFormat.length&&(r=this.createDialogElements(),u=n.createElement("p",{id:this.parentID+"emptyFormat",className:"e-pivot-conditional-empty-format"}),u.innerText=this.parent.localeObj.getConstant("emptyFormat"),r.appendChild(u),i.appendChild(r)),this.dialog.setProperties({content:i},!1),t=0;t<this.newFormat.length;t++)this.renderDropDowns(t),this.renderColorPicker(t)},t.prototype.createDialogElements=function(t){var o=n.createElement("div",{id:this.parentID+"outerDiv"+t,className:"e-format-outer-div"}),f,y,h,w,c,b,e,k,d,g,l,a,nt,v,tt,it,rt,ut;if(void 0!==t){f=this.newFormat[t];y=n.createElement("button",{id:this.parentID+"removeButton"+t,className:"e-format-delete-button",attrs:{type:"button",title:this.parent.localeObj.getConstant("delete")}});o.appendChild(y);var s=n.createElement("div",{id:this.parentID+"innerDiv"+t,className:"e-format-inner-div"}),u=n.createElement("table",{id:this.parentID+"cftable"+t,className:tl,attrs:{role:"table"}}),r=n.createElement("tr"),i=n.createElement("td"),p=n.createElement("span",{id:this.parentID+"valuelabel"+t,className:"e-format-value-label"});p.innerText=this.parent.localeObj.getConstant("value");i.appendChild(p);r.appendChild(i);u.appendChild(r);r=n.createElement("tr");i=n.createElement("td");h=n.createElement("div",{id:this.parentID+"measure"+t});w=n.createElement("input",{id:this.parentID+"measureinput"+t,attrs:{type:"text",tabindex:"0"}});h.appendChild(w);i.appendChild(h);r.appendChild(i);i=n.createElement("td");c=n.createElement("div",{id:this.parentID+"condition"+t});b=n.createElement("input",{id:this.parentID+"conditioninput"+t,attrs:{type:"text",tabindex:"0"}});c.appendChild(b);i.appendChild(c);r.appendChild(i);i=n.createElement("td");e="Between"!==f.conditions&&"NotBetween"!==f.conditions?"display:none; width:10px":"";k=n.createElement("input",{id:this.parentID+"conditionvalue1"+t,attrs:{type:"text",tabindex:"0",value:n.isNullOrUndefined(f.value1)?"0":f.value1.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive?""===e?"width: 35%":"width: 100%":""===e?"width: 45px":"width: 120px",className:os+" e-format-value1"});i.appendChild(k);d=n.createElement("span",{id:this.parentID+"valuespan"+t,className:"e-format-value-span",innerHTML:"&",styles:e});i.appendChild(d);g=n.createElement("input",{id:this.parentID+"conditionvalue2"+t,attrs:{type:"text",tabindex:"0",value:n.isNullOrUndefined(f.value2)?"0":f.value2.toString(),placeholder:this.parent.localeObj.getConstant("emptyInput")},styles:this.parent.isAdaptive&&""===e?"width: 35%":""===e?"width: 45px":e,className:os+" e-format-value2"});i.appendChild(g);r.appendChild(i);u.appendChild(r);this.parent.isAdaptive&&(s.appendChild(u),u=n.createElement("table",{id:this.parentID+"cftable",className:tl,attrs:{role:"table"}}));r=n.createElement("tr");i=n.createElement("td");l=n.createElement("span",{id:this.parentID+"formatlabel"+t,className:"e-format-label"});l.innerText=this.parent.localeObj.getConstant("formatLabel");i.appendChild(l);r.appendChild(i);u.appendChild(r);r=n.createElement("tr");i=n.createElement("td");a=n.createElement("div",{id:this.parentID+"fontname"+t});nt=n.createElement("input",{id:this.parentID+"fontnameinput"+t,attrs:{type:"text",tabindex:"0"}});a.appendChild(nt);i.appendChild(a);r.appendChild(i);i=n.createElement("td");v=n.createElement("div",{id:this.parentID+"fontsize"+t});tt=n.createElement("input",{id:this.parentID+"fontsizeinput"+t,attrs:{type:"text",tabindex:"0"}});v.appendChild(tt);i.appendChild(v);r.appendChild(i);this.parent.isAdaptive&&(u.appendChild(r),r=n.createElement("tr"),u.appendChild(r),r=n.createElement("tr"));i=n.createElement("td");it=n.createElement("input",{id:this.parentID+"fontcolor"+t,attrs:{type:"color",tabindex:"0"},className:"e-format-font-color"});i.appendChild(it);rt=n.createElement("input",{id:this.parentID+"backgroundcolor"+t,attrs:{type:"color",tabindex:"0"},className:"e-format-back-color"});i.appendChild(rt);r.appendChild(i);i=n.createElement("td");ut=n.createElement("div",{id:this.parentID+"valuepreview"+t,className:os+" e-format-value-preview",innerHTML:"123.45"});i.appendChild(ut);r.appendChild(i);u.appendChild(r);s.appendChild(u);o.appendChild(s)}return o},t.prototype.renderDropDowns=function(t){var i=this.newFormat[t],e=[],u,f,r,o;for(e.push({index:0,name:this.parent.localeObj.getConstant("AllValues"),field:this.parent.localeObj.getConstant("AllValues")}),u=0;u<this.parent.dataSourceSettings.values.length;u++)f=this.parent.dataSourceSettings.values[u].caption||this.parent.dataSourceSettings.values[u].name,f=this.parent.enableHtmlSanitizer?n.SanitizeHtmlHelper.sanitize(f):f,e.push({index:u+1,name:f,field:this.parent.dataSourceSettings.values[u].name});r=n.isNullOrUndefined(i.measure)?this.parent.localeObj.getConstant("AllValues"):i.measure;this.fieldsDropDown[t]=new y.DropDownList({dataSource:e,fields:{text:"name",value:"field"},value:r,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.measureChange.bind(this,t)});this.fieldsDropDown[t].isStringTemplate=!0;this.fieldsDropDown[t].appendTo("#"+this.parentID+"measureinput"+t);o=[{value:"LessThan",name:this.parent.localeObj.getConstant("LessThan")},{value:"LessThanOrEqualTo",name:this.parent.localeObj.getConstant("LessThanOrEqualTo")},{value:"GreaterThan",name:this.parent.localeObj.getConstant("GreaterThan")},{value:"GreaterThanOrEqualTo",name:this.parent.localeObj.getConstant("GreaterThanOrEqualTo")},{value:"Equals",name:this.parent.localeObj.getConstant("Equals")},{value:"NotEquals",name:this.parent.localeObj.getConstant("NotEquals")},{value:"Between",name:this.parent.localeObj.getConstant("Between")},{value:"NotBetween",name:this.parent.localeObj.getConstant("NotBetween")}];r=n.isNullOrUndefined(i.conditions)?"LessThan":i.conditions;this.conditionsDropDown[t]=new y.DropDownList({dataSource:o,fields:{value:"value",text:"name"},value:r,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupHeight:"200px",popupWidth:"auto",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.conditionChange.bind(this,t)});this.conditionsDropDown[t].isStringTemplate=!0;this.conditionsDropDown[t].appendTo("#"+this.parentID+"conditioninput"+t);r=n.isNullOrUndefined(i.style.fontFamily)?"Arial":i.style.fontFamily;this.fontNameDropDown[t]=new y.DropDownList({dataSource:[{index:0,name:"Arial"},{index:1,name:"San Serif"},{index:2,name:"Impact"},{index:3,name:"Trebuchet MS"},{index:4,name:"Serif"},{index:5,name:"Verdana"},{index:6,name:"Courier New"},{index:7,name:"Times New Roman"},{index:8,name:"Tahoma"},{index:9,name:"Gerogia"}],fields:{text:"name"},value:r,width:this.parent.isAdaptive?"100%":"120px",cssClass:this.parent.cssClass,popupWidth:"150px",popupHeight:"200px",locale:this.parent.locale,enableRtl:this.parent.enableRtl,change:this.fontNameChange.bind(this,t)});this.fontNameDropDown[t].isStringTemplate=!0;this.fontNameDropDown[t].appendTo("#"+this.parentID+"fontnameinput"+t);r=n.isNullOrUndefined(i.style.fontSize)?"12px":i.style.fontSize;this.fontSizeDropDown[t]=new y.DropDownList({dataSource:[{index:0,name:"9px"},{index:1,name:"10px"},{index:2,name:"11px"},{index:3,name:"12px"},{index:4,name:"13px"},{index:5,name:"14px"},{index:6,name:"15px"},{index:6,name:"16px"}],fields:{text:"name"},popupHeight:"200px",value:r,width:this.parent.isAdaptive?"100%":"120px",change:this.fontSizeChange.bind(this,t),locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:this.parent.cssClass});this.fontSizeDropDown[t].isStringTemplate=!0;this.fontSizeDropDown[t].appendTo("#"+this.parentID+"fontsizeinput"+t)},t.prototype.conditionChange=function(t,i){this.newFormat[t].conditions=i.value;"Between"===i.value||"NotBetween"===i.value?(n.select("#"+this.parentID+"valuespan"+t,document).style.display="inline-block",n.select("#"+this.parentID+"valuespan"+t,document).style.width=this.parent.isAdaptive?"10%":"10px",n.select("#"+this.parentID+"conditionvalue2"+t,document).style.display="inline-block",n.select("#"+this.parentID+"conditionvalue2"+t,document).style.width=this.parent.isAdaptive?"35%":"45px",n.select("#"+this.parentID+"conditionvalue1"+t,document).style.width=this.parent.isAdaptive?"35%":"45px"):(n.select("#"+this.parentID+"valuespan"+t,document).style.display="none",n.select("#"+this.parentID+"conditionvalue2"+t,document).style.display="none",n.select("#"+this.parentID+"conditionvalue1"+t,document).style.width=this.parent.isAdaptive?"100%":"120px")},t.prototype.fontNameChange=function(t,i){this.newFormat[t].style.fontFamily=i.value.toString();n.select("#"+this.parentID+"valuepreview"+t,document).style.fontFamily=i.value},t.prototype.fontSizeChange=function(t,i){this.newFormat[t].style.fontSize=i.value.toString();n.select("#"+this.parentID+"valuepreview"+t,document).style.fontSize=i.value},t.prototype.measureChange=function(n,t){this.newFormat[n].measure=t.value.toString()===this.parent.localeObj.getConstant("AllValues")?void 0:t.value.toString()},t.prototype.renderColorPicker=function(t){var r=this.newFormat[t],i=n.isNullOrUndefined(r.style.color)?"black":r.style.color,u=this.isHex(i.substr(1))?i:this.colourNameToHex(i),f;n.select("#"+this.parentID+"valuepreview"+t,document).style.color=u;this.fontColor[t]=new it.ColorPicker({cssClass:il+" e-format-font-color-picker"+(this.parent.cssClass?" "+this.parent.cssClass:""),value:u,mode:"Palette",change:this.fontColorChange.bind(this,t),locale:this.parent.locale,enableRtl:this.parent.enableRtl});this.fontColor[t].isStringTemplate=!0;this.fontColor[t].appendTo("#"+this.parentID+"fontcolor"+t);n.addClass([this.fontColor[t].element.nextElementSibling.querySelector(".e-selected-color")],e);i=n.isNullOrUndefined(r.style.backgroundColor)?"white":r.style.backgroundColor;u=this.isHex(i.substr(1))?i:this.colourNameToHex(i);n.select("#"+this.parentID+"valuepreview"+t,document).style.backgroundColor=u;n.select("#"+this.parentID+"valuepreview"+t,document).style.fontFamily=r.style.fontFamily;n.select("#"+this.parentID+"valuepreview"+t,document).style.fontSize=r.style.fontSize;this.backgroundColor[t]=new it.ColorPicker({cssClass:il+(this.parent.cssClass?" "+this.parent.cssClass:""),value:u,mode:"Palette",change:this.backColorChange.bind(this,t),locale:this.parent.locale,enableRtl:this.parent.enableRtl});this.backgroundColor[t].isStringTemplate=!0;this.backgroundColor[t].appendTo("#"+this.parentID+"backgroundcolor"+t);n.addClass([this.backgroundColor[t].element.nextElementSibling.querySelector(".e-selected-color")],e);f=new ht.Button({iconCss:e+" e-format-delete-icon",cssClass:se+(this.parent.cssClass?" "+this.parent.cssClass:""),locale:this.parent.locale,enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer});f.isStringTemplate=!0;f.appendTo("#"+this.parentID+"removeButton"+t);f.element.onclick=this.toggleButtonClick.bind(this,t)},t.prototype.backColorChange=function(t,i){this.newFormat[t].style.backgroundColor=i.currentValue.hex;n.select("#"+this.parentID+"valuepreview"+t,document).style.backgroundColor=i.currentValue.hex},t.prototype.fontColorChange=function(t,i){this.newFormat[t].style.color=i.currentValue.hex;n.select("#"+this.parentID+"valuepreview"+t,document).style.color=i.currentValue.hex},t.prototype.toggleButtonClick=function(n){this.destroyColorPickers();this.newFormat.splice(n,1);this.addFormat()},t.prototype.isHex=function(n){for(var t=parseInt(n,16);"0"===n.charAt(0);)n=n.substr(1);return t.toString(16)===n.toLowerCase()||0===t&&""===n},t.prototype.hexToRgb=function(n){var t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(n);return t?{r:parseInt(t[1],16),g:parseInt(t[2],16),b:parseInt(t[3],16)}:null},t.prototype.colourNameToHex=function(n){var u={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"};if(void 0!==u[n.toLowerCase()])return u[n.toLowerCase()];if(0===n.search("rgba")){for(var i=n.substr(5).split(")")[0].split(","),r="",t=0;t<i.length-1;t++)i[t]=(+i[t]).toString(16),1===i[t].length&&(i[t]="0"+i[t]),r+=i[t];return"#"+r+Math.round(255*+i[3]).toString(16)}if(0===n.search("rgb")){for(i=n.substr(4).split(")")[0].split(","),r="",t=0;t<i.length;t++)i[t]=(+i[t]).toString(16),1===i[t].length&&(i[t]="0"+i[t]),r+=i[t];return"#"+r}return"#d5d5d5"},t.prototype.removeDialog=function(){this.dialog&&!this.dialog.isDestroyed&&(this.destroyColorPickers(),this.dialog.destroy());n.select("#"+this.parentID+"conditionalformatting",document)&&n.remove(n.select("#"+this.parentID+"conditionalformatting",document))},t.prototype.destroyColorPickers=function(){for(var n=0;n<(this.newFormat?this.newFormat.length:0);n++)this.fontColor&&this.fontColor[n]&&!this.fontColor[n].isDestroyed&&this.fontColor[n].destroy(),this.backgroundColor&&this.backgroundColor[n]&&!this.backgroundColor[n].isDestroyed&&this.backgroundColor[n].destroy()},t.prototype.showConditionalFormattingDialog=function(){this.newFormat=[];for(var t=0;t<this.parent.dataSourceSettings.conditionalFormatSettings.length;t++)this.newFormat.push(n.extend({},this.parent.dataSourceSettings.conditionalFormatSettings[t].properties,null,!0));this.createDialog();this.dialog.refresh();this.addFormat()},t.prototype.destroy=function(){this.dialog&&!this.dialog.isDestroyed&&this.dialog.close()},t}();gl.Inject(lp,ap,vl);ye={};ye.PivotView=gl;sa={pivotview:ye=pe.C(window.ejdashboard?window.ejdashboard.pivotview:{},ye)};window.ejdashboard=pe.C(window.ejdashboard||{},sa)})()})();
