/*!
*  filename: ej2.heatmap.all.min.js
*  version : 6.7.11.11
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function t(r){var f=n[r],u;return void 0!==f?f.exports:(u=n[r]={exports:{}},i[r](u,u.exports,t),u.exports)}var i={665:(n,t)=>{t.J=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},n={};(()=>{function p(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function r(t,i){var r=document.getElementById("heatmapmeasuretext");return null===r&&(r=n.createElement("text",{id:"heatmapmeasuretext"}),document.body.appendChild(r)),r.innerText=t,r.style.position="absolute",r.style.visibility="hidden",r.style.fontSize=-1!==i.size.indexOf("px")?i.size:i.size+"px",r.style.fontWeight=i.fontWeight,r.style.fontStyle=i.fontStyle,r.style.fontFamily=i.fontFamily,r.style.top="-100",r.style.left="0",r.style.whiteSpace="nowrap",r.style.lineHeight="normal",new o(r.clientWidth,r.clientHeight)}function ci(n,t,i,r){return"Near"===r.textAlignment?t:"Center"===r.textAlignment?t+n/2:n+t}function v(n){for(var i=0,t=0,r=n;t<r.length;t++)i+=r[t];return i}function li(t,i,r){var e=new tt.SvgRenderer("heatmapMeasureRotateText"),f=e.createSvg({id:"heatmapMeasureRotateText_svg",width:100,height:100}),h={"font-size":t.size,"font-style":t.fontStyle.toLowerCase(),"font-family":t.fontFamily,"font-weight":t.fontWeight.toLowerCase(),transform:"rotate("+r+", 0, 0)","text-anchor":"middle"},s=e.createText(h,i),u;return f.appendChild(s),document.body.appendChild(f),u=s.getBoundingClientRect(),n.remove(f),new o(u.right-u.left,u.bottom-u.top)}function st(n,t,i){var u=[];switch(t.textOverflow){case"Wrap":u=wt(n,i,t);break;case"Trim":u.push(y(i,n,t));break;default:u.push(function(n,t,i){var f=t,e=r(t,i).width,u;if(e>n)for(u=t.length-1;u>=0;--u)if((e=r(f=t.substring(0,u),i).width)<=n)return f;return f}(i,n,t))}return u}function wt(n,t,i){for(var f,s=n.split(" "),u="",e=[],o=0,h=s.length;o<h;o++)f=s[o],r(u.concat(f),i).width<t?u=u.concat((""===u?"":" ")+f):""!==u?(e.push(y(t,u,i)),u=f):(e.push(y(t,f,i)),f=""),u&&o===h-1&&e.push(y(t,u,i));return e}function y(n,t,i){var f=t,e=r(t,i).width,u;if(e>n)for(u=t.length-1;u>=0;--u)if((e=r(f=t.substring(0,u)+"...",i).width)<=n)return f;return f}function ht(t,i,u,f,e,o,s,h){var l=document.getElementById(e),a=r(t,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),v=a.width+5;i=(i=i+v>f?i-v:i)<0?5:i;l?(l.innerText=t,l.style.top=(u+15).toString()+"px",l.style.left=(i+15).toString()+"px"):((l=n.createElement("div",{id:e,styles:"top:"+(u+15).toString()+"px;left:"+(i+15).toString()+"px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: Segoe UI"})).innerText=t,o.appendChild(l));t===h.titleSettings.text?l.style.width=i+15+a.width+7>h.availableSize.width?(h.availableSize.width-(i+15)).toString()+"px":"":(l.style.left=i+15+a.width+7>h.availableSize.width?(h.availableSize.width-(a.width+7)).toString()+"px":i.toString()+"px",l.style.top=u+15+a.height+6>h.availableSize.height?(u-(a.height+6)-10).toString()+"px":l.style.top);s&&setTimeout(function(){c(e)},1500)}function c(t){var i=ut(t);i&&n.remove(i)}function ut(n){return document.getElementById(n)}function ct(n,t,i,r){var u=new Date(n);switch(t=Math.ceil(t*r),i){case"Years":u.setFullYear(u.getFullYear()+t);break;case"Months":u.setMonth(u.getMonth()+t);break;case"Days":u.setDate(u.getDate()+t);break;case"Hours":u.setHours(u.getHours()+t);break;case"Minutes":u.setMinutes(u.getMinutes()+t)}return u}function bt(n,t,i){for(var f,r,e,o=n.length,u=0;u<o;u++)if(t>=(r=(f=n[u]).region).x&&t<=r.x+r.width&&i>=r.y&&i<=r.y+r.height){e=f.text;break}return e}function ei(n){var t=n.toString(16);return 1===t.length?"0"+t:t}function at(n,t,i,r){return n?t.replace("{value}",r(i)):r(i)}var ni,k,hi,ot,fi,nt,b,ai,gt,bi;ni=t(665);const n=ejdashboard.base,tt=ejdashboard.svgbase;!function(n){n.heatMapTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.titleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.axisTitleFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.rectLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.tooltipFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"}}(k||(k={}));var yt,a=(yt=function(n,t){return yt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},yt(n,t)},function(n,t){function i(){this.constructor=n}yt(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},it=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("16px")],r.prototype,"size",void 0),i([n.Property("")],r.prototype,"color",void 0),i([n.Property("Segoe UI")],r.prototype,"fontFamily",void 0),i([n.Property("Normal")],r.prototype,"fontWeight",void 0),i([n.Property("Normal")],r.prototype,"fontStyle",void 0),i([n.Property("Center")],r.prototype,"textAlignment",void 0),i([n.Property("Trim")],r.prototype,"textOverflow",void 0),r}(n.ChildProperty),ki=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property(10)],r.prototype,"left",void 0),i([n.Property(10)],r.prototype,"right",void 0),i([n.Property(10)],r.prototype,"top",void 0),i([n.Property(10)],r.prototype,"bottom",void 0),r}(n.ChildProperty),di=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("")],r.prototype,"radius",void 0),r}(n.ChildProperty),gi=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("")],r.prototype,"color",void 0),i([n.Property(0)],r.prototype,"width",void 0),r}(n.ChildProperty),nr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property(null)],r.prototype,"size",void 0),i([n.Property(null)],r.prototype,"color",void 0),r}(n.ChildProperty),ti=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("")],r.prototype,"text",void 0),i([n.Complex({},it)],r.prototype,"textStyle",void 0),r}(n.ChildProperty),tr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("#eeeeee")],r.prototype,"minColor",void 0),i([n.Property("#eeeeee")],r.prototype,"maxColor",void 0),r}(n.ChildProperty),ir=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property(null)],r.prototype,"value",void 0),i([n.Property(null)],r.prototype,"color",void 0),i([n.Property(null)],r.prototype,"label",void 0),i([n.Property(null)],r.prototype,"startValue",void 0),i([n.Property(null)],r.prototype,"endValue",void 0),i([n.Property(null)],r.prototype,"minColor",void 0),i([n.Property(null)],r.prototype,"maxColor",void 0),r}(n.ChildProperty),oi=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("#b5b5b5")],r.prototype,"color",void 0),i([n.Property(1)],r.prototype,"width",void 0),i([n.Property("Rectangle")],r.prototype,"type",void 0),r}(n.ChildProperty),rr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("0%")],r.prototype,"minimum",void 0),i([n.Property("100%")],r.prototype,"maximum",void 0),r}(n.ChildProperty),ur=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property(null)],r.prototype,"start",void 0),i([n.Property(null)],r.prototype,"end",void 0),i([n.Property("")],r.prototype,"text",void 0),i([n.Property(null)],r.prototype,"maximumTextWidth",void 0),r}(n.ChildProperty),fr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return a(r,t),i([n.Property("Center")],r.prototype,"alignment",void 0),i([n.Property("Wrap")],r.prototype,"overflow",void 0),i([n.Complex(k.axisLabelFont,it)],r.prototype,"textStyle",void 0),i([n.Complex({color:"#b5b5b5",width:1,type:"Rectangle"},oi)],r.prototype,"border",void 0),i([n.Collection([],ur)],r.prototype,"categories",void 0),r}(n.ChildProperty),er=function(){return function(n,t,i,r,u,f,e){this.value=n;this.color=t;this.label=i;this.startValue=r;this.endValue=u;this.minColor=f;this.maxColor=e}}(),or=function(){return function(n,t,i){this.mappingName=n;this.bubbleData=t;this.valueType=i}}(),ii=function(){return function(n,t,i,r,u,f,e,o){this.value=n;this.color=t;this.label=i;this.startValue=r;this.endValue=u;this.minColor=f;this.maxColor=e;this.isHidden=o}}(),sr=function(){return function(n,t,i,r,u){this.index=1;this.row=1;this.start=n;this.end=t;this.index=i;this.label=r;this.row=u}}(),hr=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),et=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},cr=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return hr(i,t),et([n.Collection([{}],ir)],i.prototype,"palette",void 0),et([n.Property("Gradient")],i.prototype,"type",void 0),et([n.Property("")],i.prototype,"emptyPointColor",void 0),et([n.Property("Table")],i.prototype,"colorGradientMode",void 0),et([n.Complex({},tr)],i.prototype,"fillColor",void 0),i}(n.ChildProperty),pt=function(){return function(n,t,i){this.R=n;this.G=t;this.B=i}}(),si=function(){function t(n){this.heatMap=n}return t.prototype.convertToRGB=function(n,t){var o,s,f=this.heatMap.isColorRange?t[0].startValue:t[0].value,u=0,i=0,r,e;if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)for(i=0;i<t.length;i++){if(n<=(r=Number(t[i].endValue))&&n>=Number(t[i].startValue)){u=r;o=this.heatMap.colorCollection[i].minColor;s=this.heatMap.colorCollection[i].maxColor;break}if(t[0].startValue!==this.heatMap.dataSourceMinValue&&n<t[0].startValue){u=t[0].startValue;f=this.heatMap.dataSourceMinValue;o=this.heatMap.paletteSettings.fillColor.minColor;s=this.heatMap.paletteSettings.fillColor.maxColor;break}if(n>r&&n<=(i===t.length-1?this.heatMap.dataSourceMaxValue:t[i+1].startValue)){u=i===t.length-1?this.heatMap.dataSourceMaxValue:t[i+1].startValue;f=r;o=this.heatMap.paletteSettings.fillColor.minColor;s=this.heatMap.paletteSettings.fillColor.maxColor;break}u=r;f=r}else for(i=1;i<t.length;i++){if(n<=(r=Number(t[i].value))){u=r;o=this.getEqualColor(t,f);s=this.getEqualColor(t,u);break}u=r;f=r}return e=0,e=(n-f)/(u-f),e=isNaN(e)?0:e,this.getPercentageColor(e,o,s)},t.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},t.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},t.prototype.getEqualColor=function(n,t){for(var i,r=0;r<n.length;r++)if(Number(n[r].value)===t)return i=n[r].color,-1!==i.indexOf("rgb")?i=this.convertToHex(i):-1===i.indexOf("#")&&(i="#FFFFFF"),i;return"#00000"},t.prototype.convertToHex=function(n){var i=n.substr(3),t=(i=i.split("(")[1].split(")")[0]).split(",");return this.rgbToHex(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))},t.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new pt(f,e,o)},t.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},t.prototype.getColorCollection=function(){var o,t=this.heatMap,f,u,e,i,r;for(t.colorCollection=[],t.legendColorCollection=[],f=0;f<this.heatMap.paletteSettings.palette.length;f++){if(null===this.heatMap.paletteSettings.palette[f].startValue||null===this.heatMap.paletteSettings.palette[f].endValue){this.heatMap.isColorRange=!1;break}this.heatMap.isColorRange=!0}if(u=t.bubbleSizeWithColor?t.minColorValue:t.dataSourceMinValue,e=t.bubbleSizeWithColor?t.maxColorValue:t.dataSourceMaxValue,t.emptyPointColor=t.paletteSettings.emptyPointColor?t.paletteSettings.emptyPointColor:t.themeStyle.emptyCellColor,i=this.orderbyOffset(this.heatMap.isColorRange||t.paletteSettings.palette&&t.paletteSettings.palette.length>1?t.paletteSettings.palette:t.themeStyle.palette),i.isCompact)t.colorCollection=i.offsets,t.legendColorCollection=n.extend([],i.offsets,null,!0);else if(o="Gradient"===t.paletteSettings.type?(e-u)/(i.offsets.length-1):(e-u)/i.offsets.length,i.offsets.length>=2)for(r=0;r<i.offsets.length;r++)t.colorCollection.push(new er(Math.round(100*(u+r*o))/100,i.offsets[r].color,i.offsets[r].label,i.offsets[r].startValue,i.offsets[r].endValue,i.offsets[r].minColor,i.offsets[r].maxColor)),t.legendColorCollection.push(new ii(Math.round(100*(u+r*o))/100,i.offsets[r].color,i.offsets[r].label,i.offsets[r].startValue,i.offsets[r].endValue,i.offsets[r].minColor,i.offsets[r].maxColor,!1));this.heatMap.isColorRange||this.updateLegendColorCollection(u,e,i)},t.prototype.updateLegendColorCollection=function(n,t,i){"Fixed"===this.heatMap.paletteSettings.type&&(i.isCompact||i.isLabel)||(Math.round(100*n)/100<this.heatMap.legendColorCollection[0].value&&this.heatMap.legendColorCollection.unshift(new ii(Math.round(100*n)/100,this.heatMap.legendColorCollection[0].color,this.heatMap.legendColorCollection[0].label,this.heatMap.legendColorCollection[0].startValue,this.heatMap.legendColorCollection[0].endValue,this.heatMap.legendColorCollection[0].minColor,this.heatMap.legendColorCollection[0].maxColor,!0)),Math.round(100*t)/100>this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].value&&this.heatMap.legendColorCollection.push(new ii(Math.round(100*t)/100,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].color,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].label,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].startValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].endValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].minColor,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].maxColor,!0)))},t.prototype.orderbyOffset=function(t){var i=new wr,r=this.heatMap.isColorRange?"to":"value",u="label";return i.isCompact=!0,i.isLabel=!0,i.offsets=t.sort(function(t,f){return n.isNullOrUndefined(t[u])&&n.isNullOrUndefined(f[u])&&(i.isLabel=!1),n.isNullOrUndefined(t[r])||n.isNullOrUndefined(f[r])?(i.isCompact=!1,t):t[r]-f[r]}),i.isCompact||(i.offsets=this.heatMap.paletteSettings.palette&&this.heatMap.paletteSettings.palette.length>1?this.heatMap.paletteSettings.palette:this.heatMap.themeStyle.palette),i},t.prototype.getColorByValue=function(n){var u,i="",f=0,t,e,r;if(""!==n.toString())if("Bubble"!==this.heatMap.cellSettings.tileType||"Size"!==this.heatMap.cellSettings.bubbleType&&"Sector"!==this.heatMap.cellSettings.bubbleType)if("Fixed"===this.heatMap.paletteSettings.type){for(t=0;t<this.heatMap.colorCollection.length;t++)if(f=this.heatMap.isColorRange?this.heatMap.paletteSettings.palette[t].startValue:this.heatMap.colorCollection[t+1]?this.heatMap.colorCollection[t+1].value:this.heatMap.colorCollection[t].value,e=this.heatMap.dataSourceMinValue===this.heatMap.dataSourceMaxValue,this.heatMap.isColorRange){if(r=void 0,n<=this.heatMap.colorCollection[t].endValue&&n>=this.heatMap.colorCollection[t].startValue){this.heatMap.legendVisibilityByCellType&&(r=this.heatMap.legendModule.legendRange);i=this.heatMap.legendVisibilityByCellType&&r[t]&&!r[t].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[t].minColor;break}i=this.heatMap.paletteSettings.fillColor.minColor}else if(n<=f&&e&&0===t||n<f||n>=f&&t===this.heatMap.colorCollection.length-1){r=void 0;this.heatMap.legendVisibilityByCellType&&(r=this.heatMap.legendModule.legendRange);i=this.heatMap.legendVisibilityByCellType&&r[t]&&!r[t].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[t].color;break}}else"Table"!==this.heatMap.paletteSettings.colorGradientMode&&this.getColorCollection(),n<this.heatMap.colorCollection[0].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[0].color:n>this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].color:(u=this.convertToRGB(n,this.heatMap.colorCollection),i=this.rgbToHex(u.R,u.G,u.B));else i=this.heatMap.isColorRange?this.heatMap.colorCollection[0].minColor:this.heatMap.colorCollection[0].color;else i=this.heatMap.emptyPointColor;return i},t}(),rt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();hi=function(){return function(n,t){this["font-size"]=n.size;this["font-style"]=n.fontStyle.toLowerCase();this["font-family"]=n.fontFamily;this["font-weight"]=n.fontWeight.toLowerCase();this.fill=t||""}}();var o=function(){return function(n,t){this.width=n;this.height=t}}(),d=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t)||this;return s.opacity=f,s.fill=i,s.stroke=u||"",s["stroke-width"]=parseFloat(r.toString()),s["stroke-dasharray"]=e,s.d=o,s}return rt(t,n),t}(function(){return function(n){this.id=n}}()),lr=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.x=n;this.y=t;this.width=i;this.height=r;this.value=u;this.id=f;this.xIndex=e;this.yIndex=o;this.xValue=s;this.yValue=h;this.visible=c;this.displayText=l;this.textId=a;this.allowCollection=v}}(),ar=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l){this.value=n;this.xLabel=t;this.yLabel=i;this.xValue=r;this.yValue=u;this.cellElement=f;this.xPosition=e;this.yPosition=o;this.width=s;this.height=h;this.x=c;this.y=l}}(),w=function(n){function t(t,i,r,u,f,e,o,s,h,c){var l=n.call(this,t,i,r.width,e,u,c)||this;return l.y=f.y,l.x=f.x,l.height=f.height>0?f.height:0,l.width=f.width>0?f.width:0,l.rx=o||0,l.ry=s||0,l.transform=h||"",l}return rt(t,n),t}(d),vr=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,f,u)||this;return h.cx=e||0,h.cy=o||0,h.r=s||0,h}return rt(t,n),t}(d),u=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}(),s=function(n){function t(t,i,r,u){var f=n.call(this,r,u)||this;return f.transform="",f["dominant-baseline"]="auto",f.labelRotation=0,f.baseline="auto",f.id=t,f.x=i.x,f.y=i.y,f["text-anchor"]=i["text-anchor"],f.text=i.text,f.transform=i.transform,f.labelRotation=i.labelRotation,f["dominant-baseline"]=i["dominant-baseline"],f.baseline=i.baseline,f.dy=i.dy,f}return rt(t,n),t}(hi),h=function(){return function(n,t,i,r,u,f,e,o){this.transform="";this["dominant-baseline"]="auto";this.labelRotation=0;this.baseline="auto";this.x=n||0;this.y=t||0;this["text-anchor"]=i||"start";this.text=r||"";this.transform=f||"";this.labelRotation=u;this["dominant-baseline"]=e||"auto";this.baseline=e||"";this.dy=o||""}}(),ri=function(){return function(n,t,i,r){this.x1=n;this.y1=t;this.x2=i;this.y2=r}}(),ui=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,null,u,r,f,e,null)||this;return o.x1=i.x1,o.y1=i.y1,o.x2=i.x2,o.y2=i.y2,o}return rt(t,n),t}(d),yr=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,r,f,o,e,null)||this;return s.d=i.d,s.x=i.x,s.y=i.y,s}return rt(t,n),t}(d),pr=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l){this.d=n;this.innerR=t;this.cx=e;this.cy=o;this.x=i;this.y=r;this.x1=u;this.y1=f;this.start=s;this.end=h;this.radius=c;this.counterClockWise=l}}();ot=function(){function t(n){this.heatMap=n}return t.prototype.drawRectangle=function(n,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasRectangle(this.heatMap.canvasRenderer,n,i):(delete n.d,t.appendChild(this.heatMap.renderer.drawRectangle(n)))},t.prototype.drawCircle=function(n,t){this.heatMap.enableCanvasRendering?this.drawCanvasCircle(this.heatMap.canvasRenderer,n):(delete n.d,t.appendChild(this.heatMap.renderer.drawCircle(n)))},t.prototype.drawPath=function(n,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasPath(this.heatMap.canvasRenderer,n,t):(delete n.x,delete n.y,i.appendChild(this.heatMap.renderer.drawPath(n)))},t.prototype.createText=function(n,t,i){this.heatMap.enableCanvasRendering?this.canvasDrawText(n,i):(delete n.labelRotation,delete n.baseline,delete n.text,t.appendChild(this.heatMap.renderer.createText(n,i)),n.text=i)},t.prototype.createWrapText=function(n,t,i){var s,f,h,e,o,u,c;if(s={id:n.id,x:n.x,y:n.y,fill:n.fill,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight.toLowerCase(),"text-anchor":n["text-anchor"],transform:n.transform,"dominant-baseline":n["dominant-baseline"]},o=n.text[0],this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.createText(n,o):f=this.heatMap.renderer.createText(s,o),"string"!=typeof n.text&&n.text.length>1)for(u=1,c=n.text.length;u<c;u++)e=r(n.text[u],t).height,this.heatMap.enableCanvasRendering?(n.id=n.id+u,n.y+=e,this.heatMap.canvasRenderer.createText(n,n.text[u])):(h=this.heatMap.renderer.createTSpan({x:n.x,id:n.id+u,y:n.y+u*e},n.text[u]),f.appendChild(h));this.heatMap.enableCanvasRendering||i.appendChild(f)},t.prototype.drawLine=function(n,t){this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawLine(n):(delete n.d,t.appendChild(this.heatMap.renderer.drawLine(n)))},t.prototype.canvasDrawText=function(t,i,r,u){var f=this.heatMap.canvasRenderer.ctx,e;r||(r=t.x);u||(u=t.y);e=this.getOptionValue(t,"font-weight");n.isNullOrUndefined(e)||"regular"!==e.toLowerCase()||(e="normal");var s=this.getOptionValue(t,"font-family"),h=-1===t["font-size"].toString().indexOf("px")?t["font-size"]+"px":t["font-size"],o=this.getOptionValue(t,"text-anchor"),c=this.getOptionValue(t,"font-style").toLowerCase()+" "+e+" "+h+" "+s;"middle"===o&&(o="center");f.save();f.fillStyle=t.fill;f.font=c;f.textAlign=o;t.baseline&&(f.textBaseline=t.baseline);f.translate(r,u);f.rotate(t.labelRotation*Math.PI/180);f.fillText(i,t.x-r,t.y-u);f.restore()},t.prototype.getOptionValue=function(n,t){return n[t]},t.prototype.setAttributes=function(t,i){var r,u;t.ctx.lineWidth=i["stroke-width"];r=i["stroke-dasharray"];n.isNullOrUndefined(r)||(u=r.split(","),t.ctx.setLineDash([parseInt(u[0],10),parseInt(u[1],10)]));t.ctx.strokeStyle=i.stroke},t.prototype.drawCanvasRectangle=function(n,t,i){var r=n.ctx;n.ctx.save();n.ctx.beginPath();n.ctx.globalAlpha=t.opacity;this.setAttributes(n,t);this.drawCornerRadius(n,t);(t["stroke-width"]&&0!==t["stroke-width"]||i)&&n.ctx.stroke();n.ctx.restore();n.ctx=r},t.prototype.drawCornerRadius=function(n,t){var i=t.rx,r=t.x,u=t.y,f=t.width,e=t.height;"none"===t.fill&&(t.fill="transparent");n.ctx.fillStyle=t.fill;f<2*i&&(i=f/2);e<2*i&&(i=e/2);n.ctx.beginPath();n.ctx.moveTo(r+f-i,u);n.ctx.arcTo(r+f,u,r+f,u+e,i);n.ctx.arcTo(r+f,u+e,r,u+e,i);n.ctx.arcTo(r,u+e,r,u,i);n.ctx.arcTo(r,u,r+f,u,i);n.ctx.closePath();n.ctx.fill()},t.prototype.drawCanvasCircle=function(n,t){n.ctx.save();n.ctx.beginPath();n.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI);n.ctx.fillStyle=t.fill;n.ctx.globalAlpha=t.opacity;n.ctx.fill();this.setAttributes(n,t);t["stroke-width"]&&0!==t["stroke-width"]&&n.ctx.stroke();n.ctx.restore()},t.prototype.drawCanvasPath=function(n,t,i){var u=t.d.split(" "),r,f,e;for(n.ctx.save(),n.ctx.beginPath(),n.ctx.globalAlpha=t.opacity,n.ctx.fillStyle=t.fill,this.setAttributes(n,t),r=0;r<u.length;r+=3){f=parseFloat(u[r+1]);e=parseFloat(u[r+2]);switch(u[r]){case"M":n.ctx.moveTo(f,e);break;case"L":n.ctx.lineTo(f,e);break;case"A":case"a":n.ctx.arc(i.x,i.y,i.radius,.0174533*i.start,.0174533*i.end,!1);r="a"===u[r]?r+13:r+5;break;case"Z":n.ctx.closePath()}}n.ctx.fill();t["stroke-width"]&&0!==t["stroke-width"]&&n.ctx.stroke();n.ctx.restore()},t}();fi=function(){return function(n,t,i,r,u){this.id=n;this.x1=t;this.x2=i;this.y1=r;this.y2=u}}();nt=function(){return function(n,t){this.color=n;this.colorStop=t}}();b=function(){return function(n,t){this.region=new u(0,0,0,0);this.text=n;this.region=t}}();var wr=function(){return function(){}}(),br=function(){return function(n,t,i,r,u,f){this.pathX1=n;this.pathY1=t;this.pathX2=i;this.pathY2=r;this.pathX3=u;this.pathY3=f}}(),kr=function(){return function(n,t,i,r,u,f){this.x=n;this.y=t;this.width=i;this.height=r;this.label=u;this.id=f}}(),lt=function(){return function(n,t,i,r,u,f,e){this.x=n;this.y=t;this.width=i;this.height=r;this.value=u;this.visible=f;this.currentPage=e}}(),dr=function(){return function(n,t,i,r){this.visible=n;this.value=t;this.startValue=i;this.endValue=r}}();ai=function(){return function(n,t){this.x=n;this.y=t}}();const vt=ejdashboard.data;var gr=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),e=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},vi=function(t){function i(){var n=null!==t&&t.apply(this,arguments)||this;return n.multipleRow=[],n.rect=new u(void 0,void 0,0,0),n.nearSizes=[],n.farSizes=[],n.maxLabelSize=new o(0,0),n.titleSize=new o(0,0),n.multilevel=[],n.axisLabels=[],n.tooltipLabels=[],n.labelValue=[],n.axisLabelSize=0,n.axisLabelInterval=0,n.dateTimeAxisLabelInterval=[],n.maxLength=0,n.min=0,n.max=0,n.isIntersect=!1,n.jsonCellLabel=[],n.multiLevelSize=[],n.xAxisMultiLabelHeight=[],n.yAxisMultiLabelHeight=[],n.multiLevelPosition=[],n}return gr(i,t),i.prototype.computeSize=function(n,t,i){var u=new o(0,0),r;for(this.titleSize=n.getTitleSize(n,10),this.maxLabelSize=n.getMaxLabelSize(n,t),this.getMultilevelLabelsHeight(n,i,t),r=0;r<this.multiLevelLabels.length;r++)u=n.multiLevelLabelSize(10,r),this.multiLevelSize.push(u)},i.prototype.multiPosition=function(n,t){var f="Horizontal"===n.orientation?10:20,u=new ai(0,0),i,r;return"Horizontal"===n.orientation?(i=n.maxLabelSize.height+f,r=this.xAxisMultiLabelHeight[t-1],u.x=n.isInversed?n.rect.x+n.rect.width:n.rect.x,u.y=0===t?n.rect.y+(n.opposedPosition?-i:i):n.multiLevelPosition[t-1].y+(n.opposedPosition?-r:r)):(i=n.maxLabelSize.width+f,r=0!==t&&this.multiLevelSize[t-1].width,u.x=0===t?n.rect.x-(n.opposedPosition?-i:i):n.multiLevelPosition[t-1].x-(n.opposedPosition?-(r+f):r+f),u.y=n.isInversed?n.rect.y:n.rect.y+n.rect.height),u},i.prototype.multiLevelLabelSize=function(n,t){for(var u,e,i=new o(0,0),s=this.multiLevelLabels,h=s[t].categories,f=0;f<h.length;f++)u=r(h[f].text,s[t].textStyle),i.width=i.width>u.width?i.width:u.width,i.height=i.height>u.height?i.height:u.height;return e="Horizontal"===this.orientation?this.xAxisMultiLabelHeight[t]:this.yAxisMultiLabelHeight[t],this.opposedPosition?this.farSizes.push(e):this.nearSizes.push(e),i},i.prototype.getMultilevelLabelsHeight=function(n,t,i){var f,s,e,c,l,a,v,u=[],h="Vertical"===n.orientation,o="Vertical"===n.orientation?20:10;this.multiLevelLabels.map(function(y,p){y.categories.map(function(w){c="number"==typeof w.start?w.start:Number(new Date(w.start));l="number"==typeof w.end?w.end:Number(new Date(w.end));""!==w.text&&null!==w.start&&null!==w.end&&(f=r(w.text,y.textStyle),e=h?f.width:f.height,a=i.heatMapAxis.calculateLeftPosition(n,c,w.start,t),v=i.heatMapAxis.calculateWidth(n,w.end,l,t),f=r(w.text,y.textStyle),s=null===w.maximumTextWidth?Math.abs(v-a):w.maximumTextWidth,f.width>s-o&&"Wrap"===y.overflow&&!h&&(e*=wt(w.text,s-o,y.textStyle).length),u[p]=u[p]?u[p]<e?e+o:u[p]:e+o)})});h?this.yAxisMultiLabelHeight=u:this.xAxisMultiLabelHeight=u},i.prototype.getTitleSize=function(n,t){var i=new o(0,0);return this.title.text&&((i=r(this.title.text,this.title.textStyle)).height+=t),n.opposedPosition?this.farSizes.push(i.height):this.nearSizes.push(i.height),i},i.prototype.getMaxLabelSize=function(t,i){var f=new o(0,0),c=this.axisLabels,nt=t.border.width>0||t.multiLevelLabels.length>0?10:0,e=1,p="DateTime"===t.valueType&&"None"!==t.showLabelOn?i.initialClipRect.width/t.axisLabelSize:i.initialClipRect.width/t.axisLabels.length,u,it,s,w,h,a,v;if(t.angle=t.labelRotation,t.isIntersect=!1,"Horizontal"===t.orientation&&("Rotate45"===t.labelIntersectAction||t.labelRotation%180==0&&"Trim"===t.labelIntersectAction||t.enableTrim)||"MultipleRows"===t.labelIntersectAction){var tt=i.initialClipRect.x+(t.isInversed?i.initialClipRect.width:0),b=void 0,k=void 0;for(this.clearMultipleRow(),u=0,it=c.length;u<it;u++){var g=r(w=c[u],t.textStyle),rt="DateTime"===t.valueType&&"None"!==t.showLabelOn?t.dateTimeAxisLabelInterval[u]*p:p,l=tt+(t.isInversed?-(p+g.width)/2:(p-g.width)/2),d=(l=l<i.initialClipRect.x?i.initialClipRect.x:l)+g.width;if(t.isInversed){if(n.isNullOrUndefined(k))k=l;else if(k<d&&"MultipleRows"!==t.labelIntersectAction){"Rotate45"!==t.labelIntersectAction||t.enableTrim?t.isIntersect=!0:t.angle=45;break}k=l}else{if(n.isNullOrUndefined(b))b=d;else if(l<b&&"MultipleRows"!==t.labelIntersectAction){"Rotate45"!==t.labelIntersectAction||t.enableTrim?t.isIntersect=!0:t.angle=45;break}b=d}tt+=t.isInversed?-rt:rt;"Horizontal"===t.orientation&&"MultipleRows"===t.labelIntersectAction&&0===t.labelRotation&&this.multipleRow.push(new sr(l,d,e,w,1))}"Horizontal"===t.orientation&&"MultipleRows"===t.labelIntersectAction&&t.isInversed&&(this.multipleRow=this.multipleRow.reverse())}for(u=0;u<c.length;u++)if(s=this.multipleRow,w=void 0,w=t.enableTrim?y(t.maxLabelLength,c[u],t.textStyle):c[u],h=t.angle%180==0?r(w,t.textStyle):li(t.textStyle,c[u],t.angle),f.width=f.width>h.width?f.width:h.width,"MultipleRows"===t.labelIntersectAction&&"Horizontal"===t.orientation&&u>0&&0===t.labelRotation){for(s[u].end>=i.initialClipRect.width&&u<c.length-1&&(s[u].row=s[u].row+1),a=1;a<=t.multilevel.length;a++)if(s[u].start<s[u-1].end){if(t.multilevel[a]<s[u].start){e=a;break}if(a===t.multilevel.length-1){e=t.multilevel.length;break}}else if(h.width<p)for(v=1;v<=t.multilevel.length;v++)if(t.multilevel[v]<s[u].start){e=v;s[v].row=e;break}f.height=f.height>h.height*e+.5*h.height/2*(e-1)?f.height:h.height*e+.5*h.height/2*e;this.multipleRow[u].index=e;t.multilevel[e]=s[u].end}else"Horizontal"===t.orientation&&"MultipleRows"===t.labelIntersectAction&&0===u&&0===t.labelRotation&&(t.multilevel[1]=s[u].end),f.height=f.height>h.height?f.height:h.height;return i.cellSettings.border.width>=20&&"Horizontal"!==t.orientation&&(f.width=f.width+i.cellSettings.border.width/4),t.opposedPosition?this.farSizes.push("Horizontal"===t.orientation?f.height:f.width+nt):this.nearSizes.push("Horizontal"===t.orientation?f.height:f.width+nt),f},i.prototype.calculateNumericAxisLabels=function(t){var h,s,c,u=0,i=0,l=this.interval?this.interval:1,f,e,r,o;for(t.adaptorModule&&t.isCellData&&(h="Horizontal"===this.orientation?t.adaptorModule.adaptiveXMinMax.min:t.adaptorModule.adaptiveYMinMax.min,s="Horizontal"===this.orientation?t.adaptorModule.adaptiveXMinMax.max:t.adaptorModule.adaptiveYMinMax.max),u=n.isNullOrUndefined(this.minimum)?h||0:this.minimum,i=n.isNullOrUndefined(this.maximum)?s||this.maxLength*this.increment:this.maximum,this.minimum&&this.maximum&&u>i&&(c=u,u=i,i=c),i=n.isNullOrUndefined(this.maximum)?s||i+u:i,f=this.labelFormat,e=null!==f.match("{value}"),this.format=t.intl.getNumberFormat({format:e?"":f}),r=u;r<=i;r+=l*this.increment)o=at(e,f,r,this.format),this.axisLabels.push(o);for(this.min=0,this.axisLabelSize=Math.floor((i-u)/this.increment+1),this.max=this.axisLabelSize-1,this.axisLabelInterval=l,r=u;r<=i;r+=this.increment)o=at(e,f,r,this.format),this.tooltipLabels.push(o),this.labelValue.push(r);this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateCategoryAxisLabels=function(){var i=this.labels?this.labels:[],t,o;i=i.length>0?i:this.jsonCellLabel;var e,r=n.isNullOrUndefined(this.minimum)||this.minimum instanceof Date?0:this.minimum,u=n.isNullOrUndefined(this.maximum)||this.maximum instanceof Date?this.maxLength:this.maximum,f=this.interval?this.interval:1;if(!n.isNullOrUndefined(this.minimum)&&!n.isNullOrUndefined(this.maximum)&&r>u&&(e=r,r=u,u=e),i&&i.length>0)for(t=r;t<=u;t+=f)o=i[t]?i[t].toString():t.toString(),this.axisLabels.push(o);else for(t=r;t<=u;t+=f)this.axisLabels.push(t.toString());for(t=r;t<=u;t++)this.tooltipLabels.push(i[t]?i[t].toString():t.toString()),this.labelValue.push(i[t]?i[t].toString():t.toString());this.min=r;this.max=u;this.axisLabelSize=u-r+1;this.axisLabelInterval=f;this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateDateTimeAxisLabel=function(n){var i,r,u=this.interval?this.interval:1,l={skeleton:"full",type:"dateTime"},s=n.intl.getDateParser(l),h=n.intl.getDateFormat(l),a=null,v=null,f,e,o,t,c;if(n.adaptorModule&&n.isCellData&&(a="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.min:n.adaptorModule.adaptiveYMinMax.min,v="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.max:n.adaptorModule.adaptiveYMinMax.max),f=this.minimum?this.minimum:a||null,e=this.maximum?this.maximum:v||null,null===f&&null===e){for(i=0,r=this.maxLength*this.increment,o=i;o<=r;o+=u*this.increment)this.axisLabels.push(o.toString()),this.tooltipLabels.push(o.toString()),this.labelValue.push(o.toString());this.min=0;this.max=this.maxLength;this.axisLabelSize=(r-i)/this.increment+1;this.axisLabelInterval=u}else{for(null!==f&&null===e?r=ct(i=Date.parse(s(h(new Date(vt.DataUtil.parse.parseJson({val:f}).val)))),this.maxLength,this.intervalType,this.increment).getTime():null===f&&null!==e?i=ct(r=Date.parse(s(h(new Date(vt.DataUtil.parse.parseJson({val:e}).val)))),-this.maxLength,this.intervalType,this.increment).getTime():(i=Date.parse(s(h(new Date(vt.DataUtil.parse.parseJson({val:f}).val)))),r=Date.parse(s(h(new Date(vt.DataUtil.parse.parseJson({val:e}).val))))),this.format=n.intl.getDateFormat({format:this.labelFormat,skeleton:this.getSkeleton()}),t=i;t<=r;)c=this.format(new Date(t)),this.axisLabels.push(c),"None"!==this.showLabelOn&&(u=this.calculateLabelInterval(t),this.dateTimeAxisLabelInterval.push(u)),t=ct(t,u,this.intervalType,this.increment).getTime();for(this.min=0,this.axisLabelInterval=u,this.axisLabelSize=this.getTotalLabelLength(i,r),this.max=this.axisLabelSize-1,t=i;t<=r;)c=this.format(new Date(t)),this.tooltipLabels.push(c),this.labelValue.push(new Date(t)),t=ct(t,1,this.intervalType,this.increment).getTime()}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},i.prototype.calculateLabelInterval=function(n){var i,t,r=new Date(n).getFullYear(),f=new Date(n).getMonth()+1,e=new Date(n).getDate(),u;return"Years"===this.showLabelOn||"Months"===this.showLabelOn?"Years"===this.showLabelOn&&"Months"===this.intervalType?t=Math.ceil(12/this.increment):(i="Years"===this.showLabelOn?r%4==0?366:365:new Date(r,f,0).getDate(),i+=1-e,t="Days"===this.intervalType?Math.ceil(i/this.increment):"Hours"===this.intervalType?Math.ceil(24*i/this.increment):"Minutes"===this.intervalType?Math.ceil(1440*i/this.increment):1):"Days"===this.showLabelOn?t="Hours"===this.intervalType?Math.ceil(24/this.increment):"Minutes"===this.intervalType?Math.ceil(1440/this.increment):1:"Hours"===this.showLabelOn?(u=new Date(n).getMinutes(),t="Minutes"===this.intervalType?Math.ceil((60-u)/this.increment):1):t=1,t},i.prototype.getSkeleton=function(){return"Years"===this.intervalType?"yMMM":"Months"===this.intervalType?"MMMd":"Days"===this.intervalType?"yMd":"Hours"===this.intervalType?"EHm":(this.intervalType,"Hms")},i.prototype.getTotalLabelLength=function(n,t){var i,o,r=0,u=new Date(n),f=new Date(t),s,e,h,c;switch(this.intervalType){case"Years":s=(f.getFullYear()-u.getFullYear())/this.increment+1;r=Math.floor(s);break;case"Months":e=12*(f.getFullYear()-u.getFullYear());e-=u.getMonth();r=(e+=f.getMonth())<=0?1:Math.floor(e/this.increment+1);break;case"Days":i=Math.abs(u.getTime()-f.getTime());o=Math.floor(i/864e5);r=Math.floor(o/this.increment+1);break;case"Hours":i=Math.abs(u.getTime()-f.getTime());h=Math.floor(i/36e5);r=Math.floor(h/this.increment)+1;break;case"Minutes":i=Math.abs(u.getTime()-f.getTime());c=Math.floor(i/6e4);r=Math.floor(c/this.increment)+1}return r},i.prototype.clearAxisLabel=function(){this.axisLabels=[];this.tooltipLabels=[];this.dateTimeAxisLabelInterval=[];this.labelValue=[]},i.prototype.clearMultipleRow=function(){this.multipleRow=[];this.multilevel=[]},e([n.Complex({text:"",textStyle:k.axisTitleFont},ti)],i.prototype,"title",void 0),e([n.Property(!1)],i.prototype,"opposedPosition",void 0),e([n.Property(null)],i.prototype,"labels",void 0),e([n.Complex(k.axisLabelFont,it)],i.prototype,"textStyle",void 0),e([n.Property(0)],i.prototype,"labelRotation",void 0),e([n.Property(!1)],i.prototype,"isInversed",void 0),e([n.Property("Category")],i.prototype,"valueType",void 0),e([n.Property(1)],i.prototype,"increment",void 0),e([n.Property("None")],i.prototype,"showLabelOn",void 0),e([n.Property(null)],i.prototype,"minimum",void 0),e([n.Property(null)],i.prototype,"maximum",void 0),e([n.Property(null)],i.prototype,"interval",void 0),e([n.Property("")],i.prototype,"labelFormat",void 0),e([n.Property("Days")],i.prototype,"intervalType",void 0),e([n.Property("Trim")],i.prototype,"labelIntersectAction",void 0),e([n.Property(!1)],i.prototype,"enableTrim",void 0),e([n.Property(35)],i.prototype,"maxLabelLength",void 0),e([n.Complex({color:"#b5b5b5",width:0,type:"Rectangle"},oi)],i.prototype,"border",void 0),e([n.Collection([],fr)],i.prototype,"multiLevelLabels",void 0),i}(n.ChildProperty),nu=function(){function t(n){this.heatMap=n;this.padding=10;this.drawSvgCanvas=new ot(n)}return t.prototype.renderAxes=function(){var r,t,i,n;this.initialClipRect=this.heatMap.initialClipRect;i=this.heatMap;i.enableCanvasRendering||(r=this.heatMap.renderer.createGroup({id:i.element.id+"AxisCollection"}));for(var f=this.heatMap.axisCollections,u=0,e=f.length;u<e;u++)n=f[u],"Horizontal"===n.orientation?(i.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:i.element.id+"XAxisGroup"})),this.drawXAxisLine(t,n),this.drawXAxisTitle(n,t,n.rect),this.drawXAxisLabels(n,t,n.rect)):(t=i.renderer.createGroup({id:i.element.id+"YAxisGroup"}),this.drawYAxisLine(t,n),this.drawYAxisTitle(n,t,n.rect),this.drawYAxisLabels(n,t,n.rect)),n.multiLevelLabels.length>0&&this.drawMultiLevels(t,n),i.enableCanvasRendering||r.appendChild(t);i.enableCanvasRendering||this.heatMap.svgObject.appendChild(r)},t.prototype.drawXAxisLine=function(n,t){var i=this.initialClipRect.y+(t.opposedPosition?0:this.initialClipRect.height),r=new ui(this.heatMap.element.id+"_XAxisLine",new ri(this.initialClipRect.x,i,this.initialClipRect.x+this.initialClipRect.width,i),"transparent",0);this.drawSvgCanvas.drawLine(r,n)},t.prototype.drawYAxisLine=function(n,t){var i=this.initialClipRect.x+(t.opposedPosition?this.initialClipRect.width:0),r=new ui(this.heatMap.element.id+"_YAxisLine",new ri(i,this.initialClipRect.y,i,this.initialClipRect.height+this.initialClipRect.y),"transparent",0);this.drawSvgCanvas.drawLine(r,n)},t.prototype.drawXAxisTitle=function(n,t,i){var e="0px"===n.textStyle.size?0:10,a=i.y+(n.opposedPosition?-(n.maxLabelSize.height+e+v(n.xAxisMultiLabelHeight)):n.maxLabelSize.height+e+v(n.xAxisMultiLabelHeight)),l;if(n.title.text){var o=this.heatMap,u=n.title,c=r(u.text,u.textStyle),f=this.padding,y="Near"===u.textStyle.textAlignment?"start":"Far"===u.textStyle.textAlignment?"end":"middle";f=n.opposedPosition?-(f+c.height/4):f+3*c.height/4;l=new s(o.element.id+"_XAxisTitle",new h(i.x+ci(i.width,0,0,u.textStyle),a+f,y,u.text),u.textStyle,u.textStyle.color||o.themeStyle.axisTitle);this.drawSvgCanvas.createText(l,t,u.text)}},t.prototype.drawYAxisTitle=function(n,t,i){var o,y;if(n.title.text){var r=n.title,c=this.heatMap,l=n.opposedPosition?90:-90,p="Near"===r.textStyle.textAlignment?"start":"Far"===r.textStyle.textAlignment?"end":"middle",u=10;u=n.opposedPosition?u:-u;var w="0px"===n.textStyle.size?0:u,f=i.x+w+(n.opposedPosition?n.maxLabelSize.width+v(n.yAxisMultiLabelHeight):-(n.maxLabelSize.width+v(n.yAxisMultiLabelHeight))),e=i.y+(o=i,"Near"===(y=r.textStyle).textAlignment?o.height-0:"Center"===y.textAlignment?o.height/2:0)+(n.opposedPosition?this.padding:-this.padding),a=new s(c.element.id+"_YAxisTitle",new h(f,e-this.padding,p,r.text,l,"rotate("+l+","+f+","+e+")","auto"),r.textStyle,r.textStyle.color||c.themeStyle.axisTitle);this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(a,r.text,f,e):this.drawSvgCanvas.createText(a,t,r.text)}},t.prototype.calculateVisibleLabels=function(){for(var n,r=this.heatMap.axisCollections,t=this.heatMap.dataSourceSettings,u=!(t&&t.isJsonData&&"Cell"===t.adaptorType),i=0,f=r.length;i<f;i++)"Numeric"===(n=r[i]).valueType&&u?(n.clearAxisLabel(),n.calculateNumericAxisLabels(this.heatMap)):"DateTime"===n.valueType&&u?(n.clearAxisLabel(),n.calculateDateTimeAxisLabel(this.heatMap)):"Category"===n.valueType&&(n.clearAxisLabel(),n.calculateCategoryAxisLabels()),n.tooltipLabels=n.isInversed?n.tooltipLabels.reverse():n.tooltipLabels},t.prototype.measureAxis=function(n){for(var i,t,u=this.heatMap,f=u.axisCollections,r=f.length-1;r>=0;r--)i="0px"===(t=f[r]).textStyle.size?0:this.padding,t.nearSizes=[],t.farSizes=[],t.computeSize(t,u,n),t.opposedPosition?"Horizontal"===t.orientation?(n.y+=v(t.farSizes)+i,n.height-=v(t.farSizes)+i):n.width-=v(t.farSizes)+i:"Horizontal"===t.orientation?n.height-=v(t.nearSizes)+i:(n.x+=v(t.nearSizes)+i,n.width-=v(t.nearSizes)+i)},t.prototype.calculateAxisSize=function(t){for(var i,r,e,f=this.heatMap.axisCollections,u=0,o=f.length;u<o;u++)for(i=f[u],i.rect=n.extend({},t,null,!0),"Horizontal"!==i.orientation||i.opposedPosition||(i.rect.y=t.y+t.height,i.rect.height=0),"Vertical"===i.orientation&&i.opposedPosition&&(i.rect.x=t.x+t.width,i.rect.width=0),i.multiLevelPosition=[],r=0;r<i.multiLevelLabels.length;r++)e=i.multiPosition(i,r),i.multiLevelPosition.push(e)},t.prototype.drawXAxisLabels=function(n,t,i){var w,k=this.heatMap,v=n.axisLabels,vt=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2:0,l=(i.width-vt)/n.axisLabelSize,d=0,ht=n.interval?n.interval:1,it=i.width/(n.axisLabelSize/n.axisLabelInterval),g=n.axisLabelInterval,rt,tt,ut,ft,nt,o,f,ct,e,at,et,ot,st;if(it>0)for(;it<parseInt(n.textStyle.size,10);)g+=1,it=i.width/(n.axisLabelSize/g);else g=n.tooltipLabels.length;for(n.axisLabelInterval<g&&(d=g,v=n.tooltipLabels,ht=g),nt=i.x+(n.isInversed?i.width:0),o=n.angle,rt=this.padding,k.enableCanvasRendering||(ut=this.heatMap.renderer.createGroup({id:k.element.id+"XAxisLabels"}),ft=this.heatMap.renderer.createGroup({id:k.element.id+"XAxisLabelBorder"})),n.isInversed&&"MultipleRows"===n.labelIntersectAction&&n.multipleRow.reverse(),f=0,ct=v.length;f<ct;f++){var a=new u(nt,i.y,l,i.height),p="Trim"===n.labelIntersectAction&&n.isIntersect?"DateTime"!==n.valueType||"None"===n.showLabelOn?y(l*ht,v[f],n.textStyle):y(n.dateTimeAxisLabelInterval[f]*l,v[f],n.textStyle):v[f],c=r(p=n.enableTrim?y(n.maxLabelLength,v[f],n.textStyle):p,n.textStyle),lt=void 0;tt=n.opposedPosition?-rt:rt+(o%360==0?c.height/2:0);e=a.x+(n.isInversed?-(a.width/2+c.width/2):a.width/2-c.width/2);("Trim"===n.labelIntersectAction?e=n.isInversed?e>nt-l?e:nt-l:e>=a.x?e:a.x:o%180==0&&(e=(e=e<i.x?i.x:e)+c.width>i.x+i.width?i.x+i.width-c.width:e),"MultipleRows"===n.labelIntersectAction&&0===n.labelRotation)?(at=n.opposedPosition?-(n.multipleRow[f].index-1):n.multipleRow[f].index-1,w=n.multipleRow[f].index>1?i.y+tt+c.height*at+(n.opposedPosition?-.5*c.height/2*n.multipleRow[f].index:.5*c.height/2*n.multipleRow[f].index):i.y+tt+(n.opposedPosition?-.5*c.height/2:.5*c.height/2)):w=i.y+tt;(this.drawXAxisBorder(n,ft,n.rect,e,c.width,f),o%360!=0)&&(o=o>360?o%360:o,et=li(n.textStyle,p,o),lt="rotate("+o+","+(e=a.x+(n.isInversed?-a.width/2:a.width/2))+","+(w+=n.opposedPosition?-et.height/2:o%360==180||o%360==-180?0:et.height/2)+")");this.heatMap.cellSettings.border.width>5&&n.opposedPosition&&(w-=this.heatMap.cellSettings.border.width/2);this.heatMap.yAxis.opposedPosition&&this.heatMap.cellSettings.border.width>5&&(e+=this.heatMap.cellSettings.border.width/2);this.heatMap.xAxis.isInversed&&this.heatMap.cellSettings.border.width>5&&(e-=this.heatMap.cellSettings.border.width/2);ot=new s(k.element.id+"_XAxis_Label"+f,new h(e,w,o%360==0?"start":"middle",p,o,lt),n.textStyle,n.textStyle.color||k.themeStyle.axisLabel);(0!==o&&this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(ot,p):this.drawSvgCanvas.createText(ot,ut,p),0===d)?(st="DateTime"===n.valueType&&"None"!==n.showLabelOn?n.dateTimeAxisLabelInterval[f]:n.axisLabelInterval,nt+=n.isInversed?-st*l:st*l):nt+=n.isInversed?-d*l:d*l;-1!==p.indexOf("...")&&this.heatMap.tooltipCollection.push(new b(v[f],new u(e,w-c.height,c.width,c.height)));0!==d&&(f+=d-1)}k.enableCanvasRendering||(t.appendChild(ut),t.appendChild(ft))},t.prototype.drawYAxisLabels=function(t,i,f){var l,o=this.heatMap,a=t.axisLabels,v=f.height/t.axisLabelSize,p=0,tt=f.height/(t.axisLabelSize/t.axisLabelInterval),w=t.axisLabelInterval,e,d,et,ot,c,ct;if(tt>0)for(;tt<parseInt(t.textStyle.size,10);)w+=1,tt=f.height/(t.axisLabelSize/w);else w=t.tooltipLabels.length;t.axisLabelInterval<w&&(p=w,a=t.tooltipLabels);var it,rt,k=10,ut=f.y+(t.isInversed?0:f.height),lt=t.opposedPosition?"start":"end";for(k=t.opposedPosition?k:-k,o.enableCanvasRendering||(it=this.heatMap.renderer.createGroup({id:o.element.id+"YAxisLabels"}),rt=this.heatMap.renderer.createGroup({id:o.element.id+"YAxisLabelBorder"})),e=0,d=a.length;e<d;e++){var ft=new u(f.x,ut,f.width,v),st=ft.height/2,ht=this.heatMap.cellSettings.border.width>=20?this.heatMap.cellSettings.border.width/2:0,g=ft.x+k+(t.opposedPosition?ht:-ht),at=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2/d*(t.isInversed?e:d-e):0,nt=ft.y-at+(t.isInversed?st:-st);l=t.enableTrim?y(t.maxLabelLength,a[e],t.textStyle):a[e];et=new s(o.element.id+"_YAxis_Label"+e,new h(g,nt,lt,l,0,"rotate("+t.angle+","+g+","+nt+")","middle"),t.textStyle,t.textStyle.color||o.themeStyle.axisLabel);(n.Browser.isIE&&!o.enableCanvasRendering&&(et.dy="1ex"),this.drawSvgCanvas.createText(et,it,l),0===p)?(ot="DateTime"===t.valueType&&"None"!==t.showLabelOn?t.dateTimeAxisLabelInterval[e]:t.axisLabelInterval,ut+=t.isInversed?ot*v:-ot*v):(ut+=t.isInversed?p*v:-p*v,e+=p-1);c=r(l,t.textStyle);(this.drawYAxisBorder(t,rt,t.rect,nt,c.height,e),-1!==l.indexOf("..."))&&(ct=t.opposedPosition?g:g-c.width,this.heatMap.tooltipCollection.push(new b(a[e],new u(ct,nt-c.height,c.width,c.height))))}o.enableCanvasRendering||(i.appendChild(it),i.appendChild(rt))},t.prototype.drawXAxisBorder=function(n,t,i,r,u,f){var h,e,a=i.width/n.axisLabelSize,c="",l=10,v=n.interval?n.interval:1,s=n.isInversed?i.x+i.width-a*f*v:i.x+a*f*v,o=i.y,y,p;e=o+(n.opposedPosition?-(n.maxLabelSize.height+l):n.maxLabelSize.height+l);h=n.isInversed?s-a:s+a;y=n.isInversed?r+u+l:r-l;p=n.isInversed?r-l:r+u+l;switch(n.border.type){case"Rectangle":c="M "+s+" "+o+" L "+s+" "+e+" L "+h+" "+e+" L "+h+" "+o+" L "+s+" "+o;break;case"WithoutTopBorder":c="M "+s+" "+o+" L "+s+" "+e+" L "+h+" "+e+" L "+h+" "+o+" ";break;case"WithoutBottomBorder":c="M "+s+" "+e+" L "+s+" "+o+" L "+h+" "+o+" L "+h+" "+e+" ";break;case"WithoutTopandBottomBorder":c="M "+s+" "+o+" L "+s+" "+e+" M "+h+" "+o+" L "+h+" "+e+" ";break;case"Brace":c="M "+s+" "+o+" L "+s+" "+(e=o+(e-o)/2+(n.opposedPosition?0:5))+" L "+y+" "+e+" M "+p+" "+e+" L "+h+" "+e+" L "+h+" "+o+" "}n.border.width>0&&"WithoutBorder"!==n.border.type&&this.createAxisBorderElement(n,c,t,f)},t.prototype.drawYAxisBorder=function(n,t,i,r,u,f){var e,h,l=i.height/n.axisLabelSize,c="",a=n.interval?n.interval:1,o=i.x,s=n.isInversed?i.y+l*f*a:i.y+i.height-l*f*a,v,y;e=o+(n.opposedPosition?n.maxLabelSize.width+20:-(n.maxLabelSize.width+20));h=n.isInversed?s+l:s-l;v=n.isInversed?r-u/2:r+u/2;y=n.isInversed?r+u/2:r-u/2;switch(n.border.type){case"Rectangle":c="M "+o+" "+s+" L "+o+" "+h+" L "+e+" "+h+" L "+e+" "+s+" L "+o+" "+s;break;case"WithoutTopBorder":c="M "+o+" "+s+" L "+e+" "+s+" L "+e+" "+h+" L "+o+" "+h+" ";break;case"WithoutBottomBorder":c="M "+e+" "+s+" L "+o+" "+s+" L "+o+" "+h+" L "+e+" "+h+" ";break;case"WithoutTopandBottomBorder":c="M "+o+" "+s+" L "+e+" "+s+" M "+e+" "+h+" L "+o+" "+h+" ";break;case"Brace":c="M "+o+" "+s+" L "+(e=o-(o-e)/2)+" "+s+" L "+e+" "+v+" M "+e+" "+y+" L "+e+" "+h+" L "+o+" "+h}n.border.width>0&&"WithoutBorder"!==n.border.type&&this.createAxisBorderElement(n,c,t,f)},t.prototype.createAxisBorderElement=function(n,t,i,r){var e="Horizontal"===n.orientation?"_XAxis_Label_Border":"_YAxis_Label_Border",u=new d(this.heatMap.element.id+e+r,"transparent",n.border.width,n.border.color,1,"none",t),f;this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(u,void 0):(f=this.heatMap.renderer.drawPath(u),i.appendChild(f))},t.prototype.drawMultiLevels=function(n,t){var i;this.heatMap.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_"+t.orientation+"_MultiLevelLabel"}));"Horizontal"===t.orientation?this.renderXAxisMultiLevelLabels(t,i):this.renderYAxisMultiLevelLabels(t,i);this.heatMap.enableCanvasRendering||n.appendChild(i)},t.prototype.renderXAxisMultiLevelLabels=function(n,t){var k,f,d,g,tt,it,e,rt,v,o,nt,i=this,c=0,l=10,a=0,p=n.isInversed,ft=n.opposedPosition,w="",ut=(p?n.rect.width:0)+n.rect.x;n.multiLevelLabels.map(function(et,ot){v=i.heatMap.renderer.createGroup({id:i.heatMap.element.id+"_XAxisMultiLevelLabel"+ot});et.categories.map(function(st,ht){var at,ct,lt;if("Bootstrap5"!==i.heatMap.theme&&"Bootstrap5Dark"!==i.heatMap.theme||et.setProperties({textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},!0),"Tailwind"!==i.heatMap.theme&&"TailwindDark"!==i.heatMap.theme||et.setProperties({textStyle:{fontFamily:"Inter"}},!0),g=!1,tt="number"==typeof st.start?st.start:Number(new Date(st.start)),it="number"==typeof st.end?st.end:Number(new Date(st.end)),f=ut+i.calculateLeftPosition(n,tt,st.start,n.rect),d=n.multiLevelPosition[ot].y,a=ut+i.calculateWidth(n,st.end,it,n.rect),e=r(st.text,et.textStyle),o=(null===st.maximumTextWidth?Math.abs(a-f):st.maximumTextWidth)-l,k=d+(ft?-(n.xAxisMultiLabelHeight[ot]-e.height):e.height),c=p?f-o:f+l,"Center"===et.alignment?(c=(a-f)/2+f,c-=(e.width>o?o:e.width)/2):"Far"===et.alignment?(c=p?f-l:a-l,c-=e.width>o?o:e.width):c=p?a+l:f+l,"None"===et.overflow&&e.width>Math.abs(a-f)&&(c=p?f-e.width-l:f+l,rt="start"),at=new h(c,k,rt,st.text,0,"translate(0,0)"),ct=new s(i.heatMap.element.id+"_XAxis_MultiLevel"+ot+"_Text"+ht,at,et.textStyle,et.textStyle.color||i.heatMap.themeStyle.axisLabel),"Wrap"===et.overflow?(ct.text=wt(st.text,o,et.textStyle),nt=ct.text.length):"Trim"===et.overflow&&(ct.text=y(o,st.text,et.textStyle),nt=1),"Wrap"===et.overflow&&ct.text.length>1){for(i.drawSvgCanvas.createWrapText(ct,et.textStyle,v),lt=0;lt<ct.text.length;lt++)if(-1!==ct.text[lt].indexOf("...")){g=!0;break}}else i.drawSvgCanvas.createText(ct,v,ct.text);i.heatMap.enableCanvasRendering||t.appendChild(v);(-1!==ct.text.indexOf("...")||-1!==ct.text[0].indexOf("...")||g)&&i.heatMap.tooltipCollection.push(new b(st.text,new u(c,k-e.height,o,e.height*nt)));et.border.width>0&&"WithoutBorder"!==et.border.type&&(w=i.renderXAxisLabelBorder(ot,n,f,d,a,w,ot,e,o,c))});""!==w&&(i.createBorderElement(ot,n,w,t),w="")});this.heatMap.enableCanvasRendering||t.appendChild(v)},t.prototype.renderXAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h){var c=r+(t.opposedPosition?-t.xAxisMultiLabelHeight[n]:t.xAxisMultiLabelHeight[n]);switch(t.multiLevelLabels[e].border.type){case"Rectangle":f+="M "+i+" "+r+" L "+i+" "+c+" L "+u+" "+c+" L "+u+" "+r+" L "+i+" "+r+" ";break;case"WithoutTopBorder":f+="M "+i+" "+r+" L "+i+" "+c+" L "+u+" "+c+" L "+u+" "+r+" ";break;case"WithoutBottomBorder":f+="M "+i+" "+c+" L "+i+" "+r+" L "+u+" "+r+" L "+u+" "+c+" ";break;case"WithoutTopandBottomBorder":f+="M "+i+" "+r+" L "+i+" "+c+" M "+u+" "+r+" L "+u+" "+c+" ";break;case"Brace":f+="M "+i+" "+r+" L "+i+" "+(r+(c-r)/2)+" L "+(t.isInversed?(o.width>s?s:o.width)+h+3:h-3)+" "+(r+(c-r)/2)+" M "+(t.isInversed?h-3:(o.width>s?s:o.width)+h+3)+" "+(r+(c-r)/2)+" L "+u+" "+(r+(c-r)/2)+" L "+u+" "+r+" "}return f},t.prototype.renderYAxisMultiLevelLabels=function(n,t){var e,o,c,l,g,nt,f,p,a,w,i=this,k=0,d=n.isInversed,v="",tt=(d?0:n.rect.height)+n.rect.y;n.multiLevelLabels.map(function(it,rt){c=n.multiLevelPosition[rt].y;p=i.heatMap.renderer.createGroup({id:i.heatMap.element.id+"_YAxisMultiLevelLabel"+rt});it.categories.map(function(ut,ft){var ot,st,et;"Tailwind"!==i.heatMap.theme&&"TailwindDark"!==i.heatMap.theme||it.setProperties({textStyle:{fontFamily:"Inter"}},!0);"Bootstrap5"!==i.heatMap.theme&&"Bootstrap5Dark"!==i.heatMap.theme||it.setProperties({textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},!0);g="number"==typeof ut.start?ut.start:Number(new Date(ut.start));nt="number"==typeof ut.end?ut.end:Number(new Date(ut.end));c=tt+i.calculateLeftPosition(n,g,ut.start,n.rect);o=n.multiLevelPosition[rt].x;l=tt+i.calculateWidth(n,ut.start,nt,n.rect);f=r(ut.text,it.textStyle);a=(null===ut.maximumTextWidth?Math.abs(o):ut.maximumTextWidth)-10;ot=Math.abs(o-(o-n.multiLevelSize[rt].width-20))/2-f.width/2;k=(n.opposedPosition?o:o-n.multiLevelSize[rt].width-20)+ot;e=c+10;"None"!==it.overflow&&(w="Wrap"===it.overflow?wt(ut.text,a,it.textStyle):y(a,ut.text,it.textStyle));"Center"===it.alignment?e+=(l-c)/2-w.length*f.height/2:e="Far"===it.alignment?d?l-f.height/2:e-f.height:d?e+f.height/2:l+f.height;it.border.width>0&&"WithoutBorder"!==it.border.type&&(v=i.renderYAxisLabelBorder(rt,n,o,c,l,v,rt,f,a,e));st=new h(k,e,"start",ut.text,0,"translate(0,0)");et=new s(i.heatMap.element.id+"_YAxis_MultiLevel"+rt+"_Text"+ft,st,it.textStyle,it.textStyle.color||i.heatMap.themeStyle.axisLabel);et.text=w;i.drawSvgCanvas.createText(et,p,et.text);-1!==et.text.indexOf("...")&&i.heatMap.tooltipCollection.push(new b(ut.text,new u(k,e-f.height,a,f.height)));i.heatMap.enableCanvasRendering||t.appendChild(p)});""!==v&&(i.createBorderElement(rt,n,v,t),v="")});this.heatMap.enableCanvasRendering||t.appendChild(p)},t.prototype.renderYAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h){var l=20,c=i-(t.opposedPosition?-(t.multiLevelSize[n].width+l):t.multiLevelSize[n].width+l);switch(t.multiLevelLabels[e].border.type){case"Rectangle":f+="M "+i+" "+r+" L "+c+" "+r+" L "+c+" "+u+" L "+i+" "+u+" L "+i+" "+r+" ";break;case"WithoutTopBorder":f+="M "+i+" "+r+" L "+c+" "+r+" L "+c+" "+u+" L "+i+" "+u+" ";break;case"WithoutBottomBorder":f+="M "+c+" "+r+" L "+i+" "+r+" L "+i+" "+u+" L "+c+" "+u+" ";break;case"WithoutTopandBottomBorder":f+="M "+i+" "+r+" L "+c+" "+r+" M "+i+" "+u+" L "+c+" "+u+" ";break;case"Brace":l=10;f+="M "+i+" "+r+" L "+(i+(c-i)/2)+" "+r+" L "+(i+(c-i)/2)+" "+(t.isInversed?h-l-5:h+o.height-l)+" M "+(i+(c-i)/2)+" "+(t.isInversed?h+o.height-l:h-l-5)+" L "+(i+(c-i)/2)+" "+u+" L "+i+" "+u+" "}return f},t.prototype.createBorderElement=function(n,t,i,r){var f="Horizontal"===t.orientation?"XAxis":"YAxis",u=new d(this.heatMap.element.id+"_"+f+"_MultiLevel_Rect_"+n,"Transparent",t.multiLevelLabels[n].border.width,t.multiLevelLabels[n].border.color,1,"",i),e=this.heatMap.renderer.drawPath(u);this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(u,void 0):r.appendChild(e)},t.prototype.calculateLeftPosition=function(n,t,i,r){var u,f;return"number"==typeof i?("Numeric"===n.valueType&&(n.minimum||n.maximum)&&(t-=n.minimum?n.minimum:0),f=("Horizontal"===n.orientation?r.width:r.height)/(n.axisLabelSize*n.increment),u=(n.isInversed?-1:1)*t*f,u="Horizontal"===n.orientation?u:-u):(f=this.calculateNumberOfDays(t,n,!0,r),u=n.isInversed?-f:f,u="Horizontal"===n.orientation?u:-u),u},t.prototype.calculateWidth=function(n,t,i,r){var f,u;return"number"==typeof t?("Numeric"===n.valueType&&(n.minimum||n.maximum)&&(i-=n.minimum?n.minimum:0),f=("Horizontal"===n.orientation?r.width:r.height)/(n.axisLabelSize*n.increment),u=(n.isInversed?-1:1)*(i+1)*f,u="Horizontal"===n.orientation?u:-u):(u=f=this.calculateNumberOfDays(i,n,!1,r),u=n.isInversed?-u:u,u="Horizontal"===n.orientation?u:-u),u},t.prototype.calculateNumberOfDays=function(n,t,i,r){for(var s,e,u,a,v=864e5,h=t.labelValue,c=("Horizontal"===t.orientation?r.width:r.height)/t.axisLabelSize,o=new Date(Number(n)),l=0,f=0;f<t.axisLabelSize;f++)if((e=new Date(Number(h[f])),u=t.isInversed?new Date(Number(h[f-1])):new Date(Number(h[f+1])),f===(t.isInversed?0:t.axisLabelSize-1))&&((u=new Date(Number(h[f])),"Hours"===t.intervalType)?u=new Date(Number(u.setHours(u.getHours()+1))):"Minutes"===t.intervalType?u=new Date(Number(u.setMinutes(u.getMinutes()+1))):"Days"===t.intervalType?u=new Date(Number(u.setDate(u.getDate()+1))):(s="Months"===t.intervalType?new Date(u.getFullYear(),u.getMonth()+1,0).getDate():u.getFullYear()%4==0?366:365,u=new Date(Number(u.setDate(u.getDate()+s))))),Number(e)<=n&&Number(u)>=n){if("Minutes"===t.intervalType||"Hours"===t.intervalType){l=c/Math.round(Math.abs((e.getTime()-u.getTime())/6e4))*Math.abs((e.getTime()-o.getTime())/6e4);a=(f=t.isInversed?t.axisLabelSize-1-f:f)*c+l;break}s=Math.round(Math.abs((e.getTime()-u.getTime())/v));i?o.getDate():o.setDate(o.getDate()+1);0!==s&&(l=c/s*Math.abs((e.getTime()-o.getTime())/v));a=(f=t.isInversed?t.axisLabelSize-1-f:f)*c+l;break}return a},t}(),tu=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),g=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},iu=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return tu(i,t),g([n.Property(!0)],i.prototype,"showLabel",void 0),g([n.Property("")],i.prototype,"format",void 0),g([n.Property(!0)],i.prototype,"enableCellHighlighting",void 0),g([n.Complex({},rr)],i.prototype,"bubbleSize",void 0),g([n.Complex({},di)],i.prototype,"border",void 0),g([n.Complex(k.rectLabelFont,it)],i.prototype,"textStyle",void 0),g([n.Property("Rect")],i.prototype,"tileType",void 0),g([n.Property("Color")],i.prototype,"bubbleType",void 0),g([n.Property(!1)],i.prototype,"isInversedBubbleSize",void 0),i}(n.ChildProperty),ru=function(){function t(n){this.heatMap=n;this.drawSvgCanvas=new ot(this.heatMap);this.cellColor=new si(this.heatMap)}return t.prototype.renderRectSeries=function(){var t,k,p,u,r,d,tt,w;this.createSeriesGroup();t=this.heatMap;k=!1;t.xLength=t.axisCollections[0].axisLabelSize;t.yLength=t.axisCollections[1].axisLabelSize;var c,f,l=Math.round(100*t.initialClipRect.x)/100,b=Math.round(100*t.initialClipRect.y)/100,a=0,e=0,i=t.cellSettings,v=Math.round((t.initialClipRect.width-i.border.width/2)/t.xLength*100)/100,y=Math.round((t.initialClipRect.height-i.border.width/2)/t.yLength*100)/100,g=0,nt=(t.themeStyle,[]),o=i.border;for(this.rectPositionCollection=[],this.color="",this.bubbleColorValue=[],t.yAxis.opposedPosition&&(l=Math.round(100*(t.initialClipRect.x+parseFloat(o.width.toString())/2))/100),p=this.getBubbleRadius(v,y),u=0;u<t.xLength*t.yLength;u++)"Column"===t.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type?(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[e],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[e]):"Row"===t.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[a],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[a]),this.setTextAndColor(a,e),r=new lr(0,0,0,0,0,"",0,0,0,0,!0,"","",!0),(c=o.color,this.heatMap.bubbleSizeWithColor?this.updateRectDetails(r,l,b,v,y,n.extend("",this.bubbleColorValue,null,!0),u,e,a):this.updateRectDetails(r,l,b,v,y,this.text,u,e,a),f=i.showLabel?this.getFormatedText(this.text,i.format):"",r.displayText=f,n.isNullOrUndefined(this.heatMap.cellRender)||(f=this.cellRendering(r,f)),("Canvas"===t.renderingMode&&0===parseFloat(o.width.toString())||!c&&"Bubble"===i.tileType&&"Sector"===i.bubbleType)&&(c=this.color),"Rect"===i.tileType)?(this.renderTileCell(r,o,u,this.color,c),this.updateLabelVisibleStatus(v,y,f)):"Color"===i.bubbleType?(this.renderBubbleCell(r,o,u,this.color,c,p),this.updateLabelVisibleStatus(2*p-12,2*p-6,f)):n.isNullOrUndefined(this.text)||"Size"!==i.bubbleType&&"SizeAndColor"!==i.bubbleType||""===this.text.toString()?"Sector"!==i.bubbleType||n.isNullOrUndefined(this.text)||""===this.text.toString()||(this.renderSectorCell(r,o,u.toString(),this.color,c,p,this.text),this.checkLabelXDisplay=!1,this.checkLabelYDisplay=!1):("Table"!==this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.minColorValue=isFinite(this.heatMap.minColorValue)?this.heatMap.minColorValue:this.heatMap.dataSourceMinValue,this.heatMap.maxColorValue=isFinite(this.heatMap.maxColorValue)?this.heatMap.maxColorValue:this.heatMap.dataSourceMaxValue),d=this.getRadiusBypercentage(parseFloat(this.text.toString()),t.dataSourceMinValue,t.dataSourceMaxValue,p),this.renderBubbleCell(r,o,u,this.color,c,d),this.updateLabelVisibleStatus(2*d-12,2*d-6,f)),(nt.push(r),t.rangeSelection&&"Fixed"===t.paletteSettings.type&&(k=this.isCellValueInRange(a,e),r.visible=k),i.showLabel&&this.checkLabelYDisplay&&this.checkLabelXDisplay)&&(tt=i.textStyle,w=new s(t.element.id+"_HeatMapRectLabels_"+u,new h(Math.round(100*(l+v/2))/100,Math.round(100*(b+y/2))/100,"middle",f,null,null,"middle"),tt,tt.color||this.getSaturatedColor(this.color)),r.textId=w.id,t.rangeSelection&&"Fixed"===t.paletteSettings.type&&(w.fill=k?w.fill:this.heatMap.themeStyle.toggledColor),n.Browser.isIE&&!t.enableCanvasRendering&&(w.dy="Bubble"===this.heatMap.cellSettings.tileType?"0.5ex":"1ex"),this.drawSvgCanvas.createText(w,this.containerTextObject,f)),g===t.xLength-1?(b=Math.round(100*(b+y))/100,g=0,e=0,l=t.yAxis.opposedPosition?Math.round(100*(t.initialClipRect.x+parseFloat(o.width.toString())/2))/100:Math.round(100*t.initialClipRect.x)/100,this.rectPositionCollection.push(nt),nt=[],a++):(l=Math.round(100*(l+v))/100,g++,e++);t.enableCanvasRendering||(t.svgObject.appendChild(this.containerRectObject),!i.showLabel||"Bubble"===i.tileType&&"Sector"===i.bubbleType||t.svgObject.appendChild(this.containerTextObject))},t.prototype.isCellValueInRange=function(t,i){for(var e,s,u=!1,r=0;r<this.heatMap.toggleValue.length;r++){s=0!==r||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[r].startValue:this.heatMap.toggleValue[r].value:this.heatMap.dataSourceMinValue;e="Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?r===this.heatMap.toggleValue.length-1?this.heatMap.maxColorValue:this.heatMap.toggleValue[r+1].value-.01:r!==this.heatMap.toggleValue.length-1||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[r].endValue:this.heatMap.toggleValue[r+1].value-.01:this.heatMap.dataSourceMaxValue;var o=this.heatMap.clonedDataSource,h=n.isNullOrUndefined(o[t][i][1])||""===o[t][i][1].toString()?"":o[t][i][1],f=parseFloat("Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?h.toString():this.text.toString());if(isNaN(f))u=!0;else{if(!isNaN(f)&&f>=s&&f<=e){if(this.heatMap.toggleValue[r].visible){u=!0;break}u=!1;break}if(this.heatMap.isColorRange&&e>=this.heatMap.toggleValue[r].endValue&&r===this.heatMap.toggleValue.length-1){u=!0;break}}}return u},t.prototype.cellRendering=function(n,t){var r=this.heatMap.axisCollections[0],u=this.heatMap.axisCollections[1],f=r.tooltipLabels,e=u.tooltipLabels.slice().reverse(),o=u.labelValue.slice().reverse(),i={heatmap:this.heatMap,cancel:!1,name:"cellRender",value:n.value,xLabel:f[n.xIndex].toString(),yLabel:e[n.yIndex].toString(),displayText:t,xValue:r.labelValue[n.xIndex],yValue:o[n.yIndex],cellColor:this.color};return this.heatMap.trigger("cellRender",i),this.color=i.cellColor,i.displayText},t.prototype.setTextAndColor=function(t,i){var u,r,f;this.bubbleColorValue=[];u=this.heatMap.dataSourceSettings;r=this.heatMap.clonedDataSource;this.heatMap.bubbleSizeWithColor?(this.text=n.isNullOrUndefined(r[t][i][0])||""===r[t][i][0].toString()?"":r[t][i][0],this.color=n.isNullOrUndefined(r[t][i][1])||""===r[t][i][1].toString()?this.heatMap.isColorValueExist?this.heatMap.emptyPointColor:this.cellColor.getColorByValue(this.text):this.cellColor.getColorByValue(r[t][i][1]),f=new or(u.isJsonData&&"Cell"===u.adaptorType?u.bubbleDataMapping.size:null,this.text,"Size"),this.bubbleColorValue.push(f),this.bubbleColorValue.push({mappingName:u.isJsonData&&"Cell"===u.adaptorType?u.bubbleDataMapping.color:null,bubbleData:n.isNullOrUndefined(r[t][i][1])||""===r[t][i][1].toString()?"":r[t][i][1],valueType:"Color"})):(this.text=r[t][i],this.color=this.cellColor.getColorByValue(this.text))},t.prototype.createSeriesGroup=function(){this.heatMap.enableCanvasRendering||(this.containerRectObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_RectGroup"}),!this.heatMap.cellSettings.showLabel||"Bubble"===this.heatMap.cellSettings.tileType&&"Sector"===this.heatMap.cellSettings.bubbleType||(this.containerTextObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_TextGroup",transform:"translate( 0, 0)"})))},t.prototype.updateRectDetails=function(n,t,i,r,u,f,e,o,s){n.x=t;n.y=i;n.width=r;n.height=u;n.value=f;n.id=this.heatMap.element.id+"_HeatMapRect_"+e;n.xIndex=o;n.yIndex=s},t.prototype.renderTileCell=function(n,t,i,r,f){var e=new w(this.heatMap.element.id+"_HeatMapRect_"+i,r,t,1,new u(n.x,n.y,n.width,n.height),f||this.heatMap.themeStyle.cellBorder,t.radius,t.radius);this.drawSvgCanvas.drawRectangle(e,this.containerRectObject,!0)},t.prototype.getBubbleRadius=function(n,t){var i=n/2-2;return t/2<n/2&&(i=t/2-2),i<0?0:i},t.prototype.renderSectorCell=function(n,t,i,r,u,f,e){for(var v,nt,y,p,s,h,c,l,a,tt,it,w,b=Math.round(100*(n.x+n.width/2))/100,k=Math.round(100*(n.y+n.height/2))/100,d=r,o=this.getRadiusBypercentage(e,this.heatMap.dataSourceMinValue,this.heatMap.dataSourceMaxValue,360),g=0;g<2;g++)if(w=parseFloat(t.width.toString()),0===g?(y=o>=180?1:0,p=-90,s=0===o?270:o-90,h=Math.round(100*(b+f*Math.cos((o-90)*(Math.PI/180))))/100,c=Math.round(100*(k+f*Math.sin((o-90)*(Math.PI/180))))/100,l=Math.round(100*b)/100,a=Math.round(100*(k-f))/100,0===o&&(d=this.heatMap.emptyPointColor)):(y=o>=180?0:1,p=s,s=270,d=this.heatMap.emptyPointColor,i+="_Unfilled",tt=h,it=c,h=l,c=a,l=tt,a=it,0===o&&(w=1,u=r)),v=new pr("",!1,b,k,l,a,h,c,p,s,f,!0),nt=new yr(this.heatMap.element.id+"_HeatMapRect_"+i,v,d,t,w,1,u),this.calculateShapes(nt,v,o,y),this.drawSvgCanvas.drawPath(nt,v,this.containerRectObject),360===o)break},t.prototype.calculateShapes=function(t,i,r,u){var f;switch(r){case 360:case 0:f=0===r&&i.start===i.end?"M "+t.x+" "+t.y+" L "+i.x+" "+(i.y-i.radius):(f=this.heatMap.enableCanvasRendering?"":"M "+t.x+" "+t.y+" ")+"m "+-i.radius+" 0 a "+i.radius+" "+i.radius+" 0 1 0 "+2*i.radius+" 0 a "+i.radius+" "+i.radius+" 0 1 0 "+-2*i.radius+" 0 ";n.merge(t,{d:f});break;default:f="M "+t.x+" "+t.y+" L "+i.x1+" "+i.y1+" A "+i.radius+" "+i.radius+" 0 "+u+" 1 "+i.cx+" "+i.cy+" Z";n.merge(t,{d:f})}},t.prototype.renderBubbleCell=function(n,t,i,r,u,f){var e=new vr(this.heatMap.element.id+"_HeatMapRect_"+i,r,t,1,u||this.heatMap.themeStyle.cellBorder,Math.round(100*(n.x+n.width/2))/100,Math.round(100*(n.y+n.height/2))/100,f);this.drawSvgCanvas.drawCircle(e,this.containerRectObject)},t.prototype.updateLabelVisibleStatus=function(n,t,i){this.heatMap.cellSettings.showLabel&&(this.checkLabelYDisplay=t>parseInt(this.heatMap.cellSettings.textStyle.size,10),this.checkLabelXDisplay=n>i.length*(parseInt(this.heatMap.cellSettings.textStyle.size,10)/2))},t.prototype.getRadiusBypercentage=function(n,t,i,r){var f=parseInt(this.heatMap.cellSettings.bubbleSize.minimum,10),e=parseInt(this.heatMap.cellSettings.bubbleSize.maximum,10),u;return(f<0||f>100||isNaN(f))&&(f=0),(e<0||e>100||isNaN(e))&&(e=100),u=(n-t)/(i-t)*100,u=isNaN(u)?100:u,(this.heatMap.bubbleSizeWithColor||"Bubble"===this.heatMap.cellSettings.tileType&&"Size"===this.heatMap.cellSettings.bubbleType)&&(this.heatMap.cellSettings.isInversedBubbleSize&&(u=100-u),u=u*(e-f)/100+f),r*=u/100,Math.round(100*r)/100<0?0:Math.round(100*r)/100},t.prototype.getSaturatedColor=function(n){var u,t,i=n,r=(u=function(n){var i,r,t;return n="transparent"===n?"white":n,i=document.getElementById("heatmapmeasuretext"),i.style.color=n,n=window.getComputedStyle(i).color,t=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(n),"#"+ei((r=new pt(parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10))).R)+ei(r.G)+ei(r.B)}(i="transparent"===i?window.getComputedStyle(document.body,null).backgroundColor:i),(t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u))?new pt(parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)):new pt(255,255,255));return Math.round((299*r.R+587*r.G+114*r.B)/1e3)>=128?"black":"white"},t.prototype.highlightSvgRect=function(n){var r,i,t;-1===n.indexOf("Celltooltip")&&(-1!==n.indexOf("_HeatMapRect")?(-1!==n.indexOf("_HeatMapRectLabels_")&&(r=n.indexOf("_HeatMapRectLabels_")+19,n=this.heatMap.element.id+"_HeatMapRect_"+n.slice(r)),i=document.getElementById(n),this.heatMap.tempRectHoverClass!==n&&(this.heatMap.cellSettings.enableCellHighlighting&&(t=void 0,this.heatMap.tempRectHoverClass&&(t=document.getElementById(this.heatMap.tempRectHoverClass)),t&&!this.heatMap.rectSelected&&t.setAttribute("opacity","1"),i&&!this.heatMap.rectSelected&&i.setAttribute("opacity","0.65")),this.heatMap.tempRectHoverClass=n)):this.heatMap.cellSettings.enableCellHighlighting&&(t=void 0,this.heatMap.tempRectHoverClass&&(t=document.getElementById(this.heatMap.tempRectHoverClass)),t&&!this.heatMap.rectSelected&&(t.setAttribute("opacity","1"),this.heatMap.tempRectHoverClass="")))},t.prototype.getFormatedText=function(n,t){var i=t,u=null!==i.match("{value}"),r;return this.format=this.heatMap.intl.getNumberFormat({format:u?"":i}),r="",""!==n.toString()&&(r=at(u,i,n,this.format)),r},t.prototype.getCurrentRect=function(n,t){var f,i=[],r,u;return i.push(this.heatMap.heatMapSeries.rectPositionCollection[0][0]),r=Math.ceil((n-i[0].x)/i[0].width)<this.heatMap.axisCollections[0].axisLabelSize?Math.ceil((n-i[0].x)/i[0].width):this.heatMap.axisCollections[0].axisLabelSize,u=Math.floor((t-i[0].y)/i[0].height)<this.heatMap.axisCollections[1].axisLabelSize?Math.floor((t-i[0].y)/i[0].height):this.heatMap.axisCollections[1].axisLabelSize-1,r=0===r?1:r,f=this.heatMap.heatMapSeries.rectPositionCollection[u][r-1],this.hoverXAxisLabel=this.heatMap.axisCollections[0].tooltipLabels[r-1],this.hoverXAxisValue=this.heatMap.axisCollections[0].labelValue[r-1],this.hoverYAxisLabel=this.heatMap.axisCollections[1].tooltipLabels[this.heatMap.axisCollections[1].tooltipLabels.length-1-u],this.hoverYAxisValue=this.heatMap.axisCollections[1].labelValue[this.heatMap.axisCollections[1].labelValue.length-1-u],f},t}(),uu=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},fu=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return uu(i,t),kt([n.Property("")],i.prototype,"template",void 0),kt([n.Property("")],i.prototype,"fill",void 0),kt([n.Complex({},gi)],i.prototype,"border",void 0),kt([n.Complex(k.tooltipFont,it)],i.prototype,"textStyle",void 0),i}(n.ChildProperty),eu=function(){function t(n){this.isFirst=!0;this.isFadeout=!1;this.heatMap=n}return t.prototype.getModuleName=function(){return"Tooltip"},t.prototype.showHideTooltip=function(n,t){var i=document.getElementById(this.heatMap.element.id+"Celltooltipcontainer");n?i.style.visibility="visible":(i&&"hidden"!==i.style.visibility&&(this.tooltipObject&&t&&this.heatMap.isRectBoundary?this.tooltipObject.fadeOut():this.tooltipObject&&this.tooltipObject.element&&this.tooltipObject.element.firstChild.setAttribute("opacity","0"),i.style.visibility="hidden"),this.isFadeout=!0)},t.prototype.destroy=function(){},t.prototype.createTooltip=function(t,i,r,u){var f=null,e=n.select("#"+this.heatMap.element.id+"Celltooltipcontainer");this.heatMap.cellSettings.showLabel&&this.heatMap.heatMapSeries.checkLabelXDisplay&&this.heatMap.heatMapSeries.checkLabelYDisplay&&(f=parseInt(this.heatMap.cellSettings.textStyle.size,10)/2);"Tailwind"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}}},!0);"TailwindDark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#F9FAFB",textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500",color:"#1F2937"}}},!0);"Bootstrap5"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"14px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500"}}},!0);"Bootstrap5Dark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#E9ECEF",textStyle:{size:"14px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500",color:"#212529"}}},!0);this.tooltipObject=new tt.Tooltip({opacity:"Tailwind"===this.heatMap.theme||"TailwindDark"===this.heatMap.theme||"Bootstrap5"===this.heatMap.theme||"Bootstrap5Dark"===this.heatMap.theme?1:.75,enableAnimation:!1,offset:f,location:{x:i,y:r},availableSize:this.heatMap.availableSize,data:{xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,value:t.value,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null},theme:this.heatMap.theme,content:u,fill:this.heatMap.tooltipSettings.fill,template:""===this.heatMap.tooltipSettings.template?null:this.heatMap.tooltipSettings.template,border:{width:this.heatMap.tooltipSettings.border.width,color:this.heatMap.tooltipSettings.border.color},textStyle:{size:this.heatMap.tooltipSettings.textStyle.size,fontWeight:this.heatMap.tooltipSettings.textStyle.fontWeight.toLowerCase(),color:this.heatMap.tooltipSettings.textStyle.color,fontStyle:this.heatMap.tooltipSettings.textStyle.fontStyle.toLowerCase(),fontFamily:this.heatMap.tooltipSettings.textStyle.fontFamily},areaBounds:{height:this.heatMap.initialClipRect.height+this.heatMap.initialClipRect.y,width:this.heatMap.initialClipRect.width,x:this.heatMap.initialClipRect.x}},e)},t.prototype.createTooltipDiv=function(t){var i=t.enableCanvasRendering&&t.allowSelection?t.availableSize.height:0,r=n.createElement("div",{id:this.heatMap.element.id+"Celltooltipcontainer",styles:"position:absolute; z-index: 3;top:-"+i+"px"});this.heatMap.element.appendChild(n.createElement("div",{id:this.heatMap.element.id+"Celltooltipparent",styles:"position:relative"}).appendChild(r))},t.prototype.getTooltipContent=function(n,t){var u,f,i=this.heatMap,r=this.heatMap.dataSourceSettings;if(i.bubbleSizeWithColor){var e=i.xAxis.title&&""!==i.xAxis.title.text?i.xAxis.title.text:"X-Axis",o=i.yAxis.title&&""!==i.yAxis.title.text?i.yAxis.title.text:"Y-Axis",s=r.isJsonData&&"Cell"===r.adaptorType?r.bubbleDataMapping.size:"Value 1",h=r.isJsonData&&"Cell"===r.adaptorType?r.bubbleDataMapping.color:"Value 2";u=t.getFormatedText(n.value[0].bubbleData,this.heatMap.cellSettings.format);f=[e+" : "+t.hoverXAxisLabel+"<br/>"+o+" : "+t.hoverYAxisLabel+"<br/>"+s+" : "+u+"<br/>"+h+" : "+t.getFormatedText(n.value[1].bubbleData,this.heatMap.cellSettings.format)]}else u=n.value,f=[t.hoverXAxisLabel+" | "+t.hoverYAxisLabel+" : "+t.getFormatedText(u,this.heatMap.cellSettings.format)];return f},t.prototype.renderTooltip=function(t){var r=this,u=this.heatMap.heatMapSeries,i=[""],f,e;(this.heatMap.bubbleSizeWithColor?n.isNullOrUndefined(t.value)||n.isNullOrUndefined(t.value[0].bubbleData)||""===t.value[0].bubbleData.toString():n.isNullOrUndefined(t.value)||!n.isNullOrUndefined(t.value)&&""===t.value.toString())?(this.showHideTooltip(!1,!1),t.visible||this.showHideTooltip(!1,!1)):n.isNullOrUndefined(this.heatMap.tooltipRender)?(i=this.getTooltipContent(t,u),this.tooltipCallback(t,i)):(f=this.getTooltipContent(t,u),e={heatmap:this.heatMap,cancel:!1,name:"tooltipRender",value:t.value,xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,content:f},this.heatMap.trigger("tooltipRender",e,function(n){n.cancel?r.tooltipObject&&r.showHideTooltip(!1):(i=n.content,r.tooltipCallback(t,i))}))},t.prototype.tooltipCallback=function(n,t){this.tooltipObject?(this.tooltipObject.content=t,this.tooltipObject.data={xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,value:n.value}):this.createTooltip(n,n.x+n.width/2,n.y+n.height/2,t);this.showHideTooltip(!0);this.tooltipObject.enableAnimation=!this.isFirst&&!this.isFadeout;this.isFirst=!this.isFirst&&this.isFirst;this.isFadeout=!this.isFadeout&&this.isFadeout;this.tooltipObject.location.x=n.x+n.width/2;this.tooltipObject.location.y=n.y+n.height/2;n.visible||this.showHideTooltip(!1,!1)},t}(),ou=function(){function t(n){this.heatMap=n}return t.prototype.processDataSource=function(t){var w=n.extend([],t,null,!0),u,o,e,s;this.heatMap.clonedDataSource=[];this.completeDataSource=[];var h,c,r,i=this.heatMap.axisCollections,l=i[0].maxLength+1,a=i[0].axisLabelSize+(i[0].min>0?i[0].min:0),v=l>a?l:a,y=(l=i[1].maxLength+1)>(a=i[1].axisLabelSize+(i[1].min>0?i[1].min:0))?l:a,f=0,p=[];for(this.tempSizeArray=[],this.tempColorArray=[],this.heatMap.minColorValue=null,this.heatMap.maxColorValue=null,this.heatMap.dataMax=[],this.heatMap.dataMin=[],"Column"===this.heatMap.paletteSettings.colorGradientMode&&v<y&&(v=y),u="Category"===i[1].valueType?i[1].min:0;u<("Column"===this.heatMap.paletteSettings.colorGradientMode?v:y);u++){for(o="Category"===i[0].valueType?i[0].min:0,this.completeDataSource.push([]);o<v;)o>=i[0].min&&o<=i[0].max&&this.processDataArray(w,o,u,f),o++;if("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type)for(r=n.extend([],w[f],null,!0),e=0;e<r.length;e++)"object"==typeof r[e]&&null!==r[e]&&(r[e]=r[e][0]);else r=n.extend([],this.completeDataSource[f],null,!0);s=this.getMinMaxValue(h,c,r);"Column"!==this.heatMap.paletteSettings.colorGradientMode&&"Row"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax[u]=s[1],this.heatMap.dataMin[u]=s[0]);h=s[0];c=s[1];this.heatMap.xAxis.isInversed&&(this.completeDataSource[f]=this.completeDataSource[f].reverse());u>=this.heatMap.axisCollections[1].min&&u<=this.heatMap.axisCollections[1].max&&p.push(this.completeDataSource[f]);f++}"Row"!==this.heatMap.paletteSettings.colorGradientMode||this.heatMap.yAxis.isInversed||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse());"Column"===this.heatMap.paletteSettings.colorGradientMode&&this.heatMap.xAxis.isInversed&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse());this.heatMap.yAxis.isInversed||(this.completeDataSource.reverse(),p.reverse());this.heatMap.clonedDataSource=p;this.heatMap.dataSourceMinValue=n.isNullOrUndefined(h)?0:parseFloat(h.toString());this.heatMap.dataSourceMaxValue=n.isNullOrUndefined(c)?0:parseFloat(c.toString());this.heatMap.isColorValueExist=!n.isNullOrUndefined(this.heatMap.minColorValue);this.heatMap.minColorValue=n.isNullOrUndefined(this.heatMap.minColorValue)?this.heatMap.dataSourceMinValue:parseFloat(this.heatMap.minColorValue.toString());this.heatMap.maxColorValue=n.isNullOrUndefined(this.heatMap.maxColorValue)?this.heatMap.dataSourceMaxValue:parseFloat(this.heatMap.maxColorValue.toString())},t.prototype.processDataArray=function(t,i,r,u){if(this.heatMap.bubbleSizeWithColor)if(t[i]&&!n.isNullOrUndefined(t[i][r])&&"object"==typeof t[i][r]){for(var e=t[i][r],f=0;f<e.length;f++)if((n.isNullOrUndefined(e[f])||isNaN(e[f]))&&(e[f]=""),0===f)this.tempSizeArray.push(e[f]);else if(1===f){this.tempColorArray.push(e[f]);break}this.completeDataSource[u].push(e)}else!n.isNullOrUndefined(t[i])&&(t[i][r]||0===t[i][r]&&""!==t[i][r].toString())?(this.completeDataSource[u].push([t[i][r]]),this.tempSizeArray.push(t[i][r])):this.completeDataSource[u].push("");else t[i]&&(t[i][r]||0===t[i][r]&&""!==t[i][r].toString())?"object"==typeof t[i][r]?t[i][r].length>0&&!n.isNullOrUndefined(t[i][r][0])?this.completeDataSource[u].push(t[i][r][0]):this.completeDataSource[u].push(""):this.completeDataSource[u].push(t[i][r]):this.completeDataSource[u].push("")},t.prototype.getMinMaxValue=function(n,t,i){var r=[];return this.heatMap.bubbleSizeWithColor?("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.tempSizeArray=i),r.push(this.getMinValue(n,this.tempSizeArray)),r.push(this.getMaxValue(t,this.tempSizeArray)),this.heatMap.minColorValue=this.getMinValue(this.heatMap.minColorValue,this.tempColorArray),this.heatMap.maxColorValue=this.getMaxValue(this.heatMap.maxColorValue,this.tempColorArray)):(r.push(this.getMinValue(n,i)),r.push(this.getMaxValue(t,i))),r},t.prototype.getMinValue=function(t,i){return n.isNullOrUndefined(t)||this.performSort(i)<t?t=this.performSort(i):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(t=this.performSort(i)),n.isNullOrUndefined(t)?t:parseFloat(t.toString())},t.prototype.getMaxValue=function(t,i){return n.isNullOrUndefined(t)&&i.length>0||Math.max.apply(Math,i)>t?t=Math.max.apply(Math,i):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(t=Math.max.apply(Math,i)),n.isNullOrUndefined(t)?t:parseFloat(t.toString())},t.prototype.performSort=function(n){return n.sort(function(n,t){return n-t}).filter(this.checkmin)[0]},t.prototype.checkmin=function(t){return!n.isNullOrUndefined(t)&&""!==t.toString()},t}(),su=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},hu=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return su(i,t),l([n.Property("")],i.prototype,"height",void 0),l([n.Property("")],i.prototype,"width",void 0),l([n.Complex({text:"",textStyle:k.titleFont},ti)],i.prototype,"title",void 0),l([n.Property("Right")],i.prototype,"position",void 0),l([n.Property(!0)],i.prototype,"visible",void 0),l([n.Property("Center")],i.prototype,"alignment",void 0),l([n.Property(!0)],i.prototype,"showLabel",void 0),l([n.Property(!0)],i.prototype,"showGradientPointer",void 0),l([n.Property(!1)],i.prototype,"enableSmartLegend",void 0),l([n.Property("All")],i.prototype,"labelDisplayType",void 0),l([n.Complex(k.legendLabelFont,it)],i.prototype,"textStyle",void 0),l([n.Property("")],i.prototype,"labelFormat",void 0),l([n.Property(!0)],i.prototype,"toggleVisibility",void 0),i}(n.ChildProperty),cu=function(){function t(n){this.maxLegendLabelSize=new o(0,0);this.gradientScaleSize=10;this.segmentCollections=[];this.segmentCollectionsLabels=[];this.textWrapCollections=[];this.labelCollections=[];this.labelCollection=[];this.legendSize=10;this.previousOptions=new br(0,0,0,0,0,0);this.listPerPage=0;this.numberOfPages=1;this.listWidth=0;this.fillRect=new u(0,0,0,0);this.legendRect=new u(0,0,0,0);this.currentPage=1;this.lastList=[];this.navigationCollections=[];this.pagingRect=new u(0,0,0,0);this.listInterval=10;this.legendLabelTooltip=[];this.legendTitleTooltip=[];this.labelXCollections=[];this.labelYCollections=[];this.legendXCollections=[];this.legendYCollections=[];this.legendRectPositionCollection=[];this.legendRange=[];this.legendTextRange=[];this.visibilityCollections=[];this.heatMap=n;this.drawSvgCanvas=new ot(n)}return t.prototype.getModuleName=function(){return"Legend"},t.prototype.destroy=function(){},t.prototype.renderLegendItems=function(){var t=this.heatMap,l,b,o,i,k,e,s,h,d,p,v,c,g,tt,it;t.toggleValue=[];l={color:"transparent",width:0};this.legend=t.renderer.createGroup({id:t.element.id+"_Heatmap_Legend"});b=new w(t.element.id+"_LegendBound","none",l,1,this.legendGroup);this.drawSvgCanvas.drawRectangle(b,this.legend);var y,r=this.legendRectScale,a=t.canvasRenderer.ctx,f=new u(r.x,r.y,r.width,r.height);if("Fixed"===t.paletteSettings.type)for(o=t.legendSettings.enableSmartLegend?t.legendColorCollection:t.colorCollection,this.legendRange=t.resizing||!t.legendOnLoad&&t.rendering?[]:this.legendRange,this.legendTextRange=t.resizing||!t.legendOnLoad&&t.rendering?[]:this.legendTextRange,t.enableCanvasRendering&&(a.save(),a.clip()),i=0;i<o.length;i++)k=!!n.isNullOrUndefined(this.visibilityCollections[i])||this.visibilityCollections[i],t.toggleValue.push(new dr(k,o[i].value,o[i].startValue,o[i].endValue));if("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&!0===t.legendSettings.enableSmartLegend){if("Gradient"===t.paletteSettings.type){if(t.enableCanvasRendering){for(e=void 0,s=t.canvasRenderer.ctx,e=t.horizontalGradient?s.createLinearGradient(r.x,0,r.x+r.width,0):s.createLinearGradient(0,r.y,0,r.y+r.height),t.legendSettings.title.text&&s.clip(),i=0;i<t.legendColorCollection.length;i++)h=((this.heatMap.isColorRange?t.legendColorCollection[i].startValue:t.legendColorCollection[i].value)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),h=isNaN(h)?0:h,this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateCanvasColorRange(i,e):e.addColorStop(h,t.legendColorCollection[i].color);s.fillStyle=e;y=e.toString()}else{for(p=void 0,v=[],i=0;i<t.legendColorCollection.length;i++)if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateColorRange(i,v):(c=(t.legendColorCollection[i].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,c=isNaN(c)?0:c,p=new nt(t.legendColorCollection[i].color,c+"%"),v.push(p)),this.legendMaxValue===this.legendMinValue)break;d=t.horizontalGradient?new fi(t.element.id+"_lineargradient","0%","100%","0%","0%"):new fi(t.element.id+"_lineargradient","0%","0%","0%","100%");g=t.renderer.drawGradient("linearGradient",d,v);this.legend.appendChild(g);y="url(#"+t.element.id+"_lineargradient)"}tt=new w(t.element.id+"_Gradient_Legend",y,l,1,f);this.drawSvgCanvas.drawRectangle(tt,this.legend);this.renderElements(f)}else this.renderSmartLegend(),this.renderTitle(f);t.enableCanvasRendering||t.svgObject.appendChild(this.legend);t.enableCanvasRendering&&a.restore();this.renderLegendLabel(f)}else this.legendScale=t.renderer.createGroup({id:t.element.id+"Heatmap_GradientScale"}),it=new w(t.element.id+"_Gradient_Scale","none",l,1,this.legendRectScale),this.drawSvgCanvas.drawRectangle(it,this.legendScale),this.renderTitle(f),t.enableCanvasRendering||this.legend.appendChild(this.legendScale),this.translategroup=t.renderer.createGroup({id:t.element.id+"_translate"}),this.calculateListPerPage(f),this.numberOfPages>1&&(this.paginggroup=t.renderer.createGroup({id:t.element.id+"_navigation"})),this.renderListLegendMode(f,!0),t.enableCanvasRendering&&a.restore()},t.prototype.renderElements=function(n){this.renderTitle(n);this.renderColorAxisGrid(n)},t.prototype.calculateCanvasColorRange=function(n,t){var i=this.heatMap,r=((i.legendColorCollection[n].startValue<i.dataSourceMinValue&&i.legendColorCollection[n].endValue>i.dataSourceMinValue?i.dataSourceMinValue:i.legendColorCollection[n].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),u;r=isNaN(r)?0:r;u=((i.legendColorCollection[n].endValue>=this.heatMap.dataSourceMaxValue?this.heatMap.dataSourceMaxValue:i.legendColorCollection[n].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);this.heatMap.legendColorCollection[0].startValue!==this.heatMap.dataSourceMinValue&&0===n&&this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&(r=(this.heatMap.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r/2,this.heatMap.paletteSettings.fillColor.minColor),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.maxColor));t.addColorStop(r,i.legendColorCollection[n].minColor);t.addColorStop(u,i.legendColorCollection[n].maxColor);this.heatMap.legendColorCollection[n].endValue!==(n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[n+1].startValue)&&this.heatMap.legendColorCollection[n].endValue<this.heatMap.dataSourceMaxValue&&(r=(i.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.minColor),r=((n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:i.legendColorCollection[n+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.maxColor))},t.prototype.calculateColorRange=function(n,t){var i,u,f,e,r,o;void 0===t&&(t=[]);r=this.heatMap;r.toggleValue=[];this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&0===n&&(i=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,i=isNaN(i)?0:i,u=new nt(r.paletteSettings.fillColor.minColor,i+"%"),t.push(u),i=(r.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,u=new nt(r.paletteSettings.fillColor.maxColor,i+"%"),t.push(u));i=(r.legendColorCollection[n].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;i=isNaN(i)?0:i;u=new nt(r.legendColorCollection[n].minColor,i+"%");t.push(u);i=(r.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;o=new nt(r.legendColorCollection[n].maxColor,i+"%");t.push(o);this.heatMap.legendColorCollection[n].endValue!==(n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[n+1].startValue)&&(i=(r.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=new nt(this.heatMap.paletteSettings.fillColor.minColor,i+"%"),t.push(f),i=((n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:r.legendColorCollection[n+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,e=new nt(this.heatMap.paletteSettings.fillColor.maxColor,i+"%"),t.push(e))},t.prototype.renderTitle=function(n){var t=this.heatMap;if(t.legendSettings.title.text){var f=t.legendSettings.title,i=r(f.text,f.textStyle),e=t.legendSettings.showLabel?this.labelPadding:t.horizontalGradient?10:6,c=void 0,v="start",l=void 0,p=void 0,o=f.text,a=void 0,w=void 0;"Trim"===t.legendSettings.title.textStyle.textOverflow&&(o=y(l=this.width-10,o,f.textStyle));t.horizontalGradient?(c=n.y+("Top"===t.legendSettings.position?0:-(10+i.height+e)),e="Top"===t.legendSettings.position?-(e+i.height/4):e+3*i.height/4,w="Bottom"===t.legendSettings.position?c:c-i.height,0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new b(f.text,new u(n.x,w,l,i.height))),i.width=n.width<i.width?n.width:i.width,a=new s(t.element.id+"_legendTitle",new h(n.x+n.width/2-i.width/2,c+e,v,o,0,"translate(0,0)",p),f.textStyle,f.textStyle.color||t.themeStyle.heatMapTitle)):(e=-(e+i.height/4),0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new b(f.text,new u(n.x,n.y-i.height,l,i.height))),a=new s(t.element.id+"_legendTitle",new h(n.x,n.y+e,v,o,0,"translate(0,0)",p),f.textStyle,f.textStyle.color||t.themeStyle.heatMapTitle));this.drawSvgCanvas.createText(a,this.legend,o)}},t.prototype.renderSmartLegend=function(){var k,s,h,c,l,i=this.heatMap,a=i.colorCollection,nt={color:"transparent",width:0},o=this.legendRectScale,v=o.width/a.length,y=o.height/a.length,t,e,f,d,g,p;for(this.legendRectPositionCollection=[],this.legendRange=[],t=0;t<i.legendColorCollection.length;t++)e=new kr(0,0,0,0,"",""),i.horizontalGradient?(s=o.x+t*v,h=o.y,c=v,l=o.height,this.segmentCollections.push("Edge"!==i.legendSettings.labelDisplayType||t!==i.legendColorCollection.length-1||i.legendColorCollection[t].isHidden?s:s+v)):(s=o.x,h=o.y+t*y,c=o.width,l=y,this.segmentCollections.push("Edge"!==i.legendSettings.labelDisplayType||t!==i.legendColorCollection.length-1||i.legendColorCollection[t].isHidden?h:h+y)),k=new u(s,h,c,l),f=new lt(0,0,0,0,0,!0,0),(f.x=s,f.y=h,f.width=c,f.height=l,f.value=this.heatMap.isColorRange?i.legendColorCollection[t].endValue:i.legendColorCollection[t].value,f.currentPage=this.currentPage,a.length!==i.legendColorCollection.length&&t===i.legendColorCollection.length-1&&(i.horizontalGradient?f.width=0:f.height=0,this.visibilityCollections[t]=this.visibilityCollections[t-1]),f.visible=!!n.isNullOrUndefined(this.visibilityCollections[t])||this.visibilityCollections[t],this.legendRange.push(f),i.legendColorCollection[t].isHidden)||(d=i.legendOnLoad||this.legendRange[t].visible?this.heatMap.isColorRange?a[t].minColor:a[t].color:"#D3D3D3",g=new w(i.element.id+"_Smart_Legend"+t,d,nt,1,k),(this.drawSvgCanvas.drawRectangle(g,this.legend),e.x=s,e.y=h,e.width=c,e.height=l,e.label=this.labelCollections[t],e.id=i.element.id+"_Smart_Legend"+t,this.legendRectPositionCollection.push(e),0!==st(this.labelCollections[t],i.legendSettings.textStyle,this.textWrapCollections[t]).length&&i.enableCanvasRendering)&&(p=r(this.labelCollections[t],i.legendSettings.textStyle),this.legendLabelTooltip.push(new b(this.labelCollections[t],new u(e.x,e.y,p.width,p.height)))))},t.prototype.colorRangeLegendPosition=function(n,t){if(this.segmentCollections.length!==this.segmentCollectionsLabels.length){for(var i=0;i<this.segmentCollections.length;i++)if(this.segmentCollectionsLabels[n]===this.segmentCollections[i]){t=this.segmentCollectionsLabels[n]+((i===this.segmentCollections.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollections[i+1])-this.segmentCollections[i])/2;break}}else t=this.segmentCollectionsLabels[n]+((n===this.segmentCollectionsLabels.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollectionsLabels[n+1])-this.segmentCollectionsLabels[n])/2;this.labelPosition=t},t.prototype.renderLegendLabel=function(t){var i=this.heatMap,p,w,rt,k,nt,ut;if(this.legendTextRange=[],i.legendSettings.showLabel&&("Gradient"===i.paletteSettings.type||"Fixed"===i.paletteSettings.type&&"None"!==i.legendSettings.labelDisplayType)){var d="start",l=void 0,v=void 0,tt=0,y=void 0;this.legendLabelTooltip=[];var e=void 0,g=i.isColorRange,a=i.legendColorCollection;i.enableCanvasRendering?(p=i.canvasRenderer.ctx,p.rect(this.legendGroup.x,this.legendGroup.y,this.legendGroup.width,this.legendGroup.height),p.save(),p.clip(),p.restore()):v=i.renderer.createGroup({id:i.element.id+"_Heatmap_LegendLabel"});for(var o=void 0,c=void 0,f=0;f<a.length;f++){if(w=(a[f].value-Math.round(100*this.legendMinValue)/100)/(Math.round(100*this.legendMaxValue)/100-Math.round(100*this.legendMinValue)/100)*100,i.horizontalGradient?(this.heatMap.isColorRange&&"Gradient"===i.paletteSettings.type?(this.colorRangeLegendPosition(f,o),o=this.labelPosition):o=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===i.paletteSettings.type?this.segmentCollections[f]+t.width/a.length/2:this.segmentCollections[f],c=t.y+t.height+this.labelPadding,d=Math.round(100*w)/100==0&&!g||"Fixed"===i.paletteSettings.type&&0===f?"start":Math.round(100*w)/100==100&&"Gradient"===i.paletteSettings.type&&!g||Math.round(100*i.dataSourceMaxValue)/100===a[f].value&&i.legendSettings.enableSmartLegend||i.legendSettings.enableSmartLegend&&"Fixed"===i.paletteSettings.type&&"Edge"===i.legendSettings.labelDisplayType?"end":"middle",l="hanging"):(o=t.x+t.width+this.labelPadding,this.heatMap.isColorRange&&"Gradient"===i.paletteSettings.type?(this.colorRangeLegendPosition(f,c),c=this.labelPosition):c=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===i.paletteSettings.type?this.segmentCollections[f]+t.height/a.length/2:this.segmentCollections[f],l=Math.round(100*w)/100==0&&!g||0===f&&"Fixed"===i.paletteSettings.type?"hanging":Math.round(100*w)/100==100&&!g&&"Gradient"===i.paletteSettings.type||Math.round(100*i.dataSourceMaxValue)/100===a[f].value&&i.legendSettings.enableSmartLegend||i.legendSettings.enableSmartLegend&&"Edge"===i.legendSettings.labelDisplayType&&"Fixed"===i.paletteSettings.type?"auto":"middle"),tt=i.horizontalGradient?this.textWrapCollections[f]:this.width-(this.legendRectScale.width+this.labelPadding+this.legendRectPadding),e=r((y=st(this.labelCollections[f],i.legendSettings.textStyle,tt))[0],i.legendSettings.textStyle),"Fixed"===i.paletteSettings.type){var ft="hanging"===l?c:"middle"===l?c-e.height/2:c-e.height,et="end"===d?o-e.width:"middle"===d?o-e.width/2:o,it=new lt(et,ft,e.width,e.height,a[f].value,!0,this.currentPage);it.visible=!!n.isNullOrUndefined(this.visibilityCollections[f])||this.visibilityCollections[f];this.legendTextRange.push(it)}if(""!==this.labelCollections[f]&&(0!==y.length&&-1!==y[0].indexOf("...")&&i.enableCanvasRendering&&this.legendLabelTooltip.push(new b(this.labelCollections[f],new u(o,c,e.width,e.height))),rt=new h(o,c,d,y,0,"translate(0,0)",l),k=new s(i.element.id+"_Legend_Label"+f,rt,i.legendSettings.textStyle,i.legendSettings.textStyle.color||i.themeStyle.legendLabel),k.fill=i.legendOnLoad||"Fixed"!==i.paletteSettings.type||this.legendRange[f].visible?k.fill:"#D3D3D3",y.length>1?this.drawSvgCanvas.createWrapText(k,i.legendSettings.textStyle,v):this.drawSvgCanvas.createText(k,v,y[0]),n.Browser.isIE&&!i.enableCanvasRendering&&("middle"===l?v.lastChild.setAttribute("dy","0.6ex"):"hanging"===l&&v.lastChild.setAttribute("dy","1.5ex"))),this.legendMaxValue===this.legendMinValue&&"Gradient"===i.paletteSettings.type)break}i.enableCanvasRendering||(this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,this.legend.appendChild(v),nt=i.renderer.createClipPath({id:i.element.id+"_clipPath"}),ut=i.renderer.drawRectangle(this.legendGroup),nt.appendChild(ut),i.svgObject.appendChild(nt),this.legend.setAttribute("style","clip-path:url(#"+nt.id+")"))}},t.prototype.renderGradientPointer=function(n,t,i){var p,v,r,e,o,s,h,c,l,f=this.heatMap,a=f.heatMapSeries.getCurrentRect(t,i),y=f.bubbleSizeWithColor?""!==a.value[0].bubbleData.toString()?this.heatMap.isColorValueExist?a.value[1].bubbleData.toString():a.value[0].bubbleData.toString():"":a.value.toString(),u=this.legendRectScale;""!==y.toString()?(f.horizontalGradient?(r=u.width/100*((Number(y)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,r=isNaN(r)?0:r,e=u.x+r,o=u.y+u.height,s=u.x-5+r,h=l=u.y+u.height+8,c=u.x+5+r):(r=u.height/100*((Number(y)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,r=isNaN(r)?0:r,e=u.x-1,o=u.y+r,s=c=u.x-8,h=u.y-5+r,l=u.y+5+r),p="M "+e+" "+o+" L "+s+" "+h+" L "+c+" "+l+" Z",v=new d(f.element.id+"_Gradient_Pointer","gray",.01,"#A0A0A0",1,"0,0",p),f.enableCanvasRendering?(this.removeGradientPointer(),f.canvasRenderer.drawPath(v,void 0),this.previousOptions.pathX1=e,this.previousOptions.pathY1=o,this.previousOptions.pathX2=s,this.previousOptions.pathY2=h,this.previousOptions.pathX3=c,this.previousOptions.pathY3=l):(this.gradientPointer=f.renderer.drawPath(v),this.gradientPointer.style.visibility="visible",this.legend.appendChild(this.gradientPointer))):this.removeGradientPointer()},t.prototype.removeGradientPointer=function(){var n=this.heatMap;this.gradientPointer&&!n.enableCanvasRendering?this.gradientPointer.style.visibility="hidden":n.enableCanvasRendering&&(0!==Object.keys(this.previousOptions).length&&(n.horizontalGradient?(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY1,this.fillRect.width=this.previousOptions.pathX3-this.previousOptions.pathX2+2,this.fillRect.height=this.previousOptions.pathY2+1-this.previousOptions.pathY1):(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY2-1,this.fillRect.width=this.previousOptions.pathX1-this.previousOptions.pathX2+1,this.fillRect.height=this.previousOptions.pathY3-this.previousOptions.pathY2+2)),n.canvasRenderer.ctx.fillStyle=n.themeStyle.background,n.canvasRenderer.ctx.fillRect(this.fillRect.x,this.fillRect.y,this.fillRect.width,this.fillRect.height))},t.prototype.calculateLegendBounds=function(n){var t=this.heatMap,f=t.legendSettings,u,c,l,o,h,i,e,s;if(this.labelCollection=[],this.labelCollections=[],u=t.legendColorCollection,"Bottom"!==f.position&&"Top"!==f.position&&"Right"!==f.position&&"Left"!==f.position&&(f.position="Right"),c=t.legendSettings.title,l=r(c.text,c.textStyle),t.horizontalGradient="Bottom"===f.position||"Top"===f.position,this.legendRectPadding=t.horizontalGradient?t.legendSettings.title.text?l.height+16:16:10,this.labelPadding=f.showLabel?this.heatMap.horizontalGradient?10:6:0,this.legendHeight=f.height,this.legendWidth=f.width,o=t.legendSettings.labelFormat,h=null!==o.match("{value}"),this.format=t.intl.getNumberFormat({format:h?"":o}),"Fixed"===t.paletteSettings.type)for(i=0;i<u.length;i++)e={cancel:!1,text:s=u[i].label?u[i].label:this.heatMap.isColorRange?u[i].startValue.toString()+"-"+u[i].endValue.toString():at(h,o,u[i].value,this.format).toString(),name:"legendRender"},this.labelCollection.push(s),this.heatMap.trigger("legendRender",e),t.legendRender?t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&i>0&&i<u.length-1||e.cancel?this.labelCollections.push(""):this.labelCollections.push(e.text):t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&i>0&&i<u.length-1?this.labelCollections.push(""):this.labelCollections.push(s);else for(i=0;i<u.length;i++)e={cancel:!1,text:s=u[i].isHidden?"":u[i].label?u[i].label:this.heatMap.isColorRange?u[i].startValue.toString()+"-"+u[i].endValue.toString():at(h,o,u[i].value,this.format).toString(),name:"legendRender"},u[i].isHidden||this.heatMap.trigger("legendRender",e),t.legendRender?e.cancel||i>0&&i<u.length-1&&"Edge"===t.legendSettings.labelDisplayType||e.cancel?this.labelCollections.push(""):this.labelCollections.push(e.text):i>0&&i<u.length-1&&"Edge"===t.legendSettings.labelDisplayType?this.labelCollections.push(""):this.labelCollections.push(s);"Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend?(this.maxLegendLabelSize=this.getMaxLabelSize(),t.horizontalGradient&&""===f.height?this.legendHeight=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.height).toString():!t.horizontalGradient&&""===f.width&&("None"===f.textStyle.textOverflow||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend&&"None"===t.legendSettings.labelDisplayType)&&(this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.width).toString()),this.calculateTitleBounds()):this.calculateListLegendBounds(n);this.legendHeight=this.legendHeight?this.legendHeight:t.horizontalGradient?"50":"100%";this.legendWidth=this.legendWidth?this.legendWidth:t.horizontalGradient?"100%":"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?"50":"70";this.height=p(this.legendHeight,n.height);this.width=p(this.legendWidth,n.width);t.horizontalGradient?(this.height=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.height<50?50:this.height,"Top"===f.position&&(n.y+=this.height),n.height-=this.height):(this.width=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.width<50?50:this.width,"Left"===f.position&&(n.x+=this.width),n.width-=this.width)},t.prototype.calculateTitleBounds=function(){var n=this.heatMap,i=n.legendSettings.title,t=r(i.text,i.textStyle);n.legendSettings.title.text&&("Top"!==n.legendSettings.position&&"Bottom"!==n.legendSettings.position||""!==n.legendSettings.height||(this.legendHeight=(2*this.legendRectPadding-t.height+this.legendSize+this.maxLegendLabelSize.height).toString()),""===n.legendSettings.width&&("None"===n.legendSettings.textStyle.textOverflow||"Fixed"===n.paletteSettings.type&&n.legendSettings.enableSmartLegend&&"None"===n.legendSettings.labelDisplayType)&&("Right"===n.legendSettings.position?this.legendWidth=(2*this.legendRectPadding+t.width+this.legendSize+this.maxLegendLabelSize.width).toString():"Left"===n.legendSettings.position&&(t.width=t.width>this.maxLegendLabelSize.width?t.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+t.width+this.legendSize).toString())))},t.prototype.calculateListLegendBounds=function(n){var t=this.heatMap,u,f,o;this.listWidth=0;this.listHeight=0;this.currentPage=1;var e=t.legendSettings.title,i=r(e.text,e.textStyle),s=(i.height+50).toString();if(t.horizontalGradient){for(u=0;u<t.colorCollection.length;u++)f=0,t.legendSettings.showLabel&&(f=r(this.labelCollections[u],t.legendSettings.textStyle).width),o=this.legendSize+this.labelPadding+f+this.listInterval,this.listWidth+=o;this.listWidth+=this.listInterval+10;""===this.legendWidth&&(this.legendWidth=this.listWidth>n.width?n.width.toString():this.listWidth.toString());""===this.legendHeight&&(this.numberOfRows=Math.ceil(this.listWidth/p(this.legendWidth,n.width)),this.numberOfRows=this.numberOfRows>3?3:this.numberOfRows,this.legendHeight=(this.listWidth>n.width||this.listWidth>p(this.legendWidth,n.width))&&this.numberOfRows>3?((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding+parseInt(t.legendSettings.textStyle.size,10)+10).toString():((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding).toString())}else this.listHeight=(this.legendSize+this.listInterval)*t.colorCollection.length+this.listInterval+(t.legendSettings.title.text?i.height:0),""===this.legendHeight&&(this.legendHeight=this.listHeight>n.height?n.height.toString():this.listHeight.toString()),""===this.legendWidth&&"Trim"!==t.legendSettings.textStyle.textOverflow&&(this.maxLegendLabelSize=this.getMaxLabelSize(),this.maxLegendLabelSize.width=i.width>this.maxLegendLabelSize.width?i.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.labelPadding+this.maxLegendLabelSize.width).toString());p(this.legendHeight,n.height)<50&&(this.legendHeight=s);p(this.legendWidth,n.width)<70&&(this.legendWidth="70")},t.prototype.getMaxLabelSize=function(){var n=this.heatMap,t,u,i;if(this.maxLegendLabelSize=new o(0,0),!n.legendSettings.showLabel||n.horizontalGradient&&"Fixed"===n.paletteSettings.type&&!n.legendSettings.enableSmartLegend||"Fixed"===n.paletteSettings.type&&"None"===n.legendSettings.labelDisplayType)return this.maxLegendLabelSize;for(t=this.maxLegendLabelSize,u=0;u<n.legendColorCollection.length;u++)i=r(this.labelCollections[u],n.legendSettings.textStyle),t.width=t.width>i.width?t.width:i.width,t.height=t.height>i.height?t.height:i.height;return t},t.prototype.calculateLegendSize=function(n,t){var c,l,f,i=this.heatMap,a=i.legendSettings,h=a.alignment,e=p(this.legendHeight,n.height),o,s,y,w;f=i.legendSettings.title.text?this.width:p(this.legendWidth,n.width);o=i.axisCollections;s=0;i.horizontalGradient?(f=f>n.width?n.width:f,e="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?e>50?e:50:this.height,c="Near"===h?n.x:"Far"===h?n.x+n.width-f:n.x+n.width/2-f/2,""!==i.xAxis.title.text&&(s=r(i.xAxis.title.text,i.xAxis.textStyle).height+10),y=o[0].opposedPosition?0:v(o[0].xAxisMultiLabelHeight)+o[0].maxLabelSize.height+s+10,l="Top"===a.position?i.titleSettings.text?t:i.margin.top:n.y+n.height+y):(e=e>n.height?n.height:e,f="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?f>50?f:50:f,l="Near"===h?n.y:"Far"===h?n.y+n.height-e:n.y+n.height/2-e/2,""!==i.yAxis.title.text&&(s=r(i.yAxis.title.text,i.yAxis.textStyle).height+10),w=o[1].opposedPosition?v(o[1].yAxisMultiLabelHeight)+o[1].maxLabelSize.width+s+20:0,c="Right"===a.position?n.x+n.width+w:i.margin.left);this.legendGroup=new u(c,l,f,e);this.calculateGradientScale(this.legendGroup)},t.prototype.measureListLegendBound=function(n){var i=this.heatMap,u=i.legendSettings.title,f,t;this.numberOfPages=1;f=r(u.text,u.textStyle);i.horizontalGradient?this.listWidth>this.width?(this.numberOfRows=Math.ceil(this.listWidth/this.width),this.listHeight=(this.legendSize+this.listInterval)*this.numberOfRows,this.listPerPage=this.numberOfRows<=3?this.numberOfRows:Math.ceil((this.height-15-parseInt(i.legendSettings.textStyle.size,10)-this.legendRectPadding)/(this.legendSize+this.listInterval)),this.numberOfPages=Math.ceil(this.numberOfRows/this.listPerPage)):this.listPerPage=1:this.listHeight>n.height||this.listHeight>this.height?(t=p(this.legendHeight,n.height),t=t>n.height?n.height:t,t=i.legendSettings.title.text?t-f.height:t,this.listPerPage=Math.floor(t/(this.legendSize+this.listInterval)-1),this.numberOfPages=Math.max(1,Math.ceil(i.colorCollection.length/this.listPerPage))):(this.listPerPage=i.colorCollection.length,this.legendHeight=this.listHeight.toString())},t.prototype.renderPagingElements=function(){var t=this.heatMap,k,v,y,p,b,nt,tt;if(this.numberOfPages>1){this.navigationCollections=[];this.legend.appendChild(this.paginggroup);var i=10,e=this.legendGroup.x+this.legendGroup.width-i,f=this.legendGroup.y+this.legendGroup.height-i,l=this.currentPage+"/"+this.numberOfPages,o=r(l,t.legendSettings.textStyle),a=e-o.width-15,it=new h(a,f,"start",l,0,"translate(0,0)","middle"),rt=new s(t.element.id+"_paging",it,t.legendSettings.textStyle,t.legendSettings.textStyle.color||t.themeStyle.legendLabel);this.drawSvgCanvas.createText(rt,this.paginggroup,l);n.Browser.isIE&&!t.enableCanvasRendering&&this.paginggroup.lastChild.setAttribute("dy","0.6ex");this.pagingRect=new u(a,f-o.height/2,o.width,o.height);k=new w(t.element.id+"_pagingText","none",{color:"transparent",width:0},1,this.pagingRect);this.drawSvgCanvas.drawRectangle(k,this.paginggroup);v=new w(t.element.id+"_rightArrow","none",{color:"transparent",width:0},1,new u(e-i,f-5,i,i));this.drawSvgCanvas.drawRectangle(v,this.paginggroup);var ut="M "+e+" "+f+" L "+(e-i)+" "+(f-5)+" L "+(e-i)+" "+(f+5)+"Z",c=a-15,ft="M "+c+" "+f+" L "+(c+i)+" "+(f-5)+" L "+(c+i)+" "+(f+5)+"Z",g=new w(t.element.id+"_leftArrow","none",{color:"transparent",width:0},1,new u(c,f-5,i,i));this.drawSvgCanvas.drawRectangle(g,this.paginggroup);y=new d(t.element.id+"_Legend_leftarrow","gray",.01,"#A0A0A0",1,"0,0",ft);p=new d(t.element.id+"_Legend_rightarrow","gray",.01,"#A0A0A0",1,"0,0",ut);(this.navigationCollections.push(v),this.navigationCollections.push(g),t.enableCanvasRendering)?(b=void 0,t.canvasRenderer.drawPath(y,b),t.canvasRenderer.drawPath(p,b)):(nt=t.renderer.drawPath(y),tt=t.renderer.drawPath(p),this.paginggroup.appendChild(nt),this.paginggroup.appendChild(tt))}},t.prototype.calculateGradientScale=function(n){var i,f,e,o,t=this.heatMap,s=t.legendSettings.title,c=r(s.text,s.textStyle),h=t.legendSettings.title.text?c.height:0;"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend||this.measureListLegendBound(t.initialClipRect);t.horizontalGradient?(i=n.x+10,f=n.y+this.legendRectPadding,o="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?n.width-20:n.width-2*this.listInterval,e="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval):(i=n.x+this.legendRectPadding,f=n.y+10+h,o="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:n.width-10,e="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?n.height-20-h:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval);this.legendRectScale=new u(i,f,o,e);("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend)&&this.calculateColorAxisGrid(this.legendRectScale)},t.prototype.calculateColorAxisGrid=function(n){var o,p,w,f,t=this.heatMap,c=this.legendRectScale,s=0,u,r,h,e,a,v,y;this.segmentCollectionsLabels=[];this.segmentCollections=[];this.textWrapCollections=[];var l,i="Gradient"===t.paletteSettings.type?t.legendColorCollection:t.colorCollection,b=t.bubbleSizeWithColor?t.minColorValue:t.dataSourceMinValue,k=t.bubbleSizeWithColor?t.maxColorValue:t.dataSourceMaxValue;if(this.legendMinValue=this.heatMap.isColorRange?i[0].startValue>t.dataSourceMinValue?t.dataSourceMinValue:i[0].startValue:i[0].value>b?b:i[0].value,this.legendMaxValue=this.heatMap.isColorRange?i[i.length-1].endValue<t.dataSourceMaxValue?t.dataSourceMaxValue:i[i.length-1].endValue:i[i.length-1].value<k?k:i[i.length-1].value,"Gradient"===t.paletteSettings.type)for(u=0;u<i.length;u++)r=void 0,o=(this.heatMap.isColorRange&&t.horizontalGradient?c.width:c.height)/100,this.heatMap.isColorRange?(i[0].startValue!==this.heatMap.dataSourceMinValue&&0===u&&i[0].startValue>this.heatMap.dataSourceMinValue&&(r=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f)),r=((i[u].startValue<t.dataSourceMinValue&&i[u].endValue>t.dataSourceMaxValue?t.dataSourceMinValue:i[u].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,r=isNaN(r)?0:r,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f),this.segmentCollectionsLabels.push(f),i[u].endValue!==(u===i.length-1?this.heatMap.dataSourceMaxValue:i[u+1].startValue)&&this.heatMap.legendColorCollection[u].endValue<this.heatMap.dataSourceMaxValue&&(u===i.length-1&&(r=(i[u].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f)),r=((u===i.length-1?this.heatMap.dataSourceMaxValue:i[u].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f))):(r=(i[u].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,r=isNaN(r)?0:r,t.horizontalGradient?(o=c.width/100,w=n.x+o*r,this.segmentCollections.push(w)):(o=c.height/100,f=n.y+o*r,this.segmentCollections.push(f)));if(t.horizontalGradient){for(h=this.heatMap.isColorRange?this.segmentCollectionsLabels:this.segmentCollections,e=0;e<i.length;e++)"Gradient"===t.paletteSettings.type?(a=(h[e]-h[e-1])/2,v=(h[e+1]-h[e])/2,l=e===i.length-1?this.heatMap.isColorRange?(n.width-h[e-1])/2:a:0===e?v:a<v&&!this.heatMap.isColorRange?a:v):(y=this.legendRectScale.width/t.colorCollection.length,l="Edge"===t.legendSettings.labelDisplayType?y:y/2),this.textWrapCollections.push(l),s=(p=st(this.labelCollections[e],t.legendSettings.textStyle,l)).length>s?p.length:s;"Bottom"===t.legendSettings.position?(t.initialClipRect.height-=this.maxLegendLabelSize.height*(s-1),this.legendGroup.y-=this.maxLegendLabelSize.height*(s-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(s-1)):(t.initialClipRect.y+=this.maxLegendLabelSize.height*(s-1),t.initialClipRect.height-=this.maxLegendLabelSize.height*(s-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(s-1))}},t.prototype.renderColorAxisGrid=function(n){var r,u,f,e,o,t=this.heatMap,i,s,h;for(t.enableCanvasRendering||(r=this.heatMap.renderer.createGroup({id:t.element.id+"_ColorAxis_Grid"})),i=0;i<(t.isColorRange?this.segmentCollections.length:t.legendColorCollection.length);i++)t.horizontalGradient?(u=e=this.segmentCollections[i],f=n.y,o=n.y+n.height):(u=n.x,f=o=this.segmentCollections[i],e=n.x+n.width),s=new ri(u,f,e,o),h=new ui(this.heatMap.element.id+"_ColorAxis_Grid"+i,s,"#EEEEEE",1),this.drawSvgCanvas.drawLine(h,r),t.enableCanvasRendering||this.legend.appendChild(r)},t.prototype.renderLegendTitleTooltip=function(n,t,i){if(-1!==n.target.id.indexOf("_legendTitle")&&n.target.textContent.indexOf("...")>-1)ht(this.heatMap.legendSettings.title.text,t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_legendTitle_Tooltip",ut(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip").style.visibility="visible";else{var r=document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip");r&&(r.style.visibility="hidden")}},t.prototype.renderLegendLabelTooltip=function(n,t,i){var r,f,u;-1!==n.target.id.indexOf("_Legend_Label")&&n.target.textContent.indexOf("...")>-1?(r=n.target.id.split(this.heatMap.element.id+"_Legend_Label"),2===r.length&&(f=1===r[1].length||"Trim"===this.heatMap.legendSettings.textStyle.textOverflow?parseInt(r[1],10):parseInt(r[1].substring(0,r[1].length-1),10),ht(this.labelCollections[f],t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_LegendLabel_Tooltip",ut(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip").style.visibility="visible")):(u=document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip"),u&&(u.style.visibility="hidden"))},t.prototype.calculateListPerPage=function(n){var u=this.heatMap,c;if(u.horizontalGradient){this.lastList=[];var i=n.x,f=n.y,h=0,e=0,o=0,s=0,t=void 0;for(this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],t=0;t<u.colorCollection.length;t++)u.legendSettings.showLabel&&(h=r(this.labelCollections[t],u.legendSettings.textStyle).width),o=i+10+5,s=f+5,c=u.legendSettings.showLabel?o+h:i+this.legendSize+this.listInterval,0!==t&&c>this.legendGroup.width+this.legendGroup.x-this.listInterval&&(e+=1,o=(i=n.x)+10+5,s=(f=n.y+20*e)+5,e%this.listPerPage==0&&(this.lastList.push(t),s=(f=n.y)+5,e=0)),this.labelXCollections.push(o),this.labelYCollections.push(s),this.legendXCollections.push(i),this.legendYCollections.push(f),i=i+this.legendSize+this.labelPadding+h+this.listInterval;this.lastList.push(t);this.numberOfPages=this.lastList.length}},t.prototype.renderListLegendMode=function(t,i){var ut,f=this.heatMap,vt={color:"transparent",width:0},ft,e,k,it,et,rt,d,ot,g,ht,ct,nt,at;this.legendLabelTooltip=[];var tt,v,c=new o(0,0),y=0,p=0,l=t.x,a=t.y;for(i&&this.renderPagingElements(),ft=f.legendSettings.title.text?this.width-2*(this.legendSize+this.labelPadding):this.legendGroup.width-(this.legendSize+this.legendRectPadding+this.labelPadding),f.horizontalGradient?(tt=1===this.currentPage?0:this.lastList[this.currentPage-2],v=this.lastList[this.currentPage-1]):v=(v=(tt=this.currentPage*this.listPerPage-this.listPerPage)+this.listPerPage)<f.colorCollection.length?v:f.colorCollection.length,e=tt;e<v;e++)f.legendSettings.showLabel&&(c=r(d=this.labelCollections[e],f.legendSettings.textStyle)),k={cancel:!1,text:this.labelCollection[e],name:"legendRender"},(f.horizontalGradient&&(l=this.legendXCollections[e],a=this.legendYCollections[e],y=this.labelXCollections[e],p=this.labelYCollections[e]),y=l+this.legendSize+this.labelPadding,p=a+5,this.heatMap.trigger("legendRender",k),i&&f.rendering&&this.legendRange.length<=f.colorCollection.length)&&(it=new lt(l,a,10,10,f.colorCollection[e].value,!0,this.currentPage),(it.visible=!!n.isNullOrUndefined(this.visibilityCollections[e])||this.visibilityCollections[e],k.cancel)?(et=new lt(l,a,0,0,f.colorCollection[e].value,!0,this.currentPage),this.legendRange.push(et)):this.legendRange.push(it),f.legendSettings.showLabel&&(rt=new lt(y,p-c.height/2,c.width,c.height,f.colorCollection[e].value,!0,this.currentPage),rt.visible=!!n.isNullOrUndefined(this.visibilityCollections[e])||this.visibilityCollections[e],this.legendTextRange.push(rt))),k.cancel||(f.legendSettings.showLabel&&(-1!==(d=st(this.labelCollections[e],f.legendSettings.textStyle,ft))[0].indexOf("...")&&f.enableCanvasRendering&&this.legendLabelTooltip.push(new b(this.labelCollections[e],new u(y,p,c.width,c.height))),ot=new h(y,p,"start",d,0,"translate(0,0)","middle"),g=new s(f.element.id+"_Legend_Label"+e,ot,f.legendSettings.textStyle,f.legendSettings.textStyle.color||f.themeStyle.legendLabel),g.fill=f.legendOnLoad||this.legendRange[e].visible?g.fill:"#D3D3D3",this.drawSvgCanvas.createText(g,this.translategroup,d[0]),n.Browser.isIE&&!f.enableCanvasRendering&&this.translategroup.lastChild.setAttribute("dy","0.6ex")),ut=new u(l,a,10,10),ht=f.legendOnLoad||this.legendRange[e].visible?this.heatMap.isColorRange?f.colorCollection[e].minColor:f.colorCollection[e].color:"#D3D3D3",ct=new w(f.element.id+"_legend_list"+e,ht,vt,1,ut),this.drawSvgCanvas.drawRectangle(ct,this.translategroup),f.horizontalGradient?l=l+this.legendSize+this.labelPadding+c.width+this.listInterval:a+=this.legendSize+this.listInterval);f.enableCanvasRendering||(this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,nt=f.renderer.createClipPath({id:f.element.id+"_LegendScale_ClipPath"}),at=f.renderer.drawRectangle(this.legendGroup),nt.appendChild(at),this.translategroup.appendChild(nt),this.legend.setAttribute("style","clip-path:url(#"+nt.id+")"),this.legendScale.appendChild(this.translategroup),f.svgObject.appendChild(this.legend))},t.prototype.translatePage=function(n,t,i){if(i&&t>=1&&t<this.numberOfPages||!i&&t>1&&t<=this.numberOfPages){if(i?(this.currentPage+=1,this.legendRect.y+=this.legendRect.height):(this.currentPage-=1,this.legendRect.y-=this.legendRect.height),n.enableCanvasRendering)(f=n.canvasRenderer.ctx).fillRect(this.legendRectScale.x-5,this.legendRectScale.y-5,this.legendRectScale.width+5,this.legendRectScale.height+10),f.fillRect(this.pagingRect.x,this.pagingRect.y,this.pagingRect.width,this.pagingRect.height);else for(this.paginggroup.removeChild(this.paginggroup.firstChild);this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);this.renderListLegendMode(this.legendRectScale,!0)}if(n.enableCanvasRendering&&n.allowSelection&&n.rectSelected){var f=n.secondaryCanvasRenderer.ctx,u=n.legendSettings.position,r=n.initialClipRect,e="Right"===u?r.x+r.width:0,o="Bottom"===u?r.y+r.height:0,s="Right"===u?n.availableSize.width-(r.x+r.width):"Left"===u?r.x:n.availableSize.width,h="Top"===u?r.y:"Bottom"===u?n.availableSize.height-(r.y+r.height):n.availableSize.height;f.save();f.clearRect(e,o,s,h);f.restore();var c=document.getElementById(n.element.id+"_canvas"),l=document.getElementById(n.element.id+"_secondary_canvas"),a=c.getContext("2d").getImageData(e,o,s,h);l.getContext("2d").putImageData(a,e,o);c.style.opacity="0.3"}},t.prototype.createTooltipDiv=function(){var t=n.createElement("div",{id:this.heatMap.element.id+"legendLabelTooltipContainer",styles:"position:absolute"});this.heatMap.element.appendChild(t)},t.prototype.renderTooltip=function(n){var i,t=this.heatMap,r=[n.label];i=parseInt(t.legendSettings.textStyle.size,10)/2;this.tooltipObject=new tt.Tooltip({offset:i,theme:t.theme,content:r,location:{x:n.x+n.width/2,y:n.y+n.height/2},inverted:!t.horizontalGradient,areaBounds:{height:this.legendGroup.height+this.legendGroup.y,width:this.legendGroup.width+this.legendGroup.x,x:"Right"===t.legendSettings.position?0:this.legendGroup.x,y:"Top"===t.legendSettings.position?""===t.titleSettings.text?this.legendGroup.height-this.legendGroup.y:this.legendGroup.y:0}},"#"+this.heatMap.element.id+"legendLabelTooltipContainer");this.tooltipObject.element.style.visibility="visible"},t.prototype.createTooltip=function(n,t){for(var f,i,u,r=0;r<this.heatMap.colorCollection.length;r++)if(i=this.legendRectPositionCollection[r],i&&n>i.x&&n<i.width+i.x&&t>i.y&&t<i.height+i.y){f=this.legendRectPositionCollection[r];break}u=document.getElementById(this.heatMap.element.id+"legendLabelTooltipContainer");u&&"visible"===u.style.visibility&&this.tooltipObject&&!this.heatMap.isTouch&&(this.tooltipObject.fadeOut(),u.style.visibility="hidden");f&&this.renderTooltip(f)},t.prototype.legendRangeSelection=function(n){var t=this.heatMap,r=this.legendRange,s=t.horizontalGradient?10:0,i=this.legendRectScale,f=t.canvasRenderer.ctx,e,o;if(t.rangeSelection=!0,t.enableCanvasRendering)e=t.canvasRenderer.ctx,t.legendSettings.enableSmartLegend?e.fillRect(i.x-5,i.y-5,i.width+this.labelPadding+this.maxLegendLabelSize.width+5,i.height+2*(5+s)):e.fillRect(i.x-5,i.y-5,i.width+5,i.height+10);else{if(t.legendSettings.enableSmartLegend)for(;this.legend&&this.legend.childNodes.length;)this.legend.removeChild(this.legend.firstChild);else for(;this.translategroup&&this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);c(t.heatMapSeries.containerRectObject.id);t.cellSettings.showLabel&&c(t.heatMapSeries.containerTextObject.id)}(t.legendSettings.enableSmartLegend&&t.colorCollection.length!==t.legendColorCollection.length&&(n===t.legendColorCollection.length-1?t.toggleValue[n-1].visible=this.visibilityCollections[n-1]=r[n-1].visible=!r[n].visible:n===t.colorCollection.length-1&&(t.toggleValue[n+1].visible=this.visibilityCollections[n+1]=r[n+1].visible=!r[n].visible)),t.toggleValue[n].visible=this.visibilityCollections[n]=r[n].visible=!r[n].visible,t.legendOnLoad=!1,t.legendSettings.enableSmartLegend)?(this.renderSmartLegend(),o=new u(i.x,i.y,i.width,i.height),this.renderLegendLabel(o),t.enableCanvasRendering&&(f.save(),f.clip()),"SVG"===t.renderingMode&&this.renderTitle(o)):this.renderListLegendMode(this.legendRectScale,!1);t.enableCanvasRendering&&f.restore();t.heatMapSeries.renderRectSeries();t.clearSelection();t.enableCanvasRendering&&t.allowSelection},t.prototype.updateLegendRangeCollections=function(){var n=this.heatMap;n.rangeSelection=!n.legendOnLoad;this.visibilityCollections=n.legendOnLoad?[]:this.visibilityCollections;n.toggleValue=n.legendOnLoad?[]:n.toggleValue;this.legendRange=n.legendOnLoad?[]:this.legendRange;this.legendTextRange=n.legendOnLoad?[]:this.legendTextRange},t}(),lu=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ft=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},au=function(t){function i(){return null!==t&&t.apply(this,arguments)||this}return lu(i,t),ft([n.Property(!1)],i.prototype,"isJsonData",void 0),ft([n.Property("None")],i.prototype,"adaptorType",void 0),ft([n.Property("")],i.prototype,"xDataMapping",void 0),ft([n.Property("")],i.prototype,"yDataMapping",void 0),ft([n.Property("")],i.prototype,"valueMapping",void 0),ft([n.Complex({},nr)],i.prototype,"bubbleDataMapping",void 0),i}(n.ChildProperty),yi=function(){return function(){}}(),vu=function(){function t(n){this.reconstructedXAxis=[];this.reconstructedYAxis=[];this.adaptiveXMinMax=new yi;this.adaptiveYMinMax=new yi;this.heatMap=n}return t.prototype.constructDatasource=function(t,i){if("Cell"===i.adaptorType){var r=this.heatMap.xAxis,u=this.heatMap.yAxis;this.adaptiveXMinMax.min=r.minimum;this.adaptiveXMinMax.max=r.maximum;this.adaptiveYMinMax.min=u.minimum;this.adaptiveYMinMax.max=u.maximum;("Numeric"!==r.valueType&&"DateTime"!==r.valueType||!n.isNullOrUndefined(r.minimum)&&!n.isNullOrUndefined(r.maximum))&&("Numeric"!==u.valueType&&"DateTime"!==u.valueType||!n.isNullOrUndefined(u.minimum)&&!n.isNullOrUndefined(u.maximum))||this.getMinMaxValue(t,i,r,u);this.heatMap.isCellData=!0}"None"===i.adaptorType?this.heatMap.completeAdaptDataSource=t:i.isJsonData||"Table"!==i.adaptorType?i.isJsonData&&"Table"===i.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonTableData(t,i):i.isJsonData&&"Cell"===i.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonCellData(t,i):i.isJsonData||"Cell"!==i.adaptorType||(this.constructAdaptiveAxis(),this.heatMap.completeAdaptDataSource=this.processCellData(t),this.heatMap.isCellData=!0):this.heatMap.completeAdaptDataSource=t},t.prototype.constructAdaptiveAxis=function(){var n=this.heatMap.xAxis,t=this.heatMap.yAxis;"Numeric"===n.valueType&&(this.reconstructedXAxis=this.getNumericAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,n.increment));"Numeric"===t.valueType&&(this.reconstructedYAxis=this.getNumericAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.increment));"DateTime"===n.valueType&&(this.reconstructedXAxis=this.getDateAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,n.intervalType,n.increment));"DateTime"===t.valueType&&(this.reconstructedYAxis=this.getDateAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.intervalType,t.increment))},t.prototype.getNumericAxisCollection=function(n,t,i){for(var r=n,u=[];r<=t;)u.push(r.toString()),r+=i;return u},t.prototype.getDateAxisCollection=function(n,t,i,r){for(var f={skeleton:"full",type:"dateTime"},o=this.heatMap.intl.getDateParser(f),s=this.heatMap.intl.getDateFormat(f),u=n=Date.parse(o(s(new Date(vt.DataUtil.parse.parseJson({val:n}).val)))),e=[];u<=t;)e.push(new Date(u).toString()),u=ct(u,1,i,r).getTime();return e},t.prototype.getMinMaxValue=function(t,i,r,u){var f=t,o=Object.keys(f[0]),e,s,h;for(f.length>0&&(this.adaptiveXMinMax.min=n.isNullOrUndefined(r.minimum)?i.isJsonData?f[0][o[0]]:f[0][0]:r.minimum,this.adaptiveYMinMax.min=n.isNullOrUndefined(u.minimum)?i.isJsonData?f[0][o[1]]:f[0][1]:u.minimum,this.adaptiveXMinMax.max=n.isNullOrUndefined(r.maximum)?i.isJsonData?f[0][o[0]]:f[0][0]:r.maximum,this.adaptiveYMinMax.max=n.isNullOrUndefined(u.maximum)?i.isJsonData?f[0][o[1]]:f[0][1]:u.maximum),e=0;e<f.length;e++)s=i.isJsonData?f[e][o[0]]:f[e][0],h=i.isJsonData?f[e][o[1]]:f[e][1],s<this.adaptiveXMinMax.min&&n.isNullOrUndefined(r.minimum)&&(this.adaptiveXMinMax.min=s),s>this.adaptiveXMinMax.max&&n.isNullOrUndefined(r.maximum)&&(this.adaptiveXMinMax.max=s),h<this.adaptiveYMinMax.min&&n.isNullOrUndefined(u.minimum)&&(this.adaptiveYMinMax.min=h),h>this.adaptiveYMinMax.max&&n.isNullOrUndefined(u.maximum)&&(this.adaptiveYMinMax.max=h)},t.prototype.processCellData=function(t){var i=t,e=this.reconstructedXAxis,o=this.reconstructedYAxis,u=0,f=0,r;if(this.reconstructData=[],i&&i.length)for(r=0;r<i.length;r++)if((u="Category"===this.heatMap.xAxis.valueType?i[r][0]:e.indexOf(i[r][0].toString()))>-1){for(;!this.reconstructData[u];)this.reconstructData.push([]);if(-1!==(f="Category"===this.heatMap.yAxis.valueType?i[r][1]:o.indexOf(i[r][1].toString()))){for(;""!==this.reconstructData[u][f];)this.reconstructData[u].push("");this.reconstructData[u][f]=n.isNullOrUndefined(i[r][2])?"":i[r][2]}}return this.reconstructData},t.prototype.processJsonCellData=function(t,i){var u=t,s=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],h=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],e=this.heatMap.axisCollections,r;0!==s.length&&0!==h.length||this.generateAxisLabels(t,i);var c="Category"===this.heatMap.xAxis.valueType?s.length>0?this.heatMap.xAxis.labels:e[0].jsonCellLabel:e[0].labelValue,l="Category"===this.heatMap.yAxis.valueType?h.length>0?this.heatMap.yAxis.labels:e[1].jsonCellLabel:e[1].labelValue,f=0,o=0;if(u.length)for(this.reconstructData=[],r=0;r<u.length;r++)if(-1!==(f=this.getSplitDataValue(u[r],i,c,i.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[f];)this.reconstructData.push([]);if(-1!==(o=this.getSplitDataValue(u[r],i,l,i.yDataMapping.split("."),this.heatMap.yAxis.valueType))){for(;n.isNullOrUndefined(this.reconstructData[f][o]);)this.reconstructData[f].push("");this.reconstructData[f][o]=this.heatMap.bubbleSizeWithColor?[this.getSplitDataValue(u[r],i,null,i.bubbleDataMapping.size.split("."),""),this.getSplitDataValue(u[r],i,null,i.bubbleDataMapping.color.split("."),"")]:this.getSplitDataValue(u[r],i,null,i.valueMapping.split("."),"")}}return this.reconstructData},t.prototype.generateAxisLabels=function(n,t){for(var h,i,r,l,o=n,a=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],v=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],y=a.length>0,p=v.length>0,s=this.heatMap.axisCollections,u=0;u<s.length;u++)if(h=s[u].valueType,i=s[u],"Category"===h){var c=void 0,f=void 0,e=void 0;if("Horizontal"===i.orientation?(c=y,f=t.xDataMapping,i.jsonCellLabel=e=[]):(c=p,f=t.yDataMapping,i.jsonCellLabel=e=[]),!c)for(r=0;r<o.length;r++)f in o[r]&&(l=o[r][f].toString(),-1===e.indexOf(l.toString())&&e.push(l))}else"DateTime"===h?(i.clearAxisLabel(),i.calculateDateTimeAxisLabel(this.heatMap)):(i.clearAxisLabel(),i.calculateNumericAxisLabels(this.heatMap))},t.prototype.getSplitDataValue=function(t,i,r,u,f){var o=-1,e;for(this.tempSplitDataCollection=t,e=0;e<u.length&&(o=n.isNullOrUndefined(r)?null:"DateTime"!==f?r.indexOf(this.tempSplitDataCollection[u[e]]):r.map(Number).indexOf(+this.tempSplitDataCollection[u[e]]),n.isNullOrUndefined(this.tempSplitDataCollection)||(this.tempSplitDataCollection=-1===o||n.isNullOrUndefined(r)?this.tempSplitDataCollection[u[e]]:this.tempSplitDataCollection),!n.isNullOrUndefined(this.tempSplitDataCollection));e++);return n.isNullOrUndefined(r)?n.isNullOrUndefined(this.tempSplitDataCollection)||""===this.tempSplitDataCollection.toString()?"":parseFloat(this.tempSplitDataCollection.toString()):o},t.prototype.processJsonTableData=function(t,i){var u,o=t,r=0,s=0,h=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],c=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],f,e;if(o.length)for(this.reconstructData=[],f=0;f<o.length;f++)if(-1!==(r=this.getSplitDataValue(o[f],i,h,i.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[r];)this.reconstructData.push([]);for(e=0;e<Object.keys(this.tempSplitDataCollection).length;e++)if(-1!==(s=(u=Object.keys(this.tempSplitDataCollection)[e])!==i.xDataMapping?c.indexOf(u):-1)){for(;n.isNullOrUndefined(this.reconstructData[r][s]);)this.reconstructData[r].push("");this.reconstructData[r][s]=n.isNullOrUndefined(this.tempSplitDataCollection[u])?"":this.tempSplitDataCollection[u]}}return this.reconstructData},t.prototype.destroy=function(){},t.prototype.getModuleName=function(){return"Adaptor"},t}();const dt=ejdashboard.pdfexport;var pi=function(){function t(n){this.control=n}return t.prototype.export=function(t,i,r){var y,p=this,f=this.getControlsValue(),l=f.width,a=f.height,u=this.control.svgObject,v=this.control.enableCanvasRendering,e,w,o,b,s,h,k;v||(u=n.createElement("canvas",{id:"ej2-canvas",attrs:{width:l.toString(),height:a.toString()}}));e=!(n.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);r=n.isNullOrUndefined(r)?dt.PdfPageOrientation.Landscape:r;w='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+f.svg.outerHTML+"<\/svg>";o=window.URL.createObjectURL(new Blob("SVG"===t?[w]:[(new XMLSerializer).serializeToString(f.svg)],{type:"image/svg+xml"}));"SVG"===t?"msie"===n.Browser.info.name?(b=new Blob([(new XMLSerializer).serializeToString(f.svg)],{type:"application/octet-stream"}),window.navigator.msSaveOrOpenBlob(b,i+"."+t.toLocaleLowerCase())):this.triggerDownload(i,t,o,e):"msie"===n.Browser.info.name?(s=u,v||(s=this.createCanvas()),y=s.toDataURL(t),"PDF"===t?this.exportPdf(s,r,l,a,e,i):this.doExport(t,y,i)):(h=new Image,k=u.getContext("2d"),h.onload=function(){k.drawImage(h,0,0);window.URL.revokeObjectURL(o);"PDF"===t?p.exportPdf(u,r,l,a,e,i):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(u.msToBlob(),i+"."+t.toLocaleLowerCase()):p.triggerDownload(i,t,u.toDataURL("image/png").replace("image/png","image/octet-stream"),e)},h.src=o);v||c(document.getElementById(this.control.element.id)+"_canvas")},t.prototype.triggerDownload=function(t,i,r,u){n.createElement("a",{attrs:{download:t+"."+i.toLocaleLowerCase(),href:r}}).dispatchEvent(new MouseEvent(u?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},t.prototype.getControlsValue=function(){var n=0,t=0,r=this.control.enableCanvasRendering,i=new tt.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200}),f=this.control.svgObject.cloneNode(!0),u=this.control.renderer.createGroup({style:"transform: translateY("+t+"px)"});return r||u.appendChild(f),n=Math.max(this.control.availableSize.width,n),t+=this.control.availableSize.height,r||i.appendChild(u),r||(i.setAttribute("width",n+""),i.setAttribute("height",t+"")),{width:n,height:t,svg:i}},t.prototype.createCanvas=function(){var n=this.control,i=n.renderingMode,t;return n.renderingMode="Canvas",n.refresh(),t=n.svgObject,n.renderingMode=i,n.refresh(),t},t.prototype.exportPdf=function(n,t,i,r,u,f){var e=new dt.PdfDocument,o=e.pageSettings.margins,h=e.pageSettings.width,c=e.pageSettings.height,s=n.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),l,a;e.pageSettings.orientation=t;l=h<i?i+o.left+o.right:h;a=c<r?r+o.top+o.bottom:c;e.pageSettings.size=new dt.SizeF(l,a);s=s.slice(s.indexOf(",")+1);e.pages.add().graphics.drawImage(new dt.PdfBitmap(s),0,0,i,r);u&&(e.save(f+".pdf"),e.destroy())},t.prototype.doExport=function(n,t,i){var r,u=n||"JPG";r=[t];this.exportImage(r,i,u,t)},t.prototype.exportImage=function(t,i,r){for(var f,c,e=[],l=t instanceof HTMLElement?0:t.length,o=0;o<l;o++){for(var a=t[o].replace(/^data:[a-z]*;,/,"").split(","),s=atob(a[1]),h=new ArrayBuffer(s.length),v=new Uint8Array(h),u=0;u<s.length;u++)v[u]=s.charCodeAt(u);e.push(h)}for(f=0;f<e.length;f++)c=new Blob([e[f]],{type:"application/octet-stream"}),"msie"===n.Browser.info.name&&window.navigator.msSaveOrOpenBlob(c,i+"."+r.toLocaleLowerCase())},t.prototype.print=function(){if(this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight),"SVG"===this.control.renderingMode)n.print(this.getHTMLContent(),this.printWindow);else{var i=this.control.svgObject,r=i.toDataURL(),t=new Image,u=i.getContext("2d");t.onload=function(){u.drawImage(t,0,0)};t.src=r;n.print(t,this.printWindow)}},t.prototype.getHTMLContent=function(){var t=n.createElement("div");return t.appendChild(this.control.element.cloneNode(!0)),t},t}(),yu=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},wi=function(t){function i(){var n=null!==t&&t.apply(this,arguments)||this;return n.enableCanvasRendering=!1,n.isColorRange=!1,n.isCellTapHold=!1,n.selectedCellCount=0,n.toggleValue=[],n.legendOnLoad=!0,n.resizing=!1,n.rendering=!0,n.multiSelection=!1,n.rectSelected=!1,n.previousSelectedCellsRect=[],n.multiCellCollection=[],n.selectedMultiCellCollection=[],n.tempMultiCellCollection=[],n.tooltipCollection=[],n.isCellData=!1,n}return yu(i,t),i.prototype.preRender=function(){this.initPrivateVariable();this.unWireEvents();this.wireEvents()},i.prototype.export=function(n,t,i){new pi(this).export(n,t,i)},i.prototype.initPrivateVariable=function(){this.renderer=new tt.SvgRenderer(this.element.id);this.canvasRenderer=new tt.CanvasRenderer(this.element.id);this.secondaryCanvasRenderer=new tt.CanvasRenderer(this.element.id+"_secondary");this.heatMapAxis=new nu(this);this.heatMapSeries=new ru(this);this.drawSvgCanvas=new ot(this);this.twoDimensional=new ou(this);this.cellColor=new si(this);this.tempRectHoverClass="";this.tempTooltipRectId="";this.setCulture()},i.prototype.setCulture=function(){this.intl=new n.Internationalization},i.prototype.render=function(){if(this.horizontalGradient="Bottom"===this.legendSettings.position||"Top"===this.legendSettings.position,this.updateBubbleHelperProperty(),this.trigger("load",{heatmap:this}),"TailwindDark"===this.theme||"Tailwind"===this.theme){var n={title:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}},textStyle:{size:"12px",fontFamily:"Inter"}};this.setProperties({titleSettings:{textStyle:{size:"14px",fontFamily:"Inter"}}},!0);this.setProperties({legendSettings:n},!0);this.setProperties({xAxis:n},!0);this.setProperties({yAxis:n},!0);this.setProperties({cellSettings:{textStyle:{fontFamily:"Inter"}}},!0)}"Bootstrap5"!==this.theme&&"Bootstrap5Dark"!==this.theme||(n={title:{textStyle:{size:"12px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500"}},textStyle:{size:"12px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},this.setProperties({titleSettings:{textStyle:{size:"16px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}}},!0),this.setProperties({legendSettings:n},!0),this.setProperties({xAxis:n},!0),this.setProperties({yAxis:n},!0),this.setProperties({cellSettings:{textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}}},!0));this.initAxis();this.processInitData();this.setTheme();this.calculateMaxLength();this.heatMapAxis.calculateVisibleLabels();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.createSvg();this.cellColor.getColorCollection();this.calculateBounds();this.renderElements();this.appendSvgObject();this.tooltipModule&&this.tooltipModule.showHideTooltip(!1);this.renderComplete()},i.prototype.reRenderDatasource=function(){this.dataSourceMinValue=null;this.dataSourceMaxValue=null;this.processInitData();this.calculateMaxLength();this.heatMapAxis.calculateVisibleLabels();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.cellColor.getColorCollection();this.calculateBounds()},i.prototype.processInitData=function(){this.adaptorModule?this.adaptorModule.constructDatasource(this.dataSource,this.dataSourceSettings):this.completeAdaptDataSource=this.dataSource},i.prototype.setRenderMode=function(){this.enableCanvasRendering="Canvas"===this.renderingMode||"Auto"===this.renderingMode&&this.axisCollections[0].axisLabelSize*this.axisCollections[1].axisLabelSize>=1e4?!0:!1},i.prototype.updateBubbleHelperProperty=function(){"Bubble"!==this.cellSettings.tileType||"Size"!==this.cellSettings.bubbleType&&"Sector"!==this.cellSettings.bubbleType?this.legendModule&&this.legendSettings.visible&&(this.legendVisibilityByCellType=!0):this.legendVisibilityByCellType=!1;this.bubbleSizeWithColor="Bubble"===this.cellSettings.tileType&&"SizeAndColor"===this.cellSettings.bubbleType?!0:!1},i.prototype.renderElements=function(){this.tooltipCollection=[];this.renderSecondaryElement();this.renderBorder();this.renderTitle();this.heatMapAxis.renderAxes();this.tooltipModule&&this.showTooltip&&(this.tooltipModule.tooltipObject=null,this.tooltipModule.createTooltipDiv(this));this.heatMapSeries.renderRectSeries();this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&(this.legendModule.renderLegendItems(),"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltipDiv())},i.prototype.getModuleName=function(){return"heatmap"},i.prototype.getPersistData=function(){return""},i.prototype.onPropertyChanged=function(n,t){for(var u=!1,i=!1,r=!0,f=0,e=Object.keys(n);f<e.length;f++)switch(e[f]){case"renderingMode":this.rendering=!1;r=!1;u=!0;break;case"cellSettings":this.updateBubbleHelperProperty();!this.legendModule||n.cellSettings.tileType===(void 0!==t.cellSettings&&t.cellSettings.tileType)&&n.cellSettings.bubbleType===t.cellSettings.bubbleType||(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections());"Bubble"===this.cellSettings.tileType&&(r=!1);this.reRenderDatasource();i=!0;break;case"showTooltip":case"titleSettings":case"width":case"height":case"margin":i=!0;break;case"dataSource":case"dataSourceSettings":this.isCellData=!1;this.paletteCellSelectionUpdation();this.reRenderDatasource();r=!1;u=!0;break;case"legendSettings":this.updateBubbleHelperProperty();!this.legendVisibilityByCellType||n.legendSettings.visible===(void 0!==t.legendSettings&&t.legendSettings.visible)&&n.legendSettings.enableSmartLegend===t.legendSettings.enableSmartLegend?this.legendOnLoad=!1:(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections());i=!0;break;case"yAxis":case"xAxis":this.paletteCellSelectionUpdation();this.reRenderDatasource();r=!1;i=!0;break;case"paletteSettings":this.paletteCellSelectionUpdation();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.cellColor.getColorCollection();this.calculateBounds();u=!0;break;case"theme":this.setTheme();u=!0;break;case"tooltipSettings":this.tooltipModule&&(this.tooltipModule.tooltipObject.fill=this.tooltipSettings.fill,this.tooltipModule.tooltipObject.border=this.tooltipSettings.border,this.tooltipModule.tooltipObject.textStyle=this.tooltipSettings.textStyle,this.tooltipModule.tooltipObject.template=this.tooltipSettings.template,this.tooltipModule.tooltipObject.refresh())}!i&&u?(this.createSvg(),this.renderElements(),this.appendSvgObject(),this.trigger("created"),r||this.clearSelection()):i&&(this.createSvg(),this.refreshBound(),this.appendSvgObject(),this.trigger("created"));this.allowSelection&&this.rectSelected&&(r?this.updateCellSelection():this.clearSelection());this.rendering=!0},i.prototype.paletteCellSelectionUpdation=function(){this.updateBubbleHelperProperty();this.legendVisibilityByCellType&&(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections())},i.prototype.createSvg=function(){this.removeSvg();this.setRenderMode();this.calculateSize();this.enableCanvasRendering?(this.svgObject=this.canvasRenderer.createCanvas({id:this.element.id+"_canvas",width:this.availableSize.width,height:this.availableSize.height}),this.allowSelection&&this.createMultiCellDiv(!0)):(this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height}),"0"===this.cellSettings.border.width.toString()&&"Rect"===this.cellSettings.tileType&&this.svgObject.setAttribute("shape-rendering","crispEdges"))},i.prototype.removeSvg=function(){if(document.getElementById(this.element.id+"_Secondary_Element")&&n.remove(document.getElementById(this.element.id+"_Secondary_Element")),document.getElementById(this.element.id+"Celltooltipcontainer")&&n.remove(document.getElementById(this.element.id+"Celltooltipcontainer")),document.getElementById(this.element.id+"legendLabelTooltipContainer")&&n.remove(document.getElementById(this.element.id+"legendLabelTooltipContainer")),document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")&&n.remove(document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")),document.getElementById(this.element.id+"_CellSelection_Container")&&n.remove(document.getElementById(this.element.id+"_CellSelection_Container")),this.svgObject&&document.getElementById(this.svgObject.id)){for(;this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);n.remove(this.svgObject)}},i.prototype.renderSecondaryElement=function(){var n=this.createElement("div"),t;n.id=this.element.id+"_Secondary_Element";this.element.appendChild(n);t=this.createElement("div",{id:this.element.id+"_CellSelection_Container",styles:"position:absolute; z-index: 2 ; top:"+this.initialClipRect.y+"px; left:"+this.initialClipRect.x+"px"});this.element.appendChild(t)},i.prototype.requiredModules=function(){var n=[];return this.showTooltip&&n.push({member:"Tooltip",args:[this]}),this.legendSettings&&n.push({member:"Legend",args:[this]}),this.dataSource&&n.push({member:"Adaptor",args:[this]}),n},i.prototype.destroy=function(){this.unWireEvents();t.prototype.destroy.call(this);this.element.innerHTML="";this.element.classList.remove("e-heatmap")},i.prototype.refresh=function(){t.prototype.refresh.call(this);this.element.classList.add("e-heatmap")},i.prototype.appendSvgObject=function(){this.enableCanvasRendering&&this.allowSelection?this.createMultiCellDiv(!1):this.element.appendChild(this.svgObject)},i.prototype.renderBorder=function(){this.border={width:0};var n=new w(this.element.id+"_HeatmapBorder",this.themeStyle.background,this.border,1,new u(0,0,this.availableSize.width-0,this.availableSize.height-0));this.drawSvgCanvas.drawRectangle(n,this.svgObject)},i.prototype.calculateSize=function(){var i=p(this.width,this.element.offsetWidth)||this.element.offsetWidth||600,r=p(this.height,this.element.offsetHeight)||this.element.offsetHeight||450,n,t;for(this.availableSize=new o(i,r),n=this.element;n.parentNode&&"BODY"!==n.tagName;){if("center"===n.align){t=this.availableSize.width.toString();this.element.style.width=t+"px";this.element.style.margin="0 auto";break}n=n.parentElement}},i.prototype.renderTitle=function(){var n,i,t;this.titleSettings.text&&(n=this.titleSettings.textStyle,i="Near"===n.textAlignment?"start":"Far"===n.textAlignment?"end":"middle",this.elementSize=r(this.titleCollection[0],n),t=new s(this.element.id+"_HeatmapTitle",new h(ci(this.availableSize.width-this.margin.left-this.margin.right,this.margin.left,this.margin.right,n),this.margin.top+3*this.elementSize.height/4,i,this.titleCollection),n,n.color||this.themeStyle.heatMapTitle),this.titleCollection.length>1?this.drawSvgCanvas.createWrapText(t,n,this.svgObject):(this.drawSvgCanvas.createText(t,this.svgObject,this.titleCollection[0]),-1!==this.titleCollection[0].indexOf("...")&&this.enableCanvasRendering&&this.tooltipCollection.push(new b(this.titleSettings.text,new u(this.margin.left,this.margin.top,this.elementSize.width,this.elementSize.height)))))},i.prototype.titleTooltip=function(n,t,i,r){n.target.id===this.element.id+"_HeatmapTitle"&&n.target.textContent.indexOf("...")>-1?ht(this.titleSettings.text,t,i,this.element.offsetWidth,this.element.id+"_Title_Tooltip",ut(this.element.id+"_Secondary_Element"),r,this):c(this.element.id+"_Title_Tooltip")},i.prototype.axisTooltip=function(n,t,i){var r=n.target.id,u;-1!==r.indexOf(this.element.id+"_XAxis_Label")||-1!==r.indexOf(this.element.id+"_YAxis_Label")||-1!==r.indexOf(this.element.id+"_XAxis_MultiLevel")||-1!==r.indexOf(this.element.id+"_YAxis_MultiLevel")?(u=bt(this.tooltipCollection,t,i),u?ht(u,t,i,this.element.offsetWidth,this.element.id+"_axis_Tooltip",ut(this.element.id+"_Secondary_Element"),this.isTouch,this):c(this.element.id+"_axis_Tooltip")):c(this.element.id+"_axis_Tooltip")},i.prototype.isHeatmapRect=function(n,t){var r,u=[],i=[];if(u.push(this.heatMapSeries.rectPositionCollection[0][0]),i.push(this.heatMapSeries.rectPositionCollection[this.yLength-1][this.xLength-1]),this.cellSettings.border.width>5&&n>=u[0].x&&t>=u[0].y&&n<=i[0].x+i[0].width&&t<=i[0].y+i[0].height&&"Rect"===this.cellSettings.tileType){var f=this.heatMapSeries.getCurrentRect(n,t),o=i[0].height,s=i[0].width,e=this.cellSettings.border.width/2;n>=f.x+e&&t>=f.y+e&&n<=f.x+(s-e)&&t<=f.y+(o-e)?(r=!0,this.isRectBoundary=!0):(r=!1,this.isRectBoundary=!1)}else r=n>=u[0].x&&t>=u[0].y&&n<=i[0].x+i[0].width&&t<=i[0].y+i[0].height,this.isRectBoundary=r;return r},i.prototype.setTheme=function(){this.themeStyle=function(n){var t;switch(n.toLowerCase()){case"highcontrastlight":case"highcontrast":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#ffffff",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"materialdark":case"fabricdark":case"bootstrapdark":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#DADADA",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"bootstrap4":t={heatMapTitle:"#212529",axisTitle:"#212529",axisLabel:"#212529",cellBorder:"#E9ECEF",background:"#FFFFFF",cellTextColor:"#212529",toggledColor:"#ffffff",emptyCellColor:"#E9ECEF",legendLabel:"#212529",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"tailwind":t={heatMapTitle:"#374151",axisTitle:"#374151",axisLabel:"#6B7280",cellBorder:"#E5E7EB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#374151",palette:[{color:"#5A61F6"},{color:"#65A30D"},{color:"#14B8A6"}]};break;case"tailwinddark":t={heatMapTitle:"#D1D5DB",axisTitle:"#D1D5DB",axisLabel:"#9CA3AF",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#374151",legendLabel:"#D1D5DB",palette:[{color:"#8B5CF6"},{color:"#22D3EE"},{color:"#F87171"}]};break;case"bootstrap5":t={heatMapTitle:"#343A40",axisTitle:"#343A40",axisLabel:"#495057",cellBorder:"#D1D5DB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#343A40",palette:[{color:"#668E1F"},{color:"#262E0B"},{color:"#AF6E10"}]};break;case"bootstrap5dark":t={heatMapTitle:"#E9ECEF",axisTitle:"#E9ECEF",axisLabel:"#CED4DA",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#343A40",legendLabel:"#E9ECEF",palette:[{color:"#A860F1"},{color:"#5ECB9B"},{color:"#557EF7"}]};break;default:t={heatMapTitle:"#424242",axisTitle:"#424242",axisLabel:"#686868",cellBorder:"#EEEEEE",cellTextColor:"#000000",toggledColor:"#ffffff",background:"#FFFFFF",emptyCellColor:"#EEEEEE",legendLabel:"#353535",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]}}return t}(this.theme)},i.prototype.calculateBounds=function(){var n=this.margin,i=0,c=this.legendModule&&"Top"===this.legendSettings.position&&this.legendVisibilityByCellType||"0px"===this.titleSettings.textStyle.size?0:16,e=n.left,o=this.availableSize.width-e-n.right,t,f,s,h;if(("Column"===this.paletteSettings.colorGradientMode||"Row"===this.paletteSettings.colorGradientMode)&&"Gradient"===this.paletteSettings.type)if(0===this.paletteSettings.palette.length)this.legendVisibilityByCellType=!1;else for(t=0;t<this.paletteSettings.palette.length;t++)if(null!==this.paletteSettings.palette[t].value)this.legendVisibilityByCellType=!0;else if(null===this.paletteSettings.palette[t].value){this.legendVisibilityByCellType=!1;break}this.titleSettings.text&&(this.titleCollection=st(this.titleSettings.text,this.titleSettings.textStyle,o),i=r(this.titleSettings.text,this.titleSettings.textStyle).height*this.titleCollection.length+c);f=n.top+i;this.titleRect=new u(n.left,n.top,this.availableSize.width-n.left-n.right,i);s=this.availableSize.height-f-n.bottom;this.initialClipRect=new u(e,f,o,s);h=this.initialClipRect.y;this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendBounds(this.initialClipRect);this.heatMapAxis.measureAxis(this.initialClipRect);this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendSize(this.initialClipRect,h);this.heatMapAxis.calculateAxisSize(this.initialClipRect)},i.prototype.refreshBound=function(){this.updateBubbleHelperProperty();this.calculateBounds();this.renderElements()},i.prototype.initAxis=function(){var t,i=[this.xAxis,this.yAxis],n,r;for(this.axisCollections=[],n=0,r=i.length;n<r;n++)(t=i[n]).orientation=0===n?"Horizontal":"Vertical",t.jsonCellLabel=[],this.axisCollections.push(t)},i.prototype.wireEvents=function(){var r=n.Browser.isPointer,i=n.Browser.touchStartEvent,u=n.Browser.touchEndEvent,f=n.Browser.touchMoveEvent,e=r?"pointerleave":"mouseleave",t;n.EventHandler.add(this.element,n.Browser.isDevice?i:"click",this.heatMapMouseClick,this);n.EventHandler.add(this.element,i,this.heatMapMouseMove,this);n.EventHandler.add(this.element,u,this.heatMapMouseLeave,this);n.EventHandler.add(this.element,f,this.heatMapMouseMove,this);n.EventHandler.add(this.element,e,this.heatMapMouseLeave,this);window.addEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize.bind(this));t=this;new n.Touch(this.element,{tapHold:function(){t.isCellTapHold=!0;t.getDataCollection();t.currentRect.allowCollection=!1;t.setCellOpacity();var n={heatmap:t,cancel:!1,name:"cellSelected",data:t.multiCellCollection};t.trigger("cellSelected",n)},tap:function(){var n=!1;t.isCellTapHold||(n=!0);t.tooltipOnMouseMove(null,t.currentRect,n)}});this.setStyle(this.element)},i.prototype.setStyle=function(n){n.style.touchAction="element";n.style.touchAction="element";n.style.zoom="none";n.style.userSelect="none";n.style.webkitUserSelect="none";n.style.position="relative";n.style.display="block"},i.prototype.print=function(){new pi(this).print()},i.prototype.unWireEvents=function(){var r=n.Browser.isPointer,t=n.Browser.touchStartEvent,i=(n.Browser.touchEndEvent,n.Browser.touchMoveEvent),u=r?"pointerleave":"mouseleave";n.EventHandler.remove(this.element,n.Browser.isDevice?t:"click",this.heatMapMouseClick);n.EventHandler.remove(this.element,t,this.heatMapMouseMove);n.EventHandler.remove(this.element,i,this.heatMapMouseLeave);n.EventHandler.remove(this.element,i,this.heatMapMouseMove);n.EventHandler.remove(this.element,u,this.heatMapMouseLeave);window.removeEventListener(n.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize)},i.prototype.heatMapResize=function(){var n=this,t;return this.resizing=!0,t={heatmap:this,cancel:!1,name:"resized",currentSize:new o(0,0),previousSize:new o(this.availableSize.width,this.availableSize.height)},this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(function(){n.isDestroyed?clearTimeout(n.resizeTimer):(n.createSvg(),t.currentSize=n.availableSize,n.trigger("resized",t),n.refreshBound(),n.appendSvgObject(),n.allowSelection&&n.updateCellSelection(),n.trigger("loaded",{heatmap:n}),n.resizing=!1)},500),!1},i.prototype.updateCellSelection=function(){var l=this.initialClipRect.width/this.axisCollections[0].axisLabelSize,a=this.initialClipRect.height/this.axisCollections[1].axisLabelSize,g=this.initialClipRect.x,nt=this.initialClipRect.y,y,p,w,b,k,d,e,h;if(this.enableCanvasRendering){if(this.enableCanvasRendering){var t=this.multiCellCollection,r=document.getElementById(this.element.id+"_canvas"),u=document.getElementById(this.element.id+"_secondary_canvas"),i=this.initialClipRect,v=i.y+i.height,o=i.x+i.width;for(n=0;n<this.multiCellCollection.length;n++)this.multiCellCollection[n].width=t[n].width=l,this.multiCellCollection[n].height=t[n].height=a,this.multiCellCollection[n].x=t[n].x=g+l*this.multiCellCollection[n].xPosition,this.multiCellCollection[n].y=t[n].y=nt+a*this.multiCellCollection[n].yPosition,y=r.getContext("2d").getImageData(t[n].x,t[n].y,t[n].width,t[n].height),u.getContext("2d").putImageData(y,t[n].x,t[n].y),r.style.opacity="0.3";p=r.getContext("2d").getImageData(0,0,this.availableSize.width,i.y);u.getContext("2d").putImageData(p,0,0);w=r.getContext("2d").getImageData(0,v,this.availableSize.width,this.availableSize.height-v);u.getContext("2d").putImageData(w,0,i.y+i.height);b=r.getContext("2d").getImageData(o,0,this.availableSize.width-o,this.availableSize.height);u.getContext("2d").putImageData(b,o,0);k=r.getContext("2d").getImageData(0,0,i.x,this.availableSize.height);u.getContext("2d").putImageData(k,0,0);c(this.element.id+"_selectedCells")}}else if(0!==this.multiCellCollection.length){for(var f=document.getElementById(this.element.id+"_Container_RectGroup"),s=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<f.childNodes.length;n++)f.childNodes[n].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&s.childNodes[n]&&s.childNodes[n].setAttribute("opacity","0.3");for(n=0;n<this.multiCellCollection.length;n++)d=this.multiCellCollection[n].cellElement.id.replace(this.element.id+"_HeatMapRect_",""),e=parseInt(d,10),(f.childNodes[e].setAttribute("opacity","1"),this.cellSettings.showLabel&&s.childNodes[n])&&(h=document.getElementById(this.element.id+"_HeatMapRectLabels_"+e),h&&h.setAttribute("opacity","1"),this.addSvgClass(f.childNodes[e]))}},i.prototype.clearSVGSelection=function(){for(var i,t=document.getElementById(this.element.id+"_Container_RectGroup"),r=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<t.childNodes.length;n++)i=t.childNodes[n].getAttribute("class"),i===this.element.id+"_selected"&&this.removeSvgClass(t.childNodes[n],i),t.childNodes[n].setAttribute("opacity","1"),this.cellSettings.showLabel&&r.childNodes[n]&&r.childNodes[n].setAttribute("opacity","1")},i.prototype.calculateMaxLength=function(){var n=this.completeAdaptDataSource,r;if(n&&n.length>0){for(var u=n.length-1,t=0,i=0;i<=u;i++)r=n[i].length,t=t>r?t:r;this.axisCollections[0].maxLength=u;this.axisCollections[1].maxLength=t-1}else this.axisCollections[0].maxLength=0,this.axisCollections[1].maxLength=0},i.prototype.setMouseXY=function(n,t){var r,i=this.element.getBoundingClientRect();r=this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").getBoundingClientRect():document.getElementById(this.element.id+"_svg").getBoundingClientRect();this.mouseX=n-i.left-Math.max(r.left-i.left,0);this.mouseY=t-i.top-Math.max(r.top-i.top,0)},i.prototype.heatMapMouseClick=function(n){var r,u,s,h=this.element.getBoundingClientRect(),o,i;if(("touchstart"===n.type?(this.isTouch=!0,u=(s=n).changedTouches[0].clientY,r=s.changedTouches[0].clientX):(this.isTouch=!1,u=n.clientY,r=n.clientX),r-=h.left,u-=h.top,this.isHeatmapRect(r,u))&&(o=this.heatMapSeries.getCurrentRect(r,u),this.trigger("cellClick",{heatmap:this,value:o.value,x:o.x,y:o.y,xLabel:this.heatMapSeries.hoverXAxisLabel,yLabel:this.heatMapSeries.hoverYAxisLabel,xValue:this.heatMapSeries.hoverXAxisValue,yValue:this.heatMapSeries.hoverYAxisValue,cellElement:this.enableCanvasRendering?null:document.getElementById(o.id),event:n})),this.notify("click",n),"Gradient"!==this.paletteSettings.type&&this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType){i=this.legendModule.navigationCollections;i.length&&r>i[0].x&&r<i[0].x+i[0].width&&u>i[0].y&&u<i[0].y+i[0].height?this.legendModule.translatePage(this,this.legendModule.currentPage,!0):i.length&&r>i[1].x&&r<i[1].x+i[1].width&&u>i[1].y&&u<i[1].y+i[1].height&&this.legendModule.translatePage(this,this.legendModule.currentPage,!1);for(var f=this.legendModule.legendRange,e=this.legendModule.legendTextRange,c=!0,t=0;t<f.length;t++)this.legendModule&&this.legendSettings.toggleVisibility&&this.legendModule.currentPage===f[t].currentPage&&(c&&r>=f[t].x&&r<=f[t].width+f[t].x&&u>=f[t].y&&u<=f[t].y+f[t].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&r>=e[t].x&&r<=e[t].width+e[t].x&&u>=e[t].y&&u<=e[t].y+e[t].height)&&(this.legendModule.legendRangeSelection(t),c=!1)}return!1},i.prototype.heatMapMouseMove=function(n){var t,i,r,u=this.element.getBoundingClientRect();return"touchmove"===n.type||"touchstart"===n.type?(this.isTouch=!0,t=(r=n).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(this.isTouch=!1,t=n.clientX,i=n.clientY),t-=u.left,i-=u.top,this.setMouseXY(t,i),this.mouseAction(n,t,i,r,u),!0},i.prototype.mouseAction=function(n,t,i){var e,r,u,f,o;return n.target&&n.target.id&&(r=this.isHeatmapRect(t,i),this.legendModule&&(r?"Gradient"===this.paletteSettings.type&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderGradientPointer(n,t,i):this.legendModule.removeGradientPointer(),this.renderMousePointer(t,i)),u=void 0,f=void 0,(u=!(!this.showTooltip||!this.tooltipModule)&&r,r&&(f=this.heatMapSeries.getCurrentRect(t,i),2!==n.which&&3!==n.which&&(u=this.cellSelectionOnMouseMove(n,f,t,i,u))),this.tooltipOnMouseMove(n,f,u,r),this.legendModule&&this.legendSettings.visible&&"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltip(t,i),this.enableCanvasRendering)?(this.element.getBoundingClientRect(),o="Fixed"!==this.paletteSettings.type||!this.legendSettings.enableSmartLegend||"None"!==this.legendSettings.labelDisplayType,(e=bt(this.tooltipCollection,t,i)||this.legendModule&&o&&(bt(this.legendModule.legendLabelTooltip,t,i)||bt(this.legendModule.legendTitleTooltip,t,i)))?ht(e,t,i,this.element.offsetWidth,this.element.id+"_canvas_Tooltip",ut(this.element.id+"_Secondary_Element"),this.isTouch,this):c(this.element.id+"_canvas_Tooltip")):(this.titleSettings.text&&"Trim"===this.titleSettings.textStyle.textOverflow&&this.titleTooltip(n,t,i,this.isTouch),this.axisTooltip(n,t,i,this.isTouch),this.legendModule&&this.legendSettings.visible&&this.legendSettings.showLabel&&this.legendVisibilityByCellType&&this.legendModule.renderLegendLabelTooltip(n,t,i),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderLegendTitleTooltip(n,t,i))),!0},i.prototype.cellSelectionOnMouseMove=function(n,t,i,r,u){return("Rect"===this.cellSettings.tileType&&"mousedown"===n.type||"touchstart"===n.type||"pointerdown"===n.type)&&this.allowSelection&&(this.previousRect=t,this.multiSelection=!0,this.rectSelected=!0,this.initialCellX=i,this.initialCellY=r,n.preventDefault()),"Rect"===this.cellSettings.tileType&&this.multiSelection&&t&&(u=!1,this.highlightSelectedCells(this.previousRect,t,i,r,n)),u},i.prototype.tooltipOnMouseMove=function(n,t,i,r){var u=this;i&&t?this.tempTooltipRectId!==t.id&&(this.showTooltip&&((this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(t.id),this.tooltipModule.renderTooltip(t),this.isTouch&&(this.tooltipTimer&&window.clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout(function(){u.tooltipModule.tooltipObject.fadeOut();u.tooltipModule.isFadeout=!0},1500),n&&"touchmove"===n.type&&n.preventDefault())),this.tempTooltipRectId=t.id):(null!==n&&(r?!this.showTooltip&&this.cellSettings.border.width>5&&this.heatMapSeries.highlightSvgRect(n.target.id):((this.cellSettings.enableCellHighlighting||this.showTooltip)&&!this.enableCanvasRendering&&this.cellSettings.border.width<5&&this.heatMapSeries.highlightSvgRect(n.target.id),this.tooltipModule&&this.showTooltip&&this.tooltipModule.showHideTooltip(!1,!0))),this.tempTooltipRectId="")},i.prototype.highlightSelectedCells=function(n,t,i,r,f){var e=n.xIndex,o=n.yIndex,s=t.xIndex,h=t.yIndex;this.currentRect=t;this.selectedCellsRect=new u(0,0,0,0);this.selectedCellsRect.x=n.x>t.x?t.x:n.x;this.selectedCellsRect.y=n.y>t.y?t.y:n.y;this.selectedCellsRect.width=(1+(n.x>t.x?e-s:s-e))*t.width;this.selectedCellsRect.height=(1+(n.y>t.y?o-h:h-o))*t.height;this.isCellTapHold="touchstart"===f.type?!0:!1;f.preventDefault();!1===f.ctrlKey&&"touchstart"!==f.type&&"touchmove"!==f.type&&this.removeSelectedCellsBorder();var c=this.initialCellX>i?i:this.initialCellX,l=this.initialCellY>r?r:this.initialCellY,a=document.getElementById(this.element.id+"_CellSelection_Container"),v=this.renderer.createSvg({id:this.element.id+"_CellSelection_Container_svg",width:this.initialClipRect.width,height:this.initialClipRect.height});a.appendChild(v);var y=document.getElementById(this.element.id+"_CellSelection_Container_svg"),p=new u(c-this.initialClipRect.x,l-this.initialClipRect.y,Math.abs(i-this.initialCellX),Math.abs(r-this.initialCellY)),b=new w(this.element.id+"_selectedCells","#87ceeb",{color:"transparent",width:1},1,p,"#0000ff");y.appendChild(this.renderer.drawRectangle(b));document.getElementById(this.element.id+"_selectedCells").style.opacity="0.5"},i.prototype.getDataCollection=function(){var n=this.previousRect.xIndex,t=this.previousRect.yIndex,i=this.currentRect.xIndex,r=this.currentRect.yIndex,f=i>n?n:i,c=i>n?i:n,l=r>t?t:r,a=r>t?r:t,e=f,o=l,s=this.previousRect.x,h=this.previousRect.y;this.getCellCollection(this.currentRect,this.previousRect,!0,e,o,c,a,f,s,h);e=f;o=l;s=this.previousRect.x;h=this.previousRect.y;this.checkSelectedCells();this.getCellCollection(this.currentRect,this.previousRect,!1,e,o,c,a,f,s,h);this.selectedMultiCellCollection=[];this.canvasSelectedCells=new u(0,0,0,0);this.selectedCellCount=0},i.prototype.getCellCollection=function(n,t,i,r,u,f,e,o,s,h){for(var l=Math.abs(n.xIndex===t.xIndex?0:n.xIndex-t.xIndex)+1,a=Math.abs(n.yIndex===t.yIndex?0:n.yIndex-t.yIndex)+1,c=0;c<l*a;c++)i?this.getSelectedCellData(s,h,!0):this.getSelectedCellData(s,h,!1),r<f?(s+=n.xIndex>t.xIndex?n.width:-n.width,r++):u<e&&(h+=n.yIndex>t.yIndex?n.height:-n.height,s=t.x,r=o)},i.prototype.removeSelectedCellsBorder=function(){var t,i,r,e;if(this.enableCanvasRendering){for(t=this.secondaryCanvasRenderer.ctx,n=0;n<this.previousSelectedCellsRect.length;n++)i=this.previousSelectedCellsRect[n],t.save(),t.clearRect(i.x-1,i.y-1,i.width+2,i.height+2),t.restore();for(n=0;n<this.multiCellCollection.length;n++)r=this.multiCellCollection[n],this.multiCellCollection.length>0&&(t.save(),t.clearRect(r.x-1,r.y-1,r.width+2,r.height+2))}else for(var u=document.getElementById(this.element.id+"_Container_RectGroup"),f=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<u.childNodes.length;n++)e=u.childNodes[n].getAttribute("class"),u.childNodes[n].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&f.childNodes[n]&&(f.childNodes[n].setAttribute("opacity","0.3"),this.removeSvgClass(u.childNodes[n],e));this.multiCellCollection=[]},i.prototype.highlightSelectedAreaInCanvas=function(n){var u,f,e,o;if(n.x){var i=document.getElementById(this.element.id+"_canvas"),r=document.getElementById(this.element.id+"_secondary_canvas"),t=this.initialClipRect,s=i.getContext("2d").getImageData(n.x,n.y,n.width,n.height);r.getContext("2d").putImageData(s,n.x,n.y);i.style.opacity="0.3";u=i.getContext("2d").getImageData(0,0,this.availableSize.width,t.y);r.getContext("2d").putImageData(u,0,0);f=i.getContext("2d").getImageData(0,t.y+t.height,this.availableSize.width,this.availableSize.height-(t.y+t.height));r.getContext("2d").putImageData(f,0,t.y+t.height);e=i.getContext("2d").getImageData(t.x+t.width,0,this.availableSize.width-(t.x+t.width),this.availableSize.height);r.getContext("2d").putImageData(e,t.x+t.width,0);o=i.getContext("2d").getImageData(0,0,t.x,this.availableSize.height);r.getContext("2d").putImageData(o,0,0)}},i.prototype.getSelectedCellData=function(t,i,r){var v=this.axisCollections[0],y=this.axisCollections[1],k=v.tooltipLabels,d=y.tooltipLabels.slice().reverse(),e=this.heatMapSeries.getCurrentRect(t+1,i+1),p=document.getElementById(e.id),f=new ar(null,"","",0,0,null,0,0,0,0,0,0),o,c,h,l,s,w,b,a;if(f.value=e.value,f.xLabel=k[e.xIndex].toString(),f.yLabel=d[e.yIndex].toString(),f.xValue=v.labelValue[e.xIndex],f.yValue=y.labelValue.slice().reverse()[e.yIndex],f.cellElement=this.enableCanvasRendering?null:p,f.xPosition=e.xIndex,f.yPosition=e.yIndex,f.width=this.currentRect.width,f.height=this.currentRect.height,f.x=this.currentRect.x,f.y=this.currentRect.y,this.currentRect.allowCollection=!0,this.addSvgClass(p),r)this.selectedMultiCellCollection.push(f),this.currentRect.allowCollection=!1;else for(o=0;o<this.multiCellCollection.length;o++)if(this.multiCellCollection[o].xPosition===f.xPosition&&this.multiCellCollection[o].yPosition===f.yPosition&&(this.currentRect.allowCollection=!1,this.selectedCellCount===this.selectedMultiCellCollection.length)){if(this.currentRect.allowCollection=!1,this.enableCanvasRendering)c=this.secondaryCanvasRenderer.ctx,h=this.canvasSelectedCells,c.save(),c.clearRect(h.x-1,h.y-1,h.width+2,h.height+2),c.restore(),this.selectedCellsRect=new u(0,0,0,0);else for(l=0;l<this.selectedMultiCellCollection.length;l++)s=this.selectedMultiCellCollection[l].cellElement,s&&(w=s.id.replace(this.element.id+"_HeatMapRect_",""),b=(document.getElementById(this.element.id+"_Container_TextGroup"),s.getAttribute("class")),s.setAttribute("opacity","0.3"),a=document.getElementById(this.element.id+"_HeatMapRectLabels_"+w),a&&a.setAttribute("opacity","0.3"),this.removeSvgClass(s,b));this.multiCellCollection.splice(o,1)}e.visible&&!n.isNullOrUndefined(e.value)&&!0===this.currentRect.allowCollection&&this.multiCellCollection.push(f)},i.prototype.addSvgClass=function(n){if(!this.enableCanvasRendering){var t=this.element.id+"_selected";n.setAttribute("class",t)}},i.prototype.removeSvgClass=function(n,t){t&&n.setAttribute("class",t.replace(t,""))},i.prototype.clearSelection=function(){var t,n,i;if(!this.enableCanvasRendering&&this.allowSelection&&this.clearSVGSelection(),this.enableCanvasRendering){for(t=this.secondaryCanvasRenderer.ctx,n=0;n<this.previousSelectedCellsRect.length;n++)t.save(),t.clearRect(this.previousSelectedCellsRect[n].x-1,this.previousSelectedCellsRect[n].y-1,this.previousSelectedCellsRect[n].width+2,this.previousSelectedCellsRect[n].height+2),t.restore();for(n=0;n<this.multiCellCollection.length;n++)i=this.multiCellCollection[n],this.multiCellCollection.length>0&&(t.save(),t.clearRect(i.x-1,i.y-1,i.width+2,i.height+2));document.getElementById(this.element.id+"_canvas").style.opacity="1"}this.tempMultiCellCollection=[];this.multiCellCollection=[];this.rectSelected=!1},i.prototype.renderMousePointer=function(n,t){for(var r=this.legendModule.legendRange,u=this.legendModule.legendTextRange,f=!0,i=0;i<r.length;i++)this.legendSettings.toggleVisibility&&this.legendModule.currentPage===r[i].currentPage&&(f&&n>=r[i].x&&n<=r[i].width+r[i].x&&t>=r[i].y&&t<=r[i].y+r[i].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&n>=u[i].x&&n<=u[i].width+u[i].x&&t>=u[i].y&&t<=u[i].y+u[i].height?(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="Pointer":document.getElementById(this.element.id+"_svg").style.cursor="Pointer",f=!1):f&&(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="":document.getElementById(this.element.id+"_svg").style.cursor=""))},i.prototype.heatMapMouseLeave=function(n){var u=this,r,t,i;return(n.target&&n.target.id&&(this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(this.tempTooltipRectId),this.allowSelection&&this.multiSelection)&&((this.multiSelection=!1,"mouseup"===n.type||"touchend"===n.type||"pointerup"===n.type)?2!==n.which&&3!==n.which&&(!1===this.isCellTapHold?(this.getDataCollection(),this.currentRect.allowCollection=!1,this.setCellOpacity(),r={heatmap:this,cancel:!1,name:"cellSelected",data:this.multiCellCollection},this.trigger("cellSelected",r)):this.isCellTapHold=!1):"mouseleave"===n.type&&(this.element.id,1)&&c(this.element.id+"_selectedCells")),(this.tooltipModule&&this.showTooltip&&"mouseleave"===n.type&&this.tooltipModule.showHideTooltip(!1),this.tempTooltipRectId="",this.legendModule&&this.legendSettings.visible&&this.legendModule.tooltipObject&&this.legendModule.tooltipObject.element)&&(t=this.legendModule.tooltipObject.element.firstChild,"mouseleave"===n.type?t.setAttribute("opacity","0"):(this.legendTooltipTimer&&window.clearTimeout(this.legendTooltipTimer),this.legendTooltipTimer=setTimeout(function(){t.setAttribute("opacity","0")},1500))),("Gradient"===this.paletteSettings.type&&this.legendModule&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&("mouseleave"===n.type?this.legendModule.removeGradientPointer():(this.gradientTimer&&window.clearTimeout(this.gradientTimer),this.gradientTimer=setTimeout(function(){u.legendModule.removeGradientPointer()},1500))),this.enableCanvasRendering)&&(i=document.getElementById(this.element.id+"_hoverRect_canvas"),i&&(i.style.visibility="hidden",this.tempRectHoverClass="")),this.titleSettings.text&&-1!==this.titleCollection[0].indexOf("...")&&(this.enableCanvasRendering?c(this.element.id+"_canvas_Tooltip"):c(this.element.id+"_Title_Tooltip")),!0},i.prototype.checkSelectedCells=function(){var n,t;if(this.enableCanvasRendering){for(this.canvasSelectedCells=new u(0,0,0,0),this.canvasSelectedCells.x=this.selectedCellsRect.x,this.canvasSelectedCells.y=this.selectedCellsRect.y,this.canvasSelectedCells.width=this.selectedCellsRect.width,this.canvasSelectedCells.height=this.selectedCellsRect.height,n=0;n<this.multiCellCollection.length;n++)for(t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].xPosition===this.multiCellCollection[n].xPosition&&this.selectedMultiCellCollection[t].yPosition===this.multiCellCollection[n].yPosition&&this.selectedCellCount++;this.rectSelected&&"Gradient"===this.paletteSettings.type&&this.legendModule.removeGradientPointer()}else for(n=0;n<this.multiCellCollection.length;n++)for(t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].cellElement.getAttribute("id")===this.multiCellCollection[n].cellElement.getAttribute("id")&&this.selectedCellCount++},i.prototype.removeOpacity=function(n,t){for(var i=0;i<n.childNodes.length;i++)n.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","0.3")},i.prototype.setCellOpacity=function(){var t,u,n,f,i,r;if(this.enableCanvasRendering)this.previousSelectedCellsRect.push(this.selectedCellsRect),this.highlightSelectedAreaInCanvas(this.selectedCellsRect);else if(0!==this.multiCellCollection.length)for(this.tempMultiCellCollection.push(this.multiCellCollection),t=document.getElementById(this.element.id+"_Container_RectGroup"),u=document.getElementById(this.element.id+"_Container_TextGroup"),this.removeOpacity(t,u),n=0;n<this.multiCellCollection.length;n++)f=this.multiCellCollection[n].cellElement,i=parseInt(f.id.replace(this.element.id+"_HeatMapRect_",""),10),(t.childNodes[i].setAttribute("opacity","1"),this.cellSettings.showLabel)&&(r=document.getElementById(this.element.id+"_HeatMapRectLabels_"+i),r&&r.setAttribute("opacity","1"));c(this.element.id+"_selectedCells")},i.prototype.createMultiCellDiv=function(n){var t,i,r;n?(t=this.createElement("div",{id:this.element.id+"_Multi_CellSelection_Canvas",styles:"position:relative"}),this.element.appendChild(t),t.appendChild(this.svgObject),this.svgObject.style.position="absolute",this.svgObject.style.left="0px",this.svgObject.style.top="0px",this.svgObject.style.zIndex="0"):(i=document.getElementById(this.element.id+"_Multi_CellSelection_Canvas"),r=this.secondaryCanvasRenderer.createCanvas({width:this.availableSize.width,height:this.availableSize.height,x:0,y:0,style:"position: absolute; z-index: 1"}),i.appendChild(r))},f([n.Property(null)],i.prototype,"width",void 0),f([n.Property(null)],i.prototype,"height",void 0),f([n.Property(!0)],i.prototype,"showTooltip",void 0),f([n.Event()],i.prototype,"tooltipRender",void 0),f([n.Event()],i.prototype,"resized",void 0),f([n.Event()],i.prototype,"loaded",void 0),f([n.Event()],i.prototype,"cellRender",void 0),f([n.Event()],i.prototype,"cellSelected",void 0),f([n.Property("SVG")],i.prototype,"renderingMode",void 0),f([n.Property(null)],i.prototype,"dataSource",void 0),f([n.Complex({},au)],i.prototype,"dataSourceSettings",void 0),f([n.Property("Material")],i.prototype,"theme",void 0),f([n.Property(!1)],i.prototype,"allowSelection",void 0),f([n.Complex({},ki)],i.prototype,"margin",void 0),f([n.Complex({text:"",textStyle:k.heatMapTitleFont},ti)],i.prototype,"titleSettings",void 0),f([n.Complex({},vi)],i.prototype,"xAxis",void 0),f([n.Complex({position:"Right"},hu)],i.prototype,"legendSettings",void 0),f([n.Complex({},cr)],i.prototype,"paletteSettings",void 0),f([n.Complex({},fu)],i.prototype,"tooltipSettings",void 0),f([n.Complex({},vi)],i.prototype,"yAxis",void 0),f([n.Complex({},iu)],i.prototype,"cellSettings",void 0),f([n.Event()],i.prototype,"created",void 0),f([n.Event()],i.prototype,"load",void 0),f([n.Event()],i.prototype,"cellClick",void 0),f([n.Event()],i.prototype,"legendRender",void 0),f([n.NotifyPropertyChanges],i)}(n.Component);wi.Inject(eu,cu,vu);gt={};gt.HeatMap=wi;bi={heatmap:gt=ni.J(window.ejdashboard?window.ejdashboard.heatmap:{},gt)};window.ejdashboard=ni.J(window.ejdashboard||{},bi)})()})();
