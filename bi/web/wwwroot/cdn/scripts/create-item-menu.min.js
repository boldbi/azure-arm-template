var createItemMenuContainer="",createMenu="",createMenuBackdrop="";function setCreateMenuBackDrop(){createMenuBackdrop.css("width",$(window).width()-createMenu.width()+"px")}function collapseCreateMenu(){createItemMenuContainer.toggleClass("create-menu-effect").toggleClass("create-menu-open"),createMenuBackdrop.hide(),unblurServerAppContainer()}function showLoaderForIntializing(){$("#server-app-container").hide(),$(".preloader-wrap").show(),$("#loader_text").text(window.Server.App.Localization.CreatingDashboard)}$(document).ready(function(){$.extend(ej,Syncfusion),createItemButton=$("[data-action=create-items]"),createItemMenuContainer=$("#create-item-container"),createMenu=$(".create-menu"),createMenuBackdrop=$("#create-menu-backdrop"),uploadItemButton=$("[data-action=upload-items]"),createItemButton.on("click",function(e){createItemMenuContainer.show(),createItemMenuContainer.toggleClass("create-menu-effect").toggleClass("create-menu-open"),setCreateMenuBackDrop(),createMenuBackdrop.show(),blurServerAppContainer()}),uploadItemButton.on("click",function(e){var a=angular.element("[ng-controller=DashboardCtrl]").scope();isSelfHosted&&$("#dashboard-page-container").is(":visible")&&null!=a&&0!=a.categoryList.length?$.ajax({type:"POST",url:resourceLimitationCountUrl,data:{itemType:ItemType.Dashboard},success:function(e){e?warningToast(window.Server.App.Localization.ResourceLimitExceed.format(window.Server.App.Localization.DashboardLimited,window.Server.App.Localization.DashboardLimited)):onUploadDialogOpen()}}):isSelfHosted||isAdmin||!isDashboardCreateDenied?checkCategoriesExist():$.ajax({type:"POST",url:validateDashboardCountUrl,data:"",success:function(e){e?warningToast(window.Server.App.Localization.IsDashboardLimitExceeds.format(dashboardCreateLimitCount,window.Server.App.Localization.UploadingDashboard)):onUploadDialogOpen()}})}),$("body").click(function(e){"create-menu-backdrop"==e.target.id&&collapseCreateMenu()}),$(window).resize(function(){setCreateMenuBackDrop()})}),$(document).on("click",".create-item-list-section",function(e){collapseCreateMenu()});var saveDraftInputobj="",saveDraftInputEle="",draftDialogobj="";function saveDraftBtnClick(){isSelfHosted||isAdmin||!isDashboardCreateDenied?$.ajax({type:"POST",url:resourceLimitationCountUrl,data:{itemType:ItemType.Dashboard},success:function(e){e?(dlgCloseBtnClick(),warningToast(window.Server.App.Localization.ResourceLimitExceed.format(window.Server.App.Localization.DashboardLimited,window.Server.App.Localization.DashboardLimited))):$("#save-draft-form").submit()}}):$.ajax({type:"POST",url:validateDashboardCountUrl,data:"",success:function(e){e?(dlgCloseBtnClick(),warningToast(window.Server.App.Localization.IsDashboardLimitExceeds.format(dashboardCreateLimitCount,window.Server.App.Localization.CreatingDraftDashboard))):$("#save-draft-form").submit()}})}function dlgCloseBtnClick(){draftDialogobj.hide()}function saveDraftDialogOpen(){saveDraftInputobj.value="",blurServerAppContainer()}function saveDraftDialogBeforeClose(){clearInputValueAndError(),unblurServerAppContainer()}function clearInputValueAndError(){saveDraftInputobj.value="",saveDraftInputobj.refresh(),$(".save-draft-input-segment").find("div").html(""),$(".save-draft-input-segment").find("#validate-dashboard-name").text("")}function showSpinner(){ejs.popups.showSpinner(document.getElementById("save-draft-container"))}function hideSpinner(){ejs.popups.hideSpinner(document.getElementById("save-draft-container"))}$(document).ready(function(){$.extend(ej,Syncfusion),saveDraftInputobj=new ejs.inputs.TextBox({placeholder:window.Server.App.Localization.DraftPlaceholder,floatLabelType:"Never"}),saveDraftInputEle=$("#save-draft-input"),saveDraftInputobj.appendTo("#save-draft-input"),isMobile||((draftDialogobj=new ejs.popups.Dialog({showCloseIcon:!1,isModal:!0,closeOnEscape:!0,visible:!1,buttons:[{click:saveDraftBtnClick,buttonModel:{content:window.Server.App.Localization.AddDesignButton,isPrimary:!0,cssClass:"app-btn-primary"}},{click:dlgCloseBtnClick,buttonModel:{content:window.Server.App.Localization.CancelButton,isPrimary:!1,cssClass:"app-btn-secondary"}}],width:"500px",animationSettings:{effect:"Zoom"},beforeOpen:saveDraftDialogOpen,beforeClose:saveDraftDialogBeforeClose})).appendTo("#save-draft-container"),draftDialogobj.hide(),ejs.popups.createSpinner({target:document.getElementById("save-draft-container")}),ejs.popups.setSpinner({type:"Material"})),$("#save-draft-form").submit(function(e){e.preventDefault();e=saveDraftInputEle.val();$("#save-draft-form").valid()&&(showSpinner(),$.ajax({type:"POST",url:isDraftExistUrl,data:{dashboardName:e},success:function(e){e.Data?($(".save-draft-input-segment").find(".e-input-group").addClass("e-error"),$("#validate-dashboard-name").text(window.Server.App.Localization.IsDashboardExist),$("#validate-dashboard-name").css("display","block"),hideSpinner()):(hideSpinner(),draftDialogobj.hide(),setTimeout(function(){showLoaderForIntializing(),window.location.href=e.RedirectUrl},500))},error:function(){$(".save-draft-input-segment").find(".e-input-group").addClass("e-error"),$("#validate-dashboard-name").text(window.Server.App.Localization.InternalServerError),$("#validate-dashboard-name").css("display","block"),hideSpinner()}}))}),$.validator.addMethod("isRequired",function(e,a){return!isEmptyOrWhitespace(e)},window.Server.App.Localization.ItemNameValidator),$.validator.addMethod("isValidName",function(e,a){return IsValidName("name",e)},window.Server.App.Localization.AvoidSpecialCharacters),$.validator.addMethod("isLengthExceeded",function(e,a){return e.length<=$("#save-draft-input").attr("data-maxlength")},window.Server.App.Localization.CharacterExceedMessage.format($("#save-draft-input").attr("data-maxlength"))),$("#save-draft-form").validate({errorElement:"div",onkeyup:function(e,a){9!=a.keyCode&&$(e).valid(),8!=a.keyCode&&46!=a.keyCode&&$(e).valid()||$("#validate-dashboard-name").text("")},onfocusout:function(e){$(e).valid()},rules:{dashboardName:{isRequired:!0,isValidName:!0,isLengthExceeded:!0}},messages:{dashboardName:{isRequired:window.Server.App.Localization.DashboardNameValidator}},highlight:function(e){$(e).closest(".e-input-group").addClass("e-error")},unhighlight:function(e){"save-draft-input"==$(e).attr("id")&&($(e).closest(".e-input-group").removeClass("e-error"),$(e).closest(".save-draft-input-segment").find("div").html(""),$(e).closest(".save-draft-input-segment").find("#validate-dashboard-name").text(""))},errorPlacement:function(e,a){$(a).closest(".save-draft-input-segment").find("div").html(e.html())}}),saveDraftInputEle.bind("keypress",function(e){if(13==e.keyCode)return e.preventDefault(),!1})}),$(document).on("click",".create-dashboard-scratch",function(e){$.ajax({type:"POST",url:resourceLimitationCountUrl,data:{itemType:ItemType.Dashboard},success:function(e){e?warningToast(window.Server.App.Localization.ResourceLimitExceed.format(window.Server.App.Localization.DashboardLimited,window.Server.App.Localization.DashboardLimited)):draftDialogobj.show()}})});