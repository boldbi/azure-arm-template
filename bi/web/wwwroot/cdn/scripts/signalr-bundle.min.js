var SJ=SJ||{};SJ.ns=function(n){var e,t,o=n.split("."),i=SJ;for("SJ"===o[0]&&(o=o.slice(1)),e=0;e<o.length;e++)void 0===i[t=o[e]]&&(i[t]={}),i=i[t];return i},function(n){var o={},i=0,e={}.toString,t={appName:window.applicationName||"DEFAULT",generateGUID:function(){var t=(new Date).getTime();return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var e=(t+16*Math.random())%16|0;return t=Math.floor(t/16),("x"==n?e:7&e|8).toString(16)})},callback:function(n){var e;SJ.isFunction(n)&&(e=Array.prototype.slice.call(arguments,1),n.apply(window,e))},windowOn:function(n,e){e.handlerId=++i;function t(n){n=n||window.event,e(n)}o[e.handlerId]=e,window.addEventListener?window.addEventListener(n,t,!1):window.attachEvent&&window.attachEvent("on"+n,t)},windowUn:function(n,e){window.removeEventListener?window.removeEventListener(n,o[e.handlerId],!1):window.detachEvent&&window.detachEvent("un"+n,o[e.handlerId]),delete o[e.handlerId]},isIE:function(){var n;return!window.ActiveXObject&&"ActiveXObject"in window?11:-1!==(n=navigator.userAgent.toLowerCase()).indexOf("msie")&&parseInt(n.split("msie")[1])},copy:function(n,e){for(var t in e)n[t]=e[t];return n},emptyFn:function(){},isEmpty:function(n){return null==n||""===n||SJ.isArray(n)&&0===n.length},isArray:"isArray"in Array?Array.isArray:function(n){return"[object Array]"===e.call(n)},isDate:function(n){return"[object Date]"===e.call(n)},isObject:function(n){return null!=n&&"[object Object]"===e.call(n)},isPrimitive:function(n){n=typeof n;return"number"==n||"string"==n||"boolean"==n},isFunction:function(n){return!!n&&"[object Function]"===e.call(n)},isNumber:function(n){return"number"==typeof n&&isFinite(n)},isNumeric:function(n){return!isNaN(parseFloat(n))&&isFinite(n)},isString:function(n){return"string"==typeof n},isBoolean:function(n){return"boolean"==typeof n}};t.copy(n,t)}(SJ),function(n){SJ.copy(n,{each:function(n,e){for(var t in n)if(n.hasOwnProperty(t)&&!1===e(n[t],t))break}})}(SJ.ns("Object")),function(n){function o(n){function i(n,e){for(var t=0;t<r[n].length;t++)r[n][t]===e&&r[n].splice(t,1)}function o(n,e,t){var o,i=r[n];if(i)for(o=0;o<i.length;o++)if(i[o].fn===e&&i[o].scope===t)return i[o];return null}var r={};return n.on=function(n,e,t){r[n]||(r[n]=[]),o(n,e,t)||r[n].push({fn:e,scope:t})},n.once=function(n,e,t){o(n,e,t)||(r[n]=r[n]||[],r[n].push({fn:e,scope:t,single:!0}))},n.un=function(n,e,t){e=o(n,e,t);e&&i(n,e)},n.fire=function(n){var e,t,o=r[n];if(o)for(o=[].concat(o),e=Array.prototype.slice.call(arguments,1),t=0;t<o.length;t++)o[t].fn.apply(o[t].scope,e),o[t].single&&i(n,o[t])},n}function i(){o(this)}i.decorate=function(n,e){var t;return e?(t=new i,n.on=t.on,n.un=t.un,n.once=t.once):t=o(n),t},n.Observable=i}(SJ.ns("utils")),function(n){var e,t,o,i,r,c=window.localStorage,a=(void 0===c&&(c={getItem:function(){},setItem:function(){},removeItem:function(){}},alert("Local storage is not supported on this browser. Some features will not work.")),11===SJ.isIE()),s=new SJ.utils.Observable,l=10===SJ.isIE()||9===SJ.isIE();l||(r=new SJ.utils.Observable),e=a?function(n){n=n||window.event,o=n.key,i=n.newValue,s.fire("storage",n),r.fire("storage",n)}:l?function(n){n=n||window.event,s.fire("storage",n)}:function(n){n=n||window.event,s.fire("storage",n),r.fire("storage",n)},window.addEventListener?((t=a?window.top:window).addEventListener("storage",e,!1),t!=window&&window.addEventListener("unload",function(){t.removeEventListener("storage",e,!1)})):window.attachEvent&&document.attachEvent("onstorage",e),n.localStorage={onChanged:function(n,e,t){(t&&!l?r:s).on("storage",n,e)},onceChanged:function(n,e,t){(t&&!l?r:s).once("storage",n,e)},unChanged:function(n,e){s.un("storage",n,e),l||r.un("storage",n,e)},getItem:function(n){return a&&o===n?i:c.getItem(n)},setItem:l?function(n,e){a&&o===n&&(i=e),c.setItem(n,e)}:function(n,e){var t=this.getItem(n);a&&o===n&&(i=e),c.setItem(n,e),n={key:n,oldValue:t,newValue:e,url:window.location.href.toString()},r.fire("storage",n)},removeItem:l?function(n){a&&o===n&&(i=null),c.removeItem(n)}:function(n){var e=this.getItem(n);a&&o===n&&(i=null),c.removeItem(n),n={key:n,oldValue:e,newValue:null,url:window.location.href.toString()},r.fire("storage",n)},forEach:a?function(n){for(var e,t=0;t<c.length&&!1!==n(e=c.key(t),e===o?i:c.getItem(e));t++);}:function(n){for(var e,t=0;t<c.length&&!1!==n(e=c.key(t),c.getItem(e));t++);},setVersion:function(e,n){var t,o=this;o.getItem(e)!==n&&(t=[],o.forEach(function(n){n.substr(0,e.length)===e&&t.push(n)}),t.forEach(function(n){o.removeItem(n)}),o.setItem(e,n))}}}(SJ),function(n){var e="IWC_"+SJ.appName;n.getLocalStoragePrefix=function(){return e},n.$version="0.1.3",SJ.localStorage.setVersion(e,n.$version)}(SJ.ns("iwc")),function(l){function e(){f.fire("storagechanged")}function n(o,i){function r(){n||(f.on("storagechanged",t),e=window.setInterval(t,50),n=!0)}function c(){n&&(f.un("storagechanged",t),window.clearInterval(e),n=!1)}var a=!1,n=!1,e=null,s=l.testingMode&&l.lockTimeout||3e3,t=function(){var e,n,t;a||(e=(new Date).getTime(),(n=u(o))&&e-n.timestamp<s?r():(a=!0,c(),d(o,e),t=window.setTimeout(function(){window.clearTimeout(t);var n=u(o);!n||n.timestamp===e&&n.lockerId===S?(c(),n||d(o,e),i(),l.testingMode||(n=w+(n=o),SJ.localStorage.removeItem(n))):(a=!1,r())},10)))};t()}function u(n){var n=w+n,n=SJ.localStorage.getItem(n),e=null;return n&&(n=n.split("."),e={timestamp:parseInt(n[0])||0,lockerId:n[1]}),e}function d(n,e){n=w+n;SJ.localStorage.setItem(n,e+"."+S)}var f,w=SJ.iwc.getLocalStoragePrefix()+"_TLOCK_",S=SJ.generateGUID();SJ.localStorage.onChanged(function(n){n.key&&(n.newValue||!n.oldValue||n.key.substr(0,w.length)!==w)||e()}),f=new SJ.utils.Observable,l.interlockedCall=n,SJ.interlockedCall=n}(SJ.ns("iwc.Lock")),function(n){function e(n){var e=this;e._dataId=n,e._observable=new SJ.utils.Observable,e._serializedData=SJ.localStorage.getItem(e._dataId),SJ.localStorage.onChanged(e.onStorageChanged,e,!0)}e.prototype={constructor:e,get:function(){var n;return this._serializedData=SJ.localStorage.getItem(this._dataId),n=null,n=this._serializedData?JSON.parse(this._serializedData):n},set:function(n,e){var t=this;SJ.iwc.Lock.interlockedCall(t._dataId,function(){t.writeToStorage(n),SJ.callback(e)})},change:function(e){var t=this;SJ.iwc.Lock.interlockedCall(t._dataId,function(){var n=t.get(),n=e(n);t.writeToStorage(n)})},onChanged:function(n,e){this._observable.on("changed",n,e)},onceChanged:function(n,e){this._observable.once("changed",n,e)},unsubscribe:function(n,e){this._observable.un("changed",n,e)},writeToStorage:function(n){n=null!==n?JSON.stringify(n):"";SJ.localStorage.setItem(this._dataId,n)},onStorageChanged:function(n){var e,t=this;n.key&&n.key!==t._dataId||(n=SJ.localStorage.getItem(t._dataId))!==t._serializedData&&(e=null,(t._serializedData=n)&&(e=JSON.parse(n)),t._observable.fire("changed",e))}},n.SharedData=e}(SJ.ns("iwc")),function(n){var t=SJ.generateGUID(),i=new SJ.utils.Observable,r=new SJ.utils.Observable,o=SJ.iwc.getLocalStoragePrefix()+"_EBUS";SJ.localStorage.onChanged(function(n){n.key===o&&n.newValue&&(n=JSON.parse(n.newValue)).senderBusNodeId!==t&&(i.fire.apply(window,n.args),r.fire.apply(window,n.args))}),SJ.copy(n,{on:function(n,e,t,o){(o?r:i).on(n,e,t)},once:function(n,e,t,o){(o?r:i).once(n,e,t)},un:function(n,e,t,o){(o?r:i).un(n,e,t)},fire:function(){var n={senderBusNodeId:t,args:Array.prototype.slice.call(arguments,0)},e=JSON.stringify(n);SJ.localStorage.setItem(o,e),r.fire.apply(window,n.args)}})}(SJ.ns("iwc.EventBus")),function(n){function r(){var n,e,t={},o=(SJ.localStorage.forEach(function(n,e){e&&n.substr(0,w.length)===w&&(n=n.substr(w.length),t[n]=parseInt(e))}),t),i=(new Date).getTime();for(e in o)o.hasOwnProperty(e)&&e!==u&&(n=i-o[e],2*c<n||c<n&&l[e]&&i-l[e]>a?(delete o[e],SJ.localStorage.removeItem(w+e)):c<n?l[e]||(l[e]=i,SJ.iwc.EventBus.fire("windowisaliverequest",e)):l[e]&&delete l[e]);for(e in l)l.hasOwnProperty(e)&&!o.hasOwnProperty(e)&&delete l[e];return t}function e(){t();var n=(new Date).getTime();s[u]=n,SJ.localStorage.setItem(v,n),d||(d=!0,f.fire("windowsmanagerready"))}function t(){var n,e,t,o=r(),i=[];for(e in o)o.hasOwnProperty(e)&&!s[e]&&i.push(e);for(e in n=[],s)s.hasOwnProperty(e)&&!o[e]&&n.push(e);(i.length||n.length)&&(t=n,f.fire("windowschanged",i,t)),s=o}function o(n){var e,t,o;n===u&&(window.focus(),i||(t=document.title,o=!1,i=6,e=function(){document.title=o?t:"******",o=!o,--i&&window.setTimeout(e,500)},window.setTimeout(e,500)))}var i,c=5e3,a=2e3,s={},l={},u=window.name||SJ.generateGUID(),d=!1,f=new SJ.utils.Observable,w=SJ.iwc.getLocalStoragePrefix()+"_WND_",S=c/2,v=w+u;SJ.windowOn("unload",function(){SJ.localStorage.removeItem(v)}),SJ.localStorage.onChanged(function(n){n.key&&n.key.substr(0,w.length)!==w||t()}),SJ.iwc.EventBus.on("windowfocusrequest",o),SJ.iwc.EventBus.on("windowisaliverequest",function(n){n===u&&(e(),SJ.iwc.EventBus.fire("windowisaliveresponce",n))}),SJ.iwc.EventBus.on("windowisaliveresponce",function(n){n!==u&&l[n]&&delete l[n]}),e(),window.setInterval(e,S),i=0,SJ.copy(n,{isWindowOpen:function(n){return!!s[n]},getOpenWindowIds:function(){var n,e=[];for(n in s)s.hasOwnProperty(n)&&e.push(n);return e},setFocus:function(n){n?o(u):SJ.iwc.EventBus.fire("windowfocusrequest",n)},getThisWindowId:function(){return u},isReady:function(){return d},onReady:function(n,e){d?n.call(e):f.once("windowsmanagerready",n,e)},onWindowsChanged:function(n,e){f.on("windowschanged",n,e)},onceWindowsChanged:function(n,e){f.once("windowschanged",n,e)},unsubscribe:function(n,e){f.un("windowschanged",n,e)}})}(SJ.ns("iwc.WindowMonitor")),function(n){function u(n){v.un("storagechanged",n)}function d(){v.fire("storagechanged")}function e(t,n){function e(){c||(v.on("storagechanged",l),a=window.setInterval(l,500),c=!0)}function o(){c&&(u(l),window.clearInterval(a),c=!1)}var i=!1,r=!1,c=!1,a=null,s={lockId:t,release:function(){var n,e;r=!0,c&&(u(lock),c=!1),i&&(i=!1,-1!==(e=S(n=t))&&p.splice(e,1),e=g+n,(n=SJ.localStorage.getItem(e))&&(n=JSON.parse(n),SJ.iwc.WindowMonitor.getThisWindowId()===n.ownerWindowId)&&SJ.localStorage.removeItem(e),d())},isCaptured:function(){return i},isReleased:function(){return r}},l=function(){i||r||(w(t)?e():(o(),SJ.iwc.Lock.interlockedCall(t,function(){w(t)?(e(),w(t)||(o(),f(s),i=!0,n())):(f(s),i=!0,n())})))};return h?l():v.once("locksinitialized",l),s}function t(e){var i=[];SJ.iwc.WindowMonitor.onReady(function(){if(SJ.localStorage.forEach(function(n,e){var t,o;e&&n.substr(0,g.length)===g&&(!((e=JSON.parse(e))&&e.timestamp&&e.ownerWindowId)||(t=e.ownerWindowId===SJ.iwc.WindowMonitor.getThisWindowId(),e=!SJ.iwc.WindowMonitor.isWindowOpen(e.ownerWindowId),o=n.substr(g.length),e)||t&&-1===S(o))&&i.push(n)}),i.length){for(var n=0;n<i.length;n++)SJ.localStorage.removeItem(i[n]);d()}e&&e()})}function f(n){var e={timestamp:(new Date).getTime(),ownerWindowId:SJ.iwc.WindowMonitor.getThisWindowId()},t=g+n.lockId;SJ.localStorage.setItem(t,JSON.stringify(e)),p.push(n)}function w(n){var n=g+n,n=SJ.localStorage.getItem(n);return n&&(n=JSON.parse(n),SJ.iwc.WindowMonitor.isWindowOpen(n.ownerWindowId))}function S(n){for(var e=0;e<p.length;e++)if(p[e].lockId===n)return e;return-1}var v,g=SJ.iwc.getLocalStoragePrefix()+"_LOCK_",p=[],h=!1;SJ.localStorage.onChanged(function(n){n.key&&(n.newValue||!n.oldValue||n.key.substr(0,g.length)!==g)||d()}),v=new SJ.utils.Observable,SJ.windowOn(window,"unload",function(){for(var n=[].concat(void 0),e=0;e<n.length;e++)n[e].release()}),t(function(){SJ.iwc.WindowMonitor.onWindowsChanged(function(n,e){e.length&&t()}),h=!0,v.fire("locksinitialized")}),n.capture=e,SJ.lock=e}(SJ.ns("iwc.Lock")),function(n){function e(n,e){var t=this;t._serverId=n,t._isReady=!1,t._observable=SJ.utils.Observable.decorate(t,!0),t._serverDescriptionHolder=new SJ.iwc.SharedData(n),(n=t._serverDescriptionHolder.get())&&t.updateContract(n),t._serverDescriptionHolder.onChanged(function(n){t.updateContract(n)}),e&&t.onReady(e)}e.prototype={constructor:e,onReady:function(n,e){this._isReady?n.call(e):this._observable.once("ready",n,e)},updateContract:function(n){var e=this;n.forEach(function(n){e[n]||(e[n]=e.createProxyMethod(n))}),e._isReady||(e._isReady=!0,e._observable.fire("ready"))},createProxyMethod:function(o){var i=this;return function(){var n=null,e=null,t=Array.prototype.slice.call(arguments,0);t.length&&SJ.isFunction(t[t.length-1])&&(n=SJ.generateGUID(),e=t.pop()),SJ.iwc.EventBus.fire("servercall_"+i._serverId,{methodName:o,callId:n,args:t}),n&&SJ.iwc.EventBus.once("servercallback_"+n,e)}}},n.Client=e}(SJ.ns("iwc")),function(n){function e(n,e){var t,o=this;o._serverId=n,o._serverDescriptionHolder=new SJ.iwc.SharedData(o._serverId),SJ.copy(o,e.exposed),t=e.exposed,delete e.exposed,SJ.copy(o,e),SJ.lock(n,function(){o.onInit(),o.updateServerDescription(t),SJ.iwc.EventBus.on("servercall_"+o._serverId,o.onServerCall,o)})}e.prototype={constructor:e,onInit:SJ.emptyFn,updateServerDescription:function(n){var e=[];SJ.Object.each(n,function(n){e.push(n)}),this._serverDescriptionHolder.set(e)},onServerCall:function(n){var e=n.args||[];n.callId?e.unshift(function(){var n=Array.prototype.slice.call(arguments,0);n.unshift("servercallback_"+callId),SJ.iwc.EventBus.fire.apply(SJ.iwc.EventBus,n)}):e.unshift(SJ.emptyFn),this[n.methodName].apply(this,e)}},n.Server=e}(SJ.ns("iwc")),function(n){var i={},a=!1,r=!1,e=!1,c=$.Deferred(),s={},l=SJ.iwc.getLocalStoragePrefix()+"_SIGNALR_",u=new SJ.iwc.SharedData(l+"CLIENTS");function d(n){n.done(function(){t(!0)}).fail(function(n){t(!1,n)})}function f(n,e){n?c.resolve():c.reject(e)}function t(n,e){if(!a)throw"Invalid operation - onHubConnectionStarted is allowed only for connection owner";var t={success:n,errorMsg:e,windowId:SJ.iwc.WindowMonitor.getThisWindowId()};SJ.localStorage.setItem(l+"STARTEDRESULT",JSON.stringify(t)),SJ.iwc.EventBus.fire("signalrconnectionstarted",n,e)}function w(){for(var n in i)if(i.hasOwnProperty(n)){e=o=t=void 0;var e,t=i[n],o=$.connection[t.name];for(e in t.client)t.client.hasOwnProperty(e)&&SJ.isFunction(t.client[e])&&!o.client[e]&&(!function(e,n,t){n.client[t]=function(){e.client[t].apply(this,arguments);var n=["signalrclientinvoke",e.name,t].concat(Array.prototype.slice.call(arguments,0));SJ.iwc.EventBus.fire.apply(SJ.iwc.EventBus,n)}}(t,o,e),t.client._applied=t.client._applied||{},t.client._applied[e]=!0)}}function S(n){var e,t,o=!1;for(e in n)n.hasOwnProperty(e)&&((t=i[e])||(t={name:e,client:{},server:p(e)},i[e]=t),n[e].methods.forEach(function(n){t.client[n]?t.client._applied&&t.client._applied[n]||(o=!0):(o=!0,t.client[n]=SJ.emptyFn)}));return o&&w(),o}function v(n){for(var e in n){var t,o;n.hasOwnProperty(e)&&(t=!1,o=[],n[e].windows.forEach(function(n){SJ.iwc.WindowMonitor.isWindowOpen(n)?o.push(n):t=!0}),t)&&(o.length?n[e].windows=o:delete n[e])}return n}function g(n,e){var t;!a&&i[n]&&i[n].client[e]&&(t=Array.prototype.slice.call(arguments,2),i[n].client[e].apply(i[n],t))}function p(n){var e,t=$.connection[n],o={};for(e in t.server)t.server.hasOwnProperty(e)&&SJ.isFunction(t.server[e])&&(o[e]=function(i,r){var c=$.connection[i];return function(){var n,e,t,o;return a?c.server[r].apply(c.server,arguments):(t=Array.prototype.slice.call(arguments,0),n=i,e=r,t=t,o=SJ.generateGUID(),n=["signalrserverinvoke",n,e,o].concat(t),SJ.iwc.EventBus.fire.apply(SJ.iwc.EventBus,n),e=$.Deferred(),(s[o]=e).promise())}}(n,e));return o}function h(n,e,t){var o=Array.prototype.slice.call(arguments,3);i[n]&&i[n].server[e].apply(i[n],o).done(function(){var n=["signalrserverresponse",t,!0].concat(Array.prototype.slice.call(arguments,0));SJ.iwc.EventBus.fire.apply(SJ.iwc.EventBus,n)}).fail(function(n){SJ.iwc.EventBus.fire("signalrserverresponse",t,!1,n)})}function J(n,e,t){var o;!a&&s[n]&&(e?(o=Array.prototype.slice.call(arguments,2),s[n].resolve.apply(s[n],o)):s[n].reject(t),delete s[n])}function y(n,e){k.fire("statechanged",n,e),n!==e&&n===$.signalR.connectionState.connected&&k.fire("connected")}function m(){k.fire("starting")}function I(){k.fire("received")}function b(){k.fire("connectionslow")}function E(){k.fire("reconnecting")}function O(){k.fire("reconnected")}function _(){k.fire("disconnected")}function x(n){var e=n.newState;if(!a)throw"Invalid operation - updateState is allowed only for connection owner";e={state:e,connectionId:$.connection.hub.id,windowId:SJ.iwc.WindowMonitor.getThisWindowId()},SJ.localStorage.setItem(l+"STATE",JSON.stringify(e)),SJ.iwc.EventBus.fire("signalrstatechanged",n.newState,n.oldState)}function o(){var n=null,e=SJ.localStorage.getItem(l+"STATE");return n=e&&(e=JSON.parse(e),SJ.iwc.WindowMonitor.isWindowOpen(e.windowId))?e:n}SJ.localStorage.setVersion(l,"0.1");var W={getHubProxy:function(r,c){var n;if(i[r]){var e,t=i[r].client;for(e in t)SJ.isFunction(c.client[e])&&t[e]===SJ.emptyFn&&(t[e]=c.client[e]);for(e in c.client)SJ.isFunction(c.client[e])&&!t[e]&&(t[e]=c.client[e]);n=i[r]}else n={name:r,client:c.client,server:p(r)},i[r]=n;return u.change(function(n){(n=n||{})[r]=n[r]||{windows:[],methods:[]};var e,t=n[r].windows,o=SJ.iwc.WindowMonitor.getThisWindowId(),i=(-1===t.indexOf(o)&&t.push(o),n[r].methods);for(e in c.client)c.client.hasOwnProperty(e)&&SJ.isFunction(c.client[e])&&-1===i.indexOf(e)&&i.push(e);return n}),n},start:function(){e||(e=!0,SJ.windowOn("unload",function(){a&&(SJ.localStorage.removeItem(l+"STARTEDRESULT"),$.connection.hub.stop())}),SJ.iwc.EventBus.on("signalrclientinvoke",g,null,!0),SJ.iwc.EventBus.on("signalrserverresponse",J,null,!0),SJ.iwc.EventBus.on("signalrconnectionstarted",f,null,!0),SJ.iwc.EventBus.on("signalrstatechanged",y,null,!0),SJ.iwc.EventBus.on("signalrconnectionstarting",m,null,!0),SJ.iwc.EventBus.on("signalrconnectionreceived",I,null,!0),SJ.iwc.EventBus.on("signalrconnectionslow",b,null,!0),SJ.iwc.EventBus.on("signalrconnectionreconnecting",E,null,!0),SJ.iwc.EventBus.on("signalrconnectionreconnected",O,null,!0),SJ.iwc.EventBus.on("signalrconnectiondisconnected",_,null,!0));var t,o=Array.prototype.slice.call(arguments,0);return a?(d(t=$.connection.hub.start.apply($.connection.hub,o)),t):(t=$.Deferred(),SJ.iwc.WindowMonitor.onReady(function(){var n,e;(e=function(){var n=null,e=SJ.localStorage.getItem(l+"STARTEDRESULT");e&&(n=JSON.parse(e),SJ.iwc.WindowMonitor.isWindowOpen(n.windowId)||(n=null));return n}())?(function(n){var e=c.state(),t="resolved"===e;return"pending"===e||n===t}(e.success)||(c=$.Deferred()),e.success?c.resolve():c.reject(e.errorMsg)):"pending"!==c.state()&&(c=$.Deferred()),r||(r=!0,SJ.lock("IWC_SIGNALR",function(){a=!0,u.onChanged(function(n){n&&S(n)&&d($.connection.hub.start.apply($.connection.hub,o))});var n=u.get();n&&(S(v(n)),u.change(v)),SJ.iwc.EventBus.on("signalrserverinvoke",h,null,!0),w(),$.connection.hub.starting(function(){SJ.iwc.EventBus.fire("signalrconnectionstarting")}),$.connection.hub.received(function(){SJ.iwc.EventBus.fire("signalrconnectionreceived")}),$.connection.hub.connectionSlow(function(){SJ.iwc.EventBus.fire("signalrconnectionslow")}),$.connection.hub.reconnecting(function(){SJ.iwc.EventBus.fire("signalrconnectionreconnecting")}),$.connection.hub.reconnected(function(){SJ.iwc.EventBus.fire("signalrconnectionreconnected")}),$.connection.hub.disconnected(function(){SJ.iwc.EventBus.fire("signalrconnectiondisconnected")}),$.connection.hub.stateChanged(x),d($.connection.hub.start.apply($.connection.hub,o))})),n=t,(e=c.promise()).done(function(){n.resolveWith(this,arguments)}),e.fail(function(){n.rejectWith(this,arguments)}),e.progress(function(){n.notifyWith(this,arguments)})}),t.promise())},getState:function(){var n=$.connection.connectionState.disconnected,e=o();return n=e?e.state:n},getConnectionId:function(){var n=null,e=o();return n=e?e.connectionId:n},isConnectionOwner:function(){return a},getConnectionOwnerWindowId:function(){var n=null,e=SJ.localStorage.getItem(l+"STATE");return n=e&&(e=JSON.parse(e),SJ.iwc.WindowMonitor.isWindowOpen(e.windowId))?e.windowId:n}},k=SJ.utils.Observable.decorate(W,!0);SJ.copy(n,W)}(SJ.ns("iwc.SignalR")),function(){var i={deferredStartResult:$.Deferred(),isStarting:!1,observable:new SJ.utils.Observable,defferedServerCalls:[],isProxiesUpdated:!1,originalStart:$.connection.hub.start};function n(){var n=arguments;i.isStarting?"pending"===i.deferredStartResult.state()&&i.originalStart.apply($.connection.hub,n):(i.isStarting=!0,window.setTimeout(function(){$.connection.hub._.lastMessageAt=(new Date).getTime(),$.connection.hub._.lastActiveAt=(new Date).getTime(),delete $.connection.hub._deferral,i.originalStart.apply($.connection.hub,n).done(function(){i.isStarting=!1,i.deferredStartResult.resolveWith(this,arguments)}).fail(function(){i.isStarting=!1,i.deferredStartResult.rejectWith(this,arguments)})}))}$.connection.hub.start=function(){i.isProxiesUpdated||(i.isProxiesUpdated=!0,function(){for(var n in $.connection)$.connection[n].hubName===n.toLowerCase()&&!function(t){var o=$.connection[t];if(!o.server.isFixed){for(var n in o.server)o.server.hasOwnProperty(n)&&SJ.isFunction(o.server[n])&&!function(n){var e=o.server[n];o.server[n]=function(){return $.connection.hub.state===$.signalR.connectionState.connected?e.apply(this,arguments):(defferedObj=$.Deferred(),i.defferedServerCalls.push({proxyName:t,methodName:n,defferedObj:defferedObj,args:Array.prototype.slice.call(arguments,0)}),defferedObj.promise())}}(n);o.server.isFixed=!0}}(n)}());"pending"!==i.deferredStartResult.state()&&(i.deferredStartResult=$.Deferred());$.connection.hub.state===$.signalR.connectionState.disconnected?n.apply(this,arguments):function(n){function e(){i.isStarting=!1,n()}function t(){i.observable.once("disconnected",e),$.connection.hub.stop()}$.connection.hub.state===$.signalR.connectionState.connected?t():$.connection.hub.state===$.signalR.connectionState.disconnected?e():i.observable.once("connected",function(){t()})}(function(){n.apply(this,arguments)});return i.deferredStartResult.promise()},$.connection.hub.connected=function(n){i.observable.on("connected",n,$.connection.hub)}}();