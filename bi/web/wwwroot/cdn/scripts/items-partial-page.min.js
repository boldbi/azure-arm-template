var isMoveItemDialogBinded=!1,isCopyItemDialogBinded=!1,isDownloadItemDialogBinded=!1,isTabSecurityDialogBinded=!1,isUploadItemDialogBinded=!1,checkBoxState=!1;function MoveDashboardItem(e,t,o){$("#move_item_name").closest("div").removeClass("has-error"),$("#move_item_name").parent().find(".validation-error").html("");var a,n,i='<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.MoveDashboard+'</span><span class="item-name">'+e.Name+"</span></span>";isMoveItemDialogBinded?((n=document.getElementById("move_item_dialog").ej2_instances)[0].header=i,n[0].show()):((a=document.createElement("div")).setAttribute("id","move_item_dialog"),document.getElementById("dashboard-page-container").appendChild(a),(n=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:460<window.innerWidth?"436px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:i,showCloseIcon:!0,content:document.getElementById("ItemAction"),buttons:[{click:function(e){MoveItem(o)},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.Move}},{click:function(){n.hide(),$("#move_item_name").closest("div").removeClass("has-error"),$("#move_item_name").parent().find(".validation-error").html("")},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}]})).appendTo(a),isMoveItemDialogBinded=!0),ejs.popups.createSpinner({target:document.getElementById("move_item_dialog")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("move_item_dialog")),$("#move_item_name").val(e.Name),document.getElementById("ItemAction").style.display="block",getItemDetails(e,t,o)}function getItemDetails(n,e,i){var s=document.getElementById("move_item_dialog").ej2_instances;$.ajax({type:"POST",url:moveIframeUrl,url:i?movemultitabIframeUrl:moveIframeUrl,data:{itemId:n.Id,itemAction:e},success:function(e){var t,o,a;e.status?(s[0].buttons=[{click:function(e){MoveItem(i)},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.Move}},{click:function(){s[0].hide(),$("#move_item_name").closest("div").removeClass("has-error"),$("#move_item_name").parent().find(".validation-error").html("")},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}],$("#move_report_form").show(),$("#move-item-denied").hide(),$("#MoveItemIdHidden").val(n.Id),$("#move_item_name").val(e.fullName),null!=e.categoryDetails&&(t=e.categoryDetails,o=$(".move-category"),null!=(a=document.querySelector(".move-category #CategoryList"))&&null!=a.ej2_instances&&a.ej2_instances[0].destroy(),new ejs.dropdowns.DropDownTree({fields:{dataSource:t,value:"Id",text:"Name",child:"SubCategory"},select:function(){copyMovecategoryValueChange(o)},value:[t[0].Id.toString()],allowFiltering:!0,destroyPopupOnHide:!1,showClearButton:!1}).appendTo(".move-category #CategoryList"),$("#add-new-category [data-toggle='tooltip']").tooltip())):($("#move_report_form").hide(),null!=e.accessDenied?$("#move-item-denied").text(e.accessDenied).show():null!=e.exception&&$("#move-item-denied").text(e.exception).show(),s[0].buttons=[{click:function(){s[0].hide()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.OKButton}}]),ejs.popups.hideSpinner(document.getElementById("move_item_dialog"))}})}function CopyDashboardItem(e,t,o,a){$(this).attr("data-itemId");$("#copy_item_name").closest("div").removeClass("has-error"),$("#copy_item_name").parent().find(".validation-error").html("");var n,i,s="",s="clone"==t.toLowerCase()?'<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.CloneDashboard+'</span><span class="item-name">'+e.Name+"</span></span>":'<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.CopyDashboard+'</span><span class="item-name">'+e.Name+"</span></span>";isCopyItemDialogBinded?((i=document.getElementById("copy_item_dialog").ej2_instances)[0].header=s,i[0].show()):((n=document.createElement("div")).setAttribute("id","copy_item_dialog"),document.getElementById("dashboard-page-container").appendChild(n),(i=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:460<window.innerWidth?"436px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:s,showCloseIcon:!0,content:document.getElementById("Copy_Item"),buttons:[{click:function(e){a?CopyMultiTabItem(t,multiTabItems):CopyItem(t)},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:"clone"==t.toLowerCase()?window.Server.App.Localization.Clone:window.Server.App.Localization.Copy}},{click:function(){i[0].hide(),a?($("#copy_item_name").closest("div").removeClass("has-error"),$("#copy_item_name").parent().find(".validation-error").html("")):($("#copy-datasource").removeAttr("disabled"),$("#copy_item_name").closest("div").removeClass("has-error"),$("#copy_item_name").parent().find(".validation-error").html(""),$("#copy-datasource-checkbox").show())},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}]})).appendTo(n),isCopyItemDialogBinded=!0),ejs.popups.createSpinner({target:document.getElementById("copy_item_dialog")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("copy_item_dialog")),$("#copy_item_name").val(e.Name),a||$("#copy-datasource").prop("checked",!1),document.getElementById("Copy_Item").style.display="block",$("#isUsageAnalytics").val(o),$("#CopyItemIdHidden").val(e.Id),$("#CopyItemType").val(e.ItemType),e.ItemType==ItemType.Dashboard&&$("#copyaction-category-division").show(),e.ItemType!=ItemType.Dashboard||o||$("#copy-datasource-checkbox").show(),a&&$("#copy-datasource-checkbox").hide(),getCopyItemDetails(e,t,o,a)}function getCopyItemDetails(e,a,t,n){var i=document.getElementById("copy_item_dialog").ej2_instances;$.ajax({type:"POST",url:n?copyMultiTabDashboardUrl:copyIframeUrl,data:{itemId:e.Id,itemAction:a,isUsageAnalytics:t},success:function(t){var e,o;t.status?($("#item_action_form").show(),$("#copy-item-denied").hide(),i[0].buttons=[{click:function(e){n?CopyMultiTabItem(a,t.multiTabItems):CopyItem(a)},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:"clone"==a.toLowerCase()?window.Server.App.Localization.Clone:window.Server.App.Localization.Copy}},{click:function(){i[0].hide(),$("#copy_item_name").closest("div").removeClass("has-error"),$("#copy_item_name").parent().find(".validation-error").html("")},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}],n?$("#copy-datasource").hide():(0!=t.dataSourceCount&&t.hasCreateDataSourcePermission?$("#copy-datasource").attr("disabled",!1):$("#copy-datasource").attr("disabled",!0),t.hasCreateDataSourcePermission||($("#copy-datasource-label").attr("data-toggle","tooltip"),$("#copy-datasource-label").attr("data-original-title",window.Server.App.Localization.DatasourceCloneCopyDenied),$('[data-toggle="tooltip"]').tooltip())),null!=t.categories&&(t.categories,$("#add-new-category [data-toggle='tooltip']").tooltip(),e=$(".copy-category"),null!=(o=document.querySelector(".copy-category #CategoryList"))&&null!=o.ej2_instances&&o.ej2_instances[0].destroy(),new ejs.dropdowns.DropDownTree({fields:{dataSource:t.categories,value:"Id",text:"Name",child:"SubCategory"},select:function(){copyMovecategoryValueChange(e)},value:[t.categories[0].Id.toString()],allowFiltering:!0,destroyPopupOnHide:!1,showClearButton:!1}).appendTo(".copy-category #CategoryList"),document.getElementById(".copy-category #CategoryList"))):($("#item_action_form").hide(),null!=t.accessDenied?$("#copy-item-denied").text(t.accessDenied).show():null!=t.exception&&$("#copy-item-denied").text(t.exception).show(),i[0].buttons=[{click:function(){i[0].hide()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.OKButton}}]),ejs.popups.hideSpinner(document.getElementById("copy_item_dialog"))}})}function copyMovecategoryValueChange(e){$("#CreateCategoryPopup #categorylist_validation").html("");for(var t=$("#move_item_dialog").is(":visible")?".move-category #CategoryList":".copy-category #CategoryList",t=document.querySelector(t).ej2_instances[0],o=$("#CategoryList_tree .e-list-item[aria-selected='true']"),a=parseInt(o.attr("aria-level")),n=[],i=1;i<a;i++){var s=o.closest(".e-list-item[aria-level='"+i+"']").find(".e-list-text")[0].innerText;n.push(s)}n.push(t.currentText);t=n.join(" / ");e.find("input.e-dropdowntree").val(t)}function categoryValueChange(e){$("#CreateCategoryPopup #categorylist_validation").html("");for(var t=document.querySelector("#SubCategoryList").ej2_instances[0],o=$("#SubCategoryList_tree .e-list-item[aria-selected='true']"),a=parseInt(o.attr("aria-level")),n=[],i=1;i<a;i++){var s=o.closest(".e-list-item[aria-level='"+i+"']").find(".e-list-text")[0].innerText;n.push(s)}n.push(t.currentText);t=n.join(" / ");e.find("#SubCategoryList").val(t)}function onUploadDialogOpen(e){$("#server-app-container").hide(),document.getElementById("upload-popup-container").style.display="block",ejs.popups.createSpinner({target:document.getElementById("upload-popup-container")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("upload-popup-container")),isUploadItemDialogBinded?document.getElementById("upload_item_dialog").ej2_instances[0].content=document.getElementById("upload-popup"):((t=document.createElement("div")).setAttribute("id","upload_item_dialog"),document.getElementById("upload-popup-container").appendChild(t),new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:$(window).width(),height:$(window).height(),showHeader:!1,isModal:!0,enableModal:!0,visible:!1,content:document.getElementById("upload-popup")}).appendTo(t),isUploadItemDialogBinded=!0);var t=null!=e?"?itemIds="+e:"";$("#upload-popup-iframe").attr("src",uploadIframeUrl+t)}function checkCategoriesExist(){ejs.popups.createSpinner({target:document.getElementById("server-app-container")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("server-app-container")),$.ajax({type:"POST",url:checkCategoriesExistUrl,data:{"":""},success:function(e){ejs.popups.hideSpinner(document.getElementById("server-app-container")),(e.Status?onUploadDialogOpen:openCreateCategoryDialog)()}})}function openCreateCategoryDialog(){document.getElementById("CreateCategoryPopup").style.display="block";var e,t,o='<span class="dialog-header-with-icon"><span class ="dialog-header-title"><i class="su su-folder dialog-header-icon"></i>&nbsp;&nbsp;'+window.Server.App.Localization.CreateCategory+"</span></span>";isAddCategoryDialogBinded?((t=document.getElementById("create-category-dialog").ej2_instances)[0].header=o,t[0].show()):((e=document.createElement("div")).setAttribute("id","create-category-dialog"),document.getElementById("server-app-container").appendChild(e),(t=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:460<window.innerWidth?"600px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:o,showCloseIcon:!0,content:document.getElementById("CreateCategoryPopup"),beforeClose:beforeCloseAddItemPopup,buttons:[{click:function(e){addItemValidate()},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.AddButton}},{click:function(){closeAddItemPopup()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}]})).appendTo(e),isAddCategoryDialogBinded=!0),ejs.popups.createSpinner({target:document.getElementById("create-category-dialog")}),ejs.popups.setSpinner({type:"Material"}),$("#upload-dashboard-info").show(),window.UploadDashboard=!0}function DownloadDashboardItem(e){document.getElementById("Download_Item").style.display="block";var t,o=$('.dashboard-list-section input[type="checkbox"]').filter(":checked").length,a="",a=null!=e?'<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.DownloadDashboard+'<span class="badge preview-badge badge-secondary1 badge-secondary2">'+window.Server.App.Localization.PreviewTag+'</span></span><span class="item-name">'+e.Name+"</span></span>":'<span class ="dialog-header-title">'+window.Server.App.Localization.DownloadDashboard+" ("+o+')<span class="badge preview-badge badge-secondary1 badge-secondary2">'+window.Server.App.Localization.PreviewTag+"</span></span>",a=(isDownloadItemDialogBinded?((t=document.getElementById("download_item_dialog").ej2_instances)[0].header=a,t[0].show()):((o=document.createElement("div")).setAttribute("id","download_item_dialog"),document.getElementById("dashboard-page-container").appendChild(o),(t=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:460<window.innerWidth?"510px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:a,showCloseIcon:!0,content:document.getElementById("Download_Item"),buttons:[{click:function(e){DownloadItem()},buttonModel:{isPrimary:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.Download}},{click:function(){t.hide(),hideDownloadUploadOption()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}]})).appendTo(o),isDownloadItemDialogBinded=!0),ejs.popups.createSpinner({target:document.getElementById("download_item_dialog")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("download_item_dialog")),getDownloadItemDetails(e),angular.element("[ng-controller=DashboardCtrl]").scope());a.hideOptionMenu=!1,"$apply"!=a.$root.$$phase&&"$digest"!=a.$root.$$phase&&a.$apply()}function getDownloadItemDetails(e){var t="";null!=e&&(t=e.Id),$.ajax({type:"POST",url:downloadIframeUrl,data:{itemId:t},success:function(e){$("#Download_Item").html(e),ejs.popups.hideSpinner(document.getElementById("download_item_dialog"))}})}function tabSecurityConfirmationDialog(t){var e,o,a='<span class="dialog-header-with-subtitle dialog-header-with-icon"><span class ="dialog-header-title"><i class ="su su-tab-security dialog-header-icon"></i>'+window.Server.App.Localization.TabSecurity+'</span><span class="item-name">'+t.Name+"</span></span>",n=[{click:function(e){tabSecurity(t)},buttonModel:{isPrimary:!0,disabled:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.SaveButton}},{click:function(e){o.hide()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}];isTabSecurityDialogBinded?((o=document.getElementById("tab-security-dialog").ej2_instances[0]).header=a,o.buttons=n,o.show()):((e=document.createElement("div")).setAttribute("id","tab-security-dialog"),document.getElementById("server-app-container").appendChild(e),(o=new ejs.popups.Dialog({showOnInit:!1,allowDraggable:!1,enableResize:!1,width:460<window.innerWidth?"450px":window.innerWidth-10,height:"auto",showHeader:!1,animationSettings:{effect:"Zoom"},isModal:!0,enableModal:!0,closeOnEscape:!0,header:a,showCloseIcon:!0,content:document.getElementById("tab-security"),buttons:n})).appendTo(e),isTabSecurityDialogBinded=!0),$("#tab-security-checkbox").prop("checked",t.IsEnableTabSecurity),checkBoxState=t.IsEnableTabSecurity,$("#tab-security-dialog .e-primary").attr("disabled","true"),document.getElementById("tab-security").style.display="block"}function tabSecurity(e){ejs.popups.createSpinner({target:document.getElementById("tab-security-dialog")}),ejs.popups.setSpinner({type:"Material"}),ejs.popups.showSpinner(document.getElementById("tab-security-dialog"));var o=$("#tab-security-checkbox").is(":checked");$.ajax({url:itemSettingsAccessUrl,data:{itemId:e.Id,securitySettings:JSON.stringify({IsEnableTabSecurity:o}),securityType:SecurityType.TabSecurity},type:"POST",success:function(e){ejs.popups.hideSpinner(document.getElementById("tab-security-dialog"));var t=document.getElementById("tab-security-dialog").ej2_instances;e.result?(successToast(window.Server.App.Localization.TabSecuritySavedSuccessfully,5e3),ResetItemList(ItemType.Dashboard)):e.IsAlreadyUpdated?warningToast(o?window.Server.App.Localization.TabSecurityAlreadyEnabled:window.Server.App.Localization.TabSecurityAlreadyDisabled):warningToast(window.Server.App.Localization.FailedToSaveTabSecurity,e.Message),t[0].hide()}})}$(document).on("click","#upload-dashboard",function(){var e=angular.element("[ng-controller=DashboardCtrl]").scope();($("#dashboard-page-container").is(":visible")&&null!=e&&0!=e.categoryList.length?onUploadDialogOpen:checkCategoriesExist)()}),$(document).on("change","#tab-security-checkbox",function(e){checkBoxState!==$(this).is(":checked")?$("#tab-security-dialog .e-primary").prop("disabled",!1):$("#tab-security-dialog .e-primary").prop("disabled",!0)});