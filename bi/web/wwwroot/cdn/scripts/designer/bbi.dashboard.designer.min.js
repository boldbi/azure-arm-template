/*!
*  filename: bbi.dashboard.designer.min.js
*  version : 6.13.11
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
var InternalBrowseDialog,BrowseType,InternalConditionalFormat,InternalDimensionFilter,InternalDragDropHelper,InternalDateSettingsInfo,InternalFormatDialog,InternalItemPanel,ExistingWidgetCategory,__extends,InternalColorPalette,InternalMeasureFilter,InternalTooltipCustomization,InternalReportAction,InternalUndoManager,InternalKPIWindow,InternalEditFieldSettings,InternalCreateCategoryDialog,InternalColorCustomizationAdvanceSettings,InternalColorCustomizationCustomDialog,InternalColorPicker,InternalColorCustomizationInclusionSelection,InternalColorCustomizationBasicSettings,BoldBIDashboard,InternalRefreshDialog;!function(){function n(i){if(t[i])return t[i].exports;var u=t[i]={i:i,l:!1,exports:{}};return r[i].call(u.exports,u,u.exports,n),u.l=!0,u.exports}var r,t,i=(t={},n.m=r=[,,function(n){"use strict";function t(n){this.__parent=n;this.__character_count=0;this.__indent_count=-1;this.__alignment_count=0;this.__wrap_point_index=0;this.__wrap_point_character_count=0;this.__wrap_point_indent_count=-1;this.__wrap_point_alignment_count=0;this.__items=[]}function r(n,t){this.__cache=[""];this.__indent_size=n.indent_size;this.__indent_string=n.indent_char;n.indent_with_tabs||(this.__indent_string=new Array(n.indent_size+1).join(n.indent_char));t=t||"";0<n.indent_level&&(t=new Array(n.indent_level+1).join(this.__indent_string));this.__base_string=t;this.__base_string_length=t.length}function i(n,i){this.__indent_cache=new r(n,i);this.raw=!1;this._end_with_newline=n.end_with_newline;this.indent_size=n.indent_size;this.wrap_line_length=n.wrap_line_length;this.indent_empty_lines=n.indent_empty_lines;this.__lines=[];this.previous_line=null;this.current_line=null;this.next_line=new t(this);this.space_before_token=!1;this.non_breaking_space=!1;this.previous_token_wrapped=!1;this.__add_outputline()}t.prototype.clone_empty=function(){var n=new t(this.__parent);return n.set_indent(this.__indent_count,this.__alignment_count),n};t.prototype.item=function(n){return n<0?this.__items[this.__items.length+n]:this.__items[n]};t.prototype.has_match=function(n){for(var t=this.__items.length-1;0<=t;t--)if(this.__items[t].match(n))return!0;return!1};t.prototype.set_indent=function(n,t){this.is_empty()&&(this.__indent_count=n||0,this.__alignment_count=t||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))};t.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)};t.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count};t.prototype._allow_wrap=function(){if(this._should_wrap()){this.__parent.add_new_line();var n=this.__parent.current_line;return n.set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),n.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),n.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===n.__items[0]&&(n.__items.splice(0,1),--n.__character_count),!0}return!1};t.prototype.is_empty=function(){return 0===this.__items.length};t.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]};t.prototype.push=function(n){this.__items.push(n);var t=n.lastIndexOf("\n");-1!==t?this.__character_count=n.length-t:this.__character_count+=n.length};t.prototype.pop=function(){var n=null;return this.is_empty()||(n=this.__items.pop(),this.__character_count-=n.length),n};t.prototype._remove_indent=function(){0<this.__indent_count&&(--this.__indent_count,this.__character_count-=this.__parent.indent_size)};t.prototype._remove_wrap_indent=function(){0<this.__wrap_point_indent_count&&--this.__wrap_point_indent_count};t.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),--this.__character_count};t.prototype.toString=function(){var n="";return this.is_empty()?this.__parent.indent_empty_lines&&(n=this.__parent.get_indent_string(this.__indent_count)):(n=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),n+=this.__items.join("")),n};r.prototype.get_indent_size=function(n,t){var i=this.__base_string_length;return t=t||0,n<0&&(i=0),i+=n*this.__indent_size,i+t};r.prototype.get_indent_string=function(n,t){var i=this.__base_string;return t=t||0,n<0&&(n=0,i=""),t+=n*this.__indent_size,this.__ensure_cache(t),i+this.__cache[t]};r.prototype.__ensure_cache=function(n){for(;n>=this.__cache.length;)this.__add_column()};r.prototype.__add_column=function(){var n=this.__cache.length,i=0,t="";this.__indent_size&&n>=this.__indent_size&&(n-=(i=Math.floor(n/this.__indent_size))*this.__indent_size,t=new Array(i+1).join(this.__indent_string));n&&(t+=new Array(n+1).join(" "));this.__cache.push(t)};i.prototype.__add_outputline=function(){this.previous_line=this.current_line;this.current_line=this.next_line.clone_empty();this.__lines.push(this.current_line)};i.prototype.get_line_number=function(){return this.__lines.length};i.prototype.get_indent_string=function(n,t){return this.__indent_cache.get_indent_string(n,t)};i.prototype.get_indent_size=function(n,t){return this.__indent_cache.get_indent_size(n,t)};i.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()};i.prototype.add_new_line=function(n){return!(this.is_empty()||!n&&this.just_added_newline())&&(this.raw||this.__add_outputline(),!0)};i.prototype.get_code=function(n){var t,i;return this.trim(!0),t=this.current_line.pop(),t&&("\n"===t[t.length-1]&&(t=t.replace(/\n+$/g,"")),this.current_line.push(t)),this._end_with_newline&&this.__add_outputline(),i=this.__lines.join("\n"),"\n"!==n&&(i=i.replace(/[\n]/g,n)),i};i.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()};i.prototype.set_indent=function(n,t){return n=n||0,t=t||0,this.next_line.set_indent(n,t),1<this.__lines.length?(this.current_line.set_indent(n,t),!0):(this.current_line.set_indent(),!1)};i.prototype.add_raw_token=function(n){for(var t=0;t<n.newlines;t++)this.__add_outputline();this.current_line.set_indent(-1);this.current_line.push(n.whitespace_before);this.current_line.push(n.text);this.space_before_token=!1;this.non_breaking_space=!1;this.previous_token_wrapped=!1};i.prototype.add_token=function(n){this.__add_space_before_token();this.current_line.push(n);this.space_before_token=!1;this.non_breaking_space=!1;this.previous_token_wrapped=this.current_line._allow_wrap()};i.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))};i.prototype.remove_indent=function(n){for(var t=this.__lines.length;n<t;)this.__lines[n]._remove_indent(),n++;this.current_line._remove_wrap_indent()};i.prototype.trim=function(n){for(n=void 0!==n&&n,this.current_line.trim();n&&1<this.__lines.length&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=1<this.__lines.length?this.__lines[this.__lines.length-2]:null};i.prototype.just_added_newline=function(){return this.current_line.is_empty()};i.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()};i.prototype.ensure_empty_line_above=function(n,i){for(var u,r=this.__lines.length-2;0<=r;){if(u=this.__lines[r],u.is_empty())break;if(0!==u.item(0).indexOf(n)&&u.item(-1)!==i){this.__lines.splice(r+1,0,new t(this));this.previous_line=this.__lines[this.__lines.length-2];break}r--}};n.exports.Output=i},function(n){"use strict";n.exports.Token=function(n,t,i,r){this.type=n;this.text=t;this.comments_before=null;this.newlines=i||0;this.whitespace_before=r||"";this.parent=null;this.next=null;this.previous=null;this.opened=null;this.closed=null;this.directives=null}},,,function(n){"use strict";function t(n,t){this.raw_options=i(n,t);this.disabled=this._get_boolean("disabled");this.eol=this._get_characters("eol","auto");this.end_with_newline=this._get_boolean("end_with_newline");this.indent_size=this._get_number("indent_size",4);this.indent_char=this._get_characters("indent_char"," ");this.indent_level=this._get_number("indent_level");this.preserve_newlines=this._get_boolean("preserve_newlines",!0);this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786);this.preserve_newlines||(this.max_preserve_newlines=0);this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char);this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size&&(this.indent_size=4));this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char"));this.indent_empty_lines=this._get_boolean("indent_empty_lines");this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php"],["auto"])}function i(n,t){var i,u={};for(i in n=r(n))i!==t&&(u[i]=n[i]);if(t&&n[t])for(i in n[t])u[i]=n[t][i];return u}function r(n){var t,i={};for(t in n)i[t.replace(/-/g,"_")]=n[t];return i}t.prototype._get_array=function(n,t){var i=this.raw_options[n],r=t||[];return"object"==typeof i?null!==i&&"function"==typeof i.concat&&(r=i.concat()):"string"==typeof i&&(r=i.split(/[^a-zA-Z0-9_\/\-]+/)),r};t.prototype._get_boolean=function(n,t){var i=this.raw_options[n];return void 0===i?!!t:!!i};t.prototype._get_characters=function(n,t){var i=this.raw_options[n],r=t||"";return"string"==typeof i&&(r=i.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t")),r};t.prototype._get_number=function(n,t){var r=this.raw_options[n],i;return t=parseInt(t,10),isNaN(t)&&(t=0),i=parseInt(r,10),isNaN(i)&&(i=t),i};t.prototype._get_selection=function(n,t,i){var r=this._get_selection_list(n,t,i);if(1!==r.length)throw new Error("Invalid Option Value: The option '"+n+"' can only be one of the following values:\n"+t+"\nYou passed in: '"+this.raw_options[n]+"'");return r[0]};t.prototype._get_selection_list=function(n,t,i){if(!t||0===t.length)throw new Error("Selection list cannot be empty.");if(i=i||[t[0]],!this._is_valid_selection(i,t))throw new Error("Invalid Default Value!");var r=this._get_array(n,i);if(!this._is_valid_selection(r,t))throw new Error("Invalid Option Value: The option '"+n+"' can contain only the following values:\n"+t+"\nYou passed in: '"+this.raw_options[n]+"'");return r};t.prototype._is_valid_selection=function(n,t){return n.length&&t.length&&!n.some(function(n){return-1===t.indexOf(n)})};n.exports.Options=t;n.exports.normalizeOpts=r;n.exports.mergeOpts=i},,function(n){"use strict";function t(n){this.__input=n||"";this.__input_length=this.__input.length;this.__position=0}var i=RegExp.prototype.hasOwnProperty("sticky");t.prototype.restart=function(){this.__position=0};t.prototype.back=function(){0<this.__position&&--this.__position};t.prototype.hasNext=function(){return this.__position<this.__input_length};t.prototype.next=function(){var n=null;return this.hasNext()&&(n=this.__input.charAt(this.__position),this.__position+=1),n};t.prototype.peek=function(n){var t=null;return n=n||0,0<=(n+=this.__position)&&n<this.__input_length&&(t=this.__input.charAt(n)),t};t.prototype.__match=function(n,t){n.lastIndex=t;var r=n.exec(this.__input);return!r||i&&n.sticky||r.index!==t&&(r=null),r};t.prototype.test=function(n,t){return t=t||0,0<=(t+=this.__position)&&t<this.__input_length&&!!this.__match(n,t)};t.prototype.testChar=function(n,t){var i=this.peek(t);return n.lastIndex=0,null!==i&&n.test(i)};t.prototype.match=function(n){var t=this.__match(n,this.__position);return t?this.__position+=t[0].length:t=null,t};t.prototype.read=function(n,t,i){var r,u="";return n&&(r=this.match(n))&&(u+=r[0]),!t||!r&&n||(u+=this.readUntil(t,i)),u};t.prototype.readUntil=function(n,t){var u,i=this.__position,r;return n.lastIndex=this.__position,r=n.exec(this.__input),r?(i=r.index,t&&(i+=r[0].length)):i=this.__input_length,u=this.__input.substring(this.__position,i),this.__position=i,u};t.prototype.readUntilAfter=function(n){return this.readUntil(n,!0)};t.prototype.get_regexp=function(n,t){var r=null,u="g";return t&&i&&(u="y"),"string"==typeof n&&""!==n?r=new RegExp(n,u):n&&(r=new RegExp(n.source,u)),r};t.prototype.get_literal_regexp=function(n){return RegExp(n.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))};t.prototype.peekUntilAfter=function(n){var t=this.__position,i=this.readUntilAfter(n);return this.__position=t,i};t.prototype.lookBack=function(n){var t=this.__position-1;return t>=n.length&&this.__input.substring(t-n.length,t).toLowerCase()===n};n.exports.InputScanner=t},function(n,t,i){"use strict";function r(n,t){this._input=new o(n);this._options=t||{};this.__tokens=null;this._patterns={};this._patterns.whitespace=new s(this._input)}var o=i(8).InputScanner,e=i(3).Token,f=i(10).TokenStream,s=i(11).WhitespacePattern,u={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"};r.prototype.tokenize=function(){var n;this._input.restart();this.__tokens=new f;this._reset();for(var i=new e(u.START,""),t=null,o=[],r=new f;i.type!==u.EOF;){for(n=this._get_next_token(i,t);this._is_comment(n);)r.add(n),n=this._get_next_token(i,t);r.isEmpty()||(n.comments_before=r,r=new f);n.parent=t;this._is_opening(n)?(o.push(t),t=n):t&&this._is_closing(n,t)&&((n.opened=t).closed=n,t=o.pop(),n.parent=t);(n.previous=i).next=n;this.__tokens.add(n);i=n}return this.__tokens};r.prototype._is_first_token=function(){return this.__tokens.isEmpty()};r.prototype._reset=function(){};r.prototype._get_next_token=function(){this._readWhitespace();var n=this._input.read(/.+/g);return n?this._create_token(u.RAW,n):this._create_token(u.EOF,"")};r.prototype._is_comment=function(){return!1};r.prototype._is_opening=function(){return!1};r.prototype._is_closing=function(){return!1};r.prototype._create_token=function(n,t){return new e(n,t,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)};r.prototype._readWhitespace=function(){return this._patterns.whitespace.read()};n.exports.Tokenizer=r;n.exports.TOKEN=u},function(n){"use strict";function t(n){this.__tokens=[];this.__tokens_length=this.__tokens.length;this.__position=0;this.__parent_token=n}t.prototype.restart=function(){this.__position=0};t.prototype.isEmpty=function(){return 0===this.__tokens_length};t.prototype.hasNext=function(){return this.__position<this.__tokens_length};t.prototype.next=function(){var n=null;return this.hasNext()&&(n=this.__tokens[this.__position],this.__position+=1),n};t.prototype.peek=function(n){var t=null;return n=n||0,0<=(n+=this.__position)&&n<this.__tokens_length&&(t=this.__tokens[n]),t};t.prototype.add=function(n){this.__parent_token&&(n.parent=this.__parent_token);this.__tokens.push(n);this.__tokens_length+=1};n.exports.TokenStream=t},function(n,t,i){"use strict";function r(n,t){u.call(this,n,t);t?this._line_regexp=this._input.get_regexp(t._line_regexp):this.__set_whitespace_patterns("","");this.newline_count=0;this.whitespace_before_token=""}var u=i(12).Pattern;(r.prototype=new u).__set_whitespace_patterns=function(n,t){n+="\\t ";t+="\\n\\r";this._match_pattern=this._input.get_regexp("["+n+t+"]+",!0);this._newline_regexp=this._input.get_regexp("\\r\\n|["+t+"]")};r.prototype.read=function(){var n,t;return this.newline_count=0,this.whitespace_before_token="",n=this._input.read(this._match_pattern)," "===n?this.whitespace_before_token=" ":n&&(t=this.__split(this._newline_regexp,n),this.newline_count=t.length-1,this.whitespace_before_token=t[this.newline_count]),n};r.prototype.matching=function(n,t){var i=this._create();return i.__set_whitespace_patterns(n,t),i._update(),i};r.prototype._create=function(){return new r(this._input,this)};r.prototype.__split=function(n,t){for(var r=n.lastIndex=0,u=[],i=n.exec(t);i;)u.push(t.substring(r,i.index)),r=i.index+i[0].length,i=n.exec(t);return r<t.length?u.push(t.substring(r,t.length)):u.push(""),u};n.exports.WhitespacePattern=r},function(n){"use strict";function t(n,t){this._input=n;this._starting_pattern=null;this._match_pattern=null;this._until_pattern=null;this._until_after=!1;t&&(this._starting_pattern=this._input.get_regexp(t._starting_pattern,!0),this._match_pattern=this._input.get_regexp(t._match_pattern,!0),this._until_pattern=this._input.get_regexp(t._until_pattern),this._until_after=t._until_after)}t.prototype.read=function(){var n=this._input.read(this._starting_pattern);return this._starting_pattern&&!n||(n+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),n};t.prototype.read_match=function(){return this._input.match(this._match_pattern)};t.prototype.until_after=function(n){var t=this._create();return t._until_after=!0,t._until_pattern=this._input.get_regexp(n),t._update(),t};t.prototype.until=function(n){var t=this._create();return t._until_after=!1,t._until_pattern=this._input.get_regexp(n),t._update(),t};t.prototype.starting_with=function(n){var t=this._create();return t._starting_pattern=this._input.get_regexp(n,!0),t._update(),t};t.prototype.matching=function(n){var t=this._create();return t._match_pattern=this._input.get_regexp(n,!0),t._update(),t};t.prototype._create=function(){return new t(this._input,this)};t.prototype._update=function(){};n.exports.Pattern=t},function(n){"use strict";function t(n,t){n="string"==typeof n?n:n.source;t="string"==typeof t?t:t.source;this.__directives_block_pattern=new RegExp(n+/ beautify( \w+[:]\w+)+ /.source+t,"g");this.__directive_pattern=/ (\w+)[:](\w+)/g;this.__directives_end_ignore_pattern=new RegExp(n+/\sbeautify\signore:end\s/.source+t,"g")}t.prototype.get_directives=function(n){var i,t;if(!n.match(this.__directives_block_pattern))return null;for(i={},this.__directive_pattern.lastIndex=0,t=this.__directive_pattern.exec(n);t;)i[t[1]]=t[2],t=this.__directive_pattern.exec(n);return i};t.prototype.readIgnored=function(n){return n.readUntilAfter(this.__directives_end_ignore_pattern)};n.exports.Directives=t},function(n,t,i){"use strict";function r(n,t){u.call(this,n,t);this.__template_pattern=null;this._disabled=Object.assign({},f);this._excluded=Object.assign({},f);t&&(this.__template_pattern=this._input.get_regexp(t.__template_pattern),this._excluded=Object.assign(this._excluded,t._excluded),this._disabled=Object.assign(this._disabled,t._disabled));var i=new u(n);this.__patterns={handlebars_comment:i.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:i.starting_with(/{{{/).until_after(/}}}/),handlebars:i.starting_with(/{{/).until_after(/}}/),php:i.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:i.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:i.starting_with(/{%/).until_after(/%}/),django_value:i.starting_with(/{{/).until_after(/}}/),django_comment:i.starting_with(/{#/).until_after(/#}/)}}var u=i(12).Pattern,f={django:!1,erb:!1,handlebars:!1,php:!1};(r.prototype=new u)._create=function(){return new r(this._input,this)};r.prototype._update=function(){this.__set_templated_pattern()};r.prototype.disable=function(n){var t=this._create();return t._disabled[n]=!0,t._update(),t};r.prototype.read_options=function(n){var t=this._create();for(var i in f)t._disabled[i]=-1===n.templating.indexOf(i);return t._update(),t};r.prototype.exclude=function(n){var t=this._create();return t._excluded[n]=!0,t._update(),t};r.prototype.read=function(){for(var t="",t=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern),n=this._read_template();n;)n+=this._match_pattern?this._input.read(this._match_pattern):this._input.readUntil(this.__template_pattern),t+=n,n=this._read_template();return this._until_after&&(t+=this._input.readUntilAfter(this._until_pattern)),t};r.prototype.__set_templated_pattern=function(){var n=[];this._disabled.php||n.push(this.__patterns.php._starting_pattern.source);this._disabled.handlebars||n.push(this.__patterns.handlebars._starting_pattern.source);this._disabled.erb||n.push(this.__patterns.erb._starting_pattern.source);this._disabled.django||(n.push(this.__patterns.django._starting_pattern.source),n.push(this.__patterns.django_value._starting_pattern.source),n.push(this.__patterns.django_comment._starting_pattern.source));this._until_pattern&&n.push(this._until_pattern.source);this.__template_pattern=this._input.get_regexp("(?:"+n.join("|")+")")};r.prototype._read_template=function(){var n="",i=this._input.peek(),t;return"<"===i?(t=this._input.peek(1),this._disabled.php||this._excluded.php||"?"!==t||(n=n||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==t||(n=n||this.__patterns.erb.read())):"{"===i&&(this._disabled.handlebars||this._excluded.handlebars||(n=(n=(n=n||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(n=n||this.__patterns.django_value.read()),this._excluded.django||(n=(n=n||this.__patterns.django_comment.read())||this.__patterns.django.read()))),n};n.exports.TemplatablePattern=r},,,,function(n,t,i){"use strict";var r=i(19).Beautifier,u=i(20).Options;n.exports=function(n,t,i,u){return new r(n,t,i,u).beautify()};n.exports.defaultOptions=function(){return new u}},function(n,t,i){"use strict";function u(n,t){this.indent_level=0;this.alignment_size=0;this.max_preserve_newlines=n.max_preserve_newlines;this.preserve_newlines=n.preserve_newlines;this._output=new l(n,t)}function y(n,t){var i=null,u=null;return t.closed?("script"===n?i="text/javascript":"style"===n&&(i="text/css"),-1<(i=function(n){for(var i=null,t=n.next;t.type!==r.EOF&&n.closed!==t;){if(t.type===r.ATTRIBUTE&&"type"===t.text){t.next&&t.next.type===r.EQUALS&&t.next.next&&t.next.next.type===r.VALUE&&(i=t.next.next.text);break}t=t.next}return i}(t)||i).search("text/css")?u="css":-1<i.search(/(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)?u="javascript":-1<i.search(/(text|application|dojo)\/(x-)?(html)/)?u="html":-1<i.search(/test\/null/)&&(u="null"),u):null}function o(n,t){return-1!==t.indexOf(n)}function p(n,t,i){this.parent=n||null;this.tag=t?t.tag_name:"";this.indent_level=i||0;this.parser_token=t||null}function e(n){this._printer=n;this._current_frame=null}function f(n,t,i,r){this._source_text=n||"";t=t||{};this._js_beautify=i;this._css_beautify=r;this._tag_stack=null;var u=new c(t,"html");this._options=u;this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,5);this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes;this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes;this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes;this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,8);this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}var c=i(20).Options,l=i(2).Output,a=i(21).Tokenizer,r=i(21).TOKEN,h=/\r\n|[\r\n]/,v=/\r\n|[\r\n]/g,s;u.prototype.current_line_has_match=function(n){return this._output.current_line.has_match(n)};u.prototype.set_space_before_token=function(n,t){this._output.space_before_token=n;this._output.non_breaking_space=t};u.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size);this._output.set_wrap_point()};u.prototype.add_raw_token=function(n){this._output.add_raw_token(n)};u.prototype.print_preserved_newlines=function(n){var t=0,i;for(n.type!==r.TEXT&&n.previous.type!==r.TEXT&&(t=n.newlines?1:0),this.preserve_newlines&&(t=n.newlines<this.max_preserve_newlines+1?n.newlines:this.max_preserve_newlines+1),i=0;i<t;i++)this.print_newline(0<i);return 0!==t};u.prototype.traverse_whitespace=function(n){return!(!n.whitespace_before&&!n.newlines)&&(this.print_preserved_newlines(n)||(this._output.space_before_token=!0),!0)};u.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped};u.prototype.print_newline=function(n){this._output.add_new_line(n)};u.prototype.print_token=function(n){n.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(n.text))};u.prototype.indent=function(){this.indent_level++};u.prototype.get_full_indent=function(n){return(n=this.indent_level+(n||0))<1?"":this._output.get_indent_string(n)};e.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null};e.prototype.record_tag=function(n){var t=new p(this._current_frame,n,this._printer.indent_level);this._current_frame=t};e.prototype._try_pop_frame=function(n){var t=null;return n&&(t=n.parser_token,this._printer.indent_level=n.indent_level,this._current_frame=n.parent),t};e.prototype._get_frame=function(n,t){for(var i=this._current_frame;i&&-1===n.indexOf(i.tag);){if(t&&-1!==t.indexOf(i.tag)){i=null;break}i=i.parent}return i};e.prototype.try_pop=function(n,t){var i=this._get_frame([n],t);return this._try_pop_frame(i)};e.prototype.indent_to_tag=function(n){var t=this._get_frame(n);t&&(this._printer.indent_level=t.indent_level)};f.prototype.beautify=function(){var t,c,o,n;if(this._options.disabled)return this._source_text;t=this._source_text;c=this._options.eol;"auto"===this._options.eol&&(c="\n",t&&h.test(t)&&(c=t.match(h)[0]));var p=(t=t.replace(v,"\n")).match(/^[\t ]*/)[0],y={text:"",type:""},f=new s,i=new u(this._options,p),l=new a(t,this._options).tokenize();for(this._tag_stack=new e(i),o=null,n=l.next();n.type!==r.EOF;)n.type===r.TAG_OPEN||n.type===r.COMMENT?f=o=this._handle_tag_open(i,n,f,y):n.type===r.ATTRIBUTE||n.type===r.EQUALS||n.type===r.VALUE||n.type===r.TEXT&&!f.tag_complete?o=this._handle_inside_tag(i,n,f,l):n.type===r.TAG_CLOSE?o=this._handle_tag_close(i,n,f):n.type===r.TEXT?o=this._handle_text(i,n,f):i.add_raw_token(n),y=o,n=l.next();return i._output.get_code(c)};f.prototype._handle_tag_close=function(n,t,i){var r={text:t.text,type:t.type};return n.alignment_size=0,i.tag_complete=!0,n.set_space_before_token(t.newlines||""!==t.whitespace_before,!0),i.is_unformatted?n.add_raw_token(t):("<"===i.tag_start_char&&(n.set_space_before_token("/"===t.text[0],!0),this._is_wrap_attributes_force_expand_multiline&&i.has_wrapped_attrs&&n.print_newline(!1)),n.print_token(t)),!i.indent_content||i.is_unformatted||i.is_content_unformatted||(n.indent(),i.indent_content=!1),i.is_inline_element||i.is_unformatted||i.is_content_unformatted||n.set_wrap_point(),r};f.prototype._handle_inside_tag=function(n,t,i,u){var f=i.has_wrapped_attrs,c={text:t.text,type:t.type},o,s,h,e;if(n.set_space_before_token(t.newlines||""!==t.whitespace_before,!0),i.is_unformatted)n.add_raw_token(t);else if("{"===i.tag_start_char&&t.type===r.TEXT)n.print_preserved_newlines(t)?(t.newlines=0,n.add_raw_token(t)):n.print_token(t);else{if(t.type===r.ATTRIBUTE?(n.set_space_before_token(!0),i.attr_count+=1):t.type===r.EQUALS?n.set_space_before_token(!1):t.type===r.VALUE&&t.previous.type===r.EQUALS&&n.set_space_before_token(!1),t.type===r.ATTRIBUTE&&"<"===i.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(n.traverse_whitespace(t),f=f||0!==t.newlines),this._is_wrap_attributes_force)){if(o=1<i.attr_count,this._is_wrap_attributes_force_expand_multiline&&1===i.attr_count){h=!0;e=0;do{if((s=u.peek(e)).type===r.ATTRIBUTE){h=!1;break}e+=1}while(e<4&&s.type!==r.EOF&&s.type!==r.TAG_CLOSE);o=!h}o&&(n.print_newline(!1),f=!0)}n.print_token(t);f=f||n.previous_token_wrapped();i.has_wrapped_attrs=f}return c};f.prototype._handle_text=function(n,t,i){var r={text:t.text,type:"TK_CONTENT"};return i.custom_beautifier_name?this._print_custom_beatifier_text(n,t,i):i.is_unformatted||i.is_content_unformatted?n.add_raw_token(t):(n.traverse_whitespace(t),n.print_token(t)),r};f.prototype._print_custom_beatifier_text=function(n,t,i){var v=this,e,u,l,a;if(""!==t.text){var o,r=t.text,h=1,s="",c="";if("javascript"===i.custom_beautifier_name&&"function"==typeof this._js_beautify?o=this._js_beautify:"css"===i.custom_beautifier_name&&"function"==typeof this._css_beautify?o=this._css_beautify:"html"===i.custom_beautifier_name&&(o=function(n,t){return new f(n,t,v._js_beautify,v._css_beautify).beautify()}),"keep"===this._options.indent_scripts?h=0:"separate"===this._options.indent_scripts&&(h=-n.indent_level),e=n.get_full_indent(h),r=r.replace(/\n[ \t]*$/,""),"html"!==i.custom_beautifier_name&&"<"===r[0]&&r.match(/^(<!--|<!\[CDATA\[)/)){if(u=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(r),!u)return void n.add_raw_token(t);s=e+u[1]+"\n";r=u[4];u[5]&&(c=e+u[5]);r=r.replace(/\n[ \t]*$/,"");(u[2]||-1!==u[3].indexOf("\n"))&&(u=u[3].match(/[ \t]+$/))&&(t.whitespace_before=u[0])}r&&(o?(l=function(){this.eol="\n"},l.prototype=this._options.raw_options,r=o(e+r,new l)):(a=t.whitespace_before,a&&(r=r.replace(new RegExp("\n("+a+")?","g"),"\n")),r=e+r.replace(/\n/g,"\n"+e)));s&&(r=r?s+r+"\n"+c:s+c);n.print_newline(!1);r&&(t.text=r,t.whitespace_before="",t.newlines=0,n.add_raw_token(t),n.print_newline(!0))}};f.prototype._handle_tag_open=function(n,t,i,u){var f=this._get_tag_open_token(t);return(i.is_unformatted||i.is_content_unformatted)&&t.type===r.TAG_OPEN&&0===t.text.indexOf("<\/")?n.add_raw_token(t):(n.traverse_whitespace(t),this._set_tag_position(n,t,f,i,u),f.is_inline_element||n.set_wrap_point(),n.print_token(t)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(f.alignment_size=t.text.length+1),f.tag_complete||f.is_unformatted||(n.alignment_size=f.alignment_size),f};s=function(n,t){var i;(this.parent=n||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",t)?(this.tag_start_char=t.text[0],this.text=t.text,i="<"===this.tag_start_char?t.text.match(/^<([^\s>]*)/):t.text.match(/^{{[#\^]?([^\s}]+)/),this.tag_check=i?i[1]:"",this.tag_check=this.tag_check.toLowerCase(),t.type===r.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||t.closed&&"/>"===t.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0};f.prototype._get_tag_open_token=function(n){var t=new s(this._tag_stack.get_parser_token(),n);return t.alignment_size=this._options.wrap_attributes_indent_size,t.is_end_tag=t.is_end_tag||o(t.tag_check,this._options.void_elements),t.is_empty_element=t.tag_complete||t.is_start_tag&&t.is_end_tag,t.is_unformatted=!t.tag_complete&&o(t.tag_check,this._options.unformatted),t.is_content_unformatted=!t.is_empty_element&&o(t.tag_check,this._options.content_unformatted),t.is_inline_element=o(t.tag_name,this._options.inline)||"{"===t.tag_start_char,t};f.prototype._set_tag_position=function(n,t,i,u,f){(i.is_empty_element||(i.is_end_tag?i.start_tag_token=this._tag_stack.try_pop(i.tag_name):(this._do_optional_end_element(i)&&(i.is_inline_element||(i.parent&&(i.parent.multiline_content=!0),n.print_newline(!1))),this._tag_stack.record_tag(i),"script"!==i.tag_name&&"style"!==i.tag_name||i.is_unformatted||i.is_content_unformatted||(i.custom_beautifier_name=y(i.tag_check,t)))),o(i.tag_check,this._options.extra_liners)&&(n.print_newline(!1),n._output.just_added_blankline()||n.print_newline(!0)),i.is_empty_element)?("{"===i.tag_start_char&&"else"===i.tag_check&&(this._tag_stack.indent_to_tag(["if","unless","each"]),i.indent_content=!0,n.current_line_has_match(/{{#if/)||n.print_newline(!1)),"!--"===i.tag_name&&f.type===r.TAG_CLOSE&&u.is_end_tag&&-1===i.text.indexOf("\n")||i.is_inline_element||i.is_unformatted||n.print_newline(!1)):i.is_unformatted||i.is_content_unformatted?i.is_inline_element||i.is_unformatted||n.print_newline(!1):i.is_end_tag?(i.start_tag_token&&i.start_tag_token.multiline_content||!(i.is_inline_element||u.is_inline_element||f.type===r.TAG_CLOSE&&i.start_tag_token===u||"TK_CONTENT"===f.type))&&n.print_newline(!1):(i.indent_content=!i.custom_beautifier_name,"<"===i.tag_start_char&&("html"===i.tag_name?i.indent_content=this._options.indent_inner_html:"head"===i.tag_name?i.indent_content=this._options.indent_head_inner_html:"body"===i.tag_name&&(i.indent_content=this._options.indent_body_inner_html)),i.is_inline_element||"TK_CONTENT"===f.type||(i.parent&&(i.parent.multiline_content=!0),n.print_newline(!1)))};f.prototype._do_optional_end_element=function(n){var t=null;if(!n.is_empty_element&&n.is_start_tag&&n.parent)return"body"===n.tag_name?t=t||this._tag_stack.try_pop("head"):"li"===n.tag_name?t=t||this._tag_stack.try_pop("li",["ol","ul"]):"dd"===n.tag_name||"dt"===n.tag_name?t=(t=t||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]):"rp"===n.tag_name||"rt"===n.tag_name?t=(t=t||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===n.tag_name?t=t||this._tag_stack.try_pop("optgroup",["select"]):"option"===n.tag_name?t=t||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===n.tag_name?t=t||this._tag_stack.try_pop("caption",["table"]):"thead"===n.tag_name?t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===n.tag_name||"tfoot"===n.tag_name?t=(t=(t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===n.tag_name?t=(t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==n.tag_name&&"td"!==n.tag_name||(t=(t=t||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"])),n.parent=this._tag_stack.get_parser_token(),t};n.exports.Beautifier=f},function(n,t,i){"use strict";function u(n){r.call(this,n,"html");1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]);this.indent_inner_html=this._get_boolean("indent_inner_html");this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0);this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0);this.indent_handlebars=this._get_boolean("indent_handlebars",!0);this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]);this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size);this.extra_liners=this._get_array("extra_liners",["head","body","/html"]);this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]);this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]);this.unformatted=this._get_array("unformatted",[]);this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]);this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter");this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}var r=i(6).Options;u.prototype=new r;n.exports.Options=u},function(n,t,i){"use strict";function u(n,t){var r,i,u;e.call(this,n,t);this._current_tag_name="";r=new h(this._input).read_options(this._options);i=new c(this._input);(this.__patterns={word:r.until(/[\n\r\t <]/),single_quote:r.until_after(/'/),double_quote:r.until_after(/"/),attribute:r.until(/[\n\r\t =>]|\/>/),element_name:r.until(/[\n\r\t >\/]/),handlebars_comment:i.starting_with(/{{!--/).until_after(/--}}/),handlebars:i.starting_with(/{{/).until_after(/}}/),handlebars_open:i.until(/[\n\r\t }]/),handlebars_raw_close:i.until(/}}/),comment:i.starting_with(/<!--/).until_after(/-->/),cdata:i.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:i.starting_with(/<!\[/).until_after(/]>/),processing:i.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter)&&(u=this._input.get_literal_regexp(this._options.unformatted_content_delimiter),this.__patterns.unformatted_content_delimiter=i.matching(u).until_after(u))}var e=i(9).Tokenizer,f=i(9).TOKEN,s=i(13).Directives,h=i(14).TemplatablePattern,c=i(12).Pattern,r={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:f.START,RAW:f.RAW,EOF:f.EOF},o=new s(/<\!--/,/-->/);(u.prototype=new e)._is_comment=function(){return!1};u.prototype._is_opening=function(n){return n.type===r.TAG_OPEN};u.prototype._is_closing=function(n,t){return n.type===r.TAG_CLOSE&&t&&((">"===n.text||"/>"===n.text)&&"<"===t.text[0]||"}}"===n.text&&"{"===t.text[0]&&"{"===t.text[1])};u.prototype._reset=function(){this._current_tag_name=""};u.prototype._get_next_token=function(n,t){var i=null,u;return this._readWhitespace(),u=this._input.peek(),null===u?this._create_token(r.EOF,""):i=(i=(i=(i=(i=(i=(i=(i=(i=i||this._read_open_handlebars(u,t))||this._read_attribute(u,n,t))||this._read_raw_content(u,n,t))||this._read_close(u,t))||this._read_content_word(u))||this._read_comment_or_cdata(u))||this._read_processing(u))||this._read_open(u,t))||this._create_token(r.UNKNOWN,this._input.next())};u.prototype._read_comment_or_cdata=function(n){var u=null,t=null,i=null;return"<"===n&&("!"===this._input.peek(1)&&((t=this.__patterns.comment.read())?(i=o.get_directives(t))&&"start"===i.ignore&&(t+=o.readIgnored(this._input)):t=this.__patterns.cdata.read()),t&&((u=this._create_token(r.COMMENT,t)).directives=i)),u};u.prototype._read_processing=function(n){var u=null,t=null,i;return"<"===n&&(i=this._input.peek(1),"!"!==i&&"?"!==i||(t=(t=this.__patterns.conditional_comment.read())||this.__patterns.processing.read()),t&&((u=this._create_token(r.COMMENT,t)).directives=null)),u};u.prototype._read_open=function(n,t){var i=null,u=null;return t||"<"===n&&(i=this._input.next(),"/"===this._input.peek()&&(i+=this._input.next()),i+=this.__patterns.element_name.read(),u=this._create_token(r.TAG_OPEN,i)),u};u.prototype._read_open_handlebars=function(n,t){var i=null,u=null;return t||this._options.indent_handlebars&&"{"===n&&"{"===this._input.peek(1)&&(u="!"===this._input.peek(2)?(i=(i=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),this._create_token(r.COMMENT,i)):(i=this.__patterns.handlebars_open.read(),this._create_token(r.TAG_OPEN,i))),u};u.prototype._read_close=function(n,t){var i=null,u=null;return t&&("<"===t.text[0]&&(">"===n||"/"===n&&">"===this._input.peek(1))?(i=this._input.next(),"/"===n&&(i+=this._input.next()),u=this._create_token(r.TAG_CLOSE,i)):"{"===t.text[0]&&"}"===n&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),u=this._create_token(r.TAG_CLOSE,"}}"))),u};u.prototype._read_attribute=function(n,t,i){var u=null,f="",e;return i&&"<"===i.text[0]&&("="===n?u=this._create_token(r.EQUALS,this._input.next()):'"'===n||"'"===n?(e=this._input.next(),e+='"'===n?this.__patterns.double_quote.read():this.__patterns.single_quote.read(),u=this._create_token(r.VALUE,e)):(f=this.__patterns.attribute.read())&&(u=t.type===r.EQUALS?this._create_token(r.VALUE,f):this._create_token(r.ATTRIBUTE,f))),u};u.prototype._is_content_unformatted=function(n){return-1===this._options.void_elements.indexOf(n)&&(-1!==this._options.content_unformatted.indexOf(n)||-1!==this._options.unformatted.indexOf(n))};u.prototype._read_raw_content=function(n,t,i){var f="",u,e;if(i&&"{"===i.text[0])f=this.__patterns.handlebars_raw_close.read();else if(t.type===r.TAG_CLOSE&&"<"===t.opened.text[0])if(u=t.opened.text.substr(1).toLowerCase(),"script"===u||"style"===u){if(e=this._read_comment_or_cdata(n),e)return e.type=r.TEXT,e;f=this._input.readUntil(new RegExp("<\/"+u+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(u)&&(f=this._input.readUntil(new RegExp("<\/"+u+"[\\n\\r\\t ]*?>","ig")));return f?this._create_token(r.TEXT,f):null};u.prototype._read_content_word=function(n){var t="";if(this._options.unformatted_content_delimiter&&n===this._options.unformatted_content_delimiter[0]&&(t=this.__patterns.unformatted_content_delimiter.read()),t=t||this.__patterns.word.read())return this._create_token(r.TEXT,t)};n.exports.Tokenizer=u;n.exports.TOKEN=r}],n.c=t,n.d=function(t,i,r){n.o(t,i)||Object.defineProperty(t,i,{enumerable:!0,get:r})},n.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},n.t=function(t,i){var r,u;if((1&i&&(t=n(t)),8&i)||4&i&&"object"==typeof t&&t&&t.__esModule)return t;if(r=Object.create(null),n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:t}),2&i&&"string"!=typeof t)for(u in t)n.d(r,u,function(n){return t[n]}.bind(null,u));return r},n.n=function(t){var i=t&&t.__esModule?function(){return t.default}:function(){return t};return n.d(i,"a",i),i},n.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},n.p="",n(n.s=18)),u,f;"function"==typeof define&&define.amd?define(["require","./beautify","./beautify-css"],function(n){var t=n("./beautify"),r=n("./beautify-css");return{html_beautify:function(n,u){return i(n,u,t.js_beautify,r.css_beautify)}}}):"undefined"!=typeof exports?(u=require("./beautify.js"),f=require("./beautify-css.js"),exports.html_beautify=function(n,t){return i(n,t,u.js_beautify,f.css_beautify)}):"undefined"!=typeof window?window.html_beautify=function(n,t){return i(n,t,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(n,t){return i(n,t,global.js_beautify,global.css_beautify)})}(),function(n){var t;(function(n){var t;(function(n){n[n.Number=0]="Number";n[n.Boolean=1]="Boolean";n[n.DateTime=2]="DateTime";n[n.String=3]="String"})(t=n.SupportedDataType||(n.SupportedDataType={}))})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));InternalBrowseDialog=function(){function n(n){this.id=null;this.category=[];this.selectedFile=null;this.targetInstance=null;this.targetMethod=null;this.targetType=null;this.browseDialog=null;this.filePath=null;this.fileContainer=null;this.backNodeReference=[];this.forwardNodeReference=[];this.footerTag=null;this.nameWaterMark="Dashboard Name";this.outerContainer=null;this.isShowAutoCompleteLoader=!0;this.locale=null;this.ejBrowseScroller=null;this.ejBrowseWaitingPopup=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id;this.renderSaveDashboardDialog();this.unwireEvents();this.wireEvents()}return n.prototype.renderBrowseDialog=function(){var u=this.browseDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_browse_dialog"}),h=BoldBIDashboard.buildTag("div","",{}),t=BoldBIDashboard.buildTag("div","",{display:"table-row"},{id:this.id+"_browse_file_area"}),c=BoldBIDashboard.buildTag("table","",{"margin-left":"10px","border-spacing":"0px"},{unselectable:"on"}),l=BoldBIDashboard.buildTag("tr","",{height:"30px"}),a=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"}),v=BoldBIDashboard.buildTag("span","",{"margin-top":"4px"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-backward bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_back_icon"}),f,e,o,s,ft,et;a.append(v);v.bind("click",this.bbdesigner$.proxy(this.backOperation,this));f=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"});e=BoldBIDashboard.buildTag("span","",{"margin-top":"4px"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-forward bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_forward_icon"});f.append(e);e.bind("click",this.bbdesigner$.proxy(this.forwardOperation,this));o=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"});s=BoldBIDashboard.buildTag("div","",{display:"block","margin-left":"-5px",cursor:"default","margin-top":"4px"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-reload bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_reload_icon"});o.append(s);s.bind("click",this.bbdesigner$.proxy(this.reloadCategory,this));var y=BoldBIDashboard.buildTag("td","",{width:"300px"}),p=BoldBIDashboard.buildTag("div.bbi-designer-border","",{border:"0.5px solid #cbcbcb",height:"25px",width:"652px","background-color":"white","margin-left":"-12px","margin-top":"1px",display:"inline-flex"},{}),w=BoldBIDashboard.buildTag("div","",{"padding-right":"5px","padding-left":"7px","padding-top":"3px"},{id:this.id+"_folder_icon_div"}),b=BoldBIDashboard.buildTag("span.bbi-headericon bbi-designer-dataset-openfolder","",{"font-size":"14px"},{id:this.id+"_folderIcon"}),ot=this.filePath=BoldBIDashboard.buildTag("input.bbi-designer-browse-path","",{height:"20px",width:"618px"},{type:"text",id:this.id+"_browse_file_path",disabled:!0});w.append(b);p.append(w).append(ot);b.attr("disabled","true").css("opacity","0.3");y.append(p);l.append(a).append(f).append(o).append(y);var i=this.outerContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{"border-top":"0.5px solid #cbcbcb","padding-left":"10px",height:"355px","background-color":"white",width:"750px","margin-top":"0.5px"},{id:this.id+"_browse_outer_div"}),k=BoldBIDashboard.buildTag("div.bbi-designer-emptyfile","",{display:"none",width:"100%",height:"100%","margin-left":"-10px"},{id:this.id+"_browse_fileEmpty_msg"}),st=BoldBIDashboard.buildTag("div.bbi-designer-empty-folder","This category is empty",{display:"table-cell",width:"100%",height:"100%"}),d=BoldBIDashboard.buildTag("div.e-file-area","",{}),ht=this.fileContainer=BoldBIDashboard.buildTag("div","",{height:"355px",width:"750px"},{id:this.id+"_browse_file_container"});d.append(ht);k.append(st);i.append(d).append(k);var r=BoldBIDashboard.buildTag("table","",{"border-spacing":"0px",width:"100%"},{}),g=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("td","",{},{}),nt=BoldBIDashboard.buildTag("tr","",{},{}),tt=BoldBIDashboard.buildTag("tr","",{},{}),ct=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Name",{"font-size":"13px",overflow:"hidden",float:"left",padding:"6px 7px 6px 0px","white-space":"nowrap","text-overflow":"ellipsis"}),it=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt","",{height:"25px","margin-top":"1px","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box"},{id:this.id+"_browse_save",type:"text",tabindex:1}),rt=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor","Cancel",{float:"right","margin-left":"12px"},{id:this.id+"_browse_btn_cancel",tabindex:4,type:"button"}),ut=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor","Open",{float:"right","margin-left":"5px"},{id:this.id+"_browse_btn_import",tabindex:3,type:"button"});g.append(n.clone().append(ct).css({"padding-bottom":"5px",width:"75px"}),n.clone().append(it).css("padding-bottom","5px").attr("colspan","3"));ft=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Description",{"font-size":"13px",overflow:"hidden",float:"left",padding:"6px 7px 6px 0px","white-space":"nowrap","text-overflow":"ellipsis"});et=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt","",{height:"25px","margin-top":"1px","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box"},{id:this.id+"_browse_save_desc",type:"text",tabindex:2});nt.append(n.clone().append(ft).css({"padding-bottom":"5px",width:"75px"}),n.clone().append(et).css("padding-bottom","5px").attr("colspan","3"));tt.append(n.clone().attr("colspan","3"),n.clone().append(rt).append(ut));r.append(g);r.append(nt);r.append(tt);c.append(l);t.append(c).append(i);h.append(t);u.append(h);this.dashboardDesigner.element.append(u);u.BoldBIDashboardDialog({minWidth:760,minHeight:250,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",beforeClose:this.bbdesigner$.proxy(this.hideWaitingPopup,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});this.footerTag=this.bbdesigner$("#"+this.id+"_browse_dialog_foot");this.footerTag.append(r);rt.BoldBIDashboardButton({cssClass:"bbi-designer-cancelbtn",showRoundedCorner:!1,size:"mini",click:this.bbdesigner$.proxy(this.closeDialog,this)});ut.BoldBIDashboardButton({cssClass:"bbi-designer-okbtn",showRoundedCorner:!1,size:"mini",click:this.bbdesigner$.proxy(this.updateFileInfo,this)});t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()});i.BoldBIDashboardScroller({height:"355px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize});this.ejBrowseScroller=i.data("BoldBIDashboardScroller");this.ejBrowseWaitingPopup=t.data("BoldBIDashboardWaitingPopup");BoldBIDashboard.DashboardUtil.txtWaterMark(it,this.nameWaterMark)},n.prototype.reloadCategory=function(n){this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val();this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val();this.resetBrowseDialog(!0);this.loadCategory(n)},n.prototype.iconDisable=function(n,t){t?n.attr("disabled","true").css("opacity","0.3"):n.removeAttr("disabled").css("opacity","1")},n.prototype.backOperation=function(){var n,t,i;this.bbdesigner$("#"+this.id+"_browse_back_icon").attr("disabled")!=="disabled"&&(this.fileContainer.empty(),n=null,this.backNodeReference.length>0&&(t=this.backNodeReference.pop(),n=this.nodeSearch(t.ParentId,this.category,BoldBIDashboard.isNullOrUndefined(t.ParentId)&&!BoldBIDashboard.isNullOrUndefined(t.Name)?!0:!1),n.Files.length>0?(this.showReportFile(!0),this.nodeCreation(n.Files,n.Id),this.browseType!==BrowseType.Open||BoldBIDashboard.isNullOrUndefined(n.Type)||n.Type!==1||BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),this.ejBrowseScroller!==null&&this.ejBrowseScroller.refresh()):this.showReportFile(!1),i=this.filePath.val().split("/"),i[i.length-1]===t.Name&&this.bbdesigner$("#"+this.id+"_file_"+t.Id).addClass("bbi-designer-report-selection"),this.forwardNodeReference.push(t),i.pop(),this.filePath.val(i.join("/")),this.backNodeReference.length===0&&(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!0),this.filePath.val("/")),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!1),BoldBIDashboard.isNullOrUndefined(this.selectedFile)||this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.saveMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.openMenu)))},n.prototype.nodeSearch=function(n,t,i){for(var r,e,u={Files:[],Id:null,Type:null},f=0;f<t.length;f++){if(r=t[f],BoldBIDashboard.isNullOrUndefined(n)&&i)return u.Files=this.category,u.Type=r.Type,u;if(n===r.Id)return u.Files=r.Files,u.Id=r.Id,u.Type=r.Type,u;if(r.Files.length>0)if(e=this.nodeSearch(n,r.Files),e===null)continue;else return e}return null},n.prototype.forwardOperation=function(){var i,n,t,r;this.bbdesigner$("#"+this.id+"_browse_forward_icon").attr("disabled")!=="disabled"&&(this.fileContainer.empty(),i=null,n=null,this.forwardNodeReference.length>0&&(t=this.forwardNodeReference.pop(),n=this.nodeSearch(t.Id,this.category),n.Files.length>0?(this.showReportFile(!0),this.nodeCreation(n.Files,n.Id),this.browseType!==BrowseType.Open||BoldBIDashboard.isNullOrUndefined(n.Type)||n.Type!==1||BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),this.ejBrowseScroller!==null&&this.ejBrowseScroller.refresh()):this.showReportFile(!1),r=this.filePath.val(),this.filePath.val((r==="/"?"":r)+"/"+t.Name),this.forwardNodeReference.length>0&&(i=this.forwardNodeReference[this.forwardNodeReference.length-1].Id),this.bbdesigner$("#"+this.id+"_file_"+i).addClass("bbi-designer-report-selection"),this.backNodeReference.push(t),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),this.forwardNodeReference.length===0&&this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu)))},n.prototype.fileSelection=function(n,t){var i,r;this.forwardNodeReference=[];!BoldBIDashboard.isNullOrUndefined(n)&&BoldBIDashboard.isNullOrUndefined(n.isEmpty)?n.Type===2&&this.browseType===BrowseType.Open?(this.selectedFile=n,this.updateFileInfo()):n.Type===2&&this.browseType===BrowseType.Publish?(this.bbdesigner$("#"+this.id+"_browse_save").val(n.Name),this.updateWaterMark()):(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),i=this.filePath.val(),this.filePath.val((i==="/"?"":i)+"/"+n.Name),this.fileContainer.empty(),this.showReportFile(!0),n.Files&&n.Files.length>0&&this.nodeCreation(n.Files,n.Id),r={Id:n.Id,Name:n.Name,ParentId:t,Type:n.Type},this.backNodeReference.push(r),this.ejBrowseScroller!==null&&this.ejBrowseScroller.refresh()):(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),i=this.filePath.val(),this.filePath.val((i==="/"?"":i)+"/"+n.files.Name),this.fileContainer.empty(),this.showReportFile(!1),r={Id:n.files.Id,Name:n.files.Name,ParentId:n.files.parentId,Type:n.files.Type},this.backNodeReference.push(r))},n.prototype.showReportFile=function(n){n?(this.outerContainer.find(".e-file-area").css("display","block"),this.outerContainer.find(".bbi-designer-emptyfile").css("display","none")):(this.outerContainer.find(".e-file-area").css("display","none"),this.outerContainer.find(".bbi-designer-emptyfile").css("display","table"))},n.prototype.nodeCreation=function(n,t){var i,r,f,u;if(!BoldBIDashboard.isNullOrUndefined(n))for(i=0;i<n.length;i++)r=BoldBIDashboard.buildTag("div.bbi-designer-browse","",{margin:"12px 7.5px 0px 7.5px",padding:"7px",width:"74px",height:"74px","text-align":"center","line-height":"normal","vertical-align":"middle",float:"left",display:"table-cell"},{id:this.id+"_file_"+n[i].Id}),f=BoldBIDashboard.buildTag("div.bbi-designer-tile","",{width:"74px","padding-top":"2px",display:"inline-block","font-size":"50px"},{id:this.id+"_file_icon_"+n[i].Id}),this.getIcon(f,n[i].Type),u=BoldBIDashboard.buildTag("span",n[i].Name,{width:"74px","padding-top":"5px",display:"inline-block","text-align":"center","font-size":"11px",height:"20px"},{id:this.id+"_"+n[i].Id}),u.addClass(BoldBIDashboard.DashboardUtil.textWidth(n[i].Name,"segoe ui 11px")>96?"e-title-tip bbi-designer-txt-overflow bbi-dbrd-designer-hoverable":"bbi-dbrd-designer-hoverable"),r.append(f).append(u),this.fileContainer.append(r),r.bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.loadDashboardsInCategory,this,n[i],t)),r.bind("click",this.bbdesigner$.proxy(this.selectedFiles,this,n[i])),u.hasClass("e-title-tip")&&u.attr("data-tooltip",n[i].Name)},n.prototype.loadDashboardsInCategory=function(n,t){n.Type===2?(this.bbdesigner$("#"+this.id+"_browse_save").val(n.Name),this.updateFileInfo()):this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(n.Name)},{fnction:this.bbdesigner$.proxy(this.fileSelectionChange,this,n,t),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]},!0,!0)},n.prototype.fileSelectionChange=function(n,t,i){i&&i.Status?(n.Files=JSON.parse(i.Data)||[],this.fileSelection(n,t,i)):this.fileSelection({isEmpty:!0,files:n},t,i);this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu)},n.prototype.getIcon=function(n,t){var r=0,i,u;for(t===1?(r=4,n.addClass("bbi-designer-browse-folder")):t===2&&(r=20,n.addClass("bbi-designer-browse-dbrdfile")),i=0;i<r;i++)u=BoldBIDashboard.buildTag("span","",{},{"class":"path"+(i+1).toString()}),n.append(u)},n.prototype.selectedFiles=function(n,t){(this.bbdesigner$("#"+this.id+"_browse_file_container > div").removeClass("bbi-designer-report-selection"),this.bbdesigner$("#"+t.currentTarget.id).addClass("bbi-designer-report-selection"),this.browseType!==BrowseType.Publish||n.Type===1)&&(this.selectedFile=n,this.browseType===BrowseType.Open&&n.Type!==1||this.browseType===BrowseType.Publish?(this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.openMenu),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0)):this.browseType===BrowseType.Open&&n.Type===1&&BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1))},n.prototype.updateFileInfo=function(){var f,n,e,i,u,t,r;if(this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu)this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(this.selectedFile.Name)},{fnction:this.bbdesigner$.proxy(this.fileSelectionChange,this,this.selectedFile,null),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]},!1,!0);else{if(f=this.bbdesigner$("#"+this.id+"_browse_save").val(),!this.dashboardDesigner.nameValidation(f)){this.dashboardDesigner.modules.util.alertDialog(this.dashboardDesigner.getInvalidNameAlertTitle("dashboardName",!0),this.dashboardDesigner.getInvalidNameAlertTitle("dashboardName",!1),IconType.errors,AlertType.Alert,!1,"");return}if(this.dashboardDesigner.reportFileName=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.model.dashboardName=this.bbdesigner$("#"+this.id+"_browse_save").val(),this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.model.dashboardDescription=this.bbdesigner$("#"+this.id+"_browse_save_desc").val(),this.dashboardDesigner.modules.serialization.notifyChange(),!BoldBIDashboard.isNullOrUndefined(this.selectedFile)&&!BoldBIDashboard.isNullOrUndefined(this.selectedFile.Name))if(this.browseType===BrowseType.Open)this.selectedFile.Name.length>0&&this.selectedFile.Type!==1&&(this.targetInstance!==null?(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,this.filePath.val(),this.targetType]),this.closeDialog()):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{name:this.selectedFile.Name,category:this.filePath.val(),type:BrowseType.Open})));else if(this.browseType===BrowseType.Publish&&(n=this.bbdesigner$("#"+this.id+"_browse_save").val(),e=this.bbdesigner$("#"+this.id+"_browse_save_desc").val(),n=n===this.nameWaterMark?"":n,n&&n.length>0))if(this.filePath.val()==="/"&&this.selectedFile.Type!==1)this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,this.locale.browseDialogMessages.selectCategory,IconType.information,AlertType.Confirm,!1,"");else if(this.selectedFile.Type===1){for(i=this.selectedFile.Files,u=!1,t=0;t<i.length;t++)if(i[t].Type===2&&i[t].Name===n){u=!0;r=this.locale.basicSettings.dashboardExistsError+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace;this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DashboardSaved,r,IconType.question,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:n,id:i[t].Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}});break}u||(this.targetInstance!==null?(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,n,e,!1,null,BoldBIDashboard.DashboardDesignerEvent.SaveAs]),this.closeDialog()):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:this.selectedFile.Name,name:n,categoryId:this.selectedFile.Id,isExist:!1,type:BrowseType.Publish})))}else this.selectedFile.Type===2&&this.selectedFile.Name===n&&(r="'"+this.selectedFile.Name+this.locale.browseDialogMessages.fileExistInCategory+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,r,IconType.warning,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:n,id:this.selectedFile.Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}}))}},n.prototype.updateSaveFile=function(n,t){n&&(this.targetInstance!==null?BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[t.selectedFile,t.fileName,this.dashboardDesigner.dashboardDescription,!0,t.id,t.eventType]):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:t.selectedFile.Name,name:t.fileName,isExist:!0,type:BrowseType.Publish})))},n.prototype.openDialog=function(n,t,i){var r,u;this.resetBrowseDialog(!1);this.callBackfn=t;this.browseDialog.data("BoldBIDashboardDialog").open();this.browseType=n;this.browseDialog.data("BoldBIDashboardDialog").setModel({title:n===BrowseType.Publish?this.locale.browseDialogMessages.publishDashboard:this.locale.browseDialogMessages.selectDashboard});this.enableSave(n===BrowseType.Publish);!BoldBIDashboard.isNullOrUndefined(i)&&i.length>0&&n===BrowseType.Publish&&(r=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").data("BoldBIDashboardAutocomplete"),r.option("value",this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name),u=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,this.bbdesigner$("#"+this.id+"_browse_save_desc").val(u));this.selectCategory();this.loadCategory();this.updateWaterMark()},n.prototype.openBrowseDialog=function(n,t,i,r,u){var f,e;this.resetBrowseDialog(!1);this.targetInstance=n;this.targetMethod=t;this.targetType=r;this.browseType=i;this.browseDialog.data("BoldBIDashboardDialog").setModel({title:i===BrowseType.Publish?this.locale.browseDialogMessages.publishDashboard:this.locale.browseDialogMessages.selectDashboard});this.enableSave(i===BrowseType.Publish);!BoldBIDashboard.isNullOrUndefined(u)&&u.length>0&&i===BrowseType.Publish&&(f=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").data("BoldBIDashboardAutocomplete"),f.option("value",this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name),e=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,this.bbdesigner$("#"+this.id+"_browse_save_desc").val(e));BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.serverCategory)&&this.selectCategory();this.loadCategory(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.serverCategory)?null:this.dashboardDesigner.serverCategory.category);this.updateWaterMark()},n.prototype.updateWaterMark=function(){var t=this.dashboardDesigner.element.find("#"+this.id+"_browse_save"),n=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc");t.hasClass("bbi-designer-txtmark")&&n.removeClass("bbi-designer-txtmark");n.removeClass("bbi-designer-txtmark")},n.prototype.updateCategorySelection=function(n){var r,t,u,i;BoldBIDashboard.isNullOrUndefined(n)||n===""||(r=this.fileContainer.find(".e-dbrd-select-category-drpdwn"),t=r.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(t)||(u=t.model.dataSource,i=this.bbdesigner$.map(u,function(t,i){return t.itemName===n?i:null}),BoldBIDashboard.isNullOrUndefined(i)||t.option("selectedItemIndex",i)))},n.prototype.resetBrowseDialog=function(n){this.category=[];n||(this.targetInstance=null,this.targetMethod=null,this.targetType=null,this.callBackfn=null);this.backNodeReference=[];this.forwardNodeReference=[];this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0);this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!0);var t=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,i=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").data("BoldBIDashboardAutocomplete");i.option("value",this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name);this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val(t);this.showReportFile(!0);this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu);this.fileContainer.find(".bbi-browse-err").css("display","none");this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","none")},n.prototype.hideWaitingPopup=function(){this.bbdesigner$("#"+this.id+"_browse_file_area").data("BoldBIDashboardWaitingPopup")&&this.bbdesigner$("#"+this.id+"_browse_file_area").data("BoldBIDashboardWaitingPopup").hide()},n.prototype.closeDialog=function(){var n=this.browseDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(n)||n.close()},n.prototype.loadCategory=function(n){this.browseDialog.data("BoldBIDashboardDialog").isOpen()||this.browseDialog.data("BoldBIDashboardDialog").open();this.getCategoryInfo(n)},n.prototype.getCategoryInfo=function(n){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(""),ignoreAlertDialog:!0},{fnction:this.bbdesigner$.proxy(this.populateCategory,this,n),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)],errfnction:this.bbdesigner$.proxy(this.categoryLoadingErr,this)},!1,!0)},n.prototype.populateCategory=function(n,t){this.footerTag.find(".bbi-designer-categoryErrWrap").hide();t&&t.ApiStatus&&(!BoldBIDashboard.isNullOrUndefined(t.Data)&&t.Status?(this.category=JSON.parse(t.Data),this.categoryDataUpdate(this.category),n=BoldBIDashboard.isNullOrUndefined(n)?!BoldBIDashboard.isNullOrUndefined(this.category)&&this.category.length>0?this.category[0].Name.toString():n:n,this.updateCategorySelection(n),this.ejBrowseScroller!==null&&this.ejBrowseScroller.refresh()):t.StatusCode==="2042"?(this.fileContainer.find(".e-dbrd-notvalidcategory").text(this.locale.browseDialogMessages.createCategory),this.validateCategory()):this.populateCategoryErr(t.Message))},n.prototype.enableSave=function(n){n?(this.bbdesigner$("#"+this.id+"_browse_save").css("display","block"),this.bbdesigner$("#"+this.id+"_browse_save_desc").css("display","block"),this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.browseDialogMessages.publishText)):(this.bbdesigner$("#"+this.id+"_browse_save").css("display","none"),this.bbdesigner$("#"+this.id+"_browse_save_desc").css("display","none"),this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.browseDialogMessages.openText))},n.prototype.showLoadingIndicator=function(){this.browseDialog.data("BoldBIDashboardDialog").isOpen()&&(BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_cancel"),!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),this.browseType===BrowseType.Publish&&(this.bbdesigner$("#"+this.id+"_browse_save").attr("disabled","true").css("opacity","0.3"),this.bbdesigner$("#"+this.id+"_browse_save_desc").attr("disabled","true").css("opacity","0.3")),this.ejBrowseWaitingPopup.show())},n.prototype.hideLoadingIndicator=function(){this.ejBrowseWaitingPopup.hide();BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_cancel"),!0);BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0);this.browseType===BrowseType.Publish&&(this.bbdesigner$("#"+this.id+"_browse_save").removeAttr("disabled").css("opacity","1"),this.bbdesigner$("#"+this.id+"_browse_save_desc").removeAttr("disabled").css("opacity","1"))},n.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.browseDialog);this.browseDialog.length>0&&this.bbdesigner$("#"+this.id+"_browse_dialog").remove();this.unwireEvents()},n.prototype.renderSaveDashboardDialog=function(){var t,n,e,o;this.browseDialog=BoldBIDashboard.buildTag("div.bbi-userselect e-browse-dlg","",{},{id:this.id+"_browse_dialog"});t=BoldBIDashboard.buildTag("div","",{});n=BoldBIDashboard.buildTag("div","",{display:"table-row"},{id:this.id+"_browse_file_area"});this.outerContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control e-outercontainer","",{},{id:this.id+"_browse_outer_div"});var r=BoldBIDashboard.buildTag("div.bbi-designer-emptyfile","",{},{id:this.id+"_browse_fileEmpty_msg"}),s=BoldBIDashboard.buildTag("div.bbi-designer-empty-folder",this.locale.browseDialogMessages.categoryEmptyMsg,{}),u=BoldBIDashboard.buildTag("div.e-file-area","",{});this.fileContainer=BoldBIDashboard.buildTag("div.bbi-browse-dlg-filecontainer","",{},{id:this.id+"_browse_file_container"});u.append(this.fileContainer);r.append(s);this.outerContainer.append(u).append(r);var i=BoldBIDashboard.buildTag("div.bbi-browse-dialog-content-table","",{},{}),h=this.getCategoryRow(),c=this.getNameRow(),l=this.getDescRow();i.append(h,c,l);this.dashboardDesigner.model.enablePublicDashboardSetting?i.append(this.getMarkAsPublicRow()):this.outerContainer.css("height","230px");this.fileContainer.append(i);var f=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-categoryErrWrap","",{}),a=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-categoryErrMsg","",{}),v=BoldBIDashboard.buildTag("a.bbi-designer-fontfamily bbi-designer-categoryRetryLink",this.locale.browseDialogMessages.retryText,{});f.append(a,v);e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-browse-dlg-cancel-btn",this.locale.browseDialogMessages.cancelBtnText,{},{id:this.id+"_browse_btn_cancel",tabindex:4,type:"button"});o=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small bbi-browse-dlg-save-btn",this.locale.browseDialogMessages.openBtnText,{},{id:this.id+"_browse_btn_import",tabindex:3,type:"button"});n.append(this.outerContainer);t.append(n);this.browseDialog.append(t);this.browseDialog.BoldBIDashboardDialog({minWidth:700,minHeight:250,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",beforeClose:this.bbdesigner$.proxy(this.hideWaitingPopup,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_browse_dialog_foot");this.footerTag.append(f,e,o);n.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()});this.ejBrowseWaitingPopup=n.data("BoldBIDashboardWaitingPopup");this.fileContainer.find(".e-dbrd-browse-savenametxt").BoldBIDashboardAutocomplete({dataSource:[],enableAutoFill:!0,showLoadingIcon:!0,showEmptyResultText:!1,width:548,height:30,focusIn:this.bbdesigner$.proxy(this.listOutDSNames,this),containment:this.dashboardDesigner._id,cssClass:"e-designer bbi-dbrd-control bbi-browse-dialog"});this.bbdesigner$("#"+this.id+"_browse_save_suggestion").addClass("bbi-dbrd-control");this.appendLoader();this.dashboardDesigner.model.enablePublicDashboardSetting&&this.SetPublicSettings()},n.prototype.appendLoader=function(){this.fileContainer.find(".e-dbrd-browse-savenametxt").parents(".e-in-wrap.e-box").append("<div class='bbi-category-dashboards-loadicon-wrap'><span class='bbi-dashboardname-load-icon'><\/span><\/div>");var n=this.dashboardDesigner.designerPanel;n.appendSpinningWidget(this.fileContainer.find(".bbi-dashboardname-load-icon"),null)},n.prototype.listOutDSNames=function(){this.fileContainer.find(".bbi-browse-dialog-nametext").removeClass("bbi-designer-error");this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","none");var n=this.fileContainer.find(".e-dbrd-browse-savenametxt").data("BoldBIDashboardAutocomplete");!BoldBIDashboard.isNullOrUndefined(n)&&this.fileContainer.find(".e-dbrd-browse-savenametxt").is(":focus")&&n.open()},n.prototype.getCategoryRow=function(){var i=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),n=BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div","",{},{}),h=BoldBIDashboard.buildTag("div.bbi-browse-label",this.locale.browseDialogMessages.categoryLabelText,{},{id:this.id+"_browseCategroyLabel"}),e;r.append(h);var t=BoldBIDashboard.buildTag("div.bbi-browse-category-wrap","",{},{id:this.id+"_browseCategroyWrap"}),u=BoldBIDashboard.buildTag("div.bbi-dbrd-select-category","",{},{id:this.id+"_browse_categoory_drpdwn_div"}),f=BoldBIDashboard.buildTag("input.e-dbrd-select-category-drpdwn bbi-dbrd-control","",{},{id:this.id+"_browse_categoory_drpdwn"});u.append(f);t.append(u);e=BoldBIDashboard.buildTag("div.e-dbrd-notvalidcategory bbi-browse-err",this.locale.browseDialogMessages.selectCategory,{},{id:this.id+"_browse_name_errmsg"});t.append(e);n.append(t);var o=BoldBIDashboard.buildTag("div.bbi-browse-category-addwrap","",{},{id:this.id+"_browseCategoryAddwrap"}),s=BoldBIDashboard.buildTag("div.bbi-browse-category-add bbi-dbrd-icon-background-theme","",{},{id:this.id+"_browseCategoryAdd",title:this.locale.browseDialogMessages.createCategoryTooltip}),c=BoldBIDashboard.buildTag("div.bbi-browse-category-plusicon bbi-dbrd-icon-theme","",{},{id:this.id+"_browseCategoryPlus"});return s.append(c),o.append(s),n.append(o),i.append(r,n),f.BoldBIDashboardDropDownList({dataSource:[],fields:{id:"itemId",text:"itemName"},watermarkText:this.locale.browseDialogMessages.selectCategoryWatermarkText,width:500,popupWidth:500,height:30,change:this.bbdesigner$.proxy(this.selectCategory,this),cssClass:"bbi-dbrd-control",enableFilterSearch:!0}),i},n.prototype.getNameRow=function(){var n=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.nameLabelText,{});t.append(r);var i=BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div","",{},{}),u=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt e-dbrd-browse-savenametxt bbi-browse-dialog-nametext","",{},{id:this.id+"_browse_save",type:"text"}),f=BoldBIDashboard.buildTag("div.e-dbrd-notvalidname bbi-browse-err",this.locale.browseDialogMessages.dashboardNameEmptyErr,{},{id:this.id+"_browse_name_errmsg"});return i.append(u,f),n.append(t,i),n},n.prototype.getDescRow=function(){var n=BoldBIDashboard.buildTag("div.bbi-browse-content-row bbi-browse-desc-row","",{},{}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.descriptionLabelText,{});t.append(r);var i=BoldBIDashboard.buildTag("div.bbi-browse-contentwrap e-contentwrap-description","",{},{}),u=BoldBIDashboard.buildTag("textarea.e-textarea bbi-designer-txt bbi-browse-dialog-text bbi-browse-dialog-textarea e-browse-dialog-desc","",{},{id:this.id+"_browse_save_desc",type:"textarea",spellcheck:"false",maxlength:"1024"}),f=BoldBIDashboard.buildTag("div.e-dbrd-exceedsmaxlength bbi-browse-desc-err bbi-designer-fontfamily",this.locale.browseDialogMessages.dashboardDescExceedsMaxLength,{},{id:this.id+"_browse_name_errmsg"});return i.append(u,f),n.append(t,i),n},n.prototype.getMarkAsPublicRow=function(){var t=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{id:this.id+"_mark_public_div"}),i=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),f=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.isPublic,{});i.append(f);var n=BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div bbi-mark-public-chk-box","",{},{}),r=BoldBIDashboard.buildTag("input","",{},{id:this.id+"_is_public_chk",type:"checkbox"}),u=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_is_public_info","class":"bbi-mark-public-info"}),e=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_is_public_info_span","class":"bbi-mark-public-info-span"});return n.append(r),u.append(e),n.append(u),t.append(i,n),r.BoldBIDashboardCheckBox({checked:!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&this.dashboardDesigner.model.serverSettings.isPublic&&this.dashboardDesigner.model.serverSettings.enableMarkAsPublic||!1,value:"isPublic"}),t},n.prototype.SetPublicSettings=function(){var n=this.dashboardDesigner.element.find("#"+this.id+"_mark_public_div"),t=n.find("#"+this.id+"_is_public_chk");!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&this.dashboardDesigner.model.serverSettings.enableMarkAsPublic?(t.data("BoldBIDashboardCheckBox").enable(),n.find(".bbi-browse-dialog-label").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info").css("display","none")):(n.find(".bbi-browse-dialog-label").css("opacity","0.3"),t.data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info_span").html(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)?"":this.dashboardDesigner.model.serverSettings.warningMessage),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info").css("display","block"))},n.prototype.validateDashboardName=function(){var n=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),t=n.trim()===""?this.locale.browseDialogMessages.dashboardNameEmptyErr:this.locale.browseDialogMessages.dashboardNameErrorMsg+'* | / : < > , % ; \\ " + & ? #';this.fileContainer.find(".e-dbrd-notvalidname").html(t);this.dashboardDesigner.nameValidation(n)&&n.trim()!==""?this.hideDSNameErr():this.showDSNameErr();this.validInputs()},n.prototype.showDSNameErr=function(){this.fileContainer.find(".e-dbrd-notvalidname").slideDown(100);this.fileContainer.find(".bbi-browse-dialog-nametext").addClass("bbi-designer-error")},n.prototype.hideDSNameErr=function(){this.fileContainer.find(".e-dbrd-notvalidname").slideUp(100);this.fileContainer.find(".bbi-browse-dialog-nametext").removeClass("bbi-designer-error")},n.prototype.validateCategory=function(){var n=this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(n)||(!BoldBIDashboard.isNullOrUndefined(n.model.selectedItemIndex)&&n.model.selectedItemIndex>=0?this.fileContainer.find(".e-dbrd-notvalidcategory").hide():this.fileContainer.find(".e-dbrd-notvalidcategory").show());this.validInputs()},n.prototype.validInputs=function(){var t=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),i=this.dashboardDesigner.nameValidation(t)&&t.trim()!=="",n=this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn").data("BoldBIDashboardDropDownList"),r=!BoldBIDashboard.isNullOrUndefined(n)&&!BoldBIDashboard.isNullOrUndefined(n.model.selectedItemIndex)&&n.model.selectedItemIndex>=0;return BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_browse_btn_import"),i&&r&&this.isShowAutoCompleteLoader),i&&r},n.prototype.categoryDataUpdate=function(n){var i,t,u,r;if(!BoldBIDashboard.isNullOrUndefined(n)){for(i=[],t=0;t<n.length;t++)i.push({itemId:n[t].Id,itemName:n[t].Name,value:n[t]});this.fileContainer.find(".e-dbrd-notvalidcategory").text(this.locale.browseDialogMessages.selectCategory);this.fileContainer.find(".e-dbrd-notvalidcategory").hide();u=this.fileContainer.find(".e-dbrd-select-category-drpdwn");r=u.data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(r)||r.option("dataSource",i)}},n.prototype.selectCategory=function(n){BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.selectedValue)||this.getDashboardsInSelectedCategory(n.selectedValue);this.validInputs()},n.prototype.getDashboardsInSelectedCategory=function(n){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(n.Name)},{fnction:this.bbdesigner$.proxy(this.updateDashboardsInfo,this,n),indicator:[this.bbdesigner$.proxy(this.showAutoCompleteLoader,this),this.bbdesigner$.proxy(this.hideAutoCompleteLoader,this)]})},n.prototype.updateDashboardsInfo=function(n,t){var i;this.footerTag.find(".bbi-designer-categoryErrWrap").hide();var r=n.Files=t&&t.Status?JSON.parse(t.Data)||[]:JSON.parse(t),u=[],f=this.fileContainer.find(".e-dbrd-browse-savenametxt").data("BoldBIDashboardAutocomplete");if(!BoldBIDashboard.isNullOrUndefined(f)){for(i=0;i<r.length;i++)u.push(r[i].Name);f.option("dataSource",u)}},n.prototype.showAutoCompleteLoader=function(){this.hideDSNameErr();this.isShowAutoCompleteLoader=!1;this.fileContainer.find(".e-dbrd-browse-savenametxt").css("width","calc(100% - 28px");BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1);this.fileContainer.find(".bbi-background-waiting-popup").show()},n.prototype.hideAutoCompleteLoader=function(){this.isShowAutoCompleteLoader=!0;this.fileContainer.find(".e-dbrd-browse-savenametxt").css("width","100%");this.fileContainer.find(".bbi-background-waiting-popup").hide();BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0)},n.prototype.saveDashboardInfo=function(){this.saveCategoryInfo();this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()!==""&&(this.dashboardDesigner.reportFileName=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.model.dashboardName=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val());this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val()!==""&&(this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.model.dashboardDescription=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val())},n.prototype.saveCategoryInfo=function(){var n=this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn").data("BoldBIDashboardDropDownList"),t;!BoldBIDashboard.isNullOrUndefined(n)&&this.validInputs()&&(t=n.model.dataSource.findIndex(function(t){return t.itemName===n.getValue()}),t===-1&&(t=n.model.selectedItemIndex),this.selectedFile=n.model.dataSource[t].value)},n.prototype.populateCategoryErr=function(n){this.browseDialog.data("BoldBIDashboardDialog").isOpen()&&(this.footerTag.find(".bbi-designer-categoryErrMsg").addClass("bbi-dbrd-designer-hoverable").text(n).attr("data-tooltip",n),this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","block"),BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_browse_btn_import"),!1))},n.prototype.addCategory=function(){var n=new BoldBIDashboard.DashboardDesignerUtility.CreateCategoryDialog(this.dashboardDesigner,null);n.showDialog(!0)},n.prototype.saveDashboard=function(){var n,e,r,f,t,i,u;if((this.validateCategory(),this.validInputs())&&(this.saveCategoryInfo(),this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()!==""&&(this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()),this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val()!==""&&(this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val()),this.dashboardDesigner.modules.serialization.notifyChange(),!BoldBIDashboard.isNullOrUndefined(this.selectedFile)&&!BoldBIDashboard.isNullOrUndefined(this.selectedFile.Name)&&this.browseType===BrowseType.Publish&&(n=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),e=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val(),n=n===this.nameWaterMark?"":n,n&&n.length>0)))if(this.selectedFile.Type===1){for(r=this.selectedFile.Files,f=!1,t=0;t<r.length;t++)if(r[t].Type===2&&r[t].Name===n){f=!0;u="A dashboard with the same name already exists in the category"+this.locale.browseDialogMessages.doYouWantToReplace;this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DashboardSaved,u,IconType.question,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:n,id:r[t].Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}});break}f?(i=this.fileContainer.find("#"+this.id+"_is_public_chk").data("BoldBIDashboardCheckBox"),i&&(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&(this.dashboardDesigner.model.serverSettings={}),this.dashboardDesigner.model.serverSettings.isPublic=i.isChecked())):this.targetInstance!==null?(i=this.fileContainer.find("#"+this.id+"_is_public_chk").data("BoldBIDashboardCheckBox"),i&&(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&(this.dashboardDesigner.model.serverSettings={}),this.dashboardDesigner.model.serverSettings.isPublic=i.isChecked()),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,n,e,!1,null,BoldBIDashboard.DashboardDesignerEvent.SaveAs])):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:this.selectedFile.Name,name:n,categoryId:this.selectedFile.Id,isExist:!1,type:BrowseType.Publish}))}else this.selectedFile.Type===2&&this.selectedFile.Name===n&&(u="'"+this.selectedFile.Name+this.locale.browseDialogMessages.fileExistInCategory+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,u,IconType.warning,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:n,id:this.selectedFile.Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}}))},n.prototype.retry=function(){var t=null,n=this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn").data("BoldBIDashboardDropDownList");!BoldBIDashboard.isNullOrUndefined(n)&&!BoldBIDashboard.isNullOrUndefined(n.model.selectedItemIndex)&&n.model.selectedItemIndex>-1&&(t=JSON.parse(n.getSelectedValue()).Name);this.getCategoryInfo(t)},n.prototype.categoryLoadingErr=function(){this.populateCategoryErr(this.locale.browseDialogMessages.loadCategoryErr)},n.prototype.dashboardSaveErr=function(n){var t=this.browseDialog.data("BoldBIDashboardDialog");!BoldBIDashboard.isNullOrUndefined(t)&&t.isOpen()&&(this.dashboardDesigner.element.find(".e-browseDialog-footer .bbi-browse-err").addClass("bbi-dbrd-designer-hoverable").text(this.locale.errorMessage.errorOnSaveDashboard).attr("data-tooltip",n.Message),this.dashboardDesigner.element.find(".e-browseDialog-footer .bbi-designer-categoryErrWrap").css("display","block"))},n.prototype.descriptionKeyEvent=function(n){n.keyCode===13&&n.stopPropagation()},n.prototype.wireEvents=function(){this.fileContainer.on("click",".bbi-browse-category-addwrap",this.bbdesigner$.proxy(this.addCategory,this));this.fileContainer.on("focusout",".e-dbrd-browse-savenametxt",this.bbdesigner$.proxy(this.validateDashboardName,this));this.footerTag.on("click",".bbi-designer-categoryErrWrap .bbi-designer-categoryRetryLink",this.bbdesigner$.proxy(this.retry,this));this.fileContainer.on("keypress",".bbi-browse-contentwrap.e-contentwrap-description",this.bbdesigner$.proxy(this.descriptionKeyEvent,this));this.footerTag.on("click","#"+this.id+"_browse_btn_import",this.bbdesigner$.proxy(this.saveDashboard,this));this.footerTag.on("click","#"+this.id+"_browse_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},n.prototype.unwireEvents=function(){this.fileContainer.off("click",".bbi-browse-category-addwrap",this.bbdesigner$.proxy(this.addCategory,this));this.fileContainer.off("focusout",".e-dbrd-browse-savenametxt",this.bbdesigner$.proxy(this.validateDashboardName,this));this.footerTag.off("click",".bbi-designer-categoryErrWrap .bbi-designer-categoryRetryLink",this.bbdesigner$.proxy(this.retry,this));this.fileContainer.off("keypress",".bbi-browse-contentwrap.e-contentwrap-description",this.bbdesigner$.proxy(this.descriptionKeyEvent,this));this.footerTag.off("click","#"+this.id+"_browse_btn_import",this.bbdesigner$.proxy(this.saveDashboard,this));this.footerTag.off("click","#"+this.id+"_browse_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.BrowseDialog",InternalBrowseDialog,window),function(n){n[n.Open="Open"]="Open";n[n.Publish="Publish"]="Publish"}(BrowseType||(BrowseType={}));InternalConditionalFormat=function(){function n(n){this.dashboardDesigner=null;this.columnFormatDialog=null;this.conditionalFormats=null;this.selectedRow=null;this.toolbarDiv=null;this.targetInstance=null;this.targetMethod=null;this.editIconDiv=null;this.deleteIconDiv=null;this.settingsDialog=null;this.isEdit=!1;this.conditionalInfo=null;this.rightTextBoxDiv=null;this.measureConditionValues=null;this.textDiv=null;this.colorPalette=null;this.divContainer=null;this.columnDetails=null;this.columngridObj=null;this.locale=null;this.locale=n.getLocalizationContent();this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.id=this.dashboardDesigner._id;this.renderColumnFormatWindow();this.unWireEvents();this.wireEvents()}return n.prototype.renderColumnFormatWindow=function(){var i=this.columnFormatDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{position:"relative"},{id:this.id+"_col_conditional_format"}),e=BoldBIDashboard.buildTag("div","",{}),o=this.toolbarDiv=BoldBIDashboard.buildTag("div","",{height:"20px",padding:"5px 0px"}),r=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-background-theme","",{}),a=BoldBIDashboard.buildTag("span.e-icon e-plus bbi-designer-format-addIcon bbi-dbrd-designer-hoverable","",{float:"right","margin-top":"3px","margin-right":"4px"},{id:this.id+"_col_conditional_format_add","data-tooltip":this.locale.chartTrendLineDialog.Add}),n,s,t,h,c,u,l,f;r.append(a);n=this.editIconDiv=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-icon-background-theme","",{"margin-left":"5px"});s=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-parameter-edit bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px",margin:"3px"},{id:this.id+"_col_conditional_format_edit","data-tooltip":this.locale.chartTrendLineDialog.Edit});n.append(s);t=this.deleteIconDiv=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-icon-background-theme","",{"margin-left":"5px"});h=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-toolbar-delete bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px","margin-top":"2px","margin-right":"3px"},{id:this.id+"_col_conditional_format_delete","data-tooltip":this.locale.chartTrendLineDialog.Delete});t.append(h);o.append(t,n,r);r.bind("click",this.bbdesigner$.proxy(this.addConditionalColumn,this));n.bind("click",this.bbdesigner$.proxy(this.editConditionalColumn,this));t.bind("click",this.bbdesigner$.proxy(this.deleteConditionalColumn,this));c=BoldBIDashboard.buildTag("div","",{width:"378px",height:"100%",border:"1px solid #cecece","box-sizing":"border-box"},{id:this.id+"_col_conditional_format_rootgrid"});u=BoldBIDashboard.buildTag("div.boldbi-designer-conditionalformat-grid","",{},{id:this.id+"_col_conditional_format_grid"});e.append(o,c.append(u));i.append(e);this.dashboardDesigner.element.append(i);i.BoldBIDashboardDialog({title:"Grid Conditional Formatting",width:"auto",height:"auto",minWidth:400,minHeight:260,enableResize:!1,showOnInit:!1,showFooter:!0,enableModal:!0,target:"#"+this.dashboardDesigner._id,containment:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog bbi-designer-format boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});l=this.dashboardDesigner.element.find("#"+this.id+"_col_conditional_format_foot");f=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary",this.locale.dialogOptions.closeButtonText,{float:"right"},{id:this.id+"_col_conditional_format_cancel",type:"button"});l.append(f);f.on("click",this.bbdesigner$.proxy(this.closeConditionalFormat,this));this.getGridContainer(u);this.renderConditionalSettings()},n.prototype.getGridContainer=function(n){for(var r=[],t=[{fieldName:"BasedOn",Name:"Based On"},{fieldName:"Condition",Name:"Condition"}],u=376/t.length,i=0;i<t.length;i++)r.push({field:t[i].fieldName,headerText:t[i].Name,width:u,textAlign:BoldBIDashboard.TextAlign.Left});n.BoldBIDashboardGrid({columns:r,height:"265px",allowSelection:!0,allowResizing:!0,allowScrolling:!0,allowPaging:!1,scrollSettings:{allowVirtualScrolling:!1,virtualScrollMode:"normal",enableTouchScroll:!1,autoHide:!0},rowSelected:this.bbdesigner$.proxy(this.gridRowSelected,this),cssClass:"bbi-dbrd-designer-scroller bbi-dbrd-control"});this.columngridObj=n.data("BoldBIDashboardGrid")},n.prototype.getGridDataSource=function(){for(var t=[],n=0;n<this.conditionalFormats.length;n++)t.push(this.getGridElement(this.conditionalFormats[n]));return t},n.prototype.getGridElement=function(n){var t=null;return n.TargetMeasureColumn.ColumnType===FieldType[FieldType.Measures]?n.ColorStyle===ColorType[ColorType.SingleColor]?t=this.getMeasureConditionText(n.MeasureConditionType,n.Value,n.EndValue):n.ColorStyle===ColorType[ColorType.GradientColor]&&(t=n.FormatType===ConditionalFormatType[ConditionalFormatType.Indication]?ConditionalFormatType[ConditionalFormatType.Indication]:"Graded Color Scale"):t=this.getDimensionConditionText(n.DimensionConditionType,n.Text,null),n.DisplayExpression=t,{BasedOn:n.ColumnName,Condition:t,conditionalInfo:n}},n.prototype.getConditionValue=function(n){var t=null;return typeof n=="string"?t=n.length>0?n:"''":typeof n=="number"&&(t=n),t},n.prototype.getMeasureConditionText=function(n,t,i){var r="Value";return n===MeasureConditionType[MeasureConditionType.Equals]?r=r+" = "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.NotEquals]?r=r+" != "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.GreaterThan]?r=r+" > "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.GreaterThanOrEqual]?r=r+" >= "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.LessThan]?r=r+" < "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.LessThanOrEqual]?r=r+" <= "+this.getConditionValue(t):n===MeasureConditionType[MeasureConditionType.Between]&&(r=r+" between "+t+" and "+i),r},n.prototype.getDimensionConditionText=function(n,t){var i="Value";return n===DimensionConditionType[DimensionConditionType.Equals]?i=i+" = "+this.getConditionValue(t):n===DimensionConditionType[DimensionConditionType.NotEquals]?i=i+" != "+this.getConditionValue(t):n===DimensionConditionType[DimensionConditionType.Contains]?i=i+" contains "+this.getConditionValue(t):n===DimensionConditionType[DimensionConditionType.NotContains]?i=i+" does not contain "+this.getConditionValue(t):n===DimensionConditionType[DimensionConditionType.StartsWith]?i=i+" starts with "+this.getConditionValue(t):n===DimensionConditionType[DimensionConditionType.EndsWith]&&(i=i+" ends with "+this.getConditionValue(t)),i},n.prototype.gridRowSelected=function(n){this.selectedRow=n.data;BoldBIDashboard.isNullOrUndefined(n.target)?this.disableToolbarItems(!0):this.disableToolbarItems(!1)},n.prototype.addConditionalColumn=function(){this.openColumnSettings(null,!1)},n.prototype.updateGridData=function(n,t){var r=this.columngridObj.model.dataSource,u,f,i;if(t)for(u=this.columngridObj.model.selectedRowIndex,f=this.getGridElement(n),i=0;i<r.length;i++)i===u&&(r[i]=f);else r.push(this.getGridElement(n));this.selectedRow=null;this.columngridObj.dataSource(r,!0);this.disableToolbarItems(BoldBIDashboard.isNullOrUndefined(this.selectedRow));this.columngridObj.refreshContent(!0)},n.prototype.editConditionalColumn=function(){this.editIconDiv.attr("disabled")!=="disabled"&&this.openColumnSettings(this.selectedRow.conditionalInfo,!0)},n.prototype.deleteConditionalColumn=function(){if(this.deleteIconDiv.attr("disabled")!=="disabled"){var n=this.columngridObj.model.selectedRowIndex;n>-1&&(this.columngridObj.model.dataSource.splice(n,1),this.columngridObj.refreshContent(!0),this.selectedRow=null);this.editIconDiv.attr("disabled")!=="disabled"&&this.disableToolbarItems(!0)}},n.prototype.disableToolbarItems=function(n){n?(this.editIconDiv.css({opacity:"0.5"}).attr("disabled","disabled"),this.deleteIconDiv.css({opacity:"0.5"}).attr("disabled","disabled")):(this.editIconDiv.css({opacity:"1"}).removeAttr("disabled"),this.deleteIconDiv.css({opacity:"1"}).removeAttr("disabled"))},n.prototype.openConditionalFormat=function(n,t,i){this.resetConditionalFormat();this.targetInstance=n;this.targetMethod=t;this.conditionalFormats=i;this.columnFormatDialog.data("BoldBIDashboardDialog").open();this.columngridObj.setModel({dataSource:this.getGridDataSource()});this.columngridObj.model.dataSource.length===0?this.disableToolbarItems(!0):(this.disableToolbarItems(!1),this.columngridObj.setModel({selectedRowIndex:0}));this.columngridObj.refreshContent(!0)},n.prototype.resetConditionalFormat=function(){this.conditionalFormats=[];this.columngridObj.dataSource([],!0);this.columngridObj.refreshContent(!0);this.targetInstance=null;this.targetMethod=null;this.disableToolbarItems(!0)},n.prototype.getColumnConditionalInfo=function(){for(var t=[],i=this.columngridObj.model.dataSource,n=0;n<i.length;n++)t.push(i[n].conditionalInfo);return t},n.prototype.closeConditionalFormat=function(){var n=this.getColumnConditionalInfo();BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[n]),this.columnFormatDialog.data("BoldBIDashboardDialog").close())},n.prototype.renderConditionalSettings=function(){var t=this.settingsDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_conditional_settings"}),n=this.divContainer=BoldBIDashboard.buildTag("div","",{id:this.id+"_conditional_settings_div"}),i=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px","padding-top":"5px"},{id:this.id+"_conditional_settings_colInfo_table"}),r=BoldBIDashboard.buildTag("tr","",{},{}),vt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Based On",{width:"122px","font-size":"12px"},{}),u=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),f=this.columnDetails=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colInfo"}),ht,ct,lt,at;u.append(f);r.append(vt).append(u);i.append(r);var e=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{id:this.id+"_conditional_settings_colorSetting_table"}),o=BoldBIDashboard.buildTag("tr","",{},{}),yt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Color Settings",{width:"122px","font-size":"12px"},{}),s=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),h=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colorSetting"});s.append(h);o.append(yt).append(s);e.append(o);var c=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_formattingType_table"}),l=BoldBIDashboard.buildTag("tr","",{},{}),pt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Formatting Type",{width:"122px","font-size":"12px"},{}),a=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),v=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_formattingType"});a.append(v);l.append(pt).append(a);c.append(l);var y=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_grdntFormattingType_table"}),p=BoldBIDashboard.buildTag("tr","",{},{}),wt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Formatting Type",{width:"122px","font-size":"12px"},{}),w=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),b=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_grdntFormattingType"});w.append(b);p.append(wt).append(w);y.append(p);n.append(i).append(e).append(c).append(y);this.renderMeasureConditionType(n);this.renderDimensionConditionType(n);this.renderColorPalette(n);var k=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_caseSensitive_table"}),d=BoldBIDashboard.buildTag("tr","",{},{}),bt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","",{width:"122px","font-size":"12px"},{}),g=BoldBIDashboard.buildTag("td","",{}),nt=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_conditional_settings_caseSensitive"});g.append(nt);d.append(bt).append(g);k.append(d);n.append(k);this.renderMeasureConditionValue(n);this.renderTextBox(n,"Value","dimension_value");this.renderFontStyleContainer(n);var tt=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",display:"none"},{id:this.id+"_conditional_settings_pgcolor_table"}),it=BoldBIDashboard.buildTag("tr","",{},{}),kt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Background",{width:"122px","font-size":"12px"},{}),rt=BoldBIDashboard.buildTag("td","",{},{}),ut=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_bgcolor"});rt.append(ut);it.append(kt).append(rt);tt.append(it);var ft=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",display:"none"},{id:this.id+"_conditional_settings_foreground_table"}),et=BoldBIDashboard.buildTag("tr","",{},{}),dt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Foreground",{width:"122px","font-size":"12px"},{}),ot=BoldBIDashboard.buildTag("td","",{},{}),st=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_foreground"});ot.append(st);et.append(dt).append(ot);ft.append(et);this.renderTextBox(n,"Enter Column Title","column_title");n.append(tt).append(ft);ht=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_conditional_settings_okbtn",type:"button"});ct=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_conditional_settings_cancelbtn",type:"button"});t.append(n);this.dashboardDesigner.element.append(t);t.BoldBIDashboardDialog({minWidth:360,minHeight:350,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",showFooter:!0,target:"#"+this.dashboardDesigner._id,containment:"#"+this.dashboardDesigner._id,title:"Grid Conditional Formatting",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});lt=this.dashboardDesigner.element.find("#"+this.id+"_conditional_settings_foot");lt.append(ct,ht);f.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"columnInfo.Value",value:"FieldType"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeColumnInfo,this)});at=this.getColorList();h.BoldBIDashboardDropDownList({dataSource:at,fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeColorSettings,this)});b.BoldBIDashboardDropDownList({dataSource:this.formattingTypeList(!0),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeGradientFormatting,this)});v.BoldBIDashboardDropDownList({dataSource:this.formattingTypeList(!1),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control"});ut.BoldBIDashboardColorPicker({value:"#2f79b5",cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown});st.BoldBIDashboardColorPicker({cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown});nt.BoldBIDashboardCheckBox({text:"Case Sensitive",checked:!0,width:"35px",cssClass:"bbi-designer-case-sensitive"})},n.prototype.renderMeasureConditionType=function(n){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_measure_conditionType_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),f=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Condition Type",{width:"122px","font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),u=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_measure_conditionType"});r.append(u);i.append(f).append(r);t.append(i);n.append(t);u.BoldBIDashboardDropDownList({dataSource:this.measureConditionList(),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeMeasureCondition,this)})},n.prototype.renderDimensionConditionType=function(n){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_dimension_conditionType_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),f=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Condition Type",{width:"122px","font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),u=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_dimension_conditionType"});r.append(u);i.append(f).append(r);t.append(i);n.append(t);u.BoldBIDashboardDropDownList({dataSource:this.dimensionConditionList(),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control"})},n.prototype.renderFontStyleContainer=function(n){var f=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_font_table"}),e=BoldBIDashboard.buildTag("tr","",{},{}),v=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Font",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"35px","padding-right":"4px"},{}),s=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_fontColor"}),h=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),t=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-bold-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontBold"}),c=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),i=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-italic-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontItalic"}),l=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),r=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-underline-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontUnderLine"}),a=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),u=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{"class":"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-strike-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontStrike"});o.append(s);h.append(t);c.append(i);l.append(r);a.append(u);e.append(v).append(o).append(h).append(c).append(l).append(a);f.append(e);n.append(f);t.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,t));i.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,i));r.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,r));u.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,u));s.BoldBIDashboardColorPicker({cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},n.prototype.renderColorPalette=function(n){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_palette_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Select Color Palette",{width:"122px","font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),u=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_conditional_settings_palettediv"}),f=BoldBIDashboard.buildTag("div","",{height:"18px",width:"155px",position:"absolute",margin:"4px 11px 0px 11px",background:"#ffffff"},{id:this.id+"_conditional_settings_palette_panel"}),e=this.colorPalette=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colorPalette"});u.append(f).append(e);r.append(u);i.append(o).append(r);t.append(i);n.append(t);e.BoldBIDashboardDropDownList({dataSource:this.gradientList(),fields:{value:"gradient"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-designer-colorpalette bbi-dbrd-control",template:'<div style="height:18px;width:178px;background:${gradient}"><\/div>',change:this.bbdesigner$.proxy(this.updatePalettePanel,this)});f.css("background","linear-gradient(to right, #A8E1F4 0%, #0D7CBD 100%)")},n.prototype.renderTextBox=function(n,t,i){var r=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_"+i+"_table"}),u=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",t,{width:"122px","font-size":"12px"},{}),f=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),e=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_conditional_settings_"+i});f.append(e);u.append(o).append(f);r.append(u);n.append(r);e.BoldBIDashboardMaskEdit({inputMode:BoldBIDashboard.InputMode.Text,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border"})},n.prototype.renderMeasureConditionValue=function(n){var r=this.measureConditionValues=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_measurevalue_table"}),u=this.bbdesigner$("<tr><\/tr>"),c=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Values",{width:"122px","font-size":"12px"},{}),f=BoldBIDashboard.buildTag("td","",{},{}),t=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_text1"});f.append(t);var e=BoldBIDashboard.buildTag("td","",{width:"33px"},{}),o=this.textDiv=BoldBIDashboard.buildTag("div","",{"padding-left":"10px",display:"none"}),l=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","&",{"font-size":"12px"},{type:"label"}),s=BoldBIDashboard.buildTag("td","",{height:"28px"},{}),h=this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{display:"none"},{id:this.id+"_conditional_settings_rightText_div"}),i=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_conditional_settings_text2"});s.append(h);h.append(i);o.append(l);e.append(o);u.append(c).append(f).append(e).append(s);r.append(u);n.append(r);t.ejNumericTextbox({decimalPlaces:2,value:0,width:"80px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,t)});i.ejNumericTextbox({decimalPlaces:2,value:0,width:"80px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,i)})},n.prototype.changeTextBoxValue=function(n,t){BoldBIDashboard.isNullOrUndefined(t.value)&&n.data("ejNumericTextbox").setModel({value:0})},n.prototype.selectFontStyleIcons=function(n){this.hasSelectionClass(n)?n.removeClass("bbi-designer-fontstyle-selection"):n.addClass("bbi-designer-fontstyle-selection")},n.prototype.updatePalettePanel=function(n){this.divContainer.find("#"+this.id+"_conditional_settings_palette_panel").css("background",n.value)},n.prototype.changeMeasureCondition=function(n){n.value==="Between"?(this.textDiv.css("display","block"),this.rightTextBoxDiv.css("display","block")):(this.textDiv.css("display","none"),this.rightTextBoxDiv.css("display","none"))},n.prototype.changeGradientFormatting=function(n){this.showGradientFormatting(n.value)},n.prototype.showGradientFormatting=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_foreground_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_column_title_table");n===ConditionalFormatType.Indication.toString()?(t.css("display","none"),i.css("display","block")):(t.css("display","block"),i.css("display","none"))},n.prototype.changeColorSettings=function(n){this.showColorSettings(n.value)},n.prototype.showColorSettings=function(n){n===ColorType[ColorType.GradientColor]?(this.showSingleColorElements(!1),this.showGradientColorElements(!0)):n===ColorType[ColorType.SingleColor]?(this.showGradientColorElements(!1),this.showSingleColorElements(!0)):(this.showGradientColorElements(!1),this.showSingleColorElements(!1))},n.prototype.showSingleColorElements=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType_table"),r=this.divContainer.find("#"+this.id+"_conditional_settings_measurevalue_table"),u=this.divContainer.find("#"+this.id+"_conditional_settings_font_table"),f=this.divContainer.find("#"+this.id+"_conditional_settings_pgcolor_table");n?(t.css("display","block"),i.css("display","block"),r.css("display","block"),u.css("display","block"),f.css("display","block")):(t.css("display","none"),i.css("display","none"),r.css("display","none"),u.css("display","none"),f.css("display","none"))},n.prototype.showGradientColorElements=function(n){var u=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType"),t=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_palette_table"),f=this.divContainer.find("#"+this.id+"_conditional_settings_foreground_table"),e=this.divContainer.find("#"+this.id+"_conditional_settings_column_title_table"),r;n?(t.css("display","block"),i.css("display","block"),r=u.data("BoldBIDashboardDropDownList").getSelectedValue(),this.showGradientFormatting(r)):(t.css("display","none"),i.css("display","none"),f.css("display","none"),e.css("display","none"))},n.prototype.changeColumnInfo=function(n){if(n.selectedValue===FieldType[FieldType.Measures]){var t=this.columnDetails.data("BoldBIDashboardDropDownList").getListData(),i=t[this.columnDetails.data("BoldBIDashboardDropDownList").model.selectedIndex].columnInfo.Value;this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").setModel({value:i});this.showDimensionElements(!1);this.showMeasureElements(!0)}else n.selectedValue===FieldType[FieldType.Dimensions]&&(this.showMeasureElements(!1),this.showDimensionElements(!0))},n.prototype.showMeasureElements=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting_table"),r=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting"),i;n?(t.css("display","block"),i=r.data("BoldBIDashboardDropDownList").getSelectedValue(),this.showColorSettings(i)):(t.css("display","none"),this.showColorSettings(""))},n.prototype.showDimensionElements=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType_table"),r=this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive_table"),u=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value_table"),f=this.divContainer.find("#"+this.id+"_conditional_settings_font_table"),e=this.divContainer.find("#"+this.id+"_conditional_settings_pgcolor_table");n?(t.css("display","block"),i.css("display","block"),r.css("display","block"),u.css("display","block"),f.css("display","block"),e.css("display","block")):(t.css("display","none"),i.css("display","none"),r.css("display","none"),u.css("display","none"),f.css("display","none"),e.css("display","none"))},n.prototype.createConditionalSetting=function(){return{GradDarkColor:"",TargetMeasureColumn:Column,MeasureConditionType:MeasureConditionType.Equals,DimensionConditionType:DimensionConditionType.Equals,Name:"",MappingColor:"",IsCaseSensitive:!0,GradLightColor:"",SelectedColorPalette:"",Value:0,FormatType:ConditionalFormatType.Column,EndValue:0,DisplayExpression:"",ColumnName:"",ColorStyle:ColorType.SingleColor,Styles:{FontFormats:{TextColor:"",IsBold:!1,IsItalic:!1,IsUnderline:!1,IsStrikethrough:!1},BackgroundColor:""},Text:""}},n.prototype.getConditionSettingsInfo=function(){var n=this.createConditionalSetting(),l=this.columnDetails.data("BoldBIDashboardDropDownList").getListData(),i=[],u,e,t,h,r,c,f;i=l[this.columnDetails.data("BoldBIDashboardDropDownList").model.selectedIndex].columnInfo;n.TargetMeasureColumn={ColumnType:i.FieldType,UniqueColumnName:i.UniqueColumnName,DisplayName:i.Value};n.Name=BoldBIDashboard.getGuid("ConditionalFormatting_");u=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList");e=u.getItemDataByValue(u.getSelectedValue())[0];n.ColorStyle=e.value;n.ColumnName=n.TargetMeasureColumn.DisplayName;n.ColorStyle===ColorType[ColorType.SingleColor]?n.FormatType=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").getSelectedValue():n.ColorStyle===ColorType[ColorType.GradientColor]&&(n.FormatType=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").getSelectedValue());n.IsCaseSensitive=this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").model.checked;n.Styles.BackgroundColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").getColor());n.ColorStyle===ColorType[ColorType.GradientColor]&&(n.Styles.FontFormats.TextColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").getColor()));t=this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList");n.SelectedColorPalette=t.getSelectedValue();n.GradLightColor=n.ColorStyle===ColorType[ColorType.GradientColor]?t.model.dataSource[t.model.selectedIndex].startValue:"";n.GradDarkColor=n.ColorStyle===ColorType[ColorType.GradientColor]?t.model.dataSource[t.model.selectedIndex].endValue:"";var o=this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList"),a=o.getItemDataByValue(o.getSelectedValue())[0],s=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList"),v=s.getItemDataByValue(s.getSelectedValue())[0];return i.FieldType===FieldType[FieldType.Measures]?n.MeasureConditionType=a.value:n.DimensionConditionType=v.value,this.getFontFormatValues(n),h=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value_table"),h.css("display")==="block"?(r=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),n.Text=!BoldBIDashboard.isNullOrUndefined(r)&&r.length>0?r:"",n.Value=0):(c=this.divContainer.find("#"+this.id+"_conditional_settings_text1").data("ejNumericTextbox").getValue(),n.Value=c,f=this.divContainer.find("#"+this.id+"_conditional_settings_text2").data("ejNumericTextbox").getValue(),n.EndValue=BoldBIDashboard.isNullOrUndefined(f)?0:f),n},n.prototype.getFontFormatValues=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor"),i=this.divContainer.find("#"+this.id+"_conditional_settings_fontBold"),r=this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic"),u=this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike"),f=this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine");n.ColorStyle.toString()===ColorType[ColorType.SingleColor]&&(n.Styles.FontFormats.TextColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.data("BoldBIDashboardColorPicker").getColor()));n.Styles.FontFormats.IsBold=this.hasSelectionClass(i);n.Styles.FontFormats.IsItalic=this.hasSelectionClass(r);n.Styles.FontFormats.IsUnderline=this.hasSelectionClass(f);n.Styles.FontFormats.IsStrikethrough=this.hasSelectionClass(u)},n.prototype.hasSelectionClass=function(n){return n.hasClass("bbi-designer-fontstyle-selection")},n.prototype.removeSelectionClass=function(n){n.hasClass("bbi-designer-fontstyle-selection")&&n.removeClass("bbi-designer-fontstyle-selection")},n.prototype.resetFontStyle=function(){var n=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor");this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontBold"));this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic"));this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike"));this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine"));n.data("BoldBIDashboardColorPicker").setModel({value:"#ffffff"})},n.prototype.updateFontStyleSelection=function(n){var t=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor"),i=this.divContainer.find("#"+this.id+"_conditional_settings_fontBold"),r=this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic"),u=this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike"),f=this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine");this.resetFontStyle();BoldBIDashboard.isNullOrUndefined(n)||(t.data("BoldBIDashboardColorPicker").setModel({value:n.Styles.FontFormats.TextColor}),n.Styles.FontFormats.IsBold&&i.addClass("bbi-designer-fontstyle-selection"),n.Styles.FontFormats.IsItalic&&r.addClass("bbi-designer-fontstyle-selection"),n.Styles.FontFormats.IsStrikethrough&&u.addClass("bbi-designer-fontstyle-selection"),n.Styles.FontFormats.IsUnderline&&f.addClass("bbi-designer-fontstyle-selection"))},n.prototype.populateConditionalSettingInfo=function(n){var r,u,f,i,t;for(n.TargetMeasureColumn.ColumnType===FieldType[FieldType.Dimensions]?this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").setModel({value:n.Text}):(this.divContainer.find("#"+this.id+"_conditional_settings_text1").data("ejNumericTextbox").setModel({value:n.Value}),this.divContainer.find("#"+this.id+"_conditional_settings_text2").data("ejNumericTextbox").setModel({value:n.EndValue})),r=null,u=this.columnDetails.data("BoldBIDashboardDropDownList").model.dataSource,t=0;t<u.length;t++)if(u[t].DataField.toLowerCase()===n.TargetMeasureColumn.DisplayName.toLowerCase()){r=t;break}for(this.columnDetails.data("BoldBIDashboardDropDownList").setModel({selectedIndex:r}),this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList").selectItemByValue(n.ColorStyle),this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").setModel({value:n.ColumnName}),this.updateFontStyleSelection(n),n.ColorStyle===ColorType[ColorType.SingleColor]?this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").selectItemByValue(n.FormatType):n.ColorStyle===ColorType[ColorType.GradientColor]&&this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").selectItemByValue(n.FormatType),this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").setModel({checked:n.IsCaseSensitive}),this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").setModel({value:n.Styles.BackgroundColor}),this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").setModel({value:n.Styles.FontFormats.TextColor}),f=null,i=this.gradientList(),t=0;t<i.length;t++)i[t].startValue===n.GradLightColor&&i[t].endValue===n.GradDarkColor&&(f=i[t].gradient);this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList").setModel({value:f});this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList").selectItemByValue(n.MeasureConditionType);this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList").selectItemByValue(n.DimensionConditionType)},n.prototype.resetConditionalSetting=function(){var t,n;for(this.isEdit=!1,this.conditionalInfo=null,t=2,this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").model.value="",n=0;n<t;n++)this.divContainer.find("#"+this.id+"_conditional_settings_text"+(n+1)).data("ejNumericTextbox").setModel({value:0});this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").model.value="";this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").setModel({value:"#2f79b5"});this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").setModel({value:"#ffffff"});this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0});this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").val("");this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").option("checked",!0);this.resetFontStyle()},n.prototype.getBasedOnColumnDetails=function(){for(var i,n,t,r,s=[],c=this.dashboardDesigner.designerPanel.selectedReportItems,h=BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.bbdesigner$(c[0])),e=h.DataGroupInfo.FieldContainers,l=h.DataGroupInfo.DataSourceID,o=this.dashboardDesigner.modules.dataSet.datasets,u=[],f=0;f<o.length;f++)l===o[f].Id&&(u=o[f].Fields);for(i=0;i<e.length;i++)for(n=0;n<e[i].FieldInfos.length;n++)for(t=e[i].FieldInfos,r=0;r<u.length;r++)t[n].DataField!==u[r].Name||this.isDateTimeType(u[r].TypeName)||s.push({DataField:t[n].Value,Value:t[n].DataField,FieldType:t[n].FieldType,columnInfo:t[n]});return s},n.prototype.isDateTimeType=function(n){var t=n?n.toLowerCase():"";return t==="datetime"||t==="smalldatetime"||t==="system.datetime"||t==="system.timespan"||t==="date"?!0:!1},n.prototype.openColumnSettings=function(n,t){this.resetConditionalSetting();this.isEdit=t;this.conditionalInfo=n;this.settingsDialog.data("BoldBIDashboardDialog").open();var i=this.getBasedOnColumnDetails();this.columnDetails.data("BoldBIDashboardDropDownList").setModel({dataSource:i});BoldBIDashboard.isNullOrUndefined(n)?this.columnDetails.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}):this.populateConditionalSettingInfo(n)},n.prototype.closeConditionalSettings=function(){this.settingsDialog.data("BoldBIDashboardDialog").close()},n.prototype.saveConditionalSettings=function(){var n=this.getConditionSettingsInfo();this.updateGridData(n,this.isEdit);this.settingsDialog.data("BoldBIDashboardDialog").close()},n.prototype.destroy=function(){this.unWireEvents();BoldBIDashboard.DashboardUtil.destroyEjObjects(this.settingsDialog);this.settingsDialog.length>0&&this.settingsDialog.remove()},n.prototype.formattingTypeList=function(){return[{text:"Column",value:"Column"},{text:"Row",value:"Row"}]},n.prototype.measureConditionList=function(){var n=[];return n.push({value:MeasureConditionType[MeasureConditionType.Equals],text:MeasureConditionType.Equals}),n.push({value:MeasureConditionType[MeasureConditionType.NotEquals],text:MeasureConditionType.NotEquals}),n.push({value:MeasureConditionType[MeasureConditionType.GreaterThan],text:MeasureConditionType.GreaterThan}),n.push({value:MeasureConditionType[MeasureConditionType.GreaterThanOrEqual],text:MeasureConditionType.GreaterThanOrEqual}),n.push({value:MeasureConditionType[MeasureConditionType.LessThan],text:MeasureConditionType.LessThan}),n.push({value:MeasureConditionType[MeasureConditionType.LessThanOrEqual],text:MeasureConditionType.LessThanOrEqual}),n.push({value:MeasureConditionType[MeasureConditionType.Between],text:MeasureConditionType.Between}),n},n.prototype.dimensionConditionList=function(){var n=[];return n.push({value:DimensionConditionType[DimensionConditionType.Equals],text:DimensionConditionType.Equals}),n.push({value:DimensionConditionType[DimensionConditionType.NotEquals],text:DimensionConditionType.NotEquals}),n.push({value:DimensionConditionType[DimensionConditionType.Contains],text:DimensionConditionType.Contains}),n.push({value:DimensionConditionType[DimensionConditionType.NotContains],text:DimensionConditionType.NotContains}),n.push({value:DimensionConditionType[DimensionConditionType.StartsWith],text:DimensionConditionType.StartsWith}),n.push({value:DimensionConditionType[DimensionConditionType.EndsWith],text:DimensionConditionType.EndsWith}),n},n.prototype.getColorList=function(){var n=[];return n.push({value:ColorType[ColorType.SingleColor],text:ColorType.SingleColor}),n.push({value:ColorType[ColorType.GradientColor],text:ColorType.GradientColor}),n},n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_conditional_settings_okbtn",this.bbdesigner$.proxy(this.saveConditionalSettings,this));this.dashboardDesigner.element.on("click","#"+this.id+"_conditional_settings_cancelbtn",this.bbdesigner$.proxy(this.closeConditionalSettings,this))},n.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_conditional_settings_okbtn",this.bbdesigner$.proxy(this.saveConditionalSettings,this));this.dashboardDesigner.element.off("click","#"+this.id+"_conditional_settings_cancelbtn",this.bbdesigner$.proxy(this.closeConditionalSettings,this))},n.prototype.gradientList=function(){return[{gradient:"linear-gradient(to right, #A8E1F4 0%, #0D7CBD 100%)",startValue:"#A8E1F4",endValue:"#0D7CBD"},{gradient:"linear-gradient(to right, #C0E662 0%, #007500 100%)",startValue:"#C0E662",endValue:"#007500"},{gradient:"linear-gradient(to right, #FFA76B 0%, #9E2B49 100%)",startValue:"#FFA76B",endValue:"#9E2B49"},{gradient:"linear-gradient(to right, #A8E1F4 0%, #FF712F 100%)",startValue:"#A8E1F4",endValue:"#FF712F"},{gradient:"linear-gradient(to right, #EED2EE 0%, #B877D2 100%)",startValue:"#EED2EE",endValue:"#B877D2"}]},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ConditionalFormat",InternalConditionalFormat,window);InternalDimensionFilter=function(){function n(n){this.dashboardDesigner=null;this.id=null;this.targetItem=null;this.filterContainer=null;this.listContainer=null;this.conditionContainer=null;this.rankContainer=null;this.conditionCheckBox=null;this.conditionColumnDropDown=null;this.conditionSummaryDropDown=null;this.conditionTypeDropDown=null;this.leftTextBox=null;this.rightTextBox=null;this.labelDiv=null;this.rightTextBoxDiv=null;this.modifiedConditionalFilter=!1;this.isConditionFilteringApplied=!1;this.columnName=null;this.columnId=null;this.summaryType=null;this.conditionSummaryType=null;this.leftValue=0;this.rightValue=0;this.rankCheckBox=null;this.rankModeDropDown=null;this.rankCountUpDown=null;this.rankColumnDropDown=null;this.dateTimeCheckBox=null;this.rankFormatDropDown=null;this.modifiedTopNFilter=!1;this.isTopNFilteringApplied=!1;this.mode="Top";this.numberOfRecords=5;this.rankColumnName=null;this.rankColumnId=null;this.dataFieldItems=[];this.measuresList=[];this.dimensionsList=[];this.dateTimeFormats=[];this.timeFormats=[];this.dimensionFormats=[];this.measureFormats=[];this.conditionTypes=[];this.modeTypes=[];this.targetInstance=null;this.targetMethod="";this.dataSetName="";this.filterInfo=null;this.fieldDetails=null;this.ejFilterDialog=null;this.isDataHigh=!1;this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.queryDesigner=this.dashboardDesigner.modules.queryDesigner;this.id=this.dashboardDesigner._id;this.dateRangePopup=this.dashboardDesigner.modules.dateRangePopup;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.multiSelectionComboBox=new BoldBIDashboard.DashboardDesignerUtility.MultiSelectionComboBox(this.dashboardDesigner);this.dateTimeFormats=this.getDateFormatsList();this.timeFormats=this.getTimeFormatsList();this.dimensionFormats=this.getSummaryTypeArrayforDimension();this.measureFormats=this.getmeasureFormatsList();this.conditionTypes=this.getconditionTypes();this.modeTypes=this.getRankModeList();this.renderDimensionFilterWindow()}return n.prototype.getDateFormatsList=function(){var n=[];return n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Date],text:DateTimeFormatForFilter.Date}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DateTime],text:DateTimeFormatForFilter.DateTime}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Year],text:DateTimeFormatForFilter.Year}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Quarter],text:DateTimeFormatForFilter.Quarter}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Month],text:DateTimeFormatForFilter.Month}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.QuarterYear],text:DateTimeFormatForFilter.QuarterYear}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.MonthYear],text:DateTimeFormatForFilter.MonthYear}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekYear],text:DateTimeFormatForFilter.WeekYear}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DayOfWeek],text:DateTimeFormatForFilter.DayOfWeek}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekOfYear],text:DateTimeFormatForFilter.WeekOfYear}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Day],text:DateTimeFormatForFilter.Day}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Hour],text:DateTimeFormatForFilter.Hour}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Minute],text:DateTimeFormatForFilter.Minute}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Second],text:DateTimeFormatForFilter.Second}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Time],text:DateTimeFormatForFilter.Time}),n},n.prototype.getTimeFormatsList=function(){var n=[];return n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Hour],text:DateTimeFormatForFilter.Hour}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Minute],text:DateTimeFormatForFilter.Minute}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Second],text:DateTimeFormatForFilter.Second}),n.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Time],text:DateTimeFormatForFilter.Time}),n},n.prototype.getmeasureFormatsList=function(){var n=[],t=this.dashboardDesigner.modules.util;return n.push({value:SummaryType.SUM,text:t.getSummaryTypeLocalizedText(SummaryType.SUM)}),n.push({value:SummaryType.AVG,text:t.getSummaryTypeLocalizedText(SummaryType.AVG)}),n.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),n.push({value:SummaryType.MAX,text:t.getSummaryTypeLocalizedText(SummaryType.MAX)}),n.push({value:SummaryType.MIN,text:t.getSummaryTypeLocalizedText(SummaryType.MIN)}),n.push({value:SummaryType.MEDIAN,text:t.getSummaryTypeLocalizedText(SummaryType.MEDIAN)}),n.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),n.push({value:SummaryType.VAR,text:t.getSummaryTypeLocalizedText(SummaryType.VAR)}),n},n.prototype.getconditionTypes=function(){var n=[];return n.push({value:NumberFilterOption.Equals,text:this.locale.dataconfiguration.numberFilterOption.equals}),n.push({value:NumberFilterOption.NotEquals,text:this.locale.dataconfiguration.numberFilterOption.notEquals}),n.push({value:NumberFilterOption.GreaterThan,text:this.locale.dataconfiguration.numberFilterOption.greaterThan}),n.push({value:NumberFilterOption.GreaterThanOrEquals,text:this.locale.dataconfiguration.numberFilterOption.greaterThanOrEquals}),n.push({value:NumberFilterOption.LessThan,text:this.locale.dataconfiguration.numberFilterOption.lessThan}),n.push({value:NumberFilterOption.LessThanOrEquals,text:this.locale.dataconfiguration.numberFilterOption.lessThanOrEquals}),n.push({value:NumberFilterOption.IsBetween,text:this.locale.dataconfiguration.numberFilterOption.between}),n.push({value:NumberFilterOption.IsNotBetween,text:this.locale.dataconfiguration.numberFilterOption.notBetween}),n},n.prototype.getSummaryTypeArrayforDimension=function(){var t=[],i=new ValueAliasPair,n;return i.text=SummaryType.COUNT.toString(),i.value=SummaryType[SummaryType.COUNT],n=new ValueAliasPair,n.text=SummaryType.COUNTD.toString(),n.value=SummaryType[SummaryType.COUNTD],t.push(i),t.push(n),t},n.prototype.getRankModeList=function(){var t=[],i=new ValueAliasPair,n;return i.text=RankType.Top.toString(),i.value=RankType[RankType.Top],n=new ValueAliasPair,n.text=RankType.Bottom.toString(),n.value=RankType[RankType.Bottom],t.push(i),t.push(n),t},n.prototype.renderDimensionFilterWindow=function(){this.filterContainer=BoldBIDashboard.buildTag("div.bbi-userselect","",{width:"450px"},{id:this.id+"_dimension_filter"});this.renderListContainer();this.renderConditionContainer();this.renderRankContainer();this.filterContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:450,minHeight:200,maxWidth:450,title:"Filters",zIndex:1e4,enableResize:!1,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,showOnInit:!1,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-dimension-filter-dialog",enableModal:!0,beforeClose:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});this.renderFooter();this.ejFilterDialog=this.filterContainer.data("BoldBIDashboardDialog")},n.prototype.renderListContainer=function(){this.listContainer=BoldBIDashboard.buildTag("div","",{width:"100%",height:"35px","border-bottom":"1px solid var(--designer-primary-border-color)",padding:"10px 0px"},{id:this.id+"_dimension_filter_list"});var n=BoldBIDashboard.buildTag("table","",{width:"100%",height:"100%",padding:"0px 15px"},{}),t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td","",{width:"40%"},{}),r=BoldBIDashboard.buildTag("td","",{width:"60%"},{id:this.id+"_dimension_filter_list_dropDownCell"}),u=BoldBIDashboard.buildTag("span","List",{});this.listContainer.append(n);n.append(t);t.append(i).append(r);i.append(u);this.filterContainer.append(this.listContainer);this.targetItem=BoldBIDashboard.buildTag("div","",{width:"245px",height:"100%"},{});r.append(this.targetItem)},n.prototype.renderConditionContainer=function(){var n,t,p;this.conditionContainer=BoldBIDashboard.buildTag("div","",{width:"100%",height:"100%",padding:"10px 0px"},{id:this.id+"_dimension_filter_condition"});n=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{});t=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{});this.conditionContainer.append(n).append(t);var i=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("tr","",{},{}),u=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_condition_summary_row"}),f=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{});this.conditionCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_condition_checkBox"});var w=BoldBIDashboard.buildTag("label","Condition",{"margin-left":"10px"},{"for":this.id+"_dimension_filter_condition_checkBox"}),b=BoldBIDashboard.buildTag("div.bbi-dbrd-dimension-info bbi-info-hide bbi-dbrd-designer-hoverable","",{},{id:this.id+"_dimension_filter-topn-info"}),e=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),k=BoldBIDashboard.buildTag("span","Column",{});this.conditionColumnDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_condition_columndropDown"});var s=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),h=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),d=BoldBIDashboard.buildTag("span","Summary",{});this.conditionSummaryDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_condition_summarydropDown"});n.append(i,r,u);i.append(f);f.append(this.conditionCheckBox,w,b);r.append(e,o);e.append(k);o.append(this.conditionColumnDropDown);u.append(s,h);s.append(d);h.append(this.conditionSummaryDropDown);var c=BoldBIDashboard.buildTag("tr","",{},{}),l=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{colspan:"3"}),a=BoldBIDashboard.buildTag("td","",{width:"25%",padding:"5px 0px"},{colspan:"1"}),v=BoldBIDashboard.buildTag("td","",{width:"10%",padding:"5px 0px"},{colspan:"1"}),y=BoldBIDashboard.buildTag("td","",{width:"25%",padding:"5px 0px"},{colspan:"1"});this.conditionTypeDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_conditionType_dropDown"});this.leftTextBox=BoldBIDashboard.buildTag("input","",{width:"100%"},{type:"text"});this.labelDiv=BoldBIDashboard.buildTag("div","",{width:"100%",padding:"0px 5px",display:"none"});p=BoldBIDashboard.buildTag("editLabel","and",{width:"100%"},{type:"label"});this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{width:"100%",display:"none"});this.rightTextBox=BoldBIDashboard.buildTag("input","",{width:"100%"},{type:"text"});t.append(c);c.append(l,a,v,y);l.append(this.conditionTypeDropDown);a.append(this.leftTextBox);this.labelDiv.append(p);v.append(this.labelDiv);this.rightTextBoxDiv.append(this.rightTextBox);y.append(this.rightTextBoxDiv);this.filterContainer.append(this.conditionContainer);this.conditionCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateConditionCheck,this)});this.conditionColumnDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionColumn,this)});this.conditionSummaryDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionSummary,this)});this.conditionTypeDropDown.BoldBIDashboardDropDownList({width:"85%",dataSource:this.conditionTypes,fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,selectedIndex:0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionValue,this)});this.conditionSummaryType=this.conditionTypes[0].value;this.leftTextBox.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.updateLeftTextBoxValue,this)});this.rightTextBox.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.updateRightTextBoxValue,this)})},n.prototype.renderRankContainer=function(){var n,p,t;this.rankContainer=BoldBIDashboard.buildTag("div.e-dbrd-dimension-top-n-container","",{width:"100%",height:"100%",padding:"10px 0px"},{id:this.id+"_dimension_filter_rank"});n=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{});this.rankContainer.append(n);var i=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("tr","",{},{}),u=BoldBIDashboard.buildTag("tr","",{},{}),f=BoldBIDashboard.buildTag("tr","",{},{}),e=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_rank_date_time_row"}),o=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_rank_summary_row"}),s=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{});this.rankCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_rank_checkBox"});var k=BoldBIDashboard.buildTag("label","Rank",{"margin-left":"10px"},{"for":this.id+"_dimension_filter_rank_checkBox"}),d=BoldBIDashboard.buildTag("div.bbi-dbrd-dimension-info bbi-info-hide bbi-dbrd-designer-hoverable","",{},{id:this.id+"_dimension_filter-topn-info"}),h=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),c=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),g=BoldBIDashboard.buildTag("span","Mode",{});this.rankModeDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankMode_dropDown"});var l=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),a=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),nt=BoldBIDashboard.buildTag("span","Count",{});this.rankCountUpDown=BoldBIDashboard.buildTag("input","",{},{type:"text"});var v=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),y=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),tt=BoldBIDashboard.buildTag("span","Column",{});this.rankColumnDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankColumn_dropDown"});p=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{});t=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{});this.dateTimeCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_rank_datetime_checkBox"});var it=BoldBIDashboard.buildTag("label","Based On Date and Time",{"margin-left":"10px"},{"for":this.id+"_dimension_filter_rank_datetime_checkBox"}),w=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),b=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),rt=BoldBIDashboard.buildTag("span.e-summary_text","Summary",{});this.rankFormatDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankFormat_dropDown"});n.append(i,r,u,f,e,o);i.append(s);s.append(this.rankCheckBox,k,d);r.append(h).append(c);h.append(g);c.append(this.rankModeDropDown);u.append(l).append(a);l.append(nt);a.append(this.rankCountUpDown);f.append(v).append(y);v.append(tt);y.append(this.rankColumnDropDown);e.append(p).append(t);t.append(this.dateTimeCheckBox).append(it);o.append(w).append(b);w.append(rt);b.append(this.rankFormatDropDown);this.filterContainer.append(this.rankContainer);this.rankCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateRankCheck,this)});this.rankModeDropDown.BoldBIDashboardDropDownList({width:"100%",dataSource:this.modeTypes,fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateRankMode,this)});this.rankCountUpDown.ejNumericTextbox({value:5,minValue:1,maxValue:1e10,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",width:"80px",change:this.bbdesigner$.proxy(this.updateRankCount,this)});this.rankColumnDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateRankColumn,this)});this.dateTimeCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateDateTimeValidation,this)});this.rankFormatDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"})},n.prototype.renderFooter=function(){var n=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_dimension_filter_ok_btn",type:"button"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_dimension_filter_cancel_btn",type:"button"}),i;n.on("click",this.bbdesigner$.proxy(this.saveFilters,this));t.on("click",this.bbdesigner$.proxy(this.closeFilterDialog,this));i=this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_foot");i.append(t,n)},n.prototype.updateConditionCheck=function(n){this.updateConditionFieldItemState(n.isChecked);this.modifiedConditionalFilter=!0;this.isConditionFilteringApplied=n.isChecked},n.prototype.updateConditionColumn=function(n){this.modifiedConditionalFilter=!0;this.columnName=n.text;this.columnId=n.value;var i=this.getItemType(this.columnId),t=i==="Dimensions"?this.dimensionFormats:this.measureFormats;this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t});this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(t[0].value)},n.prototype.updateConditionSummary=function(n){this.modifiedConditionalFilter=!0;this.summaryType=n.value},n.prototype.updateConditionValue=function(n){var t=n.value;NumberFilterOption.IsBetween===NumberFilterOption[t]||NumberFilterOption.IsNotBetween===NumberFilterOption[t]?this.showConditionElement(!0):this.showConditionElement(!1);this.modifiedConditionalFilter=!0;this.conditionSummaryType=t},n.prototype.showConditionElement=function(n){this.labelDiv.css("display",n?"block":"none");this.rightTextBoxDiv.css("display",n?"block":"none")},n.prototype.updateLeftTextBoxValue=function(n){this.modifiedConditionalFilter=!0;this.leftValue=n.value},n.prototype.updateRightTextBoxValue=function(n){this.modifiedConditionalFilter=!0;this.rightValue=n.value},n.prototype.updateConditionFieldItemState=function(n){n?(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").enable(),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").enable(),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").enable(),this.leftTextBox.data("ejNumericTextbox").enable(),this.rightTextBox.data("ejNumericTextbox").enable()):(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").disable(),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").disable(),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").disable(),this.leftTextBox.data("ejNumericTextbox").disable(),this.rightTextBox.data("ejNumericTextbox").disable())},n.prototype.updateRankCheck=function(n){this.updateRankFieldItemState(n.isChecked);this.modifiedTopNFilter=!0;this.isTopNFilteringApplied=n.isChecked},n.prototype.updateRankMode=function(n){this.modifiedTopNFilter=!0;this.mode=n.value},n.prototype.updateRankCount=function(n){this.modifiedTopNFilter=!0;this.numberOfRecords=n.value},n.prototype.updateRankColumn=function(n){var u;this.modifiedTopNFilter=!0;this.rankColumnName=n.text;this.rankColumnId=n.value;var i=this.isDateField(this.rankColumnId),f=this.isTimeField(this.rankColumnId),e=this.getItemType(this.rankColumnId),t,r=this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked();i||f?(t=r?i?this.dateTimeFormats:this.timeFormats:this.dimensionFormats,this.rankContainer.find("#"+this.id+"_dimension_filter_rank_date_time_row").css("display",""),u=r?"Format":"Summary",this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text").text(u)):(this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),t=e==="Dimensions"?this.dimensionFormats:this.measureFormats,this.rankContainer.find("#"+this.id+"_dimension_filter_rank_date_time_row").css("display","none"),this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text").text("Summary"));this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t});this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)},n.prototype.updateDateTimeValidation=function(n){var t=this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text"),i;this.modifiedTopNFilter=!0;i=this.isDateField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue());n.isChecked?(t.text("Format"),i?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dateTimeFormats}):this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.timeFormats}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)):(t.text("Summary"),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dimensionFormats}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0))},n.prototype.updateRankFieldItemState=function(n){n?(this.rankModeDropDown.data("BoldBIDashboardDropDownList").enable(),this.rankCountUpDown.data("ejNumericTextbox").enable(),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").enable(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").enable(),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").enable()):(this.rankModeDropDown.data("BoldBIDashboardDropDownList").disable(),this.rankCountUpDown.data("ejNumericTextbox").disable(),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").disable(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").disable(),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").disable())},n.prototype.openDimensionFilterWindow=function(n,t,i,r,u,f){var o,e,s,c,h,l;this.isDataHigh=f===!0;this.ejFilterDialog.open();this.resetFilter();this.targetInstance=n;this.targetMethod=t;this.fieldDetails=i;this.dataSetName=this.fieldDetails.DatasourceID;this.filterInfo=BoldBIDashboard.isNullOrUndefined(r)?new DimensionFilterInfo:this.bbdesigner$.extend(!0,this.filterInfo,r);o=this.dashboardDesigner.modules.dataSet;e=u.beforeUtilityDialogOpen(this.getDimensionUIModel(),"dimensionFilterDialog",i);BoldBIDashboard.isNullOrUndefined(o)||BoldBIDashboard.isNullOrUndefined(e)||(s=o.datasets.find(function(n){return n.Id===i.DatasourceID}),BoldBIDashboard.isNullOrUndefined(s)||BoldBIDashboard.isNullOrUndefined(s.TreeViewData)||(e.TopNFilter.Summary.Visibility=!1,e.ConditionalFilter.Summary.Visibility=!1));c={filters:[],fieldInfo:this.fieldDetails,filterInfo:r};this.fieldDetails.DateTimeFormat===DateTimeFormat.Date||this.fieldDetails.DateTimeFormat===DateTimeFormat.Default&&this.fieldDetails.FieldActualType!=="bbi-designer-dataset-time"?(h=!BoldBIDashboard.isNullOrUndefined(r)&&!BoldBIDashboard.isNullOrUndefined(r.AllowFilterInfo)&&!BoldBIDashboard.isNullOrUndefined(r.AllowFilterInfo.DateFilterInfo)?r.AllowFilterInfo.DateFilterInfo:null,this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").length>0?this.dateRangePopup.populateDateRangeDrpDwn(this.id+"_dimension_filter_date",this.targetItem,this.dataSetName,{Id:this.fieldDetails.Id,Name:this.fieldDetails.Name},h,"DimensionFilter",this.targetItem.width()):this.dateRangePopup.renderDateRangeDrpDwn(this.id+"_dimension_filter_date",this.targetItem,this.dataSetName,{Id:this.fieldDetails.Id,Name:this.fieldDetails.Name},h,"DimensionFilter",this.targetItem.width()),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").css("display","block")):(this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").length>0&&this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").css("display","none"),this.multiSelectionComboBox.renderMultiSelectionComboBox(this.targetItem,this.id+"_dimension_filter",this.fieldDetails.DatasourceID,c),l=!BoldBIDashboard.isNullOrUndefined(r)&&!BoldBIDashboard.isNullOrUndefined(r.AllowFilterInfo)?r.AllowFilterInfo:null,this.multiSelectionComboBox.populateMultiSelectionItem(this.id+"_dimension_filter",l));this.populateFilterValues(e);this.updateUtilityModel(e);this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_condition").css("display",i.IsFilterColumn?"none":"")},n.prototype.updateUtilityModel=function(n){this.updateTopNModel(n.TopNFilter);this.updateConditionModel(n.ConditionalFilter)},n.prototype.updateTopNModel=function(n){n.Rank.Enable?this.rankCheckBox.data("BoldBIDashboardCheckBox").enable():this.rankCheckBox.data("BoldBIDashboardCheckBox").disable();this.isTopNFilteringApplied&&(n.Mode.Enable?this.rankModeDropDown.data("BoldBIDashboardDropDownList").enable():this.rankModeDropDown.data("BoldBIDashboardDropDownList").disable(),n.Count.Enable?this.rankCountUpDown.data("ejNumericTextbox").enable():this.rankCountUpDown.data("ejNumericTextbox").disable(),n.Column.Enable?this.rankColumnDropDown.data("BoldBIDashboardDropDownList").enable():this.rankColumnDropDown.data("BoldBIDashboardDropDownList").disable(),n.Summary.Enable?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").enable():this.rankFormatDropDown.data("BoldBIDashboardDropDownList").disable(),this.rankCountUpDown.data("ejNumericTextbox").option("minValue",1),this.rankCountUpDown.data("ejNumericTextbox").option("maxValue",1e10));n.Summary.Visibility?this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").css("display","contents"):this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").css("display","none");n.InfoText.trim()!==""?this.rankContainer.find(".bbi-dbrd-dimension-info").addClass("bbi-info-show").removeClass("bbi-info-hide").attr("data-tooltip",n.InfoText):this.rankContainer.find(".bbi-dbrd-dimension-info").removeClass("bbi-info-show").addClass("bbi-info-hide").removeAttr("data-tooltip")},n.prototype.updateConditionModel=function(n){n.Condition.Enable?this.conditionCheckBox.data("BoldBIDashboardCheckBox").enable():this.conditionCheckBox.data("BoldBIDashboardCheckBox").disable();this.isConditionFilteringApplied&&(n.Column.Enable?this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").enable():this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").disable(),n.Summary.Enable?this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").enable():this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").disable());n.InfoText.trim()!==""?this.conditionContainer.find(".bbi-dbrd-dimension-info").addClass("bbi-info-show").removeClass("bbi-info-hide").attr("data-tooltip",n.InfoText):this.conditionContainer.find(".bbi-dbrd-dimension-info").removeClass("bbi-info-show").addClass("bbi-info-hide").removeAttr("data-tooltip");n.Summary.Visibility?this.conditionContainer.find("#"+this.id+"_dimension_filter_condition_summary_row").css("display","contents"):this.conditionContainer.find("#"+this.id+"_dimension_filter_condition_summary_row").css("display","none")},n.prototype.getDimensionUIModel=function(){return{TopNFilter:this.getTopNModel(),ConditionalFilter:this.getConditionalModel(),AllowFilter:this.getAllowFilterModel()}},n.prototype.getTopNModel=function(){return{Rank:{Enable:!0},Mode:{Enable:!0},Count:{Enable:!0,MinValue:1,MaxValue:1e10},Column:{Enable:!0},Summary:{Enable:!0,Visibility:!0},DateTime:{Enable:!0},InfoText:""}},n.prototype.getConditionalModel=function(){return{Condition:{Enable:!0},Column:{Enable:!0},Summary:{Enable:!0,Visibility:!0},ConditionDropDown:{Enable:!0},ConditionValue:[{Enable:!0}],InfoText:""}},n.prototype.getAllowFilterModel=function(){return{List:{Enable:!0}}},n.prototype.resetFilter=function(){this.filterInfo=null;this.dataFieldItems=[];this.measuresList=[];this.dimensionsList=[];this.targetInstance=null;this.targetMethod=null},n.prototype.populateFilterValues=function(){this.updateDatasetFields();this.populateConditionFields();this.populateRankFields();this.updateConditionFieldItemState(this.isConditionFilteringApplied);this.updateRankFieldItemState(this.isTopNFilteringApplied)},n.prototype.updateDatasetFields=function(){for(var i,r=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInsFromDSId(this.dashboardDesigner,this.dataSetName),u=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(r),f=this.dashboardDesigner.modules.dataSet.datasets,t=BoldBIDashboard.DashboardUtil.getCurrentField(f,this.dataSetName,u),n=0;n<t.length;n++)this.dataFieldItems.push({text:t[n].Name,value:t[n].Id}),i=BoldBIDashboard.DashboardUtil.getDatasetTypeIcon(t[n].TypeName),i==="bbi-designer-dataset-number"?this.measuresList.push({Name:t[n].Name,DatasetIcon:i,DataField:t[n].Id}):this.dimensionsList.push({Name:t[n].Name,DatasetIcon:i,DataField:t[n].Id})},n.prototype.getItemType=function(n){for(var i="",t=0;t<this.measuresList.length;t++)this.measuresList[t].DataField===n&&(i="Measures");for(t=0;t<this.dimensionsList.length;t++)this.dimensionsList[t].DataField===n&&(i="Dimensions");return i},n.prototype.isTimeField=function(n){for(var i=!1,t=0;t<this.dimensionsList.length;t++)this.dimensionsList[t].DataField===n&&this.dimensionsList[t].DatasetIcon==="bbi-designer-dataset-time"&&(i=!0);return i},n.prototype.isDateField=function(n){for(var i=!1,t=0;t<this.dimensionsList.length;t++)this.dimensionsList[t].DataField===n&&this.dimensionsList[t].DatasetIcon==="bbi-designer-dataset-datetime"&&(i=!0);return i},n.prototype.populateConditionFields=function(){var n,t;this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems});this.filterInfo&&this.filterInfo.IsConditionFilteringApplied&&!BoldBIDashboard.isNullOrUndefined(this.filterInfo.ConditionFilterInfo)?(this.conditionCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.IsConditionFilteringApplied}),this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.ColumnId),n=this.getItemType(this.filterInfo.ConditionFilterInfo.ColumnId),t=n==="Dimensions"?this.dimensionFormats:this.measureFormats,this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t}),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.SummaryType),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.ConditionSummaryType),this.filterInfo.ConditionFilterInfo.ConditionSummaryType===NumberFilterOption.IsBetween||this.filterInfo.ConditionFilterInfo.ConditionSummaryType===NumberFilterOption.IsNotBetween?(this.leftTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[0]}),this.rightTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[1]})):this.leftTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[0]}),this.modifiedConditionalFilter=!0,this.isConditionFilteringApplied=!0):(this.conditionCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),n=this.getItemType(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),t=n==="Dimensions"?this.dimensionFormats:this.measureFormats,this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t}),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.leftTextBox.data("ejNumericTextbox").setModel({value:0}),this.modifiedConditionalFilter=!1,this.isConditionFilteringApplied=!1)},n.prototype.populateRankFields=function(){var u,n,i,r,t;if(this.filterInfo.IsTopNFilteringApplied&&!BoldBIDashboard.isNullOrUndefined(this.filterInfo.TopNFilterInfo)){this.rankCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.IsTopNFilteringApplied});this.rankModeDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.TopNFilterInfo.Mode);this.rankCountUpDown.data("ejNumericTextbox").setModel({value:this.filterInfo.TopNFilterInfo.NoOfRecords});this.rankColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems});this.rankColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.TopNFilterInfo.ColumnId);var n=this.isDateField(this.filterInfo.TopNFilterInfo.ColumnId),i=this.isTimeField(this.filterInfo.TopNFilterInfo.ColumnId),r=this.getItemType(this.filterInfo.TopNFilterInfo.ColumnId),t=[];t=n||i?this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField?n?this.dateTimeFormats:this.timeFormats:this.dimensionFormats:r==="Dimensions"?this.dimensionFormats:this.measureFormats;this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField});this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t});u=this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField?this.filterInfo.TopNFilterInfo.DateFormat.toString():this.filterInfo.TopNFilterInfo.SummaryType.toString();this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(u);this.isTopNFilteringApplied=!0}else this.rankCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.rankModeDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.rankCountUpDown.data("ejNumericTextbox").setModel({value:5}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),n=this.isDateField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),i=this.isTimeField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),n||i?(this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!0}),n?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dateTimeFormats}):this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.timeFormats}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)):(r=this.getItemType(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),t=r==="Dimensions"?this.dimensionFormats:this.measureFormats,this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)),this.isTopNFilteringApplied=!1,this.modifiedTopNFilter=!1;this.rankCheckBox.data("BoldBIDashboardCheckBox").enable();this.rankCountUpDown.data("ejNumericTextbox").setModel({maxValue:1e10})},n.prototype.saveFilters=function(){var i,f,u,e,o,s;if(this.targetInstance!==null&&!this.multiSelectionComboBox.isMultiSelectionPopupLoading()){this.filterInfo=new DimensionFilterInfo;var n=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter"),t=this.dateRangePopup.getDateRangeValues(this.id+"_dimension_filter_date"),r=[];if(this.checkDimensionFilterChange(),!n.IsCheckAll||!BoldBIDashboard.isNullOrUndefined(n.FilterValues)&&n.IsCheckAll&&this.multiSelectionComboBox.getPopupRadioButton2(this.id+"_dimension_filter").prop("checked")){for(this.filterInfo.IsAllowFilteringApplied=!0,this.filterInfo.AllowFilterInfo=new AllowFilteringInfo,this.filterInfo.AllowFilterInfo.IsCheckAll=n.IsCheckAll,this.filterInfo.AllowFilterInfo.IsInclude=n.IsInclude,this.filterInfo.AllowFilterInfo.IsDateFormatFilteringApplied=!1,this.filterInfo.AllowFilterInfo.CheckAllState=n.CheckAllState,i=0;i<n.FilterValues.length;i++)n.FilterValues[i].value===undefined?r.push(n.FilterValues[i]):r.push(n.FilterValues[i].value);this.filterInfo.AllowFilterInfo.FilterValues=r}this.fieldDetails.DateTimeFormat!==DateTimeFormat.Date&&this.fieldDetails.DateTimeFormat!==DateTimeFormat.Default||!t.IsFilterApplied||BoldBIDashboard.isNullOrUndefined(t.StartDate)||BoldBIDashboard.isNullOrUndefined(t.EndDate)||(this.filterInfo.IsAllowFilteringApplied=!0,BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo)&&(this.filterInfo.AllowFilterInfo=new AllowFilteringInfo),this.filterInfo.AllowFilterInfo.IsDateFormatFilteringApplied=!0,this.filterInfo.AllowFilterInfo.DateFilterInfo=new DateRangeFilterInfo,this.filterInfo.AllowFilterInfo.DateFilterInfo.DateFormatCondition=t.DateFormatCondition,this.filterInfo.AllowFilterInfo.DateFilterInfo.StartDate=t.StartDate,this.filterInfo.AllowFilterInfo.DateFilterInfo.EndDate=t.EndDate);this.modifiedConditionalFilter&&(this.filterInfo.IsConditionFilteringApplied=this.isConditionFilteringApplied,this.filterInfo.ConditionFilterInfo=new ConditionFilteringInfo,this.filterInfo.ConditionFilterInfo.ColumnName=this.columnName,this.filterInfo.ConditionFilterInfo.ColumnId=this.columnId,this.filterInfo.ConditionFilterInfo.SummaryType=this.summaryType,this.filterInfo.ConditionFilterInfo.ConditionSummaryType=this.conditionSummaryType,this.filterInfo.ConditionFilterInfo.Values[0]=this.leftValue.toString(),this.filterInfo.ConditionFilterInfo.Values[1]=this.rightValue.toString());this.modifiedTopNFilter&&(this.filterInfo.IsTopNFilteringApplied=this.isTopNFilteringApplied,this.filterInfo.TopNFilterInfo=new TopNFilteringInfo,this.filterInfo.TopNFilterInfo.Mode=this.mode,this.filterInfo.TopNFilterInfo.NoOfRecords=this.numberOfRecords,this.filterInfo.TopNFilterInfo.ColumnName=this.rankColumnName,this.filterInfo.TopNFilterInfo.ColumnId=this.rankColumnId,f=this.widgetHelper.getCurrentWidgetInstance(),u=f.getJson().FilterSettings,this.filterInfo.TopNFilterInfo.IsHierarchicalFilter=BoldBIDashboard.isNullOrUndefined(u)?!0:u.HierarchicalFilter,this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField=this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()?(e=this.rankFormatDropDown.data("BoldBIDashboardDropDownList").getSelectedValue(),this.filterInfo.TopNFilterInfo.DateFormat=e):(o=this.rankFormatDropDown.data("BoldBIDashboardDropDownList").getSelectedValue(),this.filterInfo.TopNFilterInfo.SummaryType=o));this.filterInfo.IsAllowFilteringApplied||this.filterInfo.IsConditionFilteringApplied||this.filterInfo.IsTopNFilteringApplied||(this.filterInfo=null);s=[this.filterInfo,this.fieldDetails];BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,s);this.closeFilterDialog()}},n.prototype.closeFilterDialog=function(n){if(n&&this.isDataHigh){var t=this.dashboardDesigner.modules.dataConfiguration;BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.DashboardUtil.invokeMethod(t,"postDraggedFields",[])}this.isDataHigh=!1;this.multiSelectionComboBox.hideMultiSelectionWaitingPopup(!0);this.hideWaitingPopup();this.ejFilterDialog.close()},n.prototype.closeDialog=function(n){var t,i;this.hideWaitingPopup();this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_multi_select_dropDown").remove();this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_popup_container").remove();t=this.bbdesigner$("#"+this.id+"_dimension_filter_date_dateRange_popup");t.length>0&&(t.css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").removeClass("e-focus"),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn .bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-up").addClass("e-arrow-sans-down"));n.model.position={X:0,Y:0};this.isDataHigh&&(i=this.dashboardDesigner.modules.dataConfiguration,BoldBIDashboard.isNullOrUndefined(i)||BoldBIDashboard.DashboardUtil.invokeMethod(i,"postDraggedFields",[]))},n.prototype.hideWaitingPopup=function(){var n=this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_popup_container_list_Box_div");!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0&&n.BoldBIDashboardWaitingPopup("hide")},n.prototype.checkDimensionFilterChange=function(){var u=this.dashboardDesigner.designerPanel.selectedReportItems[0].attr("controlType")===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetType,WidgetType.Filter),e=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter"),t=this.widgetHelper.getCurrentWidgetInstance(),i=t.DataGroupInfo.FieldContainers[0].FieldInfos[0],f=BoldBIDashboard.isNullOrUndefined(i)?null:i.FilterInfo,n,r;BoldBIDashboard.isNullOrUndefined(f)?u&&BoldBIDashboard.isNullOrUndefined(f)&&(this.modifiedConditionalFilter||this.modifiedTopNFilter||!e.IsCheckAll||this.fieldDetails.DateTimeFormat===DateTimeFormat.Date)&&t.clearFilter():(n=i.FilterInfo.DimensionFilterInfo,u&&!BoldBIDashboard.isNullOrUndefined(n)&&(this.isTopNhasSameValues(n)||this.isConditionFilterHasSameValues(n)||this.isAllowFilterHasSameValues(n)||this.isAllowFilterHasDateRange(n,i))&&t.clearFilter());r=t.getJson();r.FilterSettings.ActAsMasterWidget&&!BoldBIDashboard.isNullOrUndefined(r.SelectedFilterValues)&&r.SelectedFilterValues.length>0&&t.clearFilter()},n.prototype.isTopNhasSameValues=function(n){var t=!1;return BoldBIDashboard.isNullOrUndefined(n.TopNFilterInfo)||(t=this.isTopNFilterModeChanged(n)||this.isTopNRecordsCountChanged(n)||this.isTopNColumnNameChnaged(n)||this.isTopNColumnIdChanged(n)||this.isTopNBasedOnDateAndTimeFiled(n)||this.isTopNSummaryTypeChanged(n)||this.isTopNNDateTimeFormatChanged(n)),this.modifiedTopNFilter&&(!n.IsTopNFilteringApplied&&this.isTopNFilteringApplied||n.IsTopNFilteringApplied&&t)},n.prototype.isTopNFilterModeChanged=function(n){return n.TopNFilterInfo.Mode!==this.mode},n.prototype.isTopNRecordsCountChanged=function(n){return n.TopNFilterInfo.NoOfRecords!==this.numberOfRecords},n.prototype.isTopNColumnNameChnaged=function(n){return n.TopNFilterInfo.ColumnName!==this.rankColumnName},n.prototype.isTopNColumnIdChanged=function(n){return n.TopNFilterInfo.ColumnId!==this.rankColumnId},n.prototype.isTopNBasedOnDateAndTimeFiled=function(n){return n.TopNFilterInfo.IsBasedOnDateAndTimeField!==this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()},n.prototype.isTopNSummaryTypeChanged=function(n){var t=this.rankFormatDropDown.data("BoldBIDashboardDropDownList");return!this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()&&n.TopNFilterInfo.SummaryType!==BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,t.getSelectedValue().toLocaleLowerCase().replace(/\b[a-z]/g,function(n){return n.toUpperCase()}))},n.prototype.isTopNNDateTimeFormatChanged=function(n){var t=this.rankFormatDropDown.data("BoldBIDashboardDropDownList");return this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()&&!BoldBIDashboard.isNullOrUndefined(t)&&n.TopNFilterInfo.DateFormat!==BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(DateTimeFormatForFilter,t.selectedTextValue)},n.prototype.isConditionFilterHasSameValues=function(n){var t=!1;return BoldBIDashboard.isNullOrUndefined(n.ConditionFilterInfo)||(t=this.isConditionFilterColumnNameChanged(n)||this.isConditionFilterColumnIdChanged(n)||this.isConditionFilterSummaryTypeChanged(n)||this.isConditionFilterConditionSummaryTypeChanged(n)||this.isConditionFilterLeftValueChanged(n)||this.isConditionFilterRightValueChanged(n)),this.modifiedConditionalFilter&&(!n.IsConditionFilteringApplied&&this.isConditionFilteringApplied||n.IsConditionFilteringApplied&&t)},n.prototype.isConditionFilterColumnNameChanged=function(n){return n.ConditionFilterInfo.ColumnName!==this.columnName},n.prototype.isConditionFilterColumnIdChanged=function(n){return n.ConditionFilterInfo.ColumnId!==this.columnId},n.prototype.isConditionFilterSummaryTypeChanged=function(n){return n.ConditionFilterInfo.SummaryType!==this.summaryType},n.prototype.isConditionFilterConditionSummaryTypeChanged=function(n){return n.ConditionFilterInfo.ConditionSummaryType!==this.conditionSummaryType},n.prototype.isConditionFilterLeftValueChanged=function(n){return n.ConditionFilterInfo.Values[0]!==this.leftValue.toString()},n.prototype.isConditionFilterRightValueChanged=function(n){return n.ConditionFilterInfo.Values[1]!==this.rightValue.toString()},n.prototype.isAllowFilterHasSameValues=function(n){var i=!1,t=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter");return BoldBIDashboard.isNullOrUndefined(n.AllowFilterInfo)||(i=this.isAllowFilterCheckAllChanged(n,t)||this.isAllowFilterIncludeChanged(n,t)||this.isAllowFilterHasDateTimeFormat(n,t)||!this.isAllowFilterChange(n.AllowFilterInfo.FilterValues,t.FilterValues)),!t.IsCheckAll&&n.IsAllowFilteringApplied&&i},n.prototype.isAllowFilterCheckAllChanged=function(n,t){return n.AllowFilterInfo.IsCheckAll!==t.IsCheckAll},n.prototype.isAllowFilterIncludeChanged=function(n,t){return n.AllowFilterInfo.IsInclude!==t.IsInclude},n.prototype.isAllowFilterHasDateTimeFormat=function(n){return n.AllowFilterInfo.IsDateFormatFilteringApplied},n.prototype.isAllowFilterChange=function(n,t){return n.length===t.length&&n.every(function(n,i){return n===t[i]})},n.prototype.isAllowFilterHasDateRange=function(n,t){if(!BoldBIDashboard.isNullOrUndefined(n.AllowFilterInfo)&&!BoldBIDashboard.isNullOrUndefined(n.AllowFilterInfo.DateFilterInfo)){var i=this.dateRangePopup.getDateRangeValues(this.id+"_dimension_filter_date"),r=this.isAllowFilterDateFomartCondtionModified(n,i)||this.isAllowFilterStartDateChanged(n,i)||this.isAllowFilterEndDateChanged(n,i);return(t.DateTimeFormat===DateTimeFormat[DateTimeFormat.Date]||this.fieldDetails.DateTimeFormat===DateTimeFormat.Default)&&n.IsAllowFilteringApplied&&r}return!1},n.prototype.isAllowFilterDateFomartCondtionModified=function(n,t){return n.AllowFilterInfo.DateFilterInfo.DateFormatCondition!==t.DateFormatCondition},n.prototype.isAllowFilterStartDateChanged=function(n,t){return n.AllowFilterInfo.DateFilterInfo.StartDate!==t.StartDate},n.prototype.isAllowFilterEndDateChanged=function(n,t){return n.AllowFilterInfo.DateFilterInfo.EndDate!==t.EndDate},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DimensionFilter",InternalDimensionFilter,window);InternalDragDropHelper=function(){function n(n){this.dashboardDesigner=null;this.zIndex="";this.dragging=null;this.pageY=0;this.isWidgetListDrag=!1;this.itemJson=null;this.restrictDrop=!1;this.locale=null;this.fieldInfo=null;this.paramName="";this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.id=this.dashboardDesigner._id;this.designAreaContainer=this.dashboardDesigner.element.find("#"+this.id+"_designAreaContainer");this.designCanvas=this.designAreaContainer.find(".bbi-dashboarddesigner-designcanvas");this.dragAndDropSettings=n.model.designerSettings.widgetsPanel.dragAndDropSettings;this.initalizeDraggable()}return n.prototype.initalizeDraggable=function(){this.dashboardDesigner.element.find(".e-draggable").BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),cursorAt:{top:-4,left:-10},drag:this.bbdesigner$.proxy(this.drag,this)})},n.prototype.initializeDraggable=function(n,t){n.BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),cursorAt:{top:-4,left:-10},drag:this.bbdesigner$.proxy(this.drag,this)});this.zIndex=t},n.prototype.initializeParameterDraggable=function(n){n.BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),drag:this.bbdesigner$.proxy(this.drag,this)})},n.prototype.initializeWidgetListDraggable=function(n,t){this.itemJson=t;n.BoldBIDashboardDraggable({clone:!0,cursor:"pointer",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),drag:this.bbdesigner$.proxy(this.drag,this)})},n.prototype.dragstart=function(n){this.dashboardDesigner.isItemDrag=!0;this.fieldInfo=null;this.paramName="";this.designAreaContainer=this.dashboardDesigner.element.find("#"+this.id+"_designAreaContainer");this.designCanvas=this.designAreaContainer.find(".bbi-dashboarddesigner-designcanvas");var t=this.bbdesigner$(n.element);t.hasClass("bbi-datafield")?this.fieldInfo={dataSetName:t.attr("e-dataset"),fieldName:t.attr("name")}:t.hasClass("e-parameter")?this.paramName=t.attr("name"):t.closest(".e-dbd-widget-list").length>0&&(this.isWidgetListDrag=!0)},n.prototype.updateRowSpan=function(n){var t=BoldBIDashboard.isNullOrUndefined(this.dragAndDropSettings.rowSpan)?isNaN(n)?6:n:this.dragAndDropSettings.rowSpan;return t=t<=24?t:24,this.hasTabbedOrCombinedWidgetInPanel()?isNaN(n)?6:n:t},n.prototype.updateColumnSpan=function(n){var t=BoldBIDashboard.isNullOrUndefined(this.dragAndDropSettings.columnSpan)?isNaN(n)?6:n:this.dragAndDropSettings.columnSpan;return t=t<=48?t:48,this.hasTabbedOrCombinedWidgetInPanel()?isNaN(n)?6:n:t},n.prototype.hasWidgetsInDesignCanvas=function(n){var t=this.widgetHelper.getAllWidgets();return t.length===0?!1:this.dashboardDesigner.designerPanel.isItemRestricted(n)},n.prototype.hasTabbedOrCombinedWidgetInPanel=function(){var t,n;if(this.dragAndDropSettings.isWidgetMode)for(t=this.widgetHelper.getAllWidgets(),n=0;n<t.length;n++)if(t[n].Type==="CombineWidget"||t[n].Type==="TabbedWidget")return!0;return!1},n.prototype.drag=function(n){var i,s,l,a;this.restrictDrop=!1;var r=this.getPosition("clientX",n.event),u=this.getPosition("clientY",n.event),f=this.designCanvas[0].getBoundingClientRect(),t=this.dashboardDesigner.designerPanel;if(!BoldBIDashboard.isNullOrUndefined(n.element)&&(this.bbdesigner$(n.element).hasClass("bbi-data-field-info-wrap")||this.bbdesigner$(n.element).hasClass("bbi-data-datefield-info-wrap")))this.dataFieldDrag(n,r,u);else if(f.left+parseFloat(this.designCanvas.css("padding-left"))<r&&f.top+parseFloat(this.designCanvas.css("padding-top"))<u&&f.right-parseFloat(this.designCanvas.css("padding-right"))>r&&f.bottom-parseFloat(this.designCanvas.css("padding-bottom"))>u){if(this.designAreaContainer.css("cursor","default"),this.draggingItem.css({display:"block",zIndex:this.zIndex}),i=t.getTargetElement({x:r,y:u,width:1,height:1}),!BoldBIDashboard.isNullOrUndefined(i)){var h=i.position(),c=this.designCanvas.find("#"+t.designId+"_placingItem"),v=Number(this.draggingItem.attr("data-min-rowspan")),y=Number(this.draggingItem.attr("data-min-colspan")),e=this.updateRowSpan(v),o=this.updateColumnSpan(y);c.attr({row:Number(i.attr("row")),column:Number(i.attr("column")),rowSpan:e,columnSpan:o});s={Row:Number(i.attr("row")),Column:Number(i.attr("column")),RowSpan:e,ColumnSpan:o};t.isWidgetItemRestricted=this.dragAndDropSettings.isWidgetMode?this.hasWidgetsInDesignCanvas(s):t.isItemRestricted(s,!1);l=t.getWidgetItemWidth(o);a=t.getWidgetItemHeight(e);t.isWidgetItemRestricted=this.dashboardDesigner.modules.containerTypeWidgetHelper.isDragRestricted(this.bbdesigner$(n.target),this.dashboardDesigner.element.find("#"+this.id+"_dragging_item"),t.isWidgetItemRestricted);c.css({display:"block","background-color":t.isWidgetItemRestricted?t.itemRestrictedColor:"transparent","border-color":t.isWidgetItemRestricted?"#f13232":"var(--selection-container-color)",left:h.left+t.cellMargin,top:h.top+t.cellMargin,width:l+2,height:a+2})}}else this.designCanvas.find("#"+t.designId+"_placingItem").css("display","none"),this.designAreaContainer.css("cursor","not-allowed"),this.restrictDrop=!0},n.prototype.dataFieldDrag=function(n,t,i){var a,v,e,c,l;this.droppingItem=null;this.draggingItem.css("zIndex",this.zIndex);var r=this.getDraggedFieldInfo(null,this.bbdesigner$(n.element)),f=this.getDataCategoryListContainer(n.event,r.ContainerName),u=BoldBIDashboard.isNullOrUndefined(f)?null:f.Container,y=BoldBIDashboard.isNullOrUndefined(f)?null:f.ParentContainer,s=this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement");if(!BoldBIDashboard.isNullOrUndefined(u)&&BoldBIDashboard.isNullOrUndefined(r.ContainerType)&&(r.ContainerType=f.Container.data("container-info").ContainerType),a=this.widgetHelper.getCurrentWidgetInstance(),v=a.onFieldDragDrop(r),!BoldBIDashboard.isNullOrUndefined(u)&&u.length>0&&v){this.droppingItem=u;e=u.data("container-info");s.css("cursor","default");var o=-1,h=-1,p=this.dashboardDesigner.element.find("#"+this.id+"_"+r.Id+"_categoryListDiv_"+BoldBIDashboard.DashboardUtil.escapeSelector(r.Name));(BoldBIDashboard.isNullOrUndefined(p[0])||r.ContainerName!=="Measures"&&r.ContainerName!=="Dimensions")&&(c=this.getEmptyFieldRowAndHoverIndex(u,y,t,i),h=c.emptyRowIndex,o=c.elementHoverIndex);(o>-1||u.children().length===0)&&h!==o?this.insertEmptyField(h,o,e,u):o===-1&&(s.css("cursor","not-allowed"),this.restrictDrop=!0);(e.Name==="Measures"||e.Name==="Dimensions"||e.Name==="Parameters")&&(this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement").css("cursor","not-allowed"),this.restrictDrop=!0)}else s.css("cursor","not-allowed"),l=this.dashboardDesigner.element.find("div.bbi-dbrd-rendercolumn-container .bbi-categorylistdiv-emptyfield:not(:last-child)"),l.insertAfter(l.siblings(":last")),this.restrictDrop=!0},n.prototype.getDraggedFieldInfo=function(n,t){var u=t.data("fieldInfo"),i=JSON.parse(JSON.stringify(u)),r;return BoldBIDashboard.isNullOrUndefined(n)||(r=n.data("container-info"),i.ContainerType=r.ContainerType),i},n.prototype.getEmptyFieldRowAndHoverIndex=function(n,t,i,r){for(var e=-1,f=-1,s=n.find(".bbi-category-empty-field-wrap"),u=0;u<n.children().length;u++){var o=n[0].children[u].getBoundingClientRect(),h=n[0].children[n[0].children.length-1].getBoundingClientRect(),c=t[0].getBoundingClientRect();n.children().eq(u).attr("id")===s.attr("id")&&(e=u);o.top<r&&o.bottom>r?f=u:r>h.bottom&&r<c.bottom&&(f=n.children().length-1)}return{emptyRowIndex:e,elementHoverIndex:f}},n.prototype.insertEmptyField=function(n,t,i,r){var u=r.find(".bbi-category-empty-field-wrap");(BoldBIDashboard.isNullOrUndefined(i.CategoryCount)||u.length===1||r.children().length<=i.CategoryCount)&&(n<t?u.insertAfter(r.children().eq(t)):u.insertBefore(r.children().eq(t)))},n.prototype.restrictAggregateField=function(n){var t,i;if(!BoldBIDashboard.isNullOrUndefined(n)&&!BoldBIDashboard.isNullOrUndefined(n.attr("id"))&&(t=n.data("fieldInfo"),i=this.getDataCategoryListContainer(t,t.ContainerName),!BoldBIDashboard.isNullOrUndefined(i)&&!BoldBIDashboard.isNullOrUndefined(i.Container))){var u=i.Container,r=u.data("container-info"),f=r.Name,e=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(FieldContainerType,r.ContainerType),o=t.IsAggregatedExpression,s=this.widgetHelper.getCurrentWidgetInstance();return this.restrictDrop=!s.isFieldValid(o,e,f),this.restrictDrop&&this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DataConfiguration,this.locale.alertWindowMesages.restrictedFieldMessage,IconType.warning,AlertType.Alert,!1,null),this.restrictDrop}return this.restrictDrop=!1},n.prototype.getValidatedContainer=function(n,t,i){var u=this.dashboardDesigner.element.find("#"+this.id+"_"+i+"_categoryListPanel"),r=BoldBIDashboard.isNullOrUndefined(u)?null:u[0].getBoundingClientRect();return!BoldBIDashboard.isNullOrUndefined(r)&&r.left<n&&r.top<t&&r.right>n&&r.bottom>t?{ParentContainer:u,Container:this.dashboardDesigner.element.find("#"+this.id+"_"+i+"_categoryList")}:null},n.prototype.getDataCategoryListContainer=function(n,t){var f=this.getPosition("clientX",n),e=this.getPosition("clientY",n),u,i,r;if(t==="Measures"||t==="Dimensions"||t==="Parameters"){for(u=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"getCategories"),i=0;i<u.length;i++)if((BoldBIDashboard.isNullOrUndefined(u[i].Visibility)||u[i].Visibility!==Visibility.hidden)&&(r=this.getValidatedContainer(f,e,u[i].Name),!BoldBIDashboard.isNullOrUndefined(r)))return r}else if(!BoldBIDashboard.isNullOrUndefined(t)&&(r=this.getValidatedContainer(f,e,t),!BoldBIDashboard.isNullOrUndefined(r)))return r;return null},n.prototype.dragStop=function(n,t,i){var s,r;BoldBIDashboard.isNullOrUndefined(i)||(this.droppingItem=i);var o=this.id,u=this.dashboardDesigner.designerPanel,e=this.designCanvas.find("#"+o+"_placingItem"),c=this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement"),l=this.bbdesigner$(n.target);this.dashboardDesigner.isItemDrag=!1;var f=this.dashboardDesigner.element.find("#"+o+"_dragging_item"),a=f.attr("data-widgetnamespace"),v=f.attr("data-widgetname"),y=f.attr("data-widgetid"),p=Number(f.attr("data-min-rowspan")),w=Number(f.attr("data-min-colspan")),b=this.updateRowSpan(p),k=this.updateColumnSpan(w);if(f.remove(),s=u.isDesignerSections(l),BoldBIDashboardDesigner.editManager.setMergeAction(!0),s){if(r={Row:Number(e.attr("row")),Column:Number(e.attr("column")),RowSpan:b,ColumnSpan:k},u.isWidgetItemRestricted=this.dragAndDropSettings.isWidgetMode?this.hasWidgetsInDesignCanvas(r):u.isItemRestricted(r,!1),this.dragAndDropSettings.isWidgetMode&&!this.hasTabbedOrCombinedWidgetInPanel()&&(r.Row=0,r.Column=0),!u.isWidgetItemRestricted)if(this.isWidgetListDrag)this.itemJson.ContainerSettings.Bounds.Row=r.row,this.itemJson.ContainerSettings.Bounds.Column=r.column,u.pasteWidgetElement(this.itemJson);else if(!BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(n.element).parent(".e-widget-collection-wrapper"))&&this.bbdesigner$(n.element).parent(".e-widget-collection-wrapper").length>0){var h=this.bbdesigner$(n.element).parent(".e-widget-collection-wrapper").attr("data-dbrdId"),d=this.bbdesigner$(n.element).parent(".e-widget-collection-wrapper").attr("data-version"),g=this.bbdesigner$(n.element).attr("data-widgetId");u.droppedWidget(h,d,g,r)}else if(!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.predefinedWidgets)&&this.bbdesigner$(n.element).attr("data-widgetclass").indexOf("e-predefinedwidgets")>=0){var h=this.bbdesigner$(n.element).attr("data-dbrdid"),nt=this.bbdesigner$(n.element).attr("data-dbrdversion"),tt=this.bbdesigner$(n.element).attr("data-widgetId");u.droppedWidget(h,nt,tt,r)}else this.droppedReportItems(a,v,"",r,y)}else!this.restrictDrop&&u.selectedReportItems.length>0&&(BoldBIDashboard.isNullOrUndefined(this.droppingItem)||this.dataFieldDragStop(n,t));this.bbdesigner$(c).css("cursor","default");e.css({display:"none","background-color":u.itemPlacingColor});this.isWidgetListDrag=!1;this.dashboardDesigner.modules.undoManager.setMergeAction(!1);this.designAreaContainer.css("cursor","default");this.droppingItem=null},n.prototype.dataFieldDragStop=function(n,t){var c=this.bbdesigner$(n.element),ot=this.bbdesigner$(n.target),l=this.droppingItem,i=this.getDraggedFieldInfo(l,c),vt=this.widgetHelper.getCurrentWidgetInstance(),st=JSON.parse(JSON.stringify(i)),yt=l.data("container-info"),v=st.ContainerName=yt.Name,pt=BoldBIDashboard.isNullOrUndefined(t)?vt.onFieldDragDrop(st,this.droppingItem,n):!1,d,ht,ct,g,nt,f,a,rt,ut,h,o,ft,et,lt,at;if(this.restrictAggregateField(c),!BoldBIDashboard.isNullOrUndefined(c)&&(c.hasClass("bbi-data-field-info-wrap")||c.hasClass("bbi-data-datefield-info-wrap"))&&(pt&&BoldBIDashboard.isNullOrUndefined(t)&&!this.restrictDrop||!BoldBIDashboard.isNullOrUndefined(t))){var e=-1,w=-1,s=-1,tt=0,y=0,b=0,it=void 0,wt=c.attr("label"),u=l.children(),p=l.find(".bbi-category-empty-field-wrap"),k=0,r=0;for(f=0;f<u.length;f++)it=u[f].getElementsByClassName("e-heirachy-field"),d=this.bbdesigner$(it),BoldBIDashboard.isNullOrUndefined(d.attr("child-field-count"))||(k=k+parseInt(d.attr("child-field-count"),10)),e!==-1&&BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)||(BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)?(r=k,tt++):r=i.ChildHierarchicalFields.length),u[f].id===p.attr("id")&&(e=y,s=f),(u[f].id===this.id+"_"+i.Id+"_categoryListParentDiv_"+i.UniqueId||u[f].id===this.id+"_"+i.Id+"_categoryListDiv_"+i.UniqueId)&&(w=y),it.length>0&&k!==0&&i.ContainerName==="Column"&&(y=y+(parseInt(d.attr("child-field-count"),10)-1)),tt<r&&(tt=r,b++),y++;if(ht=this.dashboardDesigner.element.find("#"+this.id+"_"+i.Id+"_categoryListDiv_"+wt),ct=this.widgetHelper.getCurrentWidgetInstance(),BoldBIDashboard.isNullOrUndefined(ht[0])||i.ContainerName!=="Measures"&&i.ContainerName!=="Dimensions"){if(g=null,p.length<1||!BoldBIDashboard.isNullOrUndefined(t)&&!t){for(nt=ot.closest("[label]"),nt.length<1&&(nt=!BoldBIDashboard.isNullOrUndefined(t)&&!t?this.bbdesigner$(u[0]):this.bbdesigner$(u[u.length-1])),f=0;f<u.length;f++)nt.attr("id")===u[f].id&&(e=f);g=this.getRemoveItem(ot,l,t,e,i)}v!=="Measures"&&v!=="Dimensions"&&v!=="Parameters"&&(v!==i.ContainerName&&(i.ContainerName==="Measures"||i.ContainerName==="Dimensions"||i.ContainerName==="Parameters")?(r=r>0?b>0?r-b:r-1:r,e=e+r,a=this.getAddItem(ct,i,e,v,!1,r,b),a.IsDisplayNameEdited||(a.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(a)),rt=this.dashboardDesigner.modules.dataConfiguration,p.length<1?BoldBIDashboard.DashboardUtil.invokeMethod(rt,"replaceItem",[g,a]):(BoldBIDashboard.isNullOrUndefined(t)||t||this.dashboardDesigner.modules.dataConfiguration.removeItem(g,!1,!0,!1),BoldBIDashboard.DashboardUtil.invokeMethod(rt,"addItem",[a,!1,!0]))):(e=e+r,w=w+r,s=s+r,ut=this.dashboardDesigner.element.find("#"+this.id+"_"+i.Id+"_categoryListDiv_"+i.UniqueId),BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)||(ut=this.dashboardDesigner.element.find("#"+this.id+"_"+i.Id+"_categoryListParentDiv_"+i.UniqueId)),h=e-r,o=w-r,s=s-r,s>-1&&u.length>0&&(this.dashboardDesigner.element.find("#"+ut[0].id).insertBefore(u[s]),p.length>0&&s<u.length-1&&p.insertAfter(l.children().last()),o=o<0?0:o,BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)?(ft=JSON.parse(JSON.stringify(i)),ft.ItemIndex=o,et=JSON.parse(JSON.stringify(i)),et.ItemIndex=h,lt=h<o?o-1:o,at=h>o?h-1:h,this.updateReorderInfo(ft,et,lt,at)):this.reorderForHeiarchyFields(i,r,o,h))))}}},n.prototype.reorderForHeiarchyFields=function(n,t,i,r){for(var f,e,o,s,u=0;u<t;u++)f=JSON.parse(JSON.stringify(n)),f.ItemIndex=i,e=JSON.parse(JSON.stringify(n)),e.ItemIndex=r,o=r<i?i-1+u:i+u,s=r>i?r-1+u:r+u,i<r?this.updateReorderInfo(f,e,i,r-1):this.updateReorderInfo(f,e,o,s)},n.prototype.updateReorderInfo=function(n,t,i,r){if(i!==r){BoldBIDashboardDesigner.editManager.addCmdAction(CommandAction.DataAssignUpdate,"reorderItem","DataConfiguration","",[n,{previousIndex:r,currentIndex:i}],[t,{previousIndex:i,currentIndex:r}]);var u=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo;BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateDataGroupInfo",[n,u,{previousIndex:i,currentIndex:r}]);BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"postDraggedFields",[])}},n.prototype.getRemoveItem=function(n,t,i,r,u){var e=new BoldBIDashboard.Dashboard.FieldInfoForUI,c=t.find(".bbi-category-empty-field-wrap"),s=t.children(),l=t.data("container-info"),h=0,o,f;if(c.length<1||!BoldBIDashboard.isNullOrUndefined(i)&&!i){for(o=n.closest(".bbi-ds-categoryLabel"),o.length<1&&(o=!BoldBIDashboard.isNullOrUndefined(i)&&!i?s:s.eq(s.length-1)),f=0;f<s.length;f++)o.attr("id")===s[f].id&&(r=f),this.bbdesigner$(o[f]).hasClass("bbi-data-field-info-wrap")&&(h=f);l.Name!==u.ContainerName&&u.ContainerName==="Measures"||u.ContainerName==="Dimensions"||u.ContainerName==="Parameters"?(e=JSON.parse(JSON.stringify(this.bbdesigner$(o[h]).data("fieldInfo"))),e.IsLoading=!1,e.IsExpression=!1,e.ItemIndex=r):e=null}return e},n.prototype.getAddItem=function(n,t,i,r,u,f,e){u===void 0&&(u=!1);f===void 0&&(f=0);e===void 0&&(e=0);var c=this.dashboardDesigner.modules.dataConfiguration,p=c.getAvailableName(),l=!1,a=!1,h=c.getExpressionField(t.Id,u),v=r==="FilterColumn"?!0:!1;BoldBIDashboard.isNullOrUndefined(h)||(l=u?t.IsExpression:h.IsExpression,a=u?t.IsAggregatedExpression:h.IsAggregatedExpression);var y=n.getDefaultSummaryType(t.FieldType,t.ContainerType,t.IsAggregatedExpression),s=n.getDefaultDateFormat(),o=(t.FieldActualType==="bbi-designer-dataset-datetime"||t.FieldActualType==="bbi-designer-dataset-time")&&t.ContainerType===FieldContainerType.Numeric?"bbi-designer-dataset-string":t.FieldActualType;return t.UniqueId=p,u?(t.SummaryType=SummaryType.NONE,o==="bbi-designer-dataset-datetime"||o==="bbi-designer-dataset-time"?t.DateTimeFormat===DateTimeFormat.None&&(t.DateTimeFormat=DateTimeFormat.Date):t.DateTimeFormat=DateTimeFormat.None):(t.SummaryType=BoldBIDashboard.isNullOrUndefined(y)?t.ContainerType===FieldContainerType.Numeric?t.FieldType===FieldType.Measures?SummaryType.SUM:SummaryType.COUNT:SummaryType.NONE:y,t.DateTimeFormat=t.IsParameterField&&o==="bbi-designer-dataset-datetime"?s===DateTimeFormat.None?DateTimeFormat.MonthDayYear:s:s===DateTimeFormat.None?o==="bbi-designer-dataset-datetime"?DateTimeFormat.Year:o==="bbi-designer-dataset-time"?DateTimeFormat.Default:t.DateTimeFormat:s),t.IsLoading=!1,t.ItemIndex=i,t.IsExpression=l,t.IsAggregatedExpression=a,t.FieldActualType=o,t.ContainerName=r,t.hierarchyLevel=f,t.hierarchyCount=e,t.IsFilterColumn=v,t.IsVisible=v?!1:t.IsVisible,t},n.prototype.droppedReportItems=function(n,t,i,r,u){this.dashboardDesigner.designerPanel.renderItem(n,t,i,r,u);this.dashboardDesigner.modules.serialization.notifyChange()},n.prototype.helper=function(n){var t=this.bbdesigner$(n.element).clone(!0),u,i,r;return BoldBIDashboard.isNullOrUndefined(n.element)||BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(n.element).attr("id"))||this.bbdesigner$(n.element).attr("id").indexOf("categoryList")===-1?this.bbdesigner$(n.element)[0].children.length>0?(u=this.bbdesigner$(n.element)[0].children[0],u.className.indexOf("bbi-widgeticon")!==-1||u.className.indexOf("bbi-drag-handle-icon")!==-1?(t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.itemPanel,"getDragElement",[t]),this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):this.bbdesigner$(n.element).closest(".e-dbd-widget-list").length>0?(this.isWidgetListDrag=!0,this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):this.bbdesigner$(n.element).hasClass("e-parameter")?(i=this.bbdesigner$(n.element).attr("name"),r=this.bbdesigner$(n.element).find("span.bbi-designer-datatype-icon").attr("class"),t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"getDragElement",[i,r]),t.css("border-color","#0C8BE2"),this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):this.bbdesigner$(n.element).hasClass("bbi-datafield")?(i=this.bbdesigner$(n.element).attr("name"),r=this.bbdesigner$(n.element).find("span.bbi-designer-content-icon").attr("class"),t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"getDragElement",[i,r]),t.css("border-color","#0C8BE2"),this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):(this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item"))):(this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):t=this.draggingItem=this.getDataFieldDragItem(n,t),this.bbdesigner$(t)},n.prototype.getDataFieldDragItem=function(n,t){var r=t.data("fieldInfo"),i=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"getDragElement",[r]);return i.css("border-color","#0C8BE2"),i.attr("id",this.id+"_dragging_item"),i.css("width",this.dashboardDesigner.element.find("#"+this.id+"_"+r.ContainerName+"_categoryList")[0].offsetWidth-10),this.dashboardDesigner.element.find("#"+this.id+"_"+r.ContainerName+"_categoryItem").append(i),i},n.prototype.getPosition=function(n,t){var i=0;return t[n]?i=t[n]:t.originalEvent&&t.originalEvent.targetTouches&&t.originalEvent.targetTouches.length>0?i=t.originalEvent.targetTouches[0][n]:t.originalEvent&&t.originalEvent.changedTouches&&t.originalEvent.changedTouches.length>0&&(i=t.originalEvent.changedTouches[0][n]),i},n.prototype.initializeSortable=function(n,t,i,r,u){n.bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseDown,this.bbdesigner$.proxy(this.ondragStart,this,{element:t,diaglog:i,container:r,callBackMethod:u}));n.css("cursor","move")},n.prototype.ondragStart=function(n,t){this.bbdesigner$("body").bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseMove,this.bbdesigner$.proxy(this.ondrag,this,{container:n.container}));this.bbdesigner$("body").bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseUp,this.bbdesigner$.proxy(this.ondrop,this,n));this.dragging=BoldBIDashboard.buildTag("div","",{height:"auto",width:n.element.width(),position:"absolute",display:"block","border-style":"none","z-index":this.dashboardDesigner.element.find("#"+n.diaglog+"_wrapper").css("z-index")+10,top:t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY+1.5:t.pageY+1.5,left:t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX+1.5:t.pageX+1.5},{});this.dragging.append(n.element.clone());this.bbdesigner$("body").append(this.dragging);this.updateDragRegion(n.element,"bottom");n.element.hide()},n.prototype.ondrag=function(n,t){var s=this;if(this.dragging!=null){var u=this.bbdesigner$("#"+n.container),i=u.data("BoldBIDashboardScroller"),f=u.offset(),r=t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY:t.pageY,e=t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX:t.pageX;this.dragging.css({display:"block",position:"absolute",top:r+1.5,left:e+1.5});f.top>r?i.model.scrollTop>0&&i.model.scrollTop-5>0?i.scrollY(i.model.scrollTop-5):i.scrollY(0):r>f.top+u.height()&&i.scrollY(i.model.scrollTop+5);var h=u.find(".e-items").children(".e-drag-row:visible"),o=this,c=this.bbdesigner$;h.each(function(n,t){var i=c(t);if(o.isIntersect(e,r,i,u)){o.updateDragRegion(i,r<s.pageY?"bottom":"top");return}});this.pageY=r}},n.prototype.ondrop=function(n){n.element.show();var t=this.bbdesigner$("#"+this.id+"_drag_empty_area");n.element.insertAfter(t);this.dragging.remove();this.dragging=null;t.remove();BoldBIDashboard.isNullOrUndefined(n.callBackMethod)||BoldBIDashboard.DashboardUtil.invokeCallBack(n.callBackMethod,{});this.bbdesigner$("body").unbind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseMove,this.bbdesigner$.proxy(this.ondrag,this));this.bbdesigner$("body").unbind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseUp,this.bbdesigner$.proxy(this.ondrop,this))},n.prototype.isIntersect=function(n,t,i,r){var u=i.offset(),f=r.offset();return f.left<n&&n<f.left+r.width()&&f.top<t&&t<f.top+r.height()&&u.left<n&&n<u.left+i.width()&&u.top<t&&t<u.top+i.height()},n.prototype.updateDragRegion=function(n,t){var i=this.bbdesigner$("#"+this.id+"_drag_empty_area");i.length===0&&(i=BoldBIDashboard.buildTag("div.e-empty","",{border:"1px solid #f1f1f1",width:n.children().width(),margin:"8px",height:n.children().height(),background:"white"},{id:this.id+"_drag_empty_area"}));t==="bottom"?i.insertBefore(n):i.insertAfter(n)},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DragdropHelper",InternalDragDropHelper,window);InternalDateSettingsInfo=function(){function n(n){this.dateSettingsDialog=null;this.formatDropdown=null;this.columnNameTag=null;this.footerTag=null;this.periodDropdown=null;this.formatCustomContent=null;this.customTextbox=null;this.dateSettingsInfo=null;this.customReferenceContent=null;this.removeCustomTblContent=null;this.removeCustomValueTbl=null;this.selectedFieldName=null;this.okButton=null;this.cancelButton=null;this.formatValueName=null;this.customName=null;this.targetMethod=null;this.targetInstance=null;this.fiscalYearName=null;this.uniqueColumnName=null;this.id=null;this.dashboardDesigner=null;this.localizationContent=null;this.dateFormatDropObj=null;this.fiscalFormatDropObj=null;this.id=n._id;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.localizationContent=this.dashboardDesigner.getLocalizationContent();this.renderCustomDateSettingsDialog();this.wireEvents()}return n.prototype.renderCustomDateSettingsDialog=function(){var n=this.localizationContent.dateSettingsDialog,t=this.dateSettingsDialog=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_date_settings"}),u=BoldBIDashboard.buildTag("div","",{height:"auto",display:"block"}),f=BoldBIDashboard.buildTag("div","",{display:"block",width:"100%",height:"223px"},{}),e=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"}),o=BoldBIDashboard.buildTag("tr.bbi-designer-exp-row","",{}),s=BoldBIDashboard.buildTag("td","",{},{}),h=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 10px"},{}),c=this.bbdesigner$("<tr><\/tr>"),l=BoldBIDashboard.buildTag("td","",{width:"50px"},{}),ut=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",n.columnLabelText+":",{"font-size":"12px","font-weight":"600"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{},{}),ft=this.columnNameTag=BoldBIDashboard.buildTag("span.bbi-designer-fontfamily","",{"font-size":"12px"},{id:this.id+"__date_settings_columnName"}),v=BoldBIDashboard.buildTag("td","",{},{}),et=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon bbi-dbrd-designer-hoverable","",{cursor:"pointer",float:"right"},{"data-tooltip":n.infoIcon}),rt;a.append(ft);v.append(et);l.append(ut);c.append(l).append(a).append(v);h.append(c);this.cancelButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",n.cancelButtonText,{float:"right"},{id:this.id+"_date_settings_cancel"});this.okButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",n.okButtonText,{float:"right"},{id:this.id+"_date_settings_ok"});var y=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{id:this.id+"_upper_content"}),p=BoldBIDashboard.buildTag("bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 15px"},{}),w=this.bbdesigner$("<tr><\/tr>"),b=BoldBIDashboard.buildTag("td","",{width:"160px"},{}),ot=BoldBIDashboard.buildTag("table.editLabel.bbi-designer-fontfamily",n.format,{"font-size":"13px"},{type:"label"}),k=BoldBIDashboard.buildTag("td","",{},{}),i=this.formatDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_date_settings_formatdrop"});b.append(ot);k.append(i);w.append(b).append(k);p.append(w);var d=BoldBIDashboard.buildTag("div","",{width:"100%","border-top":"1px solid var(--primary-border-color)",margin:"10px 0px"},{}),g=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{}),nt=this.bbdesigner$("<tr><\/tr>"),tt=BoldBIDashboard.buildTag("td","",{width:"161px"},{}),st=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",n.fiscalYearStart,{"font-size":"13px"},{type:"label"}),it=BoldBIDashboard.buildTag("td","",{},{}),r=this.periodDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_date_settings_fiscaldrop"});tt.append(st);it.append(r);nt.append(tt).append(it);g.append(nt);y.append(p);s.append(h,d,y,d,g);t.append(u);u.append(f);f.append(e);e.append(o);o.append(s);t.BoldBIDashboardDialog({enableModal:!0,enableResize:!1,showRoundedCorner:!1,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",title:"Date Settings",width:"auto",height:"auto",minWidth:290,minHeight:250,showOnInit:!1,showFooter:!0,target:"#"+this.dashboardDesigner._id,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this)});this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_foot");this.footerTag.addClass("bbi-dialog-footer");this.footerTag.append(this.cancelButton).append(this.okButton);this.cancelButton.on("click",this.bbdesigner$.proxy(this.closeButtonClick,this));this.okButton.on("click",this.bbdesigner$.proxy(this.okButtonClick,this));i.BoldBIDashboardDropDownList({width:"250px",height:"28px",dataSource:this.formatTypeList(),fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,popupWidth:"250px",popupHeight:"100px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFormatType,this)});r.BoldBIDashboardDropDownList({width:"250px",height:"28px",dataSource:this.fiscalTypeList(),fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,popupWidth:"250px",popupHeight:"300px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFiscalType,this)});this.disableFormatMethod();rt=t.data("BoldBIDashboardDialog");rt.open();this.dateFormatDropObj=i.data("BoldBIDashboardDropDownList");this.fiscalFormatDropObj=r.data("BoldBIDashboardDropDownList")},n.prototype.disableFormatMethod=function(){if(this.selectedFieldName==="Time"||this.selectedFieldName==="WeekYear"||this.selectedFieldName==="DayMonthYear"||this.selectedFieldName==="MonthDayYear"){var n=this.dateSettingsDialog.find("#"+this.id+"_date_settings_formatdrop").data("BoldBIDashboardDropDownList");n.disable()}},n.prototype.changeFormatType=function(n){this.formatValueName=n.value;n.value==="Custom"?this.renderCustomDialog():(this.removeCustomTblContent=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_custom"),this.removeCustomTblContent.remove(),this.removeCustomValueTbl=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_custom_Field_reference"),this.removeCustomValueTbl.remove());this.enableOkButton()},n.prototype.renderCustomDialog=function(){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{id:this.id+"_date_settings_custom"}),i=BoldBIDashboard.buildTag("tr","",{height:"46px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"134px"},{}),l=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","Custom Format",{"font-size":"13px"},{type:"label"}),u=BoldBIDashboard.buildTag("td","",{width:"22px"},{}),a=this.customTooltipText(),f=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon","",{cursor:"pointer"},{});f.BoldBIDashboardTooltip({content:"<span>"+a+"<\/span>",cssClass:"bbi-defaultIndex-template",isBalloon:!1,collision:BoldBIDashboard.Tooltip.Collision.FlipFit,trigger:BoldBIDashboard.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!1});var e=BoldBIDashboard.buildTag("td","",{},{}),n=BoldBIDashboard.buildTag("input.e-textbox","",{"border-color":"var(--secondary-border-color)","box-sizing":"border-box"},{type:"text",spellcheck:"false",autocomplete:"off",id:this.id+"_date_settings_custom_Field"}),o=BoldBIDashboard.buildTag("bbi-designer-exp-table","",{float:"right",height:"21px"},{id:this.id+"_date_settings_custom_Field_reference"}),s=this.bbdesigner$("<tr><\/tr>"),h=BoldBIDashboard.buildTag("td","",{},{}),c=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-fontfamily bbi-datepicker-label","",{float:"right","text-align":"right",width:"250px",height:"18px",border:"none",outline:"none"},{type:"label",id:this.id+"_date_settings_custom_Field_reference_text",readonly:"readonly"});c.val("MM/ dd/ YYYY");h.append(c);s.append(h);o.append(s);n.on("keyup",this.bbdesigner$.proxy(this.customEnteredValue,this));n.on("keyup",this.bbdesigner$.proxy(this.changeCustomTextcolor,this));n.on("focusout",this.bbdesigner$.proxy(this.customTextboxColor,this));n.on("focusin",this.bbdesigner$.proxy(this.customTextboxColorReplace,this));r.append(l);u.append(f);e.append(n);i.append(r).append(u).append(e);t.append(i);this.formatCustomContent=this.dashboardDesigner.element.find("#"+this.id+"_upper_content");this.formatCustomContent.append(t).append(o);this.enableOkButton()},n.prototype.changeCustomTextcolor=function(){var t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text").val(),n=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text");t==="Invalid date format"?n.addClass("e-invalidlink"):n.removeClass("e-invalidlink")},n.prototype.customTextboxColorReplace=function(){var n=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");n.removeClass("bbi-designer-error");this.enableOkButton()},n.prototype.customTextboxColor=function(){var n=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text").val(),t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");n==="Invalid date format"&&t.addClass("bbi-designer-error");this.enableOkButton()},n.prototype.customEnteredValue=function(){var n=null,t;this.customTextbox=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");n=this.customTextbox.val();this.customName=n;t=this.customFormatDateText(n);this.customReferenceContent=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text");this.customReferenceContent.val(t);this.enableOkButton()},n.prototype.customTooltipText=function(){return"<b>Year<\/b>-yyyy/yy<br><\/br><b>Month<\/b>-MM/MMM/MMMM<br><\/br><b>Day<\/b>-dd/ddd/dddd<br><\/br><b>Hours(24 hrs)<\/b>-HH<br><\/br><b>Hours(12 hrs)<\/b>-hh<br><\/br><b>Minutes<\/b>-mm<br><\/br><b>Seconds<\/b>-ss<br><\/br><b>AM/PM<\/b>-ttt"},n.prototype.enableOkButton=function(){var n=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");n.length>0&&BoldBIDashboard.isNullOrUndefined(n.val())||n.val()===""?BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!0)},n.prototype.customFormatDateText=function(n){return n!==null?this.combinedSpecialCharacter(n):n===""?"MM / dd / yyyy":void 0},n.prototype.combinedSpecialCharacter=function(n){var t=new Date,l,a,v,w,i,o,u,d,s,g,e,r,tt,it;l=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][t.getDay()-1];v=t.toString();a=v.substring(0,3);var y=t.getFullYear().toString(),rt=(t.getFullYear()%100).toString(),ut=["January","February","March","April","May","June","July","August","September","October","November","December"][t.getMonth()],p;p=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][t.getMonth()];i=t.getMonth();i=i+1;w=i>9?i.toString():"0"+i.toString();u=t.getDate();o=u>9?u.toString():"0"+u.toString();var f=t.getHours(),ft=f.toString(),b,k=t.getHours();if(b=f>12?(k-12).toString():k.toString(),d=t.getMinutes().toString(),f>12?s="PM":f<=12&&(s="AM"),e=t.getSeconds(),g=e>9?e.toString():"0"+e.toString(),n==="dd/MM/yy"||n==="dd/MM/YY")return t.getDay()+"/"+t.getMonth()+"/"+t.getFullYear();if(n==="MM/yy/dd"||n==="MM/YY/dd")return i+"/"+y+"/"+o;var nt=["dddd","ddd","dd","yyyy","yy","MMMM","MMM","MM","HH","hh","mm","ttt","ss"],et=[l,a,o,y,rt,ut,p,w,ft,b,d,s,g],h,c=n;if(!BoldBIDashboard.isNullOrUndefined(c))for(r=0;r<nt.length;r++)tt=nt[r],it=et[r],h=c.replace(tt,it),c=h;return h},n.prototype.changeFiscalType=function(n){this.fiscalYearName=n.value},n.prototype.formatTypeList=function(){return this.selectedFieldName==="Date"?[{text:"5/20/2017",value:"Date"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="Year"?[{text:"2016, 2017, ...",value:"FullYear"},{text:"16, 17, ...",value:"HalfYear"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="Quarter"?[{text:"Quarter 1, Quarter 2",value:"FullQuarter"},{text:"Q1, Q2, Q3, Q4",value:"HalfQuarter"},{text:"1, 2, 3, 4",value:"QuarterNumber"}]:this.selectedFieldName==="Month"?[{text:"Jan, Feb, Mar",value:"HalfMonth"},{text:"January, February",value:"FullMonth"},{text:"1, 2, 3, ...12",value:"MonthWithoutZero"},{text:"01, 02, 03, ...12",value:"MonthWithZero"}]:this.selectedFieldName==="Day"?[{text:"01, 02, 03, ...31",value:"DayWithZero"},{text:"1, 2, 3, ...31",value:"DayWithoutZero"}]:this.selectedFieldName==="Default"?[{text:"5/20/2017  12:00 AM",value:"DateTime"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="Time"?[{text:"00:00:00",value:"Time"}]:this.selectedFieldName==="Hour"?[{text:"00, 01, 02, 03, ...",value:"HourWithZero"},{text:"1 AM, 2 PM",value:"HourWithAMPM"},{text:"0, 1, 2, 3, ...",value:"HourWithoutZero"}]:this.selectedFieldName==="Minute"?[{text:"00, 01, 02, 03, ...",value:"MinuteWithZero"},{text:"0, 1, 2, 3, ...",value:"MinuteWithoutZero"}]:this.selectedFieldName==="Second"?[{text:"00, 01, 02, 03, ...",value:"SecondWithZero"},{text:"0, 1, 2, 3, ...",value:"SecondWithoutZero"}]:this.selectedFieldName==="QuarterYear"?[{text:"Quarter 1 2017",value:"QuarterYear"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="MonthYear"?[{text:"Jan 2016, May 2017",value:"MonthYear"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="WeekYear"?[{text:"Week 01 2017, Week 32 2017",value:" WeekYear"}]:this.selectedFieldName==="DateHour"?[{text:"23/07/2017 00",value:"DateHour"},{text:"Custom",value:"Custom"}]:this.selectedFieldName==="DayOfWeek"?[{text:"Sunday, Monday",value:"FullDayOfWeek"},{text:"Sun, Mon, Tue",value:"HalfDayOfWeek"},{text:"S, M, T, W",value:"SingleDayOfWeek"},{text:"1, 2, 3, ...7",value:"DayOfWeekNumber"}]:this.selectedFieldName==="WeekOfYear"?[{text:"00, 01, 02, 03, ...",value:"WeekOfYearNumber"},{text:"Week 0, Week 1, Week 2, ...",value:"WeekOfYearWithoutZero"},{text:"Week 00, Week 01, Week 02, ...",value:"WeekOfYearWithZero"}]:this.selectedFieldName==="DayMonthYear"?[{text:"24/07/1994",value:"DayMonthYear"}]:this.selectedFieldName==="MonthDayYear"?[{text:"07/24/1994",value:"MonthDayYear"}]:void 0},n.prototype.fiscalTypeList=function(){return[{text:"Jan",value:"Jan"},{text:"Feb",value:"Feb"},{text:"Mar",value:"Mar"},{text:"Apr",value:"Apr"},{text:"May",value:"May"},{text:"Jun",value:"Jun"},{text:"Jul",value:"Jul"},{text:"Aug",value:"Aug"},{text:"Sep",value:"Sep"},{text:"Oct",value:"Oct"},{text:"Nov",value:"Nov"},{text:"Dec",value:"Dec"}]},n.prototype.closeButtonClick=function(){this.dateSettingsDialog.data("BoldBIDashboardDialog").close()},n.prototype.okButtonClick=function(){var n=new BoldBIDashboard.Dashboard.DatesettingInfoForUI,u=this.dateSettingsDialog.find("#"+this.id+"_date_settings_formatdrop").data("BoldBIDashboardDropDownList"),f=u.getSelectedValue(),t,i,r;n.Format=f;t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field").val();n.CustomFormat=t;i=this.dateSettingsDialog.find("#"+this.id+"_date_settings_fiscaldrop").data("BoldBIDashboardDropDownList");r=i.getSelectedValue();n.FiscalYear=r;n.UniqueColumnName=this.uniqueColumnName;BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[n]),this.closeButtonClick())},n.prototype.openDatesettingClick=function(n,t,i,r){var f,u,e,o,s,h;this.resetDateSetting();this.targetInstance=n;this.targetMethod=t;this.dateSettingsInfo=r;this.uniqueColumnName=i.UniqueColumnName;this.formatDropdown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.formatTypeList()});this.formatDropdown.data("BoldBIDashboardDropDownList").selectItemByIndex(0);this.columnNameTag.text(i.DisplayName);this.dateSettingsDialog.data("BoldBIDashboardDialog").open();BoldBIDashboard.isNullOrUndefined(r)||(f=r.Format,this.dateFormatDropObj.selectItemByValue(f),u=r.CustomFormat,e=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field"),e.val(u),o=this.customFormatDateText(u),s=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text"),s.val(o),h=r.FiscalYear,this.fiscalFormatDropObj.selectItemByValue(h))},n.prototype.resetDateSetting=function(){this.dateSettingsInfo=null;this.uniqueColumnName=null;this.targetInstance=null;this.targetMethod=null},n.prototype.wireEvents=function(){this.okButton.on("click","#"+this.id+"_date_settings_ok",this.bbdesigner$.proxy(this.okButtonClick,this));this.cancelButton.on("click","#"+this.id+"_date_settings_cancel",this.bbdesigner$.proxy(this.closeButtonClick,this))},n.prototype.unWireEvents=function(){this.okButton.off("click","#"+this.id+"_date_settings_ok",this.bbdesigner$.proxy(this.okButtonClick,this));this.cancelButton.off("click","#"+this.id+"_date_settings_cancel",this.bbdesigner$.proxy(this.closeButtonClick,this))},n.prototype.destroy=function(){this.unWireEvents();BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_date_settings"));this.dashboardDesigner.element.find("#"+this.id+"_date_settings").length>0&&this.dashboardDesigner.element.find("#"+this.id+"_date_settings").remove()},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DateSettingsCust",InternalDateSettingsInfo,window),function(n){var t;(function(t){var i=function(){function t(n){this.designer=n;this.bbdesigner$=this.designer.bbdesigner$;this.dataConfiguration=this.designer.modules.dataConfiguration;this.dragdropHelper=this.designer.dragDropHelper;this.widgetHelper=this.designer.modules.widgetHelper}return t.prototype.renderTreeView=function(n,t){for(var u,r=this.widgetHelper.getCurrentWidgetInstance().getFieldView(),i=0;i<r.length;i++)r[i].name!=="Parameters"&&(u=r[i].name==="Measures"?n.Measure:n.Dimension,this.renderDatasource(u,r[i].name,t,!0))},t.prototype.renderDatasource=function(t,i,r,u){var o,s,h,f,e,c,l;(u===void 0&&(u=!1),o=this.widgetHelper.getCurrentWidgetInstance(),o.Type!=="ListBox"&&o.Type!=="ComboBox"||i!=="Measures")&&(s=this.designer._id+"_"+i.toLowerCase()+"_categoryList",h=this.designer.element.find("#"+this.designer._id+"_"+i+"_categoryList"),h.empty(),f=n.buildTag("div.bbi-dbrd-treeview e-dbrd-"+i.toLowerCase()+"-treeview e-control","",{},{id:s+"_treeview"}),h.append(f),e=this.designer.element.find("#"+this.designer._id+"_"+i+"_categoryListPanel"),e.length>0&&(c=e.data("ejcroller"),n.isNullOrUndefined(c)||c.destroy(),l=new n.Dashboard.HierachicalSchemaView(this.designer,this.getModel()),l.render(f,t,e,s,!1,u),this.dragIntialize(f,!1)))},t.prototype.dragIntialize=function(t,i){var r,f,u;if(r=i?ejdashboard.base.getComponent(t.children().last()[0],"treeview"):ejdashboard.base.getComponent(t.children().first()[0],"treeview"),!n.isNullOrUndefined(r))for(r.nodeDragStart=this.bbdesigner$.proxy(this.nodeDragStart,this),r.nodeDragStop=this.bbdesigner$.proxy(this.nodeDragStop,this),r.nodeDragging=this.bbdesigner$.proxy(this.nodeDrag,this),f=r.element.ej2_instances,u=0;u<f.length;u++)if(f[u].getModuleName()==="draggable"){f[u].dragArea="#"+this.designer._id+"_dataTabRootElement";break}},t.prototype.nodeDrag=function(t){var v=this.dragdropHelper.getPosition("clientX",t.event),y=this.dragdropHelper.getPosition("clientY",t.event),f=this.bbdesigner$(t.draggedNode).data("fieldInfo"),r=this.dragdropHelper.getDataCategoryListContainer(t.event,f.ContainerName),i=n.isNullOrUndefined(r)?null:r.Container,p=n.isNullOrUndefined(r)?null:r.ParentContainer,o=this.designer.element.find("#"+this.designer._id+"_dataTabElement"),c,l,e,h;if(!n.isNullOrUndefined(i)&&n.isNullOrUndefined(f.ContainerType)&&(f.ContainerType=r.Container.data("container-info").ContainerType),c=this.widgetHelper.getCurrentWidgetInstance(),this.bbdesigner$(t.clonedNode).find(".e-icons").css("display","none"),l=c.onFieldDragDrop(f),!n.isNullOrUndefined(i)&&i.length>0&&l){e=i.data("container-info");o.css("cursor","default");var u=-1,s=-1,a=this.dragdropHelper.getEmptyFieldRowAndHoverIndex(i,p,v,y);s=a.emptyRowIndex;u=a.elementHoverIndex;(u>-1||i.children().length===0)&&s!==u?this.dragdropHelper.insertEmptyField(s,u,e,i):u===-1&&(o.css("cursor","not-allowed"),(t.dropIndicator==="e-drop-next"||t.dropIndicator==="e-drop-in"||t.dropIndicator==="e-drop-out")&&this.bbdesigner$(t.clonedNode).find(".bbi-treeview-div").css("cursor","no-drop"));(e.Name==="Measures"||e.Name==="Dimensions")&&this.designer.element.find("#"+this.designer._id+"_dataTabElement").css("cursor","not-allowed")}else o.css("cursor","not-allowed"),h=this.designer.element.find("div.bbi-dbrd-rendercolumn-container .bbi-categorylistdiv-emptyfield:not(:last-child)"),h.insertAfter(h.siblings(":last")),this.bbdesigner$(t.clonedNode).find(".bbi-treeview-div").css("cursor","no-drop");t.cancel=!0},t.prototype.nodeDragStart=function(t){var v=this,c,l,f,i,e,o,h,s,a;if(this.bbdesigner$(t.draggedNode).find(".bbi-treeview-div").css("cursor","default"),t.draggedNodeData.hasChildren&&t.draggedNodeData.id.length>1&&(t.cancel=!0,this.bbdesigner$(t.target).attr("haschild")==="true"&&this.bbdesigner$(t.target).parents(".bbi-treeview-div").css("cursor","no-drop")),n.isNullOrUndefined(this.bbdesigner$(t.draggedNode).data("fieldInfo"))){c=this.bbdesigner$(t.draggedNode).parents(".bbi-dbrd-treeview");l=void 0;l=c.length>0?ejdashboard.base.getComponent(c.children().first()[0],"treeview"):ejdashboard.base.getComponent(this.bbdesigner$(t.draggedNode).closest(".e-dashboard-treeView")[0],"treeview");var u=l.getTreeData(t.draggedNode),y=this.designer.modules.dataSet.datasets,r=y.filter(function(n){return n.Id===v.dataConfiguration.selectedDatasetId})[0];if(r.Fields.length>0)if(f=r.Fields,n.isNullOrUndefined(u[0].Id)){if(e=f.filter(function(n){return n.Id===u[0].ColumnId}),o=new n.Dashboard.DSField,e.length===0){for(h=0;h<f.length;h++)if(o=this.getCurrentFieldInfo(f[h],u[0].ColumnId),!n.isNullOrUndefined(o))break}else o=e[0];s=this.dataConfiguration.convertDataSetToFieldInfo(o,r.Id,r.Name);s.FieldType=s.FieldActualType==="bbi-designer-dataset-number"?FieldType.Measures:FieldType.Dimensions;a=this.bbdesigner$(t.draggedNode).closest(".bbi-ds-field-container").data("container-info");s.ContainerName=a.name;this.bbdesigner$(t.draggedNode).data("fieldInfo",s)}else this.bbdesigner$(t.clonedNode).find(".e-icons").css("display","none"),this.bbdesigner$(t.clonedNode).find(".bbi-heirarchial-icons.bbi-designer-content-icon").css("bottom","0px"),e=f.filter(function(n){return n.Id===u[0].Id}),i=this.dataConfiguration.convertDataSetToFieldInfo(e[0],r.Id,r.Name),i.FieldType=FieldType.Dimensions,i.DateTimeFormat=u[0].DateTimeFormat,i.ContainerName="Dimensions",i.IsParentField=!1,t.draggedNodeData.hasChildren&&(i.IsParentField=!0),this.bbdesigner$(t.draggedNode).data("fieldInfo",i)}this.bbdesigner$(t.clonedNode).find(".e-treeview-textbox").css("display","none");this.bbdesigner$(t.clonedNode).find(".e-settings-div").css("display","none");this.bbdesigner$(t.clonedNode).find(".e-close-parent.e-dimension").css("display","none");this.bbdesigner$(t.clonedNode).find(".e-text-content.e-icon-wrapper").css("display","contents");this.bbdesigner$(t.clonedNode).find(".all-elements-div").css("height","25px");this.bbdesigner$(t.clonedNode).find(".bbi-parent-name").removeAttr("style");this.bbdesigner$(t.clonedNode).css("background","transparent");this.bbdesigner$(t.clonedNode).find(".bbi-treeview-rearrange-content").css({background:"none",border:"none"});this.bbdesigner$(t.clonedNode).find(".bbi-treeview-uparrow-icon, .bbi-treeview-menu-icon, .bbi-treeview-downarrow-icon").css("display","none");this.designer.element.find("#"+this.designer._id+"_Dimensions_categoryItem").append(this.bbdesigner$(t.clonedNode))},t.prototype.nodeDragStop=function(t){var s,h,c,o,u,f;if(t.dropIndicator==="e-drop-next"||t.dropIndicator==="e-drop-in"?t.cancel=!0:t.dropIndicator==="e-no-drop"&&(s=this.bbdesigner$(t.draggedNode).data("fieldInfo"),o=this.bbdesigner$(t.target).closest(".bbi-ds-assign-field-container-scroller"),o.length>0&&(n.isNullOrUndefined(s.IsParentField)||s.IsParentField)&&this.dragdrop(o,JSON.parse(JSON.stringify(s)),t)),t.draggedNode.className==="e-list-item e-level-2 e-heirachy-field"&&t.dropIndicator!=="e-no-drop"){if(h=this.designer.element.find("#"+this.designer._id+"_designAreaContainer"),c=this.designer.element.find("#"+this.designer._id+"_dataTabElement"),t.droppedNodeData.id!==""&&t.draggedNodeData.id!==""){if(o=t.draggedNode.parentElement,u=o.children,t.draggedNode.id==="")for(f=0;f<u.length;f++)u[f].id=f;var i=this.bbdesigner$(t.draggedNode.parentNode.offsetParent).data("fieldInfo"),l=t.draggedNode.id,a=t.droppedNode.id,r=+l,e=+a;for(e<r?(i.ChildHierarchicalFields.splice(e,0,i.ChildHierarchicalFields[r]),i.ChildHierarchicalFields.splice(r+1,1),this.designer.element.find("#"+u[r].id).insertBefore(u[e])):e>r&&(e===i.ChildHierarchicalFields.length-1?i.ChildHierarchicalFields.push(i.ChildHierarchicalFields[r]):i.ChildHierarchicalFields.splice(e+1,0,i.ChildHierarchicalFields[r]),i.ChildHierarchicalFields.splice(r,1),this.designer.element.find("#"+u[r].id).insertAfter(u[e])),this.bbdesigner$(c).css("cursor","default"),h.css("cursor","default"),this.bbdesigner$(t.draggedNode.parentNode.offsetParent).data("fieldInfo",i),this.dataConfiguration.rearrangeChildFields(i,e,r),f=0;f<u.length;f++)u[f].id=""}this.bbdesigner$(c).css("cursor","default");h.css("cursor","default")}},t.prototype.dragdrop=function(t,i,r,u){var h=-1,w=-1,ct=this.bbdesigner$(r.target).attr("id"),b=this.widgetHelper.getCurrentWidgetInstance(),ut=JSON.parse(JSON.stringify(i)),c=t.find(".bbi-ds-assign-field-container"),l=c.data("container-info"),ft=ut.ContainerName=l.Name,s=c.children(),et,lt=n.isNullOrUndefined(u)?b.onFieldDragDrop(ut,t,r):!1,v=!n.isNullOrUndefined(this.designer)&&!n.isNullOrUndefined(this.designer.modules)&&!n.isNullOrUndefined(this.designer.modules.dataSource)&&!n.isNullOrUndefined(this.designer.modules.dataSource.datasources)?this.designer.modules.dataSource.datasources.filter(function(n){return n.Id===i.DatasourceID})[0]:null,at=!n.isNullOrUndefined(v)&&!n.isNullOrUndefined(v.ConnectionProperties)&&!n.isNullOrUndefined(v.ConnectionProperties.DataProvider)&&v.ConnectionProperties.DataProvider.toUpperCase()==="SSAS"?!0:!1,ot=this.dataConfiguration.getCategories().filter(function(n){return n.Name===l.Name}),vt=n.isNullOrUndefined(ot[0])?!1:ot[0].isCustomHierarchy,nt,p,rt,f,a,ht,e;if((lt&&n.isNullOrUndefined(u)||!n.isNullOrUndefined(u))&&(at||vt)){var k=c.find(".bbi-category-empty-field-wrap"),d=0,g=0,y=0,o=0;for(f=0;f<s.length;f++)et=s[f].getElementsByClassName("e-heirachy-field"),nt=this.bbdesigner$(et),n.isNullOrUndefined(nt.attr("child-field-count"))||(d=d+n.parseInt(nt.attr("child-field-count"),10)),h===-1&&(o=d,g++),s[f].id===k.attr("id")&&(h=f),s[f].id===this.designer.id+"_"+i.Id+"_categoryListDiv_"+i.UniqueId&&(w=f),g<o&&(g=o,y++);o=o>0?y>0?o-y:o-1:o;h=h+o;w=w+o;var tt=null,st=!1,it=b.DataGroupInfo.FieldContainers;if(k.length<1||!n.isNullOrUndefined(u)&&!u){for(p=c.find("#"+ct),rt=p.closest(".bbi-ds-categoryLabel"),p.closest(".bbi-ds-categoryLabel").length<1&&(rt=!n.isNullOrUndefined(u)&&!u?this.bbdesigner$(s[0]):this.bbdesigner$(s[s.length-1])),f=0;f<s.length;f++)rt.attr("id")===s[f].id&&(h=f);tt=this.dragdropHelper.getRemoveItem(p,c,u,h,i)}for(a=0;a<it.length;a++)if(ft===it[a].Name){it[a].FieldInfos.filter(function(t){if(t.Id===i.Id&&n.isNullOrUndefined(i.IsParentField)){st=!0;return}});break}st||(ht=!n.isNullOrUndefined(i.IsParentField)&&i.IsParentField,(i.ContainerName==="Dimensions"&&l.ContainerType!==FieldContainerType.Numeric||i.ContainerName==="Measures"&&l.ContainerType!==FieldContainerType.Non_Numeric||ht)&&(e=this.dragdropHelper.getAddItem(b,i,h,ft,!0,o,y),e.DisplayName=e.IsDisplayNameEdited||e.DateTimeFormat!==DateTimeFormat.None?this.designer.modules.util.getDisplayName(e):n.isNullOrUndefined(e.DisplayName)?e.Name:e.DisplayName,k.length<1?this.dataConfiguration.replaceItem(tt,e):(n.isNullOrUndefined(u)||u||this.dataConfiguration.removeItem(tt,!1,!0,!1),!n.isNullOrUndefined(e.IsParentField)&&e.IsParentField?this.addHeirachialDateFieldItems(e,l):this.dataConfiguration.addItem(e,!1,!0))))}r.cancel=!0},t.prototype.addHeirachialDateFieldItems=function(t,i){var o,e,u,r,f;if(i.ContainerType!==FieldContainerType.Numeric)if(n.isNullOrUndefined(i.CategoryCount)){if(t.DateTimeFormat=DateTimeFormat.None,t.DisplayName=n.isNullOrUndefined(t.DisplayName)?t.Name:t.DisplayName,t.ParentId=undefined,o=[DateTimeFormat.Year,DateTimeFormat.Quarter,DateTimeFormat.Month,DateTimeFormat.Day],t.FieldActualType==="bbi-designer-dataset-datetime")for(t.ChildHierarchicalFields=[],u=0;u<o.length;u++)r=JSON.parse(JSON.stringify(t)),r.DateTimeFormat=o[u],r.ParentId=t.UniqueId,r.ParentUsualId=t.Id,r.ParentName=t.Name,r.UniqueId=this.dataConfiguration.getAvailableName(),r.ItemIndex=t.ItemIndex+u,r.Name=t.Name,r.DisplayName=this.designer.modules.util.getDisplayName(r),r.IsDisplayNameEdited=!1,r.IsParentField=!1,r.ChildHierarchicalFields=null,this.dataConfiguration.addItem(r,!1,!0),t.ChildHierarchicalFields.push(r);else if(t.FieldActualType==="bbi-designer-dataset-string")for(e=1,e=n.isNullOrUndefined(t.ChildHierarchicalFields)?e:t.ChildHierarchicalFields.length,u=0;u<e;u++)r=JSON.parse(JSON.stringify(t.ChildHierarchicalFields[u])),r.ContainerType=t.ContainerType,r.DateTimeFormat=DateTimeFormat.None,r.ParentId=t.UniqueId,r.ParentUsualId=t.Id,r.ParentName=t.Name,r.UniqueId=this.dataConfiguration.getAvailableName(),r.ItemIndex=t.ItemIndex+u,r.IsParentField=!1,r.ContainerName=t.ContainerName,r.ColumnType=t.ColumnType,r.ColumnId=t.ColumnId,r.DatasourceID=t.DatasourceID,r.DatasourceName=t.DatasourceName,r.FieldActualType=n.isNullOrUndefined(r.FieldActualType)?t.FieldActualType:r.FieldActualType,r.FieldType=n.isNullOrUndefined(r.__type)?t.FieldType:n.isNullOrUndefined(r.FieldType)?t.FieldType:r.FieldType,r.ChildHierarchicalFields=null,r.SummaryType=this.widgetHelper.getCurrentWidgetInstance().getDefaultSummaryType(r.FieldType,r.ContainerType,r.IsAggregatedExpression),r.DisplayName=n.isNullOrUndefined(t.ChildHierarchicalFields)?t.Name:this.designer.modules.util.getDisplayName(r),this.dataConfiguration.addItem(r,!1,!0),t.ChildHierarchicalFields[u]=r;this.dataConfiguration.addItem(t,!1,!0)}else t.DateTimeFormat=DateTimeFormat.Year,t.DisplayName=DateTimeFormat.Year+"("+t.Name+")",t.ContainerType=i.ContainerType,t.IsParentField=!1,this.dataConfiguration.addItem(t,!1,!0);else f=void 0,n.isNullOrUndefined(t.ChildHierarchicalFields)?f=JSON.parse(JSON.stringify(t)):(f=JSON.parse(JSON.stringify(t)),delete f.ChildHierarchicalFields),f.DateTimeFormat=DateTimeFormat.None,f.ContainerType=i.ContainerType,f.SummaryType=SummaryType.COUNT,f.DisplayName=this.designer.modules.util.getDisplayName(f),this.dataConfiguration.addItem(f,!1,!0)},t.prototype.getCurrentFieldInfo=function(t,i){var r=null,u;if(t.Id===i)r=t;else if(!n.isNullOrUndefined(t.ChildFields))for(u=0;u<t.ChildFields.length;u++)if(r=this.getCurrentFieldInfo(t.ChildFields[u],i),!n.isNullOrUndefined(r))break;return r},t.prototype.getModel=function(){var t=new n.Dashboard.HierachialModel;return t.ShowDataTypeIcon=!0,t.CanDragDrop=!0,t},t}();t.HierarchicalConfigurationView=i})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));InternalFormatDialog=function(){function InternalFormatDialog(n){this.previewTag=null;this.formatTag=null;this.representationTag=null;this.decimalTag=null;this.cultureTag=null;this.decimalSymbolTextBox=null;this.groupingSymbolTextBox=null;this.leftTextBox=null;this.rightTextBox=null;this.dialogTag=null;this.negativetable=null;this.appendTextDiv=null;this.currentSymbolChange=!1;this.saveOriginalCulture=!1;this.currentDecimal=null;this.currentGroup=null;this.dataSourceName=null;this.dashboardDesigner=null;this.lakhsAndCroreInputBox=null;this.lakhsAndCroreTbl=null;this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id;this.renderFormatDialog();this.unWireEvents();this.wireEvents()}return InternalFormatDialog.prototype.renderFormatDialog=function(){var n=this.dialogTag=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{cursor:"default"},{id:this.id+"_format_dialog"}),t=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing","",{"padding-top":"6px","border-radius":"2px",overflow:"auto",height:"350px",width:"100%"},{id:this.id+"_format_body_div"}),i=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing  bbi-dbrd-designer-scroller e-dbrd-control bbi-dbrd-designer-scroll-style-3","",{float:"left",width:"312px",height:"300px",padding:"10px 10px 0px 10px"},{id:this.id+"_format_head_div"}),r=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing","",{float:"right","border-left":"1px solid var(--designer-secondary-border-color)",height:"340px",width:"216px","padding-top":"5px","padding-right":"10px"},{id:this.id+"_format_sub_div"}),f=BoldBIDashboard.buildTag("div","",{"padding-bottom":"10px"},{id:this.id+"_format_type_div"}),e=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{unselectable:"on"}),o=BoldBIDashboard.buildTag("tr","",{},{}),d=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Type",{width:"122px","font-size":"12px"},{}),s=BoldBIDashboard.buildTag("td","",{width:"11px"},{}),h=this.formatTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_type_drop"}),c=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_format_prvw_div"}),l=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{unselectable:"on"}),a=BoldBIDashboard.buildTag("tr","",{},{}),v=BoldBIDashboard.buildTag("td","",{"padding-bottom":"51px","padding-left":"12px"},{}),g=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Preview:",{"font-size":"14px","font-weight":"600"},{type:"label"}),y=BoldBIDashboard.buildTag("div","",{border:"1px solid var(--designer-secondary-border-color)",height:"150px",width:"200px","margin-left":"13px",display:"block"}),p=BoldBIDashboard.buildTag("div","",{display:"table"}),nt=this.previewTag=BoldBIDashboard.buildTag("div","",{height:"142px",width:"192px",position:"absolute","word-break":"break-all","align-items":"center",display:"flex","justify-content":"center",overflow:"hidden",padding:"4px","font-size":"24px","white-space":"pre-wrap"},{id:this.id+"_format_preview_span"}),w=this.locale.dialogOptions,tt=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",w.cancelButtonText,{float:"right"},{id:this.id+"_format_btn_cancel",type:"button"}),it=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",w.okButtonText,{float:"right"},{id:this.id+"_format_btn_ok",type:"button"}),b=BoldBIDashboard.buildTag("div","",{},{}),u=BoldBIDashboard.buildTag("div","",{},{}),k;n.append(t);t.append(i);u.append(f);b.append(u);i.append(b);f.append(e);e.append(o);s.append(h);o.append(d).append(s);t.append(r);r.append(c);c.append(l);l.append(a);a.append(v);v.append(g);r.append(y);y.append(p);p.append(nt);this.dashboardDesigner.element.append(n);n.BoldBIDashboardDialog({minWidth:560,minHeight:400,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,title:"Measure Formatting",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});h.BoldBIDashboardDropDownList({DataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"190px",height:"26px",change:this.bbdesigner$.proxy(this.renderFormatSample,this),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"});k=this.dashboardDesigner.element.find("#"+this.id+"_format_dialog_foot");k.append(tt,it);this.renderFormatFields(u);this.scroller=i.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,height:"340px",buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}).data("BoldBIDashboardScroller")},InternalFormatDialog.prototype.renderNumericTextBox=function(n){var t=BoldBIDashboard.buildTag("tr","",{},{}),u=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Decimal Places",{width:"122px","font-size":"12px"},{}),i=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),r=this.decimalTag=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_format_decimal"});n.append(t);t.append(u);t.append(i);i.append(r);r.ejNumericTextbox({showSpinButton:!0,width:"190px",enabled:!0,value:2,change:this.bbdesigner$.proxy(this.changeFormatValues,this),minValue:0,maxValue:6,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label"})},InternalFormatDialog.prototype.renderFormatFields=function(n){var t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_format_div"}),r=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),u=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),f=BoldBIDashboard.buildTag("tr","",{},{}),k=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Representation",{width:"122px","font-size":"12px"},{}),e=BoldBIDashboard.buildTag("td","",{width:"20px"},{}),o=this.representationTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_repDrop"}),d=this.negativetable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),s=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),h=BoldBIDashboard.buildTag("tr","",{},{}),g=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Currency ",{width:"122px","font-size":"12px"},{}),c=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),l=this.cultureTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_culture_drop"}),a=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),v=BoldBIDashboard.buildTag("tr","",{},{}),nt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.thousandSeparator.decimal,{"font-size":"12px"},{}),i,b;this.decimalSymbolTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_decimal_text"});var y=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),p=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),w=BoldBIDashboard.buildTag("tr","",{},{}),tt=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.thousandSeparator.group,{"font-size":"12px"},{});this.groupingSymbolTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_group_text"});i=BoldBIDashboard.buildTag("td","",{width:"31px"},{});n.append(t);t.append(u);this.renderLakhsAndCroreCheckBox(t);t.append(r);u.append(f);f.append(k).append(e);this.renderNumericTextBox(r);t.append(s);s.append(h);h.append(g).append(c);c.append(l);t.append(a);a.append(v);v.append(nt).append(y);y.append(this.decimalSymbolTextBox);t.append(p);p.append(w);w.append(tt).append(i);i.append(this.groupingSymbolTextBox);t.append(d);e.append(o);this.renderAppendTextField(t);o.BoldBIDashboardDropDownList({dataSource:this.getRepresentation(),fields:{text:"text",value:"value"},selectedIndex:0,width:"190px",height:"26px",change:this.bbdesigner$.proxy(this.changeFormatValues,this),showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"});b=l.BoldBIDashboardDropDownList({dataSource:BoldBIDashboard.DashboardUtil.getCultures(),fields:{text:"DisplayName",value:"CurrencySymbol"},enabled:!0,width:"190px",height:"28px",change:this.bbdesigner$.proxy(this.currentCultureChange,this),showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}).data("BoldBIDashboardDropDownList");this.decimalSymbolTextBox.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"190px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign",focusOut:this.bbdesigner$.proxy(this.saveSymbols,this)});this.groupingSymbolTextBox.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"190px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign",focusOut:this.bbdesigner$.proxy(this.saveSymbols,this)});b.selectItemByText(BoldBIDashboard.DashboardUtil.autoformatdisplayText)},InternalFormatDialog.prototype.renderLakhsAndCroreCheckBox=function(n){this.lakhsAndCroreTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{});var t=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.measureFormatting.enableLkhsAndCrores,{"font-size":"12px",display:"inline-flex"},{}),i=BoldBIDashboard.buildTag("td","",{width:"23px",display:"inline-flex","padding-left":"120px"},{});this.lakhsAndCroreInputBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_decimal_text"});n.append(this.lakhsAndCroreTbl);this.lakhsAndCroreTbl.append(t);i.append(this.lakhsAndCroreInputBox);t.append(i).append(r);this.lakhsAndCroreInputBox.BoldBIDashboardCheckBox({checked:!0,change:this.bbdesigner$.proxy(this.updateChckBox,this),width:"20px",cssClass:"e-designer-prop-checkbox"})},InternalFormatDialog.prototype.updateChckBox=function(){},InternalFormatDialog.prototype.renderAppendTextField=function(n){var f=this.appendTextDiv=BoldBIDashboard.buildTag("div","",{}),e=BoldBIDashboard.buildTag("div","",{width:"75px","padding-left":"4px"}),l=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.dialogText.appendText,{"font-size":"12px"},{type:"label"});e.append(l);var o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"10px 0px"},{}),s=this.bbdesigner$("<tr><\/tr>"),a=BoldBIDashboard.buildTag("td","",{width:"25px"},{}),v=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Left",{"font-size":"12px"},{}),h=BoldBIDashboard.buildTag("td","",{"padding-right":"7px"},{}),r=this.id+"_format_leftText",t=this.leftTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:r,autocomplete:"off"});h.append(t);var y=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Right",{"font-size":"12px"},{}),c=BoldBIDashboard.buildTag("td","",{},{}),u=this.id+"_format_rightText",i=this.rightTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:u,autocomplete:"off"});c.append(i);s.append(a).append(v).append(h).append(y).append(c);o.append(s);f.append(e).append(o);n.append(f);t.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"105px",height:"28px",showRoundedCorner:!0,cssClass:"e-designer-param-assign",change:this.bbdesigner$.proxy(this.changeFormatValues,this),focusOut:this.bbdesigner$.proxy(this.requestParamPreviewText,this,null)});i.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"105px",height:"28px",showRoundedCorner:!0,cssClass:"e-designer-param-assign",change:this.bbdesigner$.proxy(this.changeFormatValues,this),focusOut:this.bbdesigner$.proxy(this.requestParamPreviewText,this,null)});t.off("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,r));t.on("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,r));i.off("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,u));i.on("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,u))},InternalFormatDialog.prototype.requestParamPreviewText=function(n,t){var i;if(t===void 0&&(t=null),i=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue(),i.toLowerCase()==="number"){var u="",o=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),s=this.decimalTag.data("ejNumericTextbox").getValue(),h=this.getCurrentCulture();this.enableDecimalBox();var f=this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),e=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),r={PrefixValue:"",SuffixValue:""};r.PrefixValue=BoldBIDashboard.isNullOrUndefined(f)?"":this.dashboardDesigner.checkAndUpdateParameterValue(f,this.dataSourceName,!1,n);r.SuffixValue=BoldBIDashboard.isNullOrUndefined(e)?"":this.dashboardDesigner.checkAndUpdateParameterValue(e,this.dataSourceName,!1,n);u=this.getPreviewValue(i,o,s,h,r);this.previewTag.text(u)}},InternalFormatDialog.prototype.bindParameterList=function(n,t){var i={fnction:this.bbdesigner$.proxy(this.changeFormatValues,this)};this.dashboardDesigner.getParamListInInputElement(n,i,t)},InternalFormatDialog.prototype.getPreviewValue=function(n,t,i,r,u){var v=Math.pow(10,3),y=Math.pow(10,6),p=Math.pow(10,9),w=Math.pow(10,5),b=Math.pow(10,7),f=12345,s="",e="",o;if(n.toLowerCase()!=="percentage"){switch(t){case"Auto":case"Thousands":f=f/v;s="K";break;case"Millions":f=f/y;s="M";break;case"Billions":f=f/p;s="B";break;case"Lakhs":f=f/w;s="L";break;case"Crores":f=f/b;s="Cr"}e=n.toLowerCase()==="number"?BoldBIDashboard.globalize.format(f,"N"+i,r.Name):BoldBIDashboard.globalize.format(f,"C"+i,r.Name);e=e+s;var h=this.getDecimalSeparator(),c=this.currentDecimal,l=this.getGroupSeparator(),a=this.currentGroup,k=h!==c||l!==a;h!==null&&l!==null&&k&&(o=e.split(h),o[0]=o[0].replace(l,a),e=o.length>1?o[0]+c+o[1]:i!==0?o[0]+c:o[0]);!this.currentSymbolChange&&this.saveOriginalCulture&&(this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup));e=u.PrefixValue+e+u.SuffixValue}else e=f.toFixed(i)+"%";return e},InternalFormatDialog.prototype.getCultureScriptFile=function(culture,selectedValue,repDropdown,decimal){var _this=this,dashboardDesigner=this.dashboardDesigner,eventArgs={headers:[],serviceAuthorizationToken:dashboardDesigner.model.serviceAuthorizationToken,actionType:"GetCultureScript"};(dashboardDesigner.triggerEvents("ajaxBeforeLoad",eventArgs),BoldBIDashboard.isNullOrUndefined(eventArgs.cancel)||!eventArgs.cancel)&&this.bbdesigner$.ajax({url:dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getculturescripts+"?culture="+culture.Name,dataType:"html",contentType:"application/javascript",crossDomain:!0,cache:!0,error:function(){},beforeSend:function(n){_this.beforeSendRequest(n,eventArgs)},success:function(args){eval(args);_this.culturePreviewValue(culture,selectedValue,repDropdown,decimal,!0)},complete:function(){_this.previewTag.css("opacity","1")}})},InternalFormatDialog.prototype.beforeSendRequest=function(n,t){if(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.modules.util.clientId)||this.dashboardDesigner.modules.util.clientId===""||n.setRequestHeader("ClientID",this.dashboardDesigner.modules.util.clientId),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serviceAuthorizationToken)||n.setRequestHeader("Authorization",this.dashboardDesigner.model.serviceAuthorizationToken),t&&t.headers&&t.headers.length>0)for(var i=0;i<t.headers.length;i++)n.setRequestHeader(t.headers[i].Key,t.headers[i].Value)},InternalFormatDialog.prototype.saveSymbols=function(){this.decimalSymbolTextBox.val().length===0&&(this.showSeparatorAlertDialog(this.locale.alertWindowMesages.decimalSymbolEmptyWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal));this.decimalSymbolTextBox.val()===this.groupingSymbolTextBox.val()&&(this.showSeparatorAlertDialog(this.locale.alertWindowMesages.groupingAndDecimalSymbolEqualWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup));this.decimalSymbolTextBox.val().match(/[a-zA-Z0-9]/)&&(this.showSeparatorAlertDialog(this.locale.thousandSeparator.decimal+this.locale.alertWindowMesages.symbolBeingAlphaNumericWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal));this.groupingSymbolTextBox.val().match(/[a-zA-Z0-9]/)?(this.showSeparatorAlertDialog(this.locale.thousandSeparator.group+this.locale.alertWindowMesages.symbolBeingAlphaNumericWarningMessage),this.groupingSymbolTextBox.val(this.currentGroup)):(this.decimalSymbolTextBox.val().length!==0&&(this.currentDecimal=this.decimalSymbolTextBox.val()),this.currentGroup=this.groupingSymbolTextBox.val(),this.currentSymbolChange=!0,this.saveOriginalCulture=!1,this.changeFormatValues(this))},InternalFormatDialog.prototype.updateTheCheckBoxOnChange=function(){var n=this.getCurrentCulture(),t=this.cultureTag.data("BoldBIDashboardDropDownList").model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?"auto":n.Name,i=this.lakhsAndCroreInputBox.data("BoldBIDashboardCheckBox").isChecked(),r=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),u=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFormat,r);this.updateLakhsAndCroreInput(u,t,i);this.scroller.refresh()},InternalFormatDialog.prototype.updateRepOnCultureChange=function(){var r=this.getCurrentCulture().Name,t=[],n,i;t=BoldBIDashboard.DashboardUtil.isRequiredCulture(r)?this.getAllRepresentation():this.getRepresentation();n=this.representationTag.data("BoldBIDashboardDropDownList");n.model.dataSource.length!==t.length&&(i=n.getSelectedValue(),n.setModel({dataSource:t}),t.filter(function(n){return n.value===i}).length===0?n.selectItemByIndex(0):n.selectItemByValue(i))},InternalFormatDialog.prototype.showSeparatorAlertDialog=function(n){this.dashboardDesigner.modules.util.alertDialog(this.locale.alertWindowMesages.draftAlertTitle,n,IconType.warning,AlertType.Alert,!1,"Sample")},InternalFormatDialog.prototype.currentCultureChange=function(n){this.currentDecimal=this.getDecimalSeparator();this.currentGroup=this.getGroupSeparator();n.selectedText===BoldBIDashboard.DashboardUtil.autoformatdisplayText?(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").disable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").disable()):(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").enable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").enable());this.currentSymbolChange=!1;this.changeFormatValues(this);n.isInteraction&&(this.updateRepOnCultureChange(),this.updateTheCheckBoxOnChange())},InternalFormatDialog.prototype.culturePreviewValue=function(n,t,i,r,u){var f="";this.enableDecimalBox();var o=this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),s=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),e={PrefixValue:"",SuffixValue:""};e.PrefixValue=BoldBIDashboard.isNullOrUndefined(o)?"":o;e.SuffixValue=BoldBIDashboard.isNullOrUndefined(s)?"":s;BoldBIDashboard.isNullOrUndefined(u)||u!==!0||(this.currentDecimal=this.getDecimalSeparator(t,n.Name),this.currentGroup=this.getGroupSeparator(t,n.Name),this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup));f=this.getPreviewValue(t,i,r,n,e);this.setPreviewTextFontSize(f);this.previewTag.text(f);this.updatePreviewContentStyle();this.requestParamPreviewText(null)},InternalFormatDialog.prototype.getCurrentCulture=function(){var i=this.cultureTag.data("BoldBIDashboardDropDownList").model.text,t=BoldBIDashboard.DashboardUtil.getCultures(),n;if(i===BoldBIDashboard.DashboardUtil.autoformatdisplayText){for(n=0;n<t.length;n++)if(t[n].Name===this.dashboardDesigner.model.localeSettings.culture)return t[n];return t[66]}for(n=0;n<t.length;n++)if(i===t[n].DisplayName)return t[n]},InternalFormatDialog.prototype.changeFormatValues=function(n){n.isInteraction&&this.updateTheCheckBoxOnChange();var t=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue();this.formatValues(t)},InternalFormatDialog.prototype.formatValues=function(n){var i=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),r=this.decimalTag.data("ejNumericTextbox").getValue(),u="",t,f;n.toLowerCase()==="percentage"?(u=this.getPreviewValue(n,i,r),this.setPreviewTextFontSize(u),this.previewTag.text(u),this.updatePreviewContentStyle()):(t=this.getCurrentCulture(),f=BoldBIDashboard.globalize.findCulture(t.Name),f.name!==t.Name?(this.previewTag.css("opacity",".5"),this.getCultureScriptFile(t,n,i,r)):this.culturePreviewValue(t,n,i,r))},InternalFormatDialog.prototype.setPreviewTextFontSize=function(n){var t=this.previewTag.css("font-size"),i=BoldBIDashboard.DashboardUtil.textWidth(n,"Heebo "+t);this.previewTag.css("font-size",i>100?"18px":"24px")},InternalFormatDialog.prototype.updatePreviewContentStyle=function(){this.previewTag.prop("scrollHeight")>this.previewTag.innerHeight()?this.previewTag.css({"align-items":"baseline"}):this.previewTag.css("align-items","center");this.saveOriginalCulture=!0},InternalFormatDialog.prototype.renderFormatSample=function(n){BoldBIDashboard.isNullOrUndefined(n.value)||(this.decimalSymbolTextBox.val(this.getDecimalSeparator()),this.groupingSymbolTextBox.val(this.getGroupSeparator()),this.resetFormatSample(n.value),this.formatValues(n.value))},InternalFormatDialog.prototype.resetFormatSample=function(n){var t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.cultureTag.data("BoldBIDashboardDropDownList"),f=this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit"),e=this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit"),r=this.leftTextBox.data("BoldBIDashboardMaskEdit"),u=this.rightTextBox.data("BoldBIDashboardMaskEdit");r.setModel({value:""});u.setModel({value:""});this.currentDecimal=this.decimalSymbolTextBox.val();this.currentGroup=this.groupingSymbolTextBox.val();n.toLowerCase()==="number"?(this.isEnabled(t)||t.enable(),this.isEnabled(i)||i.enable(),this.isEnabled(r)||r.enable(),this.isEnabled(u)||u.enable(),this.isEnabled(f)||f.enable(),this.isEnabled(e)||e.enable()):n.toLowerCase()==="currency"?(this.isEnabled(t)||t.enable(),this.isEnabled(i)||i.enable(),this.isEnabled(r)&&r.disable(),this.isEnabled(u)&&u.disable(),this.isEnabled(f)||f.enable(),this.isEnabled(e)||e.enable()):n.toLowerCase()==="percentage"&&(this.isEnabled(t)&&(t.selectItemByValue("Ones"),t.disable()),this.isEnabled(i)&&i.disable(),this.isEnabled(r)&&r.disable(),this.isEnabled(u)&&u.disable(),this.isEnabled(f)&&f.disable(),this.isEnabled(e)&&e.disable(),this.lakhsAndCroreTbl.css("display","none"));i.model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").disable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").disable()):(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").enable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").enable());this.enableDecimalBox()},InternalFormatDialog.prototype.enableDecimalBox=function(){var n=this.decimalTag.data("ejNumericTextbox"),t=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue();t.toLowerCase()==="auto"?n.disable():n.enable()},InternalFormatDialog.prototype.isEnabled=function(n){return n.model.enabled},InternalFormatDialog.prototype.populateFormats=function(n){var i,t,r,h;if(!BoldBIDashboard.isNullOrUndefined(n)){var c=n.FormatType,u=n.Unit,f=n.DecimalPoints,a=n.DecimalSeparator,v=n.GroupSeparator,e=BoldBIDashboard.isNullOrUndefined(n.Prefix)?"":n.Prefix,o=BoldBIDashboard.isNullOrUndefined(n.Suffix)?"":n.Suffix,s=n.Culture,l="";if(s.length>0)for(i=BoldBIDashboard.DashboardUtil.getCultures(),t=0;t<i.length;t++)if(s===i[t].Name){l=i[t].DisplayName;break}this.formatTag.data("BoldBIDashboardDropDownList").selectItemByValue(c);this.decimalTag.data("ejNumericTextbox").setModel({value:f>-1?f:0});this.cultureTag.data("BoldBIDashboardDropDownList").selectItemByText(l);this.updateRepOnCultureChange();this.representationTag.data("BoldBIDashboardDropDownList").selectItemByValue(u.length>0?u:"Auto");s!=="auto"&&(this.currentGroup=v.AliasValue,this.currentDecimal=a.AliasValue);this.decimalSymbolTextBox.val(this.currentDecimal);this.groupingSymbolTextBox.val(this.currentGroup);this.leftTextBox.data("BoldBIDashboardMaskEdit").setModel({value:e});this.rightTextBox.data("BoldBIDashboardMaskEdit").setModel({value:o});r={PrefixValue:"",SuffixValue:""};r.PrefixValue=BoldBIDashboard.isNullOrUndefined(e)?"":e;r.SuffixValue=BoldBIDashboard.isNullOrUndefined(o)?"":o;h=this.getPreviewValue(c,u,f,this.getCurrentCulture(),r);this.setPreviewTextFontSize(h);this.previewTag.text(h);this.updatePreviewContentStyle();this.updateLakhsAndCroreInput(n.Unit,n.Culture,n.EnableLakhsAndCroreRep)}},InternalFormatDialog.prototype.updateLakhsAndCroreInput=function(n,t,i){if(n===NumberFormat.Auto){var r=t;r!=="auto"||BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner)||(r=this.dashboardDesigner.model.localeSettings.culture);BoldBIDashboard.DashboardUtil.isRequiredCulture(t)?this.lakhsAndCroreTbl.css("display","block"):this.lakhsAndCroreTbl.css("display","none")}else this.lakhsAndCroreTbl.css("display","none");this.lakhsAndCroreInputBox.BoldBIDashboardCheckBox({checked:i})},InternalFormatDialog.prototype.getFormatValues=function(){var i=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue(),u=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),f=this.decimalTag.data("ejNumericTextbox").getValue(),n=new Separator,t=new Separator;n.AliasValue=this.decimalSymbolTextBox.val()==null?"":this.decimalSymbolTextBox.val();t.AliasValue=this.groupingSymbolTextBox.val()==null?"":this.groupingSymbolTextBox.val();var e=this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),o=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),r=this.getCurrentCulture();n.CurrentValue=this.getDecimalSeparator(i,r.Name);t.CurrentValue=this.getGroupSeparator(i,r.Name);this.currentDecimal=n.AliasValue;this.currentGroup=t.AliasValue;var s=this.cultureTag.data("BoldBIDashboardDropDownList").model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?"auto":r.Name,h=this.lakhsAndCroreInputBox.data("BoldBIDashboardCheckBox").isChecked();return{Culture:s,DecimalPoints:f,FormatType:BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(DataValueFormat,i),GroupSeparator:t,DecimalSeparator:n,Prefix:e,Suffix:o,Unit:BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFormat,u),EnableLakhsAndCroreRep:h}},InternalFormatDialog.prototype.saveFormat=function(){var n=this.getFormatValues(),t;this.dashboardDesigner.paramRegex.test(n.Prefix)||this.dashboardDesigner.paramRegex.test(n.Suffix)?(t={fnction:this.bbdesigner$.proxy(this.formatInWidgets,this)},this.requestParamPreviewText(t)):(BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,n),this.closeDialog())},InternalFormatDialog.prototype.formatInWidgets=function(n){this.dashboardDesigner.updateParamCollection(n);var t=this.getFormatValues();BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,t);this.closeDialog()},InternalFormatDialog.prototype.openFormatDialog=function(n,t,i,r,u){t===void 0&&(t=null);i===void 0&&(i=null);r===void 0&&(r=!1);u===void 0&&(u=!1);this.callBackfn=null;this.resetPreviewLable();this.callBackfn=i;this.dataSourceName=t;this.dialogTag.data("BoldBIDashboardDialog").open();this.formatTag.data("BoldBIDashboardDropDownList").setModel({dataSource:this.getFormatList()});n?this.populateFormats(n):this.formatTag.data("BoldBIDashboardDropDownList").selectItemByText("Number");r?(this.negativetable.hide(),this.appendTextDiv.hide(),u&&this.enableDecimalSelectionOnly()):(this.negativetable.show(),this.appendTextDiv.show(),this.enableallitems());this.scroller.refresh()},InternalFormatDialog.prototype.enableDecimalSelectionOnly=function(){var n=this.cultureTag.data("BoldBIDashboardDropDownList"),t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.formatTag.data("BoldBIDashboardDropDownList");t.disable();n.disable();i.disable()},InternalFormatDialog.prototype.getDecimalSeparator=function(n,t){return(t=BoldBIDashboard.isNullOrUndefined(t)?this.getCurrentCulture().Name:t,n=BoldBIDashboard.isNullOrUndefined(n)?this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue():n,n.toLowerCase()==="currency")?BoldBIDashboard.globalize.findCulture(t).numberFormat.currency["."]:n.toLowerCase()==="number"?BoldBIDashboard.globalize.findCulture(t).numberFormat["."]:void 0},InternalFormatDialog.prototype.getGroupSeparator=function(n,t){return(t=BoldBIDashboard.isNullOrUndefined(t)?this.getCurrentCulture().Name:t,n=BoldBIDashboard.isNullOrUndefined(n)?this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue():n,n.toLowerCase()==="currency")?BoldBIDashboard.globalize.findCulture(t).numberFormat.currency[","]:n.toLowerCase()==="number"?BoldBIDashboard.globalize.findCulture(t).numberFormat[","]:void 0},InternalFormatDialog.prototype.enableallitems=function(){var n=this.cultureTag.data("BoldBIDashboardDropDownList"),t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.formatTag.data("BoldBIDashboardDropDownList");this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue().toLowerCase()!=="percentage"&&(t.enable(),n.enable());i.enable()},InternalFormatDialog.prototype.closeDialog=function(){this.dialogTag.data("BoldBIDashboardDialog").close()},InternalFormatDialog.prototype.resetPreviewLable=function(){this.previewTag.text("")},InternalFormatDialog.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_format_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0));this.dashboardDesigner.element.on("click","#"+this.id+"_format_btn_ok",this.bbdesigner$.proxy(this.saveFormat,this,!0))},InternalFormatDialog.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_format_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0));this.dashboardDesigner.element.off("click","#"+this.id+"_format_btn_ok",this.bbdesigner$.proxy(this.saveFormat,this,!0))},InternalFormatDialog.prototype.destroy=function(){this.unWireEvents();BoldBIDashboard.DashboardUtil.destroyEjObjects(this.bbdesigner$("#"+this.id+"_format_dialog"));this.bbdesigner$("#"+this.id+"_format_dialog").length>0&&this.bbdesigner$("#"+this.id+"_format_dialog").remove()},InternalFormatDialog.prototype.getFormatList=function(){return[{text:"Number",value:"Number"},{text:"Currency",value:"Currency"},{text:"Percentage",value:"Percentage"}]},InternalFormatDialog.prototype.getRepresentation=function(){return[{text:"Auto",value:"Auto"},{text:"Ones",value:"Ones"},{text:"Thousands",value:"Thousands"},{text:"Millions",value:"Millions"},{text:"Billions",value:"Billions"}]},InternalFormatDialog.prototype.createFormatType=function(){return new MeasureFormatting},InternalFormatDialog.prototype.getAllRepresentation=function(){return[{text:this.locale.measureFormatting.autoText,value:"Auto"},{text:this.locale.measureFormatting.onesText,value:"Ones"},{text:this.locale.measureFormatting.thousandsText,value:"Thousands"},{text:this.locale.measureFormatting.lakhsText,value:"Lakhs"},{text:this.locale.measureFormatting.millionsText,value:"Millions"},{text:this.locale.measureFormatting.croresText,value:"Crores"},{text:this.locale.measureFormatting.billionsText,value:"Billions"}]},InternalFormatDialog}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.FormatDialog",InternalFormatDialog,window);InternalItemPanel=function(){function n(n,t){this.dashboardDesigner=null;this.refreshTimer=null;this.pageNumber=1;this.filterSearchTimer=null;this.searchText="";this.searchInitiated=!1;this.locale=null;this.dashboardPublishedVersion="";this.pageRequestInProgress=!1;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.targetTag=t;this.widgetPanelSettings=n.model.designerSettings.widgetsPanel;this.rendererItemPanel()}return n.prototype.isLoaded=function(){return!BoldBIDashboard.isNullOrUndefined(this.targetTag)},n.prototype.getItempanelTabTemplate=function(n,t){var i='<li class="bbi-itempanel-tab-li"><a  href=#'+n+">"+this.defaultPanelText+"<\/a>",r='<li class="bbi-itempanel-tab-li"><a  href=#'+t+">"+this.existingPanelText+"<\/a>";return(this.widgetPanelSettings.hideDefaultWidgets?"":i)+(this.widgetPanelSettings.hideExistingWidgets?"":r)},n.prototype.rendererItemPanel=function(){var c=this,n=this.dashboardDesigner._id,i,t,e,h;this.waterMarkText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.defaultPanelSearchPlaceholder)?this.locale.itemPanel.waterMarkText:this.widgetPanelSettings.defaultPanelSearchPlaceholder;this.waterMarkTextForDashboardsearch=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.existingPanelSearchPlaceholder)?this.locale.itemPanel.waterMarkTextForDashboardsearch:this.widgetPanelSettings.existingPanelSearchPlaceholder;this.defaultPanelText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.defaultPanelDisplayText)?this.locale.itemPanel.defaultPanelText:this.widgetPanelSettings.defaultPanelDisplayText;this.existingPanelText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.existingPanelDisplayText)?this.locale.itemPanel.existingPanelText:this.widgetPanelSettings.existingPanelDisplayText;this.noMatchedText=this.locale.itemPanel.noDataFound;i=[];!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.widgetGuids)&&this.dashboardDesigner.model.widgetGuids.length>0&&this.hideWidgets();t=this.bbdesigner$;t.each(this.locale.itemPanel.groupItems,function(n,r){var u=[],e,f=[],o;t.each(BoldBIDashboardDesigner.widgetItems,function(n,t){r===t.GroupName&&!BoldBIDashboard.isNullOrUndefined(t.Items)&&t.Items.length>0&&(f=f.length>0?f.concat(t.Items):t.Items,e=t.GroupId,o=t.order)});t.isEmptyObject(f)||(u=f);u=c.orderWidgetGroupItems(u);!BoldBIDashboard.isNullOrUndefined(u)&&u.length>0&&i.push({GroupName:r,GroupId:e,order:o,Items:u})});this.widgetItems=this.orderWidgetGroupItems(i);this.panelItems=this.cleanWidgetGroups();var u=n+"_default_itempanel",f=n+"_existing_itempanel",r=BoldBIDashboard.buildTag("div","",{},{id:n+"_designerItemPanel_Tab"}),l=BoldBIDashboard.buildTag("ul",this.getItempanelTabTemplate(u,f),{},{"class":"bbi-itempanel-tab-ul"});this.defaultPanel=BoldBIDashboard.buildTag("div","",{},{id:u,"class":"bbi-default-panel"});this.existingPanel=BoldBIDashboard.buildTag("div","",{},{id:f,"class":"bbi-existing-panel"});r.append(l,this.defaultPanel,this.existingPanel);e=BoldBIDashboard.buildTag("span.bbi-dashboardicon bbi-designer-itempanel-icon bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable bbi-widgetpanel-expandcollapse bbi-widgetpanel-collapse","",{},{id:this.dashboardDesigner._id+"_item_panel_expand_collapse","data-toggle":"expand","data-tooltip":this.locale.dataConfigurationPanel.collapse});this.targetTag.append(e,r);this.widgetPanelSettings.hideDefaultWidgets||this.renderHeaderPanel();this.expandablePanel=BoldBIDashboard.buildTag("div","",{},{id:n+"_designerItemPanel","class":"bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3"});var o=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-exisiting-panel","",{},{}),a=BoldBIDashboard.buildTag("div","",{},{id:n+"_scrollContentItemPanel"}),s=BoldBIDashboard.buildTag("div","",{},{id:n+"_itemPanel_empty_msg","class":"bbi-dbrd-designer-panel-empty-wrapper"}),v=BoldBIDashboard.buildTag("div",this.locale.itemPanel.noDataFound,{},{"class":"bbi-dbrd-designer-font bbi-dbrd-designer-empty-msg"});if(s.append(v),o.append(a).append(s),this.expandablePanel.append(o),this.defaultPanel.append(this.expandablePanel),this.expandablePanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),r.BoldBIDashboardTab({itemActive:this.bbdesigner$.proxy(this.sendRequestForDashboardsDetail,this),selectedItemIndex:0}),this.widgetPanelSettings.hideDefaultWidgets&&!this.widgetPanelSettings.hideExistingWidgets&&(this.defaultPanel.hide(),h={activeIndex:1},this.sendRequestForDashboardsDetail(h)),this.widgetPanelSettings.hideDefaultWidgets&&this.widgetPanelSettings.hideExistingWidgets)this.onExpandCollapsePanel(null,!0);this.updateSize();this.unWireEvents();this.wireEvents()},n.prototype.hideWidgets=function(){for(var t,i,r=this.dashboardDesigner.model.widgetGuids,n=0;n<BoldBIDashboardDesigner.widgetItems.length;n++)for(t=0;t<BoldBIDashboardDesigner.widgetItems[n].Items.length;t++)i=r.includes(BoldBIDashboardDesigner.widgetItems[n].Items[t].id),i||(BoldBIDashboardDesigner.widgetItems[n].Items[t].hide=!0)},n.prototype.sendRequestForDashboardsDetail=function(n){var t,i,r;n.activeIndex===1&&(BoldBIDashboard.isNullOrUndefined(this.expandableExistingPanel)?(BoldBIDashboard.isNullOrUndefined(this.dashboardWholeWrapper)||this.dashboardWholeWrapper.remove(),this.dashboardWholeWrapper=BoldBIDashboard.buildTag("div.e-dbrd-existing-panel-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_panel_wrapper"}),this.renderHeaderPanelForDashboard(),this.sharedDashboardLoader=BoldBIDashboard.buildTag("div","",{"min-height":"160px",position:"absolute",width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_existingpanel_list_view_loader"}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-desginer-error bbi-dbrd-designer-font","<center><p><\/p><\/center>",{},{id:this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"}),this.sharedDashboardLoader.append(this.renderSkelton("_shared_dbrd_skeleton")),this.dashboardWholeWrapper.append(this.sharedDashboardLoader,t),this.existingPanel.append(this.dashboardWholeWrapper),i={pageSize:20,pageNo:1},r={sortOrder:"Asc",sortBy:"Name"},this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.shareddashboard,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedDashboard,data:JSON.stringify({pageInfo:i,sortInfo:r})},{fnction:this.bbdesigner$.proxy(this.onAccountFetchSuccess,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForDashboards,this)},!0,!0)):this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},n.prototype.sendRequestForWidgetsDetail=function(n){var r;if(n.currentTarget){n.currentTarget.firstChild.offsetWidth<n.currentTarget.firstChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.dashboardsTooltip)||this.dashboardsTooltip.destroy());var t=this.bbdesigner$(n.currentTarget).attr("data-id"),u=this.bbdesigner$(n.currentTarget).attr("data-version"),f=n.currentTarget,e=f.children[0].innerText;this.existingPanel.find("#"+this.dashboardDesigner._id+"_existing_panel_wrapper").css("display","none");this.existingWidgetWrapper=BoldBIDashboard.buildTag("div.e-existing-widget-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_widget_wrapper"});var i=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-wrapper","",{},{id:this.dashboardDesigner._id+"_specific_dashboard"}),o=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-name","<label>"+e+"<\/label>",{},{id:this.dashboardDesigner._id+"_specific_dashboard_name"}),s=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-icon",'<span class="bbi-icon-arrow_1_left bbi-designer-header-icon" > <\/span>',{},{});this.widgetsLoader=BoldBIDashboard.buildTag("div","",{"min-height":"80px",position:"absolute",width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_existingpanel_list_view_loader"});r=BoldBIDashboard.buildTag("div.bbi-dbrd-desginer-error bbi-dbrd-designer-font","<center><p><\/p><\/center>",{},{id:this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"});this.widgetsLoader.append(this.renderSkeletonForWidgets("_shared_dbrd_widgets_skeleton"));i.append(s).append(o);this.existingWidgetWrapper.append(i,this.widgetsLoader,r);this.existingPanel.append(this.existingWidgetWrapper);this.dashboardDesigner.modules.util.doAjaxPost("GET",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.sharedwidgets+"/"+t,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedWidget},{fnction:this.bbdesigner$.proxy(this.onDashboardClick,this,t,u),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForWidgets,this)},!0,!0)}},n.prototype.fetchPredefindedWidgets=function(){if(!BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.dashboardDesigner.model.predefinedWidgets.dashboardId)){var n=this.dashboardDesigner.model.predefinedWidgets.dashboardId;this.dashboardDesigner.modules.util.doAjaxPost("GET",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.sharedwidgets+"/"+n,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedWidget},{fnction:this.bbdesigner$.proxy(this.injectPredefinedWidgetDetailsInWidgetItems,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForWidgets,this)},!0,!0)}},n.prototype.appendPredefinedWidgets=function(n){var t=this;this.bbdesigner$.each(this.widgetItems,function(i,r){t.bbdesigner$.each(n,function(n,t){r.GroupName===t.GroupName&&!BoldBIDashboard.isNullOrUndefined(t.Items)&&t.Items.length>0&&(r.Items=r.Items.concat(t.Items))})})},n.prototype.getWidgetCategoryId=function(n){var t="";return this.bbdesigner$.each(this.widgetItems,function(i,r){r.GroupName===n&&(t=r.GroupId)}),t},n.prototype.checkWidgetCategoryExists=function(n){var t=new ExistingWidgetCategory,r=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(n),i;for(t.isCategoryExists=r,t.categoryName=r?this.locale.itemPanel.groupItems.miscellaneous:n,t.categoryGroupId=r?this.getWidgetCategoryId(t.categoryName):BoldBIDashboard.getGuid("").toString(),i=0;i<this.widgetItems.length;i++)if(this.widgetItems[i].GroupName.toLowerCase()===n.toLowerCase()){t.isCategoryExists=!0;t.categoryGroupId=this.widgetItems[i].GroupId;t.categoryName=this.widgetItems[i].GroupName;break}return t.isCategoryExists||this.widgetItems.push({GroupName:t.categoryName,GroupId:t.categoryGroupId,Items:[]}),t},n.prototype.injectPredefinedWidgetDetailsInWidgetItems=function(n){var r=this.getCurrentWidgetItems(n.Data),t=[],i=this.checkWidgetCategoryExists(this.dashboardDesigner.model.predefinedWidgets.categoryName);this.bbdesigner$.each(r,function(r,u){t.push({GroupName:i.categoryName,GroupId:i.categoryGroupId,Items:[{id:n.Data[r].WidgetId,widgetName:u.widgetName,widgetDisplayName:n.Data[r].WidgetName,cssClass:u.cssClass+" e-predefinedwidgets",widgetNameSpace:u.widgetNameSpace,searchCategory:u.searchCategory,widgetconfiginfo:null,useIconTemplate:!0,iconTemplate:u.iconTemplate,tooltip:{title:u.tooltip.title,description:u.tooltip.description,dataRequirement:u.tooltip.dataRequirement},serializationNameSpace:u.serializationNameSpace,isPreconfiguredWidget:!0}]})});this.appendPredefinedWidgets(t);this.dashboardPublishedVersion=n.Version;this.updateWidgetItemVisibility(null);this.renderGroup()},n.prototype.onConnectionErrorForWidgets=function(){this.widgetsLoader.css("display","none");this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block");var n=this.locale.errorMessage.connectionRefused;this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(n)},n.prototype.onConnectionErrorForDashboards=function(){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none");this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block");var n=this.locale.errorMessage.connectionRefused;this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(n);this.refreshContainer.prop("disabled","true")},n.prototype.onAccountFetchSuccess=function(n){var t,i;this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none");n.Status?BoldBIDashboard.isNullOrUndefined(n.Data)||n.Data.length===0?(i=this.locale.errorMessage.noDashboard,this.hideSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(i)):(t=n.Data,t=this.widgetPanelSettings.existingDashboards.length>0?this.getMatchingdDashboardsList(t):t,this.renderExistingDashboardPanel(n,t),this.scrollExisitingDiv.append(this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"))):(this.hideSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(n.Message))},n.prototype.getMatchingdDashboardsList=function(n){var t=this.widgetPanelSettings.existingDashboards;return n.filter(function(n){return t.indexOf(n.Id)!==-1})},n.prototype.renderExistingDashboardPanel=function(n,t){var i=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control","",{width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_expandable_parent_div"});this.expandableExistingPanel=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3 bbi-expandable-existing-panel","",{clear:"both"},{id:this.dashboardDesigner._id+"_existingpanel_list_view"});this.scrollExisitingDiv=BoldBIDashboard.buildTag("div.bbi-dbrd-scroll-exisitng-div","",{},{id:this.dashboardDesigner._id+"_scroll_parent_container"});this.scrollExistingContent=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_content_existingpanel"});this.scrollExisitingDiv.append(this.createDashboardListContainer(t,this.scrollExistingContent));this.expandableExistingPanel.append(this.scrollExisitingDiv);i.append(this.expandableExistingPanel);this.dashboardWholeWrapper.append(i);this.expandableExistingPanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,scroll:this.bbdesigner$.proxy(this.setScroller,this)}).data("BoldBIDashboardScroller");this.loaderIndicator=this.expandableExistingPanel.BoldBIDashboardWaitingPopup({showOnInit:!1,showImage:!0,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup");this.sizeUpdateForExistingPanel();this.pageNumber=n.Page;this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none");this.refreshContainer.removeProp("disabled")},n.prototype.renderHeaderPanelForDashboard=function(){var t=BoldBIDashboard.buildTag("div.bbi-dbrd-existing-panel-header-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_panel_header"}),n=BoldBIDashboard.buildTag("div.bbi-dbrd-existing-autocomplete bbi-dbrd-designer-autocomplete bbi-dbrd-designer-font","",{},{id:this.dashboardDesigner._id+"_item_autocomplete_for_existing_panel"}),i=BoldBIDashboard.buildTag("input.bbi-autocomplete bbi-dbrd-designer-font bbi-dbrd-designer-search-box bbi-dbrd-designer-watermark bbi-dbrd-designer-boxshadow e-js e-input","",{},{type:"text",placeholder:this.waterMarkTextForDashboardsearch,id:this.dashboardDesigner._id+"_panel_search_for_existing_panel"}),r=BoldBIDashboard.buildTag("span.bbi-dbrd-designer-icon bbi-dbrd-designer-search","",{},{id:this.dashboardDesigner._id+"_searchIcon_for_existing_panel"});this.refreshContainer=BoldBIDashboard.buildTag("button.bbi-dbrd-existing-dashboard-refresh-icon bbi-dbrd-designer-hoverable bbi-dbrd-designer-hand-cursor bbi-dbrd-icon-background-theme","",{},{id:this.dashboardDesigner._id+"_dashboard_refresh_icon",type:"button","data-tooltip":this.locale.itemPanel.refreshTooltip});n.append(i);n.append(r);t.append(n,this.refreshContainer);this.dashboardWholeWrapper.append(t)},n.prototype.onDashboardClick=function(n,t,i){if(BoldBIDashboard.isNullOrUndefined(i.Data))this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(i.Message);else{this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none");this.expandableWidgetPanel=BoldBIDashboard.buildTag("div.bbi-expandable-existing-widget-panel","",{},{id:this.dashboardDesigner._id+"_existing_widgets_panel","class":"bbi-dbrd-designer-scroller  bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3 "});var r=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_widgets_parent_div"}),u=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_content_existing_widgets_panel"}),f=BoldBIDashboard.buildTag("div.e-widget-collection-wrapper","",{},{id:this.dashboardDesigner._id+"_widget_whole_collection_wrapper","data-dbrdId":n,"data-version":t});u.append(f);r.append(u);this.expandableWidgetPanel.append(r);this.existingWidgetWrapper.append(this.expandableWidgetPanel);this.expandableWidgetPanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize});this.renderWidgetItem(f,n,i);this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none");this.sizeUpdateForWidgetPanel()}},n.prototype.renderWidgetItem=function(n,t,i){for(var r,f,s=this.getCurrentWidgetItems(i.Data),u=0;u<i.Data.length;u++){r=s[u];f=BoldBIDashboard.buildTag("div.e-draggable e-widget-wrapper","",{},{CategoryId:t,id:this.dashboardDesigner._id+"_"+i.Data[u].WidgetId,Type:i.Data[u].Type,SubType:i.Data[u].SubType,"data-widgetId":i.Data[u].WidgetId,unselectable:"on","data-widgetclass":r.cssClass,"data-widgetname":r.widgetName,"data-widgetnamespace":r.widgetNameSpace,"data-icontemplate":r.iconTemplate,"data-serializationnamespace":r.serializationNameSpace,"data-min-rowspan":r.minRowSpan,"data-min-colspan":r.minColSpan});this.dashboardDesigner.dragDropHelper.initializeDraggable(f,"10000");n.append(f);var h=BoldBIDashboard.buildTag("div",'<span class="bbi-designer-fieldcontainer-double-drag bbi-widgeticons bbi-drag-handle-span"> <\/span>',{},{"class":"bbi-drag-handle-icon","data-widgetclass":r.cssClass,"data-widgetname":r.widgetName,"data-widgetnamespace":r.widgetNameSpace,"data-icontemplate":r.iconTemplate,"data-widgetid":i.Data[u].WidgetId,"data-min-rowspan":r.minRowSpan,"data-min-colspan":r.minColSpan}),e=BoldBIDashboard.buildTag("div.bbi-widget-name-wrapper","",{},{}),c=BoldBIDashboard.buildTag("div.bbi-widget-name-div","<label>"+i.Data[u].WidgetName+"<\/label>",{},{}),o=BoldBIDashboard.buildTag("div","",{},{"class":"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-icon bbi-dashboard-widget-icon "+r.cssClass,"data-widgetclass":r.cssClass,"data-widgetname":r.widgetName,"data-widgetnamespace":r.widgetNameSpace,"data-icontemplate":r.iconTemplate,"data-widgetid":i.Data[u].WidgetId,"data-serializationnamespace":r.serializationNameSpace,"data-min-rowspan":r.minRowSpan,"data-min-colspan":r.minColSpan});r.useIconTemplate&&o.append(r.iconTemplate);e.append(o).append(c);f.append(h).append(e)}},n.prototype.activeEllipsis=function(n){n.currentTarget.firstChild.offsetWidth<n.currentTarget.firstChild.scrollWidth&&(this.dashboardsTooltip=this.existingPanel.find("#"+this.dashboardDesigner._id+"_scroll_parent_container").BoldBIDashboardTooltip({content:n.currentTarget.firstChild.innerText,associate:"mouseenter",animation:{effect:"none",speed:8e3},cssClass:"bbi-dbrd-designer-tooltip-for-itempanel",collision:"fit",position:{stem:{horizontal:"left",vertical:"center"},target:{horizontal:100,vertical:100}},target:".bbi-dashboard-name-wrapper"}).data("BoldBIDashboardTooltip"))},n.prototype.inactiveEllipsis=function(n){n.currentTarget.firstChild.offsetWidth<n.currentTarget.firstChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.dashboardsTooltip)||this.dashboardsTooltip.destroy())},n.prototype.activeEllipsisForWidgets=function(n){n.currentTarget.lastChild.lastChild.offsetWidth<n.currentTarget.lastChild.lastChild.scrollWidth&&(this.widgetsTooltip=this.existingPanel.find("#"+this.dashboardDesigner._id+"_scroll_content_existing_widgets_panel").BoldBIDashboardTooltip({content:n.currentTarget.innerText,associate:"mouseenter",animation:{effect:"none",speed:8e3},cssClass:"bbi-dbrd-designer-tooltip-for-itempanel",collision:"fit",position:{stem:{horizontal:"left",vertical:"center"},target:{horizontal:100,vertical:100}},target:".e-widget-wrapper"}).data("BoldBIDashboardTooltip"))},n.prototype.inactiveEllipsisForWidgets=function(n){n.currentTarget.lastChild.lastChild.offsetWidth<n.currentTarget.lastChild.lastChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.widgetsTooltip)||this.widgetsTooltip.destroy())},n.prototype.backToDashBoard=function(){this.existingWidgetWrapper.remove();this.existingPanel.find("#"+this.dashboardDesigner._id+"_existing_panel_wrapper").css("display","block")},n.prototype.sizeUpdateForExistingPanel=function(){if(this.isLoaded()&&!BoldBIDashboard.isNullOrUndefined(this.expandableExistingPanel)){var i=this.widgetPanelSettings.hideDefaultWidgets?this.existingPanel:this.defaultPanel,e=this.widgetPanelSettings.hideDefaultWidgets?"_item_autocomplete_for_existing_panel":"_item_autocomplete",r=i.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),n=i.find("#"+this.dashboardDesigner._id+e),t=i.closest("#"+this.dashboardDesigner._id+"_designerContainer").find(".bbi-itempanel-tab-li"),u=n.height()+parseInt(n.css("margin-top"),10)+parseInt(n.css("margin-bottom"),10)+parseInt(n.css("border-top-width"),10)+parseInt(n.css("border-bottom-width"),10),f=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10);this.expandableExistingPanel.height(r-u-f+"px");this.expandableExistingPanel.data("BoldBIDashboardScroller")&&(this.expandableExistingPanel.data("BoldBIDashboardScroller").setModel({height:r-u-f-1+"px"}),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())}},n.prototype.sizeUpdateForWidgetPanel=function(){if(this.isLoaded()&&!BoldBIDashboard.isNullOrUndefined(this.expandableWidgetPanel)){var i=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),n=this.existingPanel.find("#"+this.dashboardDesigner._id+"_specific_dashboard"),t=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find(".bbi-itempanel-tab-li"),r=n.height()+parseInt(n.css("margin-top"),10)+parseInt(n.css("margin-bottom"),10)+parseInt(n.css("border-top-width"),10)+parseInt(n.css("border-bottom-width"),10),u=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10);this.expandableWidgetPanel.height(i-r-u+"px");this.expandableWidgetPanel.data("BoldBIDashboardScroller")&&(this.expandableWidgetPanel.data("BoldBIDashboardScroller").setModel({height:i-r-u-1+"px"}),this.expandableWidgetPanel.data("BoldBIDashboardScroller").refresh())}},n.prototype.appendCustomWidget=function(n){var i=this,t=[],r=this.locale.itemPanel.groupItems;this.bbdesigner$.each(n,function(n,u){var o=!1,e,f;if(i.bbdesigner$.each(i.widgetItems,function(n,t){t.GroupName===u.GroupName&&!BoldBIDashboard.isNullOrUndefined(u.Items)&&u.Items.length>0&&(t.Items=t.Items.concat(u.Items),o=!0)}),!o&&!t.includes(u)&&!r.hasOwnProperty(u.GroupName.toLowerCase())){for(e=!1,f=0;f<t.length;f++)t[f].GroupName===u.GroupName&&(e=!0,t[f].Items.includes(u.Items[0])||t[f].Items.push(u.Items[0]));e||t.push(u)}});t.length>0&&(this.widgetItems=this.widgetItems.concat(t));this.updateWidgetItemVisibility(null)},n.prototype.orderWidgetGroupItems=function(n){var f=[],t=[],i=[],r=[],u=[];return f=n.filter(function(n){return!BoldBIDashboard.isNullOrUndefined(n.order)}),t=n.filter(function(n){return BoldBIDashboard.isNullOrUndefined(n.order)}),r=f.sort(function(n,t){return n.order>t.order?1:-1}),!BoldBIDashboard.isNullOrUndefined(r)&&r.length>0&&i.push(r),!BoldBIDashboard.isNullOrUndefined(t)&&t.length>0&&(u=i.length===1?i[0].concat(t):i.push(t)),u.length>0?u:i[0]},n.prototype.updateSize=function(){if(this.isLoaded()){var i=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),n=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_item_autocomplete"),t=this.dashboardDesigner.element.find(".bbi-itempanel-tab-li"),r=n.height()+parseInt(n.css("margin-top"),10)+parseInt(n.css("margin-bottom"),10)+parseInt(n.css("border-top-width"),10)+parseInt(n.css("border-bottom-width"),10),u=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10);this.expandablePanel.height(i-r-u+"px");this.expandablePanel.data("BoldBIDashboardScroller")&&(this.expandablePanel.data("BoldBIDashboardScroller").setModel({height:i-r-u-1+"px"}),this.expandablePanel.data("BoldBIDashboardScroller").refresh(),this.sizeUpdateForExistingPanel(),this.sizeUpdateForWidgetPanel())}},n.prototype.validateSearchString=function(n,t){for(var r=!1,i=0;i<n.length;i++)if(BoldBIDashboard.DashboardUtil.contains(n[i],t,!0)){r=!0;break}return r},n.prototype.getPanelItems=function(n,t){var f=[],i,u,r;if(n)for(i in n){for(u=void 0,u={GroupId:n[i].GroupName,GroupName:n[i].GroupName,Items:[]},r=0;r<n[i].Items.length;r++)(BoldBIDashboard.DashboardUtil.contains(n[i].Items[r].widgetDisplayName,t,!0)||BoldBIDashboard.DashboardUtil.contains(n[i].Items[r].widgetName,t,!0)||this.validateSearchString(n[i].Items[r].searchCategory,t))&&u.Items.push({id:n[i].Items[r].id,widgetName:n[i].Items[r].widgetName,widgetDisplayName:n[i].Items[r].widgetDisplayName,cssClass:n[i].Items[r].cssClass,widgetNameSpace:n[i].Items[r].widgetNameSpace,widgetconfiginfo:n[i].Items[r].widgetconfiginfo,useIconTemplate:n[i].Items[r].useIconTemplate,iconTemplate:n[i].Items[r].iconTemplate,tooltip:n[i].Items[r].tooltip,serializationNameSpace:n[i].Items[r].serializationNameSpace,minRowSpan:isNaN(n[i].Items[r].minRowSpan)?6:n[i].Items[r].minRowSpan,minColSpan:isNaN(n[i].Items[r].minColSpan)?6:n[i].Items[r].minColSpan});u.Items.length>0&&f.push(u)}return f},n.prototype.renderHeaderPanel=function(){this.headerPanel=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_itemHeaderPanel","class":"bbi-dbrd-designer-panel-header-wrapper"});var n=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_item_autocomplete","class":"bbi-dbrd-designer-autocomplete bbi-dbrd-designer-font"}),t=BoldBIDashboard.buildTag("input","",{},{type:"text",placeholder:this.waterMarkText,id:this.dashboardDesigner._id+"_panelSearch","class":"bbi-autocomplete bbi-dbrd-designer-font bbi-dbrd-designer-search-box bbi-dbrd-designer-watermark bbi-dbrd-designer-boxshadow e-js e-input"}),i=BoldBIDashboard.buildTag("span","",{},{id:this.dashboardDesigner._id+"_searchIcon","class":"bbi-dbrd-designer-icon bbi-dbrd-designer-search"});n.append(t);n.append(i);this.headerPanel.append(n);this.defaultPanel.append(this.headerPanel)},n.prototype.slideDownOperation=function(n){this.bbdesigner$(n.currentTarget).removeClass("plus").addClass("minus")},n.prototype.slideUpOperation=function(n){this.bbdesigner$(n.currentTarget).addClass("plus").removeClass("minus")},n.prototype.onExpandCollapseClick=function(n){var i=this.bbdesigner$(n.currentTarget),u=i.attr("data-groupid"),r=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_widgetgroup_"+u),t;i.hasClass("plus")?r.slideDown("fast",this.bbdesigner$.proxy(this.slideDownOperation,this,n)):r.slideUp("fast",this.bbdesigner$.proxy(this.slideUpOperation,this,n));this.clearTimer();t=this;this.refreshTimer=setTimeout(this.bbdesigner$.proxy(function(){t.expandablePanel.data("BoldBIDashboardScroller")&&(t.expandablePanel.data("BoldBIDashboardScroller").refresh(!0),t.clearTimer())},this),300)},n.prototype.clearTimer=function(){this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null)},n.prototype.getDragElement=function(n){var r=BoldBIDashboard.buildTag("div","",{width:"74.5px",height:"75px",cursor:"default",float:"left","vertical-align":"middle","text-align":"center",border:"1px solid var(--primary-border-color)","background-color":"var(--secondary-background-color)"},{unselectable:"on","data-widgetnamespace":n.attr("data-widgetnamespace"),"data-widgetname":n.attr("data-widgetname"),"data-widgetid":n.attr("data-widgetid"),"data-min-rowspan":n.attr("data-min-rowspan"),"data-min-colspan":n.attr("data-min-colspan")}),t=BoldBIDashboard.buildTag("div","",{"margin-top":"14px",cursor:"default"},{"class":n.attr("data-widgetclass"),"data-widgetnamespace":n.attr("data-widgetnamespace"),"data-widgetname":n.attr("data-widgetname"),"data-widgetid":n.attr("data-widgetid"),"data-min-rowspan":n.attr("data-min-rowspan"),"data-min-colspan":n.attr("data-min-colspan")}),i;return t.addClass("bbi-widgeticon-drag"),i=n.attr("data-icontemplate"),BoldBIDashboard.isNullOrUndefined(i)||i===""||t.append(n.attr("data-icontemplate")),r.append(t),r},n.prototype.renderGroupItems=function(n,t){var p=[],w=[],r,l,k,a,h,u,i,o,f,c,v,d,g,y;for(r in n){var nt=n[r].GroupName.replace(" ",""),e=n[r].GroupId,b=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_widgetgroup_"+e,"class":"bbi-dbrd-designer-widget-group-content"}),s=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_widgetgroupHeader_"+e,"class":"bbi-dbrd-designer-widget-group-header-wrapper minus","data-groupid":e});for(r===(n.length-1).toString()&&s.addClass("bbi-last-element"),l=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{},{id:this.dashboardDesigner._id+"_widgetgroupHeaderText_"+nt,"class":"bbi-dbrd-designer-font bbi-dbrd-designer-widget-group-header-text"}),l.text(n[r].GroupName),s.append(l),k=BoldBIDashboard.buildTag("div","",{},{"class":"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-group-header-icon",id:this.dashboardDesigner._id+"_widgetgroupHeaderIcon_"+e}),s.append(k),a=BoldBIDashboard.buildTag("div","",{},{unselectable:"on",id:this.dashboardDesigner._id+"_widgetgroupelement_"+e,"class":"bbi-dbrd-designer-widget-group-content-wrapper"}),h=void 0,u=0;u<n[r].Items.length;u++){i=n[r].Items[u];o=i.id;u%2==0&&(h=BoldBIDashboard.buildTag("div","",{},{unselectable:"on",id:this.dashboardDesigner._id+"_"+n[r].GroupId+"_widgetcontainer_row","class":"bbi-dbrd-designer-widget-group-row"}));f=BoldBIDashboard.buildTag("div","",{},{"class":"e-draggable bbi-dbrd-designer-widget-group-column",unselectable:"on","data-widgetclass":i.cssClass,"data-widgetname":i.widgetName,"data-widgetnamespace":i.widgetNameSpace,"data-icontemplate":i.iconTemplate,"data-widgetid":o,"data-serializationnamespace":i.serializationNameSpace,"data-min-rowspan":i.minRowSpan,"data-min-colspan":i.minColSpan,id:this.dashboardDesigner._id+"_"+o,"data-dbrdid":this.dashboardDesigner.model.predefinedWidgets.dashboardId,"data-dbrdversion":this.dashboardPublishedVersion});h.append(f);this.dashboardDesigner.dragDropHelper.initializeDraggable(f,"10000");u%2==0&&a.append(h);c=BoldBIDashboard.buildTag("div","",{},{"class":"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-icon "+i.cssClass,"data-widgetclass":i.cssClass,"data-widgetname":i.widgetName,"data-widgetnamespace":i.widgetNameSpace,"data-icontemplate":i.iconTemplate,"data-widgetid":o,"data-serializationnamespace":i.serializationNameSpace,"data-min-rowspan":i.minRowSpan,"data-min-colspan":i.minColSpan});i.useIconTemplate&&c.append(i.iconTemplate);f.append(c);p.push(c);v=BoldBIDashboard.buildTag("span","",{},{id:this.dashboardDesigner._id+o+"_text",unselectable:"on","class":"bbi-dbrd-designer-font bbi-dbrd-designer-widget-name"});d=i.widgetDisplayName;v.text(d);f.append(v);i.showBadge&&i.badgeText!==""&&!BoldBIDashboard.isNullOrUndefined(i.badgeText)&&(g=BoldBIDashboard.buildTag("span",i.badgeText,{},{"class":"bbi-dbrd-badge"}),f.append(g));var tt=i.tooltip.title,it=i.tooltip.description,rt=i.tooltip.dataRequirement,ut=this.generateTooltipTemplate(tt,it,rt);f.BoldBIDashboardTooltip({content:ut,cssClass:"bbi-defaultIndex-template",position:{stem:{horizontal:"left",vertical:"top"},target:{horizontal:"right",vertical:0}},tip:{adjust:{xValue:u%2==0?85:10}},isBalloon:!1,showShadow:!0,beforeOpen:function(n){n.cancel=n.event.buttons!==0}})}y=BoldBIDashboard.buildTag("div","",{},{});b.append(a);y.append(s,b);w.push(y)}return t.append(w),this.bbdesigner$(this.expandablePanel).data("BoldBIDashboardScroller")&&this.bbdesigner$(this.expandablePanel).data("BoldBIDashboardScroller").refresh(),p},n.prototype.getSearchItems=function(){return this.searchItems},n.prototype.getSearchItemsLength=function(){for(var n=0,t=0;t<this.searchItems.length;t++)n=n+this.searchItems[t].Items.length;return n},n.prototype.onSearchClick=function(n){if(n.keyCode!==13){var r=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_panelSearch"),t=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel"),i=r.val();i.length>0?(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-close").removeClass("bbi-dbrd-designer-search"),this.searchItems=this.getPanelItems(this.panelItems,i),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel")),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.renderGroupItems(this.searchItems,t,!0,!0),this.showToolboxItems(this.searchItems.length>0)):(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel")),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.searchItems=[],this.renderGroupItems(this.panelItems,t,!0,!1),this.showToolboxItems(!0))}},n.prototype.onCloseClick=function(){this.defaultPanel.find("#"+this.dashboardDesigner._id+"_panelSearch").val("");this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close");BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel"));this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty();this.showToolboxItems(!0);var n=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel");this.renderGroupItems(this.panelItems,n,!0,!1)},n.prototype.onDataSourceSearchTextFocusIn=function(n){var t=this.bbdesigner$(n.currentTarget.parentElement);t.addClass("e-focus")},n.prototype.onDataSourceSearchTextFocusOut=function(n){var t=this.bbdesigner$(n.currentTarget.parentElement);t.hasClass("e-focus")&&t.removeClass("e-focus")},n.prototype.showToolboxItems=function(n){this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_itemPanel_empty_msg").css("display",n?"none":"table")},n.prototype.onItemScroll=function(n){n.cancel=this.dashboardDesigner.isItemDrag},n.prototype.updateCulture=function(){var n=this.dashboardDesigner._id,i=this.dashboardDesigner.model.localeSettings.culture,t;t=BoldBIDashboard.Designer.Locale[i]?BoldBIDashboard.Designer.Locale[i].itemPanel:BoldBIDashboard.Designer.Locale["en-US"].itemPanel;this.waterMarkText=t.waterMarkText;this.noMatchedText=t.noDataFound;this.defaultPanel.find("#"+n+"_panelSearch").val(this.defaultPanel.find("#"+n+"_panelSearch").hasClass("e-focus")?"":this.waterMarkText);this.dashboardDesigner.element.find("#"+n+"_noMessageToolTip").find(".editLabel").html(this.noMatchedText)},n.prototype.wireEvents=function(){this.targetTag.on("click",".bbi-widgetpanel-expandcollapse",this.bbdesigner$.proxy(this.onExpandCollapsePanel,this));this.defaultPanel.on("keyup",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onSearchClick,this));this.defaultPanel.on("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.onCloseClick,this));this.defaultPanel.on("click",".bbi-dbrd-designer-widget-group-header-wrapper",this.bbdesigner$.proxy(this.onExpandCollapseClick,this));this.defaultPanel.on("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this));this.defaultPanel.on("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this));this.existingPanel.on("click",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.sendRequestForWidgetsDetail,this));this.existingPanel.on("click",".bbi-specific-dashboard-wrapper ",this.bbdesigner$.proxy(this.backToDashBoard,this));this.existingPanel.on("keyup","#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel",this.bbdesigner$.proxy(this.dashboardSearch,this));this.existingPanel.on("click","#"+this.dashboardDesigner._id+"_dashboard_refresh_icon",this.bbdesigner$.proxy(this.refreshDashboardList,this));this.existingPanel.on("mouseenter",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.activeEllipsis,this));this.existingPanel.on("mouseleave",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsis,this));this.existingPanel.on("mouseenter",".e-widget-wrapper",this.bbdesigner$.proxy(this.activeEllipsisForWidgets,this));this.existingPanel.on("mouseleave",".e-widget-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsisForWidgets,this));this.existingPanel.on("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.resetDashboardList,this));this.existingPanel.on("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this));this.existingPanel.on("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this))},n.prototype.unWireEvents=function(){this.targetTag.off("click",".bbi-widgetpanel-expandcollapse",this.bbdesigner$.proxy(this.onExpandCollapsePanel,this));this.defaultPanel.off("keyup",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onSearchClick,this));this.defaultPanel.off("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.onCloseClick,this));this.defaultPanel.off("click",".bbi-dbrd-designer-widget-group-header-wrapper",this.bbdesigner$.proxy(this.onExpandCollapseClick,this));this.defaultPanel.off("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this));this.defaultPanel.off("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this));this.existingPanel.off("click",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.sendRequestForWidgetsDetail,this));this.existingPanel.off("click",".bbi-specific-dashboard-wrapper ",this.bbdesigner$.proxy(this.backToDashBoard,this));this.existingPanel.off("keyup","#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel",this.bbdesigner$.proxy(this.dashboardSearch,this));this.existingPanel.off("click","#"+this.dashboardDesigner._id+"_dashboard_refresh_icon",this.bbdesigner$.proxy(this.refreshDashboardList,this));this.existingPanel.off("mouseenter",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.activeEllipsis,this));this.existingPanel.off("mouseleave",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsis,this));this.existingPanel.off("mouseenter",".e-widget-wrapper",this.bbdesigner$.proxy(this.activeEllipsisForWidgets,this));this.existingPanel.off("mouseleave",".e-widget-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsisForWidgets,this));this.existingPanel.off("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.resetDashboardList,this));this.existingPanel.off("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this));this.existingPanel.off("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this))},n.prototype.updateWidgetItemVisibility=function(n){var t,i;this.panelItems=this.cleanWidgetGroups(n);t=this.bbdesigner$;BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.Value)||(i=BoldBIDashboard.Designer.Locale[Object.keys(BoldBIDashboard.Designer.Locale)[0]],t.each(BoldBIDashboardDesigner.widgetItems,function(r,u){u.GroupName===i.itemPanel.groupItems.relation&&t.each(u.Items,function(t,i){i.widgetName!=="BingMap"||BoldBIDashboard.isNullOrUndefined(n.Value[i.widgetName.toLowerCase()])||(i.hide=n.Value[i.widgetName.toLowerCase()].hide)})}),t.each(this.widgetItems,function(r,u){u.GroupName===i.itemPanel.groupItems.relation&&t.each(u.Items,function(t,i){i.widgetName!=="BingMap"||BoldBIDashboard.isNullOrUndefined(n.Value[i.widgetName.toLowerCase()])||(i.hide=n.Value[i.widgetName.toLowerCase()].hide)})}))},n.prototype.renderGroup=function(){var n=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel");this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty();this.dashboardDesigner.model.mode===BoldBIDashboard.Designer.mode.design&&this.dashboardDesigner._trigger("beforeWidgetItemsListed",{widgetInfo:this.panelItems});this.renderGroupItems(this.panelItems,n,!0,!1)},n.prototype.cleanWidgetGroups=function(n){return this.updateWidgetList(JSON.parse(JSON.stringify(this.widgetItems)),n)},n.prototype.updateWidgetList=function(n,t){for(var i=n.length-1;i>=0;i--)this.setWidgetVisibility(t,n[i].Items),this.hideWidgetIfAny(n[i].Items),n[i].Items.length===0&&n.splice(i,1);return n},n.prototype.setWidgetVisibility=function(n,t){BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.Value)||t.filter(function(t){BoldBIDashboard.isNullOrUndefined(t.widgetName)||BoldBIDashboard.isNullOrUndefined(n.Value[t.widgetName.toLowerCase()])||(t.hide=n.Value[t.widgetName.toLowerCase()].hide,t.customData=n.Value[t.widgetName.toLowerCase()].args)})},n.prototype.hideWidgetIfAny=function(n){for(var t=n.length-1;t>=0;t--)!BoldBIDashboard.isNullOrUndefined(n[t].hide)&&n[t].hide&&n.splice(t,1)},n.prototype.generateTooltipTemplate=function(n,t,i){return"<div class= 'e-defaultIndex-info-container'><div class='bbi-defaultIndex-text-wrapper'><div class = 'bbi-defaultIndexHeader'><b>"+n+"<\/b><\/div><div class = 'e-defaultIndex-info-text'>"+t+"<\/div><\/div><div class='bbi-defaultIndex-text-wrapper'><div class = 'bbi-defaultIndexHeader'><b>"+this.locale.itemPanel.widgetTitle.dataRequirements+"<\/b><\/div><div class = 'e-defaultIndex-info-text '>"+i+"<\/div><\/div><\/div>"},n.prototype.createDashboardListContainer=function(n,t){for(var i=0;i<n.length;i++){var r=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_dashboard_name_wrapper_"+n[i].Id,"class":"bbi-dashboard-name-wrapper e-tooltip","data-id":n[i].Id,"data-version":n[i].Version}),u=BoldBIDashboard.buildTag("div",'<label style="cursor: pointer;">'+n[i].Name+"<\/label>",{},{"class":"bbi-dbrd-dashboard-name e-tooltip"}),f=BoldBIDashboard.buildTag("div",'<label style="cursor: pointer;">By '+n[i].CreatedUserName+"<\/label>",{},{"class":"bbi-dbrd-dashboard-creator-name",type:"text"});r.append(u,f);t.append(r)}return t},n.prototype.setScroller=function(n){var t=n.scrollTop,i=this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_expandable_parent_div").height(),r=this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_scroll_content_existingpanel").height();!BoldBIDashboard.isNullOrUndefined(t)&&t>0&&r-i<=t&&this.pageNumber>0&&!this.pageRequestInProgress&&(this.showSkeletonContainer(),this.searchInitiated=!1,this.pageRequestInProgress=!0,this.loadDashboardList(this.pageNumber,this.searchText))},n.prototype.loadDashboardList=function(n,t){!BoldBIDashboard.isNullOrUndefined(this.filterSearchTimer)&&this.filterSearchTimer&&this.filterSearchTimer.readyState!==4&&this.filterSearchTimer.abort();var i={pageSize:20,pageNo:n};this.filterSearchTimer=this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.shareddashboard,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedDashboard,data:JSON.stringify({pageInfo:i,sortInfo:{sortOrder:"Asc",sortBy:"Name"},searchKey:t})},{fnction:this.bbdesigner$.proxy(this.renderDashboardList,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForSearch,this),completefnction:this.bbdesigner$.proxy(this.updatePageRequestProgress,this)},!0,!0)},n.prototype.updatePageRequestProgress=function(){this.pageRequestInProgress=!1},n.prototype.onConnectionErrorForSearch=function(n){if(n.statusText!=="abort"&&n.readyState===0&&!n.responseText){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none");this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block");var t=this.locale.errorMessage.connectionRefused;this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(t)}},n.prototype.renderDashboardList=function(n){if(!BoldBIDashboard.isNullOrUndefined(n.Data)&&n.Data.length>0){this.hideErrorMsg();this.searchInitiated&&(this.scrollExistingContent[0].innerHTML="");var t=n.Data;t=this.widgetPanelSettings.existingDashboards.length>0?this.getMatchingdDashboardsList(t):t;this.createDashboardListContainer(t,this.scrollExistingContent);this.pageNumber=n.Page;this.hideSkeletonContainer();this.scrollExistingContent.css("display","block");this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh()}else this.hideSkeletonContainer(),this.scrollExistingContent[0].innerHTML="",this.showErroMsg(this.locale.errorMessage.noDashboard)},n.prototype.dashboardSearch=function(){var n=this;BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?this.searchInitiated=!1:(this.searchText=this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val(),this.searchText!==""?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-close").removeClass("bbi-dbrd-designer-search"),this.searchInitiated=!0,this.scrollExistingContent[0].innerHTML="",this.showSkeletonContainer(),this.hideErrorMsg(),setTimeout(function(){n.loadDashboardList(1,n.searchText)},500)):this.resetDashboardList())},n.prototype.renderSkelton=function(n){var u=BoldBIDashboard.buildTag("div.bbi-dbrd-dashboards-skeleton-tag","",{},{id:this.dashboardDesigner._id+n}),t=BoldBIDashboard.buildTag("div.bbi-empty-ds-title-block","",{},{id:this.dashboardDesigner._id+n+"_title_blocks"}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-dashboard-title bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+n+"_title_loading"}),r=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-dashboard-content bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+n+"_content_loading"}),f=t.append(i,r).clone();return u.append(f,t.append(i,r))},n.prototype.showSkeletonContainer=function(){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").length>0&&(this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader")[0].innerHTML="");this.sharedDashboardLoader.append(this.renderSkelton("_shared_dbrd_skeleton"));this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_scroll_parent_container").append(this.sharedDashboardLoader);this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","block")},n.prototype.hideSkeletonContainer=function(){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none")},n.prototype.renderSkeletonForWidgets=function(n){var u=BoldBIDashboard.buildTag("div.bbi-dbrd-widgets-skeleton-tag","",{},{id:this.dashboardDesigner._id+n}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title-block","",{},{id:this.dashboardDesigner._id+n+"_widgets_title_blocks"}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title-icon bbi-dbrd-empty-dashboard-list-loader","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+n+"_widgets_title_loading"}),f=t.append(i,r).clone();return u.append(f,t.append(i,r))},n.prototype.refreshDashboardList=function(){if(BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)){this.hideErrorMsg();this.dashboardWholeWrapper.remove();this.sendRequestForDashboardsDetail({activeIndex:1})}else this.hideErrorMsg(),this.pageNumber=1,this.searchInitiated=!1,this.showSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val(""),this.searchText="",this.scrollExistingContent[0].innerHTML="",this.loadDashboardList(this.pageNumber,this.searchText)},n.prototype.showErroMsg=function(n){BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(n)):(this.scrollExistingContent.css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(n),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},n.prototype.hideErrorMsg=function(){BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html("")):(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(""),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},n.prototype.getCurrentWidgetItems=function(n){for(var e,i,u,o,t=this.widgetItems,f=[],r=0;r<n.length;r++)for(e=!1,i=0;i<t.length;i++){if(BoldBIDashboard.isNullOrUndefined(n[r].Type)){f.push(t[0].Items[1]);break}else for(u=0;u<t[i].Items.length;u++)if(o=!BoldBIDashboard.isNullOrUndefined(t[i].Items[u])&&t[i].Items[u].isPreconfiguredWidget,n[r].Type!==t[0].Items[0].serializationNameSpace||o){if(n[r].Type===t[i].Items[u].serializationNameSpace&&!o){f.push(t[i].Items[u]);e=!0;break}}else if(n[r].SubType===t[i].Items[u].widgetName){f.push(t[i].Items[u]);e=!0;break}if(e)break}if(f.length===0)for(r=0;r<n.length;r++)f.push(t[0].Items[1]);return f},n.prototype.resetDashboardList=function(){this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close");this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val("");this.searchText="";this.hideErrorMsg();this.showSkeletonContainer();this.scrollExistingContent[0].innerHTML="";this.loadDashboardList(1,this.searchText)},n.prototype.onExpandCollapsePanel=function(n,t){var u;if(t===void 0&&(t=!1),!BoldBIDashboard.isNullOrUndefined(n)||t){var i=t?this.targetTag.find("#"+this.dashboardDesigner._id+"_item_panel_expand_collapse").attr("data-toggle")==="expand":this.bbdesigner$(n.target).attr("data-toggle")==="expand",r=i?"none":"block",f=t?this.targetTag.find("#"+this.dashboardDesigner._id+"_item_panel_expand_collapse"):this.bbdesigner$(n.target);f.attr({"data-toggle":i?"collapse":"expand","data-tooltip":i?this.locale.dataConfigurationPanel.expand:this.locale.dataConfigurationPanel.collapse}).removeClass("bbi-widgetpanel-expand bbi-widgetpanel-collapse").addClass(i?"bbi-widgetpanel-expand":"bbi-widgetpanel-collapse");t&&f.addClass("bbi-widgetspanel-expandcollapseicon-disable");this.defaultPanel.find("#"+this.dashboardDesigner._id+"_item_autocomplete").css("display",r);this.expandablePanel.css("display",r);this.existingPanel.css("display",r);this.targetTag.find("#"+this.dashboardDesigner._id+"_designerItemPanel_Tab").css("display",r);this.targetTag.css("width",i?"15px":"240px");this.dashboardDesigner.updateDesignPanel();BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.designerPanel)||this.dashboardDesigner.designerPanel.updateScrollBar();i||(u=this.targetTag.find("#"+this.dashboardDesigner._id+"_designerItemPanel_Tab").data("BoldBIDashboardTab"),BoldBIDashboard.isNullOrUndefined(u)||(u.model.selectedItemIndex===1?this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh():this.expandablePanel.data("BoldBIDashboardScroller").refresh()))}},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ItemPanel",InternalItemPanel,window);ExistingWidgetCategory=function(){function n(){this.isCategoryExists=!1;this.categoryGroupId="";this.categoryName=""}return n}(),function(n){var t=function(){function t(n){this.locale=null;this.designerInst=n;this.bbdesigner$=this.designerInst.bbdesigner$;this.locale=this.designerInst.getLocalizationContent();this.propertyPanel=this.designerInst.modules.propertyPanel;this.widgetHelper=this.designerInst.modules.widgetHelper}return t.prototype.render=function(t,i,r){var f,e,u,l,a,h,tt,v;if(this.canUpdate=!1,this.categoryId=this.designerInst._id+"_"+i+"_"+r.category,f=this.propertyPanel.propertyPanelContainer.width(),e=this.designerInst.element.find("#"+this.categoryId),r.value=this.widgetHelper.getCurrentWidgetInstance().getNoDataContainerSettings(),u=r.value,e.length===0&&t){e=n.buildTag("div","",{width:f},{id:this.categoryId});var y=n.buildTag("table.bbi-designer-exp-table","",{width:"100%","border-spacing":"0 0.8em"},{unselectable:"on"}),o=n.buildTag("tr","",{},{}),it=(f-33)*47/100,s=n.buildTag("td","",{width:it+"px"},{}),p=n.buildTag("td","",{},{}),rt=n.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.hideIcon,{},{id:this.categoryId+"_wdgt_nodata_text_ckb","for":this.categoryId+"_wdgt_nodata_ckb"}),ut=n.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.showDefaultIcon,{"margin-right":"11px"},{id:this.categoryId+"_wdgt_nodata_imagetext_ckb","for":this.categoryId+"_wdgt_nodata_image_ckb"}),c=n.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.text,{"margin-right":"11px"},{id:this.categoryId+"_wdgt_nodata_text"}),w=n.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_nodata_ckb",type:"checkbox"}),b=n.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_nodata_image_ckb",type:"checkbox"});this.inputTxt=n.buildTag("input.e-textbox bbi-designer-fontfamily","",{position:"relative"},{id:this.categoryId+"_wdgt_nodata_custom_txt",type:"text",placeholder:this.locale.designPanel.noDataToBeDisplay});var k=n.buildTag("div","",{width:"200px"},{id:this.categoryId+"_wdgt_nodata_custom_input_container"}),d=36,g=n.buildTag("div","",{width:d+"px",display:"inline-block","margin-top":"3px"}),nt=n.buildTag("input.e-reportdesigner-designer","",{},{id:this.categoryId+"_wdgt_nodata_txt_color"});g.append(nt);nt.BoldBIDashboardColorPicker({value:n.DashboardUtil.getColorCode("#000000"),cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:d+"px",select:this.bbdesigner$.proxy(this.onColorChange,this),modelType:"palette",palette:"basicpalette",buttonMode:n.ButtonMode.Dropdown});l=n.buildTag("div","",{width:(f-33)*57/100+"px",display:"inline-block","margin-top":"3px"});a=n.buildTag("input","",{},{id:this.categoryId+"_wdgt_nodata_trans_numeric"});l.append(a);h=(f-33)*57/200;h=h-12;a.ejNumericTextbox({incrementStep:.1,decimalPlaces:1,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",maxValue:1,minValue:0,change:this.bbdesigner$.proxy(this.onTransparencyChange,this),enabled:!1,width:h+"px"});k.append(this.inputTxt);tt=o.clone();tt.addClass("bbi-dbrd-hiddendiv");y.append(o.clone().append(s.clone().append(rt),p.clone().append(w)),o.clone().append(s.clone().append(c),k),o.clone().append(s.clone().append(c.clone().html(this.locale.propertyPanel.noDataContainerSettings.textColor)),g),o.clone().append(s.clone().append(ut),p.clone().append(b)),o.clone().append(s.clone().append(c.clone().html(this.locale.propertyPanel.noDataContainerSettings.transparency)),l));e.append(y);t.append(e);w.BoldBIDashboardCheckBox({width:(f-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.onChkbxClick,this),cssClass:"e-designer-prop-checkbox"});b.BoldBIDashboardCheckBox({width:(f-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.onDefaultImgChkbxClick,this),cssClass:"e-designer-prop-checkbox"});this.inputTxt.on("focusout",this.bbdesigner$.proxy(this.saveCustomMsg,this))}e.length>0&&(n.isNullOrUndefined(u)||(this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_ckb").data("BoldBIDashboardCheckBox").setModel({checked:u.HideDefaultIcon}),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_image_ckb").data("BoldBIDashboardCheckBox").setModel({checked:u.ImageInfo.ShowImage}),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_txt_color").data("BoldBIDashboardColorPicker").option("value",n.DashboardUtil.getColorCode(u.FontColor)),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_custom_txt").val(u.CustomMsg),v=this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").data("ejNumericTextbox"),v.setModel({value:u.ImageInfo.Transparency}),u.ImageInfo.ShowImage&&v.setModel({enabled:!0}),this.noDataContainerSettings=r));this.canUpdate=!0},t.prototype.onTransparencyChange=function(t){t.isInteraction&&(this.noDataContainerSettings.value.ImageInfo.Transparency=t.value,this.updateWidgetProperty(this.noDataContainerSettings),n.Dashboard.WidgetContainerHelper.updateNoDataImageOpacity(this.widgetHelper.getCurrentWidgetInstance(),t.value))},t.prototype.onColorChange=function(t){n.isNullOrUndefined(t)||n.isNullOrUndefined(t.value)||this.canUpdate&&(this.noDataContainerSettings.value.FontColor=t.value,this.updateWidgetProperty(this.noDataContainerSettings),n.Dashboard.WidgetContainerHelper.updateNoDataFontColor(this.widgetHelper.getCurrentWidgetInstance(),t.value))},t.prototype.onChkbxClick=function(t){t.isInteraction&&(this.noDataContainerSettings.value.HideDefaultIcon=t.isChecked,this.updateWidgetProperty(this.noDataContainerSettings),n.Dashboard.WidgetContainerHelper.updateNoDataIcon(this.widgetHelper.getCurrentWidgetInstance(),t.isChecked))},t.prototype.onDefaultImgChkbxClick=function(t){if(t.isInteraction){this.noDataContainerSettings.value.ImageInfo.ShowImage=t.isChecked;this.noDataContainerSettings.value.ImageInfo.Type=NoDataImageType.Default;this.updateWidgetProperty(this.noDataContainerSettings);n.Dashboard.WidgetContainerHelper.updateNoDataDefaultImg(this.widgetHelper.getCurrentWidgetInstance(),t.isChecked);var i=this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").data("ejNumericTextbox");i.setModel({enabled:t.isChecked})}},t.prototype.saveCustomMsg=function(t){var i=this.bbdesigner$(t.currentTarget);!n.isNullOrUndefined(i)&&i.length>0&&i.val().length>0&&(this.noDataContainerSettings.value.CustomMsg=i.val(),this.updateWidgetProperty(this.noDataContainerSettings),n.Dashboard.WidgetContainerHelper.updateDataNotConfiguredMsg(this.widgetHelper.getCurrentWidgetInstance(),i.val()))},t.prototype.updateWidgetProperty=function(n){var t=this.widgetHelper.getCurrentWidgetInstance();t.updateNoDataContainerSettings(n.value);this.designerInst.modules.serialization.notifyChange()},t}();n.NoDataContainerAppearence=t}(BoldBIDashboard||(BoldBIDashboard={})),function(n){var t;(function(t){var i=function(){function t(n){this.id=null;this.locale=null;this.dashboardDesigner=null;this.id=n._id;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent()}return t.prototype.createMenu=function(t,i,r,u){var f=n.buildTag("div","",{"margin-top":"5px"},{id:this.id+"_"+t.Name+"_categoryAggregateList"});i.length===0&&(i=this.getDefaultMenuJson(t,r,u));i.length>0&&this.populateFunctionItems(f,t,i)},t.prototype.createMenuforHierarchy=function(n,t,i,r,u){this.hierarchyFieldInfo=r;this.createMenu(n,t,i,u)},t.prototype.getDefaultMenuJson=function(t,i,r){var u=[],e,f;if(t.IsParameterField)return u;if(e=!1,t.ContainerType===FieldContainerType.Numeric||t.ContainerType===FieldContainerType.None){for(f=0;f<i.length;f++)if(i[f].Id===t.Id)u=this.getNumericMenuItems(t);else if(i[f].ColumnId===t.Id){e=!0;t.ContainerName!=="Tooltip"&&u.push(this.getMeasureFilterMenuItem());u.push(this.getMeasureFormatOption());break}e||(u=r?u.length===0?this.getMenuItemForHierarchialSet(t):u:u.length===0?t.ContainerType===FieldContainerType.None?this.getNon_NumericMenuItems(t):this.getNumericDimensionMenuItems(t):u)}else t.ContainerType===FieldContainerType.Non_Numeric?u=r?this.getMenuItemForHierarchialSet(t):this.getNon_NumericMenuItems(t):t.FieldType===FieldType.Dimensions&&n.isNullOrUndefined(t.ChildHierarchicalFields)?u=u.length===0?this.getMenuforCustomHierarchy(t):u:n.isNullOrUndefined(t.ChildHierarchicalFields)||(u=u.length===0?this.getMenuforCustomHierarchyFields(t):u);return t.ContainerName!=="Dimensions"&&u.unshift(this.getRenameMenuOption()),u},t.prototype.getMenuforCustomHierarchy=function(n){var t=[{Name:"CreateHierarchy",DisplayName:this.locale.dataconfiguration.menuItems.CreateHierarchyDisplayName,EnableSeparator:!0,IsDisable:this.checkCustomHierarchy(n)},{Name:"AddtoHierarchy",DisplayName:this.locale.dataconfiguration.menuItems.AddToHierarchyDisplayName,Items:this.getsubMenuhierarchyfields()}];return this.createMenuItemsList(t)},t.prototype.checkCustomHierarchy=function(n){for(var t=0;t<this.hierarchyFieldInfo.length;t++)if(n.Id===this.hierarchyFieldInfo[t].Id)return!0;return n.FieldActualType==="bbi-designer-dataset-datetime"?!0:!1},t.prototype.getMenuforCustomHierarchyFields=function(t){if(!n.isNullOrUndefined(t)){var i=[];return i.unshift(this.getRenameMenuOption()),i.push({Name:"Remove",DisplayName:this.locale.dataconfiguration.menuItems.CustomHierarchyremove,Items:t}),this.createMenuItemsList(i)}},t.prototype.getNumericMenuItems=function(n){var t=[],i;return n.IsAggregatedExpression||(i=[{Name:SummaryType.NONE,DisplayName:this.locale.dataconfiguration.summary.none,IsVisible:!1},{Name:SummaryType.SUM,DisplayName:this.locale.dataconfiguration.summary.sum},{Name:SummaryType.COUNT,DisplayName:this.locale.dataconfiguration.summary.count},{Name:SummaryType.AVG,DisplayName:this.locale.dataconfiguration.summary.avg},{Name:SummaryType.MAX,DisplayName:this.locale.dataconfiguration.summary.max},{Name:SummaryType[SummaryType.MIN],DisplayName:this.locale.dataconfiguration.summary.min},{Name:SummaryType.MEDIAN,DisplayName:this.locale.dataconfiguration.summary.median},{Name:SummaryType.COUNTD,DisplayName:this.locale.dataconfiguration.summary.countd},{Name:SummaryType.VAR,DisplayName:this.locale.dataconfiguration.summary.var,EnableSeparator:!0}],t=this.createMenuItemsList(i)),n.ContainerName!=="Tooltip"&&t.push(this.getMeasureFilterMenuItem()),t.push(this.getMeasureFormatOption()),t},t.prototype.getMeasureFilterMenuItem=function(){var n=[{Name:"MeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.measureFilterDisplayName,EnableSeparator:!0,Icon:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-configuration-parameters",Items:this.getSubMeasureFilterItems()}];return this.createMenuItemsList(n)[0]},t.prototype.getMeasureFormatOption=function(){var n=[{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName}];return this.createMenuItemsList(n)[0]},t.prototype.getRenameMenuOption=function(){var n=[{Name:"Rename",DisplayName:this.locale.dataconfiguration.menuItems.rename,EnableSeparator:!0}];return this.createMenuItemsList(n)[0]},t.prototype.getSubMeasureFilterItems=function(){var n=[{Name:"EditMeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearMeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(n)},t.prototype.getNon_NumericMenuItems=function(t){var i=[{Name:"Sort",DisplayName:this.locale.dataconfiguration.menuItems.SortDispalyName,EnableSeparator:!0,IsSelected:!0},{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName,IsVisible:!1}],r;return i=this.createMenuItemsList(i),t.FieldActualType==="bbi-designer-dataset-datetime"&&n.isNullOrUndefined(t.ChildHierarchicalFields)?i=i.concat(this.getDateFieldMenuItems(t)):n.isNullOrUndefined(t.ChildHierarchicalFields)||(r=[{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()}],i=i.concat(this.createMenuItemsList(r))),n.isNullOrUndefined(t.ChildHierarchicalFields)&&(i=i.concat(this.createMenuItemsList(this.getFilterMenuItem()))),i},t.prototype.getFilterMenuItem=function(){return[{Name:"DimensionFilters",DisplayName:this.locale.dataconfiguration.menuItems.dimensionFilterDisplayName,Items:this.getSubDimesionFilterItems()}]},t.prototype.getMenuItemForHierarchialSet=function(n){var t=[{Name:"Sort",DisplayName:this.locale.dataconfiguration.menuItems.SortDispalyName,EnableSeparator:!0,IsSelected:!0},{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName,IsVisible:!1}],i,r;return t=this.createMenuItemsList(t),n.FieldActualType==="bbi-designer-dataset-datetime"&&(i=[{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()}],t=t.concat(this.createMenuItemsList(i))),r=[{Name:"DimensionFilters",DisplayName:this.locale.dataconfiguration.menuItems.dimensionFilterDisplayName,Items:this.getSubDimesionFilterItems()}],t.concat(this.createMenuItemsList(r))},t.prototype.getDateFieldMenuItems=function(n){var t=[{Name:DateTimeFormat.Default,DisplayName:this.locale.dataconfiguration.menuItems.dateTime},{Name:DateTimeFormat.Date,DisplayName:this.locale.dataconfiguration.menuItems.date},{Name:DateTimeFormat.Year,DisplayName:this.locale.dataconfiguration.menuItems.year},{Name:DateTimeFormat.Quarter,DisplayName:this.locale.dataconfiguration.menuItems.quarter},{Name:DateTimeFormat.Month,DisplayName:this.locale.dataconfiguration.menuItems.month},{Name:DateTimeFormat.Day,DisplayName:this.locale.dataconfiguration.menuItems.day},{Name:"More",DisplayName:this.locale.dataconfiguration.menuItems.more,EnableSeparator:!0,Items:this.getSubDateTimeItems(n)},{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()},{Name:"RelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateOptionsDisplayName,IsVisible:!1,Items:this.getSubRelativeDateOptionsItems()},{Name:"Settings",DisplayName:"Settings",Items:this.getSubSettingsOptionsItems()}];return this.createMenuItemsList(t,n)},t.prototype.getSubDimesionFilterItems=function(){var n=[{Name:"EditDimensionFilter",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearDimensionFilter",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"},];return this.createMenuItemsList(n)},t.prototype.getNumericDimensionMenuItems=function(n){var t=[{Name:SummaryType.COUNT,DisplayName:this.locale.dataconfiguration.summary.count},{Name:SummaryType.COUNTD,DisplayName:this.locale.dataconfiguration.summary.countd,EnableSeparator:n.ContainerName!=="Tooltip"}];return t=this.createMenuItemsList(t),n.ContainerName!=="Tooltip"?t.push(this.getMeasureFilterMenuItem()):t=t.concat(this.getFirstLastMenuItems()),t.push(this.getMeasureFormatOption()),t},t.prototype.getsubMenuhierarchyfields=function(){for(var t=[],n=0;n<this.hierarchyFieldInfo.length;n++)this.hierarchyFieldInfo[n].FieldActualType!=="bbi-designer-dataset-datetime"&&t.push({Name:"AddToHierarchy",DisplayName:this.hierarchyFieldInfo[n].Name,Items:this.hierarchyFieldInfo[n]});return this.createMenuItemsList(t)},t.prototype.getFirstLastMenuItems=function(){var n=[{Name:"First",DisplayName:this.locale.dataconfiguration.menuItems.first},{Name:"Last",DisplayName:this.locale.dataconfiguration.menuItems.last,EnableSeparator:!0}];return this.createMenuItemsList(n)},t.prototype.getSubDateTimeItems=function(n){var t=[{Name:DateTimeFormat.Time,DisplayName:this.locale.dataconfiguration.menuItems.time},{Name:DateTimeFormat.Hour,DisplayName:this.locale.dataconfiguration.menuItems.hours},{Name:DateTimeFormat.Minute,DisplayName:this.locale.dataconfiguration.menuItems.minutes},{Name:DateTimeFormat.Second,DisplayName:this.locale.dataconfiguration.menuItems.seconds,EnableSeparator:!0},{Name:DateTimeFormat.QuarterYear,DisplayName:this.locale.dataconfiguration.menuItems.quarterYear},{Name:DateTimeFormat.MonthYear,DisplayName:this.locale.dataconfiguration.menuItems.monthYear},{Name:DateTimeFormat.WeekYear,DisplayName:this.locale.dataconfiguration.menuItems.weekYear,EnableSeparator:!0},{Name:DateTimeFormat.DateHour,DisplayName:this.locale.dataconfiguration.menuItems.dateHour},{Name:DateTimeFormat.DayOfWeek,DisplayName:this.locale.dataconfiguration.menuItems.dayOfWeek},{Name:DateTimeFormat.WeekOfYear,DisplayName:this.locale.dataconfiguration.menuItems.weekOfYear,EnableSeparator:!0},{Name:DateTimeFormat.DayMonthYear,DisplayName:this.locale.dataconfiguration.menuItems.dayMonthYear},{Name:DateTimeFormat.MonthDayYear,DisplayName:this.locale.dataconfiguration.menuItems.monthDayYear}];return t=this.fetchDateBucketFieldMenuItems(t,n),this.createMenuItemsList(t)},t.prototype.fetchDateBucketFieldMenuItems=function(n){var r=n,f=r[r.length-1],i,t,u;for(f.EnableSeparator=!0,i=this.dashboardDesigner.modules.widgetHelper.getAllWidgets(),t=0;t<i.length;t++)i[t].isDefaultDataWidget()&&(u={Name:"DateBucket_"+i[t].getJson().UniqueId,DisplayName:i[t].getContainerSettings().Title},r.push(u));return r},t.prototype.getSubRelativeDateFilterItems=function(){var n=[{Name:"EditRelativeDate",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearRelativeDate",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(n)},t.prototype.getSubRelativeDateOptionsItems=function(){var n=[{Name:"EditRelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearRelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(n)},t.prototype.getSubSettingsOptionsItems=function(){var n=[{Name:"EditSettings",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearCustomDateSettings",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(n)},t.prototype.createMenuItemsList=function(t,i){for(var r,e,o,f=[],u=0;u<t.length;u++)r=new n.Dashboard.FieldMenu,r.Name=n.isNullOrUndefined(t[u].Name)?r.Name:t[u].Name,r.DisplayName=n.isNullOrUndefined(t[u].Name)?r.DisplayName:t[u].DisplayName,r.EnableSeparator=n.isNullOrUndefined(t[u].EnableSeparator)?r.EnableSeparator:t[u].EnableSeparator,r.IsVisible=n.isNullOrUndefined(t[u].IsVisible)?r.IsVisible:t[u].IsVisible,r.IsDisable=n.isNullOrUndefined(t[u].IsDisable)?r.IsDisable:t[u].IsDisable,r.IsSelected=n.isNullOrUndefined(t[u].IsSelected)?r.IsSelected:t[u].IsSelected,r.Icon=n.isNullOrUndefined(t[u].Icon)?r.Icon:t[u].Icon,r.Items=n.isNullOrUndefined(t[u].Items)?r.Items:t[u].Items,r.Name==="Settings"&&(e=this.dashboardDesigner.designerPanel.selectedReportItems[0],o=n.Dashboard.WidgetHelper.getWidgetInstance(e).DataGroupInfo,r.IsVisible=this.IsMenuItemVisible(o,i)),f.push(r);return f},t.prototype.IsMenuItemVisible=function(n,t){for(var i=0;i<n.FieldContainers.length;i++)if(n.FieldContainers[i].Name===t.ContainerName&&n.FieldContainers[i].HasCustomDate)return!0;return!1},t.prototype.populateFunctionItems=function(t,i,r){for(var e,o,s,f=n.isNullOrUndefined(i.ChildHierarchicalFields)?n.buildTag("ul.bbi-designer-menu","",{padding:"4px"},{id:this.id+"_"+i.Id+"_categoryAggregateListUl_"+i.UniqueId}):n.buildTag("ul.bbi-designer-menu","",{padding:"4px"},{id:this.id+"_"+i.Id+"_categoryAggregateListUlHierarchy_"+i.UniqueId}),u=0;u<r.length;u++)e=this.getMenuListItem(r[u],i.UniqueId),o=e.find(".e-fieldmenuListIcon"),n.isNullOrUndefined(r[u].Icon)?this.updateDefaultSelection(i,r[u]):(o.addClass(r[u].Icon),o.css({"font-size":"12px","margin-left":"5px","margin-top":"1.5px"})),r[u].Items.length>0&&e.append(this.getChildMenuList(r[u],i)),f.append(e);t.append(f);s=new n.Dashboard.FieldMenuHandler(this.dashboardDesigner);f.BoldBIDashboardMenu({menuType:n.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this.id+"_"+name+"_categoryListDiv_"+i.UniqueId,width:180,click:this.bbdesigner$.proxy(s.onSettingsMenuItemClick,s,i)})},t.prototype.updateDefaultSelection=function(n,t){(n.SummaryType===t.Name||n.FieldType===FieldType.Dimensions&&n.DateTimeFormat===t.Name)&&(t.IsSelected=!0)},t.prototype.getMenuListItem=function(t,i){var r=n.buildTag("li.e-list","",{},{id:this.id+"_"+t.Name+"_"+i}),u=n.buildTag("a.e-fieldmenuListName",t.DisplayName,{},{fieldMenuName:t.Name}),f=n.buildTag("span.e-fieldmenuListIcon","",{},{});return u.BoldBIDashboardTooltip({content:t.DisplayName,collision:n.Tooltip.Collision.Flip,trigger:n.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!0}),u.append(f),r.append(u),r.data("menuitem-info",t),r.data("hierarchy-info",t.Items),r},t.prototype.getChildMenuList=function(t,i){for(var u,e,f=n.buildTag("ul","",{padding:"4px",width:"150px"},{}),r=0;r<t.Items.length;r++)u=this.getMenuListItem(t.Items[r],i.UniqueId),e=u.find(".e-fieldmenuListIcon"),n.isNullOrUndefined(t.Items[r].Icon)?(i.SummaryType===t.Items[r].Name||i.FieldType===FieldType.Dimensions&&i.DateTimeFormat===t.Items[r].Name)&&(t.Items[r].IsSelected=!0):e.addClass(t.Items[r].Icon).css({"font-size":"12px","margin-left":"5px","margin-top":"1.5px"}),f.append(u);return f},t.prototype.calculateMenuPosition=function(t,i,r){var h=t.height()+3,v=t.width(),c=this.dashboardDesigner.element.find(".bbi-designer-designer-dataassign"),y=c.height(),f=c.offset(),e=window.innerHeight-i.top,l=i.top-f.top,u=r.height()+n.parseInt(r.css("padding-top"),10)+n.parseInt(r.css("padding-bottom"),10)+n.parseInt(r.css("border-top-width"),10)+n.parseInt(r.css("border-bottom-width"),10),p=u+h>e,o=0,s=0,a;return p?(a=e>l,o=a?e<u?y+f.top-u:i.top:l<u?f.top:i.top-u,s=i.left-(v+143)):(o=i.top+h,s=i.left-136),{left:s,top:o}},t}();t.CreateFieldMenu=i})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={})),function(n){var t;(function(t){var i=function(){function t(t){this.id=null;this.dashboardDesigner=null;this.localizationContent=null;this.selectedFieldName=null;this.value=null;this.columnDetails=null;this.id=t._id;this.dashboardDesigner=t;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.localizationContent=this.dashboardDesigner.getLocalizationContent();this.dataconfiguration=new n.DashboardDesignerUtility.DataConfiguration(this.dashboardDesigner)}return t.prototype.onSettingsClick=function(t,i){var r,o,s;r=n.isNullOrUndefined(t.ChildHierarchicalFields)?this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUl_"+t.UniqueId):this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUlHierarchy_"+t.UniqueId);var u=r.data("BoldBIDashboardMenu"),f=this.getMenuJson(r,[],t),e=n.isNullOrUndefined(t.ChildHierarchicalFields)?"_categoryListSettingsIcon_":"_categoryListSettingsIconHierarchy_",l=this.id+"_"+t.Id+e+t.UniqueId;if(l===i.target.id)if(r.is(":visible"))u.hide();else if(r.children().length>0){o=this.dashboardDesigner.designerPanel.selectedReportItems[0];s=n.Dashboard.WidgetHelper.getWidgetInstance(o);f=s.onFieldSettingsClick(t,f);this.updateMenuJsonIntoMenu(f,u,t);var h=this.dashboardDesigner.element.find("#"+this.id+"_"+t.Id+e+t.UniqueId),a=new n.Dashboard.CreateFieldMenu(this.dashboardDesigner),c=a.calculateMenuPosition(h,h.offset(),r);u.show(c.left,c.top,this.dashboardDesigner.element.find("#"+this.id+"_"+t.Id+"_categoryListDiv_"+t.UniqueId),i)}},t.prototype.updateMenuJsonIntoMenu=function(n,t,i){for(var u=0;u<n.length;u++){var r=n[u],f=this.id+"_"+r.Name+"_"+i.UniqueId,e=this.bbdesigner$("#"+f);r.IsVisible=this.updateMenuVisibilityForFilterColumn(r,i);e.length>0&&(this.updateMenuSelection(r,e,i),this.hideOrShowMenuItem(r,f,t),this.disableOrEnableMenuItem(r,f,t),this.enableOrDisableSeperator(r,e));r.Items.length>0&&this.updateMenuJsonIntoMenu(r.Items,t,i)}},t.prototype.updateMenuVisibilityForFilterColumn=function(n,t){return t.IsFilterColumn?n.Name==="Sort"||n.Name==="RelativeDateOptions"?!1:n.Name==="DimensionFilters"||n.Name==="RelativeDateFilter"?!0:n.IsVisible:n.IsVisible},t.prototype.hideOrShowMenuItem=function(n,t,i){n.IsVisible?i.enableItemByID(t):i.hideItems(["#"+t])},t.prototype.disableOrEnableMenuItem=function(n,t,i){n.IsDisable?i.disableItemByID(t):i.enableItemByID(t)},t.prototype.enableOrDisableSeperator=function(n,t){n.EnableSeparator?t.addClass("e-separator"):t.removeClass("e-separator")},t.prototype.updateMenuSelection=function(t,i,r){var u;n.isNullOrUndefined(t.Icon)&&t.IsSelected?(u=i.find(">.e-fieldmenuListName>.e-fieldmenuListIcon"),u.addClass("e-dashboardtick-icon e-selectedfieldmenu"),t.Name!=="DimensionFilters"||n.isNullOrUndefined(r.FilterInfo)||n.isNullOrUndefined(r.FilterInfo.DimensionFilterInfo)?t.Name!=="RelativeDateFilter"||n.isNullOrUndefined(r.FilterInfo)||n.isNullOrUndefined(r.FilterInfo.RelativeDateFilterInfo)?t.Name!=="MeasureFormat"&&t.Name!=="MeasureFilter"&&t.Name!=="RelativeDateOptions"&&t.Name!=="RelativeDateFilter"&&t.Name!=="DimensionFilters"&&u.addClass("e-summaryselectedfieldmenu"):u.addClass("e-relativefiltermenu"):u.addClass("e-filtermenu")):(u=i.find(">.e-fieldmenuListName>.e-fieldmenuListIcon"),u.removeClass("e-dashboardtick-icon e-selectedfieldmenu e-relativefiltermenu e-filtermenu e-summaryselectedfieldmenu"))},t.prototype.getPropertyChangedMenuItems=function(n,t,i,r){var f=this.getPropertyMenuList(n,t,i),u;for(f.length>0&&r.push(f[0]),u=void 0;u<n.length;u++)n[u].Items.length>0&&this.getPropertyChangedMenuItems(n[u].Items,t,i,r);return r},t.prototype.getPropertyMenuList=function(n,t,i){var r=[];switch(t){case"Visiblity":r=n.filter(function(n){return n.IsVisible===i});break;case"Selection":r=n.filter(function(n){return n.IsSelected===i});break;case"Disable":r=n.filter(function(n){return n.IsDisable===i});break;case"Separator":r=n.filter(function(n){return n.EnableSeparator===i})}return r},t.prototype.getMenuJson=function(t,i,r){var e,f,o,u;if(!n.isNullOrUndefined(t)&&t.length>0)for(e=t.find(">.e-list"),f=0;f<e.length;f++)o=this.bbdesigner$(e[f]),u=o.data("menuitem-info"),u=n.isNullOrUndefined(r.DateBucketInfo)||n.isNullOrUndefined(r.DateBucketInfo.DatebucketId)||n.DashboardUtil.IsStringNullorWhiteSpace(r.DateBucketInfo.DatebucketId)?this.updateFilterItemSelection(r,u):this.updateDateBucketFilterSelection(r.DateBucketInfo.DatebucketId,r.DateTimeFormat.toString(),u),u=this.updateEnableOrDisableForFirstLastOption(u,r),u.Items=this.getMenuJson(o.find(">ul"),[],r),i.push(u);return i},t.prototype.updateEnableOrDisableForFirstLastOption=function(t,i){var f=this.getCurrentFieldFilterInfo(i.UniqueId,i.ContainerName),u,r;if(t.Name==="First"||t.Name==="Last")for(u=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,r=0;r<u.FieldContainers.length;r++)(u.FieldContainers[r].DisplayName===this.localizationContent.fieldContainer.values||u.FieldContainers[r].DisplayName===this.localizationContent.fieldContainer.value||u.FieldContainers[r].DisplayName===this.localizationContent.fieldContainer.locationValue)&&(t.IsDisable=u.FieldContainers[r].FieldInfos.length===0?!0:!1);else t.Name==="MeasureFormat"&&(t.IsDisable=n.isNullOrUndefined(f)||n.isNullOrUndefined(f.DimensionFilterInfo)||n.isNullOrUndefined(f.DimensionFilterInfo.TopNFilterInfo)?!1:!0);return t},t.prototype.updateFilterItemSelection=function(t,i){var r=this.getCurrentFieldFilterInfo(t.UniqueId,t.ContainerName),u;return n.isNullOrUndefined(r)&&this.validateSubFilterInfo(i.Name)?i.IsDisable=!0:n.isNullOrUndefined(r)&&i.IsSelected?(i.Name==="RelativeDateFilter"||i.Name==="DimensionFilters"||i.Name==="RelativeDateOptions"||i.Name==="MeasureFilter"||i.Name==="Settings")&&(i.IsSelected=!1):n.isNullOrUndefined(r)||(i.Name==="DimensionFilters"?i.IsSelected=!n.isNullOrUndefined(r.DimensionFilterInfo):i.Name==="MeasureFilter"?i.IsSelected=!n.isNullOrUndefined(r.MeasureFilterInfo):i.Name==="RelativeDateFilter"?i.IsSelected=!n.isNullOrUndefined(r.RelativeDateFilterInfo):i.Name==="RelativeDateOptions"?i.IsSelected=!n.isNullOrUndefined(r.RelativeDateOptions):i.Name==="Settings"?i.IsSelected=!n.isNullOrUndefined(r.CustomDateSettingsInfo):i.Name!=="First"||t.ContainerName!=="Tooltip"||n.isNullOrUndefined(r.DimensionFilterInfo)||n.isNullOrUndefined(r.DimensionFilterInfo.TopNFilterInfo)?i.Name!=="Last"||t.ContainerName!=="Tooltip"||n.isNullOrUndefined(r.DimensionFilterInfo)||n.isNullOrUndefined(r.DimensionFilterInfo.TopNFilterInfo)||(i.IsSelected=r.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Bottom):i.IsSelected=r.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Top,u=this.validateSubFilterInfo(i.Name),n.isNullOrUndefined(r.MeasureFilterInfo)&&i.Name==="ClearMeasureFilter"||n.isNullOrUndefined(r.DimensionFilterInfo)&&i.Name==="ClearDimensionFilter"||n.isNullOrUndefined(r.RelativeDateFilterInfo)&&i.Name==="ClearRelativeDate"||n.isNullOrUndefined(r.RelativeDateOptions)&&i.Name==="ClearRelativeDateOptions"||n.isNullOrUndefined(r.CustomDateSettingsInfo)&&i.Name==="ClearCustomDateSettings"?i.IsDisable=!0:u&&(i.IsDisable=!1)),i},t.prototype.validateSubFilterInfo=function(n){return n==="ClearMeasureFilter"||n==="ClearDimensionFilter"||n==="ClearRelativeDateOptions"||n==="ClearRelativeDate"||n==="ClearCustomDateSettings"},t.prototype.getCurrentFieldFilterInfo=function(n,t){var u=this.widgetHelper.getCurrentWidgetInstance(),f=u.DataGroupInfo,r=f.FieldContainers.filter(function(n){return n.Name===t}),i;return r.length>0&&(i=r[0].FieldInfos.filter(function(t){return t.UniqueId===n}),i.length>0)?i[0].FilterInfo:null},t.prototype.updateDateBucketFilterSelection=function(n,t,i){var r=i.Name.toString().replace(/\s/g,"");r=this.isDatebucketFieldInfo(i.Name)?this.getDateBucketWidgetID(i.Name):r;switch(r){case n:i.IsSelected=!0;break;case t:i.IsSelected=!1;break;default:return i}return i},t.prototype.getDateBucketWidgetID=function(t){if(!n.DashboardUtil.IsStringNullorWhiteSpace(t))return t.split("DateBucket_")[1]},t.prototype.getFieldMenuName=function(t,i){for(var e,o,r=t.Name.replace(/\s/g,""),s=DateTimeFormat[r]||DateTimeFormatForFilter[r],f=this.dashboardDesigner.modules.widgetHelper.getAllDatebucketWidgets(),u=0;u<f.length;u++)if(n.isNullOrUndefined(s)&&this.isDatebucketFieldInfo(r)){if(f[u].isDefaultDataWidget()&&f[u].getContainerSettings().Title===t.DisplayName)return e=f[u],r=e.getJson().selectedValue.replace(/\s/g,""),n.isNullOrUndefined(i.DateBucketInfo)&&(i.DateBucketInfo=new DateBucketInformation),i.DateBucketInfo.DatebucketId="",o=t.Name.split("DateBucket_")[1],i.DateBucketInfo.DatebucketId=o,i.DateBucketInfo.DateBucketFormat=DateTimeFormat[r],n.DashboardUtil.invokeMethod(f[u],"updateConfiguredWidgetsInfoList",[i]),r}else this.isDatebucketFieldInfo(r)||n.isNullOrUndefined(i.DateBucketInfo)||(i.DateBucketInfo=null,n.DashboardUtil.invokeMethod(f[u],"removeConfiguredWidgetsInfoList",[i]));return r},t.prototype.isDatebucketFieldInfo=function(n){return n.indexOf("DateBucket_")!==-1},t.prototype.onSettingsMenuItemClick=function(t,i){var o=this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUl_"+t.UniqueId).find(".e-mhover"),v,h,p,w,a,b,k;o=n.isNullOrUndefined(t.ChildHierarchicalFields)?o:this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUlHierarchy_"+t.UniqueId).find(".e-mhover");var e=o.closest("li").data("menuitem-info"),d=o.closest("li").data("hierarchy-info"),u=this.getFieldMenuName(e,t),f=o.closest("li").children("ul").length===0;if(this.selectedFieldName=t.DateTimeFormat.toString(),v=this.selectedFieldName,!n.isNullOrUndefined(o)&&u!==this.dashboardDesigner.getLocalizationContent().dataconfiguration.menuItems.more&&!0){h=this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUl_"+t.UniqueId).data("BoldBIDashboardMenu");h=n.isNullOrUndefined(t.ChildHierarchicalFields)?h:this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUlHierarchy_"+t.UniqueId).data("BoldBIDashboardMenu");f&&h.hide();var s=this.dashboardDesigner.element.find("#"+this.id+"_"+t.Id+"_categoryListLabel_"+t.UniqueId),c=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,l=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance.dimensionsList,r=this.getCurrentFieldInfoByUniqueName(c,t.UniqueColumnName),y=this.getCurrentDimensionFieldInfoById(l,t.Id);u==="Rename"&&(f=!1,p=this.dashboardDesigner.element.find("#"+this.id+"_"+t.Id+"_categoryListEditableTextBox_"+t.UniqueId),this.enableFieldRenameOption(p,s));u==="Sort"?(f=!1,this.sortClick(r,e)):u==="CreateHierarchy"?(f=!1,this.editCreateHierarchyFilterClick(y,l,t)):u==="Remove"?(f=!1,this.editRemoveCustomHierarchy(t)):u==="AddToHierarchy"?(f=!1,this.editAddToHierarchyFilterClick(y,l,d)):u==="EditDimensionFilter"?(f=!1,this.editDimensionFilterClick(r)):u==="EditMeasureFilter"?(f=!1,this.editMeasureFilterClick(r)):u==="ClearMeasureFilter"?this.clearMeasureFilterClick(r):u==="ClearDimensionFilter"||u==="ClearRelativeDate"?this.clearDimensionOrClearRelativeDateClick(r,e):u==="MeasureFormat"?(f=!1,this.measureFormatClick(r)):u==="EditSettings"?(f=!1,this.customDateDialog(r,v)):u==="EditRelativeDate"?(f=!1,this.editRelativeDateClick(r,e)):u==="EditRelativeDateOptions"?(f=!1,this.widgetHelper.getCurrentWidgetInstance().Type==="ListBox"||this.widgetHelper.getCurrentWidgetInstance().Type==="ComboBox"?!n.isNullOrUndefined(c.FieldContainers[1].FieldInfos)&&c.FieldContainers[1].FieldInfos.length>0?this.dashboardDesigner.modules.util.alertDialog(this.localizationContent.alertDialogTitle.relativeDatesAlert,this.localizationContent.relativeDateMessages.displayColumnBinded,IconType.warning,AlertType.Alert,!1,""):this.editRelativeDateOptionsClick(r):this.editRelativeDateOptionsClick(r)):u==="ClearRelativeDateOptions"?(f=!1,this.clearRelativeDateOptionsClick(r,e)):u==="First"?(f=!1,this.updateFirstAndLastFilterInfo(r,!0),this.updateLabelText(r,e)):u==="Last"?(f=!1,this.updateFirstAndLastFilterInfo(r,!1),this.updateLabelText(r,e)):n.isNullOrUndefined(SummaryType[e.Name])?u!=="MeasureFormat"&&u!=="MeasureFilter"&&u!=="RelativeDateOptions"&&u!=="RelativeDateFilter"&&u!=="DimensionFilters"&&u!=="MeasureFormat"&&u!=="Rename"&&i.text!==n.DashboardDesignerUtility.Serialization.enumToString(DateTimeFormat,r.DateTimeFormat)&&(r.IsShowAllRecords=!0,r.FilterInfo=null,e.IsSelected=!0,this.removeMenuSelection(r),this.widgetHelper.getCurrentWidgetInstance().clearFilter(),a=this.isDatebucketFieldInfo(e.Name.replace(/\s/g,"")),n.isNullOrUndefined(DateTimeFormat[u])||a||(r.DateTimeFormat=t.DateTimeFormat=DateTimeFormat[u]),a?f=!1:(b=i.text===this.dashboardDesigner.getLocalizationContent().dataconfiguration.summary.none?r.Name:u+"("+r.Name+")",r.IsDisplayNameEdited||(r.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(r),s.text(r.DisplayName)),s.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",b))):(t.ContainerName!=="Tooltip"||n.isNullOrUndefined(r.FilterInfo)||(r.FilterInfo=null),this.removeMenuSelection(r),e.IsSelected=!0,r.SummaryType=e.Name,w=this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(r.SummaryType)+"("+r.Name+")",r.IsDisplayNameEdited||(r.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(r),s.text(r.DisplayName)),s.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",w));k={update:!0,columnUpdate:!1,rowUpdate:!1,valueUpdate:!1};this.widgetHelper.getCurrentWidgetInstance().updateDataGroupInfo(c,k);f&&this.getDataConfigInstance().postDraggedFields()}},t.prototype.updateLabelText=function(n,t){this.removeMenuSelection(n);var i=this.dashboardDesigner.element.find("#"+this.id+"_"+n.Id+"_categoryListLabel_"+n.UniqueId);t.IsSelected=!0;n.IsDisplayNameEdited||(n.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(n),i.text(n.DisplayName));i.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",n.DisplayName)},t.prototype.updateFirstAndLastFilterInfo=function(t,i){for(var r,s,o,h,f=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,e,u=0;u<f.FieldContainers.length;u++)(f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.values||f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.measure||f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.value||f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.locationValue||f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.xAxis||f.FieldContainers[u].DisplayName===this.localizationContent.fieldContainer.actualValue)&&(e=f.FieldContainers[u].FieldInfos[0]);r=new DimensionFilterInfo;r.IsTopNFilteringApplied=!0;r.TopNFilterInfo=new TopNFilteringInfo;r.TopNFilterInfo.ColumnId=e.Id;r.TopNFilterInfo.ColumnName=e.Name;r.TopNFilterInfo.Mode=i?RankType.Top:RankType.Bottom;r.TopNFilterInfo.IsBasedOnDateAndTimeField=!1;r.TopNFilterInfo.NoOfRecords=1;s=this.widgetHelper.getCurrentWidgetInstance();o=s.getJson().FilterSettings;r.TopNFilterInfo.IsHierarchicalFilter=n.isNullOrUndefined(o)?!0:o.HierarchicalFilter;r.TopNFilterInfo.SummaryType=e.SummaryType;h=[r,t];t.DisplayName=t.Name;t.SummaryType=SummaryType.NONE;n.DashboardUtil.invokeMethod(this,"dimensionFilterAction",h)},t.prototype.enableFieldRenameOption=function(n,t){n.val(t.text());n.addClass("show-fieldInfo-textbox");t.addClass("hide-fieldInfo-label");n.focus()},t.prototype.removeMenuSelection=function(t){var r=this.bbdesigner$("#"+this.id+"_"+t.Id+"_categoryAggregateListUl_"+t.UniqueId).find(".e-summaryselectedfieldmenu"),i=r.parents("li.e-list").data("menuitem-info");n.isNullOrUndefined(i)||(i.IsSelected=!1)},t.prototype.createCustomSorting=function(){return new n.Dashboard.CustomSortForUI},t.prototype.sortClick=function(t,i){var r=JSON.parse(JSON.stringify(t)),f=this.dashboardDesigner.modules.sortDialog,u;n.isNullOrUndefined(r.CustomSorting)&&(r.CustomSorting=this.createCustomSorting(),r.CustomSorting.CustomSortType=r.ContainerName.toLowerCase()==="row"&&r.Sorting===SortingOrder.None?CustomSortType[CustomSortType.DataSource]:r.CustomSorting.CustomSortType);u=this.widgetHelper.getCurrentWidgetInstance();f.openSortDialog(this,"updateSortInfo",r,i,u.Type)},t.prototype.editRemoveCustomHierarchy=function(n){this.dashboardDesigner.modules.util.alertDialog(this.dashboardDesigner.getLocalizationContent().customHierarchy.titleText,this.dashboardDesigner.getLocalizationContent().customHierarchy.dialogContentText,IconType.question,AlertType.Confirm,!1,"",{height:140,width:500,method:"alertBoxtoRemoveHierarchy",dataInfo:{fieldInfo:n},instance:this.dataconfiguration})},t.prototype.editCreateHierarchyFilterClick=function(t,i,r){var h=0,s=0,v=this.dashboardDesigner.modules.dataSet.datasets,f,l,a,e,o;n.isNullOrUndefined(t.ParentId)||delete t.ParentId;f=JSON.parse(JSON.stringify(t));f.Name=f.Name+" Hierarchy";f.ChildHierarchicalFields=[];f.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t)));var u=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+t.ContainerName+"_categoryList"),y=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,p=y.selectedDatasetId,w=v.findIndex(function(n){return n.Id===p}),c=this.dataconfiguration.createLabelForHeirachialDroppedField(f,!0,y,!0);for(v[w].CustomHierarchyFields.push(f),l=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller"),a=c.find(".e-heirachy-field").data("fields"),e=0;e<i.length;e++)if(t.Id===i[e].Id){h=e+1;break}for(o=0;o<u[0].children.length;o++)this.dashboardDesigner._id+"_"+r.Id+"_categoryListDiv"===u[0].children[o].id&&(s=o+1);!n.isNullOrUndefined(u)&&u.length>0&&(s>-1&&u.children().length>0&&s<u.children().length?c.insertBefore(u.children().eq(s)):c.insertBefore(u.children().last()));this.dataconfiguration.setParentId(a);a.forEach(function(n){i.splice(h,0,n);h++});n.isNullOrUndefined(l)||l.refresh()},t.prototype.editAddToHierarchyFilterClick=function(t,i,r){var u,o,k,y,c;n.isNullOrUndefined(t.ChildHierarchicalFields)||delete t.ChildHierarchicalFields;var v=0,l=0,p=!1,e,s=this.dashboardDesigner.modules.dataSet.datasets,f=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+t.ContainerName+"_categoryList"),w=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,d=w.selectedDatasetId,h=s.findIndex(function(n){return n.Id===d}),a,b=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller");for(u=0;u<i.length;u++)i[u].Id===r.Id&&!n.isNullOrUndefined(i[u].HasChild)&&i[u].HasChild&&(e=JSON.parse(JSON.stringify(i[u])),n.isNullOrUndefined(e.ChildHierarchicalFields)||delete e.ChildHierarchicalFields,v=u),(i[u].Id!==r.Id||i[u].TreeNode!=="hierarchy")&&(n.isNullOrUndefined(i[u].ParentId)||i[u].ParentId!==r.Id)||(i.splice(u,1),u=u-1);if(o=s[h].CustomHierarchyFields.find(function(n){return n.Id===r.Id}),o=n.isNullOrUndefined(o)?r:o,e.ChildHierarchicalFields=[],o.ChildHierarchicalFields.forEach(function(n){e.ChildHierarchicalFields.push(n);n.Id===t.Id&&(p=!0)}),e.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),!p){for(n.isNullOrUndefined(s[h].CustomHierarchyFields[s[h].CustomHierarchyFields.indexOf(o)])||this.dashboardDesigner.modules.dataSet.datasets[h].CustomHierarchyFields[s[h].CustomHierarchyFields.indexOf(o)].ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),a=this.dataconfiguration.createLabelForHeirachialDroppedField(e,!0,w,!0),k=f.children().length,f.children().remove("#"+this.dashboardDesigner._id+"_Dimension_categoryList_treeview_"+r.Id),k===f.children().length&&f.children().remove("#"+this.dashboardDesigner._id+"_"+r.Id+"_categoryListParentDiv_"+r.UniqueId),y=a.find(".e-heirachy-field").data("fields"),c=0;c<f[0].children.length;c++)this.dashboardDesigner._id+"_"+r.Id+"_categoryListDiv"===f[0].children[c].id&&(l=c+1);!n.isNullOrUndefined(f)&&f.length>0&&(l>-1&&f.children().length>0&&l<f.children().length?a.insertBefore(f.children().eq(l)):a.insertBefore(f.children().last()));this.dataconfiguration.setParentId(y);y.forEach(function(n){i.splice(v,0,n);v++});n.isNullOrUndefined(b)||b.refresh()}},t.prototype.editDimensionFilterClick=function(t){var i=JSON.parse(JSON.stringify(t)),u=!n.isNullOrUndefined(i)&&!n.isNullOrUndefined(i.FilterInfo)?i.FilterInfo.DimensionFilterInfo:null,r=this.widgetHelper.getCurrentWidgetInstance();r.Type==="DatePicker"||r.Type==="PeriodOverPeriod"?this.dashboardDesigner.modules.rangeFilterDialog.openFilterDialog(this,"dimensionFilterAction",i,u):this.dashboardDesigner.modules.dimensionFilter.openDimensionFilterWindow(this,"dimensionFilterAction",i,u,r)},t.prototype.customDateDialog=function(t,i){var r=JSON.parse(JSON.stringify(t)),u=r.FilterInfo!=null&&!n.isNullOrUndefined(r.FilterInfo.CustomDateSettingsInfo)?r.FilterInfo.CustomDateSettingsInfo:new n.Dashboard.DatesettingInfoForUI,f=this.dashboardDesigner.modules.dateinfo;u.UniqueColumnName=r.UniqueColumnName;f.selectedFieldName=i;f.openDatesettingClick(this,"dateSettingsAction",r,u)},t.prototype.editMeasureFilterClick=function(t){var i=JSON.parse(JSON.stringify(t)),r=i.FilterInfo!=null&&!n.isNullOrUndefined(i.FilterInfo.MeasureFilterInfo)?i.FilterInfo.MeasureFilterInfo:new n.Dashboard.MeasureFilterInfoForUI;r.UniqueColumnName=i.UniqueColumnName;this.dashboardDesigner.modules.measureFilter.openMeasureFilter(this,"measureFilterAction",i,r,!1)},t.prototype.clearMeasureFilterClick=function(n){n.FilterInfo=null;n.IsShowAllRecords=!0},t.prototype.clearDimensionOrClearRelativeDateClick=function(t,i){t.FilterInfo.DimensionFilterInfo=null;n.isNullOrUndefined(t.FilterInfo.RelativeDateFilterInfo)||(t.FilterInfo.RelativeDateFilterInfo=null);t.IsShowAllRecords=!0;i.IsDisable=!0;this.widgetHelper.getCurrentWidgetInstance().clearFilter()},t.prototype.measureFormatClick=function(t){var i=this,r=n.isNullOrUndefined(t.MeasureFormatting)?new MeasureFormatting:JSON.parse(JSON.stringify(t.MeasureFormatting));this.dashboardDesigner.modules.formatDialog.openFormatDialog(r,this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.DataSourceName,function(n){t.MeasureFormatting=n;i.getDataConfigInstance().postDraggedFields()})},t.prototype.editRelativeDateClick=function(t,i){var r=JSON.parse(JSON.stringify(t)),u=null;n.isNullOrUndefined(r.FilterInfo)||n.isNullOrUndefined(r.FilterInfo.RelativeDateFilterInfo)?(u=new RelativeDateFilterInfo,u.ColumnId=r.Id,u.ColumnName=r.Name):u=r.FilterInfo.RelativeDateFilterInfo;u.UniqueColumnName=r.UniqueColumnName;this.dashboardDesigner.modules.relativeDateFilter.openRelativeDateFilter(this,"relativeDateFilterAction",u,r,i)},t.prototype.editRelativeDateOptionsClick=function(t){this.columnDetails=t;var i=!n.isNullOrUndefined(t.FilterInfo)&&!n.isNullOrUndefined(t.FilterInfo.RelativeDateOptions)?t.FilterInfo.RelativeDateOptions:[],r=this.bbdesigner$.extend([],!0,i);this.dashboardDesigner.modules.relativeDates.openRelativeDatesDialog(this,"relativeDateOptionsAction",r)},t.prototype.clearRelativeDateOptionsClick=function(t,i){var r,u;n.isNullOrUndefined(t.FilterInfo)||n.isNullOrUndefined(t.FilterInfo.RelativeDateOptions)||(t.FilterInfo.RelativeDateOptions=null,i.IsDisable=!0,r=this.widgetHelper.getCurrentWidgetInstance(),r.clearFilter(),(r.Type==="ComboBox"||r.Type==="ListBox")&&(u=this.dashboardDesigner.element.find("#"+this.id+"_"+t.Id+"_categoryListLabel_"+t.UniqueId),t.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(t),u.text(t.DisplayName),u.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",t.DisplayName)))},t.prototype.getCurrentFieldInfoByUniqueName=function(t,i){var r,f,u;if(!n.isNullOrUndefined(t))for(r=0;r<t.FieldContainers.length;r++)if(f=t.FieldContainers[r].FieldInfos,u=f.filter(function(n){return n.UniqueColumnName===i}),u.length>0)return u[0];return null},t.prototype.getCurrentDimensionFieldInfoById=function(t,i){if(!n.isNullOrUndefined(t)&&!n.isNullOrUndefined(i)){var r=t.filter(function(t){return t.Id===i&&n.isNullOrUndefined(t.ParentId)&&n.isNullOrUndefined(t.TreeNode)});if(r.length>0)return r[0]}return null},t.prototype.getDataConfigInstance=function(){return this.dashboardDesigner.modules.dataConfiguration},t.prototype.dimensionFilterAction=function(t,i){for(var u,r,e,o=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,f=0;f<o.FieldContainers.length;f++)for(u=o.FieldContainers[f].FieldInfos,r=0;r<u.length;r++)u[r].UniqueColumnName===i.UniqueColumnName&&(n.isNullOrUndefined(u[r].FilterInfo)?n.isNullOrUndefined(t)?u[r].FilterInfo=null:(e=new n.Dashboard.FilterInfoForUI,e.DimensionFilterInfo=t,u[r].FilterInfo=e):(u[r].FilterInfo.RelativeDateFilterInfo=null,u[r].FilterInfo.DimensionFilterInfo=t)),i.UniqueId===u[r].UniqueId&&(i.DateTimeFormat=u[r].DateTimeFormat);n.isNullOrUndefined(t)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1);this.getDataConfigInstance().postDraggedFields()},t.prototype.measureFilterAction=function(n){for(var u,i,f,e=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,r=new MeasureCondition,t=0;t<n.Values.length;t++)u=n.Values[t],r.Values.push(u);i={MeasureFilterInfo:{ColumnName:n.ColumnName,SummaryType:n.SummaryType,UniqueColumnName:n.UniqueColumnName,Conditions:n.Conditions,Values:r.Values}};f=this.getCurrentFieldInfoByUniqueName(e,n.UniqueColumnName);f.FilterInfo=i.MeasureFilterInfo.Values.length!==0?i:null;this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateOptionsAction=function(n){var u=this.widgetHelper.getCurrentWidgetInstance(),f=u.DataGroupInfo,e={RelativeDateOptions:n},r,i,t,o,s;if(f.FieldContainers.length>=1)for(r=0;r<f.FieldContainers.length;r++)for(i=f.FieldContainers[r].FieldInfos,t=0;t<i.length;t++)o=e.RelativeDateOptions.length===0?null:e.RelativeDateOptions.length>=1&&i[t].UniqueColumnName?e:i[t].FilterInfo,u.Type==="ComboBox"||u.Type==="ListBox"?this.columnDetails.UniqueColumnName===i[t].UniqueColumnName&&(i[t].FilterInfo=o,s=this.dashboardDesigner.element.find("#"+this.id+"_"+i[t].Id+"_categoryListLabel_"+i[t].UniqueId),i[t].DisplayName="Relative Dates("+i[t].Name+")",s.text(i[t].DisplayName),s.parents(".bbi-assigndata-dropped-field").attr("data-tooltip","Relative Dates("+i[t].Name+")")):i[t].FilterInfo=o;this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateFilterAction=function(t,i){var e=i,f=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,r,u;f.FieldContainers.length>=1&&(r=this.getCurrentFieldInfoByUniqueName(f,e.UniqueColumnName),n.isNullOrUndefined(r.FilterInfo)?(u=new n.Dashboard.FilterInfoForUI,u.RelativeDateFilterInfo=t,r.FilterInfo=u):(r.FilterInfo.DimensionFilterInfo=null,r.FilterInfo.RelativeDateFilterInfo=t));n.isNullOrUndefined(t)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1);this.getDataConfigInstance().postDraggedFields()},t.prototype.dateSettingsAction=function(n){var i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,t={CustomDateSettingsInfo:{Format:n.Format,CustomFormat:n.CustomFormat,FiscalYear:n.FiscalYear,UniqueColumnName:n.UniqueColumnName}},r=this.getCurrentFieldInfoByUniqueName(i,n.UniqueColumnName);r.FilterInfo=t.CustomDateSettingsInfo!=null?t:null;this.getDataConfigInstance().postDraggedFields()},t.prototype.updateSortInfo=function(t,i,r){var s,e,f,o,u,h,c;if(BoldBIDashboardDesigner.editManager.isPerformAction||(r.IsSelected=!0),s=this.dashboardDesigner.designerPanel,s.selectedReportItems.length>0)for(e=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,f=0;f<e.FieldContainers.length;f++)if(i.ContainerName===e.FieldContainers[f].Name)for(o=0;o<e.FieldContainers[f].FieldInfos.length;o++)u=e.FieldContainers[f].FieldInfos[o],n.isNullOrUndefined(u.UniqueId)&&(u.UniqueId="LabelData"+(o+1)),u.UniqueId===i.UniqueId&&(h=[u.CustomSorting,i,r],c=[t,i,r],BoldBIDashboardDesigner.editManager.addCmdAction(CommandAction.UpdateSort,"updateSortInfo","DataConfiguration","",h,c),u.CustomSorting=t,u.IsCustomSortApplied=i.IsCustomSortApplied);this.getDataConfigInstance().postDraggedFields()},t}();t.FieldMenuHandler=i})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n.call(this)||this;return t.ManualOrderList=[],t}return __extends(t,n),t}(Customsort);n.CustomSortForUI=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n.call(this)||this;return t.FieldInfos=[],t.canUseInLinking=!0,t.IsDrillSection=!1,t.RestrictLargeData=!1,t.Required=!1,t.ShowDescriptionIcon=!1,t.TooltipText="",t.isCustomHierarchy=!1,t.HasCustomDate=!1,t}return __extends(t,n),t}(FieldContainer);n.FieldContainerForUI=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n.call(this)||this;return t.IsLoading=!1,t.ApplyFilter=!1,t.IsShowAllRecords=!1,t.TableID="",t.TableName="",t.FilterInfo=null,t.ContainerName="",t.IsCustomSortApplied=!1,t.DateBucketInfo=null,t}return __extends(t,n),t}(HierarchicalFieldInfo);n.FieldInfoForUI=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={})),function(n){var t;(function(n){var t=function(){function n(){this.Name="";this.DisplayName="";this.IsDisable=!1;this.IsSelected=!1;this.IsVisible=!0;this.Items=[];this.EnableSeparator=!1}return n}();n.FieldMenu=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n.call(this)||this;return t.UniqueColumnName="",t}return __extends(t,n),t}(MeasureFilterInfo);n.MeasureFilterInfoForUI=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));__extends=this&&this.__extends||function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}if(typeof i!="function"&&i!==null)throw new TypeError("Class extends value "+String(i)+" is not a constructor or null");n(t,i);t.prototype=i===null?Object.create(i):(r.prototype=i.prototype,new r)}}(),function(n){var t;(function(n){var t=function(n){function t(){var t=n.call(this)||this;return t.UniqueColumnName="",t}return __extends(t,n),t}(DateSettingsInfo);n.DatesettingInfoForUI=t})(t=n.Dashboard||(n.Dashboard={}))}(BoldBIDashboard||(BoldBIDashboard={}));InternalColorPalette=function(){function n(n){this.callMethod="";this.colorCodes=[];this.isScroll=!1;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.id=this.dashboardDesigner._id;this.unwireEvents();this.wireEvents()}return n.prototype.openColorPalette=function(n,t,i,r,u,f){var e,o,h,s;this.callInstance=r;this.callMethod=u;BoldBIDashboard.isNullOrUndefined(n)?(this.bbdesigner$(this.container).empty(),this.bbdesigner$(this.rootContainer).css("display",BoldBIDashboard.isNullOrUndefined(i.isVisible)?f.length>0?"inline-block":"none":i.isVisible?"inline-block":"none")):(this.rootContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control e-color-palette-container bbi-dbrd-designer-scroll-style-3","",{display:BoldBIDashboard.isNullOrUndefined(i.isVisible)?f.length>0?"inline-block":"none":i.isVisible?"inline-block":"none"},{id:this.id+"_"+t+"_"+i.name+"_container"}),this.container=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_"+t+"_"+i.name+"_childContainer"}),n.css({"margin-bottom":"10px"}),this.rootContainer.append(this.container),n.append(this.rootContainer),this.rootContainer.BoldBIDashboardScroller({width:430,height:280,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}));this.colorCodes=f;e=280;BoldBIDashboard.isNullOrUndefined(this.container)||(this.renderColorPalettes(),o=5,this.colorCodes.length<o&&(h=5,e=e/o*this.colorCodes.length+h));BoldBIDashboard.isNullOrUndefined(this.rootContainer)||(s=this.rootContainer.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(s)||s.destroy(),this.colorCodes.length>10?this.rootContainer.BoldBIDashboardScroller({width:430,height:e,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,enableTouchScroll:!1,scroll:this.bbdesigner$.proxy(this.resetScroller,this)}):this.rootContainer.BoldBIDashboardScroller({width:430,height:e,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,enableTouchScroll:!1}))},n.prototype.resetScroller=function(n){var t=n.scrollTop,i,r;!BoldBIDashboard.isNullOrUndefined(t)&&t>0&&!this.isScroll&&(i=this.container.find(".e-scrollcontainer"),i.children().length<this.colorCodes.length&&i.height()-this.container.height()<=t&&(this.isScroll=!0,this.renderColorPalettes(),r=this.rootContainer.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(r)||r.refresh(),this.isScroll=!1))},n.prototype.renderColorPalettes=function(){var i,r=this.container.find(".e-scrollcontainer"),t,u,n;for(r.length===0?(i=BoldBIDashboard.buildTag("div.e-scrollcontainer","",{},{}),this.container.append(i)):i=r,t=r.children().length,u=t+10<this.colorCodes.length?10:this.colorCodes.length-t,n=t;n<t+u;n++)i.append(this.getSeriesPaletteTemplate(this.colorCodes[n],n)),this.updateColorPicker(this.colorCodes[n],n)},n.prototype.updateColorPicker=function(n,t){var i=this.container.find("#"+this.id+"_seriespalette__LabelValue"+t+"_colorpicker");i.BoldBIDashboardColorPicker({value:n.Value,cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",select:this.bbdesigner$.proxy(this.onValueChange,this,t),width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},n.prototype.getSeriesPaletteTemplate=function(n,t){return'<div style="width : 100%" id ="'+this.id+"_seriespalette__Container"+t+'"><div class="e-color-palette-row" id="'+this.id+"_seriespalette__Label"+t+'"><div class ="e-color-palette-label-wrap"><div class = "e-designer-fontfamily e-color-palette-label bbi-dbrd-designer-hoverable" data-tooltip ="'+n.Name+'">'+n.Name+'<\/div><\/div><div class = "e-color-palette-color-picker-wrap" id = "'+this.id+"_seriespalette__LabelValue"+t+'_parent"><input class="boldbi-dashboarddesigner e-color-palette-input" id ="'+this.id+"_seriespalette__LabelValue"+t+'_colorpicker" ><\/div><div class = "e-color-palette-color-textbox-wrap" id ="'+this.id+"_seriespalette__LabelValue"+t+'_value"><input class ="e-textbox bbi-designer-content-label e-color-picker-color-textbox" id ="'+this.id+"_seriespalette__LabelValue"+t+'" type ="text" data-rowIndex = "'+t+'" value ="'+n.Value+'"><\/div><\/div><\/div>'},n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("focusout",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textFocusOut,this));this.dashboardDesigner.element.on("keyup",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textKeyUp,this))},n.prototype.unwireEvents=function(){this.dashboardDesigner.element.off("focusout",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textFocusOut,this));this.dashboardDesigner.element.off("keyup",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textKeyUp,this))},n.prototype.onValueChange=function(n,t){var i=this.colorCodes[n].Value=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA),r;this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+n).val(i);r={rowIndex:n,textValue:i,isModified:this.colorCodes[n].IsModifed,id:this.colorCodes[n].Id};BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[r])},n.prototype.textKeyUp=function(n){n.keyCode===13&&this.textFocusOut(n)},n.prototype.textFocusOut=function(n){var t=Number(this.bbdesigner$(n.target).attr("data-rowIndex")),i=this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+t).val(),u=new RegExp("^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$"),r;u.test(i)?(this.colorCodes[t].Value=i,this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+t+"_colorpicker").data("BoldBIDashboardColorPicker").setModel({value:this.colorCodes[t].Value}),r={rowIndex:t,textValue:i,isModified:this.colorCodes[t].IsModifed,id:this.colorCodes[t].Id},BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[r])):this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+t).val(this.colorCodes[t].Value)},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorPalette",InternalColorPalette,window);InternalMeasureFilter=function(){function n(n){this.filterDialog=null;this.columnNameTag=null;this.measureFilterInfo=null;this.rightTextBoxDiv=null;this.measureItemTable=null;this.textDiv=null;this.targetMethod=null;this.targetInstance=null;this.applyButton=null;this.resetButton=null;this.columnName=null;this.uniqueColumnName=null;this.isKpiFilter=!1;this.errorMsgCell=null;this.dashboardDesigner=null;this.measureItemDropObj=null;this.aggItemDropObj=null;this.fieldSummary=SummaryType.NONE;this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id;this.renderMeasureFilterDialog();this.unWireEvents();this.wireEvents()}return n.prototype.renderMeasureFilterDialog=function(){var n=this.locale.measureFilterWindow,f,o,t,ot,st;this.filterDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_measure_filter"});var s=BoldBIDashboard.buildTag("div","",{}),h=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-measure-filter-table-item","",{width:"100%",padding:"5px 0px 10px"},{}),c=this.bbdesigner$("<tr><\/tr>"),l=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{width:"50px"},{}),ht=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",n.columnLabelText+":",{"font-size":"12px","font-weight":"600"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{},{}),ct=this.columnNameTag=BoldBIDashboard.buildTag("span.bbi-designer-fontfamily","",{"font-size":"12px"},{id:this.id+"_measure_filter_columnName"});a.append(ct);l.append(ht);c.append(l).append(a);h.append(c);var v=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{}),y=BoldBIDashboard.buildTag("tr","",{}),p=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{}),lt=BoldBIDashboard.buildTag("aggregateLabel.bbi-designer-fontfamily bbi-measure-filter-aggregation-label",n.selectedAggText,{},{type:"label"});p.append(lt);y.append(p);v.append(y);var w=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-measure-filter-table-item","",{},{}),b=BoldBIDashboard.buildTag("tr","",{}),k=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_aggregate_dropDown"});k.append(r);b.append(k);w.append(b);var d=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{}),u=BoldBIDashboard.buildTag("tr","",{}),g=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{}),at=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",n.rangeLabelText,{"font-size":"12px","font-weight":"600"},{type:"label"});g.append(at);u.append(g);f=this.errorMsgCell=BoldBIDashboard.buildTag("td","",{"padding-top":"10px"},{id:this.id+"_error_icon_td"});this.dashboardDesigner.modules.util.renderErrIndictor(f,this.id);u.append(f);d.append(u);var nt=this.measureItemTable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 15px"},{}),tt=this.bbdesigner$("<tr><\/tr>"),it=BoldBIDashboard.buildTag("td","",{},{}),e=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_rangedrop"});it.append(e);o=BoldBIDashboard.buildTag("td","",{"padding-left":"8px"},{});t=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_text1"});o.append(t);var rt=BoldBIDashboard.buildTag("td","",{width:"30px"},{}),ut=this.textDiv=BoldBIDashboard.buildTag("div","",{padding:"0px 5px",display:"none"}),vt=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",n.andLabelText,{"font-size":"12px"},{type:"label"}),ft=BoldBIDashboard.buildTag("td","",{width:"90px",height:"28px"},{}),et=this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{display:"none"},{id:this.id+"_measure_filter_rightbox_div"}),i=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_measure_filter_text2"});ft.append(et);et.append(i);ut.append(vt);rt.append(ut);ot=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",n.cancelBtnText,{float:"right"},{id:this.id+"_measure_filter_cancel",type:"button"});this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",n.applyBtnText,{float:"right"},{id:this.id+"_measure_filter_ok",type:"button"});this.resetButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small",n.resetBtnText,{"margin-left":"2px"},{id:this.id+"_measure_filter_reset",type:"button",disabled:"disabled"});tt.append(it,o,rt,ft);nt.append(tt);s.append(h,v,w,d,nt);this.filterDialog.append(s);this.dashboardDesigner.element.append(this.filterDialog);this.filterDialog.BoldBIDashboardDialog({title:n.measureFilterTitle,width:"auto",height:"auto",minWidth:240,minHeight:150,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});st=this.dashboardDesigner.element.find("#"+this.id+"_measure_filter_foot");st.append(this.resetButton,ot,this.applyButton);e.BoldBIDashboardDropDownList({width:"170px",height:"28px",dataSource:this.measureItemList(),fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,popupWidth:"170px",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeMeasureItem,this)});r.BoldBIDashboardDropDownList({width:"170px",height:"28px",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,popupWidth:"170px",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeAggregateItem,this)});t.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,width:"90px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-content-label",create:this.bbdesigner$.proxy(this.onTextBoxCreate,this,t),change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,t)});i.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,width:"90px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-content-label",create:this.bbdesigner$.proxy(this.onTextBoxCreate,this,i),change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,i)});this.measureItemDropObj=e.data("BoldBIDashboardDropDownList");this.aggItemDropObj=r.data("BoldBIDashboardDropDownList");BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},n.prototype.onTextBoxCreate=function(n){var t=this;n.keyup(this.bbdesigner$.proxy(function(n){t.changeTextBoxValue(t.bbdesigner$(n.target),t.bbdesigner$(n.target).val())},this))},n.prototype.changeTextBoxValue=function(n,t){var i=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0);this.betweenNotBetweenMeasureItemValidatation();(BoldBIDashboard.isNullOrUndefined(t)||this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()==="")&&BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);(i==="IsBetween"||i==="IsNotBetween")&&this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()===""&&BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);(BoldBIDashboard.isNullOrUndefined(t)||parseFloat(t)===0)&&n.data("ejNumericTextbox").setModel({value:0});BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},n.prototype.betweenNotBetweenMeasureItemValidatation=function(){var t=this.locale.measureFilterWindow,i=this.filterDialog.find("#"+this.id+"_measure_filter_text1").val(),r=this.filterDialog.find("#"+this.id+"_measure_filter_text2").val(),n=this.measureItemDropObj.getSelectedValue();(n==="IsBetween"||n==="IsNotBetween")&&parseFloat(r)<parseFloat(i)?(BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),this.showValidationMsg(this.id,!0,t.greaterOrEqualErrMsgText),this.errorMsgCell.css("display","block")):this.showValidationMsg(this.id,!1)},n.prototype.showValidationMsg=function(n,t,i){var r=this.filterDialog.find("#"+n+"_error_icon_td"),u=this.filterDialog.find("#"+this.id+"_measure_filter_rightbox_div");t?(BoldBIDashboard.DashboardUtil.showErrIndictor(r,!0,i),u.addClass("bbi-designer-error")):(BoldBIDashboard.DashboardUtil.showErrIndictor(r,!1),u.removeClass("bbi-designer-error"))},n.prototype.changeMeasureItem=function(n){var t=n.value,i=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0);this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()===""&&BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);(i==="IsBetween"||i==="IsNotBetween")&&this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()===""&&BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);t==="IsBetween"||t==="IsNotBetween"?this.enableTextElement(!0):this.enableTextElement(!1);BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},n.prototype.changeAggregateItem=function(){var n=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0);BoldBIDashboard.isNullOrUndefined(this.filterDialog)||this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()!==""||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);n!=="IsBetween"&&n!=="IsNotBetween"||BoldBIDashboard.isNullOrUndefined(this.filterDialog)||this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()!==""||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1);BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},n.prototype.enableTextElement=function(n){n?(this.textDiv.css("display","block"),this.rightTextBoxDiv.css("display","block"),this.betweenNotBetweenMeasureItemValidatation()):(this.textDiv.css("display","none"),this.rightTextBoxDiv.css("display","none"),this.errorMsgCell.css("display","none"))},n.prototype.disableFilterButton=function(n,t){t?n.css("opacity","0.5").attr("disabled","disabled"):n.css("opacity","1").removeAttr("disabled")},n.prototype.populateFilterInfo=function(n){var i=n.Conditions,r=n.Values,f=r.length,e=i===NumberFilterOption.IsBetween||i===NumberFilterOption.IsNotBetween,t,u;for(this.enableTextElement(e),t=0;t<f;t++)u=this.measureItemTable.find("#"+this.id+"_measure_filter_text"+(t+1)),u.data("ejNumericTextbox").setModel({value:r[t]})},n.prototype.updateFilterInfo=function(n){this.columnNameTag.text(this.columnName);var t=n.Conditions,i=n.SummaryType;this.aggItemDropObj.selectItemByValue(i);this.measureItemDropObj.selectItemByValue(t);this.populateFilterInfo(n);BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0);BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},n.prototype.resetMeasureFilterValues=function(){this.measureItemDropObj.selectItemsByIndices(0);this.aggItemDropObj.selectItemByValue(this.fieldSummary);this.enableTextElement(!1);var t=this.measureItemTable.find("#"+this.id+"_measure_filter_text1"),i=this.measureItemTable.find("#"+this.id+"_measure_filter_text2"),n=this.locale.measureFilterWindow;t.data("ejNumericTextbox").setModel({value:n.enterValueWatermarkText});i.data("ejNumericTextbox").setModel({value:n.enterValueWatermarkText});BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1);BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},n.prototype.getFilterValue=function(){var r=[],i=this.measureItemDropObj.getSelectedValue(),n=new BoldBIDashboard.Dashboard.MeasureFilterInfoForUI,o=this.resetButton.hasClass("e-disable")?"":i,u,f,t;for(n.Conditions=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFilterOption,o),u=this.resetButton.hasClass("e-disable")?"":this.aggItemDropObj.getSelectedValue().toString(),n.SummaryType=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,u),f=i==="IsBetween"||i==="IsNotBetween"?2:1,t=0;t<f;t++){var s=this.measureItemTable.find("#"+this.id+"_measure_filter_text"+(t+1)),e=s.data("ejNumericTextbox").getValue(),h=BoldBIDashboard.isNullOrUndefined(e)?0:e;r.push(h)}return n.Values=this.resetButton.hasClass("e-disable")?[]:r,n.UniqueColumnName=this.uniqueColumnName,n.ColumnName=this.columnName,n},n.prototype.applyFilterValues=function(){var n=this.getFilterValue();BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[n]),this.closeMeasureFilter())},n.prototype.openMeasureFilter=function(n,t,i,r,u){this.resetMeasureFilter();this.isKpiFilter=u;this.targetInstance=n;this.targetMethod=t;this.measureFilterInfo=r;this.columnName=i.Name;this.fieldSummary=i.SummaryType;this.uniqueColumnName=i.UniqueColumnName;var f=i.FieldActualType==="bbi-designer-dataset-number"?i.IsAggregatedExpression?[{value:SummaryType.CUSTOM,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.CUSTOM)}]:this.getMeasureFormatsList():this.getDimensionFormatsList();this.aggItemDropObj.setModel({dataSource:f});this.filterDialog.data("BoldBIDashboardDialog").open();!BoldBIDashboard.isNullOrUndefined(r)&&r.Values.length>0?this.updateFilterInfo(r):(BoldBIDashboard.isNullOrUndefined(this.columnName)||this.columnNameTag.text(this.columnName),this.resetMeasureFilterValues())},n.prototype.resetMeasureFilter=function(){this.columnNameTag.text("");this.measureFilterInfo=null;this.columnName=null;this.uniqueColumnName=null},n.prototype.closeMeasureFilter=function(){this.filterDialog.data("BoldBIDashboardDialog").close()},n.prototype.measureItemList=function(){return[{text:this.locale.dataconfiguration.numberFilterOption.equals,value:NumberFilterOption.Equals},{text:this.locale.dataconfiguration.numberFilterOption.notEquals,value:NumberFilterOption.NotEquals},{text:this.locale.dataconfiguration.numberFilterOption.lessThan,value:NumberFilterOption.LessThan},{text:this.locale.dataconfiguration.numberFilterOption.greaterThan,value:NumberFilterOption.GreaterThan},{text:this.locale.dataconfiguration.numberFilterOption.lessThanOrEquals,value:NumberFilterOption.LessThanOrEquals},{text:this.locale.dataconfiguration.numberFilterOption.greaterThanOrEquals,value:NumberFilterOption.GreaterThanOrEquals},{text:this.locale.dataconfiguration.numberFilterOption.between,value:NumberFilterOption.IsBetween},{text:this.locale.dataconfiguration.numberFilterOption.notBetween,value:NumberFilterOption.IsNotBetween},]},n.prototype.getMeasureFormatsList=function(){var n=[],t=this.dashboardDesigner.modules.util;return n.push({value:SummaryType.NONE,text:t.getSummaryTypeLocalizedText(SummaryType.NONE)}),n.push({value:SummaryType.SUM,text:t.getSummaryTypeLocalizedText(SummaryType.SUM)}),n.push({value:SummaryType.AVG,text:t.getSummaryTypeLocalizedText(SummaryType.AVG)}),n.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),n.push({value:SummaryType.MAX,text:t.getSummaryTypeLocalizedText(SummaryType.MAX)}),n.push({value:SummaryType.MIN,text:t.getSummaryTypeLocalizedText(SummaryType.MIN)}),n.push({value:SummaryType.MEDIAN,text:t.getSummaryTypeLocalizedText(SummaryType.MEDIAN)}),n.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),n.push({value:SummaryType.VAR,text:t.getSummaryTypeLocalizedText(SummaryType.VAR)}),n},n.prototype.getDimensionFormatsList=function(){var n=[],t=this.dashboardDesigner.modules.util;return n.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),n.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),n},n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_reset",this.bbdesigner$.proxy(this.resetMeasureFilterValues,this));this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_ok",this.bbdesigner$.proxy(this.applyFilterValues,this));this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_cancel",this.bbdesigner$.proxy(this.closeMeasureFilter,this))},n.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_reset",this.bbdesigner$.proxy(this.resetMeasureFilterValues,this));this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_ok",this.bbdesigner$.proxy(this.applyFilterValues,this));this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_cancel",this.bbdesigner$.proxy(this.closeMeasureFilter,this))},n.prototype.destroy=function(){this.unWireEvents();BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_measure_filter"));this.dashboardDesigner.element.find("#"+this.id+"_measure_filter").length>0&&this.dashboardDesigner.element.find("#"+this.id+"_measure_filter").remove()},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.MeasureFilter",InternalMeasureFilter,window);InternalTooltipCustomization=function(){function n(n){this.locale=null;this.scrollContainer=null;this.tooltipScrollElement=null;this.tootipDialog=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.propertyPanel=this.dashboardDesigner.modules.propertyPanel;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper}return n.prototype.onCustomizeButtonClick=function(n){this.renderTooltipDialog();this.tooltipScrollElement.empty();this.populateColumnValues(n)},n.prototype.updateTooltip=function(){for(var u,r,f,e,i=this.tooltipScrollElement.find(".e-tooltip-checkbox"),t=this.widgetHelper.getCurrentWidgetInstance(),s=t.getfieldInfosForTooltipCustomization(t),o=!1,n=0;n<i.length;n++)if(r=i.eq(n).data("BoldBIDashboardCheckBox"),!r.model.checked){o=!0;break}if(o){for(u=[],n=0;n<i.length;n++)r=i.eq(n).data("BoldBIDashboardCheckBox"),u.push({FieldId:s[n].UniqueColumnName,IsSelected:r.model.checked});f=new BasicTooltipSettings;f.TooltipFields=u;e=new TooltipCustomization;e.BasicTooltipSettings=f;t.widgetJson.TooltipCustomization=e}else t.widgetJson.TooltipCustomization=null;t.updateTooltipBasedOnCustomization();this.dashboardDesigner.modules.serialization.notifyChange();this.tootipDialog.data("BoldBIDashboardDialog").close()},n.prototype.updateTooltipCustomization=function(){var n=this.widgetHelper.getCurrentWidgetInstance(),i=n.getfieldInfosForTooltipCustomization(n),t;if(!BoldBIDashboard.isNullOrUndefined(n.widgetJson.TooltipCustomization))if(n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.length>i.length)n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields=n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.filter(function(n){return i.some(function(t){return t.UniqueColumnName===n.FieldId})});else for(t=0;t<i.length;t++)!BoldBIDashboard.isNullOrUndefined(n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t])&&n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t].FieldId===i[t].UniqueColumnName||n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.splice(t,0,{FieldId:i[t].UniqueColumnName,IsSelected:!0})},n.prototype.updateShowTooltip=function(n){var t=this.widgetHelper.getCurrentWidgetInstance(),i,r;t.updateShowTooltip(n,t);i=t.isCustomizeTooltipButtonEnable(t);r=this.bbdesigner$("#"+this.dashboardDesigner._id+"_"+t.Type+"_ToolTipSettings_CustomizeTooltip");this.enableOrDisableButton(r,i);this.dashboardDesigner.modules.serialization.notifyChange()},n.prototype.closeTooltipSettings=function(){this.tootipDialog.data("BoldBIDashboardDialog").close()},n.prototype.renderTooltipDialog=function(){var n,t,i,r;this.tootipDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog"});n=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_table"});this.renderHeaderElement(n);this.scrollContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"262px",display:"block"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_individual_container"});this.tooltipScrollElement=BoldBIDashboard.buildTag("div","",{height:"252px","padding-top":"5px","padding-bottom":"5px"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_individual_elements"});t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogCancelBtnText,{float:"right"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_cancel",type:"button"});i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogOkBtnText,{float:"right"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_ok",type:"button"});this.scrollContainer.append(this.tooltipScrollElement);n.append(this.scrollContainer);this.tootipDialog.append(n);this.dashboardDesigner.element.append(this.tootipDialog);this.tootipDialog.BoldBIDashboardDialog({title:this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogTitleText,width:320,height:"auto",minWidth:320,minHeight:320,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});r=this.bbdesigner$("#"+this.dashboardDesigner._id+"_tooltipSettings_dialog_foot");r.append(t,i);i.off("click",this.bbdesigner$.proxy(this.updateTooltip,this));t.off("click",this.bbdesigner$.proxy(this.closeTooltipSettings,this));i.on("click",this.bbdesigner$.proxy(this.updateTooltip,this));t.on("click",this.bbdesigner$.proxy(this.closeTooltipSettings,this));this.scrollContainer.BoldBIDashboardScroller({height:"262px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},n.prototype.renderHeaderElement=function(n){var t=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%"},{id:this.dashboardDesigner._id+"_tooltipSettings_table_title"}),i=BoldBIDashboard.buildTag("th.boldbi-dashboarddesigner-tooltip-namecolumn-title bbi-designer-fontfamily",this.locale.propertyPanel.tooltipSettings.columnNameHeaderText,{width:"60%","font-size":"12px","font-weight":"600","text-align":"left",padding:"12px"},{}),r=BoldBIDashboard.buildTag("th.boldbi-dashboarddesigner-tooltip-visibility-title bbi-designer-fontfamily",this.locale.propertyPanel.tooltipSettings.visibilityHeaderText,{width:"40%","font-size":"12px","font-weight":"600","text-align":"center",padding:"12px"},{});t.append(i);t.append(r);n.append(t)},n.prototype.populateColumnValues=function(n){var r=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),i=n.getfieldInfosForTooltipCustomization(n),t;if(BoldBIDashboard.isNullOrUndefined(n.widgetJson.TooltipCustomization))for(t=0;t<i.length;t++)this.renderRowElement(r,i[t].DisplayName,t,!0);else for(t=0;t<i.length;t++)BoldBIDashboard.isNullOrUndefined(n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t])||n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t].FieldId!==i[t].UniqueColumnName||this.renderRowElement(r,i[t].DisplayName,t,n.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t].IsSelected);this.tooltipScrollElement.append(r);this.tootipDialog.data("BoldBIDashboardDialog").open();this.scrollerRefresh(this.scrollContainer)},n.prototype.scrollerRefresh=function(n){n.data("BoldBIDashboardScroller")&&n.data("BoldBIDashboardScroller").refresh()},n.prototype.renderRowElement=function(n,t,i,r){var u=BoldBIDashboard.buildTag("tr","",{width:"100%",height:"50px"},{id:this.dashboardDesigner._id+"_tooltip_column"+i}),o=BoldBIDashboard.buildTag("td.boldbi-dashboarddesigner-tooltip-column-value bbi-designer-fontfamily",t,{width:"60%","font-size":"12px","text-align":"left","padding-left":"12px"},{}),f,e;u.append(o);f=BoldBIDashboard.buildTag("td.boldbi-dashboarddesigner-tooltip-visibility-checkbox bbi-designer-fontfamily","",{width:"40%","font-size":"12px","text-align":"center"},{});e=BoldBIDashboard.buildTag("input.e-tooltip-checkbox","",{},{id:this.dashboardDesigner._id+"_tooltip_visibility"+i});f.append(e);u.append(f);n.append(u);e.BoldBIDashboardCheckBox({checked:r,showRoundedCorner:!0,enabled:!0})},n.prototype.renderTooltipSettings=function(n,t,i){var r=i.designerInstance._id+"_"+t,u=i.designerInstance.element.find("#"+r),c,a,e,o,f,s;if(u.length!==0||BoldBIDashboard.isNullOrUndefined(n)){if(!BoldBIDashboard.isNullOrUndefined(u)&&u.length>0){e=u.find("#"+r+"_ShowTooltip");o=i.getShowTooltip(i);e.BoldBIDashboardCheckBox({checked:o,change:this.bbdesigner$.proxy(this.updateShowTooltip,this),width:(this.propertyPanel.propertyPanelContainer.width()-33)*57/100-15+"px",cssClass:"e-designer-prop-checkbox"});f=u.find("#"+r+"_CustomizeTooltip");f.off("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i));f.on("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i));s=i.isCustomizeTooltipButtonEnable(i);this.enableOrDisableButton(f,s)}}else{u=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-designer-scroll-style-3","",{width:"460px"},{id:r});var h=BoldBIDashboard.buildTag("div","",{"margin-bottom":"15px",display:"inline-block"},{id:r+"_ShowTooltip_container"}),v=BoldBIDashboard.buildTag("div","",{width:(this.propertyPanel.propertyPanelContainer.width()-33)*47/100+"px",float:"left","margin-left":"3px","margin-top":"8.5px"}),y=BoldBIDashboard.buildTag("label.bbi-designer-fontfamily","",{"max-width":(this.propertyPanel.propertyPanelContainer.width()-33)*47/100-15+"px","font-size":"12px",overflow:"hidden",float:"right","margin-right":"11px","white-space":"nowrap","text-overflow":"ellipsis"},{id:r+"_ShowTooltip_childElement","for":r});y.text(this.locale.propertyPanel.tooltipSettings.showTooltip);v.append(y);h.append(v);c=BoldBIDashboard.buildTag("div","",{width:(this.propertyPanel.propertyPanelContainer.width()-33)*57/100+"px",display:"inline-block","margin-top":"4px",border:"0px solid","border-color":"red"},{id:r+"_ShowTooltip_parent"});e=BoldBIDashboard.buildTag("input","",{},{id:r+"_ShowTooltip",type:"checkbox"});c.append(e);o=i.getShowTooltip(i);e.BoldBIDashboardCheckBox({checked:o,change:this.bbdesigner$.proxy(this.updateShowTooltip,this),width:(this.propertyPanel.propertyPanelContainer.width()-33)*57/100-15+"px",cssClass:"e-designer-prop-checkbox"});h.append(c);u.append(h);var l=BoldBIDashboard.buildTag("div","",{"margin-bottom":"15px",display:"inline-block"},{id:r+"_CustomizeTooltip_container"}),p=BoldBIDashboard.buildTag("div","",{width:(this.propertyPanel.propertyPanelContainer.width()-33)*47/100+"px",float:"left","margin-left":"3px","margin-top":"8.5px"}),w=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"11px","white-space":"nowrap","text-overflow":"ellipsis"});w.text(this.locale.propertyPanel.tooltipSettings.customizeTooltip);p.append(w);l.append(p);a=BoldBIDashboard.buildTag("div","",{width:(this.propertyPanel.propertyPanelContainer.width()-33)*47/100+"px",display:"inline-block","margin-top":"3px",border:"0px solid","border-color":"red"},{id:r+"_CustomizeTooltip_parent"});f=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.propertyPanel.tooltipSettings.customizeTooltipBtnText,{width:"160px"},{id:r+"_CustomizeTooltip",type:"button"});a.append(f);f.off("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i));f.on("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i));l.append(a);u.append(l);s=i.isCustomizeTooltipButtonEnable(i);this.enableOrDisableButton(f,s);n.append(u)}},n.prototype.enableOrDisableButton=function(n,t){t?n.removeAttr("disabled"):n.attr("disabled","disabled")},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.TooltipCustomization",InternalTooltipCustomization,window);InternalReportAction=function(){function n(n){this.isLinkEnable=!1;this.selectedFormat="";this.categoryId="";this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.propertyPanel=this.dashboardDesigner.modules.propertyPanel;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper}return n.prototype.renderAction=function(n,t,i){var o,e,a;this.categoryId=this.dashboardDesigner._id+"_"+t+"_"+i.category;var r=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),u=i.value,f=this.dashboardDesigner.element.find("#"+this.categoryId);if(f.length===0&&n){f=BoldBIDashboard.buildTag("div","",{width:r-10,display:BoldBIDashboard.isNullOrUndefined(i.isVisible)?"block":i.isVisible?"block":"none"},{id:this.categoryId});var s=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),v=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),y=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),p=BoldBIDashboard.buildTag("td","",{},{}),ki=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.enableLinkText,{},{id:this.categoryId+"_link_text_ckb"}),w=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_link_ckb",type:"checkbox"}),b=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),k=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),d=BoldBIDashboard.buildTag("td","",{},{}),di=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.escapeSpecialChartext,{},{id:this.categoryId+"_link_specialChar_text_ckb"}),g=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_link_specialChar_ckb",type:"checkbox"}),nt=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),tt=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),it=BoldBIDashboard.buildTag("td","",{},{}),gi=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.enableEncryptParameter,{},{id:this.categoryId+"_encryption_parameter_txt"}),rt=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_encryption_parameter_ckb",type:"checkbox"}),ut=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_config"}),h=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-designer-linking-config-table","",{width:"100%",margin:"8px 0px"},{});BoldBIDashboard.browserInfo().name==="chrome"&&h.addClass("e-browser-chrome");var ft=BoldBIDashboard.buildTag("tr","",{height:"28px",display:"none"},{id:this.categoryId+"_link_radioOptions"}),et=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),nr=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),ot=BoldBIDashboard.buildTag("td","",{width:"80px"},{}),st=BoldBIDashboard.buildTag("td","",{},{}),tr={callBackInstance:this,callBackMethod:"checkedLinkConfig",groupName:"link",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.categoryId+"_radio_Row",label:this.locale.propertyPanel.linking.rowText,isChecked:!0,value:"row"}]},ir={callBackInstance:this,callBackMethod:"checkedLinkConfig",groupName:"link",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.categoryId+"_radio_Column",label:this.locale.propertyPanel.linking.columnText,value:"column"}]};this.selectRadioButtonRow=new BoldBIDashboard.Dashboard.RadioButton(tr,ot);this.selectRadioButtonColumn=new BoldBIDashboard.Dashboard.RadioButton(ir,st);var ht=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_selectField"}),ct=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),lt=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),at=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),vt=BoldBIDashboard.buildTag("td","",{},{}),rr=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.chooseField,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),yt=BoldBIDashboard.buildTag("input.e-textbox","",{height:"28px",width:(r-33)*57/100-30+"px","margin-left":"2px"},{id:this.categoryId+"_link_selectField_txt",type:"text"}),pt=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_columnURL"}),wt=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),bt=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),kt=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),dt=BoldBIDashboard.buildTag("td","",{},{}),ur=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),gt=BoldBIDashboard.buildTag("textarea.e-dbrd-column-urltxt e-textbox ","",{height:"125px",width:(r-33)*57/100-35+"px","margin-left":"2px",resize:"none","padding-bottom":"0px","padding-top":"0px"},{id:this.categoryId+"_link_columnURL_txt",type:"text",autocorrect:"off",spellcheck:"false"}),ni=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_url"}),ti=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),ii=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),ri=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),ui=BoldBIDashboard.buildTag("td","",{display:"inline-flex"},{}),fr=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),c=BoldBIDashboard.buildTag("textarea.e-textbox","",{height:"125px",width:(r-33)*57/100-35+"px","margin-left":"2px",resize:"none","padding-bottom":"0px","padding-top":"0px"},{id:this.categoryId+"_link_url_txt",type:"text",autocorrect:"off",spellcheck:"false"}),fi=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_appendColumn"}),ei=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),oi=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),si=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),hi=BoldBIDashboard.buildTag("td","",{},{}),er=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.appendColumn,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),ci=BoldBIDashboard.buildTag("div","",{"padding-left":"2px"},{}),li=BoldBIDashboard.buildTag("ul","",{},{id:this.categoryId+"_link_appendColumn_list"});ci.append(li);var ai=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_urlPreview"}),vi=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),yi=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),pi=BoldBIDashboard.buildTag("td","",{width:(r-47)*47/100+"px"},{}),wi=BoldBIDashboard.buildTag("td","",{},{}),or=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlPreview,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),bi=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","margin-right":"5px","white-space":"nowrap",width:(r-33)*57/100-30+"px","text-overflow":"ellipsis"}),l=BoldBIDashboard.buildTag("a","",{height:"28px","margin-left":"2px","font-size":"13px"},{id:this.categoryId+"_link_urlPreview_txt",href:""});pi.append(or);bi.append(l);wi.append(bi);yi.append(pi).append(wi);vi.append(yi);ai.append(vi);si.append(er);hi.append(ci);oi.append(si).append(hi);ei.append(oi);fi.append(ei);ri.append(fr);ui.append(c,this.getEncryptIcon(this.locale.propertyPanel.linking.urlLinkInfo));ii.append(ri).append(ui);ti.append(ii);ni.append(ti);at.append(rr);vt.append(yt);lt.append(at).append(vt);ct.append(lt);ht.append(ct);kt.append(ur);dt.append(gt);bt.append(kt).append(dt);wt.append(bt);pt.append(wt);et.append(nr);ft.append(et).append(ot).append(st);h.append(ft);ut.append(h);y.append(ki);p.append(w);v.append(y).append(p);s.append(v);k.append(di);d.append(g,this.getInfoIcon());b.append(k).append(d);s.append(b);tt.append(gi);it.append(rt,this.getEncryptIcon(this.locale.propertyPanel.linking.enableEncryptCharTooltipInfo));nt.append(tt).append(it);s.append(nt);f.append(s);f.append(ut);f.append(ht);f.append(pt);f.append(ni);f.append(fi);f.append(ai);this.renderCustomLinkDestination(f);n.append(f);l.text("");yt.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"Name",value:"Value"},showRoundedCorner:!0,width:(r-33)*57/100-10+"px",cssClass:"bbi-dbrd-control",select:this.bbdesigner$.proxy(this.changeColumn,this)});li.BoldBIDashboardListBox({dataSource:[],fields:{text:"Name",value:"Value"},showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-list-selection bbi-dbrd-designer-scroller bbi-dbrd-control",width:(r-33)*57/100-20+"px",height:"125px",select:this.bbdesigner$.proxy(this.selectURL,this)});w.BoldBIDashboardCheckBox({width:(r-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.changedLink,this),cssClass:"e-designer-prop-checkbox"});g.BoldBIDashboardCheckBox({width:(r-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.escapeSpecialCharacterChangeEvent,this),htmlAttributes:{style:"float:left"},cssClass:"e-designer-prop-checkbox"});rt.BoldBIDashboardCheckBox({width:(r-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.enableParameterEncryptionChangeEvent,this),htmlAttributes:{style:"float:left"},cssClass:"e-designer-prop-checkbox"});c.bind("blur",this.bbdesigner$.proxy(this.urlFocusOut,this));c.bind("keyup",this.bbdesigner$.proxy(this.urlKeyUp,this));gt.bind("blur",this.bbdesigner$.proxy(this.columnUrlFocusOut,this));l.bind("click",this.bbdesigner$.proxy(this.urlPreviewClick,this))}if(f.length>0){if(this.updateCustomLinkDestination(i),this.dashboardDesigner.element.find("#"+this.categoryId).css("display",BoldBIDashboard.isNullOrUndefined(i.isVisible)?"block":i.isVisible?"block":"none"),o=void 0,this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none"),BoldBIDashboard.isNullOrUndefined(i.isDisable)?this.isLinkEnable=!0:this.enableLink(!i.isDisable),BoldBIDashboard.isNullOrUndefined(u))this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("checked",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(""),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt")[0].innerText!==""&&this.updateURLText(""),this.enableLinkConfig(!1),this.linkItem=this.populateLinkModel(i),this.changeLinkConfig(!1,!0);else{if(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:u.EnableLink}),u.EnableLink||this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),u.EscapeSpecialCharacter&&this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").setModel({checked:u.EscapeSpecialCharacter}),u.EnableParameterEncryption&&this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").setModel({checked:u.EnableParameterEncryption}),this.enableLinkConfig(i.isDisable?!1:u.EnableLink),this.linkItem=i,u.GridUrlType===UrlLinkType[UrlLinkType.Column]){for(this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("checked",!0),u.ColumnUrlDetails=this.updateColumnDetails(u.ColumnUrlDetails),e=0;e<u.ColumnUrlDetails.length;e++)if(!BoldBIDashboard.isNullOrUndefined(u.ColumnUrlDetails[e].UrlLink)&&u.ColumnUrlDetails[e].UrlLink!==""){a=u.ColumnUrlDetails[e].UrlLink;this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val(a);this.updateURLText(a);o=u.ColumnUrlDetails[e].CaptionName;break}}else this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.updateUrlRowDetails(),this.populateLink(this.linkItem.value.UrlPath);this.changeLinkConfig(!1,!1)}this.populateList();this.populateDropDown();BoldBIDashboard.isNullOrUndefined(u)||u.GridUrlType!==UrlLinkType[UrlLinkType.Column]||BoldBIDashboard.isNullOrUndefined(o)||o===""||this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList").selectItemByValue(o)}},n.prototype.getInfoIcon=function(){return this.dashboardDesigner.isHelpLinkHidden()?"":"<div class ='bbi-dbrd-link-specialChar-help-info-icon'><a href='"+this.dashboardDesigner.getHelpDocLink("UrlParameter")+"'  target='_blank' class ='bbi-dbrd-link-specialChar-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip =\""+this.locale.propertyPanel.linking.escapeSpecialCharTooltipInfo+'"><\/a><\/div>'},n.prototype.getEncryptIcon=function(n){return this.dashboardDesigner.isHelpLinkHidden()?"":"<div class ='bbi-dbrd-link-specialChar-help-info-icon'><a class ='bbi-dbrd-link-specialChar-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip =\""+n+'"><\/a><\/div>'},n.prototype.renderCustomLinkDestination=function(n){var t=this.bbdesigner$("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),r=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_config_1"}),g=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-designer-linking-config-table","",{width:"100%",margin:"8px 0px"},{}),c;r.append(g);n.append(r);var u=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_selectField_1"}),f=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),e=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),o=BoldBIDashboard.buildTag("td","",{width:(t-47)*47/100+"px"},{}),s=BoldBIDashboard.buildTag("td","",{},{}),nt=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.targetText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),h=BoldBIDashboard.buildTag("input.e-textbox","",{height:"28px",width:(t-33)*57/100-30+"px","margin-left":"2px"},{id:this.categoryId+"_link_selectField_txt_1",type:"text"});o.append(nt);s.append(h);e.append(o).append(s);f.append(e);u.append(f);n.append(u);c=[{Name:this.locale.propertyPanel.linking.targetField.newTabText,Value:"_blank"},{Name:this.locale.propertyPanel.linking.targetField.samePageText,Value:"_top"},{Name:this.locale.propertyPanel.linking.targetField.currentFrameText,Value:"_self"},{Name:this.locale.propertyPanel.linking.targetField.parentFrameText,Value:"_parent"},{Name:this.locale.propertyPanel.linking.targetField.popUpText,Value:"_popup"},{Name:this.locale.propertyPanel.linking.targetField.newWindowText,Value:"_newwindow"}];h.BoldBIDashboardDropDownList({dataSource:c,fields:{text:"Name",value:"Value"},showRoundedCorner:!0,width:(t-33)*57/100-10+"px",cssClass:"bbi-dbrd-control",selectedIndex:0,select:this.bbdesigner$.proxy(this.updateLinkDestinationInfo,this)});this.renderPopUpTitle(n);var i=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_windowSize"}),l=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),a=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),v=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),y=BoldBIDashboard.buildTag("td","",{width:(t-47)*47/100+"px"},{}),p=BoldBIDashboard.buildTag("td","",{},{}),w=BoldBIDashboard.buildTag("td","",{width:(t-47)*47/100+"px"},{}),b=BoldBIDashboard.buildTag("td","",{},{}),k=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_window_size_numeric"}),tt=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.height,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),d=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_window_size_numeric1"}),it=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Width",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"});y.append(tt);p.append(k);w.append(it);b.append(d);a.append(y).append(p);v.append(w).append(b);l.append(a,v);i.append(l);n.append(i);k.ejNumericTextbox({value:500,minValue:100,width:"100px",height:"24px",showRoundedCorner:!0,change:this.bbdesigner$.proxy(this.updateHeightWidth,this)});d.ejNumericTextbox({value:500,minValue:100,width:"100px",height:"24px",showRoundedCorner:!0,change:this.bbdesigner$.proxy(this.updateHeightWidth,this)});i.css("display","none")},n.prototype.renderPopUpTitle=function(n){var i=this.bbdesigner$("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),t=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_panel_title"}),r=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),u=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),f=BoldBIDashboard.buildTag("td","",{width:(i-47)*47/100+"px"},{}),e=BoldBIDashboard.buildTag("td","",{},{}),s=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Title",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),o=BoldBIDashboard.buildTag("input.e-dbrd-column-urltxt e-textbox ","",{width:(i-33)*57/100-30+"px",height:"28px","margin-left":"2px"},{id:this.categoryId+"_link_panel_title_txt",type:"text",autocorrect:"off",spellcheck:"false"});t.css("display","none");f.append(s);e.append(o);u.append(f).append(e);r.append(u);t.append(r);n.append(t);o.bind("blur",this.bbdesigner$.proxy(this.updateTitle,this))},n.prototype.updateAdvance=function(n){n.isInteraction&&(n.value==="_popup"?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val("")):n.value==="_newwindow"&&(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").option("value",500),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").option("value",500)),this.updateLinkDestination(!0,n.value,n))},n.prototype.updateHeightWidth=function(n){if(n.isInteraction){var t=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").getSelectedValue();this.updateLinkDestination(!0,t)}},n.prototype.updateTitle=function(){var n=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").getSelectedValue();this.updateLinkDestination(!0,n)},n.prototype.updateLinkDestinationInfo=function(n){n.isInteraction&&(n.value==="_popup"||n.value==="_newwindow"?this.updateAdvance(n):this.updateLinkDestination(!1,n.value))},n.prototype.updateCustomLinkDestination=function(n){if(n.value.EnableLink){var t=n.value.TargetTypeInfo;switch(t){case"_popup":this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","block");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val(n.value.Title);break;case"_newwindow":this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","block");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none");this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").option("value",n.value.Height);this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").option("value",n.value.Width);break;default:this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("display","block");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_popDiv").css("display","none");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none");this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none")}this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").selectItemByValue(n.value.TargetTypeInfo)}else this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_popDiv").css("display","none")},n.prototype.getLinkItemVisibility=function(n){return!BoldBIDashboard.isNullOrUndefined(this.linkItem.visibility)&&!(this.linkItem.visibility&n)?!1:!0},n.prototype.updateLinkEnable=function(n){this.enableLink(n);this.changeLinkConfig(!1,!1);this.enableLinkConfig(n?this.linkItem.value.EnableLink:!1)},n.prototype.enableLink=function(n){n?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_text_ckb").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").enable(),this.isLinkEnable=!0):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_text_ckb").attr("disabled","true").css("opacity",".3"),this.isLinkEnable=!1)},n.prototype.updateUrlRowDetails=function(){for(var r,i,t=this.linkItem.value.PassingParameters,u=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0),n=0;n<t.length;n++){for(r=!1,i=0;i<u.length;i++)if(t[n]===u[i].Value){r=!0;break}r||this.linkItem.value.UrlPath.includes("@{{:"+t[n]+"}}")||(this.linkItem.value.UrlPath=this.linkItem.value.UrlPath.replaceAll("{{:"+t[n]+"}}",""),t.splice(n,1),this.updateLinksInWidgetJson())}},n.prototype.updateColumnDetails=function(n){for(var u,i,r=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0),t=0;t<n.length;t++){for(u=!0,i=0;i<r.length;i++)if(n[t].CaptionName===r[i].FieldName){n[t].UniqueColumnName=r[i].Id;u=!1;break}u&&(n.splice(t,1),this.updateLinksInWidgetJson())}return n},n.prototype.updateLinksInWidgetJson=function(){var n=JSON.parse(JSON.stringify(this.linkItem));this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,n.value,this.linkItem,this.linkItem.categoryName)},n.prototype.isDuplicate=function(n,t){for(var i=0;i<n.length;i++)if(n[i].Name===t)return!0;return!1},n.prototype.populateLinkModel=function(n){return n.value=this.createDashboardLinks(),n},n.prototype.validateColumnDetails=function(n){for(var t=0;t<this.linkItem.value.ColumnUrlDetails.length;t++)if(this.linkItem.value.ColumnUrlDetails[t].UniqueColumnName===n)return!1;return!0},n.prototype.populateDropDown=function(){var r,n,t,i;if(this.columnData=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1),r=this.isLinkEnable?"block":"none",this.columnData.length>0?this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display",BoldBIDashboard.isNullOrUndefined(this.linkItem.enableMode)?r:this.linkItem.enableMode===LinkEnableMode.Both?r:"none"):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none"),this.linkItem.value.GridUrlType===UrlLinkType[UrlLinkType.Column]&&(this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.changeLinkConfig(!0,!0),this.populateLink(this.linkItem.value.ReportUrlPath)),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none")),BoldBIDashboard.isNullOrUndefined(this.linkItem)||this.linkItem.value.ColumnUrlDetails.length!==this.columnData.length)for(n=0;n<this.columnData.length;n++)this.validateColumnDetails(this.columnData[n].Id)&&(t=this.createGridColumnUrlDetails(),t.CaptionName=this.columnData[n].FieldName,t.UniqueColumnName=this.columnData[n].Id,this.linkItem.value.ColumnUrlDetails.push(t));i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(i)||(i.option("dataSource",this.columnData),i.option("selectedIndex",0))},n.prototype.populateList=function(){this.rowData=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0);this.rowData=this.rowData.filter(function(n){return BoldBIDashboard.isNullOrUndefined(n.CanUseInLinking)||n.CanUseInLinking});var n=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list"),t=n.data("BoldBIDashboardListBox");BoldBIDashboard.isNullOrUndefined(t)||(t.option("dataSource",this.rowData),n.find("li").unbind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.changeURL,this)),n.find("li").bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.changeURL,this)),n.BoldBIDashboardListBox("instance")._refreshScroller())},n.prototype.populateLink=function(n){this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(n);this.updateURLText(n);this.linkItem.value.UrlPath=n},n.prototype.checkedLinkConfig=function(n){n.args.event.type==="change"&&(this.changeLinkConfig(!0,!0),this.refreshWidget())},n.prototype.appendClick=function(){var n=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt"),t,i=n.val(),r=this.selectedFormat,u;n[0].selectionStart===0&&(t=n.val().length,n[0].setSelectionRange(t,t));u=n[0].selectionStart;n.val(i.substring(0,n[0].selectionStart)+r+i.substring(n[0].selectionStart));n[0].selectionStart=n[0].selectionEnd=u+r.length;n[0].focus();this.updateColumnUrl(!0)},n.prototype.getFieldName=function(n){for(var i,t=0;t<this.columnData.length;t++)if(this.columnData[t].Value===n){i=this.columnData[t].FieldName;break}return i},n.prototype.refreshWidget=function(){var n=this.widgetHelper.getCurrentWidgetInstance();BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(n)||n.refresh()},n.prototype.changeColumn=function(n){var t=n.value,r=this.getFieldName(t),i;this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_Button").addClass("bbi-dbrd-designer-hoverable").attr("data-tooltip",this.locale.dashboardLink.columnURLTooltipPrefix+" "+r+" "+this.locale.dashboardLink.columnURLTooltipSuffix);i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt");i.val(this.getLastColumnUrl(t))},n.prototype.selectURL=function(n){this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").BoldBIDashboardListBox("instance")._refreshScroller();!BoldBIDashboard.isNullOrUndefined(n)&&n.value.length>0&&(this.selectedFormat="{{:"+n.value+"}}")},n.prototype.changeURL=function(n){var r;if(!this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked")){this.appendClick(n);return}if(!BoldBIDashboard.isNullOrUndefined(this.selectedFormat)&&this.selectedFormat.length>0){var t=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt"),i=void 0,u=t.val();BoldBIDashboard.isNullOrUndefined(this.selectedFormat)||(r=this.selectedFormat.replace("{{:","").replace("}}",""),this.linkItem.value.PassingParameters.indexOf(r)===-1&&this.linkItem.value.PassingParameters.push(r));t[0].selectionStart===0&&(i=t.val().length,t[0].setSelectionRange(i,i));t.val(u.substring(0,t[0].selectionStart)+this.selectedFormat+u.substring(t[0].selectionStart));this.updateURLText(t.val());this.updateUrl(!1);this.selectedFormat=""}},n.prototype.updatePassingParameters=function(n,t){n.PassingParameters=[];for(var i=0;i<this.linkItem.value.PassingParameters.length;i++)t.indexOf(this.linkItem.value.PassingParameters[i])!==-1&&n.PassingParameters.push(this.linkItem.value.PassingParameters[i]);return n},n.prototype.updateActionDetails=function(n,t){var i=JSON.parse(JSON.stringify(this.linkItem)),r;if(i.value.GridUrlType=n,n===UrlLinkType[UrlLinkType.Row]){for(r=0;r<i.value.ColumnUrlDetails.length;r++)i.value.ColumnUrlDetails[r].UrlLink="";this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val("");this.updateURLText("")}else i.value.UrlPath="",i.value.PassingParameters=[],this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val("");t&&this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,i.value,this.linkItem,this.linkItem.categoryName);this.linkItem.value=i.value},n.prototype.updateLinkDestination=function(n,t){var i=JSON.parse(JSON.stringify(this.linkItem));if(i.value.TargetTypeInfo=t,n)switch(t){case"_popup":i.value.Title=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val();break;case"_newwindow":i.value.Height=this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").getValue();i.value.Width=this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").getValue()}else this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none");this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,i.value,this.linkItem,this.linkItem.categoryName);this.linkItem.value=i.value;this.refreshWidget()},n.prototype.changeLinkConfig=function(n,t){this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked")?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.AppendColumn)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.URLPreview)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.URLText)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").css("display","none"),t&&(this.updateActionDetails(UrlLinkType[UrlLinkType.Row],n),this.populateList())):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").css("display",this.isLinkEnable?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").css("display",this.isLinkEnable?"block":"none"),t&&(this.updateActionDetails(UrlLinkType[UrlLinkType.Column],n),this.populateDropDown()));var i=this.widgetHelper.getCurrentWidgetInstance();i!=null&&BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(i)&&this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display","none")},n.prototype.enableLinkConfig=function(n){n?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_text_ckb").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").enable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_link_specialChar_ckb").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_txt").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").enable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_encryption_parameter_ckb").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("disabled",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("disabled",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config_1").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").BoldBIDashboardListBox("instance")._refreshScroller(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").data("BoldBIDashboardListBox").enable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_show_popup_div").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").removeAttr("disabled")):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_text_ckb").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_link_specialChar_ckb").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_txt").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_encryption_parameter_ckb").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").data("BoldBIDashboardListBox").disable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("disabled",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("disabled",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config_1").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").attr("disabled","true"));this.updateDropDownListDisabling(n)},n.prototype.updateDropDownListDisabling=function(n){n?this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("pointer-events","all").css("opacity","1"):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("pointer-events","none").css("opacity","0.3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").model.selectedIndex=0)},n.prototype.changedLink=function(n){if(n.isInteraction){this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0);this.changeLinkConfig(!1,!0);this.enableLinkConfig(n.isChecked);var t=this.populateLinkModel(JSON.parse(JSON.stringify(this.linkItem)));t.value.EnableLink=n.isChecked;t.value.IsAdvancedTarget=!1;t.value.TargetTypeInfo="_blank";this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t.value,this.linkItem,this.linkItem.categoryName);this.linkItem.value=t.value;t.value.EnableClick||this.propertyPanel.propertyPanelContainer.find("#"+this.categoryId+"_link_appendColumn_list").find(".e-select").removeClass("e-select");this.refreshWidget()}},n.prototype.escapeSpecialCharacterChangeEvent=function(n){if(n.isInteraction){var t=this.linkItem.value;t.EscapeSpecialCharacter=n.isChecked;this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName)}},n.prototype.enableParameterEncryptionChangeEvent=function(n){if(n.isInteraction){var t=this.linkItem.value;t.EnableParameterEncryption=n.isChecked;this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName)}},n.prototype.getLastUrl=function(){return this.linkItem&&this.linkItem.value?this.linkItem.value.UrlPath:""},n.prototype.getLastColumnUrl=function(n){for(var t=0;t<this.columnData.length;t++)if(this.columnData[t].Value===n&&this.linkItem.value.ColumnUrlDetails.length>t)return this.linkItem.value.ColumnUrlDetails[t].UrlLink;return""},n.prototype.updateURLText=function(n){if(n.length===0)this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").text(""),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("href","");else{var t=this.dashboardDesigner.modules.util.addhttp(n);this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("href",t);this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").text(n)}},n.prototype.updateUrlByValues=function(n,t,i){var f=this.widgetHelper.getCurrentWidgetInstance(),e=f.dataValues,o,r,u;if(!BoldBIDashboard.isNullOrUndefined(n)&&n!==""&&t.length>0&&!BoldBIDashboard.isNullOrUndefined(e))for(o=this.dashboardDesigner.modules.util.getSourceData(f.dataGroupInfo,i,!1,!0),r=0;r<t.length;r++)u=this.getValuesOfParameter(t[r],o,e),n=!BoldBIDashboard.isNullOrUndefined(u)&&u!==""?n.replaceAll("{{:"+t[r]+"}}",""+u+""):n;this.updatePreviewURLLink(n,f.widgetJson.Data.Id)},n.prototype.updatePreviewURLLink=function(n,t){this.dashboardDesigner.paramRegex.test(n)?this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getDashboardParamLink,{action:"",data:JSON.stringify({datasourceId:t,clientID:this.dashboardDesigner.modules.util.clientId,url:n})},{fnction:this.dashboardDesigner.bbdesigner$.proxy(this.updateParamLink,this,n)}):this.updateParamLink(n)},n.prototype.updateParamLink=function(n,t){!BoldBIDashboard.isNullOrUndefined(t)&&t.Status&&(n=t.Url);window.open(n,"_blank")},n.prototype.getValuesOfParameter=function(n,t,i){for(var o,u,f,e,r=0;r<t.length;r++)if(t[r].Value===n)for(o=JSON.parse(i.data),u=0;u<o.length;u++)if(f=t[r].Id,e=o[u],!BoldBIDashboard.isNullOrUndefined(e[f])&&e[f]!=="")return e[f];return""},n.prototype.columnUrlFocusOut=function(){this.updateColumnUrl(!0)},n.prototype.updateColumnUrl=function(n){var f=this.bbdesigner$("#"+this.categoryId+"_link_columnURL_txt"),r=f.val(),u=this.bbdesigner$("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList").getSelectedValue(),i,t;if(r!==this.getLastColumnUrl(u)){for(i=JSON.parse(JSON.stringify(this.linkItem.value)),t=0;t<this.columnData.length;t++)if(this.columnData[t].Value===u){i.ColumnUrlDetails[t].UrlLink=r;break}n&&(this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,i,this.linkItem,this.linkItem.categoryName),this.linkItem.value=i,this.refreshWidget())}},n.prototype.urlFocusOut=function(){this.updateURLText(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val());this.updateUrlForManualColumns();this.updateUrl(!0)},n.prototype.updateUrl=function(n){var i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(),t;i!==this.getLastUrl()&&(t=JSON.parse(JSON.stringify(this.linkItem.value)),t.UrlPath=i,n&&this.updatePassingParameters(t,i),this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName),this.linkItem.value=t)},n.prototype.urlKeyUp=function(){this.updateURLText(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val())},n.prototype.updateUrlForManualColumns=function(){var i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(),r,n,t;if(i!==this.getLastUrl()&&(r=new RegExp(/[^{:\}]+(?=})/g),n=i.match(r),!BoldBIDashboard.isNullOrUndefined(n)))for(n.length>0&&(this.linkItem.value.PassingParameters=[]),t=0;t<n.length;t++)this.linkItem.value.PassingParameters.push(n[t])},n.prototype.urlPreviewClick=function(n){var t,i;n.preventDefault();t=this.bbdesigner$("#"+this.categoryId+"_link_urlPreview_txt").attr("href");t.length>0&&(i=this.linkItem.value.GridUrlType===UrlLinkType[UrlLinkType.Column],t=this.dashboardDesigner.paramRegex.test(t)?this.bbdesigner$("#"+this.categoryId+"_link_urlPreview_txt").text():t,this.updateUrlByValues(t,i?this.linkItem.value.ColumnUrlDetails:this.linkItem.value.PassingParameters,i))},n.prototype.createDashboardLinks=function(){return{ColumnUrlDetails:[],GridUrlType:UrlLinkType[UrlLinkType.Row],LinkType:LinkType[LinkType.Url],EnableLink:!1,EscapeSpecialCharacter:!1,EnableParameterEncryption:!1,PassingParameters:[],UrlPath:""}},n.prototype.createGridColumnUrlDetails=function(){return{CaptionName:"",UniqueColumnName:"",UrlLink:""}},n.prototype.getDataGroupInfo=function(){var n=this.widgetHelper.getCurrentWidgetInstance();return n.DataGroupInfo},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ReportAction",InternalReportAction,window);InternalUndoManager=function(){function n(n){this.stack=[];this.currentIndex=-1;this.isMergeAction=!1;this.mergeAction=[];this.lastSavedActionIndex=-1;this.isExportAction=!1;this.isPerformAction=!1;this.stack=[];this.dashboardDesigner=n}return n.prototype.setMergeAction=function(n){this.isMergeAction=n;!n&&this.mergeAction.length>0&&(this.cmdAction(this.mergeAction),this.mergeAction=[])},n.prototype.saveActionIndex=function(){this.lastSavedActionIndex=this.currentIndex},n.prototype.cmdAction=function(n){this.isPerformAction||(this.clearRedo(),this.stack.push(n),this.currentIndex++,this.updateToolbar())},n.prototype.isUndo=function(){return this.currentIndex>=0},n.prototype.undo=function(){var n=this.stack[this.currentIndex];this.currentIndex--;this.undoAction(n);this.updateToolbar()},n.prototype.undoAction=function(n){var i,t;if(this.isPerformAction=!0,n.itemType!==undefined)this.performUndoAction(n);else for(i=n,t=0;t<i.length;t++)this.performUndoAction(i[t]);this.isPerformAction=!1},n.prototype.performUndoAction=function(n){n.action===CommandAction.ItemAdd?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),"dispose"):n.action===CommandAction.ItemPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsOldVal):n.action===CommandAction.ContainerPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)).getContainerProperty(),n.method,n.paramsOldVal):n.action===CommandAction.ItemResize?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsOldVal):n.action===CommandAction.ItemMove?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsOldVal):n.action===CommandAction.ItemDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,n.method,n.paramsOldVal):n.action===CommandAction.DataSourceAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"removeDataSource",n.paramsNewVal):n.action===CommandAction.DataSourceDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"insertDataSource",n.paramsNewVal):n.action===CommandAction.DataSourceEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,n.method,n.paramsOldVal):n.action===CommandAction.DataSetAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSet",n.paramsNewVal):n.action===CommandAction.DataSetEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,n.method,n.paramsOldVal):n.action===CommandAction.DataFieldDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"addDataSetField",n.paramsNewVal):n.action===CommandAction.DataAssignAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"removeItem",n.paramsOldVal):n.action===CommandAction.DataAssignReplace?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"replaceItem",n.paramsOldVal):n.action===CommandAction.DataAssignDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"addItem",n.paramsOldVal):n.action===CommandAction.DataAssignUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"reorderItem",n.paramsOldVal):n.action===CommandAction.UpdateSort?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateSortInfo",n.paramsOldVal):n.action===CommandAction.ParameterAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameter",n.paramsNewVal):n.action===CommandAction.ParameterDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"insertParameter",n.paramsNewVal):n.action===CommandAction.ParameterEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,n.method,n.paramsOldVal):n.action===CommandAction.ParametersAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameters",n.paramsNewVal):n.action===CommandAction.ParametersDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"addParameters",n.paramsNewVal):n.action===CommandAction.TextBoxContentUpdate&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsOldVal);this.dashboardDesigner.modules.serialization.notifyChange()},n.prototype.isRedo=function(){return this.currentIndex<this.stack.length-1},n.prototype.redo=function(){this.currentIndex++;var n=this.stack[this.currentIndex];this.redoAction(n);this.updateToolbar()},n.prototype.redoAction=function(n){var i,t;if(this.isPerformAction=!0,n.itemType!==undefined)this.performRedoAction(n);else for(i=n,t=0;t<i.length;t++)this.performRedoAction(i[t]);this.isPerformAction=!1;this.currentIndex===this.lastSavedActionIndex&&BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner,"updateFileStatus",[!1])},n.prototype.performRedoAction=function(n){if(n.action===CommandAction.ItemAdd)BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,n.method,n.paramsNewVal);else if(n.action===CommandAction.ItemPropertyChanged)BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsNewVal);else if(n.action===CommandAction.ContainerPropertyChanged)BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)).getContainerProperty(),n.method,n.paramsNewVal);else if(n.action===CommandAction.ItemResize)BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsNewVal);else if(n.action===CommandAction.ItemMove)BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsNewVal);else if(n.action===CommandAction.ItemDelete){var t=this.dashboardDesigner.element.find("#"+n.targetTag);t.length>0&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(t),"dispose")}else n.action===CommandAction.DataSourceAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"insertDataSource",n.paramsOldVal):n.action===CommandAction.DataSourceDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"removeDataSource",n.paramsOldVal):n.action===CommandAction.DataSourceEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,n.method,n.paramsNewVal):n.action===CommandAction.DataSetAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"insertDataSet",n.paramsOldVal):n.action===CommandAction.DataSetDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSet",n.paramsOldVal):n.action===CommandAction.DataSetEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,n.method,n.paramsNewVal):n.action===CommandAction.DataFieldDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSetField",n.paramsOldVal):n.action===CommandAction.DataAssignAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"addItem",n.paramsOldVal):n.action===CommandAction.DataAssignReplace?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"replaceItem",n.paramsNewVal):n.action===CommandAction.DataAssignDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"removeItem",n.paramsOldVal):n.action===CommandAction.DataAssignUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"reorderItem",n.paramsNewVal):n.action===CommandAction.UpdateSort?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateSortInfo",n.paramsNewVal):n.action===CommandAction.ParameterAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"insertParameter",n.paramsOldVal):n.action===CommandAction.ParameterDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameter",n.paramsOldVal):n.action===CommandAction.ParameterEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,n.method,n.paramsNewVal):n.action===CommandAction.ParametersAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"addParameters",n.paramsOldVal):n.action===CommandAction.ParametersDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameters",n.paramsOldVal):n.action===CommandAction.TextBoxContentUpdate&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+n.targetTag)),n.method,n.paramsNewVal);this.dashboardDesigner.modules.serialization.notifyChange()},n.prototype.updateToolbar=function(){var t=this.dashboardDesigner,n=this.dashboardDesigner.rptToolbar;BoldBIDashboard.isNullOrUndefined(n)||(n.showUndo(this.isUndo()),n.showRedo(this.isRedo()),n.updateRptTextActions());t.updateFileStatus(this.hasItemChanges())},n.prototype.clearRedo=function(){this.stack=this.stack.slice(0,this.currentIndex+1);this.lastSavedActionIndex>this.stack.length-1&&(this.lastSavedActionIndex=-1)},n.prototype.addCmdAction=function(n,t,i,r,u,f){var e={action:n,method:t,itemType:i,paramsNewVal:f,paramsOldVal:u,targetTag:r};this.isMergeAction&&!this.isPerformAction?this.mergeAction.push(e):this.cmdAction(e)},n.prototype.hasItemChanges=function(){return this.currentIndex===this.lastSavedActionIndex?!1:!0},n.prototype.reset=function(){this.currentIndex=-1;this.isPerformAction=!1;this.stack=[];this.updateToolbar()},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.UndoManager",InternalUndoManager,window);InternalKPIWindow=function(){function n(n){this.dashboardDesigner=null;this.callMethod="";this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.id=this.dashboardDesigner._id;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.renderkpiWindow();this.wireEvents()}return n.prototype.openkpiDialog=function(n,t,i,r){this.callInstance=t;this.callMethod=i;this.isKpiEdit=r;BoldBIDashboard.isNullOrUndefined(n)?(this.kpiDataValueField=null,this.kpiVal=null,this.isDisplayColumnNameEdited=!1):(this.kpiDataValueField=n,this.kpiVal=n.KPIColumnInfo,this.isDisplayColumnNameEdited=this.kpiVal.IsDisplayColumnNameEdited);this.setActualType();this.setTargetValues();this.setValueType();this.setResultValues();this.setBackgroundCheckbox();this.setColumnName();BoldBIDashboard.DashboardUtil.buttonEnable(this.kpiDialog.find("#"+this.id+"_kpi_btn_ok"),!0);this.kpiDialog.data("BoldBIDashboardDialog").open()},n.prototype.getValueType=function(){return BoldBIDashboard.DashboardUtil.ConvertEnumasKeyValuePairArray(KpiCalculationType)},n.prototype.setValueType=function(){var n=this.getValueType();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").selectItemByValue(n[0].value)):(this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.kpiVal.KpiCalculationType))},n.prototype.getResultValues=function(){return BoldBIDashboard.DashboardUtil.ConvertEnumasKeyValuePairArray(IndicationType)},n.prototype.setResultValues=function(){var n=this.getResultValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").selectItemByValue(n[0].value)):(this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.kpiVal.Indication))},n.prototype.setTargetValues=function(){var n=this.getValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").selectItemByValue(n[0].value)):(this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.callInstance.getActualTargetDropdownValueBasedOnKPI(this.kpiVal.TargetColumn)))},n.prototype.getValues=function(){var n=this.widgetHelper.getCurrentWidgetInstance(),t=n.DataGroupInfo;return this.getSourceData(t)},n.prototype.setActualType=function(){var n=this.getValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").selectItemByValue(n[0].value)):(this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:n}),this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.callInstance.getActualTargetDropdownValueBasedOnKPI(this.kpiVal.ActualColumn)))},n.prototype.setBackgroundCheckbox=function(){BoldBIDashboard.isNullOrUndefined(this.kpiVal)?this.kpiDialog.find("#"+this.id+"_kpiCheck").BoldBIDashboardCheckBox({checked:!1}):this.kpiDialog.find("#"+this.id+"_kpiCheck").BoldBIDashboardCheckBox({checked:this.kpiVal.SetBackground})},n.prototype.setColumnName=function(){BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").attr("placeholder",this.dashboardDesigner.getLocalizationContent().common.auto),this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val("")):this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val(this.kpiVal.IsDisplayColumnNameEdited?this.kpiVal.DisplayColumnName:"")},n.prototype.textKeyUp=function(n){if(n.keyCode===13)this.onColumnNameChange(n)},n.prototype.textFocusOut=function(n){this.onColumnNameChange(n)},n.prototype.onColumnNameChange=function(n){if(!BoldBIDashboard.isNullOrUndefined(n)){var t=this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val();BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(t)?(this.isDisplayColumnNameEdited=!1,this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val("")):this.isDisplayColumnNameEdited=!0}},n.prototype.getSourceData=function(n){var f=[],e,u,t,i,r,o;if(!BoldBIDashboard.isNullOrUndefined(n.FieldContainers)&&n.FieldContainers.length>0)for(e=n.FieldContainers,u=0;u<e.length;u++)for(t=0;t<e[u].FieldInfos.length;t++)i=e[u].FieldInfos,i[t].FieldType===FieldType.Measures&&i[t].SummaryType!==SummaryType.NONE&&(i[t].IsKPIColumn||f.push({text:i[t].DisplayName,value:i[t].UniqueColumnName,name:i[t].Name}),r=i[t],o=this.widgetHelper.getCurrentWidgetInstance(),this.callInstance.isPOPConfigured(r)&&(f.push({text:BoldBIDashboard.DashboardUtil.encodeText(r.DisplayName)+"_Primary",value:r.UniqueColumnName+"_Primary",name:BoldBIDashboard.DashboardUtil.encodeText(r.DisplayName)+"_Primary"}),f.push({text:BoldBIDashboard.DashboardUtil.encodeText(r.DisplayName)+"_Secondary",value:r.UniqueColumnName+"_Secondary",name:BoldBIDashboard.DashboardUtil.encodeText(r.DisplayName)+"_Secondary"})));return f},n.prototype.renderkpiWindow=function(){this.kpiDialog=BoldBIDashboard.buildTag("div.e-kpidialog","",{"padding-left":"18px","padding-right":"18px"},{id:this.id+"_kpiWindowDiv",title:"KPI Expression"});this.kpiDialog.BoldBIDashboardDialog({enableResize:!1,showRoundedCorner:!0,enableModal:!0,minWidth:400,minHeight:370,height:"auto",width:"auto",showOnInit:!1,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"e-designer-kpidialog boldbi-dashboarddesigner bbi-designer-dialog",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.dashboardDesigner.getLocalizationContent().dialogOptions.closeButtonText});var o=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_table_id"}),n=BoldBIDashboard.buildTag("table.e-designer-table","",{width:"100%"},{unselectable:"on"}),i=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),s=BoldBIDashboard.buildTag("td","",{}),ut=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Column Name",{"font-size":"12px","font-color":"#303541"},{type:"label"}),h=BoldBIDashboard.buildTag("td","",{"padding-left":"98px"}),t=BoldBIDashboard.buildTag("input.e-textbox","",{width:"201px",height:"25px"},{id:this.id+"_EditcolumnNamesValue",type:"text"});t.attr("placeholder",this.dashboardDesigner.getLocalizationContent().common.auto);var r=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),c=BoldBIDashboard.buildTag("td","",{}),ft=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Actual Value",{"font-size":"12px","font-color":"#303541"},{type:"label"}),l=BoldBIDashboard.buildTag("td","",{"padding-left":"107px"}),a=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_actual_drop"}),u=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),v=BoldBIDashboard.buildTag("td","",{}),et=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Target Value",{"font-size":"12px","font-color":"#303541"},{type:"label"}),y=BoldBIDashboard.buildTag("td","",{"padding-left":"106px"}),p=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_target_drop"}),f=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),w=BoldBIDashboard.buildTag("td","",{}),ot=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Value Type",{"font-size":"12px","font-color":"#303541"},{type:"label"}),b=BoldBIDashboard.buildTag("td","",{"padding-left":"115px"}),k=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_type_drop"}),e=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),d=BoldBIDashboard.buildTag("td","",{}),st=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Result",{"font-size":"12px","font-color":"#303541"},{type:"label"}),g=BoldBIDashboard.buildTag("td","",{"padding-left":"141px"}),nt=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"res_drop"}),tt=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),it=BoldBIDashboard.buildTag("td","",{"padding-left":"178px"}),rt=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_kpiCheck"}),ht=this.dashboardDesigner.element.find("#"+this.id+"_kpiWindowDiv_foot"),ct=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.dashboardDesigner.getLocalizationContent().dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_kpi_btn_cancel",type:"button"}),lt=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.dashboardDesigner.getLocalizationContent().dialogOptions.okButtonText,{float:"right"},{id:this.id+"_kpi_btn_ok",type:"button"});ht.append(ct).append(lt);this.kpiDialog.append(o);o.append(n);n.append(i);i.append(s);s.append(ut);i.append(h);h.append(t);n.append(r);r.append(c);c.append(ft);r.append(l);l.append(a);n.append(u);u.append(v);v.append(et);u.append(y);y.append(p);n.append(f);f.append(w);w.append(ot);f.append(b);b.append(k);n.append(e);e.append(d);d.append(st);e.append(g);g.append(nt);n.append(tt);tt.append(it);it.append(rt);a.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-actual bbi-designer-ejwidgets bbi-dbrd-control"});p.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-target bbi-designer-ejwidgets bbi-dbrd-control"});k.BoldBIDashboardDropDownList({dataSource:this.getValueType(),fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-type bbi-designer-ejwidgets bbi-dbrd-control"});nt.BoldBIDashboardDropDownList({dataSource:this.getResultValues(),fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-result bbi-designer-ejwidgets bbi-dbrd-control"});rt.BoldBIDashboardCheckBox({checked:!1,text:"Delta Background",cssClass:"e-designer-checkbox"});t.on("blur",this.bbdesigner$.proxy(this.textFocusOut,this));t.on("keyup",this.bbdesigner$.proxy(this.textKeyUp,this))},n.prototype.closeDialog=function(){this.kpiDialog.data("BoldBIDashboardDialog").close()},n.prototype.checkStatus=function(){return this.kpiDialog.find("#"+this.id+"_kpiCheck").data("BoldBIDashboardCheckBox").model.checked?!0:!1},n.prototype.getExpression=function(n,t,i){switch(KpiCalculationType[n]){case KpiCalculationType.AbsoluteVariation:return"["+t+" - "+i+"]";case KpiCalculationType.ActualValue:return"["+t+"]";case KpiCalculationType.PercentageOfTarget:return"[[("+t+")/("+i+")]* 100]";case KpiCalculationType.PercentageVariation:return"[([("+t+")/("+i+")]*100)-100]";case KpiCalculationType.ValueAndPercentage:return"("+t+")-("+i+")([([("+t+")/("+i+" )]*100)-100] )";default:return""}},n.prototype.updatekpiInfo=function(){var c,n;BoldBIDashboard.DashboardUtil.buttonEnable(this.kpiDialog.find("#"+this.id+"_kpi_btn_ok"),!1);var f=this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList"),e=this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList"),o=this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList"),s=this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList"),r=f.getItemDataByValue(f.getSelectedValue())[0],u=e.getItemDataByValue(e.getSelectedValue())[0],h=o.getItemDataByValue(o.getSelectedValue())[0],l=s.getItemDataByValue(s.getSelectedValue())[0],a=this.checkStatus(),v=this.getExpression(h.value,r.text,u.text),t;t=new KpiInformation;t.KpiCalculationType=h.value;t.Indication=l.value;t.KpiDisplayType=DisplayType.Value;t.SetBackground=a;var i=/^(.*)(_Primary|_Secondary)$/,y=!BoldBIDashboard.isNullOrUndefined(r.value.match(i))&&r.value.match(i).length>0?r.value.match(i).filter(function(n){return!i.test(n)})[0]:r.value,p=!BoldBIDashboard.isNullOrUndefined(u.value.match(i))&&u.value.match(i).length>0?u.value.match(i).filter(function(n){return!i.test(n)})[0]:u.value;t.ActualColumn.UniqueColumnName=y;t.ActualColumn.CaptionName=r.name;t.TargetColumn.UniqueColumnName=p;t.TargetColumn.CaptionName=u.name;c=this.isDisplayColumnNameEdited?BoldBIDashboard.DashboardUtil.encodeText(this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val()):r.name+" Vs "+u.name;t.DisplayExpression=v;t.DisplayColumnName=c;t.IsDisplayColumnNameEdited=this.isDisplayColumnNameEdited;BoldBIDashboard.isNullOrUndefined(this.kpiDataValueField)?(n=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"createValueInfo"),n.UniqueColumnName=this.GetNewUniqeName(),n.IsKPIColumn=!0,n.Name=t.DisplayColumnName,n.ContainerName="KPIColumn",n.FieldType=FieldType.Measures,n.SummaryType=SummaryType.NONE,n.KPIColumnInfo=t,n.MeasureFormatting=this.getMeasureFormat(t.KpiCalculationType)):(n=this.kpiDataValueField,n.IsKPIColumn=!0,n.Name=t.DisplayColumnName,n.ContainerName="KPIColumn",n.FieldType=FieldType.Measures,n.SummaryType=SummaryType.NONE,n.KPIColumnInfo=t,n.MeasureFormatting=this.getMeasureFormat(t.KpiCalculationType));n.DateTimeFormat=DateTimeFormat.None;n.DisplayName=t.DisplayColumnName;n.IsDisplayNameEdited=this.isDisplayColumnNameEdited;BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[n,this.isKpiEdit]);this.kpiDialog.data("BoldBIDashboardDialog").close()},n.prototype.GetNewUniqeName=function(){for(var r,i=this.callInstance.getKPIDataValueSet(),n=[],t=0;t<i.length;t++)n.push(parseInt(i[t].UniqueColumnName.match(/\d+/),10));return r=n.length===0?0:Math.max.apply(null,n)+1,"kpicolumn_"+r},n.prototype.getMeasureFormat=function(n){var t=new MeasureFormatting;switch(KpiCalculationType[n]){case KpiCalculationType.PercentageOfTarget:case KpiCalculationType.PercentageVariation:t.FormatType=DataValueFormat.Percentage;t.Unit=NumberFormat.Ones;t.DecimalPoints=0}return t},n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_kpi_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0));this.dashboardDesigner.element.on("click","#"+this.id+"_kpi_btn_ok",this.bbdesigner$.proxy(this.updatekpiInfo,this,this.isKpiEdit))},n.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_kpi_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0));this.dashboardDesigner.element.off("click","#"+this.id+"_kpi_btn_ok",this.bbdesigner$.proxy(this.updatekpiInfo,this,this.isKpiEdit))},n.prototype.destroy=function(){this.unWireEvents();BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_kpiWindowDiv"))},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.KPIWindow",InternalKPIWindow,window);InternalEditFieldSettings=function(){function n(n){this.columnNameInfo=null;this.fieldSettingsDialog=null;this.individualContainer=null;this.individualScrollElement=null;this.targetInstance=null;this.targetMethod=null;this.footerTag=null;this.settingsContainer=null;this.lastModifiedTextInfo=null;this.locale=null;this.id=n._id;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.renderFieldSettingsWindow();this.wireEvents()}return n.prototype.renderFieldSettingsWindow=function(){var n=this.fieldSettingsDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_fieldsSettings_Dialog"}),t=this.settingsContainer=BoldBIDashboard.buildTag("div","",{}),r=BoldBIDashboard.buildTag("div","",{display:"block"},{id:this.id+"_fieldsSettings_Dialog_edit"}),u=BoldBIDashboard.buildTag("div","",{height:"283px",width:"458px"},{}),e,o;r.append(u);var i=this.individualContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"262px",display:"block"},{id:this.id+"_fieldsSettings_Dialog_individual_container"}),f=BoldBIDashboard.buildTag("div","",{}),s=this.individualScrollElement=BoldBIDashboard.buildTag("div","",{height:"252px","padding-top":"5px","padding-bottom":"5px"},{id:this.id+"_fieldsSettings_Dialog_individual_elements"});f.append(s);i.append(f);this.renderHeaderElement(t);u.append(i);e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_fieldsSettings_Dialog_cancel",type:"button"});o=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_fieldsSettings_Dialog_ok",type:"button"});t.append(r);n.append(t);this.dashboardDesigner.element.append(n);n.BoldBIDashboardDialog({title:this.locale.fieldsSettings.editFieldsSettings,width:"auto",height:"auto",minWidth:450,minHeight:320,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});this.footerTag=this.bbdesigner$("#"+this.id+"_fieldsSettings_Dialog_foot");this.footerTag.append(e,o);i.BoldBIDashboardScroller({height:"262px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},n.prototype.renderColumns=function(n){for(var t=0;t<this.columnNameInfo.length;t++)this.renderRowElement(n,this.columnNameInfo[t],t)},n.prototype.scrollerRefresh=function(n){n.data("BoldBIDashboardScroller")&&n.data("BoldBIDashboardScroller").refresh()},n.prototype.renderHeaderElement=function(n){var t=BoldBIDashboard.buildTag("div","",{"margin-top":"10px",display:"inline-block",width:"450px",height:"20px",padding:"0px 10px"},{id:this.id+"_FieldsSettings_Header"}),e=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"}),o=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px","font-weight":"bold",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"}),i,r,u,f;o.text("Name");e.append(o);t.append(e);i=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"});r=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","font-weight":"bold","white-space":"nowrap","text-overflow":"ellipsis"});r.text("Caption");i.append(r);t.append(i);u=BoldBIDashboard.buildTag("div","",{width:"110px",float:"left"});f=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","font-weight":"bold","white-space":"nowrap","text-overflow":"ellipsis"});f.text("Show No Data Item");u.append(f);t.append(u);n.append(t)},n.prototype.renderRowElement=function(n,t,i){var u=BoldBIDashboard.buildTag("div","",{"margin-top":"10px",display:"inline-block",width:"450px",padding:"0px 10px"},{id:this.id+"_fieldsSettings_Dialog_rowElement"+i}),s=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"}),h=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","margin-top":"8.5px"}),f,r,e,o;h.text(t.CaptionName);s.append(h);u.append(s);f=BoldBIDashboard.buildTag("div","",{display:"inline-block",border:"0px solid","border-color":"red",float:"left",width:"170px"},{id:this.id+"_fieldsSettings_Dialog_Value"+i+"_parent"});r=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-content-label","",{width:"157px",height:"25px"},{id:this.id+"_fieldsSettings_Dialog_Value"+i,type:"text"});t.IsEdited?r.val(t.DisplayName):r.attr("placeholder",this.locale.common.auto);f.append(r);r.off("blur",this.bbdesigner$.proxy(this.textFocusOut,this,i));r.off("keyup",this.bbdesigner$.proxy(this.textKeyUp,this,i));r.on("blur",this.bbdesigner$.proxy(this.textFocusOut,this,i));r.on("keyup",this.bbdesigner$.proxy(this.textKeyUp,this,i));u.append(f);e=BoldBIDashboard.buildTag("div","",{display:"inline-block",border:"0px solid","border-color":"red",float:"left","margin-left":"50px"},{id:this.id+"_EditNoDataItemValue"+i+"_parent"});o=BoldBIDashboard.buildTag("input","",{"margin-top":"2px"},{id:this.id+"_EditNoDataItemValue"+i,type:"checkbox"});e.append(o);o.BoldBIDashboardCheckBox({checked:t.ShowNoDataItem,width:"30px",cssClass:"e-designer-prop-checkbox",change:this.bbdesigner$.proxy(this.noDataItemChange,this,i)});u.append(e);n.append(u)},n.prototype.textFocusOut=function(n){var t=this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+n).val();this.lastModifiedTextInfo=null;this.onValueChange(n,t)},n.prototype.onValueChange=function(n,t){var i=!BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(t);this.columnNameInfo[n].DisplayName!==t&&i&&(this.columnNameInfo[n].IsEdited=!0);i?this.columnNameInfo[n].DisplayName=t:(this.columnNameInfo[n].DisplayName=this.columnNameInfo[n].CaptionName,this.columnNameInfo[n].IsEdited=!1,this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+n).val(this.columnNameInfo[n].IsEdited?this.columnNameInfo[n].CaptionName:""),this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+n).attr("placeholder",this.locale.common.auto))},n.prototype.textKeyUp=function(n,t){var i=this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+n).val();if(t.keyCode===13)this.onValueChange(n,i);else this.lastModifiedTextInfo={rowIndex:n,value:i}},n.prototype.noDataItemChange=function(n,t){this.columnNameInfo[n].ShowNoDataItem=t.isChecked},n.prototype.populateColumnName=function(){this.renderColumns(this.individualScrollElement);this.scrollerRefresh(this.individualContainer)},n.prototype.updateColumnInfo=function(){if(!BoldBIDashboard.isNullOrUndefined(this.targetInstance)){if(!BoldBIDashboard.isNullOrUndefined(this.lastModifiedTextInfo)){this.onValueChange(this.lastModifiedTextInfo.rowIndex,this.lastModifiedTextInfo.value);this.lastModifiedTextInfo=null}BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.columnNameInfo]);this.fieldSettingsDialog.data("BoldBIDashboardDialog").close()}},n.prototype.closeFieldSettings=function(){this.fieldSettingsDialog.data("BoldBIDashboardDialog").close()},n.prototype.openFieldSettings=function(n,t,i){this.fieldSettingsDialog.data("BoldBIDashboardDialog").open();this.resetLengendSettings();this.targetInstance=n;this.targetMethod=t;this.columnNameInfo=JSON.parse(JSON.stringify(i));this.populateColumnName(this.columnNameInfo)},n.prototype.resetLengendSettings=function(){this.targetInstance=null;this.targetMethod=null;this.columnNameInfo=null;this.individualScrollElement.empty()},n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_fieldsSettings_Dialog_cancel",this.bbdesigner$.proxy(this.closeFieldSettings,this));this.dashboardDesigner.element.on("click","#"+this.id+"_fieldsSettings_Dialog_ok",this.bbdesigner$.proxy(this.updateColumnInfo,this))},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.EditFieldSettings",InternalEditFieldSettings,window);InternalCreateCategoryDialog=function(){function n(n,t){this.locale=null;this.designerInstance=n;this.bbdesigner$=this.designerInstance.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.designerInstance._id+"_create_category_dlg";this.callBackFn=t;this.renderDialog();this.unwireEvents();this.wireEvents()}return n.prototype.renderDialog=function(){var i;this.designerInstance.element.find("#"+this.id+"_dialog").length!==0&&this.dispose();var t=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect bbi-designer-category-dlg","",{height:"auto","border-left":"none","background-color":"var(--designer-background)"},{title:this.locale.alertDialogTitle.NewCategory,id:this.id+"_dialog"}),n=BoldBIDashboard.buildTag("div","",{height:"100%",width:"100%"},{id:this.id+"_dialog_content"}),r="<table style='width:100%;height:90%;border-collapse:collapse;' cellspacing='0' cellpadding='0'><tr><td class='bbi-category-name-row-td' style='width:15%;vertical-align:middle;'><label class='bbi-designer-label' style='vertical-align:top;'>"+this.locale.createCategoryDialog.nameLabelText+" * <\/label><\/td><td class='bbi-category-name-row-td' style='width:75%'><input type=\"text\" style='width:95%;'  id='"+this.id+"_data_source_name' class='e-textbox e-designer-category-name-text'/><\/td><\/tr><tr style='height: 15px'><td><\/td><td><label style='display:none;' class='bbi-designer-tile-content bbi-designer-errorLog'>"+this.locale.createCategoryDialog.emptyCategoryNameLabelText+"<\/label>    <\/td> <\/tr>       <tr>      <td style='width:15%;vertical-align:middle;'><label class='bbi-designer-label' style='' >"+this.locale.createCategoryDialog.descriptionLabelText+"<\/label><\/td>    <td>       <textarea style='width:95%;resize:none;text-indent:0px;' id='"+this.id+"_data_source_description' class='e-textarea e-ejinputtext bbi-designer-content-label bbi-designer-constr-textarea e-category-desc-box'><\/textarea><\/td><\/tr><tr><td><\/td><td><label class='bbi-designer-tile-content'>"+this.locale.createCategoryDialog.descriptionMaxLengthText+"<\/label>        <\/td>     <\/tr><\/table>",u=BoldBIDashboard.buildTag("label.bbi-designer-label bbi-dbrd-browse-category-msg bbi-dbrd-designer-hoverable",this.locale.alertWindowMesages.createCategoryMessage,{float:"left",color:"#a94442","line-height":2},{id:this.id+"_alertMsg_label"}),f=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.createCategoryDialog.saveButtonText,{float:"right"},{id:this.id+"_save_btn",type:"button",disabled:"disabled"}),e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.createCategoryDialog.cancelButtonText,{float:"right"},{id:this.id+"_cancel_btn",type:"button"});n.html(r);t.append(n);this.designerInstance.element.append(t);this.dialog=t.BoldBIDashboardDialog({enableModal:!0,width:600,maxWidth:600,maxHeight:300,enableResize:!1,showOnInit:!1,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",containment:"#"+this.designerInstance._id,target:"#"+this.designerInstance._id,height:300,showFooter:!0,close:this.bbdesigner$.proxy(this.dialogClosing,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog");i=this.designerInstance.element.find("#"+this.id+"_dialog_foot");i.append(u,e,f);this.categoryNameEle=n.find("#"+this.id+"_data_source_name");this.categoryDescEle=n.find("#"+this.id+"_data_source_description");this.waitingPopup=this.designerInstance.element.find("#"+this.id+"_dialog_wrapper").BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.designerInstance.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},n.prototype.saveButtonClick=function(){var n=this.categoryNameEle.val(),t=this.categoryDescEle.val(),i=this.designerInstance.element.find("#"+this.id+"_dialog_foot .bbi-dbrd-browse-category-msg");i.hide();this.designerInstance.modules.util.doAjaxPost("POST",this.designerInstance.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.createcategory,{action:BoldBIDashboard.DashboardUtil.DesignerAction.CreateCatogory,data:JSON.stringify({name:n,description:t})},{indicator:[this.bbdesigner$.proxy(this.showWaitingPopup,this),this.bbdesigner$.proxy(this.hideWaitingPopup,this)],fnction:this.bbdesigner$.proxy(this.onSuccess,this)},!0,!0)},n.prototype.showWaitingPopup=function(){this.waitingPopup.show()},n.prototype.hideWaitingPopup=function(){this.waitingPopup.hide()},n.prototype.cancelButtonClick=function(){this.dialog.close()},n.prototype.dialogClosing=function(n){this.waitingPopup.hide();n.model.position={X:0,Y:0}},n.prototype.dispose=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.designerInstance.element.find("#"+this.id+"_dialog_wrapper"),!0);this.designerInstance.element.find("#"+this.id+"_dialog").remove();this.unwireEvents()},n.prototype.onSuccess=function(n){var i=this.designerInstance.element.find("#"+this.id+"_dialog_foot"),t;n.Status?(i.find(".bbi-dbrd-browse-category-msg").hide(),this.dialog.close(),this.designerInstance.modules.fileBrowse.browseDialog.data("BoldBIDashboardDialog").open(),this.designerInstance.modules.fileBrowse.reloadCategory(this.categoryNameEle.val())):(t=this.getErrorMessage(n.StatusCode,n.Message),i.find(".bbi-dbrd-browse-category-msg").attr("data-tooltip",t).text(t).show())},n.prototype.getErrorMessage=function(n,t){var i=t;switch(n){case"2021":i=this.locale.createCategoryDialog.noCreatePermission}return i},n.prototype.showDialog=function(n){var t=this.designerInstance.element.find("#"+this.id+"_dialog_foot");BoldBIDashboard.isNullOrUndefined(n)&&n?t.find(".bbi-dbrd-browse-category-msg").show():t.find(".bbi-dbrd-browse-category-msg").hide();this.dialog.open()},n.prototype.categoryNameValidation=function(){var n=this.categoryNameEle.val(),t;this.dialog.element.find(".bbi-designer-errorLog").hide();this.categoryNameEle.removeClass("bbi-designer-error");BoldBIDashboard.DashboardUtil.buttonEnable(this.designerInstance.element.find("#"+this.id+"_save_btn"),!0);t=this.designerInstance.nameValidation(n)?this.locale.createCategoryDialog.emptyCategoryNameLabelText:this.locale.browseDialogMessages.dashboardNameErrorMsg+'* | / : < > , % ; \\ " + & ? #';n!==""&&this.designerInstance.nameValidation(n)||(this.dialog.element.find(".bbi-designer-errorLog").html(t).show(),this.categoryNameEle.addClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.buttonEnable(this.designerInstance.element.find("#"+this.id+"_save_btn"),!1))},n.prototype.handleCategoryNameTimeout=function(){var n=this;clearTimeout(this.categoryNameTimeout);this.categoryNameTimeout=setTimeout(function(){n.categoryNameValidation()},200)},n.prototype.wireEvents=function(){this.designerInstance.element.on("keyup",".e-designer-category-name-text",this.bbdesigner$.proxy(this.handleCategoryNameTimeout,this));this.designerInstance.element.on("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.saveButtonClick,this));this.designerInstance.element.on("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelButtonClick,this))},n.prototype.unwireEvents=function(){this.designerInstance.element.off("keyup",".e-designer-category-name-text",this.bbdesigner$.proxy(this.handleCategoryNameTimeout,this));this.designerInstance.element.off("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.saveButtonClick,this));this.designerInstance.element.off("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelButtonClick,this))},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.CreateCategoryDialog",InternalCreateCategoryDialog,window);InternalColorCustomizationAdvanceSettings=function(){function n(n){this.dashboardDesigner=null;this.colorFields=[];this.isMeasure=!0;this.measureFields=[];this.dimensionFields=[];this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id+"_color_customization_advance_settings";this.renderAdvanceSettingWidnow();this.wireEvents();this.multiSelectionComboBox=this.dashboardDesigner.modules.colorCustomizationInclusionSelection;this.dataSet=this.dashboardDesigner.modules.dataSet}return n.prototype.renderAdvanceSettingWidnow=function(){var n,r,u;this.dialogDiv=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id});n=BoldBIDashboard.buildTag("div.bbi-userselect bbi-color-custom-advance-container bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_advance_settings_container"});this.contentDiv=BoldBIDashboard.buildTag("div.bbi-color-custom-advance-content","",{},{id:this.id+"_advance_settings_content"});this.headerRow=BoldBIDashboard.buildTag("div.bbi-color-custom-header-field","",{display:"none"},{});this.conditionContainer=BoldBIDashboard.buildTag("div.bbi-advance-condition-container","",{},{});this.contentDiv.append(this.headerRow,this.conditionContainer);n.append(this.contentDiv);this.dialogDiv.append(n);this.dashboardDesigner.element.append(this.dialogDiv);this.dialogObj=this.dialogDiv.BoldBIDashboardDialog({title:this.locale.colorCustomBasicLocale.advanceText,width:830,height:"auto",minWidth:830,minHeight:530,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,enableAnimation:!1,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog");var f=this.dashboardDesigner.element.find("#"+this.id+"_foot"),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_advance_settings_cancel",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.dialogOptions.saveButtonText,{float:"right"},{id:this.id+"_advance_settings_save",type:"button"});f.append(t,i);i.off("click",this.bbdesigner$.proxy(this.saveBtnClick,this));t.off("click",this.bbdesigner$.proxy(this.dialogClose,this));i.on("click",this.bbdesigner$.proxy(this.saveBtnClick,this));t.on("click",this.bbdesigner$.proxy(this.dialogClose,this));r=[{id:SummaryType.SUM,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.SUM)},{id:SummaryType.AVG,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.AVG)},{id:SummaryType.COUNT,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.COUNT)},{id:SummaryType.MIN,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.MIN)},{id:SummaryType.MAX,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.MAX)},{id:SummaryType.COUNTD,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.COUNTD)},{id:SummaryType.VAR,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.VAR)}];u=[{text:"Value"},{text:"Percent"}];this.renderDrpDwn(this.headerRow.find(".e-adance-basedon-drpdwn"),null);this.renderDrpDwn(this.headerRow.find(".e-adance-aggregation-drpdwn"),r);this.renderDrpDwn(this.headerRow.find(".e-adance-format-drpdwn"),u);this.ejWaitingIndicator=n.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup");n.BoldBIDashboardScroller({height:"493px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize});this.scrollerObj=n.data("BoldBIDashboardScroller");BoldBIDashboard.isNullOrUndefined(this.dialogObj)||this.dialogObj.open();BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh()},n.prototype.renderBasedOnTemplate=function(){return"<div class='bbi-header-field-wrap e-header-basedon-div'><label class ='e-custom-color-basedon-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.basedOn+"<\/label><div class='e-adance-basedon-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_basedon-drpdwn type='text' class ='e-adance-basedon-drpdwn'/><\/div><\/div>"},n.prototype.renderAggregationTemplate=function(){return"<div class='bbi-header-field-wrap e-header-aggregation-div'><label class ='e-custom-color-aggregation-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.aggregation+"<\/label><div class='e-adance-aggregation-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_aggregation-drpdwn type='text' class ='e-adance-aggregation-drpdwn'/><\/div><\/div>"},n.prototype.renderFormatTemplate=function(){return"<div class='bbi-header-field-wrap e-header-format-div'><label class ='e-custom-color-format-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.formatText+"<\/label><div class='e-adance-format-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_format-drpdwn type='text' class ='e-adance-format-drpdwn'/><\/div><\/div>"},n.prototype.renderNumberFormattingTemplate=function(){return"<div class='bbi-header-field-wrap e-header-number-formating-div'><div class ='e-custom-color-numberformat-icon bbi-designer-number-format-settings e-header-row-element'><\/div><div class='bbi-adance-numberformat-wrap e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.numberFormating+"<\/div><\/div>"},n.prototype.renderDrpDwn=function(n,t){n.BoldBIDashboardDropDownList({fields:{text:"text",value:"text"},dataSource:t,selectedIndex:0,width:"120px",height:"28px",change:this.bbdesigner$.proxy(this.onDropDownChange,this),cssClass:"bbi-designer-ejwidgets bbi-dbrd-control"})},n.prototype.onDropDownChange=function(){var n,r,t,i,f;if(!this.isMeasure){n=this.dialogDiv.find(".bbi-condition-inclusion-value-dimension");r=this.dialogDiv.find("#"+n.attr("id")+"_multi_select_dropDown_text");r.html(this.locale.colorCustomAdvanceLocale.selectAny);var u=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList"),e=u.getSelectedValue(),o=u.getSelectedItem(),s=this.bbdesigner$(o).text();for(t=0;t<n.length;t++)i=this.bbdesigner$(n[t]).attr("id"),f=this.multiSelectionComboBox.getMultiSelectionComboBox(i),this.multiSelectionComboBox.resetMultiSelectionComboInfo(i),f.attr({"data-fieldValue":e,"data-fieldText":s})}},n.prototype.openFormatDialog=function(){var t=this,n=[];n.formatProperties=this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?new MeasureFormatting:this.internalAdvanceModeObj.MeasureFormatSettings;this.dashboardDesigner.modules.formatDialog.openFormatDialog(n,null,function(n){t.measureFormating={Culture:n.formatProperties.Culture,DecimalPoints:n.formatProperties.DecimalPoints,FormatType:n.formatProperties.FormatType,Unit:n.formatProperties.Unit,DecimalSeparator:n.formatProperties.DecimalSeparator,GroupSeparator:n.formatProperties.GroupSeparator,Suffix:n.formatProperties.Suffix,Prefix:n.formatProperties.Prefix,EnableLakhsAndCroreRep:n.formatProperties.EnableLakhsAndCroreRep}})},n.prototype.renderConditiondiv=function(n,t,i){var u=BoldBIDashboard.buildTag("div.bbi-advanc-condition-wrap","",{},{"data-conditionId":this.dsId+"_condition_"+t,"data-condition-num":t}),r=BoldBIDashboard.buildTag("div.bbi-advanc-condition-content",this.getConditionField(t,i),{},{}),f=BoldBIDashboard.buildTag("div.bbi-advanc-color-field-content",this.getColorField(t,i),{},{});u.append(r,f);n.append(u);this.renderConditionTypeDropDwn(r.find(".e-condition-type-drpdwn"),t,i);this.renderColorFieldContents(f,i);this.conditionNumbers.push(t);this.renderCasesensitiveCheckbox(r.find(".bbi-color-custom-condition-close"),i);this.isMeasure?(r.find(".bbi-condition-value-start").css({display:"inline-block"}),BoldBIDashboard.isNullOrUndefined(i)||i.MeasureCondition!==CMeasureConditionType.CBetween&&i.MeasureCondition!==CMeasureConditionType.CNotBetween||r.find(".bbi-condition-value-end").css({display:"inline-block"}),r.find(".e-condition-value-dimension").css({display:"none"}),r.find(".bbi-condition-inclusion-value-dimension").css({display:"none"}),this.dialogDiv.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"none"})):(r.find(".bbi-condition-value-start").css({display:"none"}),r.find(".bbi-condition-value-end").css({display:"none"}),this.dialogDiv.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"inline-block","margin-top":"4px"}),BoldBIDashboard.isNullOrUndefined(i)||i.DimensionCondition!==CDimensionConditionType.Inclusion?(r.find(".bbi-condition-inclusion-value-dimension").css({display:"none"}),r.find(".e-condition-value-dimension").css({display:"inline-block"}),r.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"inline-block","margin-top":"4px"})):(r.find(".bbi-condition-inclusion-value-dimension").css({display:"inline-block"}),r.find(".e-condition-value-dimension").css({display:"none"}),r.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"none"})))},n.prototype.getConditionField=function(n,t){return"<div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-name-label'>"+this.locale.colorCustomAdvanceLocale.conditionNameLabel+"<\/label><input type='text' class='e-textbox bbi-condition-name-textbox' value='"+this.getConditionLabelName(n,t)+"'/><\/div><div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-type-label'>"+this.locale.colorCustomAdvanceLocale.conditionTypeLabel+"<\/label><div class='bbi-condition-type-drpdwn-wrap'><input id="+this.id+"_condition_type_drpdwn_"+n+" data-condition-number="+n+" type ='text' class= 'e-condition-type-drpdwn'/><\/div><\/div><div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-value-label'>"+this.locale.colorCustomAdvanceLocale.conditionValueLabel+"<\/label><input type='number' class='e-textbox bbi-condition-value-textbox bbi-condition-value-start' value ="+this.getStartRangeValue(t)+" placeholder ='Value here'/><input class='e-textbox bbi-condition-value-textbox e-condition-value-dimension' value ="+this.getDimensionValue(t)+" placeholder ='Name here'/><div id="+this.id+"_inclusion_"+n+" class='bbi-condition-inclusion-value-dimension' style='width:130px;'><\/div><\/div><div class= 'bbi-color-custom-condition-field-wrap'><div class = 'bbi-color-custom-condition-close'><\/div><input type='number' class='e-textbox bbi-condition-value-textbox bbi-condition-value-end' value ="+this.getEndRangeValue(t)+" placeholder ='To'/><div class ='bbi-color-select-warning' title ='"+this.locale.colorCustomAdvanceLocale.colorSelectErrMsg+"'><\/div><input type='checkbox' id="+this.id+"_casesensitive_checkbox_"+n+" class='e-textbox bbi-color-custom-condition-close'/><\/div>"},n.prototype.getConditionLabelName=function(n,t){return BoldBIDashboard.isNullOrUndefined(t)?this.locale.colorCustomAdvanceLocale.conditionText+n:t.RangeLabel},n.prototype.getStartRangeValue=function(n){return BoldBIDashboard.isNullOrUndefined(n)?"''":n.StartRange},n.prototype.getEndRangeValue=function(n){return BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.EndRange)?"''":n.EndRange},n.prototype.getDimensionValue=function(n){return BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.DimensionConditionalValue)||n.DimensionConditionalValue.length===0?"''":n.DimensionConditionalValue[0]},n.prototype.renderConditionTypeDropDwn=function(n,t,i){if(n.BoldBIDashboardDropDownList({fields:{text:"text",value:"value"},dataSource:this.isMeasure?this.getMeasureFiledTypeDS():this.getDimensionFiledTypeDS(),selectedIndex:BoldBIDashboard.isNullOrUndefined(i)?0:this.isMeasure?i.MeasureCondition:i.DimensionCondition,cssClass:"bbi-designer-ejwidgets bbi-dbrd-control",width:"130px",height:"28px",change:this.bbdesigner$.proxy(this.conditionDrpDwnChange,this,t,i),enabled:!0,showRoundedCorner:!0}),this.isMeasure&&!BoldBIDashboard.isNullOrUndefined(i)&&(i.MeasureCondition===CMeasureConditionType.CBetween||i.MeasureConditon===CMeasureConditionType.CNotBetween)){var r=n.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end");r.css("display","block")}},n.prototype.conditionDrpDwnChange=function(n,t,i){this.isMeasure?this.measureConditionDrpDwnChange(n,i):this.DimensionConditionDrpDwnChange(n,t,i)},n.prototype.DimensionConditionDrpDwnChange=function(n,t,i){if(!BoldBIDashboard.isNullOrUndefined(i)){var r=this.conditionContainer.find(".e-condition-type-drpdwn[data-condition-number ="+n+"]"),e=r.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start"),o=r.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end"),u=r.parents(".bbi-advanc-condition-content").find(".e-condition-value-dimension"),f=r.parents(".bbi-advanc-condition-content").find(".bbi-condition-inclusion-value-dimension"),s=r.parents(".bbi-advanc-condition-content").find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+n);e.css("display","none");o.css("display","none");i.text===CDimensionConditionType[CDimensionConditionType.Inclusion]?(u.css("display","none"),f.css("display","block"),s.css("display","none")):(u.css("display","block"),f.css("display","none"),s.css({"margin-top":"4px"}),u.attr("placeholder",this.locale.colorCustomAdvanceLocale.nameHere));e.val("");o.val("");u.val("");f.val("")}},n.prototype.measureConditionDrpDwnChange=function(n,t){if(!BoldBIDashboard.isNullOrUndefined(t)){var i=this.conditionContainer.find(".e-condition-type-drpdwn[data-condition-number ="+n+"]"),u=i.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start"),r=i.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end"),f=i.parents(".bbi-advanc-condition-content").find(".e-condition-value-dimension"),e=i.parents(".bbi-advanc-condition-content").find(".bbi-condition-inclusion-value-dimension");f.css("display","none");e.css("display","none");f.val("");e.val("");t.selectedValue===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)||t.selectedValue===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)?(u.attr("placeholder",this.locale.colorCustomAdvanceLocale.from),r.css("display","block")):(u.attr("placeholder",this.locale.colorCustomAdvanceLocale.valueHere),r.css("display","none"),r.val(""))}},n.prototype.getMeasureFiledTypeDS=function(){return[{text:"Greater than",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CGreaterThan)},{text:"Greater than or Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CGreaterThanOrEqualTo)},{text:"Less than",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CLessThan)},{text:"Less than or Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CLessThanOrEqalTo)},{text:"Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CEquals)},{text:"Not equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotEquals)},{text:"Between",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)},{text:"Not between",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)},]},n.prototype.getDimensionFiledTypeDS=function(){return[{text:"Starts With",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Startswith)},{text:"Ends With",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Endswith)},{text:"Contains",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Contains)},{text:"Not Contains",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.NotContains)},{text:"Equals",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Equals)},{text:"Not Equals",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.NotEquals)}]},n.prototype.renderCasesensitiveCheckbox=function(n,t){n.BoldBIDashboardCheckBox({text:this.locale.colorCustomAdvanceLocale.casesensitive,checked:BoldBIDashboard.isNullOrUndefined(t)?!0:t.IsCaseSensitive})},n.prototype.getColorField=function(n){var t,i;for(this.colorFields=!BoldBIDashboard.isNullOrUndefined(this.colorFields)&&this.colorFields.length>0?this.colorFields:this.getDefaultColorFields(),t=null,i=0;i<this.colorFields.length;i++)t=BoldBIDashboard.isNullOrUndefined(t)?this.rendercolorFields(this.colorFields[i],n):t+this.rendercolorFields(this.colorFields[i],n);return t},n.prototype.getDefaultColorFields=function(){return[{Name:WidgetProperty.BackgroundColor,DisplayName:"Background",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.BorderColor,DisplayName:"Border",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.TitleColor,DisplayName:"Title",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.FillColor,DisplayName:"Range",ColorPicker:ColorSetColorPickers.GradientColorPicker},{Name:WidgetProperty.Icon,DisplayName:"Icon",ColorPicker:ColorSetColorPickers.IconColorPicker}]},n.prototype.rendercolorFields=function(n,t){var i=n.Name===WidgetProperty.Icon?this.getIcon(n.Name,t):"";return n.Name===WidgetProperty.Font?"<div class='bbi-color-custom-color-field-wrap'>"+this.fontStyle(n.Name,t)+"<\/div>":"<div class='bbi-color-custom-color-field-wrap'>"+this.getCheckBox(n.Name,n.DisplayName,n.ColorPicker,t)+i+this.getColorPicker(n.Name,t,n.ColorPicker)+"<\/div>"},n.prototype.fontStyle=function(n,t){return"<div class='bbi-conditional-font'><span  id="+this.id+"_"+n+"_bold_"+t+" class='e-designer-font-bold-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-bold bbi-font-style-basic-styles' /><span  id="+this.id+"_"+n+"_Italic_"+t+" class='e-designer-font-italic-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-italic bbi-font-style-basic-styles' /><span  id="+this.id+"_"+n+"_Underline_"+t+" class='e-designer-font-underline-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-underline bbi-font-style-basic-styles' /><span id="+this.id+"_"+n+"_StrikeThrough_"+t+" class='e-designer-font-strike-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-strikethrough bbi-font-style-basic-styles' /><\/div>"},n.prototype.getCheckBox=function(n,t,i,r){var u=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,n),f=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(ColorSetColorPickers,i);return"<div class= 'bbi-color-custom-color-field-chck-wrap'><input type='chekbox' id="+this.id+"_"+n+"_chkbox_"+r+" class='e-custom-color-checkbox' data-name='"+u+"'data-displayname='"+t+"'data-colorpicker='"+f+"'/><\/div>"},n.prototype.getIcon=function(n,t){return"<div class= 'bbi-color-custom-color-field-chck-wrap bbi-icon-custom-color-field'><input type='text' id="+ +this.id+"_"+n+"_drpdwn_"+t+" class='e-condition-icon-dropdown'/><\/div>"},n.prototype.getColorPicker=function(n,t,i){var r=n===WidgetProperty.Icon?"bbi-color-custom-color-field-colorpicker-wrap bbi-condition-icon-colorpicker-wrap":"bbi-color-custom-color-field-colorpicker-wrap",u="<div id="+this.id+"_range_colorpicker_"+t+" class='e-condition-range-colorpicker e-custom-colorpicker'><\/div>",f="<input type='text' id="+this.id+"_"+n+"_colorpicker_"+t+" class='e-custom-colorpicker'/>",e=ColorSetColorPickers.GradientColorPicker===i?u:f;return"<div class= '"+r+"'>"+e+"<\/div>"},n.prototype.renderColorFieldContents=function(n,t){for(var l,o,p,a,c,v="",u="",y=n.find(".bbi-color-custom-color-field-wrap"),s=n.find(".e-custom-color-checkbox"),i={},h=0;h<s.length;h++){var r=this.bbdesigner$(s[h]),f=r.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),e=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(ColorSetColorPickers,r.attr("data-colorpicker")),c=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,r.attr("data-name"));u=r.attr("data-name");v=r.attr("data-displayname");i=this.getCheckboxSelectionVal(t,c);s.length===1&&(i.isChecked=!0);r.BoldBIDashboardCheckBox({name:u,text:v,checked:i.isChecked,change:this.bbdesigner$.proxy(e===ColorSetColorPickers.GradientColorPicker?this.rangeCheckBoxChange:this.checkBoxChange,this)});e===ColorSetColorPickers.NormalColorPicker?this.renderColorPicker(f,i,r,u):e===ColorSetColorPickers.GradientColorPicker?this.renderRangePalette(f,i):e===ColorSetColorPickers.IconColorPicker&&(this.renderColorPicker(f,i,r,u),this.renderIconFieldDropDownContent(n.find(".e-condition-icon-dropdown"),i));i.isChecked||(l=f.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(l)||l.disable())}for(o=0;o<y.length;o++)p=this.bbdesigner$(y[o]),a=p.find(".bbi-conditional-font"),a.length>0&&(c=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,"Font"),i=this.getCheckboxSelectionVal(t,c),this.updateFontStyleSelection(i,a))},n.prototype.updateFontStyleSelection=function(n,t){n.isBold&&t.find(".e-font-bold").addClass("bbi-designer-fontstyle-selection");n.isItalic&&t.find(".e-font-italic").addClass("bbi-designer-fontstyle-selection");n.isUnderline&&t.find(".e-font-underline").addClass("bbi-designer-fontstyle-selection");n.isStrikeThrough&&t.find(".e-font-strikethrough").addClass("bbi-designer-fontstyle-selection")},n.prototype.colorChange=function(n,t,i){t===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,WidgetProperty.Icon)&&n.find(".bbi-icon-custom-color-field .e-selected-drpdwn-icon .e-icon-collection").css("color",this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(i.RGBA))},n.prototype.renderColorPicker=function(n,t,i,r){n.BoldBIDashboardColorPicker({value:t.startColorValue,cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label e-color-custom-colorpicker",select:this.bbdesigner$.proxy(this.colorChange,this,i.parents(".bbi-color-custom-color-field-wrap"),r),modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},n.prototype.renderRangePalette=function(n,t){var i=n.attr("id"),f,o,s,e,u,r;for(t.isGradient?this.bbdesigner$(n).attr({"data-type":"Gradient","data-startcolor":t.startColorValue,"data-endcolor":t.endColorValue}):this.bbdesigner$(n).attr({"data-type":"Flat","data-startcolor":t.startColorValue,"data-endcolor":""}),f="",this.bbdesigner$(n).attr("data-type")==="Flat"&&(f=this.bbdesigner$(n).attr("data-startcolor")),this.bbdesigner$(n).attr("data-type")==="Gradient"&&(f="linear-gradient("+this.bbdesigner$(n).attr("data-startcolor")+","+this.bbdesigner$(n).attr("data-endcolor")+")"),n.css({height:"28px",border:"1px solid #B3B3B3","border-radius":"3px",display:"inline-block","box-sizing":"border-box"}),o="<div id="+i+"_rangeColor class='e-range-color' data-id="+i+" style='height:17px;width:17px;background: "+f+";float:left;border-radius:3px;top:4px;left:4px;position:relative;'><\/div><div id="+i+"_rangeArrow class='e-range-icon e-icon e-down-arrow' data-id="+i+" style ='height:14px;width:14px;float:right;margin: 7px 4px 0px 0px;border-radius: 4px;'><\/div>",s="<div id="+i+"_colorPicker class='e-color-picker' style='height:304px;width:246px;position:absolute;border:1px solid #FFFFFF;box-shadow: 0 4px 6px 0 rgba(0,0,0,0.16);display:none;background:#FFFFFF;'><div id="+i+"_colorType style='height:26.1px;width:230px;border:1px solid #CCCCCC;border-radius:3px;margin:10px 0px 15px 7px;'><div id="+i+"_flatType class='e-flat-type' data-id="+i+" style='height:26.1px;width:115px;line-height: 26.1px;border-radius:2px 1px 1px 2px;background-color:#EEEEEE;font-size: 12px;text-align:center;float: left;font-family: Heebo, Roboto, Segoe UI,Noto Sans,Ubuntu,Droid Sans,Helvetica Neue,Arial;'>Flat<\/div><div id="+i+"_gradientType class='e-gradient-type' data-id="+i+" style='height:26.1px;width:115px;line-height: 26.1px;font-size: 12px;text-align:center;float: right;font-family: Heebo, Roboto, Segoe UI,Noto Sans,Ubuntu,Droid Sans,Helvetica Neue,Arial;'>Gradient<\/div><\/div><div id="+i+"_flatColorPalette data-id="+i+" style='height:206px;width:154px;margin-left: 7px;display:block'><\/div><div id="+i+"_gradientColorPalette style='height:240px;width:230px;margin-left: 7px;display:none'><\/div><\/div>",this.bbdesigner$(n).append(o),this.dashboardDesigner.element.append(s),e=[{code:"linear-gradient(#FFB199 , #FF0844)",startValue:"#FFB199",endValue:"#FF0844"},{code:"linear-gradient(#00F2FE, #4FACFE)",startValue:"#00F2FE",endValue:"#4FACFE"},{code:"linear-gradient(#009EFD, #2AF598)",startValue:"#009EFD",endValue:"#2AF598"},{code:"linear-gradient(#AC32E4, #4801FF)",startValue:"#AC32E4",endValue:"#4801FF"},{code:"linear-gradient(#FBAB7E, #F7CE68)",startValue:"#FBAB7E",endValue:"#F7CE68"},{code:"linear-gradient(#424242, #7B7B7B)",startValue:"#424242",endValue:"#7B7B7B"},{code:"linear-gradient(#FEAFA8, #F5EFEF)",startValue:"#FEAFA8",endValue:"#F5EFEF"},{code:"linear-gradient(#C2E9FB, #A1C4FD)",startValue:"#C2E9FB",endValue:"#A1C4FD"},{code:"linear-gradient(#96E6A1, #D4FC79)",startValue:"#96E6A1",endValue:"#D4FC79"},{code:"linear-gradient(#FBC2EB, #A18CD1)",startValue:"#FBC2EB",endValue:"#A18CD1"},{code:"linear-gradient(#FBD397, #FFECD2)",startValue:"#FBD397",endValue:"#FFECD2"},{code:"linear-gradient(#F9F9F9, #D0CECE)",startValue:"#F9F9F9",endValue:"#D0CECE"},{code:"linear-gradient(#FE9A8B, #F78CA0)",startValue:"#FE9A8B",endValue:"#F78CA0"},{code:"linear-gradient(#9EFBD3, #45D4FB)",startValue:"#9EFBD3",endValue:"#45D4FB"},{code:"linear-gradient(#8DDAD5, #00CDAC)",startValue:"#8DDAD5",endValue:"#00CDAC"},{code:"linear-gradient(#7028E4, #E5B2CA)",startValue:"#7028E4",endValue:"#E5B2CA"},{code:"linear-gradient(#FFB199, #E78208)",startValue:"#FFB199",endValue:"#E78208"},{code:"linear-gradient(#C9CCD3, #E3E5E8)",startValue:"#C9CCD3",endValue:"#E3E5E8"},{code:"linear-gradient(#A445B2, #FF0066)",startValue:"#A445B2",endValue:"#FF0066"},{code:"linear-gradient(#00C6FB, #005BEA)",startValue:"#00C6FB",endValue:"#005BEA"},{code:"linear-gradient(#0BA360, #3CBA92)",startValue:"#0BA360",endValue:"#3CBA92"},{code:"linear-gradient(#764BA2, #667EEA)",startValue:"#764BA2",endValue:"#667EEA"},{code:"linear-gradient(#F09819, #FF5858)",startValue:"#F09819",endValue:"#FF5858"},{code:"linear-gradient(#596164, #868F96)",startValue:"#596164",endValue:"#868F96"},{code:"linear-gradient(#C43A30, #562E69)",startValue:"#C43A30",endValue:"#562E69"},{code:"linear-gradient(#0C3483, #6B8CCE)",startValue:"#0C3483",endValue:"#6B8CCE"},{code:"linear-gradient(#53957A, #013929)",startValue:"#53957A",endValue:"#013929"},{code:"linear-gradient(#2E0784, #7039E5)",startValue:"#2E0784",endValue:"#7039E5"},{code:"linear-gradient(#B12A5B, #5D1510)",startValue:"#B12A5B",endValue:"#5D1510"},{code:"linear-gradient(#485563, #29323C)",startValue:"#485563",endValue:"#29323C"}],r=0;r<30;r++)this.dashboardDesigner.element.find("#"+i+"_gradientColorPalette").append("<div class='e-gradient-color' data-id="+i+" style='width:24px;height:24px;border-radius:2px;float:left;margin: 5px 3px 17px 10px;background-image:"+e[r].code+";' data-startcolor="+e[r].startValue+" data-endcolor="+e[r].endValue+">");if(u=this.bbdesigner$(n).children(),!BoldBIDashboard.isNullOrUndefined(n))if(t.isChecked){for(this.bbdesigner$(n).prop("disabled",!1),r=0;r<u.length;r++)this.bbdesigner$(u[r]).prop("disabled",!1);this.bbdesigner$(n).removeClass("e-range-disable")}else{for(this.bbdesigner$(n).prop("disabled",!0),r=0;r<u.length;r++)this.bbdesigner$(u[r]).prop("disabled",!0);this.bbdesigner$(n).addClass("e-range-disable")}this.dashboardDesigner.element.find("#"+i+"_flatColorPalette").BoldBIDashboardColorPicker({value:t.startColorValue,displayInline:!0,modelType:"picker",change:this.bbdesigner$.proxy(this.onColorChange,this,n)});t.isGradient&&(this.dashboardDesigner.element.find("#"+i+"_flatColorPalette").css("display","none"),this.dashboardDesigner.element.find("#"+i+"_flatType").css("background-color","#FFFFFF"),this.dashboardDesigner.element.find("#"+i+"_gradientColorPalette").css("display","block"),this.dashboardDesigner.element.find("#"+i+"_gradientType").css("background-color","#EEEEEE"))},n.prototype.onColorChange=function(n,t){this.bbdesigner$(n).attr({"data-startcolor":this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA),"data-type":"Flat"})},n.prototype.onRangeColorOpen=function(n){var t=this.bbdesigner$(n.target).attr("data-id")||this.bbdesigner$(n.target).attr("id");this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display")==="none"?this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display","block"):this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display","none");this.setColorPalettePosition(t);n.stopPropagation();this.bbdesigner$(document).on("click","body",this.bbdesigner$.proxy(this.onRangeColorClose,this,t))},n.prototype.setColorPalettePosition=function(n){var t=this.dashboardDesigner.element.find("#"+n),i=this.dashboardDesigner.element.find("#"+n+"_colorPicker"),r=t.offset(),h=this.bbdesigner$(document).scrollTop()+this.bbdesigner$(window).height()-(r.top+this.bbdesigner$(t).outerHeight()),c=r.top-this.bbdesigner$(document).scrollTop(),f=i.outerHeight(),e=i.outerWidth(),u=r.left,o=t.outerHeight(),l=(o-t.height())/2,s=3,a=this.getZindexPartial(t,i),v=(f<h||f>c?r.top+o+s:r.top-f-s)-l,y=this.bbdesigner$(document).scrollLeft()+this.bbdesigner$(window).width()-u;e>y&&e<u+t.outerWidth()&&(u-=i.outerWidth()-t.outerWidth());i.css({left:u+"px",top:v+"px","z-index":a})},n.prototype.getZindexPartial=function(n,t){var i,u,r;if(!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0)return u=n.parents(),r=this.bbdesigner$("body").children(),!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0&&r.splice(r.index(t),1),this.bbdesigner$(r).each(function(n,t){u.push(t)}),i=Math.max.apply(i,this.bbdesigner$.map(u,function(n){if(this.bbdesigner$(n).css("position")!=="static")return parseInt(this.bbdesigner$(n).css("z-index"))||1})),!i||i<1e4?i=1e4:i+=1,i},n.prototype.onRangeColorClose=function(n,t){var i=this.dashboardDesigner.element.find("#"+n),r;(this.bbdesigner$(t.target).parents(".e-color-picker").length===0||this.bbdesigner$(t.target).hasClass("e-gradient-selected"))&&(this.dashboardDesigner.element.find("#"+n+"_colorPicker").css("display","none"),r="",this.bbdesigner$(i).attr("data-type")==="Flat"&&(r=this.bbdesigner$(i).attr("data-startcolor"),this.dialogDiv.find("#"+n+"_rangeColor").css("background",r)),this.bbdesigner$(i).attr("data-type")==="Gradient"&&(r="linear-gradient("+this.bbdesigner$(i).attr("data-startcolor")+","+this.bbdesigner$(i).attr("data-endcolor")+")",this.dialogDiv.find("#"+n+"_rangeColor").css("background-image",r)))},n.prototype.onGradientColor=function(n){var t="#"+this.bbdesigner$(n.target).attr("data-id");this.bbdesigner$(n.target).addClass("e-gradient-selected");this.bbdesigner$(t).attr({"data-startcolor":this.bbdesigner$(n.target).attr("data-startcolor"),"data-endcolor":this.bbdesigner$(n.target).attr("data-endcolor"),"data-type":"Gradient"})},n.prototype.onGradientChange=function(n){var t=this.bbdesigner$(n.target).attr("data-id");this.dashboardDesigner.element.find("#"+t+"_gradientColorPalette").css("display","block");this.dashboardDesigner.element.find("#"+t+"_gradientType").css("background-color","#EEEEEE");this.dashboardDesigner.element.find("#"+t+"_flatColorPalette").css("display","none");this.dashboardDesigner.element.find("#"+t+"_flatType").css("background-color","#FFFFFF")},n.prototype.onFlatChange=function(n){var t=this.bbdesigner$(n.target).attr("data-id");this.dashboardDesigner.element.find("#"+t+"_flatColorPalette").css("display","block");this.dashboardDesigner.element.find("#"+t+"_flatType").css("background-color","#EEEEEE");this.dashboardDesigner.element.find("#"+t+"_gradientColorPalette").css("display","none");this.dashboardDesigner.element.find("#"+t+"_gradientType").css("background-color","#FFFFFF")},n.prototype.closeDialog=function(){this.dashboardDesigner.element.find(".e-color-picker").remove();!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator()},n.prototype.rangeCheckBoxChange=function(n){var u=this.dialogDiv.find("#"+n.model.id),i=u.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),r=this.bbdesigner$(i).children(),t;if(!BoldBIDashboard.isNullOrUndefined(i))if(n.isChecked){for(this.bbdesigner$(i).prop("disabled",!1),t=0;t<r.length;t++)this.bbdesigner$(r[t]).prop("disabled",!1);this.bbdesigner$(i).removeClass("e-range-disable")}else{for(this.bbdesigner$(i).prop("disabled",!0),t=0;t<r.length;t++)this.bbdesigner$(r[t]).prop("disabled",!0);this.bbdesigner$(i).addClass("e-range-disable")}},n.prototype.getCheckboxSelectionVal=function(n,t){var e=!1,r="#0162FF",o="",s=!1,h=this.locale.colorCustomAdvanceLocale.downText,c=!1,l=!1,a=!1,v=!1,y,f,u,i;if(!BoldBIDashboard.isNullOrUndefined(n)&&!BoldBIDashboard.isNullOrUndefined(n.PropertyColorPair))for(f=n.PropertyColorPair,u=0;u<f.length;u++)i=f[u],i.WidgetProperties===t&&(e=!0,i.WidgetProperties===WidgetProperty.Icon?(r=i.Image.ImageColor,h=i.Image.ImageURL,y=i.Image.ImageType):i.WidgetProperties===WidgetProperty.FillColor?(r=i.RangeColor.StartColor,o=i.RangeColor.EndColor,s=i.RangeColor.IsGradient):i.WidgetProperties===WidgetProperty.Font?(c=i.FontStyle.IsBold,l=i.FontStyle.IsItalic,a=i.FontStyle.IsUnderLine,v=i.FontStyle.IsStrikeThrough):r=i.RangeColor.StartColor);return{isChecked:e,startColorValue:r,endColorValue:o,isGradient:s,selectedIcon:h,iconType:y,isBold:c,isItalic:l,isUnderline:a,isStrikeThrough:v}},n.prototype.checkBoxChange=function(n){var r=this.dialogDiv.find("#"+n.model.id),f=r.parents(".bbi-advanc-condition-wrap"),u=r.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker").data("BoldBIDashboardColorPicker"),i,t;BoldBIDashboard.isNullOrUndefined(u)||(n.isChecked?(u.enable(),f.removeClass("e-color-select-err")):u.disable());n.model.name===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,WidgetProperty.Icon)&&(i=r.parents(".bbi-color-custom-color-field-wrap").find(".e-condition-icon-dropdown"),t=i.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(t)||(n.isChecked?(i.parent().removeClass("e-disable-selected-icondropdown"),t.enable(),f.removeClass("e-color-select-err"),this.selectIconByIndex(t)):(i.parent().addClass("e-disable-selected-icondropdown"),t.disable())))},n.prototype.selectIconByIndex=function(n){var i,t;if(!BoldBIDashboard.isNullOrUndefined(n)){for(i=n.items.length,t=0;t<i;t++)if(this.bbdesigner$(n.items[t]).hasClass("e-active")){n.selectItemByIndex(t);return}n.selectItemByIndex(0)}},n.prototype.saveBtnClick=function(){for(var u,i,f,e,r=[],n=this.dialogDiv.find(".bbi-advanc-condition-wrap"),t=0;t<n.length;t++){if(u=this.bbdesigner$(n[t]),i=this.colorRangeSettingsInfo(u),BoldBIDashboard.isNullOrUndefined(i))return;r.push(i)}f=this.getAggregationVal();e=this.getBasedOnDrpDwnVal(f);this.internalAdvanceModeObj=n.length>0?{IsPercent:this.getFormatDrpdwnVal(n),BasedOn:e,Ranges:r,MeasureFormatSettings:this.measureFormating}:null;this.dialogClose();BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalAdvanceModeObj,this.selectedColumn])},n.prototype.getAggregationVal=function(){var n=this.dialogDiv.find(".e-adance-aggregation-drpdwn").data("BoldBIDashboardDropDownList");if(!BoldBIDashboard.isNullOrUndefined(n))return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,n.getSelectedValue())},n.prototype.getBasedOnDrpDwnVal=function(n){var i=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList"),t;return BoldBIDashboard.isNullOrUndefined(i)||(t=i.getSelectedValue()),{UniqueColumnName:t,Key:t,SummaryType:n,SelectedColumnType:this.isMeasure?ColorColumnType.Measure:ColorColumnType.Dimension}},n.prototype.getFormatDrpdwnVal=function(){return!1},n.prototype.colorRangeSettingsInfo=function(n){var t=this.getPropertyColorPairValues(n);if(this.isColorFieldErr(t,n))return null;if(this.isMeasure){var i=this.getMeasureConditionTypeVal(n),o=this.validateRange(!0,n),e=0;return((i===CMeasureConditionType.CBetween||i===CMeasureConditionType.CNotBetween)&&(e=this.validateRange(!1,n)),n.find(".e-range-err").length>0)?null:{StartRange:o,EndRange:e,RangeLabel:this.validateConditionName(n),MeasureCondition:i,PropertyColorPair:t}}var r=this.getDimensionConditionTypeVal(n),u=this.validateText(n,r),s=n.find(".bbi-color-custom-condition-close").data("BoldBIDashboardCheckBox"),f=[];return(u!==""&&(r===CDimensionConditionType.Inclusion?f=u.split(","):f.push(u)),n.find(".e-range-err").length>0)?null:{RangeLabel:this.validateConditionName(n),PropertyColorPair:t,DimensionCondition:r,DimensionConditionalValue:f,IsCaseSensitive:s.isChecked()}},n.prototype.validateConditionName=function(n){var t=n.find(".bbi-condition-name-textbox");return t.val()},n.prototype.isColorFieldErr=function(n,t){return n.length===0?(t.addClass("e-color-select-err"),!0):(t.removeClass("e-color-select-err"),!1)},n.prototype.validateRange=function(n,t){var r=0,i=t.find(n?".bbi-condition-value-start":".bbi-condition-value-end");return i.val().trim()===""||n&&parseFloat(i.val())>parseFloat(i.attr("max"))||!n&&parseFloat(i.val())<parseFloat(i.attr("min"))?i.addClass("e-range-err"):(i.removeClass("e-range-err"),r=parseFloat(i.val().trim())),r},n.prototype.validateText=function(n,t){var r="",i;return t===CDimensionConditionType.Inclusion?(i=n.find("#"+n.find(".bbi-condition-inclusion-value-dimension").attr("id")+"_multi_select_dropDown_text"),i.html()===""||i.html()===this.locale.colorCustomAdvanceLocale.selectAny?n.find(".bbi-multiselect-dropdown-item").addClass("bbi-inclusion-err"):(n.find(".bbi-multiselect-dropdown-item").removeClass("bbi-inclusion-err"),r=i.html())):(i=n.find(".e-condition-value-dimension"),i.val()===""?i.addClass("e-range-err"):(i.removeClass("e-range-err"),r=i.val())),r},n.prototype.getMeasureConditionTypeVal=function(n){var t=n.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(CMeasureConditionType,t.getSelectedValue())},n.prototype.getDimensionConditionTypeVal=function(n){var t=n.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(CDimensionConditionType,t.getSelectedValue())},n.prototype.getPropertyColorPairValues=function(n){for(var i=[],u=n.find(".bbi-color-custom-color-field-wrap"),f=function(r){var h=t.bbdesigner$(u[r]),o=h.find(".bbi-conditional-font"),y=h.find(".e-custom-color-checkbox").data("BoldBIDashboardCheckBox"),e,c,l,a,s,v,f;!BoldBIDashboard.isNullOrUndefined(y)&&y.isChecked()?(e=new PropertyColorPair,e.WidgetProperties=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,y.model.name),c=h.find(".e-custom-colorpicker").data("BoldBIDashboardColorPicker"),l=t.colorFields.filter(function(n){return n.Name===e.WidgetProperties})[0],l.ColorPicker===ColorSetColorPickers.GradientColorPicker?(a=h.find(".e-custom-colorpicker"),s=new RangeColor,s.StartColor=t.bbdesigner$(a).attr("data-startcolor"),s.EndColor=t.bbdesigner$(a).attr("data-endcolor"),s.IsGradient=t.bbdesigner$(a).attr("data-type")==="Gradient"?!0:!1,e.RangeColor=s):l.ColorPicker===ColorSetColorPickers.NormalColorPicker?BoldBIDashboard.isNullOrUndefined(c)||(e.RangeColor=t.getRangeColor(c)):l.ColorPicker===ColorSetColorPickers.IconColorPicker&&(e.Image=t.getImageSettings(c,n,t.getIconDrpdownVal(n))),i.push(e)):o.length>0&&(v=new PropertyColorPair,v.WidgetProperties=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,"Font"),f=new FontSettings,f.IsBold=o.find(".e-font-bold").hasClass("bbi-designer-fontstyle-selection"),f.IsItalic=o.find(".e-font-italic").hasClass("bbi-designer-fontstyle-selection"),f.IsUnderLine=o.find(".e-font-underline").hasClass("bbi-designer-fontstyle-selection"),f.IsStrikeThrough=o.find(".e-font-strikethrough").hasClass("bbi-designer-fontstyle-selection"),v.FontStyle=f,(f.IsBold||f.IsItalic||f.IsUnderLine||f.IsStrikeThrough)&&i.push(v))},t=this,r=0;r<u.length;r++)f(r);return i},n.prototype.getIconDrpdownVal=function(n){var r=n.find(".e-condition-icon-dropdown"),t,i;return!BoldBIDashboard.isNullOrUndefined(r)&&(t=r.attr("icon-type"),!BoldBIDashboard.isNullOrUndefined(t))?t:(i=n.find(".e-condition-icon-dropdown").data("BoldBIDashboardDropDownList"),!BoldBIDashboard.isNullOrUndefined(i))?this.bbdesigner$(i.getSelectedItem()).attr("data-icon-id"):""},n.prototype.getRangeColor=function(n){var t=new RangeColor;return t.StartColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(n.getColor()),t},n.prototype.getImageSettings=function(n,t,i){var r=new ImageSettings,u;return BoldBIDashboard.isNullOrUndefined(n)||(r.ImageColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(n.getColor()),r.ImageURL=i,i==="custom"&&(u=t.find(".e-condition-icon-dropdown"),r.ImageType=ImageType[u.attr("data-type")],r.ImageURL=u.attr("data-value"))),r},n.prototype.dialogClose=function(){this.dialogObj.close()},n.prototype.renderAddConditionDiv=function(){return"<div class='bbi-color-custom-add-condition-wrap'><div class='bbi-color-custom-add-condition'>"+this.locale.colorCustomAdvanceLocale.addConditionText+"<\/div><\/div>"},n.prototype.removeCondition=function(n){var t=this.bbdesigner$(n.currentTarget).parents(".bbi-advanc-condition-wrap"),i=parseInt(t.attr("data-condition-num"),10);this.conditionNumbers.indexOf(i)>-1&&this.conditionNumbers.splice(this.conditionNumbers.indexOf(i),1);this.bbdesigner$(n.currentTarget).parents(".bbi-advanc-condition-wrap").remove();this.removeImage(t);this.scrollerObj.refresh()},n.prototype.removeImage=function(n){var i=n.find(".bbi-icon-custom-color-field"),t;i.length>0&&(t=i.find("input.e-condition-icon-dropdown"),BoldBIDashboard.isNullOrUndefined(t)||t.attr("data-type")===ImageType[ImageType.Embedded]&&Object.keys(this.dashboardDesigner.colorCustomIconStore).length>0&&delete this.dashboardDesigner.colorCustomIconStore[t.attr("data-value")])},n.prototype.addCondition=function(){var n=0;do n++;while(this.conditionNumbers.indexOf(n)>-1);this.renderConditiondiv(this.conditionContainer,n);BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh()},n.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_legend_settings"));this.dashboardDesigner.element.find("#"+this.id+"_legend_settings").length>0&&this.dashboardDesigner.element.find("#"+this.id+"_legend_settings").remove()},n.prototype.openAdvanceModeDlg=function(n,t,i){this.isMeasure=i.selectedColumn.SelectedColumnType!==1;this.resetFields();this.targetInstance=n;this.targetMethod=t;this.selectedColumn=i.selectedColumn;this.colorFields=i.colorFields;this.dsId=i.selectedColumn.Key;this.datasetId=i.dataSetId;this.getMeasureFields();this.getDimensionFields();this.internalAdvanceModeObj=this.bbdesigner$.extend(!0,{},i.advancedColorSettings);this.conditionContainer.empty();this.dialogObj.setTitle(this.locale.colorCustomBasicLocale.advanceText+" - "+n.selctedDisplayText);this.dialogObj.open();this.populateInfo()},n.prototype.showLoadingIndicator=function(){this.dialogDiv.find("#"+this.id+"_advance_settings_container").data("BoldBIDashboardWaitingPopup").show()},n.prototype.hideLoadingIndicator=function(){this.dialogDiv.find("#"+this.id+"_advance_settings_container").data("BoldBIDashboardWaitingPopup").hide()},n.prototype.updateHeaderProperties=function(){var n,t,i,r;this.isMeasure?(this.dialogDiv.find(".e-header-format-div").css({display:"inline-block"}),this.dialogDiv.find(".e-header-aggregation-div").css({display:"inline-block"}),this.dialogDiv.find(".e-header-number-formating-div").css({display:"none"})):(this.dialogDiv.find(".e-header-format-div").css({display:"none"}),this.dialogDiv.find(".e-header-aggregation-div").css({display:"none"}),this.dialogDiv.find(".e-header-number-formating-div").css({display:"none"}));n=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(n)||(n.setModel({dataSource:this.isMeasure?this.measureFields:this.dimensionFields,fields:{text:"text",value:"value"},selectedIndex:"0"}),this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?n.selectItemByIndex(0):n.selectItemByValue(this.internalAdvanceModeObj.BasedOn.Key));t=this.dialogDiv.find(".e-adance-aggregation-drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(t)||(this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?t.selectItemByIndex(0):t.selectItemByValue(this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(this.internalAdvanceModeObj.BasedOn.SummaryType)));i=this.dialogDiv.find(".e-adance-format-drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(i)||(r=this.internalAdvanceModeObj.IsPercent?BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(Format,Format.Percent):BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(Format,Format.Value),i.selectItemByValue(r))},n.prototype.getMeasureFields=function(){for(var t,i=[],n=0;n<this.dataSet.datasets.length;n++)if(this.dataSet.datasets[n].Id===this.datasetId)for(t=0;t<this.dataSet.datasets[n].Fields.length;t++)this.dataSet.datasets[n].Fields[t].TypeName==="Real"&&i.push({text:this.dataSet.datasets[n].Fields[t].DataField,value:this.dataSet.datasets[n].Fields[t].Id});this.measureFields=i},n.prototype.getDimensionFields=function(){for(var t,i=[],n=0;n<this.dataSet.datasets.length;n++)if(this.dataSet.datasets[n].Id===this.datasetId)for(t=0;t<this.dataSet.datasets[n].Fields.length;t++)this.dataSet.datasets[n].Fields[t].TypeName==="String"&&i.push({text:this.dataSet.datasets[n].Fields[t].DataField,value:this.dataSet.datasets[n].Fields[t].Id});this.dimensionFields=i},n.prototype.populateInfo=function(){this.showLoadingIndicator();var n=this;setTimeout(function(){if(n.updateHeaderProperties(),!BoldBIDashboard.isNullOrUndefined(n.internalAdvanceModeObj.Ranges)&&n.internalAdvanceModeObj.Ranges.length>0)for(var t=1;t<=n.internalAdvanceModeObj.Ranges.length;t++)n.renderConditiondiv(n.conditionContainer,t,n.internalAdvanceModeObj.Ranges[t-1]);else n.renderConditiondiv(n.conditionContainer,1,null);n.contentDiv.find(".bbi-color-custom-add-condition-wrap").length===0&&n.contentDiv.append(n.renderAddConditionDiv());n.hideLoadingIndicator()},100)},n.prototype.resetFields=function(){this.internalAdvanceModeObj=new AdvancedSettings;this.conditionNumbers=[];this.targetInstance=null;this.targetMethod=null;BoldBIDashboard.isNullOrUndefined(this.contentDiv.find(".bbi-color-custom-add-condition-wrap"))||this.contentDiv.find(".bbi-color-custom-add-condition-wrap").remove()},n.prototype.setMinValue=function(n){var i=this.bbdesigner$(n.currentTarget),r=i.parents(".bbi-advanc-condition-wrap"),t=r.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList"),u;BoldBIDashboard.isNullOrUndefined(t)||(t.getSelectedValue()===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)||t.getSelectedValue()===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween))&&(u=r.find(".bbi-condition-value-end"),u.attr("min",i.val()))},n.prototype.setMaxValue=function(n){var t=this.bbdesigner$(n.currentTarget),u=t.parents(".bbi-advanc-condition-wrap"),i=u.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList"),r;BoldBIDashboard.isNullOrUndefined(i)||(i.getSelectedValue()===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)||i.getSelectedValue()===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween))&&(r=t.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start"),r.attr("max",t.val()))},n.prototype.wireEvents=function(){this.dialogDiv.on("click","bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-bold",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-italic",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-underline",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-strikethrough",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-color-custom-condition-close",this.bbdesigner$.proxy(this.removeCondition,this));this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-color-custom-add-condition-wrap",this.bbdesigner$.proxy(this.addCondition,this));this.dialogDiv.on("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-start",this.bbdesigner$.proxy(this.setMinValue,this));this.dialogDiv.on("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-end",this.bbdesigner$.proxy(this.setMaxValue,this));this.dialogDiv.on("click",".e-condition-range-colorpicker, .e-range-color, .e-range-icon",this.bbdesigner$.proxy(this.onRangeColorOpen,this));this.dashboardDesigner.element.on("click",".e-gradient-color",this.bbdesigner$.proxy(this.onGradientColor,this));this.dashboardDesigner.element.on("click",".e-gradient-type",this.bbdesigner$.proxy(this.onGradientChange,this));this.dashboardDesigner.element.on("click",".e-flat-type",this.bbdesigner$.proxy(this.onFlatChange,this));this.dialogDiv.on("click",".e-custom-color-numberformat-icon",this.bbdesigner$.proxy(this.openFormatDialog,this))},n.prototype.unwireEvents=function(){this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-bold",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-italic",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-underline",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-strikethrough",this.bbdesigner$.proxy(this.selectFontStyleIcons,this));this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-color-custom-condition-close",this.bbdesigner$.proxy(this.removeCondition,this));this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-color-custom-add-condition-wrap",this.bbdesigner$.proxy(this.addCondition,this));this.dialogDiv.off("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-start",this.bbdesigner$.proxy(this.setMinValue,this));this.dialogDiv.off("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-end",this.bbdesigner$.proxy(this.setMaxValue,this));this.dialogDiv.off("click",".e-condition-range-colorpicker, .e-range-color, .e-range-icon",this.bbdesigner$.proxy(this.onRangeColorOpen,this));this.dashboardDesigner.element.off("click",".e-gradient-color",this.bbdesigner$.proxy(this.onGradientColor,this));this.dashboardDesigner.element.off("click",".e-gradient-type",this.bbdesigner$.proxy(this.onGradientChange,this));this.dashboardDesigner.element.off("click",".e-flat-type",this.bbdesigner$.proxy(this.onFlatChange,this));this.dialogDiv.off("click",".e-custom-color-numberformat-icon",this.bbdesigner$.proxy(this.openFormatDialog,this))},n.prototype.selectFontStyleIcons=function(n){var t=this.bbdesigner$(n.currentTarget);t.hasClass("bbi-designer-fontstyle-selection")?t.removeClass("bbi-designer-fontstyle-selection"):t.addClass("bbi-designer-fontstyle-selection")},n.prototype.getDropdownContent=function(){return"<ul class=\"e-icon-color-list\"><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.upText+"><div class=\"e-icon-collection e-icon-arrow2_up\" > <\/div><\/li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.rightText+"><div class=\"e-icon-collection e-icon-arrow2_right\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.downText+"><div class=\"e-icon-collection e-icon-arrow2_down\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.pointerUpText+"><div class=\"e-icon-collection e-icon-arrow2_pointer_up\" > <\/div><\/li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.pointerDownText+"><div class=\"e-icon-collection e-icon-arrow2_pointer_down\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.miunsText+"><div class=\"e-icon-collection e-icon-arrow2_minus\" > <\/div><\/li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.round+"><div class=\"e-icon-collection e-icon-arrow2_round\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.star+"><div class=\"e-icon-collection e-icon-arrow2_star\" > <\/div><\/li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.polygon+"><div class=\"e-icon-collection e-icon-arrow2_polygon\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.tickText+"><div class=\"e-icon-collection e-icon-arrow2_tick\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.warning+"><div class=\"e-icon-collection e-icon-arrow2_warning\"> <\/div><\/li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.closeText+"><div class=\"e-icon-collection e-icon-arrow2_close\"> <\/div><\/li><input type='button' id = 'customButton' class='bbi-dbrd-btn-small bbi-dbrd-btn-secondary e-custom-icon-button' data-icon-id='custom' value = '"+this.locale.colorCustomAdvanceLocale.customBtnText+"'/><\/ul>"},n.prototype.renderIconFieldDropDownContent=function(n,t){var r,s,i,u,f,e,o,h,c,l;n.find("#"+n.attr("id")+"_icon_list").length===0?(r=BoldBIDashboard.buildTag("div","",{},{id:n.attr("id")+"_icon_list"}),n.append(r)):r=n.find("#"+n.attr("id")+"_icon_list");r.append(this.getDropdownContent());this.renderCustomIconButton(r.find(".e-custom-icon-button"),n);s=r.find(".e-custom-icon-button").length>0&&r.find(".e-custom-icon-button").css("display")!=="none"?190:160;n.BoldBIDashboardDropDownList({targetID:n.attr("id")+"_icon_list",cssClass:"bbi-dbrd-control bbi-dbrd-designer-icon-drpdwn bbi-dbrd-designer-icon-drpdwn-popup",popupWidth:120,popupHeight:s,width:"43px",height:"28px",select:this.bbdesigner$.proxy(this.selectionChanged,n,this)});i=n.data("BoldBIDashboardDropDownList");u=this.bbdesigner$(n[0]).parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker");n.BoldBIDashboardDropDownList({watermarkText:this.waterMarkIcon(n,t,u)});!BoldBIDashboard.isNullOrUndefined(i)&&t.isChecked?t.iconType!==ImageType.Default?(i.enable(),i.selectItemByIndex(-1),n.attr("icon-type","custom"),n.attr("data-type",ImageType[t.iconType]),n.attr("data-value",t.selectedIcon),this.storeImageDetails(n),this.bbdesigner$(n[0].parentElement).find("#"+n[0].parentElement.id+"_selectedIcon").length>0&&this.bbdesigner$(n[0].parentElement).find("#"+n[0].parentElement.id+"_selectedIcon").remove(),u.length>0&&(f=u.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(f)||(e=n.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(e)||e.option("width","120px"),f.disable(),u.parents(".bbi-condition-icon-colorpicker-wrap").css("display","none"))),this.bbdesigner$(n).css({display:"none"}),o=BoldBIDashboard.buildTag("span","",{},{id:n[0].parentElement.id+"_selectedIcon"}),h=BoldBIDashboard.buildTag("div",this.locale.colorCustomAdvanceLocale.customBtnText,{"text-align":"left","padding-left":"0.857em"},{"class":"e-input e-selectedIcon"}),o.append(h),this.bbdesigner$(o).insertBefore(n)):(c=i.items.parents("ul").find("li[data-icon-id="+t.selectedIcon+"]"),l=this.bbdesigner$(i.items).index(c),i.selectItemByIndex(l),i.enable()):i.disable()},n.prototype.waterMarkIcon=function(n,t,i){if(!BoldBIDashboard.isNullOrUndefined(t)&&!t.isChecked){var r=n.data("BoldBIDashboardDropDownList"),u=i.data("BoldBIDashboardColorPicker");this.selectIconByIndex(r);n.parent().addClass("e-disable-selected-icondropdown");u.disable()}},n.prototype.storeImageDetails=function(n){if(n.attr("data-type")===ImageType[ImageType.Embedded]){var t=n.attr("data-value");if(Object.keys(this.dashboardDesigner.colorCustomIconStore).length>0&&!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.colorCustomIconStore[t]))return;this.dashboardDesigner.colorCustomIconStore[t]={base64String:"",imageName:t}}},n.prototype.renderCustomIconButton=function(n,t){if(!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0){n.off("click",this.bbdesigner$.proxy(this.customIconClicked,this,t));n.on("click",this.bbdesigner$.proxy(this.customIconClicked,this,t))}},n.prototype.selectionChanged=function(n,t){var r,f;if(!BoldBIDashboard.isNullOrUndefined(t.model)){var s=t.model.targetID,e=this.dialogDiv.find("#"+s),o="",i=this.bbdesigner$(e[0].parentElement),u=e.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker");u.length>0&&(r=u.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(r)||(f=i.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(f)||f.option("width","43px"),u.parents(".bbi-condition-icon-colorpicker-wrap").css("display","block"),r.enable(),o=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(r.getColor())));i.removeAttr("icon-type");i.removeAttr("data-type");i.removeAttr("data-value");t.model.showCheckbox||t.model.multiSelectMode!=="none"||n.setIconForDropDown(i,t,o)}},n.prototype.setIconForDropDown=function(n,t,i){this.bbdesigner$(n[0].parentElement).find("#"+n[0].parentElement.id+"_selectedIcon").length>0&&this.bbdesigner$(n[0].parentElement).find("#"+n[0].parentElement.id+"_selectedIcon").remove();this.bbdesigner$(n).css({display:"none"});var r=BoldBIDashboard.buildTag("span.e-selected-drpdwn-icon","",{},{id:n[0].parentElement.id+"_selectedIcon"}),f=this.getClassNameOfIcon(t.itemId),u=BoldBIDashboard.buildTag("div","",{},{"class":"e-icon-collection"});r.append(u);u.addClass(f);this.bbdesigner$(r).insertBefore(n);BoldBIDashboard.isNullOrUndefined(i)||i===""||r.find(".e-icon-collection").css("color",i)},n.prototype.getClassNameOfIcon=function(n){var t="";switch(n){case 0:t="e-icon-arrow2_up";break;case 1:t="e-icon-arrow2_right";break;case 2:t="e-icon-arrow2_down";break;case 3:t="e-icon-arrow2_pointer_up";break;case 4:t="e-icon-arrow2_pointer_down";break;case 5:t="e-icon-arrow2_minus";break;case 6:t="e-icon-arrow2_round";break;case 7:t="e-icon-arrow2_star";break;case 8:t="e-icon-arrow2_polygon";break;case 9:t="e-icon-arrow2_tick";break;case 10:t="e-icon-arrow2_warning";break;case 11:t="e-icon-arrow2_close"}return t},n.prototype.customIconClicked=function(n){this.dashboardDesigner.modules.colorCustomizationCustomDialog.openCustomDialogWindow(n)},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationAdvanceSettings",InternalColorCustomizationAdvanceSettings,window);InternalColorCustomizationCustomDialog=function(){function n(n){this.dashboardDesigner=null;this.isImageElement=!1;this.isBackgroundImageElement=!1;this.isMarkerImageElement=!1;this.locale=null;this.ejCustomDialog=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id+"_color_customization_icon_dlg";this.renderCustomDialogWindow()}return n.prototype.renderCustomDialogWindow=function(){var i=this.customDialogContainer=BoldBIDashboard.buildTag("div.bbi-userselect.e-color-customization-icon-dlg","",{},{id:this.id+"_custom_dialog"}),r=BoldBIDashboard.buildTag("div.bbi-userselect bbi-dbrd-control","",{width:"100%"},{id:this.id+"_custom_dialog_container"}),u=BoldBIDashboard.buildTag("div","",{width:"100%",height:"100%"},{id:this.id+"_custom_dialog_content"}),n,t;r.append(u);i.append(r);this.dashboardDesigner.element.append(i);this.ejCustomDialog=i.BoldBIDashboardDialog({title:this.locale.colorCustomAdvanceLocale.customIconDlgTitle,width:"auto",height:"auto",minHeight:240,minWidth:450,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner e-dashboarddesigner-custom-icon-dlg",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog");this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_custom_dialog_foot");n=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left e-custom-dlg-cancel-btn",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_custom_dialog_cancel",type:"button"});t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary e-custom-dlg-save-btn",this.locale.dialogOptions.addButtonText,{float:"right"},{id:this.id+"_custom_dialog_save",type:"button"});this.footerTag.append(n,t);t.off("click",this.bbdesigner$.proxy(this.saveBtnClick,this));n.off("click",this.bbdesigner$.proxy(this.cancelBtnClick,this));t.on("click",this.bbdesigner$.proxy(this.saveBtnClick,this));n.on("click",this.bbdesigner$.proxy(this.cancelBtnClick,this));this.addBtnEnableDisable(!1)},n.prototype.openCustomDialogWindow=function(n){this.resetFields();this.isImageElement=n.hasClass("bbi-color-custom-image-field");this.isBackgroundImageElement=n.hasClass("bbi-color-custom-background-image-field");this.isMarkerImageElement=n.hasClass("bbi-marker-shape-image-custom-field");this.parentDrpDwn=n;this.renderTab(this.customDialogContainer.find("#"+this.id+"_custom_dialog_content"));this.ejCustomDialog.open()},n.prototype.resetFields=function(){this.fileOrURLPath=null;this.selectedImageType=ImageType[ImageType.Embedded]},n.prototype.renderTab=function(n){var i,r,u,t;n.children().length===0?(i=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-content-wrap","",{},{id:this.id+"_custom_dialog_content_wrap"}),n.append(i),t=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-tab","",{},{id:this.id+"_custom_dialog_tab"}),this.getTabHeader(t),r=BoldBIDashboard.buildTag("table.bbi-designer-dsconfig-table e-custom-upload-table e-custom-dlg-content-table","",{width:"100%",height:"100%"},{unselectable:"on",id:this.id+"_custom_icon_selectedType"}),u=BoldBIDashboard.buildTag("table.bbi-designer-dsconfig-table e-custom-url-table e-custom-dlg-content-table","",{width:"100%",height:"100%"},{unselectable:"on",id:this.id+"_custom_icon_selectedType"}),t.find(".e-custom-icon-dialog-browse").append(r),t.find(".e-custom-icon-dialog-url").append(u),this.renderBrowseDialog(this.id+"_custom_icon_browse_type_dialog",r),this.renderUrlTextBox(this.id+"_custom_icon_url_textbox",u),i.append(t),t.BoldBIDashboardTab({width:"450px",height:"160px",selectedItemIndex:0,itemActive:this.bbdesigner$.proxy(this.afterTabActive,this)}),this.selectedImageType===ImageType[ImageType.Embedded]&&(this.fileOrURLPath=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-value"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-value"):this.parentDrpDwn.attr("data-value"),this.updateBrowseImage())):(BoldBIDashboard.isNullOrUndefined(this.parentDrpDwn)||(this.selectedImageType=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-type"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-type"):this.parentDrpDwn.attr("data-type"),this.fileOrURLPath=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-value"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-value"):this.parentDrpDwn.attr("data-value")),BoldBIDashboard.isNullOrUndefined(this.selectedImageType)&&(this.selectedImageType=ImageType[ImageType.Embedded]),t=this.customDialogContainer.find(".e-custom-icon-dialog-tab").data("BoldBIDashboardTab"),BoldBIDashboard.isNullOrUndefined(t)||(this.selectedImageType!==ImageType[ImageType.URL]?(t.option("selectedItemIndex",0),this.filePath.val(""),this.updateBrowseImage()):(t.option("selectedItemIndex",1),this.urlTextBox.val(this.fileOrURLPath),this.urlTextFocusOut(),this.addBtnEnableDisable(this.urlTextBox.val().trim()!==""?!0:!1))))},n.prototype.updateBrowseImage=function(){if(Object.keys(this.dashboardDesigner.colorCustomIconStore).length>0){var n=this.dashboardDesigner.colorCustomIconStore[this.fileOrURLPath];BoldBIDashboard.isNullOrUndefined(n)||(n.base64String=BoldBIDashboard.isNullOrUndefined(n.base64String)||n.base64String===""?BoldBIDashboard.Dashboard.Resource.getImage(this.fileOrURLPath):n.base64String);BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.base64String)||n.base64String===""?BoldBIDashboard.isNullOrUndefined(this.fileOrURLPath)?this.resetBrowseFields():this.fetchImage():(this.browseDialog.find(".e-browse-input-box").val(n.imageName),this.browseDialog.find(".e-custom-image").attr("src",n.base64String),this.browseDialog.find(".e-default-image").hide(),this.browseDialog.find(".e-custom-image").show(),this.addBtnEnableDisable(!0))}},n.prototype.fetchImage=function(){this.ejCustomDialog.open();this.showLoadingIndicator();this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.assignimage,{action:BoldBIDashboard.DashboardUtil.DesignerAction.FetchImage,data:JSON.stringify({fileName:this.fileOrURLPath})},{fnction:this.bbdesigner$.proxy(this.updateImageInfo,this)})},n.prototype.updateImageInfo=function(n){this.fileExt=n.ext;this.fileOrURLPath=n.fileName;this.fileId=n.fileId;this.updateImageMode(n);this.storeImageDetails()},n.prototype.storeImageDetails=function(){this.dashboardDesigner.colorCustomIconStore[this.fileOrURLPath]={base64String:this.browseDialog.find(".e-custom-image").attr("src"),imageName:this.browseDialog.find(".e-browse-input-box").val()}},n.prototype.getTabHeader=function(n){var t="<ul><li><a href='#"+this.id+"_Upload'>"+this.locale.colorCustomAdvanceLocale.uploadText+"<\/a><\/li><li><a href='#"+this.id+"_Url'>"+this.locale.colorCustomAdvanceLocale.urlText+"<\/a><\/li><\/ul>",i=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-browse e-custom-icon-dialog-tab-content","",{},{id:this.id+"_Upload"}),r=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-url e-custom-icon-dialog-tab-content","",{},{id:this.id+"_Url"});n.append(t,i,r)},n.prototype.afterTabActive=function(n){if(!BoldBIDashboard.isNullOrUndefined(n)){var t=this.bbdesigner$(n.activeHeader).find(".e-link").text();this.selectedImageType=t===this.locale.colorCustomAdvanceLocale.urlText?ImageType[ImageType.URL]:this.selectedImageType=ImageType[ImageType.Embedded];this.selectedImageType===ImageType[ImageType.URL]?this.addBtnEnableDisable(this.urlTextBox.val().trim()!==""?!0:!1):this.addBtnEnableDisable(!BoldBIDashboard.isNullOrUndefined(this.filePath)&&this.filePath.val().trim()!==""?!0:!1)}},n.prototype.renderUrlTextBox=function(n,t){var i=this.urlTextRow=this.bbdesigner$("<tr id="+n+"_tr/>"),r=BoldBIDashboard.buildTag("div.bbi-custom-icon-inner-content","",{height:"100px",width:"320px"},{}),u=this.urlTextBox=BoldBIDashboard.buildTag("input.e-textbox e-url-textbox","",{},{id:n,type:"text",spellcheck:"false"});u.bind("focusout",this.bbdesigner$.proxy(this.urlTextFocusOut,this));r.append(u);i.append(r);this.renderImageDiv(this.id+"_custom_icon_Image_div_url",i);t.append(i)},n.prototype.urlTextFocusOut=function(){var n,t;this.fileOrURLPath=this.urlTextRow.find("#"+this.id+"_custom_icon_url_textbox").val();n=this.urlTextRow.find(".e-custom-image");n.length!==0&&(t=this.fileOrURLPath.length>0&&this.fileOrURLPath.match(/^ *$/)===null,t?(n.attr("src",this.fileOrURLPath),n.show(),this.urlTextRow.find(".e-default-image").hide()):(n.hide(),this.urlTextRow.find(".e-default-image").show()),this.addBtnEnableDisable(t))},n.prototype.addBtnEnableDisable=function(n){var t=this.footerTag.find(".e-custom-dlg-save-btn");BoldBIDashboard.DashboardUtil.buttonEnable(t,n)},n.prototype.renderBrowseDialog=function(n,t){var u=this.browseDialog=this.bbdesigner$("<tr id="+n+"_tr/>"),i=BoldBIDashboard.buildTag("div.bbi-custom-icon-inner-content","",{},{}),r;this.filePath=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-content-label e-browse-input-box","",{},{id:this.id+"_image_path",type:"text",readonly:"readonly"});r=BoldBIDashboard.buildTag("div.bbi-designer-content-label bbi-dbrd-designer-hand-cursor e-browse-btn",this.locale.colorCustomAdvanceLocale.browseText,{},{id:this.id+"_image_file_browse"});r.BoldBIDashboardButton({showRoundedCorner:!1,click:this.bbdesigner$.proxy(this.onBrowseClick,this)});i.append(this.filePath);i.append(r);u.append(i);this.renderImageDiv(this.id+"_custom_icon_Image_div_browse",this.browseDialog);t.append(u);this.renderUploadBox()},n.prototype.renderImageDiv=function(n,t){var u=this.bbdesigner$("<td class=\"bbi-custom-icon-inner-content e-custom-image-td\" unselectable='on'/>"),i=BoldBIDashboard.buildTag("div.e-custom-image-wrap","",{},{id:this.id+"_"+n+"_image_file_Div"}),r,f;u.append(i);t.append(u);r=BoldBIDashboard.buildTag("img.e-custom-image","",{},{id:this.id+"_"+n+"_image_file"});f=BoldBIDashboard.buildTag("div.e-default-image","",{},{id:this.id+"_"+n+"_default_image_file_Div"});i.append(r,f);r.hide();i.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},n.prototype.onBrowseClick=function(){this.dashboardDesigner.element.find("#"+this.id+"_image_upload .e-uploadinput").click()},n.prototype.renderUploadBox=function(){var n=this,t=BoldBIDashboard.buildTag("div","",{height:"0px"},{id:this.id+"_image_upload"});this.dashboardDesigner.element.append(t);this.ejUploadBox=t.BoldBIDashboardUploadbox({width:"0px",height:"0px",uploadName:"image",extensionsAllow:".jpg,.png,.gif,.jpeg,.bmp,.emf,.jfif,.jpe,.rle,.tif,.tiff,.wmf,.dib,.ico",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.dashboardDesigner.element},fileSize:78643200,saveUrl:this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.uploadimage,fileSelect:this.bbdesigner$.proxy(this.onfileSelect,this),error:this.bbdesigner$.proxy(this.onuploadError,this),success:this.bbdesigner$.proxy(this.onuploadSuccess,this),beforeSend:this.bbdesigner$.proxy(function(t){n.dashboardDesigner.beforeSendRequestForUploadbox(n.dashboardDesigner,"UploadAction",t)},this)}).data("BoldBIDashboardUploadbox");this.dashboardDesigner.element.find(this.id+"_img_upload_SelectButton").hide()},n.prototype.onfileSelect=function(n){n.files.length!==0&&(this.showLoadingIndicator(),n.files[0].size>n.model.fileSize?n.cancel=!0:(this.fileOrURLPath=this.fileExt=null,this.filePath.val(n.files[0].name)));this.ejUploadBox._uploadFileListDelete()},n.prototype.showLoadingIndicator=function(){this.browseDialog.find(".e-default-image").hide();this.browseDialog.find(".e-custom-image").hide();var n=this.browseDialog.find(".e-custom-image-wrap").data("BoldBIDashboardWaitingPopup");BoldBIDashboard.isNullOrUndefined(n)||n.show()},n.prototype.hideLoadingIndicator=function(){var n=this.browseDialog.find(".e-custom-image-wrap").data("BoldBIDashboardWaitingPopup");BoldBIDashboard.isNullOrUndefined(n)||n.hide()},n.prototype.onuploadError=function(){this.hideLoadingIndicator();this.browseDialog.find(".e-default-image").show();window.alert("Upload Failed")},n.prototype.onuploadSuccess=function(n){var t=JSON.parse(n.responseText);t&&t.Status?(this.fileExt=t.Data.ext,this.fileOrURLPath=t.Data.fileId+t.Data.ext,this.fileId=t.Data.fileId,this.updateImageMode(t.Data)):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.upload,this.locale.errorMessage.failedToUploadFile,IconType.errors,AlertType.Alert,!1,t?t.Message:null)},n.prototype.updateImageMode=function(n){var t=this.browseDialog.find(".e-custom-image"),i;t.length!==0&&(i="data:image/"+n.ext+";base64,"+n.source+"",t.attr("src",i),BoldBIDashboard.Dashboard.Resource.addImage(n.fileId+n.ext,i),this.hideLoadingIndicator(),t.show(),this.browseDialog.find(".e-browse-input-box").val().trim()===""&&this.browseDialog.find(".e-browse-input-box").val(this.fileOrURLPath),this.addBtnEnableDisable(!0))},n.prototype.cancelBtnClick=function(){this.ejCustomDialog.close();this.resetBrowseFields();this.resetUrlFields()},n.prototype.resetBrowseFields=function(){this.filePath.val("");this.browseDialog.find(".e-custom-image").hide();this.browseDialog.find(".e-default-image").show()},n.prototype.resetUrlFields=function(){this.urlTextBox.val("");this.urlTextRow.find(".e-custom-image").hide();this.urlTextRow.find(".e-default-image").show()},n.prototype.setImageDataAttribute=function(){this.isImageElement||this.isMarkerImageElement?(this.parentDrpDwn.attr("data-image-type",this.selectedImageType),this.parentDrpDwn.attr("data-image-value",this.fileOrURLPath)):this.isBackgroundImageElement?(this.parentDrpDwn.attr("data-background-image-type",this.selectedImageType),this.parentDrpDwn.attr("data-background-image-value",this.fileOrURLPath)):(this.parentDrpDwn.attr("data-type",this.selectedImageType),this.parentDrpDwn.attr("data-value",this.fileOrURLPath))},n.prototype.saveBtnClick=function(){var u,n,f,t,i,r;this.parentDrpDwn.attr("icon-type","custom");this.setImageDataAttribute();this.selectedImageType===ImageType[ImageType.URL]?this.resetBrowseFields():this.resetUrlFields();this.isImageElement||this.isBackgroundImageElement||this.isMarkerImageElement?(this.parentDrpDwn.find(".bbi-color-custom-default-icon").css("display","none"),u=this.parentDrpDwn.find(".bbi-color-custom-image-element"),u.attr("src",this.selectedImageType===ImageType[ImageType.Embedded]?BoldBIDashboard.Dashboard.Resource.getImage(this.fileOrURLPath):this.fileOrURLPath),this.parentDrpDwn.find(".bbi-color-custom-image").css("display","block")):(this.bbdesigner$(this.parentDrpDwn[0].parentElement).find("#"+this.parentDrpDwn[0].parentElement.id+"_selectedIcon").length>0&&this.bbdesigner$(this.parentDrpDwn[0].parentElement).find("#"+this.parentDrpDwn[0].parentElement.id+"_selectedIcon").remove(),this.bbdesigner$(this.parentDrpDwn).css({display:"none"}),n=BoldBIDashboard.buildTag("span","",{},{id:this.parentDrpDwn[0].parentElement.id+"_selectedIcon"}),f=BoldBIDashboard.buildTag("div",this.locale.colorCustomAdvanceLocale.customBtnText,{"text-align":"left","padding-left":"0.857em"},{"class":"e-input e-selectedIcon"}),n.append(f),this.bbdesigner$(n).insertBefore(this.parentDrpDwn),t=this.bbdesigner$(this.parentDrpDwn[0]).parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),i=t.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(i)||(i.disable(),t.parents(".bbi-condition-icon-colorpicker-wrap").css("display","none"),r=this.parentDrpDwn.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(r)||r.option("width","120px")));this.selectedImageType===ImageType[ImageType.Embedded]&&this.storeImageDetails();this.ejCustomDialog.close()},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationCustomDialog",InternalColorCustomizationCustomDialog,window);InternalColorPicker=function(){function n(n){this.dashboardDesigner=null;this.callMethod="";this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.wireEvents()}return n.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click",".e-range-color",this.bbdesigner$.proxy(this.onColorPickerOpen,this));this.dashboardDesigner.element.on("focusout",".e-color-textbox",this.bbdesigner$.proxy(this.onColorTextFocus,this))},n.prototype.unwireEvents=function(){this.dashboardDesigner.element.off("click",".e-range-color",this.bbdesigner$.proxy(this.onColorPickerOpen,this));this.dashboardDesigner.element.off("focusout",".e-color-textbox",this.bbdesigner$.proxy(this.onColorTextFocus,this))},n.prototype.renderColorPicker=function(n,t,i){var r,u,f,e,o;this.callInstance=t;this.callMethod=i;r=n.attr("id");u=n.attr("data-color");BoldBIDashboard.isNullOrUndefined(u)||u===""?this.bbdesigner$(n).attr("data-color","#278787"):this.bbdesigner$(n).attr("data-color",u);f="";f=this.bbdesigner$(n).attr("data-color");n.css({height:"24px",width:"104px",border:"1px solid #B3B3B3","border-radius":"4px",display:"inline-block"});e="<input id="+r+"_colorTextBox class='e-color-textbox' data-id="+r+" style='height:14px;width:70px;float:left;margin:4px;border: 0px;background:transparent;outline:unset;' value="+f+"><\/input><div id="+r+"_color class='e-range-color' data-id="+r+" style='height:14px;width:14px;background: "+f+";float:right;margin: 4px;border-radius: 4px;'><\/div>";o="<div id="+r+"_colorPicker class='e-color-picker' style='height:254px;width:246px;position:absolute;border:1px solid #FFFFFF;box-shadow: 0 4px 6px 0 rgba(0,0,0,0.16);display:none;background:#FFFFFF;'><div id="+r+"_colorPalette data-id="+r+" style='height:256px;width:154px;margin-left: 7px;display:block'><\/div><\/div>";this.bbdesigner$(n).append(e).append(o);this.bbdesigner$(n).find("#"+r+"_colorPalette").BoldBIDashboardColorPicker({value:this.bbdesigner$(n).attr("data-color"),displayInline:!0,modelType:"picker",change:this.bbdesigner$.proxy(this.onColorChange,this,n)})},n.prototype.onColorChange=function(n,t){var r=this.bbdesigner$(n).find(".e-color-textbox").val(),i=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA);BoldBIDashboard.isNullOrUndefined(i)||(i=i.toLocaleUpperCase());this.bbdesigner$(n).attr({"data-color":i,"data-type":"Flat"});BoldBIDashboard.isNullOrUndefined(this.callInstance)||BoldBIDashboard.isNullOrUndefined(this.callMethod)||(r!==i?this.bbdesigner$(n).parent().attr({"data-modified":!0}):BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(n).parent().attr("data-modified"))||this.bbdesigner$(n).parent().removeAttr("data-modified"),BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod))},n.prototype.onColorPickerOpen=function(n){var t=this.bbdesigner$(n.target).attr("data-id")||this.bbdesigner$(n.target).attr("id");this.bbdesigner$("#"+t+"_colorPicker").css("display")==="none"?this.bbdesigner$("#"+t+"_colorPicker").css("display","block"):this.bbdesigner$("#"+t+"_colorPicker").css("display","none");this.setColorPalettePosition(t);n.stopPropagation();this.bbdesigner$(document).on("click","body",this.bbdesigner$.proxy(this.onColorPickerClose,this,t))},n.prototype.setColorPalettePosition=function(n){var t=this.bbdesigner$("#"+n),i=this.bbdesigner$("#"+n+"_colorPicker"),r=t.offset(),h=this.bbdesigner$(document).scrollTop()+this.bbdesigner$(window).height()-(r.top+this.bbdesigner$(t).outerHeight()),c=r.top-this.bbdesigner$(document).scrollTop(),f=i.outerHeight(),e=i.outerWidth(),u=r.left,o=t.outerHeight(),l=(o-t.height())/2,s=3,a=this.getZindexPartial(t,i),v=(f<h||f>c?r.top+o+s:r.top-f-s)-l,y=this.bbdesigner$(document).scrollLeft()+this.bbdesigner$(window).width()-u;e>y&&e<u+t.outerWidth()&&(u-=i.outerWidth()-t.outerWidth());i.css({left:u+"px",top:v+"px","z-index":a})},n.prototype.getZindexPartial=function(n,t){var i,r=this.bbdesigner$,f,u;if(!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0)return f=n.parents(),u=r("body").children(),!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0&&u.splice(u.index(t),1),r(u).each(function(n,t){f.push(t)}),i=Math.max.apply(i,r.map(f,function(n){if(r(n).css("position")!=="static")return parseInt(r(n).css("z-index"))||1})),!i||i<1e4?i=1e4:i+=1,i},n.prototype.onColorPickerClose=function(n,t){var r=this.bbdesigner$("#"+n),i;this.bbdesigner$(t.target).parents(".e-color-picker").length===0&&(this.bbdesigner$("#"+n+"_colorPicker").css("display","none"),i="",i=this.bbdesigner$(r).attr("data-color"),this.bbdesigner$("#"+n+"_color").css("background",i),BoldBIDashboard.isNullOrUndefined(i)?this.bbdesigner$(r).find(".e-color-textbox").val(i):this.bbdesigner$(r).find(".e-color-textbox").val(i.toLocaleUpperCase()),r.css("border","1px solid #B3B3B3"))},n.prototype.onColorTextFocus=function(n){var t=this.dashboardDesigner.element.find("#"+this.bbdesigner$(n.target).attr("data-id")),i=this.dashboardDesigner.element.find("#"+this.bbdesigner$(n.target).attr("data-id")+"_colorPalette").data("BoldBIDashboardColorPicker"),r=/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.bbdesigner$(n.target).val());r?(t.css("border","1px solid #B3B3B3"),t.find(".e-range-color").css("background",this.bbdesigner$(n.target).val()),i.setModel({value:this.bbdesigner$(n.target).val()})):t.css("border","1px solid #FF0000")},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorPicker",InternalColorPicker,window);InternalColorCustomizationInclusionSelection=function(){function n(n){this.waterMarkText="Search";this.listFieldName="text";this.ajaxRequestCollection=[];this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id}return n.prototype.resetMultiSelection=function(n){this.dashboardDesigner.element.find("#"+n+"_popup_container").length>0&&(this.dashboardDesigner.element.find("#"+n+"_popup_container").remove(),this.multiSelectionComboBox.find("#"+n+"_multi_select_dropDown_text").empty())},n.prototype.renderMultiSelectionComboBox=function(n,t,i){this.resetMultiSelection(t);this.multiSelectionComboBox=BoldBIDashboard.buildTag("div.bbi-multiselect-dropdown-item","",{width:n.width(),height:"28px",cursor:"pointer","background-color":"white",display:"block",border:"1px solid #B3B3B3","border-radius":"4px","box-sizing":"border-box","box-shadow":"rgba(0, 0, 0, 0.0745098) 0px 1px 1px inset"},{id:t+"_multi_select_dropDown"});var u=this.locale.colorCustomAdvanceLocale.selectAny,f=BoldBIDashboard.buildTag("div",u,{"border-style":"none",width:n.width()-46,height:"100%","line-height":"24px",float:"left","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","font-size":"12px","padding-left":".857em"},{id:t+"_multi_select_dropDown_text"}),r=BoldBIDashboard.buildTag("div","",{display:"inline-block",width:"33px",height:"100%"},{}),e=BoldBIDashboard.buildTag("span.bbi-designer-ejwidgets-updown e-icon e-arrow-sans-down","",{color:"#666666",padding:"8px 10px"});r.append(e);this.multiSelectionComboBox.append(f).append(r);this.multiSelectionComboBox.bind("click",this.bbdesigner$.proxy(this.showPopupContainer,this,n,t,i));n.append(this.multiSelectionComboBox);this.renderPopupContainer(t)},n.prototype.renderPopupContainer=function(n){var i,t,r,u;this.popupContainer=BoldBIDashboard.buildTag("div.e-multiselect-popup-container boldbi-dashboarddesigner","",{"min-width":"245px",height:"270px",position:"absolute",border:"1px solid #dddddd","background-color":"white","border-radius":"3px",display:"none","z-index":"10100"},{id:n+"_popup_container"});i=BoldBIDashboard.buildTag("div","",{},{});this.renderSearchPanel(i,n);t=BoldBIDashboard.buildTag("div.e-multiselect-waiting-popup","",{height:"188px","background-color":"white","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box","z-index":"1010",padding:"5px 10px"},{id:n+"_popup_container_list_Box_div"});r=BoldBIDashboard.buildTag("ul","",{},{id:n+"_popup_container_list_Box"});t.append(r);var f=BoldBIDashboard.buildTag("div.e-footerbar.e-dialog.e-js","",{width:"100%",height:"45px","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",padding:"10px 5px"},{}),e=BoldBIDashboard.buildTag("input.bbi-dbrd-designer-hand-cursor","",{float:"right"},{id:n+"_popup_container_ok_btn"}),o=BoldBIDashboard.buildTag("input.bbi-dbrd-designer-hand-cursor","",{float:"right"},{id:n+"_popup_container_cancel_btn"});f.append(o).append(e);this.popupContainer.append(i).append(t).append(f);this.dashboardDesigner.element.append(this.popupContainer);u=this.locale.dialogOptions;e.BoldBIDashboardButton({showRoundedCorner:!1,size:"mini",cssClass:"bbi-designer-okbtn",text:u.applyButtonText,click:this.bbdesigner$.proxy(this.updatePopupContainerInformation,this,n)});o.BoldBIDashboardButton({showRoundedCorner:!1,size:"mini",cssClass:"bbi-designer-cancelbtn",text:u.cancelButtonText,click:this.bbdesigner$.proxy(this.closePopupContainer,this,n)});r.BoldBIDashboardListBox({dataSource:[{text:""}],fields:{value:this.listFieldName},showCheckbox:!0,width:"100%",height:"100%",cssClass:"bbi-dbrd-control"});t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()})},n.prototype.renderSearchPanel=function(n,t){var i=BoldBIDashboard.buildTag("div","",{width:"225px",height:"16px",padding:"10px"},{id:t+"_popup_container_searchPanel"}),r=BoldBIDashboard.buildTag("input.bbi-designer-fieldcontainer-search-dataassign","",{width:"218px","font-style":"italic"},{id:t+"_popup_container_searchBox"}),u;r.val(this.waterMarkText);u=BoldBIDashboard.buildTag("div","",{width:"24px",height:"15px","margin-top":"-16px",float:"right",color:"lightgray",cursor:"pointer"},{id:t+"_popup_container_searchIcon","class":"e-icon e-search"});i.append(r);i.append(u);n.append(i);r.bind("focus",this.bbdesigner$.proxy(this.onSearchFocus,this,t))},n.prototype.showPopupContainer=function(n,t,i){var o=this.getMultiSelectionComboBox(t),c=o.attr("data-fieldValue"),u=o.attr("data-fieldText"),r=this.getPopupContainer(t),l=this.getPopupListBox(t),a=l.data("BoldBIDashboardListBox"),v=r.css("display")==="block",f=n.offset(),s=f.left+parseFloat(n.css("padding-left")),e,h;n.width()<245&&(s=f.left+parseFloat(n.css("padding-left"))-(246-n.width()));r.css({left:s,top:f.top+n.height()+2,display:v?"none":"block","z-index":BoldBIDashboard.getMaxZindex()});this.updateDropDownIcon(r,t);e=this.getPopupListBoxDiv(t);r.css("display")==="block"?(BoldBIDashboard.isNullOrUndefined(e.attr("data-fieldText"))||e.attr("data-fieldText")!==u?(h=[{Id:c,Name:u,SummaryType:"None",FieldType:"Dimensions"}],this.ajaxRequestCollection.push(this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getData,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getData,fieldInfo:h,dataSetId:i,filterType:"InitialFilter",isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.setFieldInformation,this,t,u),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this,t),this.bbdesigner$.proxy(this.hideLoadingIndicator,this,t)]}))):this.setPopupValues(t),n.find(".e-multiselect-popup-container-visible").length>0&&this.updatePopupContainerVisibility(n.find(".e-multiselect-popup-container-visible")),r.addClass("e-multiselect-popup-container-visible")):(r.removeClass("e-multiselect-popup-container-visible"),this.hideLoadingIndicator(t));a._refreshScroller()},n.prototype.getDataSource=function(n){for(var i=function(t){n[t][Object.keys(n[t])]=Object.keys(n[t].valueOf()).map(function(i){return n[t].valueOf()[i].toString()})},t=0;t<n.length;t++)i(t);return n},n.prototype.setFieldInformation=function(n,t,i){var r=JSON.parse(i.jsonData),u,f,e;if(!BoldBIDashboard.isNullOrUndefined(r)&&r.length>0){u=this.getPopupListBox(n).data("BoldBIDashboardListBox");for(f in r[0])this.listFieldName=f;r=this.getDataSource(r);u.setModel({dataSource:r,fields:{value:this.listFieldName}});e=this.getPopupListBoxDiv(n);e.attr("data-fieldText",t);this.setPopupValues(n)}},n.prototype.setPopupValues=function(n){var i=this.getPopupListBox(n),t=i.data("BoldBIDashboardListBox");!BoldBIDashboard.isNullOrUndefined(i.data("Filters"))&&t.listitems.length>i.data("Filters").length?(t.checkItemsByIndices(this.getCheckedItemIndices(t.listitems,i.data("Filters"))),this.setItemEnable(n,!0)):(this.setItemEnable(n,!1),t.unCheckAll(),t.setModel({checkChange:this.bbdesigner$.proxy(this.updateListItemCheckChange,this,n)}))},n.prototype.getCheckedItemIndices=function(n,t){for(var r=[],i=0;i<n.length;i++)t.indexOf(n[i][this.listFieldName].toString())!==-1&&r.push(i);return r},n.prototype.showLoadingIndicator=function(n){this.getPopupListBoxDiv(n).BoldBIDashboardWaitingPopup("show");this.setItemEnable(n,!1);this.getPopupSearchPanel(n).children().prop("disabled",!0)},n.prototype.hideLoadingIndicator=function(n){this.getPopupListBoxDiv(n).BoldBIDashboardWaitingPopup("hide");this.setItemEnable(n,!0);this.getPopupSearchPanel(n).children().prop("disabled",!1)},n.prototype.onSearchFocus=function(n){var i=this.getPopupSearchPanel(n),t=this.getSearchTextBox(i,n);t.addClass("e-focus");t.val()===this.waterMarkText&&t.val("");t.css("color","grey");t.bind("keyup",this.bbdesigner$.proxy(this.onSearchText,this,n));t.bind("blur",this.bbdesigner$.proxy(this.onSearchBlur,this,n));this.getSearchIcon(i,n).bind("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this,n))},n.prototype.onSearchText=function(n,t){var r=this.getPopupSearchPanel(n),f;if(t.keyCode!==13){var e=this.getSearchTextBox(r,n),u=e.val(),i=this.getPopupListBox(n);u.length>0?(this.getSearchIcon(r,n).addClass("e-close_01").removeClass("e-search"),f=this.filterItems(i.data("BoldBIDashboardListBox").model.dataSource,u,n),i.BoldBIDashboardListBox("hideAllItems"),i.BoldBIDashboardListBox("showItemsByIndices",f)):i.BoldBIDashboardListBox("showAllItems")}},n.prototype.onSearchBlur=function(n){var i=this.getPopupSearchPanel(n),t=this.getSearchTextBox(i,n),r=t.val();t.removeClass("e-focus");r.length===0&&this.clearSearchText(i,n,t)},n.prototype.clearSearchText=function(n,t,i){this.getSearchIcon(n,t).addClass("e-search").removeClass("e-close_01");i.val(this.waterMarkText);this.getPopupListBox(t).BoldBIDashboardListBox("showAllItems");i.css("color","lightgrey")},n.prototype.onSearchCloseClick=function(n){var i=this.getPopupSearchPanel(n),t=this.getSearchTextBox(i,n),r=this.getSearchIcon(i,n);t.removeClass("e-focus");t.val(this.waterMarkText);t.css("color","lightgrey");this.getPopupListBox(n).BoldBIDashboardListBox("showAllItems");r.addClass("e-search").removeClass("e-close_01");t.unbind("keyup",this.bbdesigner$.proxy(this.onSearchText,this));r.unbind("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this));t.unbind("blur",this.bbdesigner$.proxy(this.onSearchBlur,this))},n.prototype.filterItems=function(n,t){for(var r=[],i=0;i<n.length;i++)(t===""||n[i][this.listFieldName][0].toLowerCase().startsWith(t.toLowerCase()))&&r.push(i);return r},n.prototype.updateListItemCheckChange=function(n,t){if(t.isInteraction){var i=this.getPopupListBox(n).data("BoldBIDashboardListBox");i.getCheckedItems().length<1?this.setItemEnable(n,!1):this.setItemEnable(n,!0)}},n.prototype.setItemEnable=function(n,t){var i=this.getPopupOkButton(n);BoldBIDashboard.DashboardUtil.buttonEnable(i,t)},n.prototype.updatePopupContainerInformation=function(n){var i;this.clearSearchList(n);var t=this.getPopupContainer(n),u=this.getComboBoxTextField(n),r=this.getPopupListBox(n),f=r.data("BoldBIDashboardListBox");t.css("display","none");this.updateDropDownIcon(t,n);i=this.getListBoxCheckedItems(n);u.text(i.toString());r.data("Filters",i);this.bbdesigner$("#"+n).find(".e-error-tip").css("display","none");t.removeClass("e-multiselect-popup-container-visible")},n.prototype.clearSearchList=function(n){var i=this.getPopupSearchPanel(n),t=this.getSearchTextBox(i,n),r=t.val();r.length!==0&&r!==this.waterMarkText&&(t.removeClass("e-focus"),this.clearSearchText(i,n,t))},n.prototype.closePopupContainer=function(n){var t,i;this.clearSearchList(n);t=this.getPopupContainer(n);t.css("display","none");t.removeClass("e-multiselect-popup-container-visible");this.updateDropDownIcon(t,n);i=this.getPopupListBoxDiv(n).data("BoldBIDashboardWaitingPopup");i.model.showOnInit&&this.killPendingRequest()},n.prototype.killPendingRequest=function(){if(this.ajaxRequestCollection.length>0)for(var n=0;n<this.ajaxRequestCollection.length;n++)this.ajaxRequestCollection[n].readyState<4&&this.ajaxRequestCollection[n].abort();this.ajaxRequestCollection=[]},n.prototype.getListBoxCheckedItems=function(n){for(var i=[],r=this.getPopupListBox(n).data("BoldBIDashboardListBox").getCheckedItems(),t=0;t<r.length;t++)i.push(r[t].text);return i},n.prototype.updatePopupContainerVisibility=function(n){if(!BoldBIDashboard.isNullOrUndefined(n)&&n.length>0){n.css("display","none");var t=n.attr("id").replace(/_popup_container/g,"");this.updateDropDownIcon(n,t)}},n.prototype.updateDropDownIcon=function(n,t){var i=this.getMultiSelectionComboBox(t);n.css("display")==="block"?i.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-down").addClass("e-arrow-sans-up"):i.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-up").addClass("e-arrow-sans-down")},n.prototype.getMultiSelectionComboBox=function(n){return this.bbdesigner$("#"+n+"_multi_select_dropDown")},n.prototype.getComboBoxTextField=function(n){return this.multiSelectionComboBox.find("#"+n+"_multi_select_dropDown_text")},n.prototype.getPopupContainer=function(n){return this.bbdesigner$("#"+n+"_popup_container")},n.prototype.getPopupListBoxDiv=function(n){return this.popupContainer.find("#"+n+"_popup_container_list_Box_div")},n.prototype.getPopupSearchPanel=function(n){return this.popupContainer.find("#"+n+"_popup_container_searchPanel")},n.prototype.getSearchTextBox=function(n,t){return n.find("#"+t+"_popup_container_searchBox")},n.prototype.getSearchIcon=function(n,t){return n.find("#"+t+"_popup_container_searchIcon")},n.prototype.getPopupListBox=function(n){return this.popupContainer.find("#"+n+"_popup_container_list_Box")},n.prototype.getPopupOkButton=function(n){return this.popupContainer.find("#"+n+"_popup_container_ok_btn")},n.prototype.getPopupCancelButton=function(n){return this.popupContainer.find("#"+n+"_popup_container_cancel_btn")},n.prototype.resetMultiSelectionComboInfo=function(n){var t=this.getComboBoxTextField(n),i=this.getPopupListBox(n);t.text(this.locale.colorCustomAdvanceLocale.selectAny);i.data("Filters",null)},n.prototype.setListboxFilters=function(n,t){var i=this.getPopupListBox(n);i.data("Filters",t)},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationInclusionSelection",InternalColorCustomizationInclusionSelection,window);InternalColorCustomizationBasicSettings=function(){function n(n){this.dashboardDesigner=null;this.basicSettingsDialog=null;this.basicSettingsContainer=null;this.basicSettingsScrollElement=null;this.basicSettingsValuesWrapper=null;this.dataGroupInfo=null;this.selectedColumnName="";this.resetButton=null;this.defaultColorPalette=["#77A7FB","#E57368","#FBCB43","#34B67A","#F1AB68","#6CC2D9","#195962","#E18878","#1AA27D","#BFAAC7","#89695e","#a5c77f","#f48fb1","#90caf9","#cc4452"];this.okButton=null;this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.propertyPanel=this.dashboardDesigner.modules.propertyPanel;this.colorPicker=this.dashboardDesigner.modules.colorPicker;this.id=this.dashboardDesigner._id;this.renderBasicSettingsWindow()}return n.prototype.renderBasicSettingsWindow=function(){var i=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_legend_settings"}),n=this.basicSettingsContainer=BoldBIDashboard.buildTag("div.e-basic-settings-dialog-container bbi-userselect bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_basic_settings_container"}),u=this.basicSettingsValuesWrapper=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_basicSettings_Columns_Div"}),s=this.basicSettingsScrollElement=BoldBIDashboard.buildTag("div.e-basic-settings-colorElements","",{},{id:this.id+"_basic_settings_colorValue_elements"}),o;u.append(s);n.append(u);var f=BoldBIDashboard.buildTag("button.e-basic-settings-button bbi-dbrd-btn-smalll bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{},{id:this.id+"_basic_settings_cancel",type:"button"}),e=this.okButton=BoldBIDashboard.buildTag("button.e-basic-settings-button bbi-dbrd-btn-smalll bbi-dbrd-btn-primary",this.locale.dialogOptions.applyButtonText,{},{id:this.id+"_basic_settings_ok",type:"button"}),r=this.resetButton=BoldBIDashboard.buildTag("button.e-basic-settings-reset-button disabled bbi-dbrd-designer-hand-cursor",this.locale.dialogOptions.resetButtonText,{},{id:this.id+"_basic_color_settings_reset",type:"button"}),t=this.locale.dialogOptions;r.attr("data-tooltip",t.resetButtonTooltip);i.append(n);this.dashboardDesigner.element.append(i);this.basicSettingsDialog=i.BoldBIDashboardDialog({title:"Column: "+this.selectedColumnName,width:"auto",height:"auto",minWidth:450,minHeight:420,enableAnimation:!1,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:this.dashboardDesigner._id,target:this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.cancelBtnClick,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog");o=this.dashboardDesigner.element.find("#"+this.id+"_legend_settings_foot");o.append(r).append(f).append(e);e.BoldBIDashboardButton({text:t.applyButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-okbtn",size:"mini",click:this.bbdesigner$.proxy(this.saveBasicSettings,this)});f.BoldBIDashboardButton({text:t.cancelButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-cancelbtn",size:"mini",click:this.bbdesigner$.proxy(this.closeBasicSettingsDialog,this)});r.BoldBIDashboardButton({text:t.resetButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-reset-btn",size:"mini",click:this.bbdesigner$.proxy(this.resetBasicSettings,this)});this.ejWaitingIndicator=n.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup");n.BoldBIDashboardScroller({height:"380px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize});this.scrollerObj=n.data("BoldBIDashboardScroller");BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh();BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1);BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1)},n.prototype.saveBasicSettings=function(){var r=this.bbdesigner$(this.basicSettingsScrollElement).children(),n=null,i,t;if(!BoldBIDashboard.isNullOrUndefined(r)&&(n=r.filter("[data-modified]"),!BoldBIDashboard.isNullOrUndefined(n))){for(i=[],t=0;t<n.length;t++){var u=this.bbdesigner$(n[t]).find(".e-basic-settings-column-name"),f=this.bbdesigner$(n[t]).find(".e-basic-settings-column-value"),e=BoldBIDashboard.isNullOrUndefined(u)?"":u.text(),o=BoldBIDashboard.isNullOrUndefined(f)?"":f.attr("data-color");i.push({Name:e,Color:o.toLocaleUpperCase(),IsEdited:!0})}this.internalDefaultModeObj.DefaultColors=i}this.cancelBtnClick()},n.prototype.closeBasicSettingsDialog=function(){this.basicSettingsDialog.close();BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalDefaultModeObj,this.selectedColumn]);!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator()},n.prototype.resetBasicSettings=function(){var n=this;this.resetValues();this.showLoadingIndicator();setTimeout(function(){try{n.getColumnValues(n.selectedColumn,!0)}catch(t){n.dashboardDesigner.designerPanel.logError({Source:"resetBasicSettings",Error:t,Type:t.name});n.hideLoadingIndicator()}},100)},n.prototype.getSelectedColumnName=function(){var f=this,i=this.dataGroupInfo,t,n,r,e,u;if(!BoldBIDashboard.isNullOrUndefined(i.Values)&&i.Values.length>0)for(t=i.Values,n=0;n<t.length;n++)for(r=0;r<t[n].Values.length;r++)e=t[n].Values,u=e.filter(function(n){return n.DataId===f.selectedColumn.Key&&n.UniqueColumnName===f.selectedColumn.UniqueColumnName})[0],BoldBIDashboard.isNullOrUndefined(u)||(this.selectedColumnName=u.Field,this.basicSettingsDialog.setTitle("Column: "+this.selectedColumnName))},n.prototype.renderRowElement=function(n,t,i){var e=this.dashboardDesigner.element.find("#"+this.id+"_basic_settings_container").width(),u=BoldBIDashboard.buildTag("div.bbi-basic-settings-column-row-element","",{},{id:this.id+"_basic_settings_column_Label"+i}),o=BoldBIDashboard.buildTag("div.e-basic-settings-column-name-element","",{width:(e-30)*62/100+"px"}),r=BoldBIDashboard.buildTag("div.e-basic-settings-column-name bbi-designer-fontfamily bbi-dbrd-designer-hoverable","",{"max-width":(e-30)*62/100-15+"px"},{id:this.id+"_basic_settings_column_Label_Name"+i}),f;r.text(t.Name);o.append(r);u.append(o);r.addClass(BoldBIDashboard.DashboardUtil.isExistTextWidth(r,!0)?"e-title-tip":"");r.hasClass("e-title-tip")&&r.attr("data-tooltip",t.Name);f=BoldBIDashboard.buildTag("div.e-basic-settings-column-value","",{},{id:this.id+"_basic_settings_column_Label_Value"+i});f.attr("data-color",t.Color);this.colorPicker.renderColorPicker(f,this,"enableSaveButton");u.append(f);!BoldBIDashboard.isNullOrUndefined(t.IsEdited)&&t.IsEdited&&this.bbdesigner$(u).attr({"data-modified":!0});n.append(u)},n.prototype.populateColumns=function(n,t){var f=[],u,r,i;for(this.dashboardDesigner.modules.resource.updateColorCodeInfo(t),u=JSON.parse(t.Values),i=0;i<u.length;i++)r=!BoldBIDashboard.isNullOrUndefined(this.internalDefaultModeObj)&&this.internalDefaultModeObj.DefaultColors.length>0&&!BoldBIDashboard.isNullOrUndefined(this.internalDefaultModeObj.DefaultColors[i])?this.internalDefaultModeObj.DefaultColors[i].Name===u[i][this.selectedColumn.UniqueColumnName]?this.internalDefaultModeObj.DefaultColors[i]:null:null,f.push({Name:!n&&!BoldBIDashboard.isNullOrUndefined(r)?r.Name:u[i][this.selectedColumn.UniqueColumnName],IsEdited:!n&&!BoldBIDashboard.isNullOrUndefined(r)?r.IsEdited:!1,Color:!n&&!BoldBIDashboard.isNullOrUndefined(r)?r.Color:this.defaultColorPalette[i%this.defaultColorPalette.length]});for(i=0;i<f.length;i++)this.renderRowElement(this.basicSettingsScrollElement,f[i],i);this.basicSettingsValuesWrapper.append(this.basicSettingsScrollElement);this.basicSettingsContainer.append(this.basicSettingsValuesWrapper);BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0);BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh();this.hideLoadingIndicator();this.dashboardDesigner.modules.serialization.notifyChange()},n.prototype.enableSaveButton=function(){var n=this.bbdesigner$(this.basicSettingsScrollElement).children(),t=null;BoldBIDashboard.isNullOrUndefined(n)?BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1):(t=n.filter("[data-modified]"),BoldBIDashboard.isNullOrUndefined(t)?BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!0))},n.prototype.cancelBtnClick=function(){this.basicSettingsDialog.close();BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalDefaultModeObj,this.selectedColumn]);!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator();this.bbdesigner$(".e-color-picker").remove()},n.prototype.getColumnValues=function(n,t){var u,f,e,r,o,s,i;if(BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1),u=[],f=this.dataGroupInfo,!BoldBIDashboard.isNullOrUndefined(f.Values)&&f.Values.length>0)for(e=f.Values,r=0;r<e.length;r++)for(o=0;o<e[r].Values.length;o++)if(s=e[r].Values,i=s.filter(function(t){return t.DataId===n.Key&&t.UniqueColumnName===n.UniqueColumnName})[0],!BoldBIDashboard.isNullOrUndefined(i)){u.push({Id:i.DataId,Name:i.Field,SummaryType:i.SummaryType,Sorting:i.Sorting,CustomSorting:i.CustomSorting,FieldType:i.FieldType,MeasureFormatting:i.MeasureFormatting,DateTimeFormat:i.DateTimeFormat,FilterInfo:i.FilterInfo,UniqueColumnName:i.UniqueColumnName,IsKPIColumn:i.IsKPIColumn,KPIColumnInfo:i.KPIColumnInfo,IsExpression:i.IsExpression,IsAggregatedExpression:i.IsAggregatedExpression});break}this.selectedColumnName=u[0].Name;this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnValues,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.WidgetAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnValues,dataset:this.dataGroupInfo.DatasetId,fieldInfo:u})},{fnction:this.bbdesigner$.proxy(this.populateColumns,this,t)},!0)},n.prototype.showLoadingIndicator=function(){this.ejWaitingIndicator&&this.ejWaitingIndicator.show()},n.prototype.hideLoadingIndicator=function(){this.ejWaitingIndicator&&this.ejWaitingIndicator.hide()},n.prototype.openBasicSettingSDialog=function(n,t,i,r){var u=this;this.resetValues();this.targetInstance=n;this.targetMethod=t;this.selectedColumn=i.selectedColumn;this.colorFields=i.colorFields;this.dsId=i.selectedColumn.Key;this.dataGroupInfo=r;this.internalDefaultModeObj=this.bbdesigner$.extend(!0,{},i.defaultColorSettings);this.basicSettingsDialog.open();this.getSelectedColumnName();this.showLoadingIndicator();setTimeout(function(){try{u.getColumnValues(u.selectedColumn,!1)}catch(n){u.dashboardDesigner.designerPanel.logError({Source:"openBasicSettingSDialog",Error:n,Type:n.name});u.hideLoadingIndicator()}},100)},n.prototype.resetValues=function(){this.basicSettingsContainer.empty();this.basicSettingsScrollElement.empty()},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationBasicSettings",InternalColorCustomizationBasicSettings,window),function(n){var t=function(){function t(n){this.locale=null;this.designerInst=n;this.id=this.designerInst._id;this.bbdesigner$=this.designerInst.bbdesigner$;this.locale=this.designerInst.getLocalizationContent();this.propertyPanel=this.designerInst.modules.propertyPanel;this.widgetHelper=this.designerInst.modules.widgetHelper}return t.prototype.render=function(t,i,r){var v,s,g,h,nt;this.categoryId=this.designerInst._id+"_"+i+"_"+r.category;var c=this.propertyPanel.propertyPanelContainer.width(),f=this.designerInst.element.find("#"+this.categoryId),l=r.value,u=null,a=null;if(f.length===0&&t){f=n.buildTag("div","",{width:c-10},{id:this.categoryId});var y=n.buildTag("table.e-designer-exp-table","",{width:"100%"},{unselectable:"on"}),e=n.buildTag("tr","",{height:"28px"},{}),o=n.buildTag("td","",{width:(c-47)*47/100+"px"},{}),p=n.buildTag("td","",{},{}),tt=n.buildTag("label.e-designer-fontfamily e-designer-linking-table-row","Enable",{},{id:this.categoryId+"_wdgt_link_text_ckb","for":this.categoryId+"_wdgt_link_ckb"}),w=n.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_link_ckb",type:"checkbox"});u=n.buildTag("ul","",{},{id:this.categoryId+"_wdgt_link_list"});var b=n.buildTag("div","",{height:"auto","min-height":"50px","border-radius":"5px",margin:"7px 3px 7px 10px"},{id:this.categoryId+"_wdgt_link_actions"}),it=n.buildTag("div.e-designer-actions-info bbi-dbrd-designer-hoverable","",{margin:"9px",float:"left","font-size":"12px"},{"data-tooltip":this.locale.propertyPanel.interWidgetLinking.defaultInterWidgetLinking}),k=n.buildTag("div","",{},{}),d=n.buildTag("span.e-designer-fontfamily","",{overflow:"hidden","font-size":"13px",display:"inline-block","font-weight":600,margin:"7px 3px 7px 10px",float:"left"});a=n.buildTag("input.e-textbox e-designer-fontfamily","",{position:"relative","margin-top":"10px",border:"0px"},{id:this.categoryId+"_wdgt_link_actions_custom_txt"});v=n.buildTag("div","",{display:"none"},{id:this.categoryId+"_wdgt_link_custom_input_container"});v.append(a);b.append(k,v);p.append(w);y.append(e.clone().append(o.clone().append(tt),p),e.clone().append(o.clone().append(d.clone().html("Widgets"))),e.clone().append(o.clone().attr("colspan",2).append(u)),e.clone().append(o.clone().append(d.clone().html("Actions")).append(it)),e.clone().append(o.clone().attr("colspan",2).append(b)));f.append(y);t.append(f);s=[];s.push({isChecked:!1,label:"Custom",value:"custom",id:this.categoryId+"_wdgt_link_actions_custom"});s.unshift({isChecked:!0,label:"Default",value:"default",id:this.categoryId+"_wdgt_link_actions_default"});g={callBackMethod:"onActionRadioClick",callBackInstance:this,dataSource:s,optionalArgs:this.categoryId,labelPosition:n.Dashboard.LabelPosition.After,groupName:this.categoryId+"_wdgt_link_actions",triggerOnCodeUpdate:!0};this.actionRadio=new n.Dashboard.RadioButton(g,k);this.actionRadio.disableAllItems(!0);w.BoldBIDashboardCheckBox({width:(c-33)*57/100-15+"px",change:this.bbdesigner$.proxy(this.onEnableChkbxClick,this),cssClass:"e-designer-prop-checkbox"});this.tabListInst=u.BoldBIDashboardListBox({dataSource:[],enabled:!1,fields:{text:"widgetJson.ContainerSettings.Title",value:"Name"},showRoundedCorner:!0,cssClass:"e-designer-param-assign e-designer-border e-designer-list-selection e-dbrd-designer-scroller e-dbrd-control",width:"100%",height:"200px",template:"<span class='bbi-desgnr-inter-wdgt-list'><input class='bbi-desgnr-inter-wdgt-list-input' type='checkbox' id ='"+this.categoryId+"_wdgt_link_list${Name}'/><label>${widgetJson.ContainerSettings.Title}<\/label><\/span>",select:this.bbdesigner$.proxy(this.onTabItemSelect,this),selectedIndex:0}).data("BoldBIDashboardListBox");a.ejNumericTextbox({value:1,minValue:1,width:"160px",showRoundedCorner:!0,showSpinButton:!1,change:this.bbdesigner$.proxy(this.itemNameChange,this)})}if(f.length>0){if(f.css("display",n.isNullOrUndefined(r.isVisible)?"block":r.isVisible?"block":"none"),h=this.designerInst.modules.widgetHelper.getAllWidgets().filter(function(t){return t instanceof n.ContainerWidget&&t.hasMultipleRegion}),this.tabListInst=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_list").data("BoldBIDashboardListBox"),this.tabListInst.option("dataSource",[]),this.tabListInst.option("dataSource",h),n.isNullOrUndefined(u)&&(u=f.find("#"+this.categoryId+"_wdgt_link_list")),h.length>0&&!n.isNullOrUndefined(u)){u.off("click",".bbi-desgnr-inter-wdgt-list-input",this.bbdesigner$.proxy(this.onTabItemChecked,this));u.on("click",".bbi-desgnr-inter-wdgt-list-input",this.bbdesigner$.proxy(this.onTabItemChecked,this))}n.isNullOrUndefined(l)?(this.linkItem=this.populateLinkModel(r),this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:this.linkItem.value.Enable})):(this.linkItem=r,this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:l.Enable}),this.updateSelectedWidgets(u,l,h));r.value.WidgetList.length===0&&(this.actionRadio.disableAllItems(!0),this.actionRadio.updateItemByValue("default",!0),nt=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_custom_input_container"),nt.hide())}},t.prototype.itemNameChange=function(n){if(n.isInteraction){var t=this.tabListInst.getSelectedItems()[0].data.Name,i=this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(t));this.linkItem.value.WidgetList[i].CustomIndex=n.value;this.updateWidgetProperty(this.linkItem)}},t.prototype.updateSelectedWidgets=function(n,t,i){var u=[],r;for(i.forEach(function(n){return u.push(n.Name)}),r=0;r<t.WidgetList.length;r++)n.find("#"+this.categoryId+"_wdgt_link_list"+t.WidgetList[r].Widget).prop("checked",!0);t.WidgetList.length>0&&(r=u.indexOf(t.WidgetList[0].Widget),this.tabListInst.setModel({selectedIndex:r}),this.updateRadioButton(t.WidgetList[0]),this.updateCustomIndex(t.WidgetList[0],!0))},t.prototype.updateRadioButton=function(n){n.LinkType===WidgetLinkType.Custom?(this.actionRadio.updateItemByValue("custom",!0),this.linkItem.renderDefault&&this.actionRadio.updateItemByValue("default",!1)):(this.actionRadio.updateItemByValue("custom",!1),this.linkItem.renderDefault&&this.actionRadio.updateItemByValue("default",!0))},t.prototype.updateCustomIndex=function(n,t){var r=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_custom_input_container"),i=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_actions_custom_txt").data("ejNumericTextbox");n.LinkType===WidgetLinkType.Custom?t?(r.show(),i.option("value",n.CustomIndex),this.updateMaxCustom(i)):r.hide():(r.hide(),i.option("value",""),this.updateMaxCustom(i))},t.prototype.updateMaxCustom=function(t){if(this.tabListInst.getSelectedItems().length>0){var i=this.tabListInst.getSelectedItems()[0].data.Name,r=this.designerInst.modules.widgetHelper.getAllWidgets().filter(function(t){return t instanceof n.ContainerWidget&&t.hasMultipleRegion}),u=r.filter(function(n){return n.Name===i})[0],f=this.designerInst.modules.containerTypeWidgetHelper.getWidgetAsContainerWidget(u).getContainerRegions();t.option("maxValue",f)}},t.prototype.onActionRadioClick=function(n){var t=this.tabListInst.getSelectedItems()[0].data.Name,i=this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(t));this.linkItem.value.WidgetList[i].LinkType=n.args.value==="custom"?WidgetLinkType.Custom:WidgetLinkType.Default;this.updateCustomIndex(this.getSelectedLinkWidget(),!0);this.updateWidgetProperty(this.linkItem)},t.prototype.onTabItemChecked=function(n){var u=this.bbdesigner$(n.currentTarget).is(":checked"),r=this.tabListInst.getSelectedItems()[0].data.Name,t=new LinkedWidgetList,i=this.linkItem;u?(t.Widget=r,this.linkItem.renderDefault||(t.LinkType=WidgetLinkType.Custom,t.CustomIndex="1"),i.value.WidgetList.push(t)):i.value.WidgetList.splice(this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(r)),1);this.updateWidgetProperty(i);this.linkItem.value=i.value},t.prototype.onTabItemSelect=function(n){var t,i;n.isInteraction&&(t=!1,n.item.find("input[type=checkbox]").is(":checked")?(this.actionRadio.disableAllItems(!1),this.linkItem.renderDefault||this.actionRadio.disableByValue("default",!0),t=!0):this.actionRadio.disableAllItems(!0),i=this.getSelectedLinkWidget(),this.updateRadioButton(i),this.updateCustomIndex(i,t))},t.prototype.getSelectedLinkWidget=function(){var t=new LinkedWidgetList,r=this.tabListInst.getSelectedItems()[0].data.Name,i;return(t.Widget=r,this.linkItem.value.WidgetList.length>0&&(i=this.getActiveWidgetList(t.Widget),!n.isNullOrUndefined(i)))?i:(this.linkItem.renderDefault||(t.LinkType=WidgetLinkType.Custom,t.CustomIndex="1"),t)},t.prototype.getActiveWidgetList=function(n){for(var t=0;t<this.linkItem.value.WidgetList.length;t++)if(n===this.linkItem.value.WidgetList[t].Widget)return this.linkItem.value.WidgetList[t];return null},t.prototype.onEnableChkbxClick=function(n){if(n.isChecked){if(n.isInteraction){var t=this.populateLinkModel(JSON.parse(JSON.stringify(this.linkItem)));t.value.Enable=n.isChecked;this.updateWidgetProperty(t);this.linkItem.value=t.value;this.refreshWidget()}this.actionRadio.disableAllItems(!1);this.tabListInst.enable()}else this.tabListInst.disable(),this.actionRadio.disableAllItems(!0)},t.prototype.updateWidgetProperty=function(n){var t=this.widgetHelper.getCurrentWidgetInstance();t.restoreActiveTab(t);t.updateWidgetLink(n.value);this.designerInst.modules.serialization.notifyChange()},t.prototype.populateLinkModel=function(n){return n.value=this.createDashboardLinks(),n},t.prototype.createDashboardLinks=function(){return{WidgetList:[],Enable:!1}},t.prototype.refreshWidget=function(){},t}();n.InterWidgetLink=t}(BoldBIDashboard||(BoldBIDashboard={})),function(n){var t=function(){function t(t,i,r){this.itemPanelWidth=240;this.dataPanelWidth=36;this.id=t;this.element=i;this.designer=r;r.widgetHelper=r.modules.widgetHelper;r.cacheManager=new InternalCacheManager(r);BoldBIDashboardDesigner.editManager=this.designer.modules.undoManager;new n.DashboardDesignerUtility.OAuthHelper(this.designer)}return t.prototype.render=function(t){this.designerContainer=n.buildTag("div.bbi-dashboard-designer boldbi-dashboarddesigner","",{height:"100%","box-sizing":"border-box"},{id:this.id+"_designerContainer"});var i=this.designAreaTag=n.buildTag("div.bbi-dashboard-designer bbi-userselect bbi-dashboarddesigner-designAreaContainer","",{},{id:this.id+"_designAreaContainer"}),r=this.itemPanelTag=n.buildTag("div.bbi-dbrd-designer-item-panel","",{width:this.itemPanelWidth+"px"},{id:this.id+"_itemPanelContainer"}),u=this.designPanelTag=n.buildTag("div.bbi-dashboarddesigner-surfaceContainer","",{width:t,border:"0px solid var(--designer-primary-border-color)","border-left-width":"1px",height:"100%",float:"left","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground(),"box-sizing":"border-box"},{id:this.id+"_designSurfaceContainer"}),f=this.dataPanelTag=n.buildTag("div","",{width:this.dataPanelWidth+"px",height:"100%",float:"right","box-sizing":"border-box","background-color":"white"},{id:this.id+"_dataPanelContainer"});this.element.append(this.designerContainer);this.renderToolBar(this.designerContainer,t);i.append(r,u,f);this.designerContainer.append(i);this.setContainerSize(this.designer.toolbarTag);this.getWidgetInfo(this.itemPanelTag,this.designer);this.updateDataConfigurationPanel()},t.prototype.postRender=function(){},t.prototype.getWidgetInfo=function(t,i){n.isNullOrUndefined(i.model.serviceAuthorizationToken)||i.model.serviceAuthorizationToken===""||i.model.environment===n.DashboardDesignerUtility.Serialization.enumToString(n.Environment,n.Environment.cloud)?this.renderItemPanel(this.itemPanelTag,"{}"):i.modules.util.doAjaxPost("GET",i.model.serviceUrl+n.Dashboard.ServiceAPI.widgetsettings,{},{fnction:this.designer.bbdesigner$.proxy(this.renderItemPanel,this,t)},!0)},t.prototype.setContainerSize=function(t){var s=this.element.height(),r=this.element.width(),u=0,f=0,e=0;n.isNullOrUndefined(t)||(u=t.height(),f=parseFloat(t.css("border-top-width")),e=parseFloat(t.css("border-bottom-width")));var h=parseFloat(this.designAreaTag.css("border-top-width")),c=parseFloat(this.designAreaTag.css("border-bottom-width")),l=parseFloat(this.designAreaTag.css("border-left-width")),a=parseFloat(this.designAreaTag.css("border-right-width")),o=s-u-(f+e),i=o-(c+h),v=this.itemPanelTag.width(),y=this.dataPanelTag.width(),p=r-(v+y);this.designAreaTag.css({height:o+"px",width:r+"px"});this.itemPanelTag.height(i);this.dataPanelTag.height(i);this.designPanelTag.css({height:i+"px",width:p-(l+a)+"px"})},t.prototype.renderCanvas=function(){this.designCanvas=n.buildTag("div.bbi-dashboarddesigner-designcanvas","",{"box-sizing":"border-box",position:"relative",margin:"0 auto"},{id:this.id+"_designCanvas",tabindex:"0"});this.canvasContainer=n.buildTag("div.bbi-dbrd-designcanvas-container bbi-dbrd-designcanvas-scroller","",{width:"100%",height:"100%",overflow:"auto","box-sizing":"border-box","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground()},{id:this.id+"_scrollContentDesignPanel"});this.helperItem=n.buildTag("div","",{border:"1px solid #cccccc","background-color":"transparent",position:"absolute",display:"none","z-index":"1002","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_helperItem"});this.placingItem=n.buildTag("div.bbi-placing-cell","",{border:"1px solid #179bd7","background-color":"rgba(210, 239, 247, 0.6)",position:"absolute",display:"none","z-index":"1001","pointer-events":"none","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_placingItem",row:"0",column:"0"});this.scrollUIItem=n.buildTag("div.bbi-dbrd-scroll-ui-container","",{},{});this.designCanvas.append(this.helperItem,this.placingItem);this.canvasContainer.append(this.designCanvas);this.designer.model.designerSettings.widgetsPanel.dragAndDropSettings.isWidgetMode||this.canvasContainer.append(this.scrollUIItem)},t.prototype.renderCells=function(){this.designer.designerPanel.updateDesignCanvasSize();this.designer.designerPanel.updateCanvasItemSize();this.designer.designerPanel.renderCellItems(0,this.designer.designerPanel.rowsLength*this.designer.designerPanel.columnsLength);this.designer.designerPanel.updateScrollBar();this.scrollUIItem[0].innerHTML=this.getAddRowsIcon()},t.prototype.renderToolBar=function(t,i){this.designer.rptToolbar=new n.DashboardDesignerUtility.Toolbar(this.designer,t);this.designer.rptToolbar.renderToolBar(t,40,i)},t.prototype.renderItemPanel=function(t,i){this.designer.model.widgetGuids=i!=="{}"?JSON.parse(JSON.parse(i).WidgetIds):[];this.designer.dragDropHelper=new n.DashboardDesignerUtility.DragdropHelper(this.designer);this.designer.itemPanel=new n.DashboardDesignerUtility.ItemPanel(this.designer,t)},t.prototype.updateDataConfigurationPanel=function(){this.designer.dataConfigurationPanel=this.designer.modules.dataConfigurationPanel},t.prototype.getAddRowsIcon=function(){var t=Boolean(n.DashboardUtil.getCookie("syncfusion.dashboard.designer.scrollinfo")),i=t?"bbi-dbrd-scroll-icon-container":"bbi-dbrd-scroll-icon-container e-scroll-dbrd-init";return"<div class='"+i+"'><div class='bbi-dbrd-scroll-icon-bg-line-container'><div class ='bbi-dbrd-scroll-icon-bg-line'><\/div><\/div><div class='bbi-dbrd-scroll-plus-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable'><div class= 'bbi-dbrd-designer-hoverable-icon' data-tooltip='Add/Delete Rows'><\/div><\/div><\/div>"},t.prototype.renderCellsForExport=function(){},t.prototype.previewDashboard=function(){},t.prototype.updateSizeForScrollExport=function(){},t.prototype.resizeCombineWidgetForWidgetExport=function(){},t.prototype.wireEvents=function(){this.designer.element.on("mouseover",".bbi-dbrditem",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onWidgetMouseOver,this));this.designer.element.on("mouseleave",".bbi-dbrditem",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onWidgetMouseLeave,this));this.designer.element.on("mousedown",".bbi-combine-item",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onCombineWidgetClick,this));this.designer.element.on("click",".bbi-dbrd-view-data-export-menu-icon",this.designer.bbdesigner$.proxy(this.designer.viewDataPanel.viewDataExport,this.designer))},t.prototype.unwireEvents=function(){this.designer.element.off("mouseover",".bbi-dbrditem",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onWidgetMouseOver,this));this.designer.element.off("mouseleave",".bbi-dbrditem",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onWidgetMouseLeave,this));this.designer.element.off("mousedown",".bbi-combine-item",this.designer.bbdesigner$.proxy(n.Dashboard.WidgetContainerHelper.onCombineWidgetClick,this));n.isNullOrUndefined(this.designer.viewDataPanel)||this.designer.element.off("click",".bbi-dbrd-view-data-export-menu-icon",this.designer.bbdesigner$.proxy(this.designer.viewDataPanel.viewDataExport,this.designer))},t}();n.DesignMode=t}(BoldBIDashboard||(BoldBIDashboard={}));InternalRefreshDialog=function(){function n(n){this.dashboardDesigner=null;this.footerTag=null;this.refreshSetting=null;this.ejListBoxObj=null;this.locale=null;this.dashboardDesigner=n;this.bbdesigner$=this.dashboardDesigner.bbdesigner$;this.locale=n.getLocalizationContent();this.id=this.dashboardDesigner._id;this.widgetHelper=this.dashboardDesigner.modules.widgetHelper;this.dashboardDesigner.isDesignMode()&&this.renderContainer()}return n.prototype.addIcon=function(){var n=this.dashboardDesigner.isHelpLinkHidden()?"":"<a href='"+this.dashboardDesigner.getHelpDocLink("RefreshDashboard")+"' target='_blank' class ='bbi-dbrd-refresh-widget-interval-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip ='"+this.locale.scrollableLayout.knowmore+"'><\/a>";this.refreshContainer.find(".bbi-dbrd-radio-btn-wrapper").children(".e-radio-wrapper").eq(1).append(n)},n.prototype.renderContainer=function(){var s=BoldBIDashboard.buildTag("div.bbi-dbrd-dyn-con-switch-wrap","",{},{id:this.id+"_auto_refresh_switch"}),e,o,at,i,vt,yt,pt,wt,bt;this.refreshContainer=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_refresh_Container"});var n=BoldBIDashboard.buildTag("div.bbi-autorefresh-container bbi-autorefresh-disabled"),t=BoldBIDashboard.buildTag("div.bbi-refresh-container","",{width:"498px",height:"416px","padding-left":"20px","padding-right":"14px","padding-top":"7px","padding-bottom":"7px"},{id:this.id+"_containerDiv"}),r=BoldBIDashboard.buildTag("div","",{});t.append(r);var h=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),c=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),l=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),a=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),v=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),y=BoldBIDashboard.buildTag("div.bbi-dbrd-filter-dlg-mode-btn-wrapper","",{},{id:this.id+"_filter_btn_wrapper"}),kt=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.enbaleAutoRefresh,{"font-size":"13px","margin-left":"5px"},{"for":this.id+"_autoCheckBox",type:"label"});l.append(s);a.append(y);v.append(kt);h.append(v,l);c.append(a);r.append(h);n.append(c);t.append(r);var p=BoldBIDashboard.buildTag("div","",{}),w=BoldBIDashboard.buildTag("div","",{"padding-bottom":"8px",display:"flex","flex-direction":"row","padding-left":"32px"},{colspan:"2"}),b=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-numericcheckbox left-align","",{float:"left","margin-left":"31px",width:"98px",height:"24px",color:"var(--primary-text-normal-color)"},{id:this.id+"_timeCheckBox"}),dt=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","HH:mm:ss",{"font-size":"13px",display:"flex","align-items":"center","padding-left":"10px"},{type:"label"});w.append(b).append(dt);p.append(w);n.append(p);t.append(n);var k=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),d=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),g=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),nt=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-refreshcheckbox","",{},{id:this.id+"_refreshCheckBox"}),gt=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.refreshWidget,{"font-size":"13px","margin-left":"5px"},{"for":this.id+"_refreshCheckBox",id:this.id+"_refreshLabel",type:"label"});d.append(nt);g.append(gt);k.append(d).append(g);n.append(k);t.append(n);var tt=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_listRow"}),it=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"42px"},{colspan:"2"}),rt=BoldBIDashboard.buildTag("div.bbi-designer-inputPath","",{width:"100%",height:"140px",border:"1px unset"},{id:this.id+"_listBox"}),u=BoldBIDashboard.buildTag("ul","",{},{id:this.id+"_refresh_setting_list_Box"});rt.append(u);it.append(rt);tt.append(it);n.append(tt);t.append(n);var ut=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),ft=BoldBIDashboard.buildTag("div","",{"padding-top":"24px","padding-bottom":"8px"}),et=BoldBIDashboard.buildTag("div","",{"padding-top":"24px","padding-bottom":"8px"}),ot=BoldBIDashboard.buildTag("input.bbi-designer-inputPath","",{},{id:this.id+"_insertCheckBox"}),ni=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.rowInsertDelete,{"font-size":"13px","margin-left":"5px"},{"for":this.id+"_insertCheckBox",id:this.id+"_insertLabel",type:"label"});ft.append(ot);et.append(ni);ut.append(ft).append(et);n.append(ut);t.append(n);var st=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),ht=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),f=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),ct=BoldBIDashboard.buildTag("input.e-reportdesigner-inputPath-loading","",{},{id:this.id+"_insertLoadingCheckBox"}),ti=BoldBIDashboard.buildTag("Label.e-designer-fontfamily",this.locale.refreshWindow.removeLoader,{"font-size":"13px","margin-left":"5px"},{"for":this.id+"_insertLoadingCheckBox",id:this.id+"_insertLoadingLabel",type:"label"}),lt=BoldBIDashboard.buildTag("div.e-dbrd-autorefresh-description bbi-dbrd-designer-hoverable","",{"padding-left":"5px","padding-top":"2px",cursor:"pointer",float:"right"},{"data-tooltip":this.locale.refreshWindow.removeLoaderDescription}),ii=BoldBIDashboard.buildTag("span.e-dbrd-autorefresh-notifyicon bbi-designer-notifyinfo","",{});lt.append(ii);f.append(lt);ht.append(ct);f.append(ti);st.append(ht,f);n.append(st);t.append(n);e=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right",height:"28px","margin-right":"10px"},{id:this.id+"_apply_btn",type:"button"});o=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor bbi-dbrd-btn-secondary",this.locale.dialogOptions.cancelButtonText,{float:"right",height:"28px"},{id:this.id+"_cancel_btn",type:"button"});this.refreshContainer.append(t);this.dashboardDesigner.element.append(this.refreshContainer);this.refreshContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:498,minHeight:380,title:this.locale.refreshWindow.title,enableResize:!1,showOnInit:!1,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-ejdialog boldbi-dashboarddesigner",enableModal:!0,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText});this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_refresh_Container_foot");this.footerTag.append(o).append(e);at={callBackInstance:this,callBackMethod:"autoRefreshCheck",checkState:!1,optionalArgs:this.id,name:"auto-refresh-switch",cssClass:"bbi-refresh-switch"};this.defaultSwitch=new BoldBIDashboard.Dashboard.SwitchButton(at,s);i=new Date;i.setHours(0,0,1);vt={cssClass:"bbi-dbrd-control bbi-common-timer bbi-dbrd-timer",format:"HH:mm:ss",min:i,value:i,width:"120px",showClearButton:!1,strictMode:!0,change:this.bbdesigner$.proxy(this.onTimePickerChange,this)};this.commonTimer=new ejdashboard.calendars.TimePicker(vt);this.commonTimer.appendTo("#"+b.attr("Id"));yt={size:"small",checked:!1,disabled:!0,change:this.bbdesigner$.proxy(this.listItemEnable,this)};this.refereshWidget=BoldBIDashboard.DashboardUtil.createCheckbox(yt,nt[0]);BoldBIDashboard.DashboardUtil.InjectCheckBoxInListBoxEJ2();pt={cssClass:"bbi-dashboarddesigner bbi-designer-param-assign bbi-refresh-listbox bbi-designer-border bbi-dbrd-control bbi-designer-box-shadow",height:"186px",dataSource:[],enabled:!1,itemTemplate:"<div class= 'bbi-refresh-container bbi-dbrd-designer-hoverable' data-tooltip = '${text}'>${text}<\/div>",selectionSettings:{showCheckbox:!0,mode:"Multiple"},change:this.bbdesigner$.proxy(this.listBoxSelection,this)};this.listBox=new ejdashboard.dropdowns.ListBox(pt);this.listBox.appendTo("#"+u.attr("Id"));this.ejListBoxObj=u.data("BoldBIDashboardListBox");wt={checked:!1,disabled:!0};this.rowInfo=BoldBIDashboard.DashboardUtil.createCheckbox(wt,ot[0]);bt={checked:!1,disabled:!0};this.loadingInfo=BoldBIDashboard.DashboardUtil.createCheckbox(bt,ct[0]);o.on("click",this.bbdesigner$.proxy(this.closeRefreshSetting,this));e.on("click",this.bbdesigner$.proxy(this.applyRefreshSetting,this));this.createRadioBtnSection(y);this.addIcon()},n.prototype.listBoxSelection=function(n){var t,f,r,e,u,i,o;BoldBIDashboard.isNullOrUndefined(n)||BoldBIDashboard.isNullOrUndefined(n.event.target)||(t=this.bbdesigner$(n.event.target),f=t.hasClass("bbi-refresh-list-timer")||t.parents(".bbi-refresh-list-timer").length>0,f?(i=this.bbdesigner$(t.parents(".e-list-item")[0]).attr("data-value"),r=[],r.push(i),BoldBIDashboard.isNullOrUndefined(n.value)||(this.isValueSelected(n.value,i)?this.listBox.selectItems(r,!1):this.listBox.selectItems(r,!0))):(e=this.refreshContainer.find("#"+this.id+"_auto_refresh_widget_rdo_input").prop("checked"),e&&(t.hasClass("e-list-item")===!1&&(u=t.parents(".e-list-item"),BoldBIDashboard.isNullOrUndefined(u)||(t=u)),!BoldBIDashboard.isNullOrUndefined(n.value)&&t.hasClass("e-list-item")&&(i=t.attr("data-value"),this.isValueSelected(n.value,i)?t.find(".bbi-refresh-list-timer").removeClass("bbi-refresh-timer-hidden"):t.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden")))));o=n},n.prototype.isValueSelected=function(n,t){return n.filter(function(n){return n==t}).length>0},n.prototype.createRadioBtnSection=function(n){var t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_btn_grp"}),i;n.append(t);i={callBackInstance:this,callBackMethod:"updateRefreshType",groupName:"refresh",triggerOnCodeUpdate:!0,labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_auto_refresh_dashboard",label:this.locale.refreshWindow.commonTimeInterval,isChecked:!0,value:"default"},{id:this.id+"_auto_refresh_widget",label:this.locale.refreshWindow.differentTimeInterval,isChecked:!1,value:"custom"}]};this.radioBtn=new BoldBIDashboard.Dashboard.RadioButton(i,t)},n.prototype.updateRefreshType=function(n){var t,i;BoldBIDashboard.isNullOrUndefined(n.args)||BoldBIDashboard.isNullOrUndefined(n.args.name)||BoldBIDashboard.isNullOrUndefined(n.args.value)||n.args.name==="change"&&(n.args.value==="custom"?(this.isWidgetTimer=!0,this.commonTimer.enabled=!1,this.refereshWidget.disabled=!0,this.enableListBox(),this.enableTimerOnSwitch()):(this.isWidgetTimer=!1,this.commonTimer.enabled=!0,this.refreshContainer.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden"),this.refereshWidget.disabled=!1,t=this.refereshWidget.checked,t?this.enableListBox():this.disableListBox()));i=n},n.prototype.enableTimerOnSwitch=function(){for(var t=this.listBox.getSelectedItems(),n=0;n<t.length;n++)this.bbdesigner$(t[n]).find(".bbi-refresh-list-timer").removeClass("bbi-refresh-timer-hidden")},n.prototype.updateAutoRefreshSwitch=function(n){var t=this.getDynamicConnectionSwitch();BoldBIDashboard.isNullOrUndefined(t)||t.updateValueByName("auto-refresh-switch",n)},n.prototype.getDynamicConnectionSwitch=function(){return this.dashboardDesigner.element.find("#"+this.id+"_auto_refresh_switch").data("DesignerPropertyWidget")},n.prototype.openRefreshDialog=function(n,t){n.widgetCollection=BoldBIDashboard.isNullOrUndefined(n.widgetCollection)?[]:n.widgetCollection;this.refreshContainer.BoldBIDashboardDialog("open");this.resetUIElements();n.enableAutoRefresh||(n.interval="00:00:30");this.refreshSetting=n;this.callBackfn=t;this.populateRefreshInfo(this.refreshSetting);this.validateCheckedElement()},n.prototype.renderTimerInListBox=function(){var t=[],u,n,i,r,s;for(t=this.refreshContainer.find(".e-list-item").toArray(),u=this.listBox.getDataByElems(this.listBox.getItems()),n=0;n<t.length;n++){var f=this.bbdesigner$(t[n]),e=this.getItemIdFromText(u,f.attr("data-value")),o=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-numericcheckbox left-align","",{float:"right","margin-left":"31px",width:"98px",height:"24px"},{id:this.id+"_refresh_list_timer_"+e,widgetId:e});f.append(o);i=new Date;i.setHours(0,0,1);r=new Date;r.setHours(0,0,30);s=new ejdashboard.calendars.TimePicker({cssClass:"bbi-dbrd-control bbi-dbrd-timer bbi-refresh-list-timer bbi-refresh-timer-hidden",format:"HH:mm:ss",min:i,value:r,width:"120px",showClearButton:!1,strictMode:!0});s.appendTo("#"+o.attr("Id"))}},n.prototype.getItemIdFromText=function(n,t){for(var i=0;i<n.length;i++)if(n[i].text===t)return n[i].id},n.prototype.getItemTextFromText=function(n,t){for(var i=0;i<n.length;i++)if(n[i].id===t)return n[i].text},n.prototype.validateCheckedElement=function(){for(var t,i=this.listBox.dataSource,n=0;n<i.length;n++)for(t=0;t<this.refreshSetting.widgetCollection.length;t++)this.refreshSetting.widgetCollection[t].widgetID===i[n].widgetID&&this.ejListBoxObj.checkItemByIndex(n)},n.prototype.closeRefreshSetting=function(){this.refreshContainer.BoldBIDashboardDialog("close")},n.prototype.resetUIElements=function(){this.refreshSetting=null},n.prototype.applyRefreshSetting=function(){var n=this.getRefreshValue();n&&n.__type&&delete n.__type;n!==null&&this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.notifypropertychange,{action:BoldBIDashboard.DashboardUtil.DesignerAction.NotifyPropertyChange,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.refreshsettings,refreshJson:n})},{fnction:this.bbdesigner$.proxy(function(n){n.Status||console.info(n.Message)},this)});BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,n);this.closeRefreshSetting()},n.prototype.getRefreshValue=function(){var e=this.defaultSwitch.getState()==="on",r,u,t,n,i,f;for(this.refreshSetting.enableAutoRefresh=e,r=this.refereshWidget.checked,this.refreshSetting.isRefreshWidget=r,u=this.getTime(this.commonTimer),this.refreshSetting.interval=u,t=this.listBox.getDataByElems(this.listBox.getSelectedItems()),this.refreshSetting.widgetCollection=[],this.refreshSetting.isWidgetTimer=this.isWidgetTimer,n=0;n<t.length;n++)i={widgetID:t[n].id,widgetName:t[n].text},i.widgetInterval=this.getTimeForWidget(i.widgetID),this.refreshSetting.widgetCollection.push(i);return f=this.rowInfo.checked,this.refreshSetting.isRefreshRowCount=f,this.refreshSetting.removeLoader=Boolean(this.loadingInfo.checked),this.refreshSetting},n.prototype.getTimeForWidget=function(n){return this.getTime(this.getTimerComponent(n))},n.prototype.getTimerComponent=function(n){return ejdashboard.base.getComponent(this.refreshContainer.find("#"+this.id+"_refresh_list_timer_"+n)[0],"timepicker")},n.prototype.getTime=function(n){var t=n.value.getHours(),i=n.value.getMinutes(),r=n.value.getSeconds();return t+":"+i+":"+r},n.prototype.getAllWidgets=function(){var n=[];return this.widgetHelper.getAllWidgets().forEach(function(t){t.Type==="Label"||BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(t)||n.push(t)}),n},n.prototype.getWidgetCollection=function(){for(var t,i=[],r=this.getAllWidgets(),n=0;n<r.length;n++)t=r[n].getJson(),i.push({widgetName:t.ContainerSettings.Title,widgetID:t.UniqueName});return i},n.prototype.getWidgetCollectionData=function(){for(var t,i=[],r=this.getAllWidgets(),n=0;n<r.length;n++)t=r[n].getJson(),i.push({text:t.ContainerSettings.Title,id:t.UniqueName});return i},n.prototype.populateRefreshInfo=function(n){n.enableAutoRefresh?(this.refreshContainer.find(".bbi-autorefresh-container").removeClass("bbi-autorefresh-disabled"),this.enableAutoRefresh()):(this.refreshContainer.find(".bbi-autorefresh-container").addClass("bbi-autorefresh-disabled"),this.disableAutoRefresh());this.isWidgetTimer=n.isWidgetTimer;this.updateAutoRefreshSwitch(n.enableAutoRefresh);this.rowInfo.checked=n.isRefreshRowCount;this.updateWidgetList();this.updateListBox(n.widgetCollection,n.isWidgetTimer);this.updateDataToTimer(n.interval,this.commonTimer);this.refereshWidget.checked=n.isRefreshWidget;this.refereshWidget.checked||this.isWidgetTimer?this.enableListBox():this.disableListBox();this.loadingInfo.checked=n.removeLoader;n.isWidgetTimer?(this.refereshWidget.disabled=!0,this.radioBtn.updateItemByValue("default",!1),this.radioBtn.updateItemByValue("custom",!0)):(this.refereshWidget.disabled=!1,this.radioBtn.updateItemByValue("default",!0),this.radioBtn.updateItemByValue("custom",!1),this.refreshContainer.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden"))},n.prototype.updateListBox=function(n,t){for(var u,r=[],i=0;i<n.length;i++)r.push(this.getItemTextFromText(this.listBox.getDataByElems(this.listBox.getItems()),n[i].widgetID)),t&&(this.bbdesigner$(this.refreshContainer.find("#"+this.id+"_refresh_list_timer_"+n[i].widgetID).parents(".bbi-refresh-list-timer")).removeClass("bbi-refresh-timer-hidden"),u=this.getTimerComponent(n[i].widgetID),this.updateDataToTimer(n[i].widgetInterval,u));this.listBox.selectItems(r,!0)},n.prototype.updateDataToTimer=function(n,t){var i=n.split(":"),u=Number(i[0]),f=Number(i[1]),e=Number(i[2]),r=new Date;r.setHours(u,f,e);t.value=r},n.prototype.updateWidgetList=function(){this.listBox.listData=[];this.listBox.refresh();this.listBox.addItem(this.getWidgetCollectionData());this.renderTimerInListBox()},n.prototype.autoRefreshCheck=function(n){if(n.args.checked){this.enableAutoRefresh();var t=this.refereshWidget.checked;t?this.enableListBox():this.disableListBox()}else this.disableAutoRefresh()},n.prototype.enableAutoRefresh=function(){var t,n;this.refreshContainer.find(".bbi-autorefresh-container").removeClass("bbi-autorefresh-disabled");this.refreshContainer.find("#"+this.id+"_insertLabel").css("opacity","1").removeAttr("disabled");this.refreshContainer.find("#"+this.id+"_refreshLabel").css("opacity","1").removeAttr("disabled");this.refereshWidget.disabled=!1;this.rowInfo.disabled=!1;t=this.refereshWidget.checked;t===!0&&(this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","1").removeAttr("disabled"),n=this.refreshContainer.find("#"+this.id+"_refresh_setting_list_Box").data("BoldBIDashboardListBox"),BoldBIDashboard.isNullOrUndefined(n)||n.enable());this.refreshContainer.find("#"+this.id+"_insertLoadingLabel").css("opacity","1").removeAttr("disabled");this.loadingInfo.disabled=!1},n.prototype.disableAutoRefresh=function(){this.refreshContainer.find(".bbi-autorefresh-container").addClass("bbi-autorefresh-disabled");this.refereshWidget.disabled=!0;this.rowInfo.disabled=!0;this.refreshContainer.find("#"+this.id+"_insertLabel").css("opacity","0.5").attr("disabled","disabled");this.refreshContainer.find("#"+this.id+"_refreshLabel").css("opacity","0.5").attr("disabled","disabled");this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","0.5").attr("disabled","disabled");this.disableListBox();this.loadingInfo.disabled=!0;this.refreshContainer.find("#"+this.id+"_insertLoadingLabel").css("opacity","0.5").attr("disabled","disabled")},n.prototype.validateRefreshWidget=function(n){var t=this.refreshSetting;BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(t.widgetCollection)||(t.widgetCollection.filter(function(i,r){i.widgetName===n&&t.widgetCollection.splice(r,1)}),this.validateCheckedElement(),this.applyRefreshSetting(null))},n.prototype.listItemEnable=function(n){n.checked?this.enableListBox():this.disableListBox()},n.prototype.enableListBox=function(){this.listBox.enabled=!0;this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","1").removeAttr("disabled")},n.prototype.disableListBox=function(){this.listBox.enabled=!1;this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","0.5").attr("disabled","disabled")},n.prototype.onTimePickerChange=function(n){if(BoldBIDashboard.isNullOrUndefined(n.value)){var t=this.refreshContainer.find("#"+this.id+"_timeCheckBox").data("BoldBIDashboardTimePicker");t.setModel({value:t.model.minTime})}},n.prototype.updateRefreshSetting=function(n){this.dashboardDesigner.refreshSetting=n},n}();window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RefreshDialog",InternalRefreshDialog,window),function(n,t){typeof exports=="object"&&typeof module!="undefined"?module.exports=t():typeof define=="function"&&define.amd?define(t):n.CodeMirror=t()}(this,function(){"use strict";function uf(n){return new RegExp("(^|\\s)"+n+"(?:$|\\s)\\s*")}function ai(n){for(var t=n.childNodes.length;t>0;--t)n.removeChild(n.firstChild);return n}function ct(n,t){return ai(n).appendChild(t)}function i(n,t,i,r){var u=document.createElement(n),f;if(i&&(u.className=i),r&&(u.style.cssText=r),typeof t=="string")u.appendChild(document.createTextNode(t));else if(t)for(f=0;f<t.length;++f)u.appendChild(t[f]);return u}function nu(n,t,r,u){var f=i(n,t,r,u);return f.setAttribute("role","presentation"),f}function vi(n,t){if(t.nodeType==3&&(t=t.parentNode),n.contains)return n.contains(t);do if(t.nodeType==11&&(t=t.host),t==n)return!0;while(t=t.parentNode)}function fi(){var n;try{n=document.activeElement}catch(t){n=document.body||null}while(n&&n.shadowRoot&&n.shadowRoot.activeElement)n=n.shadowRoot.activeElement;return n}function tr(n,t){var i=n.className;uf(t).test(i)||(n.className+=(i?" ":"")+t)}function ys(n,t){for(var r=n.split(" "),i=0;i<r.length;i++)r[i]&&!uf(r[i]).test(t)&&(t+=" "+r[i]);return t}function ps(n){var t=Array.prototype.slice.call(arguments,1);return function(){return n.apply(null,t)}}function ir(n,t,i){t||(t={});for(var r in n)n.hasOwnProperty(r)&&(i!==!1||!t.hasOwnProperty(r))&&(t[r]=n[r]);return t}function at(n,t,i,r,u){var f,e,o;for(t==null&&(t=n.search(/[^\s\u00a0]/),t==-1&&(t=n.length)),f=r||0,e=u||0;;){if(o=n.indexOf("\t",f),o<0||o>=t)return e+(t-f);e+=o-f;e+=i-e%i;f=o+1}}function d(n,t){for(var i=0;i<n.length;++i)if(n[i]==t)return i;return-1}function ws(n,t,i){for(var r,e,u=0,f=0;;){if(r=n.indexOf("\t",u),r==-1&&(r=n.length),e=r-u,r==n.length||f+e>=t)return u+Math.min(e,t-f);if(f+=r-u,f+=i-f%i,u=r+1,f>=t)return u}}function bs(n){while(ae.length<=n)ae.push(s(ae)+" ");return ae[n]}function s(n){return n[n.length-1]}function no(n,t){for(var r=[],i=0;i<n.length;i++)r[i]=t(n[i],i);return r}function ik(n,t,i){for(var r=0,u=i(t);r<n.length&&i(n[r])<=u;)r++;n.splice(r,0,t)}function gl(){}function na(n,t){var i;return Object.create?i=Object.create(n):(gl.prototype=n,i=new gl),t&&ir(t,i),i}function ks(n){return/\w/.test(n)||n>""&&(n.toUpperCase()!=n.toLowerCase()||cb.test(n))}function to(n,t){return t?t.source.indexOf("\\w")>-1&&ks(n)?!0:t.test(n):ks(n)}function ta(n){for(var t in n)if(n.hasOwnProperty(t)&&n[t])return!1;return!0}function ds(n){return n.charCodeAt(0)>=768&&lb.test(n)}function ia(n,t,i){while((i<0?t>0:t<n.length)&&ds(n.charAt(t)))t+=i;return t}function ff(n,t,i){for(var f=t>i?-1:1,u,r;;){if(t==i)return t;if(u=(t+i)/2,r=f<0?Math.ceil(u):Math.floor(u),r==t)return n(r)?t:i;n(r)?i=r:t=r+f}}function rk(n,t,r){var u=this,f;this.input=r;u.scrollbarFiller=i("div",null,"CodeMirror-scrollbar-filler");u.scrollbarFiller.setAttribute("cm-not-content","true");u.gutterFiller=i("div",null,"CodeMirror-gutter-filler");u.gutterFiller.setAttribute("cm-not-content","true");u.lineDiv=nu("div",null,"CodeMirror-code");u.selectionDiv=i("div",null,null,"position: relative; z-index: 1");u.cursorDiv=i("div",null,"CodeMirror-cursors");u.measure=i("div",null,"CodeMirror-measure");u.lineMeasure=i("div",null,"CodeMirror-measure");u.lineSpace=nu("div",[u.measure,u.lineMeasure,u.selectionDiv,u.cursorDiv,u.lineDiv],null,"position: relative; outline: none");f=nu("div",[u.lineSpace],"CodeMirror-lines");u.mover=i("div",[f],null,"position: relative");u.sizer=i("div",[u.mover],"CodeMirror-sizer");u.sizerWidth=null;u.heightForcer=i("div",null,null,"position: absolute; height: "+nk+"px; width: 1px;");u.gutters=i("div",null,"CodeMirror-gutters");u.lineGutter=null;u.scroller=i("div",[u.sizer,u.heightForcer,u.gutters],"CodeMirror-scroll");u.scroller.setAttribute("tabIndex","-1");u.wrapper=i("div",[u.scrollbarFiller,u.gutterFiller,u.scroller],"CodeMirror");e&&l<8&&(u.gutters.style.zIndex=-1,u.scroller.style.paddingRight=0);tt||ki&&le||(u.scroller.draggable=!0);n&&(n.appendChild?n.appendChild(u.wrapper):n(u.wrapper));u.viewFrom=u.viewTo=t.first;u.reportedViewFrom=u.reportedViewTo=t.first;u.view=[];u.renderedView=null;u.externalMeasured=null;u.viewOffset=0;u.lastWrapHeight=u.lastWrapWidth=0;u.updateLineNumbers=null;u.nativeBarWidth=u.barHeight=u.barWidth=0;u.scrollbarsClipped=!1;u.lineNumWidth=u.lineNumInnerWidth=u.lineNumChars=null;u.alignWidgets=!1;u.cachedCharWidth=u.cachedTextHeight=u.cachedPaddingH=null;u.maxLine=null;u.maxLineLength=0;u.maxLineChanged=!1;u.wheelDX=u.wheelDY=u.wheelStartX=u.wheelStartY=null;u.shift=!1;u.selForContextMenu=null;u.activeTouch=null;r.init(u)}function t(n,t){var i,r,u,f;if(t-=n.first,t<0||t>=n.size)throw new Error("There is no line "+(t+n.first)+" in the document.");for(i=n;!i.lines;)for(r=0;;++r){if(u=i.children[r],f=u.chunkSize(),t<f){i=u;break}t-=f}return i.lines[t]}function rr(n,t,i){var u=[],r=t.line;return n.iter(t.line,i.line+1,function(n){var f=n.text;r==i.line&&(f=f.slice(0,i.ch));r==t.line&&(f=f.slice(t.ch));u.push(f);++r}),u}function gs(n,t,i){var r=[];return n.iter(t,i,function(n){r.push(n.text)}),r}function gt(n,t){var r=t-n.height,i;if(r)for(i=n;i;i=i.parent)i.height+=r}function h(n){var i,u,t,r;if(n.parent==null)return null;for(i=n.parent,u=d(i.lines,n),t=i.parent;t;i=t,t=t.parent)for(r=0;;++r){if(t.children[r]==i)break;u+=t.children[r].chunkSize()}return u+i.first}function ur(n,t){var f=n.first,r,u,e,i,s,o;n:do{for(r=0;r<n.children.length;++r){if(u=n.children[r],e=u.height,t<e){n=u;continue n}t-=e;f+=u.chunkSize()}return f}while(!n.lines);for(i=0;i<n.lines.length;++i){if(s=n.lines[i],o=s.height,t<o)break;t-=o}return f+i}function ef(n,t){return t>=n.first&&t<n.first+n.size}function nh(n,t){return String(n.lineNumberFormatter(t+n.firstLineNumber))}function n(t,i,r){if(r===void 0&&(r=null),!(this instanceof n))return new n(t,i,r);this.line=t;this.ch=i;this.sticky=r}function u(n,t){return n.line-t.line||n.ch-t.ch}function th(n,t){return n.sticky==t.sticky&&u(n,t)==0}function ih(t){return n(t.line,t.ch)}function io(n,t){return u(n,t)<0?t:n}function ro(n,t){return u(n,t)<0?n:t}function ra(n,t){return Math.max(n.first,Math.min(t,n.first+n.size-1))}function f(i,r){if(r.line<i.first)return n(i.first,0);var u=i.first+i.size-1;return r.line>u?n(u,t(i,u).text.length):uk(r,t(i,r.line).text.length)}function uk(t,i){var r=t.ch;return r==null||r>i?n(t.line,i):r<0?n(t.line,0):t}function ua(n,t){for(var r=[],i=0;i<t.length;i++)r[i]=f(n,t[i]);return r}function fk(){ol=!0}function ek(){hi=!0}function uo(n,t,i){this.marker=n;this.from=t;this.to=i}function of(n,t){var i,r;if(n)for(i=0;i<n.length;++i)if(r=n[i],r.marker==t)return r}function ok(n,t){for(var r,i=0;i<n.length;++i)n[i]!=t&&(r||(r=[])).push(n[i]);return r}function sk(n,t){n.markedSpans=n.markedSpans?n.markedSpans.concat([t]):[t];t.marker.attachLine(n)}function hk(n,t,i){var e,u,o;if(n)for(u=0;u<n.length;++u){var r=n[u],f=r.marker,s=r.from==null||(f.inclusiveLeft?r.from<=t:r.from<t);!s&&(r.from!=t||f.type!="bookmark"||i&&r.marker.insertLeft)||(o=r.to==null||(f.inclusiveRight?r.to>=t:r.to>t),(e||(e=[])).push(new uo(f,r.from,o?null:r.to)))}return e}function ck(n,t,i){var e,u,o;if(n)for(u=0;u<n.length;++u){var r=n[u],f=r.marker,s=r.to==null||(f.inclusiveRight?r.to>=t:r.to>t);(s||r.from==t&&f.type=="bookmark"&&(!i||r.marker.insertLeft))&&(o=r.from==null||(f.inclusiveLeft?r.from<=t:r.from<t),(e||(e=[])).push(new uo(f,o?null:r.from-t,r.to==null?null:r.to-t)))}return e}function rh(n,i){var w,b,l,o,a,v,f,tt,y,k,d,h,g;if(i.full||(w=ef(n,i.from.line)&&t(n,i.from.line).markedSpans,b=ef(n,i.to.line)&&t(n,i.to.line).markedSpans,!w&&!b))return null;var nt=i.from.ch,rt=i.to.ch,it=u(i.from,i.to)==0,r=hk(w,nt,it),e=ck(b,rt,it),c=i.text.length==1,p=s(i.text).length+(c?nt:0);if(r)for(l=0;l<r.length;++l)o=r[l],o.to==null&&(a=of(e,o.marker),a?c&&(o.to=a.to==null?null:a.to+p):o.to=nt);if(e)for(v=0;v<e.length;++v)f=e[v],f.to!=null&&(f.to+=p),f.from==null?(tt=of(r,f.marker),tt||(f.from=p,c&&(r||(r=[])).push(f))):(f.from+=p,c&&(r||(r=[])).push(f));if(r&&(r=fa(r)),e&&e!=r&&(e=fa(e)),y=[r],!c){if(k=i.text.length-2,k>0&&r)for(h=0;h<r.length;++h)r[h].to==null&&(d||(d=[])).push(new uo(r[h].marker,null,null));for(g=0;g<k;++g)y.push(d);y.push(e)}return y}function fa(n){for(var t,i=0;i<n.length;++i)t=n[i],t.from!=null&&t.from==t.to&&t.marker.clearWhenEmpty!==!1&&n.splice(i--,1);return n.length?n:null}function lk(n,t,i){var r=null,o,h,c,f,s,e;if(n.iter(t.line,i.line+1,function(n){var t,i;if(n.markedSpans)for(t=0;t<n.markedSpans.length;++t)i=n.markedSpans[t].marker,i.readOnly&&(!r||d(r,i)==-1)&&(r||(r=[])).push(i)}),!r)return null;for(o=[{from:t,to:i}],h=0;h<r.length;++h)for(c=r[h],f=c.find(0),s=0;s<o.length;++s)if(e=o[s],!(u(e.to,f.from)<0)&&!(u(e.from,f.to)>0)){var l=[s,1],a=u(e.from,f.from),v=u(e.to,f.to);(a<0||!c.inclusiveLeft&&!a)&&l.push({from:e.from,to:f.from});(v>0||!c.inclusiveRight&&!v)&&l.push({from:f.to,to:e.to});o.splice.apply(o,l);s+=l.length-3}return o}function ea(n){var i=n.markedSpans,t;if(i){for(t=0;t<i.length;++t)i[t].marker.detachLine(n);n.markedSpans=null}}function oa(n,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(n);n.markedSpans=t}}function fo(n){return n.inclusiveLeft?-1:0}function eo(n){return n.inclusiveRight?1:0}function sa(n,t){var r=n.lines.length-t.lines.length,i;if(r!=0)return r;var f=n.find(),e=t.find(),o=u(f.from,e.from)||fo(n)-fo(t);return o?-o:(i=u(f.to,e.to)||eo(n)-eo(t),i)?i:t.id-n.id}function ha(n,t){var f=hi&&n.markedSpans,r,i,u;if(f)for(i=void 0,u=0;u<f.length;++u)i=f[u],i.marker.collapsed&&(t?i.from:i.to)==null&&(!r||sa(r,i.marker)<0)&&(r=i.marker);return r}function ca(n){return ha(n,!0)}function sf(n){return ha(n,!1)}function la(n,i,r,f,e){var v=t(n,i),l=hi&&v.markedSpans,h,o;if(l)for(h=0;h<l.length;++h)if(o=l[h],o.marker.collapsed){var s=o.marker.find(0),c=u(s.from,r)||fo(o.marker)-fo(e),a=u(s.to,f)||eo(o.marker)-eo(e);if((!(c>=0)||!(a<=0))&&(!(c<=0)||!(a>=0))&&(c<=0&&(o.marker.inclusiveRight&&e.inclusiveLeft?u(s.to,r)>=0:u(s.to,r)>0)||c>=0&&(o.marker.inclusiveRight&&e.inclusiveLeft?u(s.from,f)<=0:u(s.from,f)<0)))return!0}}function ni(n){for(var t;t=ca(n);)n=t.find(-1,!0).line;return n}function ak(n){for(var t;t=sf(n);)n=t.find(1,!0).line;return n}function vk(n){for(var i,t;i=sf(n);)n=i.find(1,!0).line,(t||(t=[])).push(n);return t}function uh(n,i){var r=t(n,i),u=ni(r);return r==u?i:h(u)}function aa(n,i){if(i>n.lastLine())return i;var r=t(n,i),u;if(!fr(n,r))return i;while(u=sf(r))r=u.find(1,!0).line;return h(r)+1}function fr(n,t){var u=hi&&t.markedSpans,i,r;if(u)for(i=void 0,r=0;r<u.length;++r)if((i=u[r],i.marker.collapsed)&&(i.from==null||!i.marker.widgetNode&&i.from==0&&i.marker.inclusiveLeft&&fh(n,t,i)))return!0}function fh(n,t,i){var f,r,u;if(i.to==null)return f=i.marker.find(1,!0),fh(n,f.line,of(f.line.markedSpans,i.marker));if(i.marker.inclusiveRight&&i.to==t.text.length)return!0;for(r=void 0,u=0;u<t.markedSpans.length;++u)if(r=t.markedSpans[u],r.marker.collapsed&&!r.marker.widgetNode&&r.from==i.to&&(r.to==null||r.to!=i.from)&&(r.marker.inclusiveLeft||i.marker.inclusiveRight)&&fh(n,t,r))return!0}function ei(n){var r,t,u,e,i,f,o;for(n=ni(n),r=0,t=n.parent,u=0;u<t.lines.length;++u)if(e=t.lines[u],e==n)break;else r+=e.height;for(i=t.parent;i;t=i,i=t.parent)for(f=0;f<i.children.length;++f)if(o=i.children[f],o==t)break;else r+=o.height;return r}function oo(n){var i,r,t,u,f;if(n.height==0)return 0;for(i=n.text.length,t=n;r=ca(t);)u=r.find(0,!0),t=u.from.line,i+=u.from.ch-u.to.ch;for(t=n;r=sf(t);)f=r.find(0,!0),i-=t.text.length-f.from.ch,t=f.to.line,i+=t.text.length-f.to.ch;return i}function eh(n){var i=n.display,r=n.doc;i.maxLine=t(r,r.first);i.maxLineLength=oo(i.maxLine);i.maxLineChanged=!0;r.iter(function(n){var t=oo(n);t>i.maxLineLength&&(i.maxLineLength=t,i.maxLine=n)})}function yk(n,t,i,r){var e,f,u;if(!n)return r(t,i,"ltr",0);for(e=!1,f=0;f<n.length;++f)u=n[f],(u.from<i&&u.to>t||t==i&&u.to==t)&&(r(Math.max(u.from,t),Math.min(u.to,i),u.level==1?"rtl":"ltr",f),e=!0);e||r(t,i,"ltr")}function hf(n,t,i){var f,r,u;for(pu=null,r=0;r<n.length;++r){if(u=n[r],u.from<t&&u.to>t)return r;u.to==t&&(u.from!=u.to&&i=="before"?f=r:pu=r);u.from==t&&(u.from!=u.to&&i!="before"?f=r:pu=r)}return f!=null?f:pu}function oi(n,t){var i=n.order;return i==null&&(i=n.order=ab(n.text,t)),i}function oh(n,t){return n._handlers&&n._handlers[t]||sl}function lt(n,t,i){var u,r,f;n.removeEventListener?n.removeEventListener(t,i,!1):n.detachEvent?n.detachEvent("on"+t,i):(u=n._handlers,r=u&&u[t],r&&(f=d(r,i),f>-1&&(u[t]=r.slice(0,f).concat(r.slice(f+1)))))}function y(n,t){var r=oh(n,t),u,i;if(r.length)for(u=Array.prototype.slice.call(arguments,2),i=0;i<r.length;++i)r[i].apply(null,u)}function w(n,t,i){return typeof t=="string"&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),y(n,i||t.type,n,t),sh(t)||t.codemirrorIgnore}function va(n){var i=n._handlers&&n._handlers.cursorActivity,r,t;if(i)for(r=n.curOp.cursorActivityHandlers||(n.curOp.cursorActivityHandlers=[]),t=0;t<i.length;++t)d(r,i[t])==-1&&r.push(i[t])}function vt(n,t){return oh(n,t).length>0}function tu(n){n.prototype.on=function(n,t){r(this,n,t)};n.prototype.off=function(n,t){lt(this,n,t)}}function ft(n){n.preventDefault?n.preventDefault():n.returnValue=!1}function ya(n){n.stopPropagation?n.stopPropagation():n.cancelBubble=!0}function sh(n){return n.defaultPrevented!=null?n.defaultPrevented:n.returnValue==!1}function cf(n){ft(n);ya(n)}function hh(n){return n.target||n.srcElement}function pa(n){var t=n.which;return t==null&&(n.button&1?t=1:n.button&2?t=3:n.button&4&&(t=2)),kt&&n.ctrlKey&&t==1&&(t=3),t}function pk(n){var t,r;return hl==null&&(t=i("span","​"),ct(n,i("span",[t,document.createTextNode("x")])),n.firstChild.offsetHeight!=0&&(hl=t.offsetWidth<=1&&t.offsetHeight>2&&!(e&&l<8))),r=hl?i("span","​"):i("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px"),r.setAttribute("cm-text",""),r}function wk(n){if(cl!=null)return cl;var i=ct(n,document.createTextNode("AخA")),t=vu(i,0,1).getBoundingClientRect(),r=vu(i,1,2).getBoundingClientRect();return(ai(n),!t||t.left==t.right)?!1:cl=r.right-t.right<3}function bk(n){if(dl!=null)return dl;var t=ct(n,i("span","x")),r=t.getBoundingClientRect(),u=vu(t,0,1).getBoundingClientRect();return dl=Math.abs(r.left-u.left)>1}function kk(n,t){arguments.length>2&&(t.dependencies=Array.prototype.slice.call(arguments,2));ss[n]=t}function dk(n,t){wr[n]=t}function so(n){if(typeof n=="string"&&wr.hasOwnProperty(n))n=wr[n];else if(n&&typeof n.name=="string"&&wr.hasOwnProperty(n.name)){var t=wr[n.name];typeof t=="string"&&(t={name:t});n=na(t,n);n.name=t.name}else{if(typeof n=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(n))return so("application/xml");if(typeof n=="string"&&/^[\w\-]+\/[\w\-]+\+json$/.test(n))return so("application/json")}return typeof n=="string"?{name:n}:n||{name:"null"}}function ch(n,t){var f,i,u,r,e;if(t=so(t),f=ss[t.name],!f)return ch(n,"text/plain");if(i=f(n,t),br.hasOwnProperty(t.name)){u=br[t.name];for(r in u)u.hasOwnProperty(r)&&(i.hasOwnProperty(r)&&(i["_"+r]=i[r]),i[r]=u[r])}if(i.name=t.name,t.helperType&&(i.helperType=t.helperType),t.modeProps)for(e in t.modeProps)i[e]=t.modeProps[e];return i}function gk(n,t){var i=br.hasOwnProperty(n)?br[n]:br[n]={};ir(t,i)}function er(n,t){var r,u,i;if(t===!0)return t;if(n.copyState)return n.copyState(t);r={};for(u in t)i=t[u],i instanceof Array&&(i=i.concat([])),r[u]=i;return r}function lh(n,t){for(var i;n.innerMode;){if(i=n.innerMode(t),!i||i.mode==n)break;t=i.state;n=i.mode}return i||{mode:n,state:t}}function wa(n,t,i){return n.startState?n.startState(t,i):!0}function ba(n,t,i,r){var u=[n.state.modeGen],f={},o,s,e;for(tv(n,t.text,n.doc.mode,i,function(n,t){return u.push(n,t)},f,r),o=i.state,s=function(r){i.baseTokens=u;var s=n.state.overlays[r],e=1,h=0;i.state=!0;tv(n,t.text,s.mode,i,function(n,t){for(var i=e,r,f;h<n;)r=u[e],r>n&&u.splice(e,1,n,u[e+1],r),e+=2,h=Math.min(n,r);if(t)if(s.opaque)u.splice(i,e-i,n,"overlay "+t),e=i+2;else for(;i<e;i+=2)f=u[i+1],u[i+1]=(f?f+" ":"")+"overlay "+t},f);i.state=o;i.baseTokens=null;i.baseTokenPos=1},e=0;e<n.state.overlays.length;++e)s(e);return{styles:u,classes:f.bgClass||f.textClass?f:null}}function ka(n,t,i){if(!t.styles||t.styles[0]!=n.state.modeGen){var r=lf(n,h(t)),u=t.text.length>n.options.maxHighlightLength&&er(n.doc.mode,r.state),f=ba(n,t,r);u&&(r.state=u);t.stateAfter=r.save(!u);t.styles=f.styles;f.classes?t.styleClasses=f.classes:t.styleClasses&&(t.styleClasses=null);i===n.doc.highlightFrontier&&(n.doc.modeFrontier=Math.max(n.doc.modeFrontier,++n.doc.highlightFrontier))}return t.styles}function lf(n,i,r){var u=n.doc,o=n.display;if(!u.mode.startState)return new dt(u,!0,i);var e=nd(n,i,r),s=e>u.first&&t(u,e-1).stateAfter,f=s?dt.fromSaved(u,s,e):new dt(u,wa(u.mode),e);return u.iter(e,i,function(t){ah(n,t.text,f);var r=f.line;t.stateAfter=r==i-1||r%5==0||r>=o.viewFrom&&r<o.viewTo?f.save():null;f.nextLine()}),r&&(u.modeFrontier=f.line),f}function ah(n,t,i,r){var f=n.doc.mode,u=new v(t,n.options.tabSize,i);for(u.start=u.pos=r||0,t==""&&da(f,i.state);!u.eol();)vh(f,u,i.state),u.start=u.pos}function da(n,t){if(n.blankLine)return n.blankLine(t);if(n.innerMode){var i=lh(n,t);if(i.mode.blankLine)return i.mode.blankLine(i.state)}}function vh(n,t,i,r){for(var u,f=0;f<10;f++)if(r&&(r[0]=lh(n,i).mode),u=n.token(t,i),t.pos>t.start)return u;throw new Error("Mode "+n.name+" failed to advance stream.");}function ga(n,i,r,u){var o=n.doc,l=o.mode,h;i=f(o,i);var a=t(o,i.line),s=lf(n,i.line,r),e=new v(a.text,n.options.tabSize,s),c;for(u&&(c=[]);(u||e.pos<i.ch)&&!e.eol();)e.start=e.pos,h=vh(l,e,s.state),u&&c.push(new ll(e,h,er(o.mode,s.state)));return u?c:new ll(e,h,s.state)}function nv(n,t){var i,r;if(n)for(;;){if(i=n.match(/(?:^|\s+)line-(background-)?(\S+)/),!i)break;n=n.slice(0,i.index)+n.slice(i.index+i[0].length);r=i[1]?"bgClass":"textClass";t[r]==null?t[r]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[r])||(t[r]+=" "+i[2])}return n}function tv(n,t,i,r,u,f,e){var c=i.flattenSpans,l,y;c==null&&(c=n.options.flattenSpans);var s=0,a=null,o=new v(t,n.options.tabSize,r),h,p=n.options.addModeClass&&[null];for(t==""&&nv(da(i,r.state),f);!o.eol();){if(o.pos>n.options.maxHighlightLength?(c=!1,e&&ah(n,t,r,o.pos),o.pos=t.length,h=null):h=nv(vh(i,o,r.state,p),f),p&&(l=p[0].name,l&&(h="m-"+(h?l+" "+h:l))),!c||a!=h){while(s<o.start)s=Math.min(o.start,s+5e3),u(s,a);a=h}o.start=o.pos}while(s<o.pos)y=Math.min(o.pos,s+5e3),u(y,a),s=y}function nd(n,i,r){for(var o,f,s,c,h,e=n.doc,l=r?-1:i-(n.doc.mode.innerMode?1e3:100),u=i;u>l;--u){if(u<=e.first)return e.first;if(o=t(e,u-1),f=o.stateAfter,f&&(!r||u+(f instanceof ve?f.lookAhead:0)<=e.modeFrontier))return u;s=at(o.text,null,n.options.tabSize);(h==null||c>s)&&(h=u-1,c=s)}return h}function td(n,i){var u,r,f;if(n.modeFrontier=Math.min(n.modeFrontier,i),!(n.highlightFrontier<i-10)){for(u=n.first,r=i-1;r>u;r--)if(f=t(n,r).stateAfter,f&&(!(f instanceof ve)||r+f.lookAhead<i)){u=r+1;break}n.highlightFrontier=Math.min(n.highlightFrontier,u)}}function id(n,t,i,r){n.text=t;n.stateAfter&&(n.stateAfter=null);n.styles&&(n.styles=null);n.order!=null&&(n.order=null);ea(n);oa(n,i);var u=r?r(n):1;u!=n.height&&gt(n,u)}function rd(n){n.parent=null;ea(n)}function iv(n,t){if(!n||/^\s*$/.test(n))return null;var i=t.addModeClass?pb:yb;return i[n]||(i[n]=n.replace(/\S+/g,"cm-$&"))}function rv(n,t){var s=nu("span",null,null,tt?"padding-right: .1px":null),i={pre:nu("pre",[s],"CodeMirror-line"),content:s,col:0,pos:0,cm:n,trailingSpace:!1,splitSpaces:(e||tt)&&n.getOption("lineWrapping")},u,r,o,c,f;for(t.measure={},u=0;u<=(t.rest?t.rest.length:0);u++)r=u?t.rest[u-1]:t.line,o=void 0,i.pos=0,i.addToken=fd,wk(n.display.measure)&&(o=oi(r,n.doc.direction))&&(i.addToken=od(i.addToken,o)),i.map=[],c=t!=n.display.externalMeasured&&h(r),sd(r,i,ka(n,r,c)),r.styleClasses&&(r.styleClasses.bgClass&&(i.bgClass=ys(r.styleClasses.bgClass,i.bgClass||"")),r.styleClasses.textClass&&(i.textClass=ys(r.styleClasses.textClass,i.textClass||""))),i.map.length==0&&i.map.push(0,0,i.content.appendChild(pk(n.display.measure))),u==0?(t.measure.map=i.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(i.map),(t.measure.caches||(t.measure.caches=[])).push({}));return tt&&(f=i.content.lastChild,(/\bcm-tab\b/.test(f.className)||f.querySelector&&f.querySelector(".cm-tab"))&&(i.content.className="cm-tab-wrap-hack")),y(n,"renderLine",n,t.line,i.pre),i.pre.className&&(i.textClass=ys(i.pre.className,i.textClass||"")),i}function ud(n){var t=i("span","•","cm-invalidchar");return t.title="\\u"+n.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function fd(n,t,r,u,f,o,s){var v,h,y,p,c,b,k,w,d;if(t){var g=n.splitSpaces?ed(t,n.trailingSpace):t,nt=n.cm.state.specialChars,tt=!1,a;if(nt.test(t))for(a=document.createDocumentFragment(),v=0;;){if(nt.lastIndex=v,h=nt.exec(t),y=h?h.index-v:t.length-v,y&&(p=document.createTextNode(g.slice(v,v+y)),e&&l<9?a.appendChild(i("span",[p])):a.appendChild(p),n.map.push(n.pos,n.pos+y,p),n.col+=y,n.pos+=y),!h)break;v+=y+1;c=void 0;h[0]=="\t"?(b=n.cm.options.tabSize,k=b-n.col%b,c=a.appendChild(i("span",bs(k),"cm-tab")),c.setAttribute("role","presentation"),c.setAttribute("cm-text","\t"),n.col+=k):h[0]=="\r"||h[0]=="\n"?(c=a.appendChild(i("span",h[0]=="\r"?"␍":"␤","cm-invalidchar")),c.setAttribute("cm-text",h[0]),n.col+=1):(c=n.cm.options.specialCharPlaceholder(h[0]),c.setAttribute("cm-text",h[0]),e&&l<9?a.appendChild(i("span",[c])):a.appendChild(c),n.col+=1);n.map.push(n.pos,n.pos+1,c);n.pos++}else n.col+=t.length,a=document.createTextNode(g),n.map.push(n.pos,n.pos+t.length,a),e&&l<9&&(tt=!0),n.pos+=t.length;if(n.trailingSpace=g.charCodeAt(t.length-1)==32,r||u||f||tt||s)return w=r||"",u&&(w+=u),f&&(w+=f),d=i("span",[a],w,s),o&&(d.title=o),n.content.appendChild(d);n.content.appendChild(a)}}function ed(n,t){var u,f,i,r;if(n.length>1&&!/  /.test(n))return n;for(u=t,f="",i=0;i<n.length;i++)r=n.charAt(i),r==" "&&u&&(i==n.length-1||n.charCodeAt(i+1)==32)&&(r=" "),f+=r,u=r==" ";return f}function od(n,t){return function(i,r,u,f,e,o,s){var c,a,h,l;for(u=u?u+" cm-force-border":"cm-force-border",c=i.pos,a=c+r.length;;){for(h=void 0,l=0;l<t.length;l++)if(h=t[l],h.to>c&&h.from<=c)break;if(h.to>=a)return n(i,r,u,f,e,o,s);n(i,r.slice(0,h.to-c),u,f,null,o,s);f=null;r=r.slice(h.to-c);c=h.to}}}function uv(n,t,i,r){var u=!r&&i.widgetNode;u&&n.map.push(n.pos,n.pos+t,u);!r&&n.cm.display.input.needsContentAttribute&&(u||(u=n.content.appendChild(document.createElement("span"))),u.setAttribute("cm-marker",i.id));u&&(n.cm.display.input.setUneditable(u),n.content.appendChild(u));n.pos+=t;n.trailingSpace=!1}function sd(n,t,i){var it=n.markedSpans,rt=n.text,y=0,l,p,s,w,u,f,a,b,c,k,ut;if(!it){for(l=1;l<i.length;l+=2)t.addToken(t,rt.slice(y,y=i[l]),iv(i[l+1],t.cm.options));return}for(var ft=rt.length,r=0,ot=1,h="",et,v,o=0,d,g,nt,tt,e;;){if(o==r){for(d=g=nt=tt=v="",e=null,o=Infinity,p=[],s=void 0,w=0;w<it.length;++w)u=it[w],f=u.marker,f.type=="bookmark"&&u.from==r&&f.widgetNode?p.push(f):u.from<=r&&(u.to==null||u.to>r||f.collapsed&&u.to==r&&u.from==r)?(u.to!=null&&u.to!=r&&o>u.to&&(o=u.to,g=""),f.className&&(d+=" "+f.className),f.css&&(v=(v?v+";":"")+f.css),f.startStyle&&u.from==r&&(nt+=" "+f.startStyle),f.endStyle&&u.to==o&&(s||(s=[])).push(f.endStyle,u.to),f.title&&!tt&&(tt=f.title),f.collapsed&&(!e||sa(e.marker,f)<0)&&(e=u)):u.from>r&&o>u.from&&(o=u.from);if(s)for(a=0;a<s.length;a+=2)s[a+1]==o&&(g+=" "+s[a]);if(!e||e.from==r)for(b=0;b<p.length;++b)uv(t,0,p[b]);if(e&&(e.from||0)==r){if(uv(t,(e.to==null?ft+1:e.to)-r,e.marker,e.from==null),e.to==null)return;e.to==r&&(e=!1)}}if(r>=ft)break;for(c=Math.min(ft,o);;){if(h){if(k=r+h.length,e||(ut=k>c?h.slice(0,c-r):h,t.addToken(t,ut,et?et+d:d,nt,r+ut.length==o?g:"",tt,v)),k>=c){h=h.slice(c-r);r=c;break}r=k;nt=""}h=rt.slice(y,y=i[ot++]);et=iv(i[ot++],t.cm.options)}}}function fv(n,t,i){this.line=t;this.rest=vk(t);this.size=this.rest?h(s(this.rest))-i+1:1;this.node=this.text=null;this.hidden=fr(n,t)}function ho(n,i,r){for(var f,e=[],o,u=i;u<r;u=o)f=new fv(n.doc,t(n.doc,u),u),o=u+f.size,e.push(f);return e}function hd(n){dr?dr.ops.push(n):n.ownsGroup=dr={ops:[n],delayedCallbacks:[]}}function cd(n){var u=n.delayedCallbacks,i=0,r,t;do{for(;i<u.length;i++)u[i].call(null);for(r=0;r<n.ops.length;r++)if(t=n.ops[r],t.cursorActivityHandlers)while(t.cursorActivityCalled<t.cursorActivityHandlers.length)t.cursorActivityHandlers[t.cursorActivityCalled++].call(null,t.cm)}while(i<u.length)}function ld(n,t){var i=n.ownsGroup;if(i)try{cd(i)}finally{dr=null;t(i)}}function g(n,t){var u=oh(n,t),f,i,e,r;if(u.length)for(f=Array.prototype.slice.call(arguments,2),dr?i=dr.delayedCallbacks:wu?i=wu:(i=wu=[],setTimeout(ad,0)),e=function(n){i.push(function(){return u[n].apply(null,f)})},r=0;r<u.length;++r)e(r)}function ad(){var t=wu,n;for(wu=null,n=0;n<t.length;++n)t[n]()}function ev(n,t,i,r){for(var u,f=0;f<t.changes.length;f++)u=t.changes[f],u=="text"?yd(n,t):u=="gutter"?sv(n,t,i,r):u=="class"?yh(n,t):u=="widget"&&pd(n,t,r);t.changes=null}function af(n){return n.node==n.text&&(n.node=i("div",null,null,"position: relative"),n.text.parentNode&&n.text.parentNode.replaceChild(n.node,n.text),n.node.appendChild(n.text),e&&l<8&&(n.node.style.zIndex=2)),n.node}function vd(n,t){var r=t.bgClass?t.bgClass+" "+(t.line.bgClass||""):t.line.bgClass,u;r&&(r+=" CodeMirror-linebackground");t.background?r?t.background.className=r:(t.background.parentNode.removeChild(t.background),t.background=null):r&&(u=af(t),t.background=u.insertBefore(i("div",null,r),u.firstChild),n.display.input.setUneditable(t.background))}function ov(n,t){var i=n.display.externalMeasured;return i&&i.line==t.line?(n.display.externalMeasured=null,t.measure=i.measure,i.built):rv(n,t)}function yd(n,t){var r=t.text.className,i=ov(n,t);t.text==t.node&&(t.node=i.pre);t.text.parentNode.replaceChild(i.pre,t.text);t.text=i.pre;i.bgClass!=t.bgClass||i.textClass!=t.textClass?(t.bgClass=i.bgClass,t.textClass=i.textClass,yh(n,t)):r&&(t.text.className=r)}function yh(n,t){vd(n,t);t.line.wrapClass?af(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=i||""}function sv(n,t,r,u){var c,f,l,e,s,o,h;if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(c=af(t),t.gutterBackground=i("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(n.options.fixedGutter?u.fixedPos:-u.gutterTotalWidth)+"px; width: "+u.gutterTotalWidth+"px"),n.display.input.setUneditable(t.gutterBackground),c.insertBefore(t.gutterBackground,t.text)),f=t.line.gutterMarkers,(n.options.lineNumbers||f)&&(l=af(t),e=t.gutter=i("div",null,"CodeMirror-gutter-wrapper","left: "+(n.options.fixedGutter?u.fixedPos:-u.gutterTotalWidth)+"px"),n.display.input.setUneditable(e),l.insertBefore(e,t.text),t.line.gutterClass&&(e.className+=" "+t.line.gutterClass),!n.options.lineNumbers||f&&f["CodeMirror-linenumbers"]||(t.lineNumber=e.appendChild(i("div",nh(n.options,r),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+u.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+n.display.lineNumInnerWidth+"px"))),f))for(s=0;s<n.options.gutters.length;++s)o=n.options.gutters[s],h=f.hasOwnProperty(o)&&f[o],h&&e.appendChild(i("div",[h],"CodeMirror-gutter-elt","left: "+u.gutterLeft[o]+"px; width: "+u.gutterWidth[o]+"px"))}function pd(n,t,i){t.alignable&&(t.alignable=null);for(var r=t.node.firstChild,u=void 0;r;r=u)u=r.nextSibling,r.className=="CodeMirror-linewidget"&&t.node.removeChild(r);hv(n,t,i)}function wd(n,t,i,r){var u=ov(n,t);return t.text=t.node=u.pre,u.bgClass&&(t.bgClass=u.bgClass),u.textClass&&(t.textClass=u.textClass),yh(n,t),sv(n,t,i,r),hv(n,t,r),t.node}function hv(n,t,i){if(cv(n,t.line,t,i,!0),t.rest)for(var r=0;r<t.rest.length;r++)cv(n,t.rest[r],t,i,!1)}function cv(n,t,r,u,f){var h,s,c,e,o;if(t.widgets)for(h=af(r),s=0,c=t.widgets;s<c.length;++s)e=c[s],o=i("div",[e.node],"CodeMirror-linewidget"),e.handleMouseEvents||o.setAttribute("cm-ignore-events","true"),bd(e,o,r,u),n.display.input.setUneditable(o),f&&e.above?h.insertBefore(o,r.gutter||r.text):h.appendChild(o),g(e,"redraw")}function bd(n,t,i,r){if(n.noHScroll){(i.alignable||(i.alignable=[])).push(t);var u=r.wrapperWidth;t.style.left=r.fixedPos+"px";n.coverGutter||(u-=r.gutterTotalWidth,t.style.paddingLeft=r.gutterTotalWidth+"px");t.style.width=u+"px"}n.coverGutter&&(t.style.zIndex=5,t.style.position="relative",n.noHScroll||(t.style.marginLeft=-r.gutterTotalWidth+"px"))}function vf(n){var t,r;return n.height!=null?n.height:(t=n.doc.cm,!t)?0:(vi(document.body,n.node)||(r="position: relative;",n.coverGutter&&(r+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),n.noHScroll&&(r+="width: "+t.display.wrapper.clientWidth+"px;"),ct(t.display.measure,i("div",[n.node],null,r))),n.height=n.node.parentNode.offsetHeight)}function si(n,t){for(var i=hh(t);i!=n.wrapper;i=i.parentNode)if(!i||i.nodeType==1&&i.getAttribute("cm-ignore-events")=="true"||i.parentNode==n.sizer&&i!=n.mover)return!0}function co(n){return n.lineSpace.offsetTop}function ph(n){return n.mover.offsetHeight-n.lineSpace.offsetHeight}function lv(n){if(n.cachedPaddingH)return n.cachedPaddingH;var r=ct(n.measure,i("pre","x")),u=window.getComputedStyle?window.getComputedStyle(r):r.currentStyle,t={left:parseInt(u.paddingLeft),right:parseInt(u.paddingRight)};return isNaN(t.left)||isNaN(t.right)||(n.cachedPaddingH=t),t}function ti(n){return nk-n.display.nativeBarWidth}function or(n){return n.display.scroller.clientWidth-ti(n)-n.display.barWidth}function wh(n){return n.display.scroller.clientHeight-ti(n)-n.display.barHeight}function kd(n,t,i){var f=n.options.lineWrapping,h=f&&or(n),e,u,r,o,s;if(!t.measure.heights||f&&t.measure.width!=h){if(e=t.measure.heights=[],f)for(t.measure.width=h,u=t.text.firstChild.getClientRects(),r=0;r<u.length-1;r++)o=u[r],s=u[r+1],Math.abs(o.bottom-s.bottom)>2&&e.push((o.bottom+s.top)/2-i.top);e.push(i.bottom-i.top)}}function av(n,t,i){var r,u;if(n.line==t)return{map:n.measure.map,cache:n.measure.cache};for(r=0;r<n.rest.length;r++)if(n.rest[r]==t)return{map:n.measure.maps[r],cache:n.measure.caches[r]};for(u=0;u<n.rest.length;u++)if(h(n.rest[u])>i)return{map:n.measure.maps[u],cache:n.measure.caches[u],before:!0}}function dd(n,t){var r,i,u;return t=ni(t),r=h(t),i=n.display.externalMeasured=new fv(n.doc,t,r),i.lineN=r,u=i.built=rv(n,i),i.text=u.pre,ct(n.display.lineMeasure,u.pre),i}function vv(n,t,i,r){return ii(n,iu(n,t),i,r)}function bh(n,t){if(t>=n.display.viewFrom&&t<n.display.viewTo)return n.display.view[cr(n,t)];var i=n.display.externalMeasured;if(i&&t>=i.lineN&&t<i.lineN+i.size)return i}function iu(n,t){var u=h(t),i=bh(n,u),r;return i&&!i.text?i=null:i&&i.changes&&(ev(n,i,u,ic(n)),n.curOp.forceUpdate=!0),i||(i=dd(n,t)),r=av(i,t,u),{line:t,view:i,rect:null,map:r.map,cache:r.cache,before:r.before,hasHeights:!1}}function ii(n,t,i,r,u){t.before&&(i=-1);var e=i+(r||""),f;return t.cache.hasOwnProperty(e)?f=t.cache[e]:(t.rect||(t.rect=t.view.text.getBoundingClientRect()),t.hasHeights||(kd(n,t.view,t.rect),t.hasHeights=!0),f=ng(n,t,i,r),f.bogus||(t.cache[e]=f)),{left:f.left,right:f.right,top:u?f.rtop:f.top,bottom:u?f.rbottom:f.bottom}}function yv(n,t,i){for(var s,u,h,o,e,f,r=0;r<n.length;r+=3)if(e=n[r],f=n[r+1],t<e?(u=0,h=1,o="left"):t<f?(u=t-e,h=u+1):(r==n.length-3||t==f&&n[r+3]>t)&&(h=f-e,u=h-1,t>=f&&(o="right")),u!=null){if(s=n[r+2],e==f&&i==(s.insertLeft?"left":"right")&&(o=i),i=="left"&&u==0)while(r&&n[r-2]==n[r-3]&&n[r-1].insertLeft)s=n[(r-=3)+2],o="left";if(i=="right"&&u==f-e)while(r<n.length-3&&n[r+3]==n[r+4]&&!n[r+5].insertLeft)s=n[(r+=3)+2],o="right";break}return{node:s,start:u,end:h,collapse:o,coverStart:e,coverEnd:f}}function gd(n,t){var i=al,r,u;if(t=="left"){for(r=0;r<n.length;r++)if((i=n[r]).left!=i.right)break}else for(u=n.length-1;u>=0;u--)if((i=n[u]).left!=i.right)break;return i}function ng(n,t,i,r){var o=yv(t.map,i,r),s=o.node,f=o.start,h=o.end,v=o.collapse,u,w,b,c;if(s.nodeType==3){for(w=0;w<4;w++){while(f&&ds(t.line.text.charAt(o.coverStart+f)))--f;while(o.coverStart+h<o.coverEnd&&ds(t.line.text.charAt(o.coverStart+h)))++h;if(u=e&&l<9&&f==0&&h==o.coverEnd-o.coverStart?s.parentNode.getBoundingClientRect():gd(vu(s,f,h).getClientRects(),r),u.left||u.right||f==0)break;h=f;f=f-1;v="right"}e&&l<11&&(u=tg(n.display.measure,u))}else f>0&&(v=r="right"),u=n.options.lineWrapping&&(b=s.getClientRects()).length>1?b[r=="right"?b.length-1:0]:s.getBoundingClientRect();e&&l<9&&!f&&(!u||!u.left&&!u.right)&&(c=s.parentNode.getClientRects()[0],u=c?{left:c.left,right:c.left+pf(n.display),top:c.top,bottom:c.bottom}:al);for(var k=u.top-t.rect.top,d=u.bottom-t.rect.top,g=(k+d)/2,y=t.view.measure.heights,a=0;a<y.length-1;a++)if(g<y[a])break;var nt=a?y[a-1]:0,tt=y[a],p={left:(v=="right"?u.right:u.left)-t.rect.left,right:(v=="left"?u.left:u.right)-t.rect.left,top:nt,bottom:tt};return u.left||u.right||(p.bogus=!0),n.options.singleCursorHeightPerLine||(p.rtop=k,p.rbottom=d),p}function tg(n,t){if(!window.screen||screen.logicalXDPI==null||screen.logicalXDPI==screen.deviceXDPI||!bk(n))return t;var i=screen.logicalXDPI/screen.deviceXDPI,r=screen.logicalYDPI/screen.deviceYDPI;return{left:t.left*i,right:t.right*i,top:t.top*r,bottom:t.bottom*r}}function pv(n){if(n.measure&&(n.measure.cache={},n.measure.heights=null,n.rest))for(var t=0;t<n.rest.length;t++)n.measure.caches[t]={}}function wv(n){n.display.externalMeasure=null;ai(n.display.lineMeasure);for(var t=0;t<n.display.view.length;t++)pv(n.display.view[t])}function yf(n){wv(n);n.display.cachedCharWidth=n.display.cachedTextHeight=n.display.cachedPaddingH=null;n.options.lineWrapping||(n.display.maxLineChanged=!0);n.display.lineNumChars=null}function bv(){return fs&&es?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function kv(){return fs&&es?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function kh(n){var i=0,t;if(n.widgets)for(t=0;t<n.widgets.length;++t)n.widgets[t].above&&(i+=vf(n.widgets[t]));return i}function lo(n,t,i,r,u){var e,f,o,s;return(u||(e=kh(t),i.top+=e,i.bottom+=e),r=="line")?i:(r||(r="local"),f=ei(t),r=="local"?f+=co(n.display):f-=n.display.viewOffset,(r=="page"||r=="window")&&(o=n.display.lineSpace.getBoundingClientRect(),f+=o.top+(r=="window"?0:kv()),s=o.left+(r=="window"?0:bv()),i.left+=s,i.right+=s),i.top+=f,i.bottom+=f,i)}function dv(n,t,i){var r,u,f,e;return i=="div"?t:(r=t.left,u=t.top,i=="page"?(r-=bv(),u-=kv()):i!="local"&&i||(f=n.display.sizer.getBoundingClientRect(),r+=f.left,u+=f.top),e=n.display.lineSpace.getBoundingClientRect(),{left:r-e.left,top:u-e.top})}function dh(n,i,r,u,f){return u||(u=t(n.doc,i.line)),lo(n,u,vv(n,u,i.ch,f),r)}function pt(n,i,r,u,f,e){function c(t,i){var o=ii(n,f,t,i?"right":"left",e);return i?o.left=o.right:o.right=o.left,lo(n,u,o,r)}function l(n,t,i){var r=h[t],u=r.level==1;return c(i?n-1:n,u!=i)}u=u||t(n.doc,i.line);f||(f=iu(n,u));var h=oi(u,n.doc.direction),o=i.ch,s=i.sticky;if(o>=u.text.length?(o=u.text.length,s="before"):o<=0&&(o=0,s="after"),!h)return c(s=="before"?o-1:o,s=="before");var y=hf(h,o,s),a=pu,v=l(o,y,s=="before");return a!=null&&(v.other=l(o,a,s!="before")),v}function gv(n,i){var r=0,u,e;return i=f(n.doc,i),n.options.lineWrapping||(r=pf(n.display)*i.ch),u=t(n.doc,i.line),e=ei(u)+co(n.display),{left:r,right:r,top:e,bottom:e+u.height}}function gh(t,i,r,u,f){var e=n(t,i,r);return e.xRel=f,u&&(e.outside=!0),e}function nc(n,i,r){var u=n.doc,f,s,e;if(r+=n.display.viewOffset,r<0)return gh(u.first,0,null,!0,-1);if(f=ur(u,r),s=u.first+u.size-1,f>s)return gh(u.first+u.size-1,t(u,s).text.length,null,!0,1);for(i<0&&(i=0),e=t(u,f);;){var o=ig(n,e,f,i,r),c=sf(e),l=c&&c.find(0,!0);if(c&&(o.ch>l.from.ch||o.ch==l.from.ch&&o.xRel>0))f=h(e=l.to.line);else return o}}function ny(n,t,i,r){r-=kh(t);var u=t.text.length,f=ff(function(t){return ii(n,i,t-1).bottom<=r},u,0);return u=ff(function(t){return ii(n,i,t).top>r},f,u),{begin:f,end:u}}function ty(n,t,i,r){i||(i=iu(n,t));var u=lo(n,t,ii(n,i,r),"line").top;return ny(n,t,i,u)}function tc(n,t,i,r){return n.bottom<=i?!1:n.top>i?!0:(r?n.left:n.right)>t}function ig(t,i,r,u,f){var s,v,y,c;f-=ei(i);var l=iu(t,i),p=kh(i),w=0,b=i.text.length,o=!0,d=oi(i,t.doc.direction);d&&(s=(t.options.lineWrapping?ug:rg)(t,i,r,l,d,u,f),o=s.level!=1,w=o?s.from:s.to-1,b=o?s.to:s.from-1);var g=null,h=null,e=ff(function(n){var i=ii(t,l,n);return(i.top+=p,i.bottom+=p,!tc(i,u,f,!1))?!1:(i.top<=f&&i.left<=u&&(g=n,h=i),!0)},w,b),k,a,nt=!1;return h?(v=u-h.left<h.right-u,y=v==o,e=g+(y?0:1),a=y?"after":"before",k=v?h.left:h.right):(o||e!=b&&e!=w||e++,a=e==0?"after":e==i.text.length?"before":ii(t,l,e-(o?1:0)).bottom+p<=f==o?"after":"before",c=pt(t,n(r,e,a),"line",i,l),k=c.left,nt=f<c.top||f>=c.bottom),e=ia(i.text,e,1),gh(r,e,a,nt,u-k)}function rg(t,i,r,u,f,e,o){var h=ff(function(s){var h=f[s],c=h.level!=1;return tc(pt(t,n(r,c?h.to:h.from,c?"before":"after"),"line",i,u),e,o,!0)},0,f.length-1),s=f[h],c,l;return h>0&&(c=s.level!=1,l=pt(t,n(r,c?s.from:s.to,c?"after":"before"),"line",i,u),tc(l,e,o,!0)&&l.top>o&&(s=f[h-1])),s}function ug(n,t,i,r,u,f,e){var y=ny(n,t,r,e),c=y.begin,h=y.end,o,a,l,s;for(/\s/.test(t.text.charAt(h-1))&&h--,o=null,a=null,l=0;l<u.length;l++)if(s=u[l],!(s.from>=h)&&!(s.to<=c)){var w=s.level!=1,v=ii(n,r,w?Math.min(h,s.to)-1:Math.max(c,s.from)).right,p=v<f?f-v+1e9:v-f;(!o||a>p)&&(o=s,a=p)}return o||(o=u[u.length-1]),o.from<c&&(o={from:c,to:o.to,level:o.level}),o.to>h&&(o={from:o.from,to:h,level:o.level}),o}function sr(n){var r,t;if(n.cachedTextHeight!=null)return n.cachedTextHeight;if(gr==null){for(gr=i("pre"),r=0;r<49;++r)gr.appendChild(document.createTextNode("x")),gr.appendChild(i("br"));gr.appendChild(document.createTextNode("x"))}return ct(n.measure,gr),t=gr.offsetHeight/50,t>3&&(n.cachedTextHeight=t),ai(n.measure),t||1}function pf(n){var r,f,u,t;return n.cachedCharWidth!=null?n.cachedCharWidth:(r=i("span","xxxxxxxxxx"),f=i("pre",[r]),ct(n.measure,f),u=r.getBoundingClientRect(),t=(u.right-u.left)/10,t>2&&(n.cachedCharWidth=t),t||10)}function ic(n){for(var i=n.display,u={},f={},e=i.gutters.clientLeft,t=i.gutters.firstChild,r=0;t;t=t.nextSibling,++r)u[n.options.gutters[r]]=t.offsetLeft+t.clientLeft+e,f[n.options.gutters[r]]=t.clientWidth;return{fixedPos:rc(i),gutterTotalWidth:i.gutters.offsetWidth,gutterLeft:u,gutterWidth:f,wrapperWidth:i.wrapper.clientWidth}}function rc(n){return n.scroller.getBoundingClientRect().left-n.sizer.getBoundingClientRect().left}function iy(n){var t=sr(n.display),i=n.options.lineWrapping,r=i&&Math.max(5,n.display.scroller.clientWidth/pf(n.display)-3);return function(u){var e,f;if(fr(n.doc,u))return 0;if(e=0,u.widgets)for(f=0;f<u.widgets.length;f++)u.widgets[f].height&&(e+=u.widgets[f].height);return i?e+(Math.ceil(u.text.length/r)||1)*t:e+t}}function uc(n){var t=n.doc,i=iy(n);t.iter(function(n){var t=i(n);t!=n.height&&gt(n,t)})}function hr(i,r,u,f){var a=i.display,s,c,h,e,o,l;if(!u&&hh(r).getAttribute("cm-not-content")=="true")return null;h=a.lineSpace.getBoundingClientRect();try{s=r.clientX-h.left;c=r.clientY-h.top}catch(r){return null}return e=nc(i,s,c),f&&e.xRel==1&&(o=t(i.doc,e.line).text).length==e.ch&&(l=at(o,o.length,i.options.tabSize)-o.length,e=n(e.line,Math.max(0,Math.round((s-lv(i.display).left)/pf(i.display))-l))),e}function cr(n,t){var r,i;if(t>=n.display.viewTo||(t-=n.display.viewFrom,t<0))return null;for(r=n.display.view,i=0;i<r.length;i++)if(t-=r[i].size,t<0)return i}function wf(n){n.display.input.showSelection(n.display.input.prepareSelection())}function ry(n,t){var r,i,u;t===void 0&&(t=!0);var f=n.doc,e={},o=e.cursors=document.createDocumentFragment(),s=e.selection=document.createDocumentFragment();for(r=0;r<f.sel.ranges.length;r++)(t||r!=f.sel.primIndex)&&((i=f.sel.ranges[r],i.from().line>=n.display.viewTo||i.to().line<n.display.viewFrom)||(u=i.empty(),(u||n.options.showCursorWhenSelecting)&&uy(n,i.head,o),u||fg(n,i,s)));return e}function uy(n,t,r){var u=pt(n,t,"div",null,null,!n.options.singleCursorHeightPerLine),e=r.appendChild(i("div"," ","CodeMirror-cursor")),f;e.style.left=u.left+"px";e.style.top=u.top+"px";e.style.height=Math.max(0,u.bottom-u.top)*n.options.cursorHeight+"px";u.other&&(f=r.appendChild(i("div"," ","CodeMirror-cursor CodeMirror-secondarycursor")),f.style.display="",f.style.left=u.other.left+"px",f.style.top=u.other.top+"px",f.style.height=(u.other.bottom-u.other.top)*.85+"px")}function ao(n,t){return n.top-t.top||n.left-t.left}function fg(r,u,f){function s(n,t,r,u){t<0&&(t=0);t=Math.round(t);u=Math.round(u);k.appendChild(i("div",null,"CodeMirror-selected","position: absolute; left: "+n+"px;\n                             top: "+t+"px; width: "+(r==null?l-n:r)+"px;\n                             height: "+(u-t)+"px"))}function p(i,u,f){function p(t,u){return dh(r,n(i,t),"div",a,u)}function y(n,t,i){var u=ty(r,a,null,n),f=t=="ltr"==(i=="after")?"left":"right",e=i=="after"?u.begin:u.end-(/\s/.test(a.text.charAt(u.end-1))?2:1);return p(e,f)[f]}var a=t(v,i),b=a.text.length,o,c,w=oi(a,v.direction);return yk(w,u||0,f==null?b:f,function(n,t,i,r){var k=i=="ltr",a=p(n,k?"left":"right"),v=p(t-1,k?"right":"left"),d=u==null&&n==0,g=f==null&&t==b,it=r==0,rt=!w||r==w.length-1,nt,ut,tt,ft;if(v.top-a.top<=3){var ot=(e?d:g)&&it,st=(e?g:d)&&rt,et=ot?h:(k?a:v).left,ht=st?l:(k?v:a).right;s(et,a.top,ht-et,a.bottom)}else k?(nt=e&&d&&it?h:a.left,ut=e?l:y(n,i,"before"),tt=e?h:y(t,i,"after"),ft=e&&g&&rt?l:v.right):(nt=e?y(n,i,"before"):h,ut=!e&&d&&it?l:a.right,tt=!e&&g&&rt?h:v.left,ft=e?y(t,i,"after"):l),s(nt,a.top,ut-nt,a.bottom),a.bottom<v.top&&s(h,a.bottom,null,v.top),s(tt,v.top,ft-tt,v.bottom);(!o||ao(a,o)<0)&&(o=a);ao(v,o)<0&&(o=v);(!c||ao(a,c)<0)&&(c=a);ao(v,c)<0&&(c=v)}),{start:o,end:c}}var b=r.display,v=r.doc,k=document.createDocumentFragment(),d=lv(r.display),h=d.left,l=Math.max(b.sizerWidth,or(r)-b.sizer.offsetLeft)-d.right,e=v.direction=="ltr",a=u.from(),y=u.to();if(a.line==y.line)p(a.line,a.ch,y.ch);else{var g=t(v,a.line),nt=t(v,y.line),w=ni(g)==ni(nt),o=p(a.line,a.ch,w?g.text.length+1:null).end,c=p(y.line,w?0:null,y.ch).start;w&&(o.top<c.top-2?(s(o.right,o.top,null,o.bottom),s(h,c.top,c.left,c.bottom)):s(o.right,o.top,c.left-o.right,o.bottom));o.bottom<c.top&&s(h,o.bottom,null,c.top)}f.appendChild(k)}function fc(n){var t,i;n.state.focused&&(t=n.display,clearInterval(t.blinker),i=!0,t.cursorDiv.style.visibility="",n.options.cursorBlinkRate>0?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},n.options.cursorBlinkRate):n.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function fy(n){n.state.focused||(n.display.input.focus(),ec(n))}function ey(n){n.state.delayingBlurEvent=!0;setTimeout(function(){n.state.delayingBlurEvent&&(n.state.delayingBlurEvent=!1,bf(n))},100)}function ec(n,t){(n.state.delayingBlurEvent&&(n.state.delayingBlurEvent=!1),n.options.readOnly!="nocursor")&&(n.state.focused||(y(n,"focus",n,t),n.state.focused=!0,tr(n.display.wrapper,"CodeMirror-focused"),n.curOp||n.display.selForContextMenu==n.doc.sel||(n.display.input.reset(),tt&&setTimeout(function(){return n.display.input.reset(!0)},20)),n.display.input.receivedFocus()),fc(n))}function bf(n,t){n.state.delayingBlurEvent||(n.state.focused&&(y(n,"blur",n,t),n.state.focused=!1,di(n.display.wrapper,"CodeMirror-focused")),clearInterval(n.display.blinker),setTimeout(function(){n.state.focused||(n.display.shift=!1)},150))}function vo(n){for(var t,i,f,o,s,r,u=n.display,c=u.lineDiv.offsetTop,h=0;h<u.view.length;h++)if((t=u.view[h],i=void 0,!t.hidden)&&(e&&l<8?(f=t.node.offsetTop+t.node.offsetHeight,i=f-c,c=f):(o=t.node.getBoundingClientRect(),i=o.bottom-o.top),s=t.line.height-i,i<2&&(i=sr(u)),(s>.005||s<-.005)&&(gt(t.line,i),oy(t.line),t.rest)))for(r=0;r<t.rest.length;r++)oy(t.rest[r])}function oy(n){var t,i,r;if(n.widgets)for(t=0;t<n.widgets.length;++t)i=n.widgets[t],r=i.node.parentNode,r&&(i.height=r.offsetHeight)}function oc(n,i,r){var f=r&&r.top!=null?Math.max(0,r.top):n.scroller.scrollTop,e,o;f=Math.floor(f-co(n));var h=r&&r.bottom!=null?r.bottom:f+n.wrapper.clientHeight,u=ur(i,f),s=ur(i,h);return r&&r.ensure&&(e=r.ensure.from.line,o=r.ensure.to.line,e<u?(u=e,s=ur(i,ei(t(i,e))+n.wrapper.clientHeight)):Math.min(o,i.lastLine())>=s&&(u=ur(i,ei(t(i,o))-n.wrapper.clientHeight),s=o)),{from:u,to:Math.max(s,u+1)}}function sy(n){var i=n.display,r=i.view,t,u,f;if(i.alignWidgets||i.gutters.firstChild&&n.options.fixedGutter){var o=rc(i)-i.scroller.scrollLeft+n.doc.scrollLeft,s=i.gutters.offsetWidth,e=o+"px";for(t=0;t<r.length;t++)if(!r[t].hidden&&(n.options.fixedGutter&&(r[t].gutter&&(r[t].gutter.style.left=e),r[t].gutterBackground&&(r[t].gutterBackground.style.left=e)),u=r[t].alignable,u))for(f=0;f<u.length;f++)u[f].style.left=e;n.options.fixedGutter&&(i.gutters.style.left=o+s+"px")}}function hy(n){if(!n.options.lineNumbers)return!1;var u=n.doc,r=nh(n.options,u.first+u.size-1),t=n.display;if(r.length!=t.lineNumChars){var f=t.measure.appendChild(i("div",[i("div",r)],"CodeMirror-linenumber CodeMirror-gutter-elt")),e=f.firstChild.offsetWidth,o=f.offsetWidth-e;return t.lineGutter.style.width="",t.lineNumInnerWidth=Math.max(e,t.lineGutter.offsetWidth-o)+1,t.lineNumWidth=t.lineNumInnerWidth+o,t.lineNumChars=t.lineNumInnerWidth?r.length:-1,t.lineGutter.style.width=t.lineNumWidth+"px",ac(n),!0}return!1}function eg(n,t){var r;if(!w(n,"scrollCursorIntoView")){var f=n.display,e=f.sizer.getBoundingClientRect(),u=null;t.top+e.top<0?u=!0:t.bottom+e.top>(window.innerHeight||document.documentElement.clientHeight)&&(u=!1);u==null||oit||(r=i("div","​",null,"position: absolute;\n                         top: "+(t.top-f.viewOffset-co(n.display))+"px;\n                         height: "+(t.bottom-t.top+ti(n)+f.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),n.display.lineSpace.appendChild(r),r.scrollIntoView(u),n.display.lineSpace.removeChild(r))}}function og(t,i,r,u){var s,h;for(u==null&&(u=0),t.options.lineWrapping||i!=r||(i=i.ch?n(i.line,i.sticky=="before"?i.ch-1:i.ch,"after"):i,r=i.sticky=="before"?n(i.line,i.ch+1,"before"):i),h=0;h<5;h++){var c=!1,f=pt(t,i),e=!r||r==i?f:pt(t,r);s={left:Math.min(f.left,e.left),top:Math.min(f.top,e.top)-u,right:Math.max(f.left,e.left),bottom:Math.max(f.bottom,e.bottom)+u};var o=sc(t,s),l=t.doc.scrollTop,a=t.doc.scrollLeft;if(o.scrollTop!=null&&(df(t,o.scrollTop),Math.abs(t.doc.scrollTop-l)>1&&(c=!0)),o.scrollLeft!=null&&(lr(t,o.scrollLeft),Math.abs(t.doc.scrollLeft-a)>1&&(c=!0)),!c)break}return s}function sg(n,t){var i=sc(n,t);i.scrollTop!=null&&df(n,i.scrollTop);i.scrollLeft!=null&&lr(n,i.scrollLeft)}function sc(n,t){var r=n.display,h=sr(n.display),e;t.top<0&&(t.top=0);var o=n.curOp&&n.curOp.scrollTop!=null?n.curOp.scrollTop:r.scroller.scrollTop,u=wh(n),i={};t.bottom-t.top>u&&(t.bottom=t.top+u);var c=n.doc.height+ph(r),a=t.top<h,v=t.bottom>c-h;t.top<o?i.scrollTop=a?0:t.top:t.bottom>o+u&&(e=Math.min(t.top,(v?c:t.bottom)-u),e!=o&&(i.scrollTop=e));var l=n.curOp&&n.curOp.scrollLeft!=null?n.curOp.scrollLeft:r.scroller.scrollLeft,f=or(n)-(n.options.fixedGutter?r.gutters.offsetWidth:0),s=t.right-t.left>f;return s&&(t.right=t.left+f),t.left<10?i.scrollLeft=0:t.left<l?i.scrollLeft=Math.max(0,t.left-(s?0:10)):t.right>f+l-3&&(i.scrollLeft=t.right+(s?0:10)-f),i}function hc(n,t){t!=null&&(yo(n),n.curOp.scrollTop=(n.curOp.scrollTop==null?n.doc.scrollTop:n.curOp.scrollTop)+t)}function ru(n){yo(n);var t=n.getCursor();n.curOp.scrollToPos={from:t,to:t,margin:n.options.cursorScrollMargin}}function kf(n,t,i){(t!=null||i!=null)&&yo(n);t!=null&&(n.curOp.scrollLeft=t);i!=null&&(n.curOp.scrollTop=i)}function hg(n,t){yo(n);n.curOp.scrollToPos=t}function yo(n){var t=n.curOp.scrollToPos,i,r;t&&(n.curOp.scrollToPos=null,i=gv(n,t.from),r=gv(n,t.to),cy(n,i,r,t.margin))}function cy(n,t,i,r){var u=sc(n,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-r,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+r});kf(n,u.scrollLeft,u.scrollTop)}function df(n,t){Math.abs(n.doc.scrollTop-t)<2||(ki||lc(n,{top:t}),ly(n,t,!0),ki&&lc(n),ne(n,100))}function ly(n,t,i){(t=Math.min(n.display.scroller.scrollHeight-n.display.scroller.clientHeight,t),n.display.scroller.scrollTop!=t||i)&&(n.doc.scrollTop=t,n.display.scrollbars.setScrollTop(t),n.display.scroller.scrollTop!=t&&(n.display.scroller.scrollTop=t))}function lr(n,t,i,r){(t=Math.min(t,n.display.scroller.scrollWidth-n.display.scroller.clientWidth),(i?t==n.doc.scrollLeft:Math.abs(n.doc.scrollLeft-t)<2)&&!r)||(n.doc.scrollLeft=t,sy(n),n.display.scroller.scrollLeft!=t&&(n.display.scroller.scrollLeft=t),n.display.scrollbars.setScrollLeft(t))}function gf(n){var t=n.display,i=t.gutters.offsetWidth,r=Math.round(n.doc.height+ph(n.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:n.options.fixedGutter?i:0,docHeight:r,scrollHeight:r+ti(n)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function uu(n,t){var i,r,u;for(t||(t=gf(n)),i=n.display.barWidth,r=n.display.barHeight,ay(n,t),u=0;u<4&&i!=n.display.barWidth||r!=n.display.barHeight;u++)i!=n.display.barWidth&&n.options.lineWrapping&&vo(n),ay(n,gf(n)),i=n.display.barWidth,r=n.display.barHeight}function ay(n,t){var i=n.display,r=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=r.right)+"px";i.sizer.style.paddingBottom=(i.barHeight=r.bottom)+"px";i.heightForcer.style.borderBottom=r.bottom+"px solid transparent";r.right&&r.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=r.bottom+"px",i.scrollbarFiller.style.width=r.right+"px"):i.scrollbarFiller.style.display="";r.bottom&&n.options.coverGutterNextToScrollbar&&n.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=r.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function vy(n){n.display.scrollbars&&(n.display.scrollbars.clear(),n.display.scrollbars.addClass&&di(n.display.wrapper,n.display.scrollbars.addClass));n.display.scrollbars=new vl[n.options.scrollbarStyle](function(t){n.display.wrapper.insertBefore(t,n.display.scrollbarFiller);r(t,"mousedown",function(){n.state.focused&&setTimeout(function(){return n.display.input.focus()},0)});t.setAttribute("cm-not-content","true")},function(t,i){i=="horizontal"?lr(n,t):df(n,t)},n);n.display.scrollbars.addClass&&tr(n.display.wrapper,n.display.scrollbars.addClass)}function ar(n){n.curOp={cm:n,viewChanged:!1,startHeight:n.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++wb};hd(n.curOp)}function vr(n){var t=n.curOp;ld(t,function(n){for(var t=0;t<n.ops.length;t++)n.ops[t].cm.curOp=null;cg(n)})}function cg(n){for(var i,r,u,f,t=n.ops,e=0;e<t.length;e++)lg(t[e]);for(i=0;i<t.length;i++)ag(t[i]);for(r=0;r<t.length;r++)vg(t[r]);for(u=0;u<t.length;u++)yg(t[u]);for(f=0;f<t.length;f++)pg(t[f])}function lg(n){var t=n.cm,i=t.display;kg(t);n.updateMaxLine&&eh(t);n.mustUpdate=n.viewChanged||n.forceUpdate||n.scrollTop!=null||n.scrollToPos&&(n.scrollToPos.from.line<i.viewFrom||n.scrollToPos.to.line>=i.viewTo)||i.maxLineChanged&&t.options.lineWrapping;n.update=n.mustUpdate&&new ye(t,n.mustUpdate&&{top:n.scrollTop,ensure:n.scrollToPos},n.forceUpdate)}function ag(n){n.updatedDisplay=n.mustUpdate&&cc(n.cm,n.update)}function vg(n){var t=n.cm,i=t.display;n.updatedDisplay&&vo(t);n.barMeasure=gf(t);i.maxLineChanged&&!t.options.lineWrapping&&(n.adjustWidthTo=vv(t,i.maxLine,i.maxLine.text.length).left+3,t.display.sizerWidth=n.adjustWidthTo,n.barMeasure.scrollWidth=Math.max(i.scroller.clientWidth,i.sizer.offsetLeft+n.adjustWidthTo+ti(t)+t.display.barWidth),n.maxScrollLeft=Math.max(0,i.sizer.offsetLeft+n.adjustWidthTo-or(t)));(n.updatedDisplay||n.selectionChanged)&&(n.preparedSelection=i.input.prepareSelection())}function yg(n){var t=n.cm,i;n.adjustWidthTo!=null&&(t.display.sizer.style.minWidth=n.adjustWidthTo+"px",n.maxScrollLeft<t.doc.scrollLeft&&lr(t,Math.min(t.display.scroller.scrollLeft,n.maxScrollLeft),!0),t.display.maxLineChanged=!1);i=n.focus&&n.focus==fi();n.preparedSelection&&t.display.input.showSelection(n.preparedSelection,i);(n.updatedDisplay||n.startHeight!=t.doc.height)&&uu(t,n.barMeasure);n.updatedDisplay&&vc(t,n.barMeasure);n.selectionChanged&&fc(t);t.state.focused&&n.updateInput&&t.display.input.reset(n.typing);i&&fy(n.cm)}function pg(n){var t=n.cm,o=t.display,s=t.doc,h,i,r,u,e;if(n.updatedDisplay&&py(t,n.update),o.wheelStartX!=null&&(n.scrollTop!=null||n.scrollLeft!=null||n.scrollToPos)&&(o.wheelStartX=o.wheelStartY=null),n.scrollTop!=null&&ly(t,n.scrollTop,n.forceScroll),n.scrollLeft!=null&&lr(t,n.scrollLeft,!0,!0),n.scrollToPos&&(h=og(t,f(s,n.scrollToPos.from),f(s,n.scrollToPos.to),n.scrollToPos.margin),eg(t,h)),i=n.maybeHiddenMarkers,r=n.maybeUnhiddenMarkers,i)for(u=0;u<i.length;++u)i[u].lines.length||y(i[u],"hide");if(r)for(e=0;e<r.length;++e)r[e].lines.length&&y(r[e],"unhide");o.wrapper.offsetHeight&&(s.scrollTop=t.display.scroller.scrollTop);n.changeObjs&&y(t,"changes",t,n.changeObjs);n.update&&n.update.finish()}function ot(n,t){if(n.curOp)return t();ar(n);try{return t()}finally{vr(n)}}function b(n,t){return function(){if(n.curOp)return t.apply(n,arguments);ar(n);try{return t.apply(n,arguments)}finally{vr(n)}}}function it(n){return function(){if(this.curOp)return n.apply(this,arguments);ar(this);try{return n.apply(this,arguments)}finally{vr(this)}}}function k(n){return function(){var t=this.cm;if(!t||t.curOp)return n.apply(this,arguments);ar(t);try{return n.apply(this,arguments)}finally{vr(t)}}}function et(n,t,i,r){var u,e,o,s,h,f;t==null&&(t=n.doc.first);i==null&&(i=n.doc.first+n.doc.size);r||(r=0);u=n.display;r&&i<u.viewTo&&(u.updateLineNumbers==null||u.updateLineNumbers>t)&&(u.updateLineNumbers=t);n.curOp.viewChanged=!0;t>=u.viewTo?hi&&uh(n.doc,t)<u.viewTo&&pi(n):i<=u.viewFrom?hi&&aa(n.doc,i+r)>u.viewFrom?pi(n):(u.viewFrom+=r,u.viewTo+=r):t<=u.viewFrom&&i>=u.viewTo?pi(n):t<=u.viewFrom?(e=po(n,i,i+r,1),e?(u.view=u.view.slice(e.index),u.viewFrom=e.lineN,u.viewTo+=r):pi(n)):i>=u.viewTo?(o=po(n,t,t,-1),o?(u.view=u.view.slice(0,o.index),u.viewTo=o.lineN):pi(n)):(s=po(n,t,t,-1),h=po(n,i,i+r,1),s&&h?(u.view=u.view.slice(0,s.index).concat(ho(n,s.lineN,h.lineN)).concat(u.view.slice(h.index)),u.viewTo+=r):pi(n));f=u.externalMeasured;f&&(i<f.lineN?f.lineN+=r:t<f.lineN+f.size&&(u.externalMeasured=null))}function yi(n,t,i){var r,u,f,e;(n.curOp.viewChanged=!0,r=n.display,u=n.display.externalMeasured,u&&t>=u.lineN&&t<u.lineN+u.size&&(r.externalMeasured=null),t<r.viewFrom||t>=r.viewTo)||(f=r.view[cr(n,t)],f.node!=null)&&(e=f.changes||(f.changes=[]),d(e,i)==-1&&e.push(i))}function pi(n){n.display.viewFrom=n.display.viewTo=n.doc.first;n.display.view=[];n.display.viewOffset=0}function po(n,t,i,r){var u=cr(n,t),o,f=n.display.view,e,s;if(!hi||i==n.doc.first+n.doc.size)return{index:u,lineN:i};for(e=n.display.viewFrom,s=0;s<u;s++)e+=f[s].size;if(e!=t){if(r>0){if(u==f.length-1)return null;o=e+f[u].size-t;u++}else o=e-t;t+=o;i+=o}while(uh(n.doc,i)!=i){if(u==(r<0?0:f.length-1))return null;i+=r*f[u-(r<0?1:0)].size;u+=r}return{index:u,lineN:i}}function wg(n,t,i){var r=n.display,u=r.view;u.length==0||t>=r.viewTo||i<=r.viewFrom?(r.view=ho(n,t,i),r.viewFrom=t):(r.viewFrom>t?r.view=ho(n,t,r.viewFrom).concat(r.view):r.viewFrom<t&&(r.view=r.view.slice(cr(n,t))),r.viewFrom=t,r.viewTo<i?r.view=r.view.concat(ho(n,r.viewTo,i)):r.viewTo>i&&(r.view=r.view.slice(0,cr(n,i))));r.viewTo=i}function yy(n){for(var t,r=n.display.view,u=0,i=0;i<r.length;i++)t=r[i],t.hidden||t.node&&!t.changes||++u;return u}function ne(n,t){n.doc.highlightFrontier<n.display.viewTo&&n.state.highlight.set(t,ps(bg,n))}function bg(n){var i=n.doc;if(!(i.highlightFrontier>=n.display.viewTo)){var u=+new Date+n.options.workTime,t=lf(n,i.highlightFrontier),r=[];i.iter(t.line,Math.min(i.first+i.size,n.display.viewTo+500),function(f){var o,e,h,s;if(t.line>=n.display.viewFrom){var c=f.styles,l=f.text.length>n.options.maxHighlightLength?er(i.mode,t.state):null,a=ba(n,f,t,!0);for(l&&(t.state=l),f.styles=a.styles,o=f.styleClasses,e=a.classes,e?f.styleClasses=e:o&&(f.styleClasses=null),h=!c||c.length!=f.styles.length||o!=e&&(!o||!e||o.bgClass!=e.bgClass||o.textClass!=e.textClass),s=0;!h&&s<c.length;++s)h=c[s]!=f.styles[s];h&&r.push(t.line);f.stateAfter=t.save();t.nextLine()}else f.text.length<=n.options.maxHighlightLength&&ah(n,f.text,t),f.stateAfter=t.line%5==0?t.save():null,t.nextLine();if(+new Date>u)return ne(n,n.options.workDelay),!0});i.highlightFrontier=t.line;i.modeFrontier=Math.max(i.modeFrontier,t.line);r.length&&ot(n,function(){for(var t=0;t<r.length;t++)yi(n,r[t],"text")})}}function kg(n){var t=n.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=ti(n)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=ti(n)+"px",t.scrollbarsClipped=!0)}function dg(n){var r,i,t;return n.hasFocus()?null:(r=fi(),!r||!vi(n.display.lineDiv,r))?null:(i={activeElt:r},window.getSelection&&(t=window.getSelection(),t.anchorNode&&t.extend&&vi(n.display.lineDiv,t.anchorNode)&&(i.anchorNode=t.anchorNode,i.anchorOffset=t.anchorOffset,i.focusNode=t.focusNode,i.focusOffset=t.focusOffset)),i)}function gg(n){if(n&&n.activeElt&&n.activeElt!=fi()&&(n.activeElt.focus(),n.anchorNode&&vi(document.body,n.anchorNode)&&vi(document.body,n.focusNode))){var t=window.getSelection(),i=document.createRange();i.setEnd(n.anchorNode,n.anchorOffset);i.collapse(!1);t.removeAllRanges();t.addRange(i);t.extend(n.focusNode,n.focusOffset)}}function cc(n,i){var r=n.display,e=n.doc,s,o,h;if(i.editorIsHidden)return pi(n),!1;if(!i.force&&i.visible.from>=r.viewFrom&&i.visible.to<=r.viewTo&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo)&&r.renderedView==r.view&&yy(n)==0)return!1;hy(n)&&(pi(n),i.dims=ic(n));var c=e.first+e.size,u=Math.max(i.visible.from-n.options.viewportMargin,e.first),f=Math.min(c,i.visible.to+n.options.viewportMargin);return(r.viewFrom<u&&u-r.viewFrom<20&&(u=Math.max(e.first,r.viewFrom)),r.viewTo>f&&r.viewTo-f<20&&(f=Math.min(c,r.viewTo)),hi&&(u=uh(n.doc,u),f=aa(n.doc,f)),s=u!=r.viewFrom||f!=r.viewTo||r.lastWrapHeight!=i.wrapperHeight||r.lastWrapWidth!=i.wrapperWidth,wg(n,u,f),r.viewOffset=ei(t(n.doc,r.viewFrom)),n.display.mover.style.top=r.viewOffset+"px",o=yy(n),!s&&o==0&&!i.force&&r.renderedView==r.view&&(r.updateLineNumbers==null||r.updateLineNumbers>=r.viewTo))?!1:(h=dg(n),o>4&&(r.lineDiv.style.display="none"),nn(n,r.updateLineNumbers,i.dims),o>4&&(r.lineDiv.style.display=""),r.renderedView=r.view,gg(h),ai(r.cursorDiv),ai(r.selectionDiv),r.gutters.style.height=r.sizer.style.minHeight=0,s&&(r.lastWrapHeight=i.wrapperHeight,r.lastWrapWidth=i.wrapperWidth,ne(n,400)),r.updateLineNumbers=null,!0)}function py(n,t){for(var r,i=t.viewport,u=!0;;u=!1){if((!u||!n.options.lineWrapping||t.oldDisplayWidth==or(n))&&(i&&i.top!=null&&(i={top:Math.min(n.doc.height+ph(n.display)-wh(n),i.top)}),t.visible=oc(n.display,n.doc,i),t.visible.from>=n.display.viewFrom&&t.visible.to<=n.display.viewTo))break;if(!cc(n,t))break;vo(n);r=gf(n);wf(n);uu(n,r);vc(n,r);t.force=!1}t.signal(n,"update",n);(n.display.viewFrom!=n.display.reportedViewFrom||n.display.viewTo!=n.display.reportedViewTo)&&(t.signal(n,"viewportChange",n,n.display.viewFrom,n.display.viewTo),n.display.reportedViewFrom=n.display.viewFrom,n.display.reportedViewTo=n.display.viewTo)}function lc(n,t){var i=new ye(n,t),r;cc(n,i)&&(vo(n),py(n,i),r=gf(n),wf(n),uu(n,r),vc(n,r),i.finish())}function nn(n,t,i){function c(t){var i=t.nextSibling;return tt&&kt&&n.display.currentWheelTarget==t?t.style.display="none":t.parentNode.removeChild(t),i}for(var r,l,e,o=n.display,v=n.options.lineNumbers,s=o.lineDiv,u=s.firstChild,a=o.view,f=o.viewFrom,h=0;h<a.length;h++){if(r=a[h],!r.hidden)if(r.node&&r.node.parentNode==s){while(u!=r.node)u=c(u);e=v&&t!=null&&t<=f&&r.lineNumber;r.changes&&(d(r.changes,"gutter")>-1&&(e=!1),ev(n,r,f,i));e&&(ai(r.lineNumber),r.lineNumber.appendChild(document.createTextNode(nh(n.options,f))));u=r.node.nextSibling}else l=wd(n,r,f,i),s.insertBefore(l,u);f+=r.size}while(u)u=c(u)}function ac(n){var t=n.display.gutters.offsetWidth;n.display.sizer.style.marginLeft=t+"px"}function vc(n,t){n.display.sizer.style.minHeight=t.docHeight+"px";n.display.heightForcer.style.top=t.docHeight+"px";n.display.gutters.style.height=t.docHeight+n.display.barHeight+ti(n)+"px"}function wy(n){var r=n.display.gutters,e=n.options.gutters,t,u,f;for(ai(r),t=0;t<e.length;++t)u=e[t],f=r.appendChild(i("div",null,"CodeMirror-gutter "+u)),u=="CodeMirror-linenumbers"&&(n.display.lineGutter=f,f.style.width=(n.display.lineNumWidth||1)+"px");r.style.display=t?"":"none";ac(n)}function yc(n){var t=d(n.gutters,"CodeMirror-linenumbers");t==-1&&n.lineNumbers?n.gutters=n.gutters.concat(["CodeMirror-linenumbers"]):t>-1&&!n.lineNumbers&&(n.gutters=n.gutters.slice(0),n.gutters.splice(t,1))}function by(n){var i=n.wheelDeltaX,t=n.wheelDeltaY;return i==null&&n.detail&&n.axis==n.HORIZONTAL_AXIS&&(i=n.detail),t==null&&n.detail&&n.axis==n.VERTICAL_AXIS?t=n.detail:t==null&&(t=n.wheelDelta),{x:i,y:t}}function tn(n){var t=by(n);return t.x*=st,t.y*=st,t}function ky(n,t){var v=by(t),e=v.x,u=v.y,i=n.display,r=i.scroller,y=r.scrollWidth>r.clientWidth,h=r.scrollHeight>r.clientHeight,f,c,o;if(e&&y||u&&h){if(u&&kt&&tt)n:for(f=t.target,c=i.view;f!=r;f=f.parentNode)for(o=0;o<c.length;o++)if(c[o].node==f){n.display.currentWheelTarget=f;break n}if(e&&!ki&&!bt&&st!=null){u&&h&&df(n,Math.max(0,r.scrollTop+u*st));lr(n,Math.max(0,r.scrollLeft+e*st));(!u||u&&h)&&ft(t);i.wheelStartX=null;return}if(u&&st!=null){var l=u*st,s=n.doc.scrollTop,a=s+i.wrapper.clientHeight;l<0?s=Math.max(0,s+l-50):a=Math.min(n.doc.height,a+l+50);lc(n,{top:s,bottom:a})}pe<20&&(i.wheelStartX==null?(i.wheelStartX=r.scrollLeft,i.wheelStartY=r.scrollTop,i.wheelDX=e,i.wheelDY=u,setTimeout(function(){if(i.wheelStartX!=null){var n=r.scrollLeft-i.wheelStartX,t=r.scrollTop-i.wheelStartY,u=t&&i.wheelDY&&t/i.wheelDY||n&&i.wheelDX&&n/i.wheelDX;(i.wheelStartX=i.wheelStartY=null,u)&&(st=(st*pe+u)/(pe+1),++pe)}},200)):(i.wheelDX+=e,i.wheelDY+=u))}}function wt(n,t){var c=n[t],i,f,r;for(n.sort(function(n,t){return u(n.from(),t.from())}),t=d(n,c),i=1;i<n.length;i++)if(f=n[i],r=n[i-1],u(r.to(),f.from())>=0){var e=ro(r.from(),f.from()),s=io(r.to(),f.to()),h=r.empty()?f.from()==f.head:r.from()==r.head;i<=t&&--t;n.splice(--i,2,new o(h?s:e,h?e:s))}return new ht(n,t)}function wi(n,t){return new ht([new o(n,t||n)],0)}function bi(t){return t.text?n(t.from.line+t.text.length-1,s(t.text).length+(t.text.length==1?t.from.ch:0)):t.to}function dy(t,i){if(u(t,i.from)<0)return t;if(u(t,i.to)<=0)return bi(i);var f=t.line+i.text.length-(i.to.line-i.from.line)-1,r=t.ch;return t.line==i.to.line&&(r+=bi(i).ch-i.to.ch),n(f,r)}function pc(n,t){for(var i,u=[],r=0;r<n.sel.ranges.length;r++)i=n.sel.ranges[r],u.push(new o(dy(i.anchor,t),dy(i.head,t)));return wt(u,n.sel.primIndex)}function gy(t,i,r){return t.line==i.line?n(r.line,t.ch-i.ch+r.ch):n(r.line+(t.line-i.line),t.ch)}function rn(t,i,r){for(var h,c,l=[],e=n(t.first,0),a=e,f=0;f<i.length;f++){var v=i[f],s=gy(v.from,e,a),y=gy(bi(v),e,a);e=v.to;a=y;r=="around"?(h=t.sel.ranges[f],c=u(h.head,h.anchor)<0,l[f]=new o(c?y:s,c?s:y)):l[f]=new o(s,s)}return new ht(l,t.sel.primIndex)}function wc(n){n.doc.mode=ch(n.options,n.doc.modeOption);te(n)}function te(n){n.doc.iter(function(n){n.stateAfter&&(n.stateAfter=null);n.styles&&(n.styles=null)});n.doc.modeFrontier=n.doc.highlightFrontier=n.doc.first;ne(n,100);n.state.modeGen++;n.curOp&&et(n)}function np(n,t){return t.from.ch==0&&t.to.ch==0&&s(t.text)==""&&(!n.cm||n.cm.options.wholeLineUpdateBefore)}function bc(n,i,r,u){function a(n){return r?r[n]:null}function h(n,t,r){id(n,t,r,u);g(n,"change",n,i)}function y(n,t){for(var r=[],i=n;i<t;++i)r.push(new kr(f[i],a(i),u));return r}var e=i.from,c=i.to,f=i.text,o=t(n,e.line),l=t(n,c.line),w=s(f),p=a(f.length-1),v=c.line-e.line,b,k,d;i.full?(n.insert(0,y(0,f.length)),n.remove(f.length,n.size-f.length)):np(n,i)?(b=y(0,f.length-1),h(l,l.text,p),v&&n.remove(e.line,v),b.length&&n.insert(e.line,b)):o==l?f.length==1?h(o,o.text.slice(0,e.ch)+w+o.text.slice(c.ch),p):(k=y(1,f.length-1),k.push(new kr(w+o.text.slice(c.ch),p,u)),h(o,o.text.slice(0,e.ch)+f[0],a(0)),n.insert(e.line+1,k)):f.length==1?(h(o,o.text.slice(0,e.ch)+f[0]+l.text.slice(c.ch),a(0)),n.remove(e.line+1,v)):(h(o,o.text.slice(0,e.ch)+f[0],a(0)),h(l,w+l.text.slice(c.ch),p),d=y(1,f.length-1),v>1&&n.remove(e.line+1,v-1),n.insert(e.line+1,d));g(n,"change",n,i)}function yr(n,t,i){function r(n,u,f){var o,e,s;if(n.linked)for(o=0;o<n.linked.length;++o)(e=n.linked[o],e.doc!=u)&&(s=f&&e.sharedHist,!i||s)&&(t(e.doc,s),r(e.doc,n,s))}r(n,null,!0)}function tp(n,t){if(t.cm)throw new Error("This document is already in use.");n.doc=t;t.cm=n;uc(n);wc(n);ip(n);n.options.lineWrapping||eh(n);n.options.mode=t.modeOption;et(n)}function ip(n){(n.doc.direction=="rtl"?tr:di)(n.display.lineDiv,"CodeMirror-rtl")}function un(n){ot(n,function(){ip(n);et(n)})}function wo(n){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=this.lastSelOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=n||1}function kc(n,t){var i={from:ih(t.from),to:bi(t),text:rr(n,t.from,t.to)};return fp(n,i,t.from.line,t.to.line+1),yr(n,function(n){return fp(n,i,t.from.line,t.to.line+1)},!0),i}function rp(n){while(n.length){var t=s(n);if(t.ranges)n.pop();else break}}function fn(n,t){return t?(rp(n.done),s(n.done)):n.done.length&&!s(n.done).ranges?s(n.done):n.done.length>1&&!n.done[n.done.length-2].ranges?(n.done.pop(),s(n.done)):void 0}function up(n,t,i,r){var f=n.history,h,e,o,c;if(f.undone.length=0,h=+new Date,(f.lastOp==r||f.lastOrigin==t.origin&&t.origin&&(t.origin.charAt(0)=="+"&&n.cm&&f.lastModTime>h-n.cm.options.historyEventDelay||t.origin.charAt(0)=="*"))&&(e=fn(f,f.lastOp==r)))o=s(e.changes),u(t.from,t.to)==0&&u(t.from,o.to)==0?o.to=bi(t):e.changes.push(kc(n,t));else for(c=s(f.done),c&&c.ranges||bo(n.sel,f.done),e={changes:[kc(n,t)],generation:f.generation},f.done.push(e);f.done.length>f.undoDepth;)f.done.shift(),f.done[0].ranges||f.done.shift();f.done.push(i);f.generation=++f.maxGeneration;f.lastModTime=f.lastSelTime=h;f.lastOp=f.lastSelOp=r;f.lastOrigin=f.lastSelOrigin=t.origin;o||y(n,"historyAdded")}function en(n,t,i,r){var u=t.charAt(0);return u=="*"||u=="+"&&i.ranges.length==r.ranges.length&&i.somethingSelected()==r.somethingSelected()&&new Date-n.history.lastSelTime<=(n.cm?n.cm.options.historyEventDelay:500)}function on(n,t,i,r){var u=n.history,f=r&&r.origin;i==u.lastSelOp||f&&u.lastSelOrigin==f&&(u.lastModTime==u.lastSelTime&&u.lastOrigin==f||en(n,f,s(u.done),t))?u.done[u.done.length-1]=t:bo(t,u.done);u.lastSelTime=+new Date;u.lastSelOrigin=f;u.lastSelOp=i;r&&r.clearRedo!==!1&&rp(u.undone)}function bo(n,t){var i=s(t);i&&i.ranges&&i.equals(n)||t.push(n)}function fp(n,t,i,r){var u=t["spans_"+n.id],f=0;n.iter(Math.max(n.first,i),Math.min(n.first+n.size,r),function(i){i.markedSpans&&((u||(u=t["spans_"+n.id]={}))[f]=i.markedSpans);++f})}function sn(n){var t,i;if(!n)return null;for(i=0;i<n.length;++i)n[i].marker.explicitlyCleared?t||(t=n.slice(0,i)):t&&t.push(n[i]);return t?t.length?t:null:n}function hn(n,t){var u=t["spans_"+n.id],r,i;if(!u)return null;for(r=[],i=0;i<t.text.length;++i)r.push(sn(u[i]));return r}function ep(n,t){var i=hn(n,t),s=rh(n,t),r,f,u,e,h,o;if(!i)return s;if(!s)return i;for(r=0;r<i.length;++r)if(f=i[r],u=s[r],f&&u)n:for(e=0;e<u.length;++e){for(h=u[e],o=0;o<f.length;++o)if(f[o].marker==h.marker)continue n;f.push(h)}else u&&(i[r]=u);return i}function fu(n,t,i){for(var u,h,e,o,r,c,f,l=[],a=0;a<n.length;++a){if(u=n[a],u.ranges){l.push(i?ht.prototype.deepCopy.call(u):u);continue}for(h=u.changes,e=[],l.push({changes:e}),o=0;o<h.length;++o)if(r=h[o],c=void 0,e.push({from:r.from,to:r.to,text:r.text}),t)for(f in r)(c=f.match(/^spans_(\d+)$/))&&d(t,Number(c[1]))>-1&&(s(e)[f]=r[f],delete r[f])}return l}function dc(n,t,i,r){var f,e;return r?(f=n.anchor,i&&(e=u(t,f)<0,e!=u(i,f)<0?(f=t,t=i):e!=u(t,i)<0&&(t=i)),new o(f,t)):new o(i||t,t)}function ko(n,t,i,r,u){u==null&&(u=n.cm&&(n.cm.display.shift||n.extend));nt(n,new ht([dc(n.sel.primary(),t,i,u)],0),r)}function op(n,t,i){for(var u,f=[],e=n.cm&&(n.cm.display.shift||n.extend),r=0;r<n.sel.ranges.length;r++)f[r]=dc(n.sel.ranges[r],t[r],null,e);u=wt(f,n.sel.primIndex);nt(n,u,i)}function gc(n,t,i,r){var u=n.sel.ranges.slice(0);u[t]=i;nt(n,wt(u,n.sel.primIndex),r)}function sp(n,t,i,r){nt(n,wi(t,i),r)}function cn(n,t,i){var r={ranges:t.ranges,update:function(t){var r=this,i;for(this.ranges=[],i=0;i<t.length;i++)r.ranges[i]=new o(f(n,t[i].anchor),f(n,t[i].head))},origin:i&&i.origin};return y(n,"beforeSelectionChange",n,r),n.cm&&y(n.cm,"beforeSelectionChange",n.cm,r),r.ranges!=t.ranges?wt(r.ranges,r.ranges.length-1):t}function hp(n,t,i){var r=n.history.done,u=s(r);u&&u.ranges?(r[r.length-1]=t,go(n,t,i)):nt(n,t,i)}function nt(n,t,i){go(n,t,i);on(n,n.sel,n.cm?n.cm.curOp.id:NaN,i)}function go(n,t,i){(vt(n,"beforeSelectionChange")||n.cm&&vt(n.cm,"beforeSelectionChange"))&&(t=cn(n,t,i));var r=i&&i.bias||(u(t.primary().head,n.sel.primary().head)<0?-1:1);cp(n,ap(n,t,r,!0));i&&i.scroll===!1||!n.cm||ru(n.cm)}function cp(n,t){t.equals(n.sel)||(n.sel=t,n.cm&&(n.cm.curOp.updateInput=n.cm.curOp.selectionChanged=!0,va(n.cm)),g(n,"cursorActivity",n))}function lp(n){cp(n,ap(n,n.sel,null,!1))}function ap(n,t,i,r){for(var f,u=0;u<t.ranges.length;u++){var e=t.ranges[u],s=t.ranges.length==n.sel.ranges.length&&n.sel.ranges[u],h=nl(n,e.anchor,s&&s.anchor,i,r),c=nl(n,e.head,s&&s.head,i,r);(f||h!=e.anchor||c!=e.head)&&(f||(f=t.ranges.slice(0,u)),f[u]=new o(h,c))}return f?wt(f,t.primIndex):t}function eu(n,i,r,f,e){var c=t(n,i.line),a,h,o,s,v,l;if(c.markedSpans)for(a=0;a<c.markedSpans.length;++a)if(h=c.markedSpans[a],o=h.marker,(h.from==null||(o.inclusiveLeft?h.from<=i.ch:h.from<i.ch))&&(h.to==null||(o.inclusiveRight?h.to>=i.ch:h.to>i.ch))){if(e&&(y(o,"beforeCursorEnter"),o.explicitlyCleared))if(c.markedSpans){--a;continue}else break;if(!o.atomic)continue;return r&&(s=o.find(f<0?1:-1),v=void 0,(f<0?o.inclusiveRight:o.inclusiveLeft)&&(s=vp(n,s,-f,s&&s.line==i.line?c:null)),s&&s.line==i.line&&(v=u(s,r))&&(f<0?v<0:v>0))?eu(n,s,i,f,e):(l=o.find(f<0?-1:1),(f<0?o.inclusiveLeft:o.inclusiveRight)&&(l=vp(n,l,f,l.line==i.line?c:null)),l?eu(n,l,i,f,e):null)}return i}function nl(t,i,r,u,f){var e=u||1,o=eu(t,i,r,e,f)||!f&&eu(t,i,r,e,!0)||eu(t,i,r,-e,f)||!f&&eu(t,i,r,-e,!0);return o?o:(t.cantEdit=!0,n(t.first,0))}function vp(i,r,u,e){return u<0&&r.ch==0?r.line>i.first?f(i,n(r.line-1)):null:u>0&&r.ch==(e||t(i,r.line)).text.length?r.line<i.first+i.size-1?n(r.line+1,0):null:new n(r.line,r.ch+u)}function yp(t){t.setSelection(n(t.firstLine(),0),n(t.lastLine()),ui)}function pp(n,t,i){var r={canceled:!1,from:t.from,to:t.to,text:t.text,origin:t.origin,cancel:function(){return r.canceled=!0}};return(i&&(r.update=function(t,i,u,e){t&&(r.from=f(n,t));i&&(r.to=f(n,i));u&&(r.text=u);e!==undefined&&(r.origin=e)}),y(n,"beforeChange",n,r),n.cm&&y(n.cm,"beforeChange",n.cm,r),r.canceled)?null:{from:r.from,to:r.to,text:r.text,origin:r.origin}}function ou(n,t,i){var u,r;if(n.cm){if(!n.cm.curOp)return b(n.cm,ou)(n,t,i);if(n.cm.state.suppressEdits)return}if(!vt(n,"beforeChange")&&(!n.cm||!vt(n.cm,"beforeChange"))||(t=pp(n,t,!0),t))if(u=ol&&!i&&lk(n,t.from,t.to),u)for(r=u.length-1;r>=0;--r)wp(n,{from:u[r].from,to:u[r].to,text:r?[""]:t.text,origin:t.origin});else wp(n,t)}function wp(n,t){var i,r;(t.text.length!=1||t.text[0]!=""||u(t.from,t.to)!=0)&&(i=pc(n,t),up(n,t,i,n.cm?n.cm.curOp.id:NaN),ie(n,t,i,rh(n,t)),r=[],yr(n,function(n,i){i||d(r,n.history)!=-1||(gp(n.history,t),r.push(n.history));ie(n,t,null,rh(n,t))}))}function ns(n,t,i){var h,a,v,e,c;if(!n.cm||!n.cm.state.suppressEdits||i){for(var u=n.history,r,y=n.sel,f=t=="undo"?u.done:u.undone,l=t=="undo"?u.undone:u.done,o=0;o<f.length;o++)if(r=f[o],i?r.ranges&&!r.equals(n.sel):!r.ranges)break;if(o!=f.length){for(u.lastOrigin=u.lastSelOrigin=null;;)if(r=f.pop(),r.ranges){if(bo(r,l),i&&!r.equals(n.sel)){nt(n,r,{clearRedo:!1});return}y=r}else break;for(h=[],bo(y,l),l.push({changes:h,generation:u.generation}),u.generation=r.generation||++u.maxGeneration,a=vt(n,"beforeChange")||n.cm&&vt(n.cm,"beforeChange"),v=function(i){var u=r.changes[i],o,e;if(u.origin=t,a&&!pp(n,u,!1))return f.length=0,{};h.push(kc(n,u));o=i?pc(n,u):s(f);ie(n,u,o,ep(n,u));!i&&n.cm&&n.cm.scrollIntoView({from:u.from,to:bi(u)});e=[];yr(n,function(n,t){t||d(e,n.history)!=-1||(gp(n.history,u),e.push(n.history));ie(n,u,null,ep(n,u))})},e=r.changes.length-1;e>=0;--e)if(c=v(e),c)return c.v}}}function bp(t,i){if(i!=0&&(t.first+=i,t.sel=new ht(no(t.sel.ranges,function(t){return new o(n(t.anchor.line+i,t.anchor.ch),n(t.head.line+i,t.head.ch))}),t.sel.primIndex),t.cm)){et(t.cm,t.first,t.first-i,i);for(var u=t.cm.display,r=u.viewFrom;r<u.viewTo;r++)yi(t.cm,r,"gutter")}}function ie(i,r,u,f){var o,e;if(i.cm&&!i.cm.curOp)return b(i.cm,ie)(i,r,u,f);if(r.to.line<i.first){bp(i,r.text.length-1-(r.to.line-r.from.line));return}r.from.line>i.lastLine()||(r.from.line<i.first&&(o=r.text.length-1-(i.first-r.from.line),bp(i,o),r={from:n(i.first,0),to:n(r.to.line+o,r.to.ch),text:[s(r.text)],origin:r.origin}),e=i.lastLine(),r.to.line>e&&(r={from:r.from,to:n(e,t(i,e).text.length),text:[r.text[0]],origin:r.origin}),r.removed=rr(i,r.from,r.to),u||(u=pc(i,r)),i.cm?ln(i.cm,r,f):bc(i,r,f),go(i,u,ui))}function ln(n,i,r){var f=n.doc,e=n.display,u=i.from,o=i.to,s=!1,c=u.line,y,l,a,v;n.options.lineWrapping||(c=h(ni(t(f,u.line))),f.iter(c,o.line+1,function(n){if(n==e.maxLine)return s=!0,!0}));f.sel.contains(i.from,i.to)>-1&&va(n);bc(f,i,r,iy(n));n.options.lineWrapping||(f.iter(c,u.line+i.text.length,function(n){var t=oo(n);t>e.maxLineLength&&(e.maxLine=n,e.maxLineLength=t,e.maxLineChanged=!0,s=!1)}),s&&(n.curOp.updateMaxLine=!0));td(f,u.line);ne(n,400);y=i.text.length-(o.line-u.line)-1;i.full?et(n):u.line!=o.line||i.text.length!=1||np(n.doc,i)?et(n,u.line,o.line+1,y):yi(n,u.line,"text");l=vt(n,"changes");a=vt(n,"change");(a||l)&&(v={from:u,to:o,text:i.text,removed:i.removed,origin:i.origin},a&&g(n,"change",n,v),l&&(n.curOp.changeObjs||(n.curOp.changeObjs=[])).push(v));n.display.selForContextMenu=null}function su(n,t,i,r,f){if(r||(r=i),u(r,i)<0){var e;e=[r,i];i=e[0];r=e[1];e}typeof t=="string"&&(t=n.splitLines(t));ou(n,{from:i,to:r,text:t,origin:f})}function kp(n,t,i,r){i<n.line?n.line+=r:t<n.line&&(n.line=t,n.ch=0)}function dp(t,i,r,u){for(var f,c,s,h,e,o=0;o<t.length;++o){if(f=t[o],c=!0,f.ranges){for(f.copied||(f=t[o]=f.deepCopy(),f.copied=!0),s=0;s<f.ranges.length;s++)kp(f.ranges[s].anchor,i,r,u),kp(f.ranges[s].head,i,r,u);continue}for(h=0;h<f.changes.length;++h)if(e=f.changes[h],r<e.from.line)e.from=n(e.from.line+u,e.from.ch),e.to=n(e.to.line+u,e.to.ch);else if(i<=e.to.line){c=!1;break}c||(t.splice(0,o+1),o=0)}}function gp(n,t){var i=t.from.line,r=t.to.line,u=t.text.length-(r-i)-1;dp(n.done,i,r,u);dp(n.undone,i,r,u)}function re(n,i,r,u){var f=i,e=i;return(typeof i=="number"?e=t(n,ra(n,i)):f=h(i),f==null)?null:(u(e,f)&&n.cm&&yi(n.cm,f,r),e)}function ue(n){var r=this,i,t;for(this.lines=n,this.parent=null,i=0,t=0;t<n.length;++t)n[t].parent=r,i+=n[t].height;this.height=i}function fe(n){var f=this,r,u,t,i;for(this.children=n,r=0,u=0,t=0;t<n.length;++t)i=n[t],r+=i.chunkSize(),u+=i.height,i.parent=f;this.size=r;this.height=u;this.parent=null}function nw(n,t,i){ei(t)<(n.curOp&&n.curOp.scrollTop||n.doc.scrollTop)&&hc(n,i)}function an(n,t,i,r){var u=new ku(n,i,r),f=n.cm;return f&&u.noHScroll&&(f.display.alignWidgets=!0),re(n,t,"widget",function(t){var i=t.widgets||(t.widgets=[]),r;return u.insertAt==null?i.push(u):i.splice(Math.min(i.length-1,Math.max(0,u.insertAt)),0,u),u.line=t,f&&!fr(n,t)&&(r=ei(t)<n.scrollTop,gt(t,t.height+vf(u)),r&&hc(f,u.height),f.curOp.forceUpdate=!0),!0}),g(f,"lineWidgetAdded",f,u,typeof t=="number"?t:h(t)),u}function hu(n,t,i,f,e){var o,l,h,s,a,c;if(f&&f.shared)return vn(n,t,i,f,e);if(n.cm&&!n.cm.curOp)return b(n.cm,hu)(n,t,i,f,e);if(o=new ci(n,e),l=u(t,i),f&&ir(f,o,!1),l>0||l==0&&o.clearWhenEmpty!==!1)return o;if(o.replacedWith&&(o.collapsed=!0,o.widgetNode=nu("span",[o.replacedWith],"CodeMirror-widget"),f.handleMouseEvents||o.widgetNode.setAttribute("cm-ignore-events","true"),f.insertLeft&&(o.widgetNode.insertLeft=!0)),o.collapsed){if(la(n,t.line,t,i,o)||t.line!=i.line&&la(n,i.line,t,i,o))throw new Error("Inserting collapsed marker partially overlapping an existing one");ek()}if(o.addToHistory&&up(n,{from:t,to:i,origin:"markText"},n.sel,NaN),h=t.line,s=n.cm,n.iter(h,i.line+1,function(n){s&&o.collapsed&&!s.options.lineWrapping&&ni(n)==s.display.maxLine&&(a=!0);o.collapsed&&h!=t.line&&gt(n,0);sk(n,new uo(o,h==t.line?t.ch:null,h==i.line?i.ch:null));++h}),o.collapsed&&n.iter(t.line,i.line+1,function(t){fr(n,t)&&gt(t,0)}),o.clearOnEnter&&r(o,"beforeCursorEnter",function(){return o.clear()}),o.readOnly&&(fk(),(n.history.done.length||n.history.undone.length)&&n.clearHistory()),o.collapsed&&(o.id=++yl,o.atomic=!0),s){if(a&&(s.curOp.updateMaxLine=!0),o.collapsed)et(s,t.line,i.line+1);else if(o.className||o.title||o.startStyle||o.endStyle||o.css)for(c=t.line;c<=i.line;c++)yi(s,c,"text");o.atomic&&lp(s.doc);g(s,"markerAdded",s,o)}return o}function vn(n,t,i,r,u){r=ir(r);r.shared=!1;var e=[hu(n,t,i,r,u)],o=e[0],h=r.widgetNode;return yr(n,function(n){h&&(r.widgetNode=h.cloneNode(!0));e.push(hu(n,f(n,t),f(n,i),r,u));for(var c=0;c<n.linked.length;++c)if(n.linked[c].isParent)return;o=s(e)}),new du(e,o)}function tw(t){return t.findMarks(n(t.first,0),t.clipPos(n(t.lastLine())),function(n){return n.parent})}function yn(n,t){for(var f,r=0;r<t.length;r++){var i=t[r],e=i.find(),o=n.clipPos(e.from),s=n.clipPos(e.to);u(o,s)&&(f=hu(n,o,s,i.primary,i.primary.type),i.markers.push(f),f.parent=i)}}function pn(n){for(var i=function(t){var i=n[t],f=[i.primary.doc],r,u;for(yr(i.primary.doc,function(n){return f.push(n)}),r=0;r<i.markers.length;r++)u=i.markers[r],d(f,u.doc)==-1&&(u.parent=null,i.markers.splice(r--,1))},t=0;t<n.length;t++)i(t)}function wn(n){var t=this,i,r,u,h,o,s;if((iw(t),!w(t,n)&&!si(t.display,n))&&(ft(n),e&&(pl=+new Date),i=hr(t,n,!0),r=n.dataTransfer.files,i&&!t.isReadOnly()))if(r&&r.length&&window.FileReader&&window.File){var c=r.length,l=Array(c),a=0,v=function(n,r){if(!t.options.allowDropFileTypes||d(t.options.allowDropFileTypes,n.type)!=-1){var u=new FileReader;u.onload=b(t,function(){var n=u.result,e;/[\x00-\x08\x0e-\x1f]{2}/.test(n)&&(n="");l[r]=n;++a==c&&(i=f(t.doc,i),e={from:i,to:i,text:t.doc.splitLines(l.join(t.doc.lineSeparator())),origin:"paste"},ou(t.doc,e),hp(t.doc,wi(i,bi(e))))});u.readAsText(n)}};for(u=0;u<c;++u)v(r[u],u)}else{if(t.state.draggingText&&t.doc.sel.contains(i)>-1){t.state.draggingText(n);setTimeout(function(){return t.display.input.focus()},20);return}try{if(h=n.dataTransfer.getData("Text"),h){if(t.state.draggingText&&!t.state.draggingText.copy&&(o=t.listSelections()),go(t.doc,wi(i,i)),o)for(s=0;s<o.length;++s)su(t.doc,"",o[s].anchor,o[s].head,"drag");t.replaceSelection(h,"around","paste");t.display.input.focus()}}catch(n){}}}function bn(n,t){if(e&&(!n.state.draggingText||+new Date-pl<100)){cf(t);return}if(!w(n,t)&&!si(n.display,t)&&(t.dataTransfer.setData("Text",n.getSelection()),t.dataTransfer.effectAllowed="copyMove",t.dataTransfer.setDragImage&&!hb)){var r=i("img",null,null,"position: fixed; left: 0; top: 0;");r.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";bt&&(r.width=r.height=1,n.display.wrapper.appendChild(r),r._top=r.offsetTop);t.dataTransfer.setDragImage(r,0,0);bt&&r.parentNode.removeChild(r)}}function kn(n,t){var u=hr(n,t),r;u&&(r=document.createDocumentFragment(),uy(n,u,r),n.display.dragCursor||(n.display.dragCursor=i("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),n.display.lineSpace.insertBefore(n.display.dragCursor,n.display.cursorDiv)),ct(n.display.dragCursor,r))}function iw(n){n.display.dragCursor&&(n.display.lineSpace.removeChild(n.display.dragCursor),n.display.dragCursor=null)}function rw(n){var i,t,r;if(document.getElementsByClassName)for(i=document.getElementsByClassName("CodeMirror"),t=0;t<i.length;t++)r=i[t].CodeMirror,r&&n(r)}function dn(){wl||(gn(),wl=!0)}function gn(){var n;r(window,"resize",function(){n==null&&(n=setTimeout(function(){n=null;rw(ntt)},100))});r(window,"blur",function(){return rw(bf)})}function ntt(n){var t=n.display;(t.lastWrapHeight!=t.wrapper.clientHeight||t.lastWrapWidth!=t.wrapper.clientWidth)&&(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,n.setSize())}function ttt(n){var i=n.split(/-(?!$)/),u,f,e,o,r,t;for(n=i[i.length-1],r=0;r<i.length-1;r++)if(t=i[r],/^(cmd|meta|m)$/i.test(t))o=!0;else if(/^a(lt)?$/i.test(t))u=!0;else if(/^(c|ctrl|control)$/i.test(t))f=!0;else if(/^s(hift)?$/i.test(t))e=!0;else throw new Error("Unrecognized modifier name: "+t);return u&&(n="Alt-"+n),f&&(n="Ctrl-"+n),o&&(n="Cmd-"+n),e&&(n="Shift-"+n),n}function itt(n){var e={},t,o,r,u,f,i,s,h;for(t in n)if(n.hasOwnProperty(t)){if(o=n[t],/^(name|fallthrough|(de|at)tach)$/.test(t))continue;if(o=="..."){delete n[t];continue}for(r=no(t.split(" "),ttt),u=0;u<r.length;u++)if(f=void 0,i=void 0,u==r.length-1?(i=r.join(" "),f=o):(i=r.slice(0,u+1).join(" "),f="..."),s=e[i],s){if(s!=f)throw new Error("Inconsistent bindings for "+i);}else e[i]=f;delete n[t]}for(h in e)n[h]=e[h];return n}function cu(n,t,i,r){var u,f,e;if(t=ts(t),u=t.call?t.call(n,r):t[n],u===!1)return"nothing";if(u==="...")return"multi";if(u!=null&&i(u))return"handled";if(t.fallthrough){if(Object.prototype.toString.call(t.fallthrough)!="[object Array]")return cu(n,t.fallthrough,i,r);for(f=0;f<t.fallthrough.length;f++)if(e=cu(n,t.fallthrough[f],i,r),e)return e}}function uw(n){var t=typeof n=="string"?n:li[n.keyCode];return t=="Ctrl"||t=="Alt"||t=="Shift"||t=="Mod"}function fw(n,t,i){var r=n;return t.altKey&&r!="Alt"&&(n="Alt-"+n),(el?t.metaKey:t.ctrlKey)&&r!="Ctrl"&&(n="Ctrl-"+n),(el?t.ctrlKey:t.metaKey)&&r!="Cmd"&&(n="Cmd-"+n),!i&&t.shiftKey&&r!="Shift"&&(n="Shift-"+n),n}function ew(n,t){if(bt&&n.keyCode==34&&n.char)return!1;var i=li[n.keyCode];return i==null||n.altGraphKey?!1:fw(i,n,t)}function ts(n){return typeof n=="string"?ri[n]:n}function lu(n,t){for(var r,f,o=n.doc.sel.ranges,i=[],e=0;e<o.length;e++){for(r=t(o[e]);i.length&&u(r.from,s(i).to)<=0;)if(f=i.pop(),u(f.from,r.from)<0){r.from=f.from;break}i.push(r)}ot(n,function(){for(var t=i.length-1;t>=0;t--)su(n.doc,"",i[t].from,i[t].to,"+delete");ru(n)})}function tl(n,t,i){var r=ia(n.text,t+i,i);return r<0||r>n.text.length?null:r}function ow(t,i,r){var u=tl(t,i.ch,r);return u==null?null:new n(i.line,u,r<0?"after":"before")}function il(t,i,r,u,f){var h,c,l;if(t&&(h=oi(r,i.doc.direction),h)){var o=f<0?s(h):h[0],v=f<0==(o.level==1),a=v?"after":"before",e;return o.level>0||i.doc.direction=="rtl"?(c=iu(i,r),e=f<0?r.text.length-1:0,l=ii(i,c,e).top,e=ff(function(n){return ii(i,c,n).top==l},f<0==(o.level==1)?o.from:o.to-1,e),a=="before"&&(e=tl(r,e,1))):e=f<0?o.to:o.from,new n(u,e,a)}return new n(u,f<0?r.text.length:0,f<0?"before":"after")}function rtt(t,i,r,u){var o=oi(i,t.doc.direction),v,f,l,e,w,y,s,a;if(!o||(r.ch>=i.text.length?(r.ch=i.text.length,r.sticky="before"):r.ch<=0&&(r.ch=0,r.sticky="after"),v=hf(o,r.ch,r.sticky),f=o[v],t.doc.direction=="ltr"&&f.level%2==0&&(u>0?f.to>r.ch:f.from<r.ch)))return ow(i,r,u);var h=function(t,r){return tl(i,t instanceof n?t.ch:t,r)},p,b=function(n){return t.options.lineWrapping?(p=p||iu(t,i),ty(t,i,p,n)):{begin:0,end:i.text.length}},c=b(r.sticky=="before"?h(r,-1):r.ch);return(t.doc.direction=="rtl"||f.level==1)&&(l=f.level==1==u<0,e=h(r,l?1:-1),e!=null&&(l?e<=f.to&&e<=c.end:e>=f.from&&e>=c.begin))?(w=l?"before":"after",new n(r.line,e,w)):(y=function(t,i,u){for(var c=function(t,i){return i?new n(r.line,h(t,1),"before"):new n(r.line,t,"after")};t>=0&&t<o.length;t+=i){var e=o[t],s=i>0==(e.level!=1),f=s?u.begin:h(u.end,-1);if(e.from<=f&&f<e.to||(f=s?e.from:h(e.to,-1),u.begin<=f&&f<u.end))return c(f,s)}},s=y(v+u,u,c),s)?s:(a=u>0?c.end:h(c.begin,-1),a!=null&&!(u>0&&a==i.text.length)&&(s=y(u>0?0:o.length-1,u,b(a)),s))?s:null}function sw(n,i){var u=t(n.doc,i),r=ni(u);return r!=u&&(i=h(r)),il(!0,n,r,i,1)}function utt(n,i){var r=t(n.doc,i),u=ak(r);return u!=r&&(i=h(u)),il(!0,n,r,i,-1)}function hw(i,r){var u=sw(i,r.line),e=t(i.doc,u.line),o=oi(e,i.doc.direction),f,s;return!o||o[0].level==0?(f=Math.max(0,e.text.search(/\S/)),s=r.line==u.line&&r.ch<=f&&r.ch,n(u.line,s?0:f,u.sticky)):u}function is(n,t,i){if(typeof t=="string"&&(t=tf[t],!t))return!1;n.display.input.ensurePolled();var u=n.display.shift,r=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0);i&&(n.display.shift=!1);r=t(n)!=as}finally{n.display.shift=u;n.state.suppressEdits=!1}return r}function ftt(n,t,i){for(var r,u=0;u<n.state.keyMaps.length;u++)if(r=cu(t,n.state.keyMaps[u],i,n),r)return r;return n.options.extraKeys&&cu(t,n.options.extraKeys,i,n)||cu(t,n.options.keyMap,i,n)}function ee(n,t,i,r){var u=n.state.keySeq;if(u){if(uw(t))return"handled";if(/\'$/.test(t)?n.state.keySeq=null:kb.set(50,function(){n.state.keySeq==u&&(n.state.keySeq=null,n.display.input.reset())}),cw(n,u+" "+t,i,r))return!0}return cw(n,t,i,r)}function cw(n,t,i,r){var u=ftt(n,t,r);return u=="multi"&&(n.state.keySeq=t),u=="handled"&&g(n,"keyHandled",n,t,i),(u=="handled"||u=="multi")&&(ft(i),fc(n)),!!u}function lw(n,t){var i=ew(t,!0);return i?t.shiftKey&&!n.state.keySeq?ee(n,"Shift-"+i,t,function(t){return is(n,t,!0)})||ee(n,i,t,function(t){if(typeof t=="string"?/^go[A-Z]/.test(t):t.motion)return is(n,t)}):ee(n,i,t,function(t){return is(n,t)}):!1}function ett(n,t,i){return ee(n,"'"+i+"'",t,function(t){return is(n,t,!0)})}function aw(n){var t=this,i,r;(t.curOp.focus=fi(),w(t,n))||(e&&l<11&&n.keyCode==27&&(n.returnValue=!1),i=n.keyCode,t.display.shift=i==16||n.shiftKey,r=lw(t,n),bt&&(hs=r?i:null,r||i!=88||lit||!(kt?n.metaKey:n.ctrlKey)||t.replaceSelection("",null,"cut")),i!=18||/\bCodeMirror-crosshair\b/.test(t.display.lineDiv.className)||ott(t))}function ott(n){function t(n){n.keyCode!=18&&n.altKey||(di(i,"CodeMirror-crosshair"),lt(document,"keyup",t),lt(document,"mouseover",t))}var i=n.display.lineDiv;tr(i,"CodeMirror-crosshair");r(document,"keyup",t);r(document,"mouseover",t)}function vw(n){n.keyCode==16&&(this.doc.sel.shift=!1);w(this,n)}function yw(n){var t=this,i,r,u;if(!si(t.display,n)&&!w(t,n)&&(!n.ctrlKey||n.altKey)&&(!kt||!n.metaKey)){if(i=n.keyCode,r=n.charCode,bt&&i==hs){hs=null;ft(n);return}if((!bt||!(!n.which||n.which<10)||!lw(t,n))&&(u=String.fromCharCode(r==null?i:r),u!="\b")&&!ett(t,n,u))t.display.input.onKeyPress(n)}}function stt(n,t){var i=+new Date;return ke&&ke.compare(i,n,t)?(be=ke=null,"triple"):be&&be.compare(i,n,t)?(ke=new cs(i,n,t),be=null,"double"):(be=new cs(i,n,t),ke=null,"single")}function pw(n){var t=this,i=t.display;if(!w(t,n)&&(!i.activeTouch||!i.input.supportsTouch())){if(i.input.ensurePolled(),i.shift=n.shiftKey,si(i,n)){tt||(i.scroller.draggable=!1,setTimeout(function(){return i.scroller.draggable=!0},100));return}if(!rl(t,n)){var r=hr(t,n),u=pa(n),f=r?stt(r,u):"single";(window.focus(),u==1&&t.state.selectingText&&t.state.selectingText(n),r&&htt(t,u,r,f,n))||(u==1?r?ltt(t,r,f,n):hh(n)==i.scroller&&ft(n):u==2?(r&&ko(t.doc,r),setTimeout(function(){return i.input.focus()},20)):u==3&&(os?kw(t,n):ey(t)))}}}function htt(n,t,i,r,u){var f="Click";return r=="double"?f="Double"+f:r=="triple"&&(f="Triple"+f),f=(t==1?"Left":t==2?"Middle":"Right")+f,ee(n,fw(f,u),u,function(t){if(typeof t=="string"&&(t=tf[t]),!t)return!1;var r=!1;try{n.isReadOnly()&&(n.state.suppressEdits=!0);r=t(n,i)!=as}finally{n.state.suppressEdits=!1}return r})}function ctt(n,t,i){var u=n.getOption("configureMouse"),r=u?u(n,t,i):{},f;return r.unit==null&&(f=sit?i.shiftKey&&i.metaKey:i.altKey,r.unit=f?"rectangle":t=="single"?"char":t=="double"?"word":"line"),(r.extend==null||n.doc.extend)&&(r.extend=n.doc.extend||i.shiftKey),r.addNew==null&&(r.addNew=kt?i.metaKey:i.ctrlKey),r.moveOnDrag==null&&(r.moveOnDrag=!(kt?i.altKey:i.ctrlKey)),r}function ltt(n,t,i,r){e?setTimeout(ps(fy,n),0):n.curOp.focus=fi();var o=ctt(n,i,r),s=n.doc.sel,f;n.options.dragDrop&&vb&&!n.isReadOnly()&&i=="single"&&(f=s.contains(t))>-1&&(u((f=s.ranges[f]).from(),t)<0||t.xRel>0)&&(u(f.to(),t)>0||t.xRel<0)?att(n,r,t,o):vtt(n,r,t,o)}function att(n,t,i,u){var f=n.display,s=!1,o=b(n,function(t){tt&&(f.scroller.draggable=!1);n.state.draggingText=!1;lt(document,"mouseup",o);lt(document,"mousemove",h);lt(f.scroller,"dragstart",c);lt(f.scroller,"drop",o);s||(ft(t),u.addNew||ko(n.doc,i,null,null,u.extend),tt||e&&l==9?setTimeout(function(){document.body.focus();f.input.focus()},20):f.input.focus())}),h=function(n){s=s||Math.abs(t.clientX-n.clientX)+Math.abs(t.clientY-n.clientY)>=10},c=function(){return s=!0};tt&&(f.scroller.draggable=!0);n.state.draggingText=o;o.copy=!u.moveOnDrag;f.scroller.dragDrop&&f.scroller.dragDrop();r(document,"mouseup",o);r(document,"mousemove",h);r(f.scroller,"dragstart",c);r(f.scroller,"drop",o);ey(n);setTimeout(function(){return f.input.focus()},20)}function ww(t,i,r){if(r=="char")return new o(i,i);if(r=="word")return t.findWordAt(i);if(r=="line")return new o(n(i.line,0),f(t.doc,n(i.line+1,0)));var u=r(t,i);return new o(u.from,u.to)}function vtt(i,e,s,h){function et(r){var e,ut,b,v,tt;if(u(d,r)!=0)if(d=r,h.unit=="rectangle"){var p=[],k=i.options.tabSize,ft=at(t(c,s.line).text,s.ch,k),et=at(t(c,r.line).text,r.ch,k),ot=Math.min(ft,et),st=Math.max(ft,et);for(e=Math.min(s.line,r.line),ut=Math.min(i.lastLine(),Math.max(s.line,r.line));e<=ut;e++)b=t(c,e).text,v=ws(b,ot,k),ot==st?p.push(new o(n(e,v),n(e,v))):b.length>v&&p.push(new o(n(e,v),n(e,ws(b,st,k))));p.length||p.push(new o(s,s));nt(c,wt(y.ranges.slice(0,l).concat(p),l),{origin:"*mouse",scroll:!1});i.scrollIntoView(r)}else{var it=a,w=ww(i,r,h.unit),g=it.anchor,rt;u(w.anchor,g)>0?(rt=w.head,g=ro(it.from(),w.anchor)):(rt=w.anchor,g=io(it.to(),w.head));tt=y.ranges.slice(0);tt[l]=ytt(i,new o(f(c,g),rt));nt(c,wt(tt,l),bl)}}function tt(n){var e=++p,t=hr(i,n,!0,h.unit=="rectangle"),r,f;t&&(u(t,d)!=0?(i.curOp.focus=fi(),et(t),r=oc(w,c),(t.line>=r.to||t.line<r.from)&&setTimeout(b(i,function(){p==e&&tt(n)}),150)):(f=n.clientY<it.top?-20:n.clientY>it.bottom?20:0,f&&setTimeout(b(i,function(){p==e&&(w.scroller.scrollTop+=f,tt(n))}),50)))}function ut(n){i.state.selectingText=!1;p=Infinity;ft(n);w.input.focus();lt(document,"mousemove",rt);lt(document,"mouseup",g);c.history.lastSelOrigin=null}var w=i.display,c=i.doc,a,l,y,v,k,d,it,p,rt,g;ft(e);y=c.sel;v=y.ranges;h.addNew&&!h.extend?(l=c.sel.contains(s),a=l>-1?v[l]:new o(s,s)):(a=c.sel.primary(),l=c.sel.primIndex);h.unit=="rectangle"?(h.addNew||(a=new o(s,s)),s=hr(i,e,!0,!0),l=-1):(k=ww(i,s,h.unit),a=h.extend?dc(a,k.anchor,k.head,h.extend):k);h.addNew?l==-1?(l=v.length,nt(c,wt(v.concat([a]),l),{scroll:!1,origin:"*mouse"})):v.length>1&&v[l].empty()&&h.unit=="char"&&!h.extend?(nt(c,wt(v.slice(0,l).concat(v.slice(l+1)),0),{scroll:!1,origin:"*mouse"}),y=c.sel):gc(c,l,a,bl):(l=0,nt(c,new ht([a],0),bl),y=c.sel);d=s;it=w.wrapper.getBoundingClientRect();p=0;rt=b(i,function(n){pa(n)?tt(n):ut(n)});g=b(i,ut);i.state.selectingText=g;r(document,"mousemove",rt);r(document,"mouseup",g)}function ytt(i,r){var f=r.anchor,e=r.head,d=t(i.doc,f.line),s,l,h,c,a,v,y;if(u(f,e)==0&&f.sticky==e.sticky||(s=oi(d),!s)||(l=hf(s,f.ch,f.sticky),h=s[l],h.from!=f.ch&&h.to!=f.ch)||(c=l+(h.from==f.ch==(h.level!=1)?0:1),c==0||c==s.length))return r;e.line!=f.line?a=(e.line-f.line)*(i.doc.direction=="ltr"?1:-1)>0:(v=hf(s,e.ch,e.sticky),y=v-l||(e.ch-f.ch)*(h.level==1?-1:1),a=v==c-1||v==c?y<0:y>0);var p=s[c+(a?-1:0)],w=a==(p.level==1),b=w?p.from:p.to,k=w?"after":"before";return f.ch==b&&f.sticky==k?r:new o(new n(f.line,b,k),e)}function bw(n,t,i,r){var e,u,o,s,f,h,c,l;if(t.touches)e=t.touches[0].clientX,u=t.touches[0].clientY;else try{e=t.clientX;u=t.clientY}catch(t){return!1}if(e>=Math.floor(n.display.gutters.getBoundingClientRect().right))return!1;if(r&&ft(t),o=n.display,s=o.lineDiv.getBoundingClientRect(),u>s.bottom||!vt(n,i))return sh(t);for(u-=s.top-o.viewOffset,f=0;f<n.options.gutters.length;++f)if(h=o.gutters.childNodes[f],h&&h.getBoundingClientRect().right>=e)return c=ur(n.doc,u),l=n.options.gutters[f],y(n,i,n,c,l,t),sh(t)}function rl(n,t){return bw(n,t,"gutterClick",!0)}function kw(n,t){if(!si(n.display,t)&&!ptt(n,t)&&!w(n,t,"contextmenu"))n.display.input.onContextMenu(t)}function ptt(n,t){return vt(n,"gutterContextMenu")?bw(n,t,"gutterContextMenu",!1):!1}function dw(n){n.display.wrapper.className=n.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+n.options.theme.replace(/(^|\s)\s*/g," cm-s-");yf(n)}function wtt(t){function i(n,i,u,f){t.defaults[n]=i;u&&(r[n]=f?function(n,t,i){i!=rf&&u(n,t,i)}:u)}var r=t.optionHandlers;t.defineOption=i;t.Init=rf;i("value","",function(n,t){return n.setValue(t)},!0);i("mode",null,function(n,t){n.doc.modeOption=t;wc(n)},!0);i("indentUnit",2,wc,!0);i("indentWithTabs",!1);i("smartIndent",!0);i("tabSize",4,function(n){te(n);yf(n);et(n)},!0);i("lineSeparator",null,function(t,i){var r,f,u;if(t.doc.lineSep=i,i)for(r=[],f=t.doc.first,t.doc.iter(function(t){for(var u,e=0;;){if(u=t.text.indexOf(i,e),u==-1)break;e=u+i.length;r.push(n(f,u))}f++}),u=r.length-1;u>=0;u--)su(t.doc,i,r[u],n(r[u].line,r[u].ch+i.length))});i("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(n,t,i){n.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g");i!=rf&&n.refresh()});i("specialCharPlaceholder",ud,function(n){return n.refresh()},!0);i("electricChars",!0);i("inputStyle",le?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor");},!0);i("spellcheck",!1,function(n,t){return n.getInputField().spellcheck=t},!0);i("rtlMoveVisually",!hit);i("wholeLineUpdateBefore",!0);i("theme","default",function(n){dw(n);oe(n)},!0);i("keyMap","default",function(n,t,i){var u=ts(t),r=i!=rf&&ts(i);r&&r.detach&&r.detach(n,u);u.attach&&u.attach(n,r||null)});i("extraKeys",null);i("configureMouse",null);i("lineWrapping",!1,ktt,!0);i("gutters",[],function(n){yc(n.options);oe(n)},!0);i("fixedGutter",!0,function(n,t){n.display.gutters.style.left=t?rc(n.display)+"px":"0";n.refresh()},!0);i("coverGutterNextToScrollbar",!1,function(n){return uu(n)},!0);i("scrollbarStyle","native",function(n){vy(n);uu(n);n.display.scrollbars.setScrollTop(n.doc.scrollTop);n.display.scrollbars.setScrollLeft(n.doc.scrollLeft)},!0);i("lineNumbers",!1,function(n){yc(n.options);oe(n)},!0);i("firstLineNumber",1,oe,!0);i("lineNumberFormatter",function(n){return n},oe,!0);i("showCursorWhenSelecting",!1,wf,!0);i("resetSelectionOnContextMenu",!0);i("lineWiseCopyCut",!0);i("pasteLinesPerSelection",!0);i("readOnly",!1,function(n,t){t=="nocursor"&&(bf(n),n.display.input.blur());n.display.input.readOnlyChanged(t)});i("disableInput",!1,function(n,t){t||n.display.input.reset()},!0);i("dragDrop",!0,btt);i("allowDropFileTypes",null);i("cursorBlinkRate",530);i("cursorScrollMargin",0);i("cursorHeight",1,wf,!0);i("singleCursorHeightPerLine",!0,wf,!0);i("workTime",100);i("workDelay",100);i("flattenSpans",!0,te,!0);i("addModeClass",!1,te,!0);i("pollInterval",100);i("undoDepth",200,function(n,t){return n.doc.history.undoDepth=t});i("historyEventDelay",1250);i("viewportMargin",10,function(n){return n.refresh()},!0);i("maxHighlightLength",1e4,te,!0);i("moveInputWithCursor",!0,function(n,t){t||n.display.input.resetPosition()});i("tabindex",null,function(n,t){return n.display.input.getField().tabIndex=t||""});i("autofocus",null);i("direction","ltr",function(n,t){return n.doc.setDirection(t)},!0)}function oe(n){wy(n);et(n);sy(n)}function btt(n,t,i){var e=i&&i!=rf,u,f;!t!=!e&&(u=n.display.dragFunctions,f=t?r:lt,f(n.display.scroller,"dragstart",u.start),f(n.display.scroller,"dragenter",u.enter),f(n.display.scroller,"dragover",u.over),f(n.display.scroller,"dragleave",u.leave),f(n.display.scroller,"drop",u.drop))}function ktt(n){n.options.lineWrapping?(tr(n.display.wrapper,"CodeMirror-wrap"),n.display.sizer.style.minWidth="",n.display.sizerWidth=null):(di(n.display.wrapper,"CodeMirror-wrap"),eh(n));uc(n);et(n);yf(n);setTimeout(function(){return uu(n)},100)}function a(n,t){var o=this,i,s,r,u,f;if(!(this instanceof a))return new a(n,t);this.options=t=t?ir(t):{};ir(tk,t,!1);yc(t);i=t.value;typeof i=="string"&&(i=new ut(i,t.mode,null,t.lineSeparator,t.direction));this.doc=i;s=new a.inputStyles[t.inputStyle](this);r=this.display=new rk(n,i,s);r.wrapper.CodeMirror=this;wy(this);dw(this);t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap");vy(this);this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new gi,keySeq:null,specialChars:null};t.autofocus&&!le&&r.input.focus();e&&l<11&&setTimeout(function(){return o.display.input.reset(!0)},20);dtt(this);dn();ar(this);this.curOp.forceUpdate=!0;tp(this,i);t.autofocus&&!le||this.hasFocus()?setTimeout(ps(ec,this),20):bf(this);for(u in vs)vs.hasOwnProperty(u)&&vs[u](o,t[u],rf);for(hy(this),t.finishInit&&t.finishInit(this),f=0;f<ls.length;++f)ls[f](o);vr(this);tt&&t.lineWrapping&&getComputedStyle(r.lineDiv).textRendering=="optimizelegibility"&&(r.lineDiv.style.textRendering="auto")}function dtt(t){function h(){i.activeTouch&&(a=setTimeout(function(){return i.activeTouch=null},1e3),s=i.activeTouch,s.end=+new Date)}function v(n){if(n.touches.length!=1)return!1;var t=n.touches[0];return t.radiusX<=1&&t.radiusY<=1}function c(n,t){if(t.left==null)return!0;var i=t.left-n.left,r=t.top-n.top;return i*i+r*r>400}var i=t.display,a,s,u;r(i.scroller,"mousedown",b(t,pw));e&&l<11?r(i.scroller,"dblclick",b(t,function(n){var i,r;w(t,n)||(i=hr(t,n),!i||rl(t,n)||si(t.display,n))||(ft(n),r=t.findWordAt(i),ko(t.doc,r.anchor,r.head))})):r(i.scroller,"dblclick",function(n){return w(t,n)||ft(n)});os||r(i.scroller,"contextmenu",function(n){return kw(t,n)});s={end:0};r(i.scroller,"touchstart",function(n){if(!w(t,n)&&!v(n)&&!rl(t,n)){i.input.ensurePolled();clearTimeout(a);var r=+new Date;i.activeTouch={start:r,moved:!1,prev:r-s.end<=300?s:null};n.touches.length==1&&(i.activeTouch.left=n.touches[0].pageX,i.activeTouch.top=n.touches[0].pageY)}});r(i.scroller,"touchmove",function(){i.activeTouch&&(i.activeTouch.moved=!0)});r(i.scroller,"touchend",function(r){var u=i.activeTouch,e,s;u&&!si(i,r)&&u.left!=null&&!u.moved&&new Date-u.start<300&&(e=t.coordsChar(i.activeTouch,"page"),s=!u.prev||c(u,u.prev)?new o(e,e):!u.prev.prev||c(u,u.prev.prev)?t.findWordAt(e):new o(n(e.line,0),f(t.doc,n(e.line+1,0))),t.setSelection(s.anchor,s.head),t.focus(),ft(r));h()});r(i.scroller,"touchcancel",h);r(i.scroller,"scroll",function(){i.scroller.clientHeight&&(df(t,i.scroller.scrollTop),lr(t,i.scroller.scrollLeft,!0),y(t,"scroll",t))});r(i.scroller,"mousewheel",function(n){return ky(t,n)});r(i.scroller,"DOMMouseScroll",function(n){return ky(t,n)});r(i.wrapper,"scroll",function(){return i.wrapper.scrollTop=i.wrapper.scrollLeft=0});i.dragFunctions={enter:function(n){w(t,n)||cf(n)},over:function(n){w(t,n)||(kn(t,n),cf(n))},start:function(n){return bn(t,n)},drop:b(t,wn),leave:function(n){w(t,n)||iw(t)}};u=i.input.getField();r(u,"keyup",function(n){return vw.call(t,n)});r(u,"keydown",b(t,aw));r(u,"keypress",b(t,yw));r(u,"focus",function(n){return ec(t,n)});r(u,"blur",function(n){return bf(t,n)})}function se(i,r,u,f){var s=i.doc,d,c,e,l,v,p,a,w,b;u==null&&(u="add");u=="smart"&&(s.mode.indent?d=lf(i,r).state:u="prev");var y=i.options.tabSize,h=t(s,r),k=at(h.text,null,y);if(h.stateAfter&&(h.stateAfter=null),c=h.text.match(/^\s*/)[0],f||/\S/.test(h.text)){if(u=="smart"&&(e=s.mode.indent(d,h.text.slice(c.length),h.text),e==as||e>150)){if(!f)return;u="prev"}}else e=0,u="not";if(u=="prev"?e=r>s.first?at(t(s,r-1).text,null,y):0:u=="add"?e=k+i.options.indentUnit:u=="subtract"?e=k-i.options.indentUnit:typeof u=="number"&&(e=k+u),e=Math.max(0,e),l="",v=0,i.options.indentWithTabs)for(p=Math.floor(e/y);p;--p)v+=y,l+="\t";if(v<e&&(l+=bs(e-v)),l!=c)return su(s,l,n(r,0),n(r,c.length),"+input"),h.stateAfter=null,!0;for(a=0;a<s.sel.ranges.length;a++)if(w=s.sel.ranges[a],w.head.line==r&&w.head.ch<c.length){b=n(r,c.length);gc(s,a,new o(b,b));break}}function rs(n){yt=n}function ul(i,r,u,f,e){var p=i.doc,a,k,l,w;i.display.shift=!1;f||(f=p.sel);var v=i.state.pasteIncoming||e=="paste",y=kl(r),o=null;if(v&&f.ranges.length>1)if(yt&&yt.text.join("\n")==r){if(f.ranges.length%yt.text.length==0)for(o=[],a=0;a<yt.text.length;a++)o.push(p.splitLines(yt.text[a]))}else y.length==f.ranges.length&&i.options.pasteLinesPerSelection&&(o=no(y,function(n){return[n]}));for(l=f.ranges.length-1;l>=0;l--){var b=f.ranges[l],h=b.from(),c=b.to();b.empty()&&(u&&u>0?h=n(h.line,h.ch-u):i.state.overwrite&&!v?c=n(c.line,Math.min(t(p,c.line).text.length,c.ch+s(y).length)):yt&&yt.lineWise&&yt.text.join("\n")==r&&(h=c=n(h.line,0)));k=i.curOp.updateInput;w={from:h,to:c,text:o?o[l%o.length]:y,origin:e||(v?"paste":i.state.cutIncoming?"cut":"+input")};ou(i.doc,w);g(i,"inputRead",i,w)}r&&!v&&nb(i,r);ru(i);i.curOp.updateInput=k;i.curOp.typing=!0;i.state.pasteIncoming=i.state.cutIncoming=!1}function gw(n,t){var i=n.clipboardData&&n.clipboardData.getData("Text");if(i)return n.preventDefault(),t.isReadOnly()||t.options.disableInput||ot(t,function(){return ul(t,i,0,null,"paste")}),!0}function nb(n,i){var e,u,r,f,o,s;if(n.options.electricChars&&n.options.smartIndent)for(e=n.doc.sel,u=e.ranges.length-1;u>=0;u--)if(r=e.ranges[u],!(r.head.ch>100)&&(!u||e.ranges[u-1].head.line!=r.head.line)){if(f=n.getModeAt(r.head),o=!1,f.electricChars){for(s=0;s<f.electricChars.length;s++)if(i.indexOf(f.electricChars.charAt(s))>-1){o=se(n,r.head.line,"smart");break}}else f.electricInput&&f.electricInput.test(t(n.doc,r.head.line).text.slice(0,r.head.ch))&&(o=se(n,r.head.line,"smart"));o&&g(n,"electricInput",n,r.head.line)}}function tb(t){for(var r,i,f=[],e=[],u=0;u<t.doc.sel.ranges.length;u++)r=t.doc.sel.ranges[u].head.line,i={anchor:n(r,0),head:n(r+1,0)},e.push(i),f.push(t.getRange(i.anchor,i.head));return{text:f,ranges:e}}function ib(n,t){n.setAttribute("autocorrect","off");n.setAttribute("autocapitalize","off");n.setAttribute("spellcheck",!!t)}function rb(){var n=i("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=i("div",[n],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return tt?n.style.width="1000px":n.setAttribute("wrap","off"),ce&&(n.style.border="1px solid black"),ib(n),t}function gtt(i){var u=i.optionHandlers,r=i.helpers={};i.prototype={constructor:i,focus:function(){window.focus();this.display.input.focus()},setOption:function(n,t){var i=this.options,r=i[n];(i[n]!=t||n=="mode")&&(i[n]=t,u.hasOwnProperty(n)&&b(this,u[n])(this,t,r),y(this,"optionChange",this,n))},getOption:function(n){return this.options[n]},getDoc:function(){return this.doc},addKeyMap:function(n,t){this.state.keyMaps[t?"push":"unshift"](ts(n))},removeKeyMap:function(n){for(var i=this.state.keyMaps,t=0;t<i.length;++t)if(i[t]==n||i[t].name==n)return i.splice(t,1),!0},addOverlay:it(function(n,t){var r=n.token?n:i.getMode(this.options,n);if(r.startState)throw new Error("Overlays may not be stateful.");ik(this.state.overlays,{mode:r,modeSpec:n,opaque:t&&t.opaque,priority:t&&t.priority||0},function(n){return n.priority});this.state.modeGen++;et(this)}),removeOverlay:it(function(n){for(var i,u=this,r=this.state.overlays,t=0;t<r.length;++t)if(i=r[t].modeSpec,i==n||typeof n=="string"&&i.name==n){r.splice(t,1);u.state.modeGen++;et(u);return}}),indentLine:it(function(n,t,i){typeof t!="string"&&typeof t!="number"&&(t=t==null?this.options.smartIndent?"smart":"prev":t?"add":"subtract");ef(this.doc,n)&&se(this,n,t,i)}),indentSelection:it(function(n){for(var t,f,e,i=this,s=this.doc.sel.ranges,u=-1,r=0;r<s.length;r++)if(t=s[r],t.empty())t.head.line>u&&(se(i,t.head.line,n,!0),u=t.head.line,r==i.doc.sel.primIndex&&ru(i));else{var h=t.from(),c=t.to(),l=Math.max(u,h.line);for(u=Math.min(i.lastLine(),c.line-(c.ch?0:1))+1,f=l;f<u;++f)se(i,f,n);e=i.doc.sel.ranges;h.ch==0&&s.length==e.length&&e[r].from().ch>0&&gc(i.doc,r,new o(h,e[r].to()),ui)}}),getTokenAt:function(n,t){return ga(this,n,t)},getLineTokens:function(t,i){return ga(this,n(t),i,!0)},getTokenTypeAt:function(n){var i,e;n=f(this.doc,n);var u=ka(this,t(this.doc,n.line)),s=0,h=(u.length-1)/2,o=n.ch,r;if(o==0)r=u[2];else for(;;)if(i=s+h>>1,(i?u[i*2-1]:0)>=o)h=i;else if(u[i*2+1]<o)s=i+1;else{r=u[i*2+2];break}return e=r?r.indexOf("overlay "):-1,e<0?r:e==0?null:r.slice(0,e-1)},getModeAt:function(n){var t=this.doc.mode;return t.innerMode?i.innerMode(t,this.getTokenAt(n).state).mode:t},getHelper:function(n,t){return this.getHelpers(n,t)[0]},getHelpers:function(n,t){var c=this,f=[],u,i,e,h,o,s;if(!r.hasOwnProperty(t))return f;if(u=r[t],i=this.getModeAt(n),typeof i[t]=="string")u[i[t]]&&f.push(u[i[t]]);else if(i[t])for(e=0;e<i[t].length;e++)h=u[i[t][e]],h&&f.push(h);else i.helperType&&u[i.helperType]?f.push(u[i.helperType]):u[i.name]&&f.push(u[i.name]);for(o=0;o<u._global.length;o++)s=u._global[o],s.pred(i,c)&&d(f,s.val)==-1&&f.push(s.val);return f},getStateAfter:function(n,t){var i=this.doc;return n=ra(i,n==null?i.first+i.size-1:n),lf(this,n+1,t).state},cursorCoords:function(n,t){var r,i=this.doc.sel.primary();return r=n==null?i.head:typeof n=="object"?f(this.doc,n):n?i.from():i.to(),pt(this,r,t||"page")},charCoords:function(n,t){return dh(this,f(this.doc,n),t||"page")},coordsChar:function(n,t){return n=dv(this,n,t||"page"),nc(this,n.left,n.top)},lineAtHeight:function(n,t){return n=dv(this,{top:n,left:0},t||"page").top,ur(this.doc,n+this.display.viewOffset)},heightAtLine:function(n,i,r){var f=!1,u,e;return typeof n=="number"?(e=this.doc.first+this.doc.size-1,n<this.doc.first?n=this.doc.first:n>e&&(n=e,f=!0),u=t(this.doc,n)):u=n,lo(this,u,{top:0,left:0},i||"page",r||f).top+(f?this.doc.height-ei(u):0)},defaultTextHeight:function(){return sr(this.display)},defaultCharWidth:function(){return pf(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(n,t,i,r,u){var s=this.display,o,e,h,c;n=pt(this,f(this.doc,n));o=n.bottom;e=n.left;t.style.position="absolute";t.setAttribute("cm-ignore-events","true");this.display.input.setUneditable(t);s.sizer.appendChild(t);r=="over"?o=n.top:(r=="above"||r=="near")&&(h=Math.max(s.wrapper.clientHeight,this.doc.height),c=Math.max(s.sizer.clientWidth,s.lineSpace.clientWidth),(r=="above"||n.bottom+t.offsetHeight>h)&&n.top>t.offsetHeight?o=n.top-t.offsetHeight:n.bottom+t.offsetHeight<=h&&(o=n.bottom),e+t.offsetWidth>c&&(e=c-t.offsetWidth));t.style.top=o+"px";t.style.left=t.style.right="";u=="right"?(e=s.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):(u=="left"?e=0:u=="middle"&&(e=(s.sizer.clientWidth-t.offsetWidth)/2),t.style.left=e+"px");i&&sg(this,{left:e,top:o,right:e+t.offsetWidth,bottom:o+t.offsetHeight})},triggerOnKeyDown:it(aw),triggerOnKeyPress:it(yw),triggerOnKeyUp:vw,triggerOnMouseDown:it(pw),execCommand:function(n){if(tf.hasOwnProperty(n))return tf[n].call(null,this)},triggerElectric:it(function(n){nb(this,n)}),findPosH:function(n,t,i,r){var s=this,o=1,u,e;for(t<0&&(o=-1,t=-t),u=f(this.doc,n),e=0;e<t;++e)if(u=fl(s.doc,u,o,i,r),u.hitSide)break;return u},moveH:it(function(n,t){var i=this;this.extendSelectionsBy(function(r){return i.display.shift||i.doc.extend||r.empty()?fl(i.doc,r.head,n,t,i.options.rtlMoveVisually):n<0?r.from():r.to()},ge)}),deleteH:it(function(n,t){var r=this.doc.sel,i=this.doc;r.somethingSelected()?i.replaceSelection("",null,"+delete"):lu(this,function(r){var u=fl(i,r.head,n,t,!1);return n<0?{from:u,to:r.head}:{from:r.head,to:u}})}),findPosV:function(n,t,i,r){var h=this,c=1,o=r,u,s,e;for(t<0&&(c=-1,t=-t),u=f(this.doc,n),s=0;s<t;++s)if(e=pt(h,u,"div"),o==null?o=e.left:e.left=o,u=ub(h,e,c,i),u.hitSide)break;return u},moveV:it(function(n,t){var u=this,i=this.doc,f=[],e=!this.display.shift&&!i.extend&&i.sel.somethingSelected(),r;if(i.extendSelectionsBy(function(r){var o,s;return e?n<0?r.from():r.to():(o=pt(u,r.head,"div"),r.goalColumn!=null&&(o.left=r.goalColumn),f.push(o.left),s=ub(u,o,n,t),t=="page"&&r==i.sel.primary()&&hc(u,dh(u,s,"div").top-o.top),s)},ge),f.length)for(r=0;r<i.sel.ranges.length;r++)i.sel.ranges[r].goalColumn=f[r]}),findWordAt:function(i){var c=this.doc,u=t(c,i.line).text,r=i.ch,f=i.ch,e,s,h;if(u){for(e=this.getHelper(i,"wordChars"),(i.sticky=="before"||f==u.length)&&r?--r:++f,s=u.charAt(r),h=to(s,e)?function(n){return to(n,e)}:/\s/.test(s)?function(n){return/\s/.test(n)}:function(n){return!/\s/.test(n)&&!to(n)};r>0&&h(u.charAt(r-1));)--r;while(f<u.length&&h(u.charAt(f)))++f}return new o(n(i.line,r),n(i.line,f))},toggleOverwrite:function(n){(n==null||n!=this.state.overwrite)&&((this.state.overwrite=!this.state.overwrite)?tr(this.display.cursorDiv,"CodeMirror-overwrite"):di(this.display.cursorDiv,"CodeMirror-overwrite"),y(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==fi()},isReadOnly:function(){return!!(this.options.readOnly||this.doc.cantEdit)},scrollTo:it(function(n,t){kf(this,n,t)}),getScrollInfo:function(){var n=this.display.scroller;return{left:n.scrollLeft,top:n.scrollTop,height:n.scrollHeight-ti(this)-this.display.barHeight,width:n.scrollWidth-ti(this)-this.display.barWidth,clientHeight:wh(this),clientWidth:or(this)}},scrollIntoView:it(function(t,i){t==null?(t={from:this.doc.sel.primary().head,to:null},i==null&&(i=this.options.cursorScrollMargin)):typeof t=="number"?t={from:n(t,0),to:null}:t.from==null&&(t={from:t,to:null});t.to||(t.to=t.from);t.margin=i||0;t.from.line!=null?hg(this,t):cy(this,t.from,t.to,t.margin)}),setSize:it(function(n,t){var u=this,r=function(n){return typeof n=="number"||/^\d+$/.test(String(n))?n+"px":n},i;n!=null&&(this.display.wrapper.style.width=r(n));t!=null&&(this.display.wrapper.style.height=r(t));this.options.lineWrapping&&wv(this);i=this.display.viewFrom;this.doc.iter(i,this.display.viewTo,function(n){if(n.widgets)for(var t=0;t<n.widgets.length;t++)if(n.widgets[t].noHScroll){yi(u,i,"widget");break}++i});this.curOp.forceUpdate=!0;y(this,"refresh",this)}),operation:function(n){return ot(this,n)},startOperation:function(){return ar(this)},endOperation:function(){return vr(this)},refresh:it(function(){var n=this.display.cachedTextHeight;et(this);this.curOp.forceUpdate=!0;yf(this);kf(this,this.doc.scrollLeft,this.doc.scrollTop);ac(this);(n==null||Math.abs(n-sr(this.display))>.5)&&uc(this);y(this,"refresh",this)}),swapDoc:it(function(n){var t=this.doc;return t.cm=null,tp(this,n),yf(this),this.display.input.reset(),kf(this,n.scrollLeft,n.scrollTop),this.curOp.forceScroll=!0,g(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};tu(i);i.registerHelper=function(n,t,u){r.hasOwnProperty(n)||(r[n]=i[n]={_global:[]});r[n][t]=u};i.registerGlobalHelper=function(n,t,u,f){i.registerHelper(n,t,f);r[n]._global.push({pred:u,val:f})}}function fl(i,r,u,f,e){function w(){var f=r.line+u;return f<i.first||f>=i.first+i.size?!1:(r=new n(f,r.ch,r.sticky),h=t(i,f))}function s(n){var t;if(t=e?rtt(i.cm,h,r,u):ow(h,r,u),t==null)if(!n&&w())r=il(e,i.cm,h,r.line,u);else return!1;else r=t;return!0}var p=r,b=u,h=t(i,r.line),c,l,o,a;if(f=="char")s();else if(f=="column")s(!0);else if(f=="word"||f=="group"){var v=null,y=f=="group",k=i.cm&&i.cm.getHelper(r,"wordChars");for(c=!0;;c=!1){if(u<0&&!s(!c))break;if(l=h.text.charAt(r.ch)||"\n",o=to(l,k)?"w":y&&l=="\n"?"n":!y||/\s/.test(l)?null:"p",!y||c||o||(o="s"),v&&v!=o){u<0&&(u=1,s(),r.sticky="after");break}if(o&&(v=o),u>0&&!s(!c))break}}return a=nl(i,r,p,b,!0),th(p,a)&&(a.hitSide=!0),a}function ub(n,t,i,r){var s=n.doc,h=t.left,u,e,o,f;for(r=="page"?(e=Math.min(n.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),o=Math.max(e-.5*sr(n.display),3),u=(i>0?t.bottom:t.top)+i*o):r=="line"&&(u=i>0?t.bottom+3:t.top-3);;){if(f=nc(n,h,u),!f.outside)break;if(i<0?u<=0:u>=s.height){f.hitSide=!0;break}u+=i*5}return f}function fb(n,i){var u=bh(n,i.line),f,r;if(!u||u.hidden)return null;var e=t(n.doc,i.line),h=av(u,e,i.line),o=oi(e,n.doc.direction),s="left";return o&&(f=hf(o,i.ch),s=f%2?"right":"left"),r=yv(h.map,i.ch,s),r.offset=r.collapse=="right"?r.end:r.start,r}function nit(n){for(var t=n;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return!0;return!1}function au(n,t){return t&&(n.bad=!0),n}function tit(t,i,r,u,f){function a(n){return function(t){return t.id==n}}function h(){s&&(o+=l,s=!1)}function e(n){n&&(h(),o+=n)}function c(i){var o,v,y,p,w,r;if(i.nodeType==1){if(o=i.getAttribute("cm-text"),o!=null){e(o||i.textContent.replace(/\u200b/g,""));return}if(v=i.getAttribute("cm-marker"),v){p=t.findMarks(n(u,0),n(f+1,0),a(+v));p.length&&(y=p[0].find(0))&&e(rr(t.doc,y.from,y.to).join(l));return}if(i.getAttribute("contenteditable")=="false")return;for(w=/^(pre|div|p)$/i.test(i.nodeName),w&&h(),r=0;r<i.childNodes.length;r++)c(i.childNodes[r]);w&&(s=!0)}else i.nodeType==3&&e(i.nodeValue)}for(var o="",s=!1,l=t.doc.lineSeparator();;){if(c(i),i==r)break;i=i.nextSibling}return o}function us(t,i,r){var u,f,e;if(i==t.display.lineDiv){if(u=t.display.lineDiv.childNodes[r],!u)return au(t.clipPos(n(t.display.viewTo-1)),!0);i=null;r=0}else for(u=i;;u=u.parentNode){if(!u||u==t.display.lineDiv)return null;if(u.parentNode&&u.parentNode==t.display.lineDiv)break}for(f=0;f<t.display.view.length;f++)if(e=t.display.view[f],e.node==u)return iit(e,i,r)}function iit(t,i,r){function y(i,r,u){for(var o,f,s,l,c,e=-1;e<(v?v.length:0);e++)for(o=e<0?w.map:v[e],f=0;f<o.length;f+=3)if(s=o[f+2],s==i||s==r)return l=h(e<0?t.line:t.rest[e]),c=o[f]+u,(u<0||s!=i)&&(c=o[f+(u?1:0)]),n(l,c)}var a=t.text.firstChild,l=!1,p,f,e,w,v,u,o,b,c,k;if(!i||!vi(a,i))return au(n(h(t.line),0),!0);if(i==a&&(l=!0,i=a.childNodes[r],r=0,!i))return p=t.rest?s(t.rest):t.line,au(n(h(p),p.text.length),l);for(f=i.nodeType==3?i:null,e=i,f||i.childNodes.length!=1||i.firstChild.nodeType!=3||(f=i.firstChild,r&&(r=f.nodeValue.length));e.parentNode!=a;)e=e.parentNode;if(w=t.measure,v=w.maps,u=y(f,e,r),u)return au(u,l);for(o=e.nextSibling,b=f?f.nodeValue.length-r:0;o;o=o.nextSibling){if(u=y(o,o.firstChild,0),u)return au(n(u.line,u.ch-b),l);b+=o.textContent.length}for(c=e.previousSibling,k=r;c;c=c.previousSibling){if(u=y(c,c.firstChild,-1),u)return au(n(u.line,u.ch+k),l);k+=c.textContent.length}}function rit(n,t){function u(){n.value=s.getValue()}var f,e,i,o,s;if(t=t?ir(t):{},t.value=n.value,!t.tabindex&&n.tabIndex&&(t.tabindex=n.tabIndex),!t.placeholder&&n.placeholder&&(t.placeholder=n.placeholder),t.autofocus==null&&(f=fi(),t.autofocus=f==n||n.getAttribute("autofocus")!=null&&f==document.body),n.form&&(r(n.form,"submit",u),!t.leaveSubmitMethodAlone)){i=n.form;e=i.submit;try{o=i.submit=function(){u();i.submit=e;i.submit();i.submit=o}}catch(h){}}return t.finishInit=function(t){t.save=u;t.getTextArea=function(){return n};t.toTextArea=function(){t.toTextArea=isNaN;u();n.parentNode.removeChild(t.getWrapperElement());n.style.display="";n.form&&(lt(n.form,"submit",u),typeof n.form.submit=="function"&&(n.form.submit=e))}},n.style.display="none",s=a(function(t){return n.parentNode.insertBefore(t,n.nextSibling)},t)}function uit(t){t.off=lt;t.on=r;t.wheelEventPixels=tn;t.Doc=ut;t.splitLines=kl;t.countColumn=at;t.findColumn=ws;t.isWordChar=ks;t.Pass=as;t.signal=y;t.Line=kr;t.changeEnd=bi;t.scrollbarModel=vl;t.Pos=n;t.cmpPos=u;t.modes=ss;t.mimeModes=wr;t.resolveMode=so;t.getMode=ch;t.modeExtensions=br;t.extendMode=gk;t.copyState=er;t.startState=wa;t.innerMode=lh;t.commands=tf;t.keyMap=ri;t.keyName=ew;t.isModifierKey=uw;t.lookupKey=cu;t.normalizeKeyMap=itt;t.StringStream=v;t.SharedTextMarker=du;t.TextMarker=ci;t.LineWidget=ku;t.e_preventDefault=ft;t.e_stopPropagation=ya;t.e_stop=cf;t.addClass=tr;t.contains=vi;t.rmClass=di;t.keyNames=li}var rt=navigator.userAgent,eb=navigator.platform,ki=/gecko\/\d/i.test(rt),ob=/MSIE \d/.test(rt),sb=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(rt),he=/Edge\/(\d+)/.exec(rt),e=ob||sb||he,l=e&&(ob?document.documentMode||6:+(he||sb)[1]),tt=!he&&/WebKit\//.test(rt),fit=tt&&/Qt\/\d+\.\d+/.test(rt),fs=!he&&/Chrome\//.test(rt),bt=/Opera\//.test(rt),hb=/Apple Computer/.test(navigator.vendor),eit=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(rt),oit=/PhantomJS/.test(rt),ce=!he&&/AppleWebKit/.test(rt)&&/Mobile\/\w+/.test(rt),es=/Android/.test(rt),le=ce||es||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(rt),kt=ce||/Mac/.test(eb),sit=/\bCrOS\b/.test(rt),hit=/win/i.test(eb),pr=bt&&rt.match(/Version\/(\d*\.\d*)/),el,os,di,vu,yu,gi,ae,cb,lb,ol,hi,pu,ab,sl,r,vb,hl,cl,ss,wr,br,v,ve,dt,ll,kr,yb,pb,dr,wu,al,gr,nr,bu,vl,wb,ye,pe,st,ht,o,ku,yl,ci,du,bb,ut,pl,wl,li,gu,we,nf,ri,tf,kb,hs,db,cs,be,ke,ls,yt,c,p,gb,de;pr&&(pr=Number(pr[1]));pr&&pr>=15&&(bt=!1,tt=!0);el=kt&&(fit||bt&&(pr==null||pr<12.11));os=ki||e&&l>=9;di=function(n,t){var r=n.className,i=uf(t).exec(r),u;i&&(u=r.slice(i.index+i[0].length),n.className=r.slice(0,i.index)+(u?i[1]+u:""))};vu=document.createRange?function(n,t,i,r){var u=document.createRange();return u.setEnd(r||n,i),u.setStart(n,t),u}:function(n,t,i){var r=document.body.createTextRange();try{r.moveToElementText(n.parentNode)}catch(u){return r}return r.collapse(!0),r.moveEnd("character",i),r.moveStart("character",t),r};yu=function(n){n.select()};ce?yu=function(n){n.selectionStart=0;n.selectionEnd=n.value.length}:e&&(yu=function(n){try{n.select()}catch(t){}});gi=function(){this.id=null};gi.prototype.set=function(n,t){clearTimeout(this.id);this.id=setTimeout(t,n)};var nk=30,as={toString:function(){return"CodeMirror.Pass"}},ui={scroll:!1},bl={origin:"*mouse"},ge={origin:"+move"};ae=[""];cb=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;lb=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;ol=!1;hi=!1;pu=null;ab=function(){function f(n){return n<=247?e.charAt(n):1424<=n&&n<=1524?"R":1536<=n&&n<=1785?o.charAt(n-1536):1774<=n&&n<=2220?"r":8192<=n&&n<=8203?"w":n==8204?"b":"L"}function n(n,t,i){this.level=n;this.from=t;this.to=i}var e="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN",o="nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111",h=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,t=/[stwN]/,i=/[LRr]/,r=/[Lb1n]/,u=/[1n]/;return function(e,o){var tt=o=="ltr"?"L":"R",a,c,ot,ut,vt,yt,it,pt,ft,d,g,st,p,wt,w,kt,ht,et,bt,ct,b,k,lt,v,rt,l,dt,nt,at,y,gt;if(e.length==0||o=="ltr"&&!h.test(e))return!1;for(a=e.length,c=[],ot=0;ot<a;++ot)c.push(f(e.charCodeAt(ot)));for(ut=0,vt=tt;ut<a;++ut)yt=c[ut],yt=="m"?c[ut]=vt:vt=yt;for(it=0,pt=tt;it<a;++it)ft=c[it],ft=="1"&&pt=="r"?c[it]="n":i.test(ft)&&(pt=ft,ft=="r"&&(c[it]="R"));for(d=1,g=c[0];d<a-1;++d)st=c[d],st=="+"&&g=="1"&&c[d+1]=="1"?c[d]="1":st==","&&g==c[d+1]&&(g=="1"||g=="n")&&(c[d]=g),g=st;for(p=0;p<a;++p)if(wt=c[p],wt==",")c[p]="N";else if(wt=="%"){for(w=void 0,w=p+1;w<a&&c[w]=="%";++w);for(kt=p&&c[p-1]=="!"||w<a&&c[w]=="1"?"1":"N",ht=p;ht<w;++ht)c[ht]=kt;p=w-1}for(et=0,bt=tt;et<a;++et)ct=c[et],bt=="L"&&ct=="1"?c[et]="L":i.test(ct)&&(bt=ct);for(b=0;b<a;++b)if(t.test(c[b])){for(k=void 0,k=b+1;k<a&&t.test(c[k]);++k);var ni=(b?c[b-1]:tt)=="L",ti=(k<a?c[k]:tt)=="L",ii=ni==ti?ni?"L":"R":tt;for(lt=b;lt<k;++lt)c[lt]=ii;b=k-1}for(v=[],l=0;l<a;)if(r.test(c[l])){for(dt=l,++l;l<a&&r.test(c[l]);++l);v.push(new n(0,dt,l))}else{for(nt=l,at=v.length,++l;l<a&&c[l]!="L";++l);for(y=nt;y<l;)if(u.test(c[y])){for(nt<y&&v.splice(at,0,new n(1,nt,y)),gt=y,++y;y<l&&u.test(c[y]);++y);v.splice(at,0,new n(2,gt,y));nt=y}else++y;nt<l&&v.splice(at,0,new n(1,nt,l))}return o=="ltr"&&(v[0].level==1&&(rt=e.match(/^\s+/))&&(v[0].from=rt[0].length,v.unshift(new n(0,0,rt[0].length))),s(v).level==1&&(rt=e.match(/\s+$/))&&(s(v).to-=rt[0].length,v.push(new n(0,a-rt[0].length,a)))),o=="rtl"?v.reverse():v}}();sl=[];r=function(n,t,i){if(n.addEventListener)n.addEventListener(t,i,!1);else if(n.attachEvent)n.attachEvent("on"+t,i);else{var r=n._handlers||(n._handlers={});r[t]=(r[t]||sl).concat(i)}};vb=function(){if(e&&l<9)return!1;var n=i("div");return"draggable"in n||"dragDrop"in n}();var kl="\n\nb".split(/\n/).length!=3?function(n){for(var i=0,f=[],e=n.length,t,r,u;i<=e;)t=n.indexOf("\n",i),t==-1&&(t=n.length),r=n.slice(i,n.charAt(t-1)=="\r"?t-1:t),u=r.indexOf("\r"),u!=-1?(f.push(r.slice(0,u)),i+=u+1):(f.push(r),i=t+1);return f}:function(n){return n.split(/\r\n?|\n/)},cit=window.getSelection?function(n){try{return n.selectionStart!=n.selectionEnd}catch(t){return!1}}:function(n){var t;try{t=n.ownerDocument.selection.createRange()}catch(i){}return!t||t.parentElement()!=n?!1:t.compareEndPoints("StartToEnd",t)!=0},lit=function(){var n=i("div");return"oncopy"in n?!0:(n.setAttribute("oncopy","return;"),typeof n.oncopy=="function")}(),dl=null;for(ss={},wr={},br={},v=function(n,t,i){this.pos=this.start=0;this.string=n;this.tabSize=t||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0;this.lineOracle=i},v.prototype.eol=function(){return this.pos>=this.string.length},v.prototype.sol=function(){return this.pos==this.lineStart},v.prototype.peek=function(){return this.string.charAt(this.pos)||undefined},v.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},v.prototype.eat=function(n){var t=this.string.charAt(this.pos),i;return i=typeof n=="string"?t==n:t&&(n.test?n.test(t):n(t)),i?(++this.pos,t):void 0},v.prototype.eatWhile=function(n){for(var t=this.pos;this.eat(n););return this.pos>t},v.prototype.eatSpace=function(){for(var n=this,t=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++n.pos;return this.pos>t},v.prototype.skipToEnd=function(){this.pos=this.string.length},v.prototype.skipTo=function(n){var t=this.string.indexOf(n,this.pos);if(t>-1)return this.pos=t,!0},v.prototype.backUp=function(n){this.pos-=n},v.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=at(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?at(this.string,this.lineStart,this.tabSize):0)},v.prototype.indentation=function(){return at(this.string,null,this.tabSize)-(this.lineStart?at(this.string,this.lineStart,this.tabSize):0)},v.prototype.match=function(n,t,i){var u,f,r;if(typeof n=="string"){if(u=function(n){return i?n.toLowerCase():n},f=this.string.substr(this.pos,n.length),u(f)==u(n))return t!==!1&&(this.pos+=n.length),!0}else return(r=this.string.slice(this.pos).match(n),r&&r.index>0)?null:(r&&t!==!1&&(this.pos+=r[0].length),r)},v.prototype.current=function(){return this.string.slice(this.start,this.pos)},v.prototype.hideFirstChars=function(n,t){this.lineStart+=n;try{return t()}finally{this.lineStart-=n}},v.prototype.lookAhead=function(n){var t=this.lineOracle;return t&&t.lookAhead(n)},v.prototype.baseToken=function(){var n=this.lineOracle;return n&&n.baseToken(this.pos)},ve=function(n,t){this.state=n;this.lookAhead=t},dt=function(n,t,i,r){this.state=t;this.doc=n;this.line=i;this.maxLookAhead=r||0;this.baseTokens=null;this.baseTokenPos=1},dt.prototype.lookAhead=function(n){var t=this.doc.getLine(this.line+n);return t!=null&&n>this.maxLookAhead&&(this.maxLookAhead=n),t},dt.prototype.baseToken=function(n){var i=this,t;if(!this.baseTokens)return null;while(this.baseTokens[this.baseTokenPos]<=n)i.baseTokenPos+=2;return t=this.baseTokens[this.baseTokenPos+1],{type:t&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-n}},dt.prototype.nextLine=function(){this.line++;this.maxLookAhead>0&&this.maxLookAhead--},dt.fromSaved=function(n,t,i){return t instanceof ve?new dt(n,er(n.mode,t.state),i,t.lookAhead):new dt(n,er(n.mode,t),i)},dt.prototype.save=function(n){var t=n!==!1?er(this.doc.mode,this.state):this.state;return this.maxLookAhead>0?new ve(t,this.maxLookAhead):t},ll=function(n,t,i){this.start=n.start;this.end=n.pos;this.string=n.current();this.type=t||null;this.state=i},kr=function(n,t,i){this.text=n;oa(this,t);this.height=i?i(this):1},kr.prototype.lineNo=function(){return h(this)},tu(kr),yb={},pb={},dr=null,wu=null,al={left:0,right:0,top:0,bottom:0},nr=function(n,t,u){this.cm=u;var f=this.vert=i("div",[i("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=i("div",[i("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");n(f);n(o);r(f,"scroll",function(){f.clientHeight&&t(f.scrollTop,"vertical")});r(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")});this.checkedZeroWidth=!1;e&&l<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")},nr.prototype.update=function(n){var i=n.scrollWidth>n.clientWidth+1,r=n.scrollHeight>n.clientHeight+1,t=n.nativeBarWidth,u,f;return r?(this.vert.style.display="block",this.vert.style.bottom=i?t+"px":"0",u=n.viewHeight-(i?t:0),this.vert.firstChild.style.height=Math.max(0,n.scrollHeight-n.clientHeight+u)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),i?(this.horiz.style.display="block",this.horiz.style.right=r?t+"px":"0",this.horiz.style.left=n.barLeft+"px",f=n.viewWidth-n.barLeft-(r?t:0),this.horiz.firstChild.style.width=Math.max(0,n.scrollWidth-n.clientWidth+f)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&n.clientHeight>0&&(t==0&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:r?t:0,bottom:i?t:0}},nr.prototype.setScrollLeft=function(n){this.horiz.scrollLeft!=n&&(this.horiz.scrollLeft=n);this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},nr.prototype.setScrollTop=function(n){this.vert.scrollTop!=n&&(this.vert.scrollTop=n);this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},nr.prototype.zeroWidthHack=function(){var n=kt&&!eit?"12px":"18px";this.horiz.style.height=this.vert.style.width=n;this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none";this.disableHoriz=new gi;this.disableVert=new gi},nr.prototype.enableZeroWidthBar=function(n,t,i){function r(){var u=n.getBoundingClientRect(),f=i=="vert"?document.elementFromPoint(u.right-1,(u.top+u.bottom)/2):document.elementFromPoint((u.right+u.left)/2,u.bottom-1);f!=n?n.style.pointerEvents="none":t.set(1e3,r)}n.style.pointerEvents="auto";t.set(1e3,r)},nr.prototype.clear=function(){var n=this.horiz.parentNode;n.removeChild(this.horiz);n.removeChild(this.vert)},bu=function(){},bu.prototype.update=function(){return{bottom:0,right:0}},bu.prototype.setScrollLeft=function(){},bu.prototype.setScrollTop=function(){},bu.prototype.clear=function(){},vl={"native":nr,"null":bu},wb=0,ye=function(n,t,i){var r=n.display;this.viewport=t;this.visible=oc(r,n.doc,t);this.editorIsHidden=!r.wrapper.offsetWidth;this.wrapperHeight=r.wrapper.clientHeight;this.wrapperWidth=r.wrapper.clientWidth;this.oldDisplayWidth=or(n);this.force=i;this.dims=ic(n);this.events=[]},ye.prototype.signal=function(n,t){vt(n,t)&&this.events.push(arguments)},ye.prototype.finish=function(){for(var t=this,n=0;n<this.events.length;n++)y.apply(null,t.events[n])},pe=0,st=null,e?st=-.53:ki?st=15:fs?st=-.7:hb&&(st=-1/3),ht=function(n,t){this.ranges=n;this.primIndex=t},ht.prototype.primary=function(){return this.ranges[this.primIndex]},ht.prototype.equals=function(n){var u=this,t,i,r;if(n==this)return!0;if(n.primIndex!=this.primIndex||n.ranges.length!=this.ranges.length)return!1;for(t=0;t<this.ranges.length;t++)if(i=u.ranges[t],r=n.ranges[t],!th(i.anchor,r.anchor)||!th(i.head,r.head))return!1;return!0},ht.prototype.deepCopy=function(){for(var t=this,i=[],n=0;n<this.ranges.length;n++)i[n]=new o(ih(t.ranges[n].anchor),ih(t.ranges[n].head));return new ht(i,this.primIndex)},ht.prototype.somethingSelected=function(){for(var t=this,n=0;n<this.ranges.length;n++)if(!t.ranges[n].empty())return!0;return!1},ht.prototype.contains=function(n,t){var f=this,i,r;for(t||(t=n),i=0;i<this.ranges.length;i++)if(r=f.ranges[i],u(t,r.from())>=0&&u(n,r.to())<=0)return i;return-1},o=function(n,t){this.anchor=n;this.head=t},o.prototype.from=function(){return ro(this.anchor,this.head)},o.prototype.to=function(){return io(this.anchor,this.head)},o.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},ue.prototype={chunkSize:function(){return this.lines.length},removeInner:function(n,t){for(var i,u=this,r=n,f=n+t;r<f;++r)i=u.lines[r],u.height-=i.height,rd(i),g(i,"delete");this.lines.splice(n,t)},collapse:function(n){n.push.apply(n,this.lines)},insertInner:function(n,t,i){var u=this,r;for(this.height+=i,this.lines=this.lines.slice(0,n).concat(t).concat(this.lines.slice(n)),r=0;r<t.length;++r)t[r].parent=u},iterN:function(n,t,i){for(var r=this,u=n+t;n<u;++n)if(i(r.lines[n]))return!0}},fe.prototype={chunkSize:function(){return this.size},removeInner:function(n,t){var e=this,r,i,u,f,s,o;for(this.size-=t,r=0;r<this.children.length;++r)if(i=e.children[r],u=i.chunkSize(),n<u){if(f=Math.min(t,u-n),s=i.height,i.removeInner(n,f),e.height-=s-i.height,u==f&&(e.children.splice(r--,1),i.parent=null),(t-=f)==0)break;n=0}else n-=u;this.size-t<25&&(this.children.length>1||!(this.children[0]instanceof ue))&&(o=[],this.collapse(o),this.children=[new ue(o)],this.children[0].parent=this)},collapse:function(n){for(var i=this,t=0;t<this.children.length;++t)i.children[t].collapse(n)},insertInner:function(n,t,i){var f=this,u,r,s,h,e,o;for(this.size+=t.length,this.height+=i,u=0;u<this.children.length;++u){if(r=f.children[u],s=r.chunkSize(),n<=s){if(r.insertInner(n,t,i),r.lines&&r.lines.length>50){for(h=r.lines.length%25+25,e=h;e<r.lines.length;)o=new ue(r.lines.slice(e,e+=25)),r.height-=o.height,f.children.splice(++u,0,o),o.parent=f;r.lines=r.lines.slice(0,h);f.maybeSpill()}break}n-=s}},maybeSpill:function(){var n,r,t,i,u;if(!(this.children.length<=10)){n=this;do r=n.children.splice(n.children.length-5,5),t=new fe(r),n.parent?(n.size-=t.size,n.height-=t.height,u=d(n.parent.children,n),n.parent.children.splice(u+1,0,t)):(i=new fe(n.children),i.parent=n,n.children=[i,t],n=i),t.parent=n.parent;while(n.children.length>10);n.parent.maybeSpill()}},iterN:function(n,t,i){for(var u,r,f,o=this,e=0;e<this.children.length;++e)if(u=o.children[e],r=u.chunkSize(),n<r){if(f=Math.min(t,r-n),u.iterN(n,f,i))return!0;if((t-=f)==0)break;n=0}else n-=r}},ku=function(n,t,i){var u=this,r;if(i)for(r in i)i.hasOwnProperty(r)&&(u[r]=i[r]);this.doc=n;this.node=t},ku.prototype.clear=function(){var e=this,n=this.doc.cm,t=this.line.widgets,i=this.line,u=h(i),r,f;if(u!=null&&t){for(r=0;r<t.length;++r)t[r]==e&&t.splice(r--,1);t.length||(i.widgets=null);f=vf(this);gt(i,Math.max(0,i.height-f));n&&(ot(n,function(){nw(n,i,-f);yi(n,u,"widget")}),g(n,"lineWidgetCleared",n,this,u))}},ku.prototype.changed=function(){var r=this,u=this.height,n=this.doc.cm,t=this.line,i;(this.height=null,i=vf(this)-u,i)&&(gt(t,t.height+i),n&&ot(n,function(){n.curOp.forceUpdate=!0;nw(n,t,i);g(n,"lineWidgetChanged",n,r,h(t))}))},tu(ku),yl=0,ci=function(n,t){this.lines=[];this.type=t;this.doc=n;this.id=++yl},ci.prototype.clear=function(){var i=this,n,c,f,r,e,o,t,u,s,l,a;if(!this.explicitlyCleared){for(n=this.doc.cm,c=n&&!n.curOp,c&&ar(n),vt(this,"clear")&&(f=this.find(),f&&g(this,"clear",f.from,f.to)),r=null,e=null,o=0;o<this.lines.length;++o)t=i.lines[o],u=of(t.markedSpans,i),n&&!i.collapsed?yi(n,h(t),"text"):n&&(u.to!=null&&(e=h(t)),u.from!=null&&(r=h(t))),t.markedSpans=ok(t.markedSpans,u),u.from==null&&i.collapsed&&!fr(i.doc,t)&&n&&gt(t,sr(n.display));if(n&&this.collapsed&&!n.options.lineWrapping)for(s=0;s<this.lines.length;++s)l=ni(i.lines[s]),a=oo(l),a>n.display.maxLineLength&&(n.display.maxLine=l,n.display.maxLineLength=a,n.display.maxLineChanged=!0);r!=null&&n&&this.collapsed&&et(n,r,e+1);this.lines.length=0;this.explicitlyCleared=!0;this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,n&&lp(n.doc));n&&g(n,"markerCleared",n,this,r,e);c&&vr(n);this.parent&&this.parent.clear()}},ci.prototype.find=function(t,i){var s=this,f,o,e,r,u;for(t==null&&this.type=="bookmark"&&(t=1),e=0;e<this.lines.length;++e){if(r=s.lines[e],u=of(r.markedSpans,s),u.from!=null&&(f=n(i?r:h(r),u.from),t==-1))return f;if(u.to!=null&&(o=n(i?r:h(r),u.to),t==1))return o}return f&&{from:f,to:o}},ci.prototype.changed=function(){var r=this,i=this.find(-1,!0),t=this,n=this.doc.cm;i&&n&&ot(n,function(){var u=i.line,s=h(i.line),e=bh(n,s),o,f;e&&(pv(e),n.curOp.selectionChanged=n.curOp.forceUpdate=!0);n.curOp.updateMaxLine=!0;fr(t.doc,u)||t.height==null||(o=t.height,t.height=null,f=vf(t)-o,f&&gt(u,u.height+f));g(n,"markerChanged",n,r)})},ci.prototype.attachLine=function(n){if(!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;t.maybeHiddenMarkers&&d(t.maybeHiddenMarkers,this)!=-1||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this)}this.lines.push(n)},ci.prototype.detachLine=function(n){if(this.lines.splice(d(this.lines,n),1),!this.lines.length&&this.doc.cm){var t=this.doc.cm.curOp;(t.maybeHiddenMarkers||(t.maybeHiddenMarkers=[])).push(this)}},tu(ci),du=function(n,t){var r=this,i;for(this.markers=n,this.primary=t,i=0;i<n.length;++i)n[i].parent=r},du.prototype.clear=function(){var t=this,n;if(!this.explicitlyCleared){for(this.explicitlyCleared=!0,n=0;n<this.markers.length;++n)t.markers[n].clear();g(this,"clear")}},du.prototype.find=function(n,t){return this.primary.find(n,t)},tu(du),bb=0,ut=function(t,i,r,u,f){if(!(this instanceof ut))return new ut(t,i,r,u,f);r==null&&(r=0);fe.call(this,[new ue([new kr("",null)])]);this.first=r;this.scrollTop=this.scrollLeft=0;this.cantEdit=!1;this.cleanGeneration=1;this.modeFrontier=this.highlightFrontier=r;var e=n(r,0);this.sel=wi(e);this.history=new wo(null);this.id=++bb;this.modeOption=i;this.lineSep=u;this.direction=f=="rtl"?"rtl":"ltr";this.extend=!1;typeof t=="string"&&(t=this.splitLines(t));bc(this,{from:e,to:e,text:t});nt(this,wi(e),ui)},ut.prototype=na(fe.prototype,{constructor:ut,iter:function(n,t,i){i?this.iterN(n-this.first,t-n,i):this.iterN(this.first,this.first+this.size,n)},insert:function(n,t){for(var r=0,i=0;i<t.length;++i)r+=t[i].height;this.insertInner(n-this.first,t,r)},remove:function(n,t){this.removeInner(n-this.first,t)},getValue:function(n){var t=gs(this,this.first,this.first+this.size);return n===!1?t:t.join(n||this.lineSeparator())},setValue:k(function(i){var r=n(this.first,0),u=this.first+this.size-1;ou(this,{from:r,to:n(u,t(this,u).text.length),text:this.splitLines(i),origin:"setValue",full:!0},!0);this.cm&&kf(this.cm,0,0);nt(this,wi(r),ui)}),replaceRange:function(n,t,i,r){t=f(this,t);i=i?f(this,i):t;su(this,n,t,i,r)},getRange:function(n,t,i){var r=rr(this,f(this,n),f(this,t));return i===!1?r:r.join(i||this.lineSeparator())},getLine:function(n){var t=this.getLineHandle(n);return t&&t.text},getLineHandle:function(n){if(ef(this,n))return t(this,n)},getLineNumber:function(n){return h(n)},getLineHandleVisualStart:function(n){return typeof n=="number"&&(n=t(this,n)),ni(n)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(n){return f(this,n)},getCursor:function(n){var t=this.sel.primary();return n==null||n=="head"?t.head:n=="anchor"?t.anchor:n=="end"||n=="to"||n===!1?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:k(function(t,i,r){sp(this,f(this,typeof t=="number"?n(t,i||0):t),null,r)}),setSelection:k(function(n,t,i){sp(this,f(this,n),f(this,t||n),i)}),extendSelection:k(function(n,t,i){ko(this,f(this,n),t&&f(this,t),i)}),extendSelections:k(function(n,t){op(this,ua(this,n),t)}),extendSelectionsBy:k(function(n,t){var i=no(this.sel.ranges,n);op(this,ua(this,i),t)}),setSelections:k(function(n,t,i){var e=this,u,r;if(n.length){for(u=[],r=0;r<n.length;r++)u[r]=new o(f(e,n[r].anchor),f(e,n[r].head));t==null&&(t=Math.min(n.length-1,this.sel.primIndex));nt(this,wt(u,t),i)}}),addSelection:k(function(n,t,i){var r=this.sel.ranges.slice(0);r.push(new o(f(this,n),f(this,t||n)));nt(this,wt(r,r.length-1),i)}),getSelection:function(n){for(var r,f=this,u=this.sel.ranges,t,i=0;i<u.length;i++)r=rr(f,u[i].from(),u[i].to()),t=t?t.concat(r):r;return n===!1?t:t.join(n||this.lineSeparator())},getSelections:function(n){for(var i,u=this,f=[],r=this.sel.ranges,t=0;t<r.length;t++)i=rr(u,r[t].from(),r[t].to()),n!==!1&&(i=i.join(n||u.lineSeparator())),f[t]=i;return f},replaceSelection:function(n,t,i){for(var u=[],r=0;r<this.sel.ranges.length;r++)u[r]=n;this.replaceSelections(u,t,i||"+input")},replaceSelections:k(function(n,t,i){for(var e,o,u,s=this,f=[],h=this.sel,r=0;r<h.ranges.length;r++)e=h.ranges[r],f[r]={from:e.from(),to:e.to(),text:s.splitLines(n[r]),origin:i};for(o=t&&t!="end"&&rn(this,f,t),u=f.length-1;u>=0;u--)ou(s,f[u]);o?hp(this,o):this.cm&&ru(this.cm)}),undo:k(function(){ns(this,"undo")}),redo:k(function(){ns(this,"redo")}),undoSelection:k(function(){ns(this,"undo",!0)}),redoSelection:k(function(){ns(this,"redo",!0)}),setExtending:function(n){this.extend=n},getExtending:function(){return this.extend},historySize:function(){for(var n,t=this.history,r=0,u=0,i=0;i<t.done.length;i++)t.done[i].ranges||++r;for(n=0;n<t.undone.length;n++)t.undone[n].ranges||++u;return{undo:r,redo:u}},clearHistory:function(){this.history=new wo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(n){return n&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(n){return this.history.generation==(n||this.cleanGeneration)},getHistory:function(){return{done:fu(this.history.done),undone:fu(this.history.undone)}},setHistory:function(n){var t=this.history=new wo(this.history.maxGeneration);t.done=fu(n.done.slice(0),null,!0);t.undone=fu(n.undone.slice(0),null,!0)},setGutterMarker:k(function(n,t,i){return re(this,n,"gutter",function(n){var r=n.gutterMarkers||(n.gutterMarkers={});return r[t]=i,!i&&ta(r)&&(n.gutterMarkers=null),!0})}),clearGutter:k(function(n){var t=this;this.iter(function(i){i.gutterMarkers&&i.gutterMarkers[n]&&re(t,i,"gutter",function(){return i.gutterMarkers[n]=null,ta(i.gutterMarkers)&&(i.gutterMarkers=null),!0})})}),lineInfo:function(n){var i;if(typeof n=="number"){if(!ef(this,n)||(i=n,n=t(this,n),!n))return null}else if(i=h(n),i==null)return null;return{line:i,handle:n,text:n.text,gutterMarkers:n.gutterMarkers,textClass:n.textClass,bgClass:n.bgClass,wrapClass:n.wrapClass,widgets:n.widgets}},addLineClass:k(function(n,t,i){return re(this,n,t=="gutter"?"gutter":"class",function(n){var r=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass";if(n[r]){if(uf(i).test(n[r]))return!1;n[r]+=" "+i}else n[r]=i;return!0})}),removeLineClass:k(function(n,t,i){return re(this,n,t=="gutter"?"gutter":"class",function(n){var f=t=="text"?"textClass":t=="background"?"bgClass":t=="gutter"?"gutterClass":"wrapClass",u=n[f],r,e;if(u)if(i==null)n[f]=null;else{if(r=u.match(uf(i)),!r)return!1;e=r.index+r[0].length;n[f]=u.slice(0,r.index)+(!r.index||e==u.length?"":" ")+u.slice(e)||null}else return!1;return!0})}),addLineWidget:k(function(n,t,i){return an(this,n,t,i)}),removeLineWidget:function(n){n.clear()},markText:function(n,t,i){return hu(this,f(this,n),f(this,t),i,i&&i.type||"range")},setBookmark:function(n,t){var i={replacedWith:t&&(t.nodeType==null?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return n=f(this,n),hu(this,n,n,i,"bookmark")},findMarksAt:function(n){var e,r,u,i;if(n=f(this,n),e=[],r=t(this,n.line).markedSpans,r)for(u=0;u<r.length;++u)i=r[u],(i.from==null||i.from<=n.ch)&&(i.to==null||i.to>=n.ch)&&e.push(i.marker.parent||i.marker);return e},findMarks:function(n,t,i){n=f(this,n);t=f(this,t);var u=[],r=n.line;return this.iter(n.line,t.line+1,function(f){var s=f.markedSpans,o,e;if(s)for(o=0;o<s.length;o++)e=s[o],e.to!=null&&r==n.line&&n.ch>=e.to||e.from==null&&r!=n.line||e.from!=null&&r==t.line&&e.from>=t.ch||i&&!i(e.marker)||u.push(e.marker.parent||e.marker);++r}),u},getAllMarks:function(){var n=[];return this.iter(function(t){var r=t.markedSpans,i;if(r)for(i=0;i<r.length;++i)r[i].from!=null&&n.push(r[i].marker)}),n},posFromIndex:function(t){var i,r=this.first,u=this.lineSeparator().length;return this.iter(function(n){var f=n.text.length+u;if(f>t)return i=t,!0;t-=f;++r}),f(this,n(r,i))},indexFromPos:function(n){var t,i;return(n=f(this,n),t=n.ch,n.line<this.first||n.ch<0)?0:(i=this.lineSeparator().length,this.iter(this.first,n.line,function(n){t+=n.text.length+i}),t)},copy:function(n){var t=new ut(gs(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,n&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(n){var i,r,t;return n||(n={}),i=this.first,r=this.first+this.size,n.from!=null&&n.from>i&&(i=n.from),n.to!=null&&n.to<r&&(r=n.to),t=new ut(gs(this,i,r),n.mode||this.modeOption,i,this.lineSep,this.direction),n.sharedHist&&(t.history=this.history),(this.linked||(this.linked=[])).push({doc:t,sharedHist:n.sharedHist}),t.linked=[{doc:this,isParent:!0,sharedHist:n.sharedHist}],yn(t,tw(this)),t},unlinkDoc:function(n){var i=this,t,u,r;if(n instanceof a&&(n=n.doc),this.linked)for(t=0;t<this.linked.length;++t)if(u=i.linked[t],u.doc==n){i.linked.splice(t,1);n.unlinkDoc(i);pn(tw(i));break}n.history==this.history&&(r=[n.id],yr(n,function(n){return r.push(n.id)},!0),n.history=new wo(null),n.history.done=fu(this.history.done,r),n.history.undone=fu(this.history.undone,r))},iterLinkedDocs:function(n){yr(this,n)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(n){return this.lineSep?n.split(this.lineSep):kl(n)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:k(function(n){(n!="rtl"&&(n="ltr"),n!=this.direction)&&(this.direction=n,this.iter(function(n){return n.order=null}),this.cm&&un(this.cm))})}),ut.prototype.eachLine=ut.prototype.iter,pl=0,wl=!1,li={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},gu=0;gu<10;gu++)li[gu+48]=li[gu+96]=String(gu);for(we=65;we<=90;we++)li[we]=String.fromCharCode(we);for(nf=1;nf<=12;nf++)li[nf+111]=li[nf+63235]="F"+nf;ri={};ri.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};ri.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};ri.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"};ri.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]};ri["default"]=kt?ri.macDefault:ri.pcDefault;tf={selectAll:yp,singleSelection:function(n){return n.setSelection(n.getCursor("anchor"),n.getCursor("head"),ui)},killLine:function(i){return lu(i,function(r){if(r.empty()){var u=t(i.doc,r.head.line).text.length;return r.head.ch==u&&r.head.line<i.lastLine()?{from:r.head,to:n(r.head.line+1,0)}:{from:r.head,to:n(r.head.line,u)}}return{from:r.from(),to:r.to()}})},deleteLine:function(t){return lu(t,function(i){return{from:n(i.from().line,0),to:f(t.doc,n(i.to().line+1,0))}})},delLineLeft:function(t){return lu(t,function(t){return{from:n(t.from().line,0),to:t.from()}})},delWrappedLineLeft:function(n){return lu(n,function(t){var i=n.charCoords(t.head,"div").top+5,r=n.coordsChar({left:0,top:i},"div");return{from:r,to:t.from()}})},delWrappedLineRight:function(n){return lu(n,function(t){var i=n.charCoords(t.head,"div").top+5,r=n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:i},"div");return{from:t.from(),to:r}})},undo:function(n){return n.undo()},redo:function(n){return n.redo()},undoSelection:function(n){return n.undoSelection()},redoSelection:function(n){return n.redoSelection()},goDocStart:function(t){return t.extendSelection(n(t.firstLine(),0))},goDocEnd:function(t){return t.extendSelection(n(t.lastLine()))},goLineStart:function(n){return n.extendSelectionsBy(function(t){return sw(n,t.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(n){return n.extendSelectionsBy(function(t){return hw(n,t.head)},{origin:"+move",bias:1})},goLineEnd:function(n){return n.extendSelectionsBy(function(t){return utt(n,t.head.line)},{origin:"+move",bias:-1})},goLineRight:function(n){return n.extendSelectionsBy(function(t){var i=n.cursorCoords(t.head,"div").top+5;return n.coordsChar({left:n.display.lineDiv.offsetWidth+100,top:i},"div")},ge)},goLineLeft:function(n){return n.extendSelectionsBy(function(t){var i=n.cursorCoords(t.head,"div").top+5;return n.coordsChar({left:0,top:i},"div")},ge)},goLineLeftSmart:function(n){return n.extendSelectionsBy(function(t){var r=n.cursorCoords(t.head,"div").top+5,i=n.coordsChar({left:0,top:r},"div");return i.ch<n.getLine(i.line).search(/\S/)?hw(n,t.head):i},ge)},goLineUp:function(n){return n.moveV(-1,"line")},goLineDown:function(n){return n.moveV(1,"line")},goPageUp:function(n){return n.moveV(-1,"page")},goPageDown:function(n){return n.moveV(1,"page")},goCharLeft:function(n){return n.moveH(-1,"char")},goCharRight:function(n){return n.moveH(1,"char")},goColumnLeft:function(n){return n.moveH(-1,"column")},goColumnRight:function(n){return n.moveH(1,"column")},goWordLeft:function(n){return n.moveH(-1,"word")},goGroupRight:function(n){return n.moveH(1,"group")},goGroupLeft:function(n){return n.moveH(-1,"group")},goWordRight:function(n){return n.moveH(1,"word")},delCharBefore:function(n){return n.deleteH(-1,"char")},delCharAfter:function(n){return n.deleteH(1,"char")},delWordBefore:function(n){return n.deleteH(-1,"word")},delWordAfter:function(n){return n.deleteH(1,"word")},delGroupBefore:function(n){return n.deleteH(-1,"group")},delGroupAfter:function(n){return n.deleteH(1,"group")},indentAuto:function(n){return n.indentSelection("smart")},indentMore:function(n){return n.indentSelection("add")},indentLess:function(n){return n.indentSelection("subtract")},insertTab:function(n){return n.replaceSelection("\t")},insertSoftTab:function(n){for(var t,u,f=[],e=n.listSelections(),i=n.options.tabSize,r=0;r<e.length;r++)t=e[r].from(),u=at(n.getLine(t.line),t.ch,i),f.push(bs(i-u%i));n.replaceSelections(f)},defaultTab:function(n){n.somethingSelected()?n.indentSelection("add"):n.execCommand("insertTab")},transposeChars:function(i){return ot(i,function(){for(var r,u,f,s=i.listSelections(),h=[],e=0;e<s.length;e++)s[e].empty()&&(r=s[e].head,u=t(i.doc,r.line).text,u&&(r.ch==u.length&&(r=new n(r.line,r.ch-1)),r.ch>0?(r=new n(r.line,r.ch+1),i.replaceRange(u.charAt(r.ch-1)+u.charAt(r.ch-2),n(r.line,r.ch-2),r,"+transpose")):r.line>i.doc.first&&(f=t(i.doc,r.line-1).text,f&&(r=new n(r.line,1),i.replaceRange(u.charAt(0)+i.doc.lineSeparator()+f.charAt(f.length-1),n(r.line-1,f.length-1),r,"+transpose")))),h.push(new o(r,r)));i.setSelections(h)})},newlineAndIndent:function(n){return ot(n,function(){for(var i,t=n.listSelections(),r=t.length-1;r>=0;r--)n.replaceRange(n.doc.lineSeparator(),t[r].anchor,t[r].head,"+input");for(t=n.listSelections(),i=0;i<t.length;i++)n.indentLine(t[i].from().line,null,!0);ru(n)})},openLine:function(n){return n.replaceSelection("\n","start")},toggleOverwrite:function(n){return n.toggleOverwrite()}};kb=new gi;hs=null;db=400;cs=function(n,t,i){this.time=n;this.pos=t;this.button=i};cs.prototype.compare=function(n,t,i){return this.time+db>n&&u(t,this.pos)==0&&i==this.button};var rf={toString:function(){return"CodeMirror.Init"}},tk={},vs={};a.defaults=tk;a.optionHandlers=vs;ls=[];a.defineInitHook=function(n){return ls.push(n)};yt=null;c=function(n){this.cm=n;this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null;this.polling=new gi;this.composing=null;this.gracePeriod=!1;this.readDOMTimeout=null};c.prototype.init=function(n){function e(n){var r,e,i,o,s;if(!w(t,n)){if(t.somethingSelected())rs({lineWise:!1,text:t.getSelections()}),n.type=="cut"&&t.replaceSelection("",null,"cut");else if(t.options.lineWiseCopyCut)r=tb(t),rs({lineWise:!0,text:r.text}),n.type=="cut"&&t.operation(function(){t.setSelections(r.ranges,0,ui);t.replaceSelection("",null,"cut")});else return;if(n.clipboardData&&(n.clipboardData.clearData(),e=yt.text.join("\n"),n.clipboardData.setData("Text",e),n.clipboardData.getData("Text")==e)){n.preventDefault();return}i=rb();o=i.firstChild;t.display.lineSpace.insertBefore(i,t.display.lineSpace.firstChild);o.value=yt.text.join("\n");s=document.activeElement;yu(o);setTimeout(function(){t.display.lineSpace.removeChild(i);s.focus();s==u&&f.showPrimarySelection()},50)}}var i=this,f=this,t=f.cm,u=f.div=n.lineDiv;ib(u,t.options.spellcheck);r(u,"paste",function(n){w(t,n)||gw(n,t)||l<=11&&setTimeout(b(t,function(){return i.updateFromDOM()}),20)});r(u,"compositionstart",function(n){i.composing={data:n.data,done:!1}});r(u,"compositionupdate",function(n){i.composing||(i.composing={data:n.data,done:!1})});r(u,"compositionend",function(n){i.composing&&(n.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)});r(u,"touchstart",function(){return f.forceCompositionEnd()});r(u,"input",function(){i.composing||i.readFromDOMSoon()});r(u,"copy",e);r(u,"cut",e)};c.prototype.prepareSelection=function(){var n=ry(this.cm,!1);return n.focus=this.cm.state.focused,n};c.prototype.showSelection=function(n,t){n&&this.cm.display.view.length&&((n.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(n))};c.prototype.showPrimarySelection=function(){var n=window.getSelection(),t=this.cm,y=t.doc.sel.primary(),c=y.from(),l=y.to(),r,f,e,i,a,o;if(t.display.viewTo==t.display.viewFrom||c.line>=t.display.viewTo||l.line<t.display.viewFrom){n.removeAllRanges();return}if(r=us(t,n.anchorNode,n.anchorOffset),f=us(t,n.focusNode,n.focusOffset),!r||r.bad||!f||f.bad||u(ro(r,f),c)!=0||u(io(r,f),l)!=0){var v=t.display.view,s=c.line>=t.display.viewFrom&&fb(t,c)||{node:v[0].measure.map[2],offset:0},h=l.line<t.display.viewTo&&fb(t,l);if(h||(e=v[v.length-1].measure,i=e.maps?e.maps[e.maps.length-1]:e.map,h={node:i[i.length-1],offset:i[i.length-2]-i[i.length-3]}),!s||!h){n.removeAllRanges();return}a=n.rangeCount&&n.getRangeAt(0);try{o=vu(s.node,s.offset,h.offset,h.node)}catch(p){}o&&(!ki&&t.state.focused?(n.collapse(s.node,s.offset),o.collapsed||(n.removeAllRanges(),n.addRange(o))):(n.removeAllRanges(),n.addRange(o)),a&&n.anchorNode==null?n.addRange(a):ki&&this.startGracePeriod());this.rememberSelection()}};c.prototype.startGracePeriod=function(){var n=this;clearTimeout(this.gracePeriod);this.gracePeriod=setTimeout(function(){n.gracePeriod=!1;n.selectionChanged()&&n.cm.operation(function(){return n.cm.curOp.selectionChanged=!0})},20)};c.prototype.showMultipleSelections=function(n){ct(this.cm.display.cursorDiv,n.cursors);ct(this.cm.display.selectionDiv,n.selection)};c.prototype.rememberSelection=function(){var n=window.getSelection();this.lastAnchorNode=n.anchorNode;this.lastAnchorOffset=n.anchorOffset;this.lastFocusNode=n.focusNode;this.lastFocusOffset=n.focusOffset};c.prototype.selectionInEditor=function(){var n=window.getSelection(),t;return n.rangeCount?(t=n.getRangeAt(0).commonAncestorContainer,vi(this.div,t)):!1};c.prototype.focus=function(){this.cm.options.readOnly!="nocursor"&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())};c.prototype.blur=function(){this.div.blur()};c.prototype.getField=function(){return this.div};c.prototype.supportsTouch=function(){return!0};c.prototype.receivedFocus=function(){function t(){n.cm.state.focused&&(n.pollSelection(),n.polling.set(n.cm.options.pollInterval,t))}var n=this;this.selectionInEditor()?this.pollSelection():ot(this.cm,function(){return n.cm.curOp.selectionChanged=!0});this.polling.set(this.cm.options.pollInterval,t)};c.prototype.selectionChanged=function(){var n=window.getSelection();return n.anchorNode!=this.lastAnchorNode||n.anchorOffset!=this.lastAnchorOffset||n.focusNode!=this.lastFocusNode||n.focusOffset!=this.lastFocusOffset};c.prototype.pollSelection=function(){var n,t,i,r;if(this.readDOMTimeout==null&&!this.gracePeriod&&this.selectionChanged()){if(n=window.getSelection(),t=this.cm,es&&fs&&this.cm.options.gutters.length&&nit(n.anchorNode)){this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs});this.blur();this.focus();return}this.composing||(this.rememberSelection(),i=us(t,n.anchorNode,n.anchorOffset),r=us(t,n.focusNode,n.focusOffset),i&&r&&ot(t,function(){nt(t.doc,wi(i,r),ui);(i.bad||r.bad)&&(t.curOp.selectionChanged=!0)}))}};c.prototype.pollContent=function(){var d,a,b,k,v,g,i,f,nt,tt;this.readDOMTimeout!=null&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var r=this.cm,e=r.display,it=r.doc.sel.primary(),c=it.from(),y=it.to();if((c.ch==0&&c.line>r.firstLine()&&(c=n(c.line-1,t(r.doc,c.line-1).length)),y.ch==t(r.doc,y.line).text.length&&y.line<r.lastLine()&&(y=n(y.line+1,0)),c.line<e.viewFrom||y.line>e.viewTo-1)||(c.line==e.viewFrom||(d=cr(r,c.line))==0?(a=h(e.view[0].line),b=e.view[0].node):(a=h(e.view[d].line),b=e.view[d-1].node.nextSibling),k=cr(r,y.line),k==e.view.length-1?(v=e.viewTo-1,g=e.lineDiv.lastChild):(v=h(e.view[k+1].line)-1,g=e.view[k+1].node.previousSibling),!b))return!1;for(i=r.doc.splitLines(tit(r,b,g,a,v)),f=rr(r.doc,n(a,0),n(v,t(r.doc,v).text.length));i.length>1&&f.length>1;)if(s(i)==s(f))i.pop(),f.pop(),v--;else if(i[0]==f[0])i.shift(),f.shift(),a++;else break;for(var o=0,l=0,rt=i[0],ut=f[0],ft=Math.min(rt.length,ut.length);o<ft&&rt.charCodeAt(o)==ut.charCodeAt(o);)++o;for(var p=s(i),w=s(f),et=Math.min(p.length-(i.length==1?o:0),w.length-(f.length==1?o:0));l<et&&p.charCodeAt(p.length-l-1)==w.charCodeAt(w.length-l-1);)++l;if(i.length==1&&f.length==1&&a==c.line)while(o&&o>c.ch&&p.charCodeAt(p.length-l-1)==w.charCodeAt(w.length-l-1))o--,l++;return i[i.length-1]=p.slice(0,p.length-l).replace(/^\u200b+/,""),i[0]=i[0].slice(o).replace(/\u200b+$/,""),nt=n(a,o),tt=n(v,f.length?s(f).length-l:0),i.length>1||i[0]||u(nt,tt)?(su(r.doc,i,nt,tt,"+input"),!0):void 0};c.prototype.ensurePolled=function(){this.forceCompositionEnd()};c.prototype.reset=function(){this.forceCompositionEnd()};c.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())};c.prototype.readFromDOMSoon=function(){var n=this;this.readDOMTimeout==null&&(this.readDOMTimeout=setTimeout(function(){if(n.readDOMTimeout=null,n.composing)if(n.composing.done)n.composing=null;else return;n.updateFromDOM()},80))};c.prototype.updateFromDOM=function(){var n=this;(this.cm.isReadOnly()||!this.pollContent())&&ot(this.cm,function(){return et(n.cm)})};c.prototype.setUneditable=function(n){n.contentEditable="false"};c.prototype.onKeyPress=function(n){n.charCode!=0&&(n.preventDefault(),this.cm.isReadOnly()||b(this.cm,ul)(this.cm,String.fromCharCode(n.charCode==null?n.keyCode:n.charCode),0))};c.prototype.readOnlyChanged=function(n){this.div.contentEditable=String(n!="nocursor")};c.prototype.onContextMenu=function(){};c.prototype.resetPosition=function(){};c.prototype.needsContentAttribute=!0;p=function(n){this.cm=n;this.prevInput="";this.pollingFast=!1;this.polling=new gi;this.hasSelection=!1;this.composing=null};p.prototype.init=function(n){function f(n){if(!w(t,n)){if(t.somethingSelected())rs({lineWise:!1,text:t.getSelections()});else if(t.options.lineWiseCopyCut){var r=tb(t);rs({lineWise:!0,text:r.text});n.type=="cut"?t.setSelections(r.ranges,null,ui):(i.prevInput="",u.value=r.text.join("\n"),yu(u))}else return;n.type=="cut"&&(t.state.cutIncoming=!0)}}var o=this,i=this,t=this.cm,s=this.wrapper=rb(),u=this.textarea=s.firstChild;n.wrapper.insertBefore(s,n.wrapper.firstChild);ce&&(u.style.width="0px");r(u,"input",function(){e&&l>=9&&o.hasSelection&&(o.hasSelection=null);i.poll()});r(u,"paste",function(n){w(t,n)||gw(n,t)||(t.state.pasteIncoming=!0,i.fastPoll())});r(u,"cut",f);r(u,"copy",f);r(n.scroller,"paste",function(r){si(n,r)||w(t,r)||(t.state.pasteIncoming=!0,i.focus())});r(n.lineSpace,"selectstart",function(t){si(n,t)||ft(t)});r(u,"compositionstart",function(){var n=t.getCursor("from");i.composing&&i.composing.range.clear();i.composing={start:n,range:t.markText(n,t.getCursor("to"),{className:"CodeMirror-composing"})}});r(u,"compositionend",function(){i.composing&&(i.poll(),i.composing.range.clear(),i.composing=null)})};p.prototype.prepareSelection=function(){var n=this.cm,t=n.display,e=n.doc,i=ry(n);if(n.options.moveInputWithCursor){var r=pt(n,e.sel.primary().head,"div"),u=t.wrapper.getBoundingClientRect(),f=t.lineDiv.getBoundingClientRect();i.teTop=Math.max(0,Math.min(t.wrapper.clientHeight-10,r.top+f.top-u.top));i.teLeft=Math.max(0,Math.min(t.wrapper.clientWidth-10,r.left+f.left-u.left))}return i};p.prototype.showSelection=function(n){var i=this.cm,t=i.display;ct(t.cursorDiv,n.cursors);ct(t.selectionDiv,n.selection);n.teTop!=null&&(this.wrapper.style.top=n.teTop+"px",this.wrapper.style.left=n.teLeft+"px")};p.prototype.reset=function(n){var t,i;this.contextMenuPending||this.composing||(t=this.cm,t.somethingSelected()?(this.prevInput="",i=t.getSelection(),this.textarea.value=i,t.state.focused&&yu(this.textarea),e&&l>=9&&(this.hasSelection=i)):n||(this.prevInput=this.textarea.value="",e&&l>=9&&(this.hasSelection=null)))};p.prototype.getField=function(){return this.textarea};p.prototype.supportsTouch=function(){return!1};p.prototype.focus=function(){if(this.cm.options.readOnly!="nocursor"&&(!le||fi()!=this.textarea))try{this.textarea.focus()}catch(n){}};p.prototype.blur=function(){this.textarea.blur()};p.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0};p.prototype.receivedFocus=function(){this.slowPoll()};p.prototype.slowPoll=function(){var n=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){n.poll();n.cm.state.focused&&n.slowPoll()})};p.prototype.fastPoll=function(){function t(){var r=n.poll();r||i?(n.pollingFast=!1,n.slowPoll()):(i=!0,n.polling.set(60,t))}var i=!1,n=this;n.pollingFast=!0;n.polling.set(20,t)};p.prototype.poll=function(){var i=this,n=this.cm,f=this.textarea,r=this.prevInput,t,o,u,s;if(this.contextMenuPending||!n.state.focused||cit(f)&&!r&&!this.composing||n.isReadOnly()||n.options.disableInput||n.state.keySeq||(t=f.value,t==r&&!n.somethingSelected()))return!1;if(e&&l>=9&&this.hasSelection===t||kt&&/[\uf700-\uf7ff]/.test(t))return n.display.input.reset(),!1;if(n.doc.sel==n.display.selForContextMenu&&(o=t.charCodeAt(0),o!=8203||r||(r="​"),o==8666))return this.reset(),this.cm.execCommand("undo");for(u=0,s=Math.min(r.length,t.length);u<s&&r.charCodeAt(u)==t.charCodeAt(u);)++u;return ot(n,function(){ul(n,t.slice(u),r.length-u,null,i.composing?"*compose":null);t.length>1e3||t.indexOf("\n")>-1?f.value=i.prevInput="":i.prevInput=t;i.composing&&(i.composing.range.clear(),i.composing.range=n.markText(i.composing.start,n.getCursor("to"),{className:"CodeMirror-composing"}))}),!0};p.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)};p.prototype.onKeyPress=function(){e&&l>=9&&(this.hasSelection=null);this.fastPoll()};p.prototype.onContextMenu=function(n){function c(){if(u.selectionStart!=null){var n=t.somethingSelected(),r="​"+(n?u.value:"");u.value="⇚";u.value=r;f.prevInput=n?"":"​";u.selectionStart=1;u.selectionEnd=r.length;i.selForContextMenu=t.doc.sel}}function a(){if(f.contextMenuPending=!1,f.wrapper.style.cssText=p,u.style.cssText=y,e&&l<9&&i.scrollbars.setScrollTop(i.scroller.scrollTop=k),u.selectionStart!=null){(!e||e&&l<9)&&c();var r=0,n=function(){i.selForContextMenu==t.doc.sel&&u.selectionStart==0&&u.selectionEnd>0&&f.prevInput=="​"?b(t,yp)(t):r++<10?i.detectingSelectAll=setTimeout(n,500):(i.selForContextMenu=null,i.input.reset())};i.detectingSelectAll=setTimeout(n,200)}}var f=this,t=f.cm,i=t.display,u=f.textarea,o=hr(t,n),k=i.scroller.scrollTop,v,y,p,s,w,h;o&&!bt&&(v=t.options.resetSelectionOnContextMenu,v&&t.doc.sel.contains(o)==-1&&b(t,nt)(t.doc,wi(o),ui),y=u.style.cssText,p=f.wrapper.style.cssText,f.wrapper.style.cssText="position: absolute",s=f.wrapper.getBoundingClientRect(),u.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(n.clientY-s.top-5)+"px; left: "+(n.clientX-s.left-5)+"px;\n      z-index: 1000; background: "+(e?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",tt&&(w=window.scrollY),i.input.focus(),tt&&window.scrollTo(null,w),i.input.reset(),t.somethingSelected()||(u.value=f.prevInput=" "),f.contextMenuPending=!0,i.selForContextMenu=t.doc.sel,clearTimeout(i.detectingSelectAll),e&&l>=9&&c(),os?(cf(n),h=function(){lt(window,"mouseup",h);setTimeout(a,20)},r(window,"mouseup",h)):setTimeout(a,50))};p.prototype.readOnlyChanged=function(n){n||this.reset();this.textarea.disabled=n=="nocursor"};p.prototype.setUneditable=function(){};p.prototype.needsContentAttribute=!1;wtt(a);gtt(a);gb="iter insert remove copy getEditor constructor".split(" ");for(de in ut.prototype)ut.prototype.hasOwnProperty(de)&&d(gb,de)<0&&(a.prototype[de]=function(n){return function(){return n.apply(this.doc,arguments)}}(ut.prototype[de]));return tu(ut),a.inputStyles={textarea:p,contenteditable:c},a.defineMode=function(n){a.defaults.mode||n=="null"||(a.defaults.mode=n);kk.apply(this,arguments)},a.defineMIME=dk,a.defineMode("null",function(){return{token:function(n){return n.skipToEnd()}}}),a.defineMIME("text/plain","null"),a.defineExtension=function(n,t){a.prototype[n]=t},a.defineDocExtension=function(n,t){ut.prototype[n]=t},a.fromTextArea=rit,uit(a),a.version="5.31.1",a}),function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){"use strict";n.defineMode("sql",function(t,i){function u(n,t){var i=n.next(),e,u;if(s[i]&&(e=s[i](n,t),e!==!1))return e;if(r.hexNumber&&(i=="0"&&n.match(/^[xX][0-9a-fA-F]+/)||(i=="x"||i=="X")&&n.match(/^'[0-9a-fA-F]+'/))||r.binaryNumber&&((i=="b"||i=="B")&&n.match(/^'[01]+'/)||i=="0"&&n.match(/^b[01]+/)))return"number";if(i.charCodeAt(0)>47&&i.charCodeAt(0)<58)return n.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),r.decimallessFloat&&n.match(/^\.(?!\.)/),"number";if(i=="?"&&(n.eatSpace()||n.eol()||n.eat(";")))return"variable-3";if(i=="'"||i=='"'&&r.doubleQuote)return t.tokenize=h(i),t.tokenize(n,t);if((r.nCharCast&&(i=="n"||i=="N")||r.charsetCast&&i=="_"&&n.match(/[a-z][a-z0-9]*/i))&&(n.peek()=="'"||n.peek()=='"'))return"keyword";if(/^[\(\),\;\[\]]/.test(i))return null;if(r.commentSlashSlash&&i=="/"&&n.eat("/")||r.commentHash&&i=="#"||i=="-"&&n.eat("-")&&(!r.commentSpaceRequired||n.eat(" ")))return n.skipToEnd(),"comment";if(i=="/"&&n.eat("*"))return t.tokenize=f(1),t.tokenize(n,t);if(i=="."){if(r.zerolessFloat&&n.match(/^(?:\d+(?:e[+-]?\d+)?)/i))return"number";if(n.match(/^\.+/))return null;if(r.ODBCdotTable&&n.match(/^[\w\d_]+/))return"variable-2"}else return o.test(i)?(n.eatWhile(o),null):i=="{"&&(n.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||n.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/))?"number":(n.eatWhile(/^[_\w\d]/),u=n.current().toLowerCase(),p.hasOwnProperty(u)&&(n.match(/^( )+'[^']*'/)||n.match(/^( )+"[^"]*"/)))?"number":a.hasOwnProperty(u)?"atom":v.hasOwnProperty(u)?"builtin":y.hasOwnProperty(u)?"keyword":l.hasOwnProperty(u)?"string-2":null}function h(n){return function(t,i){for(var r=!1,f;(f=t.next())!=null;){if(f==n&&!r){i.tokenize=u;break}r=!r&&f=="\\"}return"string"}}function f(n){return function(t,i){var r=t.match(/^.*?(\/\*|\*\/)/);return r?i.tokenize=r[1]=="/*"?f(n+1):n>1?f(n-1):u:t.skipToEnd(),"comment"}}function e(n,t,i){t.context={prev:t.context,indent:n.indentation(),col:n.column(),type:i}}function c(n){n.indent=n.context.indent;n.context=n.context.prev}var l=i.client||{},a=i.atoms||{"false":!0,"true":!0,"null":!0},v=i.builtin||{},y=i.keywords||{},o=i.operatorChars||/^[*+\-%<>!=&|~^]/,r=i.support||{},s=i.hooks||{},p=i.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:u,context:null}},token:function(n,t){var i,r;return(n.sol()&&t.context&&t.context.align==null&&(t.context.align=!1),t.tokenize==u&&n.eatSpace())?null:(i=t.tokenize(n,t),i=="comment")?i:(t.context&&t.context.align==null&&(t.context.align=!0),r=n.current(),r=="("?e(n,t,")"):r=="["?e(n,t,"]"):t.context&&t.context.type==r&&c(t),i)},indent:function(i,r){var u=i.context,f;return u?(f=r.charAt(0)==u.type,u.align?u.col+(f?0:1):u.indent+(f?0:t.indentUnit)):n.Pass},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:r.commentSlashSlash?"//":r.commentHash?"#":"--"}}),function(){function u(n){for(var t;(t=n.next())!=null;)if(t=="`"&&!n.eat("`"))return"variable-2";return n.backUp(n.current().length-1),n.eatWhile(/\w/)?"variable-2":null}function e(n){for(var t;(t=n.next())!=null;)if(t=='"'&&!n.eat('"'))return"variable-2";return n.backUp(n.current().length-1),n.eatWhile(/\w/)?"variable-2":null}function i(n){return(n.eat("@")&&(n.match(/^session\./),n.match(/^local\./),n.match(/^global\./)),n.eat("'"))?(n.match(/^.*'/),"variable-2"):n.eat('"')?(n.match(/^.*"/),"variable-2"):n.eat("`")?(n.match(/^.*`/),"variable-2"):n.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function f(n){return n.eat("N")?"atom":n.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function t(n){for(var i={},r=n.split(" "),t=0;t<r.length;++t)i[r[t]]=!0;return i}var r="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ";n.defineMIME("text/x-sql",{name:"sql",keywords:t(r+"begin"),builtin:t("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable doubleQuote binaryNumber hexNumber")});n.defineMIME("text/x-mssql",{name:"sql",client:t("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:t(r+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec"),builtin:t("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:t("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":i}});n.defineMIME("text/x-mysql",{name:"sql",client:t("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:t(r+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:t("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":i,"`":u,"\\":f}});n.defineMIME("text/x-mariadb",{name:"sql",client:t("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:t(r+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:t("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":i,"`":u,"\\":f}});n.defineMIME("text/x-memsql",{name:"sql",client:t("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:t(r+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:t("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":i,"`":u,"\\":f}});n.defineMIME("text/x-sqlite",{name:"sql",client:t("auth backup bail binary changes check clone databases dbinfo dump echo eqp exit explain fullschema headers help import imposter indexes iotrace limit lint load log mode nullvalue once open output print prompt quit read restore save scanstats schema separator session shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width"),keywords:t(r+"abort action add after all analyze attach autoincrement before begin cascade case cast check collate column commit conflict constraint cross current_date current_time current_timestamp database default deferrable deferred detach each else end escape except exclusive exists explain fail for foreign full glob if ignore immediate index indexed initially inner instead intersect isnull key left limit match natural no notnull null of offset outer plan pragma primary query raise recursive references regexp reindex release rename replace restrict right rollback row savepoint temp temporary then to transaction trigger unique using vacuum view virtual when with without"),builtin:t("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text clob bigint int int2 int8 integer float double char varchar date datetime year unsigned signed numeric real"),atoms:t("null current_date current_time current_timestamp"),operatorChars:/^[*+\-%<>!=&|/~]/,dateSQL:t("date time timestamp datetime"),support:t("decimallessFloat zerolessFloat"),identifierQuote:'"',hooks:{"@":i,":":i,"?":i,$:i,'"':e,"`":u}});n.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:t("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:t("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:t("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:t("commentSlashSlash decimallessFloat"),hooks:{}});n.defineMIME("text/x-plsql",{name:"sql",client:t("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:t("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:t("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:t("date time timestamp"),support:t("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")});n.defineMIME("text/x-hive",{name:"sql",keywords:t("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:t("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:t("date timestamp"),support:t("ODBCdotTable doubleQuote binaryNumber hexNumber")});n.defineMIME("text/x-pgsql",{name:"sql",client:t("source"),keywords:t(r+"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parallel parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict restricted result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat attach path depends detach zone"),builtin:t("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")});n.defineMIME("text/x-gql",{name:"sql",keywords:t("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:t("false true"),builtin:t("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/});n.defineMIME("text/x-gpsql",{name:"sql",client:t("source"),keywords:t("abort absolute access action active add admin after aggregate all also alter always analyse analyze and any array as asc assertion assignment asymmetric at authorization backward before begin between bigint binary bit boolean both by cache called cascade cascaded case cast chain char character characteristics check checkpoint class close cluster coalesce codegen collate column comment commit committed concurrency concurrently configuration connection constraint constraints contains content continue conversion copy cost cpu_rate_limit create createdb createexttable createrole createuser cross csv cube current current_catalog current_date current_role current_schema current_time current_timestamp current_user cursor cycle data database day deallocate dec decimal declare decode default defaults deferrable deferred definer delete delimiter delimiters deny desc dictionary disable discard distinct distributed do document domain double drop dxl each else enable encoding encrypted end enum errors escape every except exchange exclude excluding exclusive execute exists explain extension external extract false family fetch fields filespace fill filter first float following for force foreign format forward freeze from full function global grant granted greatest group group_id grouping handler hash having header hold host hour identity if ignore ilike immediate immutable implicit in including inclusive increment index indexes inherit inherits initially inline inner inout input insensitive insert instead int integer intersect interval into invoker is isnull isolation join key language large last leading least left level like limit list listen load local localtime localtimestamp location lock log login mapping master match maxvalue median merge minute minvalue missing mode modifies modify month move name names national natural nchar new newline next no nocreatedb nocreateexttable nocreaterole nocreateuser noinherit nologin none noovercommit nosuperuser not nothing notify notnull nowait null nullif nulls numeric object of off offset oids old on only operator option options or order ordered others out outer over overcommit overlaps overlay owned owner parser partial partition partitions passing password percent percentile_cont percentile_disc placing plans position preceding precision prepare prepared preserve primary prior privileges procedural procedure protocol queue quote randomly range read readable reads real reassign recheck recursive ref references reindex reject relative release rename repeatable replace replica reset resource restart restrict returning returns revoke right role rollback rollup rootpartition row rows rule savepoint scatter schema scroll search second security segment select sequence serializable session session_user set setof sets share show similar simple smallint some split sql stable standalone start statement statistics stdin stdout storage strict strip subpartition subpartitions substring superuser symmetric sysid system table tablespace temp template temporary text then threshold ties time timestamp to trailing transaction treat trigger trim true truncate trusted type unbounded uncommitted unencrypted union unique unknown unlisten until update user using vacuum valid validation validator value values varchar variadic varying verbose version view volatile web when where whitespace window with within without work writable write xml xmlattributes xmlconcat xmlelement xmlexists xmlforest xmlparse xmlpi xmlroot xmlserialize year yes zone"),builtin:t("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:t("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")});n.defineMIME("text/x-sparksql",{name:"sql",keywords:t("add after all alter analyze and anti archive array as asc at between bucket buckets by cache cascade case cast change clear cluster clustered codegen collection column columns comment commit compact compactions compute concatenate cost create cross cube current current_date current_timestamp database databases datata dbproperties defined delete delimited desc describe dfs directories distinct distribute drop else end escaped except exchange exists explain export extended external false fields fileformat first following for format formatted from full function functions global grant group grouping having if ignore import in index indexes inner inpath inputformat insert intersect interval into is items join keys last lateral lazy left like limit lines list load local location lock locks logical macro map minus msck natural no not null nulls of on option options or order out outer outputformat over overwrite partition partitioned partitions percent preceding principals purge range recordreader recordwriter recover reduce refresh regexp rename repair replace reset restrict revoke right rlike role roles rollback rollup row rows schema schemas select semi separated serde serdeproperties set sets show skewed sort sorted start statistics stored stratify struct table tables tablesample tblproperties temp temporary terminated then to touch transaction transactions transform true truncate unarchive unbounded uncache union unlock unset use using values view when where window with"),builtin:t("tinyint smallint int bigint boolean float double string binary timestamp decimal array map struct uniontype delimited serde sequencefile textfile rcfile inputformat outputformat"),atoms:t("false true null"),operatorChars:/^[*+\-%<>!=~&|^]/,dateSQL:t("date time timestamp"),support:t("ODBCdotTable doubleQuote zerolessFloat")});n.defineMIME("text/x-esper",{name:"sql",client:t("source"),keywords:t("alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit after all and as at asc avedev avg between by case cast coalesce count create current_timestamp day days delete define desc distinct else end escape events every exists false first from full group having hour hours in inner insert instanceof into irstream is istream join last lastweekday left limit like max match_recognize matches median measures metadatasql min minute minutes msec millisecond milliseconds not null offset on or order outer output partition pattern prev prior regexp retain-union retain-intersection right rstream sec second seconds select set some snapshot sql stddev sum then true unidirectional until update variable weekday when where window"),builtin:{},atoms:t("false true null"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:t("time"),support:t("decimallessFloat zerolessFloat binaryNumber hexNumber")})}()}),function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){"use strict";function r(n,t){this.cm=n;this.options=t;this.widget=null;this.debounce=0;this.tick=0;this.startPos=this.cm.getCursor("start");this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var i=this;n.on("cursorActivity",this.activityFunc=function(){i.cursorActivity()})}function c(t,i){var r=n.cmpPos(i.from,t.from);return r>0&&t.to.ch-t.from.ch!=i.to.ch-i.from.ch}function l(n,t,r){var e=n.options.hintOptions,f={};for(var u in i)f[u]=i[u];if(e)for(u in e)e[u]!==undefined&&(f[u]=e[u]);if(r)for(u in r)r[u]!==undefined&&(f[u]=r[u]);return f.hint.resolve&&(f.hint=f.hint.resolve(n,t)),f}function u(n){return typeof n=="string"?n:n.text}function a(n,t){function e(n,i){var r;r=typeof i!="string"?function(n){return i(n,t)}:f.hasOwnProperty(i)?f[i]:i;o[n]=r}var f={Up:function(){t.moveFocus(-1)},Down:function(){t.moveFocus(1)},PageUp:function(){t.moveFocus(-t.menuSize()+1,!0)},PageDown:function(){t.moveFocus(t.menuSize()-1,!0)},Home:function(){t.setFocus(0)},End:function(){t.setFocus(t.length-1)},Enter:t.pick,Tab:t.pick,Esc:t.close},r=n.options.customKeys,o=r?{}:f,u,i;if(r)for(i in r)r.hasOwnProperty(i)&&e(i,r[i]);if(u=n.options.extraKeys,u)for(i in u)u.hasOwnProperty(i)&&e(i,u[i]);return o}function f(n,t){while(t&&t!=n){if(t.nodeName.toUpperCase()==="LI"&&t.parentNode==n)return t;t=t.parentNode}}function e(i,r){var y,v,w,k,d,ft,rt,g,b,et;this.completion=i;this.data=r;this.picked=!1;var h=this,o=i.cm,e=this.hints=document.createElement("ul");for(e.className="CodeMirror-hints",this.selectedHint=r.selectedHint||0,y=r.list,v=0;v<y.length;++v){var nt=e.appendChild(document.createElement("li")),l=y[v],ut=p+(v!=this.selectedHint?"":" "+t);l.className!=null&&(ut=l.className+" "+ut);nt.className=ut;l.render?l.render(nt,r,l):nt.appendChild(document.createTextNode(l.displayText||u(l)));nt.hintId=v}var c=o.cursorCoords(i.options.alignWithWord?r.from:null),tt=c.left,it=c.bottom,ot=!0;e.style.left=tt+"px";e.style.top=it+"px";w=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth);k=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight);(i.options.container||document.body).appendChild(e);var s=e.getBoundingClientRect(),ht=s.bottom-k,ct=e.scrollHeight>e.clientHeight+1,st=o.getScrollInfo();if(ht>0&&(d=s.bottom-s.top,ft=c.top-(c.bottom-s.top),ft-d>0?(e.style.top=(it=c.top-d)+"px",ot=!1):d>k&&(e.style.height=k-5+"px",e.style.top=(it=c.bottom-s.top)+"px",rt=o.getCursor(),r.from.ch!=rt.ch&&(c=o.cursorCoords(rt),e.style.left=(tt=c.left)+"px",s=e.getBoundingClientRect()))),g=s.right-w,g>0&&(s.right-s.left>w&&(e.style.width=w-5+"px",g-=s.right-s.left-w),e.style.left=(tt=c.left-g)+"px"),ct)for(b=e.firstChild;b;b=b.nextSibling)b.style.paddingRight=o.display.nativeBarWidth+"px";if(o.addKeyMap(this.keyMap=a(i,{moveFocus:function(n,t){h.changeActive(h.selectedHint+n,t)},setFocus:function(n){h.changeActive(n)},menuSize:function(){return h.screenAmount()},length:y.length,close:function(){i.close()},pick:function(){h.pick()},data:r})),i.options.closeOnUnfocus){o.on("blur",this.onBlur=function(){et=setTimeout(function(){i.close()},100)});o.on("focus",this.onFocus=function(){clearTimeout(et)})}o.on("scroll",this.onScroll=function(){var t=o.getScrollInfo(),r=o.getWrapperElement().getBoundingClientRect(),u=it+st.top-t.top,n=u-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(ot||(n+=e.offsetHeight),n<=r.top||n>=r.bottom)return i.close();e.style.top=u+"px";e.style.left=tt+st.left-t.left+"px"});n.on(e,"dblclick",function(n){var t=f(e,n.target||n.srcElement);t&&t.hintId!=null&&(h.changeActive(t.hintId),h.pick())});n.on(e,"click",function(n){var t=f(e,n.target||n.srcElement);t&&t.hintId!=null&&(h.changeActive(t.hintId),i.options.completeOnSingleClick&&h.pick())});n.on(e,"mousedown",function(){setTimeout(function(){o.focus()},20)});return n.signal(r,"select",y[this.selectedHint],e.childNodes[this.selectedHint]),!0}function v(n,t){var r,i;if(!n.somethingSelected())return t;for(r=[],i=0;i<t.length;i++)t[i].supportsSelection&&r.push(t[i]);return r}function o(n,t,i,r){if(n.async)n(t,r,i);else{var u=n(t,i);u&&u.then?u.then(r):r(u)}}function y(t,i){var u=t.getHelpers(i,"hint"),f,r;return u.length?(r=function(n,t,i){function r(u){if(u==f.length)return t(null);o(f[u],n,i,function(n){n&&n.list.length>0?t(n):r(u+1)})}var f=v(n,u);r(0)},r.async=!0,r.supportsSelection=!0,r):(f=t.getHelper(t.getCursor(),"hintWords"))?function(t){return n.hint.fromList(t,{words:f})}:n.hint.anyword?function(t,i){return n.hint.anyword(t,i)}:function(){}}var p="CodeMirror-hint",t="CodeMirror-hint-active",s,h,i;n.showHint=function(n,t,i){var r,u;if(!t)return n.showHint(i);if(i&&i.async&&(t.async=!0),r={hint:t},i)for(u in i)r[u]=i[u];return n.showHint(r)};n.defineExtension("showHint",function(t){var i,u,f;if(t=l(this,this.getCursor("start"),t),i=this.listSelections(),!(i.length>1)){if(this.somethingSelected()){if(!t.hint.supportsSelection)return;for(u=0;u<i.length;u++)if(i[u].head.line!=i[u].anchor.line)return}(this.state.completionActive&&this.state.completionActive.close(),f=this.state.completionActive=new r(this,t),f.options.hint)&&(n.signal(this,"startCompletion",this),f.update(!0))}});s=window.requestAnimationFrame||function(n){return setTimeout(n,1e3/60)};h=window.cancelAnimationFrame||clearTimeout;r.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&n.signal(this.data,"close"),this.widget&&this.widget.close(),n.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(t,i){var r=t.list[i];r.hint?r.hint(this.cm,t,r):this.cm.replaceRange(u(r),r.from||t.from,r.to||t.to,"complete");n.signal(t,"pick",r);this.close()},cursorActivity:function(){var n,t,i;this.debounce&&(h(this.debounce),this.debounce=0);n=this.cm.getCursor();t=this.cm.getLine(n.line);n.line!=this.startPos.line||t.length-n.ch!=this.startLen-this.startPos.ch||n.ch<this.startPos.ch||this.cm.somethingSelected()||n.ch&&this.options.closeCharacters.test(t.charAt(n.ch-1))?this.close():(i=this,this.debounce=s(function(){i.update()}),this.widget&&this.widget.disable())},update:function(n){if(this.tick!=null){var t=this,i=++this.tick;o(this.options.hint,this.cm,this.options,function(r){t.tick==i&&t.finishUpdate(r,n)})}},finishUpdate:function(t,i){this.data&&n.signal(this.data,"update");var r=this.widget&&this.widget.picked||i&&this.options.completeSingle;(this.widget&&this.widget.close(),t&&this.data&&c(this.data,t))||(this.data=t,t&&t.list.length&&(r&&t.list.length==1?this.pick(t,0):(this.widget=new e(this,t),n.signal(t,"shown"))))}};e.prototype={close:function(){if(this.completion.widget==this){this.completion.widget=null;this.hints.parentNode.removeChild(this.hints);this.completion.cm.removeKeyMap(this.keyMap);var n=this.completion.cm;this.completion.options.closeOnUnfocus&&(n.off("blur",this.onBlur),n.off("focus",this.onFocus));n.off("scroll",this.onScroll)}},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var n=this;this.keyMap={Enter:function(){n.picked=!0}};this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(i,r){if(i>=this.data.list.length?i=r?this.data.list.length-1:0:i<0&&(i=r?0:this.data.list.length-1),this.selectedHint!=i){var u=this.hints.childNodes[this.selectedHint];u.className=u.className.replace(" "+t,"");u=this.hints.childNodes[this.selectedHint=i];u.className+=" "+t;u.offsetTop<this.hints.scrollTop?this.hints.scrollTop=u.offsetTop-3:u.offsetTop+u.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=u.offsetTop+u.offsetHeight-this.hints.clientHeight+3);n.signal(this.data,"select",this.data.list[this.selectedHint],u)}},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}};n.registerHelper("hint","auto",{resolve:y});n.registerHelper("hint","fromList",function(t,i){var o=t.getCursor(),r=t.getTokenAt(o),c=n.Pos(o.line,r.end),u,s,f,e,h;for(r.string&&/\w/.test(r.string[r.string.length-1])?(u=r.string,s=n.Pos(o.line,r.start)):(u="",s=c),f=[],e=0;e<i.words.length;e++)h=i.words[e],h.slice(0,u.length)==u&&f.push(h);if(f.length)return{list:f,from:s,to:c}});n.commands.autocomplete=n.showHint;i={hint:n.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null};n.defineOption("hintOptions",null)}),function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror"),require("../../mode/sql/sql")):typeof define=="function"&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],n):n(CodeMirror)}(function(n){"use strict";function s(n){return Object.prototype.toString.call(n)=="[object Array]"}function b(t){var i=t.doc.modeOption;return i==="sql"&&(i="text/x-sql"),n.resolveMode(i).keywords}function k(t){var i=t.doc.modeOption;return i==="sql"&&(i="text/x-sql"),n.resolveMode(i).identifierQuote||"`"}function f(n){return typeof n=="string"?n:n.text}function l(n,t){return s(t)&&(t={columns:t}),t.text||(t.text=n),t}function d(n){var u={},t,i,r;if(s(n))for(t=n.length-1;t>=0;t--)i=n[t],u[f(i).toUpperCase()]=l(f(i),i);else if(n)for(r in n)u[r.toUpperCase()]=l(r,n[r]);return u}function e(n){return o[n.toUpperCase()]}function a(n){var i={};for(var t in n)n.hasOwnProperty(t)&&(i[t]=n[t]);return i}function v(n,t){var i=n.length,r=f(t).substr(0,i);return n.toUpperCase()===r.toUpperCase()}function u(n,t,i,r){var f,e,u;if(s(i))for(f=0;f<i.length;f++)v(t,i[f])&&n.push(r(i[f]));else for(e in i)i.hasOwnProperty(e)&&(u=i[e],u=u&&u!==!0?u.displayText?{text:u.text,displayText:u.displayText}:u.text:e,v(t,u)&&n.push(r(u)))}function g(n){var i,r;for(n.charAt(0)=="."&&(n=n.substr(1)),i=n.split(t+t),r=0;r<i.length;r++)i[r]=i[r].replace(new RegExp(t,"g"),"");return i.join(t)}function h(n){for(var u,i=f(n).split("."),r=0;r<i.length;r++)i[r]=t+i[r].replace(new RegExp(t,"g"),t+t)+t;return(u=i.join("."),typeof n=="string")?u:(n=a(n),n.text=u,n)}function nt(n,f,s,c){for(var p=!1,b=[],d=f.start,k=!0,w,nt,v;k;)k=f.string.charAt(0)==".",p=p||f.string.charAt(0)==t,d=f.start,b.unshift(g(f.string)),f=c.getTokenAt(r(n.line,f.start)),f.string=="."&&(k=!0,f=c.getTokenAt(r(n.line,f.start)));w=b.join(".");u(s,w,o,function(n){return p?h(n):n});u(s,w,i,function(n){return p?h(n):n});w=b.pop();var l=b.join("."),tt=!1,it=l;return e(l)||(nt=l,l=y(l,c),l!==nt&&(tt=!0)),v=e(l),v&&v.columns&&(v=v.columns),v&&u(s,w,v,function(n){var t=l;return tt==!0&&(t=it),typeof n=="string"?n=t+"."+n:(n=a(n),n.text=t+"."+n.text),p?h(n):n}),d}function tt(n,t){for(var r=n.split(/\s+/),i=0;i<r.length;i++)r[i]&&t(r[i].replace(/[,;]/g,""))}function y(n,t){for(var s=t.doc,p=s.getValue(),k=n.toUpperCase(),h="",l="",u=[],a={start:r(0,0),end:r(t.lastLine(),t.getLineHandle(t.lastLine()).length)},o=p.indexOf(c.QUERY_DIV),f,v,y,i,b;o!=-1;)u.push(s.posFromIndex(o)),o=p.indexOf(c.QUERY_DIV,o+1);for(u.unshift(r(0,0)),u.push(r(t.lastLine(),t.getLineHandle(t.lastLine()).text.length)),f=null,v=t.getCursor(),i=0;i<u.length;i++){if((f==null||w(v,f)>0)&&w(v,u[i])<=0){a={start:f,end:u[i]};break}f=u[i]}for(y=s.getRange(a.start,a.end,!1),i=0;i<y.length;i++)if(b=y[i],tt(b,function(n){var t=n.toUpperCase();t===k&&e(h)&&(l=h);t!==c.ALIAS_KEYWORD&&(h=n)}),l)break;return l}var o,i,p,t,c={QUERY_DIV:";",ALIAS_KEYWORD:"AS"},r=n.Pos,w=n.cmpPos;n.registerHelper("hint","sql",function(n,f){var l,g;o=d(f&&f.tables);l=f&&f.defaultTable;g=f&&f.disableKeywords;i=l&&e(l);p=b(n);t=k(n);l&&!i&&(i=y(l,n));i=i||[];i.columns&&(i=i.columns);var h=n.getCursor(),a=[],s=n.getTokenAt(h),v,w,c;return s.end>h.ch&&(s.end=h.ch,s.string=s.string.slice(0,h.ch-s.start)),s.string.match(/^[.`"\w@]\w*$/)?(c=s.string,v=s.start,w=s.end):(v=w=h.ch,c=""),c.charAt(0)=="."||c.charAt(0)==t?v=nt(h,s,a,n):(u(a,c,o,function(n){return n}),u(a,c,i,function(n){return n}),g||u(a,c,p,function(n){return n.toUpperCase()})),{list:a,from:r(h.line,v),to:r(h.line,w)}})}),function(n){typeof exports=="object"&&typeof module=="object"?n(require("../../lib/codemirror")):typeof define=="function"&&define.amd?define(["../../lib/codemirror"],n):n(CodeMirror)}(function(n){function i(n){n.state.placeholder&&(n.state.placeholder.parentNode.removeChild(n.state.placeholder),n.state.placeholder=null)}function r(n){var t,r;i(n);t=n.state.placeholder=document.createElement("pre");t.style.cssText="height: 0; overflow: visible";t.style.direction=n.getOption("direction");t.className="CodeMirror-placeholder CodeMirror-line-like";r=n.getOption("placeholder");typeof r=="string"&&(r=document.createTextNode(r));t.appendChild(r);n.display.lineSpace.insertBefore(t,n.display.lineSpace.firstChild)}function e(n){setTimeout(function(){var u=!1,t;n.lineCount()==1&&(t=n.getInputField(),u=t.nodeName=="TEXTAREA"?!n.getLine(0).length:!/[^\u200b]/.test(t.querySelector(".CodeMirror-line").textContent));u?r(n):i(n)},20)}function u(n){f(n)&&r(n)}function t(n){var t=n.getWrapperElement(),u=f(n);t.className=t.className.replace(" CodeMirror-empty","")+(u?" CodeMirror-empty":"");u?r(n):i(n)}function f(n){return n.lineCount()===1&&n.getLine(0)===""}n.defineOption("placeholder","",function(r,f,o){var h=o&&o!=n.Init,s;if(f&&!h){r.on("blur",u);r.on("change",t);r.on("swapDoc",t);n.on(r.getInputField(),"compositionupdate",r.state.placeholderCompose=function(){e(r)});t(r)}else!f&&h&&(r.off("blur",u),r.off("change",t),r.off("swapDoc",t),n.off(r.getInputField(),"compositionupdate",r.state.placeholderCompose),i(r),s=r.getWrapperElement(),s.className=s.className.replace(" CodeMirror-empty",""));f&&!r.hasFocus()&&u(r)})});
