var InternalBrowseDialog,BrowseType,InternalConditionalFormat,InternalDimensionFilter,InternalDragDropHelper,InternalDateSettingsInfo,InternalFormatDialog,InternalItemPanel,ExistingWidgetCategory,InternalColorPalette,InternalMeasureFilter,InternalTooltipCustomization,InternalReportAction,InternalUndoManager,InternalKPIWindow,InternalEditFieldSettings,InternalCreateCategoryDialog,InternalColorCustomizationAdvanceSettings,InternalColorCustomizationCustomDialog,InternalColorPicker,InternalColorCustomizationInclusionSelection,InternalColorCustomizationBasicSettings,InternalRefreshDialog,InternalReplaceValues,__extends,BoldBIDashboard,__spreadArray,InternalDynamicLanguageTranslator,InternalQueryExpression=(!function(){function o(e){var t;return(a[e]||(t=a[e]={i:e,l:!1,exports:{}},i[e].call(t.exports,t,t.exports,o),t.l=!0,t)).exports}a={},o.m=i=[,,function(e){function o(e){this.__parent=e,this.__character_count=0,this.__indent_count=-1,this.__alignment_count=0,this.__wrap_point_index=0,this.__wrap_point_character_count=0,this.__wrap_point_indent_count=-1,this.__wrap_point_alignment_count=0,this.__items=[]}function i(e,t){this.__cache=[""],this.__indent_size=e.indent_size,this.__indent_string=e.indent_char,e.indent_with_tabs||(this.__indent_string=new Array(e.indent_size+1).join(e.indent_char)),t=t||"",0<e.indent_level&&(t=new Array(e.indent_level+1).join(this.__indent_string)),this.__base_string=t,this.__base_string_length=t.length}function t(e,t){this.__indent_cache=new i(e,t),this.raw=!1,this._end_with_newline=e.end_with_newline,this.indent_size=e.indent_size,this.wrap_line_length=e.wrap_line_length,this.indent_empty_lines=e.indent_empty_lines,this.__lines=[],this.previous_line=null,this.current_line=null,this.next_line=new o(this),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1,this.__add_outputline()}o.prototype.clone_empty=function(){var e=new o(this.__parent);return e.set_indent(this.__indent_count,this.__alignment_count),e},o.prototype.item=function(e){return e<0?this.__items[this.__items.length+e]:this.__items[e]},o.prototype.has_match=function(e){for(var t=this.__items.length-1;0<=t;t--)if(this.__items[t].match(e))return!0;return!1},o.prototype.set_indent=function(e,t){this.is_empty()&&(this.__indent_count=e||0,this.__alignment_count=t||0,this.__character_count=this.__parent.get_indent_size(this.__indent_count,this.__alignment_count))},o.prototype._set_wrap_point=function(){this.__parent.wrap_line_length&&(this.__wrap_point_index=this.__items.length,this.__wrap_point_character_count=this.__character_count,this.__wrap_point_indent_count=this.__parent.next_line.__indent_count,this.__wrap_point_alignment_count=this.__parent.next_line.__alignment_count)},o.prototype._should_wrap=function(){return this.__wrap_point_index&&this.__character_count>this.__parent.wrap_line_length&&this.__wrap_point_character_count>this.__parent.next_line.__character_count},o.prototype._allow_wrap=function(){var e;return!!this._should_wrap()&&(this.__parent.add_new_line(),(e=this.__parent.current_line).set_indent(this.__wrap_point_indent_count,this.__wrap_point_alignment_count),e.__items=this.__items.slice(this.__wrap_point_index),this.__items=this.__items.slice(0,this.__wrap_point_index),e.__character_count+=this.__character_count-this.__wrap_point_character_count,this.__character_count=this.__wrap_point_character_count," "===e.__items[0]&&(e.__items.splice(0,1),--e.__character_count),!0)},o.prototype.is_empty=function(){return 0===this.__items.length},o.prototype.last=function(){return this.is_empty()?null:this.__items[this.__items.length-1]},o.prototype.push=function(e){this.__items.push(e);var t=e.lastIndexOf("\n");-1!==t?this.__character_count=e.length-t:this.__character_count+=e.length},o.prototype.pop=function(){var e=null;return this.is_empty()||(e=this.__items.pop(),this.__character_count-=e.length),e},o.prototype._remove_indent=function(){0<this.__indent_count&&(--this.__indent_count,this.__character_count-=this.__parent.indent_size)},o.prototype._remove_wrap_indent=function(){0<this.__wrap_point_indent_count&&--this.__wrap_point_indent_count},o.prototype.trim=function(){for(;" "===this.last();)this.__items.pop(),--this.__character_count},o.prototype.toString=function(){var e="";return this.is_empty()?this.__parent.indent_empty_lines&&(e=this.__parent.get_indent_string(this.__indent_count)):(e=this.__parent.get_indent_string(this.__indent_count,this.__alignment_count),e+=this.__items.join("")),e},i.prototype.get_indent_size=function(e,t){var i=this.__base_string_length;return e<0&&(i=0),(i+=e*this.__indent_size)+(t=t||0)},i.prototype.get_indent_string=function(e,t){var i=this.__base_string;return t=t||0,e<0&&(e=0,i=""),t+=e*this.__indent_size,this.__ensure_cache(t),i+this.__cache[t]},i.prototype.__ensure_cache=function(e){for(;e>=this.__cache.length;)this.__add_column()},i.prototype.__add_column=function(){var e,t=this.__cache.length,i="";this.__indent_size&&t>=this.__indent_size&&(t-=(e=Math.floor(t/this.__indent_size))*this.__indent_size,i=new Array(e+1).join(this.__indent_string)),t&&(i+=new Array(t+1).join(" ")),this.__cache.push(i)},t.prototype.__add_outputline=function(){this.previous_line=this.current_line,this.current_line=this.next_line.clone_empty(),this.__lines.push(this.current_line)},t.prototype.get_line_number=function(){return this.__lines.length},t.prototype.get_indent_string=function(e,t){return this.__indent_cache.get_indent_string(e,t)},t.prototype.get_indent_size=function(e,t){return this.__indent_cache.get_indent_size(e,t)},t.prototype.is_empty=function(){return!this.previous_line&&this.current_line.is_empty()},t.prototype.add_new_line=function(e){return!(this.is_empty()||!e&&this.just_added_newline()||(this.raw||this.__add_outputline(),0))},t.prototype.get_code=function(e){var t;return this.trim(!0),(t=this.current_line.pop())&&("\n"===t[t.length-1]&&(t=t.replace(/\n+$/g,"")),this.current_line.push(t)),this._end_with_newline&&this.__add_outputline(),t=this.__lines.join("\n"),t="\n"!==e?t.replace(/[\n]/g,e):t},t.prototype.set_wrap_point=function(){this.current_line._set_wrap_point()},t.prototype.set_indent=function(e,t){return this.next_line.set_indent(e=e||0,t=t||0),1<this.__lines.length?(this.current_line.set_indent(e,t),!0):(this.current_line.set_indent(),!1)},t.prototype.add_raw_token=function(e){for(var t=0;t<e.newlines;t++)this.__add_outputline();this.current_line.set_indent(-1),this.current_line.push(e.whitespace_before),this.current_line.push(e.text),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=!1},t.prototype.add_token=function(e){this.__add_space_before_token(),this.current_line.push(e),this.space_before_token=!1,this.non_breaking_space=!1,this.previous_token_wrapped=this.current_line._allow_wrap()},t.prototype.__add_space_before_token=function(){this.space_before_token&&!this.just_added_newline()&&(this.non_breaking_space||this.set_wrap_point(),this.current_line.push(" "))},t.prototype.remove_indent=function(e){for(var t=this.__lines.length;e<t;)this.__lines[e]._remove_indent(),e++;this.current_line._remove_wrap_indent()},t.prototype.trim=function(e){for(e=void 0!==e&&e,this.current_line.trim();e&&1<this.__lines.length&&this.current_line.is_empty();)this.__lines.pop(),this.current_line=this.__lines[this.__lines.length-1],this.current_line.trim();this.previous_line=1<this.__lines.length?this.__lines[this.__lines.length-2]:null},t.prototype.just_added_newline=function(){return this.current_line.is_empty()},t.prototype.just_added_blankline=function(){return this.is_empty()||this.current_line.is_empty()&&this.previous_line.is_empty()},t.prototype.ensure_empty_line_above=function(e,t){for(var i,a=this.__lines.length-2;0<=a&&!(i=this.__lines[a]).is_empty();){if(0!==i.item(0).indexOf(e)&&i.item(-1)!==t){this.__lines.splice(a+1,0,new o(this)),this.previous_line=this.__lines[this.__lines.length-2];break}a--}},e.exports.Output=t},function(e){e.exports.Token=function(e,t,i,a){this.type=e,this.text=t,this.comments_before=null,this.newlines=i||0,this.whitespace_before=a||"",this.parent=null,this.next=null,this.previous=null,this.opened=null,this.closed=null,this.directives=null}},,,function(e){function t(e,t){this.raw_options=i(e,t),this.disabled=this._get_boolean("disabled"),this.eol=this._get_characters("eol","auto"),this.end_with_newline=this._get_boolean("end_with_newline"),this.indent_size=this._get_number("indent_size",4),this.indent_char=this._get_characters("indent_char"," "),this.indent_level=this._get_number("indent_level"),this.preserve_newlines=this._get_boolean("preserve_newlines",!0),this.max_preserve_newlines=this._get_number("max_preserve_newlines",32786),this.preserve_newlines||(this.max_preserve_newlines=0),this.indent_with_tabs=this._get_boolean("indent_with_tabs","\t"===this.indent_char),this.indent_with_tabs&&(this.indent_char="\t",1===this.indent_size)&&(this.indent_size=4),this.wrap_line_length=this._get_number("wrap_line_length",this._get_number("max_char")),this.indent_empty_lines=this._get_boolean("indent_empty_lines"),this.templating=this._get_selection_list("templating",["auto","none","django","erb","handlebars","php"],["auto"])}function i(e,t){var i,a={};for(i in e=o(e))i!==t&&(a[i]=e[i]);if(t&&e[t])for(i in e[t])a[i]=e[t][i];return a}function o(e){var t,i={};for(t in e)i[t.replace(/-/g,"_")]=e[t];return i}t.prototype._get_array=function(e,t){e=this.raw_options[e],t=t||[];return"object"==typeof e?null!==e&&"function"==typeof e.concat&&(t=e.concat()):"string"==typeof e&&(t=e.split(/[^a-zA-Z0-9_\/\-]+/)),t},t.prototype._get_boolean=function(e,t){e=this.raw_options[e];return void 0===e?!!t:!!e},t.prototype._get_characters=function(e,t){e=this.raw_options[e],t=t||"";return t="string"==typeof e?e.replace(/\\r/,"\r").replace(/\\n/,"\n").replace(/\\t/,"\t"):t},t.prototype._get_number=function(e,t){var e=this.raw_options[e];return t=parseInt(t,10),isNaN(t)&&(t=0),e=parseInt(e,10),e=isNaN(e)?t:e},t.prototype._get_selection=function(e,t,i){i=this._get_selection_list(e,t,i);if(1!==i.length)throw new Error("Invalid Option Value: The option '"+e+"' can only be one of the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'");return i[0]},t.prototype._get_selection_list=function(e,t,i){if(!t||0===t.length)throw new Error("Selection list cannot be empty.");if(i=i||[t[0]],!this._is_valid_selection(i,t))throw new Error("Invalid Default Value!");i=this._get_array(e,i);if(this._is_valid_selection(i,t))return i;throw new Error("Invalid Option Value: The option '"+e+"' can contain only the following values:\n"+t+"\nYou passed in: '"+this.raw_options[e]+"'")},t.prototype._is_valid_selection=function(e,t){return e.length&&t.length&&!e.some(function(e){return-1===t.indexOf(e)})},e.exports.Options=t,e.exports.normalizeOpts=o,e.exports.mergeOpts=i},,function(e){function t(e){this.__input=e||"",this.__input_length=this.__input.length,this.__position=0}var a=RegExp.prototype.hasOwnProperty("sticky");t.prototype.restart=function(){this.__position=0},t.prototype.back=function(){0<this.__position&&--this.__position},t.prototype.hasNext=function(){return this.__position<this.__input_length},t.prototype.next=function(){var e=null;return this.hasNext()&&(e=this.__input.charAt(this.__position),this.__position+=1),e},t.prototype.peek=function(e){var t=null;return e=e||0,t=0<=(e+=this.__position)&&e<this.__input_length?this.__input.charAt(e):t},t.prototype.__match=function(e,t){e.lastIndex=t;var i=e.exec(this.__input);return!i||a&&e.sticky||i.index!==t&&(i=null),i},t.prototype.test=function(e,t){return t=t||0,0<=(t+=this.__position)&&t<this.__input_length&&!!this.__match(e,t)},t.prototype.testChar=function(e,t){t=this.peek(t);return e.lastIndex=0,null!==t&&e.test(t)},t.prototype.match=function(e){e=this.__match(e,this.__position);return e?this.__position+=e[0].length:e=null,e},t.prototype.read=function(e,t,i){var a,o="";return e&&(a=this.match(e))&&(o+=a[0]),!t||!a&&e||(o+=this.readUntil(t,i)),o},t.prototype.readUntil=function(e,t){var i=this.__position;return e.lastIndex=this.__position,(e=e.exec(this.__input))?(i=e.index,t&&(i+=e[0].length)):i=this.__input_length,t=this.__input.substring(this.__position,i),this.__position=i,t},t.prototype.readUntilAfter=function(e){return this.readUntil(e,!0)},t.prototype.get_regexp=function(e,t){var i=null,t=t&&a?"y":"g";return"string"==typeof e&&""!==e?i=new RegExp(e,t):e&&(i=new RegExp(e.source,t)),i},t.prototype.get_literal_regexp=function(e){return RegExp(e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&"))},t.prototype.peekUntilAfter=function(e){var t=this.__position,e=this.readUntilAfter(e);return this.__position=t,e},t.prototype.lookBack=function(e){var t=this.__position-1;return t>=e.length&&this.__input.substring(t-e.length,t).toLowerCase()===e},e.exports.InputScanner=t},function(e,t,i){function a(e,t){this._input=new o(e),this._options=t||{},this.__tokens=null,this._patterns={},this._patterns.whitespace=new r(this._input)}var o=i(8).InputScanner,s=i(3).Token,n=i(10).TokenStream,r=i(11).WhitespacePattern,d={START:"TK_START",RAW:"TK_RAW",EOF:"TK_EOF"};a.prototype.tokenize=function(){var e;this._input.restart(),this.__tokens=new n,this._reset();for(var t=new s(d.START,""),i=null,a=[],o=new n;t.type!==d.EOF;){for(e=this._get_next_token(t,i);this._is_comment(e);)o.add(e),e=this._get_next_token(t,i);o.isEmpty()||(e.comments_before=o,o=new n),e.parent=i,this._is_opening(e)?(a.push(i),i=e):i&&this._is_closing(e,i)&&((e.opened=i).closed=e,i=a.pop(),e.parent=i),(e.previous=t).next=e,this.__tokens.add(e),t=e}return this.__tokens},a.prototype._is_first_token=function(){return this.__tokens.isEmpty()},a.prototype._reset=function(){},a.prototype._get_next_token=function(){this._readWhitespace();var e=this._input.read(/.+/g);return e?this._create_token(d.RAW,e):this._create_token(d.EOF,"")},a.prototype._is_comment=function(){return!1},a.prototype._is_opening=function(){return!1},a.prototype._is_closing=function(){return!1},a.prototype._create_token=function(e,t){return new s(e,t,this._patterns.whitespace.newline_count,this._patterns.whitespace.whitespace_before_token)},a.prototype._readWhitespace=function(){return this._patterns.whitespace.read()},e.exports.Tokenizer=a,e.exports.TOKEN=d},function(e){function t(e){this.__tokens=[],this.__tokens_length=this.__tokens.length,this.__position=0,this.__parent_token=e}t.prototype.restart=function(){this.__position=0},t.prototype.isEmpty=function(){return 0===this.__tokens_length},t.prototype.hasNext=function(){return this.__position<this.__tokens_length},t.prototype.next=function(){var e=null;return this.hasNext()&&(e=this.__tokens[this.__position],this.__position+=1),e},t.prototype.peek=function(e){var t=null;return e=e||0,t=0<=(e+=this.__position)&&e<this.__tokens_length?this.__tokens[e]:t},t.prototype.add=function(e){this.__parent_token&&(e.parent=this.__parent_token),this.__tokens.push(e),this.__tokens_length+=1},e.exports.TokenStream=t},function(e,t,i){function a(e,t){o.call(this,e,t),t?this._line_regexp=this._input.get_regexp(t._line_regexp):this.__set_whitespace_patterns("",""),this.newline_count=0,this.whitespace_before_token=""}var o=i(12).Pattern;(a.prototype=new o).__set_whitespace_patterns=function(e,t){this._match_pattern=this._input.get_regexp("["+(e+="\\t ")+(t+="\\n\\r")+"]+",!0),this._newline_regexp=this._input.get_regexp("\\r\\n|["+t+"]")},a.prototype.read=function(){var e,t;return this.newline_count=0,this.whitespace_before_token=""," "===(e=this._input.read(this._match_pattern))?this.whitespace_before_token=" ":e&&(t=this.__split(this._newline_regexp,e),this.newline_count=t.length-1,this.whitespace_before_token=t[this.newline_count]),e},a.prototype.matching=function(e,t){var i=this._create();return i.__set_whitespace_patterns(e,t),i._update(),i},a.prototype._create=function(){return new a(this._input,this)},a.prototype.__split=function(e,t){for(var i=e.lastIndex=0,a=[],o=e.exec(t);o;)a.push(t.substring(i,o.index)),i=o.index+o[0].length,o=e.exec(t);return i<t.length?a.push(t.substring(i,t.length)):a.push(""),a},e.exports.WhitespacePattern=a},function(e){function t(e,t){this._input=e,this._starting_pattern=null,this._match_pattern=null,this._until_pattern=null,this._until_after=!1,t&&(this._starting_pattern=this._input.get_regexp(t._starting_pattern,!0),this._match_pattern=this._input.get_regexp(t._match_pattern,!0),this._until_pattern=this._input.get_regexp(t._until_pattern),this._until_after=t._until_after)}t.prototype.read=function(){var e=this._input.read(this._starting_pattern);return this._starting_pattern&&!e||(e+=this._input.read(this._match_pattern,this._until_pattern,this._until_after)),e},t.prototype.read_match=function(){return this._input.match(this._match_pattern)},t.prototype.until_after=function(e){var t=this._create();return t._until_after=!0,t._until_pattern=this._input.get_regexp(e),t._update(),t},t.prototype.until=function(e){var t=this._create();return t._until_after=!1,t._until_pattern=this._input.get_regexp(e),t._update(),t},t.prototype.starting_with=function(e){var t=this._create();return t._starting_pattern=this._input.get_regexp(e,!0),t._update(),t},t.prototype.matching=function(e){var t=this._create();return t._match_pattern=this._input.get_regexp(e,!0),t._update(),t},t.prototype._create=function(){return new t(this._input,this)},t.prototype._update=function(){},e.exports.Pattern=t},function(e){function t(e,t){e="string"==typeof e?e:e.source,t="string"==typeof t?t:t.source,this.__directives_block_pattern=new RegExp(e+/ beautify( \w+[:]\w+)+ /.source+t,"g"),this.__directive_pattern=/ (\w+)[:](\w+)/g,this.__directives_end_ignore_pattern=new RegExp(e+/\sbeautify\signore:end\s/.source+t,"g")}t.prototype.get_directives=function(e){var t,i;if(!e.match(this.__directives_block_pattern))return null;for(t={},this.__directive_pattern.lastIndex=0,i=this.__directive_pattern.exec(e);i;)t[i[1]]=i[2],i=this.__directive_pattern.exec(e);return t},t.prototype.readIgnored=function(e){return e.readUntilAfter(this.__directives_end_ignore_pattern)},e.exports.Directives=t},function(e,t,i){function a(e,t){o.call(this,e,t),this.__template_pattern=null,this._disabled=Object.assign({},s),this._excluded=Object.assign({},s),t&&(this.__template_pattern=this._input.get_regexp(t.__template_pattern),this._excluded=Object.assign(this._excluded,t._excluded),this._disabled=Object.assign(this._disabled,t._disabled));t=new o(e);this.__patterns={handlebars_comment:t.starting_with(/{{!--/).until_after(/--}}/),handlebars_unescaped:t.starting_with(/{{{/).until_after(/}}}/),handlebars:t.starting_with(/{{/).until_after(/}}/),php:t.starting_with(/<\?(?:[=]|php)/).until_after(/\?>/),erb:t.starting_with(/<%[^%]/).until_after(/[^%]%>/),django:t.starting_with(/{%/).until_after(/%}/),django_value:t.starting_with(/{{/).until_after(/}}/),django_comment:t.starting_with(/{#/).until_after(/#}/)}}var o=i(12).Pattern,s={django:!1,erb:!1,handlebars:!1,php:!1};(a.prototype=new o)._create=function(){return new a(this._input,this)},a.prototype._update=function(){this.__set_templated_pattern()},a.prototype.disable=function(e){var t=this._create();return t._disabled[e]=!0,t._update(),t},a.prototype.read_options=function(e){var t,i=this._create();for(t in s)i._disabled[t]=-1===e.templating.indexOf(t);return i._update(),i},a.prototype.exclude=function(e){var t=this._create();return t._excluded[e]=!0,t._update(),t},a.prototype.read=function(){for(var e="",e=this._match_pattern?this._input.read(this._starting_pattern):this._input.read(this._starting_pattern,this.__template_pattern),t=this._read_template();t;)e+=t+=this._match_pattern?this._input.read(this._match_pattern):this._input.readUntil(this.__template_pattern),t=this._read_template();return this._until_after&&(e+=this._input.readUntilAfter(this._until_pattern)),e},a.prototype.__set_templated_pattern=function(){var e=[];this._disabled.php||e.push(this.__patterns.php._starting_pattern.source),this._disabled.handlebars||e.push(this.__patterns.handlebars._starting_pattern.source),this._disabled.erb||e.push(this.__patterns.erb._starting_pattern.source),this._disabled.django||(e.push(this.__patterns.django._starting_pattern.source),e.push(this.__patterns.django_value._starting_pattern.source),e.push(this.__patterns.django_comment._starting_pattern.source)),this._until_pattern&&e.push(this._until_pattern.source),this.__template_pattern=this._input.get_regexp("(?:"+e.join("|")+")")},a.prototype._read_template=function(){var e,t="",i=this._input.peek();return"<"===i?(e=this._input.peek(1),this._disabled.php||this._excluded.php||"?"!==e||(t=t||this.__patterns.php.read()),this._disabled.erb||this._excluded.erb||"%"!==e||(t=t||this.__patterns.erb.read())):"{"===i&&(this._disabled.handlebars||this._excluded.handlebars||(t=(t=(t=t||this.__patterns.handlebars_comment.read())||this.__patterns.handlebars_unescaped.read())||this.__patterns.handlebars.read()),this._disabled.django||(this._excluded.django||this._excluded.handlebars||(t=t||this.__patterns.django_value.read()),this._excluded.django)||(t=(t=t||this.__patterns.django_comment.read())||this.__patterns.django.read())),t},e.exports.TemplatablePattern=a},,,,function(e,t,i){var o=i(19).Beautifier,a=i(20).Options;e.exports=function(e,t,i,a){return new o(e,t,i,a).beautify()},e.exports.defaultOptions=function(){return new a}},function(e,t,i){function l(e,t){this.indent_level=0,this.alignment_size=0,this.max_preserve_newlines=e.max_preserve_newlines,this.preserve_newlines=e.preserve_newlines,this._output=new s(e,t)}function d(e,t){return-1!==t.indexOf(e)}function a(e,t,i){this.parent=e||null,this.tag=t?t.tag_name:"",this.indent_level=i||0,this.parser_token=t||null}function h(e){this._printer=e,this._current_frame=null}function p(e,t,i,a){this._source_text=e||"",t=t||{},this._js_beautify=i,this._css_beautify=a,this._tag_stack=null;e=new o(t,"html");this._options=e,this._is_wrap_attributes_force="force"===this._options.wrap_attributes.substr(0,5),this._is_wrap_attributes_force_expand_multiline="force-expand-multiline"===this._options.wrap_attributes,this._is_wrap_attributes_force_aligned="force-aligned"===this._options.wrap_attributes,this._is_wrap_attributes_aligned_multiple="aligned-multiple"===this._options.wrap_attributes,this._is_wrap_attributes_preserve="preserve"===this._options.wrap_attributes.substr(0,8),this._is_wrap_attributes_preserve_aligned="preserve-aligned"===this._options.wrap_attributes}var c,o=i(20).Options,s=i(2).Output,u=i(21).Tokenizer,b=i(21).TOKEN,g=/\r\n|[\r\n]/,m=/\r\n|[\r\n]/g;l.prototype.current_line_has_match=function(e){return this._output.current_line.has_match(e)},l.prototype.set_space_before_token=function(e,t){this._output.space_before_token=e,this._output.non_breaking_space=t},l.prototype.set_wrap_point=function(){this._output.set_indent(this.indent_level,this.alignment_size),this._output.set_wrap_point()},l.prototype.add_raw_token=function(e){this._output.add_raw_token(e)},l.prototype.print_preserved_newlines=function(e){var t,i=0;for(e.type!==b.TEXT&&e.previous.type!==b.TEXT&&(i=e.newlines?1:0),this.preserve_newlines&&(i=e.newlines<this.max_preserve_newlines+1?e.newlines:this.max_preserve_newlines+1),t=0;t<i;t++)this.print_newline(0<t);return 0!==i},l.prototype.traverse_whitespace=function(e){return!(!e.whitespace_before&&!e.newlines||(this.print_preserved_newlines(e)||(this._output.space_before_token=!0),0))},l.prototype.previous_token_wrapped=function(){return this._output.previous_token_wrapped},l.prototype.print_newline=function(e){this._output.add_new_line(e)},l.prototype.print_token=function(e){e.text&&(this._output.set_indent(this.indent_level,this.alignment_size),this._output.add_token(e.text))},l.prototype.indent=function(){this.indent_level++},l.prototype.get_full_indent=function(e){return(e=this.indent_level+(e||0))<1?"":this._output.get_indent_string(e)},h.prototype.get_parser_token=function(){return this._current_frame?this._current_frame.parser_token:null},h.prototype.record_tag=function(e){e=new a(this._current_frame,e,this._printer.indent_level);this._current_frame=e},h.prototype._try_pop_frame=function(e){var t=null;return e&&(t=e.parser_token,this._printer.indent_level=e.indent_level,this._current_frame=e.parent),t},h.prototype._get_frame=function(e,t){for(var i=this._current_frame;i&&-1===e.indexOf(i.tag);){if(t&&-1!==t.indexOf(i.tag)){i=null;break}i=i.parent}return i},h.prototype.try_pop=function(e,t){e=this._get_frame([e],t);return this._try_pop_frame(e)},h.prototype.indent_to_tag=function(e){e=this._get_frame(e);e&&(this._printer.indent_level=e.indent_level)},p.prototype.beautify=function(){var e,t,i,a;if(this._options.disabled)return this._source_text;e=this._source_text,t=this._options.eol,"auto"===this._options.eol&&(t="\n",e)&&g.test(e)&&(t=e.match(g)[0]);var o=(e=e.replace(m,"\n")).match(/^[\t ]*/)[0],s={text:"",type:""},n=new c,r=new l(this._options,o),d=new u(e,this._options).tokenize();for(this._tag_stack=new h(r),i=null,a=d.next();a.type!==b.EOF;)a.type===b.TAG_OPEN||a.type===b.COMMENT?n=i=this._handle_tag_open(r,a,n,s):a.type===b.ATTRIBUTE||a.type===b.EQUALS||a.type===b.VALUE||a.type===b.TEXT&&!n.tag_complete?i=this._handle_inside_tag(r,a,n,d):a.type===b.TAG_CLOSE?i=this._handle_tag_close(r,a,n):a.type===b.TEXT?i=this._handle_text(r,a,n):r.add_raw_token(a),s=i,a=d.next();return r._output.get_code(t)},p.prototype._handle_tag_close=function(e,t,i){var a={text:t.text,type:t.type};return e.alignment_size=0,i.tag_complete=!0,e.set_space_before_token(t.newlines||""!==t.whitespace_before,!0),i.is_unformatted?e.add_raw_token(t):("<"===i.tag_start_char&&(e.set_space_before_token("/"===t.text[0],!0),this._is_wrap_attributes_force_expand_multiline)&&i.has_wrapped_attrs&&e.print_newline(!1),e.print_token(t)),!i.indent_content||i.is_unformatted||i.is_content_unformatted||(e.indent(),i.indent_content=!1),i.is_inline_element||i.is_unformatted||i.is_content_unformatted||e.set_wrap_point(),a},p.prototype._handle_inside_tag=function(e,t,i,a){var o,s,n,r,d=i.has_wrapped_attrs,l={text:t.text,type:t.type};if(e.set_space_before_token(t.newlines||""!==t.whitespace_before,!0),i.is_unformatted)e.add_raw_token(t);else if("{"===i.tag_start_char&&t.type===b.TEXT)e.print_preserved_newlines(t)?(t.newlines=0,e.add_raw_token(t)):e.print_token(t);else{if(t.type===b.ATTRIBUTE?(e.set_space_before_token(!0),i.attr_count+=1):(t.type===b.EQUALS||t.type===b.VALUE&&t.previous.type===b.EQUALS)&&e.set_space_before_token(!1),t.type===b.ATTRIBUTE&&"<"===i.tag_start_char&&((this._is_wrap_attributes_preserve||this._is_wrap_attributes_preserve_aligned)&&(e.traverse_whitespace(t),d=d||0!==t.newlines),this._is_wrap_attributes_force)){if(o=1<i.attr_count,this._is_wrap_attributes_force_expand_multiline&&1===i.attr_count){n=!0,r=0;do{if((s=a.peek(r)).type===b.ATTRIBUTE){n=!1;break}}while((r+=1)<4&&s.type!==b.EOF&&s.type!==b.TAG_CLOSE);o=!n}o&&(e.print_newline(!1),d=!0)}e.print_token(t),d=d||e.previous_token_wrapped(),i.has_wrapped_attrs=d}return l},p.prototype._handle_text=function(e,t,i){var a={text:t.text,type:"TK_CONTENT"};return i.custom_beautifier_name?this._print_custom_beatifier_text(e,t,i):i.is_unformatted||i.is_content_unformatted?e.add_raw_token(t):(e.traverse_whitespace(t),e.print_token(t)),a},p.prototype._print_custom_beatifier_text=function(e,t,i){var a=this;if(""!==t.text){var o,s=t.text,n=1,r="",d="";if("javascript"===i.custom_beautifier_name&&"function"==typeof this._js_beautify?o=this._js_beautify:"css"===i.custom_beautifier_name&&"function"==typeof this._css_beautify?o=this._css_beautify:"html"===i.custom_beautifier_name&&(o=function(e,t){return new p(e,t,a._js_beautify,a._css_beautify).beautify()}),"keep"===this._options.indent_scripts?n=0:"separate"===this._options.indent_scripts&&(n=-e.indent_level),n=e.get_full_indent(n),s=s.replace(/\n[ \t]*$/,""),"html"!==i.custom_beautifier_name&&"<"===s[0]&&s.match(/^(<!--|<!\[CDATA\[)/)){if(!(i=/^(<!--[^\n]*|<!\[CDATA\[)(\n?)([ \t\n]*)([\s\S]*)(-->|]]>)$/.exec(s)))return void e.add_raw_token(t);r=n+i[1]+"\n",s=i[4],i[5]&&(d=n+i[5]),s=s.replace(/\n[ \t]*$/,""),(i[2]||-1!==i[3].indexOf("\n"))&&(i=i[3].match(/[ \t]+$/))&&(t.whitespace_before=i[0])}s=s&&(o?((i=function(){this.eol="\n"}).prototype=this._options.raw_options,o(n+s,new i)):n+(s=(o=t.whitespace_before)?s.replace(new RegExp("\n("+o+")?","g"),"\n"):s).replace(/\n/g,"\n"+n)),r&&(s=s?r+s+"\n"+d:r+d),e.print_newline(!1),s&&(t.text=s,t.whitespace_before="",t.newlines=0,e.add_raw_token(t),e.print_newline(!0))}},p.prototype._handle_tag_open=function(e,t,i,a){var o=this._get_tag_open_token(t);return(i.is_unformatted||i.is_content_unformatted)&&t.type===b.TAG_OPEN&&0===t.text.indexOf("</")?e.add_raw_token(t):(e.traverse_whitespace(t),this._set_tag_position(e,t,o,i,a),o.is_inline_element||e.set_wrap_point(),e.print_token(t)),(this._is_wrap_attributes_force_aligned||this._is_wrap_attributes_aligned_multiple||this._is_wrap_attributes_preserve_aligned)&&(o.alignment_size=t.text.length+1),o.tag_complete||o.is_unformatted||(e.alignment_size=o.alignment_size),o},c=function(e,t){this.parent=e||null,this.text="",this.type="TK_TAG_OPEN",this.tag_name="",this.is_inline_element=!1,this.is_unformatted=!1,this.is_content_unformatted=!1,this.is_empty_element=!1,this.is_start_tag=!1,this.is_end_tag=!1,this.indent_content=!1,this.multiline_content=!1,this.custom_beautifier_name=null,this.start_tag_token=null,this.attr_count=0,this.has_wrapped_attrs=!1,this.alignment_size=0,this.tag_complete=!1,this.tag_start_char="",this.tag_check="",t?(this.tag_start_char=t.text[0],this.text=t.text,e="<"===this.tag_start_char?t.text.match(/^<([^\s>]*)/):t.text.match(/^{{[#\^]?([^\s}]+)/),this.tag_check=e?e[1]:"",this.tag_check=this.tag_check.toLowerCase(),t.type===b.COMMENT&&(this.tag_complete=!0),this.is_start_tag="/"!==this.tag_check.charAt(0),this.tag_name=this.is_start_tag?this.tag_check:this.tag_check.substr(1),this.is_end_tag=!this.is_start_tag||t.closed&&"/>"===t.closed.text,this.is_end_tag=this.is_end_tag||"{"===this.tag_start_char&&(this.text.length<3||/[^#\^]/.test(this.text.charAt(2)))):this.tag_complete=!0},p.prototype._get_tag_open_token=function(e){e=new c(this._tag_stack.get_parser_token(),e);return e.alignment_size=this._options.wrap_attributes_indent_size,e.is_end_tag=e.is_end_tag||d(e.tag_check,this._options.void_elements),e.is_empty_element=e.tag_complete||e.is_start_tag&&e.is_end_tag,e.is_unformatted=!e.tag_complete&&d(e.tag_check,this._options.unformatted),e.is_content_unformatted=!e.is_empty_element&&d(e.tag_check,this._options.content_unformatted),e.is_inline_element=d(e.tag_name,this._options.inline)||"{"===e.tag_start_char,e},p.prototype._set_tag_position=function(e,t,i,a,o){var s,n,r;i.is_empty_element||(i.is_end_tag?i.start_tag_token=this._tag_stack.try_pop(i.tag_name):(this._do_optional_end_element(i)&&!i.is_inline_element&&(i.parent&&(i.parent.multiline_content=!0),e.print_newline(!1)),this._tag_stack.record_tag(i),"script"!==i.tag_name&&"style"!==i.tag_name||i.is_unformatted||i.is_content_unformatted||(i.custom_beautifier_name=(s=i.tag_check,r=n=null,(t=t).closed?("script"===s?n="text/javascript":"style"===s&&(n="text/css"),-1<(n=function(e){for(var t=null,i=e.next;i.type!==b.EOF&&e.closed!==i;){if(i.type===b.ATTRIBUTE&&"type"===i.text){i.next&&i.next.type===b.EQUALS&&i.next.next&&i.next.next.type===b.VALUE&&(t=i.next.next.text);break}i=i.next}return t}(t)||n).search("text/css")?r="css":-1<n.search(/(text|application|dojo)\/(x-)?(javascript|ecmascript|jscript|livescript|(ld\+)?json|method|aspect)/)?r="javascript":-1<n.search(/(text|application|dojo)\/(x-)?(html)/)?r="html":-1<n.search(/test\/null/)&&(r="null"),r):null)))),d(i.tag_check,this._options.extra_liners)&&(e.print_newline(!1),e._output.just_added_blankline()||e.print_newline(!0)),i.is_empty_element?("{"===i.tag_start_char&&"else"===i.tag_check&&(this._tag_stack.indent_to_tag(["if","unless","each"]),i.indent_content=!0,e.current_line_has_match(/{{#if/)||e.print_newline(!1)),"!--"===i.tag_name&&o.type===b.TAG_CLOSE&&a.is_end_tag&&-1===i.text.indexOf("\n")||i.is_inline_element||i.is_unformatted||e.print_newline(!1)):i.is_unformatted||i.is_content_unformatted?i.is_inline_element||i.is_unformatted||e.print_newline(!1):i.is_end_tag?(i.start_tag_token&&i.start_tag_token.multiline_content||!(i.is_inline_element||a.is_inline_element||o.type===b.TAG_CLOSE&&i.start_tag_token===a||"TK_CONTENT"===o.type))&&e.print_newline(!1):(i.indent_content=!i.custom_beautifier_name,"<"===i.tag_start_char&&("html"===i.tag_name?i.indent_content=this._options.indent_inner_html:"head"===i.tag_name?i.indent_content=this._options.indent_head_inner_html:"body"===i.tag_name&&(i.indent_content=this._options.indent_body_inner_html)),i.is_inline_element||"TK_CONTENT"===o.type||(i.parent&&(i.parent.multiline_content=!0),e.print_newline(!1)))},p.prototype._do_optional_end_element=function(e){var t=null;if(!e.is_empty_element&&e.is_start_tag&&e.parent)return"body"===e.tag_name?t=t||this._tag_stack.try_pop("head"):"li"===e.tag_name?t=t||this._tag_stack.try_pop("li",["ol","ul"]):"dd"===e.tag_name||"dt"===e.tag_name?t=(t=t||this._tag_stack.try_pop("dt",["dl"]))||this._tag_stack.try_pop("dd",["dl"]):"rp"===e.tag_name||"rt"===e.tag_name?t=(t=t||this._tag_stack.try_pop("rt",["ruby","rtc"]))||this._tag_stack.try_pop("rp",["ruby","rtc"]):"optgroup"===e.tag_name?t=t||this._tag_stack.try_pop("optgroup",["select"]):"option"===e.tag_name?t=t||this._tag_stack.try_pop("option",["select","datalist","optgroup"]):"colgroup"===e.tag_name?t=t||this._tag_stack.try_pop("caption",["table"]):"thead"===e.tag_name?t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]):"tbody"===e.tag_name||"tfoot"===e.tag_name?t=(t=(t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("thead",["table"]))||this._tag_stack.try_pop("tbody",["table"]):"tr"===e.tag_name?t=(t=(t=t||this._tag_stack.try_pop("caption",["table"]))||this._tag_stack.try_pop("colgroup",["table"]))||this._tag_stack.try_pop("tr",["table","thead","tbody","tfoot"]):"th"!==e.tag_name&&"td"!==e.tag_name||(t=(t=t||this._tag_stack.try_pop("td",["table","thead","tbody","tfoot","tr"]))||this._tag_stack.try_pop("th",["table","thead","tbody","tfoot","tr"])),e.parent=this._tag_stack.get_parser_token(),t},e.exports.Beautifier=p},function(e,t,i){function a(e){o.call(this,e,"html"),1===this.templating.length&&"auto"===this.templating[0]&&(this.templating=["django","erb","handlebars","php"]),this.indent_inner_html=this._get_boolean("indent_inner_html"),this.indent_body_inner_html=this._get_boolean("indent_body_inner_html",!0),this.indent_head_inner_html=this._get_boolean("indent_head_inner_html",!0),this.indent_handlebars=this._get_boolean("indent_handlebars",!0),this.wrap_attributes=this._get_selection("wrap_attributes",["auto","force","force-aligned","force-expand-multiline","aligned-multiple","preserve","preserve-aligned"]),this.wrap_attributes_indent_size=this._get_number("wrap_attributes_indent_size",this.indent_size),this.extra_liners=this._get_array("extra_liners",["head","body","/html"]),this.inline=this._get_array("inline",["a","abbr","area","audio","b","bdi","bdo","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","i","iframe","img","input","ins","kbd","keygen","label","map","mark","math","meter","noscript","object","output","progress","q","ruby","s","samp","select","small","span","strong","sub","sup","svg","template","textarea","time","u","var","video","wbr","text","acronym","big","strike","tt"]),this.void_elements=this._get_array("void_elements",["area","base","br","col","embed","hr","img","input","keygen","link","menuitem","meta","param","source","track","wbr","!doctype","?xml","basefont","isindex"]),this.unformatted=this._get_array("unformatted",[]),this.content_unformatted=this._get_array("content_unformatted",["pre","textarea"]),this.unformatted_content_delimiter=this._get_characters("unformatted_content_delimiter"),this.indent_scripts=this._get_selection("indent_scripts",["normal","keep","separate"])}var o=i(6).Options;a.prototype=new o,e.exports.Options=a},function(e,t,i){function a(e,t){o.call(this,e,t),this._current_tag_name="",e=new r(this._input).read_options(this._options),t=new d(this._input),this.__patterns={word:e.until(/[\n\r\t <]/),single_quote:e.until_after(/'/),double_quote:e.until_after(/"/),attribute:e.until(/[\n\r\t =>]|\/>/),element_name:e.until(/[\n\r\t >\/]/),handlebars_comment:t.starting_with(/{{!--/).until_after(/--}}/),handlebars:t.starting_with(/{{/).until_after(/}}/),handlebars_open:t.until(/[\n\r\t }]/),handlebars_raw_close:t.until(/}}/),comment:t.starting_with(/<!--/).until_after(/-->/),cdata:t.starting_with(/<!\[CDATA\[/).until_after(/]]>/),conditional_comment:t.starting_with(/<!\[/).until_after(/]>/),processing:t.starting_with(/<\?/).until_after(/\?>/)},this._options.indent_handlebars&&(this.__patterns.word=this.__patterns.word.exclude("handlebars")),this._unformatted_content_delimiter=null,this._options.unformatted_content_delimiter&&(e=this._input.get_literal_regexp(this._options.unformatted_content_delimiter),this.__patterns.unformatted_content_delimiter=t.matching(e).until_after(e))}var o=i(9).Tokenizer,s=i(9).TOKEN,n=i(13).Directives,r=i(14).TemplatablePattern,d=i(12).Pattern,l={TAG_OPEN:"TK_TAG_OPEN",TAG_CLOSE:"TK_TAG_CLOSE",ATTRIBUTE:"TK_ATTRIBUTE",EQUALS:"TK_EQUALS",VALUE:"TK_VALUE",COMMENT:"TK_COMMENT",TEXT:"TK_TEXT",UNKNOWN:"TK_UNKNOWN",START:s.START,RAW:s.RAW,EOF:s.EOF},h=new n(/<\!--/,/-->/);(a.prototype=new o)._is_comment=function(){return!1},a.prototype._is_opening=function(e){return e.type===l.TAG_OPEN},a.prototype._is_closing=function(e,t){return e.type===l.TAG_CLOSE&&t&&((">"===e.text||"/>"===e.text)&&"<"===t.text[0]||"}}"===e.text&&"{"===t.text[0]&&"{"===t.text[1])},a.prototype._reset=function(){this._current_tag_name=""},a.prototype._get_next_token=function(e,t){var i;return this._readWhitespace(),null===(i=this._input.peek())?this._create_token(l.EOF,""):this._read_open_handlebars(i,t)||this._read_attribute(i,e,t)||this._read_raw_content(i,e,t)||this._read_close(i,t)||this._read_content_word(i)||this._read_comment_or_cdata(i)||this._read_processing(i)||this._read_open(i,t)||this._create_token(l.UNKNOWN,this._input.next())},a.prototype._read_comment_or_cdata=function(e){var t=null,i=null,a=null;return"<"===e&&("!"===this._input.peek(1)&&((i=this.__patterns.comment.read())?(a=h.get_directives(i))&&"start"===a.ignore&&(i+=h.readIgnored(this._input)):i=this.__patterns.cdata.read()),i)&&((t=this._create_token(l.COMMENT,i)).directives=a),t},a.prototype._read_processing=function(e){var t=null,i=null;return"<"===e&&(i="!"!==(e=this._input.peek(1))&&"?"!==e?i:(i=this.__patterns.conditional_comment.read())||this.__patterns.processing.read())&&((t=this._create_token(l.COMMENT,i)).directives=null),t},a.prototype._read_open=function(e,t){var i=null,a=null;return t||"<"===e&&(i=this._input.next(),"/"===this._input.peek()&&(i+=this._input.next()),i+=this.__patterns.element_name.read(),a=this._create_token(l.TAG_OPEN,i)),a},a.prototype._read_open_handlebars=function(e,t){var i=null,a=null;return t||this._options.indent_handlebars&&"{"===e&&"{"===this._input.peek(1)&&(a="!"===this._input.peek(2)?(i=(i=this.__patterns.handlebars_comment.read())||this.__patterns.handlebars.read(),this._create_token(l.COMMENT,i)):(i=this.__patterns.handlebars_open.read(),this._create_token(l.TAG_OPEN,i))),a},a.prototype._read_close=function(e,t){var i=null,a=null;return t&&("<"===t.text[0]&&(">"===e||"/"===e&&">"===this._input.peek(1))?(i=this._input.next(),"/"===e&&(i+=this._input.next()),a=this._create_token(l.TAG_CLOSE,i)):"{"===t.text[0]&&"}"===e&&"}"===this._input.peek(1)&&(this._input.next(),this._input.next(),a=this._create_token(l.TAG_CLOSE,"}}"))),a},a.prototype._read_attribute=function(e,t,i){var a=null;return i&&"<"===i.text[0]&&("="===e?a=this._create_token(l.EQUALS,this._input.next()):'"'===e||"'"===e?(i=this._input.next(),i+=('"'===e?this.__patterns.double_quote:this.__patterns.single_quote).read(),a=this._create_token(l.VALUE,i)):(e=this.__patterns.attribute.read())&&(a=t.type===l.EQUALS?this._create_token(l.VALUE,e):this._create_token(l.ATTRIBUTE,e))),a},a.prototype._is_content_unformatted=function(e){return-1===this._options.void_elements.indexOf(e)&&(-1!==this._options.content_unformatted.indexOf(e)||-1!==this._options.unformatted.indexOf(e))},a.prototype._read_raw_content=function(e,t,i){var a="";if(i&&"{"===i.text[0])a=this.__patterns.handlebars_raw_close.read();else if(t.type===l.TAG_CLOSE&&"<"===t.opened.text[0])if("script"===(i=t.opened.text.substr(1).toLowerCase())||"style"===i){if(t=this._read_comment_or_cdata(e))return t.type=l.TEXT,t;a=this._input.readUntil(new RegExp("</"+i+"[\\n\\r\\t ]*?>","ig"))}else this._is_content_unformatted(i)&&(a=this._input.readUntil(new RegExp("</"+i+"[\\n\\r\\t ]*?>","ig")));return a?this._create_token(l.TEXT,a):null},a.prototype._read_content_word=function(e){var t="";if(t=(t=this._options.unformatted_content_delimiter&&e===this._options.unformatted_content_delimiter[0]?this.__patterns.unformatted_content_delimiter.read():t)||this.__patterns.word.read())return this._create_token(l.TEXT,t)},e.exports.Tokenizer=a,e.exports.TOKEN=l}],o.c=a,o.d=function(e,t,i){o.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},o.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},o.t=function(t,e){var i,a;if(1&e&&(t=o(t)),8&e||4&e&&"object"==typeof t&&t&&t.__esModule)return t;if(i=Object.create(null),o.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(a in t)o.d(i,a,function(e){return t[e]}.bind(null,a));return i},o.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return o.d(t,"a",t),t},o.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},o.p="";var i,a,s,n,r=o(o.s=18);"function"==typeof define&&define.amd?define(["require","./beautify","./beautify-css"],function(e){var i=e("./beautify"),a=e("./beautify-css");return{html_beautify:function(e,t){return r(e,t,i.js_beautify,a.css_beautify)}}}):"undefined"!=typeof exports?(s=require("./beautify.js"),n=require("./beautify-css.js"),exports.html_beautify=function(e,t){return r(e,t,s.js_beautify,n.css_beautify)}):"undefined"!=typeof window?window.html_beautify=function(e,t){return r(e,t,window.js_beautify,window.css_beautify)}:"undefined"!=typeof global&&(global.html_beautify=function(e,t){return r(e,t,global.js_beautify,global.css_beautify)})}(),function(e){(e=(e=e.Dashboard||(e.Dashboard={})).SupportedDataType||(e.SupportedDataType={}))[e.Number=0]="Number",e[e.Boolean=1]="Boolean",e[e.DateTime=2]="DateTime",e[e.String=3]="String"}(BoldBIDashboard=BoldBIDashboard||{}),InternalBrowseDialog=function(){function e(e){this.id=null,this.category=[],this.selectedFile=null,this.targetInstance=null,this.targetMethod=null,this.targetType=null,this.browseDialog=null,this.filePath=null,this.fileContainer=null,this.backNodeReference=[],this.forwardNodeReference=[],this.footerTag=null,this.nameWaterMark="Dashboard Name",this.outerContainer=null,this.isShowAutoCompleteLoader=!0,this.locale=null,this.browseSearchIsLength=!1,this.treeObj=null,this.ejBrowseScroller=null,this.ejBrowseWaitingPopup=null,this.autoCompleteVal=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.renderSaveDashboardDialog(),this.unwireEvents(),this.wireEvents()}return e.prototype.renderBrowseDialog=function(){var e,t=this.browseDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_browse_dialog"}),i=BoldBIDashboard.buildTag("div","",{}),a=BoldBIDashboard.buildTag("div","",{display:"table-row"},{id:this.id+"_browse_file_area"}),o=BoldBIDashboard.buildTag("table","",{"margin-left":"10px","border-spacing":"0px"},{unselectable:"on"}),s=BoldBIDashboard.buildTag("tr","",{height:"30px"}),n=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"}),r=BoldBIDashboard.buildTag("span","",{"margin-top":"4px"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-backward bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_back_icon"}),d=(n.append(r),r.bind("click",this.bbdesigner$.proxy(this.backOperation,this)),r=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"}),u=BoldBIDashboard.buildTag("span","",{"margin-top":"4px"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-forward bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_forward_icon"}),r.append(u),u.bind("click",this.bbdesigner$.proxy(this.forwardOperation,this)),u=BoldBIDashboard.buildTag("td","",{width:"30px",height:"30px"}),d=BoldBIDashboard.buildTag("div","",{display:"block","margin-left":"-5px",cursor:"default","margin-top":"4px"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-browse-reload bbi-dbrd-designer-hand-cursor",id:this.id+"_browse_reload_icon"}),u.append(d),d.bind("click",this.bbdesigner$.proxy(this.reloadCategory,this)),BoldBIDashboard.buildTag("td","",{width:"300px"})),l=BoldBIDashboard.buildTag("div.bbi-designer-border","",{border:"0.5px solid #cbcbcb",height:"25px",width:"652px","background-color":"white","margin-left":"-12px","margin-top":"1px",display:"inline-flex"},{}),h=BoldBIDashboard.buildTag("div","",{"padding-right":"5px","padding-left":"7px","padding-top":"3px"},{id:this.id+"_folder_icon_div"}),p=BoldBIDashboard.buildTag("span.bbi-headericon bbi-designer-dataset-openfolder","",{"font-size":"14px"},{id:this.id+"_folderIcon"}),c=this.filePath=BoldBIDashboard.buildTag("input.bbi-designer-browse-path","",{height:"20px",width:"618px"},{type:"text",id:this.id+"_browse_file_path",disabled:!0}),h=(h.append(p),l.append(h).append(c),p.attr("disabled","true").css("opacity","0.3"),d.append(l),s.append(n).append(r).append(u).append(d),this.outerContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{"border-top":"0.5px solid #cbcbcb","padding-left":"10px",height:"355px","background-color":"white",width:"750px","margin-top":"0.5px"},{id:this.id+"_browse_outer_div"})),c=BoldBIDashboard.buildTag("div.bbi-designer-emptyfile","",{display:"none",width:"100%",height:"100%","margin-left":"-10px"},{id:this.id+"_browse_fileEmpty_msg"}),p=BoldBIDashboard.buildTag("div.bbi-designer-empty-folder","This category is empty",{display:"table-cell",width:"100%",height:"100%"}),l=BoldBIDashboard.buildTag("div.e-file-area","",{}),n=this.fileContainer=BoldBIDashboard.buildTag("div","",{height:"355px",width:"750px"},{id:this.id+"_browse_file_container"}),r=(l.append(n),c.append(p),h.append(l).append(c),BoldBIDashboard.buildTag("table","",{"border-spacing":"0px",width:"100%"},{})),u=BoldBIDashboard.buildTag("tr","",{},{}),d=BoldBIDashboard.buildTag("td","",{},{}),n=BoldBIDashboard.buildTag("tr","",{},{}),p=BoldBIDashboard.buildTag("tr","",{},{}),l=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Name",{"font-size":"13px",overflow:"hidden",float:"left",padding:"6px 7px 6px 0px","white-space":"nowrap","text-overflow":"ellipsis"}),c=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt","",{height:"25px","margin-top":"1px","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box"},{id:this.id+"_browse_save",type:"text",tabindex:1}),b=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor","Cancel",{float:"right","margin-left":"12px"},{id:this.id+"_browse_btn_cancel",tabindex:4,type:"button"}),g=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor","Open",{float:"right","margin-left":"5px"},{id:this.id+"_browse_btn_import",tabindex:3,type:"button"});u.append(d.clone().append(l).css({"padding-bottom":"5px",width:"75px"}),d.clone().append(c).css("padding-bottom","5px").attr("colspan","3")),l=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Description",{"font-size":"13px",overflow:"hidden",float:"left",padding:"6px 7px 6px 0px","white-space":"nowrap","text-overflow":"ellipsis"}),e=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt","",{height:"25px","margin-top":"1px","box-sizing":"border-box","-webkit-box-sizing":"border-box","-moz-box-sizing":"border-box"},{id:this.id+"_browse_save_desc",type:"text",tabindex:2}),n.append(d.clone().append(l).css({"padding-bottom":"5px",width:"75px"}),d.clone().append(e).css("padding-bottom","5px").attr("colspan","3")),p.append(d.clone().attr("colspan","3"),d.clone().append(b).append(g)),r.append(u),r.append(n),r.append(p),o.append(s),a.append(o).append(h),i.append(a),t.append(i),this.dashboardDesigner.element.append(t),t.BoldBIDashboardDialog({minWidth:760,minHeight:250,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",beforeClose:this.bbdesigner$.proxy(this.hideWaitingPopup,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.bbdesigner$("#"+this.id+"_browse_dialog_foot"),this.footerTag.append(r),b.BoldBIDashboardButton({cssClass:"bbi-designer-cancelbtn",showRoundedCorner:!1,size:"mini",click:this.bbdesigner$.proxy(this.closeDialog,this)}),g.BoldBIDashboardButton({cssClass:"bbi-designer-okbtn",showRoundedCorner:!1,size:"mini",click:this.bbdesigner$.proxy(this.updateFileInfo,this)}),a.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),h.BoldBIDashboardScroller({height:"355px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.ejBrowseScroller=h.data("BoldBIDashboardScroller"),this.ejBrowseWaitingPopup=a.data("BoldBIDashboardWaitingPopup"),BoldBIDashboard.DashboardUtil.txtWaterMark(c,this.nameWaterMark)},e.prototype.reloadCategory=function(e){this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val(),this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),this.resetBrowseDialog(!0),this.loadCategory(e)},e.prototype.iconDisable=function(e,t){t?e.attr("disabled","true").css("opacity","0.3"):e.removeAttr("disabled").css("opacity","1")},e.prototype.backOperation=function(){var e,t;"disabled"!==this.bbdesigner$("#"+this.id+"_browse_back_icon").attr("disabled")&&(this.fileContainer.empty(),0<this.backNodeReference.length)&&(e=this.backNodeReference.pop(),0<(t=this.nodeSearch(e.ParentId,this.category,!(!BoldBIDashboard.isNullOrUndefined(e.ParentId)||BoldBIDashboard.isNullOrUndefined(e.Name)))).Files.length?(this.showReportFile(!0),this.nodeCreation(t.Files,t.Id),this.browseType!==BrowseType.Open||BoldBIDashboard.isNullOrUndefined(t.Type)||1!==t.Type||BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),null!==this.ejBrowseScroller&&this.ejBrowseScroller.refresh()):this.showReportFile(!1),(t=this.filePath.val().split("/"))[t.length-1]===e.Name&&this.bbdesigner$("#"+this.id+"_file_"+e.Id).addClass("bbi-designer-report-selection"),this.forwardNodeReference.push(e),t.pop(),this.filePath.val(t.join("/")),0===this.backNodeReference.length&&(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!0),this.filePath.val("/")),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!1),BoldBIDashboard.isNullOrUndefined(this.selectedFile)||this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.saveMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.openMenu))},e.prototype.nodeSearch=function(e,t,i){for(var a,o={Files:[],Id:null,Type:null},s=0;s<t.length;s++){if(a=t[s],BoldBIDashboard.isNullOrUndefined(e)&&i)return o.Files=this.category,o.Type=a.Type,o;if(e===a.Id)return o.Files=a.Files,o.Id=a.Id,o.Type=a.Type,o;if(0<a.Files.length&&null!==(a=this.nodeSearch(e,a.Files)))return a}return null},e.prototype.forwardOperation=function(){var e,t,i;"disabled"!==this.bbdesigner$("#"+this.id+"_browse_forward_icon").attr("disabled")&&(this.fileContainer.empty(),e=null,0<this.forwardNodeReference.length)&&(t=this.forwardNodeReference.pop(),0<(i=this.nodeSearch(t.Id,this.category)).Files.length?(this.showReportFile(!0),this.nodeCreation(i.Files,i.Id),this.browseType!==BrowseType.Open||BoldBIDashboard.isNullOrUndefined(i.Type)||1!==i.Type||BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),null!==this.ejBrowseScroller&&this.ejBrowseScroller.refresh()):this.showReportFile(!1),i=this.filePath.val(),this.filePath.val(("/"===i?"":i)+"/"+t.Name),0<this.forwardNodeReference.length&&(e=this.forwardNodeReference[this.forwardNodeReference.length-1].Id),this.bbdesigner$("#"+this.id+"_file_"+e).addClass("bbi-designer-report-selection"),this.backNodeReference.push(t),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),0===this.forwardNodeReference.length&&this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu)&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu)},e.prototype.fileSelection=function(e,t){var i,a;this.forwardNodeReference=[],!BoldBIDashboard.isNullOrUndefined(e)&&BoldBIDashboard.isNullOrUndefined(e.isEmpty)?2===e.Type&&this.browseType===BrowseType.Open?(this.selectedFile=e,this.updateFileInfo()):2===e.Type&&this.browseType===BrowseType.Publish?(this.bbdesigner$("#"+this.id+"_browse_save").val(e.Name),this.updateWaterMark()):(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),i=this.filePath.val(),this.filePath.val(("/"===i?"":i)+"/"+e.Name),this.fileContainer.empty(),this.showReportFile(!0),e.Files&&0<e.Files.length&&this.nodeCreation(e.Files,e.Id),a={Id:e.Id,Name:e.Name,ParentId:t,Type:e.Type},this.backNodeReference.push(a),null!==this.ejBrowseScroller&&this.ejBrowseScroller.refresh()):(this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!1),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),i=this.filePath.val(),this.filePath.val(("/"===i?"":i)+"/"+e.files.Name),this.fileContainer.empty(),this.showReportFile(!1),a={Id:e.files.Id,Name:e.files.Name,ParentId:e.files.parentId,Type:e.files.Type},this.backNodeReference.push(a))},e.prototype.showReportFile=function(e){e?(this.outerContainer.find(".e-file-area").css("display","block"),this.outerContainer.find(".bbi-designer-emptyfile").css("display","none")):(this.outerContainer.find(".e-file-area").css("display","none"),this.outerContainer.find(".bbi-designer-emptyfile").css("display","table"))},e.prototype.nodeCreation=function(e,t){var i,a,o,s;if(!BoldBIDashboard.isNullOrUndefined(e))for(i=0;i<e.length;i++)a=BoldBIDashboard.buildTag("div.bbi-designer-browse","",{margin:"12px 7.5px 0px 7.5px",padding:"7px",width:"74px",height:"74px","text-align":"center","line-height":"normal","vertical-align":"middle",float:"left",display:"table-cell"},{id:this.id+"_file_"+e[i].Id}),o=BoldBIDashboard.buildTag("div.bbi-designer-tile","",{width:"74px","padding-top":"2px",display:"inline-block","font-size":"50px"},{id:this.id+"_file_icon_"+e[i].Id}),this.getIcon(o,e[i].Type),(s=BoldBIDashboard.buildTag("span",e[i].Name,{width:"74px","padding-top":"5px",display:"inline-block","text-align":"center","font-size":"11px",height:"20px"},{id:this.id+"_"+e[i].Id})).addClass(96<BoldBIDashboard.DashboardUtil.textWidth(e[i].Name,"segoe ui 11px")?"e-title-tip bbi-designer-txt-overflow bbi-dbrd-designer-hoverable":"bbi-dbrd-designer-hoverable"),a.append(o).append(s),this.fileContainer.append(a),a.bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.loadDashboardsInCategory,this,e[i],t)),a.bind("click",this.bbdesigner$.proxy(this.selectedFiles,this,e[i])),s.hasClass("e-title-tip")&&s.attr("data-tooltip",e[i].Name)},e.prototype.loadDashboardsInCategory=function(e,t){2===e.Type?(this.bbdesigner$("#"+this.id+"_browse_save").val(e.Name),this.updateFileInfo()):this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(e.Name)},{fnction:this.bbdesigner$.proxy(this.fileSelectionChange,this,e,t),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]},!0,!0)},e.prototype.fileSelectionChange=function(e,t,i){i&&i.Status?(e.Files=JSON.parse(i.Data)||[],this.fileSelection(e,t,i)):this.fileSelection({isEmpty:!0,files:e},t,i),this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu)},e.prototype.getIcon=function(e,t){var i,a,o=0;for(1===t?(o=4,e.addClass("bbi-designer-browse-folder")):2===t&&(o=20,e.addClass("bbi-designer-browse-dbrdfile")),i=0;i<o;i++)a=BoldBIDashboard.buildTag("span","",{},{class:"path"+(i+1).toString()}),e.append(a)},e.prototype.selectedFiles=function(e,t){this.bbdesigner$("#"+this.id+"_browse_file_container > div").removeClass("bbi-designer-report-selection"),this.bbdesigner$("#"+t.currentTarget.id).addClass("bbi-designer-report-selection"),this.browseType===BrowseType.Publish&&1!==e.Type||(this.selectedFile=e,this.browseType===BrowseType.Open&&1!==e.Type||this.browseType===BrowseType.Publish?(this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.openMenu),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0)):this.browseType===BrowseType.Open&&1===e.Type&&BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1))},e.prototype.updateFileInfo=function(){var e,t,i,a,o,s;if(this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu)this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(this.selectedFile.Name)},{fnction:this.bbdesigner$.proxy(this.fileSelectionChange,this,this.selectedFile,null),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]},!1,!0);else if(t=this.bbdesigner$("#"+this.id+"_browse_save").val(),this.dashboardDesigner.nameValidation(t)){if(this.dashboardDesigner.reportFileName=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.model.dashboardName=this.bbdesigner$("#"+this.id+"_browse_save").val(),this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.model.dashboardDescription=this.bbdesigner$("#"+this.id+"_browse_save_desc").val(),this.dashboardDesigner.modules.serialization.notifyChange(),!BoldBIDashboard.isNullOrUndefined(this.selectedFile)&&!BoldBIDashboard.isNullOrUndefined(this.selectedFile.Name))if(this.browseType===BrowseType.Open)0<this.selectedFile.Name.length&&1!==this.selectedFile.Type&&(null!==this.targetInstance?(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,this.filePath.val(),this.targetType]),this.closeDialog()):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{name:this.selectedFile.Name,category:this.filePath.val(),type:BrowseType.Open})));else if(this.browseType===BrowseType.Publish&&(e=this.bbdesigner$("#"+this.id+"_browse_save").val(),t=this.bbdesigner$("#"+this.id+"_browse_save_desc").val(),e=e===this.nameWaterMark?"":e)&&0<e.length)if("/"===this.filePath.val()&&1!==this.selectedFile.Type)this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,this.locale.browseDialogMessages.selectCategory,IconType.information,AlertType.Confirm,!1,"");else if(1===this.selectedFile.Type){for(i=this.selectedFile.Files,a=!1,o=0;o<i.length;o++)if(2===i[o].Type&&i[o].Name===e){a=!0,s=this.locale.basicSettings.dashboardExistsError+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DashboardSaved,s,IconType.question,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:e,id:i[o].Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}});break}a||(null!==this.targetInstance?(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,e,t,!1,null,BoldBIDashboard.DashboardDesignerEvent.SaveAs]),this.closeDialog()):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:this.selectedFile.Name,name:e,categoryId:this.selectedFile.Id,isExist:!1,type:BrowseType.Publish})))}else 2===this.selectedFile.Type&&this.selectedFile.Name===e&&(s="'"+this.selectedFile.Name+this.locale.browseDialogMessages.fileExistInCategory+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,s,IconType.warning,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:e,id:this.selectedFile.Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}}))}else this.dashboardDesigner.modules.util.alertDialog(this.dashboardDesigner.getInvalidNameAlertTitle("dashboardName",!0),this.dashboardDesigner.getInvalidNameAlertTitle("dashboardName",!1),IconType.errors,AlertType.Alert,!1,"")},e.prototype.updateSaveFile=function(e,t){e&&(null!==this.targetInstance?BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[t.selectedFile,t.fileName,this.dashboardDesigner.dashboardDescription,!0,t.id,t.eventType]):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:t.selectedFile.Name,name:t.fileName,isExist:!0,type:BrowseType.Publish})))},e.prototype.openDialog=function(e,t,i){this.resetBrowseDialog(!1),this.callBackfn=t,this.browseDialog.data("BoldBIDashboardDialog").open(),this.browseType=e,this.browseDialog.data("BoldBIDashboardDialog").setModel({title:e===BrowseType.Publish?this.locale.browseDialogMessages.publishDashboard:this.locale.browseDialogMessages.selectDashboard}),this.enableSave(e===BrowseType.Publish),!BoldBIDashboard.isNullOrUndefined(i)&&0<i.length&&e===BrowseType.Publish&&(BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.dashboardDesigner.element.find("#"+this.id+"_browse_save")).value=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name,t=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,this.bbdesigner$("#"+this.id+"_browse_save_desc").val(t)),this.selectCategory(),this.loadCategory(),this.updateWaterMark()},e.prototype.openBrowseDialog=function(e,t,i,a,o){this.resetBrowseDialog(!1),this.targetInstance=e,this.targetMethod=t,this.targetType=a,this.browseType=i,this.browseDialog.data("BoldBIDashboardDialog").setModel({title:i===BrowseType.Publish?this.locale.browseDialogMessages.publishDashboard:this.locale.browseDialogMessages.selectDashboard}),this.enableSave(i===BrowseType.Publish),!BoldBIDashboard.isNullOrUndefined(o)&&0<o.length&&i===BrowseType.Publish&&(BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.dashboardDesigner.element.find("#"+this.id+"_browse_save")).value=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name,e=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,this.bbdesigner$("#"+this.id+"_browse_save_desc").val(e)),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.serverCategory)&&this.selectCategory(),this.loadCategory(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.serverCategory)?null:this.dashboardDesigner.serverCategory.categoryId),this.updateWaterMark()},e.prototype.updateWaterMark=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_browse_save"),t=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc");e.hasClass("bbi-designer-txtmark")&&t.removeClass("bbi-designer-txtmark"),t.removeClass("bbi-designer-txtmark")},e.prototype.updateCategorySelection=function(e,t){var i;BoldBIDashboard.isNullOrUndefined(e)||""===e||BoldBIDashboard.isNullOrUndefined(this.treeObj)||(t=t?this.findCategoryItemParent(this.treeObj.fields.dataSource,e):null,i=BoldBIDashboard.isNullOrUndefined(t)?this.findComponentPath(this.treeObj.fields.dataSource,e):t.Name,e=BoldBIDashboard.isNullOrUndefined(t)?this.findCategoryItem(this.treeObj.fields.dataSource,e):t,BoldBIDashboard.isNullOrUndefined(i)||""===i||this.dashboardDesigner.element.find("#"+this.id+"_browse_categoory_drpdwn").val(i),BoldBIDashboard.isNullOrUndefined(e))||(this.treeObj.setProperties({text:e.Name},!0),this.treeObj.setProperties({value:[e.Id]},!0),this.selectCategory({itemData:{id:e.Id,name:e.Name}}))},e.prototype.resetBrowseDialog=function(e){this.category=[],e||(this.targetInstance=null,this.targetMethod=null,this.targetType=null,this.callBackfn=null),this.backNodeReference=[],this.forwardNodeReference=[],this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_forward_icon"),!0),this.iconDisable(this.bbdesigner$("#"+this.id+"_browse_back_icon"),!0);var e=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description,t=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.dashboardDesigner.element.find("#"+this.id+"_browse_save"));t.value=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name,this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(t.value),this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val(e),this.showReportFile(!0),this.bbdesigner$("#"+this.id+"_browse_btn_import").text()===this.locale.menuBar.openMenu&&this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.menuBar.saveMenu),this.fileContainer.find(".bbi-browse-err").css("display","none"),this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","none")},e.prototype.hideWaitingPopup=function(){this.bbdesigner$("#"+this.id+"_browse_file_area").data("BoldBIDashboardWaitingPopup")&&this.bbdesigner$("#"+this.id+"_browse_file_area").data("BoldBIDashboardWaitingPopup").hide()},e.prototype.closeDialog=function(){var e=this.browseDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close()},e.prototype.loadCategory=function(e){this.browseDialog.data("BoldBIDashboardDialog").isOpen()||this.browseDialog.data("BoldBIDashboardDialog").open(),this.treeObj.refresh(),this.getCategoryInfo(e)},e.prototype.getCategoryInfo=function(e){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(""),ignoreAlertDialog:!0},{fnction:this.bbdesigner$.proxy(this.populateCategory,this,e),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)],errfnction:this.bbdesigner$.proxy(this.categoryLoadingErr,this)},!1,!0)},e.prototype.populateCategory=function(e,t){this.footerTag.find(".bbi-designer-categoryErrWrap").hide(),this.treeObj.readonly=!1,t&&t.ApiStatus&&(!BoldBIDashboard.isNullOrUndefined(t.Data)&&t.Status?(this.category=JSON.parse(t.Data),this.categoryDataUpdate(this.category),e=BoldBIDashboard.isNullOrUndefined(e)&&!BoldBIDashboard.isNullOrUndefined(this.category)&&0<this.category.length?this.category[0].Id.toString():e,this.updateCategorySelection(e,!BoldBIDashboard.isNullOrUndefined(e)),null!==this.ejBrowseScroller&&this.ejBrowseScroller.refresh()):"2042"===t.StatusCode?(this.treeObj.readonly=!0,this.fileContainer.find(".e-dbrd-notvalidcategory").text(this.locale.browseDialogMessages.createCategory),this.validateCategory()):(this.treeObj.readonly=!0,this.populateCategoryErr(t.Message)))},e.prototype.enableSave=function(e){e?(this.bbdesigner$("#"+this.id+"_browse_save").css("display","block"),this.bbdesigner$("#"+this.id+"_browse_save_desc").css("display","block"),this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.browseDialogMessages.publishText)):(this.bbdesigner$("#"+this.id+"_browse_save").css("display","none"),this.bbdesigner$("#"+this.id+"_browse_save_desc").css("display","none"),this.bbdesigner$("#"+this.id+"_browse_btn_import").text(this.locale.browseDialogMessages.openText))},e.prototype.showLoadingIndicator=function(){this.browseDialog.data("BoldBIDashboardDialog").isOpen()&&(BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_cancel"),!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),this.browseType===BrowseType.Publish&&(this.bbdesigner$("#"+this.id+"_browse_save").attr("disabled","true").css("opacity","0.3"),this.bbdesigner$("#"+this.id+"_browse_save_desc").attr("disabled","true").css("opacity","0.3")),this.ejBrowseWaitingPopup.show())},e.prototype.hideLoadingIndicator=function(){this.ejBrowseWaitingPopup.hide(),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_cancel"),!0),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0),this.browseType===BrowseType.Publish&&(this.bbdesigner$("#"+this.id+"_browse_save").removeAttr("disabled").css("opacity","1"),this.bbdesigner$("#"+this.id+"_browse_save_desc").removeAttr("disabled").css("opacity","1"))},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.browseDialog),0<this.browseDialog.length&&this.bbdesigner$("#"+this.id+"_browse_dialog").remove(),this.unwireEvents()},e.prototype.renderSaveDashboardDialog=function(){this.browseDialog=BoldBIDashboard.buildTag("div.bbi-userselect e-browse-dlg","",{},{id:this.id+"_browse_dialog"}),e=BoldBIDashboard.buildTag("div","",{}),t=BoldBIDashboard.buildTag("div","",{display:"table-row"},{id:this.id+"_browse_file_area"}),this.outerContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control e-outercontainer","",{},{id:this.id+"_browse_outer_div"});var e,t,i=BoldBIDashboard.buildTag("div.bbi-designer-emptyfile","",{},{id:this.id+"_browse_fileEmpty_msg"}),a=BoldBIDashboard.buildTag("div.bbi-designer-empty-folder",this.locale.browseDialogMessages.categoryEmptyMsg,{}),o=BoldBIDashboard.buildTag("div.e-file-area","",{}),a=(this.fileContainer=BoldBIDashboard.buildTag("div.bbi-browse-dlg-filecontainer","",{},{id:this.id+"_browse_file_container"}),o.append(this.fileContainer),i.append(a),this.outerContainer.append(o).append(i),BoldBIDashboard.buildTag("div.bbi-browse-dialog-content-table","",{},{})),o=this.getCategoryRow(),i=this.getNameRow(),s=this.getDescRow(),o=(a.append(o,i,s),this.dashboardDesigner.model.enablePublicDashboardSetting?a.append(this.getMarkAsPublicRow()):this.outerContainer.css("height","230px"),this.fileContainer.append(a),BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-categoryErrWrap","",{})),i=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-categoryErrMsg","",{}),s=BoldBIDashboard.buildTag("a.bbi-designer-fontfamily bbi-designer-categoryRetryLink",this.locale.browseDialogMessages.retryText,{});o.append(i,s),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-browse-dlg-cancel-btn",this.locale.browseDialogMessages.cancelBtnText,{},{id:this.id+"_browse_btn_cancel",tabindex:4,type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small bbi-browse-dlg-save-btn",this.locale.browseDialogMessages.openBtnText,{},{id:this.id+"_browse_btn_import",tabindex:3,type:"button"}),t.append(this.outerContainer),e.append(t),this.browseDialog.append(e),this.browseDialog.BoldBIDashboardDialog({minWidth:700,minHeight:250,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",beforeClose:this.bbdesigner$.proxy(this.hideWaitingPopup,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_browse_dialog_foot"),this.footerTag.append(o,a,i),t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.ejBrowseWaitingPopup=t.data("BoldBIDashboardWaitingPopup"),this.autoCompleteVal={dataSource:[],autofill:!0,width:548,height:30,focus:this.bbdesigner$.proxy(this.listOutDSNames,this),cssClass:"bbi-ej2-auto-complete e-designer bbi-dbrd-control bbi-browse-dialog",showClearButton:!1,filterType:"StartsWith",actionComplete:this.bbdesigner$.proxy(this.actionCompletehanlder,this),open:this.bbdesigner$.proxy(this.openHanlder,this)},BoldBIDashboard.DashboardUtil.createAutoComplete(this.autoCompleteVal,this.fileContainer.find(".e-dbrd-browse-savenametxt")[0]),this.browseSearchIsLength=!1,this.bbdesigner$("#"+this.id+"_browse_save_suggestion").addClass("bbi-dbrd-control"),this.appendLoader(),this.dashboardDesigner.model.enablePublicDashboardSetting&&this.SetPublicSettings(),this.treeObj=new ejdashboard.dropdowns.DropDownTree({fields:{dataSource:[],value:"Id",text:"Name",child:"subChild",expanded:"expanded"},allowFiltering:!0,showClearButton:!1,popupHeight:"200px",placeholder:"Select a category",changeOnBlur:!1,cssClass:"bbi-dbrd-control bbi-category-pop",filtering:this.bbdesigner$.proxy(this.filteringValue,this),select:this.bbdesigner$.proxy(this.selectCategory,this)}),this.treeObj.appendTo("#"+this.id+"_browse_categoory_drpdwn")},e.prototype.filteringValue=function(e){var t,i;!(BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.text)||BoldBIDashboard.isNullOrUndefined(e.fields)||BoldBIDashboard.isNullOrUndefined(e.fields.dataSource))&&0<e.fields.dataSource.length&&(e=this.findCategorySearchItem(e.fields.dataSource,e.text),t=this.bbdesigner$(".bbi-category-pop.e-popup"),i=this.bbdesigner$(".e-popup-content.e-dropdown"),t.find(".bbi-no-suggestion").remove(),i.css("display","block"),BoldBIDashboard.isNullOrUndefined(e))&&(this.appendNoSuggestions(),i.css("display","none"))},e.prototype.appendNoSuggestions=function(){var e=this.bbdesigner$(".bbi-category-pop.e-popup"),t=(e.find(".bbi-no-suggestion").remove(),BoldBIDashboard.buildTag("div.bbi-no-suggestion","",{height:"20px"},{})),i=BoldBIDashboard.buildTag("ul.e-list-parent e-ul","",{},{role:"tree"}),a=BoldBIDashboard.buildTag("li.e-nosuggestion","No suggestions",{color:"var(--querydesigner-text-color)","margin-left":"10px","font-family":"var(--designer-font) !important","font-size":"12px"},{"data-value":"No suggestions",unselectable:"on"});t.append(i.append(a)),e.append(t)},e.prototype.openHanlder=function(e){this.browseSearchIsLength&&e.popup.element.querySelector(".e-nodata")&&(e.popup.element.querySelector(".e-nodata").style.display="none",e.popup.element.style.border="none",this.browseSearchIsLength=!1)},e.prototype.appendLoader=function(){this.fileContainer.find(".e-dbrd-browse-savenametxt").parents(".e-in-wrap.e-box").append("<div class='bbi-category-dashboards-loadicon-wrap'><span class='bbi-dashboardname-load-icon'></span></div>"),this.dashboardDesigner.designerPanel.appendSpinningWidget(this.fileContainer.find(".bbi-dashboardname-load-icon"),null)},e.prototype.actionCompletehanlder=function(e){var t=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.fileContainer.find(".e-dbrd-browse-savenametxt")).list;0===e.result.length&&t?(this.browseSearchIsLength=!0,t&&(t.style.display="none",t.parentElement)&&(t.parentElement.style.borderWidth="0px")):t&&(t.style.display="block",t.parentElement)&&(t.parentElement.style.borderWidth="1px")},e.prototype.listOutDSNames=function(){this.fileContainer.find(".e-input-group.bbi-browse-dialog").removeClass("bbi-designer-error"),this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","none"),BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.fileContainer.find(".e-dbrd-browse-savenametxt")).showPopup()},e.prototype.getCategoryRow=function(){var e=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),i=BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div","",{},{}),a=BoldBIDashboard.buildTag("div.bbi-browse-label",this.locale.browseDialogMessages.categoryLabelText,{},{id:this.id+"_browseCategroyLabel"}),a=(t.append(a),BoldBIDashboard.buildTag("div.bbi-browse-category-wrap","",{},{id:this.id+"_browseCategroyWrap"})),o=BoldBIDashboard.buildTag("div.bbi-dbrd-select-category","",{},{id:this.id+"_browse_categoory_drpdwn_div"}),s=BoldBIDashboard.buildTag("input.e-dbrd-select-category-drpdwn bbi-dbrd-control","",{},{id:this.id+"_browse_categoory_drpdwn"}),o=(o.append(s),a.append(o),s=BoldBIDashboard.buildTag("div.e-dbrd-notvalidcategory bbi-browse-err",this.locale.browseDialogMessages.selectCategory,{},{id:this.id+"_browse_name_errmsg"}),a.append(s),i.append(a),BoldBIDashboard.buildTag("div.bbi-browse-category-addwrap","",{},{id:this.id+"_browseCategoryAddwrap"})),s=BoldBIDashboard.buildTag("div.bbi-browse-category-add bbi-dbrd-icon-background-theme","",{},{id:this.id+"_browseCategoryAdd",title:this.locale.browseDialogMessages.createCategoryTooltip}),a=BoldBIDashboard.buildTag("div.bbi-browse-category-plusicon bbi-dbrd-icon-theme","",{},{id:this.id+"_browseCategoryPlus"});return s.append(a),o.append(s),i.append(o),e.append(t,i),e},e.prototype.getNameRow=function(){var e=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),i=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.nameLabelText,{}),i=(t.append(i),BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div","",{},{})),a=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-txt e-dbrd-browse-savenametxt bbi-browse-dialog-nametext","",{},{id:this.id+"_browse_save",type:"text"}),o=BoldBIDashboard.buildTag("div.e-dbrd-notvalidname bbi-browse-err",this.locale.browseDialogMessages.dashboardNameEmptyErr,{},{id:this.id+"_browse_name_errmsg"});return i.append(a,o),e.append(t,i),e},e.prototype.getDescRow=function(){var e=BoldBIDashboard.buildTag("div.bbi-browse-content-row bbi-browse-desc-row","",{},{}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),i=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.descriptionLabelText,{}),i=(t.append(i),BoldBIDashboard.buildTag("div.bbi-browse-contentwrap e-contentwrap-description","",{},{})),a=BoldBIDashboard.buildTag("textarea.e-textarea bbi-designer-txt bbi-browse-dialog-text bbi-browse-dialog-textarea e-browse-dialog-desc","",{},{id:this.id+"_browse_save_desc",type:"textarea",spellcheck:"false",maxlength:"1024"}),o=BoldBIDashboard.buildTag("div.e-dbrd-exceedsmaxlength bbi-browse-desc-err bbi-designer-fontfamily",this.locale.browseDialogMessages.dashboardDescExceedsMaxLength,{},{id:this.id+"_browse_name_errmsg"});return i.append(a,o),e.append(t,i),e},e.prototype.getMarkAsPublicRow=function(){var e=BoldBIDashboard.buildTag("div.bbi-browse-content-row","",{},{id:this.id+"_mark_public_div"}),t=BoldBIDashboard.buildTag("div.bbi-browse-labelwrap bbi-browse-label-font","",{},{}),i=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-browse-dialog-label",this.locale.browseDialogMessages.isPublic,{}),i=(t.append(i),BoldBIDashboard.buildTag("div.bbi-browse-contentwrap bbi-browse-contentwrap-div bbi-mark-public-chk-box","",{},{})),a=BoldBIDashboard.buildTag("input","",{},{id:this.id+"_is_public_chk",type:"checkbox"}),o=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_is_public_info",class:"bbi-mark-public-info"}),s=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_is_public_info_span",class:"bbi-mark-public-info-span"});return i.append(a),o.append(s),i.append(o),e.append(t,i),a.BoldBIDashboardCheckBox({checked:!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&this.dashboardDesigner.model.serverSettings.isPublic&&this.dashboardDesigner.model.serverSettings.enableMarkAsPublic||!1,value:"isPublic"}),e},e.prototype.SetPublicSettings=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_mark_public_div"),t=e.find("#"+this.id+"_is_public_chk");!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&this.dashboardDesigner.model.serverSettings.enableMarkAsPublic?(t.data("BoldBIDashboardCheckBox").enable(),e.find(".bbi-browse-dialog-label").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info").css("display","none")):(e.find(".bbi-browse-dialog-label").css("opacity","0.3"),t.data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info_span").html(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)?"":this.dashboardDesigner.model.serverSettings.warningMessage),this.dashboardDesigner.element.find("#"+this.id+"_is_public_info").css("display","block"))},e.prototype.validateDashboardName=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),t=""===e.trim()?this.locale.browseDialogMessages.dashboardNameEmptyErr:this.locale.browseDialogMessages.dashboardNameErrorMsg+'* | / : < > , % ; \\ " + & ? #';this.fileContainer.find(".e-dbrd-notvalidname").html(t),this.dashboardDesigner.nameValidation(e)&&""!==e.trim()?this.hideDSNameErr():this.showDSNameErr(),this.validInputs()},e.prototype.showDSNameErr=function(){this.fileContainer.find(".e-dbrd-notvalidname").slideDown(100),this.fileContainer.find(".e-input-group.bbi-browse-dialog").addClass("bbi-designer-error")},e.prototype.hideDSNameErr=function(){this.fileContainer.find(".e-dbrd-notvalidname").slideUp(100),this.fileContainer.find(".e-input-group.bbi-browse-dialog").removeClass("bbi-designer-error")},e.prototype.validateCategory=function(){var e=BoldBIDashboard.isNullOrUndefined(this.treeObj)?ejdashboard.base.getComponent(this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn")[0],"dropdowntree"):this.treeObj;BoldBIDashboard.isNullOrUndefined(e)||(BoldBIDashboard.isNullOrUndefined(e.text)||""===e.text?this.fileContainer.find(".e-dbrd-notvalidcategory").show():this.fileContainer.find(".e-dbrd-notvalidcategory").hide()),this.validInputs()},e.prototype.validInputs=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),e=!BoldBIDashboard.isNullOrUndefined(e)&&this.dashboardDesigner.nameValidation(e)&&""!==e.trim(),t=BoldBIDashboard.isNullOrUndefined(this.treeObj)?ejdashboard.base.getComponent(this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn")[0],"dropdowntree"):this.treeObj,t=!BoldBIDashboard.isNullOrUndefined(t.text)&&""!==t.text;return BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_browse_btn_import"),e&&t&&this.isShowAutoCompleteLoader),e&&t},e.prototype.categoryDataUpdate=function(e){BoldBIDashboard.isNullOrUndefined(e)||(this.fileContainer.find(".e-dbrd-notvalidcategory").text(this.locale.browseDialogMessages.selectCategory),this.fileContainer.find(".e-dbrd-notvalidcategory").hide(),0<this.fileContainer.find(".e-dbrd-select-category-drpdwn").length&&(this.treeObj.fields.dataSource=e,this.treeObj.refresh()))},e.prototype.selectCategory=function(e){var t;BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.itemData)||(t=this.findCategoryItem(this.treeObj.fields.dataSource,e.itemData.id),this.getDashboardsInSelectedCategory(t,this.findComponentPath(this.treeObj.fields.dataSource,e.itemData.id,!0)),t=this.findComponentPath(this.treeObj.fields.dataSource,e.itemData.id),BoldBIDashboard.isNullOrUndefined(t))||""===t||this.dashboardDesigner.element.find("#"+this.id+"_browse_categoory_drpdwn").val(t),this.validateDashboardName(e)},e.prototype.getDashboardsInSelectedCategory=function(e,t){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getcategories,{action:BoldBIDashboard.DashboardUtil.DesignerAction.categoryCatalog,data:JSON.stringify(t)},{fnction:this.bbdesigner$.proxy(this.updateDashboardsInfo,this,e),indicator:[this.bbdesigner$.proxy(this.showAutoCompleteLoader,this),this.bbdesigner$.proxy(this.hideAutoCompleteLoader,this)]})},e.prototype.updateDashboardsInfo=function(e,t){this.footerTag.find(".bbi-designer-categoryErrWrap").hide();var i,a=e.Files=t&&t.Status?JSON.parse(t.Data)||[]:JSON.parse(t),o=[],e=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.fileContainer.find(".e-dbrd-browse-savenametxt"));if(!BoldBIDashboard.isNullOrUndefined(e)){for(i=0;i<a.length;i++)o.push(a[i].Name);e.dataSource=o}},e.prototype.showAutoCompleteLoader=function(){this.hideDSNameErr(),this.isShowAutoCompleteLoader=!1,this.fileContainer.find(".e-dbrd-browse-savenametxt").css("width","calc(100% - 28px"),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!1),this.fileContainer.find(".bbi-background-waiting-popup").show()},e.prototype.hideAutoCompleteLoader=function(){this.isShowAutoCompleteLoader=!0,this.fileContainer.find(".e-dbrd-browse-savenametxt").css("width","100%"),this.fileContainer.find(".bbi-background-waiting-popup").hide(),BoldBIDashboard.DashboardUtil.buttonEnable(this.bbdesigner$("#"+this.id+"_browse_btn_import"),!0)},e.prototype.saveDashboardInfo=function(){this.saveCategoryInfo(),""!==this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()&&(this.dashboardDesigner.reportFileName=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.model.dashboardName=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()),0<this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").length&&(this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.model.dashboardDescription=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val())},e.prototype.saveCategoryInfo=function(){var e,t=BoldBIDashboard.isNullOrUndefined(this.treeObj)?ejdashboard.base.getComponent(this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn")[0],"dropdowntree"):this.treeObj;!BoldBIDashboard.isNullOrUndefined(t)&&this.validInputs()&&(e=this.findCategoryItem(t.fields.dataSource,t.value[0]),this.selectedFile=null!==e?e:t.fields.dataSource[0])},e.prototype.findCategorySearchItem=function(e,t){var i,a;if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)for(i=0;i<e.length;i++){if(e[i].Name.trim().toLowerCase().includes(t.trim().toLowerCase()))return e[i];if(null!=(a=this.findCategoryItem(e[i].subChild,t)))return a}},e.prototype.findCategoryItemParent=function(e,t){if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)for(var i=0;i<e.length;i++)if(e[i].Name===t)return e[i]},e.prototype.findCategoryItem=function(e,t){var i,a;if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)for(i=0;i<e.length;i++){if(e[i].Id===t)return e[i];if(null!=(a=this.findCategoryItem(e[i].subChild,t)))return a}},e.prototype.findComponentPath=function(e,t,i){var a,o,s,n;for(void 0===i&&(i=!1),a=0,o=e;a<o.length;a++){if((s=o[a]).Id===t)return s.Name;if(s.subChild&&(n=this.findComponentPath(s.subChild,t,i)))return i?s.Name+"/"+n:s.Name+" / "+n}return null},e.prototype.populateCategoryErr=function(e){this.browseDialog.data("BoldBIDashboardDialog").isOpen()&&(this.footerTag.find(".bbi-designer-categoryErrMsg").addClass("bbi-dbrd-designer-hoverable").text(e).attr("data-tooltip",e),this.footerTag.find(".bbi-designer-categoryErrWrap").css("display","block"),BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_browse_btn_import"),!1))},e.prototype.addCategory=function(){new BoldBIDashboard.DashboardDesignerUtility.CreateCategoryDialog(this.dashboardDesigner,null).showDialog(!0)},e.prototype.saveDashboard=function(){var e,t,i,a,o;if(this.validateCategory(),this.validInputs()&&(this.saveCategoryInfo(),""!==this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()&&(this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Name=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val()),0<this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").length&&(this.dashboardDesigner.dashboardDescription=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.Description=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val()),this.dashboardDesigner.modules.serialization.notifyChange(),!BoldBIDashboard.isNullOrUndefined(this.selectedFile))&&!BoldBIDashboard.isNullOrUndefined(this.selectedFile.Name)&&this.browseType===BrowseType.Publish){var s=this.dashboardDesigner.element.find("#"+this.id+"_browse_save").val(),n=this.dashboardDesigner.element.find("#"+this.id+"_browse_save_desc").val(),r=BoldBIDashboard.isNullOrUndefined(this.treeObj)?ejdashboard.base.getComponent(this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn")[0],"dropdowntree"):this.treeObj;if(BoldBIDashboard.isNullOrUndefined(r)||(r=r.value,!BoldBIDashboard.isNullOrUndefined(r)&&0<r.length&&(this.selectedFile.Id=r[0])),(s=s===this.nameWaterMark?"":s)&&0<s.length)if(1===this.selectedFile.Type){for(e=this.selectedFile.Files,t=!1,i=0;i<e.length;i++)if(2===e[i].Type&&e[i].Name===s){t=!0,o="A dashboard with the same name already exists in the category"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DashboardSaved,o,IconType.question,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:s,id:e[i].Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}});break}t?(a=this.fileContainer.find("#"+this.id+"_is_public_chk").data("BoldBIDashboardCheckBox"))&&(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&(this.dashboardDesigner.model.serverSettings={}),this.dashboardDesigner.model.serverSettings.isPublic=a.isChecked()):null!==this.targetInstance?((a=this.fileContainer.find("#"+this.id+"_is_public_chk").data("BoldBIDashboardCheckBox"))&&(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serverSettings)&&(this.dashboardDesigner.model.serverSettings={}),this.dashboardDesigner.model.serverSettings.isPublic=a.isChecked()),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.selectedFile,s,n,!1,null,BoldBIDashboard.DashboardDesignerEvent.SaveAs])):(this.closeDialog(),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{category:this.selectedFile.Name,name:s,categoryId:this.selectedFile.Id,isExist:!1,type:BrowseType.Publish}))}else 2===this.selectedFile.Type&&this.selectedFile.Name===s&&(o="'"+this.selectedFile.Name+this.locale.browseDialogMessages.fileExistInCategory+" '"+this.filePath.val().replace("/","")+"'"+this.locale.browseDialogMessages.doYouWantToReplace,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.saveAsDashboard,o,IconType.warning,AlertType.Confirm,!1,"",{method:"updateSaveFile",instance:this,dataInfo:{selectedFile:this.selectedFile,fileName:s,id:this.selectedFile.Id,eventType:BoldBIDashboard.DashboardDesignerEvent.SaveAs}}))}},e.prototype.retry=function(){var e=null,t=this.fileContainer.find("#"+this.id+"_browse_categoory_drpdwn").data("ejDropDownTree");!BoldBIDashboard.isNullOrUndefined(t)&&!BoldBIDashboard.isNullOrUndefined(t.model.selectedItemIndex)&&-1<t.model.selectedItemIndex&&(e=JSON.parse(t.getSelectedValue()).Name),this.getCategoryInfo(e)},e.prototype.categoryLoadingErr=function(){this.populateCategoryErr(this.locale.browseDialogMessages.loadCategoryErr)},e.prototype.dashboardSaveErr=function(e){var t=this.browseDialog.data("BoldBIDashboardDialog");!BoldBIDashboard.isNullOrUndefined(t)&&t.isOpen()&&(this.dashboardDesigner.element.find(".e-browseDialog-footer .bbi-browse-err").addClass("bbi-dbrd-designer-hoverable").text(this.locale.errorMessage.errorOnSaveDashboard).attr("data-tooltip",e.Message),this.dashboardDesigner.element.find(".e-browseDialog-footer .bbi-designer-categoryErrWrap").css("display","block"))},e.prototype.descriptionKeyEvent=function(e){13===e.keyCode&&e.stopPropagation()},e.prototype.wireEvents=function(){this.fileContainer.on("click",".bbi-browse-category-addwrap",this.bbdesigner$.proxy(this.addCategory,this)),this.fileContainer.on("focusout",".e-dbrd-browse-savenametxt",this.bbdesigner$.proxy(this.validateDashboardName,this)),this.footerTag.on("click",".bbi-designer-categoryErrWrap .bbi-designer-categoryRetryLink",this.bbdesigner$.proxy(this.retry,this)),this.fileContainer.on("keypress",".bbi-browse-contentwrap.e-contentwrap-description",this.bbdesigner$.proxy(this.descriptionKeyEvent,this)),this.footerTag.on("click","#"+this.id+"_browse_btn_import",this.bbdesigner$.proxy(this.saveDashboard,this)),this.footerTag.on("click","#"+this.id+"_browse_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},e.prototype.unwireEvents=function(){this.fileContainer.off("click",".bbi-browse-category-addwrap",this.bbdesigner$.proxy(this.addCategory,this)),this.fileContainer.off("focusout",".e-dbrd-browse-savenametxt",this.bbdesigner$.proxy(this.validateDashboardName,this)),this.footerTag.off("click",".bbi-designer-categoryErrWrap .bbi-designer-categoryRetryLink",this.bbdesigner$.proxy(this.retry,this)),this.fileContainer.off("keypress",".bbi-browse-contentwrap.e-contentwrap-description",this.bbdesigner$.proxy(this.descriptionKeyEvent,this)),this.footerTag.off("click","#"+this.id+"_browse_btn_import",this.bbdesigner$.proxy(this.saveDashboard,this)),this.footerTag.off("click","#"+this.id+"_browse_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.BrowseDialog",InternalBrowseDialog,window),function(e){e[e.Open="Open"]="Open",e[e.Publish="Publish"]="Publish"}(BrowseType=BrowseType||{}),InternalConditionalFormat=function(){function e(e){this.dashboardDesigner=null,this.columnFormatDialog=null,this.conditionalFormats=null,this.selectedRow=null,this.toolbarDiv=null,this.targetInstance=null,this.targetMethod=null,this.editIconDiv=null,this.deleteIconDiv=null,this.settingsDialog=null,this.isEdit=!1,this.conditionalInfo=null,this.rightTextBoxDiv=null,this.measureConditionValues=null,this.textDiv=null,this.colorPalette=null,this.divContainer=null,this.columnDetails=null,this.columngridObj=null,this.locale=null,this.locale=e.getLocalizationContent(),this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.id=this.dashboardDesigner._id,this.renderColumnFormatWindow(),this.unWireEvents(),this.wireEvents()}return e.prototype.renderColumnFormatWindow=function(){var e,t,i=this.columnFormatDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{position:"relative"},{id:this.id+"_col_conditional_format"}),a=BoldBIDashboard.buildTag("div","",{}),o=this.toolbarDiv=BoldBIDashboard.buildTag("div","",{height:"20px",padding:"5px 0px"}),s=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-background-theme","",{}),n=BoldBIDashboard.buildTag("span.e-icon e-plus bbi-designer-format-addIcon bbi-dbrd-designer-hoverable","",{float:"right","margin-top":"3px","margin-right":"4px"},{id:this.id+"_col_conditional_format_add","data-tooltip":this.locale.chartTrendLineDialog.Add});s.append(n),n=this.editIconDiv=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-icon-background-theme","",{"margin-left":"5px"}),t=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-parameter-edit bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px",margin:"3px"},{id:this.id+"_col_conditional_format_edit","data-tooltip":this.locale.chartTrendLineDialog.Edit}),n.append(t),t=this.deleteIconDiv=BoldBIDashboard.buildTag("div.boldbi-dashboarddesigner-grid-toolbar bbi-dbrd-icon-background-theme","",{"margin-left":"5px"}),e=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-toolbar-delete bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px","margin-top":"2px","margin-right":"3px"},{id:this.id+"_col_conditional_format_delete","data-tooltip":this.locale.chartTrendLineDialog.Delete}),t.append(e),o.append(t,n,s),s.bind("click",this.bbdesigner$.proxy(this.addConditionalColumn,this)),n.bind("click",this.bbdesigner$.proxy(this.editConditionalColumn,this)),t.bind("click",this.bbdesigner$.proxy(this.deleteConditionalColumn,this)),e=BoldBIDashboard.buildTag("div","",{width:"378px",height:"100%",border:"1px solid #cecece","box-sizing":"border-box"},{id:this.id+"_col_conditional_format_rootgrid"}),s=BoldBIDashboard.buildTag("div.boldbi-designer-conditionalformat-grid","",{},{id:this.id+"_col_conditional_format_grid"}),a.append(o,e.append(s)),i.append(a),this.dashboardDesigner.element.append(i),i.BoldBIDashboardDialog({title:"Grid Conditional Formatting",width:"auto",height:"auto",minWidth:400,minHeight:260,enableResize:!1,showOnInit:!1,showFooter:!0,enableModal:!0,target:"#"+this.dashboardDesigner._id,containment:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog bbi-designer-format boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),n=this.dashboardDesigner.element.find("#"+this.id+"_col_conditional_format_foot"),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary",this.locale.dialogOptions.closeButtonText,{float:"right"},{id:this.id+"_col_conditional_format_cancel",type:"button"}),n.append(t),t.on("click",this.bbdesigner$.proxy(this.closeConditionalFormat,this)),this.getGridContainer(s),this.renderConditionalSettings()},e.prototype.getGridContainer=function(e){for(var t=[],i=[{fieldName:"BasedOn",Name:"Based On"},{fieldName:"Condition",Name:"Condition"}],a=376/i.length,o=0;o<i.length;o++)t.push({field:i[o].fieldName,headerText:i[o].Name,width:a,textAlign:BoldBIDashboard.TextAlign.Left});e.BoldBIDashboardGrid({columns:t,height:"265px",allowSelection:!0,allowResizing:!0,allowScrolling:!0,allowPaging:!1,scrollSettings:{allowVirtualScrolling:!1,virtualScrollMode:"normal",enableTouchScroll:!1,autoHide:!0},rowSelected:this.bbdesigner$.proxy(this.gridRowSelected,this),cssClass:"bbi-dbrd-designer-scroller bbi-dbrd-control"}),this.columngridObj=e.data("BoldBIDashboardGrid")},e.prototype.getGridDataSource=function(){for(var e=[],t=0;t<this.conditionalFormats.length;t++)e.push(this.getGridElement(this.conditionalFormats[t]));return e},e.prototype.getGridElement=function(e){var t=null;return e.TargetMeasureColumn.ColumnType===FieldType[FieldType.Measures]?e.ColorStyle===ColorType[ColorType.SingleColor]?t=this.getMeasureConditionText(e.MeasureConditionType,e.Value,e.EndValue):e.ColorStyle===ColorType[ColorType.GradientColor]&&(t=e.FormatType===ConditionalFormatType[ConditionalFormatType.Indication]?ConditionalFormatType[ConditionalFormatType.Indication]:"Graded Color Scale"):t=this.getDimensionConditionText(e.DimensionConditionType,e.Text,null),e.DisplayExpression=t,{BasedOn:e.ColumnName,Condition:t,conditionalInfo:e}},e.prototype.getConditionValue=function(e){var t=null;return"string"==typeof e?t=0<e.length?e:"''":"number"==typeof e&&(t=e),t},e.prototype.getMeasureConditionText=function(e,t,i){var a="Value";return e===MeasureConditionType[MeasureConditionType.Equals]?a=a+" = "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.NotEquals]?a=a+" != "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.GreaterThan]?a=a+" > "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.GreaterThanOrEqual]?a=a+" >= "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.LessThan]?a=a+" < "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.LessThanOrEqual]?a=a+" <= "+this.getConditionValue(t):e===MeasureConditionType[MeasureConditionType.Between]&&(a=a+" between "+t+" and "+i),a},e.prototype.getDimensionConditionText=function(e,t){var i="Value";return e===DimensionConditionType[DimensionConditionType.Equals]?i=i+" = "+this.getConditionValue(t):e===DimensionConditionType[DimensionConditionType.NotEquals]?i=i+" != "+this.getConditionValue(t):e===DimensionConditionType[DimensionConditionType.Contains]?i=i+" contains "+this.getConditionValue(t):e===DimensionConditionType[DimensionConditionType.NotContains]?i=i+" does not contain "+this.getConditionValue(t):e===DimensionConditionType[DimensionConditionType.StartsWith]?i=i+" starts with "+this.getConditionValue(t):e===DimensionConditionType[DimensionConditionType.EndsWith]&&(i=i+" ends with "+this.getConditionValue(t)),i},e.prototype.gridRowSelected=function(e){this.selectedRow=e.data,BoldBIDashboard.isNullOrUndefined(e.target)?this.disableToolbarItems(!0):this.disableToolbarItems(!1)},e.prototype.addConditionalColumn=function(){this.openColumnSettings(null,!1)},e.prototype.updateGridData=function(e,t){var i,a,o,s=this.columngridObj.model.dataSource;if(t)for(i=this.columngridObj.model.selectedRowIndex,a=this.getGridElement(e),o=0;o<s.length;o++)o===i&&(s[o]=a);else s.push(this.getGridElement(e));this.selectedRow=null,this.columngridObj.dataSource(s,!0),this.disableToolbarItems(BoldBIDashboard.isNullOrUndefined(this.selectedRow)),this.columngridObj.refreshContent(!0)},e.prototype.editConditionalColumn=function(){"disabled"!==this.editIconDiv.attr("disabled")&&this.openColumnSettings(this.selectedRow.conditionalInfo,!0)},e.prototype.deleteConditionalColumn=function(){var e;"disabled"!==this.deleteIconDiv.attr("disabled")&&(-1<(e=this.columngridObj.model.selectedRowIndex)&&(this.columngridObj.model.dataSource.splice(e,1),this.columngridObj.refreshContent(!0),this.selectedRow=null),"disabled"!==this.editIconDiv.attr("disabled"))&&this.disableToolbarItems(!0)},e.prototype.disableToolbarItems=function(e){e?(this.editIconDiv.css({opacity:"0.5"}).attr("disabled","disabled"),this.deleteIconDiv.css({opacity:"0.5"}).attr("disabled","disabled")):(this.editIconDiv.css({opacity:"1"}).removeAttr("disabled"),this.deleteIconDiv.css({opacity:"1"}).removeAttr("disabled"))},e.prototype.openConditionalFormat=function(e,t,i){this.resetConditionalFormat(),this.targetInstance=e,this.targetMethod=t,this.conditionalFormats=i,this.columnFormatDialog.data("BoldBIDashboardDialog").open(),this.columngridObj.setModel({dataSource:this.getGridDataSource()}),0===this.columngridObj.model.dataSource.length?this.disableToolbarItems(!0):(this.disableToolbarItems(!1),this.columngridObj.setModel({selectedRowIndex:0})),this.columngridObj.refreshContent(!0)},e.prototype.resetConditionalFormat=function(){this.conditionalFormats=[],this.columngridObj.dataSource([],!0),this.columngridObj.refreshContent(!0),this.targetInstance=null,this.targetMethod=null,this.disableToolbarItems(!0)},e.prototype.getColumnConditionalInfo=function(){for(var e=[],t=this.columngridObj.model.dataSource,i=0;i<t.length;i++)e.push(t[i].conditionalInfo);return e},e.prototype.closeConditionalFormat=function(){var e=this.getColumnConditionalInfo();BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[e]),this.columnFormatDialog.data("BoldBIDashboardDialog").close())},e.prototype.renderConditionalSettings=function(){var e=this.settingsDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_conditional_settings"}),t=this.divContainer=BoldBIDashboard.buildTag("div","",{id:this.id+"_conditional_settings_div"}),i=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px","padding-top":"5px"},{id:this.id+"_conditional_settings_colInfo_table"}),a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Based On",{width:"122px","font-size":"12px"},{}),s=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),n=this.columnDetails=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colInfo"}),o=(s.append(n),a.append(o).append(s),i.append(a),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{id:this.id+"_conditional_settings_colorSetting_table"})),s=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Color Settings",{width:"122px","font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),d=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colorSetting"}),a=(r.append(d),s.append(a).append(r),o.append(s),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_formattingType_table"})),r=BoldBIDashboard.buildTag("tr","",{},{}),s=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Formatting Type",{width:"122px","font-size":"12px"},{}),l=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),h=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_formattingType"}),s=(l.append(h),r.append(s).append(l),a.append(r),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_grdntFormattingType_table"})),l=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Formatting Type",{width:"122px","font-size":"12px"},{}),p=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),c=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_grdntFormattingType"}),r=(p.append(c),l.append(r).append(p),s.append(l),t.append(i).append(o).append(a).append(s),this.renderMeasureConditionType(t),this.renderDimensionConditionType(t),this.renderColorPalette(t),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_caseSensitive_table"})),p=BoldBIDashboard.buildTag("tr","",{},{}),l=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","",{width:"122px","font-size":"12px"},{}),i=BoldBIDashboard.buildTag("td","",{}),o=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_conditional_settings_caseSensitive"}),a=(i.append(o),p.append(l).append(i),r.append(p),t.append(r),this.renderMeasureConditionValue(t),this.renderTextBox(t,"Value","dimension_value"),this.renderFontStyleContainer(t),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",display:"none"},{id:this.id+"_conditional_settings_pgcolor_table"})),s=BoldBIDashboard.buildTag("tr","",{},{}),l=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Background",{width:"122px","font-size":"12px"},{}),i=BoldBIDashboard.buildTag("td","",{},{}),p=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_bgcolor"}),r=(i.append(p),s.append(l).append(i),a.append(s),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",display:"none"},{id:this.id+"_conditional_settings_foreground_table"})),l=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Foreground",{width:"122px","font-size":"12px"},{}),s=BoldBIDashboard.buildTag("td","",{},{}),u=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_foreground"});s.append(u),l.append(i).append(s),r.append(l),this.renderTextBox(t,"Enter Column Title","column_title"),t.append(a).append(r),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_conditional_settings_okbtn",type:"button"}),s=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_conditional_settings_cancelbtn",type:"button"}),e.append(t),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({minWidth:360,minHeight:350,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",showFooter:!0,target:"#"+this.dashboardDesigner._id,containment:"#"+this.dashboardDesigner._id,title:"Grid Conditional Formatting",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.dashboardDesigner.element.find("#"+this.id+"_conditional_settings_foot").append(s,i),n.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"columnInfo.Value",value:"FieldType"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeColumnInfo,this)}),l=this.getColorList(),d.BoldBIDashboardDropDownList({dataSource:l,fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeColorSettings,this)}),c.BoldBIDashboardDropDownList({dataSource:this.formattingTypeList(!0),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeGradientFormatting,this)}),h.BoldBIDashboardDropDownList({dataSource:this.formattingTypeList(!1),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control"}),p.BoldBIDashboardColorPicker({value:"#2f79b5",cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown}),u.BoldBIDashboardColorPicker({cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown}),o.BoldBIDashboardCheckBox({text:"Case Sensitive",checked:!0,width:"35px",cssClass:"bbi-designer-case-sensitive"})},e.prototype.renderMeasureConditionType=function(e){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_measure_conditionType_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Condition Type",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),s=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_measure_conditionType"});o.append(s),i.append(a).append(o),t.append(i),e.append(t),s.BoldBIDashboardDropDownList({dataSource:this.measureConditionList(),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeMeasureCondition,this)})},e.prototype.renderDimensionConditionType=function(e){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_dimension_conditionType_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Condition Type",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),s=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_dimension_conditionType"});o.append(s),i.append(a).append(o),t.append(i),e.append(t),s.BoldBIDashboardDropDownList({dataSource:this.dimensionConditionList(),fields:{text:"text",value:"value"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control"})},e.prototype.renderFontStyleContainer=function(e){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_font_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Font",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"35px","padding-right":"4px"},{}),s=BoldBIDashboard.buildTag("input.bbi-dashboard-designer","",{},{type:"text",id:this.id+"_conditional_settings_fontColor"}),n=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),r=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-bold-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontBold"}),d=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),l=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-italic-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontItalic"}),h=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),p=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-underline-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontUnderLine"}),c=BoldBIDashboard.buildTag("td","",{width:"35px","padding-left":"3px","border-spacing":"0px"}),u=BoldBIDashboard.buildTag("span","",{width:"30px","text-align":"center",height:"27px",display:"table-cell","vertical-align":"middle"},{class:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic e-designer-font-strike-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor",id:this.id+"_conditional_settings_fontStrike"});o.append(s),n.append(r),d.append(l),h.append(p),c.append(u),i.append(a).append(o).append(n).append(d).append(h).append(c),t.append(i),e.append(t),r.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,r)),l.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,l)),p.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,p)),u.bind("click",this.bbdesigner$.proxy(this.selectFontStyleIcons,this,u)),s.BoldBIDashboardColorPicker({cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},e.prototype.renderColorPalette=function(e){var t=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_palette_table"}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Select Color Palette",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),s=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_conditional_settings_palettediv"}),n=BoldBIDashboard.buildTag("div","",{height:"18px",width:"155px",position:"absolute",margin:"4px 11px 0px 11px",background:"#ffffff"},{id:this.id+"_conditional_settings_palette_panel"}),r=this.colorPalette=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_colorPalette"});s.append(n).append(r),o.append(s),i.append(a).append(o),t.append(i),e.append(t),r.BoldBIDashboardDropDownList({dataSource:this.gradientList(),fields:{value:"gradient"},selectedIndex:0,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-designer-colorpalette bbi-dbrd-control",template:'<div style="height:18px;width:178px;background:${gradient}"></div>',change:this.bbdesigner$.proxy(this.updatePalettePanel,this)}),n.css("background","linear-gradient(to right, #A8E1F4 0%, #0D7CBD 100%)")},e.prototype.renderTextBox=function(e,t,i){var a=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_"+i+"_table"}),o=BoldBIDashboard.buildTag("tr","",{},{}),t=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",t,{width:"122px","font-size":"12px"},{}),s=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),i=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_conditional_settings_"+i});s.append(i),o.append(t).append(s),a.append(o),e.append(a),i.BoldBIDashboardMaskEdit({inputMode:BoldBIDashboard.InputMode.Text,width:"200px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border"})},e.prototype.renderMeasureConditionValue=function(e){var t=this.measureConditionValues=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px",display:"none"},{id:this.id+"_conditional_settings_measurevalue_table"}),i=this.bbdesigner$("<tr></tr>"),a=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Values",{width:"122px","font-size":"12px"},{}),o=BoldBIDashboard.buildTag("td","",{},{}),s=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_conditional_settings_text1"}),n=(o.append(s),BoldBIDashboard.buildTag("td","",{width:"33px"},{})),r=this.textDiv=BoldBIDashboard.buildTag("div","",{"padding-left":"10px",display:"none"}),d=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","&",{"font-size":"12px"},{type:"label"}),l=BoldBIDashboard.buildTag("td","",{height:"28px"},{}),h=this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{display:"none"},{id:this.id+"_conditional_settings_rightText_div"}),p=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_conditional_settings_text2"});l.append(h),h.append(p),r.append(d),n.append(r),i.append(a).append(o).append(n).append(l),t.append(i),e.append(t),s.ejNumericTextbox({decimalPlaces:2,value:0,width:"80px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,s)}),p.ejNumericTextbox({decimalPlaces:2,value:0,width:"80px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,p)})},e.prototype.changeTextBoxValue=function(e,t){BoldBIDashboard.isNullOrUndefined(t.value)&&e.data("ejNumericTextbox").setModel({value:0})},e.prototype.selectFontStyleIcons=function(e){this.hasSelectionClass(e)?e.removeClass("bbi-designer-fontstyle-selection"):e.addClass("bbi-designer-fontstyle-selection")},e.prototype.updatePalettePanel=function(e){this.divContainer.find("#"+this.id+"_conditional_settings_palette_panel").css("background",e.value)},e.prototype.changeMeasureCondition=function(e){"Between"===e.value?(this.textDiv.css("display","block"),this.rightTextBoxDiv.css("display","block")):(this.textDiv.css("display","none"),this.rightTextBoxDiv.css("display","none"))},e.prototype.changeGradientFormatting=function(e){this.showGradientFormatting(e.value)},e.prototype.showGradientFormatting=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_foreground_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_column_title_table");e===ConditionalFormatType.Indication.toString()?(t.css("display","none"),i.css("display","block")):(t.css("display","block"),i.css("display","none"))},e.prototype.changeColorSettings=function(e){this.showColorSettings(e.value)},e.prototype.showColorSettings=function(e){e===ColorType[ColorType.GradientColor]?(this.showSingleColorElements(!1),this.showGradientColorElements(!0)):e===ColorType[ColorType.SingleColor]?(this.showGradientColorElements(!1),this.showSingleColorElements(!0)):(this.showGradientColorElements(!1),this.showSingleColorElements(!1))},e.prototype.showSingleColorElements=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType_table"),a=this.divContainer.find("#"+this.id+"_conditional_settings_measurevalue_table"),o=this.divContainer.find("#"+this.id+"_conditional_settings_font_table"),s=this.divContainer.find("#"+this.id+"_conditional_settings_pgcolor_table");e?(t.css("display","block"),i.css("display","block"),a.css("display","block"),o.css("display","block"),s.css("display","block")):(t.css("display","none"),i.css("display","none"),a.css("display","none"),o.css("display","none"),s.css("display","none"))},e.prototype.showGradientColorElements=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType"),i=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType_table"),a=this.divContainer.find("#"+this.id+"_conditional_settings_palette_table"),o=this.divContainer.find("#"+this.id+"_conditional_settings_foreground_table"),s=this.divContainer.find("#"+this.id+"_conditional_settings_column_title_table");e?(i.css("display","block"),a.css("display","block"),e=t.data("BoldBIDashboardDropDownList").getSelectedValue(),this.showGradientFormatting(e)):(i.css("display","none"),a.css("display","none"),o.css("display","none"),s.css("display","none"))},e.prototype.changeColumnInfo=function(e){var t;e.selectedValue===FieldType[FieldType.Measures]?(t=this.columnDetails.data("BoldBIDashboardDropDownList").getListData()[this.columnDetails.data("BoldBIDashboardDropDownList").model.selectedIndex].columnInfo.Value,this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").setModel({value:t}),this.showDimensionElements(!1),this.showMeasureElements(!0)):e.selectedValue===FieldType[FieldType.Dimensions]&&(this.showMeasureElements(!1),this.showDimensionElements(!0))},e.prototype.showMeasureElements=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting");e?(t.css("display","block"),e=i.data("BoldBIDashboardDropDownList").getSelectedValue(),this.showColorSettings(e)):(t.css("display","none"),this.showColorSettings(""))},e.prototype.showDimensionElements=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType_table"),i=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType_table"),a=this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive_table"),o=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value_table"),s=this.divContainer.find("#"+this.id+"_conditional_settings_font_table"),n=this.divContainer.find("#"+this.id+"_conditional_settings_pgcolor_table");e?(t.css("display","block"),i.css("display","block"),a.css("display","block"),o.css("display","block"),s.css("display","block"),n.css("display","block")):(t.css("display","none"),i.css("display","none"),a.css("display","none"),o.css("display","none"),s.css("display","none"),n.css("display","none"))},e.prototype.createConditionalSetting=function(){return{GradDarkColor:"",TargetMeasureColumn:Column,MeasureConditionType:MeasureConditionType.Equals,DimensionConditionType:DimensionConditionType.Equals,Name:"",MappingColor:"",IsCaseSensitive:!0,GradLightColor:"",SelectedColorPalette:"",Value:0,FormatType:ConditionalFormatType.Column,EndValue:0,DisplayExpression:"",ColumnName:"",ColorStyle:ColorType.SingleColor,Styles:{FontFormats:{TextColor:"",IsBold:!1,IsItalic:!1,IsUnderline:!1,IsStrikethrough:!1},BackgroundColor:""},Text:""}},e.prototype.getConditionSettingsInfo=function(){var e=this.createConditionalSetting(),t=this.columnDetails.data("BoldBIDashboardDropDownList").getListData()[this.columnDetails.data("BoldBIDashboardDropDownList").model.selectedIndex].columnInfo,i=(e.TargetMeasureColumn={ColumnType:t.FieldType,UniqueColumnName:t.UniqueColumnName,DisplayName:t.Value},e.Name=BoldBIDashboard.getGuid("ConditionalFormatting_"),i=(i=this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList")).getItemDataByValue(i.getSelectedValue())[0],e.ColorStyle=i.value,e.ColumnName=e.TargetMeasureColumn.DisplayName,e.ColorStyle===ColorType[ColorType.SingleColor]?e.FormatType=this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").getSelectedValue():e.ColorStyle===ColorType[ColorType.GradientColor]&&(e.FormatType=this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").getSelectedValue()),e.IsCaseSensitive=this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").model.checked,e.Styles.BackgroundColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").getColor()),e.ColorStyle===ColorType[ColorType.GradientColor]&&(e.Styles.FontFormats.TextColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").getColor())),i=this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList"),e.SelectedColorPalette=i.getSelectedValue(),e.GradLightColor=e.ColorStyle===ColorType[ColorType.GradientColor]?i.model.dataSource[i.model.selectedIndex].startValue:"",e.GradDarkColor=e.ColorStyle===ColorType[ColorType.GradientColor]?i.model.dataSource[i.model.selectedIndex].endValue:"",this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList")),i=i.getItemDataByValue(i.getSelectedValue())[0],a=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList"),a=a.getItemDataByValue(a.getSelectedValue())[0];return t.FieldType===FieldType[FieldType.Measures]?e.MeasureConditionType=i.value:e.DimensionConditionType=a.value,this.getFontFormatValues(e),"block"===this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value_table").css("display")?(t=this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),e.Text=!BoldBIDashboard.isNullOrUndefined(t)&&0<t.length?t:"",e.Value=0):(i=this.divContainer.find("#"+this.id+"_conditional_settings_text1").data("ejNumericTextbox").getValue(),e.Value=i,a=this.divContainer.find("#"+this.id+"_conditional_settings_text2").data("ejNumericTextbox").getValue(),e.EndValue=BoldBIDashboard.isNullOrUndefined(a)?0:a),e},e.prototype.getFontFormatValues=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor"),i=this.divContainer.find("#"+this.id+"_conditional_settings_fontBold"),a=this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic"),o=this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike"),s=this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine");e.ColorStyle.toString()===ColorType[ColorType.SingleColor]&&(e.Styles.FontFormats.TextColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.data("BoldBIDashboardColorPicker").getColor())),e.Styles.FontFormats.IsBold=this.hasSelectionClass(i),e.Styles.FontFormats.IsItalic=this.hasSelectionClass(a),e.Styles.FontFormats.IsUnderline=this.hasSelectionClass(s),e.Styles.FontFormats.IsStrikethrough=this.hasSelectionClass(o)},e.prototype.hasSelectionClass=function(e){return e.hasClass("bbi-designer-fontstyle-selection")},e.prototype.removeSelectionClass=function(e){e.hasClass("bbi-designer-fontstyle-selection")&&e.removeClass("bbi-designer-fontstyle-selection")},e.prototype.resetFontStyle=function(){var e=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor");this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontBold")),this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic")),this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike")),this.removeSelectionClass(this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine")),e.data("BoldBIDashboardColorPicker").setModel({value:"#ffffff"})},e.prototype.updateFontStyleSelection=function(e){var t=this.divContainer.find("#"+this.id+"_conditional_settings_fontColor"),i=this.divContainer.find("#"+this.id+"_conditional_settings_fontBold"),a=this.divContainer.find("#"+this.id+"_conditional_settings_fontItalic"),o=this.divContainer.find("#"+this.id+"_conditional_settings_fontStrike"),s=this.divContainer.find("#"+this.id+"_conditional_settings_fontUnderLine");this.resetFontStyle(),BoldBIDashboard.isNullOrUndefined(e)||(t.data("BoldBIDashboardColorPicker").setModel({value:e.Styles.FontFormats.TextColor}),e.Styles.FontFormats.IsBold&&i.addClass("bbi-designer-fontstyle-selection"),e.Styles.FontFormats.IsItalic&&a.addClass("bbi-designer-fontstyle-selection"),e.Styles.FontFormats.IsStrikethrough&&o.addClass("bbi-designer-fontstyle-selection"),e.Styles.FontFormats.IsUnderline&&s.addClass("bbi-designer-fontstyle-selection"))},e.prototype.populateConditionalSettingInfo=function(e){var t,i,a,o,s;for(e.TargetMeasureColumn.ColumnType===FieldType[FieldType.Dimensions]?this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").setModel({value:e.Text}):(this.divContainer.find("#"+this.id+"_conditional_settings_text1").data("ejNumericTextbox").setModel({value:e.Value}),this.divContainer.find("#"+this.id+"_conditional_settings_text2").data("ejNumericTextbox").setModel({value:e.EndValue})),t=null,i=this.columnDetails.data("BoldBIDashboardDropDownList").model.dataSource,s=0;s<i.length;s++)if(i[s].DataField.toLowerCase()===e.TargetMeasureColumn.DisplayName.toLowerCase()){t=s;break}for(this.columnDetails.data("BoldBIDashboardDropDownList").setModel({selectedIndex:t}),this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList").selectItemByValue(e.ColorStyle),this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").setModel({value:e.ColumnName}),this.updateFontStyleSelection(e),e.ColorStyle===ColorType[ColorType.SingleColor]?this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").selectItemByValue(e.FormatType):e.ColorStyle===ColorType[ColorType.GradientColor]&&this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").selectItemByValue(e.FormatType),this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").setModel({checked:e.IsCaseSensitive}),this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").setModel({value:e.Styles.BackgroundColor}),this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").setModel({value:e.Styles.FontFormats.TextColor}),a=null,o=this.gradientList(),s=0;s<o.length;s++)o[s].startValue===e.GradLightColor&&o[s].endValue===e.GradDarkColor&&(a=o[s].gradient);this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList").setModel({value:a}),this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList").selectItemByValue(e.MeasureConditionType),this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList").selectItemByValue(e.DimensionConditionType)},e.prototype.resetConditionalSetting=function(){var e;for(this.isEdit=!1,this.conditionalInfo=null,this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").data("BoldBIDashboardMaskEdit").model.value="",e=0;e<2;e++)this.divContainer.find("#"+this.id+"_conditional_settings_text"+(e+1)).data("ejNumericTextbox").setModel({value:0});this.divContainer.find("#"+this.id+"_conditional_settings_colorSetting").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_column_title").data("BoldBIDashboardMaskEdit").model.value="",this.divContainer.find("#"+this.id+"_conditional_settings_formattingType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_grdntFormattingType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_bgcolor").data("BoldBIDashboardColorPicker").setModel({value:"#2f79b5"}),this.divContainer.find("#"+this.id+"_conditional_settings_foreground").data("BoldBIDashboardColorPicker").setModel({value:"#ffffff"}),this.divContainer.find("#"+this.id+"_conditional_settings_colorPalette").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_measure_conditionType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_dimension_conditionType").data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.divContainer.find("#"+this.id+"_conditional_settings_dimension_value").val(""),this.divContainer.find("#"+this.id+"_conditional_settings_caseSensitive").data("BoldBIDashboardCheckBox").option("checked",!0),this.resetFontStyle()},e.prototype.getBasedOnColumnDetails=function(){for(var e,t,i,a,o=[],s=this.dashboardDesigner.designerPanel.selectedReportItems,s=BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.bbdesigner$(s[0])),n=s.DataGroupInfo.FieldContainers,r=s.DataGroupInfo.DataSourceID,d=this.dashboardDesigner.modules.dataSet.datasets,l=[],h=0;h<d.length;h++)r===d[h].Id&&(l=d[h].Fields);for(e=0;e<n.length;e++)for(t=0;t<n[e].FieldInfos.length;t++)for(i=n[e].FieldInfos,a=0;a<l.length;a++)i[t].DataField!==l[a].Name||this.isDateTimeType(l[a].TypeName)||o.push({DataField:i[t].Value,Value:i[t].DataField,FieldType:i[t].FieldType,columnInfo:i[t]});return o},e.prototype.isDateTimeType=function(e){e=e?e.toLowerCase():"";return"datetime"===e||"smalldatetime"===e||"system.datetime"===e||"system.timespan"===e||"date"===e},e.prototype.openColumnSettings=function(e,t){this.resetConditionalSetting(),this.isEdit=t,this.conditionalInfo=e,this.settingsDialog.data("BoldBIDashboardDialog").open();t=this.getBasedOnColumnDetails();this.columnDetails.data("BoldBIDashboardDropDownList").setModel({dataSource:t}),BoldBIDashboard.isNullOrUndefined(e)?this.columnDetails.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}):this.populateConditionalSettingInfo(e)},e.prototype.closeConditionalSettings=function(){this.settingsDialog.data("BoldBIDashboardDialog").close()},e.prototype.saveConditionalSettings=function(){var e=this.getConditionSettingsInfo();this.updateGridData(e,this.isEdit),this.settingsDialog.data("BoldBIDashboardDialog").close()},e.prototype.destroy=function(){this.unWireEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.settingsDialog),0<this.settingsDialog.length&&this.settingsDialog.remove()},e.prototype.formattingTypeList=function(){return[{text:"Column",value:"Column"},{text:"Row",value:"Row"}]},e.prototype.measureConditionList=function(){var e=[];return e.push({value:MeasureConditionType[MeasureConditionType.Equals],text:MeasureConditionType.Equals}),e.push({value:MeasureConditionType[MeasureConditionType.NotEquals],text:MeasureConditionType.NotEquals}),e.push({value:MeasureConditionType[MeasureConditionType.GreaterThan],text:MeasureConditionType.GreaterThan}),e.push({value:MeasureConditionType[MeasureConditionType.GreaterThanOrEqual],text:MeasureConditionType.GreaterThanOrEqual}),e.push({value:MeasureConditionType[MeasureConditionType.LessThan],text:MeasureConditionType.LessThan}),e.push({value:MeasureConditionType[MeasureConditionType.LessThanOrEqual],text:MeasureConditionType.LessThanOrEqual}),e.push({value:MeasureConditionType[MeasureConditionType.Between],text:MeasureConditionType.Between}),e},e.prototype.dimensionConditionList=function(){var e=[];return e.push({value:DimensionConditionType[DimensionConditionType.Equals],text:DimensionConditionType.Equals}),e.push({value:DimensionConditionType[DimensionConditionType.NotEquals],text:DimensionConditionType.NotEquals}),e.push({value:DimensionConditionType[DimensionConditionType.Contains],text:DimensionConditionType.Contains}),e.push({value:DimensionConditionType[DimensionConditionType.NotContains],text:DimensionConditionType.NotContains}),e.push({value:DimensionConditionType[DimensionConditionType.StartsWith],text:DimensionConditionType.StartsWith}),e.push({value:DimensionConditionType[DimensionConditionType.EndsWith],text:DimensionConditionType.EndsWith}),e},e.prototype.getColorList=function(){var e=[];return e.push({value:ColorType[ColorType.SingleColor],text:ColorType.SingleColor}),e.push({value:ColorType[ColorType.GradientColor],text:ColorType.GradientColor}),e},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_conditional_settings_okbtn",this.bbdesigner$.proxy(this.saveConditionalSettings,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_conditional_settings_cancelbtn",this.bbdesigner$.proxy(this.closeConditionalSettings,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_conditional_settings_okbtn",this.bbdesigner$.proxy(this.saveConditionalSettings,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_conditional_settings_cancelbtn",this.bbdesigner$.proxy(this.closeConditionalSettings,this))},e.prototype.gradientList=function(){return[{gradient:"linear-gradient(to right, #A8E1F4 0%, #0D7CBD 100%)",startValue:"#A8E1F4",endValue:"#0D7CBD"},{gradient:"linear-gradient(to right, #C0E662 0%, #007500 100%)",startValue:"#C0E662",endValue:"#007500"},{gradient:"linear-gradient(to right, #FFA76B 0%, #9E2B49 100%)",startValue:"#FFA76B",endValue:"#9E2B49"},{gradient:"linear-gradient(to right, #A8E1F4 0%, #FF712F 100%)",startValue:"#A8E1F4",endValue:"#FF712F"},{gradient:"linear-gradient(to right, #EED2EE 0%, #B877D2 100%)",startValue:"#EED2EE",endValue:"#B877D2"}]},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ConditionalFormat",InternalConditionalFormat,window),InternalDimensionFilter=function(){function e(e){this.dashboardDesigner=null,this.id=null,this.targetItem=null,this.filterContainer=null,this.listContainer=null,this.conditionContainer=null,this.rankContainer=null,this.conditionCheckBox=null,this.conditionColumnDropDown=null,this.conditionSummaryDropDown=null,this.conditionTypeDropDown=null,this.leftTextBox=null,this.rightTextBox=null,this.labelDiv=null,this.rightTextBoxDiv=null,this.modifiedConditionalFilter=!1,this.isConditionFilteringApplied=!1,this.columnName=null,this.columnId=null,this.summaryType=null,this.conditionSummaryType=null,this.leftValue=0,this.rightValue=0,this.rankCheckBox=null,this.rankModeDropDown=null,this.rankCountUpDown=null,this.rankColumnDropDown=null,this.dateTimeCheckBox=null,this.rankFormatDropDown=null,this.modifiedTopNFilter=!1,this.isTopNFilteringApplied=!1,this.mode="Top",this.numberOfRecords=5,this.rankColumnName=null,this.rankColumnId=null,this.dataFieldItems=[],this.measuresList=[],this.dimensionsList=[],this.dateTimeFormats=[],this.timeFormats=[],this.dimensionFormats=[],this.measureFormats=[],this.conditionTypes=[],this.modeTypes=[],this.targetInstance=null,this.targetMethod="",this.dataSetName="",this.filterInfo=null,this.fieldDetails=null,this.ejFilterDialog=null,this.isDataHigh=!1,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.id=this.dashboardDesigner._id,this.dateRangePopup=this.dashboardDesigner.modules.dateRangePopup,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.multiSelectionComboBox=new BoldBIDashboard.DashboardDesignerUtility.MultiSelectionComboBox(this.dashboardDesigner),this.dateTimeFormats=this.getDateFormatsList(),this.timeFormats=this.getTimeFormatsList(),this.dimensionFormats=this.getSummaryTypeArrayforDimension(),this.measureFormats=this.getmeasureFormatsList(),this.conditionTypes=this.getconditionTypes(),this.modeTypes=this.getRankModeList(),this.renderDimensionFilterWindow()}return e.prototype.getDateFormatsList=function(){var e=[];return e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Date],text:DateTimeFormatForFilter.Date}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DateTime],text:DateTimeFormatForFilter.DateTime}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Year],text:DateTimeFormatForFilter.Year}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Quarter],text:DateTimeFormatForFilter.Quarter}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Month],text:DateTimeFormatForFilter.Month}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.QuarterYear],text:DateTimeFormatForFilter.QuarterYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.MonthYear],text:DateTimeFormatForFilter.MonthYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekYear],text:DateTimeFormatForFilter.WeekYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DayOfWeek],text:DateTimeFormatForFilter.DayOfWeek}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekOfYear],text:DateTimeFormatForFilter.WeekOfYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Day],text:DateTimeFormatForFilter.Day}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Hour],text:DateTimeFormatForFilter.Hour}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Minute],text:DateTimeFormatForFilter.Minute}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Second],text:DateTimeFormatForFilter.Second}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Time],text:DateTimeFormatForFilter.Time}),e},e.prototype.getTimeFormatsList=function(){var e=[];return e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Hour],text:DateTimeFormatForFilter.Hour}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Minute],text:DateTimeFormatForFilter.Minute}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Second],text:DateTimeFormatForFilter.Second}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Time],text:DateTimeFormatForFilter.Time}),e},e.prototype.getmeasureFormatsList=function(){var e=[],t=this.dashboardDesigner.modules.util;return e.push({value:SummaryType.SUM,text:t.getSummaryTypeLocalizedText(SummaryType.SUM)}),e.push({value:SummaryType.AVG,text:t.getSummaryTypeLocalizedText(SummaryType.AVG)}),e.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),e.push({value:SummaryType.MAX,text:t.getSummaryTypeLocalizedText(SummaryType.MAX)}),e.push({value:SummaryType.MIN,text:t.getSummaryTypeLocalizedText(SummaryType.MIN)}),e.push({value:SummaryType.MEDIAN,text:t.getSummaryTypeLocalizedText(SummaryType.MEDIAN)}),e.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),e.push({value:SummaryType.VAR,text:t.getSummaryTypeLocalizedText(SummaryType.VAR)}),e},e.prototype.getconditionTypes=function(){var e=[];return e.push({value:NumberFilterOption.Equals,text:this.locale.dataconfiguration.numberFilterOption.equals}),e.push({value:NumberFilterOption.NotEquals,text:this.locale.dataconfiguration.numberFilterOption.notEquals}),e.push({value:NumberFilterOption.GreaterThan,text:this.locale.dataconfiguration.numberFilterOption.greaterThan}),e.push({value:NumberFilterOption.GreaterThanOrEquals,text:this.locale.dataconfiguration.numberFilterOption.greaterThanOrEquals}),e.push({value:NumberFilterOption.LessThan,text:this.locale.dataconfiguration.numberFilterOption.lessThan}),e.push({value:NumberFilterOption.LessThanOrEquals,text:this.locale.dataconfiguration.numberFilterOption.lessThanOrEquals}),e.push({value:NumberFilterOption.IsBetween,text:this.locale.dataconfiguration.numberFilterOption.between}),e.push({value:NumberFilterOption.IsNotBetween,text:this.locale.dataconfiguration.numberFilterOption.notBetween}),e},e.prototype.getSummaryTypeArrayforDimension=function(){var e,t=[],i=new ValueAliasPair;return i.text=SummaryType.COUNT.toString(),i.value=SummaryType[SummaryType.COUNT],(e=new ValueAliasPair).text=SummaryType.COUNTD.toString(),e.value=SummaryType[SummaryType.COUNTD],t.push(i),t.push(e),t},e.prototype.getRankModeList=function(){var e,t=[],i=new ValueAliasPair;return i.text=RankType.Top.toString(),i.value=RankType[RankType.Top],(e=new ValueAliasPair).text=RankType.Bottom.toString(),e.value=RankType[RankType.Bottom],t.push(i),t.push(e),t},e.prototype.renderDimensionFilterWindow=function(){this.filterContainer=BoldBIDashboard.buildTag("div.bbi-userselect","",{width:"450px"},{id:this.id+"_dimension_filter"}),this.renderListContainer(),this.renderConditionContainer(),this.renderRankContainer(),this.filterContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:450,minHeight:200,maxWidth:450,title:"Filters",zIndex:1e4,enableResize:!1,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,showOnInit:!1,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-dimension-filter-dialog",enableModal:!0,beforeClose:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.renderFooter(),this.ejFilterDialog=this.filterContainer.data("BoldBIDashboardDialog")},e.prototype.renderListContainer=function(){this.listContainer=BoldBIDashboard.buildTag("div","",{width:"100%",height:"35px","border-bottom":"1px solid var(--designer-primary-border-color)",padding:"10px 0px"},{id:this.id+"_dimension_filter_list"});var e=BoldBIDashboard.buildTag("table","",{width:"100%",height:"100%",padding:"0px 15px"},{}),t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td","",{width:"40%"},{}),a=BoldBIDashboard.buildTag("td","",{width:"60%"},{id:this.id+"_dimension_filter_list_dropDownCell"}),o=BoldBIDashboard.buildTag("span","List",{});this.listContainer.append(e),e.append(t),t.append(i).append(a),i.append(o),this.filterContainer.append(this.listContainer),this.targetItem=BoldBIDashboard.buildTag("div","",{width:"245px",height:"100%"},{}),a.append(this.targetItem)},e.prototype.renderConditionContainer=function(){this.conditionContainer=BoldBIDashboard.buildTag("div","",{width:"100%",height:"100%",padding:"10px 0px"},{id:this.id+"_dimension_filter_condition"}),u=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{}),e=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{}),this.conditionContainer.append(u).append(e);var e,t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_condition_summary_row"}),o=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),s=(this.conditionCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_condition_checkBox"}),BoldBIDashboard.buildTag("label","Condition",{"margin-left":"10px"},{for:this.id+"_dimension_filter_condition_checkBox"})),n=BoldBIDashboard.buildTag("div.bbi-dbrd-dimension-info bbi-info-hide bbi-dbrd-designer-hoverable","",{},{id:this.id+"_dimension_filter-topn-info"}),r=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),d=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),l=BoldBIDashboard.buildTag("span","Column",{}),h=(this.conditionColumnDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_condition_columndropDown"}),BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{})),p=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),c=BoldBIDashboard.buildTag("span","Summary",{}),u=(this.conditionSummaryDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_condition_summarydropDown"}),u.append(t,i,a),t.append(o),o.append(this.conditionCheckBox,s,n),i.append(r,d),r.append(l),d.append(this.conditionColumnDropDown),a.append(h,p),h.append(c),p.append(this.conditionSummaryDropDown),BoldBIDashboard.buildTag("tr","",{},{})),t=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{colspan:"3"}),o=BoldBIDashboard.buildTag("td","",{width:"25%",padding:"5px 0px"},{colspan:"1"}),s=BoldBIDashboard.buildTag("td","",{width:"10%",padding:"5px 0px"},{colspan:"1"}),n=BoldBIDashboard.buildTag("td","",{width:"25%",padding:"5px 0px"},{colspan:"1"});this.conditionTypeDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_conditionType_dropDown"}),this.leftTextBox=BoldBIDashboard.buildTag("input","",{width:"100%"},{type:"text"}),this.labelDiv=BoldBIDashboard.buildTag("div","",{width:"100%",padding:"0px 5px",display:"none"}),i=BoldBIDashboard.buildTag("editLabel","and",{width:"100%"},{type:"label"}),this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{width:"100%",display:"none"}),this.rightTextBox=BoldBIDashboard.buildTag("input","",{width:"100%"},{type:"text"}),e.append(u),u.append(t,o,s,n),t.append(this.conditionTypeDropDown),o.append(this.leftTextBox),this.labelDiv.append(i),s.append(this.labelDiv),this.rightTextBoxDiv.append(this.rightTextBox),n.append(this.rightTextBoxDiv),this.filterContainer.append(this.conditionContainer),this.conditionCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateConditionCheck,this)}),this.conditionColumnDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionColumn,this)}),this.conditionSummaryDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionSummary,this)}),this.conditionTypeDropDown.BoldBIDashboardDropDownList({width:"85%",dataSource:this.conditionTypes,fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,selectedIndex:0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateConditionValue,this)}),this.conditionSummaryType=this.conditionTypes[0].value,this.leftTextBox.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.updateLeftTextBoxValue,this)}),this.rightTextBox.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.updateRightTextBoxValue,this)})},e.prototype.renderRankContainer=function(){this.rankContainer=BoldBIDashboard.buildTag("div.e-dbrd-dimension-top-n-container","",{width:"100%",height:"100%",padding:"10px 0px"},{id:this.id+"_dimension_filter_rank"}),e=BoldBIDashboard.buildTag("table","",{width:"100%",padding:"0px 15px"},{}),this.rankContainer.append(e);var e,t,i,a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("tr","",{},{}),s=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_rank_date_time_row"}),d=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_dimension_filter_rank_summary_row"}),l=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),h=(this.rankCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_rank_checkBox"}),BoldBIDashboard.buildTag("label","Rank",{"margin-left":"10px"},{for:this.id+"_dimension_filter_rank_checkBox"})),p=BoldBIDashboard.buildTag("div.bbi-dbrd-dimension-info bbi-info-hide bbi-dbrd-designer-hoverable","",{},{id:this.id+"_dimension_filter-topn-info"}),c=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),u=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),b=BoldBIDashboard.buildTag("span","Mode",{}),g=(this.rankModeDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankMode_dropDown"}),BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{})),m=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),f=BoldBIDashboard.buildTag("span","Count",{}),D=(this.rankCountUpDown=BoldBIDashboard.buildTag("input","",{},{type:"text"}),BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{})),y=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),B=BoldBIDashboard.buildTag("span","Column",{}),I=(this.rankColumnDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankColumn_dropDown"}),t=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),i=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),this.dateTimeCheckBox=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_dimension_filter_rank_datetime_checkBox"}),BoldBIDashboard.buildTag("label","Based On Date and Time",{"margin-left":"10px"},{for:this.id+"_dimension_filter_rank_datetime_checkBox"})),x=BoldBIDashboard.buildTag("td","",{width:"40%",padding:"5px 0px"},{}),_=BoldBIDashboard.buildTag("td","",{width:"60%",padding:"5px 0px"},{}),v=BoldBIDashboard.buildTag("span.e-summary_text","Summary",{});this.rankFormatDropDown=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_dimension_filter_rankFormat_dropDown"}),e.append(a,o,s,n,r,d),a.append(l),l.append(this.rankCheckBox,h,p),o.append(c).append(u),c.append(b),u.append(this.rankModeDropDown),s.append(g).append(m),g.append(f),m.append(this.rankCountUpDown),n.append(D).append(y),D.append(B),y.append(this.rankColumnDropDown),r.append(t).append(i),i.append(this.dateTimeCheckBox).append(I),d.append(x).append(_),x.append(v),_.append(this.rankFormatDropDown),this.filterContainer.append(this.rankContainer),this.rankCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateRankCheck,this)}),this.rankModeDropDown.BoldBIDashboardDropDownList({width:"100%",dataSource:this.modeTypes,fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateRankMode,this)}),this.rankCountUpDown.ejNumericTextbox({value:5,minValue:1,maxValue:1e10,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",width:"80px",change:this.bbdesigner$.proxy(this.updateRankCount,this)}),this.rankColumnDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateRankColumn,this)}),this.dateTimeCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateDateTimeValidation,this)}),this.rankFormatDropDown.BoldBIDashboardDropDownList({width:"100%",fields:{text:"text"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"})},e.prototype.renderFooter=function(){var e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_dimension_filter_ok_btn",type:"button"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_dimension_filter_cancel_btn",type:"button"});e.on("click",this.bbdesigner$.proxy(this.saveFilters,this)),t.on("click",this.bbdesigner$.proxy(this.closeFilterDialog,this)),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_foot").append(t,e)},e.prototype.updateConditionCheck=function(e){this.updateConditionFieldItemState(e.isChecked),this.modifiedConditionalFilter=!0,this.isConditionFilteringApplied=e.isChecked},e.prototype.updateConditionColumn=function(e){this.modifiedConditionalFilter=!0,this.columnName=e.text,this.columnId=e.value;e="Dimensions"===this.getItemType(this.columnId)?this.dimensionFormats:this.measureFormats;this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(e[0].value)},e.prototype.updateConditionSummary=function(e){this.modifiedConditionalFilter=!0,this.summaryType=e.value},e.prototype.updateConditionValue=function(e){e=e.value;NumberFilterOption.IsBetween===NumberFilterOption[e]||NumberFilterOption.IsNotBetween===NumberFilterOption[e]?this.showConditionElement(!0):this.showConditionElement(!1),this.modifiedConditionalFilter=!0,this.conditionSummaryType=e},e.prototype.showConditionElement=function(e){this.labelDiv.css("display",e?"block":"none"),this.rightTextBoxDiv.css("display",e?"block":"none")},e.prototype.updateLeftTextBoxValue=function(e){this.modifiedConditionalFilter=!0,this.leftValue=e.value},e.prototype.updateRightTextBoxValue=function(e){this.modifiedConditionalFilter=!0,this.rightValue=e.value},e.prototype.updateConditionFieldItemState=function(e){e?(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").enable(),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").enable(),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").enable(),this.leftTextBox.data("ejNumericTextbox").enable(),this.rightTextBox.data("ejNumericTextbox").enable()):(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").disable(),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").disable(),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").disable(),this.leftTextBox.data("ejNumericTextbox").disable(),this.rightTextBox.data("ejNumericTextbox").disable())},e.prototype.updateRankCheck=function(e){this.updateRankFieldItemState(e.isChecked),this.modifiedTopNFilter=!0,this.isTopNFilteringApplied=e.isChecked},e.prototype.updateRankMode=function(e){this.modifiedTopNFilter=!0,this.mode=e.value},e.prototype.updateRankCount=function(e){this.modifiedTopNFilter=!0,this.numberOfRecords=e.value},e.prototype.updateRankColumn=function(e){this.modifiedTopNFilter=!0,this.rankColumnName=e.text,this.rankColumnId=e.value;var t,e=this.isDateField(this.rankColumnId),i=this.isTimeField(this.rankColumnId),a=this.getItemType(this.rankColumnId),o=this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked();e||i?(t=o?e?this.dateTimeFormats:this.timeFormats:this.dimensionFormats,this.rankContainer.find("#"+this.id+"_dimension_filter_rank_date_time_row").css("display",""),i=o?"Format":"Summary",this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text").text(i)):(this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),t="Dimensions"===a?this.dimensionFormats:this.measureFormats,this.rankContainer.find("#"+this.id+"_dimension_filter_rank_date_time_row").css("display","none"),this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text").text("Summary")),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:t}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)},e.prototype.updateDateTimeValidation=function(e){var t,i=this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").find(".e-summary_text");this.modifiedTopNFilter=!0,t=this.isDateField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),e.isChecked?(i.text("Format"),t?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dateTimeFormats}):this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.timeFormats})):(i.text("Summary"),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dimensionFormats})),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0)},e.prototype.updateRankFieldItemState=function(e){e?(this.rankModeDropDown.data("BoldBIDashboardDropDownList").enable(),this.rankCountUpDown.data("ejNumericTextbox").enable(),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").enable(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").enable(),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").enable()):(this.rankModeDropDown.data("BoldBIDashboardDropDownList").disable(),this.rankCountUpDown.data("ejNumericTextbox").disable(),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").disable(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").disable(),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").disable())},e.prototype.openDimensionFilterWindow=function(e,t,i,a,o,s){this.isDataHigh=!0===s,this.ejFilterDialog.open(),this.resetFilter(),this.targetInstance=e,this.targetMethod=t,this.fieldDetails=i,this.dataSetName=this.fieldDetails.DatasourceID,this.filterInfo=BoldBIDashboard.isNullOrUndefined(a)?new DimensionFilterInfo:this.bbdesigner$.extend(!0,this.filterInfo,a),s=this.dashboardDesigner.modules.dataSet,e=o.beforeUtilityDialogOpen(this.getDimensionUIModel(),"dimensionFilterDialog",i),BoldBIDashboard.isNullOrUndefined(s)||BoldBIDashboard.isNullOrUndefined(e)||(t=s.datasets.find(function(e){return e.Id===i.DatasourceID}),BoldBIDashboard.isNullOrUndefined(t))||BoldBIDashboard.isNullOrUndefined(t.TreeViewData)||(e.TopNFilter.Summary.Visibility=!1,e.ConditionalFilter.Summary.Visibility=!1),o={filters:[],fieldInfo:this.fieldDetails,filterInfo:a},this.fieldDetails.DateTimeFormat===DateTimeFormat.Date||this.fieldDetails.DateTimeFormat===DateTimeFormat.Default&&"bbi-designer-dataset-time"!==this.fieldDetails.FieldActualType?(s=BoldBIDashboard.isNullOrUndefined(a)||BoldBIDashboard.isNullOrUndefined(a.AllowFilterInfo)||BoldBIDashboard.isNullOrUndefined(a.AllowFilterInfo.DateFilterInfo)?null:a.AllowFilterInfo.DateFilterInfo,0<this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").length?this.dateRangePopup.populateDateRangeDrpDwn(this.id+"_dimension_filter_date",this.targetItem,this.dataSetName,{Id:this.fieldDetails.Id,Name:this.fieldDetails.Name},s,"DimensionFilter",this.targetItem.width()):this.dateRangePopup.renderDateRangeDrpDwn(this.id+"_dimension_filter_date",this.targetItem,this.dataSetName,{Id:this.fieldDetails.Id,Name:this.fieldDetails.Name},s,"DimensionFilter",this.targetItem.width()),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").css("display","block")):(0<this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").length&&this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").css("display","none"),this.multiSelectionComboBox.renderMultiSelectionComboBox(this.targetItem,this.id+"_dimension_filter",this.fieldDetails.DatasourceID,o),t=BoldBIDashboard.isNullOrUndefined(a)||BoldBIDashboard.isNullOrUndefined(a.AllowFilterInfo)?null:a.AllowFilterInfo,this.multiSelectionComboBox.populateMultiSelectionItem(this.id+"_dimension_filter",t)),this.populateFilterValues(e),this.updateUtilityModel(e),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_condition").css("display",i.IsFilterColumn?"none":"")},e.prototype.updateUtilityModel=function(e){this.updateTopNModel(e.TopNFilter),this.updateConditionModel(e.ConditionalFilter)},e.prototype.updateTopNModel=function(e){e.Rank.Enable?this.rankCheckBox.data("BoldBIDashboardCheckBox").enable():this.rankCheckBox.data("BoldBIDashboardCheckBox").disable(),this.isTopNFilteringApplied&&(e.Mode.Enable?this.rankModeDropDown.data("BoldBIDashboardDropDownList").enable():this.rankModeDropDown.data("BoldBIDashboardDropDownList").disable(),e.Count.Enable?this.rankCountUpDown.data("ejNumericTextbox").enable():this.rankCountUpDown.data("ejNumericTextbox").disable(),e.Column.Enable?this.rankColumnDropDown.data("BoldBIDashboardDropDownList").enable():this.rankColumnDropDown.data("BoldBIDashboardDropDownList").disable(),e.Summary.Enable?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").enable():this.rankFormatDropDown.data("BoldBIDashboardDropDownList").disable(),this.rankCountUpDown.data("ejNumericTextbox").option("minValue",1),this.rankCountUpDown.data("ejNumericTextbox").option("maxValue",1e10)),e.Summary.Visibility?this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").css("display","contents"):this.rankContainer.find("#"+this.id+"_dimension_filter_rank_summary_row").css("display","none"),""!==e.InfoText.trim()?this.rankContainer.find(".bbi-dbrd-dimension-info").addClass("bbi-info-show").removeClass("bbi-info-hide").attr("data-tooltip",e.InfoText):this.rankContainer.find(".bbi-dbrd-dimension-info").removeClass("bbi-info-show").addClass("bbi-info-hide").removeAttr("data-tooltip")},e.prototype.updateConditionModel=function(e){e.Condition.Enable?this.conditionCheckBox.data("BoldBIDashboardCheckBox").enable():this.conditionCheckBox.data("BoldBIDashboardCheckBox").disable(),this.isConditionFilteringApplied&&(e.Column.Enable?this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").enable():this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").disable(),e.Summary.Enable?this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").enable():this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").disable()),""!==e.InfoText.trim()?this.conditionContainer.find(".bbi-dbrd-dimension-info").addClass("bbi-info-show").removeClass("bbi-info-hide").attr("data-tooltip",e.InfoText):this.conditionContainer.find(".bbi-dbrd-dimension-info").removeClass("bbi-info-show").addClass("bbi-info-hide").removeAttr("data-tooltip"),e.Summary.Visibility?this.conditionContainer.find("#"+this.id+"_dimension_filter_condition_summary_row").css("display","contents"):this.conditionContainer.find("#"+this.id+"_dimension_filter_condition_summary_row").css("display","none")},e.prototype.getDimensionUIModel=function(){return{TopNFilter:this.getTopNModel(),ConditionalFilter:this.getConditionalModel(),AllowFilter:this.getAllowFilterModel()}},e.prototype.getTopNModel=function(){return{Rank:{Enable:!0},Mode:{Enable:!0},Count:{Enable:!0,MinValue:1,MaxValue:1e10},Column:{Enable:!0},Summary:{Enable:!0,Visibility:!0},DateTime:{Enable:!0},InfoText:""}},e.prototype.getConditionalModel=function(){return{Condition:{Enable:!0},Column:{Enable:!0},Summary:{Enable:!0,Visibility:!0},ConditionDropDown:{Enable:!0},ConditionValue:[{Enable:!0}],InfoText:""}},e.prototype.getAllowFilterModel=function(){return{List:{Enable:!0}}},e.prototype.resetFilter=function(){this.filterInfo=null,this.dataFieldItems=[],this.measuresList=[],this.dimensionsList=[],this.targetInstance=null,this.targetMethod=null},e.prototype.populateFilterValues=function(){this.updateDatasetFields(),this.populateConditionFields(),this.populateRankFields(),this.updateConditionFieldItemState(this.isConditionFilteringApplied),this.updateRankFieldItemState(this.isTopNFilteringApplied)},e.prototype.updateDatasetFields=function(){for(var e,t=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInsFromDSId(this.dashboardDesigner,this.dataSetName),t=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(t),i=this.dashboardDesigner.modules.dataSet.datasets,a=BoldBIDashboard.DashboardUtil.getCurrentField(i,this.dataSetName,t),o=0;o<a.length;o++)this.dataFieldItems.push({text:a[o].Name,value:a[o].Id}),("bbi-designer-dataset-number"===(e=BoldBIDashboard.DashboardUtil.getDatasetTypeIcon(a[o].TypeName))?this.measuresList:this.dimensionsList).push({Name:a[o].Name,DatasetIcon:e,DataField:a[o].Id})},e.prototype.getItemType=function(e){for(var t="",i=0;i<this.measuresList.length;i++)this.measuresList[i].DataField===e&&(t="Measures");for(i=0;i<this.dimensionsList.length;i++)this.dimensionsList[i].DataField===e&&(t="Dimensions");return t},e.prototype.isTimeField=function(e){for(var t=!1,i=0;i<this.dimensionsList.length;i++)this.dimensionsList[i].DataField===e&&"bbi-designer-dataset-time"===this.dimensionsList[i].DatasetIcon&&(t=!0);return t},e.prototype.isDateField=function(e){for(var t=!1,i=0;i<this.dimensionsList.length;i++)this.dimensionsList[i].DataField===e&&"bbi-designer-dataset-datetime"===this.dimensionsList[i].DatasetIcon&&(t=!0);return t},e.prototype.populateConditionFields=function(){var e;this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems}),this.filterInfo&&this.filterInfo.IsConditionFilteringApplied&&!BoldBIDashboard.isNullOrUndefined(this.filterInfo.ConditionFilterInfo)?(this.conditionCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.IsConditionFilteringApplied}),this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.ColumnId),e="Dimensions"===this.getItemType(this.filterInfo.ConditionFilterInfo.ColumnId)?this.dimensionFormats:this.measureFormats,this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.SummaryType),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.ConditionFilterInfo.ConditionSummaryType),this.filterInfo.ConditionFilterInfo.ConditionSummaryType===NumberFilterOption.IsBetween||this.filterInfo.ConditionFilterInfo.ConditionSummaryType===NumberFilterOption.IsNotBetween?(this.leftTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[0]}),this.rightTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[1]})):this.leftTextBox.data("ejNumericTextbox").setModel({value:this.filterInfo.ConditionFilterInfo.Values[0]}),this.modifiedConditionalFilter=!0,this.isConditionFilteringApplied=!0):(this.conditionCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),e="Dimensions"===this.getItemType(this.conditionColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue())?this.dimensionFormats:this.measureFormats,this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.conditionSummaryDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.conditionTypeDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.leftTextBox.data("ejNumericTextbox").setModel({value:0}),this.modifiedConditionalFilter=!1,this.isConditionFilteringApplied=!1)},e.prototype.populateRankFields=function(){var e,t,i,a,o;this.filterInfo.IsTopNFilteringApplied&&!BoldBIDashboard.isNullOrUndefined(this.filterInfo.TopNFilterInfo)?(this.rankCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.IsTopNFilteringApplied}),this.rankModeDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.TopNFilterInfo.Mode),this.rankCountUpDown.data("ejNumericTextbox").setModel({value:this.filterInfo.TopNFilterInfo.NoOfRecords}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(this.filterInfo.TopNFilterInfo.ColumnId),t=this.isDateField(this.filterInfo.TopNFilterInfo.ColumnId),i=this.isTimeField(this.filterInfo.TopNFilterInfo.ColumnId),a=this.getItemType(this.filterInfo.TopNFilterInfo.ColumnId),o=[],o=t||i?this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField?t?this.dateTimeFormats:this.timeFormats:this.dimensionFormats:"Dimensions"===a?this.dimensionFormats:this.measureFormats,this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField}),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:o}),e=(this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField?this.filterInfo.TopNFilterInfo.DateFormat:this.filterInfo.TopNFilterInfo.SummaryType).toString(),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByValue(e),this.isTopNFilteringApplied=!0):(this.rankCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.rankModeDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.rankCountUpDown.data("ejNumericTextbox").setModel({value:5}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dataFieldItems}),this.rankColumnDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),t=this.isDateField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),i=this.isTimeField(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()),t||i?(this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").setModel({checked:!0}),t?this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.dateTimeFormats}):this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.timeFormats})):(o="Dimensions"===(a=this.getItemType(this.rankColumnDropDown.data("BoldBIDashboardDropDownList").getSelectedValue()))?this.dimensionFormats:this.measureFormats,this.rankFormatDropDown.data("BoldBIDashboardDropDownList").setModel({dataSource:o})),this.rankFormatDropDown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.isTopNFilteringApplied=!1,this.modifiedTopNFilter=!1),this.rankCheckBox.data("BoldBIDashboardCheckBox").enable(),this.rankCountUpDown.data("ejNumericTextbox").setModel({maxValue:1e10})},e.prototype.saveFilters=function(){var e;if(null!==this.targetInstance&&!this.multiSelectionComboBox.isMultiSelectionPopupLoading()){this.filterInfo=new DimensionFilterInfo;var t=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter"),i=this.dateRangePopup.getDateRangeValues(this.id+"_dimension_filter_date"),a=[];if(this.checkDimensionFilterChange(),!t.IsCheckAll||!BoldBIDashboard.isNullOrUndefined(t.FilterValues)&&t.IsCheckAll&&this.multiSelectionComboBox.getPopupRadioButton2(this.id+"_dimension_filter").prop("checked")){for(this.filterInfo.IsAllowFilteringApplied=!0,this.filterInfo.AllowFilterInfo=new AllowFilteringInfo,this.filterInfo.AllowFilterInfo.IsCheckAll=t.IsCheckAll,this.filterInfo.AllowFilterInfo.IsInclude=t.IsInclude,this.filterInfo.AllowFilterInfo.IsDateFormatFilteringApplied=!1,this.filterInfo.AllowFilterInfo.CheckAllState=t.CheckAllState,e=0;e<t.FilterValues.length;e++)void 0===t.FilterValues[e].value?a.push(t.FilterValues[e]):a.push(t.FilterValues[e].value);this.filterInfo.AllowFilterInfo.FilterValues=a}this.fieldDetails.DateTimeFormat!==DateTimeFormat.Date&&this.fieldDetails.DateTimeFormat!==DateTimeFormat.Default||!i.IsFilterApplied||BoldBIDashboard.isNullOrUndefined(i.StartDate)||BoldBIDashboard.isNullOrUndefined(i.EndDate)||(this.filterInfo.IsAllowFilteringApplied=!0,BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo)&&(this.filterInfo.AllowFilterInfo=new AllowFilteringInfo),this.filterInfo.AllowFilterInfo.IsDateFormatFilteringApplied=!0,this.filterInfo.AllowFilterInfo.DateFilterInfo=new DateRangeFilterInfo,this.filterInfo.AllowFilterInfo.DateFilterInfo.DateFormatCondition=i.DateFormatCondition,this.filterInfo.AllowFilterInfo.DateFilterInfo.StartDate=i.StartDate,this.filterInfo.AllowFilterInfo.DateFilterInfo.EndDate=i.EndDate),this.modifiedConditionalFilter&&(this.filterInfo.IsConditionFilteringApplied=this.isConditionFilteringApplied,this.filterInfo.ConditionFilterInfo=new ConditionFilteringInfo,this.filterInfo.ConditionFilterInfo.ColumnName=this.columnName,this.filterInfo.ConditionFilterInfo.ColumnId=this.columnId,this.filterInfo.ConditionFilterInfo.SummaryType=this.summaryType,this.filterInfo.ConditionFilterInfo.ConditionSummaryType=this.conditionSummaryType,this.filterInfo.ConditionFilterInfo.Values[0]=this.leftValue.toString(),this.filterInfo.ConditionFilterInfo.Values[1]=this.rightValue.toString()),this.modifiedTopNFilter&&(this.filterInfo.IsTopNFilteringApplied=this.isTopNFilteringApplied,this.filterInfo.TopNFilterInfo=new TopNFilteringInfo,this.filterInfo.TopNFilterInfo.Mode=this.mode,this.filterInfo.TopNFilterInfo.NoOfRecords=this.numberOfRecords,this.filterInfo.TopNFilterInfo.ColumnName=this.rankColumnName,this.filterInfo.TopNFilterInfo.ColumnId=this.rankColumnId,i=this.widgetHelper.getCurrentWidgetInstance().getJson().FilterSettings,this.filterInfo.TopNFilterInfo.IsHierarchicalFilter=!!BoldBIDashboard.isNullOrUndefined(i)||i.HierarchicalFilter,this.filterInfo.TopNFilterInfo.IsBasedOnDateAndTimeField=this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked(),this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()?(i=this.rankFormatDropDown.data("BoldBIDashboardDropDownList").getSelectedValue(),this.filterInfo.TopNFilterInfo.DateFormat=i):(i=this.rankFormatDropDown.data("BoldBIDashboardDropDownList").getSelectedValue(),this.filterInfo.TopNFilterInfo.SummaryType=i)),this.filterInfo.IsAllowFilteringApplied||this.filterInfo.IsConditionFilteringApplied||this.filterInfo.IsTopNFilteringApplied||(this.filterInfo=null),i=[this.filterInfo,this.fieldDetails],BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,i),this.closeFilterDialog()}},e.prototype.closeFilterDialog=function(e){e&&this.isDataHigh&&(e=this.dashboardDesigner.modules.dataConfiguration,BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.DashboardUtil.invokeMethod(e,"postDraggedFields",[])),this.isDataHigh=!1,this.multiSelectionComboBox.hideMultiSelectionWaitingPopup(!0),this.hideWaitingPopup(),this.ejFilterDialog.close()},e.prototype.closeDialog=function(e){var t;this.hideWaitingPopup(),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_multi_select_dropDown").remove(),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_popup_container").remove(),0<(t=this.bbdesigner$("#"+this.id+"_dimension_filter_date_dateRange_popup")).length&&(t.css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn").removeClass("e-focus"),this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_date_dateRange_multidDrpDwn .bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-up").addClass("e-arrow-sans-down")),e.model.position={X:0,Y:0},this.isDataHigh&&(t=this.dashboardDesigner.modules.dataConfiguration,BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.DashboardUtil.invokeMethod(t,"postDraggedFields",[]))},e.prototype.hideWaitingPopup=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_dimension_filter_popup_container_list_Box_div");!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&e.BoldBIDashboardWaitingPopup("hide")},e.prototype.checkDimensionFilterChange=function(){var e=this.dashboardDesigner.designerPanel.selectedReportItems[0].attr("controlType")===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetType,WidgetType.Filter),t=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter"),i=this.widgetHelper.getCurrentWidgetInstance(),a=i.DataGroupInfo.FieldContainers[0].FieldInfos[0],o=BoldBIDashboard.isNullOrUndefined(a)?null:a.FilterInfo;BoldBIDashboard.isNullOrUndefined(o)?e&&BoldBIDashboard.isNullOrUndefined(o)&&(this.modifiedConditionalFilter||this.modifiedTopNFilter||!t.IsCheckAll||this.fieldDetails.DateTimeFormat===DateTimeFormat.Date)&&i.clearFilter():(o=a.FilterInfo.DimensionFilterInfo,e&&!BoldBIDashboard.isNullOrUndefined(o)&&(this.isTopNhasSameValues(o)||this.isConditionFilterHasSameValues(o)||this.isAllowFilterHasSameValues(o)||this.isAllowFilterHasDateRange(o,a))&&i.clearFilter()),(t=i.getJson()).FilterSettings.ActAsMasterWidget&&!BoldBIDashboard.isNullOrUndefined(t.SelectedFilterValues)&&0<t.SelectedFilterValues.length&&i.clearFilter()},e.prototype.isTopNhasSameValues=function(e){var t=!1;return BoldBIDashboard.isNullOrUndefined(e.TopNFilterInfo)||(t=this.isTopNFilterModeChanged(e)||this.isTopNRecordsCountChanged(e)||this.isTopNColumnNameChnaged(e)||this.isTopNColumnIdChanged(e)||this.isTopNBasedOnDateAndTimeFiled(e)||this.isTopNSummaryTypeChanged(e)||this.isTopNNDateTimeFormatChanged(e)),this.modifiedTopNFilter&&(!e.IsTopNFilteringApplied&&this.isTopNFilteringApplied||e.IsTopNFilteringApplied&&t)},e.prototype.isTopNFilterModeChanged=function(e){return e.TopNFilterInfo.Mode!==this.mode},e.prototype.isTopNRecordsCountChanged=function(e){return e.TopNFilterInfo.NoOfRecords!==this.numberOfRecords},e.prototype.isTopNColumnNameChnaged=function(e){return e.TopNFilterInfo.ColumnName!==this.rankColumnName},e.prototype.isTopNColumnIdChanged=function(e){return e.TopNFilterInfo.ColumnId!==this.rankColumnId},e.prototype.isTopNBasedOnDateAndTimeFiled=function(e){return e.TopNFilterInfo.IsBasedOnDateAndTimeField!==this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()},e.prototype.isTopNSummaryTypeChanged=function(e){var t=this.rankFormatDropDown.data("BoldBIDashboardDropDownList");return!this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()&&e.TopNFilterInfo.SummaryType!==BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,t.getSelectedValue().toLocaleLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()}))},e.prototype.isTopNNDateTimeFormatChanged=function(e){var t=this.rankFormatDropDown.data("BoldBIDashboardDropDownList");return this.dateTimeCheckBox.data("BoldBIDashboardCheckBox").isChecked()&&!BoldBIDashboard.isNullOrUndefined(t)&&e.TopNFilterInfo.DateFormat!==BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(DateTimeFormatForFilter,t.selectedTextValue)},e.prototype.isConditionFilterHasSameValues=function(e){var t=!1;return BoldBIDashboard.isNullOrUndefined(e.ConditionFilterInfo)||(t=this.isConditionFilterColumnNameChanged(e)||this.isConditionFilterColumnIdChanged(e)||this.isConditionFilterSummaryTypeChanged(e)||this.isConditionFilterConditionSummaryTypeChanged(e)||this.isConditionFilterLeftValueChanged(e)||this.isConditionFilterRightValueChanged(e)),this.modifiedConditionalFilter&&(!e.IsConditionFilteringApplied&&this.isConditionFilteringApplied||e.IsConditionFilteringApplied&&t)},e.prototype.isConditionFilterColumnNameChanged=function(e){return e.ConditionFilterInfo.ColumnName!==this.columnName},e.prototype.isConditionFilterColumnIdChanged=function(e){return e.ConditionFilterInfo.ColumnId!==this.columnId},e.prototype.isConditionFilterSummaryTypeChanged=function(e){return e.ConditionFilterInfo.SummaryType!==this.summaryType},e.prototype.isConditionFilterConditionSummaryTypeChanged=function(e){return e.ConditionFilterInfo.ConditionSummaryType!==this.conditionSummaryType},e.prototype.isConditionFilterLeftValueChanged=function(e){return e.ConditionFilterInfo.Values[0]!==this.leftValue.toString()},e.prototype.isConditionFilterRightValueChanged=function(e){return e.ConditionFilterInfo.Values[1]!==this.rightValue.toString()},e.prototype.isAllowFilterHasSameValues=function(e){var t=!1,i=this.multiSelectionComboBox.getPopupContainerInformation(this.id+"_dimension_filter");return BoldBIDashboard.isNullOrUndefined(e.AllowFilterInfo)||(t=this.isAllowFilterCheckAllChanged(e,i)||this.isAllowFilterIncludeChanged(e,i)||this.isAllowFilterHasDateTimeFormat(e,i)||!this.isAllowFilterChange(e.AllowFilterInfo.FilterValues,i.FilterValues)),!i.IsCheckAll&&e.IsAllowFilteringApplied&&t},e.prototype.isAllowFilterCheckAllChanged=function(e,t){return e.AllowFilterInfo.IsCheckAll!==t.IsCheckAll},e.prototype.isAllowFilterIncludeChanged=function(e,t){return e.AllowFilterInfo.IsInclude!==t.IsInclude},e.prototype.isAllowFilterHasDateTimeFormat=function(e){return e.AllowFilterInfo.IsDateFormatFilteringApplied},e.prototype.isAllowFilterChange=function(e,i){return e.length===i.length&&e.every(function(e,t){return e===i[t]})},e.prototype.isAllowFilterHasDateRange=function(e,t){var i;return!BoldBIDashboard.isNullOrUndefined(e.AllowFilterInfo)&&!BoldBIDashboard.isNullOrUndefined(e.AllowFilterInfo.DateFilterInfo)&&(i=this.dateRangePopup.getDateRangeValues(this.id+"_dimension_filter_date"),i=this.isAllowFilterDateFomartCondtionModified(e,i)||this.isAllowFilterStartDateChanged(e,i)||this.isAllowFilterEndDateChanged(e,i),t.DateTimeFormat===DateTimeFormat[DateTimeFormat.Date]||this.fieldDetails.DateTimeFormat===DateTimeFormat.Default)&&e.IsAllowFilteringApplied&&i},e.prototype.isAllowFilterDateFomartCondtionModified=function(e,t){return e.AllowFilterInfo.DateFilterInfo.DateFormatCondition!==t.DateFormatCondition},e.prototype.isAllowFilterStartDateChanged=function(e,t){return e.AllowFilterInfo.DateFilterInfo.StartDate!==t.StartDate},e.prototype.isAllowFilterEndDateChanged=function(e,t){return e.AllowFilterInfo.DateFilterInfo.EndDate!==t.EndDate},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DimensionFilter",InternalDimensionFilter,window),InternalDragDropHelper=function(){function e(e){this.dashboardDesigner=null,this.zIndex="",this.dragging=null,this.pageY=0,this.isWidgetListDrag=!1,this.itemJson=null,this.restrictDrop=!1,this.locale=null,this.fieldInfo=null,this.paramName="",this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.id=this.dashboardDesigner._id,this.designAreaContainer=this.dashboardDesigner.element.find("#"+this.id+"_designAreaContainer"),this.designCanvas=this.designAreaContainer.find(".bbi-dashboarddesigner-designcanvas"),this.dragAndDropSettings=e.model.designerSettings.widgetsPanel.dragAndDropSettings,this.initalizeDraggable()}return e.prototype.initalizeDraggable=function(){this.dashboardDesigner.element.find(".e-draggable").BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),cursorAt:{top:-4,left:-10},drag:this.bbdesigner$.proxy(this.drag,this)})},e.prototype.initializeDraggable=function(e,t){e.BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),cursorAt:{top:-4,left:-10},drag:this.bbdesigner$.proxy(this.drag,this)}),this.zIndex=t},e.prototype.initializeParameterDraggable=function(e){e.BoldBIDashboardDraggable({clone:!0,cursor:"move",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),drag:this.bbdesigner$.proxy(this.drag,this)})},e.prototype.initializeWidgetListDraggable=function(e,t){this.itemJson=t,e.BoldBIDashboardDraggable({clone:!0,cursor:"pointer",helper:this.bbdesigner$.proxy(this.helper,this),dragStart:this.bbdesigner$.proxy(this.dragstart,this),dragStop:this.bbdesigner$.proxy(this.dragStop,this),drag:this.bbdesigner$.proxy(this.drag,this)})},e.prototype.dragstart=function(e){this.isAIChatDragged(e)?this.dashboardDesigner.modules.aiChatAssistance.aiChatDragStart(e):(this.dashboardDesigner.isItemDrag=!0,this.fieldInfo=null,this.paramName="",this.designAreaContainer=this.dashboardDesigner.element.find("#"+this.id+"_designAreaContainer"),this.designCanvas=this.designAreaContainer.find(".bbi-dashboarddesigner-designcanvas"),(e=this.bbdesigner$(e.element)).hasClass("bbi-datafield")?this.fieldInfo={dataSetName:e.attr("e-dataset"),fieldName:e.attr("name")}:e.hasClass("e-parameter")?this.paramName=e.attr("name"):0<e.closest(".e-dbd-widget-list").length&&(this.isWidgetListDrag=!0))},e.prototype.updateRowSpan=function(e){var t=(t=BoldBIDashboard.isNullOrUndefined(this.dragAndDropSettings.rowSpan)?isNaN(e)?6:e:this.dragAndDropSettings.rowSpan)<=24?t:24;return this.hasTabbedOrCombinedWidgetInPanel()?isNaN(e)?6:e:t},e.prototype.updateColumnSpan=function(e){var t=(t=BoldBIDashboard.isNullOrUndefined(this.dragAndDropSettings.columnSpan)?isNaN(e)?6:e:this.dragAndDropSettings.columnSpan)<=48?t:48;return this.hasTabbedOrCombinedWidgetInPanel()?isNaN(e)?6:e:t},e.prototype.hasWidgetsInDesignCanvas=function(e){return 0!==this.widgetHelper.getAllWidgets().length&&this.dashboardDesigner.designerPanel.isItemRestricted(e)},e.prototype.hasTabbedOrCombinedWidgetInPanel=function(){var e,t;if(this.dragAndDropSettings.isWidgetMode)for(e=this.widgetHelper.getAllWidgets(),t=0;t<e.length;t++)if("CombineWidget"===e[t].Type||"TabbedWidget"===e[t].Type)return!0;return!1},e.prototype.drag=function(e){var t,i,a,o,s,n,r,d;this.isAIChatDragged(e)?this.dashboardDesigner.modules.aiChatAssistance.aiChatDrag(e):(this.restrictDrop=!1,t=this.getPosition("clientX",e.event),i=this.getPosition("clientY",e.event),a=this.designCanvas[0].getBoundingClientRect(),o=this.dashboardDesigner.designerPanel,BoldBIDashboard.isNullOrUndefined(e.element)||!this.bbdesigner$(e.element).hasClass("bbi-data-field-info-wrap")&&!this.bbdesigner$(e.element).hasClass("bbi-data-datefield-info-wrap")?a.left+parseFloat(this.designCanvas.css("padding-left"))<t&&a.top+parseFloat(this.designCanvas.css("padding-top"))<i&&a.right-parseFloat(this.designCanvas.css("padding-right"))>t&&a.bottom-parseFloat(this.designCanvas.css("padding-bottom"))>i?(this.designAreaContainer.css("cursor","default"),this.draggingItem.css({display:"block",zIndex:this.zIndex}),t+=this.bbdesigner$(document).scrollLeft(),i+=this.bbdesigner$(document).scrollTop(),a=o.getTargetElement({x:t,y:i,width:1,height:1}),BoldBIDashboard.isNullOrUndefined(a)||(s=a.position(),n=this.designCanvas.find("#"+o.designId+"_placingItem"),r=Number(this.draggingItem.attr("data-min-rowspan")),d=Number(this.draggingItem.attr("data-min-colspan")),r=this.updateRowSpan(r),d=this.updateColumnSpan(d),n.attr({row:Number(a.attr("row")),column:Number(a.attr("column")),rowSpan:r,columnSpan:d}),a={Row:Number(a.attr("row")),Column:Number(a.attr("column")),RowSpan:r,ColumnSpan:d},o.isWidgetItemRestricted=this.dragAndDropSettings.isWidgetMode?this.hasWidgetsInDesignCanvas(a):o.isItemRestricted(a,!1),a=o.getWidgetItemWidth(d),d=o.getWidgetItemHeight(r),o.isWidgetItemRestricted=this.dashboardDesigner.modules.containerTypeWidgetHelper.isDragRestricted(this.bbdesigner$(e.target),this.dashboardDesigner.element.find("#"+this.id+"_dragging_item"),o.isWidgetItemRestricted),n.css({display:"block","background-color":o.isWidgetItemRestricted?o.itemRestrictedColor:"transparent","border-color":o.isWidgetItemRestricted?"#f13232":"var(--selection-container-color)",left:s.left+o.cellMargin,top:s.top+o.cellMargin,width:a+2,height:d+2}))):(this.designCanvas.find("#"+o.designId+"_placingItem").css("display","none"),this.designAreaContainer.css("cursor","not-allowed"),this.restrictDrop=!0):this.dataFieldDrag(e,t,i))},e.prototype.dataFieldDrag=function(e,t,i){this.droppingItem=null,this.draggingItem.css("zIndex",this.zIndex);var a,o,s,n=this.getDraggedFieldInfo(null,this.bbdesigner$(e.element)),e=this.getDataCategoryListContainer(e.event,n.ContainerName),r=BoldBIDashboard.isNullOrUndefined(e)?null:e.Container,d=BoldBIDashboard.isNullOrUndefined(e)?null:e.ParentContainer,l=this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement");!BoldBIDashboard.isNullOrUndefined(r)&&BoldBIDashboard.isNullOrUndefined(n.ContainerType)&&(n.ContainerType=e.Container.data("container-info").ContainerType),e=this.widgetHelper.getCurrentWidgetInstance().onFieldDragDrop(n),!BoldBIDashboard.isNullOrUndefined(r)&&0<r.length&&e?(e=(this.droppingItem=r).data("container-info"),l.css("cursor","default"),o=a=-1,s=this.dashboardDesigner.element.find("#"+this.id+"_"+n.Id+"_categoryListDiv_"+BoldBIDashboard.DashboardUtil.escapeSelector(n.Name)),(BoldBIDashboard.isNullOrUndefined(s[0])||"Measures"!==n.ContainerName&&"Dimensions"!==n.ContainerName)&&(o=(s=this.getEmptyFieldRowAndHoverIndex(r,d,t,i)).emptyRowIndex,a=s.elementHoverIndex),(-1<a||0===r.children().length)&&o!==a?this.insertEmptyField(o,a,e,r):-1===a&&(l.css("cursor","not-allowed"),this.restrictDrop=!0),"Measures"!==e.Name&&"Dimensions"!==e.Name&&"Parameters"!==e.Name||(this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement").css("cursor","not-allowed"),this.restrictDrop=!0)):(l.css("cursor","not-allowed"),(n=this.dashboardDesigner.element.find("div.bbi-dbrd-rendercolumn-container .bbi-categorylistdiv-emptyfield:not(:last-child)")).insertAfter(n.siblings(":last")),this.restrictDrop=!0)},e.prototype.getDraggedFieldInfo=function(e,t){t=t.data("fieldInfo"),t=JSON.parse(JSON.stringify(t));return BoldBIDashboard.isNullOrUndefined(e)||(e=e.data("container-info"),t.ContainerType=e.ContainerType),t},e.prototype.getEmptyFieldRowAndHoverIndex=function(e,t,i,a){for(var o=-1,s=-1,n=e.find(".bbi-category-empty-field-wrap"),r=0;r<e.children().length;r++){var d=e[0].children[r].getBoundingClientRect(),l=e[0].children[e[0].children.length-1].getBoundingClientRect(),h=t[0].getBoundingClientRect();e.children().eq(r).attr("id")===n.attr("id")&&(o=r),d.top<a&&d.bottom>a?s=r:a>l.bottom&&a<h.bottom&&(s=e.children().length-1)}return{emptyRowIndex:o,elementHoverIndex:s}},e.prototype.insertEmptyField=function(e,t,i,a){var o=a.find(".bbi-category-empty-field-wrap");(BoldBIDashboard.isNullOrUndefined(i.CategoryCount)||1===o.length||a.children().length<=i.CategoryCount)&&(e<t?o.insertAfter(a.children().eq(t)):o.insertBefore(a.children().eq(t)))},e.prototype.restrictAggregateField=function(e){var t,i,a;return BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.attr("id"))||(e=e.data("fieldInfo"),i=this.getDataCategoryListContainer(e,e.ContainerName),BoldBIDashboard.isNullOrUndefined(i))||BoldBIDashboard.isNullOrUndefined(i.Container)?this.restrictDrop=!1:(t=(i=i.Container.data("container-info")).Name,i=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(FieldContainerType,i.ContainerType),e=e.IsAggregatedExpression,a=this.widgetHelper.getCurrentWidgetInstance(),this.restrictDrop=!a.isFieldValid(e,i,t),this.restrictDrop&&this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.DataConfiguration,this.locale.alertWindowMesages.restrictedFieldMessage,IconType.warning,AlertType.Alert,!1,null),this.restrictDrop)},e.prototype.getValidatedContainer=function(e,t,i){var a=this.dashboardDesigner.element.find("#"+this.id+"_"+i+"_categoryListPanel"),o=BoldBIDashboard.isNullOrUndefined(a)?null:a[0].getBoundingClientRect();return!BoldBIDashboard.isNullOrUndefined(o)&&o.left<e&&o.top<t&&o.right>e&&o.bottom>t?{ParentContainer:a,Container:this.dashboardDesigner.element.find("#"+this.id+"_"+i+"_categoryList")}:null},e.prototype.getDataCategoryListContainer=function(e,t){var i,a,o,s=this.getPosition("clientX",e),n=this.getPosition("clientY",e);if("Measures"===t||"Dimensions"===t||"Parameters"===t){for(i=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"getCategories"),a=0;a<i.length;a++)if((BoldBIDashboard.isNullOrUndefined(i[a].Visibility)||i[a].Visibility!==Visibility.hidden)&&(o=this.getValidatedContainer(s,n,i[a].Name),!BoldBIDashboard.isNullOrUndefined(o)))return o}else if(!BoldBIDashboard.isNullOrUndefined(t)&&(o=this.getValidatedContainer(s,n,t),!BoldBIDashboard.isNullOrUndefined(o)))return o;return null},e.prototype.dragStop=function(e,t,i){var a,o,s,n,r,d,l,h,p,c;this.isAIChatDragged(e)?this.dashboardDesigner.modules.aiChatAssistance.aiChatDragStop(e):(BoldBIDashboard.isNullOrUndefined(i)||(this.droppingItem=i),i=this.id,a=this.dashboardDesigner.designerPanel,o=this.designCanvas.find("#"+i+"_placingItem"),s=this.dashboardDesigner.element.find("#"+this.id+"_dataTabElement"),c=this.bbdesigner$(e.target),this.dashboardDesigner.isItemDrag=!1,n=(i=this.dashboardDesigner.element.find("#"+i+"_dragging_item")).attr("data-widgetnamespace"),r=i.attr("data-widgetname"),d=i.attr("data-widgetid"),l=Number(i.attr("data-min-rowspan")),p=Number(i.attr("data-min-colspan")),l=this.updateRowSpan(l),p=this.updateColumnSpan(p),i.remove(),i=a.isDesignerSections(c),BoldBIDashboardDesigner.editManager.setMergeAction(!0),i?(c={Row:Number(o.attr("row")),Column:Number(o.attr("column")),RowSpan:l,ColumnSpan:p},a.isWidgetItemRestricted=this.dragAndDropSettings.isWidgetMode?this.hasWidgetsInDesignCanvas(c):a.isItemRestricted(c,!1),this.dragAndDropSettings.isWidgetMode&&!this.hasTabbedOrCombinedWidgetInPanel()&&(c.Row=0,c.Column=0),a.isWidgetItemRestricted||(this.isWidgetListDrag?(this.itemJson.ContainerSettings.Bounds.Row=c.row,this.itemJson.ContainerSettings.Bounds.Column=c.column,a.pasteWidgetElement(this.itemJson)):!BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(e.element).parent(".e-widget-collection-wrapper"))&&0<this.bbdesigner$(e.element).parent(".e-widget-collection-wrapper").length?(h=this.bbdesigner$(e.element).parent(".e-widget-collection-wrapper").attr("data-dbrdId"),i=this.bbdesigner$(e.element).parent(".e-widget-collection-wrapper").attr("data-version"),l=this.bbdesigner$(e.element).attr("data-widgetId"),a.droppedWidget(h,i,l,c)):!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.predefinedWidgets)&&0<=this.bbdesigner$(e.element).attr("data-widgetclass").indexOf("e-predefinedwidgets")?(h=this.bbdesigner$(e.element).attr("data-dbrdid"),p=this.bbdesigner$(e.element).attr("data-dbrdversion"),i=this.bbdesigner$(e.element).attr("data-widgetId"),a.droppedWidget(h,p,i,c)):this.droppedReportItems(n,r,"",c,d))):!this.restrictDrop&&0<a.selectedReportItems.length&&(BoldBIDashboard.isNullOrUndefined(this.droppingItem)||this.dataFieldDragStop(e,t)),this.bbdesigner$(s).css("cursor","default"),o.css({display:"none","background-color":a.itemPlacingColor}),this.isWidgetListDrag=!1,this.dashboardDesigner.modules.undoManager.setMergeAction(!1),this.designAreaContainer.css("cursor","default"),this.droppingItem=null)},e.prototype.dataFieldDragStop=function(e,t){var i,a,o=this.bbdesigner$(e.element),s=this.bbdesigner$(e.target),n=this.droppingItem,r=this.getDraggedFieldInfo(n,o),d=this.widgetHelper.getCurrentWidgetInstance(),l=JSON.parse(JSON.stringify(r)),h=n.data("container-info"),h=l.ContainerName=h.Name,d=!!BoldBIDashboard.isNullOrUndefined(t)&&d.onFieldDragDrop(l,this.droppingItem,e);if(this.restrictAggregateField(o),!BoldBIDashboard.isNullOrUndefined(o)&&(o.hasClass("bbi-data-field-info-wrap")||o.hasClass("bbi-data-datefield-info-wrap"))&&(d&&BoldBIDashboard.isNullOrUndefined(t)&&!this.restrictDrop||!BoldBIDashboard.isNullOrUndefined(t))){for(var p,c=-1,u=-1,b=-1,g=0,m=0,f=0,l=o.attr("label"),D=n.children(),y=n.find(".bbi-category-empty-field-wrap"),B=0,I=0,x=0;x<D.length;x++)p=D[x].getElementsByClassName("e-heirachy-field"),i=this.bbdesigner$(p),BoldBIDashboard.isNullOrUndefined(i.attr("child-field-count"))||(B+=parseInt(i.attr("child-field-count"),10)),-1!==c&&BoldBIDashboard.isNullOrUndefined(r.ChildHierarchicalFields)||(BoldBIDashboard.isNullOrUndefined(r.ChildHierarchicalFields)?(I=B,g++):I=r.ChildHierarchicalFields.length),D[x].id===y.attr("id")&&(c=m,b=x),D[x].id!==this.id+"_"+r.Id+"_categoryListParentDiv_"+r.UniqueId&&D[x].id!==this.id+"_"+r.Id+"_categoryListDiv_"+r.UniqueId||(u=m),0<p.length&&0!==B&&"Column"===r.ContainerName&&(m+=parseInt(i.attr("child-field-count"),10)-1),g<I&&(g=I,f++),m++;if(e=this.dashboardDesigner.element.find("#"+this.id+"_"+r.Id+"_categoryListDiv_"+l),d=this.widgetHelper.getCurrentWidgetInstance(),BoldBIDashboard.isNullOrUndefined(e[0])||"Measures"!==r.ContainerName&&"Dimensions"!==r.ContainerName){if(o=null,y.length<1||!BoldBIDashboard.isNullOrUndefined(t)&&!t){for((a=s.closest("[label]")).length<1&&(a=BoldBIDashboard.isNullOrUndefined(t)||t?this.bbdesigner$(D[D.length-1]):this.bbdesigner$(D[0])),x=0;x<D.length;x++)a.attr("id")===D[x].id&&(c=x);o=this.getRemoveItem(s,n,t,c,r)}"Measures"!==h&&"Dimensions"!==h&&"Parameters"!==h&&(h===r.ContainerName||"Measures"!==r.ContainerName&&"Dimensions"!==r.ContainerName&&"Parameters"!==r.ContainerName?(c+=I,u+=I,b+=I,l=this.dashboardDesigner.element.find("#"+this.id+"_"+r.Id+"_categoryListDiv_"+r.UniqueId),BoldBIDashboard.isNullOrUndefined(r.ChildHierarchicalFields)||(l=this.dashboardDesigner.element.find("#"+this.id+"_"+r.Id+"_categoryListParentDiv_"+r.UniqueId)),e=c-I,s=u-I,-1<(b-=I)&&0<D.length&&(this.dashboardDesigner.element.find("#"+l[0].id).insertBefore(D[b]),0<y.length&&b<D.length-1&&y.insertAfter(n.children().last()),s=s<0?0:s,BoldBIDashboard.isNullOrUndefined(r.ChildHierarchicalFields)?((l=JSON.parse(JSON.stringify(r))).ItemIndex=s,(n=JSON.parse(JSON.stringify(r))).ItemIndex=e,this.updateReorderInfo(l,n,e<s?s-1:s,s<e?e-1:e)):this.reorderForHeiarchyFields(r,I,s,e))):((l=this.getAddItem(d,r,c+=I=0<I?0<f?I-f:I-1:I,h,!1,I,f)).IsDisplayNameEdited||(l.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(l)),n=this.dashboardDesigner.modules.dataConfiguration,y.length<1?BoldBIDashboard.DashboardUtil.invokeMethod(n,"replaceItem",[o,l]):(BoldBIDashboard.isNullOrUndefined(t)||t||this.dashboardDesigner.modules.dataConfiguration.removeItem(o,!1,!0,!1),BoldBIDashboard.DashboardUtil.invokeMethod(n,"addItem",[l,!1,!0]))))}}},e.prototype.reorderForHeiarchyFields=function(e,t,i,a){for(var o,s,n,r,d=0;d<t;d++)(o=JSON.parse(JSON.stringify(e))).ItemIndex=i,n=((s=JSON.parse(JSON.stringify(e))).ItemIndex=a)<i?i-1+d:i+d,r=i<a?a-1+d:a+d,i<a?this.updateReorderInfo(o,s,i,a-1):this.updateReorderInfo(o,s,n,r)},e.prototype.updateReorderInfo=function(e,t,i,a){i!==a&&(BoldBIDashboardDesigner.editManager.addCmdAction(CommandAction.DataAssignUpdate,"reorderItem","DataConfiguration","",[e,{previousIndex:a,currentIndex:i}],[t,{previousIndex:i,currentIndex:a}]),t=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateDataGroupInfo",[e,t,{previousIndex:i,currentIndex:a}]),BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"postDraggedFields",[]))},e.prototype.getRemoveItem=function(e,t,i,a,o){var s,n,r=new BoldBIDashboard.Dashboard.FieldInfoForUI,d=t.find(".bbi-category-empty-field-wrap"),l=t.children(),t=t.data("container-info"),h=0;if(d.length<1||!BoldBIDashboard.isNullOrUndefined(i)&&!i){for((s=e.closest(".bbi-ds-categoryLabel")).length<1&&(s=BoldBIDashboard.isNullOrUndefined(i)||i?l.eq(l.length-1):l),n=0;n<l.length;n++)s.attr("id")===l[n].id&&(a=n),this.bbdesigner$(s[n]).hasClass("bbi-data-field-info-wrap")&&(h=n);t.Name!==o.ContainerName&&"Measures"===o.ContainerName||"Dimensions"===o.ContainerName||"Parameters"===o.ContainerName?((r=JSON.parse(JSON.stringify(this.bbdesigner$(s[h]).data("fieldInfo")))).IsLoading=!1,r.IsExpression=!1,r.ItemIndex=a):r=null}return r},e.prototype.getAddItem=function(e,t,i,a,o,s,n){void 0===o&&(o=!1),void 0===s&&(s=0),void 0===n&&(n=0);var r=this.dashboardDesigner.modules.dataConfiguration,d=r.getAvailableName(),l=!1,h=!1,r=r.getExpressionField(t.Id,o),p="FilterColumn"===a,r=(BoldBIDashboard.isNullOrUndefined(r)||(l=(o?t:r).IsExpression,h=(o?t:r).IsAggregatedExpression),e.getDefaultSummaryType(t.FieldType,t.ContainerType,t.IsAggregatedExpression)),e=e.getDefaultDateFormat(),c="bbi-designer-dataset-datetime"!==t.FieldActualType&&"bbi-designer-dataset-time"!==t.FieldActualType||t.ContainerType!==FieldContainerType.Numeric?t.FieldActualType:"bbi-designer-dataset-string";return t.UniqueId=d,o?(t.SummaryType=SummaryType.NONE,"bbi-designer-dataset-datetime"===c||"bbi-designer-dataset-time"===c?t.DateTimeFormat===DateTimeFormat.None&&(t.DateTimeFormat=DateTimeFormat.Date):t.DateTimeFormat=DateTimeFormat.None):(t.SummaryType=BoldBIDashboard.isNullOrUndefined(r)?t.ContainerType===FieldContainerType.Numeric?t.FieldType===FieldType.Measures?SummaryType.SUM:SummaryType.COUNT:SummaryType.NONE:r,t.DateTimeFormat=t.IsParameterField&&"bbi-designer-dataset-datetime"===c?e===DateTimeFormat.None?DateTimeFormat.MonthDayYear:e:e===DateTimeFormat.None?"bbi-designer-dataset-datetime"===c?DateTimeFormat.Year:"bbi-designer-dataset-time"===c?DateTimeFormat.Default:t.DateTimeFormat:e),t.IsLoading=!1,t.ItemIndex=i,t.IsExpression=l,t.IsAggregatedExpression=h,t.FieldActualType=c,t.ContainerName=a,t.hierarchyLevel=s,t.hierarchyCount=n,t.IsFilterColumn=p,t.IsVisible=!p&&t.IsVisible,t},e.prototype.droppedReportItems=function(e,t,i,a,o){this.dashboardDesigner.designerPanel.renderItem(e,t,i,a,o),this.dashboardDesigner.modules.serialization.notifyChange()},e.prototype.helper=function(e){var t,i,a,o;return this.isAIChatDragged(e)?this.dashboardDesigner.modules.aiChatAssistance.aiDragHelper(e):(t=this.bbdesigner$(e.element).clone(!0),BoldBIDashboard.isNullOrUndefined(e.element)||BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(e.element).attr("id"))||-1===this.bbdesigner$(e.element).attr("id").indexOf("categoryList")?(0<this.bbdesigner$(e.element)[0].children.length&&(-1!==(i=this.bbdesigner$(e.element)[0].children[0]).className.indexOf("bbi-widgeticon")||-1!==i.className.indexOf("bbi-drag-handle-icon")?t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.itemPanel,"getDragElement",[t]):0<this.bbdesigner$(e.element).closest(".e-dbd-widget-list").length?this.isWidgetListDrag=!0:this.bbdesigner$(e.element).hasClass("e-parameter")?(a=this.bbdesigner$(e.element).attr("name"),o=this.bbdesigner$(e.element).find("span.bbi-designer-datatype-icon").attr("class"),(t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"getDragElement",[a,o])).css("border-color","#0C8BE2")):this.bbdesigner$(e.element).hasClass("bbi-datafield")&&(a=this.bbdesigner$(e.element).attr("name"),o=this.bbdesigner$(e.element).find("span.bbi-designer-content-icon").attr("class"),(t=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"getDragElement",[a,o])).css("border-color","#0C8BE2"))),this.bbdesigner$(t).attr("id",this.id+"_dragging_item"),this.dashboardDesigner.element.find("#"+this.id+"_designPanel").append(t),this.draggingItem=this.dashboardDesigner.element.find("#"+this.id+"_dragging_item")):t=this.draggingItem=this.getDataFieldDragItem(e,t),this.bbdesigner$(t))},e.prototype.isAIChatDragged=function(e){return!(!e.element.hasClass("bbi-dbrd-chat-header")&&!e.element.hasClass("bbi-dbrd-chat-resize-top-left"))},e.prototype.getDataFieldDragItem=function(e,t){var t=t.data("fieldInfo"),i=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"getDragElement",[t]);return i.css("border-color","#0C8BE2"),i.attr("id",this.id+"_dragging_item"),i.css("width",this.dashboardDesigner.element.find("#"+this.id+"_"+t.ContainerName+"_categoryList")[0].offsetWidth-10),this.dashboardDesigner.element.find("#"+this.id+"_"+t.ContainerName+"_categoryItem").append(i),i},e.prototype.getPosition=function(e,t){var i=0;return t[e]?i=t[e]:t.originalEvent&&t.originalEvent.targetTouches&&0<t.originalEvent.targetTouches.length?i=t.originalEvent.targetTouches[0][e]:t.originalEvent&&t.originalEvent.changedTouches&&0<t.originalEvent.changedTouches.length&&(i=t.originalEvent.changedTouches[0][e]),i},e.prototype.initializeSortable=function(e,t,i,a,o){e.bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseDown,this.bbdesigner$.proxy(this.ondragStart,this,{element:t,diaglog:i,container:a,callBackMethod:o})),e.css("cursor","move")},e.prototype.ondragStart=function(e,t){this.bbdesigner$("body").bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseMove,this.bbdesigner$.proxy(this.ondrag,this,{container:e.container})),this.bbdesigner$("body").bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseUp,this.bbdesigner$.proxy(this.ondrop,this,e)),this.dragging=BoldBIDashboard.buildTag("div","",{height:"auto",width:e.element.width(),position:"absolute",display:"block","border-style":"none","z-index":this.dashboardDesigner.element.find("#"+e.diaglog+"_wrapper").css("z-index")+10,top:t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageY+1.5:t.pageY+1.5,left:t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0].pageX+1.5:t.pageX+1.5},{}),this.dragging.append(e.element.clone()),this.bbdesigner$("body").append(this.dragging),this.updateDragRegion(e.element,"bottom"),e.element.hide()},e.prototype.ondrag=function(e,t){var i,a,o,s,n,r,d=this;null!=this.dragging&&(e=(i=this.bbdesigner$("#"+e.container)).data("BoldBIDashboardScroller"),a=i.offset(),o=(t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0]:t).pageY,s=(t.originalEvent&&t.originalEvent.targetTouches?t.originalEvent.targetTouches[0]:t).pageX,this.dragging.css({display:"block",position:"absolute",top:o+1.5,left:s+1.5}),a.top>o?0<e.model.scrollTop&&0<e.model.scrollTop-5?e.scrollY(e.model.scrollTop-5):e.scrollY(0):o>a.top+i.height()&&e.scrollY(e.model.scrollTop+5),t=i.find(".e-items").children(".e-drag-row:visible"),r=(n=this).bbdesigner$,t.each(function(e,t){t=r(t);n.isIntersect(s,o,t,i)&&n.updateDragRegion(t,o<d.pageY?"bottom":"top")}),this.pageY=o)},e.prototype.ondrop=function(e){e.element.show();var t=this.bbdesigner$("#"+this.id+"_drag_empty_area");e.element.insertAfter(t),this.dragging.remove(),this.dragging=null,t.remove(),BoldBIDashboard.isNullOrUndefined(e.callBackMethod)||BoldBIDashboard.DashboardUtil.invokeCallBack(e.callBackMethod,{}),this.bbdesigner$("body").unbind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseMove,this.bbdesigner$.proxy(this.ondrag,this)),this.bbdesigner$("body").unbind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseUp,this.bbdesigner$.proxy(this.ondrop,this))},e.prototype.isIntersect=function(e,t,i,a){var o=i.offset(),s=a.offset();return s.left<e&&e<s.left+a.width()&&s.top<t&&t<s.top+a.height()&&o.left<e&&e<o.left+i.width()&&o.top<t&&t<o.top+i.height()},e.prototype.updateDragRegion=function(e,t){var i=this.bbdesigner$("#"+this.id+"_drag_empty_area");0===i.length&&(i=BoldBIDashboard.buildTag("div.e-empty","",{border:"1px solid #f1f1f1",width:e.children().width(),margin:"8px",height:e.children().height(),background:"white"},{id:this.id+"_drag_empty_area"})),"bottom"===t?i.insertBefore(e):i.insertAfter(e)},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DragdropHelper",InternalDragDropHelper,window),InternalDateSettingsInfo=function(){function e(e){this.dateSettingsDialog=null,this.formatDropdown=null,this.columnNameTag=null,this.footerTag=null,this.periodDropdown=null,this.formatCustomContent=null,this.customTextbox=null,this.dateSettingsInfo=null,this.customReferenceContent=null,this.removeCustomTblContent=null,this.removeCustomValueTbl=null,this.selectedFieldName=null,this.okButton=null,this.cancelButton=null,this.formatValueName=null,this.customName=null,this.targetMethod=null,this.targetInstance=null,this.fiscalYearName=null,this.uniqueColumnName=null,this.id=null,this.dashboardDesigner=null,this.localizationContent=null,this.dateFormatDropObj=null,this.fiscalFormatDropObj=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.localizationContent=this.dashboardDesigner.getLocalizationContent(),this.renderCustomDateSettingsDialog(),this.wireEvents()}return e.prototype.renderCustomDateSettingsDialog=function(){var e=this.localizationContent.dateSettingsDialog,t=this.dateSettingsDialog=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_date_settings"}),i=BoldBIDashboard.buildTag("div","",{height:"auto",display:"block"}),a=BoldBIDashboard.buildTag("div","",{display:"block",width:"100%",height:"223px"},{}),o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"}),s=BoldBIDashboard.buildTag("tr.bbi-designer-exp-row","",{}),n=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 10px"},{}),d=this.bbdesigner$("<tr></tr>"),l=BoldBIDashboard.buildTag("td","",{width:"50px"},{}),h=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",e.columnLabelText+":",{"font-size":"12px","font-weight":"600"},{type:"label"}),p=BoldBIDashboard.buildTag("td","",{},{}),c=this.columnNameTag=BoldBIDashboard.buildTag("span.bbi-designer-fontfamily","",{"font-size":"12px"},{id:this.id+"__date_settings_columnName"}),u=BoldBIDashboard.buildTag("td","",{},{}),b=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon bbi-dbrd-designer-hoverable","",{cursor:"pointer",float:"right"},{"data-tooltip":e.infoIcon}),c=(p.append(c),u.append(b),l.append(h),d.append(l).append(p).append(u),r.append(d),this.cancelButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",e.cancelButtonText,{float:"right"},{id:this.id+"_date_settings_cancel"}),this.okButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",e.okButtonText,{float:"right"},{id:this.id+"_date_settings_ok"}),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{id:this.id+"_upper_content"})),b=BoldBIDashboard.buildTag("bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 15px"},{}),h=this.bbdesigner$("<tr></tr>"),l=BoldBIDashboard.buildTag("td","",{width:"160px"},{}),p=BoldBIDashboard.buildTag("table.editLabel.bbi-designer-fontfamily",e.format,{"font-size":"13px"},{type:"label"}),u=BoldBIDashboard.buildTag("td","",{},{}),d=this.formatDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_date_settings_formatdrop"}),p=(l.append(p),u.append(d),h.append(l).append(u),b.append(h),BoldBIDashboard.buildTag("div","",{width:"100%","border-top":"1px solid var(--primary-border-color)",margin:"10px 0px"},{})),l=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{}),u=this.bbdesigner$("<tr></tr>"),h=BoldBIDashboard.buildTag("td","",{width:"161px"},{}),e=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",e.fiscalYearStart,{"font-size":"13px"},{type:"label"}),g=BoldBIDashboard.buildTag("td","",{},{}),m=this.periodDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_date_settings_fiscaldrop"});h.append(e),g.append(m),u.append(h).append(g),l.append(u),c.append(b),n.append(r,p,c,p,l),t.append(i),i.append(a),a.append(o),o.append(s),s.append(n),t.BoldBIDashboardDialog({enableModal:!0,enableResize:!1,showRoundedCorner:!1,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",title:"Date Settings",width:"auto",height:"auto",minWidth:290,minHeight:250,showOnInit:!1,showFooter:!0,target:"#"+this.dashboardDesigner._id,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this)}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_foot"),this.footerTag.addClass("bbi-dialog-footer"),this.footerTag.append(this.cancelButton).append(this.okButton),this.cancelButton.on("click",this.bbdesigner$.proxy(this.closeButtonClick,this)),this.okButton.on("click",this.bbdesigner$.proxy(this.okButtonClick,this)),d.BoldBIDashboardDropDownList({width:"250px",height:"28px",dataSource:this.formatTypeList(),fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,popupWidth:"250px",popupHeight:"100px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFormatType,this)}),m.BoldBIDashboardDropDownList({width:"250px",height:"28px",dataSource:this.fiscalTypeList(),fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,popupWidth:"250px",popupHeight:"300px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFiscalType,this)}),this.disableFormatMethod(),t.data("BoldBIDashboardDialog").open(),this.dateFormatDropObj=d.data("BoldBIDashboardDropDownList"),this.fiscalFormatDropObj=m.data("BoldBIDashboardDropDownList")},e.prototype.disableFormatMethod=function(){"Time"!==this.selectedFieldName&&"WeekYear"!==this.selectedFieldName&&"DayMonthYear"!==this.selectedFieldName&&"MonthDayYear"!==this.selectedFieldName||this.dateSettingsDialog.find("#"+this.id+"_date_settings_formatdrop").data("BoldBIDashboardDropDownList").disable()},e.prototype.changeFormatType=function(e){this.formatValueName=e.value,"Custom"===e.value?this.renderCustomDialog():(this.removeCustomTblContent=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_custom"),this.removeCustomTblContent.remove(),this.removeCustomValueTbl=this.dashboardDesigner.element.find("#"+this.id+"_date_settings_custom_Field_reference"),this.removeCustomValueTbl.remove()),this.enableOkButton()},e.prototype.renderCustomDialog=function(){var e=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{id:this.id+"_date_settings_custom"}),t=BoldBIDashboard.buildTag("tr","",{height:"46px"},{}),i=BoldBIDashboard.buildTag("td","",{width:"134px"},{}),a=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","Custom Format",{"font-size":"13px"},{type:"label"}),o=BoldBIDashboard.buildTag("td","",{width:"22px"},{}),s=this.customTooltipText(),n=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon","",{cursor:"pointer"},{}),s=(n.BoldBIDashboardTooltip({content:"<span>"+s+"</span>",cssClass:"bbi-defaultIndex-template",isBalloon:!1,collision:BoldBIDashboard.Tooltip.Collision.FlipFit,trigger:BoldBIDashboard.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!1}),BoldBIDashboard.buildTag("td","",{},{})),r=BoldBIDashboard.buildTag("input.e-textbox","",{"border-color":"var(--secondary-border-color)","box-sizing":"border-box"},{type:"text",spellcheck:"false",autocomplete:"off",id:this.id+"_date_settings_custom_Field"}),d=BoldBIDashboard.buildTag("bbi-designer-exp-table","",{float:"right",height:"21px"},{id:this.id+"_date_settings_custom_Field_reference"}),l=this.bbdesigner$("<tr></tr>"),h=BoldBIDashboard.buildTag("td","",{},{}),p=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-fontfamily bbi-datepicker-label","",{float:"right","text-align":"right",width:"250px",height:"18px",border:"none",outline:"none"},{type:"label",id:this.id+"_date_settings_custom_Field_reference_text",readonly:"readonly"});p.val("MM/ dd/ YYYY"),h.append(p),l.append(h),d.append(l),r.on("keyup",this.bbdesigner$.proxy(this.customEnteredValue,this)),r.on("keyup",this.bbdesigner$.proxy(this.changeCustomTextcolor,this)),r.on("focusout",this.bbdesigner$.proxy(this.customTextboxColor,this)),r.on("focusin",this.bbdesigner$.proxy(this.customTextboxColorReplace,this)),i.append(a),o.append(n),s.append(r),t.append(i).append(o).append(s),e.append(t),this.formatCustomContent=this.dashboardDesigner.element.find("#"+this.id+"_upper_content"),this.formatCustomContent.append(e).append(d),this.enableOkButton()},e.prototype.changeCustomTextcolor=function(){var e=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text").val(),t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text");"Invalid date format"===e?t.addClass("e-invalidlink"):t.removeClass("e-invalidlink")},e.prototype.customTextboxColorReplace=function(){this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field").removeClass("bbi-designer-error"),this.enableOkButton()},e.prototype.customTextboxColor=function(){var e=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text").val(),t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");"Invalid date format"===e&&t.addClass("bbi-designer-error"),this.enableOkButton()},e.prototype.customEnteredValue=function(){var e;this.customTextbox=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field"),e=this.customTextbox.val(),this.customName=e,e=this.customFormatDateText(e),this.customReferenceContent=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text"),this.customReferenceContent.val(e),this.enableOkButton()},e.prototype.customTooltipText=function(){return"<b>Year</b>-yyyy/yy<br></br><b>Month</b>-MM/MMM/MMMM<br></br><b>Day</b>-dd/ddd/dddd<br></br><b>Hours(24 hrs)</b>-HH<br></br><b>Hours(12 hrs)</b>-hh<br></br><b>Minutes</b>-mm<br></br><b>Seconds</b>-ss<br></br><b>AM/PM</b>-ttt"},e.prototype.enableOkButton=function(){var e=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field");0<e.length&&BoldBIDashboard.isNullOrUndefined(e.val())||""===e.val()?BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!0)},e.prototype.customFormatDateText=function(e){return null!==e?this.combinedSpecialCharacter(e):""===e?"MM / dd / yyyy":void 0},e.prototype.combinedSpecialCharacter=function(e){var t,i,a=new Date,o=["Monday","Tuesday","Wednesday","Thursday","Friday","Saturday","Sunday"][a.getDay()-1],s=a.toString().substring(0,3),n=a.getFullYear().toString(),r=(a.getFullYear()%100).toString(),d=["January","February","March","April","May","June","July","August","September","October","November","December"][a.getMonth()],l=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][a.getMonth()],h=a.getMonth(),p=9<(h+=1)?h.toString():"0"+h.toString(),c=9<(c=a.getDate())?c.toString():"0"+c.toString(),u=a.getHours(),b=u.toString(),g=a.getHours(),g=(12<u?g-12:g).toString(),m=a.getMinutes().toString();if(12<u?t="PM":u<=12&&(t="AM"),u=9<(u=a.getSeconds())?u.toString():"0"+u.toString(),"dd/MM/yy"===e||"dd/MM/YY"===e)return a.getDay()+"/"+a.getMonth()+"/"+a.getFullYear();if("MM/yy/dd"===e||"MM/YY/dd"===e)return h+"/"+n+"/"+c;var f,D=["dddd","ddd","dd","yyyy","yy","MMMM","MMM","MM","HH","hh","mm","ttt","ss"],y=[o,s,c,n,r,d,l,p,b,g,m,t,u],B=e;if(!BoldBIDashboard.isNullOrUndefined(B))for(i=0;i<D.length;i++)B=f=B.replace(D[i],y[i]);return f},e.prototype.changeFiscalType=function(e){this.fiscalYearName=e.value},e.prototype.formatTypeList=function(){return"Date"===this.selectedFieldName?[{text:"5/20/2017",value:"Date"},{text:"Custom",value:"Custom"}]:"Year"===this.selectedFieldName?[{text:"2016, 2017, ...",value:"FullYear"},{text:"16, 17, ...",value:"HalfYear"},{text:"Custom",value:"Custom"}]:"Quarter"===this.selectedFieldName?[{text:"Quarter 1, Quarter 2",value:"FullQuarter"},{text:"Q1, Q2, Q3, Q4",value:"HalfQuarter"},{text:"1, 2, 3, 4",value:"QuarterNumber"}]:"Month"===this.selectedFieldName?[{text:"Jan, Feb, Mar",value:"HalfMonth"},{text:"January, February",value:"FullMonth"},{text:"1, 2, 3, ...12",value:"MonthWithoutZero"},{text:"01, 02, 03, ...12",value:"MonthWithZero"}]:"Day"===this.selectedFieldName?[{text:"01, 02, 03, ...31",value:"DayWithZero"},{text:"1, 2, 3, ...31",value:"DayWithoutZero"}]:"Default"===this.selectedFieldName?[{text:"5/20/2017  12:00 AM",value:"DateTime"},{text:"Custom",value:"Custom"}]:"Time"===this.selectedFieldName?[{text:"00:00:00",value:"Time"}]:"Hour"===this.selectedFieldName?[{text:"00, 01, 02, 03, ...",value:"HourWithZero"},{text:"1 AM, 2 PM",value:"HourWithAMPM"},{text:"0, 1, 2, 3, ...",value:"HourWithoutZero"}]:"Minute"===this.selectedFieldName?[{text:"00, 01, 02, 03, ...",value:"MinuteWithZero"},{text:"0, 1, 2, 3, ...",value:"MinuteWithoutZero"}]:"Second"===this.selectedFieldName?[{text:"00, 01, 02, 03, ...",value:"SecondWithZero"},{text:"0, 1, 2, 3, ...",value:"SecondWithoutZero"}]:"QuarterYear"===this.selectedFieldName?[{text:"Quarter 1 2017",value:"QuarterYear"},{text:"Custom",value:"Custom"}]:"MonthYear"===this.selectedFieldName?[{text:"Jan 2016, May 2017",value:"MonthYear"},{text:"Custom",value:"Custom"}]:"WeekYear"===this.selectedFieldName?[{text:"Week 01 2017, Week 32 2017",value:" WeekYear"},{text:"01/01/2017 - 01/07/2017",value:"WeekYearDateRange"}]:"DateHour"===this.selectedFieldName?[{text:"23/07/2017 00",value:"DateHour"},{text:"Custom",value:"Custom"}]:"DayOfWeek"===this.selectedFieldName?[{text:"Sunday, Monday",value:"FullDayOfWeek"},{text:"Sun, Mon, Tue",value:"HalfDayOfWeek"},{text:"S, M, T, W",value:"SingleDayOfWeek"},{text:"1, 2, 3, ...7",value:"DayOfWeekNumber"}]:"WeekOfYear"===this.selectedFieldName?[{text:"00, 01, 02, 03, ...",value:"WeekOfYearNumber"},{text:"Week 0, Week 1, Week 2, ...",value:"WeekOfYearWithoutZero"},{text:"Week 00, Week 01, Week 02, ...",value:"WeekOfYearWithZero"}]:"DayMonthYear"===this.selectedFieldName?[{text:"24/07/1994",value:"DayMonthYear"}]:"MonthDayYear"===this.selectedFieldName?[{text:"07/24/1994",value:"MonthDayYear"}]:void 0},e.prototype.fiscalTypeList=function(){return[{text:"Jan",value:"Jan"},{text:"Feb",value:"Feb"},{text:"Mar",value:"Mar"},{text:"Apr",value:"Apr"},{text:"May",value:"May"},{text:"Jun",value:"Jun"},{text:"Jul",value:"Jul"},{text:"Aug",value:"Aug"},{text:"Sep",value:"Sep"},{text:"Oct",value:"Oct"},{text:"Nov",value:"Nov"},{text:"Dec",value:"Dec"}]},e.prototype.closeButtonClick=function(){this.dateSettingsDialog.data("BoldBIDashboardDialog").close()},e.prototype.okButtonClick=function(){var e=new BoldBIDashboard.Dashboard.DatesettingInfoForUI,t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_formatdrop").data("BoldBIDashboardDropDownList").getSelectedValue();e.Format=t,t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field").val(),e.CustomFormat=t,t=this.dateSettingsDialog.find("#"+this.id+"_date_settings_fiscaldrop").data("BoldBIDashboardDropDownList").getSelectedValue(),e.FiscalYear=t,e.UniqueColumnName=this.uniqueColumnName,BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[e]),this.closeButtonClick())},e.prototype.openDatesettingClick=function(e,t,i,a){this.resetDateSetting(),this.targetInstance=e,this.targetMethod=t,this.dateSettingsInfo=a,this.uniqueColumnName=i.UniqueColumnName,this.formatDropdown.data("BoldBIDashboardDropDownList").setModel({dataSource:this.formatTypeList()}),this.formatDropdown.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.columnNameTag.text(i.DisplayName),this.dateSettingsDialog.data("BoldBIDashboardDialog").open(),BoldBIDashboard.isNullOrUndefined(a)||(e=a.Format,this.dateFormatDropObj.selectItemByValue(e),t=a.CustomFormat,this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field").val(t),i=this.customFormatDateText(t),this.dateSettingsDialog.find("#"+this.id+"_date_settings_custom_Field_reference_text").val(i),e=a.FiscalYear,this.fiscalFormatDropObj.selectItemByValue(e))},e.prototype.resetDateSetting=function(){this.dateSettingsInfo=null,this.uniqueColumnName=null,this.targetInstance=null,this.targetMethod=null},e.prototype.wireEvents=function(){this.okButton.on("click","#"+this.id+"_date_settings_ok",this.bbdesigner$.proxy(this.okButtonClick,this)),this.cancelButton.on("click","#"+this.id+"_date_settings_cancel",this.bbdesigner$.proxy(this.closeButtonClick,this))},e.prototype.unWireEvents=function(){this.okButton.off("click","#"+this.id+"_date_settings_ok",this.bbdesigner$.proxy(this.okButtonClick,this)),this.cancelButton.off("click","#"+this.id+"_date_settings_cancel",this.bbdesigner$.proxy(this.closeButtonClick,this))},e.prototype.destroy=function(){this.unWireEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_date_settings")),0<this.dashboardDesigner.element.find("#"+this.id+"_date_settings").length&&this.dashboardDesigner.element.find("#"+this.id+"_date_settings").remove()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DateSettingsCust",InternalDateSettingsInfo,window),function(v){var e;function t(e){this.designer=e,this.bbdesigner$=this.designer.bbdesigner$,this.dataConfiguration=this.designer.modules.dataConfiguration,this.dragdropHelper=this.designer.dragDropHelper,this.widgetHelper=this.designer.modules.widgetHelper}e=v.Dashboard||(v.Dashboard={}),t.prototype.renderTreeView=function(e,t){for(var i,a=this.widgetHelper.getCurrentWidgetInstance().getFieldView(),o=0;o<a.length;o++)"Parameters"!==a[o].name&&(i="Measures"===a[o].name?e.Measure:e.Dimension,this.renderDatasource(i,a[o].name,t,!0))},t.prototype.renderDatasource=function(e,t,i,a){var o,s,n;void 0===a&&(a=!1),("ListBox"!==(o=this.widgetHelper.getCurrentWidgetInstance()).Type&&"ComboBox"!==o.Type||"Measures"!==t)&&(o=this.designer._id+"_"+t.toLowerCase()+"_categoryList",(n=this.designer.element.find("#"+this.designer._id+"_"+t+"_categoryList")).empty(),s=v.buildTag("div.bbi-dbrd-treeview e-dbrd-"+t.toLowerCase()+"-treeview e-control","",{},{id:o+"_treeview"}),n.append(s),0<(n=this.designer.element.find("#"+this.designer._id+"_"+t+"_categoryListPanel")).length)&&(t=n.data("ejcroller"),v.isNullOrUndefined(t)||t.destroy(),new v.Dashboard.HierachicalSchemaView(this.designer,this.getModel()).render(s,e,n,o,!1,a),this.dragIntialize(s,!1))},t.prototype.dragIntialize=function(e,t){var i,a,t=t?ejdashboard.base.getComponent(e.children().last()[0],"treeview"):ejdashboard.base.getComponent(e.children().first()[0],"treeview");if(!v.isNullOrUndefined(t))for(t.nodeDragStart=this.bbdesigner$.proxy(this.nodeDragStart,this),t.nodeDragStop=this.bbdesigner$.proxy(this.nodeDragStop,this),t.nodeDragging=this.bbdesigner$.proxy(this.nodeDrag,this),i=t.element.ej2_instances,a=0;a<i.length;a++)if("draggable"===i[a].getModuleName()){i[a].dragArea="#"+this.designer._id+"_dataTabRootElement";break}},t.prototype.nodeDrag=function(e){var t,i=this.dragdropHelper.getPosition("clientX",e.event),a=this.dragdropHelper.getPosition("clientY",e.event),o=this.bbdesigner$(e.draggedNode).data("fieldInfo"),s=this.dragdropHelper.getDataCategoryListContainer(e.event,o.ContainerName),n=v.isNullOrUndefined(s)?null:s.Container,r=v.isNullOrUndefined(s)?null:s.ParentContainer,d=this.designer.element.find("#"+this.designer._id+"_dataTabElement");!v.isNullOrUndefined(n)&&v.isNullOrUndefined(o.ContainerType)&&(o.ContainerType=s.Container.data("container-info").ContainerType),s=this.widgetHelper.getCurrentWidgetInstance(),this.bbdesigner$(e.clonedNode).find(".e-icons").css("display","none"),s=s.onFieldDragDrop(o),!v.isNullOrUndefined(n)&&0<n.length&&s?(o=n.data("container-info"),d.css("cursor","default"),t=s=-1,t=(r=this.dragdropHelper.getEmptyFieldRowAndHoverIndex(n,r,i,a)).emptyRowIndex,(-1<(s=r.elementHoverIndex)||0===n.children().length)&&t!==s?this.dragdropHelper.insertEmptyField(t,s,o,n):-1===s&&(d.css("cursor","not-allowed"),"e-drop-next"===e.dropIndicator||"e-drop-in"===e.dropIndicator||"e-drop-out"===e.dropIndicator)&&this.bbdesigner$(e.clonedNode).find(".bbi-treeview-div").css("cursor","no-drop"),"Measures"!==o.Name&&"Dimensions"!==o.Name||this.designer.element.find("#"+this.designer._id+"_dataTabElement").css("cursor","not-allowed")):(d.css("cursor","not-allowed"),(i=this.designer.element.find("div.bbi-dbrd-rendercolumn-container .bbi-categorylistdiv-emptyfield:not(:last-child)")).insertAfter(i.siblings(":last")),this.bbdesigner$(e.clonedNode).find(".bbi-treeview-div").css("cursor","no-drop")),e.cancel=!0},t.prototype.nodeDragStart=function(e){var t,i,a,o,s,n,r=this;if(this.bbdesigner$(e.draggedNode).find(".bbi-treeview-div").css("cursor","default"),e.draggedNodeData.hasChildren&&1<e.draggedNodeData.id.length&&(e.cancel=!0,"true"===this.bbdesigner$(e.target).attr("haschild"))&&this.bbdesigner$(e.target).parents(".bbi-treeview-div").css("cursor","no-drop"),v.isNullOrUndefined(this.bbdesigner$(e.draggedNode).data("fieldInfo"))){0;var d=(0<(l=this.bbdesigner$(e.draggedNode).parents(".bbi-dbrd-treeview")).length?ejdashboard.base.getComponent(l.children().first()[0],"treeview"):ejdashboard.base.getComponent(this.bbdesigner$(e.draggedNode).closest(".e-dashboard-treeView")[0],"treeview")).getTreeData(e.draggedNode),l=this.designer.modules.dataSet.datasets.filter(function(e){return e.Id===r.dataConfiguration.selectedDatasetId})[0];if(0<l.Fields.length)if(t=l.Fields,v.isNullOrUndefined(d[0].Id)){if(i=t.filter(function(e){return e.Id===d[0].ColumnId}),a=new v.Dashboard.DSField,0===i.length)for(o=0;o<t.length&&(a=this.getCurrentFieldInfo(t[o],d[0].ColumnId),v.isNullOrUndefined(a));o++);else a=i[0];(s=this.dataConfiguration.convertDataSetToFieldInfo(a,l.Id,l.Name)).FieldType="bbi-designer-dataset-number"===s.FieldActualType?FieldType.Measures:FieldType.Dimensions,n=this.bbdesigner$(e.draggedNode).closest(".bbi-ds-field-container").data("container-info"),s.ContainerName=n.name,this.bbdesigner$(e.draggedNode).data("fieldInfo",s)}else this.bbdesigner$(e.clonedNode).find(".e-icons").css("display","none"),this.bbdesigner$(e.clonedNode).find(".bbi-heirarchial-icons.bbi-designer-content-icon").css("bottom","0px"),i=t.filter(function(e){return e.Id===d[0].Id}),(n=this.dataConfiguration.convertDataSetToFieldInfo(i[0],l.Id,l.Name)).FieldType=FieldType.Dimensions,n.DateTimeFormat=d[0].DateTimeFormat,n.ContainerName="Dimensions",n.IsParentField=!1,e.draggedNodeData.hasChildren&&(n.IsParentField=!0),this.bbdesigner$(e.draggedNode).data("fieldInfo",n)}this.bbdesigner$(e.clonedNode).find(".e-treeview-textbox").css("display","none"),this.bbdesigner$(e.clonedNode).find(".e-settings-div").css("display","none"),this.bbdesigner$(e.clonedNode).find(".e-close-parent.e-dimension").css("display","none"),this.bbdesigner$(e.clonedNode).find(".e-text-content.e-icon-wrapper").css("display","contents"),this.bbdesigner$(e.clonedNode).find(".all-elements-div").css("height","25px"),this.bbdesigner$(e.clonedNode).find(".bbi-parent-name").removeAttr("style"),this.bbdesigner$(e.clonedNode).css("background","transparent"),this.bbdesigner$(e.clonedNode).find(".bbi-treeview-rearrange-content").css({background:"none",border:"none"}),this.bbdesigner$(e.clonedNode).find(".bbi-treeview-uparrow-icon, .bbi-treeview-menu-icon, .bbi-treeview-downarrow-icon").css("display","none"),this.designer.element.find("#"+this.designer._id+"_Dimensions_categoryItem").append(this.bbdesigner$(e.clonedNode))},t.prototype.nodeDragStop=function(e){var t,i,a,o;if("e-drop-next"===e.dropIndicator||"e-drop-in"===e.dropIndicator?e.cancel=!0:"e-no-drop"===e.dropIndicator&&(t=this.bbdesigner$(e.draggedNode).data("fieldInfo"),0<(s=this.bbdesigner$(e.target).closest(".bbi-ds-assign-field-container-scroller")).length)&&(v.isNullOrUndefined(t.IsParentField)||t.IsParentField)&&this.dragdrop(s,JSON.parse(JSON.stringify(t)),e),"e-list-item e-level-2 e-heirachy-field"===e.draggedNode.className&&"e-no-drop"!==e.dropIndicator){if(t=this.designer.element.find("#"+this.designer._id+"_designAreaContainer"),i=this.designer.element.find("#"+this.designer._id+"_dataTabElement"),""!==e.droppedNodeData.id&&""!==e.draggedNodeData.id){if(a=(s=e.draggedNode.parentElement).children,""===e.draggedNode.id)for(o=0;o<a.length;o++)a[o].id=o;var s=this.bbdesigner$(e.draggedNode.parentNode.offsetParent).data("fieldInfo"),n=+e.draggedNode.id,r=+e.droppedNode.id;for(r<n?(s.ChildHierarchicalFields.splice(r,0,s.ChildHierarchicalFields[n]),s.ChildHierarchicalFields.splice(1+n,1),this.designer.element.find("#"+a[n].id).insertBefore(a[r])):n<r&&(r==s.ChildHierarchicalFields.length-1?s.ChildHierarchicalFields.push(s.ChildHierarchicalFields[n]):s.ChildHierarchicalFields.splice(1+r,0,s.ChildHierarchicalFields[n]),s.ChildHierarchicalFields.splice(n,1),this.designer.element.find("#"+a[n].id).insertAfter(a[r])),this.bbdesigner$(i).css("cursor","default"),t.css("cursor","default"),this.bbdesigner$(e.draggedNode.parentNode.offsetParent).data("fieldInfo",s),this.dataConfiguration.rearrangeChildFields(s,r,n),o=0;o<a.length;o++)a[o].id=""}this.bbdesigner$(i).css("cursor","default"),t.css("cursor","default")}},t.prototype.dragdrop=function(e,t,i,a){var o,s,n,r=-1,d=this.bbdesigner$(i.target).attr("id"),l=this.widgetHelper.getCurrentWidgetInstance(),h=JSON.parse(JSON.stringify(t)),p=e.find(".bbi-ds-assign-field-container"),c=p.data("container-info"),u=h.ContainerName=c.Name,b=p.children(),h=!!v.isNullOrUndefined(a)&&l.onFieldDragDrop(h,e,i),e=v.isNullOrUndefined(this.designer)||v.isNullOrUndefined(this.designer.modules)||v.isNullOrUndefined(this.designer.modules.dataSource)||v.isNullOrUndefined(this.designer.modules.dataSource.datasources)?null:this.designer.modules.dataSource.datasources.filter(function(e){return e.Id===t.DatasourceID})[0],e=!(v.isNullOrUndefined(e)||v.isNullOrUndefined(e.ConnectionProperties)||v.isNullOrUndefined(e.ConnectionProperties.DataProvider)||"SSAS"!==e.ConnectionProperties.DataProvider.toUpperCase()),g=this.dataConfiguration.getCategories().filter(function(e){return e.Name===c.Name}),g=!v.isNullOrUndefined(g[0])&&g[0].isCustomHierarchy;if((h&&v.isNullOrUndefined(a)||!v.isNullOrUndefined(a))&&(e||g)){for(var m=p.find(".bbi-category-empty-field-wrap"),f=0,D=0,y=0,B=0,I=0;I<b.length;I++)o=b[I].getElementsByClassName("e-heirachy-field"),o=this.bbdesigner$(o),v.isNullOrUndefined(o.attr("child-field-count"))||(f+=v.parseInt(o.attr("child-field-count"),10)),-1===r&&(B=f,D++),b[I].id===m.attr("id")&&(r=I),b[I].id===this.designer.id+"_"+t.Id+"_categoryListDiv_"+t.UniqueId&&0,D<B&&(D=B,y++);r+=B=0<B?0<y?B-y:B-1:B,0;var h=null,x=!1,_=l.DataGroupInfo.FieldContainers;if(m.length<1||!v.isNullOrUndefined(a)&&!a){for(s=(e=p.find("#"+d)).closest(".bbi-ds-categoryLabel"),e.closest(".bbi-ds-categoryLabel").length<1&&(s=v.isNullOrUndefined(a)||a?this.bbdesigner$(b[b.length-1]):this.bbdesigner$(b[0])),I=0;I<b.length;I++)s.attr("id")===b[I].id&&(r=I);h=this.dragdropHelper.getRemoveItem(e,p,a,r,t)}for(n=0;n<_.length;n++)if(u===_[n].Name){_[n].FieldInfos.filter(function(e){e.Id===t.Id&&v.isNullOrUndefined(t.IsParentField)&&(x=!0)});break}!x&&(g=!v.isNullOrUndefined(t.IsParentField)&&t.IsParentField,"Dimensions"===t.ContainerName&&c.ContainerType!==FieldContainerType.Numeric||"Measures"===t.ContainerName&&c.ContainerType!==FieldContainerType.Non_Numeric||g)&&((d=this.dragdropHelper.getAddItem(l,t,r,u,!0,B,y)).DisplayName=d.IsDisplayNameEdited||d.DateTimeFormat!==DateTimeFormat.None?this.designer.modules.util.getDisplayName(d):v.isNullOrUndefined(d.DisplayName)?d.Name:d.DisplayName,m.length<1?this.dataConfiguration.replaceItem(h,d):(v.isNullOrUndefined(a)||a||this.dataConfiguration.removeItem(h,!1,!0,!1),!v.isNullOrUndefined(d.IsParentField)&&d.IsParentField?this.addHeirachialDateFieldItems(d,c):this.dataConfiguration.addItem(d,!1,!0)))}i.cancel=!0},t.prototype.addHeirachialDateFieldItems=function(e,t){var i,a,o,s,n;if(t.ContainerType!==FieldContainerType.Numeric){if(v.isNullOrUndefined(t.CategoryCount)){if(e.DateTimeFormat=DateTimeFormat.None,e.DisplayName=v.isNullOrUndefined(e.DisplayName)?e.Name:e.DisplayName,e.ParentId=void 0,i=[DateTimeFormat.Year,DateTimeFormat.Quarter,DateTimeFormat.Month,DateTimeFormat.Day,DateTimeFormat.WeekOfYear],"bbi-designer-dataset-datetime"===e.FieldActualType)for(e.ChildHierarchicalFields=[],o=0;o<i.length;o++)(s=JSON.parse(JSON.stringify(e))).DateTimeFormat=i[o],s.ParentId=e.UniqueId,s.ParentUsualId=e.Id,s.ParentName=e.Name,s.UniqueId=this.dataConfiguration.getAvailableName(),s.ItemIndex=e.ItemIndex+o,s.Name=e.Name,s.DisplayName=this.designer.modules.util.getDisplayName(s),s.IsDisplayNameEdited=!1,s.IsParentField=!1,s.ChildHierarchicalFields=null,this.dataConfiguration.addItem(s,!1,!0),e.ChildHierarchicalFields.push(s);else if("bbi-designer-dataset-string"===e.FieldActualType)for(a=v.isNullOrUndefined(e.ChildHierarchicalFields)?1:e.ChildHierarchicalFields.length,o=0;o<a;o++)(s=JSON.parse(JSON.stringify(e.ChildHierarchicalFields[o]))).ContainerType=e.ContainerType,s.DateTimeFormat=DateTimeFormat.None,s.ParentId=e.UniqueId,s.ParentUsualId=e.Id,s.ParentName=e.Name,s.UniqueId=this.dataConfiguration.getAvailableName(),s.ItemIndex=e.ItemIndex+o,s.IsParentField=!1,s.ContainerName=e.ContainerName,s.ColumnType=e.ColumnType,s.ColumnId=e.ColumnId,s.DatasourceID=e.DatasourceID,s.DatasourceName=e.DatasourceName,s.FieldActualType=(v.isNullOrUndefined(s.FieldActualType)?e:s).FieldActualType,s.FieldType=(v.isNullOrUndefined(s.__type)||v.isNullOrUndefined(s.FieldType)?e:s).FieldType,s.ChildHierarchicalFields=null,s.SummaryType=this.widgetHelper.getCurrentWidgetInstance().getDefaultSummaryType(s.FieldType,s.ContainerType,s.IsAggregatedExpression),s.DisplayName=v.isNullOrUndefined(e.ChildHierarchicalFields)?e.Name:this.designer.modules.util.getDisplayName(s),this.dataConfiguration.addItem(s,!1,!0),e.ChildHierarchicalFields[o]=s}else e.DateTimeFormat=DateTimeFormat.Year,e.DisplayName=DateTimeFormat.Year+"("+e.Name+")",e.ContainerType=t.ContainerType,e.IsParentField=!1;this.dataConfiguration.addItem(e,!1,!0)}else n=void 0,v.isNullOrUndefined(e.ChildHierarchicalFields)?n=JSON.parse(JSON.stringify(e)):delete(n=JSON.parse(JSON.stringify(e))).ChildHierarchicalFields,n.DateTimeFormat=DateTimeFormat.None,n.ContainerType=t.ContainerType,n.SummaryType=SummaryType.COUNT,n.DisplayName=this.designer.modules.util.getDisplayName(n),this.dataConfiguration.addItem(n,!1,!0)},t.prototype.getCurrentFieldInfo=function(e,t){var i,a=null;if(e.Id===t)a=e;else if(!v.isNullOrUndefined(e.ChildFields))for(i=0;i<e.ChildFields.length&&(a=this.getCurrentFieldInfo(e.ChildFields[i],t),v.isNullOrUndefined(a));i++);return a},t.prototype.getModel=function(){var e=new v.Dashboard.HierachialModel;return e.ShowDataTypeIcon=!0,e.CanDragDrop=!0,e},e.HierarchicalConfigurationView=t}(BoldBIDashboard=BoldBIDashboard||{}),InternalFormatDialog=function(){function InternalFormatDialog(e){this.previewTag=null,this.formatTag=null,this.representationTag=null,this.decimalTag=null,this.cultureTag=null,this.decimalSymbolTextBox=null,this.groupingSymbolTextBox=null,this.leftTextBox=null,this.rightTextBox=null,this.dialogTag=null,this.negativetable=null,this.appendTextDiv=null,this.currentSymbolChange=!1,this.saveOriginalCulture=!1,this.currentDecimal=null,this.currentGroup=null,this.dataSourceName=null,this.dashboardDesigner=null,this.lakhsAndCroreInputBox=null,this.lakhsAndCroreTbl=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.renderFormatDialog(),this.unWireEvents(),this.wireEvents()}return InternalFormatDialog.prototype.renderFormatDialog=function(){var e=this.dialogTag=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{cursor:"default"},{id:this.id+"_format_dialog"}),t=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing","",{"padding-top":"6px","border-radius":"2px",overflow:"auto",height:"350px",width:"100%"},{id:this.id+"_format_body_div"}),i=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing  bbi-dbrd-designer-scroller e-dbrd-control bbi-dbrd-designer-scroll-style-3","",{float:"left",width:"352px",height:"300px",padding:"10px 10px 0px 10px"},{id:this.id+"_format_head_div"}),a=BoldBIDashboard.buildTag("div.bbi-designer-fieldcontainer-box-sizing","",{float:"right","border-left":"1px solid var(--designer-secondary-border-color)",height:"340px",width:"216px","padding-top":"5px","padding-right":"10px"},{id:this.id+"_format_sub_div"}),o=BoldBIDashboard.buildTag("div","",{"padding-bottom":"10px"},{id:this.id+"_format_type_div"}),s=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{unselectable:"on"}),n=BoldBIDashboard.buildTag("tr","",{},{}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Type",{"font-size":"12px"},{}),d=BoldBIDashboard.buildTag("td","",{width:"11px"},{}),l=this.formatTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_type_drop"}),h=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_format_prvw_div"}),p=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{unselectable:"on"}),c=BoldBIDashboard.buildTag("tr","",{},{}),u=BoldBIDashboard.buildTag("td","",{"padding-bottom":"51px","padding-left":"12px"},{}),b=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Preview:",{"font-size":"14px","font-weight":"600"},{type:"label"}),g=BoldBIDashboard.buildTag("div","",{border:"1px solid var(--designer-secondary-border-color)",height:"150px",width:"200px","margin-left":"13px",display:"block"}),m=BoldBIDashboard.buildTag("div","",{display:"table"}),f=this.previewTag=BoldBIDashboard.buildTag("div","",{height:"142px",width:"192px",position:"absolute","word-break":"break-all","align-items":"center",display:"flex","justify-content":"center",overflow:"hidden",padding:"4px","font-size":"24px","white-space":"pre-wrap"},{id:this.id+"_format_preview_span"}),D=this.locale.dialogOptions,y=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",D.cancelButtonText,{float:"right"},{id:this.id+"_format_btn_cancel",type:"button"}),D=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",D.okButtonText,{float:"right"},{id:this.id+"_format_btn_ok",type:"button"}),B=BoldBIDashboard.buildTag("div","",{},{}),I=BoldBIDashboard.buildTag("div","",{},{});e.append(t),t.append(i),I.append(o),B.append(I),i.append(B),o.append(s),s.append(n),d.append(l),n.append(r).append(d),t.append(a),a.append(h),h.append(p),p.append(c),c.append(u),u.append(b),a.append(g),g.append(m),m.append(f),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({minWidth:560,minHeight:400,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,title:"Measure Formatting",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),l.BoldBIDashboardDropDownList({DataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"230px",height:"26px",change:this.bbdesigner$.proxy(this.renderFormatSample,this),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),this.dashboardDesigner.element.find("#"+this.id+"_format_dialog_foot").append(y,D),this.renderFormatFields(I),this.scroller=i.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,height:"340px",buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}).data("BoldBIDashboardScroller")},InternalFormatDialog.prototype.renderNumericTextBox=function(e){var t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Decimal Places",{"font-size":"12px"},{}),a=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),o=this.decimalTag=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_format_decimal"});e.append(t),t.append(i),t.append(a),a.append(o),o.ejNumericTextbox({showSpinButton:!0,width:"230px",enabled:!0,value:2,change:this.bbdesigner$.proxy(this.changeFormatValues,this),minValue:0,maxValue:6,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label"})},InternalFormatDialog.prototype.renderFormatFields=function(e){var t,i=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_format_div"}),a=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),s=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Representation",{"font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{width:"20px"},{}),d=this.representationTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_repDrop"}),l=this.negativetable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),h=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),p=BoldBIDashboard.buildTag("tr","",{},{}),c=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Currency ",{"font-size":"12px"},{}),u=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),b=this.cultureTag=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_culture_drop"}),g=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),m=BoldBIDashboard.buildTag("tr","",{},{}),f=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.thousandSeparator.decimal,{"font-size":"12px"},{}),D=(this.decimalSymbolTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_decimal_text"}),BoldBIDashboard.buildTag("td","",{width:"31px"},{})),y=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{}),B=BoldBIDashboard.buildTag("tr","",{},{}),I=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.thousandSeparator.group,{"font-size":"12px"},{});this.groupingSymbolTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_group_text"}),t=BoldBIDashboard.buildTag("td","",{width:"31px"},{}),e.append(i),i.append(o),this.renderLakhsAndCroreCheckBox(i),i.append(a),o.append(s),s.append(n).append(r),this.renderNumericTextBox(a),i.append(h),h.append(p),p.append(c).append(u),u.append(b),i.append(g),g.append(m),m.append(f).append(D),D.append(this.decimalSymbolTextBox),i.append(y),y.append(B),B.append(I).append(t),t.append(this.groupingSymbolTextBox),i.append(l),r.append(d),this.renderAppendTextField(i),d.BoldBIDashboardDropDownList({dataSource:this.getRepresentation(),fields:{text:"text",value:"value"},selectedIndex:0,width:"230px",height:"26px",change:this.bbdesigner$.proxy(this.changeFormatValues,this),showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),e=b.BoldBIDashboardDropDownList({dataSource:BoldBIDashboard.DashboardUtil.getCultures(),fields:{text:"DisplayName",value:"CurrencySymbol"},enabled:!0,width:"230px",height:"28px",change:this.bbdesigner$.proxy(this.currentCultureChange,this),showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}).data("BoldBIDashboardDropDownList"),this.decimalSymbolTextBox.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"230px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign",focusOut:this.bbdesigner$.proxy(this.saveSymbols,this)}),this.groupingSymbolTextBox.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"230px",height:"26px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign",focusOut:this.bbdesigner$.proxy(this.saveSymbols,this)}),e.selectItemByText(BoldBIDashboard.DashboardUtil.autoformatdisplayText)},InternalFormatDialog.prototype.renderLakhsAndCroreCheckBox=function(e){this.lakhsAndCroreTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%","padding-bottom":"10px"},{});var t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.measureFormatting.enableLkhsAndCrores,{"font-size":"12px",display:"inline-flex"},{}),a=BoldBIDashboard.buildTag("td","",{width:"23px",display:"inline-flex","padding-left":"120px"},{});this.lakhsAndCroreInputBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_format_decimal_text"}),e.append(this.lakhsAndCroreTbl),this.lakhsAndCroreTbl.append(t),a.append(this.lakhsAndCroreInputBox),t.append(a).append(i),this.lakhsAndCroreInputBox.BoldBIDashboardCheckBox({checked:!0,change:this.bbdesigner$.proxy(this.updateChckBox,this),width:"20px",cssClass:"e-designer-prop-checkbox"})},InternalFormatDialog.prototype.updateChckBox=function(){},InternalFormatDialog.prototype.renderAppendTextField=function(e){var t=this.appendTextDiv=BoldBIDashboard.buildTag("div","",{}),i=BoldBIDashboard.buildTag("div","",{width:"75px","padding-left":"4px"}),a=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.dialogText.appendText,{"font-size":"12px"},{type:"label"}),a=(i.append(a),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"4px 1px"},{})),o=this.bbdesigner$("<tr></tr>"),s=this.bbdesigner$("<tr></tr>"),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Left",{"font-size":"12px"},{}),r=BoldBIDashboard.buildTag("td","",{"padding-right":"7px"},{}),d=this.id+"_format_leftText",l=this.leftTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:d,autocomplete:"off"}),h=(r.append(l),BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","Right",{"font-size":"12px"},{})),p=BoldBIDashboard.buildTag("td","",{},{}),c=this.id+"_format_rightText",u=this.rightTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:c,autocomplete:"off"});p.append(u),o.append(n).append(h),s.append(r).append(p),a.append(o).append(s),t.append(i).append(a),e.append(t),l.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"168px",height:"28px",showRoundedCorner:!0,cssClass:"e-designer-param-assign",change:this.bbdesigner$.proxy(this.changeFormatValues,this),focusOut:this.bbdesigner$.proxy(this.requestParamPreviewText,this,null)}),u.BoldBIDashboardMaskEdit({name:"mask",inputMode:BoldBIDashboard.InputMode.Text,width:"168px",height:"28px",showRoundedCorner:!0,cssClass:"e-designer-param-assign",change:this.bbdesigner$.proxy(this.changeFormatValues,this),focusOut:this.bbdesigner$.proxy(this.requestParamPreviewText,this,null)}),l.off("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,d)),l.on("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,d)),u.off("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,c)),u.on("keydown",this.bbdesigner$.proxy(this.bindParameterList,this,c))},InternalFormatDialog.prototype.requestParamPreviewText=function(e,t){var i,a,o,s,n,r,d;void 0===t&&(t=null),"number"===(t=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue()).toLowerCase()&&(i="",a=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),o=this.decimalTag.data("ejNumericTextbox").getValue(),s=this.getCurrentCulture(),this.enableDecimalBox(),n=this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),r=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),(d={PrefixValue:"",SuffixValue:""}).PrefixValue=BoldBIDashboard.isNullOrUndefined(n)?"":this.dashboardDesigner.checkAndUpdateParameterValue(n,this.dataSourceName,!1,e),d.SuffixValue=BoldBIDashboard.isNullOrUndefined(r)?"":this.dashboardDesigner.checkAndUpdateParameterValue(r,this.dataSourceName,!1,e),i=this.getPreviewValue(t,a,o,s,d),this.previewTag.text(i))},InternalFormatDialog.prototype.bindParameterList=function(e,t){var i={fnction:this.bbdesigner$.proxy(this.changeFormatValues,this)};this.dashboardDesigner.getParamListInInputElement(e,i,t)},InternalFormatDialog.prototype.getPreviewValue=function(e,t,i,a,o){var s=Math.pow(10,3),n=Math.pow(10,6),r=Math.pow(10,9),d=Math.pow(10,5),l=Math.pow(10,7),h=12345,p="",c="";if("percentage"!==e.toLowerCase()){switch(t){case"Auto":case"Thousands":h/=s,p="K";break;case"Millions":h/=n,p="M";break;case"Billions":h/=r,p="B";break;case"Lakhs":h/=d,p="L";break;case"Crores":h/=l,p="Cr"}c="number"===e.toLowerCase()?BoldBIDashboard.globalize.format(h,"N"+i,a.Name):BoldBIDashboard.globalize.format(h,"C"+i,a.Name),c+=p;var t=this.getDecimalSeparator(),e=this.currentDecimal,a=this.getGroupSeparator(),u=this.currentGroup;null!==t&&null!==a&&(t!==e||a!==u)&&((t=c.split(t))[0]=t[0].replace(a,u),c=1<t.length?t[0]+e+t[1]:0!==i?t[0]+e:t[0]),!this.currentSymbolChange&&this.saveOriginalCulture&&(this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup)),c=o.PrefixValue+c+o.SuffixValue}else c=h.toFixed(i)+"%";return c},InternalFormatDialog.prototype.getCultureScriptFile=function(culture,selectedValue,repDropdown,decimal){var _this=this,dashboardDesigner=this.dashboardDesigner,eventArgs={headers:[],serviceAuthorizationToken:dashboardDesigner.model.serviceAuthorizationToken,actionType:"GetCultureScript"};dashboardDesigner.triggerEvents("ajaxBeforeLoad",eventArgs),!BoldBIDashboard.isNullOrUndefined(eventArgs.cancel)&&eventArgs.cancel||this.bbdesigner$.ajax({url:dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getculturescripts+"?culture="+culture.Name,dataType:"html",contentType:"application/javascript",crossDomain:!0,cache:!0,error:function(){},beforeSend:function(e){_this.beforeSendRequest(e,eventArgs)},success:function(args){eval(args),_this.culturePreviewValue(culture,selectedValue,repDropdown,decimal,!0)},complete:function(){_this.previewTag.css("opacity","1")}})},InternalFormatDialog.prototype.beforeSendRequest=function(e,t){if(BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.modules.util.clientId)||""===this.dashboardDesigner.modules.util.clientId||e.setRequestHeader("ClientID",this.dashboardDesigner.modules.util.clientId),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.serviceAuthorizationToken)||e.setRequestHeader("Authorization",this.dashboardDesigner.model.serviceAuthorizationToken),t&&t.headers&&0<t.headers.length)for(var i=0;i<t.headers.length;i++)e.setRequestHeader(t.headers[i].Key,t.headers[i].Value)},InternalFormatDialog.prototype.saveSymbols=function(){0===this.decimalSymbolTextBox.val().length&&(this.showSeparatorAlertDialog(this.locale.alertWindowMesages.decimalSymbolEmptyWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal)),this.decimalSymbolTextBox.val()===this.groupingSymbolTextBox.val()&&(this.showSeparatorAlertDialog(this.locale.alertWindowMesages.groupingAndDecimalSymbolEqualWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup)),this.decimalSymbolTextBox.val().match(/[a-zA-Z0-9]/)&&(this.showSeparatorAlertDialog(this.locale.thousandSeparator.decimal+this.locale.alertWindowMesages.symbolBeingAlphaNumericWarningMessage),this.decimalSymbolTextBox.val(this.currentDecimal)),this.groupingSymbolTextBox.val().match(/[a-zA-Z0-9]/)?(this.showSeparatorAlertDialog(this.locale.thousandSeparator.group+this.locale.alertWindowMesages.symbolBeingAlphaNumericWarningMessage),this.groupingSymbolTextBox.val(this.currentGroup)):(0!==this.decimalSymbolTextBox.val().length&&(this.currentDecimal=this.decimalSymbolTextBox.val()),this.currentGroup=this.groupingSymbolTextBox.val(),this.currentSymbolChange=!0,this.saveOriginalCulture=!1,this.changeFormatValues(this))},InternalFormatDialog.prototype.updateTheCheckBoxOnChange=function(){var e=this.getCurrentCulture(),e=this.cultureTag.data("BoldBIDashboardDropDownList").model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?"auto":e.Name,t=this.lakhsAndCroreInputBox.data("BoldBIDashboardCheckBox").isChecked(),i=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),i=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFormat,i);this.updateLakhsAndCroreInput(i,e,t),this.scroller.refresh()},InternalFormatDialog.prototype.updateRepOnCultureChange=function(){var t,e=this.getCurrentCulture().Name,i=[],i=BoldBIDashboard.DashboardUtil.isRequiredCulture(e)?this.getAllRepresentation():this.getRepresentation(),e=this.representationTag.data("BoldBIDashboardDropDownList");e.model.dataSource.length!==i.length&&(t=e.getSelectedValue(),e.setModel({dataSource:i}),0===i.filter(function(e){return e.value===t}).length?e.selectItemByIndex(0):e.selectItemByValue(t))},InternalFormatDialog.prototype.showSeparatorAlertDialog=function(e){this.dashboardDesigner.modules.util.alertDialog(this.locale.alertWindowMesages.draftAlertTitle,e,IconType.warning,AlertType.Alert,!1,"Sample")},InternalFormatDialog.prototype.currentCultureChange=function(e){this.currentDecimal=this.getDecimalSeparator(),this.currentGroup=this.getGroupSeparator(),e.selectedText===BoldBIDashboard.DashboardUtil.autoformatdisplayText?(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").disable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").disable()):(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").enable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").enable()),this.currentSymbolChange=!1,this.changeFormatValues(this),e.isInteraction&&(this.updateRepOnCultureChange(),this.updateTheCheckBoxOnChange())},InternalFormatDialog.prototype.culturePreviewValue=function(e,t,i,a,o){this.enableDecimalBox();var s=this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),n=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),r={PrefixValue:"",SuffixValue:""};r.PrefixValue=BoldBIDashboard.isNullOrUndefined(s)?"":s,r.SuffixValue=BoldBIDashboard.isNullOrUndefined(n)?"":n,BoldBIDashboard.isNullOrUndefined(o)||!0!==o||(this.currentDecimal=this.getDecimalSeparator(t,e.Name),this.currentGroup=this.getGroupSeparator(t,e.Name),this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup)),s=this.getPreviewValue(t,i,a,e,r),this.setPreviewTextFontSize(s),this.previewTag.text(s),this.updatePreviewContentStyle(),this.requestParamPreviewText(null)},InternalFormatDialog.prototype.getCurrentCulture=function(){var e,t=this.cultureTag.data("BoldBIDashboardDropDownList").model.text,i=BoldBIDashboard.DashboardUtil.getCultures();if(t===BoldBIDashboard.DashboardUtil.autoformatdisplayText){for(e=0;e<i.length;e++)if(i[e].Name===this.dashboardDesigner.model.localeSettings.culture)return i[e];return i[66]}for(e=0;e<i.length;e++)if(t===i[e].DisplayName)return i[e]},InternalFormatDialog.prototype.changeFormatValues=function(e){e.isInteraction&&this.updateTheCheckBoxOnChange();e=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue();this.formatValues(e)},InternalFormatDialog.prototype.formatValues=function(e){var t,i=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),a=this.decimalTag.data("ejNumericTextbox").getValue();"percentage"===e.toLowerCase()?(t=this.getPreviewValue(e,i,a),this.setPreviewTextFontSize(t),this.previewTag.text(t),this.updatePreviewContentStyle()):(t=this.getCurrentCulture(),BoldBIDashboard.globalize.findCulture(t.Name).name!==t.Name?(this.previewTag.css("opacity",".5"),this.getCultureScriptFile(t,e,i,a)):this.culturePreviewValue(t,e,i,a))},InternalFormatDialog.prototype.setPreviewTextFontSize=function(e){var t=this.previewTag.css("font-size"),e=BoldBIDashboard.DashboardUtil.textWidth(e,"Heebo "+t);this.previewTag.css("font-size",100<e?"18px":"24px")},InternalFormatDialog.prototype.updatePreviewContentStyle=function(){this.previewTag.prop("scrollHeight")>this.previewTag.innerHeight()?this.previewTag.css({"align-items":"baseline"}):this.previewTag.css("align-items","center"),this.saveOriginalCulture=!0},InternalFormatDialog.prototype.renderFormatSample=function(e){BoldBIDashboard.isNullOrUndefined(e.value)||(this.decimalSymbolTextBox.val(this.getDecimalSeparator()),this.groupingSymbolTextBox.val(this.getGroupSeparator()),this.resetFormatSample(e.value),this.formatValues(e.value))},InternalFormatDialog.prototype.resetFormatSample=function(e){var t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.cultureTag.data("BoldBIDashboardDropDownList"),a=this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit"),o=this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit"),s=this.leftTextBox.data("BoldBIDashboardMaskEdit"),n=this.rightTextBox.data("BoldBIDashboardMaskEdit");s.setModel({value:""}),n.setModel({value:""}),this.currentDecimal=this.decimalSymbolTextBox.val(),this.currentGroup=this.groupingSymbolTextBox.val(),"number"===e.toLowerCase()?(this.isEnabled(t)||t.enable(),this.isEnabled(i)||i.enable(),this.isEnabled(s)||s.enable(),this.isEnabled(n)||n.enable(),this.isEnabled(a)||a.enable(),this.isEnabled(o)||o.enable()):"currency"===e.toLowerCase()?(this.isEnabled(t)||t.enable(),this.isEnabled(i)||i.enable(),this.isEnabled(s)&&s.disable(),this.isEnabled(n)&&n.disable(),this.isEnabled(a)||a.enable(),this.isEnabled(o)||o.enable()):"percentage"===e.toLowerCase()&&(this.isEnabled(t)&&(t.selectItemByValue("Ones"),t.disable()),this.isEnabled(i)&&i.disable(),this.isEnabled(s)&&s.disable(),this.isEnabled(n)&&n.disable(),this.isEnabled(a)&&a.disable(),this.isEnabled(o)&&o.disable(),this.lakhsAndCroreTbl.css("display","none")),i.model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").disable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").disable()):(this.decimalSymbolTextBox.data("BoldBIDashboardMaskEdit").enable(),this.groupingSymbolTextBox.data("BoldBIDashboardMaskEdit").enable()),this.enableDecimalBox()},InternalFormatDialog.prototype.enableDecimalBox=function(){var e=this.decimalTag.data("ejNumericTextbox");"auto"===this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue().toLowerCase()?e.disable():e.enable()},InternalFormatDialog.prototype.isEnabled=function(e){return e.model.enabled},InternalFormatDialog.prototype.populateFormats=function(e){var t,i;if(!BoldBIDashboard.isNullOrUndefined(e)){var a=e.FormatType,o=e.Unit,s=e.DecimalPoints,n=e.DecimalSeparator,r=e.GroupSeparator,d=BoldBIDashboard.isNullOrUndefined(e.Prefix)?"":e.Prefix,l=BoldBIDashboard.isNullOrUndefined(e.Suffix)?"":e.Suffix,h=e.Culture,p="";if(0<h.length)for(t=BoldBIDashboard.DashboardUtil.getCultures(),i=0;i<t.length;i++)if(h===t[i].Name){p=t[i].DisplayName;break}this.formatTag.data("BoldBIDashboardDropDownList").selectItemByValue(a),this.decimalTag.data("ejNumericTextbox").setModel({value:-1<s?s:0}),this.cultureTag.data("BoldBIDashboardDropDownList").selectItemByText(p),this.updateRepOnCultureChange(),this.representationTag.data("BoldBIDashboardDropDownList").selectItemByValue(0<o.length?o:"Auto"),"auto"!==h&&(this.currentGroup=r.AliasValue,this.currentDecimal=n.AliasValue),this.decimalSymbolTextBox.val(this.currentDecimal),this.groupingSymbolTextBox.val(this.currentGroup),this.leftTextBox.data("BoldBIDashboardMaskEdit").setModel({value:d}),this.rightTextBox.data("BoldBIDashboardMaskEdit").setModel({value:l}),(r={PrefixValue:"",SuffixValue:""}).PrefixValue=BoldBIDashboard.isNullOrUndefined(d)?"":this.dashboardDesigner.checkAndUpdateParameterValue(d,this.dataSourceName,!1,null),r.SuffixValue=BoldBIDashboard.isNullOrUndefined(l)?"":this.dashboardDesigner.checkAndUpdateParameterValue(l,this.dataSourceName,!1,null),n=this.getPreviewValue(a,o,s,this.getCurrentCulture(),r),this.setPreviewTextFontSize(n),this.previewTag.text(n),this.updatePreviewContentStyle(),this.updateLakhsAndCroreInput(e.Unit,e.Culture,e.EnableLakhsAndCroreRep)}},InternalFormatDialog.prototype.updateLakhsAndCroreInput=function(e,t,i){e===NumberFormat.Auto&&("auto"!==t||BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner)||this.dashboardDesigner.model.localeSettings.culture,BoldBIDashboard.DashboardUtil.isRequiredCulture(t))?this.lakhsAndCroreTbl.css("display","block"):this.lakhsAndCroreTbl.css("display","none"),this.lakhsAndCroreInputBox.BoldBIDashboardCheckBox({checked:i})},InternalFormatDialog.prototype.getFormatValues=function(){var e=this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue(),t=this.representationTag.data("BoldBIDashboardDropDownList").getSelectedValue(),i=this.decimalTag.data("ejNumericTextbox").getValue(),a=new Separator,o=new Separator,s=(a.AliasValue=null==this.decimalSymbolTextBox.val()?"":this.decimalSymbolTextBox.val(),o.AliasValue=null==this.groupingSymbolTextBox.val()?"":this.groupingSymbolTextBox.val(),this.leftTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue()),n=this.rightTextBox.data("BoldBIDashboardMaskEdit").get_UnstrippedValue(),r=this.getCurrentCulture(),r=(a.CurrentValue=this.getDecimalSeparator(e,r.Name),o.CurrentValue=this.getGroupSeparator(e,r.Name),this.currentDecimal=a.AliasValue,this.currentGroup=o.AliasValue,this.cultureTag.data("BoldBIDashboardDropDownList").model.text===BoldBIDashboard.DashboardUtil.autoformatdisplayText?"auto":r.Name),d=this.lakhsAndCroreInputBox.data("BoldBIDashboardCheckBox").isChecked();return{Culture:r,DecimalPoints:i,FormatType:BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(DataValueFormat,e),GroupSeparator:o,DecimalSeparator:a,Prefix:s,Suffix:n,Unit:BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFormat,t),EnableLakhsAndCroreRep:d}},InternalFormatDialog.prototype.saveFormat=function(){var e,t=this.getFormatValues();this.dashboardDesigner.paramRegex.test(t.Prefix)||this.dashboardDesigner.paramRegex.test(t.Suffix)?(e={fnction:this.bbdesigner$.proxy(this.formatInWidgets,this)},this.requestParamPreviewText(e)):(BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,t),this.closeDialog())},InternalFormatDialog.prototype.formatInWidgets=function(e){this.dashboardDesigner.updateParamCollection(e);e=this.getFormatValues();BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,e),this.closeDialog()},InternalFormatDialog.prototype.openFormatDialog=function(e,t,i,a,o,s){void 0===t&&(t=null),void 0===i&&(i=null),void 0===a&&(a=!1),void 0===o&&(o=!1),void 0===s&&(s=null),this.callBackfn=null,this.resetPreviewLable(),this.callBackfn=i,this.dataSourceName=t;i=BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.widgetHelper)?null:this.dashboardDesigner.widgetHelper.getCurrentWidgetInstance(),t=!BoldBIDashboard.isNullOrUndefined(i)&&!BoldBIDashboard.isNullOrUndefined(s)&&"PivotGrid"===i.Type&&s.ShowValueType!==ShowValueType.NoCalculation;this.dialogTag.data("BoldBIDashboardDialog").open(),this.formatTag.data("BoldBIDashboardDropDownList").setModel({dataSource:t?this.getFormatListForPivot():this.getFormatList()}),e?this.populateFormats(e):t?this.formatTag.data("BoldBIDashboardDropDownList").selectItemByText("Percentage"):this.formatTag.data("BoldBIDashboardDropDownList").selectItemByText("Number"),a?(this.negativetable.hide(),this.appendTextDiv.hide(),o&&this.enableDecimalSelectionOnly()):(this.negativetable.show(),this.appendTextDiv.show(),this.enableallitems()),this.scroller.refresh()},InternalFormatDialog.prototype.enableDecimalSelectionOnly=function(){var e=this.cultureTag.data("BoldBIDashboardDropDownList"),t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.formatTag.data("BoldBIDashboardDropDownList");t.disable(),e.disable(),i.disable()},InternalFormatDialog.prototype.getDecimalSeparator=function(e,t){return t=BoldBIDashboard.isNullOrUndefined(t)?this.getCurrentCulture().Name:t,"currency"===(e=BoldBIDashboard.isNullOrUndefined(e)?this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue():e).toLowerCase()?BoldBIDashboard.globalize.findCulture(t).numberFormat.currency["."]:"number"===e.toLowerCase()?BoldBIDashboard.globalize.findCulture(t).numberFormat["."]:void 0},InternalFormatDialog.prototype.getGroupSeparator=function(e,t){return t=BoldBIDashboard.isNullOrUndefined(t)?this.getCurrentCulture().Name:t,"currency"===(e=BoldBIDashboard.isNullOrUndefined(e)?this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue():e).toLowerCase()?BoldBIDashboard.globalize.findCulture(t).numberFormat.currency[","]:"number"===e.toLowerCase()?BoldBIDashboard.globalize.findCulture(t).numberFormat[","]:void 0},InternalFormatDialog.prototype.enableallitems=function(){var e=this.cultureTag.data("BoldBIDashboardDropDownList"),t=this.representationTag.data("BoldBIDashboardDropDownList"),i=this.formatTag.data("BoldBIDashboardDropDownList");"percentage"!==this.formatTag.data("BoldBIDashboardDropDownList").getSelectedValue().toLowerCase()&&(t.enable(),e.enable()),i.enable()},InternalFormatDialog.prototype.closeDialog=function(){this.dialogTag.data("BoldBIDashboardDialog").close()},InternalFormatDialog.prototype.resetPreviewLable=function(){this.previewTag.text("")},InternalFormatDialog.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_format_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.dashboardDesigner.element.on("click","#"+this.id+"_format_btn_ok",this.bbdesigner$.proxy(this.saveFormat,this,!0))},InternalFormatDialog.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_format_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.dashboardDesigner.element.off("click","#"+this.id+"_format_btn_ok",this.bbdesigner$.proxy(this.saveFormat,this,!0))},InternalFormatDialog.prototype.destroy=function(){this.unWireEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.bbdesigner$("#"+this.id+"_format_dialog")),0<this.bbdesigner$("#"+this.id+"_format_dialog").length&&this.bbdesigner$("#"+this.id+"_format_dialog").remove()},InternalFormatDialog.prototype.getFormatList=function(){return[{text:"Number",value:"Number"},{text:"Currency",value:"Currency"},{text:"Percentage",value:"Percentage"}]},InternalFormatDialog.prototype.getFormatListForPivot=function(){return[{text:"Percentage",value:"Percentage"}]},InternalFormatDialog.prototype.getRepresentation=function(){return[{text:"Auto",value:"Auto"},{text:"Ones",value:"Ones"},{text:"Thousands",value:"Thousands"},{text:"Millions",value:"Millions"},{text:"Billions",value:"Billions"}]},InternalFormatDialog.prototype.createFormatType=function(){return new MeasureFormatting},InternalFormatDialog.prototype.getAllRepresentation=function(){return[{text:this.locale.measureFormatting.autoText,value:"Auto"},{text:this.locale.measureFormatting.onesText,value:"Ones"},{text:this.locale.measureFormatting.thousandsText,value:"Thousands"},{text:this.locale.measureFormatting.lakhsText,value:"Lakhs"},{text:this.locale.measureFormatting.millionsText,value:"Millions"},{text:this.locale.measureFormatting.croresText,value:"Crores"},{text:this.locale.measureFormatting.billionsText,value:"Billions"}]},InternalFormatDialog}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.FormatDialog",InternalFormatDialog,window),InternalItemPanel=function(){function e(e,t){this.dashboardDesigner=null,this.refreshTimer=null,this.pageNumber=1,this.filterSearchTimer=null,this.searchText="",this.searchInitiated=!1,this.locale=null,this.dashboardPublishedVersion="",this.pageRequestInProgress=!1,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.targetTag=t,this.widgetPanelSettings=e.model.designerSettings.widgetsPanel,this.rendererItemPanel()}return e.prototype.isLoaded=function(){return!BoldBIDashboard.isNullOrUndefined(this.targetTag)},e.prototype.getItempanelTabTemplate=function(e,t){e='<li class="bbi-itempanel-tab-li"><a  href=#'+e+">"+this.defaultPanelText+"</a>",t='<li class="bbi-itempanel-tab-li"><a  href=#'+t+">"+this.existingPanelText+"</a>";return(this.widgetPanelSettings.hideDefaultWidgets?"":e)+(this.widgetPanelSettings.hideExistingWidgets?"":t)},e.prototype.rendererItemPanel=function(){var n,r,d=this,e=this.dashboardDesigner._id,t=(this.waterMarkText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.defaultPanelSearchPlaceholder)?this.locale.itemPanel.waterMarkText:this.widgetPanelSettings.defaultPanelSearchPlaceholder,this.waterMarkTextForDashboardsearch=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.existingPanelSearchPlaceholder)?this.locale.itemPanel.waterMarkTextForDashboardsearch:this.widgetPanelSettings.existingPanelSearchPlaceholder,this.defaultPanelText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.defaultPanelDisplayText)?this.locale.itemPanel.defaultPanelText:this.widgetPanelSettings.defaultPanelDisplayText,this.existingPanelText=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.widgetPanelSettings.existingPanelDisplayText)?this.locale.itemPanel.existingPanelText:this.widgetPanelSettings.existingPanelDisplayText,this.noMatchedText=this.locale.itemPanel.noDataFound,n=[],!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.model.widgetGuids)&&0<this.dashboardDesigner.model.widgetGuids.length&&this.hideWidgets(),(r=this.bbdesigner$).each(this.locale.itemPanel.groupItems,function(e,i){var a,o,t=[],s=[];r.each(BoldBIDashboardDesigner.widgetItems,function(e,t){i===t.GroupName&&!BoldBIDashboard.isNullOrUndefined(t.Items)&&0<t.Items.length&&(s=0<s.length?s.concat(t.Items):t.Items,a=t.GroupId,o=t.order)}),r.isEmptyObject(s)||(t=s),t=d.orderWidgetGroupItems(t),!BoldBIDashboard.isNullOrUndefined(t)&&0<t.length&&n.push({GroupName:i,GroupId:a,order:o,Items:t})}),this.widgetItems=this.orderWidgetGroupItems(n),this.panelItems=this.cleanWidgetGroups(),e+"_default_itempanel"),i=e+"_existing_itempanel",a=BoldBIDashboard.buildTag("div","",{},{id:e+"_designerItemPanel_Tab"}),o=BoldBIDashboard.buildTag("ul",this.getItempanelTabTemplate(t,i),{},{class:"bbi-itempanel-tab-ul"}),i=(this.defaultPanel=BoldBIDashboard.buildTag("div","",{},{id:t,class:"bbi-default-panel"}),this.existingPanel=BoldBIDashboard.buildTag("div","",{},{id:i,class:"bbi-existing-panel"}),a.append(o,this.defaultPanel,this.existingPanel),t=BoldBIDashboard.buildTag("span.bbi-dashboardicon bbi-designer-itempanel-icon bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable bbi-widgetpanel-expandcollapse bbi-widgetpanel-collapse","",{},{id:this.dashboardDesigner._id+"_item_panel_expand_collapse","data-toggle":"expand","data-tooltip":this.locale.dataConfigurationPanel.collapse}),this.hideItemPanelIcon(t),this.targetTag.append(t,a),this.widgetPanelSettings.hideDefaultWidgets||this.renderHeaderPanel(),this.expandablePanel=BoldBIDashboard.buildTag("div","",{},{id:e+"_designerItemPanel",class:"bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3"}),BoldBIDashboard.buildTag("div.bbi-dbrd-designer-exisiting-panel","",{},{})),o=BoldBIDashboard.buildTag("div","",{},{id:e+"_scrollContentItemPanel"}),t=BoldBIDashboard.buildTag("div","",{},{id:e+"_itemPanel_empty_msg",class:"bbi-dbrd-designer-panel-empty-wrapper"}),e=BoldBIDashboard.buildTag("div",this.locale.itemPanel.noDataFound,{},{class:"bbi-dbrd-designer-font bbi-dbrd-designer-empty-msg"});t.append(e),i.append(o).append(t),this.expandablePanel.append(i),this.defaultPanel.append(this.expandablePanel),this.expandablePanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),a.BoldBIDashboardTab({itemActive:this.bbdesigner$.proxy(this.sendRequestForDashboardsDetail,this),selectedItemIndex:0}),this.widgetPanelSettings.hideDefaultWidgets&&!this.widgetPanelSettings.hideExistingWidgets&&(this.defaultPanel.hide(),this.sendRequestForDashboardsDetail({activeIndex:1})),this.widgetPanelSettings.hideDefaultWidgets&&this.widgetPanelSettings.hideExistingWidgets&&this.onExpandCollapsePanel(null,!0),this.updateSize(),this.unWireEvents(),this.wireEvents()},e.prototype.hideItemPanelIcon=function(e){!BoldBIDashboard.isNullOrUndefined(this.widgetPanelSettings)&&!BoldBIDashboard.isNullOrUndefined(this.widgetPanelSettings.hideWidgetsToolbox)&&this.widgetPanelSettings.hideWidgetsToolbox?e.addClass("hide-Itempanel-icon"):e.removeClass("hide-Itempanel-icon")},e.prototype.hideWidgets=function(){for(var e,t=this.dashboardDesigner.model.widgetGuids,i=0;i<BoldBIDashboardDesigner.widgetItems.length;i++)for(e=0;e<BoldBIDashboardDesigner.widgetItems[i].Items.length;e++)t.includes(BoldBIDashboardDesigner.widgetItems[i].Items[e].id)||(BoldBIDashboardDesigner.widgetItems[i].Items[e].hide=!0)},e.prototype.sendRequestForDashboardsDetail=function(e){1===e.activeIndex&&(BoldBIDashboard.isNullOrUndefined(this.expandableExistingPanel)?(BoldBIDashboard.isNullOrUndefined(this.dashboardWholeWrapper)||this.dashboardWholeWrapper.remove(),this.dashboardWholeWrapper=BoldBIDashboard.buildTag("div.e-dbrd-existing-panel-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_panel_wrapper"}),this.renderHeaderPanelForDashboard(),this.sharedDashboardLoader=BoldBIDashboard.buildTag("div","",{"min-height":"160px",position:"absolute",width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_existingpanel_list_view_loader"}),e=BoldBIDashboard.buildTag("div.bbi-dbrd-desginer-error bbi-dbrd-designer-font","<center><p></p></center>",{},{id:this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"}),this.sharedDashboardLoader.append(this.renderSkelton("_shared_dbrd_skeleton")),this.dashboardWholeWrapper.append(this.sharedDashboardLoader,e),this.existingPanel.append(this.dashboardWholeWrapper),this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.shareddashboard,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedDashboard,data:JSON.stringify({pageInfo:{pageSize:20,pageNo:1},sortInfo:{sortOrder:"Asc",sortBy:"Name"}})},{fnction:this.bbdesigner$.proxy(this.onAccountFetchSuccess,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForDashboards,this)},!0,!0)):this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},e.prototype.sendRequestForWidgetsDetail=function(e){var t,i,a,o,s;e.currentTarget&&(e.currentTarget.firstChild.offsetWidth<e.currentTarget.firstChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.dashboardsTooltip)||this.dashboardsTooltip.destroy()),i=this.bbdesigner$(e.currentTarget).attr("data-id"),a=this.bbdesigner$(e.currentTarget).attr("data-version"),e=e.currentTarget.children[0].innerText,this.existingPanel.find("#"+this.dashboardDesigner._id+"_existing_panel_wrapper").css("display","none"),this.existingWidgetWrapper=BoldBIDashboard.buildTag("div.e-existing-widget-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_widget_wrapper"}),o=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-wrapper","",{},{id:this.dashboardDesigner._id+"_specific_dashboard"}),e=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-name","<label>"+e+"</label>",{},{id:this.dashboardDesigner._id+"_specific_dashboard_name"}),s=BoldBIDashboard.buildTag("div.bbi-specific-dashboard-icon",'<span class="bbi-icon-arrow_1_left bbi-designer-header-icon" > </span>',{},{}),this.widgetsLoader=BoldBIDashboard.buildTag("div","",{"min-height":"80px",position:"absolute",width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_existingpanel_list_view_loader"}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-desginer-error bbi-dbrd-designer-font","<center><p></p></center>",{},{id:this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"}),this.widgetsLoader.append(this.renderSkeletonForWidgets("_shared_dbrd_widgets_skeleton")),o.append(s).append(e),this.existingWidgetWrapper.append(o,this.widgetsLoader,t),this.existingPanel.append(this.existingWidgetWrapper),this.dashboardDesigner.modules.util.doAjaxPost("GET",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.sharedwidgets+"/"+i,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedWidget},{fnction:this.bbdesigner$.proxy(this.onDashboardClick,this,i,a),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForWidgets,this)},!0,!0))},e.prototype.fetchPredefindedWidgets=function(){var e;BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.dashboardDesigner.model.predefinedWidgets.dashboardId)||(e=this.dashboardDesigner.model.predefinedWidgets.dashboardId,this.dashboardDesigner.modules.util.doAjaxPost("GET",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.sharedwidgets+"/"+e,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedWidget},{fnction:this.bbdesigner$.proxy(this.injectPredefinedWidgetDetailsInWidgetItems,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForWidgets,this)},!0,!0))},e.prototype.appendPredefinedWidgets=function(t){var a=this;this.bbdesigner$.each(this.widgetItems,function(e,i){a.bbdesigner$.each(t,function(e,t){i.GroupName===t.GroupName&&!BoldBIDashboard.isNullOrUndefined(t.Items)&&0<t.Items.length&&(i.Items=i.Items.concat(t.Items))})})},e.prototype.getWidgetCategoryId=function(i){var a="";return this.bbdesigner$.each(this.widgetItems,function(e,t){t.GroupName===i&&(a=t.GroupId)}),a},e.prototype.checkWidgetCategoryExists=function(e){var t,i=new ExistingWidgetCategory,a=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(e);for(i.isCategoryExists=a,i.categoryName=a?this.locale.itemPanel.groupItems.miscellaneous:e,i.categoryGroupId=a?this.getWidgetCategoryId(i.categoryName):BoldBIDashboard.getGuid("").toString(),t=0;t<this.widgetItems.length;t++)if(this.widgetItems[t].GroupName.toLowerCase()===e.toLowerCase()){i.isCategoryExists=!0,i.categoryGroupId=this.widgetItems[t].GroupId,i.categoryName=this.widgetItems[t].GroupName;break}return i.isCategoryExists||this.widgetItems.push({GroupName:i.categoryName,GroupId:i.categoryGroupId,Items:[]}),i},e.prototype.injectPredefinedWidgetDetailsInWidgetItems=function(i){try{var e=BoldBIDashboard.isNullOrUndefined(i.Data)?null:this.getCurrentWidgetItems(i.Data),a=[],o=this.checkWidgetCategoryExists(this.dashboardDesigner.model.predefinedWidgets.categoryName);this.bbdesigner$.each(e,function(e,t){a.push({GroupName:o.categoryName,GroupId:o.categoryGroupId,Items:[{id:i.Data[e].WidgetId,widgetName:t.widgetName,widgetDisplayName:i.Data[e].WidgetName,cssClass:t.cssClass+" e-predefinedwidgets",widgetNameSpace:t.widgetNameSpace,searchCategory:t.searchCategory,widgetconfiginfo:null,useIconTemplate:!0,iconTemplate:t.iconTemplate,tooltip:{title:t.tooltip.title,description:t.tooltip.description,dataRequirement:t.tooltip.dataRequirement},serializationNameSpace:t.serializationNameSpace,isPreconfiguredWidget:!0}]})}),this.appendPredefinedWidgets(a),this.dashboardPublishedVersion=i.Version,this.updateWidgetItemVisibility(null),this.renderGroup()}catch(e){!i.ApiStatus&&i.Message&&this.dashboardDesigner.designerPanel.logError({Source:"injectPredefinedWidgetDetailsInWidgetItems",Error:e,Type:e.name})}},e.prototype.onConnectionErrorForWidgets=function(){this.widgetsLoader.css("display","none"),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block");var e=this.locale.errorMessage.connectionRefused;this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e)},e.prototype.onConnectionErrorForDashboards=function(){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block");var e=this.locale.errorMessage.connectionRefused;this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e),this.refreshContainer.prop("disabled","true")},e.prototype.onAccountFetchSuccess=function(e){var t;this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),e.Status?BoldBIDashboard.isNullOrUndefined(e.Data)||0===e.Data.length?(t=this.locale.errorMessage.noDashboard,this.hideSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(t)):(t=e.Data,t=0<this.widgetPanelSettings.existingDashboards.length?this.getMatchingdDashboardsList(t):t,this.renderExistingDashboardPanel(e,t),this.scrollExisitingDiv.append(this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel"))):(this.hideSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e.Message))},e.prototype.getMatchingdDashboardsList=function(e){var t=this.widgetPanelSettings.existingDashboards;return e.filter(function(e){return-1!==t.indexOf(e.Id)})},e.prototype.renderExistingDashboardPanel=function(e,t){var i=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control","",{width:"100%",display:"block"},{id:this.dashboardDesigner._id+"_expandable_parent_div"});this.expandableExistingPanel=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3 bbi-expandable-existing-panel","",{clear:"both"},{id:this.dashboardDesigner._id+"_existingpanel_list_view"}),this.scrollExisitingDiv=BoldBIDashboard.buildTag("div.bbi-dbrd-scroll-exisitng-div","",{},{id:this.dashboardDesigner._id+"_scroll_parent_container"}),this.scrollExistingContent=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_content_existingpanel"}),this.scrollExisitingDiv.append(this.createDashboardListContainer(t,this.scrollExistingContent)),this.expandableExistingPanel.append(this.scrollExisitingDiv),i.append(this.expandableExistingPanel),this.dashboardWholeWrapper.append(i),this.expandableExistingPanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,scroll:this.bbdesigner$.proxy(this.setScroller,this)}).data("BoldBIDashboardScroller"),this.loaderIndicator=this.expandableExistingPanel.BoldBIDashboardWaitingPopup({showOnInit:!1,showImage:!0,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup"),this.sizeUpdateForExistingPanel(),this.pageNumber=e.Page,this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.refreshContainer.removeProp("disabled")},e.prototype.renderHeaderPanelForDashboard=function(){var e=BoldBIDashboard.buildTag("div.bbi-dbrd-existing-panel-header-wrapper","",{},{id:this.dashboardDesigner._id+"_existing_panel_header"}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-existing-autocomplete bbi-dbrd-designer-autocomplete bbi-dbrd-designer-font","",{},{id:this.dashboardDesigner._id+"_item_autocomplete_for_existing_panel"}),i=BoldBIDashboard.buildTag("input.bbi-autocomplete bbi-dbrd-designer-font bbi-dbrd-designer-search-box bbi-dbrd-designer-watermark bbi-dbrd-designer-boxshadow e-js e-input","",{},{type:"text",placeholder:this.waterMarkTextForDashboardsearch,id:this.dashboardDesigner._id+"_panel_search_for_existing_panel"}),a=BoldBIDashboard.buildTag("span.bbi-dbrd-designer-icon bbi-dbrd-designer-search","",{},{id:this.dashboardDesigner._id+"_searchIcon_for_existing_panel"});this.refreshContainer=BoldBIDashboard.buildTag("button.bbi-dbrd-existing-dashboard-refresh-icon bbi-dbrd-designer-hoverable bbi-dbrd-designer-hand-cursor bbi-dbrd-icon-background-theme","",{},{id:this.dashboardDesigner._id+"_dashboard_refresh_icon",type:"button","data-tooltip":this.locale.itemPanel.refreshTooltip}),t.append(i),t.append(a),e.append(t,this.refreshContainer),this.dashboardWholeWrapper.append(e)},e.prototype.onDashboardClick=function(e,t,i){var a,o;BoldBIDashboard.isNullOrUndefined(i.Data)?(this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(i.Message)):(this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),this.expandableWidgetPanel=BoldBIDashboard.buildTag("div.bbi-expandable-existing-widget-panel","",{},{id:this.dashboardDesigner._id+"_existing_widgets_panel",class:"bbi-dbrd-designer-scroller  bbi-dbrd-control bbi-dbrd-designer-panel-content-wrapper bbi-dbrd-designer-scroll-style-3 "}),a=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_widgets_parent_div"}),o=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_scroll_content_existing_widgets_panel"}),t=BoldBIDashboard.buildTag("div.e-widget-collection-wrapper","",{},{id:this.dashboardDesigner._id+"_widget_whole_collection_wrapper","data-dbrdId":e,"data-version":t}),o.append(t),a.append(o),this.expandableWidgetPanel.append(a),this.existingWidgetWrapper.append(this.expandableWidgetPanel),this.expandableWidgetPanel.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.renderWidgetItem(t,e,i),this.existingWidgetWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.sizeUpdateForWidgetPanel())},e.prototype.renderWidgetItem=function(e,t,i){for(var a,o,s=this.getCurrentWidgetItems(i.Data),n=0;n<i.Data.length;n++){a=s[n],o=BoldBIDashboard.buildTag("div.e-draggable e-widget-wrapper","",{},{CategoryId:t,id:this.dashboardDesigner._id+"_"+i.Data[n].WidgetId,Type:i.Data[n].Type,SubType:i.Data[n].SubType,"data-widgetId":i.Data[n].WidgetId,unselectable:"on","data-widgetclass":a.cssClass,"data-widgetname":a.widgetName,"data-widgetnamespace":a.widgetNameSpace,"data-icontemplate":a.iconTemplate,"data-serializationnamespace":a.serializationNameSpace,"data-min-rowspan":a.minRowSpan,"data-min-colspan":a.minColSpan}),this.dashboardDesigner.dragDropHelper.initializeDraggable(o,"10000"),e.append(o);var r=BoldBIDashboard.buildTag("div",'<span class="bbi-designer-fieldcontainer-double-drag bbi-widgeticons bbi-drag-handle-span"> </span>',{},{class:"bbi-drag-handle-icon","data-widgetclass":a.cssClass,"data-widgetname":a.widgetName,"data-widgetnamespace":a.widgetNameSpace,"data-icontemplate":a.iconTemplate,"data-widgetid":i.Data[n].WidgetId,"data-min-rowspan":a.minRowSpan,"data-min-colspan":a.minColSpan}),d=BoldBIDashboard.buildTag("div.bbi-widget-name-wrapper","",{},{}),l=BoldBIDashboard.buildTag("div.bbi-widget-name-div","<label>"+i.Data[n].WidgetName+"</label>",{},{}),h=BoldBIDashboard.buildTag("div","",{},{class:"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-icon bbi-dashboard-widget-icon "+a.cssClass,"data-widgetclass":a.cssClass,"data-widgetname":a.widgetName,"data-widgetnamespace":a.widgetNameSpace,"data-icontemplate":a.iconTemplate,"data-widgetid":i.Data[n].WidgetId,"data-serializationnamespace":a.serializationNameSpace,"data-min-rowspan":a.minRowSpan,"data-min-colspan":a.minColSpan});a.useIconTemplate&&h.append(a.iconTemplate),d.append(h).append(l),o.append(r).append(d)}},e.prototype.activeEllipsis=function(e){e.currentTarget.firstChild.offsetWidth<e.currentTarget.firstChild.scrollWidth&&(this.dashboardsTooltip=this.existingPanel.find("#"+this.dashboardDesigner._id+"_scroll_parent_container").BoldBIDashboardTooltip({content:e.currentTarget.firstChild.innerText,associate:"mouseenter",animation:{effect:"none",speed:8e3},cssClass:"bbi-dbrd-designer-tooltip-for-itempanel",collision:"fit",position:{stem:{horizontal:"left",vertical:"center"},target:{horizontal:100,vertical:100}},target:".bbi-dashboard-name-wrapper"}).data("BoldBIDashboardTooltip"))},e.prototype.inactiveEllipsis=function(e){e.currentTarget.firstChild.offsetWidth<e.currentTarget.firstChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.dashboardsTooltip)||this.dashboardsTooltip.destroy())},e.prototype.activeEllipsisForWidgets=function(e){e.currentTarget.lastChild.lastChild.offsetWidth<e.currentTarget.lastChild.lastChild.scrollWidth&&(this.widgetsTooltip=this.existingPanel.find("#"+this.dashboardDesigner._id+"_scroll_content_existing_widgets_panel").BoldBIDashboardTooltip({content:e.currentTarget.innerText,associate:"mouseenter",animation:{effect:"none",speed:8e3},cssClass:"bbi-dbrd-designer-tooltip-for-itempanel",collision:"fit",position:{stem:{horizontal:"left",vertical:"center"},target:{horizontal:100,vertical:100}},target:".e-widget-wrapper"}).data("BoldBIDashboardTooltip"))},e.prototype.inactiveEllipsisForWidgets=function(e){e.currentTarget.lastChild.lastChild.offsetWidth<e.currentTarget.lastChild.lastChild.scrollWidth&&(BoldBIDashboard.isNullOrUndefined(this.widgetsTooltip)||this.widgetsTooltip.destroy())},e.prototype.backToDashBoard=function(){this.existingWidgetWrapper.remove(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_existing_panel_wrapper").css("display","block")},e.prototype.sizeUpdateForExistingPanel=function(){var e,t,i;this.isLoaded()&&!BoldBIDashboard.isNullOrUndefined(this.expandableExistingPanel)&&(i=this.widgetPanelSettings.hideDefaultWidgets?this.existingPanel:this.defaultPanel,t=this.widgetPanelSettings.hideDefaultWidgets?"_item_autocomplete_for_existing_panel":"_item_autocomplete",e=i.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),t=i.find("#"+this.dashboardDesigner._id+t),i=i.closest("#"+this.dashboardDesigner._id+"_designerContainer").find(".bbi-itempanel-tab-li"),t=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10),i=i.height()+parseInt(i.css("margin-top"),10)+parseInt(i.css("margin-bottom"),10)+parseInt(i.css("border-top-width"),10)+parseInt(i.css("border-bottom-width"),10),this.expandableExistingPanel.height(e-t-i+"px"),this.expandableExistingPanel.data("BoldBIDashboardScroller"))&&(this.expandableExistingPanel.data("BoldBIDashboardScroller").setModel({height:e-t-i-1+"px"}),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},e.prototype.sizeUpdateForWidgetPanel=function(){var e,t,i;this.isLoaded()&&!BoldBIDashboard.isNullOrUndefined(this.expandableWidgetPanel)&&(e=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),t=this.existingPanel.find("#"+this.dashboardDesigner._id+"_specific_dashboard"),i=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find(".bbi-itempanel-tab-li"),t=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10),i=i.height()+parseInt(i.css("margin-top"),10)+parseInt(i.css("margin-bottom"),10)+parseInt(i.css("border-top-width"),10)+parseInt(i.css("border-bottom-width"),10),this.expandableWidgetPanel.height(e-t-i+"px"),this.expandableWidgetPanel.data("BoldBIDashboardScroller"))&&(this.expandableWidgetPanel.data("BoldBIDashboardScroller").setModel({height:e-t-i-1+"px"}),this.expandableWidgetPanel.data("BoldBIDashboardScroller").refresh())},e.prototype.appendCustomWidget=function(e){var s=this,n=[],r=this.locale.itemPanel.groupItems;this.bbdesigner$.each(e,function(e,i){var t,a,o=!1;if(s.bbdesigner$.each(s.widgetItems,function(e,t){t.GroupName===i.GroupName&&!BoldBIDashboard.isNullOrUndefined(i.Items)&&0<i.Items.length&&(t.Items=t.Items.concat(i.Items),o=!0)}),!o&&!n.includes(i)&&!r.hasOwnProperty(i.GroupName.toLowerCase())){for(t=!1,a=0;a<n.length;a++)n[a].GroupName===i.GroupName&&(t=!0,n[a].Items.includes(i.Items[0])||n[a].Items.push(i.Items[0]));t||n.push(i)}}),0<n.length&&(this.widgetItems=this.widgetItems.concat(n)),this.updateWidgetItemVisibility(null)},e.prototype.orderWidgetGroupItems=function(e){var t=[],i=[],a=[],t=e.filter(function(e){return!BoldBIDashboard.isNullOrUndefined(e.order)}),e=e.filter(function(e){return BoldBIDashboard.isNullOrUndefined(e.order)}),t=t.sort(function(e,t){return e.order>t.order?1:-1});return!BoldBIDashboard.isNullOrUndefined(t)&&0<t.length&&i.push(t),0<(a=!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length?1===i.length?i[0].concat(e):i.push(e):a).length?a:i[0]},e.prototype.updateSize=function(){var e,t,i;this.isLoaded()&&(e=this.defaultPanel.closest("#"+this.dashboardDesigner._id+"_designerContainer").find("#"+this.dashboardDesigner._id+"_designAreaContainer").height(),t=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_item_autocomplete"),i=this.dashboardDesigner.element.find(".bbi-itempanel-tab-li"),t=t.height()+parseInt(t.css("margin-top"),10)+parseInt(t.css("margin-bottom"),10)+parseInt(t.css("border-top-width"),10)+parseInt(t.css("border-bottom-width"),10),i=i.height()+parseInt(i.css("margin-top"),10)+parseInt(i.css("margin-bottom"),10)+parseInt(i.css("border-top-width"),10)+parseInt(i.css("border-bottom-width"),10),this.expandablePanel.height(e-t-i+"px"),this.expandablePanel.data("BoldBIDashboardScroller"))&&(this.expandablePanel.data("BoldBIDashboardScroller").setModel({height:e-t-i-1+"px"}),this.expandablePanel.data("BoldBIDashboardScroller").refresh(),this.sizeUpdateForExistingPanel(),this.sizeUpdateForWidgetPanel())},e.prototype.validateSearchString=function(e,t){for(var i=!1,a=0;a<e.length;a++)if(BoldBIDashboard.DashboardUtil.contains(e[a],t,!0)){i=!0;break}return i},e.prototype.getPanelItems=function(e,t){var i,a,o,s=[];if(e)for(i in e){for(a=void 0,a={GroupId:e[i].GroupName,GroupName:e[i].GroupName,Items:[]},o=0;o<e[i].Items.length;o++)(BoldBIDashboard.DashboardUtil.contains(e[i].Items[o].widgetDisplayName,t,!0)||BoldBIDashboard.DashboardUtil.contains(e[i].Items[o].widgetName,t,!0)||this.validateSearchString(e[i].Items[o].searchCategory,t))&&a.Items.push({id:e[i].Items[o].id,widgetName:e[i].Items[o].widgetName,widgetDisplayName:e[i].Items[o].widgetDisplayName,cssClass:e[i].Items[o].cssClass,widgetNameSpace:e[i].Items[o].widgetNameSpace,widgetconfiginfo:e[i].Items[o].widgetconfiginfo,useIconTemplate:e[i].Items[o].useIconTemplate,iconTemplate:e[i].Items[o].iconTemplate,tooltip:e[i].Items[o].tooltip,serializationNameSpace:e[i].Items[o].serializationNameSpace,minRowSpan:isNaN(e[i].Items[o].minRowSpan)?6:e[i].Items[o].minRowSpan,minColSpan:isNaN(e[i].Items[o].minColSpan)?6:e[i].Items[o].minColSpan});0<a.Items.length&&s.push(a)}return s},e.prototype.renderHeaderPanel=function(){this.headerPanel=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_itemHeaderPanel",class:"bbi-dbrd-designer-panel-header-wrapper"});var e=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_item_autocomplete",class:"bbi-dbrd-designer-autocomplete bbi-dbrd-designer-font"}),t=BoldBIDashboard.buildTag("input","",{},{type:"text",placeholder:this.waterMarkText,id:this.dashboardDesigner._id+"_panelSearch",class:"bbi-autocomplete bbi-dbrd-designer-font bbi-dbrd-designer-search-box bbi-dbrd-designer-watermark bbi-dbrd-designer-boxshadow e-js e-input"}),i=BoldBIDashboard.buildTag("span","",{},{id:this.dashboardDesigner._id+"_searchIcon",class:"bbi-dbrd-designer-icon bbi-dbrd-designer-search"});e.append(t),e.append(i),this.headerPanel.append(e),this.defaultPanel.append(this.headerPanel)},e.prototype.slideDownOperation=function(e){this.bbdesigner$(e.currentTarget).removeClass("plus").addClass("minus")},e.prototype.slideUpOperation=function(e){this.bbdesigner$(e.currentTarget).addClass("plus").removeClass("minus")},e.prototype.onExpandCollapseClick=function(e){var t,i=this.bbdesigner$(e.currentTarget),a=i.attr("data-groupid"),a=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_widgetgroup_"+a);i.hasClass("plus")?a.slideDown("fast",this.bbdesigner$.proxy(this.slideDownOperation,this,e)):a.slideUp("fast",this.bbdesigner$.proxy(this.slideUpOperation,this,e)),this.clearTimer(),(t=this).refreshTimer=setTimeout(this.bbdesigner$.proxy(function(){t.expandablePanel.data("BoldBIDashboardScroller")&&(t.expandablePanel.data("BoldBIDashboardScroller").refresh(!0),t.clearTimer())},this),300)},e.prototype.clearTimer=function(){this.refreshTimer&&(clearTimeout(this.refreshTimer),this.refreshTimer=null)},e.prototype.getDragElement=function(e){var t,i=BoldBIDashboard.buildTag("div","",{width:"74.5px",height:"75px",cursor:"default",float:"left","vertical-align":"middle","text-align":"center",border:"1px solid var(--primary-border-color)","background-color":"var(--secondary-background-color)"},{unselectable:"on","data-widgetnamespace":e.attr("data-widgetnamespace"),"data-widgetname":e.attr("data-widgetname"),"data-widgetid":e.attr("data-widgetid"),"data-min-rowspan":e.attr("data-min-rowspan"),"data-min-colspan":e.attr("data-min-colspan")}),a=BoldBIDashboard.buildTag("div","",{"margin-top":"14px",cursor:"default"},{class:e.attr("data-widgetclass"),"data-widgetnamespace":e.attr("data-widgetnamespace"),"data-widgetname":e.attr("data-widgetname"),"data-widgetid":e.attr("data-widgetid"),"data-min-rowspan":e.attr("data-min-rowspan"),"data-min-colspan":e.attr("data-min-colspan")});return a.addClass("bbi-widgeticon-drag"),t=e.attr("data-icontemplate"),BoldBIDashboard.isNullOrUndefined(t)||""===t||a.append(e.attr("data-icontemplate")),i.append(a),i},e.prototype.renderGroupItems=function(e,t){var i,a,o,s,n,r=[],d=[];for(i in e){var l=e[i].GroupName.replace(" ",""),h=e[i].GroupId,p=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_widgetgroup_"+h,class:"bbi-dbrd-designer-widget-group-content"}),c=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_widgetgroupHeader_"+h,class:"bbi-dbrd-designer-widget-group-header-wrapper minus","data-groupid":h});for(i===(e.length-1).toString()&&c.addClass("bbi-last-element"),(l=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{},{id:this.dashboardDesigner._id+"_widgetgroupHeaderText_"+l,class:"bbi-dbrd-designer-font bbi-dbrd-designer-widget-group-header-text"})).text(e[i].GroupName),c.append(l),l=BoldBIDashboard.buildTag("div","",{},{class:"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-group-header-icon",id:this.dashboardDesigner._id+"_widgetgroupHeaderIcon_"+h}),c.append(l),a=BoldBIDashboard.buildTag("div","",{},{unselectable:"on",id:this.dashboardDesigner._id+"_widgetgroupelement_"+h,class:"bbi-dbrd-designer-widget-group-content-wrapper"}),o=void 0,s=0;s<e[i].Items.length;s++){b=(g=e[i].Items[s]).id,s%2==0&&(o=BoldBIDashboard.buildTag("div","",{},{unselectable:"on",id:this.dashboardDesigner._id+"_"+e[i].GroupId+"_widgetcontainer_row",class:"bbi-dbrd-designer-widget-group-row"})),n=BoldBIDashboard.buildTag("div","",{},{class:"e-draggable bbi-dbrd-designer-widget-group-column",unselectable:"on","data-widgetclass":g.cssClass,"data-widgetname":g.widgetName,"data-widgetnamespace":g.widgetNameSpace,"data-icontemplate":g.iconTemplate,"data-widgetid":b,"data-serializationnamespace":g.serializationNameSpace,"data-min-rowspan":g.minRowSpan,"data-min-colspan":g.minColSpan,id:this.dashboardDesigner._id+"_"+b,"data-dbrdid":this.dashboardDesigner.model.predefinedWidgets.dashboardId,"data-dbrdversion":this.dashboardPublishedVersion}),o.append(n),this.dashboardDesigner.dragDropHelper.initializeDraggable(n,"10000"),s%2==0&&a.append(o),u=BoldBIDashboard.buildTag("div","",{},{class:"bbi-dbrd-designer-icon bbi-dbrd-designer-widget-icon "+g.cssClass,"data-widgetclass":g.cssClass,"data-widgetname":g.widgetName,"data-widgetnamespace":g.widgetNameSpace,"data-icontemplate":g.iconTemplate,"data-widgetid":b,"data-serializationnamespace":g.serializationNameSpace,"data-min-rowspan":g.minRowSpan,"data-min-colspan":g.minColSpan}),g.useIconTemplate&&u.append(g.iconTemplate),n.append(u),r.push(u),u=BoldBIDashboard.buildTag("span","",{},{id:this.dashboardDesigner._id+b+"_text",unselectable:"on",class:"bbi-dbrd-designer-font bbi-dbrd-designer-widget-name"}),b=g.widgetDisplayName,u.text(b),n.append(u),g.showBadge&&""!==g.badgeText&&!BoldBIDashboard.isNullOrUndefined(g.badgeText)&&(b=BoldBIDashboard.buildTag("span",g.badgeText,{},{class:"bbi-dbrd-badge"}),n.append(b));var u=g.tooltip.title,b=g.tooltip.description,g=g.tooltip.dataRequirement,u=this.generateTooltipTemplate(u,b,g);n.BoldBIDashboardTooltip({content:u,cssClass:"bbi-defaultIndex-template",position:{stem:{horizontal:"left",vertical:"top"},target:{horizontal:"right",vertical:0}},tip:{adjust:{xValue:s%2==0?85:10}},isBalloon:!1,showShadow:!0,beforeOpen:function(e){e.cancel=0!==e.event.buttons}})}l=BoldBIDashboard.buildTag("div","",{},{}),p.append(a),l.append(c,p),d.push(l)}return t.append(d),this.bbdesigner$(this.expandablePanel).data("BoldBIDashboardScroller")&&this.bbdesigner$(this.expandablePanel).data("BoldBIDashboardScroller").refresh(),r},e.prototype.getSearchItems=function(){return this.searchItems},e.prototype.getSearchItemsLength=function(){for(var e=0,t=0;t<this.searchItems.length;t++)e+=this.searchItems[t].Items.length;return e},e.prototype.onSearchClick=function(e){var t;13!==e.keyCode&&(e=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_panelSearch"),t=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel"),e=e.val(),!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&""!=e.trim()?(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-close").removeClass("bbi-dbrd-designer-search"),this.searchItems=this.getPanelItems(this.panelItems,e),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel")),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.renderGroupItems(this.searchItems,t,!0,!0),this.showToolboxItems(0<this.searchItems.length)):(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel")),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.searchItems=[],this.renderGroupItems(this.panelItems,t,!0,!1),this.showToolboxItems(!0)))},e.prototype.onCloseClick=function(){this.defaultPanel.find("#"+this.dashboardDesigner._id+"_panelSearch").val(""),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_searchIcon").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel")),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.showToolboxItems(!0);var e=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel");this.renderGroupItems(this.panelItems,e,!0,!1)},e.prototype.onDataSourceSearchTextFocusIn=function(e){this.bbdesigner$(e.currentTarget.parentElement).addClass("e-focus")},e.prototype.onDataSourceSearchTextFocusOut=function(e){e=this.bbdesigner$(e.currentTarget.parentElement);e.hasClass("e-focus")&&e.removeClass("e-focus")},e.prototype.showToolboxItems=function(e){this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_itemPanel_empty_msg").css("display",e?"none":"table")},e.prototype.onItemScroll=function(e){e.cancel=this.dashboardDesigner.isItemDrag},e.prototype.updateCulture=function(){var e=this.dashboardDesigner._id,t=this.dashboardDesigner.model.localeSettings.culture,t=(BoldBIDashboard.Designer.Locale[t]||BoldBIDashboard.Designer.Locale["en-US"]).itemPanel;this.waterMarkText=t.waterMarkText,this.noMatchedText=t.noDataFound,this.defaultPanel.find("#"+e+"_panelSearch").val(this.defaultPanel.find("#"+e+"_panelSearch").hasClass("e-focus")?"":this.waterMarkText),this.dashboardDesigner.element.find("#"+e+"_noMessageToolTip").find(".editLabel").html(this.noMatchedText)},e.prototype.wireEvents=function(){this.targetTag.on("click",".bbi-widgetpanel-expandcollapse",this.bbdesigner$.proxy(this.onExpandCollapsePanel,this)),this.defaultPanel.on("keyup",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onSearchClick,this)),this.defaultPanel.on("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.onCloseClick,this)),this.defaultPanel.on("click",".bbi-dbrd-designer-widget-group-header-wrapper",this.bbdesigner$.proxy(this.onExpandCollapseClick,this)),this.defaultPanel.on("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this)),this.defaultPanel.on("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this)),this.existingPanel.on("click",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.sendRequestForWidgetsDetail,this)),this.existingPanel.on("click",".bbi-specific-dashboard-wrapper ",this.bbdesigner$.proxy(this.backToDashBoard,this)),this.existingPanel.on("keyup","#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel",this.bbdesigner$.proxy(this.dashboardSearch,this)),this.existingPanel.on("click","#"+this.dashboardDesigner._id+"_dashboard_refresh_icon",this.bbdesigner$.proxy(this.refreshDashboardList,this)),this.existingPanel.on("mouseenter",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.activeEllipsis,this)),this.existingPanel.on("mouseleave",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsis,this)),this.existingPanel.on("mouseenter",".e-widget-wrapper",this.bbdesigner$.proxy(this.activeEllipsisForWidgets,this)),this.existingPanel.on("mouseleave",".e-widget-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsisForWidgets,this)),this.existingPanel.on("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.resetDashboardList,this)),this.existingPanel.on("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this)),this.existingPanel.on("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this))},e.prototype.unWireEvents=function(){this.targetTag.off("click",".bbi-widgetpanel-expandcollapse",this.bbdesigner$.proxy(this.onExpandCollapsePanel,this)),this.defaultPanel.off("keyup",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onSearchClick,this)),this.defaultPanel.off("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.onCloseClick,this)),this.defaultPanel.off("click",".bbi-dbrd-designer-widget-group-header-wrapper",this.bbdesigner$.proxy(this.onExpandCollapseClick,this)),this.defaultPanel.off("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this)),this.defaultPanel.off("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this)),this.existingPanel.off("click",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.sendRequestForWidgetsDetail,this)),this.existingPanel.off("click",".bbi-specific-dashboard-wrapper ",this.bbdesigner$.proxy(this.backToDashBoard,this)),this.existingPanel.off("keyup","#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel",this.bbdesigner$.proxy(this.dashboardSearch,this)),this.existingPanel.off("click","#"+this.dashboardDesigner._id+"_dashboard_refresh_icon",this.bbdesigner$.proxy(this.refreshDashboardList,this)),this.existingPanel.off("mouseenter",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.activeEllipsis,this)),this.existingPanel.off("mouseleave",".bbi-dashboard-name-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsis,this)),this.existingPanel.off("mouseenter",".e-widget-wrapper",this.bbdesigner$.proxy(this.activeEllipsisForWidgets,this)),this.existingPanel.off("mouseleave",".e-widget-wrapper",this.bbdesigner$.proxy(this.inactiveEllipsisForWidgets,this)),this.existingPanel.off("click",".bbi-dbrd-designer-close",this.bbdesigner$.proxy(this.resetDashboardList,this)),this.existingPanel.off("focusin",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusIn,this)),this.existingPanel.off("focusout",".bbi-dbrd-designer-search-box",this.bbdesigner$.proxy(this.onDataSourceSearchTextFocusOut,this))},e.prototype.updateWidgetItemVisibility=function(i){var a,o;this.panelItems=this.cleanWidgetGroups(i),a=this.bbdesigner$,BoldBIDashboard.isNullOrUndefined(i)||BoldBIDashboard.isNullOrUndefined(i.Value)||(o=BoldBIDashboard.Designer.Locale[Object.keys(BoldBIDashboard.Designer.Locale)[0]],a.each(BoldBIDashboardDesigner.widgetItems,function(e,t){t.GroupName===o.itemPanel.groupItems.relation&&a.each(t.Items,function(e,t){"BingMap"!==t.widgetName||BoldBIDashboard.isNullOrUndefined(i.Value[t.widgetName.toLowerCase()])||(t.hide=i.Value[t.widgetName.toLowerCase()].hide)})}),a.each(this.widgetItems,function(e,t){t.GroupName===o.itemPanel.groupItems.relation&&a.each(t.Items,function(e,t){"BingMap"!==t.widgetName||BoldBIDashboard.isNullOrUndefined(i.Value[t.widgetName.toLowerCase()])||(t.hide=i.Value[t.widgetName.toLowerCase()].hide)})}))},e.prototype.renderGroup=function(){var e=this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel");this.defaultPanel.find("#"+this.dashboardDesigner._id+"_scrollContentItemPanel").empty(),this.dashboardDesigner.model.mode===BoldBIDashboard.Designer.mode.design&&this.dashboardDesigner._trigger("beforeWidgetItemsListed",{widgetInfo:this.panelItems}),this.renderGroupItems(this.panelItems,e,!0,!1)},e.prototype.cleanWidgetGroups=function(e){return this.updateWidgetList(JSON.parse(JSON.stringify(this.widgetItems)),e)},e.prototype.updateWidgetList=function(e,t){for(var i=e.length-1;0<=i;i--)this.setWidgetVisibility(t,e[i].Items),this.hideWidgetIfAny(e[i].Items),0===e[i].Items.length&&e.splice(i,1);return e},e.prototype.setWidgetVisibility=function(t,e){BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(t.Value)||e.filter(function(e){BoldBIDashboard.isNullOrUndefined(e.widgetName)||BoldBIDashboard.isNullOrUndefined(t.Value[e.widgetName.toLowerCase()])||(e.hide=t.Value[e.widgetName.toLowerCase()].hide,e.customData=t.Value[e.widgetName.toLowerCase()].args)})},e.prototype.hideWidgetIfAny=function(e){for(var t=e.length-1;0<=t;t--)!BoldBIDashboard.isNullOrUndefined(e[t].hide)&&e[t].hide&&e.splice(t,1)},e.prototype.generateTooltipTemplate=function(e,t,i){return"<div class= 'e-defaultIndex-info-container'><div class='bbi-defaultIndex-text-wrapper'><div class = 'bbi-defaultIndexHeader'><b>"+e+"</b></div><div class = 'e-defaultIndex-info-text'>"+t+"</div></div><div class='bbi-defaultIndex-text-wrapper'><div class = 'bbi-defaultIndexHeader'><b>"+this.locale.itemPanel.widgetTitle.dataRequirements+"</b></div><div class = 'e-defaultIndex-info-text '>"+i+"</div></div></div>"},e.prototype.createDashboardListContainer=function(e,t){for(var i=0;i<e.length;i++){var a=BoldBIDashboard.buildTag("div","",{},{id:this.dashboardDesigner._id+"_dashboard_name_wrapper_"+e[i].Id,class:"bbi-dashboard-name-wrapper e-tooltip","data-id":e[i].Id,"data-version":e[i].Version}),o=BoldBIDashboard.buildTag("div",'<label style="cursor: pointer;">'+e[i].Name+"</label>",{},{class:"bbi-dbrd-dashboard-name e-tooltip"}),s=BoldBIDashboard.buildTag("div",'<label style="cursor: pointer;">By '+e[i].CreatedUserName+"</label>",{},{class:"bbi-dbrd-dashboard-creator-name",type:"text"});a.append(o,s),t.append(a)}return t},e.prototype.setScroller=function(e){var e=e.scrollTop,t=this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_expandable_parent_div").height(),i=this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_scroll_content_existingpanel").height();!BoldBIDashboard.isNullOrUndefined(e)&&0<e&&i-t<=e&&0<this.pageNumber&&!this.pageRequestInProgress&&(this.showSkeletonContainer(),this.searchInitiated=!1,this.pageRequestInProgress=!0,this.loadDashboardList(this.pageNumber,this.searchText))},e.prototype.loadDashboardList=function(e,t){!BoldBIDashboard.isNullOrUndefined(this.filterSearchTimer)&&this.filterSearchTimer&&4!==this.filterSearchTimer.readyState&&this.filterSearchTimer.abort(),this.filterSearchTimer=this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.shareddashboard,{action:BoldBIDashboard.DashboardUtil.DesignerAction.SharedDashboard,data:JSON.stringify({pageInfo:{pageSize:20,pageNo:e},sortInfo:{sortOrder:"Asc",sortBy:"Name"},searchKey:t})},{fnction:this.bbdesigner$.proxy(this.renderDashboardList,this),errfnction:this.bbdesigner$.proxy(this.onConnectionErrorForSearch,this),completefnction:this.bbdesigner$.proxy(this.updatePageRequestProgress,this)},!0,!0)},e.prototype.updatePageRequestProgress=function(){this.pageRequestInProgress=!1},e.prototype.onConnectionErrorForSearch=function(e){"abort"===e.statusText||0!==e.readyState||e.responseText||(this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),e=this.locale.errorMessage.connectionRefused,this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e))},e.prototype.renderDashboardList=function(e){var t;!BoldBIDashboard.isNullOrUndefined(e.Data)&&0<e.Data.length?(this.hideErrorMsg(),this.searchInitiated&&(this.scrollExistingContent[0].innerHTML=""),t=e.Data,t=0<this.widgetPanelSettings.existingDashboards.length?this.getMatchingdDashboardsList(t):t,this.createDashboardListContainer(t,this.scrollExistingContent),this.pageNumber=e.Page,this.hideSkeletonContainer(),this.scrollExistingContent.css("display","block"),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh()):(this.hideSkeletonContainer(),this.scrollExistingContent[0].innerHTML="",this.showErroMsg(this.locale.errorMessage.noDashboard))},e.prototype.dashboardSearch=function(){var e=this;BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?this.searchInitiated=!1:(this.searchText=this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val(),""!==this.searchText?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-close").removeClass("bbi-dbrd-designer-search"),this.searchInitiated=!0,this.scrollExistingContent[0].innerHTML="",this.showSkeletonContainer(),this.hideErrorMsg(),setTimeout(function(){e.loadDashboardList(1,e.searchText)},500)):this.resetDashboardList())},e.prototype.renderSkelton=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dbrd-dashboards-skeleton-tag","",{},{id:this.dashboardDesigner._id+e}),i=BoldBIDashboard.buildTag("div.bbi-empty-ds-title-block","",{},{id:this.dashboardDesigner._id+e+"_title_blocks"}),a=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-dashboard-title bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+e+"_title_loading"}),e=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-dashboard-content bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+e+"_content_loading"}),o=i.append(a,e).clone();return t.append(o,i.append(a,e))},e.prototype.showSkeletonContainer=function(){0<this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").length&&(this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader")[0].innerHTML=""),this.sharedDashboardLoader.append(this.renderSkelton("_shared_dbrd_skeleton")),this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_scroll_parent_container").append(this.sharedDashboardLoader),this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","block")},e.prototype.hideSkeletonContainer=function(){this.dashboardWholeWrapper.find("#"+this.dashboardDesigner._id+"_existingpanel_list_view_loader").css("display","none")},e.prototype.renderSkeletonForWidgets=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dbrd-widgets-skeleton-tag","",{},{id:this.dashboardDesigner._id+e}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title-block","",{},{id:this.dashboardDesigner._id+e+"_widgets_title_blocks"}),a=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title-icon bbi-dbrd-empty-dashboard-list-loader","",{},{}),e=BoldBIDashboard.buildTag("div.bbi-dbrd-empty-widgets-title bbi-dbrd-empty-dashboard-list-loader","",{},{id:this.dashboardDesigner._id+e+"_widgets_title_loading"}),o=i.append(a,e).clone();return t.append(o,i.append(a,e))},e.prototype.refreshDashboardList=function(){BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?(this.hideErrorMsg(),this.dashboardWholeWrapper.remove(),this.sendRequestForDashboardsDetail({activeIndex:1})):(this.hideErrorMsg(),this.pageNumber=1,this.searchInitiated=!1,this.showSkeletonContainer(),this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val(""),this.searchText="",this.scrollExistingContent[0].innerHTML="",this.loadDashboardList(this.pageNumber,this.searchText))},e.prototype.showErroMsg=function(e){BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e)):(this.scrollExistingContent.css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","block"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(e),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},e.prototype.hideErrorMsg=function(){BoldBIDashboard.isNullOrUndefined(this.scrollExistingContent)?(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html("")):(this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel").css("display","none"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_content_error_msg_for_existing_panel p").html(""),this.expandableExistingPanel.data("BoldBIDashboardScroller").refresh())},e.prototype.getCurrentWidgetItems=function(e){for(var t,i,a,o,s=this.widgetItems,n=[],r=0;r<e.length;r++)for(t=!1,i=0;i<s.length;i++){if(BoldBIDashboard.isNullOrUndefined(e[r].Type)){n.push(s[0].Items[1]);break}for(a=0;a<s[i].Items.length;a++)if(o=!BoldBIDashboard.isNullOrUndefined(s[i].Items[a])&&s[i].Items[a].isPreconfiguredWidget,e[r].Type!==s[0].Items[0].serializationNameSpace||o){if(e[r].Type===s[i].Items[a].serializationNameSpace&&!o){n.push(s[i].Items[a]),t=!0;break}}else if(e[r].SubType===s[i].Items[a].widgetName){n.push(s[i].Items[a]),t=!0;break}if(t)break}if(0===n.length)for(r=0;r<e.length;r++)n.push(s[0].Items[1]);return n},e.prototype.resetDashboardList=function(){this.existingPanel.find("#"+this.dashboardDesigner._id+"_searchIcon_for_existing_panel").addClass("bbi-dbrd-designer-search").removeClass("bbi-dbrd-designer-close"),this.existingPanel.find("#"+this.dashboardDesigner._id+"_panel_search_for_existing_panel").val(""),this.searchText="",this.hideErrorMsg(),this.showSkeletonContainer(),this.scrollExistingContent[0].innerHTML="",this.loadDashboardList(1,this.searchText)},e.prototype.onExpandCollapsePanel=function(e,t){var i,a;void 0===t&&(t=!1),BoldBIDashboard.isNullOrUndefined(e)&&!t||(a=(i=t?"expand"===this.targetTag.find("#"+this.dashboardDesigner._id+"_item_panel_expand_collapse").attr("data-toggle"):"expand"===this.bbdesigner$(e.target).attr("data-toggle"))?"none":"block",(e=t?this.targetTag.find("#"+this.dashboardDesigner._id+"_item_panel_expand_collapse"):this.bbdesigner$(e.target)).attr({"data-toggle":i?"collapse":"expand","data-tooltip":i?this.locale.dataConfigurationPanel.expand:this.locale.dataConfigurationPanel.collapse}).removeClass("bbi-widgetpanel-expand bbi-widgetpanel-collapse").addClass(i?"bbi-widgetpanel-expand":"bbi-widgetpanel-collapse"),t&&e.addClass("bbi-widgetspanel-expandcollapseicon-disable"),this.defaultPanel.find("#"+this.dashboardDesigner._id+"_item_autocomplete").css("display",a),this.expandablePanel.css("display",a),this.existingPanel.css("display",a),this.targetTag.find("#"+this.dashboardDesigner._id+"_designerItemPanel_Tab").css("display",a),this.targetTag.css("width",i?"15px":"240px"),this.dashboardDesigner.updateDesignPanel(),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.designerPanel)||this.dashboardDesigner.designerPanel.updateScrollBar(),i)||(t=this.targetTag.find("#"+this.dashboardDesigner._id+"_designerItemPanel_Tab").data("BoldBIDashboardTab"),BoldBIDashboard.isNullOrUndefined(t))||(1===t.model.selectedItemIndex?this.expandableExistingPanel:this.expandablePanel).data("BoldBIDashboardScroller").refresh()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ItemPanel",InternalItemPanel,window),ExistingWidgetCategory=function(){this.isCategoryExists=!1,this.categoryGroupId="",this.categoryName=""},function(y){function e(e){this.locale=null,this.designerInst=e,this.bbdesigner$=this.designerInst.bbdesigner$,this.locale=this.designerInst.getLocalizationContent(),this.propertyPanel=this.designerInst.modules.propertyPanel,this.widgetHelper=this.designerInst.modules.widgetHelper}e.prototype.render=function(e,t,i){var a,o,s,n,r,d,l,h,p,c,u,b,g,m,f,D;this.canUpdate=!1,this.categoryId=this.designerInst._id+"_"+t+"_"+i.category,t=this.propertyPanel.propertyPanelContainer.width(),o=this.designerInst.element.find("#"+this.categoryId),i.value=this.widgetHelper.getCurrentWidgetInstance().getNoDataContainerSettings(),a=i.value,0===o.length&&e&&(o=y.buildTag("div","",{width:t},{id:this.categoryId}),s=y.buildTag("table.bbi-designer-exp-table","",{width:"100%","border-spacing":"0 0.8em"},{unselectable:"on"}),n=y.buildTag("tr","",{},{}),r=y.buildTag("td","",{width:47*(t-33)/100+"px"},{}),d=y.buildTag("td","",{},{}),D=y.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.hideIcon,{},{id:this.categoryId+"_wdgt_nodata_text_ckb",for:this.categoryId+"_wdgt_nodata_ckb"}),l=y.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.showDefaultIcon,{"margin-right":"11px"},{id:this.categoryId+"_wdgt_nodata_imagetext_ckb",for:this.categoryId+"_wdgt_nodata_image_ckb"}),h=y.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.text,{"margin-right":"11px"},{id:this.categoryId+"_wdgt_nodata_text"}),p=y.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_nodata_ckb",type:"checkbox"}),c=y.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_nodata_image_ckb",type:"checkbox"}),this.inputTxt=y.buildTag("input.e-textbox bbi-designer-fontfamily","",{position:"relative"},{id:this.categoryId+"_wdgt_nodata_custom_txt",type:"text",placeholder:this.locale.designPanel.noDataToBeDisplay}),u=y.buildTag("div","",{width:"200px"},{id:this.categoryId+"_wdgt_nodata_custom_input_container"}),b=y.buildTag("div","",{width:"36px",display:"inline-block","margin-top":"3px"}),g=y.buildTag("input.e-reportdesigner-designer","",{},{id:this.categoryId+"_wdgt_nodata_txt_color"}),b.append(g),g.BoldBIDashboardColorPicker({value:y.DashboardUtil.getColorCode("#000000"),cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",width:"36px",select:this.bbdesigner$.proxy(this.onColorChange,this),modelType:"palette",palette:"basicpalette",buttonMode:y.ButtonMode.Dropdown}),g=y.buildTag("div","",{width:57*(t-33)/100+"px",display:"inline-block","margin-top":"3px"}),m=y.buildTag("input","",{},{id:this.categoryId+"_wdgt_nodata_trans_numeric"}),g.append(m),f=57*(t-33)/200,f-=12,m.ejNumericTextbox({incrementStep:.1,decimalPlaces:1,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",maxValue:1,minValue:0,change:this.bbdesigner$.proxy(this.onTransparencyChange,this),enabled:!1,width:f+"px"}),u.append(this.inputTxt),n.clone().addClass("bbi-dbrd-hiddendiv"),s.append(n.clone().append(r.clone().append(D),d.clone().append(p))),!y.isNullOrUndefined(i.isVisible)&&i.isVisible&&(m=y.buildTag("label.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.noDataContainerSettings.showNoDataHeader,{},{id:this.categoryId+"_wdgt_nodata_text_check",for:this.categoryId+"_wdgt_nodata_check"}),f=y.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_nodata_check",type:"checkbox"}),(D=y.buildTag("span.bbi-dbrd-data-section-description e-icon-dbrd-theme bbi-dbrd-designer-hoverable","",{display:"inline-block","margin-left":"5px"})).attr("data-tooltip",this.locale.propertyPanel.noDataContainerSettings.showHeaderInfo),s.append(n.clone().append(r.clone().append(m),d.clone().append(f,D))),f.BoldBIDashboardCheckBox({width:57*(t-33)/100-15+"px",change:this.bbdesigner$.proxy(this.onNodataChkbxClick,this),cssClass:"e-designer-prop-checkbox"})),s.append(n.clone().append(r.clone().append(h),u),n.clone().append(r.clone().append(h.clone().html(this.locale.propertyPanel.noDataContainerSettings.textColor)),b),n.clone().append(r.clone().append(l),d.clone().append(c)),n.clone().append(r.clone().append(h.clone().html(this.locale.propertyPanel.noDataContainerSettings.transparency)),g)),o.append(s),e.append(o),p.BoldBIDashboardCheckBox({width:57*(t-33)/100-15+"px",change:this.bbdesigner$.proxy(this.onChkbxClick,this),cssClass:"e-designer-prop-checkbox"}),c.BoldBIDashboardCheckBox({width:57*(t-33)/100-15+"px",change:this.bbdesigner$.proxy(this.onDefaultImgChkbxClick,this),cssClass:"e-designer-prop-checkbox"}),this.inputTxt.on("focusout",this.bbdesigner$.proxy(this.saveCustomMsg,this))),0<o.length&&(y.isNullOrUndefined(a)||(this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_ckb").data("BoldBIDashboardCheckBox").setModel({checked:a.HideDefaultIcon}),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_image_ckb").data("BoldBIDashboardCheckBox").setModel({checked:a.ImageInfo.ShowImage}),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_txt_color").data("BoldBIDashboardColorPicker").option("value",y.DashboardUtil.getColorCode(a.FontColor)),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_custom_txt").val(a.CustomMsg),(m=this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").data("ejNumericTextbox")).setModel({value:a.ImageInfo.Transparency}),a.ImageInfo.ShowImage&&m.setModel({enabled:!0}),this.noDataContainerSettings=i,!y.isNullOrUndefined(i.isVisible)&&i.isVisible&&this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_check").data("BoldBIDashboardCheckBox").setModel({checked:a.ShowHeader}))),this.widgetHelper.getCurrentWidgetInstance()instanceof InternalCustomWidgetReportItem&&(this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_image_ckb").closest("tr").hide(),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").closest("tr").hide()),this.canUpdate=!0},e.prototype.onTransparencyChange=function(e){e.isInteraction&&(this.noDataContainerSettings.value.ImageInfo.Transparency=this.updateDefaultOpacityValue(e),this.updateWidgetProperty(this.noDataContainerSettings),y.Dashboard.WidgetContainerHelper.updateNoDataImageOpacity(this.widgetHelper.getCurrentWidgetInstance(),e.value))},e.prototype.updateDefaultOpacityValue=function(e){return y.isNullOrUndefined(e.value)?(this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").data("ejNumericTextbox").setModel({value:e.model.maxValue}),e.model.maxValue):e.value},e.prototype.onColorChange=function(e){y.isNullOrUndefined(e)||y.isNullOrUndefined(e.value)||this.canUpdate&&(this.noDataContainerSettings.value.FontColor=e.value,this.updateWidgetProperty(this.noDataContainerSettings),y.Dashboard.WidgetContainerHelper.updateNoDataFontColor(this.widgetHelper.getCurrentWidgetInstance(),e.value))},e.prototype.onNodataChkbxClick=function(e){e.isInteraction&&(this.noDataContainerSettings.value.ShowHeader=e.isChecked,this.updateWidgetProperty(this.noDataContainerSettings))},e.prototype.onChkbxClick=function(e){e.isInteraction&&(this.noDataContainerSettings.value.HideDefaultIcon=e.isChecked,this.updateWidgetProperty(this.noDataContainerSettings),y.Dashboard.WidgetContainerHelper.updateNoDataIcon(this.widgetHelper.getCurrentWidgetInstance(),e.isChecked))},e.prototype.onDefaultImgChkbxClick=function(e){e.isInteraction&&(this.noDataContainerSettings.value.ImageInfo.ShowImage=e.isChecked,this.noDataContainerSettings.value.ImageInfo.Type=NoDataImageType.Default,this.updateWidgetProperty(this.noDataContainerSettings),y.Dashboard.WidgetContainerHelper.updateNoDataDefaultImg(this.widgetHelper.getCurrentWidgetInstance(),e.isChecked),y.Dashboard.WidgetContainerHelper.updateNoDataImageOpacity(this.widgetHelper.getCurrentWidgetInstance(),this.noDataContainerSettings.value.ImageInfo.Transparency),this.designerInst.element.find("#"+this.categoryId+"_wdgt_nodata_trans_numeric").data("ejNumericTextbox").setModel({enabled:e.isChecked}))},e.prototype.saveCustomMsg=function(e){e=this.bbdesigner$(e.currentTarget);!y.isNullOrUndefined(e)&&0<e.length&&0<e.val().length&&(this.noDataContainerSettings.value.CustomMsg=e.val(),this.updateWidgetProperty(this.noDataContainerSettings),y.Dashboard.WidgetContainerHelper.updateDataNotConfiguredMsg(this.widgetHelper.getCurrentWidgetInstance(),e.val()))},e.prototype.updateWidgetProperty=function(e){this.widgetHelper.getCurrentWidgetInstance().updateNoDataContainerSettings(e.value),this.designerInst.modules.serialization.notifyChange()},y.NoDataContainerAppearence=e}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e){this.id=null,this.locale=null,this.dashboardDesigner=null,this.connectionInstance=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.initializeConnectionInstance()}e=l.Dashboard||(l.Dashboard={}),t.prototype.createMenu=function(e,t,i,a){var o=l.buildTag("div","",{"margin-top":"5px"},{id:this.id+"_"+e.Name+"_categoryAggregateList"});0<(t=0===t.length?this.getDefaultMenuJson(e,i,a):t).length&&this.populateFunctionItems(o,e,t)},t.prototype.initializeConnectionInstance=function(){this.connectionInstance=new InternalDataSource(this.dashboardDesigner)},t.prototype.createMenuforHierarchy=function(e,t,i,a,o){this.hierarchyFieldInfo=a,this.createMenu(e,t,i,o)},t.prototype.getDefaultMenuJson=function(e,t,i){var a,o,s=[];if(!e.IsParameterField){if(a=!1,e.ContainerType===FieldContainerType.Numeric||e.ContainerType===FieldContainerType.None){for(o=0;o<t.length;o++)if(t[o].Id===e.Id)s=this.getNumericMenuItems(e);else if(t[o].ColumnId===e.Id){a=!0,"Tooltip"!==e.ContainerName&&s.push(this.getMeasureFilterMenuItem()),s.push(this.getMeasureFormatOption());break}a||(s=i?0===s.length?this.getMenuItemForHierarchialSet(e):s:0===s.length?e.ContainerType===FieldContainerType.None?this.getNon_NumericMenuItems(e):this.getNumericDimensionMenuItems(e):s)}else e.ContainerType===FieldContainerType.Non_Numeric?s=i?this.getMenuItemForHierarchialSet(e):this.getNon_NumericMenuItems(e):e.FieldType===FieldType.Dimensions&&l.isNullOrUndefined(e.ChildHierarchicalFields)?s=0===s.length?this.getMenuforCustomHierarchy(e):s:l.isNullOrUndefined(e.ChildHierarchicalFields)||(s=0===s.length?this.getMenuforCustomHierarchyFields(e):s);"Dimensions"!==e.ContainerName&&s.unshift(this.getRenameMenuOption())}return s},t.prototype.getMenuforCustomHierarchy=function(e){e=[{Name:"CreateHierarchy",DisplayName:this.locale.dataconfiguration.menuItems.CreateHierarchyDisplayName,EnableSeparator:!0,IsDisable:this.checkCustomHierarchy(e)},{Name:"AddtoHierarchy",DisplayName:this.locale.dataconfiguration.menuItems.AddToHierarchyDisplayName,Items:this.getsubMenuhierarchyfields()}];return this.createMenuItemsList(e)},t.prototype.checkCustomHierarchy=function(e){for(var t=0;t<this.hierarchyFieldInfo.length;t++)if(e.Id===this.hierarchyFieldInfo[t].Id)return!0;return"bbi-designer-dataset-datetime"===e.FieldActualType},t.prototype.getMenuforCustomHierarchyFields=function(e){var t;if(!l.isNullOrUndefined(e))return(t=[]).unshift(this.getRenameMenuOption()),t.push({Name:"Remove",DisplayName:this.locale.dataconfiguration.menuItems.CustomHierarchyremove,Items:e}),this.createMenuItemsList(t)},t.prototype.getNumericMenuItems=function(e){var t,i=[];return e.IsAggregatedExpression||(t=[{Name:SummaryType.NONE,DisplayName:this.locale.dataconfiguration.summary.none,IsVisible:!1},{Name:SummaryType.SUM,DisplayName:this.locale.dataconfiguration.summary.sum},{Name:SummaryType.COUNT,DisplayName:this.locale.dataconfiguration.summary.count},{Name:SummaryType.AVG,DisplayName:this.locale.dataconfiguration.summary.avg},{Name:SummaryType.MAX,DisplayName:this.locale.dataconfiguration.summary.max},{Name:SummaryType[SummaryType.MIN],DisplayName:this.locale.dataconfiguration.summary.min},{Name:SummaryType.MEDIAN,DisplayName:this.locale.dataconfiguration.summary.median},{Name:SummaryType.COUNTD,DisplayName:this.locale.dataconfiguration.summary.countd},{Name:SummaryType.VAR,DisplayName:this.locale.dataconfiguration.summary.var,EnableSeparator:!0}],(i=this.createMenuItemsList(t)).push(this.getShowValueItems())),"Tooltip"!==e.ContainerName&&i.push(this.getMeasureFilterMenuItem()),i.push(this.getMeasureFormatOption()),i},t.prototype.getMeasureFilterMenuItem=function(){var e=[{Name:"MeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.measureFilterDisplayName,EnableSeparator:!0,Icon:"bbi-designer-toolbarIconBasic bbi-toolbarfonticonbasic bbi-designer-configuration-parameters",Items:this.getSubMeasureFilterItems()}];return this.createMenuItemsList(e)[0]},t.prototype.getMeasureFormatOption=function(){var e=[{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName}];return this.createMenuItemsList(e)[0]},t.prototype.getShowValueItems=function(){var e=[{Name:"ShowValueAs",DisplayName:this.locale.dataconfiguration.menuItems.showValueAs,EnableSeparator:!0,Items:this.getSubShowValueItems(),IsVisible:!1}];return this.createMenuItemsList(e)[0]},t.prototype.getSubShowValueItems=function(){var e=[{Name:ShowValueType.NoCalculation,DisplayName:this.locale.dataconfiguration.menuItems.noCalculation},{Name:ShowValueType.PercentageOfGrandTotal,DisplayName:this.locale.dataconfiguration.menuItems.percentOfGrandTotal},{Name:ShowValueType.PercentageOfRowTotal,DisplayName:this.locale.dataconfiguration.menuItems.percentOfRowTotal},{Name:ShowValueType.PercentageOfColumnTotal,DisplayName:this.locale.dataconfiguration.menuItems.percentOfColumnTotal}];return this.createMenuItemsList(e)},t.prototype.getShowDimensionalValueItems=function(){var e=[{Name:"Show Dimension As",DisplayName:this.locale.dataconfiguration.menuItems.showDimensionAs,EnableSeparator:!0,Items:this.getSubColumnShowValueItems(),IsVisible:!1}];return this.createMenuItemsList(e)[0]},t.prototype.getSubColumnShowValueItems=function(){var e=[{Name:"CapitalizeEachWord",DisplayName:this.locale.dataconfiguration.menuItems.capitalizeEachWord}];return this.createMenuItemsList(e)},t.prototype.getRenameMenuOption=function(){var e=[{Name:"Rename",DisplayName:this.locale.dataconfiguration.menuItems.rename,EnableSeparator:!0}];return this.createMenuItemsList(e)[0]},t.prototype.getSubMeasureFilterItems=function(){var e=[{Name:"EditMeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearMeasureFilter",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.getNon_NumericMenuItems=function(e){var t,i,a=[{Name:"Sort",DisplayName:this.locale.dataconfiguration.menuItems.SortDispalyName,EnableSeparator:!0,IsSelected:!0},{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName,IsVisible:!1}],a=this.createMenuItemsList(a);return"bbi-designer-dataset-datetime"===e.FieldActualType&&l.isNullOrUndefined(e.ChildHierarchicalFields)&&(a=a.concat(this.getDateFieldMenuItems(e))),"bbi-designer-dataset-string"===e.FieldActualType&&l.isNullOrUndefined(e.ChildHierarchicalFields)&&this.isDimensionValueSupported(this.getProviderTypeForDataSource(e.DatasourceID))&&"FilterColumn"!=e.ContainerName?a=a.concat(this.getShowDimensionalValueItems()):l.isNullOrUndefined(e.ChildHierarchicalFields)||(i=[{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()}],a=a.concat(this.createMenuItemsList(i))),l.isNullOrUndefined(e.ChildHierarchicalFields)&&(a=a.concat(this.createMenuItemsList(this.getFilterMenuItem())),t=this.dashboardDesigner.widgetHelper.getCurrentWidgetInstance(),!l.isNullOrUndefined(t))&&t.allowParamaterInjection(e)&&(i=[{Name:"InjectParameters",DisplayName:"Inject Parameters",Items:this.getInjectParameterItems()}],a=a.concat(this.createMenuItemsList(i))),a},t.prototype.isDimensionValueSupported=function(e){if(null===e)return!1;switch(e.toLowerCase()){case"amazonathena":case"elasticsearch":case"google":case"mysql":case"odbc":case"oracle":case"presto":case"postgresql":case"rockset":case"snowflake":case"sql":case"sparksql":case"sqlite":return!0;default:return!1}},t.prototype.getProviderTypeForDataSource=function(t){var e,i=null==(i=this.connectionInstance)?void 0:i.datasources.findIndex(function(e){return e.Id===t});return void 0!==i&&-1!==i&&(null==(e=this.connectionInstance)?void 0:e.datasources[i].ConnectionProperties.DataProvider)||null},t.prototype.getFilterMenuItem=function(){return[{Name:"DimensionFilters",DisplayName:this.locale.dataconfiguration.menuItems.dimensionFilterDisplayName,Items:this.getSubDimesionFilterItems()}]},t.prototype.getMenuItemForHierarchialSet=function(e){var t=[{Name:"Sort",DisplayName:this.locale.dataconfiguration.menuItems.SortDispalyName,EnableSeparator:!0,IsSelected:!0},{Name:"MeasureFormat",DisplayName:this.locale.dataconfiguration.menuItems.measureFormatDisplayName,IsVisible:!1}],t=this.createMenuItemsList(t);return"bbi-designer-dataset-datetime"===e.FieldActualType&&(e=[{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()}],t=t.concat(this.createMenuItemsList(e))),e=[{Name:"DimensionFilters",DisplayName:this.locale.dataconfiguration.menuItems.dimensionFilterDisplayName,Items:this.getSubDimesionFilterItems()}],t.concat(this.createMenuItemsList(e))},t.prototype.getDateFieldMenuItems=function(e){var t=[{Name:DateTimeFormat.Default,DisplayName:this.locale.dataconfiguration.menuItems.dateTime},{Name:DateTimeFormat.Date,DisplayName:this.locale.dataconfiguration.menuItems.date},{Name:DateTimeFormat.Year,DisplayName:this.locale.dataconfiguration.menuItems.year},{Name:DateTimeFormat.Quarter,DisplayName:this.locale.dataconfiguration.menuItems.quarter},{Name:DateTimeFormat.Month,DisplayName:this.locale.dataconfiguration.menuItems.month},{Name:DateTimeFormat.Day,DisplayName:this.locale.dataconfiguration.menuItems.day},{Name:"More",DisplayName:this.locale.dataconfiguration.menuItems.more,EnableSeparator:!0,Items:this.getSubDateTimeItems(e)},{Name:"RelativeDateFilter",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateFilterDisplayName,Items:this.getSubRelativeDateFilterItems()},{Name:"RelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.relativeDateOptionsDisplayName,IsVisible:!1,Items:this.getSubRelativeDateOptionsItems()},{Name:"Settings",DisplayName:"Settings",Items:this.getSubSettingsOptionsItems()}];return this.createMenuItemsList(t,e)},t.prototype.getSubDimesionFilterItems=function(){var e=[{Name:"EditDimensionFilter",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearDimensionFilter",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.getNumericDimensionMenuItems=function(e){var t=[{Name:SummaryType.COUNT,DisplayName:this.locale.dataconfiguration.summary.count},{Name:SummaryType.COUNTD,DisplayName:this.locale.dataconfiguration.summary.countd,EnableSeparator:"Tooltip"!==e.ContainerName}],t=this.createMenuItemsList(t);return e.IsAggregatedExpression||t.push(this.getShowValueItems()),"Tooltip"!==e.ContainerName?t.push(this.getMeasureFilterMenuItem()):t=t.concat(this.getFirstLastMenuItems()),t.push(this.getMeasureFormatOption()),t},t.prototype.getsubMenuhierarchyfields=function(){for(var e=[],t=0;t<this.hierarchyFieldInfo.length;t++)"bbi-designer-dataset-datetime"!==this.hierarchyFieldInfo[t].FieldActualType&&e.push({Name:"AddToHierarchy",DisplayName:this.hierarchyFieldInfo[t].Name,Items:this.hierarchyFieldInfo[t]});return this.createMenuItemsList(e)},t.prototype.getFirstLastMenuItems=function(){var e=[{Name:"First",DisplayName:this.locale.dataconfiguration.menuItems.first},{Name:"Last",DisplayName:this.locale.dataconfiguration.menuItems.last,EnableSeparator:!0}];return this.createMenuItemsList(e)},t.prototype.getSubDateTimeItems=function(e){var t=[{Name:DateTimeFormat.Time,DisplayName:this.locale.dataconfiguration.menuItems.time},{Name:DateTimeFormat.Hour,DisplayName:this.locale.dataconfiguration.menuItems.hours},{Name:DateTimeFormat.Minute,DisplayName:this.locale.dataconfiguration.menuItems.minutes},{Name:DateTimeFormat.Second,DisplayName:this.locale.dataconfiguration.menuItems.seconds,EnableSeparator:!0},{Name:DateTimeFormat.QuarterYear,DisplayName:this.locale.dataconfiguration.menuItems.quarterYear},{Name:DateTimeFormat.MonthYear,DisplayName:this.locale.dataconfiguration.menuItems.monthYear},{Name:DateTimeFormat.WeekYear,DisplayName:this.locale.dataconfiguration.menuItems.weekYear,EnableSeparator:!0},{Name:DateTimeFormat.DateHour,DisplayName:this.locale.dataconfiguration.menuItems.dateHour},{Name:DateTimeFormat.DayOfWeek,DisplayName:this.locale.dataconfiguration.menuItems.dayOfWeek},{Name:DateTimeFormat.WeekOfYear,DisplayName:this.locale.dataconfiguration.menuItems.weekOfYear,EnableSeparator:!0},{Name:DateTimeFormat.DayMonthYear,DisplayName:this.locale.dataconfiguration.menuItems.dayMonthYear},{Name:DateTimeFormat.MonthDayYear,DisplayName:this.locale.dataconfiguration.menuItems.monthDayYear}],t=this.fetchDateBucketFieldMenuItems(t,e);return this.createMenuItemsList(t)},t.prototype.fetchDateBucketFieldMenuItems=function(e){var t,i,a,o=e;for(o[o.length-1].EnableSeparator=!0,t=this.dashboardDesigner.modules.widgetHelper.getAllWidgets(),i=0;i<t.length;i++)t[i].isDefaultDataWidget()&&(a={Name:"DateBucket_"+t[i].getJson().UniqueId,DisplayName:t[i].getContainerSettings().Title},o.push(a));return o},t.prototype.getSubRelativeDateFilterItems=function(){var e=[{Name:"EditRelativeDate",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearRelativeDate",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.getInjectParameterItems=function(){var e=[{Name:"EditInjectParameters",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearInjectParameters",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.getSubRelativeDateOptionsItems=function(){var e=[{Name:"EditRelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearRelativeDateOptions",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.getSubSettingsOptionsItems=function(){var e=[{Name:"EditSettings",DisplayName:this.locale.dataconfiguration.menuItems.edit,Icon:"e-icon bbi-widgeticon bbi-designer-parameter-edit"},{Name:"ClearCustomDateSettings",DisplayName:this.locale.dataconfiguration.menuItems.clear,Icon:"bbi-headericon bbi-designer-close bbi-designer-errorLog"}];return this.createMenuItemsList(e)},t.prototype.createMenuItemsList=function(e,t){for(var i,a,o=[],s=0;s<e.length;s++)(i=new l.Dashboard.FieldMenu).Name=(l.isNullOrUndefined(e[s].Name)?i:e[s]).Name,i.DisplayName=(l.isNullOrUndefined(e[s].Name)?i:e[s]).DisplayName,i.EnableSeparator=(l.isNullOrUndefined(e[s].EnableSeparator)?i:e[s]).EnableSeparator,i.IsVisible=(l.isNullOrUndefined(e[s].IsVisible)?i:e[s]).IsVisible,i.IsDisable=(l.isNullOrUndefined(e[s].IsDisable)?i:e[s]).IsDisable,i.IsSelected=(l.isNullOrUndefined(e[s].IsSelected)?i:e[s]).IsSelected,i.Icon=(l.isNullOrUndefined(e[s].Icon)?i:e[s]).Icon,i.Items=(l.isNullOrUndefined(e[s].Items)?i:e[s]).Items,"Settings"===i.Name&&(a=this.dashboardDesigner.designerPanel.selectedReportItems[0],a=l.Dashboard.WidgetHelper.getWidgetInstance(a).DataGroupInfo,i.IsVisible=this.IsMenuItemVisible(a,t)),o.push(i);return o},t.prototype.IsMenuItemVisible=function(e,t){for(var i=0;i<e.FieldContainers.length;i++)if(e.FieldContainers[i].Name===t.ContainerName&&e.FieldContainers[i].HasCustomDate)return!0;return!1},t.prototype.populateFunctionItems=function(e,t,i){for(var a,o,s=l.isNullOrUndefined(t.ChildHierarchicalFields)?l.buildTag("ul.bbi-designer-menu","",{padding:"4px"},{id:this.id+"_"+t.Id+"_categoryAggregateListUl_"+t.UniqueId}):l.buildTag("ul.bbi-designer-menu","",{padding:"4px"},{id:this.id+"_"+t.Id+"_categoryAggregateListUlHierarchy_"+t.UniqueId}),n=0;n<i.length;n++)o=(a=this.getMenuListItem(i[n],t.UniqueId)).find(".e-fieldmenuListIcon"),l.isNullOrUndefined(i[n].Icon)?this.updateDefaultSelection(t,i[n]):(o.addClass(i[n].Icon),o.css({"font-size":"12px","margin-left":"5px","margin-top":"1.5px"})),0<i[n].Items.length&&a.append(this.getChildMenuList(i[n],t)),s.append(a);e.append(s),e=new l.Dashboard.FieldMenuHandler(this.dashboardDesigner),s.BoldBIDashboardMenu({menuType:l.MenuType.ContextMenu,openOnClick:!1,contextMenuTarget:"#"+this.id+"_"+t.Id+"_categoryListDiv_"+t.UniqueId,width:180,click:this.bbdesigner$.proxy(e.onSettingsMenuItemClick,e,t)})},t.prototype.updateDefaultSelection=function(e,t){(e.SummaryType===t.Name||e.FieldType===FieldType.Dimensions&&e.DateTimeFormat===t.Name)&&(t.IsSelected=!0)},t.prototype.getMenuListItem=function(e,t){var t=l.buildTag("li.e-list","",{},{id:this.id+"_"+e.Name+"_"+t}),i=l.buildTag("a.e-fieldmenuListName",e.DisplayName,{},{fieldMenuName:e.Name}),a=l.buildTag("span.e-fieldmenuListIcon","",{},{});return i.BoldBIDashboardTooltip({content:e.DisplayName,collision:l.Tooltip.Collision.Flip,trigger:l.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!0}),i.append(a),t.append(i),t.data("menuitem-info",e),t.data("hierarchy-info",e.Items),t},t.prototype.getChildMenuList=function(e,t){for(var i,a,o=l.buildTag("ul","",{padding:"4px",width:"ShowValueAs"===e.Name?"190px":"150px"},{}),s=0;s<e.Items.length;s++)a=(i=this.getMenuListItem(e.Items[s],t.UniqueId)).find(".e-fieldmenuListIcon"),l.isNullOrUndefined(e.Items[s].Icon)?(t.SummaryType===e.Items[s].Name||t.FieldType===FieldType.Dimensions&&t.DateTimeFormat===e.Items[s].Name||t.ShowValueType===e.Items[s].Name)&&(e.Items[s].IsSelected=!0):a.addClass(e.Items[s].Icon).css({"font-size":"12px","margin-left":"5px","margin-top":"1.5px"}),o.append(i);return o},t.prototype.calculateMenuPosition=function(e,t,i){var a=e.height()+3,e=e.width(),o=this.dashboardDesigner.element.find(".bbi-designer-designer-dataassign"),s=o.height(),o=o.offset(),n=window.innerHeight-t.top,r=t.top-o.top,i=i.height()+l.parseInt(i.css("padding-top"),10)+l.parseInt(i.css("padding-bottom"),10)+l.parseInt(i.css("border-top-width"),10)+l.parseInt(i.css("border-bottom-width"),10),d=0;return{left:n<i+a?(d=r<n?n<i?s+o.top-i:t.top:r<i?o.top:t.top-i,t.left-(e+143)):(d=t.top+a,t.left-136),top:d}},e.CreateFieldMenu=t}(BoldBIDashboard=BoldBIDashboard||{}),function(m){var e;function t(e){this.id=null,this.dashboardDesigner=null,this.localizationContent=null,this.selectedFieldName=null,this.value=null,this.columnDetails=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.localizationContent=this.dashboardDesigner.getLocalizationContent(),this.dataconfiguration=new m.DashboardDesignerUtility.DataConfiguration(this.dashboardDesigner)}e=m.Dashboard||(m.Dashboard={}),t.prototype.onSettingsClick=function(e,t){var i,a=m.isNullOrUndefined(e.ChildHierarchicalFields)?this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId):this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId),o=a.data("BoldBIDashboardMenu"),s=this.getMenuJson(a,[],e),n=m.isNullOrUndefined(e.ChildHierarchicalFields)?"_categoryListSettingsIcon_":"_categoryListSettingsIconHierarchy_";this.id+"_"+e.Id+n+e.UniqueId===t.target.id&&(a.is(":visible")?o.hide():0<a.children().length&&(i=this.dashboardDesigner.designerPanel.selectedReportItems[0],s=m.Dashboard.WidgetHelper.getWidgetInstance(i).onFieldSettingsClick(e,s),this.updateMenuJsonIntoMenu(s,o,e),i=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+n+e.UniqueId),s=new m.Dashboard.CreateFieldMenu(this.dashboardDesigner).calculateMenuPosition(i,i.offset(),a),o.show(s.left,s.top,this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListDiv_"+e.UniqueId),t)))},t.prototype.updateMenuJsonIntoMenu=function(e,t,i){for(var a=0;a<e.length;a++){var o=e[a],s=this.id+"_"+o.Name+"_"+i.UniqueId,n=this.bbdesigner$("#"+s);o.IsVisible=this.updateMenuVisibilityForFilterColumn(o,i),0<n.length&&(this.updateMenuSelection(o,n,i),this.hideOrShowMenuItem(o,s,t),this.disableOrEnableMenuItem(o,s,t),this.enableOrDisableSeperator(o,n)),0<o.Items.length&&this.updateMenuJsonIntoMenu(o.Items,t,i)}},t.prototype.updateMenuVisibilityForFilterColumn=function(e,t){return t.IsFilterColumn?"Sort"!==e.Name&&"RelativeDateOptions"!==e.Name&&("DimensionFilters"===e.Name||"RelativeDateFilter"===e.Name||e.IsVisible):e.IsVisible},t.prototype.hideOrShowMenuItem=function(e,t,i){e.IsVisible?i.enableItemByID(t):i.hideItems(["#"+t])},t.prototype.disableOrEnableMenuItem=function(e,t,i){e.IsDisable?i.disableItemByID(t):i.enableItemByID(t)},t.prototype.enableOrDisableSeperator=function(e,t){e.EnableSeparator?t.addClass("e-separator"):t.removeClass("e-separator")},t.prototype.updateMenuSelection=function(e,t,i){var a;m.isNullOrUndefined(e.Icon)&&e.IsSelected?((a=t.find(">.e-fieldmenuListName>.e-fieldmenuListIcon")).addClass("e-dashboardtick-icon e-selectedfieldmenu"),"DimensionFilters"!==e.Name||m.isNullOrUndefined(i.FilterInfo)||m.isNullOrUndefined(i.FilterInfo.DimensionFilterInfo)?"RelativeDateFilter"!==e.Name||m.isNullOrUndefined(i.FilterInfo)||m.isNullOrUndefined(i.FilterInfo.RelativeDateFilterInfo)?m.isNullOrUndefined(ShowValueType[e.Name])?"MeasureFormat"!==e.Name&&"MeasureFilter"!==e.Name&&"RelativeDateOptions"!==e.Name&&"RelativeDateFilter"!==e.Name&&"DimensionFilters"!==e.Name&&a.addClass("e-summaryselectedfieldmenu"):a.addClass("e-showvaluefieldmenu"):a.addClass("e-relativefiltermenu"):a.addClass("e-filtermenu")):(a=t.find(">.e-fieldmenuListName>.e-fieldmenuListIcon")).removeClass("e-dashboardtick-icon e-selectedfieldmenu e-relativefiltermenu e-filtermenu e-summaryselectedfieldmenu e-showvaluefieldmenu")},t.prototype.getPropertyChangedMenuItems=function(e,t,i,a){var o,s=this.getPropertyMenuList(e,t,i);for(0<s.length&&a.push(s[0]),o=void 0;o<e.length;o++)0<e[o].Items.length&&this.getPropertyChangedMenuItems(e[o].Items,t,i,a);return a},t.prototype.getPropertyMenuList=function(e,t,i){var a=[];switch(t){case"Visiblity":a=e.filter(function(e){return e.IsVisible===i});break;case"Selection":a=e.filter(function(e){return e.IsSelected===i});break;case"Disable":a=e.filter(function(e){return e.IsDisable===i});break;case"Separator":a=e.filter(function(e){return e.EnableSeparator===i})}return a},t.prototype.getMenuJson=function(e,t,i){var a,o,s,n;if(!m.isNullOrUndefined(e)&&0<e.length)for(a=e.find(">.e-list"),o=0;o<a.length;o++)n=(s=this.bbdesigner$(a[o])).data("menuitem-info"),n=m.isNullOrUndefined(i.DateBucketInfo)||m.isNullOrUndefined(i.DateBucketInfo.DatebucketId)||m.DashboardUtil.IsStringNullorWhiteSpace(i.DateBucketInfo.DatebucketId)?this.updateFilterItemSelection(i,n):this.updateDateBucketFilterSelection(i.DateBucketInfo.DatebucketId,i.DateTimeFormat.toString(),n),(n=this.updateEnableOrDisableForFirstLastOption(n,i)).Items=this.getMenuJson(s.find(">ul"),[],i),t.push(n);return t},t.prototype.updateEnableOrDisableForFirstLastOption=function(e,t){var i,a,t=this.getCurrentFieldFilterInfo(t.UniqueId,t.ContainerName);if("First"===e.Name||"Last"===e.Name)for(i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,a=0;a<i.FieldContainers.length;a++)i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.values&&i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.value&&i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.locationValue||(e.IsDisable=0===i.FieldContainers[a].FieldInfos.length);else"MeasureFormat"===e.Name&&(e.IsDisable=!(m.isNullOrUndefined(t)||m.isNullOrUndefined(t.DimensionFilterInfo)||m.isNullOrUndefined(t.DimensionFilterInfo.TopNFilterInfo)));return e},t.prototype.updateFilterItemSelection=function(e,t){var i,a=this.getCurrentFieldFilterInfo(e.UniqueId,e.ContainerName);return m.isNullOrUndefined(a)&&this.validateSubFilterInfo(t.Name)?t.IsDisable=!0:m.isNullOrUndefined(a)&&t.IsSelected?"RelativeDateFilter"!==t.Name&&"DimensionFilters"!==t.Name&&"RelativeDateOptions"!==t.Name&&"MeasureFilter"!==t.Name&&"Settings"!==t.Name&&"InjectParameters"!==t.Name||(t.IsSelected=!1):m.isNullOrUndefined(a)||("DimensionFilters"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.DimensionFilterInfo):"MeasureFilter"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.MeasureFilterInfo):"RelativeDateFilter"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.RelativeDateFilterInfo):"RelativeDateOptions"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.RelativeDateOptions):"Settings"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.CustomDateSettingsInfo):"First"!==t.Name||"Tooltip"!==e.ContainerName||m.isNullOrUndefined(a.DimensionFilterInfo)||m.isNullOrUndefined(a.DimensionFilterInfo.TopNFilterInfo)?"Last"!==t.Name||"Tooltip"!==e.ContainerName||m.isNullOrUndefined(a.DimensionFilterInfo)||m.isNullOrUndefined(a.DimensionFilterInfo.TopNFilterInfo)||(t.IsSelected=a.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Bottom):t.IsSelected=a.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Top,i=this.validateSubFilterInfo(t.Name),m.isNullOrUndefined(a.MeasureFilterInfo)&&"ClearMeasureFilter"===t.Name||m.isNullOrUndefined(a.DimensionFilterInfo)&&"ClearDimensionFilter"===t.Name||m.isNullOrUndefined(a.RelativeDateFilterInfo)&&"ClearRelativeDate"===t.Name||m.isNullOrUndefined(a.RelativeDateOptions)&&"ClearRelativeDateOptions"===t.Name||m.isNullOrUndefined(a.CustomDateSettingsInfo)&&"ClearCustomDateSettings"===t.Name||m.isNullOrUndefined(e.ParametersInWidgets)&&"ClearInjectParameters"===t.Name?t.IsDisable=!0:i&&(t.IsDisable=!1)),"InjectParameters"===t.Name&&(t.IsSelected=!m.isNullOrUndefined(e.ParametersInWidgets)&&0<e.ParametersInWidgets.length),"ClearInjectParameters"===t.Name&&(t.IsDisable=!(!m.isNullOrUndefined(e.ParametersInWidgets)&&0!==e.ParametersInWidgets.length)),t},t.prototype.validateSubFilterInfo=function(e){return"ClearMeasureFilter"===e||"ClearDimensionFilter"===e||"ClearRelativeDateOptions"===e||"ClearRelativeDate"===e||"ClearCustomDateSettings"===e},t.prototype.getCurrentFieldFilterInfo=function(t,i){var e=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.FieldContainers.filter(function(e){return e.Name===i});return 0<e.length&&0<(e=e[0].FieldInfos.filter(function(e){return e.UniqueId===t})).length?e[0].FilterInfo:null},t.prototype.updateDateBucketFilterSelection=function(e,t,i){var a=i.Name.toString().replace(/\s/g,"");switch(this.isDatebucketFieldInfo(i.Name)?this.getDateBucketWidgetID(i.Name):a){case e:i.IsSelected=!0;break;case t:i.IsSelected=!1;break;default:return i}return i},t.prototype.getDateBucketWidgetID=function(e){if(!m.DashboardUtil.IsStringNullorWhiteSpace(e))return e.split("DateBucket_")[1]},t.prototype.getFieldMenuName=function(e,t){for(var i,a=e.Name.replace(/\s/g,""),o=DateTimeFormat[a]||DateTimeFormatForFilter[a],s=this.dashboardDesigner.modules.widgetHelper.getAllDatebucketWidgets(),n=0;n<s.length;n++)if(m.isNullOrUndefined(o)&&this.isDatebucketFieldInfo(a)){if(s[n].isDefaultDataWidget()&&s[n].getContainerSettings().Title===e.DisplayName)return a=s[n].getJson().selectedValue.replace(/\s/g,""),m.isNullOrUndefined(t.DateBucketInfo)&&(t.DateBucketInfo=new DateBucketInformation),t.DateBucketInfo.DatebucketId="",i=e.Name.split("DateBucket_")[1],t.DateBucketInfo.DatebucketId=i,t.DateBucketInfo.DateBucketFormat=DateTimeFormat[a],m.DashboardUtil.invokeMethod(s[n],"updateConfiguredWidgetsInfoList",[t]),a}else this.isDatebucketFieldInfo(a)||m.isNullOrUndefined(t.DateBucketInfo)||(t.DateBucketInfo=null,m.DashboardUtil.invokeMethod(s[n],"removeConfiguredWidgetsInfoList",[t]));return a},t.prototype.isDatebucketFieldInfo=function(e){return-1!==e.indexOf("DateBucket_")},t.prototype.onSettingsMenuItemClick=function(e,t){var i,a,o=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).find(".e-mhover"),s=(o=m.isNullOrUndefined(e.ChildHierarchicalFields)?o:this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId).find(".e-mhover")).closest("li").data("menuitem-info"),n=o.closest("li").data("hierarchy-info"),r=this.getFieldMenuName(s,e),d=0===o.closest("li").children("ul").length;if(this.selectedFieldName=e.DateTimeFormat.toString(),i=this.selectedFieldName,!m.isNullOrUndefined(o)&&r!==this.dashboardDesigner.getLocalizationContent().dataconfiguration.menuItems.more){o=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).data("BoldBIDashboardMenu"),o=m.isNullOrUndefined(e.ChildHierarchicalFields)?o:this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId).data("BoldBIDashboardMenu"),d&&o.hide();var o=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId),l=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,h=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance.dimensionsList,p=this.getCurrentFieldInfoByUniqueName(l,e.UniqueColumnName),c=this.getCurrentDimensionFieldInfoById(h,e.Id);if("Rename"===r&&(d=!1,a=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListEditableTextBox_"+e.UniqueId),this.enableFieldRenameOption(a,o)),"Sort"===r)d=!1,this.sortClick(p,s);else if("CreateHierarchy"===r)d=!1,this.editCreateHierarchyFilterClick(c,h,e);else if("Remove"===r)d=!1,this.editRemoveCustomHierarchy(e);else if("AddToHierarchy"===r){if(!m.isNullOrUndefined(e)&&!m.isNullOrUndefined(n)&&e.Id===n.Id)return;d=!1,this.editAddToHierarchyFilterClick(c,h,n)}else"EditDimensionFilter"===r?(d=!1,this.editDimensionFilterClick(p)):"EditMeasureFilter"===r?(d=!1,this.editMeasureFilterClick(p)):"ClearMeasureFilter"===r?this.clearMeasureFilterClick(p):"ClearDimensionFilter"===r||"ClearRelativeDate"===r?this.clearDimensionOrClearRelativeDateClick(p,s):"MeasureFormat"===r?(d=!1,this.measureFormatClick(p)):"EditSettings"===r?(d=!1,this.customDateDialog(p,i)):"EditRelativeDate"===r?(d=!1,this.editRelativeDateClick(p,s)):"EditRelativeDateOptions"===r?(d=!1,("ListBox"===this.widgetHelper.getCurrentWidgetInstance().Type||"ComboBox"===this.widgetHelper.getCurrentWidgetInstance().Type)&&!m.isNullOrUndefined(l.FieldContainers[1].FieldInfos)&&0<l.FieldContainers[1].FieldInfos.length?this.dashboardDesigner.modules.util.alertDialog(this.localizationContent.alertDialogTitle.relativeDatesAlert,this.localizationContent.relativeDateMessages.displayColumnBinded,IconType.warning,AlertType.Alert,!1,""):this.editRelativeDateOptionsClick(p)):"ClearRelativeDateOptions"===r?(d=!1,this.clearRelativeDateOptionsClick(p,s)):"EditInjectParameters"===r?(d=!1,this.editInjectionParameterOptionsClick(p)):"ClearInjectParameters"===r?(d=!1,this.clearParametersInjectionOptionsClick(p,s)):"First"===r?(this.updateFirstAndLastFilterInfo(p,!(d=!1)),this.updateLabelText(p,s)):"Last"===r?(this.updateFirstAndLastFilterInfo(p,d=!1),this.updateLabelText(p,s)):m.isNullOrUndefined(SummaryType[s.Name])?m.isNullOrUndefined(ShowValueType[s.Name])?"MeasureFormat"!==r&&"MeasureFilter"!==r&&"RelativeDateOptions"!==r&&"RelativeDateFilter"!==r&&"InjectParameters"!==r&&"DimensionFilters"!==r&&"MeasureFormat"!==r&&"Rename"!==r&&t.text!==m.DashboardDesignerUtility.Serialization.enumToString(DateTimeFormat,p.DateTimeFormat)&&(p.IsShowAllRecords=!0,p.FilterInfo=null,s.IsSelected=!0,this.removeMenuSelection(p),this.widgetHelper.getCurrentWidgetInstance().clearFilter(),a=this.isDatebucketFieldInfo(s.Name.replace(/\s/g,"")),m.isNullOrUndefined(ShowDimensionValue[s.Name])||(p.ShowDimensionAs=e.ShowDimensionAs=s.IsSelected?s.Name:"none"),m.isNullOrUndefined(DateTimeFormat[r])||a||(p.DateTimeFormat=e.DateTimeFormat=DateTimeFormat[r]),a?d=!1:(c=t.text===this.dashboardDesigner.getLocalizationContent().dataconfiguration.summary.none?p.Name:r+"("+p.Name+")",p.IsDisplayNameEdited||(p.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(p),o.text(p.DisplayName)),o.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",c))):(this.removeSelectedShowValueType(p),s.IsSelected=!0,p.ShowValueType=s.Name,this.updateMeasureFormatForShowValueType(p)):("Tooltip"!==e.ContainerName||m.isNullOrUndefined(p.FilterInfo)||(p.FilterInfo=null),this.removeMenuSelection(p),s.IsSelected=!0,p.SummaryType=s.Name,h=this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(p.SummaryType)+"("+p.Name+")",p.IsDisplayNameEdited||(p.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(p),o.text(p.DisplayName)),o.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",h));n={update:!0,columnUpdate:!1,rowUpdate:!1,valueUpdate:!1},this.widgetHelper.getCurrentWidgetInstance().updateDataGroupInfo(l,n),d&&this.getDataConfigInstance().postDraggedFields()}},t.prototype.removeSelectedShowValueType=function(e){e=this.bbdesigner$("#"+this.id+"_"+e.ShowValueType+"_"+e.UniqueId).find(".e-showvaluefieldmenu").closest("li.e-list").data("menuitem-info");m.isNullOrUndefined(e)||m.isNullOrUndefined(ShowValueType[e.Name])||(e.IsSelected=!1)},t.prototype.updateMeasureFormatForShowValueType=function(e){e.ShowValueType===ShowValueType.NoCalculation?(e.MeasureFormatting=new MeasureFormatting,e.MeasureFormatting.Unit=NumberFormat.Ones):m.isNullOrUndefined(e.MeasureFormatting)||e.MeasureFormatting.FormatType===DataValueFormat.Percentage||(e.MeasureFormatting=new MeasureFormatting,e.MeasureFormatting.FormatType=DataValueFormat.Percentage,e.MeasureFormatting.Unit=NumberFormat.Ones)},t.prototype.updateLabelText=function(e,t){this.removeMenuSelection(e);var i=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId);t.IsSelected=!0,e.IsDisplayNameEdited||(e.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(e),i.text(e.DisplayName)),i.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",e.DisplayName)},t.prototype.updateFirstAndLastFilterInfo=function(e,t){var i,a,o,s;if(e.IsAggregatedExpression)return this.dashboardDesigner.modules.util.alertDialog(this.localizationContent.alertDialogTitle.firstAndLast,this.localizationContent.alertWindowMesages.firstAndLastMessage,IconType.warning,AlertType.Alert,!1,"");for(i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=0;o<i.FieldContainers.length;o++)i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.values&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.measure&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.value&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.locationValue&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.xAxis&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.actualValue||(a=i.FieldContainers[o].FieldInfos[0]);(s=new DimensionFilterInfo).IsTopNFilteringApplied=!0,s.TopNFilterInfo=new TopNFilteringInfo,s.TopNFilterInfo.ColumnId=a.Id,s.TopNFilterInfo.ColumnName=a.Name,s.TopNFilterInfo.Mode=t?RankType.Top:RankType.Bottom,s.TopNFilterInfo.IsBasedOnDateAndTimeField=!1,s.TopNFilterInfo.NoOfRecords=1,t=this.widgetHelper.getCurrentWidgetInstance().getJson().FilterSettings,s.TopNFilterInfo.IsHierarchicalFilter=!!m.isNullOrUndefined(t)||t.HierarchicalFilter,s.TopNFilterInfo.SummaryType=a.SummaryType,t=[s,e],e.DisplayName=e.Name,e.SummaryType=SummaryType.NONE,m.DashboardUtil.invokeMethod(this,"dimensionFilterAction",t)},t.prototype.enableFieldRenameOption=function(e,t){e.val(t.text()),e.addClass("show-fieldInfo-textbox"),t.addClass("hide-fieldInfo-label"),e.focus()},t.prototype.removeMenuSelection=function(e){e=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).find(".e-summaryselectedfieldmenu").parents("li.e-list").data("menuitem-info");m.isNullOrUndefined(e)||(e.IsSelected=!1)},t.prototype.createCustomSorting=function(){return new m.Dashboard.CustomSortForUI},t.prototype.sortClick=function(e,t){var i,e=JSON.parse(JSON.stringify(e)),a=this.dashboardDesigner.modules.sortDialog;m.isNullOrUndefined(e.CustomSorting)&&(e.CustomSorting=this.createCustomSorting(),e.CustomSorting.CustomSortType="row"===e.ContainerName.toLowerCase()&&e.Sorting===SortingOrder.None?CustomSortType[CustomSortType.DataSource]:e.CustomSorting.CustomSortType),i=this.widgetHelper.getCurrentWidgetInstance(),a.openSortDialog(this,"updateSortInfo",e,t,i.Type)},t.prototype.editRemoveCustomHierarchy=function(e){this.dashboardDesigner.modules.util.alertDialog(this.dashboardDesigner.getLocalizationContent().customHierarchy.titleText,this.dashboardDesigner.getLocalizationContent().customHierarchy.dialogContentText,IconType.question,AlertType.Confirm,!1,"",{height:140,width:500,method:"alertBoxtoRemoveHierarchy",dataInfo:{fieldInfo:e},instance:this.dataconfiguration})},t.prototype.editCreateHierarchyFilterClick=function(e,t,i){var a,o,s,n=0,r=0,d=this.dashboardDesigner.modules.dataSet.datasets,l=(m.isNullOrUndefined(e.ParentId)||delete e.ParentId,(a=JSON.parse(JSON.stringify(e))).Name=a.Name+" Hierarchy",a.ChildHierarchicalFields=[],a.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(e))),this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+e.ContainerName+"_categoryList")),h=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,p=h.selectedDatasetId,c=d.findIndex(function(e){return e.Id===p}),h=this.dataconfiguration.createLabelForHeirachialDroppedField(a,!0,h,!0);for(d[c].CustomHierarchyFields.push(a),d=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller"),c=h.find(".e-heirachy-field").data("fields"),o=0;o<t.length;o++)if(e.Id===t[o].Id){n=o+1;break}for(s=0;s<l[0].children.length;s++)this.dashboardDesigner._id+"_"+i.Id+"_categoryListDiv"===l[0].children[s].id&&(r=s+1);!m.isNullOrUndefined(l)&&0<l.length&&(-1<r&&0<l.children().length&&r<l.children().length?h.insertBefore(l.children().eq(r)):h.insertBefore(l.children().last())),this.dataconfiguration.setParentId(c),c.forEach(function(e){t.splice(n,0,e),n++}),m.isNullOrUndefined(d)||d.refresh()},t.prototype.editAddToHierarchyFilterClick=function(t,i,a){m.isNullOrUndefined(t.ChildHierarchicalFields)||delete t.ChildHierarchicalFields;for(var e,o,s,n=0,r=0,d=!1,l=this.dashboardDesigner.modules.dataSet.datasets,h=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+t.ContainerName+"_categoryList"),p=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,c=p.selectedDatasetId,u=l.findIndex(function(e){return e.Id===c}),b=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller"),g=0;g<i.length;g++)i[g].Id===a.Id&&!m.isNullOrUndefined(i[g].HasChild)&&i[g].HasChild&&(s=JSON.parse(JSON.stringify(i[g])),m.isNullOrUndefined(s.ChildHierarchicalFields)||delete s.ChildHierarchicalFields,n=g),(i[g].Id===a.Id&&"hierarchy"===i[g].TreeNode||!m.isNullOrUndefined(i[g].ParentId)&&i[g].ParentId===a.Id)&&(i.splice(g,1),g-=1);if(e=l[u].CustomHierarchyFields.find(function(e){return e.Id===a.Id}),e=m.isNullOrUndefined(e)?a:e,s.ChildHierarchicalFields=[],e.ChildHierarchicalFields.forEach(function(e){s.ChildHierarchicalFields.push(e),e.Id===t.Id&&(d=!0)}),s.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),!d){for(m.isNullOrUndefined(l[u].CustomHierarchyFields[l[u].CustomHierarchyFields.indexOf(e)])||this.dashboardDesigner.modules.dataSet.datasets[u].CustomHierarchyFields[l[u].CustomHierarchyFields.indexOf(e)].ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),l=this.dataconfiguration.createLabelForHeirachialDroppedField(s,!0,p,!0),u=h.children().length,h.children().remove("#"+this.dashboardDesigner._id+"_Dimension_categoryList_treeview_"+a.Id),u===h.children().length&&h.children().remove("#"+this.dashboardDesigner._id+"_"+a.Id+"_categoryListParentDiv_"+a.UniqueId),e=l.find(".e-heirachy-field").data("fields"),o=0;o<h[0].children.length;o++)this.dashboardDesigner._id+"_"+a.Id+"_categoryListDiv"===h[0].children[o].id&&(r=o+1);!m.isNullOrUndefined(h)&&0<h.length&&(-1<r&&0<h.children().length&&r<h.children().length?l.insertBefore(h.children().eq(r)):l.insertBefore(h.children().last())),this.dataconfiguration.setParentId(e),e.forEach(function(e){i.splice(n,0,e),n++}),m.isNullOrUndefined(b)||b.refresh()}},t.prototype.editDimensionFilterClick=function(e){var e=JSON.parse(JSON.stringify(e)),t=m.isNullOrUndefined(e)||m.isNullOrUndefined(e.FilterInfo)?null:e.FilterInfo.DimensionFilterInfo,i=this.widgetHelper.getCurrentWidgetInstance();"DatePicker"===i.Type||"PeriodOverPeriod"===i.Type?this.dashboardDesigner.modules.rangeFilterDialog.openFilterDialog(this,"dimensionFilterAction",e,t):this.dashboardDesigner.modules.dimensionFilter.openDimensionFilterWindow(this,"dimensionFilterAction",e,t,i)},t.prototype.customDateDialog=function(e,t){var e=JSON.parse(JSON.stringify(e)),i=null==e.FilterInfo||m.isNullOrUndefined(e.FilterInfo.CustomDateSettingsInfo)?new m.Dashboard.DatesettingInfoForUI:e.FilterInfo.CustomDateSettingsInfo,a=this.dashboardDesigner.modules.dateinfo;i.UniqueColumnName=e.UniqueColumnName,a.selectedFieldName=t,a.openDatesettingClick(this,"dateSettingsAction",e,i)},t.prototype.editMeasureFilterClick=function(e){var e=JSON.parse(JSON.stringify(e)),t=null==e.FilterInfo||m.isNullOrUndefined(e.FilterInfo.MeasureFilterInfo)?new m.Dashboard.MeasureFilterInfoForUI:e.FilterInfo.MeasureFilterInfo;t.UniqueColumnName=e.UniqueColumnName,this.dashboardDesigner.modules.measureFilter.openMeasureFilter(this,"measureFilterAction",e,t,!1)},t.prototype.clearMeasureFilterClick=function(e){e.FilterInfo=null,e.IsShowAllRecords=!0},t.prototype.clearDimensionOrClearRelativeDateClick=function(e,t){e.FilterInfo.DimensionFilterInfo=null,m.isNullOrUndefined(e.FilterInfo.RelativeDateFilterInfo)||(e.FilterInfo.RelativeDateFilterInfo=null),e.IsShowAllRecords=!0,t.IsDisable=!0,this.widgetHelper.getCurrentWidgetInstance().clearFilter()},t.prototype.measureFormatClick=function(t){var i=this,e=m.isNullOrUndefined(t.MeasureFormatting)?new MeasureFormatting:JSON.parse(JSON.stringify(t.MeasureFormatting));this.dashboardDesigner.modules.formatDialog.openFormatDialog(e,this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.DataSourceName,function(e){t.MeasureFormatting=e,i.getDataConfigInstance().postDraggedFields()},!1,!1,t)},t.prototype.editRelativeDateClick=function(e,t){var e=JSON.parse(JSON.stringify(e)),i=null;m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateFilterInfo)?((i=new RelativeDateFilterInfo).ColumnId=e.Id,i.ColumnName=e.Name):i=e.FilterInfo.RelativeDateFilterInfo,i.UniqueColumnName=e.UniqueColumnName,this.dashboardDesigner.modules.relativeDateFilter.openRelativeDateFilter(this,"relativeDateFilterAction",i,e,t)},t.prototype.editRelativeDateOptionsClick=function(e){this.columnDetails=e;e=m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateOptions)?[]:e.FilterInfo.RelativeDateOptions,e=this.bbdesigner$.extend([],!0,e);this.dashboardDesigner.modules.relativeDates.openRelativeDatesDialog(this,"relativeDateOptionsAction",e)},t.prototype.editInjectionParameterOptionsClick=function(e){this.columnDetails=e;e=m.isNullOrUndefined(e.ParametersInWidgets)?[]:e.ParametersInWidgets,e=this.bbdesigner$.extend([],!0,e);this.dashboardDesigner.modules.parametersInWidget.openParametersInjectionDialog(this,"relativeParametersOptionsAction",e)},t.prototype.clearRelativeDateOptionsClick=function(e,t){m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateOptions)||(e.FilterInfo.RelativeDateOptions=null,t.IsDisable=!0,(t=this.widgetHelper.getCurrentWidgetInstance()).clearFilter(),"ComboBox"!==t.Type&&"ListBox"!==t.Type)||(t=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId),e.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(e),t.text(e.DisplayName),t.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",e.DisplayName))},t.prototype.clearParametersInjectionOptionsClick=function(e,t){!m.isNullOrUndefined(e.ParametersInWidgets)&&0<e.ParametersInWidgets.length&&(e.ParametersInWidgets=null,t.IsDisable=!0,this.widgetHelper.getCurrentWidgetInstance().clearFilter(),this.getDataConfigInstance().postDraggedFields())},t.prototype.getCurrentFieldInfoByUniqueName=function(e,t){var i,a;if(!m.isNullOrUndefined(e))for(i=0;i<e.FieldContainers.length;i++)if(0<(a=e.FieldContainers[i].FieldInfos.filter(function(e){return e.UniqueColumnName===t})).length)return a[0];return null},t.prototype.getCurrentDimensionFieldInfoById=function(e,t){if(!m.isNullOrUndefined(e)&&!m.isNullOrUndefined(t)){e=e.filter(function(e){return e.Id===t&&m.isNullOrUndefined(e.ParentId)&&m.isNullOrUndefined(e.TreeNode)});if(0<e.length)return e[0]}return null},t.prototype.getDataConfigInstance=function(){return this.dashboardDesigner.modules.dataConfiguration},t.prototype.dimensionFilterAction=function(e,t){for(var i,a,o,s=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,n=0;n<s.FieldContainers.length;n++)for(i=s.FieldContainers[n].FieldInfos,a=0;a<i.length;a++)i[a].UniqueColumnName===t.UniqueColumnName&&(m.isNullOrUndefined(i[a].FilterInfo)?m.isNullOrUndefined(e)?i[a].FilterInfo=null:((o=new m.Dashboard.FilterInfoForUI).DimensionFilterInfo=e,i[a].FilterInfo=o):(i[a].FilterInfo.RelativeDateFilterInfo=null,i[a].FilterInfo.DimensionFilterInfo=e)),t.UniqueId===i[a].UniqueId&&(t.DateTimeFormat=i[a].DateTimeFormat);m.isNullOrUndefined(e)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1),this.getDataConfigInstance().postDraggedFields()},t.prototype.measureFilterAction=function(e){for(var t,i,a=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=new MeasureCondition,s=0;s<e.Values.length;s++)t=e.Values[s],o.Values.push(t);i={MeasureFilterInfo:{ColumnName:e.ColumnName,SummaryType:e.SummaryType,UniqueColumnName:e.UniqueColumnName,Conditions:e.Conditions,Values:o.Values}},this.getCurrentFieldInfoByUniqueName(a,e.UniqueColumnName).FilterInfo=0!==i.MeasureFilterInfo.Values.length?i:null,this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateOptionsAction=function(e){var t,i,a,o,s,n=this.widgetHelper.getCurrentWidgetInstance(),r=n.DataGroupInfo,d={RelativeDateOptions:e};if(1<=r.FieldContainers.length)for(t=0;t<r.FieldContainers.length;t++)for(i=r.FieldContainers[t].FieldInfos,a=0;a<i.length;a++)o=0===d.RelativeDateOptions.length?null:1<=d.RelativeDateOptions.length&&i[a].UniqueColumnName?d:i[a].FilterInfo,"ComboBox"===n.Type||"ListBox"===n.Type?this.columnDetails.UniqueColumnName===i[a].UniqueColumnName&&(i[a].FilterInfo=o,s=this.dashboardDesigner.element.find("#"+this.id+"_"+i[a].Id+"_categoryListLabel_"+i[a].UniqueId),i[a].DisplayName="Relative Dates("+i[a].Name+")",s.text(i[a].DisplayName),s.parents(".bbi-assigndata-dropped-field").attr("data-tooltip","Relative Dates("+i[a].Name+")")):i[a].FilterInfo=o;this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeParametersOptionsAction=function(e){var t,i,a,o=this.widgetHelper.getCurrentWidgetInstance(),s=o.DataGroupInfo;if(1<=s.FieldContainers.length)for(t=0;t<s.FieldContainers.length;t++)for(i=s.FieldContainers[t].FieldInfos,a=0;a<i.length;a++)this.columnDetails.UniqueColumnName===i[a].UniqueColumnName&&(m.Dashboard.WidgetHelper.clearFilterSelectionOnParamInjectionChange(e,o),i[a].ParametersInWidgets=e);this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateFilterAction=function(e,t){var i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo;1<=i.FieldContainers.length&&(i=this.getCurrentFieldInfoByUniqueName(i,t.UniqueColumnName),m.isNullOrUndefined(i.FilterInfo)?((t=new m.Dashboard.FilterInfoForUI).RelativeDateFilterInfo=e,i.FilterInfo=t):(i.FilterInfo.DimensionFilterInfo=null,i.FilterInfo.RelativeDateFilterInfo=e)),m.isNullOrUndefined(e)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1),this.getDataConfigInstance().postDraggedFields()},t.prototype.dateSettingsAction=function(e){var t=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,i={CustomDateSettingsInfo:{Format:e.Format,CustomFormat:e.CustomFormat,FiscalYear:e.FiscalYear,UniqueColumnName:e.UniqueColumnName}};this.getCurrentFieldInfoByUniqueName(t,e.UniqueColumnName).FilterInfo=null!=i.CustomDateSettingsInfo?i:null,this.getDataConfigInstance().postDraggedFields()},t.prototype.updateSortInfo=function(e,t,i){var a,o,s,n,r;if(BoldBIDashboardDesigner.editManager.isPerformAction||(i.IsSelected=!0),0<this.dashboardDesigner.designerPanel.selectedReportItems.length)for(a=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=0;o<a.FieldContainers.length;o++)if(t.ContainerName===a.FieldContainers[o].Name)for(s=0;s<a.FieldContainers[o].FieldInfos.length;s++)n=a.FieldContainers[o].FieldInfos[s],m.isNullOrUndefined(n.UniqueId)&&(n.UniqueId="LabelData"+(s+1)),n.UniqueId===t.UniqueId&&(r=[n.CustomSorting,t,i],BoldBIDashboardDesigner.editManager.addCmdAction(CommandAction.UpdateSort,"updateSortInfo","DataConfiguration","",r,[e,t,i]),n.CustomSorting=e,n.IsCustomSortApplied=t.IsCustomSortApplied);this.getDataConfigInstance().postDraggedFields()},e.FieldMenuHandler=t}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t;function i(){var e=t.call(this)||this;return e.ManualOrderList=[],e}e=e.Dashboard||(e.Dashboard={}),t=Customsort,__extends(i,t),e.CustomSortForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t;function i(){var e=t.call(this)||this;return e.FieldInfos=[],e.canUseInLinking=!0,e.IsDrillSection=!1,e.RestrictLargeData=!1,e.Required=!1,e.ShowDescriptionIcon=!1,e.TooltipText="",e.isCustomHierarchy=!1,e.HasCustomDate=!1,e}e=e.Dashboard||(e.Dashboard={}),t=FieldContainer,__extends(i,t),e.FieldContainerForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t;function i(){var e=t.call(this)||this;return e.IsLoading=!1,e.ApplyFilter=!1,e.IsShowAllRecords=!1,e.TableID="",e.TableName="",e.FilterInfo=null,e.ContainerName="",e.IsCustomSortApplied=!1,e.DateBucketInfo=null,e}e=e.Dashboard||(e.Dashboard={}),t=HierarchicalFieldInfo,__extends(i,t),e.FieldInfoForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),function(e){(e.Dashboard||(e.Dashboard={})).FieldMenu=function(){this.Name="",this.DisplayName="",this.IsDisable=!1,this.IsSelected=!1,this.IsVisible=!0,this.Items=[],this.EnableSeparator=!1}}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t;function i(){var e=t.call(this)||this;return e.UniqueColumnName="",e}e=e.Dashboard||(e.Dashboard={}),t=MeasureFilterInfo,__extends(i,t),e.MeasureFilterInfoForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t;function i(){var e=t.call(this)||this;return e.UniqueColumnName="",e}e=e.Dashboard||(e.Dashboard={}),t=DateSettingsInfo,__extends(i,t),e.DatesettingInfoForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),InternalColorPalette=function(){function e(e){this.callMethod="",this.colorCodes=[],this.isScroll=!1,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.id=this.dashboardDesigner._id,this.unwireEvents(),this.wireEvents()}return e.prototype.openColorPalette=function(e,t,i,a,o,s){this.callInstance=a,this.callMethod=o,BoldBIDashboard.isNullOrUndefined(e)?(this.bbdesigner$(this.container).empty(),this.bbdesigner$(this.rootContainer).css("display",BoldBIDashboard.isNullOrUndefined(i.isVisible)?0<s.length?"inline-block":"none":i.isVisible?"inline-block":"none")):(this.rootContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control e-color-palette-container bbi-dbrd-designer-scroll-style-3","",{display:BoldBIDashboard.isNullOrUndefined(i.isVisible)?0<s.length?"inline-block":"none":i.isVisible?"inline-block":"none"},{id:this.id+"_"+t+"_"+i.name+"_container"}),this.container=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_"+t+"_"+i.name+"_childContainer"}),e.css({"margin-bottom":"10px"}),this.rootContainer.append(this.container),e.append(this.rootContainer),this.rootContainer.BoldBIDashboardScroller({width:430,height:280,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})),this.colorCodes=s,a=280,BoldBIDashboard.isNullOrUndefined(this.container)||(this.renderColorPalettes(),this.colorCodes.length<5&&(a=a/5*this.colorCodes.length+5)),BoldBIDashboard.isNullOrUndefined(this.rootContainer)||(o=this.rootContainer.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(o)||o.destroy(),10<this.colorCodes.length?this.rootContainer.BoldBIDashboardScroller({width:430,height:a,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,enableTouchScroll:!1,scroll:this.bbdesigner$.proxy(this.resetScroller,this)}):this.rootContainer.BoldBIDashboardScroller({width:430,height:a,autoHide:!0,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,enableTouchScroll:!1}))},e.prototype.resetScroller=function(e){var t,e=e.scrollTop;!BoldBIDashboard.isNullOrUndefined(e)&&0<e&&!this.isScroll&&(t=this.container.find(".e-scrollcontainer")).children().length<this.colorCodes.length&&t.height()-this.container.height()<=e&&(this.isScroll=!0,this.renderColorPalettes(),t=this.rootContainer.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(t)||t.refresh(),this.isScroll=!1)},e.prototype.renderColorPalettes=function(){var e,t,i,a,o=this.container.find(".e-scrollcontainer");for(0===o.length?(e=BoldBIDashboard.buildTag("div.e-scrollcontainer","",{},{}),this.container.append(e)):e=o,i=(t=o.children().length)+10<this.colorCodes.length?10:this.colorCodes.length-t,a=t;a<t+i;a++)e.append(this.getSeriesPaletteTemplate(this.colorCodes[a],a)),this.updateColorPicker(this.colorCodes[a],a)},e.prototype.updateColorPicker=function(e,t){this.container.find("#"+this.id+"_seriespalette__LabelValue"+t+"_colorpicker").BoldBIDashboardColorPicker({value:e.Value,cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label",select:this.bbdesigner$.proxy(this.onValueChange,this,t),width:"35px",height:"26px",modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},e.prototype.getSeriesPaletteTemplate=function(e,t){return'<div style="width : 100%" id ="'+this.id+"_seriespalette__Container"+t+'"><div class="e-color-palette-row" id="'+this.id+"_seriespalette__Label"+t+'"><div class ="e-color-palette-label-wrap"><div class = "e-designer-fontfamily e-color-palette-label bbi-dbrd-designer-hoverable" data-tooltip ="'+e.Name+'">'+e.Name+'</div></div><div class = "e-color-palette-color-picker-wrap" id = "'+this.id+"_seriespalette__LabelValue"+t+'_parent"><input class="boldbi-dashboarddesigner e-color-palette-input" id ="'+this.id+"_seriespalette__LabelValue"+t+'_colorpicker" ></div><div class = "e-color-palette-color-textbox-wrap" id ="'+this.id+"_seriespalette__LabelValue"+t+'_value"><input class ="e-textbox bbi-designer-content-label e-color-picker-color-textbox" id ="'+this.id+"_seriespalette__LabelValue"+t+'" type ="text" data-rowIndex = "'+t+'" value ="'+e.Value+'"></div></div></div>'},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("focusout",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textFocusOut,this)),this.dashboardDesigner.element.on("keyup",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textKeyUp,this))},e.prototype.unwireEvents=function(){this.dashboardDesigner.element.off("focusout",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textFocusOut,this)),this.dashboardDesigner.element.off("keyup",".e-color-picker-color-textbox",this.bbdesigner$.proxy(this.textKeyUp,this))},e.prototype.onValueChange=function(e,t){var t=this.colorCodes[e].Value=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA);this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+e).val(t),t={rowIndex:e,textValue:t,isModified:this.colorCodes[e].IsModifed,id:this.colorCodes[e].Id},BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[t])},e.prototype.textKeyUp=function(e){13===e.keyCode&&this.textFocusOut(e)},e.prototype.textFocusOut=function(e){var e=Number(this.bbdesigner$(e.target).attr("data-rowIndex")),t=this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+e).val();new RegExp("^#+([a-fA-F0-9]{6}|[a-fA-F0-9]{3})$").test(t)?(this.colorCodes[e].Value=t,this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+e+"_colorpicker").data("BoldBIDashboardColorPicker").setModel({value:this.colorCodes[e].Value}),t={rowIndex:e,textValue:t,isModified:this.colorCodes[e].IsModifed,id:this.colorCodes[e].Id},BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[t])):this.rootContainer.find("#"+this.id+"_seriespalette__LabelValue"+e).val(this.colorCodes[e].Value)},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorPalette",InternalColorPalette,window),InternalMeasureFilter=function(){function e(e){this.filterDialog=null,this.columnNameTag=null,this.measureFilterInfo=null,this.rightTextBoxDiv=null,this.measureItemTable=null,this.textDiv=null,this.targetMethod=null,this.targetInstance=null,this.applyButton=null,this.resetButton=null,this.columnName=null,this.uniqueColumnName=null,this.isKpiFilter=!1,this.errorMsgCell=null,this.dashboardDesigner=null,this.measureItemDropObj=null,this.aggItemDropObj=null,this.fieldSummary=SummaryType.NONE,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.renderMeasureFilterDialog(),this.unWireEvents(),this.wireEvents()}return e.prototype.renderMeasureFilterDialog=function(){var e,t,i=this.locale.measureFilterWindow,a=(this.filterDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_measure_filter"}),BoldBIDashboard.buildTag("div","",{})),o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-measure-filter-table-item","",{width:"100%",padding:"5px 0px 10px"},{}),s=this.bbdesigner$("<tr></tr>"),n=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{width:"50px"},{}),r=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",i.columnLabelText+":",{"font-size":"12px","font-weight":"600"},{type:"label"}),d=BoldBIDashboard.buildTag("td","",{},{}),l=this.columnNameTag=BoldBIDashboard.buildTag("span.bbi-designer-fontfamily","",{"font-size":"12px"},{id:this.id+"_measure_filter_columnName"}),l=(d.append(l),n.append(r),s.append(n).append(d),o.append(s),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{})),r=BoldBIDashboard.buildTag("tr","",{}),n=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{}),d=BoldBIDashboard.buildTag("aggregateLabel.bbi-designer-fontfamily bbi-measure-filter-aggregation-label",i.selectedAggText,{},{type:"label"}),s=(n.append(d),r.append(n),l.append(r),BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-measure-filter-table-item","",{},{})),d=BoldBIDashboard.buildTag("tr","",{}),n=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_aggregate_dropDown"}),n=(n.append(r),d.append(n),s.append(d),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%"},{})),d=BoldBIDashboard.buildTag("tr","",{}),h=BoldBIDashboard.buildTag("td.bbi-measure-filter-table-data","",{}),p=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",i.rangeLabelText,{"font-size":"12px","font-weight":"600"},{type:"label"}),h=(h.append(p),d.append(h),p=this.errorMsgCell=BoldBIDashboard.buildTag("td","",{"padding-top":"10px"},{id:this.id+"_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(p,this.id),d.append(p),n.append(d),this.measureItemTable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 15px"},{})),p=this.bbdesigner$("<tr></tr>"),d=BoldBIDashboard.buildTag("td","",{},{}),c=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_rangedrop"}),u=(d.append(c),e=BoldBIDashboard.buildTag("td","",{"padding-left":"8px"},{}),t=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_measure_filter_text1"}),e.append(t),BoldBIDashboard.buildTag("td","",{width:"30px"},{})),b=this.textDiv=BoldBIDashboard.buildTag("div","",{padding:"0px 5px",display:"none"}),g=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",i.andLabelText,{"font-size":"12px"},{type:"label"}),m=BoldBIDashboard.buildTag("td","",{width:"90px",height:"28px"},{}),f=this.rightTextBoxDiv=BoldBIDashboard.buildTag("div","",{display:"none"},{id:this.id+"_measure_filter_rightbox_div"}),D=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_measure_filter_text2"});m.append(f),f.append(D),b.append(g),u.append(b),f=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",i.cancelBtnText,{float:"right"},{id:this.id+"_measure_filter_cancel",type:"button"}),this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",i.applyBtnText,{float:"right"},{id:this.id+"_measure_filter_ok",type:"button"}),this.resetButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small",i.resetBtnText,{"margin-left":"2px"},{id:this.id+"_measure_filter_reset",type:"button",disabled:"disabled"}),p.append(d,e,u,m),h.append(p),a.append(o,l,s,n,h),this.filterDialog.append(a),this.dashboardDesigner.element.append(this.filterDialog),this.filterDialog.BoldBIDashboardDialog({title:i.measureFilterTitle,width:"auto",height:"auto",minWidth:240,minHeight:150,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.dashboardDesigner.element.find("#"+this.id+"_measure_filter_foot").append(this.resetButton,f,this.applyButton),c.BoldBIDashboardDropDownList({width:"170px",height:"28px",dataSource:this.measureItemList(),fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,popupWidth:"170px",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeMeasureItem,this)}),r.BoldBIDashboardDropDownList({width:"170px",height:"28px",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,popupWidth:"170px",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeAggregateItem,this)}),t.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,width:"90px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-content-label",create:this.bbdesigner$.proxy(this.onTextBoxCreate,this,t),change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,t)}),D.ejNumericTextbox({showSpinButton:!1,decimalPlaces:2,value:0,width:"90px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-content-label",create:this.bbdesigner$.proxy(this.onTextBoxCreate,this,D),change:this.bbdesigner$.proxy(this.changeTextBoxValue,this,D)}),this.measureItemDropObj=c.data("BoldBIDashboardDropDownList"),this.aggItemDropObj=r.data("BoldBIDashboardDropDownList"),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},e.prototype.onTextBoxCreate=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.changeTextBoxValue(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.changeTextBoxValue=function(e,t){var i=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0),this.betweenNotBetweenMeasureItemValidatation(),!BoldBIDashboard.isNullOrUndefined(t)&&""!==this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),"IsBetween"!==i&&"IsNotBetween"!==i||""!==this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),!BoldBIDashboard.isNullOrUndefined(t)&&0!==parseFloat(t)||e.data("ejNumericTextbox").setModel({value:0}),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},e.prototype.betweenNotBetweenMeasureItemValidatation=function(){var e=this.locale.measureFilterWindow,t=this.filterDialog.find("#"+this.id+"_measure_filter_text1").val(),i=this.filterDialog.find("#"+this.id+"_measure_filter_text2").val(),a=this.measureItemDropObj.getSelectedValue();("IsBetween"===a||"IsNotBetween"===a)&&parseFloat(i)<parseFloat(t)?(BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),this.showValidationMsg(this.id,!0,e.greaterOrEqualErrMsgText),this.errorMsgCell.css("display","block")):this.showValidationMsg(this.id,!1)},e.prototype.showValidationMsg=function(e,t,i){var e=this.filterDialog.find("#"+e+"_error_icon_td"),a=this.filterDialog.find("#"+this.id+"_measure_filter_rightbox_div");t?(BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i),a.addClass("bbi-designer-error")):(BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1),a.removeClass("bbi-designer-error"))},e.prototype.changeMeasureItem=function(e){var e=e.value,t=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0),""===this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()&&BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),"IsBetween"!==t&&"IsNotBetween"!==t||""!==this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),"IsBetween"===e||"IsNotBetween"===e?this.enableTextElement(!0):this.enableTextElement(!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},e.prototype.changeAggregateItem=function(){var e=this.measureItemDropObj.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.applyButton.attr("disabled"))||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0),BoldBIDashboard.isNullOrUndefined(this.filterDialog)||""!==this.filterDialog.find("#"+this.id+"_measure_filter_text1").val()||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),"IsBetween"!==e&&"IsNotBetween"!==e||BoldBIDashboard.isNullOrUndefined(this.filterDialog)||""!==this.filterDialog.find("#"+this.id+"_measure_filter_text2").val()||BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0)},e.prototype.enableTextElement=function(e){e?(this.textDiv.css("display","block"),this.rightTextBoxDiv.css("display","block"),this.betweenNotBetweenMeasureItemValidatation()):(this.textDiv.css("display","none"),this.rightTextBoxDiv.css("display","none"),this.errorMsgCell.css("display","none"))},e.prototype.disableFilterButton=function(e,t){t?e.css("opacity","0.5").attr("disabled","disabled"):e.css("opacity","1").removeAttr("disabled")},e.prototype.populateFilterInfo=function(e){var t,i=e.Conditions,a=e.Values,o=a.length,e=i===NumberFilterOption.IsBetween||i===NumberFilterOption.IsNotBetween;for(this.enableTextElement(e),t=0;t<o;t++)this.measureItemTable.find("#"+this.id+"_measure_filter_text"+(t+1)).data("ejNumericTextbox").setModel({value:a[t]})},e.prototype.updateFilterInfo=function(e){this.columnNameTag.text(this.columnName);var t=e.Conditions,i=e.SummaryType;this.aggItemDropObj.selectItemByValue(i),this.measureItemDropObj.selectItemByValue(t),this.populateFilterInfo(e),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},e.prototype.resetMeasureFilterValues=function(){this.measureItemDropObj.selectItemsByIndices(0),this.aggItemDropObj.selectItemByValue(this.fieldSummary),this.enableTextElement(!1);var e=this.measureItemTable.find("#"+this.id+"_measure_filter_text1"),t=this.measureItemTable.find("#"+this.id+"_measure_filter_text2"),i=this.locale.measureFilterWindow;e.data("ejNumericTextbox").setModel({value:i.enterValueWatermarkText}),t.data("ejNumericTextbox").setModel({value:i.enterValueWatermarkText}),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1)},e.prototype.getFilterValue=function(){var e,t,i=[],a=this.measureItemDropObj.getSelectedValue(),o=new BoldBIDashboard.Dashboard.MeasureFilterInfoForUI,s=this.resetButton.hasClass("e-disable")?"":a;for(o.Conditions=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(NumberFilterOption,s),s=this.resetButton.hasClass("e-disable")?"":this.aggItemDropObj.getSelectedValue().toString(),o.SummaryType=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,s),e="IsBetween"===a||"IsNotBetween"===a?2:1,t=0;t<e;t++){var n=this.measureItemTable.find("#"+this.id+"_measure_filter_text"+(t+1)).data("ejNumericTextbox").getValue(),n=BoldBIDashboard.isNullOrUndefined(n)?0:n;i.push(n)}return o.Values=this.resetButton.hasClass("e-disable")?[]:i,o.UniqueColumnName=this.uniqueColumnName,o.ColumnName=this.columnName,o},e.prototype.applyFilterValues=function(){var e=this.getFilterValue();BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[e]),this.closeMeasureFilter())},e.prototype.openMeasureFilter=function(e,t,i,a,o){this.resetMeasureFilter(),this.isKpiFilter=o,this.targetInstance=e,this.targetMethod=t,this.measureFilterInfo=a,this.columnName=i.Name,this.fieldSummary=i.SummaryType,this.uniqueColumnName=i.UniqueColumnName;o="bbi-designer-dataset-number"===i.FieldActualType?i.IsAggregatedExpression?[{value:SummaryType.CUSTOM,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.CUSTOM)}]:this.getMeasureFormatsList():this.getDimensionFormatsList();this.aggItemDropObj.setModel({dataSource:o}),this.filterDialog.data("BoldBIDashboardDialog").open(),!BoldBIDashboard.isNullOrUndefined(a)&&0<a.Values.length?this.updateFilterInfo(a):(BoldBIDashboard.isNullOrUndefined(this.columnName)||this.columnNameTag.text(this.columnName),this.resetMeasureFilterValues())},e.prototype.resetMeasureFilter=function(){this.columnNameTag.text(""),this.measureFilterInfo=null,this.columnName=null,this.uniqueColumnName=null},e.prototype.closeMeasureFilter=function(){this.filterDialog.data("BoldBIDashboardDialog").close()},e.prototype.measureItemList=function(){return[{text:this.locale.dataconfiguration.numberFilterOption.equals,value:NumberFilterOption.Equals},{text:this.locale.dataconfiguration.numberFilterOption.notEquals,value:NumberFilterOption.NotEquals},{text:this.locale.dataconfiguration.numberFilterOption.lessThan,value:NumberFilterOption.LessThan},{text:this.locale.dataconfiguration.numberFilterOption.greaterThan,value:NumberFilterOption.GreaterThan},{text:this.locale.dataconfiguration.numberFilterOption.lessThanOrEquals,value:NumberFilterOption.LessThanOrEquals},{text:this.locale.dataconfiguration.numberFilterOption.greaterThanOrEquals,value:NumberFilterOption.GreaterThanOrEquals},{text:this.locale.dataconfiguration.numberFilterOption.between,value:NumberFilterOption.IsBetween},{text:this.locale.dataconfiguration.numberFilterOption.notBetween,value:NumberFilterOption.IsNotBetween}]},e.prototype.getMeasureFormatsList=function(){var e=[],t=this.dashboardDesigner.modules.util;return e.push({value:SummaryType.NONE,text:t.getSummaryTypeLocalizedText(SummaryType.NONE)}),e.push({value:SummaryType.SUM,text:t.getSummaryTypeLocalizedText(SummaryType.SUM)}),e.push({value:SummaryType.AVG,text:t.getSummaryTypeLocalizedText(SummaryType.AVG)}),e.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),e.push({value:SummaryType.MAX,text:t.getSummaryTypeLocalizedText(SummaryType.MAX)}),e.push({value:SummaryType.MIN,text:t.getSummaryTypeLocalizedText(SummaryType.MIN)}),e.push({value:SummaryType.MEDIAN,text:t.getSummaryTypeLocalizedText(SummaryType.MEDIAN)}),e.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),e.push({value:SummaryType.VAR,text:t.getSummaryTypeLocalizedText(SummaryType.VAR)}),e},e.prototype.getDimensionFormatsList=function(){var e=[],t=this.dashboardDesigner.modules.util;return e.push({value:SummaryType.COUNT,text:t.getSummaryTypeLocalizedText(SummaryType.COUNT)}),e.push({value:SummaryType.COUNTD,text:t.getSummaryTypeLocalizedText(SummaryType.COUNTD)}),e},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_reset",this.bbdesigner$.proxy(this.resetMeasureFilterValues,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_ok",this.bbdesigner$.proxy(this.applyFilterValues,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_measure_filter_cancel",this.bbdesigner$.proxy(this.closeMeasureFilter,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_reset",this.bbdesigner$.proxy(this.resetMeasureFilterValues,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_ok",this.bbdesigner$.proxy(this.applyFilterValues,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_measure_filter_cancel",this.bbdesigner$.proxy(this.closeMeasureFilter,this))},e.prototype.destroy=function(){this.unWireEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_measure_filter")),0<this.dashboardDesigner.element.find("#"+this.id+"_measure_filter").length&&this.dashboardDesigner.element.find("#"+this.id+"_measure_filter").remove()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.MeasureFilter",InternalMeasureFilter,window),InternalTooltipCustomization=function(){function e(e){this.locale=null,this.scrollContainer=null,this.tooltipScrollElement=null,this.tootipDialog=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.propertyPanel=this.dashboardDesigner.modules.propertyPanel,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper}return e.prototype.onCustomizeButtonClick=function(e){this.renderTooltipDialog(),this.tooltipScrollElement.empty(),this.populateColumnValues(e)},e.prototype.updateTooltip=function(){for(var e,t,i,a,o=this.tooltipScrollElement.find(".e-tooltip-checkbox"),s=this.widgetHelper.getCurrentWidgetInstance(),n=s.getfieldInfosForTooltipCustomization(s),r=!1,d=0;d<o.length;d++)if(!(t=o.eq(d).data("BoldBIDashboardCheckBox")).model.checked){r=!0;break}if(r){for(e=[],d=0;d<o.length;d++)t=o.eq(d).data("BoldBIDashboardCheckBox"),e.push({FieldId:n[d].UniqueColumnName,IsSelected:t.model.checked});(i=new BasicTooltipSettings).TooltipFields=e,(a=new TooltipCustomization).BasicTooltipSettings=i,s.widgetJson.TooltipCustomization=a}else s.widgetJson.TooltipCustomization=null;s.updateTooltipBasedOnCustomization(),this.dashboardDesigner.modules.serialization.notifyChange(),this.tootipDialog.data("BoldBIDashboardDialog").close()},e.prototype.updateTooltipCustomization=function(){var e,t=this.widgetHelper.getCurrentWidgetInstance(),i=t.getfieldInfosForTooltipCustomization(t);if(!BoldBIDashboard.isNullOrUndefined(t.widgetJson.TooltipCustomization))if(t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.length>i.length)t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields=t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.filter(function(t){return i.some(function(e){return e.UniqueColumnName===t.FieldId})});else for(e=0;e<i.length;e++)!BoldBIDashboard.isNullOrUndefined(t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[e])&&t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[e].FieldId===i[e].UniqueColumnName||t.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields.splice(e,0,{FieldId:i[e].UniqueColumnName,IsSelected:!0})},e.prototype.updateShowTooltip=function(e){var t=this.widgetHelper.getCurrentWidgetInstance();t.updateShowTooltip(e,t),e=t.isCustomizeTooltipButtonEnable(t),t=this.bbdesigner$("#"+this.dashboardDesigner._id+"_"+t.Type+"_ToolTipSettings_CustomizeTooltip"),this.enableOrDisableButton(t,e),this.dashboardDesigner.modules.serialization.notifyChange()},e.prototype.closeTooltipSettings=function(){this.tootipDialog.data("BoldBIDashboardDialog").close()},e.prototype.renderTooltipDialog=function(){var e,t,i;this.tootipDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog"}),e=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_table"}),this.renderHeaderElement(e),this.scrollContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"262px",display:"block"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_individual_container"}),this.tooltipScrollElement=BoldBIDashboard.buildTag("div","",{height:"252px","padding-top":"5px","padding-bottom":"5px"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_individual_elements"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogCancelBtnText,{float:"right"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_cancel",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogOkBtnText,{float:"right"},{id:this.dashboardDesigner._id+"_tooltipSettings_dialog_ok",type:"button"}),this.scrollContainer.append(this.tooltipScrollElement),e.append(this.scrollContainer),this.tootipDialog.append(e),this.dashboardDesigner.element.append(this.tootipDialog),this.tootipDialog.BoldBIDashboardDialog({title:this.locale.propertyPanel.tooltipSettings.customizeTooltipDialogTitleText,width:320,height:"auto",minWidth:320,minHeight:320,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.bbdesigner$("#"+this.dashboardDesigner._id+"_tooltipSettings_dialog_foot").append(t,i),i.off("click",this.bbdesigner$.proxy(this.updateTooltip,this)),t.off("click",this.bbdesigner$.proxy(this.closeTooltipSettings,this)),i.on("click",this.bbdesigner$.proxy(this.updateTooltip,this)),t.on("click",this.bbdesigner$.proxy(this.closeTooltipSettings,this)),this.scrollContainer.BoldBIDashboardScroller({height:"262px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},e.prototype.renderHeaderElement=function(e){var t=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%"},{id:this.dashboardDesigner._id+"_tooltipSettings_table_title"}),i=BoldBIDashboard.buildTag("th.boldbi-dashboarddesigner-tooltip-namecolumn-title bbi-designer-fontfamily",this.locale.propertyPanel.tooltipSettings.columnNameHeaderText,{width:"60%","font-size":"12px","font-weight":"600","text-align":"left",padding:"12px"},{}),a=BoldBIDashboard.buildTag("th.boldbi-dashboarddesigner-tooltip-visibility-title bbi-designer-fontfamily",this.locale.propertyPanel.tooltipSettings.visibilityHeaderText,{width:"40%","font-size":"12px","font-weight":"600","text-align":"center",padding:"12px"},{});t.append(i),t.append(a),e.append(t)},e.prototype.populateColumnValues=function(e){var t,i=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),a=e.getfieldInfosForTooltipCustomization(e);if(BoldBIDashboard.isNullOrUndefined(e.widgetJson.TooltipCustomization))for(t=0;t<a.length;t++)this.renderRowElement(i,a[t].DisplayName,t,!0);else for(t=0;t<a.length;t++)BoldBIDashboard.isNullOrUndefined(e.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t])||e.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t].FieldId!==a[t].UniqueColumnName||this.renderRowElement(i,a[t].DisplayName,t,e.widgetJson.TooltipCustomization.BasicTooltipSettings.TooltipFields[t].IsSelected);this.tooltipScrollElement.append(i),this.tootipDialog.data("BoldBIDashboardDialog").open(),this.scrollerRefresh(this.scrollContainer)},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.renderRowElement=function(e,t,i,a){var o=BoldBIDashboard.buildTag("tr","",{width:"100%",height:"50px"},{id:this.dashboardDesigner._id+"_tooltip_column"+i}),t=BoldBIDashboard.buildTag("td.boldbi-dashboarddesigner-tooltip-column-value bbi-designer-fontfamily",t,{width:"60%","font-size":"12px","text-align":"left","padding-left":"12px"},{});o.append(t),t=BoldBIDashboard.buildTag("td.boldbi-dashboarddesigner-tooltip-visibility-checkbox bbi-designer-fontfamily","",{width:"40%","font-size":"12px","text-align":"center"},{}),i=BoldBIDashboard.buildTag("input.e-tooltip-checkbox","",{},{id:this.dashboardDesigner._id+"_tooltip_visibility"+i}),t.append(i),o.append(t),e.append(o),i.BoldBIDashboardCheckBox({checked:a,showRoundedCorner:!0,enabled:!0})},e.prototype.renderTooltipSettings=function(e,t,i){var a,o,s,n,r,d,l,t=i.designerInstance._id+"_"+t,h=i.designerInstance.element.find("#"+t);0!==h.length||BoldBIDashboard.isNullOrUndefined(e)?!BoldBIDashboard.isNullOrUndefined(h)&&0<h.length&&(d=h.find("#"+t+"_ShowTooltip"),l=i.getShowTooltip(i),d.BoldBIDashboardCheckBox({checked:l,change:this.bbdesigner$.proxy(this.updateShowTooltip,this),width:57*(this.propertyPanel.propertyPanelContainer.width()-33)/100-15+"px",cssClass:"e-designer-prop-checkbox"}),(a=h.find("#"+t+"_CustomizeTooltip")).off("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i)),a.on("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i)),o=i.isCustomizeTooltipButtonEnable(i),this.enableOrDisableButton(a,o)):(h=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-designer-scroll-style-3","",{width:"460px"},{id:t}),s=BoldBIDashboard.buildTag("div","",{"margin-bottom":"15px",display:"inline-block"},{id:t+"_ShowTooltip_container"}),r=BoldBIDashboard.buildTag("div","",{width:47*(this.propertyPanel.propertyPanelContainer.width()-33)/100+"px",float:"left","margin-left":"3px","margin-top":"8.5px"}),(n=BoldBIDashboard.buildTag("label.bbi-designer-fontfamily","",{"max-width":47*(this.propertyPanel.propertyPanelContainer.width()-33)/100-15+"px","font-size":"12px",overflow:"hidden",float:"right","margin-right":"11px","white-space":"nowrap","text-overflow":"ellipsis"},{id:t+"_ShowTooltip_childElement",for:t})).text(this.locale.propertyPanel.tooltipSettings.showTooltip),r.append(n),s.append(r),n=BoldBIDashboard.buildTag("div","",{width:57*(this.propertyPanel.propertyPanelContainer.width()-33)/100+"px",display:"inline-block","margin-top":"4px",border:"0px solid","border-color":"red"},{id:t+"_ShowTooltip_parent"}),d=BoldBIDashboard.buildTag("input","",{},{id:t+"_ShowTooltip",type:"checkbox"}),n.append(d),l=i.getShowTooltip(i),d.BoldBIDashboardCheckBox({checked:l,change:this.bbdesigner$.proxy(this.updateShowTooltip,this),width:57*(this.propertyPanel.propertyPanelContainer.width()-33)/100-15+"px",cssClass:"e-designer-prop-checkbox"}),s.append(n),h.append(s),r=BoldBIDashboard.buildTag("div","",{"margin-bottom":"15px",display:"inline-block"},{id:t+"_CustomizeTooltip_container"}),d=BoldBIDashboard.buildTag("div","",{width:47*(this.propertyPanel.propertyPanelContainer.width()-33)/100+"px",float:"left","margin-left":"3px","margin-top":"8.5px"}),(l=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"11px","white-space":"nowrap","text-overflow":"ellipsis"})).text(this.locale.propertyPanel.tooltipSettings.customizeTooltip),d.append(l),r.append(d),n=BoldBIDashboard.buildTag("div","",{width:47*(this.propertyPanel.propertyPanelContainer.width()-33)/100+"px",display:"inline-block","margin-top":"3px",border:"0px solid","border-color":"red"},{id:t+"_CustomizeTooltip_parent"}),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.propertyPanel.tooltipSettings.customizeTooltipBtnText,{width:"160px"},{id:t+"_CustomizeTooltip",type:"button"}),n.append(a),a.off("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i)),a.on("click",this.bbdesigner$.proxy(this.onCustomizeButtonClick,this,i)),r.append(n),h.append(r),o=i.isCustomizeTooltipButtonEnable(i),this.enableOrDisableButton(a,o),e.append(h))},e.prototype.enableOrDisableButton=function(e,t){t?e.removeAttr("disabled"):e.attr("disabled","disabled")},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.TooltipCustomization",InternalTooltipCustomization,window),InternalReportAction=function(){function e(e){this.isLinkEnable=!1,this.selectedFormat="",this.categoryId="",this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.propertyPanel=this.dashboardDesigner.modules.propertyPanel,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper}return e.prototype.renderAction=function(M,e,t){this.categoryId=this.dashboardDesigner._id+"_"+e+"_"+t.category;var i,a,o,s,n,r,d,A,l,h,p,c,P,u,b,g,m,R,f,D,y,B,I,V,x,_,v,C,w,T,S,$,k,N,F,W,H,q,z,j,G,Q,J,Y,K,X,O,Z,ee,te,ie,ae,oe,se,ne,re,de,le,he,pe,ce,ue,L,e=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),U=t.value,E=this.dashboardDesigner.element.find("#"+this.categoryId);if(0===E.length&&M&&(E=BoldBIDashboard.buildTag("div","",{width:e-10,display:BoldBIDashboard.isNullOrUndefined(t.isVisible)||t.isVisible?"block":"none"},{id:this.categoryId}),s=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),n=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),r=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),d=BoldBIDashboard.buildTag("td","",{},{}),A=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.enableLinkText,{},{id:this.categoryId+"_link_text_ckb"}),l=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_link_ckb",type:"checkbox"}),h=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),p=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),c=BoldBIDashboard.buildTag("td","",{},{}),P=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.escapeSpecialChartext,{},{id:this.categoryId+"_link_specialChar_text_ckb"}),u=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_link_specialChar_ckb",type:"checkbox"}),b=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),g=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),m=BoldBIDashboard.buildTag("td","",{},{}),R=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily bbi-designer-linking-table-row",this.locale.propertyPanel.linking.enableEncryptParameter,{},{id:this.categoryId+"_encryption_parameter_txt"}),f=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_encryption_parameter_ckb",type:"checkbox"}),D=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_config"}),y=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-designer-linking-config-table","",{width:"100%",margin:"8px 0px"},{}),"chrome"===BoldBIDashboard.browserInfo().name&&y.addClass("e-browser-chrome"),B=BoldBIDashboard.buildTag("tr","",{height:"28px",display:"none"},{id:this.categoryId+"_link_radioOptions"}),I=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),V=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),x=BoldBIDashboard.buildTag("td","",{width:"80px"},{}),_=BoldBIDashboard.buildTag("td","",{},{}),v={callBackInstance:this,callBackMethod:"checkedLinkConfig",groupName:"link",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.categoryId+"_radio_Row",label:this.locale.propertyPanel.linking.rowText,isChecked:!0,value:"row"}]},C={callBackInstance:this,callBackMethod:"checkedLinkConfig",groupName:"link",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.categoryId+"_radio_Column",label:this.locale.propertyPanel.linking.columnText,value:"column"}]},this.selectRadioButtonRow=new BoldBIDashboard.Dashboard.RadioButton(v,x),this.selectRadioButtonColumn=new BoldBIDashboard.Dashboard.RadioButton(C,_),v=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_selectField"}),C=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),w=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),T=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),S=BoldBIDashboard.buildTag("td","",{},{}),$=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.chooseField,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),k=BoldBIDashboard.buildTag("input.e-textbox","",{height:"28px",width:57*(e-33)/100-30+"px","margin-left":"2px"},{id:this.categoryId+"_link_selectField_txt",type:"text"}),N=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_columnURL"}),F=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),W=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),H=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),q=BoldBIDashboard.buildTag("td","",{},{}),z=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),j=BoldBIDashboard.buildTag("textarea.e-dbrd-column-urltxt e-textbox ","",{height:"125px",width:57*(e-33)/100-35+"px","margin-left":"2px",resize:"none","padding-bottom":"0px","padding-top":"0px"},{id:this.categoryId+"_link_columnURL_txt",type:"text",autocorrect:"off",spellcheck:"false"}),G=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_url"}),Q=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),J=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),Y=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),K=BoldBIDashboard.buildTag("td","",{display:"inline-flex"},{}),X=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),O=BoldBIDashboard.buildTag("textarea.e-textbox","",{height:"125px",width:57*(e-33)/100-35+"px","margin-left":"2px",resize:"none","padding-bottom":"0px","padding-top":"0px"},{id:this.categoryId+"_link_url_txt",type:"text",autocorrect:"off",spellcheck:"false"}),Z=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_appendColumn"}),ee=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),te=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),ie=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),ae=BoldBIDashboard.buildTag("td","",{},{}),oe=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.appendColumn,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),se=BoldBIDashboard.buildTag("div","",{"padding-left":"2px"},{}),ne=BoldBIDashboard.buildTag("ul","",{},{id:this.categoryId+"_link_appendColumn_list"}),se.append(ne),re=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_urlPreview"}),de=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),le=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),he=BoldBIDashboard.buildTag("td","",{width:47*(e-47)/100+"px"},{}),pe=BoldBIDashboard.buildTag("td","",{},{}),ce=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.urlPreview,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),ue=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","margin-right":"5px","white-space":"nowrap",width:57*(e-33)/100-30+"px","text-overflow":"ellipsis"}),L=BoldBIDashboard.buildTag("a","",{height:"28px","margin-left":"2px","font-size":"13px"},{id:this.categoryId+"_link_urlPreview_txt",href:""}),he.append(ce),ue.append(L),pe.append(ue),le.append(he).append(pe),de.append(le),re.append(de),ie.append(oe),ae.append(se),te.append(ie).append(ae),ee.append(te),Z.append(ee),Y.append(X),K.append(O,this.getEncryptIcon(this.locale.propertyPanel.linking.urlLinkInfo)),J.append(Y).append(K),Q.append(J),G.append(Q),T.append($),S.append(k),w.append(T).append(S),C.append(w),v.append(C),H.append(z),q.append(j),W.append(H).append(q),F.append(W),N.append(F),I.append(V),B.append(I).append(x).append(_),y.append(B),D.append(y),r.append(A),d.append(l),n.append(r).append(d),s.append(n),p.append(P),c.append(u,this.getInfoIcon()),h.append(p).append(c),s.append(h),g.append(R),m.append(f,this.getEncryptIcon(this.locale.propertyPanel.linking.enableEncryptCharTooltipInfo)),b.append(g).append(m),s.append(b),E.append(s),E.append(D),E.append(v),E.append(N),E.append(G),E.append(Z),E.append(re),this.renderCustomLinkDestination(E),M.append(E),L.text(""),k.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"Name",value:"Value"},showRoundedCorner:!0,width:57*(e-33)/100-10+"px",cssClass:"bbi-dbrd-control",select:this.bbdesigner$.proxy(this.changeColumn,this)}),ne.BoldBIDashboardListBox({dataSource:[],fields:{text:"Name",value:"Value"},showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-list-selection bbi-dbrd-designer-scroller bbi-dbrd-control",width:57*(e-33)/100-20+"px",height:"125px",select:this.bbdesigner$.proxy(this.selectURL,this)}),l.BoldBIDashboardCheckBox({width:57*(e-33)/100-15+"px",change:this.bbdesigner$.proxy(this.changedLink,this),cssClass:"e-designer-prop-checkbox"}),u.BoldBIDashboardCheckBox({width:57*(e-33)/100-15+"px",change:this.bbdesigner$.proxy(this.escapeSpecialCharacterChangeEvent,this),htmlAttributes:{style:"float:left"},cssClass:"e-designer-prop-checkbox"}),f.BoldBIDashboardCheckBox({width:57*(e-33)/100-15+"px",change:this.bbdesigner$.proxy(this.enableParameterEncryptionChangeEvent,this),htmlAttributes:{style:"float:left"},cssClass:"e-designer-prop-checkbox"}),O.bind("blur",this.bbdesigner$.proxy(this.urlFocusOut,this)),O.bind("keyup",this.bbdesigner$.proxy(this.urlKeyUp,this)),j.bind("blur",this.bbdesigner$.proxy(this.columnUrlFocusOut,this)),L.bind("click",this.bbdesigner$.proxy(this.urlPreviewClick,this))),0<E.length){if(this.updateCustomLinkDestination(t),this.dashboardDesigner.element.find("#"+this.categoryId).css("display",BoldBIDashboard.isNullOrUndefined(t.isVisible)||t.isVisible?"block":"none"),i=void 0,this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none"),BoldBIDashboard.isNullOrUndefined(t.isDisable)?this.isLinkEnable=!0:this.enableLink(!t.isDisable),BoldBIDashboard.isNullOrUndefined(U))this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("checked",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(""),""!==this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt")[0].innerText&&this.updateURLText(""),this.enableLinkConfig(!1),this.linkItem=this.populateLinkModel(t),this.changeLinkConfig(!1,!0);else{if(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:U.EnableLink}),U.EnableLink||this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),U.EscapeSpecialCharacter&&this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").setModel({checked:U.EscapeSpecialCharacter}),U.EnableParameterEncryption&&this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").setModel({checked:U.EnableParameterEncryption}),this.enableLinkConfig(!t.isDisable&&U.EnableLink),this.linkItem=t,U.GridUrlType===UrlLinkType[UrlLinkType.Column]){for(this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("checked",!0),U.ColumnUrlDetails=this.updateColumnDetails(U.ColumnUrlDetails),a=0;a<U.ColumnUrlDetails.length;a++)if(!BoldBIDashboard.isNullOrUndefined(U.ColumnUrlDetails[a].UrlLink)&&""!==U.ColumnUrlDetails[a].UrlLink){o=U.ColumnUrlDetails[a].UrlLink,this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val(o),this.updateURLText(o),i=U.ColumnUrlDetails[a].CaptionName;break}}else this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.updateUrlRowDetails(),this.populateLink(this.linkItem.value.UrlPath);this.changeLinkConfig(!1,!1)}this.populateList(),this.populateDropDown(),BoldBIDashboard.isNullOrUndefined(U)||U.GridUrlType!==UrlLinkType[UrlLinkType.Column]||BoldBIDashboard.isNullOrUndefined(i)||""===i||this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList").selectItemByValue(i)}},e.prototype.getInfoIcon=function(){return this.dashboardDesigner.isHelpLinkHidden()?"":"<div class ='bbi-dbrd-link-specialChar-help-info-icon'><a href='"+this.dashboardDesigner.getHelpDocLink("UrlParameter")+"'  target='_blank' class ='bbi-dbrd-link-specialChar-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip =\""+this.locale.propertyPanel.linking.escapeSpecialCharTooltipInfo+'"></a></div>'},e.prototype.getEncryptIcon=function(e){return this.dashboardDesigner.isHelpLinkHidden()?"":"<div class ='bbi-dbrd-link-specialChar-help-info-icon'><a class ='bbi-dbrd-link-specialChar-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip =\""+e+'"></a></div>'},e.prototype.renderCustomLinkDestination=function(e){var t=this.bbdesigner$("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),i=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_config_1"}),a=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-designer-linking-config-table","",{width:"100%",margin:"8px 0px"},{}),a=(i.append(a),e.append(i),BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_selectField_1"})),i=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),o=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),s=BoldBIDashboard.buildTag("td","",{width:47*(t-47)/100+"px"},{}),n=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.targetText,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),d=BoldBIDashboard.buildTag("input.e-textbox","",{height:"28px",width:57*(t-33)/100-30+"px","margin-left":"2px"},{id:this.categoryId+"_link_selectField_txt_1",type:"text"}),s=(s.append(r),n.append(d),o.append(s).append(n),i.append(o),a.append(i),e.append(a),r=[{Name:this.locale.propertyPanel.linking.targetField.newTabText,Value:"_blank"},{Name:this.locale.propertyPanel.linking.targetField.samePageText,Value:"_top"},{Name:this.locale.propertyPanel.linking.targetField.currentFrameText,Value:"_self"},{Name:this.locale.propertyPanel.linking.targetField.parentFrameText,Value:"_parent"},{Name:this.locale.propertyPanel.linking.targetField.popUpText,Value:"_popup"},{Name:this.locale.propertyPanel.linking.targetField.newWindowText,Value:"_newwindow"}],d.BoldBIDashboardDropDownList({dataSource:r,fields:{text:"Name",value:"Value"},showRoundedCorner:!0,width:57*(t-33)/100-10+"px",cssClass:"bbi-dbrd-control",selectedIndex:0,select:this.bbdesigner$.proxy(this.updateLinkDestinationInfo,this)}),this.renderPopUpTitle(e),BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_windowSize"})),n=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),o=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),i=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),a=BoldBIDashboard.buildTag("td","",{width:47*(t-47)/100+"px"},{}),d=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("td","",{width:47*(t-47)/100+"px"},{}),t=BoldBIDashboard.buildTag("td","",{},{}),l=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_window_size_numeric"}),h=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily",this.locale.propertyPanel.linking.height,{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),p=BoldBIDashboard.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_window_size_numeric1"}),c=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Width",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"});a.append(h),d.append(l),r.append(c),t.append(p),o.append(a).append(d),i.append(r).append(t),n.append(o,i),s.append(n),e.append(s),l.ejNumericTextbox({value:500,minValue:100,width:"100px",height:"24px",showRoundedCorner:!0,change:this.bbdesigner$.proxy(this.updateHeightWidth,this)}),p.ejNumericTextbox({value:500,minValue:100,width:"100px",height:"24px",showRoundedCorner:!0,change:this.bbdesigner$.proxy(this.updateHeightWidth,this)}),s.css("display","none")},e.prototype.renderPopUpTitle=function(e){var t=this.bbdesigner$("#"+this.dashboardDesigner._id+"_propertyPanelContainer").width(),i=BoldBIDashboard.buildTag("div","",{},{id:this.categoryId+"_link_panel_title"}),a=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",margin:"8px 0px"},{unselectable:"on"}),o=BoldBIDashboard.buildTag("tr","",{height:"28px"},{}),s=BoldBIDashboard.buildTag("td","",{width:47*(t-47)/100+"px"},{}),n=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","Title",{"font-size":"12px",overflow:"hidden",float:"right","margin-right":"5px","white-space":"nowrap","text-overflow":"ellipsis"}),t=BoldBIDashboard.buildTag("input.e-dbrd-column-urltxt e-textbox ","",{width:57*(t-33)/100-30+"px",height:"28px","margin-left":"2px"},{id:this.categoryId+"_link_panel_title_txt",type:"text",autocorrect:"off",spellcheck:"false"});i.css("display","none"),s.append(r),n.append(t),o.append(s).append(n),a.append(o),i.append(a),e.append(i),t.bind("blur",this.bbdesigner$.proxy(this.updateTitle,this))},e.prototype.updateAdvance=function(e){e.isInteraction&&("_popup"===e.value?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val("")):"_newwindow"===e.value&&(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").option("value",500),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").option("value",500)),this.updateLinkDestination(!0,e.value,e))},e.prototype.updateHeightWidth=function(e){e.isInteraction&&(e=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").getSelectedValue(),this.updateLinkDestination(!0,e))},e.prototype.updateTitle=function(){var e=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").getSelectedValue();this.updateLinkDestination(!0,e)},e.prototype.updateLinkDestinationInfo=function(e){e.isInteraction&&("_popup"===e.value||"_newwindow"===e.value?this.updateAdvance(e):this.updateLinkDestination(!1,e.value))},e.prototype.updateCustomLinkDestination=function(e){if(e.value.EnableLink){switch(e.value.TargetTypeInfo){case"_popup":this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val(e.value.Title);break;case"_newwindow":this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").option("value",e.value.Height),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").option("value",e.value.Width);break;default:this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_popDiv").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none")}this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").selectItemByValue(e.value.TargetTypeInfo)}else this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_popDiv").css("display","none")},e.prototype.getLinkItemVisibility=function(e){return!!(BoldBIDashboard.isNullOrUndefined(this.linkItem.visibility)||this.linkItem.visibility&e)},e.prototype.updateLinkEnable=function(e){this.enableLink(e),this.changeLinkConfig(!1,!1),this.enableLinkConfig(!!e&&this.linkItem.value.EnableLink)},e.prototype.enableLink=function(e){e?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_text_ckb").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").enable(),this.isLinkEnable=!0):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_text_ckb").attr("disabled","true").css("opacity",".3"),this.isLinkEnable=!1)},e.prototype.updateUrlRowDetails=function(){for(var e,t,i=this.linkItem.value.PassingParameters,a=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0),o=0;o<i.length;o++){for(e=!1,t=0;t<a.length;t++)if(i[o]===a[t].Value){e=!0;break}e||this.linkItem.value.UrlPath.includes("@{{:"+i[o]+"}}")||(this.linkItem.value.UrlPath=this.linkItem.value.UrlPath.replaceAll("{{:"+i[o]+"}}",""),i.splice(o,1),this.updateLinksInWidgetJson())}},e.prototype.updateColumnDetails=function(e){for(var t,i,a=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0),o=0;o<e.length;o++){for(t=!0,i=0;i<a.length;i++)if(e[o].CaptionName===a[i].FieldName){e[o].UniqueColumnName=a[i].Id,t=!1;break}t&&(e.splice(o,1),this.updateLinksInWidgetJson())}return e},e.prototype.updateLinksInWidgetJson=function(){var e=JSON.parse(JSON.stringify(this.linkItem));this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,e.value,this.linkItem,this.linkItem.categoryName)},e.prototype.isDuplicate=function(e,t){for(var i=0;i<e.length;i++)if(e[i].Name===t)return!0;return!1},e.prototype.populateLinkModel=function(e){return e.value=this.createDashboardLinks(),e},e.prototype.validateColumnDetails=function(e){for(var t=0;t<this.linkItem.value.ColumnUrlDetails.length;t++)if(this.linkItem.value.ColumnUrlDetails[t].UniqueColumnName===e)return!1;return!0},e.prototype.populateDropDown=function(){var e,t,i;if(this.columnData=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1),i=this.isLinkEnable?"block":"none",0<this.columnData.length?this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display",BoldBIDashboard.isNullOrUndefined(this.linkItem.enableMode)||this.linkItem.enableMode===LinkEnableMode.Both?i:"none"):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none"),this.linkItem.value.GridUrlType===UrlLinkType[UrlLinkType.Column]&&(this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.changeLinkConfig(!0,!0),this.populateLink(this.linkItem.value.ReportUrlPath)),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_radioOptions").css("display","none")),BoldBIDashboard.isNullOrUndefined(this.linkItem)||this.linkItem.value.ColumnUrlDetails.length!==this.columnData.length)for(e=0;e<this.columnData.length;e++)this.validateColumnDetails(this.columnData[e].Id)&&((t=this.createGridColumnUrlDetails()).CaptionName=this.columnData[e].FieldName,t.UniqueColumnName=this.columnData[e].Id,this.linkItem.value.ColumnUrlDetails.push(t));i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(i)||(i.option("dataSource",this.columnData),i.option("selectedIndex",0))},e.prototype.populateList=function(){this.rowData=this.dashboardDesigner.modules.util.getSourceData(this.getDataGroupInfo(),!1,!1,!0),this.rowData=this.rowData.filter(function(e){return BoldBIDashboard.isNullOrUndefined(e.CanUseInLinking)||e.CanUseInLinking});var e=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list"),t=e.data("BoldBIDashboardListBox");BoldBIDashboard.isNullOrUndefined(t)||(t.option("dataSource",this.rowData),e.find("li").unbind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.changeURL,this)),e.find("li").bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.changeURL,this)),e.BoldBIDashboardListBox("instance")._refreshScroller())},e.prototype.populateLink=function(e){this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(e),this.updateURLText(e),this.linkItem.value.UrlPath=e},e.prototype.checkedLinkConfig=function(e){"change"===e.args.event.type&&(this.changeLinkConfig(!0,!0),this.refreshWidget())},e.prototype.appendClick=function(){var e,t=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt"),i=t.val(),a=this.selectedFormat;0===t[0].selectionStart&&(e=t.val().length,t[0].setSelectionRange(e,e)),e=t[0].selectionStart,t.val(i.substring(0,t[0].selectionStart)+a+i.substring(t[0].selectionStart)),t[0].selectionStart=t[0].selectionEnd=e+a.length,t[0].focus(),this.updateColumnUrl(!0)},e.prototype.getFieldName=function(e){for(var t,i=0;i<this.columnData.length;i++)if(this.columnData[i].Value===e){t=this.columnData[i].FieldName;break}return t},e.prototype.refreshWidget=function(){var e=this.widgetHelper.getCurrentWidgetInstance();BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(e)||e.refresh()},e.prototype.changeColumn=function(e){var e=e.value,t=this.getFieldName(e);this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_Button").addClass("bbi-dbrd-designer-hoverable").attr("data-tooltip",this.locale.dashboardLink.columnURLTooltipPrefix+" "+t+" "+this.locale.dashboardLink.columnURLTooltipSuffix),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val(this.getLastColumnUrl(e))},e.prototype.selectURL=function(e){this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").BoldBIDashboardListBox("instance")._refreshScroller(),!BoldBIDashboard.isNullOrUndefined(e)&&0<e.value.length&&(this.selectedFormat="{{:"+e.value+"}}")},e.prototype.changeURL=function(e){var t,i,a,o;this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked")?!BoldBIDashboard.isNullOrUndefined(this.selectedFormat)&&0<this.selectedFormat.length&&(a=void 0,o=(i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt")).val(),BoldBIDashboard.isNullOrUndefined(this.selectedFormat)||(t=this.selectedFormat.replace("{{:","").replace("}}",""),-1===this.linkItem.value.PassingParameters.indexOf(t)&&this.linkItem.value.PassingParameters.push(t)),0===i[0].selectionStart&&(a=i.val().length,i[0].setSelectionRange(a,a)),i.val(o.substring(0,i[0].selectionStart)+this.selectedFormat+o.substring(i[0].selectionStart)),this.updateURLText(i.val()),this.updateUrl(!1),this.selectedFormat=""):this.appendClick(e)},e.prototype.updatePassingParameters=function(e,t){e.PassingParameters=[];for(var i=0;i<this.linkItem.value.PassingParameters.length;i++)-1!==t.indexOf(this.linkItem.value.PassingParameters[i])&&e.PassingParameters.push(this.linkItem.value.PassingParameters[i]);return e},e.prototype.updateActionDetails=function(e,t){var i,a=JSON.parse(JSON.stringify(this.linkItem));if((a.value.GridUrlType=e)===UrlLinkType[UrlLinkType.Row]){for(i=0;i<a.value.ColumnUrlDetails.length;i++)a.value.ColumnUrlDetails[i].UrlLink="";this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val(""),this.updateURLText("")}else a.value.UrlPath="",a.value.PassingParameters=[],this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val("");t&&this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,a.value,this.linkItem,this.linkItem.categoryName),this.linkItem.value=a.value},e.prototype.updateLinkDestination=function(e,t){var i=JSON.parse(JSON.stringify(this.linkItem));if(i.value.TargetTypeInfo=t,e)switch(t){case"_popup":i.value.Title=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").val();break;case"_newwindow":i.value.Height=this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").data("ejNumericTextbox").getValue(),i.value.Width=this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").data("ejNumericTextbox").getValue()}else this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("display","none");this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,i.value,this.linkItem,this.linkItem.categoryName),this.linkItem.value=i.value},e.prototype.changeLinkConfig=function(e,t){this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked")?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.AppendColumn)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.URLPreview)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").css("display",this.isLinkEnable&&this.getLinkItemVisibility(LinkVisibility.URLText)?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").css("display","none"),t&&(this.updateActionDetails(UrlLinkType[UrlLinkType.Row],e),this.populateList())):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display","block"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").css("display","none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").css("display",this.isLinkEnable?"block":"none"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").css("display",this.isLinkEnable?"block":"none"),t&&(this.updateActionDetails(UrlLinkType[UrlLinkType.Column],e),this.populateDropDown()));t=this.widgetHelper.getCurrentWidgetInstance();null!=t&&BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(t)&&this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").css("display","none")},e.prototype.enableLinkConfig=function(e){e?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_text_ckb").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").enable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_link_specialChar_ckb").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_txt").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").enable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_encryption_parameter_ckb").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("disabled",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("disabled",!1),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config_1").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").BoldBIDashboardListBox("instance")._refreshScroller(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").data("BoldBIDashboardListBox").enable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_show_popup_div").removeAttr("disabled").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("opacity","1"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").removeAttr("disabled")):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_text_ckb").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_specialChar_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_link_specialChar_ckb").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_txt").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_encryption_parameter_ckb").data("BoldBIDashboardCheckBox").disable(),this.dashboardDesigner.element.find("#BoldBIDashboard"+this.categoryId+"_encryption_parameter_ckb").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_list").data("BoldBIDashboardListBox").disable(),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("disabled",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Column_rdo_input").prop("disabled",!0),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_appendColumn_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_config_1").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title").attr("disabled","true").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_panel_title_txt").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_windowSize").css("opacity",".3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric").attr("disabled","true"),this.dashboardDesigner.element.find("#"+this.categoryId+"_window_size_numeric1").attr("disabled","true")),this.updateDropDownListDisabling(e)},e.prototype.updateDropDownListDisabling=function(e){e?this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("pointer-events","all").css("opacity","1"):(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_1").css("pointer-events","none").css("opacity","0.3"),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_selectField_txt_1").data("BoldBIDashboardDropDownList").model.selectedIndex=0)},e.prototype.changedLink=function(e){var t;e.isInteraction&&(this.dashboardDesigner.element.find("#"+this.categoryId+"_radio_Row_rdo_input").prop("checked",!0),this.changeLinkConfig(!1,!0),this.enableLinkConfig(e.isChecked),(t=this.populateLinkModel(JSON.parse(JSON.stringify(this.linkItem)))).value.EnableLink=e.isChecked,t.value.IsAdvancedTarget=!1,t.value.TargetTypeInfo="_blank",this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t.value,this.linkItem,this.linkItem.categoryName),this.linkItem.value=t.value,t.value.EnableClick||this.propertyPanel.propertyPanelContainer.find("#"+this.categoryId+"_link_appendColumn_list").find(".e-select").removeClass("e-select"),this.refreshWidget())},e.prototype.escapeSpecialCharacterChangeEvent=function(e){var t;e.isInteraction&&((t=this.linkItem.value).EscapeSpecialCharacter=e.isChecked,this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName))},e.prototype.enableParameterEncryptionChangeEvent=function(e){var t;e.isInteraction&&((t=this.linkItem.value).EnableParameterEncryption=e.isChecked,this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName))},e.prototype.getLastUrl=function(){return this.linkItem&&this.linkItem.value?this.linkItem.value.UrlPath:""},e.prototype.getLastColumnUrl=function(e){for(var t=0;t<this.columnData.length;t++)if(this.columnData[t].Value===e&&this.linkItem.value.ColumnUrlDetails.length>t)return this.linkItem.value.ColumnUrlDetails[t].UrlLink;return""},e.prototype.updateURLText=function(e){var t;0===e.length?(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").text(""),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("href","")):(t=this.dashboardDesigner.modules.util.addhttp(e),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").attr("href",t),this.dashboardDesigner.element.find("#"+this.categoryId+"_link_urlPreview_txt").text(e))},e.prototype.updateUrlByValues=function(e,t,i){var a,o,s,n=this.widgetHelper.getCurrentWidgetInstance(),r=n.dataValues;if(!BoldBIDashboard.isNullOrUndefined(e)&&""!==e&&0<t.length&&!BoldBIDashboard.isNullOrUndefined(r))for(a=this.dashboardDesigner.modules.util.getSourceData(n.dataGroupInfo,i,!1,!0),o=0;o<t.length;o++)s=this.getValuesOfParameter(t[o],a,r),e=BoldBIDashboard.isNullOrUndefined(s)||""===s?e:e.replaceAll("{{:"+t[o]+"}}",""+s);this.updatePreviewURLLink(e,n.widgetJson.Data.Id)},e.prototype.updatePreviewURLLink=function(e,t){this.dashboardDesigner.paramRegex.test(e)?this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.getDashboardParamLink,{action:"",data:JSON.stringify({datasourceId:t,clientID:this.dashboardDesigner.modules.util.clientId,url:e})},{fnction:this.dashboardDesigner.bbdesigner$.proxy(this.updateParamLink,this,e)}):this.updateParamLink(e)},e.prototype.updateParamLink=function(e,t){!BoldBIDashboard.isNullOrUndefined(t)&&t.Status&&(e=t.Url),window.open(e,"_blank")},e.prototype.getValuesOfParameter=function(e,t,i){for(var a,o,s,n,r=0;r<t.length;r++)if(t[r].Value===e)for(a=JSON.parse(i.data),o=0;o<a.length;o++)if(s=t[r].Id,n=a[o],!BoldBIDashboard.isNullOrUndefined(n[s])&&""!==n[s])return n[s];return""},e.prototype.columnUrlFocusOut=function(){this.updateColumnUrl(!0)},e.prototype.updateColumnUrl=function(e){var t,i,a=this.bbdesigner$("#"+this.categoryId+"_link_columnURL_txt").val(),o=this.bbdesigner$("#"+this.categoryId+"_link_selectField_txt").data("BoldBIDashboardDropDownList").getSelectedValue();if(a!==this.getLastColumnUrl(o)){for(t=JSON.parse(JSON.stringify(this.linkItem.value)),i=0;i<this.columnData.length;i++)if(this.columnData[i].Value===o){t.ColumnUrlDetails[i].UrlLink=a;break}e&&(this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName),this.linkItem.value=t,this.refreshWidget())}},e.prototype.urlFocusOut=function(){this.updateURLText(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val()),this.updateUrlForManualColumns(),this.updateUrl(!0)},e.prototype.updateUrl=function(e){var t,i=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val();(i=BoldBIDashboard.isNullOrUndefined(i)?i:i.trim())!==this.getLastUrl()&&((t=JSON.parse(JSON.stringify(this.linkItem.value))).UrlPath=i,e&&this.updatePassingParameters(t,i),this.propertyPanel.updatePropertyChange(this.linkItem.category+"Link",this.linkItem.value,t,this.linkItem,this.linkItem.categoryName),this.linkItem.value=t)},e.prototype.urlKeyUp=function(){this.updateURLText(this.dashboardDesigner.element.find("#"+this.categoryId+"_link_columnURL_txt").val())},e.prototype.updateUrlForManualColumns=function(){var e,t,i,a=this.dashboardDesigner.element.find("#"+this.categoryId+"_link_url_txt").val();if(a!==this.getLastUrl()&&(e=new RegExp(/[^{:\}]+(?=})/g),t=a.match(e),!BoldBIDashboard.isNullOrUndefined(t)))for(0<t.length&&(this.linkItem.value.PassingParameters=[]),i=0;i<t.length;i++)this.linkItem.value.PassingParameters.push(t[i])},e.prototype.urlPreviewClick=function(e){var t;e.preventDefault(),0<(e=this.bbdesigner$("#"+this.categoryId+"_link_urlPreview_txt").attr("href")).length&&(t=this.linkItem.value.GridUrlType===UrlLinkType[UrlLinkType.Column],e=this.dashboardDesigner.paramRegex.test(e)?this.bbdesigner$("#"+this.categoryId+"_link_urlPreview_txt").text():e,this.updateUrlByValues(e,t?this.linkItem.value.ColumnUrlDetails:this.linkItem.value.PassingParameters,t))},e.prototype.createDashboardLinks=function(){return{ColumnUrlDetails:[],GridUrlType:UrlLinkType[UrlLinkType.Row],LinkType:LinkType[LinkType.Url],EnableLink:!1,EscapeSpecialCharacter:!1,EnableParameterEncryption:!1,PassingParameters:[],UrlPath:""}},e.prototype.createGridColumnUrlDetails=function(){return{CaptionName:"",UniqueColumnName:"",UrlLink:""}},e.prototype.getDataGroupInfo=function(){return this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ReportAction",InternalReportAction,window),InternalUndoManager=function(){function e(e){this.stack=[],this.currentIndex=-1,this.isMergeAction=!1,this.mergeAction=[],this.lastSavedActionIndex=-1,this.isExportAction=!1,this.isPerformAction=!1,this.stack=[],this.dashboardDesigner=e}return e.prototype.setMergeAction=function(e){!(this.isMergeAction=e)&&0<this.mergeAction.length&&(this.cmdAction(this.mergeAction),this.mergeAction=[])},e.prototype.saveActionIndex=function(){this.lastSavedActionIndex=this.currentIndex},e.prototype.cmdAction=function(e){this.isPerformAction||(this.clearRedo(),this.stack.push(e),this.currentIndex++,this.updateToolbar())},e.prototype.isUndo=function(){return 0<=this.currentIndex},e.prototype.undo=function(){var e=this.stack[this.currentIndex];this.currentIndex--,this.undoAction(e),this.updateToolbar()},e.prototype.undoAction=function(e){var t,i;if(this.isPerformAction=!0,void 0!==e.itemType)this.performUndoAction(e);else for(t=e,i=0;i<t.length;i++)this.performUndoAction(t[i]);this.isPerformAction=!1},e.prototype.performUndoAction=function(e){e.action===CommandAction.ItemAdd?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),"dispose"):e.action===CommandAction.ItemPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsOldVal):e.action===CommandAction.ContainerPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)).getContainerProperty(),e.method,e.paramsOldVal):e.action===CommandAction.ItemResize||e.action===CommandAction.ItemMove?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsOldVal):e.action===CommandAction.ItemDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,e.method,e.paramsOldVal):e.action===CommandAction.DataSourceAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"removeDataSource",e.paramsNewVal):e.action===CommandAction.DataSourceDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"insertDataSource",e.paramsNewVal):e.action===CommandAction.DataSourceEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,e.method,e.paramsOldVal):e.action===CommandAction.DataSetAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSet",e.paramsNewVal):e.action===CommandAction.DataSetEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,e.method,e.paramsOldVal):e.action===CommandAction.DataFieldDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"addDataSetField",e.paramsNewVal):e.action===CommandAction.DataAssignAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"removeItem",e.paramsOldVal):e.action===CommandAction.DataAssignReplace?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"replaceItem",e.paramsOldVal):e.action===CommandAction.DataAssignDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"addItem",e.paramsOldVal):e.action===CommandAction.DataAssignUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"reorderItem",e.paramsOldVal):e.action===CommandAction.UpdateSort?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateSortInfo",e.paramsOldVal):e.action===CommandAction.ParameterAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameter",e.paramsNewVal):e.action===CommandAction.ParameterDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"insertParameter",e.paramsNewVal):e.action===CommandAction.ParameterEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,e.method,e.paramsOldVal):e.action===CommandAction.ParametersAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameters",e.paramsNewVal):e.action===CommandAction.ParametersDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"addParameters",e.paramsNewVal):e.action===CommandAction.TextBoxContentUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsOldVal):e.action===CommandAction.ConvertStandardWidget?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,e.method,e.paramsOldVal):e.action===CommandAction.TabAdd?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),"tabRemoveForUndoRedo",e.paramsOldVal):e.action===CommandAction.TabSwitch&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsOldVal),this.dashboardDesigner.modules.serialization.notifyChange()},e.prototype.isRedo=function(){return this.currentIndex<this.stack.length-1},e.prototype.redo=function(){this.currentIndex++;var e=this.stack[this.currentIndex];this.redoAction(e),this.updateToolbar()},e.prototype.redoAction=function(e){var t,i;if(this.isPerformAction=!0,void 0!==e.itemType)this.performRedoAction(e);else for(t=e,i=0;i<t.length;i++)this.performRedoAction(t[i]);this.isPerformAction=!1,this.currentIndex===this.lastSavedActionIndex&&BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner,"updateFileStatus",[!1])},e.prototype.performRedoAction=function(e){var t;e.action===CommandAction.ItemAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,e.method,e.paramsNewVal):e.action===CommandAction.ItemPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsNewVal):e.action===CommandAction.ContainerPropertyChanged?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)).getContainerProperty(),e.method,e.paramsNewVal):e.action===CommandAction.ItemResize||e.action===CommandAction.ItemMove?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsNewVal):e.action===CommandAction.ItemDelete?0<(t=this.dashboardDesigner.element.find("#"+e.targetTag)).length&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(t),"dispose"):e.action===CommandAction.DataSourceAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"insertDataSource",e.paramsOldVal):e.action===CommandAction.DataSourceDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,"removeDataSource",e.paramsOldVal):e.action===CommandAction.DataSourceEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSource,e.method,e.paramsNewVal):e.action===CommandAction.DataSetAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"insertDataSet",e.paramsOldVal):e.action===CommandAction.DataSetDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSet",e.paramsOldVal):e.action===CommandAction.DataSetEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,e.method,e.paramsNewVal):e.action===CommandAction.DataFieldDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataSet,"removeDataSetField",e.paramsOldVal):e.action===CommandAction.DataAssignAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"addItem",e.paramsOldVal):e.action===CommandAction.DataAssignReplace?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"replaceItem",e.paramsNewVal):e.action===CommandAction.DataAssignDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"removeItem",e.paramsOldVal):e.action===CommandAction.DataAssignUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"reorderItem",e.paramsNewVal):e.action===CommandAction.UpdateSort?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"updateSortInfo",e.paramsNewVal):e.action===CommandAction.ParameterAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"insertParameter",e.paramsOldVal):e.action===CommandAction.ParameterDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameter",e.paramsOldVal):e.action===CommandAction.ParameterEdit?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,e.method,e.paramsNewVal):e.action===CommandAction.ParametersAdd?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"addParameters",e.paramsOldVal):e.action===CommandAction.ParametersDelete?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.parameter,"removeParameters",e.paramsOldVal):e.action===CommandAction.TextBoxContentUpdate?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsNewVal):e.action===CommandAction.ConvertStandardWidget?BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.designerPanel,"renderQnAWidgetOnRedoAction",e.paramsOldVal):e.action===CommandAction.TabAdd?BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),"tabAdditionForUndoRedo",e.paramsOldVal):e.action===CommandAction.TabSwitch&&BoldBIDashboard.DashboardUtil.invokeMethod(BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.dashboardDesigner.element.find("#"+e.targetTag)),e.method,e.paramsOldVal),this.dashboardDesigner.modules.serialization.notifyChange()},e.prototype.updateToolbar=function(){var e=this.dashboardDesigner,t=this.dashboardDesigner.rptToolbar;BoldBIDashboard.isNullOrUndefined(t)||(t.showUndo(this.isUndo()),t.showRedo(this.isRedo()),t.updateRptTextActions()),e.updateFileStatus(this.hasItemChanges())},e.prototype.clearRedo=function(){this.stack=this.stack.slice(0,this.currentIndex+1),this.lastSavedActionIndex>this.stack.length-1&&(this.lastSavedActionIndex=-1)},e.prototype.addCmdAction=function(e,t,i,a,o,s){e={action:e,method:t,itemType:i,paramsNewVal:s,paramsOldVal:o,targetTag:a};this.isMergeAction&&!this.isPerformAction?this.mergeAction.push(e):this.cmdAction(e)},e.prototype.hasItemChanges=function(){return this.currentIndex!==this.lastSavedActionIndex},e.prototype.reset=function(){this.currentIndex=-1,this.isPerformAction=!1,this.stack=[],this.updateToolbar()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.UndoManager",InternalUndoManager,window),InternalKPIWindow=function(){function e(e){this.dashboardDesigner=null,this.callMethod="",this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.id=this.dashboardDesigner._id,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.renderkpiWindow(),this.wireEvents()}return e.prototype.openkpiDialog=function(e,t,i,a){this.callInstance=t,this.callMethod=i,this.isKpiEdit=a,BoldBIDashboard.isNullOrUndefined(e)?(this.kpiDataValueField=null,this.kpiVal=null,this.isDisplayColumnNameEdited=!1):(this.kpiDataValueField=e,this.kpiVal=e.KPIColumnInfo,this.isDisplayColumnNameEdited=this.kpiVal.IsDisplayColumnNameEdited),this.setActualType(),this.setTargetValues(),this.setValueType(),this.setResultValues(),this.setBackgroundCheckbox(),this.setColumnName(),BoldBIDashboard.DashboardUtil.buttonEnable(this.kpiDialog.find("#"+this.id+"_kpi_btn_ok"),!0),this.kpiDialog.data("BoldBIDashboardDialog").open()},e.prototype.getValueType=function(){return BoldBIDashboard.DashboardUtil.ConvertEnumasKeyValuePairArray(KpiCalculationType)},e.prototype.setValueType=function(){var e=this.getValueType();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").selectItemByValue(e[0].value)):(this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.kpiVal.KpiCalculationType))},e.prototype.getResultValues=function(){return BoldBIDashboard.DashboardUtil.ConvertEnumasKeyValuePairArray(IndicationType)},e.prototype.setResultValues=function(){var e=this.getResultValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").selectItemByValue(e[0].value)):(this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.kpiVal.Indication))},e.prototype.setTargetValues=function(){var e=this.getValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").selectItemByValue(e[0].value)):(this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.callInstance.getActualTargetDropdownValueBasedOnKPI(this.kpiVal.TargetColumn)))},e.prototype.getValues=function(){var e=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo;return this.getSourceData(e)},e.prototype.setActualType=function(){var e=this.getValues();BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").selectItemByValue(e[0].value)):(this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").setModel({dataSource:e}),this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList").selectItemByValue(this.callInstance.getActualTargetDropdownValueBasedOnKPI(this.kpiVal.ActualColumn)))},e.prototype.setBackgroundCheckbox=function(){BoldBIDashboard.isNullOrUndefined(this.kpiVal)?this.kpiDialog.find("#"+this.id+"_kpiCheck").BoldBIDashboardCheckBox({checked:!1}):this.kpiDialog.find("#"+this.id+"_kpiCheck").BoldBIDashboardCheckBox({checked:this.kpiVal.SetBackground})},e.prototype.setColumnName=function(){BoldBIDashboard.isNullOrUndefined(this.kpiVal)?(this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").attr("placeholder",this.dashboardDesigner.getLocalizationContent().common.auto),this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val("")):this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val(this.kpiVal.IsDisplayColumnNameEdited?this.kpiVal.DisplayColumnName:"")},e.prototype.textKeyUp=function(e){13===e.keyCode&&this.onColumnNameChange(e)},e.prototype.textFocusOut=function(e){this.onColumnNameChange(e)},e.prototype.onColumnNameChange=function(e){BoldBIDashboard.isNullOrUndefined(e)||(e=this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val(),BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(e)?(this.isDisplayColumnNameEdited=!1,this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val("")):this.isDisplayColumnNameEdited=!0)},e.prototype.getSourceData=function(e){var t,i,a,o,s=[];if(!BoldBIDashboard.isNullOrUndefined(e.FieldContainers)&&0<e.FieldContainers.length)for(t=e.FieldContainers,i=0;i<t.length;i++)for(a=0;a<t[i].FieldInfos.length;a++)(o=t[i].FieldInfos)[a].FieldType===FieldType.Measures&&o[a].SummaryType!==SummaryType.NONE&&(o[a].IsKPIColumn||s.push({text:o[a].DisplayName,value:o[a].UniqueColumnName,name:o[a].Name}),o=o[a],this.widgetHelper.getCurrentWidgetInstance(),this.callInstance.isPOPConfigured(o))&&(s.push({text:BoldBIDashboard.DashboardUtil.encodeText(o.DisplayName)+"_Primary",value:o.UniqueColumnName+"_Primary",name:BoldBIDashboard.DashboardUtil.encodeText(o.DisplayName)+"_Primary"}),s.push({text:BoldBIDashboard.DashboardUtil.encodeText(o.DisplayName)+"_Secondary",value:o.UniqueColumnName+"_Secondary",name:BoldBIDashboard.DashboardUtil.encodeText(o.DisplayName)+"_Secondary"}));return s},e.prototype.renderkpiWindow=function(){this.kpiDialog=BoldBIDashboard.buildTag("div.e-kpidialog","",{"padding-left":"18px","padding-right":"18px"},{id:this.id+"_kpiWindowDiv",title:"KPI Expression"}),this.kpiDialog.BoldBIDashboardDialog({enableResize:!1,showRoundedCorner:!0,enableModal:!0,minWidth:400,minHeight:370,height:"auto",width:"auto",showOnInit:!1,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"e-designer-kpidialog boldbi-dashboarddesigner bbi-designer-dialog",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.dashboardDesigner.getLocalizationContent().dialogOptions.closeButtonText});var e=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_table_id"}),t=BoldBIDashboard.buildTag("table.e-designer-table","",{width:"100%"},{unselectable:"on"}),i=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),a=BoldBIDashboard.buildTag("td","",{}),o=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Column Name",{"font-size":"12px","font-color":"#303541"},{type:"label"}),s=BoldBIDashboard.buildTag("td","",{"padding-left":"98px"}),n=BoldBIDashboard.buildTag("input.e-textbox","",{width:"201px",height:"25px"},{id:this.id+"_EditcolumnNamesValue",type:"text"}),r=(n.attr("placeholder",this.dashboardDesigner.getLocalizationContent().common.auto),BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"})),d=BoldBIDashboard.buildTag("td","",{}),l=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Actual Value",{"font-size":"12px","font-color":"#303541"},{type:"label"}),h=BoldBIDashboard.buildTag("td","",{"padding-left":"107px"}),p=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_actual_drop"}),c=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),u=BoldBIDashboard.buildTag("td","",{}),b=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Target Value",{"font-size":"12px","font-color":"#303541"},{type:"label"}),g=BoldBIDashboard.buildTag("td","",{"padding-left":"106px"}),m=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_target_drop"}),f=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),D=BoldBIDashboard.buildTag("td","",{}),y=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Value Type",{"font-size":"12px","font-color":"#303541"},{type:"label"}),B=BoldBIDashboard.buildTag("td","",{"padding-left":"115px"}),I=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"_type_drop"}),x=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),_=BoldBIDashboard.buildTag("td","",{}),v=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Result",{"font-size":"12px","font-color":"#303541"},{type:"label"}),C=BoldBIDashboard.buildTag("td","",{"padding-left":"141px"}),w=BoldBIDashboard.buildTag("input.e-textbox","",{"text-align":"left",border:"1px solid","font-size":"13px"},{type:"text",id:this.id+"res_drop"}),T=BoldBIDashboard.buildTag("tr","",{"padding-top":"16px",display:"block"}),S=BoldBIDashboard.buildTag("td","",{"padding-left":"178px"}),k=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_kpiCheck"}),N=this.dashboardDesigner.element.find("#"+this.id+"_kpiWindowDiv_foot"),F=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.dashboardDesigner.getLocalizationContent().dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_kpi_btn_cancel",type:"button"}),O=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.dashboardDesigner.getLocalizationContent().dialogOptions.okButtonText,{float:"right"},{id:this.id+"_kpi_btn_ok",type:"button"});N.append(F).append(O),this.kpiDialog.append(e),e.append(t),t.append(i),i.append(a),a.append(o),i.append(s),s.append(n),t.append(r),r.append(d),d.append(l),r.append(h),h.append(p),t.append(c),c.append(u),u.append(b),c.append(g),g.append(m),t.append(f),f.append(D),D.append(y),f.append(B),B.append(I),t.append(x),x.append(_),_.append(v),x.append(C),C.append(w),t.append(T),T.append(S),S.append(k),p.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-actual bbi-designer-ejwidgets bbi-dbrd-control"}),m.BoldBIDashboardDropDownList({dataSource:[],fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-target bbi-designer-ejwidgets bbi-dbrd-control"}),I.BoldBIDashboardDropDownList({dataSource:this.getValueType(),fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-type bbi-designer-ejwidgets bbi-dbrd-control"}),w.BoldBIDashboardDropDownList({dataSource:this.getResultValues(),fields:{text:"text",value:"value"},enabled:!0,width:"214px",height:"28px",selectedIndex:0,showRoundedCorner:!1,cssClass:"e-designer-result bbi-designer-ejwidgets bbi-dbrd-control"}),k.BoldBIDashboardCheckBox({checked:!1,text:"Delta Background",cssClass:"e-designer-checkbox"}),n.on("blur",this.bbdesigner$.proxy(this.textFocusOut,this)),n.on("keyup",this.bbdesigner$.proxy(this.textKeyUp,this))},e.prototype.closeDialog=function(){this.kpiDialog.data("BoldBIDashboardDialog").close()},e.prototype.checkStatus=function(){return!!this.kpiDialog.find("#"+this.id+"_kpiCheck").data("BoldBIDashboardCheckBox").model.checked},e.prototype.getExpression=function(e,t,i){switch(KpiCalculationType[e]){case KpiCalculationType.AbsoluteVariation:return"["+t+" - "+i+"]";case KpiCalculationType.ActualValue:return"["+t+"]";case KpiCalculationType.PercentageOfTarget:return"[[("+t+")/("+i+")]* 100]";case KpiCalculationType.PercentageVariation:return"[([("+t+")/("+i+")]*100)-100]";case KpiCalculationType.ValueAndPercentage:return"("+t+")-("+i+")([([("+t+")/("+i+" )]*100)-100] )";default:return""}},e.prototype.updatekpiInfo=function(){BoldBIDashboard.DashboardUtil.buttonEnable(this.kpiDialog.find("#"+this.id+"_kpi_btn_ok"),!1);var e,t=this.kpiDialog.find("#"+this.id+"_actual_drop").data("BoldBIDashboardDropDownList"),i=this.kpiDialog.find("#"+this.id+"_target_drop").data("BoldBIDashboardDropDownList"),a=this.kpiDialog.find("#"+this.id+"_type_drop").data("BoldBIDashboardDropDownList"),o=this.kpiDialog.find("#"+this.id+"res_drop").data("BoldBIDashboardDropDownList"),t=t.getItemDataByValue(t.getSelectedValue())[0],i=i.getItemDataByValue(i.getSelectedValue())[0],a=a.getItemDataByValue(a.getSelectedValue())[0],o=o.getItemDataByValue(o.getSelectedValue())[0],s=this.checkStatus(),n=this.getExpression(a.value,t.text,i.text),r=new KpiInformation,d=(r.KpiCalculationType=a.value,r.Indication=o.value,r.KpiDisplayType=DisplayType.Value,r.SetBackground=s,/^(.*)(_Primary|_Secondary)$/),a=!BoldBIDashboard.isNullOrUndefined(t.value.match(d))&&0<t.value.match(d).length?t.value.match(d).filter(function(e){return!d.test(e)})[0]:t.value,o=!BoldBIDashboard.isNullOrUndefined(i.value.match(d))&&0<i.value.match(d).length?i.value.match(d).filter(function(e){return!d.test(e)})[0]:i.value;r.ActualColumn.UniqueColumnName=a,r.ActualColumn.CaptionName=t.name,r.TargetColumn.UniqueColumnName=o,r.TargetColumn.CaptionName=i.name,s=this.isDisplayColumnNameEdited?BoldBIDashboard.DashboardUtil.encodeText(this.kpiDialog.find("#"+this.id+"_EditcolumnNamesValue").val()):t.name+" Vs "+i.name,r.DisplayExpression=n,r.DisplayColumnName=s,r.IsDisplayColumnNameEdited=this.isDisplayColumnNameEdited,BoldBIDashboard.isNullOrUndefined(this.kpiDataValueField)?(e=BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.dataConfiguration,"createValueInfo")).UniqueColumnName=this.GetNewUniqeName():e=this.kpiDataValueField,e.IsKPIColumn=!0,e.Name=r.DisplayColumnName,e.ContainerName="KPIColumn",e.FieldType=FieldType.Measures,e.SummaryType=SummaryType.NONE,e.KPIColumnInfo=r,e.MeasureFormatting=this.getMeasureFormat(r.KpiCalculationType),e.DateTimeFormat=DateTimeFormat.None,e.DisplayName=r.DisplayColumnName,e.IsDisplayNameEdited=this.isDisplayColumnNameEdited,BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod,[e,this.isKpiEdit]),this.kpiDialog.data("BoldBIDashboardDialog").close()},e.prototype.GetNewUniqeName=function(){for(var e=this.callInstance.getKPIDataValueSet(),t=[],i=0;i<e.length;i++)t.push(parseInt(e[i].UniqueColumnName.match(/\d+/),10));return"kpicolumn_"+(0===t.length?0:Math.max.apply(null,t)+1)},e.prototype.getMeasureFormat=function(e){var t=new MeasureFormatting;switch(KpiCalculationType[e]){case KpiCalculationType.PercentageOfTarget:case KpiCalculationType.PercentageVariation:t.FormatType=DataValueFormat.Percentage,t.Unit=NumberFormat.Ones,t.DecimalPoints=0}return t},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_kpi_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.dashboardDesigner.element.on("click","#"+this.id+"_kpi_btn_ok",this.bbdesigner$.proxy(this.updatekpiInfo,this,this.isKpiEdit))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_kpi_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.dashboardDesigner.element.off("click","#"+this.id+"_kpi_btn_ok",this.bbdesigner$.proxy(this.updatekpiInfo,this,this.isKpiEdit))},e.prototype.destroy=function(){this.unWireEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_kpiWindowDiv"))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.KPIWindow",InternalKPIWindow,window),InternalEditFieldSettings=function(){function e(e){this.columnNameInfo=null,this.fieldSettingsDialog=null,this.individualContainer=null,this.individualScrollElement=null,this.targetInstance=null,this.targetMethod=null,this.footerTag=null,this.settingsContainer=null,this.lastModifiedTextInfo=null,this.locale=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.renderFieldSettingsWindow(),this.wireEvents()}return e.prototype.renderFieldSettingsWindow=function(){var e=this.fieldSettingsDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_fieldsSettings_Dialog"}),t=this.settingsContainer=BoldBIDashboard.buildTag("div","",{}),i=BoldBIDashboard.buildTag("div","",{display:"block"},{id:this.id+"_fieldsSettings_Dialog_edit"}),a=BoldBIDashboard.buildTag("div","",{height:"283px",width:"458px"},{}),o=(i.append(a),this.individualContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"262px",display:"block"},{id:this.id+"_fieldsSettings_Dialog_individual_container"})),s=BoldBIDashboard.buildTag("div","",{}),n=this.individualScrollElement=BoldBIDashboard.buildTag("div","",{height:"252px","padding-top":"5px","padding-bottom":"5px"},{id:this.id+"_fieldsSettings_Dialog_individual_elements"});s.append(n),o.append(s),this.renderHeaderElement(t),a.append(o),n=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_fieldsSettings_Dialog_cancel",type:"button"}),s=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_fieldsSettings_Dialog_ok",type:"button"}),t.append(i),e.append(t),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({title:this.locale.fieldsSettings.editFieldsSettings,width:"auto",height:"auto",minWidth:450,minHeight:320,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.bbdesigner$("#"+this.id+"_fieldsSettings_Dialog_foot"),this.footerTag.append(n,s),o.BoldBIDashboardScroller({height:"262px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},e.prototype.renderColumns=function(e){for(var t=0;t<this.columnNameInfo.length;t++)this.renderRowElement(e,this.columnNameInfo[t],t)},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.renderHeaderElement=function(e){var t=BoldBIDashboard.buildTag("div","",{"margin-top":"10px",display:"inline-block",width:"450px",height:"20px",padding:"0px 10px"},{id:this.id+"_FieldsSettings_Header"}),i=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"}),a=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px","font-weight":"bold",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis"});a.text("Name"),i.append(a),t.append(i),a=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"}),(i=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","font-weight":"bold","white-space":"nowrap","text-overflow":"ellipsis"})).text("Caption"),a.append(i),t.append(a),i=BoldBIDashboard.buildTag("div","",{width:"110px",float:"left"}),(a=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","font-weight":"bold","white-space":"nowrap","text-overflow":"ellipsis"})).text("Show No Data Item"),i.append(a),t.append(i),e.append(t)},e.prototype.renderRowElement=function(e,t,i){var a=BoldBIDashboard.buildTag("div","",{"margin-top":"10px",display:"inline-block",width:"450px",padding:"0px 10px"},{id:this.id+"_fieldsSettings_Dialog_rowElement"+i}),o=BoldBIDashboard.buildTag("div","",{width:"170px",float:"left"}),s=BoldBIDashboard.buildTag("div.bbi-designer-fontfamily","",{"font-size":"12px",overflow:"hidden","white-space":"nowrap","text-overflow":"ellipsis","margin-top":"8.5px"});s.text(t.CaptionName),o.append(s),a.append(o),s=BoldBIDashboard.buildTag("div","",{display:"inline-block",border:"0px solid","border-color":"red",float:"left",width:"170px"},{id:this.id+"_fieldsSettings_Dialog_Value"+i+"_parent"}),o=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-content-label","",{width:"157px",height:"25px"},{id:this.id+"_fieldsSettings_Dialog_Value"+i,type:"text"}),t.IsEdited?o.val(t.DisplayName):o.attr("placeholder",this.locale.common.auto),s.append(o),o.off("blur",this.bbdesigner$.proxy(this.textFocusOut,this,i)),o.off("keyup",this.bbdesigner$.proxy(this.textKeyUp,this,i)),o.on("blur",this.bbdesigner$.proxy(this.textFocusOut,this,i)),o.on("keyup",this.bbdesigner$.proxy(this.textKeyUp,this,i)),a.append(s),o=BoldBIDashboard.buildTag("div","",{display:"inline-block",border:"0px solid","border-color":"red",float:"left","margin-left":"50px"},{id:this.id+"_EditNoDataItemValue"+i+"_parent"}),s=BoldBIDashboard.buildTag("input","",{"margin-top":"2px"},{id:this.id+"_EditNoDataItemValue"+i,type:"checkbox"}),o.append(s),s.BoldBIDashboardCheckBox({checked:t.ShowNoDataItem,width:"30px",cssClass:"e-designer-prop-checkbox",change:this.bbdesigner$.proxy(this.noDataItemChange,this,i)}),a.append(o),e.append(a)},e.prototype.textFocusOut=function(e){var t=this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+e).val();this.lastModifiedTextInfo=null,this.onValueChange(e,t)},e.prototype.onValueChange=function(e,t){var i=!BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(t);this.columnNameInfo[e].DisplayName!==t&&i&&(this.columnNameInfo[e].IsEdited=!0),i?this.columnNameInfo[e].DisplayName=t:(this.columnNameInfo[e].DisplayName=this.columnNameInfo[e].CaptionName,this.columnNameInfo[e].IsEdited=!1,this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+e).val(this.columnNameInfo[e].IsEdited?this.columnNameInfo[e].CaptionName:""),this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+e).attr("placeholder",this.locale.common.auto))},e.prototype.textKeyUp=function(e,t){var i=this.settingsContainer.find("#"+this.id+"_fieldsSettings_Dialog_Value"+e).val();13===t.keyCode?this.onValueChange(e,i):this.lastModifiedTextInfo={rowIndex:e,value:i}},e.prototype.noDataItemChange=function(e,t){this.columnNameInfo[e].ShowNoDataItem=t.isChecked},e.prototype.populateColumnName=function(){this.renderColumns(this.individualScrollElement),this.scrollerRefresh(this.individualContainer)},e.prototype.updateColumnInfo=function(){BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.isNullOrUndefined(this.lastModifiedTextInfo)||(this.onValueChange(this.lastModifiedTextInfo.rowIndex,this.lastModifiedTextInfo.value),this.lastModifiedTextInfo=null),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.columnNameInfo]),this.fieldSettingsDialog.data("BoldBIDashboardDialog").close())},e.prototype.closeFieldSettings=function(){this.fieldSettingsDialog.data("BoldBIDashboardDialog").close()},e.prototype.openFieldSettings=function(e,t,i){this.fieldSettingsDialog.data("BoldBIDashboardDialog").open(),this.resetLengendSettings(),this.targetInstance=e,this.targetMethod=t,this.columnNameInfo=JSON.parse(JSON.stringify(i)),this.populateColumnName(this.columnNameInfo)},e.prototype.resetLengendSettings=function(){this.targetInstance=null,this.targetMethod=null,this.columnNameInfo=null,this.individualScrollElement.empty()},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_fieldsSettings_Dialog_cancel",this.bbdesigner$.proxy(this.closeFieldSettings,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_fieldsSettings_Dialog_ok",this.bbdesigner$.proxy(this.updateColumnInfo,this))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.EditFieldSettings",InternalEditFieldSettings,window),InternalCreateCategoryDialog=function(){function e(e,t){this.locale=null,this.designerInstance=e,this.bbdesigner$=this.designerInstance.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.designerInstance._id+"_create_category_dlg",this.callBackFn=t,this.renderDialog(),this.unwireEvents(),this.wireEvents()}return e.prototype.renderDialog=function(){0!==this.designerInstance.element.find("#"+this.id+"_dialog").length&&this.dispose();var e=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect bbi-designer-category-dlg","",{height:"auto","border-left":"none","background-color":"var(--designer-background)"},{title:this.locale.alertDialogTitle.NewCategory,id:this.id+"_dialog"}),t=BoldBIDashboard.buildTag("div","",{height:"100%",width:"100%"},{id:this.id+"_dialog_content"}),i="<table style='width:100%;height:90%;border-collapse:collapse;' cellspacing='0' cellpadding='0'><tr><td class='bbi-category-name-row-td' style='width:15%;vertical-align:middle;'><label class='bbi-designer-label' style='vertical-align:top;'>"+this.locale.createCategoryDialog.nameLabelText+" * </label></td><td class='bbi-category-name-row-td' style='width:75%'><input type=\"text\" style='width:95%;'  id='"+this.id+"_data_source_name' class='e-textbox e-designer-category-name-text'/></td></tr><tr style='height: 15px'><td></td><td><label style='display:none;' class='bbi-designer-tile-content bbi-designer-errorLog'>"+this.locale.createCategoryDialog.emptyCategoryNameLabelText+"</label>    </td> </tr>       <tr>      <td style='width:15%;vertical-align:middle;'><label class='bbi-designer-label' style='' >"+this.locale.createCategoryDialog.descriptionLabelText+"</label></td>    <td>       <textarea style='width:95%;resize:none;text-indent:0px;' id='"+this.id+"_data_source_description' class='e-textarea e-ejinputtext bbi-designer-content-label bbi-designer-constr-textarea e-category-desc-box'></textarea></td></tr><tr><td></td><td><label class='bbi-designer-tile-content'>"+this.locale.createCategoryDialog.descriptionMaxLengthText+"</label>        </td>     </tr></table>",a=BoldBIDashboard.buildTag("label.bbi-designer-label bbi-dbrd-browse-category-msg bbi-dbrd-designer-hoverable",this.locale.alertWindowMesages.createCategoryMessage,{float:"left",color:"#a94442","line-height":2},{id:this.id+"_alertMsg_label"}),o=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.createCategoryDialog.saveButtonText,{float:"right"},{id:this.id+"_save_btn",type:"button",disabled:"disabled"}),s=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.createCategoryDialog.cancelButtonText,{float:"right"},{id:this.id+"_cancel_btn",type:"button"});t.html(i),e.append(t),this.designerInstance.element.append(e),this.dialog=e.BoldBIDashboardDialog({enableModal:!0,width:600,maxWidth:600,maxHeight:300,enableResize:!1,showOnInit:!1,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",containment:"#"+this.designerInstance._id,target:"#"+this.designerInstance._id,height:300,showFooter:!0,close:this.bbdesigner$.proxy(this.dialogClosing,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.designerInstance.element.find("#"+this.id+"_dialog_foot").append(a,s,o),this.categoryNameEle=t.find("#"+this.id+"_data_source_name"),this.categoryDescEle=t.find("#"+this.id+"_data_source_description"),this.waitingPopup=this.designerInstance.element.find("#"+this.id+"_dialog_wrapper").BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.designerInstance.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},e.prototype.saveButtonClick=function(){var e=this.categoryNameEle.val().trim(),t=this.categoryDescEle.val();this.designerInstance.element.find("#"+this.id+"_dialog_foot .bbi-dbrd-browse-category-msg").hide(),this.designerInstance.modules.util.doAjaxPost("POST",this.designerInstance.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.createcategory,{action:BoldBIDashboard.DashboardUtil.DesignerAction.CreateCatogory,data:JSON.stringify({name:e,description:t})},{indicator:[this.bbdesigner$.proxy(this.showWaitingPopup,this),this.bbdesigner$.proxy(this.hideWaitingPopup,this)],fnction:this.bbdesigner$.proxy(this.onSuccess,this)},!0,!0)},e.prototype.showWaitingPopup=function(){this.waitingPopup.show()},e.prototype.hideWaitingPopup=function(){this.waitingPopup.hide()},e.prototype.cancelButtonClick=function(){this.dialog.close()},e.prototype.dialogClosing=function(e){this.waitingPopup.hide(),e.model.position={X:0,Y:0}},e.prototype.dispose=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.designerInstance.element.find("#"+this.id+"_dialog_wrapper"),!0),this.designerInstance.element.find("#"+this.id+"_dialog").remove(),this.unwireEvents()},e.prototype.onSuccess=function(e){var t=this.designerInstance.element.find("#"+this.id+"_dialog_foot");e.Status?(t.find(".bbi-dbrd-browse-category-msg").hide(),this.dialog.close(),this.designerInstance.modules.fileBrowse.browseDialog.data("BoldBIDashboardDialog").open(),this.designerInstance.modules.fileBrowse.reloadCategory(this.categoryNameEle.val().trim())):(e=this.getErrorMessage(e.StatusCode,e.Message),t.find(".bbi-dbrd-browse-category-msg").attr("data-tooltip",e).text(e).show())},e.prototype.getErrorMessage=function(e,t){return t="2021"===e?this.locale.createCategoryDialog.noCreatePermission:t},e.prototype.showDialog=function(e){var t=this.designerInstance.element.find("#"+this.id+"_dialog_foot");BoldBIDashboard.isNullOrUndefined(e)&&e?t.find(".bbi-dbrd-browse-category-msg").show():t.find(".bbi-dbrd-browse-category-msg").hide(),this.dialog.open()},e.prototype.categoryNameValidation=function(){var e,t=this.categoryNameEle.val().trim();this.dialog.element.find(".bbi-designer-errorLog").hide(),this.categoryNameEle.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.buttonEnable(this.designerInstance.element.find("#"+this.id+"_save_btn"),!0),e=this.designerInstance.nameValidation(t)?this.locale.createCategoryDialog.emptyCategoryNameLabelText:this.locale.browseDialogMessages.dashboardNameErrorMsg+'* | / : < > , % ; \\ " + & ? #',""!==t&&this.designerInstance.nameValidation(t)||(this.dialog.element.find(".bbi-designer-errorLog").html(e).show(),this.categoryNameEle.addClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.buttonEnable(this.designerInstance.element.find("#"+this.id+"_save_btn"),!1))},e.prototype.handleCategoryNameTimeout=function(){var e=this;clearTimeout(this.categoryNameTimeout),this.categoryNameTimeout=setTimeout(function(){e.categoryNameValidation()},200)},e.prototype.wireEvents=function(){this.designerInstance.element.on("keyup",".e-designer-category-name-text",this.bbdesigner$.proxy(this.handleCategoryNameTimeout,this)),this.designerInstance.element.on("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.saveButtonClick,this)),this.designerInstance.element.on("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelButtonClick,this))},e.prototype.unwireEvents=function(){this.designerInstance.element.off("keyup",".e-designer-category-name-text",this.bbdesigner$.proxy(this.handleCategoryNameTimeout,this)),this.designerInstance.element.off("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.saveButtonClick,this)),this.designerInstance.element.off("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelButtonClick,this))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.CreateCategoryDialog",InternalCreateCategoryDialog,window),InternalColorCustomizationAdvanceSettings=function(){function e(e){this.dashboardDesigner=null,this.colorFields=[],this.isMeasure=!0,this.measureFields=[],this.dimensionFields=[],this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id+"_color_customization_advance_settings",this.renderAdvanceSettingWidnow(),this.wireEvents(),this.multiSelectionComboBox=this.dashboardDesigner.modules.colorCustomizationInclusionSelection,this.dataSet=this.dashboardDesigner.modules.dataSet}return e.prototype.renderAdvanceSettingWidnow=function(){this.dialogDiv=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id}),e=BoldBIDashboard.buildTag("div.bbi-userselect bbi-color-custom-advance-container bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_advance_settings_container"}),this.contentDiv=BoldBIDashboard.buildTag("div.bbi-color-custom-advance-content","",{},{id:this.id+"_advance_settings_content"}),this.headerRow=BoldBIDashboard.buildTag("div.bbi-color-custom-header-field","",{display:"none"},{}),this.conditionContainer=BoldBIDashboard.buildTag("div.bbi-advance-condition-container","",{},{}),this.contentDiv.append(this.headerRow,this.conditionContainer),e.append(this.contentDiv),this.dialogDiv.append(e),this.dashboardDesigner.element.append(this.dialogDiv),this.dialogObj=this.dialogDiv.BoldBIDashboardDialog({title:this.locale.colorCustomBasicLocale.advanceText,width:830,height:"auto",minWidth:830,minHeight:530,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,enableAnimation:!1,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog");var e,t=this.dashboardDesigner.element.find("#"+this.id+"_foot"),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_advance_settings_cancel",type:"button"}),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.dialogOptions.saveButtonText,{float:"right"},{id:this.id+"_advance_settings_save",type:"button"});t.append(i,a),a.off("click",this.bbdesigner$.proxy(this.saveBtnClick,this)),i.off("click",this.bbdesigner$.proxy(this.dialogClose,this)),a.on("click",this.bbdesigner$.proxy(this.saveBtnClick,this)),i.on("click",this.bbdesigner$.proxy(this.dialogClose,this)),t=[{id:SummaryType.SUM,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.SUM)},{id:SummaryType.AVG,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.AVG)},{id:SummaryType.COUNT,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.COUNT)},{id:SummaryType.MIN,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.MIN)},{id:SummaryType.MAX,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.MAX)},{id:SummaryType.COUNTD,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.COUNTD)},{id:SummaryType.VAR,text:this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(SummaryType.VAR)}],a=[{text:"Value"},{text:"Percent"}],this.renderDrpDwn(this.headerRow.find(".e-adance-basedon-drpdwn"),null),this.renderDrpDwn(this.headerRow.find(".e-adance-aggregation-drpdwn"),t),this.renderDrpDwn(this.headerRow.find(".e-adance-format-drpdwn"),a),this.ejWaitingIndicator=e.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup"),e.BoldBIDashboardScroller({height:"493px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.scrollerObj=e.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(this.dialogObj)||this.dialogObj.open(),BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh()},e.prototype.renderBasedOnTemplate=function(){return"<div class='bbi-header-field-wrap e-header-basedon-div'><label class ='e-custom-color-basedon-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.basedOn+"</label><div class='e-adance-basedon-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_basedon-drpdwn type='text' class ='e-adance-basedon-drpdwn'/></div></div>"},e.prototype.renderAggregationTemplate=function(){return"<div class='bbi-header-field-wrap e-header-aggregation-div'><label class ='e-custom-color-aggregation-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.aggregation+"</label><div class='e-adance-aggregation-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_aggregation-drpdwn type='text' class ='e-adance-aggregation-drpdwn'/></div></div>"},e.prototype.renderFormatTemplate=function(){return"<div class='bbi-header-field-wrap e-header-format-div'><label class ='e-custom-color-format-label e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.formatText+"</label><div class='e-adance-format-drpdwn-wrap e-header-row-element'><input id="+this.id+"_advance_dlg_format-drpdwn type='text' class ='e-adance-format-drpdwn'/></div></div>"},e.prototype.renderNumberFormattingTemplate=function(){return"<div class='bbi-header-field-wrap e-header-number-formating-div'><div class ='e-custom-color-numberformat-icon bbi-designer-number-format-settings e-header-row-element'></div><div class='bbi-adance-numberformat-wrap e-header-row-element'>"+this.locale.colorCustomAdvanceLocale.numberFormating+"</div></div>"},e.prototype.renderDrpDwn=function(e,t){e.BoldBIDashboardDropDownList({fields:{text:"text",value:"text"},dataSource:t,selectedIndex:0,width:"120px",height:"28px",change:this.bbdesigner$.proxy(this.onDropDownChange,this),cssClass:"bbi-designer-ejwidgets bbi-dbrd-control"})},e.prototype.onDropDownChange=function(){var e,t,i;if(!this.isMeasure){e=this.dialogDiv.find(".bbi-condition-inclusion-value-dimension"),this.dialogDiv.find("#"+e.attr("id")+"_multi_select_dropDown_text").html(this.locale.colorCustomAdvanceLocale.selectAny);for(var a=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList"),o=a.getSelectedValue(),a=a.getSelectedItem(),s=this.bbdesigner$(a).text(),n=0;n<e.length;n++)t=this.bbdesigner$(e[n]).attr("id"),i=this.multiSelectionComboBox.getMultiSelectionComboBox(t),this.multiSelectionComboBox.resetMultiSelectionComboInfo(t),i.attr({"data-fieldValue":o,"data-fieldText":s})}},e.prototype.openFormatDialog=function(){var t=this,e=[];e.formatProperties=this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?new MeasureFormatting:this.internalAdvanceModeObj.MeasureFormatSettings,this.dashboardDesigner.modules.formatDialog.openFormatDialog(e,null,function(e){t.measureFormating={Culture:e.formatProperties.Culture,DecimalPoints:e.formatProperties.DecimalPoints,FormatType:e.formatProperties.FormatType,Unit:e.formatProperties.Unit,DecimalSeparator:e.formatProperties.DecimalSeparator,GroupSeparator:e.formatProperties.GroupSeparator,Suffix:e.formatProperties.Suffix,Prefix:e.formatProperties.Prefix,EnableLakhsAndCroreRep:e.formatProperties.EnableLakhsAndCroreRep}})},e.prototype.renderConditiondiv=function(e,t,i){var a=BoldBIDashboard.buildTag("div.bbi-advanc-condition-wrap","",{},{"data-conditionId":this.dsId+"_condition_"+t,"data-condition-num":t}),o=BoldBIDashboard.buildTag("div.bbi-advanc-condition-content",this.getConditionField(t,i),{},{}),s=BoldBIDashboard.buildTag("div.bbi-advanc-color-field-content",this.getColorField(t,i),{},{});a.append(o,s),e.append(a),this.renderConditionTypeDropDwn(o.find(".e-condition-type-drpdwn"),t,i),this.renderColorFieldContents(s,i),this.conditionNumbers.push(t),this.renderCasesensitiveCheckbox(o.find(".bbi-color-custom-condition-close"),i),this.isMeasure?(o.find(".bbi-condition-value-start").css({display:"inline-block"}),BoldBIDashboard.isNullOrUndefined(i)||i.MeasureCondition!==CMeasureConditionType.CBetween&&i.MeasureCondition!==CMeasureConditionType.CNotBetween||o.find(".bbi-condition-value-end").css({display:"inline-block"}),o.find(".e-condition-value-dimension").css({display:"none"}),o.find(".bbi-condition-inclusion-value-dimension").css({display:"none"}),this.dialogDiv.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"none"})):(o.find(".bbi-condition-value-start").css({display:"none"}),o.find(".bbi-condition-value-end").css({display:"none"}),this.dialogDiv.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"inline-block","margin-top":"4px"}),BoldBIDashboard.isNullOrUndefined(i)||i.DimensionCondition!==CDimensionConditionType.Inclusion?(o.find(".bbi-condition-inclusion-value-dimension").css({display:"none"}),o.find(".e-condition-value-dimension").css({display:"inline-block"}),o.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"inline-block","margin-top":"4px"})):(o.find(".bbi-condition-inclusion-value-dimension").css({display:"inline-block"}),o.find(".e-condition-value-dimension").css({display:"none"}),o.find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+t).css({display:"none"})))},e.prototype.getConditionField=function(e,t){return"<div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-name-label'>"+this.locale.colorCustomAdvanceLocale.conditionNameLabel+"</label><input type='text' class='e-textbox bbi-condition-name-textbox' value='"+this.getConditionLabelName(e,t)+"'/></div><div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-type-label'>"+this.locale.colorCustomAdvanceLocale.conditionTypeLabel+"</label><div class='bbi-condition-type-drpdwn-wrap'><input id="+this.id+"_condition_type_drpdwn_"+e+" data-condition-number="+e+" type ='text' class= 'e-condition-type-drpdwn'/></div></div><div class= 'bbi-color-custom-condition-field-wrap'><label class = 'bbi-color-custom-condition-value-label'>"+this.locale.colorCustomAdvanceLocale.conditionValueLabel+"</label><input type='number' class='e-textbox bbi-condition-value-textbox bbi-condition-value-start' value ="+this.getStartRangeValue(t)+" placeholder ='Value here'/><input class='e-textbox bbi-condition-value-textbox e-condition-value-dimension' value ="+this.getDimensionValue(t)+" placeholder ='Name here'/><div id="+this.id+"_inclusion_"+e+" class='bbi-condition-inclusion-value-dimension' style='width:130px;'></div></div><div class= 'bbi-color-custom-condition-field-wrap'><div class = 'bbi-color-custom-condition-close'></div><input type='number' class='e-textbox bbi-condition-value-textbox bbi-condition-value-end' value ="+this.getEndRangeValue(t)+" placeholder ='To'/><div class ='bbi-color-select-warning' title ='"+this.locale.colorCustomAdvanceLocale.colorSelectErrMsg+"'></div><input type='checkbox' id="+this.id+"_casesensitive_checkbox_"+e+" class='e-textbox bbi-color-custom-condition-close'/></div>"},e.prototype.getConditionLabelName=function(e,t){return BoldBIDashboard.isNullOrUndefined(t)?this.locale.colorCustomAdvanceLocale.conditionText+e:t.RangeLabel},e.prototype.getStartRangeValue=function(e){return BoldBIDashboard.isNullOrUndefined(e)?"''":e.StartRange},e.prototype.getEndRangeValue=function(e){return BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.EndRange)?"''":e.EndRange},e.prototype.getDimensionValue=function(e){return BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.DimensionConditionalValue)||0===e.DimensionConditionalValue.length?"''":e.DimensionConditionalValue[0]},e.prototype.renderConditionTypeDropDwn=function(e,t,i){e.BoldBIDashboardDropDownList({fields:{text:"text",value:"value"},dataSource:this.isMeasure?this.getMeasureFiledTypeDS():this.getDimensionFiledTypeDS(),selectedIndex:BoldBIDashboard.isNullOrUndefined(i)?0:this.isMeasure?i.MeasureCondition:i.DimensionCondition,cssClass:"bbi-designer-ejwidgets bbi-dbrd-control",width:"130px",height:"28px",change:this.bbdesigner$.proxy(this.conditionDrpDwnChange,this,t,i),enabled:!0,showRoundedCorner:!0}),!this.isMeasure||BoldBIDashboard.isNullOrUndefined(i)||i.MeasureCondition!==CMeasureConditionType.CBetween&&i.MeasureConditon!==CMeasureConditionType.CNotBetween||e.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end").css("display","block")},e.prototype.conditionDrpDwnChange=function(e,t,i){this.isMeasure?this.measureConditionDrpDwnChange(e,i):this.DimensionConditionDrpDwnChange(e,t,i)},e.prototype.DimensionConditionDrpDwnChange=function(e,t,i){var a,o,s,n,r;BoldBIDashboard.isNullOrUndefined(i)||(a=(r=this.conditionContainer.find(".e-condition-type-drpdwn[data-condition-number ="+e+"]")).parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start"),o=r.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end"),s=r.parents(".bbi-advanc-condition-content").find(".e-condition-value-dimension"),n=r.parents(".bbi-advanc-condition-content").find(".bbi-condition-inclusion-value-dimension"),r=r.parents(".bbi-advanc-condition-content").find("#BoldBIDashboard"+this.id+"_casesensitive_checkbox_"+e),a.css("display","none"),o.css("display","none"),i.text===CDimensionConditionType[CDimensionConditionType.Inclusion]?(s.css("display","none"),n.css("display","block"),r.css("display","none")):(s.css("display","block"),n.css("display","none"),r.css({"margin-top":"4px"}),s.attr("placeholder",this.locale.colorCustomAdvanceLocale.nameHere)),a.val(""),o.val(""),s.val(""),n.val(""))},e.prototype.measureConditionDrpDwnChange=function(e,t){var i,a,o;BoldBIDashboard.isNullOrUndefined(t)||(i=(e=this.conditionContainer.find(".e-condition-type-drpdwn[data-condition-number ="+e+"]")).parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start"),a=e.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-end"),o=e.parents(".bbi-advanc-condition-content").find(".e-condition-value-dimension"),e=e.parents(".bbi-advanc-condition-content").find(".bbi-condition-inclusion-value-dimension"),o.css("display","none"),e.css("display","none"),o.val(""),e.val(""),t.selectedValue===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)||t.selectedValue===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)?(i.attr("placeholder",this.locale.colorCustomAdvanceLocale.from),a.css("display","block")):(i.attr("placeholder",this.locale.colorCustomAdvanceLocale.valueHere),a.css("display","none"),a.val("")))},e.prototype.getMeasureFiledTypeDS=function(){return[{text:"Greater than",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CGreaterThan)},{text:"Greater than or Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CGreaterThanOrEqualTo)},{text:"Less than",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CLessThan)},{text:"Less than or Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CLessThanOrEqalTo)},{text:"Equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CEquals)},{text:"Not equal to",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotEquals)},{text:"Between",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)},{text:"Not between",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)}]},e.prototype.getDimensionFiledTypeDS=function(){return[{text:"Starts With",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Startswith)},{text:"Ends With",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Endswith)},{text:"Contains",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Contains)},{text:"Not Contains",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.NotContains)},{text:"Equals",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.Equals)},{text:"Not Equals",value:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CDimensionConditionType,CDimensionConditionType.NotEquals)}]},e.prototype.renderCasesensitiveCheckbox=function(e,t){e.BoldBIDashboardCheckBox({text:this.locale.colorCustomAdvanceLocale.casesensitive,checked:!!BoldBIDashboard.isNullOrUndefined(t)||t.IsCaseSensitive})},e.prototype.getColorField=function(e){var t,i;for(this.colorFields=!BoldBIDashboard.isNullOrUndefined(this.colorFields)&&0<this.colorFields.length?this.colorFields:this.getDefaultColorFields(),t=null,i=0;i<this.colorFields.length;i++)t=BoldBIDashboard.isNullOrUndefined(t)?this.rendercolorFields(this.colorFields[i],e):t+this.rendercolorFields(this.colorFields[i],e);return t},e.prototype.getDefaultColorFields=function(){return[{Name:WidgetProperty.BackgroundColor,DisplayName:"Background",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.BorderColor,DisplayName:"Border",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.TitleColor,DisplayName:"Title",ColorPicker:ColorSetColorPickers.NormalColorPicker},{Name:WidgetProperty.FillColor,DisplayName:"Range",ColorPicker:ColorSetColorPickers.GradientColorPicker},{Name:WidgetProperty.Icon,DisplayName:"Icon",ColorPicker:ColorSetColorPickers.IconColorPicker}]},e.prototype.rendercolorFields=function(e,t){var i=e.Name===WidgetProperty.Icon?this.getIcon(e.Name,t):"";return e.Name===WidgetProperty.Font?"<div class='bbi-color-custom-color-field-wrap'>"+this.fontStyle(e.Name,t)+"</div>":"<div class='bbi-color-custom-color-field-wrap'>"+this.getCheckBox(e.Name,e.DisplayName,e.ColorPicker,t)+i+this.getColorPicker(e.Name,t,e.ColorPicker)+"</div>"},e.prototype.fontStyle=function(e,t){return"<div class='bbi-conditional-font'><span  id="+this.id+"_"+e+"_bold_"+t+" class='e-designer-font-bold-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-bold bbi-font-style-basic-styles' /><span  id="+this.id+"_"+e+"_Italic_"+t+" class='e-designer-font-italic-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-italic bbi-font-style-basic-styles' /><span  id="+this.id+"_"+e+"_Underline_"+t+" class='e-designer-font-underline-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-underline bbi-font-style-basic-styles' /><span id="+this.id+"_"+e+"_StrikeThrough_"+t+" class='e-designer-font-strike-icon bbi-designer-font-style-icons bbi-dbrd-designer-hand-cursor e-font-strikethrough bbi-font-style-basic-styles' /></div>"},e.prototype.getCheckBox=function(e,t,i,a){var o=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,e),i=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(ColorSetColorPickers,i);return"<div class= 'bbi-color-custom-color-field-chck-wrap'><input type='chekbox' id="+this.id+"_"+e+"_chkbox_"+a+" class='e-custom-color-checkbox' data-name='"+o+"'data-displayname='"+t+"'data-colorpicker='"+i+"'/></div>"},e.prototype.getIcon=function(e,t){return"<div class= 'bbi-color-custom-color-field-chck-wrap bbi-icon-custom-color-field'><input type='text' id="+ +this.id+"_"+e+"_drpdwn_"+t+" class='e-condition-icon-dropdown'/></div>"},e.prototype.getColorPicker=function(e,t,i){var a=e===WidgetProperty.Icon?"bbi-color-custom-color-field-colorpicker-wrap bbi-condition-icon-colorpicker-wrap":"bbi-color-custom-color-field-colorpicker-wrap",o="<div id="+this.id+"_range_colorpicker_"+t+" class='e-condition-range-colorpicker e-custom-colorpicker'></div>",e="<input type='text' id="+this.id+"_"+e+"_colorpicker_"+t+" class='e-custom-colorpicker'/>";return"<div class= '"+a+"'>"+(ColorSetColorPickers.GradientColorPicker===i?o:e)+"</div>"},e.prototype.renderColorFieldContents=function(e,t){for(var i,a,o=e.find(".bbi-color-custom-color-field-wrap"),s=e.find(".e-custom-color-checkbox"),n={},r=0;r<s.length;r++){var d=this.bbdesigner$(s[r]),l=d.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),h=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(ColorSetColorPickers,d.attr("data-colorpicker")),p=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,d.attr("data-name")),c=d.attr("data-name"),u=d.attr("data-displayname"),n=this.getCheckboxSelectionVal(t,p);1===s.length&&(n.isChecked=!0),d.BoldBIDashboardCheckBox({name:c,text:u,checked:n.isChecked,change:this.bbdesigner$.proxy(h===ColorSetColorPickers.GradientColorPicker?this.rangeCheckBoxChange:this.checkBoxChange,this)}),h===ColorSetColorPickers.NormalColorPicker?this.renderColorPicker(l,n,d,c):h===ColorSetColorPickers.GradientColorPicker?this.renderRangePalette(l,n):h===ColorSetColorPickers.IconColorPicker&&(this.renderColorPicker(l,n,d,c),this.renderIconFieldDropDownContent(e.find(".e-condition-icon-dropdown"),n)),n.isChecked||(u=l.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(u))||u.disable()}for(i=0;i<o.length;i++)0<(a=this.bbdesigner$(o[i]).find(".bbi-conditional-font")).length&&(p=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,"Font"),n=this.getCheckboxSelectionVal(t,p),this.updateFontStyleSelection(n,a))},e.prototype.updateFontStyleSelection=function(e,t){e.isBold&&t.find(".e-font-bold").addClass("bbi-designer-fontstyle-selection"),e.isItalic&&t.find(".e-font-italic").addClass("bbi-designer-fontstyle-selection"),e.isUnderline&&t.find(".e-font-underline").addClass("bbi-designer-fontstyle-selection"),e.isStrikeThrough&&t.find(".e-font-strikethrough").addClass("bbi-designer-fontstyle-selection")},e.prototype.colorChange=function(e,t,i){t===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,WidgetProperty.Icon)&&e.find(".bbi-icon-custom-color-field .e-selected-drpdwn-icon .e-icon-collection").css("color",this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(i.RGBA))},e.prototype.renderColorPicker=function(e,t,i,a){e.BoldBIDashboardColorPicker({value:t.startColorValue,cssClass:"bbi-designer-ejwidgets-colorpicker bbi-designer-content-label e-color-custom-colorpicker",select:this.bbdesigner$.proxy(this.colorChange,this,i.parents(".bbi-color-custom-color-field-wrap"),a),modelType:"palette",palette:"basicpalette",buttonMode:BoldBIDashboard.ButtonMode.Dropdown})},e.prototype.renderRangePalette=function(e,t){var i,a,o,s,n,r=e.attr("id");for(t.isGradient?this.bbdesigner$(e).attr({"data-type":"Gradient","data-startcolor":t.startColorValue,"data-endcolor":t.endColorValue}):this.bbdesigner$(e).attr({"data-type":"Flat","data-startcolor":t.startColorValue,"data-endcolor":""}),i="","Flat"===this.bbdesigner$(e).attr("data-type")&&(i=this.bbdesigner$(e).attr("data-startcolor")),"Gradient"===this.bbdesigner$(e).attr("data-type")&&(i="linear-gradient("+this.bbdesigner$(e).attr("data-startcolor")+","+this.bbdesigner$(e).attr("data-endcolor")+")"),e.css({height:"28px",border:"1px solid #B3B3B3","border-radius":"3px",display:"inline-block","box-sizing":"border-box"}),i="<div id="+r+"_rangeColor class='e-range-color' data-id="+r+" style='height:17px;width:17px;background: "+i+";float:left;border-radius:3px;top:4px;left:4px;position:relative;'></div><div id="+r+"_rangeArrow class='e-range-icon e-icon e-down-arrow' data-id="+r+" style ='height:14px;width:14px;float:right;margin: 7px 4px 0px 0px;border-radius: 4px;'></div>",a="<div id="+r+"_colorPicker class='e-color-picker' style='height:304px;width:246px;position:absolute;border:1px solid #FFFFFF;box-shadow: 0 4px 6px 0 rgba(0,0,0,0.16);display:none;background:#FFFFFF;'><div id="+r+"_colorType style='height:26.1px;width:230px;border:1px solid #CCCCCC;border-radius:3px;margin:10px 0px 15px 7px;'><div id="+r+"_flatType class='e-flat-type' data-id="+r+" style='height:26.1px;width:115px;line-height: 26.1px;border-radius:2px 1px 1px 2px;background-color:#EEEEEE;font-size: 12px;text-align:center;float: left;font-family: Heebo, Roboto, Segoe UI,Noto Sans,Ubuntu,Droid Sans,Helvetica Neue,Arial;'>Flat</div><div id="+r+"_gradientType class='e-gradient-type' data-id="+r+" style='height:26.1px;width:115px;line-height: 26.1px;font-size: 12px;text-align:center;float: right;font-family: Heebo, Roboto, Segoe UI,Noto Sans,Ubuntu,Droid Sans,Helvetica Neue,Arial;'>Gradient</div></div><div id="+r+"_flatColorPalette data-id="+r+" style='height:206px;width:154px;margin-left: 7px;display:block'></div><div id="+r+"_gradientColorPalette style='height:240px;width:230px;margin-left: 7px;display:none'></div></div>",this.bbdesigner$(e).append(i),this.dashboardDesigner.element.append(a),o=[{code:"linear-gradient(#FFB199 , #FF0844)",startValue:"#FFB199",endValue:"#FF0844"},{code:"linear-gradient(#00F2FE, #4FACFE)",startValue:"#00F2FE",endValue:"#4FACFE"},{code:"linear-gradient(#009EFD, #2AF598)",startValue:"#009EFD",endValue:"#2AF598"},{code:"linear-gradient(#AC32E4, #4801FF)",startValue:"#AC32E4",endValue:"#4801FF"},{code:"linear-gradient(#FBAB7E, #F7CE68)",startValue:"#FBAB7E",endValue:"#F7CE68"},{code:"linear-gradient(#424242, #7B7B7B)",startValue:"#424242",endValue:"#7B7B7B"},{code:"linear-gradient(#FEAFA8, #F5EFEF)",startValue:"#FEAFA8",endValue:"#F5EFEF"},{code:"linear-gradient(#C2E9FB, #A1C4FD)",startValue:"#C2E9FB",endValue:"#A1C4FD"},{code:"linear-gradient(#96E6A1, #D4FC79)",startValue:"#96E6A1",endValue:"#D4FC79"},{code:"linear-gradient(#FBC2EB, #A18CD1)",startValue:"#FBC2EB",endValue:"#A18CD1"},{code:"linear-gradient(#FBD397, #FFECD2)",startValue:"#FBD397",endValue:"#FFECD2"},{code:"linear-gradient(#F9F9F9, #D0CECE)",startValue:"#F9F9F9",endValue:"#D0CECE"},{code:"linear-gradient(#FE9A8B, #F78CA0)",startValue:"#FE9A8B",endValue:"#F78CA0"},{code:"linear-gradient(#9EFBD3, #45D4FB)",startValue:"#9EFBD3",endValue:"#45D4FB"},{code:"linear-gradient(#8DDAD5, #00CDAC)",startValue:"#8DDAD5",endValue:"#00CDAC"},{code:"linear-gradient(#7028E4, #E5B2CA)",startValue:"#7028E4",endValue:"#E5B2CA"},{code:"linear-gradient(#FFB199, #E78208)",startValue:"#FFB199",endValue:"#E78208"},{code:"linear-gradient(#C9CCD3, #E3E5E8)",startValue:"#C9CCD3",endValue:"#E3E5E8"},{code:"linear-gradient(#A445B2, #FF0066)",startValue:"#A445B2",endValue:"#FF0066"},{code:"linear-gradient(#00C6FB, #005BEA)",startValue:"#00C6FB",endValue:"#005BEA"},{code:"linear-gradient(#0BA360, #3CBA92)",startValue:"#0BA360",endValue:"#3CBA92"},{code:"linear-gradient(#764BA2, #667EEA)",startValue:"#764BA2",endValue:"#667EEA"},{code:"linear-gradient(#F09819, #FF5858)",startValue:"#F09819",endValue:"#FF5858"},{code:"linear-gradient(#596164, #868F96)",startValue:"#596164",endValue:"#868F96"},{code:"linear-gradient(#C43A30, #562E69)",startValue:"#C43A30",endValue:"#562E69"},{code:"linear-gradient(#0C3483, #6B8CCE)",startValue:"#0C3483",endValue:"#6B8CCE"},{code:"linear-gradient(#53957A, #013929)",startValue:"#53957A",endValue:"#013929"},{code:"linear-gradient(#2E0784, #7039E5)",startValue:"#2E0784",endValue:"#7039E5"},{code:"linear-gradient(#B12A5B, #5D1510)",startValue:"#B12A5B",endValue:"#5D1510"},{code:"linear-gradient(#485563, #29323C)",startValue:"#485563",endValue:"#29323C"}],n=0;n<30;n++)this.dashboardDesigner.element.find("#"+r+"_gradientColorPalette").append("<div class='e-gradient-color' data-id="+r+" style='width:24px;height:24px;border-radius:2px;float:left;margin: 5px 3px 17px 10px;background-image:"+o[n].code+";' data-startcolor="+o[n].startValue+" data-endcolor="+o[n].endValue+">");if(s=this.bbdesigner$(e).children(),!BoldBIDashboard.isNullOrUndefined(e))if(t.isChecked){for(this.bbdesigner$(e).prop("disabled",!1),n=0;n<s.length;n++)this.bbdesigner$(s[n]).prop("disabled",!1);this.bbdesigner$(e).removeClass("e-range-disable")}else{for(this.bbdesigner$(e).prop("disabled",!0),n=0;n<s.length;n++)this.bbdesigner$(s[n]).prop("disabled",!0);this.bbdesigner$(e).addClass("e-range-disable")}this.dashboardDesigner.element.find("#"+r+"_flatColorPalette").BoldBIDashboardColorPicker({value:t.startColorValue,displayInline:!0,modelType:"picker",change:this.bbdesigner$.proxy(this.onColorChange,this,e)}),t.isGradient&&(this.dashboardDesigner.element.find("#"+r+"_flatColorPalette").css("display","none"),this.dashboardDesigner.element.find("#"+r+"_flatType").css("background-color","#FFFFFF"),this.dashboardDesigner.element.find("#"+r+"_gradientColorPalette").css("display","block"),this.dashboardDesigner.element.find("#"+r+"_gradientType").css("background-color","#EEEEEE"))},e.prototype.onColorChange=function(e,t){this.bbdesigner$(e).attr({"data-startcolor":this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA),"data-type":"Flat"})},e.prototype.onRangeColorOpen=function(e){var t=this.bbdesigner$(e.target).attr("data-id")||this.bbdesigner$(e.target).attr("id");"none"===this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display")?this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display","block"):this.dashboardDesigner.element.find("#"+t+"_colorPicker").css("display","none"),this.setColorPalettePosition(t),e.stopPropagation(),this.bbdesigner$(document).on("click","body",this.bbdesigner$.proxy(this.onRangeColorClose,this,t))},e.prototype.setColorPalettePosition=function(e){var t=this.dashboardDesigner.element.find("#"+e),e=this.dashboardDesigner.element.find("#"+e+"_colorPicker"),i=t.offset(),a=this.bbdesigner$(document).scrollTop()+this.bbdesigner$(window).height()-(i.top+this.bbdesigner$(t).outerHeight()),o=i.top-this.bbdesigner$(document).scrollTop(),s=e.outerHeight(),n=e.outerWidth(),r=i.left,d=t.outerHeight(),l=(d-t.height())/2,h=this.getZindexPartial(t,e),a=(s<a||o<s?i.top+d+3:i.top-s-3)-l;this.bbdesigner$(document).scrollLeft()+this.bbdesigner$(window).width()-r<n&&n<r+t.outerWidth()&&(r-=e.outerWidth()-t.outerWidth()),e.css({left:r+"px",top:a+"px","z-index":h})},e.prototype.getZindexPartial=function(e,t){var i,a,o;if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)return a=e.parents(),o=this.bbdesigner$("body").children(),!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&o.splice(o.index(t),1),this.bbdesigner$(o).each(function(e,t){a.push(t)}),!(i=Math.max.apply(i,this.bbdesigner$.map(a,function(e){if("static"!==this.bbdesigner$(e).css("position"))return parseInt(this.bbdesigner$(e).css("z-index"))||1})))||i<1e4?i=1e4:i+=1,i},e.prototype.onRangeColorClose=function(e,t){var i=this.dashboardDesigner.element.find("#"+e);0!==this.bbdesigner$(t.target).parents(".e-color-picker").length&&!this.bbdesigner$(t.target).hasClass("e-gradient-selected")||(this.dashboardDesigner.element.find("#"+e+"_colorPicker").css("display","none"),t="","Flat"===this.bbdesigner$(i).attr("data-type")&&(t=this.bbdesigner$(i).attr("data-startcolor"),this.dialogDiv.find("#"+e+"_rangeColor").css("background",t)),"Gradient"!==this.bbdesigner$(i).attr("data-type"))||(t="linear-gradient("+this.bbdesigner$(i).attr("data-startcolor")+","+this.bbdesigner$(i).attr("data-endcolor")+")",this.dialogDiv.find("#"+e+"_rangeColor").css("background-image",t))},e.prototype.onGradientColor=function(e){var t="#"+this.bbdesigner$(e.target).attr("data-id");this.bbdesigner$(e.target).addClass("e-gradient-selected"),this.bbdesigner$(t).attr({"data-startcolor":this.bbdesigner$(e.target).attr("data-startcolor"),"data-endcolor":this.bbdesigner$(e.target).attr("data-endcolor"),"data-type":"Gradient"})},e.prototype.onGradientChange=function(e){e=this.bbdesigner$(e.target).attr("data-id");this.dashboardDesigner.element.find("#"+e+"_gradientColorPalette").css("display","block"),this.dashboardDesigner.element.find("#"+e+"_gradientType").css("background-color","#EEEEEE"),this.dashboardDesigner.element.find("#"+e+"_flatColorPalette").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_flatType").css("background-color","#FFFFFF")},e.prototype.onFlatChange=function(e){e=this.bbdesigner$(e.target).attr("data-id");this.dashboardDesigner.element.find("#"+e+"_flatColorPalette").css("display","block"),this.dashboardDesigner.element.find("#"+e+"_flatType").css("background-color","#EEEEEE"),this.dashboardDesigner.element.find("#"+e+"_gradientColorPalette").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_gradientType").css("background-color","#FFFFFF")},e.prototype.closeDialog=function(){this.dashboardDesigner.element.find(".e-color-picker").remove(),!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator()},e.prototype.rangeCheckBoxChange=function(e){var t,i=this.dialogDiv.find("#"+e.model.id).parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),a=this.bbdesigner$(i).children();if(!BoldBIDashboard.isNullOrUndefined(i))if(e.isChecked){for(this.bbdesigner$(i).prop("disabled",!1),t=0;t<a.length;t++)this.bbdesigner$(a[t]).prop("disabled",!1);this.bbdesigner$(i).removeClass("e-range-disable")}else{for(this.bbdesigner$(i).prop("disabled",!0),t=0;t<a.length;t++)this.bbdesigner$(a[t]).prop("disabled",!0);this.bbdesigner$(i).addClass("e-range-disable")}},e.prototype.getCheckboxSelectionVal=function(e,t){var i,a,o,s,n=!1,r="#0162FF",d="",l=!1,h=this.locale.colorCustomAdvanceLocale.downText,p=!1,c=!1,u=!1,b=!1;if(!BoldBIDashboard.isNullOrUndefined(e)&&!BoldBIDashboard.isNullOrUndefined(e.PropertyColorPair))for(a=e.PropertyColorPair,o=0;o<a.length;o++)(s=a[o]).WidgetProperties===t&&(n=!0,s.WidgetProperties===WidgetProperty.Icon?(r=s.Image.ImageColor,h=s.Image.ImageURL,i=s.Image.ImageType):s.WidgetProperties===WidgetProperty.FillColor?(r=s.RangeColor.StartColor,d=s.RangeColor.EndColor,l=s.RangeColor.IsGradient):s.WidgetProperties===WidgetProperty.Font?(p=s.FontStyle.IsBold,c=s.FontStyle.IsItalic,u=s.FontStyle.IsUnderLine,b=s.FontStyle.IsStrikeThrough):r=s.RangeColor.StartColor);return{isChecked:n,startColorValue:r,endColorValue:d,isGradient:l,selectedIcon:h,iconType:i,isBold:p,isItalic:c,isUnderline:u,isStrikeThrough:b}},e.prototype.checkBoxChange=function(e){var t=this.dialogDiv.find("#"+e.model.id),i=t.parents(".bbi-advanc-condition-wrap"),a=t.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker").data("BoldBIDashboardColorPicker");BoldBIDashboard.isNullOrUndefined(a)||(e.isChecked?(a.enable(),i.removeClass("e-color-select-err")):a.disable()),e.model.name===BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(WidgetProperty,WidgetProperty.Icon)&&(t=(a=t.parents(".bbi-color-custom-color-field-wrap").find(".e-condition-icon-dropdown")).data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(t)||(e.isChecked?(a.parent().removeClass("e-disable-selected-icondropdown"),t.enable(),i.removeClass("e-color-select-err"),this.selectIconByIndex(t)):(a.parent().addClass("e-disable-selected-icondropdown"),t.disable())))},e.prototype.selectIconByIndex=function(e){var t,i;if(!BoldBIDashboard.isNullOrUndefined(e)){for(t=e.items.length,i=0;i<t;i++)if(this.bbdesigner$(e.items[i]).hasClass("e-active"))return void e.selectItemByIndex(i);e.selectItemByIndex(0)}},e.prototype.saveBtnClick=function(){for(var e,t,i=[],a=this.dialogDiv.find(".bbi-advanc-condition-wrap"),o=0;o<a.length;o++){if(e=this.bbdesigner$(a[o]),e=this.colorRangeSettingsInfo(e),BoldBIDashboard.isNullOrUndefined(e))return;i.push(e)}t=this.getAggregationVal(),t=this.getBasedOnDrpDwnVal(t),this.internalAdvanceModeObj=0<a.length?{IsPercent:this.getFormatDrpdwnVal(a),BasedOn:t,Ranges:i,MeasureFormatSettings:this.measureFormating}:null,this.dialogClose(),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalAdvanceModeObj,this.selectedColumn])},e.prototype.getAggregationVal=function(){var e=this.dialogDiv.find(".e-adance-aggregation-drpdwn").data("BoldBIDashboardDropDownList");if(!BoldBIDashboard.isNullOrUndefined(e))return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SummaryType,e.getSelectedValue())},e.prototype.getBasedOnDrpDwnVal=function(e){var t,i=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList");return{UniqueColumnName:t=BoldBIDashboard.isNullOrUndefined(i)?t:i.getSelectedValue(),Key:t,SummaryType:e,SelectedColumnType:this.isMeasure?ColorColumnType.Measure:ColorColumnType.Dimension}},e.prototype.getFormatDrpdwnVal=function(){return!1},e.prototype.colorRangeSettingsInfo=function(e){var t,i,a,o,s=this.getPropertyColorPairValues(e);return this.isColorFieldErr(s,e)?null:this.isMeasure?(a=this.getMeasureConditionTypeVal(e),t=this.validateRange(!0,e),i=0,a!==CMeasureConditionType.CBetween&&a!==CMeasureConditionType.CNotBetween||(i=this.validateRange(!1,e)),0<e.find(".e-range-err").length?null:{StartRange:t,EndRange:i,RangeLabel:this.validateConditionName(e),MeasureCondition:a,PropertyColorPair:s}):(t=this.getDimensionConditionTypeVal(e),i=this.validateText(e,t),a=e.find(".bbi-color-custom-condition-close").data("BoldBIDashboardCheckBox"),o=[],""!==i&&(t===CDimensionConditionType.Inclusion?o=i.split(","):o.push(i)),0<e.find(".e-range-err").length?null:{RangeLabel:this.validateConditionName(e),PropertyColorPair:s,DimensionCondition:t,DimensionConditionalValue:o,IsCaseSensitive:a.isChecked()})},e.prototype.validateConditionName=function(e){return e.find(".bbi-condition-name-textbox").val()},e.prototype.isColorFieldErr=function(e,t){return 0===e.length?(t.addClass("e-color-select-err"),!0):(t.removeClass("e-color-select-err"),!1)},e.prototype.validateRange=function(e,t){var i=0,t=t.find(e?".bbi-condition-value-start":".bbi-condition-value-end");return""===t.val().trim()||e&&parseFloat(t.val())>parseFloat(t.attr("max"))||!e&&parseFloat(t.val())<parseFloat(t.attr("min"))?t.addClass("e-range-err"):(t.removeClass("e-range-err"),i=parseFloat(t.val().trim())),i},e.prototype.validateText=function(e,t){var i,a="";return t===CDimensionConditionType.Inclusion?""===(i=e.find("#"+e.find(".bbi-condition-inclusion-value-dimension").attr("id")+"_multi_select_dropDown_text")).html()||i.html()===this.locale.colorCustomAdvanceLocale.selectAny?e.find(".bbi-multiselect-dropdown-item").addClass("bbi-inclusion-err"):(e.find(".bbi-multiselect-dropdown-item").removeClass("bbi-inclusion-err"),a=i.html()):""===(i=e.find(".e-condition-value-dimension")).val()?i.addClass("e-range-err"):(i.removeClass("e-range-err"),a=i.val()),a},e.prototype.getMeasureConditionTypeVal=function(e){e=e.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(CMeasureConditionType,e.getSelectedValue())},e.prototype.getDimensionConditionTypeVal=function(e){e=e.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");return BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(CDimensionConditionType,e.getSelectedValue())},e.prototype.getPropertyColorPairValues=function(n){for(var r=[],d=n.find(".bbi-color-custom-color-field-wrap"),l=this,e=0;e<d.length;e++)!function(e){var t,i,a,e=l.bbdesigner$(d[e]),o=e.find(".bbi-conditional-font"),s=e.find(".e-custom-color-checkbox").data("BoldBIDashboardCheckBox");!BoldBIDashboard.isNullOrUndefined(s)&&s.isChecked()?((t=new PropertyColorPair).WidgetProperties=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,s.model.name),s=e.find(".e-custom-colorpicker").data("BoldBIDashboardColorPicker"),(i=l.colorFields.filter(function(e){return e.Name===t.WidgetProperties})[0]).ColorPicker===ColorSetColorPickers.GradientColorPicker?(e=e.find(".e-custom-colorpicker"),(a=new RangeColor).StartColor=l.bbdesigner$(e).attr("data-startcolor"),a.EndColor=l.bbdesigner$(e).attr("data-endcolor"),a.IsGradient="Gradient"===l.bbdesigner$(e).attr("data-type"),t.RangeColor=a):i.ColorPicker===ColorSetColorPickers.NormalColorPicker?BoldBIDashboard.isNullOrUndefined(s)||(t.RangeColor=l.getRangeColor(s)):i.ColorPicker===ColorSetColorPickers.IconColorPicker&&(t.Image=l.getImageSettings(s,n,l.getIconDrpdownVal(n))),r.push(t)):0<o.length&&((e=new PropertyColorPair).WidgetProperties=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(WidgetProperty,"Font"),(a=new FontSettings).IsBold=o.find(".e-font-bold").hasClass("bbi-designer-fontstyle-selection"),a.IsItalic=o.find(".e-font-italic").hasClass("bbi-designer-fontstyle-selection"),a.IsUnderLine=o.find(".e-font-underline").hasClass("bbi-designer-fontstyle-selection"),a.IsStrikeThrough=o.find(".e-font-strikethrough").hasClass("bbi-designer-fontstyle-selection"),(e.FontStyle=a).IsBold||a.IsItalic||a.IsUnderLine||a.IsStrikeThrough)&&r.push(e)}(e);return r},e.prototype.getIconDrpdownVal=function(e){var t=e.find(".e-condition-icon-dropdown");return BoldBIDashboard.isNullOrUndefined(t)||(t=t.attr("icon-type"),BoldBIDashboard.isNullOrUndefined(t))?(e=e.find(".e-condition-icon-dropdown").data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(e)?"":this.bbdesigner$(e.getSelectedItem()).attr("data-icon-id")):t},e.prototype.getRangeColor=function(e){var t=new RangeColor;return t.StartColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(e.getColor()),t},e.prototype.getImageSettings=function(e,t,i){var a=new ImageSettings;return BoldBIDashboard.isNullOrUndefined(e)||(a.ImageColor=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(e.getColor()),"custom"===(a.ImageURL=i)&&(e=t.find(".e-condition-icon-dropdown"),a.ImageType=ImageType[e.attr("data-type")],a.ImageURL=e.attr("data-value"))),a},e.prototype.dialogClose=function(){this.dialogObj.close()},e.prototype.renderAddConditionDiv=function(){return"<div class='bbi-color-custom-add-condition-wrap'><div class='bbi-color-custom-add-condition'>"+this.locale.colorCustomAdvanceLocale.addConditionText+"</div></div>"},e.prototype.removeCondition=function(e){var t=this.bbdesigner$(e.currentTarget).parents(".bbi-advanc-condition-wrap"),i=parseInt(t.attr("data-condition-num"),10);-1<this.conditionNumbers.indexOf(i)&&this.conditionNumbers.splice(this.conditionNumbers.indexOf(i),1),this.bbdesigner$(e.currentTarget).parents(".bbi-advanc-condition-wrap").remove(),this.removeImage(t),this.scrollerObj.refresh()},e.prototype.removeImage=function(e){var e=e.find(".bbi-icon-custom-color-field");0<e.length&&(e=e.find("input.e-condition-icon-dropdown"),BoldBIDashboard.isNullOrUndefined(e)||e.attr("data-type")===ImageType[ImageType.Embedded]&&0<Object.keys(this.dashboardDesigner.colorCustomIconStore).length&&delete this.dashboardDesigner.colorCustomIconStore[e.attr("data-value")])},e.prototype.addCondition=function(){for(var e=0;-1<this.conditionNumbers.indexOf(++e););this.renderConditiondiv(this.conditionContainer,e),BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh()},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_legend_settings")),0<this.dashboardDesigner.element.find("#"+this.id+"_legend_settings").length&&this.dashboardDesigner.element.find("#"+this.id+"_legend_settings").remove()},e.prototype.openAdvanceModeDlg=function(e,t,i){this.isMeasure=1!==i.selectedColumn.SelectedColumnType,this.resetFields(),this.targetInstance=e,this.targetMethod=t,this.selectedColumn=i.selectedColumn,this.colorFields=i.colorFields,this.dsId=i.selectedColumn.Key,this.datasetId=i.dataSetId,this.getMeasureFields(),this.getDimensionFields(),this.internalAdvanceModeObj=this.bbdesigner$.extend(!0,{},i.advancedColorSettings),this.conditionContainer.empty(),this.dialogObj.setTitle(this.locale.colorCustomBasicLocale.advanceText+" - "+e.selctedDisplayText),this.dialogObj.open(),this.populateInfo()},e.prototype.showLoadingIndicator=function(){this.dialogDiv.find("#"+this.id+"_advance_settings_container").data("BoldBIDashboardWaitingPopup").show()},e.prototype.hideLoadingIndicator=function(){this.dialogDiv.find("#"+this.id+"_advance_settings_container").data("BoldBIDashboardWaitingPopup").hide()},e.prototype.updateHeaderProperties=function(){var e,t;this.isMeasure?(this.dialogDiv.find(".e-header-format-div").css({display:"inline-block"}),this.dialogDiv.find(".e-header-aggregation-div").css({display:"inline-block"})):(this.dialogDiv.find(".e-header-format-div").css({display:"none"}),this.dialogDiv.find(".e-header-aggregation-div").css({display:"none"})),this.dialogDiv.find(".e-header-number-formating-div").css({display:"none"}),e=this.dialogDiv.find(".e-adance-basedon-drpdwn").data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(e)||(e.setModel({dataSource:this.isMeasure?this.measureFields:this.dimensionFields,fields:{text:"text",value:"value"},selectedIndex:"0"}),this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?e.selectItemByIndex(0):e.selectItemByValue(this.internalAdvanceModeObj.BasedOn.Key)),e=this.dialogDiv.find(".e-adance-aggregation-drpdwn").data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(e)||(this.bbdesigner$.isEmptyObject(this.internalAdvanceModeObj)?e.selectItemByIndex(0):e.selectItemByValue(this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(this.internalAdvanceModeObj.BasedOn.SummaryType))),e=this.dialogDiv.find(".e-adance-format-drpdwn").data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(e)||(t=this.internalAdvanceModeObj.IsPercent?BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(Format,Format.Percent):BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(Format,Format.Value),e.selectItemByValue(t))},e.prototype.getMeasureFields=function(){for(var e,t=[],i=0;i<this.dataSet.datasets.length;i++)if(this.dataSet.datasets[i].Id===this.datasetId)for(e=0;e<this.dataSet.datasets[i].Fields.length;e++)"Real"===this.dataSet.datasets[i].Fields[e].TypeName&&t.push({text:this.dataSet.datasets[i].Fields[e].DataField,value:this.dataSet.datasets[i].Fields[e].Id});this.measureFields=t},e.prototype.getDimensionFields=function(){for(var e,t=[],i=0;i<this.dataSet.datasets.length;i++)if(this.dataSet.datasets[i].Id===this.datasetId)for(e=0;e<this.dataSet.datasets[i].Fields.length;e++)"String"===this.dataSet.datasets[i].Fields[e].TypeName&&t.push({text:this.dataSet.datasets[i].Fields[e].DataField,value:this.dataSet.datasets[i].Fields[e].Id});this.dimensionFields=t},e.prototype.populateInfo=function(){this.showLoadingIndicator();var t=this;setTimeout(function(){if(t.updateHeaderProperties(),!BoldBIDashboard.isNullOrUndefined(t.internalAdvanceModeObj.Ranges)&&0<t.internalAdvanceModeObj.Ranges.length)for(var e=1;e<=t.internalAdvanceModeObj.Ranges.length;e++)t.renderConditiondiv(t.conditionContainer,e,t.internalAdvanceModeObj.Ranges[e-1]);else t.renderConditiondiv(t.conditionContainer,1,null);0===t.contentDiv.find(".bbi-color-custom-add-condition-wrap").length&&t.contentDiv.append(t.renderAddConditionDiv()),t.hideLoadingIndicator()},100)},e.prototype.resetFields=function(){this.internalAdvanceModeObj=new AdvancedSettings,this.conditionNumbers=[],this.targetInstance=null,this.targetMethod=null,BoldBIDashboard.isNullOrUndefined(this.contentDiv.find(".bbi-color-custom-add-condition-wrap"))||this.contentDiv.find(".bbi-color-custom-add-condition-wrap").remove()},e.prototype.setMinValue=function(e){var e=this.bbdesigner$(e.currentTarget),t=e.parents(".bbi-advanc-condition-wrap"),i=t.find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(i)||i.getSelectedValue()!==BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)&&i.getSelectedValue()!==BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)||t.find(".bbi-condition-value-end").attr("min",e.val())},e.prototype.setMaxValue=function(e){var e=this.bbdesigner$(e.currentTarget),t=e.parents(".bbi-advanc-condition-wrap").find(".e-condition-type-drpdwn").data("BoldBIDashboardDropDownList");BoldBIDashboard.isNullOrUndefined(t)||t.getSelectedValue()!==BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CBetween)&&t.getSelectedValue()!==BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(CMeasureConditionType,CMeasureConditionType.CNotBetween)||e.parents(".bbi-advanc-condition-content").find(".bbi-condition-value-start").attr("max",e.val())},e.prototype.wireEvents=function(){this.dialogDiv.on("click","bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-bold",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-italic",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-underline",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-strikethrough",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-color-custom-condition-close",this.bbdesigner$.proxy(this.removeCondition,this)),this.dialogDiv.on("click",".bbi-color-custom-advance-content .bbi-color-custom-add-condition-wrap",this.bbdesigner$.proxy(this.addCondition,this)),this.dialogDiv.on("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-start",this.bbdesigner$.proxy(this.setMinValue,this)),this.dialogDiv.on("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-end",this.bbdesigner$.proxy(this.setMaxValue,this)),this.dialogDiv.on("click",".e-condition-range-colorpicker, .e-range-color, .e-range-icon",this.bbdesigner$.proxy(this.onRangeColorOpen,this)),this.dashboardDesigner.element.on("click",".e-gradient-color",this.bbdesigner$.proxy(this.onGradientColor,this)),this.dashboardDesigner.element.on("click",".e-gradient-type",this.bbdesigner$.proxy(this.onGradientChange,this)),this.dashboardDesigner.element.on("click",".e-flat-type",this.bbdesigner$.proxy(this.onFlatChange,this)),this.dialogDiv.on("click",".e-custom-color-numberformat-icon",this.bbdesigner$.proxy(this.openFormatDialog,this))},e.prototype.unwireEvents=function(){this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-bold",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-italic",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-underline",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-color-field-content .e-font-strikethrough",this.bbdesigner$.proxy(this.selectFontStyleIcons,this)),this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-color-custom-condition-close",this.bbdesigner$.proxy(this.removeCondition,this)),this.dialogDiv.off("click",".bbi-color-custom-advance-content .bbi-color-custom-add-condition-wrap",this.bbdesigner$.proxy(this.addCondition,this)),this.dialogDiv.off("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-start",this.bbdesigner$.proxy(this.setMinValue,this)),this.dialogDiv.off("focusout",".bbi-color-custom-advance-content .bbi-advanc-condition-content .bbi-condition-value-end",this.bbdesigner$.proxy(this.setMaxValue,this)),this.dialogDiv.off("click",".e-condition-range-colorpicker, .e-range-color, .e-range-icon",this.bbdesigner$.proxy(this.onRangeColorOpen,this)),this.dashboardDesigner.element.off("click",".e-gradient-color",this.bbdesigner$.proxy(this.onGradientColor,this)),this.dashboardDesigner.element.off("click",".e-gradient-type",this.bbdesigner$.proxy(this.onGradientChange,this)),this.dashboardDesigner.element.off("click",".e-flat-type",this.bbdesigner$.proxy(this.onFlatChange,this)),this.dialogDiv.off("click",".e-custom-color-numberformat-icon",this.bbdesigner$.proxy(this.openFormatDialog,this))},e.prototype.selectFontStyleIcons=function(e){e=this.bbdesigner$(e.currentTarget);e.hasClass("bbi-designer-fontstyle-selection")?e.removeClass("bbi-designer-fontstyle-selection"):e.addClass("bbi-designer-fontstyle-selection")},e.prototype.getDropdownContent=function(){return"<ul class=\"e-icon-color-list\"><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.upText+"><div class=\"e-icon-collection e-icon-arrow2_up\" > </div></li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.rightText+"><div class=\"e-icon-collection e-icon-arrow2_right\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.downText+"><div class=\"e-icon-collection e-icon-arrow2_down\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.pointerUpText+"><div class=\"e-icon-collection e-icon-arrow2_pointer_up\" > </div></li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.pointerDownText+"><div class=\"e-icon-collection e-icon-arrow2_pointer_down\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.miunsText+"><div class=\"e-icon-collection e-icon-arrow2_minus\" > </div></li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.round+"><div class=\"e-icon-collection e-icon-arrow2_round\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.star+"><div class=\"e-icon-collection e-icon-arrow2_star\" > </div></li > <li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.polygon+"><div class=\"e-icon-collection e-icon-arrow2_polygon\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.tickText+"><div class=\"e-icon-collection e-icon-arrow2_tick\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.warning+"><div class=\"e-icon-collection e-icon-arrow2_warning\"> </div></li><li class='e-icon-color-list-item' data-icon-id="+this.locale.colorCustomAdvanceLocale.closeText+"><div class=\"e-icon-collection e-icon-arrow2_close\"> </div></li><input type='button' id = 'customButton' class='bbi-dbrd-btn-small bbi-dbrd-btn-secondary e-custom-icon-button' data-icon-id='custom' value = '"+this.locale.colorCustomAdvanceLocale.customBtnText+"'/></ul>"},e.prototype.renderIconFieldDropDownContent=function(e,t){var i,a,o,s;0===e.find("#"+e.attr("id")+"_icon_list").length?(i=BoldBIDashboard.buildTag("div","",{},{id:e.attr("id")+"_icon_list"}),e.append(i)):i=e.find("#"+e.attr("id")+"_icon_list"),i.append(this.getDropdownContent()),this.renderCustomIconButton(i.find(".e-custom-icon-button"),e),i=0<i.find(".e-custom-icon-button").length&&"none"!==i.find(".e-custom-icon-button").css("display")?190:160,e.BoldBIDashboardDropDownList({targetID:e.attr("id")+"_icon_list",cssClass:"bbi-dbrd-control bbi-dbrd-designer-icon-drpdwn bbi-dbrd-designer-icon-drpdwn-popup",popupWidth:120,popupHeight:i,width:"43px",height:"28px",select:this.bbdesigner$.proxy(this.selectionChanged,e,this)}),i=e.data("BoldBIDashboardDropDownList"),o=this.bbdesigner$(e[0]).parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker"),e.BoldBIDashboardDropDownList({watermarkText:this.waterMarkIcon(e,t,o)}),!BoldBIDashboard.isNullOrUndefined(i)&&t.isChecked?t.iconType!==ImageType.Default?(i.enable(),i.selectItemByIndex(-1),e.attr("icon-type","custom"),e.attr("data-type",ImageType[t.iconType]),e.attr("data-value",t.selectedIcon),this.storeImageDetails(e),0<this.bbdesigner$(e[0].parentElement).find("#"+e[0].parentElement.id+"_selectedIcon").length&&this.bbdesigner$(e[0].parentElement).find("#"+e[0].parentElement.id+"_selectedIcon").remove(),0<o.length&&(s=o.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(s)||(a=e.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(a)||a.option("width","120px"),s.disable(),o.parents(".bbi-condition-icon-colorpicker-wrap").css("display","none"))),this.bbdesigner$(e).css({display:"none"}),a=BoldBIDashboard.buildTag("span","",{},{id:e[0].parentElement.id+"_selectedIcon"}),s=BoldBIDashboard.buildTag("div",this.locale.colorCustomAdvanceLocale.customBtnText,{"text-align":"left","padding-left":"0.857em"},{class:"e-input e-selectedIcon"}),a.append(s),this.bbdesigner$(a).insertBefore(e)):(o=i.items.parents("ul").find("li[data-icon-id="+t.selectedIcon+"]"),s=this.bbdesigner$(i.items).index(o),i.selectItemByIndex(s),i.enable()):i.disable()},e.prototype.waterMarkIcon=function(e,t,i){BoldBIDashboard.isNullOrUndefined(t)||t.isChecked||(t=e.data("BoldBIDashboardDropDownList"),i=i.data("BoldBIDashboardColorPicker"),this.selectIconByIndex(t),e.parent().addClass("e-disable-selected-icondropdown"),i.disable())},e.prototype.storeImageDetails=function(e){e.attr("data-type")===ImageType[ImageType.Embedded]&&(e=e.attr("data-value"),0<Object.keys(this.dashboardDesigner.colorCustomIconStore).length&&!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.colorCustomIconStore[e])||(this.dashboardDesigner.colorCustomIconStore[e]={base64String:"",imageName:e}))},e.prototype.renderCustomIconButton=function(e,t){!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&(e.off("click",this.bbdesigner$.proxy(this.customIconClicked,this,t)),e.on("click",this.bbdesigner$.proxy(this.customIconClicked,this,t)))},e.prototype.selectionChanged=function(e,t){var i,a,o,s,n;BoldBIDashboard.isNullOrUndefined(t.model)||(n=t.model.targetID,n=this.dialogDiv.find("#"+n),o="",s=this.bbdesigner$(n[0].parentElement),0<(n=n.parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker")).length&&(i=n.data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(i)||(a=s.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(a)||a.option("width","43px"),n.parents(".bbi-condition-icon-colorpicker-wrap").css("display","block"),i.enable(),o=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(i.getColor()))),s.removeAttr("icon-type"),s.removeAttr("data-type"),s.removeAttr("data-value"),t.model.showCheckbox)||"none"!==t.model.multiSelectMode||e.setIconForDropDown(s,t,o)},e.prototype.setIconForDropDown=function(e,t,i){0<this.bbdesigner$(e[0].parentElement).find("#"+e[0].parentElement.id+"_selectedIcon").length&&this.bbdesigner$(e[0].parentElement).find("#"+e[0].parentElement.id+"_selectedIcon").remove(),this.bbdesigner$(e).css({display:"none"});var a=BoldBIDashboard.buildTag("span.e-selected-drpdwn-icon","",{},{id:e[0].parentElement.id+"_selectedIcon"}),t=this.getClassNameOfIcon(t.itemId),o=BoldBIDashboard.buildTag("div","",{},{class:"e-icon-collection"});a.append(o),o.addClass(t),this.bbdesigner$(a).insertBefore(e),BoldBIDashboard.isNullOrUndefined(i)||""===i||a.find(".e-icon-collection").css("color",i)},e.prototype.getClassNameOfIcon=function(e){var t="";switch(e){case 0:t="e-icon-arrow2_up";break;case 1:t="e-icon-arrow2_right";break;case 2:t="e-icon-arrow2_down";break;case 3:t="e-icon-arrow2_pointer_up";break;case 4:t="e-icon-arrow2_pointer_down";break;case 5:t="e-icon-arrow2_minus";break;case 6:t="e-icon-arrow2_round";break;case 7:t="e-icon-arrow2_star";break;case 8:t="e-icon-arrow2_polygon";break;case 9:t="e-icon-arrow2_tick";break;case 10:t="e-icon-arrow2_warning";break;case 11:t="e-icon-arrow2_close"}return t},e.prototype.customIconClicked=function(e){this.dashboardDesigner.modules.colorCustomizationCustomDialog.openCustomDialogWindow(e)},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationAdvanceSettings",InternalColorCustomizationAdvanceSettings,window),InternalColorCustomizationCustomDialog=function(){function e(e){this.dashboardDesigner=null,this.isImageElement=!1,this.isBackgroundImageElement=!1,this.isMarkerImageElement=!1,this.locale=null,this.ejCustomDialog=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id+"_color_customization_icon_dlg",this.renderCustomDialogWindow()}return e.prototype.renderCustomDialogWindow=function(){var e=this.customDialogContainer=BoldBIDashboard.buildTag("div.bbi-userselect.e-color-customization-icon-dlg","",{},{id:this.id+"_custom_dialog"}),t=BoldBIDashboard.buildTag("div.bbi-userselect bbi-dbrd-control","",{width:"100%"},{id:this.id+"_custom_dialog_container"}),i=BoldBIDashboard.buildTag("div","",{width:"100%",height:"100%"},{id:this.id+"_custom_dialog_content"});t.append(i),e.append(t),this.dashboardDesigner.element.append(e),this.ejCustomDialog=e.BoldBIDashboardDialog({title:this.locale.colorCustomAdvanceLocale.customIconDlgTitle,width:"auto",height:"auto",minHeight:240,minWidth:450,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner e-dashboarddesigner-custom-icon-dlg",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_custom_dialog_foot"),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left e-custom-dlg-cancel-btn",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_custom_dialog_cancel",type:"button"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary e-custom-dlg-save-btn",this.locale.dialogOptions.addButtonText,{float:"right"},{id:this.id+"_custom_dialog_save",type:"button"}),this.footerTag.append(i,t),t.off("click",this.bbdesigner$.proxy(this.saveBtnClick,this)),i.off("click",this.bbdesigner$.proxy(this.cancelBtnClick,this)),t.on("click",this.bbdesigner$.proxy(this.saveBtnClick,this)),i.on("click",this.bbdesigner$.proxy(this.cancelBtnClick,this)),this.addBtnEnableDisable(!1)},e.prototype.openCustomDialogWindow=function(e){this.resetFields(),this.isImageElement=e.hasClass("bbi-color-custom-image-field"),this.isBackgroundImageElement=e.hasClass("bbi-color-custom-background-image-field"),this.isMarkerImageElement=e.hasClass("bbi-marker-shape-image-custom-field"),this.parentDrpDwn=e,this.renderTab(this.customDialogContainer.find("#"+this.id+"_custom_dialog_content")),this.ejCustomDialog.open()},e.prototype.resetFields=function(){this.fileOrURLPath=null,this.selectedImageType=ImageType[ImageType.Embedded]},e.prototype.renderTab=function(e){var t,i,a;0===e.children().length?(t=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-content-wrap","",{},{id:this.id+"_custom_dialog_content_wrap"}),e.append(t),a=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-tab","",{},{id:this.id+"_custom_dialog_tab"}),this.getTabHeader(a),e=BoldBIDashboard.buildTag("table.bbi-designer-dsconfig-table e-custom-upload-table e-custom-dlg-content-table","",{width:"100%",height:"100%"},{unselectable:"on",id:this.id+"_custom_icon_selectedType"}),i=BoldBIDashboard.buildTag("table.bbi-designer-dsconfig-table e-custom-url-table e-custom-dlg-content-table","",{width:"100%",height:"100%"},{unselectable:"on",id:this.id+"_custom_icon_selectedType"}),a.find(".e-custom-icon-dialog-browse").append(e),a.find(".e-custom-icon-dialog-url").append(i),this.renderBrowseDialog(this.id+"_custom_icon_browse_type_dialog",e),this.renderUrlTextBox(this.id+"_custom_icon_url_textbox",i),t.append(a),a.BoldBIDashboardTab({width:"450px",height:"160px",selectedItemIndex:0,itemActive:this.bbdesigner$.proxy(this.afterTabActive,this)}),this.selectedImageType===ImageType[ImageType.Embedded]&&(this.fileOrURLPath=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-value"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-value"):this.parentDrpDwn.attr("data-value"),this.updateBrowseImage())):(BoldBIDashboard.isNullOrUndefined(this.parentDrpDwn)||(this.selectedImageType=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-type"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-type"):this.parentDrpDwn.attr("data-type"),this.fileOrURLPath=this.isImageElement||this.isMarkerImageElement?this.parentDrpDwn.attr("data-image-value"):this.isBackgroundImageElement?this.parentDrpDwn.attr("data-background-image-value"):this.parentDrpDwn.attr("data-value")),BoldBIDashboard.isNullOrUndefined(this.selectedImageType)&&(this.selectedImageType=ImageType[ImageType.Embedded]),a=this.customDialogContainer.find(".e-custom-icon-dialog-tab").data("BoldBIDashboardTab"),BoldBIDashboard.isNullOrUndefined(a)||(this.selectedImageType!==ImageType[ImageType.URL]?(a.option("selectedItemIndex",0),this.filePath.val(""),this.updateBrowseImage()):(a.option("selectedItemIndex",1),this.urlTextBox.val(this.fileOrURLPath),this.urlTextFocusOut(),this.addBtnEnableDisable(""!==this.urlTextBox.val().trim()))))},e.prototype.updateBrowseImage=function(){var e;0<Object.keys(this.dashboardDesigner.colorCustomIconStore).length&&(e=this.dashboardDesigner.colorCustomIconStore[this.fileOrURLPath],BoldBIDashboard.isNullOrUndefined(e)||(e.base64String=BoldBIDashboard.isNullOrUndefined(e.base64String)||""===e.base64String?BoldBIDashboard.Dashboard.Resource.getImage(this.fileOrURLPath):e.base64String),BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.base64String)||""===e.base64String?BoldBIDashboard.isNullOrUndefined(this.fileOrURLPath)?this.resetBrowseFields():this.fetchImage():(this.browseDialog.find(".e-browse-input-box").val(e.imageName),this.browseDialog.find(".e-custom-image").attr("src",e.base64String),this.browseDialog.find(".e-default-image").hide(),this.browseDialog.find(".e-custom-image").show(),this.addBtnEnableDisable(!0)))},e.prototype.fetchImage=function(){this.ejCustomDialog.open(),this.showLoadingIndicator(),this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.assignimage,{action:BoldBIDashboard.DashboardUtil.DesignerAction.FetchImage,data:JSON.stringify({fileName:this.fileOrURLPath})},{fnction:this.bbdesigner$.proxy(this.updateImageInfo,this)})},e.prototype.updateImageInfo=function(e){this.fileExt=e.ext,this.fileOrURLPath=e.fileName,this.fileId=e.fileId,this.updateImageMode(e),this.storeImageDetails()},e.prototype.storeImageDetails=function(){this.dashboardDesigner.colorCustomIconStore[this.fileOrURLPath]={base64String:this.browseDialog.find(".e-custom-image").attr("src"),imageName:this.browseDialog.find(".e-browse-input-box").val()}},e.prototype.getTabHeader=function(e){var t="<ul><li><a href='#"+this.id+"_Upload'>"+this.locale.colorCustomAdvanceLocale.uploadText+"</a></li><li><a href='#"+this.id+"_Url'>"+this.locale.colorCustomAdvanceLocale.urlText+"</a></li></ul>",i=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-browse e-custom-icon-dialog-tab-content","",{},{id:this.id+"_Upload"}),a=BoldBIDashboard.buildTag("div.e-custom-icon-dialog-url e-custom-icon-dialog-tab-content","",{},{id:this.id+"_Url"});e.append(t,i,a)},e.prototype.afterTabActive=function(e){BoldBIDashboard.isNullOrUndefined(e)||(e=this.bbdesigner$(e.activeHeader).find(".e-link").text(),this.selectedImageType=e===this.locale.colorCustomAdvanceLocale.urlText?ImageType[ImageType.URL]:this.selectedImageType=ImageType[ImageType.Embedded],this.selectedImageType===ImageType[ImageType.URL]?this.addBtnEnableDisable(""!==this.urlTextBox.val().trim()):this.addBtnEnableDisable(!BoldBIDashboard.isNullOrUndefined(this.filePath)&&""!==this.filePath.val().trim()))},e.prototype.renderUrlTextBox=function(e,t){var i=this.urlTextRow=this.bbdesigner$("<tr id="+e+"_tr/>"),a=BoldBIDashboard.buildTag("div.bbi-custom-icon-inner-content","",{height:"100px",width:"320px"},{}),e=this.urlTextBox=BoldBIDashboard.buildTag("input.e-textbox e-url-textbox","",{},{id:e,type:"text",spellcheck:"false"});e.bind("focusout",this.bbdesigner$.proxy(this.urlTextFocusOut,this)),a.append(e),i.append(a),this.renderImageDiv(this.id+"_custom_icon_Image_div_url",i),t.append(i)},e.prototype.urlTextFocusOut=function(){var e,t;this.fileOrURLPath=this.urlTextRow.find("#"+this.id+"_custom_icon_url_textbox").val(),0!==(e=this.urlTextRow.find(".e-custom-image")).length&&((t=0<this.fileOrURLPath.length&&null===this.fileOrURLPath.match(/^ *$/))?(e.attr("src",this.fileOrURLPath),e.show(),this.urlTextRow.find(".e-default-image").hide()):(e.hide(),this.urlTextRow.find(".e-default-image").show()),this.addBtnEnableDisable(t))},e.prototype.addBtnEnableDisable=function(e){var t=this.footerTag.find(".e-custom-dlg-save-btn");BoldBIDashboard.DashboardUtil.buttonEnable(t,e)},e.prototype.renderBrowseDialog=function(e,t){var i,e=this.browseDialog=this.bbdesigner$("<tr id="+e+"_tr/>"),a=BoldBIDashboard.buildTag("div.bbi-custom-icon-inner-content","",{},{});this.filePath=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-content-label e-browse-input-box","",{},{id:this.id+"_image_path",type:"text",readonly:"readonly"}),(i=BoldBIDashboard.buildTag("div.bbi-designer-content-label bbi-dbrd-designer-hand-cursor e-browse-btn",this.locale.colorCustomAdvanceLocale.browseText,{},{id:this.id+"_image_file_browse"})).BoldBIDashboardButton({showRoundedCorner:!1,click:this.bbdesigner$.proxy(this.onBrowseClick,this)}),a.append(this.filePath),a.append(i),e.append(a),this.renderImageDiv(this.id+"_custom_icon_Image_div_browse",this.browseDialog),t.append(e),this.renderUploadBox()},e.prototype.renderImageDiv=function(e,t){var i=this.bbdesigner$("<td class=\"bbi-custom-icon-inner-content e-custom-image-td\" unselectable='on'/>"),a=BoldBIDashboard.buildTag("div.e-custom-image-wrap","",{},{id:this.id+"_"+e+"_image_file_Div"});i.append(a),t.append(i),t=BoldBIDashboard.buildTag("img.e-custom-image","",{},{id:this.id+"_"+e+"_image_file"}),i=BoldBIDashboard.buildTag("div.e-default-image","",{},{id:this.id+"_"+e+"_default_image_file_Div"}),a.append(t,i),t.hide(),a.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},e.prototype.onBrowseClick=function(){this.dashboardDesigner.element.find("#"+this.id+"_image_upload .e-uploadinput").click()},e.prototype.renderUploadBox=function(){var t=this,e=BoldBIDashboard.buildTag("div","",{height:"0px"},{id:this.id+"_image_upload"});this.dashboardDesigner.element.append(e),this.ejUploadBox=e.BoldBIDashboardUploadbox({width:"0px",height:"0px",uploadName:"image",extensionsAllow:".jpg,.png,.gif,.jpeg,.bmp,.emf,.jfif,.jpe,.rle,.tif,.tiff,.wmf,.dib,.ico",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.dashboardDesigner.element},fileSize:78643200,saveUrl:this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.uploadimage,fileSelect:this.bbdesigner$.proxy(this.onfileSelect,this),error:this.bbdesigner$.proxy(this.onuploadError,this),success:this.bbdesigner$.proxy(this.onuploadSuccess,this),beforeSend:this.bbdesigner$.proxy(function(e){t.dashboardDesigner.beforeSendRequestForUploadbox(t.dashboardDesigner,"UploadAction",e)},this)}).data("BoldBIDashboardUploadbox"),this.dashboardDesigner.element.find(this.id+"_img_upload_SelectButton").hide()},e.prototype.onfileSelect=function(e){0!==e.files.length&&(this.showLoadingIndicator(),e.files[0].size>e.model.fileSize?e.cancel=!0:(this.fileOrURLPath=this.fileExt=null,this.filePath.val(e.files[0].name))),this.ejUploadBox._uploadFileListDelete()},e.prototype.showLoadingIndicator=function(){this.browseDialog.find(".e-default-image").hide(),this.browseDialog.find(".e-custom-image").hide();var e=this.browseDialog.find(".e-custom-image-wrap").data("BoldBIDashboardWaitingPopup");BoldBIDashboard.isNullOrUndefined(e)||e.show()},e.prototype.hideLoadingIndicator=function(){var e=this.browseDialog.find(".e-custom-image-wrap").data("BoldBIDashboardWaitingPopup");BoldBIDashboard.isNullOrUndefined(e)||e.hide()},e.prototype.onuploadError=function(){this.hideLoadingIndicator(),this.browseDialog.find(".e-default-image").show(),window.alert("Upload Failed")},e.prototype.onuploadSuccess=function(e){e=JSON.parse(e.responseText);e&&e.Status?(this.fileExt=e.Data.ext,this.fileOrURLPath=e.Data.fileId+e.Data.ext,this.fileId=e.Data.fileId,this.updateImageMode(e.Data)):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.upload,this.locale.errorMessage.failedToUploadFile,IconType.errors,AlertType.Alert,!1,e?e.Message:null)},e.prototype.updateImageMode=function(e){var t,i=this.browseDialog.find(".e-custom-image");0!==i.length&&(t="data:image/"+e.ext+";base64,"+e.source,i.attr("src",t),BoldBIDashboard.Dashboard.Resource.addImage(e.fileId+e.ext,t),this.hideLoadingIndicator(),i.show(),""===this.browseDialog.find(".e-browse-input-box").val().trim()&&this.browseDialog.find(".e-browse-input-box").val(this.fileOrURLPath),this.addBtnEnableDisable(!0))},e.prototype.cancelBtnClick=function(){this.ejCustomDialog.close(),this.resetBrowseFields(),this.resetUrlFields()},e.prototype.resetBrowseFields=function(){this.filePath.val(""),this.browseDialog.find(".e-custom-image").hide(),this.browseDialog.find(".e-default-image").show()},e.prototype.resetUrlFields=function(){this.urlTextBox.val(""),this.urlTextRow.find(".e-custom-image").hide(),this.urlTextRow.find(".e-default-image").show()},e.prototype.setImageDataAttribute=function(){this.isImageElement||this.isMarkerImageElement?(this.parentDrpDwn.attr("data-image-type",this.selectedImageType),this.parentDrpDwn.attr("data-image-value",this.fileOrURLPath)):this.isBackgroundImageElement?(this.parentDrpDwn.attr("data-background-image-type",this.selectedImageType),this.parentDrpDwn.attr("data-background-image-value",this.fileOrURLPath)):(this.parentDrpDwn.attr("data-type",this.selectedImageType),this.parentDrpDwn.attr("data-value",this.fileOrURLPath))},e.prototype.saveBtnClick=function(){var e,t;this.parentDrpDwn.attr("icon-type","custom"),this.setImageDataAttribute(),this.selectedImageType===ImageType[ImageType.URL]?this.resetBrowseFields():this.resetUrlFields(),this.isImageElement||this.isBackgroundImageElement||this.isMarkerImageElement?(this.parentDrpDwn.find(".bbi-color-custom-default-icon").css("display","none"),this.parentDrpDwn.find(".bbi-color-custom-image-element").attr("src",this.selectedImageType===ImageType[ImageType.Embedded]?BoldBIDashboard.Dashboard.Resource.getImage(this.fileOrURLPath):this.fileOrURLPath),this.parentDrpDwn.find(".bbi-color-custom-image").css("display","block")):(0<this.bbdesigner$(this.parentDrpDwn[0].parentElement).find("#"+this.parentDrpDwn[0].parentElement.id+"_selectedIcon").length&&this.bbdesigner$(this.parentDrpDwn[0].parentElement).find("#"+this.parentDrpDwn[0].parentElement.id+"_selectedIcon").remove(),this.bbdesigner$(this.parentDrpDwn).css({display:"none"}),t=BoldBIDashboard.buildTag("span","",{},{id:this.parentDrpDwn[0].parentElement.id+"_selectedIcon"}),e=BoldBIDashboard.buildTag("div",this.locale.colorCustomAdvanceLocale.customBtnText,{"text-align":"left","padding-left":"0.857em"},{class:"e-input e-selectedIcon"}),t.append(e),this.bbdesigner$(t).insertBefore(this.parentDrpDwn),t=(e=this.bbdesigner$(this.parentDrpDwn[0]).parents(".bbi-color-custom-color-field-wrap").find(".e-custom-colorpicker")).data("BoldBIDashboardColorPicker"),BoldBIDashboard.isNullOrUndefined(t)||(t.disable(),e.parents(".bbi-condition-icon-colorpicker-wrap").css("display","none"),t=this.parentDrpDwn.data("BoldBIDashboardDropDownList"),BoldBIDashboard.isNullOrUndefined(t))||t.option("width","120px")),this.selectedImageType===ImageType[ImageType.Embedded]&&this.storeImageDetails(),this.ejCustomDialog.close()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationCustomDialog",InternalColorCustomizationCustomDialog,window),InternalColorPicker=function(){function e(e){this.dashboardDesigner=null,this.callMethod="",this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.wireEvents()}return e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click",".e-range-color",this.bbdesigner$.proxy(this.onColorPickerOpen,this)),this.dashboardDesigner.element.on("focusout",".e-color-textbox",this.bbdesigner$.proxy(this.onColorTextFocus,this))},e.prototype.unwireEvents=function(){this.dashboardDesigner.element.off("click",".e-range-color",this.bbdesigner$.proxy(this.onColorPickerOpen,this)),this.dashboardDesigner.element.off("focusout",".e-color-textbox",this.bbdesigner$.proxy(this.onColorTextFocus,this))},e.prototype.renderColorPicker=function(e,t,i){var a;this.callInstance=t,this.callMethod=i,t=e.attr("id"),i=e.attr("data-color"),BoldBIDashboard.isNullOrUndefined(i)||""===i?this.bbdesigner$(e).attr("data-color","#278787"):this.bbdesigner$(e).attr("data-color",i),i=this.bbdesigner$(e).attr("data-color"),e.css({height:"24px",width:"104px",border:"1px solid #B3B3B3","border-radius":"4px",display:"inline-block"}),i="<input id="+t+"_colorTextBox class='e-color-textbox' data-id="+t+" style='height:14px;width:70px;float:left;margin:4px;border: 0px;background:transparent;outline:unset;' value="+i+"></input><div id="+t+"_color class='e-range-color' data-id="+t+" style='height:14px;width:14px;background: "+i+";float:right;margin: 4px;border-radius: 4px;'></div>",a="<div id="+t+"_colorPicker class='e-color-picker' style='height:254px;width:246px;position:absolute;border:1px solid #FFFFFF;box-shadow: 0 4px 6px 0 rgba(0,0,0,0.16);display:none;background:#FFFFFF;'><div id="+t+"_colorPalette data-id="+t+" style='height:256px;width:154px;margin-left: 7px;display:block'></div></div>",this.bbdesigner$(e).append(i).append(a),this.bbdesigner$(e).find("#"+t+"_colorPalette").BoldBIDashboardColorPicker({value:this.bbdesigner$(e).attr("data-color"),displayInline:!0,modelType:"picker",change:this.bbdesigner$.proxy(this.onColorChange,this,e)})},e.prototype.onColorChange=function(e,t){var i=this.bbdesigner$(e).find(".e-color-textbox").val(),t=this.dashboardDesigner.modules.propertyPanel.getHexColorFromRGBA(t.RGBA);BoldBIDashboard.isNullOrUndefined(t)||(t=t.toLocaleUpperCase()),this.bbdesigner$(e).attr({"data-color":t,"data-type":"Flat"}),BoldBIDashboard.isNullOrUndefined(this.callInstance)||BoldBIDashboard.isNullOrUndefined(this.callMethod)||(i!==t?this.bbdesigner$(e).parent().attr({"data-modified":!0}):BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(e).parent().attr("data-modified"))||this.bbdesigner$(e).parent().removeAttr("data-modified"),BoldBIDashboard.DashboardUtil.invokeMethod(this.callInstance,this.callMethod))},e.prototype.onColorPickerOpen=function(e){var t=this.bbdesigner$(e.target).attr("data-id")||this.bbdesigner$(e.target).attr("id");"none"===this.bbdesigner$("#"+t+"_colorPicker").css("display")?this.bbdesigner$("#"+t+"_colorPicker").css("display","block"):this.bbdesigner$("#"+t+"_colorPicker").css("display","none"),this.setColorPalettePosition(t),e.stopPropagation(),this.bbdesigner$(document).on("click","body",this.bbdesigner$.proxy(this.onColorPickerClose,this,t))},e.prototype.setColorPalettePosition=function(e){var t=this.bbdesigner$("#"+e),e=this.bbdesigner$("#"+e+"_colorPicker"),i=t.offset(),a=this.bbdesigner$(document).scrollTop()+this.bbdesigner$(window).height()-(i.top+this.bbdesigner$(t).outerHeight()),o=i.top-this.bbdesigner$(document).scrollTop(),s=e.outerHeight(),n=e.outerWidth(),r=i.left,d=t.outerHeight(),l=(d-t.height())/2,h=this.getZindexPartial(t,e),a=(s<a||o<s?i.top+d+3:i.top-s-3)-l;this.bbdesigner$(document).scrollLeft()+this.bbdesigner$(window).width()-r<n&&n<r+t.outerWidth()&&(r-=e.outerWidth()-t.outerWidth()),e.css({left:r+"px",top:a+"px","z-index":h})},e.prototype.getZindexPartial=function(e,t){var i,a,o,s=this.bbdesigner$;if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)return a=e.parents(),o=s("body").children(),!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&o.splice(o.index(t),1),s(o).each(function(e,t){a.push(t)}),!(i=Math.max.apply(i,s.map(a,function(e){if("static"!==s(e).css("position"))return parseInt(s(e).css("z-index"))||1})))||i<1e4?i=1e4:i+=1,i},e.prototype.onColorPickerClose=function(e,t){var i=this.bbdesigner$("#"+e);0===this.bbdesigner$(t.target).parents(".e-color-picker").length&&(this.bbdesigner$("#"+e+"_colorPicker").css("display","none"),t="",t=this.bbdesigner$(i).attr("data-color"),this.bbdesigner$("#"+e+"_color").css("background",t),BoldBIDashboard.isNullOrUndefined(t)?this.bbdesigner$(i).find(".e-color-textbox").val(t):this.bbdesigner$(i).find(".e-color-textbox").val(t.toLocaleUpperCase()),i.css("border","1px solid #B3B3B3"))},e.prototype.onColorTextFocus=function(e){var t=this.dashboardDesigner.element.find("#"+this.bbdesigner$(e.target).attr("data-id")),i=this.dashboardDesigner.element.find("#"+this.bbdesigner$(e.target).attr("data-id")+"_colorPalette").data("BoldBIDashboardColorPicker");/(^#[0-9A-F]{6}$)|(^#[0-9A-F]{3}$)/i.test(this.bbdesigner$(e.target).val())?(t.css("border","1px solid #B3B3B3"),t.find(".e-range-color").css("background",this.bbdesigner$(e.target).val()),i.setModel({value:this.bbdesigner$(e.target).val()})):t.css("border","1px solid #FF0000")},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorPicker",InternalColorPicker,window),InternalColorCustomizationInclusionSelection=function(){function e(e){this.waterMarkText="Search",this.listFieldName="text",this.ajaxRequestCollection=[],this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id}return e.prototype.resetMultiSelection=function(e){0<this.dashboardDesigner.element.find("#"+e+"_popup_container").length&&(this.dashboardDesigner.element.find("#"+e+"_popup_container").remove(),this.multiSelectionComboBox.find("#"+e+"_multi_select_dropDown_text").empty())},e.prototype.renderMultiSelectionComboBox=function(e,t,i){this.resetMultiSelection(t),this.multiSelectionComboBox=BoldBIDashboard.buildTag("div.bbi-multiselect-dropdown-item","",{width:e.width(),height:"28px",cursor:"pointer","background-color":"white",display:"block",border:"1px solid #B3B3B3","border-radius":"4px","box-sizing":"border-box","box-shadow":"rgba(0, 0, 0, 0.0745098) 0px 1px 1px inset"},{id:t+"_multi_select_dropDown"});var a=this.locale.colorCustomAdvanceLocale.selectAny,a=BoldBIDashboard.buildTag("div",a,{"border-style":"none",width:e.width()-46,height:"100%","line-height":"24px",float:"left","text-overflow":"ellipsis","white-space":"nowrap",overflow:"hidden","font-size":"12px","padding-left":".857em"},{id:t+"_multi_select_dropDown_text"}),o=BoldBIDashboard.buildTag("div","",{display:"inline-block",width:"33px",height:"100%"},{}),s=BoldBIDashboard.buildTag("span.bbi-designer-ejwidgets-updown e-icon e-arrow-sans-down","",{color:"#666666",padding:"8px 10px"});o.append(s),this.multiSelectionComboBox.append(a).append(o),this.multiSelectionComboBox.bind("click",this.bbdesigner$.proxy(this.showPopupContainer,this,e,t,i)),e.append(this.multiSelectionComboBox),this.renderPopupContainer(t)},e.prototype.renderPopupContainer=function(e){this.popupContainer=BoldBIDashboard.buildTag("div.e-multiselect-popup-container boldbi-dashboarddesigner","",{"min-width":"245px",height:"270px",position:"absolute",border:"1px solid #dddddd","background-color":"white","border-radius":"3px",display:"none","z-index":"10100"},{id:e+"_popup_container"}),a=BoldBIDashboard.buildTag("div","",{},{}),this.renderSearchPanel(a,e),t=BoldBIDashboard.buildTag("div.e-multiselect-waiting-popup","",{height:"188px","background-color":"white","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box","z-index":"1010",padding:"5px 10px"},{id:e+"_popup_container_list_Box_div"}),i=BoldBIDashboard.buildTag("ul","",{},{id:e+"_popup_container_list_Box"}),t.append(i);var t,i,a,o=BoldBIDashboard.buildTag("div.e-footerbar.e-dialog.e-js","",{width:"100%",height:"45px","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",padding:"10px 5px"},{}),s=BoldBIDashboard.buildTag("input.bbi-dbrd-designer-hand-cursor","",{float:"right"},{id:e+"_popup_container_ok_btn"}),n=BoldBIDashboard.buildTag("input.bbi-dbrd-designer-hand-cursor","",{float:"right"},{id:e+"_popup_container_cancel_btn"});o.append(n).append(s),this.popupContainer.append(a).append(t).append(o),this.dashboardDesigner.element.append(this.popupContainer),a=this.locale.dialogOptions,s.BoldBIDashboardButton({showRoundedCorner:!1,size:"mini",cssClass:"bbi-designer-okbtn",text:a.applyButtonText,click:this.bbdesigner$.proxy(this.updatePopupContainerInformation,this,e)}),n.BoldBIDashboardButton({showRoundedCorner:!1,size:"mini",cssClass:"bbi-designer-cancelbtn",text:a.cancelButtonText,click:this.bbdesigner$.proxy(this.closePopupContainer,this,e)}),i.BoldBIDashboardListBox({dataSource:[{text:""}],fields:{value:this.listFieldName},showCheckbox:!0,width:"100%",height:"100%",cssClass:"bbi-dbrd-control"}),t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()})},e.prototype.renderSearchPanel=function(e,t){var i,a=BoldBIDashboard.buildTag("div","",{width:"225px",height:"16px",padding:"10px"},{id:t+"_popup_container_searchPanel"}),o=BoldBIDashboard.buildTag("input.bbi-designer-fieldcontainer-search-dataassign","",{width:"218px","font-style":"italic"},{id:t+"_popup_container_searchBox"});o.val(this.waterMarkText),i=BoldBIDashboard.buildTag("div","",{width:"24px",height:"15px","margin-top":"-16px",float:"right",color:"lightgray",cursor:"pointer"},{id:t+"_popup_container_searchIcon",class:"e-icon e-search"}),a.append(o),a.append(i),e.append(a),o.bind("focus",this.bbdesigner$.proxy(this.onSearchFocus,this,t))},e.prototype.showPopupContainer=function(e,t,i){var a=this.getMultiSelectionComboBox(t),o=a.attr("data-fieldValue"),a=a.attr("data-fieldText"),s=this.getPopupContainer(t),n=this.getPopupListBox(t).data("BoldBIDashboardListBox"),r="block"===s.css("display"),d=e.offset(),l=d.left+parseFloat(e.css("padding-left"));e.width()<245&&(l=d.left+parseFloat(e.css("padding-left"))-(246-e.width())),s.css({left:l,top:d.top+e.height()+2,display:r?"none":"block","z-index":BoldBIDashboard.getMaxZindex()}),this.updateDropDownIcon(s,t),l=this.getPopupListBoxDiv(t),"block"===s.css("display")?(BoldBIDashboard.isNullOrUndefined(l.attr("data-fieldText"))||l.attr("data-fieldText")!==a?this.ajaxRequestCollection.push(this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getData,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getData,fieldInfo:[{Id:o,Name:a,SummaryType:"None",FieldType:"Dimensions"}],dataSetId:i,filterType:"InitialFilter",isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.setFieldInformation,this,t,a),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this,t),this.bbdesigner$.proxy(this.hideLoadingIndicator,this,t)]})):this.setPopupValues(t),0<e.find(".e-multiselect-popup-container-visible").length&&this.updatePopupContainerVisibility(e.find(".e-multiselect-popup-container-visible")),s.addClass("e-multiselect-popup-container-visible")):(s.removeClass("e-multiselect-popup-container-visible"),this.hideLoadingIndicator(t)),n._refreshScroller()},e.prototype.getDataSource=function(i){for(var e=0;e<i.length;e++)!function(t){i[t][Object.keys(i[t])]=Object.keys(i[t].valueOf()).map(function(e){return i[t].valueOf()[e].toString()})}(e);return i},e.prototype.setFieldInformation=function(e,t,i){var a,o,i=JSON.parse(i.jsonData);if(!BoldBIDashboard.isNullOrUndefined(i)&&0<i.length){for(o in a=this.getPopupListBox(e).data("BoldBIDashboardListBox"),i[0])this.listFieldName=o;i=this.getDataSource(i),a.setModel({dataSource:i,fields:{value:this.listFieldName}}),this.getPopupListBoxDiv(e).attr("data-fieldText",t),this.setPopupValues(e)}},e.prototype.setPopupValues=function(e){var t=this.getPopupListBox(e),i=t.data("BoldBIDashboardListBox");!BoldBIDashboard.isNullOrUndefined(t.data("Filters"))&&i.listitems.length>t.data("Filters").length?(i.checkItemsByIndices(this.getCheckedItemIndices(i.listitems,t.data("Filters"))),this.setItemEnable(e,!0)):(this.setItemEnable(e,!1),i.unCheckAll(),i.setModel({checkChange:this.bbdesigner$.proxy(this.updateListItemCheckChange,this,e)}))},e.prototype.getCheckedItemIndices=function(e,t){for(var i=[],a=0;a<e.length;a++)-1!==t.indexOf(e[a][this.listFieldName].toString())&&i.push(a);return i},e.prototype.showLoadingIndicator=function(e){this.getPopupListBoxDiv(e).BoldBIDashboardWaitingPopup("show"),this.setItemEnable(e,!1),this.getPopupSearchPanel(e).children().prop("disabled",!0)},e.prototype.hideLoadingIndicator=function(e){this.getPopupListBoxDiv(e).BoldBIDashboardWaitingPopup("hide"),this.setItemEnable(e,!0),this.getPopupSearchPanel(e).children().prop("disabled",!1)},e.prototype.onSearchFocus=function(e){var t=this.getPopupSearchPanel(e),i=this.getSearchTextBox(t,e);i.addClass("e-focus"),i.val()===this.waterMarkText&&i.val(""),i.css("color","grey"),i.bind("keyup",this.bbdesigner$.proxy(this.onSearchText,this,e)),i.bind("blur",this.bbdesigner$.proxy(this.onSearchBlur,this,e)),this.getSearchIcon(t,e).bind("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this,e))},e.prototype.onSearchText=function(e,t){var i,a=this.getPopupSearchPanel(e);13!==t.keyCode&&(t=this.getSearchTextBox(a,e).val(),i=this.getPopupListBox(e),0<t.length?(this.getSearchIcon(a,e).addClass("e-close_01").removeClass("e-search"),a=this.filterItems(i.data("BoldBIDashboardListBox").model.dataSource,t,e),i.BoldBIDashboardListBox("hideAllItems"),i.BoldBIDashboardListBox("showItemsByIndices",a)):i.BoldBIDashboardListBox("showAllItems"))},e.prototype.onSearchBlur=function(e){var t=this.getPopupSearchPanel(e),i=this.getSearchTextBox(t,e),a=i.val();i.removeClass("e-focus"),0===a.length&&this.clearSearchText(t,e,i)},e.prototype.clearSearchText=function(e,t,i){this.getSearchIcon(e,t).addClass("e-search").removeClass("e-close_01"),i.val(this.waterMarkText),this.getPopupListBox(t).BoldBIDashboardListBox("showAllItems"),i.css("color","lightgrey")},e.prototype.onSearchCloseClick=function(e){var t=this.getPopupSearchPanel(e),i=this.getSearchTextBox(t,e),t=this.getSearchIcon(t,e);i.removeClass("e-focus"),i.val(this.waterMarkText),i.css("color","lightgrey"),this.getPopupListBox(e).BoldBIDashboardListBox("showAllItems"),t.addClass("e-search").removeClass("e-close_01"),i.unbind("keyup",this.bbdesigner$.proxy(this.onSearchText,this)),t.unbind("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this)),i.unbind("blur",this.bbdesigner$.proxy(this.onSearchBlur,this))},e.prototype.filterItems=function(e,t){for(var i=[],a=0;a<e.length;a++)""!==t&&!e[a][this.listFieldName][0].toLowerCase().startsWith(t.toLowerCase())||i.push(a);return i},e.prototype.updateListItemCheckChange=function(e,t){t.isInteraction&&(this.getPopupListBox(e).data("BoldBIDashboardListBox").getCheckedItems().length<1?this.setItemEnable(e,!1):this.setItemEnable(e,!0))},e.prototype.setItemEnable=function(e,t){e=this.getPopupOkButton(e);BoldBIDashboard.DashboardUtil.buttonEnable(e,t)},e.prototype.updatePopupContainerInformation=function(e){this.clearSearchList(e);var t,i=this.getPopupContainer(e),a=this.getComboBoxTextField(e),o=this.getPopupListBox(e);o.data("BoldBIDashboardListBox");i.css("display","none"),this.updateDropDownIcon(i,e),t=this.getListBoxCheckedItems(e),a.text(t.toString()),o.data("Filters",t),this.bbdesigner$("#"+e).find(".e-error-tip").css("display","none"),i.removeClass("e-multiselect-popup-container-visible")},e.prototype.clearSearchList=function(e){var t=this.getPopupSearchPanel(e),i=this.getSearchTextBox(t,e),a=i.val();0!==a.length&&a!==this.waterMarkText&&(i.removeClass("e-focus"),this.clearSearchText(t,e,i))},e.prototype.closePopupContainer=function(e){var t;this.clearSearchList(e),(t=this.getPopupContainer(e)).css("display","none"),t.removeClass("e-multiselect-popup-container-visible"),this.updateDropDownIcon(t,e),this.getPopupListBoxDiv(e).data("BoldBIDashboardWaitingPopup").model.showOnInit&&this.killPendingRequest()},e.prototype.killPendingRequest=function(){if(0<this.ajaxRequestCollection.length)for(var e=0;e<this.ajaxRequestCollection.length;e++)this.ajaxRequestCollection[e].readyState<4&&this.ajaxRequestCollection[e].abort();this.ajaxRequestCollection=[]},e.prototype.getListBoxCheckedItems=function(e){for(var t=[],i=this.getPopupListBox(e).data("BoldBIDashboardListBox").getCheckedItems(),a=0;a<i.length;a++)t.push(i[a].text);return t},e.prototype.updatePopupContainerVisibility=function(e){var t;!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&(e.css("display","none"),t=e.attr("id").replace(/_popup_container/g,""),this.updateDropDownIcon(e,t))},e.prototype.updateDropDownIcon=function(e,t){t=this.getMultiSelectionComboBox(t);"block"===e.css("display")?t.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-down").addClass("e-arrow-sans-up"):t.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-up").addClass("e-arrow-sans-down")},e.prototype.getMultiSelectionComboBox=function(e){return this.bbdesigner$("#"+e+"_multi_select_dropDown")},e.prototype.getComboBoxTextField=function(e){return this.multiSelectionComboBox.find("#"+e+"_multi_select_dropDown_text")},e.prototype.getPopupContainer=function(e){return this.bbdesigner$("#"+e+"_popup_container")},e.prototype.getPopupListBoxDiv=function(e){return this.popupContainer.find("#"+e+"_popup_container_list_Box_div")},e.prototype.getPopupSearchPanel=function(e){return this.popupContainer.find("#"+e+"_popup_container_searchPanel")},e.prototype.getSearchTextBox=function(e,t){return e.find("#"+t+"_popup_container_searchBox")},e.prototype.getSearchIcon=function(e,t){return e.find("#"+t+"_popup_container_searchIcon")},e.prototype.getPopupListBox=function(e){return this.popupContainer.find("#"+e+"_popup_container_list_Box")},e.prototype.getPopupOkButton=function(e){return this.popupContainer.find("#"+e+"_popup_container_ok_btn")},e.prototype.getPopupCancelButton=function(e){return this.popupContainer.find("#"+e+"_popup_container_cancel_btn")},e.prototype.resetMultiSelectionComboInfo=function(e){var t=this.getComboBoxTextField(e),e=this.getPopupListBox(e);t.text(this.locale.colorCustomAdvanceLocale.selectAny),e.data("Filters",null)},e.prototype.setListboxFilters=function(e,t){this.getPopupListBox(e).data("Filters",t)},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationInclusionSelection",InternalColorCustomizationInclusionSelection,window),InternalColorCustomizationBasicSettings=function(){function e(e){this.dashboardDesigner=null,this.basicSettingsDialog=null,this.basicSettingsContainer=null,this.basicSettingsScrollElement=null,this.basicSettingsValuesWrapper=null,this.dataGroupInfo=null,this.selectedColumnName="",this.resetButton=null,this.defaultColorPalette=["#77A7FB","#E57368","#FBCB43","#34B67A","#F1AB68","#6CC2D9","#195962","#E18878","#1AA27D","#BFAAC7","#89695e","#a5c77f","#f48fb1","#90caf9","#cc4452"],this.okButton=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.propertyPanel=this.dashboardDesigner.modules.propertyPanel,this.colorPicker=this.dashboardDesigner.modules.colorPicker,this.id=this.dashboardDesigner._id,this.renderBasicSettingsWindow()}return e.prototype.renderBasicSettingsWindow=function(){var e=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_legend_settings"}),t=this.basicSettingsContainer=BoldBIDashboard.buildTag("div.e-basic-settings-dialog-container bbi-userselect bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_basic_settings_container"}),i=this.basicSettingsValuesWrapper=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_basicSettings_Columns_Div"}),a=this.basicSettingsScrollElement=BoldBIDashboard.buildTag("div.e-basic-settings-colorElements","",{},{id:this.id+"_basic_settings_colorValue_elements"}),a=(i.append(a),t.append(i),BoldBIDashboard.buildTag("button.e-basic-settings-button bbi-dbrd-btn-smalll bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{},{id:this.id+"_basic_settings_cancel",type:"button"})),i=this.okButton=BoldBIDashboard.buildTag("button.e-basic-settings-button bbi-dbrd-btn-smalll bbi-dbrd-btn-primary",this.locale.dialogOptions.applyButtonText,{},{id:this.id+"_basic_settings_ok",type:"button"}),o=this.resetButton=BoldBIDashboard.buildTag("button.e-basic-settings-reset-button disabled bbi-dbrd-designer-hand-cursor",this.locale.dialogOptions.resetButtonText,{},{id:this.id+"_basic_color_settings_reset",type:"button"}),s=this.locale.dialogOptions;o.attr("data-tooltip",s.resetButtonTooltip),e.append(t),this.dashboardDesigner.element.append(e),this.basicSettingsDialog=e.BoldBIDashboardDialog({title:"Column: "+this.selectedColumnName,width:"auto",height:"auto",minWidth:450,minHeight:420,enableAnimation:!1,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:this.dashboardDesigner._id,target:this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.cancelBtnClick,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.dashboardDesigner.element.find("#"+this.id+"_legend_settings_foot").append(o).append(a).append(i),i.BoldBIDashboardButton({text:s.applyButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-okbtn",size:"mini",click:this.bbdesigner$.proxy(this.saveBasicSettings,this)}),a.BoldBIDashboardButton({text:s.cancelButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-cancelbtn",size:"mini",click:this.bbdesigner$.proxy(this.closeBasicSettingsDialog,this)}),o.BoldBIDashboardButton({text:s.resetButtonText,showRoundedCorner:!0,cssClass:"bbi-designer-reset-btn",size:"mini",click:this.bbdesigner$.proxy(this.resetBasicSettings,this)}),this.ejWaitingIndicator=t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup"),t.BoldBIDashboardScroller({height:"380px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.scrollerObj=t.data("BoldBIDashboardScroller"),BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh(),BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1)},e.prototype.saveBasicSettings=function(){var e,t,i=this.bbdesigner$(this.basicSettingsScrollElement).children(),a=null;if(!BoldBIDashboard.isNullOrUndefined(i)&&(a=i.filter("[data-modified]"),!BoldBIDashboard.isNullOrUndefined(a))){for(e=[],t=0;t<a.length;t++){var o=this.bbdesigner$(a[t]).find(".e-basic-settings-column-name"),s=this.bbdesigner$(a[t]).find(".e-basic-settings-column-value"),o=BoldBIDashboard.isNullOrUndefined(o)?"":o.text(),s=BoldBIDashboard.isNullOrUndefined(s)?"":s.attr("data-color");e.push({Name:o,Color:s.toLocaleUpperCase(),IsEdited:!0})}this.internalDefaultModeObj.DefaultColors=e}this.cancelBtnClick()},e.prototype.closeBasicSettingsDialog=function(){this.basicSettingsDialog.close(),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalDefaultModeObj,this.selectedColumn]),!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator()},e.prototype.resetBasicSettings=function(){var t=this;this.resetValues(),this.showLoadingIndicator(),setTimeout(function(){try{t.getColumnValues(t.selectedColumn,!0)}catch(e){t.dashboardDesigner.designerPanel.logError({Source:"resetBasicSettings",Error:e,Type:e.name}),t.hideLoadingIndicator()}},100)},e.prototype.getSelectedColumnName=function(){var e,t,i,a,o=this,s=this.dataGroupInfo;if(!BoldBIDashboard.isNullOrUndefined(s.Values)&&0<s.Values.length)for(e=s.Values,t=0;t<e.length;t++)for(i=0;i<e[t].Values.length;i++)a=e[t].Values.filter(function(e){return e.DataId===o.selectedColumn.Key&&e.UniqueColumnName===o.selectedColumn.UniqueColumnName})[0],BoldBIDashboard.isNullOrUndefined(a)||(this.selectedColumnName=a.Field,this.basicSettingsDialog.setTitle("Column: "+this.selectedColumnName))},e.prototype.renderRowElement=function(e,t,i){var a=this.dashboardDesigner.element.find("#"+this.id+"_basic_settings_container").width(),o=BoldBIDashboard.buildTag("div.bbi-basic-settings-column-row-element","",{},{id:this.id+"_basic_settings_column_Label"+i}),s=BoldBIDashboard.buildTag("div.e-basic-settings-column-name-element","",{width:62*(a-30)/100+"px"}),a=BoldBIDashboard.buildTag("div.e-basic-settings-column-name bbi-designer-fontfamily bbi-dbrd-designer-hoverable","",{"max-width":62*(a-30)/100-15+"px"},{id:this.id+"_basic_settings_column_Label_Name"+i});a.text(t.Name),s.append(a),o.append(s),a.addClass(BoldBIDashboard.DashboardUtil.isExistTextWidth(a,!0)?"e-title-tip":""),a.hasClass("e-title-tip")&&a.attr("data-tooltip",t.Name),(s=BoldBIDashboard.buildTag("div.e-basic-settings-column-value","",{},{id:this.id+"_basic_settings_column_Label_Value"+i})).attr("data-color",t.Color),this.colorPicker.renderColorPicker(s,this,"enableSaveButton"),o.append(s),!BoldBIDashboard.isNullOrUndefined(t.IsEdited)&&t.IsEdited&&this.bbdesigner$(o).attr({"data-modified":!0}),e.append(o)},e.prototype.populateColumns=function(e,t){var i,a,o,s=[];for(this.dashboardDesigner.modules.resource.updateColorCodeInfo(t),i=JSON.parse(t.Values),o=0;o<i.length;o++)a=!BoldBIDashboard.isNullOrUndefined(this.internalDefaultModeObj)&&0<this.internalDefaultModeObj.DefaultColors.length&&!BoldBIDashboard.isNullOrUndefined(this.internalDefaultModeObj.DefaultColors[o])&&this.internalDefaultModeObj.DefaultColors[o].Name===i[o][this.selectedColumn.UniqueColumnName]?this.internalDefaultModeObj.DefaultColors[o]:null,s.push({Name:e||BoldBIDashboard.isNullOrUndefined(a)?i[o][this.selectedColumn.UniqueColumnName]:a.Name,IsEdited:!e&&!BoldBIDashboard.isNullOrUndefined(a)&&a.IsEdited,Color:e||BoldBIDashboard.isNullOrUndefined(a)?this.defaultColorPalette[o%this.defaultColorPalette.length]:a.Color});for(o=0;o<s.length;o++)this.renderRowElement(this.basicSettingsScrollElement,s[o],o);this.basicSettingsValuesWrapper.append(this.basicSettingsScrollElement),this.basicSettingsContainer.append(this.basicSettingsValuesWrapper),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!0),BoldBIDashboard.isNullOrUndefined(this.scrollerObj)||this.scrollerObj.refresh(),this.hideLoadingIndicator(),this.dashboardDesigner.modules.serialization.notifyChange()},e.prototype.enableSaveButton=function(){var e=this.bbdesigner$(this.basicSettingsScrollElement).children();BoldBIDashboard.isNullOrUndefined(e)||(e=e.filter("[data-modified]"),BoldBIDashboard.isNullOrUndefined(e))?BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!0)},e.prototype.cancelBtnClick=function(){this.basicSettingsDialog.close(),BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.internalDefaultModeObj,this.selectedColumn]),!BoldBIDashboard.isNullOrUndefined(this.ejWaitingIndicator)&&this.ejWaitingIndicator.model.showOnInit&&this.hideLoadingIndicator(),this.bbdesigner$(".e-color-picker").remove()},e.prototype.getColumnValues=function(t,e){var i,a,o,s,n,r;if(BoldBIDashboard.DashboardUtil.buttonEnable(this.okButton,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.resetButton,!1),i=[],a=this.dataGroupInfo,!BoldBIDashboard.isNullOrUndefined(a.Values)&&0<a.Values.length)for(o=a.Values,s=0;s<o.length;s++)for(n=0;n<o[s].Values.length;n++)if(r=o[s].Values.filter(function(e){return e.DataId===t.Key&&e.UniqueColumnName===t.UniqueColumnName})[0],!BoldBIDashboard.isNullOrUndefined(r)){i.push({Id:r.DataId,Name:r.Field,SummaryType:r.SummaryType,Sorting:r.Sorting,CustomSorting:r.CustomSorting,FieldType:r.FieldType,MeasureFormatting:r.MeasureFormatting,DateTimeFormat:r.DateTimeFormat,FilterInfo:r.FilterInfo,UniqueColumnName:r.UniqueColumnName,IsKPIColumn:r.IsKPIColumn,KPIColumnInfo:r.KPIColumnInfo,IsExpression:r.IsExpression,IsAggregatedExpression:r.IsAggregatedExpression});break}this.selectedColumnName=i[0].Name,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnValues,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.WidgetAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnValues,dataset:this.dataGroupInfo.DatasetId,fieldInfo:i})},{fnction:this.bbdesigner$.proxy(this.populateColumns,this,e)},!0)},e.prototype.showLoadingIndicator=function(){this.ejWaitingIndicator&&this.ejWaitingIndicator.show()},e.prototype.hideLoadingIndicator=function(){this.ejWaitingIndicator&&this.ejWaitingIndicator.hide()},e.prototype.openBasicSettingSDialog=function(e,t,i,a){var o=this;this.resetValues(),this.targetInstance=e,this.targetMethod=t,this.selectedColumn=i.selectedColumn,this.colorFields=i.colorFields,this.dsId=i.selectedColumn.Key,this.dataGroupInfo=a,this.internalDefaultModeObj=this.bbdesigner$.extend(!0,{},i.defaultColorSettings),this.basicSettingsDialog.open(),this.getSelectedColumnName(),this.showLoadingIndicator(),setTimeout(function(){try{o.getColumnValues(o.selectedColumn,!1)}catch(e){o.dashboardDesigner.designerPanel.logError({Source:"openBasicSettingSDialog",Error:e,Type:e.name}),o.hideLoadingIndicator()}},100)},e.prototype.resetValues=function(){this.basicSettingsContainer.empty(),this.basicSettingsScrollElement.empty()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColorCustomizationBasicSettings",InternalColorCustomizationBasicSettings,window),function(D){function e(e){this.locale=null,this.designerInst=e,this.id=this.designerInst._id,this.bbdesigner$=this.designerInst.bbdesigner$,this.locale=this.designerInst.getLocalizationContent(),this.propertyPanel=this.designerInst.modules.propertyPanel,this.widgetHelper=this.designerInst.modules.widgetHelper}e.prototype.render=function(e,t,i){this.categoryId=this.designerInst._id+"_"+t+"_"+i.category;var a,o,s,n,r,d,l,h,p,c,u,t=this.propertyPanel.propertyPanelContainer.width(),b=this.designerInst.element.find("#"+this.categoryId),g=i.value,m=null,f=null;0===b.length&&e&&(b=D.buildTag("div","",{width:t-10},{id:this.categoryId}),a=D.buildTag("table.e-designer-exp-table","",{width:"100%"},{unselectable:"on"}),o=D.buildTag("tr","",{height:"28px"},{}),s=D.buildTag("td","",{width:47*(t-47)/100+"px"},{}),n=D.buildTag("td","",{},{}),r=D.buildTag("label.e-designer-fontfamily e-designer-linking-table-row","Enable",{},{id:this.categoryId+"_wdgt_link_text_ckb",for:this.categoryId+"_wdgt_link_ckb"}),d=D.buildTag("input","",{"margin-left":"2px"},{id:this.categoryId+"_wdgt_link_ckb",type:"checkbox"}),m=D.buildTag("ul","",{},{id:this.categoryId+"_wdgt_link_list"}),l=D.buildTag("div","",{height:"auto","min-height":"50px","border-radius":"5px",margin:"7px 3px 7px 10px"},{id:this.categoryId+"_wdgt_link_actions"}),h=D.buildTag("div.e-designer-actions-info bbi-dbrd-designer-hoverable","",{margin:"9px",float:"left","font-size":"12px"},{"data-tooltip":this.locale.propertyPanel.interWidgetLinking.defaultInterWidgetLinking}),p=D.buildTag("div","",{},{}),c=D.buildTag("span.e-designer-fontfamily","",{overflow:"hidden","font-size":"13px",display:"inline-block","font-weight":600,margin:"7px 3px 7px 10px",float:"left"}),f=D.buildTag("input.e-textbox e-designer-fontfamily","",{position:"relative","margin-top":"10px",border:"0px"},{id:this.categoryId+"_wdgt_link_actions_custom_txt"}),(u=D.buildTag("div","",{display:"none"},{id:this.categoryId+"_wdgt_link_custom_input_container"})).append(f),l.append(p,u),n.append(d),a.append(o.clone().append(s.clone().append(r),n),o.clone().append(s.clone().append(c.clone().html("Widgets"))),o.clone().append(s.clone().attr("colspan",2).append(m)),o.clone().append(s.clone().append(c.clone().html("Actions")).append(h)),o.clone().append(s.clone().attr("colspan",2).append(l))),b.append(a),e.append(b),(u=[]).push({isChecked:!1,label:"Custom",value:"custom",id:this.categoryId+"_wdgt_link_actions_custom"}),u.unshift({isChecked:!0,label:"Default",value:"default",id:this.categoryId+"_wdgt_link_actions_default"}),r={callBackMethod:"onActionRadioClick",callBackInstance:this,dataSource:u,optionalArgs:this.categoryId,labelPosition:D.Dashboard.LabelPosition.After,groupName:this.categoryId+"_wdgt_link_actions",triggerOnCodeUpdate:!0},this.actionRadio=new D.Dashboard.RadioButton(r,p),this.actionRadio.disableAllItems(!0),d.BoldBIDashboardCheckBox({width:57*(t-33)/100-15+"px",change:this.bbdesigner$.proxy(this.onEnableChkbxClick,this),cssClass:"e-designer-prop-checkbox"}),this.tabListInst=m.BoldBIDashboardListBox({dataSource:[],enabled:!1,fields:{text:"widgetJson.ContainerSettings.Title",value:"Name"},showRoundedCorner:!0,cssClass:"e-designer-param-assign e-designer-border e-designer-list-selection e-dbrd-designer-scroller e-dbrd-control",width:"100%",height:"200px",template:"<span class='bbi-desgnr-inter-wdgt-list'><input class='bbi-desgnr-inter-wdgt-list-input' type='checkbox' id ='"+this.categoryId+"_wdgt_link_list${Name}'/><label>${widgetJson.ContainerSettings.Title}</label></span>",select:this.bbdesigner$.proxy(this.onTabItemSelect,this),selectedIndex:0}).data("BoldBIDashboardListBox"),f.ejNumericTextbox({value:1,minValue:1,width:"160px",showRoundedCorner:!0,showSpinButton:!1,change:this.bbdesigner$.proxy(this.itemNameChange,this)})),0<b.length&&(b.css("display",D.isNullOrUndefined(i.isVisible)||i.isVisible?"block":"none"),n=this.designerInst.modules.widgetHelper.getAllWidgets().filter(function(e){return e instanceof D.ContainerWidget&&e.hasMultipleRegion}),this.tabListInst=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_list").data("BoldBIDashboardListBox"),this.tabListInst.option("dataSource",[]),this.tabListInst.option("dataSource",n),D.isNullOrUndefined(m)&&(m=b.find("#"+this.categoryId+"_wdgt_link_list")),0<n.length&&!D.isNullOrUndefined(m)&&(m.off("click",".bbi-desgnr-inter-wdgt-list-input",this.bbdesigner$.proxy(this.onTabItemChecked,this)),m.on("click",".bbi-desgnr-inter-wdgt-list-input",this.bbdesigner$.proxy(this.onTabItemChecked,this))),D.isNullOrUndefined(g)?(this.linkItem=this.populateLinkModel(i),this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:this.linkItem.value.Enable})):(this.linkItem=i,this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_ckb").data("BoldBIDashboardCheckBox").setModel({checked:g.Enable}),this.updateSelectedWidgets(m,g,n)),0===i.value.WidgetList.length)&&(this.actionRadio.disableAllItems(!0),this.actionRadio.updateItemByValue("default",!0),this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_custom_input_container").hide())},e.prototype.itemNameChange=function(e){var t;e.isInteraction&&(t=this.tabListInst.getSelectedItems()[0].data.Name,t=this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(t)),this.linkItem.value.WidgetList[t].CustomIndex=e.value,this.updateWidgetProperty(this.linkItem))},e.prototype.updateSelectedWidgets=function(e,t,i){var a,o=[];for(i.forEach(function(e){return o.push(e.Name)}),a=0;a<t.WidgetList.length;a++)e.find("#"+this.categoryId+"_wdgt_link_list"+t.WidgetList[a].Widget).prop("checked",!0);0<t.WidgetList.length&&(a=o.indexOf(t.WidgetList[0].Widget),this.tabListInst.setModel({selectedIndex:a}),this.updateRadioButton(t.WidgetList[0]),this.updateCustomIndex(t.WidgetList[0],!0))},e.prototype.updateRadioButton=function(e){e.LinkType===WidgetLinkType.Custom?(this.actionRadio.updateItemByValue("custom",!0),this.linkItem.renderDefault&&this.actionRadio.updateItemByValue("default",!1)):(this.actionRadio.updateItemByValue("custom",!1),this.linkItem.renderDefault&&this.actionRadio.updateItemByValue("default",!0))},e.prototype.updateCustomIndex=function(e,t){var i=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_custom_input_container"),a=this.designerInst.element.find("#"+this.categoryId+"_wdgt_link_actions_custom_txt").data("ejNumericTextbox");e.LinkType===WidgetLinkType.Custom?t?(i.show(),a.option("value",e.CustomIndex),this.updateMaxCustom(a)):i.hide():(i.hide(),a.option("value",""),this.updateMaxCustom(a))},e.prototype.updateMaxCustom=function(e){var t,i;0<this.tabListInst.getSelectedItems().length&&(t=this.tabListInst.getSelectedItems()[0].data.Name,i=this.designerInst.modules.widgetHelper.getAllWidgets().filter(function(e){return e instanceof D.ContainerWidget&&e.hasMultipleRegion}).filter(function(e){return e.Name===t})[0],i=this.designerInst.modules.containerTypeWidgetHelper.getWidgetAsContainerWidget(i).getContainerRegions(),e.option("maxValue",i))},e.prototype.onActionRadioClick=function(e){var t=this.tabListInst.getSelectedItems()[0].data.Name,t=this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(t));this.linkItem.value.WidgetList[t].LinkType="custom"===e.args.value?WidgetLinkType.Custom:WidgetLinkType.Default,this.updateCustomIndex(this.getSelectedLinkWidget(),!0),this.updateWidgetProperty(this.linkItem)},e.prototype.onTabItemChecked=function(e){var e=this.bbdesigner$(e.currentTarget).is(":checked"),t=this.tabListInst.getSelectedItems()[0].data.Name,i=new LinkedWidgetList,a=this.linkItem;e?(i.Widget=t,this.linkItem.renderDefault||(i.LinkType=WidgetLinkType.Custom,i.CustomIndex="1"),a.value.WidgetList.push(i)):a.value.WidgetList.splice(this.linkItem.value.WidgetList.indexOf(this.getActiveWidgetList(t)),1),this.updateWidgetProperty(a),this.linkItem.value=a.value},e.prototype.onTabItemSelect=function(e){var t;e.isInteraction&&(t=!1,e.item.find("input[type=checkbox]").is(":checked")?(this.actionRadio.disableAllItems(!1),this.linkItem.renderDefault||this.actionRadio.disableByValue("default",!0),t=!0):this.actionRadio.disableAllItems(!0),e=this.getSelectedLinkWidget(),this.updateRadioButton(e),this.updateCustomIndex(e,t))},e.prototype.getSelectedLinkWidget=function(){var e=new LinkedWidgetList,t=this.tabListInst.getSelectedItems()[0].data.Name;return e.Widget=t,0<this.linkItem.value.WidgetList.length&&(t=this.getActiveWidgetList(e.Widget),!D.isNullOrUndefined(t))?t:(this.linkItem.renderDefault||(e.LinkType=WidgetLinkType.Custom,e.CustomIndex="1"),e)},e.prototype.getActiveWidgetList=function(e){for(var t=0;t<this.linkItem.value.WidgetList.length;t++)if(e===this.linkItem.value.WidgetList[t].Widget)return this.linkItem.value.WidgetList[t];return null},e.prototype.onEnableChkbxClick=function(e){var t;e.isChecked?(e.isInteraction&&((t=this.populateLinkModel(JSON.parse(JSON.stringify(this.linkItem)))).value.Enable=e.isChecked,this.updateWidgetProperty(t),this.linkItem.value=t.value,this.refreshWidget()),this.actionRadio.disableAllItems(!1),this.tabListInst.enable()):(this.tabListInst.disable(),this.actionRadio.disableAllItems(!0))},e.prototype.updateWidgetProperty=function(e){var t=this.widgetHelper.getCurrentWidgetInstance();t.restoreActiveTab(t),t.updateWidgetLink(e.value),this.designerInst.modules.serialization.notifyChange()},e.prototype.populateLinkModel=function(e){return e.value=this.createDashboardLinks(),e},e.prototype.createDashboardLinks=function(){return{WidgetList:[],Enable:!1}},e.prototype.refreshWidget=function(){},D.InterWidgetLink=e}(BoldBIDashboard=BoldBIDashboard||{}),function(l){function e(e,t,i){this.itemPanelWidth=240,this.dataPanelWidth=36,this.id=e,this.element=t,(this.designer=i).widgetHelper=i.modules.widgetHelper,BoldBIDashboardDesigner.editManager=this.designer.modules.undoManager,new l.DashboardDesignerUtility.OAuthHelper(this.designer)}e.prototype.render=function(e){this.designerContainer=l.buildTag("div.bbi-dashboard-designer boldbi-dashboarddesigner","",{height:"100%","box-sizing":"border-box"},{id:this.id+"_designerContainer"});var t=this.designAreaTag=l.buildTag("div.bbi-dashboard-designer bbi-userselect bbi-dashboarddesigner-designAreaContainer","",{},{id:this.id+"_designAreaContainer"}),i=this.itemPanelTag=l.buildTag("div.bbi-dbrd-designer-item-panel","",{width:this.itemPanelWidth+"px"},{id:this.id+"_itemPanelContainer"}),a=this.designPanelTag=l.buildTag("div.bbi-dashboarddesigner-surfaceContainer","",{width:e,border:"0px solid var(--designer-primary-border-color)","border-left-width":"1px",height:"100%",float:"left","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground(),"box-sizing":"border-box"},{id:this.id+"_designSurfaceContainer"}),o=this.dataPanelTag=l.buildTag("div","",{width:this.dataPanelWidth+"px",height:"100%",float:"right","box-sizing":"border-box","background-color":"white"},{id:this.id+"_dataPanelContainer"});this.element.append(this.designerContainer),this.renderToolBar(this.designerContainer,e),t.append(i,a,o),this.designerContainer.append(t),this.setContainerSize(this.designer.toolbarTag),this.getWidgetInfo(this.itemPanelTag,this.designer),this.updateDataConfigurationPanel()},e.prototype.postRender=function(){},e.prototype.getWidgetInfo=function(e,t){!l.isNullOrUndefined(this.designer.model.widgetGuids)&&0<this.designer.model.widgetGuids.length||l.isNullOrUndefined(t.model.serviceAuthorizationToken)||""===t.model.serviceAuthorizationToken||t.model.environment===l.DashboardDesignerUtility.Serialization.enumToString(l.Environment,l.Environment.cloud)?this.renderItemPanel(this.itemPanelTag,"{}"):t.modules.util.doAjaxPost("GET",t.model.serviceUrl+l.Dashboard.ServiceAPI.widgetsettings,{},{fnction:this.designer.bbdesigner$.proxy(this.renderItemPanel,this,e)},!0)},e.prototype.setContainerSize=function(e){var t=this.element.height(),i=this.element.width(),a=0,o=0,s=0,e=(l.isNullOrUndefined(e)||(a=e.height(),o=parseFloat(e.css("border-top-width")),s=parseFloat(e.css("border-bottom-width"))),parseFloat(this.designAreaTag.css("border-top-width"))),n=parseFloat(this.designAreaTag.css("border-bottom-width")),r=parseFloat(this.designAreaTag.css("border-left-width")),d=parseFloat(this.designAreaTag.css("border-right-width")),t=t-a-(o+s),a=t-(n+e),o=i-(this.itemPanelTag.width()+this.dataPanelTag.width());this.designAreaTag.css({height:t+"px",width:i+"px"}),this.itemPanelTag.height(a),this.dataPanelTag.height(a),this.designPanelTag.css({height:a+"px",width:o-(r+d)+"px"})},e.prototype.renderCanvas=function(){this.designCanvas=l.buildTag("div.bbi-dashboarddesigner-designcanvas","",{"box-sizing":"border-box",position:"relative",margin:"0 auto"},{id:this.id+"_designCanvas",tabindex:"0"}),this.canvasContainer=l.buildTag("div.bbi-dbrd-designcanvas-container bbi-dbrd-designcanvas-scroller","",{width:"100%",height:"100%",overflow:"auto","box-sizing":"border-box","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground()},{id:this.id+"_scrollContentDesignPanel"}),this.helperItem=l.buildTag("div","",{border:"1px solid #cccccc","background-color":"transparent",position:"absolute",display:"none","z-index":"1002","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_helperItem"}),this.placingItem=l.buildTag("div.bbi-placing-cell","",{border:"1px solid #179bd7","background-color":"rgba(210, 239, 247, 0.6)",position:"absolute",display:"none","z-index":"1001","pointer-events":"none","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_placingItem",row:"0",column:"0"}),this.scrollUIItem=l.buildTag("div.bbi-dbrd-scroll-ui-container","",{},{}),this.designCanvas.append(this.helperItem,this.placingItem),this.canvasContainer.append(this.designCanvas),this.designer.model.designerSettings.widgetsPanel.dragAndDropSettings.isWidgetMode||this.canvasContainer.append(this.scrollUIItem),this.hideAddRowsIcon()},e.prototype.hideAddRowsIcon=function(){!l.isNullOrUndefined(this.designer.model)&&!l.isNullOrUndefined(this.designer.model.designCanvasSettings)&&!l.isNullOrUndefined(this.designer.model.designCanvasSettings.restrictScrollableDashboard)&&this.designer.model.designCanvasSettings.restrictScrollableDashboard?this.scrollUIItem.addClass("hide-addrows-icon"):this.scrollUIItem.removeClass("hide-addrows-icon")},e.prototype.renderCells=function(){this.designer.designerPanel.updateDesignCanvasSize(),this.designer.designerPanel.updateCanvasItemSize(),this.designer.designerPanel.renderCellItems(0,this.designer.designerPanel.rowsLength*this.designer.designerPanel.columnsLength),this.designer.designerPanel.updateScrollBar(),this.scrollUIItem[0].innerHTML=this.getAddRowsIcon()},e.prototype.renderToolBar=function(e,t){this.designer.rptToolbar=new l.DashboardDesignerUtility.Toolbar(this.designer,e),this.designer.rptToolbar.renderToolBar(e,40,t)},e.prototype.renderItemPanel=function(e,t){"{}"!==t&&(this.designer.model.widgetGuids=JSON.parse(JSON.parse(t).WidgetIds)),this.designer.dragDropHelper=new l.DashboardDesignerUtility.DragdropHelper(this.designer),this.designer.itemPanel=new l.DashboardDesignerUtility.ItemPanel(this.designer,e);t=this.designer.element.find(".bbi-dashboarddesigner-cellitem");!l.isNullOrUndefined(t)&&0<t.length&&this.designer.triggerDesignerEvent(ViewerEvent.actionComplete,ViewerEventType.layoutRendered)},e.prototype.updateDataConfigurationPanel=function(){this.designer.dataConfigurationPanel=this.designer.modules.dataConfigurationPanel},e.prototype.refreshCanvas=function(e){this.setContainerSize(e.toolbarTag),this.renderItemPanel(e.modules.Mode.itemPanelTag,"{}"),this.designer.itemPanel.renderGroup()},e.prototype.getAddRowsIcon=function(){return"<div class='"+(Boolean(l.DashboardUtil.getCookie("syncfusion.dashboard.designer.scrollinfo"))?"bbi-dbrd-scroll-icon-container":"bbi-dbrd-scroll-icon-container e-scroll-dbrd-init")+"'><div class='bbi-dbrd-scroll-icon-bg-line-container'><div class ='bbi-dbrd-scroll-icon-bg-line'></div></div><div class='bbi-dbrd-scroll-plus-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable'><div class= 'bbi-dbrd-designer-hoverable-icon' data-tooltip='Add/Delete Rows'></div></div></div>"},e.prototype.renderCellsForExport=function(){},e.prototype.previewDashboard=function(){},e.prototype.updateSizeForScrollExport=function(){},e.prototype.resizeCombineWidgetForWidgetExport=function(){},e.prototype.wireEvents=function(){this.designer.element.on("mouseover",".bbi-dbrditem",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onWidgetMouseOver,this)),this.designer.element.on("mouseleave",".bbi-dbrditem",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onWidgetMouseLeave,this)),this.designer.element.on("mousedown",".bbi-combine-item",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onCombineWidgetClick,this)),this.designer.element.on("click",".bbi-dbrd-view-data-export-menu-icon",this.designer.bbdesigner$.proxy(this.designer.viewDataPanel.viewDataExport,this.designer))},e.prototype.unwireEvents=function(){this.designer.element.off("mouseover",".bbi-dbrditem",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onWidgetMouseOver,this)),this.designer.element.off("mouseleave",".bbi-dbrditem",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onWidgetMouseLeave,this)),this.designer.element.off("mousedown",".bbi-combine-item",this.designer.bbdesigner$.proxy(l.Dashboard.WidgetContainerHelper.onCombineWidgetClick,this)),l.isNullOrUndefined(this.designer.viewDataPanel)||this.designer.element.off("click",".bbi-dbrd-view-data-export-menu-icon",this.designer.bbdesigner$.proxy(this.designer.viewDataPanel.viewDataExport,this.designer))},l.DesignMode=e}(BoldBIDashboard=BoldBIDashboard||{}),InternalRefreshDialog=function(){function e(e){this.dashboardDesigner=null,this.footerTag=null,this.refreshSetting=null,this.ejListBoxObj=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.dashboardDesigner.isDesignMode()&&this.renderContainer()}return e.prototype.addIcon=function(){var e=this.dashboardDesigner.isHelpLinkHidden()?"":"<a href='"+this.dashboardDesigner.getHelpDocLink("RefreshDashboard")+"' target='_blank' class ='bbi-dbrd-refresh-widget-interval-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip ='"+this.locale.scrollableLayout.knowmore+"'></a>";this.refreshContainer.find(".bbi-dbrd-radio-btn-wrapper").children(".e-radio-wrapper").eq(1).append(e)},e.prototype.renderContainer=function(){var e=BoldBIDashboard.buildTag("div.bbi-dbrd-dyn-con-switch-wrap","",{},{id:this.id+"_auto_refresh_switch"}),t=(this.refreshContainer=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_refresh_Container"}),BoldBIDashboard.buildTag("div.bbi-autorefresh-container bbi-autorefresh-disabled")),i=BoldBIDashboard.buildTag("div.bbi-refresh-container","",{width:"498px","max-height":"496px","padding-left":"20px","padding-right":"14px","padding-top":"7px","padding-bottom":"7px"},{id:this.id+"_containerDiv"}),a="<b>"+this.locale.downloadUpload.schemaDsNoteText+"</b> "+this.locale.refreshWindow.refreshAlertContent,a=BoldBIDashboard.buildTag("span.bbi-refresh-alert-content",a,{},{id:this.id+"refresh_alert_text"}),o=BoldBIDashboard.buildTag("div","",{}),a=(i.append(a).append(o),BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"})),s=BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"}),n=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),r=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),d=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),l=BoldBIDashboard.buildTag("div.bbi-dbrd-filter-dlg-mode-btn-wrapper","",{},{id:this.id+"_filter_btn_wrapper"}),h=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.enbaleAutoRefresh,{"font-size":"13px","margin-left":"5px"},{for:this.id+"_autoCheckBox",type:"label"}),h=(n.append(e),r.append(l),d.append(h),a.append(d,n),s.append(r),o.append(a),t.append(s),i.append(o),BoldBIDashboard.buildTag("div","",{})),d=BoldBIDashboard.buildTag("div","",{"padding-bottom":"8px",display:"flex","flex-direction":"row","padding-left":"32px"},{colspan:"2"}),n=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-numericcheckbox left-align","",{float:"left","margin-left":"31px",width:"98px",height:"24px",color:"var(--primary-text-normal-color)"},{id:this.id+"_timeCheckBox"}),r=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","HH:mm:ss",{"font-size":"13px",display:"flex","align-items":"center","padding-left":"10px"},{type:"label"}),a=BoldBIDashboard.buildTag("span.bbi-designer-error-icon bbi-designer-errorinfo e-error-tip bbi-dbrd-designer-hoverable bbi-designer-commontime-error","",{},{id:this.id+"_refresh_error_info_icon","data-tooltip":this.locale.refreshWindow.commonTimeErrorMessage}),s=(d.append(n).append(r).append(a),h.append(d),t.append(h),i.append(t),BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"})),o=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),r=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),a=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-refreshcheckbox","",{},{id:this.id+"_refreshCheckBox"}),d=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.refreshWidget,{"font-size":"13px","margin-left":"5px"},{for:this.id+"_refreshCheckBox",id:this.id+"_refreshLabel",type:"label"}),h=(o.append(a),r.append(d),s.append(o).append(r),t.append(s),i.append(t),BoldBIDashboard.buildTag("div","",{},{id:this.id+"_listRow"})),d=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"42px"},{colspan:"2"}),o=BoldBIDashboard.buildTag("div.bbi-designer-inputPath","",{width:"100%",height:"140px",border:"1px unset"},{id:this.id+"_listBox"}),r=BoldBIDashboard.buildTag("ul","",{},{id:this.id+"_refresh_setting_list_Box"}),s=(o.append(r),d.append(o),h.append(d),t.append(h),i.append(t),BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"})),o=BoldBIDashboard.buildTag("div","",{"padding-top":"24px","padding-bottom":"8px"}),d=BoldBIDashboard.buildTag("div","",{"padding-top":"24px","padding-bottom":"8px"}),h=BoldBIDashboard.buildTag("input.bbi-designer-inputPath","",{},{id:this.id+"_insertCheckBox"}),p=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.rowInsertDelete,{"font-size":"13px","margin-left":"5px"},{for:this.id+"_insertCheckBox",id:this.id+"_insertLabel",type:"label"}),p=(o.append(h),d.append(p),s.append(o).append(d),t.append(s),i.append(t),BoldBIDashboard.buildTag("div","",{display:"flex","flex-direction":"row",gap:"8px"})),o=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),d=BoldBIDashboard.buildTag("div","",{"padding-top":"5px","padding-bottom":"8px"}),s=BoldBIDashboard.buildTag("input.e-reportdesigner-inputPath-loading","",{},{id:this.id+"_insertLoadingCheckBox"}),c=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily",this.locale.refreshWindow.removeLoader,{"font-size":"13px","margin-left":"5px"},{for:this.id+"_insertLoadingCheckBox",id:this.id+"_insertLoadingLabel",type:"label"}),u=BoldBIDashboard.buildTag("div.e-dbrd-autorefresh-description bbi-dbrd-designer-hoverable","",{"padding-left":"5px","padding-top":"2px",cursor:"pointer",float:"right"},{"data-tooltip":this.locale.refreshWindow.removeLoaderDescription}),b=BoldBIDashboard.buildTag("span.e-dbrd-autorefresh-notifyicon bbi-designer-notifyinfo","",{});u.append(b),d.append(u),o.append(s),d.append(c),p.append(o,d),t.append(p),i.append(t),b=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right",height:"28px","margin-right":"10px"},{id:this.id+"_apply_btn",type:"button"}),u=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-hand-cursor bbi-dbrd-btn-secondary",this.locale.dialogOptions.cancelButtonText,{float:"right",height:"28px"},{id:this.id+"_cancel_btn",type:"button"}),this.refreshContainer.append(i),this.dashboardDesigner.element.append(this.refreshContainer),this.refreshContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:498,minHeight:380,title:this.locale.refreshWindow.title,enableResize:!1,showOnInit:!1,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-ejdialog boldbi-dashboarddesigner",enableModal:!0,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_refresh_Container_foot"),this.footerTag.append(u).append(b),c={callBackInstance:this,callBackMethod:"autoRefreshCheck",checkState:!1,optionalArgs:this.id,name:"auto-refresh-switch",cssClass:"bbi-refresh-switch"},this.defaultSwitch=new BoldBIDashboard.Dashboard.SwitchButton(c,e),(o=new Date).setHours(0,0,1),d={cssClass:"bbi-dbrd-control bbi-common-timer bbi-dbrd-timer",format:"HH:mm:ss",min:o,value:o,width:"120px",showClearButton:!1,strictMode:!0,change:this.bbdesigner$.proxy(this.onTimePickerChange,this)},this.commonTimer=new ejdashboard.calendars.TimePicker(d),this.commonTimer.appendTo("#"+n.attr("Id")),p={size:"small",checked:!1,disabled:!0,change:this.bbdesigner$.proxy(this.listItemEnable,this)},this.refereshWidget=BoldBIDashboard.DashboardUtil.createCheckbox(p,a[0]),BoldBIDashboard.DashboardUtil.InjectCheckBoxInListBoxEJ2(),t={cssClass:"bbi-dashboarddesigner bbi-designer-param-assign bbi-refresh-listbox bbi-designer-border bbi-dbrd-control bbi-designer-box-shadow",height:"186px",dataSource:[],enabled:!1,itemTemplate:"<div class= 'bbi-refresh-container bbi-dbrd-designer-hoverable' data-tooltip = '${text}'>${text}</div>",selectionSettings:{showCheckbox:!0,mode:"Multiple"},change:this.bbdesigner$.proxy(this.listBoxSelection,this)},this.listBox=new ejdashboard.dropdowns.ListBox(t),this.listBox.appendTo("#"+r.attr("Id")),this.ejListBoxObj=r.data("BoldBIDashboardListBox"),this.rowInfo=BoldBIDashboard.DashboardUtil.createCheckbox({checked:!1,disabled:!0},h[0]),this.loadingInfo=BoldBIDashboard.DashboardUtil.createCheckbox({checked:!1,disabled:!0},s[0]),u.on("click",this.bbdesigner$.proxy(this.closeRefreshSetting,this)),b.on("click",this.bbdesigner$.proxy(this.applyRefreshSetting,this)),this.createRadioBtnSection(l),this.addIcon(),n.off("keyup",this.bbdesigner$.proxy(this.genericInputValidation,this,n)),n.on("keyup",this.bbdesigner$.proxy(this.genericInputValidation,this,n))},e.prototype.listBoxSelection=function(e){var t,i,a;BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.event.target)||((t=this.bbdesigner$(e.event.target)).hasClass("bbi-refresh-list-timer")||0<t.parents(".bbi-refresh-list-timer").length?(a=this.bbdesigner$(t.parents(".e-list-item")[0]).attr("data-value"),(i=[]).push(a),BoldBIDashboard.isNullOrUndefined(e.value)||(this.isValueSelected(e.value,a)?this.listBox.selectItems(i,!1):this.listBox.selectItems(i,!0))):this.refreshContainer.find("#"+this.id+"_auto_refresh_widget_rdo_input").prop("checked")&&(!1===t.hasClass("e-list-item")&&(a=t.parents(".e-list-item"),BoldBIDashboard.isNullOrUndefined(a)||(t=a)),!BoldBIDashboard.isNullOrUndefined(e.value))&&t.hasClass("e-list-item")&&this.displayRefreshListTimer(e,t))},e.prototype.displayRefreshListTimer=function(e,t){for(var i=this.refreshContainer.find(".e-list-item").toArray(),a=this.listBox.getDataByElems(this.listBox.getItems()),o=0;o<i.length;o++){var s=t.attr("data-value"),n=a[o].text,r=a[o].id;this.isValueSelected(e.value,s)&&n===s?(t.find(".bbi-refresh-list-timer").removeClass("bbi-refresh-timer-hidden"),this.onListTimePickerChange(r,e)):n===s&&(t.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden"),this.refreshErrorIndicatorVisibility(!1,r))}},e.prototype.isValueSelected=function(e,t){return 0<e.filter(function(e){return e==t}).length},e.prototype.createRadioBtnSection=function(e){var t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_btn_grp"});e.append(t),e={callBackInstance:this,callBackMethod:"updateRefreshType",groupName:"refresh",triggerOnCodeUpdate:!0,labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_auto_refresh_dashboard",label:this.locale.refreshWindow.commonTimeInterval,isChecked:!0,value:"default"},{id:this.id+"_auto_refresh_widget",label:this.locale.refreshWindow.differentTimeInterval,isChecked:!1,value:"custom"}]},this.radioBtn=new BoldBIDashboard.Dashboard.RadioButton(e,t)},e.prototype.updateRefreshType=function(e){BoldBIDashboard.isNullOrUndefined(e.args)||BoldBIDashboard.isNullOrUndefined(e.args.name)||BoldBIDashboard.isNullOrUndefined(e.args.value)||"change"===e.args.name&&("custom"===e.args.value?(this.isWidgetTimer=!0,this.commonTimer.enabled=!1,this.refereshWidget.disabled=!0,this.enableListBox(),this.enableTimerOnSwitch(),this.refreshErrorIndicatorVisibility(!1)):(this.isWidgetTimer=!1,this.commonTimer.enabled=!0,this.refreshContainer.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden"),this.refereshWidget.disabled=!1,this.refereshWidget.checked?this.enableListBox():this.disableListBox(),this.onTimePickerChange(),this.defaultErrorIndicatorVisibility()))},e.prototype.errorIndicatorVisibility=function(e){for(var t=this.listBox.getSelectedItems(),i=this.listBox.getDataByElems(this.listBox.getItems()),a=0;a<t.length;a++){var o=this.bbdesigner$(t[a]),o=this.getItemIdFromText(i,o.attr("data-value")),s=this.dashboardDesigner.element.find("#"+this.id+"_refresh_list_timer_"+o).val();e&&""===s?this.refreshErrorIndicatorVisibility(!0,o):this.refreshErrorIndicatorVisibility(!1,o)}},e.prototype.defaultErrorIndicatorVisibility=function(){this.errorIndicatorVisibility(!1)},e.prototype.customErrorIndicatorVisibility=function(){this.errorIndicatorVisibility(!0)},e.prototype.enableTimerOnSwitch=function(){for(var e=this.listBox.getSelectedItems(),t=0;t<e.length;t++)this.bbdesigner$(e[t]).find(".bbi-refresh-list-timer").removeClass("bbi-refresh-timer-hidden"),this.customErrorIndicatorVisibility()},e.prototype.updateAutoRefreshSwitch=function(e){var t=this.getDynamicConnectionSwitch();BoldBIDashboard.isNullOrUndefined(t)||t.updateValueByName("auto-refresh-switch",e)},e.prototype.getDynamicConnectionSwitch=function(){return this.dashboardDesigner.element.find("#"+this.id+"_auto_refresh_switch").data("DesignerPropertyWidget")},e.prototype.openRefreshDialog=function(e,t){e.widgetCollection=BoldBIDashboard.isNullOrUndefined(e.widgetCollection)?[]:e.widgetCollection,this.refreshContainer.BoldBIDashboardDialog("open"),this.resetUIElements(),e.enableAutoRefresh||(e.interval="00:00:30"),this.refreshSetting=e,this.callBackfn=t,this.populateRefreshInfo(this.refreshSetting),this.validateCheckedElement()},e.prototype.renderTimerInListBox=function(){for(var e=this.refreshContainer.find(".e-list-item").toArray(),t=this.listBox.getDataByElems(this.listBox.getItems()),i=0;i<e.length;i++){var a=this.bbdesigner$(e[i]),o=this.getItemIdFromText(t,a.attr("data-value")),s=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-numericcheckbox left-align","",{float:"right","margin-left":"31px",width:"98px",height:"24px"},{id:this.id+"_refresh_list_timer_"+o,widgetId:o}),n=BoldBIDashboard.buildTag("span.bbi-designer-error-icon bbi-designer-errorinfo e-error-tip bbi-dbrd-designer-hoverable bbi-designer-differedtime-error","",{},{id:this.id+"_refresh_error_info_icon_list_"+o,"data-tooltip":this.locale.refreshWindow.differentTimeErrorMessage});a.append(s).append(n),(a=new Date).setHours(0,0,1),(n=new Date).setHours(0,0,30),new ejdashboard.calendars.TimePicker({cssClass:"bbi-dbrd-control bbi-dbrd-timer bbi-refresh-list-timer bbi-refresh-timer-hidden",format:"HH:mm:ss",min:a,value:n,width:"120px",showClearButton:!1,strictMode:!0,change:this.bbdesigner$.proxy(this.onListTimePickerChange,this,o)}).appendTo("#"+s.attr("Id")),s.off("keyup",this.bbdesigner$.proxy(this.genericInputValidation,this,s)),s.on("keyup",this.bbdesigner$.proxy(this.genericInputValidation,this,s))}},e.prototype.genericInputValidation=function(e){var t;BoldBIDashboard.isNullOrUndefined(e.val())||(t=e.val(),/^[0-9:]*$/.test(t))||e.val("")},e.prototype.getItemIdFromText=function(e,t){for(var i=0;i<e.length;i++)if(e[i].text===t)return e[i].id},e.prototype.getItemTextFromText=function(e,t){for(var i=0;i<e.length;i++)if(e[i].id===t)return e[i].text},e.prototype.validateCheckedElement=function(){for(var e,t=this.listBox.dataSource,i=0;i<t.length;i++)for(e=0;e<this.refreshSetting.widgetCollection.length;e++)this.refreshSetting.widgetCollection[e].widgetID===t[i].widgetID&&this.ejListBoxObj.checkItemByIndex(i)},e.prototype.closeRefreshSetting=function(){this.refreshContainer.BoldBIDashboardDialog("close")},e.prototype.resetUIElements=function(){this.refreshSetting=null},e.prototype.applyRefreshSetting=function(){var e,t,i,a=this.getTime(this.commonTimer);if(!BoldBIDashboard.isNullOrUndefined(a)){for(e=this.listBox.getDataByElems(this.listBox.getSelectedItems()),t=0;t<e.length;t++)if((i={widgetID:e[t].id,widgetName:e[t].text}).widgetInterval=this.getTimeForWidget(i.widgetID),BoldBIDashboard.isNullOrUndefined(i.widgetInterval))return;(a=this.getRefreshValue())&&a.__type&&delete a.__type,null!==a&&this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.notifypropertychange,{action:BoldBIDashboard.DashboardUtil.DesignerAction.NotifyPropertyChange,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.refreshsettings,refreshJson:a})},{fnction:this.bbdesigner$.proxy(function(e){e.Status||console.info(e.Message)},this)}),BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,a),this.closeRefreshSetting()}},e.prototype.getRefreshValue=function(){var e,t,i,a="on"===this.defaultSwitch.getState();if(a){for(this.refreshSetting.enableAutoRefresh=a,a=this.refereshWidget.checked,this.refreshSetting.isRefreshWidget=a,a=this.getTime(this.commonTimer),this.refreshSetting.interval=a,e=this.listBox.getDataByElems(this.listBox.getSelectedItems()),this.refreshSetting.widgetCollection=[],this.refreshSetting.isWidgetTimer=this.isWidgetTimer,t=0;t<e.length;t++)(i={widgetID:e[t].id,widgetName:e[t].text}).widgetInterval=this.getTimeForWidget(i.widgetID),this.refreshSetting.widgetCollection.push(i);return a=this.rowInfo.checked,this.refreshSetting.isRefreshRowCount=a,this.refreshSetting.removeLoader=Boolean(this.loadingInfo.checked),this.refreshSetting}return this.refreshSetting=this.dashboardDesigner.getDefaultRefershSetting()},e.prototype.getTimeForWidget=function(e){return this.getTime(this.getTimerComponent(e))},e.prototype.getTimerComponent=function(e){return ejdashboard.base.getComponent(this.refreshContainer.find("#"+this.id+"_refresh_list_timer_"+e)[0],"timepicker")},e.prototype.getTime=function(e){if(!BoldBIDashboard.isNullOrUndefined(e.value))return e.value.getHours()+":"+e.value.getMinutes()+":"+e.value.getSeconds()},e.prototype.getAllWidgets=function(){var t=[];return this.widgetHelper.getAllWidgets().forEach(function(e){"Label"===e.Type||BoldBIDashboard.Dashboard.WidgetHelper.isContainerWidget(e)||t.push(e)}),t},e.prototype.getWidgetCollection=function(){for(var e,t=[],i=this.getAllWidgets(),a=0;a<i.length;a++)e=i[a].getJson(),t.push({widgetName:e.ContainerSettings.Title,widgetID:e.UniqueName});return t},e.prototype.getWidgetCollectionData=function(){for(var e,t=[],i=this.getAllWidgets(),a=0;a<i.length;a++)e=i[a].getJson(),t.push({text:e.ContainerSettings.Title,id:e.UniqueName});return t},e.prototype.populateRefreshInfo=function(e){!e.enableAutoRefresh||!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.cacheSettings)&&this.dashboardDesigner.cacheSettings.isCacheEnable?(this.refreshContainer.find(".bbi-autorefresh-container").addClass("bbi-autorefresh-disabled"),this.disableAutoRefresh()):(this.refreshContainer.find(".bbi-autorefresh-container").removeClass("bbi-autorefresh-disabled"),this.refreshContainer.find("#"+this.id+"refresh_alert_text").css("display","none"),this.enableAutoRefresh()),this.isWidgetTimer=e.isWidgetTimer,this.updateAutoRefreshSwitch(e.enableAutoRefresh),this.rowInfo.checked=e.isRefreshRowCount,this.updateWidgetList(),this.updateListBox(e.widgetCollection,e.isWidgetTimer),this.updateDataToTimer(e.interval,this.commonTimer),this.refereshWidget.checked=e.isRefreshWidget,this.refereshWidget.checked||this.isWidgetTimer?this.enableListBox():this.disableListBox(),this.loadingInfo.checked=e.removeLoader,e.isWidgetTimer?(this.refereshWidget.disabled=!0,this.radioBtn.updateItemByValue("default",!1),this.radioBtn.updateItemByValue("custom",!0)):(this.refereshWidget.disabled=!1,this.radioBtn.updateItemByValue("default",!0),this.radioBtn.updateItemByValue("custom",!1),this.refreshContainer.find(".bbi-refresh-list-timer").addClass("bbi-refresh-timer-hidden"))},e.prototype.updateListBox=function(e,t){for(var i,a=[],o=0;o<e.length;o++)a.push(this.getItemTextFromText(this.listBox.getDataByElems(this.listBox.getItems()),e[o].widgetID)),t&&(this.bbdesigner$(this.refreshContainer.find("#"+this.id+"_refresh_list_timer_"+e[o].widgetID).parents(".bbi-refresh-list-timer")).removeClass("bbi-refresh-timer-hidden"),i=this.getTimerComponent(e[o].widgetID),this.updateDataToTimer(e[o].widgetInterval,i));this.listBox.selectItems(a,!0)},e.prototype.updateDataToTimer=function(e,t){var e=(e=BoldBIDashboard.isNullOrUndefined(e)?"00:00:30":e).split(":"),i=Number(e[0]),a=Number(e[1]),e=Number(e[2]),o=new Date;o.setHours(i,a,e),t.value=o},e.prototype.updateWidgetList=function(){this.listBox.listData=[],this.listBox.refresh(),this.listBox.addItem(this.getWidgetCollectionData()),this.renderTimerInListBox()},e.prototype.autoRefreshCheck=function(e){e.args.checked?(this.enableAutoRefresh(),this.refereshWidget.checked?this.enableListBox():this.disableListBox()):this.disableAutoRefresh()},e.prototype.enableAutoRefresh=function(){var e;this.refreshContainer.find(".bbi-autorefresh-container").removeClass("bbi-autorefresh-disabled"),this.refreshContainer.find("#"+this.id+"_insertLabel").css("opacity","1").removeAttr("disabled"),this.refreshContainer.find("#"+this.id+"_refreshLabel").css("opacity","1").removeAttr("disabled"),this.refereshWidget.disabled=!1,!(this.rowInfo.disabled=!1)===this.refereshWidget.checked&&(this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","1").removeAttr("disabled"),e=this.refreshContainer.find("#"+this.id+"_refresh_setting_list_Box").data("BoldBIDashboardListBox"),BoldBIDashboard.isNullOrUndefined(e)||e.enable()),this.refreshContainer.find("#"+this.id+"_insertLoadingLabel").css("opacity","1").removeAttr("disabled"),this.loadingInfo.disabled=!1,this.refreshContainer.find(".bbi-dbrd-dyn-con-switch-wrap").removeClass("bbi-autorefresh-disabled"),this.refreshContainer.find("#"+this.id+"refresh_alert_text").css("display","none")},e.prototype.disableAutoRefresh=function(){this.refreshContainer.find(".bbi-autorefresh-container").addClass("bbi-autorefresh-disabled"),this.refereshWidget.disabled=!0,this.rowInfo.disabled=!0,this.refreshContainer.find("#"+this.id+"_insertLabel").css("opacity","0.5").attr("disabled","disabled"),this.refreshContainer.find("#"+this.id+"_refreshLabel").css("opacity","0.5").attr("disabled","disabled"),this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","0.5").attr("disabled","disabled"),this.disableListBox(),this.loadingInfo.disabled=!0,this.refreshContainer.find("#"+this.id+"_insertLoadingLabel").css("opacity","0.5").attr("disabled","disabled"),!BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.cacheSettings)&&this.dashboardDesigner.cacheSettings.isCacheEnable?(this.refreshContainer.find(".bbi-dbrd-dyn-con-switch-wrap").addClass("bbi-autorefresh-disabled"),this.refreshContainer.find("#"+this.id+"refresh_alert_text").css("display","block")):(this.refreshContainer.find(".bbi-dbrd-dyn-con-switch-wrap").removeClass("bbi-autorefresh-disabled"),this.refreshContainer.find("#"+this.id+"refresh_alert_text").css("display","none"))},e.prototype.validateRefreshWidget=function(i){var a=this.refreshSetting;BoldBIDashboard.isNullOrUndefined(a)||BoldBIDashboard.isNullOrUndefined(a.widgetCollection)||(a.widgetCollection.filter(function(e,t){e.widgetName===i&&a.widgetCollection.splice(t,1)}),this.validateCheckedElement(),this.updateWidgetList(),this.updateListBox(a.widgetCollection,a.isWidgetTimer),this.applyRefreshSetting(null))},e.prototype.listItemEnable=function(e){e.checked?this.enableListBox():this.disableListBox()},e.prototype.enableListBox=function(){this.listBox.enabled=!0,this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","1").removeAttr("disabled")},e.prototype.disableListBox=function(){this.listBox.enabled=!1,this.refreshContainer.find("#"+this.id+"_listBox").css("opacity","0.5").attr("disabled","disabled")},e.prototype.onTimePickerChange=function(){""===this.dashboardDesigner.element.find("#"+this.id+"_timeCheckBox").val()?this.refreshErrorIndicatorVisibility(!0):this.refreshErrorIndicatorVisibility(!1)},e.prototype.onListTimePickerChange=function(e){var t=e;""===this.dashboardDesigner.element.find("#"+this.id+"_refresh_list_timer_"+e).val()?this.refreshErrorIndicatorVisibility(!0,t):this.refreshErrorIndicatorVisibility(!1,t)},e.prototype.refreshErrorIndicatorVisibility=function(e,t){t=t?this.dashboardDesigner.element.find("#"+this.id+"_refresh_error_info_icon_list_"+t):this.dashboardDesigner.element.find("#"+this.id+"_refresh_error_info_icon");e?t.css("display","block"):t.css("display","none")},e.prototype.updateRefreshSetting=function(e){this.dashboardDesigner.refreshSetting=e},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RefreshDialog",InternalRefreshDialog,window),function(h){function e(e){this.bbdesigner$=null,this.locale=null,this.dialogDiv=null,this.parameterDropDown=null,this.parameterTypeDropDown=null,this.displayNameTextBox=null,this.customTypeValueInput=null,this.listBoxContent=null,this.confirmationTd=null,this.addButtonTd=null,this.applyButton=null,this.customTypeValueInputContainer=null,this.parameterDropDownContainer=null,this.errorTag=null,this.errorContainer=null,this.parameterList=[],this.targetInstance=null,this.targetMethod=null,this.isDisplayTextChanged=!1,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.renderDialog(),this.unWireEvents(),this.wireEvents()}e.prototype.renderDialog=function(){this.dialogDiv=h.buildTag("div.bbi-userselect bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_parameters_injection"});var e,t,i,a,o,s=h.buildTag("div","",{}),n=h.buildTag("div","",{"margin-left":"5px"}),r=h.buildTag("div","",{display:"flex","justify-content":"space-between",padding:"5px 0"}),d=h.buildTag("div","",{display:"flex","flex-direction":"column",gap:"8px"},{}),l=h.buildTag("input","",{},{id:this.id+"_parameter_injection_param_type_dropdown",type:"text"});d.append(this.getLabelSpan("Parameters"),l),this.parameterDropDownContainer=h.buildTag("div","",{display:"flex","flex-direction":"column",gap:"8px"},{}),e=h.buildTag("input","",{},{id:this.id+"_parameter_injection_param_dropdown",type:"text"}),this.customTypeValueInputContainer=h.buildTag("div","",{display:"none","flex-direction":"column",gap:"8px"},{}),this.customTypeValueInput=h.buildTag("input.e-textbox","",{width:"200px",height:"100%","border-radius":"4px"},{type:"text",placeholder:this.locale.parameterInjection.customValueText}),a=h.buildTag("div","",{display:"flex","flex-direction":"column",gap:"8px"},{}),this.displayNameTextBox=h.buildTag("input.bbi-designer-param-assign e-textbox","",{width:"200px",height:"100%","border-radius":"4px"},{type:"text",placeholder:this.locale.parameterInjection.displayText}),this.customTypeValueInputContainer.append(this.getLabelSpan("Value"),this.customTypeValueInput),a.append(this.getLabelSpan("Display Text"),this.displayNameTextBox),this.parameterDropDownContainer.append(this.getLabelSpan("Value"),e),r.append(d,this.parameterDropDownContainer,this.customTypeValueInputContainer,a),n.append(r),d=h.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 10px"},{}),a=this.bbdesigner$("<tr></tr>"),this.confirmationTd=h.buildTag("td","",{display:"none"},{}),r=h.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left bbi-designer-paraminjection-cancel-btn",this.locale.dialogOptions.cancelButtonText,{},{type:"button"}),t=h.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary bbi-designer-paraminjection-update-btn",this.locale.dialogOptions.updateButtonText,{},{type:"button"}),this.confirmationTd.append(t,r),this.addButtonTd=h.buildTag("td.bbi-designer-paraminjection-add-btn-td","",{},{}),i=h.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-designer-paraminjection-add-btn",this.locale.dialogOptions.addButtonText,{},{id:this.id+"_parameters_injection_add",type:"button"}),this.addButtonTd.append(i),a.append(this.confirmationTd).append(this.addButtonTd),d.append(a),a=h.buildTag("div.bbi-designer-paraminjection-separator","",{},{}),this.errorContainer=h.buildTag("div.bbi-param-injection-error","",{},{}),o=h.buildTag("div.bbi-param-injection-error-icon"),this.errorTag=h.buildTag("span.bbi-param-injection-error-text","",{},{}),this.errorContainer.append(o,this.errorTag),s.append(n,this.errorContainer,d,a),this.renderParameterInjectionOptionsContainer(s),o=h.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{type:"button"}),this.applyButton=h.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.applyButtonText,{float:"right"},{type:"button"}),this.dialogDiv.append(s),this.dashboardDesigner.element.append(this.dialogDiv),this.dialogDiv.BoldBIDashboardDialog({title:this.locale.parameterInjection.dialogTitle,width:"auto",height:"auto",minWidth:750,minHeight:400,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(h.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.dashboardDesigner.element.find("#"+this.id+"_parameters_injection_foot").append(o,this.applyButton),this.applyButton.on("click",this.bbdesigner$.proxy(this.applyParameterInjectionInfo,this)),o.on("click",this.bbdesigner$.proxy(this.closeParametersInjectionDialog,this)),e.BoldBIDashboardDropDownList({width:"200px",height:"28px",fields:{text:"displayText",value:"text"},showRoundedCorner:!0,popupWidth:"200px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.onParameterChange,this),select:this.bbdesigner$.proxy(this.onParameterChangeBefore,this)}),l.BoldBIDashboardDropDownList({width:"200px",height:"28px",dataSource:[{text:this.locale.parameterInjection.defaultParameterText,value:"DefaultParameter"},{text:this.locale.parameterInjection.parameterText,value:"Parameter"},{text:this.locale.parameterInjection.custom,value:"Custom"}],fields:{text:"text",value:"value"},showRoundedCorner:!0,popupWidth:"200px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.onParameterTypeChange,this)}),i.on("click",this.bbdesigner$.proxy(this.appendParameterList,this)),t.on("click",this.bbdesigner$.proxy(this.updateParameterListInfo,this)),r.on("click",this.bbdesigner$.proxy(this.cancelParameterInfoUpdation,this)),this.parameterDropDown=e.data("BoldBIDashboardDropDownList"),this.parameterTypeDropDown=l.data("BoldBIDashboardDropDownList")},e.prototype.getLabelSpan=function(e){return h.buildTag("span",e,{"font-size":"12px","font-weight":"500"},{})},e.prototype.changeTextBox=function(e){e.isInteraction&&this.hideErrorInfo()},e.prototype.updateParameterListInfo=function(){var e,t,i;h.isNullOrUndefined(this.displayNameTextBox.val())?this.showErrorMessage(this.locale.parameterInjection.nameNotEmpty):(e=this.getParameterInjectInfo(),h.isNullOrUndefined(e)?(this.disableparameterListContainer(!1),this.showUpdateButton(!1)):(t=this.listBoxContent.getIndexByValue(this.listBoxContent.getDataByElems(this.listBoxContent.getSelectedItems())[0].text),i=this.isExistParameterInfo(e,t),h.DashboardUtil.isEmptyString(i)?(this.listBoxContent.removeItems(this.getSelectedText(),t),this.listBoxContent.addItems({text:e.DisplayText,value:e},t),this.parameterList=this.getParameterList(),this.disableparameterListContainer(!1),this.showUpdateButton(!1),this.disableApplyButton(!1)):this.showErrorMessage(i)))},e.prototype.showErrorMessage=function(e){this.errorContainer.css("display","flex"),this.errorTag.text(e)},e.prototype.disableApplyButton=function(e){e?h.DashboardUtil.buttonEnable(this.applyButton,!1):h.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.cancelParameterInfoUpdation=function(){this.showUpdateButton(!1),this.disableparameterListContainer(!1)},e.prototype.appendParameterList=function(){var e,t,i;h.isNullOrUndefined(this.displayNameTextBox.val())?this.showErrorMessage(this.locale.parameterInjection.nameNotEmpty):(t=this.getParameterInjectInfo(),h.isNullOrUndefined(t)||(e=this.isExistParameterInfo(t),h.DashboardUtil.isEmptyString(e)?t.ParameterType===h.DashboardDesignerUtility.Serialization.enumToString(ParameterTypeFormat,ParameterTypeFormat.Custom)&&h.isNullOrUndefined(this.customTypeValueInput.val())?this.showErrorMessage(this.locale.parameterInjection.valueNotEmpty):(this.hideErrorInfo(),i=!1,0===this.listBoxContent.getSelectedItems().length&&(this.disableApplyButton(!1),i=!0),t=this.getParameterInjectionItem(t.ParameterType===h.DashboardDesignerUtility.Serialization.enumToString(ParameterTypeFormat,ParameterTypeFormat.Custom)),this.listBoxContent.addItems({text:t.DisplayText,value:t},this.listBoxContent.getDataList().length),this.parameterList=this.getParameterList(),i=[i?t.DisplayText:this.listBoxContent.getDataByElems(this.listBoxContent.getSelectedItems())[0].text],0<this.listBoxContent.getSelectedItems().length&&this.listBoxContent.selectAll(!1),this.listBoxContent.selectItems(i,!0)):this.showErrorMessage(e)))},e.prototype.getSelectedText=function(){return this.listBoxContent.getDataByElems(this.listBoxContent.getSelectedItems())[0].text},e.prototype.getSelectedItem=function(){return this.listBoxContent.getDataByElems(this.listBoxContent.getSelectedItems())[0]},e.prototype.getParameterList=function(){for(var e=[],t=this.listBoxContent.getDataList(),i=0;i<t.length;i++)e.push(t[i].value);return e},e.prototype.isExistParameterInfo=function(e,t){for(var i,a=0;a<this.parameterList.length;a++){i=!1,h.isNullOrUndefined(t)||t!==a||(i=!0);var o=this.parameterList[a],s=o.DisplayText===e.DisplayText,n=o.ParameterValue===e.ParameterValue;if(s&&i)return"";if(s&&!i)return this.locale.parameterInjection.itemExist.replace("{0}",o.DisplayText);if(n&&!i)return this.locale.parameterInjection.sameValueExists.replace("{0}",o.DisplayText)}return""},e.prototype.getParameterInjectInfo=function(){return{ParameterType:this.parameterTypeDropDown.getSelectedValue(),ParameterValue:this.parameterTypeDropDown.getSelectedValue()===h.DashboardDesignerUtility.Serialization.enumToString(ParameterTypeFormat,ParameterTypeFormat.Custom)?this.customTypeValueInput.val():this.parameterDropDown.getSelectedValue(),DisplayText:this.displayNameTextBox.val()}},e.prototype.getParameterInjectionItem=function(e){return{DisplayText:this.displayNameTextBox.val(),ParameterValue:e?this.customTypeValueInput.val():this.parameterDropDown.getSelectedValue(),ParameterType:this.parameterTypeDropDown.getSelectedValue()}},e.prototype.getCurrentWidgetInstance=function(){return this.dashboardDesigner.modules.widgetHelper.getCurrentWidgetInstance()},e.prototype.onParameterChange=function(e){e.isInteraction&&(this.isDisplayTextChanged||this.displayNameTextBox.val(e.text),this.hideErrorInfo())},e.prototype.onParameterChangeBefore=function(e){e.isInteraction&&(this.isDisplayTextChanged=e.model.text!==this.displayNameTextBox.val())},e.prototype.onParameterTypeChange=function(e){e.isInteraction&&(this.hideErrorInfo(),this.updateParameterChange(!1),"Parameter"===e.value?(this.setParameters(),this.showParameterValueDrpDown(!0)):"DefaultParameter"===e.value?(this.updateParameterDropDown(this.dashboardDesigner.getDefaultParameters(),0),this.showParameterValueDrpDown(!0)):"Custom"===e.value&&(this.setCustomParameter(),this.showParameterValueDrpDown(!1)))},e.prototype.showParameterValueDrpDown=function(e){e?(this.updateElementVisibility(this.customTypeValueInputContainer,!0),this.updateElementVisibility(this.parameterDropDownContainer,!1)):(this.updateElementVisibility(this.customTypeValueInputContainer,!1),this.updateElementVisibility(this.parameterDropDownContainer,!0))},e.prototype.updateElementVisibility=function(e,t){t?e.hide():e.css("display","flex")},e.prototype.setCustomParameter=function(){this.parameterDropDown.option("enabled",!1),this.displayNameTextBox.val("")},e.prototype.updateParameterDropDown=function(e,t){this.parameterDropDown.setModel({dataSource:e}),this.parameterDropDown.selectItemByIndex(t),this.displayNameTextBox.val(this.parameterDropDown.model.text)},e.prototype.hideErrorInfo=function(){this.errorContainer.css("display","none"),this.errorTag.text("")},e.prototype.setParameters=function(){var e=this.getCurrentWidgetInstance().DataGroupInfo.DataSourceID,e=this.getParametersFromDs(e);0<e.length?this.updateParameterDropDown(e,0):(this.parameterDropDown.setModel({dataSource:e}),this.displayNameTextBox.val(""),this.updateParameterChange(!0))},e.prototype.updateParameterChange=function(e){e?(this.parameterDropDown.option("enabled",!1),this.displayNameTextBox.attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_parameters_injection_add").attr("disabled","disabled")):(this.parameterDropDown.option("enabled",!0),this.displayNameTextBox.removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.id+"_parameters_injection_add").removeAttr("disabled"))},e.prototype.getParametersFromDs=function(t){var a,e=this.dashboardDesigner.rdlParser.rdlJsonObj.DataSets,i=[];return 0<e.length&&e.forEach(function(e){t===e.Id&&i.push(e)}),a=[],i.forEach(function(i){h.isNullOrUndefined(i)||h.isNullOrUndefined(i.Query)||h.isNullOrUndefined(i.Query.DashboardParameters)||i.Query.DashboardParameters.forEach(function(e){if(e.DataType===DynamicParameterDataType.String){i.Name;var t=e.ParameterName;switch(e.Mode){case ParameterMode.Literal:a.push({displayText:t,text:t});break;case ParameterMode.List:!h.isNullOrUndefined(e.ListModeInfo)&&e.ListModeInfo.IsFirstValue&&a.push({displayText:t,text:t})}}})}),a},e.prototype.renderParameterInjectionOptionsContainer=function(e){var t=h.buildTag("div.e-dashboarddesigner-relative-filter-toolbar","",{height:"20px",margin:"5px","margin-right":"2px"},{}),i=h.buildTag("span","Parameters List",{float:"left","font-weight":"500"},{}),a=h.buildTag("div.bbi-designer-paraminjection-params-display","",{margin:"5px 0px 5px 5px"},{}),o=h.buildTag("ul.bbi-param-list-ul","",{},{id:this.id+"param_injection_list"});a.append(o),t.append(i),e.append(t).append(a),ejdashboard.dropdowns.ListBox.Inject(ejdashboard.dropdowns.CheckBoxSelection),this.listBoxContent=new ejdashboard.dropdowns.ListBox({height:"216px",width:"716px",allowDragAndDrop:!0,fields:{text:"DisplayText",value:"DisplayText"},dataSource:[],itemTemplate:"<div class='bbi-param-list-item'><div class ='bbi-widgeticons bbi-dbrd-designer-hand-cursor bbi-param-drag-drop'></div><span data-tooltip='${text}' class='bbi-dbrd-designer-hoverable'>${text}</span><div class= 'bbi-param-list-action-item'><div class='e-icon bbi-widgeticon bbi-designer-paraminjection-edit bbi-dbrd-designer-hoverable'></div><div class='e-icon bbi-widgeticon bbi-designer-paraminjection-delete bbi-dbrd-designer-hoverable'></div></div></div>",cssClass:"bbi-designer-param-assign bbi-designer-param-listbox bbi-designer-border bbi-dbrd-control"}),this.listBoxContent.appendTo(o[0])},e.prototype.wireEvents=function(){this.dialogDiv.on("click",".bbi-designer-paraminjection-edit",this.bbdesigner$.proxy(this.editParameterList,this)),this.dialogDiv.on("click",".bbi-designer-paraminjection-delete",this.bbdesigner$.proxy(this.deleteParameterList,this))},e.prototype.unWireEvents=function(){this.dialogDiv.off("click",".bbi-designer-paraminjection-edit",this.bbdesigner$.proxy(this.editParameterList,this)),this.dialogDiv.off("click",".bbi-designer-paraminjection-delete",this.bbdesigner$.proxy(this.deleteParameterList,this))},e.prototype.createScrollBar=function(){this.bbdesigner$(this.dialogDiv.find("#"+this.id+"param_injection_list").BoldBIDashboardListBox("instance").listContainer).BoldBIDashboardScroller({enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,cssClass:"bbi-dbrd-designer-scroller bbi-dbrd-control"})},e.prototype.editParameterList=function(e){e=this.listBoxContent.getDataByElements(this.bbdesigner$(e.currentTarget).parents(".e-list-item"));!h.isNullOrUndefined(e)&&0<e.length&&(this.hideErrorInfo(),this.populateParameterListInfo(e[0].value),this.showUpdateButton(!0),this.disableparameterListContainer(!0))},e.prototype.disableparameterListContainer=function(e){this.listBoxContent.enabled=!e},e.prototype.showUpdateButton=function(e){(e?(this.confirmationTd.css("display","block"),this.addButtonTd):(this.addButtonTd.css("display","block"),this.confirmationTd)).css("display","none")},e.prototype.populateParameterListInfo=function(e){var t=!1;this.displayNameTextBox.val(e.DisplayText),e.ParameterType===h.DashboardDesignerUtility.Serialization.enumToString(ParameterTypeFormat,ParameterTypeFormat.Parameter)?(this.setParameters(),this.showParameterValueDrpDown(!0)):e.ParameterType===h.DashboardDesignerUtility.Serialization.enumToString(ParameterTypeFormat,ParameterTypeFormat.Custom)?this.showParameterValueDrpDown(!(t=!0)):this.showParameterValueDrpDown(!0),t?(this.parameterDropDown.option("enabled",!1),this.customTypeValueInput.val(e.ParameterValue)):(this.parameterDropDown.selectItemByValue(e.ParameterValue),this.parameterDropDown.option("enabled",!0)),this.parameterTypeDropDown.selectItemByValue(e.ParameterType.toString())},e.prototype.deleteParameterList=function(e){var e=this.listBoxContent.getDataByElements(this.bbdesigner$(e.currentTarget).parents(".e-list-item")),t=this.listBoxContent.getIndexByValue(e[0].text);h.isNullOrUndefined(t)||(this.hideErrorInfo(),this.listBoxContent.removeItems(e[0].text,t),this.parameterList=this.getParameterList(),0<this.listBoxContent.getDataList().length?(this.listBoxContent.selectItems(this.listBoxContent.getDataList()[0].text,!0),this.disableApplyButton(!1)):this.disableApplyButton(!0))},e.prototype.openParametersInjectionDialog=function(e,t,i){this.openDialog(),this.resetparameterInjectionDialog(),this.targetInstance=e,this.targetMethod=t,!h.isNullOrUndefined(i)&&0<i.length?(this.parameterList=i,this.populateParametersInjectionInfo(i)):this.disableApplyButton(!0)},e.prototype.populateParametersInjectionInfo=function(e){0<e.length&&(this.setListBoxData(e),this.listBoxContent.selectItems([this.listBoxContent.getDataList()[0].text],!0),this.populateParameterListInfo(e[0]))},e.prototype.setListBoxData=function(e){for(var t,i=0;i<e.length;i++)t={text:e[i].DisplayText,value:e[i]},this.listBoxContent.addItems(t,this.listBoxContent.getDataList())},e.prototype.resetparameterInjectionDialog=function(){this.targetInstance=null,this.targetMethod=null,this.parameterList=[],this.listBoxContent.dataSource=[],this.listBoxContent.refresh(),this.showUpdateButton(!1),this.updateParameterDropDown(this.dashboardDesigner.getDefaultParameters(),0),this.parameterTypeDropDown.setModel({selectedIndex:0}),this.hideErrorInfo(),this.showParameterValueDrpDown(!0),this.dashboardDesigner.element.find("#"+this.id+"_parameters_injection_add").removeAttr("disabled"),this.parameterDropDown.option("enabled",!0)},e.prototype.openDialog=function(){this.dialogDiv.data("BoldBIDashboardDialog").open()},e.prototype.closeParametersInjectionDialog=function(){this.dialogDiv.data("BoldBIDashboardDialog").close()},e.prototype.applyParameterInjectionInfo=function(){h.isNullOrUndefined(this.targetInstance)||(h.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.bbdesigner$.extend([],!0,this.getParameterList())]),this.closeParametersInjectionDialog())},h.ParametersInWidget=e}(BoldBIDashboard=BoldBIDashboard||{}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.CodeMirror=t()}(this,function(){function r(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function $(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function f(e,t){return $(e).appendChild(t)}function T(e,t,i,a){var o,s=document.createElement(e);if(i&&(s.className=i),a&&(s.style.cssText=a),"string"==typeof t)s.appendChild(document.createTextNode(t));else if(t)for(o=0;o<t.length;++o)s.appendChild(t[o]);return s}function W(e,t,i,a){e=T(e,t,i,a);return e.setAttribute("role","presentation"),e}function H(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if((t=11==t.nodeType?t.host:t)==e)return!0}while(t=t.parentNode)}function q(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function d(e,t){var i=e.className;r(t).test(i)||(e.className+=(i?" ":"")+t)}function h(e,t){for(var i=e.split(" "),a=0;a<i.length;a++)i[a]&&!r(i[a]).test(t)&&(t+=" "+i[a]);return t}function z(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function j(e,t,i){for(var a in t=t||{},e)!e.hasOwnProperty(a)||!1===i&&t.hasOwnProperty(a)||(t[a]=e[a]);return t}function B(e,t,i,a,o){var s,n,r;for(null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length),s=a||0,n=o||0;;){if((r=e.indexOf("\t",s))<0||t<=r)return n+(t-s);n=(n+=r-s)+(i-n%i),s=r+1}}function b(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function G(e,t,i){for(var a,o,s=0,n=0;;){if(o=(a=-1==(a=e.indexOf("\t",s))?e.length:a)-s,a==e.length||t<=n+o)return s+Math.min(o,t-n);if(n+=a-s,s=a+1,t<=(n+=i-n%i))return s}}function Q(e){for(;Zo.length<=e;)Zo.push(A(Zo)+" ");return Zo[e]}function A(e){return e[e.length-1]}function J(e,t){for(var i=[],a=0;a<e.length;a++)i[a]=t(e[a],a);return i}function l(){}function c(e,t){e=Object.create?Object.create(e):(l.prototype=e,new l);return t&&j(t,e),e}function Y(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||es.test(e))}function K(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Y(e))||t.test(e):Y(e)}function X(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}function Z(e){return 768<=e.charCodeAt(0)&&ts.test(e)}function ee(e,t,i){for(;(i<0?0<t:t<e.length)&&Z(e.charAt(t));)t+=i;return t}function te(e,t,i){for(var a,o=i<t?-1:1;;){if(t==i)return t;if(a=(t+i)/2,(a=o<0?Math.ceil(a):Math.floor(a))==t)return e(a)?t:i;e(a)?i=a:t=a+o}}function ie(e,t,i){var a,o=this;this.input=i,o.scrollbarFiller=T("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=T("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=W("div",null,"CodeMirror-code"),o.selectionDiv=T("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=T("div",null,"CodeMirror-cursors"),o.measure=T("div",null,"CodeMirror-measure"),o.lineMeasure=T("div",null,"CodeMirror-measure"),o.lineSpace=W("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none"),a=W("div",[o.lineSpace],"CodeMirror-lines"),o.mover=T("div",[a],null,"position: relative"),o.sizer=T("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=T("div",null,null,"position: absolute; height: "+rn+"px; width: 1px;"),o.gutters=T("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=T("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=T("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),E&&M<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),P||Qs&&on||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,i.init(o)}function S(e,t){var i,a,o,s;if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(i=e;!i.lines;)for(a=0;;++a){if(t<(s=(o=i.children[a]).chunkSize())){i=o;break}t-=s}return i.lines[t]}function ae(e,t,i){var a=[],o=t.line;return e.iter(t.line,i.line+1,function(e){e=e.text;o==i.line&&(e=e.slice(0,i.ch)),o==t.line&&(e=e.slice(t.ch)),a.push(e),++o}),a}function oe(e,t,i){var a=[];return e.iter(t,i,function(e){a.push(e.text)}),a}function se(e,t){var i,a=t-e.height;if(a)for(i=e;i;i=i.parent)i.height+=a}function I(e){var t,i,a,o;if(null==e.parent)return null;for(i=b((t=e.parent).lines,e),a=t.parent;a;a=(t=a).parent)for(o=0;a.children[o]!=t;++o)i+=a.children[o].chunkSize();return i+t.first}function ne(e,t){var i,a,o,s,n,r=e.first;e:do{for(i=0;i<e.children.length;++i){if(t<(o=(a=e.children[i]).height)){e=a;continue e}t-=o,r+=a.chunkSize()}return r}while(!e.lines);for(s=0;s<e.lines.length&&!(t<(n=e.lines[s].height));++s)t-=n;return r+s}function re(e,t){return t>=e.first&&t<e.first+e.size}function de(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function k(e,t,i){if(void 0===i&&(i=null),!(this instanceof k))return new k(e,t,i);this.line=e,this.ch=t,this.sticky=i}function x(e,t){return e.line-t.line||e.ch-t.ch}function le(e,t){return e.sticky==t.sticky&&0==x(e,t)}function he(e){return k(e.line,e.ch)}function pe(e,t){return x(e,t)<0?t:e}function ce(e,t){return x(e,t)<0?e:t}function ue(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function N(e,t){var i;return t.line<e.first?k(e.first,0):(i=e.first+e.size-1,t.line>i?k(i,S(e,i).text.length):(e=S(e,(i=t).line).text.length,null==(t=i.ch)||e<t?k(i.line,e):t<0?k(i.line,0):i))}function be(e,t){for(var i=[],a=0;a<t.length;a++)i[a]=N(e,t[a]);return i}function ge(e,t,i){this.marker=e,this.from=t,this.to=i}function me(e,t){var i,a;if(e)for(i=0;i<e.length;++i)if((a=e[i]).marker==t)return a}function fe(e,t){var i,a,o,s,n,r,d,l,h,p,c,u;if(t.full||(i=re(e,t.from.line)&&S(e,t.from.line).markedSpans,a=re(e,t.to.line)&&S(e,t.to.line).markedSpans,!i&&!a))return null;var b=t.from.ch,e=t.to.ch,g=0==x(t.from,t.to),m=function(e,t,i){var a,o,s;if(e)for(o=0;o<e.length;++o){var n=e[o],r=n.marker;!(null==n.from||(r.inclusiveLeft?n.from<=t:n.from<t))&&(n.from!=t||"bookmark"!=r.type||i&&n.marker.insertLeft)||(s=null==n.to||(r.inclusiveRight?n.to>=t:n.to>t),(a=a||[]).push(new ge(r,n.from,s?null:n.to)))}return a}(i,b,g),f=function(e,t,i){var a,o,s;if(e)for(o=0;o<e.length;++o){var n=e[o],r=n.marker;!(null==n.to||(r.inclusiveRight?n.to>=t:n.to>t))&&(n.from!=t||"bookmark"!=r.type||i&&!n.marker.insertLeft)||(s=null==n.from||(r.inclusiveLeft?n.from<=t:n.from<t),(a=a||[]).push(new ge(r,s?null:n.from-t,null==n.to?null:n.to-t)))}return a}(a,e,g),D=1==t.text.length,y=A(t.text).length+(D?b:0);if(m)for(o=0;o<m.length;++o)null==(s=m[o]).to&&((n=me(f,s.marker))?D&&(s.to=null==n.to?null:n.to+y):s.to=b);if(f)for(r=0;r<f.length;++r)null!=(d=f[r]).to&&(d.to+=y),null==d.from?me(m,d.marker)||(d.from=y,D&&(m=m||[]).push(d)):(d.from+=y,D&&(m=m||[]).push(d));if(m=m&&De(m),f&&f!=m&&(f=De(f)),l=[m],!D){if(0<(h=t.text.length-2)&&m)for(c=0;c<m.length;++c)null==m[c].to&&(p=p||[]).push(new ge(m[c].marker,null,null));for(u=0;u<h;++u)l.push(p);l.push(f)}return l}function De(e){for(var t,i=0;i<e.length;++i)null!=(t=e[i]).from&&t.from==t.to&&!1!==t.marker.clearWhenEmpty&&e.splice(i--,1);return e.length?e:null}function ye(e){var t,i=e.markedSpans;if(i){for(t=0;t<i.length;++t)i[t].marker.detachLine(e);e.markedSpans=null}}function Be(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Ie(e){return e.inclusiveLeft?-1:0}function xe(e){return e.inclusiveRight?1:0}function _e(e,t){var i,a,o=e.lines.length-t.lines.length;return 0!=o?o:(o=e.find(),i=t.find(),(a=x(o.from,i.from)||Ie(e)-Ie(t))?-a:x(o.to,i.to)||xe(e)-xe(t)||t.id-e.id)}function ve(e,t){var i,a,o,s=as&&e.markedSpans;if(s)for(o=0;o<s.length;++o)(a=s[o]).marker.collapsed&&null==(t?a.from:a.to)&&(!i||_e(i,a.marker)<0)&&(i=a.marker);return i}function Ce(e){return ve(e,!0)}function we(e){return ve(e,!1)}function Te(e,t,i,a,o){var s,n,e=S(e,t),r=as&&e.markedSpans;if(r)for(s=0;s<r.length;++s)if((n=r[s]).marker.collapsed){var d=n.marker.find(0),l=x(d.from,i)||Ie(n.marker)-Ie(o),h=x(d.to,a)||xe(n.marker)-xe(o);if(!(0<=l&&h<=0||l<=0&&0<=h||!(l<=0&&(n.marker.inclusiveRight&&o.inclusiveLeft?0<=x(d.to,i):0<x(d.to,i))||0<=l&&(n.marker.inclusiveRight&&o.inclusiveLeft?x(d.from,a)<=0:x(d.from,a)<0))))return 1}}function Se(e){for(var t;t=Ce(e);)e=t.find(-1,!0).line;return e}function ke(e,t){var e=S(e,t),i=Se(e);return e==i?t:I(i)}function Ne(e,t){if(t>e.lastLine())return t;var i,a=S(e,t);if(!Fe(e,a))return t;for(;i=we(a);)a=i.find(1,!0).line;return I(a)+1}function Fe(e,t){var i,a,o=as&&t.markedSpans;if(o)for(a=0;a<o.length;++a)if((i=o[a]).marker.collapsed&&(null==i.from||!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&function e(t,i,a){var o,s,n;if(null==a.to)return o=a.marker.find(1,!0),e(t,o.line,me(o.line.markedSpans,a.marker));if(a.marker.inclusiveRight&&a.to==i.text.length)return!0;for(s=void 0,n=0;n<i.markedSpans.length;++n)if(s=i.markedSpans[n],s.marker.collapsed&&!s.marker.widgetNode&&s.from==a.to&&(null==s.to||s.to!=a.from)&&(s.marker.inclusiveLeft||a.marker.inclusiveRight)&&e(t,i,s))return!0}(e,t,i)))return!0}function Oe(e){for(var t,i,a,o,s,n=(e=Se(e)).parent,r=t=0;r<n.lines.length&&(i=n.lines[r])!=e;++r)t+=i.height;for(a=n.parent;a;a=(n=a).parent)for(o=0;o<a.children.length&&(s=a.children[o])!=n;++o)t+=s.height;return t}function Le(e){var t,i,a,o,s;if(0==e.height)return 0;for(t=e.text.length,a=e;i=Ce(a);)a=(o=i.find(0,!0)).from.line,t+=o.from.ch-o.to.ch;for(a=e;i=we(a);)s=i.find(0,!0),t=(t-=a.text.length-s.from.ch)+((a=s.to.line).text.length-s.to.ch);return t}function Ue(e){var i=e.display,e=e.doc;i.maxLine=S(e,e.first),i.maxLineLength=Le(i.maxLine),i.maxLineChanged=!0,e.iter(function(e){var t=Le(e);t>i.maxLineLength&&(i.maxLineLength=t,i.maxLine=e)})}function Ee(e,t,i){var a,o,s;for(os=null,o=0;o<e.length;++o){if((s=e[o]).from<t&&s.to>t)return o;s.to==t&&(s.from!=s.to&&"before"==i?a=o:os=o),s.from==t&&(s.from!=s.to&&"before"!=i?a=o:os=o)}return null!=a?a:os}function Me(e,t){var i=e.order;return i=null==i?e.order=un(e.text,t):i}function Ae(e,t){return e._handlers&&e._handlers[t]||bn}function _(e,t,i){var a;e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent?e.detachEvent("on"+t,i):(a=(e=e._handlers)&&e[t])&&-1<(i=b(a,i))&&(e[t]=a.slice(0,i).concat(a.slice(i+1)))}function F(e,t){var i,a,o=Ae(e,t);if(o.length)for(i=Array.prototype.slice.call(arguments,2),a=0;a<o.length;++a)o[a].apply(null,i)}function O(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),F(e,i||t.type,e,t),We(t)||t.codemirrorIgnore}function Pe(e){var t,i,a=e._handlers&&e._handlers.cursorActivity;if(a)for(t=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<a.length;++i)-1==b(t,a[i])&&t.push(a[i])}function Re(e,t){return 0<Ae(e,t).length}function Ve(e){e.prototype.on=function(e,t){V(this,e,t)},e.prototype.off=function(e,t){_(this,e,t)}}function v(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function $e(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function We(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function He(e){v(e),$e(e)}function qe(e){return e.target||e.srcElement}function ze(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=sn&&e.ctrlKey&&1==t?3:t}function je(e){if("string"==typeof e&&In.hasOwnProperty(e))e=In[e];else if(e&&"string"==typeof e.name&&In.hasOwnProperty(e.name)){var t=In[e.name];(e=c(t="string"==typeof t?{name:t}:t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return je("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return je("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ge(e,t){var i,a,o,s,n;if(t=je(t),!(i=Bn[t.name]))return Ge(e,"text/plain");if(a=i(e,t),xn.hasOwnProperty(t.name))for(s in o=xn[t.name])o.hasOwnProperty(s)&&(a.hasOwnProperty(s)&&(a["_"+s]=a[s]),a[s]=o[s]);if(a.name=t.name,t.helperType&&(a.helperType=t.helperType),t.modeProps)for(n in t.modeProps)a[n]=t.modeProps[n];return a}function Qe(e,t){j(t,xn.hasOwnProperty(e)?xn[e]:xn[e]={})}function Je(e,t){var i,a,o;if(!0===t)return t;if(e.copyState)return e.copyState(t);for(a in i={},t)o=t[a],o instanceof Array&&(o=o.concat([])),i[a]=o;return i}function Ye(e,t){for(var i;e.innerMode&&((i=e.innerMode(t))&&i.mode!=e);)t=i.state,e=i.mode;return i||{mode:e,state:t}}function Ke(e,t,i){return!e.startState||e.startState(t,i)}function Xe(t,i,a,e){var o,s,n,d=[t.state.modeGen],l={};for(nt(t,i.text,t.doc.mode,a,function(e,t){d.push(e,t)},l,e),o=a.state,s=function(e){a.baseTokens=d;var s=t.state.overlays[e],n=1,r=0;a.state=!0,nt(t,i.text,s.mode,a,function(e,t){for(var i,a,o=n;r<e;)e<(i=d[n])&&d.splice(n,1,e,d[n+1],i),n+=2,r=Math.min(e,i);if(t)if(s.opaque)d.splice(o,n-o,e,"overlay "+t),n=o+2;else for(;o<n;o+=2)d[o+1]=((a=d[o+1])?a+" ":"")+"overlay "+t},l),a.state=o,a.baseTokens=null,a.baseTokenPos=1},n=0;n<t.state.overlays.length;++n)s(n);return{styles:d,classes:l.bgClass||l.textClass?l:null}}function Ze(e,t,i){var a,o,s;return t.styles&&t.styles[0]==e.state.modeGen||(a=et(e,I(t)),o=t.text.length>e.options.maxHighlightLength&&Je(e.doc.mode,a.state),s=Xe(e,t,a),o&&(a.state=o),t.stateAfter=a.save(!o),t.styles=s.styles,s.classes?t.styleClasses=s.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function et(i,a,e){var t,o,s,n=i.doc,r=i.display;return n.mode.startState?(o=(t=function(e,t,i){for(var a,o,s,n,r=e.doc,d=i?-1:t-(e.doc.mode.innerMode?1e3:100),l=t;d<l;--l){if(l<=r.first)return r.first;if(a=S(r,l-1),(o=a.stateAfter)&&(!i||l+(o instanceof rs?o.lookAhead:0)<=r.modeFrontier))return l;o=B(a.text,null,e.options.tabSize),(null==n||o<s)&&(n=l-1,s=o)}return n}(i,a,e))>n.first&&S(n,t-1).stateAfter,s=o?ds.fromSaved(n,o,t):new ds(n,Ke(n.mode),t),n.iter(t,a,function(e){tt(i,e.text,s);var t=s.line;e.stateAfter=t==a-1||t%5==0||t>=r.viewFrom&&t<r.viewTo?s.save():null,s.nextLine()}),e&&(n.modeFrontier=s.line),s):new ds(n,!0,a)}function tt(e,t,i,a){var o=e.doc.mode,s=new R(t,e.options.tabSize,i);for(s.start=s.pos=a||0,""==t&&it(o,i.state);!s.eol();)at(o,s,i.state),s.start=s.pos}function it(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){e=Ye(e,t);if(e.mode.blankLine)return e.mode.blankLine(e.state)}}function at(e,t,i,a){for(var o,s=0;s<10;s++)if(a&&(a[0]=Ye(e,i).mode),o=e.token(t,i),t.pos>t.start)return o;throw new Error("Mode "+e.name+" failed to advance stream.")}function ot(e,t,i,a){var o,s,n=e.doc,r=n.mode,d=S(n,(t=N(n,t)).line),l=et(e,t.line,i),h=new R(d.text,e.options.tabSize,l);for(a&&(s=[]);(a||h.pos<t.ch)&&!h.eol();)h.start=h.pos,o=at(r,h,l.state),a&&s.push(new ls(h,o,Je(n.mode,l.state)));return a?s:new ls(h,o,l.state)}function st(e,t){var i,a;if(e)for(;i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);)e=e.slice(0,i.index)+e.slice(i.index+i[0].length),null==t[a=i[1]?"bgClass":"textClass"]?t[a]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[a])||(t[a]+=" "+i[2]);return e}function nt(e,t,i,a,o,s,n){var r,d,l,h=i.flattenSpans,p=(null==h&&(h=e.options.flattenSpans),0),c=null,u=new R(t,e.options.tabSize,a),b=e.options.addModeClass&&[null];for(""==t&&st(it(i,a.state),s);!u.eol();){if(l=u.pos>e.options.maxHighlightLength?(h=!1,n&&tt(e,t,a,u.pos),u.pos=t.length,null):st(at(i,u,a.state,b),s),b&&(r=b[0].name)&&(l="m-"+(l?r+" "+l:r)),!h||c!=l){for(;p<u.start;)o(p=Math.min(u.start,p+5e3),c);c=l}u.start=u.pos}for(;p<u.pos;)o(d=Math.min(u.pos,p+5e3),c),p=d}function rt(e,t){return!e||/^\s*$/.test(e)?null:(t=t.addModeClass?cs:ps)[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function dt(e,t){var i,a,o,s,n,r,d=W("span",null,null,P?"padding-right: .1px":null),l={pre:W("pre",[d],"CodeMirror-line"),content:d,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:(E||P)&&e.getOption("lineWrapping")};for(t.measure={},i=0;i<=(t.rest?t.rest.length:0);i++)a=i?t.rest[i-1]:t.line,o=void 0,l.pos=0,l.addToken=ht,s=e.display.measure,r=n=void 0,(null!=ns?ns:(r=f(s,document.createTextNode("AخA")),n=Yo(r,0,1).getBoundingClientRect(),r=Yo(r,1,2).getBoundingClientRect(),$(s),n&&n.left!=n.right&&(ns=r.right-n.right<3)))&&(o=Me(a,e.doc.direction))&&(l.addToken=function(p,c){return function(e,t,i,a,o,s,n){var r,d,l,h;for(i=i?i+" cm-force-border":"cm-force-border",d=(r=e.pos)+t.length;;){for(l=void 0,h=0;h<c.length&&!((l=c[h]).to>r&&l.from<=r);h++);if(l.to>=d)return p(e,t,i,a,o,s,n);p(e,t.slice(0,l.to-r),i,a,null,s,n),a=null,t=t.slice(l.to-r),r=l.to}}}(l.addToken,o)),l.map=[],function(e,t,i){var a,o,s,n,r,d,l,h,p,c,u,b=e.markedSpans,g=e.text,m=0;if(b)for(var f,D,y,B,I,x,_,v=g.length,C=0,w=1,T="",S=0;;){if(S==C){for(y=B=I=x=D="",_=null,S=1/0,o=[],s=void 0,n=0;n<b.length;++n)r=b[n],"bookmark"==(d=r.marker).type&&r.from==C&&d.widgetNode?o.push(d):r.from<=C&&(null==r.to||r.to>C||d.collapsed&&r.to==C&&r.from==C)?(null!=r.to&&r.to!=C&&S>r.to&&(S=r.to,B=""),d.className&&(y+=" "+d.className),d.css&&(D=(D?D+";":"")+d.css),d.startStyle&&r.from==C&&(I+=" "+d.startStyle),d.endStyle&&r.to==S&&(s=s||[]).push(d.endStyle,r.to),d.title&&!x&&(x=d.title),d.collapsed&&(!_||_e(_.marker,d)<0)&&(_=r)):r.from>C&&S>r.from&&(S=r.from);if(s)for(l=0;l<s.length;l+=2)s[l+1]==S&&(B+=" "+s[l]);if(!_||_.from==C)for(h=0;h<o.length;++h)pt(t,0,o[h]);if(_&&(_.from||0)==C){if(pt(t,(null==_.to?v+1:_.to)-C,_.marker,null==_.from),null==_.to)return;_.to==C&&(_=!1)}}if(v<=C)break;for(p=Math.min(v,S);;){if(T){if(c=C+T.length,_||(u=p<c?T.slice(0,p-C):T,t.addToken(t,u,f?f+y:y,I,C+u.length==S?B:"",x,D)),p<=c){T=T.slice(p-C),C=p;break}C=c,I=""}T=g.slice(m,m=i[w++]),f=rt(i[w++],t.cm.options)}}else for(a=1;a<i.length;a+=2)t.addToken(t,g.slice(m,m=i[a]),rt(i[a+1],t.cm.options))}(a,l,Ze(e,a,t!=e.display.externalMeasured&&I(a))),a.styleClasses&&(a.styleClasses.bgClass&&(l.bgClass=h(a.styleClasses.bgClass,l.bgClass||"")),a.styleClasses.textClass)&&(l.textClass=h(a.styleClasses.textClass,l.textClass||"")),0==l.map.length&&l.map.push(0,0,l.content.appendChild((s=e.display.measure,r=void 0,(s=(ss=null==ss&&(r=T("span","​"),f(s,T("span",[r,document.createTextNode("x")])),0!=s.firstChild.offsetHeight)?r.offsetWidth<=1&&2<r.offsetHeight&&!(E&&M<8):ss)?T("span","​"):T("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),s))),0==i?(t.measure.map=l.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(l.map),(t.measure.caches||(t.measure.caches=[])).push({}));return P&&(d=l.content.lastChild,/\bcm-tab\b/.test(d.className)||d.querySelector&&d.querySelector(".cm-tab"))&&(l.content.className="cm-tab-wrap-hack"),F(e,"renderLine",e,t.line,l.pre),l.pre.className&&(l.textClass=h(l.pre.className,l.textClass||"")),l}function lt(e){var t=T("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function ht(e,t,i,a,o,s,n){var r,d,l,h;if(t){var p,c=e.splitSpaces?function(e,t){var i,a,o,s;if(1<e.length&&!/  /.test(e))return e;for(i=t,a="",o=0;o<e.length;o++)" "!=(s=e.charAt(o))||!i||o!=e.length-1&&32!=e.charCodeAt(o+1)||(s=" "),a+=s,i=" "==s;return a}(t,e.trailingSpace):t,u=e.cm.state.specialChars,b=!1;if(u.test(t))for(p=document.createDocumentFragment(),r=0;u.lastIndex=r,(h=(d=u.exec(t))?d.index-r:t.length-r)&&(l=document.createTextNode(c.slice(r,r+h)),E&&M<9?p.appendChild(T("span",[l])):p.appendChild(l),e.map.push(e.pos,e.pos+h,l),e.col+=h,e.pos+=h),d;)r+=1+h,l=void 0,"\t"==d[0]?(h=(h=e.cm.options.tabSize)-e.col%h,(l=p.appendChild(T("span",Q(h),"cm-tab"))).setAttribute("role","presentation"),l.setAttribute("cm-text","\t"),e.col+=h):("\r"==d[0]||"\n"==d[0]?(l=p.appendChild(T("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]):((l=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),E&&M<9?p.appendChild(T("span",[l])):p.appendChild(l)),e.col+=1),e.map.push(e.pos,e.pos+1,l),e.pos++;else e.col+=t.length,p=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,p),E&&M<9&&(b=!0),e.pos+=t.length;if(e.trailingSpace=32==c.charCodeAt(t.length-1),i||a||o||b||n)return b=i||"",a&&(b+=a),o&&(b+=o),i=T("span",[p],b,n),s&&(i.title=s),e.content.appendChild(i);e.content.appendChild(p)}}function pt(e,t,i,a){var o=!a&&i.widgetNode;o&&e.map.push(e.pos,e.pos+t,o),!a&&e.cm.display.input.needsContentAttribute&&(o=o||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",i.id),o&&(e.cm.display.input.setUneditable(o),e.content.appendChild(o)),e.pos+=t,e.trailingSpace=!1}function ct(e,t,i){this.line=t,this.rest=function(e){for(var t,i;t=we(e);)e=t.find(1,!0).line,(i=i||[]).push(e);return i}(t),this.size=this.rest?I(A(this.rest))-i+1:1,this.node=this.text=null,this.hidden=Fe(e,t)}function ut(e,t,i){for(var a,o,s=[],n=t;n<i;n=o)o=n+(a=new ct(e.doc,S(e.doc,n),n)).size,s.push(a);return s}function D(e,t){var i,a,o,s,n=Ae(e,t);if(n.length)for(i=Array.prototype.slice.call(arguments,2),us?a=us.delayedCallbacks:bs?a=bs:(a=bs=[],setTimeout(bt,0)),o=function(e){a.push(function(){return n[e].apply(null,i)})},s=0;s<n.length;++s)o(s)}function bt(){var e,t=bs;for(bs=null,e=0;e<t.length;++e)t[e]()}function gt(e,t,i,a){for(var o,s,n,r=0;r<t.changes.length;r++){o=t.changes[r];if("text"==o)h=e,s=t,n=void 0,d=void 0,n=s.text.className,d=ft(h,s),s.text==s.node&&(s.node=d.pre),s.text.parentNode.replaceChild(d.pre,s.text),s.text=d.pre,d.bgClass!=s.bgClass||d.textClass!=s.textClass?(s.bgClass=d.bgClass,s.textClass=d.textClass,Dt(h,s)):n&&(s.text.className=n);else if("gutter"==o)yt(e,t,i,a);else if("class"==o)Dt(e,t);else if("widget"==o){d=void 0;l=void 0;h=void 0;p=void 0;c=void 0;var d=e;var l=t;var h=a;l.alignable&&(l.alignable=null);for(var p=l.node.firstChild,c=void 0;p;p=c)c=p.nextSibling,"CodeMirror-linewidget"==p.className&&l.node.removeChild(p);Bt(d,l,h)}}t.changes=null}function mt(e){return e.node==e.text&&(e.node=T("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),E)&&M<8&&(e.node.style.zIndex=2),e.node}function ft(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):dt(e,t)}function Dt(e,t){e=e,(o=(i=t).bgClass?i.bgClass+" "+(i.line.bgClass||""):i.line.bgClass)&&(o+=" CodeMirror-linebackground"),i.background?o?i.background.className=o:(i.background.parentNode.removeChild(i.background),i.background=null):o&&(a=mt(i),i.background=a.insertBefore(T("div",null,o),a.firstChild),e.display.input.setUneditable(i.background)),t.line.wrapClass?mt(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i,a,o=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=o||""}function yt(e,t,i,a){var o,s,n,r,d,l;if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(s=mt(t),t.gutterBackground=T("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px; width: "+a.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),s.insertBefore(t.gutterBackground,t.text)),o=t.line.gutterMarkers,(e.options.lineNumbers||o)&&(s=mt(t),n=t.gutter=T("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px"),e.display.input.setUneditable(n),s.insertBefore(n,t.text),t.line.gutterClass&&(n.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=n.appendChild(T("div",de(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+a.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o))for(r=0;r<e.options.gutters.length;++r)d=e.options.gutters[r],(l=o.hasOwnProperty(d)&&o[d])&&n.appendChild(T("div",[l],"CodeMirror-gutter-elt","left: "+a.gutterLeft[d]+"px; width: "+a.gutterWidth[d]+"px"))}function Bt(e,t,i){if(It(e,t.line,t,i,!0),t.rest)for(var a=0;a<t.rest.length;a++)It(e,t.rest[a],t,i,!1)}function It(e,t,i,a,o){var s,n,r,d,l;if(t.widgets)for(s=mt(i),n=0,r=t.widgets;n<r.length;++n){d=r[n],l=T("div",[d.node],"CodeMirror-linewidget"),d.handleMouseEvents||l.setAttribute("cm-ignore-events","true");{h=void 0;p=void 0;c=void 0;u=void 0;var h=d;var p=l;var c=i;var u=a;h.noHScroll&&((c.alignable||(c.alignable=[])).push(p),c=u.wrapperWidth,p.style.left=u.fixedPos+"px",h.coverGutter||(c-=u.gutterTotalWidth,p.style.paddingLeft=u.gutterTotalWidth+"px"),p.style.width=c+"px");h.coverGutter&&(p.style.zIndex=5,p.style.position="relative",h.noHScroll||(p.style.marginLeft=-u.gutterTotalWidth+"px"))}e.display.input.setUneditable(l),o&&d.above?s.insertBefore(l,i.gutter||i.text):s.appendChild(l),D(d,"redraw")}}function xt(e){var t,i;return null!=e.height?e.height:(t=e.doc.cm)?(H(document.body,e.node)||(i="position: relative;",e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),f(t.display.measure,T("div",[e.node],null,i))),e.height=e.node.parentNode.offsetHeight):0}function _t(e,t){for(var i=qe(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return 1}function vt(e){return e.lineSpace.offsetTop}function Ct(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function wt(e){var t;return e.cachedPaddingH||(t=f(e.measure,T("pre","x")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)},isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t)}function Tt(e){return rn-e.display.nativeBarWidth}function St(e){return e.display.scroller.clientWidth-Tt(e)-e.display.barWidth}function kt(e){return e.display.scroller.clientHeight-Tt(e)-e.display.barHeight}function Nt(e,t,i){var a,o;if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(a=0;a<e.rest.length;a++)if(e.rest[a]==t)return{map:e.measure.maps[a],cache:e.measure.caches[a]};for(o=0;o<e.rest.length;o++)if(I(e.rest[o])>i)return{map:e.measure.maps[o],cache:e.measure.caches[o],before:!0}}function Ft(e,t,i,a){return Ut(e,Lt(e,t),i,a)}function Ot(e,t){return t>=e.display.viewFrom&&t<e.display.viewTo?e.display.view[si(e,t)]:(e=e.display.externalMeasured)&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Lt(e,t){var i,a,o=I(t),s=Ot(e,o);return s&&!s.text?s=null:s&&s.changes&&(gt(e,s,o,ei(e)),e.curOp.forceUpdate=!0),s||(e=e,a=I(i=Se(i=t)),(i=e.display.externalMeasured=new ct(e.doc,i,a)).lineN=a,a=i.built=dt(e,i),i.text=a.pre,f(e.display.lineMeasure,a.pre),s=i),{line:t,view:s,rect:null,map:(e=Nt(s,t,o)).map,cache:e.cache,before:e.before,hasHeights:!1}}function Ut(e,t,i,a,o){var s,n=(i=t.before?-1:i)+(a||"");if(t.cache.hasOwnProperty(n))s=t.cache[n];else{if(t.rect||(t.rect=t.view.text.getBoundingClientRect()),!t.hasHeights){var r=e,d=t.view,l=t.rect,h,p,c,u,b,g=r.options.lineWrapping,r=g&&St(r);if(!d.measure.heights||g&&d.measure.width!=r){if(h=d.measure.heights=[],g)for(d.measure.width=r,p=d.text.firstChild.getClientRects(),c=0;c<p.length-1;c++)u=p[c],b=p[c+1],2<Math.abs(u.bottom-b.bottom)&&h.push((u.bottom+b.top)/2-l.top);h.push(l.bottom-l.top)}t.hasHeights=!0}(s=function(e,t,i,a){var o,s,n=Et(t.map,i,a),r=n.node,d=n.start,l=n.end,h=n.collapse;if(3==r.nodeType){for(s=0;s<4;s++){for(;d&&Z(t.line.text.charAt(n.coverStart+d));)--d;for(;n.coverStart+l<n.coverEnd&&Z(t.line.text.charAt(n.coverStart+l));)++l;if((o=E&&M<9&&0==d&&l==n.coverEnd-n.coverStart?r.parentNode.getBoundingClientRect():function(e,t){var i,a,o=gs;if("left"==t)for(i=0;i<e.length&&(o=e[i]).left==o.right;i++);else for(a=e.length-1;0<=a&&(o=e[a]).left==o.right;a--);return o}(Yo(r,d,l).getClientRects(),a)).left||o.right||0==d)break;l=d,d-=1,h="right"}E&&M<11&&(o=function(e,t){var i;return window.screen&&null!=screen.logicalXDPI&&screen.logicalXDPI!=screen.deviceXDPI&&function(e){var t;return null!=yn?yn:(t=(e=f(e,T("span","x"))).getBoundingClientRect(),e=Yo(e,0,1).getBoundingClientRect(),yn=1<Math.abs(t.left-e.left))}(e)?(e=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI,{left:t.left*e,right:t.right*e,top:t.top*i,bottom:t.bottom*i}):t}(e.display.measure,o))}else 0<d&&(h=a="right"),o=e.options.lineWrapping&&1<(i=r.getClientRects()).length?i["right"==a?i.length-1:0]:r.getBoundingClientRect();!(E&&M<9)||d||o&&(o.left||o.right)||(i=r.parentNode.getClientRects()[0],o=i?{left:i.left,right:i.left+Zt(e.display),top:i.top,bottom:i.bottom}:gs);for(var i=o.top-t.rect.top,p=o.bottom-t.rect.top,c=(i+p)/2,u=t.view.measure.heights,b=0;b<u.length-1&&!(c<u[b]);b++);var g=b?u[b-1]:0,m=u[b],g={left:("right"==h?o.right:o.left)-t.rect.left,right:("left"==h?o.left:o.right)-t.rect.left,top:g,bottom:m};return o.left||o.right||(g.bogus=!0),e.options.singleCursorHeightPerLine||(g.rtop=i,g.rbottom=p),g}(e,t,i,a)).bogus||(t.cache[n]=s)}return{left:s.left,right:s.right,top:o?s.rtop:s.top,bottom:o?s.rbottom:s.bottom}}function Et(e,t,i){for(var a,o,s,n,r,d,l=0;l<e.length;l+=3)if(r=e[l],d=e[l+1],t<r?(o=0,s=1,n="left"):t<d?s=(o=t-r)+1:(l==e.length-3||t==d&&e[l+3]>t)&&(o=(s=d-r)-1,d<=t)&&(n="right"),null!=o){if(a=e[l+2],r==d&&i==(a.insertLeft?"left":"right")&&(n=i),"left"==i&&0==o)for(;l&&e[l-2]==e[l-3]&&e[l-1].insertLeft;)a=e[2+(l-=3)],n="left";if("right"==i&&o==d-r)for(;l<e.length-3&&e[l+3]==e[l+4]&&!e[l+5].insertLeft;)a=e[(l+=3)+2],n="right";break}return{node:a,start:o,end:s,collapse:n,coverStart:r,coverEnd:d}}function Mt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function At(e){e.display.externalMeasure=null,$(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Mt(e.display.view[t])}function Pt(e){At(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Rt(){return Ys&&an?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Vt(){return Ys&&an?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function $t(e){var t,i=0;if(e.widgets)for(t=0;t<e.widgets.length;++t)e.widgets[t].above&&(i+=xt(e.widgets[t]));return i}function Wt(e,t,i,a,o){return o||(o=$t(t),i.top+=o,i.bottom+=o),"line"==a||(a=a||"local",o=Oe(t),"local"==a?o+=vt(e.display):o-=e.display.viewOffset,"page"!=a&&"window"!=a||(o+=(t=e.display.lineSpace.getBoundingClientRect()).top+("window"==a?0:Vt()),e=t.left+("window"==a?0:Rt()),i.left+=e,i.right+=e),i.top+=o,i.bottom+=o),i}function Ht(e,t,i){var a;return"div"==i?t:(a=t.left,t=t.top,"page"==i?(a-=Rt(),t-=Vt()):"local"!=i&&i||(a+=(i=e.display.sizer.getBoundingClientRect()).left,t+=i.top),{left:a-(i=e.display.lineSpace.getBoundingClientRect()).left,top:t-i.top})}function qt(e,t,i,a,o){return Wt(e,a=a||S(e.doc,t.line),Ft(e,a,t.ch,o),i)}function zt(i,e,a,o,s,n){function r(e,t){e=Ut(i,s,e,t?"right":"left",n);return t?e.left=e.right:e.right=e.left,Wt(i,o,e,a)}function t(e,t,i){return r(i?e-1:e,1==h[t].level!=i)}o=o||S(i.doc,e.line),s=s||Lt(i,o);var d,l,h=Me(o,i.doc.direction),p=e.ch,e=e.sticky;return p>=o.text.length?(p=o.text.length,e="before"):p<=0&&(p=0,e="after"),h?(l=Ee(h,p,e),d=os,l=t(p,l,"before"==e),null!=d&&(l.other=t(p,d,"before"!=e)),l):r("before"==e?p-1:p,"before"==e)}function jt(e,t){var i=0;return t=N(e.doc,t),{left:i=e.options.lineWrapping?i:Zt(e.display)*t.ch,right:i,top:t=Oe(i=S(e.doc,t.line))+vt(e.display),bottom:t+i.height}}function Gt(e,t,i,a,o){e=k(e,t,i);return e.xRel=o,a&&(e.outside=!0),e}function Qt(e,t,i){var a,o,s,n=e.doc;if((i+=e.display.viewOffset)<0)return Gt(n.first,0,null,!0,-1);if(a=ne(n,i),(o=n.first+n.size-1)<a)return Gt(n.first+n.size-1,S(n,o).text.length,null,!0,1);for(t<0&&(t=0),s=S(n,a);;){var r=function(i,e,t,a,o){o-=Oe(e);var s,n,r=Lt(i,e),d=$t(e),l=0,h=e.text.length,p=!0,c=Me(e,i.doc.direction),u=(c&&(c=(i.options.lineWrapping?function(e,t,i,a,o,s,n){var r,d,l,h,n=Jt(e,t,a,n),p=n.begin,c=n.end;for(/\s/.test(t.text.charAt(c-1))&&c--,d=r=null,l=0;l<o.length;l++){var u;(h=o[l]).from>=c||h.to<=p||(u=1!=h.level,u=Ut(e,a,u?Math.min(c,h.to)-1:Math.max(p,h.from)).right,u=u<s?s-u+1e9:u-s,(!r||u<d)&&(r=h,d=u))}return r=(r=(r=r||o[o.length-1]).from<p?{from:p,to:r.to,level:r.level}:r).to>c?{from:r.from,to:c,level:r.level}:r}:function(i,a,o,s,n,r,d){var e,t=te(function(e){var e=n[e],t=1!=e.level;return Kt(zt(i,k(o,t?e.to:e.from,t?"before":"after"),"line",a,s),r,d,!0)},0,n.length-1),l=n[t];return 0<t&&(e=1!=l.level,Kt(e=zt(i,k(o,e?l.from:l.to,e?"after":"before"),"line",a,s),r,d,!0))&&e.top>d&&(l=n[t-1]),l})(i,e,t,r,c,a,o),p=1!=c.level,l=p?c.from:c.to-1,h=p?c.to:c.from-1),null),b=null,c=te(function(e){var t=Ut(i,r,e);return t.top+=d,t.bottom+=d,Kt(t,a,o,!1)&&(t.top<=o&&t.left<=a&&(u=e,b=t),1)},l,h),g=!1;return b?(s=a-b.left<b.right-a,c=u+((n=s==p)?0:1),n=n?"after":"before",s=s?b.left:b.right):(p||c!=h&&c!=l||c++,n=0==c||c!=e.text.length&&Ut(i,r,c-(p?1:0)).bottom+d<=o==p?"after":"before",h=zt(i,k(t,c,n),"line",e,r),s=h.left,g=o<h.top||o>=h.bottom),c=ee(e.text,c,1),Gt(t,c,n,g,a-s)}(e,s,a,t,i),d=we(s),l=d&&d.find(0,!0);if(!d||!(r.ch>l.from.ch||r.ch==l.from.ch&&0<r.xRel))return r;a=I(s=l.to.line)}}function Jt(t,e,i,a){a-=$t(e);var e=e.text.length,o=te(function(e){return Ut(t,i,e-1).bottom<=a},e,0);return{begin:o,end:te(function(e){return Ut(t,i,e).top>a},o,e)}}function Yt(e,t,i,a){return Jt(e,t,i=i||Lt(e,t),Wt(e,t,Ut(e,i,a),"line").top)}function Kt(e,t,i,a){return!(e.bottom<=i)&&(e.top>i||(a?e.left:e.right)>t)}function Xt(e){var t,i;if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ms){for(ms=T("pre"),t=0;t<49;++t)ms.appendChild(document.createTextNode("x")),ms.appendChild(T("br"));ms.appendChild(document.createTextNode("x"))}return f(e.measure,ms),3<(i=ms.offsetHeight/50)&&(e.cachedTextHeight=i),$(e.measure),i||1}function Zt(e){var t,i;return null!=e.cachedCharWidth?e.cachedCharWidth:(i=T("span","xxxxxxxxxx"),t=T("pre",[i]),f(e.measure,t),2<(i=((t=i.getBoundingClientRect()).right-t.left)/10)&&(e.cachedCharWidth=i),i||10)}function ei(e){for(var t=e.display,i={},a={},o=t.gutters.clientLeft,s=t.gutters.firstChild,n=0;s;s=s.nextSibling,++n)i[e.options.gutters[n]]=s.offsetLeft+s.clientLeft+o,a[e.options.gutters[n]]=s.clientWidth;return{fixedPos:ti(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:a,wrapperWidth:t.wrapper.clientWidth}}function ti(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ii(a){var o=Xt(a.display),s=a.options.lineWrapping,n=s&&Math.max(5,a.display.scroller.clientWidth/Zt(a.display)-3);return function(e){var t,i;if(Fe(a.doc,e))return 0;if(t=0,e.widgets)for(i=0;i<e.widgets.length;i++)e.widgets[i].height&&(t+=e.widgets[i].height);return s?t+(Math.ceil(e.text.length/n)||1)*o:t+o}}function ai(e){var t=e.doc,i=ii(e);t.iter(function(e){var t=i(e);t!=e.height&&se(e,t)})}function oi(e,t,i,a){var o,s,n=e.display;if(!i&&"true"==qe(t).getAttribute("cm-not-content"))return null;i=n.lineSpace.getBoundingClientRect();try{o=t.clientX-i.left,s=t.clientY-i.top}catch(t){return null}return n=Qt(e,o,s),a&&1==n.xRel&&(i=S(e.doc,n.line).text).length==n.ch&&(s=B(i,i.length,e.options.tabSize)-i.length,n=k(n.line,Math.max(0,Math.round((o-wt(e.display).left)/Zt(e.display))-s))),n}function si(e,t){var i,a;if(t>=e.display.viewTo||(t-=e.display.viewFrom)<0)return null;for(i=e.display.view,a=0;a<i.length;a++)if((t-=i[a].size)<0)return a}function ni(e){e.display.input.showSelection(e.display.input.prepareSelection())}function ri(e,t){void 0===t&&(t=!0);for(var i,a,o=e.doc,s={},n=s.cursors=document.createDocumentFragment(),r=s.selection=document.createDocumentFragment(),d=0;d<o.sel.ranges.length;d++)!t&&d==o.sel.primIndex||(i=o.sel.ranges[d]).from().line>=e.display.viewTo||i.to().line<e.display.viewFrom||(((a=i.empty())||e.options.showCursorWhenSelecting)&&di(e,i.head,n),a)||function(o,e,t){function _(e,t,i,a){t<0&&(t=0),t=Math.round(t),a=Math.round(a),n.appendChild(T("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==i?C-e:i)+"px;\n                             height: "+(a-t)+"px"))}function i(i,g,m){function f(e,t){return qt(o,k(i,e),"div",a,t)}function D(e,t,i){e=Yt(o,a,null,e),t="ltr"==t==("after"==i)?"left":"right";return f("after"==i?e.begin:e.end-(/\s/.test(a.text.charAt(e.end-1))?2:1),t)[t]}var y,B,a=S(s,i),I=a.text.length,x=Me(a,s.direction);return function(e,t,i,a){var o,s,n;if(!e)return a(t,i,"ltr",0);for(o=!1,s=0;s<e.length;++s)((n=e[s]).from<i&&n.to>t||t==i&&n.to==t)&&(a(Math.max(n.from,t),Math.min(n.to,i),1==n.level?"rtl":"ltr",s),o=!0);o||a(t,i,"ltr")}(x,g||0,null==m?I:m,function(e,t,i,a){var o,s,n,r,d,l="ltr"==i,h=f(e,l?"left":"right"),p=f(t-1,l?"right":"left"),c=null==g&&0==e,u=null==m&&t==I,b=0==a,a=!x||a==x.length-1;p.top-h.top<=3?(r=(w?c:u)&&b?v:(l?h:p).left,d=(w?u:c)&&a?C:(l?p:h).right,_(r,h.top,d-r,h.bottom)):(d=l?(o=w&&c&&b?v:h.left,s=w?C:D(e,i,"before"),n=w?v:D(t,i,"after"),w&&u&&a?C:p.right):(o=w?D(e,i,"before"):v,s=!w&&c&&b?C:h.right,n=!w&&u&&a?v:p.left,w?D(t,i,"after"):C),_(o,h.top,s-o,h.bottom),h.bottom<p.top&&_(v,h.bottom,null,p.top),_(n,p.top,d-n,p.bottom)),(!y||li(h,y)<0)&&(y=h),li(p,y)<0&&(y=p),(!B||li(h,B)<0)&&(B=h),li(p,B)<0&&(B=p)}),{start:y,end:B}}var a=o.display,s=o.doc,n=document.createDocumentFragment(),r=wt(o.display),v=r.left,C=Math.max(a.sizerWidth,St(o)-a.sizer.offsetLeft)-r.right,w="ltr"==s.direction,a=e.from(),r=e.to();{var d;a.line==r.line?i(a.line,a.ch,r.ch):(e=S(s,a.line),d=S(s,r.line),d=Se(e)==Se(d),a=i(a.line,a.ch,d?e.text.length+1:null).end,e=i(r.line,d?0:null,r.ch).start,d&&(a.top<e.top-2?(_(a.right,a.top,null,a.bottom),_(v,e.top,e.left,e.bottom)):_(a.right,a.top,e.left-a.right,a.bottom)),a.bottom<e.top&&_(v,a.bottom,null,e.top))}t.appendChild(n)}(e,i,r);return s}function di(e,t,i){var t=zt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),a=i.appendChild(T("div"," ","CodeMirror-cursor"));a.style.left=t.left+"px",a.style.top=t.top+"px",a.style.height=Math.max(0,t.bottom-t.top)*e.options.cursorHeight+"px",t.other&&((a=i.appendChild(T("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",a.style.left=t.other.left+"px",a.style.top=t.other.top+"px",a.style.height=.85*(t.other.bottom-t.other.top)+"px")}function li(e,t){return e.top-t.top||e.left-t.left}function hi(e){var t,i;e.state.focused&&(t=e.display,clearInterval(t.blinker),i=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function pi(e){e.state.focused||(e.display.input.focus(),ui(e))}function ci(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,bi(e))},100)}function ui(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(F(e,"focus",e,t),e.state.focused=!0,d(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),P&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),hi(e))}function bi(e,t){e.state.delayingBlurEvent||(e.state.focused&&(F(e,"blur",e,t),e.state.focused=!1,Jo(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function gi(e){for(var t,i,a,o,s,n=e.display,r=n.lineDiv.offsetTop,d=0;d<n.view.length;d++)if(i=void 0,!(t=n.view[d]).hidden&&(E&&M<8?(i=(a=t.node.offsetTop+t.node.offsetHeight)-r,r=a):i=(a=t.node.getBoundingClientRect()).bottom-a.top,o=t.line.height-i,i<2&&(i=Xt(n)),.005<o||o<-.005)&&(se(t.line,i),mi(t.line),t.rest))for(s=0;s<t.rest.length;s++)mi(t.rest[s])}function mi(e){var t,i,a;if(e.widgets)for(t=0;t<e.widgets.length;++t)(a=(i=e.widgets[t]).node.parentNode)&&(i.height=a.offsetHeight)}function fi(e,t,i){var a,o=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop,o=Math.floor(o-vt(e)),s=i&&null!=i.bottom?i.bottom:o+e.wrapper.clientHeight,o=ne(t,o),s=ne(t,s);return i&&i.ensure&&(a=i.ensure.from.line,i=i.ensure.to.line,a<o?s=ne(t,Oe(S(t,o=a))+e.wrapper.clientHeight):Math.min(i,t.lastLine())>=s&&(o=ne(t,Oe(S(t,i))-e.wrapper.clientHeight),s=i)),{from:o,to:Math.max(s,o+1)}}function Di(e){var t,i,a=e.display,o=a.view;if(a.alignWidgets||a.gutters.firstChild&&e.options.fixedGutter){for(var s=ti(a)-a.scroller.scrollLeft+e.doc.scrollLeft,n=a.gutters.offsetWidth,r=s+"px",d=0;d<o.length;d++)if(!o[d].hidden&&(e.options.fixedGutter&&(o[d].gutter&&(o[d].gutter.style.left=r),o[d].gutterBackground)&&(o[d].gutterBackground.style.left=r),t=o[d].alignable))for(i=0;i<t.length;i++)t[i].style.left=r;e.options.fixedGutter&&(a.gutters.style.left=s+n+"px")}}function yi(e){var t,i,a,o;if(e.options.lineNumbers)return t=e.doc,t=de(e.options,t.first+t.size-1),i=e.display,t.length!=i.lineNumChars?(a=(o=i.measure.appendChild(T("div",[T("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,o=o.offsetWidth-a,i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(a,i.lineGutter.offsetWidth-o)+1,i.lineNumWidth=i.lineNumInnerWidth+o,i.lineNumChars=i.lineNumInnerWidth?t.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",qi(e),1):void 0}function Bi(e,t){var i=e.display,a=Xt(e.display),o=(t.top<0&&(t.top=0),(e.curOp&&null!=e.curOp.scrollTop?e.curOp:i.scroller).scrollTop),s=kt(e),n={},r=(t.bottom-t.top>s&&(t.bottom=t.top+s),e.doc.height+Ct(i)),d=t.top<a,a=t.bottom>r-a,a=(t.top<o?n.scrollTop=d?0:t.top:t.bottom>o+s&&(d=Math.min(t.top,(a?r:t.bottom)-s))!=o&&(n.scrollTop=d),(e.curOp&&null!=e.curOp.scrollLeft?e.curOp:i.scroller).scrollLeft),r=St(e)-(e.options.fixedGutter?i.gutters.offsetWidth:0),s=t.right-t.left>r;return s&&(t.right=t.left+r),t.left<10?n.scrollLeft=0:t.left<a?n.scrollLeft=Math.max(0,t.left-(s?0:10)):t.right>r+a-3&&(n.scrollLeft=t.right+(s?0:10)-r),n}function Ii(e,t){null!=t&&(vi(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function xi(e){vi(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function _i(e,t,i){null==t&&null==i||vi(e),null!=t&&(e.curOp.scrollLeft=t),null!=i&&(e.curOp.scrollTop=i)}function vi(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Ci(e,jt(e,t.from),jt(e,t.to),t.margin))}function Ci(e,t,i,a){t=Bi(e,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-a,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+a});_i(e,t.scrollLeft,t.scrollTop)}function wi(e,t){Math.abs(e.doc.scrollTop-t)<2||(Qs||Hi(e,{top:t}),Ti(e,t,!0),Qs&&Hi(e),Ri(e,100))}function Ti(e,t,i){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),e.display.scroller.scrollTop==t&&!i||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop==t)||(e.display.scroller.scrollTop=t)}function Si(e,t,i,a){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!a||(e.doc.scrollLeft=t,Di(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function ki(e){var t=e.display,i=t.gutters.offsetWidth,a=Math.round(e.doc.height+Ct(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:a,scrollHeight:a+Tt(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function Ni(e,t){var i,a,o;for(t=t||ki(e),i=e.display.barWidth,a=e.display.barHeight,Fi(e,t),o=0;o<4&&i!=e.display.barWidth||a!=e.display.barHeight;o++)i!=e.display.barWidth&&e.options.lineWrapping&&gi(e),Fi(e,ki(e)),i=e.display.barWidth,a=e.display.barHeight}function Fi(e,t){var i=e.display,a=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=a.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=a.bottom)+"px",i.heightForcer.style.borderBottom=a.bottom+"px solid transparent",a.right&&a.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=a.bottom+"px",i.scrollbarFiller.style.width=a.right+"px"):i.scrollbarFiller.style.display="",a.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=a.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function Oi(i){i.display.scrollbars&&(i.display.scrollbars.clear(),i.display.scrollbars.addClass)&&Jo(i.display.wrapper,i.display.scrollbars.addClass),i.display.scrollbars=new fs[i.options.scrollbarStyle](function(e){i.display.wrapper.insertBefore(e,i.display.scrollbarFiller),V(e,"mousedown",function(){i.state.focused&&setTimeout(function(){return i.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Si:wi)(i,e)},i),i.display.scrollbars.addClass&&d(i.display.wrapper,i.display.scrollbars.addClass)}function Li(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ds},e=e.curOp,us?us.ops.push(e):e.ownsGroup=us={ops:[e],delayedCallbacks:[]}}function Ui(e){var e=e.curOp,t=function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;for(var i,a,o,s,n=e.ops,r=0;r<n.length;r++){h=l=d=void 0;var d=n[r],l=d.cm,h=l.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Tt(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Tt(e)+"px",t.scrollbarsClipped=!0)})(l),d.updateMaxLine&&Ue(l),d.mustUpdate=d.viewChanged||d.forceUpdate||null!=d.scrollTop||d.scrollToPos&&(d.scrollToPos.from.line<h.viewFrom||d.scrollToPos.to.line>=h.viewTo)||h.maxLineChanged&&l.options.lineWrapping,d.update=d.mustUpdate&&new ys(l,d.mustUpdate&&{top:d.scrollTop,ensure:d.scrollToPos},d.forceUpdate)}for(i=0;i<n.length;i++){p=void 0;var p=n[i];p.updatedDisplay=p.mustUpdate&&$i(p.cm,p.update)}for(a=0;a<n.length;a++){c=void 0;u=void 0;b=void 0;var c=n[a];var u=c.cm,b=u.display;c.updatedDisplay&&gi(u),c.barMeasure=ki(u),b.maxLineChanged&&!u.options.lineWrapping&&(c.adjustWidthTo=Ft(u,b.maxLine,b.maxLine.text.length).left+3,u.display.sizerWidth=c.adjustWidthTo,c.barMeasure.scrollWidth=Math.max(b.scroller.clientWidth,b.sizer.offsetLeft+c.adjustWidthTo+Tt(u)+u.display.barWidth),c.maxScrollLeft=Math.max(0,b.sizer.offsetLeft+c.adjustWidthTo-St(u))),(c.updatedDisplay||c.selectionChanged)&&(c.preparedSelection=b.input.prepareSelection())}for(o=0;o<n.length;o++){g=void 0;f=void 0;m=void 0;var g=n[o];var m,f=g.cm;null!=g.adjustWidthTo&&(f.display.sizer.style.minWidth=g.adjustWidthTo+"px",g.maxScrollLeft<f.doc.scrollLeft&&Si(f,Math.min(f.display.scroller.scrollLeft,g.maxScrollLeft),!0),f.display.maxLineChanged=!1),m=g.focus&&g.focus==q(),g.preparedSelection&&f.display.input.showSelection(g.preparedSelection,m),!g.updatedDisplay&&g.startHeight==f.doc.height||Ni(f,g.barMeasure),g.updatedDisplay&&zi(f,g.barMeasure),g.selectionChanged&&hi(f),f.state.focused&&g.updateInput&&f.display.input.reset(g.typing),m&&pi(g.cm)}for(s=0;s<n.length;s++){D=void 0;v=void 0;C=void 0;w=void 0;y=void 0;B=void 0;I=void 0;x=void 0;_=void 0;var D=n[s];var y,B,I,x,_,v=D.cm,C=v.display,w=v.doc;if(D.updatedDisplay&&Wi(v,D.update),null==C.wheelStartX||null==D.scrollTop&&null==D.scrollLeft&&!D.scrollToPos||(C.wheelStartX=C.wheelStartY=null),null!=D.scrollTop&&Ti(v,D.scrollTop,D.forceScroll),null!=D.scrollLeft&&Si(v,D.scrollLeft,!0,!0),D.scrollToPos&&(y=function(e,t,i,a){var o;for(null==a&&(a=0),e.options.lineWrapping||t!=i||(i="before"==(t=t.ch?k(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?k(t.line,t.ch+1,"before"):t),o=0;o<5;o++){var s,n=!1,r=zt(e,t),d=i&&i!=t?zt(e,i):r,r=Bi(e,s={left:Math.min(r.left,d.left),top:Math.min(r.top,d.top)-a,right:Math.max(r.left,d.left),bottom:Math.max(r.bottom,d.bottom)+a}),d=e.doc.scrollTop,l=e.doc.scrollLeft;if(null!=r.scrollTop&&(wi(e,r.scrollTop),1<Math.abs(e.doc.scrollTop-d))&&(n=!0),!(n=null!=r.scrollLeft&&(Si(e,r.scrollLeft),1<Math.abs(e.doc.scrollLeft-l))?!0:n))break}return s}(v,N(w,D.scrollToPos.from),N(w,D.scrollToPos.to),D.scrollToPos.margin),function(e,t){var i,a,o;O(e,"scrollCursorIntoView")||(a=(i=e.display).sizer.getBoundingClientRect(),o=null,t.top+a.top<0?o=!0:t.bottom+a.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null==o)||en||(a=T("div","​",null,"position: absolute;\n                         top: "+(t.top-i.viewOffset-vt(e.display))+"px;\n                         height: "+(t.bottom-t.top+Tt(e)+i.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(a),a.scrollIntoView(o),e.display.lineSpace.removeChild(a))}(v,y)),B=D.maybeHiddenMarkers,I=D.maybeUnhiddenMarkers,B)for(x=0;x<B.length;++x)B[x].lines.length||F(B[x],"hide");if(I)for(_=0;_<I.length;++_)I[_].lines.length&&F(I[_],"unhide");C.wrapper.offsetHeight&&(w.scrollTop=v.display.scroller.scrollTop),D.changeObjs&&F(v,"changes",v,D.changeObjs),D.update&&D.update.finish()}};if(e=e.ownsGroup)try{var i,a,o=e,s=o.delayedCallbacks,n=0;do{for(;n<s.length;n++)s[n].call(null);for(i=0;i<o.ops.length;i++)if((a=o.ops[i]).cursorActivityHandlers)for(;a.cursorActivityCalled<a.cursorActivityHandlers.length;)a.cursorActivityHandlers[a.cursorActivityCalled++].call(null,a.cm)}while(n<s.length)}finally{us=null,t(e)}}function p(e,t){if(e.curOp)return t();Li(e);try{return t()}finally{Ui(e)}}function C(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Li(e);try{return t.apply(e,arguments)}finally{Ui(e)}}}function e(e){return function(){if(this.curOp)return e.apply(this,arguments);Li(this);try{return e.apply(this,arguments)}finally{Ui(this)}}}function t(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Li(e);try{return t.apply(this,arguments)}finally{Ui(e)}}}function y(e,t,i,a){var o,s,n;null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),o=e.display,(a=a||0)&&i<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo?as&&ke(e.doc,t)<o.viewTo&&Mi(e):i<=o.viewFrom?as&&Ne(e.doc,i+a)>o.viewFrom?Mi(e):(o.viewFrom+=a,o.viewTo+=a):t<=o.viewFrom&&i>=o.viewTo?Mi(e):t<=o.viewFrom?(n=Ai(e,i,i+a,1))?(o.view=o.view.slice(n.index),o.viewFrom=n.lineN,o.viewTo+=a):Mi(e):i>=o.viewTo?(n=Ai(e,t,t,-1))?(o.view=o.view.slice(0,n.index),o.viewTo=n.lineN):Mi(e):(n=Ai(e,t,t,-1),s=Ai(e,i,i+a,1),n&&s?(o.view=o.view.slice(0,n.index).concat(ut(e,n.lineN,s.lineN)).concat(o.view.slice(s.index)),o.viewTo+=a):Mi(e)),(n=o.externalMeasured)&&(i<n.lineN?n.lineN+=a:t<n.lineN+n.size&&(o.externalMeasured=null))}function Ei(e,t,i){var a,o;e.curOp.viewChanged=!0,o=e.display,(a=e.display.externalMeasured)&&t>=a.lineN&&t<a.lineN+a.size&&(o.externalMeasured=null),t<o.viewFrom||t>=o.viewTo||null!=(a=o.view[si(e,t)]).node&&-1==b(o=a.changes||(a.changes=[]),i)&&o.push(i)}function Mi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Ai(e,t,i,a){var o,s,n,r=si(e,t),d=e.display.view;if(as&&i!=e.doc.first+e.doc.size){for(s=e.display.viewFrom,n=0;n<r;n++)s+=d[n].size;if(s!=t){if(0<a){if(r==d.length-1)return null;o=s+d[r].size-t,r++}else o=s-t;t+=o,i+=o}for(;ke(e.doc,i)!=i;){if(r==(a<0?0:d.length-1))return null;i+=a*d[r-(a<0?1:0)].size,r+=a}}return{index:r,lineN:i}}function Pi(e){for(var t,i=e.display.view,a=0,o=0;o<i.length;o++)(t=i[o]).hidden||t.node&&!t.changes||++a;return a}function Ri(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,z(Vi,e))}function Vi(n){var r,d,l,h=n.doc;h.highlightFrontier>=n.display.viewTo||(r=+new Date+n.options.workTime,d=et(n,h.highlightFrontier),l=[],h.iter(d.line,Math.min(h.first+h.size,n.display.viewTo+500),function(e){var t,i;if(d.line>=n.display.viewFrom){var a=e.styles,o=e.text.length>n.options.maxHighlightLength?Je(h.mode,d.state):null,s=Xe(n,e,d,!0);for(o&&(d.state=o),e.styles=s.styles,o=e.styleClasses,(s=s.classes)?e.styleClasses=s:o&&(e.styleClasses=null),t=!a||a.length!=e.styles.length||o!=s&&(!o||!s||o.bgClass!=s.bgClass||o.textClass!=s.textClass),i=0;!t&&i<a.length;++i)t=a[i]!=e.styles[i];t&&l.push(d.line),e.stateAfter=d.save()}else e.text.length<=n.options.maxHighlightLength&&tt(n,e.text,d),e.stateAfter=d.line%5==0?d.save():null;if(d.nextLine(),+new Date>r)return Ri(n,n.options.workDelay),!0}),h.highlightFrontier=d.line,h.modeFrontier=Math.max(h.modeFrontier,d.line),l.length&&p(n,function(){for(var e=0;e<l.length;e++)Ei(n,l[e],"text")}))}function $i(e,t){var i=e.display,a=e.doc;if(t.editorIsHidden)return Mi(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==Pi(e))return!1;yi(e)&&(Mi(e),t.dims=ei(e));var o,s=a.first+a.size,n=Math.max(t.visible.from-e.options.viewportMargin,a.first),r=Math.min(s,t.visible.to+e.options.viewportMargin);return i.viewFrom<n&&n-i.viewFrom<20&&(n=Math.max(a.first,i.viewFrom)),i.viewTo>r&&i.viewTo-r<20&&(r=Math.min(s,i.viewTo)),as&&(n=ke(e.doc,n),r=Ne(e.doc,r)),a=n!=i.viewFrom||r!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth,s=n,n=r,0==(o=(r=e).display).view.length||s>=o.viewTo||n<=o.viewFrom?(o.view=ut(r,s,n),o.viewFrom=s):(o.viewFrom>s?o.view=ut(r,s,o.viewFrom).concat(o.view):o.viewFrom<s&&(o.view=o.view.slice(si(r,s))),o.viewFrom=s,o.viewTo<n?o.view=o.view.concat(ut(r,o.viewTo,n)):o.viewTo>n&&(o.view=o.view.slice(0,si(r,n)))),o.viewTo=n,i.viewOffset=Oe(S(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px",s=Pi(e),!(!a&&0==s&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)||(r=!(r=e).hasFocus()&&(o=q())&&H(r.display.lineDiv,o)?(o={activeElt:o},window.getSelection&&(n=window.getSelection()).anchorNode&&n.extend&&H(r.display.lineDiv,n.anchorNode)&&(o.anchorNode=n.anchorNode,o.anchorOffset=n.anchorOffset,o.focusNode=n.focusNode,o.focusOffset=n.focusOffset),o):null,4<s&&(i.lineDiv.style.display="none"),function(i,e,t){function a(e){var t=e.nextSibling;return P&&sn&&i.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var o,s,n=i.display,r=i.options.lineNumbers,d=n.lineDiv,l=d.firstChild,h=n.view,p=n.viewFrom,c=0;c<h.length;c++){if(!(o=h[c]).hidden)if(o.node&&o.node.parentNode==d){for(;l!=o.node;)l=a(l);s=r&&null!=e&&e<=p&&o.lineNumber,o.changes&&(-1<b(o.changes,"gutter")&&(s=!1),gt(i,o,p,t)),s&&($(o.lineNumber),o.lineNumber.appendChild(document.createTextNode(de(i.options,p)))),l=o.node.nextSibling}else s=function(e,t,i,a){var o=ft(e,t);return t.text=t.node=o.pre,o.bgClass&&(t.bgClass=o.bgClass),o.textClass&&(t.textClass=o.textClass),Dt(e,t),yt(e,t,i,a),Bt(e,t,a),t.node}(i,o,p,t),d.insertBefore(s,l);p+=o.size}for(;l;)l=a(l)}(e,i.updateLineNumbers,t.dims),4<s&&(i.lineDiv.style.display=""),i.renderedView=i.view,(n=r)&&n.activeElt&&n.activeElt!=q()&&(n.activeElt.focus(),n.anchorNode)&&H(document.body,n.anchorNode)&&H(document.body,n.focusNode)&&(o=window.getSelection(),(s=document.createRange()).setEnd(n.anchorNode,n.anchorOffset),s.collapse(!1),o.removeAllRanges(),o.addRange(s),o.extend(n.focusNode,n.focusOffset)),$(i.cursorDiv),$(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,a&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,Ri(e,400)),i.updateLineNumbers=null))}function Wi(e,t){for(var i,a=t.viewport,o=!0;(o&&e.options.lineWrapping&&t.oldDisplayWidth!=St(e)||(a&&null!=a.top&&(a={top:Math.min(e.doc.height+Ct(e.display)-kt(e),a.top)}),t.visible=fi(e.display,e.doc,a),!(t.visible.from>=e.display.viewFrom))||!(t.visible.to<=e.display.viewTo))&&$i(e,t);o=!1)gi(e),i=ki(e),ni(e),Ni(e,i),zi(e,i),t.force=!1;t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Hi(e,t){var i,t=new ys(e,t);$i(e,t)&&(gi(e),Wi(e,t),i=ki(e),ni(e),Ni(e,i),zi(e,i),t.finish())}function qi(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function zi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Tt(e)+"px"}function ji(e){var t,i,a,o=e.display.gutters,s=e.options.gutters;for($(o),t=0;t<s.length;++t)i=s[t],a=o.appendChild(T("div",null,"CodeMirror-gutter "+i)),"CodeMirror-linenumbers"==i&&((e.display.lineGutter=a).style.width=(e.display.lineNumWidth||1)+"px");o.style.display=t?"":"none",qi(e)}function Gi(e){var t=b(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):-1<t&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function Qi(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}}function Ji(e){e=Qi(e);return e.x*=g,e.y*=g,e}function Yi(e,t){var i,a,o,s,n,r=Qi(t),d=r.x,r=r.y,l=e.display,h=l.scroller,p=h.scrollWidth>h.clientWidth,c=h.scrollHeight>h.clientHeight;if(d&&p||r&&c){if(r&&sn&&P)e:for(i=t.target,a=l.view;i!=h;i=i.parentNode)for(o=0;o<a.length;o++)if(a[o].node==i){e.display.currentWheelTarget=i;break e}!d||Qs||Ks||null==g?(r&&null!=g&&(p=r*g,n=(s=e.doc.scrollTop)+l.wrapper.clientHeight,p<0?s=Math.max(0,s+p-50):n=Math.min(e.doc.height,n+p+50),Hi(e,{top:s,bottom:n})),Bs<20&&(null==l.wheelStartX?(l.wheelStartX=h.scrollLeft,l.wheelStartY=h.scrollTop,l.wheelDX=d,l.wheelDY=r,setTimeout(function(){var e,t;null!=l.wheelStartX&&(e=h.scrollLeft-l.wheelStartX,t=(t=h.scrollTop-l.wheelStartY)&&l.wheelDY&&t/l.wheelDY||e&&l.wheelDX&&e/l.wheelDX,l.wheelStartX=l.wheelStartY=null,t)&&(g=(g*Bs+t)/(Bs+1),++Bs)},200)):(l.wheelDX+=d,l.wheelDY+=r))):(r&&c&&wi(e,Math.max(0,h.scrollTop+r*g)),Si(e,Math.max(0,h.scrollLeft+d*g)),r&&!c||v(t),l.wheelStartX=null)}}function Ki(e,t){var i,a=e[t];for(e.sort(function(e,t){return x(e.from(),t.from())}),t=b(e,a),i=1;i<e.length;i++){var o,s,n,r=e[i];0<=x((n=e[i-1]).to(),r.from())&&(o=ce(n.from(),r.from()),s=pe(n.to(),r.to()),r=n.empty()?r.from()==r.head:n.from()==n.head,i<=t&&--t,e.splice(--i,2,new U(r?s:o,r?o:s)))}return new L(e,t)}function Xi(e,t){return new L([new U(e,t||e)],0)}function Zi(e){return e.text?k(e.from.line+e.text.length-1,A(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function ea(e,t){var i,a;return x(e,t.from)<0?e:x(e,t.to)<=0?Zi(t):(i=e.line+t.text.length-(t.to.line-t.from.line)-1,a=e.ch,e.line==t.to.line&&(a+=Zi(t).ch-t.to.ch),k(i,a))}function ta(e,t){for(var i,a=[],o=0;o<e.sel.ranges.length;o++)i=e.sel.ranges[o],a.push(new U(ea(i.anchor,t),ea(i.head,t)));return Ki(a,e.sel.primIndex)}function ia(e,t,i){return e.line==t.line?k(i.line,e.ch-t.ch+i.ch):k(i.line+(e.line-t.line),e.ch)}function aa(e){e.doc.mode=Ge(e.options,e.doc.modeOption),oa(e)}function oa(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Ri(e,100),e.state.modeGen++,e.curOp&&y(e)}function sa(e,t){return 0==t.from.ch&&0==t.to.ch&&""==A(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function na(e,s,t,n){function o(e){return t?t[e]:null}function i(e,t,i){var a,o;t=t,i=i,o=n,(a=e).text=t,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),null!=a.order&&(a.order=null),ye(a),Be(a,i),(t=o?o(a):1)!=a.height&&se(a,t),D(e,"change",e,s)}function a(e,t){for(var i=[],a=e;a<t;++a)i.push(new hs(h[a],o(a),n));return i}var r,d=s.from,l=s.to,h=s.text,p=S(e,d.line),c=S(e,l.line),u=A(h),b=o(h.length-1),g=l.line-d.line;s.full?(e.insert(0,a(0,h.length)),e.remove(h.length,e.size-h.length)):sa(e,s)?(r=a(0,h.length-1),i(c,c.text,b),g&&e.remove(d.line,g),r.length&&e.insert(d.line,r)):p==c?1==h.length?i(p,p.text.slice(0,d.ch)+u+p.text.slice(l.ch),b):((r=a(1,h.length-1)).push(new hs(u+p.text.slice(l.ch),b,n)),i(p,p.text.slice(0,d.ch)+h[0],o(0)),e.insert(d.line+1,r)):1==h.length?(i(p,p.text.slice(0,d.ch)+h[0]+c.text.slice(l.ch),o(0)),e.remove(d.line+1,g)):(i(p,p.text.slice(0,d.ch)+h[0],o(0)),i(c,u+c.text.slice(l.ch),b),r=a(1,h.length-1),1<g&&e.remove(d.line+1,g-1),e.insert(d.line+1,r)),D(e,"change",e,s)}function ra(e,r,d){!function e(t,i,a){var o,s,n;if(t.linked)for(o=0;o<t.linked.length;++o)(s=t.linked[o]).doc!=i&&(n=a&&s.sharedHist,!d||n)&&(r(s.doc,n),e(s.doc,t,n))}(e,null,!0)}function da(e,t){if(t.cm)throw new Error("This document is already in use.");ai((e.doc=t).cm=e),aa(e),la(e),e.options.lineWrapping||Ue(e),e.options.mode=t.modeOption,y(e)}function la(e){("rtl"==e.doc.direction?d:Jo)(e.display.lineDiv,"CodeMirror-rtl")}function ha(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function pa(e,t){var i={from:he(t.from),to:Zi(t),text:ae(e,t.from,t.to)};return ma(e,i,t.from.line,t.to.line+1),ra(e,function(e){return ma(e,i,t.from.line,t.to.line+1)},!0),i}function ca(e){for(;e.length;){if(!A(e).ranges)break;e.pop()}}function ua(e,t,i,a){var o,s,n,r,d=e.history;if(d.undone.length=0,o=+new Date,(d.lastOp==a||d.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&d.lastModTime>o-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(r=(r=d).lastOp==a?(ca(r.done),A(r.done)):r.done.length&&!A(r.done).ranges?A(r.done):1<r.done.length&&!r.done[r.done.length-2].ranges?(r.done.pop(),A(r.done)):void 0))s=A(r.changes),0==x(t.from,t.to)&&0==x(t.from,s.to)?s.to=Zi(t):r.changes.push(pa(e,t));else for((n=A(d.done))&&n.ranges||ga(e.sel,d.done),r={changes:[pa(e,t)],generation:d.generation},d.done.push(r);d.done.length>d.undoDepth;)d.done.shift(),d.done[0].ranges||d.done.shift();d.done.push(i),d.generation=++d.maxGeneration,d.lastModTime=d.lastSelTime=o,d.lastOp=d.lastSelOp=a,d.lastOrigin=d.lastSelOrigin=t.origin,s||F(e,"historyAdded")}function ba(e,t,i,a){var o,s,n,r=e.history,d=a&&a.origin;i==r.lastSelOp||d&&r.lastSelOrigin==d&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==d||(e=e,o=d,s=A(r.done),n=t,"*"==(o=o.charAt(0)))||"+"==o&&s.ranges.length==n.ranges.length&&s.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500))?r.done[r.done.length-1]=t:ga(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=d,r.lastSelOp=i,a&&!1!==a.clearRedo&&ca(r.undone)}function ga(e,t){var i=A(t);i&&i.ranges&&i.equals(e)||t.push(e)}function ma(t,i,e,a){var o=i["spans_"+t.id],s=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,a),function(e){e.markedSpans&&((o=o||(i["spans_"+t.id]={}))[s]=e.markedSpans),++s})}function fa(e,t){var i,a,o=t["spans_"+e.id];if(!o)return null;for(i=[],a=0;a<t.text.length;++a)i.push(function(e){var t,i;if(!e)return null;for(i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t=t||e.slice(0,i):t&&t.push(e[i]);return t?t.length?t:null:e}(o[a]));return i}function Da(e,t){var i,a,o,s,n,r,d=fa(e,t),l=fe(e,t);if(!d)return l;if(l)for(i=0;i<d.length;++i)if(a=d[i],o=l[i],a&&o)e:for(s=0;s<o.length;++s){for(n=o[s],r=0;r<a.length;++r)if(a[r].marker==n.marker)continue e;a.push(n)}else o&&(d[i]=o);return d}function ya(e,t,i){for(var a,o,s,n,r,d,l,h=[],p=0;p<e.length;++p)if((a=e[p]).ranges)h.push(i?L.prototype.deepCopy.call(a):a);else for(o=a.changes,h.push({changes:s=[]}),n=0;n<o.length;++n)if(r=o[n],s.push({from:r.from,to:r.to,text:r.text}),t)for(l in r)(d=l.match(/^spans_(\d+)$/))&&-1<b(t,Number(d[1]))&&(A(s)[l]=r[l],delete r[l]);return h}function Ba(e,t,i,a){return a?(a=e.anchor,i&&((e=x(t,a)<0)!=x(i,a)<0?(a=t,t=i):e!=x(t,i)<0&&(t=i)),new U(a,t)):new U(i||t,t)}function Ia(e,t,i,a,o){null==o&&(o=e.cm&&(e.cm.display.shift||e.extend)),w(e,new L([Ba(e.sel.primary(),t,i,o)],0),a)}function xa(e,t,i){for(var a=[],o=e.cm&&(e.cm.display.shift||e.extend),s=0;s<e.sel.ranges.length;s++)a[s]=Ba(e.sel.ranges[s],t[s],null,o);w(e,Ki(a,e.sel.primIndex),i)}function _a(e,t,i,a){var o=e.sel.ranges.slice(0);o[t]=i,w(e,Ki(o,e.sel.primIndex),a)}function va(e,t,i,a){w(e,Xi(t,i),a)}function Ca(e,t,i){var a=e.history.done,o=A(a);(o&&o.ranges?(a[a.length-1]=t,wa):w)(e,t,i)}function w(e,t,i){wa(e,t,i),ba(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function wa(e,t,i){(Re(e,"beforeSelectionChange")||e.cm&&Re(e.cm,"beforeSelectionChange"))&&(a=e,s=i,s={ranges:(o=t).ranges,update:function(e){var t;for(this.ranges=[],t=0;t<e.length;t++)this.ranges[t]=new U(N(a,e[t].anchor),N(a,e[t].head))},origin:s&&s.origin},F(a,"beforeSelectionChange",a,s),a.cm&&F(a.cm,"beforeSelectionChange",a.cm,s),t=s.ranges!=o.ranges?Ki(s.ranges,s.ranges.length-1):o);var a,o,s=i&&i.bias||(x(t.primary().head,e.sel.primary().head)<0?-1:1);Ta(e,ka(e,t,s,!0)),i&&!1===i.scroll||!e.cm||xi(e.cm)}function Ta(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Pe(e.cm)),D(e,"cursorActivity",e))}function Sa(e){Ta(e,ka(e,e.sel,null,!1))}function ka(e,t,i,a){for(var o,s=0;s<t.ranges.length;s++){var n=t.ranges[s],r=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],d=Fa(e,n.anchor,r&&r.anchor,i,a),r=Fa(e,n.head,r&&r.head,i,a);!o&&d==n.anchor&&r==n.head||((o=o||t.ranges.slice(0,s))[s]=new U(d,r))}return o?Ki(o,t.primIndex):t}function Na(e,t,i,a,o){var s,n,r,d,l=S(e,t.line);if(l.markedSpans)for(s=0;s<l.markedSpans.length;++s)if(n=(r=l.markedSpans[s]).marker,(null==r.from||(n.inclusiveLeft?r.from<=t.ch:r.from<t.ch))&&(null==r.to||(n.inclusiveRight?r.to>=t.ch:r.to>t.ch))){if(o&&(F(n,"beforeCursorEnter"),n.explicitlyCleared)){if(l.markedSpans){--s;continue}break}if(n.atomic)return i&&(r=n.find(a<0?1:-1),d=void 0,r=(a<0?n.inclusiveRight:n.inclusiveLeft)?Oa(e,r,-a,r&&r.line==t.line?l:null):r)&&r.line==t.line&&(d=x(r,i))&&(a<0?d<0:0<d)?Na(e,r,t,a,o):(d=n.find(a<0?-1:1),(d=(a<0?n.inclusiveLeft:n.inclusiveRight)?Oa(e,d,a,d.line==t.line?l:null):d)?Na(e,d,t,a,o):null);continue}return t}function Fa(e,t,i,a,o){a=a||1,o=Na(e,t,i,a,o)||!o&&Na(e,t,i,a,!0)||Na(e,t,i,-a,o)||!o&&Na(e,t,i,-a,!0);return o||(e.cantEdit=!0,k(e.first,0))}function Oa(e,t,i,a){return i<0&&0==t.ch?t.line>e.first?N(e,k(t.line-1)):null:0<i&&t.ch==(a||S(e,t.line)).text.length?t.line<e.first+e.size-1?k(t.line+1,0):null:new k(t.line,t.ch+i)}function La(e){e.setSelection(k(e.firstLine(),0),k(e.lastLine()),ln)}function Ua(o,e,t){var s={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return s.canceled=!0}};return t&&(s.update=function(e,t,i,a){e&&(s.from=N(o,e)),t&&(s.to=N(o,t)),i&&(s.text=i),void 0!==a&&(s.origin=a)}),F(o,"beforeChange",o,s),o.cm&&F(o.cm,"beforeChange",o.cm,s),s.canceled?null:{from:s.from,to:s.to,text:s.text,origin:s.origin}}function Ea(e,t,i){var a,o;if(e.cm){if(!e.cm.curOp)return C(e.cm,Ea)(e,t,i);if(e.cm.state.suppressEdits)return}if(!Re(e,"beforeChange")&&(!e.cm||!Re(e.cm,"beforeChange"))||(t=Ua(e,t,!0)))if(a=is&&!i&&function(e,t,i){var a,o,s,n,r,d,l,h,p,c=null;if(e.iter(t.line,i.line+1,function(e){var t,i;if(e.markedSpans)for(t=0;t<e.markedSpans.length;++t)!(i=e.markedSpans[t].marker).readOnly||c&&-1!=b(c,i)||(c=c||[]).push(i)}),!c)return null;for(a=[{from:t,to:i}],o=0;o<c.length;++o)for(n=(s=c[o]).find(0),r=0;r<a.length;++r)x((p=a[r]).to,n.from)<0||0<x(p.from,n.to)||(d=[r,1],l=x(p.from,n.from),h=x(p.to,n.to),(l<0||!s.inclusiveLeft&&!l)&&d.push({from:p.from,to:n.from}),(0<h||!s.inclusiveRight&&!h)&&d.push({from:n.to,to:p.to}),a.splice.apply(a,d),r+=d.length-3);return a}(e,t.from,t.to))for(o=a.length-1;0<=o;--o)Ma(e,{from:a[o].from,to:a[o].to,text:o?[""]:t.text,origin:t.origin});else Ma(e,t)}function Ma(e,i){var t,a;1==i.text.length&&""==i.text[0]&&0==x(i.from,i.to)||(t=ta(e,i),ua(e,i,t,e.cm?e.cm.curOp.id:NaN),Ra(e,i,t,fe(e,i)),a=[],ra(e,function(e,t){t||-1!=b(a,e.history)||(Ha(e.history,i),a.push(e.history)),Ra(e,i,null,fe(e,i))}))}function Aa(o,s,e){var n,r,t,i,a;if(!o.cm||!o.cm.state.suppressEdits||e){for(var d,l=o.history,h=o.sel,p="undo"==s?l.done:l.undone,c="undo"==s?l.undone:l.done,u=0;u<p.length&&(d=p[u],e?!d.ranges||d.equals(o.sel):d.ranges);u++);if(u!=p.length){for(l.lastOrigin=l.lastSelOrigin=null;(d=p.pop()).ranges;){if(ga(d,c),e&&!d.equals(o.sel))return void w(o,d,{clearRedo:!1});h=d}for(n=[],ga(h,c),c.push({changes:n,generation:l.generation}),l.generation=d.generation||++l.maxGeneration,r=Re(o,"beforeChange")||o.cm&&Re(o.cm,"beforeChange"),t=function(e){var t,i,a=d.changes[e];if(a.origin=s,r&&!Ua(o,a,!1))return p.length=0,{};n.push(pa(o,a)),t=e?ta(o,a):A(p),Ra(o,a,t,Da(o,a)),!e&&o.cm&&o.cm.scrollIntoView({from:a.from,to:Zi(a)}),i=[],ra(o,function(e,t){t||-1!=b(i,e.history)||(Ha(e.history,a),i.push(e.history)),Ra(e,a,null,Da(e,a))})},i=d.changes.length-1;0<=i;--i)if(a=t(i))return a.v}}}function Pa(e,t){if(0!=t&&(e.first+=t,e.sel=new L(J(e.sel.ranges,function(e){return new U(k(e.anchor.line+t,e.anchor.ch),k(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){y(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,a=i.viewFrom;a<i.viewTo;a++)Ei(e.cm,a,"gutter")}}function Ra(e,t,i,a){var o,s,n,r,d,l,h,p,c,u,b,g;if(e.cm&&!e.cm.curOp)return C(e.cm,Ra)(e,t,i,a);if(t.to.line<e.first)Pa(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first&&(Pa(e,o=t.text.length-1-(e.first-t.from.line)),t={from:k(e.first,0),to:k(t.to.line+o,t.to.ch),text:[A(t.text)],origin:t.origin}),o=e.lastLine(),(t=t.to.line>o?{from:t.from,to:k(o,S(e,o).text.length),text:[t.text[0]],origin:t.origin}:t).removed=ae(e,t.from,t.to),i=i||ta(e,t),e.cm){o=e.cm,s=t,n=a,r=o.doc,d=o.display,l=s.from,h=s.to,p=!1,c=l.line,o.options.lineWrapping||(c=I(Se(S(r,l.line))),r.iter(c,h.line+1,function(e){if(e==d.maxLine)return p=!0})),-1<r.sel.contains(s.from,s.to)&&Pe(o),na(r,s,n,ii(o)),o.options.lineWrapping||(r.iter(c,l.line+s.text.length,function(e){var t=Le(e);t>d.maxLineLength&&(d.maxLine=e,d.maxLineLength=t,d.maxLineChanged=!0,p=!1)}),p&&(o.curOp.updateMaxLine=!0));var m=r,f=l.line;if(m.modeFrontier=Math.min(m.modeFrontier,f),!(m.highlightFrontier<f-10)){for(u=m.first,b=f-1;u<b;b--)if((g=S(m,b).stateAfter)&&(!(g instanceof rs)||b+g.lookAhead<f)){u=b+1;break}m.highlightFrontier=Math.min(m.highlightFrontier,u)}Ri(o,400),n=s.text.length-(h.line-l.line)-1,s.full?y(o):l.line!=h.line||1!=s.text.length||sa(o.doc,s)?y(o,l.line,h.line+1,n):Ei(o,l.line,"text"),c=Re(o,"changes"),((r=Re(o,"change"))||c)&&(n={from:l,to:h,text:s.text,removed:s.removed,origin:s.origin},r&&D(o,"change",o,n),c)&&(o.curOp.changeObjs||(o.curOp.changeObjs=[])).push(n),o.display.selForContextMenu=null}else na(e,t,a);wa(e,i,ln)}}function Va(e,t,i,a,o){var s;x(a=a||i,i)<0&&(i=(s=[a,i])[0],a=s[1]),"string"==typeof t&&(t=e.splitLines(t)),Ea(e,{from:i,to:a,text:t,origin:o})}function $a(e,t,i,a){i<e.line?e.line+=a:t<e.line&&(e.line=t,e.ch=0)}function Wa(e,t,i,a){for(var o,s,n,r,d,l=0;l<e.length;++l)if(s=!0,(o=e[l]).ranges)for(o.copied||((o=e[l]=o.deepCopy()).copied=!0),n=0;n<o.ranges.length;n++)$a(o.ranges[n].anchor,t,i,a),$a(o.ranges[n].head,t,i,a);else{for(r=0;r<o.changes.length;++r)if(i<(d=o.changes[r]).from.line)d.from=k(d.from.line+a,d.from.ch),d.to=k(d.to.line+a,d.to.ch);else if(t<=d.to.line){s=!1;break}s||(e.splice(0,l+1),l=0)}}function Ha(e,t){var i=t.from.line,a=t.to.line,t=t.text.length-(a-i)-1;Wa(e.done,i,a,t),Wa(e.undone,i,a,t)}function qa(e,t,i,a){var o=t,s=t;return"number"==typeof t?s=S(e,ue(e,t)):o=I(t),null==o?null:(a(s,o)&&e.cm&&Ei(e.cm,o,i),s)}function za(e){var t,i;for(this.lines=e,this.parent=null,i=t=0;i<e.length;++i)e[i].parent=this,t+=e[i].height;this.height=t}function ja(e){var t,i,a,o;for(this.children=e,a=i=t=0;a<e.length;++a)t+=(o=e[a]).chunkSize(),i+=o.height,o.parent=this;this.size=t,this.height=i,this.parent=null}function Ga(e,t,i){Oe(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Ii(e,i)}function Qa(t,i,a,e,o){var s,n,r,d,l,h,p,c,u,b,g,m,f;if(e&&e.shared)return h=t,p=i,c=a,b=o,(u=j(u=e)).shared=!1,g=[Qa(h,p,c,u,b)],m=g[0],f=u.widgetNode,ra(h,function(e){f&&(u.widgetNode=f.cloneNode(!0)),g.push(Qa(e,N(e,p),N(e,c),u,b));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;m=A(g)}),new vs(g,m);if(t.cm&&!t.cm.curOp)return C(t.cm,Qa)(t,i,a,e,o);if(s=new _s(t,o),h=x(i,a),e&&j(e,s,!1),!(0<h||0==h&&!1!==s.clearWhenEmpty)){if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=W("span",[s.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft)&&(s.widgetNode.insertLeft=!0),s.collapsed){if(Te(t,i.line,i,a,s)||i.line!=a.line&&Te(t,a.line,i,a,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");as=!0}if(s.addToHistory&&ua(t,{from:i,to:a,origin:"markText"},t.sel,NaN),n=i.line,r=t.cm,t.iter(n,a.line+1,function(e){var t;r&&s.collapsed&&!r.options.lineWrapping&&Se(e)==r.display.maxLine&&(d=!0),s.collapsed&&n!=i.line&&se(e,0),e=e,t=new ge(s,n==i.line?i.ch:null,n==a.line?a.ch:null),e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e),++n}),s.collapsed&&t.iter(i.line,a.line+1,function(e){Fe(t,e)&&se(e,0)}),s.clearOnEnter&&V(s,"beforeCursorEnter",function(){return s.clear()}),s.readOnly&&(is=!0,t.history.done.length||t.history.undone.length)&&t.clearHistory(),s.collapsed&&(s.id=++xs,s.atomic=!0),r){if(d&&(r.curOp.updateMaxLine=!0),s.collapsed)y(r,i.line,a.line+1);else if(s.className||s.title||s.startStyle||s.endStyle||s.css)for(l=i.line;l<=a.line;l++)Ei(r,l,"text");s.atomic&&Sa(r.doc),D(r,"markerAdded",r,s)}}return s}function Ja(e){return e.findMarks(k(e.first,0),e.clipPos(k(e.lastLine())),function(e){return e.parent})}function Ya(e){var a,t,i,o,s,n=this;if(Ka(n),!O(n,e)&&!_t(n.display,e)&&(v(e),E&&(ws=+new Date),a=oi(n,e,!0),t=e.dataTransfer.files,a)&&!n.isReadOnly())if(t&&t.length&&window.FileReader&&window.File)for(var r=t.length,d=Array(r),l=0,h=0;h<r;++h)!function(e,t){var i;n.options.allowDropFileTypes&&-1==b(n.options.allowDropFileTypes,e.type)||((i=new FileReader).onload=C(n,function(){var e=i.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),d[t]=e,++l==r&&(e={from:a=N(n.doc,a),to:a,text:n.doc.splitLines(d.join(n.doc.lineSeparator())),origin:"paste"},Ea(n.doc,e),Ca(n.doc,Xi(a,Zi(e))))}),i.readAsText(e))}(t[h],h);else if(n.state.draggingText&&-1<n.doc.sel.contains(a))n.state.draggingText(e),setTimeout(function(){return n.display.input.focus()},20);else try{if(i=e.dataTransfer.getData("Text")){if(n.state.draggingText&&!n.state.draggingText.copy&&(o=n.listSelections()),wa(n.doc,Xi(a,a)),o)for(s=0;s<o.length;++s)Va(n.doc,"",o[s].anchor,o[s].head,"drag");n.replaceSelection(i,"around","paste"),n.display.input.focus()}}catch(e){}}function Ka(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Xa(e){var t,i,a;if(document.getElementsByClassName)for(t=document.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++)(a=t[i].CodeMirror)&&e(a)}function Za(){var e;Ts||(V(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Xa(eo)},100))}),V(window,"blur",function(){return Xa(bi)}),Ts=!0)}function eo(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function to(e){var t,i,a,o,s,n,r=e.split(/-(?!$)/);for(e=r[r.length-1],s=0;s<r.length-1;s++)if(n=r[s],/^(cmd|meta|m)$/i.test(n))o=!0;else if(/^a(lt)?$/i.test(n))t=!0;else if(/^(c|ctrl|control)$/i.test(n))i=!0;else{if(!/^s(hift)?$/i.test(n))throw new Error("Unrecognized modifier name: "+n);a=!0}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),e=a?"Shift-"+e:e}function io(e){var t,i,a,o,s,n,r,d,l={};for(t in e)if(e.hasOwnProperty(t)){if(i=e[t],/^(name|fallthrough|(de|at)tach)$/.test(t))continue;if("..."==i){delete e[t];continue}for(a=J(t.split(" "),to),o=0;o<a.length;o++)if(n=s=void 0,s=o==a.length-1?(n=a.join(" "),i):(n=a.slice(0,o+1).join(" "),"..."),r=l[n]){if(r!=s)throw new Error("Inconsistent bindings for "+n)}else l[n]=s;delete e[t]}for(d in l)e[d]=l[d];return e}function ao(e,t,i,a){var o,s,n;if(!1===(o=(t=ro(t)).call?t.call(e,a):t[e]))return"nothing";if("..."===o)return"multi";if(null!=o&&i(o))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ao(e,t.fallthrough,i,a);for(s=0;s<t.fallthrough.length;s++)if(n=ao(e,t.fallthrough[s],i,a))return n}}function oo(e){e="string"==typeof e?e:Ss[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function so(e,t,i){var a=e;return t.altKey&&"Alt"!=a&&(e="Alt-"+e),(Go?t.metaKey:t.ctrlKey)&&"Ctrl"!=a&&(e="Ctrl-"+e),(Go?t.ctrlKey:t.metaKey)&&"Cmd"!=a&&(e="Cmd-"+e),e=!i&&t.shiftKey&&"Shift"!=a?"Shift-"+e:e}function no(e,t){var i;return!(Ks&&34==e.keyCode&&e.char||null==(i=Ss[e.keyCode])||e.altGraphKey)&&so(i,e,t)}function ro(e){return"string"==typeof e?Os[e]:e}function lo(t,e){for(var i,a,o=t.doc.sel.ranges,s=[],n=0;n<o.length;n++){for(i=e(o[n]);s.length&&x(i.from,A(s).to)<=0;)if(x((a=s.pop()).from,i.from)<0){i.from=a.from;break}s.push(i)}p(t,function(){for(var e=s.length-1;0<=e;e--)Va(t.doc,"",s[e].from,s[e].to,"+delete");xi(t)})}function ho(e,t,i){t=ee(e.text,t+i,i);return t<0||t>e.text.length?null:t}function po(e,t,i){e=ho(e,t.ch,i);return null==e?null:new k(t.line,e,i<0?"after":"before")}function co(e,t,i,a,o){var s,n,r,d;return e&&(e=Me(i,t.doc.direction))?(r=o<0==(1==(e=o<0?A(e):e[0]).level)?"after":"before",0<e.level||"rtl"==t.doc.direction?(s=Lt(t,i),d=o<0?i.text.length-1:0,n=Ut(t,s,d).top,d=te(function(e){return Ut(t,s,e).top==n},o<0==(1==e.level)?e.from:e.to-1,d),"before"==r&&(d=ho(i,d,1))):d=o<0?e.to:e.from,new k(a,d,r)):new k(a,o<0?i.text.length:0,o<0?"before":"after")}function uo(t,i,n,e){var a,o,s,r,d,l,h,p,c=Me(i,t.doc.direction);return!c||(n.ch>=i.text.length?(n.ch=i.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after"),r=Ee(c,n.ch,n.sticky),s=c[r],"ltr"==t.doc.direction&&s.level%2==0&&(0<e?s.to>n.ch:s.from<n.ch))?po(i,n,e):(d=function(e,t){return ho(i,e instanceof k?e.ch:e,t)},p=(h=function(e){return t.options.lineWrapping?(l=l||Lt(t,i),Yt(t,i,l,e)):{begin:0,end:i.text.length}})("before"==n.sticky?d(n,-1):n.ch),"rtl"!=t.doc.direction&&1!=s.level||(a=1==s.level==e<0,null==(o=d(n,a?1:-1)))||!(a?o<=s.to&&o<=p.end:o>=s.from&&o>=p.begin)?(r=(s=function(e,t,i){for(;0<=e&&e<c.length;e+=t){var a=c[e],o=0<t==(1!=a.level),s=o?i.begin:d(i.end,-1);if(a.from<=s&&s<a.to||(s=o?a.from:d(a.to,-1),i.begin<=s&&s<i.end))return a=s,o?new k(n.line,d(a,1),"before"):new k(n.line,a,"after")}})(r+e,e,p))||(null==(p=0<e?p.end:d(p.begin,-1))||0<e&&p==i.text.length||!(r=s(0<e?0:c.length-1,e,h(p)))?null:r):new k(n.line,o,a?"before":"after"))}function bo(e,t){var i=S(e.doc,t),a=Se(i);return co(!0,e,a,t=a!=i?I(a):t,1)}function go(e,t){var i=S(e.doc,t),a=function(e){for(var t;t=we(e);)e=t.find(1,!0).line;return e}(i);return co(!0,e,i,t=a!=i?I(a):t,-1)}function mo(e,t){var i=bo(e,t.line),a=S(e.doc,i.line),e=Me(a,e.doc.direction);return e&&0!=e[0].level?i:(e=Math.max(0,a.text.search(/\S/)),a=t.line==i.line&&t.ch<=e&&t.ch,k(i.line,a?0:e,i.sticky))}function fo(e,t,i){if("string"==typeof t&&!(t=Ls[t]))return!1;e.display.input.ensurePolled();var a=e.display.shift,o=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),o=t(e)!=dn}finally{e.display.shift=a,e.state.suppressEdits=!1}return o}function Do(e,t,i,a){var o=e.state.keySeq;if(o){if(oo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Us.set(50,function(){e.state.keySeq==o&&(e.state.keySeq=null,e.display.input.reset())}),yo(e,o+" "+t,i,a))return!0}return yo(e,t,i,a)}function yo(e,t,i,a){a=function(e,t,i){for(var a,o=0;o<e.state.keyMaps.length;o++)if(a=ao(t,e.state.keyMaps[o],i,e))return a;return e.options.extraKeys&&ao(t,e.options.extraKeys,i,e)||ao(t,e.options.keyMap,i,e)}(e,t,a);return"multi"==a&&(e.state.keySeq=t),"handled"==a&&D(e,"keyHandled",e,t,i),"handled"!=a&&"multi"!=a||(v(i),hi(e)),!!a}function Bo(t,e){var i=no(e,!0);return!!i&&(e.shiftKey&&!t.state.keySeq?Do(t,"Shift-"+i,e,function(e){return fo(t,e,!0)})||Do(t,i,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return fo(t,e)}):Do(t,i,e,function(e){return fo(t,e)}))}function Io(e){var t,i,a;function o(e){18!=e.keyCode&&e.altKey||(Jo(a,"CodeMirror-crosshair"),_(document,"keyup",o),_(document,"mouseover",o))}this.curOp.focus=q(),O(this,e)||(E&&M<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,this.display.shift=16==t||e.shiftKey,i=Bo(this,e),Ks&&(Es=i?t:null,i||88!=t||Dn||!(sn?e.metaKey:e.ctrlKey)||this.replaceSelection("",null,"cut")),18!=t)||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||(d(a=this.display.lineDiv,"CodeMirror-crosshair"),V(document,"keyup",o),V(document,"mouseover",o))}function xo(e){16==e.keyCode&&(this.doc.sel.shift=!1),O(this,e)}function _o(e){var t,i,a;_t(this.display,e)||O(this,e)||e.ctrlKey&&!e.altKey||sn&&e.metaKey||(i=e.keyCode,t=e.charCode,Ks&&i==Es?(Es=null,v(e)):Ks&&(!e.which||e.which<10)&&Bo(this,e)||"\b"==(i=String.fromCharCode(null==t?i:t))||Do(a=this,"'"+i+"'",e,function(e){return fo(a,e,!0)})||this.display.input.onKeyPress(e))}function vo(e){var t,i,a,o,s,n,r,d,l,h,p,c,u,b=this,g=b.display;O(b,e)||g.activeTouch&&g.input.supportsTouch()||(g.input.ensurePolled(),g.shift=e.shiftKey,_t(g,e)?P||(g.scroller.draggable=!1,setTimeout(function(){return g.scroller.draggable=!0},100)):To(b,e)||(t=oi(b,e),i=ze(e),u=t?(p=t,c=i,u=+new Date,Ps&&Ps.compare(u,p,c)?(As=Ps=null,"triple"):As&&As.compare(u,p,c)?(Ps=new Ms(u,p,c),As=null,"double"):(As=new Ms(u,p,c),Ps=null,"single")):"single",window.focus(),1==i&&b.state.selectingText&&b.state.selectingText(e),t&&(h=t,p="Click","double"==(c=u)?p="Double"+p:"triple"==c&&(p="Triple"+p),Do(d=b,so(p=(1==(l=i)?"Left":2==l?"Middle":"Right")+p,e),e,function(e){if(!(e="string"==typeof e?Ls[e]:e))return!1;var t=!1;try{d.isReadOnly()&&(d.state.suppressEdits=!0),t=e(d,h)!=dn}finally{d.state.suppressEdits=!1}return t})))||(1==i?t?(l=b,a=t,o=u,s=e,E?setTimeout(z(pi,l),0):l.curOp.focus=q(),n=function(e,t,i){var a,o=e.getOption("configureMouse"),o=o?o(e,t,i):{};return null==o.unit&&(a=nn?i.shiftKey&&i.metaKey:i.altKey,o.unit=a?"rectangle":"single"==t?"char":"double"==t?"word":"line"),null!=o.extend&&!e.doc.extend||(o.extend=e.doc.extend||i.shiftKey),null==o.addNew&&(o.addNew=sn?i.metaKey:i.ctrlKey),null==o.moveOnDrag&&(o.moveOnDrag=!(sn?i.altKey:i.ctrlKey)),o}(l,o,s),r=l.doc.sel,(l.options.dragDrop&&gn&&!l.isReadOnly()&&"single"==o&&-1<(o=r.contains(a))&&(x((o=r.ranges[o]).from(),a)<0||0<a.xRel)&&(0<x(o.to(),a)||a.xRel<0)?function(t,i,a,o){var s=t.display,n=!1,r=C(t,function(e){P&&(s.scroller.draggable=!1),t.state.draggingText=!1,_(document,"mouseup",r),_(document,"mousemove",d),_(s.scroller,"dragstart",l),_(s.scroller,"drop",r),n||(v(e),o.addNew||Ia(t.doc,a,null,null,o.extend),P||E&&9==M?setTimeout(function(){document.body.focus(),s.input.focus()},20):s.input.focus())}),d=function(e){n=n||10<=Math.abs(i.clientX-e.clientX)+Math.abs(i.clientY-e.clientY)},l=function(){return n=!0};P&&(s.scroller.draggable=!0),(t.state.draggingText=r).copy=!o.moveOnDrag,s.scroller.dragDrop&&s.scroller.dragDrop(),V(document,"mouseup",r),V(document,"mousemove",d),V(s.scroller,"dragstart",l),V(s.scroller,"drop",r),ci(t),setTimeout(function(){return s.input.focus()},20)}:function(c,e,u,b){function n(e){var t,i;if(0!=x(D,e))if(D=e,"rectangle"==b.unit){for(var a=[],o=c.options.tabSize,s=B(S(y,u.line).text,u.ch,o),n=B(S(y,e.line).text,e.ch,o),r=Math.min(s,n),d=Math.max(s,n),l=Math.min(u.line,e.line),h=Math.min(c.lastLine(),Math.max(u.line,e.line));l<=h;l++)i=G(t=S(y,l).text,r,o),r==d?a.push(new U(k(l,i),k(l,i))):t.length>i&&a.push(new U(k(l,i),k(l,G(t,d,o))));a.length||a.push(new U(u,u)),w(y,Ki(f.ranges.slice(0,m).concat(a),m),{origin:"*mouse",scroll:!1}),c.scrollIntoView(e)}else{var p,s=g,n=Co(c,e,b.unit),e=s.anchor,e=0<x(n.anchor,e)?(p=n.head,ce(s.from(),n.anchor)):(p=n.anchor,pe(s.to(),n.head));(s=f.ranges.slice(0))[m]=function(e,t){var i,a,o=t.anchor,s=t.head,n=S(e.doc,o.line);if(0==x(o,s)&&o.sticky==s.sticky||!(d=Me(n))||(a=Ee(d,o.ch,o.sticky),(r=d[a]).from!=o.ch&&r.to!=o.ch)||(0==(i=a+(r.from==o.ch==(1!=r.level)?0:1))||i==d.length))return t;a=s.line!=o.line?0<(s.line-o.line)*("ltr"==e.doc.direction?1:-1):(n=Ee(d,s.ch,s.sticky),e=n-a||(s.ch-o.ch)*(1==r.level?-1:1),n==i-1||n==i?e<0:0<e);var r=d[i+(a?-1:0)],n=a==(1==r.level),e=n?r.from:r.to,d=n?"after":"before";return o.ch==e&&o.sticky==d?t:new U(new k(o.line,e,d),s)}(c,new U(N(y,e),p)),w(y,Ki(s,m),hn)}}function t(e){c.state.selectingText=!1,d=1/0,v(e),l.input.focus(),_(document,"mousemove",a),_(document,"mouseup",o),y.history.lastSelOrigin=null}var g,m,f,i,D,r,d,a,o,l=c.display,y=c.doc;v(e),f=y.sel,i=f.ranges,b.addNew&&!b.extend?(m=y.sel.contains(u),g=-1<m?i[m]:new U(u,u)):(g=y.sel.primary(),m=y.sel.primIndex),"rectangle"==b.unit?(b.addNew||(g=new U(u,u)),u=oi(c,e,!0,!0),m=-1):(e=Co(c,u,b.unit),g=b.extend?Ba(g,e.anchor,e.head,b.extend):e),b.addNew?-1==m?(m=i.length,w(y,Ki(i.concat([g]),m),{scroll:!1,origin:"*mouse"})):1<i.length&&i[m].empty()&&"char"==b.unit&&!b.extend?(w(y,Ki(i.slice(0,m).concat(i.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),f=y.sel):_a(y,m,g,hn):(w(y,new L([g],m=0),hn),f=y.sel),D=u,r=l.wrapper.getBoundingClientRect(),d=0,a=C(c,function(e){(ze(e)?function e(t){var i,a,o=++d,s=oi(c,t,!0,"rectangle"==b.unit);s&&(0!=x(s,D)?(c.curOp.focus=q(),n(s),i=fi(l,y),(s.line>=i.to||s.line<i.from)&&setTimeout(C(c,function(){d==o&&e(t)}),150)):(a=t.clientY<r.top?-20:t.clientY>r.bottom?20:0)&&setTimeout(C(c,function(){d==o&&(l.scroller.scrollTop+=a,e(t))}),50))}:t)(e)}),o=C(c,t),c.state.selectingText=o,V(document,"mousemove",a),V(document,"mouseup",o)})(l,s,a,n)):qe(e)==g.scroller&&v(e):2==i?(t&&Ia(b.doc,t),setTimeout(function(){return g.input.focus()},20)):3==i&&(Qo?So(b,e):ci(b))))}function Co(e,t,i){return"char"==i?new U(t,t):"word"==i?e.findWordAt(t):"line"==i?new U(k(t.line,0),N(e.doc,k(t.line+1,0))):(i=i(e,t),new U(i.from,i.to))}function wo(e,t,i,a){var o,s,n,r,d;if(t.touches)o=t.touches[0].clientX,s=t.touches[0].clientY;else try{o=t.clientX,s=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;if(a&&v(t),s>(a=(n=e.display).lineDiv.getBoundingClientRect()).bottom||!Re(e,i))return We(t);for(s-=a.top-n.viewOffset,r=0;r<e.options.gutters.length;++r)if((d=n.gutters.childNodes[r])&&d.getBoundingClientRect().right>=o)return F(e,i,e,ne(e.doc,s),e.options.gutters[r],t),We(t)}function To(e,t){return wo(e,t,"gutterClick",!0)}function So(e,t){var i,a;_t(e.display,t)||(a=t,Re(i=e,"gutterContextMenu")&&wo(i,a,"gutterContextMenu",!1))||O(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function ko(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Pt(e)}function No(e){ji(e),y(e),Di(e)}function Fo(e,t,i){!t!=!(i&&i!=Sn)&&(i=e.display.dragFunctions,(t=t?V:_)(e.display.scroller,"dragstart",i.start),t(e.display.scroller,"dragenter",i.enter),t(e.display.scroller,"dragover",i.over),t(e.display.scroller,"dragleave",i.leave),t(e.display.scroller,"drop",i.drop))}function Oo(e){e.options.lineWrapping?(d(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Jo(e.display.wrapper,"CodeMirror-wrap"),Ue(e)),ai(e),y(e),Pt(e),setTimeout(function(){return Ni(e)},100)}function u(e,t){var i,a,o,s,n,r,d,l,h=this;if(!(this instanceof u))return new u(e,t);function p(){l.activeTouch&&(n=setTimeout(function(){return l.activeTouch=null},1e3),(r=l.activeTouch).end=+new Date)}function c(e,t){var i;return null==t.left||400<(i=t.left-e.left)*i+(i=t.top-e.top)*i}for(a in this.options=t=t?j(t):{},j(kn,t,!1),Gi(t),"string"==typeof(i=t.value)&&(i=new m(i,t.mode,null,t.lineSeparator,t.direction)),this.doc=i,d=new u.inputStyles[t.inputStyle](this),ji((e=this.display=new ie(e,i,d)).wrapper.CodeMirror=this),ko(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Oi(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Xo,keySeq:null,specialChars:null},t.autofocus&&!on&&e.input.focus(),E&&M<11&&setTimeout(function(){return h.display.input.reset(!0)},20),l=(s=this).display,V(l.scroller,"mousedown",C(s,vo)),V(l.scroller,"dblclick",E&&M<11?C(s,function(e){var t;O(s,e)||!(t=oi(s,e))||To(s,e)||_t(s.display,e)||(v(e),e=s.findWordAt(t),Ia(s.doc,e.anchor,e.head))}):function(e){return O(s,e)||v(e)}),Qo||V(l.scroller,"contextmenu",function(e){return So(s,e)}),r={end:0},V(l.scroller,"touchstart",function(e){var t;O(s,e)||function(e){if(1==e.touches.length)return(e=e.touches[0]).radiusX<=1&&e.radiusY<=1}(e)||To(s,e)||(l.input.ensurePolled(),clearTimeout(n),t=+new Date,l.activeTouch={start:t,moved:!1,prev:t-r.end<=300?r:null},1==e.touches.length&&(l.activeTouch.left=e.touches[0].pageX,l.activeTouch.top=e.touches[0].pageY))}),V(l.scroller,"touchmove",function(){l.activeTouch&&(l.activeTouch.moved=!0)}),V(l.scroller,"touchend",function(e){var t,i=l.activeTouch;i&&!_t(l,e)&&null!=i.left&&!i.moved&&new Date-i.start<300&&(t=s.coordsChar(l.activeTouch,"page"),i=!i.prev||c(i,i.prev)?new U(t,t):!i.prev.prev||c(i,i.prev.prev)?s.findWordAt(t):new U(k(t.line,0),N(s.doc,k(t.line+1,0))),s.setSelection(i.anchor,i.head),s.focus(),v(e)),p()}),V(l.scroller,"touchcancel",p),V(l.scroller,"scroll",function(){l.scroller.clientHeight&&(wi(s,l.scroller.scrollTop),Si(s,l.scroller.scrollLeft,!0),F(s,"scroll",s))}),V(l.scroller,"mousewheel",function(e){return Yi(s,e)}),V(l.scroller,"DOMMouseScroll",function(e){return Yi(s,e)}),V(l.wrapper,"scroll",function(){return l.wrapper.scrollTop=l.wrapper.scrollLeft=0}),l.dragFunctions={enter:function(e){O(s,e)||He(e)},over:function(e){var t,i;O(s,e)||((i=oi(t=s,i=e))&&(di(t,i,i=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=T("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),f(t.display.dragCursor,i)),He(e))},start:function(e){var t,i;t=s,e=e,E&&(!t.state.draggingText||+new Date-ws<100)?He(e):O(t,e)||_t(t.display,e)||(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",!e.dataTransfer.setDragImage)||Xs||((i=T("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Ks&&(i.width=i.height=1,t.display.wrapper.appendChild(i),i._top=i.offsetTop),e.dataTransfer.setDragImage(i,0,0),Ks&&i.parentNode.removeChild(i))},drop:C(s,Ya),leave:function(e){O(s,e)||Ka(s)}},d=l.input.getField(),V(d,"keyup",function(e){return xo.call(s,e)}),V(d,"keydown",C(s,Io)),V(d,"keypress",C(s,_o)),V(d,"focus",function(e){return ui(s,e)}),V(d,"blur",function(e){return bi(s,e)}),Za(),Li(this),this.curOp.forceUpdate=!0,da(this,i),t.autofocus&&!on||this.hasFocus()?setTimeout(z(ui,this),20):bi(this),Nn)Nn.hasOwnProperty(a)&&Nn[a](h,t[a],Sn);for(yi(this),t.finishInit&&t.finishInit(this),o=0;o<Rs.length;++o)Rs[o](h);Ui(this),P&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(e.lineDiv).textRendering&&(e.lineDiv.style.textRendering="auto")}function Lo(e,t,i,a){var o,s,n,r,d,l,h,p,c=e.doc,u=("smart"==(i=null==i?"add":i)&&(c.mode.indent?o=et(e,t).state:i="prev"),e.options.tabSize),b=S(c,t),g=B(b.text,null,u);if(b.stateAfter&&(b.stateAfter=null),s=b.text.match(/^\s*/)[0],a||/\S/.test(b.text)){if("smart"==i&&((n=c.mode.indent(o,b.text.slice(s.length),b.text))==dn||150<n)){if(!a)return;i="prev"}}else n=0,i="not";if("prev"==i?n=t>c.first?B(S(c,t-1).text,null,u):0:"add"==i?n=g+e.options.indentUnit:"subtract"==i?n=g-e.options.indentUnit:"number"==typeof i&&(n=g+i),n=Math.max(0,n),r="",d=0,e.options.indentWithTabs)for(l=Math.floor(n/u);l;--l)d+=u,r+="\t";if(d<n&&(r+=Q(n-d)),r!=s)return Va(c,r,k(t,0),k(t,s.length),"+input"),!(b.stateAfter=null);for(h=0;h<c.sel.ranges.length;h++)if((p=c.sel.ranges[h]).head.line==t&&p.head.ch<s.length){p=k(t,s.length),_a(c,h,new U(p,p));break}}function Uo(e){Vs=e}function Eo(e,t,i,a,o){var s,n,r,d=e.doc,l=(e.display.shift=!1,a=a||d.sel,e.state.pasteIncoming||"paste"==o),h=mn(t),p=null;if(l&&1<a.ranges.length)if(Vs&&Vs.text.join("\n")==t){if(a.ranges.length%Vs.text.length==0)for(p=[],s=0;s<Vs.text.length;s++)p.push(d.splitLines(Vs.text[s]))}else h.length==a.ranges.length&&e.options.pasteLinesPerSelection&&(p=J(h,function(e){return[e]}));for(r=a.ranges.length-1;0<=r;r--){var c=a.ranges[r],u=c.from(),b=c.to();c.empty()&&(i&&0<i?u=k(u.line,u.ch-i):e.state.overwrite&&!l?b=k(b.line,Math.min(S(d,b.line).text.length,b.ch+A(h).length)):Vs&&Vs.lineWise&&Vs.text.join("\n")==t&&(u=b=k(u.line,0))),n=e.curOp.updateInput,c={from:u,to:b,text:p?p[r%p.length]:h,origin:o||(l?"paste":e.state.cutIncoming?"cut":"+input")},Ea(e.doc,c),D(e,"inputRead",e,c)}t&&!l&&Ao(e,t),xi(e),e.curOp.updateInput=n,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Mo(e,t){var i=e.clipboardData&&e.clipboardData.getData("Text");return i&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||p(t,function(){return Eo(t,i,0,null,"paste")}),1)}function Ao(e,t){var i,a,o,s,n,r;if(e.options.electricChars&&e.options.smartIndent)for(a=(i=e.doc.sel).ranges.length-1;0<=a;a--)if(!(100<(o=i.ranges[a]).head.ch||a&&i.ranges[a-1].head.line==o.head.line)){if(n=!1,(s=e.getModeAt(o.head)).electricChars){for(r=0;r<s.electricChars.length;r++)if(-1<t.indexOf(s.electricChars.charAt(r))){n=Lo(e,o.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(S(e.doc,o.head.line).text.slice(0,o.head.ch))&&(n=Lo(e,o.head.line,"smart"));n&&D(e,"electricInput",e,o.head.line)}}function Po(e){for(var t,i=[],a=[],o=0;o<e.doc.sel.ranges.length;o++)t={anchor:k(t=e.doc.sel.ranges[o].head.line,0),head:k(t+1,0)},a.push(t),i.push(e.getRange(t.anchor,t.head));return{text:i,ranges:a}}function Ro(e,t){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck",!!t)}function Vo(){var e=T("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=T("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return P?e.style.width="1000px":e.setAttribute("wrap","off"),tn&&(e.style.border="1px solid black"),Ro(e),t}function $o(i,a,o,e,s){function t(e){var t=s?uo(i.cm,l,a,o):po(l,a,o);if(null==t){if(e||(e=a.line+o)<i.first||e>=i.first+i.size||(a=new k(e,a.ch,a.sticky),!(l=S(i,e))))return;a=co(s,i.cm,l,a.line,o)}else a=t;return 1}var n,r=a,d=o,l=S(i,a.line);if("char"==e)t();else if("column"==e)t(!0);else if("word"==e||"group"==e)for(var h=null,p="group"==e,c=i.cm&&i.cm.getHelper(a,"wordChars"),u=!0;!(o<0)||t(!u);u=!1){if(n=K(n=l.text.charAt(a.ch)||"\n",c)?"w":p&&"\n"==n?"n":!p||/\s/.test(n)?null:"p",p&&!u&&(n=n||"s"),h&&h!=n){o<0&&(o=1,t(),a.sticky="after");break}if(n&&(h=n),0<o&&!t(!u))break}return le(r,e=Fa(i,a,r,d,!0))&&(e.hitSide=!0),e}function Wo(e,t,i,a){var o,s,n,r=e.doc,d=t.left;for("page"==a?(s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),s=Math.max(s-.5*Xt(e.display),3),o=(0<i?t.bottom:t.top)+i*s):"line"==a&&(o=0<i?t.bottom+3:t.top-3);(n=Qt(e,d,o)).outside;){if(i<0?o<=0:o>=r.height){n.hitSide=!0;break}o+=5*i}return n}function Ho(e,t){var i,a,o=Ot(e,t.line);return!o||o.hidden?null:(i=Nt(o,o=S(e.doc,t.line),t.line),a="left",(o=Me(o,e.doc.direction))&&(a=Ee(o,t.ch)%2?"right":"left"),(e=Et(i.map,t.ch,a)).offset="right"==e.collapse?e.end:e.start,e)}function qo(e,t){return t&&(e.bad=!0),e}function zo(s,e,t,n,r){function d(){h&&(i+=p,h=!1)}function l(e){e&&(d(),i+=e)}for(var i="",h=!1,p=s.doc.lineSeparator();function e(t){var i,a,o;if(1==t.nodeType){if(null!=(i=t.getAttribute("cm-text")))l(i||t.textContent.replace(/\u200b/g,""));else if(i=t.getAttribute("cm-marker"))(i=s.findMarks(k(n,0),k(r+1,0),(o=+i,function(e){return e.id==o}))).length&&(i=i[0].find(0))&&l(ae(s.doc,i.from,i.to).join(p));else if("false"!=t.getAttribute("contenteditable")){for((i=/^(pre|div|p)$/i.test(t.nodeName))&&d(),a=0;a<t.childNodes.length;a++)e(t.childNodes[a]);i&&(h=!0)}}else 3==t.nodeType&&l(t.nodeValue)}(e),e!=t;)e=e.nextSibling;return i}function jo(e,t,i){var a,o;if(t==e.display.lineDiv){if(!(a=e.display.lineDiv.childNodes[i]))return qo(e.clipPos(k(e.display.viewTo-1)),!0);t=null,i=0}else for(a=t;;a=a.parentNode){if(!a||a==e.display.lineDiv)return null;if(a.parentNode&&a.parentNode==e.display.lineDiv)break}for(o=0;o<e.display.view.length;o++)if((s=e.display.view[o]).node==a){var l=s;var s=t;var n=i;function r(e,t,i){for(var a,o,s,n,r,d=-1;d<(c?c.length:0);d++)for(a=d<0?p.map:c[d],o=0;o<a.length;o+=3)if((s=a[o+2])==e||s==t)return n=I(d<0?l.line:l.rest[d]),r=a[o]+i,k(n,r=i<0||s!=e?a[o+(i?1:0)]:r)}var d,h,p,c,u,b,g,m,f,D=l.text.firstChild,y=!1;if(!s||!H(D,s))return qo(k(I(l.line),0),!0);if(s==D&&(y=!0,s=D.childNodes[n],n=0,!s))return qo(k(I(d=l.rest?A(l.rest):l.line),d.text.length),y);for(d=3==s.nodeType?s:null,h=s,d||1!=s.childNodes.length||3!=s.firstChild.nodeType||(d=s.firstChild,n=n&&d.nodeValue.length);h.parentNode!=D;)h=h.parentNode;if(p=l.measure,c=p.maps,u=r(d,h,n))return qo(u,y);for(b=h.nextSibling,g=d?d.nodeValue.length-n:0;b;b=b.nextSibling){if(u=r(b,b.firstChild,0))return qo(k(u.line,u.ch-g),y);g+=b.textContent.length}for(m=h.previousSibling,f=n;m;m=m.previousSibling){if(u=r(m,m.firstChild,-1))return qo(k(u.line,u.ch+f),y);f+=m.textContent.length}return}}var Go,Qo,Jo,Yo,Ko,Xo,Zo,es,ts,is,as,os,ss,ns,rs,ds,ls,hs,ps,cs,us,bs,gs,ms,fs,Ds,ys,Bs,g,L,U,Is,xs,_s,vs,Cs,m,ws,Ts,Ss,ks,Ns,Fs,Os,Ls,Us,Es,Ms,As,Ps,Rs,Vs,$s,Ws,Hs,qs,zs,js,Gs,i=navigator.userAgent,a=navigator.platform,Qs=/gecko\/\d/i.test(i),o=/MSIE \d/.test(i),Js=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(i),s=/Edge\/(\d+)/.exec(i),E=o||Js||s,M=E&&(o?document.documentMode||6:+(s||Js)[1]),P=!s&&/WebKit\//.test(i),o=P&&/Qt\/\d+\.\d+/.test(i),Ys=!s&&/Chrome\//.test(i),Ks=/Opera\//.test(i),Xs=/Apple Computer/.test(navigator.vendor),Zs=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(i),en=/PhantomJS/.test(i),tn=!s&&/AppleWebKit/.test(i)&&/Mobile\/\w+/.test(i),an=/Android/.test(i),on=tn||an||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(i),sn=tn||/Mac/.test(a),nn=/\bCrOS\b/.test(i),Js=/win/i.test(a),s=Ks&&i.match(/Version\/(\d*\.\d*)/),rn=((s=s&&Number(s[1]))&&15<=s&&(P=!(Ks=!1)),Go=sn&&(o||Ks&&(null==s||s<12.11)),Qo=Qs||E&&9<=M,Jo=function(e,t){var i,a=e.className,t=r(t).exec(a);t&&(i=a.slice(t.index+t[0].length),e.className=a.slice(0,t.index)+(i?t[1]+i:""))},Yo=document.createRange?function(e,t,i,a){var o=document.createRange();return o.setEnd(a||e,i),o.setStart(e,t),o}:function(e,t,i){var a=document.body.createTextRange();try{a.moveToElementText(e.parentNode)}catch(e){return a}return a.collapse(!0),a.moveEnd("character",i),a.moveStart("character",t),a},Ko=function(e){e.select()},tn?Ko=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:E&&(Ko=function(e){try{e.select()}catch(e){}}),(Xo=function(){this.id=null}).prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)},30),dn={toString:function(){return"CodeMirror.Pass"}},ln={scroll:!1},hn={origin:"*mouse"},pn={origin:"+move"};function cn(e,t,i){this.level=e,this.from=t,this.to=i}Zo=[""],es=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,as=is=!(ts=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/),os=null,Hs=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,qs=/[stwN]/,zs=/[LRr]/,js=/[Lb1n]/,Gs=/[1n]/;var R,un=function(e,t){var i,a,o,s,n,r,d,l,h,p,c,u,b,g,m,f,D,y,B,I,x,_,v,C,w,T,S,k,N,F,O,L="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!Hs.test(e))return!1;for(i=e.length,a=[],o=0;o<i;++o)a.push((O=e.charCodeAt(o))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(O):1424<=O&&O<=1524?"R":1536<=O&&O<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(O-1536):1774<=O&&O<=2220?"r":8192<=O&&O<=8203?"w":8204==O?"b":"L");for(s=0,n=L;s<i;++s)"m"==(r=a[s])?a[s]=n:n=r;for(d=0,l=L;d<i;++d)"1"==(h=a[d])&&"r"==l?a[d]="n":zs.test(h)&&"r"==(l=h)&&(a[d]="R");for(p=1,c=a[0];p<i-1;++p)"+"==(u=a[p])&&"1"==c&&"1"==a[p+1]?a[p]="1":","!=u||c!=a[p+1]||"1"!=c&&"n"!=c||(a[p]=c),c=u;for(b=0;b<i;++b)if(","==(g=a[b]))a[b]="N";else if("%"==g){for(m=void 0,m=b+1;m<i&&"%"==a[m];++m);for(f=b&&"!"==a[b-1]||m<i&&"1"==a[m]?"1":"N",D=b;D<m;++D)a[D]=f;b=m-1}for(y=0,B=L;y<i;++y)I=a[y],"L"==B&&"1"==I?a[y]="L":zs.test(I)&&(B=I);for(x=0;x<i;++x)if(qs.test(a[x])){for(_=void 0,_=x+1;_<i&&qs.test(a[_]);++_);for(var U="L"==(x?a[x-1]:L),M=U==("L"==(_<i?a[_]:L))?U?"L":"R":L,E=x;E<_;++E)a[E]=M;x=_-1}for(v=[],w=0;w<i;)if(js.test(a[w])){for(T=w,++w;w<i&&js.test(a[w]);++w);v.push(new cn(0,T,w))}else{for(S=w,k=v.length,++w;w<i&&"L"!=a[w];++w);for(N=S;N<w;)if(Gs.test(a[N])){for(S<N&&v.splice(k,0,new cn(1,S,N)),F=N,++N;N<w&&Gs.test(a[N]);++N);v.splice(k,0,new cn(2,F,N)),S=N}else++N;S<w&&v.splice(k,0,new cn(1,S,w))}return"ltr"==t&&(1==v[0].level&&(C=e.match(/^\s+/))&&(v[0].from=C[0].length,v.unshift(new cn(0,0,C[0].length))),1==A(v).level)&&(C=e.match(/\s+$/))&&(A(v).to-=C[0].length,v.push(new cn(0,i-C[0].length,i))),"rtl"==t?v.reverse():v},bn=[],V=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):(e=e._handlers||(e._handlers={}))[t]=(e[t]||bn).concat(i)},gn=!(E&&M<9)&&("draggable"in(a=T("div"))||"dragDrop"in a),mn=3!="\n\nb".split(/\n/).length?function(e){for(var t,i,a,o=0,s=[],n=e.length;o<=n;)-1==(t=e.indexOf("\n",o))&&(t=e.length),-1!=(a=(i=e.slice(o,"\r"==e.charAt(t-1)?t-1:t)).indexOf("\r"))?(s.push(i.slice(0,a)),o+=a+1):(s.push(i),o=t+1);return s}:function(e){return e.split(/\r\n?|\n/)},fn=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Dn="oncopy"in(i=T("div"))||(i.setAttribute("oncopy","return;"),"function"==typeof i.oncopy),yn=null,Bn={},In={},xn={};for((R=function(e,t,i){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i}).prototype.eol=function(){return this.pos>=this.string.length},R.prototype.sol=function(){return this.pos==this.lineStart},R.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},R.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},R.prototype.eat=function(e){var t=this.string.charAt(this.pos);return("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))?(++this.pos,t):void 0},R.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},R.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},R.prototype.skipToEnd=function(){this.pos=this.string.length},R.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},R.prototype.backUp=function(e){this.pos-=e},R.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},R.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},R.prototype.match=function(e,t,i){var a;return"string"!=typeof e?(a=this.string.slice(this.pos).match(e))&&0<a.index?null:(a&&!1!==t&&(this.pos+=a[0].length),a):(a=function(e){return i?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==a(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},R.prototype.current=function(){return this.string.slice(this.start,this.pos)},R.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},R.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},R.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)},rs=function(e,t){this.state=e,this.lookAhead=t},(ds=function(e,t,i,a){this.state=t,this.doc=e,this.line=i,this.maxLookAhead=a||0,this.baseTokens=null,this.baseTokenPos=1}).prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ds.prototype.baseToken=function(e){var t;if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;return{type:(t=this.baseTokens[this.baseTokenPos+1])&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ds.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},ds.fromSaved=function(e,t,i){return t instanceof rs?new ds(e,Je(e.mode,t.state),i,t.lookAhead):new ds(e,Je(e.mode,t),i)},ds.prototype.save=function(e){e=!1!==e?Je(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new rs(e,this.maxLookAhead):e},ls=function(e,t,i){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=i},(hs=function(e,t,i){this.text=e,Be(this,t),this.height=i?i(this):1}).prototype.lineNo=function(){return I(this)},Ve(hs),ps={},cs={},bs=us=null,gs={left:0,right:0,top:0,bottom:0},(o=function(e,t,i){this.cm=i;var a=this.vert=T("div",[T("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=T("div",[T("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(a),e(o),V(a,"scroll",function(){a.clientHeight&&t(a.scrollTop,"vertical")}),V(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,E&&M<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}).prototype.update=function(e){var t,i=e.scrollWidth>e.clientWidth+1,a=e.scrollHeight>e.clientHeight+1,o=e.nativeBarWidth;return a?(this.vert.style.display="block",this.vert.style.bottom=i?o+"px":"0",t=e.viewHeight-(i?o:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),i?(this.horiz.style.display="block",this.horiz.style.right=a?o+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(a?o:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==o&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:a?o:0,bottom:i?o:0}},o.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},o.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},o.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=sn&&!Zs?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Xo,this.disableVert=new Xo},o.prototype.enableZeroWidthBar=function(i,a,o){i.style.pointerEvents="auto",a.set(1e3,function e(){var t=i.getBoundingClientRect();("vert"==o?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=i?i.style.pointerEvents="none":a.set(1e3,e)})},o.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)},(s=function(){}).prototype.update=function(){return{bottom:0,right:0}},s.prototype.setScrollLeft=function(){},s.prototype.setScrollTop=function(){},s.prototype.clear=function(){},fs={native:o,null:s},Ds=0,(ys=function(e,t,i){var a=e.display;this.viewport=t,this.visible=fi(a,e.doc,t),this.editorIsHidden=!a.wrapper.offsetWidth,this.wrapperHeight=a.wrapper.clientHeight,this.wrapperWidth=a.wrapper.clientWidth,this.oldDisplayWidth=St(e),this.force=i,this.dims=ei(e),this.events=[]}).prototype.signal=function(e,t){Re(e,t)&&this.events.push(arguments)},ys.prototype.finish=function(){for(var e=0;e<this.events.length;e++)F.apply(null,this.events[e])},Bs=0,g=null,E?g=-.53:Qs?g=15:Ys?g=-.7:Xs&&(g=-1/3),(L=function(e,t){this.ranges=e,this.primIndex=t}).prototype.primary=function(){return this.ranges[this.primIndex]},L.prototype.equals=function(e){var t,i,a;if(e!=this){if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(t=0;t<this.ranges.length;t++)if(i=this.ranges[t],a=e.ranges[t],!le(i.anchor,a.anchor)||!le(i.head,a.head))return!1}return!0},L.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new U(he(this.ranges[t].anchor),he(this.ranges[t].head));return new L(e,this.primIndex)},L.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},L.prototype.contains=function(e,t){var i,a;for(t=t||e,i=0;i<this.ranges.length;i++)if(0<=x(t,(a=this.ranges[i]).from())&&x(e,a.to())<=0)return i;return-1},(U=function(e,t){this.anchor=e,this.head=t}).prototype.from=function(){return ce(this.anchor,this.head)},U.prototype.to=function(){return pe(this.anchor,this.head)},U.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},za.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i,a,o=e,s=e+t;o<s;++o)i=this.lines[o],this.height-=i.height,(a=i).parent=null,ye(a),D(i,"delete");this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){var a;for(this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e)),a=0;a<t.length;++a)t[a].parent=this},iterN:function(e,t,i){for(var a=e+t;e<a;++e)if(i(this.lines[e]))return!0}},ja.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var i,a,o,s,n,r;for(this.size-=t,i=0;i<this.children.length;++i)if(e<(o=(a=this.children[i]).chunkSize())){if(s=Math.min(t,o-e),n=a.height,a.removeInner(e,s),this.height-=n-a.height,o==s&&(this.children.splice(i--,1),a.parent=null),0==(t-=s))break;e=0}else e-=o;this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof za))&&(this.collapse(r=[]),this.children=[new za(r)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){var a,o,s,n,r,d;for(this.size+=t.length,this.height+=i,a=0;a<this.children.length;++a){if(e<=(s=(o=this.children[a]).chunkSize())){if(o.insertInner(e,t,i),o.lines&&50<o.lines.length){for(r=n=o.lines.length%25+25;r<o.lines.length;)d=new za(o.lines.slice(r,r+=25)),o.height-=d.height,this.children.splice(++a,0,d),d.parent=this;o.lines=o.lines.slice(0,n),this.maybeSpill()}break}e-=s}},maybeSpill:function(){var e,t,i;if(!(this.children.length<=10)){for(e=this;t=new ja(e.children.splice(e.children.length-5,5)),e.parent?(e.size-=t.size,e.height-=t.height,i=b(e.parent.children,e),e.parent.children.splice(i+1,0,t)):(((i=new ja(e.children)).parent=e).children=[i,t],e=i),t.parent=e.parent,10<e.children.length;);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var a,o,s,n=0;n<this.children.length;++n)if(e<(o=(a=this.children[n]).chunkSize())){if(s=Math.min(t,o-e),a.iterN(e,s,i))return!0;if(0==(t-=s))break;e=0}else e-=o}},(Is=function(e,t,i){if(i)for(var a in i)i.hasOwnProperty(a)&&(this[a]=i[a]);this.doc=e,this.node=t}).prototype.clear=function(){var e,t,i=this.doc.cm,a=this.line.widgets,o=this.line,s=I(o);if(null!=s&&a){for(e=0;e<a.length;++e)a[e]==this&&a.splice(e--,1);a.length||(o.widgets=null),t=xt(this),se(o,Math.max(0,o.height-t)),i&&(p(i,function(){Ga(i,o,-t),Ei(i,s,"widget")}),D(i,"lineWidgetCleared",i,this,s))}},Is.prototype.changed=function(){var e,t=this,i=this.height,a=this.doc.cm,o=this.line;this.height=null,(e=xt(this)-i)&&(se(o,o.height+e),a)&&p(a,function(){a.curOp.forceUpdate=!0,Ga(a,o,e),D(a,"lineWidgetChanged",a,t,I(o))})},Ve(Is),xs=0,(_s=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++xs}).prototype.clear=function(){var e,t,i,a,o,s,n,r,d,l,h;if(!this.explicitlyCleared){for((t=(e=this.doc.cm)&&!e.curOp)&&Li(e),Re(this,"clear")&&(i=this.find())&&D(this,"clear",i.from,i.to),o=a=null,s=0;s<this.lines.length;++s)r=me((n=this.lines[s]).markedSpans,this),e&&!this.collapsed?Ei(e,I(n),"text"):e&&(null!=r.to&&(o=I(n)),null!=r.from)&&(a=I(n)),n.markedSpans=function(e,t){for(var i,a=0;a<e.length;++a)e[a]!=t&&(i=i||[]).push(e[a]);return i}(n.markedSpans,r),null==r.from&&this.collapsed&&!Fe(this.doc,n)&&e&&se(n,Xt(e.display));if(e&&this.collapsed&&!e.options.lineWrapping)for(d=0;d<this.lines.length;++d)(h=Le(l=Se(this.lines[d])))>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=h,e.display.maxLineChanged=!0);null!=a&&e&&this.collapsed&&y(e,a,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e)&&Sa(e.doc),e&&D(e,"markerCleared",e,this,a,o),t&&Ui(e),this.parent&&this.parent.clear()}},_s.prototype.find=function(e,t){var i,a,o,s,n;for(null==e&&"bookmark"==this.type&&(e=1),o=0;o<this.lines.length;++o){if(null!=(n=me((s=this.lines[o]).markedSpans,this)).from&&(i=k(t?s:I(s),n.from),-1==e))return i;if(null!=n.to&&(a=k(t?s:I(s),n.to),1==e))return a}return i&&{from:i,to:a}},_s.prototype.changed=function(){var i=this,a=this.find(-1,!0),o=this,s=this.doc.cm;a&&s&&p(s,function(){var e=a.line,t=I(a.line),t=Ot(s,t);t&&(Mt(t),s.curOp.selectionChanged=s.curOp.forceUpdate=!0),s.curOp.updateMaxLine=!0,!Fe(o.doc,e)&&null!=o.height&&(t=o.height,o.height=null,t=xt(o)-t)&&se(e,e.height+t),D(s,"markerChanged",s,i)})},_s.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=b(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},_s.prototype.detachLine=function(e){this.lines.splice(b(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},Ve(_s),(vs=function(e,t){var i;for(this.markers=e,this.primary=t,i=0;i<e.length;++i)e[i].parent=this}).prototype.clear=function(){var e;if(!this.explicitlyCleared){for(this.explicitlyCleared=!0,e=0;e<this.markers.length;++e)this.markers[e].clear();D(this,"clear")}},vs.prototype.find=function(e,t){return this.primary.find(e,t)},Ve(vs),Cs=0,(m=function(e,t,i,a,o){if(!(this instanceof m))return new m(e,t,i,a,o);null==i&&(i=0),ja.call(this,[new za([new hs("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1;i=k(this.modeFrontier=this.highlightFrontier=i,0);this.sel=Xi(i),this.history=new ha(null),this.id=++Cs,this.modeOption=t,this.lineSep=a,this.direction="rtl"==o?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),na(this,{from:i,to:i,text:e}),w(this,Xi(i),ln)}).prototype=c(ja.prototype,{constructor:m,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,a=0;a<t.length;++a)i+=t[a].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=oe(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:t(function(e){var t=k(this.first,0),i=this.first+this.size-1;Ea(this,{from:t,to:k(i,S(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&_i(this.cm,0,0),w(this,Xi(t),ln)}),replaceRange:function(e,t,i,a){Va(this,e,t=N(this,t),i=i?N(this,i):t,a)},getRange:function(e,t,i){e=ae(this,N(this,e),N(this,t));return!1===i?e:e.join(i||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(re(this,e))return S(this,e)},getLineNumber:I,getLineHandleVisualStart:function(e){return Se(e="number"==typeof e?S(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return N(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:t(function(e,t,i){va(this,N(this,"number"==typeof e?k(e,t||0):e),null,i)}),setSelection:t(function(e,t,i){va(this,N(this,e),N(this,t||e),i)}),extendSelection:t(function(e,t,i){Ia(this,N(this,e),t&&N(this,t),i)}),extendSelections:t(function(e,t){xa(this,be(this,e),t)}),extendSelectionsBy:t(function(e,t){xa(this,be(this,J(this.sel.ranges,e)),t)}),setSelections:t(function(e,t,i){var a,o;if(e.length){for(a=[],o=0;o<e.length;o++)a[o]=new U(N(this,e[o].anchor),N(this,e[o].head));w(this,Ki(a,t=null==t?Math.min(e.length-1,this.sel.primIndex):t),i)}}),addSelection:t(function(e,t,i){var a=this.sel.ranges.slice(0);a.push(new U(N(this,e),N(this,t||e))),w(this,Ki(a,a.length-1),i)}),getSelection:function(e){for(var t,i,a=this.sel.ranges,o=0;o<a.length;o++)t=ae(this,a[o].from(),a[o].to()),i=i?i.concat(t):t;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t,i=[],a=this.sel.ranges,o=0;o<a.length;o++)t=ae(this,a[o].from(),a[o].to()),!1!==e&&(t=t.join(e||this.lineSeparator())),i[o]=t;return i},replaceSelection:function(e,t,i){for(var a=[],o=0;o<this.sel.ranges.length;o++)a[o]=e;this.replaceSelections(a,t,i||"+input")},replaceSelections:t(function(e,t,i){for(var a,o,s=[],n=this.sel,r=0;r<n.ranges.length;r++)a=n.ranges[r],s[r]={from:a.from(),to:a.to(),text:this.splitLines(e[r]),origin:i};for(t=t&&"end"!=t&&function(e,t,i){for(var a=[],o=l=k(e.first,0),s=0;s<t.length;s++){var n=t[s],r=ia(n.from,l,o),d=ia(Zi(n),l,o),l=n.to,o=d;"around"==i?(n=x((n=e.sel.ranges[s]).head,n.anchor)<0,a[s]=new U(n?d:r,n?r:d)):a[s]=new U(r,r)}return new L(a,e.sel.primIndex)}(this,s,t),o=s.length-1;0<=o;o--)Ea(this,s[o]);t?Ca(this,t):this.cm&&xi(this.cm)}),undo:t(function(){Aa(this,"undo")}),redo:t(function(){Aa(this,"redo")}),undoSelection:t(function(){Aa(this,"undo",!0)}),redoSelection:t(function(){Aa(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e,t=this.history,i=0,a=0,o=0;o<t.done.length;o++)t.done[o].ranges||++i;for(e=0;e<t.undone.length;e++)t.undone[e].ranges||++a;return{undo:i,redo:a}},clearHistory:function(){this.history=new ha(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:ya(this.history.done),undone:ya(this.history.undone)}},setHistory:function(e){var t=this.history=new ha(this.history.maxGeneration);t.done=ya(e.done.slice(0),null,!0),t.undone=ya(e.undone.slice(0),null,!0)},setGutterMarker:t(function(e,i,a){return qa(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[i]=a)&&X(t)&&(e.gutterMarkers=null),1})}),clearGutter:t(function(t){var i=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&qa(i,e,"gutter",function(){return e.gutterMarkers[t]=null,X(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!re(this,e)||!(e=S(this,t=e)))return null}else if(null==(t=I(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:t(function(e,i,a){return qa(this,e,"gutter"==i?"gutter":"class",function(e){var t="text"==i?"textClass":"background"==i?"bgClass":"gutter"==i?"gutterClass":"wrapClass";if(e[t]){if(r(a).test(e[t]))return;e[t]+=" "+a}else e[t]=a;return 1})}),removeLineClass:t(function(e,s,n){return qa(this,e,"gutter"==s?"gutter":"class",function(e){var t,i,a="text"==s?"textClass":"background"==s?"bgClass":"gutter"==s?"gutterClass":"wrapClass",o=e[a];if(o){if(null==n)e[a]=null;else{if(!(t=o.match(r(n))))return;i=t.index+t[0].length,e[a]=o.slice(0,t.index)+(t.index&&i!=o.length?" ":"")+o.slice(i)||null}return 1}})}),addLineWidget:t(function(e,t,i){return e=e,o=new Is(a=this,t,i),(s=a.cm)&&o.noHScroll&&(s.display.alignWidgets=!0),qa(a,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==o.insertAt?t.push(o):t.splice(Math.min(t.length-1,Math.max(0,o.insertAt)),0,o),o.line=e,s&&!Fe(a,e)&&(t=Oe(e)<a.scrollTop,se(e,e.height+xt(o)),t&&Ii(s,o.height),s.curOp.forceUpdate=!0),1}),D(s,"lineWidgetAdded",s,o,"number"==typeof e?e:I(e)),o;var a,o,s}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return Qa(this,N(this,e),N(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return Qa(this,e=N(this,e),e,t,"bookmark")},findMarksAt:function(e){var t,i,a,o=[];if(t=S(this,(e=N(this,e)).line).markedSpans)for(i=0;i<t.length;++i)(null==(a=t[i]).from||a.from<=e.ch)&&(null==a.to||a.to>=e.ch)&&o.push(a.marker.parent||a.marker);return o},findMarks:function(o,s,n){o=N(this,o),s=N(this,s);var r=[],d=o.line;return this.iter(o.line,s.line+1,function(e){var t,i,a=e.markedSpans;if(a)for(t=0;t<a.length;t++)null!=(i=a[t]).to&&d==o.line&&o.ch>=i.to||null==i.from&&d!=o.line||null!=i.from&&d==s.line&&i.from>=s.ch||n&&!n(i.marker)||r.push(i.marker.parent||i.marker);++d}),r},getAllMarks:function(){var a=[];return this.iter(function(e){var t,i=e.markedSpans;if(i)for(t=0;t<i.length;++t)null!=i[t].from&&a.push(i[t].marker)}),a},posFromIndex:function(t){var i,a=this.first,o=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+o;if(t<e)return i=t,!0;t-=e,++a}),N(this,k(a,i))},indexFromPos:function(e){var t,i;return e=N(this,e),t=e.ch,e.line<this.first||e.ch<0?0:(i=this.lineSeparator().length,this.iter(this.first,e.line,function(e){t+=e.text.length+i}),t)},copy:function(e){var t=new m(oe(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){t=this.first,i=this.first+this.size,null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to),i=new m(oe(this,t,i),e.mode||this.modeOption,t,this.lineSep,this.direction),e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}];for(var t,i,a=i,o=Ja(this),s=0;s<o.length;s++){var n=o[s],r=n.find(),d=a.clipPos(r.from),r=a.clipPos(r.to);x(d,r)&&(d=Qa(a,d,r,n.primary,n.primary.type),n.markers.push(d),d.parent=n)}return i},unlinkDoc:function(e){var t,i;if(e instanceof u&&(e=e.doc),this.linked)for(t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),a=s=void 0;for(var s=Ja(this),a=0;a<s.length;a++)!function(e){var t,i,a=s[e],o=[a.primary.doc];for(ra(a.primary.doc,function(e){return o.push(e)}),t=0;t<a.markers.length;t++)i=a.markers[t],-1==b(o,i.doc)&&(i.parent=null,a.markers.splice(t--,1))}(a);break}e.history==this.history&&(i=[e.id],ra(e,function(e){return i.push(e.id)},!0),e.history=new ha(null),e.history.done=ya(this.history.done,i),e.history.undone=ya(this.history.undone,i))},iterLinkedDocs:function(e){ra(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):mn(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:t(function(e){var t;(e="rtl"!=e?"ltr":e)!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm)&&p(t=this.cm,function(){la(t),y(t)})})}),m.prototype.eachLine=m.prototype.iter,Ts=!1,Ss={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ks=ws=0;ks<10;ks++)Ss[ks+48]=Ss[ks+96]=String(ks);for(Ns=65;Ns<=90;Ns++)Ss[Ns]=String.fromCharCode(Ns);for(Fs=1;Fs<=12;Fs++)Ss[Fs+111]=Ss[Fs+63235]="F"+Fs;(Os={basic:{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},pcDefault:{"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},emacsy:{"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},macDefault:{"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]}}).default=sn?Os.macDefault:Os.pcDefault,Ls={selectAll:La,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ln)},killLine:function(i){return lo(i,function(e){var t;return e.empty()?(t=S(i.doc,e.head.line).text.length,e.head.ch==t&&e.head.line<i.lastLine()?{from:e.head,to:k(e.head.line+1,0)}:{from:e.head,to:k(e.head.line,t)}):{from:e.from(),to:e.to()}})},deleteLine:function(t){return lo(t,function(e){return{from:k(e.from().line,0),to:N(t.doc,k(e.to().line+1,0))}})},delLineLeft:function(e){return lo(e,function(e){return{from:k(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(i){return lo(i,function(e){var t=i.charCoords(e.head,"div").top+5;return{from:i.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(i){return lo(i,function(e){var t=i.charCoords(e.head,"div").top+5,t=i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(k(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(k(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return bo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return mo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return go(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},pn)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},pn)},goLineLeftSmart:function(i){return i.extendSelectionsBy(function(e){var t=i.cursorCoords(e.head,"div").top+5,t=i.coordsChar({left:0,top:t},"div");return t.ch<i.getLine(t.line).search(/\S/)?mo(i,e.head):t},pn)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t,i=[],a=e.listSelections(),o=e.options.tabSize,s=0;s<a.length;s++)t=a[s].from(),t=B(e.getLine(t.line),t.ch,o),i.push(Q(o-t%o));e.replaceSelections(i)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(n){return p(n,function(){for(var e,t,i,a=n.listSelections(),o=[],s=0;s<a.length;s++)a[s].empty()&&(e=a[s].head,(t=S(n.doc,e.line).text)&&(0<(e=e.ch==t.length?new k(e.line,e.ch-1):e).ch?(e=new k(e.line,e.ch+1),n.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),k(e.line,e.ch-2),e,"+transpose")):e.line>n.doc.first&&(i=S(n.doc,e.line-1).text)&&(e=new k(e.line,1),n.replaceRange(t.charAt(0)+n.doc.lineSeparator()+i.charAt(i.length-1),k(e.line-1,i.length-1),e,"+transpose"))),o.push(new U(e,e)));n.setSelections(o)})},newlineAndIndent:function(a){return p(a,function(){for(var e,t=a.listSelections(),i=t.length-1;0<=i;i--)a.replaceRange(a.doc.lineSeparator(),t[i].anchor,t[i].head,"+input");for(t=a.listSelections(),e=0;e<t.length;e++)a.indentLine(t[e].from().line,null,!0);xi(a)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}},Us=new Xo,Es=null,(Ms=function(e,t,i){this.time=e,this.pos=t,this.button=i}).prototype.compare=function(e,t,i){return this.time+400>e&&0==x(t,this.pos)&&i==this.button};var _n,vn,Cn,wn,Tn,Sn={toString:function(){return"CodeMirror.Init"}},kn={},Nn={};function n(e,t,a,i){_n.defaults[e]=t,a&&(vn[e]=i?function(e,t,i){i!=Sn&&a(e,t,i)}:a)}for(Ws in u.defaults=kn,u.optionHandlers=Nn,Rs=[],u.defineInitHook=function(e){return Rs.push(e)},Vs=null,(a=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Xo,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}).prototype.init=function(e){function t(e){var t,i,a,o;if(!O(n,e)){if(n.somethingSelected())Uo({lineWise:!1,text:n.getSelections()}),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;Uo({lineWise:!0,text:(t=Po(n)).text}),"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,ln),n.replaceSelection("",null,"cut")})}e.clipboardData&&(e.clipboardData.clearData(),a=Vs.text.join("\n"),e.clipboardData.setData("Text",a),e.clipboardData.getData("Text")==a)?e.preventDefault():(a=(i=Vo()).firstChild,n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),a.value=Vs.text.join("\n"),o=document.activeElement,Ko(a),setTimeout(function(){n.display.lineSpace.removeChild(i),o.focus(),o==r&&s.showPrimarySelection()},50))}}var i=this,s=this,n=s.cm,r=s.div=e.lineDiv;Ro(r,n.options.spellcheck),V(r,"paste",function(e){O(n,e)||Mo(e,n)||M<=11&&setTimeout(C(n,function(){return i.updateFromDOM()}),20)}),V(r,"compositionstart",function(e){i.composing={data:e.data,done:!1}}),V(r,"compositionupdate",function(e){i.composing||(i.composing={data:e.data,done:!1})}),V(r,"compositionend",function(e){i.composing&&(e.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)}),V(r,"touchstart",function(){return s.forceCompositionEnd()}),V(r,"input",function(){i.composing||i.readFromDOMSoon()}),V(r,"copy",t),V(r,"cut",t)},a.prototype.prepareSelection=function(){var e=ri(this.cm,!1);return e.focus=this.cm.state.focused,e},a.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},a.prototype.showPrimarySelection=function(){var e,t=window.getSelection(),i=this.cm,a=i.doc.sel.primary(),o=a.from(),a=a.to();if(i.display.viewTo==i.display.viewFrom||o.line>=i.display.viewTo||a.line<i.display.viewFrom)t.removeAllRanges();else if(s=jo(i,t.anchorNode,t.anchorOffset),n=jo(i,t.focusNode,t.focusOffset),!s||s.bad||!n||n.bad||0!=x(ce(s,n),o)||0!=x(pe(s,n),a)){var s=i.display.view,n=o.line>=i.display.viewFrom&&Ho(i,o)||{node:s[0].measure.map[2],offset:0},o=a.line<i.display.viewTo&&Ho(i,a);if(o||(o={node:(s=(a=s[s.length-1].measure).maps?a.maps[a.maps.length-1]:a.map)[s.length-1],offset:s[s.length-2]-s[s.length-3]}),n&&o){a=t.rangeCount&&t.getRangeAt(0);try{e=Yo(n.node,n.offset,o.offset,o.node)}catch(e){}e&&(!Qs&&i.state.focused&&(t.collapse(n.node,n.offset),e.collapsed)||(t.removeAllRanges(),t.addRange(e)),a&&null==t.anchorNode?t.addRange(a):Qs&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}},a.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},a.prototype.showMultipleSelections=function(e){f(this.cm.display.cursorDiv,e.cursors),f(this.cm.display.selectionDiv,e.selection)},a.prototype.rememberSelection=function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},a.prototype.selectionInEditor=function(){var e=window.getSelection();return!!e.rangeCount&&(e=e.getRangeAt(0).commonAncestorContainer,H(this.div,e))},a.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},a.prototype.blur=function(){this.div.blur()},a.prototype.getField=function(){return this.div},a.prototype.supportsTouch=function(){return!0},a.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():p(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},a.prototype.selectionChanged=function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},a.prototype.pollSelection=function(){var e,t,i,a;null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()&&(e=window.getSelection(),t=this.cm,an&&Ys&&this.cm.options.gutters.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return 1}(e.anchorNode)?(this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus()):this.composing||(this.rememberSelection(),i=jo(t,e.anchorNode,e.anchorOffset),a=jo(t,e.focusNode,e.focusOffset),i&&a&&p(t,function(){w(t.doc,Xi(i,a),ln),(i.bad||a.bad)&&(t.curOp.selectionChanged=!0)})))},a.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,i,a,o,s,n=this.cm,r=n.display,d=n.doc.sel.primary(),l=d.from(),d=d.to();if(0==l.ch&&l.line>n.firstLine()&&(l=k(l.line-1,S(n.doc,l.line-1).length)),d.ch==S(n.doc,d.line).text.length&&d.line<n.lastLine()&&(d=k(d.line+1,0)),l.line<r.viewFrom||d.line>r.viewTo-1||(t=l.line==r.viewFrom||0==(t=si(n,l.line))?(e=I(r.view[0].line),r.view[0].node):(e=I(r.view[t].line),r.view[t-1].node.nextSibling),a=(d=si(n,d.line))==r.view.length-1?(i=r.viewTo-1,r.lineDiv.lastChild):(i=I(r.view[d+1].line)-1,r.view[d+1].node.previousSibling),!t))return!1;for(o=n.doc.splitLines(zo(n,t,a,e,i)),s=ae(n.doc,k(e,0),k(i,S(n.doc,i).text.length));1<o.length&&1<s.length;)if(A(o)==A(s))o.pop(),s.pop(),i--;else{if(o[0]!=s[0])break;o.shift(),s.shift(),e++}for(var h=0,p=0,c=o[0],u=s[0],b=Math.min(c.length,u.length);h<b&&c.charCodeAt(h)==u.charCodeAt(h);)++h;for(var g=A(o),m=A(s),f=Math.min(g.length-(1==o.length?h:0),m.length-(1==s.length?h:0));p<f&&g.charCodeAt(g.length-p-1)==m.charCodeAt(m.length-p-1);)++p;if(1==o.length&&1==s.length&&e==l.line)for(;h&&h>l.ch&&g.charCodeAt(g.length-p-1)==m.charCodeAt(m.length-p-1);)h--,p++;return o[o.length-1]=g.slice(0,g.length-p).replace(/^\u200b+/,""),o[0]=o[0].slice(h).replace(/\u200b+$/,""),r=k(e,h),d=k(i,s.length?A(s).length-p:0),1<o.length||o[0]||x(r,d)?(Va(n.doc,o,r,d,"+input"),!0):void 0},a.prototype.ensurePolled=function(){this.forceCompositionEnd()},a.prototype.reset=function(){this.forceCompositionEnd()},a.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},a.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},a.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||p(this.cm,function(){return y(e.cm)})},a.prototype.setUneditable=function(e){e.contentEditable="false"},a.prototype.onKeyPress=function(e){0!=e.charCode&&(e.preventDefault(),this.cm.isReadOnly()||C(this.cm,Eo)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},a.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},a.prototype.onContextMenu=function(){},a.prototype.resetPosition=function(){},a.prototype.needsContentAttribute=!0,(i=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Xo,this.hasSelection=!1,this.composing=null}).prototype.init=function(t){function e(e){if(!O(o,e)){if(o.somethingSelected())Uo({lineWise:!1,text:o.getSelections()});else{if(!o.options.lineWiseCopyCut)return;var t=Po(o);Uo({lineWise:!0,text:t.text}),"cut"==e.type?o.setSelections(t.ranges,null,ln):(a.prevInput="",n.value=t.text.join("\n"),Ko(n))}"cut"==e.type&&(o.state.cutIncoming=!0)}}var i=this,a=this,o=this.cm,s=this.wrapper=Vo(),n=this.textarea=s.firstChild;t.wrapper.insertBefore(s,t.wrapper.firstChild),tn&&(n.style.width="0px"),V(n,"input",function(){E&&9<=M&&i.hasSelection&&(i.hasSelection=null),a.poll()}),V(n,"paste",function(e){O(o,e)||Mo(e,o)||(o.state.pasteIncoming=!0,a.fastPoll())}),V(n,"cut",e),V(n,"copy",e),V(t.scroller,"paste",function(e){_t(t,e)||O(o,e)||(o.state.pasteIncoming=!0,a.focus())}),V(t.lineSpace,"selectstart",function(e){_t(t,e)||v(e)}),V(n,"compositionstart",function(){var e=o.getCursor("from");a.composing&&a.composing.range.clear(),a.composing={start:e,range:o.markText(e,o.getCursor("to"),{className:"CodeMirror-composing"})}}),V(n,"compositionend",function(){a.composing&&(a.poll(),a.composing.range.clear(),a.composing=null)})},i.prototype.prepareSelection=function(){var e,t=this.cm,i=t.display,a=t.doc,o=ri(t);return t.options.moveInputWithCursor&&(t=zt(t,a.sel.primary().head,"div"),a=i.wrapper.getBoundingClientRect(),e=i.lineDiv.getBoundingClientRect(),o.teTop=Math.max(0,Math.min(i.wrapper.clientHeight-10,t.top+e.top-a.top)),o.teLeft=Math.max(0,Math.min(i.wrapper.clientWidth-10,t.left+e.left-a.left))),o},i.prototype.showSelection=function(e){var t=this.cm.display;f(t.cursorDiv,e.cursors),f(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},i.prototype.reset=function(e){var t,i;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",i=t.getSelection(),this.textarea.value=i,t.state.focused&&Ko(this.textarea),E&&9<=M&&(this.hasSelection=i)):e||(this.prevInput=this.textarea.value="",E&&9<=M&&(this.hasSelection=null)))},i.prototype.getField=function(){return this.textarea},i.prototype.supportsTouch=function(){return!1},i.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!on||q()!=this.textarea))try{this.textarea.focus()}catch(e){}},i.prototype.blur=function(){this.textarea.blur()},i.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},i.prototype.receivedFocus=function(){this.slowPoll()},i.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},i.prototype.fastPoll=function(){var t=!1,i=this;i.pollingFast=!0,i.polling.set(20,function e(){i.poll()||t?(i.pollingFast=!1,i.slowPoll()):(t=!0,i.polling.set(60,e))})},i.prototype.poll=function(){var e,t,i,a,o=this,s=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!s.state.focused||fn(n)&&!r&&!this.composing||s.isReadOnly()||s.options.disableInput||s.state.keySeq||(e=n.value)==r&&!s.somethingSelected())return!1;if(E&&9<=M&&this.hasSelection===e||sn&&/[\uf700-\uf7ff]/.test(e))return s.display.input.reset(),!1;if(s.doc.sel==s.display.selForContextMenu&&(8203==(t=e.charCodeAt(0))&&(r=r||"​"),8666==t))return this.reset(),this.cm.execCommand("undo");for(i=0,a=Math.min(r.length,e.length);i<a&&r.charCodeAt(i)==e.charCodeAt(i);)++i;return p(s,function(){Eo(s,e.slice(i),r.length-i,null,o.composing?"*compose":null),1e3<e.length||-1<e.indexOf("\n")?n.value=o.prevInput="":o.prevInput=e,o.composing&&(o.composing.range.clear(),o.composing.range=s.markText(o.composing.start,s.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},i.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},i.prototype.onKeyPress=function(){E&&9<=M&&(this.hasSelection=null),this.fastPoll()},i.prototype.onContextMenu=function(e){function i(){var e,t;null!=h.selectionStart&&(t="​"+((e=d.somethingSelected())?h.value:""),h.value="⇚",h.value=t,r.prevInput=e?"":"​",h.selectionStart=1,h.selectionEnd=t.length,l.selForContextMenu=d.doc.sel)}function t(){var e,t;r.contextMenuPending=!1,r.wrapper.style.cssText=o,h.style.cssText=a,E&&M<9&&l.scrollbars.setScrollTop(l.scroller.scrollTop=c),null!=h.selectionStart&&((!E||M<9)&&i(),e=0,t=function(){l.selForContextMenu==d.doc.sel&&0==h.selectionStart&&0<h.selectionEnd&&"​"==r.prevInput?C(d,La)(d):e++<10?l.detectingSelectAll=setTimeout(t,500):(l.selForContextMenu=null,l.input.reset())},l.detectingSelectAll=setTimeout(t,200))}var a,o,s,n,r=this,d=r.cm,l=d.display,h=r.textarea,p=oi(d,e),c=l.scroller.scrollTop;p&&!Ks&&(d.options.resetSelectionOnContextMenu&&-1==d.doc.sel.contains(p)&&C(d,w)(d.doc,Xi(p),ln),a=h.style.cssText,o=r.wrapper.style.cssText,r.wrapper.style.cssText="position: absolute",p=r.wrapper.getBoundingClientRect(),h.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+"px;\n      z-index: 1000; background: "+(E?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",P&&(s=window.scrollY),l.input.focus(),P&&window.scrollTo(null,s),l.input.reset(),d.somethingSelected()||(h.value=r.prevInput=" "),r.contextMenuPending=!0,l.selForContextMenu=d.doc.sel,clearTimeout(l.detectingSelectAll),E&&9<=M&&i(),Qo?(He(e),n=function(){_(window,"mouseup",n),setTimeout(t,20)},V(window,"mouseup",n)):setTimeout(t,50))},i.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},i.prototype.setUneditable=function(){},i.prototype.needsContentAttribute=!1,vn=(_n=u).optionHandlers,_n.defineOption=n,_n.Init=Sn,n("value","",function(e,t){return e.setValue(t)},!0),n("mode",null,function(e,t){e.doc.modeOption=t,aa(e)},!0),n("indentUnit",2,aa,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,function(e){oa(e),Pt(e),y(e)},!0),n("lineSeparator",null,function(e,a){var o,s,t;if(e.doc.lineSep=a)for(o=[],s=e.doc.first,e.doc.iter(function(e){for(var t,i=0;-1!=(t=e.text.indexOf(a,i));)i=t+a.length,o.push(k(s,t));s++}),t=o.length-1;0<=t;t--)Va(e.doc,a,o[t],k(o[t].line,o[t].ch+a.length))}),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,i){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),i!=Sn&&e.refresh()}),n("specialCharPlaceholder",lt,function(e){return e.refresh()},!0),n("electricChars",!0),n("inputStyle",on?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),n("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),n("rtlMoveVisually",!Js),n("wholeLineUpdateBefore",!0),n("theme","default",function(e){ko(e),No(e)},!0),n("keyMap","default",function(e,t,i){t=ro(t),i=i!=Sn&&ro(i);i&&i.detach&&i.detach(e,t),t.attach&&t.attach(e,i||null)}),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,Oo,!0),n("gutters",[],function(e){Gi(e.options),No(e)},!0),n("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?ti(e.display)+"px":"0",e.refresh()},!0),n("coverGutterNextToScrollbar",!1,function(e){return Ni(e)},!0),n("scrollbarStyle","native",function(e){Oi(e),Ni(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),n("lineNumbers",!1,function(e){Gi(e.options),No(e)},!0),n("firstLineNumber",1,No,!0),n("lineNumberFormatter",function(e){return e},No,!0),n("showCursorWhenSelecting",!1,ni,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("readOnly",!1,function(e,t){"nocursor"==t&&(bi(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),n("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),n("dragDrop",!0,Fo),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,ni,!0),n("singleCursorHeightPerLine",!0,ni,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,oa,!0),n("addModeClass",!1,oa,!0),n("pollInterval",100),n("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),n("historyEventDelay",1250),n("viewportMargin",10,function(e){return e.refresh()},!0),n("maxHighlightLength",1e4,oa,!0),n("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),n("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),n("autofocus",null),n("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),wn=(Cn=u).optionHandlers,Tn=Cn.helpers={},Cn.prototype={constructor:Cn,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,a=i[e];i[e]==t&&"mode"!=e||(i[e]=t,wn.hasOwnProperty(e)&&C(this,wn[e])(this,t,a),F(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](ro(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:e(function(e,t){var i=e.token?e:Cn.getMode(this.options,e);if(i.startState)throw new Error("Overlays may not be stateful.");for(var a=this.state.overlays,i={mode:i,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},o=function(e){return e.priority},s=0,n=o(i);s<a.length&&o(a[s])<=n;)s++;a.splice(s,0,i),this.state.modeGen++,y(this)}),removeOverlay:e(function(e){for(var t,i=this.state.overlays,a=0;a<i.length;++a)if((t=i[a].modeSpec)==e||"string"==typeof e&&t.name==e)return i.splice(a,1),this.state.modeGen++,void y(this)}),indentLine:e(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),re(this.doc,e)&&Lo(this,e,t,i)}),indentSelection:e(function(e){for(var t=this.doc.sel.ranges,i=-1,a=0;a<t.length;a++)if((s=t[a]).empty())s.head.line>i&&(Lo(this,s.head.line,e,!0),i=s.head.line,a==this.doc.sel.primIndex)&&xi(this);else{for(var o=s.from(),s=s.to(),n=Math.max(i,o.line),i=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1,r=n;r<i;++r)Lo(this,r,e);s=this.doc.sel.ranges,0==o.ch&&t.length==s.length&&0<s[a].from().ch&&_a(this.doc,a,new U(o,s[a].to()),ln)}}),getTokenAt:function(e,t){return ot(this,e,t)},getLineTokens:function(e,t){return ot(this,k(e),t,!0)},getTokenTypeAt:function(e){e=N(this.doc,e);var t,i,a=Ze(this,S(this.doc,e.line)),o=0,s=(a.length-1)/2,n=e.ch;if(0==n)i=a[2];else for(;;)if(((t=o+s>>1)?a[2*t-1]:0)>=n)s=t;else{if(!(a[2*t+1]<n)){i=a[2*t+2];break}o=1+t}return(e=i?i.indexOf("overlay "):-1)<0?i:0==e?null:i.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Cn.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i,a,o,s,n,r,d=[];if(Tn.hasOwnProperty(t)){if(i=Tn[t],"string"==typeof(a=this.getModeAt(e))[t])i[a[t]]&&d.push(i[a[t]]);else if(a[t])for(o=0;o<a[t].length;o++)(s=i[a[t][o]])&&d.push(s);else a.helperType&&i[a.helperType]?d.push(i[a.helperType]):i[a.name]&&d.push(i[a.name]);for(n=0;n<i._global.length;n++)(r=i._global[n]).pred(a,this)&&-1==b(d,r.val)&&d.push(r.val)}return d},getStateAfter:function(e,t){var i=this.doc;return et(this,(e=ue(i,null==e?i.first+i.size-1:e))+1,t).state},cursorCoords:function(e,t){var i=this.doc.sel.primary();return zt(this,null==e?i.head:"object"==typeof e?N(this.doc,e):e?i.from():i.to(),t||"page")},charCoords:function(e,t){return qt(this,N(this.doc,e),t||"page")},coordsChar:function(e,t){return Qt(this,(e=Ht(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Ht(this,{top:e,left:0},t||"page").top,ne(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,i){var a=!1,o="number"==typeof e?(o=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:o<e&&(e=o,a=!0),S(this.doc,e)):e;return Wt(this,o,{top:0,left:0},t||"page",i||a).top+(a?this.doc.height-Oe(o):0)},defaultTextHeight:function(){return Xt(this.display)},defaultCharWidth:function(){return Zt(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,a,o){var s,n,r=this.display,d=(e=zt(this,N(this.doc,e))).bottom,l=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),r.sizer.appendChild(t),"over"==a?d=e.top:("above"==a||"near"==a)&&(n=Math.max(r.wrapper.clientHeight,this.doc.height),s=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth),("above"==a||e.bottom+t.offsetHeight>n)&&e.top>t.offsetHeight?d=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=n&&(d=e.bottom),l+t.offsetWidth>s)&&(l=s-t.offsetWidth),t.style.top=d+"px",t.style.left=t.style.right="","right"==o?(l=r.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==o?l=0:"middle"==o&&(l=(r.sizer.clientWidth-t.offsetWidth)/2),t.style.left=l+"px"),i&&(a=this,n={left:l,top:d,right:l+t.offsetWidth,bottom:d+t.offsetHeight},null!=(n=Bi(a,n)).scrollTop&&wi(a,n.scrollTop),null!=n.scrollLeft)&&Si(a,n.scrollLeft)},triggerOnKeyDown:e(Io),triggerOnKeyPress:e(_o),triggerOnKeyUp:xo,triggerOnMouseDown:e(vo),execCommand:function(e){if(Ls.hasOwnProperty(e))return Ls[e].call(null,this)},triggerElectric:e(function(e){Ao(this,e)}),findPosH:function(e,t,i,a){var o,s,n=1;for(t<0&&(n=-1,t=-t),o=N(this.doc,e),s=0;s<t&&!(o=$o(this.doc,o,n,i,a)).hitSide;++s);return o},moveH:e(function(t,i){var a=this;this.extendSelectionsBy(function(e){return a.display.shift||a.doc.extend||e.empty()?$o(a.doc,e.head,t,i,a.options.rtlMoveVisually):t<0?e.from():e.to()},pn)}),deleteH:e(function(i,a){var e=this.doc.sel,o=this.doc;e.somethingSelected()?o.replaceSelection("",null,"+delete"):lo(this,function(e){var t=$o(o,e.head,i,a,!1);return i<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,i,a){var o,s,n,r=1,d=a;for(t<0&&(r=-1,t=-t),o=N(this.doc,e),s=0;s<t&&(n=zt(this,o,"div"),null==d?d=n.left:n.left=d,!(o=Wo(this,n,r,i)).hitSide);++s);return o},moveV:e(function(a,o){var e,s=this,n=this.doc,r=[],d=!this.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(e){var t,i;return d?a<0?e.from():e.to():(t=zt(s,e.head,"div"),null!=e.goalColumn&&(t.left=e.goalColumn),r.push(t.left),i=Wo(s,t,a,o),"page"==o&&e==n.sel.primary()&&Ii(s,qt(s,i,"div").top-t.top),i)},pn),r.length)for(e=0;e<n.sel.ranges.length;e++)n.sel.ranges[e].goalColumn=r[e]}),findWordAt:function(e){var t,i,a,o=S(this.doc,e.line).text,s=e.ch,n=e.ch;if(o){for(t=this.getHelper(e,"wordChars"),"before"!=e.sticky&&n!=o.length||!s?++n:--s,a=K(i=o.charAt(s),t)?function(e){return K(e,t)}:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!K(e)};0<s&&a(o.charAt(s-1));)--s;for(;n<o.length&&a(o.charAt(n));)++n}return new U(k(e.line,s),k(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?d:Jo)(this.display.cursorDiv,"CodeMirror-overwrite"),F(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==q()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:e(function(e,t){_i(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Tt(this)-this.display.barHeight,width:e.scrollWidth-Tt(this)-this.display.barWidth,clientHeight:kt(this),clientWidth:St(this)}},scrollIntoView:e(function(e,t){var i;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:k(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(t=e,vi(i=this),i.curOp.scrollToPos=t):Ci(this,e.from,e.to,e.margin)}),setSize:e(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var a,o=this;null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&At(this),a=this.display.viewFrom,this.doc.iter(a,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Ei(o,a,"widget");break}++a}),this.curOp.forceUpdate=!0,F(this,"refresh",this)}),operation:function(e){return p(this,e)},startOperation:function(){return Li(this)},endOperation:function(){return Ui(this)},refresh:e(function(){var e=this.display.cachedTextHeight;y(this),this.curOp.forceUpdate=!0,Pt(this),_i(this,this.doc.scrollLeft,this.doc.scrollTop),qi(this),(null==e||.5<Math.abs(e-Xt(this.display)))&&ai(this),F(this,"refresh",this)}),swapDoc:e(function(e){var t=this.doc;return t.cm=null,da(this,e),Pt(this),this.display.input.reset(),_i(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,D(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ve(Cn),Cn.registerHelper=function(e,t,i){Tn.hasOwnProperty(e)||(Tn[e]=Cn[e]={_global:[]}),Tn[e][t]=i},Cn.registerGlobalHelper=function(e,t,i,a){Cn.registerHelper(e,t,a),Tn[e]._global.push({pred:i,val:a})},$s="iter insert remove copy getEditor constructor".split(" "),m.prototype)m.prototype.hasOwnProperty(Ws)&&b($s,Ws)<0&&(u.prototype[Ws]=function(e){return function(){return e.apply(this.doc,arguments)}}(m.prototype[Ws]));return Ve(m),u.inputStyles={textarea:i,contenteditable:a},u.defineMode=function(e){u.defaults.mode||"null"==e||(u.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Bn[e]=t}.apply(this,arguments)},u.defineMIME=function(e,t){In[e]=t},u.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),u.defineMIME("text/plain","null"),u.defineExtension=function(e,t){u.prototype[e]=t},u.defineDocExtension=function(e,t){m.prototype[e]=t},u.fromTextArea=function(t,e){function i(){t.value=r.getValue()}var a,o,s,n,r;if((e=e?j(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus&&(a=q(),e.autofocus=a==t||null!=t.getAttribute("autofocus")&&a==document.body),t.form&&(V(t.form,"submit",i),!e.leaveSubmitMethodAlone)){s=t.form,o=s.submit;try{n=s.submit=function(){i(),s.submit=o,s.submit(),s.submit=n}}catch(e){}}return e.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(_(t.form,"submit",i),"function"==typeof t.form.submit)&&(t.form.submit=o)}},t.style.display="none",r=u(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e)},(o=u).off=_,o.on=V,o.wheelEventPixels=Ji,o.Doc=m,o.splitLines=mn,o.countColumn=B,o.findColumn=G,o.isWordChar=Y,o.Pass=dn,o.signal=F,o.Line=hs,o.changeEnd=Zi,o.scrollbarModel=fs,o.Pos=k,o.cmpPos=x,o.modes=Bn,o.mimeModes=In,o.resolveMode=je,o.getMode=Ge,o.modeExtensions=xn,o.extendMode=Qe,o.copyState=Je,o.startState=Ke,o.innerMode=Ye,o.commands=Ls,o.keyMap=Os,o.keyName=no,o.isModifierKey=oo,o.lookupKey=ao,o.normalizeKeyMap=io,o.StringStream=R,o.SharedTextMarker=vs,o.TextMarker=_s,o.LineWidget=Is,o.e_preventDefault=v,o.e_stopPropagation=$e,o.e_stop=He,o.addClass=d,o.contains=H,o.rmClass=Jo,o.keyNames=Ss,u.version="5.31.1",u}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(a){function e(e){for(var t;null!=(t=e.next());)if("`"==t&&!e.eat("`"))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null}function t(e){return e.eat("@")&&(e.match(/^session\./),e.match(/^local\./),e.match(/^global\./)),e.eat("'")?(e.match(/^.*'/),"variable-2"):e.eat('"')?(e.match(/^.*"/),"variable-2"):e.eat("`")?(e.match(/^.*`/),"variable-2"):e.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function i(e){return e.eat("N")?"atom":e.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function o(e){for(var t={},i=e.split(" "),a=0;a<i.length;++a)t[i[a]]=!0;return t}var s;a.defineMode("sql",function(i,e){function s(e,t){var i,o,a=e.next();return c[a]&&!1!==(i=c[a](e,t))?i:p.hexNumber&&("0"==a&&e.match(/^[xX][0-9a-fA-F]+/)||("x"==a||"X"==a)&&e.match(/^'[0-9a-fA-F]+'/))||p.binaryNumber&&(("b"==a||"B"==a)&&e.match(/^'[01]+'/)||"0"==a&&e.match(/^b[01]+/))?"number":47<a.charCodeAt(0)&&a.charCodeAt(0)<58?(e.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),p.decimallessFloat&&e.match(/^\.(?!\.)/),"number"):"?"==a&&(e.eatSpace()||e.eol()||e.eat(";"))?"variable-3":"'"==a||'"'==a&&p.doubleQuote?(t.tokenize=(o=a,function(e,t){for(var i,a=!1;null!=(i=e.next());){if(i==o&&!a){t.tokenize=s;break}a=!a&&"\\"==i}return"string"}),t.tokenize(e,t)):!(p.nCharCast&&("n"==a||"N"==a)||p.charsetCast&&"_"==a&&e.match(/[a-z][a-z0-9]*/i))||"'"!=e.peek()&&'"'!=e.peek()?/^[\(\),\;\[\]]/.test(a)?null:p.commentSlashSlash&&"/"==a&&e.eat("/")||p.commentHash&&"#"==a||"-"==a&&e.eat("-")&&(!p.commentSpaceRequired||e.eat(" "))?(e.skipToEnd(),"comment"):"/"==a&&e.eat("*")?(t.tokenize=function a(o){return function(e,t){var i=e.match(/^.*?(\/\*|\*\/)/);return i?t.tokenize="/*"==i[1]?a(o+1):1<o?a(o-1):s:e.skipToEnd(),"comment"}}(1),t.tokenize(e,t)):"."==a?p.zerolessFloat&&e.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":e.match(/^\.+/)?null:p.ODBCdotTable&&e.match(/^[\w\d_]+/)?"variable-2":void 0:h.test(a)?(e.eatWhile(h),null):"{"==a&&(e.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||e.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/))||(e.eatWhile(/^[_\w\d]/),i=e.current().toLowerCase(),u.hasOwnProperty(i)&&(e.match(/^( )+'[^']*'/)||e.match(/^( )+"[^"]*"/)))?"number":r.hasOwnProperty(i)?"atom":d.hasOwnProperty(i)?"builtin":l.hasOwnProperty(i)?"keyword":n.hasOwnProperty(i)?"string-2":null:"keyword"}function o(e,t,i){t.context={prev:t.context,indent:e.indentation(),col:e.column(),type:i}}var n=e.client||{},r=e.atoms||{false:!0,true:!0,null:!0},d=e.builtin||{},l=e.keywords||{},h=e.operatorChars||/^[*+\-%<>!=&|~^]/,p=e.support||{},c=e.hooks||{},u=e.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:s,context:null}},token:function(e,t){var i,a;return e.sol()&&t.context&&null==t.context.align&&(t.context.align=!1),t.tokenize==s&&e.eatSpace()?null:("comment"==(i=t.tokenize(e,t))||(t.context&&null==t.context.align&&(t.context.align=!0),"("==(a=e.current())?o(e,t,")"):"["==a?o(e,t,"]"):t.context&&t.context.type==a&&((e=t).indent=e.context.indent,e.context=e.context.prev)),i)},indent:function(e,t){e=e.context;return e?(t=t.charAt(0)==e.type,e.align?e.col+(t?0:1):e.indent+(t?0:i.indentUnit)):a.Pass},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:p.commentSlashSlash?"//":p.commentHash?"#":"--"}}),s="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ",a.defineMIME("text/x-sql",{name:"sql",keywords:o(s+"begin"),builtin:o("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable doubleQuote binaryNumber hexNumber")}),a.defineMIME("text/x-mssql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec"),builtin:o("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":t}}),a.defineMIME("text/x-mysql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-mariadb",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-memsql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-sqlite",{name:"sql",client:o("auth backup bail binary changes check clone databases dbinfo dump echo eqp exit explain fullschema headers help import imposter indexes iotrace limit lint load log mode nullvalue once open output print prompt quit read restore save scanstats schema separator session shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width"),keywords:o(s+"abort action add after all analyze attach autoincrement before begin cascade case cast check collate column commit conflict constraint cross current_date current_time current_timestamp database default deferrable deferred detach each else end escape except exclusive exists explain fail for foreign full glob if ignore immediate index indexed initially inner instead intersect isnull key left limit match natural no notnull null of offset outer plan pragma primary query raise recursive references regexp reindex release rename replace restrict right rollback row savepoint temp temporary then to transaction trigger unique using vacuum view virtual when with without"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text clob bigint int int2 int8 integer float double char varchar date datetime year unsigned signed numeric real"),atoms:o("null current_date current_time current_timestamp"),operatorChars:/^[*+\-%<>!=&|/~]/,dateSQL:o("date time timestamp datetime"),support:o("decimallessFloat zerolessFloat"),identifierQuote:'"',hooks:{"@":t,":":t,"?":t,$:t,'"':function(e){for(var t;null!=(t=e.next());)if('"'==t&&!e.eat('"'))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null},"`":e}}),a.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:o("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:o("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:o("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:o("commentSlashSlash decimallessFloat"),hooks:{}}),a.defineMIME("text/x-plsql",{name:"sql",client:o("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:o("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:o("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:o("date time timestamp"),support:o("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),a.defineMIME("text/x-hive",{name:"sql",keywords:o("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:o("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date timestamp"),support:o("ODBCdotTable doubleQuote binaryNumber hexNumber")}),a.defineMIME("text/x-pgsql",{name:"sql",client:o("source"),keywords:o(s+"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parallel parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict restricted result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat attach path depends detach zone"),builtin:o("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),a.defineMIME("text/x-gql",{name:"sql",keywords:o("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:o("false true"),builtin:o("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/}),a.defineMIME("text/x-gpsql",{name:"sql",client:o("source"),keywords:o("abort absolute access action active add admin after aggregate all also alter always analyse analyze and any array as asc assertion assignment asymmetric at authorization backward before begin between bigint binary bit boolean both by cache called cascade cascaded case cast chain char character characteristics check checkpoint class close cluster coalesce codegen collate column comment commit committed concurrency concurrently configuration connection constraint constraints contains content continue conversion copy cost cpu_rate_limit create createdb createexttable createrole createuser cross csv cube current current_catalog current_date current_role current_schema current_time current_timestamp current_user cursor cycle data database day deallocate dec decimal declare decode default defaults deferrable deferred definer delete delimiter delimiters deny desc dictionary disable discard distinct distributed do document domain double drop dxl each else enable encoding encrypted end enum errors escape every except exchange exclude excluding exclusive execute exists explain extension external extract false family fetch fields filespace fill filter first float following for force foreign format forward freeze from full function global grant granted greatest group group_id grouping handler hash having header hold host hour identity if ignore ilike immediate immutable implicit in including inclusive increment index indexes inherit inherits initially inline inner inout input insensitive insert instead int integer intersect interval into invoker is isnull isolation join key language large last leading least left level like limit list listen load local localtime localtimestamp location lock log login mapping master match maxvalue median merge minute minvalue missing mode modifies modify month move name names national natural nchar new newline next no nocreatedb nocreateexttable nocreaterole nocreateuser noinherit nologin none noovercommit nosuperuser not nothing notify notnull nowait null nullif nulls numeric object of off offset oids old on only operator option options or order ordered others out outer over overcommit overlaps overlay owned owner parser partial partition partitions passing password percent percentile_cont percentile_disc placing plans position preceding precision prepare prepared preserve primary prior privileges procedural procedure protocol queue quote randomly range read readable reads real reassign recheck recursive ref references reindex reject relative release rename repeatable replace replica reset resource restart restrict returning returns revoke right role rollback rollup rootpartition row rows rule savepoint scatter schema scroll search second security segment select sequence serializable session session_user set setof sets share show similar simple smallint some split sql stable standalone start statement statistics stdin stdout storage strict strip subpartition subpartitions substring superuser symmetric sysid system table tablespace temp template temporary text then threshold ties time timestamp to trailing transaction treat trigger trim true truncate trusted type unbounded uncommitted unencrypted union unique unknown unlisten until update user using vacuum valid validation validator value values varchar variadic varying verbose version view volatile web when where whitespace window with within without work writable write xml xmlattributes xmlconcat xmlelement xmlexists xmlforest xmlparse xmlpi xmlroot xmlserialize year yes zone"),builtin:o("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),a.defineMIME("text/x-sparksql",{name:"sql",keywords:o("add after all alter analyze and anti archive array as asc at between bucket buckets by cache cascade case cast change clear cluster clustered codegen collection column columns comment commit compact compactions compute concatenate cost create cross cube current current_date current_timestamp database databases datata dbproperties defined delete delimited desc describe dfs directories distinct distribute drop else end escaped except exchange exists explain export extended external false fields fileformat first following for format formatted from full function functions global grant group grouping having if ignore import in index indexes inner inpath inputformat insert intersect interval into is items join keys last lateral lazy left like limit lines list load local location lock locks logical macro map minus msck natural no not null nulls of on option options or order out outer outputformat over overwrite partition partitioned partitions percent preceding principals purge range recordreader recordwriter recover reduce refresh regexp rename repair replace reset restrict revoke right rlike role roles rollback rollup row rows schema schemas select semi separated serde serdeproperties set sets show skewed sort sorted start statistics stored stratify struct table tables tablesample tblproperties temp temporary terminated then to touch transaction transactions transform true truncate unarchive unbounded uncache union unlock unset use using values view when where window with"),builtin:o("tinyint smallint int bigint boolean float double string binary timestamp decimal array map struct uniontype delimited serde sequencefile textfile rcfile inputformat outputformat"),atoms:o("false true null"),operatorChars:/^[*+\-%<>!=~&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable doubleQuote zerolessFloat")}),a.defineMIME("text/x-esper",{name:"sql",client:o("source"),keywords:o("alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit after all and as at asc avedev avg between by case cast coalesce count create current_timestamp day days delete define desc distinct else end escape events every exists false first from full group having hour hours in inner insert instanceof into irstream is istream join last lastweekday left limit like max match_recognize matches median measures metadatasql min minute minutes msec millisecond milliseconds not null offset on or order outer output partition pattern prev prior regexp retain-union retain-intersection right rstream sec second seconds select set some snapshot sql stddev sum then true unidirectional until update variable weekday when where window"),builtin:{},atoms:o("false true null"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("time"),support:o("decimallessFloat zerolessFloat binaryNumber hexNumber")})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(x){function a(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var i=this;e.on("cursorActivity",this.activityFunc=function(){i.cursorActivity()})}function _(e){return"string"==typeof e?e:e.text}function v(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function o(o,e){this.completion=o,this.data=e,this.picked=!1;var t,i,a,s,n,r,d=this,l=o.cm,h=this.hints=document.createElement("ul");for(h.className="CodeMirror-hints",this.selectedHint=e.selectedHint||0,t=e.list,i=0;i<t.length;++i){var p=h.appendChild(document.createElement("li")),c=t[i],u="CodeMirror-hint"+(i!=this.selectedHint?"":" "+C);null!=c.className&&(u=c.className+" "+u),p.className=u,c.render?c.render(p,e,c):p.appendChild(document.createTextNode(c.displayText||_(c))),p.hintId=i}var b=l.cursorCoords(o.options.alignWithWord?e.from:null),g=b.left,m=b.bottom,f=!0,D=(h.style.left=g+"px",h.style.top=m+"px",a=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),s=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),(o.options.container||document.body).appendChild(h),h.getBoundingClientRect()),y=D.bottom-s,B=h.scrollHeight>h.clientHeight+1,I=l.getScrollInfo();if(0<y&&(y=D.bottom-D.top,0<b.top-(b.bottom-D.top)-y?(h.style.top=(m=b.top-y)+"px",f=!1):s<y&&(h.style.height=s-5+"px",h.style.top=(m=b.bottom-D.top)+"px",y=l.getCursor(),e.from.ch!=y.ch)&&(b=l.cursorCoords(y),h.style.left=(g=b.left)+"px",D=h.getBoundingClientRect())),0<(s=D.right-a)&&(D.right-D.left>a&&(h.style.width=a-5+"px",s-=D.right-D.left-a),h.style.left=(g=b.left-s)+"px"),B)for(n=h.firstChild;n;n=n.nextSibling)n.style.paddingRight=l.display.nativeBarWidth+"px";return l.addKeyMap(this.keyMap=function(e,a){function t(e,t){var i="string"!=typeof t?function(e){return t(e,a)}:s.hasOwnProperty(t)?s[t]:t;r[e]=i}var i,o,s={Up:function(){a.moveFocus(-1)},Down:function(){a.moveFocus(1)},PageUp:function(){a.moveFocus(1-a.menuSize(),!0)},PageDown:function(){a.moveFocus(a.menuSize()-1,!0)},Home:function(){a.setFocus(0)},End:function(){a.setFocus(a.length-1)},Enter:a.pick,Tab:a.pick,Esc:a.close},n=e.options.customKeys,r=n?{}:s;if(n)for(o in n)n.hasOwnProperty(o)&&t(o,n[o]);if(i=e.options.extraKeys)for(o in i)i.hasOwnProperty(o)&&t(o,i[o]);return r}(o,{moveFocus:function(e,t){d.changeActive(d.selectedHint+e,t)},setFocus:function(e){d.changeActive(e)},menuSize:function(){return d.screenAmount()},length:t.length,close:function(){o.close()},pick:function(){d.pick()},data:e})),o.options.closeOnUnfocus&&(l.on("blur",this.onBlur=function(){r=setTimeout(function(){o.close()},100)}),l.on("focus",this.onFocus=function(){clearTimeout(r)})),l.on("scroll",this.onScroll=function(){var e=l.getScrollInfo(),t=l.getWrapperElement().getBoundingClientRect(),i=m+I.top-e.top,a=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(f||(a+=h.offsetHeight),a<=t.top||a>=t.bottom)return o.close();h.style.top=i+"px",h.style.left=g+I.left-e.left+"px"}),x.on(h,"dblclick",function(e){e=v(h,e.target||e.srcElement);e&&null!=e.hintId&&(d.changeActive(e.hintId),d.pick())}),x.on(h,"click",function(e){e=v(h,e.target||e.srcElement);e&&null!=e.hintId&&(d.changeActive(e.hintId),o.options.completeOnSingleClick)&&d.pick()}),x.on(h,"mousedown",function(){setTimeout(function(){l.focus()},20)}),x.signal(e,"select",t[this.selectedHint],h.childNodes[this.selectedHint]),!0}function r(e,t,i,a){e.async?e(t,a,i):(e=e(t,i))&&e.then?e.then(a):a(e)}var s,n,d,C="CodeMirror-hint-active";x.showHint=function(e,t,i){var a,o;if(!t)return e.showHint(i);if(i&&i.async&&(t.async=!0),a={hint:t},i)for(o in i)a[o]=i[o];return e.showHint(a)},x.defineExtension("showHint",function(e){var t,i;if(e=function(e,t,i){var a,o=e.options.hintOptions,s={};for(a in d)s[a]=d[a];if(o)for(a in o)void 0!==o[a]&&(s[a]=o[a]);if(i)for(a in i)void 0!==i[a]&&(s[a]=i[a]);return s.hint.resolve&&(s.hint=s.hint.resolve(e,t)),s}(this,this.getCursor("start"),e),!(1<(t=this.listSelections()).length)){if(this.somethingSelected()){if(!e.hint.supportsSelection)return;for(i=0;i<t.length;i++)if(t[i].head.line!=t[i].anchor.line)return}this.state.completionActive&&this.state.completionActive.close(),(e=this.state.completionActive=new a(this,e)).options.hint&&(x.signal(this,"startCompletion",this),e.update(!0))}}),s=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},n=window.cancelAnimationFrame||clearTimeout,a.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&x.signal(this.data,"close"),this.widget&&this.widget.close(),x.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(e,t){t=e.list[t];t.hint?t.hint(this.cm,e,t):this.cm.replaceRange(_(t),t.from||e.from,t.to||e.to,"complete"),x.signal(e,"pick",t),this.close()},cursorActivity:function(){var e,t,i;this.debounce&&(n(this.debounce),this.debounce=0),e=this.cm.getCursor(),t=this.cm.getLine(e.line),e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1))?this.close():((i=this).debounce=s(function(){i.update()}),this.widget&&this.widget.disable())},update:function(t){var i,a;null!=this.tick&&(a=++(i=this).tick,r(this.options.hint,this.cm,this.options,function(e){i.tick==a&&i.finishUpdate(e,t)}))},finishUpdate:function(e,t){this.data&&x.signal(this.data,"update");var i,a,t=this.widget&&this.widget.picked||t&&this.options.completeSingle;this.widget&&this.widget.close(),e&&this.data&&(i=this.data,a=e,0<x.cmpPos(a.from,i.from))&&i.to.ch-i.from.ch!=a.to.ch-a.from.ch||(this.data=e)&&e.list.length&&(t&&1==e.list.length?this.pick(e,0):(this.widget=new o(this,e),x.signal(e,"shown")))}},o.prototype={close:function(){var e;this.completion.widget==this&&(this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap),e=this.completion.cm,this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll))},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(e,t){e>=this.data.list.length?e=t?this.data.list.length-1:0:e<0&&(e=t?0:this.data.list.length-1),this.selectedHint!=e&&((t=this.hints.childNodes[this.selectedHint]).className=t.className.replace(" "+C,""),(t=this.hints.childNodes[this.selectedHint=e]).className+=" "+C,t.offsetTop<this.hints.scrollTop?this.hints.scrollTop=t.offsetTop-3:t.offsetTop+t.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=t.offsetTop+t.offsetHeight-this.hints.clientHeight+3),x.signal(this.data,"select",this.data.list[this.selectedHint],t))},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},x.registerHelper("hint","auto",{resolve:function(e,t){var i,n=e.getHelpers(t,"hint");return n.length?((t=function(e,a,o){var s=function(e,t){var i,a;if(!e.somethingSelected())return t;for(i=[],a=0;a<t.length;a++)t[a].supportsSelection&&i.push(t[a]);return i}(e,n);!function t(i){if(i==s.length)return a(null);r(s[i],e,o,function(e){e&&0<e.list.length?a(e):t(i+1)})}(0)}).async=!0,t.supportsSelection=!0,t):(i=e.getHelper(e.getCursor(),"hintWords"))?function(e){return x.hint.fromList(e,{words:i})}:x.hint.anyword?function(e,t){return x.hint.anyword(e,t)}:function(){}}}),x.registerHelper("hint","fromList",function(e,t){for(var i,a,o=e.getCursor(),e=e.getTokenAt(o),s=x.Pos(o.line,e.end),o=e.string&&/\w/.test(e.string[e.string.length-1])?(i=e.string,x.Pos(o.line,e.start)):(i="",s),n=[],r=0;r<t.words.length;r++)(a=t.words[r]).slice(0,i.length)==i&&n.push(a);if(n.length)return{list:n,from:o,to:s}}),x.commands.autocomplete=x.showHint,d={hint:x.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null},x.defineOption("hintOptions",null)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../../mode/sql/sql")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],e):e(CodeMirror)}(function(d){function l(e){return"[object Array]"==Object.prototype.toString.call(e)}function h(e){return"string"==typeof e?e:e.text}function p(e,t){return(t=l(t)?{columns:t}:t).text||(t.text=e),t}function b(e){return D[e.toUpperCase()]}function u(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function r(e,t){var i=e.length,t=h(t).substr(0,i);return e.toUpperCase()===t.toUpperCase()}function g(e,t,i,a){var o,s,n;if(l(i))for(o=0;o<i.length;o++)r(t,i[o])&&e.push(a(i[o]));else for(s in i)i.hasOwnProperty(s)&&(n=i[s],n=n&&!0!==n?n.displayText?{text:n.text,displayText:n.displayText}:n.text:s,r(t,n))&&e.push(a(n))}function m(e){for(var t,i=h(e).split("."),a=0;a<i.length;a++)i[a]=I+i[a].replace(new RegExp(I,"g"),I+I)+I;return t=i.join("."),"string"==typeof e?t:((e=u(e)).text=t,e)}function c(e,t,i,a){for(var o,s=!1,n=[],r=t.start,d=!0;d;)d="."==t.string.charAt(0),s=s||t.string.charAt(0)==I,r=t.start,n.unshift(function(e){for(var t=(e="."==e.charAt(0)?e.substr(1):e).split(I+I),i=0;i<t.length;i++)t[i]=t[i].replace(new RegExp(I,"g"),"");return t.join(I)}(t.string)),"."==(t=a.getTokenAt(v(e.line,t.start))).string&&(d=!0,t=a.getTokenAt(v(e.line,t.start)));g(i,l=n.join("."),D,function(e){return s?m(e):e}),g(i,l,y,function(e){return s?m(e):e});var l=n.pop(),h=n.join("."),p=!1,c=h;return b(h)||(h=f(o=h,a))!==o&&(p=!0),(o=(o=b(h))&&o.columns?o.columns:o)&&g(i,l,o,function(e){var t=1==p?c:h;return"string"==typeof e?e=t+"."+e:(e=u(e)).text=t+"."+e.text,s?m(e):e}),r}function f(e,t){for(var i,a,o,s,n=t.doc,r=n.getValue(),d=e.toUpperCase(),l="",h="",p=[],c={start:v(0,0),end:v(t.lastLine(),t.getLineHandle(t.lastLine()).length)},u=r.indexOf(x);-1!=u;)p.push(n.posFromIndex(u)),u=r.indexOf(x,u+1);for(p.unshift(v(0,0)),p.push(v(t.lastLine(),t.getLineHandle(t.lastLine()).text.length)),i=null,a=t.getCursor(),s=0;s<p.length;s++){if((null==i||0<C(a,i))&&C(a,p[s])<=0){c={start:i,end:p[s]};break}i=p[s]}for(o=n.getRange(c.start,c.end,!1),s=0;s<o.length&&(function(e,t){for(var i=e.split(/\s+/),a=0;a<i.length;a++)i[a]&&t(i[a].replace(/[,;]/g,""))}(o[s],function(e){var t=e.toUpperCase();t===d&&b(l)&&(h=l),t!==_&&(l=e)}),!h);s++);return h}var D,y,B,I,x=";",_="AS",v=d.Pos,C=d.cmpPos;d.registerHelper("hint","sql",function(e,t){D=function(e){var t,i,a,o={};if(l(e))for(t=e.length-1;0<=t;t--)o[h(i=e[t]).toUpperCase()]=p(h(i),i);else if(e)for(a in e)o[a.toUpperCase()]=p(a,e[a]);return o}(t&&t.tables),n=t&&t.defaultTable,t=t&&t.disableKeywords,y=n&&b(n),s=(s=e).doc.modeOption,B=d.resolveMode(s="sql"===s?"text/x-sql":s).keywords,s=(s=e).doc.modeOption,I=d.resolveMode(s="sql"===s?"text/x-sql":s).identifierQuote||"`",(y=(y=n&&!y?f(n,e):y)||[]).columns&&(y=y.columns);var i,a,o,s=e.getCursor(),n=[],r=e.getTokenAt(s);return r.end>s.ch&&(r.end=s.ch,r.string=r.string.slice(0,s.ch-r.start)),r.string.match(/^[.`"\w@]\w*$/)?(o=r.string,i=r.start,a=r.end):(i=a=s.ch,o=""),"."==o.charAt(0)||o.charAt(0)==I?i=c(s,r,n,e):(g(n,o,D,function(e){return e}),g(n,o,y,function(e){return e}),t||g(n,o,B,function(e){return e.toUpperCase()})),{list:n,from:v(s.line,i),to:v(s.line,a)}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(a){function o(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function s(e){var t,i;o(e),(t=e.state.placeholder=document.createElement("pre")).style.cssText="height: 0; overflow: visible",t.style.direction=e.getOption("direction"),t.className="CodeMirror-placeholder CodeMirror-line-like","string"==typeof(i=e.getOption("placeholder"))&&(i=document.createTextNode(i)),t.appendChild(i),e.display.lineSpace.insertBefore(t,e.display.lineSpace.firstChild)}function n(e){d(e)&&s(e)}function r(e){var t=e.getWrapperElement(),i=d(e);t.className=t.className.replace(" CodeMirror-empty","")+(i?" CodeMirror-empty":""),(i?s:o)(e)}function d(e){return 1===e.lineCount()&&""===e.getLine(0)}a.defineOption("placeholder","",function(e,t,i){var i=i&&i!=a.Init;t&&!i?(e.on("blur",n),e.on("change",r),e.on("swapDoc",r),a.on(e.getInputField(),"compositionupdate",e.state.placeholderCompose=function(){var i;i=e,setTimeout(function(){var e,t=!1;((t=1==i.lineCount()?"TEXTAREA"==(e=i.getInputField()).nodeName?!i.getLine(0).length:!/[^\u200b]/.test(e.querySelector(".CodeMirror-line").textContent):t)?s:o)(i)},20)}),r(e)):!t&&i&&(e.off("blur",n),e.off("change",r),e.off("swapDoc",r),a.off(e.getInputField(),"compositionupdate",e.state.placeholderCompose),o(e),(i=e.getWrapperElement()).className=i.className.replace(" CodeMirror-empty","")),t&&!e.hasFocus()&&n(e)})}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),InternalReplaceValues=function(){function e(e){this.divDialog=null,this.editRuleTbl=null,this.customTable=null,this.matchCaseRow=null,this.replaceValuesInfo=null,this.headerRowDiv=null,this.textBox=null,this.textBoxOne=null,this.replaceTextBox=null,this.replaceTextBoxOne=null,this.matchCaseCheckBox=null,this.matchEntireStringCheckBox=null,this.ruleMatchCaseCheckBox=null,this.ruleMatchEntireStringCheckBox=null,this.replaceRuleTbl=null,this.replaceRuleCancelBtn=null,this.addRuleBtn=null,this.cancelBtn=null,this.applyButton=null,this.tableRowDiv=null,this.lineDiv=null,this.customRuleTableDiv=null,this.headerRow=0,this.customRuleTable=null,this.table=null,this.locale=null,this.target=null,this.replaceValues=[],this.scrollContainer=null,this.replaceValuesScrollElement=null,this.shouldAddRuleActionDiv=!1,this.reloaded=!1,this.isEdited=!1,this.editCancelBtn=null,this.updateBtn=null,this.resetBtn=null,this.divDialogFooter=null,this.closeButton=null,this.backButton=null,this.valueToReplaceDiv=null,this.applyReplaceValuesTimeout=null,this.applyDataSourceReplaceValuesTimeout=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id;var e={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:"(Null)",valueToReplace:"(Null)",matchCase:!0,matchEntireString:!0},t={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:"(Blanks)",valueToReplace:"(Blanks)",matchCase:!0,matchEntireString:!0};this.replaceValues=[e,t],this.unWireEvents(),this.wireEvents()}return e.prototype.renderReplaceValuesDialog=function(e){void 0===e&&(e=!1),this.divDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.dashboardDesigner._id+"_replaceValues_dialog"}),this.tableRowDiv=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_table"}),this.customRuleTableDiv=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_replaceValues_customRule_table"}),this.scrollContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"140px",display:"block"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_individual_container"}),this.replaceValuesScrollElement=BoldBIDashboard.buildTag("div","",{height:"140px","padding-top":"5px","padding-bottom":"5px"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_scroll_elements"}),this.cancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"-6px"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_btn_cancel",type:"button"}),e=e?this.dashboardDesigner._id+"_replaceValues_dialog_btn_ok_ds":this.dashboardDesigner._id+"_replaceValues_dialog_btn_ok",this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.applyBtnText,{float:"right",right:"-8px"},{id:e,type:"button"}),this.divDialog.append(this.tableRowDiv,this.customRuleTableDiv.append(this.scrollContainer.append(this.replaceValuesScrollElement))),this.editRuleTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",height:"259px"},{});var e=BoldBIDashboard.buildTag("tr","",{height:"25px"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"6%",left:"3%"}),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{padding:"9px","font-weight":"600"},{type:"label"}),a=BoldBIDashboard.buildTag("tr","",{}),t=(this.textBox=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"19%",height:"25px",left:"18px",width:"314px"},{type:"text",id:this.id+"_edit_values_textbox_1"}),r=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%"},{id:this.id+"edit_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(r,this.id),d=BoldBIDashboard.buildTag("tr","",{height:"25px"}),this.valueToReplaceDiv=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"11px",top:"36%"}),o=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToReplaceText,{padding:"9px","font-weight":"600"},{type:"label"}),s=BoldBIDashboard.buildTag("tr","",{}),this.textBoxOne=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"49%",height:"25px",left:"18px",width:"314px"},{type:"text",id:this.id+"_edit_values_textbox_sec"}),n=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%",top:"42%"},{id:this.id+"editReplace_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(n,this.id),this.editRuleTbl.append(e.append(t.append(i)),a.append(this.textBox).append(r),d.append(this.valueToReplaceDiv.append(o)),s.append(this.textBoxOne).append(n)),this.matchCaseRow=BoldBIDashboard.buildTag("tr","",{height:"20px"},{id:this.id+"_replace_values_matchcase_row"}),e=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",left:"22px",top:"159px","margin-top":"14px"}),this.matchCaseCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_values_matchcase_checkbox_1"}),BoldBIDashboard.buildTag("td","",{position:"absolute",left:"33px",top:"175px"})),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchCaseText,{padding:"11px"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"162px",left:"33%","margin-top":"12px"}),o=(this.matchEntireStringCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_values_matchcase_checkbox_2"}),r=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"171px",left:"137px","margin-top":"5px"}),d=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchEntireStringText,{padding:"6px",position:"relative"},{type:"label"}),this.editRuleTbl.append(this.matchCaseRow.append(e.append(this.matchCaseCheckBox),t.append(i),a.append(this.matchEntireStringCheckBox),r.append(d))),this.textBox.on("keyup",this.bbdesigner$.proxy(this.editRuleValueToFindTextBox,this)),this.textBox.on("create",this.bbdesigner$.proxy(this.valueToFindCreate,this)),this.textBoxOne.on("keyup",this.bbdesigner$.proxy(this.editRuleValueToReplaceTextBox,this)),this.textBoxOne.on("create",this.bbdesigner$.proxy(this.valueToReplaceCreate,this)),this.matchCaseCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateMatchCaseCheckBox,this)}),this.matchEntireStringCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateMatchEntireStringCheckBox,this)}),this.editRuleTbl.hide(),this.editCancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"5px"},{id:this.id+"_editrule_btn_cancel",type:"button"}),this.updateBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.updateBtnText,{float:"right",right:"4px"},{id:this.id+"_editrule_btn_update",type:"button"}),this.resetBtn=BoldBIDashboard.buildTag("div.bbi-replace-null-blank-reset-icon bbi-dbrd-designer-hoverable","",{},{id:this.id+"_editrule_reset","data-tooltip":this.locale.dialogOptions.resetButtonText}),this.editCancelBtn.on("click",this.bbdesigner$.proxy(this.editCancelAction,this)),this.divDialog.append(this.editRuleTbl),this.replaceRuleTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",height:"259px"},{}),BoldBIDashboard.buildTag("tr","",{height:"25px"})),s=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"6%",left:"3%"}),n=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{padding:"9px","font-weight":"600"},{type:"label"}),e=BoldBIDashboard.buildTag("tr","",{}),i=(this.replaceTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"19%",height:"25px",left:"22px",width:"309px"},{type:"text",id:this.id+"_replace_rule_textbox_1"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%"},{id:this.id+"_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(t,this.id),this.replaceRuleTbl.append(o.append(s.append(n)),e.append(this.replaceTextBox).append(t)),BoldBIDashboard.buildTag("tr","",{height:"25px"})),a=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"11px",top:"36%"}),r=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToReplaceText,{padding:"9px","font-weight":"600"},{type:"label"}),d=BoldBIDashboard.buildTag("tr","",{}),s=(this.replaceTextBoxOne=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"49%",height:"25px",left:"22px",width:"309px"},{type:"text",id:this.id+"_replace_rule_textbox_2"}),o=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"42%",right:"5%"},{id:this.id+"replace_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(o,this.id),this.replaceRuleTbl.append(i.append(a.append(r)),d.append(this.replaceTextBoxOne).append(o)),BoldBIDashboard.buildTag("tr","",{height:"20px"},{id:this.id+"_replace_rule_matchcase_row"})),n=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",left:"22px",top:"160px","margin-top":"14px"}),e=this.ruleMatchCaseCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_rule_matchcase_checkbox_1"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"9%",top:"176px"}),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchCaseText,{padding:"11px"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"159px",left:"33%","margin-top":"16px"}),r=this.ruleMatchEntireStringCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_rule_matchcase_checkbox_2"}),d=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"172px",float:"left",left:"37%","margin-top":"5px"}),o=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchEntireStringText,{padding:"6px",position:"relative"},{type:"label"});this.replaceRuleTbl.append(s.append(n.append(e)),t.append(i),a.append(r),d.append(o)),this.replaceTextBox.on("keyup",this.bbdesigner$.proxy(this.addRuleValueToFindTextBox,this)),this.replaceTextBox.on("create",this.bbdesigner$.proxy(this.valueToFindCreateSec,this)),this.replaceTextBoxOne.on("keyup",this.bbdesigner$.proxy(this.addRuleValueToReplaceTextBox,this)),this.replaceTextBoxOne.on("create",this.bbdesigner$.proxy(this.valueToReplaceCreateSec,this)),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.ruleUpdateMatchCaseCheckBox,this)}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.ruleUpdateMatchEntireStringCheckBox,this)}),this.replaceRuleTbl.hide(),this.replaceRuleCancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"5px"},{id:this.id+"_replacerule_dialog_btn_ruleCancel",type:"button"}),this.addRuleBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.addRuleBtnText,{float:"right",right:"4px"},{type:"button",id:this.id+"_replaceRule_dialog_btn_addRule",disabled:!0}),this.replaceRuleCancelBtn.on("click",this.bbdesigner$.proxy(this.closeRuleDialog,this)),this.divDialog.append(this.replaceRuleTbl),this.dashboardDesigner.element.append(this.divDialog),this.divDialog.BoldBIDashboardDialog({title:this.locale.replaceValues.title,actionButtons:["close","back"],width:366,height:"auto",minWidth:367,minHeight:275,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,create:this.bbdesigner$.proxy(this.addActionButtonIcon,this),actionButtonClick:this.bbdesigner$.proxy(this.headerIconClick,this),cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-mobile-export",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.closeButton=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_replaceValues_dialog_closebutton"),this.backButton=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_replaceValues_dialog_backbutton"),this.closeButton.css("left","4px"),this.closeButton.css("top","11px"),this.backButton.css("padding","4px 3px 1px 5px"),this.backButton.css("font-size","11px"),this.backButton.css("margin-left","5px"),this.backButton.css("top","10px"),this.backButton.css("display","none"),this.divDialogFooter=this.bbdesigner$("#"+this.dashboardDesigner._id+"_replaceValues_dialog_foot"),this.divDialogFooter.append(this.cancelBtn,this.applyButton,this.resetBtn,this.editCancelBtn,this.updateBtn,this.replaceRuleCancelBtn,this.addRuleBtn),this.resetBtn.hide(),this.updateBtn.hide(),this.editCancelBtn.hide(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.scrollContainer.BoldBIDashboardScroller({height:"140px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!1,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.divDialog.data("BoldBIDashboardDialog").open()},e.prototype.populateReplacingValues=function(e){void 0===e&&(e=null);var t=this.table=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),i=this.replaceValues[0].id,a=this.replaceValues[1].id,o=BoldBIDashboard.buildTag("div","",{"margin-top":"7px","margin-left":"9px","margin-right":"22px"},{}),s=BoldBIDashboard.buildTag("tr","",{height:"20px"},{}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{position:"absolute",top:"7px",left:"12px","font-weight":"600"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{position:"relative",left:"145px","font-weight":"600"}),o=(t.append(o.append(s.append(n,r))),BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{})),s=BoldBIDashboard.buildTag("tr","",{height:"25px"},{id:i}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.nullText,{position:"absolute",top:"44px",left:"14px"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.nullValueText,{position:"relative",top:"6px",left:"145px"}),i=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",left:"325px",top:"44px"}),d=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),o=(t.append(o.append(s.append(n,r,i.append(d)))),BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"17px","margin-left":"9px","margin-right":"9px"},{})),s=BoldBIDashboard.buildTag("tr","",{height:"25px"},{id:a}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.blanksText,{position:"absolute",top:"86px",left:"13px"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.blanksValueText,{position:"absolute",top:"86px",left:"153px"}),i=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"relative",left:"315px",top:"6px"}),d=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),s=(t.append(o.append(s.append(n,r,i.append(d)))),this.lineDiv=BoldBIDashboard.buildTag("div.bbi-replacevalues-separator","",{}),a=BoldBIDashboard.buildTag("tr","",{height:"10px"}),o=BoldBIDashboard.buildTag("td","",{},{id:this.id+"_replace_values_line_separator"}),t.append(this.lineDiv.append(a).append(o)),this.tableRowDiv.append(t),this.customTable=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),BoldBIDashboard.buildTag("div","",{"margin-top":"10px","margin-left":"9px","margin-right":"22px"},{})),n=BoldBIDashboard.buildTag("tr","",{height:"10px"},{}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.customRuleText,{"padding-left":"4px","font-weight":"600"}),i=BoldBIDashboard.buildTag("div"," ",{cursor:"pointer",position:"absolute",left:"82%",height:"2px",width:"31px"},{id:this.id+"_replaceValues_dialog_btn_newRule"}),d=BoldBIDashboard.buildTag("td.e-chk-image e-icon e-plus bbi-designer-add-icon e-query-filter-add-icon","",{position:"relative",cursor:"pointer",left:"-15px",top:"2px"},{}),a=BoldBIDashboard.buildTag("td.e-btntxt bbi-designer-add-btn",this.locale.replaceValues.addRuleBtnText,{cursor:"pointer",position:"relative",top:"-16px","white-space":"nowrap",width:"47px"},{});this.customRuleTableDiv.append(this.customTable.append(s.append(n.append(r,i.append(d,a))))),this.renderRowElement(this.customTable,this.replaceValues,e),this.divDialog.data("BoldBIDashboardDialog").open(),this.replaceValuesScrollElement.append(this.customTable),this.scrollerRefresh(this.scrollContainer)},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.renderRowElement=function(e,t,i){var a,o,s,n,r;if(void 0===i&&(i=null),this.reloaded)for(0==this.customTable.find(".bbi-header").length&&(this.headerRowDiv=BoldBIDashboard.buildTag("div.bbi-header","",{"margin-top":"11px","margin-left":"9px","margin-right":"17px"},{}),s=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"14px",height:"25px"}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{"padding-top":"2px",position:"absolute",left:"4%","font-weight":"600"}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{"padding-top":"2px",position:"absolute",left:"42%","font-weight":"600"}),e.append(this.headerRowDiv.append(s.append(c,u)))),a=2;a<t.length;a++){var d,l=(d=t[a]).id,h=BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{}),p=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"10px",height:"25px"},{id:l}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",d.valueToFind,{"padding-top":"6px",position:"absolute",left:"4%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":d.valueToFind}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",d.valueToReplace,{"padding-top":"6px",position:"absolute",left:"42%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":d.valueToReplace}),b=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",right:"10%","padding-top":"6px"},{}),g=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),m=BoldBIDashboard.buildTag("td.bbi-deleteIcon delete-icon","",{position:"absolute",right:"4%","padding-top":"6px"},{}),f=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-toolbar-delete e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable","",{float:"right","margin-right":"0px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_delete_","data-tooltip":this.locale.dataSource.deleteContextMenu});h.append(p.append(c,u,b.append(g),m.append(f))),e.append(h),1<=(o=this.customTable.find(".bbi-replacevalues")).length?this.headerRowDiv.show():0==o.length&&this.headerRowDiv.hide(),this.scrollerRefresh(this.scrollContainer),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0),this.reloaded=!1}this.shouldAddRuleActionDiv&&2<=this.replaceValues.length&&(0==(s=this.customTable.find(".bbi-header").length)&&(this.headerRowDiv=BoldBIDashboard.buildTag("div.bbi-header","",{"margin-top":"11px","margin-left":"9px","margin-right":"17px"},{}),i=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"14px",height:"20px"}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{"padding-top":"2px",position:"absolute",left:"4%","font-weight":"600"}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{"padding-top":"2px",position:"absolute",left:"42%","font-weight":"600"}),e.append(this.headerRowDiv.append(i.append(c,u)))),s=this.replaceTextBox.val(),i=this.replaceTextBoxOne.val(),n=this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),r=this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked"),""!=s&&(d={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:s,valueToReplace:i,matchCase:n,matchEntireString:r},this.replaceValues.push(d),this.replaceTextBox.val(""),this.replaceTextBoxOne.val(""),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1}),l=d.id,h=BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{}),p=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"10px",height:"25px"},{id:l}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",s,{"padding-top":"6px",position:"absolute",left:"4%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":s}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",i,{"padding-top":"6px",position:"absolute",left:"42%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":i}),b=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",right:"10%","padding-top":"6px"},{}),g=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),m=BoldBIDashboard.buildTag("td.bbi-deleteIcon delete-icon","",{position:"absolute",right:"4%","padding-top":"6px"},{}),f=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-toolbar-delete e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable","",{float:"right","margin-right":"0px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_delete_","data-tooltip":this.locale.dataSource.deleteContextMenu}),h.append(p.append(c,u,b.append(g),m.append(f))),e.append(h),1<=(o=this.customTable.find(".bbi-replacevalues")).length?this.headerRowDiv.show():0==o.length&&this.headerRowDiv.hide(),this.scrollerRefresh(this.scrollContainer),this.shouldAddRuleActionDiv=!1,BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)),this.scrollerRefresh(this.scrollContainer))},e.prototype.handleAddRuleActionClick=function(){this.shouldAddRuleActionDiv=!0;var e=this.target;this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.updateButtonVisibility(!1),this.addRuleBtn.prop("disabled",!0),this.renderRowElement(this.customTable,this.replaceValues,e)},e.prototype.addActionButtonIcon=function(){this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_title").find("#"+this.id+"_replaceValues_dialog_backbutton").addClass("bbi-dbrd-export-titleBackIcon bbi-dbrd-icon-background-theme")},e.prototype.headerIconClick=function(e){var t=this;"back"===e.currentTarget&&setTimeout(function(){t.replaceTextBox.val(""),t.replaceTextBoxOne.val(""),t.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),t.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1}),t.addRuleBtn.prop("disabled",!0),t.editRuleTbl.hide(),t.tableRowDiv.show(),t.replaceRuleTbl.hide(),t.customRuleTableDiv.show(),t.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),t.updateButtonVisibility(!1),1<=t.customTable.find(".bbi-header").length&&t.headerRowDiv.show(),t.dashboardDesigner.element.find("#"+t.id+"_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"edit_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"editReplace_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"replace_error_icon_td").css("display","none"),t.textBox.removeClass("bbi-designer-error"),t.textBoxOne.removeClass("bbi-designer-error"),t.replaceTextBox.removeClass("bbi-designer-error"),t.replaceTextBoxOne.removeClass("bbi-designer-error")},100)},e.prototype.openReplaceValuesDialog=function(e){this.target=this.bbdesigner$(e.target),this.renderReplaceValuesDialog(),this.populateReplacingValues(this.target),e=this.queryDesigner.dataset.Id,this.replaceValues=this.replaceValues.slice(0,2);for(var t,i=this.target.closest("li").text(),a=(this.target.closest("li").attr("datatype"),this.queryDesigner.tableType),o=0;o<a.length;o++)if(i==a[o].Name){t=a[o].ID;break}this.dashboardDesigner.modules.util.doAjaxPost("POST",this.queryDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.ReplaceValuesAction,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.ReplaceValuesAction,dataSetId:e,fieldId:t,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.onReplaceValuesSuccess,this)})},e.prototype.openDataSourceReplaceValuesDialog=function(){this.renderReplaceValuesDialog(!0),this.populateReplacingValues(),this.lineDiv.hide(),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_individual_container").hide(),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog").css("min-height","175px"),this.editRuleTbl.css("height","2px"),this.valueToReplaceDiv.css("top","48%"),this.applyButton.css("right","4px"),this.cancelBtn.css("right","5px"),this.dashboardDesigner.element.find("#"+this.id+"_edit_values_textbox_sec").css("top","65%"),this.dashboardDesigner.element.find("#"+this.id+"_edit_values_textbox_1").css("top","25%"),this.replaceValues=this.replaceValues.slice(0,2);var e=this.queryDesigner.dataset.Id;this.dashboardDesigner.modules.util.doAjaxPost("POST",this.queryDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetDatasourceReplaceValuesAction,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetDatasourceReplaceValuesAction,dataSetId:e,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.onReplaceValuesSuccess,this)})},e.prototype.onReplaceValuesSuccess=function(e){var t,i,a,o;if(0!=(this.replaceValuesInfo=e).length&&!BoldBIDashboard.isNullOrUndefined(e)){for(t=this.replaceValues[0].id,i=this.replaceValues[1].id,this.replaceValues=[],a=0;a<e.length;a++)o=e[a],this.replaceValues.push({id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:o.ValueToFind,valueToReplace:" "===o.ValueToReplace?"":o.ValueToReplace,matchCase:o.ShouldMatchCase,matchEntireString:o.ShouldMatchEntireString});this.replaceValues[0].id=t,this.replaceValues[1].id=i,this.replaceValues[0].valueToFind="Null",this.replaceValues[1].valueToFind="Blanks",0<this.replaceValues.length&&this.updateReplaceValuesInfo(this.replaceValues)}},e.prototype.updateReplaceValuesInfo=function(){this.populateReplaceValuesInfo(this.replaceValues),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.populateReplaceValuesInfo=function(){for(var e,t=0;t<this.replaceValues.length;t++){var i=this.replaceValues[t].id,a=this.replaceValues[t].valueToFind,o=this.replaceValues[t].valueToReplace,i=this.table.find("#"+i),s=i.find("td:first"),i=i.find("td:nth-child(2)");s.text(a),i.text(o)}if(0<(e=Math.max(0,this.replaceValues.length-2)))for(this.reloaded=!0,t=0;t<e;t++)this.renderRowElement(this.customTable,this.replaceValues,this.target)},e.prototype.ruleUpdateMatchCaseCheckBox=function(){this.ruleMatchCaseTemp=this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.ruleUpdateMatchEntireStringCheckBox=function(){this.ruleMatchEntireStringTemp=this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.updateMatchCaseCheckBox=function(){this.matchCaseTemp=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.updateMatchEntireStringCheckBox=function(){this.matchEntireStringTemp=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.valueToFindCreate=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.editRuleValueToFindTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.editRuleValueToFindTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.textBox.val().trim()),i="",a=!0;""===t?a=!(i="Value cannot be empty"):"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number to search"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date to search"),e=this.dashboardDesigner.element.find("#"+this.id+"edit_error_icon_td"),a?(this.textBox.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.textBox.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.updateBtn.prop("disabled",""===t||!a)},e.prototype.editRuleValueToReplaceTextBox=function(){var e,t,i,a;"Null"!==this.textBox.val()&&"(Null)"!==this.textBox.val()&&"Blanks"!==this.textBox.val()&&"(Blanks)"!==this.textBox.val()&&(e=this.target.closest("li").attr("e-column-type"),BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),t=this.textBoxOne.val().trim(),a=!(i=""),"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number for replacement"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date for replacement"),e=this.dashboardDesigner.element.find("#"+this.id+"editReplace_error_icon_td"),a?(this.textBoxOne.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.textBoxOne.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.updateBtn.prop("disabled",!a))},e.prototype.valueToReplaceCreate=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.editRuleValueToReplaceTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.valueToFindCreateSec=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.addRuleValueToFindTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.valueToReplaceCreateSec=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.addRuleValueToReplaceTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.addRuleValueToFindTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.replaceTextBox.val().trim()),i="",a=!0;""===t?a=!(i="Value cannot be empty"):this.replaceValues.some(function(e){return e.valueToFind.toLowerCase()===t.toLowerCase()})?(i="The value '".concat(t,"' is already added in the custom rule for replacement"),a=!1):"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number to search"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date to search"),e=this.dashboardDesigner.element.find("#"+this.id+"_error_icon_td"),a?(this.replaceTextBox.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.replaceTextBox.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.addRuleBtn.prop("disabled",""===t||!a)},e.prototype.addRuleValueToReplaceTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.replaceTextBoxOne.val()),i="",a=!0;"number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number for replacement"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date for replacement"),e=this.dashboardDesigner.element.find("#"+this.id+"replace_error_icon_td"),a?(this.replaceTextBoxOne.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.replaceTextBoxOne.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.addRuleBtn.prop("disabled",!a)},e.prototype.ReplaceValues=function(){var e,t,i,a,o=[];for(this.replaceValues[0].valueToFind="(Null)",this.replaceValues[1].valueToFind="(Blanks)",e=0,t=this.replaceValues;e<t.length;e++)i=t[e],(a=new BoldBIDashboard.ReplaceValuesInfoForUI).ValueToFind=i.valueToFind,a.ValueToReplace=""===i.valueToReplace?" ":i.valueToReplace,a.ShouldMatchCase=i.matchCase,a.ShouldMatchEntireString=i.matchEntireString,o.push(a);return 2<this.replaceValues.length&&(this.replaceValues=this.replaceValues.slice(0,2)),o},e.prototype.ReplaceValuesDatasource=function(){var e,t,i,a,o=[];for(this.replaceValues[0].valueToFind="(Null)",this.replaceValues[1].valueToFind="(Blanks)",e=0,t=this.replaceValues;e<t.length;e++)i=t[e],(a=new BoldBIDashboard.ReplaceValuesDataSource).ValueToFind=i.valueToFind,a.ValueToReplace=""===i.valueToReplace?" ":i.valueToReplace,a.ShouldMatchCase=i.matchCase,a.ShouldMatchEntireString=i.matchEntireString,o.push(a);return 2<this.replaceValues.length&&(this.replaceValues=this.replaceValues.slice(0,2)),o},e.prototype.applyReplaceValues=function(){var e=this.ReplaceValues(),t=-1!==this.applyButton.attr("id").indexOf("_ds");this.dashboardDesigner.modules.queryDesigner.renderReplaceValuesDialog(e,t),BoldBIDashboard.isNullOrUndefined(e)||this.closeDialog(),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.applyReplaceValuesWithTimeout=function(){var e=this;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),clearTimeout(this.applyReplaceValuesTimeout),this.applyReplaceValuesTimeout=setTimeout(function(){e.applyReplaceValues()},250)},e.prototype.applyDataSourceReplaceValuesWithTimeout=function(){var e=this;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),clearTimeout(this.applyDataSourceReplaceValuesTimeout),this.applyDataSourceReplaceValuesTimeout=setTimeout(function(){e.applyDataSourceReplaceValues()},250)},e.prototype.applyDataSourceReplaceValues=function(){var e=this.ReplaceValuesDatasource(),t=-1!==this.applyButton.attr("id").indexOf("_ds");this.dashboardDesigner.modules.queryDesigner.renderReplaceValuesDialog(e,t),BoldBIDashboard.isNullOrUndefined(e)||this.closeDialog(),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.editAction=function(e){var t,i,a,o,s,n;for(this.tableRowDiv.hide(),this.customRuleTableDiv.hide(),this.editRuleTbl.show(),t=e.currentTarget.closest("tr").id,i=-1,a=0;a<this.replaceValues.length;a++)if(this.replaceValues[a].id===t){i=a;break}-1!==i&&(this.editedIndex=i,this.isEdited=!0,o=(e=this.replaceValues[i]).valueToFind,s=e.valueToReplace,n=e.matchCase,e=e.matchEntireString,this.matchCaseCheckBox.BoldBIDashboardCheckBox({checked:n}),this.matchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:e}),"(Null)"==o||"(Blanks)"==o||"Null"==o||"Blanks"==o?(this.matchCaseRow.hide(),this.textBox.attr("disabled","disabled")):(this.matchCaseRow.show(),this.textBox.removeAttr("disabled")),this.textBox.val(o="(Null)"===o?"Null":"(Blanks)"===o?"Blanks":o),this.textBoxOne.val(s),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_closebutton").hide(),this.backButton.css("display","block"),this.divDialog.data("BoldBIDashboardDialog").setTitle(this.locale.replaceValues.editRuleTitle),this.applyButton.hide(),this.cancelBtn.hide(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.resetBtn.show(),this.updateBtn.show(),this.editCancelBtn.show(),this.updateBtn.prop("disabled",!1))},e.prototype.deleteAction=function(e){for(var t=e.currentTarget.closest("tr").id,e=e.currentTarget.closest("div"),i=-1,a=0;a<this.replaceValues.length;a++)if(this.replaceValues[a].id===t){i=a;break}-1!==i&&(this.replaceValues.splice(i,1),this.customTable.find("#"+t).remove(),this.dashboardDesigner.element.find(e).remove(),this.scrollerRefresh(this.scrollContainer)),2==this.replaceValues.length?this.customTable.find(".bbi-header").remove():this.headerRowDiv.show()},e.prototype.closeRuleDialog=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.updateButtonVisibility(!1),this.replaceTextBox.val(""),this.replaceTextBoxOne.val(""),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1})},e.prototype.updateResetValue=function(){var e=this.textBox.val();"Null"===e||"(Null)"===e?this.textBoxOne.val("(Null)"):"Blanks"!==e&&"(Blanks)"!==e||this.textBoxOne.val("(Blanks)")},e.prototype.updateRule=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons();var e,t=this.textBox.val(),i=this.textBoxOne.val(),a=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),o=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked");!BoldBIDashboard.isNullOrUndefined(this.editedIndex)&&this.isEdited&&(e=this.replaceValues[this.editedIndex],BoldBIDashboard.isNullOrUndefined(e)||(e.valueToFind=t,e.valueToReplace=i,e.matchCase=a,e.matchEntireString=o,a=e.id,o=null,e=(o=("Null"===t||"(Null)"===t||"Blanks"===t||"(Blanks)"===t?this.table:this.customTable).find("#"+a)).find("td:first"),a=o.find("td:nth-child(2)"),e.text(t),a.text(i),e.attr("data-tooltip",t),a.attr("data-tooltip",i),this.editedIndex=-1))},e.prototype.editCancelAction=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons();var e=this.replaceValues[this.editedIndex],t=this.textBox.val(),t=t!==BoldBIDashboard.isNullOrUndefined?t:null,i=this.textBoxOne.val(),i=i!==BoldBIDashboard.isNullOrUndefined?i:null,a=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),o=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked");this.isEdited=!(BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(i)||""==this.textBox.val()||""==this.textBoxOne.val()||t===e.valueToFind&&i===e.valueToReplace&&a===e.matchCase&&o===e.matchEntireString),this.dashboardDesigner.element.find("#"+this.id+"_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"edit_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"editReplace_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"replace_error_icon_td").css("display","none"),this.textBox.removeClass("bbi-designer-error"),this.textBoxOne.removeClass("bbi-designer-error"),this.replaceTextBox.removeClass("bbi-designer-error"),this.replaceTextBoxOne.removeClass("bbi-designer-error")},e.prototype.customRule=function(){this.tableRowDiv.hide(),this.customRuleTableDiv.hide(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle(this.locale.replaceValues.addRuleTitle),this.replaceRuleTbl.show(),this.updateButtonVisibility(!0)},e.prototype.replaceValuesDialogButtons=function(){this.applyButton.show(),this.cancelBtn.show(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.resetBtn.hide(),this.updateBtn.hide(),this.editCancelBtn.hide()},e.prototype.updateButtonVisibility=function(e){e?(this.closeButton.hide(),this.backButton.css("display","block"),this.applyButton.hide(),this.cancelBtn.hide(),this.editCancelBtn.hide(),this.resetBtn.hide(),this.updateBtn.hide(),this.addRuleBtn.show(),this.replaceRuleCancelBtn.show()):(this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons())},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_newRule",this.bbdesigner$.proxy(this.customRule,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_ok",this.bbdesigner$.proxy(this.applyReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_ok_ds",this.bbdesigner$.proxy(this.applyDataSourceReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_editrule_btn_update",this.bbdesigner$.proxy(this.updateRule,this)),this.dashboardDesigner.element.on("click",".bbi-replace-null-blank-reset-icon",this.bbdesigner$.proxy(this.updateResetValue,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replace_values_edit_",this.bbdesigner$.proxy(this.editAction,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replace_values_delete_",this.bbdesigner$.proxy(this.deleteAction,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceRule_dialog_btn_addRule",this.bbdesigner$.proxy(this.handleAddRuleActionClick,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_newRule",this.bbdesigner$.proxy(this.customRule,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_ok",this.bbdesigner$.proxy(this.applyReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_ok_ds",this.bbdesigner$.proxy(this.applyDataSourceReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_editrule_btn_update",this.bbdesigner$.proxy(this.updateRule,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replace_values_edit_",this.bbdesigner$.proxy(this.editAction,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replace_values_delete_",this.bbdesigner$.proxy(this.deleteAction,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceRule_dialog_btn_addRule",this.bbdesigner$.proxy(this.handleAddRuleActionClick,this))},e.prototype.closeDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.divDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close(),BoldBIDashboard.isNullOrUndefined(this.replaceValues)||0===this.replaceValues.length||(this.replaceValues[0].valueToFind="Null",this.replaceValues[1].valueToFind="Blanks",this.replaceValues[0].valueToReplace="(Null)",this.replaceValues[1].valueToReplace="(Blanks)")},e.prototype.destroy=function(){this.unWireEvents()},e}(),function(e){__extends(a,t=InternalReplaceValues);var t,i=a;function a(){return null!==t&&t.apply(this,arguments)||this}e.ReplaceValues=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){t=ReplaceData,__extends(a,t);var t,i=a;function a(){return t.call(this)||this}e.ReplaceValuesInfoForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){t=DataSourceCustomizeValues,__extends(a,t);var t,i=a;function a(){return t.call(this)||this}e.ReplaceValuesDataSource=i}(BoldBIDashboard=BoldBIDashboard||{}),__spreadArray=this&&this.__spreadArray||function(e,t,i){if(i||2===arguments.length)for(var a,o=0,s=t.length;o<s;o++)!a&&o in t||((a=a||Array.prototype.slice.call(t,0,o))[o]=t[o]);return e.concat(a||Array.prototype.slice.call(t))},InternalDynamicLanguageTranslator=function(){function e(e){this.defaultLanguage="en-US",this.cultures=[],this.dashboardDesigner=e,this.id=e._id,this.bbdesigner$=e.bbdesigner$,this.locale=e.getLocalizationContent(),this.target=e.element,this.cultures=BoldBIDashboard.DashboardUtil.getCultures().filter(function(e){return"auto"!==e.Name}),this.renderDynamicLanguageTranslatorDialog(),this.unWireEvents(),this.wireEvents()}return e.prototype.renderDynamicLanguageTranslatorDialog=function(){var e=this;this.translationDialogDiv=BoldBIDashboard.buildTag("div.bbi-userselect bbi-dynamic-translation-dialog","",{},{id:this.id+"_dynamic_translation_dialog"}),this.renderBodyContainer(),this.target.append(this.translationDialogDiv),this.translationDialogDiv.BoldBIDashboardDialog({title:this.locale.translationWindow.dialogTitle,showFooter:!0,enableResize:!1,showOnInit:!1,enableModal:!0,width:"auto",height:"auto",minWidth:"1012px",minHeight:"623px",containment:"#"+this.id,target:"#"+this.id,cssClass:"boldbi-dashboarddesigner bbi-designer-dialog e-flat-mode",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.translationWindow.closeText,open:function(){e.dialogRenderedEvent()}}),this.renderFooterContainer(),this.renderGrid(),this.renderMultiSelect()},e.prototype.dialogRenderedEvent=function(){this.updateHorizontalScrollVisibility(),this.updateHeaderPadding()},e.prototype.renderBodyContainer=function(){var e=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-body-container","",{height:"526px"}),t=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-listing-container","",{display:"flex",height:"56px",margin:"24px"}),i=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-grid-container","",{height:"422px","margin-left":"24px","margin-right":"24px","margin-bottom":"24px"});this.renderTranslationGridContainer(i),this.renderLanguageListingContainer(t),e.append(t).append(i),this.translationDialogDiv.append(e)},e.prototype.renderLanguageListingContainer=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-listing-overview-container","",{width:"579px"}),i=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-language-listing-container","",{width:"254px","margin-left":"131px"});this.renderOverviewContainer(t),this.renderLanguageContainer(i),e.append(t).append(i)},e.prototype.renderOverviewContainer=function(e){var t=BoldBIDashboard.buildTag("span.bbi-dynamic-translation-listing-overview-title-container bbi-dbrd-designer-hoverable","",{height:"23px","margin-bottom":"5px","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"}),i=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-listing-overview-description-container bbi-dbrd-designer-hoverable","",{height:"33px","margin-top":"15px","text-overflow":"ellipsis",overflow:"hidden","white-space":"nowrap"});e.append(t).append(i)},e.prototype.renderLanguageContainer=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-listing-dropdown-container","",{height:"46px","margin-top":"5px"});this.renderLanguageDropDown(t),e.append(t)},e.prototype.renderLanguageDropDown=function(e){var t=BoldBIDashboard.buildTag("div","",{position:"relative","margin-left":"-11px"},{id:this.id+"_dynamic_translation_lang_dropdown_wrapper"}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-dropdowndiv","",{},{}),a=BoldBIDashboard.buildTag("input.e-dbrd-input-dropdown","",{},{id:this.id+"_dynamic_translation_lang_input_dropdown"});i.append(a),t.append(i),e.append(t)},e.prototype.renderMultiSelect=function(){ejdashboard.dropdowns.MultiSelect.Inject(ejdashboard.dropdowns.CheckBoxSelection),this.multiSelectInstance=new ejdashboard.dropdowns.MultiSelect({fields:{text:"DisplayName",value:"Name"},dataSource:this.cultures,placeholder:this.locale.translationWindow.dropdownPlaceHolder,showDropDownIcon:!0,enableSelectionOrder:!0,showSelectAll:!1,mode:"CheckBox",width:"254px",popupHeight:"250px",popupWidth:"257px",cssClass:"bbi-dbrd-control bbi-dbrd-dynamic-translator",select:this.bbdesigner$.proxy(this.addColumn,this),removed:this.bbdesigner$.proxy(this.removeColumnData,this)}),this.multiSelectInstance.appendTo("#"+this.id+"_dynamic_translation_lang_input_dropdown"),0<this.cultures.length&&(this.multiSelectInstance.value=[this.cultures[0].Name])},e.prototype.renderGrid=function(){ejdashboard.grids.Grid.Inject(ejdashboard.grids.Edit,ejdashboard.grids.Freeze,ejdashboard.grids.Clipboard),this.gridInstance=new ejdashboard.grids.Grid({dataSource:[],enableAltRow:!0,height:"400px",width:"964px",gridLines:"Both",columns:[],clipMode:"EllipsisWithTooltip",allowKeyboard:!0,allowSelection:!0,editSettings:{allowEditing:!0,allowAdding:!0,allowDeleting:!0},actionComplete:this.bbdesigner$.proxy(this.onCellSaved,this)}),this.gridInstance.appendTo("#"+this.id+"_dynamic_translation_grid_container")},e.prototype.renderTranslationGridContainer=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dynamic-translation-grid-container","",{height:"422px","margin-bottom":"5px"},{id:this.id+"_dynamic_translation_grid_container"});e.append(t)},e.prototype.renderFooterContainer=function(){var e=this.target.find("#"+this.id+"_dynamic_translation_dialog_foot"),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.translationWindow.cancelText,{float:"right"},{id:this.id+"_dynamic_translation_dialog_cancel",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.translationWindow.saveText,{float:"right","margin-left":"10px"},{id:this.id+"_dynamic_translation_dialog_save",type:"button"});e.append(i,t)},e.prototype.onCellSaved=function(e){var t,i,a,o;if("refresh"===e.requestType&&(this.updateHorizontalScrollVisibility(),this.updateHeaderPadding()),"beginEdit"===e.requestType&&(t=BoldBIDashboard.isNullOrUndefined(e.movableForm)?null:this.bbdesigner$(e.movableForm).find("input"),!BoldBIDashboard.isNullOrUndefined(t))&&0<t.length)for(i=0;i<t.length;i++)a=this.bbdesigner$(t[i]),!BoldBIDashboard.isNullOrUndefined(a)&&0<a.length&&a.attr("autoComplete","off");"save"===e.requestType&&(o=e.data,this.gridInstance.dataSource[e.rowIndex]=o,this.gridInstance.refresh())},e.prototype.addColumn=function(a){var o,s,e,n,t;if(this.gridInstance.endEdit(),a&&0<this.gridInstance.columns.length&&a.itemData.DisplayName!==BoldBIDashboard.DashboardUtil.autoformatdisplayText)if(a.itemData.Name===this.defaultLanguage)this.gridInstance.showHider.show(a.itemData.DisplayName+this.locale.translationWindow.defaultText,"headerText");else{if(o={field:a.itemData.Name,headerText:a.itemData.Name===this.defaultLanguage?a.itemData.DisplayName+this.locale.translationWindow.defaultText:a.itemData.DisplayName,type:"string",width:240,editType:"stringedit"},this.gridInstance.columns.some(function(e){return e.field===o.field})||this.gridInstance.columns.push(o),s=this.gridInstance.dataSource,Array.isArray(s))for(e=function(t){var e,i=null;a.itemData.Name===n.defaultLanguage&&(e=n.dynamicLocalization.filter(function(e){return e.entity===s[t].entity})[0],BoldBIDashboard.isNullOrUndefined(e)||(i=e.localizations.filter(function(e){return e.languageCode===a.itemData.Name})[0].value)),s[t][o.field]||(s[t][o.field]=i)},n=this,t=0;t<s.length;t++)e(t);this.updateGridColumnWidth(),this.gridInstance.refreshColumns(),this.updateFrozenColumns(),this.updateGridOverflow()}},e.prototype.updateHeaderPadding=function(){var e=this.bbdesigner$.find(".bbi-dynamic-translation-grid-container .e-gridcontent .e-content"),t=!0;!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&!BoldBIDashboard.isNullOrUndefined(e[0])&&(t=e[0].scrollHeight>e[0].clientHeight),e=this.bbdesigner$.find(".bbi-dynamic-translation-grid-container .e-gridheader"),!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&(e=this.bbdesigner$(e),t?e.attr("style","padding-right:7px !important; margin-right:0px !important"):e.attr("style","padding-right:0px !important; margin-right:-1px !important"))},e.prototype.updateHorizontalScrollVisibility=function(){var e=this.bbdesigner$.find(".bbi-dynamic-translation-grid-container .e-gridcontent .e-scrollbar");!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&(e=this.bbdesigner$(e),5<this.gridInstance.columns.length?e.attr("style","display: flex !important;"):e.attr("style","display: none !important;"),e.removeClass("e-dbrd-dynamic-scroll"))},e.prototype.updateGridOverflow=function(){var e=this.dashboardDesigner.element.find(".bbi-dynamic-translation-grid-container");!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&(0===this.gridInstance.frozenColumns||this.gridInstance.columns.length<=5?e.addClass("bbi-dynamic-translation-no-frozen-column"):e.removeClass("bbi-dynamic-translation-no-frozen-column"))},e.prototype.updateFrozenColumns=function(e){e=(e=void 0===e?!1:e)?this.gridInstance.columns.length-1:this.gridInstance.columns.length;this.gridInstance.frozenColumns=e<=3?0:3},e.prototype.updateGridColumnWidth=function(e){for(var t=(e=void 0===e?!1:e)?this.gridInstance.columns.length-1:this.gridInstance.columns.length,i=0;i<this.gridInstance.columns.length;i++)this.gridInstance.columns[i].width=t<=3?"auto":i<=2?180:4===t&&3===i?420:210},e.prototype.removeColumnData=function(t){var e,i,a;if(t.itemData.Name===this.defaultLanguage)this.gridInstance.showHider.hide(t.itemData.DisplayName+this.locale.translationWindow.defaultText,"headerText"),this.updateGridColumnWidth(!0),this.updateFrozenColumns(!0);else{for(e=this.gridInstance.dataSource,Array.isArray(e)&&e.forEach(function(e){delete e[t.itemData.Name]}),i=this.gridInstance.columns,a=0;a<i.length;a++)if(i[a].field===t.itemData.Name){i.splice(a,1);break}this.updateGridColumnWidth(),this.updateFrozenColumns()}this.updateGridOverflow(),this.gridInstance.refreshColumns(),this.gridInstance.refresh()},e.prototype.openDynamicLanguageTranslatorWindow=function(e,t,i,a,o){this.targetInstance=e,this.targetMethod=t,this.dynamicLocalization=o,this.updateTitleAndDescription(i,a),this.updateGrid(),this.translationDialogDiv.data("BoldBIDashboardDialog").open()},e.prototype.updateGrid=function(){var t,i,e,a,o=this;!BoldBIDashboard.isNullOrUndefined(this.dynamicLocalization)&&0<this.dynamicLocalization.length&&(t=[],this.dynamicLocalization[0].localizations.forEach(function(e){t.push(e.languageCode)}),this.multiSelectInstance.dataSource=this.cultures,this.multiSelectInstance.value=t,i={},this.cultures.forEach(function(e){i[e.Name]=e.DisplayName}),e=__spreadArray([{field:"entity",headerText:"Entity",type:"string",width:240,allowEditing:!1},{field:"key",headerText:"Key",type:"string",width:240,allowEditing:!1}],t.map(function(e){return{field:e,headerText:e===o.defaultLanguage?"".concat(i[e])+o.locale.translationWindow.defaultText:"".concat(i[e]),type:"string",width:1===t.length?"auto":240,allowEditing:e!==o.defaultLanguage}}),!0),a=this.dynamicLocalization.map(function(e){var t={entity:e.entity,key:e.key};return e.localizations.forEach(function(e){t[e.languageCode]=e.value}),t}),this.gridInstance.columns=e,this.gridInstance.dataSource=a,this.updateGridColumnWidth(),this.updateFrozenColumns(),this.updateGridOverflow())},e.prototype.updateTitleAndDescription=function(e,t){var i=this.bbdesigner$(".bbi-dynamic-translation-listing-overview-title-container");i.html("<b>"+e+"</b>"),i.attr("data-tooltip",e),(i=this.bbdesigner$(".bbi-dynamic-translation-listing-overview-description-container")).html(t),i.attr("data-tooltip",t)},e.prototype.getLocalization=function(){var i=this.gridInstance.columns;return this.gridInstance.dataSource.map(function(t){var e=i.filter(function(e){return"entity"!==e.field&&"key"!==e.field}).map(function(e){return{languageCode:e.field,value:t[e.field]}});return{entity:t.entity,key:t.key,localizations:e}})},e.prototype.applyClick=function(){this.gridInstance.endEdit();var e=this.getLocalization();null!==this.targetInstance&&BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[e]),this.closeDialog(null)},e.prototype.closeDialog=function(){var e=this.translationDialogDiv.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close()},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_dynamic_translation_dialog_save",this.bbdesigner$.proxy(this.applyClick,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_dynamic_translation_dialog_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_dynamic_translation_dialog_save",this.bbdesigner$.proxy(this.applyClick,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_dynamic_translation_dialog_cancel",this.bbdesigner$.proxy(this.closeDialog,this))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DynamicLanguageTranslatorDialog",InternalDynamicLanguageTranslator,window),function(){function e(e){this.id=null,this.oldVal="",this.oldExpName="",this.isAddButtonEnabled=!1,this.queryExp=[],this.expressionLength=0,this.tempExp=[],this.provider="",this.isVirtualScrollEnabled=!1,this.listContainer=null,this.expLiTag=null,this.bodyContainer=null,this.textBox=null,this.textArea=null,this.expressionContainer=null,this.addBtnTag=null,this.saveBtnTag=null,this.footerTag=null,this.expWaterMark="",this.successMessageLocale="",this.nameWaterMark="Expression Name",this.isAdd=!1,this.ejFunctionDropdown=null,this.ejColumnDropdown=null,this.ejFunctionList=null,this.ejColumnList=null,this.ejExpDialog=null,this.ejIndicator=null,this.locale=null,this.isFromQueryDesigner=!1,this.aggregationList=["SUM","COUNT","AVG","MAX","MIN","VAR","STDEV","SUMD","AVGD","COUNTD","INDEX","TOTAL","RUNNINGAVG","RUNNINGCOUNT","RUNNINGSUM","RUNNINGMAX","RUNNINGMIN","NULL"],this.rowExpression=["RUNNINGAVG","RUNNINGCOUNT","RUNNINGSUM","RUNNINGMAX","RUNNINGMIN"],this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.id=this.dashboardDesigner._id,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.provider="SQL",this.expWaterMark=this.locale.queryExpressionDialog.QueryExpression,this.successMessageLocale=this.locale.queryExpressionDialog.successMessageNotification,this.renderQueryExpression()}return e.prototype.renderQueryExpression=function(){var t=this,e=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_exp_designer"}),i=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_exp_designer_div"}),a=(e.append(i),BoldBIDashboard.buildTag("table.bbi-querydesigner-exp-table","",{},{unselectable:"on"})),o=BoldBIDashboard.buildTag("tr","",{}),s=BoldBIDashboard.buildTag("td.bbi-querydesigner-exp-separator bbi-querydesigner-exp-td","",{"font-size":"13px"},{}),n=BoldBIDashboard.buildTag("td","",{"margin-left":"12px"},{}),s=(i.append(a),a.append(o),o.append(s).append(n),a=BoldBIDashboard.buildTag("div","",{width:"175px",height:"460px"}),o=this.expressionContainer=BoldBIDashboard.buildTag("div","",{"margin-left":"10px"},{id:this.id+"_exp_designer_container_exp"}),s.append(a),n.append(o),BoldBIDashboard.buildTag("table.bbi-querydesigner-exp-table","",{width:"623px"},{unselectable:"on"})),n=BoldBIDashboard.buildTag("tr","",{width:"590px"}),r=BoldBIDashboard.buildTag("td","",{}),d=BoldBIDashboard.buildTag("label.bbi-designer-title-label",this.locale.expressionDesigner.nameText,{},{id:this.id+"_exp_designer_exp_name"}),l=BoldBIDashboard.buildTag("tr","",{width:"590px"}),h=BoldBIDashboard.buildTag("td","",{}),p=this.textBox=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox","",{height:"20px",width:"240px","margin-top":"2px","margin-bottom":"5px"},{type:"text",id:this.id+"_exp_designer_textBox",spellcheck:"false"}),d=(r.append(d),n.append(r),h.append(p),l.append(h),BoldBIDashboard.buildTag("tr","",{height:"100px",width:"590px"})),r=BoldBIDashboard.buildTag("tr","",{width:"590px"}),h=BoldBIDashboard.buildTag("td","",{}),c=BoldBIDashboard.buildTag("label.bbi-designer-title-label",this.locale.expressionDesigner.expressionText,{},{id:this.id+"_exp_designer_trgt_name"}),c=(h.append(c),r.append(h),BoldBIDashboard.buildTag("td","",{"font-size":"13px"},{})),h=this.textArea=BoldBIDashboard.buildTag("textarea.e-textarea bbi-designer-textarea","",{height:"90px",width:"593px","margin-top":"6px",overflow:"auto"},{id:this.id+"_exp_designer_textarea",spellcheck:"false"}),u=BoldBIDashboard.buildTag("tr","",{height:"255px",width:"590px"}),b=BoldBIDashboard.buildTag("td","",{}),g=BoldBIDashboard.buildTag("table.bbi-querydesigner-exp-innertable","",{height:"250px",width:"590px","margin-top":"6px","margin-bottom":"2px"}),m=BoldBIDashboard.buildTag("tr","",{height:"35px",width:"590px"}),f=BoldBIDashboard.buildTag("td","",{}),M=BoldBIDashboard.buildTag("span.bbi-designer-title-label",this.locale.expressionDesigner.functionsText,{},{}),D=BoldBIDashboard.buildTag("div","",{"margin-top":"6px",width:"210px"},{}),y=BoldBIDashboard.buildTag("input","",{"margin-top":"5px"},{id:this.id+"_exp_designer_options"}),A=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_exp_designer_option_div"}),B=BoldBIDashboard.buildTag("td","",{}),I=BoldBIDashboard.buildTag("div","",{height:"25px",margin:"25px 10px 0px -3px","border-left":"1px solid var(--querydesigner-primary-border-color)"},{}),I=(B.append(I),BoldBIDashboard.buildTag("td","",{})),P=BoldBIDashboard.buildTag("span.bbi-designer-title-label",this.locale.expressionDesigner.columnSettingsText,{"margin-left":"6px"},{}),x=BoldBIDashboard.buildTag("div","",{"margin-top":"6px",width:"199px","margin-left":"6px"},{}),_=BoldBIDashboard.buildTag("input","",{height:"35px",width:"190px"},{id:this.id+"_exp_designer_data"}),R=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_exp_designer_data_div"}),V=BoldBIDashboard.buildTag("td","",{height:"35px"}),v=BoldBIDashboard.buildTag("tr","",{width:"590px"}),C=BoldBIDashboard.buildTag("td","",{width:"210px"},{}),w=BoldBIDashboard.buildTag("td","",{}),T=BoldBIDashboard.buildTag("div","",{height:"200px",margin:"-10px 10px 0px -3px","border-left":"1px solid var(--querydesigner-primary-border-color)"},{}),T=(w.append(T),BoldBIDashboard.buildTag("td","",{width:"205px"},{})),S=BoldBIDashboard.buildTag("td","",{height:"190px"}),$=this.functionNoDataContainer=BoldBIDashboard.buildTag("div.bbi-querydesigner-function-nodata bbi-designer-empty-msg","",{width:"188px",height:"135px"},{id:this.id+"_function_nodata_container"}).text(this.locale.queryExpressionDialog.NoResultFound),k=BoldBIDashboard.buildTag("div.bbi-querydesigner-function-search","",{width:"188px"},{id:this.id+"_div_functions_search"}),N=BoldBIDashboard.buildTag("div.e-option-list","",{width:"205px","margin-top":"1px"},{}),W=this.columnNoDataContainer=BoldBIDashboard.buildTag("div.bbi-querydesigner-column-nodata bbi-designer-empty-msg","",{width:"188px",height:"135px"},{id:this.id+"_column_nodata_container"}).text(this.locale.queryExpressionDialog.NoResultFound),H=BoldBIDashboard.buildTag("div.bbi-querydesigner-column-search","",{width:"188px"},{id:this.id+"_div_columnsettings_search"}),F=BoldBIDashboard.buildTag("ul","",{},{id:this.id+"_exp_designer_option_list"}),q=BoldBIDashboard.buildTag("div.e-data-list","",{width:"199px","margin-left":"6px","margin-top":"1px"},{}),O=BoldBIDashboard.buildTag("ul","",{},{id:this.id+"_exp_designer_data_list"}),z=BoldBIDashboard.buildTag("div.bbi-designer-cursor","",{height:"200px",width:"180px","margin-right":"10px"},{id:this.id+"_cat_desc"}),j=BoldBIDashboard.buildTag("div","",{height:"5px"},{}),G=BoldBIDashboard.buildTag("div.bbi-designer-title-label","",{height:"auto"},{id:this.id+"_exp_designer_desc_heading"}),Q=BoldBIDashboard.buildTag("div","",{"text-align":"justify",height:"auto","font-size":"12px","margin-top":"8px"},{id:this.id+"_exp_designer_desc_content"}),J=BoldBIDashboard.buildTag("div","",{height:"12px"},{}),Y=BoldBIDashboard.buildTag("div.bbi-designer-title-label","",{height:"auto"},{id:this.id+"_exp_designer_example_heading"}),K=BoldBIDashboard.buildTag("div","",{float:"left","word-wrap":"break-word","margin-top":"8px",height:"auto","font-size":"12px",width:"190px"},{id:this.id+"_exp_designer_example_content"}),L=this.addBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.expressionDesigner.addText,{float:"left"},{id:this.id+"_exp_designer_add_btn",type:"button"}),X=BoldBIDashboard.buildTag("div.bbi-querydesigner-success-msg-wrap","",{display:"none"},{id:this.id+"_exp_success_message_wrap"}),Z=BoldBIDashboard.buildTag("span.bbi-querydesigner-success-message",this.successMessageLocale,{},{id:this.id+"_exp_success_message"}),ee=BoldBIDashboard.buildTag("span.bbi-querydesigner-success-message-icon","",{},{id:this.id+"_exp_success_message_icon"}),U=(this.saveBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.expressionDesigner.saveBtnText,{float:"right"},{id:this.id+"_exp_designer_save_btn",type:"button"}),BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.expressionDesigner.closeBtnText,{float:"right"},{id:this.id+"_exp_designer_close_btn",type:"button"})),E=this.bodyContainer=BoldBIDashboard.buildTag("div.e-lv e-js e-parentlv bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{width:"100%",height:a.height(),display:"block",position:"relative"},{id:this.id+"_exp_designer_bodyContainer"}),te=BoldBIDashboard.buildTag("div","",{},{}),ie=this.listContainer=BoldBIDashboard.buildTag("div.bbi-list-container e-js e-widget bbi-designer-dataset","",{"border-top-width":"1px",padding:"3px"},{id:this.id+"_div_expList"}),ae=this.expLiTag=BoldBIDashboard.buildTag("ul.e-list-hdr e-clearall","",{width:"auto",height:"auto"},{id:this.id+"_query_exp_li_container"});ie.append(ae),te.append(ie),E.append(te),a.append(E),c.append(h),d.append(c),s.append(n).append(l).append(r).append(d),m.append(V).append(f).append(B).append(I),f.append(M).append(D),D.append(y).append(A),I.append(P).append(x),x.append(_).append(R),g.append(m).append(v),b.append(g),u.append(b),s.append(u),C.append(k),C.append(N),C.append($),N.append(F),T.append(H),T.append(q),T.append(W),q.append(O),S.append(z),z.append(j).append(G).append(Q).append(J).append(Y).append(K),v.append(S).append(C).append(w).append(T),o.append(s),e.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:"310px",minHeight:"215px",title:this.locale.expressionDesigner.expressionTitleText,beforeClose:this.bbdesigner$.proxy(this.closeExpDialog,this),enableResize:!1,showOnInit:!1,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner e-query-expression",enableModal:!0,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_foot"),X.append(ee,Z),this.footerTag.append(L,U,this.saveBtnTag,X),y.BoldBIDashboardDropDownList({targetID:this.id+"_exp_designer_option_div",dataSource:[],popupHeight:"150px",minPopupWidth:"190px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-designer-drpdown-selection bbi-dbrd-control",width:"190px",height:"28px",change:this.bbdesigner$.proxy(this.renderFunctionList,this)}),_.BoldBIDashboardDropDownList({targetID:this.id+"_exp_designer_data_div",popupHeight:"150px",showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-designer-drpdown-selection bbi-dbrd-control",minPopupWidth:"190px",fields:{id:"id",text:"name"},dataSource:[],width:"190px",height:"28px",change:this.bbdesigner$.proxy(this.renderColumnList,this)}),F.BoldBIDashboardListBox({dataSource:[],height:"155px",change:this.bbdesigner$.proxy(this.optionClick,this),showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-list-selection bbi-dbrd-control",width:"190px"}),O.BoldBIDashboardListBox({dataSource:[],height:"155px",showRoundedCorner:!0,itemRequest:this.bbdesigner$.proxy(function(e){6===t.ejColumnList.dummyUl.length&&e.model.allowVirtualScrolling&&(t.ejColumnList.dummyUl=t.ejColumnList.element.children())},this),cssClass:"bbi-designer-param-assign bbi-designer-list-selection bbi-dbrd-control",width:"190px"}),L.off("click",this.bbdesigner$.proxy(this.addExpression,this)),U.off("click",this.bbdesigner$.proxy(this.closeExpression,this)),this.saveBtnTag.off("click",this.bbdesigner$.proxy(this.saveExpression,this)),L.on("click",this.bbdesigner$.proxy(this.addExpression,this)),U.on("click",this.bbdesigner$.proxy(this.closeExpression,this)),this.saveBtnTag.on("click",this.bbdesigner$.proxy(this.saveExpression,this)),E.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,height:a.height(),enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),i.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.ejFunctionDropdown=y.data("BoldBIDashboardDropDownList"),this.ejColumnDropdown=_.data("BoldBIDashboardDropDownList"),this.ejFunctionList=F.data("BoldBIDashboardListBox"),this.ejColumnList=O.data("BoldBIDashboardListBox"),this.ejExpDialog=e.data("BoldBIDashboardDialog"),this.ejIndicator=i.data("BoldBIDashboardWaitingPopup"),h.bind("change keyup paste",this.bbdesigner$.proxy(this.txtExpChanged,this)),p.bind("change keyup paste",this.bbdesigner$.proxy(this.txtNameChanged,this)),BoldBIDashboard.DashboardUtil.txtWaterMark(h,this.expWaterMark),BoldBIDashboard.DashboardUtil.txtWaterMark(p,this.nameWaterMark),this.unWiredEvents(),this.wiredEvents(),this.renderAutocomplete(k,!0),this.renderAutocomplete(H,!1)},e.prototype.closeDialog=function(){this.resetSearchBox()},e.prototype.renderAutocomplete=function(e,t){var i=BoldBIDashboard.buildTag("table.bbi-querydesigner-toolbar-table","",{width:"100%"}),a=this.bbdesigner$("<tr/>"),o=this.bbdesigner$("<td/>"),s=BoldBIDashboard.buildTag("span.e-atc e-widget","",{width:"100%",height:"28px"},{}),n=BoldBIDashboard.buildTag("span.e-in-wrap e-box e-padding bbi-designer-widget-autocomplete","",{},{}),r=this.expSearch=BoldBIDashboard.buildTag("input.bbi-autocomplete bbi-designer-widget-watermark bbi-designer-atc-boxshadow e-js e-input","",{},{type:"text",placeholder:this.locale.expressionDesigner.placeHolderText,id:t?this.id+"_function_search":this.id+"_column_search"}),d=this.expSearchIcon=BoldBIDashboard.buildTag("span.e-select bbi-designer-widget-autocomplete e-search-area","",{width:"24px",height:"30px"},{id:t?this.id+"_function_search-icon":this.id+"_column_search-icon"});d.append(BoldBIDashboard.buildTag("span.bbi-headericon bbi-designer-search","",{display:"table-cell"})),n.append(d),n.append(r),s.append(n),BoldBIDashboard.buildTag("span.e-select bbi-designer-widget-select bbi-designer-widget-autocomplete","",{height:"30px"},{id:this.id+"_column_widgetClose"}).append("<span class='bbi-headericon e-reportdesigner-widget-left'/>"),o.append(s),a.append(o),i.append(a),e.append(i),this.functionSearchBox=this.expressionContainer.find("#"+this.id+"_function_search"),this.columnSearchBox=this.expressionContainer.find("#"+this.id+"_column_search"),this.functionSearchIcon=this.expressionContainer.find(".bbi-querydesigner-function-search .bbi-headericon"),this.functionListbox=this.expressionContainer.find("#"+this.id+"_exp_designer_option_list"),this.columnSearchIcon=this.expressionContainer.find(".bbi-querydesigner-column-search .bbi-headericon"),this.columnListbox=this.expressionContainer.find("#"+this.id+"_exp_designer_data_list"),this.functionListTd=this.expressionContainer.find(".e-option-list"),this.columnListTd=this.expressionContainer.find(".e-data-list"),t?(this.expSearch.on("keyup",this.bbdesigner$.proxy(this.onSearchText,this,this.functionSearchIcon,this.functionListbox,!0)),this.expSearch.on("blur",this.bbdesigner$.proxy(this.onSearchBlur,this,this.functionSearchIcon,this.functionListbox)),this.expSearchIcon.on("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this,this.functionSearchIcon,this.functionListbox,this.expSearch,!0)),this.functionSearchBox.on("focus",this.bbdesigner$.proxy(this.onSearchTextBoxFocusIn,this,this.expressionContainer,!0)),this.functionSearchBox.on("blur",this.bbdesigner$.proxy(this.onSearchTextBoxFocusOut,this,this.expressionContainer,!0))):(this.expSearch.on("keyup",this.bbdesigner$.proxy(this.onSearchText,this,this.columnSearchIcon,this.columnListbox,!1)),this.expSearch.on("blur",this.bbdesigner$.proxy(this.onSearchBlur,this,this.columnSearchIcon,this.columnListbox)),this.expSearchIcon.on("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this,this.columnSearchIcon,this.columnListbox,this.expSearch,!1)),this.columnSearchBox.on("focus",this.bbdesigner$.proxy(this.onSearchTextBoxFocusIn,this,this.expressionContainer,!1)),this.columnSearchBox.on("blur",this.bbdesigner$.proxy(this.onSearchTextBoxFocusOut,this,this.expressionContainer,!1)))},e.prototype.onSearchTextBoxFocusIn=function(e,t){t=t?e.find(".bbi-querydesigner-function-search"):e.find(".bbi-querydesigner-column-search");t.addClass("e-focus")},e.prototype.onSearchTextBoxFocusOut=function(e,t){t=t?e.find(".bbi-querydesigner-function-search"):e.find(".bbi-querydesigner-column-search");t.hasClass("e-focus")&&t.removeClass("e-focus")},e.prototype.resetSearchBox=function(){this.resetFunction(),this.resetColumn()},e.prototype.resetFunction=function(){this.functionSearchBox.val(""),this.functionListbox.BoldBIDashboardListBox("showAllItems"),this.functionListTd.css("display","block"),this.functionNoDataContainer.css("display","none"),this.functionSearchIcon.addClass("bbi-designer-search").removeClass("bbi-designer-close")},e.prototype.resetColumn=function(){this.columnSearchBox.val(""),this.showAllItemsForListBox(this.columnListbox),this.columnListTd.css("display","block"),this.columnNoDataContainer.css("display","none"),this.columnSearchIcon.addClass("bbi-designer-search").removeClass("bbi-designer-close")},e.prototype.onSearchText=function(e,t,i,a){var o;13!==a.keyCode&&(0<(a=this.bbdesigner$(a.target).val()).length?(e.addClass("bbi-designer-close").removeClass("bbi-designer-search"),t.data("BoldBIDashboardListBox").model.allowVirtualScrolling?(t.data("BoldBIDashboardListBox").option("query",(new BoldBIDashboard.Query).where("Name",BoldBIDashboard.FilterOperators.contains,a,!0)),this.refreshColumnList(),o=this.filterItems(t.data("BoldBIDashboardListBox").model.dataSource.dataSource.json,a)):(o=this.filterItems(t.data("BoldBIDashboardListBox").model.dataSource,a),t.BoldBIDashboardListBox("hideAllItems"),t.BoldBIDashboardListBox("showItemsByIndices",o)),this.setDisplayForListElements(i,0===o.length)):(this.showAllItemsForListBox(t),this.setDisplayForListElements(i)))},e.prototype.showAllItemsForListBox=function(e){e.data("BoldBIDashboardListBox").model.allowVirtualScrolling?e.data("BoldBIDashboardListBox").option("query",new BoldBIDashboard.Query):e.BoldBIDashboardListBox("showAllItems")},e.prototype.setDisplayForListElements=function(e,t){(e?(this.functionListTd.css("display",!BoldBIDashboard.isNullOrUndefined(t)&&t?"none":"block"),this.functionNoDataContainer):(this.columnListTd.css("display",!BoldBIDashboard.isNullOrUndefined(t)&&t?"none":"block"),this.columnNoDataContainer)).css("display",!BoldBIDashboard.isNullOrUndefined(t)&&t?"block":"none")},e.prototype.onSearchBlur=function(e,t,i){0===this.bbdesigner$(i.target).val().length&&(e.addClass("bbi-designer-search").removeClass("bbi-designer-close"),this.bbdesigner$(i.target).val(""),this.showAllItemsForListBox(t))},e.prototype.onSearchCloseClick=function(e,t,i,a){i.val(""),this.showAllItemsForListBox(t),e.addClass("bbi-designer-search").removeClass("bbi-designer-close"),this.setDisplayForListElements(a),this.refreshSearchListScroller(t)},e.prototype.refreshSearchListScroller=function(e){e=e.data("BoldBIDashboardListBox");BoldBIDashboard.isNullOrUndefined(e)||e.scrollerObj.refresh()},e.prototype.filterItems=function(e,t){var i,a=[];if(!BoldBIDashboard.isNullOrUndefined(e))for(i=0;i<e.length;i++)""!==t&&-1===e[i].Name.toLowerCase().search(t.toLowerCase())||a.push(i);return a},e.prototype.enableButton=function(e,t){BoldBIDashboard.DashboardUtil.buttonEnable(e,t)},e.prototype.txtNameChanged=function(){var e=this.textBox.val(),t=this.expressionContainer.data("e-exp");e!==this.oldExpName?t&&t.isEdit&&e!==t.name||(t&&!t.isEdit||BoldBIDashboard.isNullOrUndefined(t))&&0!==e.length?this.enableButton(this.saveBtnTag,!0):this.enableButton(this.saveBtnTag,!1):(t&&t.isEdit&&e===t.name||(t&&!t.isEdit||BoldBIDashboard.isNullOrUndefined(t))&&0===e.length)&&this.enableButton(this.saveBtnTag,!1),this.oldExpName=e},e.prototype.txtExpChanged=function(){var e=this.textArea.val(),t=this.expressionContainer.data("e-exp");e!==this.oldVal||BoldBIDashboard.isNullOrUndefined(t)||!t.isEdit?(t&&t.isEdit&&e!==t.expression||t&&!t.isEdit||BoldBIDashboard.isNullOrUndefined(t))&&0!==e.length?(this.enableButton(this.saveBtnTag,!0),this.enableButton(this.addBtnTag,!1)):t.isEdit&&e===t.expression?(this.enableButton(this.addBtnTag,this.isAddButtonEnabled),this.enableButton(this.saveBtnTag,!1)):(this.enableButton(this.saveBtnTag,!1),this.enableButton(this.addBtnTag,!1)):(t&&t.isEdit&&e===t.expression||(t&&!t.isEdit||BoldBIDashboard.isNullOrUndefined(t))&&0===e.length)&&this.enableButton(this.saveBtnTag,!1),this.oldVal=e},e.prototype.updateTextArea=function(){var e=this.textArea.val();e&&0<e.length?e!==this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")&&this.textArea.removeClass("bbi-designer-txtmark"):this.textArea.val(this.expWaterMark).addClass("bbi-designer-txtmark")},e.prototype.updateTextBox=function(){var e=this.textBox.val();e&&0<e.length?e!==this.nameWaterMark&&this.textBox.hasClass("bbi-designer-txtmark")&&this.textBox.removeClass("bbi-designer-txtmark"):this.textBox.val(this.nameWaterMark).addClass("bbi-designer-txtmark")},e.prototype.addExpression=function(){this.resetSearchBox(),this.requestValidation(!0);var e=this.textBox.val();this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(e))[0]})},e.prototype.requestValidation=function(e,t){var i,a=this.expressionContainer.data("e-exp"),o=this.textArea.val().trim();a&&a.isEdit?((i=this.textBox.val())===this.nameWaterMark&&this.textBox.hasClass("bbi-designer-txtmark")&&(i=""),o===this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")&&(o=""),this.hasExpChanges(a,o)?i&&0===i.length||o&&0===o.length||!this.isValidName(i)||!/^[a-zA-Z0-9- _]*$/.test(i)?e?this.newExpression():this.expListClick(t):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.saveExpression,IconType.warning,AlertType.Confirm,!1,"",{method:"updateExpressionInfo",instance:this,dataInfo:{name:e?i:t,isSelectionChange:!e}}):e?this.switchEditExp():this.expListClick(t)):a&&!a.isEdit||BoldBIDashboard.isNullOrUndefined(a)?"Query Expression"!==o?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.saveExpression,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"clearExpression",dataInfo:e?null:{isSelectionChange:!0,name:t},instance:this}):e?this.clearExpression(!1):this.expListClick(t):e?this.newExpression():this.expListClick(t)},e.prototype.clearExpression=function(e,t){var i;BoldBIDashboard.isNullOrUndefined(t)?e?(this.isAdd=!0,this.saveExpression()):(i=this.getAvailableName(),this.textArea.val(this.expWaterMark).addClass("bbi-designer-txtmark"),this.textBox.val(i),this.updateTextBox(),this.enableButton(this.saveBtnTag,!1),this.enableButton(this.addBtnTag,!1)):e?this.saveExpression(t):(i=this.getAvailableName(),this.removeExpression(i),this.expListClick(t.name))},e.prototype.deleteEmtyExp=function(){var s=this,e=this.expLiTag.find("li"),n=null;e.each(function(e,t){for(var i=s.bbdesigner$(t).find(".e-list-text").text(),a=!0,o=0;o<s.queryExp.length;o++)if(i===s.queryExp[o].name){a=!1;break}a&&(n=s.bbdesigner$(t))}),n&&n.remove()},e.prototype.getEmptyExp=function(){var s=this,e=this.expLiTag.find("li"),n=null,r=this.bbdesigner$;return e.each(function(e,t){for(var i=r(t).find(".e-list-text").text(),a=!0,o=0;o<s.queryExp.length;o++)if(i===s.queryExp[o].name){a=!1;break}a&&(n=i)}),n},e.prototype.switchEditExp=function(){var s=this,e=this.expLiTag.find("li"),n=!0,r=this.bbdesigner$;e.each(function(e,t){for(var i=r(t).find(".e-list-text").text(),a=!0,o=0;o<s.queryExp.length;o++)if(i===s.queryExp[o].name){a=!1;break}a&&(n=!1,s.expListClick(i))}),n&&this.newExpression()},e.prototype.hasExpChanges=function(e,t){for(var i=0;i<this.queryExp.length;i++)if(this.queryExp[i].name===e.name&&-1===t.indexOf("["+this.queryExp[i].name+"]")&&(this.queryExp[i].name!==this.textBox.val()||this.queryExp[i].expression!==t))return!0;return!1},e.prototype.newExpression=function(){var e=this.getAvailableName();this.textArea.val(this.expWaterMark).addClass("bbi-designer-txtmark"),this.textBox.val(e),this.updateTextBox(),this.expressionContainer.data("e-exp",{isEdit:!1,name:""}),this.appendExpList(e),this.enableButton(this.saveBtnTag,!1),this.enableButton(this.addBtnTag,!1),this.UpdateMiscellaneousList()},e.prototype.updateExpressionInfo=function(e,t){this.textBox.val();e?t.isSelectionChange?this.expressionContainer.data("e-exp").isEdit?this.expressionValidation(ExpAction.Edit,t.isSelectionChange,t.name):this.expressionValidation(ExpAction.New,t.isSelectionChange,t.name):this.expressionValidation(ExpAction.Save):t.isSelectionChange?this.expListClick(t.name):(this.switchEditExp(),e=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(e))[0]}))},e.prototype.isValidName=function(e){for(var t=this.expressionContainer.data("e-exp"),i=0;i<this.queryExp.length;i++)if(this.queryExp[i].name===e&&(BoldBIDashboard.isNullOrUndefined(t)||t.isEdit&&t.name!==e))return!1;return!0},e.prototype.getAvailableName=function(){for(var e,t="Expression",i=[],a=0;a<this.queryExp.length;a++)i.push(this.queryExp[a].name);for(e=0;-1!==i.indexOf(t+ ++e););return t+e},e.prototype.populateExpressions=function(){if(0<this.expLiTag.children().length&&this.expLiTag.empty(),!BoldBIDashboard.isNullOrUndefined(this.queryExp)&&0<this.queryExp.length){for(var e=0;e<this.queryExp.length;e++)this.appendExpList(this.queryExp[e].name);this.enableButton(this.addBtnTag,!0)}this.scrollerRefresh(this.bodyContainer)},e.prototype.updateExpList=function(e,t){var i=BoldBIDashboard.DashboardUtil.escapeSelector(e),a=BoldBIDashboard.DashboardUtil.escapeSelector(t);this.dashboardDesigner.element.find("#"+this.id+"_li_"+a).remove(),this.dashboardDesigner.element.find("#"+this.id+"_li_"+i).unbind("click",this.bbdesigner$.proxy(this.expressionSelection,this,e)),this.dashboardDesigner.element.find("#"+this.id+"_"+i).unbind("click",this.bbdesigner$.proxy(this.removeExpression,this,e)),this.dashboardDesigner.element.find("#"+this.id+"_li_"+i+" .e-list-text").text(t),this.addTooltip(this.dashboardDesigner.element.find("#"+this.id+"_li_"+i+" .e-list-text"),t),this.dashboardDesigner.element.find("#"+this.id+"_li_"+i).attr("id",this.id+"_li_"+a),this.dashboardDesigner.element.find("#"+this.id+"_"+i).attr("id",this.id+"_"+a),this.dashboardDesigner.element.find("#"+this.id+"_li_"+a).bind("click",this.bbdesigner$.proxy(this.expressionSelection,this,t)),this.dashboardDesigner.element.find("#"+this.id+"_"+a).bind("click",this.bbdesigner$.proxy(this.removeExpression,this,t))},e.prototype.appendExpList=function(e,t){var i=BoldBIDashboard.DashboardUtil.escapeSelector(e),a=BoldBIDashboard.buildTag("li.e-user-select e-list e-state-default e-list-check bbi-designer-exp-list","",{},{id:this.id+"_li_"+i,name:e}),o=BoldBIDashboard.buildTag("a.e-chevron-right_01 bbi-remove-shadow","",{}),s=BoldBIDashboard.buildTag("span.e-list-text e-rel bbi-designer-content bbi-dbrd-designer-hoverable",e,{},{name:e});o.append(s),i=BoldBIDashboard.buildTag("div.e-chk-image e-icon e-cross-circle bbi-dbrd-designer-hoverable","",{},{id:this.id+"_"+i,"data-tooltip":"Delete"}),o.append(i),a.append(o),i.bind("click",this.bbdesigner$.proxy(this.removeExpression,this,e)),a.bind("click",this.bbdesigner$.proxy(this.expressionSelection,this,e)),a.bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseUp,this.bbdesigner$.proxy(this.onListItemMouseUp,this)),BoldBIDashboard.isNullOrUndefined(t)?this.expLiTag.append(a):0===t?(this.expLiTag.prepend(a),a.css({"border-bottom":"0.5px solid #c8c8c8"})):this.listContainer.find("ul>li:nth-child("+t+")").after(a),this.addTooltip(s,e),this.updateContainerBorder(),this.bodyContainer.height()>this.listContainer.height()?this.bodyContainer.find(".e-content").removeClass("e-content"):this.scrollerRefresh(this.bodyContainer)},e.prototype.addTooltip=function(e,t){BoldBIDashboard.DashboardUtil.textWidth(t,"12px Heebo")>=e.width()&&e.attr("data-tooltip",t)},e.prototype.onListItemMouseUp=function(e){var e=this.bbdesigner$(e.target).closest("li"),t=this.dashboardDesigner.bbdesigner$;e.hasClass("bbi-expression-user-selection-active")||(e.parent().children().each(function(){t(this).removeClass("bbi-expression-user-selection-active")}),e.addClass("bbi-expression-user-selection-active"),this.isAddButtonEnabled=void 0===this.addBtnTag.attr("disabled"))},e.prototype.expressionSelection=function(e){this.requestValidation(!1,e)},e.prototype.renderFunctionList=function(e){this.ejFunctionList.setModel({dataSource:e.value,fields:{id:"ID",text:"Name"},selectedIndex:0});e=this.ejFunctionList.getSelectedItems();this.optionClick(e[0]),this.resetFunction()},e.prototype.renderColumnList=function(e){var t=e.value;this.isVirtualScrollEnabled&&(t=new BoldBIDashboard.DataManager({json:e.value})),this.ejColumnList.setModel({dataSource:t,fields:{text:"Name",tooltipText:"Name"},enableWordWrap:!1,selectedIndex:0}),this.resetColumn(),this.refreshColumnList()},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.functionDblClick=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_option_list").data("BoldBIDashboardListBox"),t=e.model.selectedItems,e=e.model.dataSource[t],t=null;e&&("Logical"===e.CategoryName?(t=e.Name,this.caretPosition(t)):(t=e.Name+"()",this.caretPosition(t,!0,t.length),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_desc_content").text(e.Description),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_example_content").text(e.Example)))},e.prototype.columnDblClick=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_data_list").data("BoldBIDashboardListBox"),t=e.model.selectedItems,e=e.listitems[t];e&&(t=!0===e.HasDynamicParams?"@{{:"+e.Value+"}}":"["+e.Name+"]",this.caretPosition(t,!1,t.length))},e.prototype.caretPosition=function(e,t,i){var a,o,s;e&&0<e.length&&(e=-1!==e.search("RUNNING")?e.replace(")","SUM())"):e,BoldBIDashboard.isNullOrUndefined(i)||(i=-1!==e.search("RUNNING")?i+4:i),(a=this.textArea.val())!==this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")?this.textArea.removeClass("bbi-designer-txtmark"):a===this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")&&this.textArea.val(a="").removeClass("bbi-designer-txtmark"),this.textArea.focus(),s=(o=this.textArea[0]).selectionStart,s=!BoldBIDashboard.isNullOrUndefined(i)&&t?(this.textArea.val(a.substring(0,s)+e+a.substring(s)),o.selectionEnd=s+i-1):BoldBIDashboard.isNullOrUndefined(i)||t?(this.textArea.val(a.substring(0,s)+e+a.substring(s)),o.selectionEnd=s):(this.textArea.val(a.substring(0,s)+e+a.substring(s)),o.selectionEnd=s+i),this.textArea.trigger("change"))},e.prototype.optionClick=function(e){e.data&&(this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_desc_heading").text("Description"),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_example_heading").text("Example"),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_desc_content").text(e.data.Description),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_example_content").text(e.data.Example))},e.prototype.removeNestedExpression=function(e){var t,i,a,o=[];for(this.listContainer.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(e)).remove(),i=this.queryExp.length-1;0<=i;i--)(this.queryExp[i].name===e||-1<this.queryExp[i].expression.indexOf("["+e+"]"))&&(o.push(this.queryExp[i]),this.queryExp.splice(i,1));if(0<o.length)for(i=o.length-1;0<=i;i--)if(0<(t=this.removeNestedExpression(o[i].name)).length)for(a=0;a<t.length;a++)o.push(t[a]);return o},e.prototype.removeExpression=function(e){this.hasExpression(e)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.removeExpression,this.locale.dataSource.removeExpressionText,IconType.warning,AlertType.Confirm,!1,"",{dataInfo:{expressionName:e},instance:this,method:"conformDelete"}):this.conformRemoveExpression(e)},e.prototype.conformRemoveExpression=function(e){var t,i,a,o=[],s=[];if(this.listContainer.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(e)).remove(),this.updateContainerBorder(),BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||(this.queryExp=this.queryDesigner.queryExp),!BoldBIDashboard.isNullOrUndefined(this.queryExp)&&0<this.queryExp.length){for(this.expressionLength=this.queryExp.length,i=this.queryExp.length-1;0<=i;i--)if(this.queryExp[i].name===e){o.push(this.queryExp[i].name),s.push(this.queryExp[i].expression),this.queryExp.splice(i,1);break}if(t=this.removeNestedExpression(e),!BoldBIDashboard.isNullOrUndefined(t)&&0<t.length)for(i=t.length-1;0<=i;i--)o.push(t[i].name),s.push(t[i].expression);this.serverValidationExp({selectedExpression:"",name:o,expression:s},ExpAction.Remove),0<(a=this.queryExp.length)?(this.expListClick(this.queryExp[a-1].name),this.deleteEmtyExp(),this.enableButton(this.addBtnTag,!0)):0===a&&0<this.expLiTag.children().length&&this.expLiTag.empty()}0===this.expLiTag.children().length&&(a=this.getAvailableName(),this.appendExpList(a),this.textBox.val(a),this.updateTextBox(),this.textArea.val(this.expWaterMark).addClass("bbi-designer-txtmark"),this.expressionContainer.data("e-exp",{isEdit:!1,name:""}),this.enableButton(this.addBtnTag,!1)),this.scrollerRefresh(this.bodyContainer),this.UpdateMiscellaneousList(),a=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(a))[0]})},e.prototype.conformDelete=function(e,t){e&&this.conformRemoveExpression(t.expressionName)},e.prototype.hasExpression=function(e){for(var t,i,a,o=this.widgetHelper.getAllWidgets(),s=0;s<o.length;s++)if(!BoldBIDashboard.isNullOrUndefined(o[s].DataGroupInfo)&&o[s].DataGroupInfo.DataSourceID===this.dataset.Id)for(t=0;t<o[s].DataGroupInfo.FieldContainers.length;t++)for(i=o[s].DataGroupInfo.FieldContainers[t],a=0;a<i.FieldInfos.length;a++)if(e===i.FieldInfos[a].Name)return!0;return!1},e.prototype.expListClick=function(e){for(var t,i=!1,a=0;a<this.queryExp.length;a++)if(e===this.queryExp[a].name){this.textBox.val(this.queryExp[a].name),this.textArea.val(this.queryExp[a].expression),this.updateTextBox(),this.updateTextArea(),this.textArea.focus(),(t=this.textArea[0]).selectionStart=t.selectionEnd=this.queryExp[a].expression.length,this.expressionContainer.data("e-exp",{isEdit:!0,name:this.queryExp[a].name,expression:this.queryExp[a].expression}),this.enableButton(this.saveBtnTag,!(i=!0));break}i||(this.textBox.val(e),this.updateTextBox(),this.textArea.val(this.expWaterMark).addClass("bbi-designer-txtmark"),this.enableButton(this.saveBtnTag,!1),this.enableButton(this.addBtnTag,!1),this.expressionContainer.data("e-exp",null)),this.UpdateMiscellaneousList()},e.prototype.updateContainerBorder=function(){this.listContainer.css("border-top-width",0===this.listContainer.find("li").length?"0px":"1px")},e.prototype.wiredEvents=function(){this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_option_list").bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.functionDblClick,this)),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_data_list").bind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.columnDblClick,this)),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_closebutton").on("click",this.bbdesigner$.proxy(this.closeDialog,this))},e.prototype.unWiredEvents=function(){this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_option_list").unbind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.functionDblClick,this)),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_data_list").unbind(BoldBIDashboard.isTouchDevice()?"doubletap":"dblclick",this.bbdesigner$.proxy(this.columnDblClick,this)),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_closebutton").unbind("click",this.bbdesigner$.proxy(this.closeDialog,this)),BoldBIDashboard.isNullOrUndefined(this.functionSearchBox)||(this.functionSearchBox.off("keyup",this.bbdesigner$.proxy(this.onSearchText,this)),this.functionSearchBox.off("blur",this.bbdesigner$.proxy(this.onSearchBlur,this))),BoldBIDashboard.isNullOrUndefined(this.columnSearchBox)||(this.columnSearchBox.off("keyup",this.bbdesigner$.proxy(this.onSearchText,this)),this.columnSearchBox.off("blur",this.bbdesigner$.proxy(this.onSearchBlur,this))),BoldBIDashboard.isNullOrUndefined(this.expSearchIcon)||this.expSearchIcon.off("click",this.bbdesigner$.proxy(this.onSearchCloseClick,this))},e.prototype.openExpression=function(e,t,i,a){this.callBackModel=i,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.dataset=i.optionalArgs.dataset,this.ejExpDialog.open(),this.resetDesigner(!0),this.queryExp=e,this.isFromQueryDesigner=a,this.tempExp=this.bbdesigner$.extend(!0,[],e),i=new BoldBIDashboard.Dashboard.ExpressionDialogModel,a=new BoldBIDashboard.Dashboard.ExpressionHelper,i.FunctionUI={Selected:BoldBIDashboard.Dashboard.FieldName.All,State:0},i.Datasource=a.getMultipleData();var o,s,n,r,d,l,h=(i=t.beforeExpressionDialogOpen(i,"function")).Datasource,p=[],c=[];if(1<h.length){for(o=[],d=0;d<h.length;d++)o=o.concat(h[d].Value);for(o.sort(function(e,t){return e.ID>t.Name?1:t.Name>e.ID?-1:0}),s=0;s<o.length;s++)-1===c.indexOf(o[s].ID)&&(c.push(o[s].ID),p.push(o[s]));i.Datasource.unshift({ID:0,Name:BoldBIDashboard.Dashboard.FieldName.All,Value:p})}if(this.ejFunctionDropdown.setModel({fields:{id:"ID",text:"Name",value:"Value"},dataSource:i.Datasource,enabled:i.FunctionUI.State===BoldBIDashboard.Dashboard.State.Enable}),this.ejFunctionDropdown.selectItemByText(i.FunctionUI.Selected),e=new BoldBIDashboard.Dashboard.ExpressionDialogModel,a=new BoldBIDashboard.Dashboard.ExpressionHelper,e.FunctionUI={Selected:BoldBIDashboard.Dashboard.FieldName.All,State:0},i=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(t)?BoldBIDashboard.DashboardUtil.getFieldUsingTableType(this.callBackModel.optionalArgs.tableType||this.fillFieldItems(this.dataset)):this.getFields(),this.updateDashboardParameters(i),e.Datasource=a.getMultipleColumnData(i),r=[],1<(n=(e=t.beforeExpressionDialogOpen(e,"column")).Datasource).length){for(d=0;d<n.length;d++)"Parameters"!==n[d].Name&&(r=r.concat(n[d].Value));r.sort(function(e,t){return e.ID>t.ID?1:t.ID>e.ID?-1:0}),this.isVirtualScrollEnabled=100<r.length,e.Datasource.unshift({ID:0,Name:BoldBIDashboard.Dashboard.FieldName.All,Value:r})}l=this,setTimeout(function(e){l.isVirtualScrollEnabled?l.ejColumnList.setModel({allowVirtualScrolling:!0,virtualScrollMode:"continuous",itemRequestCount:100}):l.ejColumnList.option("allowVirtualScrolling",!1),l.ejColumnDropdown.setModel({fields:{id:"ID",text:"Name",value:"Value"},dataSource:e.Datasource,enabled:!0}),l.ejColumnDropdown.selectItemByText(e.FunctionUI.Selected),0<l.queryExp.length?(l.populateExpressions(),l.expListClick(l.queryExp[0].name)):l.newExpression();e=l.textBox.val();l.onListItemMouseUp({target:l.dashboardDesigner.element.find("#"+l.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(e))[0]}),l.refreshListScroller()},100,e)},e.prototype.fillFieldItems=function(e){var t=this,i=[];return e.Fields.forEach(function(e){e.IsExpression||e.IsParameterField||i.push(t.ConvertDatasetToTabletype(e))}),i},e.prototype.ConvertDatasetToTabletype=function(e){return{DataType:e.TypeName,DefaultDataType:e.TypeName,IsExpression:e.IsExpression,IsAggregatedExpression:e.IsAggregatedExpression,ID:e.Id,Name:e.Name,ChildFields:e.ChildFields}},e.prototype.getFields=function(){return BoldBIDashboard.isNullOrUndefined(this.callBackModel.optionalArgs.tableType)?this.fillFieldItems(this.dataset):this.bbdesigner$.extend(!0,[],this.callBackModel.optionalArgs.tableType)},e.prototype.updateDashboardParameters=function(s){var t,n,r,d=this,e=this.bbdesigner$.extend(!0,{},this.dataset),i=(e.Query.DashboardParameters=this.dataset.Query.DashboardParameters,[]);return i.push(e),this.dashboardDesigner.rdlParser.rdlJsonObj.DataSets.forEach(function(e){e.Id!==i[0].Id&&i.push(d.bbdesigner$.extend(!0,{},e))}),t=this,i.forEach(function(e){BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.Query)||BoldBIDashboard.isNullOrUndefined(e.Query.DashboardParameters)||(n=e.Id===d.callBackModel.optionalArgs.datasourceInfo.Id,e.Query.DashboardParameters=!n||BoldBIDashboard.isNullOrUndefined(t.queryDesigner)||BoldBIDashboard.isNullOrUndefined(t.queryDesigner.queryParamCollection)||0===t.queryDesigner.queryParamCollection.length&&!t.isFromQueryDesigner?e.Query.DashboardParameters:t.queryDesigner.queryParamCollection,r=e.Name,e.Query.DashboardParameters.forEach(function(e){var t,i,a=e.ParameterName,o=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(DynamicParameterDataType,e.DataType),o=e.DataType===DynamicParameterDataType.Number?"integer":o;switch(e.Mode){case ParameterMode.Literal:t=e.LiteralModeInfo,!BoldBIDashboard.isNullOrUndefined(t.StartValue)&&!BoldBIDashboard.isNullOrUndefined(t.EndValue)||!BoldBIDashboard.isNullOrUndefined(t.RangeStartDate)&&!BoldBIDashboard.isNullOrUndefined(t.RangeEndDate)||!BoldBIDashboard.isNullOrUndefined(t.RelativeDateItems)?(t=a+".START",i=a+".END",s.push(d.getParamItems(n?t:t+" ("+r+")",n?t:r+"."+t,o)),s.push(d.getParamItems(n?i:i+" ("+r+")",n?i:r+"."+i,o))):s.push(d.getParamItems(n?a:a+" ("+r+")",n?a:r+"."+a,o));break;case ParameterMode.List:s.push(d.getParamItems(n?a:a+" ("+r+")",n?a:r+"."+a,o))}d.addItemIntoFieldListWithIgnoreQuotesSyntax(e,n,r,s)}))}),s.push(this.getParamItems(this.locale.userParameter.fullName,"CURRENTUSER.FULLNAME","String"),this.getParamItems(this.locale.userParameter.email,"CURRENTUSER.EMAIL","String"),this.getParamItems(this.locale.userParameter.tenantURL,"CURRENT.SITEURL","String"),this.getParamItems(this.locale.defaultParameter.browserCulture,"CURRENT.BROWSERCULTURE","String")),this.dashboardDesigner.model.environment!==BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(BoldBIDashboard.Environment,BoldBIDashboard.Environment.cloud)&&s.push(this.getParamItems(this.locale.userParameter.siteIdentifier,"CURRENT.SITEIDENTIFIER","String")),s},e.prototype.addItemIntoFieldListWithIgnoreQuotesSyntax=function(e,t,i,a){var o,s,n;BoldBIDashboard.isNullOrUndefined(e)||(o=e.ParameterName,e.DataType!==DynamicParameterDataType.Date&&e.DataType!==DynamicParameterDataType.String)||(n=e.Mode===ParameterMode.Literal&&e.LiteralModeInfo.SelectionType===SelectionType.Range,e=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(DynamicParameterDataType,e.DataType),n?(n=o+".START.IGNOREQUOTES",s=o+".END.IGNOREQUOTES",a.push(this.getParamItems(t?n:n+" ("+i+")",t?n:i+"."+n,e)),a.push(this.getParamItems(t?s:s+" ("+i+")",t?s:i+"."+s,e))):(n=o+".IGNOREQUOTES",a.push(this.getParamItems(t?n:n+" ("+i+")",t?n:i+"."+n,e))))},e.prototype.getParamItems=function(e,t,i){return{Name:e,Value:t,DataType:i,IsExpression:!1,IsDynamicParam:!0}},e.prototype.refreshListScroller=function(){this.ejFunctionList.scrollerObj.model.scrollTop=0,this.ejColumnList.scrollerObj.model.scrollTop=0,this.ejFunctionList.refresh(!0),this.refreshColumnList()},e.prototype.refreshColumnList=function(){this.ejColumnList.model.allowVirtualScrolling&&(this.ejColumnList._oldStartValue=null,this.ejColumnList.model.totalItemsCount=0,this.ejColumnList.dummyUl=this.bbdesigner$()),this.ejColumnList.refresh(!0)},e.prototype.confirmAction=function(e){var t;e?(e=this.textBox.val(),(t=(new BoldBIDashboard.DashboardDesignerUtility.ExpressionParsor).parseErrors(this.textArea.val(),this.provider))&&0<t.length?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.failedToParseExp,IconType.errors,AlertType.Alert,!0,t[0]):this.isAvaliableNames(e)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpressionName,this.locale.dataSource.expNameExist,IconType.warning,AlertType.Alert,!1,""):this.serverValidationExp({selectedExpression:""===this.expressionContainer.data("e-exp").name?this.textBox.val():this.expressionContainer.data("e-exp").name,name:this.textBox.val(),expression:this.textArea.val()},ExpAction.Close)):(this.ejExpDialog.close(),this.excuteExpQuery(),this.hideExpIndicator())},e.prototype.closeConfirmation=function(){var e,t,i;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),(e=this.expressionContainer.data("e-exp"))&&e.isEdit?(t=this.textBox.val(),i=this.textArea.val().trim(),t===this.nameWaterMark&&this.textBox.hasClass("bbi-designer-txtmark")&&(t=""),i===this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")&&(i=""),!this.hasExpChanges(e,i)||t&&0===t.length||i&&0===i.length||!this.isValidName(t)||!/^[a-zA-Z0-9- _]*$/.test(t)?(this.ejExpDialog.close(),this.excuteExpQuery(),this.hideExpIndicator()):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.saveExpression,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:{name:t}})):"Query Expression"!==this.textArea.val()&&""!==this.textArea.val()?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.SaveExpression,this.locale.dataSource.saveExpression,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:{name:this.textBox.val()}}):(this.ejExpDialog.close(),this.excuteExpQuery(),this.hideExpIndicator())},e.prototype.closeExpDialog=function(e){e.isInteraction&&(this.bbdesigner$("#"+this.id+"_exp_designer_div_WaitingPopup").is(":visible")?(this.hideExpIndicator(),e.cancel=!1,this.excuteExpQuery()):(e.cancel=!0,this.closeConfirmation()))},e.prototype.closeExpression=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.resetSearchBox(),this.closeConfirmation()},e.prototype.excuteExpQuery=function(){BoldBIDashboard.DashboardUtil.isEqualObj(this.queryExp,this.tempExp)||BoldBIDashboard.DashboardUtil.invokeMethod(this.callBackModel.callBackInstance,this.callBackModel.callBackMethod,[{isWindowClose:!0,queryExp:this.queryExp}]),this.tempExp=[]},e.prototype.resetDesigner=function(e){e&&0<this.expLiTag.children().length&&(this.expLiTag.empty(),this.scrollerRefresh(this.bodyContainer)),this.textBox.val(""),this.textArea.val(""),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_desc_heading").text(""),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_example_heading").text(""),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_desc_content").text(""),this.dashboardDesigner.element.find("#"+this.id+"_exp_designer_example_content").text("")},e.prototype.saveExpression=function(e){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.resetSearchBox(),this.expressionContainer.data("e-exp")&&this.expressionContainer.data("e-exp").isEdit?e&&e.isSelectionChange?this.expressionValidation(ExpAction.Edit,e.isSelectionChange,e.name):this.expressionValidation(ExpAction.Edit):e&&e.isSelectionChange?this.expressionValidation(ExpAction.New,e.isSelectionChange,e.name):this.expressionValidation(ExpAction.New)},e.prototype.expressionValidation=function(e,t,i){var a,o,s=this.expressionContainer.data("e-exp"),n=this.textBox.val(),r=this.textArea.val().trim();this.textArea.val(r),a=!1,n===this.nameWaterMark&&this.textBox.hasClass("bbi-designer-txtmark")&&(n=""),r===this.expWaterMark&&this.textArea.hasClass("bbi-designer-txtmark")&&(r=""),BoldBIDashboard.isNullOrUndefined(n)||0!==n.length?BoldBIDashboard.isNullOrUndefined(r)||0!==r.length?this.isValidName(n)?!1===/^[a-zA-Z0-9- _]*$/.test(n)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpressionName,this.locale.dataSource.expHasSpecialChar,IconType.warning,AlertType.Alert,!1,""),a=!0):-1!==r.indexOf("["+n+"]")?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.expNotInColumn,IconType.errors,AlertType.Alert,!1,""),a=!0):this.isBalanceBrackets(r)?this.isAvaliableNames(n)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpressionName,this.locale.dataSource.expNameExist,IconType.warning,AlertType.Alert,!1,""),a=!0):(-1<r.replace(new RegExp("s"),"").toUpperCase().indexOf("TOTAL(")||this.rowExpression.some(function(e){return-1<r.replace(new RegExp("s"),"").toUpperCase().indexOf(e+"(")}))&&!this.isValidRunningExpression(r)?a=!0:/UNNEST\(STRING_TO_ARRAY\(/i.test(r)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpression,this.locale.dataSource.unnestExresssion,IconType.warning,AlertType.Alert,!1,""),this.textArea.val(""),a=!0):/FILTER\s*\(\s*WHERE/gi.test(r)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpression,this.locale.dataSource.filterWhereExpression,IconType.warning,AlertType.Alert,!1,""),this.textArea.val(""),a=!0):/ARRAY_AGG/gi.test(r)||/STRING_TO_ARRAY/gi.test(r)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpression,this.locale.dataSource.arrayTypeExpression,IconType.warning,AlertType.Alert,!1,""),this.textArea.val(""),a=!0):/COUNT\s*\(\s*DISTINCT\s*\(/i.test(r)?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpression,this.locale.dataSource.countDistinctExpression,IconType.warning,AlertType.Alert,!1,""),this.textArea.val(""),a=!0):s&&s.isEdit?(o=(new BoldBIDashboard.DashboardDesignerUtility.ExpressionParsor).parseErrors(r,this.provider))&&0<o.length?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidParameter+"(s)",o[0],IconType.errors,AlertType.Alert,!1,""):this.serverValidationExp({selectedExpression:s.name,name:n,expression:r,isSelectionChange:t,selectedExp:i},e):(o=(new BoldBIDashboard.DashboardDesignerUtility.ExpressionParsor).parseErrors(r,this.provider))&&0<o.length?(this.isAdd=!1,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidParameter+"(s)",this.locale.errorMessage.expressionParameterError,IconType.errors,AlertType.Alert,!0,o[0])):this.serverValidationExp({selectedExpression:"",name:n,expression:r,isSelectionChange:t,selectedExp:i},e):(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.invalidExpSyntax,IconType.errors,AlertType.Alert,!1,""),a=!0):(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.expNameExist,IconType.warning,AlertType.Alert,!1,""),a=!0):(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.emptyExp,IconType.warning,AlertType.Alert,!1,""),a=!0):(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidExpressionName,this.locale.dataSource.emptyExpName,IconType.warning,AlertType.Alert,!1,""),a=!0),t&&a&&this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(s.name))[0]})},e.prototype.isAvaliableNames=function(e){for(var t=this.expressionContainer.data("e-exp"),i=this.ejColumnDropdown.model.dataSource[0].Value,a=0;a<i.length;a++)if(i[a].Name.toLowerCase()===e.toLowerCase()&&t.name.toLowerCase()!==e.toLowerCase())return!0;return!1},e.prototype.isValidRunningExpression=function(e){for(var t,i,a,o,s,n,r,d,l,h=this,p=!0,c=e,u=this.ejColumnDropdown.model.dataSource[0].Value,b=0;b<u.length;b++)t=u[b].Name,-1<c.indexOf("["+t+"]")&&!0===/^[a-zA-Z0-9- _]*$/.test(t)&&(c=c.replace("["+t+"]",""));if(i=null,-1<c.replace(new RegExp("s"),"").toUpperCase().indexOf("TOTAL(")&&(i=c.replace("TOTAL","").toUpperCase().split("[+-*/]+")).forEach(function(t){h.rowExpression.some(function(e){return-1<t.indexOf(e)})&&(p=!1,h.dashboardDesigner.modules.util.alertDialog(h.locale.alertDialogTitle.queryExpression,h.locale.dataSource.errorMessageForTotalExpressionContainsRowExpression,IconType.warning,AlertType.Alert,!1,""))}),p){for(this.rowExpression.forEach(function(e){-1<c.replace(new RegExp("s"),"").toUpperCase().indexOf(e+"(")&&(i=c.toUpperCase().replace(e,"").split("[+-*/]+"))}),a=0,o=i;a<o.length;a++)for(s=o[a],p=!1,n=!isNaN(parseInt(s.replace("(","").replace(")",""),10)),r=0,d=this.aggregationList.filter(function(e){return"TOTAL"!==e||"RUNNINGSUM"!==e||"RUNNINGAVG"!==e||"RUNNINGCOUNT"!==e||"RUNNINGMAX"!==e||"RUNNINGMIN"!==e});r<d.length;r++)if(l=d[r],-1<s.toString().replace(new RegExp("s"),"").toUpperCase().indexOf(l)||n){p=!0;break}p||this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.parameterMustBeAnAggregated,IconType.warning,AlertType.Alert,!1,"")}return p},e.prototype.isBalanceBrackets=function(e){for(var t=0,i=!1,a=0;a<e.length;a++){if(i||"("!==e[a]?i||")"!==e[a]||t--:t++,t<0)return!1;"'"!==e[a]||0!==a&&"\\"===e[a-1]||(i=!i)}return!(0<t)},e.prototype.UpdateMiscellaneousList=function(){for(var e,t,i=this.ejColumnDropdown.model.dataSource[0].Value,a=this.ejColumnDropdown.model.dataSource[this.ejColumnDropdown.model.dataSource.length-1].Value,o=a.length,s=!1,n=0;n<o;n++)!function(t){var e=i.indexOf(i.filter(function(e){return e.Name===a[t].Name})[0]);-1<e&&i.splice(e,1)}(n);for(n=0;n<o;n++)a.pop();for(n=0;n<this.queryExp.length;n++){for(s=!(e={ID:i.length+n,Name:this.queryExp[n].name,Value:this.queryExp[n].expression,DataType:null}),t=0;t<i.length;t++)if(i[t].Name===e.Name){s=!0;break}s||i.push(e),a.push(e)}this.ejColumnDropdown.model.dataSource[0].Value=i,this.ejColumnDropdown.model.dataSource[this.ejColumnDropdown.model.dataSource.length-1].Value=a,this.refreshColumnList()},e.prototype.encrptDataSourceInfo=function(e){e=this.bbdesigner$.extend(!0,{},e);return e.ConnectionProperties&&(e.ConnectionProperties.ConnectString=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.ConnectString),e.ConnectionProperties.UserName&&(e.ConnectionProperties.UserName=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.UserName)),e.ConnectionProperties.PassWord)&&(e.ConnectionProperties.PassWord=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.PassWord)),e},e.prototype.serverValidationExp=function(e,t){var i=this.dataset.Name,a=this.dataset.Id,o=this.callBackModel.optionalArgs.isEdit,s=this.encrptDataSourceInfo(this.callBackModel.optionalArgs.datasourceInfo);this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.executeQuery,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.executeQuery,datasource:s,commandType:CommandMode.Text,dataSetName:i,dataSetId:a,ExpAction:t,isExpression:!0,selectedExpression:e.selectedExpression,Expression:e.name,DisplayText:e.expression,isEdit:o,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.expActionResult,this,{expression:e,action:t}),indicator:[this.bbdesigner$.proxy(this.showExpIndicator,this),this.bbdesigner$.proxy(this.hideExpIndicator,this)]},!0)},e.prototype.expActionResult=function(e,t){var i,a,o,s,n,r,d;if(t.Error)this.enableButton(this.saveBtnTag,!0),this.enableButton(this.addBtnTag,!1),BoldBIDashboard.isNullOrUndefined(t.StatusMessage)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidParameter+"(s)",this.locale.errorMessage.expressionParameterError,IconType.errors,AlertType.Alert,!1,""):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidParameter+"(s)",this.locale.errorMessage.expressionParameterError,IconType.errors,AlertType.Alert,!0,t.StatusMessage),e.expression.isSelectionChange&&this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(this.textBox.val()))[0]});else if(this.ejExpDialog.isOpen()&&t&&t.type)if(t=JSON.parse(t.type),i=this.expressionContainer.data("e-exp"),0<t.length){if(a=e.expression.name,o=e.expression.expression,e.action===ExpAction.New){if(t=!0,0===this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(a)).length)s=this.getEmptyExp(),this.updateExpList(s,a);else{for(n=!0,d=0;d<this.queryExp.length;d++)if(this.queryExp[d].name===a){n=!1;break}n||(t=!1,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryExpression,this.locale.dataSource.expNameExist,IconType.warning,AlertType.Alert,!1,""))}t&&(this.queryExp.push({name:a,expression:o}),this.expressionContainer.data("e-exp",{isEdit:!0,name:a,expression:o}),this.enableButton(this.saveBtnTag,!1),this.isAdd&&(this.switchEditExp(),r=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(r))[0]}),this.isAdd=!1),e.expression.isSelectionChange)&&(this.expListClick(e.expression.selectedExp),r=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(r))[0]}))}else if(e.action===ExpAction.Edit){for(d=0;d<this.queryExp.length;d++)-1!==this.queryExp[d].expression.indexOf("["+i.name+"]")&&(this.queryExp[d].expression=this.queryExp[d].expression.replace("["+i.name+"]","["+a+"]"));for(d=0;d<this.queryExp.length;d++)if(this.queryExp[d].name===i.name){this.queryExp[d].name=a,this.queryExp[d].expression=o,BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||BoldBIDashboard.isNullOrUndefined(this.queryDesigner.Query)||(this.queryDesigner.Query.QueryDesignerState.Expressions[d].Name=a,this.queryDesigner.Query.QueryDesignerState.Expressions[d].QueryExp=o,this.queryDesigner.dataset.Query.QueryDesignerState.Expressions[d].Name=a,this.queryDesigner.dataset.Query.QueryDesignerState.Expressions[d].QueryExp=o,this.queryDesigner.queryExp[d].name=a,this.queryDesigner.queryExp[d].expression=o,this.queryDesigner.dataset.dataset.Query.QueryDesignerState.Expressions[d].Name=a,this.queryDesigner.dataset.dataset.Query.QueryDesignerState.Expressions[d].QueryExp=o,this.queryDesigner.dataset.queryExp[d].name=a,this.queryDesigner.dataset.queryExp[d].expression=o),this.queryExp[d].name!==i.name&&this.updateExpList(i.name,a),this.expressionContainer.data("e-exp",{isEdit:!0,name:this.queryExp[d].name,expression:this.queryExp[d].expression}),this.enableButton(this.saveBtnTag,!1),e.expression.isSelectionChange&&(this.expListClick(e.expression.selectedExp),r=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(r))[0]}));break}}else if(e.action===ExpAction.Save){for(d=0;d<this.queryExp.length;d++)if(this.queryExp[d].name===i.name){this.queryExp[d].name=a,this.queryExp[d].expression=o,this.queryExp[d].name!==i.name&&this.updateExpList(i.name,a),this.enableButton(this.saveBtnTag,!1),this.switchEditExp(),r=this.textBox.val(),this.onListItemMouseUp({target:this.dashboardDesigner.element.find("#"+this.id+"_li_"+BoldBIDashboard.DashboardUtil.escapeSelector(r))[0]});break}}else if(e.action===ExpAction.Close){for(""===i.name&&this.queryExp.push({name:this.textBox.val(),expression:this.textArea.val()}),d=0;d<this.queryExp.length;d++)if(this.queryExp[d].name===i.name){this.queryExp[d].name=a,this.queryExp[d].expression=o,this.queryExp[d].name!==i.name&&this.updateExpList(i.name,a);break}this.ejExpDialog.close(),this.hideExpIndicator(),this.excuteExpQuery()}else e.action===ExpAction.Remove&&(0===this.queryExp.length?this.enableButton(this.addBtnTag,!1):this.enableButton(this.addBtnTag,!0));this.UpdateMiscellaneousList(),e.action!==ExpAction.New&&e.action!==ExpAction.Save&&e.action!==ExpAction.Edit||this.updateSuccessMessage()}else this.enableButton(this.saveBtnTag,!0)},e.prototype.updateSuccessMessage=function(){var e=this;this.dashboardDesigner.element.find("#"+this.id+"_exp_success_message_wrap").css("display","block"),setTimeout(function(){e.dashboardDesigner.element.find("#"+e.id+"_exp_success_message_wrap").css("display","none")},3e3)},e.prototype.showExpIndicator=function(){BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_add_btn"),!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_save_btn"),!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_close_btn"),!1),this.ejIndicator.show()},e.prototype.hideExpIndicator=function(){BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_add_btn"),!0),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_save_btn"),!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.children("#"+this.id+"_exp_designer_close_btn"),!0),this.ejIndicator.hide()},e.prototype.destroy=function(){this.unWiredEvents(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_exp_designer")),0<this.dashboardDesigner.element.find("#"+this.id+"_exp_designer").length&&this.dashboardDesigner.element.find("#"+this.id+"_exp_designer").remove()},e}()),ExpAction,InternalDataSample,InternalThresHold,InternalEditConnection,InternalEditorManager,InternalRangeExtractor,ExecCommand,InternalAppendDatasource,DataMode,InternalDateRangePopup,DateFormatOption,InternalExpressionParsor,InternalColumnMapping,SortType,filterOptions,CheckList,Mapping,InternalQueryFilter,QueryOperator,QueryDatatype,MeasureFilterCondition,DimensionFilterCondition,InternalQueryJoiner,InternalQueryParameter,InternalSharedDataSet,InternalToolbar,InternalCredentialDialog,ConfigurationPanel,InternalDropDownTreeview,InternalSortDialog,CustomSortType,InternalSqlEditor,SqlEditorUndoManager,InternalStoreParameter,ParameterDataInfo,OAuthProvider,InternalOAuthLoginHelper,InternalRangeFilterDialog,InternalRelativeDateFilter,InternalRelativeDates,InternalSharedDSMenu,InternalProgressIndicator,InternalReplaceValues,__extends,BoldBIDashboard,__extends=(window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.QueryExpression",InternalQueryExpression,window),function(e){e[e.New=0]="New",e[e.Edit=1]="Edit",e[e.Save=2]="Save",e[e.Close=3]="Close",e[e.Remove=4]="Remove"}(ExpAction=ExpAction||{}),InternalDataSample=function(){function e(e){this.id=null,this.locale=null,this.dataSampleDialog=null,this.dataSampleContainer=null,this.footerTag=null,this.dataSampling=!1,this.dataLimitTextBox=null,this.dataLimitValue=null,this.dataSamplingCheckBox=null,this.dashboardDesigner=e,this.bbdesigner$=e.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id,this.dataSourceLocale=this.locale.dataSource,this.renderDataSampling(),this.wireEvents()}return e.prototype.openDataSampleWindow=function(){var e=this.dataSampleDialog.data("BoldBIDashboardDialog"),t=this.dashboardDesigner.element.find("#"+this.id+"_data_limit_ok");this.dataLimitTextBox=this.dataSampleContainer.find("#"+this.id+"_datalimit_textbox"),!BoldBIDashboard.isNullOrUndefined(this.dataSampling)&&this.dataSampling?BoldBIDashboard.isNullOrUndefined(this.dataLimitValue)?(this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:"100000"}),this.dataLimitValue="100000"):(this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:this.dataLimitValue}),this.dataSamplingCheckBox.BoldBIDashboardCheckBox({checked:this.dataSampling}),this.dataLimitTextBox.data("ejNumericTextbox").enable(),t.removeAttr("disabled")):(this.dataSamplingCheckBox.BoldBIDashboardCheckBox({checked:this.dataSampling}),this.textBoxObj=this.dataLimitTextBox.data("ejNumericTextbox"),this.textBoxObj.disable()),BoldBIDashboard.isNullOrUndefined(e)||e.open()},e.prototype.renderDataSampling=function(){var e=this.dataSampleDialog=BoldBIDashboard.buildTag("div.e-data-sample-dlg","",{},{id:this.id+"_data_sample_dialog"}),t=this.dataSampleContainer=BoldBIDashboard.buildTag("div.e-dbrd-data-sample-container","",{},{id:this.id+"_data_sample_container"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_data_limit_ok",type:"button"}),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_data_limit_cancel",type:"button"});this.DataLimitContainer(),t.append(this.dataSampleContainer),e.append(t),this.bbdesigner$(this.dashboardDesigner.element).append(this.dataSampleDialog),this.dataSampleDialog.BoldBIDashboardDialog({title:"Data Sampling",width:"auto",height:"auto",minWidth:335,minHeight:220,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),containment:"#"+this.id,target:"#"+this.id,closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_data_sample_dialog_foot"),this.footerTag.append(a,i)},e.prototype.DataLimitContainer=function(){var e,t=this.locale.dataSource,i=BoldBIDashboard.buildTag("div.bbi-dbrd-data-limit-row-container","",{"padding-top":"0px","padding-bottom":"60px"},{id:this.id+"_data_limit_div"}),a=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"div.bbi-dbrd-data-sampling-row-container"}),o=BoldBIDashboard.buildTag("div.bbi-dbrd-data-sampling-label-container","",{},{id:this.id+"_data_sampling_div"}),s=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon","",{display:"block","padding-left":"110px",cursor:"pointer",position:"absolute","margin-top":"37px"},{}),s=(s.BoldBIDashboardTooltip({content:"<span>"+this.dataSourceLocale.dataSamplingMessage+"</span>",cssClass:"bbi-defaultIndex-template",isBalloon:!0,collision:BoldBIDashboard.Tooltip.Collision.FlipFit,trigger:BoldBIDashboard.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!0}),e=BoldBIDashboard.buildTag("label.bbi-dbrd-data-sampling-label",t.dataSampling,{"padding-left":"15px","font-weight":"bold","padding-top":"10px"},{id:this.id+"_data_sample_data_sampling_label"}),this.dataSamplingCheckBox=BoldBIDashboard.buildTag("input","",{height:"15px",width:"20px"},{id:this.id+"_datasampling_checkbox",type:"checkbox"}),n=BoldBIDashboard.buildTag("td","",{width:"60%",position:"absolute",padding:"30px 0px","margin-top":"5px","margin-left":"161px"},{}),a.append(o).append(n),o.append(e,s),n.append(this.dataSamplingCheckBox),o=BoldBIDashboard.buildTag("div.bbi-dbrd-data-limit-value-label-container","",{},{id:this.id+"_data_limit_div"}),e=BoldBIDashboard.buildTag("label.bbi-dbrd-data-limit-value-label",t.dataLimit,{"padding-left":"3px"},{id:this.id+"_data_sample_datalimit_label"}),o.append(e),BoldBIDashboard.buildTag("div.bbi-dbrd-data-limit-value-text-box-container","",{},{id:this.id+"_data_sample_datalimit_div"})),n=BoldBIDashboard.buildTag("td","",{"padding-top":"21px"},{}),t=BoldBIDashboard.buildTag("input.e-textbox","",{},{id:this.id+"_datalimit_textbox",type:"text",value:"100000"});n.append(t),t.ejNumericTextbox({showSpinButton:!1,decimalPlaces:0,maxValue:1e6,minValue:1,width:"160px",height:"30px",showRoundedCorner:!0,cssClass:"e-dbrd-datalimit_textbox",change:this.bbdesigner$.proxy(this.validateDataLimit,this)}),s.append(n),i.append(o).append(s),t.bind("focusout",this.bbdesigner$.proxy(this.validate,this)),this.dataSampleContainer.append(a).append(i),this.dataSamplingCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateDataSamplingCheck,this)})},e.prototype.updateDataSamplingCheck=function(e){this.updateDataSampleItemState(e.isChecked),this.dataSampling=e.isChecked},e.prototype.updateDataSampleItemState=function(e){var t=this.dashboardDesigner.element.find("#"+this.id+"_data_limit_ok");e?(this.dataLimitTextBox.data("ejNumericTextbox").enable(),t.removeAttr("disabled")):(this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:"100000"}),this.textBoxObj=this.dataLimitTextBox.data("ejNumericTextbox"),this.textBoxObj.disable())},e.prototype.validateDataLimit=function(e){var t=this.dashboardDesigner.element.find("#"+this.id+"_data_limit_ok");!BoldBIDashboard.isNullOrUndefined(e)&&e.isInteraction&&BoldBIDashboard.isNullOrUndefined(e.value)&&t.attr("disabled","disabled"),BoldBIDashboard.isNullOrUndefined(e)||!e.isInteraction||BoldBIDashboard.isNullOrUndefined(e.value)||t.removeAttr("disabled")},e.prototype.validate=function(){var e=this.dataSampleContainer.find("#"+this.id+"_datalimit_textbox");BoldBIDashboard.isNullOrUndefined(e)&&e.data("ejNumericTextbox").setModel({value:"100000"})},e.prototype.closeDataSample=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.dataSampleDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close()},e.prototype.okButtonClickEvent=function(){this.validate(this);var e=this.dataSampleContainer.find("#"+this.id+"_datalimit_textbox"),t=this.dataSampleContainer.find("#"+this.id+"_datalimit_textbox").val();e.data("ejNumericTextbox").setModel({value:t}),this.queryDesigner.updateDataSampleModelInfo(this.dataSampling,t),this.dataLimitValue=t,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.editDataSetName,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetDataLimit,dataSetId:this.queryDesigner.dataset.Id,dataSetName:this.queryDesigner.dataset.Name,dataSampling:this.dataSampling,datalimit:this.dataLimitValue,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{}),this.dataSampleDialog.data("BoldBIDashboardDialog").close(),this.queryDesigner.executeUIQuery()},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_data_limit_ok",this.bbdesigner$.proxy(this.okButtonClickEvent,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_data_limit_cancel",this.bbdesigner$.proxy(this.closeDataSample,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_data_limit_ok",this.bbdesigner$.proxy(this.okButtonClickEvent,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_data_limit_cancel",this.bbdesigner$.proxy(this.closeDataSample,this))},e.prototype.destroy=function(){this.unWireEvents()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DataSample",InternalDataSample,window),InternalThresHold=function(){function e(e){this.id=null,this.locale=null,this.thresHoldDialog=null,this.thresHoldContainer=null,this.footerTag=null,this.thresHold=!0,this.dataLimitTextBox=null,this.thresHoldDataLimitValue=null,this.thresHoldCheckBox=null,this.dashboardDesigner=e,this.bbdesigner$=e.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id,this.dataSourceLocale=this.locale.dataSource,this.renderThresHold(),this.wireEvents()}return e.prototype.openThresHoldWindow=function(){var e=this.thresHoldDialog.data("BoldBIDashboardDialog"),t=this.dashboardDesigner.element.find("#"+this.id+"_threshold_data_limit_ok");this.dataLimitTextBox=this.thresHoldContainer.find("#"+this.id+"_threshold_datalimit_textbox"),!BoldBIDashboard.isNullOrUndefined(this.thresHold)&&this.thresHold?BoldBIDashboard.isNullOrUndefined(this.thresHoldDataLimitValue)?(!BoldBIDashboard.isNullOrUndefined(this.thresHold)&&this.thresHold&&this.thresHoldCheckBox.BoldBIDashboardCheckBox({checked:this.thresHold}),this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:"5000"}),this.thresHoldDataLimitValue="5000"):(this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:this.thresHoldDataLimitValue}),this.thresHoldCheckBox.BoldBIDashboardCheckBox({checked:this.thresHold}),this.dataLimitTextBox.data("ejNumericTextbox").enable(),t.removeAttr("disabled")):(this.thresHoldCheckBox.BoldBIDashboardCheckBox({checked:this.thresHold}),this.textBoxObj=this.dataLimitTextBox.data("ejNumericTextbox"),this.textBoxObj.disable()),BoldBIDashboard.isNullOrUndefined(e)||e.open()},e.prototype.renderThresHold=function(){var e=this.thresHoldDialog=BoldBIDashboard.buildTag("div.e-data-sample-dlg","",{},{id:this.id+"_threshold_dialog"}),t=this.thresHoldContainer=BoldBIDashboard.buildTag("div.e-dbrd-data-sample-container","",{},{id:this.id+"_threshold_container"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_threshold_data_limit_ok",type:"button"}),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_threshold_data_limit_cancel",type:"button"});this.DataLimitContainer(),t.append(this.thresHoldContainer),e.append(t),this.bbdesigner$(this.dashboardDesigner.element).append(this.thresHoldDialog),this.thresHoldDialog.BoldBIDashboardDialog({title:"Threshold",width:"auto",height:"auto",minWidth:335,minHeight:220,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),containment:"#"+this.id,target:"#"+this.id,closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_threshold_dialog_foot"),this.footerTag.append(a,i)},e.prototype.DataLimitContainer=function(){var e,t=this.locale.dataSource,i=BoldBIDashboard.buildTag("div.bbi-dbrd-threshold-data-limit-row-container","",{"padding-top":"0px","padding-bottom":"60px"},{id:this.id+"threshold_data_limit_div"}),a=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"div.bbi-dbrd-data-sampling-row-container"}),o=BoldBIDashboard.buildTag("div.bbi-dbrd-threshold-label-container","",{},{id:this.id+"_threshold_div"}),s=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon","",{display:"block","padding-left":"81px",cursor:"pointer",position:"absolute","margin-top":"37px"},{}),s=(s.BoldBIDashboardTooltip({content:"<span>"+this.dataSourceLocale.thresHoldMessage+"</span>",cssClass:"bbi-defaultIndex-template",isBalloon:!0,collision:BoldBIDashboard.Tooltip.Collision.FlipFit,trigger:BoldBIDashboard.Tooltip.Trigger.Hover,showRoundedCorner:!0,showShadow:!0}),e=BoldBIDashboard.buildTag("label.bbi-dbrd-threshold-label",t.thresHold,{"padding-left":"15px","font-weight":"bold","padding-top":"10px"},{id:this.id+"_threshold_label"}),this.thresHoldCheckBox=BoldBIDashboard.buildTag("input","",{height:"15px",width:"20px"},{id:this.id+"_threshold_checkbox",type:"checkbox"}),n=BoldBIDashboard.buildTag("td","",{width:"60%",position:"absolute",padding:"30px 0px","margin-top":"5px","margin-left":"161px"},{}),a.append(o).append(n),o.append(e,s),n.append(this.thresHoldCheckBox),o=BoldBIDashboard.buildTag("div.bbi-dbrd-threshold-limit-value-label-container","",{},{id:this.id+"threshold_data_limit_div"}),e=BoldBIDashboard.buildTag("label.bbi-dbrd-threshold-limit-value-label",t.thresHoldLimit,{"padding-left":"3px"},{id:this.id+"_threshold_datalimit_label"}),o.append(e),BoldBIDashboard.buildTag("div.bbi-dbrd-threshold-limit-value-text-box-container","",{},{id:this.id+"_threshold_datalimit_div"})),n=BoldBIDashboard.buildTag("td","",{"padding-top":"21px"},{}),t=BoldBIDashboard.buildTag("input.e-textbox","",{},{id:this.id+"_threshold_datalimit_textbox",type:"text",value:"5000"});n.append(t),t.ejNumericTextbox({showSpinButton:!1,decimalPlaces:0,minValue:1,width:"160px",height:"30px",showRoundedCorner:!0,cssClass:"e-dbrd-datalimit_textbox",change:this.bbdesigner$.proxy(this.validateDataLimit,this)}),s.append(n),i.append(o).append(s),t.bind("focusout",this.bbdesigner$.proxy(this.validate,this)),this.thresHoldContainer.append(a).append(i),this.thresHoldCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updatethresHoldCheck,this)})},e.prototype.updatethresHoldCheck=function(e){this.updatethresHoldItemState(e.isChecked),this.thresHold=e.isChecked},e.prototype.updatethresHoldItemState=function(e){var t=this.dashboardDesigner.element.find("#"+this.id+"_threshold_data_limit_ok");e?(this.dataLimitTextBox.data("ejNumericTextbox").enable(),t.removeAttr("disabled")):(this.dataLimitTextBox.data("ejNumericTextbox").setModel({value:"5000"}),this.textBoxObj=this.dataLimitTextBox.data("ejNumericTextbox"),this.textBoxObj.disable())},e.prototype.validateDataLimit=function(e){var t=this.dashboardDesigner.element.find("#"+this.id+"_threshold_data_limit_ok");!BoldBIDashboard.isNullOrUndefined(e)&&e.isInteraction&&BoldBIDashboard.isNullOrUndefined(e.value)&&t.attr("disabled","disabled"),BoldBIDashboard.isNullOrUndefined(e)||!e.isInteraction||BoldBIDashboard.isNullOrUndefined(e.value)||t.removeAttr("disabled")},e.prototype.validate=function(){var e=this.thresHoldContainer.find("#"+this.id+"_threshold_datalimit_textbox");BoldBIDashboard.isNullOrUndefined(e)&&e.data("ejNumericTextbox").setModel({value:"5000"})},e.prototype.closeDataSample=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.thresHoldDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close()},e.prototype.okButtonClickEvent=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.validate(this);var e=this.thresHoldContainer.find("#"+this.id+"_threshold_datalimit_textbox"),t=this.thresHoldContainer.find("#"+this.id+"_threshold_datalimit_textbox").val();this.queryDesigner.updateThresholdModelInfo(this.thresHold,t),e.data("ejNumericTextbox").setModel({value:t}),this.thresHoldDataLimitValue=t,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.editDataSetName,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetThresHoldLimit,dataSetId:this.queryDesigner.dataset.Id,dataSetName:this.queryDesigner.dataset.Name,thresHold:this.thresHold,thresHoldDatalimit:this.thresHoldDataLimitValue,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{}),this.thresHoldDialog.data("BoldBIDashboardDialog").close()},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_threshold_data_limit_ok",this.bbdesigner$.proxy(this.okButtonClickEvent,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_threshold_data_limit_cancel",this.bbdesigner$.proxy(this.closeDataSample,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_threshold_data_limit_ok",this.bbdesigner$.proxy(this.okButtonClickEvent,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_threshold_data_limit_cancel",this.bbdesigner$.proxy(this.closeDataSample,this))},e.prototype.destroy=function(){this.unWireEvents()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ThresHold",InternalThresHold,window),InternalEditConnection=function(){function e(e){this.id=null,this.divEditor=null,this.reconnectBtnTag=null,this.updateBtnTag=null,this.updateIconTooltip=null,this.updateButtonTag=null,this.footerTag=null,this.dsNameTextBoxVal=null,this.dsDescriptionTextBoxVal=null,this.ejConTypeDrpdwn=null,this.closeBtnTag=null,this.ejIndicator=null,this.targetElement=null,this.editContainer=null,this.conTypeRow=null,this.divContainer=null,this.closeBtn=null,this.titleConfig=null,this.tableDialog=null,this.selectedOAuthConnection=null,this.schemaDetails=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id,this.datasource=this.dashboardDesigner.modules.dataSource,this.dataSourceLocale=this.locale.dataSource,this.renderEditConnection()}return e.prototype.renderEditConnection=function(){var e,t,i,a=this.dashboardDesigner.modules.util.getHeightBasedOnResolution("web");this.divEditor=BoldBIDashboard.buildTag("div.bbi-userselect","",{width:480,height:"auto"},{id:this.id+"_edit_connnection_dialog"}),this.divContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_scroller_edit_connnection_container"}),t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_edit_connnectiondialog"}),this.editContainer=BoldBIDashboard.buildTag("div","",{},{}),t.append(this.editContainer),i=BoldBIDashboard.buildTag("table.bbi-querydesigner-edit-connection-table","",{},{unselectable:"on",id:this.id+"_edit_connection_config",class:"bbi-designer-edit-connection"}),this.titleConfig=BoldBIDashboard.buildTag("div","",{"text-align":"left"},{id:this.id+"_edit_datasource_Header",class:"bbi-dbrd-designer-webds-template-wrapper bbi-designer-title-config"}),e=BoldBIDashboard.buildTag("div.bbi-designer-tile-content bbi-designer-datasource-description-maxchar",this.locale.saveDatasourceDialog.descriptionMaxLengthText,{display:"block"},{id:this.id+"_description_maxchar_exceed"}),this.divEditor.append(this.divContainer),this.divContainer.append(t),this.editContainer.append(this.titleConfig),this.editContainer.append(i),this.datasource.renderTextBoxItem(this.locale.dataSource.datasourceNameLabelTxt,this.id+"_dbname",!1,i,429),this.datasource.renderTextArea(this.locale.dataSource.datasourceDescriptionLabelTxt,this.id+"_dbdescription",i),this.divEditor.find("#"+this.id+"_dbdescription").attr({maxlength:"1024",placeholder:this.locale.dataSource.datasourceDescriptionWaterMarkTxt}),this.divEditor.find("#"+this.id+"_dbdescription").on("keyup",this.bbdesigner$.proxy(this.onDatasourceDescriptionTextBox,this)),this.divEditor.find("#"+this.id+"_dbdescription_td").append(e).css("float","left"),this.conTypeRow=BoldBIDashboard.buildTag("tr","",{},{id:this.id+"_connection_type"}),t=BoldBIDashboard.buildTag("td","",{},{unselectable:"on"}),this.conTypeRow.append(t),i.append(this.conTypeRow),e=BoldBIDashboard.buildTag("table","",{},{unselectable:"on"}),t.append(e),i=this.datasource.getRowCaption("Connection type",this.id+"_connection_type"),e.append(i),t=BoldBIDashboard.buildTag("tr","",{},{}),i=BoldBIDashboard.buildTag("td","",{},{colspan:"2",id:this.id+"_connection_type_td"}),e.append(t),e.append(i),this.ejConTypeDrpdwn=BoldBIDashboard.buildTag("input","",{},{id:this.id+"_connection_type",value:"",spellcheck:"false"}),i.append(this.ejConTypeDrpdwn),this.ejConTypeDrpdwn.BoldBIDashboardDropDownList({width:"440px",fields:{value:"value",text:"text"},change:this.bbdesigner$.proxy(this.changedConnectionType,this),cssClass:"bbi-designer-ejwidgets bbi-designer-content-label bbi-dbrd-control",showRoundedCorner:!0}),this.dashboardDesigner.element.append(this.divEditor),this.divEditor.BoldBIDashboardDialog({width:"auto",minWidth:"480px",title:this.locale.dataSource.alertboxHeaderEditConnectionText,beforeClose:this.bbdesigner$.proxy(this.closePopup,this),enableResize:!1,showOnInit:!1,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",enableModal:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.ejIndicator=this.divEditor.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup"),this.reconnectBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.editConnection.reconnect,{float:"right"},{id:this.id+"_btn_reconnect",type:"button"}),this.updateBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary bbi-dbrd-margin-left",this.locale.editConnection.update,{float:"left"},{id:this.id+"_btn_update",type:"button"}),this.updateIconTooltip=BoldBIDashboard.buildTag("span.bbi-dbrd-info-icon bbi-dbrd-designer-hoverable","",{display:"visible","margin-top":"4px",position:"absolute"},{id:this.id+"_update_button_icon","data-tooltip":this.locale.editConnection.updateIconMsg}),this.updateButtonTag=BoldBIDashboard.buildTag("div.updatebuttontag_parent","",{float:"left",display:"none"},{id:this.id+"_updatebtn_parent"}),this.updateButtonTag.append(this.updateBtnTag),this.updateButtonTag.append(this.updateIconTooltip),this.closeBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_btn_close",type:"button"}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_edit_connnection_dialog_foot"),this.footerTag.append(this.updateButtonTag,this.closeBtnTag,this.reconnectBtnTag),this.reconnectBtnTag.on("click",this.bbdesigner$.proxy(this.saveConnection,this,!0)),this.closeBtnTag.on("click",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.updateBtnTag.on("click",this.bbdesigner$.proxy(this.updateConnection,this,!0)),this.divContainer.BoldBIDashboardScroller({height:a,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.divEditor.find("#"+this.id+"_connection_type").css("display","none")},e.prototype.openEditConnectionWindow=function(e,t){var i,a;this.targetElement=this.renderConnectionDialog(),this.filePickerDialog=null,i=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInfoFromDSInfo(this.dashboardDesigner,e),this.connectionInst=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInstance(this.dashboardDesigner,i,!0),BoldBIDashboard.isNullOrUndefined(this.connectionInst)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.dashboardDesigner,"Unable to load the required connection module. Please contact Support",IconType.errors,AlertType.Alert,!1,""):(a=null,BoldBIDashboard.isNullOrUndefined(i.oAuthModel)||(a={isEdit:!1,provider:BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(OAuthProvider,i.oAuthModel.provider),service:i.oAuthModel.serviceId,serviceId:e.OAuthConnection.ServiceId}),i=this.connectionInst.updateConnectionIfRequired(e,i),this.connectionInst.edit(this.targetElement,i,e,a),this.footerTag.find("#"+this.id+"_file_alert_message").css("display",this.connectionInst.ShouldExtractData?"block":"none"),this.connectionInst.ShouldRenderInPanel&&(this.divEditor.data("BoldBIDashboardDialog").open(),e=this.dashboardDesigner.element.find("#"+this.id+"_dbname").attr("disabled","disabled"),this.dsNameTextBoxVal=e.val(t),this.dsDescriptionTextBoxVal=this.dashboardDesigner.element.find("#"+this.id+"_dbdescription").val(this.queryDesigner.dataset.Description),this.oldDsDescriptionText=this.descriptionText=this.queryDesigner.dataset.Description,this.updateDataSourceHeader(i,this.titleConfig),this.divContainer.data("BoldBIDashboardScroller").refresh(),this.scrollerRefresh(this.dashboardDesigner.element.find("#"+this.id+"_editConnection_parameters_val_parent")),this.scrollerRefresh(this.dashboardDesigner.element.find("#"+this.id+"_editConnection_headers_val_parent")),this.closeBtn=this.divEditor.parents("#"+this.id+"_edit_connnection_dialog_wrapper").find("#"+this.id+"_edit_connnection_dialog_closebutton"),this.divEditor.find("#"+this.id+"_connection_type").css("display","none")))},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.onDatasourceDescriptionTextBox=function(e){e=this.bbdesigner$(e.currentTarget).attr("id");this.descriptionText=this.divEditor.find("#"+e).val().trim()},e.prototype.getIconforEditConnection=function(e){return"CustomWeb"!==e.connector.split("_")[0]||BoldBIDashboard.isNullOrUndefined(e.icon)||""===e.icon?"<span class='bbi-dbrd-designer-webds-template-header-icon "+e.cssClass+"'></span><label class='bbi-dbrd-designer-webds-template-header-label'>"+e.name+"</label>":"<span class='bbi-dbrd-designer-webds-template-header-icon "+e.cssClass+"' style= display:inline-block;margin-bottom:4px;border-radius:3px;background:url(data:image/png;base64,"+e.icon+")no-repeat;background-position:center;background-size:contain;height:40px;width:40px></span><label class='bbi-dbrd-designer-webds-template-header-label'>"+e.name+"</label>"},e.prototype.getHelpDocLink=function(t){var e,i=helpDocumentLink.filter(function(e){return e.name===t});return 0<i.length&&void 0!==i[0]?(e=this.dashboardDesigner.model.customBrandSettings.customDomain.trim(),this.dashboardDesigner.isHelpLinkHidden&&""!==e?(e="/"===e.charAt(e.length-1)?e.substr(0,e.length-1):e)+i[0].url:"https://redirect.boldbi.com/?id="+i[0].reDirectionId):""},e.prototype.getDataSourceHeaderTemplate=function(e){var t=this.getHelpDocLink(e.connector),i=this.getIconforEditConnection(e);return BoldBIDashboard.isNullOrUndefined(t)||this.datasource.hideAPILink(e.itemType)?i:i+(this.dashboardDesigner.model.customBrandSettings.hideHelpLink?"":"<span class='bbi-dbrd-designer-webds-template-header-link' ><a class='bbi-dbrd-designer-webds-template-header-href' href='"+t+"' target='_blank'>"+e.name+" "+this.locale.dataSource.webDataSource.userGuideText+"</a></span>")},e.prototype.updateDataSourceHeader=function(e,t){t.html(this.getDataSourceHeaderTemplate(e))},e.prototype.updateConnectionType=function(e){var t=[{value:"SQL",text:this.dataSourceLocale.dataSourceType.msSql},{value:"AzureSynapseAnalytics",text:this.dataSourceLocale.dataSourceType.azuresynapseanalytics},{value:"SSAS",text:this.dataSourceLocale.dataSourceType.ssas},{value:"MySQL",text:this.dataSourceLocale.dataSourceType.mySql},{value:"ODBC",text:this.dataSourceLocale.dataSourceType.odbc},{value:"MongoDB",text:this.dataSourceLocale.dataSourceType.mongodb},{value:"Presto",text:this.dataSourceLocale.dataSourceType.presto},{value:"AmazonAuroraMySQL",text:this.dataSourceLocale.dataSourceType.amazonAuroraMySQL},{value:"Google",text:this.dataSourceLocale.oauthConnectors.googleBigQuery},{value:"AmazonAuroraPostgreSQL",text:this.dataSourceLocale.dataSourceType.amazonAuroraPostgreSQL},{value:"GoogleCloudMySQL",text:this.dataSourceLocale.dataSourceType.googleCloudMySQL},{value:"GoogleCloudPostgreSQL",text:this.dataSourceLocale.dataSourceType.googleCloudPostgreSQL},{value:"MariaDB",text:this.dataSourceLocale.dataSourceType.mariadb},{value:"SingleStore",text:this.dataSourceLocale.dataSourceType.singlestore},{value:"CDATA",text:this.dataSourceLocale.dataSourceType.cdata},{value:"PostgreSQL",text:this.dataSourceLocale.dataSourceType.postgres},{value:"Redshift",text:this.dataSourceLocale.dataSourceType.redshift},{value:"AzureDevOps",text:this.dataSourceLocale.oauthConnectors.azuredevops},{value:"Snowflake",text:this.dataSourceLocale.dataSourceType.snowflake}],i=[{value:"File",text:this.dataSourceLocale.dataSourceType.file}],a=[{value:"WEB",text:this.dataSourceLocale.dataSourceType.webDataSource.toUpperCase()}],o=[{value:"Oracle",text:this.dataSourceLocale.dataSourceType.oracle}],s=[{value:"Google",text:this.dataSourceLocale.oauthConnectors.googleBigQuery}],n=this.ejConTypeDrpdwn.data("BoldBIDashboardDropDownList");this.ejConTypeDrpdwn.data("data-source",e),e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.googleBigQuery||e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.file||e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.webDataSource.toUpperCase()||e.ConnectionProperties.DataProvider.toLowerCase()===this.dataSourceLocale.oauthConnectors.azuredevops||e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.oracle?(n.option("enabled",!1),""!==e.ProviderType&&e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.webDataSource.toUpperCase()?this.conTypeRow.css("display","none"):this.conTypeRow.css("display","block"),n.selectedTextValue!==e.ConnectionProperties.DataProvider&&(e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.oracle?n.setModel({dataSource:o}):(e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.googleBigQuery?n.setModel({dataSource:s}):n.setModel({dataSource:e.ConnectionProperties.DataProvider===this.dataSourceLocale.dataSourceType.file?i:a}),this.selectedOAuthConnection=e.OAuthConnection),n.selectItemByValue(e.ConnectionProperties.DataProvider))):(n.setModel({dataSource:t}),n.selectItemByValue(e.ConnectionProperties.DataProvider),n.option("enabled",!0))},e.prototype.changedConnectionType=function(){var e,t,i;this.targetElement=this.renderConnectionDialog(),e=this.ejConTypeDrpdwn.data("data-source"),t=this.getConnectionObj(e),BoldBIDashboard.isNullOrUndefined(t)||(i=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInstance(this.dashboardDesigner,t,!0),BoldBIDashboard.isNullOrUndefined(i))||(i.edit(this.targetElement,t,e),this.footerTag.find("#"+this.id+"_file_alert_message").css("display",i.ShouldExtractData?"block":"none"))},e.prototype.saveConnection=function(){var e;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.queryDesigner.codeViewQueryExecuter.css("display","none"),this.dsInfo=this.connectionInst.getDatasourceInfo(this.dsNameTextBoxVal.val(),this.dsDescriptionTextBoxVal.val(),null),this.queryDesigner.DatasourceInfo.Description=this.queryDesigner.dataset.Description=this.datasource.datasourceDescriptionText=this.descriptionText,this.dsInfo&&(this.dsInfo.Id=BoldBIDashboard.getGuid("Datasource_"),(e=JSON.parse(JSON.stringify(this.dsInfo))).DynamicConnectionStringInfo=null,this.connectionInst.ShouldExtractData?this.createHubConnectionCallForWebDS():this.connectionInst.LiveWithExtractMode&&!e.IsLiveWebMode?this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,datasource:this.encryptPostBack(this.dsInfo),connectionInfo:e,dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:"true"})},{fnction:this.bbdesigner$.proxy(this.reconnectSqlExtractMode,this,!0),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}):!this.connectionInst.LiveWithExtractMode&&e.IsLiveWebMode?(this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,datasource:this.encryptPostBack(this.dsInfo),connectionInfo:e,dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:"true"})},{indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}),this.createHubConnectionCallForWebDS()):this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.ReconnectDatabase,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.ReconnectDatabase,datasource:this.encryptPostBack(this.dsInfo),dataSetId:this.queryDesigner.dataset.Id,codeView:this.queryDesigner.isQueryEditorVisible(),queryEditorState:this.queryDesigner.isQueryEditorVisible(),connectionInfo:e,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.validateConnection,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}))},e.prototype.updateConnection=function(){var e;this.queryDesigner.codeViewQueryExecuter.css("display","none"),this.dsInfo=this.connectionInst.getDatasourceInfo(this.dsNameTextBoxVal.val(),this.dsDescriptionTextBoxVal.val(),null),this.dsInfo&&(this.dsInfo.Id=BoldBIDashboard.getGuid("Datasource_"),(e=JSON.parse(JSON.stringify(this.dsInfo))).DynamicConnectionStringInfo=null,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.updateParameters,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.updateParameters,datasource:this.encryptPostBack(this.dsInfo),connectionInfo:e,dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:"true"})},{indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}))},e.prototype.createHubConnectionCallForWebDS=function(){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.validateconnection,{action:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,datasource:this.encryptPostBack(this.dsInfo),dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.ajaxPolling,this),errfnction:this.bbdesigner$.proxy(this.hideIndicator,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this)]},!0,!0)},e.prototype.ajaxPolling=function(){this.dashboardDesigner.modules.ajaxPoll.ajaxPolling(this.queryDesigner.dataset.Id,{fnction:this.bbdesigner$.proxy(this.intermediateDbActionResponse,this,!0),indicator:[this.bbdesigner$.proxy(this.hideIndicator,this)]})},e.prototype.reconnectSqlExtractMode=function(e,t){"true"!==t.result&&"true"!==t||(BoldBIDashboard.isNullOrUndefined(t.jsonData)||(this.tableSelector=new BoldBIDashboard.DashboardDesignerUtility.TableSelector(this.dashboardDesigner,this.dsInfo,e,this),this.tableSelector.showDialog(JSON.parse(t.jsonData),this.connectionInst,t.table),(this.tableSelector.editConnection=this).divEditor.data("BoldBIDashboardDialog").close()),this.bbdesigner$(".bbi-query-editor .CodeMirror").each(function(e,t){t.CodeMirror.refresh()}),this.queryDesigner.DatasourceInfo.Description=this.queryDesigner.dataset.Description=this.datasource.datasourceDescriptionText=this.descriptionText,e=this.locale.toolBar,this.queryDesigner.descriptionDiv.text(""===this.datasource.datasourceDescriptionText?e.addDescription:e.editDescription))},e.prototype.intermediateDbActionResponse=function(e,t){t&&(t.Data.IgnoreSchemaFetch?this.validateConnection("true"):(this.tableSelector=new BoldBIDashboard.DashboardDesignerUtility.TableSelector(this.dashboardDesigner,this.dsInfo,e,this),this.tableSelector.showDialog(JSON.parse(t.Data),this.connectionInst),(this.tableSelector.editConnection=this).divEditor.data("BoldBIDashboardDialog").close()))},e.prototype.validateConnection=function(e){var t;"Web"===this.dsInfo.ProviderType?e&&"False"===e.RetainSchema?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.SchemaMismatch,this.locale.alertWindowMesages.columnNotExist,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:{IsRetainSchema:!1,Tables:null}}):(t=e&&"True"===e.RetainSchema?{IsRetainSchema:!0,Tables:e.SchemaAndTables}:{IsRetainSchema:!1,Tables:null},this.confirmAction(!0,t)):e&&"False"===e.RetainSchema?("Web"===this.dsInfo.ProviderType?this.locale.alertWindowMesages.differentWebSchema:this.locale.alertWindowMesages.differentSchema,this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.SchemaMismatch,this.locale.alertWindowMesages.differentSchema,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:{IsRetainSchema:!1,Tables:null}})):e&&"True"===e.RetainSchema?(t={IsRetainSchema:!0,Tables:e.SchemaAndTables},"True"===e.InvalidColumns?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.SchemaMismatch,this.locale.alertWindowMesages.columnNotExist,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:t}):"True"===e.IsDataTypeChanged?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.dataTypeMismatch,this.locale.alertWindowMesages.dataTypeMismatch,IconType.warning,AlertType.Confirm,!1,"",{height:140,width:500,method:"confirmAction",instance:this,dataInfo:t}):this.confirmAction(!0,t)):this.confirmAction(!0,t={IsRetainSchema:!1,Tables:null}),this.queryDesigner.DatasourceInfo.Description=this.queryDesigner.dataset.Description=this.datasource.datasourceDescriptionText=this.dsInfo.Description,e=this.locale.toolBar,this.queryDesigner.descriptionDiv.text(""===this.datasource.datasourceDescriptionText?e.addDescription:e.editDescription)},e.prototype.confirmAction=function(e,t){e?(this.connectionInst.LiveWithExtractMode||this.connectionInst.ShouldExtractData)&&!BoldBIDashboard.isNullOrUndefined(this.queryDesigner.DatasourceInfo.ConnectionProperties)&&BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportQuery)?this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportType!==this.locale.tableSelectorWindow.importTableText&&this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportType===this.locale.tableSelectorWindow.importQueryText?this.tableSelector.getQueryModeData(t):this.tableSelector.getTableModeData(t):!this.connectionInst.LiveWithExtractMode&&!this.connectionInst.ShouldExtractData||BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportQuery)?this.updateSchemaDetails(t):this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportType!==this.locale.tableSelectorWindow.importQueryText&&this.queryDesigner.DatasourceInfo.ConnectionProperties.ImportType===this.locale.tableSelectorWindow.importTableText?this.tableSelector.getTableModeData(t):this.tableSelector.getQueryModeData(t):(t.Tables=null,t.IsRetainSchema=!0,this.updateSchemaDetails(t),BoldBIDashboard.isNullOrUndefined(this.tableSelector)||BoldBIDashboard.isNullOrUndefined(this.tableSelector.dialog)||(this.tableSelector.dialog.close(),this.tableSelector.dispose()),BoldBIDashboard.isNullOrUndefined(this.filePickerDialog)&&this.divEditor.data("BoldBIDashboardDialog").open())},e.prototype.updateSchemaDetails=function(e){var t;this.schemaDetails=e,t=this.queryDesigner.DatasourceInfo.ConnectionProperties,!e.IsRetainSchema||this.queryDesigner.IsQueryEmpty()?(this.queryDesigner.updateNoDataInfo(),BoldBIDashboard.DashboardUtil.buttonEnable(this.queryDesigner.btnUpdateTag,!1),this.queryDesigner.previewSwitcherTag.css("display","none"),this.queryDesigner.btnUpdateTag.css("display","none"),this.connectionInst.updateDSInfo(this.queryDesigner.DatasourceInfo,this.dsInfo),e=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(this.connectionInst),this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchema,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:!BoldBIDashboard.isNullOrUndefined(this.queryDesigner.DatasourceInfo.ConnectionProperties)&&e?BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchema:BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchemaLazyLoad,datasource:this.encrptDataSourceInfo(this.queryDesigner.DatasourceInfo),dataSetId:this.queryDesigner.DatasourceInfo.Id,oldDataSourceId:this.dsInfo.Id,ReconnectWithRetainSchema:!1,viewType:"Schema",connectionInfo:t,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.updateSchemaArea,this,!1,null),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]})):(this.queryDesigner.editDataSource=!0,this.queryDesigner.saveQueryInfo(!0,!0))},e.prototype.updateSchemaInformation=function(){var e,t=this.queryDesigner.DatasourceInfo.ConnectionProperties;this.connectionInst.updateDSInfo(this.queryDesigner.DatasourceInfo,this.dsInfo),e=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(this.connectionInst),this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchema,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:!BoldBIDashboard.isNullOrUndefined(this.queryDesigner.DatasourceInfo.ConnectionProperties)&&e?BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchema:BoldBIDashboard.DashboardUtil.DesignerAction.databaseSchemaLazyLoad,datasource:this.encrptDataSourceInfo(this.queryDesigner.DatasourceInfo),dataSetId:this.queryDesigner.DatasourceInfo.Id,ReconnectWithRetainSchema:!0,Schema:BoldBIDashboard.isNullOrUndefined(this.schemaDetails.Tables)?null:this.schemaDetails.Tables,oldDataSourceId:this.dsInfo.Id,codeView:this.queryDesigner.designState(),viewType:"Schema",connectionInfo:t,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.updateSchemaArea,this,!0,this.schemaDetails.Tables),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]})},e.prototype.updateSchemaArea=function(e,t,i){var a,o,s,n,r,d;if(this.queryDesigner.isEditconnection=!0,this.queryDesigner.isEdit?(this.queryDesigner.isEdit=!1,this.queryDesigner.updateSchemaArea(i,!0),this.queryDesigner.isEdit=!0):this.queryDesigner.updateSchemaArea(i,!0),e){if(a=void 0,!BoldBIDashboard.isNullOrUndefined(t))for(a=JSON.parse(t),o=Object.keys(a),s=0;s<o.length;s++)for(n=a[o[s]],r=0;r<n.length;r++)d={schema:o[s],name:n[r]},BoldBIDashboard.isNullOrUndefined(d)||BoldBIDashboard.isNullOrUndefined(d.schema)||BoldBIDashboard.isNullOrUndefined(d.name)||this.queryDesigner.nodeTableSelector(d);this.queryDesigner.updateDataSource(a)}else this.updateParameterCollection(i);BoldBIDashboard.isNullOrUndefined(this.divEditor)||this.divEditor.data("BoldBIDashboardDialog").close(),BoldBIDashboard.isNullOrUndefined(this.tableSelector)||BoldBIDashboard.isNullOrUndefined(this.tableSelector.dialog)||(this.tableSelector.hideIndicator(),this.tableSelector.dialog.close(),this.tableSelector.dispose()),BoldBIDashboard.isNullOrUndefined(this.filePickerDialog)||(this.filePickerDialog.closeDialog(),this.filePickerDialog=null)},e.prototype.updateParameterCollection=function(e){var t=this.queryDesigner.dataset.Id,i=this.dashboardDesigner.modules.dataSet.datasets.filter(function(e){return e.Id===t})[0];BoldBIDashboard.isNullOrUndefined(i)?BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.parameterInfo)||(this.queryDesigner.queryParamCollection=JSON.parse(e.parameterInfo)):(this.queryDesigner.queryParamCollection=i.Query.DashboardParameters,this.removeDataSourceParameter(i.Query.DashboardParameters))},e.prototype.removeDataSourceParameter=function(e){var t;0<e.length&&((t=this.dashboardDesigner.modules.dynamicParameterPanel).queryDesigner=this.queryDesigner,e.filter(function(e){return e.Mode===ParameterMode.List&&!BoldBIDashboard.isNullOrUndefined(e.ListModeInfo.DataColumn)}).forEach(function(e){t.deleteParameterFromService(e.ParameterID)}))},e.prototype.encryptPostBack=function(e){e=this.bbdesigner$.extend(!0,{},e);return e.ConnectionString=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionString),e.Username=BoldBIDashboard.DashboardUtil.encryptData(e.Username),e.Password=BoldBIDashboard.DashboardUtil.encryptData(e.Password),e},e.prototype.encrptDataSourceInfo=function(e){e=this.bbdesigner$.extend(!0,{},e);return e.ConnectionProperties&&(e.ConnectionProperties.ConnectString=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.ConnectString),e.ConnectionProperties.UserName&&(e.ConnectionProperties.UserName=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.UserName)),e.ConnectionProperties.PassWord)&&(e.ConnectionProperties.PassWord=BoldBIDashboard.DashboardUtil.encryptData(e.ConnectionProperties.PassWord)),e},e.prototype.renderConnectionDialog=function(){var e=null,t=this.dashboardDesigner.element.find("#"+this.id+"_connection_datasource");return t.hasClass("connectionClass")&&(t.remove(),t.removeClass("connectionClass")),t.hasClass("connectionClass")||((e=BoldBIDashboard.buildTag("div","",{width:"100%",height:"auto","margin-left":"8px"},{id:this.id+"_connection_datasource"})).addClass("connectionClass"),this.editContainer.append(e)),e},e.prototype.getConnectionObj=function(e){var t=null;return t=BoldBIDashboard.isNullOrUndefined(e)||(t=BoldBIDashboard.DashboardDesignerUtility.DataSourceTypes.getDataSourceTypeObject(e.ConnectionProperties.DataProvider),BoldBIDashboard.isNullOrUndefined(e.OAuthConnection))||""===e.OAuthConnection?t:BoldBIDashboard.DashboardDesignerUtility.DataSourceTypes.getDataSourceTypeObject(e.OAuthConnection.service||e.OAuthConnection.Service)},e.prototype.closeDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.divEditor.data("BoldBIDashboardDialog").close(),BoldBIDashboard.isNullOrUndefined(this.queryDesigner.dataset)||(this.queryDesigner.dataset.Description=this.oldDsDescriptionText),this.queryDesigner.resetConnectionOnEditConnectionCancel()},e.prototype.closePopup=function(e){!BoldBIDashboard.isNullOrUndefined(this.closeBtn)&&this.closeBtn.hasClass("e-close-disable")?e.cancel=!0:(this.dashboardDesigner.element.find(".bbi-daterange-popup:visible").css("display","none"),this.dashboardDesigner.element.find(".e-multiselect-popup-container").css("display","none"))},e.prototype.showIndicator=function(){!BoldBIDashboard.isNullOrUndefined(this.divEditor)&&this.divEditor.data("BoldBIDashboardDialog").isOpen()?(this.footerTag.css("opacity",".5").attr("disabled","disabled"),BoldBIDashboard.DashboardUtil.buttonEnable(this.reconnectBtnTag,!1),BoldBIDashboard.DashboardUtil.buttonEnable(this.closeBtnTag,!1),BoldBIDashboard.isNullOrUndefined(this.closeBtn)||this.closeBtn.addClass("e-close-disable").css({cursor:"default",opacity:"0.3"}),this.ejIndicator.show()):BoldBIDashboard.isNullOrUndefined(this.tableDialog)||this.tableDialog.wrapper.data("BoldBIDashboardWaitingPopup").show()},e.prototype.hideIndicator=function(){!BoldBIDashboard.isNullOrUndefined(this.divEditor)&&this.divEditor.data("BoldBIDashboardDialog").isOpen()?(this.footerTag.css("opacity","1").removeAttr("disabled"),BoldBIDashboard.DashboardUtil.buttonEnable(this.reconnectBtnTag,!0),BoldBIDashboard.DashboardUtil.buttonEnable(this.closeBtnTag,!0),BoldBIDashboard.isNullOrUndefined(this.closeBtn)||this.closeBtn.removeClass("e-close-disable").css({cursor:"pointer",opacity:"1"}),this.ejIndicator.hide()):BoldBIDashboard.isNullOrUndefined(this.tableDialog)||this.bbdesigner$("#"+this.id+"_table_selector_dialog_wrapper").data("BoldBIDashboardWaitingPopup").hide()},e.prototype.setInfo=function(e,t,i,a,o){this.dsInfo=e,this.tableDialog=i,this.tableSelector=a,this.filePickerDialog=o},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.EditConnection",InternalEditConnection,window),InternalEditorManager=function(){function e(e,t){this.rangeExtractor=null,this.actionList=null,this.tempCollection=null,this.textRange=null,this.targetWindow=null,this.next=null,this.end=null,this.current=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.targetWindow=t,this.rangeExtractor=new BoldBIDashboard.DashboardDesignerUtility.RangeExtractor(e),this.updateData(),this.actionList=["fontname","forecolor","backgroundcolor","fontsize","fontstyle","fontweight","textdecoration"]}return e.prototype.updateData=function(){var e=Array();e.push({Key:"fontname",Value:{tag:null,css:"font-family",result:"span",removeCSS:{"font-family":""},attr:"e-textrun-fontfamily",styleParent:"span"}}),e.push({Key:"forecolor",Value:{tag:null,css:"color",result:"span",removeCSS:{color:""},attr:"e-textrun-fontcolor",styleParent:"span"}}),e.push({Key:"backgroundcolor",Value:{tag:null,css:"background-color",result:"span",removeCSS:{"background-color":""},attr:"e-textrun-backgroundcolor",styleParent:"span"}}),e.push({Key:"fontsize",Value:{tag:null,css:"font-size",result:"span",removeCSS:{"font-size":""},attr:"e-textrun-fontsize",styleParent:"span"}}),e.push({Key:"fontstyle",Value:{tag:null,css:"font-style",result:"span",removeCSS:{"font-style":""},attr:"e-textrun-fontstyle",styleParent:"span"}}),e.push({Key:"fontweight",Value:{tag:null,css:"font-weight",result:"span",removeCSS:{"font-weight":""},attr:"e-textrun-fontweight",styleParent:"span"}}),e.push({Key:"textdecoration",Value:{tag:null,css:"text-decoration",result:"span",removeCSS:{"text-decoration":""},attr:"e-textrun-textdecoration",styleParent:"span"}}),e.push({Key:"format",Value:{tag:null,data:"format",result:"span",removeAttr:{format:null},styleParent:"span"}}),e.push({Key:"link",Value:{tag:null,data:"link",result:"span",removeAttr:{link:null},styleParent:"span"}}),this.tempCollection=e},e.prototype.execCommand=function(e,t,i){switch(this.textRange=i,e){case ExecCommand.Fontname:this.cssFormatProcess("fontname",t);break;case ExecCommand.Forecolor:this.cssFormatProcess("forecolor",t);break;case ExecCommand.Backgroundcolor:this.cssFormatProcess("backgroundcolor",t);break;case ExecCommand.Fontsize:this.cssFormatProcess("fontsize",t);break;case ExecCommand.Fontstyle:this.cssFormatProcess("fontstyle",t);break;case ExecCommand.Fontweight:this.cssFormatProcess("fontweight",t);break;case ExecCommand.Textdecoration:this.cssFormatProcess("textdecoration",t);break;case ExecCommand.TextAlign:this.setTextAlign(t);break;case ExecCommand.Padding:this.setPadding(t);break;case ExecCommand.TextFormat:this.cssFormatProcess("format",t);break;case ExecCommand.TextLink:this.cssFormatProcess("link",t)}},e.prototype.cssFormatProcess=function(e,t){var i,a,o,s,n,r=this.rangeExtractor.getNodeCollection(this.textRange),d=null,l=null,h=null;if(!this.validateSelectedNode(r)){for(a=0;a<r.length;a++){if(o=r[a],(i=this.validateFormat(o,e)).status)for(s=0;s<i.Info.length;s++)n=i.Info[s].node,this.validateStyleData(n,this.getFormatData(e).Value.css,t)||(h=this.removeFormat(i,e,s));(h="format"===e.toLowerCase()||"link"===e.toLowerCase()?this.applyTextFormat(o,e,t):this.applyFormat(o,e,t))&&(1===r.length?l=d=h:0===a?d=h:l=a===r.length-1?h:null)}this.refreshRange(d,l),this.focus()}},e.prototype.setPadding=function(e){this.onApplyParagraphValue(e.side,e.value)},e.prototype.setTextAlign=function(e){this.onApplyParagraphValue("text-align",e)},e.prototype.onApplyParagraphValue=function(e,t){for(var i=this.getExactSelectedNode(this.textRange),a=this.getSelectedParent(i),o=0;o<a.length;o++)a[o].css(e,t);this.refreshRange(this.textRange.startContainer,this.textRange.endContainer),this.focus()},e.prototype.focus=function(){var e=this;setTimeout(function(){e.targetWindow.focus()},100)},e.prototype.removeFormat=function(e,t,i){var a,o,e=this.getFormatedTagOrder(e.Info,i),i=e[0].currentNode.slice(e[0].currentNode.length-1),s=document.createElement("span");return e[0].currentNode=e[0].currentNode.slice(0,e[0].currentNode.length-1),0<(a=this.splitNode(i[0])).rightSide.length&&this.bbdesigner$(this.bbdesigner$(e[0].node.cloneNode(!1)).append(a.rightSide)).insertAfter(e[0].node),o=null,e[0].tag?(this.rangeExtractor.cursorBasedCollection&&!e[0].textNode.data.trim().length?this.bbdesigner$(s).append(i).insertAfter(this.bbdesigner$(e[0].node)):this.bbdesigner$(i).insertAfter(e[0].node),o=e[0].textNode,this.rangeExtractor.cursorBasedCollection&&this.setCursorOnNode(o,e[0].textNode)):((o=this.bbdesigner$(e[0].node.cloneNode(!1))).css(this.getFormatData(t).Value.removeCSS),(!this.rangeExtractor.validateTextNode(o[0])&&o[0].getAttribute("style")?this.bbdesigner$(o.append(i)):this.bbdesigner$(i)).insertAfter(e[0].node),o=i),0<e[0].currentNode.length&&this.formateChildNodes(e[0].currentNode,t,e[0].node),a.leftSide.length<1&&this.bbdesigner$(e[0].node).remove(),o[0]||o},e.prototype.formateChildNodes=function(e,t,i){for(var a={rightSide:[],leftSide:[]},o=e.length-1;0<=o;o--)0<(a=this.splitNode(e[o])).rightSide.length&&this.bbdesigner$(this.bbdesigner$(i.cloneNode(!1)).append(a.rightSide)).insertAfter(e[o]),a.leftSide.length&&this.bbdesigner$(this.bbdesigner$(i.cloneNode(!1)).append(a.leftSide.reverse())).insertBefore(e[o])},e.prototype.refreshRange=function(e,t){var i=null,a=null;this.rangeExtractor&&(i=this.rangeExtractor.cursorData.node,a=this.rangeExtractor.cursorData.offSet),this.rangeExtractor.cursorBasedCollection&&i&&-1<a?(a=this.rangeExtractor.validateTextNode(i)?a>i.data.length?i.data.length:a:0,this.rangeExtractor.validateTextNode(i)&&!i.data.trim()&&(i.data=String.fromCharCode(65279)+i.data,a++),this.updateCursor(i,a)):e&&t&&(e.data&&!e.data.trim()&&-1===e.data.indexOf(String.fromCharCode(65279))&&(e.data=String.fromCharCode(65279)+e.data),t.data&&!t.data.trim()&&-1===t.data.indexOf(String.fromCharCode(65279))&&(t.data=String.fromCharCode(65279)),(i=(window.getSelection?window:document).getSelection()).removeAllRanges(),this.textRange.setStart(e,0),this.textRange.setEnd(t,t.data?t.data.length:0),i.addRange(this.textRange))},e.prototype.updateCursor=function(e,t){var i=(window.getSelection?window:document).getSelection();this.textRange.setStart(e,t),this.textRange.setEnd(e,t),i.removeAllRanges(),i.addRange(this.textRange)},e.prototype.generateRange=function(e){var t=e.commonAncestorContainer;this.next=e.startContainer!==t||this.isTextNode(e.startContainer)?this.getStartEndElement(e.startContainer,t):e.startContainer.childNodes[e.startOffset],this.end=e.endContainer!==t||this.isTextNode(e.endContainer)?this.bbdesigner$(this.getStartEndElement(e.endContainer,t)).hasClass("bbi-label-element")?null:this.getStartEndElement(e.endContainer,t).nextSibling:e.endContainer.childNodes[e.endOffset]},e.prototype.setCursorOnNode=function(e,t){this.rangeExtractor.cursorData.node===e&&(this.rangeExtractor.cursorData.node=t)},e.prototype.traverse=function(e){for(var t,i,a=this;t=a.next!==(a.isTextNode(a.textRange.endContainer)?a.textRange.endContainer.parentNode.nextSibling:a.textRange.endContainer.nextElementSibling)&&a.textRange.endContainer.parentNode.nextSibling!==a.next?(a.current=a.next,a.next=a.current&&a.current.nextSibling!==a.targetWindow.find("span#endRange")[0]&&a.current.nextSibling!==(BoldBIDashboard.isNullOrUndefined(a.end)?a.textRange.endContainer.nextSibling:a.end)?a.current.nextSibling:null,a.current):null;)if(a.hasSubNodes())a.getSubtree(a.textRange),a.traverse(e);else{if(i=t,!this.bbdesigner$(a.textRange.startContainer).hasClass("bbi-label-element")&&null===a.next&&i!==a.textRange.endContainer)for(;BoldBIDashboard.isNullOrUndefined(a.next)&&!BoldBIDashboard.isNullOrUndefined(i);)i=i.parentNode,BoldBIDashboard.isNullOrUndefined(i)||a.current.nextSibling===a.targetWindow.find("span#endRange")[0]||(a.next=i.nextSibling);e(t)}return t},e.prototype.getSelectedParent=function(e){for(var t,i=[],a=0;a<e.length;a++)t=e[a].closest("p"),BoldBIDashboard.isNullOrUndefined(t)||i.push(t);return i},e.prototype.applyFormat=function(e,t,i){var a=this.splitNode(e),o=e,s=this.getFormatData(t).Value,n=i?s.css+":"+i+";":s.css;return this.bbdesigner$(e.parentNode).hasClass("bbi-dbrd-label-parameter-text")&&(e=e.parentNode),0<a.leftSide.length&&!this.rangeExtractor.validateTextNode(a.leftSide[0])&&(this.tagCheck(a.leftSide[0],t)||this.compareCss(a.leftSide[0],n))?this.bbdesigner$(a.leftSide[0]).append(e):0<a.rightSide.length&&!this.rangeExtractor.validateTextNode(a.rightSide[0])&&(this.tagCheck(a.rightSide[0],t)||this.compareCss(a.rightSide[0],n))?this.bbdesigner$(a.rightSide[0]).prepend(e):a.leftSide.length<1&&a.rightSide.length<1&&this.bbdesigner$(e.parentNode).is(s.styleParent)?i?this.bbdesigner$(e.parentNode).css(s.css,i):this.bbdesigner$(e.parentNode).css(this.collectStyleData(s.css)):(t=document.createElement(s.result),this.rangeExtractor.cursorBasedCollection?(n=document.createElement("span"),this.rangeExtractor.validateTextNode(e)?(!this.bbdesigner$(t).is("span")&&this.rangeExtractor.noContent?this.bbdesigner$(n).append(t):n=t,t.appendChild(o=document.createTextNode(e.data)),this.rangeExtractor.cursorBasedCollection&&this.setCursorOnNode(e,o),this.bbdesigner$(e).replaceWith(n)):(t.innerHTML="&#65279;",this.bbdesigner$(n).append(t),e.firstChild&&this.bbdesigner$(e.firstChild).is("br")?this.bbdesigner$(n).insertBefore(e.firstChild):this.bbdesigner$(e).append(n),this.rangeExtractor.cursorBasedCollection&&this.setCursorOnNode(e,t.firstChild),o=t)):(t.appendChild(o=document.createTextNode(e.data)),this.bbdesigner$(e).replaceWith(t)),i&&this.bbdesigner$(t).css(s.css,i)),o},e.prototype.applyTextFormat=function(e,t,i){var a=this.splitNode(e),o=e,s=document.createElement("span");return a.leftSide.length&&3!==a.leftSide[0].nodeType&&(this.tagCheck(a.leftSide[0],t)||this.compareTypeValue(t,a.leftSide[0],i?this.getFormatData(t).Value.data+":"+i+";":this.getFormatData(t).Value.data))?this.bbdesigner$(a.leftSide[0]).append(e):a.rightSide.length&&!this.rangeExtractor.validateTextNode(a.rightSide[0])&&(this.tagCheck(a.rightSide[0],t)||this.compareTypeValue(t,a.rightSide[0],i?this.getFormatData(t).Value.data+":"+i+";":this.getFormatData(t).Value.data))?this.bbdesigner$(a.rightSide[0]).prepend(e):a.leftSide.length||a.rightSide.length||!this.bbdesigner$(e.parentNode).is(this.getFormatData(t).Value.styleParent)?(a=document.createElement(this.getFormatData(t).Value.result),this.rangeExtractor.cursorBasedCollection?this.rangeExtractor.validateTextNode(e)?(!this.bbdesigner$(a).is("span")&&this.rangeExtractor.noContent?this.bbdesigner$(s).append(a):s=a,a.appendChild(o=document.createTextNode(e.data)),this.rangeExtractor.cursorBasedCollection&&this.setCursorOnNode(e,o),this.bbdesigner$(e).replaceWith(s)):(a.innerHTML="&#65279;",this.bbdesigner$(s).append(a),e.firstChild&&this.bbdesigner$(e.firstChild).is("br")?this.bbdesigner$(s).insertBefore(e.firstChild):this.bbdesigner$(e).append(s),this.rangeExtractor.cursorBasedCollection&&this.setCursorOnNode(e,a.firstChild),o=a):(a.appendChild(o=document.createTextNode(e.data)),this.bbdesigner$(e).replaceWith(a)),i&&this.bbdesigner$(a).data(this.getFormatData(t).Value.data,i)):this.bbdesigner$(e.parentNode).data(this.getFormatData(t).Value.data,i),o},e.prototype.isTextNode=function(e){return e&&null!==e.nodeValue&&null!==e.data},e.prototype.isAncestor=function(e,t){try{return!this.isTextNode(t)&&(this.bbdesigner$.contains(t,this.isTextNode(e)?e.parentNode:e)||e.parentNode===t)}catch(e){return this.dashboardDesigner.designerPanel.logError({Source:"isAncestor",Error:e,Type:e.name}),!1}},e.prototype.isAncestorItself=function(e,t){return this.isAncestor(t,e)||e===t},e.prototype.tagCheck=function(e,t){t=this.getFormatData(t).Value;return!!t.tag&&this.bbdesigner$(e).is(t.tag)},e.prototype.styleCheck=function(i,e){var a,e=this.getFormatData(e).Value;return!(!e.css||this.rangeExtractor.validateTextNode(i)||this.bbdesigner$(i).is("p")||!this.bbdesigner$(i).is("span")||!i.getAttribute("style"))&&(a=!0,e=e.css.split(";"),this.bbdesigner$(e).each(function(e,t){t&&-1===i.getAttribute("style").replace(/\s/g,"").indexOf(t)&&(a=!1)}),a)},e.prototype.validateCommentNode=function(e){return 8!==e.nodeType},e.prototype.validateSelectedNode=function(e){return!e.length||1===e.length&&e[0].data&&!e[0].data.length},e.prototype.validateFormat=function(e,t){var i={Info:null,status:!1};return t=t.toLowerCase(),-1!==this.bbdesigner$.inArray(t,this.actionList)&&((e=this.validateFormatData(e,t))&&0<e.length&&(i.Info=e),i.status=0<e.length),i},e.prototype.validateFormatData=function(e,t){var i,a,o=[],s=e.parentNode;if(s)for(;i=this.tagCheck(s,t),a=this.styleCheck(s,t),(i||a)&&o.push({textNode:e,node:s,css:a,tag:i}),!this.bbdesigner$(s).hasClass("bbi-label-element")&&s&&(s=s.parentNode););return o},e.prototype.validateStyleData=function(e,i,a){var t=null,o=!1;return this.rangeExtractor.validateTextNode(e)||(t=e.getAttribute("style").split(";")),this.bbdesigner$(t).each(function(e,t){t=t.split(":");return t[0].toLowerCase().trim()===i.toLowerCase().trim()&&t[1].toLowerCase().trim()===a.toLowerCase().trim()&&(o=!0),!1}),o},e.prototype.getFormatedTagOrder=function(e,t){return e[t].currentNode=this.getNodeOrder(e[t].textNode,e[t].node),0<t?e:e.slice(t,t+1)},e.prototype.getNodeOrder=function(e,t){for(var i=e,a=[];a.push(i),(i=i.parentNode)&&i!==t;);return a},e.prototype.hasSubNodes=function(){return!this.isTextNode(this.current)&&(this.isAncestorItself(this.current,this.textRange.startContainer)||this.isAncestorItself(this.current,this.textRange.endContainer))},e.prototype.getFormatData=function(e){for(var t=0;t<this.tempCollection.length;t++)if(this.tempCollection[t].Key===e)return this.tempCollection[t];return null},e.prototype.compareCss=function(e,t){var i;return!this.rangeExtractor.validateTextNode(e)&&(e=e.getAttribute("style"),i=!BoldBIDashboard.isNullOrUndefined(e)&&e.toLowerCase().trim().replace(this.rangeExtractor.expression,""),t=t.toLowerCase().trim().replace(this.rangeExtractor.expression,""),e)&&i===t},e.prototype.compareTypeValue=function(e,t,i){return"format"===e.toLowerCase()?this.bbdesigner$(t).data("format")===i:"link"===e.toLowerCase()&&this.bbdesigner$(t).data("link")===i},e.prototype.collectStyleData=function(e){var t,i=e.replace(this.rangeExtractor.expression,"").split(";"),a={};return this.bbdesigner$(i).each(function(e){e=i[e];1<(t=e.split(":")).length&&(a[t[0].toLowerCase().trim()]=t[1].toLowerCase().trim())}),a},e.prototype.getStartEndElement=function(e,t){if(this.isAncestor(e,t))for(;e&&e.parentNode!==t;)e=e.parentNode;return e},e.prototype.getSubtree=function(){var e=this.textRange.cloneRange();return e.selectNodeContents(this.current),this.isAncestorItself(this.current,this.textRange.startContainer)&&e.setStart(this.textRange.startContainer,this.textRange.startOffset),this.isAncestorItself(this.current,this.textRange.endContainer)&&e.setEnd(this.textRange.endContainer,this.textRange.endOffset),this.generateRange(e)},e.prototype.splitNode=function(e){for(var t=e,i={rightSide:[],leftSide:[]};t=t.nextSibling;)this.validateCommentNode(t)&&i.rightSide.push(t);for(t=e;t=t.previousSibling;)this.validateCommentNode(t)&&i.leftSide.push(t);return i},e.prototype.getExactSelectedNode=function(e){var i=[],a=[],o=this.targetWindow.find("span#startRange"),s=this;return this.generateRange(e),this.traverse(function e(t){if(3===t.nodeType&&(""!==this.bbdesigner$.trim(t.nodeValue)||"\ufeff"===t.nodeValue||""===this.bbdesigner$.trim(t.nodeValue)&&t.nextSibling===o[0]))i.push(this.bbdesigner$(t));else if(t.nodeValue&&"#comment"!==t.nodeName&&""===t.nodeValue.trim()&&s.textRange.endContainer.parentNode.nextSibling!==s.next)this.bbdesigner$.inArray(t.previousElementSibling,a)<0&&a.push(t.previousElementSibling);else if(("br"===t.nodeName.toLowerCase()||!this.bbdesigner$(t).hasClass("bbi-label-element"))&&this.bbdesigner$.inArray(t.parentNode,i)<0&&"div"!==t.nodeName.toLowerCase()&&!BoldBIDashboard.isNullOrUndefined(i[i.length-1])&&i[i.length-1].parentNode!==t.parentNode&&t.previousSibling&&t.previousSibling.parentNode!==t.parentNode)i.push(this.bbdesigner$(t.parentNode));else if(BoldBIDashboard.isNullOrUndefined(t.firstChild))i.push(this.bbdesigner$(t));else for(t=t.firstChild;t;)e(t),t=t.nextSibling}),i},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.EditorManager",InternalEditorManager,window),InternalRangeExtractor=function(){function e(e){this.expression=null,this.findStatus=null,this.iterationStatus=!1,this.cursorData=null,this.textNodeCollection=[],this.traverseData=null,this.noContent=!1,this.cursorBasedCollection=!1,this.bbdesigner$=e.bbdesigner$,this.expression=/\s/g,this.findStatus={leftSide:null,rightSide:null},this.cursorData={node:null,offSet:null},this.traverseData={leftSide:{childNode:"lastChild",sibling:"previousSibling"},rightSide:{childNode:"firstChild",sibling:"nextSibling"}},this.iterationStatus=!1}return e.prototype.getNodeCollection=function(e){return e&&(this.textNodeCollection=[],this.noContent=!1,this.iterationStatus=!1,this.cursorData={node:null,offSet:null},e.startContainer===e.endContainer&&e.startOffset===e.endOffset?(this.collectCursorBasedTextNode(e.startContainer,e.startOffset),this.cursorBasedCollection=!0):(this.collectSelectionBasedTextNode(e),this.cursorBasedCollection=!1)),this.textNodeCollection},e.prototype.insertCursor=function(e,t){var i=e.data.substring(0,t),t=e.data.substr(t);i.replace(String.fromCharCode(65279),"")&&this.createParentNode(i,this.bbdesigner$(e).closest("span")).insertBefore(e.parentNode),t.replace(String.fromCharCode(65279),"")&&this.createParentNode(t,this.bbdesigner$(e).closest("span")).insertAfter(e.parentNode),this.bbdesigner$(e).replaceWith(i=document.createTextNode("")),this.cursorData={node:i,offSet:0},this.textNodeCollection.push(i),this.noContent=!0},e.prototype.collectCursorBasedTextNode=function(e,t){for(var i,a,o,s,n,r,d,l,h=new RegExp(this.expression);i=h.exec(e.data);)-1!==e.data.substring(i.index,i.index+1).indexOf(" ")&&(i.index<t&&(o=i),!s)&&t<=i.index&&(s=i);o&&s?t-(o.index+1)==0||t-(o.index+1)===e.data.substring(o.index+1,s.index).replace("\n","").length?this.insertCursor(e,t):(n=e.data.substring(0,o.index+1),r=e.data.substring(s.index),this.bbdesigner$(document.createTextNode(n)).insertBefore(e),this.bbdesigner$(document.createTextNode(r)).insertAfter(e),a=document.createTextNode(e.data.substring(o.index+1,s.index)),this.bbdesigner$(e).replaceWith(a),this.cursorData={node:a,offSet:t-(o.index+1)},this.textNodeCollection.push(a)):o?(d=void 0,this.collectNodeData(e,!1),d=this.textNodeCollection,this.textNodeCollection=[],0!==d.length||t-(o.index+1)!=0&&t-(o.index+1)!==e.data.substring(o.index+1).replace("\n","").length?(n=e.data.substring(0,o.index+1),this.bbdesigner$(document.createTextNode(n)).insertBefore(e),a=document.createTextNode(e.data.substring(o.index+1)),this.bbdesigner$(e).replaceWith(a),this.cursorData={node:a,offSet:t-(o.index+1)},this.textNodeCollection.push(a),this.textNodeCollection.concat(d)):this.insertCursor(e,t)):s?(this.collectNodeData(e,!(l=void 0)),l=this.textNodeCollection,this.textNodeCollection=[],0!==l.length||0!==t&&t!==e.data.substring(0,s.index).replace("\n","").length?(r=e.data.substring(s.index),this.bbdesigner$(document.createTextNode(r)).insertAfter(e),this.bbdesigner$(e).replaceWith(a=document.createTextNode(e.data.substring(0,s.index))),this.cursorData={node:a,offSet:t},this.textNodeCollection=l.reverse(),this.textNodeCollection.push(a)):this.insertCursor(e,t)):this.validateTextNode(e)?(this.collectNodeData(a=e,!1),d=this.textNodeCollection,this.textNodeCollection=[],this.collectNodeData(a,!0),l=this.textNodeCollection,this.textNodeCollection=[],a.data===String.fromCharCode(65279)||0===l.length&&0===t||0===d.length&&a.data?this.insertCursor(e,t):(this.textNodeCollection=l.reverse(),this.textNodeCollection.push(a),this.textNodeCollection=this.textNodeCollection.concat(d),this.cursorData={node:a,offSet:t})):(a=document.createTextNode(""),e.firstChild?this.bbdesigner$(a).insertBefore(e.firstChild):this.bbdesigner$(a).appendTo(e),this.textNodeCollection.push(a),this.cursorData={node:a,offSet:t},this.noContent=!0)},e.prototype.validateContent=function(e,t){for(var i,a,o,s=new RegExp(this.expression),n=[];i=s.exec(e.data);)n.push(i);n.length?(i=n["leftSide"===t?n.length-1:0],o="leftSide"===t?i.index+1:i.index,this.bbdesigner$(a=document.createTextNode(e.data.substring(o))).insertAfter(e),e.data=e.data.substring(0,o),"rightSide"===t&&this.bbdesigner$.trim(e.data)?this.textNodeCollection.push(e):"leftSide"===t&&this.bbdesigner$.trim(a.data)&&this.textNodeCollection.push(a),this.findStatus[t]=!0):this.textNodeCollection.push(e)},e.prototype.iterateNodes=function(e,t){if(!this.findStatus[t])if(this.validateTextNode(e)&&e.data)this.validateContent(e,t);else if((e=e[this.traverseData[t].childNode])&&!this.findStatus[t])for(;this.validateTextNode(e)&&e.data?this.validateContent(e,t):this.iterateNodes(e,t),(e=e[this.traverseData[t].sibling])&&!this.findStatus[t];);},e.prototype.collectNodeData=function(e,t){this.findStatus={leftSide:null,rightSide:null};for(var i,a=this,o=t?"leftSide":"rightSide";i=this.getSiblingNode(e),this.bbdesigner$(i[o]).each(function(e,t){a.iterateNodes(t,o)}),!this.bbdesigner$(e.parentNode).hasClass("bbi-label-element")&&(e=e.parentNode)&&!this.findStatus[o];);},e.prototype.collectSelectionBasedTextNode=function(e){var t,i,a,o,s,n=e.startContainer,r=e.endContainer;this.textNodeCollection=[],e.startContainer===e.endContainer?this.validateTextNode(e.endContainer)?(e.startOffset&&(t=e.startContainer.data.substr(0,e.startOffset)),e.startContainer.data.length!==e.endOffset&&(i=e.startContainer.data.substr(e.endOffset)),s=e.startContainer.data.substr(e.startOffset,e.endOffset-e.startOffset),t&&(a=this.createParentNode(t,this.bbdesigner$(e.startContainer).closest("span"))).insertBefore(e.startContainer.parentNode),i&&(o=this.createParentNode(i,this.bbdesigner$(e.endContainer).closest("span"))).insertAfter(e.startContainer.parentNode),s&&(s=document.createTextNode(s),this.bbdesigner$(e.startContainer).replaceWith(s))&&this.textNodeCollection.push(s)):"div"===e.startContainer.nodeName.toLowerCase()?this.updateNodeCollection(this.bbdesigner$(e.startContainer)[0],n,null):this.updateNodeCollection(e.startContainer,n,null):(s=e.commonAncestorContainer,this.validateTextNode(e.startContainer)&&e.startOffset&&(t=e.startContainer.data.substr(0,e.startOffset),i=e.startContainer.data.substr(e.startOffset),t&&(a=this.createParentNode(t,this.bbdesigner$(e.startContainer).closest("span"))).insertBefore(e.startContainer.parentNode),i)&&(o=this.createParentNode(i,this.bbdesigner$(e.startContainer).closest("span")),this.bbdesigner$(n.parentNode).replaceWith(n=o)),this.validateTextNode(e.endContainer)&&e.endContainer.data&&e.endContainer.data.length!==e.endOffset?(i=e.endContainer.data.substr(e.endOffset),t=e.endContainer.data.substr(0,e.endOffset),i&&(o=this.createParentNode(i,this.bbdesigner$(e.endContainer).closest("span"))).insertAfter(e.endContainer.parentNode),t&&(a=this.createParentNode(t,this.bbdesigner$(e.endContainer).closest("span")),this.bbdesigner$(r.parentNode).replaceWith(r=a))):e.endOffset&&e.endContainer.lastChild&&(r=e.endContainer.lastChild),this.updateNodeCollection(s,n,r))},e.prototype.createParentNode=function(e,t){var i=this.bbdesigner$(document.createElement("span"));return i.text(e),0<t.length&&i.css("cssText",t[0].style.cssText),i},e.prototype.updateNodeCollection=function(e,t,i){if(this.updateIterationStatus(e,t,i),e=e.firstChild)for(;this.updateNodeCollection(e,t,i),e=e.nextSibling;);},e.prototype.updateIterationStatus=function(e,t,i){e!==t||this.iterationStatus||(this.iterationStatus=!0),this.validateTextNode(e)&&this.iterationStatus&&this.textNodeCollection.push(e),e===i&&this.iterationStatus&&(this.iterationStatus=!1)},e.prototype.validateTextNode=function(e){return 3===e.nodeType},e.prototype.getSiblingNode=function(e){for(var t=e,i={leftSide:[],rightSide:[]};t=t.nextSibling;)t.tagName&&!this.bbdesigner$(t).hasClass("bbi-label-element")||i.rightSide.push(t);for(t=e;t=t.previousSibling;)t.tagName&&!this.bbdesigner$(t).hasClass("bbi-label-element")||i.leftSide.push(t);return i},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RangeExtractor",InternalRangeExtractor,window),function(e){e[e.Fontname=0]="Fontname",e[e.Fontsize=1]="Fontsize",e[e.Forecolor=2]="Forecolor",e[e.Backgroundcolor=3]="Backgroundcolor",e[e.Fontstyle=4]="Fontstyle",e[e.Fontweight=5]="Fontweight",e[e.Textdecoration=6]="Textdecoration",e[e.TextAlign=7]="TextAlign",e[e.Padding=8]="Padding",e[e.TextFormat=9]="TextFormat",e[e.TextLink=10]="TextLink"}(ExecCommand=ExecCommand||{}),InternalAppendDatasource=function(){function e(e){this.id=null,this.locale=null,this.appendDataDialog=null,this.appendDataSaveAsDialog=null,this.footerTag=null,this.appendSaveAsfooterTag=null,this.appendMode=null,this.model=null,this.validCount=0,this.inValidCount=0,this.overallCount=0,this.fileId=null,this.fileName=null,this.lastModifiedFile=null,this.ajaxPostForDSNameValidation=null,this.setTimeForDSNameValidation=null,this.isDSNameExist=!0,this.appendPopupNotification=null,this.ejQueryTool=null,this.tempdatasetName=null,this.isSchemaCheckforFile=!0,this.validFilesForAppend=[],this.inValidFilesForAppend=[],this.mappingValidFilesWithFileName={},this.dashboardDesigner=e,this.bbdesigner$=e.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id,this.dataSourceLocale=this.locale.dataSource,this.wireEvents()}return e.prototype.openAppendDataSourceWindow=function(e,t){this.resetConfiguration(),this.renderAppenDatasource(),this.datasourceInfo=e,this.tables=this.getTableGroups(),this.ejQueryTool=t,this.appendSelectedTableCollections.setModel({dataSource:this.tables}),this.appendSelectedTableCollections.selectItemByIndex(0),this.tempdatasetName=this.dashboardDesigner.element.find("#"+this.id+"_dataset_txt").val(),this.dashboardDesigner.element.find("#"+this.id+"_appenddatasourcename_textBox").val(this.tempdatasetName),this.dashboardDesigner.element.find("#"+this.id+"_appenddatasourcename_textBox").attr("disabled","disabled");this.dashboardDesigner.element.find("#"+this.id+"_append_data_append").attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_append_data_save_as").attr("disabled","disabled");e=this.appendDataDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.open()},e.prototype.resetConfiguration=function(){this.fileName="",this.lastModifiedFile="",this.inValidFilesForAppend=[],this.validCount=0,this.inValidCount=0,this.appendDataDialog=null,this.ejUploadBox=null,this.footerTag=null,this.appendPopupNotification=null,this.dataSetName="",this.validFilesForAppend=[],this.mappingValidFilesWithFileName={}},e.prototype.getTableGroups=function(){var t=[],e=document.querySelector("#"+this.id+"_div_bodySchema .bbi-dataset-treeview");return e&&e.querySelectorAll(".bbi-option-view-schema").forEach(function(e){e=e.getAttribute("data-displayname");e&&t.push(e)}),t},e.prototype.renderTextBoxAndDropdown=function(e){var t;this.dataSourceInstance.renderTextBoxItem(this.dataSourceLocale.appendTextBoxName,this.id+"_appenddatasourcename_textBox",!1,e,538),(t=e.find("#"+this.id+"_appenddatasourcename_textBox_tr")).css("display","block"),t.css("padding-left","24px"),t.css("padding-right","24px"),t.css("padding-top","20px"),t.css("padding-bottom","8px"),this.dataSourceInstance.renderDropDownItem(this.dataSourceLocale.appendDsSelectedTables,this.id+"_appendDsTable",e,null,null,null,this.onChangeCollection,this),this.appendSelectedTableCollections=e.find("#"+this.id+"_appendDsTable").BoldBIDashboardDropDownList({fields:{id:"field",text:"field",value:"field"},delimiterChar:"$"}).data("BoldBIDashboardDropDownList"),this.appendTableCollectionsTag=e.find("#"+this.id+"_appendDsTable_tr"),this.appendTableCollectionsTag.css("display","block"),this.appendTableCollectionsTag.css("padding-left","24px"),this.appendTableCollectionsTag.css("padding-right","24px"),this.appendTableCollectionsTag.css("padding-top","8px"),this.appendTableCollectionsTag.css("padding-bottom","8px"),e.find("#"+this.id+"_appendDsTable_wrapper").css("width","552px")},e.prototype.renderAppenDatasource=function(){var e,t=this,i=this.appendDataDialog=BoldBIDashboard.buildTag("div.e-append-ds-dlg","",{height:"520px",width:"600px"},{id:this.id+"_append_data_dialog"}),a=(this.dataSourceInstance=this.dashboardDesigner.modules.dataSource,this.renderTextBoxAndDropdown(i),a=BoldBIDashboard.buildTag("div.e-over-allradio-wrapper","",{display:"block","padding-left":"26px","padding-right":"24px","padding-top":"8px","padding-bottom":"8px"},{id:this.id+"_overall_radio-container"}),this.renderadioBtns(a),e="<div class= 'bbi-append-file-banner-container'><div class= 'bbi-append-file-banner-parent'><div class= 'bbi-append-file-banner-text'></div><span class = 'bbi-append-dashboard-close-icon bbi-file-banner-icon' title = '"+this.locale.dataSource.appendDsCloseBtn+"'></span></div></div><div class ='bbi-append-initial-listing-parent'><div class= 'bbi-append-file-container-parent'><div class ='bbi-append-initial-listing-upload-parent'><div class ='bbi-append-initial-listing-container' id="+this.id+"_append_file></div></div></div><div class ='bbi-append-initial-append-file-listing-parent'><div class='bbi-append-file-scroll'><div class='bbi-append-file-container'></div></div></div>",i.append(a),i.append(e),BoldBIDashboard.buildTag("div.e-uploaded-file-list-parent","",{display:"none",position:"absolute","align-items":"center",top:"523px",width:"600px",height:"32px",background:"#EEF6FC",gap:"40px"},{id:this.id+"_uploaded-file-list-parent"}));this.bbdesigner$(this.dashboardDesigner.element).append(i),this.ejUploadBox=i.find("#"+this.id+"_append_file").BoldBIDashboardUploadbox({width:"0px",height:"0px",uploadName:"file",allowDragAndDrop:!0,autoUpload:!0,multipleFilesSelection:!0,dropAreaText:this.getUploadFileTemplate(),showFileDetails:!1,fileSize:209715200,saveUrl:this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.fileupload,fileSelect:this.bbdesigner$.proxy(this.onFileSelect,this),inProgress:this.bbdesigner$.proxy(this.onUploadProgress,this),success:this.bbdesigner$.proxy(this.onUploadSuccess,this),error:this.bbdesigner$.proxy(this.onUploadError,this),beforeSend:this.bbdesigner$.proxy(function(e){BoldBIDashboard.isNullOrUndefined(t.xhrObj)||(t.xhrObj.onerror=null,t.xhrObj.abort(),t.xhrObj=null),t.xhrObj=e.currentRequest,t.dashboardDesigner.beforeSendRequestForUploadbox(t.dashboardDesigner,"UploadAction",e)},this)}).data("BoldBIDashboardUploadbox"),this.dashboardDesigner.element.find("#"+this.id+"_append_file_dragWrapper").css("width","552px"),(e=this.dashboardDesigner.element.find(".bbi-append-initial-listing-upload-parent")).css("padding-left","24px"),e.css("padding-right","24px"),e.css("height","56px"),this.appendDataDialog.BoldBIDashboardDialog({height:"650px",width:"602px",title:"Append Data From File",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-appenddatasource",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),containment:"#"+this.id,target:"#"+this.id,closeIconTooltip:this.locale.dialogOptions.closeButtonText}),a.append("<div class='bbi-append-file-listing-details'></div>"),a.append("<div class='bbi-append-file-listing-failure-details'></div>"),i.append(a),this.dashboardDesigner.element.find(".e-uploaded-file-list-parent").css("display","none"),this.renderappendFooterDialog(),this.renderSaveAsDialog()},e.prototype.renderSaveAsDialog=function(){var e,t,i,a=this.appendDataSaveAsDialog=BoldBIDashboard.buildTag("div.e-append-datasaveAs-dlg","",{height:"72px"},{id:this.id+"_append_datasaveAs_dialog"});this.dataSourceInstance.renderTextBoxItem(this.dataSourceLocale.appendTextBoxName,this.id+"_append_dbname",!1,a,292),e=this.id+"_append_dbname",e=BoldBIDashboard.buildTag("div .bbi-dashboarddesigner-dsname-validationicon","",{},{id:e+"_indicator_div"}),this.dataSourceName=a.find("#"+this.id+"_append_dbname"),t=a.find("#"+this.id+"_append_dbname_tr"),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.designerPanel)||(i=this.dashboardDesigner.designerPanel),a.find("#"+this.id+"_append_dbname_td").append(e),a.find("#"+this.id+"_append_dbname").css("position","relative"),BoldBIDashboard.isNullOrUndefined(i)||i.appendSpinningWidget(e,null),e.find(".bbi-background-waiting-popup").css("background-color",""),e.find(".bbi-dashboard-spinning").css({width:"35px",height:"35px"}),t.css("display","block"),t.css("padding","15px"),a=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dataSource.appendDsSaveBtn,{float:"right",right:"25px"},{id:this.id+"_append_data_save",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dataSource.appendDsCloseBtn,{float:"right",left:"10px"},{id:this.id+"_append_data_saveAsDlgclose",type:"button"}),this.bbdesigner$(this.dashboardDesigner.element).append(this.appendDataSaveAsDialog),this.appendDataSaveAsDialog.BoldBIDashboardDialog({title:"Append new data",width:"356px",height:"200px",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-saveas-appendatsourcedialog",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),containment:"#"+this.id,target:"#"+this.id,closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.appendSaveAsfooterTag=this.dashboardDesigner.element.find("#"+this.id+"_append_datasaveAs_dialog_foot"),this.appendSaveAsfooterTag.css("bottom","25px;"),this.appendSaveAsfooterTag.append(i,a)},e.prototype.renderappendFooterDialog=function(){var e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.dataSourceLocale.appendDsAppendBtn,{float:"right","margin-right":"20px"},{id:this.id+"_append_data_append",type:"button"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left bbi-dbrd-append-saveas-btn",this.locale.dataSource.appendDsSaveAsBtn,{float:"left"},{id:this.id+"_append_data_save_as",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dataSource.appendDsCloseBtn,{float:"right",right:"10px"},{id:this.id+"_append_data_cancel",type:"button"});this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_append_data_dialog_foot"),this.footerTag.append(i,t,e)},e.prototype.renderadioBtns=function(e){BoldBIDashboard.buildTag("span.e-append-textboxlable","Append Type",{"font-size":"12px","font-weight":"700"},{id:this.id+"_textbox_lable"});var t=BoldBIDashboard.buildTag("div.e-dropdown-wrapper_radiodiv","",{},{id:this.id+"_appends_mode_radiodiv"}),i=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td","",{width:"25%",padding:"8px 0px"},{}),s=BoldBIDashboard.buildTag("td","",{width:"20%",padding:"8px 0px"},{}),n=BoldBIDashboard.buildTag("div","",{"margin-left":"30px"},{id:this.id+"_btn_datasource_mode"}),r=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_btn_file_mode"});o.append(n),s.append(r),a.append(s,o),i.append(a),t.append(i),s={callBackInstance:this,callBackMethod:"changeSelectionType",groupName:"append-datasource-type-modes",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:"_datasource",label:'<span class="bbi-append-config-radio">'+this.locale.dataSource.appendDatasourceRadioBtnText+"</span>",value:"Datasource"}]},o={callBackInstance:this,callBackMethod:"changeSelectionType",groupName:"append-datasource-type-modes",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:"_file",label:'<span class="bbi-append-config-radio" style="white-space:nowrap">'+this.locale.dataSource.appendFileRadioBtnText+"</span>",isChecked:!0,value:"File"}]},new BoldBIDashboard.Dashboard.RadioButton(o,r),new BoldBIDashboard.Dashboard.RadioButton(s,n),a=BoldBIDashboard.buildTag("span.e-append-textboxlable",this.dataSourceLocale.appendDsChooseFile,{"font-size":"12px","font-weight":"700"},{id:this.id+"_choose_file_lable"}),e.append(a)},e.prototype.onChangeCollection=function(e){BoldBIDashboard.isNullOrUndefined(e)},e.prototype.onUploadError=function(e){BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.error)||(e=e.error,this.showFileUploadBanner(e,"#FF3B30"))},e.prototype.showFileUploadBanner=function(e,t){this.dashboardDesigner.element.find(".bbi-upload-file-banner-parent").css({backgroundColor:t,visibility:"visible"}),this.dashboardDesigner.element.find(".bbi-upload-file-banner-text").html(e)},e.prototype.getFileExtension=function(e){var t=e.lastIndexOf(".");return-1===t?void 0:e.substring(t+1)},e.prototype.onUploadBrowseClick=function(){var e;BoldBIDashboard.isNullOrUndefined(this.datasourceInfo.OriginalFileName)?this.ejUploadBox.setModel({extensionsAllow:".xlsx,.json,.csv,.xml "}):(e=this.getFileExtension(this.datasourceInfo.OriginalFileName),this.updateAllowedExtensions(e)),this.dashboardDesigner.element.find("#"+this.id+"_append_file .e-uploadinput").click()},e.prototype.updateAllowedExtensions=function(e){this.ejUploadBox.setModel({extensionsAllow:"."+e})},e.prototype.onFileSelect=function(e){0!==e.files.length&&e.files[0].size>e.model.fileSize&&(e.cancel=!0),this.dashboardDesigner.element.find(".bbi-append-initial-append-file-listing-parent").css("display","block"),"msie"!==BoldBIDashboard.browserInfo().name&&this.ejUploadBox._uploadFileListDelete()},e.prototype.onUploadSuccess=function(e){var t,i,a;BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.responseText)||(t=this.dashboardDesigner.element.find(".bbi-append-file-info-parent[data-id='"+e.files.rawFile.lastModified+"']"),i=JSON.parse(e.responseText),a=t.find(".bbi-append-file-status-message"),BoldBIDashboard.isNullOrUndefined(i)||BoldBIDashboard.isNullOrUndefined(i.Data)?(a.html(this.locale.downloadUpload.invalidFileText),a.css("color","#FF3B30"),t.removeAttr("data-is-append-in-progress")):(this.fileId=i.Data.fileId,this.fileName=e.files.name,this.mappingValidFilesWithFileName[this.fileName]=this.fileId,this.lastModifiedFile=e.files.rawFile.lastModified,a.html("Validating schema...."),a.css("font-family","Roboto"),t.removeAttr("data-id"),t.removeAttr("data-is-append-in-progress"),this.serverSchemaCheck(a)))},e.prototype.onUploadProgress=function(e){var t;BoldBIDashboard.isNullOrUndefined(e)||(!0!==this.dashboardDesigner.element.find(".bbi-append-file-listing-parent").is(":visible")&&this.dashboardDesigner.element.find(".bbi-append-file-listing-parent").css("display","block"),t=this.dashboardDesigner.element.find(".bbi-append-file-container"),0<this.dashboardDesigner.element.find(".bbi-append-file-info-parent").length&&this.isUploadFileCheck(e.file))||(this.overallCount++,(e=this.uploadFileListHTML(e.file)).find(".bbi-append-file-status-message").addClass("bbi-append-file-status-icon-waiting-spinner"),this.dashboardDesigner.element.find(".bbi-append-file-listing-parent"),e.appendTo(t))},e.prototype.isUploadFileCheck=function(e){return 0<this.dashboardDesigner.element.find(".bbi-append-file-info-parent[data-Id='"+e.rawFile.lastModified+"']").length},e.prototype.uploadFileListHTML=function(e){e="<div class='bbi-append-file-info-parent' data-id="+e.rawFile.lastModified+" data-is-append-in-progress=true><div class='bbi-append-file-name-parent'><div class='bbi-append-file-name' title = '"+e.name+"'>"+e.name+"</div></div><div class='bbi-append-file-size-parent'><div class='bbi-append-file-size'>"+(BoldBIDashboard.isNullOrUndefined(e.size)?"0.00":(e.size/1048576).toFixed(2))+this.locale.downloadUpload.mbText+"</div></div><div class='bbi-append-file-status-message-parent'><div class='bbi-append-file-status-message' id = '"+e.rawFile.lastModified+"'>"+this.locale.downloadUpload.uploadingText+"</div></div><div class='bbi-append-file-delete-icon-parent'><div class='bbi-append-file-delete-icon'></div></div></div>";return this.bbdesigner$(e)},e.prototype.getUploadFileTemplate=function(){return"<div class ='bbi-append-file-parent'><div class ='bbi-append-file-text-parent'><div class ='bbi-append-file-drag-drop-text'><span style=\"width: 94px;\">"+this.locale.dataSource.appendDsdragAndDropText+"</span><div class ='bbi-append-file-browse-text'>"+this.locale.dataSource.appendDsBrowseText+"</div> <div class ='bbi-append-file-size-text'>"+this.locale.dataSource.appendDsEstimatedFileSize+"</div></div></div></div>"},e.prototype.closeAppendDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.appendDataDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close()},e.prototype.closeSaveAsDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.appendDataSaveAsDialog.data("BoldBIDashboardDialog").close()},e.prototype.appendFileTosaveAsServer=function(){var e;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.dataSetName=this.dashboardDesigner.element.find("#"+this.id+"_append_dbname").val(),0==this.dataSetName.length&&(this.dataSourceInstance.showValidationMsg(this.id+"_append_dbname",!0,this.locale.dataSource.specifyDataSourceName),this.isDSNameExist=!0),this.isDSNameExist||(this.dashboardDesigner.nameValidation(this.dataSetName)?(e=this.appendDataSaveAsDialog.data("BoldBIDashboardDialog"),BoldBIDashboard.isNullOrUndefined(e)||e.close(),this.appendFiletoServer()):(e=this.locale.nameValidationMessages.invalidDatasourceName+this.locale.nameValidationMessages.notSupportedCharDatasourceName+'* | / : < > , % ; \\ " + & ? #',this.dataSourceInstance.showValidationMsg(this.id+"_append_dbname",!0,e)))},e.prototype.appendFiletoServer=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.PopUpRender(),this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.appendDatasource,{action:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,datasourceId:this.datasourceInfo.Id,datasourceInfo:this.datasourceInfo,appendDataFileId:this.validFilesForAppend,appendDataFileName:this.appendSelectedTableCollections.getSelectedValue(),copyDatasourceName:BoldBIDashboard.isNullOrUndefined(this.dataSetName)?"":this.dataSetName,schemaCheck:"false"})},{fnction:this.bbdesigner$.proxy(this.appendDatasourceStatus,this)},!0,!0)},e.prototype.serverSchemaCheck=function(e){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.appendDatasource,{action:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,datasourceId:this.datasourceInfo.Id,datasourceInfo:this.datasourceInfo,appendDataFileId:this.fileId,appendDataFileName:this.appendSelectedTableCollections.getSelectedValue(),copyDatasourceName:"",schemaCheck:"true",filename:this.fileName,lastmodified:this.lastModifiedFile})},{fnction:this.bbdesigner$.proxy(this.onUploadSuccessforSchemaCheck,this,e)},!0,!0)},e.prototype.onUploadSuccessforSchemaCheck=function(e,t){var i,a,o,s;BoldBIDashboard.isNullOrUndefined(t)||(this.dashboardDesigner.element.find(".e-uploaded-file-list-parent").css("display","flex"),i=this.dashboardDesigner.element.find(".bbi-append-file-listing-details").css("display","flex"),a=this.dashboardDesigner.element.find(".bbi-append-file-listing-failure-details"),o=JSON.parse(t.Data),e.removeClass("bbi-append-file-status-icon-waiting-spinner"),!BoldBIDashboard.isNullOrUndefined(t)&&t.Status?(this.validCount++,0===this.inValidCount&&1===this.validCount&&a.css("display","none"),e.addClass("bbi-append-file-status-icon-success-image"),e.html("Ready to append"),e.css("color","var(--green-2, #27AE60)"),i.html(this.validCount+" "+this.locale.dataSource.appendDsReadyToAppend),BoldBIDashboard.isNullOrUndefined(o.FileName)||""===o.FileName||this.validFilesForAppend.push(o.FileName)):(this.inValidCount++,e.addClass("bbi-append-file-status-icon-failure-image"),e.find(".bbi-append-file-status-icon-failure-image"),t=new ejdashboard.popups.Tooltip({content:o.Message}),s="#"+e.attr("id"),t.appendTo(s),t.position="TopCenter",a.css("display","flex"),i.html(this.validCount+" "+this.locale.dataSource.appendDsReadyToAppend),a.html(this.inValidCount+" "+this.locale.dataSource.appendDsFilesNeedsAttention),e.html("Schema mismatched"),e.css("color","#FF3B30"),BoldBIDashboard.isNullOrUndefined(o.FileName)||""===o.FileName||this.inValidFilesForAppend.push(o.FileName)),this.isFileselected())},e.prototype.OnDeleteButtonClickEvent=function(e){var t=this.bbdesigner$(e.currentTarget).closest(".bbi-append-file-info-parent").find(".bbi-append-file-name").html(),t=this.mappingValidFilesWithFileName[t];this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.appendDatasourceDeleteFile,{action:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.AppendDatasourceDetails,deleteFilename:t})},{fnction:this.bbdesigner$.proxy(this.onappendfileDeleteResponse,this,e)},!0)},e.prototype.changeSelectionType=function(e){BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.args)},e.prototype.onSaveAsClick=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.appendDataSaveAsDialog.data("BoldBIDashboardDialog"),t=this.appendDataDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(t)||t.close(),e.open()},e.prototype.validateDataSourceNameExist=function(){var e=this;this.setTimeForDSNameValidation=setTimeout(function(){e.ajaxPostForDSNameValidation=e.dashboardDesigner.modules.util.doAjaxPost("POST",e.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.validatedsname,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetDsnName,data:JSON.stringify(e.dataSetName)},{fnction:e.bbdesigner$.proxy(e.OnDataSourceNameExistSuccess,e),errfnction:e.bbdesigner$.proxy(e.OnDataSourceNameExistError,e),indicator:[e.bbdesigner$.proxy(e.dashboardDesigner.modules.util.showDataSourceLoadingIndicator,e,e.dashboardDesigner.element,e.id+"_append_dbname"),e.bbdesigner$.proxy(e.dashboardDesigner.modules.util.hideDataSourceLoadingIndicator,e,e.dashboardDesigner.element,e.id+"_append_dbname")]},!0,!0)},500)},e.prototype.OnDataSourceNameExistSuccess=function(e){e.Status&&(this.isDSNameExist=e.Data),this.dashboardDesigner.modules.util.onDataSourceNameExistSuccess(this.id+"_append_dbname",e.Status,this.isDSNameExist,e.Message)},e.prototype.OnDataSourceNameExistError=function(e){this.dashboardDesigner.modules.util.onDataSourceNameExistError(this.id+"_append_dbname",e)},e.prototype.appendDatasourceStatus=function(e){!BoldBIDashboard.isNullOrUndefined(e.ApiStatus)&&e.Status?this.successPopupStatus():this.errorPopupStatus()},e.prototype.PopUpRender=function(){var e;this.appendDataDialog.data("BoldBIDashboardDialog").close(),this.disableQuerToolIcons(),(e=this.dashboardDesigner.element.find(".bbi-append-popup-left-pane")).removeClass("bbi-append-file-error-popup"),e.removeClass("bbi-append-file-success-popup"),e.addClass("bbi-append-file-waiting-popup"),e.html(this.locale.dataSource.appendDsWaitingPopupText),this.dashboardDesigner.element.find(".bbi-append-popup-notification").css("display","flex").css("background","#E3EDFC"),this.dashboardDesigner.element.find(".bbi-append-popup-right-pane").addClass("bbi-append-file-banner-close-icon")},e.prototype.errorPopupStatus=function(){var e=this.dashboardDesigner.element.find(".bbi-append-popup-left-pane");e.removeClass("bbi-append-file-waiting-popup"),e.addClass("bbi-append-file-error-popup"),e.html(this.locale.dataSource.appendDsFailurePopupText),this.dashboardDesigner.element.find(".bbi-append-popup-notification").css("background","#FFE5E4")},e.prototype.successPopupStatus=function(){var e=this.dashboardDesigner.element.find(".bbi-append-popup-left-pane");e.removeClass("bbi-append-file-waiting-popup"),e.addClass("bbi-append-file-success-popup"),e.html(this.locale.dataSource.appendDsSuccessPopupText),this.dashboardDesigner.element.find(".bbi-append-popup-notification").css("background","#DCFFE3")},e.prototype.enableQuerToolIcons=function(){this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_AppendData"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_DashboardParameter"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_Expression"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_Join"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_ConfigureQueryFilters"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_ConfigureUserFilters"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_Run"),this.ejQueryTool.enableItemByID(this.id+"_dataset_toolbar_li_DataSampling"),this.dashboardDesigner.element.find("#"+this.id+"_chck_on").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.id+"_editConnectionButton").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.id+"_saveButton").removeAttr("disabled"),this.dashboardDesigner.element.find("#"+this.id+"_cancelButton").removeAttr("disabled")},e.prototype.disableQuerToolIcons=function(){this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_AppendData"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_DashboardParameter"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_Expression"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_Join"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_ConfigureQueryFilters"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_ConfigureUserFilters"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_Run"),this.ejQueryTool.disableItemByID(this.id+"_dataset_toolbar_li_DataSampling");this.dashboardDesigner.element.find("#"+this.id+"_chck_on").attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_editConnectionButton").attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_saveButton").attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_cancelButton").attr("disabled","disabled")},e.prototype.CloseBanner=function(){this.dashboardDesigner.element.find(".bbi-append-popup-notification").css("display","none"),this.enableQuerToolIcons()},e.prototype.onappendfileDeleteResponse=function(e){var t,e=this.bbdesigner$(e.currentTarget),e=(this.fileName="",BoldBIDashboard.isNullOrUndefined(e.parents(".bbi-append-file-info-parent").attr("data-uploadinfo")),e.closest(".bbi-append-file-info-parent")),i=e.find(".bbi-append-file-status-message").html(),a=this.dashboardDesigner.element.find(".bbi-append-file-listing-details"),o=this.dashboardDesigner.element.find(".bbi-append-file-listing-failure-details");BoldBIDashboard.isNullOrUndefined(i&&""!==i)||("Schema mismatched"===i?(this.inValidCount--,0===this.inValidCount&&1<=this.validCount&&o.css("display","none"),o.html(this.inValidCount+" "+this.locale.dataSource.appendDsFilesNeedsAttention)):(this.validCount--,i=e.find(".bbi-append-file-name").html(),t=this.mappingValidFilesWithFileName[i],this.validFilesForAppend=this.validFilesForAppend.filter(function(e){return e!==t}),1<=this.inValidCount&&0===this.validCount&&o.css("display","flex"),a.html(this.validCount+" "+this.locale.dataSource.appendDsReadyToAppend))),e.remove(),this.isFileselected(),0===this.dashboardDesigner.element.find(".bbi-append-file-info-parent").length&&(this.dashboardDesigner.element.find(".bbi-append-file-listing-parent").css("display","none"),this.dashboardDesigner.element.find(".e-uploaded-file-list-parent").css("display","none"),this.inValidCount=0,this.validCount=0,this.mappingValidFilesWithFileName={},this.dashboardDesigner.element.find("#"+this.id+"_append_data_append").attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+this.id+"_append_data_save_as").attr("disabled","disabled").css("border","1px solid #B3B3B3"))},e.prototype.isFileselected=function(){var e;BoldBIDashboard.isNullOrUndefined(this.inValidCount)||0!==this.inValidCount?(this.dashboardDesigner.element.find("#"+this.id+"_append_data_append").attr("disabled","disabled"),(e=this.dashboardDesigner.element.find("#"+this.id+"_append_data_save_as").attr("disabled","disabled")).css("border","1px solid #B3B3B3")):(this.dashboardDesigner.element.find("#"+this.id+"_append_data_append").removeAttr("disabled"),(e=this.dashboardDesigner.element.find("#"+this.id+"_append_data_save_as").css("border","1px solid var(--primary-btn-border-normal-color)")).css("color","#0565FF"),e.removeAttr("disabled"))},e.prototype.validateDsNameField=function(e){var t=this.bbdesigner$(e.currentTarget).attr("id"),i=this.dashboardDesigner.element.find("#"+t+"_error_icon_td");(48<=e.keyCode&&e.keyCode<=57||65<=e.keyCode&&e.keyCode<=90||186<=e.keyCode&&e.keyCode<=191||219<=e.keyCode&&e.keyCode<=222||8===e.keyCode||9===e.keyCode||13===e.keyCode||46===e.keyCode||16===e.keyCode)&&this.dataSetName!==this.dashboardDesigner.element.find("#"+t).val()&&(BoldBIDashboard.DashboardUtil.showErrIndictor(i,!1),e=this.id+"_append_dbname",this.dataSetName=this.dashboardDesigner.element.find("#"+e).val().trim(),this.clearRequestTimeout(),this.dataSetName===this.tempdatasetName?(this.dataSourceInstance.showValidationMsg(this.id+"_append_dbname",!0,this.locale.saveDatasourceDialog.datasourceAlreadyExistsText),this.isDSNameExist=!0):this.dashboardDesigner.modules.util.isDataSourceNameExist(this.id,this.dataSetName)&&this.validateDataSourceNameExist())},e.prototype.datasourceNameFieldTextChange=function(e){e=this.bbdesigner$(e.currentTarget).attr("id");this.dataSetName!==this.dashboardDesigner.element.find("#"+e).val().trim()&&(this.dataSetName=this.dashboardDesigner.element.find("#"+e).val().trim(),this.dataSourceInstance.showValidationMsg(e,!1),this.validateDataSourceNameExist())},e.prototype.clearRequestTimeout=function(){null!=this.setTimeForDSNameValidation&&(clearTimeout(this.setTimeForDSNameValidation),this.setTimeForDSNameValidation=null),BoldBIDashboard.isNullOrUndefined(this.ajaxPostForDSNameValidation)||(this.ajaxPostForDSNameValidation.abort(),this.ajaxPostForDSNameValidation=null)},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("keyup","#"+this.id+"_append_dbname",this.bbdesigner$.proxy(this.validateDsNameField,this)),this.dashboardDesigner.element.on("change","#"+this.id+"_append_dbname",this.bbdesigner$.proxy(this.datasourceNameFieldTextChange,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_append_data_save",this.bbdesigner$.proxy(this.appendFileTosaveAsServer,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_append_data_cancel",this.bbdesigner$.proxy(this.closeAppendDialog,this)),this.dashboardDesigner.element.on("click",".bbi-append-file-browse-text",this.bbdesigner$.proxy(this.onUploadBrowseClick,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_append_data_append",this.bbdesigner$.proxy(this.appendFiletoServer,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_append_data_saveAsDlgclose",this.bbdesigner$.proxy(this.closeSaveAsDialog,this)),this.dashboardDesigner.element.on("click",".bbi-append-file-delete-icon",this.bbdesigner$.proxy(this.OnDeleteButtonClickEvent,this)),this.dashboardDesigner.element.on("click",".bbi-append-file-banner-close-icon",this.bbdesigner$.proxy(this.CloseBanner,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_append_data_save_as",this.bbdesigner$.proxy(this.onSaveAsClick,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("keyup","#"+this.id+"_append_dbname",this.bbdesigner$.proxy(this.validateDsNameField,this)),this.dashboardDesigner.element.off("change","#"+this.id+"_append_dbname",this.bbdesigner$.proxy(this.datasourceNameFieldTextChange,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_append_data_save",this.bbdesigner$.proxy(this.appendFileTosaveAsServer,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_append_data_cancel",this.bbdesigner$.proxy(this.closeAppendDialog,this)),this.dashboardDesigner.element.off("click",".bbi-append-file-browse-text",this.bbdesigner$.proxy(this.onUploadBrowseClick,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_append_data_append",this.bbdesigner$.proxy(this.appendFiletoServer,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_append_data_saveAsDlgclose",this.bbdesigner$.proxy(this.closeSaveAsDialog,this)),this.dashboardDesigner.element.off("click",".bbi-append-file-delete-icon",this.bbdesigner$.proxy(this.OnDeleteButtonClickEvent,this)),this.dashboardDesigner.element.off("click",".bbi-append-file-banner-close-icon",this.bbdesigner$.proxy(this.CloseBanner,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_append_data_save_as",this.bbdesigner$.proxy(this.onSaveAsClick,this))},e.prototype.destroy=function(){this.unWireEvents()},e}(),function(e){e[e.file="File"]="file",e[e.datasource="Datasource"]="datasource"}(DataMode=DataMode||{}),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.AppendDatasource",InternalAppendDatasource,window),InternalDateRangePopup=function(){function e(e){this.parameterList=[],this.customAttributeList=[],this.filterInfo=new DimensionFilterInfo,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.dateFormat=this.dashboardDesigner.model.localeSettings.dateFormat+" "+this.dashboardDesigner.model.localeSettings.timeFormat}return e.prototype.getCustomAttribute=function(e){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,isCodeView:!1,isQueryDesignerMode:!0})},{fnction:this.bbdesigner$.proxy(this.setCustomAttribute,this,e)})},e.prototype.setCustomAttribute=function(e,t){BoldBIDashboard.isNullOrUndefined(t)||(t=t.map(function(e){return{text:e.Name,value:e.Value}}),this.customAttributeList=t)},e.prototype.renderDateRangePopup=function(e,t){var i,a,o,s,n,r,d,l,h,p,c,u;return BoldBIDashboard.isNullOrUndefined(t)||"Custom Attributes"!==t||this.getCustomAttribute(e),i=this.dashboardDesigner.element.find("#"+(t=e+"_dateRange_popup")),!BoldBIDashboard.isNullOrUndefined(this.dateRangePopUp)&&0!==this.dateRangePopUp.length||0!==i.length?this.dateRangePopUp=!BoldBIDashboard.isNullOrUndefined(this.dateRangePopUp)&&0<this.dateRangePopUp.length&&t===this.dateRangePopUp[0].id?this.dateRangePopUp:this.dashboardDesigner.element.find("#"+e+"_dateRange_popup"):(this.dateRangePopUp=BoldBIDashboard.buildTag("div.bbi-daterange-popup","",{},{id:e+"_dateRange_popup"}),i=BoldBIDashboard.buildTag("div.bbi-date-range-checkBbox","",{}),t=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),a=BoldBIDashboard.buildTag("tr","",{},{}),this.renderRadioButton("Ranges",e,e+"_RangeBtn",!0,a,this.onRangeTypeChange,this),this.renderRadioButton("Start Date",e,e+"_startBtn",!1,a,this.onRangeTypeChange,this),this.renderRadioButton("End Date",e,e+"_endBtn",!1,a,this.onRangeTypeChange,this),o=BoldBIDashboard.buildTag("div.bbi-date-range-field","",{},{id:e+"_dateRange_fieldDiv"}),s=BoldBIDashboard.buildTag("div","",{"margin-top":"6px"},{id:e+"_dateRange_start_tr"}),n=BoldBIDashboard.buildTag("div","",{"margin-top":"12px"},{id:e+"_dateRange_end_tr"}),r=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),d=BoldBIDashboard.buildTag("tr","",{},{}),l=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),h=BoldBIDashboard.buildTag("tr","",{},{}),p=BoldBIDashboard.buildTag("div.bbi-date-range-popup-footer","",{},{}),c=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary bbi-date-range-foot-btn",this.locale.dialogOptions.applyButtonText,{},{id:e+"_dateRange_okBtn",type:"button",disabled:"disabled"}),u=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left bbi-date-range-foot-btn",this.locale.dialogOptions.cancelButtonText,{},{id:e+"_dateRange_cancelBtn",type:"button"}),this.dashboardDesigner.element.append(this.dateRangePopUp),t.append(a),i.append(t),this.dateRangePopUp.append(i),s.append(r),r.append(d),this.renderDateRangePicker(e+"_dateRange_Start",e,"Start",d,this.onPickerChange,this),n.append(l),l.append(h),this.renderDateRangePicker(e+"_dateRange_end",e,"End",h,this.onPickerChange,this),o.append(s),o.append(n),this.dateRangePopUp.append(o),p.append(u).append(c),this.dateRangePopUp.append(p),this.dateRangePopUp.css("z-index",this.bbdesigner$("#"+this.id+"_query_filter_dialog_wrapper").css("z-index")+1),c.on("click",this.bbdesigner$.proxy(this.updateDateRangeAttr,this,e)),u.on("click",this.bbdesigner$.proxy(this.closeDateRangePopup,this,e)),o.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.resetAttributes(this.dateRangePopUp,e)),this.dateRangePopUp},e.prototype.renderDateParameter=function(e,t,i){var a,o=this.parameterList.filter(function(e){return e.dataType===DynamicParameterDataType.Date}),s=BoldBIDashboard.buildTag("td","",{"padding-left":"End"===i?"20px":"10px",display:"none"},{id:t+"_query_date_"+i+"_parameter_dropdown"}),n=BoldBIDashboard.buildTag("input.e-textbox","",{height:"30px",width:"160px"},{type:"text",id:t+"_date_"+i+"_param"});s.append(n),a=!BoldBIDashboard.isNullOrUndefined(o)&&0<o.length?o[0].value:null,n.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:n.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:o,enabled:!0,value:a,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.parameterBtwChangeEvent,this,t,i,o)}),e.append(s),this.dashboardDesigner.element.find("#"+t+"_date_"+i+"_param").data("ParameterInfos",{Name:a,Id:0<o.length?o[0].parameterID:a})},e.prototype.renderDateAttribute=function(e,t,i){var a,o,s;this.dashboardDesigner.element.find("#"+t+"_query_date_"+i+"_parameter_dropdown").css("display","none"),a=BoldBIDashboard.buildTag("td","",{"padding-left":"End"===i?"20px":"10px",display:"none"},{id:t+"_query_date_"+i+"_attr_dropdown"}),o=BoldBIDashboard.buildTag("input.e-textbox","",{height:"30px",width:"160px"},{type:"text",id:t+"_date_"+i+"_attr"}),a.append(o),s=!BoldBIDashboard.isNullOrUndefined(this.customAttributeList)&&0<this.customAttributeList.length?this.customAttributeList[0].value:null,o.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:o.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:this.customAttributeList,enabled:!0,value:s,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.setAttributeValueInfo,this,t,i,this.customAttributeList)}),e.append(a),this.dashboardDesigner.element.find("#"+t+"_date_"+i+"_attr").data("AttributeInfos",{Name:0<this.customAttributeList.length?this.customAttributeList[0].text:null,Value:0<this.customAttributeList.length?this.customAttributeList[0].value:null})},e.prototype.setAttributeValueInfo=function(e,t,i,a){var t=this.dashboardDesigner.element.find("#"+e+"_date_"+t+"_attr"),o=this.dashboardDesigner.element.find("#"+e+"_date_Start_param"),e=this.dashboardDesigner.element.find("#"+e+"_date_End_param"),a={Name:a.text,Value:a.value};t.data("AttributeInfos",a),o.data("ParameterInfos",null),e.data("ParameterInfos",null)},e.prototype.parameterBtwChangeEvent=function(e,t,i,a){var o=this.dashboardDesigner.element.find("#"+e+"_date_Start_attr"),s=this.dashboardDesigner.element.find("#"+e+"_date_End_attr"),e=this.dashboardDesigner.element.find("#"+e+"_date_"+t+"_param"),t=a.model.dataSource.filter(function(e){return e.value===a.value}),t={Name:a.value,Id:0<t.length?t[0].parameterID:a.value};o.data("AttributeInfos",null),s.data("AttributeInfos",null),e.data("ParameterInfos",t)},e.prototype.resetAttributes=function(e,t){e.removeAttr("IsLoaded"),e.removeAttr("Range"),e.removeAttr("StartDate"),e.removeAttr("EndDate"),e.removeAttr("IsPopulate"),this.getStartPicker(t).removeAttr("minDateTime"),this.getEndPicker(t).removeAttr("minDateTime")},e.prototype.showLoadingIndicator=function(e){this.getFieldDiv(e).BoldBIDashboardWaitingPopup("show"),this.getRangeRadioBtn(e).prop("disabled",!0),this.getStartRadioBtn(e).prop("disabled",!0),this.getEndRadioBtn(e).prop("disabled",!0)},e.prototype.hideLoadingIndicator=function(e){this.getFieldDiv(e).BoldBIDashboardWaitingPopup("hide"),this.getRangeRadioBtn(e).prop("disabled",!1),this.getStartRadioBtn(e).prop("disabled",!1),this.getEndRadioBtn(e).prop("disabled",!1)},e.prototype.populateDateRangeDrpDwn=function(e,t,i,a,o,s,n){this.targetTag.find("#"+e+"_dateRange_multidDrpDwn").off("click",this.bbdesigner$.proxy(this.showPopupContainer,this,e,t,i,a,n,s)),this.targetTag.find("#"+e+"_dateRange_multidDrpDwn").on("click",this.bbdesigner$.proxy(this.showPopupContainer,this,e,t,i,a,n,s)),this.populateDateRangePopup(e,o)},e.prototype.resetDateRangeDrpDwn=function(e){BoldBIDashboard.isNullOrUndefined(this.dateRangePopUp)||this.dateRangePopUp.remove(),this.dateRangePopUp=null,this.renderDateRangePopup(e)},e.prototype.renderDateRangeDrpDwn=function(e,t,i,a,o,s,n){this.filterInfo=o,this.targetTag=t;var o=BoldBIDashboard.buildTag("div.list bbi-popup-button","",{width:n||"144px"},{id:e+"_dateRange_multidDrpDwn","e-target":"bbi-daterange-popup"}),r=BoldBIDashboard.buildTag("div.bbi-date-range-drp-dwn-text","",{width:n?n-39+"px":"calc(100% - 35px)"},{id:e+"_dateRange_multiDrpDwn_txt",text:"Date Options"}),d=BoldBIDashboard.buildTag("div.bbi-date-range-drp-dwn-btn","",{},{}),l=BoldBIDashboard.buildTag("span.bbi-designer-ejwidgets-updown e-icon e-arrow-sans-down bbi-date-range-drpdwn-icon","",{});d.append(l),o.append(r).append(d),r.text("Date Options"),t.append(o),o.attr("e-targetId",e+"_dateRange_popup"),o.bind("click",this.bbdesigner$.proxy(this.showPopupContainer,this,e,t,i,a,n,s)),BoldBIDashboard.isNullOrUndefined(this.filterInfo)||this.populateDateRangePopup(e,this.filterInfo)},e.prototype.updateIconIndication=function(e,t){var i=this.getDateRangeDrpDwn(t);"block"===e.css("display")?(i.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-down").addClass("e-arrow-sans-up"),i.addClass("e-focus"),this.enableApplyButton(t)):(i.find(".bbi-designer-ejwidgets-updown").removeClass("e-arrow-sans-up").addClass("e-arrow-sans-down"),i.removeClass("e-focus"))},e.prototype.renderRadioButton=function(e,t,i,a,o){var s=this.bbdesigner$("<td unselectable='on'/>");o.append(s),o=BoldBIDashboard.buildTag("div","",{},{}),i={callBackInstance:this,callBackMethod:"onRangeTypeChange",optionalArgs:t,groupName:"formatting",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:i,label:e,isChecked:a,value:t}]},this.selectRadioButton=new BoldBIDashboard.Dashboard.RadioButton(i,o),s.append(o)},e.prototype.renderDateRangePicker=function(e,t,i,a,o,s){var n=BoldBIDashboard.buildTag("td","",{}),r=BoldBIDashboard.buildTag("Label.bbi-designer-add-label",i,{},{type:"label"}),d=BoldBIDashboard.buildTag("td","",{"padding-left":"Start"===i?"9px":"15px",display:"block"},{id:e}),e=BoldBIDashboard.buildTag("input.bbi-popup-button","",{},{type:"text",id:e+"_picker"});n.append(r),d.append(e),a.append(n),this.renderDateAttribute(a,t,i),this.renderDateParameter(a,t,i),a.append(d),e.BoldBIDashboardDateTimePicker({width:"201px",height:"26px",change:this.bbdesigner$.proxy(o,s,t),cssClass:"bbi-designer-border bbi-popup-button e-dashboarddesigner-widget"})},e.prototype.showPopupContainer=function(e,t,i,a,o,s){var n,r=this.renderDateRangePopup(e),d=this.dashboardDesigner.element.find("#"+e+"_param"),l=(this.selectedValue=d.data("selectedType"),d="Parameters"!==this.selectedValue,n="Custom Attributes"!==this.selectedValue,this.parameterList=(d?this:this.dashboardDesigner.modules.queryFilter).parameterList,r.height()),h="block"===r.css("display"),p=t.offset();r.css({display:h?"none":"block","z-index":BoldBIDashboard.getMaxZindex()});h=l<window.innerHeight-(p.top+t.height())?p.top+t.height()+2:p.top-l-4;r.offset({left:p.left+parseFloat(t.css("padding-left"))-(o?26:126),top:h}),d?this.updateIconIndication(r,e):r.find("#"+e+"_dateRange_okBtn").removeAttr("disabled"),n?this.updateIconIndication(r,e):r.find("#"+e+"_dateRange_okBtn").removeAttr("disabled"),"block"===r.css("display")&&d&&(BoldBIDashboard.isNullOrUndefined(r.attr("IsLoaded"))||"false"===r.attr("IsLoaded")?(l=[{Id:a.Id,Name:a.Name,SummaryType:"None",Sorting:"Ascending",FieldType:"Dimensions",MeasureFormatting:null,DateTimeFormat:"Date",FilterInfo:null}],this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,fieldInfo:l,dataSetId:i,type:"date",dateRangeType:s,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.setFieldInformation,this,e),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this,e),this.bbdesigner$.proxy(this.hideLoadingIndicator,this,e)]})):this.setDatePopupValues(e))},e.prototype.setFieldInformation=function(e,t){var i,a=this.renderDateRangePopup(e),o=this.dashboardDesigner.element.find("#"+e+"_dateRange_Start_picker"),s=this.dashboardDesigner.element.find("#"+e+"_dateRange_end_picker"),n=o.data("BoldBIDashboardDateTimePicker"),r=s.data("BoldBIDashboardDateTimePicker");BoldBIDashboard.isNullOrUndefined(n.model)||(n.model.dateTimeFormat=this.dateFormat,r.model.dateTimeFormat=this.dateFormat),i=BoldBIDashboard.format(BoldBIDashboard.parseDate(t.MinValue,this.dateFormat),this.dateFormat),t=BoldBIDashboard.format(BoldBIDashboard.parseDate(t.MaxValue,this.dateFormat),this.dateFormat),a.attr("isLoaded","true"),o.attr("minDateTime",i).attr("maxDateTime",t),s.attr("minDateTime",i).attr("maxDateTime",t),n.setModel({minDateTime:i,maxDateTime:t}),r.setModel({minDateTime:i,maxDateTime:t}),"true"===a.attr("IsPopulate")?this.setDatePopupValues(e):(n.setModel({value:i}),r.setModel({value:t}))},e.prototype.setAttributeValues=function(e){this.renderDateRangePopup(e)},e.prototype.setDatePopupValues=function(e){var t=this.renderDateRangePopup(e),i=BoldBIDashboard.isNullOrUndefined(t.attr("Range"))?DateFormatOption.Range.toString():t.attr("Range"),a=BoldBIDashboard.isNullOrUndefined(t.attr("StartDate"))?"":t.attr("StartDate"),t=BoldBIDashboard.isNullOrUndefined(t.attr("EndDate"))?"":t.attr("EndDate"),o="block",s="block",n=this.getStartTr(e),r=this.getEndTr(e),d=this.getRangeRadioBtn(e),l=this.getStartRadioBtn(e),h=this.getEndRadioBtn(e);i===DateFormatOption.StartDate.toString()?(d.prop("checked",!1),l.prop("checked",!0),h.prop("checked",!1),s="none",o="block"):i===DateFormatOption.EndDate.toString()?(d.prop("checked",!1),l.prop("checked",!1),h.prop("checked",!0),s="block",o="none"):(d.prop("checked",!0),l.prop("checked",!1),h.prop("checked",!1)),n.css("display",o),r.css("display",s),this.getStartPicker(e).data("BoldBIDashboardDateTimePicker").setModel({value:0===a.length?this.getStartPicker(e).attr("minDateTime"):a}),this.getEndPicker(e).data("BoldBIDashboardDateTimePicker").setModel({value:0===t.length?this.getEndPicker(e).attr("maxDateTime"):t}),this.enableApplyButton(e)},e.prototype.closeDateRangePopup=function(e){var t=this.renderDateRangePopup(e);t.css("display","none"),this.updateIconIndication(t,e)},e.prototype.updateDateFormatCondition=function(e,t){var i=this.getRangeRadioBtn(e),a=this.getStartRadioBtn(e),o=this.getEndRadioBtn(e),s="block",n="block",r=this.getStartTr(e),e=this.getEndTr(e);t===DateFormatOption.StartDate.toString()?(i.prop("checked",!1),a.prop("checked",!0),o.prop("checked",!1),n="none",s="block"):t===DateFormatOption.EndDate.toString()?(i.prop("checked",!1),a.prop("checked",!1),o.prop("checked",!0),n="block",s="none"):(i.prop("checked",!0),a.prop("checked",!1),o.prop("checked",!1)),r.css("display",s),e.css("display",n)},e.prototype.populateDateRangePopup=function(e,t){var i;BoldBIDashboard.isNullOrUndefined(this.dateRangePopUp)||this.dateRangePopUp.remove(),this.dateRangePopUp=null,i=this.renderDateRangePopup(e),this.filterInfo=t,this.getDateRangeDrpDwnTxt(e).text("Date Options"),this.updateIconIndication(i,e),i.attr("IsPopulate","true"),BoldBIDashboard.isNullOrUndefined(t)?(this.resetAttributes(i,e),this.updateDateFormatCondition(e,DateFormatOption.Range.toString())):(i.attr({StartDate:t.StartDate,EndDate:t.EndDate,Range:t.DateFormatCondition}),i=t.DateFormatCondition,this.updateDateFormatCondition(e,i))},e.prototype.updateDateRangeAttr=function(e){var t=this.renderDateRangePopup(e),i=this.getStartRadioBtn(e).prop("checked"),a=this.getEndRadioBtn(e).prop("checked"),o=this.getStartPicker(e).data("BoldBIDashboardDateTimePicker").getValue(),s=this.getEndPicker(e).data("BoldBIDashboardDateTimePicker").getValue();t.css("display","none"),this.updateIconIndication(t,e),this.hideErrorIndicator(e),t.attr("StartDate",o),t.attr("EndDate",s),a?t.attr("Range",DateFormatOption.EndDate.toString()):i?t.attr("Range",DateFormatOption.StartDate.toString()):t.attr("Range",DateFormatOption.Range.toString())},e.prototype.hideErrorIndicator=function(e){e=this.dashboardDesigner.element.find("#"+e).find(".e-error-tip");0<e.length&&e.css("display","none")},e.prototype.getDateRangeValues=function(e){var e=this.renderDateRangePopup(e),t=BoldBIDashboard.isNullOrUndefined(e.attr("Range"))?DateFormatOption.Range.toString():e.attr("Range"),t=(t===DateFormatOption.StartDate.toString()?DateFormatOption.StartDate:t===DateFormatOption.EndDate.toString()?DateFormatOption.EndDate:DateFormatOption.Range).toString(),i=BoldBIDashboard.isNullOrUndefined(e.attr("StartDate"))?"":e.attr("StartDate"),e=BoldBIDashboard.isNullOrUndefined(e.attr("EndDate"))?"":e.attr("EndDate");return{StartDate:i,EndDate:e,DateFormatCondition:t,IsFilterApplied:""!==i||""!==e}},e.prototype.onRangeTypeChange=function(e){var t=e.args.value,i=this.getStartRadioBtn(t).prop("checked"),a=this.getEndRadioBtn(t).prop("checked"),o=this.getStartTr(t),s=this.getEndTr(t),n=this.dashboardDesigner.element.find("#"+t+"_param").data("selectedType"),r="Parameters"===n,d=(d=(BoldBIDashboard.isNullOrUndefined(this.parameterList)&&r?this.dashboardDesigner.modules.queryFilter:this).parameterList).filter(function(e){return e.dataType===DynamicParameterDataType.Date}),d=!BoldBIDashboard.isNullOrUndefined(d)&&0<d.length?d[0].value:null;"change"===e.args.event.type&&(i?(s.css("display","none"),o.css("display","block"),r&&this.dashboardDesigner.modules.queryFilter.setDataForDateDropdowns(t,d,null,n)):a?(o.css("display","none"),s.css({display:"block","margin-top":"6px"}),r&&this.dashboardDesigner.modules.queryFilter.setDataForDateDropdowns(t,null,d,n)):(o.css("display","block"),s.css({display:"block","margin-top":"6px"}),r&&this.dashboardDesigner.modules.queryFilter.setDataForDateDropdowns(t,d,d,n)))},e.prototype.onPickerChange=function(e,t){t.isInteraction&&this.enableApplyButton(e)},e.prototype.enableApplyButton=function(e){var t=this.getStartPicker(e).data("BoldBIDashboardDateTimePicker").getValue(),i=this.getEndPicker(e).data("BoldBIDashboardDateTimePicker").getValue(),a=this.getStartPicker(e).attr("minDateTime"),o=this.getStartPicker(e).attr("maxDateTime"),s=this.getApplyBtn(e),n=this.getStartRadioBtn(e).prop("checked"),e=this.getEndRadioBtn(e).prop("checked");BoldBIDashboard.DashboardUtil.buttonEnable(s,n?t!==a:!e&&t!==o||i!==o)},e.prototype.updateDateFormat=function(){this.dateFormat=this.dashboardDesigner.model.localeSettings.dateFormat+" "+this.dashboardDesigner.model.localeSettings.timeFormat},e.prototype.getRangeRadioBtn=function(e){return this.dashboardDesigner.element.find("#"+e+"_RangeBtn_rdo_input")},e.prototype.getStartRadioBtn=function(e){return this.dashboardDesigner.element.find("#"+e+"_startBtn_rdo_input")},e.prototype.getEndRadioBtn=function(e){return this.dashboardDesigner.element.find("#"+e+"_endBtn_rdo_input")},e.prototype.getDateRangeDrpDwn=function(e){return this.targetTag.find("#"+e+"_dateRange_multidDrpDwn")},e.prototype.getStartPicker=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_Start_picker")},e.prototype.getEndPicker=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_end_picker")},e.prototype.getStartTr=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_start_tr")},e.prototype.getEndTr=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_end_tr")},e.prototype.getDateRangeDrpDwnTxt=function(e){return this.targetTag.find("#"+e+"_dateRange_multiDrpDwn_txt")},e.prototype.getApplyBtn=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_okBtn")},e.prototype.getFieldDiv=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_fieldDiv")},e.prototype.updateParameterListInfo=function(e){this.parameterList=e},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DateRangePopup",InternalDateRangePopup,window),function(e){e[e.Range="Range"]="Range",e[e.StartDate="StartDate"]="StartDate",e[e.EndDate="EndDate"]="EndDate"}(DateFormatOption=DateFormatOption||{}),InternalExpressionParsor=function(){function e(){this.revfnctions={},this.expErrors=[],this.expErrors=[]}return e.prototype.parseExpression=function(e){var t,i;for(this.expression=e,this.provider="SQL",this.expErrors=[],this.parseDateExp(),this.parseNumExp(),this.parseStrExp(),this.parseCondExp(),i=(t=Object.keys(this.revfnctions)).length-1;0<=i;i--)this.revfnctions[t[i]]&&(this.expression=this.expression.split(t[i]).join(this.revfnctions[t[i]]));return this.expression},e.prototype.parseErrors=function(e,t){return this.parseExpression(e,t),this.expErrors},e.prototype.parseNumExp=function(){BoldBIDashboard.DashboardUtil.contains(this.expression,"abs(",!0)&&(this.expression=this.parseNumberExp(this.expression,"abs(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"acos(",!0)&&(this.expression=this.parseNumberExp(this.expression,"acos(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"asin(",!0)&&(this.expression=this.parseNumberExp(this.expression,"asin(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"atan(",!0)&&(this.expression=this.parseNumberExp(this.expression,"atan(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"cos(",!0)&&(this.expression=this.parseNumberExp(this.expression,"cos(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"cot(",!0)&&(this.expression=this.parseNumberExp(this.expression,"cot(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"ceil(",!0)&&(this.expression=this.parseNumberExp(this.expression,"ceil(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"degrees(",!0)&&(this.expression=this.parseNumberExp(this.expression,"degrees(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"exp(",!0)&&(this.expression=this.parseNumberExp(this.expression,"exp(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"floor(",!0)&&(this.expression=this.parseNumberExp(this.expression,"floor(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"log(",!0)&&(this.expression=this.parseNumberExp(this.expression,"log(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"mod(",!0)&&(this.expression=this.parseNumberExp(this.expression,"mod(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"pi(",!0)&&(this.expression=this.parseNumberExp(this.expression,"pi(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"power(",!0)&&(this.expression=this.parseNumberExp(this.expression,"power(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"totalpercentage(",!0)&&(this.expression=this.parseNumberExp(this.expression,"totalpercentage(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"radians(",!0)&&(this.expression=this.parseNumberExp(this.expression,"radians(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"round(",!0)&&(this.expression=this.parseNumberExp(this.expression,"round(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"sign(",!0)&&(this.expression=this.parseNumberExp(this.expression,"sign(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"sin(",!0)&&(this.expression=this.parseNumberExp(this.expression,"sin(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"sqrt(",!0)&&(this.expression=this.parseNumberExp(this.expression,"sqrt(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"tan(",!0)&&(this.expression=this.parseNumberExp(this.expression,"tan("))},e.prototype.parseNumberExp=function(e,t){var i,a,o,s,n=this.getExpCode(),r=this.trimEnd(t,"("),d=e;this.revfnctions[n]=this.updateNumberFunc(r).toUpperCase();do{}while(-1!==(s=d.toLowerCase().lastIndexOf(t))&&(a=s+t.length,i=this.getFunctionEndIndex(a,d),a=this.getParameters(d,a,i-a-1),o="",d=d.substr(0,s)+n+"("+(o="SQL"===this.provider?this.getSQLNumberExp(r,a):o)+(")"+d.substr(i))),-1!==s);return d},e.prototype.updateNumberFunc=function(e){return e},e.prototype.getSQLNumberExp=function(e,t){var i="";switch(e){case"pi":BoldBIDashboard.isNullOrUndefined(t)||this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"abs":case"acos":case"asin":case"atan":case"cos":case"cot":case"degrees":case"exp":case"floor":case"log":case"totalpercentage":case"radians":case"sign":case"sin":case"sqrt":case"tan":t&&1===t.length?i+=t[0]:this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"power":case"mod":t&&2===t.length?i+=t[0]+","+t[1]:this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"round":t&&1===t.length?(i+=t[0],"SQL"===this.provider&&(i+=",0")):!t||1!==t.length&&2!==t.length?this.expErrors.push("Invalid Arguments in"+e+"Expression"):i+=t[0]+","+t[1]}return i},e.prototype.parseDateExp=function(){"SQL"===this.provider&&(BoldBIDashboard.DashboardUtil.contains(this.expression,"currentyear(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"currentyear(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"currentmonth(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"currentmonth(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"dateadd(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"dateadd(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"datesub(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"datesub(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"datename(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"datename(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"datepart(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"datepart(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"daydiff(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"daydiff(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"today(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"today(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"previousyear(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"previousyear(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"previousmonth(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"previousmonth(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"yesterday(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"yesterday(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"day(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"day(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"hour(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"hour(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"minute(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"minute(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"month(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"month(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"now(",!0)&&(this.expression=this.parseSQLDateExp(this.expression,"now(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"year(",!0))&&(this.expression=this.parseSQLDateExp(this.expression,"year("))},e.prototype.parseSQLDateExp=function(e,t){var i,a,o,s=this.getExpCode(),n=this.trimEnd(t,"("),r=e;this.revfnctions[s]=this.updateDateFunc(n).toUpperCase();do{}while(-1!==(o=r.toLowerCase().lastIndexOf(t))&&(a=o+t.length,i=this.getFunctionEndIndex(a,r),a=this.getParameters(r,a,i-a-1),r=("today"===n||"yesterday"===n||"currentyear"===n||"currentmonth"===n||"previousyear"===n||"previousmonth"===n?r.substr(0,o)+s:r.substr(0,o)+s+"(")+this.getSQLDateExp(n,a)+("today"===n||"yesterday"===n||"currentyear"===n||"currentmonth"===n||"previousyear"===n||"previousmonth"===n?r.substr(i):")"+r.substr(i))),-1!==o);return r},e.prototype.updateDateFunc=function(e){var t;switch(e){case"dateadd":case"datesub":t="dateadd";break;case"daydiff":t="datediff";break;case"now":t="getdate";break;case"week":case"hour":case"minute":case"datepart":t="datepart";break;case"day":case"month":case"year":case"datename":case"yesterday":case"currentyear":case"currentmonth":case"previousmonth":case"previousyear":t=e;break;case"today":t="CAST(GETDATE() AS DATE)"}return t},e.prototype.getSQLDateExp=function(e,t){var i="";switch(e){case"dateadd":t&&3===t.length?i+=t[0]+","+t[1]+","+t[2]:this.expErrors.push("Invalid Arguments in"+e+"Expression");break;case"datesub":t&&1===t.length?i+="D, 0,"+t[0]:t&&2===t.length?i+="D, -"+t[0]+","+t[1]:this.expErrors.push("Invalid Arguments in"+e+"Expression");break;case"daydiff":t&&2===t.length?i+="D,"+t[0]+","+t[1]:this.expErrors.push("Invalid Arguments in"+e+"Expression");break;case"week":case"hour":case"minute":t&&1===t.length?i+=e.toUpperCase()+","+t[0]:this.expErrors.push("Invalid Arguments in"+e+"Expression");break;case"datename":case"datepart":t&&1===t.length&&(i+="D,"+t[0]),t&&2===t.length?i+=t[0]+","+t[1]:this.expErrors.push("Invalid Arguments in"+e+"Expression");break;case"day":case"month":case"year":t&&1===t.length?i+=t[0]:this.expErrors.push("Invalid Arguments in"+e+"Expression")}return i},e.prototype.parseCondExp=function(){"SQL"===this.provider&&(BoldBIDashboard.DashboardUtil.contains(this.expression,"coalesce(",!0)&&(this.expression=this.parseSQLCondExp(this.expression,"coalesce(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"ifnull(",!0)&&(this.expression=this.parseSQLCondExp(this.expression,"ifnull(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"if(",!0)&&(this.expression=this.parseSQLCondExp(this.expression,"if(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"isnull(",!0)&&(this.expression=this.parseSQLCondExp(this.expression,"isnull(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"isnotnull(",!0))&&(this.expression=this.parseSQLCondExp(this.expression,"isnotnull("))},e.prototype.parseSQLCondExp=function(e,t){var i,a,o,s,n,r=this.trimEnd(t,"("),d=e;if("ifnull"===r)d=this.parseSQLIFNullExp(e,t);else do{}while(-1!==(n=d.toLowerCase().lastIndexOf(t))&&(i=this.getExpCode(),a=n+t.length,s=this.getFunctionEndIndex(a,d),a=this.getParameters(d,a,s-a-1),o=d.substr(0,n)+i,s=d.substr(s),this.revfnctions[i]=this.getSQLCondExp(r,a),d=o+s),-1!==n);return d},e.prototype.parseSQLIFNullExp=function(e,t){var i,a,o,s=this.getExpCode(),n=this.trimEnd(t,"("),r=e;this.revfnctions[s]="ISNULL";do{}while(-1!==(o=r.toLowerCase().lastIndexOf(t))&&(a=o+t.length,i=this.getFunctionEndIndex(a,r),a=this.getParameters(r,a,i-a-1),r=r.substr(0,o)+s+"("+this.getSQLCondExp(n,a)+(")"+r.substr(i))),-1!==o);return r},e.prototype.getSQLCondExp=function(e,t){var i,a,o="";switch(e){case"if":t&&3===t.length?o+=" CASE WHEN "+t[0]+" THEN "+t[1]+" ELSE "+t[2]+" END ":this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"ifnull":t&&2===t.length?o+=t[0]+","+t[1]:this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"isnull":t&&1===t.length?o+=" CASE WHEN "+t[0]+" IS NULL THEN 'true' ELSE 'false' END ":this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"isnotnull":t&&1===t.length?o+=" CASE WHEN "+t[0]+" IS NULL THEN 'false' ELSE 'true' END ":this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"coalesce":if(i=!0,t&&1<t.length)for(a=0;a<t.length;a++)o+=(i=a===t.length-1?!1:i)?t[a].trim()+",":t[a].trim();else this.expErrors.push("Invalid Arguments in "+e+" Expression")}return o},e.prototype.parseStrExp=function(){BoldBIDashboard.DashboardUtil.contains(this.expression,"char(",!0)&&!BoldBIDashboard.DashboardUtil.contains(this.expression,"to_char(",!0)&&(this.expression=this.parseStringExp(this.expression,"char(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"concat(",!0)&&(this.expression=this.parseStringExp(this.expression,"concat(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"contains(",!0)&&(this.expression=this.parseStringExp(this.expression,"contains(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"endswith(",!0)&&(this.expression=this.parseStringExp(this.expression,"endswith(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"initCap(",!0)&&(this.expression=this.parseStringExp(this.expression,"initCap(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"left(",!0)&&(this.expression=this.parseStringExp(this.expression,"left(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"len(",!0)&&(this.expression=this.parseStringExp(this.expression,"len(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"lower(",!0)&&(this.expression=this.parseStringExp(this.expression,"lower(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"ltrim(",!0)&&(this.expression=this.parseStringExp(this.expression,"ltrim(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"max(",!0)&&(this.expression=this.parseStringExp(this.expression,"max(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"min(",!0)&&(this.expression=this.parseStringExp(this.expression,"min(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"replace(",!0)&&!BoldBIDashboard.DashboardUtil.contains(this.expression,"_replace(",!0)&&(this.expression=this.parseStringExp(this.expression,"replace(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"right(",!0)&&(this.expression=this.parseStringExp(this.expression,"right(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"rtrim(",!0)&&(this.expression=this.parseStringExp(this.expression,"rtrim(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"startswith(",!0)&&(this.expression=this.parseStringExp(this.expression,"startswith(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"substr(",!0)&&(this.expression=this.parseStringExp(this.expression,"substr(")),BoldBIDashboard.DashboardUtil.contains(this.expression,"trim(",!0)&&(this.expression=this.parseStringExp(this.expression,"trim("))},e.prototype.parseStringExp=function(e,t){var i,a,o,s,n,r=this.getExpCode(),d=this.trimEnd(t,"("),l=e,h=!0;this.revfnctions[r]=this.updateStringFunc(d).toUpperCase();do{}while(-1!==(n=l.toLowerCase().lastIndexOf(t))&&(s=n+t.length,o=this.getFunctionEndIndex(s,l),s=this.getParameters(l,s,o-s-1),"max"!==d&&"min"!==d&&"startswith"!==d&&"endswith"!==d&&"contains"!==d||(h=!1),i=l.substr(0,n)+(h?r+"(":""),a="","SQL"===this.provider&&(a=this.getSQLStringExp(d,s)),s=(h?")":"")+l.substr(o),l="max"===d||"min"===d?i+"("+a+")"+s:i+a+s),-1!==n);return l},e.prototype.updateStringFunc=function(e){var t;switch(e){case"contains":case"endswith":case"startswith":case"max":case"min":t="";break;case"substr":t="substring";break;default:t=e}return t},e.prototype.getSQLStringExp=function(e,t){var i,a,o,s="";switch(e){case"char":case"len":case"lower":case"ltrim":case"rtrim":case"trim":case"initCap":case"upper":case"max":case"min":t&&1===t.length?s+=t[0].trim():this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"left":case"right":t&&2===t.length?s+=t[0].trim()+","+t[1].trim():this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"replace":t&&3===t.length?s+=t[0].trim()+","+t[1].trim()+","+t[2].trim():this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"concat":if(i=!0,t&&1<t.length)for(a=0;a<t.length;a++)s+=(i=a===t.length-1?!1:i)?t[a].trim()+",":t[a].trim();else this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"contains":case"endswith":case"startswith":t&&2===t.length?(o=this.customizeSingleQuoteValues(e,t[1]),s+="CASE WHEN "+t[0]+" LIKE "+o+" THEN 'true' ELSE 'false' END"):this.expErrors.push("Invalid Arguments in "+e+" Expression");break;case"substr":t&&3===t.length?s+=t[0].trim()+","+t[1].trim()+","+t[2].trim():this.expErrors.push("Invalid Arguments in "+e+" Expression")}return s},e.prototype.customizeSingleQuoteValues=function(e,t){var i,a="",o=null,s=(s=t).trim();if(BoldBIDashboard.DashboardUtil.contains(s,"'",!0))for(i=0;i<s.length;i++)"'"!==s[i]&&(a+=s[i]);if(0<a.length)switch(e){case"contains":o="'%"+a+"%'";break;case"startswith":o="'"+a+"%'";break;case"endswith":o="'%"+a+"'"}else o=s;return o},e.prototype.getParameters=function(e,t,i){var a=e.substr(t,i);if(0===a.length)return null;for(var o=0,s=!1,n=0,r=0,d=[];n<a.length;n++)s||")"!==a[n]||o--,s||"("!==a[n]||o++,(s="'"!==a[n]||0!==n&&"\\"===a[n-1]?s:!s)||0!==o||","!==a[n]||(d.push(a.substr(r,n-r)),r=n+1);return d.push(a.substr(r,n-r)),d},e.prototype.getFunctionEndIndex=function(e,t){for(var i=e,a=1,o=!1;0<a;){if(i>=t.length)throw"Invalid Expression";o||")"!==t[i]||a--,o||"("!==t[i]||a++,'"'!==t[i]&&"'"!==t[i]||0!==i&&"\\"===t[i-1]||(o=!o),i++}return i},e.prototype.getExpCode=function(){for(var e="",t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",i=0;i<5;i++)e+=t.charAt(Math.floor(Math.random()*t.length));return"@"+e+"@"},e.prototype.trimEnd=function(e,t){t=e.lastIndexOf(t);return-1===t?e:e.trim().slice(0,t)},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ExpressionParsor",InternalExpressionParsor,window),InternalColumnMapping=function(){function e(e){this.columnMappingContainer=null,this.sourceTableDatasource=[],this.targetInstance=null,this.requestInfo=null,this.targetMethod="",this.locale=null,this.dsIds=null,this.columnMappingModel=null,this.tempMappingInfo=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.renderColumnMappingDialog()}return e.prototype.renderColumnMappingDialog=function(){this.columnMappingContainer=BoldBIDashboard.buildTag("div.e-column-mapping-dialog","",{},{id:this.dashboardDesigner._id+"_mappingcolumn_configuration"}),this.renderMappingBodyContainer(),this.columnMappingContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:750,minHeight:550,title:this.locale.userFilterLocale.columnMappingText,enableResize:!1,showOnInit:!1,showFooter:!0,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",enableModal:!0,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id}),this.columnMappingContainer.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.renderFooter()},e.prototype.renderMappingBodyContainer=function(){var e=BoldBIDashboard.buildTag("div.e-column-mapping-body-container","",{height:"100%",width:"100%"},{id:this.dashboardDesigner._id+"_mapping_column_body_container"});this.renderUpperBodyContainer(e),this.renderGridContainer(e)},e.prototype.renderUpperBodyContainer=function(e){var t=BoldBIDashboard.buildTag("table","",{width:"97%",margin:"0.5em 12px","padding-bottom":"5px"},{}),i=BoldBIDashboard.buildTag("tr","",{"padding-top":"10px"},{}),a=BoldBIDashboard.buildTag("td","",{},{});this.renderSourceTableContainer(a),e.append(t),t.append(i),i.append(a)},e.prototype.renderSourceTableContainer=function(e){var t=BoldBIDashboard.buildTag("div.e-source-table","",{height:"24px",width:"200px",padding:"4px 7px",float:"left"},{}),i=BoldBIDashboard.buildTag("span.bbi-designer-label",this.locale.mergedDataSource.sourceTable,{display:"inline-block",float:"left","line-height":"normal","font-weight":"500","margin-top":"8px",cursor:"default"}),a=BoldBIDashboard.buildTag("input","",{"font-size":"12px",float:"left"},{id:"source_table_datasource_column"});e.append(i,t),t.append(a),this.renderSourceTableDropDown()},e.prototype.renderGridContainer=function(e){var t=BoldBIDashboard.buildTag("div.e-dbrd-column-mapping-grid-container","",{margin:"10px",height:"440px",width:"730px"},{id:this.dashboardDesigner._id+"_mapping_grid_container"});t.BoldBIDashboardGrid({dataSource:this.getDefaultData(),allowPaging:!1,gridLines:BoldBIDashboard.Grid.GridLines.None,columns:[{field:"ItemId",headerText:"ItemID",width:200},{field:"ItemName",headerText:"ItemName",width:200}],allowSelection:!1,commonWidth:200,enableRowHover:!1}),e.append(t),this.columnMappingContainer.append(e)},e.prototype.renderFooter=function(){var e=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.mergedDataSource.updateMappingDialogText,{float:"right"},{id:this.dashboardDesigner._id+"_column_mapping_apply_btn",type:"button"}),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.mergedDataSource.closeMappingDialogText,{float:"right"},{id:this.dashboardDesigner._id+"_column_mapping_cancel_btn",type:"button"});e.on("click",this.bbdesigner$.proxy(this.applyColumnMapping,this)),t.on("click",this.bbdesigner$.proxy(this.closeMappingDialog,this)),this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_mappingcolumn_configuration_foot").append(t,e)},e.prototype.getDefaultData=function(){return[{ItemId:"i1",ItemName:"Item1",value:"1"},{ItemId:"i2",ItemName:"Item2",value:"2"},{ItemId:"i3",ItemName:"Item3",value:"3"},{ItemId:"i4",ItemName:"Item4",value:"4"},{ItemId:"i5",ItemName:"Item5",value:"5"},{ItemId:"i6",ItemName:"Item6",value:"6"}]},e.prototype.refreshScrollBarForGrid=function(){var e=this.getElementById(this.dashboardDesigner._id+"_mapping_grid_container");e.data("BoldBIDashboardGrid").option({allowScrolling:!0,scrollSettings:{width:e.width(),height:e.height()-e.find(".e-columnheader").height()-5,autoHide:!0,enableTouchScroll:!0}}),e.find(".e-table").css("width",e.width()),e.data("BoldBIDashboardGrid").getScrollObject().refresh()},e.prototype.renderDropDown=function(e,t){this.getElementById(t).BoldBIDashboardDropDownList({showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",width:"175px",height:"30px",dataSource:e.dataSource,fields:{text:"Name",value:"Id"},watermarkText:e.type,change:e.changeEvent,selectedIndex:e.index})},e.prototype.getMappingModel=function(e,t,i,a){return{type:e,dataSource:t,changeEvent:i,index:a}},e.prototype.renderSourceTableDropDown=function(){var e="source_table_datasource_column",t=this.getMappingModel(this.locale.mergedDataSource.sourceTable,this.sourceTableDatasource,this.bbdesigner$.proxy(this.changeSourceTable,this),-1);this.renderDropDown(t,e),BoldBIDashboard.isNullOrUndefined(this.tempMappingInfo)||this.setDropDownValue(e,this.tempMappingInfo.SourceTable)},e.prototype.resetColumnMappingDialog=function(){this.sourceTableDatasource=[],this.targetInstance=null,this.targetMethod="",this.tempMappingInfo=null,this.dsIds=[]},e.prototype.openMappingActionWindow=function(e){1<e.length&&(this.resetColumnMappingDialog(),this.dsIds=e,this.fetchMappingInfo())},e.prototype.fetchMappingInfo=function(e){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.publishMergeDatasource,{action:BoldBIDashboard.DashboardUtil.DesignerAction.PublishMergeDatasource,data:JSON.stringify({datasourceIdList:this.dsIds,fromcolumnmapping:!0,mappingschema:this.columnMappingModel,tableId:e})},{fnction:this.bbdesigner$.proxy(this.getMappingInfoSuccess,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]},!0,!0)},e.prototype.populateSourceTableDatasource=function(){var t=this;this.sourceTableDatasource=[],Object.keys(this.tempMappingInfo.TableList).forEach(function(e){t.sourceTableDatasource.push({Name:t.tempMappingInfo.TableList[e].Name,Id:e})}),this.renderSourceTableDropDown()},e.prototype.openMappingWindowFromQueryDesigner=function(e,t,i,a,o){void 0===o&&(o=null),this.resetColumnMappingDialog(),this.dsIds.push(a),this.tempMappingInfo=i,this.targetInstance=e,this.targetMethod=t,this.requestInfo=o,this.populateSourceTableDatasource(),this.mappingDialogAction(!0),this.refreshScrollBarForGrid(),this.disableSourceTable()},e.prototype.disableSourceTable=function(){var e=this.getElementById("source_table_datasource_column");!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&e.data("BoldBIDashboardDropDownList").disable()},e.prototype.getMappingInfoSuccess=function(e){null!==e.Data?(this.mappingDialogAction(!0),this.tempMappingInfo=JSON.parse(e.Data),this.populateSourceTableDatasource()):(this.mappingDialogAction(!1),this.dashboardDesigner.modules.util.alertDialog(this.locale.mergedDataSource.columnMapping,e.Message,IconType.errors,AlertType.Alert,!0,e,{height:200}))},e.prototype.getTemplate=function(e,t){return void 0===t&&(t=""),e?"<div><span>{{:Name}}</span></div>":'<input type="text" class="bbi-dropdown-element" id= "e_dbrd_grid_dropdown_'+t+'_{{:Id}}"></input>'},e.prototype.createColumn=function(e,t){this.getGridContainer().model.columns.push({headerText:e,template:t,width:200})},e.prototype.updateGridColumns=function(){var t=this,e=this.tempMappingInfo.TableList[this.tempMappingInfo.SourceTable],i=Object.keys(this.tempMappingInfo.TableList);this.createColumn(e.Name,this.getTemplate(!0)),i.forEach(function(e){e!==t.tempMappingInfo.SourceTable&&t.createColumn(t.tempMappingInfo.TableList[e].Name,t.getTemplate(!1,e))})},e.prototype.changeSourceTable=function(e){this.resetGridColumns();var t=this.getGridContainer();this.tempMappingInfo.SourceTable===e.selectedValue?(this.updateGridColumns(),this.destroyEjDropDownElements(),t.option("dataSource",this.tempMappingInfo.TableList[this.tempMappingInfo.SourceTable].FieldList),this.renderDropDownForTargetTable()):BoldBIDashboard.isNullOrUndefined(this.targetMethod)||BoldBIDashboard.isNullOrUndefined(this.targetInstance)?this.fetchMappingInfo(e.selectedValue):this.getColumnMappingInfo(e.selectedValue),this.refreshScrollBarForGrid()},e.prototype.destroyEjDropDownElements=function(){for(var e=this.columnMappingContainer.find(".bbi-dropdown-element.e-dropdownlist"),t=0;t<e.length;t++)this.dashboardDesigner.destroyEjBodyElements(this.bbdesigner$(e[t]))},e.prototype.getColumnMappingInfo=function(e){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.editDataSet,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataSetAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.ColumnMappingAction,dataSetId:this.dsIds[0],isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode,tableId:e})},{fnction:this.bbdesigner$.proxy(this.getMappingInfoSuccess,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]},!0,!0)},e.prototype.getGridContainer=function(){return this.getElementById(this.dashboardDesigner._id+"_mapping_grid_container").data("BoldBIDashboardGrid")},e.prototype.resetGridColumns=function(){var e=this.getGridContainer();BoldBIDashboard.isNullOrUndefined(e)||(e.model.columns=[],e.model.dataSource=[])},e.prototype.populateDataSource=function(t,i){var a=this,o=[];return Object.keys(this.tempMappingInfo.TableList).forEach(function(e){e===t&&(e=a.tempMappingInfo.TableList[t].FieldList,!BoldBIDashboard.isNullOrUndefined(e))&&0<e.length&&e.forEach(function(e){null!==e.DataType&&e.DataType!==i&&!a.IsMappingSupported(e,i)||o.push(e)})}),o},e.prototype.IsMappingSupported=function(e,t){var i=!1,a=!1,o=[];return o.push(e.DataType.toLowerCase()),o.push(t.toLowerCase()),o.forEach(function(e){"numeric"!==e&&"smallint"!==e&&"tinyint"!==e&&"integer"!==e&&"bigint"!==e&&!e.startsWith("numeric(")||(i=!0),("real"===e||"float"===e||e.startsWith("float(")||"decimal"===e||"double"===e||e.startsWith("decimal(")||"dec"===e||e.startsWith("dec("))&&(a=!0)}),!(!i||!a)},e.prototype.getSelectedIndex=function(e,t){if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length)for(var i=0;i<e.length;i++)if(e[i].Id===t)return i},e.prototype.renderDropDownForTargetTable=function(){var e,o=this;null!=this.tempMappingInfo.MappingInfo&&(e=Object.keys(this.tempMappingInfo.MappingInfo),!BoldBIDashboard.isNullOrUndefined(e))&&0<e.length&&e.forEach(function(a){var e=o.tempMappingInfo.MappingInfo[a];!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&e.forEach(function(e){var t=o.populateDataSource(a,e.DataType),i=o.getSelectedIndex(t,e.Id),t=o.getMappingModel("Select Column",t,null,i);o.renderDropDown(t,"e_dbrd_grid_dropdown_"+a+"_"+e.MappedColumnId)})})},e.prototype.mappingDialogAction=function(e){e?this.columnMappingContainer.data("BoldBIDashboardDialog").open():this.columnMappingContainer.data("BoldBIDashboardDialog").close()},e.prototype.updateMappingInfo=function(){var a=this,e=Object.keys(this.tempMappingInfo.MappingInfo);0<e.length&&e.forEach(function(i){a.tempMappingInfo.MappingInfo[i].forEach(function(e){var t="e_dbrd_grid_dropdown_"+i+"_"+e.MappedColumnId;e.Id=a.getDropDownValue(t),e.Name=a.getDropDownSelectedText(t)})})},e.prototype.applyColumnMapping=function(){this.updateMappingInfo(),this.columnMappingModel=this.tempMappingInfo,BoldBIDashboard.isNullOrUndefined(this.targetMethod)||BoldBIDashboard.isNullOrUndefined(this.targetInstance)||BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.columnMappingModel,this.tempMappingInfo.SourceTable,this.requestInfo]),this.mappingDialogAction(!1)},e.prototype.closeMappingDialog=function(){this.mappingDialogAction(!1)},e.prototype.getElementById=function(e){return this.columnMappingContainer.find("#"+e)},e.prototype.setDropDownValue=function(e,t){e=this.getElementById(e);!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length&&e.data("BoldBIDashboardDropDownList").selectItemByValue(t)},e.prototype.getDropDownValue=function(e){e=this.getElementById(e);return!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length?e.data("BoldBIDashboardDropDownList").getSelectedValue():null},e.prototype.getDropDownSelectedText=function(e){e=this.getElementById(e);return!BoldBIDashboard.isNullOrUndefined(e)&&0<e.length?this.bbdesigner$(e.data("BoldBIDashboardDropDownList").getSelectedItem()).text():null},e.prototype.showIndicator=function(){(this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_mappingcolumn_configuration_wrapper").is(":visible")?this.columnMappingContainer:this.dashboardDesigner.element.find(".bbi-designer-dslist-panel-container")).data("BoldBIDashboardWaitingPopup").show()},e.prototype.hideIndicator=function(){(this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_mappingcolumn_configuration_wrapper").is(":visible")?this.columnMappingContainer:this.dashboardDesigner.element.find(".bbi-designer-dslist-panel-container")).data("BoldBIDashboardWaitingPopup").hide()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ColumnMapping",InternalColumnMapping,window),this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}()),ColumnMappingInfo=function(){},TableSchema=function(){},FieldSchema=function(){},MappingSchema=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(SelectedField),BoldBIDashboard;!function(p){var a;function e(e,t,i,a){this.isOpen=!1,this.userBasedFilterInfo=new UserBasedFilterInfo,this.dsListPageNo=0,this.dsListSearchPageNo=0,this.isDSRefresh=!1,this.isRenderTriggered=!1,this.dsSearchKey="",this.locale=null,this.unMappedCheckBoxInst=null,this.disableDiv=null,this.designerInst=e,this.bbdesigner$=this.designerInst.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesignerInst=t,this.id=this.designerInst._id+"_uf_modes_adv",this.target=i,this.callbackMethod=a}a=p.Dashboard||(p.Dashboard={}),e.prototype.initLoader=function(){this.loader=this.target.find("#"+this.id).BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.designerInst.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},e.prototype.render=function(){var e,t,i,a;0===this.target.find("#"+this.id).length&&(e=p.buildTag("div","",{height:"100%",width:"100%"},{id:this.id}),t=p.buildTag("div","",{width:"100%","box-sizing":"border-box",display:"flex",height:"100%"}),i=p.buildTag("div","",{width:"30%",height:"100%","border-right":"1px solid var(--querydesigner-primary-border-color)"}),a=p.buildTag("div.bbi-dbrd-designer-adv-right-panel bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","<div style='padding:0 10px;'></div>",{width:"70%",height:"100%"},{id:this.id+"_right_panel"}),t.append(i,a),i.append(this.getDsListTemplate()),a.find("div:first").append(this.getCustomQueryTemplate(),this.getConfigurationUITemplate()),this.renderUnmappedCheckBox(a.find("#"+this.id+"_advanced_preview_btn_wrapper")),this.target.append(this.getSharedDsTemplate(),e.append(t)),a.BoldBIDashboardScroller({autoHide:!0,buttonSize:this.designerInst.scrollerSize.buttonSize,scrollerSize:this.designerInst.scrollerSize.scrollSize,height:506,width:558,enableTouchScroll:!0}))},e.prototype.initDsConfigurationObjects=function(){var e=this.target.find("#"+this.id+"_identity_type"),t=this.target.find("#"+this.id+"_identity_column"),i=this.target.find("#"+this.id+"_column_config_list");this.identityType=e.BoldBIDashboardDropDownList({width:240,cssClass:"bbi-dbrd-control e-combobox-control",dataSource:[{id:this.id+"_identity_type_email",value:"email",text:this.locale.userFilterLocale.emailText,type:IdentityType.Email},{id:this.id+"_identity_type_name",value:"name",text:this.locale.userFilterLocale.fullNameText,type:IdentityType.Name},{id:this.id+"_identity_type_groupName",value:"groupname",text:this.locale.userFilterLocale.groupNameText,type:IdentityType.GroupName}],selectedIndex:0}).data("BoldBIDashboardDropDownList"),this.identityColumn=t.BoldBIDashboardDropDownList({width:240,cssClass:"bbi-dbrd-control e-combobox-control",fields:{id:"Id",value:"Name",text:"Name"},selectedIndex:0,change:this.bbdesigner$.proxy(this.onIdentityColumnSelect,this)}).data("BoldBIDashboardDropDownList"),this.columnListBox=i.BoldBIDashboardListBox({cssClass:"bbi-dbrd-control bbi-dbrd-uf-column-config-list",width:"100%",showCheckbox:!0,template:"<div class='bbi-dbrd-uf-column-config-tmplt-wrapper'><span data-tooltip='${Name}' class='bbi-drbd-uf-column-config-column-name bbi-dbrd-designer-hoverable'>${Name}</span><span class='bbi-dbrd-uf-column-config-alias-wrapper'><div id='"+this.id+"_uf_${Id}'></div><span class='bbi-designer-errorinfo bbi-dbrd-designer-hoverable' data-tooltip='"+this.locale.userFilterLocale.columnConfigErrorMsg+"'></span></span></div>",fields:{id:"Id",value:"Name",text:"Name"},checkChange:this.bbdesigner$.proxy(this.onColumnListItemClick,this)}).data("BoldBIDashboardListBox")},e.prototype.enableButton=function(e,t){p.DashboardUtil.buttonEnable(e,t)},e.prototype.onIdentityColumnSelect=function(e){for(var t,i,a=null,o=this.columnListBox._disabledItems.length-1;0<=o;o--)(t=(a=this.columnListBox.getItemByIndex(p.parseInt(this.columnListBox._disabledItems[o]))).item.find("#"+this.id+"_uf_"+a.data.Id+"_wrapper_input").data("BoldBIDashboardDropDownList"))&&t.enable(),this.columnListBox.enableItemByIndex(p.parseInt(this.columnListBox._disabledItems[o]));(i=(a=this.columnListBox.getItemByIndex(e.itemId)).item.find("#"+this.id+"_uf_"+a.data.Id+"_wrapper_input").data("BoldBIDashboardDropDownList"))&&i.disable(),this.columnListBox.uncheckItemByIndex(e.itemId),this.columnListBox.disableItemByIndex(e.itemId),this.updateModificationStatus()},e.prototype.onColumnListItemClick=function(e){var t;e.isInteraction&&(this.isHierarchicalConnection()?(t=this.target.find("#"+this.id+"_uf_"+e.data.Id).data("DesignerPropertyWidget").getSelection(),p.isNullOrUndefined(t.value)||""===t.value.trim()):(t=this.target.find("#"+this.id+"_uf_"+e.data.Id+"_wrapper_input").data("BoldBIDashboardDropDownList"),p.isNullOrUndefined(t)||""===t.getSelectedValue()))&&(this.columnListBox.uncheckItemByIndex(e.index),e.item.find(".bbi-designer-errorinfo").css("visibility","visible")),this.updateModificationStatus()},e.prototype.updateModificationStatus=function(){!p.isNullOrUndefined(this.columnListBox)&&!p.isNullOrUndefined(this.identityColumn)&&0<this.columnListBox.getCheckedItems().length&&0<this.identityColumn.getSelectedValue().length?(this.setVaidateBtnState(!0),this.setSaveBtnState(!0),this.enableUnMappedCheckBox(!0)):(this.setVaidateBtnState(!1),this.setSaveBtnState(!1),this.enableUnMappedCheckBox(!1))},e.prototype.initDsListObjects=function(){this.dsListEle=this.target.find("#"+this.id+"_map_ds_list"),this.dsListEle.BoldBIDashboardScroller({autoHide:!0,buttonSize:this.designerInst.scrollerSize.buttonSize,scrollerSize:this.designerInst.scrollerSize.scrollSize,height:435,enableTouchScroll:!0,scroll:this.bbdesigner$.proxy(this.onDsListScroll,this)}),this.dsListEle.find("div:first").css("width","100%"),this.populateDsList()},e.prototype.initQueryModeObjects=function(){window.CodeMirror&&(this.queryModeObj=window.CodeMirror(this.target.find("#"+this.id+"_query_edit")[0],{mode:"text/x-sql",indentWithTabs:!0,smartIndent:!0,lineNumbers:!0,matchBrackets:!0,autofocus:!0,extraKeys:{"Ctrl-Space":"autocomplete"},hintOptions:{}}),this.queryModeObj.setSize("100%","100%"),this.queryModeObj.refresh())},e.prototype.getSearchTemplate=function(e){return"<div id='"+e+"_search_wrapper' class='bbi-dbrd-search-wrapper'><input type='text' placeholder='"+this.locale.userFilterLocale.waterMarkText+"' id='"+e+"_panel_search' class='bbi-dbrd-search-input bbi-autocomplete e-js e-input' style='width:85%'><span id='"+e+"_search_icon' class='bbi-headericon bbi-dbrd-designer-icon-search'></span></div>"},e.prototype.getDsListTemplate=function(){return"<div class='bbi-dbrd-uf-adv-ds-list-wrapper'><label class='e-dbrd-uf-label'>"+this.locale.userFilterLocale.mappingDataSource+"</label><div class='bbi-dbrd-uf-adv-ds-list-content'>"+this.getSearchTemplate(this.id+"_ds_search")+"<button type='button' class='bbi-dbrd-designer-refresh-ds bbi-dbrd-designer-hoverable bbi-dbrd-designer-hand-cursor bbi-dbrd-icon-background-theme'data-tooltip='"+this.locale.tableSelectorWindow.reloadButtonText+"' style='margin-left:5px;'></button></div></div><div class='bbi-dbrd-uf-dlg-splitter' style='width:94%;'></div><div class='bbi-dbrd-uf-adv-mode-ds-list .bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3' id='"+this.id+"_map_ds_list'><div><div class='bbi-dbrd-uf-map-ds-list-content'></div></div></div>"},e.prototype.renderSkelton=function(e){var t=p.buildTag("div","",{width:"225px",height:"160px",display:"block"},{id:e+"_wrapper"}),i=p.buildTag("div.bbi-empty-ds-title-block","",{},{id:e+"_title_blocks"}),a=p.buildTag("div.bbi-empty-ds-title bbi-empty-ds-list-loader","",{},{id:e+"_title_loading"}),e=p.buildTag("div.bbi-empty-ds-content bbi-empty-ds-list-loader","",{},{id:e+"_content_loading"}),o=i.append(a,e).clone();return t.append(o,i.append(a,e))},e.prototype.getCustomQueryTemplate=function(){return"<div class='bbi-dbrd-uf-adv-code-view-wrapper'><div class='bbi-dbrd-uf-adv-spacer bbi-dbrd-uf-label'>"+this.locale.userFilterLocale.queryModeText+"</div><div class='bbi-dbrd-uf-adv-code-content bbi-dbrd-uf-adv-spacer ' id='"+this.id+"_query_edit'></div><button type='button' class='bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-uf-adv-spacer bbi-dbrd-uf-adv-flex-right' id='"+this.id+"_run_query_btn'>"+this.locale.userFilterLocale.runText+"</button> </div>"},e.prototype.getConfigurationUITemplate=function(){return"<div class='bbi-dbrd-uf-adv-ds-config-wrapper'><div class='bbi-dbrd-uf-ds-config-identity-panel'><label class='bbi-dbrd-uf-label'>"+this.locale.userFilterLocale.identityText+"</label><div><div class='bbi-dbrd-uf-ds-config-identity-type-wrapper'><label>"+this.locale.userFilterLocale.typeText+"</label><span><input type='text' id='"+this.id+"_identity_type'/></span></div><div class='bbi-dbrd-uf-ds-config-identity-column-wrapper'><label>"+this.locale.userFilterLocale.columnText+"</label><span><input type='text' id='"+this.id+"_identity_column'/></span></div></div></div><label class='bbi-dbrd-uf-label' style='margin-bottom:5px;'>"+this.locale.userFilterLocale.columnMappingText+"</label><div class='bbi-dbrd-uf-column-config-list-wrapper'><div class='bbi-dbrd-uf-column-config-list-header'><span class='bbi-dbrd-label-left'>"+this.locale.userFilterLocale.mappingDataSource+"</span><span class='bbi-dbrd-label-right'>"+this.locale.userFilterLocale.currentDataSourceText+"</span></div><ul id='"+this.id+"_column_config_list'></ul></div><div id='"+this.id+"_advanced_preview_btn_wrapper'><button type='button' class='bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-uf-adv-spacer bbi-dbrd-uf-adv-flex-right' id='"+this.id+"_preview_data_btn' style='margin:5px 0;float:right;'>"+this.locale.userFilterLocale.previewText+"</button></div></div>"},e.prototype.renderUnmappedCheckBox=function(e){var t=p.buildTag("div.bbi-dbrd-uf-checkbox-element bbi-dbrd-designer-hoverable","",{},{id:this.id+"_unmpped_checkbox_div","data-tooltip":this.locale.userFilterLocale.showDataToUnmappedUserInfoText}),i=[];i.push({isChecked:!1,isDisabled:!1,name:"userUnmapped",id:this.id+"_unmpped_checkbox_div",label:this.locale.userFilterLocale.showDataToUnmappedUserText}),i={callBackInstance:this,cssClass:"e-small",callBackMethod:"onUmappedCheckBox",dataSource:i,labelPosition:a.LabelPosition.After},this.unMappedCheckBoxInst=new p.Dashboard.CheckBox(i,t),i=p.buildTag("div","",{float:"left",margin:"5px 0"},{}),this.disableDiv=p.buildTag("div.bbi-disable-functionalities","",{},{id:this.id+"_list_wrapper_panel_disable"}),i.append(t),this.disableDiv.append(i),e.append(this.disableDiv),this.enableUnMappedCheckBox(!1)},e.prototype.enableUnMappedCheckBox=function(e){p.isNullOrUndefined(this.disableDiv)||(e?this.disableDiv.removeClass("bbi-enable"):this.disableDiv.addClass("bbi-enable"))},e.prototype.updateUnmappedCheckBox=function(e){this.unMappedCheckBoxInst.checkItemByName("userUnmapped",e)},e.prototype.onUmappedCheckBox=function(e){e=0<e.checkedItems.length;p.isNullOrUndefined(this.userBasedFilterInfo.AdvancedFilter)||(this.userBasedFilterInfo.AdvancedFilter.ShowRecordsToUnmappedUsers=e)},e.prototype.getCheckBoxState=function(){return ejdashboard.base.getComponent(this.target.find("#"+this.id+"_unmpped_checkbox_div_chk_input")[0],"checkbox").checked},e.prototype.showDsListLoader=function(){this.hideDsListLoader(),this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").append(this.renderSkelton(this.id+"_skelton"))},e.prototype.showLoader=function(){this.loader.show()},e.prototype.hideDsListLoader=function(){this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content #"+this.id+"_skelton_wrapper").remove()},e.prototype.hideLoader=function(){this.loader.hide()},e.prototype.wireEvents=function(){this.target.on("click","#"+this.id+"_run_query_btn",this.bbdesigner$.proxy(this.onQueryRunBtnClick,this)),this.target.on("click","#"+this.id+"_preview_data_btn",this.bbdesigner$.proxy(this.onValidateDataBtnClick,this)),this.target.on("click",".bbi-dbrd-designer-refresh-ds",this.bbdesigner$.proxy(this.onDsRefreshBtnClick,this)),this.queryModeObj.on("change",this.bbdesigner$.proxy(this.onQueryEdit,this)),this.target.on("click",".bbi-dbrd-uf-column-config-tmplt-wrapper",this.bbdesigner$.proxy(this.onListItemOverlayClick,this)),this.target.on("click",".bbi-dbrd-designer-shared-ds-item",this.bbdesigner$.proxy(this.onDsListItemSelect,this)),this.target.on("keyup","#"+this.id+"_ds_search_panel_search",this.bbdesigner$.proxy(this.onDsListSearchKeyUp,this)),this.target.on("click",".bbi-headericon.bbi-dbrd-designer-icon-close",this.bbdesigner$.proxy(this.onDsSearchCancelClick,this))},e.prototype.unWireEvents=function(){this.target.off("click","#"+this.id+"_run_query_btn",this.bbdesigner$.proxy(this.onQueryRunBtnClick,this)),this.target.off("click","#"+this.id+"_preview_data_btn",this.bbdesigner$.proxy(this.onValidateDataBtnClick,this)),this.target.off("click",".bbi-dbrd-designer-refresh-ds",this.bbdesigner$.proxy(this.onDsRefreshBtnClick,this)),this.queryModeObj.off("change",this.bbdesigner$.proxy(this.onQueryEdit,this)),this.target.off("click",".bbi-dbrd-uf-column-config-tmplt-wrapper",this.bbdesigner$.proxy(this.onListItemOverlayClick,this)),this.target.off("click",".bbi-dbrd-designer-shared-ds-item",this.bbdesigner$.proxy(this.onDsListItemSelect,this)),this.target.off("keyup","#"+this.id+"_ds_search_panel_search",this.bbdesigner$.proxy(this.onDsListSearchKeyUp,this)),this.target.off("click",".bbi-headericon.bbi-dbrd-designer-icon-close",this.bbdesigner$.proxy(this.onDsSearchCancelClick,this))},e.prototype.onQueryEdit=function(){this.setRunBtnState(""!==this.queryModeObj.getValue().trim())},e.prototype.getAdvancedFilterInfo=function(){var e,t,i,a,o,s;if(this.target.find("#"+this.id+"_preview_data_btn").is("[disabled=disabled]"))return null;for(this.userBasedFilterInfo.Mode=UserBasedFilterMode.Advanced,(e=new AdvancedUserBasedFilter).IdentityFieldName=this.identityColumn.getSelectedValue(),e.DataSourceId=this.dataSourceId,e.ShowRecordsToUnmappedUsers=p.isNullOrUndefined(this.userBasedFilterInfo.AdvancedFilter)?this.getCheckBoxState():this.userBasedFilterInfo.AdvancedFilter.ShowRecordsToUnmappedUsers,t=this.identityType.getSelectedValue(),p.isNullOrUndefined(t)||(t=this.identityType.getItemDataByValue(t),e.Type=t[0].type),"query"===this.selectedMode?(e.CustomQuery=this.queryModeObj.getValue(),e.Mode=AdvancedFilterMode.CustomQuery):e.Mode=AdvancedFilterMode.Table,i=this.columnListBox.getCheckedItems(),a=0;a<i.length;a++)o=new SelectedField,this.isHierarchicalConnection()?(s=this.target.find("#"+this.id+"_uf_"+i[a].data.Id).data("DesignerPropertyWidget"),p.isNullOrUndefined(s)||(s=s.getSelection(),o.MappedColumnName=s.name,o.MappedColumnId=s.value)):(s=this.target.find("#"+this.id+"_uf_"+i[a].data.Id+"_wrapper_input").data("BoldBIDashboardDropDownList"),p.isNullOrUndefined(s)||(o.MappedColumnName=s.model.text,o.MappedColumnId=s.model.value)),o.Name=i[a].value,e.SelectedFields.push(o);return this.userBasedFilterInfo.AdvancedFilter=e,this.userBasedFilterInfo},e.prototype.onValidateDataBtnClick=function(){p.isNullOrUndefined(this.selectedMode)||"datasource"!==this.selectedMode&&"query"!==this.selectedMode||this.getAdvancedFilterInfo(),this.requestObj=this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.getPreviewData,{action:p.DashboardUtil.DesignerAction.GetPreviewData,data:JSON.stringify({dataSourceId:this.dataSourceId,UserBasedFilterInfo:this.userBasedFilterInfo})},{fnction:this.bbdesigner$.proxy(this.onValidationSuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoader,this),this.bbdesigner$.proxy(this.hideLoader,this)]})},e.prototype.onValidationSuccess=function(e){p.DashboardUtil.invokeCallBack(this.callbackMethod,{trigger:"preview",data:e,identityColumn:this.userBasedFilterInfo.AdvancedFilter.IdentityFieldName})},e.prototype.onListItemOverlayClick=function(e){this.bbdesigner$(e.currentTarget).parents("li").click()},e.prototype.onDsRefreshBtnClick=function(){this.isDSRefresh=!0,this.dsListPageNo=0,this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").html(""),this.populateDsList(!0)},e.prototype.onQueryRunBtnClick=function(){var e=this.queryModeObj.getValue();this.requestObj=this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.getColumnDetails,{action:p.DashboardUtil.DesignerAction.dataSourceCatalog,data:JSON.stringify({dataSetId:this.dataSourceId,CustomQuery:e})},{fnction:this.bbdesigner$.proxy(this.onIdentityColumnFetchFromCustomQuerySuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoader,this),this.bbdesigner$.proxy(this.hideLoader,this)]},!0,!0)},e.prototype.hideQueryOptions=function(){this.target.find(".bbi-dbrd-uf-adv-code-view-wrapper").hide()},e.prototype.populateDsList=function(e){this.requestObj=this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.shareddatasources,{action:p.DashboardUtil.DesignerAction.dataSourceCatalog,data:JSON.stringify({Page:p.isNullOrUndefined(this.dsSearchKey)||""===this.dsSearchKey.trim()?this.dsListPageNo:this.dsListSearchPageNo,SearchKey:this.dsSearchKey})},{fnction:this.bbdesigner$.proxy(this.onDsListFetchSuccess,this,e),indicator:[this.bbdesigner$.proxy(this.showDsListLoader,this),this.bbdesigner$.proxy(this.hideDsListLoader,this)]},!0,!0)},e.prototype.onDsListScroll=function(e){var t;!p.isNullOrUndefined(e.originalEvent)&&(0<this.dsListPageNo||0<this.dsListSearchPageNo)&&(t=this.dsListEle.height(),this.dsListEle.find(".bbi-dbrd-uf-map-ds-list-content").outerHeight()-t<=e.scrollTop)&&(this.resetRequest(),this.populateDsList(),this.refreshDsListScroller())},e.prototype.renderDsList=function(e,t){p.isNullOrUndefined(e)||(t?this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").html(this.target.find("#"+this.id+"_mapping_ds_template").render(this.removeCurrentDsFromDsList(e))):this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").append(this.target.find("#"+this.id+"_mapping_ds_template").render(this.removeCurrentDsFromDsList(e))),this.refreshDsListScroller())},e.prototype.onDsListFetchSuccess=function(e,t){t.Status?(p.isNullOrUndefined(this.dsListData)&&(this.dsListData=[]),p.isNullOrUndefined(this.dsSearchKey)||""===this.dsSearchKey.trim()?(this.dsListPageNo=t.Page,this.dsListData=e?t.Data:this.dsListData.concat(t.Data)):this.dsListSearchPageNo=t.Page,0<this.dsListData.length&&(this.renderDsList(t.Data,e),this.isOpen)&&(p.isNullOrUndefined(this.queryDesignerInst)||p.isNullOrUndefined(this.queryDesignerInst.userBasedFilterInfo)||p.isNullOrUndefined(this.queryDesignerInst.userBasedFilterInfo.AdvancedFilter)||this.fetchRemainingIfRequired(this.queryDesignerInst.userBasedFilterInfo.AdvancedFilter.DataSourceId,t.Data)),this.selectDsFromList(this.dataSourceId)):this.showNoDataInDsList(),this.updateModificationStatus()},e.prototype.fetchRemainingIfRequired=function(t,e){e=e.find(function(e){return e.Id===t});p.isNullOrUndefined(e)?0===this.dsListPageNo?(this.designerInst.modules.util.alertDialog(this.locale.userFilterLocale.dialogTitle,this.locale.userFilterLocale.dataSourcesRemovedMsg,IconType.information,AlertType.Alert,!1,""),this.isOpen=!1):this.populateDsList():this.selectDsFromList(t,!0)},e.prototype.showNoDataInDsList=function(){this.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").html("<center><p style='font-size:12px;'>"+this.locale.userFilterLocale.noResultsFound+"</p></center>")},e.prototype.removeCurrentDsFromDsList=function(e){var t=this;return p.isNullOrUndefined(this.queryDesignerInst.dataset)||"query"===this.selectedMode?e:e.filter(function(e){return e.Name!==t.queryDesignerInst.dataset.Name})},e.prototype.reset=function(){this.isRenderTriggered=!1,p.isNullOrUndefined(this.identityColumn)||this.identityColumn.setModel({dataSource:[]}),p.isNullOrUndefined(this.identityType)||this.identityType.selectItemByIndex(0),p.isNullOrUndefined(this.columnListBox)||(this.columnListBox.setModel({dataSource:[]}),this.columnListBox.uncheckAll()),p.isNullOrUndefined(this.queryModeObj)||(this.queryModeObj.setValue(""),this.queryModeObj.clearHistory()),this.resetDSSearch(),this.resetDSSelection(),this.setVaidateBtnState(!1),this.setRunBtnState(!1),this.enableUnMappedCheckBox(!1),this.resetRequest()},e.prototype.isModifiled=function(){var e=this.designerInst.element.find("#"+this.id+"_preview_data_btn");return!p.isNullOrUndefined(e.attr("disabled"))&&""===e.attr("disabled").trim()||!p.isNullOrUndefined(this.dataSourceId)&&""!==this.dataSourceId.trim()},e.prototype.hideElement=function(e){e?(this.identityColumn.disable(),this.columnListBox.disable(),this.queryModeObj.options.readOnly="nocursor"):(this.identityColumn.enable(),this.columnListBox.enable(),this.queryModeObj.options.readOnly=!1)},e.prototype.conformationDSChanges=function(e,t){e?(this.setVaidateBtnState(!1),this.setSaveBtnState(!1),this.enableUnMappedCheckBox(!1),this.requestObj=this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.getColumnDetails,{action:p.DashboardUtil.DesignerAction.dataSourceCatalog,data:JSON.stringify({dataSetId:this.dataSourceId})},{fnction:this.bbdesigner$.proxy(this.onIdentityColumnFetchSuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoader,this),this.bbdesigner$.proxy(this.hideLoader,this)],errfnction:this.bbdesigner$.proxy(this.onFetchError,this)},!0,!0)):(this.dataSourceId=t,this.selectDsFromList(this.dataSourceId))},e.prototype.onFetchError=function(e){this.hideElement(!0),this.designerInst.modules.util.alertDialog(this.locale.userFilterLocale.dialogTitle,e.responseJSON.Message,IconType.errors,AlertType.Alert,!0,e.responseText)},e.prototype.onIdentityColumnFetchFromCustomQuerySuccess=function(e){var t;e.Status?(t=JSON.parse(e.Data),this.identityColumn.setModel({dataSource:[]}),this.columnListBox.setModel({dataSource:[]}),this.columnListBox.uncheckAll(),this.setVaidateBtnState(!1),this.setSaveBtnState(!1),this.enableUnMappedCheckBox(!1),this.hideElement(!1),this.identityColumn.option("dataSource",t),this.columnListBox.option("dataSource",t),this.columnListBox.refresh(!0),this.initColumnListTemplate(t)):this.designerInst.modules.util.alertDialog(this.locale.alertDialogTitle.InvalidQueryStatement,this.locale.errorMessage.dataFetchingError,IconType.errors,AlertType.Alert,!0,e.Message)},e.prototype.initColumnListTemplate=function(e){var t,i,a,o,s=this.isHierarchicalConnection(),n=null;if(s&&!p.isNullOrUndefined(this.queryDesignerInst.dataset.TreeViewData)&&(t=JSON.parse(this.queryDesignerInst.dataset.TreeViewData),!p.isNullOrUndefined(t))&&!p.isNullOrUndefined(t.Dimension)&&0<t.Dimension.length&&(n=t.Dimension),!p.isNullOrUndefined(e)){for(i=0;i<e.length;i++)a=this.target.find("#"+this.id+"_uf_"+e[i].Id),s?(o={fields:{id:"ColumnId",parentId:"ParentId",hasChild:"HasChild",dataSource:n,text:"Name"},callBackInstance:this,callBackMethod:"columnListTemplateDdlSelect",popupHeight:"100%",width:"250px",height:"28px",optionalArgs:e[i].Id},new p.DashboardDesignerUtility.DropdownTreeview(this.designerInst,o,a)):(o=p.buildTag("input","",{"font-size":"12px"},{id:this.id+"_uf_"+e[i].Id+"_wrapper_input"}),a.append(o),o.BoldBIDashboardDropDownList({width:250,text:e[i].Name,dataSource:this.currentDsFields,fields:{id:"ID",text:"Name",value:"Name"},cssClass:"bbi-dbrd-control e-combobox-control",select:this.bbdesigner$.proxy(this.columnListTemplateDdlSelect,this,e[i].Id)}));this.columnListBox.scrollerObj.refresh()}},e.prototype.columnListTemplateDdlSelect=function(e){this.target.find("#"+e+" .bbi-designer-errorinfo").css("visibility","")},e.prototype.onIdentityColumnFetchSuccess=function(e){var d,l,h=this;e.Status&&("2001"===e.StatusCode?(this.designerInst.modules.util.alertDialog(this.locale.userFilterLocale.dialogTitle,this.locale.userFilterLocale.hierarhyDSErrorMsg,IconType.information,AlertType.Alert,!1,""),this.resetColumnTemplateUI()):(this.setSaveBtnState(!1),"query"!==this.selectedMode||this.isOpen?(d=JSON.parse(e.Data),this.identityColumn.option("dataSource",d),this.columnListBox.uncheckAll(),this.columnListBox.option("dataSource",d),this.columnListBox.refresh(!0),this.hideElement(!1),this.identityType.selectItemByIndex(0),(l=this).showLoader(),setTimeout(function(){var o;if(l.initColumnListTemplate(d),o=l.isHierarchicalConnection(),l.isOpen&&!p.isNullOrUndefined(l.queryDesignerInst)&&!p.isNullOrUndefined(l.queryDesignerInst.userBasedFilterInfo)&&!p.isNullOrUndefined(l.queryDesignerInst.userBasedFilterInfo.AdvancedFilter)){for(var s=JSON.parse(JSON.stringify(l.queryDesignerInst.userBasedFilterInfo.AdvancedFilter)),n=[],r=[],e=0;e<s.SelectedFields.length;e++)!function(t){var e,i=d.find(function(e){return e.Name===s.SelectedFields[t].Name}),a=null;p.isNullOrUndefined(i)?r.push(s.SelectedFields[t].Name+"("+h.locale.userFilterLocale.mappingDataSource+")"):(null!==s.SelectedFields[t].MappedColumnName&&""!==s.SelectedFields[t].MappedColumnName&&(o?(e=l.target.find("#"+l.id+"_uf_"+i.Id).data("DesignerPropertyWidget"),p.isNullOrUndefined(e)||e.selectItem(s.SelectedFields[t].MappedColumnId)||(i=null,r.push(s.SelectedFields[t].MappedColumnName))):(a=l.target.find("#"+l.id+"_uf_"+i.Id+"_wrapper_input").data("BoldBIDashboardDropDownList"),p.isNullOrUndefined(a)||(a.selectItemByValue(s.SelectedFields[t].MappedColumnId),""===a.getSelectedValue()&&(r.push(s.SelectedFields[t].MappedColumnName),i=null)))),p.isNullOrUndefined(i)||n.push(d.indexOf(i)))}(e);0!==r.length&&h.designerInst.modules.util.alertDialog(h.locale.userFilterLocale.dialogTitle,h.locale.userFilterLocale.columnsRemovedMsg,IconType.warning,AlertType.Alert,!0,h.getUnavailColumnList(r)),l.columnListBox.checkItemsByIndices(n),l.identityColumn.selectItemByValue(s.IdentityFieldName),l.identityType.selectItemByValue(p.DashboardDesignerUtility.Serialization.enumToString(IdentityType,s.Type).toLowerCase()),l.queryModeObj.setValue(s.CustomQuery),l.isOpen=!1}l.hideLoader()},0)):this.resetColumnTemplateUI()))},e.prototype.resetColumnTemplateUI=function(){this.identityType.selectItemByIndex(0),this.identityColumn.option("dataSource",[]),this.columnListBox.option("dataSource",[]),this.hideElement(!0),this.queryModeObj.setValue(""),this.queryModeObj.clearHistory(),this.queryModeObj.options.readOnly=!1,this.queryModeObj.focus()},e.prototype.getUnavailColumnList=function(e){for(var t="<ul style='padding-top:0;margin-top:0;'>",i=0;i<e.length;i++)t+="<li>"+e[i]+"</li>";return t+"</ul>"},e.prototype.showQueryOptions=function(){this.target.find(".bbi-dbrd-uf-adv-code-view-wrapper").show()},e.prototype.setSaveBtnState=function(e){this.callbackMethod({trigger:"savebtnstate",state:e})},e.prototype.setVaidateBtnState=function(e){this.enableButton(this.target.find("#"+this.id+"_preview_data_btn"),e)},e.prototype.setRunBtnState=function(e){this.enableButton(this.target.find("#"+this.id+"_run_query_btn"),e)},e.prototype.show=function(e,t){switch(this.currentDsFields=this.queryDesignerInst.tableType.filter(function(e){return"Real"!==e.DataType}),this.target.show(),this.reset(),this.renderIfRequired(),this.selectedMode=t,this.hideElement(!0),t){case"query":this.showQueryOptions();break;case"datasource":this.hideQueryOptions()}this.populateModel(e),this.refreshContentScroller()},e.prototype.renderIfRequired=function(){0===this.target.find("#"+this.id).length&&(this.isRenderTriggered=!0,this.render(),this.initLoader(),this.initQueryModeObjects(),this.initDsListObjects(),this.initDsConfigurationObjects(),this.unWireEvents(),this.wireEvents())},e.prototype.populateModel=function(e){this.renderDsList(this.dsListData,!0),!p.isNullOrUndefined(e)&&this.isOpen?(p.isNullOrUndefined(this.dsListData)||0===this.dsListData.lenght?this.isRenderTriggered||this.populateDsList():this.fetchRemainingIfRequired(e.DataSourceId,this.dsListData),this.updateUnmappedCheckBox(e.ShowRecordsToUnmappedUsers)):this.updateUnmappedCheckBox(!1)},e.prototype.hide=function(){this.target.hide()},e.prototype.resetRequest=function(){p.isNullOrUndefined(this.requestObj)||4===this.requestObj.readyState||(this.requestObj.abort(),this.requestObj=null)},e.prototype.onDsListItemSelect=function(e){var t,i;this.bbdesigner$(e.currentTarget).attr("data-id")!==this.dataSourceId&&(t=this.dataSourceId,this.dataSourceId=this.bbdesigner$(e.currentTarget).attr("data-id"),i=this.target.find("#"+this.id+"_preview_data_btn"),this.selectDsFromList(this.dataSourceId),this.isOpen||this.isDSRefresh||!p.isNullOrUndefined(i.attr("disabled"))?this.isDSRefresh||(this.setVaidateBtnState(!1),this.setSaveBtnState(!1),this.enableUnMappedCheckBox(!1),p.isNullOrUndefined(e))||(i="",!this.isOpen||p.isNullOrUndefined(this.queryDesignerInst)||p.isNullOrUndefined(this.queryDesignerInst.userBasedFilterInfo)||p.isNullOrUndefined(this.queryDesignerInst.userBasedFilterInfo.AdvancedFilter)||p.isNullOrUndefined(this.queryDesignerInst.userBasedFilterInfo.AdvancedFilter.CustomQuery)||(i="query"===this.selectedMode?this.queryDesignerInst.userBasedFilterInfo.AdvancedFilter.CustomQuery:""),this.requestObj=this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.getColumnDetails,{action:p.DashboardUtil.DesignerAction.dataSourceCatalog,data:JSON.stringify({dataSetId:this.dataSourceId,CustomQuery:i})},{fnction:this.bbdesigner$.proxy(this.onIdentityColumnFetchSuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoader,this),this.bbdesigner$.proxy(this.hideLoader,this)],errfnction:this.bbdesigner$.proxy(this.onFetchError,this)},!0,!0)):this.designerInst.modules.util.alertDialog(this.locale.userFilterLocale.dialogTitle,this.locale.userFilterLocale.resetSettingsMsg,IconType.question,AlertType.Confirm,!1,"",{dataInfo:t,instance:this,method:"conformationDSChanges"}),this.isDSRefresh=!1)},e.prototype.selectDsFromList=function(e,t){var i;p.isNullOrUndefined(e)||(i=this.dsListEle.find(".bbi-dbrd-designer-shared-ds-item[data-id="+e+"] .bbi-dbrd-designer-checkmark"),e=this.dsListEle.find(".bbi-dbrd-designer-shared-ds-item[data-id="+e+"]"),this.dsListEle.find(".bbi-dbrd-designer-shared-ds-item .bbi-dbrd-designer-checkmark").removeClass("bbi-dbrd-designer-checkmark-checked").addClass("bbi-dbrd-designer-checkmark-unchecked"),this.dsListEle.find(".bbi-dbrd-designer-shared-ds-item").removeClass("bbi-dbrd-designer-shared-ds-checked-item"),i.removeClass("bbi-dbrd-designer-checkmark-unchecked").addClass("bbi-dbrd-designer-checkmark-checked"),e.addClass("bbi-dbrd-designer-shared-ds-checked-item"),t&&0!==e.length&&(e.trigger("click"),i=this.dsListEle.data("BoldBIDashboardScroller"),p.isNullOrUndefined(i)||(i.option("scrollTop",0),i.option("scrollTop",e.offset().top-this.dsListEle.offset().top))))},e.prototype.refreshContentScroller=function(){var e=this.target.find("#"+this.id+"_right_panel").data("BoldBIDashboardScroller");p.isNullOrUndefined(e)||(e._eleWidth=e.model.width,e._eleHeight=e.model.height,e.refresh())},e.prototype.refreshDsListScroller=function(){var e=this.dsListEle.data("BoldBIDashboardScroller");p.isNullOrUndefined(e)||e.refresh()},e.prototype.onDsListSearchKeyUp=function(e){var t,i=this;!(48<=e.keyCode&&e.keyCode<=57||65<=e.keyCode&&e.keyCode<=90||186<=e.keyCode&&e.keyCode<=191||219<=e.keyCode&&e.keyCode<=222||8===e.keyCode||9===e.keyCode||13===e.keyCode||46===e.keyCode||32===e.keyCode)||e.ctrlKey||e.altKey||(p.isNullOrUndefined((t=this).searchTimer)||clearTimeout(this.searchTimer),this.searchTimer=setTimeout(function(){t.searchTimer=null,i.dsSearchKey=t.bbdesigner$(e.currentTarget).val(),0===i.dsSearchKey.trim().length?t.bbdesigner$(e.currentTarget).siblings(".bbi-headericon").addClass("bbi-dbrd-designer-icon-search").removeClass("bbi-dbrd-designer-icon-close"):t.bbdesigner$(e.currentTarget).siblings(".bbi-headericon").addClass("bbi-dbrd-designer-icon-close").removeClass("bbi-dbrd-designer-icon-search"),i.dsListEle.find("div:first .bbi-dbrd-uf-map-ds-list-content").html(""),i.dsListSearchPageNo=0,i.resetRequest(),""!==i.dsSearchKey.trim()||p.isNullOrUndefined(i.dsListData)||0===i.dsListData.length?i.populateDsList(!0):i.renderDsList(i.dsListData,!0)},10))},e.prototype.onDsSearchCancelClick=function(){this.resetDSSearch(),this.dsListSearchPageNo=0,this.resetRequest(),this.populateDsList(!0)},e.prototype.resetDSSearch=function(){this.dsSearchKey="",this.dsListSearchPageNo=0,this.target.find("#"+this.id+"_ds_search_panel_search").val(""),this.target.find(".bbi-headericon").removeClass("bbi-dbrd-designer-icon-close").addClass("bbi-dbrd-designer-icon-search")},e.prototype.resetDSSelection=function(){this.dataSourceId=null,p.isNullOrUndefined(this.dsListEle)||(this.dsListEle.find(".bbi-dbrd-designer-checkmark-checked").addClass("bbi-dbrd-designer-checkmark-unchecked").removeClass("bbi-dbrd-designer-checkmark-checked"),this.dsListEle.find(".bbi-dbrd-designer-shared-ds-checked-item").removeClass("bbi-dbrd-designer-shared-ds-checked-item"))},e.prototype.getSharedDsTemplate=function(){return"<script id='"+this.id+"_mapping_ds_template' type='text/x-jsrender'><div class='bbi-dbrd-designer-shared-ds-item' data-id='{{:Id}}' ><div class='bbi-dashboarddesigner-ds-selection-icon-column'><div class='bbi-dbrd-designer-checkmark bbi-dbrd-designer-checkmark-unchecked bbi-dbrd-designer-hoverable'></div></div><div class='bbi-dashboarddesigner-ds-content-column'><div class='bbi-dashboarddesigner-row  bbi-dbrd-ds-name'><span><label class='bbi-dbrd-designer-trim-label bbi-dbrd-designer-shared-ds-title bbi-dbrd-designer-hoverable' data-tooltip='{{:Name}} '>{{:Name}} </label></span><span class='bbi-dbrd-designer-checkmark bbi-dbrd-designer-checkmark-unchecked bbi-dbrd-designer-hoverable'></span></div><div class='bbi-dbrd-designer-shared-ds-content-label bbi-dashboarddesigner-row bbi-ds-modifiy-label'><div><span><label class='bbi-dbrd-ds-label'>Created by:&nbsp;</label></span><span><label class='bbi-dbrd-designer-hoverable bbi-dbrd-ds-content-label bbi-ds-createdby-content' data-tooltip='{{:CreatedUserName}}'>{{:CreatedUserName}}</label></div><div style='padding-top:5px;'><span><label class='bbi-dbrd-ds-label'>Modified by:&nbsp;</label></span><span><label class='bbi-dbrd-designer-hoverable bbi-dbrd-ds-content-label bbi-ds-modified-by-content' data-tooltip='{{:UpdatedUserName}}'>{{:UpdatedUserName}}</label></span></div></div></div></div><\/script>"},e.prototype.isHierarchicalConnection=function(){var e=p.Dashboard.ConnectionHelper.getConnectionInfoFromDSInfo(this.designerInst,this.queryDesignerInst.DatasourceInfo),e=p.Dashboard.ConnectionHelper.getConnectionInstance(this.designerInst,e,!0);return p.Dashboard.ConnectionHelper.isHierarchicalConnection(e)},e.prototype.resize=function(){this.refreshContentScroller(),this.refreshDsListScroller()},a.UFAdvancedMode=e}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(h){var a,o,t;function e(e,t,i){this.dialogBox=null,this.wrapper=null,this.contentPanel=null,this.waterMarkText=BoldBIDashboardDesigner.getLocale().userFilterLocale.waterMarkText,this.checkboxName="userFilter",this.totalItems=0,this._activeUser=null,this.selectedFieldInfo=null,this._currentActiveFilter=null,this._filterList=[],this.fullUserDataSource=[],this.fullFieldDataSource=[],this.mappedUserCollection=[],this.isUserListRendered=!1,this.isFieldListRendered=!1,this.isUserDisabled=!1,this.isFieldDisabled=!1,this.modified=!1,this.unMappedCheckBoxInst=null,this.locale=null,this.includeFutureValues=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=t,this.target=i,this.id=this.dashboardDesigner._id+"_uf_modes_basic",this.renderUserFilterDialog(),this.initLoader(),this.unWireEvents(),this.wireEvents(),this.useFilterFromInst=new h.Dashboard.UserFilterFromDialog(this.dashboardDesigner),this.open(this.queryDesigner.dataset)}function i(){var e=t.call(this)||this;return e.AllowVirtualScrolling=!1,e}a=h.Dashboard||(h.Dashboard={}),Object.defineProperty(e.prototype,"activeUser",{get:function(){return this._activeUser},set:function(e){h.isNullOrUndefined(e)?(this._activeUser=new UserInfo,this.updateSelectAllCheckBoxState(!1),h.isNullOrUndefined(this.fieldListInst)||(this.fieldListInst.uncheckAll(),this.fieldListInst.updateTheSelectedFieldValues([]))):(this._activeUser=this.getPreviousUserInfo(e),this._activeUser.IncludeFutureValues?(this.includeFutureValues.disableItemByName("active",!0),this.includeFutureValues.updateIncludeItemCheckbox("active",!0)):(this.includeFutureValues.disableItemByName("active",!0),this.includeFutureValues.updateIncludeItemCheckbox("active",!1)),this.updateSelectAllCheckBoxState(this._activeUser.IsCheckAll),h.isNullOrUndefined(this.fieldListInst)||(this._activeUser.IsCheckAll?this.fieldListInst.checkAll():(this.fieldListInst.uncheckAll(),this._activeUser.IncludeFutureValues&&(this._activeUser.SelectedValues=this.fullFieldDataSource.map(function(e){return e.fieldid})),this.fieldListInst.updateTheSelectedFieldValues(this._activeUser.SelectedValues),this.updateFieldListAndIcons(!0))))},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"currentActiveFilter",{get:function(){return this._currentActiveFilter},set:function(e){h.isNullOrUndefined(e)||(this._currentActiveFilter=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"filterList",{get:function(){return this._filterList},set:function(e){h.isNullOrUndefined(e)||(this._filterList=e)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fieldInfoModel",{get:function(){return this._fieldInfoModel},set:function(e){h.isNullOrUndefined(e)?this._fieldInfoModel=null:(this._fieldInfoModel=this.updateFieldInfoModel(e),this.renderFields(),h.isNullOrUndefined(this.userGroupUiInst)||this.userGroupUiInst.enable(),h.isNullOrUndefined(this.fieldListInst)||this.fieldListInst.enable())},enumerable:!1,configurable:!0}),e.prototype.initLoader=function(){this.loader=this.target.find("#"+this.id).BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},e.prototype.render=function(){0===this.target.find("#"+this.id).length&&this.target.append(this.dialogBox)},e.prototype.show=function(){0!==this.target.find("#"+this.id+"_uf_dialog_container").length&&this.target.show()},e.prototype.updateUiOnModeSwitch=function(){0===this.target.find("#"+this.id+"_uf_dialog_container").length?(this.updateUiOnShow(),this.render(),this.target.show()):(this.resetRequests(),this.onResetToDefault())},e.prototype.updateUiOnShow=function(e){this.mappedUserCollection=[],this.updateFieldsList(this.queryDesigner.dataset),this.updateErrorMessage("block"),this.renderInitial(e),h.isNullOrUndefined(e)&&this.renderList(),this.resetIcons(),this.updateUnmappedCheckBox(),this.updateInlcudeFutureItemCheckBox()},e.prototype.hide=function(){h.isNullOrUndefined(this.fieldListInst)||this.fieldListInst.uncheckAll(),this.resetValues(),this.target.hide(),h.isNullOrUndefined(this.userGroupUiInst)||this.userGroupUiInst.clearAllSelectedUser()},e.prototype.setFieldDataSource=function(e,t){this.updateUiOnUserList(!0),h.isNullOrUndefined(e)?(h.isNullOrUndefined(this.currentActiveFilter.ColumnId)&&this.fieldListInst.setDatasource([],t),null===e&&(this.fieldListInst.setDatasource([],t),this.fieldListInst.displayErrorMsg())):this.fieldListInst.setDatasource(e,t)},e.prototype.getPreviousUserInfo=function(t){var i=this,e=this.filterList.filter(function(e){return e.Name===i.currentActiveFilter.Name})[0];return h.isNullOrUndefined(e)||(e=e.UserInfo.filter(function(e){return e.UserId===t.UserId&&e.IsGroup===t.IsGroup})[0],h.isNullOrUndefined(e))?t:e},e.prototype.getBasicFilterInfo=function(){var e,t,i,a=new UserBasedFilterInfo;for(a.Mode=UserBasedFilterMode.Basic,a.AdvancedFilter=null,a.BasicFilters=[],e=[],t=0;t<this.filterList.length;t++)(0<this.filterList[t].UserInfo.length||this.filterList[t].BasedOn!==BasicUserFilterBasedOn.None)&&((i=new BasicUserBasedFilter).BasedOn=this.filterList[t].BasedOn,i.ColumnId=this.filterList[t].ColumnId,i.Mode=this.filterList[t].Mode,i.Name=this.filterList[t].Name,i.UserInfo=this.filterList[t].UserInfo,i.ShowRecordsToUnmappedUsers=this.filterList[t].ShowRecordsToUnmappedUsers,e.push(i));return 0===e.length?a=null:a.BasicFilters=e,a},e.prototype.updateFieldInfoModel=function(e){return{DatasourceID:this.dataset.Id,DatasourceName:this.dataset.Name,DisplayName:e.Name,Id:e.ID,UniqueColumnName:"fieldid",FilterInfo:null}},e.prototype.renderFields=function(){this.renderFieldListWrapper(this.fieldInfoModel),this.renderFieldList()},e.prototype.isNullOrEmpty=function(e){return""===e||null===e},e.prototype.updateFilterOnFocus=function(t){this.isNullOrEmpty(t)||0!==this.filterList.filter(function(e){return e.Name.toLowerCase()===t.toLowerCase()}).length?this.dashboardDesigner.modules.util.alertDialog(this.locale.userFilterLocale.UserFilterNameAlertTitle,0===t.trim().length?this.locale.userFilterLocale.UserFilterEmptyName:this.locale.userFilterLocale.UserFilterNameAllreadyExist,IconType.errors,AlertType.Alert,!1,""):(this.currentActiveFilter.Name=t,this.wrapper.find(".e-active").attr("data-filterid",t),this.updateFilterTileValue())},e.prototype.open=function(){this.iconTemplateInst=new h.Dashboard.UserFilterIconTemplate(this.dashboardDesigner,this.listIconWrapper,this,"iconMenuTemplateEventHandler"),this.renderUserList(this.userListWrapper),this.userGroupUiInst=this.userListWrapper.data("DesignerPropertyWidget")},e.prototype.renderInitial=function(e){this.initialiseFilterListCollection(e),this.renderDataColumnPanel(this.dataColumnPanel),this.updateFilterListInfo(),this.updateUiInteraction(this.filterList[0]),this.enableDisable()},e.prototype.updateCurrentActiveUser=function(){this.activeUser.SelectedValues=[],this.activeUser.IncludeFutureValues=!1,this.includeFutureValues.updateIncludeItemCheckbox("active",!1),this.userGroupUiInst.clearUserSelection();for(var e=0;e<this.userGroupUiInst.userInfoList.length;e++)this.userGroupUiInst.userInfoList[e].IncludeFutureValues=!1,this.userGroupUiInst.userInfoList[e].SelectedValues=[]},e.prototype.updateCurrentSelectedFilterList=function(){this.currentActiveFilter.ColumnId=this.fieldInfoModel.Id,this.currentActiveFilter.UserInfo=[]},e.prototype.updateUiInteraction=function(e){var t,i;if(h.isNullOrUndefined(e.ColumnId))this.selectedFieldInfo=null;else for(t=0;t<this.dataset.Fields.length;t++)if(i=this.getCheckDataField(e.ColumnId,this.dataset.Fields[t],null),!h.isNullOrUndefined(i)){this.selectedFieldInfo=i.Name;break}this.userFilterUI.updateUIForFilterClick(e)},e.prototype.getCheckDataField=function(e,t,i){if(t.ID===e)return t;if(!h.isNullOrUndefined(t.ChildFields))for(var a=0;a<t.ChildFields.length;a++)i=this.getCheckDataField(e,t.ChildFields[a],i);return i},e.prototype.updateFieldsList=function(e){this.dataset=JSON.stringify(e),this.dataset=JSON.parse(this.dataset),this.dataset.Fields=this.queryDesigner.tableType.filter(function(e){return"Real"!==e.DataType})},e.prototype.initialiseFilterListCollection=function(e){var t=h.isNullOrUndefined(this.queryDesigner.userBasedFilterInfo)?null:JSON.parse(JSON.stringify(this.queryDesigner.userBasedFilterInfo));h.isNullOrUndefined(e)&&!h.isNullOrUndefined(t)&&!h.isNullOrUndefined(t.BasicFilters)&&0<t.BasicFilters.length?(this.updateFilterInfo(t.BasicFilters),this.currentActiveFilter=this.filterList[0]):(this.initialiseFilterList(),this.activeUser=new UserInfo)},e.prototype.updateFilterInfo=function(e){for(var t,i=0;i<e.length;i++)(t=new o).BasedOn=e[i].BasedOn,t.UserInfo=e[i].UserInfo,t.Name=e[i].Name,t.ColumnId=e[i].ColumnId,t.Mode=e[i].Mode,t.ShowRecordsToUnmappedUsers=e[i].ShowRecordsToUnmappedUsers,this.filterList.push(t)},e.prototype.getFirstUserInitialisation=function(){return this.userGroupUiInst.getFirstSelectedUser()},e.prototype.updateFilterListInfo=function(){if(0<this.filterList.length){for(var e=0;e<this.filterList.length;e++)this.currentActiveFilter=this.filterList[e],this.addTileItemTemplate(!1),this.updateColumnTileValue(this.filterList[e].ColumnId,e);this.wrapper.find(".bbi-dbrd-user-based-tile-wrapper").first().addClass("e-active"),this.currentActiveFilter=this.filterList[0]}else this.addTileItemTemplate(!0)},e.prototype.renderList=function(){this.userGroupUiInst.fetchUserGroupList(this.currentActiveFilter.UserInfo),this.enableDisable()},e.prototype.renderFieldList=function(){h.isNullOrUndefined(this.fieldListInst)||h.isNullOrUndefined(this.fieldInfoModel)||(h.isNullOrUndefined(this.activeUser)?this.fieldListInst.getFieldValues(this.fieldInfoModel):this.fieldListInst.getFieldValues(this.fieldInfoModel,this.activeUser.SelectedValues))},e.prototype.resetRequests=function(){h.isNullOrUndefined(this.fieldListInst)||this.fieldListInst.resetRequest(),h.isNullOrUndefined(this.userGroupUiInst)||this.userGroupUiInst.resetRequest()},e.prototype.reset=function(){this.resetValues(),h.isNullOrUndefined(this.fieldListInst)||this.fieldListInst.emptyFieldValues()},e.prototype.resetValues=function(){this.filterList=[],this._activeUser=null,this._currentActiveFilter=null,this.fieldInfoModel=null,this.wrapper.find(".bbi-dbrd-user-based-tile-wrapper").remove(),this.isFieldListRendered=!1,this.isUserListRendered=!1,this.modified=!1},e.prototype.initialiseFilterList=function(){var e=new o;e.Name=this.updateFilterName(),this.filterList.push(e),this.currentActiveFilter=e},e.prototype.updateFilterName=function(){for(var e,i="Untitled Filter",a=this,t=1;t<=this.filterList.length+1;t++)if("object"==typeof(e=function(t){var e=a.filterList.filter(function(e){return e.Name===i+t})[0];if(h.isNullOrUndefined(e))return{value:i+=t}}(t)))return e.value;return i+="1"},e.prototype.renderUserFilterDialog=function(){this.createUserFilterDialog()},e.prototype.resetToDefaultState=function(){this.resetRequests(),this.checkBoxState(),this.userSearchTextBox.val(""),this.onUserListSearchBlur(),this.fieldSearchTextBox.val(""),this.onFieldListSearchBlur(),this.sortFieldValue=SortType.Asc,this.sortUserValue=SortType.Asc,this.bbdesigner$(".bbi-dbrd-userbased-filter-menu-list").find("span").css("display","none"),this.bbdesigner$(".bbi-dbrd-userbased-filter-menu-list").find(".bbi-dbrd-usergroup-mapping-tickmark").css("display","block")},e.prototype.createUserFilterDialog=function(){var e,t,i,a;this.dialogBox=h.buildTag("div","",{},{id:this.id+"_uf_dialog_container"}),this.contentPanel=h.buildTag("div.bbi-dbrd-uf-content-wrapper","",{},{id:this.id+"_wrapper"}),this.tileWrapperPanel=this.wrapper=h.buildTag("div.bbi-dbrd-uf-tile-panel","",{},{id:this.id+"_tile_wrapper_panel"}),e=h.buildTag("div.bbi-dbrd-uf-user-filter-panel","",{},{id:this.id+"_user_filter_panel"}),t=h.buildTag("div.e-dbrd",this.locale.userFilterLocale.addFilterErrorMsg,{display:"none","justify-content":"center","align-items":"center",height:"100%",width:"100%"},{id:this.id+"_user_filter_error"}),this.dataColumnPanel=h.buildTag("div.bbi-dbrd-uf-data-column-panel","",{},{id:this.id+"_data_column_panel"}),i=h.buildTag("div.bbi-dbrd-uf-list-panel","",{},{id:this.id+"_list_wrapper_panel"}),this.disableDiv=h.buildTag("div.bbi-disable-functionalities","",{},{id:this.id+"_list_wrapper_panel_disable"}),this.listIconWrapper=h.buildTag("div.bbi-dbrd-uf-list-icon-wrapper","",{},{id:this.id+"_list_icon_wrapper"}),a=h.buildTag("div.bbi-dbrd-uf-list-wrapper","",{},{id:this.id+"_list_wrapper"}),this.userListDisableWrapper=h.buildTag("div.bbi-dbrd-uf-user-list-disable-wrapper","",{},{id:this.id+"_user-list_disable_wrapper"}),this.userListWrapper=h.buildTag("div.bbi-dbrd-uf-user-list-wrapper","",{},{id:this.id+"_user-list_wrapper"}),this.fieldListDisableWrapper=h.buildTag("div.bbi-dbrd-uf-field-list-disable-wrapper","",{},{id:this.id+"_field-list_disable_wrapper"}),this.fieldListWrapper=h.buildTag("div.bbi-dbrd-uf-field-list-wrapper","",{},{id:this.id+"_field_list_wrapper"}),a.append(this.userListDisableWrapper,this.userListWrapper,this.fieldListDisableWrapper,this.fieldListWrapper),i.append(this.listIconWrapper,a),this.renderUnmappedCheckBox(i),e.append(t),e.append(this.dataColumnPanel,this.disableDiv,i),this.contentPanel.append(this.tileWrapperPanel,e),this.dialogBox.append(this.contentPanel),this.createUserFilterTileWrapper(this.tileWrapperPanel),this.renderIconWrapper(this.listIconWrapper)},e.prototype.renderUnmappedCheckBox=function(e){var t=h.buildTag("div.bbi-dbrd-uf-checkbox-element bbi-dbrd-designer-hoverable","",{width:"48%"},{id:this.id+"_unmpped_checkbox_div","data-tooltip":this.locale.userFilterLocale.showDataToUnmappedUserInfoText}),i=[];i.push({isChecked:!1,isDisabled:!1,name:"userUnmapped",label:this.locale.userFilterLocale.showDataToUnmappedUserText}),i={callBackInstance:this,cssClass:"e-small",callBackMethod:"onUmappedCheckBox",dataSource:i,labelPosition:a.LabelPosition.After},this.unMappedCheckBoxInst=new h.Dashboard.CheckBox(i,t),(i=h.buildTag("div.bbi-dbrd-uf-unmapped-checkbox-wrapper","",{"flex-direction":"row"},{})).append(t),e.append(i),this.updateFutureItemCheckbox(i)},e.prototype.updateFutureItemCheckbox=function(e){var t=h.buildTag("div.bbi-dbrd-uf-checkbox-element bbi-dbrd-designer-hoverable","",{width:"48%","padding-left":"20px"},{id:this.id+"_active_checkbox_div"}),i=[];i.push({isChecked:!1,isDisabled:!1,name:"active",label:this.locale.userFilterLocale.includeFutureValueText}),i={callBackInstance:this,cssClass:"e-small",callBackMethod:"onIncludeFutureItemCheckBox",dataSource:i,labelPosition:a.LabelPosition.After},this.includeFutureValues=new h.Dashboard.CheckBox(i,t),e.append(t)},e.prototype.onIncludeFutureItemCheckBox=function(e){e=0<e.checkedItems.length;this._activeUser.IncludeFutureValues=e},e.prototype.onUmappedCheckBox=function(e){e=0<e.checkedItems.length;this.currentActiveFilter.ShowRecordsToUnmappedUsers=e},e.prototype.closeFilterWindow=function(){h.isNullOrUndefined(this.userGroupUiInst)||this.userGroupUiInst.hideLoadingIndicator(),this.resetRequests(),h.isNullOrUndefined(this.fieldListInst)||this.fieldListInst.hideLoadingIndicator(),this.reset()},e.prototype.renderDataColumnPanel=function(e){var t,i=!1,a=null;h.isNullOrUndefined(this.dataset)||h.isNullOrUndefined(this.dataset.TreeViewData)||(t=JSON.parse(this.dataset.TreeViewData),!h.isNullOrUndefined(t)&&!h.isNullOrUndefined(t.Dimension)&&0<t.Dimension.length&&(a=t.Dimension,i=!0)),t={filterName:this.currentActiveFilter.Name,fields:i?a:this.dataset.Fields.filter(function(e){return"Integer"!==e.DataType&&"Real"!==e.DataType}),isHierarchical:i},e.empty(),this.userFilterUI=new h.Dashboard.UserFilterTemplateUi(this.dashboardDesigner,t,e,this,"filterTemplateEventHandler")},e.prototype.createUserFilterTileWrapper=function(e){this.tileWrapperPanel.empty(),this.totalItems=0,this.wrapper=h.buildTag("div.bbi-dbrd-uf-tile-panel-wrapper bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{"box-sizing":"border-box"},{id:this.id+"_wrapper"});var t=h.buildTag("div","",{},{id:this.id+"_container"}),i=h.buildTag("div .bbi-dbrd-uf-add-filter-wrapper","",{},{id:this.id+"_add_filter_wrapper"}),a=h.buildTag("span .e-chk-image e-icon bbi-masterslave-filter-add-plusIcon bbi-dbrd-uf-add-filter-icon","",{},{id:this.id+"_add_filter_icon"}),o=h.buildTag("span .bbi-dbrd-uf-add-filter-text",this.locale.userFilterLocale.addFilter,{},{id:this.id+"_add_filter_text"});i.append(a,o),this.wrapper.append(t),t.append(i),e.append(this.wrapper),this.wrapper.BoldBIDashboardScroller({scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,enableTouchScroll:!0,autoHide:!0,height:500}),this.wrapper.data("BoldBIDashboardScroller").refresh()},e.prototype.addTileItemTemplate=function(e){0===this.filterList.length&&this.updateErrorMessage("block"),this.wrapper.find(".e-active").removeClass("e-active"),this.wrapper.find("#"+this.id+"_add_filter_wrapper").before(this.getTileItemTemplate(this.locale)),e&&this.wrapper.find(".bbi-dbrd-user-based-tile-wrapper").last().addClass("e-active"),this.setIndividualIdAndName(e),this.wrapper.data("BoldBIDashboardScroller").refresh()},e.prototype.onAddFilterClick=function(){this.resetRequests(),this.updateSelectAllCheckBoxState(!1),this.addTileItemTemplate(!0),this.filterAndUiUpdation()},e.prototype.updateUsersAndGroupSelection=function(){if(!h.isNullOrUndefined(this.currentActiveFilter)&&!h.isNullOrUndefined(this.userGroupUiInst)){this.userGroupUiInst.clearAllSelectedUser();for(var e=0;e<this.currentActiveFilter.UserInfo.length;e++)this.userGroupUiInst.addAllSelectedUser(this.currentActiveFilter.UserInfo)}},e.prototype.onResetToDefault=function(){this.resetRequests(),this.reset(),h.isNullOrUndefined(this.userGroupUiInst)||(this.userGroupUiInst.userInfoList=[]),h.isNullOrUndefined(this.fieldListInst)||(this.fieldListInst.selectedValues=[]),this.updateUiOnShow(!0),this.modified=!1,this.updateUsersAndGroupSelection(),this.activeUser=this.getFirstUserInitialisation()},e.prototype.isModified=function(){return this.modified},e.prototype.setIndividualIdAndName=function(e){var t=this.tileWrapperPanel.find(".bbi-dbrd-user-based-tile-wrapper");e&&this.initialiseFilterList(),t.last().attr({id:this.id+"_tile_item_"+this.filterList.length,"data-filterid":this.currentActiveFilter.Name}),t.last().find(".bbi-dbrd-user-based-tile-header-wrapper p").html(this.currentActiveFilter.Name)},e.prototype.getTileItemTemplate=function(e){return"<div class='bbi-dbrd-user-based-tile-wrapper'><div class='bbi-dbrd-user-based-tile-header-wrapper'><p class='bbi-dbrd-user-based-tile-header bbi-dbrd-designer-hoverable' data-tooltip=''></p><span class='e-chk-image e-icon e-cross-circle bbi-dbrd-user-based-tile-close-icon bbi-dbrd-designer-hoverable' data-tooltip='"+e.toolBar.Delete+"'></span></div><div class='bbi-dbrd-user-based-tile-description bbi-dbrd-designer-hoverable' data-tooltip=''><span class ='bbi-dbrd-uf-data-column-name' ></span><span class ='bbi-dbrd-uf-column-name'></span></div></div>"},e.prototype.wireEvents=function(){this.wrapper.on("click","#"+this.id+"_add_filter_wrapper",this.bbdesigner$.proxy(this.onAddFilterClick,this)),this.wrapper.on("click",".bbi-dbrd-user-based-tile-wrapper",this.bbdesigner$.proxy(this.onTileSelectionChange,this)),this.wrapper.on("click",".bbi-dbrd-user-based-tile-close-icon",this.bbdesigner$.proxy(this.onRemoveFilterBtnClick,this)),this.userSearchTextBox.on("focusin",this.bbdesigner$.proxy(this.onUserSearchFocusIn,this)),this.userSearchTextBox.on("focusout",this.bbdesigner$.proxy(this.onUserSearchFocusOut,this)),this.fieldSearchTextBox.on("focusin",this.bbdesigner$.proxy(this.onFieldSearchFocusIn,this)),this.fieldSearchTextBox.on("focusout",this.bbdesigner$.proxy(this.onFieldSearchFocusOut,this)),this.userSearchTextBox.on("keyup",this.bbdesigner$.proxy(this.onUserListSearchText,this)),this.userSearchTextBox.on("blur",this.bbdesigner$.proxy(this.onUserListSearchBlur,this)),this.userSearchIcon.on("click",this.bbdesigner$.proxy(this.onUserListSearchCloseClick,this)),this.fieldSearchTextBox.on("keyup",this.bbdesigner$.proxy(this.onFieldListSearchText,this)),this.fieldSearchTextBox.on("blur",this.bbdesigner$.proxy(this.onFieldListSearchBlur,this)),this.fieldSearchIcon.on("click",this.bbdesigner$.proxy(this.onFieldListSearchCloseClick,this)),this.listIconWrapper.on("click","#"+this.id+"_list_icon_wrapper_sorting",this.bbdesigner$.proxy(this.sortLists,this)),this.listIconWrapper.on("click","#"+this.id+"_list_icon_wrapper_refresh",this.bbdesigner$.proxy(this.reloadLists,this))},e.prototype.unWireEvents=function(){this.wrapper.off("click","#"+this.id+"_add_filter_wrapper",this.bbdesigner$.proxy(this.onAddFilterClick,this)),this.wrapper.off("click",".bbi-dbrd-user-based-tile-wrapper",this.bbdesigner$.proxy(this.onTileSelectionChange,this)),this.wrapper.off("click",".bbi-dbrd-user-based-tile-close-icon",this.bbdesigner$.proxy(this.onRemoveFilterBtnClick,this)),this.userSearchTextBox.off("focusin",this.bbdesigner$.proxy(this.onUserSearchFocusIn,this)),this.fieldSearchTextBox.off("focusin",this.bbdesigner$.proxy(this.onFieldSearchFocusIn,this)),this.userSearchTextBox.off("focusout",this.bbdesigner$.proxy(this.onUserSearchFocusOut,this)),this.fieldSearchTextBox.off("focusout",this.bbdesigner$.proxy(this.onFieldSearchFocusOut,this)),this.userSearchTextBox.off("keyup",this.bbdesigner$.proxy(this.onUserListSearchText,this)),this.userSearchIcon.off("click",this.bbdesigner$.proxy(this.onUserListSearchCloseClick,this)),this.userSearchTextBox.off("blur",this.bbdesigner$.proxy(this.onUserListSearchBlur,this)),this.fieldSearchTextBox.off("keyup",this.bbdesigner$.proxy(this.onFieldListSearchText,this)),this.fieldSearchIcon.off("click",this.bbdesigner$.proxy(this.onFieldListSearchCloseClick,this)),this.fieldSearchTextBox.off("blur",this.bbdesigner$.proxy(this.onFieldListSearchBlur,this)),this.listIconWrapper.off("click","#"+this.id+"_list_icon_wrapper_sorting",this.bbdesigner$.proxy(this.sortLists,this)),this.listIconWrapper.off("click","#"+this.id+"_list_icon_wrapper_refresh",this.bbdesigner$.proxy(this.reloadLists,this))},e.prototype.onRemoveFilterBtnClick=function(e){var t;h.isNullOrUndefined(e.currentTarget)||(t=this.bbdesigner$(e.currentTarget),t=this.getSelectedFilterValue(t)),0<t.UserInfo.length||t.BasedOn!==BasicUserFilterBasedOn.None?this.dashboardDesigner.modules.util.alertDialog(this.locale.userFilterLocale.alertDialogTitle,this.locale.userFilterLocale.deleteAlertDialogMsg,IconType.question,AlertType.Confirm,!1,"",{instance:this,method:"removeFilter",dataInfo:{data:e}}):this.removeFilter(!0,{data:e})},e.prototype.sortLists=function(e){switch(this.bbdesigner$(e.target).attr("data-name")){case"userGroupSorting":switch(this.sortUserValue){case"ascending":this.sortUserValue=SortType.Desc;break;case"descending":this.sortUserValue=SortType.Asc}this.userGroupUiInst.sort(this.sortUserValue,this.concatUserInfos());break;case"fieldSorting":switch(this.sortFieldValue){case"ascending":this.sortFieldValue=SortType.Desc;break;case"descending":this.sortFieldValue=SortType.Asc}this.fieldListInst.sort(this.sortFieldValue)}},e.prototype.reloadLists=function(e){switch(this.bbdesigner$(e.target).attr("data-name")){case"refreshUserList":this.isUserListRendered=!1,this.userGroupUiInst.reload(this.currentActiveFilter.UserInfo);break;case"refreshData":h.isNullOrUndefined(this.currentActiveFilter.ColumnId)||(this.isFieldListRendered=!1,this.fieldSearchTextBox.val(""),this.onFieldListSearchBlur(),this.fieldListInst.reload())}},e.prototype.onTileSelectionChange=function(e){this.resetRequests();e=this.bbdesigner$(e.target);e.hasClass("bbi-dbrd-user-based-tile-close-icon")||(this.updateFilterTileValue(),this.wrapper.find(".e-active").removeClass("e-active"),e.closest(".bbi-dbrd-user-based-tile-wrapper").addClass("e-active"),this.filterAndUiUpdation())},e.prototype.filterAndUiUpdation=function(){this.switchCurrentFilter(),h.isNullOrUndefined(this.fieldListInst)||(this.fieldListInst.hideError(),this.setFieldDataSource(this.currentActiveFilter.DataSource,this.currentActiveFilter.AllowVirtualScrolling)),this.findSelectedFilter(),this.enableDisable(),this.resetIcons(),this.updateUsersAndGroupSelection(),h.isNullOrUndefined(this.fieldListInst)||(this.updateUserListAndIcons(!0),this.fieldListInst.updateFieldValueLists(this.activeUser.SelectedValues)),h.isNullOrUndefined(this.userGroupUiInst)||null===this.currentActiveFilter.DataSource||this.updateUiAndCollectionForAutoMapping(),this.userGroupUiInst.updateUsers(this.currentActiveFilter.UserInfo),this.updateUnmappedCheckBox(),this.updateInlcudeFutureItemCheckBox()},e.prototype.updateUnmappedCheckBox=function(){this.unMappedCheckBoxInst.checkItemByName("userUnmapped",this.currentActiveFilter.ShowRecordsToUnmappedUsers)},e.prototype.updateInlcudeFutureItemCheckBox=function(){this.includeFutureValues.checkItemByName("active",this._activeUser.IncludeFutureValues)},e.prototype.resetIcons=function(){this.userSearchTextBox.val(""),this.fieldSearchTextBox.val(""),this.onUserListSearchBlur(),this.onFieldListSearchBlur(),this.sortFieldValue=SortType.Asc,this.sortUserValue=SortType.Asc,this.iconTemplateInst.updateIcons(this.currentActiveFilter.BasedOn),h.isNullOrUndefined(this.userGroupUiInst)||null===this.currentActiveFilter.DataSource||(this.userGroupUiInst.showAll(),this.userGroupUiInst.showListBoxDiv())},e.prototype.getSelectedFilter=function(){this.userGroupUiInst.updateTheSelectedGroupValues(this.currentActiveFilter.UserInfo)},e.prototype.switchCurrentFilter=function(){var t=this.wrapper.find(".e-active").find(".bbi-dbrd-user-based-tile-header").text();this.currentActiveFilter=this.filterList.filter(function(e){return e.Name===t})[0],this.activeUser=this.getFirstUserInitialisation()},e.prototype.updateFilterTileValue=function(){this.wrapper.find(".e-active").find(".bbi-dbrd-user-based-tile-header-wrapper p").html(this.currentActiveFilter.Name)},e.prototype.updateColumnTileValue=function(e,t){var i,a;h.isNullOrUndefined(e)||(i=a=void 0,a=h.isNullOrUndefined(t)?(i=this.wrapper.find(".e-active").find(".bbi-dbrd-user-based-tile-description"),e):(i=this.bbdesigner$(this.wrapper.find(".bbi-dbrd-user-based-tile-description")[t]),this.userFilterUI.getFieldName(e)),i.find(".bbi-dbrd-uf-data-column-name").html(this.locale.userFilterLocale.dataColumnName),i.find(".bbi-dbrd-uf-column-name").html(" - "+a))},e.prototype.findSelectedFilter=function(){this.updateFieldListView(this.currentActiveFilter),this.updateUiInteraction(this.currentActiveFilter)},e.prototype.updateFieldListView=function(e){h.isNullOrUndefined(this.fieldListInst)||(h.isNullOrUndefined(e.ColumnId)?this.fieldListInst.hideFieldList():this.fieldListInst.showFieldList())},e.prototype.getSelectedFilterValue=function(e){var t=e.closest(".bbi-dbrd-user-based-tile-wrapper").attr("data-filterid");return this.filterList.filter(function(e){return e.Name===t})[0]},e.prototype.removeFilter=function(e,t){e&&(e=this.bbdesigner$(t.data.currentTarget),t=this.getSelectedFilterValue(e),this.deleteFromFilterCollection(t),this.updateSelectionAfterDeletion(t,e),0<this.filterList.length&&this.filterAndUiUpdation(),0===this.filterList.length)&&this.updateErrorMessage("none")},e.prototype.updateSelectionAfterDeletion=function(e,t){e===this.currentActiveFilter?(this.wrapper.find(".e-active").removeClass("e-active"),t.closest(".bbi-dbrd-user-based-tile-wrapper").remove(),this.wrapper.find(".bbi-dbrd-user-based-tile-wrapper").last().addClass("e-active")):t.closest(".bbi-dbrd-user-based-tile-wrapper").remove(),this.wrapper.data("BoldBIDashboardScroller").refresh()},e.prototype.updateErrorMessage=function(e){var t,i="none"===e?"flex":"none";this.dataColumnPanel.css("display",e),(t=this.dashboardDesigner.element.find("#"+this.id+"_user_filter_panel")).find("#"+this.id+"_list_wrapper_panel").css("display",e),t.find("#"+this.id+"_user_filter_error").css("display",i)},e.prototype.deleteFromFilterCollection=function(e){e=this.filterList.indexOf(e);this.filterList.splice(e,1)},e.prototype.renderFieldListWrapper=function(){this.fieldListWrapper.empty(),this.fieldListInst=new h.Dashboard.UserFilterFieldValueList(this.dashboardDesigner,this.fieldInfoModel,this.fieldListWrapper,this,"userFieldValuesListEventHandler")},e.prototype.renderUserList=function(e){e.empty(),this.userGroupUiInst=new h.Dashboard.UsersAndGroupsListView(this.dashboardDesigner,e,this,"userGroupListEventHandler")},e.prototype.checkBoxState=function(){var e=0<this.fieldCheckBoxDiv.find(".e-checkbox-wrapper[aria-checked=true]").length;e&&this.updateSelectAllCheckBoxState(e)},e.prototype.updateSelectAllCheckBoxState=function(e){this.checkboxInst.checkItemByName(this.checkboxName,e)},e.prototype.onCheckChange=function(){var e=0<this.fieldCheckBoxDiv.find(".e-checkbox-wrapper[aria-checked=true]").length;this.updateFilterFieldValues(!e),this.fieldListInst.checkAndUnCheckAllFieldValues(e),0<this.activeUser.SelectedValues.length?this.userGroupUiInst.addUserSelection():this.userGroupUiInst.clearCurrentUserSelection(),e?this.includeFutureValues.disableItemByName("active",!1):(this.includeFutureValues.disableItemByName("active",!0),this.includeFutureValues.updateIncludeItemCheckbox("active",!1),this._activeUser.IncludeFutureValues=e)},e.prototype.onUserSearchFocusOut=function(){this.userSearchPanel.removeClass("bbi-uf-user-focus")},e.prototype.onFieldSearchFocusOut=function(){this.fieldSearchPanel.removeClass("bbi-uf-field-focus")},e.prototype.onUserSearchFocusIn=function(){this.userSearchPanel.addClass("bbi-uf-user-focus"),this.userSearchTextBox.css("color","#333333")},e.prototype.onFieldSearchFocusIn=function(){this.fieldSearchPanel.addClass("bbi-uf-field-focus"),this.fieldSearchTextBox.css("color","#333333")},e.prototype.onUserListSearchText=function(e){13!==e.keyCode&&(0<(e=this.userSearchTextBox.val()).length?this.userSearchIcon.addClass("e-close_01").removeClass("e-search"):this.userSearchIcon.addClass("e-search").removeClass("e-close_01"),this.userGroupUiInst.search(e))},e.prototype.onFieldListSearchText=function(e){13!==e.keyCode&&(this.updateUserListAndIcons(!0),0<(e=this.fieldSearchTextBox.val()).length?this.fieldSearchIcon.addClass("e-close_01").removeClass("e-search"):this.fieldSearchIcon.addClass("e-search").removeClass("e-close_01"),this.fieldListInst.search(e),0<e.length?(this.includeFutureValues.disableItemByName("active",!0),this.includeFutureValues.updateIncludeItemCheckbox("active",!1)):this._activeUser.IncludeFutureValues&&this.includeFutureValues.updateIncludeItemCheckbox("active",!0))},e.prototype.onUserListSearchBlur=function(){0===this.userSearchTextBox.val().length&&this.userSearchIcon.addClass("e-search").removeClass("e-close_01")},e.prototype.onFieldListSearchBlur=function(){0===this.fieldSearchTextBox.val().length&&this.fieldSearchIcon.addClass("e-search").removeClass("e-close_01")},e.prototype.onUserListSearchCloseClick=function(){this.userSearchPanel.removeClass("bbi-uf-user-focus"),this.userSearchTextBox.css("color","#808080"),this.userSearchIcon.addClass("e-search").removeClass("e-close_01"),this.userGroupUiInst.search(""),this.userSearchTextBox.val("")},e.prototype.onFieldListSearchCloseClick=function(){this.updateUserListAndIcons(!0),this.fieldSearchPanel.removeClass("bbi-uf-field-focus"),this.fieldSearchTextBox.css("color","#808080"),this.fieldSearchIcon.addClass("e-search").removeClass("e-close_01"),this.fieldListInst.search(""),this.fieldSearchTextBox.val(""),this._activeUser.IncludeFutureValues&&this.includeFutureValues.updateIncludeItemCheckbox("active",!0),this.fieldListInst.tooltipForLengthFieldText()},e.prototype.renderIconWrapper=function(e){var t,i,a,o,s=h.buildTag("div.bbi-dbrd-uf-user-icon-wrapper","",{},{id:this.id+"_user_icon_wrapper","data-name":"usergroup"}),n=(this.userIconDisableDiv=h.buildTag("div.bbi-dbrd-uf-user-icon-disable-wrapper","",{},{id:this.id+"_user_icon_disable_wrapper"}),t=h.buildTag("div.bbi-dbrd-uf-field-icon-wrapper","",{},{id:this.id+"_field_icon_wrapper","data-name":"field"}),this.fieldIconDisableDiv=h.buildTag("div.bbi-dbrd-uf-field-icon-disable-wrapper","",{},{id:this.id+"_field_icon_disable_wrapper"}),h.buildTag("div.bbi-dbrd-uf-user-icon-title-container","<p></p>",{},{id:this.id+"_user_icon_title_container"})),r=h.buildTag("div.bbi-dbrd-uf-field-icon-title-container","<p></p>",{},{id:this.id+"_field_icon_title_container"}),d=h.buildTag("div.bbi-dbrd-uf-user-icon-title-wrapper","",{},{id:this.id+"_user_icon_title_wrapper"}),l=h.buildTag("div.bbi-dbrd-uf-user-icon-search-wrapper","",{},{id:this.id+"_user_icon_search_wrapper"});this.userSearchPanel=h.buildTag("div.bbi-dbrd-uf-user-search-panel","",{},{id:this.id+"_user_search_panel"}),this.fieldSearchPanel=h.buildTag("div.bbi-dbrd-uf-field-search-panel","",{},{id:this.id+"_field_search_panel"}),i=h.buildTag("div.bbi-dbrd-uf-field-icon-title-wrapper","",{},{id:this.id+"_field_icon_title_wrapper"}),a=h.buildTag("div.bbi-dbrd-uf-field-icon-search-wrapper","",{},{id:this.id+"_field_icon_search_wrapper"}),this.userSearchTextBox=h.buildTag("input.bbi-dbrd-uf-user-search-text-box","",{},{id:this.id+"_user_search_text_box",type:"text",placeholder:this.waterMarkText}),this.fieldSearchTextBox=h.buildTag("input.bbi-dbrd-uf-field-search-text-box","",{},{id:this.id+"_field_search_text_box",type:"text",placeholder:this.waterMarkText}),this.userSearchIcon=h.buildTag("span.e-user-search-icon","",{},{id:this.id+"_user_search_icon",class:"e-icon e-search"}),this.fieldSearchIcon=h.buildTag("span.e-field-search-icon","",{},{id:this.id+"_field_search_icon",class:"e-icon e-search"}),this.fieldCheckBoxDiv=h.buildTag("div.bbi-dbrd-uf-checkbox-element","",{"margin-top":"3px"},{id:this.id+"_checkbox_div"}),o=[{isChecked:!1,isDisabled:!1,name:this.checkboxName}],this.checkboxModel={callBackInstance:this,callBackMethod:"onCheckChange",dataSource:o,cssClass:"e-small"},this.checkboxInst=new h.Dashboard.CheckBox(this.checkboxModel,this.fieldCheckBoxDiv),this.userSearchPanel.append(this.userSearchTextBox,this.userSearchIcon),d.append(n),l.append(this.userSearchPanel),s.append(d,l),this.fieldSearchPanel.append(this.fieldSearchTextBox,this.fieldSearchIcon),a.append(this.fieldCheckBoxDiv,this.fieldSearchPanel),i.append(r),t.append(this.fieldIconDisableDiv,i,a),e.append(this.userIconDisableDiv,s,t),this.sortUserValue=SortType.Asc,this.sortFieldValue=SortType.Asc,e.find("#"+this.id+"_user_icon_title_container p").html(this.locale.userFilterLocale.userListTitle),e.find("#"+this.id+"_field_icon_title_container p").html(this.locale.userFilterLocale.fieldListTitle)},e.prototype.updateUserListAndIcons=function(e){e?(this.userListDisableWrapper.removeClass("bbi-enable"),this.userIconDisableDiv.removeClass("bbi-enable")):(this.userListDisableWrapper.addClass("bbi-enable"),this.disableUserIcons())},e.prototype.updateFieldListAndIcons=function(e){e?(this.fieldListDisableWrapper.removeClass("bbi-enable"),this.fieldIconDisableDiv.removeClass("bbi-enable")):(this.fieldListDisableWrapper.addClass("bbi-enable"),this.disableFieldIcons())},e.prototype.disableUserIcons=function(){this.userIconDisableDiv.addClass("bbi-enable")},e.prototype.disableFieldIcons=function(){this.fieldIconDisableDiv.addClass("bbi-enable")},e.prototype.userGroupListEventHandler=function(e){switch(e.type){case"selected":this.activeUser=e.data,this.updateUIForAutoMapping();break;case"renderComplete":h.isNullOrUndefined(e.data)||h.isNullOrUndefined(e.data.userId)||h.isNullOrUndefined(e.data.isGroup)||(this.isUserListRendered=!0,this.activeUser=e.data.userinfo,this.activeUser.IsGroup=e.data.isGroup,this.activeUser.UserId=e.data.userId,this.fullUserDataSource=e.data.dataSource,this.updateAutoMappingAfterRender(),this.updateIncludeFutureItemAfterRender());break;case"clearActiveFilterUserInfo":this.clearFilterUserInfo();break;case"useFilterFrom":this.callUseFilterFrom(e.datasource);break;case"RelativeDateFilter":this.callRelativeDateFilter(this.activeUser,this.dashboardDesigner.columnDetails);break;case"checkSelectedValues":this.checkSelectedValuesForActiveUser();break;case"updateUiFieldList":this.updateUiOnFieldList(e.data.data);break;case"onUserListError":this.updateFieldListAndIcons(!1)}},e.prototype.updateUiOnFieldList=function(e){e?(this.isFieldDisabled=!1,this.updateFieldListAndIcons(!0),this.userIconDisableDiv.removeClass("bbi-enable")):(this.isFieldDisabled=!0,this.disableFieldList()),this.isUserDisabled&&this.updateUiOnUserList(!1)},e.prototype.disableFieldList=function(){this.disableDiv.hasClass("bbi-enable")||(this.updateFieldListAndIcons(!1),this.disableUserIcons())},e.prototype.disableUserList=function(){this.updateUserListAndIcons(!1),this.disableFieldIcons()},e.prototype.updateUiOnUserList=function(e){e?(this.isUserDisabled=!1,this.updateUserListAndIcons(!0),this.fieldIconDisableDiv.removeClass("bbi-enable")):(this.isUserDisabled=!0,this.disableUserList()),this.isFieldDisabled&&this.isUserDisabled?(this.updateUserListAndIcons(!0),this.disableFieldIcons(),this.disableUserIcons()):this.isFieldDisabled&&this.updateUiOnFieldList(!1)},e.prototype.checkSelectedValuesForActiveUser=function(){0<this.activeUser.SelectedValues.length||0===this.activeUser.SelectedValues.length&&null!=this.activeUser.RelativeDateFilter?this.userGroupUiInst.setIsfilteredProperty(!0):this.userGroupUiInst.setIsfilteredProperty(!1)},e.prototype.callUseFilterFrom=function(e){var t,i,a,o=this,s={callBackInstance:this,callBackMethod:"updateCheckedItemsFromDialog",optionalArgs:""},n=JSON.stringify(this.currentActiveFilter.UserInfo),r=this.currentActiveFilter.UserInfo.filter(function(e){return e.UserId===o.activeUser.UserId})[0],d=JSON.parse(n);for(h.isNullOrUndefined(r)||(n=this.currentActiveFilter.UserInfo.indexOf(r),d.splice(n,1)),t=[],i=0;i<d.length;i++)for(a=0;a<e.length;a++)(d[i].IsGroup===e[a].IsGroup&&d[i].UserId===e[a].Id.toString()||d[i].IsGroup===e[a].IsGroup&&d[i].UserId===e[a].Email)&&t.push(e[a]);this.useFilterFromInst.open(s,{userInfo:d,currentUserInfo:r,datasource:t})},e.prototype.callRelativeDateFilter=function(e,t){this.dashboardDesigner.modules.relativeDateFilter.openRelativeDateFilter(this,"relativeDateFilterAction",e.RelativeDateFilter,t,null,null,this.activeUser)},e.prototype.relativeDateFilterAction=function(e,t,i,a,o){h.isNullOrUndefined(e)||(o.RelativeDateFilter=e,this.relativeDateFilterInfo=e,0===o.SelectedValues.length&&(this.userGroupUiInst.updateSelectedFieldValuesForUser(this.activeUser),this.updateFilterFieldValues(!1)))},e.prototype.updateCheckedItemsFromDialog=function(e){this.activeUser.SelectedValues=e.selectedValues,this.fieldListInst.updateTheSelectedFieldValues(e.selectedValues),this.userGroupUiInst.addUserSelection(),this.updateFilterFieldValues(!1)},e.prototype.enableDisable=function(){h.isNullOrUndefined(this.selectedFieldInfo)?this.disableAll():this.enableAll()},e.prototype.disableAll=function(){this.disableDiv.addClass("bbi-enable")},e.prototype.enableAll=function(){this.disableDiv.removeClass("bbi-enable"),this.isFieldDisabled&&this.updateUiOnFieldList(!1),this.isUserDisabled&&this.updateUiOnUserList(!1)},e.prototype.updateFilterFieldValues=function(e){var t,i=this,a=this.filterList.filter(function(e){return e.Name===i.currentActiveFilter.Name})[0];h.isNullOrUndefined(a)||(t=a.UserInfo.indexOf(this.activeUser),e&&-1!==t?a.UserInfo.splice(t,1):-1===t?a.UserInfo.push(this.activeUser):a.UserInfo[t]=this.activeUser)},e.prototype.createAlertForAutoMapping=function(e,t){0<this.currentActiveFilter.UserInfo.length&&0<this.currentActiveFilter.UserInfo[0].SelectedValues.length?this.dashboardDesigner.modules.util.alertDialog(this.locale.userFilterLocale.alertDialogTitle,this.locale.userFilterLocale.autoMappingAlertDialogMsg.replace("{0}",t),IconType.question,AlertType.Confirm,!1,"",{instance:this,method:"enableAutomapping",dataInfo:{args:e}}):this.enableAutomapping(!0,{args:e})},e.prototype.enableAutomapping=function(e,t){e&&(e=t.args===h.DashboardDesignerUtility.Serialization.enumToString(BasicUserFilterBasedOn,BasicUserFilterBasedOn.FullName).toLocaleLowerCase()?BasicUserFilterBasedOn.FullName:t.args===h.DashboardDesignerUtility.Serialization.enumToString(BasicUserFilterBasedOn,BasicUserFilterBasedOn.Email).toLocaleLowerCase()?BasicUserFilterBasedOn.Email:t.args===h.DashboardDesignerUtility.Serialization.enumToString(BasicUserFilterBasedOn,BasicUserFilterBasedOn.GroupName).toLocaleLowerCase()?BasicUserFilterBasedOn.GroupName:BasicUserFilterBasedOn.None,this.currentActiveFilter.BasedOn=e,this.updateCurrentActiveUser(),this.updateCurrentSelectedFilterList(),this.fieldListInst.uncheckAll(),this.updateUiAndCollectionForAutoMapping(),this.activeUser=this.getFirstUserInitialisation(),this.iconTemplateInst.updateAutomapping(e))},e.prototype.updateAutoMappingAfterRender=function(){this.isFieldListRendered&&this.isUserListRendered&&this.updateUiAndCollectionForAutoMapping()},e.prototype.updateUiAndCollectionForAutoMapping=function(){this.mappedUserCollection=[],this.fullFieldDataSource=this.currentActiveFilter.DataSource,this.currentActiveFilter.BasedOn!==BasicUserFilterBasedOn.None?(this.createUserCollectionForAutoMapping(),this.updateUIForAutoMapping()):this.unMappedCheckBoxInst.disableItemByName("userUnmapped",!1)},e.prototype.updateUIForAutoMapping=function(){var t=this;0<this.mappedUserCollection.length&&(null!==this.queryDesigner.userBasedFilterInfo&&this.queryDesigner.userBasedFilterInfo.BasicFilters.forEach(function(e){e.UserInfo.forEach(function(e){t.mappedUserCollection.push(e)})}),this.userGroupUiInst.addAllSelectedUser(this.mappedUserCollection),0<this.mappedUserCollection.filter(function(e){return e.UserId===t.activeUser.UserId&&e.IsGroup===t.activeUser.IsGroup}).length)&&this.checkAndUpdateSelectedValuesForAutoMapping(),this.currentActiveFilter.BasedOn!==BasicUserFilterBasedOn.None?(this.unMappedCheckBoxInst.disableItemByName("userUnmapped",!0),this.unMappedCheckBoxInst.checkItemByName("userUnmapped",!1),this.currentActiveFilter.ShowRecordsToUnmappedUsers=!1):this.unMappedCheckBoxInst.disableItemByName("userUnmapped",!1)},e.prototype.createUserCollectionForAutoMapping=function(){for(var i=this.currentActiveFilter.BasedOn===BasicUserFilterBasedOn.Email?"Email":"Name",a=this.currentActiveFilter.BasedOn===BasicUserFilterBasedOn.GroupName,e=0;e<this.fullUserDataSource.length;e++)for(var o=this.fullUserDataSource[e],s=this,t=0;t<this.fullFieldDataSource.length;t++)!function(e){var t,e=s.fullFieldDataSource[e];o[i]===e.fieldid&&a===o.IsGroup&&((t=new UserInfo).UserId=o.IsGroup?o.Id.toString():o.Email,t.IsGroup=o.IsGroup,t.SelectedValues.push(e.fieldid),0<s.mappedUserCollection.filter(function(e){return e.UserId===t.UserId&&e.IsGroup===t.IsGroup}).length?s.mappedUserCollection.filter(function(e){return e.UserId===t.UserId&&e.IsGroup===t.IsGroup})[0]=t:s.mappedUserCollection.push(t))}(t)},e.prototype.concatUserInfos=function(){return[].concat(this.currentActiveFilter.UserInfo).concat(this.mappedUserCollection)},e.prototype.checkAndUpdateSelectedValuesForAutoMapping=function(){var t=this,e=this.mappedUserCollection.filter(function(e){return e.UserId===t.activeUser.UserId&&e.IsGroup===t.activeUser.IsGroup})[0];this.activeUser.SelectedValues.length>e.SelectedValues.length?this.fieldListInst.updateTheSelectedFieldValues(this.activeUser.SelectedValues):this.fieldListInst.updateTheSelectedFieldValues(e.SelectedValues)},e.prototype.userFieldValuesListEventHandler=function(e){if(!h.isNullOrUndefined(e.type))switch(e.type){case"onItemSelection":(this.activeUser.SelectedValues=e.data.selectedValues,this.fullFieldDataSource.length!==this.activeUser.SelectedValues.length&&(this._activeUser.IncludeFutureValues=!1),0===e.data.selectedValues.length&&null===this.activeUser.RelativeDateFilter)?(this.userGroupUiInst.clearCurrentUserSelection(),this.updateFilterFieldValues(!0)):(this.userGroupUiInst.updateSelectedFieldValuesForUser(this.activeUser),this.updateFilterFieldValues(!1));break;case"renderComplete":this.currentActiveFilter.DataSource=e.data.dataSource,this.currentActiveFilter.AllowVirtualScrolling=e.data.allowVirtualScrolling,this.isFieldListRendered=!0,this.updateAutoMappingAfterRender(),this.updateIncludeFutureItemAfterRender();break;case"Intermediate":this.checkboxInst.checkItemByName(this.checkboxName,!1),this.checkboxInst.intermediateStateByName(this.checkboxName,!0),this.includeFutureValues.disableItemByName("active",!0),this.includeFutureValues.updateIncludeItemCheckbox("active",!1);break;case"Unchecked":this.unCheckFieldValueCheckbox(),this.includeFutureValues.disableItemByName("active",!0);break;case"Checked":this.checkboxInst.intermediateStateByName(this.checkboxName,!1),this.checkboxInst.checkItemByName(this.checkboxName,!0),this.includeFutureValues.disableItemByName("active",!1);break;case"updateUiOnUserList":this.updateUiOnUserList(e.data.data);break;case"onFieldListError":this.updateUserListAndIcons(!1)}},e.prototype.updateIncludeFutureItemAfterRender=function(){h.isNullOrUndefined(this.currentActiveFilter.DataSource)||(this.fullFieldDataSource=this.currentActiveFilter.DataSource),this._activeUser.IncludeFutureValues&&this.includeFutureValues.disableItemByName("active",!1),h.isNullOrUndefined(this.fieldListInst)||(h.isNullOrUndefined(this.fullFieldDataSource)?this.fieldListInst.checkvalues(this._activeUser.IncludeFutureValues,this._activeUser.SelectedValues):this.fieldListInst.checkvalues(this._activeUser.IncludeFutureValues,this.fullFieldDataSource.map(function(e){return e.fieldid})))},e.prototype.unCheckFieldValueCheckbox=function(){this.checkboxInst.intermediateStateByName(this.checkboxName,!1),this.checkboxInst.checkItemByName(this.checkboxName,!1)},e.prototype.clearFilterUserInfo=function(){var e,t=this;this.activeUser.SelectedValues=[],this.fieldListInst.clearSelectedValues(),e=this.currentActiveFilter.UserInfo.filter(function(e){return e.UserId===t.activeUser.UserId})[0],h.isNullOrUndefined(e)||(e=this.currentActiveFilter.UserInfo.indexOf(e),this.currentActiveFilter.UserInfo.splice(e,1)),this.userGroupUiInst.clearCurrentUserSelection(),this.fieldListInst.uncheckAll()},e.prototype.filterTemplateEventHandler=function(e){if(this.dashboardDesigner.columnDetails=e.data,!h.isNullOrUndefined(e.type))switch(e.type){case"onItemSelection":this.isFieldListRendered=!1,this.currentActiveFilter.BasedOn=BasicUserFilterBasedOn.None,this.resetIcons(),this.updateCurrentActiveUser(),this.fieldInfoModel=e.data.fieldInfo,this.updateCurrentSelectedFilterList(),this.unCheckFieldValueCheckbox(),this.selectedFieldInfo=e.data.selectedInfo,this.enableAll(),this.currentActiveFilter.DataSource=null,this.updateColumnTileValue(e.data.selectedInfo),this.mappedUserCollection=[],this.modified=!0;break;case"filterNameUpdate":this.updateFilterOnFocus(e.data.name);break;case"onUIupdation":h.isNullOrUndefined(this.currentActiveFilter.DataSource)?(this.fieldInfoModel=e.data.fieldInfo,h.isNullOrUndefined(this.fieldListInst)&&this.renderFieldListWrapper(this.fieldInfoModel)):(this.fieldInfoModel=e.data.fieldInfo,this.fieldListInst.hideError(),this.setFieldDataSource(this.currentActiveFilter.DataSource,this.currentActiveFilter.AllowVirtualScrolling),this.fieldListInst.updateTheSelectedFieldValues(this.activeUser.SelectedValues),this.fieldListInst.updateFieldValueLists(this.activeUser.SelectedValues)),this.modified=!0}},e.prototype.iconMenuTemplateEventHandler=function(e){if(!h.isNullOrUndefined(e.type))switch(e.type){case"userMapping":this.userGroupUiInst.updateUserMapping(e.data,this.concatUserInfos());break;case"autoMapping":this.createAlertForAutoMapping(e.data,e.text);break;case"filtering":if(!h.isNullOrUndefined(this.fieldListInst))switch(this.updateUserListAndIcons(!0),e.data){case"data_checked":this.fieldListInst.filter(filterOptions.All),this.fieldListInst.triggerSearchEvent();break;case"Checked":this.fieldListInst.filter(filterOptions.Checked),this.fieldListInst.triggerSearchEvent();break;case"Unchecked":this.fieldListInst.filter(filterOptions.UnChecked),this.fieldListInst.triggerSearchEvent()}}},a.UFBasicMode=e,t=BasicUserBasedFilter,__extends(i,t),o=i}(BoldBIDashboard=BoldBIDashboard||{}),function(o){var e;function t(e){this.id=null,this.dialogBox=null,this.timer=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id+"_users_in_group",this.renderDialogBox(),this.unWireEvents(),this.wireEvents()}e=o.Dashboard||(o.Dashboard={}),t.prototype.renderDialogBox=function(){this.dialogBox=o.buildTag("div .bbi-dbrd-container","",{},{id:this.id+"_dialog_container"});var e,t=o.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.alertWindow.cancelBtnText,{float:"right",height:"28px"},{id:this.id+"_cancel_btn",type:"button"}),i=o.buildTag("div .bbi-dbrd-listbox-wrapper","",{},{id:this.id+"_list_box_wrapper"}),a=o.buildTag("ul .bbi-dbrd-listbox-element ","",{unselectable:"on"},{id:this.id+"_list_box_element"});i.append(a),e=o.buildTag("div .bbi-dbrd-listbox-error-msg","<center><p></p></center>",{},{id:this.id+"_content_error_msg"}),i.append(e),this.dialog=this.dialogBox.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:300,minHeight:193,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.cancelFilterWindow,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.dashboardDesigner.element.find("#"+this.id+"_dialog_container_foot").append(t),this.dialogBox.append(i),this.listBoxElementInst=a.BoldBIDashboardListBox({template:'<span class ="bbi-dbrd-uf-users-list"><span class ="bbi-dbrd-user-icon e-dashboarddesigner-icon-false"></span><span class= "bbi-dbrd-uf-users-list-text">${Name}</span></span>',width:"100%",height:"100%",cssClass:"bbi-dbrd-designer-userfilter",showRoundedCorner:!1}).data("BoldBIDashboardListBox"),this.loaderInstance=i.BoldBIDashboardWaitingPopup({showOnInit:!1,showImage:!0,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},t.prototype.showLoadingIndicator=function(){this.loaderInstance.show()},t.prototype.hideLoadingIndicator=function(){this.loaderInstance.hide()},t.prototype.onAccountFetchSuccess=function(e){var t=this;o.isNullOrUndefined(this.timer)||clearTimeout(this.timer),this.timer=setTimeout(function(){e.Status?o.isNullOrUndefined(e.Data)||0===e.Data.length?t.showErroMsg(t.dashboardDesigner.getLocalizationContent().userFilterLocale.noUserError):(t.listBoxElementInst.setModel({dataSource:JSON.parse(e.Data)}),t.showUserList()):t.showErroMsg(e.Message)},0)},t.prototype.showUserList=function(){this.dialogBox.find("#"+this.id+"_content_error_msg").hide(),this.dialogBox.find("#"+this.id+"_list_box_element").show()},t.prototype.showErroMsg=function(e){this.dialogBox.find("#"+this.id+"_list_box_element_container").hide(),this.dialogBox.find("#"+this.id+"_content_error_msg").css("display","table"),this.dialogBox.find("#"+this.id+"_content_error_msg p").html(e)},t.prototype.onAccountFetchError=function(e){401===e.status?this.showErroMsg(this.locale.errorMessage.authenticationFailed+this.locale.errorMessage.invalidSession):o.isNullOrUndefined(e.responseText)||""===e.responseText?this.showErroMsg(this.locale.errorMessage.errorOnLoadingAccountInfo):this.showErroMsg(e.responseText)},t.prototype.open=function(e,t){this.setDialogTitle(t),this.dialog.open(),this.fetchAccountInfo(e)},t.prototype.setDialogTitle=function(e){this.dialog.option("title",this.locale.dataSource.dialogTitletext+" - "+e)},t.prototype.showEmptyListBox=function(){this.dialogBox.find("#"+this.id+"_list_box_element").empty(),this.dialogBox.find("#"+this.id+"_content_error_msg").css("display","none")},t.prototype.fetchAccountInfo=function(e){this.showEmptyListBox(),this.requestObj=this.dashboardDesigner.modules.util.doAjaxPost("GET",this.dashboardDesigner.model.serviceUrl+o.Dashboard.ServiceAPI.getUsersInGroup.replace("{groupid}",e),{action:o.DashboardUtil.DesignerAction.FetchAccountInfo},{fnction:this.bbdesigner$.proxy(this.onAccountFetchSuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)],errfnction:this.bbdesigner$.proxy(this.onAccountFetchError,this)},!0,!0)},t.prototype.cancelFilterWindow=function(){this.loaderInstance.hide(),this.dialog.close()},t.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelFilterWindow,this))},t.prototype.unWireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.cancelFilterWindow,this))},e.UsersInGroup=t}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e,t,i,a,o){this.fullDatasource=[],this.inputText="",this.isFilterInitiated=null,this.initialLoad=null,this.currentDatasource=[],this.selectedValues=[],this.callBackInstance=null,this.callBackMethod=null,this.isFiltered=!1,this.isInitialFilter=!1,this.locale=null,this.callBackInstance=a,this.locale=e.getLocalizationContent(),this.callBackMethod=o,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.virtualScrolling=new VirtualScrollSettings,this.id=(l.isNullOrUndefined(i.attr("id"))||""===i.attr("id")?this.dashboardDesigner._id:i.attr("id"))+"_uf_field_action",i.data("DesignerPropertyWidget",this),this.createListBoxElement(i),this.unWireEvents(),this.wireEvents(),this.fieldInfo=t}e=l.Dashboard||(l.Dashboard={}),t.prototype.invokeCallBackHandler=function(e){l.isNullOrUndefined(this.callBackInstance)||l.isNullOrUndefined(this.callBackMethod)||l.DashboardUtil.invokeMethod(this.callBackInstance,this.callBackMethod,[e])},t.prototype.createListBoxElement=function(e){var t=this.wrapper=l.buildTag("div","",{height:"100%",width:"258px"},{id:this.id+"_wrapper"}),i=l.buildTag("div","",{},{id:this.id+"_content_container"}),a=l.buildTag("div.bbi-dbrd-designer-fieldvalue-list","",{},{id:this.id+"_fieldvalue_list"}),o=this.ulElement=l.buildTag("ul.bbi-dbrd-designer-ulelement","",{},{id:this.id+"_field_list_ulelement"}),s=l.buildTag("div.bbi-dbrd-designer-error","<center><p></p></center>",{},{id:this.id+"_error_message"}),n=l.buildTag("div.bbi-dbrd-designer-retry","",{},{id:this.id+"_retry_block"}),r=l.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.browseDialogMessages.retryText,{},{id:this.id+"_retry_btn",type:"button"}),d=this.loadingPopup=l.buildTag("div.bbi-dbrd-designer-loading-popup","",{},{id:this.id+"_wrapper_loading_popup"});a.append(o),n.append(r),i.append(a),t.append(s,n,d,i),e.append(t),this.ulElement.BoldBIDashboardListBox({showCheckbox:!0,width:"258px",height:"285px",checkChange:this.bbdesigner$.proxy(this.fieldValueSelection,this),cssClass:"bbi-dbrd-designer-fieldlist",actionBegin:this.bbdesigner$.proxy(this.renderData,this)}),this.bufferIndicator=i.BoldBIDashboardWaitingPopup({showonInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader e-field-list-waiting-popup",template:this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_designer_waiting_loader")}).data("BoldBIDashboardWaitingPopup")},t.prototype.updateFieldValueLists=function(e){this.selectedValues=e,this.isFilterInitiated=filterOptions.All,this.filter(this.isFilterInitiated),this.updateFieldCheckbox()},t.prototype.wireEvents=function(){this.wrapper.on("click","#"+this.id+"_retry_btn",this.bbdesigner$.proxy(this.reloadDataSource,this))},t.prototype.unWireEvents=function(){this.wrapper.off("click","#"+this.id+"_retry_btn",this.bbdesigner$.proxy(this.reloadDataSource,this))},t.prototype.showFieldList=function(){this.wrapper.css("display","block")},t.prototype.hideFieldList=function(){this.wrapper.css("display","none")},t.prototype.resetRequest=function(){l.isNullOrUndefined(this.requestObj)||4===this.requestObj.readyState||(this.requestObj.abort(),this.requestObj=null)},t.prototype.getFieldValues=function(e,t){this.hideError(),this.selectedValues=l.isNullOrUndefined(t)?this.selectedValues:t,this.virtualScrolling.PageSize=1e3,this.requestObj=this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+l.Dashboard.ServiceAPI.processdata,{action:l.DashboardUtil.DesignerAction.getData,data:JSON.stringify({className:l.DashboardUtil.DesignerAction.FilterAction,designerAction:l.DashboardUtil.DesignerAction.getData,fieldInfo:[e],dataSetId:e.DatasourceID,startIndex:this.virtualScrolling.StartIndex,pageSize:this.virtualScrolling.PageSize,isQueryDesignerMode:!0})},{fnction:this.bbdesigner$.proxy(this.onFieldDataFetch,this),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)],errfnction:this.bbdesigner$.proxy(this.requestFailed,this)},!0)},t.prototype.checkAndUnCheckAllFieldValues=function(e){var t,i=this;!l.isNullOrUndefined(this.inputText)&&0<this.inputText.length&&!this.allowVirtualScrolling?(null===this.isFilterInitiated&&this.checkAndUncheckFieldValues(this.searchedText,e),this.isFilterInitiated===filterOptions.Checked&&this.checkAndUncheckFieldValues(this.filterSearched,e),this.isFilterInitiated===filterOptions.UnChecked&&this.checkAndUncheckFieldValues(this.uncheckedText,e)):null!==this.isFilterInitiated?(this.isFilterInitiated===filterOptions.Checked&&(t=this.getCheckedText(this.getCheckedItems()),this.checkAndUncheckFieldValues(t,e)),this.isFilterInitiated===filterOptions.UnChecked&&this.checkAndUncheckFieldValues(this.unCheckedDataOnMapping,e)):e?(this.ulElement.BoldBIDashboardListBox("checkAll"),this.ulElement.BoldBIDashboardListBox("getCheckedItems").filter(function(e){return i.selectedValues.push(e.text)}),this.inputText.length):this.allowVirtualScrolling?this.checkAndUncheckFieldValues(this.getFieldItems(),e):(this.selectedValues=[],this.ulElement.BoldBIDashboardListBox("uncheckAll")),t={type:"onItemSelection",data:{selectedValues:this.selectedValues}},this.invokeCallBackHandler(t)},t.prototype.checkvalues=function(e,t){e&&(this.ulElement.BoldBIDashboardListBox("checkAll"),l.isNullOrUndefined(t)||(this.selectedValues=t),e={type:"onItemSelection",data:{selectedValues:this.selectedValues}},this.invokeCallBackHandler(e))},t.prototype.checkAndUncheckFieldValues=function(e,t){var i,a,o;if(t)for(i=0;i<e.length;i++)a=this.ulElement.BoldBIDashboardListBox("getIndexByText",e[i]),this.ulElement.BoldBIDashboardListBox("checkItemByIndex",a),this.selectedValues.push(e[i]),this.selectedValues=this.getUniqueValues(this.selectedValues);else for(i=0;i<e.length;i++)a=this.ulElement.BoldBIDashboardListBox("getIndexByText",e[i]),this.ulElement.BoldBIDashboardListBox("uncheckItemByIndex",a),this.selectedValues=this.getUniqueValues(this.selectedValues),-1!==(o=this.selectedValues.indexOf(e[i]))&&this.selectedValues.splice(o,1)},t.prototype.setSelectedValues=function(){for(var e=this.ulElement.BoldBIDashboardListBox("getCheckedItems"),t=[],i=0;i<e.length;i++)""!==e[i].value&&t.push(e[i].value);return t},t.prototype.onFieldDataFetch=function(e){l.isNullOrUndefined(e)||"[]"===e?this.displayError(this.locale.errorMessage.dataRetrievalError):(this.ulElement.css("display","block"),this.fullDatasource=JSON.parse(e.jsonData),this.hasRecords=e.hasMoreRecords,e=this.fieldInfo.UniqueColumnName,this.virtualScrolling.PageSize=1e3,this.hideError(),this.hasRecords?(this.initialLoad=!0,this.allowVirtualScrolling=!0,this.ulElement.BoldBIDashboardListBox({dataSource:this.updateDataManager(),fields:{id:e,text:e},allowVirtualScrolling:!0,virtualScrollMode:l.VirtualScrollMode.Continuous,itemRequestCount:this.virtualScrolling.PageSize,actionBegin:this.bbdesigner$.proxy(this.renderData,this),actionComplete:this.bbdesigner$.proxy(this.setCheckedValues,this)})):(this.hasRecords=!1,this.allowVirtualScrolling=!1,this.ulElement.BoldBIDashboardListBox({dataSource:this.fullDatasource,fields:{id:e,text:e},allowVirtualScrolling:this.hasRecords,actionBegin:this.bbdesigner$.proxy(this.renderData,this)})),this.initialLoad&&(this.initialLoad=!1),this.tooltipForLengthFieldText(),this.updateUiOnFieldList(),this.triggerRenderComplete())},t.prototype.tooltipForLengthFieldText=function(){for(var e=0;e<this.ulElement.children().length;e++)this.bbdesigner$(this.ulElement.children()[e]).attr({"data-tooltip":this.ulElement.children()[e].id,"data-val-txt-len":"true",class:"bbi-dbrd-designer-hoverable"})},t.prototype.updateUiOnFieldList=function(){this.invokeCallBackHandler({type:"updateUiOnUserList",data:{data:!0}})},t.prototype.triggerRenderComplete=function(){var e={type:"renderComplete",data:{dataSource:this.fullDatasource,allowVirtualScrolling:this.allowVirtualScrolling}};this.invokeCallBackHandler(e),this.updateTheSelectedFieldValues(this.selectedValues)},t.prototype.updateDataManager=function(){var i=this,e=new l.Adaptor(null).extend({processQuery:this.bbdesigner$.proxy(this.processQuery,this),beforeSend:function(e,t){i.dashboardDesigner.beforeSendRequestForDataManager("OnDemandDataAction",t)},processResponse:this.bbdesigner$.proxy(this.processResponse,this)});return new l.DataManager({url:this.dashboardDesigner.model.serviceUrl+l.Dashboard.ServiceAPI.processdata,adaptor:new e,crossDomain:!0})},t.prototype.setCheckedValues=function(){this.updateCheckedValues()},t.prototype.updateCheckedValues=function(){l.isNullOrUndefined(this.selectedValues)||(this.ulElement.BoldBIDashboardListBox("uncheckAll"),this.checkByIndex(this.selectedValues)),this.updateSelectedvalues(this.setSelectedValues()),this.filter(this.isFilterInitiated),this.updateFieldCheckbox()},t.prototype.processQuery=function(e){var t;return this.initialLoad&&!this.isFiltered?!(e.cancel=!0):(this.loadingPopup.show(),t=this.ulElement.data("BoldBIDashboardListBox"),this.virtualScrolling.StartIndex=t._listSize+1,this.virtualScrolling.PageSize=1e3,this.fieldInfo.FilterInfo=new l.Dashboard.FilterInfoForUI,this.isFiltered&&0<this.inputText.length&&(this.fieldInfo.FilterInfo.DimensionFilterInfo=this.getFilterInfo(this.inputText),this.ulElement.removeAttr("style")),this.isSorted&&(this.fieldInfo.CustomSorting=new l.Dashboard.CustomSortForUI,this.fieldInfo.CustomSorting.CustomSortType="Alphabetic",this.fieldInfo.CustomSorting.CustomSortOrder=this.sortMethod),t=[this.fieldInfo],{url:e.dataSource.url,type:"POST",contentType:"application/json",data:JSON.stringify({className:l.DashboardUtil.DesignerAction.FilterAction,designerAction:l.DashboardUtil.DesignerAction.getData,fieldInfo:t,dataSetId:this.fieldInfo.DatasourceID,startIndex:this.virtualScrolling.StartIndex,filterType:this.isInitialFilter?"InitialFilter":"null",hasFilter:this.isFiltered,pageSize:this.virtualScrolling.PageSize})})},t.prototype.clearListItems=function(){var e=this.ulElement.data("BoldBIDashboardListBox");l.isNullOrUndefined(e)||(e._loadInitialRemoteData=!1,e._oldStartValue=void 0,e.totalItemsCount=e._listSize,!l.isNullOrUndefined(e._listitems)&&0<e._listSize?this.ulElement.empty():e.model.totalItemsCount=e._listSize+1)},t.prototype.getFilterInfo=function(e){var t=new DimensionFilterInfo;return t.AllowFilterInfo=new AllowFilteringInfo,0<e.length&&(t.IsAllowFilteringApplied=!0,t.AllowFilterInfo.Conditions=TextFilterOption.StartsWith.toString(),t.AllowFilterInfo.IsInclude=!0,t.AllowFilterInfo.FilterValues=[e]),t},t.prototype.processResponse=function(e){var t;if(!l.isNullOrUndefined(e.data)&&"[]"!==e.data)return this.loadingPopup.hide(),t=this.ulElement.data("BoldBIDashboardListBox"),this.fullDatasource=JSON.parse(e.data),t.model.totalItemsCount=e.hasMoreRecords?t._listSize+this.fullDatasource.length+1:t._listSize+this.fullDatasource.length,this.currentDatasource=this.currentDatasource.concat(this.fullDatasource),this.getUniqueDataSource(),this.fullDatasource},t.prototype.renderData=function(e){this.initialLoad&&(e.cancel=!0,(e=this.ulElement.data("BoldBIDashboardListBox")).model.dataSource=this.fullDatasource,this.currentDatasource=this.fullDatasource,e.model.totalItemsCount=this.hasRecords?this.fullDatasource.length+1:e._listSize+1)},t.prototype.fieldValueSelection=function(e){e.isInteraction&&!l.isNullOrUndefined(e.event)&&(-1===this.selectedValues.indexOf(e.value)||0===this.selectedValues.length?(this.selectedValues.push(e.value),this.selectedValues=this.getUniqueValues(this.selectedValues)):-1===this.selectedValues.indexOf(e.value)||l.isNullOrUndefined(e.event)||!1!==e.event.isChecked&&!1!==e.isChecked||(e=this.selectedValues.indexOf(e.value),this.selectedValues.splice(e,1),this.selectedValues=this.getUniqueValues(this.selectedValues)),e={type:"onItemSelection",data:{selectedValues:this.selectedValues}},this.invokeCallBackHandler(e),this.updateFieldCheckbox())},t.prototype.getUniqueValues=function(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},t.prototype.getUniqueDataSource=function(){this.currentDatasource=this.currentDatasource.filter(function(t,e,i){return e===i.findIndex(function(e){return e.fieldId===t.fieldId})})},t.prototype.updateFieldCheckbox=function(){var e,t;this.selectedValues=this.getUniqueValues(this.selectedValues),this.allowVirtualScrolling||null!==this.isFilterInitiated?this.allowVirtualScrolling&&null===this.isFilterInitiated?0<this.inputText.length?(e=this.getFieldItems(),t=this.getCount(e,this.selectedValues),this.switchCheckboxState(t,e.length)):this.switchCheckboxState(this.selectedValues.length,this.currentDatasource.length):null!==this.isFilterInitiated&&this.checkboxStateForMapping():!l.isNullOrUndefined(this.inputText)&&0<this.inputText.length?(t=this.getCount(this.searchedText,this.selectedValues),this.switchCheckboxState(t,this.searchedText.length)):this.switchCheckboxState(this.selectedValues.length,this.fullDatasource.length)},t.prototype.checkboxStateForMapping=function(){var e,t;null===this.isFilterInitiated||0===this.inputText.length||this.allowVirtualScrolling?this.isFilterInitiated===filterOptions.Checked?(this.checkedDataOnMapping=this.getUniqueValues(this.checkedDataOnMapping),0<this.inputText.length?(e=this.getCount(this.getFieldItems(),this.checkedDataOnMapping),t=this.getCount(this.getFieldItems(),this.selectedValues),this.switchCheckboxState(t,e)):this.switchCheckboxState(this.selectedValues.length,this.checkedDataOnMapping.length)):(this.unCheckedDataOnMapping=this.getUniqueValues(this.unCheckedDataOnMapping),0<this.inputText.length?(e=this.getCount(this.getFieldItems(),this.unCheckedDataOnMapping),t=this.getCount(this.getFieldItems(),this.selectedValues),this.switchCheckboxState(t,e)):(t=this.getCount(this.unCheckedDataOnMapping,this.selectedValues),this.switchCheckboxState(t,this.unCheckedDataOnMapping.length))):this.isFilterInitiated===filterOptions.Checked?0<this.inputText.length?(t=this.getCount(this.filterSearched,this.selectedValues),this.switchCheckboxState(t,this.filterSearched.length)):(e=this.getCheckedText(this.checkedDataOnMapping),this.switchCheckboxState(this.selectedValues.length,e.length)):0<this.inputText.length?(t=this.getCount(this.uncheckedText,this.selectedValues),this.switchCheckboxState(t,this.uncheckedText.length)):(t=this.getCount(this.unCheckedDataOnMapping,this.selectedValues),this.switchCheckboxState(t,this.unCheckedDataOnMapping.length))},t.prototype.getCount=function(e,t){for(var i,a=0,o=0;o<e.length;o++)for(i=0;i<t.length;i++)e[o]===t[i]&&a++;return a},t.prototype.switchCheckboxState=function(e,t){0<e&&e!==t?this.setCheckboxDataType(CheckList.Intermeditae):0===e?this.setCheckboxDataType(CheckList.Uncheck):this.setCheckboxDataType(CheckList.Check)},t.prototype.setCheckboxDataType=function(e){this.invokeCallBackHandler({type:e})},t.prototype.updateTheSelectedFieldValues=function(e){var t,i;for(this.selectedValues=e,this.ulElement.BoldBIDashboardListBox("uncheckAll"),t=0;t<e.length;t++)i=this.ulElement.BoldBIDashboardListBox("getIndexByText",e[t]),this.ulElement.BoldBIDashboardListBox("checkItemByIndex",i);this.filter(this.isFilterInitiated),this.updateFieldCheckbox()},t.prototype.requestFailed=function(e){e.statusText&&this.displayErrorMsg()},t.prototype.displayErrorMsg=function(){this.invokeCallBackHandler({type:"updateUiOnUserList",data:{data:!1}}),this.displayError(this.locale.errorMessage.serverConnectionError)},t.prototype.displayError=function(e){this.wrapper.find("#"+this.id+"_error_message").css("display","block"),this.wrapper.find("#"+this.id+"_error_message p").html(e),this.wrapper.find("#"+this.id+"_retry_block").show()},t.prototype.hideError=function(){this.wrapper.find("#"+this.id+"_error_message p").empty(),this.wrapper.find("#"+this.id+"_error_message").css("display","none"),this.wrapper.find("#"+this.id+"_retry_block").hide()},t.prototype.showLoadingIndicator=function(){this.bufferIndicator.show()},t.prototype.hideLoadingIndicator=function(){this.bufferIndicator.hide()},t.prototype.reloadDataSource=function(){this.hideError(),this.getFieldValues(this.fieldInfo)},t.prototype.search=function(e){var t,i,a,o,s;if(this.allowVirtualScrolling)l.isNullOrUndefined(e)||(this.inputText=e,this.processFilterDataRequest());else if(t=this.searchInDatasource(e),l.isNullOrUndefined(t))a=this.getCheckedText(this.getCheckedItems()),null!=this.isFilterInitiated?this.filter(this.isFilterInitiated):(this.hideError(),this.setDatasource(this.fullDatasource),this.checkByIndex(a),this.updateFieldCheckbox(),this.tooltipForLengthFieldText());else if(l.isNullOrUndefined(t.length)||0===t.length)0===t?this.displayError(this.locale.errorMessage.serverConnectionError):(this.ulElement.BoldBIDashboardListBox("hideAllItems"),e=this.locale.userFilterLocale.noResultsFound,this.noData(e));else{for(i=void 0,this.searchedText=[],i=0;i<t.length;i++)this.searchedText[i]=this.ulElement.BoldBIDashboardListBox("getTextByIndex",t[i]);if(e=this.getCheckedItems(),a=this.getCheckedText(e),this.filterSearched=[],this.uncheckedText=[],o=void 0,null!=this.isFilterInitiated&&0!==a.length){for(i=0;i<this.searchedText.length;i++)for(s=o=0;s<a.length;s++){if(this.searchedText[i]===a[s]){this.filterSearched=this.filterSearched.concat(this.searchedText[i]);break}if(++o===a.length){this.uncheckedText=this.uncheckedText.concat(this.searchedText[i]);break}}this.isFilterInitiated===filterOptions.Checked?(this.wrapper.find("#"+this.id+"_error_message").css("display","none"),this.ulElement.BoldBIDashboardListBox("hideAllItems"),this.setCheckboxDataType(CheckList.Check),this.ulElement.BoldBIDashboardListBox("showItemsByValues",this.filterSearched),0===this.filterSearched.length?(this.setCheckboxDataType(CheckList.Uncheck),this.showErrorMessage()):this.setCheckboxDataType(CheckList.Check)):(this.wrapper.find("#"+this.id+"_error_message").css("display","none"),this.showFieldValues(t),this.ulElement.BoldBIDashboardListBox("hideAllItems"),this.ulElement.BoldBIDashboardListBox("showItemsByValues",this.uncheckedText),this.setCheckboxDataType(CheckList.Uncheck),t.length===this.filterSearched.length&&this.showErrorMessage())}else this.hideError(),this.showFieldValues(t)}},t.prototype.processFilterDataRequest=function(){var e,t;this.isFiltered=!0,this.currentDatasource=[],e=this.fieldInfo.UniqueColumnName,this.getUniqueValues(this.selectedValues),this.clearListItems(),(t=this.ulElement.data("BoldBIDashboardListBox"))._listSize=0,t._loadInitialRemoteData=!0,this.ulElement.BoldBIDashboardListBox({dataSource:this.updateDataManager(),fields:{id:e,text:e},allowVirtualScrolling:!0,virtualScrollMode:l.VirtualScrollMode.Continuous,itemRequestCount:this.virtualScrolling.PageSize,actionBegin:this.bbdesigner$.proxy(this.renderData,this),actionComplete:this.bbdesigner$.proxy(this.setCheckedValues,this)}),t.scrollerObj.refresh()},t.prototype.showFieldValues=function(e){this.ulElement.BoldBIDashboardListBox("hideAllItems"),this.ulElement.BoldBIDashboardListBox("showItemsByIndices",e),this.updateFieldCheckbox(),this.tooltipForLengthFieldText()},t.prototype.searchInDatasource=function(e){var t,i,a=[],o=this.ulElement.data("BoldBIDashboardListBox").model.dataSource,s=this.fieldInfo.UniqueColumnName;if(this.inputText=e.toUpperCase(),l.isNullOrUndefined(o))return 0;if(0<this.inputText.length){for(t=0;t<o.length;t++)i=String(o[t][s]).toUpperCase(),""!==this.inputText&&i.startsWith(this.inputText)&&a.push(t);return a}return null},t.prototype.setDatasource=function(e,t){this.emptyFieldValues(),t?(this.fullDatasource=e,this.allowVirtualScrolling=t,t=this.fieldInfo.UniqueColumnName,this.initialLoad=!0,this.isFiltered=!1,this.sortMethod=SortType.Asc,this.sortMethod=this.sortMethod===SortType.Asc?"Ascending":"Descending",this.clearListItems(),this.ulElement.removeAttr("style"),this.ulElement.data("BoldBIDashboardListBox").destroy(),this.ulElement.BoldBIDashboardListBox({dataSource:this.updateDataManager(),showCheckbox:!0,width:"258px",height:"285px",checkChange:this.bbdesigner$.proxy(this.fieldValueSelection,this),cssClass:"bbi-dbrd-designer-fieldlist",fields:{id:t,text:t},allowVirtualScrolling:!0,virtualScrollMode:l.VirtualScrollMode.Continuous,itemRequestCount:this.virtualScrolling.PageSize,actionBegin:this.bbdesigner$.proxy(this.renderAction,this),actionComplete:this.bbdesigner$.proxy(this.setCheckedValues,this)}),this.initialLoad&&(this.initialLoad=!1)):this.ulElement.data("BoldBIDashboardListBox").option({dataSource:e}),this.updateFieldCheckbox()},t.prototype.renderAction=function(e){this.initialLoad&&(e.cancel=!0,e=this.ulElement.data("BoldBIDashboardListBox"),this.currentDatasource=this.fullDatasource,e.model.totalItemsCount=this.allowVirtualScrolling?this.fullDatasource.length+1:e._listSize+1,e.mergeData(this.fullDatasource))},t.prototype.emptyFieldValues=function(){this.ulElement.data("BoldBIDashboardListBox").setModel({dataSource:[]})},t.prototype.sort=function(e){if(this.sortMethod=e,this.allowVirtualScrolling)this.sortForVirtualScrolling();else switch(e){case SortType.Asc:case SortType.Desc:this.sortAction(e)}},t.prototype.sortForVirtualScrolling=function(){var e,t;this.isFiltered=!1,this.isSorted=!0,this.currentDatasource=[],e=this.fieldInfo.UniqueColumnName,this.clearListItems(),(t=this.ulElement.data("BoldBIDashboardListBox"))._listSize=0,t._loadInitialRemoteData=!0,this.sortMethod=this.sortMethod===SortType.Asc?"Ascending":"Descending",this.fieldInfo.CustomSorting=new l.Dashboard.CustomSortForUI,this.fieldInfo.CustomSorting.CustomSortType="Alphabetic",this.fieldInfo.CustomSorting.CustomSortOrder=this.sortMethod,this.ulElement.BoldBIDashboardListBox({dataSource:this.updateDataManager(),fields:{id:e,text:e},allowVirtualScrolling:!0,virtualScrollMode:l.VirtualScrollMode.Continuous,itemRequestCount:this.virtualScrolling.PageSize,actionBegin:this.bbdesigner$.proxy(this.renderData,this),actionComplete:this.bbdesigner$.proxy(this.setCheckedValues,this)}),t.scrollerObj.refresh()},t.prototype.sortAction=function(e){var t=this.getCheckedText(this.ulElement.BoldBIDashboardListBox("getCheckedItems")),e=this.methodToSort(this.fullDatasource,e);this.setDatasource(e),this.checkByIndex(t),null==this.isFilterInitiated||l.isNullOrUndefined(this.inputText)||this.filter(this.isFilterInitiated),l.isNullOrUndefined(this.inputText)||this.search(this.inputText),this.tooltipForLengthFieldText()},t.prototype.reload=function(){this.fullDatasource=[],this.currentDatasource=[],this.inputText="",this.getFieldValues(this.fieldInfo)},t.prototype.methodToSort=function(e,t){var i,a;return l.isNullOrUndefined(e)||0===e.length||(t===SortType.Asc?e.sort(function(e,t){return a="number"==typeof e.fieldid&&"number"==typeof t.fieldid?(i=e.fieldid,t.fieldid):(i=String(e.fieldid).toLowerCase(),String(t.fieldid).toLowerCase()),i<a?-1:a<i?1:0}):t===SortType.Desc&&e.sort(function(e,t){return(a="number"==typeof e.fieldid&&"number"==typeof t.fieldid?(i=e.fieldid,t.fieldid):(i=String(e.fieldid).toLowerCase(),String(t.fieldid).toLowerCase()))<i?-1:i<a?1:0})),e},t.prototype.getCheckedText=function(e){var t,i=[];if(l.isNullOrUndefined(e)||0===e.length)return null;for(t=0;t<e.length;t++)""!==e[t].text&&(i[t]=e[t].text);return i},t.prototype.checkByIndex=function(e){var t,i,a=[];if(!l.isNullOrUndefined(e)&&0!==e.length){for(i=0;i<e.length;i++)a[i]=this.ulElement.BoldBIDashboardListBox("getIndexByText",e[i]);for(this.ulElement.BoldBIDashboardListBox("uncheckAll"),t=[],i=0;i<a.length;i++)0<=a[i]&&t.push(a[i]);this.ulElement.BoldBIDashboardListBox("checkItemsByIndices",t)}},t.prototype.checkAll=function(){l.isNullOrUndefined(this.ulElement.data("BoldBIDashboardListBox"))||this.ulElement.BoldBIDashboardListBox("checkAll")},t.prototype.uncheckAll=function(){l.isNullOrUndefined(this.ulElement.data("BoldBIDashboardListBox"))||this.ulElement.BoldBIDashboardListBox("unCheckAll"),this.setCheckboxDataType(CheckList.Uncheck)},t.prototype.getCheckedItems=function(){var e=this.ulElement.BoldBIDashboardListBox("getCheckedItems");return l.isNullOrUndefined(e)||0===e.length?[]:e},t.prototype.clearSelectedValues=function(){this.selectedValues=[]},t.prototype.filter=function(e){switch(this.hideError(),this.checkedDataOnMapping=this.allowVirtualScrolling?this.selectedValues:this.getCheckedItems(),e){case filterOptions.All:this.ulElement.BoldBIDashboardListBox("showAllItems"),this.isFilterInitiated=null,this.updateFieldCheckbox();break;case filterOptions.Checked:this.checkedOption(this.selectedValues);break;case filterOptions.UnChecked:this.unCheckedOption(this.selectedValues)}},t.prototype.updateSelectedvalues=function(e){for(var t=0;t<e.length;t++)this.selectedValues.push(e[t]);this.getUniqueValues(this.selectedValues)},t.prototype.checkedOption=function(e){this.setCheckboxDataType(CheckList.Check),this.ulElement.BoldBIDashboardListBox("hideAllItems"),l.isNullOrUndefined(e)||0===e.length?(this.isFilterInitiated=filterOptions.Checked,this.setCheckboxDataType(CheckList.Uncheck),this.showErrorMessage()):(this.isFilterInitiated=filterOptions.Checked,this.ulElement.BoldBIDashboardListBox("showItemsByValues",e)),this.allowVirtualScrolling&&this.ulElement.css("height","300px")},t.prototype.unCheckedOption=function(e){var t;this.getUnCheckedItems(),this.setCheckboxDataType(CheckList.Uncheck),this.isFilterInitiated=filterOptions.UnChecked,!l.isNullOrUndefined(e)&&0<e.length?(t=this.ulElement.data("BoldBIDashboardListBox"),e.length===t._listSize?(this.ulElement.BoldBIDashboardListBox("hideAllItems"),this.showErrorMessage()):(this.ulElement.BoldBIDashboardListBox("showAllItems"),this.ulElement.BoldBIDashboardListBox("hideCheckedItems"))):this.ulElement.BoldBIDashboardListBox("showAllItems"),this.allowVirtualScrolling&&this.ulElement.css("height","300px")},t.prototype.getUnCheckedItems=function(){var e,t,i,a,o;if(this.unCheckedDataOnMapping=[],i=this.fieldInfo.UniqueColumnName,this.getUniqueDataSource(),t=this.allowVirtualScrolling?this.currentDatasource:this.fullDatasource,this.selectedValues=this.getUniqueValues(this.selectedValues),0<this.selectedValues.length)for(o=0;o<t.length;o++)for(a=e=0;a<this.selectedValues.length;a++)this.selectedValues[a]!==t[o][i]&&++e===this.selectedValues.length&&this.unCheckedDataOnMapping.push(t[o][i]);else for(o=0;o<t.length;o++)this.unCheckedDataOnMapping.push(t[o][i])},t.prototype.getFieldItems=function(){for(var e=this.fieldInfo.UniqueColumnName,t=[],i=0;i<this.currentDatasource.length;i++)t.push(this.currentDatasource[i][e]);return t},t.prototype.showErrorMessage=function(){var e=this.locale.userFilterLocale.noResultsFound;this.noData(e)},t.prototype.triggerSearchEvent=function(){l.isNullOrUndefined(this.inputText)||this.search(this.inputText)},t.prototype.noData=function(e){this.wrapper.find("#"+this.id+"_error_message").css("display","block"),this.wrapper.find("#"+this.id+"_error_message p").html(e),this.invokeCallBackHandler({type:"onFieldListError",data:{data:!1}})},t.prototype.disable=function(){var e=this.ulElement.data("BoldBIDashboardListBox");l.isNullOrUndefined(e)||e.disable()},t.prototype.enable=function(){var e=this.ulElement.data("BoldBIDashboardListBox");l.isNullOrUndefined(e)||e.enable()},e.UserFilterFieldValueList=t}(BoldBIDashboard=BoldBIDashboard||{}),function(e){e.Asc="ascending",e.Desc="descending"}(SortType=SortType||{}),function(e){e.All="All",e.Checked="Checked",e.UnChecked="UnChecked"}(filterOptions=filterOptions||{}),function(e){e.Check="Checked",e.Uncheck="Unchecked",e.Intermeditae="Intermediate"}(CheckList=CheckList||{}),function(h){var e;function t(e,t,i,a){this.callBackInstance=null,this.callBackMethod=null,this.autoMapping=BasicUserFilterBasedOn.None,this.locale=null,this.callBackInstance=i,this.callBackMethod=a,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=t.attr("id"),this.iconContainer=t,this.createIconTemplateElement(t),this.unWireEvents(),this.wireEvents()}e=h.Dashboard||(h.Dashboard={}),t.prototype.createIconTemplateElement=function(e){var t,i;if(!h.isNullOrUndefined(e))for(t=e.children(),i=0;i<t.length;i++){var a=t.eq(i),o=!h.isNullOrUndefined(a.attr("data-name"))&&"field"===a.attr("data-name"),s=h.buildTag("div."+(o?"bbi-dbrd-uf-field-icon-list bbi-dbrd-uf-list-icon-container":"bbi-dbrd-uf-list-icon-container"),"",{},{id:this.id+"_container"}),n=h.buildTag("div.bbi-dbrd-uf-list-icon-user-mapping bbi-dbrd-designer-hand-cursor bbi-dbrd-designer-hoverable","",{},{id:this.id+"_usermapping","data-name":"userGroupMapping","data-tooltip":this.locale.userFilterLocale.autoMapUsers}),r=h.buildTag("div.bbi-dbrd-uf-list-icon-user-mapping-shuffle","",{},{id:this.id+"_usermapping_shuffle","data-name":"userGroupMapping"}),d=h.buildTag("div.bbi-dbrd-uf-list-icon-user-mapping-dropdown","",{},{id:this.id+"_usermapping_dropdown","data-name":"userGroupMapping"}),l=h.buildTag("div.bbi-dbrd-uf-list-icon-sorting bbi-dbrd-uf-list-icon-container bbi-dbrd-icon-background-theme bbi-dbrd-designer-hand-cursor bbi-dbrd-designer-hoverable","",{},{id:this.id+"_sorting","data-name":o?"fieldSorting":"userGroupSorting","data-tooltip":this.locale.userFilterLocale.sort});n.append(r,d),this.appendIconElement(o,s,n),(o?(a.find(".bbi-dbrd-uf-field-icon-title-wrapper").append(s),a.find(".bbi-dbrd-uf-field-icon-search-wrapper")):(a.find(".bbi-dbrd-uf-user-icon-title-wrapper").append(s),a.find(".bbi-dbrd-uf-user-icon-search-wrapper"))).append(l)}},t.prototype.updateIcons=function(e){this.updateCheckIconForMenu("_view_userlist_ConfigMenu","user_mapped"),this.updateCheckIconForMenu("_view_data_ConfigMenu","data_checked"),this.updateAutomapping(e)},t.prototype.updateAutomapping=function(e){this.autoMapping=e},t.prototype.updateAutoMappingMenu=function(e){if(0<e.length)switch(this.autoMapping){case BasicUserFilterBasedOn.None:this.switchCheckIcon("none");break;case BasicUserFilterBasedOn.Email:this.switchCheckIcon("email");break;case BasicUserFilterBasedOn.FullName:this.switchCheckIcon("fullname");break;case BasicUserFilterBasedOn.GroupName:this.switchCheckIcon("groupname")}},t.prototype.invokeCallBackHandler=function(e){h.isNullOrUndefined(this.callBackInstance)||h.isNullOrUndefined(this.callBackMethod)||h.DashboardUtil.invokeMethod(this.callBackInstance,this.callBackMethod,[e])},t.prototype.appendIconElement=function(e,t,i){var a=h.buildTag("div.bbi-dbrd-uf-list-icon-view bbi-dbrd-icon-background-theme bbi-dbrd-designer-hand-cursor bbi-dbrd-designer-hoverable","",{},{id:e?this.id+"_view_Data":this.id+"_view_userlist","data-name":e?"viewFieldData":"viewUserList","data-tooltip":this.locale.userFilterLocale.filter}),o=h.buildTag("div.bbi-dbrd-uf-list-icon-refresh bbi-dbrd-icon-background-theme bbi-dbrd-designer-hand-cursor bbi-dbrd-designer-hoverable","",{},{id:this.id+"_refresh","data-name":e?"refreshData":"refreshUserList","data-tooltip":this.locale.userFilterLocale.refresh});t.append(o,a),e||t.append(i)},t.prototype.templateIconTriggered=function(e){if(!h.isNullOrUndefined(e)){var t=this.bbdesigner$(e.target).attr("data-name");switch(t){case"userGroupMapping":case"viewUserList":case"viewFieldData":this.openMenuPopup(e,t)}}},t.prototype.openMenuPopup=function(e,t){var i,a,o,s;this.menuId=this.populateMenuItems(t),(i=this.bbdesigner$("#"+this.menuId)).is("visible")?i.hide():(a=i.data("BoldBIDashboardMenu"),o="userGroupMapping"===t?this.id+"_usermapping":"viewUserList"===t?this.id+"_view_Data":this.id+"_view_userlist",s=this.bbdesigner$(e.target).offset().left<i.width()?this.bbdesigner$(e.target).offset().left:this.bbdesigner$(e.target).offset().left+this.iconContainer.find("#"+o).width()-i.width(),a.show(s,this.bbdesigner$(e.target).offset().top+this.iconContainer.find("#"+o).outerHeight(!0),this.iconContainer.find("#"+o),e)),"userGroupMapping"===t&&this.updateAutoMappingMenu(i)},t.prototype.populateMenuItems=function(e){var t,i,a=this.getMenuItems(e);return this.menuId="userGroupMapping"===e?this.id+"_usermapping_ConfigMenu":"viewUserList"===e?this.id+"_view_userlist_ConfigMenu":this.id+"_view_data_ConfigMenu",0===this.bbdesigner$("#"+this.menuId).length&&(t=h.buildTag("ul.bbi-designer-menu","",{},{id:this.menuId}),"userGroupMapping"===e&&(i=h.buildTag("p.bbi-dbrd-uf-usergroupmenu-title","User Mapping with",{},{}),t.append(i)),i="userGroupMapping"===e?this.id+"_usermapping":"viewUserList"===e?this.id+"_view_Data":this.id+"_view_userlist",t.BoldBIDashboardMenu({menuType:h.MenuType.ContextMenu,openOnClick:!1,container:"#"+i,width:"160",fields:{dataSource:a,id:"id",parentId:"parentId",text:"text",spriteCssClass:"sprite"},cssClass:"bbi-dbrd-userbased-filter-menu-list",click:this.bbdesigner$.proxy(this.triggeredMenuOptionForUserFilter,this)})),this.menuId},t.prototype.getMenuItems=function(e){var t=[];return"userGroupMapping"===e?t.push({id:"none",text:this.locale.userFilterLocale.noneText,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "},{id:"fullname",text:this.locale.userFilterLocale.fullNameText,parentId:null,sprite:"bbi-dbrd-usergroup-mapping-tickmark"},{id:"email",text:this.locale.userFilterLocale.emailText,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "},{id:"groupname",text:this.locale.userFilterLocale.groupNameText,parentId:null,sprite:"bbi-dbrd-usergroup-mapping-tickmark"}):"viewUserList"===e?t.push({id:"user_mapped",text:this.locale.userFilterLocale.all,parentId:null,sprite:"bbi-dbrd-usergroup-mapping-tickmark"},{id:"Mapped",text:this.locale.userFilterLocale.mapped,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "},{id:"Unmapped",text:this.locale.userFilterLocale.unMapped,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "}):"viewFieldData"===e&&t.push({id:"data_checked",text:this.locale.userFilterLocale.all,parentId:null,sprite:"bbi-dbrd-usergroup-mapping-tickmark"},{id:"Checked",text:this.locale.userFilterLocale.checked,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "},{id:"Unchecked",text:this.locale.userFilterLocale.unChecked,parentId:null,sprite:"bbi-dbrd-userfilter-mapping-tickmark "}),t},t.prototype.triggeredMenuOptionForUserFilter=function(e){var t=null;switch(e.ID){case"email":case"fullname":case"groupname":case"none":t={type:"autoMapping",text:e.text,data:e.ID},this.invokeCallBackHandler(t);break;case"data_checked":case"Checked":case"Unchecked":t={type:"filtering",data:e.ID},this.invokeCallBackHandler(t);break;case"user_mapped":case"Mapped":case"Unmapped":t={type:"userMapping",data:e.ID},this.invokeCallBackHandler(t)}this.switchCheckIcon(e.ID)},t.prototype.switchCheckIcon=function(e){this.bbdesigner$("#"+this.menuId).find("span").css("display","none"),this.bbdesigner$("#"+this.menuId).find("#"+e).find("span").css("display","block")},t.prototype.updateCheckIconForMenu=function(e,t){this.bbdesigner$("#"+this.id+e).find("span").css("display","none"),this.bbdesigner$("#"+this.id+e).find("#"+t).find("span").css("display","block")},t.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click",".bbi-dbrd-uf-list-icon-container",this.bbdesigner$.proxy(this.templateIconTriggered,this))},t.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click",".bbi-dbrd-uf-list-icon-container",this.bbdesigner$.proxy(this.templateIconTriggered,this))},e.UserFilterIconTemplate=t}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e,t,i,a,o){this.callBackInstance=null,this.callBackMethod=null,this.locale=null,this.callBackInstance=a,this.callBackMethod=o,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=(l.isNullOrUndefined(i.attr("id"))?this.dashboardDesigner._id:i.attr("id"))+"_user_filter_template",this.model=t,this.renderTemplateforUserFilter(i),this.unWireEvents(),this.wireEvents()}e=l.Dashboard||(l.Dashboard={}),t.prototype.invokeCallBackHandler=function(e){l.isNullOrUndefined(this.callBackInstance)||l.isNullOrUndefined(this.callBackMethod)||l.DashboardUtil.invokeMethod(this.callBackInstance,this.callBackMethod,[e])},t.prototype.renderTemplateforUserFilter=function(e){var t=this.wrapper=l.buildTag("div","",{},{id:this.id+"_wrapper"}),i=l.buildTag("div.bbi-dbrd-uf-element-container","",{},{id:this.id+"_element_container"}),a=l.buildTag("div.bbi-dbrd-uf-filter-container","",{},{id:this.id+"_element_filter_container"}),o=l.buildTag("span.bbi-dbrd-uf-filter-name",this.locale.userFilterLocale.filterName,{},{id:this.id+"_filter_container_filter_name"}),s=this.filterInput=l.buildTag("input.bbi-dbrd-uf-filter-input e-textbox","",{},{id:this.id+"_filter_container_filter_input"}),n=l.buildTag("div.bbi-dbrd-uf-datacolumn-container","",{},{id:this.id+"_element_data_column_container"}),r=l.buildTag("span.bbi-dbrd-uf-datacolumn-name",this.locale.userFilterLocale.dataColumnName,{},{id:this.id+"_filter_container_datacolumn_name"}),d=l.buildTag("div.bbi-dbrd-uf-input-container","",{},{id:this.id+"_filter_input_container"});this.dataColumnInput=l.buildTag("input.e-dbrd-uf-datacolumn-input","",{},{id:this.id+"_filter_container_datacolumn_input"}),a.append(o,s),n.append(r,d),i.append(a,n),t.append(i),e.append(t),this.model.isHierarchical?(o={fields:{id:"ColumnId",parentId:"ParentId",hasChild:"HasChild",dataSource:this.model.fields,text:"Name"},callBackInstance:this,callBackMethod:"onFieldSelect",popupHeight:"200%",width:"100%",height:"24px",optionalArgs:this,cssClass:"bbi-dbrd-uf-template"},this.drpdwnObj=new l.DashboardDesignerUtility.DropdownTreeview(this.dashboardDesigner,o,d).dropDownObj):(d.append(this.dataColumnInput),this.drpdwnObj=this.dataColumnInput.BoldBIDashboardDropDownList({popupHeight:"200px",width:"100%",height:"100%",minPopupHeight:"150px",cssClass:"bbi-dbrd-uf-template bbi-dbrd-control e-combobox-control",change:this.bbdesigner$.proxy(this.onFieldSelect,this),dataSource:this.model.fields,fields:{text:"Name"},selectedIndex:-1}).data("BoldBIDashboardDropDownList")),this.filterInput.val(this.model.filterName)},t.prototype.updateUIForFilterClick=function(t){var e,i,a=null;l.isNullOrUndefined(t.ColumnId)||(a=l.isNullOrUndefined(this.model.fields[0].ID)?this.model.fields.find(function(e){return e.ColumnId===t.ColumnId}):this.model.fields.find(function(e){return e.ID===t.ColumnId})),this.updatePreviousValue(a),this.filterInput.val(t.Name),e=l.isNullOrUndefined(t.ColumnId)?-1:l.isNullOrUndefined(this.model.fields[0].ID)?this.model.fields.findIndex(function(e){return e.ColumnId===t.ColumnId}):this.model.fields.findIndex(function(e){return e.ID===t.ColumnId}),this.drpdwnObj.model.selectedIndex!==e&&(this.model.isHierarchical&&!l.isNullOrUndefined(a)?(i=this.dashboardDesigner.element.find("#"+this.id+"_filter_input_container").data("DesignerPropertyWidget"),l.isNullOrUndefined(i)||i.selectItem(a.ColumnId)):this.drpdwnObj.selectItemByIndex(e),-1===e||l.isNullOrUndefined(a)||this.updateSelectionInfo("onUIupdation"))},t.prototype.getFieldName=function(t){return(l.isNullOrUndefined(this.model.fields[0].ID)?this.model.fields.find(function(e){return e.ColumnId===t}):this.model.fields.find(function(e){return e.ID===t})).Name},t.prototype.updatePreviousValue=function(e){this.previousSelectedValue=l.isNullOrUndefined(e)?null:{name:e.Name,id:this.model.isHierarchical?e.ColumnId:e.ID}},t.prototype.unWireEvents=function(){this.filterInput.off("focusout",this.bbdesigner$.proxy(this.onFocusOutName,this))},t.prototype.onOkBtnClick=function(e){e?(this.updateSelectionInfo(),this.previousSelectedValue={name:this.drpdwnObj.model.text,id:this.drpdwnObj.model.value}):this.updateDropDownSelection(this.previousSelectedValue)},t.prototype.updateDropDownSelection=function(e){var t;this.model.isHierarchical?(t=this.dashboardDesigner.element.find("#"+this.id+"_filter_input_container").data("DesignerPropertyWidget"),l.isNullOrUndefined(t)||t.selectItem(e.id)):this.dataColumnInput.BoldBIDashboardDropDownList("selectItemByText",e.name)},t.prototype.updateSelectionInfo=function(e){var t,i;this.model.isHierarchical?(i=this.dashboardDesigner.element.find("#"+this.id+"_filter_input_container").data("DesignerPropertyWidget"),l.isNullOrUndefined(i)||(t={Name:(i=i.getSelection()).name,ID:i.value})):t=this.drpdwnObj.model.dataSource[this.drpdwnObj.model.selectedIndex],i={type:l.isNullOrUndefined(e)?"onItemSelection":e,data:{fieldInfo:t,selectedInfo:t.Name}},this.invokeCallBackHandler(i)},t.prototype.wireEvents=function(){this.filterInput.on("change",this.bbdesigner$.proxy(this.onFocusOutName,this))},t.prototype.onFocusOutName=function(){var e={type:"filterNameUpdate",data:{name:this.filterInput.val()}};this.invokeCallBackHandler(e)},t.prototype.onFieldSelect=function(e){(this.model.isHierarchical||e.isInteraction)&&(l.isNullOrUndefined(this.previousSelectedValue)||l.isNullOrUndefined(this.previousSelectedValue.name)||l.isNullOrUndefined(this.previousSelectedValue.id)?(this.updateSelectionInfo(),this.previousSelectedValue={name:this.drpdwnObj.model.text,id:this.drpdwnObj.model.value}):this.createAlertDialog())},t.prototype.createAlertDialog=function(){this.dashboardDesigner.modules.util.alertDialog(this.locale.userFilterLocale.alertDialogTitle,this.locale.userFilterLocale.alertDialogAlertMsg,IconType.question,AlertType.Confirm,!1,"",{instance:this,method:"onOkBtnClick"})},e.UserFilterTemplateUi=t}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e,t,i,a){this.wrapper=null,this.ulTag=null,this.isMappingFirst=!0,this.fullDataSource=[],this.getCheckedData=[],this.listFieldName="Name",this.listFieldEmailId="Email",this.checkedListData="text",this.searchUserList=[],this.searchGroupList=[],this.userDataSource=[],this.groupDataSource=[],this.isCheckedFirstTime=!0,this.isUnCheckedFirstTime=!0,this.dataSourceForMapping=[],this.currentUser=[],this.userInfoList=[],this.callBackInstance=null,this.callBackMethod=null,this.mappedDataSource=[],this.searchText="",this.isFilered=!1,this.sortedDatasource=[],this.searchedText=[],this.locale=null,this.callBackInstance=i,this.callBackMethod=a,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.usersInGroupInst=new l.Dashboard.UsersInGroup(this.dashboardDesigner),this.virtualScrolling=new VirtualScrollSettings,this.renderListBox(t),this.unWireEvents(),this.wireEvents(),this.initSortWorkerInstance(),this.sortHelperEventListener(),this.targetContainer.data("DesignerPropertyWidget",this)}e=l.Dashboard||(l.Dashboard={}),t.prototype.renderListBox=function(e){l.isNullOrUndefined(e)||(this.id=(l.isNullOrUndefined(e.attr("id"))?this.dashboardDesigner._id:e.attr("id"))+"_user_group_list",this.targetContainer=e,this.createListBox(this.targetContainer))},t.prototype.resetRequest=function(){l.isNullOrUndefined(this.requestObj)||4===this.requestObj.readyState||(this.requestObj.abort(),this.requestObj=null)},t.prototype.showAll=function(){l.isNullOrUndefined(this.userGroupListInstance)||(this.searchText="",this.isInputTextPresents=!1,this.sortOption=null,this.mapOption=null,this.setDataSource(this.fullDataSource))},t.prototype.getScriptPath=function(e){return window.URL.createObjectURL(new Blob([e.toString().match(/^\s*function\s*\(\s*\)\s*\{(([\s\S](?!\}$))*[\s\S])/)[1]],{type:"text/javascript"}))},t.prototype.createListBox=function(e){this.wrapper=l.buildTag("div.bbi-dbrd-uf-user-group-list-wrapper","",{},{id:this.id+"_wrapper"}),t=l.buildTag("div.bbi-dbrd-uf-container","",{},{id:this.id+"_container"}),i=l.buildTag("div.bbi-dbrd-uf-listbox-wrapper","",{},{id:this.id+"_list_box_wrapper"}),this.ulTag=l.buildTag("ul.bbi-dbrd-uf-listbox-element","",{},{id:this.id+"_list_box_element"});var t,i,a=l.buildTag("div.bbi-dbrd-uf-listbox-error-msg","<center><p></p></center>",{},{id:this.id+"_listbox_error_msg"}),o=l.buildTag("div.bbi-dbrd-uf-retry-icon-wrapper","",{},{id:this.id+"_retry_icon_wrapper"}),s=l.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small ",this.locale.browseDialogMessages.retryText,{height:"20px"},{id:this.id+"_retry_icon",type:"button"}),n=l.buildTag("div.bbi-dbrd-uf-nomatch-err-msg","<center><p></p></center >",{},{id:this.id+"_no_result_errmsg"});t.append(n,i),i.append(a,this.ulTag),a.append(o),o.append(s),this.wrapper.append(t),e.append(this.wrapper),this.userGroupListInstance=this.ulTag.BoldBIDashboardListBox({template:'<span class ="bbi-dbrd-uf-list" data-isgroup = ${IsGroup} data-group-id = ${Id} data-user-id = ${Email}><span id='+this.id+'_${Id}_clear_icon_${IsGroup} class="e-chck-icon"></span><span class="bbi-dbrd-uf-user-group-icon e-dashboarddesigner-icon-${IsGroup}"></span><span class="bbi-dbrd-uf-list-text bbi-uf-list-username bbi-dbrd-designer-hoverable" id='+this.id+'_${Id} isGroup = ${IsGroup} data-tooltip = "${Name}" >${Name}</span><span class="bbi-dbrd-uf-icon-wrapper"><span class="bbi-dbsize e-dbrd-file-icon bbi-dbrd-uf-float"  id ='+this.id+'_${Id}_menu></span></span></span><span class="bbi-dbrd-uf-list-text e-dashboarddesigner-email-${IsGroup} bbi-dbrd-designer-hoverable" id= '+this.id+'_${Id} data-isgroup= ${IsGroup} data-tooltip = "${Email}" >${Email}</span><span class="bbi-dbrd-uf-list-text e-dashboarddesigner-usercount-${IsGroup}" id= '+this.id+"_${Id} data-isgroup= ${IsGroup} >User Count: ${UserCount}</span>",showCheckbox:!1,width:"258px",height:"283px",select:this.bbdesigner$.proxy(this.updateUserOnSelect,this)}).data("BoldBIDashboardListBox"),this.loaderInstance=this.wrapper.BoldBIDashboardWaitingPopup({showOnInit:!1,showImage:!0,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_designer_waiting_loader")}).data("BoldBIDashboardWaitingPopup")},t.prototype.search=function(e){var t;0<this.fullDataSource.length&&(this.searchText=e,this.isMappingFirst=!1,0<e.length?(this.isInputTextPresents=!0,0===(e=this.filterItems(this.fullDataSource,e.toLowerCase())).length?this.showNoMatchError():l.isNullOrUndefined(this.sortOption)?(l.isNullOrUndefined(this.mapOption)||this.mapping(this.mapOption),this.showListBoxDiv(),t=this.ulTag.data("BoldBIDashboardListBox").model.dataSource,0===(e=this.updateIndices(e,t)).length?this.showNoMatchError():(this.ulTag.BoldBIDashboardListBox("hideAllItems"),this.ulTag.BoldBIDashboardListBox("showItemsByIndices",e),this.ulTag.BoldBIDashboardListBox("selectItemByIndex",e[0]),this.updateUserSelectionOnFilter())):this.sort(this.sortOption,this.userInfoList)):(this.isInputTextPresents=!1,l.isNullOrUndefined(this.sortOption)?l.isNullOrUndefined(this.mapOption)?(this.userGroupListInstance.showAllItems(),this.showListBoxDiv(),this.ulTag.BoldBIDashboardListBox("selectItemByIndex",0)):(this.dataSourceForMapping=this.fullDataSource,this.mapping(this.mapOption)):this.sort(this.sortOption,this.userInfoList),this.updateUserSelectionOnFilter()))},t.prototype.updateIndices=function(e,t){var i,a,o;if(l.isNullOrUndefined(this.mapOption))return e;for(i=[],a=0;a<e.length;a++)for(o=0;o<this.mappedDataSource.length;o++)t[e[a]].Name===this.mappedDataSource[o]&&i.push(e[a]);return i},t.prototype.updateUserOnSelect=function(e){e.isInteraction&&!l.isNullOrUndefined(e.event)&&this.updateSelectedValuesForUser((e.data.IsGroup?e.data.Id:e.data.Email).toString(),!l.isNullOrUndefined(e.data.IsGroup)&&e.data.IsGroup)},t.prototype.invokeCallBackHandler=function(e){l.isNullOrUndefined(this.callBackInstance)||l.isNullOrUndefined(this.callBackMethod)||l.DashboardUtil.invokeMethod(this.callBackInstance,this.callBackMethod,[e])},t.prototype.updateUserSelectionOnFilter=function(){var e=this.ulTag.find(".e-select").find(".bbi-dbrd-uf-list"),t="true"===e.attr("data-isgroup"),e=t?e.attr("data-group-id"):e.attr("data-user-id");this.updateSelectedValuesForUser(e,t)},t.prototype.updateSelectedFieldValuesForUser=function(e){this.addUserSelection();var t=this.userInfoList.indexOf(e);1===e.SelectedValues.length&&-1===t&&this.userInfoList.push(e)},t.prototype.addUserSelection=function(){this.ulTag.find(".e-select").find(".e-chck-icon").addClass("e-check-user").css("visibility","visible")},t.prototype.updateTheSelectedGroupValues=function(e){var t,i;if(0===e.length)this.ulTag.find(".e-select").removeClass("e-select"),this.userInfoList=[];else for(this.userInfoList=e,t=0;t<e.length;t++)i=this.ulTag.find(".bbi-dbrd-uf-list"),this.updateUserSelection(i,e[0])},t.prototype.updateUserSelection=function(e,t){if(1<=e.length)for(var i=0;i<e.length;i++)t.IsGroup?this.bbdesigner$(e[i]).attr("data-isgroup")===t.IsGroup.toString()&&this.bbdesigner$(e[i]).attr("data-group-id")===t.UserId.toString()&&this.bbdesigner$(e[i]).find(".e-chck-icon").addClass("e-check-user").css("visibility","visible"):this.bbdesigner$(e[i]).attr("data-isgroup")===t.IsGroup.toString()&&this.bbdesigner$(e[i]).attr("data-user-id")===t.UserId.toString()&&this.bbdesigner$(e[i]).find(".e-chck-icon").addClass("e-check-user").css("visibility","visible")},t.prototype.updateUsers=function(e){this.userInfoList=e},t.prototype.clearUserSelection=function(){this.clearAllSelectedUser()},t.prototype.clearCurrentUserSelection=function(){this.ulTag.find(".e-select").find(".e-check-user").removeClass("e-check-user").css("visibility","hidden")},t.prototype.clearAllSelectedUser=function(){for(var e=this.ulTag.find(".bbi-dbrd-uf-list").find(".e-check-user"),t=0;t<e.length;t++)this.bbdesigner$(e[t]).css("visibility","hidden"),this.bbdesigner$(e[t]).removeClass("e-check-user")},t.prototype.addAllSelectedUser=function(e){this.userInfoList=e;for(var t=0;t<e.length;t++)this.updateUserSelection(this.ulTag.find(".bbi-dbrd-uf-list"),e[t])},t.prototype.updateSelectedValuesForUser=function(e,t){var i=new UserInfo;i.IsGroup=t,i.UserId=e,0!==(t=this.userInfoList.filter(function(e){return e.UserId===i.UserId})).length&&(i.IncludeFutureValues=t[0].IncludeFutureValues),this.invokeCallBackHandler({type:"selected",data:i})},t.prototype.getFirstSelectedUser=function(){this.ulTag.BoldBIDashboardListBox("selectItemByIndex",0);var e=new UserInfo;return!l.isNullOrUndefined(this.fullDataSource)&&0<this.fullDataSource.length&&(e.IsGroup=this.fullDataSource[0].IsGroup,e.UserId=(this.fullDataSource[0].IsGroup?this.fullDataSource[0].Id:this.fullDataSource[0].Email).toString()),e},t.prototype.getUpdatedCheckBoxItems=function(){var e,t;if(this.isCheckedFirstTime)this.updatedCheckedItems=this.getCheckedData,this.isCheckedFirstTime=!1;else for(this.updatedCheckedItems=this.updatedCheckedItems.concat(this.getCheckedData),this.getUniqueCheckedArray(),e=0;e<this.updatedUnCheckedItems.length;e++)for(t=this.updatedCheckedItems.length-1;0<=t;t--)this.updatedUnCheckedItems[e][this.listFieldName]===this.updatedCheckedItems[t][this.checkedListData]&&this.updatedCheckedItems.splice(t,1)},t.prototype.getUniqueCheckedArray=function(){var a=this,e=this.updatedCheckedItems.filter(function(e,t,i){return i.map(function(e){return e[a.checkedListData]}).indexOf(e[a.checkedListData])===t});this.updatedCheckedItems=e},t.prototype.getUpdatedUnCheckBoxItems=function(e){var t,i;if(this.isUnCheckedFirstTime)this.updatedUnCheckedItems=[],this.getUnCheckedArray(e),this.isUnCheckedFirstTime=!1;else for(this.getUnCheckedArray(e),this.getUniqueUnCheckedArray(),t=0;t<this.getCheckedData.length;t++)for(i=this.updatedUnCheckedItems.length-1;0<=i;i--)this.getCheckedData[t][this.checkedListData]===this.updatedUnCheckedItems[i][this.listFieldName]&&this.updatedUnCheckedItems.splice(i,1)},t.prototype.getUnCheckedArray=function(e){for(var t,i=1,a=0;a<e.length;a++)for(t=i=0;t<this.getCheckedData.length;t++)this.getCheckedData[t][this.checkedListData]!==e[a][this.listFieldName]&&++i===this.getCheckedData.length&&this.updatedUnCheckedItems.push(e[a])},t.prototype.getUniqueUnCheckedArray=function(){var a=this,e=this.updatedUnCheckedItems.filter(function(e,t,i){return i.map(function(e){return e[a.listFieldName]}).indexOf(e[a.listFieldName])===t});this.updatedUnCheckedItems=e},t.prototype.showListBoxDiv=function(){this.wrapper.find("#"+this.id+"_no_result_errmsg").hide(),this.wrapper.find("#"+this.id+"_list_box_wrapper").show()},t.prototype.showNoMatchError=function(){this.wrapper.find("#"+this.id+"_no_result_errmsg p").html(this.locale.userFilterLocale.noResultsFound),this.wrapper.find("#"+this.id+"_list_box_wrapper").hide(),this.wrapper.find("#"+this.id+"_no_result_errmsg").show(),this.invokeCallBackHandler({type:"onUserListError"})},t.prototype.filterItems=function(e,t){var i,a,o,s,n,r=[];for(this.searchedText=[],i=[],a=[],o=0;o<e.length;o++)s=e[o][this.listFieldName].toLowerCase(),n=e[o][this.listFieldEmailId],l.isNullOrUndefined(n)||""===n?""!==t&&!s.startsWith(t)||(r.push(o),a.push(e[o]),this.searchedText.push(e[o][this.listFieldName])):(""===t||s.startsWith(t)||n.startsWith(t))&&(r.push(o),i.push(e[o]),this.searchedText.push(e[o][this.listFieldName]));return this.dataSourceForMapping=i.concat(a),this.searchGroupList=a,this.searchUserList=i,r},t.prototype.showLoadingIndicator=function(){this.loaderInstance.show()},t.prototype.hideLoadingIndicator=function(){this.loaderInstance.hide()},t.prototype.wireEvents=function(){this.wrapper.on("click","#"+this.id+"_retry_icon",this.bbdesigner$.proxy(this.retry,this)),this.wrapper.on("click",".bbi-dbrd-uf-icon-wrapper",this.bbdesigner$.proxy(this.showMoreMenu,this))},t.prototype.unWireEvents=function(){this.wrapper.off("click","#"+this.id+"_retry_icon",this.bbdesigner$.proxy(this.retry,this)),this.wrapper.off("click",".bbi-dbrd-uf-icon-wrapper",this.bbdesigner$.proxy(this.showMoreMenu,this))},t.prototype.retry=function(){this.wrapper.find("#"+this.id+"_listbox_error_msg p").empty(),this.wrapper.find("#"+this.id+"_retry_icon_wrapper").hide(),this.fetchUserGroupList(void 0,!0)},t.prototype.clearSelectedUserFilter=function(){this.invokeCallBackHandler({type:"clearActiveFilterUserInfo"})},t.prototype.checkSelectedValuesForUser=function(){this.invokeCallBackHandler({type:"checkSelectedValues"})},t.prototype.setIsfilteredProperty=function(e){this.isFilered=e},t.prototype.onUserGroupListFetchSuccess=function(e,t){var i;t.Status?l.isNullOrUndefined(t.Data)||0===t.Data.length?this.showErroMsg(this.locale.userFilterLocale.noUsersAndGroupError):(this.virtualScrolling.PageSize=100,i=JSON.parse(t.Data),this.userDataSource=i.Users,0===this.userDataSource.length&&this.showErroMsg(this.locale.userFilterLocale.noUsersError),this.groupDataSource=i.Groups,this.fullDataSource=this.userDataSource.concat(this.groupDataSource),this.updateUiOnFieldList(),this.setModel(this.fullDataSource),this.triggerRenderComplete(),e&&(this.mapping(this.mapOption),this.updateSearch())):this.showErroMsg(t.Message)},t.prototype.updateUiOnFieldList=function(){this.invokeCallBackHandler({type:"updateUiFieldList",data:{data:!0}})},t.prototype.showErroMsg=function(e){this.invokeCallBackHandler({type:"updateUiFieldList",data:{data:!1}}),this.wrapper.find("#"+this.id+"_list_box_element_container").hide(),this.wrapper.find("#"+this.id+"_listbox_error_msg").css("display","block"),this.wrapper.find("#"+this.id+"_listbox_error_msg p").html(e),this.wrapper.find("#"+this.id+"_retry_icon_wrapper").show()},t.prototype.triggerRenderComplete=function(){var e,t=new UserInfo;t.IsGroup=this.fullDataSource[0].IsGroup,t.UserId=(this.fullDataSource[0].IsGroup?this.fullDataSource[0].Id:this.fullDataSource[0].Email).toString(),0!==(e=this.userInfoList.filter(function(e){return e.UserId===t.UserId})).length&&(t.IncludeFutureValues=e[0].IncludeFutureValues),this.invokeRenderComplete(t),this.addAllSelectedUser(this.userInfoList)},t.prototype.invokeRenderComplete=function(e){e={type:"renderComplete",data:{userinfo:e,isGroup:e.IsGroup,userId:e.UserId,dataSource:this.fullDataSource}};this.invokeCallBackHandler(e)},t.prototype.onUserGroupListFetchError=function(e){401===e.status?this.showErroMsg(this.locale.errorMessage.authenticationFailed+this.locale.errorMessage.invalidSession):l.isNullOrUndefined(e.responseText)||""===e.responseText?this.showErroMsg(this.locale.errorMessage.errorOnLoadingAccountInfo):this.showErroMsg(e.responseText)},t.prototype.updateUserMapping=function(e,t){switch(e){case"user_mapped":this.mapOption=Mapping.All,this.updatedCheckedItems=this.getRequiredItems(t,!0);break;case"Mapped":this.mapOption=Mapping.Map,this.updatedCheckedItems=this.getRequiredItems(t,!1);break;case"Unmapped":this.mapOption=Mapping.Unmap,this.updatedCheckedItems=this.getRequiredItems(t,!1)}this.mapping(this.mapOption),this.updateSearch()},t.prototype.updateSearch=function(){var e,t=this.ulTag.data("BoldBIDashboardListBox").model.dataSource;0<this.searchText.length&&(e=this.filterItems(t,this.searchText.toLocaleLowerCase()),0===(e=this.updateIndices(e,t)).length?this.showNoMatchError():(this.userGroupListInstance.hideAllItems(),this.ulTag.BoldBIDashboardListBox("showItemsByIndices",e)))},t.prototype.getRequiredItems=function(i,e){var t,a,o,s=[];if(e)s=this.filterNameList(this.fullDataSource);else for(t=function(t){var e=(0<a.fullDataSource.filter(function(e){return e.Id.toString()===i[t].UserId.toString()&&e.IsGroup===i[t].IsGroup}).length?a.fullDataSource.filter(function(e){return e.Id.toString()===i[t].UserId.toString()&&e.IsGroup===i[t].IsGroup}):a.fullDataSource.filter(function(e){return!l.isNullOrUndefined(e.Email)&&e.Email.toString()===i[t].UserId.toString()&&e.IsGroup===i[t].IsGroup}))[0].Name;s.push({text:e})},a=this,o=0;o<i.length;o++)t(o);return s},t.prototype.filterNameList=function(e){for(var t=[],i=0;i<e.length;i++)t.push({text:e[i].Name});return t},t.prototype.showUserAndGroupList=function(){this.wrapper.find("#"+this.id+"_listbox_error_msg").hide(),this.wrapper.find("#"+this.id+"_list_box_wrapper").show()},t.prototype.showMoreMenu=function(e){e.stopPropagation(),(e=this.bbdesigner$(e.target)).closest(".bbi-dbrd-uf-icon-wrapper").css("background-color","#dbe9ff"),e.css({color:"#0565ff",visibility:"visible"}),e.closest("li").css("background-color","#f0f6ff"),e.closest("li").find(".e-chk-act,.e-chk-inact").css("background-color","#f0f6ff"),this.checkSelectedValuesForUser();var t=e.offset(),i=e.closest(".bbi-dbrd-uf-list"),a=e.closest("li").find(".bbi-uf-list-username").text(),o=(this.getCurrentUser(a),l.buildTag("ul.bbi-designer-menu e-aggr-menu","",{width:"160px"},{id:this.id+"_more_menu"})),s=this.wrapper.find(".e-content"),n=l.buildTag("li.e-separator","<a>"+this.locale.userFilterLocale.viewUsermsg+"</a>",{},{id:this.id+"_view_users_li"}),r=l.buildTag("li","<a>"+this.locale.userFilterLocale.clear+"</a>",{},{id:this.id+"_clear_list_li"}),d="true"===i.attr("data-isgroup");d?(o.append("<li class='e-separator'><a>"+this.locale.userFilterLocale.useFilterFrom+"</a></li>"),o.append(n),this.isFilered&&o.append(r),this.groupId=i.attr("data-group-id"),this.groupName=a):(o.append("<li class='e-separator'><a>"+this.locale.userFilterLocale.useFilterFrom+"</a></li>"),this.isFilered&&o.append(r)),null!=this.dashboardDesigner.columnDetails&&"Date"===this.dashboardDesigner.columnDetails.fieldInfo.DataType&&(o.append("<li class='e-separator' id='relative'><a>"+this.locale.userFilterLocale.RelativeDateFilter+"</a></li>"),d?(o.append(n),this.isFilered&&o.append(r),this.groupId=i.attr("data-group-id"),this.groupName=a):this.isFilered&&o.append(r)),this.wrapper.append(o),o.BoldBIDashboardMenu({menuType:l.MenuType.ContextMenu,openOnClick:!1,ontextMenuTarget:"#"+s.attr("id"),click:this.bbdesigner$.proxy(this.onMoreMenuClick,this)}).data("BoldBIDashboardMenu").show(t.left+9,t.top-2,e,{})},t.prototype.getCurrentUser=function(e){for(var t=0;this.fullDataSource.length;t++)if(this.fullDataSource[t][this.listFieldName]===e){this.currentUser=this.fullDataSource[t];break}},t.prototype.onMoreMenuClick=function(e){e.ID===this.id+"_view_users_li"?this.usersInGroupInst.open(this.groupId,this.groupName):e.ID===this.id+"_clear_list_li"?this.clearSelectedUserFilter():(e="relative"===e.ID?{type:"RelativeDateFilter",dataSource:this.fullDataSource}:{type:"useFilterFrom",datasource:this.fullDataSource},this.invokeCallBackHandler(e))},t.prototype.updateCheckedItemsFromDialog=function(){var e=this.ulTag.BoldBIDashboardListBox("getIndexByText",this.currentUser[this.listFieldName]);this.ulTag.BoldBIDashboardListBox("checkItemByIndex",e)},t.prototype.fetchUserGroupList=function(e,t){this.userInfoList=l.isNullOrUndefined(e)?this.userInfoList:e,this.virtualScrolling.PageSize=100,this.requestObj=this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+l.Dashboard.ServiceAPI.getUsersAndGroups,{action:l.DashboardUtil.DesignerAction.GetUsersAndGroups},{fnction:this.bbdesigner$.proxy(this.onUserGroupListFetchSuccess,this,t),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)],errfnction:this.bbdesigner$.proxy(this.onUserGroupListFetchError,this)},!0,!0)},t.prototype.setModel=function(e){this.userGroupListInstance.setModel({dataSource:[]}),this.userGroupListInstance.setModel({dataSource:e,selectedIndex:0}),this.showUserAndGroupList()},t.prototype.initSortWorkerInstance=function(){this.sortHelper=new Worker(this.getScriptPath(function(){self.addEventListener("message",function(e){var t,i=e.data.option,a=e.data.data,o=e.data.optionalArgs,s=e.data.type;if(t=0<a.length?a[0].hasOwnProperty(s):t)switch(i){case"ascending":a.sort(function(e,t){e=e[s].toLowerCase(),t=t[s].toLowerCase();return e<t?-1:t<e?1:0});break;case"descending":a.sort(function(e,t){e=e[s].toLowerCase(),t=t[s].toLowerCase();return t<e?-1:e<t?1:0})}self.postMessage({data:a,optionalArgs:o},null)},!1)}))},t.prototype.sortByAscending=function(){this.setUserAndGroupList(),this.getCheckedData=this.ulTag.BoldBIDashboardListBox("getCheckedItems");var e=SortType.Asc.toString();this.sortHelper.postMessage({option:e,data:this.userList,type:"Name",optionalArgs:"user"}),this.sortHelper.postMessage({option:e,data:this.groupList,type:"Name",optionalArgs:"group"})},t.prototype.sortByDescending=function(){this.setUserAndGroupList(),this.getCheckedData=this.ulTag.BoldBIDashboardListBox("getCheckedItems");var e=SortType.Desc.toString();this.sortHelper.postMessage({option:e,data:this.userList,type:"Name",optionalArgs:"user"}),this.sortHelper.postMessage({option:e,data:this.groupList,type:"Name",optionalArgs:"group"})},t.prototype.sortHelperEventListener=function(){var t,i,a=this,o=[],s=[];this.sortHelper.addEventListener("message",function(e){"user"===e.data.optionalArgs?(o=e.data.data,t=!0):(s=e.data.data,i=!0),t&&i&&(e=[],e=o.concat(s),a.sortedDatasource=e,a.setDataSource(e),a.addAllSelectedUser(a.userInfoList),i=t=!1)},!1)},t.prototype.reset=function(){!l.isNullOrUndefined(this.fullDataSource)&&0<this.fullDataSource.length?(this.userGroupListInstance.model.dataSource=[],this.updatedCheckedItems=[],this.updatedUnCheckedItems=[],this.isInputTextPresents=!1,this.isMappingFirst=!0,this.mapOption=null,this.sortOption=null,this.dataSourceForMapping=[],this.userInfoList=[],this.setModel(this.fullDataSource)):this.wrapper.find("#"+this.id+"_listbox_error_msg").css("display","block")},t.prototype.setUserAndGroupList=function(){this.isInputTextPresents?(this.userList=this.searchUserList,this.groupList=this.searchGroupList):(this.userList=this.userDataSource,this.groupList=this.groupDataSource)},t.prototype.setDataSource=function(e){this.setModel(e),this.showListBoxDiv(),this.updateUserSelectionOnFilter(),l.isNullOrUndefined(this.mapOption)||this.mapping(this.mapOption)},t.prototype.sort=function(e,t){if(0<this.fullDataSource.length)switch(this.userInfoList=t,this.isMappingFirst=!1,this.sortOption=e){case SortType.Asc:this.sortByAscending();break;case SortType.Desc:this.sortByDescending()}},t.prototype.reload=function(e){this.userInfoList=e,this.userGroupListInstance.model.dataSource=[],this.isInputTextPresents=!1,this.setModel(this.dataSourceForMapping),this.sortOption=null,this.fetchUserGroupList(e,!0)},t.prototype.mapping=function(e){if(0<this.fullDataSource.length)switch(this.mapOption=e){case Mapping.Map:this.showMappedItems();break;case Mapping.Unmap:this.showUnMappedItems();break;case Mapping.All:this.showMappedItems()}},t.prototype.getAllNames=function(e){this.mappedDataSource=[];for(var t=0;t<e.length;t++)this.fullDataSource[e[t]]&&this.mappedDataSource.push(this.fullDataSource[e[t]].Name)},t.prototype.showMappedItems=function(){for(var e,t=this.fullDataSource,i=this.updatedCheckedItems,a=[],o=0;o<t.length;o++)for(e=0;e<i.length;e++)t[o][this.listFieldName]===i[e][this.checkedListData]&&a.push(i[e][this.checkedListData]);0<a.length?(this.userGroupListInstance.hideAllItems(),this.userGroupListInstance.showItemsByValues(a),this.mappedDataSource=a,this.showListBoxDiv(),this.selectionOnMapping()):this.showNoMatchError()},t.prototype.getSearchIndexForSelection=function(){for(var e,t=this.ulTag.data("BoldBIDashboardListBox").model.dataSource,i=[],a=0;a<t.length;a++)for(e=0;e<this.mappedDataSource.length;e++)t[a].Name===this.mappedDataSource[e]&&i.push(t[a]);return this.getIndexForSelection(i,this.searchedText)},t.prototype.getIndexForSelection=function(e,t){for(var i,a=[],o=0;o<e.length;o++)for(i=0;i<t.length;i++)e[o].Name===t[i]&&a.push(this.ulTag.BoldBIDashboardListBox("getIndexByText",e[o].Name));return a[0]},t.prototype.selectionOnMapping=function(){var e=0===this.searchText.length?l.isNullOrUndefined(this.sortOption)?this.ulTag.BoldBIDashboardListBox("getIndexByText",this.mappedDataSource[0]):this.getIndexForSelection(this.sortedDatasource,this.mappedDataSource):this.getSearchIndexForSelection();this.userGroupListInstance.selectItemByIndex(e),l.isNullOrUndefined(e)?this.showNoMatchError():this.updateUserSelectionOnFilter()},t.prototype.showUnMappedItems=function(){for(var e,t=this.fullDataSource,i=this.updatedCheckedItems,a=[],o=1,s=0;s<t.length;s++)if((o=0)<i.length)for(e=0;e<i.length;e++)i[e][this.checkedListData]!==t[s][this.listFieldName]&&++o===i.length&&a.push(t[s][this.listFieldName]);else a.push(t[s][this.listFieldName]);0<a.length?(this.userGroupListInstance.hideAllItems(),this.userGroupListInstance.showItemsByValues(a),this.mappedDataSource=a,this.showListBoxDiv(),this.selectionOnMapping()):this.showNoMatchError()},t.prototype.disable=function(){this.userGroupListInstance.disable()},t.prototype.enable=function(){this.userGroupListInstance.enable()},e.UsersAndGroupsListView=t}(BoldBIDashboard=BoldBIDashboard||{}),function(e){e.Map="map",e.Unmap="unmap",e.All="all"}(Mapping=Mapping||{}),function(r){var e;function t(e,t){this.updateDatasouce=[],this.isManualChange=!1,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=(r.isNullOrUndefined(t.attr("id"))?this.dashboardDesigner._id:t.attr("id"))+"_uf_user_preview_dashbrd",this.renderPreviewContainer(t),this.fetchUserList(),this.unwiredEvents(),this.wiredEvents()}e=r.Dashboard||(r.Dashboard={}),t.prototype.renderPreviewContainer=function(e){this.wrapper=r.buildTag("div","",{position:"relative"},{id:this.id+"_wrapper"});var t,i,a=r.buildTag("div.bbi-dbrd-preview-content-container","",{},{id:this.id+"_content_container"}),o=r.buildTag("div.bbi-dbrd-uf-preview-label",this.locale.userFilterLocale.previewAsText),s=r.buildTag("div.bbi-dbrd-input-container","",{},{id:this.id+"_input_container"}),n=r.buildTag("div.bbi-dbrd-dropdowndiv","",{},{});this.inputDropdown=r.buildTag("input.e-dbrd-input-dropdown","",{},{id:this.id+"_input_dropdown"}),t=r.buildTag("div.bbi-dbrd-uf-preview-reload-container bbi-dbrd-designer-hoverable","",{},{"data-tooltip":this.locale.userFilterLocale.relaodPreviewUserGroupText,id:this.id+"_reload_icon"}),i=r.buildTag("span.e-dbrd-banner-user-refresh bbi-dbrd-designer-hand-cursor"),this.loader=r.buildTag("div.bbi-dbrd-file-info-progress","",{"line-height":"90%",display:"none"},{}),i.appendTo(t),n.append(this.inputDropdown),s.append(n),a.append(o,s,t),this.wrapper.append(a,this.loader),e.append(this.wrapper),this.inputDropdown.BoldBIDashboardDropDownList({template:'<span class="bbi-dbrd-uf-user-group-icon e-dashboarddesigner-icon-${IsGroup}"></span><span class="bbi-dbrd-uf-list-text" id='+this.id+"_${Id} isGroup = ${IsGroup} >${Name}</span>",watermarkText:this.locale.userFilterLocale.selectUserGroupText,height:"28px",width:"165px",popupHeight:"250px",popupWidth:"165px",cssClass:"bbi-dbrd-control e-combobox-control bbi-dbrd-uf-previewui",change:this.bbdesigner$.proxy(this.onSelectChange,this)})},t.prototype.previewAsColorChangetoDefault=function(){this.wrapper.find("#"+this.id+"_content_container").css("background-color","var(--secondary-background-color)"),this.wrapper.find("#"+this.id+"_input_dropdown_hidden").attr("style","background-color: none"),this.wrapper.find("#"+this.id+"_input_dropdown_dropdown").attr("style","background-color: none"),this.wrapper.find("#"+this.id+"_input_dropdown_dropdown").find(".e-icon").css("color","var(--active-icon-normal-color)"),this.wrapper.find("#"+this.id+"_input_dropdown_container").attr("style","background-color: none; border-color: var(--designer-primary-border-color)"),this.wrapper.find(".bbi-dbrd-uf-preview-label").css("color","var(--primary-text-normal-color)"),this.bbdesigner$("#"+this.id+"_input_dropdown_popup").css({"background-color":"var(--primary-background-color)",color:"var(--userfilter-text-color)"}),this.wrapper.find("#"+this.id+"_input_dropdown_hidden").find("style").remove(),this.wrapper.find(".bbi-dbrd-uf-previewui").attr("style","background-color: none"),this.wrapper.find(".e-dbrd-banner-user-refresh").css("color",""),this.wrapper.find("#"+this.id+"_reload_icon").removeClass("banner-icon-hover-color-after-bgColor-change");var e=this.bbdesigner$("#"+this.id+"_input_dropdown_popup").find(".e-ul li");e.removeClass("banner-icon-hover-color-after-bgColor-change"),e.removeAttr("style")},t.prototype.previewAsColorChange=function(e,t){this.wrapper.find("#"+this.id+"_content_container").css("background-color",e),this.wrapper.find("#"+this.id+"_input_dropdown_dropdown").attr("style","background-color:"+e+"!important"),this.wrapper.find("#"+this.id+"_input_dropdown_dropdown").find(".e-icon").css("color",t),this.wrapper.find(".bbi-dbrd-uf-preview-label").css("color",t),this.bbdesigner$("#"+this.id+"_input_dropdown_popup").css({"background-color":e,color:t}),this.wrapper.find("#"+this.id+"_input_dropdown_hidden").append("<style>.e-input::placeholder{color: "+t+" !important}</style>"),this.wrapper.find(".bbi-dbrd-uf-previewui").attr("style","background-color:"+e+"!important"),this.wrapper.find("#"+this.id+"_input_dropdown_hidden").attr("style","background-color:"+e+"!important; color: "+t),this.wrapper.find(".e-dbrd-banner-user-refresh").css("color",t),this.wrapper.find("#"+this.id+"_reload_icon").addClass("banner-icon-hover-color-after-bgColor-change"),this.userListStyle()},t.prototype.userListStyle=function(){var e=this.dashboardDesigner.modules.serialization.dashboardPropertyJson.BannerPanelStyle,t=e.BannerBackgroundColor,i=e.BannerForegroundColor;e.EnableBackgroundColor&&e.EnableForegroundColor&&""!=t&&""!=i&&((e=this.bbdesigner$("#"+this.id+"_input_dropdown_popup").find(".e-ul li")).addClass("banner-icon-hover-color-after-bgColor-change"),e.append("<style>.banner-icon-hover-color-after-bgColor-change:hover, .banner-icon-hover-color-after-bgColor-change.e-active {color: "+i+" !important}</style>"),this.wrapper.find("#"+this.id+"_input_dropdown_container").attr("style","background-color:"+t+"!important; border-color: "+i))},t.prototype.onSelectChange=function(e){r.isNullOrUndefined(e)||this.isManualChange?this.isManualChange=!1:(e=this.updateDatasouce[e.itemId],r.isNullOrUndefined(e)||(this.dashboardDesigner.impersonateAccount=new ImpersonateAccount,this.dashboardDesigner.impersonateAccount.Name=e.Name,r.isNullOrUndefined(e.Email)?r.isNullOrUndefined(this.dashboardDesigner.impersonateAccount.IsGroup)||(this.dashboardDesigner.impersonateAccount.IsGroup=!0):this.dashboardDesigner.impersonateAccount.Email=e.Email,this.dashboardDesigner.impersonateAccount.UserId=e.Id,this.dashboardDesigner.updateDashboard()))},t.prototype.wiredEvents=function(){this.wrapper.on("click","#"+this.id+"_reload_icon",this.bbdesigner$.proxy(this.fetchUserList,this))},t.prototype.unwiredEvents=function(){this.wrapper.off("click","#"+this.id+"_reload_icon",this.bbdesigner$.proxy(this.fetchUserList,this))},t.prototype.fetchUserList=function(){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+r.Dashboard.ServiceAPI.getUsersAndGroups,{action:r.DashboardUtil.DesignerAction.GetUsersAndGroups},{fnction:this.bbdesigner$.proxy(this.onFetchUserListSuccess,this),indicator:[this.bbdesigner$.proxy(this.showLoader,this),this.bbdesigner$.proxy(this.hideLoader,this)]},!0,!0)},t.prototype.showLoader=function(){this.loader.show()},t.prototype.hideLoader=function(){this.loader.hide()},t.prototype.onFetchUserListSuccess=function(e){var t;r.isNullOrUndefined(e.Data)||(e=JSON.parse(e.Data),this.updateDatasouce=e.Users.concat(e.Groups),e=this.inputDropdown.data("BoldBIDashboardDropDownList"),r.isNullOrUndefined(e)||(t=e.getSelectedValue(),e.option("dataSource",this.updateDatasouce),r.isNullOrUndefined(t))||""===t||(this.isManualChange=!0,e.selectItemByValue(t)),this.userListStyle())},t.prototype.reset=function(){var e=this.wrapper.find("#"+this.id+"_input_dropdown").data("BoldBIDashboardDropDownList");e&&e.clearText()},e.UserSelectionPreviewMode=t}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e){this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.id=this.dashboardDesigner._id+"_filter_from_dialog",this.createDialog(),this.unWireEvents(),this.wireEvents()}e=l.Dashboard||(l.Dashboard={}),t.prototype.createDialog=function(){this.wrapper=l.buildTag("div","",{},{id:this.id+"_wrapper"});var e=l.buildTag("div","",{},{id:this.id+"_content_container"}),t=l.buildTag("div","",{},{id:this.id+"_user_list"}),i=this.ulElement=l.buildTag("ul.bbi-dbrd-designer-unorder-list","",{},{id:this.id+"_user_list_ulelement"}),a=this.useSelected=l.buildTag("button.bbi-dbrd-designer-selected-btn bbi-dbrd-btn-primary e-dbrd-btn bbi-dbrd-btn-small",this.dashboardDesigner.getLocalizationContent().userFilterLocale.useSelectedText,{},{id:this.id+"_use_selected_btn",type:"button"}),o=l.buildTag("button.bbi-dbrd-designer-cancel-btn bbi-dbrd-btn-secondary e-dbrd-btn bbi-dbrd-btn-small bbi-dbrd-margin-left",this.dashboardDesigner.getLocalizationContent().dialogOptions.cancelButtonText,{},{id:this.id+"_cancel_btn",type:"button"}),s=l.buildTag("div .bbi-dbrd-designer-user-error-msg","<center><p></p></center>",{},{id:this.id+"_content_error_msg"});t.append(i),e.append(t,s),this.wrapper.append(e),this.dialogObj=this.wrapper.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:301,minHeight:193,enableResize:!1,enableModal:!0,showOnInit:!1,showFooter:!0,target:"#"+this.dashboardDesigner._id,title:this.dashboardDesigner.getLocalizationContent().userFilterLocale.useFilterFrom,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(l.DashboardUtil.closeDialog,this),closeIconTooltip:this.dashboardDesigner.getLocalizationContent().dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.listBoxElementInst=this.ulElement.BoldBIDashboardListBox({template:'<span class=\'e-dbrd-uf-ug-tmplt\'><span class="bbi-dbrd-uf-icon e-dashboarddesigner-icon-${IsGroup}"></span><span class="e-list-text"><span class="e-word" user-id = ${Id}>${Name}</span></span></span>',showCheckbox:!0,width:"300px",height:"191px",cssClass:"bbi-dbrd-designer-userfilter",checkChange:this.bbdesigner$.proxy(this.buttonState,this),showRoundedCorner:!1}).data("BoldBIDashboardListBox"),this.dashboardDesigner.element.find("#"+this.id+"_wrapper_foot").append(o,a)},t.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_use_selected_btn",this.bbdesigner$.proxy(this.sendCheckedItems,this)),this.dashboardDesigner.element.on("click",".e-dbrd-uf-ug-tmplt",this.bbdesigner$.proxy(this.onListBoxTemplateClick,this))},t.prototype.onListBoxTemplateClick=function(e){this.bbdesigner$(e.currentTarget).parents("li").trigger("click")},t.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_cancel_btn",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_use_selected_btn",this.bbdesigner$.proxy(this.sendCheckedItems,this)),this.dashboardDesigner.element.off("click",".e-dbrd-uf-ug-tmplt",this.bbdesigner$.proxy(this.onListBoxTemplateClick,this))},t.prototype.open=function(e,t){this.dialogModel=e,this.useSelected.prop("disabled","true"),this.dialogObj.open(),this.data=t,l.isNullOrUndefined(t.datasource)||0===t.datasource.length?(this.wrapper.find("#"+this.id+"_user_list").hide(),this.wrapper.find("#"+this.id+"_content_error_msg").show(),this.wrapper.find("#"+this.id+"_content_error_msg p").html(this.dashboardDesigner.getLocalizationContent().userFilterLocale.useFilterFromErrMsg)):(this.showListBoxDiv(),this.listBoxElementInst.setModel({dataSource:t.datasource}),(e=this.ulElement.data("BoldBIDashboardListBox")).uncheckAll(),e.scrollerObj.refresh(),this.buttonState())},t.prototype.showListBoxDiv=function(){this.wrapper.find("#"+this.id+"_content_error_msg").hide(),this.wrapper.find("#"+this.id+"_user_list").show()},t.prototype.closeDialog=function(){this.dialogObj.close(),this.ulElement.BoldBIDashboardListBox("removeAll")},t.prototype.sendCheckedItems=function(){var e,t,i;if(!l.isNullOrUndefined(this.dialogModel.callBackInstance)&&!l.isNullOrUndefined(this.dialogModel.callBackMethod)&&""!==this.dialogModel.callBackMethod){try{e=this.ulElement.BoldBIDashboardListBox("getCheckedItems"),t=this.getSelectedValues(e),l.isNullOrUndefined(e)||0===e.length||(i={selectedValues:t,arguments:this.dialogModel.optionalArgs},l.DashboardUtil.invokeMethod(this.dialogModel.callBackInstance,this.dialogModel.callBackMethod,[i]))}catch(e){this.dashboardDesigner.designerPanel.logError({Error:e})}this.closeDialog()}},t.prototype.getSelectedValues=function(e){for(var t,i,a,o,s,n,r=[],d=0;d<e.length;d++)t=this.ulElement.BoldBIDashboardListBox("getIndexByText",e[d].value),r.push(t);for(i=this.getDatasourceForSelectedValues(r),a=l.isNullOrUndefined(this.data.currentUserInfo)?[]:this.data.currentUserInfo.SelectedValues,o=this.data.userInfo,s=a,d=0;d<i.length;d++)for(n=0;n<o.length;n++)(o[n].IsGroup===i[d].IsGroup&&o[n].UserId===i[d].Id.toString()||o[n].IsGroup===i[d].IsGroup&&o[n].UserId===i[d].Email)&&(s=s.concat(o[n].SelectedValues));return this.getUniqueValues(s)},t.prototype.getUniqueValues=function(e){for(var t=[],i=0;i<e.length;i++)-1===t.indexOf(e[i])&&t.push(e[i]);return t},t.prototype.buttonState=function(){var e=this.ulElement.BoldBIDashboardListBox("getCheckedItems");l.isNullOrUndefined(e)||0===e.length?this.useSelected.prop("disabled","true"):this.useSelected.removeProp("disabled")},t.prototype.getDatasourceForSelectedValues=function(e){for(var t,i=[],a=0;a<e.length;a++)for(t=0;t<this.data.datasource.length;t++)e[a]===t&&i.push(this.data.datasource[t]);return i},e.UserFilterFromDialog=t}(BoldBIDashboard=BoldBIDashboard||{}),function(p){var i;function e(e,t){this.ejPreviewGrid=null,this.userBasedFilterInfo=new UserBasedFilterInfo,this.isInteraction=!1,this.prevMode=null,this.loader=null,this.locale=null,this.designerInst=e,this.bbdesigner$=this.designerInst.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesignerInst=t,this.id=this.designerInst._id+"_uf_parent_dlg",this.render(),this.wireEvents()}i=p.Dashboard||(p.Dashboard={}),Object.defineProperty(e.prototype,"advModeInst",{get:function(){return p.isNullOrUndefined(this.advModeInstance)&&(this.advModeInstance=new i.UFAdvancedMode(this.designerInst,this.queryDesignerInst,this.wrapper.find("#"+this.id+"_advanced_mode"),this.bbdesigner$.proxy(this.onAdvancedModeEventChange,this))),this.advModeInstance},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"basicModeInst",{get:function(){return p.isNullOrUndefined(this.basicModeInstance)&&(this.basicModeInstance=new i.UFBasicMode(this.designerInst,this.queryDesignerInst,this.wrapper.find("#"+this.id+"_simple_mode"))),this.basicModeInstance},enumerable:!1,configurable:!0}),e.prototype.render=function(){0!==this.designerInst.element.find("#"+this.id+"_configure_panel").length&&(p.DashboardUtil.destroyEjObjects(this.designerInst.element.find("#"+this.id+"_configure_panel")),this.designerInst.element.find("#"+this.id+"_configure_panel").remove(),this.unWireEvents()),this.parentElement=p.buildTag("div.bbi-dbrd-uf-dlg-content-panel","",{},{id:this.id+"_configure_panel"}),this.wrapper=p.buildTag("div","",{height:"99%"},{id:this.id}),this.parentElement.append(this.wrapper),this.previewPanel=p.buildTag("div","",{display:"none"},{id:this.id+"_preview_panel"}),this.parentElement.append(this.previewPanel);var e=p.buildTag("div.bbi-dbrd-uf-dlg-mode-btn-wrapper","",{},{id:this.id+"_header_btn_wrapper"}),t=p.buildTag("div.bbi-dbrd-uf-dlg-splitter","",{},{});this.content=p.buildTag("div","",{"box-sizing":"border-box",height:"93%"},{id:this.id+"_content_wrapper"}),this.wrapper.append(e,t,this.content),this.dialogObj=this.parentElement.BoldBIDashboardDialog({title:this.locale.userFilterLocale.dialogTitle,maxWidth:800,minWidth:800,maxHeight:646,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.designerInst._id,target:"#"+this.designerInst._id,cssClass:"bbi-designer-dialog bbi-designer-format boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.close,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),this.createFooter(),this.createContainersForDiffModes(),this.createHeaderBtnSection(e),this.loader=this.parentElement.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.designerInst.getWaitingPopupTemplate()}).data("BoldBIDashboardWaitingPopup")},e.prototype.createContainersForDiffModes=function(){var e="<div id='"+this.id+"_simple_mode' style='width:100%;'></div><div id='"+this.id+"_advanced_mode'style='width:100%;height:100%;'></div>";this.content.html(e)},e.prototype.onAdvancedModeEventChange=function(e){switch(e.trigger){case"preview":this.renderPreviewData(e);break;case"savebtnstate":this.setSaveBtnState(e.state)}},e.prototype.renderPreviewData=function(e){var t,i,a;if(0===this.previewPanel.find("#"+this.id+"_preview_data_table").length&&(t=p.buildTag("div.bbi-dbrd-uf-adv-preview-wrapper","",{},{id:this.id+"_preview_data_table"}),i=p.buildTag("div","",{border:"1px solid var(--querydesigner-primary-border-color)"},{id:this.id+"_div_previewGrid"}),d=p.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-uf-adv-preview-back-btn","<span></span><span>Back</span>",{},{id:this.id+"_back_btn",type:"button"}),a=p.buildTag("div.bbi-dbrd-uf-adv-preview-info-msg","*"+this.locale.userFilterLocale.previewMaxRecordsText),t.append(d,i,a),this.previewPanel.append(t),this.ejPreviewGrid=i.BoldBIDashboardGrid({allowScrolling:!0,allowResizing:!0,enableRowHover:!1,allowSelection:!1,columnLayout:p.Grid.ColumnLayout.Auto,scrollSettings:{allowVirtualScrolling:!1,virtualScrollMode:p.Grid.VirtualScrollMode.Normal},columns:[{field:"Preview",headerText:"Preview",width:80}]}).data("BoldBIDashboardGrid")),e.data&&e.data.table&&e.data.type){this.wrapper.css("display","none"),this.previewPanel.css("display","block");for(var o=JSON.parse(e.data.table),s=JSON.parse(e.data.type),n=[],r=[],d=this.previewPanel.width(),l=150*s.length>d?150:(d-20)/s.length,h=0;h<s.length;h++)n.push({field:s[h].ID,headerText:s[h].Name+(e.identityColumn===s[h].Name?"("+this.locale.userFilterLocale.identityColumnText+")":""),textAlign:this.getAlignType(s[h].DataType),type:this.getType(s[h].DataType),width:l}),r.push(s[h].ID);for(h=r.length-1;0<=h;h--)(0<o.length&&-1===Object.keys(o[0]).indexOf(r[h])||0===o.length&&!1===s[h].IsVisible)&&n.splice(h,1);0<n.length&&(this.ejPreviewGrid.option("dataSource",[]),this.ejPreviewGrid.setModel({dataSource:o,columns:n}),this.ejPreviewGrid.element.find(".e-table").css("width","100%"),this.ejPreviewGrid.setModel({scrollSettings:{width:778}}),this.ejPreviewGrid.refreshContent()),this.setSaveBtnState(!0)}!p.isNullOrUndefined(e.data.HasError)&&e.data.HasError&&this.designerInst.modules.util.alertDialog(this.locale.alertDialogTitle.dataSet,this.locale.errorMessage.failedToPreviewTable,IconType.errors,AlertType.Alert,!0,e.data.Message)},e.prototype.getAlignType=function(e){return"string"!==e.toLowerCase()&&"boolean"!==e.toLowerCase()&&"date"!==e.toLowerCase()&&("integer"===e.toLowerCase()||"real"===e.toLowerCase())?p.TextAlign.Right:p.TextAlign.Left},e.prototype.getType=function(e){return"string"===e.toLowerCase()||"boolean"===e.toLowerCase()?"string":"integer"===e.toLowerCase()||"real"===e.toLowerCase()?"number":"date"===e.toLowerCase()?"date":"string"},e.prototype.createHeaderBtnSection=function(e){var t=p.buildTag("div","",{},{id:this.id+"_btn_grp"});e.append(t),e={callBackInstance:this,callBackMethod:"onModeSelectionChangeHandler",groupName:"user-filter-modes",triggerOnCodeUpdate:!0,labelPosition:i.LabelPosition.After,dataSource:[{id:this.id+"_simple",label:this.locale.userFilterLocale.manualModeText,value:"manual"},{id:this.id+"_datasource",label:this.locale.userFilterLocale.datasourceModeText,value:"datasource"},{id:this.id+"_query",label:this.locale.userFilterLocale.userFilterQueryModeText,value:"query"}]},this.modeBtnObj=new i.RadioButton(e,t),this.modeBtnObj.updateItemByValue("manual",!0)},e.prototype.createFooter=function(){var e=p.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.saveDatasourceDialog.saveButtonText,{float:"right"},{id:this.id+"_save_btn",type:"button"}),t=p.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.dialogOptions.closeButtonText,{float:"right"},{id:this.id+"_close_btn",type:"button"}),i=p.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small",this.locale.userFilterLocale.resetSettingsBtnText,{},{id:this.id+"_reset_default_btn",type:"button"});this.designerInst.element.find("#"+this.id+"_configure_panel_foot").append(i,t,e)},e.prototype.wireEvents=function(){this.designerInst.element.on("click","#"+this.id+"_close_btn",this.bbdesigner$.proxy(this.close,this)),this.designerInst.element.on("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.save,this)),this.designerInst.element.on("click","#"+this.id+"_back_btn",this.bbdesigner$.proxy(this.onPreviewPanelBackBtnClick,this)),this.designerInst.element.on("click","#"+this.id+"_reset_default_btn",this.bbdesigner$.proxy(this.onResetDefaultBtnClick,this))},e.prototype.unWireEvents=function(){this.designerInst.element.off("click","#"+this.id+"_close_btn",this.bbdesigner$.proxy(this.close,this)),this.designerInst.element.off("click","#"+this.id+"_save_btn",this.bbdesigner$.proxy(this.save,this)),this.designerInst.element.off("click","#"+this.id+"_back_btn",this.bbdesigner$.proxy(this.onPreviewPanelBackBtnClick,this)),this.designerInst.element.off("click","#"+this.id+"_reset_default_btn",this.bbdesigner$.proxy(this.onResetDefaultBtnClick,this))},e.prototype.enableButton=function(e,t){p.DashboardUtil.buttonEnable(e,t)},e.prototype.onModeSelectionChangeHandler=function(e){this.isInteraction&&(e.args.value!==this.prevMode&&(this.basicModeInst.isModified()||this.advModeInst.isModifiled())?this.designerInst.modules.util.alertDialog(this.locale.userFilterLocale.alertDialogTitle,this.locale.userFilterLocale.resetSettingsMsg,IconType.question,AlertType.Confirm,!1,"",{instance:this,method:"changeModeSelection",dataInfo:e}):this.changeModeSelection(!0,e))},e.prototype.changeModeSelection=function(e,t){if(e)switch(this.selectedMode=t.args.value,t.args.value){case"datasource":case"query":this.basicModeInst.resetToDefaultState(),this.basicModeInst.hide(),this.advModeInst.show(null,t.args.value),this.setSaveBtnState(!1);break;case"manual":this.advModeInst.reset(),this.advModeInst.hide(),this.setSaveBtnState(!0),this.basicModeInst.show(),this.basicModeInst.updateUiOnModeSwitch()}else p.isNullOrUndefined(this.selectedMode)||this.modeBtnObj.updateItemByValue(this.selectedMode,!0,!0)},e.prototype.showDialog=function(e){try{if(this.reset(),this.dialogObj.open(),this.isInteraction=!1,p.isNullOrUndefined(e)||p.isNullOrUndefined(e.Mode))this.selectedMode="manual",this.modeBtnObj.updateItemByValue(this.selectedMode,!0,!0),this.advModeInst.hide(),this.basicModeInst.render(),this.setSaveBtnState(!0),this.basicModeInst.show(),this.basicModeInst.updateUiOnShow();else switch((this.userBasedFilterInfo=e).Mode){case UserBasedFilterMode.Advanced:this.advModeInst.isOpen=!0,e.AdvancedFilter.Mode===AdvancedFilterMode.Table?(this.modeBtnObj.updateItemByValue("datasource",!0,!0),this.selectedMode="datasource"):(this.modeBtnObj.updateItemByValue("query",!0,!0),this.selectedMode="query"),this.basicModeInst.hide(),this.advModeInst.show(p.isNullOrUndefined(this.userBasedFilterInfo)?null:this.userBasedFilterInfo.AdvancedFilter,this.selectedMode),this.setSaveBtnState(!1);break;case UserBasedFilterMode.Basic:this.selectedMode="manual",this.modeBtnObj.updateItemByValue(this.selectedMode,!0,!0),this.advModeInst.hide(),this.basicModeInst.render(),this.basicModeInst.show(),this.basicModeInst.updateUiOnShow(),this.setSaveBtnState(!0)}}catch(e){this.designerInst.designerPanel.logError({Error:e.message,Source:e}),this.isInteraction=!0}this.isInteraction=!0},e.prototype.close=function(){p.isNullOrUndefined(this.queryDesignerInst)||this.queryDesignerInst.updateCurrentSessionTime(),this.reset(),this.basicModeInst.resetToDefaultState(),this.advModeInst.reset(),this.basicModeInst.closeFilterWindow(),this.dialogObj.close()},e.prototype.reset=function(){this.previewPanel.hide(),p.isNullOrUndefined(this.ejPreviewGrid)||this.ejPreviewGrid.dataSource([]),this.wrapper.show(),this.setSaveBtnState(!1)},e.prototype.onPreviewPanelBackBtnClick=function(){this.wrapper.css("display","block"),this.previewPanel.css("display","none"),this.advModeInst.resize()},e.prototype.setSaveBtnState=function(e){this.enableButton(this.designerInst.element.find("#"+this.id+"_save_btn"),e)},e.prototype.setResetBtnState=function(e){this.enableButton(this.designerInst.element.find("#"+this.id+"_reset_default_btn"),e)},e.prototype.onResetDefaultBtnClick=function(e){"boolean"==typeof e?e&&(this.setSaveBtnState(!0),p.isNullOrUndefined(this.selectedMode)||"datasource"!==this.selectedMode&&"query"!==this.selectedMode?this.basicModeInst.onResetToDefault():(this.advModeInst.reset(),this.advModeInst.hideElement(!0))):this.designerInst.modules.util.alertDialog(this.locale.alertDialogTitle.dashboardDesigner,this.locale.userFilterLocale.resetSettingsMsg,IconType.question,AlertType.Confirm,!1,"",{instance:this,method:"onResetDefaultBtnClick"})},e.prototype.save=function(){p.isNullOrUndefined(this.queryDesignerInst)||this.queryDesignerInst.updateCurrentSessionTime(),this.userBasedFilterInfo=p.isNullOrUndefined(this.selectedMode)||"datasource"!==this.selectedMode&&"query"!==this.selectedMode?this.basicModeInst.getBasicFilterInfo():this.advModeInst.getAdvancedFilterInfo(),this.designerInst.modules.util.doAjaxPost("POST",this.designerInst.model.serviceUrl+p.Dashboard.ServiceAPI.saveUserFilter,{action:p.DashboardUtil.DesignerAction.SaveUserFilter,data:JSON.stringify({dataSourceId:this.queryDesignerInst.dataset.Id,UserBasedFilterInfo:this.userBasedFilterInfo})},{fnction:this.bbdesigner$.proxy(this.onFiltersSave,this),indicator:[this.bbdesigner$.proxy(this.showSaveLoader,this),this.bbdesigner$.proxy(this.hideSaveLoader,this)]})},e.prototype.onFiltersSave=function(e){e.Status&&(this.queryDesignerInst.userBasedFilterInfo=this.queryDesignerInst.dataset.UserBasedFilterInfo=this.userBasedFilterInfo,this.basicModeInst.closeFilterWindow(),this.dialogObj.close())},e.prototype.showSaveLoader=function(){this.setSaveBtnState(!1),this.setResetBtnState(!1),this.loader.show()},e.prototype.hideSaveLoader=function(){this.setSaveBtnState(!0),this.setResetBtnState(!0),this.loader.hide()},i.UserBasedFilterDialog=e}(BoldBIDashboard=BoldBIDashboard||{}),InternalQueryFilter=function(){function e(e){this.selectionType=null,this.parameterName=null,this.endParameterName=null,this.myDictionary={},this.attributeName=null,this.attributeValue=null,this.isValueUpdated=!1,this.queryFilters=[],this.dataFields=[],this.parameters=[],this.parameterList=[],this.paramNameList=[],this.customAttributesList=[],this.rootNode=null,this.parentDiv=null,this.containerDiv=null,this.dateTimeFormats=[],this.dateTimeformatforTopN=[],this.dimensionFormats=[],this.measureFormats=[],this.modeTypes=[],this.operatorTypes=[],this.dashboardDesigner=null,this.locale=null,this.fieldItem=null,this.ejIndicator=null,this.okBtn=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.dateRangePopup=this.dashboardDesigner.modules.dateRangePopup,this.multiSelectionComboBox=new BoldBIDashboard.DashboardDesignerUtility.MultiSelectionComboBox(this.dashboardDesigner),this.setItemDataSource(),this.id=this.queryDesigner.id,this.renderQueryFilterDialog()}return e.prototype.renderQueryFilterDialog=function(){var e=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect bbi-designer-query-dialog","",{height:"auto","border-left":"none"},{title:this.locale.initialFilter.dialogTitle,id:this.id+"_query_filter_dialog"}),t=BoldBIDashboard.buildTag("div","",{},{}),i=BoldBIDashboard.buildTag("table","",{width:"97%","border-bottom":"1px solid var(--querydesigner-primary-border-color)",margin:"0.5em 12px","padding-bottom":"5px"},{}),a=BoldBIDashboard.buildTag("tr","",{"padding-top":"10px"},{}),o=BoldBIDashboard.buildTag("td","",{width:"500px"},{}),s=BoldBIDashboard.buildTag("Label.bbi-designer-add-label",this.locale.initialFilter.tableFilters,{},{type:"label"}),n=BoldBIDashboard.buildTag("td","",{},{}),r=BoldBIDashboard.buildTag("div","",{cursor:"pointer",float:"right"},{}),d=BoldBIDashboard.buildTag("span.e-chk-image e-icon e-plus bbi-designer-add-icon e-query-filter-add-icon","",{cursor:"pointer","margin-top":"1px"},{id:this.id+"_query_filter_add"}),l=BoldBIDashboard.buildTag("span.e-btntxt bbi-designer-add-btn",this.locale.initialFilter.addBtnText,{},{}),h=this.parentDiv=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{width:"907px",padding:"5px 10px",height:"310px",position:"relative","padding-left":"12px"},{id:this.id+"_query_parentContainer"}),p=this.containerDiv=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_query_container_div"}),c=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_query_btn_cancel",type:"button"});this.okBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_query_btn_ok",type:"button"}),e.append(t),t.append(i),i.append(a),a.append(o),o.append(s),a.append(n),n.append(r),r.append(d),r.append(l),e.append(h),h.append(p),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({minWidth:908,minHeight:395,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,beforeClose:this.bbdesigner$.proxy(this.closePopup,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),e.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.rootNode=this.dashboardDesigner.element.find("#"+this.id+"_query_filter_dialog_wrapper"),this.rootNode.find("#"+this.id+"_query_filter_dialog_foot").append(c).append(this.okBtn),this.okBtn.on("click",this.bbdesigner$.proxy(this.saveQueryFilter,this,!0)),c.on("click",this.bbdesigner$.proxy(this.closeDialog,this,!0)),r.on("click",this.bbdesigner$.proxy(this.addQueryFilter,this)),h.BoldBIDashboardScroller({height:"310px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},e.prototype.UpdateParameterInInitialFilter=function(e,t){var i;BoldBIDashboard.isNullOrUndefined(e)||(i=null,BoldBIDashboard.isNullOrUndefined(e.DimensionFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.DimensionFilterSchemaInfo.ColumnId)||(i=e.DimensionFilterSchemaInfo.DimensionFilterCondition),BoldBIDashboard.isNullOrUndefined(e.MeasureFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.MeasureFilterSchemaInfo.ColumnId)||(i=e.MeasureFilterSchemaInfo.MeasureFilterCondition),BoldBIDashboard.isNullOrUndefined(e.DateFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.DateFilterSchemaInfo.ColumnId)||(i=e.DateFilterSchemaInfo.DateAndTimeFormatCondition),BoldBIDashboard.isNullOrUndefined(e.ParameterInfo))||this.SetParameterDropDownValues(e.ParameterInfo.IsParamApplied,e.ParameterInfo.ParameterName,e.ParameterInfo.EndParameterName,t,i,e.ParameterInfo.RangeValueOfFirstParam,e.ParameterInfo.RangeValueOfSecondtParam)},e.prototype.UpdateAttributeInInitialFilter=function(e,t){var i;BoldBIDashboard.isNullOrUndefined(e)||(i=null,BoldBIDashboard.isNullOrUndefined(e.DimensionFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.DimensionFilterSchemaInfo.ColumnId)||(i=e.DimensionFilterSchemaInfo.DimensionFilterCondition),BoldBIDashboard.isNullOrUndefined(e.MeasureFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.MeasureFilterSchemaInfo.ColumnId)||(i=e.MeasureFilterSchemaInfo.MeasureFilterCondition),BoldBIDashboard.isNullOrUndefined(e.DateFilterSchemaInfo)||BoldBIDashboard.isNullOrUndefined(e.DateFilterSchemaInfo.ColumnId)||(i=e.DateFilterSchemaInfo.DateAndTimeFormatCondition),BoldBIDashboard.isNullOrUndefined(e.CustomAttributeInfo))||this.SetAttributeDropDownValues(e.CustomAttributeInfo.IsAttributeApplied,e.CustomAttributeInfo.CustomAttributeName,e.CustomAttributeInfo.AttributeEndName,t,i,e.ParameterInfo.IsParamApplied)},e.prototype.SetParameterDropDownValues=function(e,t,i,a,o,s,n){t=this.getParameterNameFromID(t,s),i=this.getParameterNameFromID(i,n),this.myDictionary[a+"_isParamApplied"]=e,this.myDictionary[a+"_parameterName"]=t,this.myDictionary[a+"_endParameterName"]=i,this.myDictionary[a+"_operator"]=o,this.myDictionary[a+"_selectionType"]=e?"Parameters":"Custom"},e.prototype.SetAttributeDropDownValues=function(e,t,i,a,o,s){this.myDictionary[a+"_isAttributeApplied"]=e,this.myDictionary[a+"_customAttributeName"]=t,this.myDictionary[a+"_AttributeEndName"]=i,this.myDictionary[a+"_attroperator"]=o,this.myDictionary[a+"_selectionType"]=e?"Custom Attributes":s?"Parameters":"Custom"},e.prototype.getParameterNameFromID=function(t,e){var i;if(void 0===e&&(e=""),!BoldBIDashboard.isNullOrUndefined(t)){if(!/^[{(]?[0-9A-Fa-f]{8}[-]?(?:[0-9A-Fa-f]{4}[-]?){3}[0-9A-Fa-f]{12}[)}]?$/.test(t))return t;if(0<this.parameterList.length)return 2==(i=this.parameterList.filter(function(e){return e.parameterID===t})).length?(/.START/.test(e)?i[0]:i[1]).value:0<i.length?i[0].value:t}return t},e.prototype.getParameterIDFromName=function(t){var e;return 0<this.parameterList.length&&0<(e=this.parameterList.filter(function(e){return e.value===t})).length?e[0].parameterID:t},e.prototype.renderQueryFilterRow=function(e){var t,i,a,o,s=BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.rowId)?BoldBIDashboard.getGuid(this.id+"_row_"):e.rowId,n=!(!e||!e.Name),r=this.getCurrentIndex(),d=(this.UpdateParameterInInitialFilter(e,s),this.UpdateAttributeInInitialFilter(e,s),this.containerDiv.find(".bbi-designer-query-row").length),l=BoldBIDashboard.buildTag("div.bbi-designer-query-row","",{padding:0<d?"0px 10px":"6px 10px 14px 10px"},{id:s,rowId:s}),h=BoldBIDashboard.buildTag("table.bbi-designer-table-dialog","",{width:"100%",top:0<d?"-13px":"",position:0<d?"relative":"",padding:"5px 0px",border:"0.5px solid var(--querydesigner-primary-border-color)"},{id:s+"_query_container_table"}),p=BoldBIDashboard.buildTag("tr","",{},{}),c=BoldBIDashboard.buildTag("tr","",{},{}),u=BoldBIDashboard.buildTag("td","",{"padding-left":"0px"},{id:s+"_query_container_cell"}),b=BoldBIDashboard.buildTag("td","",{width:"20px","padding-left":"12px"},{}),g=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:s+"_query_filter_field"}),m=BoldBIDashboard.buildTag("td","",{"padding-top":"3px",width:"20px","padding-right":"7px"},{id:s+"_query_error_td"}),f=(this.dashboardDesigner.modules.util.renderErrIndictor(m,this.id),BoldBIDashboard.buildTag("td","",{"padding-right":"10px","padding-top":"0px"},{})),D=BoldBIDashboard.buildTag("span.bbi-drbd-close-icon bbi-dbrd-designer-hoverable","",{cursor:"pointer","font-size":"10px"},{id:s+"_query_delete_icon","data-tooltip":"Delete"}),y=BoldBIDashboard.buildTag("tr","",{display:"none"},{id:s+"_tr_top"}),B=BoldBIDashboard.buildTag("td","",{height:"4px"},{id:s+"_td_top",colspan:"4"}),I=BoldBIDashboard.buildTag("div","",{margin:"4px 0px",height:"auto",width:"100%"},{id:s+"_queryFilter_topDiv"});return this.containerDiv.append(l),0<d&&(d=BoldBIDashboard.buildTag("td","",{},{id:s+"_query_empty_cell"}),i=BoldBIDashboard.buildTag("div","",{height:"10px"},{}),d.append(i),p.append(d),h.append(p),i=BoldBIDashboard.buildTag("div","",{position:"relative","padding-left":"14px","z-index":1},{id:s+"_query_operator_type_div"}),d=BoldBIDashboard.buildTag("input","",{},{type:"text",id:s+"_query_operator_type"}),i.append(d),l.append(i),d.BoldBIDashboardDropDownList({width:"130px",height:"26px",dataSource:this.operatorTypes,fields:{text:"text",value:"value"},enabled:!0,selectedIndex:1,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control bbi-background"})),l.append(h),h.append(c),c.append(b),b.append(g),c.append(u),c.append(m),c.append(f),f.append(D),h.append(y),y.append(B),B.append(I),g.BoldBIDashboardDropDownList({width:"130px",height:"26px",minPopupWidth:"130px",maxPopupWidth:"600px",dataSource:this.dataFields,fields:{text:"text",value:"value"},enabled:!0,enableFilterSearch:!0,change:this.bbdesigner$.proxy(this.onDropDownChange,this,s,this.dataFields),selectedIndex:r,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),D.bind("click",this.bbdesigner$.proxy(this.deleteQueryFilter,this,l)),n&&(t=this.getFieldText(e.Id,e.TableName,e.Schema),this.getDrpDwn1(s).data("BoldBIDashboardDropDownList").selectItemByText(t)),0<this.dataFields.length&&(p=this.getDrpDwn1(s).data("BoldBIDashboardDropDownList").getSelectedItem(),t=this.bbdesigner$(p).text(),a=(i=this.getSelectedValue(t)).typeName,o=i.typeCast),a=BoldBIDashboard.isNullOrUndefined(o)||0===o.length||this.isDefaultCast(o)?a:o,this.renderInputField(a,s,u),this.scrollerRefresh(this.parentDiv),s},e.prototype.renderCheckboxItem=function(e,t,i){var a=BoldBIDashboard.buildTag("td","",{align:"left",width:"false"===e.toLowerCase()?"67px":"98px","padding-left":"13px",height:"27px"});i.append(a),i=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:t}),a.append(i),e=BoldBIDashboard.buildTag("label.bbi-designer-fontfamily",e,{"margin-left":"15px","font-size":"13px"},{id:t,for:t}),a.append(e),i.BoldBIDashboardCheckBox({cssClass:"bbi-designer-param-assign"})},e.prototype.renderBoolFields=function(e,t){var i,a=BoldBIDashboard.buildTag("table","",{width:"100%","background-color":"#F9F9F9","padding-bottom":"3px","padding-top":"3px"},{}),o=BoldBIDashboard.buildTag("tr","",{},{});this.renderCheckboxItem("Null",e+"_query_bool_chkbx1",o),this.renderCheckboxItem("True",e+"_query_bool_chkbx2",o),this.renderCheckboxItem("False",e+"_query_bool_chkbx3",o),i=BoldBIDashboard.buildTag("td","",{width:"113px","padding-left":"26px"}),this.renderCodeSwitcher(e,i,QueryDatatype.Bool.toString()),this.renderTopFields(e,QueryDatatype.Bool.toString()),this.rootNode.find("#"+e+"_query_bool_topLable").css({"margin-top":"7px"}),this.rootNode.find("#"+e+"_query_bool_chkSwitcher").css({"margin-top":"2px"}),t.append(a),a.append(o),o.append(i)},e.prototype.renderInputField=function(e,t,i){BoldBIDashboard.isNullOrUndefined(e)||(this.isNumber(e)?this.renderFields(t,i,e,QueryDatatype.Int.toString()):this.isString(e)?this.renderFields(t,i,e,QueryDatatype.Char.toString()):this.isBoolean(e)?this.renderBoolFields(t,i):this.isDate(e)&&this.renderFields(t,i,e,QueryDatatype.Date.toString()))},e.prototype.renderDateFields=function(e,t,i,a){var o,s=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").getSelectedItem(),s=this.bbdesigner$(s).text(),n=(this.selectionType=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_selectionType"])?"Custom":this.myDictionary[e+"_selectionType"],this.parameterName=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_parameterName"])?"":this.myDictionary[e+"_parameterName"],this.endParameterName=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_endParameterName"])?"":this.myDictionary[e+"_endParameterName"],BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_operator"])?this.getOperatorDrpDwn(e,a).data("BoldBIDashboardDropDownList").getSelectedValue():this.myDictionary[e+"_operator"]),r=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").getSelectedValue(),d=BoldBIDashboard.buildTag("td","",{"padding-left":"10px"},{id:e+"_query_date_pickcol"}),l=BoldBIDashboard.buildTag("td","",{width:"122px","padding-left":"26px"},{id:e+"_query_"+a+"_switcher"}),h=BoldBIDashboard.buildTag("td","",{"padding-left":"10px",width:"10px",display:"date"===n.toLowerCase()?"table-cell":"none"},{id:e+"_query_"+a+"_txtcol_param"});this.renderCodeSwitcher(e,l,a),this.renderTopFields(e,a),t.append(h),this.renderDropDownForParameter(e,a,h,t),t.append(d),h=BoldBIDashboard.buildTag("div","",{width:"144px",height:"100%"},{id:e+"_query_date_picker_div"}),d.append(h),this.multiSelectionComboBox.renderMultiSelectionComboBox(h,e,this.queryDesigner.dataset.Id),this.multiSelectionComboBox.getMultiSelectionComboBox(e).attr({"data-fieldValue":r,"data-fieldText":s,"data-dateFormat":this.getOperatorDrpDwn(e,a).data("BoldBIDashboardDropDownList").getSelectedValue()}),this.dateRangePopup.renderDateRangeDrpDwn(e,d,this.queryDesigner.dataset.Id,{Id:r,Name:s},null,"QueryFilter"),t.append(l),this.getTxtColTag1(e,a).css("display","none"),o=BoldBIDashboard.isNullOrUndefined(this.getOperatorDrpDwn(e,"date").data("BoldBIDashboardDropDownList"))?"":this.getOperatorDrpDwn(e,"date").data("BoldBIDashboardDropDownList").getSelectedValue(),"Date"===n?"Custom Attributes"!=this.selectionType&&this.populateDateRangeParameterValues(e,a,o):this.dateTimeFormats.some(function(e){return e.value===o})&&this.populateDateFormatParameterValues(e,a,o)},e.prototype.renderStringFields=function(e,t,i,a){var o,s=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").getSelectedItem(),s=this.bbdesigner$(s).text(),n=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").getSelectedValue(),r=this.getOperatorDrpDwn(e,a).data("BoldBIDashboardDropDownList").model.value.toLowerCase(),d=BoldBIDashboard.buildTag("td","",{"padding-left":"10px"},{id:e+"_query_"+a+"_txtcol1"}),l=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox-border","",{"padding-left":"9px",height:"22px",width:"134px",display:"inclusion"===r?"none":"block"},{type:"text",id:e+"_query_"+a+"_txtVal1"}),h=BoldBIDashboard.buildTag("td","",{"padding-left":"10px",width:"10px"},{id:e+"_query_"+a+"_txtcol_param"}),p=BoldBIDashboard.buildTag("td","",{"padding-left":"10px",display:"none"},{id:e+"_query_"+a+"_txtcol2"}),c=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox-border","",{height:"22px",display:"none"},{type:"text",id:e+"_query_"+a+"_txtVal2"}),u=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox-border","",{height:"22px",width:"134px",display:"none"},{type:"text",readonly:"readonly",id:e+"_query_null_txt",value:"null"}),b=BoldBIDashboard.buildTag("td","",{width:"122px","padding-left":"26px"},{id:e+"_query_"+a+"_switcher"});a!==QueryDatatype.Date.toString()&&(this.selectionType=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_selectionType"])?"Custom":this.myDictionary[e+"_selectionType"],this.parameterName=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_parameterName"])?"":this.myDictionary[e+"_parameterName"],this.endParameterName=BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_endParameterName"])?"":this.myDictionary[e+"_endParameterName"],t.append(h),this.renderDropDownForParameter(e,a,h,t)),t.append(d),d.append(l),a!==QueryDatatype.Char.toString()&&a!==QueryDatatype.Date.toString()||(h=BoldBIDashboard.buildTag("div","",{width:"144px",height:"100%"},{}),d.append(h),this.multiSelectionComboBox.renderMultiSelectionComboBox(h,e,this.queryDesigner.dataset.Id),h=this.multiSelectionComboBox.getMultiSelectionComboBox(e),o=null,a===QueryDatatype.Date.toString()&&(o=this.getOperatorDrpDwn(e,a).data("BoldBIDashboardDropDownList").getSelectedValue()),h.attr({"data-fieldValue":n,"data-fieldText":s,"data-dateFormat":o}),h.css("display","inclusion"===r?"block":"none")),c.val(a!==QueryDatatype.Char.toString()?"0":""),l.val(a!==QueryDatatype.Char.toString()?"0":""),t.append(p),p.append(c),a===QueryDatatype.Char.toString()&&(t.append(b),this.renderCodeSwitcher(e,b,a),this.renderTopFields(e,a)),a===QueryDatatype.Int.toString()&&(d.append(u),this.renderNullField(e,t)),"System.Double"!==i&&"number"!==i.toLowerCase()&&"System.Single"!==i&&"System.Decimal"!==i||(c.val(a!==QueryDatatype.Char.toString()?"0.00":""),l.val(a!==QueryDatatype.Char.toString()?"0.00":"")),a===QueryDatatype.Int.toString()&&("in"!==r&&(l.bind("keypress",this.bbdesigner$.proxy(this.validateTxtBox,this,l,i)),c.bind("keypress",this.bbdesigner$.proxy(this.validateTxtBox,this,c,i))),l.bind("focusin",this.bbdesigner$.proxy(this.textFocus,this,l,"focusin",i)),l.bind("focusout",this.bbdesigner$.proxy(this.textFocus,this,l,"focusout",i)),c.bind("focusin",this.bbdesigner$.proxy(this.textFocus,this,c,"focusin",i)),c.bind("focusout",this.bbdesigner$.proxy(this.textFocus,this,c,"focusout",i)),l.css({"text-align":"right","padding-right":"10px","padding-left":"0px"}),c.css({"text-align":"right","padding-right":"10px","padding-left":"0px"}),u.css({"text-align":"right","padding-right":"10px","padding-left":"0px"})),this.populateParameterValues(e,a,r)},e.prototype.populateDateRangeParameterValues=function(e,t,i){var a,o,s;"date"===t.toLowerCase()&&(this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isParamApplied"])||!this.myDictionary[e+"_isParamApplied"]?this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isAttributeApplied"])||!this.myDictionary[e+"_isAttributeApplied"]?this.setDefaultValues(e,t,i):(this.attributeName=this.myDictionary[e+"_customAttributeName"],i=this.getParameterDropDown(e,t),(o=this.getAttributeDropDownSelectionValue(e)).data("AttributeInfo",{Name:this.attributeName}),o.data("selectedType",this.selectionType),this.getTxtColTag1(e,t).css("display","none"),i.css("display","none"),o=this.myDictionary[e+"_AttributeEndName"],"Date"!=(i=this.myDictionary[e+"_attroperator"])?(null!=this.attributeName&&(this.fieldItem=this.getSelectedAttributeValue(this.attributeName)),a=BoldBIDashboard.buildTag("input.e-textbox",this.attributeName,{},{type:"text",id:e+"_attribute"}),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param").append(a),this.dropDownList=a.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:"150px",fields:{text:"text",value:"value"},value:this.attributeName,dataSource:this.customAttributesList,watermarkText:this.attributeName,selectedIndex:this.fieldItem,enabled:!0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.setAttributeValueInfo,this,e,t)}).data("BoldBIDashboardDropDownList"),this.attributeRetainEvent(e,t,this.myDictionary),this.dashboardDesigner.element.find("#"+e+"_query_date_pickcol").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_switcher").css("padding-left","300px")):"Date"==i&&(a=this.getStartAttrDropDownSelectionValue(e),i=this.getEndAttrDropDownSelectionValue(e),a.css("display","-webkit-box"),i.css("display","-webkit-box"),this.setDataForAttrDate(e,this.attributeName,o,this.selectionType),this.dashboardDesigner.element.find("#"+e+"_query_date_pickcol").css("display","table-cell"),this.dashboardDesigner.element.find("#"+e+"_query_date_pickcol").css("padding-left","130px"),this.dashboardDesigner.element.find("#"+e+"_dateRange_Start").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_dateRange_end").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_switcher").css("padding-left","100px")),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param").css("display","-webkit-box"),this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").css("padding-left","10px"),this.dashboardDesigner.element.find("#"+e+"_attribute").css("display","none")):(a=this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param"),i=this.getStartParamDropDownSelectionValue(e),o=this.getEndParamDropDownSelectionValue(e),t=this.dashboardDesigner.element.find("#"+e+"_dateRange_Start"),s=this.dashboardDesigner.element.find("#"+e+"_dateRange_end"),a.css("display","table-cell"),i.css("display","table-cell"),o.css("display","table-cell"),t.css("display","none"),s.css("display","none"),this.setDataForDateDropdowns(e,this.parameterName,this.endParameterName,this.selectionType))),this.isValueUpdated=!1},e.prototype.populateDateFormatParameterValues=function(e,t,i){var a,o=this.getParamDropDownSelectionValue(e);"date"===t.toLowerCase()&&(this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isParamApplied"])||!this.myDictionary[e+"_isParamApplied"]?this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isAttributeApplied"])||!this.myDictionary[e+"_isAttributeApplied"]?this.setDefaultValues(e,t,i):(i=this.getAttributeDropDown(e),this.getDateColumnTag(e).css("display","none"),a={Name:this.attributeName,Value:this.attributeValue},i.data("AttributeInfos",a)):(i=this.getParameterDropDown(e,t),this.getDateColumnTag(e).css("display","none"),i.css("display","table-cell"),o.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(this.parameterName)?null:{Name:this.parameterName,Id:this.getParameterIDFromName(this.parameterName)}),this.setDataForParamDropDown(e,this.parameterName,this.selectionType,t))),this.isValueUpdated=!1},e.prototype.setDataForParamDropDown=function(e,t,i,a){var o=this.getParamDropDownSelectionValue(e),a=this.getParameterDropDown(e,a),s=this.getParameterValue(e);o.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(t)?null:{Name:t,Id:this.getParameterIDFromName(t)}),this.parameterName=this.checkValidParameterOrNot(t,this.parameterList,e),BoldBIDashboard.isNullOrUndefined(a.data("BoldBIDashboardDropDownList"))||s.data("BoldBIDashboardDropDownList").setModel({value:t}),BoldBIDashboard.isNullOrUndefined(o.data("BoldBIDashboardDropDownList"))||o.data("BoldBIDashboardDropDownList").setModel({value:i})},e.prototype.setDataForAttrDropDown=function(e){var e=this.getAttributeDropDownSelectionValue(e),t={Name:this.attributeName,Value:this.attributeValue};e.data("AttributeInfos",t)},e.prototype.setDataForDateDropdowns=function(e,t,i,a){var o=this.dateRangePopup.renderDateRangePopup(e),o=(this.dateRangePopup.updateParameterListInfo(this.parameterList),BoldBIDashboard.isNullOrUndefined(o)?this.dashboardDesigner.element:o),s=this.getParamDropDownSelectionValue(e),n=o.find("#"+e+"_date_Start_param"),o=o.find("#"+e+"_date_End_param");s.data("selectedType",a),n.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(t)?null:{Name:t,Id:this.getParameterIDFromName(t)}),o.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(i)?null:{Name:i,Id:this.getParameterIDFromName(i)}),this.parameterName=this.checkValidParameterOrNot(t,this.parameterList,e),this.endParameterName=this.checkValidParameterOrNot(i,this.parameterList,e),BoldBIDashboard.isNullOrUndefined(n.data("BoldBIDashboardDropDownList"))||n.data("BoldBIDashboardDropDownList").setModel({value:t}),BoldBIDashboard.isNullOrUndefined(o.data("BoldBIDashboardDropDownList"))||o.data("BoldBIDashboardDropDownList").setModel({value:i}),BoldBIDashboard.isNullOrUndefined(s.data("BoldBIDashboardDropDownList"))||s.data("BoldBIDashboardDropDownList").setModel({value:a})},e.prototype.setDataForAttrDate=function(e,t,i,a){var o,s,n=this.dateRangePopup.renderDateRangePopup(e),n=(this.dateRangePopup.updateParameterListInfo(this.customAttributesList),BoldBIDashboard.isNullOrUndefined(n)?this.dashboardDesigner.element:n),r=this.getAttributeDropDownSelectionValue(e),d=n.find("#"+e+"_date_Start_attr"),n=n.find("#"+e+"_date_End_attr");r.data("selectedType",a),e=this.myDictionary[e+"_AttributeEndValue"],d.data("AttributeInfos",BoldBIDashboard.isNullOrUndefined(t)?null:{Name:t}),n.data("AttributeInfos",BoldBIDashboard.isNullOrUndefined(i)?null:{Name:i,Value:e}),null!=t&&(o=this.getSelectedAttributeValue(t)),null!=i&&(s=this.getSelectedAttributeValue(i)),BoldBIDashboard.isNullOrUndefined(d.data("BoldBIDashboardDropDownList"))||d.data("BoldBIDashboardDropDownList").setModel({datasource:this.customAttributesList,value:t,selectedIndex:o}),BoldBIDashboard.isNullOrUndefined(n.data("BoldBIDashboardDropDownList"))||n.data("BoldBIDashboardDropDownList").setModel({datasource:this.customAttributesList,value:i,selectedIndex:s}),BoldBIDashboard.isNullOrUndefined(r.data("BoldBIDashboardDropDownList"))||r.data("BoldBIDashboardDropDownList").setModel({datasource:this.customAttributesList,value:a})},e.prototype.populateParameterValues=function(e,t,i){var a,o,s=this.getParameterDropDown(e,t),n=this.getParameterBtwDropDown(e,t),i=(this.getAttributeDropDown(e),BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_operator"])?i:this.myDictionary[e+"_operator"]);this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isParamApplied"])||!this.myDictionary[e+"_isParamApplied"]?this.isValueUpdated||BoldBIDashboard.isNullOrUndefined(this.myDictionary[e+"_isAttributeApplied"])||!this.myDictionary[e+"_isAttributeApplied"]?this.setDefaultValues(e,t,i):(this.attributeName=this.myDictionary[e+"_customAttributeName"],(o=this.getAttributeDropDownSelectionValue(e)).data("AttributeInfo",{Name:this.attributeName}),o.data("selectedType",this.selectionType),this.getTxtColTag1(e,t).css("display","none"),s.css("display","none"),null!=this.attributeName&&(this.fieldItem=this.getSelectedAttributeValue(this.attributeName)),o=BoldBIDashboard.buildTag("input.e-textbox",this.attributeName,{},{type:"text",id:e+"_attribute"}),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param").append(o),this.dropDownList=o.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:"150px",fields:{text:"text",value:"value"},value:this.attributeName,dataSource:this.customAttributesList,watermarkText:this.attributeName,selectedIndex:this.fieldItem,enabled:!0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.setAttributeValueInfo,this,e,t)}).data("BoldBIDashboardDropDownList"),this.attributeRetainEvent(e,t,this.myDictionary),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param").css("display","-webkit-box"),this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").css("padding-left","10px"),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_switcher").css("padding-left","300px")):(o=this.getParamDropDownSelectionValue(e),a=this.getParamBtwDropDownSelectionValue(e),o.data("ParameterInfos",{Name:this.parameterName,Id:this.getParameterIDFromName(this.parameterName)}),o.data("selectedType",this.selectionType),this.getTxtColTag1(e,t).css("display","none"),s.css("display","table-cell"),t.toLowerCase()!==QueryDatatype.Int.toString()||i.toLowerCase()!==QueryOperator.Between.toString()&&i.toLowerCase()!==QueryOperator.NotBetween.toString()||(n.css("display","table-cell"),this.getTxtColTag2(e,t).css("display","none"),a.data("ParameterInfos",{Name:this.endParameterName,Id:this.getParameterIDFromName(this.endParameterName)}))),this.isValueUpdated=!1},e.prototype.setDefaultValues=function(e,t,i){var a=this.getParameterDropDown(e,t),o=this.getParameterBtwDropDown(e,t),s=this.getParamDropDownSelectionValue(e),n=this.getParamBtwDropDownSelectionValue(e),r=this.getParameterValue(e);s.data("ParameterInfos",null),s.data("selectedType","Custom"),a.css("display","none"),o.next("td").css("display","table-cell"),this.getTxtColTag1(e,t).css("display","table-cell"),this.isString(t)||t.toLowerCase()===QueryDatatype.Int.toString()?(s.data("BoldBIDashboardDropDownList").setModel({value:"Custom"}),n.data("BoldBIDashboardDropDownList").setModel({value:null}),r.data("BoldBIDashboardDropDownList").setModel({value:null}),t.toLowerCase()!==QueryDatatype.Int.toString()||i.toLowerCase()!==QueryOperator.Between.toString()&&i.toLowerCase()!==QueryOperator.NotBetween.toString()||(this.getTxtColTag2(e,t).css("display","table-cell"),this.getTxtColTag2(e,t).find("input").css("display","block"))):this.isDate(t)&&(a=this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param"),o=this.dateTimeFormats.some(function(e){return e.value===i})&&i.toLowerCase()!=QueryDatatype.Date.toString(),a.css("display",o||i.toLowerCase()==QueryDatatype.Date.toString()?"table-cell":"none"),o?this.setDataForParamDropDown(e,this.parameterName,"Custom",t):(i.toLowerCase()!=QueryDatatype.Date.toString()&&a.css("display","none"),this.setDataForDateDropdowns(e,null,null,"Custom")))},e.prototype.renderDropDownForParameter=function(e,t,i,a){var o=BoldBIDashboard.buildTag("input.e-textbox",this.selectionType,{},{type:"text",id:e+"_param"});i.append(o),"date"!=t?o.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:"150px",dataSource:[{text:"Custom",value:"Custom"},{text:"Parameters",value:"Parameters"},{text:"Custom Attributes",value:"Custom Attributes"}],fields:{text:"text",value:"value"},value:this.selectionType,enabled:!0,change:this.bbdesigner$.proxy(this.onParameterDropDownChange,this,e,t,this.parameterList,i),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control"}):o.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:"150px",dataSource:[{text:"Custom",value:"Custom"},{text:"Parameters",value:"Parameters"}],fields:{text:"text",value:"value"},value:this.selectionType,enabled:!0,change:this.bbdesigner$.proxy(this.onParameterDropDownChange,this,e,t,this.parameterList,i),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control"}),this.isBoolean(t)||(o=BoldBIDashboard.buildTag("td","",{"padding-left":"10px",display:"none"},{id:e+"_query_"+t+"_parameter_dropdown"}),i=BoldBIDashboard.buildTag("input.e-textbox",this.parameterName,{height:"30px",width:"160px"},{type:"text",id:e+"_param_elements"}),o.append(i),this.parameterName=this.checkValidParameterOrNot(this.parameterName,this.parameterList,e),i.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:i.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:this.parameterList,enabled:!0,value:this.parameterName,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.parameterChangeEvent,this,e)}),i=BoldBIDashboard.buildTag("td","",{"padding-left":"10px",display:"none"},{id:e+"_query_"+t+"_parameter_dropdown_btw"}),t=BoldBIDashboard.buildTag("input.e-textbox",this.endParameterName,{height:"30px",width:"160px"},{type:"text",id:e+"_param_btw"}),i.append(t),this.endParameterName=this.checkValidParameterOrNot(this.endParameterName,this.parameterList,e),t.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:t.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:this.parameterList,enabled:!0,value:this.endParameterName,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.parameterBtwChangeEvent,this,e)}),a.append(o),a.append(i))},e.prototype.checkValidParameterOrNot=function(t,e,i){var a,o;return BoldBIDashboard.isNullOrUndefined(t)||""===t||this.isValueUpdated||(a=!1,o=this.rootNode.find("#"+i+"_query_filter_field_container"),!BoldBIDashboard.isNullOrUndefined(e)&&e.some(function(e){return e.value===t}))?t:(this.updateHighlighter(o,a=!0),BoldBIDashboard.DashboardUtil.showErrIndictor(this.rootNode.find("#"+i+"_query_error_td"),a,"Select values to apply filter."),null)},e.prototype.onParameterDropDownChange=function(e,t,i,a,o){var s,n,r,d,l,h,p,c,u,b;BoldBIDashboard.isNullOrUndefined(o)||BoldBIDashboard.isNullOrUndefined(o.value)||!o.isInteraction||(s=this.getOperatorDrpDwn(e,t).data("BoldBIDashboardDropDownList").model.value,n=this.getParameterDropDown(e,t),r=this.getParameterBtwDropDown(e,t),u=this.getParamDropDownSelectionValue(e),this.dateRangePopup.updateParameterListInfo(i),b=this.dateRangePopup.renderDateRangePopup(e,o.value),d=(b=BoldBIDashboard.isNullOrUndefined(b)?this.dashboardDesigner.element:b).find("#"+e+"_query_date_Start_parameter_dropdown"),l=b.find("#"+e+"_query_date_End_parameter_dropdown"),h=b.find("#"+e+"_dateRange_Start"),p=b.find("#"+e+"_dateRange_end"),b.find("#"+e+"_query_date_Start_attr_dropdown"),b.find("#"+e+"_query_date_End_attr_dropdown"),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_txtcol_param").css("display","table-cell"),this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_switcher").css("padding-left","26px"),this.dashboardDesigner.element.find("#"+e+"_query_date_pickcol").css("padding-left","10px"),u.data("selectedType",o.value),u.val(o.value),"Parameters"===o.value?(this.selectionType="Parameters",this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").remove(),this.isString(t)||t.toLowerCase()===QueryDatatype.Int.toString()?(this.getTxtColTag1(e,t).css("display","none"),t.toLowerCase()!==QueryDatatype.Int.toString()||s.toLowerCase()!==QueryOperator.Between.toString()&&s.toLowerCase()!==QueryOperator.NotBetween.toString()||(r.css("display","table-cell"),this.getTxtColTag2(e,t).css("display","none"),this.dashboardDesigner.element.find("#"+e+"_param_btw_container").css("display","block"),this.getParamBtwDropDownSelectionValue(e).data("BoldBIDashboardDropDownList").setModel({value:0<i.length?i[0].value:null})),this.getParameterValue(e).data("BoldBIDashboardDropDownList").setModel({value:0<i.length?i[0].value:null}),n.css("display","table-cell")):this.isDate(t)&&(s.toLowerCase()===QueryDatatype.Date.toString()?(b=i.filter(function(e){return e.dataType===DynamicParameterDataType.Date}),u=this.dateRangePopup.renderDateRangePopup(e),u=BoldBIDashboard.isNullOrUndefined(u)?this.dashboardDesigner.element:u,b=0<b.length?b[0].value:null,c=u.find("#"+e+"_date_Start_param"),u=u.find("#"+e+"_date_End_param"),BoldBIDashboard.isNullOrUndefined(c.data("BoldBIDashboardDropDownList"))||c.data("BoldBIDashboardDropDownList").setModel({value:b}),BoldBIDashboard.isNullOrUndefined(u.data("BoldBIDashboardDropDownList"))||u.data("BoldBIDashboardDropDownList").setModel({value:b}),c.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(b)?null:{Name:b,Id:this.getParameterIDFromName(b)}),u.data("ParameterInfos",BoldBIDashboard.isNullOrUndefined(b)?null:{Name:b,Id:this.getParameterIDFromName(b)}),d.css("display","table-cell"),l.css("display","table-cell"),h.css("display","none"),p.css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_date_Start_attr_dropdown").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_date_End_attr_dropdown").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_date_pickcol").css("display","table-cell")):this.dateTimeFormats.some(function(e){return e.value===s})&&(this.getDateColumnTag(e).css("display","none"),this.getParameterValue(e).data("BoldBIDashboardDropDownList").setModel({value:0<i.length?i[0].value:null}),n.css("display","table-cell")))):"Custom"===o.value?(this.dashboardDesigner.element.find("#"+e+"_query_int_txtcol1").css("padding-left","10px"),c=this.getParamDropDownSelectionValue(e),u=this.getParameterStartDropDowm(e),b=this.getParameterEndDropDowm(e),c.data("ParameterInfos",null),u.data("ParameterInfos",null),b.data("ParameterInfos",null),this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").remove(),this.isString(t)||t.toLowerCase()===QueryDatatype.Int.toString()?(this.getTxtColTag1(e,t).css("display","table-cell"),t.toLowerCase()!==QueryDatatype.Int.toString()||s.toLowerCase()!==QueryOperator.Between.toString()&&s.toLowerCase()!==QueryOperator.NotBetween.toString()||(this.dashboardDesigner.element.find("#"+e+"_query_int_parameter_dropdown_btw").css("display","none"),r.css("display","none"),this.getTxtColTag2(e,t).css("display","table-cell"),this.getTxtColTag2(e,t).find("input").css("display","block")),n.css("display","none")):this.isDate(t)&&(s.toLowerCase()===QueryDatatype.Date.toString()?(d.css("display","none"),l.css("display","none"),h.css("display","table-cell"),p.css("display","table-cell"),this.dashboardDesigner.element.find("#"+e+"_query_date_Start_attr_dropdown").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_query_date_End_attr_dropdown").css("display","none")):this.dateTimeFormats.some(function(e){return e.value===s})&&(n.css("display","none"),this.getDateColumnTag(e).css("display","table-cell"),this.getDateColumnTag(e).find("input").css("display","block")))):"Custom Attributes"===o.value&&this.getCustomAttribute(e,t,i,a,o))},e.prototype.getCustomAttribute1=function(){var t=this;this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,isCodeView:!1,isQueryDesignerMode:!0})},{fnction:function(e){t.setCustomAttribute(e)}})},e.prototype.getCustomAttribute=function(t,i,a,o,s){var n=this;this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetCustomAttribute,isCodeView:!1,isQueryDesignerMode:!0})},{fnction:function(e){n.renderDropDownForCustomAttribute(e,t,i,a,o,s)},indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]})},e.prototype.renderDropDownForCustomAttribute=function(e,t,i,a,o,s){BoldBIDashboard.isNullOrUndefined(e)||(e=e.map(function(e){return{text:e.Name,value:e.Value}}),this.customAttributesList=e);var e=this.getOperatorDrpDwn(t,i).data("BoldBIDashboardDropDownList").model.value,n=this.getParameterDropDown(t,i),r=(this.getParameterBtwDropDown(t,i),this.getParamDropDownSelectionValue(t)),a=(this.dateRangePopup.updateParameterListInfo(a),this.dateRangePopup.renderDateRangePopup(t)),a=BoldBIDashboard.isNullOrUndefined(a)?this.dashboardDesigner.element:a,d=(a.find("#"+t+"_query_date_Start_parameter_dropdown"),a.find("#"+t+"_query_date_End_parameter_dropdown"),a.find("#"+t+"_dateRange_Start")),l=a.find("#"+t+"_dateRange_end"),h=a.find("#"+t+"_query_date_Start_attr_dropdown"),a=a.find("#"+t+"_query_date_End_attr_dropdown");this.dashboardDesigner.element.find("#"+t+"_query_"+i+"_txtcol_param").css("display","table-cell"),this.dashboardDesigner.element.find("#"+t+"_query_"+i+"_switcher").css("padding-left","26px"),this.dashboardDesigner.element.find("#"+t+"_query_date_pickcol").css("padding-left","10px"),r.data("selectedType",s.value),r.val(s.value),this.isString(i)||i.toLowerCase()===QueryDatatype.Int.toString()||"date"!=e.toLowerCase()?(this.selectionType="Custom Attributes",this.dashboardDesigner.element.find("#"+t+"_query_date_pickcol").css("display","none"),this.getTxtColTag1(t,i).css("display","none"),n.css("display","none"),e.toLowerCase()!==QueryOperator.Between.toString()&&e.toLowerCase()!==QueryOperator.NotBetween.toString()||(this.dashboardDesigner.element.find("#"+t+"_param_btw_container").css("display","none"),this.dashboardDesigner.element.find("#"+t+"_query_int_txtcol2").css("display","none")),r=BoldBIDashboard.buildTag("input.e-textbox",this.attributeName,{},{type:"text",id:t+"_attribute"}),o.append(r),r.BoldBIDashboardDropDownList({width:"130px",height:"26px",popupWidth:"150px",dataSource:this.customAttributesList,fields:{text:"text",value:"value"},value:this.attributeName,enabled:!0,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.setAttributeValueInfo,this,t,i)}),this.dashboardDesigner.element.find("#"+t+"_query_"+i+"_txtcol_param").css("display","-webkit-box"),this.dashboardDesigner.element.find("#"+t+"_attribute_wrapper").css("padding-left","10px"),this.dashboardDesigner.element.find("#"+t+"_query_"+i+"_switcher").css("padding-left","300px")):this.isDate(i)&&(s=this.dateRangePopup.renderDateRangePopup(t),(n=BoldBIDashboard.isNullOrUndefined(s)?this.dashboardDesigner.element:s).find("#"+t+"_date_Start_attr"),n.find("#"+t+"_date_End_attr"),h.css("display","table-cell"),a.css("display","table-cell"),d.css("display","none"),l.css("display","none"),this.dashboardDesigner.element.find("#"+t+"_query_date_Start_parameter_dropdown").css("display","none"),this.dashboardDesigner.element.find("#"+t+"_query_date_End_parameter_dropdown").css("display","none"))},e.prototype.showIndicator=function(){this.ejIndicator=this.dashboardDesigner.element.find("#"+this.id+"_query_filter_dialog").data("BoldBIDashboardWaitingPopup"),this.ejIndicator.show(),this.okBtn.attr({disabled:"disabled"})},e.prototype.hideIndicator=function(){this.ejIndicator.hide(),this.okBtn.removeAttr("disabled")},e.prototype.setCustomAttribute=function(e){BoldBIDashboard.isNullOrUndefined(e)||(e=e.map(function(e){return{text:e.Name,value:e.Value}}),this.customAttributesList=e)},e.prototype.parameterChangeEvent=function(e,t){var i,a=this;this.selectionType="Parameters",i=this.getParamDropDownSelectionValue(e),e=this.getAttributeDropDownSelectionValue(e),this.parameterName=t.value,t=t.model.dataSource.filter(function(e){return e.value===a.parameterName}),t={Name:this.parameterName,Id:0<t.length?t[0].parameterID:this.parameterName},i.data("ParameterInfos",t),e.data("AttributeInfo",null),i.data("SelectionType","Parameters")},e.prototype.setAttributeValueInfo=function(e,t,i){this.selectionType="Custom Attributes";var a=this.getAttributeDropDownSelectionValue(e),o=this.getParamDropDownSelectionValue(e),s=this.getParameterStartDropDowm(e),e=this.getParameterEndDropDowm(e);this.attributeName=i.text,this.attributeValue=i.value,i={Name:this.attributeName,Value:this.attributeValue},o.data("ParameterInfos",null),s.data("ParameterInfos",null),e.data("ParameterInfos",null),a.data("AttributeInfo",i)},e.prototype.attributeRetainEvent=function(e,t,i){this.selectionType="Custom Attributes";var a=this.getParamDropDownSelectionValue(e),o=this.getParameterStartDropDowm(e),s=this.getParameterEndDropDowm(e),n=this.getAttributeDropDownSelectionValue(e),i={Name:i[e+"_customAttributeName"]};a.data("ParameterInfos",null),o.data("ParameterInfos",null),s.data("ParameterInfos",null),n.data("AttributeInfo",i),n.data("SelectionType","Custom Attributes")},e.prototype.parameterBtwChangeEvent=function(e,t){var i=this,e=this.getParamBtwDropDownSelectionValue(e);this.endParameterName=t.value,t=t.model.dataSource.filter(function(e){return e.value===i.endParameterName}),t={Name:this.endParameterName,Id:0<t.length?t[0].parameterID:this.endParameterName},e.data("ParameterInfos",t)},e.prototype.dateFormats=function(e){var t;switch(e){case"Date Time":t=DateTimeFormat.Default;break;case"Date Hour":t=DateTimeFormat.DateHour;break;case"Month Year":t=DateTimeFormat.MonthYear;break;case"Week Year":t=DateTimeFormat.WeekYear;break;case"Quarter Year":t=DateTimeFormat.QuarterYear;break;case"Day Month Year":t=DateTimeFormat.DayMonthYear;break;case"Month Day Year":t=DateTimeFormat.MonthDayYear;break;case"Day of Week":t=DateTimeFormat.DayOfWeek;break;case"Week of Year":t=DateTimeFormat.WeekOfYear;break;case"Hours":t=DateTimeFormat.Hour;break;case"Minutes":t=DateTimeFormat.Minute;break;case"Seconds":t=DateTimeFormat.Second;break;default:t=e}return t},e.prototype.generateListDataSource=function(e){for(var t=[],i=0;i<e.length;i++)t.push({id:"item"+i,text:e[i]});return t},e.prototype.renderFields=function(e,t,i,a){var o=BoldBIDashboard.buildTag("table","",{width:"100%","background-color":"#F9F9F9","padding-bottom":"2px","padding-top":"2px"},{}),s=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("td","",{width:"10px","padding-left":"10px"},{}),r=BoldBIDashboard.buildTag("input","",{},{type:"text",id:e+"_query_"+a+"_operator"});t.append(o),o.append(s),s.append(n),n.append(r),r.BoldBIDashboardDropDownList({dataSource:this.isDate(i)?this.dateTimeFormats:this.getOperatorsList(a),fields:{text:"text",value:"value"},enabled:!0,change:this.bbdesigner$.proxy(this.onOperatorChange,this,e,a),width:"130px",height:"26px",popupWidth:"auto",selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),(this.isNumber(i)||this.isString(i))&&this.renderStringFields(e,s,i,a),this.isDate(i)&&this.renderDateFields(e,s,i,a),this.isValueUpdated=!1},e.prototype.onOperatorChange=function(e,t,i){var a,o,s,n,r,d,l,h,p;i.isInteraction&&(this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").remove(),this.dashboardDesigner.element.find("#"+e+"_attribute_hidden").remove(),this.dashboardDesigner.element.find("#"+e+"_attribute_container").remove(),this.dashboardDesigner.element.find("#"+e+"_query_int_parameter_dropdown_btw").css("display","none"),i=this.getOperatorDrpDwn(e,t).data("BoldBIDashboardDropDownList").getSelectedValue(),this.setDefaultValues(e,t,i),this.dashboardDesigner.element.find("#"+e+"_query_date_switcher").css("padding-left","0px"),this.dashboardDesigner.element.find("#"+e+"_query_int_txtcol_param").css("display","table-cell"),o=this.getTxtValTag1(e,t),s=this.getTxtValTag2(e,t),n=this.getTxtColTag1(e,t),r=this.getTxtColTag2(e,t),d=this.rootNode.find("#"+e+"_query_int_null"),l=this.getNullTxtBxTag(e),h=this.getNullChkBx(e).data("BoldBIDashboardCheckBox"),(p=this.multiSelectionComboBox.getMultiSelectionComboBox(e)).removeAttr("data-fieldValue"),p.removeAttr("data-fieldText"),p.removeAttr("data-dateFormat"),this.rootNode.find("#"+e+" .e-error-tip").css("display","none"),this.dashboardDesigner.element.find("#"+e+"_attribute_wrapper").remove(),t.toLowerCase()===QueryDatatype.Int.toString()?i.toLowerCase()===QueryOperator.Between.toString()||i.toLowerCase()===QueryOperator.NotBetween.toString()?(r.css({display:"table-cell"}),n.css({"padding-left":"10px"}),o.css({display:"block",width:"67px"}),s.css({display:"block",width:"71px"}),d.css({"padding-left":"15px"}),l.css("display","none")):(p.css("display","none"),r.css("display","none"),n.css({"padding-left":"10px"}),h.isChecked()?(o.css("display","none"),l.css("display","block")):(l.css("display","none"),o.css({display:"block",width:"134px"}))):t.toLowerCase()===QueryDatatype.Char.toString()?"inclusion"===i.toLowerCase()?(o.css("display","none"),r.css("display","none"),p.css("display","block"),a=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList"),p.attr({"data-fieldValue":a.getSelectedValue(),"data-fieldText":a.model.text,"data-dateFormat":null}),"all"!==p.find("div:first").text().toLowerCase()&&p.find("div:first").html("All")):(o.css("display","block"),r.css("display","none"),p.css("display","none")):t.toLowerCase()===QueryDatatype.Date.toString()&&("date"===i.toLowerCase()?(p.css("display","none"),this.getDateRangeDrpDwn(e).css("display","block"),this.dateRangePopup.resetDateRangeDrpDwn(e)):(this.getDateRangeDrpDwn(e).css("display","none"),p.css("display","block"),a=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList"),p.attr({"data-fieldValue":a.getSelectedValue(),"data-fieldText":this.bbdesigner$(a).text(),"data-dateFormat":i}),s={IsCheckAll:!0,IsInclude:!0,FilterValues:null},this.multiSelectionComboBox.getMultiSelectionComboBox(e).parent().data("MultiSelectionComboBox").populateMultiSelectionItem(e,s))))},e.prototype.addQueryFilter=function(){this.renderQueryFilterRow()},e.prototype.deleteFilter=function(e){this.containerDiv.context.children[e].remove()},e.prototype.deleteQueryFilter=function(e){var t,i,a,o=e.parent();e.remove(),0<o.children().length&&(i=(o=o.children().first()).attr("id"),0<(a=o.find("#"+i+"_query_operator_type_div")).length)&&(t=o.find("#"+i+"_query_container_table"),o.css("padding","6px 4px 14px 4px"),t.css({top:"",position:""}),o.find("#"+i+"_query_empty_cell").parent().remove(),a.remove()),this.dashboardDesigner.element.find("#"+e.attr("rowId")+"_popup_container").remove(),this.dashboardDesigner.element.find("#"+e.attr("rowId")+"_dateRange_popup").remove(),this.scrollerRefresh(this.parentDiv)},e.prototype.onDropDownChange=function(e,t,i){var a,o;i.isInteraction&&(this.dashboardDesigner.element.find(".e-error-tip").css("display","none"),this.resetQueryFields(e),i=this.rootNode.find("#"+e+"_query_container_cell"),a=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").getSelectedItem(),a=this.bbdesigner$(a).text(),o=(a=this.getSelectedValue(a)).typeName,o=BoldBIDashboard.isNullOrUndefined(a.typeCast)||0===a.typeCast.length||this.isDefaultCast(a.typeCast)?o:a.typeCast,this.isValueUpdated=!0,this.renderInputField(o,e,i))},e.prototype.onNullCheck=function(e,t){var i=this.getTxtValTag1(e,QueryDatatype.Int.toString()),a=this.getTxtValTag2(e,QueryDatatype.Int.toString()),o=this.getTxtColTag2(e,QueryDatatype.Int.toString()),s=this.getOperatorDrpDwn(e,QueryDatatype.Int.toString()).data("BoldBIDashboardDropDownList"),n=s.getSelectedValue(),e=this.getNullTxtBxTag(e),r=this.oprtrListForNullOption();t.isInteraction&&(t.isChecked?(i.css("display","none"),a.css("display","none"),o.css("display","none"),e.css("display","block")):(e.css("display","none"),a.css("display","none"),o.css("display","none"),i.css({display:"block",width:"134px"})),s.setModel({dataSource:t.isChecked?r:this.getOperatorsList(QueryDatatype.Int.toString()),selectedIndex:0,fields:{text:"text",value:"value"}}),n=n===NumberFilterOption.Equals||n===NumberFilterOption.NotEquals?n:NumberFilterOption.Equals,s.selectItemByValue(n))},e.prototype.oprtrListForNullOption=function(){return[{text:"Equals",value:"Equals"},{text:"Does Not Equals",value:"DoesNotEquals"}]},e.prototype.textFocus=function(e,t,i){"focusin"===t.toLowerCase()?"0"!==e.val()&&"0.00"!==e.val()||e.val(""):"focusout"===t.toLowerCase()&&("System.Int32"===i||"System.Int16"===i||"System.Int64"===i||"System.Byte"===i?e.val(0===e.val().length?"0":e.val()):"System.Double"!==i&&"number"!==i.toLowerCase()&&"System.Single"!==i&&"System.Decimal"!==i||e.val(0===e.val().length?"0.00":e.val()))},e.prototype.conditionCheck=function(e){var t=this.getChkBx1(e).data("BoldBIDashboardCheckBox"),i=this.getChkBx2(e).data("BoldBIDashboardCheckBox"),a=this.getChkBx3(e).data("BoldBIDashboardCheckBox"),e=this.rootNode.find("#"+e+QueryDatatype.Bool.toString()+"_chck_on").is(":checked");return!(!(t.isChecked()&&i.isChecked()&&a.isChecked())||e)||!(t.isChecked()||i.isChecked()||a.isChecked())},e.prototype.validateTxtBox=function(e,t,i){var a,i=i.keyCode;return"System.Int32"===t||"System.Int16"===t||"System.Int64"===t||"System.Byte"===t?!(8!==i&&31<i&&(i<48||57<i)&&45!==i)&&(a=e.val(),45!==i||""===a):"System.Double"===t||"System.Single"===t||"System.Decimal"===t||"number"===t.toLowerCase()?46===i?-1===e.val().indexOf("."):!(8!==i&&31<i&&(i<48||57<i)&&45!==i)&&void 0:void 0},e.prototype.validateBoolValues=function(e,t,i){var a="";return e?(t.addClass("bbi-designer-error").addClass("bbi-designer-error-radius"),a+="The filter on "+i+" does not have proper values to filter on. "):t.removeClass("bbi-designer-error").removeClass("bbi-designer-error-radius"),a},e.prototype.updateHighlighter=function(e,t){t?e.find(".e-in-wrap e-box e-padding").addClass("bbi-designer-error").addClass("bbi-designer-error-radius"):e.find(".e-in-wrap e-box e-padding").removeClass("bbi-designer-error").removeClass("bbi-designer-error-radius")},e.prototype.resetQueryFields=function(e){this.rootNode.find("#"+e+"_query_container_cell").empty(),this.dashboardDesigner.element.find("#"+e+"_dateRange_popup").remove(),this.rootNode.find("#"+e+"_queryFilter_topDiv").empty(),this.rootNode.find("#"+e+"_tr_top").css("display","none")},e.prototype.openQueryFilterDialog=function(){this.dashboardDesigner.element.find("#"+this.id+"_query_filter_dialog").data("BoldBIDashboardDialog").open(),this.resetQueryFilterDialog(),this.dataFields=this.getAvailableDataFields(),this.queryFilters=this.queryDesigner.queryFilter,this.populateQueryFilter(this.queryFilters)},e.prototype.closeDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),this.multiSelectionComboBox.hideMultiSelectionWaitingPopup(!0),this.dashboardDesigner.element.find("#"+this.id+"_query_filter_dialog").data("BoldBIDashboardDialog").close()},e.prototype.closePopup=function(){this.dashboardDesigner.element.find(".bbi-daterange-popup:visible").css("display","none"),this.dashboardDesigner.element.find(".e-multiselect-popup-container").css("display","none")},e.prototype.resetQueryFilterDialog=function(){this.dataFields=[],this.parameters=[],this.containerDiv.empty(),this.scrollerRefresh(this.parentDiv)},e.prototype.populateQueryFilter=function(e){var t,i,a,o;for((this.multiSelectionComboBox.filters=e).some(function(e){return!BoldBIDashboard.isNullOrUndefined(e.CustomAttributeInfo)&&e.CustomAttributeInfo.IsAttributeApplied})&&this.getCustomAttribute1(),this.parameterList=this.dashboardDesigner.modules.storeParameter.getParameterDataSource(),t=0;t<e.length;t++)i=this.renderQueryFilterRow(e[t]),this.multiSelectionComboBox.filters[t].rowId=i,a=e[t].DataType,a=e[t].IsTypeCast?e[t].TypeCastValue:a,0<t&&(o=e[t].OperatorType,o=this.getIndexByValue(o),this.getOperatorTypeDropDown(i).data("BoldBIDashboardDropDownList").selectItemByIndex(o)),this.isNumber(a)?this.populateIntField(i,e[t]):this.isBoolean(a)?this.populateBoolFilter(i,e[t]):this.isString(a)?this.populateStringField(i,e[t]):this.isDate(a)&&(o=this.getOperatorDrpDwn(i,"date").data("BoldBIDashboardDropDownList").getSelectedValue(),this.populateDateFields(i,e[t]),this.populateDateRangeParameterValues(i,"date",o))},e.prototype.getIndexByValue=function(e){if(!BoldBIDashboard.isNullOrUndefined(e))for(var t=0;t<this.operatorTypes.length;t++)if(this.operatorTypes[t].value.toLowerCase()===e.toLowerCase())return t;return 1},e.prototype.getFieldText=function(e){if(this.dataFields&&0<this.dataFields.length)for(var t=0;t<this.dataFields.length;t++)if(this.dataFields[t].value===e)return this.dataFields[t].text},e.prototype.populateIntField=function(e,t){var i=t.MeasureFilterSchemaInfo,a=i.FilterValues,o=!BoldBIDashboard.isNullOrUndefined(t.ParameterInfo)&&t.ParameterInfo.IsParamApplied,s=t.CustomAttributeInfo.IsAttributeApplied,n=this.getTxtValTag1(e,QueryDatatype.Int.toString()),r=this.getTxtValTag2(e,QueryDatatype.Int.toString()),d=this.getTxtColTag1(e,QueryDatatype.Int.toString()),l=this.getTxtColTag2(e,QueryDatatype.Int.toString()),h=this.rootNode.find("#"+e+"_query_int_null"),p=this.getNullTxtBxTag(e),c=this.getOperatorDrpDwn(e,QueryDatatype.Int.toString()).data("BoldBIDashboardDropDownList"),u=this.getFieldText(i.ColumnId,t.TableName,t.Schema);this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").selectItemByText(u),o||("in"==t.MeasureFilterSchemaInfo.MeasureFilterCondition.toLowerCase()||"notin"==t.MeasureFilterSchemaInfo.MeasureFilterCondition.toLowerCase()?(u=a.join(", "),this.getTxtValTag1(e,QueryDatatype.Int.toString()).val(u)):this.getTxtValTag1(e,QueryDatatype.Int.toString()).val(a[0])),i.MeasureFilterCondition.toLowerCase()!==QueryOperator.Between.toString()&&i.MeasureFilterCondition.toLowerCase()!==QueryOperator.NotBetween.toString()||(l.css({display:"none"}),d.css({"padding-left":"10px"}),n.css({display:o?"none":"block",width:"67px"}),r.css({display:o?"none":"block",width:"71px"}),h.css({"padding-left":"15px"}),p.css("display","none"),o||(this.getTxtColTag2(e,QueryDatatype.Int.toString()).css("display","table-cell"),r.val(a[1])),!s)||this.dashboardDesigner.element.find("#"+e+"_query_int_txtcol2").css("display","none"),this.getNullChkBx(e).data("BoldBIDashboardCheckBox").setModel({checked:i.IsIncludeNull}),this.getTxtValTag1(e,QueryDatatype.Int.toString()).css("display",i.IsIncludeNull?"none":"block"),this.rootNode.find("#"+e+"_query_null_txt").css("display",i.IsIncludeNull?"block":"none"),c.setModel({dataSource:i.IsIncludeNull?[{text:"Equals",value:"Equals"},{text:"Does Not Equals",value:"DoesNotEquals"}]:this.getOperatorsList(QueryDatatype.Int.toString()),selectedIndex:0,fields:{text:"text",value:"value"}}),c.selectItemByValue(i.MeasureFilterCondition)},e.prototype.populateStringField=function(e,t){var i=this.getTxtValTag1(e,QueryDatatype.Char.toString()),a=this.getTxtColTag2(e,QueryDatatype.Char.toString()),o=this.multiSelectionComboBox.getMultiSelectionComboBox(e),s=t.DimensionFilterSchemaInfo,n=this.getFieldText(t.Id,t.TableName,t.Schema),r={FilterValues:s.FilterValues,IsInclude:s.IsInclude,IsCheckAll:s.IsCheckAll,CheckAllState:s.CheckAllState,IsParamApplied:s.IsParamApplied,ParameterName:s.ParameterName};o.parent().data("MultiSelectionComboBox").populateMultiSelectionItem(e,r),this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").selectItemByText(n),this.getOperatorDrpDwn(e,QueryDatatype.Char.toString()).data("BoldBIDashboardDropDownList").selectItemByValue(s.DimensionFilterCondition),s.DimensionFilterCondition.toLowerCase()===DimensionFilterCondition.Inclusion.toString().toLowerCase()?(i.css("display","none"),a.css("display","none"),o.css("display","block")):(o.css("display","none"),i.css("display","block"),s.FilterValues&&s.FilterValues[0]&&i.val(s.FilterValues[0])),this.rootNode.find("#"+e+QueryDatatype.Char.toString()+"_chck_on").prop("checked",s.IsTopNApplied),s.IsTopNApplied&&(this.rootNode.find("#"+e+"_tr_top").css("display","table-row"),this.populateTopFields(e,s.TopNFilterConditionInfo,t,QueryDatatype.Char.toString()))},e.prototype.populateTopFields=function(e,t,i,a){var o,s;t&&(o=0===t.TopNCondition||"Top"===t.TopNCondition?"Top":"Bottom",this.getTopModeItem(e,a).data("BoldBIDashboardDropDownList").selectItemByText(o),this.getTopCountItem(e,a).data("ejNumericTextbox").setModel({value:t.NumberOfItems}),o=this.getFieldText(t.ColumnId,i.TableName,i.Schema),this.getTopColumnItem(e,a).data("BoldBIDashboardDropDownList").selectItemByText(o),i=this.getTopSummaryItem(e,a),o=this.getTopFormatItem(e,a),s=t.SummaryType,t.IsFormatAppliedForDateField?(this.getCheckBoxCell(e,a).css({display:"block","padding-top":"3px"}),this.getTopDateTimeItem(e,a).data("BoldBIDashboardCheckBox").setModel({checked:t.IsFormatAppliedForDateField}),o.css("display","block"),i.css("display","none"),o.data("BoldBIDashboardDropDownList").selectItemByValue(t.DateAndTimeFormat)):(o.css("display","none"),i.css("display","block"),i.data("BoldBIDashboardDropDownList").selectItemByValue(s)))},e.prototype.populateDateFields=function(e,t){var i=t.DateFilterSchemaInfo,a=this.getOperatorDrpDwn(e,QueryDatatype.Date.toString()).data("BoldBIDashboardDropDownList"),o=this.getFieldText(t.Id,t.TableName,t.Schema);this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").selectItemByText(o),this.rootNode.find("#"+e+QueryDatatype.Date.toString()+"_chck_on").prop("checked",i.IsTopNApplied),i.IsTopNApplied&&(this.rootNode.find("#"+e+"_tr_top").css("display","table-row"),this.populateTopFields(e,i.TopNFilterConditionInfo,t,QueryDatatype.Date.toString())),i.DateAndTimeFormatCondition.toLowerCase()===QueryDatatype.Date.toString()?(this.multiSelectionComboBox.getMultiSelectionComboBox(e).css("display","none"),this.getDateRangeDrpDwn(e).css("display","block"),this.dateRangePopup.populateDateRangePopup(e,i.DateFormatInfo)):(o={FilterValues:i.FilterValues,IsInclude:i.IsInclude,IsCheckAll:i.IsCheckAll,CheckAllState:i.CheckAllState},(t=this.multiSelectionComboBox.getMultiSelectionComboBox(e)).parent().data("MultiSelectionComboBox").populateMultiSelectionItem(e,o),t.attr({"data-dateFormat":i.DateAndTimeFormatCondition})),a.selectItemByValue(i.DateAndTimeFormatCondition)},e.prototype.populateBoolFilter=function(e,t){var i=t.BooleanFilterSchemaInfo,a=this.getFieldText(t.Id,t.TableName,t.Schema);this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").selectItemByText(a),this.rootNode.find("#"+e+QueryDatatype.Bool.toString()+"_chck_on").prop("checked",i.IsTopNApplied),this.getChkBx1(e).data("BoldBIDashboardCheckBox").setModel({checked:i.IsNullEnabled}),this.getChkBx2(e).data("BoldBIDashboardCheckBox").setModel({checked:i.IsTrueEnabled}),this.getChkBx3(e).data("BoldBIDashboardCheckBox").setModel({checked:i.IsFalseEnabled}),i.IsTopNApplied&&(this.rootNode.find("#"+e+"_tr_top").css("display","table-row"),this.populateTopFields(e,i.TopNFilterConditionInfo,t,QueryDatatype.Bool.toString()))},e.prototype.getQueryFilter=function(){var l,h=this,p=[],c={},u="",b=this.dateTimeFormats,g=!1,e=this.rootNode.find("#"+this.id+"_query_container_div .bbi-designer-query-row"),m=this,f=this.bbdesigner$;return e.each(function(e,t){var i,a=new InitialFilterInfo,t=f(t).attr("id"),o=!1,s=h.rootNode.find("#"+t+"_query_filter_field_container"),n=h.getDrpDwn1(t).data("BoldBIDashboardDropDownList").getSelectedItem(),r=h.getDrpDwn1(t).data("BoldBIDashboardDropDownList").getSelectedValue(),n=f(n).text(),n=h.getSelectedValue(n),d=BoldBIDashboard.isNullOrUndefined(n.typeCast)||0===n.typeCast.length||h.isDefaultCast(n.typeCast);l=d?n.typeName:n.typeCast,i=n.columnName,a.Name=i,a.Id=r,h.isNumber(l)?(c=h.getIntVal(t),a.ParameterInfo=h.getInitialDashboardParamInfo(c),a.CustomAttributeInfo=h.getInitialDashboardAttributeInfo(c),a.Type=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Measure),a.MeasureFilterSchemaInfo={ColumnName:i,ColumnId:r,MeasureFilterCondition:c.MeasureFilterCondition,FilterValues:c.FilterValues,IsIncludeNull:c.IsIncludeNull},o=!!a.ParameterInfo.IsParamApplied&&h.checkParamHasError("int",c.MeasureFilterCondition,a.ParameterInfo.ParameterName,a.ParameterInfo.EndParameterName),o=a.CustomAttributeInfo.IsAttributeApplied?h.checkAttributeHasError("int",c.MeasureFilterCondition,a.CustomAttributeInfo.CustomAttributeName,a.CustomAttributeInfo.AttributeEndName):o,h.updateHighlighter(s,o),o&&(u+="Select values to apply filter.")):h.isBoolean(l)?(c=h.getBoolVal(t),a.Type=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Boolean),a.BooleanFilterSchemaInfo={ColumnName:i,ColumnId:r,IsTrueEnabled:c.IsTrueEnabled,IsNullEnabled:c.IsNullEnabled,IsFalseEnabled:c.IsFalseEnabled,IsTopNApplied:c.IsTopNApplied,TopNFilterConditionInfo:c.TopNFilterConditionInfo},o=h.conditionCheck(t),u+=h.validateBoolValues(o,s,n.value)):h.isString(l)?(c=h.getStringVal(t),a.ParameterInfo=h.getInitialDashboardParamInfo(c),a.CustomAttributeInfo=h.getInitialDashboardAttributeInfo(c),a.Type=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Dimension),a.DimensionFilterSchemaInfo={ColumnName:i,ColumnId:r,DimensionFilterCondition:c.DimensionFilterCondition,FilterValues:c.FilterValues,IsInclude:c.IsInclude,IsCheckAll:c.IsCheckAll,IsTopNApplied:c.IsTopNApplied,CheckAllState:c.CheckAllState,TopNFilterConditionInfo:c.TopNFilterConditionInfo},o=!c.IsTopNApplied&&c.IsCheckAll&&c.DimensionFilterCondition.toLowerCase()===DimensionFilterCondition.Inclusion.toString().toLowerCase(),o=a.ParameterInfo.IsParamApplied?h.checkParamHasError("string",null,a.ParameterInfo.ParameterName,null):o,o=a.CustomAttributeInfo.IsAttributeApplied?h.checkAttributeHasError("string",null,a.CustomAttributeInfo.CustomAttributeName,a.CustomAttributeInfo.AttributeEndName):o,h.updateHighlighter(s,o),o&&(u+=h.locale.errorMessage.formattedValueInvalid)):h.isDate(l)&&(c=h.getDateVal(t),a.ParameterInfo=h.getInitialDashboardParamInfo(c),a.CustomAttributeInfo=h.getInitialDashboardAttributeInfo(c),a.Type=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Date),a.DateFilterSchemaInfo={ColumnName:i,ColumnId:r,DateAndTimeFormatCondition:c.DateAndTimeFormatCondition,FilterValues:c.FilterValues,IsInclude:c.IsInclude,IsCheckAll:c.IsCheckAll,IsTopNApplied:c.IsTopNApplied,CheckAllState:c.CheckAllState,TopNFilterConditionInfo:c.TopNFilterConditionInfo,DateFormatInfo:BoldBIDashboard.isNullOrUndefined(c.DateFormatInfo)||c.DateFormatInfo.IsFilterApplied?c.DateFormatInfo:null},a.DateFilterSchemaInfo.DateFormatInfo=(a.ParameterInfo.IsParamApplied?c:a.DateFilterSchemaInfo).DateFormatInfo,o=!c.IsTopNApplied&&(c.IsCheckAll&&"date"!==c.DateAndTimeFormatCondition.toLowerCase()||BoldBIDashboard.isNullOrUndefined(a.DateFilterSchemaInfo.DateFormatInfo)&&"date"===c.DateAndTimeFormatCondition.toLowerCase()),o=a.ParameterInfo.IsParamApplied&&b.some(function(e){return e.value===c.DateAndTimeFormatCondition})?h.checkParamHasError(c.DateAndTimeFormatCondition,c.DateFormatInfo.DateFormatCondition,a.ParameterInfo.ParameterName,a.ParameterInfo.EndParameterName):o,h.updateHighlighter(s,o),o=a.CustomAttributeInfo.IsAttributeApplied&&b.some(function(e){return e.value===c.DateAndTimeFormatCondition})?h.checkAttributeHasError(c.DateAndTimeFormatCondition,c.DateFormatInfo.DateFormatCondition,a.CustomAttributeInfo.CustomAttributeName,a.CustomAttributeInfo.AttributeEndName):o)&&(u+="Select values to apply filter."),i=h.getOperatorTypeDropDown(t),a.OperatorType=BoldBIDashboard.isNullOrUndefined(i)||i.length<1?OperatorType.And:m.getOperatorTypeDropDown(t).data("BoldBIDashboardDropDownList").getSelectedValue(),a.Schema=n.schema,a.rowId=t,a.DataType=n.typeName,a.TableName=n.table,a.TableId=n.tableId,a.IsTypeCast=!d,a.TypeCastValue=d?"":n.typeCast,p.push(a),BoldBIDashboard.DashboardUtil.showErrIndictor(h.rootNode.find("#"+t+"_query_error_td"),o,u),o?g=!(u=""):BoldBIDashboard.DashboardUtil.showErrIndictor(h.rootNode.find("#"+t+"_query_error_td"),!1,u)}),{queryFilters:p,hasErrors:g}},e.prototype.checkParamHasError=function(t,e,i,a){var o=!BoldBIDashboard.isNullOrUndefined(e)&&("Between"===e||"NotBetween"===e);if("int"===t)return o?BoldBIDashboard.isNullOrUndefined(i)||""===i||BoldBIDashboard.isNullOrUndefined(a)||""===a:BoldBIDashboard.isNullOrUndefined(i)||""===i;if("string"===t)return BoldBIDashboard.isNullOrUndefined(i)||""===i;if("date"===t.toLowerCase()){if("Range"===e)return BoldBIDashboard.isNullOrUndefined(i)||""===i||BoldBIDashboard.isNullOrUndefined(a)||""===a;if("StartDate"===e)return BoldBIDashboard.isNullOrUndefined(i)||""===i;if("EndDate"===e)return BoldBIDashboard.isNullOrUndefined(a)||""===a}else if(this.dateTimeFormats.some(function(e){return e.value===t}))return BoldBIDashboard.isNullOrUndefined(i)||""===i;return!1},e.prototype.getInitialDashboardParamInfo=function(e){return{IsParamApplied:"Parameters"===e.SelectionType,ParameterName:e.ParameterName,EndParameterName:e.EndParameterName,RangeValueOfFirstParam:e.RangeValueOfFirstParam,RangeValueOfSecondtParam:e.RangeValueOfSecondtParam}},e.prototype.checkAttributeHasError=function(e,t,i,a){if("string"===e||"int"===e)return BoldBIDashboard.isNullOrUndefined(i)||""===i;if("date"===e.toLowerCase()){if("Range"===t)return BoldBIDashboard.isNullOrUndefined(i)||""===i||BoldBIDashboard.isNullOrUndefined(a)||""===a;if("StartDate"===t)return BoldBIDashboard.isNullOrUndefined(i)||""===i;if("EndDate"===t)return BoldBIDashboard.isNullOrUndefined(a)||""===a}return!1},e.prototype.getInitialDashboardAttributeInfo=function(e){return{IsAttributeApplied:"Custom Attributes"===e.SelectionType,CustomAttributeName:e.CustomAttributeName,AttributeEndName:e.AttributeEndName}},e.prototype.getRangeParamNames=function(e){return/.START/.test(e)?".START":/.END/.test(e)?".END":null},e.prototype.getIntVal=function(e){var t,i=[],a=this.getParamDropDownSelectionValue(e),o=this.getParamBtwDropDownSelectionValue(e),s=this.getAttributeDropDownSelectionValue(e),a=a.data("ParameterInfos"),o=o.data("ParameterInfos"),s=s.data("AttributeInfo"),n=null!=a?"Parameters":null!=s?"Custom Attributes":"Custom",r=this.getNullChkBx(e).data("BoldBIDashboardCheckBox").isChecked(),d=this.getOperatorDrpDwn(e,QueryDatatype.Int.toString()).data("BoldBIDashboardDropDownList").getSelectedValue(),l=this.getTxtValTag1(e,QueryDatatype.Int.toString()).val();return l="0.00"===l?0:l,t="0.00"===(t=d.toLowerCase()!==QueryOperator.Between.toString()&&d.toLowerCase()!==QueryOperator.NotBetween.toString()?t:this.getTxtValTag2(e,QueryDatatype.Int.toString()).val())?0:t,"in"===d.toLowerCase()||"notin"===d.toLowerCase()?l.toString().includes(",")?l.split(",").forEach(function(e){i.push(parseFloat(e))}):i.push(parseFloat(l)):(i.push(l),i.push(t)),{MeasureFilterCondition:d,FilterValues:i,IsIncludeNull:r,SelectionType:n,ParameterName:BoldBIDashboard.isNullOrUndefined(a)?null:a.Id,EndParameterName:BoldBIDashboard.isNullOrUndefined(o)?null:o.Id,RangeValueOfFirstParam:BoldBIDashboard.isNullOrUndefined(a)?null:this.getRangeParamNames(a.Name),RangeValueOfSecondtParam:BoldBIDashboard.isNullOrUndefined(o)?null:this.getRangeParamNames(o.Name),CustomAttributeName:BoldBIDashboard.isNullOrUndefined(s)?null:s.Name,AttributeEndName:null}},e.prototype.getDateVal=function(e){var t,i,a="",o="",s=null,n=null,r=null,d=null,l=null,h="",p="",c="",u="",b="",g=!1,m=this.getTopSwitcherTag(e,QueryDatatype.Date.toString()).is(":checked"),f=[],D=!1,y=!1,B=!0,s=this.getParamDropDownSelectionValue(e),I=this.getParameterStartDropDowm(e),x=this.getParameterEndDropDowm(e),x=BoldBIDashboard.isNullOrUndefined(s.data("ParameterInfos"))?BoldBIDashboard.isNullOrUndefined(I.data("ParameterInfos"))?BoldBIDashboard.isNullOrUndefined(x.data("ParameterInfos"))?null:x.data("ParameterInfos"):I.data("ParameterInfos"):s.data("ParameterInfos"),I=this.getAttributeDropDownSelectionValue(e),_=this.getAttributeDateDropDowm(e),v=this.getAttrEndDropDowm(e),v=BoldBIDashboard.isNullOrUndefined(I.data("AttributeInfo"))?BoldBIDashboard.isNullOrUndefined(_.data("AttributeInfos"))?BoldBIDashboard.isNullOrUndefined(v.data("AttributeInfos"))?null:v.data("AttributeInfos"):_.data("AttributeInfos"):I.data("AttributeInfo");return null!=x&&""==x.Name&&""==x.Id&&(x=null),null!=v&&""==v.Name&&""==v.Id&&(v=null),_=null!=x?"Parameters":null!=v?"Custom Attributes":"Custom",i=this.getOperatorDrpDwn(e,QueryDatatype.Date.toString()).data("BoldBIDashboardDropDownList").getSelectedValue(),c=(this.dateTimeFormats.some(function(e){return e.value===i})&&i.toLowerCase()!==QueryDatatype.Date.toString()?n=(s=this.getParamDropDownSelectionValue(e)).data("ParameterInfos"):(h=this.dashboardDesigner.element.find("#"+e+"_date_Start_param").data("ParameterInfos"),p=this.dashboardDesigner.element.find("#"+e+"_date_End_param").data("ParameterInfos"),u=this.dashboardDesigner.element.find("#"+e+"_date_Start_attr").data("AttributeInfos"),b=this.dashboardDesigner.element.find("#"+e+"_date_End_attr").data("AttributeInfos")),DateFormatOption.Range.toString()),i.toLowerCase()===QueryDatatype.Date.toString()?(a=(t=this.dateRangePopup.getDateRangeValues(e)).StartDate,o=t.EndDate,g=t.IsFilterApplied,c=t.DateFormatCondition,n=t.DateFormatCondition===DateFormatOption.Range.toString()||t.DateFormatCondition===DateFormatOption.StartDate.toString()?h:null,r=t.DateFormatCondition===DateFormatOption.Range.toString()||t.DateFormatCondition===DateFormatOption.EndDate.toString()?p:null,d=t.DateFormatCondition===DateFormatOption.Range.toString()||t.DateFormatCondition===DateFormatOption.StartDate.toString()?u:null,l=t.DateFormatCondition===DateFormatOption.Range.toString()||t.DateFormatCondition===DateFormatOption.EndDate.toString()?b:null):this.dateTimeFormats.some(function(e){return e.value===i})&&i.toLowerCase()!==QueryDatatype.Date.toString()&&(f=[],D=!0),"Custom"==_&&(t=this.multiSelectionComboBox.getMultiSelectionComboBox(e).parent().data("MultiSelectionComboBox").getPopupContainerInformationforQueryfilter(e),BoldBIDashboard.isNullOrUndefined(t)||(f=t.FilterValues,D=t.IsInclude,y=t.IsCheckAll,B=t.CheckAllState)),I=m?this.getTopNVal(e,QueryDatatype.Date.toString()):{},{DateAndTimeFormatCondition:i,IsInclude:D,FilterValues:f,IsCheckAll:y,CheckAllState:B,IsTopNApplied:m,TopNFilterConditionInfo:I,SelectionType:_,ParameterName:BoldBIDashboard.isNullOrUndefined(n)?null:n.Id,EndParameterName:BoldBIDashboard.isNullOrUndefined(r)?null:r.Id,StartParamFormat:"",EndParamFormat:"",RangeValueOfFirstParam:BoldBIDashboard.isNullOrUndefined(n)?null:this.getRangeParamNames(n.Name),RangeValueOfSecondtParam:BoldBIDashboard.isNullOrUndefined(r)?null:this.getRangeParamNames(r.Name),CustomAttributeName:BoldBIDashboard.isNullOrUndefined(v)?BoldBIDashboard.isNullOrUndefined(d)?null:d.Name:v.Name,AttributeEndName:BoldBIDashboard.isNullOrUndefined(l)?null:l.Name,DateFormatInfo:{DateFormatCondition:c,StartDate:a,EndDate:o,IsFilterApplied:g}}},e.prototype.getStringVal=function(e){var t,i=this.getOperatorDrpDwn(e,QueryDatatype.Char.toString()).data("BoldBIDashboardDropDownList").getSelectedValue(),a=[],o=!1,s=!1,n=!0,r=this.getTopSwitcherTag(e,QueryDatatype.Char.toString()).is(":checked"),d=this.getParamDropDownSelectionValue(e),l=this.getParamBtwDropDownSelectionValue(e),d=d.data("ParameterInfos"),l=l.data("ParameterInfos"),h=this.getAttributeDropDownSelectionValue(e).data("AttributeInfo"),p=null!=d?"Parameters":null!=h?"Custom Attributes":"Custom";return i.toLowerCase()===DimensionFilterCondition.Inclusion.toString().toLowerCase()?(t=this.multiSelectionComboBox.getMultiSelectionComboBox(e).parent().data("MultiSelectionComboBox").getPopupContainerInformationforQueryfilter(e),BoldBIDashboard.isNullOrUndefined(t)||(a=t.FilterValues,o=t.IsInclude,s=t.IsCheckAll,n=t.CheckAllState)):(t=this.getTxtValTag1(e,QueryDatatype.Char.toString()).val(),a.push(t)),{DimensionFilterCondition:i,FilterValues:a,TopNFilterConditionInfo:r?this.getTopNVal(e,QueryDatatype.Char.toString()):{},IsInclude:o,IsCheckAll:s,IsTopNApplied:r,CheckAllState:n,SelectionType:p,ParameterName:BoldBIDashboard.isNullOrUndefined(d)?null:d.Id,EndParameterName:BoldBIDashboard.isNullOrUndefined(l)?null:l.Id,RangeValueOfFirstParam:BoldBIDashboard.isNullOrUndefined(d)?null:this.getRangeParamNames(d.Name),RangeValueOfSecondtParam:BoldBIDashboard.isNullOrUndefined(l)?null:this.getRangeParamNames(l.Name),CustomAttributeName:BoldBIDashboard.isNullOrUndefined(h)?null:h.Name,AttributeEndName:null,AttributeEndValue:null}},e.prototype.getBoolVal=function(e){var t=this.getChkBx1(e).data("BoldBIDashboardCheckBox"),i=this.getChkBx2(e).data("BoldBIDashboardCheckBox"),a=this.getChkBx3(e).data("BoldBIDashboardCheckBox"),o=this.getTopSwitcherTag(e,QueryDatatype.Bool.toString()).is(":checked"),e=o?this.getTopNVal(e,QueryDatatype.Bool.toString()):{};return{IsNullEnabled:t.isChecked(),IsTrueEnabled:i.isChecked(),TopNFilterConditionInfo:e,IsFalseEnabled:a.isChecked(),IsTopNApplied:o}},e.prototype.getTopNVal=function(e,t){var i=this.getTopColumnItem(e,t).data("BoldBIDashboardDropDownList").getSelectedItem(),a=this.getTopModeItem(e,t).data("BoldBIDashboardDropDownList").getSelectedValue(),o=this.getTopCountItem(e,t).val(),i=this.bbdesigner$(i).text(),s=this.getTopColumnItem(e,t).data("BoldBIDashboardDropDownList").getSelectedValue(),n=this.getTopSummaryItem(e,t).data("BoldBIDashboardDropDownList").getSelectedValue(),r=this.getTopDateTimeItem(e,t).data("BoldBIDashboardCheckBox").isChecked(),e=this.getTopFormatItem(e,t).data("BoldBIDashboardDropDownList").getSelectedValue();return{TopNCondition:"Top"===a?FilterRange.Top:FilterRange.Bottom,NumberOfItems:o,ColumnName:i,ColumnId:s,SummaryType:n,IsFormatAppliedForDateField:r,DateAndTimeFormat:e}},e.prototype.saveQueryFilter=function(){var e=this.getQueryFilter();this.paramNameList=[],e.hasErrors||this.multiSelectionComboBox.isMultiSelectionPopupLoading()||(BoldBIDashboard.DashboardUtil.isEqualObj(this.queryFilters,e.queryFilters)&&!InternalMultiSelectionComboBox.isFilterValueUpdated||(this.queryDesigner.queryFilter=e.queryFilters,this.queryDesigner.isInitialFilterApplied=!0,this.queryDesigner.executeUIQuery(),this.queryDesigner.isInitialFilterApplied=!1,InternalMultiSelectionComboBox.isFilterValueUpdated=!1),this.closeDialog())},e.prototype.renderCodeSwitcher=function(e,t,i){var a=BoldBIDashboard.buildTag("div","",{display:"block",width:"89px"},{id:e+"_query_"+i+"_switcherDiv"}),o=BoldBIDashboard.buildTag("span.bbi-designer-label","TOP N",{display:"inline-block",float:"left","line-height":"normal","margin-right":"7px","margin-top":"2px",cursor:"default"}),s=BoldBIDashboard.buildTag("label.bbi-designer-switch","",{display:"inline-block",float:"left"},{id:e+"_query_"+i+"_chkSwitcher"}),n=this.bbdesigner$("<input type='checkbox' id="+e+i+"_chck_on checked>");s.append(n),s.append("<div style='cursor:pointer;' class='bbi-designer-slider round'/>"),n.prop("checked",!1),a.append(o),a.append(s),t.append(a),n.bind("change",this.bbdesigner$.proxy(this.onSwitcherChange,this,e,i))},e.prototype.onSwitcherChange=function(e,t){t=this.rootNode.find("#"+e+t+"_chck_on").is(":checked")?"table-row":"none";this.rootNode.find("#"+e+"_tr_top").css("display",t),this.rootNode.find("#"+e+" .e-error-tip").css("display","none"),this.scrollerRefresh(this.parentDiv)},e.prototype.renderTopFields=function(e,t){var i,a=this.rootNode.find("#"+e+"_queryFilter_topDiv"),o=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),s=BoldBIDashboard.buildTag("tr","",{},{}),a=(a.append(o),o.append(s),BoldBIDashboard.buildTag("td","",{padding:"0px 5px 0px 10px",width:"130px"},{})),o=BoldBIDashboard.buildTag("td","",{padding:"0px 5px",width:"90px"},{}),n=BoldBIDashboard.buildTag("td","",{padding:"0px 5px",width:"130px"},{}),r=BoldBIDashboard.buildTag("td","",{"padding-left":"5px",display:"none"},{id:e+"_query_"+t+"_checkBox_cell"}),d=BoldBIDashboard.buildTag("td","",{padding:"0px 5px"},{id:e+"_query_"+t+"_format_cell"});s.append(a).append(o).append(n).append(r).append(d),s=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{width:"130px"},{type:"text",id:e+"_query_"+t+"_top_mode"}),a.append(s),a=BoldBIDashboard.buildTag("input","",{width:"90px"},{type:"text",id:e+"_query_"+t+"_top_count"}),o.append(a),o=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{width:"130px"},{type:"text",id:e+"_query_"+t+"_top_column"}),n.append(o),n=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:e+"_query_"+t+"_top_datetime"}),i=BoldBIDashboard.buildTag("label","Format",{"margin-left":"10px"},{for:e+"_query_"+t+"_top_datetime"}),r.append(n).append(i),r=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{width:"130px"},{type:"text",id:e+"_query_"+t+"_top_summary"}),i=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{width:"130px"},{type:"text",id:e+"_query_"+t+"_top_format"}),d.append(r).append(i),s.BoldBIDashboardDropDownList({width:"130px",dataSource:this.modeTypes,fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),a.ejNumericTextbox({showSpinButton:!1,decimalPlaces:0,value:5,minValue:1,maxValue:1e10,showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",width:"90px"}),o.BoldBIDashboardDropDownList({width:"130px",dataSource:this.dataFields,fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateTopColumnState,this,e,t)}),n.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateFormatValidation,this,e,t)}),r.BoldBIDashboardDropDownList({width:"130px",dataSource:this.dimensionFormats,fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),i.BoldBIDashboardDropDownList({width:"130px",dataSource:this.dateTimeformatforTopN,fields:{text:"text",value:"value"},selectedIndex:0,enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control"}),o.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.rootNode.find("#"+e+"_query_"+t+"_top_format_wrapper").css("display","none")},e.prototype.renderNullField=function(e,t){var i=BoldBIDashboard.buildTag("td","",{width:"91px","padding-bottom":"5px"},{id:e+"_query_int_null"}),a=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:e+"_queryint_nullChkbx"}),o=BoldBIDashboard.buildTag("Label","Include Null",{"padding-left":"8px","font-size":"12px","font-weight":"600","vertical-align":"middle"},{type:"checkbox",id:e+"_queryint_nullChkbx"});t.append(i),i.append(a),i.append(o),a.BoldBIDashboardCheckBox({checked:!1,cssClass:"bbi-designer-param-assign",change:this.bbdesigner$.proxy(this.onNullCheck,this,e)})},e.prototype.getTopModeItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_mode")},e.prototype.getTopCountItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_count")},e.prototype.getTopColumnItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_column")},e.prototype.getTopDateTimeItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_datetime")},e.prototype.getTopSummaryItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_summary")},e.prototype.getTopFormatItem=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_top_format")},e.prototype.getCheckBoxCell=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_checkBox_cell")},e.prototype.getFormatCell=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_format_cell")},e.prototype.updateFormatValidation=function(e,t,i){var a=this.rootNode.find("#"+e+"_query_"+t+"_top_summary_wrapper"),e=this.rootNode.find("#"+e+"_query_"+t+"_top_format_wrapper");i.isChecked?(e.css("display","block"),a.css("display","none")):(e.css("display","none"),a.css("display","block"))},e.prototype.updateTopColumnState=function(e,t,i){var a=this.getTopSummaryItem(e,t),o=this.rootNode.find("#"+e+"_query_"+t+"_top_format_wrapper"),i=this.getSelectedItem(i.value),s=i.typeName,s=BoldBIDashboard.isNullOrUndefined(i.typeCast)||0===i.typeCast.length||this.isDefaultCast(i.typeCast)?s:i.typeCast;this.isDate(s)?(this.getCheckBoxCell(e,t).css({display:"block","padding-top":"3px"}),i=this.getTopDateTimeItem(e,t).data("BoldBIDashboardCheckBox").model.checked,this.rootNode.find("#"+e+"_query_"+t+"_top_summary_wrapper").css("display",i?"none":"block"),o.css("display",i?"block":"none"),i||(a.data("BoldBIDashboardDropDownList").setModel({dataSource:i?this.dateTimeformatforTopN:this.dimensionFormats}),a.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}))):(this.getCheckBoxCell(e,t).css("display","none"),a.data("BoldBIDashboardDropDownList").setModel({dataSource:this.isNumber(s)?this.measureFormats:this.dimensionFormats}),a.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}),this.rootNode.find("#"+e+"_query_"+t+"_top_summary_wrapper").css("display","block"),o.css("display","none"))},e.prototype.getTableData=function(e,t){for(var i=0;i<e.length;i++)if(this.bbdesigner$(e[i]).data("e-table").name===t)return this.bbdesigner$(e[i]);return this.bbdesigner$(e[0])},e.prototype.getAvailableDataFields=function(){for(var e,t,i,a,o=this.queryDesigner.element.find("#"+this.id+"_div_dragSurface .bbi-data-table"),s=[],n=0;n<this.queryDesigner.tableType.length;n++)"UnSupport"!==this.queryDesigner.tableType[n].DataType&&(a=this.getTableData(o,this.queryDesigner.tableType[n].TableName),e=this.bbdesigner$(a).data("e-table"),t=this.queryDesigner.tableType[n].DataType,i=BoldBIDashboard.DashboardUtil.escapeSelector(this.queryDesigner.tableType[n].Name),a=this.bbdesigner$(a).find("#"+this.id+"_li_"+i).attr("e-column-type"),"geography"!==t)&&"hierarchyid"!==t&&"xml"!==t&&s.push({text:this.queryDesigner.tableType[n].Name,value:this.queryDesigner.tableType[n].ID,columnName:this.queryDesigner.tableType[n].Name,typeName:this.getTypeName(t),table:e.name,schema:e.schema,typeCast:a,tableId:this.queryDesigner.tableType[n].TableId});return s},e.prototype.getTypeName=function(e){e=e.toLowerCase();return"int"===e||"integer"===e?"System.Int32":"nchar"===e||"ntext"===e||"nvarchar"===e||"text"===e||"varchar"===e||"char"===e||"string"===e?"System.String":"decimal"===e||"money"===e||"smallmoney"===e||"numeric"===e?"System.Decimal":"float"===e?"System.Double":"smallint"===e?"System.Int16":"bigint"===e?"System.Int64":"real"===e?"System.Single":"tinyint"===e?"System.Byte":"uniqueidentifier"===e?"System.Guid":"datetime"===e||"datetime2"===e||"smalldatetime"===e||"date"===e?"System.DateTime":"datetimeoffset"===e?"System.DateTimeOffset":"bit"===e||"boolean"===e?"System.Boolean":"timestamp"!==e&&"time"===e?"System.TimeSpan":void 0},e.prototype.getCurrentIndex=function(){var e=this.rootNode.find("#"+this.id+"_query_container_div .bbi-designer-query-row");return!(0<e.length)||(e=this.rootNode.find("#"+this.id+"_query_container_div .bbi-designer-query-row")[e.length-1].id,(e=this.getDrpDwn1(e).data("BoldBIDashboardDropDownList").option("selectedIndex"))>=this.dataFields.length-1)?0:e+1},e.prototype.getSelectedItem=function(e){for(var t=0;t<this.dataFields.length;t++)if(e===this.dataFields[t].value)return this.dataFields[t]},e.prototype.getSelectedValue=function(e){for(var t=0;t<this.dataFields.length;t++)if(e===this.dataFields[t].text)return this.dataFields[t]},e.prototype.getSelectedAttributeValue=function(e){for(var t=0;t<this.customAttributesList.length;t++)if(e===this.customAttributesList[t].text)return t},e.prototype.setItemDataSource=function(){this.dateTimeFormats=[{value:"Year",text:"Year"},{value:"Quarter",text:"Quarter"},{value:"Month",text:"Month"},{value:"MonthYear",text:"Month Year"},{value:"WeekYear",text:"Week Year"},{value:"QuarterYear",text:"Quarter Year"},{value:"DayMonthYear",text:"Day Month Year"},{value:"MonthDayYear",text:"Month Day Year"},{value:"DateHour",text:"Date Hour"},{value:"DayOfWeek",text:"Day of Week"},{value:"WeekOfYear",text:"Week of Year"},{value:"Day",text:"Day"},{value:"Hour",text:"Hours"},{value:"Minute",text:"Minutes"},{value:"Second",text:"Seconds"},{value:"Time",text:"Time"},{value:"Date",text:"Date"}],this.dateTimeformatforTopN=this.getDateTimeFormatsForTopN(),this.dimensionFormats=[{value:"COUNT",text:"Count"},{value:"COUNTD",text:"Distinct Count"}],this.measureFormats=[{value:"SUM",text:"Sum"},{value:"COUNT",text:"Count"},{value:"COUNTD",text:"Distinct Count"},{value:"MAX",text:"Max"},{value:"MIN",text:"Min"},{value:"AVG",text:"Avg"},{value:"NONE",text:"None"}],this.modeTypes=[{value:"Top",text:"Top"},{value:"Bottom",text:"Bottom"}],this.operatorTypes=[{value:"And",text:"AND"},{value:"Or",text:"OR"}]},e.prototype.getDateTimeFormatsForTopN=function(){var e=[];return e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Date],text:DateTimeFormatForFilter.Date}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DateTime],text:DateTimeFormatForFilter.DateTime}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Year],text:DateTimeFormatForFilter.Year}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Quarter],text:DateTimeFormatForFilter.Quarter}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Month],text:DateTimeFormatForFilter.Month}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.QuarterYear],text:DateTimeFormatForFilter.QuarterYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.MonthYear],text:DateTimeFormatForFilter.MonthYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekYear],text:DateTimeFormatForFilter.WeekYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.DayOfWeek],text:DateTimeFormatForFilter.DayOfWeek}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.WeekOfYear],text:DateTimeFormatForFilter.WeekOfYear}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Day],text:DateTimeFormatForFilter.Day}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Hour],text:DateTimeFormatForFilter.Hour}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Minute],text:DateTimeFormatForFilter.Minute}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Second],text:DateTimeFormatForFilter.Second}),e.push({value:DateTimeFormatForFilter[DateTimeFormatForFilter.Time],text:DateTimeFormatForFilter.Time}),e},e.prototype.getOperatorsList=function(e){return e.toLowerCase()===QueryDatatype.Date.toString()?[{text:"Inclusion",value:"Inclusion"},{text:"Equals",value:"Equals"},{text:"Does Not Equals",value:"DoesNotEquals"},{text:"Greater Than",value:"GreaterThan"},{text:"Greater Than Or Equal To",value:"GreaterThanOrEqualTo"},{text:"Less Than",value:"LessThan"},{text:"Less Than Or Equal To",value:"LessThanOrEqualTo"},{text:"Between",value:"Between"},{text:"Not Between",value:"NotBetween"}]:e.toLowerCase()===QueryDatatype.Int.toString()?[{text:"IN",value:"In"},{text:"Equals",value:"Equals"},{text:"Does Not Equals",value:"DoesNotEquals"},{text:"Greater Than",value:"GreaterThan"},{text:"Greater Than Or Equal To",value:"GreaterThanOrEqualTo"},{text:"Less Than",value:"LessThan"},{text:"Less Than Or Equal To",value:"LessThanOrEqualTo"},{text:"Between",value:"Between"},{text:"Not Between",value:"NotBetween"},{text:"Not IN",value:"NotIn"}]:e.toLowerCase()===QueryDatatype.Char.toString()?[{text:"Inclusion",value:"Inclusion"},{text:"Starts With",value:"StartsWith"},{text:"Ends With",value:"EndsWith"},{text:"Contains",value:"Contains"},{text:"Not Contains",value:"NotContains"}]:void 0},e.prototype.isNumber=function(e){return"System.Int32"===e||"System.Int16"===e||"System.Int64"===e||"System.Double"===e||"System.Single"===e||"System.Decimal"===e||"System.Byte"===e||"Number"===e||"integer"===e.toLowerCase()||"real"===e.toLowerCase()},e.prototype.isString=function(e){return"System.Guid"===e||"System.String"===e||"Text"===e||"string"===e.toLowerCase()},e.prototype.isDate=function(e){return"System.DateTimeOffset"===e||"System.DateTime"===e||"DateTime"===e||"date"===e.toLowerCase()},e.prototype.isBoolean=function(e){return"System.Boolean"===e||"bit"===e||"boolean"===e.toLowerCase()},e.prototype.isDefaultCast=function(e){return"default(boolean)"===e.toLowerCase()||"default(integer)"===e.toLowerCase()||"default(string)"===e.toLowerCase()||"default(datetime)"===e.toLowerCase()},e.prototype.getChkBx1=function(e){return this.rootNode.find("#"+e+"_query_bool_chkbx1")},e.prototype.getChkBx2=function(e){return this.rootNode.find("#"+e+"_query_bool_chkbx2")},e.prototype.getChkBx3=function(e){return this.rootNode.find("#"+e+"_query_bool_chkbx3")},e.prototype.getNullChkBx=function(e){return this.rootNode.find("#"+e+"_queryint_nullChkbx")},e.prototype.getDrpDwn1=function(e){return this.rootNode.find("#"+e+"_query_filter_field")},e.prototype.getOperatorTypeDropDown=function(e){return this.rootNode.find("#"+e+"_query_operator_type")},e.prototype.getOperatorDrpDwn=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_operator")},e.prototype.getTxtColTag1=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_txtcol1")},e.prototype.getTxtValTag1=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_txtVal1")},e.prototype.getDateColumnTag=function(e){return this.rootNode.find("#"+e+"_query_date_pickcol")},e.prototype.getTxtColTag2=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_txtcol2")},e.prototype.getTxtValTag2=function(e,t){return this.rootNode.find("#"+e+"_query_"+t+"_txtVal2")},e.prototype.getTopSwitcherTag=function(e,t){return this.rootNode.find("#"+e+t+"_chck_on")},e.prototype.getNullTxtBxTag=function(e){return this.rootNode.find("#"+e+"_query_null_txt")},e.prototype.getDateRangeDrpDwn=function(e){return this.dashboardDesigner.element.find("#"+e+"_dateRange_multidDrpDwn")},e.prototype.getParamBtwDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_param_btw")},e.prototype.getParameterValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_param_elements")},e.prototype.getParamDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_param")},e.prototype.getParameterDropDown=function(e,t){return this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_parameter_dropdown")},e.prototype.getAttributeDropDown=function(e){return this.dashboardDesigner.element.find("#"+e+"_attribute")},e.prototype.getStartAttrDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_query_date_Start_attr_dropdown")},e.prototype.getEndAttrDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_query_date_End_attr_dropdown")},e.prototype.getAttributeDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_attribute")},e.prototype.getAttributeDateDropDowm=function(e){return this.dashboardDesigner.element.find("#"+e+"_date_Start_attr")},e.prototype.getAttrEndDropDowm=function(e){return this.dashboardDesigner.element.find("#"+e+"_date_End_attr")},e.prototype.getParameterStartDropDowm=function(e){return this.dashboardDesigner.element.find("#"+e+"_date_Start_param")},e.prototype.getParameterEndDropDowm=function(e){return this.dashboardDesigner.element.find("#"+e+"_date_End_param")},e.prototype.getParameterBtwDropDown=function(e,t){return this.dashboardDesigner.element.find("#"+e+"_query_"+t+"_parameter_dropdown_btw")},e.prototype.getStartParamDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_query_date_Start_parameter_dropdown")},e.prototype.getEndParamDropDownSelectionValue=function(e){return this.dashboardDesigner.element.find("#"+e+"_query_date_End_parameter_dropdown")},e.prototype.getMultiSelectionComboBox=function(e){return this.rootNode.find("#"+e+"_multi_select_dropDown")},e.prototype.getMeasureType=function(e){switch(e.toLowerCase()){case"doesnotequals":return MeasureFilterCondition.DoesNotEquals;case"greaterthan":return MeasureFilterCondition.GreaterThan;case"greaterthanorequalto":return MeasureFilterCondition.GreaterThanOrEqualTo;case"lessthan":return MeasureFilterCondition.LessThan;case"lessthanorequalto":return MeasureFilterCondition.LessThanOrEqualTo;case"between":return MeasureFilterCondition.Between;case"notbetween":return MeasureFilterCondition.NotBetween;default:return MeasureFilterCondition.Equals}},e.prototype.DateFormatOption=function(e){switch(e.toLowerCase()){case"startdate":return DateFormatOption.StartDate;case"enddate":return DateFormatOption.EndDate;default:return DateFormatOption.Range}},e.prototype.getValidParameter=function(e,t){for(var i=e,a=e,o=0,s=0;s<t.length;s++)t[s]==="@"+a&&this.isExistParameter(a=i+(o+=1),t)&&this.getValidParameter(a=i+ ++o,t);return a},e.prototype.isExistParameter=function(e,t){for(var i=0;i<t.length;i++)if(t[i]==="@"+e)return!0;return!1},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.QueryFilter",InternalQueryFilter,window),function(e){e[e.Between="between"]="Between",e[e.NotBetween="notbetween"]="NotBetween"}(QueryOperator=QueryOperator||{}),function(e){e[e.Int="int"]="Int",e[e.Date="date"]="Date",e[e.Bool="bool"]="Bool",e[e.Char="string"]="Char"}(QueryDatatype=QueryDatatype||{}),function(e){e[e.Equals="Equals"]="Equals",e[e.DoesNotEquals="DoesNotEquals"]="DoesNotEquals",e[e.GreaterThan="GreaterThan"]="GreaterThan",e[e.GreaterThanOrEqualTo="GreaterThanOrEqualTo"]="GreaterThanOrEqualTo",e[e.LessThan="LessThan"]="LessThan",e[e.LessThanOrEqualTo="LessThanOrEqualTo"]="LessThanOrEqualTo",e[e.Between="Between"]="Between",e[e.NotBetween="NotBetween"]="NotBetween",e[e.In="In"]="In",e[e.NotIn="NotIn"]="NotIn"}(MeasureFilterCondition=MeasureFilterCondition||{}),function(e){e[e.Inclusion="Inclusion"]="Inclusion",e[e.StartsWith="StartsWith"]="StartsWith",e[e.EndsWith="EndsWith"]="EndsWith",e[e.Contains="Contains"]="Contains",e[e.NotContains="NotContains"]="NotContains"}(DimensionFilterCondition=DimensionFilterCondition||{}),InternalQueryJoiner=function(){function e(e){this.dashboardDesigner=null,this.id=null,this.availableTables=null,this.container=null,this.fieldtd=null,this.contentDiv=null,this.joinEditor=null,this.footerTag=null,this.prevValue=null,this.successDiv=null,this.failureDiv=null,this.ejScrollerDiv=null,this.ejJoinerDialog=null,this.ejJoinerWaitingPopup=null,this.locale=null,this.expressionTable=null,this.temproryId=null,this.operator=null,this.functionalOperator=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.id=this.queryDesigner.id,this.renderJoinEditor()}return e.prototype.renderJoinEditor=function(){var e=this.joinEditor=BoldBIDashboard.buildTag("div.bbi-userselect","",{display:"none"},{title:this.locale.alertDialogTitle.queryJoiner,id:this.id+"_Join_Dialog"}),t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_query_joiner_indicator_div"}),i=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_query_joiner_content_div"}),a=this.successDiv=BoldBIDashboard.buildTag("div","",{width:"auto",height:"371px",display:"block"},{id:this.id+"_query_joiner_success_div"}),o=this.failureDiv=BoldBIDashboard.buildTag("div","",{width:"682px",height:"371px",display:"none"},{id:this.id+"_query_joiner_failure_div"}),s=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_query_joiner_table_id"}),n=BoldBIDashboard.buildTag("table","",{width:"97%","border-bottom":"1px solid #c8c8c8",margin:"0.5em 12px","padding-bottom":"5px"},{unselectable:"on"}),r=BoldBIDashboard.buildTag("tr","",{"padding-top":"10px"},{}),d=BoldBIDashboard.buildTag("td","",{width:"92%"},{}),l=BoldBIDashboard.buildTag("Label.bbi-designer-add-label",this.locale.queryJoiner.tableRelations,{},{type:"label"}),h=this.container=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{margin:"4px 0px",padding:"5px 0px",height:"320px",width:"692px","padding-left":"12px"},{id:this.id+"_query_joiner_container_div"}),p=this.contentDiv=BoldBIDashboard.buildTag("div.e-items","",{},{id:this.id+"_query_joiner_content_div"}),c=BoldBIDashboard.buildTag("button.e-btn-close bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.queryJoiner.close,{float:"right"},{id:this.id+"_btn_cancel",type:"button"}),u=BoldBIDashboard.buildTag("button.e-btn-save bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.queryJoiner.merge,{float:"right"},{id:this.id+"_btn_save",type:"button"});a.append(s),s.append(n),n.append(r),r.append(d),d.append(l),a.append(h),h.append(p),i.append(a,o),t.append(i),e.append(t),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({minWidth:710,width:"auto",height:"auto",target:"#"+this.id,showFooter:!0,enableResize:!1,showOnInit:!1,enableModal:!0,containment:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.closeJoinDialog,this),beforeClose:this.bbdesigner$.proxy(this.onDialogClose,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog_foot"),this.footerTag.append(c,u),u.on("click",this.bbdesigner$.proxy(this.saveJoinQuery,this,!0)),c.on("click",this.bbdesigner$.proxy(this.cancelJoinDialog,this,!0)),h.BoldBIDashboardScroller({height:"320px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),this.ejJoinerDialog=e.data("BoldBIDashboardDialog"),this.ejScrollerDiv=h.data("BoldBIDashboardScroller"),this.ejJoinerWaitingPopup=t.data("BoldBIDashboardWaitingPopup")},e.prototype.addNewQueryJoiner=function(e,t){var i,a,o=BoldBIDashboard.getGuid(this.id+"_row_"),s=!!(t&&t.join&&t.rightTable),e=!BoldBIDashboard.isNullOrUndefined(e)&&e,n=this.contentDiv.find(".bbi-designer-joiner-row").length+1,r=BoldBIDashboard.buildTag("div.bbi-designer-joiner-row e-drag-row","",{padding:"4px"},{unselectable:"on",id:o,rowId:o,joinIndex:n}),d=BoldBIDashboard.buildTag("table.bbi-designer-table-dialog","",{width:"100%","border-radius":"4px",border:"1px solid #eee"},{unselectable:"on",id:o+"_joiner_container_table"}),l=BoldBIDashboard.buildTag("tr","",{height:"36px"},{id:o+"_joiner_rowTag"}),h=BoldBIDashboard.buildTag("td","",{width:"170px","padding-left":"8px",display:e?"none":"table-cell"},{}),p=BoldBIDashboard.buildTag("input"+(e?"":".e-joiner-tab-dropdown"),"",{padding:"1px"},{type:"text",id:o+"_joiner_left_tab",value:o,joinIndex:n}),c=BoldBIDashboard.buildTag("td","",{width:"170px","padding-left":e?"8px":"10px"},{}),u=this.operator=BoldBIDashboard.buildTag("input .e-joiner-type-tab-dropdown","",{padding:"1px"},{type:"text",id:o+"_joiner_type"}),b=BoldBIDashboard.buildTag("td","",{width:"170px","padding-left":"10px"},{}),n=BoldBIDashboard.buildTag("input.e-joiner-tab-dropdown","",{height:"23px",width:"120px",padding:"1px"},{type:"text",id:o+"_joiner_right_tab",joinIndex:n}),g=BoldBIDashboard.buildTag("td","",{width:e?"265px":"95px"},{}),m=BoldBIDashboard.buildTag("tr","",{display:"table-row"},{id:o+"_tr_field"}),f=this.fieldtd=BoldBIDashboard.buildTag("td","",{height:"4px"},{id:o+"_td_edit_field",colspan:"7"}),D=BoldBIDashboard.buildTag("div","",{"margin-top":"4px",height:"auto",width:"100%"},{id:o+"_query_joiner_field_div"});if(this.contentDiv.append(r),r.append(d),d.append(l),l.append(h,c,b,g),h.append(p),c.append(u),b.append(n),d.append(m),m.append(f),f.append(D),p.BoldBIDashboardDropDownList({showRoundedCorner:!0,enableFilterSearch:!0,width:"100%",watermarkText:"Left Table",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"id",text:"text",value:"id"},dataSource:this.tables,change:this.bbdesigner$.proxy(this.changeEqualTable,this,{rowId:o,identity:"left"}),beforePopupShown:this.bbdesigner$.proxy(this.updatePreviousValue,this,{rowId:o,identity:"left"})}),n.BoldBIDashboardDropDownList({showRoundedCorner:!0,enableFilterSearch:!0,width:"100%",watermarkText:"Right Table",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"id",text:"text",value:"id"},dataSource:this.tables,change:this.bbdesigner$.proxy(this.changeEqualTable,this,{rowId:o,identity:"right"}),beforePopupShown:this.bbdesigner$.proxy(this.updatePreviousValue,this,{rowId:o,identity:"right"})}),u.BoldBIDashboardDropDownList({showRoundedCorner:!0,width:"100%",watermarkText:"Join Type",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"field",text:"field",value:"field"},dataSource:this.getJoinData(),change:this.bbdesigner$.proxy(this.conditionUI,this,{rowId:o,identity:"type"}),beforePopupShown:this.bbdesigner$.proxy(this.updatePreviousValue,this,{rowId:o,identity:"type"})}),this.renderConditionArea(o,D),s){if(e||p.data("BoldBIDashboardDropDownList").selectItemByIndex(this.getSelectedIndex(o+"_joiner_left_tab",t.leftTable)),n.data("BoldBIDashboardDropDownList").selectItemByIndex(this.getSelectedIndex(o+"_joiner_right_tab",t.rightTable)),t&&t.fields&&0<t.fields.length)for(i=0;i<t.fields.length;i++)a={leftTable:t.leftTable,rightTable:t.rightTable,field:t.fields[i]},this.renderTabFields(o,D,a,!1);u.data("BoldBIDashboardDropDownList").selectItemByValue(t.join)}else BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(t.rightTable)||(e||p.data("BoldBIDashboardDropDownList").selectItemByIndex(0),n.data("BoldBIDashboardDropDownList").selectItemByIndex(this.getSelectedIndex(o+"_joiner_right_tab",t.rightTable)),u.data("BoldBIDashboardDropDownList").selectItemByValue("Inner")),this.renderTabFields(o,D,null,!1);return this.ejScrollerDiv&&this.ejScrollerDiv.refresh(!0),o},e.prototype.getSelectedIndex=function(e,t){for(var i=this.contentDiv.find("#"+e).data("BoldBIDashboardDropDownList").getListData(),a=0;a<i.length;a++)if(i[a].fieldId===t)return a;return 0},e.prototype.disableDeleteBtn=function(e){this.contentDiv.find("#"+e+"_field_delete").css("visibility","hidden")},e.prototype.enableDeleteBtn=function(e){this.contentDiv.find("#"+e+"_field_delete").css("visibility","visible")},e.prototype.deleteJoinFields=function(e){1===this.contentDiv.find("#"+e.parentId+" .bbi-designer-joiner-field").length?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.dataSource.joinerErr,IconType.warning,AlertType.Alert,!1,""):(this.contentDiv.find("#"+e.id+"_field").remove(),this.contentDiv.find("#"+e.id+"_joiner_logical_div").remove(),this.ejScrollerDiv.refresh(!0))},e.prototype.renderTabFields=function(e,t,i,a){var o=BoldBIDashboard.getGuid(e+"_"),s=!0,n=(0<this.contentDiv.find("#"+e+" .e-default-field").length&&(s=!1),BoldBIDashboard.buildTag("div.bbi-designer-joiner-field"+(s?" e-default-field":""),"",{padding:"4px 2px 4px 15px"},{unselectable:"on",id:o+"_field","e-rowId":o})),r=BoldBIDashboard.buildTag("table","",{width:"100%","background-color":"white"},{unselectable:"on",id:o+"_field_table"}),d=BoldBIDashboard.buildTag("tr","",{},{id:o+"_field_rowTag"}),l=BoldBIDashboard.buildTag("td","",{width:"100px"},{}),h=BoldBIDashboard.buildTag("input.e-left","",{padding:"1px"},{type:"text",id:o+"_field_left"}),p=BoldBIDashboard.buildTag("td","",{width:"80px","padding-left":"10px"},{}),c=this.functionalOperator=BoldBIDashboard.buildTag("input.e-operator","",{padding:"1px"},{type:"text",id:o+"_field_type"}),u=BoldBIDashboard.buildTag("td","",{width:"100px","padding-left":"10px"},{}),b=BoldBIDashboard.buildTag("input.e-right","",{height:"23px",width:"100%",padding:"1px"},{type:"text",id:o+"_field_right"}),g=BoldBIDashboard.buildTag("td","",{width:"70px"},{}),m=BoldBIDashboard.buildTag("div","",{visibility:"visible",width:"100%"},{id:o+"_field_checkbox_div"}),f=BoldBIDashboard.buildTag("input.e-joiner-checkbox","",{padding:"1px"},{type:"checkbox",id:o+"_field_checkbox"}),D=BoldBIDashboard.buildTag("label.bbi-designer-fontfamily",this.locale.queryJoiner.valueLabelText,{"font-size":"12px","padding-left":"6px","text-overflow":"ellipsis"},{for:o+"_field_checkbox",type:"label"}),y=BoldBIDashboard.buildTag("td","",{width:"100px"},{}),B=BoldBIDashboard.buildTag("div","",{visibility:"hidden"},{id:o+"_field_valueAutocomplete_div"}),I=BoldBIDashboard.buildTag("input","",{width:"100%"},{id:o+"_field_valueAutocomplete",spellcheck:"false"}),x=BoldBIDashboard.buildTag("td","",{"padding-top":"3px",width:"10px"},{}),_=BoldBIDashboard.buildTag("span.bbi-dbrd-designer-hand-cursor e-icon"+(s?" e-disable":" e-close_01"),"",{cursor:"default",float:"right",visibility:"hidden",color:"#4D4D4D"},{id:o+"_field_delete"});n.insertBefore(this.contentDiv.find("#"+e+" .e-designer-joiner-condition")),s||(this.renderLogicalCondition(o,n,i),_.bind("click",this.bbdesigner$.proxy(this.deleteJoinFields,this,{id:o,parentId:e}))),n.append(r),r.append(d),d.append(l,p,u,g,y,x),l.append(h),p.append(c),u.append(b),x.append(_),g.append(m),m.append(f,D),y.append(B),B.append(I),d.bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseOver,this.bbdesigner$.proxy(this.enableDeleteBtn,this,o)),d.bind(BoldBIDashboard.DashboardUtil.MouseEvent.mouseLeave,this.bbdesigner$.proxy(this.disableDeleteBtn,this,o)),b.BoldBIDashboardDropDownList({showRoundedCorner:!0,enableFilterSearch:!0,width:"100%",watermarkText:"Right Field",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"fieldId",text:"field",value:"fieldId",category:"pid"},dataSource:[]}),h.BoldBIDashboardDropDownList({showRoundedCorner:!0,enableFilterSearch:!0,width:"100%",watermarkText:"Left Field",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"fieldId",text:"field",value:"fieldId",category:"pid"},dataSource:[],change:this.bbdesigner$.proxy(this.changeFieldLeftValue,this,o)}),c.BoldBIDashboardDropDownList({showRoundedCorner:!0,width:"100%",watermarkText:"Operator",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.conditionUI,this,{rowId:o,identity:"type"}),fields:{id:"field",text:"field",value:"field"},dataSource:this.getOperator()}),f.BoldBIDashboardCheckBox({checked:!1,width:"35px",cssClass:"bbi-designer-joiner-value",change:this.bbdesigner$.proxy(this.changeCheckBoxValue,this,o)}),s={showPopupButton:!0,noRecordsTemplate:null,autofill:!0,width:"100%",cssClass:"bbi-queryjoin-value-text-box bbi-ej2-auto-complete bbi-designer-ejwidgets bbi-designer-content-label bbi-dbrd-control",height:"26px",filterType:"StartsWith",showClearButton:!1,focus:this.bbdesigner$.proxy(this.updateColumnValues,this,o,null)},n=BoldBIDashboard.DashboardUtil.createAutoComplete(s,I[0]),this.updateLeftFieldValues(o,e,a),i&&i.field?(h.data("BoldBIDashboardDropDownList").selectItemByIndex(this.getSelectedIndex(o+"_field_left",i.field.leftField)),b.data("BoldBIDashboardDropDownList").selectItemByIndex(this.getSelectedIndex(o+"_field_right",i.field.rightField)),c.data("BoldBIDashboardDropDownList").selectItemByValue(i.field.operator),f.data("BoldBIDashboardCheckBox").option("checked",i.field.isValueChecked),i.field.isValueChecked&&(this.showValueDropDown(o,!0),this.updateColumnValues(o,BoldBIDashboard.isNullOrUndefined(i.field.value)?null:i.field.value))):(h.data("BoldBIDashboardDropDownList").selectItemByIndex(0),c.data("BoldBIDashboardDropDownList").selectItemByIndex(0),r=this.selectRightFieldIndex(o,e),b.data("BoldBIDashboardDropDownList").selectItemByIndex(r),f.data("BoldBIDashboardCheckBox").option("checked",!1),n.dataSource=[])},e.prototype.conditionUI=function(i,e){var a=this;e.isInteraction||"Cross Join"!==e.value?this.fieldtd.css("display",""):this.fieldtd.css("display","none"),e.isInteraction&&this.joinEditor.find(".e-joiner-type-tab-dropdown").each(function(e,t){a.bbdesigner$(t).attr("id")!==a.dashboardDesigner.element.find("#"+i.rowId+"_joiner_"+i.identity+"_tab").attr("id")&&(t=a.bbdesigner$(t).data("BoldBIDashboardDropDownList").getSelectedValue(),BoldBIDashboard.isNullOrUndefined(t)||"Cross Join"!==t?a.fieldtd.css("display",""):a.fieldtd.css("display","none"))}),"MySQL"===this.queryDesigner._datasourceInfo.ConnectionProperties.DataProvider&&"Full Outer Join"===e.value?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.alertWindowMesages.joinMessageMySQL,IconType.warning,AlertType.Alert,!1,""),this.operator.data("BoldBIDashboardDropDownList").selectItemByValue("Inner")):"Google"===this.queryDesigner._datasourceInfo.ConnectionProperties.DataProvider&&"Full Outer Join"===e.value?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.alertWindowMesages.joinMessageGoogle,IconType.warning,AlertType.Alert,!1,""),this.operator.data("BoldBIDashboardDropDownList").selectItemByValue("Inner")):"Rockset"===this.queryDesigner._datasourceInfo.ConnectionProperties.DataProvider&&"Full Outer Join"===e.value?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.alertWindowMesages.joinMessageRockset,IconType.warning,AlertType.Alert,!1,""),this.operator.data("BoldBIDashboardDropDownList").selectItemByValue("Inner")):"AzureDataExplorer"===this.queryDesigner._datasourceInfo.ConnectionProperties.DataProvider&&"Cross Join"===e.value?(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.alertWindowMesages.joinMessageAzureDataExplorer,IconType.warning,AlertType.Alert,!1,""),this.operator.data("BoldBIDashboardDropDownList").selectItemByValue("Inner")):"PostgreSQL"===this.queryDesigner._datasourceInfo.ConnectionProperties.DataProvider&&"Full Outer Join"===this.operator.data("BoldBIDashboardDropDownList").getSelectedValue()&&("="!==e.value||"Full Outer Join"===e.value&&"="!==this.functionalOperator.data("BoldBIDashboardDropDownList").getSelectedValue())&&(this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.alertWindowMesages.joinMessagePostgreSql,IconType.warning,AlertType.Alert,!1,""),this.functionalOperator.data("BoldBIDashboardDropDownList").selectItemByValue("="))},e.prototype.updateColumnValues=function(e,t){var i=this.contentDiv.find("#"+e+"_field_right").data("BoldBIDashboardDropDownList"),a=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.contentDiv.find("#"+e+"_field_valueAutocomplete")),o=this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").attr("isPostBack"),s=this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").attr("rightFieldValue"),o=!BoldBIDashboard.isNullOrUndefined(o)&&"true"===o.toLowerCase(),s=!BoldBIDashboard.isNullOrUndefined(s)&&i.getSelectedValue()===s,a=BoldBIDashboard.isNullOrUndefined(a.dataSource)||0===a.dataSource.length;(o||s)&&!a||(o=i.getItemDataByValue(i.getSelectedValue())[0].field,s=[{Id:i.getSelectedValue(),Name:o,SummaryType:"None",FieldType:"Dimensions"}],this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnData,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getColumnData,fieldInfo:s,dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.setColumnValues,this,e,t),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this,e),this.bbdesigner$.proxy(this.hideLoadingIndicator,this,e)]}),this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").attr("isPostBack","true").attr("rightFieldValue",i.getSelectedValue()))},e.prototype.setColumnValues=function(e,t,i){var a,i=JSON.parse(i.data),o=Object.keys(i[0])[0];!BoldBIDashboard.isNullOrUndefined(i)&&0<i.length&&((a=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.contentDiv.find("#"+e+"_field_valueAutocomplete"))).fields={text:o,value:o},a.dataSource=i,BoldBIDashboard.isNullOrUndefined(t)?a.showPopup():a.value=t),this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").attr("isPostBack","false")},e.prototype.selectRightFieldIndex=function(e,t){for(var t=this.contentDiv.find("#"+t+"_joiner_right_tab").data("BoldBIDashboardDropDownList"),i=this.contentDiv.find("#"+e+"_field_right").data("BoldBIDashboardDropDownList"),a=t.getItemDataByValue(t.getSelectedValue())[0].field,o=i.getItemDataByValue(i.getSelectedValue())[0].field,s=this.contentDiv.find("#"+e+"_field_right").data("BoldBIDashboardDropDownList").model.dataSource,n=[],r=0;r<s.length;r++)if(s[r].pid===a&&(n.push(r),o===s[r].field||o===s[r].field.replace(" ("+s[r].pid+")","")))return r;return 0<n.length?n[0]:0},e.prototype.renderLogicalCondition=function(e,t,i){var a=BoldBIDashboard.buildTag("div.e-designer-joiner-logical","",{height:"31px","margin-top":"4px",padding:"4px 5px"},{id:e+"_joiner_logical_div"}),o=BoldBIDashboard.buildTag("div","",{"margin-bottom":"-15px","padding-left":"13px"},{}),s=BoldBIDashboard.buildTag("input.e-logical","",{padding:"1px"},{type:"text",id:e+"_joiner_logical"}),e=BoldBIDashboard.buildTag("div","",{"border-top":"1px solid #cecece"},{id:e+"_logical_separator"});o.append(s),a.append(o,e),a.insertBefore(t),s.BoldBIDashboardDropDownList({showRoundedCorner:!0,width:"135px",height:"28px",cssClass:"bbi-joiner-drpdwn bbi-designer-ejwidgets bbi-dbrd-control",fields:{id:"field",text:"field",value:"field"},dataSource:this.getLogicalData()}),i&&i.field?s.data("BoldBIDashboardDropDownList").selectItemByValue(i.field.condition):s.data("BoldBIDashboardDropDownList").selectItemByIndex(0)},e.prototype.renderConditionArea=function(e,t){var i=BoldBIDashboard.buildTag("div.e-designer-joiner-condition","",{height:"31px","margin-top":"4px",padding:"4px 5px"},{id:e+"_joiner_condition_div"}),a=BoldBIDashboard.buildTag("div","",{"margin-bottom":"-15px","padding-left":"13px"},{}),o=BoldBIDashboard.buildTag("button.bbi-designer-addfield-btn bbi-dbrd-btn-secondary bbi-dbrd-btn-small",this.locale.queryJoiner.addField,{},{id:e+"_condition_add_field",type:"button"}),s=BoldBIDashboard.buildTag("div","",{"border-top":"1px solid #cecece"},{id:e+"_condition_separator"});a.append(o),i.append(a,s),t.append(i),o.on("click",this.bbdesigner$.proxy(this.addNewField,this,{id:e,target:t}))},e.prototype.setAvailableTable=function(e){e=JSON.parse(e);this.availableTables=e},e.prototype.editNewField=function(e,t,i,a){this.callback=a,this.availableTables=i,this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog").data("e-table",t),this.showQueryJoiner(e,!1,a),this.addNewQueryJoiner(0<e.length,{rightTable:t.id})},e.prototype.changeCheckBoxValue=function(e,t){t.isInteraction&&this.showValueDropDown(e,t.isChecked)},e.prototype.showValueDropDown=function(e,t){t?(this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").css("visibility","visible"),this.contentDiv.find("#"+e+"_field_right").data("BoldBIDashboardDropDownList").disable()):(this.contentDiv.find("#"+e+"_field_valueAutocomplete_div").css("visibility","hidden"),this.contentDiv.find("#"+e+"_field_right").data("BoldBIDashboardDropDownList").enable());t=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(this.contentDiv.find("#"+e+"_field_valueAutocomplete"));t.dataSource=[],t.clear()},e.prototype.addNewField=function(e){this.renderTabFields(e.id,e.target,null,!0),this.ejScrollerDiv&&this.ejScrollerDiv.refresh(!0)},e.prototype.getRelationInput=function(e){var d,t,l=this,i=this.contentDiv.find("#"+e+"_joiner_left_tab").data("BoldBIDashboardDropDownList"),a=this.contentDiv.find("#"+e+"_joiner_right_tab").data("BoldBIDashboardDropDownList"),o=this.contentDiv.find("#"+e+"_joiner_type").data("BoldBIDashboardDropDownList"),s={};return a.getSelectedValue()&&(s.rightTable=a.getSelectedValue(),s.rightSchema=a.getItemDataByValue(a.getSelectedValue())[0].schema),o.getSelectedValue()&&(s.join=o.getSelectedValue()),a=this.contentDiv.find("#"+e+" .bbi-designer-joiner-field"),d=[],a.each(function(e,t){var t=l.bbdesigner$(t).attr("e-rowId"),i=l.dashboardDesigner.element.find("#"+t+"_field_left").data("BoldBIDashboardDropDownList"),a=l.dashboardDesigner.element.find("#"+t+"_field_right").data("BoldBIDashboardDropDownList"),o=l.dashboardDesigner.element.find("#"+t+"_field_type").data("BoldBIDashboardDropDownList"),s=l.dashboardDesigner.element.find("#"+t+"_field_checkbox").data("BoldBIDashboardCheckBox"),n=BoldBIDashboard.DashboardUtil.getAutoCompleteObj(l.dashboardDesigner.element.find("#"+t+"_field_valueAutocomplete")),r="AND";0<l.dashboardDesigner.element.find("#"+t+"_joiner_logical").length&&(r=l.dashboardDesigner.element.find("#"+t+"_joiner_logical").data("BoldBIDashboardDropDownList").getSelectedValue()),d.push({leftField:i.getSelectedValue(),operator:o.getSelectedValue(),rightField:a.getSelectedValue(),isValueChecked:s.isChecked(),value:n.value,condition:r})}),this.contentDiv.find("#"+e+"_joiner_left_tab").hasClass("e-joiner-tab-dropdown")&&i.getSelectedValue()?(s.leftTable=i.getSelectedValue(),s.leftSchema=i.getItemDataByValue(i.getSelectedValue())[0].schema):(t=this.availableTables.filter(function(e){return e.ID===d[0].leftField}),s.leftTable=t[0].TableId,o=this.tables.filter(function(e){return e.id===t[0].TableId}),s.leftSchema=0===o.length?null:o[0].schema),0<d.length&&(s.fields=d),s},e.prototype.updatePreviousValue=function(e,t){BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(t.value)||(this.prevValue=t.value)},e.prototype.changeEqualTable=function(a,e){var t,o,s,n,r=this;e.isInteraction&&(t=this.joinEditor.find(".e-joiner-tab-dropdown"),o=e.selectedValue,s=BoldBIDashboard.isNullOrUndefined(this.prevValue)?"":this.prevValue,n=[],t.each(function(e,t){var i;r.bbdesigner$(t).attr("id")!==r.dashboardDesigner.element.find("#"+a.rowId+"_joiner_"+a.identity+"_tab").attr("id")&&(n.push(parseInt(r.dashboardDesigner.element.find("#"+a.rowId+"_joiner_"+a.identity+"_tab").attr("joinIndex"),10)),i=r.bbdesigner$(t).data("BoldBIDashboardDropDownList").getSelectedValue(),BoldBIDashboard.isNullOrUndefined(i)||i!==o||(r.bbdesigner$(t).data("BoldBIDashboardDropDownList").selectItemByValue(s),n.push(parseInt(r.bbdesigner$(t).attr("joinIndex"),10))))}),e=n.sort(this.sortValues),this.changeFieldDropdownValues(e))},e.prototype.sortValues=function(e,t){return e-t},e.prototype.changeFieldDropdownValues=function(e){var t,n,i,r=this,d=this.contentDiv.find(".bbi-designer-joiner-row"),l=this.joinEditor.find(".e-joiner-tab-dropdown"),a=e[0]-1,o=e[e.length-1]-1,h=null;if(0!=a||0!=o)for(t=function(e){var t,i,a=[];for(h=n.contentDiv.find("#"+n.contentDiv.find(d[e]).attr("rowId")+" .e-left"),t=0;t<e+2;t++){var o=n.joinEditor.find(l[t]).data("BoldBIDashboardDropDownList"),s=o.model.selectedIndex,s=BoldBIDashboard.isNullOrUndefined(s)?"":o.model.dataSource[s].fieldId;0===(a=a.concat(n.getTableColumns(s))).length&&(s=BoldBIDashboard.isNullOrUndefined(t)?"":o.model.dataSource[t].fieldId,a=a.concat(n.getTableColumns(s)))}for(i=0;i<n.expressionTable.length;i++)a.push({pid:"Expression",tableId:n.expressionTable[i].TableId,field:n.expressionTable[i].Name,fieldId:n.expressionTable[i].ID,columnDetails:n.expressionTable[i]});h.each(function(e,t){t=r.bbdesigner$(t).data("BoldBIDashboardDropDownList");t.setModel({dataSource:a}),t.selectItemByIndex(0)})},n=this,i=a;i<o;i++)t(i)},e.prototype.updateLeftFieldValues=function(e,t,i){for(var a,o=this.contentDiv.find(".bbi-designer-joiner-row"),s=this.joinEditor.find(".e-joiner-tab-dropdown"),e=this.contentDiv.find("#"+e+"_field_left").data("BoldBIDashboardDropDownList"),n=[],r=i?o.index(this.bbdesigner$("#"+t))+1:o.length,d=0;d<r- -1;d++){var l=this.joinEditor.find(s[d]).data("BoldBIDashboardDropDownList"),h=l.model.selectedIndex,h=BoldBIDashboard.isNullOrUndefined(h)?"":l.model.dataSource[h].fieldId;0===(n=n.concat(this.getTableColumns(h))).length&&(h=BoldBIDashboard.isNullOrUndefined(d)?"":l.model.dataSource[d].fieldId,n=n.concat(this.getTableColumns(h)))}for(a=0;a<this.expressionTable.length;a++)n.push({pid:"Expression",tableId:this.expressionTable[a].TableId,field:this.expressionTable[a].Name,fieldId:this.expressionTable[a].ID,columnDetails:this.expressionTable[a]});e.setModel({dataSource:n}),e.selectItemByText(e.model.dataSource[0].fieldId)},e.prototype.changeFieldLeftValue=function(e,t){var i,a;if(!BoldBIDashboard.isNullOrUndefined(t)){var o=this.contentDiv.find("#"+e+"_field_right"),s=t.model.dataSource,n=[],r=s.filter(function(e){return e.fieldId===t.selectedValue})[0].columnDetails,d=!0;if(0<o.data("BoldBIDashboardDropDownList").model.dataSource.length&&(i=o.data("BoldBIDashboardDropDownList").model.dataSource[0].columnDetails.DefaultDataType,d=!t.isInteraction||r.DefaultDataType!==i&&!("Integer"===r.DefaultDataType&&"Real"===i||"Real"===r.DefaultDataType&&"Integer"===i)),d){for(a=0;a<s.length;a++)(r.DesiredType===s[a].columnDetails.DefaultDataType||"Integer"===r.DesiredType&&"Real"===s[a].columnDetails.DefaultDataType||"Real"===r.DesiredType&&"Integer"===s[a].columnDetails.DefaultDataType)&&n.push(s[a]);o.data("BoldBIDashboardDropDownList").setModel({dataSource:n}),0<n.length&&o.data("BoldBIDashboardDropDownList").selectItemByIndex(0),this.contentDiv.find("#"+e+"_field_checkbox_div").css("visibility","Date"===r.DefaultDataType?"hidden":"visible"),this.contentDiv.find("#"+e+"_field_checkbox").data("BoldBIDashboardCheckBox").option("checked",!1)}this.showValueDropDown(e,this.contentDiv.find("#"+e+"_field_checkbox").data("BoldBIDashboardCheckBox").isChecked())}},e.prototype.getTableColumns=function(a){var o=this,s=[],n=this.availableTables;return this.dashboardDesigner.element.find("#"+this.id+"_div_dragSurface .bbi-data-table").each(function(e,t){var i,t=o.bbdesigner$(t).data("e-table");if(a===t.id)for(i=0;i<n.length;i++)a===n[i].TableId&&s.push({pid:n[i].TableName,tableId:n[i].TableId,field:n[i].Name,fieldId:n[i].ID,columnDetails:n[i]})}),s.sort(this.compare),s},e.prototype.compare=function(e,t){return e.field<t.field?-1:e.field>t.field?1:0},e.prototype.getTableGroups=function(){var i=this,a=[];return this.expressionTable=[],this.dashboardDesigner.element.find("#"+this.id+"_div_dragSurface .bbi-data-table").each(function(e,t){t=i.bbdesigner$(t).data("e-table");a.push({fieldId:t.id,field:t.name,schema:t.schema,id:t.id,text:t.displayName})}),this.expressionTable=this.availableTables.filter(function(e){return!0===e.IsExpression&&!1===e.IsAggregatedExpression}),0<this.expressionTable.length&&(null===this.temproryId&&(this.temproryId=Math.random().toString(16).substring(2,32)+Math.random().toString(16).substring(2,32)),a.push({text:"Expression",fieldId:this.temproryId,field:this.expressionTable[0].name,id:this.temproryId})),a},e.prototype.showQueryJoiner=function(e,t,i){this.resetJoinInstance(),this.callback=i,t&&(this.joinEditor.data("BoldBIDashboardDialog").open(),this.ejJoinerWaitingPopup.show()),this.footerTag.find("#"+this.id+"_btn_save").html(t?this.locale.queryJoiner.update:this.locale.queryJoiner.merge),this.tables=this.getTableGroups(),this.populateJoiner(e),t&&this.updateQueryJoinerScrollBar()},e.prototype.openQueryJoiner=function(e){this.joinEditor.data("BoldBIDashboardDialog").open(),this.ejJoinerWaitingPopup.show(),this.queryDesigner.executeUIQuery(e),this.showJoiners(!1),this.showCancelBtn(!1),this.selectedTable=null},e.prototype.resetJoinInstance=function(){this.queryJoiner=[],this.tables=[],this.contentDiv.empty()},e.prototype.populateJoiner=function(e){if(this.queryJoiner=JSON.parse(JSON.stringify(e)),this.queryJoiner&&0<this.queryJoiner.length)for(var t=0;t<this.queryJoiner.length;t++)this.addNewQueryJoiner(0<t,this.queryJoiner[t])},e.prototype.updateQueryJoiner=function(e,t,i){e=JSON.parse(e.jsonData);!e||-1===e.indexOf("Sf_Exception")&&"Not Found"!==e?(this.showJoiners(!0),this.editNewField(this.queryDesigner.queryJoiner,t,e,i),this.updateQueryJoinerScrollBar()):(this.ejJoinerWaitingPopup.hide(),this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog").data("e-table",t),this.callback=i,this.showJoiners(!1),this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.queryJoiner,this.locale.errorMessage.dataFetchingError,IconType.errors,AlertType.Alert,!0,e,{method:"cancelJoinDialog",instance:this,dataInfo:null}))},e.prototype.updateQueryJoinerScrollBar=function(){var e=this.ejScrollerDiv;e.isVScroll()&&(e.refresh(!0),e.scrollY(e._scrollYdata.scrollable)),this.ejJoinerWaitingPopup.hide()},e.prototype.showJoiners=function(e){e?(this.successDiv.css("display","block"),this.failureDiv.css("display","none"),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.find("#"+this.id+"_btn_save"),!0)):(this.successDiv.css("display","none"),this.failureDiv.css("display","block"),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.find("#"+this.id+"_btn_save"),!1))},e.prototype.showCancelBtn=function(e){e?(this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog_closebutton").removeClass("e-close-disable").css({cursor:"pointer",opacity:"1"}),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.find("#"+this.id+"_btn_cancel"),!0)):(this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog_closebutton").addClass("e-close-disable").css({cursor:"default",opacity:"0.3"}),BoldBIDashboard.DashboardUtil.buttonEnable(this.footerTag.find("#"+this.id+"_btn_cancel"),!1))},e.prototype.closeJoinDialog=function(e){this.footerTag.find("#"+this.id+"_btn_save").html(this.locale.queryJoiner.merge),this.footerTag.find("#"+this.id+"_btn_save").addClass("bbi-dbrd-designer-hoverable").attr("data-tooltip",this.locale.queryJoiner.merge),e.model.position={X:0,Y:0},!e.isInteraction&&BoldBIDashboard.isNullOrUndefined(this.selectedTable)||this.cancelJoinDialog(e)},e.prototype.onDialogClose=function(e){!BoldBIDashboard.isNullOrUndefined(e.event)&&this.bbdesigner$(e.event.target).hasClass("e-close-disable")?e.cancel=!0:this.ejJoinerWaitingPopup.hide()},e.prototype.selectedTableInfo=function(e,t,i){this.ejJoinerWaitingPopup.hide(),this.failureDiv.text(t),this.failureDiv.css("text-align","center"),this.failureDiv.css("vertical-align","middle"),this.failureDiv.css("line-height",this.failureDiv.height()+"px"),this.failureDiv.css("font-size","12px"),this.showJoiners(!1),this.showCancelBtn(!0),this.selectedTable=e,this.callback=i},e.prototype.cancelJoinDialog=function(){var e,t=this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog"),i=t.data("e-table");t.data("BoldBIDashboardDialog").close(),i&&i.name?(e={isCancel:!0,data:i},this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.cancelJoin,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.cancelJoin,tableId:i.id,dataSetName:this.queryDesigner.dataset.Name,dataSetId:this.queryDesigner.dataset.Id,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.closeJoin,this,e)})):BoldBIDashboard.isNullOrUndefined(this.selectedTable)||(e={isCancel:!0,data:this.selectedTable},this.closeJoin(e,null))},e.prototype.closeJoin=function(e){BoldBIDashboard.isNullOrUndefined(this.selectedTable)||(this.failureDiv.text(""),this.successDiv.css("display","block"),this.failureDiv.css("display","none"));var t=this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog");BoldBIDashboard.DashboardUtil.invokeCallBack(this.callback,e),t.removeData("e-table")},e.prototype.saveJoinQuery=function(){var e=this.getTableJoiners(),t=this.dashboardDesigner.element.find("#"+this.id+"_Join_Dialog");BoldBIDashboard.DashboardUtil.invokeCallBack(this.callback,{joiners:e}),t.data("BoldBIDashboardDialog").close(),t.removeData("e-table")},e.prototype.getTableJoiners=function(){var i=this,a=[];return this.contentDiv.find(".bbi-designer-joiner-row").each(function(e,t){t=i.bbdesigner$(t).attr("rowId"),t=i.getRelationInput(t);a.push(t)}),a},e.prototype.showLoadingIndicator=function(e){this.contentDiv.find("#"+e+"_field_valueAutocomplete_dropdown>span").removeClass("e-search"),this.contentDiv.find("#"+e+"_field_valueAutocomplete_dropdown>span").addClass("e-load").addClass("e-input"),this.contentDiv.find("#"+e+"_field_valueAutocomplete_dropdown>span").css("background-position","center")},e.prototype.hideLoadingIndicator=function(e){this.contentDiv.find("#"+e+"_field_valueAutocomplete_dropdown>span").removeClass("e-input").removeClass("e-load"),this.contentDiv.find("#"+e+"_field_valueAutocomplete_dropdown>span").addClass("e-search")},e.prototype.getJoinData=function(){return[{field:"Inner"},{field:"Left Outer Join"},{field:"Right Outer Join"},{field:"Full Outer Join"},{field:"Cross Join"}]},e.prototype.getOperator=function(){return[{field:"="},{field:">="},{field:"<="},{field:"!="}]},e.prototype.getLogicalData=function(){return[{field:"AND"},{field:"AND(Group)"},{field:"OR(Group)"},{field:"OR"},{field:"AND NOT"},{field:"OR NOT"}]},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.QueryJoiner",InternalQueryJoiner,window),InternalQueryParameter=function(){function e(e){this.id=null,this.parameters=[],this.queryParameters=[],this.locale=null,this.designerInstance=e,this.bbdesigner$=this.designerInstance.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.designerInstance._id,this.queryDesigner=this.designerInstance.modules.queryDesigner,this.renderQueryParameter()}return e.prototype.renderQueryParameter=function(){var e=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{display:"block"},{title:"Parameters",id:this.id+"_query_param_dialog"}),t=BoldBIDashboard.buildTag("div","",{height:"280px",width:"100%"}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-designer-border-dialog bbi-dbrd-designer-scroll-style-3","",{height:"275px",width:"475px",margin:"5px 0px"},{id:this.id+"_queryparam_parent_div"}),a=BoldBIDashboard.buildTag("div","",{},{}),o=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_queryparam_container_div"}),s=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left","Cancel",{float:"right"},{id:this.id+"_queryparam_btn_cancel",type:"button"}),n=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small","OK",{float:"right"},{id:this.id+"_queryparam_btn_save",type:"button"});a.append(o),i.append(a),t.append(i),e.append(t),e.BoldBIDashboardDialog({minWidth:500,height:"auto",width:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.queryDesigner._id,target:"#"+this.queryDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.designerInstance.element.find("#"+this.id+"_query_param_dialog_foot").append(s).append(n),n.on("click",this.bbdesigner$.proxy(this.saveQueryParameter,this,!0)),s.on("click",this.bbdesigner$.proxy(this.closeQueryDialog,this,!0)),i.BoldBIDashboardScroller({height:"275px",scrollerSize:this.designerInstance.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.designerInstance.scrollerSize.buttonSize})},e.prototype.renderQueryParameters=function(e){var t,i,a=this.designerInstance.element.find("#"+this.id+"_queryparam_container_div"),o=(a.empty(),BoldBIDashboard.buildTag("div.e-reportdesigner-query-parameter","",{padding:"4px 8px","padding-bottom":"0px",display:"block"},{})),s=BoldBIDashboard.buildTag("table","",{},{id:this.id+"_query_table"}),n=BoldBIDashboard.buildTag("tr"),r=BoldBIDashboard.buildTag("td","<b>Parameter</b>",{height:"30px",width:"163px"}),d=BoldBIDashboard.buildTag("td","<b style='padding-left: 10px'>Null</b>",{height:"30px",width:"86px","padding-left":"26px"}),l=BoldBIDashboard.buildTag("td","<b style='padding-left: 12px' id='"+this.id+"_queryparam_value_title'>Value</b>",{height:"30px",width:"176px","padding-left":"13px"});for(this.parameters=e,n.append(r).append(d).append(l),s.append(n),o.append(s),a.append(o),t=0;t<e.length;t++)i=e[t],this.renderParameter(i,a);this.queryParameters&&0<this.queryParameters.length&&this.populateQueryParameter(this.queryParameters)},e.prototype.renderParameter=function(e,t){var i=e.substring(1),a=BoldBIDashboard.buildTag("div.e-reportdesigner-query-parameter","",{padding:"4px 8px",display:"block"},{id:this.id+"_query_"+i}),o=BoldBIDashboard.buildTag("table","",{width:"100%"},{id:this.id+"_query_table_"+i}),s=BoldBIDashboard.buildTag("tr","",{}),n=BoldBIDashboard.buildTag("td","",{width:"150px"}),e=BoldBIDashboard.buildTag("span",e,{width:"150px","text-overflow":"ellipsis",overflow:"hidden",display:"block","white-space":"nowrap"},{}),r=BoldBIDashboard.buildTag("td","",{width:"57px","padding-left":"40px"}),d=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_query_chk_"+i}),l=BoldBIDashboard.buildTag("td","",{width:"20px","padding-left":"26px"});s.append(n),n.append(e),s.append(r),r.append(d),s.append(l),o.append(s),a.append(o),t.append(a),n=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-border","",{height:"25px",width:"140px",float:"right"},{type:"text",id:this.id+"_query_proc_"+i}),l.append(n),d.BoldBIDashboardCheckBox({change:this.bbdesigner$.proxy(this.checkParamNullable,this,{id:this.id+"_query_proc_"+i}),showRoundedCorner:!0,cssClass:"bbi-designer-border"})},e.prototype.getQueryParams=function(){var e,t=[];if(this.parameters&&0<this.parameters.length){for(e=0;e<this.parameters.length;e++){var i=this.parameters[e],a=i.substring(1);this.designerInstance.element.find("#"+this.id+"_query_chk_"+a).data("BoldBIDashboardCheckBox").isChecked()?t.push({Name:i,IsNull:!0,Value:""}):t.push({Name:i,IsNull:!1,Value:this.designerInstance.element.find("#"+this.id+"_query_proc_"+a).val()})}return t}return null},e.prototype.getQueryParameters=function(e){for(var t=[],i=BoldBIDashboard.DashboardUtil.parseQuery(e),a=0;a<i.length;a++)this.isExistQueryParameter(i[a].substring(1),t)||t.push({Name:i[a],Value:null,isQueryMode:!0});return t},e.prototype.saveQueryParameter=function(){this.queryDesigner.queryInputVals=this.getQueryParams();var e=this.queryDesigner.getQueryText();this.queryDesigner.executeTempQuery(e),this.designerInstance.element.find("#"+this.id+"_query_param_dialog").data("BoldBIDashboardDialog").close()},e.prototype.populateQueryParameter=function(e){var t,i;if(e&&0<e.length)for(t=0;t<e.length;t++)i=e[t].Name.substring(1),e[t].IsNull?this.designerInstance.element.find("#"+this.id+"_query_chk_"+i).data("BoldBIDashboardCheckBox").setModel({checked:!0}):this.designerInstance.element.find("#"+this.id+"_query_proc_"+i).val(e[t].Value)},e.prototype.checkParamNullable=function(e,t){t.isChecked?this.designerInstance.element.find("#"+e.id).attr("disabled","disabled"):this.designerInstance.element.find("#"+e.id).removeAttr("disabled")},e.prototype.isExistQueryParameter=function(e,t){for(var i=0;i<t.length;i++)if(t[i]===e)return!0;return!1},e.prototype.showQueryDialog=function(e,t){var i=BoldBIDashboard.DashboardUtil.parseQuery(e);this.queryParameters=t,i&&0<i.length?(this.renderQueryParameters(i),this.designerInstance.element.find("#"+this.id+"_query_param_dialog").data("BoldBIDashboardDialog").open(),this.designerInstance.element.find("#"+this.id+"_queryparam_parent_div").height()>this.designerInstance.element.find("#"+this.id+"_queryparam_container_div").height()?this.designerInstance.element.find("#"+this.id+"_queryparam_value_title").css("padding-left","16px"):this.designerInstance.element.find("#"+this.id+"_queryparam_value_title").css("padding-left","12px"),(t=this.designerInstance.element.find("#"+this.id+"_queryparam_parent_div")).data("BoldBIDashboardScroller")&&t.data("BoldBIDashboardScroller").refresh()):this.queryDesigner.executeTempQuery(e)},e.prototype.closeQueryDialog=function(){this.designerInstance.element.find("#"+this.id+"_query_param_dialog").data("BoldBIDashboardDialog").close()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.QueryParameter",InternalQueryParameter,window),InternalSharedDataSet=function(){function e(e){this.dashboardDesigner=null,this.id=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.dataset=this.dashboardDesigner.modules.dataSet,this.rdlParser=this.dashboardDesigner.rdlParser,this.id=this.dashboardDesigner._id,this.datasetReference=null,this.dataSetItem=null}return e.prototype.renderConfiguration=function(e){var t,i,a,o,s,n;0<e.find("#"+this.id+"_shared_dataset").length?(this.resetConfiguration(),this.setDataSetName()):(t={id:"Id",text:"Name",value:"Id"},this.configTable=BoldBIDashboard.buildTag("table.bbi-designer-dsconfig-table","",{width:"100%","margin-left":"3px"},{unselectable:"on",id:this.id+"_shared_dataset"}),e.append(this.configTable),e=this.bbdesigner$("<tr></tr>"),i=this.bbdesigner$("<td></td>"),s=this.bbdesigner$("<table></table>"),o=BoldBIDashboard.buildTag("label.editLabel bbi-designer-title-label","Name",{}),a=this.bbdesigner$("<td style='width: 215px' id="+this.id+"_shared_txt_lbl_td></td>"),n=this.bbdesigner$("<tr style='float: left'></tr>"),a.append(o),n.append(a),o=BoldBIDashboard.buildTag("td","",{},{id:this.id+"_shared_txt_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(o,this.id),n.append(o),s.append(n),i.append(s),e.append(i),this.configTable.append(e),a=this.bbdesigner$("<tr style='float: left'></tr>"),o=this.bbdesigner$("<td id="+this.id+"_shared_txt_td></td>"),a.append(o),s.append(a),n=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-content-label","",{height:"24px",width:"426px"},{edittype:"stringedit",id:this.id+"_shared_txt",type:"text",value:this.dataset.getAvailableName()}),o.append(n),i=this.bbdesigner$("<tr></tr>"),e=this.bbdesigner$("<td></td>"),s=this.bbdesigner$("<table></table>"),i.append(e),e.append(s),this.configTable.append(i),a=this.bbdesigner$("<tr style='float: left;font-weight: 500'><td  style='width: 215px' id="+this.id+"_shared_dropdown_lbl_td><label class='editLabel bbi-designer-title-label bbi-designer-fontfamily' style='padding-top:6px;font-size: 13px;'>Shared DataSet</label></td></tr>"),s.append(a),o=BoldBIDashboard.buildTag("td","",{},{id:this.id+"_shared_data_drdwn_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(o,this.id),a.append(o),n=this.bbdesigner$("<tr style='float: left'></tr>"),e=this.bbdesigner$("<td id="+this.id+"_shared_data_drdwn_td></td>"),s.append(n),n.append(e),i=BoldBIDashboard.buildTag("input","",{},{id:this.id+"_shared_data_drdwn",value:""}),e.append(i),i.BoldBIDashboardDropDownList({width:"440px",dataSource:[],fields:t,cssClass:"bbi-designer-dataset-selection bbi-designer-content-label bbi-designer-ejwidgets bbi-dbrd-control"}),a=this.bbdesigner$("<tr></tr>"),o=this.bbdesigner$("<td></td>"),s=this.bbdesigner$("<table></table>"),n=this.bbdesigner$("<tr style='float: left'/>"),e=this.bbdesigner$("<td unselectable='on' align='right'/>"),n.append(e),s.append(n),o.append(s),a.append(o),this.configTable.append(a)),this.datasetReference=null,this.showConfiguration(!0),this.loadDataSetCatalog()},e.prototype.editConfiguration=function(e){this.dataSetItem=e;var t=this.dashboardDesigner.element.find("#"+this.id+"_sharedDSContainer");0===t.children().length&&this.renderConfiguration(t),this.datasetReference=null,this.hideValidationMsg(),this.setDataSetName(e),e&&(this.datasetReference=e.SharedDataSet.SharedDataSetReference,this.dashboardDesigner.element.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList").setModel({dataSource:[]}),this.loadDataSetCatalog()),this.showConfiguration(!0),this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardScroller")&&this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardScroller").refresh()},e.prototype.resetConfiguration=function(){this.datasetReference=null,this.configTable.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList").setModel({dataSource:[]}),this.dashboardDesigner.element.find("#"+this.id+"_sharedds_alog").css("display",this.dashboardDesigner.isReportServerLogin()?"none":"block"),this.hideValidationMsg()},e.prototype.hideValidationMsg=function(){this.renderValidation(this.id+"_shared_txt",!1),this.renderValidation(this.id+"_shared_data_drdwn",!1)},e.prototype.setDataSetName=function(e){var t=this.configTable.find("#"+this.id+"_shared_txt"),i="";e&&(i=e.Name,t.val(e.Name)),t.val(this.dataset.isEdit?i:this.dataset.getAvailableName())},e.prototype.showConfiguration=function(e){this.configTable.css("display",e?"block":"none")},e.prototype.getDataSetName=function(){var e,t=this.configTable.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList");return-1!==t.model.selectedIndex?(e=t.getListData())&&0<e.length?e[t.model.selectedIndex].Id:t.getSelectedValue():""},e.prototype.getDataSetInfo=function(){var e,t=this.getDataSetName();this.renderValidation(this.id+"_shared_data_drdwn",!t,"Select a shared DataSource"),e=this.validateDataSetName(),t&&e&&(this.datasetReference=t,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.sharedDataSet,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.sharedDataSet,reportInfo:{dataSetRefer:t}})},{fnction:this.bbdesigner$.proxy(this.saveDataSets,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}))},e.prototype.loadDataSetCatalog=function(){this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.dataSetCatalog,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.dataSetCatalog,reportInfo:{}})},{fnction:this.bbdesigner$.proxy(this.populateDataSets,this),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]})},e.prototype.populateDataSets=function(e){var t;e&&"string"!=typeof e&&-1===e.indexOf("Sf_Exception")&&((t=this.configTable.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList")).setModel({dataSource:e}),this.datasetReference)&&this.dataset.isEdit&&(BoldBIDashboard.DashboardUtil.isGuid(this.datasetReference)?t.selectItemByValue(this.datasetReference):t.selectItemByText(this.datasetReference))},e.prototype.saveDataSets=function(e){var t,i,a,o;if(e){if(t=BoldBIDashboardQueryDesigner.createDataSet(),i=this.createSharedData(),t.Name=this.configTable.find("#"+this.id+"_shared_txt").val(),t.Query=null,0<e.Fields.length)for(t.Fields=[],a=0;a<e.Fields.length;a++)(o=e.Fields[a]).__type="Syncfusion.RDL.DOM.Field",t.Fields.push(o);i.SharedDataSetReference=this.datasetReference,t.SharedDataSet=i,this.dataset.isEdit?this.dataset.updateDataSet(this.dataSetItem,t):this.dataset.addDataSet(t),this.dataset.isEdit=!1,this.dataset.switchPanel(PanelList.DataList)}},e.prototype.validateDataSetName=function(){var e=this.configTable.find("#"+this.id+"_shared_txt").val();return e?this.isAvailable(e)?(this.renderValidation(this.id+"_shared_txt",!0,"The specified name already exists in DataSet list"),!1):/^[a-zA-Z0-9-_]*$/.test(e)?(this.renderValidation(this.id+"_shared_txt",!1),!0):(this.renderValidation(this.id+"_shared_txt",!0,"Name should not contain spaces and special characters"),!1):(this.renderValidation(this.id+"_shared_txt",!0,"Specify the DataSet name"),!1)},e.prototype.isAvailable=function(i){var a=this,e=this.dashboardDesigner.element.find("#"+this.id+"_div_datasetUl>li>div>.bbi-designer-treeText"),o=!1,s=this;return e.each(function(e,t){a.bbdesigner$(t).text()!==i||s.dataSetItem&&i===s.dataSetItem.Name||(o=!0)}),o},e.prototype.renderValidation=function(e,t,i){var a=this.dashboardDesigner.element.find("#"+e+"_error_icon_td"),e=this.dashboardDesigner.element.find("#"+e+"_td").find(".bbi-designer-content-label");t?(BoldBIDashboard.DashboardUtil.showErrIndictor(a,!0,i),e.addClass("bbi-designer-error")):(BoldBIDashboard.DashboardUtil.showErrIndictor(a,!1),e.removeClass("bbi-designer-error")),this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardScroller")&&this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardScroller").refresh()},e.prototype.isLoaded=function(){return!BoldBIDashboard.isNullOrUndefined(this.configTable)},e.prototype.updateControlSize=function(){this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").height()>this.dashboardDesigner.element.find("#"+this.id+"_sharedDSContainer").height()?(this.configTable.find("#"+this.id+"_shared_txt").css("width","218px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_dropdown_lbl_td").css("width","215px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_txt_lbl_td").css("width","215px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList").setModel({width:"231px"})):(this.configTable.find("#"+this.id+"_shared_txt").css("width","208px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_dropdown_lbl_td").css("width","205px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_txt_lbl_td").css("width","205px"),this.dashboardDesigner.element.find("#"+this.id+"_shared_data_drdwn").data("BoldBIDashboardDropDownList").setModel({width:"221px"}))},e.prototype.createSharedData=function(){return{__type:"Syncfusion.RDL.DOM.SharedDataSet",SharedDataSetReference:"",QueryParameters:[]}},e.prototype.showLoadingIndicator=function(){this.bbdesigner$("#"+this.id+"_shared_data_drdwn_dropdown").addClass("e-load"),this.bbdesigner$("#"+this.id+"_shared_data_drdwn_dropdown>span").removeClass("e-arrow-sans-down")},e.prototype.hideLoadingIndicator=function(){this.bbdesigner$("#"+this.id+"_shared_data_drdwn_dropdown").removeClass("e-load"),this.bbdesigner$("#"+this.id+"_shared_data_drdwn_dropdown>span").addClass("e-arrow-sans-down")},e.prototype.showIndicator=function(){this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardWaitingPopup").show()},e.prototype.hideIndicator=function(){this.dashboardDesigner.element.find("#"+this.id+"_sharedDSBodyContainer").data("BoldBIDashboardWaitingPopup").hide()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.SharedDataSet",InternalSharedDataSet,window),InternalToolbar=function(){function e(e,t){this.zoomSelectedIndex=-1,this.createReportText="New Dashboard",this.createButtonText="Create",this.openReportText="Open Dashboard",this.items=["25%","50%","75%","100%","150%","200%","250%","300%","350%","400%"],this.fileWaterMark="Report Name",this.filterSerializer=null,this.relativeDateTimer=null,this.locale=null,this.dataSampleEnable=null,this.dataSampleCheck=null,this.isDataSampleEnabled=!0,this.isThresHoldEnabled=!1,this.targetTag=t,this.designer=e,this.bbdesigner$=this.designer.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.designer._id,this.measureFormat=new MeasureFormatting,(this.designer.isDesignMode()||this.designer.isDesignPreviewMode()||this.designer.isViewMode())&&(this.filterSerializer=this.designer.modules.masterSlaveFilter,this.propertyPanel=this.designer.modules.propertyPanel,this.widgetHelper=this.designer.modules.widgetHelper),(this.designer.isDesignMode()||this.designer.isDesignPreviewMode()||this.designer.model.mode===BoldBIDashboard.Designer.mode.datasource)&&(this.queryDesigner=this.designer.modules.queryDesigner)}return e.prototype.renderToolBar=function(e,t,i){var a=this.designer.model.toolbarSettings;a.templateId?(a=this.designer.element.find("#"+a.templateId),e.append(a),a.BoldBIDashboardToolbar({isResponsive:!0,enableSeparator:!0,height:a.height(),click:this.designer.model.toolbarClick}),a.css("display","block")):(this.toolBar=BoldBIDashboard.buildTag("div.bbi-designer-toolbarcontainer","",{width:i+"px",height:t+"px"},{id:this.id+"_toolBar"}),e.append(this.toolBar),a=BoldBIDashboard.buildTag("ul.bbi-designer-toolbarul","",{"padding-left":"5px"},{}),this.appendSplitBtn(a,this.locale.toolBar.publish,"bbi-designer-toolbar-save bbi-li-item bbi-dbrd-hand-cursor","2.5px 0px 0px 1px",this.id+"_saveConfigMenu"),e=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-hoverable","",{},{"data-tooltip":"Property",id:this.id+"_saveMenu"}),this.populateMenuItems(e,[{id:"save",text:this.locale.saveMenuItemsText.publish},{id:"saveAs",text:this.locale.saveMenuItemsText.publishAs}],"save"),this.toolBar.append(e),a=BoldBIDashboard.buildTag("ul.bbi-designer-toolbarul bbi-dbrd-title-ul","",{}),this.appendToolbarTitle(a),this.toolBar.append(a,BoldBIDashboard.DashboardUtil.getSeperator()),this.createDesignerToolbarIcons(),a=BoldBIDashboard.buildTag("ul.bbi-designer-toolbarul","",{}),this.appendToolbarTogglebutton(a),this.toolBar.append(a),this.appendPreview(this.toolBar),this.toolBar.BoldBIDashboardToolbar({isResponsive:!0,height:t+"px",width:i+"px",cssClass:"bbi-designer-toolbar bbi-dbrd-responsive-toolbar",enableSeparator:!1,click:this.bbdesigner$.proxy(this.toolbarClick,this)}),this.titleTextBox.on("focusout",this.bbdesigner$.proxy(this.saveToolBarTitle,this))),this.renderFUpload(),this.renderNewFile(),this.designer.toolbarTag=this.toolBar,this.ejDesignerTool=this.toolBar.data("BoldBIDashboardToolbar"),this.designer.model.mode===BoldBIDashboard.Designer.mode.datasource&&this.toolBar.css("display","none"),this.unWireEvents(),this.wireEvents()},e.prototype.createDesignerToolbarIcons=function(){var e=[];e.push({class:"bbi-designer-toolbar-cut",label:this.locale.toolBar.cut,elementId:this.id+"_designer_tool_cut",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.cut,iconType:"default"}),e.push({class:"bbi-designer-toolbar-copy",label:this.locale.toolBar.copy,elementId:this.id+"_designer_tool_copy",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.copy,iconType:"default"}),e.push({class:"bbi-designer-toolbar-paste",label:this.locale.toolBar.paste,elementId:this.id+"_designer_tool_paste",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.paste,iconType:"default"}),e.push({class:"bbi-designer-toolbar-delete",label:this.locale.toolBar.Delete,elementId:this.id+"_designer_tool_delete",iconFontSize:"",enableSeperator:!0,iconTooltip:this.locale.toolBar.Delete,iconType:"default"}),e.push({class:"bbi-designer-toolbar-undo",label:this.locale.toolBar.undo,elementId:this.id+"_designer_tool_undo",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.undo,iconType:"default"}),e.push({class:"bbi-designer-toolbar-redo",label:this.locale.toolBar.redo,elementId:this.id+"_designer_tool_redo",iconFontSize:"",enableSeperator:!0,iconTooltip:this.locale.toolBar.redo,iconType:"default"}),e.push({class:"bbi-designer-configuration-parameters",label:this.locale.toolBar.filter,elementId:this.id+"_designer_tool_filter",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.filter,iconType:"default"}),e.push({class:"bbi-designer-toolbar-datacache-icon bbi-designer-toolbar-datacache",label:this.locale.dataSource.dataCacheHeaderText,elementId:this.id+"_designer_tool_datacache",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.dataSource.dataCacheHeaderText,iconType:"default"}),e.push({class:"bbi-toolbar-refreshsettings-icon e-dbrd-banner-refresh",label:this.locale.toolBar.refreshSettings,elementId:this.id+"_designer_tool_refreshsettings",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.toolBar.refreshSettings,iconType:"default"}),e.push({class:"bbi-toolbar-localizedashboard-icon",label:this.locale.translationWindow.iconLabel,elementId:this.id+"_designer_tool_localizedashboard",iconFontSize:"",enableSeperator:!1,iconTooltip:this.locale.translationWindow.iconLabel,iconType:"default"}),this.designer._trigger("beforeDesignerToolbarIconsRendered",{toolbarIcons:e}),this.designer.modules.util.renderToolbarIcons(e,this.toolBar)},e.prototype.renderFUpload=function(){var t=this,e=BoldBIDashboard.buildTag("div","",{height:"0px"},{id:this.id+"_rdl_upload"});this.designer.element.append(e),e.BoldBIDashboardUploadbox({width:"0px",height:"0px",uploadName:"file",extensionsAllow:".rdl",autoUpload:!0,showFileDetails:!1,dialogAction:{content:this.designer.element},saveUrl:this.designer.model.serviceUrl+"/UploadReportAction",fileSelect:this.bbdesigner$.proxy(this.onfileSelect,this),error:this.bbdesigner$.proxy(this.onuploadError,this),complete:this.bbdesigner$.proxy(this.onuploadComplete,this),beforeSend:function(e){t.designer.showDesignIndicator(null),t.designer.beforeSendRequestForUploadbox(t.designer,"UploadAction",e)}}),e.hide()},e.prototype.populateMenuItems=function(e,t,i){for(var a,o,s=t.length,i=BoldBIDashboard.buildTag("ul.bbi-designer-menu","",{},{id:this.id+"_"+i+"ConfigMenu"}),n=[],r=0;r<s;r++)if(a=t[r],n.push({id:a.id,text:a.text,parentId:null}),t[r].Items)for(o=0;o<t[r].Items.length;o++)n.push({id:t[r].Items[o].id,text:t[r].Items[o].text,parentId:a.id});e.append(i),i.BoldBIDashboardMenu({menuType:BoldBIDashboard.MenuType.ContextMenu,openOnClick:!1,ontextMenuTarget:"#"+this.toolBar.attr("id"),subMenuDirection:"right",fields:{dataSource:n,id:"id",parentId:"parentId",text:"text"},click:this.bbdesigner$.proxy(this.onFileActionChange,this)})},e.prototype.onSettingsLeave=function(){var e=this.bbdesigner$("#"+this.id+"_openConfigMenu").data("BoldBIDashboardMenu");e&&e.hide(),(e=this.bbdesigner$("#"+this.id+"_saveConfigMenu").data("BoldBIDashboardMenu"))&&e.hide()},e.prototype.onFileActionChange=function(e){"fromDevice"===e.ID?this.designer.triggerEvents("openReportClick",{target:e,select:"Device"})||this.browseDiskReport():"fromServer"===e.ID?this.designer.triggerEvents("openReportClick",{target:e,select:"Server"})||this.openServerClick():"save"===e.ID?this.designer.triggerEvents("saveReportClick",{target:e,select:"Save"})||this.designer.saveAsReport():"toDevice"===e.ID?this.designer.triggerEvents("saveReportClick",{target:e,select:"SaveAsDevice"})||this.designer.downloadReport():"toServer"!==e.ID&&"saveAs"!==e.ID||this.designer.triggerEvents("saveReportClick",{target:e,select:"SaveAsServer"})||this.saveServerClick()},e.prototype.appendToolbarTitle=function(e){this.titleTextBox=BoldBIDashboard.buildTag("input.e-textbox .e-reportdesigner-title-textbox","",{height:"26px",width:"200px"},{type:"text",id:this.id+"_toolbar_title"}),e.append(this.titleTextBox)},e.prototype.appendToolbarTogglebutton=function(e){this.dataSampleEnable=e.find(".e-designe-switcher-wrap"),this.dataSampleCheck=e.find(".e-switcher-check")},e.prototype.switcherChanged=function(){this.isDataSampleEnabled=this.dataSampleCheck.is(":checked"),this.queryDesigner=this.designer.modules.queryDesigner,this.designer.modules.util.doAjaxPost("POST",this.designer.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.notifypropertychange,{action:BoldBIDashboard.DashboardUtil.DesignerAction.DataSampleCheck,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.DataSampleCheck,isDataSampleEnable:this.isDataSampleEnabled})},{}),this.designer.modules.dataSet.pouplateDataSets()},e.prototype.updateDataSample=function(e){e?this.dataSampleCheck.prop("checked",!0):this.dataSampleCheck.prop("checked",!1)},e.prototype.ShowDataSample=function(e){e?this.dataSampleCheck.removeAttr("disabled"):this.dataSampleCheck.attr("disabled","true")},e.prototype.saveToolBarTitle=function(){var e=this.designer.designerPanel.getDesignProperty();this.propertyPanel.targetDesignArea="Dashboard",this.propertyPanel.onValueChange({name:"Name",value:e.Header},"General","Dashboard",!1,!0)},e.prototype.getDashboardTitleText=function(){return this.titleTextBox.val()},e.prototype.updateDashboardTitleText=function(e){BoldBIDashboard.isNullOrUndefined(e)||this.titleTextBox.val(e)},e.prototype.onPublishBtnClick=function(e){this.designer.modules.serialization.notifyChange(),"click"===e.type?BoldBIDashboard.isNullOrUndefined(e.currentTarget)||e.currentTarget.id!==this.id+"_publishButton_menu"?this.designer.saveAsReport(e):this.saveServerClick(e):"itemSelected"===e.type&&this.saveServerClick(e)},e.prototype.triggerActionBeginForPublish=function(e){var t=!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings)&&!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings.enableMarkAsPublic)&&this.designer.model.serverSettings.enableMarkAsPublic,i=!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings)&&!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings.isPublic)&&this.designer.model.serverSettings.isPublic;return this.designer._trigger("actionBegin",{eventType:"publishAsAction",source:{element:e,data:{dashboardId:this.designer.model.itemId,dashboardName:this.designer.reportFileName,dashboardDescription:this.designer.dashboardDescription,enablePublicCheckbox:t,isPublicDashboard:i}}})},e.prototype.appendSplitBtn=function(e,t,i,a,o){var s=BoldBIDashboard.buildTag("li.bbi-designer-toolbarli bbi-designer-splitbtn bbi-dbrd-designer-hoverable bbi-dbrd-icon-background-theme","",{width:"37px"},{id:this.id+"_toolbar_li_"+t,"data-tooltip":t}),a=BoldBIDashboard.buildTag("span.e-split e-drop e-widget","",{width:"37px",display:"inline-table",margin:a},{id:this.id+"_toolbar_"+t}),n=BoldBIDashboard.buildTag("span.e-in-wrap e-box e-padding"),t=BoldBIDashboard.buildTag("button.e-splitbutton e-js e-btn e-split-btn e-ntouch e-left-btn bbi-dbrd-hand-cursor e-droparrowright bbi-designer-click bbi-designer-ejwidgets-splitbtn bbi-dbrd-icon-background-theme","",{height:"25px",width:"35px","padding-right":"12px"},{id:this.id+"_splitbtn_"+t,"e-target":o,type:"button"}),r=BoldBIDashboard.buildTag("div"),i=BoldBIDashboard.buildTag("span.bbi-toolbarfonticonbasic "+i),d=BoldBIDashboard.buildTag("div.e-split-btn-div","",{position:"absolute",height:"100%"}),l=BoldBIDashboard.buildTag("span.e-icon e-arrow-sans-down","",{"padding-top":"4px"});d.append(l),r.append(i),t.append(d),n.append(t),a.append(n),s.append(a),e.append(s),o&&0<o.length&&a.attr("e-target",o)},e.prototype.appendPreview=function(e){var o,t,s,n=this,r=[],d=null,i=BoldBIDashboard.buildTag("ul.bbi-designer-toolbarul bbi-toolbar-right-ul","",{}),a=BoldBIDashboard.buildTag("ul.bbi-designer-toolbarul bbi-toolbar-savestatuslabel-ul","",{});this.saveStatusWarning=BoldBIDashboard.buildTag("span.bbi-ddr-draft-status","",{},{id:this.id+"_auto_save_status_icon"}),this.saveStatusLabel=BoldBIDashboard.buildTag("label.bbi-designer-toolbar-content-label","",{},{id:this.id+"_auto_save_status_label"}),t=BoldBIDashboard.buildTag("div.bbi-designer-content-container","",{float:"right","margin-right":"10px"},{}),r.push({class:"bbi-designer-toolbar-secondary-btn bbi-preview-btn ",label:this.locale.menuBar.previewText,elementId:this.id+"_previewButton"}),r.push({class:"bbi-dbrd-btn-primary bbi-designer-toolbar-publish-btn",label:this.locale.saveMenuItemsText.publish,elementId:this.id+"_publishButton"}),r.push({class:"bbi-dbrd-btn-primary bbi-designer-toolbar-publishas-btn",label:this.locale.saveMenuItemsText.publishAs,elementId:this.id+"_publishButton_menu"}),this.designer.model.mode===BoldBIDashboard.Designer.mode.design&&this.designer._trigger("beforeDesignerToolbarButtonsRendered",{toolbarButtons:r}),0!==r.length&&((d=BoldBIDashboard.buildTag("div.bbi-prerview-btn-wrapper","",{},{id:this.id+"_div_preview_btn"})).append(BoldBIDashboard.DashboardUtil.getSeperator()),s=2===r.filter(function(e){return e.elementId===n.id+"_publishButton_menu"||e.elementId===n.id+"_publishButton"}).length,r.forEach(function(e){var t,i=BoldBIDashboard.buildTag("div.bbi-btn-wrapper","",{},{}),a=BoldBIDashboard.buildTag("button."+(BoldBIDashboard.isNullOrUndefined(e.class)?"":e.class),e.label,{},{id:n.designer.generateUniqueButtonId(e),type:"button"});e.elementId===n.id+"_publishButton"?s?(o=BoldBIDashboard.buildTag("div.bbi-publish-btn-wrapper","",{},{id:n.id+"_div_publish_btn"}),a.removeClass("bbi-dbrd-btn-primary"),t=r.filter(function(e){return e.elementId===n.id+"_publishButton_menu"})[0].label,n.appendPublishButton(o,a,t),d.append(o)):n.appendToolBarButtons(i,a,d):e.elementId===n.id+"_publishButton_menu"?s||n.appendToolBarButtons(i,a,d):(e.elementId!==n.id+"_previewButton"&&(a.hasClass("bbi-dbrd-btn-primary")||a.hasClass("bbi-designer-toolbar-secondary-btn")||a.addClass("bbi-designer-toolbar-secondary-btn"),a.bind("click",n.bbdesigner$.proxy(n.toolbarClick,n))),i.append(a),d.append(i))})),t.append(this.saveStatusWarning,this.saveStatusLabel),0!==r.length&&i.append(d),BoldBIDashboard.isNullOrUndefined(d)||d.find(".bbi-toolbar-seperator").css({display:"none"}),a.append(t),e.append(a,i),this.designer.model.mode!==BoldBIDashboard.Designer.mode.connection&&this.saveStatusLabel.BoldBIDashboardTooltip({content:"",isBalloon:!1,beforeOpen:this.bbdesigner$.proxy(function(e){var t,i=n.saveStatusLabel.attr("data-datetime");BoldBIDashboard.isNullOrUndefined(i)&&""===i?e.cancel=!0:(t=new Date(i),e.model.content=n.saveStatusWarning.hasClass("bbi-ddr-draft-status-progress")?n.locale.toolBar.saving:n.saveStatusWarning.hasClass("bbi-ddr-draft-status-error")?n.locale.toolBar.draftError+":"+(BoldBIDashboard.isNullOrUndefined(i)||""===i?"Never":BoldBIDashboard.globalize.format(t,n.designer.model.localeSettings.dateFormat,n.designer.model.localeSettings.culture)+" "+BoldBIDashboard.globalize.format(t,n.designer.model.localeSettings.timeFormat,n.designer.model.localeSettings.culture)):n.locale.toolBar.lastSave+BoldBIDashboard.globalize.format(t,n.designer.model.localeSettings.dateFormat,n.designer.model.localeSettings.culture)+" "+BoldBIDashboard.globalize.format(t,n.designer.model.localeSettings.timeFormat,n.designer.model.localeSettings.culture),n.saveStatusLabel.data("BoldBIDashboardTooltip").tooltipContent.html(e.model.content))},this)})},e.prototype.appendToolBarButtons=function(e,t,i){e.append(t),i.append(e),t.bind("click",this.bbdesigner$.proxy(this.toolbarClick,this))},e.prototype.appendPublishButton=function(e,t,i){var a=BoldBIDashboard.buildTag("ul.bbi-publish-menu-ul","",{},{id:this.id+"_publishButton_menu"}),o=BoldBIDashboard.buildTag("li","",{id:this.id+"_publishButton_menu_li"}),i=BoldBIDashboard.buildTag("a",i,{}).attr({href:"javascript:void(0)"}),s=BoldBIDashboard.buildTag("span.e-dbrd-toolbar-seperator","",{},{id:this.id+""});o.append(i),a.append(o),e.append(t,s,a),t.BoldBIDashboardSplitButton({targetID:this.id+"_publishButton_menu",width:"100%",height:"30px",click:this.bbdesigner$.proxy(this.toolbarClick,this),itemSelected:this.bbdesigner$.proxy(this.toolbarClick,this)})},e.prototype.setZoomSelectedIndex=function(e){this.zoomSelectedIndex=e},e.prototype.getZoomValue=function(e){var t=0;return e?0===this.zoomSelectedIndex?t=parseInt(this.items[this.zoomSelectedIndex].split("%")[0],10):(t=parseInt(this.items[this.zoomSelectedIndex-1].split("%")[0],10),this.zoomSelectedIndex=this.zoomSelectedIndex-1):this.zoomSelectedIndex===this.items.length-1?t=parseInt(this.items[this.zoomSelectedIndex].split("%")[0],10):(t=parseInt(this.items[this.zoomSelectedIndex+1].split("%")[0],10),this.zoomSelectedIndex=this.zoomSelectedIndex+1),t},e.prototype.toolbarClick=function(e){var t,i,a;if(this.onSettingsLeave(e),t=this.bbdesigner$(e.target),a=this.bbdesigner$(t).closest(".bbi-designer-toolbarli"),this.bbdesigner$(t).hasClass("bbi-designer-toolbarli")?t=this.bbdesigner$(t).find("span.bbi-li-item"):0<a.length&&(t=this.bbdesigner$(a).find("span.bbi-li-item")),t.hasClass("bbi-designer-toolbar-open-folder"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Open"}))||((a=this.bbdesigner$("#"+this.id+"_openConfigMenu")).is(":visible")?a.hide():this.showOpenMenu(e));else if(t.hasClass("bbi-designer-toolbar-new"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"New"}))||this.newReportClick();else if(t.hasClass("bbi-designer-toolbar-save"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Save"}))||((a=this.bbdesigner$("#"+this.id+"_saveConfigMenu")).is(":visible")?a.hide():this.showSaveMenu(e));else if(t.hasClass("bbi-designer-toolbar-undo"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Undo"}))||window.setTimeout(function(){BoldBIDashboardDesigner.editManager.isUndo()&&BoldBIDashboardDesigner.editManager.undo()},300);else if(t.hasClass("bbi-designer-toolbar-redo"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Redo"}))||window.setTimeout(function(){BoldBIDashboardDesigner.editManager.isRedo()&&BoldBIDashboardDesigner.editManager.redo()},300);else if(t.hasClass("bbi-designer-toolbar-cut"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Cut"}))||this.designer.designerPanel.cutItem();else if(t.hasClass("bbi-designer-toolbar-copy"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Copy"}))||this.designer.designerPanel.copyItem();else if(t.hasClass("bbi-designer-toolbar-paste"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Paste"}))||this.designer.designerPanel.pasteItem();else if(t.hasClass("bbi-designer-toolbar-delete"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Delete"}))||this.designer.designerPanel.removeItem();else if(t.hasClass("bbi-toolbar-localizedashboard-icon"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Localize Dashboard"}))||this.designer.modules.dynamicLanguageTranslatorHelper.openDynamicTranslationDialog();else if(t.hasClass("bbi-toolbar-refreshsettings-icon e-dbrd-banner-refresh"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Refresh"}))||this.openRefreshSettings();else if(t.hasClass("bbi-designer-toolbar-datacache-icon bbi-designer-toolbar-datacache"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"DataCache"}))||this.openDataCacheDialog();else if(t.hasClass("bbi-designer-configuration-parameters"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Filter Action"}))||this.openFilterActionWindow();else if(t.hasClass("bbi-preview-btn"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Preview"}))||this.designer.PreviewDashboard();else if(t.hasClass("bbi-designer-toolbar-publish-btn"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Publish"}))||this.onPublishBtnClick(e);else if(t.hasClass("bbi-designer-toolbar-publishas-btn"))(i=this.designer.triggerEvents("toolbarClick",{target:t,click:"Publish As"}))||this.onPublishBtnClick(e);else if(0!==t.length||BoldBIDashboard.isNullOrUndefined(e.type)||BoldBIDashboard.isNullOrUndefined(e.model))a=BoldBIDashboard.DashboardUtil.IsStringNullorWhiteSpace(t.html())?this.bbdesigner$(t).closest(".bbi-designer-toolbarli").attr("data-tooltip"):t.html(),this.designer.triggerEvents("toolbarClick",{target:e,click:a});else{switch(i=!1,e.type){case"click":i=this.designer.triggerEvents("toolbarClick",{target:this.toolBar.find("#"+this.id+"_publishButton"),click:"Publish"});break;case"itemSelected":i=this.designer.triggerEvents("toolbarClick",{target:this.bbdesigner$.find(e.model.target),click:"Publish As"})}i||this.onPublishBtnClick(e)}},e.prototype.openDataCacheDialog=function(){var e=this.designer.modules.dataCache;e.renderCacheDialog(),e.openDataCacheDialog(null!=this.designer.cacheSettings&&!0===this.designer.cacheSettings.isCacheEnable?this.designer.cacheSettings:e)},e.prototype.openFilterActionWindow=function(){var e=null!=this.filterSerializer.filterObject.filterConfigurationModel?(this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection=this.removeDuplicateWidgetCollection(),this.filterSerializer.RefreshMasterSlaveTitle(),this.bbdesigner$.parseJSON(JSON.stringify(this.filterSerializer.filterObject.filterConfigurationModel))):this.bbdesigner$.parseJSON(JSON.stringify(this.filterSerializer.GetWidgetCollectionsFromContainer()));this.designer.modules.filterConfiguration.openFilterConfiguration(this,"filterUpdate",e)},e.prototype.removeDuplicateWidgetCollection=function(){var e=[];return this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection.forEach(function(t){0===e.filter(function(e){return e.MasterInfo.UniqueId===t.MasterInfo.UniqueId}).length&&e.push(t)}),e},e.prototype.openRefreshSettings=function(){var e=this.designer.modules.refreshDialog;e.openRefreshDialog(this.designer.refreshSetting,this.bbdesigner$.proxy(e.updateRefreshSetting,e))},e.prototype.updateFilterCondition=function(e,t){var i,a,o,s,n,r=this.designer.designerPanel.selectedReportItems[0];if(!BoldBIDashboard.isNullOrUndefined(r))if(r=this.widgetHelper.getCurrentWidgetInstance(),i=this.designer.modules.propertyPanel,e)t||this.filterSerializer.RemoveSelectedWidgetFromFilterObject(),BoldBIDashboard.isNullOrUndefined(r)||BoldBIDashboard.isNullOrUndefined(r.getJson())||(r.getJson().FilterSettings.ActAsMasterWidget=t,i.isVisible()&&i.setBoolean(null,null,"Filter",{name:"ActAsMasterWidget",value:t},r.Type));else if(null!=this.filterSerializer.filterObject.filterConfigurationModel)for(a=this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection,o=0;o<a.length;o++)if(0<a[o].ProfileManager.length){for(s=0;s<a[o].ProfileManager.length;s++)a[o].ProfileManager[s].ProfileInfo.Option||(n=BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.designer.element.find("#"+this.designer._id+"_"+a[o].MasterInfo.ID)),n=this.filterSerializer.getFilterCondition(n),a[o].ProfileManager[s].ProfileInfo.FilterCondition=n);this.filterSerializer.masterSlaveFilterSerializer(a)}},e.prototype.removeFilterCondition=function(e){var t,i,a,o;if(!(BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(this.filterSerializer.filterObject)||BoldBIDashboard.isNullOrUndefined(this.filterSerializer.filterObject.filterConfigurationModel)||BoldBIDashboard.isNullOrUndefined(this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection))){for(t=this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection,i=0;i<t.length;i++)for(a=0;a<t[i].ProfileManager.length;a++)for(o=0;o<t[i].ProfileManager[a].ProfileInfo.FilterCondition.length;o++)t[i].ProfileManager[a].ProfileInfo.FilterCondition[o].DataSource.ID===e&&t[i].ProfileManager[a].ProfileInfo.FilterCondition.splice(o,1);this.filterSerializer.masterSlaveFilterSerializer(t)}},e.prototype.filterUpdate=function(e){this.setWidgetAsMaster(e),this.filterSerializer.filterObject.filterConfigurationModel=e,this.filterSerializer.masterSlaveFilterSerializer(this.filterSerializer.filterObject.filterConfigurationModel.MastersCollection),setTimeout(function(e){e.filterSerializer.updatePoPSettings()},200,this)},e.prototype.setWidgetAsMaster=function(e){for(var t,i,a,o,s,n=this.designer.modules.propertyPanel,r=this.filterSerializer.getMastetFilterWidgets(),d=0;d<r.length;d++){for((t=r[d]).getJson().FilterSettings.ActAsMasterWidget=!1,i=0;i<e.MastersCollection.length;i++)if(e.MastersCollection[i].MasterInfo.ID===r[d].Name){s={name:"ActAsMasterWidget",value:!0},a=t.getJson().FilterSettings.ActAsMasterWidget,t.getJson().FilterSettings.ActAsMasterWidget=!0,t.updatePropertyChange(s.name,a,!0,s);break}o=t.getJson().FilterSettings.ActAsMasterWidget,0!==t.ControlContainer.find(".bbi-dbrd-control-header").length&&(this.filterSerializer.showOrHideClearFilterIcon(t.ControlContainer.find(".bbi-dbrd-control-header"),o),n.isVisible())&&!BoldBIDashboard.isNullOrUndefined(this.widgetHelper.getCurrentWidgetInstance())&&this.widgetHelper.getCurrentWidgetInstance().Name===t.Name&&n.setBoolean(null,null,"Filter",s={name:"ActAsMasterWidget",value:o},t.Type)}},e.prototype.getAvailableReportItems=function(){for(var e,t=this.designer.modules.Mode.designCanvas.find(".bbi-dbrditem"),i=[],a=0;a<t.length;a++)e=BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(this.bbdesigner$(t[a])),i.push(e.getJson());return i},e.prototype.renderNewFile=function(){this.newFileDiv=BoldBIDashboard.buildTag("div.bbi-userselect","",{padding:"2px"},{id:this.id+"_createFileContainer",title:this.createReportText});var e=BoldBIDashboard.buildTag("div","",{width:"100%",height:"80px"}),t=BoldBIDashboard.buildTag("table","",{id:this.id+"_createFileInternalContainer"}),i=BoldBIDashboard.buildTag("tr","",{}),a=BoldBIDashboard.buildTag("td","",{"padding-bottom":"5px"}),o=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","File Name",{"font-size":"12px","font-color":"#303541","font-weight":"600"},{type:"label"}),s=BoldBIDashboard.buildTag("tr","",{}),n=BoldBIDashboard.buildTag("td","",{}),r=BoldBIDashboard.buildTag("input.bbi-designer-inputPath e-textbox","",{"padding-left":"8px","border-radius":"2px"},{id:this.id+"_CreateInput"}),d=(BoldBIDashboard.DashboardUtil.txtWaterMark(r,this.fileWaterMark),BoldBIDashboard.buildTag("tr","",{})),l=BoldBIDashboard.buildTag("td","",{}),h=BoldBIDashboard.buildTag("span.bbi-designer-errorLog bbi-designer-fontfamily","",{"font-size":"12px"}),p=BoldBIDashboard.buildTag("button.bbi-designer-cancelbtn bbi-dbrd-hand-cursor",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_cancelBtn",type:"button"}),c=BoldBIDashboard.buildTag("button.bbi-designer-okbtn bbi-dbrd-hand-cursor",this.locale.menuBar.createButtonText,{float:"right"},{id:this.id+"_CreateButton",type:"button"});this.newFileDiv.append(e),e.append(t),t.append(i),i.append(a),a.append(o),t.append(s),s.append(n),n.append(r),t.append(d),d.append(l),l.append(h),this.designer.element.append(this.newFileDiv),this.newFileDiv.BoldBIDashboardDialog({enableModal:!0,enableResize:!1,showRoundedCorner:!0,minWidth:290,minHeight:100,height:"auto",width:"auto",showOnInit:!1,showFooter:!0,containment:"#"+this.designer._id,target:"#"+this.designer._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.designer.element.find("#"+this.id+"_createFileContainer_foot").append(p,c),c.on("click",this.bbdesigner$.proxy(this.onCreate,this)),p.on("click",this.bbdesigner$.proxy(this.closeNewDialog,this,!0))},e.prototype.onCreate=function(){var e=this.designer.element.find("#"+this.id+"_CreateInput").val(),t=this.newFileDiv.find(".bbi-designer-errorLog");e&&0<e.length&&e.toLowerCase()!==this.fileWaterMark.toLowerCase()?(this.callBackfn?BoldBIDashboard.DashboardUtil.invokeCallBack(this.callBackfn,{name:e}):(e=-1===e.indexOf(".rdl")?e+".rdl":e,this.designer.newRDLReport(e),t.text("")),this.newFileDiv.BoldBIDashboardDialog("close")):t.text("* Specify the report file name")},e.prototype.onfileSelect=function(e){this.designer.reportFileName=e.files[0].name},e.prototype.onuploadError=function(){this.designer.hideDesignIndicator(),this.designer.modules.util.alertDialog(this.locale.alertDialogTitle.upload,this.locale.errorMessage.failedToUploadFile,IconType.errors,AlertType.Alert,!1,"")},e.prototype.closeNewDialog=function(){this.newFileDiv.find(".bbi-designer-inputPath").removeClass("bbi-designer-txtmark"),this.newFileDiv.data("BoldBIDashboardDialog").close()},e.prototype.onuploadComplete=function(e){this.designer.hideDesignIndicator(),this.designer.modules.util.doAjaxPost("POST",this.designer.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.openReport,data:JSON.stringify({designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.openReport,fileName:e.files.name})},{method:"openRdlJSON",instance:this.designer,indicator:["showDesignIndicator","hideDesignIndicator"]})},e.prototype.showPaste=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Paste"))},e.prototype.showCopy=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Copy"))},e.prototype.showDelete=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Delete"))},e.prototype.showCut=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Cut"))},e.prototype.showUndo=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Undo"))},e.prototype.showRedo=function(e){BoldBIDashboard.isNullOrUndefined(this.toolBar.data("BoldBIDashboardToolbar"))&&this.toolBar.BoldBIDashboardToolbar(),this.toolBar.BoldBIDashboardToolbar(e?"enableItem":"disableItem",this.designer.element.find("#"+this.id+"_designer_toolbar_li_Redo"))},e.prototype.browseDiskReport=function(){this.designer.element.find("#"+this.id+"_rdl_upload .e-uploadinput").click()},e.prototype.openNewDialog=function(e){this.callBackfn=e,this.newFileDiv.find(".bbi-designer-errorLog").text(""),this.newFileDiv.find(".bbi-designer-inputPath").val(this.fileWaterMark).addClass("bbi-designer-txtmark"),this.newFileDiv.data("BoldBIDashboardDialog").open()},e.prototype.newReportClick=function(){this.callBackfn=null,this.newFileDiv.find(".bbi-designer-errorLog").text(""),this.newFileDiv.find(".bbi-designer-inputPath").val(this.fileWaterMark),this.newFileDiv.data("BoldBIDashboardDialog").open()},e.prototype.openServerClick=function(){this.designer.modules.fileBrowse.openBrowseDialog(this,"openServerReport",BrowseType.Open)},e.prototype.openServerReport=function(e,t){this.designer.openReport(t+"/"+e.Name,null)},e.prototype.saveServerClick=function(e){this.triggerActionBeginForPublish(e)||this.designer.modules.fileBrowse.openBrowseDialog(this,"saveServerReport",BrowseType.Publish,null,this.designer.reportFileName,this.designer.dashboardDescription)},e.prototype.saveServerReport=function(e,t,i,a,o,s){this.designer.serverCategory={name:t,description:i,category:e.Name,categoryId:e.Id,eventType:s,id:o,isPublic:!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings)&&!BoldBIDashboard.isNullOrUndefined(this.designer.model.serverSettings.isPublic)&&this.designer.model.serverSettings.isPublic},this.designer.createServerReport(this.designer.serverCategory)},e.prototype.showOpenMenu=function(e){var t=this.designer.element.find("#"+this.id+"_toolbar_li_Open"),i=t.closest("ul");this.bbdesigner$("#"+this.id+"_openConfigMenu").data("BoldBIDashboardMenu").show(t.offset().left,i.offset().top+i.height(),this.toolBar,e)},e.prototype.showSaveMenu=function(e){var t=this.designer.element.find("#"+this.id+"_toolbar_li_Publish"),i=t.closest("ul");this.bbdesigner$("#"+this.id+"_saveConfigMenu").data("BoldBIDashboardMenu").show(t.offset().left,i.offset().top+i.height(),this.toolBar,e)},e.prototype.updateToolbar=function(){var e=this.designer.model.toolbarSettings;this.showToolBar(e.showToolbar),this.showNewBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.New),this.showOpenBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Open),this.showSaveBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Save),this.showCutBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Cut),this.showCopyBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Copy),this.showPasteBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Paste),this.showDeletBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Delete),this.showUndoBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Undo),this.showRedoBtn(e.items&BoldBIDashboard.Designer.ToolbarItems.Redo),this.showDesign(e.items&BoldBIDashboard.Designer.ToolbarItems.EditDesign)},e.prototype.showToolBar=function(e){this.toolBar.css("display",e?"block":"none"),e||this.updateToolBarSize()},e.prototype.updateToolBarSize=function(){var e,t,i,a,o,s,n;this.designer.model.mode===BoldBIDashboard.Designer.mode.design&&this.designer.model.IsEmbed&&(s=this.designer.element.find("#"+this.id+"_itemPanelContainer"),e=this.designer.element.find("#"+this.id+"_designSurfaceContainer"),t=this.designer.element.find("#"+this.id+"_dataPanelContainer"),i=this.designer.element.find("#"+this.id+"_scrollContentDesignPanel"),!BoldBIDashboard.isNullOrUndefined(s))&&!BoldBIDashboard.isNullOrUndefined(e)&&!BoldBIDashboard.isNullOrUndefined(t)&&0<this.designer.element.length&&(n=(a=parseFloat(this.bbdesigner$("#"+this.id+"_toolBar").css("height")))+(o=parseFloat(this.bbdesigner$("#"+this.id+"_designSurfaceContainer").css("height")))-2+"px",s.css("height",s=a+o+"px"),e.css("height",s),t.css("height",s),i.css("height",n))},e.prototype.showNewBtn=function(e){this.designer.element.find("#"+this.id+"_toolbar_li_New").css("display",e?"block":"none")},e.prototype.showOpenBtn=function(e){this.designer.element.find("#"+this.id+"_toolbar_li_Open").css("display",e?"block":"none")},e.prototype.showSaveBtn=function(e){this.designer.element.find("#"+this.id+"_toolbar_li_Save").css("display",e?"block":"none")},e.prototype.showCutBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Cut").css("display",e?"block":"none")},e.prototype.showCopyBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Copy").css("display",e?"block":"none")},e.prototype.showPasteBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Paste").css("display",e?"block":"none")},e.prototype.showDeletBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Delete").css("display",e?"block":"none")},e.prototype.showUndoBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Undo").css("display",e?"block":"none")},e.prototype.showRedoBtn=function(e){this.designer.element.find("#"+this.id+"_designer_toolbar_li_Redo").css("display",e?"block":"none")},e.prototype.showDesign=function(e){this.designer.element.find("#"+this.id+"_viewer_editdiv").css("display",e?"block":"none")},e.prototype.updateRptTextActions=function(){var e=this.designer.designerPanel,t=e.selectedReportItems&&0<e.selectedReportItems.length;this.showPaste(e.canPaste()),this.showCopy(t),this.showCut(t),this.showDelete(t)},e.prototype.updateAutoSavedTime=function(e){this.saveStatusLabel&&e?(this.saveStatusWarning.removeClass("bbi-ddr-draft-status-progress").addClass("bbi-ddr-draft-status-success"),this.saveStatusLabel.attr({"data-datetime":(new Date).toISOString()}),this.updateRelativeTime(new Date),null===this.relativeDateTimer&&(this.relativeDateTimer=this.initializeRelativeTimer()),this.designer.model.lastDraftSavedTime=(new Date).toISOString()):(this.saveStatusWarning.removeClass("bbi-ddr-draft-status-progress").addClass("bbi-ddr-draft-status-error"),this.saveStatusLabel.text(this.locale.saveDraftText.draftFailedMessageText),this.saveStatusWarning.show())},e.prototype.initializeRelativeTimer=function(){var e=this;return setTimeout(this.bbdesigner$.proxy(function(){e.updateRelativeTime(),clearTimeout(e.relativeDateTimer),e.relativeDateTimer=e.initializeRelativeTimer()},this),6e4)},e.prototype.updateRelativeTime=function(e){var e=e||new Date,t=this.saveStatusLabel.attr("data-datetime");BoldBIDashboard.isNullOrUndefined(t)||""===t||this.saveStatusWarning.hasClass("bbi-ddr-draft-status-error bbi-ddr-draft-status-progress")||(this.saveStatusLabel.text(this.locale.saveDraftText.saveDraft+this.getRelativeTime(e,new Date(t))),this.updateToolbarForOndemandAction())},e.prototype.updateToolbarForOndemandAction=function(){var i=0,e=this.toolBar.find(".bbi-designer-toolbarul"),t=this.toolBar.find(".e-toolbar-seperator");this.bbdesigner$.each(e,function(e,t){i+=t.offsetWidth}),this.bbdesigner$.each(t,function(e,t){i+=t.offsetWidth}),this.toolBar.width()<=i+69&&"block"!==this.toolBar.find("#"+this.id+"_toolBar_target").css("display")&&this.updateSize(),this.updateSaveStatusLabel()},e.prototype.updateSaveStatusLabel=function(){var e=this.toolBar.find(".bbi-designer-toolbarul.bbi-toolbar-right-ul"),t=this.toolBar.find(".bbi-designer-toolbarul.bbi-toolbar-savestatuslabel-ul"),e="block"===this.toolBar.find("#"+this.id+"_toolBar_target").css("display")?this.toolBar.width()-this.toolBar.find("#"+this.id+"_toolBar_target").position().left:this.toolBar.width()-(0<e.length?e.position().left:0);t.css({right:e+"px"})},e.prototype.getRelativeTime=function(e,t){var e=Math.floor((e.getTime()-t.getTime())/6e4),t=Math.floor(e/60),i=Math.floor(t/24);return e<1?this.locale.saveDraftText.draftUpdatedJustNowText:e<2?this.locale.saveDraftText.draftUpdatedAMinsAgoText:e<60?e+" "+this.locale.saveDraftText.draftUpdatedMinutesAgoText:e<120?this.locale.saveDraftText.draftUpdatedAnHourAgoText:t<24?t+" "+this.locale.saveDraftText.draftUpdatedHoursAgoText:i<2?this.locale.saveDraftText.draftUpdatedYesterdayText:i+" "+this.locale.saveDraftText.draftUpdatedDaysAgoText},e.prototype.updateCulture=function(e){var t=this.id,e=(BoldBIDashboard.Designer.Locale[e]||BoldBIDashboard.Designer.Locale["en-US"]).menuBar;this.createReportText=e.createReport,this.createButtonText=e.createButtonText,this.openReportText=e.openReport,this.designer.element.find("#"+t+"_createFileContainer").html(this.createReportText),this.designer.element.find("#"+t+"_CreateButton").html(this.createButtonText),this.designer.element.find("#"+t+"_openFileContainer").html(this.openReportText)},e.prototype.updateSize=function(){this.ejDesignerTool.option("width",this.designer.element.find("#"+this.id+"_designerContainer").width()),this.ejDesignerTool._activeItem=void 0,this.ejDesignerTool._reSizeHandler()},e.prototype.updateResponsiveMenuIcon=function(){var e=0<this.bbdesigner$("#"+this.id+"_toolBar_hiddenlist").find(".bbi-designer-toolbarul .bbi-designer-toolbarli").length,t=0<this.bbdesigner$("#"+this.id+"_toolBar_hiddenlist").find(".bbi-designer-toolbarul .bbi-prerview-btn-wrapper").length;e||t?this.toolBar.find(".e-icon.e-toolbar-res-arrow").css({display:"block"}):this.toolBar.find(".e-icon.e-toolbar-res-arrow").css({display:"none"})},e.prototype.wireEvents=function(){this.bbdesigner$("body").on("click","#"+this.id+"_previewButton",this.bbdesigner$.proxy(this.toolbarClick,this))},e.prototype.unWireEvents=function(){this.bbdesigner$("body").off("click","#"+this.id+"_previewButton",this.bbdesigner$.proxy(this.toolbarClick,this))},e.prototype.destroy=function(){this.unWireEvents()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.Toolbar",InternalToolbar,window),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){var t,i,a;function o(){return null!==i&&i.apply(this,arguments)||this}(e=e.Dashboard||(e.Dashboard={})).ExpressionDialogModel=function(){this.FunctionUI=new t,this.Datasource=[]},t=function(){},e.ExpUIModel=t,e.ExpDatasource=function(){},e.ExpressionDataStruct=a=function(){},__extends(o,i=a),e.ExpColumnDataStruct=o,(a=e.State||(e.State={}))[a.Enable=0]="Enable",a[a.Disable=1]="Disable",a[a.Hidden=2]="Hidden",(a=e.FunctionName||(e.FunctionName={})).All="All",a.Numbers="Numbers",a.Aggregation="Aggregation",a.Conditional="Conditional",a.Logical="Logical",a.Date="Date",a.String="String",a.Row="Row",(a=e.FieldName||(e.FieldName={})).All="All",a.Number="Number",a.Text="Text",a.Date="Date",a.Boolean="Boolean",a.Parameter="Parameters",a.Miscellaneous="Miscellaneous"}(BoldBIDashboard=BoldBIDashboard||{}),InternalCredentialDialog=function(){function e(e){this.id=null,this.userWaterMark="Username",this.passwdWaterMark="Password",this.userNameTag=null,this.passwordTag=null,this.locale=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.renderCredentialDialog()}return e.prototype.renderCredentialDialog=function(){this.divDialog=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{height:"auto"},{title:"Credential Dialog",id:this.id+"_credential_dialog"});var e=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_table_id"}),t=BoldBIDashboard.buildTag("table.bbi-designer-credential-table","",{width:"100%"},{unselectable:"on"}),i=this.bbdesigner$("<tr></tr>"),a=this.bbdesigner$("<td></td>"),o=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Username",{"font-size":"13px","padding-bottom":"2px"},{type:"label"}),s=this.bbdesigner$("<tr></tr>"),n=this.bbdesigner$("<td></td>"),r=this.userNameTag=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox-border bbi-designer-border","",{height:"23px",width:"238px"},{type:"text",id:this.id+"_txt_box"}),d=(BoldBIDashboard.DashboardUtil.txtWaterMark(r,this.userWaterMark),this.bbdesigner$("<tr></tr>")),l=this.bbdesigner$("<td></td>"),h=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","",{"margin-bottom":"2px",color:" red","font-size":"12px"},{type:"label",id:this.id+"_label_user_validation"}),p=this.bbdesigner$("<tr></tr>"),c=this.bbdesigner$("<td></td>"),u=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","Password",{"font-size":"13px","padding-bottom":"2px"},{type:"label"}),b=this.bbdesigner$("<tr></tr>"),g=this.bbdesigner$("<td></td>"),m=this.passwordTag=BoldBIDashboard.buildTag("input.e-textbox bbi-designer-textbox-border bbi-designer-border","",{height:"23px",width:"238px"},{type:"text",id:this.id+"_pass_word"}),f=(BoldBIDashboard.DashboardUtil.txtWaterMark(m,this.passwdWaterMark,!0),this.bbdesigner$("<tr></tr>")),D=this.bbdesigner$("<td></td>"),y=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","",{"margin-bottom":"2px",color:" red","font-size":"12px"},{type:"label",id:this.id+"_label_pass_validation"}),B=this.bbdesigner$("<tr></tr>"),I=this.bbdesigner$("<td></td>"),x=BoldBIDashboard.buildTag("Label.bbi-designer-fontfamily","",{"margin-bottom":"3px",color:" red","font-size":"13px"},{type:"label",id:this.id+"_label_alert"}),_=BoldBIDashboard.buildTag("button.bbi-designer-connect bbi-dbrd-designer-hand-cursor","",{"margin-left":"80px"},{id:this.id+"_btn_login",type:"button"});this.dashboardDesigner.element.append(this.divDialog),this.divDialog.append(e),e.append(t),i.append(a),t.append(i),a.append(o),s.append(n),t.append(s),n.append(r),t.append(d),d.append(l),l.append(h),t.append(p),p.append(c),c.append(u),t.append(b),b.append(g),g.append(m),t.append(f),f.append(D),D.append(y),B.append(I),t.append(B),I.append(x),this.divDialog.BoldBIDashboardDialog({enableModal:!0,minWidth:250,width:280,enableResize:!1,showOnInit:!1,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",minHeight:75,height:"auto",showFooter:!0,containment:"#"+this.id,target:"#"+this.id,beforeClose:this.bbdesigner$.proxy(this.closeDialog,this),close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.dashboardDesigner.element.find("#"+this.id+"_credential_dialog_foot").append(_),_.BoldBIDashboardButton({showRoundedCorner:!1,width:"95px",size:"small",height:"30px",type:"submit",text:"Connect",click:this.bbdesigner$.proxy(this.connectLoginWindow,this,!0)}),this.divDialog.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()})},e.prototype.connectLoginWindow=function(){var e,t=this.userNameTag.val(),i=this.passwordTag.val();this.userFieldValidation(this.id,0===t.length||t.toLowerCase()===this.userWaterMark,"Please enter Username"),this.passFieldValidation(this.id,0===i.length||i.toLowerCase()===this.passwdWaterMark,"Please enter Password"),0!==t.length&&0!==i.length&&t.toLowerCase()!==this.userWaterMark&&i.toLowerCase()!==this.passwdWaterMark&&(e=this.datasourceInfo.Name,this.datasourceInfo.Username=t,this.datasourceInfo.Password=i,e={Name:e,Provider:this.datasourceInfo.ConnectionProperties.DataProvider,IsIntegrated:!1,Username:BoldBIDashboard.DashboardUtil.encryptData(t),Password:BoldBIDashboard.DashboardUtil.encryptData(i),ConnectionString:BoldBIDashboard.DashboardUtil.encryptData(this.datasourceInfo.ConnectionProperties.ConnectString)},this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.modules.util.ejInstance.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ConnectAndReconnectAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.testConnection,datasource:e})},{fnction:this.bbdesigner$.proxy(this.validateConnection,this),indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]}))},e.prototype.updateConnectionProperties=function(){var e={__type:"Syncfusion.Dashboard.Web.Serialization.Model.DataSources.DataSource"};return e.Name=this.datasourceInfo.Name,e.Transaction=!1,e.DataSourceReference=null,e.ConnectionProperties={},e.ConnectionProperties.__type="Syncfusion.Dashboard.Web.Serialization.Model.Connection.ConnectionProperties",e.ConnectionProperties.ConnectString=this.datasourceInfo.ConnectionProperties.ConnectString,e.ConnectionProperties.EmbedCredentials=!1,e.ConnectionProperties.DataProvider=this.datasourceInfo.ConnectionProperties.DataProvider,e.ConnectionProperties.IntegratedSecurity=!1,e.ConnectionProperties.UserName=this.datasourceInfo.Username,e.ConnectionProperties.PassWord=this.datasourceInfo.Password,e.ConnectionProperties.Prompt=this.datasourceInfo.ConnectionProperties.Prompt,e},e.prototype.userFieldValidation=function(e,t,i){t?(this.divDialog.find("#"+this.id+"_label_alert").css("display","none"),this.divDialog.find("#"+e+"_label_user_validation").css("display","block"),this.divDialog.find("#"+e+"_label_user_validation").text("* "+i)):this.divDialog.find("#"+e+"_label_user_validation").css("display","none")},e.prototype.passFieldValidation=function(e,t,i){t?(this.divDialog.find("#"+this.id+"_label_alert").css("display","none"),this.divDialog.find("#"+e+"_label_pass_validation").css("display","block"),this.divDialog.find("#"+e+"_label_pass_validation").text("* "+i)):this.divDialog.find("#"+e+"_label_pass_validation").css("display","none")},e.prototype.validateConnection=function(e){"true"===e?(this.datasourceInfo=this.updateConnectionProperties(),this.divDialog.find("#"+this.id+"_label_alert").css("display","none"),this.targetInstance&&this.targetMethod&&BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.datasourceInfo]),this.divDialog.data("BoldBIDashboardDialog").close()):(this.divDialog.find("#"+this.id+"_label_alert").css("display","block"),this.divDialog.find("#"+this.id+"_label_alert").text(e))},e.prototype.resetCredentialDialog=function(){this.userNameTag.val(this.userWaterMark).addClass("bbi-designer-txtmark"),this.passwordTag.val(this.passwdWaterMark).addClass("bbi-designer-txtmark"),this.divDialog.find("#"+this.id+"_label_user_validation").css("display","none"),this.divDialog.find("#"+this.id+"_label_pass_validation").css("display","none"),this.divDialog.find("#"+this.id+"_label_alert").css("display","none"),this.datasourceInfo=null,this.targetInstance=null,this.targetMethod=null},e.prototype.openCredentialDialog=function(e,t,i,a){this.resetCredentialDialog(),this.datasourceInfo=t,this.targetInstance=i,this.targetMethod=a;i=this.divDialog.data("BoldBIDashboardDialog");i.open(),i.setModel({title:t.ConnectionProperties.Prompt&&0<t.ConnectionProperties.Prompt.length?t.ConnectionProperties.Prompt:"Credential-  "+e}),this.passwordTag.val(this.passwdWaterMark).addClass("bbi-designer-txtmark"),this.passwordTag.attr("type","text"),this.userNameTag.focus()},e.prototype.closeDialog=function(e){e.isInteraction&&this.dashboardDesigner.modules.queryDesigner.enableDataSourceDwn(!0),this.hideWaitingIndicator()},e.prototype.showIndicator=function(){BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_btn_login"),!1),this.divDialog.data("BoldBIDashboardWaitingPopup").show()},e.prototype.hideIndicator=function(){BoldBIDashboard.DashboardUtil.buttonEnable(this.dashboardDesigner.element.find("#"+this.id+"_btn_login"),!0),this.divDialog.data("BoldBIDashboardWaitingPopup").hide()},e.prototype.hideWaitingIndicator=function(){this.divDialog.data("BoldBIDashboardWaitingPopup")&&this.divDialog.data("BoldBIDashboardWaitingPopup").hide()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.CredentialDialog",InternalCredentialDialog,window),ConfigurationPanel=function(){function e(e,t){this.dashboardDesigner=null,this.occupyFullWidth=!1,this.resizeObj={isPropertyPanel:!0,isDataSet:!0,isParameter:!1,isImageManager:!1},this.collapseDiv=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.targetTag=t,this.rendererItemPanel()}return e.prototype.rendererItemPanel=function(){var e=this.dashboardDesigner._id,t={GroupName:"Properties",DisplayName:this.locale.dataConfigurationPanel.properties,GroupClass:"bbi-dashboardicon bbi-designer-configuration-settings",GroupId:e+"_Properties"},i={GroupName:"DataSource",DisplayName:this.locale.dataConfigurationPanel.dataSource,GroupClass:"bbi-dashboardicon bbi-designer-configuration-dataset",GroupId:e+"_DataSource"};this.panelItems=[t],this.dashboardDesigner.model.designerSettings.dataSourceConfig.hideDataSourceConfig||((t=Array.prototype.slice.call(this.panelItems)).push(i),this.panelItems=t),this.expandablePanel=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration","",{width:"463px",height:"100%",display:"block",overflow:"hidden",float:"left","box-sizing":"border-box"},{id:e+"_designerConfigurationPanel"}),this.targetTag.append(this.expandablePanel),this.expandablePanel.css("display","none"),this.renderToolBarPanel(this.panelItems)},e.prototype.showDataConfigurationPanel=function(){this.expandablePanel.css("display","block"),this.expandablePanel.css("width","100%")},e.prototype.renderToolBarPanel=function(e){var t,i=Array.prototype.slice.call(e);for(this.toolBarPanel=BoldBIDashboard.buildTag("div.bbi-designer-itempanel-header","",{width:"36px",height:"100%"},{id:this.dashboardDesigner._id+"_configurationHeaderPanel"}),this.renderTooltip(),t=0;t<i.length;t++){var a=i[t],o=BoldBIDashboard.buildTag("div.bbi-designer-itempanel-wrapper bbi-dbrd-icon-background-theme","",{width:"35px",height:"35px"},{id:a.GroupId+"_wrapper"}),a=BoldBIDashboard.buildTag("div","",{cursor:"pointer"},{id:this.dashboardDesigner._id+"_"+a.GroupName,class:a.GroupClass+" bbi-designer-itempanel-icon bbi-dbrd-designer-hoverable","data-tooltip":a.DisplayName});o.on("click",this.bbdesigner$.proxy(this.onGroupItemsClick,this,e[t])),o.append(a),this.toolBarPanel.append(o)}0<i.length&&this.renderCollapseItem(),this.targetTag.append(this.toolBarPanel)},e.prototype.renderCollapseItem=function(){var e;0===this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_collapse_wrapper").length&&(this.collapseDiv=BoldBIDashboard.buildTag("div.bbi-designer-itempanel-wrapper bbi-dashboarddesigner-collapsable-item bbi-dbrd-icon-background-theme","",{},{id:this.dashboardDesigner._id+"_collapse_wrapper"}),e=BoldBIDashboard.buildTag("div","",{cursor:"pointer"},{id:this.dashboardDesigner._id+"_collapseItem",class:"bbi-dashboardicon bbi-dashboarddesigner-configuration-collapse bbi-designer-itempanel-icon bbi-dbrd-icon-theme bbi-dbrd-designer-hoverable","data-tooltip":this.locale.dataConfigurationPanel.collapse}),this.collapseDiv.on("click",this.bbdesigner$.proxy(this.onCollapseItemClick,this)),this.collapseDiv.append(e),this.targetTag.append(this.collapseDiv))},e.prototype.renderTooltip=function(){var e=this.dashboardDesigner._id,t=BoldBIDashboard.buildTag("div.e-tooltip-wrap e-widget bbi-userselect bbi-designer-config-tooltip","",{display:"none"},{id:e+"_config_tooltip"}),i=BoldBIDashboard.buildTag("div.e-arrowTip","",{height:"20px",width:"10px",top:"4px",display:"block"},{id:e+"_config_arrow_tooltip"}),a=BoldBIDashboard.buildTag("div.e-arrowTipOuter","",{}),o=BoldBIDashboard.buildTag("div.e-arrowTipInner","",{left:"0px",top:"1px"});i.append(a).append(o),a=BoldBIDashboard.buildTag("div.e-tipContainer","",{}),o=BoldBIDashboard.buildTag("div.e-tipcontent e-def","",{},{id:e+"_config_content_tooltip"}),a.append(o),t.append(i).append(a),this.toolBarPanel.append(t)},e.prototype.onGroupItemsClick=function(e){this.selectedItem===e?(this.showConfigurationPanel(!1,e.GroupName,e),this.collapseDiv.css("display","none")):(this.showConfigurationPanel(!0,e.GroupName,e),this.collapseDiv.css("display","block")),BoldBIDashboard.DashboardUtil.refreshIndicator(this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_designSurfaceContainer"))},e.prototype.onCollapseItemClick=function(){this.collapseDiv.css("display","none"),this.showConfigurationPanel(!1,this.selectedItem.GroupName,this.selectedItem),this.dashboardDesigner.modules.propertyPanel.resetDataTab()},e.prototype.getPanelItem=function(e){for(var t=Array.prototype.slice.call(this.panelItems),i=0;i<t.length;i++)if(t[i].GroupName===e)return t[i]},e.prototype.showConfigurationPanel=function(e,t,i){var a,o,s,n,r=Array.prototype.slice.call(this.panelItems);if(BoldBIDashboard.isNullOrUndefined(i))for(a=0;a<r.length;a++)if(this.panelItems[a].GroupName===t){i=this.panelItems[a];break}e||BoldBIDashboard.isNullOrUndefined(this.selectedItem)?e&&((e=this.validatePanelSwitch(t))||("DataSource"===this.selectedItem.GroupName?this.dashboardDesigner.modules.dataSet.isDataSourceWiz()?(o=this.dashboardDesigner.modules.dataSource.isEdit,s=this.locale.alertDialogTitle.CancelDataSourceCreation,n=this.locale.alertWindowMesages.datasourceCancel,o&&(s=this.locale.alertDialogTitle.EditDataSourceConnection,n=this.locale.alertWindowMesages.datasourceEditing),this.dashboardDesigner.modules.util.alertDialog(s,n,IconType.information,AlertType.Confirm,!1,"",{dataInfo:{Name:t,Item:i},instance:this,method:"confirmSwitchWiz"})):(o=this.dashboardDesigner.modules.dataSet.isEdit,s=this.locale.alertDialogTitle.CancelDataSourceCreation,n=this.locale.alertWindowMesages.datasourceCancel,o&&(s=this.locale.alertDialogTitle.EditDataSourceConnection,n=this.locale.alertWindowMesages.datasourceEditing),this.dashboardDesigner.modules.util.alertDialog(s,n,IconType.question,AlertType.Confirm,!1,"",{dataInfo:{Name:t,Item:i},instance:this,method:"confirmSwitchWiz"})):"Parameters"===this.selectedItem.GroupName&&(o=this.dashboardDesigner.modules.parameter.isEdit,n=this.locale.alertWindowMesages.parameterCancel,o&&(n=this.locale.alertWindowMesages.parameterEditing),this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.parameter,n,IconType.information,AlertType.Confirm,!1,"",{dataInfo:{Name:t,Item:i},instance:this,method:"confirmSwitchWiz"}))),e)&&this.updatePanelDisplay(t,i,!1):(this.toolBarPanel.find("#"+i.GroupId+"_wrapper").css("background-color","transparent"),this.validateDisplay(this.selectedItem.GroupName,!1),this.expandablePanel.css("display","none"),this.targetTag.css("width","36px"),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner)||this.updateDesignContainerWidth((this.selectedItem.GroupName,464)),this.selectedItem=null)},e.prototype.confirmSwitchWiz=function(e,t){e&&!BoldBIDashboard.isNullOrUndefined(t)&&this.updatePanelDisplay(t.Name,t.Item,!0)},e.prototype.updatePanelDisplay=function(e,t,i){this.expandablePanel.css("display","block"),this.targetTag.css("width","500px"),this.expandablePanel.css("width","464px"),BoldBIDashboard.isNullOrUndefined(this.selectedItem)?BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner)||this.updateDesignContainerWidth(-464):(this.toolBarPanel.find("#"+this.selectedItem.GroupId+"_wrapper").css("background-color","transparent"),this.validateDisplay(this.selectedItem.GroupName,!1),this.selectedItem.GroupName===t.GroupName||(this.selectedItem.GroupName,0)||BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner)||this.updateDesignContainerWidth((t.GroupName,-210))),this.selectedItem=t,this.validateDisplay(t.GroupName,!0),this.toolBarPanel.find("#"+t.GroupId+"_wrapper").css("background-color","white"),this.toolBarPanel.find("#"+t.GroupId+"_wrapper").css("border-bottom-width","1px"),i&&0<(t=this.dashboardDesigner.designerPanel.selectedItems).length&&"Properties"===this.selectedItem.GroupName&&this.bbdesigner$(t[0]).attr("designPanel")&&(i=this.dashboardDesigner.designerPanel.getDesignProperty(),this.dashboardDesigner.modules.propertyPanel.showPropertyItem(i,"Dashboard"))},e.prototype.loadDataSet=function(){this.dashboardDesigner.modules.dataSet.isLoaded()||this.dashboardDesigner.modules.dataSet.renderContainer(this.expandablePanel)},e.prototype.validatePanelSwitch=function(e){var t=!1,i=this.expandablePanel.find("#"+this.dashboardDesigner._id+"_datasetSourceTag"),a=this.expandablePanel.find("#"+this.dashboardDesigner._id+"_dataSourceTag"),o=this.expandablePanel.find("#"+this.dashboardDesigner._id+"_parameterList");return BoldBIDashboard.isNullOrUndefined(this.selectedItem)||this.selectedItem.GroupName===e?t=!0:BoldBIDashboard.isNullOrUndefined(this.selectedItem)||(t="Datasource"===this.selectedItem.GroupName?0===a.length||0<a.length&&"block"===a.css("display"):"DataSource"===this.selectedItem.GroupName?0===i.length||0<i.length&&!this.dashboardDesigner.modules.dataSet.isConfigWizard():"Parameters"!==this.selectedItem.GroupName||0===o.length||0<o.length&&!this.dashboardDesigner.modules.parameter.isConfigWizard()),t},e.prototype.resizeConfigurationPanel=function(e){e||this.targetTag.css("width","500px"),this.occupyFullWidth=e,this.updateDesignAreaWidth(e)},e.prototype.showDataSetPanel=function(e){var t=this.dashboardDesigner.modules.dataSet;t.isLoaded()||this.dashboardDesigner.modules.dataSet.renderContainer(this.expandablePanel),t.showDataSet(e,this.resizeObj),this.dashboardDesigner.modules.sharedDataSource.abortRequest()},e.prototype.showParameterPanel=function(e){var t=this.dashboardDesigner.modules.parameter;t.isLoaded()||this.dashboardDesigner.modules.parameter.renderContainer(this.expandablePanel),t.showParameter(e,this.resizeObj)},e.prototype.showPropertyPanel=function(e){var t=this.dashboardDesigner.modules.propertyPanel;t.isLoaded()||this.dashboardDesigner.modules.propertyPanel.renderContainer(this.expandablePanel),t.showPropertyPanel(e,this.resizeObj)},e.prototype.validateDisplay=function(e,t){switch(t?(this.targetTag.find("#"+this.dashboardDesigner._id+"_"+e).addClass("bbi-designer-itempanel-selection"),this.targetTag.find("#"+this.dashboardDesigner._id+"_"+e+"_wrapper").addClass("bbi-designer-itempanel-selection")):(this.targetTag.find("#"+this.dashboardDesigner._id+"_"+e).removeClass("bbi-designer-itempanel-selection"),this.targetTag.find("#"+this.dashboardDesigner._id+"_"+e+"_wrapper").removeClass("bbi-designer-itempanel-selection")),e){case"Properties":this.showPropertyPanel(t);break;case"DataSource":this.showDataSetPanel(t);break;case"Parameters":this.showParameterPanel(t)}},e.prototype.updateSize=function(){this.resizeObj.isPropertyPanel=this.resizeObj.isDataSource=this.resizeObj.isDataSet=this.resizeObj.isParameter=this.resizeObj.isImageManager=!0,this.expandablePanel.find("#"+this.dashboardDesigner._id+"_propertyPanel").is(":visible")?(this.dashboardDesigner.modules.propertyPanel.updatePanelSize(),this.resizeObj.isPropertyPanel=!1):this.expandablePanel.find("#"+this.dashboardDesigner._id+"_datasetContainer").is(":visible")?(this.dashboardDesigner.modules.dataSet.updateSize(),this.resizeObj.isDataSet=!1):this.targetTag.find("#"+this.dashboardDesigner._id+"_param_Container").is(":visible")&&(this.dashboardDesigner.modules.parameter.updateSize(),this.resizeObj.isParameter=!1)},e.prototype.updateDesignAreaWidth=function(e){this.dashboardDesigner.updateConfigPanel(e),BoldBIDashboard.isNullOrUndefined(this.dashboardDesigner.designerPanel)||this.dashboardDesigner.designerPanel.updateScrollBar()},e.prototype.updateDesignContainerWidth=function(){this.dashboardDesigner.updateDesignPanel(),this.dashboardDesigner.designerPanel.updateScrollBar();var e=this.dashboardDesigner.modules.layoutDialog;BoldBIDashboard.isNullOrUndefined(e)||e.getCookie()||e.updatePosition()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DataConfigurationPanel",ConfigurationPanel,window),function(e){(e.Dashboard||(e.Dashboard={})).HierachialModel=function(){this.ShowVisibility=!1,this.ShowNodeIcon=!0,this.ShowDataTypeIcon=!1,this.ShowSettings=!1,this.CanDragDrop=!0}}(BoldBIDashboard=BoldBIDashboard||{}),function(u){var b;function e(){this.key="Designer",this.locale=window[this.key].App.LocalizationContent}b=u.Dashboard||(u.Dashboard={}),e.prototype.getNumberDataJson=function(){return this.jsonData=[{ID:"ABS",Name:"ABS",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.absDesc,Example:this.locale.expressionDesigner.expressionHelper.absEx,State:2},{ID:"ACOS",Name:"ACOS",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.acosDesc,Example:this.locale.expressionDesigner.expressionHelper.acosEx,State:0},{ID:"ASIN",Name:"ASIN",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.asinDesc,Example:this.locale.expressionDesigner.expressionHelper.asinEx,State:0},{ID:"ATAN",Name:"ATAN",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.atanDesc,Example:this.locale.expressionDesigner.expressionHelper.atanEx,State:0},{ID:"COS",Name:"COS",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.cosDesc,Example:this.locale.expressionDesigner.expressionHelper.cosEx,State:0},{ID:"COT",Name:"COT",CategoryName:"Numbers",Description:"Returns the cotangent of the angle specified in radians of the given expression.",Example:"COT(numeric_expression)",State:0},{ID:"CEIL",Name:"CEIL",CategoryName:"Numbers",Description:"Returns the smallest integer value that is greater than or equal to the given numeric expression",Example:"CEIL(numeric_expression)",State:0},{ID:"DEGREES",Name:"DEGREES",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.degDesc,Example:this.locale.expressionDesigner.expressionHelper.degEx,State:0},{ID:"EXP",Name:"EXP",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.expDesc,Example:this.locale.expressionDesigner.expressionHelper.expEx,State:0},{ID:"FLOOR",Name:"FLOOR",CategoryName:"Numbers",Description:"Returns the largest integer value that is less than or equal to the given numeric expression.",Example:"FLOOR(numeric_expression)",State:0},{ID:"LOG",Name:"LOG",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.logDesc,Example:this.locale.expressionDesigner.expressionHelper.logEx,State:0},{ID:"MOD",Name:"MOD",CategoryName:"Numbers",Description:"Returns the remainder of the first numeric expression divided by second numeric expression.",Example:"MOD(numeric_expression, numeric_expression)",State:0},{ID:"PI",Name:"PI",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.piDesc,Example:this.locale.expressionDesigner.expressionHelper.piEx,State:0},{ID:"POWER",Name:"POWER",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.powerDesc,Example:this.locale.expressionDesigner.expressionHelper.powerEx,State:0},{ID:"RADIANS",Name:"RADIANS",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.radDesc,Example:this.locale.expressionDesigner.expressionHelper.radEx,State:0},{ID:"ROUND",Name:"ROUND",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.roundDesc,Example:this.locale.expressionDesigner.expressionHelper.roundEx,State:0},{ID:"SIGN",Name:"SIGN",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.signDesc,Example:this.locale.expressionDesigner.expressionHelper.signEx,State:0},{ID:"SIN",Name:"SIN",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.sinDesc,Example:this.locale.expressionDesigner.expressionHelper.sinEx,State:0},{ID:"SQRT",Name:"SQRT",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.sqrtDesc,Example:this.locale.expressionDesigner.expressionHelper.sqrtEx,State:0},{ID:"TOTALPERCENTAGE",Name:"TOTALPERCENTAGE",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.percentageDesc,Example:this.locale.expressionDesigner.expressionHelper.percentageEx,State:0},{ID:"TAN",Name:"TAN",CategoryName:"Numbers",Description:this.locale.expressionDesigner.expressionHelper.tanDesc,Example:this.locale.expressionDesigner.expressionHelper.tanEx,State:0}]},e.prototype.getConditonalDataJson=function(){return this.jsonData=[{ID:"COALESCE",Name:"COALESCE",CategoryName:"Conditional",Description:"Returns the first non-NULL expression among its arguments, or NULL if all its arguments are NULL",Example:"COALESCE(exp1,exp2,...exp(n))",State:0},{ID:"IF",Name:"IF",CategoryName:"Conditional",Description:this.locale.expressionDesigner.expressionHelper.ifDesc,Example:this.locale.expressionDesigner.expressionHelper.ifEx,State:0},{ID:"IFNULL",Name:"IFNULL",CategoryName:"Conditional",Description:this.locale.expressionDesigner.expressionHelper.ifNullDesc,Example:this.locale.expressionDesigner.expressionHelper.ifNullEx,State:0},{ID:"ISNOTNULL",Name:"ISNOTNULL",CategoryName:"Conditional",Description:this.locale.expressionDesigner.expressionHelper.isNotNullDesc,Example:this.locale.expressionDesigner.expressionHelper.isNotNullEx,State:0},{ID:"ISNULL",Name:"ISNULL",CategoryName:"Conditional",Description:this.locale.expressionDesigner.expressionHelper.isNullDesc,Example:this.locale.expressionDesigner.expressionHelper.isNullEx,State:0}]},e.prototype.getLogicalDataJson=function(){return this.jsonData=[{ID:"AND",Name:"AND",CategoryName:"Logical",Description:this.locale.expressionDesigner.expressionHelper.andDesc,Example:this.locale.expressionDesigner.expressionHelper.andEx,State:0},{ID:"NOT",Name:"NOT",CategoryName:"Logical",Description:this.locale.expressionDesigner.expressionHelper.notDesc,Example:this.locale.expressionDesigner.expressionHelper.notEx,State:0},{ID:"OR",Name:"OR",CategoryName:"Logical",Description:this.locale.expressionDesigner.expressionHelper.orDesc,Example:this.locale.expressionDesigner.expressionHelper.orEx,State:0}]},e.prototype.getDateDataJson=function(){return this.jsonData=[{ID:"CURRENTYEAR",Name:"CURRENTYEAR",CategoryName:"Date",Description:"Returns the current year.",Example:"CURRENTYEAR()",State:0},{ID:"CURRENTMONTH",Name:"CURRENTMONTH",CategoryName:"Date",Description:"Returns the current month.",Example:"CURRENTMONTH()",State:0},{ID:"DATEADD",Name:"DATEADD",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dateAddDesc,Example:this.locale.expressionDesigner.expressionHelper.dateAddEx,State:0},{ID:"DATEDIFF",Name:"DATEDIFF",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dateDiffDesc,Example:this.locale.expressionDesigner.expressionHelper.dateDiffEx,State:0},{ID:"DATENAME",Name:"DATENAME",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dateNameDesc,Example:this.locale.expressionDesigner.expressionHelper.dateNameEx,State:0},{ID:"DATEPART",Name:"DATEPART",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.datePartDesc,Example:this.locale.expressionDesigner.expressionHelper.datePartEx,State:0},{ID:"DATESUB",Name:"DATESUB",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dateSubDesc,Example:this.locale.expressionDesigner.expressionHelper.dateSubEx,State:0},{ID:"DAY",Name:"DAY",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dayDesc,Example:this.locale.expressionDesigner.expressionHelper.dayEx,State:0},{ID:"DAYDIFF",Name:"DAYDIFF",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.dayDiffDesc,Example:this.locale.expressionDesigner.expressionHelper.dayDiffEx,State:0},{ID:"HOUR",Name:"HOUR",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.hourDesc,Example:this.locale.expressionDesigner.expressionHelper.hourEx,State:0},{ID:"MAX",Name:"MAX",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.maxDesc,Example:this.locale.expressionDesigner.expressionHelper.maxEx,State:0},{ID:"MIN",Name:"MIN",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.minDesc,Example:this.locale.expressionDesigner.expressionHelper.minEx,State:0},{ID:"MINUTE",Name:"MINUTE",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.minutesDesc,Example:this.locale.expressionDesigner.expressionHelper.minutesEx,State:0},{ID:"MONTH",Name:"MONTH",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.monthDesc,Example:this.locale.expressionDesigner.expressionHelper.monthEx,State:0},{ID:"NOW",Name:"NOW",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.nowDesc,Example:this.locale.expressionDesigner.expressionHelper.nowEx,State:0},{ID:"PREVIOUSMONTH",Name:"PREVIOUSMONTH",CategoryName:"Date",Description:"Returns the previous month.",Example:"PREVIOUSMONTH()",State:0},{ID:"PREVIOUSYEAR",Name:"PREVIOUSYEAR",CategoryName:"Date",Description:"Returns the previous year.",Example:"PREVIOUSYEAR()",State:0},{ID:"TODAY",Name:"TODAY",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.todayDesc,Example:this.locale.expressionDesigner.expressionHelper.todayEx,State:0},{ID:"YEAR",Name:"YEAR",CategoryName:"Date",Description:this.locale.expressionDesigner.expressionHelper.yearDesc,Example:this.locale.expressionDesigner.expressionHelper.yearEx,State:0},{ID:"YESTERDAY",Name:"YESTERDAY",CategoryName:"YESTERDAY",Description:"Returns the yesterday date.",Example:"YESTERDAY()",State:0}]},e.prototype.getStringDataJson=function(){return this.jsonData=[{ID:"CHAR",Name:"CHAR",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.charDesc,Example:this.locale.expressionDesigner.expressionHelper.charEx,State:0},{ID:"CONCAT",Name:"CONCAT",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.concatDesc,Example:this.locale.expressionDesigner.expressionHelper.concatEx,State:0},{ID:"CONTAINS",Name:"CONTAINS",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.containsDesc,Example:this.locale.expressionDesigner.expressionHelper.containsEx,State:0},{ID:"ENDSWITH",Name:"ENDSWITH",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.endsWithDesc,Example:this.locale.expressionDesigner.expressionHelper.endsWithEx,State:0},{ID:"INITCAP",Name:"INITCAP",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.initCapDesc,Example:this.locale.expressionDesigner.expressionHelper.initCapEx,State:0},{ID:"LEFT",Name:"LEFT",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.leftDesc,Example:this.locale.expressionDesigner.expressionHelper.leftEx,State:0},{ID:"LEN",Name:"LEN",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.lenDesc,Example:this.locale.expressionDesigner.expressionHelper.lenEx,State:0},{ID:"LOWER",Name:"LOWER",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.lowerDesc,Example:this.locale.expressionDesigner.expressionHelper.lowerEx,State:0},{ID:"LTRIM",Name:"LTRIM",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.ltrimDesc,Example:this.locale.expressionDesigner.expressionHelper.ltrimEx,State:0},{ID:"MAX",Name:"MAX",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.maxStrDesc,Example:this.locale.expressionDesigner.expressionHelper.maxStrEx,State:0},{ID:"MIN",Name:"MIN",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.minStrDesc,Example:this.locale.expressionDesigner.expressionHelper.minStrEx,State:0},{ID:"REPLACE",Name:"REPLACE",CategoryName:"String",Description:"Replaces all occurrences of the substring within the given string expression, with the new_substring.",Example:" REPLACE(string_expression, substring, new_substring)",State:0},{ID:"RIGHT",Name:"RIGHT",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.rightDesc,Example:this.locale.expressionDesigner.expressionHelper.rightEx,State:0},{ID:"RTRIM",Name:"RTRIM",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.rtrimDesc,Example:this.locale.expressionDesigner.expressionHelper.rtrimEx,State:0},{ID:"STARTSWITH",Name:"STARTSWITH",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.startsWithDesc,Example:this.locale.expressionDesigner.expressionHelper.startsWithEx,State:0},{ID:"SUBSTR",Name:"SUBSTR",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.substrDesc,Example:this.locale.expressionDesigner.expressionHelper.substrEx,State:0},{ID:"TRIM",Name:"TRIM",CategoryName:"String",Description:"Removes the leading and trailing spaces from the given string expression.",Example:"TRIM(string_expression)",State:0},{ID:"UPPER",Name:"UPPER",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.upperDesc,Example:this.locale.expressionDesigner.expressionHelper.upperEx,State:0},{ID:"HTML_PPARSER",Name:"HTML_PARSER",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.htmlParseDesc,Example:this.locale.expressionDesigner.expressionHelper.htmlParseEx,State:0},{ID:"XML_PARSER",Name:"XML_PARSER",CategoryName:"String",Description:this.locale.expressionDesigner.expressionHelper.xmlParseDesc,Example:this.locale.expressionDesigner.expressionHelper.xmlParseEx,State:0}]},e.prototype.getAggDataJson=function(){return this.jsonData=[{ID:"AVG",Name:"AVG",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.avgDesc,Example:this.locale.expressionDesigner.expressionHelper.avgEx,State:0},{ID:"AVGD",Name:"AVGD",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.avgdDesc,Example:this.locale.expressionDesigner.expressionHelper.avgdEx,State:0},{ID:"COUNT",Name:"COUNT",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.countDesc,Example:this.locale.expressionDesigner.expressionHelper.countEx,State:0},{ID:"COUNTD",Name:"COUNTD",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.countdDesc,Example:this.locale.expressionDesigner.expressionHelper.countdEx,State:0},{ID:"MAX",Name:"MAX",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.maxAggDesc,Example:this.locale.expressionDesigner.expressionHelper.maxAggEx,State:0},{ID:"MIN",Name:"MIN",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.minAggDesc,Example:this.locale.expressionDesigner.expressionHelper.minAggEx,State:0},{ID:"STDEV",Name:"STDEV",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.stdDevDesc,Example:this.locale.expressionDesigner.expressionHelper.stdDevEx,State:0},{ID:"SUM",Name:"SUM",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.sumDesc,Example:this.locale.expressionDesigner.expressionHelper.sumEx,State:0},{ID:"SUMD",Name:"SUMD",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.sumdDesc,Example:this.locale.expressionDesigner.expressionHelper.sumdEx,State:0},{ID:"VAR",Name:"VAR",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.varDesc,Example:this.locale.expressionDesigner.expressionHelper.varEx,State:0},{ID:"STRING_AGG",Name:"STRING_AGG",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.string_aggDesc,Example:this.locale.expressionDesigner.expressionHelper.string_aggEx,State:0},{ID:"TOTAL",Name:"TOTAL",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.totalDesc,Example:this.locale.expressionDesigner.expressionHelper.totalEx,State:0},{ID:"QUANTILEEXACT",Name:"QUANTILEEXACT",CategoryName:"Aggregation",Description:this.locale.expressionDesigner.expressionHelper.quantileExactDesc,Example:this.locale.expressionDesigner.expressionHelper.quantileExactEx,State:0}]},e.prototype.getRowDataJson=function(){return this.jsonData=[{ID:"RUNNINGCOUNT",Name:"RUNNINGCOUNT",CategoryName:"Row",Description:this.locale.expressionDesigner.expressionHelper.runningCountDesc,Example:this.locale.expressionDesigner.expressionHelper.runningCountEx,State:0},{ID:"RUNNIGAVG",Name:"RUNNINGAVG",CategoryName:"Row",Description:this.locale.expressionDesigner.expressionHelper.runningAvgDesc,Example:this.locale.expressionDesigner.expressionHelper.runningAvgEx,State:0},{ID:"RUNNINGMAX",Name:"RUNNINGMAX",CategoryName:"Row",Description:this.locale.expressionDesigner.expressionHelper.runningMaxDesc,Example:this.locale.expressionDesigner.expressionHelper.runningMaxEx,State:0},{ID:"RUNNINGMIN",Name:"RUNNINGMIN",CategoryName:"Row",Description:this.locale.expressionDesigner.expressionHelper.runningMinDesc,Example:this.locale.expressionDesigner.expressionHelper.runningMinEx,State:0},{ID:"RUNNINGSUM",Name:"RUNNINGSUM",CategoryName:"Row",Description:this.locale.expressionDesigner.expressionHelper.runningSumDesc,Example:this.locale.expressionDesigner.expressionHelper.runningSumEx,State:0}]},e.prototype.getMultipleData=function(e){var t,i,a,o,s,n,r=[];return u.isNullOrUndefined(e)&&(e=this.getNumberDataJson(),t=this.getAggDataJson(),i=this.getConditonalDataJson(),a=this.getLogicalDataJson(),o=this.getDateDataJson(),s=this.getStringDataJson(),n=this.getRowDataJson(),r=[{ID:1,Name:b.FunctionName.Numbers,Value:e},{ID:2,Name:b.FunctionName.Aggregation,Value:t},{ID:3,Name:b.FunctionName.Conditional,Value:i},{ID:4,Name:b.FunctionName.Logical,Value:a},{ID:5,Name:b.FunctionName.Date,Value:o},{ID:6,Name:b.FunctionName.String,Value:s},{ID:7,Name:b.FunctionName.Row,Value:n}]),r},e.prototype.getMultipleColumnData=function(e,t){var i,a,o,s;if(u.isNullOrUndefined(t)){for(var n=[],r=[],d=[],l=[],h=[],p=[],c=0;c<e.length;c++)a=e[c].IsDynamicParam,e[c].DataType||"UnSupport"!==e[c].TypeName?e[c].IsExpression||"geography"!==(o=e[c].DataType||e[c].TypeName)&&"hierarchyid"!==o&&"xml"!==o&&(s=u.isNullOrUndefined(e[c].Value)||""===e[c].Value?e[c].Name:e[c].Value,"integer"===o.toLowerCase()||"real"===o.toLowerCase()?n.push({ID:c,Name:e[c].Name,Value:s,DataType:o,HasDynamicParams:a}):"string"===o.toLowerCase()?r.push({ID:c,Name:e[c].Name,Value:s,DataType:o,HasDynamicParams:a}):"date"===o.toLowerCase()?d.push({ID:c,Name:e[c].Name,Value:s,DataType:o,HasDynamicParams:a}):"boolean"===o.toLowerCase()&&l.push({ID:c,Name:e[c].Name,Value:s,DataType:o,HasDynamicParams:a}),!u.isNullOrUndefined(a))&&a&&p.push({ID:c,Name:e[c].Name,Value:s,DataType:o,HasDynamicParams:a}):h.push({ID:c,Name:e[c].Name,Value:e[c].Name,DataType:e[c].DataType||e[c].TypeName,HasDynamicParams:a});i=[{ID:1,Name:b.FieldName.Number,Value:n},{ID:2,Name:b.FieldName.Text,Value:r},{ID:3,Name:b.FieldName.Date,Value:d},{ID:4,Name:b.FieldName.Boolean,Value:l},{ID:5,Name:b.FieldName.Parameter,Value:p},{ID:6,Name:b.FieldName.Miscellaneous,Value:[]}]}return i},e.prototype.getDaMultipleColumnData=function(e,t){var i,a,o;if(u.isNullOrUndefined(t)){for(var s=[],n=[],r=[],d=[],l=0;l<e.length;l++)a=e[l].Type,o=e[l].Caption,"NUMERIC"===a?s.push({ID:l,Name:e[l].Caption,Value:o,DataType:e[l].Type,HasDynamicParams:!1}):"STRING"===a?n.push({ID:l,Name:e[l].Caption,Value:o,DataType:e[l].DataType,HasDynamicParams:!1}):"DATETIME"===a?r.push({ID:l,Name:e[l].Caption,Value:o,DataType:e[l].DataType,HasDynamicParams:!1}):"BOOLEAN"===a&&d.push({ID:l,Name:e[l].Caption,Value:o,DataType:e[l].DataType,HasDynamicParams:!1});i=[{ID:1,Name:b.FieldName.Number,Value:s},{ID:2,Name:b.FieldName.Text,Value:n},{ID:3,Name:b.FieldName.Date,Value:r},{ID:4,Name:b.FieldName.Boolean,Value:d},{ID:5,Name:b.FieldName.Miscellaneous,Value:[]}]}return i},b.ExpressionHelper=e}(BoldBIDashboard=BoldBIDashboard||{}),function(d){var e;function t(e,t){this.locale=null,d.isNullOrUndefined(t)||(this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=this.dashboardDesigner.getLocalizationContent(),this.model=t,this.menuHandler=new d.Dashboard.FieldMenuHandler(this.dashboardDesigner),this.dataConfig=new d.DashboardDesignerUtility.DataConfiguration(this.dashboardDesigner))}e=d.Dashboard||(d.Dashboard={}),t.prototype.render=function(e,t,i,a,o,s){var n,r=this;void 0===s&&(s=!1),this.scrollerDiv=d.isNullOrUndefined(i)?this.scrollerDiv:i,this.treeView=d.buildTag("div.e-dashboard-treeView","",{display:"inline-block",width:"100%","background-color":s?"transparent":"var(--designer-assigndata-background)"},{id:a+"_treeview_"+t[0].Id}),(n=new ejdashboard.navigations.TreeView({cssClass:"bbi-hierarchical-treeview",allowDragAndDrop:this.model.CanDragDrop,expandOn:"DblClick",nodeTemplate:s?this.getTreeViewTableTemplateForSSAS():this.getTreeViewTableTemplate(),nodeExpanded:this.bbdesigner$.proxy(this.nodeExpanded,this,this.scrollerDiv,s),nodeCollapsed:this.bbdesigner$.proxy(this.nodeCollapsed,this,this.scrollerDiv),drawNode:this.model.ShowVisibility||o?null:this.bbdesigner$.proxy(this.nodeVisibility,this),fields:{dataSource:t,id:"ColumnId",parentID:"ParentId",text:"Name",hasChildren:"HasChild"},dataBound:this.bbdesigner$.proxy(function(){r.bbdesigner$(n.element).find(".bbi-treeview-div .bbi-designer-dataset-column-deselect").closest("li").find(".bbi-text-content").addClass("deselect"),o||s||(r.bbdesigner$(n.element).find(".e-text-content.e-icon-wrapper").css("height","25px"),r.bbdesigner$(n.element).find(".e-list-parent.e-ul").css("overflow","hidden"),r.bbdesigner$(n.element).find(".e-icon-expandable").css({float:"right","margin-top":"3px"}),r.bbdesigner$(n.element).find(".e-icon-collapsible").css({float:"right","margin-top":"3px"}),"Dimensions"===t[0].ContainerName&&(r.bbdesigner$(n.element).find(".e-icon-expandable").css("margin-top","3px"),r.bbdesigner$(n.element).find(".e-icon-collapsible").css("margin-top","3px"),"bbi-designer-dataset-datetime"!==t[0].FieldActualType&&(r.bbdesigner$(n.element).find(".e-icon-expandable").css("margin-right","-13px"),r.bbdesigner$(n.element).find(".e-icon-collapsible").css("margin-right","-13px")),r.bbdesigner$(n.element).find(".e-list-item.e-level-1").css("position","relative").css("bottom","5px"),r.bbdesigner$(n.element).find(".e-icon-expandable").appendTo(r.bbdesigner$(n.element).find(".all-elements-div"))),"Dimensions"!==t[0].ContainerName&&(r.bbdesigner$(n.element).find(".e-list-item.e-level-1").css({position:"relative",bottom:"4px"}),r.bbdesigner$(n.element).find(".e-list-parent").addClass("e-treeview"),r.bbdesigner$(n.element).find(".e-list-parent").css("overflow","hidden"),r.bbdesigner$(n.element).find(".e-icon-expandable").appendTo(r.bbdesigner$(n.element).find(".all-elements-div"))))},this)})).appendTo(this.treeView[0]),e.append(this.treeView),o||s||(("bbi-designer-dataset-datetime"!==t[0].FieldActualType||"Dimensions"!==t[0].ContainerName&&"bbi-designer-dataset-datetime"===t[0].FieldActualType)&&(this.unwiredEvents(),this.wiredEvents()),"Dimensions"===t[0].ContainerName&&"bbi-designer-dataset-datetime"===t[0].FieldActualType&&e.find(".e-dashboard-treeView").css("margin-bottom","-5px"),e.find(".e-dashboard-treeView").css({"margin-left":"6px",width:"94%"})),e.data("DesignerPropertyWidget",this)},t.prototype.passOriginalFieldValues=function(e){this.realFieldInfo=e},t.prototype.getTreeViewTableTemplateForSSAS=function(){var e="<div class='bbi-treeview-div'><div style='float: left;'>";return this.model.ShowVisibility&&(e+="${if(ParentId === null && ColumnType === 'Dimension' || TreeNode === 'Measure' && TreeNode === 'Measure')}<span style=margin-right:7px;vertical-align:middle class='bbi-query-selection bbi-dbrd-designer-hoverable e-designer-select${if(IsVisible)} bbi-designer-dataset-column-select'data-tooltip='"+this.locale.queryDesigner.showDataTooltip+"'${else} bbi-designer-dataset-column-deselect'data-tooltip='"+this.locale.queryDesigner.hideDataTooltip+"'${/if} name='${Name}' aliasname='${Name}'></span>${/if}"),this.model.ShowNodeIcon&&(e+="<span style=vertical-align:middle class='bbi-heirarchial-icons bbi-designer-content-icon${if(ParentId === null && ColumnType ==='Dimension')} bbi-heirarchial-dimension${else if(ParentId !== null && ColumnType ==='Dimension' && TreeNode !== 'Level')} ${if(HasChild)} e-heirarchial-${TreeNode.toLowerCase()}1${else} e-heirarchial-${TreeNode.toLowerCase()}${LevelDepth}${/if} ${else if(TreeNode === 'Folder')} ${if(ColumnType === 'KPI')} e-heirarchial-${ColumnType.toLowerCase()} ${else} e-heirarchial-${TreeNode.toLowerCase()}${/if}${/if}'></span>"),this.model.ShowDataTypeIcon&&(e+="${if(TreeNode === 'Measure')}<span style=vertical-align:middle class='bbi-designer-content-icon bbi-heirarchial-icons${if(ColumnType === 'Measure')} bbi-designer-dataset-number${else if(ColumnType === 'CalculatedMeasure')} bbi-heirarchial-lambda${/if}'></span>${/if}"),e+="<span style='margin-left:7px;white-space:nowrap' class='e-user-select bbi-designer-fontfamily bbi-dbrd-designer-hoverable' e-column-type='${DataType}' datatype='${DefaultDataType}' treenode='${TreeNode}' hasChild='${HasChild}' data-tooltip='${Name}'>${Name}</span></div>",this.model.ShowSettings&&(e+="${if(ColumnType === 'Dimension')}${if(!HasChild)}<div style='margin-right: 5px; float:right' class='e-settings-div'><span id='${ ColumnId }_columnSettings' style=visibility:collapse;line-height:0px class='bbi-designer-content-icon bbi-designer-selection e-settings bbi-designer-click bbi-dbrd-designer-hoverable'/></div>${/if}${/if}"),e+"</div>"},t.prototype.getTreeViewTableTemplate=function(){var e="<div style='height:35px;${if(ContainerName === 'Dimensions' || ContainerName === 'Measures')}margin-left:-7px ${/if} ' class='bbi-treeview-div'><div style='float: left;height:35px;${if(HasChild)}width:100%${/if}' class='all-elements-div'>";return this.model.ShowVisibility&&(e+="${if(ParentId === null && ColumnType === 'Dimension' || TreeNode === 'Measure' && TreeNode === 'Measure')}<span style=margin-right:7px;vertical-align:middle class='bbi-query-selection bbi-dbrd-designer-hoverable e-designer-select${if(IsVisible)} bbi-designer-dataset-column-select'data-tooltip='"+this.locale.queryDesigner.showDataTooltip+"'${else} bbi-designer-dataset-column-deselect'data-tooltip='"+this.locale.queryDesigner.hideDataTooltip+"'${/if} name='${Name}' aliasname='${Name}'></span>${/if}"),this.model.ShowNodeIcon&&(e=(e=(e=(e+="<span style=vertical-align:middle;position:relative;${if(ContainerName !== 'Dimensions' && ContainerName !== 'Measures')}right:25px;font-size:11px;${/if}${if(!HasChild)}bottom:10px${/if} class='bbi-heirarchial-icons bbi-designer-content-icon${if(ParentId === null && ContainerName ==='Dimensions')} bbi-heirarchial-dimension${else if(ColumnType ==='Dimension')} ${if(HasChild)} e-heirarchial-${TreeNode.toLowerCase()}1${else if(ContainerName === 'Dimensions1')} e-heirarchial-${TreeNode.toLowerCase()}${LevelDepth}${/if} ${else if(TreeNode === 'Folder')} ${if(ColumnType === 'KPI')} e-heirarchial-${ColumnType.toLowerCase()} ${else} e-heirarchial-${TreeNode.toLowerCase()}${/if}${/if}'></span>")+"${ if(!HasChild)}"+"<div class='bbi-treeview-rearrange-content' style=display:flex;flex-direction:column;position:absolute;left:18px;top:5px;${if(ContainerName !== 'Dimensions' && ContainerName !== 'Measures')}left:0px;${/if}>")+"<span style=font-size:7px;width:3.33px;height:1.67px class='bbi-heirarchial-icons bbi-designer-content-icon bbi-treeview-uparrow-icon'></span>"+"<span style=width:7.78px;height:4.45px;margin-top:5px;margin-left:-2.5px;font-size:12px;${if(ContainerName !== 'Dimensions')}margin-top:4px;${/if} class='bbi-heirarchial-icons bbi-designer-content-icon bbi-treeview-menu-icon'></span>")+"<span style=font-size:7px;width:3.33px;height:1.67px;margin-top:5px;${if(ContainerName !== 'Dimensions')}margin-top:6px;${/if} class='bbi-heirarchial-icons bbi-designer-content-icon bbi-treeview-downarrow-icon'></span>"+"</div>${/if}"),this.model.ShowDataTypeIcon&&(e+="${if(TreeNode === 'Measure')}<span style=vertical-align:middle class='bbi-designer-content-icon bbi-heirarchial-icons${if(ColumnType === 'Measure')} bbi-designer-dataset-number${else if(ColumnType === 'CalculatedMeasure')} bbi-heirarchial-lambda${/if}'></span>${/if}"),e+="<span style='margin-left:5px;white-space:nowrap;font-size:11px;${if(ContainerName !== 'Dimensions' && ContainerName !== 'Measures')}position:relative;right:30px;${if(HasChild)}margin-left:12px;${/if}${/if}${if(HasChild)}text-overflow:ellipsis;overflow:hidden;max-width:120px;line-height:20px;display:inline-block;position:relative;top:6px;${/if}${if(!HasChild)}position:relative;display:inline-block;top:2px;width:100px;text-overflow:ellipsis;overflow:hidden;margin-left:18px;${/if}${ if(!HasChild && ContainerName === 'Dimensions' && ContainerName === 'Measures')}left:6px;margin-left:7px;${/if}' class='e-user-select bbi-designer-fontfamily bbi-dbrd-designer-hoverable bbi-parent-name' e-column-type='${DataType}' datatype='${DefaultDataType}' treenode='${TreeNode}' hasChild='${HasChild}' data-tooltip='${Name}' id='${ DashboardId }_${ Id }_categoryListLabel_${ UniqueId }'>${DisplayName}</span><input style='position:absolute;${if(HasChild)}right:40px;top:8px${/if}${if(!HasChild)}right:41px;top:6px${/if}' class='e-textbox bbi-datafield-edit-fieldName bbi-designer-fontfamily e-treeview-textbox' id='${ DashboardId }_${ Id }_categoryListEditableTextBox_${ UniqueId }'>${if(ContainerName !== 'Dimensions' || ContainerName === 'Dimensions')}${if(HasChild)}","Dimensions"===this.realFieldInfo.ContainerName&&"bbi-designer-dataset-string"!==this.realFieldInfo.FieldActualType||"Dimensions"===this.realFieldInfo.ContainerName||(e+="<span id='${ DashboardId }_${ Id }_categoryListParentDiv_${ UniqueId }' style='position:relative;top:3px;left:2px;float:right' class='bbi-dbrd-designer-hoverable bbi-dropped-field-close bbi-widgeticons bbi-designer-close bbi-dbrd-designer-hand-cursor e-close-parent e-dimension'></span>"),e+="${/if}${/if} ","bbi-designer-dataset-string"===this.realFieldInfo.FieldActualType&&"Dimensions"===this.realFieldInfo.ContainerName&&(e+="${if(HasChild)}<span id='${ DashboardId }_${ Id }_categoryListSettingsIconHierarchy_${ UniqueId }' style='float:right;margin-right:10px;line-height:40px;margin-top:7px' class='bbi-data-fieldinfo-menu-icon-hierarchy bbi-widgeticons bbi-ch-menu-icon bbi-dbrd-hand-cursor'></span>${/if}"),e+="</div>",this.model.ShowSettings=!0,this.model.ShowSettings&&(e+="${if(!HasChild)}<div style='margin-right: 5px; float:right' class='e-settings-div'>${if(ContainerName !== 'Dimensions' && ContainerName !== 'Measures')}<span id='${ DashboardId }_${ Id }_categoryListSettingsIcon_${ UniqueId }' style='position:relative;right:22px;top:12px' class='bbi-designer-click bbi-designer-toolbarIconSettings bbi-designer-toolbarsmallfonticonsettings bbi-designer-selection bbi-dbrd-designer-hand-cursor bbi-dbrd-designer-hoverable bbi-dropped-field-settings e-child'></span>${/if}","Dimensions"===this.realFieldInfo.ContainerName&&"bbi-designer-dataset-string"!==this.realFieldInfo.FieldActualType||(e+="<span id='${ DashboardId }_${ Id }_categoryListIcon_${ UniqueId }' style='position:relative;${if(ContainerName === 'Dimensions' || ContainerName === 'Measures')}left:7px;${/if}${if(ContainerName !== 'Dimensions' && ContainerName !== 'Measures')}bottom:13px;right:6px${/if} ' class='bbi-dbrd-designer-hoverable bbi-dropped-field-close bbi-widgeticons bbi-designer-close bbi-dbrd-designer-hand-cursor e-close-child'></span>"),e+="</div>${/if}"),e+"</div>"},t.prototype.wiredEvents=function(){this.treeView.on("click",".bbi-data-fieldinfo-menu-icon-hierarchy",this.bbdesigner$.proxy(this.dataConfig.updateHierarchyMenuItems,this.dataConfig,this.realFieldInfo)),this.treeView.on("click",".bbi-designer-selection.bbi-dropped-field-settings.e-parent",this.bbdesigner$.proxy(this.menuHandler.onSettingsClick,this.menuHandler,this.realFieldInfo)),"Dimensions"===this.realFieldInfo.ContainerName?this.treeView.on("click",".bbi-dropped-field-close.e-close-parent",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo,this.realFieldInfo,!1,!0)):this.treeView.on("click",".bbi-dropped-field-close.e-close-parent",this.bbdesigner$.proxy(this.dataConfig.onCloseClick,this.dataConfig,this.realFieldInfo,!1,!0));for(var e=0;!d.isNullOrUndefined(this.realFieldInfo.ChildHierarchicalFields)&&e<this.realFieldInfo.ChildHierarchicalFields.length;e++)"Dimensions"===this.realFieldInfo.ContainerName?this.treeView.on("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo.ChildHierarchicalFields[e],this.realFieldInfo,!1,!0)):this.treeView.on("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClick,this.dataConfig,this.realFieldInfo.ChildHierarchicalFields[e],!1,!0)),this.treeView.on("click",".bbi-designer-selection.bbi-dropped-field-settings.e-child",this.bbdesigner$.proxy(this.menuHandler.onSettingsClick,this.menuHandler,this.realFieldInfo.ChildHierarchicalFields[e]));d.isNullOrUndefined(this.realFieldInfo.ChildHierarchicalFields)&&this.treeView.on("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo,this.realFieldInfo,!1,!0))},t.prototype.unwiredEvents=function(){this.treeView.off("click",".bbi-data-fieldinfo-menu-icon-hierarchy",this.bbdesigner$.proxy(this.dataConfig.updateHierarchyMenuItems,this.dataConfig,this.realFieldInfo)),this.treeView.off("click",".bbi-designer-selection.bbi-dropped-field-settings.e-parent",this.bbdesigner$.proxy(this.menuHandler.onSettingsClick,this.menuHandler,this.realFieldInfo)),"Dimensions"===this.realFieldInfo.ContainerName?this.treeView.off("click",".bbi-dropped-field-close.e-close-parent",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo,this.realFieldInfo,!1,!0)):this.treeView.off("click",".bbi-dropped-field-close.e-close-parent",this.bbdesigner$.proxy(this.dataConfig.onCloseClick,this.dataConfig,this.realFieldInfo,!1,!0));for(var e=0;!d.isNullOrUndefined(this.realFieldInfo.ChildHierarchicalFields)&&e<this.realFieldInfo.ChildHierarchicalFields.length;e++)"Dimensions"===this.realFieldInfo.ContainerName?this.treeView.off("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo.ChildHierarchicalFields[e],this.realFieldInfo,!1,!0)):this.treeView.off("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClick,this.dataConfig,this.realFieldInfo.ChildHierarchicalFields[e],!1,!0)),this.treeView.off("click",".bbi-designer-selection.bbi-dropped-field-settings.e-child",this.bbdesigner$.proxy(this.menuHandler.onSettingsClick,this.menuHandler,this.realFieldInfo.ChildHierarchicalFields[e]));d.isNullOrUndefined(this.realFieldInfo.ChildHierarchicalFields)&&this.treeView.off("click",".bbi-dropped-field-close.e-close-child",this.bbdesigner$.proxy(this.dataConfig.onCloseClickHierarchyFields,this.dataConfig,this.realFieldInfo,this.realFieldInfo,!1,!0))},t.prototype.nodeVisibility=function(e){e.nodeData.IsVisible||(e.node.style.display="none")},t.prototype.nodeExpanded=function(e,t,i){var a,o;if(!t&&!d.isNullOrUndefined(this.realFieldInfo)){for(this.scrollerDiv.refresh(),this.bbdesigner$(i.node).find(".e-list-item.e-level-2 .e-text-content, .e-list-item.e-level-2 .e-text-content .e-list-text").css("height","35px"),this.bbdesigner$(i.node).find(".e-list-item.e-level-2").addClass("e-heirachy-field"),this.bbdesigner$(i.node).find(".e-list-item.e-level-2").css("height","35px"),a=this.bbdesigner$(i.node).find(".e-list-parent.e-ul"),o=0;o<a[0].childElementCount;o++)this.bbdesigner$(a[0].children[o]).find(".e-treeview-textbox").data("e-treeview-textbox-field",this.realFieldInfo.ChildHierarchicalFields[o]);this.scrollerDiv.refresh()}(t=e.siblings(".bbi-querydesigner-table-boxshadow").find(".e-dbrd-query-select")).hasClass("bbi-designer-dataset-column-deselect")?this.bbdesigner$(i.node).find(".bbi-text-content").find(".bbi-query-selection").removeClass("bbi-designer-dataset-column-select").addClass("bbi-designer-dataset-column-deselect").attr("data-tooltip",this.locale.queryDesigner.hideDataTooltip):t.hasClass("bbi-designer-dataset-column-select")&&this.bbdesigner$(i.node).find(".bbi-text-content").find(".bbi-query-selection").removeClass("bbi-designer-dataset-column-deselect").addClass("bbi-designer-dataset-column-select").attr("data-tooltip",this.locale.queryDesigner.showDataTooltip),this.model.ShowSettings&&this.bbdesigner$(i.node).find(".bbi-text-content").hasClass("deselect")&&this.bbdesigner$(i.node).find(".bbi-text-content").addClass("deselect"),this.scrollerRefresh(e)},t.prototype.nodeCollapsed=function(e,t){this.bbdesigner$(t.node).find(".e-list-item.e-level-2.e-active").removeClass("e-active"),this.scrollerRefresh(e)},t.prototype.scrollerRefresh=function(e){d.isNullOrUndefined(e)||(e=e.data("BoldBIDashboardScroller"),d.isNullOrUndefined(e))||e.refresh()},e.HierachicalSchemaView=t}(BoldBIDashboard=BoldBIDashboard||{}),function(l){var e;function t(e){this.locale=null,this.selectionType="Custom",this.parameterList=[],this.parameterName=null,this.customAttributesList=[],this.attributeName=null,this.ejIndicator=null,this.okBtn=null,this.designer=e,this.bbdesigner$=this.designer.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.designer.modules.queryDesigner,this.dataField=[],this.id=this.designer._id+"_hierarchy_init_fltr",this.multiSelectionComboBox=new l.DashboardDesignerUtility.MultiSelectionComboBox(this.designer),this.dateRangePopup=this.designer.modules.dateRangePopup,this.createHierarchicalUI()}e=l.Dashboard||(l.Dashboard={}),t.prototype.createHierarchicalUI=function(){var e,t=l.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect bbi-designer-query-dialog","",{},{title:this.locale.initialFilter.dialogTitle,id:this.id+"_query_filter_dialog"}),i=l.buildTag("div","",{height:"100%",display:"grid","grid-template-columns":"24% 1% 75%"}),a=l.buildTag("div.e-left-container","",{display:"inline-block",height:"100%"},{});this.treeViewScroller=l.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{position:"relative",width:"100%",height:"100%"},{id:this.id+"_query_parentContainer"}),e=l.buildTag("div","",{width:"auto"},{id:this.id+"_query_container_div"}),i.append(a),a.append(this.treeViewScroller),i.append('<span class="bbi-vertical-line" style="float:left"></span>'),this.rightContainerDiv=l.buildTag("div.e-droppable","",{display:"inline-block",margin:"10px 0px"},{}),i.append(this.rightContainerDiv),this.listViewScroller=l.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{position:"relative"},{id:this.id+"_query_parentContainer"}),this.listView=l.buildTag("div.e-heirarcial-list","",{width:"100%"},{id:this.id+"_query_container_list"}),this.rightContainerDiv.append(this.listViewScroller),t.append(i),this.designer.element.append(t),this.ejdialogInst=t.BoldBIDashboardDialog({minWidth:900,minHeight:400,width:"auto",height:"auto",enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",containment:"#"+this.designer._id,target:"#"+this.designer._id,close:this.bbdesigner$.proxy(l.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}).data("BoldBIDashboardDialog"),t.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-designer-loader",template:this.designer.getWaitingPopupTemplate()}),this.okBtn=l.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_query_btn_ok",type:"button"}),a=l.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_query_btn_cancel",type:"button"}),this.designer.element.find("#"+this.id+"_query_filter_dialog_foot").append(a,this.okBtn),this.okBtn.on("click",this.bbdesigner$.proxy(this.saveQueryFilter,this,!0)),a.on("click",this.bbdesigner$.proxy(this.closeDialog,this,!0)),this.treeViewDiv=l.buildTag("div.e-heirarchial-parent","",{},{}),this.getCustomAttribute1(),e.append(this.treeViewDiv),this.treeViewScroller.append(e),this.treeViewScroller.BoldBIDashboardScroller({height:"420px",width:"100%",scrollerSize:this.designer.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.designer.scrollerSize.buttonSize}),this.listViewScroller.append(this.listView),this.listViewScroller.BoldBIDashboardScroller({height:"400px",scrollerSize:this.designer.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.designer.scrollerSize.buttonSize})},t.prototype.closeDialog=function(){this.multiSelectionComboBox.hideMultiSelectionWaitingPopup(!0),this.designer.element.find("#"+this.id+"_query_filter_dialog").data("BoldBIDashboardDialog").close()},t.prototype.renderTreeview=function(e){new l.Dashboard.HierachicalSchemaView(this.designer,this.getModel()).render(this.treeViewDiv,e,this.treeViewScroller,this.designer._id,!0,!0),this.treeViewEvents(this.treeViewDiv)},t.prototype.getModel=function(){var e=new l.Dashboard.HierachialModel;return e.CanDragDrop=!0,e},t.prototype.treeViewEvents=function(e){var t,i,e=ejdashboard.base.getComponent(e.children().first()[0],"treeview");for(e.allowEditing=!0,e.nodeDragStart=this.bbdesigner$.proxy(this.nodeDragStart,this),e.nodeDragStop=this.bbdesigner$.proxy(this.nodeDragStop,this),e.nodeEditing=this.bbdesigner$.proxy(this.nodeDoubleClick,this),t=e.element.ej2_instances,i=0;i<t.length;i++)if("draggable"===t[i].getModuleName()){t[i].dragArea="#"+this.id+"_query_filter_dialog";break}},t.prototype.nodeDoubleClick=function(e){var t;e.nodeData.hasChildren||(t=this.bbdesigner$(e.node).children().find(".e-user-select").attr("e-column-type"),this.getUIForListView(e.nodeData,t,!1)),this.cancelEvent(e)},t.prototype.nodeDragStart=function(e){var t;e.draggedNodeData.hasChildren?this.cancelEvent(e):(t=this.designer.element.find("#"+this.ejdialogInst.element.attr("id")+"_overLay"),e.clonedNode.style.zIndex=l.parseInt(t.css("zIndex"),10)+10)},t.prototype.nodeDragStop=function(e){var t;0<this.bbdesigner$(e.target).find(".e-heirarcial-list").length&&(t=this.bbdesigner$(e.draggedNode).children().find(".e-user-select").attr("e-column-type"),this.getUIForListView(e.draggedNodeData,t,!1)),this.cancelEvent(e)},t.prototype.cancelEvent=function(e){e.cancel=!0},t.prototype.resetDialog=function(){this.treeViewDiv.empty(),this.listView.children().remove(),this.dataField=[],this.selectionType="Custom",this.parameterName=null,this.attributeName=null,this.attributeValue=null},t.prototype.openDialog=function(e,t){var i,a,o=this;if(this.resetDialog(),this.buttonModel=e,this.renderTreeview(t),!l.isNullOrUndefined(this.queryDesigner.queryFilter))for(i=function(e){setTimeout(function(){o.getUIForListView({id:o.queryDesigner.queryFilter[e].Id,text:o.queryDesigner.queryFilter[e].Name},o.queryDesigner.queryFilter[e].DataType,!0,o.queryDesigner.queryFilter[e])},220)},a=0;a<this.queryDesigner.queryFilter.length;a++)i(a);this.ejdialogInst.open(),e=this.treeViewScroller.data("BoldBIDashboardScroller"),l.isNullOrUndefined(e)||e.refresh(),this.listViewScrollerRefresh()},t.prototype.getUIForListView=function(e,t,i,a){var o=l.getGuid(this.id+"_row_");this.dataField.push({Id:o,ColumnId:e.id,Name:e.text,DataType:t}),this.listView.append(this.getTemplate(o,e,t)),this.listView.find("#"+o+"_query_operator_type").BoldBIDashboardDropDownList({width:"130px",height:"26px",dataSource:[{value:"And",text:"AND"},{value:"Or",text:"OR"}],fields:{text:"text",value:"value"},enabled:!0,selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-ejwidgets bbi-dbrd-control bbi-background"}),this.parameterList=this.designer.modules.storeParameter.getParameterDataSource(),this.setDataToDropdown(o,e,t),this.selectionType="Custom",this.parameterName=null,this.attributeValue=null,this.attributeName=null,this.fieldItem=null,i&&this.populateDataSet(o,a),this.setDataToParamDropdown(o,e,t),(i=this.listView.find("#"+o+"_query_delete_icon")).off("click",this.bbdesigner$.proxy(this.deleteQueryFilter,this,this.bbdesigner$("#"+o))),i.on("click",this.bbdesigner$.proxy(this.deleteQueryFilter,this,this.bbdesigner$("#"+o))),this.listViewScrollerRefresh()},t.prototype.setDataToParamDropdown=function(e){var t,i,a=this.listView.find("#"+e+"_query_paramtype"),o=l.buildTag("input.e-textbox",this.selectionType,{},{type:"text",id:e+"_param"});a.append(o),o.BoldBIDashboardDropDownList({width:"170px",height:"30px",popupWidth:"150px",dataSource:[{text:"Custom",value:"Custom"},{text:"Parameters",value:"Parameters"},{text:"Custom Attributes",value:"Custom Attributes"}],fields:{text:"text",value:"value"},value:this.selectionType,enabled:!0,change:this.bbdesigner$.proxy(this.onParameterDropDownChange,this,e),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control"}),o=l.buildTag("td","",{display:"Parameters"===this.selectionType?"block":"none"},{id:e+"_parameter_dropdown"}),t=l.buildTag("input.e-textbox",this.parameterName,{height:"30px",width:"170px"},{type:"text",id:e+"_param_elements"}),o.append(t),t.BoldBIDashboardDropDownList({width:"170px",height:"30px",popupWidth:t.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:this.parameterList,enabled:!0,value:this.parameterName,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.parameterChangeEvent,this,e)}),a.after(o),o=l.buildTag("td","",{display:"Custom Attributes"===this.selectionType?"block":"none"},{id:e+"_attribute_dropdown"}),i=l.buildTag("input.e-textbox",this.parameterName,{height:"30px",width:"170px"},{type:"text",id:e+"_attribute"}),o.append(i),null!=this.attributeName&&(this.fieldItem=this.getSelectedAttributeValue(this.attributeName)),i.BoldBIDashboardDropDownList({width:"170px",height:"30px",popupWidth:t.width(),fields:{text:"text",value:"value"},value:this.attributeName,dataSource:this.customAttributesList,watermarkText:l.isNullOrUndefined(this.attributeName)?"Custom Attribute":this.attributeName,selectedIndex:this.fieldItem,enabled:!0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.setAttributeValueInfo,this,e)}),a.after(o)},t.prototype.getSelectedAttributeValue=function(e){for(var t=0;t<this.customAttributesList.length;t++)if(e===this.customAttributesList[t].text)return t},t.prototype.setAttributeValueInfo=function(t,e){this.selectionType="Custom Attributes",this.attributeName=e.text,this.attributeValue=e.value;e={CustomAttributeName:this.attributeName,Value:this.attributeValue};this.dataField.find(function(e){return e.Id==t}).AttributeInfo=e},t.prototype.parameterChangeEvent=function(t,e){var i=this,e=(this.selectionType="Parameters",this.getParamDropDownSelectionValue(t),this.parameterName=e.value,e.model.dataSource.filter(function(e){return e.value===i.parameterName})),e={Name:this.parameterName,Id:0<e.length?e[0].parameterID:this.parameterName};this.dataField.find(function(e){return e.Id==t}).ParameterInfos=e},t.prototype.onParameterDropDownChange=function(t,e){var i;"Parameters"===e.value?(this.selectionType="Parameters",this.designer.element.find("#"+t+"_query_datasource").css("display","none"),this.designer.element.find("#"+t+"_attribute_dropdown").css("display","none"),this.designer.element.find("#"+t+"_parameter_dropdown").css("display","block"),(i=this.dataField.find(function(e){return e.Id==t})).AttributeInfo=null):"Custom Attributes"===e.value?(this.selectionType="Custom Attributes",this.designer.element.find("#"+t+"_query_datasource").css("display","none"),this.designer.element.find("#"+t+"_parameter_dropdown").css("display","none"),this.designer.element.find("#"+t+"_attribute_dropdown").css("display","block"),(i=this.dataField.find(function(e){return e.Id==t})).ParameterInfos=null,this.getCustomAttribute1()):"Custom"===e.value&&(this.selectionType="Custom",this.designer.element.find("#"+t+"_parameter_dropdown").css("display","none"),this.designer.element.find("#"+t+"_attribute_dropdown").css("display","none"),this.designer.element.find("#"+t+"_query_datasource").css("display","block"),(i=this.dataField.find(function(e){return e.Id==t})).ParameterInfos=null,i.AttributeInfo=null)},t.prototype.getParameterNameFromID=function(t){var e;if(!l.isNullOrUndefined(t)){if(!/^[{(]?[0-9A-Fa-f]{8}[-]?(?:[0-9A-Fa-f]{4}[-]?){3}[0-9A-Fa-f]{12}[)}]?$/.test(t))return t;if(0<this.parameterList.length)return 0<(e=this.parameterList.filter(function(e){return e.parameterID===t})).length?e[0].value:t}return t},t.prototype.getCustomAttribute1=function(){var t=this;this.designer.modules.util.doAjaxPost("POST",this.designer.model.serviceUrl+l.Dashboard.ServiceAPI.processdata,{action:l.DashboardUtil.DesignerAction.GetCustomAttribute,data:JSON.stringify({className:l.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:l.DashboardUtil.DesignerAction.GetCustomAttribute,isCodeView:!1,isQueryDesignerMode:!0})},{fnction:function(e){t.setCustomAttribute(e)},indicator:[this.bbdesigner$.proxy(this.showIndicator,this),this.bbdesigner$.proxy(this.hideIndicator,this)]})},t.prototype.setCustomAttribute=function(e){l.isNullOrUndefined(e)||(e=e.map(function(e){return{text:e.Name,value:e.Value}}),this.customAttributesList=e)},t.prototype.showIndicator=function(){this.ejIndicator=this.designer.element.find("#"+this.id+"_query_filter_dialog").data("BoldBIDashboardWaitingPopup"),this.ejIndicator.show(),this.okBtn.attr({disabled:"disabled"})},t.prototype.hideIndicator=function(){this.ejIndicator.hide(),this.okBtn.removeAttr("disabled")},t.prototype.populateDataSet=function(t,e){var i,a;this.isString(e.DataType)?(i=this.multiSelectionComboBox.getMultiSelectionComboBox(t),a={FilterValues:(a=e.DimensionFilterSchemaInfo).FilterValues,IsInclude:a.IsInclude,IsCheckAll:a.IsCheckAll,CheckAllState:a.CheckAllState},i.parent().data("MultiSelectionComboBox").populateMultiSelectionItem(t,a),!l.isNullOrUndefined(e.ParameterInfo)&&e.ParameterInfo.IsParamApplied?(this.parameterName=this.getParameterNameFromID(e.ParameterInfo.ParameterName),this.selectionType="Parameters",this.designer.element.find("#"+t+"_query_datasource").css("display","none"),this.dataField.find(function(e){return e.Id==t}).ParameterInfos=e.ParameterInfo):!l.isNullOrUndefined(e.CustomAttributeInfo)&&e.CustomAttributeInfo.IsAttributeApplied&&(this.attributeName=e.CustomAttributeInfo.CustomAttributeName,this.selectionType="Custom Attributes",this.designer.element.find("#"+t+"_query_datasource").css("display","none"),this.dataField.find(function(e){return e.Id==t}).AttributeInfo=e.CustomAttributeInfo)):(i=e.DateFilterSchemaInfo,this.multiSelectionComboBox.getMultiSelectionComboBox(t).css("display","none"),this.dateRangePopup.populateDateRangePopup(t,i.DateFormatInfo))},t.prototype.getTemplate=function(e,t,i){return"<div class='bbi-designer-query-row' id='"+e+"' style = 'margin: 0px 10px 0px 2px;'><div class='bbi-initialfil-opterator' id = '"+e+"_query_operator_type_div' style = 'position: relative; padding-left: 14px; top: 10px; z-index: 1;'><input type='text' id = '"+e+"_query_operator_type'></div><div class='bbi-designer-table-dialog' id='"+e+"_query_container_table' style=\"border: 1px solid var(--querydesigner-primary-border-color); height: 45px; display: flex; align-items: center; justify-content: space-between;\"><div class='e-contentWrapper' style='margin: 2%; width: 100%; display: grid; align-items: center; grid-template-columns: 30% 30% 40%; column-gap: 10px'> <span class='bbi-designer-label bbi-dbrd-designer-hoverable' style ='overflow:hidden; text-overflow:ellipsis' data-tooltip='"+t.text+"'>"+t.text+"</span ><div class='bbi-designer-paramType' id='"+e+"_query_paramtype' style='position: relative; font-size: 12px; background-color: white; width: "+(this.isString(i)?"170px":"130px")+"; height: 30px'></div>"+(this.isString(i)?"":"<div class='e-columninfo-content'></div>")+"<div class='e-columninfo-data' id ='datacollection'><div class='e-multi-combobox' id='"+e+"_query_datasource' style='position: relative; font-size: 12px; background-color: white; width: "+(this.isString(i)?"170px":"130px")+"; height: 26px'></div></div></div><div class=error-msg id='"+e+"_error_msg' style='visibility: collapse;margin-right: 2%'><span class='bbi-designer-error-icon bbi-designer-errorinfo bbi-dbrd-designer-hoverable' style='float: right; display: block;' data-tooltip='Invalid Formatting.'></span></div><span class='bbi-drbd-close-icon bbi-dbrd-designer-hoverable' id = '"+e+"_query_delete_icon' data-tooltip='Delete' style ='cursor: pointer; font-size: 10px; float: right; margin-right:5%'></span></div>"},t.prototype.setDataToDropdown=function(e,t,i){var a,o=this.listView.find("#"+e+"_query_datasource"),s=this.listView.find("#"+e+" .e-columninfo-content");this.isString(i)?(new l.DashboardDesignerUtility.MultiSelectionComboBox(this.designer).renderMultiSelectionComboBox(o,e,this.queryDesigner.dataset.Id),this.multiSelectionComboBox.getMultiSelectionComboBox(e).attr({"data-fieldValue":t.id,"data-fieldText":t.text,"data-dateFormat":null})):(i=l.buildTag("input.e-combobox-element","",{position:"relative","font-size":"12px","background-color":"white"},{id:e+"combobox-data"}),a=JSON.parse('[{"column1":"Date"}]'),s.append(i),i.BoldBIDashboardDropDownList({cssClass:"bbi-dbrd-control e-combobox-control",dataSource:a,fields:{text:"column1",value:"id"},selectedIndex:0,enabled:!1,width:"130px",height:"26px"}),this.dateRangePopup.renderDateRangeDrpDwn(e,o,this.queryDesigner.dataset.Id,{Id:t.id,Name:t.text},null,"QueryFilter"),this.listView.find("#"+e+"_query_paramtype").css("display","none"),this.listView.find("#"+e+"_dateRange_multidDrpDwn").css("display","block"))},t.prototype.saveQueryFilter=function(){var e=this.getQueryFilter();e.hasError||(l.DashboardUtil.invokeMethod(this.buttonModel.callBackInstance,this.buttonModel.callBackMethod,[e]),this.closeDialog())},t.prototype.getAttributeDropDownSelectionValue=function(e){return this.designer.element.find("#"+e+"_attribute")},t.prototype.getParamDropDownSelectionValue=function(e){return this.designer.element.find("#"+e+"_param")},t.prototype.getParameterIDFromName=function(t){var e;return 0<this.parameterList.length&&0<(e=this.parameterList.filter(function(e){return e.value===t})).length?e[0].parameterID:t},t.prototype.getInitialDashboardParamInfo=function(e){return{IsParamApplied:!0,ParameterName:l.isNullOrUndefined(e.ParameterName)?e.Id:e.ParameterName}},t.prototype.getInitialDashboardAttributeInfo=function(e){return{AttributeEndName:null,CustomAttributeName:e.CustomAttributeName,IsAttributeApplied:!0}},t.prototype.getQueryFilter=function(){for(var e,t=[],i=this.designer.element.find("#"+this.queryDesigner.id+"_div_dragSurface .bbi-data-table"),a=this.bbdesigner$(i[0]).data("e-table"),o=!1,s=0;s<this.dataField.length;s++){var n=new InitialFilterInfo,r=this.dataField[s],d=r.Id;this.bbdesigner$(this.rightContainerDiv).find("#"+d+"_error_msg").css("visibility","collapse"),n.Name=r.Name,n.Id=r.ColumnId,n.DataType=this.getTypeName(r.DataType),this.isString(n.DataType)?(n.Type=l.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Dimension),e=this.multiSelectionComboBox.getMultiSelectionComboBox(d).parent().data("MultiSelectionComboBox").getPopupContainerInformation(d),l.isNullOrUndefined(r.ParameterInfos)||(n.ParameterInfo=this.getInitialDashboardParamInfo(r.ParameterInfos),e.IsCheckAll=!1),l.isNullOrUndefined(r.AttributeInfo)||(n.CustomAttributeInfo=this.getInitialDashboardAttributeInfo(r.AttributeInfo),e.IsCheckAll=!1),n.DimensionFilterSchemaInfo={ColumnName:r.Name,ColumnId:r.ColumnId,DimensionFilterCondition:DimensionFilterCondition.Inclusion,FilterValues:e.FilterValues,IsInclude:e.IsInclude,IsCheckAll:e.IsCheckAll,IsTopNApplied:!1,CheckAllState:e.CheckAllState},e.IsCheckAll&&(this.bbdesigner$(this.rightContainerDiv).find("#"+d+"_error_msg").css("visibility","visible"),o=!0),o=n.DimensionFilterSchemaInfo.IsCheckAll,o=l.isNullOrUndefined(n.ParameterInfo)?l.isNullOrUndefined(n.CustomAttributeInfo)?o:this.checkParamHasError("string",null,n.CustomAttributeInfo.CustomAttributeName,null):this.checkParamHasError("string",null,n.ParameterInfo.ParameterName,null)):(n.Type=l.DashboardDesignerUtility.Serialization.enumToString(InitialFilterType,InitialFilterType.Date),e=this.dateRangePopup.getDateRangeValues(d),n.DateFilterSchemaInfo={ColumnName:r.Name,ColumnId:r.ColumnId,DateAndTimeFormatCondition:DateTimeFormatForFilter.Date,FilterValues:[],IsInclude:!1,IsCheckAll:!1,IsTopNApplied:!1,CheckAllState:!1,TopNFilterConditionInfo:null,DateFormatInfo:{DateFormatCondition:e.DateFormatCondition,StartDate:e.StartDate,EndDate:e.EndDate}},e.IsFilterApplied||(this.bbdesigner$(this.rightContainerDiv).find("#"+d+"_error_msg").css("visibility","visible"),o=!0)),n.Schema=a.schema,n.TableName=a.name,n.TableId=a.id,n.IsTypeCast=!1,n.TypeCastValue="",t.push(n)}return{queryFilters:t,hasError:o}},t.prototype.checkParamHasError=function(e,t,i,a){t=!l.isNullOrUndefined(t)&&("Between"===t||"NotBetween"===t);return"int"===e?t?l.isNullOrUndefined(i)||""===i||l.isNullOrUndefined(a)||""===a:l.isNullOrUndefined(i)||""===i:"string"===e&&(l.isNullOrUndefined(i)||""===i)},t.prototype.getTypeName=function(e){var t=e.toLowerCase();return"nchar"===t||"ntext"===t||"nvarchar"===t||"text"===t||"varchar"===t||"char"===t||"string"===t?"System.String":"datetime"===t||"datetime2"===t||"smalldatetime"===t||"date"===t?"System.DateTime":"datetimeoffset"===t?"System.DateTimeOffset":"time"===t?"System.TimeSpan":e},t.prototype.deleteQueryFilter=function(e){var t=e.attr("id");e.remove(),this.bbdesigner$("#"+e.attr("rowId")+"_popup_container").remove(),this.bbdesigner$("#"+e.attr("rowId")+"_dateRange_popup").remove(),this.dataField=this.dataField.filter(function(e){if(e.Id!==t)return e}),this.listViewScrollerRefresh()},t.prototype.listViewScrollerRefresh=function(){var e=this.listViewScroller.data("BoldBIDashboardScroller");l.isNullOrUndefined(e)||e.refresh()},t.prototype.isString=function(e){return"System.Guid"===e||"System.String"===e||"Text"===e||"string"===e.toLowerCase()},e.HierarchicalMainFilterDialog=t}(BoldBIDashboard=BoldBIDashboard||{}),InternalDropDownTreeview=function(){function e(e,t,i){this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=(""!==i.attr("id")?i.attr("id"):this.dashboardDesigner._id)+"_drop_tree",this.targetContainer=i,this.targetContainer.data("DesignerPropertyWidget",this),this.renderDropDown(t,i)}return e.prototype.renderDropDown=function(e,t){BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(e)||(this.dropDownBtnModel=e,BoldBIDashboard.isNullOrUndefined(this.treeViewObj)||BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.fields)?(this.createDropDownElement(t),this.wireEvents()):(this.treeViewObj.fields=this.dropDownBtnModel.fields,this.treeViewObj.refresh()))},e.prototype.createDropDownElement=function(e){var t,i,a=this,o=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_wrapper"}),s=BoldBIDashboard.buildTag("input","",{},{id:this.id+"_wrapper_input"}),n=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_wrapper_target"}),r=BoldBIDashboard.buildTag("ul","",{},{}),d=BoldBIDashboard.buildTag("li","",{},{}),l=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-treeview-target","",{},{id:this.id+"_treeview_target"}),h=this.treeviewDiv=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-treeviewdiv","",{},{id:this.id+"_main_treeviewDiv"}),p=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-drpdwn-footer","",{},{id:this.id+"_dropdown_footer"}),c=BoldBIDashboard.buildTag("footer.bbi-dbrd-designer-footer-element","",{},{id:this.id+"_footer_element"}),u=this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-apply-button bbi-dbrd-btn-primary e-dbrd-btn bbi-dbrd-btn-small",this.locale.dialogOptions.applyButtonText,{},{id:this.id+"_apply_button",type:"button"}),b=BoldBIDashboard.buildTag("button.bbi-dbrd-designer-cancel-button bbi-dbrd-btn-secondary e-dbrd-btn bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{},{id:this.id+"_cancel_button",type:"button"});c.append(b,u),p.append(c),l.append(h),d.append(l),r.append(d),n.append(r),o.append(s,n),e.append(o),t=BoldBIDashboard.DropDownList.prototype._OnKeyUp,i=BoldBIDashboard.DropDownList.prototype._OnKeyDown,this.bbdesigner$.extend(!0,BoldBIDashboard.DropDownList.prototype,{_OnKeyUp:function(e){0===this.popup.find(".bbi-dbrd-designer-treeviewdiv").length&&t.call(this,e)},_OnKeyDown:function(e){0===this.popup.find(".bbi-dbrd-designer-treeviewdiv").length&&i.call(this,e)}}),this.dropDownObj=s.BoldBIDashboardDropDownList({targetID:this.id+"_wrapper_target",popupHeight:BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.popupHeight)?"":this.dropDownBtnModel.popupHeight,watermarkText:BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.watermarkText)?"":this.dropDownBtnModel.watermarkText,width:BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.width)?"145px":this.dropDownBtnModel.width,height:BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.height)?"26px":this.dropDownBtnModel.height,cssClass:"boldbi-dashboarddesigner "+(BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.cssClass)?"":this.dropDownBtnModel.cssClass),create:function(){var e=s.BoldBIDashboardDropDownList("instance");e.ultag.off("click",a.bbdesigner$.proxy(e._OnMouseClick,e)),e.ultag.off("mouseenter",a.bbdesigner$.proxy(e._OnMouseEnter,e)),e.ultag.off("mouseleave",a.bbdesigner$.proxy(e._OnMouseLeave,e)),a.bbdesigner$(e.popupList,e.wrapper).off("keyup",a.bbdesigner$.proxy(e._OnKeyUp,e)),a.bbdesigner$(e.popupList,e.wrapper).off("keydown",a.bbdesigner$.proxy(e._OnKeyDown,e)),e.ultag.parents("#"+a.id+"_wrapper_input_popup_list_wrapper").append(p),e.ultag.parents("#"+a.id+"_wrapper_input_popup").css("background","white")},popupShown:function(){a.applyButton.prop("disabled","true")}}).data("BoldBIDashboardDropDownList"),b=s.BoldBIDashboardDropDownList("instance"),this.parentElement=b.ultag.parents("#"+this.id+"_wrapper_input_popup_list_wrapper"),0<this.dropDownBtnModel.fields.dataSource.length&&(this.renderTreeview(this.treeviewDiv,this.dropDownBtnModel.fields.dataSource),this.dropDownObj.scrollerObj.refresh())},e.prototype.wireEvents=function(){this.parentElement.on("click","#"+this.id+"_apply_button",this.bbdesigner$.proxy(this.applyAction,this)),this.parentElement.on("click","#"+this.id+"_cancel_button",this.bbdesigner$.proxy(this.cancelAction,this))},e.prototype.renderTreeview=function(e,t){var i=new BoldBIDashboard.Dashboard.HierachialModel;i.ShowDataTypeIcon=!0,new BoldBIDashboard.Dashboard.HierachicalSchemaView(this.dashboardDesigner,i).render(e,t,this.dropDownObj.popup,null,null,!0),this.treeViewObj=ejdashboard.base.getComponent(e.children().first()[0],"treeview"),this.treeViewObj.nodeSelected=this.bbdesigner$.proxy(this.onNodeSelect,this)},e.prototype.onNodeSelect=function(e){null===e.nodeData.text||null===e.nodeData.parentID||!1!==e.nodeData.hasChildren||(this.selectedItemValue=e.nodeData.id,this.selectedItemText=e.nodeData.text,this.dropDownObj.model.value===e.nodeData.id)?this.applyButton.prop("disabled","true"):this.applyButton.removeProp("disabled")},e.prototype.addOrRemoveItem=function(e,t){this.dropDownObj._hiddenValue=e,t&&this.dropDownObj._addText(e),this.dropDownObj.model.value=this.selectedItemValue,this.dropDownObj.model.text=e},e.prototype.applyAction=function(){this.dropDownObj._clearTextboxValue(),this.addOrRemoveItem(this.selectedItemText,!0),this.dropDownObj.hidePopup(),BoldBIDashboard.isNullOrUndefined(this.dropDownBtnModel.optionalArgs)?BoldBIDashboard.DashboardUtil.invokeMethod(this.dropDownBtnModel.callBackInstance,this.dropDownBtnModel.callBackMethod):BoldBIDashboard.DashboardUtil.invokeMethod(this.dropDownBtnModel.callBackInstance,this.dropDownBtnModel.callBackMethod,[this.dropDownBtnModel.optionalArgs])},e.prototype.getSelection=function(){return{name:this.selectedItemText,value:this.selectedItemValue}},e.prototype.selectItem=function(e){var t,i;return!BoldBIDashboard.isNullOrUndefined(this.treeViewObj)&&!BoldBIDashboard.isNullOrUndefined(e)&&""!==e.trim()&&(this.treeViewObj.selectedNodes.pop(),this.treeViewObj.selectedNodes.push(e),t=this.getParentNodes(e),this.treeViewObj.expandedNodes=t.parents,this.treeViewObj.refresh(),this.dropDownObj._removeText(this.dropDownObj.model.text),""!==(i=BoldBIDashboard.isNullOrUndefined(t.item)?"":t.item.Name)&&(this.selectedItemText=this.dropDownObj.model.text=i,this.selectedItemValue=this.dropDownObj.model.value=e,this.dropDownObj._addText(i)),!BoldBIDashboard.isNullOrUndefined(t.item))},e.prototype.updateText=function(e,t){this.dropDownObj._removeText(this.dropDownObj.model.text),this.dropDownObj.model.text=e,this.dropDownObj.model.value=t,this.dropDownObj._addText(e)},e.prototype.getParentNodes=function(e){for(var t=this.treeViewObj.getTreeData(),i=[],a=null,o=0;o<t.length;o++)if(BoldBIDashboard.isNullOrUndefined(t[o].ParentId)||""===t[o].ParentId.trim()?i=[]:-1===i.indexOf(t[o].ParentId)&&i.pop(),t[o].HasChild&&i.push(t[o].ColumnId),t[o].ColumnId===e){a=t[o];break}return{parents:i=BoldBIDashboard.isNullOrUndefined(a)?i:[],item:a}},e.prototype.cancelAction=function(){this.dropDownObj.hidePopup()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.DropdownTreeview",InternalDropDownTreeview,window),InternalSortDialog=function(){function e(e){this.dashboardDesigner=null,this.dialogContainer=null,this.sortContainer=null,this.fieldContainer=null,this.sortOrderContainer=null,this.manualContainer=null,this.targetMethod="",this.menuItem=null,this.customSorting=null,this.datasetFields=[],this.measuresList=[],this.dimensionsList=[],this.measureFormats=[],this.dimensionFormats=[],this.listBoxField="text",this.sortType=CustomSortType[CustomSortType.Alphabetic],this.sortOrder=SortingOrder[SortingOrder.Ascending],this.fieldCell=null,this.manualCell=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.renderSortDialog(),this.dimensionFormats=this.getSummaryTypeArrayforDimension(),this.measureFormats=this.getmeasureFormatsList()}return e.prototype.getmeasureFormatsList=function(){var e=this.dashboardDesigner.modules.util;return[{value:SummaryType.SUM,text:e.getSummaryTypeLocalizedText(SummaryType.SUM)},{value:SummaryType.AVG,text:e.getSummaryTypeLocalizedText(SummaryType.AVG)},{value:SummaryType.COUNT,text:e.getSummaryTypeLocalizedText(SummaryType.COUNT)},{value:SummaryType.MAX,text:e.getSummaryTypeLocalizedText(SummaryType.MAX)},{value:SummaryType.MIN,text:e.getSummaryTypeLocalizedText(SummaryType.MIN)},{value:SummaryType.COUNTD,text:e.getSummaryTypeLocalizedText(SummaryType.COUNTD)},{value:SummaryType.VAR,text:e.getSummaryTypeLocalizedText(SummaryType.VAR)}]},e.prototype.getSummaryTypeArrayforDimension=function(){var e=this.dashboardDesigner.modules.util;return[{value:SummaryType.COUNT,text:e.getSummaryTypeLocalizedText(SummaryType.COUNT)},{value:SummaryType.COUNTD,text:e.getSummaryTypeLocalizedText(SummaryType.COUNTD)}]},e.prototype.renderSortDialog=function(){this.dialogContainer=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{height:"auto"},{title:this.locale.advancedSorting.advancedSortingTitle,id:this.id+"_sort_dialog"}),this.dashboardDesigner.element.append(this.dialogContainer),this.sortContainer=this.getSortContainer(),this.fieldContainer=this.getFieldContainer(),this.sortOrderContainer=this.getSortOrderContainer(),this.manualContainer=this.getManualContainer(),this.dialogContainer.append(this.sortContainer,this.fieldContainer,this.sortOrderContainer,this.manualContainer),this.dialogContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:600,minHeight:333,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.renderFooter(),this.getColumnField().BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.updateColumnField,this)}),this.getSummaryField().BoldBIDashboardDropDownList({width:"100%",fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,watermarkText:"Choose Field",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control"}),this.getListBoxDiv().BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()})},e.prototype.renderFooter=function(){var e=this.dashboardDesigner.element.find("#"+this.id+"_sort_dialog_foot"),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_sort_dialog_btn_cancel",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-primary bbi-dbrd-btn-small",this.locale.dialogOptions.applyButtonText,{float:"right"},{id:this.id+"_sort_dialog_btn_ok",type:"button"});e.append(t,i),i.on("click",this.bbdesigner$.proxy(this.updateSortInfo,this)),t.on("click",this.bbdesigner$.proxy(this.closeDialog,this,!0))},e.prototype.getSortContainer=function(){var e=BoldBIDashboard.buildTag("div","",{padding:"5px 0px"},{}),t=BoldBIDashboard.buildTag("label",this.locale.advancedSorting.sortByText,{},{type:"label"}),i=BoldBIDashboard.buildTag("div","",{},{}),a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),s=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),n=(this.fieldCell=BoldBIDashboard.buildTag("td","",{padding:"5px 25px"},{}),this.manualCell=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),{callBackInstance:this,callBackMethod:"updateSortType",groupName:"sortby",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_alphabetic",label:this.locale.advancedSorting.alphabeticSortText,isChecked:!0,value:"alphabetic"}]}),r={callBackInstance:this,callBackMethod:"updateSortType",groupName:"sortby",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_dataSource",label:this.locale.advancedSorting.dataSourceSortText,isChecked:!1,value:"datasource"}]},d={callBackInstance:this,callBackMethod:"updateSortType",groupName:"sortby",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_field",label:this.locale.advancedSorting.fieldSortText,isChecked:!1,value:"field"}]},l={callBackInstance:this,callBackMethod:"updateSortType",groupName:"sortby",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_manual",label:this.locale.advancedSorting.manualSortText,isChecked:!1,value:"manual"}]};return this.sortbyAlpha=new BoldBIDashboard.Dashboard.RadioButton(n,o),this.sortbyDatasource=new BoldBIDashboard.Dashboard.RadioButton(r,s),this.sortbyField=new BoldBIDashboard.Dashboard.RadioButton(d,this.fieldCell),this.sortbyManual=new BoldBIDashboard.Dashboard.RadioButton(l,this.manualCell),a.append(o,s,this.fieldCell,this.manualCell),i.append(a),e.append(t).append(i),e},e.prototype.getFieldContainer=function(){var e=BoldBIDashboard.buildTag("div","",{padding:"5px 0px 10px",display:"none"},{}),t=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=BoldBIDashboard.buildTag("td","",{padding:"5px 0px",width:"250px"},{}),o=BoldBIDashboard.buildTag("td","",{padding:"5px 10px",width:"150px"},{}),s=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),n=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_sort_dialog_column"}),r=BoldBIDashboard.buildTag("input.e-field e-ejinputtext","",{},{type:"text",id:this.id+"_sort_dialog_summary"});return a.append(n),o.append(r),i.append(a).append(o).append(s),t.append(i),e.append(t),e},e.prototype.getSortOrderContainer=function(){var e=BoldBIDashboard.buildTag("div","",{padding:"5px 0px"},{}),t=BoldBIDashboard.buildTag("label",this.locale.advancedSorting.sortOrderText,{},{type:"label"}),i=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td","",{padding:"5px 0px",width:"25%"},{}),s=BoldBIDashboard.buildTag("td","",{padding:"5px 0px"},{}),n={callBackInstance:this,callBackMethod:"updateSortOrder",groupName:"sortOrder",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_ascending",label:this.locale.advancedSorting.sortAscendingText,isChecked:!0,value:"ascending"}]},r={callBackInstance:this,callBackMethod:"updateSortOrder",groupName:"sortOrder",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:this.id+"_sort_dialog_descending",label:this.locale.advancedSorting.sortDescendingText,value:"descending"}]};return this.sortOrderAscending=new BoldBIDashboard.Dashboard.RadioButton(n,o),this.sortOrderDescending=new BoldBIDashboard.Dashboard.RadioButton(r,s),i.append(a),a.append(o,s),e.append(t,i),e},e.prototype.getManualContainer=function(){var e=BoldBIDashboard.buildTag("div","",{display:"none"},{class:"bbi-manual-sort-container"}),t=this.locale.advancedSorting.manualSortDescriptionText,t=BoldBIDashboard.buildTag("label",t,{},{type:"label"}),i=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),a=BoldBIDashboard.buildTag("tr","",{},{}),o=BoldBIDashboard.buildTag("td","",{width:"90%"},{}),s=BoldBIDashboard.buildTag("td","",{},{}),n=BoldBIDashboard.buildTag("div","",{width:"100%",float:"left",padding:"5px 0px 0px","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_sort_dialog_listbox_Div"}),r=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_sort_dialog_buttonbox_Div",class:"manual-sort-button-container"}),d=BoldBIDashboard.buildTag("div","",{"box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"},{id:this.id+"_sort_dialog_listbox"}),l=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_sort_manual_move_to_top",class:"bbi-dbrd-designer-hoverable bbi-widgeticons sort-control-icons bbi-dbrd-designer-hand-cursor moveToTop","data-tooltip":this.locale.advancedSorting.moveToTop}),h=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_sort_manual_move_to_bottom",class:"bbi-dbrd-designer-hoverable bbi-widgeticons sort-control-icons bbi-dbrd-designer-hand-cursor moveToBottom","data-tooltip":this.locale.advancedSorting.moveToBottom}),p=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_sort_manual_move_up",class:"bbi-dbrd-designer-hoverable bbi-widgeticons sort-control-icons bbi-dbrd-designer-hand-cursor moveUp","data-tooltip":this.locale.advancedSorting.moveUp}),c=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_sort_manual_move_down",class:"bbi-dbrd-designer-hoverable bbi-widgeticons sort-control-icons bbi-dbrd-designer-hand-cursor moveDown","data-tooltip":this.locale.advancedSorting.moveDown}),u=BoldBIDashboard.buildTag("span","",{},{id:this.id+"_sort_manual_reset",class:"bbi-dbrd-designer-hoverable bbi-widgeticons sort-control-icons bbi-dbrd-designer-hand-cursor reset","data-tooltip":this.locale.advancedSorting.resetManual});return n.append(d),l.on("click",this.bbdesigner$.proxy(this.moveToTop,this)),h.on("click",this.bbdesigner$.proxy(this.moveToBottom,this)),p.on("click",this.bbdesigner$.proxy(this.moveUp,this)),c.on("click",this.bbdesigner$.proxy(this.moveDown,this)),u.on("click",this.bbdesigner$.proxy(this.manualOrderReset,this)),e.append(t),r.append(l).append(p).append(c).append(h).append(u),o.append(n),s.append(r),a.append(o).append(s),i.append(a),e.append(i),e},e.prototype.moveToTop=function(){this.listObject.moveTop()},e.prototype.moveToBottom=function(){this.listObject.moveBottom()},e.prototype.moveUp=function(){this.listObject.moveUp()},e.prototype.moveDown=function(){this.listObject.moveDown()},e.prototype.manualOrderReset=function(){this.getListBoxDatas()},e.prototype.updateColumnField=function(e){var e="Dimensions"===this.getItemType(e.text)?this.dimensionFormats:this.measureFormats,t=this.getSummaryField().data("BoldBIDashboardDropDownList");t.setModel({dataSource:e}),t.selectItemByIndex(0)},e.prototype.updateSortType=function(e){var t;switch((BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.args)||BoldBIDashboard.isNullOrUndefined(e.args.value)?e:e.args.value).toLowerCase()){case"alphabetic":this.fieldContainer.css("display","none"),this.sortOrderContainer.css("display","block"),this.manualContainer.css("display","none"),this.enableSortOrder(!0),this.sortType=CustomSortType[CustomSortType.Alphabetic];break;case"datasource":this.fieldContainer.css("display","none"),this.sortOrderContainer.css("display","block"),this.manualContainer.css("display","none"),this.enableSortOrder(!1),this.sortType=CustomSortType[CustomSortType.DataSource];break;case"field":this.fieldContainer.css("display","block"),this.sortOrderContainer.css("display","block"),this.manualContainer.css("display","none"),this.enableSortOrder(!0),this.sortType=CustomSortType[CustomSortType.Field];break;case"manual":this.fieldContainer.css("display","none"),this.sortOrderContainer.css("display","none"),this.manualContainer.css("display","block"),this.sortType=CustomSortType[CustomSortType.Manual],t=this.getListBox().attr("data-isLoaded"),BoldBIDashboard.isNullOrUndefined(t)&&(this.getListBoxDatas(),this.customSorting.ManualOrderList=null)}},e.prototype.getListBoxDatas=function(){var e;this.customSorting.CustomSortType==CustomSortType[CustomSortType.Manual]&&this.customSorting.ManualOrderList?this.setListBoxValuesFromManualOrderList(this.dataInfo.UniqueColumnName,this.customSorting.ManualOrderList):(null!=(e=this.listObject)&&e.destroy(),e=[{Id:this.dataInfo.Id,Name:this.dataInfo.Name,SummaryType:this.dataInfo.SummaryType,FieldType:this.dataInfo.FieldType,MeasureFormatting:this.dataInfo.MeasureFormatting,DateTimeFormat:this.dataInfo.DateTimeFormat,FilterInfo:null,UniqueColumnName:this.dataInfo.UniqueColumnName,CustomSorting:null}],this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getData,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getData,fieldInfo:e,dataSetId:this.dataInfo.DatasourceID,startIndex:1,pageSize:50,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.setListBoxValues,this,this.dataInfo.UniqueColumnName),indicator:[this.bbdesigner$.proxy(this.showLoadingIndicator,this),this.bbdesigner$.proxy(this.hideLoadingIndicator,this)]}))},e.prototype.setListBoxValues=function(e,t){t=JSON.parse(t.jsonData);!BoldBIDashboard.isNullOrUndefined(t)&&0<t.length&&(this.listBoxField=e,this.listObject=new ejdashboard.dropdowns.ListBox({dataSource:t,fields:{value:this.listBoxField},height:"188px",allowDragAndDrop:!0,cssClass:"manual-sort-listbox"}),this.listObject.appendTo("#"+this.id+"_sort_dialog_listbox"),this.getListBox().attr("data-isLoaded","true"))},e.prototype.setListBoxValuesFromManualOrderList=function(e,t){var i;null!=(i=this.listObject)&&i.destroy(),!BoldBIDashboard.isNullOrUndefined(i=t)&&0<i.length&&(this.listBoxField=e,this.listObject=new ejdashboard.dropdowns.ListBox({dataSource:i,fields:{value:this.listBoxField},height:"188px",allowDragAndDrop:!0,cssClass:"manual-sort-listbox"}),this.listObject.appendTo("#"+this.id+"_sort_dialog_listbox"),this.getListBox().attr("data-isLoaded","true"))},e.prototype.showLoadingIndicator=function(){this.getListBoxDiv().BoldBIDashboardWaitingPopup("show")},e.prototype.hideLoadingIndicator=function(){this.getListBoxDiv().BoldBIDashboardWaitingPopup("hide")},e.prototype.updateSortOrder=function(e){switch(e.args.value){case"ascending":this.sortOrder=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(SortingOrder,SortingOrder.Ascending);break;case"descending":this.sortOrder=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(SortingOrder,SortingOrder.Descending)}},e.prototype.enableSortOrder=function(e){var t=this.getAscendingRadioButton(),i=this.getDescendingRadioButton();e?(t.prop("disabled",!1),i.prop("disabled",!1),this.sortOrderContainer.removeClass("e-radio-btn-disabled")):(t.prop("disabled",!0),i.prop("disabled",!0),this.sortOrderContainer.addClass("e-radio-btn-disabled"))},e.prototype.openSortDialog=function(e,t,i,a){this.resetSortDialog(),this.targetInstance=e,this.targetMethod=t,this.dataInfo=i,this.menuItem=a,this.dialogContainer.data("BoldBIDashboardDialog").open(),BoldBIDashboard.isNullOrUndefined(i)||(this.dataInfo.FieldType===FieldType.Measures?(this.getFieldRadioButton().prop("disabled",!0),this.fieldCell.addClass("e-radio-btn-disabled"),this.sortOrderContainer.find("#"+this.id+"_sort_dialog_ascending_rdo_input").prop("label","Value")):(this.getFieldRadioButton().prop("disabled",!1),this.fieldCell.removeClass("e-radio-btn-disabled"),this.sortOrderContainer.find("#"+this.id+"_sort_dialog_ascending_rdo_input").prop("label","Alphabetic")),this.customSorting=((BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)||BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields[0].CustomSorting))&&(BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields)||BoldBIDashboard.isNullOrUndefined(i.ChildHierarchicalFields[0].CustomSorting))?i:i.ChildHierarchicalFields[0]).CustomSorting,this.manualCell.css("display","none"),this.populateSortInformation())},e.prototype.resetSortDialog=function(){this.customSorting=null,this.targetInstance=null,this.targetMethod=null,this.dataInfo=null,this.datasetFields=[],this.measuresList=[],this.dimensionsList=[]},e.prototype.populateSortInformation=function(){switch(this.updateDatasetFields(),this.dataInfo.IsCustomSortApplied||(""===this.customSorting.CustomSortType&&(this.customSorting.CustomSortType=CustomSortType[CustomSortType.Alphabetic]),""===this.customSorting.CustomSortOrder&&(this.customSorting.CustomSortOrder=SortingOrder[SortingOrder.Ascending])),this.customSorting.CustomSortType){case CustomSortType[CustomSortType.Alphabetic]:this.getAlphabeticRadioButton().prop("checked",!0),this.updateSortType(this.customSorting.CustomSortType);break;case CustomSortType[CustomSortType.DataSource]:this.getDataSourceRadioButton().prop("checked",!0),this.updateSortType(this.customSorting.CustomSortType);break;case CustomSortType[CustomSortType.Field]:this.getFieldRadioButton().prop("checked",!0),this.updateSortType(this.customSorting.CustomSortType);break;case CustomSortType[CustomSortType.Manual]:this.getManualRadioButton().prop("checked",!0),this.updateSortType(this.customSorting.CustomSortType)}switch(this.customSorting.CustomSortOrder){case SortingOrder[SortingOrder.Ascending]:this.getAscendingRadioButton().prop("checked",!0);break;case SortingOrder[SortingOrder.Descending]:this.getDescendingRadioButton().prop("checked",!0)}this.populateFieldInfo()},e.prototype.populateFieldInfo=function(){var e=this.getColumnField().data("BoldBIDashboardDropDownList"),t=this.getSummaryField().data("BoldBIDashboardDropDownList");e.setModel({dataSource:this.datasetFields}),BoldBIDashboard.isNullOrUndefined(this.customSorting.FieldId)||""===this.customSorting.FieldId?e.selectItemByIndex(0):e.selectItemByValue(this.customSorting.FieldId),e="Dimensions"===(BoldBIDashboard.isNullOrUndefined(this.customSorting.FieldName)||""===this.customSorting.FieldName?this.getItemType(e.selectedTextValue.toString()):this.getItemType(this.customSorting.FieldName))?this.dimensionFormats:this.measureFormats,t.setModel({dataSource:e}),BoldBIDashboard.isNullOrUndefined(this.customSorting.SummaryType)?t.selectItemByIndex(0):t.selectItemByValue(this.customSorting.SummaryType)},e.prototype.updateDatasetFields=function(){var e,t,i,a,o=BoldBIDashboard.Dashboard.ConnectionHelper.getConnectionInsFromDSId(this.dashboardDesigner,this.dataInfo.DatasourceID),o=BoldBIDashboard.Dashboard.ConnectionHelper.isHierarchicalConnection(o);for(this.getSummaryField().data("BoldBIDashboardDropDownList").setModel({enabled:!o}),e=this.dashboardDesigner.modules.dataSet.datasets,t=BoldBIDashboard.DashboardUtil.getCurrentField(e,this.dataInfo.DatasourceID,o),i=0;i<t.length;i++)this.datasetFields.push({text:t[i].Name,value:t[i].Id}),("bbi-designer-dataset-number"===(a=BoldBIDashboard.DashboardUtil.getDatasetTypeIcon(t[i].TypeName))?this.measuresList:this.dimensionsList).push({Name:t[i].Name,DatasetIcon:a,DataField:t[i].Id})},e.prototype.getItemType=function(e){for(var t="",i=0;i<this.measuresList.length;i++)this.measuresList[i].Name===e&&(t="Measures");for(i=0;i<this.dimensionsList.length;i++)this.dimensionsList[i].Name===e&&(t="Dimensions");return t},e.prototype.updateSortInfo=function(){var e,t,i;if(!BoldBIDashboard.isNullOrUndefined(this.targetInstance)){if(e=this.getSummaryField().data("BoldBIDashboardDropDownList").model.value,t=this.getColumnField().data("BoldBIDashboardDropDownList"),this.customSorting={FieldId:t.getSelectedValue(),FieldName:this.bbdesigner$(t.getSelectedItem()).text(),SummaryType:BoldBIDashboard.DashboardDesignerUtility.Serialization.getSummaryType(e.toUpperCase()),ManualOrderList:this.sortType==CustomSortType[CustomSortType.Manual]?this.getManualOrderList():null,CustomSortOrder:this.sortOrder,CustomSortType:this.sortType},BoldBIDashboard.isNullOrUndefined(this.dataInfo.ChildHierarchicalFields))this.applySorting(this.dataInfo);else for(i=0;i<this.dataInfo.ChildHierarchicalFields.length;i++)this.applySorting(this.dataInfo.ChildHierarchicalFields[i]);this.getListBox().removeAttr("data-isLoaded")}this.closeDialog()},e.prototype.applySorting=function(e){e.IsCustomSortApplied=!0,e.Sorting=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(SortingOrder,this.customSorting.CustomSortOrder),e.CustomSorting=this.customSorting,BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.customSorting,e,this.menuItem])},e.prototype.getManualOrderList=function(){var e,t,i=[];if(this.listObject)for(e=this.listObject.getItems(),t=0;t<e.length;t++)i.push(e[t].dataset.value);return i},e.prototype.closeDialog=function(){this.getListBox().removeAttr("data-isLoaded"),this.dialogContainer.data("BoldBIDashboardDialog").close()},e.prototype.getAscendingRadioButton=function(){return this.sortOrderContainer.find("#"+this.id+"_sort_dialog_ascending_rdo_input")},e.prototype.getDescendingRadioButton=function(){return this.sortOrderContainer.find("#"+this.id+"_sort_dialog_descending_rdo_input")},e.prototype.getAlphabeticRadioButton=function(){return this.sortContainer.find("#"+this.id+"_sort_dialog_alphabetic_rdo_input")},e.prototype.getDataSourceRadioButton=function(){return this.sortContainer.find("#"+this.id+"_sort_dialog_dataSource_rdo_input")},e.prototype.getFieldRadioButton=function(){return this.sortContainer.find("#"+this.id+"_sort_dialog_field_rdo_input")},e.prototype.getManualRadioButton=function(){return this.sortContainer.find("#"+this.id+"_sort_dialog_manual_rdo_input")},e.prototype.getColumnField=function(){return this.fieldContainer.find("#"+this.id+"_sort_dialog_column")},e.prototype.getSummaryField=function(){return this.fieldContainer.find("#"+this.id+"_sort_dialog_summary")},e.prototype.getListBox=function(){return this.manualContainer.find("#"+this.id+"_sort_dialog_listbox")},e.prototype.getListBoxDiv=function(){return this.manualContainer.find("#"+this.id+"_sort_dialog_listbox_Div")},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dialogContainer),0<this.dialogContainer.length&&this.dashboardDesigner.element.find("#"+this.id+"_sort_dialog").remove()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.SortDialog",InternalSortDialog,window),function(e){e[e.Alphabetic="Alphabetic"]="Alphabetic",e[e.DataSource="DataSource"]="DataSource",e[e.Field="Field"]="Field",e[e.Manual="Manual"]="Manual",e[e.None="None"]="None"}(CustomSortType=CustomSortType||{}),function(m){var e;function t(e){this.id=null,this.dashboardDesigner=null,this.localizationContent=null,this.selectedFieldName=null,this.value=null,this.columnDetails=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.widgetHelper=this.dashboardDesigner.modules.widgetHelper,this.localizationContent=this.dashboardDesigner.getLocalizationContent(),this.dataconfiguration=new m.DashboardDesignerUtility.DataConfiguration(this.dashboardDesigner)}e=m.Dashboard||(m.Dashboard={}),t.prototype.onSettingsClick=function(e,t){var i,a=m.isNullOrUndefined(e.ChildHierarchicalFields)?this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId):this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId),o=a.data("BoldBIDashboardMenu"),s=this.getMenuJson(a,[],e),n=m.isNullOrUndefined(e.ChildHierarchicalFields)?"_categoryListSettingsIcon_":"_categoryListSettingsIconHierarchy_";this.id+"_"+e.Id+n+e.UniqueId===t.target.id&&(a.is(":visible")?o.hide():0<a.children().length&&(i=this.dashboardDesigner.designerPanel.selectedReportItems[0],s=m.Dashboard.WidgetHelper.getWidgetInstance(i).onFieldSettingsClick(e,s),this.updateMenuJsonIntoMenu(s,o,e),i=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+n+e.UniqueId),s=new m.Dashboard.CreateFieldMenu(this.dashboardDesigner).calculateMenuPosition(i,i.offset(),a),o.show(s.left,s.top,this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListDiv_"+e.UniqueId),t)))},t.prototype.updateMenuJsonIntoMenu=function(e,t,i){for(var a=0;a<e.length;a++){var o=e[a],s=this.id+"_"+o.Name+"_"+i.UniqueId,n=this.bbdesigner$("#"+s);o.IsVisible=this.updateMenuVisibilityForFilterColumn(o,i),0<n.length&&(this.updateMenuSelection(o,n,i),this.hideOrShowMenuItem(o,s,t),this.disableOrEnableMenuItem(o,s,t),this.enableOrDisableSeperator(o,n)),0<o.Items.length&&this.updateMenuJsonIntoMenu(o.Items,t,i)}},t.prototype.updateMenuVisibilityForFilterColumn=function(e,t){return t.IsFilterColumn?"Sort"!==e.Name&&"RelativeDateOptions"!==e.Name&&("DimensionFilters"===e.Name||"RelativeDateFilter"===e.Name||e.IsVisible):e.IsVisible},t.prototype.hideOrShowMenuItem=function(e,t,i){e.IsVisible?i.enableItemByID(t):i.hideItems(["#"+t])},t.prototype.disableOrEnableMenuItem=function(e,t,i){e.IsDisable?i.disableItemByID(t):i.enableItemByID(t)},t.prototype.enableOrDisableSeperator=function(e,t){e.EnableSeparator?t.addClass("e-separator"):t.removeClass("e-separator")},t.prototype.updateMenuSelection=function(e,t,i){var a;m.isNullOrUndefined(e.Icon)&&e.IsSelected?((a=t.find(">.e-fieldmenuListName>.e-fieldmenuListIcon")).addClass("e-dashboardtick-icon e-selectedfieldmenu"),"DimensionFilters"!==e.Name||m.isNullOrUndefined(i.FilterInfo)||m.isNullOrUndefined(i.FilterInfo.DimensionFilterInfo)?"RelativeDateFilter"!==e.Name||m.isNullOrUndefined(i.FilterInfo)||m.isNullOrUndefined(i.FilterInfo.RelativeDateFilterInfo)?m.isNullOrUndefined(ShowValueType[e.Name])?"MeasureFormat"!==e.Name&&"MeasureFilter"!==e.Name&&"RelativeDateOptions"!==e.Name&&"RelativeDateFilter"!==e.Name&&"DimensionFilters"!==e.Name&&a.addClass("e-summaryselectedfieldmenu"):a.addClass("e-showvaluefieldmenu"):a.addClass("e-relativefiltermenu"):a.addClass("e-filtermenu")):(a=t.find(">.e-fieldmenuListName>.e-fieldmenuListIcon")).removeClass("e-dashboardtick-icon e-selectedfieldmenu e-relativefiltermenu e-filtermenu e-summaryselectedfieldmenu e-showvaluefieldmenu")},t.prototype.getPropertyChangedMenuItems=function(e,t,i,a){var o,s=this.getPropertyMenuList(e,t,i);for(0<s.length&&a.push(s[0]),o=void 0;o<e.length;o++)0<e[o].Items.length&&this.getPropertyChangedMenuItems(e[o].Items,t,i,a);return a},t.prototype.getPropertyMenuList=function(e,t,i){var a=[];switch(t){case"Visiblity":a=e.filter(function(e){return e.IsVisible===i});break;case"Selection":a=e.filter(function(e){return e.IsSelected===i});break;case"Disable":a=e.filter(function(e){return e.IsDisable===i});break;case"Separator":a=e.filter(function(e){return e.EnableSeparator===i})}return a},t.prototype.getMenuJson=function(e,t,i){var a,o,s,n;if(!m.isNullOrUndefined(e)&&0<e.length)for(a=e.find(">.e-list"),o=0;o<a.length;o++)n=(s=this.bbdesigner$(a[o])).data("menuitem-info"),n=m.isNullOrUndefined(i.DateBucketInfo)||m.isNullOrUndefined(i.DateBucketInfo.DatebucketId)||m.DashboardUtil.IsStringNullorWhiteSpace(i.DateBucketInfo.DatebucketId)?this.updateFilterItemSelection(i,n):this.updateDateBucketFilterSelection(i.DateBucketInfo.DatebucketId,i.DateTimeFormat.toString(),n),(n=this.updateEnableOrDisableForFirstLastOption(n,i)).Items=this.getMenuJson(s.find(">ul"),[],i),t.push(n);return t},t.prototype.updateEnableOrDisableForFirstLastOption=function(e,t){var i,a,t=this.getCurrentFieldFilterInfo(t.UniqueId,t.ContainerName);if("First"===e.Name||"Last"===e.Name)for(i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,a=0;a<i.FieldContainers.length;a++)i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.values&&i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.value&&i.FieldContainers[a].DisplayName!==this.localizationContent.fieldContainer.locationValue||(e.IsDisable=0===i.FieldContainers[a].FieldInfos.length);else"MeasureFormat"===e.Name&&(e.IsDisable=!(m.isNullOrUndefined(t)||m.isNullOrUndefined(t.DimensionFilterInfo)||m.isNullOrUndefined(t.DimensionFilterInfo.TopNFilterInfo)));return e},t.prototype.updateFilterItemSelection=function(e,t){var i,a=this.getCurrentFieldFilterInfo(e.UniqueId,e.ContainerName);return m.isNullOrUndefined(a)&&this.validateSubFilterInfo(t.Name)?t.IsDisable=!0:m.isNullOrUndefined(a)&&t.IsSelected?"RelativeDateFilter"!==t.Name&&"DimensionFilters"!==t.Name&&"RelativeDateOptions"!==t.Name&&"MeasureFilter"!==t.Name&&"Settings"!==t.Name&&"InjectParameters"!==t.Name||(t.IsSelected=!1):m.isNullOrUndefined(a)||("DimensionFilters"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.DimensionFilterInfo):"MeasureFilter"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.MeasureFilterInfo):"RelativeDateFilter"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.RelativeDateFilterInfo):"RelativeDateOptions"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.RelativeDateOptions):"Settings"===t.Name?t.IsSelected=!m.isNullOrUndefined(a.CustomDateSettingsInfo):"First"!==t.Name||"Tooltip"!==e.ContainerName||m.isNullOrUndefined(a.DimensionFilterInfo)||m.isNullOrUndefined(a.DimensionFilterInfo.TopNFilterInfo)?"Last"!==t.Name||"Tooltip"!==e.ContainerName||m.isNullOrUndefined(a.DimensionFilterInfo)||m.isNullOrUndefined(a.DimensionFilterInfo.TopNFilterInfo)||(t.IsSelected=a.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Bottom):t.IsSelected=a.DimensionFilterInfo.TopNFilterInfo.Mode===RankType.Top,i=this.validateSubFilterInfo(t.Name),m.isNullOrUndefined(a.MeasureFilterInfo)&&"ClearMeasureFilter"===t.Name||m.isNullOrUndefined(a.DimensionFilterInfo)&&"ClearDimensionFilter"===t.Name||m.isNullOrUndefined(a.RelativeDateFilterInfo)&&"ClearRelativeDate"===t.Name||m.isNullOrUndefined(a.RelativeDateOptions)&&"ClearRelativeDateOptions"===t.Name||m.isNullOrUndefined(a.CustomDateSettingsInfo)&&"ClearCustomDateSettings"===t.Name||m.isNullOrUndefined(e.ParametersInWidgets)&&"ClearInjectParameters"===t.Name?t.IsDisable=!0:i&&(t.IsDisable=!1)),"InjectParameters"===t.Name&&(t.IsSelected=!m.isNullOrUndefined(e.ParametersInWidgets)&&0<e.ParametersInWidgets.length),"ClearInjectParameters"===t.Name&&(t.IsDisable=!(!m.isNullOrUndefined(e.ParametersInWidgets)&&0!==e.ParametersInWidgets.length)),t},t.prototype.validateSubFilterInfo=function(e){return"ClearMeasureFilter"===e||"ClearDimensionFilter"===e||"ClearRelativeDateOptions"===e||"ClearRelativeDate"===e||"ClearCustomDateSettings"===e},t.prototype.getCurrentFieldFilterInfo=function(t,i){var e=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.FieldContainers.filter(function(e){return e.Name===i});return 0<e.length&&0<(e=e[0].FieldInfos.filter(function(e){return e.UniqueId===t})).length?e[0].FilterInfo:null},t.prototype.updateDateBucketFilterSelection=function(e,t,i){var a=i.Name.toString().replace(/\s/g,"");switch(this.isDatebucketFieldInfo(i.Name)?this.getDateBucketWidgetID(i.Name):a){case e:i.IsSelected=!0;break;case t:i.IsSelected=!1;break;default:return i}return i},t.prototype.getDateBucketWidgetID=function(e){if(!m.DashboardUtil.IsStringNullorWhiteSpace(e))return e.split("DateBucket_")[1]},t.prototype.getFieldMenuName=function(e,t){for(var i,a=e.Name.replace(/\s/g,""),o=DateTimeFormat[a]||DateTimeFormatForFilter[a],s=this.dashboardDesigner.modules.widgetHelper.getAllDatebucketWidgets(),n=0;n<s.length;n++)if(m.isNullOrUndefined(o)&&this.isDatebucketFieldInfo(a)){if(s[n].isDefaultDataWidget()&&s[n].getContainerSettings().Title===e.DisplayName)return a=s[n].getJson().selectedValue.replace(/\s/g,""),m.isNullOrUndefined(t.DateBucketInfo)&&(t.DateBucketInfo=new DateBucketInformation),t.DateBucketInfo.DatebucketId="",i=e.Name.split("DateBucket_")[1],t.DateBucketInfo.DatebucketId=i,t.DateBucketInfo.DateBucketFormat=DateTimeFormat[a],m.DashboardUtil.invokeMethod(s[n],"updateConfiguredWidgetsInfoList",[t]),a}else this.isDatebucketFieldInfo(a)||m.isNullOrUndefined(t.DateBucketInfo)||(t.DateBucketInfo=null,m.DashboardUtil.invokeMethod(s[n],"removeConfiguredWidgetsInfoList",[t]));return a},t.prototype.isDatebucketFieldInfo=function(e){return-1!==e.indexOf("DateBucket_")},t.prototype.onSettingsMenuItemClick=function(e,t){var i,a,o=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).find(".e-mhover"),s=(o=m.isNullOrUndefined(e.ChildHierarchicalFields)?o:this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId).find(".e-mhover")).closest("li").data("menuitem-info"),n=o.closest("li").data("hierarchy-info"),r=this.getFieldMenuName(s,e),d=0===o.closest("li").children("ul").length;if(this.selectedFieldName=e.DateTimeFormat.toString(),i=this.selectedFieldName,!m.isNullOrUndefined(o)&&r!==this.dashboardDesigner.getLocalizationContent().dataconfiguration.menuItems.more){o=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).data("BoldBIDashboardMenu"),o=m.isNullOrUndefined(e.ChildHierarchicalFields)?o:this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUlHierarchy_"+e.UniqueId).data("BoldBIDashboardMenu"),d&&o.hide();var o=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId),l=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,h=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance.dimensionsList,p=this.getCurrentFieldInfoByUniqueName(l,e.UniqueColumnName),c=this.getCurrentDimensionFieldInfoById(h,e.Id);if("Rename"===r&&(d=!1,a=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListEditableTextBox_"+e.UniqueId),this.enableFieldRenameOption(a,o)),"Sort"===r)d=!1,this.sortClick(p,s);else if("CreateHierarchy"===r)d=!1,this.editCreateHierarchyFilterClick(c,h,e);else if("Remove"===r)d=!1,this.editRemoveCustomHierarchy(e);else if("AddToHierarchy"===r){if(!m.isNullOrUndefined(e)&&!m.isNullOrUndefined(n)&&e.Id===n.Id)return;d=!1,this.editAddToHierarchyFilterClick(c,h,n)}else"EditDimensionFilter"===r?(d=!1,this.editDimensionFilterClick(p)):"EditMeasureFilter"===r?(d=!1,this.editMeasureFilterClick(p)):"ClearMeasureFilter"===r?this.clearMeasureFilterClick(p):"ClearDimensionFilter"===r||"ClearRelativeDate"===r?this.clearDimensionOrClearRelativeDateClick(p,s):"MeasureFormat"===r?(d=!1,this.measureFormatClick(p)):"EditSettings"===r?(d=!1,this.customDateDialog(p,i)):"EditRelativeDate"===r?(d=!1,this.editRelativeDateClick(p,s)):"EditRelativeDateOptions"===r?(d=!1,("ListBox"===this.widgetHelper.getCurrentWidgetInstance().Type||"ComboBox"===this.widgetHelper.getCurrentWidgetInstance().Type)&&!m.isNullOrUndefined(l.FieldContainers[1].FieldInfos)&&0<l.FieldContainers[1].FieldInfos.length?this.dashboardDesigner.modules.util.alertDialog(this.localizationContent.alertDialogTitle.relativeDatesAlert,this.localizationContent.relativeDateMessages.displayColumnBinded,IconType.warning,AlertType.Alert,!1,""):this.editRelativeDateOptionsClick(p)):"ClearRelativeDateOptions"===r?(d=!1,this.clearRelativeDateOptionsClick(p,s)):"EditInjectParameters"===r?(d=!1,this.editInjectionParameterOptionsClick(p)):"ClearInjectParameters"===r?(d=!1,this.clearParametersInjectionOptionsClick(p,s)):"First"===r?(this.updateFirstAndLastFilterInfo(p,!(d=!1)),this.updateLabelText(p,s)):"Last"===r?(this.updateFirstAndLastFilterInfo(p,d=!1),this.updateLabelText(p,s)):m.isNullOrUndefined(SummaryType[s.Name])?m.isNullOrUndefined(ShowValueType[s.Name])?"MeasureFormat"!==r&&"MeasureFilter"!==r&&"RelativeDateOptions"!==r&&"RelativeDateFilter"!==r&&"InjectParameters"!==r&&"DimensionFilters"!==r&&"MeasureFormat"!==r&&"Rename"!==r&&t.text!==m.DashboardDesignerUtility.Serialization.enumToString(DateTimeFormat,p.DateTimeFormat)&&(p.IsShowAllRecords=!0,p.FilterInfo=null,s.IsSelected=!0,this.removeMenuSelection(p),this.widgetHelper.getCurrentWidgetInstance().clearFilter(),a=this.isDatebucketFieldInfo(s.Name.replace(/\s/g,"")),m.isNullOrUndefined(ShowDimensionValue[s.Name])||(p.ShowDimensionAs=e.ShowDimensionAs=s.IsSelected?s.Name:"none"),m.isNullOrUndefined(DateTimeFormat[r])||a||(p.DateTimeFormat=e.DateTimeFormat=DateTimeFormat[r]),a?d=!1:(c=t.text===this.dashboardDesigner.getLocalizationContent().dataconfiguration.summary.none?p.Name:r+"("+p.Name+")",p.IsDisplayNameEdited||(p.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(p),o.text(p.DisplayName)),o.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",c))):(this.removeSelectedShowValueType(p),s.IsSelected=!0,p.ShowValueType=s.Name,this.updateMeasureFormatForShowValueType(p)):("Tooltip"!==e.ContainerName||m.isNullOrUndefined(p.FilterInfo)||(p.FilterInfo=null),this.removeMenuSelection(p),s.IsSelected=!0,p.SummaryType=s.Name,h=this.dashboardDesigner.modules.util.getSummaryTypeLocalizedText(p.SummaryType)+"("+p.Name+")",p.IsDisplayNameEdited||(p.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(p),o.text(p.DisplayName)),o.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",h));n={update:!0,columnUpdate:!1,rowUpdate:!1,valueUpdate:!1},this.widgetHelper.getCurrentWidgetInstance().updateDataGroupInfo(l,n),d&&this.getDataConfigInstance().postDraggedFields()}},t.prototype.removeSelectedShowValueType=function(e){e=this.bbdesigner$("#"+this.id+"_"+e.ShowValueType+"_"+e.UniqueId).find(".e-showvaluefieldmenu").closest("li.e-list").data("menuitem-info");m.isNullOrUndefined(e)||m.isNullOrUndefined(ShowValueType[e.Name])||(e.IsSelected=!1)},t.prototype.updateMeasureFormatForShowValueType=function(e){e.ShowValueType===ShowValueType.NoCalculation?(e.MeasureFormatting=new MeasureFormatting,e.MeasureFormatting.Unit=NumberFormat.Ones):m.isNullOrUndefined(e.MeasureFormatting)||e.MeasureFormatting.FormatType===DataValueFormat.Percentage||(e.MeasureFormatting=new MeasureFormatting,e.MeasureFormatting.FormatType=DataValueFormat.Percentage,e.MeasureFormatting.Unit=NumberFormat.Ones)},t.prototype.updateLabelText=function(e,t){this.removeMenuSelection(e);var i=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId);t.IsSelected=!0,e.IsDisplayNameEdited||(e.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(e),i.text(e.DisplayName)),i.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",e.DisplayName)},t.prototype.updateFirstAndLastFilterInfo=function(e,t){var i,a,o,s;if(e.IsAggregatedExpression)return this.dashboardDesigner.modules.util.alertDialog(this.localizationContent.alertDialogTitle.firstAndLast,this.localizationContent.alertWindowMesages.firstAndLastMessage,IconType.warning,AlertType.Alert,!1,"");for(i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=0;o<i.FieldContainers.length;o++)i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.values&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.measure&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.value&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.locationValue&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.xAxis&&i.FieldContainers[o].DisplayName!==this.localizationContent.fieldContainer.actualValue||(a=i.FieldContainers[o].FieldInfos[0]);(s=new DimensionFilterInfo).IsTopNFilteringApplied=!0,s.TopNFilterInfo=new TopNFilteringInfo,s.TopNFilterInfo.ColumnId=a.Id,s.TopNFilterInfo.ColumnName=a.Name,s.TopNFilterInfo.Mode=t?RankType.Top:RankType.Bottom,s.TopNFilterInfo.IsBasedOnDateAndTimeField=!1,s.TopNFilterInfo.NoOfRecords=1,t=this.widgetHelper.getCurrentWidgetInstance().getJson().FilterSettings,s.TopNFilterInfo.IsHierarchicalFilter=!!m.isNullOrUndefined(t)||t.HierarchicalFilter,s.TopNFilterInfo.SummaryType=a.SummaryType,t=[s,e],e.DisplayName=e.Name,e.SummaryType=SummaryType.NONE,m.DashboardUtil.invokeMethod(this,"dimensionFilterAction",t)},t.prototype.enableFieldRenameOption=function(e,t){e.val(t.text()),e.addClass("show-fieldInfo-textbox"),t.addClass("hide-fieldInfo-label"),e.focus()},t.prototype.removeMenuSelection=function(e){e=this.bbdesigner$("#"+this.id+"_"+e.Id+"_categoryAggregateListUl_"+e.UniqueId).find(".e-summaryselectedfieldmenu").parents("li.e-list").data("menuitem-info");m.isNullOrUndefined(e)||(e.IsSelected=!1)},t.prototype.createCustomSorting=function(){return new m.Dashboard.CustomSortForUI},t.prototype.sortClick=function(e,t){var i,e=JSON.parse(JSON.stringify(e)),a=this.dashboardDesigner.modules.sortDialog;m.isNullOrUndefined(e.CustomSorting)&&(e.CustomSorting=this.createCustomSorting(),e.CustomSorting.CustomSortType="row"===e.ContainerName.toLowerCase()&&e.Sorting===SortingOrder.None?CustomSortType[CustomSortType.DataSource]:e.CustomSorting.CustomSortType),i=this.widgetHelper.getCurrentWidgetInstance(),a.openSortDialog(this,"updateSortInfo",e,t,i.Type)},t.prototype.editRemoveCustomHierarchy=function(e){this.dashboardDesigner.modules.util.alertDialog(this.dashboardDesigner.getLocalizationContent().customHierarchy.titleText,this.dashboardDesigner.getLocalizationContent().customHierarchy.dialogContentText,IconType.question,AlertType.Confirm,!1,"",{height:140,width:500,method:"alertBoxtoRemoveHierarchy",dataInfo:{fieldInfo:e},instance:this.dataconfiguration})},t.prototype.editCreateHierarchyFilterClick=function(e,t,i){var a,o,s,n=0,r=0,d=this.dashboardDesigner.modules.dataSet.datasets,l=(m.isNullOrUndefined(e.ParentId)||delete e.ParentId,(a=JSON.parse(JSON.stringify(e))).Name=a.Name+" Hierarchy",a.ChildHierarchicalFields=[],a.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(e))),this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+e.ContainerName+"_categoryList")),h=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,p=h.selectedDatasetId,c=d.findIndex(function(e){return e.Id===p}),h=this.dataconfiguration.createLabelForHeirachialDroppedField(a,!0,h,!0);for(d[c].CustomHierarchyFields.push(a),d=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller"),c=h.find(".e-heirachy-field").data("fields"),o=0;o<t.length;o++)if(e.Id===t[o].Id){n=o+1;break}for(s=0;s<l[0].children.length;s++)this.dashboardDesigner._id+"_"+i.Id+"_categoryListDiv"===l[0].children[s].id&&(r=s+1);!m.isNullOrUndefined(l)&&0<l.length&&(-1<r&&0<l.children().length&&r<l.children().length?h.insertBefore(l.children().eq(r)):h.insertBefore(l.children().last())),this.dataconfiguration.setParentId(c),c.forEach(function(e){t.splice(n,0,e),n++}),m.isNullOrUndefined(d)||d.refresh()},t.prototype.editAddToHierarchyFilterClick=function(t,i,a){m.isNullOrUndefined(t.ChildHierarchicalFields)||delete t.ChildHierarchicalFields;for(var e,o,s,n=0,r=0,d=!1,l=this.dashboardDesigner.modules.dataSet.datasets,h=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_"+t.ContainerName+"_categoryList"),p=this.widgetHelper.getCurrentWidgetInstance().dataConfigurationInstance,c=p.selectedDatasetId,u=l.findIndex(function(e){return e.Id===c}),b=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_Dimensions_categoryListPanel").data("BoldBIDashboardScroller"),g=0;g<i.length;g++)i[g].Id===a.Id&&!m.isNullOrUndefined(i[g].HasChild)&&i[g].HasChild&&(s=JSON.parse(JSON.stringify(i[g])),m.isNullOrUndefined(s.ChildHierarchicalFields)||delete s.ChildHierarchicalFields,n=g),(i[g].Id===a.Id&&"hierarchy"===i[g].TreeNode||!m.isNullOrUndefined(i[g].ParentId)&&i[g].ParentId===a.Id)&&(i.splice(g,1),g-=1);if(e=l[u].CustomHierarchyFields.find(function(e){return e.Id===a.Id}),e=m.isNullOrUndefined(e)?a:e,s.ChildHierarchicalFields=[],e.ChildHierarchicalFields.forEach(function(e){s.ChildHierarchicalFields.push(e),e.Id===t.Id&&(d=!0)}),s.ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),!d){for(m.isNullOrUndefined(l[u].CustomHierarchyFields[l[u].CustomHierarchyFields.indexOf(e)])||this.dashboardDesigner.modules.dataSet.datasets[u].CustomHierarchyFields[l[u].CustomHierarchyFields.indexOf(e)].ChildHierarchicalFields.push(JSON.parse(JSON.stringify(t))),l=this.dataconfiguration.createLabelForHeirachialDroppedField(s,!0,p,!0),u=h.children().length,h.children().remove("#"+this.dashboardDesigner._id+"_Dimension_categoryList_treeview_"+a.Id),u===h.children().length&&h.children().remove("#"+this.dashboardDesigner._id+"_"+a.Id+"_categoryListParentDiv_"+a.UniqueId),e=l.find(".e-heirachy-field").data("fields"),o=0;o<h[0].children.length;o++)this.dashboardDesigner._id+"_"+a.Id+"_categoryListDiv"===h[0].children[o].id&&(r=o+1);!m.isNullOrUndefined(h)&&0<h.length&&(-1<r&&0<h.children().length&&r<h.children().length?l.insertBefore(h.children().eq(r)):l.insertBefore(h.children().last())),this.dataconfiguration.setParentId(e),e.forEach(function(e){i.splice(n,0,e),n++}),m.isNullOrUndefined(b)||b.refresh()}},t.prototype.editDimensionFilterClick=function(e){var e=JSON.parse(JSON.stringify(e)),t=m.isNullOrUndefined(e)||m.isNullOrUndefined(e.FilterInfo)?null:e.FilterInfo.DimensionFilterInfo,i=this.widgetHelper.getCurrentWidgetInstance();"DatePicker"===i.Type||"PeriodOverPeriod"===i.Type?this.dashboardDesigner.modules.rangeFilterDialog.openFilterDialog(this,"dimensionFilterAction",e,t):this.dashboardDesigner.modules.dimensionFilter.openDimensionFilterWindow(this,"dimensionFilterAction",e,t,i)},t.prototype.customDateDialog=function(e,t){var e=JSON.parse(JSON.stringify(e)),i=null==e.FilterInfo||m.isNullOrUndefined(e.FilterInfo.CustomDateSettingsInfo)?new m.Dashboard.DatesettingInfoForUI:e.FilterInfo.CustomDateSettingsInfo,a=this.dashboardDesigner.modules.dateinfo;i.UniqueColumnName=e.UniqueColumnName,a.selectedFieldName=t,a.openDatesettingClick(this,"dateSettingsAction",e,i)},t.prototype.editMeasureFilterClick=function(e){var e=JSON.parse(JSON.stringify(e)),t=null==e.FilterInfo||m.isNullOrUndefined(e.FilterInfo.MeasureFilterInfo)?new m.Dashboard.MeasureFilterInfoForUI:e.FilterInfo.MeasureFilterInfo;t.UniqueColumnName=e.UniqueColumnName,this.dashboardDesigner.modules.measureFilter.openMeasureFilter(this,"measureFilterAction",e,t,!1)},t.prototype.clearMeasureFilterClick=function(e){e.FilterInfo=null,e.IsShowAllRecords=!0},t.prototype.clearDimensionOrClearRelativeDateClick=function(e,t){e.FilterInfo.DimensionFilterInfo=null,m.isNullOrUndefined(e.FilterInfo.RelativeDateFilterInfo)||(e.FilterInfo.RelativeDateFilterInfo=null),e.IsShowAllRecords=!0,t.IsDisable=!0,this.widgetHelper.getCurrentWidgetInstance().clearFilter()},t.prototype.measureFormatClick=function(t){var i=this,e=m.isNullOrUndefined(t.MeasureFormatting)?new MeasureFormatting:JSON.parse(JSON.stringify(t.MeasureFormatting));this.dashboardDesigner.modules.formatDialog.openFormatDialog(e,this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.DataSourceName,function(e){t.MeasureFormatting=e,i.getDataConfigInstance().postDraggedFields()},!1,!1,t)},t.prototype.editRelativeDateClick=function(e,t){var e=JSON.parse(JSON.stringify(e)),i=null;m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateFilterInfo)?((i=new RelativeDateFilterInfo).ColumnId=e.Id,i.ColumnName=e.Name):i=e.FilterInfo.RelativeDateFilterInfo,i.UniqueColumnName=e.UniqueColumnName,this.dashboardDesigner.modules.relativeDateFilter.openRelativeDateFilter(this,"relativeDateFilterAction",i,e,t)},t.prototype.editRelativeDateOptionsClick=function(e){this.columnDetails=e;e=m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateOptions)?[]:e.FilterInfo.RelativeDateOptions,e=this.bbdesigner$.extend([],!0,e);this.dashboardDesigner.modules.relativeDates.openRelativeDatesDialog(this,"relativeDateOptionsAction",e)},t.prototype.editInjectionParameterOptionsClick=function(e){this.columnDetails=e;e=m.isNullOrUndefined(e.ParametersInWidgets)?[]:e.ParametersInWidgets,e=this.bbdesigner$.extend([],!0,e);this.dashboardDesigner.modules.parametersInWidget.openParametersInjectionDialog(this,"relativeParametersOptionsAction",e)},t.prototype.clearRelativeDateOptionsClick=function(e,t){m.isNullOrUndefined(e.FilterInfo)||m.isNullOrUndefined(e.FilterInfo.RelativeDateOptions)||(e.FilterInfo.RelativeDateOptions=null,t.IsDisable=!0,(t=this.widgetHelper.getCurrentWidgetInstance()).clearFilter(),"ComboBox"!==t.Type&&"ListBox"!==t.Type)||(t=this.dashboardDesigner.element.find("#"+this.id+"_"+e.Id+"_categoryListLabel_"+e.UniqueId),e.DisplayName=this.dashboardDesigner.modules.util.getDisplayName(e),t.text(e.DisplayName),t.parents(".bbi-assigndata-dropped-field").attr("data-tooltip",e.DisplayName))},t.prototype.clearParametersInjectionOptionsClick=function(e,t){!m.isNullOrUndefined(e.ParametersInWidgets)&&0<e.ParametersInWidgets.length&&(e.ParametersInWidgets=null,t.IsDisable=!0,this.widgetHelper.getCurrentWidgetInstance().clearFilter(),this.getDataConfigInstance().postDraggedFields())},t.prototype.getCurrentFieldInfoByUniqueName=function(e,t){var i,a;if(!m.isNullOrUndefined(e))for(i=0;i<e.FieldContainers.length;i++)if(0<(a=e.FieldContainers[i].FieldInfos.filter(function(e){return e.UniqueColumnName===t})).length)return a[0];return null},t.prototype.getCurrentDimensionFieldInfoById=function(e,t){if(!m.isNullOrUndefined(e)&&!m.isNullOrUndefined(t)){e=e.filter(function(e){return e.Id===t&&m.isNullOrUndefined(e.ParentId)&&m.isNullOrUndefined(e.TreeNode)});if(0<e.length)return e[0]}return null},t.prototype.getDataConfigInstance=function(){return this.dashboardDesigner.modules.dataConfiguration},t.prototype.dimensionFilterAction=function(e,t){for(var i,a,o,s=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,n=0;n<s.FieldContainers.length;n++)for(i=s.FieldContainers[n].FieldInfos,a=0;a<i.length;a++)i[a].UniqueColumnName===t.UniqueColumnName&&(m.isNullOrUndefined(i[a].FilterInfo)?m.isNullOrUndefined(e)?i[a].FilterInfo=null:((o=new m.Dashboard.FilterInfoForUI).DimensionFilterInfo=e,i[a].FilterInfo=o):(i[a].FilterInfo.RelativeDateFilterInfo=null,i[a].FilterInfo.DimensionFilterInfo=e)),t.UniqueId===i[a].UniqueId&&(t.DateTimeFormat=i[a].DateTimeFormat);m.isNullOrUndefined(e)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1),this.getDataConfigInstance().postDraggedFields()},t.prototype.measureFilterAction=function(e){for(var t,i,a=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=new MeasureCondition,s=0;s<e.Values.length;s++)t=e.Values[s],o.Values.push(t);i={MeasureFilterInfo:{ColumnName:e.ColumnName,SummaryType:e.SummaryType,UniqueColumnName:e.UniqueColumnName,Conditions:e.Conditions,Values:o.Values}},this.getCurrentFieldInfoByUniqueName(a,e.UniqueColumnName).FilterInfo=0!==i.MeasureFilterInfo.Values.length?i:null,this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateOptionsAction=function(e){var t,i,a,o,s,n=this.widgetHelper.getCurrentWidgetInstance(),r=n.DataGroupInfo,d={RelativeDateOptions:e};if(1<=r.FieldContainers.length)for(t=0;t<r.FieldContainers.length;t++)for(i=r.FieldContainers[t].FieldInfos,a=0;a<i.length;a++)o=0===d.RelativeDateOptions.length?null:1<=d.RelativeDateOptions.length&&i[a].UniqueColumnName?d:i[a].FilterInfo,"ComboBox"===n.Type||"ListBox"===n.Type?this.columnDetails.UniqueColumnName===i[a].UniqueColumnName&&(i[a].FilterInfo=o,s=this.dashboardDesigner.element.find("#"+this.id+"_"+i[a].Id+"_categoryListLabel_"+i[a].UniqueId),i[a].DisplayName="Relative Dates("+i[a].Name+")",s.text(i[a].DisplayName),s.parents(".bbi-assigndata-dropped-field").attr("data-tooltip","Relative Dates("+i[a].Name+")")):i[a].FilterInfo=o;this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeParametersOptionsAction=function(e){var t,i,a,o=this.widgetHelper.getCurrentWidgetInstance(),s=o.DataGroupInfo;if(1<=s.FieldContainers.length)for(t=0;t<s.FieldContainers.length;t++)for(i=s.FieldContainers[t].FieldInfos,a=0;a<i.length;a++)this.columnDetails.UniqueColumnName===i[a].UniqueColumnName&&(m.Dashboard.WidgetHelper.clearFilterSelectionOnParamInjectionChange(e,o),i[a].ParametersInWidgets=e);this.getDataConfigInstance().postDraggedFields()},t.prototype.relativeDateFilterAction=function(e,t){var i=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo;1<=i.FieldContainers.length&&(i=this.getCurrentFieldInfoByUniqueName(i,t.UniqueColumnName),m.isNullOrUndefined(i.FilterInfo)?((t=new m.Dashboard.FilterInfoForUI).RelativeDateFilterInfo=e,i.FilterInfo=t):(i.FilterInfo.DimensionFilterInfo=null,i.FilterInfo.RelativeDateFilterInfo=e)),m.isNullOrUndefined(e)||(this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo.IsShowAllRecords=!1),this.getDataConfigInstance().postDraggedFields()},t.prototype.dateSettingsAction=function(e){var t=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,i={CustomDateSettingsInfo:{Format:e.Format,CustomFormat:e.CustomFormat,FiscalYear:e.FiscalYear,UniqueColumnName:e.UniqueColumnName}};this.getCurrentFieldInfoByUniqueName(t,e.UniqueColumnName).FilterInfo=null!=i.CustomDateSettingsInfo?i:null,this.getDataConfigInstance().postDraggedFields()},t.prototype.updateSortInfo=function(e,t,i){var a,o,s,n,r;if(BoldBIDashboardDesigner.editManager.isPerformAction||(i.IsSelected=!0),0<this.dashboardDesigner.designerPanel.selectedReportItems.length)for(a=this.widgetHelper.getCurrentWidgetInstance().DataGroupInfo,o=0;o<a.FieldContainers.length;o++)if(t.ContainerName===a.FieldContainers[o].Name)for(s=0;s<a.FieldContainers[o].FieldInfos.length;s++)n=a.FieldContainers[o].FieldInfos[s],m.isNullOrUndefined(n.UniqueId)&&(n.UniqueId="LabelData"+(s+1)),n.UniqueId===t.UniqueId&&(r=[n.CustomSorting,t,i],BoldBIDashboardDesigner.editManager.addCmdAction(CommandAction.UpdateSort,"updateSortInfo","DataConfiguration","",r,[e,t,i]),n.CustomSorting=e,n.IsCustomSortApplied=t.IsCustomSortApplied);this.getDataConfigInstance().postDraggedFields()},e.FieldMenuHandler=t}(BoldBIDashboard=BoldBIDashboard||{}),InternalSqlEditor=function(){function e(e){this.value="",this.editorTag=null,this.indicesTag=null,this.bbdesigner$=e.bbdesigner$,this.id=e._id,this.manager=new SqlEditorUndoManager(e)}return e.prototype.renderQueryEditor=function(e){this.queryEditor=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_queryEditor"});var t=this.indicesTag=BoldBIDashboard.buildTag("div","",{height:"100%",width:"40px","text-align":"right","padding-top":"10px","background-color":"#ececec",overflow:"hidden",position:"absolute",display:"block"},{id:this.id+"_queryEditor_indices"}),i=this.editorTag=BoldBIDashboard.buildTag("div.bbi-designer-queryEditor","",{"padding-left":"15px","padding-top":"10px",height:"100%",width:"96.5%","margin-left":"40px","white-space":"pre",position:"absolute",overflow:"hidden",display:"block","border-color":"#cbcbcb","border-style":"solid","border-width":"0.4px","border-top-width":"0px"},{id:this.id+"_queryEditor_editor",contenteditable:"true"}),a=BoldBIDashboard.buildTag("div","1",{"padding-right":"4px"},{id:this.id+"_queryEditor_indices0"});t.append(a),i.bind("keydown",this.bbdesigner$.proxy(this.onEditorKeydown,this)),i.bind("scroll",this.bbdesigner$.proxy(this.scrollLeft,this)),i.bind("keypress",this.bbdesigner$.proxy(this.onEditorKeyPress,this)),i.bind("keyup",this.bbdesigner$.proxy(this.onEditorKeyUp,this)),this.queryEditor.append(t),this.queryEditor.append(i),e.append(this.queryEditor)},e.prototype.onEditorKeydown=function(e){this.updateIndices(),!e.ctrlKey||90!==e.keyCode&&89!==e.keyCode||(e.preventDefault(),e.stopPropagation())},e.prototype.onEditorKeyUp=function(e){var t,i,a,o,s,n,r,d,l,h,p,c,u;if(13===e.keyCode)for(y=t=0;y<this.editorTag[0].childNodes.length;y++)"p"===this.editorTag[0].childNodes[y].nodeName.substr(1).trim()&&(0===t||1===y?(i=this.editorTag[0].childNodes[y],a=document.createElement("div"),i.parentNode.replaceChild(a,i),a.innerHTML=""===i.textContent?"<br/>":i.textContent,t++):this.bbdesigner$(this.editorTag[0].childNodes[y]).remove());if(e.ctrlKey&&65!==e.keyCode&&67!==e.keyCode)if(u=e.keyCode||e.which,e.ctrlKey&&90===e.keyCode)this.manager.isUndo()&&this.manager.undo();else if(e.ctrlKey&&89===e.keyCode)this.manager.isRedo()&&this.manager.redo();else if(e.ctrlKey&&86===e.keyCode){"<br>"!==this.queryEditor.find("#"+this.id+"_queryEditor_editor")[0].innerHTML&&this.setQuery(this.queryEditor.find("#"+this.id+"_queryEditor_editor")[0].innerText),this.updateDivIndices();for(var b,g=this.queryEditor.find("#"+this.id+"_queryEditor_editor"),m=this.editorTag[0].children.length,f=[],D=0,y=0;y<m;y++)if(g[0].childNodes[y].children&&g[0].childNodes[y].children.length)for(n=0;n<g[0].childNodes[y].childNodes.length;n++)g[0].childNodes[y].childNodes[n].id&&(D=y,f.push(g[0].childNodes[y].childNodes[n]));for(o=0;o<f.length;o++)f[o].id=this.id+"_queryEditor_editor_childNode"+o;for(s=this.queryEditor.find("#"+this.id+"_queryEditor_editor"+D),n=0;n<f.length;n++)0===n?(b=f[0].innerHTML,b=g[0].childNodes[D].innerHTML+b,this.queryEditor.find("#"+this.id+"_queryEditor_editor"+D)[0].innerHTML=b):(this.bbdesigner$("#"+f[n].id).insertAfter(s),s=this.bbdesigner$("#"+f[n].id));for(this.updateDivIndices(),r=this.queryEditor.find("#"+this.id+"_queryEditor_editor"+D)[0],d=0;d<r.childNodes.length;d++)r.childNodes[d].id&&r.removeChild(r.childNodes[d])}else{for(l=this.editorTag,y=0;y<l[0].children.length;y++)"<br>"===l[0].children[y].innerHTML&&(l[0].children[y].innerHTML="");if(h=window.getSelection().anchorNode.parentNode,13!==u&&8!==u||" "!==window.getSelection().anchorNode.textContent)if(h.id&&h.id!==this.id+"_queryEditor_editor")if(p=h.children,h.id===this.id+"_queryEditor"&&2===p.length)for(c=0;c<p.length;c++)p[c].id===this.id+"_queryEditor_editor"&&this.updateText(p[c],e);else this.updateText(h,e);else this.updateText(h.parentNode,e)}if((65<=e.keyCode&&e.keyCode<=90||" "!==window.getSelection().anchorNode.textContent)&&!e.ctrlKey&&37!==e.keyCode&&38!==e.keyCode&&39!==e.keyCode&&40!==e.keyCode&&13!==e.keyCode&&16!==e.keyCode&&17!==e.keyCode)if((h=window.getSelection().anchorNode.parentNode).id&&h.id!==this.id+"_queryEditor_editor")if(p=h.children,h.id===this.id+"_queryEditor"&&2===p.length)for(c=0;c<p.length;c++)p[c].id===this.id+"_queryEditor_editor"&&this.updateText(p[c],e);else this.updateText(h,e);else this.updateText(h.parentNode,e);this.updateIndices(),e.ctrlKey&&90===e.keyCode&&this.manager.isUndo()||e.ctrlKey&&89===e.keyCode&&this.manager.isRedo()||(u=this.editorTag[0].innerHTML,this.value!==u&&(this.manager.addCmdAction("TextUndo",this.value,u),this.value=u))},e.prototype.updateIndices=function(){var e,t,i,a=this.editorTag[0].children.length;if(0<a)for(this.indicesTag.empty(),e=0;e<a;e++)t=e+1,(i=BoldBIDashboard.buildTag("div","",{"padding-right":"4px"},{})).attr({id:this.id+"_queryEditor_indices"+e}),this.indicesTag.append(i),this.queryEditor.find("#"+this.id+"_queryEditor_indices"+e).text(t.toString())},e.prototype.getQuery=function(){return this.editorTag[0].innerText.replace(/\r?\n/g,"\n")},e.prototype.setQuery=function(e){var t,i,a,o,s,n,r;if(this.manager.reset(),this.editorTag.empty(),this.indicesTag.empty(),this.indicesTag[0].children.length||(t=BoldBIDashboard.buildTag("div","1",{"padding-right":"4px"},{id:this.id+"_queryEditor_indices0"}),this.indicesTag.append(t)),0===e.length)this.editorTag[0].children.length||(o=BoldBIDashboard.buildTag("div.bbi-designer-queryEditor","",{},{id:this.id+"_queryEditor_editor0"}),this.editorTag.append(o),o[0].innerHTML="<br>",""===this.value&&(this.value=this.editorTag[0].innerHTML));else for(t=void 0,e?e=(e=(e=(e=e.replace(/<\/?span[^>]*>/g,"")).replace(/\r?\n/g,"\n")).replace(/</g,"&lt;")).replace(/>/g,"&gt;"):t=e="",i=""===(t=this.setKeyword(e))?[]:t.split("\n"),a=0;a<i.length;a++)r=this.indicesTag[0].children.length,(o=BoldBIDashboard.buildTag("div.bbi-designer-queryEditor","",{},{id:this.id+"_queryEditor_editor"+a})).attr("spellcheck","false"),n=BoldBIDashboard.buildTag("div","",{"padding-right":"4px"},{id:this.id+"_queryEditor_indices"+a}),this.editorTag[0].children.length<=r&&(s=this.queryEditor.find("#"+this.id+"_queryEditor_indices"+a)[0].innerHTML,s=parseInt(s,10)+1,o[0].innerHTML=i[a]||"<br/>",this.editorTag.append(o),s<=i.length&&(n.attr({id:this.id+"_queryEditor_indices"+r}),this.indicesTag.append(n),this.queryEditor.find("#"+this.id+"_queryEditor_indices"+r).text(s.toString())),(n=document.createRange()).setStart(o[0],o.length),(r=window.getSelection()).removeAllRanges(),r.addRange(n))},e.prototype.setHTML=function(e){this.editorTag[0].innerHTML=e,this.updateIndices()},e.prototype.scrollLeft=function(){var e=this.editorTag.scrollTop();this.indicesTag.scrollTop(e)},e.prototype.onEditorKeyPress=function(e){var t,i,a,o,s,n;if(13===(e.keyCode||e.which)){for(t=this.editorTag[0].children,i=0;i<t.length;i++)if(1<(a=t[i].childNodes).length)for(o=0;o<a.length;o++)a&&"br"===a[o].localName&&(s=a[o],(n=BoldBIDashboard.buildTag("div.bbi-designer-queryEditor","",{},{}))[0].innerHTML=""===s.textContent?"<br>":s.textContent,this.editorTag.append(n),n.insertAfter(s.parentNode),s.parentNode.removeChild(s));this.updateDivIndices(),this.updateIndices()}},e.prototype.updateDivIndices=function(){for(var e=this.editorTag[0].children,t=0;t<e.length;t++)e[t].id=this.id+"_queryEditor_editor"+t},e.prototype.updateText=function(e){var t=e,i=t.innerHTML,i=(e.id===this.id+"_queryEditor_editor"?this.setQuery("<br>"===i?"":i):e.innerHTML=this.setKeyword(i),document.createRange()),a=this.getCaretPosition(e),e=this.getChildElement(e,a);BoldBIDashboard.isNullOrUndefined(e)||"SPAN"===e.Element.nodeName||(i.setStart(e.Element,e.Position),(a=window.getSelection()).removeAllRanges(),a.addRange(i),t.focus())},e.prototype.getChildElement=function(e,t){for(var i,a=0,o=0;o<e.childNodes.length;o++){if(t<a+(i=e.childNodes[o].textContent.length))return{Element:e.childNodes[o],Position:t-a};a+=i}if(1===e.childNodes.length)return{Element:e.childNodes[0],Position:t}},e.prototype.getCaretPosition=function(e){var t,i,a=0,o=e.ownerDocument||e.document,s=o.defaultView||o.parentWindow;return void 0!==s.getSelection?0<(t=s.getSelection()).rangeCount&&((i=(s=s.getSelection().getRangeAt(0)).cloneRange()).selectNodeContents(e),i.setEnd(s.endContainer,s.endOffset),a=i.toString().length):t===o.selection&&"Control"!==t.type&&(s=t.createRange(),(i=o.body.createTextRange()).moveToElementText(e),i.setEndPoint("EndToEnd",s),a=i.text.length),a},e.prototype.setKeyword=function(i){return i=i.replace(/<\/?span[^>]*>/g,""),this.bbdesigner$.each(["ADD","EXCEPT","ALTER","EXEC","SELECT","PLAN","EXECUTE","PRECISION","AND","EXISTS","PRIMARY","AN","EXI","PRINT","AS","FETCH","PROC","ASC","FILE","PROCEDURE","AUTHORIZATION","FILLFACTOR","PUBLIC","BACKUP"," FOR","RAISERROR","BEGIN","FOREIGN","READ","BETWEEN","FREETEXT","READTEXT","BREAK","FREETEXTTABLE","RECONFIGURE","BROWSE,","FROM","REFERENCES","BULK","FULL","REPLICATION","BY","FUNCTION","RESTORE","CASCADE","GOTO","RESTRICT","CASE","GRANT","RETURN","CHECK","GROUP","REVOKE","CHECKPOINT","HAVING","RIGHT","CLOSE","HOLDLOCK","ROLLBACK","CLUSTERED","IDENTITY","ROWCOUNT","COALESCE","IDENTITY_INSERT","ROWGUIDCOL","LIKE","THEN","CURRENT_TIMESTAMP","LINENO","TO","CURRENT_USER","LOAD","TOP","CURSOR","NATIONAL","TRAN","DATABASE","NOCHECK","TRANSACTION","DBCC","NONCLUSTERED","TRIGGER","DEALLOCATE","NOT","TRUNCATE","DECLARE","NULL","TSEQUAL","DEFAULT","NULLIF","UNION","DELETE","OF","UNIQUE","DENY","OFF","UPDATE","DESC","OFFSETS","UPDATETEXT","DISK","ON","USE","DISTINCT","OPEN","USER","DISTRIBUTED","OPENDATASOURCE","VALUES","DOUBLE","OPENQUERY","VARYING","DROP","OPENROWSET","VIEW","DUMMY","OPENXML","WAITFOR","DUMP","OPTION","WHEN","ELSE","OR","WHERE","END","ORDER","WHILE","ERRLVL","OUTER","WITH","ESCAPE","OVER","WRITETEXT","ABSOLUTE","FOUND","PRESERVE","ACTION","FREE","PRIOR","ADMIN","GENERAL","PRIVILEGES","AFTER","GET","READS","AGGREGATE","GLOBAL","REAL","ALIAS","GO","RECURSIVE","ALLOCATE","GROUPING","REF","ARE","HOST","REFERENCING","ARRAY","HOUR","RELATIVE","ASSERTION","IGNORE","RESULT","AT","IMMEDIATE","RETURNS","BEFORE","INDICATOR","ROLE","BINARY","INITIALIZE","ROLLUP","BIT","INITIALLY","ROUTINE","BLOB","INOUT","ROW","BOOLEAN","INPUT","ROWS","BOTH","INT","SAVEPOINT","BREADTH","INTEGER","SCROLL","CALL","INTERVAL","SCOPE","CASCADED","ISOLATION","SEARCH","CAST","ITERATE","SECOND","CATALOG","LANGUAGE","SECTION","CHAR","LARGE","SEQUENCE","CHARACTER","LAST","SESSION","LATERAL","SETS","CLOB","LEADING","SIZE","COLLATION","LESS","SMALLINT","COMPLETION","LEVEL","SPACE","CONNECT","LIMIT","SPECIFIC","CONNECTION","LOCAL","SPECIFICTYPE","CONSTRAINTS","LOCALTIME","SQL","CONSTRUCTOR","LOCALTIMESTAMP","SQLEXCEPTION","CORRESPONDING","LOCATOR","SQLSTATE","CUBE","MAP","SQLWARNING","CURRENT_PATH","MATCH","START","CURRENT_ROLE","MINUTE","STATE","CYCLE","MODIFIES","STATEMENT","DATA","MODIFY","STATIC","DATE","MODULE","STRUCTURE","DAY","MONTH","TEMPORARY","DEC","NAMES","TERMINATE","DECIMAL","NATURAL","THAN","DEFERRABLE","NCHAR","TIME","DEFERRED","NCLOB","TIMESTAMP","DEPTH","NEW","TIMEZONE_HOUR","DEREF","NEXT","TIMEZONE_MINUTE","DESCRIBE","NO","TRAILING","DESCRIPTOR","NONE","TRANSLATION","DESTROY","NUMERIC","TREAT","DESTRUCTOR","OBJECT","TRUE","DETERMINISTIC","OLD","UNDER","DICTIONARY","ONLY","UNKNOWN","DIAGNOSTICS","OPERATION","UNNEST","DISCONNECT","ORDINALITY","USAGE","DOMAIN","OUT","USING","DYNAMIC","OUTPUT","VALUE","EACH","PAD","VARCHAR","END - EXEC","PARAMETER","VARIABLE","EQUALS","PARAMETERS","WHENEVER","EVERY","PARTIAL","WITHOUT","EXCEPTION","PATH","WORK","EXTERNAL","POSTFIX","WRITE","PREFIX","YEAR","FIRST","PREORDER","ZONE","FLOAT","PREPARE","ADA","AVG","BIT_LENGTH","CHAR_LENGTH","CHARACTER_LENGTH","COUNT","EXTRACT","FORTRAN","INCLUDE","INSENSITIVE","LOWER","MAX","MIN","OCTET_LENGTH","OVERLAPS","PASCAL","POSITION","SQLCA","SQLCODE","SQLERROR","SUBSTRING","SUM","TRANSLATE","TRIM","UPPER"],function(e,t){t=new RegExp("\\b("+t+")\\b","gi");i=i.replace(t,function(e){return'<span class="bbi-designer-queryEditor" style="color:blue;">'+e+"</span>"})}),i},e}(),SqlEditorUndoManager=function(){function e(e){this.stack=[],this.currentIndex=-1,this.stack=[],this.id=e._id,this.dashboardDesigner=e}return e.prototype.isUndo=function(){return 0<=this.currentIndex},e.prototype.undo=function(){var e;0<=this.currentIndex&&(e=this.stack[this.currentIndex],BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.sqlEditor,"setHTML",[e.oldVal]),this.currentIndex--)},e.prototype.isRedo=function(){return this.currentIndex<this.stack.length-1},e.prototype.redo=function(){this.currentIndex++;var e=this.stack[this.currentIndex];BoldBIDashboard.DashboardUtil.invokeMethod(this.dashboardDesigner.modules.sqlEditor,"setHTML",[e.newVal])},e.prototype.addCmdAction=function(e,t,i){this.stack.push({action:e,oldVal:t,newVal:i}),this.currentIndex++},e.prototype.reset=function(){this.currentIndex=-1,this.stack=[]},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.SqlEditor",InternalSqlEditor,window),InternalStoreParameter=function(){function e(e){this.dashboardDesigner=null,this.id=null,this.parameters=[],this.updatedParameters=[],this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.id=this.queryDesigner.id,this.renderStoreParameter()}return e.prototype.renderStoreParameter=function(){this.targetTag=BoldBIDashboard.buildTag("div.bbi-userselect","",{display:"block"},{title:"Parameters",id:this.id+"_parameter_dialog"});var e=BoldBIDashboard.buildTag("div","",{height:"280px",width:"100%",margin:"4px 0px"}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-store-connect-type-container","",{},{id:this.id+"_store_connect_type_container_div"}),i=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{border:"0.5px solid var(--primary-border-color)","border-radius":"2px",height:"280px",width:"100%","background-color":"transparent"},{id:this.id+"_topDiv_parameter_dialog"}),a=BoldBIDashboard.buildTag("div","",{},{}),o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{padding:"0px 8px"},{id:this.id+"_proc_parameters"}),s=BoldBIDashboard.buildTag("table.bbi-designer-exp-table bbi-dbrd-store-connect-type-table","",{},{id:this.id+"_store_connect_type_table"}),n=(t.append(s),n=BoldBIDashboard.buildTag("tr.bbi-dbrd-store-connect-type-table-row","",{}),r=BoldBIDashboard.buildTag("td.bbi-dbrd-store-connect-type-table-col","",{}),n.append(r),s.append(n),s=BoldBIDashboard.buildTag("div.bbi-dbrd-store-connect-type-table-radiobtndiv","",{},{id:this.id+"_store_connect_type_radiobtndiv"}),this.openQueryRadiobtn=BoldBIDashboard.buildTag("div.bbi-dbrd-store-connect-type-table-radiobtndiv-openquery","",{},{id:this.id+"_store_connect_type_radiobtndiv_openquery"}),this.internalCacheRadiobtn=BoldBIDashboard.buildTag("div.bbi-dbrd-store-connect-type-table-radiobtndiv-internalcache","",{},{id:this.id+"_store_connect_type_radiobtndiv_internalcache"}),s.append(this.openQueryRadiobtn,this.getOpenQueryInfoIcon(),this.internalCacheRadiobtn),r.append(s),a.append(o),i.append(a),e.append(i),this.targetTag.append(t,e),this.locale.dialogOptions),r=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",n.cancelButtonText,{float:"right"},{id:this.id+"_proc_btn_cancel",type:"button"}),s=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",n.okButtonText,{float:"right"},{id:this.id+"_proc_btn_save",type:"button"});this.targetTag.BoldBIDashboardDialog({minWidth:570,minHeight:230,height:"auto",width:"auto",target:"#"+this.id,enableResize:!1,containment:"#"+this.dashboardDesigner._id,showFooter:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",showOnInit:!1,enableModal:!0,close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.targetTag.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup "+this.id+"_designer_waiting_popup bbi-designer-loader",template:this.dashboardDesigner.getWaitingPopupTemplate()}),(o=this.dashboardDesigner.element.find("#"+this.id+"_parameter_dialog_foot")).append(r),o.append(s),s.on("click",this.bbdesigner$.proxy(this.doneProcDialog,this)),r.on("click",this.bbdesigner$.proxy(this.closeProcDialog,this)),i.BoldBIDashboardScroller({height:"280px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize})},e.prototype.getOpenQueryInfoIcon=function(){return"<div class ='bbi-dbrd-store-connect-type-table-help-info-icon'>"+(this.dashboardDesigner.isHelpLinkHidden()?"":"<a href='"+this.dashboardDesigner.getHelpDocLink("StoredProcedureOpenQuery")+"'  target='_blank' class ='bbi-dbrd-store-connect-type-table-info-icon bbi-dbrd-designer-icon bbi-dbrd-designer-hoverable' data-tooltip =\""+this.locale.storedProcedure.openQueryHelpInfo+'"></a>')+"</div>"},e.prototype.renderRadioItem=function(e,t,i,a,o){var s=BoldBIDashboard.buildTag("div","",{},{});a.append(s),a={callBackInstance:this,callBackMethod:"",groupName:i,labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:t,label:e,isChecked:o}]},this.selectRadioButton=new BoldBIDashboard.Dashboard.RadioButton(a,s)},e.prototype.closeProcDialog=function(){this.dashboardDesigner.element.find("#"+this.id+"_parameter_dialog").data("BoldBIDashboardDialog").close(),this.setParameter(this.updatedParameters)},e.prototype.doneProcDialog=function(){0<this.dashboardDesigner.element.find("#"+this.id+"_div_dragSurface .e-Stored.Procedures").length?this.queryDesigner.executeQuery():(this.queryDesigner.dragSurfaceTag.append(this.queryDesigner.tableContainer),this.queryDesigner.loadProcedureSchema())},e.prototype.isOpenQuery=function(){return(!BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_openquery_rdo_input"))||0<this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_openquery_rdo_input").length)&&this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_openquery_rdo_input").prop("checked")},e.prototype.hideStoreProcedureConnectTypes=function(){BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_container_div"))||"block"!==this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display")||this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display","none")},e.prototype.showStoreProcedureConnectTypes=function(){BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_container_div"))||"none"!==this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display")||this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display","block"),(!BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_internalcache_rdo_input"))||0<this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_internalcache_rdo_input").length)&&this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_internalcache_rdo_input").prop("checked",!0)},e.prototype.getProcParams=function(){var e,t,i,a=[];if(this.parameters&&(e=Object.keys(this.parameters),t=this.parameters[e],0<e.length)){for(i=0;i<t.length;i++){var o=t[i],s=o.Name.substring(1),n=this.bbdesigner$("#"+this.id+"_dropdown_"+s).val();switch(n){case"Custom":"bit"===t[i].DataType?a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).data("BoldBIDashboardCheckBox").isChecked()}):BoldBIDashboard.DashboardUtil.contains(o.DataType,"datetime",!0)?a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).data("BoldBIDashboardDateTimePicker").getValue()}):BoldBIDashboard.DashboardUtil.contains(o.DataType,"date",!0)?a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:this.bbdesigner$("#"+this.id+"_proc_"+s).data("BoldBIDashboardDatePicker").getValue()}):BoldBIDashboard.DashboardUtil.contains(o.DataType,"int",!0)||"numeric"===o.DataType?a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:parseInt(this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).val(),10)}):BoldBIDashboard.DashboardUtil.contains(o.DataType,"money",!0)||"float"===o.DataType||"decimal"===o.DataType?a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:parseFloat(this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).val())}):a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).val()});break;case"Parameter":a.push({Name:o.Name,IsNull:!1,DataType:o.DataType,ValueType:n,Value:"@{{:"+this.dashboardDesigner.element.find("#"+this.id+"_proc_"+s).val()+"}}"});break;case"Null":a.push({Name:o.Name,IsNull:!0,DataType:o.DataType,ValueType:n,Value:null})}}return a}return null},e.prototype.updateProceParams=function(e){var a=this;BoldBIDashboard.isNullOrUndefined(e)||e.filter(function(i){a.updatedParameters.filter(function(e){var t;i.Name===e.Name&&(t=e.Name.substring(1),e.Value=i.Value,e=BoldBIDashboard.isNullOrUndefined(a.id)?a.dashboardDesigner.modules.queryDesigner._id:a.id,a.dashboardDesigner.element.find("#"+e+"_proc_"+t).data("BoldBIDashboardDropDownList").setModel({dataSource:a.getParameterDataSource()}),a.dashboardDesigner.element.find("#"+e+"_proc_"+t).data("BoldBIDashboardDropDownList").selectItemByValue(i.Value.match("@{{:(.*)}}")[1]))})})},e.prototype.setParameter=function(o){var e,s,t;if(o&&0<o.length)for(e=function(t){var e,i=o[t].Name.substring(1),a=s.getParameterDataSource();switch(o[t].ValueType="Parameter"!==o[t].ValueType||0!==a.length&&0!==a.filter(function(e){return"@{{:"+e.value+"}}"===o[t].Value}).length?o[t].ValueType:"Custom",s.bbdesigner$("#"+s.id+"_dropdown_"+i).data("BoldBIDashboardDropDownList").selectItemByValue(o[t].ValueType),o[t].ValueType){case"Custom":e={id:s.id+"_proc_"+i,dataType:o[t].DataType},s.checkNullable(e,{isChecked:o[t].IsNull}),"bit"===o[t].DataType?s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).data("BoldBIDashboardCheckBox").setModel({checked:!0===o[t].Value}):BoldBIDashboard.DashboardUtil.contains(o[t].DataType,"int",!0)?s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).val(o[t].Value):BoldBIDashboard.DashboardUtil.contains(o[t].DataType,"datetime",!0)?s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).data("BoldBIDashboardDateTimePicker").setModel({value:o[t].Value}):BoldBIDashboard.DashboardUtil.contains(o[t].DataType,"date",!0)?s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).data("BoldBIDashboardDatePicker").setModel({value:o[t].Value}):s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).val(o[t].Value);break;case"Parameter":s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).data("BoldBIDashboardDropDownList").setModel({dataSource:a}),s.dashboardDesigner.element.find("#"+s.id+"_proc_"+i).data("BoldBIDashboardDropDownList").selectItemByValue(o[t].Value.match("@{{:(.*)}}")[1])}},s=this,t=0;t<o.length;t++)e(t)},e.prototype.renderElementsForCustomType=function(e,t,i){var a;"bit"===t?(a=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_proc_"+i}),e.append(a),a.BoldBIDashboardCheckBox({showRoundedCorner:!0,cssClass:"bbi-designer-border"})):BoldBIDashboard.DashboardUtil.contains(t,"int",!0)||BoldBIDashboard.DashboardUtil.contains("money",t,!0)||"float"===t||"numeric"===t||"decimal"===t?(a=BoldBIDashboard.buildTag("input.e-textbox e-animation bbi-designer-border","",{height:"25px",width:"147px","padding-left":"10px"},{type:"number",id:this.id+"_proc_"+i}),e.append(a)):BoldBIDashboard.DashboardUtil.contains(t,"datetime",!0)?(a=BoldBIDashboard.buildTag("input","",{"font-style":"normal"},{type:"text",id:this.id+"_proc_"+i}),e.append(a),a.BoldBIDashboardDateTimePicker({width:"100%",height:"30px",locale:this.dashboardDesigner.model.localeSettings.culture,dateTimeFormat:this.dashboardDesigner.model.localeSettings.dateFormat+" "+this.dashboardDesigner.model.localeSettings.timeFormat,cssClass:"bbi-designer-border e-dashboarddesigner-widget"})):BoldBIDashboard.DashboardUtil.contains(t,"date",!0)?(a=BoldBIDashboard.buildTag("input","",{"font-style":"normal"},{type:"text",id:this.id+"_proc_"+i}),e.append(a),a.BoldBIDashboardDatePicker({width:"100%",height:"30px",showRoundedCorner:!0,cssClass:"bbi-designer-border e-dbrd-designer-relative-picker e-dashboarddesigner-widget"})):(t=BoldBIDashboard.buildTag("input.e-textbox e-animation bbi-designer-border","",{height:"25px",width:"147px","padding-left":"10px"},{type:"text",id:this.id+"_proc_"+i}),e.append(t))},e.prototype.parameterChangeEvent=function(t,e){var i=this.getProcParams().filter(function(e){return e.Name===t})[0];this.dashboardDesigner.modules.util.doAjaxPost("POST",this.queryDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.ParameterAction,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.ParameterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.ValidateDynamicParameter,parameters:i,dataSetId:e.model.dataSource[e.itemId].id,dataSetName:e.model.dataSource[e.itemId].dsName,selectedText:e.model.dataSource[e.itemId].name,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.validateParameter,this,e)})},e.prototype.validateParameter=function(e,t){BoldBIDashboard.isNullOrUndefined(t)||JSON.parse(t.data)||(this.bbdesigner$(e.target).data("BoldBIDashboardDropDownList").clearText(),this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.StoredProcedure,this.locale.dataSource.InValidParameter,IconType.warning,AlertType.Alert,!1,null))},e.prototype.renderValueContainer=function(e,t){if(!BoldBIDashboard.isNullOrUndefined(e.column))switch(0<e.column.children().length&&e.column.children().remove(),t){case"Custom":this.renderElementsForCustomType(e.column,e.dataType,e.id);break;case"Parameter":this.renderElementForParameterType(e);break;case"Null":var i=BoldBIDashboard.buildTag("input.e-textbox","",{height:"25px",width:"147px","padding-left":"10px"},{type:"text",value:"null",id:this.id+"_proc_"+e.id,disabled:"disabled"});e.column.append(i)}},e.prototype.renderElementForParameterType=function(e){var t=BoldBIDashboard.buildTag("input.e-textbox","",{height:"30px",width:"160px"},{type:"text",id:this.id+"_proc_"+e.id});e.column.append(t),t.BoldBIDashboardDropDownList({width:"100%",height:"30px",popupWidth:t.width(),field:{text:"text",value:"value",name:"name",id:"id"},dataSource:this.getParameterDataSource(),enabled:!0,selectedIndex:null,showRoundedCorner:!0,cssClass:"bbi-dbrd-control",change:this.bbdesigner$.proxy(this.parameterChangeEvent,this,e.name)})},e.prototype.onDropDownChange=function(e,t){BoldBIDashboard.isNullOrUndefined(t)||this.renderValueContainer(e,t.selectedText)},e.prototype.getParameterDataSource=function(){var o,s,n=this,e=this.bbdesigner$.extend(!0,{},this.queryDesigner.dataset),t=(e.Query.DashboardParameters=this.queryDesigner.queryParamCollection,[]),r=[];return t.push(e),0<this.dashboardDesigner.rdlParser.rdlJsonObj.DataSets.length&&this.dashboardDesigner.rdlParser.rdlJsonObj.DataSets.forEach(function(e){e.Id!==t[0].Id&&t.push(n.bbdesigner$.extend(!0,{},e))}),t.forEach(function(e){BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.Query)||BoldBIDashboard.isNullOrUndefined(e.Query.DashboardParameters)||(o=e.Id===n.queryDesigner.dataset.Id,e.Query.DashboardParameters=o?n.queryDesigner.queryParamCollection:e.Query.DashboardParameters,s=e.Name,e.Query.DashboardParameters.forEach(function(e){var t,i,a=e.ParameterName;switch(e.Mode){case ParameterMode.Literal:i=e.LiteralModeInfo,!BoldBIDashboard.isNullOrUndefined(i.StartValue)&&!BoldBIDashboard.isNullOrUndefined(i.EndValue)||!BoldBIDashboard.isNullOrUndefined(i.RangeStartDate)&&!BoldBIDashboard.isNullOrUndefined(i.RangeEndDate)||!BoldBIDashboard.isNullOrUndefined(i.RelativeDateItems)?(i=a+".END",r.push(n.getParamItems(t=a+".START",o?t:t+" ("+s+")",o?t:s+"."+t,e.DatasourceId,e.DatasourceName,e.DateFormat,e.DataType,e.ParameterID)),r.push(n.getParamItems(a+".END",o?i:i+" ("+s+")",o?i:s+"."+i,e.DatasourceId,e.DatasourceName,e.DateFormat,e.DataType,e.ParameterID))):r.push(n.getParamItems(a,o?a:a+" ("+s+")",o?a:s+"."+a,e.DatasourceId,e.DatasourceName,e.DateFormat,e.DataType,e.ParameterID));break;case ParameterMode.List:!BoldBIDashboard.isNullOrUndefined(e.ListModeInfo.DataColumn)&&0===e.ListModeInfo.DataColumn.FieldFrom&&!0==o||r.push(n.getParamItems(a,o?a:a+" ("+s+")",o?a:s+"."+a,e.DatasourceId,e.DatasourceName,e.DateFormat,e.DataType,e.ParameterID))}}))}),r},e.prototype.getParamItems=function(e,t,i,a,o,s,n,r){return{text:t,name:e,value:i,id:a,dsName:o,dateFormat:s,dataType:n,parameterID:r}},e.prototype.renderParameter=function(e,t,i){var a=e.Name.substring(1),o=BoldBIDashboard.buildTag("tr","",{height:"36px"}),s=BoldBIDashboard.buildTag("td",e.Name,{height:"30px",width:"150px"}),n=BoldBIDashboard.buildTag("td",e.DataType,{height:"30px",width:"100px"}),r=BoldBIDashboard.buildTag("td","",{height:"30px",width:"160px"}),d=BoldBIDashboard.buildTag("td","",{height:"30px",width:"160px"}),l=BoldBIDashboard.buildTag("input.e-textbox","",{},{type:"text",id:this.id+"_dropdown_"+a});o.append(s).append(n).append(r).append(d),t.append(o),r.append(l),s={column:d,dataType:e.DataType,id:a,name:e.Name},l.BoldBIDashboardDropDownList({width:"150px",height:"30px",popupWidth:"150px",dataSource:[{text:"Custom"},{text:"Parameter"},{text:"Null"}],fields:{text:"text",value:"value"},enabled:!0,change:this.bbdesigner$.proxy(this.onDropDownChange,this,s),selectedIndex:0,showRoundedCorner:!0,cssClass:"bbi-dbrd-control"}),this.renderValueContainer(s,BoldBIDashboard.isNullOrUndefined(i)?l.val():i)},e.prototype.renderProcParameters=function(e){var t,i,a,o=this.dashboardDesigner.element.find("#"+this.id+"_proc_parameters"),s=(o.empty(),BoldBIDashboard.buildTag("tr")),n=BoldBIDashboard.buildTag("td","<b>Parameter</b>",{height:"30px",width:"150px"}),r=BoldBIDashboard.buildTag("td","<b>DataType</b>",{height:"30px",width:"100px"}),d=BoldBIDashboard.buildTag("td","<b>Value Type</b>",{height:"30px",width:"100px"}),l=BoldBIDashboard.buildTag("td","<b>Value</b>",{height:"30px",width:"150px"}),h=null;if(0<this.queryDesigner.columnList.length)for(a=0;a<this.queryDesigner.columnList.length;a++)if(this.queryDesigner.tableList[a]===e.id){h=this.queryDesigner.columnList[a];break}if((BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_openquery_rdo_input"))&&BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_internalcache_rdo_input"))||0===this.targetTag.find("#"+this.id+"_store_connect_type_radiobtn_openquery_rdo_input").length)&&(this.renderRadioItem(this.locale.storedProcedure.openQuery,this.id+"_store_connect_type_radiobtn_openquery","connecttype",this.openQueryRadiobtn,!1),this.renderRadioItem(this.locale.storedProcedure.internalCache,this.id+"_store_connect_type_radiobtn_internalcache","connecttype",this.internalCacheRadiobtn,!0)),i=h[t=Object.keys(h)],0<t.length&&0<h[t].length){for(this.parameters=h,s.append(n).append(r).append(d).append(l),o.append(s),a=0;a<i.length;a++)this.renderParameter(i[a],o);return!0}return this.parameters=null,!1},e.prototype.checkNullable=function(e,t){"bit"===e.dataType?t.isChecked?this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardCheckBox").disable():this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardCheckBox").enable():BoldBIDashboard.DashboardUtil.contains(e.dataType,"datetime",!0)?t.isChecked?this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardDateTimePicker").disable():this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardDateTimePicker").enable():BoldBIDashboard.DashboardUtil.contains(e.dataType,"date",!0)?t.isChecked?this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardDatePicker").disable():this.dashboardDesigner.element.find("#"+e.id).data("BoldBIDashboardDatePicker").enable():t.isChecked?(this.dashboardDesigner.element.find("#"+e.id).attr("disabled","disabled"),this.dashboardDesigner.element.find("#"+e.id).val(""),this.dashboardDesigner.element.find("#"+e.id).val("null")):(this.dashboardDesigner.element.find("#"+e.id).removeAttr("disabled"),this.dashboardDesigner.element.find("#"+e.id).val(""))},e.prototype.showParameterDialog=function(){this.setParameter(this.updatedParameters),this.dashboardDesigner.element.find("#"+this.id+"_parameter_dialog").data("BoldBIDashboardDialog").open(),this.targetTag.find("#"+this.id+"_topDiv_parameter_dialog").height()>this.dashboardDesigner.element.find("#"+this.id+"_proc_parameters").height()?this.dashboardDesigner.element.find("#"+this.id+"_proc_parameters").css("padding","0px 12px"):this.dashboardDesigner.element.find("#"+this.id+"_proc_parameters").css("padding","0px 8px"),null!==this.targetTag.find("#"+this.id+"_topDiv_parameter_dialog").data("BoldBIDashboardScroller")&&this.targetTag.find("#"+this.id+"_topDiv_parameter_dialog").data("BoldBIDashboardScroller").refresh(),BoldBIDashboard.isNullOrUndefined(this.targetTag.find("#"+this.id+"_store_connect_type_container_div"))||"none"!==this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display")||this.targetTag.find("#"+this.id+"_store_connect_type_container_div").css("display","block")},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.StoreParameter",InternalStoreParameter,window),ParameterDataInfo=function(){},function(e){e[e.None=0]="None",e[e.Google=1]="Google",e[e.Facebook=2]="Facebook",e[e.Twitter=3]="Twitter",e[e.Salesforce=4]="Salesforce",e[e.Smartsheet=5]="Smartsheet",e[e.Bitly=6]="Bitly",e[e.Asana=7]="Asana",e[e.Slack=8]="Slack",e[e.ZohoCRM=9]="ZohoCRM",e[e.Buffer=10]="Buffer",e[e.Todoist=11]="Todoist",e[e.MicrosoftDynamicsCRM=12]="MicrosoftDynamicsCRM",e[e.QuickBooks=13]="QuickBooks",e[e.BaseCrm=14]="BaseCrm",e[e.Basecamp3=15]="Basecamp3",e[e.Intercom=16]="Intercom",e[e.Optimizely=17]="Optimizely",e[e.Pipedrive=18]="Pipedrive",e[e.Pinterest=19]="Pinterest",e[e.LinkedIn=20]="LinkedIn",e[e.Microsoft=21]="Microsoft",e[e.SurveyMonkey=22]="SurveyMonkey",e[e.HelpScout=23]="HelpScout",e[e.FreshBooks=24]="FreshBooks",e[e.Basecamp2=25]="Basecamp2",e[e.Infusionsoft=26]="Infusionsoft",e[e.Box=27]="Box",e[e.EventBrite=28]="EventBrite",e[e.GenesysPureCloud=29]="GenesysPureCloud",e[e.Dropbox=30]="Dropbox",e[e.AzureDevOps=31]="AzureDevOps",e[e.WordPress=32]="WordPress",e[e.Projectplace=33]="Projectplace",e[e.Podio=34]="Podio",e[e.Vimeo=35]="Vimeo",e[e.MicrosoftKaizala=36]="MicrosoftKaizala",e[e.Wistia=37]="Wistia",e[e.ApplicationInsights=38]="ApplicationInsights",e[e.MarkupTrace=39]="MarkupTrace",e[e.Xero=40]="Xero",e[e.Zoom=41]="Zoom",e[e.Fitbit=42]="Fitbit",e[e.DecisionLens=43]="DecisionLens",e[e.XeroWorkflowMax=44]="XeroWorkflowMax",e[e.Gohighlevel=45]="Gohighlevel"}(OAuthProvider=OAuthProvider||{}),InternalOAuthLoginHelper=function(){function e(e){this.oAuthModel=null,this.designerInstance=e,this.bbdesigner$=this.designerInstance.bbdesigner$,this.id=this.designerInstance._id+"_oauth_config"}return e.prototype.initialize=function(e,t){this.bbdesigner$(window).off("message",this.bbdesigner$.proxy(this.notifyOAuthStatus,this)),this.bbdesigner$(window).on("message",this.bbdesigner$.proxy(this.notifyOAuthStatus,this)),this.isWindowPresent()&&this.closeOAuthWindow(),this.oAuthModel=e,this.launchWindow(t)},e.prototype.launchWindow=function(e){var t,i=this;this.isWindowPresent()&&this.closeOAuthWindow(),t=BoldBIDashboard.isNullOrUndefined(e.id)?this.getConnectUrl():this.getReAuthUrl(e),BoldBIDashboard.isNullOrUndefined(e.organizationUrl)||(t+="&resourceurl="+e.organizationUrl),this.oAuthWindow=window.open(t,"OAuthPopUp","width=600,height=800,scrollbars=yes"),BoldBIDashboard.isNullOrUndefined(this.oAuthModel.windowCloseHandler)||(this.timer=setInterval(this.bbdesigner$.proxy(function(){i.isWindowPresent()||i.notifyChildWindowClose()},this),2e3))},e.prototype.notifyChildWindowClose=function(){clearInterval(this.timer),BoldBIDashboard.isNullOrUndefined(this.oAuthModel.windowCloseHandler)||BoldBIDashboard.DashboardUtil.invokeCallBack(this.oAuthModel.windowCloseHandler,{})},e.prototype.getReAuthUrl=function(e){var t=this.designerInstance.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.oauthreauthorize+"?";return this.designerInstance.model.serviceAuthorizationToken&&(t+="token="+this.designerInstance.model.serviceAuthorizationToken),BoldBIDashboard.isNullOrUndefined(e.id)||(t+="&id="+e.id),BoldBIDashboard.isNullOrUndefined(this.designerInstance.model.serverUrl)||(t+="&server="+this.designerInstance.model.serverUrl),this.oAuthModel.serviceId&&(t+="&service="+this.oAuthModel.serviceId),t+("&origin="+window.location.origin)},e.prototype.getConnectUrl=function(){var e=this.designerInstance.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.oauthauthenticate+"?";return this.oAuthModel.provider&&(e+="provider="+BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(OAuthProvider,this.oAuthModel.provider)),this.oAuthModel.serviceId&&(e+="&service="+this.oAuthModel.serviceId),this.designerInstance.model.serviceAuthorizationToken&&(e+="&token="+this.designerInstance.model.serviceAuthorizationToken),e+="&origin="+window.location.origin,BoldBIDashboard.isNullOrUndefined(this.designerInstance.model.serverUrl)||(e+="&server="+this.designerInstance.model.serverUrl),e},e.prototype.closeOAuthWindow=function(){this.windowCheckInterval&&(clearInterval(this.windowCheckInterval),this.windowCheckInterval=null),this.oAuthWindow&&!this.oAuthWindow.closed&&this.oAuthWindow.close()},e.prototype.isWindowPresent=function(){return this.oAuthWindow&&!this.oAuthWindow.closed},e.prototype.notifyOAuthStatus=function(e){this.bbdesigner$(window).off("message",this.bbdesigner$.proxy(this.notifyOAuthStatus,this)),this.notifyChildWindowClose(),this.oAuthModel.handler&&BoldBIDashboard.DashboardUtil.invokeCallBack(this.oAuthModel.handler,JSON.parse(e.originalEvent.data))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.OAuthHelper",InternalOAuthLoginHelper,window),InternalRangeFilterDialog=function(){function e(e){this.dashboardDesigner=null,this.dialogContainer=null,this.isModified=!1,this.filterInfo=null,this.fieldDetails=null,this.loadTimer=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.rowId=this.id+"_range_filter_dialog",this.dateFormat=this.dashboardDesigner.model.localeSettings.dateFormat+" "+this.dashboardDesigner.model.localeSettings.timeFormat,this.renderRangeFilterDialog()}return e.prototype.renderRangeFilterDialog=function(){this.dialogContainer=BoldBIDashboard.buildTag("div.bbi-dashboard-designer-configuration bbi-userselect","",{height:"auto"},{title:this.locale.dateRangeFilterDialog.titleText,id:this.rowId}),this.dashboardDesigner.element.append(this.dialogContainer),this.renderTopContainer(),this.renderFieldContainer(),this.dialogContainer.BoldBIDashboardDialog({width:"auto",height:"auto",minWidth:400,minHeight:235,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"boldbi-dashboarddesigner bbi-designer-dialog e-flat-mode",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.renderFooter()},e.prototype.renderTopContainer=function(){var e=BoldBIDashboard.buildTag("div","",{height:"25px","border-bottom":"1px solid var(--primary-border-color)",padding:"15px 20px"}),t=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),i=BoldBIDashboard.buildTag("tr","",{},{}),a=this.locale.dateRangeFilterDialog;this.renderRadioButton(a.rangesText,this.rowId+"_RangeBtn",!0,i,this.onRangeTypeChange,this),this.renderRadioButton(a.startDateText,this.rowId+"_startBtn",!1,i,this.onRangeTypeChange,this),this.renderRadioButton(a.endDateText,this.rowId+"_endBtn",!1,i,this.onRangeTypeChange,this),t.append(i),e.append(t),this.dialogContainer.append(e)},e.prototype.renderFieldContainer=function(){var e=BoldBIDashboard.buildTag("div","",{height:"140px","background-color":"var(--secondary-background-color)","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box",padding:"10px 20px"},{id:this.rowId+"_dateRange_fieldDiv"}),t=BoldBIDashboard.buildTag("div","",{"margin-top":"15px"},{id:this.rowId+"_dateRange_start_tr"}),i=BoldBIDashboard.buildTag("div","",{"margin-top":"15px"},{id:this.rowId+"_dateRange_end_tr"}),a=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),o=BoldBIDashboard.buildTag("table","",{width:"100%"},{}),s=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("tr","",{},{});e.append(t,i),t.append(a),a.append(s),i.append(o),o.append(n),t=this.locale.dateRangeFilterDialog,this.renderDateRangePicker(this.rowId+"_dateRange_Start",t.startLabel,s,this.onPickerChange,this),this.renderDateRangePicker(this.rowId+"_dateRange_end",t.endLabel,n,this.onPickerChange,this),this.dialogContainer.append(e),e.BoldBIDashboardWaitingPopup({showOnInit:!1,cssClass:"e-designer-waitingpopup bbi-propertyPanel-waitingPopup",template:this.dashboardDesigner.getWaitingPopupTemplate()})},e.prototype.renderFooter=function(){var e=this.dashboardDesigner.element.find("#"+this.rowId+"_foot"),t=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.rowId+"_btn_cancel",type:"button"}),i=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.rowId+"_btn_ok",type:"button"});e.append(t,i),i.on("click",this.bbdesigner$.proxy(this.saveDateRangeAttr,this)),t.on("click",this.bbdesigner$.proxy(this.closeDialog,this,!0))},e.prototype.renderRadioButton=function(e,t,i,a,o,s){var n=this.bbdesigner$("<td unselectable='on'/>");a.append(n),a=BoldBIDashboard.buildTag("div","",{},{}),s={callBackInstance:this,callBackMethod:"onRangeTypeChange",optionalArgs:s,groupName:"formatting",labelPosition:BoldBIDashboard.Dashboard.LabelPosition.After,dataSource:[{id:t,label:e,isChecked:i}]},this.selectRadioButton=new BoldBIDashboard.Dashboard.RadioButton(s,a),n.append(a)},e.prototype.renderDateRangePicker=function(e,t,i,a,o){var s=BoldBIDashboard.buildTag("td","",{width:"25%"}),t=BoldBIDashboard.buildTag("Label.bbi-designer-add-label",t,{},{type:"label"}),n=BoldBIDashboard.buildTag("td","",{},{id:e}),e=BoldBIDashboard.buildTag("input.bbi-popup-button","",{},{type:"text",id:e+"_picker"});s.append(t),n.append(e),i.append(s,n),e.BoldBIDashboardDateTimePicker({width:"225px",height:"26px",cssClass:"bbi-designer-border bbi-popup-button e-dashboarddesigner-widget",change:this.bbdesigner$.proxy(a,o)}),e.on("keyup",this.bbdesigner$.proxy(this.onPickerChange,this))},e.prototype.openFilterDialog=function(e,t,i,a){var o,s,n=this;this.dialogContainer.data("BoldBIDashboardDialog").open(),this.targetInstance=e,this.targetMethod=t,this.fieldDetails=i,this.dataSetId=this.fieldDetails.DatasourceID,this.filterInfo=BoldBIDashboard.isNullOrUndefined(a)?new DimensionFilterInfo:this.bbdesigner$.extend(!0,{},a),this.resetRadioBtnSelection(),this.resetAttributes(),this.getStartTr().css("display","none"),this.getEndTr().css("display","none"),o=[{Id:this.fieldDetails.Id,Name:this.fieldDetails.Name,SummaryType:SummaryType.NONE,Sorting:"Ascending",FieldType:"Dimensions",MeasureFormatting:null,DateTimeFormat:"Date",FilterInfo:null}],this.loadTimer&&(clearTimeout(this.loadTimer),this.loadTimer=null),(s=this).loadTimer=setTimeout(this.bbdesigner$.proxy(function(){s.showLoadingIndicator(),n.dashboardDesigner.modules.util.doAjaxPost("POST",s.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,fieldInfo:o,dataSetId:s.dataSetId,type:"date",isQueryDesignerMode:n.dashboardDesigner.isQueryDesignerMode})},{fnction:n.bbdesigner$.proxy(s.setFieldInformation,s)}),clearTimeout(s.loadTimer),s.loadTimer=null},this),300),BoldBIDashboard.DashboardUtil.buttonEnable(this.getApplyBtn(),!0)},e.prototype.resetAttributes=function(){this.dialogContainer.removeAttr("Range"),this.dialogContainer.removeAttr("StartDate"),this.dialogContainer.removeAttr("EndDate"),this.getStartPicker().removeAttr("minDateTime"),this.getEndPicker().removeAttr("minDateTime")},e.prototype.setFieldInformation=function(e){var t,i=this.dashboardDesigner.element.find("#"+this.rowId+"_dateRange_Start_picker"),a=this.dashboardDesigner.element.find("#"+this.rowId+"_dateRange_end_picker");BoldBIDashboard.isNullOrUndefined(i.data("BoldBIDashboardDateTimePicker").model)||(i.data("BoldBIDashboardDateTimePicker").model.dateTimeFormat=this.dateFormat,a.data("BoldBIDashboardDateTimePicker").model.dateTimeFormat=this.dateFormat),t=BoldBIDashboard.format(new Date(e.MinValue),this.dateFormat),e=BoldBIDashboard.format(new Date(e.MaxValue),this.dateFormat),i.attr({minDateTime:t,maxDateTime:e}),a.attr({minDateTime:t,maxDateTime:e}),i.data("BoldBIDashboardDateTimePicker").setModel({minDateTime:t,maxDateTime:e,value:t}),a.data("BoldBIDashboardDateTimePicker").setModel({minDateTime:t,maxDateTime:e,value:e}),this.getStartTr().css("display","block"),this.getEndTr().css("display","block"),this.hideLoadingIndicator(),BoldBIDashboard.isNullOrUndefined(this.filterInfo)||BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo)||BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo.DateFilterInfo)||this.populateDateRangeFilter(this.filterInfo.AllowFilterInfo.DateFilterInfo)},e.prototype.showLoadingIndicator=function(){this.getFieldDiv().BoldBIDashboardWaitingPopup("show"),this.getRangeRadioBtn().prop("disabled",!0),this.getStartRadioBtn().prop("disabled",!0),this.getEndRadioBtn().prop("disabled",!0)},e.prototype.hideLoadingIndicator=function(){this.getRangeRadioBtn().prop("disabled",!1),this.getStartRadioBtn().prop("disabled",!1),this.getEndRadioBtn().prop("disabled",!1),this.getFieldDiv().BoldBIDashboardWaitingPopup("hide")},e.prototype.populateDateRangeFilter=function(e){this.isModified=!1,this.dialogContainer.attr({StartDate:e.StartDate,EndDate:e.EndDate,Range:e.DateFormatCondition});var t=e.DateFormatCondition,i=this.getRangeRadioBtn(),a=this.getStartRadioBtn(),o=this.getEndRadioBtn(),s="block",n="block";t===DateFormatOption.StartDate.toString()?(i.prop("checked",!1),a.prop("checked",!0),o.prop("checked",!1),n="none",s="block"):t===DateFormatOption.EndDate.toString()?(i.prop("checked",!1),a.prop("checked",!1),o.prop("checked",!0),n="block",s="none"):this.resetRadioBtnSelection(),this.getStartTr().css("display",s),this.getEndTr().css("display",n),this.getStartPicker().data("BoldBIDashboardDateTimePicker").setModel({value:e.StartDate}),this.getEndPicker().data("BoldBIDashboardDateTimePicker").setModel({value:e.EndDate})},e.prototype.resetRadioBtnSelection=function(){var e=this.getRangeRadioBtn(),t=this.getStartRadioBtn(),i=this.getEndRadioBtn();e.prop("checked",!0),t.prop("checked",!1),i.prop("checked",!1)},e.prototype.onRangeTypeChange=function(e){var t=this.getStartRadioBtn().prop("checked"),i=this.getEndRadioBtn().prop("checked"),a=this.getStartTr(),o=this.getEndTr();"change"===e.args.event.type&&(t?(a.css("display","block"),o.css("display","none")):(i?a.css("display","none"):a.css("display","block"),o.css({display:"block"}))),this.enableApplyButton()},e.prototype.onPickerChange=function(e){(e.isInteraction||!BoldBIDashboard.isNullOrUndefined(e.currentTarget)&&""==this.bbdesigner$(e.currentTarget).val())&&this.enableApplyButton()},e.prototype.saveDateRangeAttr=function(){var e,t,i,a;BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(e=this.getStartRadioBtn().prop("checked"),t=this.getEndRadioBtn().prop("checked"),i=this.getStartPicker().data("BoldBIDashboardDateTimePicker").getValue(),a=this.getEndPicker().data("BoldBIDashboardDateTimePicker").getValue(),this.isModified=this.validateDateRangeValues(),this.dialogContainer.attr({StartDate:i,EndDate:a}),t?this.dialogContainer.attr("Range",DateFormatOption.EndDate.toString()):e?this.dialogContainer.attr("Range",DateFormatOption.StartDate.toString()):this.dialogContainer.attr("Range",DateFormatOption.Range.toString()),i=this.getDateRangeValues(),this.filterInfo=new DimensionFilterInfo,this.filterInfo.IsAllowFilteringApplied=!0,BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo)&&(this.filterInfo.AllowFilterInfo=new AllowFilteringInfo),this.filterInfo.AllowFilterInfo.IsDateFormatFilteringApplied=!0,this.filterInfo.AllowFilterInfo.DateFilterInfo=new DateRangeFilterInfo,this.filterInfo.AllowFilterInfo.DateFilterInfo.DateFormatCondition=i.DateFormatCondition,this.filterInfo.AllowFilterInfo.DateFilterInfo.StartDate=i.StartDate,this.filterInfo.AllowFilterInfo.DateFilterInfo.EndDate=i.EndDate,a=[this.filterInfo,this.fieldDetails],BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,a)),this.closeDialog()},e.prototype.closeDialog=function(){var e=this.getStartPicker().data("BoldBIDashboardDateTimePicker"),t=this.getEndPicker().data("BoldBIDashboardDateTimePicker");!BoldBIDashboard.isNullOrUndefined(e)&&e.isPopupOpen?e.hide():!BoldBIDashboard.isNullOrUndefined(t)&&t.isPopupOpen&&t.hide(),this.dialogContainer.data("BoldBIDashboardDialog").close()},e.prototype.validateDateRangeValues=function(){var e=this.getStartPicker().data("BoldBIDashboardDateTimePicker").getValue(),t=this.getEndPicker().data("BoldBIDashboardDateTimePicker").getValue(),i=BoldBIDashboard.isNullOrUndefined(this.filterInfo)||BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo)||BoldBIDashboard.isNullOrUndefined(this.filterInfo.AllowFilterInfo.DateFilterInfo)?DateFormatOption.Range:this.filterInfo.AllowFilterInfo.DateFilterInfo.DateFormatCondition;return this.dialogContainer.attr("StartDate")!==e||this.dialogContainer.attr("EndDate")!==t||this.dialogContainer.attr("Range")!==i.toString()},e.prototype.getDateRangeValues=function(){var e=BoldBIDashboard.isNullOrUndefined(this.dialogContainer.attr("Range"))?DateFormatOption.Range.toString():this.dialogContainer.attr("Range"),e=(e===DateFormatOption.StartDate.toString()?DateFormatOption.StartDate:e===DateFormatOption.EndDate.toString()?DateFormatOption.EndDate:DateFormatOption.Range).toString();return{StartDate:BoldBIDashboard.isNullOrUndefined(this.dialogContainer.attr("StartDate"))?"":this.dialogContainer.attr("StartDate"),EndDate:BoldBIDashboard.isNullOrUndefined(this.dialogContainer.attr("EndDate"))?"":this.dialogContainer.attr("EndDate"),DateFormatCondition:e,IsModified:this.isModified}},e.prototype.enableApplyButton=function(){var e=this.dialogContainer.find("#"+this.rowId+"_dateRange_Start_picker").val(),t=this.dialogContainer.find("#"+this.rowId+"_dateRange_end_picker").val(),i=this.getApplyBtn(),a=this.getStartRadioBtn().prop("checked"),o=this.getEndRadioBtn().prop("checked"),a=a&&!BoldBIDashboard.isNullOrUndefined(e)&&""!==e||o&&!BoldBIDashboard.isNullOrUndefined(t)&&""!==t||!BoldBIDashboard.isNullOrUndefined(e)&&""!==e&&!BoldBIDashboard.isNullOrUndefined(t)&&""!==t;BoldBIDashboard.DashboardUtil.buttonEnable(i,a)},e.prototype.getRangeRadioBtn=function(){return this.dialogContainer.find("#"+this.rowId+"_RangeBtn_rdo_input")},e.prototype.getStartRadioBtn=function(){return this.dialogContainer.find("#"+this.rowId+"_startBtn_rdo_input")},e.prototype.getEndRadioBtn=function(){return this.dialogContainer.find("#"+this.rowId+"_endBtn_rdo_input")},e.prototype.getStartPicker=function(){return this.dialogContainer.find("#"+this.rowId+"_dateRange_Start_picker")},e.prototype.getEndPicker=function(){return this.dialogContainer.find("#"+this.rowId+"_dateRange_end_picker")},e.prototype.getStartTr=function(){return this.dialogContainer.find("#"+this.rowId+"_dateRange_start_tr")},e.prototype.getEndTr=function(){return this.dialogContainer.find("#"+this.rowId+"_dateRange_end_tr")},e.prototype.getApplyBtn=function(){return this.dashboardDesigner.element.find("#"+this.rowId+"_btn_ok")},e.prototype.getFieldDiv=function(){return this.dialogContainer.find("#"+this.rowId+"_dateRange_fieldDiv")},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dialogContainer),0<this.dialogContainer.length&&this.dashboardDesigner.element.find("#"+this.rowId).remove()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RangeFilterDialog",InternalRangeFilterDialog,window),InternalRelativeDateFilter=function(){function e(e){this.dashboardDesigner=null,this.dateFilterDialog=null,this.footerTag=null,this.formatDropdown=null,this.periodDropdown=null,this.rangeNumeric=null,this.textDiv=null,this.rangeFormat=null,this.previewTag=null,this.linkDate=null,this.IncludeCurrent=null,this.anchorDate=null,this.targetInstance=null,this.targetMethod=null,this.dateFilterInfo=null,this.userFilterInfo=null,this.columnDetails=null,this.menuInfo=null,this.endDate=null,this.startDate=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id,this.dateFormat=this.dashboardDesigner.model.localeSettings.dateFormat,this.timeFormat=this.dashboardDesigner.model.localeSettings.timeFormat,this.renderRelativeDateFilterWindow()}return e.prototype.renderRelativeDateFilterWindow=function(){var e=this.dateFilterDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.id+"_relative_date_filter"}),t=BoldBIDashboard.buildTag("div","",{},{id:this.id+"_relative_date_filter_container"}),i=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 15px"},{}),a=this.bbdesigner$("<tr></tr>"),o=BoldBIDashboard.buildTag("td","",{width:"80px"},{}),s=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","Range",{"font-size":"12px"},{type:"label"}),n=BoldBIDashboard.buildTag("td","",{},{}),r=this.formatDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_date_filter_formatdrop"}),s=(o.append(s),n.append(r),a.append(o).append(n),i.append(a),BoldBIDashboard.buildTag("div","",{width:"100%",height:"5px","border-top":"1px solid var(--primary-border-color)"},{})),o=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"10px 0px 5px"},{}),n=this.bbdesigner$("<tr></tr>"),a=BoldBIDashboard.buildTag("td","",{width:"80px"},{}),d=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","Period",{"font-size":"12px"},{type:"label"}),l=BoldBIDashboard.buildTag("td","",{},{}),h=this.periodDropdown=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_date_filter_perioddrop"}),p=BoldBIDashboard.buildTag("td","",{"padding-left":"5px"},{}),c=this.rangeNumeric=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_date_filter_rangeNumeric"}),u=BoldBIDashboard.buildTag("td","",{width:"70px"},{}),b=this.textDiv=BoldBIDashboard.buildTag("div","",{padding:"0px 5px"},{id:this.id+"_relative_date_filter_rangeFormatDiv"}),g=this.rangeFormat=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily","",{"font-size":"12px"},{type:"label",id:this.id+"_relative_date_filter_rangeFormat"}),d=(a.append(d),l.append(h),p.append(c),u.append(b),b.append(g),n.append(a).append(l,p,u),o.append(n),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px"},{id:this.id+"_relative_date_filter_includeCurrent_table"})),b=BoldBIDashboard.buildTag("tr","",{},{}),g=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","",{"font-size":"12px",width:"80px"},{}),a=BoldBIDashboard.buildTag("td","",{}),l=this.IncludeCurrent=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_relative_date_filter_IncludeCurrent"}),p=(a.append(l),b.append(g).append(a),d.append(b),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px"},{})),u=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","",{"font-size":"12px",width:"80px"},{}),l=BoldBIDashboard.buildTag("td","",{}),g=this.linkDate=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_relative_date_filter_linkDate"}),a=(l.append(g),u.append(n).append(l),p.append(u),BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px"},{})),b=BoldBIDashboard.buildTag("tr","",{},{}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily","",{"font-size":"12px",width:"80px"},{}),l=BoldBIDashboard.buildTag("td","",{}),u=BoldBIDashboard.buildTag("div","",{float:"left"}),m=this.anchorDate=BoldBIDashboard.buildTag("input.bbi-designer-param-assign","",{},{id:this.id+"_relative_date_filter_anchorDate"});l.append(u),u.append(m),b.append(n).append(l),a.append(b),u=BoldBIDashboard.buildTag("div","",{width:"210px",height:"28px","padding-left":"3px",float:"left","line-height":"28px"},{}),n=this.previewTag=BoldBIDashboard.buildTag("span","",{"font-size":"10px","vertical-align":"middle"},{id:this.id+"_relative_date_filter_preview"}),u.append(n),l=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_relative_date_filter_cancel",type:"button"}),b=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.okButtonText,{float:"right"},{id:this.id+"_relative_date_filter_ok",type:"button"}),t.append(i,s,o,d,p,a),e.append(t),this.dashboardDesigner.element.append(e),e.BoldBIDashboardDialog({title:"Relative Date Filter",width:"auto",height:"auto",minWidth:240,minHeight:250,enableResize:!1,showOnInit:!1,enableModal:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,showFooter:!0,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.footerTag=this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter_foot"),this.footerTag.append(u).append(l).append(b),b.on("click",this.bbdesigner$.proxy(this.updateDateFilterInfo,this)),l.on("click",this.bbdesigner$.proxy(this.closeRelativeDateFilter,this)),r.BoldBIDashboardDropDownList({width:"150px",height:"28px",dataSource:this.formatTypeList(),fields:{text:"text",value:"value"},enabled:!0,showRoundedCorner:!0,popupWidth:"160px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFormatType,this)}),h.BoldBIDashboardDropDownList({width:"150px",height:"28px",dataSource:[],fields:{text:"text",value:"dateInstance"},enabled:!0,showRoundedCorner:!0,popupWidth:"160px",popupHeight:"100px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changePeriodType,this)}),c.ejNumericTextbox({showSpinButton:!0,decimalPlaces:0,minValue:1,maxvalue:1e9,value:1,width:"70px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.changeTextBoxValue,this)}),this.IncludeCurrent.BoldBIDashboardCheckBox({text:"Include Current",checked:!1,width:"35px",cssClass:"bbi-designer-case-sensitive",change:this.bbdesigner$.proxy(this.changeIncludeCurrentCheckBoxValue,this)}),g.BoldBIDashboardCheckBox({text:"Link to specific date",checked:!1,width:"35px",cssClass:"bbi-designer-case-sensitive",change:this.bbdesigner$.proxy(this.changeCheckBoxValue,this)}),m.BoldBIDashboardDatePicker({width:"150px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-border bbi-designer-relative-datepicker",enabled:!1,minDate:"01/01/0001",maxDate:"01/01/9999",change:this.bbdesigner$.proxy(this.changeDatePickerValue,this)})},e.prototype.changeDatePickerValue=function(e){BoldBIDashboard.isNullOrUndefined(e)||this.UpdatePreviewRelativeDate()},e.prototype.changeTextBoxValue=function(e){BoldBIDashboard.isNullOrUndefined(e.value)?this.rangeNumeric.data("ejNumericTextbox").setModel({value:1}):this.UpdatePreviewRelativeDate()},e.prototype.changeIncludeCurrentCheckBoxValue=function(e){BoldBIDashboard.isNullOrUndefined(e)||this.UpdatePreviewRelativeDate()},e.prototype.changeFormatType=function(e){var t;if(!BoldBIDashboard.isNullOrUndefined(e)&&0<e.text.length){this.linkDate.data("BoldBIDashboardCheckBox").enable(),this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter_includeCurrent_table").css("display","none"),e.value!==RelativeDateFormat.Minute&&e.value!==RelativeDateFormat.Hour||(this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter_linkDate").data("BoldBIDashboardCheckBox").setModel({checked:!1}),this.linkDate.data("BoldBIDashboardCheckBox").disable());var i=this.linkDate.data("BoldBIDashboardCheckBox").isChecked(),a=this.periodTypeList(e.text,i),o=this.periodDropdown.data("BoldBIDashboardDropDownList"),s=this.bbdesigner$(o.getSelectedItem()).attr("data-value");if(o.setModel({dataSource:a}),BoldBIDashboard.isNullOrUndefined(s))o.selectItemsByIndices(1);else for(t=0;t<a.length;t++){if(a[t].dateInstance===s){o.selectItemsByIndices(t);break}if(!(s!==DateInstance.Custom&&s!==DateInstance.ToDate||e.value!==RelativeDateFormat.Day&&e.value!==RelativeDateFormat.Hour)){o.selectItemsByIndices(1);break}}this.UpdatePreviewRelativeDate()}},e.prototype.changeCheckBoxValue=function(e){var t;if(!BoldBIDashboard.isNullOrUndefined(e)){var i=this.formatDropdown.data("BoldBIDashboardDropDownList").getSelectedValue(),a=this.periodTypeList(i,e.isChecked),o=this.periodDropdown.data("BoldBIDashboardDropDownList"),s=this.bbdesigner$(o.getSelectedItem()).attr("data-value");if(o.setModel({dataSource:a}),BoldBIDashboard.isNullOrUndefined(s))o.selectItemsByIndices(1);else for(t=0;t<a.length;t++)if(a[t].dateInstance===s){o.selectItemsByIndices(t);break}this.anchorDate.data("BoldBIDashboardDatePicker").setModel({enabled:e.isChecked}),this.UpdatePreviewRelativeDate()}},e.prototype.changePeriodType=function(e){var t;!BoldBIDashboard.isNullOrUndefined(e)&&0<e.text.length&&("Last"===(e=e.text)||"Next"===e||"Past"===e||"Upcoming"===e?this.enableRangeNumericTextBox(!0):this.enableRangeNumericTextBox(!1),t=this.formatDropdown.data("BoldBIDashboardDropDownList").getSelectedValue(),"Last"!==e&&"Next"!==e||"Hour"===t||"Minute"===t?this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter_includeCurrent_table").css("display","none"):this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter_includeCurrent_table").css("display","block"),this.UpdatePreviewRelativeDate())},e.prototype.enableRangeNumericTextBox=function(e){e?(e=this.formatDropdown.data("BoldBIDashboardDropDownList").getSelectedValue(),this.rangeNumeric.data("ejNumericTextbox").enable(),this.rangeFormat.text(e.toLowerCase()+"(s)")):(this.rangeNumeric.data("ejNumericTextbox").disable(),this.rangeFormat.text(""))},e.prototype.UpdatePreviewRelativeDate=function(){var e=this.formatDropdown.data("BoldBIDashboardDropDownList").getSelectedValue(),t=null;"Year"===e?t=this.filterRelativeDateByYear():"Quarter"===e?t=this.filterRelativeDateByQuarter():"Month"===e?t=this.filterRelativeDateByMonth():"Week"===e?t=this.filterRelativeDateByWeek():"Day"===e?t=this.filterRelativeDateByDay():"Hour"===e?t=this.filterRelativeDateByHour():"Minute"===e&&(t=this.filterRelativeDateByMinute()),BoldBIDashboard.isNullOrUndefined(t)?this.previewTag.text(""):(e=0<t.startPreviewDate.length?t.startPreviewDate+" to "+t.endPreviewDate:t.endPreviewDate,this.previewTag.text(e))},e.prototype.getPreviewRelatedDetails=function(){var e=this.periodDropdown.data("BoldBIDashboardDropDownList").getListData()[BoldBIDashboard.isNullOrUndefined(this.periodDropdown.data("BoldBIDashboardDropDownList").model.selectedIndex)?1:this.periodDropdown.data("BoldBIDashboardDropDownList").model.selectedIndex].dateInstance,t=this.isCommonDateInstance(e)?this.rangeNumeric.data("ejNumericTextbox").getValue():1;return{useAnchorDate:this.linkDate.data("BoldBIDashboardCheckBox").isChecked(),anchorDate:this.anchorDate.data("BoldBIDashboardDatePicker").getValue(),dateInstance:e,range:t}},e.prototype.filterRelativeDateByYear=function(){var e=this.getPreviewRelatedDetails(),t=e.anchorDate,i=e.range,a=new Date,o=(a=e.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(t)?BoldBIDashboard.globalize.parseDate(t,this.dateFormat):a).getFullYear(),s=null,n=null;switch(e.dateInstance){case DateInstance.Current:s=new Date(o,0,1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear()+1,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Previous:o--,s=new Date(o,0,1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear()+1,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Succeeding:o++,s=new Date(o,0,1,0,0,0),n=this.updateEndDate(new Date(s.getFullYear()+i,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.ToDate:s=new Date(o,0,1,0,0,0,0),n=this.updateEndDate(new Date(o,a.getMonth(),a.getDate()+1));break;case DateInstance.Last:o-=i,s=new Date(o,0,1,0,0,0),n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?this.updateEndDate(new Date(s.getFullYear()+i+1,s.getMonth())):this.updateEndDate(new Date(s.getFullYear()+i,s.getMonth()));break;case DateInstance.Next:n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?(s=new Date(o,0,1,0,0,0),this.updateEndDate(new Date(s.getFullYear()+i+1,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))):(s=new Date(o+1,0,1,0,0,0),this.updateEndDate(new Date(s.getFullYear()+i,s.getMonth(),s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds())));break;case DateInstance.Past:s=new Date(o-i,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),n=this.updateEndDate(a);break;case DateInstance.Upcoming:s=a,n=this.updateEndDate(new Date(o+i,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()))}return e=t=null,BoldBIDashboard.isNullOrUndefined(s)||(t=this.convertDateToString(s),t=BoldBIDashboard.format(new Date(t),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(n)||(e=this.convertDateToString(n),e=BoldBIDashboard.format(new Date(e),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(s)||(s=this.convertDateTimeToMeridiemTimeString(s)),BoldBIDashboard.isNullOrUndefined(n)||(n=this.convertDateTimeToMeridiemTimeString(n)),this.startDate=s,this.endDate=n,{startPreviewDate:t,endPreviewDate:e}},e.prototype.filterRelativeDateByQuarter=function(){var e=this.getPreviewRelatedDetails(),t=e.anchorDate,i=e.range,a=new Date,o=(e.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(t)&&(a=BoldBIDashboard.globalize.parseDate(t,this.dateFormat)),Math.ceil((a.getMonth()+1)/3)),s=null,n=null;switch(e.dateInstance){case DateInstance.Current:s=new Date(a.getFullYear(),Math.ceil(3*(o-1)),1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3,1,0,0,0,0));break;case DateInstance.Previous:s=new Date(a.getFullYear(),Math.ceil(3*(o-1)-3),1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3,1,0,0,0,0));break;case DateInstance.Succeeding:s=new Date(a.getFullYear(),Math.ceil(3*(o-1)+3),1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3,1,0,0,0,0));break;case DateInstance.ToDate:s=new Date(a.getFullYear(),Math.ceil(3*(o-1)),1,0,0,0,0),n=new Date(a.getFullYear(),a.getMonth(),a.getDate(),23,59,59,99);break;case DateInstance.Next:n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?(s=new Date(a.getFullYear(),Math.ceil(3*(o-1)),1,0,0,0),this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3*(i+1),1,0,0,0,0))):(s=new Date(a.getFullYear(),Math.ceil(3*(o-1)+3),1,0,0,0),this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3*i,1,0,0,0,0)));break;case DateInstance.Last:s=new Date(a.getFullYear(),Math.ceil(3*(o-1)-3*i),1,0,0,0),n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3*(i+1),1,0,0,0,0)):this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+3*i,1,0,0,0,0));break;case DateInstance.Past:s=new Date(a.getFullYear(),a.getMonth()-3*i,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),n=this.updateEndDate(a);break;case DateInstance.Upcoming:s=a,n=this.updateEndDate(new Date(a.getFullYear(),a.getMonth()+3*i,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()))}return e=t=null,BoldBIDashboard.isNullOrUndefined(s)||(t=this.convertDateToString(s),t=BoldBIDashboard.format(new Date(t),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(n)||(e=this.convertDateToString(n),e=BoldBIDashboard.format(new Date(e),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(s)||(s=this.convertDateTimeToMeridiemTimeString(s)),BoldBIDashboard.isNullOrUndefined(n)||(n=this.convertDateTimeToMeridiemTimeString(n)),this.startDate=s,this.endDate=n,{startPreviewDate:t,endPreviewDate:e}},e.prototype.filterRelativeDateByMonth=function(){var e=this.getPreviewRelatedDetails(),t=e.anchorDate,i=e.range,a=new Date,o=(a=e.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(t)?BoldBIDashboard.globalize.parseDate(t,this.dateFormat):a).getFullYear(),s=null,n=null;switch(e.dateInstance){case DateInstance.Current:s=new Date(o,a.getMonth(),1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+1));break;case DateInstance.Previous:s=new Date(o,a.getMonth()-1,1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+1));break;case DateInstance.Succeeding:s=new Date(o,a.getMonth()+1,1,0,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+1));break;case DateInstance.ToDate:s=new Date(o,a.getMonth(),1,0,0,0,0),n=a;break;case DateInstance.Last:s=new Date(o,a.getMonth()-i,1,0,0,0,0),n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?this.updateEndDate(new Date(o,a.getMonth()+1,1,0,0,0,0)):this.updateEndDate(new Date(o,a.getMonth(),1,0,0,0,0));break;case DateInstance.Next:n=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?(s=new Date(o,a.getMonth(),1,0,0,0,0),this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+i+1))):(s=new Date(o,a.getMonth()+1,1,0,0,0,0),this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+i)));break;case DateInstance.Past:s=new Date(o,a.getMonth()-i,a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()),n=this.updateEndDate(a);break;case DateInstance.Upcoming:s=a,n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth()+i,s.getDate(),s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()))}return e=t=null,BoldBIDashboard.isNullOrUndefined(s)||(t=this.convertDateToString(s),t=BoldBIDashboard.format(new Date(t),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(n)||(e=this.convertDateToString(n),e=BoldBIDashboard.format(new Date(e),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(s)||(s=this.convertDateTimeToMeridiemTimeString(s)),BoldBIDashboard.isNullOrUndefined(n)||(n=this.convertDateTimeToMeridiemTimeString(n)),this.startDate=s,this.endDate=n,{startPreviewDate:t,endPreviewDate:e}},e.prototype.filterRelativeDateByWeek=function(){var e,t,i=this.getPreviewRelatedDetails(),a=i.anchorDate,o=i.range,s=new Date,n=(i.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(a)&&(s=BoldBIDashboard.globalize.parseDate(a,this.dateFormat)),"Saturday"===this.dashboardDesigner.model.localeSettings.firstDayOfWeek&&(t=-1),"Sunday"===this.dashboardDesigner.model.localeSettings.firstDayOfWeek&&(t=0),"Monday"===this.dashboardDesigner.model.localeSettings.firstDayOfWeek&&(t=1),s.getFullYear()),r=null,d=null,l=t-s.getDay();switch(i.dateInstance){case DateInstance.Current:r=new Date(n,s.getMonth(),s.getDate()+l,0,0,0,0),d=this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+7,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));break;case DateInstance.Previous:r=new Date(n,s.getMonth(),s.getDate()+l-7,0,0,0,0),d=this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+7,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));break;case DateInstance.Succeeding:r=new Date(n,s.getMonth(),s.getDate()+l+7,0,0,0,0),d=this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+7,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));break;case DateInstance.ToDate:r=new Date(n,s.getMonth(),s.getDate()+l,0,0,0,0),d=new Date(r.getFullYear(),r.getMonth(),r.getDate()+s.getDay(),r.getHours()+s.getHours(),r.getMinutes()+s.getMinutes(),r.getSeconds()+s.getSeconds(),r.getMilliseconds()+s.getMilliseconds());break;case DateInstance.Next:e=7*o,d=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?(r=new Date(n,s.getMonth(),s.getDate()+l,0,0,0,0),this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+e+7,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))):(r=new Date(n,s.getMonth(),s.getDate()+l+7,0,0,0,0),this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+e,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())));break;case DateInstance.Last:e=7*o,r=new Date(n,s.getMonth(),s.getDate()+l-e,0,0,0,0),d=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+e+7,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds())):this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+e,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()));break;case DateInstance.Past:e=7*o,r=new Date(s.getFullYear(),s.getMonth(),s.getDate()-e,s.getHours(),s.getMinutes(),s.getSeconds(),s.getMilliseconds()),d=this.updateEndDate(s);break;case DateInstance.Upcoming:e=7*o,r=s,d=this.updateEndDate(new Date(r.getFullYear(),r.getMonth(),r.getDate()+e,r.getHours(),r.getMinutes(),r.getSeconds(),r.getMilliseconds()))}return t=a=null,BoldBIDashboard.isNullOrUndefined(r)||(a=this.convertDateToString(r),a=BoldBIDashboard.format(new Date(a),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(d)||(t=this.convertDateToString(d),t=BoldBIDashboard.format(new Date(t),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(r)||(r=this.convertDateTimeToMeridiemTimeString(r)),BoldBIDashboard.isNullOrUndefined(d)||(d=this.convertDateTimeToMeridiemTimeString(d)),this.startDate=r,this.endDate=d,{startPreviewDate:a,endPreviewDate:t}},e.prototype.filterRelativeDateByDay=function(){var e,t,i=this.getPreviewRelatedDetails(),a=i.anchorDate,o=i.range,s=!1,n=new Date;switch(i.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(a)&&(n=BoldBIDashboard.globalize.parseDate(a,this.dateFormat)),t=e=null,i.dateInstance){case DateInstance.Current:e=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0,0),t=this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())),s=!0;break;case DateInstance.Previous:e=new Date(n.getFullYear(),n.getMonth(),n.getDate()-1,0,0,0,0),t=this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())),s=!0;break;case DateInstance.Succeeding:e=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0,0),t=this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+1,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())),s=!0;break;case DateInstance.Last:e=new Date(n.getFullYear(),n.getMonth(),n.getDate()-o,0,0,0),t=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o+1,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())):this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()));break;case DateInstance.Next:t=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked()?(e=new Date(n.getFullYear(),n.getMonth(),n.getDate(),0,0,0),this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o+1,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()))):(e=new Date(n.getFullYear(),n.getMonth(),n.getDate()+1,0,0,0),this.updateEndDate(new Date(e.getFullYear(),e.getMonth(),e.getDate()+o,e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds())));break;case DateInstance.Past:e=new Date(n.getFullYear(),n.getMonth(),n.getDate()-o,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()),t=this.updateEndDate(n);break;case DateInstance.Upcoming:e=n,t=this.updateEndDate(new Date(n.getFullYear(),n.getMonth(),n.getDate()+o,n.getHours(),n.getMinutes(),n.getSeconds(),n.getMilliseconds()))}return i=a=null,BoldBIDashboard.isNullOrUndefined(e)||(a=s?"":this.convertDateToString(e),a=s?"":BoldBIDashboard.format(new Date(a),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(t)||(i=this.convertDateToString(t),i=BoldBIDashboard.format(new Date(i),this.dateFormat)),BoldBIDashboard.isNullOrUndefined(e)||(e=this.convertDateTimeToMeridiemTimeString(e)),BoldBIDashboard.isNullOrUndefined(t)||(t=this.convertDateTimeToMeridiemTimeString(t)),this.startDate=e,this.endDate=t,{startPreviewDate:a,endPreviewDate:i}},e.prototype.filterRelativeDateByHour=function(){var e=this.getPreviewRelatedDetails(),t=e.anchorDate,i=e.range,a=new Date,o=(a=e.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(t)?BoldBIDashboard.globalize.parseDate(t,this.dateFormat):a).getFullYear(),s=null,n=null;switch(e.dateInstance){case DateInstance.Current:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+1,s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Previous:s=new Date(o,a.getMonth(),a.getDate(),a.getHours()-1,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+1,s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Succeeding:s=new Date(o,a.getMonth(),a.getDate(),a.getHours()+1,0,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+1,s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.ToDate:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),0,0,0),n=a;break;case DateInstance.Next:s=new Date(o,a.getMonth(),a.getDate(),a.getHours()+i,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+i,s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Last:s=new Date(o,a.getMonth(),a.getDate(),a.getHours()-i,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours()+i,s.getMinutes(),s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Past:s=new Date(o,a.getMonth(),a.getDate(),a.getHours()-i,a.getMinutes(),a.getSeconds(),a.getMilliseconds()),n=this.updateEndDate(a);break;case DateInstance.Upcoming:s=a,n=this.updateEndDate(new Date(o,a.getMonth(),a.getDate(),a.getHours()+i,a.getMinutes(),a.getSeconds(),a.getMilliseconds()))}return e=t=null,BoldBIDashboard.isNullOrUndefined(s)||(t=this.convertDateTimeToMeridiemTimeString(s),t=BoldBIDashboard.format(new Date(t),this.timeFormat)),BoldBIDashboard.isNullOrUndefined(n)||(e=this.convertDateTimeToMeridiemTimeString(n),e=BoldBIDashboard.format(new Date(e),this.timeFormat)),BoldBIDashboard.isNullOrUndefined(s)||(s=this.convertDateTimeToMeridiemTimeString(s)),BoldBIDashboard.isNullOrUndefined(n)||(n=this.convertDateTimeToMeridiemTimeString(n)),this.startDate=s,this.endDate=n,{startPreviewDate:t,endPreviewDate:e}},e.prototype.filterRelativeDateByMinute=function(){var e=this.getPreviewRelatedDetails(),t=e.anchorDate,i=e.range,a=new Date,o=(a=e.useAnchorDate&&!BoldBIDashboard.isNullOrUndefined(t)?BoldBIDashboard.globalize.parseDate(t,this.dateFormat):a).getFullYear(),s=null,n=null;switch(e.dateInstance){case DateInstance.Current:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()+1,s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Previous:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()-1,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()-1,s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Succeeding:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()+1,0,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()+1,s.getSeconds(),s.getMilliseconds()));break;case DateInstance.ToDate:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),0,0),n=a;break;case DateInstance.Next:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()+i,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()+i,s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Last:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()-i,0),n=this.updateEndDate(new Date(s.getFullYear(),s.getMonth(),s.getDate(),s.getHours(),s.getMinutes()+i,s.getSeconds(),s.getMilliseconds()));break;case DateInstance.Past:s=new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()-i,a.getSeconds(),a.getMilliseconds()),n=this.updateEndDate(a);break;case DateInstance.Upcoming:s=a,n=this.updateEndDate(new Date(o,a.getMonth(),a.getDate(),a.getHours(),a.getMinutes()+i,a.getSeconds(),a.getMilliseconds()))}return e=t=null,BoldBIDashboard.isNullOrUndefined(s)||(t=this.convertDateTimeToMeridiemTimeString(s),t=BoldBIDashboard.format(new Date(t),this.timeFormat)),BoldBIDashboard.isNullOrUndefined(n)||(e=this.convertDateTimeToMeridiemTimeString(n),e=BoldBIDashboard.format(new Date(e),this.timeFormat)),BoldBIDashboard.isNullOrUndefined(s)||(s=this.convertDateTimeToMeridiemTimeString(s)),BoldBIDashboard.isNullOrUndefined(n)||(n=this.convertDateTimeToMeridiemTimeString(n)),this.startDate=s,this.endDate=n,{startPreviewDate:t,endPreviewDate:e}},e.prototype.convertDateTimeToMeridiemTimeString=function(e){var t=(10<=e.getMonth()+1?"":"0")+(e.getMonth()+1),i=0===e.getHours()?12:12<e.getHours()?e.getHours()-12:e.getHours(),a=12<=e.getHours()?"PM":"AM",i=(i<10?"0":"")+i,o=(e.getMinutes()<10?"0":"")+e.getMinutes();return t+"/"+e.getDate()+"/"+e.getFullYear()+" "+i+":"+o+" "+a},e.prototype.updateEndDate=function(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate(),e.getHours(),e.getMinutes(),e.getSeconds(),e.getMilliseconds()-2)},e.prototype.isCommonDateInstance=function(e){return e===DateInstance.Last||e===DateInstance.Next||e===DateInstance.Past||e===DateInstance.Upcoming},e.prototype.populateDateFilterInfo=function(e){var t,i=BoldBIDashboard.DashboardDesignerUtility.Serialization.enumToString(RelativeDateFormat,e.RelativeDateFormat);this.formatDropdown.data("BoldBIDashboardDropDownList").selectItemByValue(i),this.periodDropdown.data("BoldBIDashboardDropDownList").selectItemByValue(e.DateInstance),this.isCommonDateInstance(e.DateInstance)?(this.enableRangeNumericTextBox(!0),this.rangeNumeric.data("ejNumericTextbox").setModel({value:0<e.Range?e.Range:1})):this.enableRangeNumericTextBox(!1),this.IncludeCurrent.data("BoldBIDashboardCheckBox").setModel({checked:e.IsCurrentIncluded}),this.linkDate.data("BoldBIDashboardCheckBox").setModel({checked:e.UseAnchorDate}),i=null,!BoldBIDashboard.isNullOrUndefined(e.AnchorDate)&&0<e.AnchorDate.length?(t=/^\d{1,2}\/\d{1,2}\/\d{4} \d{1,2}:\d{2}:\d{2} [APM]{2}$/,/^\d{1,2}\/\d{1,2}\/\d{4}$/.test(e.AnchorDate)?i=BoldBIDashboard.globalize.parseDate(e.AnchorDate,this.dateFormat):t.test(e.AnchorDate)&&(i=BoldBIDashboard.globalize.parseDate(e.AnchorDate,this.dateFormat+" "+this.timeFormat))):i=new Date(this.getCurrentDate()),this.anchorDate.data("BoldBIDashboardDatePicker").setModel({enabled:e.UseAnchorDate,value:i}),this.startDate=e.StartDate,this.endDate=e.EndDate,this.UpdatePreviewRelativeDate()},e.prototype.getRelativeDateFilterInfo=function(){var e=new RelativeDateFilterInfo,t=this.formatDropdown.data("BoldBIDashboardDropDownList").getSelectedValue();return e.RelativeDateFormat=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(RelativeDateFormat,t),t=this.periodDropdown.data("BoldBIDashboardDropDownList").getSelectedValue(),e.DateInstance=t,e.Range=this.isCommonDateInstance(t)?this.rangeNumeric.data("ejNumericTextbox").getValue():1,e.StartDate=this.startDate,e.EndDate=this.endDate,e.UseAnchorDate=this.linkDate.data("BoldBIDashboardCheckBox").isChecked(),e.AnchorDate=this.anchorDate.data("BoldBIDashboardDatePicker").getValue(),e.IsCurrentIncluded=this.IncludeCurrent.data("BoldBIDashboardCheckBox").isChecked(),e},e.prototype.getCurrentDate=function(){var e=new Date;return this.convertDateToString(e)},e.prototype.convertDateToString=function(e){return BoldBIDashboard.isNullOrUndefined(e)?null:(10<=e.getMonth()+1?"":"0")+(e.getMonth()+1)+"/"+e.getDate()+"/"+e.getFullYear()},e.prototype.updateDateFilterInfo=function(){var e,t=this.getRelativeDateFilterInfo();if(t.UseAnchorDate&&BoldBIDashboard.isNullOrUndefined(t.AnchorDate))this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateFilterLinkToSpecificDateAlert,this.locale.alertWindowMesages.relativeDateFilterValidationMessage,IconType.warning,AlertType.Alert,!1,"");else if(!BoldBIDashboard.isNullOrUndefined(this.targetInstance)){if(BoldBIDashboard.isNullOrUndefined(this.columnDetails.ChildHierarchicalFields))BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[t,this.columnDetails,this.menuInfo,this.additionalArgs,this.userFilterInfo]);else for(e=0;e<this.columnDetails.ChildHierarchicalFields.length;e++)BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[t,this.columnDetails.ChildHierarchicalFields[e],this.menuInfo,this.additionalArgs]);this.closeRelativeDateFilter()}},e.prototype.openRelativeDateFilter=function(e,t,i,a,o,s,n){void 0===s&&(s=null),this.dateFilterDialog.data("BoldBIDashboardDialog").open(),this.resetDateFilerDialog(),this.targetInstance=e,this.targetMethod=t,this.dateFilterInfo=i,this.columnDetails=a,this.userFilterInfo=n,this.additionalArgs=s,this.menuInfo=o,BoldBIDashboard.isNullOrUndefined(i)?this.formatDropdown.data("BoldBIDashboardDropDownList").setModel({selectedIndex:0}):this.populateDateFilterInfo(i,n)},e.prototype.closeRelativeDateFilter=function(){this.dateFilterDialog.data("BoldBIDashboardDialog").close()},e.prototype.resetDateFilerDialog=function(){this.targetInstance=null,this.targetMethod=null,this.dateFilterInfo=null,this.columnDetails=null,this.additionalArgs=null,this.rangeNumeric.data("ejNumericTextbox").setModel({value:1}),this.enableRangeNumericTextBox(!1),BoldBIDashboard.isNullOrUndefined(this.anchorDate.data("BoldBIDashboardDatePicker"))||(this.anchorDate.data("BoldBIDashboardDatePicker").model.dateFormat=this.dateFormat),this.anchorDate.data("BoldBIDashboardDatePicker").setModel({enabled:!1,value:BoldBIDashboard.format(new Date(this.getCurrentDate()),this.dateFormat)}),this.startDate=null,this.endDate=null,this.previewTag.text(""),this.linkDate.data("BoldBIDashboardCheckBox").setModel({checked:!1})},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter")),0<this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter").length&&this.dashboardDesigner.element.find("#"+this.id+"_relative_date_filter").remove()},e.prototype.periodTypeList=function(e,t){var i=[],i=t?[{text:"Previous "+e,value:"Previous "+e,dateInstance:DateInstance.Previous},{text:"Link "+e,value:"Link "+e,dateInstance:DateInstance.Current},{text:"Next "+e,value:"Next "+e,dateInstance:DateInstance.Succeeding}]:[{text:(a="Day"===e)?"Yesterday":"Previous "+e,value:a?"Yesterday":"Previous "+e,dateInstance:DateInstance.Previous},{text:a?"Today":"Current "+e,value:a?"Today":"Current "+e,dateInstance:DateInstance.Current},{text:a?"Tomorrow":"Next "+e,value:a?"Tomorrow":"Next "+e,dateInstance:DateInstance.Succeeding}],a=[{text:"Last",value:"Last",dateInstance:DateInstance.Last},{text:"Next",value:"Next",dateInstance:DateInstance.Next},{text:"Past",value:"Past",dateInstance:DateInstance.Past},{text:"Upcoming",value:"Upcoming",dateInstance:DateInstance.Upcoming}];return"Day"!==e&&"Hour"!==e&&"Minute"!==e&&a.push({text:e+" to "+(t?"LINK":"date"),value:e+" to "+(t?"LINK":"date"),dateInstance:DateInstance.ToDate}),i.concat(a)},e.prototype.formatTypeList=function(){return[{text:"Year",value:"Year"},{text:"Quarter",value:"Quarter"},{text:"Month",value:"Month"},{text:"Week",value:"Week"},{text:"Day",value:"Day"},{text:"Hour",value:"Hour"},{text:"Minute",value:"Minute"}]},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RelativeDateFilter",InternalRelativeDateFilter,window),InternalRelativeDates=function(){function e(e){this.relativeDatesDialog=null,this.relativeDateItemTable=null,this.rangeTextBoxTd=null,this.formatDropdownTd=null,this.startDateTd=null,this.endDateTd=null,this.customTextBoxTd=null,this.addButtonTd=null,this.confirmationTd=null,this.previewTag=null,this.containerDiv=null,this.deleteIcon=null,this.editIcon=null,this.upIcon=null,this.downIcon=null,this.relativeDateList=[],this.targetInstance=null,this.targetMethod=null,this.addBtnTag=null,this.applyButton=null,this.currentChkbx=null,this.periodDropdown=null,this.rangeTextBox=null,this.formatDropdown=null,this.startDatePicker=null,this.endDatePicker=null,this.customTextBox=null,this.listBoxContent=null,this.locale=null,this.id=e._id,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.designPanel=this.dashboardDesigner.designerPanel,this.renderRelativeDatesWindow()}return e.prototype.renderRelativeDatesWindow=function(){var e,t,i,a,o,s,n=this.relativeDatesDialog=BoldBIDashboard.buildTag("div.bbi-userselect bbi-dbrd-designer-scroll-style-3","",{},{id:this.id+"_relative_dates"}),r=BoldBIDashboard.buildTag("div","",{}),d=this.relativeDateItemTable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px"},{}),l=this.bbdesigner$("<tr></tr>"),h=BoldBIDashboard.buildTag("td","",{"padding-left":"3px"},{id:this.id+"_relative_dates_periodTd"}),p=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_dates_perioddrop"}),h=(h.append(p),c=this.rangeTextBoxTd=BoldBIDashboard.buildTag("td","",{"padding-left":"5px",float:"left",display:"block"},{id:this.id+"_relative_dates_rangeTd"}),e=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_dates_range_textbox"}),c.append(e),u=this.formatDropdownTd=BoldBIDashboard.buildTag("td","",{"padding-left":"5px",float:"right",display:"block"},{id:this.id+"_relative_dates_formatTd"}),t=BoldBIDashboard.buildTag("input","",{},{type:"text",id:this.id+"_relative_dates_formatdrop"}),u.append(t),g=this.startDateTd=BoldBIDashboard.buildTag("td","",{float:"right","padding-right":"7px",display:"none"},{id:this.id+"_relative_dates_startDateTd"}),i=BoldBIDashboard.buildTag("input.bbi-designer-param-assign","",{},{type:"text",id:this.id+"_relative_dates_startDatePicker"}),g.append(i),b=this.endDateTd=BoldBIDashboard.buildTag("td","",{float:"right",display:"none"},{id:this.id+"_relative_dates_endDateTd"}),a=BoldBIDashboard.buildTag("input.bbi-designer-param-assign","",{},{type:"text",id:this.id+"_relative_dates_endDatePicker"}),b.append(a),l.append(h).append(c).append(u).append(b).append(g),d.append(l),this.relativeDateItemTable=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",padding:"5px 0px 10px"},{})),c=this.bbdesigner$("<tr></tr>"),u=this.customTextBoxTd=BoldBIDashboard.buildTag("td","",{"padding-left":"3px",float:"left",display:"flex"},{id:this.id+"_relative_dates_customTd"}),b=BoldBIDashboard.buildTag("input.bbi-designer-param-assign","",{},{type:"text",id:this.id+"_relative_dates_customTextBox"}),l=(u.append(b),g=BoldBIDashboard.buildTag("span","",{"padding-left":"7px"},{id:this.id+"_relative_dates_current"}),u.append(g),this.renderChkBox(g),this.confirmationTd=BoldBIDashboard.buildTag("td","",{display:"none","padding-left":"10px"},{id:this.id+"_relative_dates_confirmationTd"})),g=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_relative_dates_cancel",type:"button"}),m=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary","Update",{float:"right"},{id:this.id+"_relative_dates_update",type:"button"});l.append(g,m),s=this.addButtonTd=BoldBIDashboard.buildTag("td","",{"padding-left":"3px",display:"block"},{id:this.id+"_relative_dates_addTd"}),o=this.addBtnTag=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary","Add",{float:"right"},{id:this.id+"_relative_dates_add",type:"button"}),s.append(o),c.append(u).append(l).append(s),h.append(c),u=BoldBIDashboard.buildTag("div","",{height:"5px",margin:"0px 2px 0px 5px","border-top":"1px solid #cecece"},{}),r.append(d).append(h).append(u),this.renderDateOptionsContainer(r),l=BoldBIDashboard.buildTag("div","",{width:"210px",height:"28px",display:"table","padding-left":"3px",float:"left"},{}),s=this.previewTag=BoldBIDashboard.buildTag("span","",{display:"table-cell","font-size":"10px","vertical-align":"middle"},{id:this.id+"_relative_dates_preview"}),l.append(s),c=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.dialogOptions.cancelButtonText,{float:"right"},{id:this.id+"_relative_dates_close",type:"button"}),this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.dialogOptions.applyButtonText,{float:"right"},{id:this.id+"_relative_dates_ok",type:"button"}),n.append(r),this.dashboardDesigner.element.append(n),n.BoldBIDashboardDialog({title:"Relative Date Options",width:"auto",height:"auto",minWidth:520,minHeight:400,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,cssClass:"bbi-designer-dialog boldbi-dashboarddesigner",close:this.bbdesigner$.proxy(BoldBIDashboard.DashboardUtil.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.dashboardDesigner.element.find("#"+this.id+"_relative_dates_foot").append(l).append(c,this.applyButton),this.applyButton.on("click",this.bbdesigner$.proxy(this.applyRelativeDateInfo,this)),c.on("click",this.bbdesigner$.proxy(this.closeRelativeDateInfo,this)),t.BoldBIDashboardDropDownList({width:"160px",height:"28px",dataSource:this.formatTypeList(),fields:{text:"text",value:"value"},showRoundedCorner:!0,popupWidth:"160px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changeFormatType,this)}),e.ejNumericTextbox({showSpinButton:!0,decimalPlaces:0,minValue:1,maxvalue:1e9,value:1,width:"120px",height:"28px",showRoundedCorner:!0,cssClass:"bbi-designer-ejwidgets bbi-designer-ejwidgets-updown bbi-designer-content-label",change:this.bbdesigner$.proxy(this.getPreviewDateRange,this)}),p.BoldBIDashboardDropDownList({width:"160px",height:"28px",dataSource:[],fields:{text:"text",value:"value"},showRoundedCorner:!0,popupWidth:"160px",cssClass:"bbi-designer-param-assign bbi-designer-border bbi-designer-ejwidgets bbi-dbrd-control",change:this.bbdesigner$.proxy(this.changePeriodType,this)}),i.BoldBIDashboardDatePicker({width:"145px",height:"28px",watermarkText:"Start date",showRoundedCorner:!0,cssClass:"bbi-designer-border e-dbrd-designer-relative-picker e-dashboarddesigner-widget",startDate:"01/01/0001",endDate:"01/01/9999",change:this.bbdesigner$.proxy(this.getPreviewDateRange,this)}),a.BoldBIDashboardDatePicker({width:"145px",height:"28px",watermarkText:"End date",showRoundedCorner:!0,cssClass:"bbi-designer-border e-dbrd-designer-relative-picker e-dashboarddesigner-widget",startDate:"01/01/0001",endDate:"01/01/9999",change:this.bbdesigner$.proxy(this.getPreviewDateRange,this)}),b.BoldBIDashboardMaskEdit({inputMode:BoldBIDashboard.InputMode.Text,width:"200px",height:"26px",watermarkText:"Display Text",showRoundedCorner:!0,cssClass:"bbi-designer-border",change:this.bbdesigner$.proxy(this.changeCustomValue,this)}),o.on("click",this.bbdesigner$.proxy(this.appendRelativeDateList,this)),m.on("click",this.bbdesigner$.proxy(this.updateRelativeDateInfo,this)),g.on("click",this.bbdesigner$.proxy(this.cancelDateInfoUpdation,this)),this.periodDropdown=p.data("BoldBIDashboardDropDownList"),this.rangeTextBox=e.data("ejNumericTextbox"),this.formatDropdown=t.data("BoldBIDashboardDropDownList"),this.startDatePicker=i.data("BoldBIDashboardDatePicker"),this.endDatePicker=a.data("BoldBIDashboardDatePicker"),this.customTextBox=b.data("BoldBIDashboardMaskEdit")},e.prototype.renderChkBox=function(e){var t=this.currentChkbx=BoldBIDashboard.buildTag("input","",{},{type:"checkbox",id:this.id+"_relative_dates_currentChkBox"}),i=BoldBIDashboard.buildTag("Label","Include Current",{"padding-left":"4px"},{type:"checkbox",id:this.id+"_relative_dates_currentChkBox"});e.append(t),e.append(i),t.BoldBIDashboardCheckBox({checked:!1,cssClass:"bbi-designer-param-assign",change:this.bbdesigner$.proxy(this.onCurrentCheck,this)})},e.prototype.onCurrentCheck=function(e){var t=this.dashboardDesigner.element.find("#"+this.id+"_relative_dates_customTextBox"),i=t.val();e.isChecked?i="Current + "+i:i.includes("Current + ")&&(i=i.replace("Current + ","")),t.val(i)},e.prototype.renderDateOptionsContainer=function(e){var t=BoldBIDashboard.buildTag("div.e-dashboarddesigner-relative-filter-toolbar","",{height:"20px",margin:"5px","margin-right":"2px"},{}),i=BoldBIDashboard.buildTag("span","Date Options",{float:"left"},{}),a=this.upIcon=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-dashboarddesigner-up-arrow bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px",width:"30px",height:"100%","line-height":"20px"},{id:this.id+"_relative_dates_up_icon","data-tooltip":"Move Up"}),o=this.downIcon=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-dashboarddesigner-down-arrow bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px",width:"30px",height:"100%","line-height":"20px"},{id:this.id+"_relative_dates_down_icon","data-tooltip":"Move Down"}),s=this.deleteIcon=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-toolbar-delete bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px","padding-right":"3px",width:"30px",height:"100%","line-height":"20px",cursor:"pointer"},{id:this.id+"_relative_dates_delete_icon","data-tooltip":"Delete"}),n=this.editIcon=BoldBIDashboard.buildTag("span.e-icon bbi-widgeticon bbi-designer-parameter-edit bbi-dbrd-designer-hoverable","",{float:"right","font-size":"14px",width:"30px",height:"100%","line-height":"20px",cursor:"pointer"},{id:this.id+"_relative_dates_edit_icon","data-tooltip":"Edit"}),r=this.containerDiv=BoldBIDashboard.buildTag("div","",{"margin-left":"5px"},{id:this.id+"_relative_dates_display_container_div"}),d=BoldBIDashboard.buildTag("ul","",{},{id:this.id+"_relative_dates_display_container"}),l=BoldBIDashboard.buildTag("span","",{float:"right",height:"21px",width:"1px",background:"gray","margin-right":"3px","margin-left":"3px"},{id:this.id+"_relative_separator"});r.append(d),t.append(i).append(s,n,l,a,o),e.append(t).append(r),n.bind("click",this.bbdesigner$.proxy(this.editDateListInfo,this)),s.bind("click",this.bbdesigner$.proxy(this.deleteDateListInfo,this)),a.bind("click",this.bbdesigner$.proxy(this.moveUpDateListInfo,this)),o.bind("click",this.bbdesigner$.proxy(this.moveDownDateListInfo,this)),d.BoldBIDashboardListBox({height:"216px",width:"484px",fields:{text:"DisplayText",value:"DisplayText"},dataSource:[],showRoundedCorner:!0,cssClass:"bbi-designer-param-assign bbi-designer-border bbi-dbrd-control",create:this.bbdesigner$.proxy(this.createScrollBar,this),change:this.bbdesigner$.proxy(this.getPreviewDateRangeForSelectedItems,this),select:this.bbdesigner$.proxy(this.disableUpandDownArrow,this)}),this.listBoxContent=d.data("BoldBIDashboardListBox")},e.prototype.createScrollBar=function(){this.bbdesigner$(this.relativeDatesDialog.find("#"+this.id+"_relative_dates_display_container").BoldBIDashboardListBox("instance").listContainer).BoldBIDashboardScroller({enableTouchScroll:!1,autoHide:!0,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize,scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,cssClass:"bbi-dbrd-designer-scroller bbi-dbrd-control"})},e.prototype.disableUpandDownArrow=function(e){e.isSelected&&(1===e.model.dataSource.length?(this.upIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.downIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled")):(0===e.index&&1<e.model.dataSource.length?(this.upIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.downIcon):e.index===e.model.dataSource.length-1?(this.downIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.upIcon):(this.upIcon.removeClass("bbi-relativedate-filter-icon-disable").removeAttr("disabled"),this.downIcon)).removeClass("bbi-relativedate-filter-icon-disable").removeAttr("disabled"))},e.prototype.moveUpDateListInfo=function(e){BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(e.currentTarget).attr("disabled"))&&(this.listBoxContent.moveUp(),this.swapData(this.listBoxContent.model.selectedIndex,this.listBoxContent.model.selectedIndex-1),this.disableUpandDownArrow({isSelected:!0,index:--this.listBoxContent.model.selectedIndex,model:this.listBoxContent.model}))},e.prototype.moveDownDateListInfo=function(e){BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(e.currentTarget).attr("disabled"))&&(this.listBoxContent.moveDown(),this.swapData(this.listBoxContent.model.selectedIndex,this.listBoxContent.model.selectedIndex+1),this.disableUpandDownArrow({isSelected:!0,index:++this.listBoxContent.model.selectedIndex,model:this.listBoxContent.model}))},e.prototype.swapData=function(e,t){var i;-1!==e&&-1!==t&&(i=this.listBoxContent.model.dataSource[e],this.listBoxContent.model.dataSource[e]=this.listBoxContent.model.dataSource[t],this.listBoxContent.model.dataSource[t]=i)},e.prototype.editDateListInfo=function(){var e=this.listBoxContent.model.selectedIndex;BoldBIDashboard.isNullOrUndefined(e)||(this.populateDateListInfo(this.listBoxContent.model.dataSource[e],!0),this.showUpdateButton(!0),this.disableDateOptionsContainer(!0))},e.prototype.deleteDateListInfo=function(){var e=this.listBoxContent.model.selectedIndex;BoldBIDashboard.isNullOrUndefined(e)||(this.listBoxContent.removeItemByIndex(e),this.relativeDateList=this.listBoxContent.model.dataSource,0<this.listBoxContent.model.dataSource.length?(this.listBoxContent.selectItemByIndex(0),this.disableApplyButton(!1)):(this.disableToobarIcons(!0),this.disableApplyButton(!0)))},e.prototype.updateRelativeDateInfo=function(){var e,t=!1,i="Custom"===this.periodDropdown.getSelectedValue();i&&(e=this.customTextBox.get_UnstrippedValue(),t=BoldBIDashboard.isNullOrUndefined(e)||0===e.length),t?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.relativeDateMessages.relativeRangeNotEmpty,IconType.errors,AlertType.Alert,!1,""):(e=this.getRelativeDateInfo(),BoldBIDashboard.isNullOrUndefined(e)?(this.disableDateOptionsContainer(!1),this.showUpdateButton(!1)):(t=this.listBoxContent.model.selectedIndex,this.isExistDateInfo(e,t)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.relativeDateMessages.itemExist,IconType.warning,AlertType.Alert,!1,""):(this.resetCustomValues(i),this.listBoxContent.model.dataSource[t]=e,this.listBoxContent.refresh(!0),this.relativeDateList=this.listBoxContent.model.dataSource,this.disableDateOptionsContainer(!1),this.showUpdateButton(!1),this.disableApplyButton(!1),""===this.previewTag[0].innerText&&this.getPreviewDateRangeForSelectedItems())))},e.prototype.cancelDateInfoUpdation=function(){var e=this.periodDropdown.getSelectedValue();this.resetCustomValues("Custom"===e),this.showUpdateButton(!1),this.disableDateOptionsContainer(!1)},e.prototype.appendRelativeDateList=function(){var e,t=this.periodDropdown.getSelectedValue();BoldBIDashboard.isNullOrUndefined(this.customTextBox.get_UnstrippedValue())?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.dataSource.emptyName,IconType.errors,AlertType.Alert,!1,""):(e=this.getRelativeDateInfo(),BoldBIDashboard.isNullOrUndefined(e)||(BoldBIDashboard.isNullOrUndefined(e.Filter.Range)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.dataSource.emptyRangeValue,IconType.errors,AlertType.Alert,!1,""):this.isExistDateInfo(e)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.relativeDateMessages.itemExist,IconType.warning,AlertType.Alert,!1,""):("Custom"===t&&this.resetCustomValues(!0),0===this.listBoxContent.model.dataSource.length&&this.disableApplyButton(!1),t=0===this.listBoxContent.model.dataSource.length,this.listBoxContent.addItem(e,this.listBoxContent.model.dataSource.length),this.relativeDateList=this.listBoxContent.model.dataSource,this.listBoxContent.selectItemByIndex(t?0:this.listBoxContent.model.selectedIndex),this.disableUpandDownArrow({isSelected:!0,index:this.listBoxContent.model.selectedIndex||0,model:this.listBoxContent.model}),this.disableToobarIcons(!1),""===this.previewTag[0].innerText&&this.getPreviewDateRangeForSelectedItems())))},e.prototype.isExistDateInfo=function(e,t){for(var i,a,o=0;o<this.relativeDateList.length;o++){if(i=!1,BoldBIDashboard.isNullOrUndefined(t)||t!==o||(i=!0),(a=this.relativeDateList[o].DisplayText===e.DisplayText)&&i)return!1;if(a&&!i)return!0}return!1},e.prototype.resetCustomValues=function(e){var t=(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.periodDropdown.element).attr("disabled"))?this.periodDropdown.getSelectedValue():"")+" "+(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.rangeTextBox.element).attr("disabled"))?this.rangeTextBox.getValue():"")+" "+(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.formatDropdown.element).attr("disabled"))?this.formatDropdown.model.text:"");this.customTextBox.setModel({value:e?"":t}),this.startDatePicker.setModel({value:""}),this.endDatePicker.setModel({value:""})},e.prototype.dateComparison=function(e,t){e=Date.parse(e);return Date.parse(t)<e},e.prototype.getPreviewDateRangeForSelectedItems=function(){var e,t,i=this.listBoxContent.model,a=BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||BoldBIDashboard.isNullOrUndefined(this.queryDesigner.dataset)?(e=this.dashboardDesigner.designerPanel.selectedReportItems[0],BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(e).DataGroupInfo.DataSourceID):this.queryDesigner.dataset.Id;if(!BoldBIDashboard.isNullOrUndefined(i.dataSource)&&1<i.dataSource.length&&!BoldBIDashboard.isNullOrUndefined(i.selectedText)&&""!==i.selectedText)for(t=0;t<i.dataSource.length;t++)i.selectedText===i.dataSource[t].DisplayText&&this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,fieldInfo:i.dataSource[t],dataSetId:a,type:"date",dateRangeType:"RelativeDate",isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.updatePreviewDateRange,this)});else!BoldBIDashboard.isNullOrUndefined(i.dataSource)&&0<i.dataSource.length&&this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,fieldInfo:i.dataSource[0],dataSetId:a,type:"date",dateRangeType:"RelativeDate",isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.updatePreviewDateRange,this)})},e.prototype.getPreviewDateRange=function(){if(!BoldBIDashboard.isNullOrUndefined(this.startDatePicker)&&!BoldBIDashboard.isNullOrUndefined(this.endDatePicker)&&!BoldBIDashboard.isNullOrUndefined(this.periodDropdown)){for(var e=this.startDatePicker.getValue(),t=this.endDatePicker.getValue(),i=this.periodDropdown.getSelectedValue(),a=(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.periodDropdown.element).attr("disabled"))?this.periodDropdown.getSelectedValue():"")+" "+(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.rangeTextBox.element).attr("disabled"))?this.rangeTextBox.getValue():"")+" "+(BoldBIDashboard.isNullOrUndefined(this.bbdesigner$(this.formatDropdown.element).attr("disabled"))?this.formatDropdown.model.text:""),o=["Year(s)","Quarter(s)","Month(s)","Week","Day(s)"],s=!1,n=0;n<o.length;n++)if(a.includes(o[n])&&!a.includes("Week to date")){s=!0;break}"Last"!==i&&"Next"!==i&&this.currentChkbx||!s&&this.currentChkbx?(this.dashboardDesigner.element.find("#"+this.id+"_relative_dates_current").css("display","none"),this.currentChkbx.BoldBIDashboardCheckBox({checked:!1})):this.currentChkbx.css("display","none")&&this.dashboardDesigner.element.find("#"+this.id+"_relative_dates_current").css("display","block"),"Custom"===i?this.customTextBox.setModel({value:"",watermarkText:"Custom date range"}):this.currentChkbx.data("BoldBIDashboardCheckBox").isChecked()?this.customTextBox.setModel({value:"Current + "+a}):this.customTextBox.setModel({value:a}),"Custom"===i&&BoldBIDashboard.isNullOrUndefined(e)||!BoldBIDashboard.isNullOrUndefined(e)&&BoldBIDashboard.isNullOrUndefined(t)||(i=this.getRelativeDateInfo(),BoldBIDashboard.isNullOrUndefined(i))?this.previewTag.text(""):(e=void 0,e=BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||BoldBIDashboard.isNullOrUndefined(this.queryDesigner.dataset)?(t=this.dashboardDesigner.designerPanel.selectedReportItems[0],BoldBIDashboard.Dashboard.WidgetHelper.getWidgetInstance(t).DataGroupInfo.DataSourceID):this.queryDesigner.dataset.Id,this.dashboardDesigner.modules.util.doAjaxPost("POST",this.dashboardDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.FilterAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.getDateRange,fieldInfo:i,dataSetId:e,type:"date",dateRangeType:"RelativeDate",isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.updatePreviewDateRange,this)}))}},e.prototype.updatePreviewDateRange=function(e){BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(e.DateRange)?this.previewTag.text(""):(e=BoldBIDashboard.isNullOrUndefined(e.DateRange.StartDateTime)||BoldBIDashboard.isNullOrUndefined(e.DateRange.EndDateTime)?0<e.DateRange.StartDate.length?e.DateRange.StartDate+" to "+e.DateRange.EndDate:e.DateRange.EndDate:e.DateRange.StartDateTime+" to "+e.DateRange.EndDateTime,this.previewTag.text(e))},e.prototype.getRelativeDateInfo=function(){var e=this.formatDropdown.getSelectedValue();return"Custom"===this.periodDropdown.getSelectedValue()?this.getCustomDateInfo("Year"):"Year to date"===e?this.getTillNowDateInfo("Year",e):"Quarter to date"===e?this.getTillNowDateInfo("Quarter",e):"Month to date"===e?this.getTillNowDateInfo("Month",e):"Week to date"===e?this.getTillNowDateInfo("Week",e):this.getPeriodBasedDateInfo(e)},e.prototype.getCustomDateInfo=function(e){var t=null,i=this.startDatePicker.getValue(),a=this.endDatePicker.getValue(),o=this.customTextBox.get_UnstrippedValue(),s=" 12:00:00 AM";return!BoldBIDashboard.isNullOrUndefined(i)&&!BoldBIDashboard.isNullOrUndefined(a)&&0<i.length&&0<a.length?this.dateComparison(i,a)?this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.relativeDateMessages.startDateNotLessEndDate,IconType.errors,AlertType.Alert,!1,""):((t=new RelativeDateFilterOptions).DisplayText=o,t.IsCustomRange=!0,t.Filter.RelativeDateFormat=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(RelativeDateFormat,e),t.Filter.DateInstance=DateInstance.Custom,t.Filter.Range=0,t.Filter.StartDate=i+s,t.Filter.EndDate=a+s):this.dashboardDesigner.modules.util.alertDialog(this.locale.alertDialogTitle.relativeDateOptions,this.locale.relativeDateMessages.dateNotEmpty,IconType.errors,AlertType.Alert,!1,""),t},e.prototype.getPeriodBasedDateInfo=function(e){var t=new RelativeDateFilterOptions,i=this.periodDropdown.getListData()[this.periodDropdown.model.selectedIndex].dateInstance,a=i===DateInstance.Last||i===DateInstance.Next||i===DateInstance.Past||i===DateInstance.Upcoming,a=a?this.rangeTextBox.getValue():1;this.formatDropdown.model.dataSource[this.formatDropdown.model.selectedIndex].text;"day"===e.toLowerCase()&&i===DateInstance.Current&&this.periodDropdown.model.value;return t.DisplayText=this.customTextBox.get_UnstrippedValue(),t.Filter.RelativeDateFormat=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(RelativeDateFormat,e),t.Filter.DateInstance=i,t.Filter.Range=a,this.currentChkbx.data("BoldBIDashboardCheckBox").isChecked()&&(t.Filter.IsCurrentIncluded=!0),t},e.prototype.getTillNowDateInfo=function(e){var t=new RelativeDateFilterOptions;return t.DisplayText=this.customTextBox.get_UnstrippedValue(),t.Filter.RelativeDateFormat=BoldBIDashboard.DashboardDesignerUtility.Serialization.stringtoEnum(RelativeDateFormat,e),t.Filter.DateInstance=DateInstance.TillNow,t},e.prototype.changeCustomValue=function(e){BoldBIDashboard.isNullOrUndefined(e.value)||e.value},e.prototype.changeFormatType=function(e){var t,i;!BoldBIDashboard.isNullOrUndefined(e)&&0<e.value.length&&(e=e.value,t=this.periodDropdown.model.value,i=BoldBIDashboard.isNullOrUndefined(this.periodDropdown.model.selectedIndex)?1:this.periodDropdown.model.selectedIndex,this.periodDropdown.setModel({dataSource:this.periodTypeList("Day"===e)}),this.periodDropdown.selectItemsByIndices(i),"Year to date"===e||"Quarter to date"===e||"Month to date"===e||"Week to date"===e?(this.disablePeriodDropdown(!0),this.rangeTextBox.disable()):(this.disablePeriodDropdown(!1),this.rangeTextBox.enable()),"Today"!==t&&"Current"!==t||this.rangeTextBox.disable()),this.getPreviewDateRange()},e.prototype.changePeriodType=function(e){!BoldBIDashboard.isNullOrUndefined(e)&&0<e.text.length&&(e=e.text,this.showFormatDropdown(!("Custom"===e)),"Last"===e||"Next"===e||"Past"===e||"Upcoming"===e?this.rangeTextBox.enable():this.rangeTextBox.disable()),this.getPreviewDateRange()},e.prototype.disableToobarIcons=function(e){e?(this.deleteIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.editIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.upIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled"),this.downIcon.addClass("bbi-relativedate-filter-icon-disable").attr("disabled","disabled")):(this.deleteIcon.removeClass("bbi-relativedate-filter-icon-disable").removeAttr("disabled"),this.editIcon.removeClass("bbi-relativedate-filter-icon-disable").removeAttr("disabled"))},e.prototype.disableDateOptionsContainer=function(e){e?this.listBoxContent.disable():this.listBoxContent.enable(),this.disableToobarIcons(e)},e.prototype.showUpdateButton=function(e){(e?(this.confirmationTd.css("display","inline"),this.addButtonTd):(this.addButtonTd.css("display","inline"),this.confirmationTd)).css("display","none")},e.prototype.showFormatDropdown=function(e){e?(this.rangeTextBoxTd.css("display","block"),this.formatDropdownTd.css("display","block"),this.startDateTd.css("display","none"),this.endDateTd.css("display","none")):(this.rangeTextBoxTd.css("display","none"),this.formatDropdownTd.css("display","none"),this.startDateTd.css("display","block"),this.endDateTd.css("display","block"))},e.prototype.disableAddButton=function(e){e?BoldBIDashboard.DashboardUtil.buttonEnable(this.addBtnTag,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.addBtnTag,!0)},e.prototype.disableApplyButton=function(e){e?BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!1):BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.disablePeriodDropdown=function(e){e?(this.periodDropdown.disable(),this.rangeTextBox.disable()):(this.periodDropdown.enable(),this.rangeTextBox.enable())},e.prototype.populateDateListInfo=function(e,t){var i,a,o=e.Filter,s=o.DateInstance===DateInstance.TillNow,n=o.DateInstance===DateInstance.Custom,r=o.RelativeDateFormat+(s?" to date":""),d=null;if(this.formatDropdown.selectItemByValue(r),s||n)s?d="Last":n&&(d="Custom");else for(i=this.periodDropdown.getListData(),a=0;a<i.length;a++)o.DateInstance===i[a].dateInstance&&(d=i[a].text);this.periodDropdown.selectItemByText(d),this.rangeTextBox.setModel({value:0===o.Range?1:o.Range}),n?(this.startDatePicker.setModel({value:new Date(o.StartDate)}),this.endDatePicker.setModel({value:new Date(o.EndDate)}),this.customTextBox.setModel({value:e.DisplayText})):(this.startDatePicker.setModel({value:""}),this.endDatePicker.setModel({value:""}),this.customTextBox.setModel({value:t?e.DisplayText:d+" "+this.rangeTextBox.getValue()+" "+this.formatDropdown.model.text})),o.IsCurrentIncluded&&this.currentChkbx.BoldBIDashboardCheckBox({checked:!0})},e.prototype.populateRelativeDateInfo=function(e){0<e.length&&(this.listBoxContent.setModel({dataSource:e}),this.listBoxContent.selectItemByIndex(0),this.disableUpandDownArrow({isSelected:!0,index:0,model:this.listBoxContent.model}),this.populateDateListInfo(e[0]),this.disableToobarIcons(!1))},e.prototype.applyRelativeDateInfo=function(){BoldBIDashboard.isNullOrUndefined(this.targetInstance)||(BoldBIDashboard.DashboardUtil.invokeMethod(this.targetInstance,this.targetMethod,[this.bbdesigner$.extend([],!0,this.relativeDateList)]),this.closeRelativeDateInfo())},e.prototype.openRelativeDatesDialog=function(e,t,i){this.relativeDatesDialog.data("BoldBIDashboardDialog").open(),this.resetRelativeDateDialog(),this.targetInstance=e,this.targetMethod=t,!BoldBIDashboard.isNullOrUndefined(i)&&0<i.length?(this.relativeDateList=i,this.populateRelativeDateInfo(i)):(this.formatDropdown.setModel({selectedIndex:0}),this.disableApplyButton(!0)),""===this.previewTag[0].innerText&&this.getPreviewDateRangeForSelectedItems()},e.prototype.resetRelativeDateDialog=function(){this.targetInstance=null,this.targetMethod=null,this.relativeDateList=[],this.listBoxContent.setModel({dataSource:[]}),this.rangeTextBox.setModel({value:1}),this.disableToobarIcons(!0),this.listBoxContent.enable(),this.showFormatDropdown(!0),this.showUpdateButton(!1),this.formatDropdown.setModel({selectedIndex:0}),this.periodDropdown.setModel({selectedIndex:1}),this.resetCustomValues(!1),this.currentChkbx.BoldBIDashboardCheckBox({checked:!1})},e.prototype.closeRelativeDateInfo=function(){this.relativeDatesDialog.data("BoldBIDashboardDialog").close()},e.prototype.destroy=function(){BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id+"_relative_dates")),0<this.dashboardDesigner.element.find("#"+this.id+"_relative_dates").length&&this.dashboardDesigner.element.find("#"+this.id+"_relative_dates").remove()},e.prototype.periodTypeList=function(e){return[{text:e?"Today":"Current",value:e?"Today":"Current",dateInstance:DateInstance.Current},{text:"Last",value:"Last",dateInstance:DateInstance.Last},{text:"Next",value:"Next",dateInstance:DateInstance.Next},{text:"Past",value:"Past",dateInstance:DateInstance.Past},{text:"Upcoming",value:"Upcoming",dateInstance:DateInstance.Upcoming},{text:"Custom",value:"Custom",dateInstance:DateInstance.Custom}]},e.prototype.formatTypeList=function(){return[{text:"Year(s)",value:"Year"},{text:"Quarter(s)",value:"Quarter"},{text:"Month(s)",value:"Month"},{text:"Week",value:"Week"},{text:"Day(s)",value:"Day"},{text:"Hour",value:"Hour"},{text:"Minute",value:"Minute"},{text:"Year to date",value:"Year to date"},{text:"Quarter to date",value:"Quarter to date"},{text:"Month to date",value:"Month to date"},{text:"Week to date",value:"Week to date"}]},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.RelativeDates",InternalRelativeDates,window),InternalSharedDSMenu=function(){function e(e){this.dashboardDesigner=null,this.locale=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.locale=e.getLocalizationContent(),this.id=this.dashboardDesigner._id+"_shared_ds_menu",this.renderSharedDataSourceDetailsMenu()}return e.prototype.renderSharedDataSourceDetailsMenu=function(){var e;this.menu=this.bbdesigner$("<ul id ="+this.id+" class = 'bbi-sharedtabledetailsmenu'></ul>"),e="<li id ="+this.id+"_owner_details_header class = 'e-sharedtable-ownername-header bbi-sharedtable-header'><a class = 'e-sharedtable-ownername-headertxt bbi-sharedtable-menuheader-txt'>"+this.locale.sharedDSMenu.ownerNameHeader+"<a><li><li id ="+this.id+"_owner_name class = 'e-sharedtable-ownername'><a class = 'e-sharedtable-ownername-txt e-sharedtable-details-txt'><a><li><li id ="+this.id+"_ds_lastupdate_details_header class = 'e-sharedtable-updatetime-header bbi-sharedtable-header'><a class = 'e-sharedtable-updatetime-headertxt bbi-sharedtable-menuheader-txt'>"+this.locale.sharedDSMenu.LasteUpdatedTimeHeader+"<a><li><li id ="+this.id+"_ds_lastupdate_details class = 'e-sharedtable-updatetime'><a class = 'e-sharedtable-updatetime-txt e-sharedtable-details-txt'><a><li>",this.menu.append(e),this.menu.BoldBIDashboardMenu({width:180,height:140,container:"#"+this.dashboardDesigner._id,menuType:BoldBIDashboard.MenuType.ContextMenu,cssClass:"bbi-designer-menu"}),(e=this.menu.data("BoldBIDashboardMenu")).option("disableItemByID",this.id+"_owner_details_header"),e.option("disableItemByID",this.id+"_ds_lastupdate_details_header")},e.prototype.populateMenuDetails=function(e){this.menu.attr("data-dsId",e.Id),this.menu.find(".e-sharedtable-ownername-txt").text(e.OwnerName),this.menu.find(".e-sharedtable-updatetime-txt").text(e.DsLastUpdatedTime)},e.prototype.openSharedDSMenu=function(e,t,i){var a;this.populateMenuDetails(e),(e=this.menu.data("BoldBIDashboardMenu")).option("contextMenuTarget",t.find(".bbi-sharedtable-menu-icon")),a=140<this.dashboardDesigner.element.height()-i.clientY?i.clientY:i.clientY-140,e.show(i.clientX,a,t.find(".bbi-sharedtable-menu-icon"),i)},e.prototype.destroy=function(){this.menu.data("BoldBIDashboardMenu").destroy(),BoldBIDashboard.DashboardUtil.destroyEjObjects(this.dashboardDesigner.element.find("#"+this.id)),this.dashboardDesigner.element.find("#"+this.id).remove()},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.SharedDSMenu",InternalSharedDSMenu,window),function(a){function e(e,t,i){this.id=e,this.element=t,this.designer=i}e.prototype.render=function(e){var t,i;a.isNullOrUndefined(this.designer.model.datasource)||(this.designerContainer=a.buildTag("div.bbi-dashboard-designer boldbi-dashboarddesigner","",{height:"100%","box-sizing":"border-box"},{id:this.id+"_designerContainer"}),t=this.designAreaTag=a.buildTag("div.bbi-dashboard-designer bbi-userselect bbi-dashboarddesigner-designAreaContainer","",{},{id:this.id+"_designAreaContainer"}),this.itemPanelTag=a.buildTag("div.bbi-dbrd-designer-item-panel","",{width:"240px"},{id:this.id+"_itemPanelContainer"}),this.designPanelTag=a.buildTag("div.bbi-dashboarddesigner-surfaceContainer","",{width:e,border:"0px solid var(--designer-primary-border-color)","border-left-width":"1px",height:"100%",float:"left","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground(),"box-sizing":"border-box"},{id:this.id+"_designSurfaceContainer"}),i=this.dataPanelTag=a.buildTag("div","",{width:"36px",height:"100%",float:"right","box-sizing":"border-box","background-color":"white"},{id:this.id+"_dataPanelContainer"}),this.element.append(this.designerContainer),this.renderToolBar(this.designerContainer,e),t.append(i),this.designerContainer.append(t))},e.prototype.renderToolBar=function(e,t){this.designer.rptToolbar=new a.DashboardDesignerUtility.Toolbar(this.designer,e),this.designer.rptToolbar.renderToolBar(e,40,t)},e.prototype.postRender=function(){var e,t;new a.DashboardDesignerUtility.OAuthHelper(this.designer),e=this.designer.modules.dataSet,(t=this.designer.modules.dataConfigurationPanel).resizeConfigurationPanel(!0),t.showDataConfigurationPanel(),t.loadDataSet(),e.switchPanel(PanelList.QueryBuilder),t=this.designer.model.datasource,a.isNullOrUndefined(this.designer.model.dataSourceVersion)||(t=t+"/"+this.designer.model.dataSourceVersion),this.designer.modules.util.doAjaxPost("POST",this.designer.model.serviceUrl+a.Dashboard.ServiceAPI.importconnection+t,{action:a.DashboardUtil.DesignerAction.ImportDatasources},{fnction:this.designer.bbdesigner$.proxy(this.designer.renderQueryDesigner,this.designer),indicator:[this.designer.bbdesigner$.proxy(this.designer.showDesignIndicator,this.designer),this.designer.bbdesigner$.proxy(this.designer.hideDesignIndicator,this.designer)]},!1,!0)},e.prototype.renderCanvas=function(){this.designCanvas=a.buildTag("div.bbi-dashboarddesigner-designcanvas","",{"box-sizing":"border-box",position:"relative",margin:"0 auto"},{id:this.id+"_designCanvas",tabindex:"0"}),this.canvasContainer=a.buildTag("div.bbi-dbrd-designcanvas-container bbi-dbrd-designcanvas-scroller","",{width:"100%",height:"100%",overflow:"auto","box-sizing":"border-box","background-color":this.designer.modules.themeHelper.getSurfaceContainerBackground()},{id:this.id+"_scrollContentDesignPanel"}),this.scrollUIItem=a.buildTag("div.bbi-dbrd-scroll-ui-container","",{},{})},e.prototype.setContainerSize=function(){},e.prototype.previewDashboard=function(){},e.prototype.renderCells=function(){},e.prototype.renderCellsForExport=function(){},e.prototype.updateSizeForScrollExport=function(){},e.prototype.resizeCombineWidgetForWidgetExport=function(){},e.prototype.wireEvents=function(){},e.prototype.unwireEvents=function(){},a.DataSourceMode=e}(BoldBIDashboard=BoldBIDashboard||{}),InternalProgressIndicator=function(){function e(e){this.elements=[],BoldBIDashboard.isNullOrUndefined(e)||(this.bbdesigner$=BoldBIDashboardDesigner.bbdesignerstatic$,this.elements=e.progressIndicatorInfoList,this.cursorIndex=e.cursorIndex,this.cursor=e.cursor)}return e.prototype.appendProgressContainer=function(e,t,i,a){i=BoldBIDashboard.buildTag("div","",{},{id:this.targetId+"_"+t.name}).addClass(a<i?"completed bbi-dbrd-progress-container":i===a?"selected bbi-dbrd-progress-container":"bbi-dbrd-progress-container"),a=BoldBIDashboard.buildTag("div.bbi-dbrd-progress-icon-container","",{},{id:this.targetId+"_iconcontainer_"+t.name}),t=BoldBIDashboard.buildTag("div.bbi-dbrd-progress-label-container",t.displayText,{},{id:this.targetId+"_labelcontainer_"+t.name}).attr("title",t.displayText);i.append(a,t),e.append(i)},e.prototype.appendSplitter=function(e){var t=BoldBIDashboard.buildTag("div.bbi-dbrd-progress-splitter","",{},{});e.append(t)},e.prototype.appendBreadCrumb=function(e){var t,i,a;if(!BoldBIDashboard.isNullOrUndefined(e)){for(this.targetId=e.attr("id"),this.targetElement=e,i=BoldBIDashboard.buildTag("div.bbi-dbrd-breadcrumb-inner-container","",{},{id:this.targetId+"_breadcrumbcontainer"}),BoldBIDashboard.isNullOrUndefined(this.cursor)||(t=this.getSelectedElementIndex(this.cursor)),a=0;a<this.elements.length;a++)this.appendProgressContainer(i,this.elements[a],-1<t?t:this.cursorIndex,a),this.elements.length>a+1&&this.appendSplitter(i);e.append(i).data("progress-indicator",this)}},e.prototype.getSelectedElementIndex=function(i){var a=-1;return this.elements.filter(function(e,t){e.name!==i&&e.id!==i||(a=t)}),a},e.prototype.updateSelection=function(e){var t=this.bbdesigner$(this.targetElement).find(".bbi-dbrd-progress-container");this.bbdesigner$(t).removeClass("completed selected"),t=this.bbdesigner$(t)[e],this.bbdesigner$(t).addClass("selected"),this.bbdesigner$(t).prevAll(".bbi-dbrd-progress-container").addClass("completed")},e.prototype.updateCursor=function(e){var t=this.getSelectedElementIndex(e);this.elements.length>t&&-1!==t&&(this.cursor=e,this.updateSelection(t))},e.prototype.updateCursorIndex=function(e){this.elements.length>e&&-1!==e&&(this.cursorIndex=e,this.updateSelection(e))},e}(),window.BoldBIDashboard.createObject("BoldBIDashboard.DashboardDesignerUtility.ProgressIndicator",InternalProgressIndicator,window),function(e){(e=e.Designer||(e.Designer={})).ProgressIndicatorCollection=function(){},e.ProgressIndicatorInfo=function(){}}(BoldBIDashboard=BoldBIDashboard||{}),function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.CodeMirror=t()}(this,function(){function r(e){return new RegExp("(^|\\s)"+e+"(?:$|\\s)\\s*")}function $(e){for(var t=e.childNodes.length;0<t;--t)e.removeChild(e.firstChild);return e}function f(e,t){return $(e).appendChild(t)}function T(e,t,i,a){var o,s=document.createElement(e);if(i&&(s.className=i),a&&(s.style.cssText=a),"string"==typeof t)s.appendChild(document.createTextNode(t));else if(t)for(o=0;o<t.length;++o)s.appendChild(t[o]);return s}function W(e,t,i,a){e=T(e,t,i,a);return e.setAttribute("role","presentation"),e}function H(e,t){if(3==t.nodeType&&(t=t.parentNode),e.contains)return e.contains(t);do{if((t=11==t.nodeType?t.host:t)==e)return!0}while(t=t.parentNode)}function q(){var t;try{t=document.activeElement}catch(e){t=document.body||null}for(;t&&t.shadowRoot&&t.shadowRoot.activeElement;)t=t.shadowRoot.activeElement;return t}function d(e,t){var i=e.className;r(t).test(i)||(e.className+=(i?" ":"")+t)}function h(e,t){for(var i=e.split(" "),a=0;a<i.length;a++)i[a]&&!r(i[a]).test(t)&&(t+=" "+i[a]);return t}function z(e){var t=Array.prototype.slice.call(arguments,1);return function(){return e.apply(null,t)}}function j(e,t,i){for(var a in t=t||{},e)!e.hasOwnProperty(a)||!1===i&&t.hasOwnProperty(a)||(t[a]=e[a]);return t}function B(e,t,i,a,o){var s,n,r;for(null==t&&-1==(t=e.search(/[^\s\u00a0]/))&&(t=e.length),s=a||0,n=o||0;;){if((r=e.indexOf("\t",s))<0||t<=r)return n+(t-s);n=(n+=r-s)+(i-n%i),s=r+1}}function b(e,t){for(var i=0;i<e.length;++i)if(e[i]==t)return i;return-1}function G(e,t,i){for(var a,o,s=0,n=0;;){if(o=(a=-1==(a=e.indexOf("\t",s))?e.length:a)-s,a==e.length||t<=n+o)return s+Math.min(o,t-n);if(n+=a-s,s=a+1,t<=(n+=i-n%i))return s}}function Q(e){for(;Zo.length<=e;)Zo.push(A(Zo)+" ");return Zo[e]}function A(e){return e[e.length-1]}function J(e,t){for(var i=[],a=0;a<e.length;a++)i[a]=t(e[a],a);return i}function l(){}function c(e,t){e=Object.create?Object.create(e):(l.prototype=e,new l);return t&&j(t,e),e}function Y(e){return/\w/.test(e)||""<e&&(e.toUpperCase()!=e.toLowerCase()||es.test(e))}function K(e,t){return t?!!(-1<t.source.indexOf("\\w")&&Y(e))||t.test(e):Y(e)}function X(e){for(var t in e)if(e.hasOwnProperty(t)&&e[t])return;return 1}function Z(e){return 768<=e.charCodeAt(0)&&ts.test(e)}function ee(e,t,i){for(;(i<0?0<t:t<e.length)&&Z(e.charAt(t));)t+=i;return t}function te(e,t,i){for(var a,o=i<t?-1:1;;){if(t==i)return t;if(a=(t+i)/2,(a=o<0?Math.ceil(a):Math.floor(a))==t)return e(a)?t:i;e(a)?i=a:t=a+o}}function ie(e,t,i){var a,o=this;this.input=i,o.scrollbarFiller=T("div",null,"CodeMirror-scrollbar-filler"),o.scrollbarFiller.setAttribute("cm-not-content","true"),o.gutterFiller=T("div",null,"CodeMirror-gutter-filler"),o.gutterFiller.setAttribute("cm-not-content","true"),o.lineDiv=W("div",null,"CodeMirror-code"),o.selectionDiv=T("div",null,null,"position: relative; z-index: 1"),o.cursorDiv=T("div",null,"CodeMirror-cursors"),o.measure=T("div",null,"CodeMirror-measure"),o.lineMeasure=T("div",null,"CodeMirror-measure"),o.lineSpace=W("div",[o.measure,o.lineMeasure,o.selectionDiv,o.cursorDiv,o.lineDiv],null,"position: relative; outline: none"),a=W("div",[o.lineSpace],"CodeMirror-lines"),o.mover=T("div",[a],null,"position: relative"),o.sizer=T("div",[o.mover],"CodeMirror-sizer"),o.sizerWidth=null,o.heightForcer=T("div",null,null,"position: absolute; height: "+rn+"px; width: 1px;"),o.gutters=T("div",null,"CodeMirror-gutters"),o.lineGutter=null,o.scroller=T("div",[o.sizer,o.heightForcer,o.gutters],"CodeMirror-scroll"),o.scroller.setAttribute("tabIndex","-1"),o.wrapper=T("div",[o.scrollbarFiller,o.gutterFiller,o.scroller],"CodeMirror"),E&&M<8&&(o.gutters.style.zIndex=-1,o.scroller.style.paddingRight=0),P||Qs&&on||(o.scroller.draggable=!0),e&&(e.appendChild?e.appendChild(o.wrapper):e(o.wrapper)),o.viewFrom=o.viewTo=t.first,o.reportedViewFrom=o.reportedViewTo=t.first,o.view=[],o.renderedView=null,o.externalMeasured=null,o.viewOffset=0,o.lastWrapHeight=o.lastWrapWidth=0,o.updateLineNumbers=null,o.nativeBarWidth=o.barHeight=o.barWidth=0,o.scrollbarsClipped=!1,o.lineNumWidth=o.lineNumInnerWidth=o.lineNumChars=null,o.alignWidgets=!1,o.cachedCharWidth=o.cachedTextHeight=o.cachedPaddingH=null,o.maxLine=null,o.maxLineLength=0,o.maxLineChanged=!1,o.wheelDX=o.wheelDY=o.wheelStartX=o.wheelStartY=null,o.shift=!1,o.selForContextMenu=null,o.activeTouch=null,i.init(o)}function S(e,t){var i,a,o,s;if((t-=e.first)<0||t>=e.size)throw new Error("There is no line "+(t+e.first)+" in the document.");for(i=e;!i.lines;)for(a=0;;++a){if(t<(s=(o=i.children[a]).chunkSize())){i=o;break}t-=s}return i.lines[t]}function ae(e,t,i){var a=[],o=t.line;return e.iter(t.line,i.line+1,function(e){e=e.text;o==i.line&&(e=e.slice(0,i.ch)),o==t.line&&(e=e.slice(t.ch)),a.push(e),++o}),a}function oe(e,t,i){var a=[];return e.iter(t,i,function(e){a.push(e.text)}),a}function se(e,t){var i,a=t-e.height;if(a)for(i=e;i;i=i.parent)i.height+=a}function I(e){var t,i,a,o;if(null==e.parent)return null;for(i=b((t=e.parent).lines,e),a=t.parent;a;a=(t=a).parent)for(o=0;a.children[o]!=t;++o)i+=a.children[o].chunkSize();return i+t.first}function ne(e,t){var i,a,o,s,n,r=e.first;e:do{for(i=0;i<e.children.length;++i){if(t<(o=(a=e.children[i]).height)){e=a;continue e}t-=o,r+=a.chunkSize()}return r}while(!e.lines);for(s=0;s<e.lines.length&&!(t<(n=e.lines[s].height));++s)t-=n;return r+s}function re(e,t){return t>=e.first&&t<e.first+e.size}function de(e,t){return String(e.lineNumberFormatter(t+e.firstLineNumber))}function k(e,t,i){if(void 0===i&&(i=null),!(this instanceof k))return new k(e,t,i);this.line=e,this.ch=t,this.sticky=i}function x(e,t){return e.line-t.line||e.ch-t.ch}function le(e,t){return e.sticky==t.sticky&&0==x(e,t)}function he(e){return k(e.line,e.ch)}function pe(e,t){return x(e,t)<0?t:e}function ce(e,t){return x(e,t)<0?e:t}function ue(e,t){return Math.max(e.first,Math.min(t,e.first+e.size-1))}function N(e,t){var i;return t.line<e.first?k(e.first,0):(i=e.first+e.size-1,t.line>i?k(i,S(e,i).text.length):(e=S(e,(i=t).line).text.length,null==(t=i.ch)||e<t?k(i.line,e):t<0?k(i.line,0):i))}function be(e,t){for(var i=[],a=0;a<t.length;a++)i[a]=N(e,t[a]);return i}function ge(e,t,i){this.marker=e,this.from=t,this.to=i}function me(e,t){var i,a;if(e)for(i=0;i<e.length;++i)if((a=e[i]).marker==t)return a}function fe(e,t){var i,a,o,s,n,r,d,l,h,p,c,u;if(t.full||(i=re(e,t.from.line)&&S(e,t.from.line).markedSpans,a=re(e,t.to.line)&&S(e,t.to.line).markedSpans,!i&&!a))return null;var b=t.from.ch,e=t.to.ch,g=0==x(t.from,t.to),m=function(e,t,i){var a,o,s;if(e)for(o=0;o<e.length;++o){var n=e[o],r=n.marker;!(null==n.from||(r.inclusiveLeft?n.from<=t:n.from<t))&&(n.from!=t||"bookmark"!=r.type||i&&n.marker.insertLeft)||(s=null==n.to||(r.inclusiveRight?n.to>=t:n.to>t),(a=a||[]).push(new ge(r,n.from,s?null:n.to)))}return a}(i,b,g),f=function(e,t,i){var a,o,s;if(e)for(o=0;o<e.length;++o){var n=e[o],r=n.marker;!(null==n.to||(r.inclusiveRight?n.to>=t:n.to>t))&&(n.from!=t||"bookmark"!=r.type||i&&!n.marker.insertLeft)||(s=null==n.from||(r.inclusiveLeft?n.from<=t:n.from<t),(a=a||[]).push(new ge(r,s?null:n.from-t,null==n.to?null:n.to-t)))}return a}(a,e,g),D=1==t.text.length,y=A(t.text).length+(D?b:0);if(m)for(o=0;o<m.length;++o)null==(s=m[o]).to&&((n=me(f,s.marker))?D&&(s.to=null==n.to?null:n.to+y):s.to=b);if(f)for(r=0;r<f.length;++r)null!=(d=f[r]).to&&(d.to+=y),null==d.from?me(m,d.marker)||(d.from=y,D&&(m=m||[]).push(d)):(d.from+=y,D&&(m=m||[]).push(d));if(m=m&&De(m),f&&f!=m&&(f=De(f)),l=[m],!D){if(0<(h=t.text.length-2)&&m)for(c=0;c<m.length;++c)null==m[c].to&&(p=p||[]).push(new ge(m[c].marker,null,null));for(u=0;u<h;++u)l.push(p);l.push(f)}return l}function De(e){for(var t,i=0;i<e.length;++i)null!=(t=e[i]).from&&t.from==t.to&&!1!==t.marker.clearWhenEmpty&&e.splice(i--,1);return e.length?e:null}function ye(e){var t,i=e.markedSpans;if(i){for(t=0;t<i.length;++t)i[t].marker.detachLine(e);e.markedSpans=null}}function Be(e,t){if(t){for(var i=0;i<t.length;++i)t[i].marker.attachLine(e);e.markedSpans=t}}function Ie(e){return e.inclusiveLeft?-1:0}function xe(e){return e.inclusiveRight?1:0}function _e(e,t){var i,a,o=e.lines.length-t.lines.length;return 0!=o?o:(o=e.find(),i=t.find(),(a=x(o.from,i.from)||Ie(e)-Ie(t))?-a:x(o.to,i.to)||xe(e)-xe(t)||t.id-e.id)}function ve(e,t){var i,a,o,s=as&&e.markedSpans;if(s)for(o=0;o<s.length;++o)(a=s[o]).marker.collapsed&&null==(t?a.from:a.to)&&(!i||_e(i,a.marker)<0)&&(i=a.marker);return i}function Ce(e){return ve(e,!0)}function we(e){return ve(e,!1)}function Te(e,t,i,a,o){var s,n,e=S(e,t),r=as&&e.markedSpans;if(r)for(s=0;s<r.length;++s)if((n=r[s]).marker.collapsed){var d=n.marker.find(0),l=x(d.from,i)||Ie(n.marker)-Ie(o),h=x(d.to,a)||xe(n.marker)-xe(o);if(!(0<=l&&h<=0||l<=0&&0<=h||!(l<=0&&(n.marker.inclusiveRight&&o.inclusiveLeft?0<=x(d.to,i):0<x(d.to,i))||0<=l&&(n.marker.inclusiveRight&&o.inclusiveLeft?x(d.from,a)<=0:x(d.from,a)<0))))return 1}}function Se(e){for(var t;t=Ce(e);)e=t.find(-1,!0).line;return e}function ke(e,t){var e=S(e,t),i=Se(e);return e==i?t:I(i)}function Ne(e,t){if(t>e.lastLine())return t;var i,a=S(e,t);if(!Fe(e,a))return t;for(;i=we(a);)a=i.find(1,!0).line;return I(a)+1}function Fe(e,t){var i,a,o=as&&t.markedSpans;if(o)for(a=0;a<o.length;++a)if((i=o[a]).marker.collapsed&&(null==i.from||!i.marker.widgetNode&&0==i.from&&i.marker.inclusiveLeft&&function e(t,i,a){var o,s,n;if(null==a.to)return o=a.marker.find(1,!0),e(t,o.line,me(o.line.markedSpans,a.marker));if(a.marker.inclusiveRight&&a.to==i.text.length)return!0;for(s=void 0,n=0;n<i.markedSpans.length;++n)if(s=i.markedSpans[n],s.marker.collapsed&&!s.marker.widgetNode&&s.from==a.to&&(null==s.to||s.to!=a.from)&&(s.marker.inclusiveLeft||a.marker.inclusiveRight)&&e(t,i,s))return!0}(e,t,i)))return!0}function Oe(e){for(var t,i,a,o,s,n=(e=Se(e)).parent,r=t=0;r<n.lines.length&&(i=n.lines[r])!=e;++r)t+=i.height;for(a=n.parent;a;a=(n=a).parent)for(o=0;o<a.children.length&&(s=a.children[o])!=n;++o)t+=s.height;return t}function Le(e){var t,i,a,o,s;if(0==e.height)return 0;for(t=e.text.length,a=e;i=Ce(a);)a=(o=i.find(0,!0)).from.line,t+=o.from.ch-o.to.ch;for(a=e;i=we(a);)s=i.find(0,!0),t=(t-=a.text.length-s.from.ch)+((a=s.to.line).text.length-s.to.ch);return t}function Ue(e){var i=e.display,e=e.doc;i.maxLine=S(e,e.first),i.maxLineLength=Le(i.maxLine),i.maxLineChanged=!0,e.iter(function(e){var t=Le(e);t>i.maxLineLength&&(i.maxLineLength=t,i.maxLine=e)})}function Ee(e,t,i){var a,o,s;for(os=null,o=0;o<e.length;++o){if((s=e[o]).from<t&&s.to>t)return o;s.to==t&&(s.from!=s.to&&"before"==i?a=o:os=o),s.from==t&&(s.from!=s.to&&"before"!=i?a=o:os=o)}return null!=a?a:os}function Me(e,t){var i=e.order;return i=null==i?e.order=un(e.text,t):i}function Ae(e,t){return e._handlers&&e._handlers[t]||bn}function _(e,t,i){var a;e.removeEventListener?e.removeEventListener(t,i,!1):e.detachEvent?e.detachEvent("on"+t,i):(a=(e=e._handlers)&&e[t])&&-1<(i=b(a,i))&&(e[t]=a.slice(0,i).concat(a.slice(i+1)))}function F(e,t){var i,a,o=Ae(e,t);if(o.length)for(i=Array.prototype.slice.call(arguments,2),a=0;a<o.length;++a)o[a].apply(null,i)}function O(e,t,i){return"string"==typeof t&&(t={type:t,preventDefault:function(){this.defaultPrevented=!0}}),F(e,i||t.type,e,t),We(t)||t.codemirrorIgnore}function Pe(e){var t,i,a=e._handlers&&e._handlers.cursorActivity;if(a)for(t=e.curOp.cursorActivityHandlers||(e.curOp.cursorActivityHandlers=[]),i=0;i<a.length;++i)-1==b(t,a[i])&&t.push(a[i])}function Re(e,t){return 0<Ae(e,t).length}function Ve(e){e.prototype.on=function(e,t){V(this,e,t)},e.prototype.off=function(e,t){_(this,e,t)}}function v(e){e.preventDefault?e.preventDefault():e.returnValue=!1}function $e(e){e.stopPropagation?e.stopPropagation():e.cancelBubble=!0}function We(e){return null!=e.defaultPrevented?e.defaultPrevented:0==e.returnValue}function He(e){v(e),$e(e)}function qe(e){return e.target||e.srcElement}function ze(e){var t=e.which;return null==t&&(1&e.button?t=1:2&e.button?t=3:4&e.button&&(t=2)),t=sn&&e.ctrlKey&&1==t?3:t}function je(e){if("string"==typeof e&&In.hasOwnProperty(e))e=In[e];else if(e&&"string"==typeof e.name&&In.hasOwnProperty(e.name)){var t=In[e.name];(e=c(t="string"==typeof t?{name:t}:t,e)).name=t.name}else{if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+xml$/.test(e))return je("application/xml");if("string"==typeof e&&/^[\w\-]+\/[\w\-]+\+json$/.test(e))return je("application/json")}return"string"==typeof e?{name:e}:e||{name:"null"}}function Ge(e,t){var i,a,o,s,n;if(t=je(t),!(i=Bn[t.name]))return Ge(e,"text/plain");if(a=i(e,t),xn.hasOwnProperty(t.name))for(s in o=xn[t.name])o.hasOwnProperty(s)&&(a.hasOwnProperty(s)&&(a["_"+s]=a[s]),a[s]=o[s]);if(a.name=t.name,t.helperType&&(a.helperType=t.helperType),t.modeProps)for(n in t.modeProps)a[n]=t.modeProps[n];return a}function Qe(e,t){j(t,xn.hasOwnProperty(e)?xn[e]:xn[e]={})}function Je(e,t){var i,a,o;if(!0===t)return t;if(e.copyState)return e.copyState(t);for(a in i={},t)o=t[a],o instanceof Array&&(o=o.concat([])),i[a]=o;return i}function Ye(e,t){for(var i;e.innerMode&&((i=e.innerMode(t))&&i.mode!=e);)t=i.state,e=i.mode;return i||{mode:e,state:t}}function Ke(e,t,i){return!e.startState||e.startState(t,i)}function Xe(t,i,a,e){var o,s,n,d=[t.state.modeGen],l={};for(nt(t,i.text,t.doc.mode,a,function(e,t){d.push(e,t)},l,e),o=a.state,s=function(e){a.baseTokens=d;var s=t.state.overlays[e],n=1,r=0;a.state=!0,nt(t,i.text,s.mode,a,function(e,t){for(var i,a,o=n;r<e;)e<(i=d[n])&&d.splice(n,1,e,d[n+1],i),n+=2,r=Math.min(e,i);if(t)if(s.opaque)d.splice(o,n-o,e,"overlay "+t),n=o+2;else for(;o<n;o+=2)d[o+1]=((a=d[o+1])?a+" ":"")+"overlay "+t},l),a.state=o,a.baseTokens=null,a.baseTokenPos=1},n=0;n<t.state.overlays.length;++n)s(n);return{styles:d,classes:l.bgClass||l.textClass?l:null}}function Ze(e,t,i){var a,o,s;return t.styles&&t.styles[0]==e.state.modeGen||(a=et(e,I(t)),o=t.text.length>e.options.maxHighlightLength&&Je(e.doc.mode,a.state),s=Xe(e,t,a),o&&(a.state=o),t.stateAfter=a.save(!o),t.styles=s.styles,s.classes?t.styleClasses=s.classes:t.styleClasses&&(t.styleClasses=null),i===e.doc.highlightFrontier&&(e.doc.modeFrontier=Math.max(e.doc.modeFrontier,++e.doc.highlightFrontier))),t.styles}function et(i,a,e){var t,o,s,n=i.doc,r=i.display;return n.mode.startState?(o=(t=function(e,t,i){for(var a,o,s,n,r=e.doc,d=i?-1:t-(e.doc.mode.innerMode?1e3:100),l=t;d<l;--l){if(l<=r.first)return r.first;if(a=S(r,l-1),(o=a.stateAfter)&&(!i||l+(o instanceof rs?o.lookAhead:0)<=r.modeFrontier))return l;o=B(a.text,null,e.options.tabSize),(null==n||o<s)&&(n=l-1,s=o)}return n}(i,a,e))>n.first&&S(n,t-1).stateAfter,s=o?ds.fromSaved(n,o,t):new ds(n,Ke(n.mode),t),n.iter(t,a,function(e){tt(i,e.text,s);var t=s.line;e.stateAfter=t==a-1||t%5==0||t>=r.viewFrom&&t<r.viewTo?s.save():null,s.nextLine()}),e&&(n.modeFrontier=s.line),s):new ds(n,!0,a)}function tt(e,t,i,a){var o=e.doc.mode,s=new R(t,e.options.tabSize,i);for(s.start=s.pos=a||0,""==t&&it(o,i.state);!s.eol();)at(o,s,i.state),s.start=s.pos}function it(e,t){if(e.blankLine)return e.blankLine(t);if(e.innerMode){e=Ye(e,t);if(e.mode.blankLine)return e.mode.blankLine(e.state)}}function at(e,t,i,a){for(var o,s=0;s<10;s++)if(a&&(a[0]=Ye(e,i).mode),o=e.token(t,i),t.pos>t.start)return o;throw new Error("Mode "+e.name+" failed to advance stream.")}function ot(e,t,i,a){var o,s,n=e.doc,r=n.mode,d=S(n,(t=N(n,t)).line),l=et(e,t.line,i),h=new R(d.text,e.options.tabSize,l);for(a&&(s=[]);(a||h.pos<t.ch)&&!h.eol();)h.start=h.pos,o=at(r,h,l.state),a&&s.push(new ls(h,o,Je(n.mode,l.state)));return a?s:new ls(h,o,l.state)}function st(e,t){var i,a;if(e)for(;i=e.match(/(?:^|\s+)line-(background-)?(\S+)/);)e=e.slice(0,i.index)+e.slice(i.index+i[0].length),null==t[a=i[1]?"bgClass":"textClass"]?t[a]=i[2]:new RegExp("(?:^|s)"+i[2]+"(?:$|s)").test(t[a])||(t[a]+=" "+i[2]);return e}function nt(e,t,i,a,o,s,n){var r,d,l,h=i.flattenSpans,p=(null==h&&(h=e.options.flattenSpans),0),c=null,u=new R(t,e.options.tabSize,a),b=e.options.addModeClass&&[null];for(""==t&&st(it(i,a.state),s);!u.eol();){if(l=u.pos>e.options.maxHighlightLength?(h=!1,n&&tt(e,t,a,u.pos),u.pos=t.length,null):st(at(i,u,a.state,b),s),b&&(r=b[0].name)&&(l="m-"+(l?r+" "+l:r)),!h||c!=l){for(;p<u.start;)o(p=Math.min(u.start,p+5e3),c);c=l}u.start=u.pos}for(;p<u.pos;)o(d=Math.min(u.pos,p+5e3),c),p=d}function rt(e,t){return!e||/^\s*$/.test(e)?null:(t=t.addModeClass?cs:ps)[e]||(t[e]=e.replace(/\S+/g,"cm-$&"))}function dt(e,t){var i,a,o,s,n,r,d=W("span",null,null,P?"padding-right: .1px":null),l={pre:W("pre",[d],"CodeMirror-line"),content:d,col:0,pos:0,cm:e,trailingSpace:!1,splitSpaces:(E||P)&&e.getOption("lineWrapping")};for(t.measure={},i=0;i<=(t.rest?t.rest.length:0);i++)a=i?t.rest[i-1]:t.line,o=void 0,l.pos=0,l.addToken=ht,s=e.display.measure,r=n=void 0,(null!=ns?ns:(r=f(s,document.createTextNode("AخA")),n=Yo(r,0,1).getBoundingClientRect(),r=Yo(r,1,2).getBoundingClientRect(),$(s),n&&n.left!=n.right&&(ns=r.right-n.right<3)))&&(o=Me(a,e.doc.direction))&&(l.addToken=function(p,c){return function(e,t,i,a,o,s,n){var r,d,l,h;for(i=i?i+" cm-force-border":"cm-force-border",d=(r=e.pos)+t.length;;){for(l=void 0,h=0;h<c.length&&!((l=c[h]).to>r&&l.from<=r);h++);if(l.to>=d)return p(e,t,i,a,o,s,n);p(e,t.slice(0,l.to-r),i,a,null,s,n),a=null,t=t.slice(l.to-r),r=l.to}}}(l.addToken,o)),l.map=[],function(e,t,i){var a,o,s,n,r,d,l,h,p,c,u,b=e.markedSpans,g=e.text,m=0;if(b)for(var f,D,y,B,I,x,_,v=g.length,C=0,w=1,T="",S=0;;){if(S==C){for(y=B=I=x=D="",_=null,S=1/0,o=[],s=void 0,n=0;n<b.length;++n)r=b[n],"bookmark"==(d=r.marker).type&&r.from==C&&d.widgetNode?o.push(d):r.from<=C&&(null==r.to||r.to>C||d.collapsed&&r.to==C&&r.from==C)?(null!=r.to&&r.to!=C&&S>r.to&&(S=r.to,B=""),d.className&&(y+=" "+d.className),d.css&&(D=(D?D+";":"")+d.css),d.startStyle&&r.from==C&&(I+=" "+d.startStyle),d.endStyle&&r.to==S&&(s=s||[]).push(d.endStyle,r.to),d.title&&!x&&(x=d.title),d.collapsed&&(!_||_e(_.marker,d)<0)&&(_=r)):r.from>C&&S>r.from&&(S=r.from);if(s)for(l=0;l<s.length;l+=2)s[l+1]==S&&(B+=" "+s[l]);if(!_||_.from==C)for(h=0;h<o.length;++h)pt(t,0,o[h]);if(_&&(_.from||0)==C){if(pt(t,(null==_.to?v+1:_.to)-C,_.marker,null==_.from),null==_.to)return;_.to==C&&(_=!1)}}if(v<=C)break;for(p=Math.min(v,S);;){if(T){if(c=C+T.length,_||(u=p<c?T.slice(0,p-C):T,t.addToken(t,u,f?f+y:y,I,C+u.length==S?B:"",x,D)),p<=c){T=T.slice(p-C),C=p;break}C=c,I=""}T=g.slice(m,m=i[w++]),f=rt(i[w++],t.cm.options)}}else for(a=1;a<i.length;a+=2)t.addToken(t,g.slice(m,m=i[a]),rt(i[a+1],t.cm.options))}(a,l,Ze(e,a,t!=e.display.externalMeasured&&I(a))),a.styleClasses&&(a.styleClasses.bgClass&&(l.bgClass=h(a.styleClasses.bgClass,l.bgClass||"")),a.styleClasses.textClass)&&(l.textClass=h(a.styleClasses.textClass,l.textClass||"")),0==l.map.length&&l.map.push(0,0,l.content.appendChild((s=e.display.measure,r=void 0,(s=(ss=null==ss&&(r=T("span","​"),f(s,T("span",[r,document.createTextNode("x")])),0!=s.firstChild.offsetHeight)?r.offsetWidth<=1&&2<r.offsetHeight&&!(E&&M<8):ss)?T("span","​"):T("span"," ",null,"display: inline-block; width: 1px; margin-right: -1px")).setAttribute("cm-text",""),s))),0==i?(t.measure.map=l.map,t.measure.cache={}):((t.measure.maps||(t.measure.maps=[])).push(l.map),(t.measure.caches||(t.measure.caches=[])).push({}));return P&&(d=l.content.lastChild,/\bcm-tab\b/.test(d.className)||d.querySelector&&d.querySelector(".cm-tab"))&&(l.content.className="cm-tab-wrap-hack"),F(e,"renderLine",e,t.line,l.pre),l.pre.className&&(l.textClass=h(l.pre.className,l.textClass||"")),l}function lt(e){var t=T("span","•","cm-invalidchar");return t.title="\\u"+e.charCodeAt(0).toString(16),t.setAttribute("aria-label",t.title),t}function ht(e,t,i,a,o,s,n){var r,d,l,h;if(t){var p,c=e.splitSpaces?function(e,t){var i,a,o,s;if(1<e.length&&!/  /.test(e))return e;for(i=t,a="",o=0;o<e.length;o++)" "!=(s=e.charAt(o))||!i||o!=e.length-1&&32!=e.charCodeAt(o+1)||(s=" "),a+=s,i=" "==s;return a}(t,e.trailingSpace):t,u=e.cm.state.specialChars,b=!1;if(u.test(t))for(p=document.createDocumentFragment(),r=0;u.lastIndex=r,(h=(d=u.exec(t))?d.index-r:t.length-r)&&(l=document.createTextNode(c.slice(r,r+h)),E&&M<9?p.appendChild(T("span",[l])):p.appendChild(l),e.map.push(e.pos,e.pos+h,l),e.col+=h,e.pos+=h),d;)r+=1+h,l=void 0,"\t"==d[0]?(h=(h=e.cm.options.tabSize)-e.col%h,(l=p.appendChild(T("span",Q(h),"cm-tab"))).setAttribute("role","presentation"),l.setAttribute("cm-text","\t"),e.col+=h):("\r"==d[0]||"\n"==d[0]?(l=p.appendChild(T("span","\r"==d[0]?"␍":"␤","cm-invalidchar"))).setAttribute("cm-text",d[0]):((l=e.cm.options.specialCharPlaceholder(d[0])).setAttribute("cm-text",d[0]),E&&M<9?p.appendChild(T("span",[l])):p.appendChild(l)),e.col+=1),e.map.push(e.pos,e.pos+1,l),e.pos++;else e.col+=t.length,p=document.createTextNode(c),e.map.push(e.pos,e.pos+t.length,p),E&&M<9&&(b=!0),e.pos+=t.length;if(e.trailingSpace=32==c.charCodeAt(t.length-1),i||a||o||b||n)return b=i||"",a&&(b+=a),o&&(b+=o),i=T("span",[p],b,n),s&&(i.title=s),e.content.appendChild(i);e.content.appendChild(p)}}function pt(e,t,i,a){var o=!a&&i.widgetNode;o&&e.map.push(e.pos,e.pos+t,o),!a&&e.cm.display.input.needsContentAttribute&&(o=o||e.content.appendChild(document.createElement("span"))).setAttribute("cm-marker",i.id),o&&(e.cm.display.input.setUneditable(o),e.content.appendChild(o)),e.pos+=t,e.trailingSpace=!1}function ct(e,t,i){this.line=t,this.rest=function(e){for(var t,i;t=we(e);)e=t.find(1,!0).line,(i=i||[]).push(e);return i}(t),this.size=this.rest?I(A(this.rest))-i+1:1,this.node=this.text=null,this.hidden=Fe(e,t)}function ut(e,t,i){for(var a,o,s=[],n=t;n<i;n=o)o=n+(a=new ct(e.doc,S(e.doc,n),n)).size,s.push(a);return s}function D(e,t){var i,a,o,s,n=Ae(e,t);if(n.length)for(i=Array.prototype.slice.call(arguments,2),us?a=us.delayedCallbacks:bs?a=bs:(a=bs=[],setTimeout(bt,0)),o=function(e){a.push(function(){return n[e].apply(null,i)})},s=0;s<n.length;++s)o(s)}function bt(){var e,t=bs;for(bs=null,e=0;e<t.length;++e)t[e]()}function gt(e,t,i,a){for(var o,s,n,r=0;r<t.changes.length;r++){o=t.changes[r];if("text"==o)h=e,s=t,n=void 0,d=void 0,n=s.text.className,d=ft(h,s),s.text==s.node&&(s.node=d.pre),s.text.parentNode.replaceChild(d.pre,s.text),s.text=d.pre,d.bgClass!=s.bgClass||d.textClass!=s.textClass?(s.bgClass=d.bgClass,s.textClass=d.textClass,Dt(h,s)):n&&(s.text.className=n);else if("gutter"==o)yt(e,t,i,a);else if("class"==o)Dt(e,t);else if("widget"==o){d=void 0;l=void 0;h=void 0;p=void 0;c=void 0;var d=e;var l=t;var h=a;l.alignable&&(l.alignable=null);for(var p=l.node.firstChild,c=void 0;p;p=c)c=p.nextSibling,"CodeMirror-linewidget"==p.className&&l.node.removeChild(p);Bt(d,l,h)}}t.changes=null}function mt(e){return e.node==e.text&&(e.node=T("div",null,null,"position: relative"),e.text.parentNode&&e.text.parentNode.replaceChild(e.node,e.text),e.node.appendChild(e.text),E)&&M<8&&(e.node.style.zIndex=2),e.node}function ft(e,t){var i=e.display.externalMeasured;return i&&i.line==t.line?(e.display.externalMeasured=null,t.measure=i.measure,i.built):dt(e,t)}function Dt(e,t){e=e,(o=(i=t).bgClass?i.bgClass+" "+(i.line.bgClass||""):i.line.bgClass)&&(o+=" CodeMirror-linebackground"),i.background?o?i.background.className=o:(i.background.parentNode.removeChild(i.background),i.background=null):o&&(a=mt(i),i.background=a.insertBefore(T("div",null,o),a.firstChild),e.display.input.setUneditable(i.background)),t.line.wrapClass?mt(t).className=t.line.wrapClass:t.node!=t.text&&(t.node.className="");var i,a,o=t.textClass?t.textClass+" "+(t.line.textClass||""):t.line.textClass;t.text.className=o||""}function yt(e,t,i,a){var o,s,n,r,d,l;if(t.gutter&&(t.node.removeChild(t.gutter),t.gutter=null),t.gutterBackground&&(t.node.removeChild(t.gutterBackground),t.gutterBackground=null),t.line.gutterClass&&(s=mt(t),t.gutterBackground=T("div",null,"CodeMirror-gutter-background "+t.line.gutterClass,"left: "+(e.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px; width: "+a.gutterTotalWidth+"px"),e.display.input.setUneditable(t.gutterBackground),s.insertBefore(t.gutterBackground,t.text)),o=t.line.gutterMarkers,(e.options.lineNumbers||o)&&(s=mt(t),n=t.gutter=T("div",null,"CodeMirror-gutter-wrapper","left: "+(e.options.fixedGutter?a.fixedPos:-a.gutterTotalWidth)+"px"),e.display.input.setUneditable(n),s.insertBefore(n,t.text),t.line.gutterClass&&(n.className+=" "+t.line.gutterClass),!e.options.lineNumbers||o&&o["CodeMirror-linenumbers"]||(t.lineNumber=n.appendChild(T("div",de(e.options,i),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+a.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+e.display.lineNumInnerWidth+"px"))),o))for(r=0;r<e.options.gutters.length;++r)d=e.options.gutters[r],(l=o.hasOwnProperty(d)&&o[d])&&n.appendChild(T("div",[l],"CodeMirror-gutter-elt","left: "+a.gutterLeft[d]+"px; width: "+a.gutterWidth[d]+"px"))}function Bt(e,t,i){if(It(e,t.line,t,i,!0),t.rest)for(var a=0;a<t.rest.length;a++)It(e,t.rest[a],t,i,!1)}function It(e,t,i,a,o){var s,n,r,d,l;if(t.widgets)for(s=mt(i),n=0,r=t.widgets;n<r.length;++n){d=r[n],l=T("div",[d.node],"CodeMirror-linewidget"),d.handleMouseEvents||l.setAttribute("cm-ignore-events","true");{h=void 0;p=void 0;c=void 0;u=void 0;var h=d;var p=l;var c=i;var u=a;h.noHScroll&&((c.alignable||(c.alignable=[])).push(p),c=u.wrapperWidth,p.style.left=u.fixedPos+"px",h.coverGutter||(c-=u.gutterTotalWidth,p.style.paddingLeft=u.gutterTotalWidth+"px"),p.style.width=c+"px");h.coverGutter&&(p.style.zIndex=5,p.style.position="relative",h.noHScroll||(p.style.marginLeft=-u.gutterTotalWidth+"px"))}e.display.input.setUneditable(l),o&&d.above?s.insertBefore(l,i.gutter||i.text):s.appendChild(l),D(d,"redraw")}}function xt(e){var t,i;return null!=e.height?e.height:(t=e.doc.cm)?(H(document.body,e.node)||(i="position: relative;",e.coverGutter&&(i+="margin-left: -"+t.display.gutters.offsetWidth+"px;"),e.noHScroll&&(i+="width: "+t.display.wrapper.clientWidth+"px;"),f(t.display.measure,T("div",[e.node],null,i))),e.height=e.node.parentNode.offsetHeight):0}function _t(e,t){for(var i=qe(t);i!=e.wrapper;i=i.parentNode)if(!i||1==i.nodeType&&"true"==i.getAttribute("cm-ignore-events")||i.parentNode==e.sizer&&i!=e.mover)return 1}function vt(e){return e.lineSpace.offsetTop}function Ct(e){return e.mover.offsetHeight-e.lineSpace.offsetHeight}function wt(e){var t;return e.cachedPaddingH||(t=f(e.measure,T("pre","x")),t=window.getComputedStyle?window.getComputedStyle(t):t.currentStyle,t={left:parseInt(t.paddingLeft),right:parseInt(t.paddingRight)},isNaN(t.left)||isNaN(t.right)||(e.cachedPaddingH=t),t)}function Tt(e){return rn-e.display.nativeBarWidth}function St(e){return e.display.scroller.clientWidth-Tt(e)-e.display.barWidth}function kt(e){return e.display.scroller.clientHeight-Tt(e)-e.display.barHeight}function Nt(e,t,i){var a,o;if(e.line==t)return{map:e.measure.map,cache:e.measure.cache};for(a=0;a<e.rest.length;a++)if(e.rest[a]==t)return{map:e.measure.maps[a],cache:e.measure.caches[a]};for(o=0;o<e.rest.length;o++)if(I(e.rest[o])>i)return{map:e.measure.maps[o],cache:e.measure.caches[o],before:!0}}function Ft(e,t,i,a){return Ut(e,Lt(e,t),i,a)}function Ot(e,t){return t>=e.display.viewFrom&&t<e.display.viewTo?e.display.view[si(e,t)]:(e=e.display.externalMeasured)&&t>=e.lineN&&t<e.lineN+e.size?e:void 0}function Lt(e,t){var i,a,o=I(t),s=Ot(e,o);return s&&!s.text?s=null:s&&s.changes&&(gt(e,s,o,ei(e)),e.curOp.forceUpdate=!0),s||(e=e,a=I(i=Se(i=t)),(i=e.display.externalMeasured=new ct(e.doc,i,a)).lineN=a,a=i.built=dt(e,i),i.text=a.pre,f(e.display.lineMeasure,a.pre),s=i),{line:t,view:s,rect:null,map:(e=Nt(s,t,o)).map,cache:e.cache,before:e.before,hasHeights:!1}}function Ut(e,t,i,a,o){var s,n=(i=t.before?-1:i)+(a||"");if(t.cache.hasOwnProperty(n))s=t.cache[n];else{if(t.rect||(t.rect=t.view.text.getBoundingClientRect()),!t.hasHeights){var r=e,d=t.view,l=t.rect,h,p,c,u,b,g=r.options.lineWrapping,r=g&&St(r);if(!d.measure.heights||g&&d.measure.width!=r){if(h=d.measure.heights=[],g)for(d.measure.width=r,p=d.text.firstChild.getClientRects(),c=0;c<p.length-1;c++)u=p[c],b=p[c+1],2<Math.abs(u.bottom-b.bottom)&&h.push((u.bottom+b.top)/2-l.top);h.push(l.bottom-l.top)}t.hasHeights=!0}(s=function(e,t,i,a){var o,s,n=Et(t.map,i,a),r=n.node,d=n.start,l=n.end,h=n.collapse;if(3==r.nodeType){for(s=0;s<4;s++){for(;d&&Z(t.line.text.charAt(n.coverStart+d));)--d;for(;n.coverStart+l<n.coverEnd&&Z(t.line.text.charAt(n.coverStart+l));)++l;if((o=E&&M<9&&0==d&&l==n.coverEnd-n.coverStart?r.parentNode.getBoundingClientRect():function(e,t){var i,a,o=gs;if("left"==t)for(i=0;i<e.length&&(o=e[i]).left==o.right;i++);else for(a=e.length-1;0<=a&&(o=e[a]).left==o.right;a--);return o}(Yo(r,d,l).getClientRects(),a)).left||o.right||0==d)break;l=d,d-=1,h="right"}E&&M<11&&(o=function(e,t){var i;return window.screen&&null!=screen.logicalXDPI&&screen.logicalXDPI!=screen.deviceXDPI&&function(e){var t;return null!=yn?yn:(t=(e=f(e,T("span","x"))).getBoundingClientRect(),e=Yo(e,0,1).getBoundingClientRect(),yn=1<Math.abs(t.left-e.left))}(e)?(e=screen.logicalXDPI/screen.deviceXDPI,i=screen.logicalYDPI/screen.deviceYDPI,{left:t.left*e,right:t.right*e,top:t.top*i,bottom:t.bottom*i}):t}(e.display.measure,o))}else 0<d&&(h=a="right"),o=e.options.lineWrapping&&1<(i=r.getClientRects()).length?i["right"==a?i.length-1:0]:r.getBoundingClientRect();!(E&&M<9)||d||o&&(o.left||o.right)||(i=r.parentNode.getClientRects()[0],o=i?{left:i.left,right:i.left+Zt(e.display),top:i.top,bottom:i.bottom}:gs);for(var i=o.top-t.rect.top,p=o.bottom-t.rect.top,c=(i+p)/2,u=t.view.measure.heights,b=0;b<u.length-1&&!(c<u[b]);b++);var g=b?u[b-1]:0,m=u[b],g={left:("right"==h?o.right:o.left)-t.rect.left,right:("left"==h?o.left:o.right)-t.rect.left,top:g,bottom:m};return o.left||o.right||(g.bogus=!0),e.options.singleCursorHeightPerLine||(g.rtop=i,g.rbottom=p),g}(e,t,i,a)).bogus||(t.cache[n]=s)}return{left:s.left,right:s.right,top:o?s.rtop:s.top,bottom:o?s.rbottom:s.bottom}}function Et(e,t,i){for(var a,o,s,n,r,d,l=0;l<e.length;l+=3)if(r=e[l],d=e[l+1],t<r?(o=0,s=1,n="left"):t<d?s=(o=t-r)+1:(l==e.length-3||t==d&&e[l+3]>t)&&(o=(s=d-r)-1,d<=t)&&(n="right"),null!=o){if(a=e[l+2],r==d&&i==(a.insertLeft?"left":"right")&&(n=i),"left"==i&&0==o)for(;l&&e[l-2]==e[l-3]&&e[l-1].insertLeft;)a=e[2+(l-=3)],n="left";if("right"==i&&o==d-r)for(;l<e.length-3&&e[l+3]==e[l+4]&&!e[l+5].insertLeft;)a=e[(l+=3)+2],n="right";break}return{node:a,start:o,end:s,collapse:n,coverStart:r,coverEnd:d}}function Mt(e){if(e.measure&&(e.measure.cache={},e.measure.heights=null,e.rest))for(var t=0;t<e.rest.length;t++)e.measure.caches[t]={}}function At(e){e.display.externalMeasure=null,$(e.display.lineMeasure);for(var t=0;t<e.display.view.length;t++)Mt(e.display.view[t])}function Pt(e){At(e),e.display.cachedCharWidth=e.display.cachedTextHeight=e.display.cachedPaddingH=null,e.options.lineWrapping||(e.display.maxLineChanged=!0),e.display.lineNumChars=null}function Rt(){return Ys&&an?-(document.body.getBoundingClientRect().left-parseInt(getComputedStyle(document.body).marginLeft)):window.pageXOffset||(document.documentElement||document.body).scrollLeft}function Vt(){return Ys&&an?-(document.body.getBoundingClientRect().top-parseInt(getComputedStyle(document.body).marginTop)):window.pageYOffset||(document.documentElement||document.body).scrollTop}function $t(e){var t,i=0;if(e.widgets)for(t=0;t<e.widgets.length;++t)e.widgets[t].above&&(i+=xt(e.widgets[t]));return i}function Wt(e,t,i,a,o){return o||(o=$t(t),i.top+=o,i.bottom+=o),"line"==a||(a=a||"local",o=Oe(t),"local"==a?o+=vt(e.display):o-=e.display.viewOffset,"page"!=a&&"window"!=a||(o+=(t=e.display.lineSpace.getBoundingClientRect()).top+("window"==a?0:Vt()),e=t.left+("window"==a?0:Rt()),i.left+=e,i.right+=e),i.top+=o,i.bottom+=o),i}function Ht(e,t,i){var a;return"div"==i?t:(a=t.left,t=t.top,"page"==i?(a-=Rt(),t-=Vt()):"local"!=i&&i||(a+=(i=e.display.sizer.getBoundingClientRect()).left,t+=i.top),{left:a-(i=e.display.lineSpace.getBoundingClientRect()).left,top:t-i.top})}function qt(e,t,i,a,o){return Wt(e,a=a||S(e.doc,t.line),Ft(e,a,t.ch,o),i)}function zt(i,e,a,o,s,n){function r(e,t){e=Ut(i,s,e,t?"right":"left",n);return t?e.left=e.right:e.right=e.left,Wt(i,o,e,a)}function t(e,t,i){return r(i?e-1:e,1==h[t].level!=i)}o=o||S(i.doc,e.line),s=s||Lt(i,o);var d,l,h=Me(o,i.doc.direction),p=e.ch,e=e.sticky;return p>=o.text.length?(p=o.text.length,e="before"):p<=0&&(p=0,e="after"),h?(l=Ee(h,p,e),d=os,l=t(p,l,"before"==e),null!=d&&(l.other=t(p,d,"before"!=e)),l):r("before"==e?p-1:p,"before"==e)}function jt(e,t){var i=0;return t=N(e.doc,t),{left:i=e.options.lineWrapping?i:Zt(e.display)*t.ch,right:i,top:t=Oe(i=S(e.doc,t.line))+vt(e.display),bottom:t+i.height}}function Gt(e,t,i,a,o){e=k(e,t,i);return e.xRel=o,a&&(e.outside=!0),e}function Qt(e,t,i){var a,o,s,n=e.doc;if((i+=e.display.viewOffset)<0)return Gt(n.first,0,null,!0,-1);if(a=ne(n,i),(o=n.first+n.size-1)<a)return Gt(n.first+n.size-1,S(n,o).text.length,null,!0,1);for(t<0&&(t=0),s=S(n,a);;){var r=function(i,e,t,a,o){o-=Oe(e);var s,n,r=Lt(i,e),d=$t(e),l=0,h=e.text.length,p=!0,c=Me(e,i.doc.direction),u=(c&&(c=(i.options.lineWrapping?function(e,t,i,a,o,s,n){var r,d,l,h,n=Jt(e,t,a,n),p=n.begin,c=n.end;for(/\s/.test(t.text.charAt(c-1))&&c--,d=r=null,l=0;l<o.length;l++){var u;(h=o[l]).from>=c||h.to<=p||(u=1!=h.level,u=Ut(e,a,u?Math.min(c,h.to)-1:Math.max(p,h.from)).right,u=u<s?s-u+1e9:u-s,(!r||u<d)&&(r=h,d=u))}return r=(r=(r=r||o[o.length-1]).from<p?{from:p,to:r.to,level:r.level}:r).to>c?{from:r.from,to:c,level:r.level}:r}:function(i,a,o,s,n,r,d){var e,t=te(function(e){var e=n[e],t=1!=e.level;return Kt(zt(i,k(o,t?e.to:e.from,t?"before":"after"),"line",a,s),r,d,!0)},0,n.length-1),l=n[t];return 0<t&&(e=1!=l.level,Kt(e=zt(i,k(o,e?l.from:l.to,e?"after":"before"),"line",a,s),r,d,!0))&&e.top>d&&(l=n[t-1]),l})(i,e,t,r,c,a,o),p=1!=c.level,l=p?c.from:c.to-1,h=p?c.to:c.from-1),null),b=null,c=te(function(e){var t=Ut(i,r,e);return t.top+=d,t.bottom+=d,Kt(t,a,o,!1)&&(t.top<=o&&t.left<=a&&(u=e,b=t),1)},l,h),g=!1;return b?(s=a-b.left<b.right-a,c=u+((n=s==p)?0:1),n=n?"after":"before",s=s?b.left:b.right):(p||c!=h&&c!=l||c++,n=0==c||c!=e.text.length&&Ut(i,r,c-(p?1:0)).bottom+d<=o==p?"after":"before",h=zt(i,k(t,c,n),"line",e,r),s=h.left,g=o<h.top||o>=h.bottom),c=ee(e.text,c,1),Gt(t,c,n,g,a-s)}(e,s,a,t,i),d=we(s),l=d&&d.find(0,!0);if(!d||!(r.ch>l.from.ch||r.ch==l.from.ch&&0<r.xRel))return r;a=I(s=l.to.line)}}function Jt(t,e,i,a){a-=$t(e);var e=e.text.length,o=te(function(e){return Ut(t,i,e-1).bottom<=a},e,0);return{begin:o,end:te(function(e){return Ut(t,i,e).top>a},o,e)}}function Yt(e,t,i,a){return Jt(e,t,i=i||Lt(e,t),Wt(e,t,Ut(e,i,a),"line").top)}function Kt(e,t,i,a){return!(e.bottom<=i)&&(e.top>i||(a?e.left:e.right)>t)}function Xt(e){var t,i;if(null!=e.cachedTextHeight)return e.cachedTextHeight;if(null==ms){for(ms=T("pre"),t=0;t<49;++t)ms.appendChild(document.createTextNode("x")),ms.appendChild(T("br"));ms.appendChild(document.createTextNode("x"))}return f(e.measure,ms),3<(i=ms.offsetHeight/50)&&(e.cachedTextHeight=i),$(e.measure),i||1}function Zt(e){var t,i;return null!=e.cachedCharWidth?e.cachedCharWidth:(i=T("span","xxxxxxxxxx"),t=T("pre",[i]),f(e.measure,t),2<(i=((t=i.getBoundingClientRect()).right-t.left)/10)&&(e.cachedCharWidth=i),i||10)}function ei(e){for(var t=e.display,i={},a={},o=t.gutters.clientLeft,s=t.gutters.firstChild,n=0;s;s=s.nextSibling,++n)i[e.options.gutters[n]]=s.offsetLeft+s.clientLeft+o,a[e.options.gutters[n]]=s.clientWidth;return{fixedPos:ti(t),gutterTotalWidth:t.gutters.offsetWidth,gutterLeft:i,gutterWidth:a,wrapperWidth:t.wrapper.clientWidth}}function ti(e){return e.scroller.getBoundingClientRect().left-e.sizer.getBoundingClientRect().left}function ii(a){var o=Xt(a.display),s=a.options.lineWrapping,n=s&&Math.max(5,a.display.scroller.clientWidth/Zt(a.display)-3);return function(e){var t,i;if(Fe(a.doc,e))return 0;if(t=0,e.widgets)for(i=0;i<e.widgets.length;i++)e.widgets[i].height&&(t+=e.widgets[i].height);return s?t+(Math.ceil(e.text.length/n)||1)*o:t+o}}function ai(e){var t=e.doc,i=ii(e);t.iter(function(e){var t=i(e);t!=e.height&&se(e,t)})}function oi(e,t,i,a){var o,s,n=e.display;if(!i&&"true"==qe(t).getAttribute("cm-not-content"))return null;i=n.lineSpace.getBoundingClientRect();try{o=t.clientX-i.left,s=t.clientY-i.top}catch(t){return null}return n=Qt(e,o,s),a&&1==n.xRel&&(i=S(e.doc,n.line).text).length==n.ch&&(s=B(i,i.length,e.options.tabSize)-i.length,n=k(n.line,Math.max(0,Math.round((o-wt(e.display).left)/Zt(e.display))-s))),n}function si(e,t){var i,a;if(t>=e.display.viewTo||(t-=e.display.viewFrom)<0)return null;for(i=e.display.view,a=0;a<i.length;a++)if((t-=i[a].size)<0)return a}function ni(e){e.display.input.showSelection(e.display.input.prepareSelection())}function ri(e,t){void 0===t&&(t=!0);for(var i,a,o=e.doc,s={},n=s.cursors=document.createDocumentFragment(),r=s.selection=document.createDocumentFragment(),d=0;d<o.sel.ranges.length;d++)!t&&d==o.sel.primIndex||(i=o.sel.ranges[d]).from().line>=e.display.viewTo||i.to().line<e.display.viewFrom||(((a=i.empty())||e.options.showCursorWhenSelecting)&&di(e,i.head,n),a)||function(o,e,t){function _(e,t,i,a){t<0&&(t=0),t=Math.round(t),a=Math.round(a),n.appendChild(T("div",null,"CodeMirror-selected","position: absolute; left: "+e+"px;\n                             top: "+t+"px; width: "+(null==i?C-e:i)+"px;\n                             height: "+(a-t)+"px"))}function i(i,g,m){function f(e,t){return qt(o,k(i,e),"div",a,t)}function D(e,t,i){e=Yt(o,a,null,e),t="ltr"==t==("after"==i)?"left":"right";return f("after"==i?e.begin:e.end-(/\s/.test(a.text.charAt(e.end-1))?2:1),t)[t]}var y,B,a=S(s,i),I=a.text.length,x=Me(a,s.direction);return function(e,t,i,a){var o,s,n;if(!e)return a(t,i,"ltr",0);for(o=!1,s=0;s<e.length;++s)((n=e[s]).from<i&&n.to>t||t==i&&n.to==t)&&(a(Math.max(n.from,t),Math.min(n.to,i),1==n.level?"rtl":"ltr",s),o=!0);o||a(t,i,"ltr")}(x,g||0,null==m?I:m,function(e,t,i,a){var o,s,n,r,d,l="ltr"==i,h=f(e,l?"left":"right"),p=f(t-1,l?"right":"left"),c=null==g&&0==e,u=null==m&&t==I,b=0==a,a=!x||a==x.length-1;p.top-h.top<=3?(r=(w?c:u)&&b?v:(l?h:p).left,d=(w?u:c)&&a?C:(l?p:h).right,_(r,h.top,d-r,h.bottom)):(d=l?(o=w&&c&&b?v:h.left,s=w?C:D(e,i,"before"),n=w?v:D(t,i,"after"),w&&u&&a?C:p.right):(o=w?D(e,i,"before"):v,s=!w&&c&&b?C:h.right,n=!w&&u&&a?v:p.left,w?D(t,i,"after"):C),_(o,h.top,s-o,h.bottom),h.bottom<p.top&&_(v,h.bottom,null,p.top),_(n,p.top,d-n,p.bottom)),(!y||li(h,y)<0)&&(y=h),li(p,y)<0&&(y=p),(!B||li(h,B)<0)&&(B=h),li(p,B)<0&&(B=p)}),{start:y,end:B}}var a=o.display,s=o.doc,n=document.createDocumentFragment(),r=wt(o.display),v=r.left,C=Math.max(a.sizerWidth,St(o)-a.sizer.offsetLeft)-r.right,w="ltr"==s.direction,a=e.from(),r=e.to();{var d;a.line==r.line?i(a.line,a.ch,r.ch):(e=S(s,a.line),d=S(s,r.line),d=Se(e)==Se(d),a=i(a.line,a.ch,d?e.text.length+1:null).end,e=i(r.line,d?0:null,r.ch).start,d&&(a.top<e.top-2?(_(a.right,a.top,null,a.bottom),_(v,e.top,e.left,e.bottom)):_(a.right,a.top,e.left-a.right,a.bottom)),a.bottom<e.top&&_(v,a.bottom,null,e.top))}t.appendChild(n)}(e,i,r);return s}function di(e,t,i){var t=zt(e,t,"div",null,null,!e.options.singleCursorHeightPerLine),a=i.appendChild(T("div"," ","CodeMirror-cursor"));a.style.left=t.left+"px",a.style.top=t.top+"px",a.style.height=Math.max(0,t.bottom-t.top)*e.options.cursorHeight+"px",t.other&&((a=i.appendChild(T("div"," ","CodeMirror-cursor CodeMirror-secondarycursor"))).style.display="",a.style.left=t.other.left+"px",a.style.top=t.other.top+"px",a.style.height=.85*(t.other.bottom-t.other.top)+"px")}function li(e,t){return e.top-t.top||e.left-t.left}function hi(e){var t,i;e.state.focused&&(t=e.display,clearInterval(t.blinker),i=!0,t.cursorDiv.style.visibility="",0<e.options.cursorBlinkRate?t.blinker=setInterval(function(){return t.cursorDiv.style.visibility=(i=!i)?"":"hidden"},e.options.cursorBlinkRate):e.options.cursorBlinkRate<0&&(t.cursorDiv.style.visibility="hidden"))}function pi(e){e.state.focused||(e.display.input.focus(),ui(e))}function ci(e){e.state.delayingBlurEvent=!0,setTimeout(function(){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1,bi(e))},100)}function ui(e,t){e.state.delayingBlurEvent&&(e.state.delayingBlurEvent=!1),"nocursor"!=e.options.readOnly&&(e.state.focused||(F(e,"focus",e,t),e.state.focused=!0,d(e.display.wrapper,"CodeMirror-focused"),e.curOp||e.display.selForContextMenu==e.doc.sel||(e.display.input.reset(),P&&setTimeout(function(){return e.display.input.reset(!0)},20)),e.display.input.receivedFocus()),hi(e))}function bi(e,t){e.state.delayingBlurEvent||(e.state.focused&&(F(e,"blur",e,t),e.state.focused=!1,Jo(e.display.wrapper,"CodeMirror-focused")),clearInterval(e.display.blinker),setTimeout(function(){e.state.focused||(e.display.shift=!1)},150))}function gi(e){for(var t,i,a,o,s,n=e.display,r=n.lineDiv.offsetTop,d=0;d<n.view.length;d++)if(i=void 0,!(t=n.view[d]).hidden&&(E&&M<8?(i=(a=t.node.offsetTop+t.node.offsetHeight)-r,r=a):i=(a=t.node.getBoundingClientRect()).bottom-a.top,o=t.line.height-i,i<2&&(i=Xt(n)),.005<o||o<-.005)&&(se(t.line,i),mi(t.line),t.rest))for(s=0;s<t.rest.length;s++)mi(t.rest[s])}function mi(e){var t,i,a;if(e.widgets)for(t=0;t<e.widgets.length;++t)(a=(i=e.widgets[t]).node.parentNode)&&(i.height=a.offsetHeight)}function fi(e,t,i){var a,o=i&&null!=i.top?Math.max(0,i.top):e.scroller.scrollTop,o=Math.floor(o-vt(e)),s=i&&null!=i.bottom?i.bottom:o+e.wrapper.clientHeight,o=ne(t,o),s=ne(t,s);return i&&i.ensure&&(a=i.ensure.from.line,i=i.ensure.to.line,a<o?s=ne(t,Oe(S(t,o=a))+e.wrapper.clientHeight):Math.min(i,t.lastLine())>=s&&(o=ne(t,Oe(S(t,i))-e.wrapper.clientHeight),s=i)),{from:o,to:Math.max(s,o+1)}}function Di(e){var t,i,a=e.display,o=a.view;if(a.alignWidgets||a.gutters.firstChild&&e.options.fixedGutter){for(var s=ti(a)-a.scroller.scrollLeft+e.doc.scrollLeft,n=a.gutters.offsetWidth,r=s+"px",d=0;d<o.length;d++)if(!o[d].hidden&&(e.options.fixedGutter&&(o[d].gutter&&(o[d].gutter.style.left=r),o[d].gutterBackground)&&(o[d].gutterBackground.style.left=r),t=o[d].alignable))for(i=0;i<t.length;i++)t[i].style.left=r;e.options.fixedGutter&&(a.gutters.style.left=s+n+"px")}}function yi(e){var t,i,a,o;if(e.options.lineNumbers)return t=e.doc,t=de(e.options,t.first+t.size-1),i=e.display,t.length!=i.lineNumChars?(a=(o=i.measure.appendChild(T("div",[T("div",t)],"CodeMirror-linenumber CodeMirror-gutter-elt"))).firstChild.offsetWidth,o=o.offsetWidth-a,i.lineGutter.style.width="",i.lineNumInnerWidth=Math.max(a,i.lineGutter.offsetWidth-o)+1,i.lineNumWidth=i.lineNumInnerWidth+o,i.lineNumChars=i.lineNumInnerWidth?t.length:-1,i.lineGutter.style.width=i.lineNumWidth+"px",qi(e),1):void 0}function Bi(e,t){var i=e.display,a=Xt(e.display),o=(t.top<0&&(t.top=0),(e.curOp&&null!=e.curOp.scrollTop?e.curOp:i.scroller).scrollTop),s=kt(e),n={},r=(t.bottom-t.top>s&&(t.bottom=t.top+s),e.doc.height+Ct(i)),d=t.top<a,a=t.bottom>r-a,a=(t.top<o?n.scrollTop=d?0:t.top:t.bottom>o+s&&(d=Math.min(t.top,(a?r:t.bottom)-s))!=o&&(n.scrollTop=d),(e.curOp&&null!=e.curOp.scrollLeft?e.curOp:i.scroller).scrollLeft),r=St(e)-(e.options.fixedGutter?i.gutters.offsetWidth:0),s=t.right-t.left>r;return s&&(t.right=t.left+r),t.left<10?n.scrollLeft=0:t.left<a?n.scrollLeft=Math.max(0,t.left-(s?0:10)):t.right>r+a-3&&(n.scrollLeft=t.right+(s?0:10)-r),n}function Ii(e,t){null!=t&&(vi(e),e.curOp.scrollTop=(null==e.curOp.scrollTop?e.doc:e.curOp).scrollTop+t)}function xi(e){vi(e);var t=e.getCursor();e.curOp.scrollToPos={from:t,to:t,margin:e.options.cursorScrollMargin}}function _i(e,t,i){null==t&&null==i||vi(e),null!=t&&(e.curOp.scrollLeft=t),null!=i&&(e.curOp.scrollTop=i)}function vi(e){var t=e.curOp.scrollToPos;t&&(e.curOp.scrollToPos=null,Ci(e,jt(e,t.from),jt(e,t.to),t.margin))}function Ci(e,t,i,a){t=Bi(e,{left:Math.min(t.left,i.left),top:Math.min(t.top,i.top)-a,right:Math.max(t.right,i.right),bottom:Math.max(t.bottom,i.bottom)+a});_i(e,t.scrollLeft,t.scrollTop)}function wi(e,t){Math.abs(e.doc.scrollTop-t)<2||(Qs||Hi(e,{top:t}),Ti(e,t,!0),Qs&&Hi(e),Ri(e,100))}function Ti(e,t,i){t=Math.min(e.display.scroller.scrollHeight-e.display.scroller.clientHeight,t),e.display.scroller.scrollTop==t&&!i||(e.doc.scrollTop=t,e.display.scrollbars.setScrollTop(t),e.display.scroller.scrollTop==t)||(e.display.scroller.scrollTop=t)}function Si(e,t,i,a){t=Math.min(t,e.display.scroller.scrollWidth-e.display.scroller.clientWidth),(i?t==e.doc.scrollLeft:Math.abs(e.doc.scrollLeft-t)<2)&&!a||(e.doc.scrollLeft=t,Di(e),e.display.scroller.scrollLeft!=t&&(e.display.scroller.scrollLeft=t),e.display.scrollbars.setScrollLeft(t))}function ki(e){var t=e.display,i=t.gutters.offsetWidth,a=Math.round(e.doc.height+Ct(e.display));return{clientHeight:t.scroller.clientHeight,viewHeight:t.wrapper.clientHeight,scrollWidth:t.scroller.scrollWidth,clientWidth:t.scroller.clientWidth,viewWidth:t.wrapper.clientWidth,barLeft:e.options.fixedGutter?i:0,docHeight:a,scrollHeight:a+Tt(e)+t.barHeight,nativeBarWidth:t.nativeBarWidth,gutterWidth:i}}function Ni(e,t){var i,a,o;for(t=t||ki(e),i=e.display.barWidth,a=e.display.barHeight,Fi(e,t),o=0;o<4&&i!=e.display.barWidth||a!=e.display.barHeight;o++)i!=e.display.barWidth&&e.options.lineWrapping&&gi(e),Fi(e,ki(e)),i=e.display.barWidth,a=e.display.barHeight}function Fi(e,t){var i=e.display,a=i.scrollbars.update(t);i.sizer.style.paddingRight=(i.barWidth=a.right)+"px",i.sizer.style.paddingBottom=(i.barHeight=a.bottom)+"px",i.heightForcer.style.borderBottom=a.bottom+"px solid transparent",a.right&&a.bottom?(i.scrollbarFiller.style.display="block",i.scrollbarFiller.style.height=a.bottom+"px",i.scrollbarFiller.style.width=a.right+"px"):i.scrollbarFiller.style.display="",a.bottom&&e.options.coverGutterNextToScrollbar&&e.options.fixedGutter?(i.gutterFiller.style.display="block",i.gutterFiller.style.height=a.bottom+"px",i.gutterFiller.style.width=t.gutterWidth+"px"):i.gutterFiller.style.display=""}function Oi(i){i.display.scrollbars&&(i.display.scrollbars.clear(),i.display.scrollbars.addClass)&&Jo(i.display.wrapper,i.display.scrollbars.addClass),i.display.scrollbars=new fs[i.options.scrollbarStyle](function(e){i.display.wrapper.insertBefore(e,i.display.scrollbarFiller),V(e,"mousedown",function(){i.state.focused&&setTimeout(function(){return i.display.input.focus()},0)}),e.setAttribute("cm-not-content","true")},function(e,t){("horizontal"==t?Si:wi)(i,e)},i),i.display.scrollbars.addClass&&d(i.display.wrapper,i.display.scrollbars.addClass)}function Li(e){e.curOp={cm:e,viewChanged:!1,startHeight:e.doc.height,forceUpdate:!1,updateInput:null,typing:!1,changeObjs:null,cursorActivityHandlers:null,cursorActivityCalled:0,selectionChanged:!1,updateMaxLine:!1,scrollLeft:null,scrollTop:null,scrollToPos:null,focus:!1,id:++Ds},e=e.curOp,us?us.ops.push(e):e.ownsGroup=us={ops:[e],delayedCallbacks:[]}}function Ui(e){var e=e.curOp,t=function(e){for(var t=0;t<e.ops.length;t++)e.ops[t].cm.curOp=null;for(var i,a,o,s,n=e.ops,r=0;r<n.length;r++){h=l=d=void 0;var d=n[r],l=d.cm,h=l.display;(function(e){var t=e.display;!t.scrollbarsClipped&&t.scroller.offsetWidth&&(t.nativeBarWidth=t.scroller.offsetWidth-t.scroller.clientWidth,t.heightForcer.style.height=Tt(e)+"px",t.sizer.style.marginBottom=-t.nativeBarWidth+"px",t.sizer.style.borderRightWidth=Tt(e)+"px",t.scrollbarsClipped=!0)})(l),d.updateMaxLine&&Ue(l),d.mustUpdate=d.viewChanged||d.forceUpdate||null!=d.scrollTop||d.scrollToPos&&(d.scrollToPos.from.line<h.viewFrom||d.scrollToPos.to.line>=h.viewTo)||h.maxLineChanged&&l.options.lineWrapping,d.update=d.mustUpdate&&new ys(l,d.mustUpdate&&{top:d.scrollTop,ensure:d.scrollToPos},d.forceUpdate)}for(i=0;i<n.length;i++){p=void 0;var p=n[i];p.updatedDisplay=p.mustUpdate&&$i(p.cm,p.update)}for(a=0;a<n.length;a++){c=void 0;u=void 0;b=void 0;var c=n[a];var u=c.cm,b=u.display;c.updatedDisplay&&gi(u),c.barMeasure=ki(u),b.maxLineChanged&&!u.options.lineWrapping&&(c.adjustWidthTo=Ft(u,b.maxLine,b.maxLine.text.length).left+3,u.display.sizerWidth=c.adjustWidthTo,c.barMeasure.scrollWidth=Math.max(b.scroller.clientWidth,b.sizer.offsetLeft+c.adjustWidthTo+Tt(u)+u.display.barWidth),c.maxScrollLeft=Math.max(0,b.sizer.offsetLeft+c.adjustWidthTo-St(u))),(c.updatedDisplay||c.selectionChanged)&&(c.preparedSelection=b.input.prepareSelection())}for(o=0;o<n.length;o++){g=void 0;f=void 0;m=void 0;var g=n[o];var m,f=g.cm;null!=g.adjustWidthTo&&(f.display.sizer.style.minWidth=g.adjustWidthTo+"px",g.maxScrollLeft<f.doc.scrollLeft&&Si(f,Math.min(f.display.scroller.scrollLeft,g.maxScrollLeft),!0),f.display.maxLineChanged=!1),m=g.focus&&g.focus==q(),g.preparedSelection&&f.display.input.showSelection(g.preparedSelection,m),!g.updatedDisplay&&g.startHeight==f.doc.height||Ni(f,g.barMeasure),g.updatedDisplay&&zi(f,g.barMeasure),g.selectionChanged&&hi(f),f.state.focused&&g.updateInput&&f.display.input.reset(g.typing),m&&pi(g.cm)}for(s=0;s<n.length;s++){D=void 0;v=void 0;C=void 0;w=void 0;y=void 0;B=void 0;I=void 0;x=void 0;_=void 0;var D=n[s];var y,B,I,x,_,v=D.cm,C=v.display,w=v.doc;if(D.updatedDisplay&&Wi(v,D.update),null==C.wheelStartX||null==D.scrollTop&&null==D.scrollLeft&&!D.scrollToPos||(C.wheelStartX=C.wheelStartY=null),null!=D.scrollTop&&Ti(v,D.scrollTop,D.forceScroll),null!=D.scrollLeft&&Si(v,D.scrollLeft,!0,!0),D.scrollToPos&&(y=function(e,t,i,a){var o;for(null==a&&(a=0),e.options.lineWrapping||t!=i||(i="before"==(t=t.ch?k(t.line,"before"==t.sticky?t.ch-1:t.ch,"after"):t).sticky?k(t.line,t.ch+1,"before"):t),o=0;o<5;o++){var s,n=!1,r=zt(e,t),d=i&&i!=t?zt(e,i):r,r=Bi(e,s={left:Math.min(r.left,d.left),top:Math.min(r.top,d.top)-a,right:Math.max(r.left,d.left),bottom:Math.max(r.bottom,d.bottom)+a}),d=e.doc.scrollTop,l=e.doc.scrollLeft;if(null!=r.scrollTop&&(wi(e,r.scrollTop),1<Math.abs(e.doc.scrollTop-d))&&(n=!0),!(n=null!=r.scrollLeft&&(Si(e,r.scrollLeft),1<Math.abs(e.doc.scrollLeft-l))?!0:n))break}return s}(v,N(w,D.scrollToPos.from),N(w,D.scrollToPos.to),D.scrollToPos.margin),function(e,t){var i,a,o;O(e,"scrollCursorIntoView")||(a=(i=e.display).sizer.getBoundingClientRect(),o=null,t.top+a.top<0?o=!0:t.bottom+a.top>(window.innerHeight||document.documentElement.clientHeight)&&(o=!1),null==o)||en||(a=T("div","​",null,"position: absolute;\n                         top: "+(t.top-i.viewOffset-vt(e.display))+"px;\n                         height: "+(t.bottom-t.top+Tt(e)+i.barHeight)+"px;\n                         left: "+t.left+"px; width: "+Math.max(2,t.right-t.left)+"px;"),e.display.lineSpace.appendChild(a),a.scrollIntoView(o),e.display.lineSpace.removeChild(a))}(v,y)),B=D.maybeHiddenMarkers,I=D.maybeUnhiddenMarkers,B)for(x=0;x<B.length;++x)B[x].lines.length||F(B[x],"hide");if(I)for(_=0;_<I.length;++_)I[_].lines.length&&F(I[_],"unhide");C.wrapper.offsetHeight&&(w.scrollTop=v.display.scroller.scrollTop),D.changeObjs&&F(v,"changes",v,D.changeObjs),D.update&&D.update.finish()}};if(e=e.ownsGroup)try{var i,a,o=e,s=o.delayedCallbacks,n=0;do{for(;n<s.length;n++)s[n].call(null);for(i=0;i<o.ops.length;i++)if((a=o.ops[i]).cursorActivityHandlers)for(;a.cursorActivityCalled<a.cursorActivityHandlers.length;)a.cursorActivityHandlers[a.cursorActivityCalled++].call(null,a.cm)}while(n<s.length)}finally{us=null,t(e)}}function p(e,t){if(e.curOp)return t();Li(e);try{return t()}finally{Ui(e)}}function C(e,t){return function(){if(e.curOp)return t.apply(e,arguments);Li(e);try{return t.apply(e,arguments)}finally{Ui(e)}}}function e(e){return function(){if(this.curOp)return e.apply(this,arguments);Li(this);try{return e.apply(this,arguments)}finally{Ui(this)}}}function t(t){return function(){var e=this.cm;if(!e||e.curOp)return t.apply(this,arguments);Li(e);try{return t.apply(this,arguments)}finally{Ui(e)}}}function y(e,t,i,a){var o,s,n;null==t&&(t=e.doc.first),null==i&&(i=e.doc.first+e.doc.size),o=e.display,(a=a||0)&&i<o.viewTo&&(null==o.updateLineNumbers||o.updateLineNumbers>t)&&(o.updateLineNumbers=t),e.curOp.viewChanged=!0,t>=o.viewTo?as&&ke(e.doc,t)<o.viewTo&&Mi(e):i<=o.viewFrom?as&&Ne(e.doc,i+a)>o.viewFrom?Mi(e):(o.viewFrom+=a,o.viewTo+=a):t<=o.viewFrom&&i>=o.viewTo?Mi(e):t<=o.viewFrom?(n=Ai(e,i,i+a,1))?(o.view=o.view.slice(n.index),o.viewFrom=n.lineN,o.viewTo+=a):Mi(e):i>=o.viewTo?(n=Ai(e,t,t,-1))?(o.view=o.view.slice(0,n.index),o.viewTo=n.lineN):Mi(e):(n=Ai(e,t,t,-1),s=Ai(e,i,i+a,1),n&&s?(o.view=o.view.slice(0,n.index).concat(ut(e,n.lineN,s.lineN)).concat(o.view.slice(s.index)),o.viewTo+=a):Mi(e)),(n=o.externalMeasured)&&(i<n.lineN?n.lineN+=a:t<n.lineN+n.size&&(o.externalMeasured=null))}function Ei(e,t,i){var a,o;e.curOp.viewChanged=!0,o=e.display,(a=e.display.externalMeasured)&&t>=a.lineN&&t<a.lineN+a.size&&(o.externalMeasured=null),t<o.viewFrom||t>=o.viewTo||null!=(a=o.view[si(e,t)]).node&&-1==b(o=a.changes||(a.changes=[]),i)&&o.push(i)}function Mi(e){e.display.viewFrom=e.display.viewTo=e.doc.first,e.display.view=[],e.display.viewOffset=0}function Ai(e,t,i,a){var o,s,n,r=si(e,t),d=e.display.view;if(as&&i!=e.doc.first+e.doc.size){for(s=e.display.viewFrom,n=0;n<r;n++)s+=d[n].size;if(s!=t){if(0<a){if(r==d.length-1)return null;o=s+d[r].size-t,r++}else o=s-t;t+=o,i+=o}for(;ke(e.doc,i)!=i;){if(r==(a<0?0:d.length-1))return null;i+=a*d[r-(a<0?1:0)].size,r+=a}}return{index:r,lineN:i}}function Pi(e){for(var t,i=e.display.view,a=0,o=0;o<i.length;o++)(t=i[o]).hidden||t.node&&!t.changes||++a;return a}function Ri(e,t){e.doc.highlightFrontier<e.display.viewTo&&e.state.highlight.set(t,z(Vi,e))}function Vi(n){var r,d,l,h=n.doc;h.highlightFrontier>=n.display.viewTo||(r=+new Date+n.options.workTime,d=et(n,h.highlightFrontier),l=[],h.iter(d.line,Math.min(h.first+h.size,n.display.viewTo+500),function(e){var t,i;if(d.line>=n.display.viewFrom){var a=e.styles,o=e.text.length>n.options.maxHighlightLength?Je(h.mode,d.state):null,s=Xe(n,e,d,!0);for(o&&(d.state=o),e.styles=s.styles,o=e.styleClasses,(s=s.classes)?e.styleClasses=s:o&&(e.styleClasses=null),t=!a||a.length!=e.styles.length||o!=s&&(!o||!s||o.bgClass!=s.bgClass||o.textClass!=s.textClass),i=0;!t&&i<a.length;++i)t=a[i]!=e.styles[i];t&&l.push(d.line),e.stateAfter=d.save()}else e.text.length<=n.options.maxHighlightLength&&tt(n,e.text,d),e.stateAfter=d.line%5==0?d.save():null;if(d.nextLine(),+new Date>r)return Ri(n,n.options.workDelay),!0}),h.highlightFrontier=d.line,h.modeFrontier=Math.max(h.modeFrontier,d.line),l.length&&p(n,function(){for(var e=0;e<l.length;e++)Ei(n,l[e],"text")}))}function $i(e,t){var i=e.display,a=e.doc;if(t.editorIsHidden)return Mi(e),!1;if(!t.force&&t.visible.from>=i.viewFrom&&t.visible.to<=i.viewTo&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)&&i.renderedView==i.view&&0==Pi(e))return!1;yi(e)&&(Mi(e),t.dims=ei(e));var o,s=a.first+a.size,n=Math.max(t.visible.from-e.options.viewportMargin,a.first),r=Math.min(s,t.visible.to+e.options.viewportMargin);return i.viewFrom<n&&n-i.viewFrom<20&&(n=Math.max(a.first,i.viewFrom)),i.viewTo>r&&i.viewTo-r<20&&(r=Math.min(s,i.viewTo)),as&&(n=ke(e.doc,n),r=Ne(e.doc,r)),a=n!=i.viewFrom||r!=i.viewTo||i.lastWrapHeight!=t.wrapperHeight||i.lastWrapWidth!=t.wrapperWidth,s=n,n=r,0==(o=(r=e).display).view.length||s>=o.viewTo||n<=o.viewFrom?(o.view=ut(r,s,n),o.viewFrom=s):(o.viewFrom>s?o.view=ut(r,s,o.viewFrom).concat(o.view):o.viewFrom<s&&(o.view=o.view.slice(si(r,s))),o.viewFrom=s,o.viewTo<n?o.view=o.view.concat(ut(r,o.viewTo,n)):o.viewTo>n&&(o.view=o.view.slice(0,si(r,n)))),o.viewTo=n,i.viewOffset=Oe(S(e.doc,i.viewFrom)),e.display.mover.style.top=i.viewOffset+"px",s=Pi(e),!(!a&&0==s&&!t.force&&i.renderedView==i.view&&(null==i.updateLineNumbers||i.updateLineNumbers>=i.viewTo)||(r=!(r=e).hasFocus()&&(o=q())&&H(r.display.lineDiv,o)?(o={activeElt:o},window.getSelection&&(n=window.getSelection()).anchorNode&&n.extend&&H(r.display.lineDiv,n.anchorNode)&&(o.anchorNode=n.anchorNode,o.anchorOffset=n.anchorOffset,o.focusNode=n.focusNode,o.focusOffset=n.focusOffset),o):null,4<s&&(i.lineDiv.style.display="none"),function(i,e,t){function a(e){var t=e.nextSibling;return P&&sn&&i.display.currentWheelTarget==e?e.style.display="none":e.parentNode.removeChild(e),t}for(var o,s,n=i.display,r=i.options.lineNumbers,d=n.lineDiv,l=d.firstChild,h=n.view,p=n.viewFrom,c=0;c<h.length;c++){if(!(o=h[c]).hidden)if(o.node&&o.node.parentNode==d){for(;l!=o.node;)l=a(l);s=r&&null!=e&&e<=p&&o.lineNumber,o.changes&&(-1<b(o.changes,"gutter")&&(s=!1),gt(i,o,p,t)),s&&($(o.lineNumber),o.lineNumber.appendChild(document.createTextNode(de(i.options,p)))),l=o.node.nextSibling}else s=function(e,t,i,a){var o=ft(e,t);return t.text=t.node=o.pre,o.bgClass&&(t.bgClass=o.bgClass),o.textClass&&(t.textClass=o.textClass),Dt(e,t),yt(e,t,i,a),Bt(e,t,a),t.node}(i,o,p,t),d.insertBefore(s,l);p+=o.size}for(;l;)l=a(l)}(e,i.updateLineNumbers,t.dims),4<s&&(i.lineDiv.style.display=""),i.renderedView=i.view,(n=r)&&n.activeElt&&n.activeElt!=q()&&(n.activeElt.focus(),n.anchorNode)&&H(document.body,n.anchorNode)&&H(document.body,n.focusNode)&&(o=window.getSelection(),(s=document.createRange()).setEnd(n.anchorNode,n.anchorOffset),s.collapse(!1),o.removeAllRanges(),o.addRange(s),o.extend(n.focusNode,n.focusOffset)),$(i.cursorDiv),$(i.selectionDiv),i.gutters.style.height=i.sizer.style.minHeight=0,a&&(i.lastWrapHeight=t.wrapperHeight,i.lastWrapWidth=t.wrapperWidth,Ri(e,400)),i.updateLineNumbers=null))}function Wi(e,t){for(var i,a=t.viewport,o=!0;(o&&e.options.lineWrapping&&t.oldDisplayWidth!=St(e)||(a&&null!=a.top&&(a={top:Math.min(e.doc.height+Ct(e.display)-kt(e),a.top)}),t.visible=fi(e.display,e.doc,a),!(t.visible.from>=e.display.viewFrom))||!(t.visible.to<=e.display.viewTo))&&$i(e,t);o=!1)gi(e),i=ki(e),ni(e),Ni(e,i),zi(e,i),t.force=!1;t.signal(e,"update",e),e.display.viewFrom==e.display.reportedViewFrom&&e.display.viewTo==e.display.reportedViewTo||(t.signal(e,"viewportChange",e,e.display.viewFrom,e.display.viewTo),e.display.reportedViewFrom=e.display.viewFrom,e.display.reportedViewTo=e.display.viewTo)}function Hi(e,t){var i,t=new ys(e,t);$i(e,t)&&(gi(e),Wi(e,t),i=ki(e),ni(e),Ni(e,i),zi(e,i),t.finish())}function qi(e){var t=e.display.gutters.offsetWidth;e.display.sizer.style.marginLeft=t+"px"}function zi(e,t){e.display.sizer.style.minHeight=t.docHeight+"px",e.display.heightForcer.style.top=t.docHeight+"px",e.display.gutters.style.height=t.docHeight+e.display.barHeight+Tt(e)+"px"}function ji(e){var t,i,a,o=e.display.gutters,s=e.options.gutters;for($(o),t=0;t<s.length;++t)i=s[t],a=o.appendChild(T("div",null,"CodeMirror-gutter "+i)),"CodeMirror-linenumbers"==i&&((e.display.lineGutter=a).style.width=(e.display.lineNumWidth||1)+"px");o.style.display=t?"":"none",qi(e)}function Gi(e){var t=b(e.gutters,"CodeMirror-linenumbers");-1==t&&e.lineNumbers?e.gutters=e.gutters.concat(["CodeMirror-linenumbers"]):-1<t&&!e.lineNumbers&&(e.gutters=e.gutters.slice(0),e.gutters.splice(t,1))}function Qi(e){var t=e.wheelDeltaX,i=e.wheelDeltaY;return null==t&&e.detail&&e.axis==e.HORIZONTAL_AXIS&&(t=e.detail),null==i&&e.detail&&e.axis==e.VERTICAL_AXIS?i=e.detail:null==i&&(i=e.wheelDelta),{x:t,y:i}}function Ji(e){e=Qi(e);return e.x*=g,e.y*=g,e}function Yi(e,t){var i,a,o,s,n,r=Qi(t),d=r.x,r=r.y,l=e.display,h=l.scroller,p=h.scrollWidth>h.clientWidth,c=h.scrollHeight>h.clientHeight;if(d&&p||r&&c){if(r&&sn&&P)e:for(i=t.target,a=l.view;i!=h;i=i.parentNode)for(o=0;o<a.length;o++)if(a[o].node==i){e.display.currentWheelTarget=i;break e}!d||Qs||Ks||null==g?(r&&null!=g&&(p=r*g,n=(s=e.doc.scrollTop)+l.wrapper.clientHeight,p<0?s=Math.max(0,s+p-50):n=Math.min(e.doc.height,n+p+50),Hi(e,{top:s,bottom:n})),Bs<20&&(null==l.wheelStartX?(l.wheelStartX=h.scrollLeft,l.wheelStartY=h.scrollTop,l.wheelDX=d,l.wheelDY=r,setTimeout(function(){var e,t;null!=l.wheelStartX&&(e=h.scrollLeft-l.wheelStartX,t=(t=h.scrollTop-l.wheelStartY)&&l.wheelDY&&t/l.wheelDY||e&&l.wheelDX&&e/l.wheelDX,l.wheelStartX=l.wheelStartY=null,t)&&(g=(g*Bs+t)/(Bs+1),++Bs)},200)):(l.wheelDX+=d,l.wheelDY+=r))):(r&&c&&wi(e,Math.max(0,h.scrollTop+r*g)),Si(e,Math.max(0,h.scrollLeft+d*g)),r&&!c||v(t),l.wheelStartX=null)}}function Ki(e,t){var i,a=e[t];for(e.sort(function(e,t){return x(e.from(),t.from())}),t=b(e,a),i=1;i<e.length;i++){var o,s,n,r=e[i];0<=x((n=e[i-1]).to(),r.from())&&(o=ce(n.from(),r.from()),s=pe(n.to(),r.to()),r=n.empty()?r.from()==r.head:n.from()==n.head,i<=t&&--t,e.splice(--i,2,new U(r?s:o,r?o:s)))}return new L(e,t)}function Xi(e,t){return new L([new U(e,t||e)],0)}function Zi(e){return e.text?k(e.from.line+e.text.length-1,A(e.text).length+(1==e.text.length?e.from.ch:0)):e.to}function ea(e,t){var i,a;return x(e,t.from)<0?e:x(e,t.to)<=0?Zi(t):(i=e.line+t.text.length-(t.to.line-t.from.line)-1,a=e.ch,e.line==t.to.line&&(a+=Zi(t).ch-t.to.ch),k(i,a))}function ta(e,t){for(var i,a=[],o=0;o<e.sel.ranges.length;o++)i=e.sel.ranges[o],a.push(new U(ea(i.anchor,t),ea(i.head,t)));return Ki(a,e.sel.primIndex)}function ia(e,t,i){return e.line==t.line?k(i.line,e.ch-t.ch+i.ch):k(i.line+(e.line-t.line),e.ch)}function aa(e){e.doc.mode=Ge(e.options,e.doc.modeOption),oa(e)}function oa(e){e.doc.iter(function(e){e.stateAfter&&(e.stateAfter=null),e.styles&&(e.styles=null)}),e.doc.modeFrontier=e.doc.highlightFrontier=e.doc.first,Ri(e,100),e.state.modeGen++,e.curOp&&y(e)}function sa(e,t){return 0==t.from.ch&&0==t.to.ch&&""==A(t.text)&&(!e.cm||e.cm.options.wholeLineUpdateBefore)}function na(e,s,t,n){function o(e){return t?t[e]:null}function i(e,t,i){var a,o;t=t,i=i,o=n,(a=e).text=t,a.stateAfter&&(a.stateAfter=null),a.styles&&(a.styles=null),null!=a.order&&(a.order=null),ye(a),Be(a,i),(t=o?o(a):1)!=a.height&&se(a,t),D(e,"change",e,s)}function a(e,t){for(var i=[],a=e;a<t;++a)i.push(new hs(h[a],o(a),n));return i}var r,d=s.from,l=s.to,h=s.text,p=S(e,d.line),c=S(e,l.line),u=A(h),b=o(h.length-1),g=l.line-d.line;s.full?(e.insert(0,a(0,h.length)),e.remove(h.length,e.size-h.length)):sa(e,s)?(r=a(0,h.length-1),i(c,c.text,b),g&&e.remove(d.line,g),r.length&&e.insert(d.line,r)):p==c?1==h.length?i(p,p.text.slice(0,d.ch)+u+p.text.slice(l.ch),b):((r=a(1,h.length-1)).push(new hs(u+p.text.slice(l.ch),b,n)),i(p,p.text.slice(0,d.ch)+h[0],o(0)),e.insert(d.line+1,r)):1==h.length?(i(p,p.text.slice(0,d.ch)+h[0]+c.text.slice(l.ch),o(0)),e.remove(d.line+1,g)):(i(p,p.text.slice(0,d.ch)+h[0],o(0)),i(c,u+c.text.slice(l.ch),b),r=a(1,h.length-1),1<g&&e.remove(d.line+1,g-1),e.insert(d.line+1,r)),D(e,"change",e,s)}function ra(e,r,d){!function e(t,i,a){var o,s,n;if(t.linked)for(o=0;o<t.linked.length;++o)(s=t.linked[o]).doc!=i&&(n=a&&s.sharedHist,!d||n)&&(r(s.doc,n),e(s.doc,t,n))}(e,null,!0)}function da(e,t){if(t.cm)throw new Error("This document is already in use.");ai((e.doc=t).cm=e),aa(e),la(e),e.options.lineWrapping||Ue(e),e.options.mode=t.modeOption,y(e)}function la(e){("rtl"==e.doc.direction?d:Jo)(e.display.lineDiv,"CodeMirror-rtl")}function ha(e){this.done=[],this.undone=[],this.undoDepth=1/0,this.lastModTime=this.lastSelTime=0,this.lastOp=this.lastSelOp=null,this.lastOrigin=this.lastSelOrigin=null,this.generation=this.maxGeneration=e||1}function pa(e,t){var i={from:he(t.from),to:Zi(t),text:ae(e,t.from,t.to)};return ma(e,i,t.from.line,t.to.line+1),ra(e,function(e){return ma(e,i,t.from.line,t.to.line+1)},!0),i}function ca(e){for(;e.length;){if(!A(e).ranges)break;e.pop()}}function ua(e,t,i,a){var o,s,n,r,d=e.history;if(d.undone.length=0,o=+new Date,(d.lastOp==a||d.lastOrigin==t.origin&&t.origin&&("+"==t.origin.charAt(0)&&e.cm&&d.lastModTime>o-e.cm.options.historyEventDelay||"*"==t.origin.charAt(0)))&&(r=(r=d).lastOp==a?(ca(r.done),A(r.done)):r.done.length&&!A(r.done).ranges?A(r.done):1<r.done.length&&!r.done[r.done.length-2].ranges?(r.done.pop(),A(r.done)):void 0))s=A(r.changes),0==x(t.from,t.to)&&0==x(t.from,s.to)?s.to=Zi(t):r.changes.push(pa(e,t));else for((n=A(d.done))&&n.ranges||ga(e.sel,d.done),r={changes:[pa(e,t)],generation:d.generation},d.done.push(r);d.done.length>d.undoDepth;)d.done.shift(),d.done[0].ranges||d.done.shift();d.done.push(i),d.generation=++d.maxGeneration,d.lastModTime=d.lastSelTime=o,d.lastOp=d.lastSelOp=a,d.lastOrigin=d.lastSelOrigin=t.origin,s||F(e,"historyAdded")}function ba(e,t,i,a){var o,s,n,r=e.history,d=a&&a.origin;i==r.lastSelOp||d&&r.lastSelOrigin==d&&(r.lastModTime==r.lastSelTime&&r.lastOrigin==d||(e=e,o=d,s=A(r.done),n=t,"*"==(o=o.charAt(0)))||"+"==o&&s.ranges.length==n.ranges.length&&s.somethingSelected()==n.somethingSelected()&&new Date-e.history.lastSelTime<=(e.cm?e.cm.options.historyEventDelay:500))?r.done[r.done.length-1]=t:ga(t,r.done),r.lastSelTime=+new Date,r.lastSelOrigin=d,r.lastSelOp=i,a&&!1!==a.clearRedo&&ca(r.undone)}function ga(e,t){var i=A(t);i&&i.ranges&&i.equals(e)||t.push(e)}function ma(t,i,e,a){var o=i["spans_"+t.id],s=0;t.iter(Math.max(t.first,e),Math.min(t.first+t.size,a),function(e){e.markedSpans&&((o=o||(i["spans_"+t.id]={}))[s]=e.markedSpans),++s})}function fa(e,t){var i,a,o=t["spans_"+e.id];if(!o)return null;for(i=[],a=0;a<t.text.length;++a)i.push(function(e){var t,i;if(!e)return null;for(i=0;i<e.length;++i)e[i].marker.explicitlyCleared?t=t||e.slice(0,i):t&&t.push(e[i]);return t?t.length?t:null:e}(o[a]));return i}function Da(e,t){var i,a,o,s,n,r,d=fa(e,t),l=fe(e,t);if(!d)return l;if(l)for(i=0;i<d.length;++i)if(a=d[i],o=l[i],a&&o)e:for(s=0;s<o.length;++s){for(n=o[s],r=0;r<a.length;++r)if(a[r].marker==n.marker)continue e;a.push(n)}else o&&(d[i]=o);return d}function ya(e,t,i){for(var a,o,s,n,r,d,l,h=[],p=0;p<e.length;++p)if((a=e[p]).ranges)h.push(i?L.prototype.deepCopy.call(a):a);else for(o=a.changes,h.push({changes:s=[]}),n=0;n<o.length;++n)if(r=o[n],s.push({from:r.from,to:r.to,text:r.text}),t)for(l in r)(d=l.match(/^spans_(\d+)$/))&&-1<b(t,Number(d[1]))&&(A(s)[l]=r[l],delete r[l]);return h}function Ba(e,t,i,a){return a?(a=e.anchor,i&&((e=x(t,a)<0)!=x(i,a)<0?(a=t,t=i):e!=x(t,i)<0&&(t=i)),new U(a,t)):new U(i||t,t)}function Ia(e,t,i,a,o){null==o&&(o=e.cm&&(e.cm.display.shift||e.extend)),w(e,new L([Ba(e.sel.primary(),t,i,o)],0),a)}function xa(e,t,i){for(var a=[],o=e.cm&&(e.cm.display.shift||e.extend),s=0;s<e.sel.ranges.length;s++)a[s]=Ba(e.sel.ranges[s],t[s],null,o);w(e,Ki(a,e.sel.primIndex),i)}function _a(e,t,i,a){var o=e.sel.ranges.slice(0);o[t]=i,w(e,Ki(o,e.sel.primIndex),a)}function va(e,t,i,a){w(e,Xi(t,i),a)}function Ca(e,t,i){var a=e.history.done,o=A(a);(o&&o.ranges?(a[a.length-1]=t,wa):w)(e,t,i)}function w(e,t,i){wa(e,t,i),ba(e,e.sel,e.cm?e.cm.curOp.id:NaN,i)}function wa(e,t,i){(Re(e,"beforeSelectionChange")||e.cm&&Re(e.cm,"beforeSelectionChange"))&&(a=e,s=i,s={ranges:(o=t).ranges,update:function(e){var t;for(this.ranges=[],t=0;t<e.length;t++)this.ranges[t]=new U(N(a,e[t].anchor),N(a,e[t].head))},origin:s&&s.origin},F(a,"beforeSelectionChange",a,s),a.cm&&F(a.cm,"beforeSelectionChange",a.cm,s),t=s.ranges!=o.ranges?Ki(s.ranges,s.ranges.length-1):o);var a,o,s=i&&i.bias||(x(t.primary().head,e.sel.primary().head)<0?-1:1);Ta(e,ka(e,t,s,!0)),i&&!1===i.scroll||!e.cm||xi(e.cm)}function Ta(e,t){t.equals(e.sel)||(e.sel=t,e.cm&&(e.cm.curOp.updateInput=e.cm.curOp.selectionChanged=!0,Pe(e.cm)),D(e,"cursorActivity",e))}function Sa(e){Ta(e,ka(e,e.sel,null,!1))}function ka(e,t,i,a){for(var o,s=0;s<t.ranges.length;s++){var n=t.ranges[s],r=t.ranges.length==e.sel.ranges.length&&e.sel.ranges[s],d=Fa(e,n.anchor,r&&r.anchor,i,a),r=Fa(e,n.head,r&&r.head,i,a);!o&&d==n.anchor&&r==n.head||((o=o||t.ranges.slice(0,s))[s]=new U(d,r))}return o?Ki(o,t.primIndex):t}function Na(e,t,i,a,o){var s,n,r,d,l=S(e,t.line);if(l.markedSpans)for(s=0;s<l.markedSpans.length;++s)if(n=(r=l.markedSpans[s]).marker,(null==r.from||(n.inclusiveLeft?r.from<=t.ch:r.from<t.ch))&&(null==r.to||(n.inclusiveRight?r.to>=t.ch:r.to>t.ch))){if(o&&(F(n,"beforeCursorEnter"),n.explicitlyCleared)){if(l.markedSpans){--s;continue}break}if(n.atomic)return i&&(r=n.find(a<0?1:-1),d=void 0,r=(a<0?n.inclusiveRight:n.inclusiveLeft)?Oa(e,r,-a,r&&r.line==t.line?l:null):r)&&r.line==t.line&&(d=x(r,i))&&(a<0?d<0:0<d)?Na(e,r,t,a,o):(d=n.find(a<0?-1:1),(d=(a<0?n.inclusiveLeft:n.inclusiveRight)?Oa(e,d,a,d.line==t.line?l:null):d)?Na(e,d,t,a,o):null);continue}return t}function Fa(e,t,i,a,o){a=a||1,o=Na(e,t,i,a,o)||!o&&Na(e,t,i,a,!0)||Na(e,t,i,-a,o)||!o&&Na(e,t,i,-a,!0);return o||(e.cantEdit=!0,k(e.first,0))}function Oa(e,t,i,a){return i<0&&0==t.ch?t.line>e.first?N(e,k(t.line-1)):null:0<i&&t.ch==(a||S(e,t.line)).text.length?t.line<e.first+e.size-1?k(t.line+1,0):null:new k(t.line,t.ch+i)}function La(e){e.setSelection(k(e.firstLine(),0),k(e.lastLine()),ln)}function Ua(o,e,t){var s={canceled:!1,from:e.from,to:e.to,text:e.text,origin:e.origin,cancel:function(){return s.canceled=!0}};return t&&(s.update=function(e,t,i,a){e&&(s.from=N(o,e)),t&&(s.to=N(o,t)),i&&(s.text=i),void 0!==a&&(s.origin=a)}),F(o,"beforeChange",o,s),o.cm&&F(o.cm,"beforeChange",o.cm,s),s.canceled?null:{from:s.from,to:s.to,text:s.text,origin:s.origin}}function Ea(e,t,i){var a,o;if(e.cm){if(!e.cm.curOp)return C(e.cm,Ea)(e,t,i);if(e.cm.state.suppressEdits)return}if(!Re(e,"beforeChange")&&(!e.cm||!Re(e.cm,"beforeChange"))||(t=Ua(e,t,!0)))if(a=is&&!i&&function(e,t,i){var a,o,s,n,r,d,l,h,p,c=null;if(e.iter(t.line,i.line+1,function(e){var t,i;if(e.markedSpans)for(t=0;t<e.markedSpans.length;++t)!(i=e.markedSpans[t].marker).readOnly||c&&-1!=b(c,i)||(c=c||[]).push(i)}),!c)return null;for(a=[{from:t,to:i}],o=0;o<c.length;++o)for(n=(s=c[o]).find(0),r=0;r<a.length;++r)x((p=a[r]).to,n.from)<0||0<x(p.from,n.to)||(d=[r,1],l=x(p.from,n.from),h=x(p.to,n.to),(l<0||!s.inclusiveLeft&&!l)&&d.push({from:p.from,to:n.from}),(0<h||!s.inclusiveRight&&!h)&&d.push({from:n.to,to:p.to}),a.splice.apply(a,d),r+=d.length-3);return a}(e,t.from,t.to))for(o=a.length-1;0<=o;--o)Ma(e,{from:a[o].from,to:a[o].to,text:o?[""]:t.text,origin:t.origin});else Ma(e,t)}function Ma(e,i){var t,a;1==i.text.length&&""==i.text[0]&&0==x(i.from,i.to)||(t=ta(e,i),ua(e,i,t,e.cm?e.cm.curOp.id:NaN),Ra(e,i,t,fe(e,i)),a=[],ra(e,function(e,t){t||-1!=b(a,e.history)||(Ha(e.history,i),a.push(e.history)),Ra(e,i,null,fe(e,i))}))}function Aa(o,s,e){var n,r,t,i,a;if(!o.cm||!o.cm.state.suppressEdits||e){for(var d,l=o.history,h=o.sel,p="undo"==s?l.done:l.undone,c="undo"==s?l.undone:l.done,u=0;u<p.length&&(d=p[u],e?!d.ranges||d.equals(o.sel):d.ranges);u++);if(u!=p.length){for(l.lastOrigin=l.lastSelOrigin=null;(d=p.pop()).ranges;){if(ga(d,c),e&&!d.equals(o.sel))return void w(o,d,{clearRedo:!1});h=d}for(n=[],ga(h,c),c.push({changes:n,generation:l.generation}),l.generation=d.generation||++l.maxGeneration,r=Re(o,"beforeChange")||o.cm&&Re(o.cm,"beforeChange"),t=function(e){var t,i,a=d.changes[e];if(a.origin=s,r&&!Ua(o,a,!1))return p.length=0,{};n.push(pa(o,a)),t=e?ta(o,a):A(p),Ra(o,a,t,Da(o,a)),!e&&o.cm&&o.cm.scrollIntoView({from:a.from,to:Zi(a)}),i=[],ra(o,function(e,t){t||-1!=b(i,e.history)||(Ha(e.history,a),i.push(e.history)),Ra(e,a,null,Da(e,a))})},i=d.changes.length-1;0<=i;--i)if(a=t(i))return a.v}}}function Pa(e,t){if(0!=t&&(e.first+=t,e.sel=new L(J(e.sel.ranges,function(e){return new U(k(e.anchor.line+t,e.anchor.ch),k(e.head.line+t,e.head.ch))}),e.sel.primIndex),e.cm)){y(e.cm,e.first,e.first-t,t);for(var i=e.cm.display,a=i.viewFrom;a<i.viewTo;a++)Ei(e.cm,a,"gutter")}}function Ra(e,t,i,a){var o,s,n,r,d,l,h,p,c,u,b,g;if(e.cm&&!e.cm.curOp)return C(e.cm,Ra)(e,t,i,a);if(t.to.line<e.first)Pa(e,t.text.length-1-(t.to.line-t.from.line));else if(!(t.from.line>e.lastLine())){if(t.from.line<e.first&&(Pa(e,o=t.text.length-1-(e.first-t.from.line)),t={from:k(e.first,0),to:k(t.to.line+o,t.to.ch),text:[A(t.text)],origin:t.origin}),o=e.lastLine(),(t=t.to.line>o?{from:t.from,to:k(o,S(e,o).text.length),text:[t.text[0]],origin:t.origin}:t).removed=ae(e,t.from,t.to),i=i||ta(e,t),e.cm){o=e.cm,s=t,n=a,r=o.doc,d=o.display,l=s.from,h=s.to,p=!1,c=l.line,o.options.lineWrapping||(c=I(Se(S(r,l.line))),r.iter(c,h.line+1,function(e){if(e==d.maxLine)return p=!0})),-1<r.sel.contains(s.from,s.to)&&Pe(o),na(r,s,n,ii(o)),o.options.lineWrapping||(r.iter(c,l.line+s.text.length,function(e){var t=Le(e);t>d.maxLineLength&&(d.maxLine=e,d.maxLineLength=t,d.maxLineChanged=!0,p=!1)}),p&&(o.curOp.updateMaxLine=!0));var m=r,f=l.line;if(m.modeFrontier=Math.min(m.modeFrontier,f),!(m.highlightFrontier<f-10)){for(u=m.first,b=f-1;u<b;b--)if((g=S(m,b).stateAfter)&&(!(g instanceof rs)||b+g.lookAhead<f)){u=b+1;break}m.highlightFrontier=Math.min(m.highlightFrontier,u)}Ri(o,400),n=s.text.length-(h.line-l.line)-1,s.full?y(o):l.line!=h.line||1!=s.text.length||sa(o.doc,s)?y(o,l.line,h.line+1,n):Ei(o,l.line,"text"),c=Re(o,"changes"),((r=Re(o,"change"))||c)&&(n={from:l,to:h,text:s.text,removed:s.removed,origin:s.origin},r&&D(o,"change",o,n),c)&&(o.curOp.changeObjs||(o.curOp.changeObjs=[])).push(n),o.display.selForContextMenu=null}else na(e,t,a);wa(e,i,ln)}}function Va(e,t,i,a,o){var s;x(a=a||i,i)<0&&(i=(s=[a,i])[0],a=s[1]),"string"==typeof t&&(t=e.splitLines(t)),Ea(e,{from:i,to:a,text:t,origin:o})}function $a(e,t,i,a){i<e.line?e.line+=a:t<e.line&&(e.line=t,e.ch=0)}function Wa(e,t,i,a){for(var o,s,n,r,d,l=0;l<e.length;++l)if(s=!0,(o=e[l]).ranges)for(o.copied||((o=e[l]=o.deepCopy()).copied=!0),n=0;n<o.ranges.length;n++)$a(o.ranges[n].anchor,t,i,a),$a(o.ranges[n].head,t,i,a);else{for(r=0;r<o.changes.length;++r)if(i<(d=o.changes[r]).from.line)d.from=k(d.from.line+a,d.from.ch),d.to=k(d.to.line+a,d.to.ch);else if(t<=d.to.line){s=!1;break}s||(e.splice(0,l+1),l=0)}}function Ha(e,t){var i=t.from.line,a=t.to.line,t=t.text.length-(a-i)-1;Wa(e.done,i,a,t),Wa(e.undone,i,a,t)}function qa(e,t,i,a){var o=t,s=t;return"number"==typeof t?s=S(e,ue(e,t)):o=I(t),null==o?null:(a(s,o)&&e.cm&&Ei(e.cm,o,i),s)}function za(e){var t,i;for(this.lines=e,this.parent=null,i=t=0;i<e.length;++i)e[i].parent=this,t+=e[i].height;this.height=t}function ja(e){var t,i,a,o;for(this.children=e,a=i=t=0;a<e.length;++a)t+=(o=e[a]).chunkSize(),i+=o.height,o.parent=this;this.size=t,this.height=i,this.parent=null}function Ga(e,t,i){Oe(t)<(e.curOp&&e.curOp.scrollTop||e.doc.scrollTop)&&Ii(e,i)}function Qa(t,i,a,e,o){var s,n,r,d,l,h,p,c,u,b,g,m,f;if(e&&e.shared)return h=t,p=i,c=a,b=o,(u=j(u=e)).shared=!1,g=[Qa(h,p,c,u,b)],m=g[0],f=u.widgetNode,ra(h,function(e){f&&(u.widgetNode=f.cloneNode(!0)),g.push(Qa(e,N(e,p),N(e,c),u,b));for(var t=0;t<e.linked.length;++t)if(e.linked[t].isParent)return;m=A(g)}),new vs(g,m);if(t.cm&&!t.cm.curOp)return C(t.cm,Qa)(t,i,a,e,o);if(s=new _s(t,o),h=x(i,a),e&&j(e,s,!1),!(0<h||0==h&&!1!==s.clearWhenEmpty)){if(s.replacedWith&&(s.collapsed=!0,s.widgetNode=W("span",[s.replacedWith],"CodeMirror-widget"),e.handleMouseEvents||s.widgetNode.setAttribute("cm-ignore-events","true"),e.insertLeft)&&(s.widgetNode.insertLeft=!0),s.collapsed){if(Te(t,i.line,i,a,s)||i.line!=a.line&&Te(t,a.line,i,a,s))throw new Error("Inserting collapsed marker partially overlapping an existing one");as=!0}if(s.addToHistory&&ua(t,{from:i,to:a,origin:"markText"},t.sel,NaN),n=i.line,r=t.cm,t.iter(n,a.line+1,function(e){var t;r&&s.collapsed&&!r.options.lineWrapping&&Se(e)==r.display.maxLine&&(d=!0),s.collapsed&&n!=i.line&&se(e,0),e=e,t=new ge(s,n==i.line?i.ch:null,n==a.line?a.ch:null),e.markedSpans=e.markedSpans?e.markedSpans.concat([t]):[t],t.marker.attachLine(e),++n}),s.collapsed&&t.iter(i.line,a.line+1,function(e){Fe(t,e)&&se(e,0)}),s.clearOnEnter&&V(s,"beforeCursorEnter",function(){return s.clear()}),s.readOnly&&(is=!0,t.history.done.length||t.history.undone.length)&&t.clearHistory(),s.collapsed&&(s.id=++xs,s.atomic=!0),r){if(d&&(r.curOp.updateMaxLine=!0),s.collapsed)y(r,i.line,a.line+1);else if(s.className||s.title||s.startStyle||s.endStyle||s.css)for(l=i.line;l<=a.line;l++)Ei(r,l,"text");s.atomic&&Sa(r.doc),D(r,"markerAdded",r,s)}}return s}function Ja(e){return e.findMarks(k(e.first,0),e.clipPos(k(e.lastLine())),function(e){return e.parent})}function Ya(e){var a,t,i,o,s,n=this;if(Ka(n),!O(n,e)&&!_t(n.display,e)&&(v(e),E&&(ws=+new Date),a=oi(n,e,!0),t=e.dataTransfer.files,a)&&!n.isReadOnly())if(t&&t.length&&window.FileReader&&window.File)for(var r=t.length,d=Array(r),l=0,h=0;h<r;++h)!function(e,t){var i;n.options.allowDropFileTypes&&-1==b(n.options.allowDropFileTypes,e.type)||((i=new FileReader).onload=C(n,function(){var e=i.result;/[\x00-\x08\x0e-\x1f]{2}/.test(e)&&(e=""),d[t]=e,++l==r&&(e={from:a=N(n.doc,a),to:a,text:n.doc.splitLines(d.join(n.doc.lineSeparator())),origin:"paste"},Ea(n.doc,e),Ca(n.doc,Xi(a,Zi(e))))}),i.readAsText(e))}(t[h],h);else if(n.state.draggingText&&-1<n.doc.sel.contains(a))n.state.draggingText(e),setTimeout(function(){return n.display.input.focus()},20);else try{if(i=e.dataTransfer.getData("Text")){if(n.state.draggingText&&!n.state.draggingText.copy&&(o=n.listSelections()),wa(n.doc,Xi(a,a)),o)for(s=0;s<o.length;++s)Va(n.doc,"",o[s].anchor,o[s].head,"drag");n.replaceSelection(i,"around","paste"),n.display.input.focus()}}catch(e){}}function Ka(e){e.display.dragCursor&&(e.display.lineSpace.removeChild(e.display.dragCursor),e.display.dragCursor=null)}function Xa(e){var t,i,a;if(document.getElementsByClassName)for(t=document.getElementsByClassName("CodeMirror"),i=0;i<t.length;i++)(a=t[i].CodeMirror)&&e(a)}function Za(){var e;Ts||(V(window,"resize",function(){null==e&&(e=setTimeout(function(){e=null,Xa(eo)},100))}),V(window,"blur",function(){return Xa(bi)}),Ts=!0)}function eo(e){var t=e.display;t.lastWrapHeight==t.wrapper.clientHeight&&t.lastWrapWidth==t.wrapper.clientWidth||(t.cachedCharWidth=t.cachedTextHeight=t.cachedPaddingH=null,t.scrollbarsClipped=!1,e.setSize())}function to(e){var t,i,a,o,s,n,r=e.split(/-(?!$)/);for(e=r[r.length-1],s=0;s<r.length-1;s++)if(n=r[s],/^(cmd|meta|m)$/i.test(n))o=!0;else if(/^a(lt)?$/i.test(n))t=!0;else if(/^(c|ctrl|control)$/i.test(n))i=!0;else{if(!/^s(hift)?$/i.test(n))throw new Error("Unrecognized modifier name: "+n);a=!0}return t&&(e="Alt-"+e),i&&(e="Ctrl-"+e),o&&(e="Cmd-"+e),e=a?"Shift-"+e:e}function io(e){var t,i,a,o,s,n,r,d,l={};for(t in e)if(e.hasOwnProperty(t)){if(i=e[t],/^(name|fallthrough|(de|at)tach)$/.test(t))continue;if("..."==i){delete e[t];continue}for(a=J(t.split(" "),to),o=0;o<a.length;o++)if(n=s=void 0,s=o==a.length-1?(n=a.join(" "),i):(n=a.slice(0,o+1).join(" "),"..."),r=l[n]){if(r!=s)throw new Error("Inconsistent bindings for "+n)}else l[n]=s;delete e[t]}for(d in l)e[d]=l[d];return e}function ao(e,t,i,a){var o,s,n;if(!1===(o=(t=ro(t)).call?t.call(e,a):t[e]))return"nothing";if("..."===o)return"multi";if(null!=o&&i(o))return"handled";if(t.fallthrough){if("[object Array]"!=Object.prototype.toString.call(t.fallthrough))return ao(e,t.fallthrough,i,a);for(s=0;s<t.fallthrough.length;s++)if(n=ao(e,t.fallthrough[s],i,a))return n}}function oo(e){e="string"==typeof e?e:Ss[e.keyCode];return"Ctrl"==e||"Alt"==e||"Shift"==e||"Mod"==e}function so(e,t,i){var a=e;return t.altKey&&"Alt"!=a&&(e="Alt-"+e),(Go?t.metaKey:t.ctrlKey)&&"Ctrl"!=a&&(e="Ctrl-"+e),(Go?t.ctrlKey:t.metaKey)&&"Cmd"!=a&&(e="Cmd-"+e),e=!i&&t.shiftKey&&"Shift"!=a?"Shift-"+e:e}function no(e,t){var i;return!(Ks&&34==e.keyCode&&e.char||null==(i=Ss[e.keyCode])||e.altGraphKey)&&so(i,e,t)}function ro(e){return"string"==typeof e?Os[e]:e}function lo(t,e){for(var i,a,o=t.doc.sel.ranges,s=[],n=0;n<o.length;n++){for(i=e(o[n]);s.length&&x(i.from,A(s).to)<=0;)if(x((a=s.pop()).from,i.from)<0){i.from=a.from;break}s.push(i)}p(t,function(){for(var e=s.length-1;0<=e;e--)Va(t.doc,"",s[e].from,s[e].to,"+delete");xi(t)})}function ho(e,t,i){t=ee(e.text,t+i,i);return t<0||t>e.text.length?null:t}function po(e,t,i){e=ho(e,t.ch,i);return null==e?null:new k(t.line,e,i<0?"after":"before")}function co(e,t,i,a,o){var s,n,r,d;return e&&(e=Me(i,t.doc.direction))?(r=o<0==(1==(e=o<0?A(e):e[0]).level)?"after":"before",0<e.level||"rtl"==t.doc.direction?(s=Lt(t,i),d=o<0?i.text.length-1:0,n=Ut(t,s,d).top,d=te(function(e){return Ut(t,s,e).top==n},o<0==(1==e.level)?e.from:e.to-1,d),"before"==r&&(d=ho(i,d,1))):d=o<0?e.to:e.from,new k(a,d,r)):new k(a,o<0?i.text.length:0,o<0?"before":"after")}function uo(t,i,n,e){var a,o,s,r,d,l,h,p,c=Me(i,t.doc.direction);return!c||(n.ch>=i.text.length?(n.ch=i.text.length,n.sticky="before"):n.ch<=0&&(n.ch=0,n.sticky="after"),r=Ee(c,n.ch,n.sticky),s=c[r],"ltr"==t.doc.direction&&s.level%2==0&&(0<e?s.to>n.ch:s.from<n.ch))?po(i,n,e):(d=function(e,t){return ho(i,e instanceof k?e.ch:e,t)},p=(h=function(e){return t.options.lineWrapping?(l=l||Lt(t,i),Yt(t,i,l,e)):{begin:0,end:i.text.length}})("before"==n.sticky?d(n,-1):n.ch),"rtl"!=t.doc.direction&&1!=s.level||(a=1==s.level==e<0,null==(o=d(n,a?1:-1)))||!(a?o<=s.to&&o<=p.end:o>=s.from&&o>=p.begin)?(r=(s=function(e,t,i){for(;0<=e&&e<c.length;e+=t){var a=c[e],o=0<t==(1!=a.level),s=o?i.begin:d(i.end,-1);if(a.from<=s&&s<a.to||(s=o?a.from:d(a.to,-1),i.begin<=s&&s<i.end))return a=s,o?new k(n.line,d(a,1),"before"):new k(n.line,a,"after")}})(r+e,e,p))||(null==(p=0<e?p.end:d(p.begin,-1))||0<e&&p==i.text.length||!(r=s(0<e?0:c.length-1,e,h(p)))?null:r):new k(n.line,o,a?"before":"after"))}function bo(e,t){var i=S(e.doc,t),a=Se(i);return co(!0,e,a,t=a!=i?I(a):t,1)}function go(e,t){var i=S(e.doc,t),a=function(e){for(var t;t=we(e);)e=t.find(1,!0).line;return e}(i);return co(!0,e,i,t=a!=i?I(a):t,-1)}function mo(e,t){var i=bo(e,t.line),a=S(e.doc,i.line),e=Me(a,e.doc.direction);return e&&0!=e[0].level?i:(e=Math.max(0,a.text.search(/\S/)),a=t.line==i.line&&t.ch<=e&&t.ch,k(i.line,a?0:e,i.sticky))}function fo(e,t,i){if("string"==typeof t&&!(t=Ls[t]))return!1;e.display.input.ensurePolled();var a=e.display.shift,o=!1;try{e.isReadOnly()&&(e.state.suppressEdits=!0),i&&(e.display.shift=!1),o=t(e)!=dn}finally{e.display.shift=a,e.state.suppressEdits=!1}return o}function Do(e,t,i,a){var o=e.state.keySeq;if(o){if(oo(t))return"handled";if(/\'$/.test(t)?e.state.keySeq=null:Us.set(50,function(){e.state.keySeq==o&&(e.state.keySeq=null,e.display.input.reset())}),yo(e,o+" "+t,i,a))return!0}return yo(e,t,i,a)}function yo(e,t,i,a){a=function(e,t,i){for(var a,o=0;o<e.state.keyMaps.length;o++)if(a=ao(t,e.state.keyMaps[o],i,e))return a;return e.options.extraKeys&&ao(t,e.options.extraKeys,i,e)||ao(t,e.options.keyMap,i,e)}(e,t,a);return"multi"==a&&(e.state.keySeq=t),"handled"==a&&D(e,"keyHandled",e,t,i),"handled"!=a&&"multi"!=a||(v(i),hi(e)),!!a}function Bo(t,e){var i=no(e,!0);return!!i&&(e.shiftKey&&!t.state.keySeq?Do(t,"Shift-"+i,e,function(e){return fo(t,e,!0)})||Do(t,i,e,function(e){if("string"==typeof e?/^go[A-Z]/.test(e):e.motion)return fo(t,e)}):Do(t,i,e,function(e){return fo(t,e)}))}function Io(e){var t,i,a;function o(e){18!=e.keyCode&&e.altKey||(Jo(a,"CodeMirror-crosshair"),_(document,"keyup",o),_(document,"mouseover",o))}this.curOp.focus=q(),O(this,e)||(E&&M<11&&27==e.keyCode&&(e.returnValue=!1),t=e.keyCode,this.display.shift=16==t||e.shiftKey,i=Bo(this,e),Ks&&(Es=i?t:null,i||88!=t||Dn||!(sn?e.metaKey:e.ctrlKey)||this.replaceSelection("",null,"cut")),18!=t)||/\bCodeMirror-crosshair\b/.test(this.display.lineDiv.className)||(d(a=this.display.lineDiv,"CodeMirror-crosshair"),V(document,"keyup",o),V(document,"mouseover",o))}function xo(e){16==e.keyCode&&(this.doc.sel.shift=!1),O(this,e)}function _o(e){var t,i,a;_t(this.display,e)||O(this,e)||e.ctrlKey&&!e.altKey||sn&&e.metaKey||(i=e.keyCode,t=e.charCode,Ks&&i==Es?(Es=null,v(e)):Ks&&(!e.which||e.which<10)&&Bo(this,e)||"\b"==(i=String.fromCharCode(null==t?i:t))||Do(a=this,"'"+i+"'",e,function(e){return fo(a,e,!0)})||this.display.input.onKeyPress(e))}function vo(e){var t,i,a,o,s,n,r,d,l,h,p,c,u,b=this,g=b.display;O(b,e)||g.activeTouch&&g.input.supportsTouch()||(g.input.ensurePolled(),g.shift=e.shiftKey,_t(g,e)?P||(g.scroller.draggable=!1,setTimeout(function(){return g.scroller.draggable=!0},100)):To(b,e)||(t=oi(b,e),i=ze(e),u=t?(p=t,c=i,u=+new Date,Ps&&Ps.compare(u,p,c)?(As=Ps=null,"triple"):As&&As.compare(u,p,c)?(Ps=new Ms(u,p,c),As=null,"double"):(As=new Ms(u,p,c),Ps=null,"single")):"single",window.focus(),1==i&&b.state.selectingText&&b.state.selectingText(e),t&&(h=t,p="Click","double"==(c=u)?p="Double"+p:"triple"==c&&(p="Triple"+p),Do(d=b,so(p=(1==(l=i)?"Left":2==l?"Middle":"Right")+p,e),e,function(e){if(!(e="string"==typeof e?Ls[e]:e))return!1;var t=!1;try{d.isReadOnly()&&(d.state.suppressEdits=!0),t=e(d,h)!=dn}finally{d.state.suppressEdits=!1}return t})))||(1==i?t?(l=b,a=t,o=u,s=e,E?setTimeout(z(pi,l),0):l.curOp.focus=q(),n=function(e,t,i){var a,o=e.getOption("configureMouse"),o=o?o(e,t,i):{};return null==o.unit&&(a=nn?i.shiftKey&&i.metaKey:i.altKey,o.unit=a?"rectangle":"single"==t?"char":"double"==t?"word":"line"),null!=o.extend&&!e.doc.extend||(o.extend=e.doc.extend||i.shiftKey),null==o.addNew&&(o.addNew=sn?i.metaKey:i.ctrlKey),null==o.moveOnDrag&&(o.moveOnDrag=!(sn?i.altKey:i.ctrlKey)),o}(l,o,s),r=l.doc.sel,(l.options.dragDrop&&gn&&!l.isReadOnly()&&"single"==o&&-1<(o=r.contains(a))&&(x((o=r.ranges[o]).from(),a)<0||0<a.xRel)&&(0<x(o.to(),a)||a.xRel<0)?function(t,i,a,o){var s=t.display,n=!1,r=C(t,function(e){P&&(s.scroller.draggable=!1),t.state.draggingText=!1,_(document,"mouseup",r),_(document,"mousemove",d),_(s.scroller,"dragstart",l),_(s.scroller,"drop",r),n||(v(e),o.addNew||Ia(t.doc,a,null,null,o.extend),P||E&&9==M?setTimeout(function(){document.body.focus(),s.input.focus()},20):s.input.focus())}),d=function(e){n=n||10<=Math.abs(i.clientX-e.clientX)+Math.abs(i.clientY-e.clientY)},l=function(){return n=!0};P&&(s.scroller.draggable=!0),(t.state.draggingText=r).copy=!o.moveOnDrag,s.scroller.dragDrop&&s.scroller.dragDrop(),V(document,"mouseup",r),V(document,"mousemove",d),V(s.scroller,"dragstart",l),V(s.scroller,"drop",r),ci(t),setTimeout(function(){return s.input.focus()},20)}:function(c,e,u,b){function n(e){var t,i;if(0!=x(D,e))if(D=e,"rectangle"==b.unit){for(var a=[],o=c.options.tabSize,s=B(S(y,u.line).text,u.ch,o),n=B(S(y,e.line).text,e.ch,o),r=Math.min(s,n),d=Math.max(s,n),l=Math.min(u.line,e.line),h=Math.min(c.lastLine(),Math.max(u.line,e.line));l<=h;l++)i=G(t=S(y,l).text,r,o),r==d?a.push(new U(k(l,i),k(l,i))):t.length>i&&a.push(new U(k(l,i),k(l,G(t,d,o))));a.length||a.push(new U(u,u)),w(y,Ki(f.ranges.slice(0,m).concat(a),m),{origin:"*mouse",scroll:!1}),c.scrollIntoView(e)}else{var p,s=g,n=Co(c,e,b.unit),e=s.anchor,e=0<x(n.anchor,e)?(p=n.head,ce(s.from(),n.anchor)):(p=n.anchor,pe(s.to(),n.head));(s=f.ranges.slice(0))[m]=function(e,t){var i,a,o=t.anchor,s=t.head,n=S(e.doc,o.line);if(0==x(o,s)&&o.sticky==s.sticky||!(d=Me(n))||(a=Ee(d,o.ch,o.sticky),(r=d[a]).from!=o.ch&&r.to!=o.ch)||(0==(i=a+(r.from==o.ch==(1!=r.level)?0:1))||i==d.length))return t;a=s.line!=o.line?0<(s.line-o.line)*("ltr"==e.doc.direction?1:-1):(n=Ee(d,s.ch,s.sticky),e=n-a||(s.ch-o.ch)*(1==r.level?-1:1),n==i-1||n==i?e<0:0<e);var r=d[i+(a?-1:0)],n=a==(1==r.level),e=n?r.from:r.to,d=n?"after":"before";return o.ch==e&&o.sticky==d?t:new U(new k(o.line,e,d),s)}(c,new U(N(y,e),p)),w(y,Ki(s,m),hn)}}function t(e){c.state.selectingText=!1,d=1/0,v(e),l.input.focus(),_(document,"mousemove",a),_(document,"mouseup",o),y.history.lastSelOrigin=null}var g,m,f,i,D,r,d,a,o,l=c.display,y=c.doc;v(e),f=y.sel,i=f.ranges,b.addNew&&!b.extend?(m=y.sel.contains(u),g=-1<m?i[m]:new U(u,u)):(g=y.sel.primary(),m=y.sel.primIndex),"rectangle"==b.unit?(b.addNew||(g=new U(u,u)),u=oi(c,e,!0,!0),m=-1):(e=Co(c,u,b.unit),g=b.extend?Ba(g,e.anchor,e.head,b.extend):e),b.addNew?-1==m?(m=i.length,w(y,Ki(i.concat([g]),m),{scroll:!1,origin:"*mouse"})):1<i.length&&i[m].empty()&&"char"==b.unit&&!b.extend?(w(y,Ki(i.slice(0,m).concat(i.slice(m+1)),0),{scroll:!1,origin:"*mouse"}),f=y.sel):_a(y,m,g,hn):(w(y,new L([g],m=0),hn),f=y.sel),D=u,r=l.wrapper.getBoundingClientRect(),d=0,a=C(c,function(e){(ze(e)?function e(t){var i,a,o=++d,s=oi(c,t,!0,"rectangle"==b.unit);s&&(0!=x(s,D)?(c.curOp.focus=q(),n(s),i=fi(l,y),(s.line>=i.to||s.line<i.from)&&setTimeout(C(c,function(){d==o&&e(t)}),150)):(a=t.clientY<r.top?-20:t.clientY>r.bottom?20:0)&&setTimeout(C(c,function(){d==o&&(l.scroller.scrollTop+=a,e(t))}),50))}:t)(e)}),o=C(c,t),c.state.selectingText=o,V(document,"mousemove",a),V(document,"mouseup",o)})(l,s,a,n)):qe(e)==g.scroller&&v(e):2==i?(t&&Ia(b.doc,t),setTimeout(function(){return g.input.focus()},20)):3==i&&(Qo?So(b,e):ci(b))))}function Co(e,t,i){return"char"==i?new U(t,t):"word"==i?e.findWordAt(t):"line"==i?new U(k(t.line,0),N(e.doc,k(t.line+1,0))):(i=i(e,t),new U(i.from,i.to))}function wo(e,t,i,a){var o,s,n,r,d;if(t.touches)o=t.touches[0].clientX,s=t.touches[0].clientY;else try{o=t.clientX,s=t.clientY}catch(t){return!1}if(o>=Math.floor(e.display.gutters.getBoundingClientRect().right))return!1;if(a&&v(t),s>(a=(n=e.display).lineDiv.getBoundingClientRect()).bottom||!Re(e,i))return We(t);for(s-=a.top-n.viewOffset,r=0;r<e.options.gutters.length;++r)if((d=n.gutters.childNodes[r])&&d.getBoundingClientRect().right>=o)return F(e,i,e,ne(e.doc,s),e.options.gutters[r],t),We(t)}function To(e,t){return wo(e,t,"gutterClick",!0)}function So(e,t){var i,a;_t(e.display,t)||(a=t,Re(i=e,"gutterContextMenu")&&wo(i,a,"gutterContextMenu",!1))||O(e,t,"contextmenu")||e.display.input.onContextMenu(t)}function ko(e){e.display.wrapper.className=e.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+e.options.theme.replace(/(^|\s)\s*/g," cm-s-"),Pt(e)}function No(e){ji(e),y(e),Di(e)}function Fo(e,t,i){!t!=!(i&&i!=Sn)&&(i=e.display.dragFunctions,(t=t?V:_)(e.display.scroller,"dragstart",i.start),t(e.display.scroller,"dragenter",i.enter),t(e.display.scroller,"dragover",i.over),t(e.display.scroller,"dragleave",i.leave),t(e.display.scroller,"drop",i.drop))}function Oo(e){e.options.lineWrapping?(d(e.display.wrapper,"CodeMirror-wrap"),e.display.sizer.style.minWidth="",e.display.sizerWidth=null):(Jo(e.display.wrapper,"CodeMirror-wrap"),Ue(e)),ai(e),y(e),Pt(e),setTimeout(function(){return Ni(e)},100)}function u(e,t){var i,a,o,s,n,r,d,l,h=this;if(!(this instanceof u))return new u(e,t);function p(){l.activeTouch&&(n=setTimeout(function(){return l.activeTouch=null},1e3),(r=l.activeTouch).end=+new Date)}function c(e,t){var i;return null==t.left||400<(i=t.left-e.left)*i+(i=t.top-e.top)*i}for(a in this.options=t=t?j(t):{},j(kn,t,!1),Gi(t),"string"==typeof(i=t.value)&&(i=new m(i,t.mode,null,t.lineSeparator,t.direction)),this.doc=i,d=new u.inputStyles[t.inputStyle](this),ji((e=this.display=new ie(e,i,d)).wrapper.CodeMirror=this),ko(this),t.lineWrapping&&(this.display.wrapper.className+=" CodeMirror-wrap"),Oi(this),this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:!1,delayingBlurEvent:!1,focused:!1,suppressEdits:!1,pasteIncoming:!1,cutIncoming:!1,selectingText:!1,draggingText:!1,highlight:new Xo,keySeq:null,specialChars:null},t.autofocus&&!on&&e.input.focus(),E&&M<11&&setTimeout(function(){return h.display.input.reset(!0)},20),l=(s=this).display,V(l.scroller,"mousedown",C(s,vo)),V(l.scroller,"dblclick",E&&M<11?C(s,function(e){var t;O(s,e)||!(t=oi(s,e))||To(s,e)||_t(s.display,e)||(v(e),e=s.findWordAt(t),Ia(s.doc,e.anchor,e.head))}):function(e){return O(s,e)||v(e)}),Qo||V(l.scroller,"contextmenu",function(e){return So(s,e)}),r={end:0},V(l.scroller,"touchstart",function(e){var t;O(s,e)||function(e){if(1==e.touches.length)return(e=e.touches[0]).radiusX<=1&&e.radiusY<=1}(e)||To(s,e)||(l.input.ensurePolled(),clearTimeout(n),t=+new Date,l.activeTouch={start:t,moved:!1,prev:t-r.end<=300?r:null},1==e.touches.length&&(l.activeTouch.left=e.touches[0].pageX,l.activeTouch.top=e.touches[0].pageY))}),V(l.scroller,"touchmove",function(){l.activeTouch&&(l.activeTouch.moved=!0)}),V(l.scroller,"touchend",function(e){var t,i=l.activeTouch;i&&!_t(l,e)&&null!=i.left&&!i.moved&&new Date-i.start<300&&(t=s.coordsChar(l.activeTouch,"page"),i=!i.prev||c(i,i.prev)?new U(t,t):!i.prev.prev||c(i,i.prev.prev)?s.findWordAt(t):new U(k(t.line,0),N(s.doc,k(t.line+1,0))),s.setSelection(i.anchor,i.head),s.focus(),v(e)),p()}),V(l.scroller,"touchcancel",p),V(l.scroller,"scroll",function(){l.scroller.clientHeight&&(wi(s,l.scroller.scrollTop),Si(s,l.scroller.scrollLeft,!0),F(s,"scroll",s))}),V(l.scroller,"mousewheel",function(e){return Yi(s,e)}),V(l.scroller,"DOMMouseScroll",function(e){return Yi(s,e)}),V(l.wrapper,"scroll",function(){return l.wrapper.scrollTop=l.wrapper.scrollLeft=0}),l.dragFunctions={enter:function(e){O(s,e)||He(e)},over:function(e){var t,i;O(s,e)||((i=oi(t=s,i=e))&&(di(t,i,i=document.createDocumentFragment()),t.display.dragCursor||(t.display.dragCursor=T("div",null,"CodeMirror-cursors CodeMirror-dragcursors"),t.display.lineSpace.insertBefore(t.display.dragCursor,t.display.cursorDiv)),f(t.display.dragCursor,i)),He(e))},start:function(e){var t,i;t=s,e=e,E&&(!t.state.draggingText||+new Date-ws<100)?He(e):O(t,e)||_t(t.display,e)||(e.dataTransfer.setData("Text",t.getSelection()),e.dataTransfer.effectAllowed="copyMove",!e.dataTransfer.setDragImage)||Xs||((i=T("img",null,null,"position: fixed; left: 0; top: 0;")).src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==",Ks&&(i.width=i.height=1,t.display.wrapper.appendChild(i),i._top=i.offsetTop),e.dataTransfer.setDragImage(i,0,0),Ks&&i.parentNode.removeChild(i))},drop:C(s,Ya),leave:function(e){O(s,e)||Ka(s)}},d=l.input.getField(),V(d,"keyup",function(e){return xo.call(s,e)}),V(d,"keydown",C(s,Io)),V(d,"keypress",C(s,_o)),V(d,"focus",function(e){return ui(s,e)}),V(d,"blur",function(e){return bi(s,e)}),Za(),Li(this),this.curOp.forceUpdate=!0,da(this,i),t.autofocus&&!on||this.hasFocus()?setTimeout(z(ui,this),20):bi(this),Nn)Nn.hasOwnProperty(a)&&Nn[a](h,t[a],Sn);for(yi(this),t.finishInit&&t.finishInit(this),o=0;o<Rs.length;++o)Rs[o](h);Ui(this),P&&t.lineWrapping&&"optimizelegibility"==getComputedStyle(e.lineDiv).textRendering&&(e.lineDiv.style.textRendering="auto")}function Lo(e,t,i,a){var o,s,n,r,d,l,h,p,c=e.doc,u=("smart"==(i=null==i?"add":i)&&(c.mode.indent?o=et(e,t).state:i="prev"),e.options.tabSize),b=S(c,t),g=B(b.text,null,u);if(b.stateAfter&&(b.stateAfter=null),s=b.text.match(/^\s*/)[0],a||/\S/.test(b.text)){if("smart"==i&&((n=c.mode.indent(o,b.text.slice(s.length),b.text))==dn||150<n)){if(!a)return;i="prev"}}else n=0,i="not";if("prev"==i?n=t>c.first?B(S(c,t-1).text,null,u):0:"add"==i?n=g+e.options.indentUnit:"subtract"==i?n=g-e.options.indentUnit:"number"==typeof i&&(n=g+i),n=Math.max(0,n),r="",d=0,e.options.indentWithTabs)for(l=Math.floor(n/u);l;--l)d+=u,r+="\t";if(d<n&&(r+=Q(n-d)),r!=s)return Va(c,r,k(t,0),k(t,s.length),"+input"),!(b.stateAfter=null);for(h=0;h<c.sel.ranges.length;h++)if((p=c.sel.ranges[h]).head.line==t&&p.head.ch<s.length){p=k(t,s.length),_a(c,h,new U(p,p));break}}function Uo(e){Vs=e}function Eo(e,t,i,a,o){var s,n,r,d=e.doc,l=(e.display.shift=!1,a=a||d.sel,e.state.pasteIncoming||"paste"==o),h=mn(t),p=null;if(l&&1<a.ranges.length)if(Vs&&Vs.text.join("\n")==t){if(a.ranges.length%Vs.text.length==0)for(p=[],s=0;s<Vs.text.length;s++)p.push(d.splitLines(Vs.text[s]))}else h.length==a.ranges.length&&e.options.pasteLinesPerSelection&&(p=J(h,function(e){return[e]}));for(r=a.ranges.length-1;0<=r;r--){var c=a.ranges[r],u=c.from(),b=c.to();c.empty()&&(i&&0<i?u=k(u.line,u.ch-i):e.state.overwrite&&!l?b=k(b.line,Math.min(S(d,b.line).text.length,b.ch+A(h).length)):Vs&&Vs.lineWise&&Vs.text.join("\n")==t&&(u=b=k(u.line,0))),n=e.curOp.updateInput,c={from:u,to:b,text:p?p[r%p.length]:h,origin:o||(l?"paste":e.state.cutIncoming?"cut":"+input")},Ea(e.doc,c),D(e,"inputRead",e,c)}t&&!l&&Ao(e,t),xi(e),e.curOp.updateInput=n,e.curOp.typing=!0,e.state.pasteIncoming=e.state.cutIncoming=!1}function Mo(e,t){var i=e.clipboardData&&e.clipboardData.getData("Text");return i&&(e.preventDefault(),t.isReadOnly()||t.options.disableInput||p(t,function(){return Eo(t,i,0,null,"paste")}),1)}function Ao(e,t){var i,a,o,s,n,r;if(e.options.electricChars&&e.options.smartIndent)for(a=(i=e.doc.sel).ranges.length-1;0<=a;a--)if(!(100<(o=i.ranges[a]).head.ch||a&&i.ranges[a-1].head.line==o.head.line)){if(n=!1,(s=e.getModeAt(o.head)).electricChars){for(r=0;r<s.electricChars.length;r++)if(-1<t.indexOf(s.electricChars.charAt(r))){n=Lo(e,o.head.line,"smart");break}}else s.electricInput&&s.electricInput.test(S(e.doc,o.head.line).text.slice(0,o.head.ch))&&(n=Lo(e,o.head.line,"smart"));n&&D(e,"electricInput",e,o.head.line)}}function Po(e){for(var t,i=[],a=[],o=0;o<e.doc.sel.ranges.length;o++)t={anchor:k(t=e.doc.sel.ranges[o].head.line,0),head:k(t+1,0)},a.push(t),i.push(e.getRange(t.anchor,t.head));return{text:i,ranges:a}}function Ro(e,t){e.setAttribute("autocorrect","off"),e.setAttribute("autocapitalize","off"),e.setAttribute("spellcheck",!!t)}function Vo(){var e=T("textarea",null,null,"position: absolute; bottom: -1em; padding: 0; width: 1px; height: 1em; outline: none"),t=T("div",[e],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");return P?e.style.width="1000px":e.setAttribute("wrap","off"),tn&&(e.style.border="1px solid black"),Ro(e),t}function $o(i,a,o,e,s){function t(e){var t=s?uo(i.cm,l,a,o):po(l,a,o);if(null==t){if(e||(e=a.line+o)<i.first||e>=i.first+i.size||(a=new k(e,a.ch,a.sticky),!(l=S(i,e))))return;a=co(s,i.cm,l,a.line,o)}else a=t;return 1}var n,r=a,d=o,l=S(i,a.line);if("char"==e)t();else if("column"==e)t(!0);else if("word"==e||"group"==e)for(var h=null,p="group"==e,c=i.cm&&i.cm.getHelper(a,"wordChars"),u=!0;!(o<0)||t(!u);u=!1){if(n=K(n=l.text.charAt(a.ch)||"\n",c)?"w":p&&"\n"==n?"n":!p||/\s/.test(n)?null:"p",p&&!u&&(n=n||"s"),h&&h!=n){o<0&&(o=1,t(),a.sticky="after");break}if(n&&(h=n),0<o&&!t(!u))break}return le(r,e=Fa(i,a,r,d,!0))&&(e.hitSide=!0),e}function Wo(e,t,i,a){var o,s,n,r=e.doc,d=t.left;for("page"==a?(s=Math.min(e.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight),s=Math.max(s-.5*Xt(e.display),3),o=(0<i?t.bottom:t.top)+i*s):"line"==a&&(o=0<i?t.bottom+3:t.top-3);(n=Qt(e,d,o)).outside;){if(i<0?o<=0:o>=r.height){n.hitSide=!0;break}o+=5*i}return n}function Ho(e,t){var i,a,o=Ot(e,t.line);return!o||o.hidden?null:(i=Nt(o,o=S(e.doc,t.line),t.line),a="left",(o=Me(o,e.doc.direction))&&(a=Ee(o,t.ch)%2?"right":"left"),(e=Et(i.map,t.ch,a)).offset="right"==e.collapse?e.end:e.start,e)}function qo(e,t){return t&&(e.bad=!0),e}function zo(s,e,t,n,r){function d(){h&&(i+=p,h=!1)}function l(e){e&&(d(),i+=e)}for(var i="",h=!1,p=s.doc.lineSeparator();function e(t){var i,a,o;if(1==t.nodeType){if(null!=(i=t.getAttribute("cm-text")))l(i||t.textContent.replace(/\u200b/g,""));else if(i=t.getAttribute("cm-marker"))(i=s.findMarks(k(n,0),k(r+1,0),(o=+i,function(e){return e.id==o}))).length&&(i=i[0].find(0))&&l(ae(s.doc,i.from,i.to).join(p));else if("false"!=t.getAttribute("contenteditable")){for((i=/^(pre|div|p)$/i.test(t.nodeName))&&d(),a=0;a<t.childNodes.length;a++)e(t.childNodes[a]);i&&(h=!0)}}else 3==t.nodeType&&l(t.nodeValue)}(e),e!=t;)e=e.nextSibling;return i}function jo(e,t,i){var a,o;if(t==e.display.lineDiv){if(!(a=e.display.lineDiv.childNodes[i]))return qo(e.clipPos(k(e.display.viewTo-1)),!0);t=null,i=0}else for(a=t;;a=a.parentNode){if(!a||a==e.display.lineDiv)return null;if(a.parentNode&&a.parentNode==e.display.lineDiv)break}for(o=0;o<e.display.view.length;o++)if((s=e.display.view[o]).node==a){var l=s;var s=t;var n=i;function r(e,t,i){for(var a,o,s,n,r,d=-1;d<(c?c.length:0);d++)for(a=d<0?p.map:c[d],o=0;o<a.length;o+=3)if((s=a[o+2])==e||s==t)return n=I(d<0?l.line:l.rest[d]),r=a[o]+i,k(n,r=i<0||s!=e?a[o+(i?1:0)]:r)}var d,h,p,c,u,b,g,m,f,D=l.text.firstChild,y=!1;if(!s||!H(D,s))return qo(k(I(l.line),0),!0);if(s==D&&(y=!0,s=D.childNodes[n],n=0,!s))return qo(k(I(d=l.rest?A(l.rest):l.line),d.text.length),y);for(d=3==s.nodeType?s:null,h=s,d||1!=s.childNodes.length||3!=s.firstChild.nodeType||(d=s.firstChild,n=n&&d.nodeValue.length);h.parentNode!=D;)h=h.parentNode;if(p=l.measure,c=p.maps,u=r(d,h,n))return qo(u,y);for(b=h.nextSibling,g=d?d.nodeValue.length-n:0;b;b=b.nextSibling){if(u=r(b,b.firstChild,0))return qo(k(u.line,u.ch-g),y);g+=b.textContent.length}for(m=h.previousSibling,f=n;m;m=m.previousSibling){if(u=r(m,m.firstChild,-1))return qo(k(u.line,u.ch+f),y);f+=m.textContent.length}return}}var Go,Qo,Jo,Yo,Ko,Xo,Zo,es,ts,is,as,os,ss,ns,rs,ds,ls,hs,ps,cs,us,bs,gs,ms,fs,Ds,ys,Bs,g,L,U,Is,xs,_s,vs,Cs,m,ws,Ts,Ss,ks,Ns,Fs,Os,Ls,Us,Es,Ms,As,Ps,Rs,Vs,$s,Ws,Hs,qs,zs,js,Gs,i=navigator.userAgent,a=navigator.platform,Qs=/gecko\/\d/i.test(i),o=/MSIE \d/.test(i),Js=/Trident\/(?:[7-9]|\d{2,})\..*rv:(\d+)/.exec(i),s=/Edge\/(\d+)/.exec(i),E=o||Js||s,M=E&&(o?document.documentMode||6:+(s||Js)[1]),P=!s&&/WebKit\//.test(i),o=P&&/Qt\/\d+\.\d+/.test(i),Ys=!s&&/Chrome\//.test(i),Ks=/Opera\//.test(i),Xs=/Apple Computer/.test(navigator.vendor),Zs=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(i),en=/PhantomJS/.test(i),tn=!s&&/AppleWebKit/.test(i)&&/Mobile\/\w+/.test(i),an=/Android/.test(i),on=tn||an||/webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(i),sn=tn||/Mac/.test(a),nn=/\bCrOS\b/.test(i),Js=/win/i.test(a),s=Ks&&i.match(/Version\/(\d*\.\d*)/),rn=((s=s&&Number(s[1]))&&15<=s&&(P=!(Ks=!1)),Go=sn&&(o||Ks&&(null==s||s<12.11)),Qo=Qs||E&&9<=M,Jo=function(e,t){var i,a=e.className,t=r(t).exec(a);t&&(i=a.slice(t.index+t[0].length),e.className=a.slice(0,t.index)+(i?t[1]+i:""))},Yo=document.createRange?function(e,t,i,a){var o=document.createRange();return o.setEnd(a||e,i),o.setStart(e,t),o}:function(e,t,i){var a=document.body.createTextRange();try{a.moveToElementText(e.parentNode)}catch(e){return a}return a.collapse(!0),a.moveEnd("character",i),a.moveStart("character",t),a},Ko=function(e){e.select()},tn?Ko=function(e){e.selectionStart=0,e.selectionEnd=e.value.length}:E&&(Ko=function(e){try{e.select()}catch(e){}}),(Xo=function(){this.id=null}).prototype.set=function(e,t){clearTimeout(this.id),this.id=setTimeout(t,e)},30),dn={toString:function(){return"CodeMirror.Pass"}},ln={scroll:!1},hn={origin:"*mouse"},pn={origin:"+move"};function cn(e,t,i){this.level=e,this.from=t,this.to=i}Zo=[""],es=/[\u00df\u0587\u0590-\u05f4\u0600-\u06ff\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/,as=is=!(ts=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/),os=null,Hs=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/,qs=/[stwN]/,zs=/[LRr]/,js=/[Lb1n]/,Gs=/[1n]/;var R,un=function(e,t){var i,a,o,s,n,r,d,l,h,p,c,u,b,g,m,f,D,y,B,I,x,_,v,C,w,T,S,k,N,F,O,L="ltr"==t?"L":"R";if(0==e.length||"ltr"==t&&!Hs.test(e))return!1;for(i=e.length,a=[],o=0;o<i;++o)a.push((O=e.charCodeAt(o))<=247?"bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN".charAt(O):1424<=O&&O<=1524?"R":1536<=O&&O<=1785?"nnnnnnNNr%%r,rNNmmmmmmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmmmnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmnNmmmmmmrrmmNmmmmrr1111111111".charAt(O-1536):1774<=O&&O<=2220?"r":8192<=O&&O<=8203?"w":8204==O?"b":"L");for(s=0,n=L;s<i;++s)"m"==(r=a[s])?a[s]=n:n=r;for(d=0,l=L;d<i;++d)"1"==(h=a[d])&&"r"==l?a[d]="n":zs.test(h)&&"r"==(l=h)&&(a[d]="R");for(p=1,c=a[0];p<i-1;++p)"+"==(u=a[p])&&"1"==c&&"1"==a[p+1]?a[p]="1":","!=u||c!=a[p+1]||"1"!=c&&"n"!=c||(a[p]=c),c=u;for(b=0;b<i;++b)if(","==(g=a[b]))a[b]="N";else if("%"==g){for(m=void 0,m=b+1;m<i&&"%"==a[m];++m);for(f=b&&"!"==a[b-1]||m<i&&"1"==a[m]?"1":"N",D=b;D<m;++D)a[D]=f;b=m-1}for(y=0,B=L;y<i;++y)I=a[y],"L"==B&&"1"==I?a[y]="L":zs.test(I)&&(B=I);for(x=0;x<i;++x)if(qs.test(a[x])){for(_=void 0,_=x+1;_<i&&qs.test(a[_]);++_);for(var U="L"==(x?a[x-1]:L),M=U==("L"==(_<i?a[_]:L))?U?"L":"R":L,E=x;E<_;++E)a[E]=M;x=_-1}for(v=[],w=0;w<i;)if(js.test(a[w])){for(T=w,++w;w<i&&js.test(a[w]);++w);v.push(new cn(0,T,w))}else{for(S=w,k=v.length,++w;w<i&&"L"!=a[w];++w);for(N=S;N<w;)if(Gs.test(a[N])){for(S<N&&v.splice(k,0,new cn(1,S,N)),F=N,++N;N<w&&Gs.test(a[N]);++N);v.splice(k,0,new cn(2,F,N)),S=N}else++N;S<w&&v.splice(k,0,new cn(1,S,w))}return"ltr"==t&&(1==v[0].level&&(C=e.match(/^\s+/))&&(v[0].from=C[0].length,v.unshift(new cn(0,0,C[0].length))),1==A(v).level)&&(C=e.match(/\s+$/))&&(A(v).to-=C[0].length,v.push(new cn(0,i-C[0].length,i))),"rtl"==t?v.reverse():v},bn=[],V=function(e,t,i){e.addEventListener?e.addEventListener(t,i,!1):e.attachEvent?e.attachEvent("on"+t,i):(e=e._handlers||(e._handlers={}))[t]=(e[t]||bn).concat(i)},gn=!(E&&M<9)&&("draggable"in(a=T("div"))||"dragDrop"in a),mn=3!="\n\nb".split(/\n/).length?function(e){for(var t,i,a,o=0,s=[],n=e.length;o<=n;)-1==(t=e.indexOf("\n",o))&&(t=e.length),-1!=(a=(i=e.slice(o,"\r"==e.charAt(t-1)?t-1:t)).indexOf("\r"))?(s.push(i.slice(0,a)),o+=a+1):(s.push(i),o=t+1);return s}:function(e){return e.split(/\r\n?|\n/)},fn=window.getSelection?function(e){try{return e.selectionStart!=e.selectionEnd}catch(e){return!1}}:function(e){var t;try{t=e.ownerDocument.selection.createRange()}catch(e){}return!(!t||t.parentElement()!=e)&&0!=t.compareEndPoints("StartToEnd",t)},Dn="oncopy"in(i=T("div"))||(i.setAttribute("oncopy","return;"),"function"==typeof i.oncopy),yn=null,Bn={},In={},xn={};for((R=function(e,t,i){this.pos=this.start=0,this.string=e,this.tabSize=t||8,this.lastColumnPos=this.lastColumnValue=0,this.lineStart=0,this.lineOracle=i}).prototype.eol=function(){return this.pos>=this.string.length},R.prototype.sol=function(){return this.pos==this.lineStart},R.prototype.peek=function(){return this.string.charAt(this.pos)||void 0},R.prototype.next=function(){if(this.pos<this.string.length)return this.string.charAt(this.pos++)},R.prototype.eat=function(e){var t=this.string.charAt(this.pos);return("string"==typeof e?t==e:t&&(e.test?e.test(t):e(t)))?(++this.pos,t):void 0},R.prototype.eatWhile=function(e){for(var t=this.pos;this.eat(e););return this.pos>t},R.prototype.eatSpace=function(){for(var e=this.pos;/[\s\u00a0]/.test(this.string.charAt(this.pos));)++this.pos;return this.pos>e},R.prototype.skipToEnd=function(){this.pos=this.string.length},R.prototype.skipTo=function(e){e=this.string.indexOf(e,this.pos);if(-1<e)return this.pos=e,!0},R.prototype.backUp=function(e){this.pos-=e},R.prototype.column=function(){return this.lastColumnPos<this.start&&(this.lastColumnValue=B(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue),this.lastColumnPos=this.start),this.lastColumnValue-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},R.prototype.indentation=function(){return B(this.string,null,this.tabSize)-(this.lineStart?B(this.string,this.lineStart,this.tabSize):0)},R.prototype.match=function(e,t,i){var a;return"string"!=typeof e?(a=this.string.slice(this.pos).match(e))&&0<a.index?null:(a&&!1!==t&&(this.pos+=a[0].length),a):(a=function(e){return i?e.toLowerCase():e})(this.string.substr(this.pos,e.length))==a(e)?(!1!==t&&(this.pos+=e.length),!0):void 0},R.prototype.current=function(){return this.string.slice(this.start,this.pos)},R.prototype.hideFirstChars=function(e,t){this.lineStart+=e;try{return t()}finally{this.lineStart-=e}},R.prototype.lookAhead=function(e){var t=this.lineOracle;return t&&t.lookAhead(e)},R.prototype.baseToken=function(){var e=this.lineOracle;return e&&e.baseToken(this.pos)},rs=function(e,t){this.state=e,this.lookAhead=t},(ds=function(e,t,i,a){this.state=t,this.doc=e,this.line=i,this.maxLookAhead=a||0,this.baseTokens=null,this.baseTokenPos=1}).prototype.lookAhead=function(e){var t=this.doc.getLine(this.line+e);return null!=t&&e>this.maxLookAhead&&(this.maxLookAhead=e),t},ds.prototype.baseToken=function(e){var t;if(!this.baseTokens)return null;for(;this.baseTokens[this.baseTokenPos]<=e;)this.baseTokenPos+=2;return{type:(t=this.baseTokens[this.baseTokenPos+1])&&t.replace(/( |^)overlay .*/,""),size:this.baseTokens[this.baseTokenPos]-e}},ds.prototype.nextLine=function(){this.line++,0<this.maxLookAhead&&this.maxLookAhead--},ds.fromSaved=function(e,t,i){return t instanceof rs?new ds(e,Je(e.mode,t.state),i,t.lookAhead):new ds(e,Je(e.mode,t),i)},ds.prototype.save=function(e){e=!1!==e?Je(this.doc.mode,this.state):this.state;return 0<this.maxLookAhead?new rs(e,this.maxLookAhead):e},ls=function(e,t,i){this.start=e.start,this.end=e.pos,this.string=e.current(),this.type=t||null,this.state=i},(hs=function(e,t,i){this.text=e,Be(this,t),this.height=i?i(this):1}).prototype.lineNo=function(){return I(this)},Ve(hs),ps={},cs={},bs=us=null,gs={left:0,right:0,top:0,bottom:0},(o=function(e,t,i){this.cm=i;var a=this.vert=T("div",[T("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar"),o=this.horiz=T("div",[T("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");e(a),e(o),V(a,"scroll",function(){a.clientHeight&&t(a.scrollTop,"vertical")}),V(o,"scroll",function(){o.clientWidth&&t(o.scrollLeft,"horizontal")}),this.checkedZeroWidth=!1,E&&M<8&&(this.horiz.style.minHeight=this.vert.style.minWidth="18px")}).prototype.update=function(e){var t,i=e.scrollWidth>e.clientWidth+1,a=e.scrollHeight>e.clientHeight+1,o=e.nativeBarWidth;return a?(this.vert.style.display="block",this.vert.style.bottom=i?o+"px":"0",t=e.viewHeight-(i?o:0),this.vert.firstChild.style.height=Math.max(0,e.scrollHeight-e.clientHeight+t)+"px"):(this.vert.style.display="",this.vert.firstChild.style.height="0"),i?(this.horiz.style.display="block",this.horiz.style.right=a?o+"px":"0",this.horiz.style.left=e.barLeft+"px",t=e.viewWidth-e.barLeft-(a?o:0),this.horiz.firstChild.style.width=Math.max(0,e.scrollWidth-e.clientWidth+t)+"px"):(this.horiz.style.display="",this.horiz.firstChild.style.width="0"),!this.checkedZeroWidth&&0<e.clientHeight&&(0==o&&this.zeroWidthHack(),this.checkedZeroWidth=!0),{right:a?o:0,bottom:i?o:0}},o.prototype.setScrollLeft=function(e){this.horiz.scrollLeft!=e&&(this.horiz.scrollLeft=e),this.disableHoriz&&this.enableZeroWidthBar(this.horiz,this.disableHoriz,"horiz")},o.prototype.setScrollTop=function(e){this.vert.scrollTop!=e&&(this.vert.scrollTop=e),this.disableVert&&this.enableZeroWidthBar(this.vert,this.disableVert,"vert")},o.prototype.zeroWidthHack=function(){this.horiz.style.height=this.vert.style.width=sn&&!Zs?"12px":"18px",this.horiz.style.pointerEvents=this.vert.style.pointerEvents="none",this.disableHoriz=new Xo,this.disableVert=new Xo},o.prototype.enableZeroWidthBar=function(i,a,o){i.style.pointerEvents="auto",a.set(1e3,function e(){var t=i.getBoundingClientRect();("vert"==o?document.elementFromPoint(t.right-1,(t.top+t.bottom)/2):document.elementFromPoint((t.right+t.left)/2,t.bottom-1))!=i?i.style.pointerEvents="none":a.set(1e3,e)})},o.prototype.clear=function(){var e=this.horiz.parentNode;e.removeChild(this.horiz),e.removeChild(this.vert)},(s=function(){}).prototype.update=function(){return{bottom:0,right:0}},s.prototype.setScrollLeft=function(){},s.prototype.setScrollTop=function(){},s.prototype.clear=function(){},fs={native:o,null:s},Ds=0,(ys=function(e,t,i){var a=e.display;this.viewport=t,this.visible=fi(a,e.doc,t),this.editorIsHidden=!a.wrapper.offsetWidth,this.wrapperHeight=a.wrapper.clientHeight,this.wrapperWidth=a.wrapper.clientWidth,this.oldDisplayWidth=St(e),this.force=i,this.dims=ei(e),this.events=[]}).prototype.signal=function(e,t){Re(e,t)&&this.events.push(arguments)},ys.prototype.finish=function(){for(var e=0;e<this.events.length;e++)F.apply(null,this.events[e])},Bs=0,g=null,E?g=-.53:Qs?g=15:Ys?g=-.7:Xs&&(g=-1/3),(L=function(e,t){this.ranges=e,this.primIndex=t}).prototype.primary=function(){return this.ranges[this.primIndex]},L.prototype.equals=function(e){var t,i,a;if(e!=this){if(e.primIndex!=this.primIndex||e.ranges.length!=this.ranges.length)return!1;for(t=0;t<this.ranges.length;t++)if(i=this.ranges[t],a=e.ranges[t],!le(i.anchor,a.anchor)||!le(i.head,a.head))return!1}return!0},L.prototype.deepCopy=function(){for(var e=[],t=0;t<this.ranges.length;t++)e[t]=new U(he(this.ranges[t].anchor),he(this.ranges[t].head));return new L(e,this.primIndex)},L.prototype.somethingSelected=function(){for(var e=0;e<this.ranges.length;e++)if(!this.ranges[e].empty())return!0;return!1},L.prototype.contains=function(e,t){var i,a;for(t=t||e,i=0;i<this.ranges.length;i++)if(0<=x(t,(a=this.ranges[i]).from())&&x(e,a.to())<=0)return i;return-1},(U=function(e,t){this.anchor=e,this.head=t}).prototype.from=function(){return ce(this.anchor,this.head)},U.prototype.to=function(){return pe(this.anchor,this.head)},U.prototype.empty=function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch},za.prototype={chunkSize:function(){return this.lines.length},removeInner:function(e,t){for(var i,a,o=e,s=e+t;o<s;++o)i=this.lines[o],this.height-=i.height,(a=i).parent=null,ye(a),D(i,"delete");this.lines.splice(e,t)},collapse:function(e){e.push.apply(e,this.lines)},insertInner:function(e,t,i){var a;for(this.height+=i,this.lines=this.lines.slice(0,e).concat(t).concat(this.lines.slice(e)),a=0;a<t.length;++a)t[a].parent=this},iterN:function(e,t,i){for(var a=e+t;e<a;++e)if(i(this.lines[e]))return!0}},ja.prototype={chunkSize:function(){return this.size},removeInner:function(e,t){var i,a,o,s,n,r;for(this.size-=t,i=0;i<this.children.length;++i)if(e<(o=(a=this.children[i]).chunkSize())){if(s=Math.min(t,o-e),n=a.height,a.removeInner(e,s),this.height-=n-a.height,o==s&&(this.children.splice(i--,1),a.parent=null),0==(t-=s))break;e=0}else e-=o;this.size-t<25&&(1<this.children.length||!(this.children[0]instanceof za))&&(this.collapse(r=[]),this.children=[new za(r)],this.children[0].parent=this)},collapse:function(e){for(var t=0;t<this.children.length;++t)this.children[t].collapse(e)},insertInner:function(e,t,i){var a,o,s,n,r,d;for(this.size+=t.length,this.height+=i,a=0;a<this.children.length;++a){if(e<=(s=(o=this.children[a]).chunkSize())){if(o.insertInner(e,t,i),o.lines&&50<o.lines.length){for(r=n=o.lines.length%25+25;r<o.lines.length;)d=new za(o.lines.slice(r,r+=25)),o.height-=d.height,this.children.splice(++a,0,d),d.parent=this;o.lines=o.lines.slice(0,n),this.maybeSpill()}break}e-=s}},maybeSpill:function(){var e,t,i;if(!(this.children.length<=10)){for(e=this;t=new ja(e.children.splice(e.children.length-5,5)),e.parent?(e.size-=t.size,e.height-=t.height,i=b(e.parent.children,e),e.parent.children.splice(i+1,0,t)):(((i=new ja(e.children)).parent=e).children=[i,t],e=i),t.parent=e.parent,10<e.children.length;);e.parent.maybeSpill()}},iterN:function(e,t,i){for(var a,o,s,n=0;n<this.children.length;++n)if(e<(o=(a=this.children[n]).chunkSize())){if(s=Math.min(t,o-e),a.iterN(e,s,i))return!0;if(0==(t-=s))break;e=0}else e-=o}},(Is=function(e,t,i){if(i)for(var a in i)i.hasOwnProperty(a)&&(this[a]=i[a]);this.doc=e,this.node=t}).prototype.clear=function(){var e,t,i=this.doc.cm,a=this.line.widgets,o=this.line,s=I(o);if(null!=s&&a){for(e=0;e<a.length;++e)a[e]==this&&a.splice(e--,1);a.length||(o.widgets=null),t=xt(this),se(o,Math.max(0,o.height-t)),i&&(p(i,function(){Ga(i,o,-t),Ei(i,s,"widget")}),D(i,"lineWidgetCleared",i,this,s))}},Is.prototype.changed=function(){var e,t=this,i=this.height,a=this.doc.cm,o=this.line;this.height=null,(e=xt(this)-i)&&(se(o,o.height+e),a)&&p(a,function(){a.curOp.forceUpdate=!0,Ga(a,o,e),D(a,"lineWidgetChanged",a,t,I(o))})},Ve(Is),xs=0,(_s=function(e,t){this.lines=[],this.type=t,this.doc=e,this.id=++xs}).prototype.clear=function(){var e,t,i,a,o,s,n,r,d,l,h;if(!this.explicitlyCleared){for((t=(e=this.doc.cm)&&!e.curOp)&&Li(e),Re(this,"clear")&&(i=this.find())&&D(this,"clear",i.from,i.to),o=a=null,s=0;s<this.lines.length;++s)r=me((n=this.lines[s]).markedSpans,this),e&&!this.collapsed?Ei(e,I(n),"text"):e&&(null!=r.to&&(o=I(n)),null!=r.from)&&(a=I(n)),n.markedSpans=function(e,t){for(var i,a=0;a<e.length;++a)e[a]!=t&&(i=i||[]).push(e[a]);return i}(n.markedSpans,r),null==r.from&&this.collapsed&&!Fe(this.doc,n)&&e&&se(n,Xt(e.display));if(e&&this.collapsed&&!e.options.lineWrapping)for(d=0;d<this.lines.length;++d)(h=Le(l=Se(this.lines[d])))>e.display.maxLineLength&&(e.display.maxLine=l,e.display.maxLineLength=h,e.display.maxLineChanged=!0);null!=a&&e&&this.collapsed&&y(e,a,o+1),this.lines.length=0,this.explicitlyCleared=!0,this.atomic&&this.doc.cantEdit&&(this.doc.cantEdit=!1,e)&&Sa(e.doc),e&&D(e,"markerCleared",e,this,a,o),t&&Ui(e),this.parent&&this.parent.clear()}},_s.prototype.find=function(e,t){var i,a,o,s,n;for(null==e&&"bookmark"==this.type&&(e=1),o=0;o<this.lines.length;++o){if(null!=(n=me((s=this.lines[o]).markedSpans,this)).from&&(i=k(t?s:I(s),n.from),-1==e))return i;if(null!=n.to&&(a=k(t?s:I(s),n.to),1==e))return a}return i&&{from:i,to:a}},_s.prototype.changed=function(){var i=this,a=this.find(-1,!0),o=this,s=this.doc.cm;a&&s&&p(s,function(){var e=a.line,t=I(a.line),t=Ot(s,t);t&&(Mt(t),s.curOp.selectionChanged=s.curOp.forceUpdate=!0),s.curOp.updateMaxLine=!0,!Fe(o.doc,e)&&null!=o.height&&(t=o.height,o.height=null,t=xt(o)-t)&&se(e,e.height+t),D(s,"markerChanged",s,i)})},_s.prototype.attachLine=function(e){var t;this.lines.length||!this.doc.cm||(t=this.doc.cm.curOp).maybeHiddenMarkers&&-1!=b(t.maybeHiddenMarkers,this)||(t.maybeUnhiddenMarkers||(t.maybeUnhiddenMarkers=[])).push(this),this.lines.push(e)},_s.prototype.detachLine=function(e){this.lines.splice(b(this.lines,e),1),!this.lines.length&&this.doc.cm&&((e=this.doc.cm.curOp).maybeHiddenMarkers||(e.maybeHiddenMarkers=[])).push(this)},Ve(_s),(vs=function(e,t){var i;for(this.markers=e,this.primary=t,i=0;i<e.length;++i)e[i].parent=this}).prototype.clear=function(){var e;if(!this.explicitlyCleared){for(this.explicitlyCleared=!0,e=0;e<this.markers.length;++e)this.markers[e].clear();D(this,"clear")}},vs.prototype.find=function(e,t){return this.primary.find(e,t)},Ve(vs),Cs=0,(m=function(e,t,i,a,o){if(!(this instanceof m))return new m(e,t,i,a,o);null==i&&(i=0),ja.call(this,[new za([new hs("",null)])]),this.first=i,this.scrollTop=this.scrollLeft=0,this.cantEdit=!1,this.cleanGeneration=1;i=k(this.modeFrontier=this.highlightFrontier=i,0);this.sel=Xi(i),this.history=new ha(null),this.id=++Cs,this.modeOption=t,this.lineSep=a,this.direction="rtl"==o?"rtl":"ltr",this.extend=!1,"string"==typeof e&&(e=this.splitLines(e)),na(this,{from:i,to:i,text:e}),w(this,Xi(i),ln)}).prototype=c(ja.prototype,{constructor:m,iter:function(e,t,i){i?this.iterN(e-this.first,t-e,i):this.iterN(this.first,this.first+this.size,e)},insert:function(e,t){for(var i=0,a=0;a<t.length;++a)i+=t[a].height;this.insertInner(e-this.first,t,i)},remove:function(e,t){this.removeInner(e-this.first,t)},getValue:function(e){var t=oe(this,this.first,this.first+this.size);return!1===e?t:t.join(e||this.lineSeparator())},setValue:t(function(e){var t=k(this.first,0),i=this.first+this.size-1;Ea(this,{from:t,to:k(i,S(this,i).text.length),text:this.splitLines(e),origin:"setValue",full:!0},!0),this.cm&&_i(this.cm,0,0),w(this,Xi(t),ln)}),replaceRange:function(e,t,i,a){Va(this,e,t=N(this,t),i=i?N(this,i):t,a)},getRange:function(e,t,i){e=ae(this,N(this,e),N(this,t));return!1===i?e:e.join(i||this.lineSeparator())},getLine:function(e){e=this.getLineHandle(e);return e&&e.text},getLineHandle:function(e){if(re(this,e))return S(this,e)},getLineNumber:I,getLineHandleVisualStart:function(e){return Se(e="number"==typeof e?S(this,e):e)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(e){return N(this,e)},getCursor:function(e){var t=this.sel.primary();return null==e||"head"==e?t.head:"anchor"==e?t.anchor:"end"==e||"to"==e||!1===e?t.to():t.from()},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:t(function(e,t,i){va(this,N(this,"number"==typeof e?k(e,t||0):e),null,i)}),setSelection:t(function(e,t,i){va(this,N(this,e),N(this,t||e),i)}),extendSelection:t(function(e,t,i){Ia(this,N(this,e),t&&N(this,t),i)}),extendSelections:t(function(e,t){xa(this,be(this,e),t)}),extendSelectionsBy:t(function(e,t){xa(this,be(this,J(this.sel.ranges,e)),t)}),setSelections:t(function(e,t,i){var a,o;if(e.length){for(a=[],o=0;o<e.length;o++)a[o]=new U(N(this,e[o].anchor),N(this,e[o].head));w(this,Ki(a,t=null==t?Math.min(e.length-1,this.sel.primIndex):t),i)}}),addSelection:t(function(e,t,i){var a=this.sel.ranges.slice(0);a.push(new U(N(this,e),N(this,t||e))),w(this,Ki(a,a.length-1),i)}),getSelection:function(e){for(var t,i,a=this.sel.ranges,o=0;o<a.length;o++)t=ae(this,a[o].from(),a[o].to()),i=i?i.concat(t):t;return!1===e?i:i.join(e||this.lineSeparator())},getSelections:function(e){for(var t,i=[],a=this.sel.ranges,o=0;o<a.length;o++)t=ae(this,a[o].from(),a[o].to()),!1!==e&&(t=t.join(e||this.lineSeparator())),i[o]=t;return i},replaceSelection:function(e,t,i){for(var a=[],o=0;o<this.sel.ranges.length;o++)a[o]=e;this.replaceSelections(a,t,i||"+input")},replaceSelections:t(function(e,t,i){for(var a,o,s=[],n=this.sel,r=0;r<n.ranges.length;r++)a=n.ranges[r],s[r]={from:a.from(),to:a.to(),text:this.splitLines(e[r]),origin:i};for(t=t&&"end"!=t&&function(e,t,i){for(var a=[],o=l=k(e.first,0),s=0;s<t.length;s++){var n=t[s],r=ia(n.from,l,o),d=ia(Zi(n),l,o),l=n.to,o=d;"around"==i?(n=x((n=e.sel.ranges[s]).head,n.anchor)<0,a[s]=new U(n?d:r,n?r:d)):a[s]=new U(r,r)}return new L(a,e.sel.primIndex)}(this,s,t),o=s.length-1;0<=o;o--)Ea(this,s[o]);t?Ca(this,t):this.cm&&xi(this.cm)}),undo:t(function(){Aa(this,"undo")}),redo:t(function(){Aa(this,"redo")}),undoSelection:t(function(){Aa(this,"undo",!0)}),redoSelection:t(function(){Aa(this,"redo",!0)}),setExtending:function(e){this.extend=e},getExtending:function(){return this.extend},historySize:function(){for(var e,t=this.history,i=0,a=0,o=0;o<t.done.length;o++)t.done[o].ranges||++i;for(e=0;e<t.undone.length;e++)t.undone[e].ranges||++a;return{undo:i,redo:a}},clearHistory:function(){this.history=new ha(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(!0)},changeGeneration:function(e){return e&&(this.history.lastOp=this.history.lastSelOp=this.history.lastOrigin=null),this.history.generation},isClean:function(e){return this.history.generation==(e||this.cleanGeneration)},getHistory:function(){return{done:ya(this.history.done),undone:ya(this.history.undone)}},setHistory:function(e){var t=this.history=new ha(this.history.maxGeneration);t.done=ya(e.done.slice(0),null,!0),t.undone=ya(e.undone.slice(0),null,!0)},setGutterMarker:t(function(e,i,a){return qa(this,e,"gutter",function(e){var t=e.gutterMarkers||(e.gutterMarkers={});return!(t[i]=a)&&X(t)&&(e.gutterMarkers=null),1})}),clearGutter:t(function(t){var i=this;this.iter(function(e){e.gutterMarkers&&e.gutterMarkers[t]&&qa(i,e,"gutter",function(){return e.gutterMarkers[t]=null,X(e.gutterMarkers)&&(e.gutterMarkers=null),1})})}),lineInfo:function(e){var t;if("number"==typeof e){if(!re(this,e)||!(e=S(this,t=e)))return null}else if(null==(t=I(e)))return null;return{line:t,handle:e,text:e.text,gutterMarkers:e.gutterMarkers,textClass:e.textClass,bgClass:e.bgClass,wrapClass:e.wrapClass,widgets:e.widgets}},addLineClass:t(function(e,i,a){return qa(this,e,"gutter"==i?"gutter":"class",function(e){var t="text"==i?"textClass":"background"==i?"bgClass":"gutter"==i?"gutterClass":"wrapClass";if(e[t]){if(r(a).test(e[t]))return;e[t]+=" "+a}else e[t]=a;return 1})}),removeLineClass:t(function(e,s,n){return qa(this,e,"gutter"==s?"gutter":"class",function(e){var t,i,a="text"==s?"textClass":"background"==s?"bgClass":"gutter"==s?"gutterClass":"wrapClass",o=e[a];if(o){if(null==n)e[a]=null;else{if(!(t=o.match(r(n))))return;i=t.index+t[0].length,e[a]=o.slice(0,t.index)+(t.index&&i!=o.length?" ":"")+o.slice(i)||null}return 1}})}),addLineWidget:t(function(e,t,i){return e=e,o=new Is(a=this,t,i),(s=a.cm)&&o.noHScroll&&(s.display.alignWidgets=!0),qa(a,e,"widget",function(e){var t=e.widgets||(e.widgets=[]);return null==o.insertAt?t.push(o):t.splice(Math.min(t.length-1,Math.max(0,o.insertAt)),0,o),o.line=e,s&&!Fe(a,e)&&(t=Oe(e)<a.scrollTop,se(e,e.height+xt(o)),t&&Ii(s,o.height),s.curOp.forceUpdate=!0),1}),D(s,"lineWidgetAdded",s,o,"number"==typeof e?e:I(e)),o;var a,o,s}),removeLineWidget:function(e){e.clear()},markText:function(e,t,i){return Qa(this,N(this,e),N(this,t),i,i&&i.type||"range")},setBookmark:function(e,t){t={replacedWith:t&&(null==t.nodeType?t.widget:t),insertLeft:t&&t.insertLeft,clearWhenEmpty:!1,shared:t&&t.shared,handleMouseEvents:t&&t.handleMouseEvents};return Qa(this,e=N(this,e),e,t,"bookmark")},findMarksAt:function(e){var t,i,a,o=[];if(t=S(this,(e=N(this,e)).line).markedSpans)for(i=0;i<t.length;++i)(null==(a=t[i]).from||a.from<=e.ch)&&(null==a.to||a.to>=e.ch)&&o.push(a.marker.parent||a.marker);return o},findMarks:function(o,s,n){o=N(this,o),s=N(this,s);var r=[],d=o.line;return this.iter(o.line,s.line+1,function(e){var t,i,a=e.markedSpans;if(a)for(t=0;t<a.length;t++)null!=(i=a[t]).to&&d==o.line&&o.ch>=i.to||null==i.from&&d!=o.line||null!=i.from&&d==s.line&&i.from>=s.ch||n&&!n(i.marker)||r.push(i.marker.parent||i.marker);++d}),r},getAllMarks:function(){var a=[];return this.iter(function(e){var t,i=e.markedSpans;if(i)for(t=0;t<i.length;++t)null!=i[t].from&&a.push(i[t].marker)}),a},posFromIndex:function(t){var i,a=this.first,o=this.lineSeparator().length;return this.iter(function(e){e=e.text.length+o;if(t<e)return i=t,!0;t-=e,++a}),N(this,k(a,i))},indexFromPos:function(e){var t,i;return e=N(this,e),t=e.ch,e.line<this.first||e.ch<0?0:(i=this.lineSeparator().length,this.iter(this.first,e.line,function(e){t+=e.text.length+i}),t)},copy:function(e){var t=new m(oe(this,this.first,this.first+this.size),this.modeOption,this.first,this.lineSep,this.direction);return t.scrollTop=this.scrollTop,t.scrollLeft=this.scrollLeft,t.sel=this.sel,t.extend=!1,e&&(t.history.undoDepth=this.history.undoDepth,t.setHistory(this.getHistory())),t},linkedDoc:function(e){t=this.first,i=this.first+this.size,null!=(e=e||{}).from&&e.from>t&&(t=e.from),null!=e.to&&e.to<i&&(i=e.to),i=new m(oe(this,t,i),e.mode||this.modeOption,t,this.lineSep,this.direction),e.sharedHist&&(i.history=this.history),(this.linked||(this.linked=[])).push({doc:i,sharedHist:e.sharedHist}),i.linked=[{doc:this,isParent:!0,sharedHist:e.sharedHist}];for(var t,i,a=i,o=Ja(this),s=0;s<o.length;s++){var n=o[s],r=n.find(),d=a.clipPos(r.from),r=a.clipPos(r.to);x(d,r)&&(d=Qa(a,d,r,n.primary,n.primary.type),n.markers.push(d),d.parent=n)}return i},unlinkDoc:function(e){var t,i;if(e instanceof u&&(e=e.doc),this.linked)for(t=0;t<this.linked.length;++t)if(this.linked[t].doc==e){this.linked.splice(t,1),e.unlinkDoc(this),a=s=void 0;for(var s=Ja(this),a=0;a<s.length;a++)!function(e){var t,i,a=s[e],o=[a.primary.doc];for(ra(a.primary.doc,function(e){return o.push(e)}),t=0;t<a.markers.length;t++)i=a.markers[t],-1==b(o,i.doc)&&(i.parent=null,a.markers.splice(t--,1))}(a);break}e.history==this.history&&(i=[e.id],ra(e,function(e){return i.push(e.id)},!0),e.history=new ha(null),e.history.done=ya(this.history.done,i),e.history.undone=ya(this.history.undone,i))},iterLinkedDocs:function(e){ra(this,e)},getMode:function(){return this.mode},getEditor:function(){return this.cm},splitLines:function(e){return this.lineSep?e.split(this.lineSep):mn(e)},lineSeparator:function(){return this.lineSep||"\n"},setDirection:t(function(e){var t;(e="rtl"!=e?"ltr":e)!=this.direction&&(this.direction=e,this.iter(function(e){return e.order=null}),this.cm)&&p(t=this.cm,function(){la(t),y(t)})})}),m.prototype.eachLine=m.prototype.iter,Ts=!1,Ss={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",106:"*",107:"=",109:"-",110:".",111:"/",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"},ks=ws=0;ks<10;ks++)Ss[ks+48]=Ss[ks+96]=String(ks);for(Ns=65;Ns<=90;Ns++)Ss[Ns]=String.fromCharCode(Ns);for(Fs=1;Fs<=12;Fs++)Ss[Fs+111]=Ss[Fs+63235]="F"+Fs;(Os={basic:{Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"},pcDefault:{"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Up":"goLineUp","Ctrl-Down":"goLineDown","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"},emacsy:{"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars","Ctrl-O":"openLine"},macDefault:{"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Home":"goDocStart","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineLeft","Cmd-Right":"goLineRight","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delWrappedLineLeft","Cmd-Delete":"delWrappedLineRight","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection","Ctrl-Up":"goDocStart","Ctrl-Down":"goDocEnd",fallthrough:["basic","emacsy"]}}).default=sn?Os.macDefault:Os.pcDefault,Ls={selectAll:La,singleSelection:function(e){return e.setSelection(e.getCursor("anchor"),e.getCursor("head"),ln)},killLine:function(i){return lo(i,function(e){var t;return e.empty()?(t=S(i.doc,e.head.line).text.length,e.head.ch==t&&e.head.line<i.lastLine()?{from:e.head,to:k(e.head.line+1,0)}:{from:e.head,to:k(e.head.line,t)}):{from:e.from(),to:e.to()}})},deleteLine:function(t){return lo(t,function(e){return{from:k(e.from().line,0),to:N(t.doc,k(e.to().line+1,0))}})},delLineLeft:function(e){return lo(e,function(e){return{from:k(e.from().line,0),to:e.from()}})},delWrappedLineLeft:function(i){return lo(i,function(e){var t=i.charCoords(e.head,"div").top+5;return{from:i.coordsChar({left:0,top:t},"div"),to:e.from()}})},delWrappedLineRight:function(i){return lo(i,function(e){var t=i.charCoords(e.head,"div").top+5,t=i.coordsChar({left:i.display.lineDiv.offsetWidth+100,top:t},"div");return{from:e.from(),to:t}})},undo:function(e){return e.undo()},redo:function(e){return e.redo()},undoSelection:function(e){return e.undoSelection()},redoSelection:function(e){return e.redoSelection()},goDocStart:function(e){return e.extendSelection(k(e.firstLine(),0))},goDocEnd:function(e){return e.extendSelection(k(e.lastLine()))},goLineStart:function(t){return t.extendSelectionsBy(function(e){return bo(t,e.head.line)},{origin:"+move",bias:1})},goLineStartSmart:function(t){return t.extendSelectionsBy(function(e){return mo(t,e.head)},{origin:"+move",bias:1})},goLineEnd:function(t){return t.extendSelectionsBy(function(e){return go(t,e.head.line)},{origin:"+move",bias:-1})},goLineRight:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:t.display.lineDiv.offsetWidth+100,top:e},"div")},pn)},goLineLeft:function(t){return t.extendSelectionsBy(function(e){e=t.cursorCoords(e.head,"div").top+5;return t.coordsChar({left:0,top:e},"div")},pn)},goLineLeftSmart:function(i){return i.extendSelectionsBy(function(e){var t=i.cursorCoords(e.head,"div").top+5,t=i.coordsChar({left:0,top:t},"div");return t.ch<i.getLine(t.line).search(/\S/)?mo(i,e.head):t},pn)},goLineUp:function(e){return e.moveV(-1,"line")},goLineDown:function(e){return e.moveV(1,"line")},goPageUp:function(e){return e.moveV(-1,"page")},goPageDown:function(e){return e.moveV(1,"page")},goCharLeft:function(e){return e.moveH(-1,"char")},goCharRight:function(e){return e.moveH(1,"char")},goColumnLeft:function(e){return e.moveH(-1,"column")},goColumnRight:function(e){return e.moveH(1,"column")},goWordLeft:function(e){return e.moveH(-1,"word")},goGroupRight:function(e){return e.moveH(1,"group")},goGroupLeft:function(e){return e.moveH(-1,"group")},goWordRight:function(e){return e.moveH(1,"word")},delCharBefore:function(e){return e.deleteH(-1,"char")},delCharAfter:function(e){return e.deleteH(1,"char")},delWordBefore:function(e){return e.deleteH(-1,"word")},delWordAfter:function(e){return e.deleteH(1,"word")},delGroupBefore:function(e){return e.deleteH(-1,"group")},delGroupAfter:function(e){return e.deleteH(1,"group")},indentAuto:function(e){return e.indentSelection("smart")},indentMore:function(e){return e.indentSelection("add")},indentLess:function(e){return e.indentSelection("subtract")},insertTab:function(e){return e.replaceSelection("\t")},insertSoftTab:function(e){for(var t,i=[],a=e.listSelections(),o=e.options.tabSize,s=0;s<a.length;s++)t=a[s].from(),t=B(e.getLine(t.line),t.ch,o),i.push(Q(o-t%o));e.replaceSelections(i)},defaultTab:function(e){e.somethingSelected()?e.indentSelection("add"):e.execCommand("insertTab")},transposeChars:function(n){return p(n,function(){for(var e,t,i,a=n.listSelections(),o=[],s=0;s<a.length;s++)a[s].empty()&&(e=a[s].head,(t=S(n.doc,e.line).text)&&(0<(e=e.ch==t.length?new k(e.line,e.ch-1):e).ch?(e=new k(e.line,e.ch+1),n.replaceRange(t.charAt(e.ch-1)+t.charAt(e.ch-2),k(e.line,e.ch-2),e,"+transpose")):e.line>n.doc.first&&(i=S(n.doc,e.line-1).text)&&(e=new k(e.line,1),n.replaceRange(t.charAt(0)+n.doc.lineSeparator()+i.charAt(i.length-1),k(e.line-1,i.length-1),e,"+transpose"))),o.push(new U(e,e)));n.setSelections(o)})},newlineAndIndent:function(a){return p(a,function(){for(var e,t=a.listSelections(),i=t.length-1;0<=i;i--)a.replaceRange(a.doc.lineSeparator(),t[i].anchor,t[i].head,"+input");for(t=a.listSelections(),e=0;e<t.length;e++)a.indentLine(t[e].from().line,null,!0);xi(a)})},openLine:function(e){return e.replaceSelection("\n","start")},toggleOverwrite:function(e){return e.toggleOverwrite()}},Us=new Xo,Es=null,(Ms=function(e,t,i){this.time=e,this.pos=t,this.button=i}).prototype.compare=function(e,t,i){return this.time+400>e&&0==x(t,this.pos)&&i==this.button};var _n,vn,Cn,wn,Tn,Sn={toString:function(){return"CodeMirror.Init"}},kn={},Nn={};function n(e,t,a,i){_n.defaults[e]=t,a&&(vn[e]=i?function(e,t,i){i!=Sn&&a(e,t,i)}:a)}for(Ws in u.defaults=kn,u.optionHandlers=Nn,Rs=[],u.defineInitHook=function(e){return Rs.push(e)},Vs=null,(a=function(e){this.cm=e,this.lastAnchorNode=this.lastAnchorOffset=this.lastFocusNode=this.lastFocusOffset=null,this.polling=new Xo,this.composing=null,this.gracePeriod=!1,this.readDOMTimeout=null}).prototype.init=function(e){function t(e){var t,i,a,o;if(!O(n,e)){if(n.somethingSelected())Uo({lineWise:!1,text:n.getSelections()}),"cut"==e.type&&n.replaceSelection("",null,"cut");else{if(!n.options.lineWiseCopyCut)return;Uo({lineWise:!0,text:(t=Po(n)).text}),"cut"==e.type&&n.operation(function(){n.setSelections(t.ranges,0,ln),n.replaceSelection("",null,"cut")})}e.clipboardData&&(e.clipboardData.clearData(),a=Vs.text.join("\n"),e.clipboardData.setData("Text",a),e.clipboardData.getData("Text")==a)?e.preventDefault():(a=(i=Vo()).firstChild,n.display.lineSpace.insertBefore(i,n.display.lineSpace.firstChild),a.value=Vs.text.join("\n"),o=document.activeElement,Ko(a),setTimeout(function(){n.display.lineSpace.removeChild(i),o.focus(),o==r&&s.showPrimarySelection()},50))}}var i=this,s=this,n=s.cm,r=s.div=e.lineDiv;Ro(r,n.options.spellcheck),V(r,"paste",function(e){O(n,e)||Mo(e,n)||M<=11&&setTimeout(C(n,function(){return i.updateFromDOM()}),20)}),V(r,"compositionstart",function(e){i.composing={data:e.data,done:!1}}),V(r,"compositionupdate",function(e){i.composing||(i.composing={data:e.data,done:!1})}),V(r,"compositionend",function(e){i.composing&&(e.data!=i.composing.data&&i.readFromDOMSoon(),i.composing.done=!0)}),V(r,"touchstart",function(){return s.forceCompositionEnd()}),V(r,"input",function(){i.composing||i.readFromDOMSoon()}),V(r,"copy",t),V(r,"cut",t)},a.prototype.prepareSelection=function(){var e=ri(this.cm,!1);return e.focus=this.cm.state.focused,e},a.prototype.showSelection=function(e,t){e&&this.cm.display.view.length&&((e.focus||t)&&this.showPrimarySelection(),this.showMultipleSelections(e))},a.prototype.showPrimarySelection=function(){var e,t=window.getSelection(),i=this.cm,a=i.doc.sel.primary(),o=a.from(),a=a.to();if(i.display.viewTo==i.display.viewFrom||o.line>=i.display.viewTo||a.line<i.display.viewFrom)t.removeAllRanges();else if(s=jo(i,t.anchorNode,t.anchorOffset),n=jo(i,t.focusNode,t.focusOffset),!s||s.bad||!n||n.bad||0!=x(ce(s,n),o)||0!=x(pe(s,n),a)){var s=i.display.view,n=o.line>=i.display.viewFrom&&Ho(i,o)||{node:s[0].measure.map[2],offset:0},o=a.line<i.display.viewTo&&Ho(i,a);if(o||(o={node:(s=(a=s[s.length-1].measure).maps?a.maps[a.maps.length-1]:a.map)[s.length-1],offset:s[s.length-2]-s[s.length-3]}),n&&o){a=t.rangeCount&&t.getRangeAt(0);try{e=Yo(n.node,n.offset,o.offset,o.node)}catch(e){}e&&(!Qs&&i.state.focused&&(t.collapse(n.node,n.offset),e.collapsed)||(t.removeAllRanges(),t.addRange(e)),a&&null==t.anchorNode?t.addRange(a):Qs&&this.startGracePeriod()),this.rememberSelection()}else t.removeAllRanges()}},a.prototype.startGracePeriod=function(){var e=this;clearTimeout(this.gracePeriod),this.gracePeriod=setTimeout(function(){e.gracePeriod=!1,e.selectionChanged()&&e.cm.operation(function(){return e.cm.curOp.selectionChanged=!0})},20)},a.prototype.showMultipleSelections=function(e){f(this.cm.display.cursorDiv,e.cursors),f(this.cm.display.selectionDiv,e.selection)},a.prototype.rememberSelection=function(){var e=window.getSelection();this.lastAnchorNode=e.anchorNode,this.lastAnchorOffset=e.anchorOffset,this.lastFocusNode=e.focusNode,this.lastFocusOffset=e.focusOffset},a.prototype.selectionInEditor=function(){var e=window.getSelection();return!!e.rangeCount&&(e=e.getRangeAt(0).commonAncestorContainer,H(this.div,e))},a.prototype.focus=function(){"nocursor"!=this.cm.options.readOnly&&(this.selectionInEditor()||this.showSelection(this.prepareSelection(),!0),this.div.focus())},a.prototype.blur=function(){this.div.blur()},a.prototype.getField=function(){return this.div},a.prototype.supportsTouch=function(){return!0},a.prototype.receivedFocus=function(){var t=this;this.selectionInEditor()?this.pollSelection():p(this.cm,function(){return t.cm.curOp.selectionChanged=!0}),this.polling.set(this.cm.options.pollInterval,function e(){t.cm.state.focused&&(t.pollSelection(),t.polling.set(t.cm.options.pollInterval,e))})},a.prototype.selectionChanged=function(){var e=window.getSelection();return e.anchorNode!=this.lastAnchorNode||e.anchorOffset!=this.lastAnchorOffset||e.focusNode!=this.lastFocusNode||e.focusOffset!=this.lastFocusOffset},a.prototype.pollSelection=function(){var e,t,i,a;null==this.readDOMTimeout&&!this.gracePeriod&&this.selectionChanged()&&(e=window.getSelection(),t=this.cm,an&&Ys&&this.cm.options.gutters.length&&function(e){for(var t=e;t;t=t.parentNode)if(/CodeMirror-gutter-wrapper/.test(t.className))return 1}(e.anchorNode)?(this.cm.triggerOnKeyDown({type:"keydown",keyCode:8,preventDefault:Math.abs}),this.blur(),this.focus()):this.composing||(this.rememberSelection(),i=jo(t,e.anchorNode,e.anchorOffset),a=jo(t,e.focusNode,e.focusOffset),i&&a&&p(t,function(){w(t.doc,Xi(i,a),ln),(i.bad||a.bad)&&(t.curOp.selectionChanged=!0)})))},a.prototype.pollContent=function(){null!=this.readDOMTimeout&&(clearTimeout(this.readDOMTimeout),this.readDOMTimeout=null);var e,t,i,a,o,s,n=this.cm,r=n.display,d=n.doc.sel.primary(),l=d.from(),d=d.to();if(0==l.ch&&l.line>n.firstLine()&&(l=k(l.line-1,S(n.doc,l.line-1).length)),d.ch==S(n.doc,d.line).text.length&&d.line<n.lastLine()&&(d=k(d.line+1,0)),l.line<r.viewFrom||d.line>r.viewTo-1||(t=l.line==r.viewFrom||0==(t=si(n,l.line))?(e=I(r.view[0].line),r.view[0].node):(e=I(r.view[t].line),r.view[t-1].node.nextSibling),a=(d=si(n,d.line))==r.view.length-1?(i=r.viewTo-1,r.lineDiv.lastChild):(i=I(r.view[d+1].line)-1,r.view[d+1].node.previousSibling),!t))return!1;for(o=n.doc.splitLines(zo(n,t,a,e,i)),s=ae(n.doc,k(e,0),k(i,S(n.doc,i).text.length));1<o.length&&1<s.length;)if(A(o)==A(s))o.pop(),s.pop(),i--;else{if(o[0]!=s[0])break;o.shift(),s.shift(),e++}for(var h=0,p=0,c=o[0],u=s[0],b=Math.min(c.length,u.length);h<b&&c.charCodeAt(h)==u.charCodeAt(h);)++h;for(var g=A(o),m=A(s),f=Math.min(g.length-(1==o.length?h:0),m.length-(1==s.length?h:0));p<f&&g.charCodeAt(g.length-p-1)==m.charCodeAt(m.length-p-1);)++p;if(1==o.length&&1==s.length&&e==l.line)for(;h&&h>l.ch&&g.charCodeAt(g.length-p-1)==m.charCodeAt(m.length-p-1);)h--,p++;return o[o.length-1]=g.slice(0,g.length-p).replace(/^\u200b+/,""),o[0]=o[0].slice(h).replace(/\u200b+$/,""),r=k(e,h),d=k(i,s.length?A(s).length-p:0),1<o.length||o[0]||x(r,d)?(Va(n.doc,o,r,d,"+input"),!0):void 0},a.prototype.ensurePolled=function(){this.forceCompositionEnd()},a.prototype.reset=function(){this.forceCompositionEnd()},a.prototype.forceCompositionEnd=function(){this.composing&&(clearTimeout(this.readDOMTimeout),this.composing=null,this.updateFromDOM(),this.div.blur(),this.div.focus())},a.prototype.readFromDOMSoon=function(){var e=this;null==this.readDOMTimeout&&(this.readDOMTimeout=setTimeout(function(){if(e.readDOMTimeout=null,e.composing){if(!e.composing.done)return;e.composing=null}e.updateFromDOM()},80))},a.prototype.updateFromDOM=function(){var e=this;!this.cm.isReadOnly()&&this.pollContent()||p(this.cm,function(){return y(e.cm)})},a.prototype.setUneditable=function(e){e.contentEditable="false"},a.prototype.onKeyPress=function(e){0!=e.charCode&&(e.preventDefault(),this.cm.isReadOnly()||C(this.cm,Eo)(this.cm,String.fromCharCode(null==e.charCode?e.keyCode:e.charCode),0))},a.prototype.readOnlyChanged=function(e){this.div.contentEditable=String("nocursor"!=e)},a.prototype.onContextMenu=function(){},a.prototype.resetPosition=function(){},a.prototype.needsContentAttribute=!0,(i=function(e){this.cm=e,this.prevInput="",this.pollingFast=!1,this.polling=new Xo,this.hasSelection=!1,this.composing=null}).prototype.init=function(t){function e(e){if(!O(o,e)){if(o.somethingSelected())Uo({lineWise:!1,text:o.getSelections()});else{if(!o.options.lineWiseCopyCut)return;var t=Po(o);Uo({lineWise:!0,text:t.text}),"cut"==e.type?o.setSelections(t.ranges,null,ln):(a.prevInput="",n.value=t.text.join("\n"),Ko(n))}"cut"==e.type&&(o.state.cutIncoming=!0)}}var i=this,a=this,o=this.cm,s=this.wrapper=Vo(),n=this.textarea=s.firstChild;t.wrapper.insertBefore(s,t.wrapper.firstChild),tn&&(n.style.width="0px"),V(n,"input",function(){E&&9<=M&&i.hasSelection&&(i.hasSelection=null),a.poll()}),V(n,"paste",function(e){O(o,e)||Mo(e,o)||(o.state.pasteIncoming=!0,a.fastPoll())}),V(n,"cut",e),V(n,"copy",e),V(t.scroller,"paste",function(e){_t(t,e)||O(o,e)||(o.state.pasteIncoming=!0,a.focus())}),V(t.lineSpace,"selectstart",function(e){_t(t,e)||v(e)}),V(n,"compositionstart",function(){var e=o.getCursor("from");a.composing&&a.composing.range.clear(),a.composing={start:e,range:o.markText(e,o.getCursor("to"),{className:"CodeMirror-composing"})}}),V(n,"compositionend",function(){a.composing&&(a.poll(),a.composing.range.clear(),a.composing=null)})},i.prototype.prepareSelection=function(){var e,t=this.cm,i=t.display,a=t.doc,o=ri(t);return t.options.moveInputWithCursor&&(t=zt(t,a.sel.primary().head,"div"),a=i.wrapper.getBoundingClientRect(),e=i.lineDiv.getBoundingClientRect(),o.teTop=Math.max(0,Math.min(i.wrapper.clientHeight-10,t.top+e.top-a.top)),o.teLeft=Math.max(0,Math.min(i.wrapper.clientWidth-10,t.left+e.left-a.left))),o},i.prototype.showSelection=function(e){var t=this.cm.display;f(t.cursorDiv,e.cursors),f(t.selectionDiv,e.selection),null!=e.teTop&&(this.wrapper.style.top=e.teTop+"px",this.wrapper.style.left=e.teLeft+"px")},i.prototype.reset=function(e){var t,i;this.contextMenuPending||this.composing||((t=this.cm).somethingSelected()?(this.prevInput="",i=t.getSelection(),this.textarea.value=i,t.state.focused&&Ko(this.textarea),E&&9<=M&&(this.hasSelection=i)):e||(this.prevInput=this.textarea.value="",E&&9<=M&&(this.hasSelection=null)))},i.prototype.getField=function(){return this.textarea},i.prototype.supportsTouch=function(){return!1},i.prototype.focus=function(){if("nocursor"!=this.cm.options.readOnly&&(!on||q()!=this.textarea))try{this.textarea.focus()}catch(e){}},i.prototype.blur=function(){this.textarea.blur()},i.prototype.resetPosition=function(){this.wrapper.style.top=this.wrapper.style.left=0},i.prototype.receivedFocus=function(){this.slowPoll()},i.prototype.slowPoll=function(){var e=this;this.pollingFast||this.polling.set(this.cm.options.pollInterval,function(){e.poll(),e.cm.state.focused&&e.slowPoll()})},i.prototype.fastPoll=function(){var t=!1,i=this;i.pollingFast=!0,i.polling.set(20,function e(){i.poll()||t?(i.pollingFast=!1,i.slowPoll()):(t=!0,i.polling.set(60,e))})},i.prototype.poll=function(){var e,t,i,a,o=this,s=this.cm,n=this.textarea,r=this.prevInput;if(this.contextMenuPending||!s.state.focused||fn(n)&&!r&&!this.composing||s.isReadOnly()||s.options.disableInput||s.state.keySeq||(e=n.value)==r&&!s.somethingSelected())return!1;if(E&&9<=M&&this.hasSelection===e||sn&&/[\uf700-\uf7ff]/.test(e))return s.display.input.reset(),!1;if(s.doc.sel==s.display.selForContextMenu&&(8203==(t=e.charCodeAt(0))&&(r=r||"​"),8666==t))return this.reset(),this.cm.execCommand("undo");for(i=0,a=Math.min(r.length,e.length);i<a&&r.charCodeAt(i)==e.charCodeAt(i);)++i;return p(s,function(){Eo(s,e.slice(i),r.length-i,null,o.composing?"*compose":null),1e3<e.length||-1<e.indexOf("\n")?n.value=o.prevInput="":o.prevInput=e,o.composing&&(o.composing.range.clear(),o.composing.range=s.markText(o.composing.start,s.getCursor("to"),{className:"CodeMirror-composing"}))}),!0},i.prototype.ensurePolled=function(){this.pollingFast&&this.poll()&&(this.pollingFast=!1)},i.prototype.onKeyPress=function(){E&&9<=M&&(this.hasSelection=null),this.fastPoll()},i.prototype.onContextMenu=function(e){function i(){var e,t;null!=h.selectionStart&&(t="​"+((e=d.somethingSelected())?h.value:""),h.value="⇚",h.value=t,r.prevInput=e?"":"​",h.selectionStart=1,h.selectionEnd=t.length,l.selForContextMenu=d.doc.sel)}function t(){var e,t;r.contextMenuPending=!1,r.wrapper.style.cssText=o,h.style.cssText=a,E&&M<9&&l.scrollbars.setScrollTop(l.scroller.scrollTop=c),null!=h.selectionStart&&((!E||M<9)&&i(),e=0,t=function(){l.selForContextMenu==d.doc.sel&&0==h.selectionStart&&0<h.selectionEnd&&"​"==r.prevInput?C(d,La)(d):e++<10?l.detectingSelectAll=setTimeout(t,500):(l.selForContextMenu=null,l.input.reset())},l.detectingSelectAll=setTimeout(t,200))}var a,o,s,n,r=this,d=r.cm,l=d.display,h=r.textarea,p=oi(d,e),c=l.scroller.scrollTop;p&&!Ks&&(d.options.resetSelectionOnContextMenu&&-1==d.doc.sel.contains(p)&&C(d,w)(d.doc,Xi(p),ln),a=h.style.cssText,o=r.wrapper.style.cssText,r.wrapper.style.cssText="position: absolute",p=r.wrapper.getBoundingClientRect(),h.style.cssText="position: absolute; width: 30px; height: 30px;\n      top: "+(e.clientY-p.top-5)+"px; left: "+(e.clientX-p.left-5)+"px;\n      z-index: 1000; background: "+(E?"rgba(255, 255, 255, .05)":"transparent")+";\n      outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);",P&&(s=window.scrollY),l.input.focus(),P&&window.scrollTo(null,s),l.input.reset(),d.somethingSelected()||(h.value=r.prevInput=" "),r.contextMenuPending=!0,l.selForContextMenu=d.doc.sel,clearTimeout(l.detectingSelectAll),E&&9<=M&&i(),Qo?(He(e),n=function(){_(window,"mouseup",n),setTimeout(t,20)},V(window,"mouseup",n)):setTimeout(t,50))},i.prototype.readOnlyChanged=function(e){e||this.reset(),this.textarea.disabled="nocursor"==e},i.prototype.setUneditable=function(){},i.prototype.needsContentAttribute=!1,vn=(_n=u).optionHandlers,_n.defineOption=n,_n.Init=Sn,n("value","",function(e,t){return e.setValue(t)},!0),n("mode",null,function(e,t){e.doc.modeOption=t,aa(e)},!0),n("indentUnit",2,aa,!0),n("indentWithTabs",!1),n("smartIndent",!0),n("tabSize",4,function(e){oa(e),Pt(e),y(e)},!0),n("lineSeparator",null,function(e,a){var o,s,t;if(e.doc.lineSep=a)for(o=[],s=e.doc.first,e.doc.iter(function(e){for(var t,i=0;-1!=(t=e.text.indexOf(a,i));)i=t+a.length,o.push(k(s,t));s++}),t=o.length-1;0<=t;t--)Va(e.doc,a,o[t],k(o[t].line,o[t].ch+a.length))}),n("specialChars",/[\u0000-\u001f\u007f-\u009f\u00ad\u061c\u200b-\u200f\u2028\u2029\ufeff]/g,function(e,t,i){e.state.specialChars=new RegExp(t.source+(t.test("\t")?"":"|\t"),"g"),i!=Sn&&e.refresh()}),n("specialCharPlaceholder",lt,function(e){return e.refresh()},!0),n("electricChars",!0),n("inputStyle",on?"contenteditable":"textarea",function(){throw new Error("inputStyle can not (yet) be changed in a running editor")},!0),n("spellcheck",!1,function(e,t){return e.getInputField().spellcheck=t},!0),n("rtlMoveVisually",!Js),n("wholeLineUpdateBefore",!0),n("theme","default",function(e){ko(e),No(e)},!0),n("keyMap","default",function(e,t,i){t=ro(t),i=i!=Sn&&ro(i);i&&i.detach&&i.detach(e,t),t.attach&&t.attach(e,i||null)}),n("extraKeys",null),n("configureMouse",null),n("lineWrapping",!1,Oo,!0),n("gutters",[],function(e){Gi(e.options),No(e)},!0),n("fixedGutter",!0,function(e,t){e.display.gutters.style.left=t?ti(e.display)+"px":"0",e.refresh()},!0),n("coverGutterNextToScrollbar",!1,function(e){return Ni(e)},!0),n("scrollbarStyle","native",function(e){Oi(e),Ni(e),e.display.scrollbars.setScrollTop(e.doc.scrollTop),e.display.scrollbars.setScrollLeft(e.doc.scrollLeft)},!0),n("lineNumbers",!1,function(e){Gi(e.options),No(e)},!0),n("firstLineNumber",1,No,!0),n("lineNumberFormatter",function(e){return e},No,!0),n("showCursorWhenSelecting",!1,ni,!0),n("resetSelectionOnContextMenu",!0),n("lineWiseCopyCut",!0),n("pasteLinesPerSelection",!0),n("readOnly",!1,function(e,t){"nocursor"==t&&(bi(e),e.display.input.blur()),e.display.input.readOnlyChanged(t)}),n("disableInput",!1,function(e,t){t||e.display.input.reset()},!0),n("dragDrop",!0,Fo),n("allowDropFileTypes",null),n("cursorBlinkRate",530),n("cursorScrollMargin",0),n("cursorHeight",1,ni,!0),n("singleCursorHeightPerLine",!0,ni,!0),n("workTime",100),n("workDelay",100),n("flattenSpans",!0,oa,!0),n("addModeClass",!1,oa,!0),n("pollInterval",100),n("undoDepth",200,function(e,t){return e.doc.history.undoDepth=t}),n("historyEventDelay",1250),n("viewportMargin",10,function(e){return e.refresh()},!0),n("maxHighlightLength",1e4,oa,!0),n("moveInputWithCursor",!0,function(e,t){t||e.display.input.resetPosition()}),n("tabindex",null,function(e,t){return e.display.input.getField().tabIndex=t||""}),n("autofocus",null),n("direction","ltr",function(e,t){return e.doc.setDirection(t)},!0),wn=(Cn=u).optionHandlers,Tn=Cn.helpers={},Cn.prototype={constructor:Cn,focus:function(){window.focus(),this.display.input.focus()},setOption:function(e,t){var i=this.options,a=i[e];i[e]==t&&"mode"!=e||(i[e]=t,wn.hasOwnProperty(e)&&C(this,wn[e])(this,t,a),F(this,"optionChange",this,e))},getOption:function(e){return this.options[e]},getDoc:function(){return this.doc},addKeyMap:function(e,t){this.state.keyMaps[t?"push":"unshift"](ro(e))},removeKeyMap:function(e){for(var t=this.state.keyMaps,i=0;i<t.length;++i)if(t[i]==e||t[i].name==e)return t.splice(i,1),!0},addOverlay:e(function(e,t){var i=e.token?e:Cn.getMode(this.options,e);if(i.startState)throw new Error("Overlays may not be stateful.");for(var a=this.state.overlays,i={mode:i,modeSpec:e,opaque:t&&t.opaque,priority:t&&t.priority||0},o=function(e){return e.priority},s=0,n=o(i);s<a.length&&o(a[s])<=n;)s++;a.splice(s,0,i),this.state.modeGen++,y(this)}),removeOverlay:e(function(e){for(var t,i=this.state.overlays,a=0;a<i.length;++a)if((t=i[a].modeSpec)==e||"string"==typeof e&&t.name==e)return i.splice(a,1),this.state.modeGen++,void y(this)}),indentLine:e(function(e,t,i){"string"!=typeof t&&"number"!=typeof t&&(t=null==t?this.options.smartIndent?"smart":"prev":t?"add":"subtract"),re(this.doc,e)&&Lo(this,e,t,i)}),indentSelection:e(function(e){for(var t=this.doc.sel.ranges,i=-1,a=0;a<t.length;a++)if((s=t[a]).empty())s.head.line>i&&(Lo(this,s.head.line,e,!0),i=s.head.line,a==this.doc.sel.primIndex)&&xi(this);else{for(var o=s.from(),s=s.to(),n=Math.max(i,o.line),i=Math.min(this.lastLine(),s.line-(s.ch?0:1))+1,r=n;r<i;++r)Lo(this,r,e);s=this.doc.sel.ranges,0==o.ch&&t.length==s.length&&0<s[a].from().ch&&_a(this.doc,a,new U(o,s[a].to()),ln)}}),getTokenAt:function(e,t){return ot(this,e,t)},getLineTokens:function(e,t){return ot(this,k(e),t,!0)},getTokenTypeAt:function(e){e=N(this.doc,e);var t,i,a=Ze(this,S(this.doc,e.line)),o=0,s=(a.length-1)/2,n=e.ch;if(0==n)i=a[2];else for(;;)if(((t=o+s>>1)?a[2*t-1]:0)>=n)s=t;else{if(!(a[2*t+1]<n)){i=a[2*t+2];break}o=1+t}return(e=i?i.indexOf("overlay "):-1)<0?i:0==e?null:i.slice(0,e-1)},getModeAt:function(e){var t=this.doc.mode;return t.innerMode?Cn.innerMode(t,this.getTokenAt(e).state).mode:t},getHelper:function(e,t){return this.getHelpers(e,t)[0]},getHelpers:function(e,t){var i,a,o,s,n,r,d=[];if(Tn.hasOwnProperty(t)){if(i=Tn[t],"string"==typeof(a=this.getModeAt(e))[t])i[a[t]]&&d.push(i[a[t]]);else if(a[t])for(o=0;o<a[t].length;o++)(s=i[a[t][o]])&&d.push(s);else a.helperType&&i[a.helperType]?d.push(i[a.helperType]):i[a.name]&&d.push(i[a.name]);for(n=0;n<i._global.length;n++)(r=i._global[n]).pred(a,this)&&-1==b(d,r.val)&&d.push(r.val)}return d},getStateAfter:function(e,t){var i=this.doc;return et(this,(e=ue(i,null==e?i.first+i.size-1:e))+1,t).state},cursorCoords:function(e,t){var i=this.doc.sel.primary();return zt(this,null==e?i.head:"object"==typeof e?N(this.doc,e):e?i.from():i.to(),t||"page")},charCoords:function(e,t){return qt(this,N(this.doc,e),t||"page")},coordsChar:function(e,t){return Qt(this,(e=Ht(this,e,t||"page")).left,e.top)},lineAtHeight:function(e,t){return e=Ht(this,{top:e,left:0},t||"page").top,ne(this.doc,e+this.display.viewOffset)},heightAtLine:function(e,t,i){var a=!1,o="number"==typeof e?(o=this.doc.first+this.doc.size-1,e<this.doc.first?e=this.doc.first:o<e&&(e=o,a=!0),S(this.doc,e)):e;return Wt(this,o,{top:0,left:0},t||"page",i||a).top+(a?this.doc.height-Oe(o):0)},defaultTextHeight:function(){return Xt(this.display)},defaultCharWidth:function(){return Zt(this.display)},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(e,t,i,a,o){var s,n,r=this.display,d=(e=zt(this,N(this.doc,e))).bottom,l=e.left;t.style.position="absolute",t.setAttribute("cm-ignore-events","true"),this.display.input.setUneditable(t),r.sizer.appendChild(t),"over"==a?d=e.top:("above"==a||"near"==a)&&(n=Math.max(r.wrapper.clientHeight,this.doc.height),s=Math.max(r.sizer.clientWidth,r.lineSpace.clientWidth),("above"==a||e.bottom+t.offsetHeight>n)&&e.top>t.offsetHeight?d=e.top-t.offsetHeight:e.bottom+t.offsetHeight<=n&&(d=e.bottom),l+t.offsetWidth>s)&&(l=s-t.offsetWidth),t.style.top=d+"px",t.style.left=t.style.right="","right"==o?(l=r.sizer.clientWidth-t.offsetWidth,t.style.right="0px"):("left"==o?l=0:"middle"==o&&(l=(r.sizer.clientWidth-t.offsetWidth)/2),t.style.left=l+"px"),i&&(a=this,n={left:l,top:d,right:l+t.offsetWidth,bottom:d+t.offsetHeight},null!=(n=Bi(a,n)).scrollTop&&wi(a,n.scrollTop),null!=n.scrollLeft)&&Si(a,n.scrollLeft)},triggerOnKeyDown:e(Io),triggerOnKeyPress:e(_o),triggerOnKeyUp:xo,triggerOnMouseDown:e(vo),execCommand:function(e){if(Ls.hasOwnProperty(e))return Ls[e].call(null,this)},triggerElectric:e(function(e){Ao(this,e)}),findPosH:function(e,t,i,a){var o,s,n=1;for(t<0&&(n=-1,t=-t),o=N(this.doc,e),s=0;s<t&&!(o=$o(this.doc,o,n,i,a)).hitSide;++s);return o},moveH:e(function(t,i){var a=this;this.extendSelectionsBy(function(e){return a.display.shift||a.doc.extend||e.empty()?$o(a.doc,e.head,t,i,a.options.rtlMoveVisually):t<0?e.from():e.to()},pn)}),deleteH:e(function(i,a){var e=this.doc.sel,o=this.doc;e.somethingSelected()?o.replaceSelection("",null,"+delete"):lo(this,function(e){var t=$o(o,e.head,i,a,!1);return i<0?{from:t,to:e.head}:{from:e.head,to:t}})}),findPosV:function(e,t,i,a){var o,s,n,r=1,d=a;for(t<0&&(r=-1,t=-t),o=N(this.doc,e),s=0;s<t&&(n=zt(this,o,"div"),null==d?d=n.left:n.left=d,!(o=Wo(this,n,r,i)).hitSide);++s);return o},moveV:e(function(a,o){var e,s=this,n=this.doc,r=[],d=!this.display.shift&&!n.extend&&n.sel.somethingSelected();if(n.extendSelectionsBy(function(e){var t,i;return d?a<0?e.from():e.to():(t=zt(s,e.head,"div"),null!=e.goalColumn&&(t.left=e.goalColumn),r.push(t.left),i=Wo(s,t,a,o),"page"==o&&e==n.sel.primary()&&Ii(s,qt(s,i,"div").top-t.top),i)},pn),r.length)for(e=0;e<n.sel.ranges.length;e++)n.sel.ranges[e].goalColumn=r[e]}),findWordAt:function(e){var t,i,a,o=S(this.doc,e.line).text,s=e.ch,n=e.ch;if(o){for(t=this.getHelper(e,"wordChars"),"before"!=e.sticky&&n!=o.length||!s?++n:--s,a=K(i=o.charAt(s),t)?function(e){return K(e,t)}:/\s/.test(i)?function(e){return/\s/.test(e)}:function(e){return!/\s/.test(e)&&!K(e)};0<s&&a(o.charAt(s-1));)--s;for(;n<o.length&&a(o.charAt(n));)++n}return new U(k(e.line,s),k(e.line,n))},toggleOverwrite:function(e){null!=e&&e==this.state.overwrite||(((this.state.overwrite=!this.state.overwrite)?d:Jo)(this.display.cursorDiv,"CodeMirror-overwrite"),F(this,"overwriteToggle",this,this.state.overwrite))},hasFocus:function(){return this.display.input.getField()==q()},isReadOnly:function(){return!(!this.options.readOnly&&!this.doc.cantEdit)},scrollTo:e(function(e,t){_i(this,e,t)}),getScrollInfo:function(){var e=this.display.scroller;return{left:e.scrollLeft,top:e.scrollTop,height:e.scrollHeight-Tt(this)-this.display.barHeight,width:e.scrollWidth-Tt(this)-this.display.barWidth,clientHeight:kt(this),clientWidth:St(this)}},scrollIntoView:e(function(e,t){var i;null==e?(e={from:this.doc.sel.primary().head,to:null},null==t&&(t=this.options.cursorScrollMargin)):"number"==typeof e?e={from:k(e,0),to:null}:null==e.from&&(e={from:e,to:null}),e.to||(e.to=e.from),e.margin=t||0,null!=e.from.line?(t=e,vi(i=this),i.curOp.scrollToPos=t):Ci(this,e.from,e.to,e.margin)}),setSize:e(function(e,t){function i(e){return"number"==typeof e||/^\d+$/.test(String(e))?e+"px":e}var a,o=this;null!=e&&(this.display.wrapper.style.width=i(e)),null!=t&&(this.display.wrapper.style.height=i(t)),this.options.lineWrapping&&At(this),a=this.display.viewFrom,this.doc.iter(a,this.display.viewTo,function(e){if(e.widgets)for(var t=0;t<e.widgets.length;t++)if(e.widgets[t].noHScroll){Ei(o,a,"widget");break}++a}),this.curOp.forceUpdate=!0,F(this,"refresh",this)}),operation:function(e){return p(this,e)},startOperation:function(){return Li(this)},endOperation:function(){return Ui(this)},refresh:e(function(){var e=this.display.cachedTextHeight;y(this),this.curOp.forceUpdate=!0,Pt(this),_i(this,this.doc.scrollLeft,this.doc.scrollTop),qi(this),(null==e||.5<Math.abs(e-Xt(this.display)))&&ai(this),F(this,"refresh",this)}),swapDoc:e(function(e){var t=this.doc;return t.cm=null,da(this,e),Pt(this),this.display.input.reset(),_i(this,e.scrollLeft,e.scrollTop),this.curOp.forceScroll=!0,D(this,"swapDoc",this,t),t}),getInputField:function(){return this.display.input.getField()},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}},Ve(Cn),Cn.registerHelper=function(e,t,i){Tn.hasOwnProperty(e)||(Tn[e]=Cn[e]={_global:[]}),Tn[e][t]=i},Cn.registerGlobalHelper=function(e,t,i,a){Cn.registerHelper(e,t,a),Tn[e]._global.push({pred:i,val:a})},$s="iter insert remove copy getEditor constructor".split(" "),m.prototype)m.prototype.hasOwnProperty(Ws)&&b($s,Ws)<0&&(u.prototype[Ws]=function(e){return function(){return e.apply(this.doc,arguments)}}(m.prototype[Ws]));return Ve(m),u.inputStyles={textarea:i,contenteditable:a},u.defineMode=function(e){u.defaults.mode||"null"==e||(u.defaults.mode=e),function(e,t){2<arguments.length&&(t.dependencies=Array.prototype.slice.call(arguments,2)),Bn[e]=t}.apply(this,arguments)},u.defineMIME=function(e,t){In[e]=t},u.defineMode("null",function(){return{token:function(e){return e.skipToEnd()}}}),u.defineMIME("text/plain","null"),u.defineExtension=function(e,t){u.prototype[e]=t},u.defineDocExtension=function(e,t){m.prototype[e]=t},u.fromTextArea=function(t,e){function i(){t.value=r.getValue()}var a,o,s,n,r;if((e=e?j(e):{}).value=t.value,!e.tabindex&&t.tabIndex&&(e.tabindex=t.tabIndex),!e.placeholder&&t.placeholder&&(e.placeholder=t.placeholder),null==e.autofocus&&(a=q(),e.autofocus=a==t||null!=t.getAttribute("autofocus")&&a==document.body),t.form&&(V(t.form,"submit",i),!e.leaveSubmitMethodAlone)){s=t.form,o=s.submit;try{n=s.submit=function(){i(),s.submit=o,s.submit(),s.submit=n}}catch(e){}}return e.finishInit=function(e){e.save=i,e.getTextArea=function(){return t},e.toTextArea=function(){e.toTextArea=isNaN,i(),t.parentNode.removeChild(e.getWrapperElement()),t.style.display="",t.form&&(_(t.form,"submit",i),"function"==typeof t.form.submit)&&(t.form.submit=o)}},t.style.display="none",r=u(function(e){return t.parentNode.insertBefore(e,t.nextSibling)},e)},(o=u).off=_,o.on=V,o.wheelEventPixels=Ji,o.Doc=m,o.splitLines=mn,o.countColumn=B,o.findColumn=G,o.isWordChar=Y,o.Pass=dn,o.signal=F,o.Line=hs,o.changeEnd=Zi,o.scrollbarModel=fs,o.Pos=k,o.cmpPos=x,o.modes=Bn,o.mimeModes=In,o.resolveMode=je,o.getMode=Ge,o.modeExtensions=xn,o.extendMode=Qe,o.copyState=Je,o.startState=Ke,o.innerMode=Ye,o.commands=Ls,o.keyMap=Os,o.keyName=no,o.isModifierKey=oo,o.lookupKey=ao,o.normalizeKeyMap=io,o.StringStream=R,o.SharedTextMarker=vs,o.TextMarker=_s,o.LineWidget=Is,o.e_preventDefault=v,o.e_stopPropagation=$e,o.e_stop=He,o.addClass=d,o.contains=H,o.rmClass=Jo,o.keyNames=Ss,u.version="5.31.1",u}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(a){function e(e){for(var t;null!=(t=e.next());)if("`"==t&&!e.eat("`"))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null}function t(e){return e.eat("@")&&(e.match(/^session\./),e.match(/^local\./),e.match(/^global\./)),e.eat("'")?(e.match(/^.*'/),"variable-2"):e.eat('"')?(e.match(/^.*"/),"variable-2"):e.eat("`")?(e.match(/^.*`/),"variable-2"):e.match(/^[0-9a-zA-Z$\.\_]+/)?"variable-2":null}function i(e){return e.eat("N")?"atom":e.match(/^[a-zA-Z.#!?]/)?"variable-2":null}function o(e){for(var t={},i=e.split(" "),a=0;a<i.length;++a)t[i[a]]=!0;return t}var s;a.defineMode("sql",function(i,e){function s(e,t){var i,o,a=e.next();return c[a]&&!1!==(i=c[a](e,t))?i:p.hexNumber&&("0"==a&&e.match(/^[xX][0-9a-fA-F]+/)||("x"==a||"X"==a)&&e.match(/^'[0-9a-fA-F]+'/))||p.binaryNumber&&(("b"==a||"B"==a)&&e.match(/^'[01]+'/)||"0"==a&&e.match(/^b[01]+/))?"number":47<a.charCodeAt(0)&&a.charCodeAt(0)<58?(e.match(/^[0-9]*(\.[0-9]+)?([eE][-+]?[0-9]+)?/),p.decimallessFloat&&e.match(/^\.(?!\.)/),"number"):"?"==a&&(e.eatSpace()||e.eol()||e.eat(";"))?"variable-3":"'"==a||'"'==a&&p.doubleQuote?(t.tokenize=(o=a,function(e,t){for(var i,a=!1;null!=(i=e.next());){if(i==o&&!a){t.tokenize=s;break}a=!a&&"\\"==i}return"string"}),t.tokenize(e,t)):!(p.nCharCast&&("n"==a||"N"==a)||p.charsetCast&&"_"==a&&e.match(/[a-z][a-z0-9]*/i))||"'"!=e.peek()&&'"'!=e.peek()?/^[\(\),\;\[\]]/.test(a)?null:p.commentSlashSlash&&"/"==a&&e.eat("/")||p.commentHash&&"#"==a||"-"==a&&e.eat("-")&&(!p.commentSpaceRequired||e.eat(" "))?(e.skipToEnd(),"comment"):"/"==a&&e.eat("*")?(t.tokenize=function a(o){return function(e,t){var i=e.match(/^.*?(\/\*|\*\/)/);return i?t.tokenize="/*"==i[1]?a(o+1):1<o?a(o-1):s:e.skipToEnd(),"comment"}}(1),t.tokenize(e,t)):"."==a?p.zerolessFloat&&e.match(/^(?:\d+(?:e[+-]?\d+)?)/i)?"number":e.match(/^\.+/)?null:p.ODBCdotTable&&e.match(/^[\w\d_]+/)?"variable-2":void 0:h.test(a)?(e.eatWhile(h),null):"{"==a&&(e.match(/^( )*(d|D|t|T|ts|TS)( )*'[^']*'( )*}/)||e.match(/^( )*(d|D|t|T|ts|TS)( )*"[^"]*"( )*}/))||(e.eatWhile(/^[_\w\d]/),i=e.current().toLowerCase(),u.hasOwnProperty(i)&&(e.match(/^( )+'[^']*'/)||e.match(/^( )+"[^"]*"/)))?"number":r.hasOwnProperty(i)?"atom":d.hasOwnProperty(i)?"builtin":l.hasOwnProperty(i)?"keyword":n.hasOwnProperty(i)?"string-2":null:"keyword"}function o(e,t,i){t.context={prev:t.context,indent:e.indentation(),col:e.column(),type:i}}var n=e.client||{},r=e.atoms||{false:!0,true:!0,null:!0},d=e.builtin||{},l=e.keywords||{},h=e.operatorChars||/^[*+\-%<>!=&|~^]/,p=e.support||{},c=e.hooks||{},u=e.dateSQL||{date:!0,time:!0,timestamp:!0};return{startState:function(){return{tokenize:s,context:null}},token:function(e,t){var i,a;return e.sol()&&t.context&&null==t.context.align&&(t.context.align=!1),t.tokenize==s&&e.eatSpace()?null:("comment"==(i=t.tokenize(e,t))||(t.context&&null==t.context.align&&(t.context.align=!0),"("==(a=e.current())?o(e,t,")"):"["==a?o(e,t,"]"):t.context&&t.context.type==a&&((e=t).indent=e.context.indent,e.context=e.context.prev)),i)},indent:function(e,t){e=e.context;return e?(t=t.charAt(0)==e.type,e.align?e.col+(t?0:1):e.indent+(t?0:i.indentUnit)):a.Pass},blockCommentStart:"/*",blockCommentEnd:"*/",lineComment:p.commentSlashSlash?"//":p.commentHash?"#":"--"}}),s="alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit ",a.defineMIME("text/x-sql",{name:"sql",keywords:o(s+"begin"),builtin:o("bool boolean bit blob enum long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision real date datetime year unsigned signed decimal numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable doubleQuote binaryNumber hexNumber")}),a.defineMIME("text/x-mssql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"begin trigger proc view index for add constraint key primary foreign collate clustered nonclustered declare exec"),builtin:o("bigint numeric bit smallint decimal smallmoney int tinyint money float real char varchar text nchar nvarchar ntext binary varbinary image cursor timestamp hierarchyid uniqueidentifier sql_variant xml table "),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date datetimeoffset datetime2 smalldatetime datetime time"),hooks:{"@":t}}),a.defineMIME("text/x-mysql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general get global grant grants group group_concat handler hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show signal slave slow smallint snapshot soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-mariadb",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-memsql",{name:"sql",client:o("charset clear connect edit ego exit go help nopager notee nowarning pager print prompt quit rehash source status system tee"),keywords:o(s+"accessible action add after algorithm all always analyze asensitive at authors auto_increment autocommit avg avg_row_length before binary binlog both btree cache call cascade cascaded case catalog_name chain change changed character check checkpoint checksum class_origin client_statistics close coalesce code collate collation collations column columns comment commit committed completion concurrent condition connection consistent constraint contains continue contributors convert cross current current_date current_time current_timestamp current_user cursor data database databases day_hour day_microsecond day_minute day_second deallocate dec declare default delay_key_write delayed delimiter des_key_file describe deterministic dev_pop dev_samp deviance diagnostics directory disable discard distinctrow div dual dumpfile each elseif enable enclosed end ends engine engines enum errors escape escaped even event events every execute exists exit explain extended fast fetch field fields first flush for force foreign found_rows full fulltext function general generated get global grant grants group groupby_concat handler hard hash help high_priority hosts hour_microsecond hour_minute hour_second if ignore ignore_server_ids import index index_statistics infile inner innodb inout insensitive insert_method install interval invoker isolation iterate key keys kill language last leading leave left level limit linear lines list load local localtime localtimestamp lock logs low_priority master master_heartbeat_period master_ssl_verify_server_cert masters match max max_rows maxvalue message_text middleint migrate min min_rows minute_microsecond minute_second mod mode modifies modify mutex mysql_errno natural next no no_write_to_binlog offline offset one online open optimize option optionally out outer outfile pack_keys parser partition partitions password persistent phase plugin plugins prepare preserve prev primary privileges procedure processlist profile profiles purge query quick range read read_write reads real rebuild recover references regexp relaylog release remove rename reorganize repair repeatable replace require resignal restrict resume return returns revoke right rlike rollback rollup row row_format rtree savepoint schedule schema schema_name schemas second_microsecond security sensitive separator serializable server session share show shutdown signal slave slow smallint snapshot soft soname spatial specific sql sql_big_result sql_buffer_result sql_cache sql_calc_found_rows sql_no_cache sql_small_result sqlexception sqlstate sqlwarning ssl start starting starts status std stddev stddev_pop stddev_samp storage straight_join subclass_origin sum suspend table_name table_statistics tables tablespace temporary terminated to trailing transaction trigger triggers truncate uncommitted undo uninstall unique unlock upgrade usage use use_frm user user_resources user_statistics using utc_date utc_time utc_timestamp value variables varying view views virtual warnings when while with work write xa xor year_month zerofill begin do then else loop repeat"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text bigint int int1 int2 int3 int4 int8 integer float float4 float8 double char varbinary varchar varcharacter precision date datetime year unsigned signed numeric"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber doubleQuote nCharCast charsetCast commentHash commentSpaceRequired"),hooks:{"@":t,"`":e,"\\":i}}),a.defineMIME("text/x-sqlite",{name:"sql",client:o("auth backup bail binary changes check clone databases dbinfo dump echo eqp exit explain fullschema headers help import imposter indexes iotrace limit lint load log mode nullvalue once open output print prompt quit read restore save scanstats schema separator session shell show stats system tables testcase timeout timer trace vfsinfo vfslist vfsname width"),keywords:o(s+"abort action add after all analyze attach autoincrement before begin cascade case cast check collate column commit conflict constraint cross current_date current_time current_timestamp database default deferrable deferred detach each else end escape except exclusive exists explain fail for foreign full glob if ignore immediate index indexed initially inner instead intersect isnull key left limit match natural no notnull null of offset outer plan pragma primary query raise recursive references regexp reindex release rename replace restrict right rollback row savepoint temp temporary then to transaction trigger unique using vacuum view virtual when with without"),builtin:o("bool boolean bit blob decimal double float long longblob longtext medium mediumblob mediumint mediumtext time timestamp tinyblob tinyint tinytext text clob bigint int int2 int8 integer float double char varchar date datetime year unsigned signed numeric real"),atoms:o("null current_date current_time current_timestamp"),operatorChars:/^[*+\-%<>!=&|/~]/,dateSQL:o("date time timestamp datetime"),support:o("decimallessFloat zerolessFloat"),identifierQuote:'"',hooks:{"@":t,":":t,"?":t,$:t,'"':function(e){for(var t;null!=(t=e.next());)if('"'==t&&!e.eat('"'))return"variable-2";return e.backUp(e.current().length-1),e.eatWhile(/\w/)?"variable-2":null},"`":e}}),a.defineMIME("text/x-cassandra",{name:"sql",client:{},keywords:o("add all allow alter and any apply as asc authorize batch begin by clustering columnfamily compact consistency count create custom delete desc distinct drop each_quorum exists filtering from grant if in index insert into key keyspace keyspaces level limit local_one local_quorum modify nan norecursive nosuperuser not of on one order password permission permissions primary quorum rename revoke schema select set storage superuser table three to token truncate ttl two type unlogged update use user users using values where with writetime"),builtin:o("ascii bigint blob boolean counter decimal double float frozen inet int list map static text timestamp timeuuid tuple uuid varchar varint"),atoms:o("false true infinity NaN"),operatorChars:/^[<>=]/,dateSQL:{},support:o("commentSlashSlash decimallessFloat"),hooks:{}}),a.defineMIME("text/x-plsql",{name:"sql",client:o("appinfo arraysize autocommit autoprint autorecovery autotrace blockterminator break btitle cmdsep colsep compatibility compute concat copycommit copytypecheck define describe echo editfile embedded escape exec execute feedback flagger flush heading headsep instance linesize lno loboffset logsource long longchunksize markup native newpage numformat numwidth pagesize pause pno recsep recsepchar release repfooter repheader serveroutput shiftinout show showmode size spool sqlblanklines sqlcase sqlcode sqlcontinue sqlnumber sqlpluscompatibility sqlprefix sqlprompt sqlterminator suffix tab term termout time timing trimout trimspool ttitle underline verify version wrap"),keywords:o("abort accept access add all alter and any array arraylen as asc assert assign at attributes audit authorization avg base_table begin between binary_integer body boolean by case cast char char_base check close cluster clusters colauth column comment commit compress connect connected constant constraint crash create current currval cursor data_base database date dba deallocate debugoff debugon decimal declare default definition delay delete desc digits dispose distinct do drop else elseif elsif enable end entry escape exception exception_init exchange exclusive exists exit external fast fetch file for force form from function generic goto grant group having identified if immediate in increment index indexes indicator initial initrans insert interface intersect into is key level library like limited local lock log logging long loop master maxextents maxtrans member minextents minus mislabel mode modify multiset new next no noaudit nocompress nologging noparallel not nowait number_base object of off offline on online only open option or order out package parallel partition pctfree pctincrease pctused pls_integer positive positiven pragma primary prior private privileges procedure public raise range raw read rebuild record ref references refresh release rename replace resource restrict return returning returns reverse revoke rollback row rowid rowlabel rownum rows run savepoint schema segment select separate session set share snapshot some space split sql start statement storage subtype successful synonym tabauth table tables tablespace task terminate then to trigger truncate type union unique unlimited unrecoverable unusable update use using validate value values variable view views when whenever where while with work"),builtin:o("abs acos add_months ascii asin atan atan2 average bfile bfilename bigserial bit blob ceil character chartorowid chr clob concat convert cos cosh count dec decode deref dual dump dup_val_on_index empty error exp false float floor found glb greatest hextoraw initcap instr instrb int integer isopen last_day least length lengthb ln lower lpad ltrim lub make_ref max min mlslabel mod months_between natural naturaln nchar nclob new_time next_day nextval nls_charset_decl_len nls_charset_id nls_charset_name nls_initcap nls_lower nls_sort nls_upper nlssort no_data_found notfound null number numeric nvarchar2 nvl others power rawtohex real reftohex round rowcount rowidtochar rowtype rpad rtrim serial sign signtype sin sinh smallint soundex sqlcode sqlerrm sqrt stddev string substr substrb sum sysdate tan tanh to_char text to_date to_label to_multi_byte to_number to_single_byte translate true trunc uid unlogged upper user userenv varchar varchar2 variance varying vsize xml"),operatorChars:/^[*+\-%<>!=~]/,dateSQL:o("date time timestamp"),support:o("doubleQuote nCharCast zerolessFloat binaryNumber hexNumber")}),a.defineMIME("text/x-hive",{name:"sql",keywords:o("select alter $elem$ $key$ $value$ add after all analyze and archive as asc before between binary both bucket buckets by cascade case cast change cluster clustered clusterstatus collection column columns comment compute concatenate continue create cross cursor data database databases dbproperties deferred delete delimited desc describe directory disable distinct distribute drop else enable end escaped exclusive exists explain export extended external false fetch fields fileformat first format formatted from full function functions grant group having hold_ddltime idxproperties if import in index indexes inpath inputdriver inputformat insert intersect into is items join keys lateral left like limit lines load local location lock locks mapjoin materialized minus msck no_drop nocompress not of offline on option or order out outer outputdriver outputformat overwrite partition partitioned partitions percent plus preserve procedure purge range rcfile read readonly reads rebuild recordreader recordwriter recover reduce regexp rename repair replace restrict revoke right rlike row schema schemas semi sequencefile serde serdeproperties set shared show show_database sort sorted ssl statistics stored streamtable table tables tablesample tblproperties temporary terminated textfile then tmp to touch transform trigger true unarchive undo union uniquejoin unlock update use using utc utc_tmestamp view when where while with"),builtin:o("bool boolean long timestamp tinyint smallint bigint int float double date datetime unsigned string array struct map uniontype"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=]/,dateSQL:o("date timestamp"),support:o("ODBCdotTable doubleQuote binaryNumber hexNumber")}),a.defineMIME("text/x-pgsql",{name:"sql",client:o("source"),keywords:o(s+"a abort abs absent absolute access according action ada add admin after aggregate all allocate also always analyse analyze any are array array_agg array_max_cardinality asensitive assertion assignment asymmetric at atomic attribute attributes authorization avg backward base64 before begin begin_frame begin_partition bernoulli binary bit_length blob blocked bom both breadth c cache call called cardinality cascade cascaded case cast catalog catalog_name ceil ceiling chain characteristics characters character_length character_set_catalog character_set_name character_set_schema char_length check checkpoint class class_origin clob close cluster coalesce cobol collate collation collation_catalog collation_name collation_schema collect column columns column_name command_function command_function_code comment comments commit committed concurrently condition condition_number configuration conflict connect connection connection_name constraint constraints constraint_catalog constraint_name constraint_schema constructor contains content continue control conversion convert copy corr corresponding cost covar_pop covar_samp cross csv cube cume_dist current current_catalog current_date current_default_transform_group current_path current_role current_row current_schema current_time current_timestamp current_transform_group_for_type current_user cursor cursor_name cycle data database datalink datetime_interval_code datetime_interval_precision day db deallocate dec declare default defaults deferrable deferred defined definer degree delimiter delimiters dense_rank depth deref derived describe descriptor deterministic diagnostics dictionary disable discard disconnect dispatch dlnewcopy dlpreviouscopy dlurlcomplete dlurlcompleteonly dlurlcompletewrite dlurlpath dlurlpathonly dlurlpathwrite dlurlscheme dlurlserver dlvalue do document domain dynamic dynamic_function dynamic_function_code each element else empty enable encoding encrypted end end-exec end_frame end_partition enforced enum equals escape event every except exception exclude excluding exclusive exec execute exists exp explain expression extension external extract false family fetch file filter final first first_value flag float floor following for force foreign fortran forward found frame_row free freeze fs full function functions fusion g general generated get global go goto grant granted greatest grouping groups handler header hex hierarchy hold hour id identity if ignore ilike immediate immediately immutable implementation implicit import including increment indent index indexes indicator inherit inherits initially inline inner inout input insensitive instance instantiable instead integrity intersect intersection invoker isnull isolation k key key_member key_type label lag language large last last_value lateral lead leading leakproof least left length level library like_regex link listen ln load local localtime localtimestamp location locator lock locked logged lower m map mapping match matched materialized max maxvalue max_cardinality member merge message_length message_octet_length message_text method min minute minvalue mod mode modifies module month more move multiset mumps name names namespace national natural nchar nclob nesting new next nfc nfd nfkc nfkd nil no none normalize normalized nothing notify notnull nowait nth_value ntile null nullable nullif nulls number object occurrences_regex octets octet_length of off offset oids old only open operator option options ordering ordinality others out outer output over overlaps overlay overriding owned owner p pad parallel parameter parameter_mode parameter_name parameter_ordinal_position parameter_specific_catalog parameter_specific_name parameter_specific_schema parser partial partition pascal passing passthrough password percent percentile_cont percentile_disc percent_rank period permission placing plans pli policy portion position position_regex power precedes preceding prepare prepared preserve primary prior privileges procedural procedure program public quote range rank read reads reassign recheck recovery recursive ref references referencing refresh regr_avgx regr_avgy regr_count regr_intercept regr_r2 regr_slope regr_sxx regr_sxy regr_syy reindex relative release rename repeatable replace replica requiring reset respect restart restore restrict restricted result return returned_cardinality returned_length returned_octet_length returned_sqlstate returning returns revoke right role rollback rollup routine routine_catalog routine_name routine_schema row rows row_count row_number rule savepoint scale schema schema_name scope scope_catalog scope_name scope_schema scroll search second section security selective self sensitive sequence sequences serializable server server_name session session_user setof sets share show similar simple size skip snapshot some source space specific specifictype specific_name sql sqlcode sqlerror sqlexception sqlstate sqlwarning sqrt stable standalone start state statement static statistics stddev_pop stddev_samp stdin stdout storage strict strip structure style subclass_origin submultiset substring substring_regex succeeds sum symmetric sysid system system_time system_user t tables tablesample tablespace table_name temp template temporary then ties timezone_hour timezone_minute to token top_level_count trailing transaction transactions_committed transactions_rolled_back transaction_active transform transforms translate translate_regex translation treat trigger trigger_catalog trigger_name trigger_schema trim trim_array true truncate trusted type types uescape unbounded uncommitted under unencrypted unique unknown unlink unlisten unlogged unnamed unnest until untyped upper uri usage user user_defined_type_catalog user_defined_type_code user_defined_type_name user_defined_type_schema using vacuum valid validate validator value value_of varbinary variadic var_pop var_samp verbose version versioning view views volatile when whenever whitespace width_bucket window within work wrapper write xmlagg xmlattributes xmlbinary xmlcast xmlcomment xmlconcat xmldeclaration xmldocument xmlelement xmlexists xmlforest xmliterate xmlnamespaces xmlparse xmlpi xmlquery xmlroot xmlschema xmlserialize xmltable xmltext xmlvalidate year yes loop repeat attach path depends detach zone"),builtin:o("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),a.defineMIME("text/x-gql",{name:"sql",keywords:o("ancestor and asc by contains desc descendant distinct from group has in is limit offset on order select superset where"),atoms:o("false true"),builtin:o("blob datetime first key __key__ string integer double boolean null"),operatorChars:/^[*+\-%<>!=]/}),a.defineMIME("text/x-gpsql",{name:"sql",client:o("source"),keywords:o("abort absolute access action active add admin after aggregate all also alter always analyse analyze and any array as asc assertion assignment asymmetric at authorization backward before begin between bigint binary bit boolean both by cache called cascade cascaded case cast chain char character characteristics check checkpoint class close cluster coalesce codegen collate column comment commit committed concurrency concurrently configuration connection constraint constraints contains content continue conversion copy cost cpu_rate_limit create createdb createexttable createrole createuser cross csv cube current current_catalog current_date current_role current_schema current_time current_timestamp current_user cursor cycle data database day deallocate dec decimal declare decode default defaults deferrable deferred definer delete delimiter delimiters deny desc dictionary disable discard distinct distributed do document domain double drop dxl each else enable encoding encrypted end enum errors escape every except exchange exclude excluding exclusive execute exists explain extension external extract false family fetch fields filespace fill filter first float following for force foreign format forward freeze from full function global grant granted greatest group group_id grouping handler hash having header hold host hour identity if ignore ilike immediate immutable implicit in including inclusive increment index indexes inherit inherits initially inline inner inout input insensitive insert instead int integer intersect interval into invoker is isnull isolation join key language large last leading least left level like limit list listen load local localtime localtimestamp location lock log login mapping master match maxvalue median merge minute minvalue missing mode modifies modify month move name names national natural nchar new newline next no nocreatedb nocreateexttable nocreaterole nocreateuser noinherit nologin none noovercommit nosuperuser not nothing notify notnull nowait null nullif nulls numeric object of off offset oids old on only operator option options or order ordered others out outer over overcommit overlaps overlay owned owner parser partial partition partitions passing password percent percentile_cont percentile_disc placing plans position preceding precision prepare prepared preserve primary prior privileges procedural procedure protocol queue quote randomly range read readable reads real reassign recheck recursive ref references reindex reject relative release rename repeatable replace replica reset resource restart restrict returning returns revoke right role rollback rollup rootpartition row rows rule savepoint scatter schema scroll search second security segment select sequence serializable session session_user set setof sets share show similar simple smallint some split sql stable standalone start statement statistics stdin stdout storage strict strip subpartition subpartitions substring superuser symmetric sysid system table tablespace temp template temporary text then threshold ties time timestamp to trailing transaction treat trigger trim true truncate trusted type unbounded uncommitted unencrypted union unique unknown unlisten until update user using vacuum valid validation validator value values varchar variadic varying verbose version view volatile web when where whitespace window with within without work writable write xml xmlattributes xmlconcat xmlelement xmlexists xmlforest xmlparse xmlpi xmlroot xmlserialize year yes zone"),builtin:o("bigint int8 bigserial serial8 bit varying varbit boolean bool box bytea character char varchar cidr circle date double precision float float8 inet integer int int4 interval json jsonb line lseg macaddr macaddr8 money numeric decimal path pg_lsn point polygon real float4 smallint int2 smallserial serial2 serial serial4 text time without zone with timetz timestamp timestamptz tsquery tsvector txid_snapshot uuid xml"),atoms:o("false true null unknown"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable decimallessFloat zerolessFloat binaryNumber hexNumber nCharCast charsetCast")}),a.defineMIME("text/x-sparksql",{name:"sql",keywords:o("add after all alter analyze and anti archive array as asc at between bucket buckets by cache cascade case cast change clear cluster clustered codegen collection column columns comment commit compact compactions compute concatenate cost create cross cube current current_date current_timestamp database databases datata dbproperties defined delete delimited desc describe dfs directories distinct distribute drop else end escaped except exchange exists explain export extended external false fields fileformat first following for format formatted from full function functions global grant group grouping having if ignore import in index indexes inner inpath inputformat insert intersect interval into is items join keys last lateral lazy left like limit lines list load local location lock locks logical macro map minus msck natural no not null nulls of on option options or order out outer outputformat over overwrite partition partitioned partitions percent preceding principals purge range recordreader recordwriter recover reduce refresh regexp rename repair replace reset restrict revoke right rlike role roles rollback rollup row rows schema schemas select semi separated serde serdeproperties set sets show skewed sort sorted start statistics stored stratify struct table tables tablesample tblproperties temp temporary terminated then to touch transaction transactions transform true truncate unarchive unbounded uncache union unlock unset use using values view when where window with"),builtin:o("tinyint smallint int bigint boolean float double string binary timestamp decimal array map struct uniontype delimited serde sequencefile textfile rcfile inputformat outputformat"),atoms:o("false true null"),operatorChars:/^[*+\-%<>!=~&|^]/,dateSQL:o("date time timestamp"),support:o("ODBCdotTable doubleQuote zerolessFloat")}),a.defineMIME("text/x-esper",{name:"sql",client:o("source"),keywords:o("alter and as asc between by count create delete desc distinct drop from group having in insert into is join like not on or order select set table union update values where limit after all and as at asc avedev avg between by case cast coalesce count create current_timestamp day days delete define desc distinct else end escape events every exists false first from full group having hour hours in inner insert instanceof into irstream is istream join last lastweekday left limit like max match_recognize matches median measures metadatasql min minute minutes msec millisecond milliseconds not null offset on or order outer output partition pattern prev prior regexp retain-union retain-intersection right rstream sec second seconds select set some snapshot sql stddev sum then true unidirectional until update variable weekday when where window"),builtin:{},atoms:o("false true null"),operatorChars:/^[*+\-%<>!=&|^\/#@?~]/,dateSQL:o("time"),support:o("decimallessFloat zerolessFloat binaryNumber hexNumber")})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(x){function a(e,t){this.cm=e,this.options=t,this.widget=null,this.debounce=0,this.tick=0,this.startPos=this.cm.getCursor("start"),this.startLen=this.cm.getLine(this.startPos.line).length-this.cm.getSelection().length;var i=this;e.on("cursorActivity",this.activityFunc=function(){i.cursorActivity()})}function _(e){return"string"==typeof e?e:e.text}function v(e,t){for(;t&&t!=e;){if("LI"===t.nodeName.toUpperCase()&&t.parentNode==e)return t;t=t.parentNode}}function o(o,e){this.completion=o,this.data=e,this.picked=!1;var t,i,a,s,n,r,d=this,l=o.cm,h=this.hints=document.createElement("ul");for(h.className="CodeMirror-hints",this.selectedHint=e.selectedHint||0,t=e.list,i=0;i<t.length;++i){var p=h.appendChild(document.createElement("li")),c=t[i],u="CodeMirror-hint"+(i!=this.selectedHint?"":" "+C);null!=c.className&&(u=c.className+" "+u),p.className=u,c.render?c.render(p,e,c):p.appendChild(document.createTextNode(c.displayText||_(c))),p.hintId=i}var b=l.cursorCoords(o.options.alignWithWord?e.from:null),g=b.left,m=b.bottom,f=!0,D=(h.style.left=g+"px",h.style.top=m+"px",a=window.innerWidth||Math.max(document.body.offsetWidth,document.documentElement.offsetWidth),s=window.innerHeight||Math.max(document.body.offsetHeight,document.documentElement.offsetHeight),(o.options.container||document.body).appendChild(h),h.getBoundingClientRect()),y=D.bottom-s,B=h.scrollHeight>h.clientHeight+1,I=l.getScrollInfo();if(0<y&&(y=D.bottom-D.top,0<b.top-(b.bottom-D.top)-y?(h.style.top=(m=b.top-y)+"px",f=!1):s<y&&(h.style.height=s-5+"px",h.style.top=(m=b.bottom-D.top)+"px",y=l.getCursor(),e.from.ch!=y.ch)&&(b=l.cursorCoords(y),h.style.left=(g=b.left)+"px",D=h.getBoundingClientRect())),0<(s=D.right-a)&&(D.right-D.left>a&&(h.style.width=a-5+"px",s-=D.right-D.left-a),h.style.left=(g=b.left-s)+"px"),B)for(n=h.firstChild;n;n=n.nextSibling)n.style.paddingRight=l.display.nativeBarWidth+"px";return l.addKeyMap(this.keyMap=function(e,a){function t(e,t){var i="string"!=typeof t?function(e){return t(e,a)}:s.hasOwnProperty(t)?s[t]:t;r[e]=i}var i,o,s={Up:function(){a.moveFocus(-1)},Down:function(){a.moveFocus(1)},PageUp:function(){a.moveFocus(1-a.menuSize(),!0)},PageDown:function(){a.moveFocus(a.menuSize()-1,!0)},Home:function(){a.setFocus(0)},End:function(){a.setFocus(a.length-1)},Enter:a.pick,Tab:a.pick,Esc:a.close},n=e.options.customKeys,r=n?{}:s;if(n)for(o in n)n.hasOwnProperty(o)&&t(o,n[o]);if(i=e.options.extraKeys)for(o in i)i.hasOwnProperty(o)&&t(o,i[o]);return r}(o,{moveFocus:function(e,t){d.changeActive(d.selectedHint+e,t)},setFocus:function(e){d.changeActive(e)},menuSize:function(){return d.screenAmount()},length:t.length,close:function(){o.close()},pick:function(){d.pick()},data:e})),o.options.closeOnUnfocus&&(l.on("blur",this.onBlur=function(){r=setTimeout(function(){o.close()},100)}),l.on("focus",this.onFocus=function(){clearTimeout(r)})),l.on("scroll",this.onScroll=function(){var e=l.getScrollInfo(),t=l.getWrapperElement().getBoundingClientRect(),i=m+I.top-e.top,a=i-(window.pageYOffset||(document.documentElement||document.body).scrollTop);if(f||(a+=h.offsetHeight),a<=t.top||a>=t.bottom)return o.close();h.style.top=i+"px",h.style.left=g+I.left-e.left+"px"}),x.on(h,"dblclick",function(e){e=v(h,e.target||e.srcElement);e&&null!=e.hintId&&(d.changeActive(e.hintId),d.pick())}),x.on(h,"click",function(e){e=v(h,e.target||e.srcElement);e&&null!=e.hintId&&(d.changeActive(e.hintId),o.options.completeOnSingleClick)&&d.pick()}),x.on(h,"mousedown",function(){setTimeout(function(){l.focus()},20)}),x.signal(e,"select",t[this.selectedHint],h.childNodes[this.selectedHint]),!0}function r(e,t,i,a){e.async?e(t,a,i):(e=e(t,i))&&e.then?e.then(a):a(e)}var s,n,d,C="CodeMirror-hint-active";x.showHint=function(e,t,i){var a,o;if(!t)return e.showHint(i);if(i&&i.async&&(t.async=!0),a={hint:t},i)for(o in i)a[o]=i[o];return e.showHint(a)},x.defineExtension("showHint",function(e){var t,i;if(e=function(e,t,i){var a,o=e.options.hintOptions,s={};for(a in d)s[a]=d[a];if(o)for(a in o)void 0!==o[a]&&(s[a]=o[a]);if(i)for(a in i)void 0!==i[a]&&(s[a]=i[a]);return s.hint.resolve&&(s.hint=s.hint.resolve(e,t)),s}(this,this.getCursor("start"),e),!(1<(t=this.listSelections()).length)){if(this.somethingSelected()){if(!e.hint.supportsSelection)return;for(i=0;i<t.length;i++)if(t[i].head.line!=t[i].anchor.line)return}this.state.completionActive&&this.state.completionActive.close(),(e=this.state.completionActive=new a(this,e)).options.hint&&(x.signal(this,"startCompletion",this),e.update(!0))}}),s=window.requestAnimationFrame||function(e){return setTimeout(e,1e3/60)},n=window.cancelAnimationFrame||clearTimeout,a.prototype={close:function(){this.active()&&(this.cm.state.completionActive=null,this.tick=null,this.cm.off("cursorActivity",this.activityFunc),this.widget&&this.data&&x.signal(this.data,"close"),this.widget&&this.widget.close(),x.signal(this.cm,"endCompletion",this.cm))},active:function(){return this.cm.state.completionActive==this},pick:function(e,t){t=e.list[t];t.hint?t.hint(this.cm,e,t):this.cm.replaceRange(_(t),t.from||e.from,t.to||e.to,"complete"),x.signal(e,"pick",t),this.close()},cursorActivity:function(){var e,t,i;this.debounce&&(n(this.debounce),this.debounce=0),e=this.cm.getCursor(),t=this.cm.getLine(e.line),e.line!=this.startPos.line||t.length-e.ch!=this.startLen-this.startPos.ch||e.ch<this.startPos.ch||this.cm.somethingSelected()||e.ch&&this.options.closeCharacters.test(t.charAt(e.ch-1))?this.close():((i=this).debounce=s(function(){i.update()}),this.widget&&this.widget.disable())},update:function(t){var i,a;null!=this.tick&&(a=++(i=this).tick,r(this.options.hint,this.cm,this.options,function(e){i.tick==a&&i.finishUpdate(e,t)}))},finishUpdate:function(e,t){this.data&&x.signal(this.data,"update");var i,a,t=this.widget&&this.widget.picked||t&&this.options.completeSingle;this.widget&&this.widget.close(),e&&this.data&&(i=this.data,a=e,0<x.cmpPos(a.from,i.from))&&i.to.ch-i.from.ch!=a.to.ch-a.from.ch||(this.data=e)&&e.list.length&&(t&&1==e.list.length?this.pick(e,0):(this.widget=new o(this,e),x.signal(e,"shown")))}},o.prototype={close:function(){var e;this.completion.widget==this&&(this.completion.widget=null,this.hints.parentNode.removeChild(this.hints),this.completion.cm.removeKeyMap(this.keyMap),e=this.completion.cm,this.completion.options.closeOnUnfocus&&(e.off("blur",this.onBlur),e.off("focus",this.onFocus)),e.off("scroll",this.onScroll))},disable:function(){this.completion.cm.removeKeyMap(this.keyMap);var e=this;this.keyMap={Enter:function(){e.picked=!0}},this.completion.cm.addKeyMap(this.keyMap)},pick:function(){this.completion.pick(this.data,this.selectedHint)},changeActive:function(e,t){e>=this.data.list.length?e=t?this.data.list.length-1:0:e<0&&(e=t?0:this.data.list.length-1),this.selectedHint!=e&&((t=this.hints.childNodes[this.selectedHint]).className=t.className.replace(" "+C,""),(t=this.hints.childNodes[this.selectedHint=e]).className+=" "+C,t.offsetTop<this.hints.scrollTop?this.hints.scrollTop=t.offsetTop-3:t.offsetTop+t.offsetHeight>this.hints.scrollTop+this.hints.clientHeight&&(this.hints.scrollTop=t.offsetTop+t.offsetHeight-this.hints.clientHeight+3),x.signal(this.data,"select",this.data.list[this.selectedHint],t))},screenAmount:function(){return Math.floor(this.hints.clientHeight/this.hints.firstChild.offsetHeight)||1}},x.registerHelper("hint","auto",{resolve:function(e,t){var i,n=e.getHelpers(t,"hint");return n.length?((t=function(e,a,o){var s=function(e,t){var i,a;if(!e.somethingSelected())return t;for(i=[],a=0;a<t.length;a++)t[a].supportsSelection&&i.push(t[a]);return i}(e,n);!function t(i){if(i==s.length)return a(null);r(s[i],e,o,function(e){e&&0<e.list.length?a(e):t(i+1)})}(0)}).async=!0,t.supportsSelection=!0,t):(i=e.getHelper(e.getCursor(),"hintWords"))?function(e){return x.hint.fromList(e,{words:i})}:x.hint.anyword?function(e,t){return x.hint.anyword(e,t)}:function(){}}}),x.registerHelper("hint","fromList",function(e,t){for(var i,a,o=e.getCursor(),e=e.getTokenAt(o),s=x.Pos(o.line,e.end),o=e.string&&/\w/.test(e.string[e.string.length-1])?(i=e.string,x.Pos(o.line,e.start)):(i="",s),n=[],r=0;r<t.words.length;r++)(a=t.words[r]).slice(0,i.length)==i&&n.push(a);if(n.length)return{list:n,from:o,to:s}}),x.commands.autocomplete=x.showHint,d={hint:x.hint.auto,completeSingle:!0,alignWithWord:!0,closeCharacters:/[\s()\[\]{};:>,]/,closeOnUnfocus:!0,completeOnSingleClick:!0,container:null,customKeys:null,extraKeys:null},x.defineOption("hintOptions",null)}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror"),require("../../mode/sql/sql")):"function"==typeof define&&define.amd?define(["../../lib/codemirror","../../mode/sql/sql"],e):e(CodeMirror)}(function(d){function l(e){return"[object Array]"==Object.prototype.toString.call(e)}function h(e){return"string"==typeof e?e:e.text}function p(e,t){return(t=l(t)?{columns:t}:t).text||(t.text=e),t}function b(e){return D[e.toUpperCase()]}function u(e){var t,i={};for(t in e)e.hasOwnProperty(t)&&(i[t]=e[t]);return i}function r(e,t){var i=e.length,t=h(t).substr(0,i);return e.toUpperCase()===t.toUpperCase()}function g(e,t,i,a){var o,s,n;if(l(i))for(o=0;o<i.length;o++)r(t,i[o])&&e.push(a(i[o]));else for(s in i)i.hasOwnProperty(s)&&(n=i[s],n=n&&!0!==n?n.displayText?{text:n.text,displayText:n.displayText}:n.text:s,r(t,n))&&e.push(a(n))}function m(e){for(var t,i=h(e).split("."),a=0;a<i.length;a++)i[a]=I+i[a].replace(new RegExp(I,"g"),I+I)+I;return t=i.join("."),"string"==typeof e?t:((e=u(e)).text=t,e)}function c(e,t,i,a){for(var o,s=!1,n=[],r=t.start,d=!0;d;)d="."==t.string.charAt(0),s=s||t.string.charAt(0)==I,r=t.start,n.unshift(function(e){for(var t=(e="."==e.charAt(0)?e.substr(1):e).split(I+I),i=0;i<t.length;i++)t[i]=t[i].replace(new RegExp(I,"g"),"");return t.join(I)}(t.string)),"."==(t=a.getTokenAt(v(e.line,t.start))).string&&(d=!0,t=a.getTokenAt(v(e.line,t.start)));g(i,l=n.join("."),D,function(e){return s?m(e):e}),g(i,l,y,function(e){return s?m(e):e});var l=n.pop(),h=n.join("."),p=!1,c=h;return b(h)||(h=f(o=h,a))!==o&&(p=!0),(o=(o=b(h))&&o.columns?o.columns:o)&&g(i,l,o,function(e){var t=1==p?c:h;return"string"==typeof e?e=t+"."+e:(e=u(e)).text=t+"."+e.text,s?m(e):e}),r}function f(e,t){for(var i,a,o,s,n=t.doc,r=n.getValue(),d=e.toUpperCase(),l="",h="",p=[],c={start:v(0,0),end:v(t.lastLine(),t.getLineHandle(t.lastLine()).length)},u=r.indexOf(x);-1!=u;)p.push(n.posFromIndex(u)),u=r.indexOf(x,u+1);for(p.unshift(v(0,0)),p.push(v(t.lastLine(),t.getLineHandle(t.lastLine()).text.length)),i=null,a=t.getCursor(),s=0;s<p.length;s++){if((null==i||0<C(a,i))&&C(a,p[s])<=0){c={start:i,end:p[s]};break}i=p[s]}for(o=n.getRange(c.start,c.end,!1),s=0;s<o.length&&(function(e,t){for(var i=e.split(/\s+/),a=0;a<i.length;a++)i[a]&&t(i[a].replace(/[,;]/g,""))}(o[s],function(e){var t=e.toUpperCase();t===d&&b(l)&&(h=l),t!==_&&(l=e)}),!h);s++);return h}var D,y,B,I,x=";",_="AS",v=d.Pos,C=d.cmpPos;d.registerHelper("hint","sql",function(e,t){D=function(e){var t,i,a,o={};if(l(e))for(t=e.length-1;0<=t;t--)o[h(i=e[t]).toUpperCase()]=p(h(i),i);else if(e)for(a in e)o[a.toUpperCase()]=p(a,e[a]);return o}(t&&t.tables),n=t&&t.defaultTable,t=t&&t.disableKeywords,y=n&&b(n),s=(s=e).doc.modeOption,B=d.resolveMode(s="sql"===s?"text/x-sql":s).keywords,s=(s=e).doc.modeOption,I=d.resolveMode(s="sql"===s?"text/x-sql":s).identifierQuote||"`",(y=(y=n&&!y?f(n,e):y)||[]).columns&&(y=y.columns);var i,a,o,s=e.getCursor(),n=[],r=e.getTokenAt(s);return r.end>s.ch&&(r.end=s.ch,r.string=r.string.slice(0,s.ch-r.start)),r.string.match(/^[.`"\w@]\w*$/)?(o=r.string,i=r.start,a=r.end):(i=a=s.ch,o=""),"."==o.charAt(0)||o.charAt(0)==I?i=c(s,r,n,e):(g(n,o,D,function(e){return e}),g(n,o,y,function(e){return e}),t||g(n,o,B,function(e){return e.toUpperCase()})),{list:n,from:v(s.line,i),to:v(s.line,a)}})}),function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(a){function o(e){e.state.placeholder&&(e.state.placeholder.parentNode.removeChild(e.state.placeholder),e.state.placeholder=null)}function s(e){var t,i;o(e),(t=e.state.placeholder=document.createElement("pre")).style.cssText="height: 0; overflow: visible",t.style.direction=e.getOption("direction"),t.className="CodeMirror-placeholder CodeMirror-line-like","string"==typeof(i=e.getOption("placeholder"))&&(i=document.createTextNode(i)),t.appendChild(i),e.display.lineSpace.insertBefore(t,e.display.lineSpace.firstChild)}function n(e){d(e)&&s(e)}function r(e){var t=e.getWrapperElement(),i=d(e);t.className=t.className.replace(" CodeMirror-empty","")+(i?" CodeMirror-empty":""),(i?s:o)(e)}function d(e){return 1===e.lineCount()&&""===e.getLine(0)}a.defineOption("placeholder","",function(e,t,i){var i=i&&i!=a.Init;t&&!i?(e.on("blur",n),e.on("change",r),e.on("swapDoc",r),a.on(e.getInputField(),"compositionupdate",e.state.placeholderCompose=function(){var i;i=e,setTimeout(function(){var e,t=!1;((t=1==i.lineCount()?"TEXTAREA"==(e=i.getInputField()).nodeName?!i.getLine(0).length:!/[^\u200b]/.test(e.querySelector(".CodeMirror-line").textContent):t)?s:o)(i)},20)}),r(e)):!t&&i&&(e.off("blur",n),e.off("change",r),e.off("swapDoc",r),a.off(e.getInputField(),"compositionupdate",e.state.placeholderCompose),o(e),(i=e.getWrapperElement()).className=i.className.replace(" CodeMirror-empty","")),t&&!e.hasFocus()&&n(e)})}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),InternalReplaceValues=function(){function e(e){this.divDialog=null,this.editRuleTbl=null,this.customTable=null,this.matchCaseRow=null,this.replaceValuesInfo=null,this.headerRowDiv=null,this.textBox=null,this.textBoxOne=null,this.replaceTextBox=null,this.replaceTextBoxOne=null,this.matchCaseCheckBox=null,this.matchEntireStringCheckBox=null,this.ruleMatchCaseCheckBox=null,this.ruleMatchEntireStringCheckBox=null,this.replaceRuleTbl=null,this.replaceRuleCancelBtn=null,this.addRuleBtn=null,this.cancelBtn=null,this.applyButton=null,this.tableRowDiv=null,this.lineDiv=null,this.customRuleTableDiv=null,this.headerRow=0,this.customRuleTable=null,this.table=null,this.locale=null,this.target=null,this.replaceValues=[],this.scrollContainer=null,this.replaceValuesScrollElement=null,this.shouldAddRuleActionDiv=!1,this.reloaded=!1,this.isEdited=!1,this.editCancelBtn=null,this.updateBtn=null,this.resetBtn=null,this.divDialogFooter=null,this.closeButton=null,this.backButton=null,this.valueToReplaceDiv=null,this.applyReplaceValuesTimeout=null,this.applyDataSourceReplaceValuesTimeout=null,this.dashboardDesigner=e,this.bbdesigner$=this.dashboardDesigner.bbdesigner$,this.queryDesigner=this.dashboardDesigner.modules.queryDesigner,this.locale=e.getLocalizationContent(),this.id=this.queryDesigner.id;var e={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:"(Null)",valueToReplace:"(Null)",matchCase:!0,matchEntireString:!0},t={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:"(Blanks)",valueToReplace:"(Blanks)",matchCase:!0,matchEntireString:!0};this.replaceValues=[e,t],this.unWireEvents(),this.wireEvents()}return e.prototype.renderReplaceValuesDialog=function(e){void 0===e&&(e=!1),this.divDialog=BoldBIDashboard.buildTag("div.bbi-userselect","",{},{id:this.dashboardDesigner._id+"_replaceValues_dialog"}),this.tableRowDiv=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_table"}),this.customRuleTableDiv=BoldBIDashboard.buildTag("div","",{width:"100%"},{id:this.dashboardDesigner._id+"_replaceValues_customRule_table"}),this.scrollContainer=BoldBIDashboard.buildTag("div.bbi-dbrd-designer-scroller bbi-dbrd-control bbi-dbrd-designer-scroll-style-3","",{height:"140px",display:"block"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_individual_container"}),this.replaceValuesScrollElement=BoldBIDashboard.buildTag("div","",{height:"140px","padding-top":"5px","padding-bottom":"5px"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_scroll_elements"}),this.cancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-secondary bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"-6px"},{id:this.dashboardDesigner._id+"_replaceValues_dialog_btn_cancel",type:"button"}),e=e?this.dashboardDesigner._id+"_replaceValues_dialog_btn_ok_ds":this.dashboardDesigner._id+"_replaceValues_dialog_btn_ok",this.applyButton=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.applyBtnText,{float:"right",right:"-8px"},{id:e,type:"button"}),this.divDialog.append(this.tableRowDiv,this.customRuleTableDiv.append(this.scrollContainer.append(this.replaceValuesScrollElement))),this.editRuleTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",height:"259px"},{});var e=BoldBIDashboard.buildTag("tr","",{height:"25px"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"6%",left:"3%"}),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{padding:"9px","font-weight":"600"},{type:"label"}),a=BoldBIDashboard.buildTag("tr","",{}),t=(this.textBox=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"19%",height:"25px",left:"18px",width:"314px"},{type:"text",id:this.id+"_edit_values_textbox_1"}),r=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%"},{id:this.id+"edit_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(r,this.id),d=BoldBIDashboard.buildTag("tr","",{height:"25px"}),this.valueToReplaceDiv=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"11px",top:"36%"}),o=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToReplaceText,{padding:"9px","font-weight":"600"},{type:"label"}),s=BoldBIDashboard.buildTag("tr","",{}),this.textBoxOne=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"49%",height:"25px",left:"18px",width:"314px"},{type:"text",id:this.id+"_edit_values_textbox_sec"}),n=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%",top:"42%"},{id:this.id+"editReplace_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(n,this.id),this.editRuleTbl.append(e.append(t.append(i)),a.append(this.textBox).append(r),d.append(this.valueToReplaceDiv.append(o)),s.append(this.textBoxOne).append(n)),this.matchCaseRow=BoldBIDashboard.buildTag("tr","",{height:"20px"},{id:this.id+"_replace_values_matchcase_row"}),e=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",left:"22px",top:"159px","margin-top":"14px"}),this.matchCaseCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_values_matchcase_checkbox_1"}),BoldBIDashboard.buildTag("td","",{position:"absolute",left:"33px",top:"175px"})),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchCaseText,{padding:"11px"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"162px",left:"33%","margin-top":"12px"}),o=(this.matchEntireStringCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_values_matchcase_checkbox_2"}),r=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"171px",left:"137px","margin-top":"5px"}),d=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchEntireStringText,{padding:"6px",position:"relative"},{type:"label"}),this.editRuleTbl.append(this.matchCaseRow.append(e.append(this.matchCaseCheckBox),t.append(i),a.append(this.matchEntireStringCheckBox),r.append(d))),this.textBox.on("keyup",this.bbdesigner$.proxy(this.editRuleValueToFindTextBox,this)),this.textBox.on("create",this.bbdesigner$.proxy(this.valueToFindCreate,this)),this.textBoxOne.on("keyup",this.bbdesigner$.proxy(this.editRuleValueToReplaceTextBox,this)),this.textBoxOne.on("create",this.bbdesigner$.proxy(this.valueToReplaceCreate,this)),this.matchCaseCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateMatchCaseCheckBox,this)}),this.matchEntireStringCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.updateMatchEntireStringCheckBox,this)}),this.editRuleTbl.hide(),this.editCancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"5px"},{id:this.id+"_editrule_btn_cancel",type:"button"}),this.updateBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.updateBtnText,{float:"right",right:"4px"},{id:this.id+"_editrule_btn_update",type:"button"}),this.resetBtn=BoldBIDashboard.buildTag("div.bbi-replace-null-blank-reset-icon bbi-dbrd-designer-hoverable","",{},{id:this.id+"_editrule_reset","data-tooltip":this.locale.dialogOptions.resetButtonText}),this.editCancelBtn.on("click",this.bbdesigner$.proxy(this.editCancelAction,this)),this.divDialog.append(this.editRuleTbl),this.replaceRuleTbl=BoldBIDashboard.buildTag("table.bbi-designer-exp-table","",{width:"100%",height:"259px"},{}),BoldBIDashboard.buildTag("tr","",{height:"25px"})),s=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"6%",left:"3%"}),n=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{padding:"9px","font-weight":"600"},{type:"label"}),e=BoldBIDashboard.buildTag("tr","",{}),i=(this.replaceTextBox=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"19%",height:"25px",left:"22px",width:"309px"},{type:"text",id:this.id+"_replace_rule_textbox_1"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",right:"5%"},{id:this.id+"_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(t,this.id),this.replaceRuleTbl.append(o.append(s.append(n)),e.append(this.replaceTextBox).append(t)),BoldBIDashboard.buildTag("tr","",{height:"25px"})),a=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"11px",top:"36%"}),r=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.valueToReplaceText,{padding:"9px","font-weight":"600"},{type:"label"}),d=BoldBIDashboard.buildTag("tr","",{}),s=(this.replaceTextBoxOne=BoldBIDashboard.buildTag("input.e-textbox","",{position:"absolute",top:"49%",height:"25px",left:"22px",width:"309px"},{type:"text",id:this.id+"_replace_rule_textbox_2"}),o=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"42%",right:"5%"},{id:this.id+"replace_error_icon_td"}),this.dashboardDesigner.modules.util.renderErrIndictor(o,this.id),this.replaceRuleTbl.append(i.append(a.append(r)),d.append(this.replaceTextBoxOne).append(o)),BoldBIDashboard.buildTag("tr","",{height:"20px"},{id:this.id+"_replace_rule_matchcase_row"})),n=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",left:"22px",top:"160px","margin-top":"14px"}),e=this.ruleMatchCaseCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_rule_matchcase_checkbox_1"}),t=BoldBIDashboard.buildTag("td","",{position:"absolute",left:"9%",top:"176px"}),i=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchCaseText,{padding:"11px"},{type:"label"}),a=BoldBIDashboard.buildTag("td","",{position:"absolute",float:"left",top:"159px",left:"33%","margin-top":"16px"}),r=this.ruleMatchEntireStringCheckBox=BoldBIDashboard.buildTag("input","",{height:"14px",width:"14px"},{type:"checkbox",id:this.id+"_replace_rule_matchcase_checkbox_2"}),d=BoldBIDashboard.buildTag("td","",{position:"absolute",top:"172px",float:"left",left:"37%","margin-top":"5px"}),o=BoldBIDashboard.buildTag("editLabel.bbi-designer-fontfamily",this.locale.replaceValues.matchEntireStringText,{padding:"6px",position:"relative"},{type:"label"});this.replaceRuleTbl.append(s.append(n.append(e)),t.append(i),a.append(r),d.append(o)),this.replaceTextBox.on("keyup",this.bbdesigner$.proxy(this.addRuleValueToFindTextBox,this)),this.replaceTextBox.on("create",this.bbdesigner$.proxy(this.valueToFindCreateSec,this)),this.replaceTextBoxOne.on("keyup",this.bbdesigner$.proxy(this.addRuleValueToReplaceTextBox,this)),this.replaceTextBoxOne.on("create",this.bbdesigner$.proxy(this.valueToReplaceCreateSec,this)),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.ruleUpdateMatchCaseCheckBox,this)}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({width:"100%",change:this.bbdesigner$.proxy(this.ruleUpdateMatchEntireStringCheckBox,this)}),this.replaceRuleTbl.hide(),this.replaceRuleCancelBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-secondary bbi-dbrd-btn-small bbi-dbrd-margin-left",this.locale.replaceValues.cancelBtnText,{float:"right",right:"5px"},{id:this.id+"_replacerule_dialog_btn_ruleCancel",type:"button"}),this.addRuleBtn=BoldBIDashboard.buildTag("button.bbi-dbrd-btn-small bbi-dbrd-btn-primary",this.locale.replaceValues.addRuleBtnText,{float:"right",right:"4px"},{type:"button",id:this.id+"_replaceRule_dialog_btn_addRule",disabled:!0}),this.replaceRuleCancelBtn.on("click",this.bbdesigner$.proxy(this.closeRuleDialog,this)),this.divDialog.append(this.replaceRuleTbl),this.dashboardDesigner.element.append(this.divDialog),this.divDialog.BoldBIDashboardDialog({title:this.locale.replaceValues.title,actionButtons:["close","back"],width:366,height:"auto",minWidth:367,minHeight:275,enableResize:!1,showOnInit:!1,enableModal:!0,showFooter:!0,containment:"#"+this.dashboardDesigner._id,target:"#"+this.dashboardDesigner._id,create:this.bbdesigner$.proxy(this.addActionButtonIcon,this),actionButtonClick:this.bbdesigner$.proxy(this.headerIconClick,this),cssClass:"bbi-designer-dialog e-flat-mode boldbi-dashboarddesigner bbi-mobile-export",close:this.bbdesigner$.proxy(this.closeDialog,this),closeIconTooltip:this.locale.dialogOptions.closeButtonText}),this.closeButton=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_replaceValues_dialog_closebutton"),this.backButton=this.dashboardDesigner.element.find("#"+this.dashboardDesigner._id+"_replaceValues_dialog_backbutton"),this.closeButton.css("left","4px"),this.closeButton.css("top","11px"),this.backButton.css("padding","4px 3px 1px 5px"),this.backButton.css("font-size","11px"),this.backButton.css("margin-left","5px"),this.backButton.css("top","10px"),this.backButton.css("display","none"),this.divDialogFooter=this.bbdesigner$("#"+this.dashboardDesigner._id+"_replaceValues_dialog_foot"),this.divDialogFooter.append(this.cancelBtn,this.applyButton,this.resetBtn,this.editCancelBtn,this.updateBtn,this.replaceRuleCancelBtn,this.addRuleBtn),this.resetBtn.hide(),this.updateBtn.hide(),this.editCancelBtn.hide(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.scrollContainer.BoldBIDashboardScroller({height:"140px",scrollerSize:this.dashboardDesigner.scrollerSize.scrollSize,enableTouchScroll:!0,autoHide:!1,buttonSize:this.dashboardDesigner.scrollerSize.buttonSize}),this.divDialog.data("BoldBIDashboardDialog").open()},e.prototype.populateReplacingValues=function(e){void 0===e&&(e=null);var t=this.table=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),i=this.replaceValues[0].id,a=this.replaceValues[1].id,o=BoldBIDashboard.buildTag("div","",{"margin-top":"7px","margin-left":"9px","margin-right":"22px"},{}),s=BoldBIDashboard.buildTag("tr","",{height:"20px"},{}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{position:"absolute",top:"7px",left:"12px","font-weight":"600"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{position:"relative",left:"145px","font-weight":"600"}),o=(t.append(o.append(s.append(n,r))),BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{})),s=BoldBIDashboard.buildTag("tr","",{height:"25px"},{id:i}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.nullText,{position:"absolute",top:"44px",left:"14px"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.nullValueText,{position:"relative",top:"6px",left:"145px"}),i=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",left:"325px",top:"44px"}),d=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),o=(t.append(o.append(s.append(n,r,i.append(d)))),BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"17px","margin-left":"9px","margin-right":"9px"},{})),s=BoldBIDashboard.buildTag("tr","",{height:"25px"},{id:a}),n=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.blanksText,{position:"absolute",top:"86px",left:"13px"}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.blanksValueText,{position:"absolute",top:"86px",left:"153px"}),i=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"relative",left:"315px",top:"6px"}),d=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),s=(t.append(o.append(s.append(n,r,i.append(d)))),this.lineDiv=BoldBIDashboard.buildTag("div.bbi-replacevalues-separator","",{}),a=BoldBIDashboard.buildTag("tr","",{height:"10px"}),o=BoldBIDashboard.buildTag("td","",{},{id:this.id+"_replace_values_line_separator"}),t.append(this.lineDiv.append(a).append(o)),this.tableRowDiv.append(t),this.customTable=BoldBIDashboard.buildTag("table","",{"border-collapse":"collapse",width:"100%","table-layout":"fixed"},{}),BoldBIDashboard.buildTag("div","",{"margin-top":"10px","margin-left":"9px","margin-right":"22px"},{})),n=BoldBIDashboard.buildTag("tr","",{height:"10px"},{}),r=BoldBIDashboard.buildTag("td.bbi-designer-fontfamily",this.locale.replaceValues.customRuleText,{"padding-left":"4px","font-weight":"600"}),i=BoldBIDashboard.buildTag("div"," ",{cursor:"pointer",position:"absolute",left:"82%",height:"2px",width:"31px"},{id:this.id+"_replaceValues_dialog_btn_newRule"}),d=BoldBIDashboard.buildTag("td.e-chk-image e-icon e-plus bbi-designer-add-icon e-query-filter-add-icon","",{position:"relative",cursor:"pointer",left:"-15px",top:"2px"},{}),a=BoldBIDashboard.buildTag("td.e-btntxt bbi-designer-add-btn",this.locale.replaceValues.addRuleBtnText,{cursor:"pointer",position:"relative",top:"-16px","white-space":"nowrap",width:"47px"},{});this.customRuleTableDiv.append(this.customTable.append(s.append(n.append(r,i.append(d,a))))),this.renderRowElement(this.customTable,this.replaceValues,e),this.divDialog.data("BoldBIDashboardDialog").open(),this.replaceValuesScrollElement.append(this.customTable),this.scrollerRefresh(this.scrollContainer)},e.prototype.scrollerRefresh=function(e){e.data("BoldBIDashboardScroller")&&e.data("BoldBIDashboardScroller").refresh()},e.prototype.renderRowElement=function(e,t,i){var a,o,s,n,r;if(void 0===i&&(i=null),this.reloaded)for(0==this.customTable.find(".bbi-header").length&&(this.headerRowDiv=BoldBIDashboard.buildTag("div.bbi-header","",{"margin-top":"11px","margin-left":"9px","margin-right":"17px"},{}),s=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"14px",height:"25px"}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{"padding-top":"2px",position:"absolute",left:"4%","font-weight":"600"}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{"padding-top":"2px",position:"absolute",left:"42%","font-weight":"600"}),e.append(this.headerRowDiv.append(s.append(c,u)))),a=2;a<t.length;a++){var d,l=(d=t[a]).id,h=BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{}),p=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"10px",height:"25px"},{id:l}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",d.valueToFind,{"padding-top":"6px",position:"absolute",left:"4%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":d.valueToFind}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",d.valueToReplace,{"padding-top":"6px",position:"absolute",left:"42%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":d.valueToReplace}),b=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",right:"10%","padding-top":"6px"},{}),g=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),m=BoldBIDashboard.buildTag("td.bbi-deleteIcon delete-icon","",{position:"absolute",right:"4%","padding-top":"6px"},{}),f=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-toolbar-delete e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable","",{float:"right","margin-right":"0px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_delete_","data-tooltip":this.locale.dataSource.deleteContextMenu});h.append(p.append(c,u,b.append(g),m.append(f))),e.append(h),1<=(o=this.customTable.find(".bbi-replacevalues")).length?this.headerRowDiv.show():0==o.length&&this.headerRowDiv.hide(),this.scrollerRefresh(this.scrollContainer),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0),this.reloaded=!1}this.shouldAddRuleActionDiv&&2<=this.replaceValues.length&&(0==(s=this.customTable.find(".bbi-header").length)&&(this.headerRowDiv=BoldBIDashboard.buildTag("div.bbi-header","",{"margin-top":"11px","margin-left":"9px","margin-right":"17px"},{}),i=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"14px",height:"20px"}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.valueToFindText,{"padding-top":"2px",position:"absolute",left:"4%","font-weight":"600"}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",this.locale.replaceValues.replaceText,{"padding-top":"2px",position:"absolute",left:"42%","font-weight":"600"}),e.append(this.headerRowDiv.append(i.append(c,u)))),s=this.replaceTextBox.val(),i=this.replaceTextBoxOne.val(),n=this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),r=this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked"),""!=s&&(d={id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:s,valueToReplace:i,matchCase:n,matchEntireString:r},this.replaceValues.push(d),this.replaceTextBox.val(""),this.replaceTextBoxOne.val(""),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1}),l=d.id,h=BoldBIDashboard.buildTag("div.bbi-replacevalues","",{"margin-top":"11px","margin-left":"9px","margin-right":"9px"},{}),p=BoldBIDashboard.buildTag("tr","",{display:"block","margin-left":"9px","margin-right":"22px","margin-top":"10px",height:"25px"},{id:l}),c=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",s,{"padding-top":"6px",position:"absolute",left:"4%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":s}),u=BoldBIDashboard.buildTag("td.bbi-dbrd-designer-hoverable bbi-designer-fontfamily",i,{"padding-top":"6px",position:"absolute",left:"42%",overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap","max-width":"35%"},{"data-tooltip":i}),b=BoldBIDashboard.buildTag("td.bbi-designer-edit-wrapper value-edit-icon","",{position:"absolute",right:"10%","padding-top":"6px"},{}),g=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-parameter-edit e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable bb-editbutton","",{float:"right","margin-right":"2px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_edit_","data-tooltip":this.locale.dataSource.editContextMenu}),m=BoldBIDashboard.buildTag("td.bbi-deleteIcon delete-icon","",{position:"absolute",right:"4%","padding-top":"6px"},{}),f=BoldBIDashboard.buildTag("span.bbi-designer-content-icon bbi-designer-toolbar-delete e-tooltip bbi-designer-click bbi-dbrd-designer-hoverable","",{float:"right","margin-right":"0px","margin-left":"12px","font-size":"12px"},{id:this.id+"_replace_values_delete_","data-tooltip":this.locale.dataSource.deleteContextMenu}),h.append(p.append(c,u,b.append(g),m.append(f))),e.append(h),1<=(o=this.customTable.find(".bbi-replacevalues")).length?this.headerRowDiv.show():0==o.length&&this.headerRowDiv.hide(),this.scrollerRefresh(this.scrollContainer),this.shouldAddRuleActionDiv=!1,BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)),this.scrollerRefresh(this.scrollContainer))},e.prototype.handleAddRuleActionClick=function(){this.shouldAddRuleActionDiv=!0;var e=this.target;this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.updateButtonVisibility(!1),this.addRuleBtn.prop("disabled",!0),this.renderRowElement(this.customTable,this.replaceValues,e)},e.prototype.addActionButtonIcon=function(){this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_title").find("#"+this.id+"_replaceValues_dialog_backbutton").addClass("bbi-dbrd-export-titleBackIcon bbi-dbrd-icon-background-theme")},e.prototype.headerIconClick=function(e){var t=this;"back"===e.currentTarget&&setTimeout(function(){t.replaceTextBox.val(""),t.replaceTextBoxOne.val(""),t.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),t.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1}),t.addRuleBtn.prop("disabled",!0),t.editRuleTbl.hide(),t.tableRowDiv.show(),t.replaceRuleTbl.hide(),t.customRuleTableDiv.show(),t.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),t.updateButtonVisibility(!1),1<=t.customTable.find(".bbi-header").length&&t.headerRowDiv.show(),t.dashboardDesigner.element.find("#"+t.id+"_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"edit_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"editReplace_error_icon_td").css("display","none"),t.dashboardDesigner.element.find("#"+t.id+"replace_error_icon_td").css("display","none"),t.textBox.removeClass("bbi-designer-error"),t.textBoxOne.removeClass("bbi-designer-error"),t.replaceTextBox.removeClass("bbi-designer-error"),t.replaceTextBoxOne.removeClass("bbi-designer-error")},100)},e.prototype.openReplaceValuesDialog=function(e){this.target=this.bbdesigner$(e.target),this.renderReplaceValuesDialog(),this.populateReplacingValues(this.target),e=this.queryDesigner.dataset.Id,this.replaceValues=this.replaceValues.slice(0,2);for(var t,i=this.target.closest("li").text(),a=(this.target.closest("li").attr("datatype"),this.queryDesigner.tableType),o=0;o<a.length;o++)if(i==a[o].Name){t=a[o].ID;break}this.dashboardDesigner.modules.util.doAjaxPost("POST",this.queryDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.ReplaceValuesAction,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.ReplaceValuesAction,dataSetId:e,fieldId:t,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.onReplaceValuesSuccess,this)})},e.prototype.openDataSourceReplaceValuesDialog=function(){this.renderReplaceValuesDialog(!0),this.populateReplacingValues(),this.lineDiv.hide(),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_individual_container").hide(),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog").css("min-height","175px"),this.editRuleTbl.css("height","2px"),this.valueToReplaceDiv.css("top","48%"),this.applyButton.css("right","4px"),this.cancelBtn.css("right","5px"),this.dashboardDesigner.element.find("#"+this.id+"_edit_values_textbox_sec").css("top","65%"),this.dashboardDesigner.element.find("#"+this.id+"_edit_values_textbox_1").css("top","25%"),this.replaceValues=this.replaceValues.slice(0,2);var e=this.queryDesigner.dataset.Id;this.dashboardDesigner.modules.util.doAjaxPost("POST",this.queryDesigner.model.serviceUrl+BoldBIDashboard.Dashboard.ServiceAPI.processdata,{action:BoldBIDashboard.DashboardUtil.DesignerAction.GetDatasourceReplaceValuesAction,data:JSON.stringify({className:BoldBIDashboard.DashboardUtil.DesignerAction.DataDesignViewAction,designerAction:BoldBIDashboard.DashboardUtil.DesignerAction.GetDatasourceReplaceValuesAction,dataSetId:e,isQueryDesignerMode:this.dashboardDesigner.isQueryDesignerMode})},{fnction:this.bbdesigner$.proxy(this.onReplaceValuesSuccess,this)})},e.prototype.onReplaceValuesSuccess=function(e){var t,i,a,o;if(0!=(this.replaceValuesInfo=e).length&&!BoldBIDashboard.isNullOrUndefined(e)){for(t=this.replaceValues[0].id,i=this.replaceValues[1].id,this.replaceValues=[],a=0;a<e.length;a++)o=e[a],this.replaceValues.push({id:this.dashboardDesigner.modules.util.generateGuid(),valueToFind:o.ValueToFind,valueToReplace:" "===o.ValueToReplace?"":o.ValueToReplace,matchCase:o.ShouldMatchCase,matchEntireString:o.ShouldMatchEntireString});this.replaceValues[0].id=t,this.replaceValues[1].id=i,this.replaceValues[0].valueToFind="Null",this.replaceValues[1].valueToFind="Blanks",0<this.replaceValues.length&&this.updateReplaceValuesInfo(this.replaceValues)}},e.prototype.updateReplaceValuesInfo=function(){this.populateReplaceValuesInfo(this.replaceValues),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.populateReplaceValuesInfo=function(){for(var e,t=0;t<this.replaceValues.length;t++){var i=this.replaceValues[t].id,a=this.replaceValues[t].valueToFind,o=this.replaceValues[t].valueToReplace,i=this.table.find("#"+i),s=i.find("td:first"),i=i.find("td:nth-child(2)");s.text(a),i.text(o)}if(0<(e=Math.max(0,this.replaceValues.length-2)))for(this.reloaded=!0,t=0;t<e;t++)this.renderRowElement(this.customTable,this.replaceValues,this.target)},e.prototype.ruleUpdateMatchCaseCheckBox=function(){this.ruleMatchCaseTemp=this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.ruleUpdateMatchEntireStringCheckBox=function(){this.ruleMatchEntireStringTemp=this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.updateMatchCaseCheckBox=function(){this.matchCaseTemp=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.updateMatchEntireStringCheckBox=function(){this.matchEntireStringTemp=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked")},e.prototype.valueToFindCreate=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.editRuleValueToFindTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.editRuleValueToFindTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.textBox.val().trim()),i="",a=!0;""===t?a=!(i="Value cannot be empty"):"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number to search"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date to search"),e=this.dashboardDesigner.element.find("#"+this.id+"edit_error_icon_td"),a?(this.textBox.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.textBox.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.updateBtn.prop("disabled",""===t||!a)},e.prototype.editRuleValueToReplaceTextBox=function(){var e,t,i,a;"Null"!==this.textBox.val()&&"(Null)"!==this.textBox.val()&&"Blanks"!==this.textBox.val()&&"(Blanks)"!==this.textBox.val()&&(e=this.target.closest("li").attr("e-column-type"),BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),t=this.textBoxOne.val().trim(),a=!(i=""),"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number for replacement"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date for replacement"),e=this.dashboardDesigner.element.find("#"+this.id+"editReplace_error_icon_td"),a?(this.textBoxOne.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.textBoxOne.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.updateBtn.prop("disabled",!a))},e.prototype.valueToReplaceCreate=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.editRuleValueToReplaceTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.valueToFindCreateSec=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.addRuleValueToFindTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.valueToReplaceCreateSec=function(e){var t=this;e.keyup(this.bbdesigner$.proxy(function(e){t.addRuleValueToReplaceTextBox(t.bbdesigner$(e.target),t.bbdesigner$(e.target).val())},this))},e.prototype.addRuleValueToFindTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.replaceTextBox.val().trim()),i="",a=!0;""===t?a=!(i="Value cannot be empty"):this.replaceValues.some(function(e){return e.valueToFind.toLowerCase()===t.toLowerCase()})?(i="The value '".concat(t,"' is already added in the custom rule for replacement"),a=!1):"Number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number to search"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date to search"),e=this.dashboardDesigner.element.find("#"+this.id+"_error_icon_td"),a?(this.replaceTextBox.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.replaceTextBox.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.addRuleBtn.prop("disabled",""===t||!a)},e.prototype.addRuleValueToReplaceTextBox=function(){var e=this.target.closest("li").attr("e-column-type"),t=(BoldBIDashboard.isNullOrUndefined(e)&&(e=this.target.closest("li").attr("datatype")),this.replaceTextBoxOne.val()),i="",a=!0;"number"===e||"Integer"===e||"Real"===e?(a=!isNaN(Number(t)),i="Please enter a valid number for replacement"):"String"===e?a=!0:"Date"===e&&(a=!isNaN(Date.parse(t)),i="Please enter a valid date for replacement"),e=this.dashboardDesigner.element.find("#"+this.id+"replace_error_icon_td"),a?(this.replaceTextBoxOne.removeClass("bbi-designer-error"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!1,i)):(this.replaceTextBoxOne.addClass("bbi-designer-error"),e.css("display","block"),BoldBIDashboard.DashboardUtil.showErrIndictor(e,!0,i)),this.addRuleBtn.prop("disabled",!a)},e.prototype.ReplaceValues=function(){var e,t,i,a,o=[];for(this.replaceValues[0].valueToFind="(Null)",this.replaceValues[1].valueToFind="(Blanks)",e=0,t=this.replaceValues;e<t.length;e++)i=t[e],(a=new BoldBIDashboard.ReplaceValuesInfoForUI).ValueToFind=i.valueToFind,a.ValueToReplace=""===i.valueToReplace?" ":i.valueToReplace,a.ShouldMatchCase=i.matchCase,a.ShouldMatchEntireString=i.matchEntireString,o.push(a);return 2<this.replaceValues.length&&(this.replaceValues=this.replaceValues.slice(0,2)),o},e.prototype.ReplaceValuesDatasource=function(){var e,t,i,a,o=[];for(this.replaceValues[0].valueToFind="(Null)",this.replaceValues[1].valueToFind="(Blanks)",e=0,t=this.replaceValues;e<t.length;e++)i=t[e],(a=new BoldBIDashboard.ReplaceValuesDataSource).ValueToFind=i.valueToFind,a.ValueToReplace=""===i.valueToReplace?" ":i.valueToReplace,a.ShouldMatchCase=i.matchCase,a.ShouldMatchEntireString=i.matchEntireString,o.push(a);return 2<this.replaceValues.length&&(this.replaceValues=this.replaceValues.slice(0,2)),o},e.prototype.applyReplaceValues=function(){var e=this.ReplaceValues(),t=-1!==this.applyButton.attr("id").indexOf("_ds");this.dashboardDesigner.modules.queryDesigner.renderReplaceValuesDialog(e,t),BoldBIDashboard.isNullOrUndefined(e)||this.closeDialog(),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.applyReplaceValuesWithTimeout=function(){var e=this;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),clearTimeout(this.applyReplaceValuesTimeout),this.applyReplaceValuesTimeout=setTimeout(function(){e.applyReplaceValues()},250)},e.prototype.applyDataSourceReplaceValuesWithTimeout=function(){var e=this;BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime(),clearTimeout(this.applyDataSourceReplaceValuesTimeout),this.applyDataSourceReplaceValuesTimeout=setTimeout(function(){e.applyDataSourceReplaceValues()},250)},e.prototype.applyDataSourceReplaceValues=function(){var e=this.ReplaceValuesDatasource(),t=-1!==this.applyButton.attr("id").indexOf("_ds");this.dashboardDesigner.modules.queryDesigner.renderReplaceValuesDialog(e,t),BoldBIDashboard.isNullOrUndefined(e)||this.closeDialog(),BoldBIDashboard.DashboardUtil.buttonEnable(this.applyButton,!0)},e.prototype.editAction=function(e){var t,i,a,o,s,n;for(this.tableRowDiv.hide(),this.customRuleTableDiv.hide(),this.editRuleTbl.show(),t=e.currentTarget.closest("tr").id,i=-1,a=0;a<this.replaceValues.length;a++)if(this.replaceValues[a].id===t){i=a;break}-1!==i&&(this.editedIndex=i,this.isEdited=!0,o=(e=this.replaceValues[i]).valueToFind,s=e.valueToReplace,n=e.matchCase,e=e.matchEntireString,this.matchCaseCheckBox.BoldBIDashboardCheckBox({checked:n}),this.matchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:e}),"(Null)"==o||"(Blanks)"==o||"Null"==o||"Blanks"==o?(this.matchCaseRow.hide(),this.textBox.attr("disabled","disabled")):(this.matchCaseRow.show(),this.textBox.removeAttr("disabled")),this.textBox.val(o="(Null)"===o?"Null":"(Blanks)"===o?"Blanks":o),this.textBoxOne.val(s),this.dashboardDesigner.element.find("#"+this.id+"_replaceValues_dialog_closebutton").hide(),this.backButton.css("display","block"),this.divDialog.data("BoldBIDashboardDialog").setTitle(this.locale.replaceValues.editRuleTitle),this.applyButton.hide(),this.cancelBtn.hide(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.resetBtn.show(),this.updateBtn.show(),this.editCancelBtn.show(),this.updateBtn.prop("disabled",!1))},e.prototype.deleteAction=function(e){for(var t=e.currentTarget.closest("tr").id,e=e.currentTarget.closest("div"),i=-1,a=0;a<this.replaceValues.length;a++)if(this.replaceValues[a].id===t){i=a;break}-1!==i&&(this.replaceValues.splice(i,1),this.customTable.find("#"+t).remove(),this.dashboardDesigner.element.find(e).remove(),this.scrollerRefresh(this.scrollContainer)),2==this.replaceValues.length?this.customTable.find(".bbi-header").remove():this.headerRowDiv.show()},e.prototype.closeRuleDialog=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.updateButtonVisibility(!1),this.replaceTextBox.val(""),this.replaceTextBoxOne.val(""),this.ruleMatchCaseCheckBox.BoldBIDashboardCheckBox({checked:!1}),this.ruleMatchEntireStringCheckBox.BoldBIDashboardCheckBox({checked:!1})},e.prototype.updateResetValue=function(){var e=this.textBox.val();"Null"===e||"(Null)"===e?this.textBoxOne.val("(Null)"):"Blanks"!==e&&"(Blanks)"!==e||this.textBoxOne.val("(Blanks)")},e.prototype.updateRule=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons();var e,t=this.textBox.val(),i=this.textBoxOne.val(),a=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),o=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked");!BoldBIDashboard.isNullOrUndefined(this.editedIndex)&&this.isEdited&&(e=this.replaceValues[this.editedIndex],BoldBIDashboard.isNullOrUndefined(e)||(e.valueToFind=t,e.valueToReplace=i,e.matchCase=a,e.matchEntireString=o,a=e.id,o=null,e=(o=("Null"===t||"(Null)"===t||"Blanks"===t||"(Blanks)"===t?this.table:this.customTable).find("#"+a)).find("td:first"),a=o.find("td:nth-child(2)"),e.text(t),a.text(i),e.attr("data-tooltip",t),a.attr("data-tooltip",i),this.editedIndex=-1))},e.prototype.editCancelAction=function(){this.tableRowDiv.show(),this.customRuleTableDiv.show(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle("Replace Values"),this.replaceRuleTbl.hide(),this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons();var e=this.replaceValues[this.editedIndex],t=this.textBox.val(),t=t!==BoldBIDashboard.isNullOrUndefined?t:null,i=this.textBoxOne.val(),i=i!==BoldBIDashboard.isNullOrUndefined?i:null,a=this.matchCaseCheckBox.BoldBIDashboardCheckBox("isChecked"),o=this.matchEntireStringCheckBox.BoldBIDashboardCheckBox("isChecked");this.isEdited=!(BoldBIDashboard.isNullOrUndefined(e)||BoldBIDashboard.isNullOrUndefined(t)||BoldBIDashboard.isNullOrUndefined(i)||""==this.textBox.val()||""==this.textBoxOne.val()||t===e.valueToFind&&i===e.valueToReplace&&a===e.matchCase&&o===e.matchEntireString),this.dashboardDesigner.element.find("#"+this.id+"_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"edit_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"editReplace_error_icon_td").css("display","none"),this.dashboardDesigner.element.find("#"+this.id+"replace_error_icon_td").css("display","none"),this.textBox.removeClass("bbi-designer-error"),this.textBoxOne.removeClass("bbi-designer-error"),this.replaceTextBox.removeClass("bbi-designer-error"),this.replaceTextBoxOne.removeClass("bbi-designer-error")},e.prototype.customRule=function(){this.tableRowDiv.hide(),this.customRuleTableDiv.hide(),this.editRuleTbl.hide(),this.divDialog.data("BoldBIDashboardDialog").setTitle(this.locale.replaceValues.addRuleTitle),this.replaceRuleTbl.show(),this.updateButtonVisibility(!0)},e.prototype.replaceValuesDialogButtons=function(){this.applyButton.show(),this.cancelBtn.show(),this.addRuleBtn.hide(),this.replaceRuleCancelBtn.hide(),this.resetBtn.hide(),this.updateBtn.hide(),this.editCancelBtn.hide()},e.prototype.updateButtonVisibility=function(e){e?(this.closeButton.hide(),this.backButton.css("display","block"),this.applyButton.hide(),this.cancelBtn.hide(),this.editCancelBtn.hide(),this.resetBtn.hide(),this.updateBtn.hide(),this.addRuleBtn.show(),this.replaceRuleCancelBtn.show()):(this.closeButton.show(),this.backButton.css("display","none"),this.replaceValuesDialogButtons())},e.prototype.wireEvents=function(){this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_newRule",this.bbdesigner$.proxy(this.customRule,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_ok",this.bbdesigner$.proxy(this.applyReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_ok_ds",this.bbdesigner$.proxy(this.applyDataSourceReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceValues_dialog_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_editrule_btn_update",this.bbdesigner$.proxy(this.updateRule,this)),this.dashboardDesigner.element.on("click",".bbi-replace-null-blank-reset-icon",this.bbdesigner$.proxy(this.updateResetValue,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replace_values_edit_",this.bbdesigner$.proxy(this.editAction,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replace_values_delete_",this.bbdesigner$.proxy(this.deleteAction,this)),this.dashboardDesigner.element.on("click","#"+this.id+"_replaceRule_dialog_btn_addRule",this.bbdesigner$.proxy(this.handleAddRuleActionClick,this))},e.prototype.unWireEvents=function(){this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_newRule",this.bbdesigner$.proxy(this.customRule,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_cancel",this.bbdesigner$.proxy(this.closeDialog,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_ok",this.bbdesigner$.proxy(this.applyReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceValues_dialog_btn_ok_ds",this.bbdesigner$.proxy(this.applyDataSourceReplaceValuesWithTimeout,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_editrule_btn_update",this.bbdesigner$.proxy(this.updateRule,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replace_values_edit_",this.bbdesigner$.proxy(this.editAction,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replace_values_delete_",this.bbdesigner$.proxy(this.deleteAction,this)),this.dashboardDesigner.element.off("click","#"+this.id+"_replaceRule_dialog_btn_addRule",this.bbdesigner$.proxy(this.handleAddRuleActionClick,this))},e.prototype.closeDialog=function(){BoldBIDashboard.isNullOrUndefined(this.queryDesigner)||this.queryDesigner.updateCurrentSessionTime();var e=this.divDialog.data("BoldBIDashboardDialog");BoldBIDashboard.isNullOrUndefined(e)||e.close(),BoldBIDashboard.isNullOrUndefined(this.replaceValues)||0===this.replaceValues.length||(this.replaceValues[0].valueToFind="Null",this.replaceValues[1].valueToFind="Blanks",this.replaceValues[0].valueToReplace="(Null)",this.replaceValues[1].valueToReplace="(Blanks)")},e.prototype.destroy=function(){this.unWireEvents()},e}(),function(e){__extends(a,t=InternalReplaceValues);var t,i=a;function a(){return null!==t&&t.apply(this,arguments)||this}e.ReplaceValues=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){t=ReplaceData,__extends(a,t);var t,i=a;function a(){return t.call(this)||this}e.ReplaceValuesInfoForUI=i}(BoldBIDashboard=BoldBIDashboard||{}),__extends=this&&this.__extends||function(){var a=function(e,t){return(a=Object.setPrototypeOf||({__proto__:[]}instanceof Array?function(e,t){e.__proto__=t}:function(e,t){for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i])}))(e,t)};return function(e,t){function i(){this.constructor=e}if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");a(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}(),function(e){t=DataSourceCustomizeValues,__extends(a,t);var t,i=a;function a(){return t.call(this)||this}e.ReplaceValuesDataSource=i}(BoldBIDashboard=BoldBIDashboard||{});