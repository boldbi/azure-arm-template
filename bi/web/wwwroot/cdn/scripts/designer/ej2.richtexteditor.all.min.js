/*!
*  filename: ej2.richtexteditor.all.min.js
*  version : 6.15.7.7
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={665:(n,t)=>{t.J=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function o(n,i){for(var f,r=t.extend({},n),u=0,e=Object.keys(r);u<e.length;u++)f=e[u],i.indexOf(f)<0&&t.deleteObject(r,f);return r}function rt(n,i){var f=40===i?0:n.childElementCount-1,r=f,e=n.querySelector(".e-selected"),u,o;for(e&&e.classList.remove("e-selected"),u=0,o=n.children.length;u<o;u++)n.children[u].classList.contains("e-focused")&&(r=u,n.children[u].classList.remove("e-focused"),40===i?r++:r--,r===(40===i?n.childElementCount:-1)&&(r=f));-1!==(r=ut(n,n.children[r],r,i))&&(t.addClass([n.children[r]],"e-focused"),n.children[r].focus())}function ut(n,t,i,r,u){if(void 0===u&&(u=0),(t.classList.contains("e-separator")||t.classList.contains("e-disabled"))&&(i===(40===r?n.childElementCount-1:0)?i=40===r?0:n.childElementCount-1:40===r?i++:i--),(t=n.children[i]).classList.contains("e-separator")||t.classList.contains("e-disabled")){if(++u===n.childElementCount)return-1;i=ut(n,t,i,r,u)}return i}function ft(n){var f=[].slice.call(n.getElementsByClassName("e-blank-icon")),t,i,r,e,u;f.length&&(t=n.querySelector(".e-item:not(.e-blank-icon):not(.e-separator)"),t.classList.contains("e-url")&&(t=t.querySelector(".e-menu-url")),r=t.querySelector(".e-menu-icon"),e=n.classList.contains("e-rtl"),i=e?{padding:"paddingRight",margin:"marginLeft"}:{padding:"paddingLeft",margin:"marginRight"},u=parseInt(getComputedStyle(r).fontSize,10)+parseInt(getComputedStyle(r)[i.margin],10)+parseInt(getComputedStyle(t).paddingLeft,10)+"px",f.forEach(function(n){n.classList.contains("e-url")?n.querySelector(".e-menu-url").style[i.padding]=u:n.style[i.padding]=u}))}function yt(n,i,r){var e,o,l,u,f,h,c,s;for(void 0===i&&(i={}),t.isNullOrUndefined(r)&&(r=t.createElement),f=document.querySelector(n),t.addClass([f],["e-btn-group","e-css"]),f.setAttribute("role","group"),h=f.children,i.buttons=i.buttons||[],c=0,s=0;s<h.length;c++,s++)e=h[s],null!==(u=i.buttons[c])&&("BUTTON"===e.tagName?o=e:(o=r("label"),(l=h[s+1])?f.insertBefore(o,l):f.appendChild(o),e.id&&o.setAttribute("for",e.id),u&&u.disabled&&(e.disabled=!0),s++),i.cssClass&&u&&!u.cssClass&&(u.cssClass=i.cssClass),new y.Button(u||{},o));return f}var l,a,v,it,f,s,ct;l={};n.r(l);n.d(l,{AnimationSettings:()=>ht,Deferred:()=>d,DropDownButton:()=>b,Item:()=>s,ProgressButton:()=>pt,SpinSettings:()=>st,SplitButton:()=>vt,createButtonGroup:()=>yt,getModel:()=>o,setBlankIconStyle:()=>ft,upDownKeyHandler:()=>rt});a=n(665);const t=ejdashboard.base;it=(v=function(n,t){return v=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},v(n,t)},function(n,t){function i(){this.constructor=n}v(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)});f=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u};s=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return it(i,n),f([t.Property("")],i.prototype,"iconCss",void 0),f([t.Property("")],i.prototype,"id",void 0),f([t.Property(!1)],i.prototype,"separator",void 0),f([t.Property("")],i.prototype,"text",void 0),f([t.Property("")],i.prototype,"url",void 0),f([t.Property(!1)],i.prototype,"disabled",void 0),i}(t.ChildProperty);const y=ejdashboard.buttons,h=ejdashboard.popups;var lt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},w="e-item",et="e-vertical",b=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.isPopupCreated=!0,r}return lt(i,n),i.prototype.preRender=function(){},i.prototype.getPersistData=function(){return this.addOnPersist([])},i.prototype.toggle=function(){this.canOpen()?this.openPopUp():this.closePopup()},i.prototype.render=function(){this.initialize();this.disabled||this.wireEvents();this.renderComplete()},i.prototype.addItems=function(n,t){for(var r,u,f=this.items.length,i=0,e=this.items.length;i<e;i++)if(t===this.items[i].text){f=i;break}for(r=n.length-1;r>=0;r--)u=new s(this,"items",n[r],!0),this.items.splice(f,0,u);this.canOpen()||this.createItems()},i.prototype.removeItems=function(n,t){for(var i,f,u=!1,r=0,e=n.length;r<e;r++)for(i=0,f=this.items.length;i<f;i++)if(n[r]===(t?this.items[i].id:this.items[i].text)){this.items.splice(i,1);u=!0;break}u&&this.getULElement()&&this.createItems()},i.prototype.createPopup=function(){var n,i=this.createElement("div",{className:"e-dropdown-popup",id:this.element.id+"-popup"});document.body.appendChild(i);this.dropDown=new h.Popup(i,{relateTo:this.element,collision:{X:"fit",Y:"flip"},position:{X:"left",Y:"bottom"},targetType:"relative",content:this.target?this.getTargetElement():"",enableRtl:this.enableRtl});"fixed"===this.dropDown.element.style.position&&this.dropDown.refreshPosition(this.element);this.dropDown.hide();t.attributes(this.element,((n={})["aria-haspopup"]=this.items.length||this.target?"true":"false",n["aria-expanded"]="false",n["aria-owns"]=this.getPopUpElement().id,n.type="button",n["aria-label"]=this.element.textContent+" dropdownbutton",n));this.cssClass&&t.addClass([i],this.cssClass.split(" "));this.isPopupCreated=!0},i.prototype.getTargetElement=function(){return"string"==typeof this.target?t.select(this.target):this.target},i.prototype.createItems=function(n){var e,i,r,o,s=this.items,h=this.hasIcon(this.items,"iconCss"),u=this.getULElement(),f,c;for(u?u.innerHTML="":u=this.createElement("ul",{attrs:{role:"menu",tabindex:"0"}}),f=0;f<s.length;f++)i=s[f],c=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(i.text):i.text,r=this.createElement("li",{innerHTML:i.url?"":c,className:i.separator?w+" e-separator":w,attrs:{role:"menuItem",tabindex:"-1"},id:i.id?i.id:t.getUniqueID("e-"+this.getModuleName()+"-item")}),i.url&&(r.appendChild(this.createAnchor(i)),r.classList.add("e-url")),i.iconCss?(e=this.createElement("span",{className:"e-menu-icon "+i.iconCss}),i.url?r.childNodes[0].appendChild(e):r.insertBefore(e,r.childNodes[0])):h&&!i.separator&&r.classList.add("e-blank-icon"),i.disabled&&r.classList.add("e-disabled"),o={item:i,element:r},this.trigger("beforeItemRender",o),u.appendChild(r);n&&this.getPopUpElement().appendChild(u);h&&ft(this.getPopUpElement())},i.prototype.hasIcon=function(n,t){for(var i=0,r=n.length;i<r;i++)if(n[i][t])return!0;return!1},i.prototype.createAnchor=function(n){var i=this.enableHtmlSanitizer?t.SanitizeHtmlHelper.sanitize(n.text):n.text;return this.createElement("a",{className:"e-menu-text e-menu-url",innerHTML:i,attrs:{href:n.url}})},i.prototype.initialize=function(){this.button=new y.Button({iconCss:this.iconCss,iconPosition:this.iconPosition,cssClass:this.cssClass,content:this.content,disabled:this.disabled,enableRtl:this.enableRtl,enablePersistence:this.enablePersistence});this.button.createElement=this.createElement;this.button.appendTo(this.element);this.element.id||(this.element.id=t.getUniqueID("e-"+this.getModuleName()));this.appendArrowSpan();this.setActiveElem([this.element]);this.target&&!this.isColorPicker()||!this.createPopupOnClick?this.createPopup():this.isPopupCreated=!1},i.prototype.isColorPicker=function(){if(!this.element)return!1;var n=this.element.previousSibling;return!!(n&&n.classList&&n.classList.contains("e-split-colorpicker"))},i.prototype.appendArrowSpan=function(){this.element.appendChild(this.createElement("span",{className:"e-btn-icon e-icons e-icon-"+(this.cssClass.indexOf(et)>-1?"bottom":"right")+" e-caret"}))},i.prototype.setActiveElem=function(n){this.activeElem=n},i.prototype.getModuleName=function(){return"dropdown-btn"},i.prototype.canOpen=function(){var n=!1;return this.isPopupCreated&&(n=this.getPopUpElement().classList.contains("e-popup-close")),n},i.prototype.destroy=function(){var i,r=this;n.prototype.destroy.call(this);"dropdown-btn"===this.getModuleName()&&(this.element.querySelector("span.e-caret")&&t.detach(this.element.querySelector("span.e-caret")),this.cssClass&&(i=this.cssClass.split(" ")),this.button.destroy(),i&&t.removeClass([this.element],i),t.removeClass(this.activeElem,["e-active"]),(this.element.getAttribute("class")?["aria-haspopup","aria-expanded","aria-owns","type"]:["aria-haspopup","aria-expanded","aria-owns","type","class"]).forEach(function(n){r.element.removeAttribute(n)}),this.popupUnWireEvents(),this.destroyPopup(),this.isPopupCreated=!1,this.disabled||this.unWireEvents())},i.prototype.destroyPopup=function(){if(this.isPopupCreated){if(this.dropDown.destroy(),this.getPopUpElement()){var n=document.getElementById(this.getPopUpElement().id);n&&(t.removeClass([n],["e-popup-open","e-popup-close"]),t.detach(n))}t.EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler);t.EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler);this.isPopupCreated&&(this.dropDown=void 0)}this.isPopupCreated=!1},i.prototype.getPopUpElement=function(){var n=null;return this.dropDown&&(n=this.dropDown.element),n},i.prototype.getULElement=function(){var n=null;return this.getPopUpElement()&&(n=this.getPopUpElement().children[0]),n},i.prototype.wireEvents=function(){this.delegateMousedownHandler=this.mousedownHandler.bind(this);this.createPopupOnClick||t.EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this);t.EventHandler.add(this.element,"click",this.clickHandler,this);t.EventHandler.add(this.element,"keydown",this.keyBoardHandler,this)},i.prototype.popupWireEvents=function(){var n=this.getPopUpElement();this.createPopupOnClick&&t.EventHandler.add(document,"mousedown touchstart",this.delegateMousedownHandler,this);n&&(t.EventHandler.add(n,"click",this.clickHandler,this),t.EventHandler.add(n,"keydown",this.keyBoardHandler,this));this.rippleFn=t.rippleEffect(n,{selector:"."+w})},i.prototype.popupUnWireEvents=function(){var n=this.getPopUpElement();this.createPopupOnClick&&t.EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler);n&&n.parentElement&&(t.EventHandler.remove(n,"click",this.clickHandler),t.EventHandler.remove(n,"keydown",this.keyBoardHandler))},i.prototype.keyBoardHandler=function(n){if(n.target!==this.element||9!==n.keyCode&&(n.altKey||40!==n.keyCode)&&38!==n.keyCode)switch(n.keyCode){case 38:case 40:!n.altKey||38!==n.keyCode&&40!==n.keyCode?this.upDownKeyHandler(n):this.keyEventHandler(n);break;case 9:case 13:case 27:case 32:this.keyEventHandler(n)}},i.prototype.upDownKeyHandler=function(n){this.target&&(38===n.keyCode||40===n.keyCode)||(n.preventDefault(),rt(this.getULElement(),n.keyCode))},i.prototype.keyEventHandler=function(n){this.target&&(13===n.keyCode||9===n.keyCode)||(n.target&&n.target.className.indexOf("e-edit-template")>-1&&32===n.keyCode||(9!==n.keyCode&&n.preventDefault(),27===n.keyCode||38===n.keyCode||9===n.keyCode?this.canOpen()||this.closePopup(n,this.element):this.clickHandler(n)))},i.prototype.getLI=function(n){return"LI"===n.tagName?n:t.closest(n,"li")},i.prototype.mousedownHandler=function(n){var i=n.target;!this.dropDown||this.canOpen()||t.closest(i,'[id="'+this.getPopUpElement().id+'"]')||t.closest(i,'[id="'+this.element.id+'"]')||this.closePopup(n)},i.prototype.clickHandler=function(n){var i=n.target;if(t.closest(i,'[id="'+this.element.id+'"]'))!this.createPopupOnClick||this.target&&!this.isColorPicker()?this.getPopUpElement().classList.contains("e-popup-close")?this.openPopUp(n):this.closePopup(n):this.isPopupCreated?this.closePopup(n,this.activeElem[0]):(this.createPopup(),this.openPopUp(n));else if(t.closest(i,'[id="'+this.getPopUpElement().id+'"]')){var u=void 0,f=void 0,e=void 0,r=this.getLI(i);r&&(f=Array.prototype.indexOf.call(this.getULElement().children,r),(e=this.items[f])&&(u={element:r,item:e},this.trigger("select",u)),this.closePopup(n,this.activeElem[0]))}},i.prototype.openPopUp=function(n){var i=this,r,u;void 0===n&&(n=null);this.target||this.createItems(!0);r=this.getULElement();this.popupWireEvents();u={element:r,items:this.items,event:n,cancel:!1};this.trigger("beforeOpen",u,function(n){var r,u;n.cancel||(r=i.getULElement(),i.dropDown.show(null,i.element),t.addClass([i.element],"e-active"),i.element.setAttribute("aria-expanded","true"),r.focus(),u={element:r,items:i.items},i.trigger("open",u))})},i.prototype.closePopup=function(n,i){var r=this,f,u;void 0===n&&(n=null);f={element:this.getULElement(),items:this.items,event:n,cancel:!1};u=this.getPopUpElement();u&&t.EventHandler.remove(u,"keydown",this.keyBoardHandler);this.trigger("beforeClose",f,function(n){var u,f,e;n.cancel||(r.popupUnWireEvents(),u=r.getULElement(),f=u.querySelector(".e-selected"),f&&f.classList.remove("e-selected"),r.dropDown.hide(),t.removeClass(r.activeElem,"e-active"),r.element.setAttribute("aria-expanded","false"),i&&i.focus(),e={element:u,items:r.items},r.trigger("close",e),!r.target&&u&&t.detach(u),r.target&&!r.isColorPicker()||r.createPopupOnClick&&r.destroyPopup(),r.target&&(r.isPopupCreated=!r.createPopupOnClick))})},i.prototype.unWireEvents=function(){this.createPopupOnClick||t.EventHandler.remove(document,"mousedown touchstart",this.delegateMousedownHandler);t.EventHandler.remove(this.element,"click",this.clickHandler);t.EventHandler.remove(this.element,"keydown",this.keyBoardHandler);this.isPopupCreated&&(t.EventHandler.remove(this.getPopUpElement(),"click",this.clickHandler),t.EventHandler.remove(this.getPopUpElement(),"keydown",this.keyBoardHandler))},i.prototype.onPropertyChanged=function(n,i){var u,r,f,e;for(this.button.setProperties(o(n,["content","cssClass","iconCss","iconPosition","disabled","enableRtl"])),this.isPopupCreated&&(u=this.getPopUpElement(),this.dropDown.setProperties(o(n,["enableRtl"]))),r=0,f=Object.keys(n);r<f.length;r++)switch(f[r]){case"content":this.element.querySelector("span.e-caret")||this.appendArrowSpan();break;case"disabled":n.disabled?(this.unWireEvents(),this.isPopupCreated&&!this.canOpen()&&this.closePopup()):this.wireEvents();break;case"cssClass":n.cssClass.indexOf(et)>-1&&(e=this.element.querySelector("span.e-caret"),t.classList(e,["e-icon-bottom"],["e-icon-right"]));this.isPopupCreated&&(i.cssClass&&t.removeClass([u],i.cssClass.split(" ")),n.cssClass&&t.addClass([u],n.cssClass.split(" ")));break;case"target":this.dropDown.content=this.getTargetElement();this.dropDown.dataBind();break;case"items":this.isPopupCreated&&this.getULElement()&&this.createItems();break;case"createPopupOnClick":n.createPopupOnClick?this.destroyPopup():this.createPopup()}},i.prototype.focusIn=function(){this.element.focus()},r([t.Property("")],i.prototype,"content",void 0),r([t.Property("")],i.prototype,"cssClass",void 0),r([t.Property(!1)],i.prototype,"disabled",void 0),r([t.Property("")],i.prototype,"iconCss",void 0),r([t.Property("Left")],i.prototype,"iconPosition",void 0),r([t.Property(!1)],i.prototype,"enableHtmlSanitizer",void 0),r([t.Collection([],s)],i.prototype,"items",void 0),r([t.Property(!1)],i.prototype,"createPopupOnClick",void 0),r([t.Property("")],i.prototype,"target",void 0),r([t.Event()],i.prototype,"beforeItemRender",void 0),r([t.Event()],i.prototype,"beforeOpen",void 0),r([t.Event()],i.prototype,"beforeClose",void 0),r([t.Event()],i.prototype,"close",void 0),r([t.Event()],i.prototype,"open",void 0),r([t.Event()],i.prototype,"select",void 0),r([t.Event()],i.prototype,"created",void 0),r([t.NotifyPropertyChanges],i)}(t.Component),at=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},p="e-rtl",k="EJS-SPLITBUTTON",vt=function(n){function i(t,i){return n.call(this,t,i)||this}return at(i,n),i.prototype.preRender=function(){var n=this.element;if(n.tagName===k){for(var f=t.getValue("ej2_instances",n),u=this.createElement("button",{attrs:{type:"button"}}),r=this.createElement(k,{className:"e-"+this.getModuleName()+"-wrapper"}),i=0,e=n.attributes.length;i<e;i++)u.setAttribute(n.attributes[i].nodeName,n.attributes[i].nodeValue);n.parentNode.insertBefore(r,n);t.detach(n);n=u;r.appendChild(n);t.setValue("ej2_instances",f,n);this.wrapper=r;this.element=n}this.element.id||(this.element.id=t.getUniqueID("e-"+this.getModuleName()))},i.prototype.render=function(){this.initWrapper();this.createPrimaryButton();this.renderControl()},i.prototype.renderControl=function(){this.createSecondaryButton();this.setActiveElem([this.element,this.secondaryBtnObj.element]);this.setAria();this.wireEvents();this.renderComplete()},i.prototype.addItems=function(t,i){n.prototype.addItems.call(this,t,i);this.secondaryBtnObj.items=this.items},i.prototype.removeItems=function(t,i){n.prototype.removeItems.call(this,t,i);this.secondaryBtnObj.items=this.items},i.prototype.initWrapper=function(){this.wrapper||(this.wrapper=this.createElement("div",{className:"e-"+this.getModuleName()+"-wrapper"}),this.element.parentNode.insertBefore(this.wrapper,this.element));this.element.classList.remove("e-"+this.getModuleName());this.enableRtl&&this.wrapper.classList.add(p);this.cssClass&&t.addClass([this.wrapper],this.cssClass.split(" "))},i.prototype.createPrimaryButton=function(){var n={cssClass:this.cssClass,enableRtl:this.enableRtl,iconCss:this.iconCss,iconPosition:this.iconPosition,content:this.content,disabled:this.disabled};this.primaryBtnObj=new y.Button(n);this.primaryBtnObj.createElement=this.createElement;this.primaryBtnObj.appendTo(this.element);this.element.classList.add("e-"+this.getModuleName());this.element.type="button";this.wrapper.appendChild(this.element)},i.prototype.createSecondaryButton=function(){var n=this,t=this.createElement("button",{className:"e-icon-btn",attrs:{tabindex:"-1"},id:this.element.id+"_dropdownbtn"}),i;this.wrapper.appendChild(t);i={cssClass:this.cssClass,disabled:this.disabled,enableRtl:this.enableRtl,items:this.items,target:this.target,createPopupOnClick:this.createPopupOnClick,beforeItemRender:function(t){n.createPopupOnClick&&(n.secondaryBtnObj.dropDown.relateTo=n.wrapper,n.dropDown=n.secondaryBtnObj.dropDown);n.trigger("beforeItemRender",t)},open:function(t){n.trigger("open",t)},close:function(t){n.trigger("close",t)},select:function(t){n.trigger("select",t)},beforeOpen:function(t){var i=new d;return n.trigger("beforeOpen",t,function(n){i.resolve(n)}),i},beforeClose:function(t){var i=new d;return n.trigger("beforeClose",t,function(n){i.resolve(n)}),i}};this.secondaryBtnObj=new b(i);this.secondaryBtnObj.createElement=this.createElement;this.secondaryBtnObj.appendTo(t);this.createPopupOnClick||(this.secondaryBtnObj.dropDown.relateTo=this.wrapper,this.dropDown=this.secondaryBtnObj.dropDown);this.secondaryBtnObj.activeElem=[this.element,this.secondaryBtnObj.element];this.secondaryBtnObj.element.querySelector(".e-btn-icon").classList.remove("e-icon-right")},i.prototype.setAria=function(){t.attributes(this.element,{"aria-expanded":"false","aria-haspopup":"true","aria-label":this.element.textContent+" splitbutton","aria-owns":this.element.id+"_dropdownbtn-popup"})},i.prototype.getModuleName=function(){return"split-btn"},i.prototype.toggle=function(){this.secondaryBtnObj.toggle()},i.prototype.destroy=function(){var u=this,i=[p],r;(this.cssClass&&(i=i.concat(this.cssClass.split(" "))),this.element)&&(r=document.getElementById(this.element.id),r&&r.parentElement===this.wrapper&&(this.wrapper.tagName===k?(this.wrapper.innerHTML="",t.removeClass([this.wrapper],["e-rtl","e-"+this.getModuleName()+"-wrapper"]),t.removeClass([this.wrapper],this.cssClass.split(" "))):(t.removeClass([this.element],i),["aria-label","aria-haspopup","aria-expanded","aria-owns","type"].forEach(function(n){u.element.removeAttribute(n)}),this.wrapper.parentNode.insertBefore(this.element,this.wrapper),t.remove(this.wrapper)),this.unWireEvents()));this.primaryBtnObj.destroy();this.secondaryBtnObj.destroy();n.prototype.destroy.call(this);this.element.getAttribute("class")||this.element.removeAttribute("class")},i.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.primaryBtnClickHandler,this);new t.KeyboardEvents(this.element,{keyAction:this.btnKeyBoardHandler.bind(this),keyConfigs:{altdownarrow:"alt+downarrow"}})},i.prototype.unWireEvents=function(){t.EventHandler.remove(this.element,"click",this.primaryBtnClickHandler);t.getInstance(this.element,t.KeyboardEvents).destroy()},i.prototype.primaryBtnClickHandler=function(){this.trigger("click",{element:this.element})},i.prototype.btnKeyBoardHandler=function(n){"altdownarrow"===n.action&&this.clickHandler(n)},i.prototype.onPropertyChanged=function(n,i){var u=["content","iconCss","iconPosition","cssClass","disabled","enableRtl"],r,f;for(this.primaryBtnObj.setProperties(o(n,u)),u=["beforeOpen","beforeItemRender","select","open","close","cssClass","disabled","enableRtl","createPopupOnClick"],Object.keys(n).indexOf("items")>-1&&(this.secondaryBtnObj.items=n.items,this.secondaryBtnObj.dataBind()),this.secondaryBtnObj.setProperties(o(n,u)),r=0,f=Object.keys(n);r<f.length;r++)switch(f[r]){case"cssClass":i.cssClass&&t.removeClass([this.wrapper],i.cssClass.split(" "));t.addClass([this.wrapper],n.cssClass.split(" "));break;case"enableRtl":n.enableRtl?t.addClass([this.wrapper],p):t.removeClass([this.wrapper],p)}},i.prototype.focusIn=function(){this.element.focus()},u([t.Property("")],i.prototype,"content",void 0),u([t.Property("")],i.prototype,"cssClass",void 0),u([t.Property(!1)],i.prototype,"disabled",void 0),u([t.Property("")],i.prototype,"iconCss",void 0),u([t.Property("Left")],i.prototype,"iconPosition",void 0),u([t.Property(!1)],i.prototype,"createPopupOnClick",void 0),u([t.Collection([],s)],i.prototype,"items",void 0),u([t.Property("")],i.prototype,"target",void 0),u([t.Event()],i.prototype,"beforeItemRender",void 0),u([t.Event()],i.prototype,"beforeOpen",void 0),u([t.Event()],i.prototype,"beforeClose",void 0),u([t.Event()],i.prototype,"click",void 0),u([t.Event()],i.prototype,"close",void 0),u([t.Event()],i.prototype,"open",void 0),u([t.Event()],i.prototype,"select",void 0),u([t.Event()],i.prototype,"created",void 0),u([t.NotifyPropertyChanges],i)}(b),d=function(){return function(){var n=this;this.promise=new Promise(function(t,i){n.resolve=t;n.reject=i});this.catch=this.promise.catch.bind(this.promise);this.then=this.promise.then.bind(this.promise)}}();var g=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},nt="e-hide-spinner",ot="e-progress",c="e-progress-active",e="e-btn-content",st=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return g(r,n),i([t.Property(null)],r.prototype,"template",void 0),i([t.Property(16)],r.prototype,"width",void 0),i([t.Property("Left")],r.prototype,"position",void 0),r}(t.ChildProperty),ht=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return g(r,n),i([t.Property(400)],r.prototype,"duration",void 0),i([t.Property("None")],r.prototype,"effect",void 0),i([t.Property("ease")],r.prototype,"easing",void 0),r}(t.ChildProperty),pt=function(n){function r(t,i){var r=n.call(this,t,i)||this;return r.step=1,r}return g(r,n),r.prototype.preRender=function(){n.prototype.preRender.call(this)},r.prototype.render=function(){n.prototype.render.call(this);this.init();this.wireEvents();this.setAria();this.renderComplete()},r.prototype.start=function(n){this.isPaused=!1;this.startProgress(n||this.percent,this.progressTime)},r.prototype.stop=function(){this.isPaused=!0;cancelAnimationFrame(this.timerId)},r.prototype.progressComplete=function(){this.isPaused=!1;this.finishProgress()},r.prototype.getModuleName=function(){return"progress-btn"},r.prototype.destroy=function(){var r=this,i=[nt,c,"e-round-corner","e-"+n.prototype.getModuleName.call(this),"e-spin-"+this.spinSettings.position.toLowerCase()];n.prototype.destroy.call(this);this.unWireEvents();this.element.innerHTML="";this.cssClass&&(i=i.concat(this.cssClass.split(" ")));t.removeClass([this.element],i);(this.element.getAttribute("class")?["aria-label","aria-valuemin","aria-valuemax","aria-valuenow"]:["aria-label","aria-valuemin","aria-valuemax","aria-valuenow","class"]).forEach(function(n){r.element.removeAttribute(n)});this.disabled&&this.element.removeAttribute("disabled")},r.prototype.init=function(){this.element.classList.add("e-"+n.prototype.getModuleName.call(this));this.setContent();this.createSpinner();this.enableProgress&&this.createProgress()},r.prototype.createSpinner=function(){var n=this.createElement("span",{className:"e-spinner"});this.setSpinPosition(n);h.createSpinner({target:n,width:this.spinSettings.width||16,template:this.spinSettings.template},this.createElement)},r.prototype.getSpinner=function(){return this.element.getElementsByClassName("e-spinner")[0]},r.prototype.getProgress=function(){return this.element.getElementsByClassName(ot)[0]},r.prototype.setSpinPosition=function(n){var t=this.spinSettings.position||"Left";"Left"===t||"Top"===t?this.element.insertBefore(n,this.element.getElementsByClassName(e)[0]):this.element.appendChild(n);this.element.classList.add("e-spin-"+t.toLowerCase())},r.prototype.createProgress=function(){this.element.appendChild(this.createElement("span",{className:ot}))},r.prototype.setContent=function(){var n;n=this.element.innerHTML;this.enableHtmlSanitizer&&(n=t.SanitizeHtmlHelper.sanitize(this.element.innerHTML));this.element.innerHTML="";this.element.appendChild(this.createElement("span",{className:e,innerHTML:n}))},r.prototype.setContentIcon=function(n){var t=this.createElement("span",{className:e,innerHTML:n}),i,r;this.iconCss&&(i=this.createElement("span",{className:"e-btn-icon "+this.iconCss}),this.element.textContent.trim()?(i.classList.add("e-icon-"+this.iconPosition.toLowerCase()),"Top"!==this.iconPosition&&"Bottom"!==this.iconPosition||this.element.classList.add("e-"+this.iconPosition.toLowerCase()+"-icon-btn")):this.element.classList.add("e-icon-btn"),r=t.childNodes[0],!r||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?t.appendChild(i):t.insertBefore(i,r));this.element.appendChild(t)},r.prototype.clickHandler=function(){this.element.classList.contains(c)||this.startProgress()},r.prototype.startProgress=function(n,t){var i=this.element.classList,r=i.contains("e-vertical");i.add(c);i.contains(nt)||h.showSpinner(this.element);this.startAnimate(Date.now(),t||0,t?Date.now()-this.duration/100:Date.now(),n||0,0,this.step,0,r);this.startContAnimate()},r.prototype.startAnimate=function(n,t,i,r,u,f,e,o){var a=this,l;try{var s=n-i,c=this.duration*f/100,h=s?s<c?s-c:s%c:0;this.progressTime=t=t+s-h;i=n-h;r+=(s-h)/this.duration*100;l={percent:u=(t-e)%c==0||100===r?r:u,currentDuration:t,step:f};this.eIsVertical=o;0===r?this.trigger("begin",l,function(n){a.successCallback(n,r,u,t,e,h,i)}):100===r||t===this.duration?this.trigger("end",l,function(n){a.successCallback(n,r,u,t,e,h,i)}):this.trigger("progress",l,function(n){a.successCallback(n,r,u,t,e,h,i)})}catch(n){cancelAnimationFrame(this.timerId);this.trigger("fail",n)}},r.prototype.successCallback=function(n,t,i,r,u,f,e){var o=this,s=t,c=i,v=f,h=r,l=u,y=e,a=this.eIsVertical;s!==n.percent&&n.percent!==c&&(s=n.percent);this.percent=s;this.step=n.step;(h-l)%(this.duration*n.step/100)!=0&&100!==s||(this.timerId=requestAnimationFrame(function(){o.enableProgress&&(o.getProgress().style[a?"height":"width"]=s+"%");o.element.setAttribute("aria-valuenow",s.toString())}),c=s,l=h);this.isPaused||(this.interval=h<this.duration&&s<100?window.setTimeout(function(){o.startAnimate(Date.now(),h,y,s,c,n.step,l,a)},this.duration/100-v):window.setTimeout(function(){o.progressTime=o.percent=0;o.enableProgress&&(o.getProgress().style[a?"height":"width"]="0%");o.element.setAttribute("aria-valuenow","0");o.hideSpin()},100))},r.prototype.startContAnimate=function(){var n=this,i=this.element.getElementsByClassName(e)[0];"None"!==this.animationSettings.effect?new t.Animation({}).animate(i,{duration:this.animationSettings.duration,name:"Progress"+this.animationSettings.effect,timingFunction:this.animationSettings.easing,begin:function(){"Center"===n.spinSettings.position&&n.setSpinnerSize()},end:function(){i.classList.add("e-animate-end")}}):"Center"===this.spinSettings.position&&this.setSpinnerSize()},r.prototype.finishProgress=function(){var t=this.element.classList,r=t.contains("e-vertical"),n,i;for(t.add(c),n=this.percent;n<100;n++)(n+=10)>100&&(n=100),this.enableProgress&&(this.getProgress().style[r?"height":"width"]=this.percent<100?n+"%":"100%");this.element.setAttribute("aria-valuenow","0");this.hideSpin();i={step:this.step,currentDuration:this.progressTime,percent:100};clearTimeout(this.interval);this.trigger("end",i);this.progressTime=this.percent=0},r.prototype.setSpinnerSize=function(){var t=this.element.getElementsByClassName(e)[0],n=this.getSpinner();n.style.width=Math.max(n.offsetWidth,t.offsetWidth)+"px";n.style.height=Math.max(n.offsetHeight,t.offsetHeight)+"px";t.classList.add("e-cont-animate")},r.prototype.hideSpin=function(){var t=this.element.getElementsByClassName(e)[0],n;(this.element.classList.contains(nt)||h.hideSpinner(this.element),this.element.classList.remove(c),"None"!==this.animationSettings.effect&&t.classList.remove("e-animate-end"),"Center"===this.spinSettings.position)&&(n=this.getSpinner(),t.classList.remove("e-cont-animate"),n.style.width="auto",n.style.height="auto")},r.prototype.setIconSpan=function(){var n=this.element.getElementsByClassName(e)[0],t=this.element.getElementsByClassName("e-btn-icon")[0];!n.childNodes[0]||"Left"!==this.iconPosition&&"Top"!==this.iconPosition?n.appendChild(t):n.insertBefore(t,n.childNodes[0])},r.prototype.setAria=function(){t.attributes(this.element,{"aria-label":this.element.textContent+" progress","aria-valuemin":"0","aria-valuemax":"100","aria-valuenow":"0"})},r.prototype.wireEvents=function(){t.EventHandler.add(this.element,"click",this.clickHandler,this)},r.prototype.unWireEvents=function(){t.EventHandler.remove(this.element,"click",this.clickHandler)},r.prototype.onPropertyChanged=function(i,r){var u=this.element,e=!1,f,o;for(this.element.querySelector(".e-spinner-pane").classList.contains("e-spin-show")&&(e=!0),n.prototype.onPropertyChanged.call(this,i,r),f=0,o=Object.keys(i);f<o.length;f++)switch(o[f]){case"content":this.setContent();this.createSpinner();e&&(h.showSpinner(this.element),e=!1);this.enableProgress&&this.createProgress();u.setAttribute("aria-label",u.textContent+" progress");break;case"iconCss":r.iconCss||this.setIconSpan();break;case"iconPosition":this.setIconSpan();break;case"enableProgress":i.enableProgress?this.createProgress():t.remove(this.getProgress());break;case"spinSettings":i.spinSettings.position&&(u.classList.remove("e-spin-"+r.spinSettings.position.toLowerCase()),this.setSpinPosition(this.getSpinner()));(i.spinSettings.template||i.spinSettings.width)&&(u.removeChild(this.getSpinner()),this.createSpinner())}},r.prototype.focusIn=function(){this.element.focus()},i([t.Property(!1)],r.prototype,"enableProgress",void 0),i([t.Property(2e3)],r.prototype,"duration",void 0),i([t.Property("Left")],r.prototype,"iconPosition",void 0),i([t.Property("")],r.prototype,"iconCss",void 0),i([t.Property(!1)],r.prototype,"disabled",void 0),i([t.Property(!1)],r.prototype,"isPrimary",void 0),i([t.Property("")],r.prototype,"cssClass",void 0),i([t.Property("")],r.prototype,"content",void 0),i([t.Property(!1)],r.prototype,"isToggle",void 0),i([t.Property(!1)],r.prototype,"enableHtmlSanitizer",void 0),i([t.Complex({},st)],r.prototype,"spinSettings",void 0),i([t.Complex({},ht)],r.prototype,"animationSettings",void 0),i([t.Event()],r.prototype,"created",void 0),i([t.Event()],r.prototype,"begin",void 0),i([t.Event()],r.prototype,"progress",void 0),i([t.Event()],r.prototype,"end",void 0),i([t.Event()],r.prototype,"fail",void 0),i([t.NotifyPropertyChanges],r)}(y.Button),tt={};a.J(tt,l);ct={splitbuttons:tt=a.J(window.ejdashboard?window.ejdashboard.splitbuttons:{},tt)};window.ejdashboard=a.J(window.ejdashboard||{},ct)})()})();(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={665:(n,t)=>{t.J=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function ws(n,i,r){var u=t.getValue("name",i),f=n.getAttribute("data-id"),e=t.isNullOrUndefined(f)?u:f;r.setProperties({path:bs(n,e,r.hasId)},!0);r.pathId=function(n){for(var i=ks(n,n.getAttribute("data-uid"),!0),r=[],t=i.length-1;t>=0;t--)r.push(i[t]);return r}(n);r.pathNames=function(n,t){for(var r=ks(n,t,!1),u=[],i=r.length-1;i>=0;i--)u.push(r[i]);return u}(n,u)}function bs(n,t,i){for(var u=ks(n,t,!1,i),f=i?"":"/",r=u.length-(i?1:2);r>=0;r--)f+=u[r]+"/";return f}function ks(n,i,r,u){for(var o,e=[i],f=n.parentNode;!t.isNullOrUndefined(f);)if(t.matches(f,"."+nt)&&(o=r?f.getAttribute("data-uid"):u?f.getAttribute("data-id"):t.select("."+vu,f).textContent,e.push(o)),(f=f.parentNode).classList.contains(re))break;return e}function ds(n){n.isCut&&(ut(n),n.selectedNodes=[],n.actionRecords=[],n.enablePaste=!1,n.notify(nu,{}))}function sl(n,i){var u,r,f;if(i.isSearchCut=!1,i.actionRecords=[],i.activeElements=[],i.notify(vi,{}),0===i.activeElements.length)return!1;if(ut(i),u=i.activeElements,i.targetPath="navigationpane"!==i.activeModule?i.path:ru(i.path),r=0,u&&(ge(i,u[0]),"cut"===n))for(;r<u.length;)de(u[r]),r++;for(r=0,i.selectedNodes=[],i.enablePaste=!0,i.notify(ce,{});r<i.activeRecords.length;)i.actionRecords.push(i.activeRecords[r]),i.selectedNodes.push(t.getValue("name",i.activeRecords[r])),r++;if((""!==i.breadcrumbbarModule.searchObj.element.value||i.isFiltered)&&"navigationpane"!==i.activeModule)for(i.selectedNodes=[],i.isSearchCut=!0,f=0;f<i.selectedItems.length;)i.selectedNodes.push(i.selectedItems[f]),f++;return!0}function de(n){n.classList.add(ki)}function ut(n,t){for(var r=t?n.element.querySelectorAll("."+yr):n.element.querySelectorAll("."+ki),i=0;i<r.length;)r[i].classList.remove(t?yr:ki),i++}function ge(n,i){i&&(n.activeModule=i.classList.contains(te)?"detailsview":t.closest(i,"."+bu)?"largeiconsview":"navigationpane")}function no(n,t,i){var r,u,f;(0!==t.length||n.isFiltered||n.notify(or,{args:n}),r="startsWith"===n.searchSettings.filterType?t+"*":"endsWith"===n.searchSettings.filterType?"*"+t:"*"+t+"*",n.searchWord=r,n.itemData=[v(n)],t.length>0)?(u=n.searchSettings.ignoreCase,f=n.showHiddenItems,ea(n,i?ot:ur,n.path,r,f,!u)):n.isFiltered?ch(n,ot):n.isSortByClicked?(n.notify(ot,{files:n.largeiconsviewModule.items}),n.isSortByClicked=!1):o(n,i?ot:ur,n.path)}function yt(n,t){n.setProperties({view:t},!0);(""!==n.breadcrumbbarModule.searchObj.element.value||n.isFiltered)&&(n.layoutSelectedItems=n.selectedItems);var i="";n.breadcrumbbarModule.searchObj.element.value&&(i=n.breadcrumbbarModule.searchObj.element.value);n.isLayoutChange=!0;no(n,i,!0)}function hl(n,i){var r="";i&&(r=t.closest(i,".e-gridcontent")?"detailsview":t.closest(i,"."+au)?"largeiconsview":i.classList.contains("e-fullrow")||i.classList.contains("e-icon-expandable")?"navigationpane":t.closest(i,".e-address-list-item")?"breadcrumbbar":"");n.targetModule=r}function sr(n){n.itemData=[v(n)];ef(n.itemData[0])?o(n,ct,n.path):e(n,n.itemData[0],be)}function cl(n){o(n,lt,n.path)}function v(n){return t.getValue(n.pathId[n.pathId.length-1],n.feParent)}function nf(n){sl("copy",n)&&(n.fileAction="copy")}function tf(n){sl("cut",n)&&(n.isCut=!0,n.fileAction="move")}function rf(n){if(!t.getValue("isFile",n))return di;var i=t.getValue("type",n);return-1!==(i=i.toLowerCase()).indexOf(".")&&(i=i.split(".").join("")),-1!==["bmp","dib","jpg","jpeg","jpe","jfif","gif","tif","tiff","png","ico"].indexOf(i)?wu:-1!==["mp3","wav","aac","ogg","wma","aif","fla","m4a"].indexOf(i)?kc:-1!==["webm","mkv","flv","vob","ogv","ogg","avi","wmv","mp4","3gp"].indexOf(i)?dc:-1!==["css","exe","html","js","msi","pdf","pptx","ppt","rar","zip","txt","docx","doc","xlsx","xls","xml","rtf","php"].indexOf(i)?"e-fe-"+i:"e-fe-unknown e-fe-"+i}function gs(n,i){var r,u=n.ajaxSettings.getImageUrl?n.ajaxSettings.getImageUrl:n.ajaxSettings.url,e=encodeURIComponent(t.getValue("name",i)),o=t.getValue("filterPath",i),s,f;return n.hasId?(s=t.getValue("id",i),r=u+"?path="+n.path+"&id="+s):r=t.isNullOrUndefined(o)?u+"?path="+n.path+e:u+"?path="+o.replace(/\\/g,"/")+e,f={fileDetails:[i],imageUrl:r=r+"&time="+(new Date).getTime().toString()},n.trigger("beforeImageLoad",f),f.imageUrl}function uf(n,i,r){var u=t.getValue(n.hasId?"id":"name",i)+"/",f=t.getValue(n.hasId?"filterId":"filterPath",i);return t.isNullOrUndefined(f)?r+u:f.replace(/\\/g,"/")+u}function ll(n,i){var r=t.getValue("name",i),u=t.getValue("filterPath",i);return""===n.breadcrumbbarModule.searchObj.element.value&&!n.isFiltered||t.isNullOrUndefined(u)||(r=(u=u.replace(/\\/g,"/")).replace(n.path,"")+r),r}function pt(n,i){var r,f;return 0===i.length?i:(r="None"!==n.sortOrder?(new u.Query).sortBy(n.sortBy,n.sortOrder.toLowerCase(),!0).group("isFile"):(new u.Query).group("isFile"),f=new u.DataManager(i).executeLocal(r),t.getValue("records",f))}function ky(n,i,r){var f=t.getValue(n.pathId[n.pathId.length-1],n.feFiles),e=(new u.Query).where(i,"equal",r);return new u.DataManager(f).executeLocal(e)[0]}function al(n,r,u){var f,o=t.select("#"+n.element.id+so,n.element),h=t.select("#"+n.element.id+vr,o).offsetHeight,s;if(f=o.offsetHeight-h,"Details"===n.view&&(f-=t.select("."+ko,o).offsetHeight),t.isNullOrUndefined(r.querySelector("."+b))){var e=t.createElement("div",{className:b}),c=t.createElement("div",{className:gc}),l=t.createElement("div",{className:br}),a=t.createElement("div",{className:kr});"Details"===n.view?r.querySelector("."+nr).appendChild(e):r.appendChild(e);e.appendChild(c);e.appendChild(l);e.appendChild(a)}r.querySelector("."+b)&&(t.isNullOrUndefined(u.error)?n.isFiltered?(r.querySelector("."+br).innerHTML=i(n,"Filter-Empty"),r.querySelector("."+kr).innerHTML=i(n,"Filter-Key")):""!==n.breadcrumbbarModule.searchObj.element.value?(r.querySelector("."+br).innerHTML=i(n,"Search-Empty"),r.querySelector("."+kr).innerHTML=i(n,"Search-Key")):(r.querySelector("."+br).innerHTML=i(n,"Folder-Empty"),r.querySelector("."+kr).innerHTML=i(n,"File-Upload")):(r.querySelector("."+br).innerHTML=i(n,"Access-Denied"),r.querySelector("."+kr).innerHTML=i(n,"Access-Details")));s=t.select("."+b,r);f=(f-s.offsetHeight)/2;s.style.marginTop=f+"px"}function vl(n){return new u.DataManager(n).executeLocal((new u.Query).where(ol,"equal",!1,!1))}function i(n,t){var i=n.localeObj.getConstant(t);return""===i?t:i}function wt(n,i){var r=n.cssClass;return t.isNullOrUndefined(r)||""===r?i:r+" "+i}function yl(n,t){n.isSortByClicked=!0;-1!==t.item.id.indexOf("ascending")||-1!==t.item.id.indexOf("descending")||-1!==t.item.id.indexOf("none")?n.sortOrder=pl(t.item.id):n.sortBy=pl(t.item.id);n.itemData=[v(n)];"Details"===n.view&&(n.isMobile?yt(n,"Details"):n.notify(ae,{module:"detailsview"}));"LargeIcons"===n.view&&yt(n,"LargeIcons");n.notify(li,{})}function pl(n){var i=n.substring(n.lastIndexOf("_")+1),t=i;switch(i){case"date":t="_fm_modified";break;case"ascending":t="Ascending";break;case"descending":t="Descending";break;case"none":t="None"}return t}function wl(n,t){n.notify(ku,{selectedNode:n.pathId[n.pathId.length-1]});n.originalPath=uf(n,t,n.path);o(n,n.path!==n.originalPath?kt:k,n.path)}function ff(n){if(n.isDragDrop=!1,0!==n.selectedNodes.length&&n.enablePaste){var t=""===n.folderPath?n.path:n.folderPath;bl(n,n.actionRecords,t,n.path)||("move"===n.fileAction&&n.targetPath!==t||"copy"===n.fileAction?(n.notify(ti,{}),uo(n,n.targetPath,n.selectedNodes,t,n.fileAction,[],n.actionRecords)):(n.enablePaste=!1,n.notify(nu,{}),ut(n)))}}function bl(n,r,u,f){for(var h,c,l,a,o=!1,e=0;e<r.length;e++)if(t.getValue("isFile",r[e])){if(h=n.dragNodes[e],c=0,h&&(c=h.lastIndexOf("/")),l="",c>0&&(l=f+h.substring(0,c+1)),l===u){s(n,"Error",{files:null,error:{code:"402",message:i(n,"Same-Folder-Error"),fileExists:null}});o=!0;break}}else if(a=uf(n,r[e],f),0===u.indexOf(a)){s(n,"Error",{files:null,error:{code:"402",message:i(n,"Sub-Folder-Error"),fileExists:null}});o=!0;break}return o}function ru(n){for(var t=n.split("/"),r=t[0]+"/",i=1;i<t.length-2;i++)r+=t[i]+"/";return r}function nh(n,i){var r=t.getValue(n.hasId?"id":"name",i.cwd)+"/",u=t.getValue(n.hasId?"filterId":"filterPath",i.cwd);return t.isNullOrUndefined(u)?n.path+r:""===u?n.hasId?r:"/":u.replace(/\\/g,"/")+r}function th(n,t,i){"move"===t&&(n.isDragDrop?n.notify(pe,i):(n.enablePaste=!1,n.notify(nu,{}),n.notify(le,i)));0===n.duplicateItems.length&&(n.pasteNodes=[]);for(var r=0;r<i.files.length;r++)n.pasteNodes.push(i.files[r][n.hasId?"id":"name"]),n.isDragDrop&&n.droppedObjects.push(i.files[r]);n.duplicateItems=[];n.duplicateRecords=[];n.isDropEnd=n.isDragDrop&&!n.isPasteError?!0:!1;!n.isDragDrop||n.path===n.dragPath||n.path===n.dropPath||n.isSearchDrag?(n.isPathDrag=!1,o(n,it,n.path)):ih(n);n.trigger("success",{action:t,result:i})}function ih(n){var i=t.getValue("_fm_id",n.dropData);n.expandedId=i;n.itemData=[n.dropData];n.isPathDrag?n.notify(oe,n.itemData):(n.navigationpaneModule&&ws(t.select('[data-uid="'+i+'"]',n.navigationpaneModule.treeObj.element),n.dropData,n),o(n,vt,n.dropPath))}function rh(n){var t,i,u;if(n.isSearchDrag=!1,""!==n.breadcrumbbarModule.searchObj.element.value&&(n.isSearchDrag=!0),"navigationpane"!==n.activeModule){for(n.dragNodes=[],t=0;t<n.selectedItems.length;)n.dragNodes.push(n.selectedItems[t]),t++;0===n.selectedItems.length&&n.dragData&&1===n.dragData.length&&n.dragNodes.push(yi(n,n.dragData[0]))}var f=n.createElement("div",{className:"e-fe-icon "+rf(n.dragData[0])}),e=n.createElement("div",{className:"e-fe-name",innerHTML:n.dragData[0].name}),r=n.createElement("div",{className:"e-fe-content"});r.appendChild(f);r.appendChild(e);i=n.createElement("div",{className:ie});(i.appendChild(r),n.dragNodes.length>1)&&(u=n.createElement("span",{className:"e-fe-count",innerHTML:n.dragNodes.length.toString(10)}),i.appendChild(u));n.virtualDragElement=i;n.element.appendChild(n.virtualDragElement)}function uh(n,i){var r=i,u;r.cancel=!1;null!=n.treeExpandTimer&&(window.clearTimeout(n.treeExpandTimer),n.treeExpandTimer=null);dl(n);n.element.classList.remove("e-fe-drop","e-no-drop");ut(n);n.uploadObj.dropArea=t.select("#"+n.element.id+ar,n.element);u=t.select("."+ie,n.element);u&&t.detach(u);hl(n,i.target);n.notify(at,i);ut(n,"hover");r.fileDetails=n.dragData;n.trigger("fileDragStop",r,function(i){!i.cancel&&!t.isNullOrUndefined(n.targetModule)&&""!==n.targetModule&&n.dragCount>2&&function(n){n.isDragDrop=!0;0!==n.dragData.length&&(n.dragPath=n.dragPath.replace(/\\/g,"/"),n.dropPath=n.dropPath.replace(/\\/g,"/"),bl(n,n.dragData,n.dropPath,n.dragPath)||n.dragPath===n.dropPath||(n.itemData=[n.dropData],uo(n,n.dragPath,n.dragNodes,n.dropPath,"move",[],n.dragData),n.notify(ti,{})))}(n);n.dragCount=0})}function fh(n,i,r){var u=i,f;if(u.cancel=!1,u.fileDetails=n.dragData,n.dragCount=0,n.droppedObjects=[],(!n.allowDragAndDrop||"navigationpane"===n.activeModule&&t.closest(i.element,"li").getAttribute("data-uid")===n.pathId[0])&&(u.cancel=!0),n.isPathDrag="navigationpane"===n.activeModule&&-1!==n.pathId.indexOf(t.closest(i.element,"li").getAttribute("data-uid"))?!0:!1,ut(n),u.cancel)r.intDestroy(i.event),kl(n);else if(!u.cancel){for(f=0;f<n.activeElements.length;)de(n.activeElements[f]),f++;n.trigger("fileDragStart",u,function(t){t.cancel?(r.intDestroy(i.event),kl(n)):n.uploadObj.dropArea=null})}}function kl(n){ut(n);var i=t.select("."+ie,n.element);i&&t.detach(i)}function dl(n){gl(n,pu);gl(n,bo)}function gl(n,t){for(var r=n.element.querySelectorAll("."+t),i=0;i<r.length;i++)r[i].classList.remove(t)}function eh(n,i){var f=i,u,r;f.fileDetails=n.dragData;u=!1;hl(n,i.target);dl(n);null!=n.treeExpandTimer&&(window.clearTimeout(n.treeExpandTimer),n.treeExpandTimer=null);ut(n,"hover");r=null;"navigationpane"===n.targetModule?((r=t.closest(i.target,"li")).classList.add(yr,pu),u=!0,n.treeExpandTimer=window.setTimeout(function(){n.notify(we,i)},800)):"detailsview"===n.targetModule?((r=t.closest(i.target,"tr"))&&r.querySelector("."+di)&&!r.classList.contains(ki)?r.classList.add(pu):!r||r.querySelector("."+di)||r.classList.contains(ki)||r.classList.add(bo),u=!0):"largeiconsview"===n.targetModule?((r=t.closest(i.target,"li"))&&r.querySelector("."+di)&&!r.classList.contains(ki)&&r.classList.add(yr,pu),u=!0):"breadcrumbbar"===n.targetModule&&(u=!0);n.element.classList.remove("e-fe-drop","e-no-drop");n.element.classList.add(u?"e-fe-drop":"e-no-drop");n.dragCount=n.dragCount+1;n.trigger("fileDragging",f)}function yi(n,i){return n.hasId?t.getValue("id",i):ll(n,i)}function to(n,i){n.itemData=[i];n.currentItemText=t.getValue("name",i);n.isFile=t.getValue("isFile",i);n.filterPath=t.getValue("filterPath",i)}function io(n){y(n.itemData[0])?s(n,"Rename"):e(n,n.itemData[0],g)}function na(n){for(var i=n.itemData,t=0;t<i.length;t++)if(!of(i[t]))return void e(n,i[t],iu);n.selectedItems.length>0&&cf(n,n.path,n.selectedItems)}function ta(n,t,i){for(var r=0;r<t.length;r++)if(!y(t[r]))return void e(n,t[r],g);n.itemData=t;fo(n,i,n.path,"delete")}function ia(n,t,i){for(var r=0;r<t.length;r++)if(!of(t[r]))return void e(n,t[r],iu);n.itemData=t;i.length>0&&cf(n,n.path,i)}function e(n,r,u){var f=t.getValue("message",t.getValue("permission",r));""===f&&(f=i(n,"Access-Message").replace("{0}",t.getValue("name",r)).replace("{1}",u));s(n,"Error",{error:{code:"401",fileExists:null,message:f}})}function ro(n){return ef(n)?"e-fe-locked":"e-fe-locked e-fe-hidden"}function ef(n){var i=t.getValue("permission",n);return!(i&&!t.getValue("read",i))}function y(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("write",i)}function oh(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("writeContents",i)}function ra(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("upload",i)}function of(n){var i=t.getValue("permission",n);return!i||t.getValue("read",i)&&t.getValue("download",i)}function sh(n){var t=n.itemData[0];oh(t)?s(n,"NewFolder"):e(n,t,ke)}function hh(n){var t=n.itemData[0],i;ra(t)?(i="#"+n.element.id+hu,document.querySelector(i).click()):e(n,t,ps)}function o(n,i,r){for(var u=n.itemData,f=0;f<u.length;f++)t.isNullOrUndefined(t.getValue("hasChild",u[f]))&&t.setValue("hasChild",!1,u[f]);pi(n,{action:"read",path:r,showHiddenItems:n.showHiddenItems,data:u},dy,i)}function ua(n,t){pi(n,{action:"create",path:n.path,name:t,data:n.itemData},np,t)}function ch(n,i){var r={action:"filter",path:n.path,showHiddenItems:n.showHiddenItems,data:[v(n)]},u=n.filterData?t.extend(void 0,r,n.filterData):r;pi(n,u,gy,i,t.getValue("action",u))}function sf(n,t,i){var r,u,f;""!==n.breadcrumbbarModule.searchObj.element.value||n.isFiltered?(f=n.filterPath,n.hasId?(r=n.currentItemText,u=i):(r=(f=f.replace(/\\/g,"/")).replace(t,"")+n.currentItemText,u=f.replace(t,"")+i)):(r=n.currentItemText,u=i);pi(n,{action:"rename",path:t,name:r,newName:u,data:n.itemData},tp,t)}function uo(n,t,i,r,u,f,e){var o={action:u,path:t,targetData:n.itemData[0],targetPath:r,names:i,renameFiles:f,data:e};n.destinationPath=r;pi(n,o,ip,t,u,r)}function fo(n,t,i,r){pi(n,{action:r,path:i,names:t,data:n.itemData},rp,i)}function hf(n,t,i,r){pi(n,{action:r,path:i,names:t,data:n.itemData},up,i,r)}function pi(n,r,u,f,e,o){var s={url:n.ajaxSettings.url,type:"POST",mode:!0,dataType:"json",contentType:"application/json",data:JSON.stringify(r),onSuccess:null,onFailure:null,beforeSend:null},h={action:t.getValue("action",r),ajaxSettings:s,cancel:!1};n.trigger("beforeSend",h,function(s){s.cancel||(n.notify(si,{}),new t.Ajax({url:t.getValue("url",s.ajaxSettings),type:t.getValue("type",s.ajaxSettings),mode:t.getValue("mode",s.ajaxSettings),dataType:t.getValue("dataType",s.ajaxSettings),contentType:t.getValue("contentType",s.ajaxSettings),data:t.getValue("data",s.ajaxSettings),beforeSend:t.getValue("beforeSend",s.ajaxSettings),onSuccess:function(h){var w,l,y,a,b,p,v,c;if(t.isNullOrUndefined(h))w={error:{fileExists:null,message:i(n,"Server-Error")+" "+n.ajaxSettings.url,code:"406"},files:null},fa(n,s,u,w,f,e,o);else{if("string"==typeof h&&(h=JSON.parse(h)),n.notify(dt,{action:"success"}),l=n.expandedId?n.expandedId:n.pathId[n.pathId.length-1],t.isNullOrUndefined(h.cwd)||"read"!==t.getValue("action",r)||(h.cwd.name=1===n.pathId.length&&n.rootAliasName||h.cwd.name,t.setValue("_fm_id",l,h.cwd),t.setValue(l,h.cwd,n.feParent),t.isNullOrUndefined(h.files)&&"401"!==h.error.code)||(("finalize-end"===f||"initial-end"===f)&&0===n.pathNames.length&&(y=t.getValue(n.pathId[0],n.feParent),n.pathNames[0]=t.getValue("name",y),n.hasId=!t.isNullOrUndefined(t.getValue("id",y))),"finalize-end"===f&&function(n){for(var u,f=n.hasId?"id":"name",r=n.hasId?"":"/",i=n.hasId?0:1;i<n.pathId.length;i++)u=t.getValue(n.pathId[i],n.feParent),r+=t.getValue(f,u)+"/";n.setProperties({path:r},!0)}(n)),!t.isNullOrUndefined(h.files)){for(!function(n){for(var i=0;i<n.length;i++)t.setValue("_fm_created",new Date(t.getValue("dateCreated",n[i])),n[i]),t.setValue("_fm_modified",new Date(t.getValue("dateModified",n[i])),n[i])}(h.files),a=0,b=h.files.length;a<b;a++)p=h.files[a],t.setValue("_fm_iconClass",rf(p),p);"read"===t.getValue("action",r)&&(function(n,i){for(var u=vl(n.files),r=0,f=u.length;r<f;r++)t.setValue("_fm_id",i+"_"+r,u[r])}(h,l),t.setValue(l,h.files,n.feFiles))}t.isNullOrUndefined(h.details)||t.isNullOrUndefined(n.rootAliasName)||(v=n.rootAliasName||t.getValue("name",h.details),c=t.getValue("location",h.details).replace(new RegExp("/","g"),"\\"),("/"===t.getValue("path",r)||n.hasId&&1===t.getValue("path",r).match(/[/]/g).length)&&0===t.getValue("names",r).length?(t.setValue("name",v,h.details),c=v):c=c.replace(c.substring(0,c.indexOf("\\")),v),t.setValue("location",c,h.details));u(n,h,f,e,o);t.isNullOrUndefined(h.files)||"path-changed"!==f&&"finalize-end"!==f&&"open-end"!==f||n.notify(ve,h);"function"==typeof t.getValue("onSuccess",s.ajaxSettings)&&t.getValue("onSuccess",s.ajaxSettings)()}},onFailure:function(){var t={files:null,error:{code:"404",message:i(n,"Network-Error")+" "+n.ajaxSettings.url,fileExists:null}};fa(n,s,u,t,f,e,o)}}).send())})}function fa(n,i,r,u,f,e,o){n.notify(dt,{action:"failure"});r(n,u,f,e,o);"function"==typeof t.getValue("onFailure",i.ajaxSettings)&&t.getValue("onFailure",i.ajaxSettings)()}function dy(n,i,r){if(t.isNullOrUndefined(i.files))"401"===i.error.code&&(i.files=[],n.notify(r,i),n.notify(c,{})),ii(n,i,"read");else{n.notify(r,i);n.notify(c,{});var u={action:"read",result:i};n.trigger("success",u)}n.isDragDrop&&n.isDropEnd&&(0!==n.droppedObjects.length&&(u={fileDetails:n.droppedObjects},n.trigger("fileDropped",u)),n.isDropEnd=n.isDragDrop=!1)}function gy(n,i,r,u){if(t.isNullOrUndefined(i.files))ii(n,i,u);else{n.notify(r,i);var f={action:u,result:i};n.trigger("success",f)}}function np(n,r,u){var e,h,f;t.isNullOrUndefined(r.files)?"400"===r.error.code?(n.dialogObj&&n.dialogObj.visible?(e=t.select("#newname",n.dialogObj.element),h=i(n,"Validation-NewFolder-Exists").replace("{0}",'"'+e.value+'"'),e.parentElement.nextElementSibling.innerHTML=h):s(n,"Error",{files:null,error:{code:"400",message:i(n,"Validation-NewFolder-Exists").replace("{0}",'"'+u+'"'),fileExists:null}}),f={action:"create",error:r.error},n.trigger("failure",f)):(n.dialogObj&&n.dialogObj.visible&&n.dialogObj.hide(),ii(n,r,"create")):(n.dialogObj&&n.dialogObj.visible&&n.dialogObj.hide(),n.createdItem=r.files[0],n.breadcrumbbarModule.searchObj.value="",f={action:"create",result:r},n.trigger("success",f),n.itemData=[v(n)],o(n,st,n.path))}function tp(n,r){var e,u,f;t.isNullOrUndefined(r.files)?"400"===r.error.code&&n.dialogObj&&n.dialogObj.visible?(e=t.select("#rename",n.dialogObj.element),u=i(n,"Validation-Rename-Exists").replace("{0}",'"'+n.currentItemText+'"'),u=u.replace("{1}",'"'+e.value+'"'),e.parentElement.nextElementSibling.innerHTML=u,f={action:"rename",error:r.error},n.trigger("failure",f)):(t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide(),ii(n,r,"rename")):(t.isNullOrUndefined(n.dialogObj)||n.dialogObj.hide(),f={action:"rename",result:r},n.trigger("success",f),n.renamedItem=r.files[0],"navigationpane"===n.activeModule?(n.pathId.pop(),n.itemData=[t.getValue(n.pathId[n.pathId.length-1],n.feParent)],o(n,du,ru(n.path))):(n.itemData=[v(n)],""!==n.breadcrumbbarModule.searchObj.value?ea(n,tt,n.path,n.searchWord,n.showHiddenItems,!n.searchSettings.ignoreCase):n.isFiltered?ch(n,tt):o(n,tt,n.path)))}function ip(n,i,r,u){i.error&&i.error.fileExists?(n.fileLength=0,t.isNullOrUndefined(i.files)||(n.isPasteError=!0,th(n,u,i)),uu(n,"DuplicateItems",i.error.fileExists),"404"===i.error.code&&s(n,"Error",i)):i.error||t.isNullOrUndefined(i.files)?i.error&&!t.isNullOrUndefined(i.files)?(n.isPasteError=!0,th(n,u,i),s(n,"Error",i)):ii(n,i,u):(n.isPasteError=!1,th(n,u,i))}function rp(n,i,r){if(t.isNullOrUndefined(i.files))ii(n,i,"delete");else if(n.setProperties({path:r},!0),n.itemData=[v(n)],o(n,ht,n.path),i.error)ii(n,i,"delete");else{var u={action:"delete",result:i};n.trigger("success",u)}}function up(n,i,r,u){if(t.isNullOrUndefined(i.details))ii(n,i,"details");else{s(n,u,null,i.details);var f={action:"details",result:i};n.trigger("success",f)}}function ii(n,t,i){s(n,"Error",t);var r={action:i,error:t.error};n.trigger("failure",r)}function ea(n,t,i,r,u,f){pi(n,{action:"search",path:i,searchString:r,showHiddenItems:u,caseSensitive:f,data:n.itemData},fp,t)}function fp(n,i,r){if(t.isNullOrUndefined(i.files))ii(n,i,"search");else{n.notify(r,i);var u={action:"search",result:i};n.trigger("success",u)}}function cf(n,i,r){var u=n.ajaxSettings.downloadUrl?n.ajaxSettings.downloadUrl:n.ajaxSettings.url,f={data:{action:"download",path:i,names:r,data:n.itemData},cancel:!1};n.trigger("beforeDownload",f,function(i){if(!i.cancel){var r=t.createElement("form",{id:n.element.id+"_downloadForm",attrs:{action:u,method:"post",name:"downloadForm",download:""}}),f=t.createElement("input",{id:n.element.id+"_hiddenForm",attrs:{name:"downloadInput",value:JSON.stringify(i.data),type:"hidden"}});r.appendChild(f);n.element.appendChild(r);document.forms.namedItem("downloadForm").submit();n.element.removeChild(r)}})}function s(n,r,u,f){var e=function(n,r,u,f){var o,c,s,l,h,e={header:"",content:"",buttons:[],dialogName:"",open:function(){fu(n,n.dialogObj,e.dialogName)},close:function(){af(n,n.dialogObj,e.dialogName)}};switch(r=f&&!0===f.multipleFiles?"MultipleFileDetails":r){case"NewFolder":e.dialogName="Create Folder";e.header=i(n,"Header-NewFolder");e.content='<input type="text" value="New folder" id="newname"><div class="e-fe-error"><\/div>';e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Create")},click:function(t){"keydown"!==t.type&&va(n)}}];e.open=op.bind(this,n);break;case"Delete":e.dialogName="Delete";n.selectedItems.length>1?(e.content=("<div>"+i(n,"Content-Multiple-Delete")+"<\/div>").replace("{0}",n.selectedItems.length.toString()),e.header=i(n,"Header-Multiple-Delete")):(e.content="<div>"+i(n,n.isFile?"Content-Delete":"Content-Folder-Delete")+"<\/div>",e.header=i(n,n.isFile?"Header-Delete":"Header-Folder-Delete"));e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){!function(n){n.dialogObj.hide();n.notify(fi,{})}(n)}},{buttonModel:{content:i(n,"Button-No")},click:function(){n.dialogObj.hide()}}];break;case"Rename":e.dialogName="Rename";e.header=i(n,"Header-Rename");e.content='<input type="text" class="e-input" id="rename"><div class="e-fe-error"><\/div>';e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Save")},click:function(t){"keydown"!==t.type&&ya(n)}}];e.open=sp.bind(this,n);break;case"details":e.dialogName="File Details";c=new t.Internationalization(n.locale).formatDate(new Date(f.modified),{format:"MMMM dd, yyyy HH:mm:ss"});o="";t.isNullOrUndefined(f.permission)||(o="<tr><td>"+i(n,"Permission")+'<\/td><td class="'+bt+'" >'+function(n){for(var u="",r=Object.keys(n),i=0;i<r.length;i++)"message"!==r[i]&&(u+=(0===i?"":", ")+r[i]+": "+t.getValue(r[i],n));return u}(f.permission)+"<\/td><\/tr>");e.header=f.name;e.content="<table><tr><td>"+i(n,"Type")+'<\/td><td class="'+bt+'" title="'+(f.isFile?"File":"Folder")+'">'+(f.isFile?"File":"Folder")+"<\/td><\/tr><tr><td>"+i(n,"Size")+'<\/td><td><span class="'+bt+'" title ="'+f.size+'">'+f.size+"<\/span><\/td><\/tr><tr><td>"+i(n,"Location")+'<\/td><td class="'+bt+'" title="'+f.location+'">'+f.location+"<\/td><\/tr><tr><td>"+i(n,"Modified")+'<\/td><td class="'+bt+'" >'+c+"<\/td><\/tr>"+o+"<\/table>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(){n.dialogObj.hide()}}];break;case"MultipleFileDetails":e.dialogName="File Details";l=(s=f.name.split(",").map(function(n){var t=n.indexOf(".")+1;return 0===t?"Folder":n.substr(t).replace(" ","")})).every(function(n,t,i){return n===i[0]})?"Folder"===s[0]?"Folder":s[0].toLocaleUpperCase()+" Type":"Multiple Types";h=f.location;e.header=f.name;e.content="<table><tr><td>"+i(n,"Type")+':<\/td><td class="'+bt+'">'+l+"<\/td><\/tr><tr><td>"+i(n,"Size")+":<\/td><td>"+f.size+'<span class="'+bt+'" title ="'+f.size+'"><\/span><\/td><\/tr><tr><td>'+i(n,"Location")+':<\/td><td class="'+bt+'" title="'+h+'">'+h+"<\/td><\/tr><\/table>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(t){"keydown"!==t.type&&n.dialogObj.hide()}}];break;case"Error":n.notify(rr,{});e.dialogName="Error";e.header="401"===u.error.code?'<span class="e-fe-icon e-fe-access-error"><\/span><div class="e-fe-access-header">'+i(n,"Access-Denied")+"<\/div>":i(n,"Error");e.content='<div class="'+ul+'">'+u.error.message+"<\/div>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Ok")},click:function(){n.dialogObj.hide()}}]}return e}(n,r,u,f);t.isNullOrUndefined(n.dialogObj)?(n.dialogObj=new w.Dialog({beforeOpen:ca.bind(this,n,e.dialogName),beforeClose:function(t){lf(n,n.dialogObj,t,e.dialogName)},header:e.header,content:e.content,buttons:e.buttons,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!0,allowDragging:!0,isModal:!0,target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:wt(n,n.isMobile?lu:ft),width:"350px",open:e.open,close:e.close,enableRtl:n.enableRtl,enableHtmlSanitizer:n.enableHtmlSanitizer,locale:n.locale}),n.dialogObj.isStringTemplate=!0,n.dialogObj.appendTo("#"+n.element.id+ho)):function(n,t){n.dialogObj.header=t.header;n.dialogObj.content=t.content;n.dialogObj.buttons=t.buttons;n.dialogObj.enableRtl=n.enableRtl;n.dialogObj.open=t.open;n.dialogObj.close=t.close;n.dialogObj.beforeOpen=ca.bind(this,n,t.dialogName);n.dialogObj.beforeClose=function(i){lf(n,n.dialogObj,i,t.dialogName)};n.dialogObj.dataBind();n.dialogObj.show()}(n,e)}function uu(n,r,u,f){var e=function(n,r,u,f){var s,o,h,e={header:"",content:"",buttons:[],dialogName:"",open:function(){fu(n,n.extDialogObj,e.dialogName)},close:function(){af(n,n.extDialogObj,e.dialogName)}};switch(r){case"Extension":e.header=i(n,"Header-Rename-Confirmation");e.content="<div>"+i(n,"Content-Rename-Confirmation")+"<\/div>";e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){n.extDialogObj.hide();sf(n,f,n.renameText)}},{buttonModel:{content:i(n,"Button-No")},click:function(){n.extDialogObj.hide();n.dialogObj.hide()}}];e.dialogName="Extension Change";break;case"DuplicateItems":e.dialogName="Duplicate Items";n.replaceItems=u;h=(o=n.replaceItems[n.fileLength]).lastIndexOf("/");o=-1===h?o:o.substring(h);e.header=i(n,"Header-Duplicate");s="<div>"+i(n,"Content-Duplicate")+"<\/div>";e.content=s.replace("{0}",o);e.close=function(){if(!n.isDropEnd&&0===n.duplicateItems.length){var t={fileDetails:n.droppedObjects};n.trigger("fileDropped",t);n.isDropEnd=n.isDragDrop=!1}af(n,n.extDialogObj,e.dialogName)};e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Yes")},click:function(){var i,r;if(n.duplicateItems.push(n.replaceItems[n.fileLength]),n.duplicateRecords.push(function(n,i){for(var f=null,u=n.isDragDrop?n.dragData:n.actionRecords,r=0;r<u.length;r++)if(t.getValue("name",u[r])===i){f=u[r];break}return f}(n,n.replaceItems[n.fileLength])),n.fileLength++,u[n.fileLength])i=n.replaceItems[n.fileLength],r=i.lastIndexOf("/"),i=-1===r?i:i.substring(r),n.extDialogObj.content=s.replace("{0}",i),n.extDialogObj.show();else{n.extDialogObj.hide();var f=n.isDragDrop?n.dragPath:n.targetPath,e=n.isDragDrop?n.dropPath:""===n.folderPath?n.path:n.folderPath,o=n.isDragDrop?"move":n.fileAction;uo(n,f,n.duplicateItems,e,o,n.duplicateItems,n.duplicateRecords)}}},{buttonModel:{content:i(n,"Button-No")},click:function(){var t,i;if(n.fileLength++,u[n.fileLength])t=n.replaceItems[n.fileLength],i=t.lastIndexOf("/"),t=-1===i?t:t.substring(i),n.extDialogObj.content=s.replace("{0}",t),n.extDialogObj.show();else if(n.extDialogObj.hide(),0!==n.duplicateItems.length){var r=n.isDragDrop?"move":n.fileAction,f=n.isDragDrop?n.dragPath:n.targetPath,e=n.isDragDrop?n.dropPath:""===n.folderPath?n.path:n.folderPath;uo(n,f,n.duplicateItems,e,r,n.duplicateItems,n.duplicateRecords)}}}];break;case"UploadRetry":e.dialogName="Retry Upload";e.header=i(n,"Header-Retry");e.content=n.retryFiles[0].name+'<div class="e-fe-retrycontent">'+i(n,"Content-Retry")+"<\/div>";e.open=ep.bind(this,n);e.close=function(){n.isRetryOpened=!1;vf(n);af(n,n.extDialogObj,e.dialogName)};e.buttons=[{buttonModel:{isPrimary:!0,content:i(n,"Button-Keep-Both")},click:function(){sa(n,!0)}},{buttonModel:{isPrimary:!0,content:i(n,"Button-Replace")},click:function(){sa(n,!1)}},{buttonModel:{isPrimary:!0,content:i(n,"Button-Skip")},click:function(){var t=0;n.isApplySame?(t=n.retryFiles.length,n.retryFiles=[],vf(n)):(t=1,n.retryFiles.splice(0,1),0!==n.retryFiles.length?uu(n,"UploadRetry"):vf(n));n.notify(se,{count:t})}}]}return e}(n,r,u,f);n.isApplySame=!1;t.isNullOrUndefined(n.extDialogObj)?(n.extDialogObj=new w.Dialog({beforeOpen:la.bind(this,n,e.dialogName),beforeClose:function(t){lf(n,n.extDialogObj,t,e.dialogName)},content:e.content,header:e.header,closeOnEscape:!0,allowDragging:!0,animationSettings:{effect:"None"},target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:wt(n,n.isMobile?lu:ft),enableRtl:n.enableRtl,showCloseIcon:!0,isModal:!0,width:350,buttons:e.buttons,open:e.open,close:e.close,enableHtmlSanitizer:n.enableHtmlSanitizer,locale:n.locale}),n.extDialogObj.isStringTemplate=!0,n.extDialogObj.appendTo("#"+n.element.id+lo)):(n.extDialogObj.header=e.header,n.extDialogObj.close=e.close,n.extDialogObj.open=e.open,n.extDialogObj.close=e.close,n.extDialogObj.content=e.content,n.extDialogObj.buttons=e.buttons,n.extDialogObj.enableRtl=n.enableRtl,n.extDialogObj.locale=n.locale,n.extDialogObj.beforeOpen=la.bind(this,n,e.dialogName),n.extDialogObj.beforeClose=function(t){lf(n,n.extDialogObj,t,e.dialogName)},n.extDialogObj.dataBind(),n.extDialogObj.show())}function ah(n,t,i,r){var u={cancel:i.cancel,popupName:r,popupModule:t};n.trigger("beforePopupOpen",u,function(n){i.cancel=n.cancel})}function lf(n,t,i,r){var u={cancel:i.cancel,popupModule:t,popupName:r};n.trigger("beforePopupClose",u,function(t){i.cancel=t.cancel;i.cancel||!i.isInteracted||"Rename"!==r&&"Create Folder"!==r||n.trigger(rr,{})})}function fu(n,t,i){var r={popupModule:t,element:t.element,popupName:i};n.trigger("popupOpen",r)}function af(n,t,i){var r={popupModule:t,element:t.element,popupName:i};n.trigger("popupClose",r)}function sa(n,t){n.isApplySame?(t?function(n){for(;0!==n.retryFiles.length;)n.retryArgs.push({action:"keepboth",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1)}(n):function(n){for(;0!==n.retryFiles.length;)n.retryArgs.push({action:"replace",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1)}(n),vf(n)):(n.retryArgs.push({action:t?"keepboth":"replace",file:n.retryFiles[0]}),n.uploadObj.retry(n.retryFiles[0]),n.retryFiles.splice(0,1),0!==n.retryFiles.length?uu(n,"UploadRetry"):vf(n))}function vf(n){var r=!0,i;n.isRetryOpened?n.isRetryOpened=!1:r=!1;i=t.select(".e-dlg-checkbox",n.extDialogObj.element);i&&t.remove(i);r?n.extDialogObj.hide():n.retryFiles=[]}function ep(n,r){var f;n.isRetryOpened=!0;var e=t.getValue("element",r),o=t.select(".e-dlg-content",e),u=n.createElement("div",{className:"e-dlg-checkbox"}),s=n.createElement("input",{id:n.element.id+"_applyall"});u.appendChild(s);o.appendChild(u);f=new oa.CheckBox({label:i(n,"ApplyAll-Label"),change:function(t){n.isApplySame=t.checked}});f.appendTo("#"+n.element.id+"_applyall");fu(n,n.extDialogObj,"Retry Upload")}function op(n){var r=t.select("#newname",n.dialogObj.element);r.parentElement.classList.contains("e-control-wrapper")||ha(r,i(n,"Content-NewFolder"));r.parentElement.nextElementSibling.innerHTML="";r.oninput=function(){vh(n,r)};r.onkeyup=function(t){13===ba(t)&&va(n)},function(n){var i=t.select("#newname",n.dialogObj.element),r;i.focus();i.value="";r=i.value.length;i.setSelectionRange(0,r)}(n);fu(n,n.dialogObj,"Create Folder")}function sp(n){var r=t.select("#rename",n.dialogObj.element);r.parentElement.classList.contains("e-control-wrapper")||ha(r,i(n,"Content-Rename"));r.parentElement.nextElementSibling.innerHTML="";r.oninput=function(){vh(n,r)};r.onkeyup=function(t){13===ba(t)&&ya(n)},function(n,t){var i,r;t.focus();i="";n.isFile&&!n.showFileExtension?(r=n.currentItemText.lastIndexOf("."),i=-1===r?n.currentItemText:n.currentItemText.substring(0,r)):i=n.currentItemText;t.value=i;n.isFile&&n.showFileExtension&&-1!==t.value.indexOf(".")?t.setSelectionRange(0,t.value.lastIndexOf(".")):t.setSelectionRange(0,t.value.length)}(n,r);fu(n,n.dialogObj,"Rename")}function ha(n,t){lh.Input.createInput({element:n,properties:{placeholder:t}})}function ca(n,i,r){aa(t.selectAll(".e-btn",n.dialogObj.element));ah(n,n.dialogObj,r,i)}function la(n,i,r){aa(t.selectAll(".e-btn",n.extDialogObj.element));ah(n,n.extDialogObj,r,i)}function aa(n){for(var i=function(t){n[t].onkeydown=function(n){13===n.keyCode&&n.preventDefault()};n[t].onkeyup=function(i){13===i.keyCode&&n[t].click()}},t=0;t<n.length;t++)i(t)}function va(n){var i=t.select("#newname",n.dialogObj.element);pa(n,i);""===i.parentElement.nextElementSibling.innerHTML&&ua(n,i.value)}function ya(n){var f=t.select("#rename",n.dialogObj.element),i,r,u;if(pa(n,f),""===f.parentElement.nextElementSibling.innerHTML)if(i=f.value,r=n.currentItemText.lastIndexOf("."),n.isFile&&!n.showFileExtension&&(i+=-1===r?"":n.currentItemText.substr(r)),n.renameText=i,n.currentItemText!==i)if(u="navigationpane"===n.activeModule?ru(n.path):n.path,n.renamedId=t.getValue("id",n.itemData[0]),n.isFile){var o=-1===r?"":n.currentItemText.substr(r),e=i.lastIndexOf("."),s=-1===e?"":i.substr(e);n.showFileExtension&&o!==s?uu(n,"Extension",null,u):sf(n,u,i)}else sf(n,u,i);else n.dialogObj.hide()}function vh(n,t){/[/\\|*?"<>:]/.test(t.value)?wa(n,t):t.parentElement.nextElementSibling.innerHTML=""===t.value?i(n,"Validation-Empty"):""}function pa(n,t){vh(n,t);var i=t.value.length-1;""!==t.value&&(t.value.lastIndexOf(".")===i||t.value.lastIndexOf(" ")===i)&&(n.showFileExtension||-1===n.currentItemText.lastIndexOf("."))&&wa(n,t)}function wa(n,t){var r=i(n,"Validation-Invalid").replace("{0}",'"'+t.value+'"');n.enableHtmlSanitizer?t.parentElement.nextElementSibling.textContent=r:t.parentElement.nextElementSibling.innerHTML=r}function ba(n){return n.keyCode?n.keyCode:n.which?n.which:n.charCode}function yh(n,i,r){var u=t.createElement("div",{className:"e-image-wrap"}),f=t.createElement("img",{className:"e-image",attrs:{src:r,alt:i}});u.appendChild(f);t.isNullOrUndefined(n.viewerObj)?(n.viewerObj=new w.Dialog({header:i,content:u,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!0,isModal:!0,width:"350px",height:"350px",target:n.popupTarget?n.popupTarget:"#"+n.element.id,cssClass:wt(n,n.isMobile?lu:ft),locale:n.locale,enableResize:!0,allowDragging:!0,enableHtmlSanitizer:n.enableHtmlSanitizer,position:{X:"center",Y:"center"},enableRtl:n.enableRtl,open:hp.bind(this,n),close:function(){af(n,n.viewerObj,"Image Preview")},beforeOpen:function(t){ah(n,n.viewerObj,t,"Image Preview")},beforeClose:function(t){lf(n,n.viewerObj,t,"Image Preview")},resizing:ph.bind(this,n),resizeStop:ph.bind(this,n)}),n.viewerObj.isStringTemplate=!0,n.viewerObj.appendTo("#"+n.element.id+co)):(n.viewerObj.refresh(),n.viewerObj.header=i,n.viewerObj.content=u,n.viewerObj.enableRtl=n.enableRtl,n.viewerObj.dataBind(),n.viewerObj.show())}function hp(n){setTimeout(function(){n.viewerObj&&n.viewerObj.element.focus()});ph(n);fu(n,n.viewerObj,"Image Preview")}function ph(n){var r=t.select(".e-dlg-content",n.viewerObj.element),u=t.select(".e-image-wrap",n.viewerObj.element),i=window.getComputedStyle(r,null),f=i?2*parseFloat(i.paddingRight):36,e=i?2*parseFloat(i.paddingBottom):20;u.style.width=r.offsetWidth-f+"px";u.style.height=r.offsetHeight-e+"px"}var yf,pf,wh,kh,da,eo,ga;yf={};n.r(yf);n.d(yf,{ACTIVE:()=>h,ALT_DIALOG_ID:()=>hv,AjaxSettings:()=>gh,BLUR:()=>ki,BREADCRUMBBAR_ID:()=>vr,BREADCRUMBS:()=>fl,BreadCrumbBar:()=>kh,CB_WRAP:()=>yu,CHECK:()=>wr,CHECK_SELECT:()=>cu,CLONE:()=>ie,COLLAPSED:()=>sy,CONTENT_ID:()=>ar,CONTEXT_MENU_ID:()=>vo,CONTROL:()=>wv,Column:()=>sv,ContextMenu:()=>ka,ContextMenuSettings:()=>cc,DETAILS_LABEL:()=>ey,DIALOG_ID:()=>ho,DISPLAY_NONE:()=>ui,DROP_FILE:()=>bo,DROP_FOLDER:()=>pu,DetailsView:()=>da,DetailsViewSettings:()=>ec,EMPTY:()=>b,EMPTY_CONTENT:()=>br,EMPTY_INNER_CONTENT:()=>kr,ERROR_CONTENT:()=>ul,EXTN_DIALOG_ID:()=>lo,FILTER:()=>gf,FOCUS:()=>pr,FOCUSED:()=>ne,FOLDER:()=>di,FRAME:()=>wo,FULLROW:()=>ee,FileManager:()=>vp,GRID_HEADER:()=>ko,GRID_ID:()=>cr,GRID_VIEW:()=>nr,HEADER_CHECK:()=>ys,HOVER:()=>yr,ICONS:()=>ue,ICON_BREADCRUMB:()=>il,ICON_CLEAR:()=>rl,ICON_COLLAPSIBLE:()=>hy,ICON_COPY:()=>rs,ICON_CUT:()=>is,ICON_DELETE:()=>fs,ICON_DETAILS:()=>ss,ICON_DOWNLOAD:()=>as,ICON_DROP_IN:()=>ry,ICON_DROP_OUT:()=>uy,ICON_GRID:()=>tr,ICON_IMAGE:()=>wu,ICON_LARGE:()=>ir,ICON_MUSIC:()=>kc,ICON_NEWFOLDER:()=>os,ICON_NO_DROP:()=>fy,ICON_OPEN:()=>tl,ICON_OPTIONS:()=>iy,ICON_PASTE:()=>us,ICON_REFRESH:()=>cs,ICON_RENAME:()=>es,ICON_SELECTALL:()=>ls,ICON_SHORTBY:()=>hs,ICON_UPLOAD:()=>ts,ICON_VIDEO:()=>dc,ICON_VIEW:()=>nl,IMG_DIALOG_ID:()=>co,LARGEICON_ID:()=>lr,LARGE_EMPTY_FOLDER:()=>gc,LARGE_EMPTY_FOLDER_TWO:()=>kv,LARGE_ICON:()=>bu,LARGE_ICONS:()=>au,LARGE_ICON_FOLDER:()=>dv,LAYOUT:()=>yc,LAYOUT_CONTENT:()=>wc,LAYOUT_ID:()=>so,LIST_ITEM:()=>nt,LIST_PARENT:()=>bi,LIST_TEXT:()=>vu,LargeIconsView:()=>wh,MENU_ICON:()=>gi,MENU_ITEM:()=>go,MOBILE:()=>po,MOB_POPUP:()=>lu,MULTI_SELECT:()=>wi,NAVIGATION:()=>pc,NAVIGATION_ID:()=>vc,NavigationPane:()=>pp,NavigationPaneSettings:()=>lc,OVERLAY:()=>el,RETRY_DIALOG_ID:()=>cv,RETRY_ID:()=>yv,ROOT:()=>pv,ROOT_POPUP:()=>ft,ROW:()=>te,ROWCELL:()=>bv,RTL:()=>fe,SEARCH_ID:()=>yo,SELECTED_ITEMS:()=>gv,SORTBY_ID:()=>lv,SPLITTER_ID:()=>vv,SPLIT_BAR:()=>vs,STATUS:()=>oy,SUBMENU_ICON:()=>ns,SearchSettings:()=>rc,TB_ITEM:()=>bc,TB_OPTION_DOT:()=>ri,TB_OPTION_TICK:()=>a,TEMPLATE_CELL:()=>ty,TEXT_CONTENT:()=>ny,TOOLBAR_ID:()=>su,TREE_ID:()=>hr,TREE_VIEW:()=>re,Toolbar:()=>yp,ToolbarSettings:()=>ic,UPLOAD_DIALOG_ID:()=>ao,UPLOAD_ID:()=>hu,UploadSettings:()=>ac,VALUE:()=>bt,VIEW_ID:()=>av,actionFailure:()=>rr,afterRequest:()=>dt,beforeDelete:()=>cy,beforeDownload:()=>yy,beforeRequest:()=>si,clearAllInit:()=>gr,clearPathInit:()=>ku,columnArray:()=>fc,createDialog:()=>s,createEnd:()=>st,createExtDialog:()=>uu,createImageDialog:()=>yh,cutCopyInit:()=>vi,cutEnd:()=>le,deleteEnd:()=>ht,deleteInit:()=>fi,destroy:()=>et,detailsInit:()=>d,download:()=>ay,downloadInit:()=>ye,dragEnd:()=>pe,dragHelper:()=>py,dragging:()=>we,dropInit:()=>at,dropPath:()=>vt,fileItems:()=>oc,filterEnd:()=>dr,finalizeEnd:()=>k,folderItems:()=>sc,hideLayout:()=>er,hidePaste:()=>nu,initialEnd:()=>kt,isFile:()=>ol,layoutChange:()=>ot,layoutItems:()=>hc,layoutRefresh:()=>hi,menuItemData:()=>ai,methodCall:()=>rt,modelChanged:()=>f,nodeExpand:()=>he,openEnd:()=>lt,openInit:()=>ci,pasteEnd:()=>it,pasteInit:()=>ti,pathChanged:()=>p,pathColumn:()=>or,pathDrag:()=>oe,permissionCopy:()=>wy,permissionDownload:()=>iu,permissionEdit:()=>g,permissionEditContents:()=>ke,permissionRead:()=>be,permissionUpload:()=>ps,refreshEnd:()=>ct,renameEnd:()=>tt,renameEndParent:()=>du,renameInit:()=>gt,resizeEnd:()=>ei,search:()=>ur,searchTextChange:()=>ve,selectAllInit:()=>fr,selectedData:()=>ni,selectionChanged:()=>c,showPaste:()=>ce,skipUpload:()=>se,sortByChange:()=>li,sortColumn:()=>ae,splitterResize:()=>oi,toolbarItems:()=>tc,treeSelect:()=>vy,updateSelectionData:()=>tu,updateTreeSelection:()=>gu,upload:()=>ly});pf=n(665);const t=ejdashboard.base;var wf,nv=(wf=function(n,t){return wf=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},wf(n,t)},function(n,t){function i(){this.constructor=n}wf(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),bf=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},gh=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return nv(i,n),bf([t.Property(null)],i.prototype,"downloadUrl",void 0),bf([t.Property(null)],i.prototype,"getImageUrl",void 0),bf([t.Property(null)],i.prototype,"uploadUrl",void 0),bf([t.Property(null)],i.prototype,"url",void 0),i}(t.ChildProperty),tv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),nc=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},tc=["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"],ic=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return tv(i,n),nc([t.Property(tc)],i.prototype,"items",void 0),nc([t.Property(!0)],i.prototype,"visible",void 0),i}(t.ChildProperty),iv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),kf=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},rc=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return iv(i,n),kf([t.Property(!0)],i.prototype,"allowSearchOnTyping",void 0),kf([t.Property("contains")],i.prototype,"filterType",void 0),kf([t.Property(!0)],i.prototype,"ignoreCase",void 0),kf([t.Property(null)],i.prototype,"placeholder",void 0),i}(t.ChildProperty),rv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),uc=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},fc=[{field:"name",headerText:"Name",minWidth:120,template:'<span class="e-fe-text">${name}<\/span>',customAttributes:{"class":"e-fe-grid-name"}},{field:"_fm_modified",headerText:"DateModified",type:"dateTime",format:"MMMM dd, yyyy HH:mm",minWidth:120,width:"190"},{field:"size",headerText:"Size",minWidth:90,width:"110",template:'<span class="e-fe-size">${size}<\/span>'}],ec=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return rv(i,n),uc([t.Property(!0)],i.prototype,"columnResizing",void 0),uc([t.Property(fc)],i.prototype,"columns",void 0),i}(t.ChildProperty),uv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),df=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},oc=["Open","|","Cut","Copy","|","Delete","Download","Rename","|","Details"],sc=["Open","|","Cut","Copy","Paste","|","Delete","Rename","Download","|","Details"],hc=["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"],cc=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return uv(i,n),df([t.Property(oc)],i.prototype,"file",void 0),df([t.Property(sc)],i.prototype,"folder",void 0),df([t.Property(hc)],i.prototype,"layout",void 0),df([t.Property(!0)],i.prototype,"visible",void 0),i}(t.ChildProperty),fv=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),oo=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},lc=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return fv(i,n),oo([t.Property("650px")],i.prototype,"maxWidth",void 0),oo([t.Property("240px")],i.prototype,"minWidth",void 0),oo([t.Property(!0)],i.prototype,"visible",void 0),i}(t.ChildProperty),ev=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ou=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ac=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ev(i,n),ou([t.Property("")],i.prototype,"allowedExtensions",void 0),ou([t.Property(!0)],i.prototype,"autoUpload",void 0),ou([t.Property(!1)],i.prototype,"autoClose",void 0),ou([t.Property(0)],i.prototype,"minFileSize",void 0),ou([t.Property(3e7)],i.prototype,"maxFileSize",void 0),i}(t.ChildProperty),ov=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),l=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},sv=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return ov(i,n),l([t.Property("")],i.prototype,"field",void 0),l([t.Property("")],i.prototype,"headerText",void 0),l([t.Property("")],i.prototype,"width",void 0),l([t.Property("")],i.prototype,"minWidth",void 0),l([t.Property("")],i.prototype,"maxWidth",void 0),l([t.Property("Left")],i.prototype,"textAlign",void 0),l([t.Property(null)],i.prototype,"headerTextAlign",void 0),l([t.Property(null)],i.prototype,"type",void 0),l([t.Property(null)],i.prototype,"format",void 0),l([t.Property(null)],i.prototype,"template",void 0),l([t.Property(null)],i.prototype,"headerTemplate",void 0),l([t.Property(!0)],i.prototype,"allowSorting",void 0),l([t.Property(!0)],i.prototype,"allowResizing",void 0),l([t.Property(null)],i.prototype,"customAttributes",void 0),l([t.Property("")],i.prototype,"hideAtMedia",void 0),l([t.Property(null)],i.prototype,"customFormat",void 0),i}(t.ChildProperty),su="_toolbar",so="_layout",vc="_navigation",hr="_tree",cr="_grid",lr="_largeicons",ho="_dialog",hv="_alt_dialog",co="_img_dialog",lo="_extn_dialog",ao="_upload_dialog",cv="_retry_dialog",vo="_contextmenu",lv="_sortby",av="_view",vv="_splitter",ar="_content",vr="_breadcrumbbar",hu="_upload",yv="_retry",yo="_search",pv="e-filemanager",wv="e-control",cu="e-fe-cb-select",ft="e-fe-popup",po="e-fe-mobile",lu="e-fe-popup e-fe-mobile",wi="e-fe-m-select",gf="e-fe-m-filter",yc="e-layout",pc="e-navigation",wc="e-layout-content",au="e-large-icons",bc="e-toolbar-item",nt="e-list-item",vu="e-list-text",bi="e-list-parent",a="e-icons e-fe-tick",ri="e-icons e-fe-dot",ki="e-blur",h="e-active",yr="e-hover",pr="e-focus",ne="e-focused",wr="e-check",wo="e-frame",yu="e-checkbox-wrapper",te="e-row",bv="e-rowcell",b="e-empty",br="e-empty-content",kr="e-empty-inner-content",ie="e-fe-clone",pu="e-fe-drop-folder",bo="e-fe-drop-file",di="e-fe-folder",wu="e-fe-image",kc="e-fe-music",dc="e-fe-video",bu="e-large-icon",gc="e-empty-icon e-fe-folder",kv="e-empty-icon.e-fe-folder",dv="e-fe-folder",gv="e-items",ny="e-text-content",ko="e-gridheader",ty="e-templatecell",re="e-treeview",go="e-menu-item",gi="e-menu-icon",ns="e-caret",nr="e-content",nl="e-list-parent",tl="e-icons e-fe-open",ts="e-icons e-fe-upload",is="e-icons e-fe-cut",rs="e-icons e-fe-copy",us="e-icons e-fe-paste",fs="e-icons e-fe-delete",es="e-icons e-fe-rename",os="e-icons e-fe-newfolder",ss="e-icons e-fe-details",hs="e-icons e-fe-sort",cs="e-icons e-fe-refresh",ls="e-icons e-fe-select",as="e-icons e-fe-download",iy="e-icons e-fe-options",tr="e-icons e-fe-grid",ir="e-icons e-fe-large",il="e-icons e-fe-breadcrumb",rl="e-icons e-fe-clear",ry="e-icons e-fe-drop-in",uy="e-icons e-fe-drop-out",fy="e-icons e-fe-no-drop",ue="e-icons",ey="e-detailslabel",ul="e-fe-errorcontent",oy="e-status",fl="e-address",fe="e-rtl",ui="e-display-none",sy="e-node-collapsed",ee="e-fullrow",hy="e-icon-collapsible",vs="e-split-bar",ys="e-headercheck",el="e-fe-overlay",bt="e-fe-value",ol="isFile",f="model-changed",kt="initial-end",k="finalize-end",st="create-end",dr="filter-end",cy="before-delete",oe="path-drag",fi="delete-init",ht="delete-end",ct="refresh-end",ei="resize-end",oi="splitter-resize",p="path-changed",et="destroy",si="before-request",ly="upload",se="skip-upload",dt="after-request",ay="download",hi="layout-refresh",rr="actionFailure",ur="search",ci="open-init",lt="open-end",c="selection-changed",fr="select-all-init",gr="clear-all-init",ku="clear-path-init",ot="layout-change",li="sort-by-change",he="node-expand",d="details-init",ai="menu-item-data",gt="rename-init",du="rename-end-parent",tt="rename-end",ce="show-paste",nu="hide-paste",ni="selected-data",vi="cut-copy-init",ti="paste-init",it="paste-end",le="cut-end",er="hide-layout",gu="update-tree-selection",vy="select-node",ae="sort-column",or="path-column",ve="search-change",yy="before-download",ye="download-init",at="drop-init",pe="drag-end",vt="drop-path",py="drag-helper",we="dragging",tu="update-selection-data",rt="method-call",be="read",g="write",ke="writeContents",wy="copy",ps="upload",iu="download";const by=ejdashboard.layouts,w=ejdashboard.popups,u=ejdashboard.data;const lh=ejdashboard.inputs,oa=ejdashboard.buttons;const cp=ejdashboard.lists;wh=function(){function n(n){this.isInteraction=!0;this.uploadOperation=!1;this.count=0;this.isRendered=!0;this.tapCount=0;this.isPasteOperation=!1;this.isInteracted=!0;this.parent=n;this.element=t.select("#"+this.parent.element.id+lr,this.parent.element);t.addClass([this.element],au);this.addEventListener();this.keyConfigs={end:"end",home:"home",tab:"tab",moveDown:"downarrow",moveLeft:"leftarrow",moveRight:"rightarrow",moveUp:"uparrow",ctrlEnd:"ctrl+end",ctrlHome:"ctrl+home",ctrlDown:"ctrl+downarrow",ctrlLeft:"ctrl+leftarrow",ctrlRight:"ctrl+rightarrow",ctrlUp:"ctrl+uparrow",shiftEnd:"shift+end",shiftHome:"shift+home",shiftDown:"shift+downarrow",shiftLeft:"shift+leftarrow",shiftRight:"shift+rightarrow",shiftUp:"shift+uparrow",csEnd:"ctrl+shift+end",csHome:"ctrl+shift+home",csDown:"ctrl+shift+downarrow",csLeft:"ctrl+shift+leftarrow",csRight:"ctrl+shift+rightarrow",csUp:"ctrl+shift+uparrow",space:"space",ctrlSpace:"ctrl+space",shiftSpace:"shift+space",csSpace:"ctrl+shift+space",ctrlA:"ctrl+a",enter:"enter",altEnter:"alt+enter",esc:"escape",del:"delete",ctrlX:"ctrl+x",ctrlC:"ctrl+c",ctrlV:"ctrl+v",f2:"f2",shiftdel:"shift+delete",back:"backspace",ctrlD:"ctrl+d"}}return n.prototype.render=function(n){var u,f,e,i,r;if(this.parent.visitedItem=null,this.startItem=null,w.showSpinner(this.parent.element),"LargeIcons"===this.parent.view){for(this.resetMultiSelect(),this.element.setAttribute("tabindex","0"),this.listObj&&(this.unWireEvents(),this.removeEventListener()),this.parent.notify(er,{}),u=t.select("#"+this.parent.element.id+lr,this.parent.element),f=t.select("ul",u),(f&&t.remove(f),this.listObj={ariaAttributes:{itemRole:"option",listRole:"listbox",itemText:"",groupItemRole:"group",wrapperRole:""},showIcon:!0,fields:{text:"name",iconCss:"_fm_icon",imageUrl:"_fm_imageUrl",htmlAttributes:"_fm_htmlAttr"},sortOrder:this.parent.sortOrder,itemCreated:this.onItemCreated.bind(this),enableHtmlSanitizer:this.parent.enableHtmlSanitizer},this.items=[],this.items=this.renderList(n),this.items=pt(this.parent,this.items),this.listElements=cp.ListBase.createListFromJson(t.createElement,this.items,this.listObj),this.itemList=Array.prototype.slice.call(t.selectAll("."+nt,this.listElements)),this.element.appendChild(this.listElements),this.preventImgDrag(),this.createDragObj(),u.classList.remove(ui),0===this.itemList.length)?(e=this.element.querySelector("."+bi),this.element.removeChild(e),al(this.parent,this.element,n)):0!==this.itemList.length&&this.element.querySelector("."+b)&&this.element.removeChild(this.element.querySelector("."+b)),!0===this.isPasteOperation&&(this.selectItems(this.parent.pasteNodes),this.isPasteOperation=!1),!0===this.uploadOperation&&(this.selectItems(this.parent.uploadItem),this.parent.setProperties({selectedItems:[]},!0),this.count++,this.count===this.parent.uploadItem.length&&(this.uploadOperation=!1,this.parent.uploadItem=[])),i=this.element.querySelectorAll("."+h),0!==i.length&&(this.parent.activeModule="largeiconsview"),r=0;r<i.length;r++)i[r].setAttribute("aria-selected","true");this.adjustHeight();this.element.style.maxHeight="100%";this.getItemCount();this.addEventListener();this.wireEvents();this.isRendered=!0;w.hideSpinner(this.parent.element);this.parent.selectedItems.length&&this.checkItem()}},n.prototype.preventImgDrag=function(){for(var n=0;n<this.itemList.length;)this.itemList[n].querySelector("img")&&(this.itemList[n].ondragstart=function(){return!1}),n++},n.prototype.createDragObj=function(){var n=this;!this.parent.isMobile&&this.listObj&&(this.parent.allowDragAndDrop?(this.dragObj&&this.dragObj.destroy(),this.dragObj=new t.Draggable(this.listElements,{enableTailMode:!0,distance:5,enableAutoScroll:!0,dragTarget:"."+bu,helper:this.dragHelper.bind(this),cursorAt:this.parent.dragCursorPosition,dragArea:this.parent.element,dragStop:uh.bind(this,this.parent),drag:eh.bind(this,this.parent),clone:!0,dragStart:function(t){fh(n.parent,t,n.dragObj)}})):this.dragObj&&!this.parent.allowDragAndDrop&&this.dragObj.destroy())},n.prototype.dragHelper=function(n){var f=n.sender.target,i=t.closest(f,".e-list-item"),u,r;if(!i)return null;for(i&&!i.classList.contains("e-active")&&this.setFocus(i),u=this.element.querySelectorAll("."+h),this.parent.activeElements=[],this.parent.dragData=[],r=0;r<u.length;r++)this.parent.dragData.push(this.getItemObject(u[r])),this.parent.activeElements.push(u[r]);return ge(this.parent,i),this.parent.dragPath=this.parent.path,rh(this.parent),this.parent.virtualDragElement},n.prototype.onDropInit=function(n){var r,u,i;this.parent.targetModule===this.getModuleName()&&(r=t.closest(n.target,".e-list-item"),u=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent),r?(i=this.getItemObject(r),this.parent.dropPath=i.isFile?this.parent.path:uf(this.parent,i,this.parent.path),this.parent.dropData=i.isFile?u:i):(this.parent.dropPath=this.parent.path,this.parent.dropData=u))},n.prototype.getModuleName=function(){return"largeiconsview"},n.prototype.adjustHeight=function(){var n=t.select("#"+this.parent.element.id+ar,this.parent.element),i=t.select("#"+this.parent.element.id+vr,this.parent.element);this.element.style.height=n.offsetHeight-i.offsetHeight+"px"},n.prototype.onItemCreated=function(n){var r;if(n.item.removeAttribute("aria-level"),!this.parent.showFileExtension&&t.getValue("isFile",n.curData)){var u=n.item.querySelector("."+vu),i=t.getValue("name",n.curData),f=t.getValue("type",n.curData);u.innerHTML=i.substr(0,i.length-f.length)}this.renderCheckbox(n);r={element:n.item,fileDetails:n.curData,module:"LargeIconsView"};this.parent.trigger("fileLoad",r)},n.prototype.renderCheckbox=function(n){if(this.parent.allowMultiSelection){var i=oa.createCheckBox(t.createElement,!1,{checked:!1,cssClass:"e-small"});i.setAttribute("role","checkbox");i.setAttribute("aria-checked","false");n.item.firstElementChild.insertBefore(i,n.item.firstElementChild.childNodes[0])}},n.prototype.onLayoutChange=function(n){if("LargeIcons"===this.parent.view){if(this.destroy(),this.render(n),"layout-change"===t.getValue("name",n)&&"move"===this.parent.fileAction&&this.parent.isCut&&this.parent.selectedNodes&&0!==this.parent.selectedNodes.length)for(var r=this.getIndexes(this.parent.selectedNodes),i=0;i<r.length;)de(this.itemList[r[i]]),i++;0!==this.element.querySelectorAll("."+h).length&&this.element.focus();this.checkItem();this.parent.isLayoutChange=!1}else this.element.setAttribute("tabindex","-1")},n.prototype.checkItem=function(){var t=this.element.querySelectorAll("."+h),n;if(t)for(n=0;n<t.length;)this.checkState(t[n],!0),n++},n.prototype.renderList=function(n){for(var o,i=0,r=JSON.parse(JSON.stringify(n.files));i<r.length;){var u=rf(r[i]),f=t.getValue("name",r[i]),s=yi(this.parent,r[i]),e=this.parent.selectedItems&&-1!==this.parent.selectedItems.indexOf(s)?bu+" e-active":bu;(y(r[i])||(e+=" "+ro(r[i])),u===wu&&this.parent.showThumbnail&&ef(r[i]))?(o=gs(this.parent,r[i]),t.setValue("_fm_imageUrl",o,r[i]),t.setValue("_fm_imageAttr",{alt:f},r[i])):t.setValue("_fm_icon",u,r[i]);t.setValue("_fm_htmlAttr",{"class":e,title:f},r[i]);i++}return r},n.prototype.onFinalizeEnd=function(n){this.render(n)},n.prototype.onCreateEnd=function(n){"LargeIcons"===this.parent.view&&(this.onLayoutChange(n),this.clearSelect(),this.selectItems([t.getValue(this.parent.hasId?"id":"name",this.parent.createdItem)]),this.parent.createdItem=null,this.parent.largeiconsviewModule.element.focus())},n.prototype.onSelectedData=function(){"largeiconsview"===this.parent.activeModule&&this.updateSelectedData()},n.prototype.onDeleteInit=function(){"largeiconsview"===this.parent.activeModule&&fo(this.parent,this.parent.selectedItems,this.parent.path,"delete")},n.prototype.onDeleteEnd=function(n){"LargeIcons"===this.parent.view&&(this.onLayoutChange(n),this.parent.setProperties({selectedItems:[]},!0),this.clearSelect())},n.prototype.onRefreshEnd=function(n){"LargeIcons"===this.parent.view&&this.onLayoutChange(n)},n.prototype.onRenameInit=function(){"largeiconsview"===this.parent.activeModule&&1===this.parent.selectedItems.length&&this.updateRenameData()},n.prototype.onPathChanged=function(n){this.parent.isCut=!1;""===this.parent.breadcrumbbarModule.searchObj.element.value&&(this.parent.searchedItems=[]);"LargeIcons"===this.parent.view&&(ut(this.parent),this.parent.setProperties({selectedItems:[]},!0),this.onLayoutChange(n),this.parent.renamedItem&&(this.clearSelect(),this.addSelection(this.parent.renamedItem),this.parent.renamedItem=null))},n.prototype.onOpenInit=function(n){"largeiconsview"===this.parent.activeModule&&this.doOpenAction(n.target)},n.prototype.onHideLayout=function(){"LargeIcons"!==this.parent.view&&this.element&&this.element.classList.add(ui)},n.prototype.onSelectAllInit=function(){if("LargeIcons"===this.parent.view){this.startItem=this.getFirstItem();var n=this.getLastItem();this.doSelection(n,{ctrlKey:!0,shiftKey:!0});this.isInteraction=!0;this.isInteracted=!0}},n.prototype.onClearAllInit=function(){"LargeIcons"===this.parent.view&&(this.clearSelection(),this.isInteraction=!0,this.isInteracted=!0)},n.prototype.onBeforeRequest=function(){this.isRendered=!1},n.prototype.onAfterRequest=function(){this.isRendered=!0},n.prototype.onSearch=function(n){"LargeIcons"===this.parent.view&&(this.parent.setProperties({selectedItems:[]},!0),this.parent.notify(c,{}),this.parent.searchedItems=n.files,this.onLayoutChange(n))},n.prototype.onLayoutRefresh=function(){"LargeIcons"===this.parent.view&&this.adjustHeight()},n.prototype.onUpdateSelectionData=function(){"LargeIcons"===this.parent.view&&this.updateSelectedData()},n.prototype.onPathColumn=function(){"LargeIcons"!==this.parent.view||t.isNullOrUndefined(this.listObj)||""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered||"filterPath"!==this.parent.sortBy||(this.parent.sortBy="name",this.parent.notify(li,{}))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(or,this.onPathColumn),this.parent.off(k,this.onFinalizeEnd),this.parent.off(st,this.onCreateEnd),this.parent.off(ni,this.onSelectedData),this.parent.off(fi,this.onDeleteInit),this.parent.off(ht,this.onDeleteEnd),this.parent.off(ct,this.onRefreshEnd),this.parent.off(p,this.onPathChanged),this.parent.off(ot,this.onLayoutChange),this.parent.off(ur,this.onSearch),this.parent.off(ci,this.onOpenInit),this.parent.off(lt,this.onPathChanged),this.parent.off(f,this.onPropertyChanged),this.parent.off(rt,this.onMethodCall),this.parent.off(rr,this.onActionFailure),this.parent.off(gt,this.onRenameInit),this.parent.off(tt,this.onPathChanged),this.parent.off(er,this.onHideLayout),this.parent.off(fr,this.onSelectAllInit),this.parent.off(gr,this.onClearAllInit),this.parent.off(ai,this.onMenuItemData),this.parent.off(si,this.onBeforeRequest),this.parent.off(dt,this.onAfterRequest),this.parent.off(oi,this.splitterResizeHandler),this.parent.off(ei,this.resizeHandler),this.parent.off(ti,this.onpasteInit),this.parent.off(it,this.onpasteEnd),this.parent.off(vi,this.oncutCopyInit),this.parent.off(at,this.onDropInit),this.parent.off(d,this.onDetailsInit),this.parent.off(hi,this.onLayoutRefresh),this.parent.off(vt,this.onDropPath),this.parent.off(tu,this.onUpdateSelectionData),this.parent.off(dr,this.onPathChanged))},n.prototype.addEventListener=function(){this.parent.on(or,this.onPathColumn,this);this.parent.on(k,this.onFinalizeEnd,this);this.parent.on(st,this.onCreateEnd,this);this.parent.on(ct,this.onRefreshEnd,this);this.parent.on(ni,this.onSelectedData,this);this.parent.on(p,this.onPathChanged,this);this.parent.on(fi,this.onDeleteInit,this);this.parent.on(ti,this.onpasteInit,this);this.parent.on(ht,this.onDeleteEnd,this);this.parent.on(ot,this.onLayoutChange,this);this.parent.on(ur,this.onSearch,this);this.parent.on(ci,this.onOpenInit,this);this.parent.on(gt,this.onRenameInit,this);this.parent.on(tt,this.onPathChanged,this);this.parent.on(lt,this.onPathChanged,this);this.parent.on(f,this.onPropertyChanged,this);this.parent.on(rt,this.onMethodCall,this);this.parent.on(rr,this.onActionFailure,this);this.parent.on(er,this.onHideLayout,this);this.parent.on(fr,this.onSelectAllInit,this);this.parent.on(gr,this.onClearAllInit,this);this.parent.on(ai,this.onMenuItemData,this);this.parent.on(si,this.onBeforeRequest,this);this.parent.on(dt,this.onAfterRequest,this);this.parent.on(at,this.onDropInit,this);this.parent.on(d,this.onDetailsInit,this);this.parent.on(oi,this.splitterResizeHandler,this);this.parent.on(ei,this.resizeHandler,this);this.parent.on(it,this.onpasteEnd,this);this.parent.on(vi,this.oncutCopyInit,this);this.parent.on(hi,this.onLayoutRefresh,this);this.parent.on(vt,this.onDropPath,this);this.parent.on(tu,this.onUpdateSelectionData,this);this.parent.on(dr,this.onPathChanged,this)},n.prototype.onActionFailure=function(){this.isInteraction=!0;this.isInteracted=!0},n.prototype.onMenuItemData=function(n){if(this.parent.activeModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.itemData=[this.getItemObject(i)]}},n.prototype.onDetailsInit=function(){this.parent.activeModule===this.getModuleName()&&(0!==this.parent.selectedItems.length?this.updateSelectedData():this.parent.itemData=[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)])},n.prototype.onpasteInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=""===this.parent.folderPath?[v(this.parent)]:[this.getItemObject(t.select(".e-active",this.element))])},n.prototype.oncutCopyInit=function(){var t,n;if(this.parent.activeModule===this.getModuleName())for(t=this.element.querySelectorAll("."+h),this.parent.activeRecords=[],this.parent.activeElements=[],n=0;n<t.length;n++)this.parent.activeElements.push(t[n]),this.parent.activeRecords.push(this.getItemObject(t[n]))},n.prototype.onpasteEnd=function(n){"LargeIcons"===this.parent.view&&(this.isPasteOperation=!0,this.parent.path!==this.parent.destinationPath&&this.parent.path!==nh(this.parent,n)||this.onPathChanged(n))},n.prototype.onDropPath=function(n){"LargeIcons"===this.parent.view&&(this.isPasteOperation=!0,this.onPathChanged(n))},n.prototype.onPropertyChanged=function(n){var i,r,u;if(n.module===this.getModuleName()||"common"===n.module)for(r=0,u=Object.keys(n.newProp);r<u.length;r++)switch(u[r]){case"allowDragAndDrop":this.createDragObj();break;case"height":this.adjustHeight();break;case"selectedItems":this.isInteraction=!1;this.isInteracted=!1;i=t.isNullOrUndefined(this.parent.selectedItems)?[]:this.parent.selectedItems.slice(0);i=this.parent.allowMultiSelection?i:i.slice(i.length-1);this.parent.setProperties({selectedItems:[]},!0);this.onClearAllInit();i.length&&this.selectItems(i);this.parent.setProperties({selectedItems:this.parent.selectedItems},!0);this.isInteraction=!0;this.isInteracted=!0;break;case"showThumbnail":sr(this.parent);break;case"showFileExtension":case"showHiddenItems":o(this.parent,p,this.parent.path);break;case"allowMultiSelection":if("LargeIcons"!==this.parent.view)break;sr(this.parent);break;case"view":yt(this.parent,"LargeIcons")}},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.listObj&&this.unWireEvents())},n.prototype.wireEvents=function(){this.wireClickEvent(!0);this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keyup"});this.keyboardDownModule=new t.KeyboardEvents(this.element,{keyAction:this.keydownActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});t.EventHandler.add(this.element,"mouseover",this.onMouseOver,this)},n.prototype.unWireEvents=function(){this.wireClickEvent(!1);t.EventHandler.remove(this.element,"mouseover",this.onMouseOver);this.keyboardModule.destroy();this.keyboardDownModule.destroy()},n.prototype.onMouseOver=function(n){var i=t.closest(n.target,".e-list-item");ut(this.parent,"hover");null!==i&&i.classList.add(yr)},n.prototype.wireClickEvent=function(n){if(n){var i=this;this.clickObj=new t.Touch(this.element,{tap:function(n){n.originalEvent.preventDefault();i.parent.isDevice?(i.tapCount=n.tapCount,i.tapEvent=n,setTimeout(function(){i.tapCount>0&&i.doTapAction(i.tapEvent);i.tapCount=0},350)):2===n.tapCount&&3!==n.originalEvent.which?i.dblClickHandler(n):i.clickHandler(n)},tapHold:function(n){i.parent.isDevice&&(i.multiSelect=!!i.parent.allowMultiSelection,i.parent.allowMultiSelection&&t.addClass([i.parent.element],wi),i.clickHandler(n))}})}else this.clickObj&&this.clickObj.destroy()},n.prototype.doTapAction=function(n){var i=n.originalEvent.target,r=t.closest(i,"."+nt);this.multiSelect||i.classList.contains(bi)||t.isNullOrUndefined(r)?this.clickHandler(n):(this.parent.isFile=!1,this.updateType(r),this.parent.isFile?2===n.tapCount?(this.clickHandler(n),this.dblClickHandler(n)):this.clickHandler(n):this.dblClickHandler(n))},n.prototype.clickHandler=function(n){var t=n.originalEvent.target;ut(this.parent,"hover");this.doSelection(t,n.originalEvent);this.parent.activeModule="largeiconsview"},n.prototype.doSelection=function(n,i){var r=t.closest(n,"."+nt),s=n.classList,e,o,f,u;if(this.parent.isFile=!1,e="select",3!==i.which||t.isNullOrUndefined(r)||!r.classList.contains(h)){if(t.isNullOrUndefined(r))this.clearSelection();else if(this.parent.allowMultiSelection&&r.classList.contains(h)&&(i.ctrlKey||n.classList.contains(wr))&&(e="unselect"),!0!==this.triggerSelection(e,r).cancel){if(this.parent.allowMultiSelection&&(this.multiSelect||!i||i.ctrlKey)||s.contains(wo)||(this.updateType(r),this.clearSelect()),this.parent.allowMultiSelection&&i.shiftKey){if(i&&i.ctrlKey||this.clearSelect(),this.startItem||(this.startItem=r),o=this.itemList.indexOf(this.startItem),f=this.itemList.indexOf(r),o>f)for(u=o;u>=f;u--)this.addActive(this.itemList[u]);else for(u=o;u<=f;u++)this.addActive(this.itemList[u]);this.addFocus(this.itemList[f])}else this.startItem=r,this.parent.allowMultiSelection&&r.classList.contains(h)?this.removeActive(r):this.addActive(r),this.addFocus(r);0===this.parent.selectedItems.length&&this.resetMultiSelect();this.parent.notify(c,{});this.triggerSelect(e,r)}t.isNullOrUndefined(r)||this.updateType(r)}else this.updateType(r)},n.prototype.dblClickHandler=function(n){this.parent.activeModule="largeiconsview";var t=n.originalEvent.target;this.doOpenAction(t)},n.prototype.clearSelection=function(){this.clearSelect();this.resetMultiSelect();this.parent.notify(c,{})},n.prototype.resetMultiSelect=function(){this.multiSelect=!1;t.removeClass([this.parent.element],wi)},n.prototype.doOpenAction=function(n){var i=this,u,r,f;if(!t.isNullOrUndefined(n)&&(u=t.closest(n,"."+nt),this.parent.isFile=!1,!t.isNullOrUndefined(u))){if(this.updateType(u),r=this.getItemObject(u),!ef(r))return void e(this.parent,r,be);f={cancel:!1,fileDetails:r,module:"LargeIconsView"};this.parent.trigger("fileOpen",f,function(n){var u,e,f,o;n.cancel||(u=t.getValue("name",r),i.parent.isFile?rf(r)===wu&&(e=gs(i.parent,r),yh(i.parent,u,e)):(""!==i.parent.breadcrumbbarModule.searchObj.element.value||i.parent.isFiltered?wl(i.parent,r):(f=t.getValue("id",r),o=i.parent.path+(t.isNullOrUndefined(f)?u:f)+"/",i.parent.setProperties({path:o},!0),i.parent.pathNames.push(u),i.parent.pathId.push(t.getValue("_fm_id",r)),i.parent.itemData=[r],cl(i.parent)),i.parent.isFiltered=!1,i.parent.setProperties({selectedItems:[]},!0)))})}},n.prototype.updateType=function(n){var i=t.select("."+di,n);this.parent.isFile=!!t.isNullOrUndefined(i)},n.prototype.keydownActionHandler=function(n){if(this.isRendered)switch(n.action){case"end":case"home":case"moveDown":case"moveLeft":case"moveRight":case"moveUp":case"ctrlEnd":case"shiftEnd":case"csEnd":case"ctrlHome":case"shiftHome":case"csHome":case"ctrlDown":case"shiftDown":case"csDown":case"ctrlLeft":case"shiftLeft":case"csLeft":case"ctrlRight":case"shiftRight":case"csRight":case"space":case"ctrlSpace":case"shiftSpace":case"csSpace":case"ctrlA":case"enter":case"altEnter":case"esc":case"del":case"shiftdel":case"ctrlC":case"ctrlV":case"ctrlX":case"f2":case"ctrlD":n.preventDefault()}},n.prototype.keyActionHandler=function(n){if(this.isRendered){var i=this.getFocusedItem(),r=this.getFirstItem(),u=this.getLastItem();switch(n.action){case"end":this.navigateItem(u);break;case"home":this.navigateItem(r);break;case"tab":t.isNullOrUndefined(i)?t.isNullOrUndefined(r)||this.addFocus(r):this.addFocus(i);break;case"moveDown":this.navigateDown(i,!0);break;case"moveLeft":this.navigateRight(i,!1);break;case"moveRight":this.navigateRight(i,!0);break;case"moveUp":this.navigateDown(i,!1);break;case"ctrlEnd":case"shiftEnd":case"csEnd":this.csEndKey(u,n);break;case"ctrlHome":case"shiftHome":case"csHome":this.csHomeKey(r,n);break;case"ctrlDown":case"shiftDown":case"csDown":this.csDownKey(i,n);break;case"ctrlLeft":case"shiftLeft":case"csLeft":this.csLeftKey(i,n);break;case"ctrlRight":case"shiftRight":case"csRight":this.csRightKey(i,n);break;case"ctrlUp":case"shiftUp":case"csUp":this.csUpKey(i,n);break;case"space":this.spaceKey(i);break;case"ctrlSpace":case"shiftSpace":case"csSpace":t.isNullOrUndefined(i)||this.doSelection(i,n);break;case"ctrlA":this.ctrlAKey(r,u);break;case"enter":this.doOpenAction(this.parent.visitedItem?this.parent.visitedItem:this.getVisitedItem());break;case"altEnter":this.parent.notify(d,{});hf(this.parent,this.parent.selectedItems,this.parent.path,"details");break;case"esc":ds(this.parent);break;case"del":case"shiftdel":this.performDelete();break;case"ctrlC":nf(this.parent);break;case"ctrlV":this.parent.folderPath="";ff(this.parent);break;case"ctrlX":tf(this.parent);break;case"f2":this.performRename();break;case"ctrlD":this.doDownload()}}},n.prototype.doDownload=function(){this.updateSelectedData();na(this.parent)},n.prototype.performDelete=function(){if(this.parent.selectedItems&&this.parent.selectedItems.length>0){this.updateSelectedData();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!y(t[n]))return void e(this.parent,t[n],g);s(this.parent,"Delete")}},n.prototype.performRename=function(){1===this.parent.selectedItems.length&&(this.updateRenameData(),io(this.parent))},n.prototype.updateRenameData=function(){var n=t.select("."+nt+"."+h,this.element),i=this.getItemObject(n);to(this.parent,i)},n.prototype.getVisitedItem=function(){var n=this.parent.selectedItems[this.parent.selectedItems.length-1],t=this.getIndexes([n],this.parent.hasId);return this.itemList[t[0]]},n.prototype.getFocusedItem=function(){return t.select("."+nt+"."+pr,this.element)},n.prototype.getActiveItem=function(){return t.select("."+nt+"."+h,this.element)},n.prototype.getFirstItem=function(){return this.itemList[0]},n.prototype.getLastItem=function(){return this.itemList[this.itemList.length-1]},n.prototype.navigateItem=function(n){this.setFocus(n)},n.prototype.navigateDown=function(n,t){var i=this.getNextItem(n,t,this.perRow);this.setFocus(i)},n.prototype.navigateRight=function(n,t){var i=this.getNextItem(n,t);this.setFocus(i)},n.prototype.getNextItem=function(n,i,r){if(t.isNullOrUndefined(n))return this.getFocusedItem()||this.getActiveItem()||this.getFirstItem();var f,u=this.itemList.indexOf(n);do if(u=i?r?u+r:u+1:r?u-r:u-1,f=this.itemList[u],t.isNullOrUndefined(f))return n;while(!t.isVisible(f));return f},n.prototype.setFocus=function(n){t.isNullOrUndefined(n)||!0!==this.triggerSelection("select",n).cancel&&(this.startItem=n,this.clearSelect(),this.addActive(n),this.addFocus(n),this.parent.notify(c,{}),this.triggerSelect("select",n))},n.prototype.spaceKey=function(n){t.isNullOrUndefined(n)||n.classList.contains(h)||!0!==this.triggerSelection("select",n).cancel&&(this.addActive(n),this.parent.notify(c,{}),this.triggerSelect("select",n))},n.prototype.ctrlAKey=function(n,i){if(this.parent.allowMultiSelection&&!t.isNullOrUndefined(n)){this.startItem=n;var r=this.element.querySelector("."+bi),f=r.scrollTop,u=this.getFocusedItem();this.doSelection(i,{ctrlKey:!0,shiftKey:!0});r.scrollTop=f;t.isNullOrUndefined(u)||this.addFocus(u)}},n.prototype.csEndKey=function(n,i){this.parent.allowMultiSelection?t.isNullOrUndefined(n)||("ctrlEnd"===i.action?this.addFocus(n):this.doSelection(n,i)):this.navigateItem(n)},n.prototype.csHomeKey=function(n,i){this.parent.allowMultiSelection?t.isNullOrUndefined(n)||("ctrlHome"===i.action?this.addFocus(n):this.doSelection(n,i)):this.navigateItem(n)},n.prototype.csDownKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!0,this.perRow);t.isNullOrUndefined(r)||("ctrlDown"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateDown(n,!0)},n.prototype.csLeftKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!1);t.isNullOrUndefined(r)||("ctrlLeft"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateRight(n,!1)},n.prototype.csRightKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!0);t.isNullOrUndefined(r)||("ctrlRight"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateRight(n,!0)},n.prototype.csUpKey=function(n,i){if(this.parent.allowMultiSelection){var r=this.getNextItem(n,!1,this.perRow);t.isNullOrUndefined(r)||("ctrlUp"===i.action?this.addFocus(r):this.doSelection(r,i))}else this.navigateDown(n,!1)},n.prototype.addActive=function(n){t.isNullOrUndefined(n)||(n.classList.contains(h)||(this.parent.selectedItems.push(this.getDataName(n)),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0),t.addClass([n],[h]),n.setAttribute("aria-selected","true"),this.checkState(n,!0)),this.parent.visitedItem=n)},n.prototype.removeActive=function(n){if(!t.isNullOrUndefined(n)){t.removeClass([n],[h]);this.parent.allowMultiSelection?n.setAttribute("aria-selected","false"):n.removeAttribute("aria-selected");this.checkState(n,!1);var i=this.parent.selectedItems.indexOf(this.getDataName(n));i>-1&&(this.parent.selectedItems.splice(i,1),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0));this.parent.visitedItem=null}},n.prototype.getDataName=function(n){var t=this.getItemObject(n);return yi(this.parent,t)},n.prototype.addFocus=function(n){this.element.setAttribute("tabindex","-1");var i=this.getFocusedItem();i&&(i.removeAttribute("tabindex"),t.removeClass([i],[pr]));t.addClass([n],[pr]);n.setAttribute("tabindex","0");n.focus()},n.prototype.checkState=function(n,i){if(this.parent.allowMultiSelection){var r=t.select("."+wo,n);t.isNullOrUndefined(r)||(i?r.classList.contains(wr)||(t.addClass([r],wr),t.closest(r,"."+yu).setAttribute("aria-checked","true")):r.classList.contains(wr)&&(t.removeClass([r],wr),t.closest(r,"."+yu).setAttribute("aria-checked","false")))}},n.prototype.clearSelect=function(){var n=Array.prototype.slice.call(t.selectAll("."+h,this.listElements)),i,r;if(0!==n.length){if(!0!==this.triggerSelection("unselect",n[0]).cancel)for(i=0,r=n.length;i<r;i++)this.removeActive(n[i]);this.triggerSelect("unselect",n[0])}},n.prototype.resizeHandler=function(){this.getItemCount();t.isNullOrUndefined(this.listObj)||this.adjustHeight()},n.prototype.splitterResizeHandler=function(){this.getItemCount()},n.prototype.getItemCount=function(){var t=1,n,i;if(this.itemList)for(n=0,i=this.itemList.length-1;n<i&&this.itemList[n].getBoundingClientRect().top===this.itemList[n+1].getBoundingClientRect().top;n++)t++;this.perRow=t},n.prototype.triggerSelection=function(n,t){var i={action:n,fileDetails:this.getItemObject(t),isInteracted:this.isInteraction,cancel:!1,target:t};return this.parent.trigger("fileSelection",i),this.isInteraction=!0,i},n.prototype.triggerSelect=function(n,t){var i=this.getItemObject(t),r;this.parent.visitedData=i;r={action:n,fileDetails:i,isInteracted:this.isInteracted};this.parent.trigger("fileSelect",r);this.isInteracted=!0},n.prototype.selectItems=function(n){for(var i=this.getIndexes(n,this.parent.hasId),t=0,r=i.length;t<r;t++)this.doSelection(this.itemList[i[t]],{ctrlKey:!0,shiftKey:!1})},n.prototype.getIndexes=function(n,i){for(var u=[],f=i?"id":"name",r=0,e=this.items.length;r<e;r++)-1!==n.indexOf(t.getValue(f,this.items[r]))&&u.push(r);return u},n.prototype.getItemObject=function(n){var t=this.itemList.indexOf(n);return this.items[t]},n.prototype.addSelection=function(n){var i=[],r,f;this.parent.hasId?i=new u.DataManager(this.items).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(r=new u.DataManager(this.items).executeLocal((new u.Query).where("name","equal",t.getValue("name",n),!1)),r.length>0&&(i=new u.DataManager(r).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1))));i.length>0&&(f=this.items.indexOf(i[0]),this.doSelection(this.itemList[f],{ctrlKey:!0,shiftKey:!1}))},n.prototype.updateSelectedData=function(){for(var i=[],r=t.selectAll("."+nt+"."+h,this.element),n=0;n<r.length;n++)i[n]=this.getItemObject(r[n]);this.parent.itemData=i},n.prototype.onMethodCall=function(n){if("LargeIcons"===this.parent.view)switch(t.getValue("action",n)){case"deleteFiles":this.deleteFiles(t.getValue("ids",n));break;case"downloadFiles":this.downloadFiles(t.getValue("ids",n));break;case"openFile":this.openFile(t.getValue("id",n));break;case"renameFile":this.isInteraction=!1;this.isInteracted=!1;this.renameFile(t.getValue("id",n),t.getValue("newName",n));break;case"createFolder":this.isInteraction=!1;this.isInteracted=!1;break;case"clearSelection":this.isInteraction=!1;this.isInteracted=!1;this.onClearAllInit();break;case"selectAll":this.isInteraction=!1;this.isInteracted=!1;this.onSelectAllInit()}},n.prototype.getItemsIndex=function(n){var u=[],e=!(""===this.parent.breadcrumbbarModule.searchObj.element.value&&!this.parent.isFiltered),o=this.parent.hasId?"id":"name",i,r,f;if(this.parent.hasId||!e)for(i=0,r=this.items.length;i<r;i++)-1!==n.indexOf(t.getValue(o,this.items[i]))&&u.push(i);else for(i=0,r=this.items.length;i<r;i++)f=t.getValue("filterPath",this.items[i])+t.getValue("name",this.items[i]),-1!==n.indexOf(f)&&u.push(i);return u},n.prototype.deleteFiles=function(n){var r;if(this.parent.activeModule="largeiconsview",t.isNullOrUndefined(n))this.performDelete();else if(r=this.getItemsIndex(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=this.items[r[i]],f[i]=yi(this.parent,u[i]);ta(this.parent,u,f)}},n.prototype.downloadFiles=function(n){var r;if(t.isNullOrUndefined(n))this.doDownload();else if(r=this.getItemsIndex(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=this.items[r[i]],f[i]=yi(this.parent,u[i]);ia(this.parent,u,f)}},n.prototype.openFile=function(n){if(!t.isNullOrUndefined(n)){var i=this.getItemsIndex([n]);i.length>0&&this.doOpenAction(this.itemList[i[0]])}},n.prototype.renameFile=function(n,i){if(this.parent.activeModule="largeiconsview",t.isNullOrUndefined(n))this.performRename();else{var r=this.getItemsIndex([n]);r.length>0&&(to(this.parent,this.items[r[0]]),t.isNullOrUndefined(i)?io(this.parent):y(this.parent.itemData[0])?sf(this.parent,this.parent.path,i):e(this.parent,this.parent.itemData[0],g))}},n}();const bh=ejdashboard.splitbuttons;kh=function(){function n(n){this.addressPath="";this.addressBarLink="";this.searchTimer=null;this.searchWrapWidth=null;this.parent=n;this.keyConfigs={enter:"enter"};this.render()}return n.prototype.onPropertyChanged=function(n){var r,u,f,i;if(n.module===this.getModuleName()||"common"===n.module)for(r=0,u=Object.keys(n.newProp);r<u.length;r++)f=u[r],i=n.newProp.searchSettings,"searchSettings"===f&&(t.isNullOrUndefined(i.allowSearchOnTyping)||this.searchEventBind(i.allowSearchOnTyping),!this.parent.breadcrumbbarModule.searchObj.value||""===this.parent.breadcrumbbarModule.searchObj.value||!t.isNullOrUndefined(i.allowSearchOnTyping)&&t.isNullOrUndefined(i.filterType)&&t.isNullOrUndefined(i.ignoreCase)||no(this.parent,this.parent.breadcrumbbarModule.searchObj.value,!1))},n.prototype.render=function(){this.addEventListener()},n.prototype.onPathChange=function(){var o=this.parent.pathNames,a=this.parent.path.split("/"),f=this.parent.createElement("ul",{className:"e-addressbar-ul"}),i=null,c=o.length,r,n,u,e,l,s,h;if(o.length>0){for(r="",n=0;n<c;n++){for(u=null,i=this.parent.createElement("li",{className:"e-address-list-item"}),e=0;e<=n;e++)r=r+a[e]+"/";(i.setAttribute("data-utext",r),0!==n)&&(l=t.createElement("span",{className:ue}),i.appendChild(l));c-n!=1?(u=t.createElement("a",{className:vu}),i.setAttribute("tabindex","0")):u=t.createElement("span",{className:vu});r="";u.innerText=o[n];i.appendChild(u);f.appendChild(i)}s=this.parent.breadCrumbBarNavigation.querySelector(".e-addressbar-ul");t.isNullOrUndefined(s)||(t.isNullOrUndefined(this.subMenuObj)||this.subMenuObj.destroy(),t.remove(s));h=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap");h?this.parent.breadCrumbBarNavigation.appendChild(f):this.parent.breadCrumbBarNavigation.insertBefore(f,h);this.updateBreadCrumbBar(f)}},n.prototype.updateBreadCrumbBar=function(n){for(var a,o,tt,s,it,v,rt,h,y,p,c,w,b,k,u=n.querySelectorAll("li"),e=this.parent.breadCrumbBarNavigation.querySelector(".e-addressbar-ul"),d=window.getComputedStyle(e,null),ut=parseFloat(d.getPropertyValue("padding-right")),ft=parseFloat(d.getPropertyValue("padding-left")),l=e.offsetWidth-ut-ft,f=this.parent.createElement("ul",{className:"e-addressbar-ul"}),g=0,nt=[],r=0;r<u.length;r++)a=u[r].clientWidth,nt.push(a),g+=a;if(t.isNullOrUndefined(e)||t.remove(e),o=this.parent.createElement("div"),o.setAttribute("class","e-search-wrap"),tt=this.parent.element.id+yo,s=t.createElement("input",{id:tt,attrs:{autocomplete:"off","aria-label":i(this.parent,"Search")}}),o.appendChild(s),it=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap .e-input"),t.isNullOrUndefined(it)&&(this.parent.breadCrumbBarNavigation.appendChild(o),v=t.createElement("span",{className:"e-icons e-fe-search"}),t.EventHandler.add(v,"click",this.onShowInput,this),s.parentElement.insertBefore(v,s),this.searchObj=new lh.TextBox({value:"",showClearButton:!0,placeholder:i(this.parent,"Search"),focus:this.onFocus.bind(this),blur:this.onBlur.bind(this)}),this.searchObj.appendTo("#"+this.parent.element.id+yo),this.searchEventBind(this.parent.searchSettings.allowSearchOnTyping),rt=this.searchObj.element.nextElementSibling,t.EventHandler.add(rt,"mousedown",this.searchChangeHandler.bind(this),this),t.EventHandler.add(this.searchObj.element,"keyup",this.onKeyUp.bind(this),this)),h=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap"),g>(l-=this.searchWrapWidth?this.searchWrapWidth:h.offsetWidth)){for(r=u.length;r--;){if(y=l-nt[r],!(y>40)){for(p=[],c=0;c<=r;c++)w=u[c],p.push({text:w.innerText,utext:w.getAttribute("data-utext")});b=this.parent.createElement("li",{className:"e-breadcrumb-menu"});k=this.parent.createElement("button",{className:"e-breadcrumb-submenu"});b.appendChild(k);f.insertBefore(b,f.querySelector("li"));this.subMenuObj=new bh.DropDownButton({items:p,cssClass:"e-caret-hide e-submenu",iconCss:il,iconPosition:"Top",enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeItemRender:this.addSubMenuAttributes.bind(this),select:this.subMenuSelectOperations.bind(this)});this.subMenuObj.isStringTemplate=!0;this.subMenuObj.appendTo(k);break}f.insertBefore(u[r],f.querySelector("li"));l=y}this.parent.breadCrumbBarNavigation.insertBefore(f,h)}else this.parent.breadCrumbBarNavigation.insertBefore(n,h)},n.prototype.onFocus=function(){t.closest(this.searchObj.element,".e-search-wrap").classList.add("e-focus")},n.prototype.onKeyUp=function(){this.parent.notify(or,{args:this.parent})},n.prototype.onBlur=function(){t.closest(this.searchObj.element,".e-search-wrap").classList.remove("e-focus")},n.prototype.subMenuSelectOperations=function(n){var t={target:n.element};this.addressPathClickHandler(t)},n.prototype.addSubMenuAttributes=function(n){n.element.setAttribute("data-utext",t.getValue("utext",n.item));var i=this.parent.createElement("a",{className:"e-list-text"});n.element.appendChild(i)},n.prototype.searchEventBind=function(n){n?(this.searchObj.input=this.searchChangeHandler.bind(this),this.searchObj.change=null):(this.searchObj.change=this.searchChangeHandler.bind(this),this.searchObj.input=null)},n.prototype.searchChangeHandler=function(n){var i=this;t.isNullOrUndefined(n.value)||(this.parent.isFiltered=!1,this.parent.searchSettings.allowSearchOnTyping?(window.clearTimeout(this.searchTimer),this.searchTimer=window.setTimeout(function(){no(i.parent,n.value,!1)},300)):no(this.parent,n.value,!1))},n.prototype.addressPathClickHandler=function(n){var i=n.target,r,u,f;("LI"===i.nodeName||"A"===i.nodeName)&&(r="LI"===i.nodeName?i.children[0]:i,t.isNullOrUndefined(r)||(this.parent.isFiltered=!1,u=this.updatePath(r),this.parent.itemData=[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)],this.triggerFileOpen(this.parent.itemData[0]),o(this.parent,p,u),f=this.parent.pathId[this.parent.pathId.length-1],this.parent.notify(gu,{module:"treeview",selectedNode:f})))},n.prototype.triggerFileOpen=function(n){var t={cancel:!1,fileDetails:n,module:"BreadCrumbBar"};delete t.cancel;this.parent.trigger("fileOpen",t)},n.prototype.onShowInput=function(){if(this.parent.isMobile)if(this.parent.element.classList.contains(gf))t.removeClass([this.parent.element],gf),this.searchWrapWidth=null;else{var n=this.parent.breadCrumbBarNavigation.querySelector(".e-search-wrap");this.searchWrapWidth=n.offsetWidth;t.addClass([this.parent.element],gf);this.searchObj.element.focus()}},n.prototype.updatePath=function(n){var f=t.closest(n,"li").getAttribute("data-utext");this.addressBarLink=f;var u=this.addressBarLink.split("/"),e=this.parent.pathId,o=this.parent.pathNames;this.parent.pathId=[];this.parent.pathNames=[];for(var r="",i=0,s=u.length-1;i<s;i++)this.parent.pathId.push(e[i]),this.parent.pathNames.push(o[i]),r+=u[i]+"/";return this.parent.setProperties({path:r},!0),r},n.prototype.onUpdatePath=function(){this.onPathChange();this.removeSearchValue()},n.prototype.onCreateEnd=function(){this.onPathChange()},n.prototype.onRenameEnd=function(){this.onPathChange()},n.prototype.onDeleteEnd=function(){this.onUpdatePath()},n.prototype.removeSearchValue=function(){this.parent.isFiltered=!1;this.searchObj&&(""!==this.searchObj.value||""!==this.searchObj.element.value)&&(this.searchObj.value="",this.searchObj.element.value="",this.searchObj.dataBind())},n.prototype.onResize=function(){this.onPathChange()},n.prototype.onPasteEnd=function(){this.onPathChange()},n.prototype.addEventListener=function(){this.keyboardModule=new t.KeyboardEvents(this.parent.breadCrumbBarNavigation,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});this.parent.on(f,this.onPropertyChanged,this);t.EventHandler.add(this.parent.breadCrumbBarNavigation,"click",this.addressPathClickHandler,this);this.parent.on(et,this.destroy,this);this.parent.on(p,this.onUpdatePath,this);this.parent.on(k,this.onUpdatePath,this);this.parent.on(ct,this.onUpdatePath,this);this.parent.on(lt,this.onUpdatePath,this);this.parent.on(st,this.onCreateEnd,this);this.parent.on(tt,this.onRenameEnd,this);this.parent.on(ht,this.onDeleteEnd,this);this.parent.on(oi,this.onResize,this);this.parent.on(it,this.onPasteEnd,this);this.parent.on(ei,this.onResize,this);this.parent.on(ve,this.onSearchTextChange,this);this.parent.on(at,this.onDropInit,this);this.parent.on(hi,this.onResize,this);this.parent.on(vt,this.onPathChange,this)},n.prototype.keyActionHandler=function(n){"enter"===n.action&&this.addressPathClickHandler(n)},n.prototype.removeEventListener=function(){this.keyboardModule.destroy();this.parent.off(p,this.onUpdatePath);this.parent.off(k,this.onUpdatePath);this.parent.off(ct,this.onUpdatePath);this.parent.off(lt,this.onUpdatePath);this.parent.off(it,this.onPasteEnd);this.parent.off(st,this.onCreateEnd);this.parent.off(tt,this.onRenameEnd);this.parent.off(ht,this.onDeleteEnd);this.parent.off(oi,this.onResize);this.parent.off(ei,this.onResize);this.parent.off(ve,this.onSearchTextChange);this.parent.off(at,this.onDropInit);this.parent.off(hi,this.onResize);this.parent.off(vt,this.onPathChange)},n.prototype.onDropInit=function(n){var i,r;this.parent.targetModule===this.getModuleName()&&(i=n.target.closest("li"),this.parent.dropPath=this.updatePath(i.children[0]),this.parent.dropData=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent),this.triggerFileOpen(this.parent.dropData),r=this.parent.pathId[this.parent.pathId.length-1],this.parent.notify(gu,{module:"treeview",selectedNode:r}))},n.prototype.getModuleName=function(){return"breadcrumbbar"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),t.isNullOrUndefined(this.subMenuObj)||this.subMenuObj.destroy(),t.isNullOrUndefined(this.searchObj)||this.searchObj.destroy())},n.prototype.onSearchTextChange=function(n){this.searchObj.element.placeholder=null!=this.parent.searchSettings.placeholder?this.parent.searchSettings.placeholder:i(this.parent,"Search")+" "+n.cwd.name},n}();const dh=ejdashboard.navigations;var ka=function(){function n(n){this.currentItems=[];this.currentElement=null;this.disabledItems=[];this.parent=n;this.render()}return n.prototype.render=function(){this.keyConfigs={downarrow:"downarrow",uparrow:"uparrown"};this.contextMenu=new dh.ContextMenu({enableRtl:this.parent.enableRtl,locale:this.parent.locale,target:"#"+this.parent.element.id,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,beforeItemRender:this.onBeforeItemRender.bind(this),select:this.onSelect.bind(this),beforeOpen:this.onBeforeOpen.bind(this),beforeClose:this.onBeforeClose.bind(this),cssClass:wt(this.parent,ft)});this.contextMenu.isStringTemplate=!0;this.contextMenu.appendTo("#"+this.parent.element.id+vo);this.addEventListener()},n.prototype.onBeforeItemRender=function(n){var i,r;n.item.id===this.getMenuId("largeiconsview")&&(i=t.createElement("span"),(r=n.element).insertBefore(i,"LargeIcons"===this.parent.view?r.childNodes[1]:r.childNodes[0]),i.setAttribute("class",ir+" "+gi));n.item.id===this.getMenuId("detailsview")&&(i=t.createElement("span"),(r=n.element).insertBefore(i,"Details"===this.parent.view?r.childNodes[1]:r.childNodes[0]),i.setAttribute("class",tr+" "+gi))},n.prototype.onBeforeClose=function(){this.menuTarget=null},n.prototype.onBeforeOpen=function(n){var r=this,e,h,u,c;this.disabledItems=[];var f,o,s=!1,l=!1,i=n.event.target;this.menuTarget=this.targetNodeElement=i;this.currentElement=n.element;i.classList.contains("e-spinner-pane")&&(i=this.parent.navigationpaneModule.activeNode.getElementsByClassName(ee)[0],this.menuTarget=this.targetNodeElement=i);this.targetElement="Details"===this.parent.view?t.closest(i,"tr.e-row"):i;e=this.getTargetView(i);this.updateActiveModule();i.classList.contains(re)||t.closest(i,"th")||t.closest(i,"#"+this.parent.element.id+vr)||t.closest(i,"#"+this.parent.element.id+su)?n.cancel=!0:"LargeIcons"!==this.parent.view&&this.targetElement&&this.targetElement.classList.contains("e-emptyrow")||t.closest(i,"."+b)?this.setLayoutItem(i):i.classList.contains(go)||i.classList.contains(gi)||i.classList.contains(ns)||("LargeIcons"!==this.parent.view||t.isNullOrUndefined(t.closest(i,"li"))||t.closest(i,"#"+this.parent.element.id+hr)?t.isNullOrUndefined(t.closest(i,"tr.e-row"))?t.closest(i,"#"+this.parent.element.id+hr)&&(f=t.closest(i,"li").getAttribute("data-uid"),l=!0):(f=this.targetElement.getAttribute("data-uid"),o=this.parent.detailsviewModule.gridObj.getRowObjectFromUID(f).data,t.isNullOrUndefined(this.targetElement.getAttribute("aria-selected"))&&this.parent.detailsviewModule.gridObj.selectRows([parseInt(this.targetElement.getAttribute("aria-rowindex"),10)]),s=!0):(t.closest(i,"li").classList.contains("e-active")||this.parent.largeiconsviewModule.doSelection(i,{ctrlKey:!0,shiftKey:!0}),o=this.parent.visitedData,s=!0),s?!0===t.getValue("isFile",o)?this.setFileItem():this.setFolderItem(!1):l?(this.setFolderItem(!0),f===this.parent.pathId[0]&&this.disabledItems.push("Delete","Rename","Cut","Copy")):"TreeView"===e||"GridView"===e||"LargeIcon"===e?this.setLayoutItem(i):n.cancel=!0);h=t.select("#"+this.getMenuId("Paste"),this.contextMenu.element);(n.cancel||this.parent.enablePaste||!h||h.classList.contains("e-disabled")||this.disabledItems.push("Paste"),n.cancel)?this.menuTarget=this.currentElement=null:(this.contextMenu.dataBind(),u=!1,(i.classList.contains(go)||i.classList.contains(gi)||i.classList.contains(ns))&&(u=!0),this.menuItemData=u?this.menuItemData:this.getMenuItemData(),c={fileDetails:[this.menuItemData],element:n.element,target:i,items:u?n.items:this.contextMenu.items,menuModule:this.contextMenu,cancel:!1,menuType:this.menuType,isSubMenu:u},this.currentItems=c.items,this.parent.trigger("menuOpen",c,function(t){u||(r.contextMenu.dataBind(),r.contextMenu.items=t.items,r.contextMenu.dataBind());r.enableItems(r.disabledItems,!1,!0);n.cancel=t.cancel;t.cancel&&(r.menuTarget=r.targetNodeElement=r.currentElement=null)}))},n.prototype.updateActiveModule=function(){this.parent.activeModule=t.closest(this.menuTarget,"#"+this.parent.element.id+hr)?"navigationpane":t.closest(this.menuTarget,"#"+this.parent.element.id+cr)?"detailsview":t.closest(this.menuTarget,"#"+this.parent.element.id+lr)?"largeiconsview":this.parent.activeModule},n.prototype.getTargetView=function(n){return n.classList.contains(re)?"TreeView":n.classList.contains(nr)?"GridView":n.classList.contains(nl)||n.classList.contains(au)?"LargeIcon":""},n.prototype.getItemIndex=function(n){for(var i=this.getMenuId(n),t=0;t<this.currentItems.length;t++)if(this.currentItems[t].id===i||this.currentItems[t].id===n)return t;return-1},n.prototype.disableItem=function(n){0!==n.length&&(this.disabledItems=this.disabledItems.concat(n))},n.prototype.enableItems=function(n,t,i){for(var r=0;r<n.length;r++)1===this.checkValidItem(n[r])?this.contextMenu.enableItems([this.getMenuId(n[r])],t,i):2===this.checkValidItem(n[r])&&this.contextMenu.enableItems([n[r]],t,i)},n.prototype.setFolderItem=function(n){this.menuType="folder";this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.folder.map(function(n){return n.trim()}));this.contextMenu.dataBind();n?this.disabledItems.push("Open"):1!==this.parent.selectedItems.length&&this.disabledItems.push("Rename","Paste")},n.prototype.setFileItem=function(){this.menuType="file";this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.file.map(function(n){return n.trim()}));this.contextMenu.dataBind();1!==this.parent.selectedItems.length&&this.disabledItems.push("Rename")},n.prototype.setLayoutItem=function(n){this.menuType="layout";this.contextMenu.items=this.getItemData(this.parent.contextMenuSettings.layout.map(function(n){return n.trim()}));this.contextMenu.dataBind();(!this.parent.allowMultiSelection||"LargeIcons"===this.parent.view&&0!==t.closest(n,"#"+this.parent.element.id+lr).getElementsByClassName(b).length||"Details"===this.parent.view&&0!==t.closest(n,"#"+this.parent.element.id+cr).getElementsByClassName(b).length)&&this.disabledItems.push("SelectAll");0===this.parent.selectedNodes.length&&this.disabledItems.push("Paste");this.contextMenu.dataBind()},n.prototype.checkValidItem=function(n){return t.isNullOrUndefined(t.select("#"+this.getMenuId(n),this.currentElement))?t.isNullOrUndefined(t.select("#"+n,this.currentElement))?-1:2:1},n.prototype.getMenuItemData=function(){if("layout"===this.menuType)return v(this.parent);var n={target:this.menuTarget};return this.parent.notify(ai,n),this.parent.itemData[0]},n.prototype.onSelect=function(n){var i=this,r,u,f;!t.isNullOrUndefined(n.item)&&n.item.id&&(u=n.item.id.substr((this.parent.element.id+"_cm_").length),"refresh"===u||"newfolder"===u||"upload"===u?(r=[v(this.parent)],this.parent.itemData=r):(this.parent.notify(ni,{}),r="navigationpane"===this.parent.activeModule&&"open"===u?[this.menuItemData]:this.parent.itemData),f={cancel:!1,element:n.element,fileDetails:r,item:n.item},this.parent.trigger("menuClick",f,function(f){var c,o,h;if(!f.cancel)switch(u){case"cut":tf(i.parent);break;case"copy":nf(i.parent);break;case"paste":i.parent.folderPath="folder"!==i.menuType||"largeiconsview"!==i.parent.activeModule&&"detailsview"!==i.parent.activeModule?"":uf(i.parent,i.menuItemData,i.parent.path);ff(i.parent);break;case"delete":for(o=0;o<r.length;o++)if(!y(r[o]))return void e(i.parent,r[o],g);s(i.parent,"Delete");break;case"download":for(h=0;h<r.length;h++)if(!of(r[h]))return void e(i.parent,r[h],iu);"navigationpane"===i.parent.activeModule?i.parent.notify(ye,{}):i.parent.selectedItems.length>0&&cf(i.parent,i.parent.path,i.parent.selectedItems);break;case"rename":y(r[0])?(i.parent.notify(gt,{}),s(i.parent,"Rename")):e(i.parent,r[0],g);break;case"selectall":i.parent.notify(fr,{});break;case"refresh":sr(i.parent);break;case"open":i.parent.visitedItem?i.parent.notify(ci,{target:i.parent.visitedItem}):"navigationpane"===i.parent.activeModule&&i.parent.navigationpaneModule.openFileOnContextMenuClick(t.closest(i.targetNodeElement,"li"));break;case"details":i.parent.notify(d,{});c=i.parent.selectedItems;"navigationpane"===i.parent.activeModule&&(c=[]);hf(i.parent,c,i.parent.path,"details");break;case"newfolder":sh(i.parent);break;case"upload":hh(i.parent);break;case"name":case"size":case"date":case"ascending":case"descending":case"none":yl(i.parent,n);break;case"largeiconsview":yt(i.parent,"LargeIcons");break;case"detailsview":yt(i.parent,"Details")}}))},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)"cssClass"===i[t]&&(this.contextMenu.cssClass=wt(this.parent,ft))},n.prototype.addEventListener=function(){this.parent.on(et,this.destroy,this);this.parent.on(f,this.onPropertyChanged,this);this.keyboardModule=new t.KeyboardEvents(this.contextMenu.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},n.prototype.removeEventListener=function(){this.parent.off(et,this.destroy);this.parent.off(f,this.onPropertyChanged);this.keyboardModule.destroy()},n.prototype.keyActionHandler=function(n){switch(n.action){case"uparrow":case"downarrow":n.preventDefault()}},n.prototype.getModuleName=function(){return"contextmenu"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.contextMenu.destroy())},n.prototype.getItemData=function(n){for(var e=[],f=0;f<n.length;f++){var t=void 0,r=this.getMenuId(n[f]),u=i(this.parent,n[f]);switch(n[f]){case"|":t={separator:!0};break;case"Open":t={id:r,text:u,iconCss:tl};break;case"Upload":t={id:r,text:u,iconCss:ts};break;case"Cut":t={id:r,text:u,iconCss:is};break;case"Copy":t={id:r,text:u,iconCss:rs};break;case"Paste":t={id:r,text:u,iconCss:us};break;case"Delete":t={id:r,text:u,iconCss:fs};break;case"Rename":t={id:r,text:u,iconCss:es};break;case"NewFolder":t={id:r,text:u,iconCss:os};break;case"Details":t={id:r,text:u,iconCss:ss};break;case"SortBy":t={id:r,text:u,iconCss:hs,items:[{id:this.getMenuId("Name"),text:i(this.parent,"Name"),iconCss:"name"===this.parent.sortBy?ri:null},{id:this.getMenuId("Size"),text:i(this.parent,"Size"),iconCss:"size"===this.parent.sortBy?ri:null},{id:this.getMenuId("Date"),text:i(this.parent,"DateModified"),iconCss:"_fm_modified"===this.parent.sortBy?ri:null},{separator:!0},{id:this.getMenuId("Ascending"),text:i(this.parent,"Ascending"),iconCss:"Ascending"===this.parent.sortOrder?a:null},{id:this.getMenuId("Descending"),text:i(this.parent,"Descending"),iconCss:"Descending"===this.parent.sortOrder?a:null},{id:this.getMenuId("None"),text:i(this.parent,"None"),iconCss:"None"===this.parent.sortOrder?a:null}]};break;case"View":t={id:r,text:u,iconCss:"Details"===this.parent.view?tr:ir,items:[{id:this.getMenuId("largeiconsview"),text:i(this.parent,"View-LargeIcons"),iconCss:"Details"===this.parent.view?null:a},{id:this.getMenuId("detailsview"),text:i(this.parent,"View-Details"),iconCss:"Details"===this.parent.view?a:null}]};break;case"Refresh":t={id:r,text:u,iconCss:cs};break;case"SelectAll":t={id:r,text:u,iconCss:ls};break;case"Download":t={id:r,text:u,iconCss:as};break;default:t={id:r,text:u}}e.push(t)}return e},n.prototype.getMenuId=function(n){return this.parent.element.id+"_cm_"+n.toLowerCase()},n}(),lp={NewFolder:"New folder",Upload:"Upload",Delete:"Delete",Rename:"Rename",Download:"Download",Cut:"Cut",Copy:"Copy",Paste:"Paste",SortBy:"Sort by",Refresh:"Refresh","Item-Selection":"item selected","Items-Selection":"items selected",View:"View",Details:"Details",SelectAll:"Select all",Open:"Open","Tooltip-NewFolder":"New folder","Tooltip-Upload":"Upload","Tooltip-Delete":"Delete","Tooltip-Rename":"Rename","Tooltip-Download":"Download","Tooltip-Cut":"Cut","Tooltip-Copy":"Copy","Tooltip-Paste":"Paste","Tooltip-SortBy":"Sort by","Tooltip-Refresh":"Refresh","Tooltip-Selection":"Clear selection","Tooltip-View":"View","Tooltip-Details":"Details","Tooltip-SelectAll":"Select all",Name:"Name",Size:"Size",DateModified:"Modified",DateCreated:"Date created",Path:"Path",Modified:"Modified",Created:"Created",Location:"Location",Type:"Type",Permission:"Permission",Ascending:"Ascending",Descending:"Descending",None:"None","View-LargeIcons":"Large icons","View-Details":"Details",Search:"Search","Button-Ok":"OK","Button-Cancel":"Cancel","Button-Yes":"Yes","Button-No":"No","Button-Create":"Create","Button-Save":"Save","Header-NewFolder":"Folder","Content-NewFolder":"Enter your folder name","Header-Rename":"Rename","Content-Rename":"Enter your new name","Header-Rename-Confirmation":"Rename Confirmation","Content-Rename-Confirmation":"If you change a file name extension, the file might become unstable. Are you sure you want to change it?","Header-Delete":"Delete File","Content-Delete":"Are you sure you want to delete this file?","Header-Folder-Delete":"Delete Folder","Content-Folder-Delete":"Are you sure you want to delete this folder?","Header-Multiple-Delete":"Delete Multiple Items","Content-Multiple-Delete":"Are you sure you want to delete these {0} items?","Header-Duplicate":"File/Folder exists","Content-Duplicate":"{0} already exists. Do you want to rename and paste?","Header-Upload":"Upload Files",Error:"Error","Validation-Empty":"The file or folder name cannot be empty.","Validation-Invalid":'The file or folder name {0} contains invalid characters. Please use a different name. Valid file or folder names cannot end with a dot or space, and cannot contain any of the following characters: \\/:*?"<>|',"Validation-NewFolder-Exists":"A file or folder with the name {0} already exists.","Validation-Rename-Exists":"Cannot rename {0} to {1}: destination already exists.","Folder-Empty":"This folder is empty","File-Upload":"Drag files here to upload","Search-Empty":"No results found","Search-Key":"Try with different keywords","Filter-Empty":"No results found","Filter-Key":"Try with different filter","Sub-Folder-Error":"The destination folder is the subfolder of the source folder.","Same-Folder-Error":"The destination folder is the same as the source folder.","Access-Denied":"Access Denied","Access-Details":'You don"t have permission to access this folder.',"Header-Retry":"File Already Exists","Content-Retry":"A file with this name already exists in this folder. What would you like to do?","Button-Keep-Both":"Keep both","Button-Replace":"Replace","Button-Skip":"Skip","ApplyAll-Label":"Do this for all current items",KB:"KB","Access-Message":"{0} is not accessible. You need permission to perform the {1} action.","Network-Error":"NetworkError: Failed to send on XMLHTTPRequest: Failed to load","Server-Error":"ServerError: Invalid response from"},ap=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},vp=function(n){function u(t,i){var r=n.call(this,t,i)||this;return r.filterData=null,r.selectedNodes=[],r.duplicateItems=[],r.duplicateRecords=[],r.previousPath=[],r.nextPath=[],r.isLayoutChange=!1,r.layoutSelectedItems=[],r.renamedId=null,r.uploadItem=[],r.deleteRecords=[],r.isFile=!1,r.sortBy="name",r.isCut=!1,r.isSearchCut=!1,r.isSearchDrag=!1,r.isPasteError=!1,r.folderPath="",r.isSameAction=!1,r.isFiltered=!1,r.isSortByClicked=!1,r.enablePaste=!1,r.persistData=!1,r.retryArgs=[],r.isOpened=!1,r.isRetryOpened=!1,r.isPathDrag=!1,r.searchedItems=[],r.retryFiles=[],r.isApplySame=!1,r.dragData=[],r.dragNodes=[],r.dragPath="",r.dropPath="",r.isDragDrop=!1,r.treeExpandTimer=null,r.dragCursorPosition={left:44,top:18},r.isDropEnd=!1,r.dragCount=0,r.droppedObjects=[],r.uploadingCount=0,r.uploadedCount=0,h.Inject(kh,wh,ka),r}var h;return ap(u,n),h=u,u.prototype.getModuleName=function(){return"filemanager"},u.prototype.preRender=function(){(t.isNullOrUndefined(this.element.id)||""===this.element.id)&&this.element.setAttribute("id",t.getUniqueID("filemanager"));this.ensurePath();this.feParent=[];this.feFiles=[];t.setStyleAttribute(this.element,{width:t.formatUnit(this.width),height:t.formatUnit(this.height)});this.isDevice=t.Browser.isDevice;this.isMobile=this.checkMobile();this.isMobile&&this.setProperties({navigationPaneSettings:{visible:!1}},!0);var n=t.closest(this.element,".e-bigger");this.isBigger=!!n;this.activeModule="LargeIcons"===this.view?"largeiconsview":"detailsview";w.createSpinner({target:this.element},t.createElement);this.addWrapper();this.keyConfigs={altN:"alt+n",f5:"f5",ctrlShift1:"ctrl+shift+1",ctrlShift2:"ctrl+shift+2",ctrlU:"ctrl+u"};this.localeObj=new t.L10n(this.getModuleName(),lp,this.locale)},u.prototype.getPersistData=function(){return this.addOnPersist(["view","path","selectedItems"])},u.prototype.requiredModules=function(){var n=[];return n.push({member:"breadcrumbbar",args:[this]}),n.push({member:"largeiconsview",args:[this]}),this.toolbarSettings.visible&&n.push({member:"toolbar",args:[this]}),this.navigationPaneSettings.visible&&n.push({member:"navigationpane",args:[this]}),this.view&&n.push({member:"detailsview",args:[this]}),this.contextMenuSettings.visible&&!this.isDevice&&n.push({member:"contextmenu",args:[this]}),n},u.prototype.render=function(){this.initialize();var n=t.isNullOrUndefined(this.selectedItems)?[]:this.allowMultiSelection?this.selectedItems:this.selectedItems.slice(this.selectedItems.length-1);this.setProperties({selectedItems:n},!0);this.fileView=this.view;this.setRtl(this.enableRtl);this.addEventListeners();o(this,this.path!==this.originalPath?kt:k,this.path);this.adjustHeight();t.isNullOrUndefined(this.navigationpaneModule)&&(this.splitterObj.collapse(this.enableRtl?1:0),t.select("."+vs,this.element).classList.add(ui));this.wireEvents();this.renderComplete()},u.prototype.ensurePath=function(){var n=this.path,i;t.isNullOrUndefined(n)&&(n="/");n.lastIndexOf("/")!==n.length-1&&(n+="/");this.originalPath=n;i=n.split("/");this.setProperties({path:i[0]+"/"},!0);this.pathNames=[];this.pathId=["fe_tree"];this.itemData=[]},u.prototype.initialize=function(){this.isMobile&&t.addClass([this.element],po);this.allowMultiSelection&&t.addClass([this.element],cu);this.addCssClass(null,this.cssClass);this.renderFileUpload()},u.prototype.addWrapper=function(){var v=this.createElement("div",{id:this.element.id+su}),n,i,u,t,f,e,r,o,s,h,c,l,a;this.element.appendChild(v);n=this.createElement("div",{id:this.element.id+so,className:yc});this.element.appendChild(n);i=this.createElement("div",{id:this.element.id+vc,className:pc});u=this.createElement("div",{id:this.element.id+hr});i.appendChild(u);t=this.createElement("div",{id:this.element.id+ar,className:wc});this.breadCrumbBarNavigation=this.createElement("div",{id:this.element.id+vr,className:fl});t.appendChild(this.breadCrumbBarNavigation);f=this.createElement("div",{id:this.element.id+cr});t.appendChild(f);e=this.createElement("div",{id:this.element.id+lr,className:au,attrs:{role:"group"}});t.appendChild(e);o=this.createElement("span",{className:el});t.appendChild(o);this.enableRtl?(n.appendChild(t),n.appendChild(i),r=[{size:"75%",min:"270px"},{size:"25%",min:this.navigationPaneSettings.minWidth.toString(),max:this.navigationPaneSettings.maxWidth.toString()}]):(n.appendChild(i),n.appendChild(t),r=[{size:"25%",min:this.navigationPaneSettings.minWidth.toString(),max:this.navigationPaneSettings.maxWidth.toString()},{size:"75%",min:"270px"}]);this.splitterObj=new by.Splitter({paneSettings:r,width:"100%",enableRtl:!1,enableHtmlSanitizer:this.enableHtmlSanitizer,resizing:this.splitterResize.bind(this)});this.splitterObj.isStringTemplate=!0;this.splitterObj.appendTo(n);s=this.createElement("div",{id:this.element.id+ho});this.element.appendChild(s);h=this.createElement("ul",{id:this.element.id+vo});this.element.appendChild(h);c=this.createElement("div",{id:this.element.id+co});this.element.appendChild(c);l=this.createElement("div",{id:this.element.id+lo});this.element.appendChild(l);a=this.createElement("div",{id:this.element.id+ao});this.element.appendChild(a)},u.prototype.adjustHeight=function(){var n=t.select("#"+this.element.id+su,this.element),i=n?n.offsetHeight:0;this.splitterObj&&(this.splitterObj.height=(this.element.clientHeight-i).toString(),this.splitterObj.dataBind())},u.prototype.splitterResize=function(){this.notify(oi,{})},u.prototype.splitterAdjust=function(){var n=t.select("."+vs,this.element);this.navigationPaneSettings.visible?(this.splitterObj.expand(this.enableRtl?1:0),n.classList.remove(ui)):(this.splitterObj.collapse(this.enableRtl?1:0),n.classList.add(ui))},u.prototype.addCssClass=function(n,i){t.isNullOrUndefined(n)||""===n||t.removeClass([this.element],n.split(" "));t.isNullOrUndefined(i)||""===i||t.addClass([this.element],i.split(" "))},u.prototype.showSpinner=function(){w.showSpinner(this.element)},u.prototype.hideSpinner=function(){w.hideSpinner(this.element)},u.prototype.onContextMenu=function(n){n.preventDefault()},u.prototype.checkMobile=function(){return/iphone|ipod|android|blackberry|opera|mini|windows\sce|palm|smartphone|iemobile/i.test(t.Browser.userAgent.toLowerCase())&&/mobile/i.test(t.Browser.userAgent.toLowerCase())},u.prototype.renderFileUpload=function(){var t=this.element.id+hu,n=this.createElement("input",{id:t,attrs:{name:"uploadFiles",type:"file"}});this.element.appendChild(n);this.uploadDialogObj=new w.Dialog({header:i(this,"Header-Upload"),content:n,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,visible:!1,isModal:!0,width:"350px",target:this.popupTarget?this.popupTarget:"#"+this.element.id,cssClass:wt(this,this.isMobile?lu:ft),locale:this.locale,allowDragging:!0,position:{X:"center",Y:"center"},enableRtl:this.enableRtl,enableHtmlSanitizer:this.enableHtmlSanitizer,open:this.onOpen.bind(this),close:this.onClose.bind(this),beforeOpen:this.onBeforeOpen.bind(this),beforeClose:this.onBeforeClose.bind(this)});this.uploadDialogObj.appendTo("#"+this.element.id+ao);this.renderUploadBox()},u.prototype.renderUploadBox=function(){var n=this.ajaxSettings.uploadUrl?this.ajaxSettings.uploadUrl:this.ajaxSettings.url;this.uploadObj=new lh.Uploader({dropArea:t.select("#"+this.element.id+ar,this.element),asyncSettings:{saveUrl:n,removeUrl:n},locale:this.locale,enableRtl:this.enableRtl,uploading:this.onUploading.bind(this),removing:this.onRemoving.bind(this),canceling:this.onCancel.bind(this),clearing:this.onClearing.bind(this),selected:this.onSelected.bind(this),success:this.onUploadSuccess.bind(this),failure:this.onUploadFailure.bind(this),autoUpload:this.uploadSettings.autoUpload,minFileSize:this.uploadSettings.minFileSize,maxFileSize:this.uploadSettings.maxFileSize,allowedExtensions:this.uploadSettings.allowedExtensions,fileListRendering:this.onFileListRender.bind(this)});this.uploadObj.appendTo("#"+this.element.id+hu)},u.prototype.onFileListRender=function(n){this.trigger("uploadListCreate",n)},u.prototype.updateUploader=function(){this.uploadObj.autoUpload=this.uploadSettings.autoUpload;this.uploadObj.minFileSize=this.uploadSettings.minFileSize;this.uploadObj.maxFileSize=this.uploadSettings.maxFileSize;this.uploadObj.allowedExtensions=this.uploadSettings.allowedExtensions;this.uploadObj.dataBind()},u.prototype.onBeforeOpen=function(n){var t={cancel:n.cancel,popupName:"Upload",popupModule:this.uploadDialogObj};this.trigger("beforePopupOpen",t,function(t){n.cancel=t.cancel})},u.prototype.onBeforeClose=function(n){var t={cancel:n.cancel,popupName:"Upload",popupModule:this.uploadDialogObj};this.trigger("beforePopupClose",t,function(t){n.cancel=t.cancel})},u.prototype.onOpen=function(){this.isOpened=!0;this.uploadDialogObj.element.focus();var n={popupModule:this.uploadDialogObj,popupName:"Upload",element:this.uploadDialogObj.element};this.trigger("popupOpen",n)},u.prototype.onClose=function(){this.isOpened=!1;this.uploadObj.clearAll();var n={popupModule:this.uploadDialogObj,popupName:"Upload",element:this.uploadDialogObj.element};this.trigger("popupClose",n)},u.prototype.onUploading=function(n){var r="save",i,u,f;if(0!==this.retryArgs.length)for(i=0;i<this.retryArgs.length;i++)n.fileData.name===this.retryArgs[i].file.name&&(r=this.retryArgs[i].action,this.retryArgs.splice(i,1),i=this.retryArgs.length);u=JSON.stringify(t.getValue(this.pathId[this.pathId.length-1],this.feParent));n.customFormData=[{path:this.path},{action:r},{data:u}];f={url:this.ajaxSettings.uploadUrl?this.ajaxSettings.uploadUrl:this.ajaxSettings.url,type:"POST",mode:!0,dataType:null,contentType:null,data:JSON.stringify(n.customFormData),onSuccess:null,onFailure:null,beforeSend:null};this.uploadEventArgs={action:"Upload",ajaxSettings:f,cancel:!1};this.trigger("beforeSend",this.uploadEventArgs,function(i){n.customFormData=JSON.parse(t.getValue("data",i.ajaxSettings));n.cancel=i.cancel;var r={cancel:!1,httpRequest:n.currentRequest};"function"==typeof t.getValue("beforeSend",i.ajaxSettings)&&(t.getValue("beforeSend",i.ajaxSettings)(r),t.getValue("cancel",r)&&(n.cancel=t.getValue("cancel",r)))})},u.prototype.onRemoving=function(){this.onFileUploadSuccess({count:1});1===this.uploadObj.getFilesData().length&&this.uploadDialogObj.hide()},u.prototype.onCancel=function(n){var i=JSON.stringify(t.getValue(this.pathId[this.pathId.length-1],this.feParent));n.customFormData=[{path:this.path},{action:"remove"},{data:i}]},u.prototype.onClearing=function(){this.isOpened&&this.uploadDialogObj.hide()},u.prototype.onSelected=function(n){if(0!==n.filesData.length){this.uploadingCount=n.filesData.length;this.uploadedCount=0;var t=v(this);if(!ra(t))return n.cancel=!0,void e(this,t,ps);this.uploadDialogObj.show()}},u.prototype.onFileUploadSuccess=function(n){this.uploadedCount=this.uploadedCount+n.count;this.uploadSettings.autoClose&&this.uploadingCount===this.uploadedCount&&this.uploadDialogObj.hide()},u.prototype.onUploadSuccess=function(n){var i={action:"Upload",result:n};this.trigger("success",i);this.itemData=[t.getValue(this.pathId[this.pathId.length-1],this.feParent)];o(this,p,this.path);this.onFileUploadSuccess({count:1});"function"==typeof t.getValue("onSuccess",this.uploadEventArgs.ajaxSettings)&&t.getValue("onSuccess",this.uploadEventArgs.ajaxSettings)()},u.prototype.onUploadFailure=function(n){var i=t.getValue("response",n),r=t.getValue("statusText",i),u;""!==r&&t.setValue("statusText",r,n);u={action:"Upload",error:n};this.trigger("failure",u);400===t.getValue("statusCode",i)&&(this.retryFiles.push(t.getValue("file",n)),this.isRetryOpened||uu(this,"UploadRetry"));"function"==typeof t.getValue("onFailure",this.uploadEventArgs.ajaxSettings)&&t.getValue("onFailure",this.uploadEventArgs.ajaxSettings)()},u.prototype.onInitialEnd=function(){!function(n,i){for(var e=i.split("/"),u=n.originalPath.split("/"),s=t.getValue(n.pathId[0],n.feParent),h=t.isNullOrUndefined(t.getValue("id",s))?"name":"id",r=e.length-1,c=u.length-1;r<c;r++){var l=""===u[r+1]?k:kt,a=""===u[r]?"/":n.path+u[r]+"/",f=ky(n,h,u[r]),v=t.getValue("_fm_id",f);n.setProperties({path:a},!0);n.pathId.push(v);n.itemData=[f];n.pathNames.push(t.getValue("name",f));o(n,l,n.path);break}}(this,this.path)},u.prototype.addEventListeners=function(){this.on(si,this.showSpinner,this);this.on(dt,this.hideSpinner,this);this.on(kt,this.onInitialEnd,this);this.on(d,this.onDetailsInit,this);this.on(se,this.onFileUploadSuccess,this);t.EventHandler.add(this.element,"contextmenu",this.onContextMenu,this)},u.prototype.removeEventListeners=function(){this.isDestroyed||(this.off(si,this.showSpinner),this.off(dt,this.hideSpinner),this.off(kt,this.onInitialEnd),this.off(d,this.onDetailsInit),this.off(se,this.onFileUploadSuccess),t.EventHandler.remove(this.element,"contextmenu",this.onContextMenu))},u.prototype.onDetailsInit=function(){t.isNullOrUndefined(this.activeModule)&&(this.itemData=[t.getValue(this.pathId[this.pathId.length-1],this.feParent)])},u.prototype.resizeHandler=function(){this.adjustHeight();this.notify(ei,{})},u.prototype.keyActionHandler=function(n){switch(n.action){case"altN":n.preventDefault();this.itemData=[v(this)];oh(this.itemData[0])?s(this,"NewFolder"):e(this,this.itemData[0],ke);break;case"f5":n.preventDefault();sr(this);break;case"ctrlShift1":n.preventDefault();this.fileView="Details";this.setProperties({view:"Details"},!0);w.showSpinner(this.element);yt(this,"Details");break;case"ctrlShift2":n.preventDefault();this.fileView="LargeIcons";this.setProperties({view:"LargeIcons"},!0);w.showSpinner(this.element);yt(this,"LargeIcons");break;case"ctrlU":n.preventDefault();t.select("#"+this.element.id+hu,this.element).click()}},u.prototype.wireEvents=function(){t.EventHandler.add(window,"resize",this.resizeHandler,this);this.keyboardModule=new t.KeyboardEvents(this.element,{keyAction:this.keyActionHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},u.prototype.unWireEvents=function(){t.EventHandler.remove(window,"resize",this.resizeHandler);this.keyboardModule.destroy()},u.prototype.setPath=function(){this.setProperties({selectedItems:[]},!0);this.ensurePath();this.notify(ku,{selectedNode:this.pathId[0]});o(this,this.path!==this.originalPath?kt:k,this.path)},u.prototype.onPropertyChanged=function(n,i){for(var u,r=0,e=Object.keys(n);r<e.length;r++)switch(e[r]){case"ajaxSettings":this.ajaxSettingSetModel(n);break;case"allowDragAndDrop":this.allowDragAndDrop=n.allowDragAndDrop;this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"allowMultiSelection":this.allowMultiSelection?t.addClass([this.element],cu):(this.selectedItems.length>1&&this.setProperties({selectedItems:this.selectedItems.slice(this.selectedItems.length-1)},!0),t.removeClass([this.element],cu));this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"cssClass":this.addCssClass(i.cssClass,n.cssClass);this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"detailsViewSettings":this.notify(f,{module:"detailsview",newProp:n,oldProp:i});break;case"enableRtl":this.enableRtl=n.enableRtl;this.refresh();break;case"rootAliasName":this.rootAliasName=n.rootAliasName;this.refresh();break;case"height":u=t.isNullOrUndefined(n.height)?n.height:t.formatUnit(n.height);t.setStyleAttribute(this.element,{height:u});this.adjustHeight();this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"locale":t.isNullOrUndefined(n.enableRtl)||this.setProperties({enableRtl:n.enableRtl},!0);this.localeSetModelOption(n);break;case"navigationPaneSettings":this.splitterAdjust();this.notify(f,{module:"navigationpane",newProp:n,oldProp:i});break;case"path":this.setPath();break;case"searchSettings":t.isNullOrUndefined(n.searchSettings.allowSearchOnTyping)||this.setProperties({searchSettings:{allowSearchOnTyping:n.searchSettings.allowSearchOnTyping}},!0);t.isNullOrUndefined(n.searchSettings.ignoreCase)&&this.setProperties({searchSettings:{ignoreCase:n.searchSettings.ignoreCase}},!0);t.isNullOrUndefined(n.searchSettings.filterType)&&this.setProperties({searchSettings:{filterType:n.searchSettings.filterType}},!0);this.notify(f,{module:"breadcrumbbar",newProp:n,oldProp:i});break;case"selectedItems":"Details"===this.view?this.notify(f,{module:"detailsview",newProp:n,oldProp:i}):"LargeIcons"===this.view&&this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"showFileExtension":case"showHiddenItems":this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"showThumbnail":this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"toolbarSettings":this.adjustHeight();this.notify(f,{module:"toolbar",newProp:n,oldProp:i});break;case"uploadSettings":this.updateUploader();break;case"view":"Details"===n.view?this.notify(f,{module:"detailsview",newProp:n,oldProp:i}):"LargeIcons"===n.view&&this.notify(f,{module:"largeiconsview",newProp:n,oldProp:i});break;case"width":t.setStyleAttribute(this.element,{width:t.isNullOrUndefined(n.width)?n.width:t.formatUnit(n.width)});this.notify(f,{module:"common",newProp:n,oldProp:i});break;case"sortOrder":sr(this);this.notify(li,{});break;case"popupTarget":this.uploadDialogObj&&(this.uploadDialogObj.target=n.popupTarget);this.dialogObj&&(this.dialogObj.target=n.popupTarget);this.extDialogObj&&(this.extDialogObj.target=n.popupTarget);this.viewerObj&&(this.viewerObj.target=n.popupTarget)}},u.prototype.ajaxSettingSetModel=function(i){t.isNullOrUndefined(i.ajaxSettings.url)||this.setProperties({ajaxSettings:{url:i.ajaxSettings.url}},!0);t.isNullOrUndefined(i.ajaxSettings.uploadUrl)||this.setProperties({ajaxSettings:{uploadUrl:i.ajaxSettings.uploadUrl}},!0);t.isNullOrUndefined(i.ajaxSettings.downloadUrl)||this.setProperties({ajaxSettings:{downloadUrl:i.ajaxSettings.downloadUrl}},!0);t.isNullOrUndefined(i.ajaxSettings.getImageUrl)||this.setProperties({ajaxSettings:{getImageUrl:i.ajaxSettings.getImageUrl}},!0);this.setProperties({path:"/"},!0);this.setProperties({selectedItems:[]},!0);n.prototype.refresh.call(this)},u.prototype.localeSetModelOption=function(t){this.uploadObj.locale=t.locale;n.prototype.refresh.call(this)},u.prototype.destroy=function(){this.isDestroyed||(this.refreshing||this.notify(et,{}),this.uploadObj.destroy(),this.uploadObj=null,this.uploadDialogObj.destroy(),this.uploadDialogObj=null,this.splitterObj.destroy(),this.splitterObj=null,this.dialogObj&&(this.dialogObj.destroy(),this.dialogObj=null),this.viewerObj&&(this.viewerObj.destroy(),this.viewerObj=null),this.extDialogObj&&(this.extDialogObj.destroy(),this.extDialogObj=null),this.element.removeAttribute("style"),this.element.removeAttribute("tabindex"),this.removeEventListeners(),this.unWireEvents(),this.addCssClass(this.cssClass,null),t.removeClass([this.element],[fe,po,cu]),this.element.innerHTML="",n.prototype.destroy.call(this))},u.prototype.createFolder=function(n){this.notify(rt,{action:"createFolder"});var t=[v(this)];this.itemData=t;n?/[/\\|*?"<>:]/.test(n)?s(this,"Error",{files:null,error:{code:"402",message:i(this,"Validation-Invalid").replace("{0}",'"'+n+'"'),fileExists:null}}):oh(t[0])?ua(this,n):e(this,t[0],ke):sh(this)},u.prototype.deleteFiles=function(n){this.notify(rt,{action:"deleteFiles",ids:n})},u.prototype.disableToolbarItems=function(n){t.isNullOrUndefined(n)||this.toolbarModule.enableItems(n,!1)},u.prototype.downloadFiles=function(n){this.notify(rt,{action:"downloadFiles",ids:n})},u.prototype.enableToolbarItems=function(n){t.isNullOrUndefined(n)||this.toolbarModule.enableItems(n,!0)},u.prototype.disableMenuItems=function(n){t.isNullOrUndefined(n)||t.isNullOrUndefined(this.contextmenuModule.contextMenu)||this.contextmenuModule.disableItem(n)},u.prototype.getMenuItemIndex=function(n){return this.contextmenuModule?this.contextmenuModule.getItemIndex(n):-1},u.prototype.getToolbarItemIndex=function(n){return this.toolbarModule?this.toolbarModule.getItemIndex(n):-1},u.prototype.filterFiles=function(n){this.filterData=n||null;this.setProperties({selectedItems:[]},!0);this.notify(c,{});this.isFiltered=!0;""!==this.breadcrumbbarModule.searchObj.element.value&&(this.breadcrumbbarModule.searchObj.element.value="");ch(this,dr)},u.prototype.getSelectedFiles=function(){return this.notify(tu,{}),this.itemData},u.prototype.openFile=function(n){this.notify(rt,{action:"openFile",id:n})},u.prototype.refreshFiles=function(){sr(this)},u.prototype.refreshLayout=function(){this.adjustHeight();this.notify(hi,{})},u.prototype.selectAll=function(){this.notify(rt,{action:"selectAll"})},u.prototype.clearSelection=function(){this.notify(rt,{action:"clearSelection"})},u.prototype.renameFile=function(n,t){this.notify(rt,{action:"renameFile",id:n,newName:t})},u.prototype.uploadFiles=function(){var n=[v(this)];this.itemData=n;hh(this)},u.prototype.setRtl=function(n){n?this.addCssClass(null,fe):this.addCssClass(fe,null);this.uploadObj&&(this.uploadDialogObj.enableRtl=n,this.uploadObj.enableRtl=n)},r([t.Complex({},gh)],u.prototype,"ajaxSettings",void 0),r([t.Property(!1)],u.prototype,"allowDragAndDrop",void 0),r([t.Property(!0)],u.prototype,"allowMultiSelection",void 0),r([t.Complex({},cc)],u.prototype,"contextMenuSettings",void 0),r([t.Property("")],u.prototype,"cssClass",void 0),r([t.Complex({},ec)],u.prototype,"detailsViewSettings",void 0),r([t.Property(!0)],u.prototype,"enableHtmlSanitizer",void 0),r([t.Property(!1)],u.prototype,"enablePersistence",void 0),r([t.Property("400px")],u.prototype,"height",void 0),r([t.Property("LargeIcons")],u.prototype,"view",void 0),r([t.Complex({},lc)],u.prototype,"navigationPaneSettings",void 0),r([t.Property("/")],u.prototype,"path",void 0),r([t.Property(null)],u.prototype,"popupTarget",void 0),r([t.Complex({},rc)],u.prototype,"searchSettings",void 0),r([t.Property()],u.prototype,"selectedItems",void 0),r([t.Property(!0)],u.prototype,"showFileExtension",void 0),r([t.Property(null)],u.prototype,"rootAliasName",void 0),r([t.Property(!1)],u.prototype,"showHiddenItems",void 0),r([t.Property(!0)],u.prototype,"showThumbnail",void 0),r([t.Property("Ascending")],u.prototype,"sortOrder",void 0),r([t.Complex({},ic)],u.prototype,"toolbarSettings",void 0),r([t.Complex({},ac)],u.prototype,"uploadSettings",void 0),r([t.Property("100%")],u.prototype,"width",void 0),r([t.Event()],u.prototype,"fileLoad",void 0),r([t.Event()],u.prototype,"fileOpen",void 0),r([t.Event()],u.prototype,"beforeDownload",void 0),r([t.Event()],u.prototype,"beforeImageLoad",void 0),r([t.Event()],u.prototype,"beforePopupClose",void 0),r([t.Event()],u.prototype,"beforePopupOpen",void 0),r([t.Event()],u.prototype,"beforeSend",void 0),r([t.Event()],u.prototype,"created",void 0),r([t.Event()],u.prototype,"destroyed",void 0),r([t.Event()],u.prototype,"fileDragStart",void 0),r([t.Event()],u.prototype,"fileDragging",void 0),r([t.Event()],u.prototype,"fileDragStop",void 0),r([t.Event()],u.prototype,"fileDropped",void 0),r([t.Event()],u.prototype,"fileSelection",void 0),r([t.Event()],u.prototype,"fileSelect",void 0),r([t.Event()],u.prototype,"menuClick",void 0),r([t.Event()],u.prototype,"menuOpen",void 0),r([t.Event()],u.prototype,"failure",void 0),r([t.Event()],u.prototype,"popupClose",void 0),r([t.Event()],u.prototype,"popupOpen",void 0),r([t.Event()],u.prototype,"success",void 0),r([t.Event()],u.prototype,"toolbarClick",void 0),r([t.Event()],u.prototype,"toolbarCreate",void 0),r([t.Event()],u.prototype,"uploadListCreate",void 0),h=r([t.NotifyPropertyChanges],u)}(t.Component),yp=function(){function n(n){this.default=["Delete","Rename","Download","Cut","Copy","Paste"];this.single=["Delete","Rename","Download","Cut","Copy"];this.multiple=["Delete","Download","Cut","Copy","Refresh"];this.selection=["NewFolder","Upload","SortBy","Refresh"];this.parent=n;this.render();this.addEventListener()}return n.prototype.render=function(){var n=this,t;this.items=this.toolbarItemData(this.getItems(this.parent.toolbarSettings.items.map(function(n){return n.trim()})));t={items:this.items};this.parent.trigger("toolbarCreate",t,function(t){n.items=t.items;n.toolbarObj=new dh.Toolbar({items:n.items,created:n.toolbarCreateHandler.bind(n),overflowMode:"Popup",clicked:n.onClicked.bind(n),enableHtmlSanitizer:n.parent.enableHtmlSanitizer,enableRtl:n.parent.enableRtl});n.toolbarObj.isStringTemplate=!0;n.toolbarObj.appendTo("#"+n.parent.element.id+su)})},n.prototype.getItemIndex=function(n){for(var i=this.getId(n),t=0;t<this.items.length;t++)if(this.items[t].id===i)return t;return-1},n.prototype.getItems=function(n){var t=n.slice();return this.parent.isDevice&&this.parent.allowMultiSelection&&t.push("SelectAll"),t},n.prototype.onClicked=function(n){var i=this,r,u,f;!t.isNullOrUndefined(n.item)&&n.item.id&&(u=n.item.id.substr((this.parent.element.id+"_tb_").length),"refresh"===u||"newfolder"===u||"upload"===u?(r=[v(this.parent)],this.parent.itemData=r):(this.parent.notify(ni,{}),r=this.parent.itemData),f={cancel:!1,fileDetails:r,item:n.item},this.parent.trigger("toolbarClick",f,function(f){var h,c,o;if(!f.cancel)switch(u){case"sortby":(c=t.closest(n.originalEvent.target,"."+bc))&&c.classList.contains("e-toolbar-popup")&&(n.cancel=!0);break;case"newfolder":sh(i.parent);break;case"cut":tf(i.parent);break;case"copy":nf(i.parent);break;case"delete":for(o=0;o<r.length;o++)if(!y(r[o]))return void e(i.parent,r[o],g);s(i.parent,"Delete");break;case"details":i.parent.notify(d,{});h=i.parent.selectedItems;"navigationpane"===i.parent.activeModule&&(h=[]);hf(i.parent,h,i.parent.path,"details");break;case"paste":i.parent.folderPath="";ff(i.parent);break;case"refresh":sr(i.parent);break;case"download":na(i.parent);break;case"rename":y(r[0])?(i.parent.notify(gt,{}),s(i.parent,"Rename")):e(i.parent,r[0],g);break;case"upload":hh(i.parent);break;case"selectall":i.parent.notify(fr,{});break;case"selection":i.parent.notify(gr,{})}}))},n.prototype.toolbarCreateHandler=function(){var u;if(t.isNullOrUndefined(t.select("#"+this.getId("SortBy"),this.parent.element))||(u=[{id:this.getPupupId("name"),text:i(this.parent,"Name"),iconCss:ri},{id:this.getPupupId("size"),text:i(this.parent,"Size")},{id:this.getPupupId("date"),text:i(this.parent,"DateModified")},{separator:!0},{id:this.getPupupId("ascending"),text:i(this.parent,"Ascending"),iconCss:"Ascending"===this.parent.sortOrder?a:""},{id:this.getPupupId("descending"),text:i(this.parent,"Descending"),iconCss:"Descending"===this.parent.sortOrder?a:""},{id:this.getPupupId("none"),text:i(this.parent,"None"),iconCss:"None"===this.parent.sortOrder?a:""}],this.buttonObj=new bh.DropDownButton({items:u,cssClass:wt(this.parent,ft),select:yl.bind(this,this.parent),enableHtmlSanitizer:this.parent.enableHtmlSanitizer,enableRtl:this.parent.enableRtl,iconCss:hs}),this.buttonObj.isStringTemplate=!0,this.buttonObj.appendTo("#"+this.getId("SortBy"))),!t.isNullOrUndefined(t.select("#"+this.getId("View"),this.parent.element))){var f='<span class="'+tr+" "+gi+'"><\/span>',e='<span class="'+ir+" "+gi+'"><\/span>',o=[{id:this.getPupupId("large"),text:e+i(this.parent,"View-LargeIcons"),iconCss:"Details"===this.parent.view?"":a},{id:this.getPupupId("details"),text:f+i(this.parent,"View-Details"),iconCss:"Details"===this.parent.view?a:""}];this.layoutBtnObj=new bh.DropDownButton({iconCss:"Details"===this.parent.view?tr:ir,cssClass:wt(this.parent,"e-caret-hide "+ft),items:o,select:this.layoutChange.bind(this),enableRtl:this.parent.enableRtl,enableHtmlSanitizer:this.parent.enableHtmlSanitizer,content:'<span class="e-tbar-btn-text">'+i(this.parent,"View")+"<\/span>"});this.layoutBtnObj.isStringTemplate=!0;this.layoutBtnObj.appendTo("#"+this.getId("View"))}this.hideItems(this.default,!0);this.hideStatus();for(var n=t.selectAll(".e-btn",this.toolbarObj.element),s=function(t){n[t].onkeydown=function(n){13!==n.keyCode||n.target.classList.contains("e-fe-popup")||n.preventDefault()};n[t].onkeyup=function(i){13!==i.keyCode||i.target.classList.contains("e-fe-popup")||n[t].click()}},r=0;r<n.length;r++)s(r);this.parent.refreshLayout()},n.prototype.updateSortByButton=function(){if(this.buttonObj)for(var t=this.buttonObj.items,n=0;n<t.length;n++)t[n].id===this.getPupupId("name")?t[n].iconCss="name"===this.parent.sortBy?ri:"":t[n].id===this.getPupupId("size")?t[n].iconCss="size"===this.parent.sortBy?ri:"":t[n].id===this.getPupupId("date")?t[n].iconCss="_fm_modified"===this.parent.sortBy?ri:"":t[n].id===this.getPupupId("ascending")?t[n].iconCss="Ascending"===this.parent.sortOrder?a:"":t[n].id===this.getPupupId("descending")?t[n].iconCss="Descending"===this.parent.sortOrder?a:"":t[n].id===this.getPupupId("none")&&(t[n].iconCss="None"===this.parent.sortOrder?a:"")},n.prototype.getPupupId=function(n){return this.parent.element.id+"_ddl_"+n.toLowerCase()},n.prototype.layoutChange=function(n){"Details"===this.parent.view?n.item.id===this.getPupupId("large")&&yt(this.parent,"LargeIcons"):n.item.id===this.getPupupId("details")&&yt(this.parent,"Details")},n.prototype.toolbarItemData=function(n){var s=[],e="Both",o;for(this.parent.isMobile&&(e="Overflow"),o=0;o<n.length;o++){var t=void 0,r=this.getId(n[o]),u=i(this.parent,n[o]),f=i(this.parent,"Tooltip-"+n[o]),h='<span class="e-tbar-btn-text e-tbar-ddb-text">'+u+"<\/span>";switch(n[o]){case"|":t={type:"Separator"};break;case"Upload":t={id:r,text:u,tooltipText:f,prefixIcon:ts,showTextOn:e};break;case"SortBy":t={id:r,tooltipText:f,template:'<button id="'+r+'" class="e-tbar-btn e-tbtn-txt" tabindex="-1">'+h+"<\/button>"};break;case"Refresh":t={id:r,text:u,tooltipText:f,prefixIcon:cs,showTextOn:e};break;case"Selection":t={id:r,text:u,tooltipText:f,suffixIcon:rl,overflow:"Show",align:"Right"};break;case"View":t={id:r,tooltipText:f,prefixIcon:"Details"===this.parent.view?tr:ir,overflow:"Show",align:"Right",text:u,showTextOn:"Overflow",template:'<button id="'+r+'" class="e-tbar-btn e-tbtn-txt" tabindex="-1" aria-label='+i(this.parent,"View")+"><\/button>"};break;case"Details":t={id:r,tooltipText:f,prefixIcon:ss,overflow:"Show",align:"Right",text:u,showTextOn:"Overflow"};break;case"NewFolder":t={id:r,text:u,tooltipText:f,prefixIcon:os,showTextOn:e};break;case"Cut":t={id:r,text:u,tooltipText:f,prefixIcon:is,showTextOn:e};break;case"Copy":t={id:r,text:u,tooltipText:f,prefixIcon:rs,showTextOn:e};break;case"Paste":t={id:r,text:u,tooltipText:f,prefixIcon:us,showTextOn:e};break;case"Delete":t={id:r,text:u,tooltipText:f,prefixIcon:fs,showTextOn:e};break;case"Rename":t={id:r,text:u,tooltipText:f,prefixIcon:es,showTextOn:e};break;case"Download":t={id:r,text:u,tooltipText:f,prefixIcon:as,showTextOn:e};break;case"SelectAll":t={id:r,text:u,tooltipText:f,prefixIcon:ls,showTextOn:e};break;default:t={id:r,text:u,tooltipText:f}}s.push(t)}return s},n.prototype.getId=function(n){return this.parent.element.id+"_tb_"+n.toLowerCase()},n.prototype.addEventListener=function(){this.parent.on(f,this.onPropertyChanged,this);this.parent.on(c,this.onSelectionChanged,this);this.parent.on(ot,this.onLayoutChange,this);this.parent.on(ce,this.showPaste,this);this.parent.on(nu,this.hidePaste,this);this.parent.on(et,this.destroy,this);this.parent.on(li,this.updateSortByButton,this)},n.prototype.reRenderToolbar=function(n){var t=this,i;void 0!==n.newProp.toolbarSettings.items&&(this.items=this.toolbarItemData(this.getItems(n.newProp.toolbarSettings.items.map(function(n){return n.trim()}))),i={items:this.items},this.parent.trigger("toolbarCreate",i,function(n){t.buttonObj&&t.buttonObj.destroy();t.layoutBtnObj&&t.layoutBtnObj.destroy();t.items=n.items;t.toolbarObj.items=t.items;t.toolbarObj.dataBind();t.toolbarCreateHandler()}))},n.prototype.onSelectionChanged=function(){var n,r;this.hideStatus();this.hideItems(this.single,!0);this.hideItems(this.selection,!1);1===this.parent.selectedItems.length?(this.hideItems(this.single,!1),this.hideItems(this.selection,!0)):this.parent.selectedItems.length>1&&(this.hideItems(this.multiple,!1),this.hideItems(this.selection,!0));n=t.select("#"+this.getId("Selection"),this.toolbarObj.element);this.parent.selectedItems.length>0&&n&&(r=1===this.parent.selectedItems.length?this.parent.selectedItems.length+" "+i(this.parent,"Item-Selection"):this.parent.selectedItems.length+" "+i(this.parent,"Items-Selection"),t.select(".e-tbar-btn-text",n).textContent=r,this.toolbarObj.hideItem(n.parentElement,!1))},n.prototype.hideItems=function(n,i){for(var u,r=0;r<n.length;r++)u=t.select("#"+this.getId(n[r]),this.parent.element),u&&this.toolbarObj.hideItem(u.parentElement,i)},n.prototype.hideStatus=function(){var n=t.select("#"+this.getId("Selection"),this.toolbarObj.element);n&&this.toolbarObj.hideItem(n.parentElement,!0)},n.prototype.showPaste=function(){this.hideItems(["Paste"],!1)},n.prototype.hidePaste=function(){this.hideItems(["Paste"],!0)},n.prototype.onLayoutChange=function(){if(this.layoutBtnObj){this.layoutBtnObj.iconCss="Details"===this.parent.view?tr:ir;for(var t=this.layoutBtnObj.items,n=0;n<t.length;n++)t[n].id===this.getPupupId("large")?t[n].iconCss="LargeIcons"===this.parent.view?a:"":t[n].id===this.getPupupId("details")&&(t[n].iconCss="Details"===this.parent.view?a:"")}},n.prototype.removeEventListener=function(){this.parent.off(f,this.onPropertyChanged);this.parent.off(c,this.onSelectionChanged);this.parent.off(ot,this.onLayoutChange);this.parent.off(ce,this.showPaste);this.parent.off(nu,this.hidePaste);this.parent.off(et,this.destroy);this.parent.off(li,this.updateSortByButton)},n.prototype.getModuleName=function(){return"toolbar"},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"cssClass":this.buttonObj&&(this.buttonObj.cssClass=wt(this.parent,ft));this.layoutBtnObj&&(this.layoutBtnObj.cssClass=wt(this.parent,"e-caret-hide "+ft));break;case"height":case"width":this.toolbarObj.refreshOverflow();break;case"toolbarSettings":this.reRenderToolbar(n)}},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.buttonObj&&this.buttonObj.destroy(),this.layoutBtnObj&&this.layoutBtnObj.destroy(),this.toolbarObj.destroy(),this.parent.refreshLayout())},n.prototype.enableItems=function(n,i){for(var u,r=0;r<n.length;r++)u=t.select("#"+this.getId(n[r]),this.parent.element),u&&this.toolbarObj.enableItems(u.parentElement,i)},n}(),pp=function(){function n(n){this.removeNodes=[];this.moveNames=[];this.expandTree=!1;this.isDrag=!1;this.isPathDragged=!1;this.isRenameParent=!1;this.isRightClick=!1;this.renameParent=null;this.previousSelected=null;this.isNodeClickCalled=!1;this.restrictSelecting=!1;this.parent=n;this.addEventListener();this.keyConfigs={altEnter:"alt+enter",esc:"escape",del:"delete",ctrlX:"ctrl+x",ctrlC:"ctrl+c",ctrlV:"ctrl+v",ctrlShiftN:"ctrl+shift+n",shiftF10:"shift+F10",f2:"f2"}}return n.prototype.onInit=function(){var n,i,r;t.isNullOrUndefined(this.treeObj)&&(n=t.getValue(this.parent.pathId[0],this.parent.feParent),t.setValue("_fm_icon","e-fe-folder",n),i={},r=t.getValue("id",n),t.isNullOrUndefined(r)||t.setValue("data-id",r,i),y(n)||t.setValue("class",ro(n),i),t.isNullOrUndefined(i)||t.setValue("_fm_htmlAttr",i,n),this.treeObj=new dh.TreeView({fields:{dataSource:[n],id:"_fm_id",parentID:"_fm_pId",expanded:"_fm_expanded",selected:"_fm_selected",text:"name",hasChildren:"hasChild",iconCss:"_fm_icon",htmlAttributes:"_fm_htmlAttr",tooltip:"name"},enableHtmlSanitizer:this.parent.enableHtmlSanitizer,nodeSelecting:this.onNodeSelecting.bind(this),nodeSelected:this.onNodeSelected.bind(this),nodeExpanding:this.onNodeExpand.bind(this),nodeClicked:this.onNodeClicked.bind(this),allowEditing:!0,nodeEditing:this.onNodeEditing.bind(this),drawNode:this.onDrowNode.bind(this),enableRtl:this.parent.enableRtl,dataBound:this.addDragDrop.bind(this)}),this.treeObj.isStringTemplate=!0,this.treeObj.appendTo("#"+this.parent.element.id+hr),this.wireEvents())},n.prototype.addDragDrop=function(){var n=this;!this.parent.isMobile&&this.treeObj&&(this.parent.allowDragAndDrop?(this.dragObj&&this.dragObj.destroy(),this.dragObj=new t.Draggable(this.treeObj.element,{cursorAt:this.parent.dragCursorPosition,dragTarget:"."+ee,distance:5,dragArea:this.parent.element,drag:eh.bind(this,this.parent),dragStart:function(t){fh(n.parent,t,n.dragObj)},dragStop:uh.bind(this,this.parent),enableTailMode:!0,enableAutoScroll:!0,helper:this.dragHelper.bind(this)})):!this.parent.allowDragAndDrop&&this.dragObj&&this.dragObj.destroy())},n.prototype.dragHelper=function(n){var r=n.sender.target,i;return r.classList.contains(ee)?(i=t.closest(r,"li"),this.parent.dragPath="",this.parent.dragData=[],this.parent.activeElements=[],this.parent.activeElements=[i],this.parent.dragNodes=[],ge(this.parent,i),this.parent.dragData=this.getTreeData(i),this.parent.dragPath=this.getDragPath(i,this.parent.dragData[0].name),this.parent.dragNodes.push(this.parent.dragData[0].name),rh(this.parent),this.parent.virtualDragElement):null},n.prototype.getDragPath=function(n,t){return ru(this.getDropPath(n,t))},n.prototype.getDropPath=function(n,t){var i=n.getAttribute("data-id");return bs(n,this.parent.hasId?i:t,this.parent.hasId)},n.prototype.onDrowNode=function(n){var t={element:n.node,fileDetails:n.nodeData,module:"NavigationPane"};this.parent.trigger("fileLoad",t)},n.prototype.addChild=function(n,i,r){var o=vl(n),u,f,e,s;if(o.length>0){for(u=0,f=o;u<o.length;)f[u]._fm_icon="e-fe-folder",e={},s=t.getValue("id",f[u]),t.isNullOrUndefined(s)||t.setValue("data-id",s,e),y(f[u])||t.setValue("class",ro(f[u]),e),t.isNullOrUndefined(e)||t.setValue("_fm_htmlAttr",e,f[u]),u++;this.treeObj.addNodes(o,i,null,r)}},n.prototype.onNodeSelecting=function(n){if(!n.isInteracted&&!this.isRightClick&&!this.isPathDragged&&!this.isRenameParent||this.restrictSelecting)return this.restrictSelecting=!1,void(this.isNodeClickCalled=!1);if(!this.renameParent){this.parent.activeModule="navigationpane";var i={cancel:!1,fileDetails:this.getTreeData(t.getValue("id",n.nodeData))[0],module:"NavigationPane"};this.parent.trigger("fileOpen",i);n.cancel=i.cancel;n.cancel&&(this.restrictSelecting=!!this.isNodeClickCalled&&this.previousSelected[0]!=n.node.getAttribute("data-uid"),this.treeObj.selectedNodes=this.isNodeClickCalled?this.previousSelected:this.treeObj.selectedNodes,this.previousSelected=this.treeObj.selectedNodes,t.isNullOrUndefined(this.parent)||t.isNullOrUndefined(this.parent.contextmenuModule)||this.parent.contextmenuModule.contextMenu.enableItems(["Open"],!0))}},n.prototype.openFileOnContextMenuClick=function(n){var t=this.treeObj.getTreeData(n);this.parent.selectedItems=[];this.parent.itemData=t;this.activeNode=n;this.parent.activeModule="navigationpane";ws(n,this.parent.itemData[0],this.parent);o(this.parent,this.isPathDragged?it:p,this.parent.path);this.parent.visitedItem=n;this.isPathDragged=this.isRenameParent=this.isRightClick=!1;this.treeObj.selectedNodes=[n.getAttribute("data-uid")]},n.prototype.onNodeSelected=function(n){var i,r;(this.parent.breadcrumbbarModule&&this.parent.breadcrumbbarModule.searchObj&&!this.renameParent&&(this.parent.breadcrumbbarModule.searchObj.element.value="",this.parent.isFiltered=!1),this.parent.searchedItems=[],n.isInteracted||this.isRightClick||this.isPathDragged||this.isRenameParent)&&(this.activeNode=n.node,this.parent.activeModule="navigationpane",i=this.getTreeData(t.getValue("id",n.nodeData)),this.parent.selectedItems=[],this.parent.itemData=i,r=this.parent.path,ws(n.node,this.parent.itemData[0],this.parent),r!==this.parent.path&&(this.expandNodeTarget=null,n.node.querySelector("."+ue)&&null===n.node.querySelector("."+nt)&&(this.expandNodeTarget="add"),o(this.parent,this.isPathDragged?it:p,this.parent.path),this.parent.visitedItem=n.node),this.isPathDragged=this.isRenameParent=this.isRightClick=!1)},n.prototype.onPathDrag=function(n){this.isPathDragged=!0;this.selectResultNode(n[0])},n.prototype.onNodeExpand=function(n){if((n.isInteracted||this.isDrag)&&null===n.node.querySelector("."+nt)){var r=t.getValue("text",n.nodeData),i=n.node.getAttribute("data-id"),u=!t.isNullOrUndefined(i),f=t.isNullOrUndefined(i)?r:i,e=bs(n.node,f,u);this.expandNodeTarget=n.node.getAttribute("data-uid");this.parent.expandedId=this.expandNodeTarget;this.parent.itemData=this.getTreeData(t.getValue("id",n.nodeData));o(this.parent,he,e)}},n.prototype.onNodeExpanded=function(n){this.addChild(n.files,this.expandNodeTarget,!1);this.parent.expandedId=null},n.prototype.onNodeClicked=function(n){if(this.parent.activeModule="navigationpane",this.previousSelected=this.treeObj.selectedNodes,this.activeNode=n.node,3===n.event.which&&n.node.getAttribute("data-uid")!==this.treeObj.selectedNodes[0])this.isRightClick=!0,this.isNodeClickCalled=!0,this.treeObj.selectedNodes=[n.node.getAttribute("data-uid")];else if(n.node.getAttribute("data-uid")===this.treeObj.selectedNodes[0]&&0!==this.parent.selectedItems.length){this.parent.setProperties({selectedItems:[]},!0);var t="LargeIcons"===this.parent.view?"largeiconsview":"detailsview";this.parent.notify(f,{module:t,newProp:{selectedItems:[]}})}},n.prototype.onNodeEditing=function(n){t.isNullOrUndefined(n.innerHtml)||(n.cancel=!0)},n.prototype.onPathChanged=function(n){var i,r,u;this.parent.isCut=!1;i=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feFiles);"add"===this.expandNodeTarget&&(r=t.select('[data-uid="'+this.treeObj.selectedNodes[0]+'"]',this.treeObj.element),u=t.select("."+bi,r),t.isNullOrUndefined(u)&&this.addChild(n.files,this.treeObj.selectedNodes[0],!this.expandTree),this.expandNodeTarget="");this.expandTree=!1;t.isNullOrUndefined(i)&&t.setValue(this.parent.pathId[this.parent.pathId.length-1],n.files,this.parent.feFiles)},n.prototype.updateTree=function(n){if(this.treeObj){var t=this.treeObj.selectedNodes[0];this.updateTreeNode(n,t)}},n.prototype.updateTreeNode=function(n,t){var i=-1!==this.treeObj.expandedNodes.indexOf(t);this.removeChildNodes(t);this.addChild(n.files,t,!i)},n.prototype.removeChildNodes=function(n){var u=t.select('[data-uid="'+n+'"]',this.treeObj.element),i=t.select("."+bi,u),r=i?Array.prototype.slice.call(i.children):null;r&&this.treeObj.removeNodes(r)},n.prototype.onOpenEnd=function(n){var t=this.parent.pathId[this.parent.pathId.length-1];this.treeObj.expandAll(this.treeObj.selectedNodes);this.treeObj.selectedNodes=[t];this.expandNodeTarget="add";this.onPathChanged(n)},n.prototype.onOpenInit=function(n){"navigationpane"===this.parent.activeModule&&n.target.querySelector("."+ue)&&this.treeObj.expandAll(this.treeObj.selectedNodes)},n.prototype.onInitialEnd=function(n){this.onInit();this.addChild(n.files,t.getValue("_fm_id",n.cwd),!1)},n.prototype.onFinalizeEnd=function(n){this.onInit();var i=t.getValue("_fm_id",n.cwd);this.removeChildNodes(i);this.addChild(n.files,i,!1);this.treeObj.selectedNodes=[this.parent.pathId[this.parent.pathId.length-1]]},n.prototype.onCreateEnd=function(n){this.updateTree(n)},n.prototype.onSelectedData=function(){"navigationpane"===this.parent.activeModule&&this.updateItemData()},n.prototype.onDeleteInit=function(){if("navigationpane"===this.parent.activeModule){this.updateActionData();var n=t.getValue("name",this.parent.itemData[0]);fo(this.parent,[n],this.parent.path,"delete")}},n.prototype.onDeleteEnd=function(n){if("navigationpane"===this.parent.activeModule){var i=this.treeObj.selectedNodes[0],r=t.select('[data-uid="'+i+'"]',this.treeObj.element),u=t.closest(r,"."+bi).parentElement;this.treeObj.selectedNodes=[u.getAttribute("data-uid")];this.treeObj.dataBind()}this.updateTree(n)},n.prototype.onRefreshEnd=function(n){this.updateTree(n)},n.prototype.onRenameInit=function(){"navigationpane"===this.parent.activeModule&&this.updateRenameData()},n.prototype.onRenameEndParent=function(n){var f=this.renameParent?this.renameParent:this.parent.pathId[this.parent.pathId.length-1],i,r,e;(this.expandTree=-1!==this.treeObj.expandedNodes.indexOf(this.treeObj.selectedNodes[0]),this.updateTreeNode(n,f),this.parent.expandedId=null,this.renameParent)?this.renameParent=null:(i=[],this.parent.hasId?i=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(r=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",this.parent.renameText,!1)),r.length>0&&(i=new u.DataManager(r).executeLocal((new u.Query).where("_fm_pId","equal",f,!1)))),i.length>0&&(this.isRenameParent=!0,e=t.getValue(this.treeObj.fields.id,i[0]),this.treeObj.selectedNodes=[e],this.treeObj.dataBind()))},n.prototype.onRenameEnd=function(n){var r,i,f;""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?(r=this.treeObj.getTreeData(),i=[],this.parent.hasId?i=new u.DataManager(r).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(f=new u.DataManager(r).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",this.parent.currentItemText,!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1)))),i.length>0&&(this.renameParent=t.getValue(this.treeObj.fields.parentID,i[0]),this.parent.expandedId=this.renameParent,this.parent.itemData=this.getTreeData(this.renameParent),o(this.parent,du,this.parent.filterPath.replace(/\\/g,"/")))):this.updateTree(n)},n.prototype.onPropertyChanged=function(n){if(n.module===this.getModuleName()||"common"===n.module)for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"allowDragAndDrop":this.addDragDrop();break;case"navigationPaneSettings":o(this.parent,k,"/")}},n.prototype.onDownLoadInit=function(){this.doDownload()},n.prototype.onSelectionChanged=function(n){this.treeObj.selectedNodes=[n.selectedNode]},n.prototype.onClearPathInit=function(n){this.removeChildNodes(n.selectedNode)},n.prototype.onDragEnd=function(n){var t;t=this.parent.isPasteError||this.parent.isSearchDrag?this.getMoveNames(n.files,this.parent.isSearchDrag,this.parent.dragPath):this.moveNames;this.treeObj.removeNodes(t)},n.prototype.getMoveNames=function(n,i,r){for(var h,c,o,e,l,s=[],f=0;f<n.length;f++)if(!n[f].isFile&&!this.parent.hasId)for(h=n[f].previousName,i&&(c=(r+=n[f].previousName).lastIndexOf("/"),h=r.substring(c+1),r=r.substring(0,c+1)),o=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",h,!1)),e=0;e<o.length;e++)if(l=t.getValue("filterPath",o[e]),(l=l.replace(/\\/g,"/"))===r){s.push(t.getValue(this.treeObj.fields.id,o[e]));break}return s},n.prototype.onCutEnd=function(n){var t=[];this.parent.isPasteError||this.parent.isSearchCut?this.moveNames=this.getMoveNames(n.files,this.parent.isSearchCut,this.parent.targetPath):t=this.moveNames;this.treeObj.removeNodes(t)},n.prototype.selectResultNode=function(n){var i,f;if(this.parent.hasId)this.treeObj.selectedNodes=[t.getValue("_fm_id",n)],this.treeObj.dataBind();else{var e=t.getValue("filterPath",n),o=t.getValue("name",n),r=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",o,!1));r.length>0&&(i=new u.DataManager(r).executeLocal((new u.Query).where("filterPath","equal",e,!1)),i.length>0&&(f=t.getValue(this.treeObj.fields.id,i[0]),this.treeObj.selectedNodes=[f],this.treeObj.dataBind()))}},n.prototype.onDropPath=function(n){this.onpasteEnd(n);this.selectResultNode(this.parent.dropData);this.parent.isDropEnd=!this.parent.isPasteError},n.prototype.onpasteEnd=function(n){var i=[],f,r,e;this.parent.hasId?i=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where("id","equal",t.getValue("id",n.cwd),!1)):(f=new u.DataManager(this.treeObj.getTreeData()).executeLocal((new u.Query).where(this.treeObj.fields.text,"equal",t.getValue("name",n.cwd),!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",t.getValue("filterPath",n.cwd),!1))));i.length>0&&(r=t.getValue(this.treeObj.fields.id,i[0]),e=-1===this.treeObj.expandedNodes.indexOf(r),this.removeChildNodes(r),this.addChild(n.files,r,e));this.parent.expandedId=null;this.onPathChanged(n);this.parent.isDragDrop&&this.checkDropPath(n)},n.prototype.checkDropPath=function(n){if(this.parent.hasId)return this.parent.isDropEnd=!this.parent.isPasteError,void ih(this.parent);-1===this.parent.dropPath.indexOf(nh(this.parent,n))?(this.parent.isDropEnd=!1,ih(this.parent)):this.parent.isDropEnd=!this.parent.isPasteError},n.prototype.onpasteInit=function(){this.parent.activeModule===this.getModuleName()&&this.updateItemData();this.moveNames=[];for(var i=this.parent.isDragDrop?this.parent.dragData:this.parent.actionRecords,n=0;n<i.length;n++)!1===t.getValue("isFile",i[n])&&this.moveNames.push(t.getValue("_fm_id",i[n]))},n.prototype.oncutCopyInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.activeRecords=this.getTreeData(this.treeObj.selectedNodes[0]),this.parent.activeElements=[this.activeNode])},n.prototype.addEventListener=function(){this.parent.on(f,this.onPropertyChanged,this);this.parent.on(ye,this.onDownLoadInit,this);this.parent.on(kt,this.onInitialEnd,this);this.parent.on(k,this.onFinalizeEnd,this);this.parent.on(p,this.onPathChanged,this);this.parent.on(it,this.onpasteEnd,this);this.parent.on(le,this.onCutEnd,this);this.parent.on(ti,this.onpasteInit,this);this.parent.on(he,this.onNodeExpanded,this);this.parent.on(st,this.onCreateEnd,this);this.parent.on(ni,this.onSelectedData,this);this.parent.on(fi,this.onDeleteInit,this);this.parent.on(ht,this.onDeleteEnd,this);this.parent.on(ct,this.onRefreshEnd,this);this.parent.on(gu,this.onSelectionChanged,this);this.parent.on(ci,this.onOpenInit,this);this.parent.on(lt,this.onOpenEnd,this);this.parent.on(et,this.destroy,this);this.parent.on(gt,this.onRenameInit,this);this.parent.on(tt,this.onRenameEnd,this);this.parent.on(du,this.onRenameEndParent,this);this.parent.on(ku,this.onClearPathInit,this);this.parent.on(vi,this.oncutCopyInit,this);this.parent.on(at,this.onDropInit,this);this.parent.on(ai,this.onMenuItemData,this);this.parent.on(pe,this.onDragEnd,this);this.parent.on(we,this.onDragging,this);this.parent.on(vt,this.onDropPath,this);this.parent.on(d,this.onDetailsInit,this);this.parent.on(oe,this.onPathDrag,this)},n.prototype.removeEventListener=function(){this.parent.off(kt,this.onInitialEnd);this.parent.off(ye,this.onDownLoadInit);this.parent.off(k,this.onFinalizeEnd);this.parent.off(ni,this.onSelectedData);this.parent.off(f,this.onPropertyChanged);this.parent.off(p,this.onPathChanged);this.parent.off(it,this.onpasteEnd);this.parent.off(le,this.onCutEnd);this.parent.off(ti,this.onpasteInit);this.parent.off(gu,this.onSelectionChanged);this.parent.off(he,this.onNodeExpanded);this.parent.off(st,this.onCreateEnd);this.parent.off(ct,this.onRefreshEnd);this.parent.off(ci,this.onOpenInit);this.parent.off(lt,this.onOpenEnd);this.parent.off(et,this.destroy);this.parent.off(gt,this.onRenameInit);this.parent.off(tt,this.onRenameEnd);this.parent.off(du,this.onRenameEndParent);this.parent.off(ku,this.onClearPathInit);this.parent.off(fi,this.onDeleteInit);this.parent.off(ht,this.onDeleteEnd);this.parent.off(vi,this.oncutCopyInit);this.parent.off(at,this.onDropInit);this.parent.off(pe,this.onDragEnd);this.parent.off(we,this.onDragging);this.parent.off(vt,this.onDropPath);this.parent.off(d,this.onDetailsInit);this.parent.off(ai,this.onMenuItemData);this.parent.off(oe,this.onPathDrag)},n.prototype.onDetailsInit=function(){if(this.parent.activeModule===this.getModuleName()){var n=this.getTreeData(this.treeObj.selectedNodes[0]);this.parent.itemData=n}},n.prototype.onMenuItemData=function(n){if(this.parent.activeModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.itemData=this.getTreeData(i.getAttribute("data-uid"))}},n.prototype.onDragging=function(n){var i=t.closest(n.target,"li"),r;i.classList.contains("e-node-collapsed")&&(this.isDrag=!0,r=parseInt(i.getAttribute("aria-level"),10),this.treeObj.expandAll([i.getAttribute("data-uid")],r+1),this.isDrag=!1)},n.prototype.onDropInit=function(n){if(this.parent.targetModule===this.getModuleName()){var i=t.closest(n.target,"li");this.parent.dropData=this.getTreeData(i)[0];this.parent.dropPath=this.getDropPath(i,t.getValue("name",this.parent.dropData))}},n.prototype.getModuleName=function(){return"navigationpane"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.treeObj&&(this.unWireEvents(),this.treeObj.destroy()))},n.prototype.wireEvents=function(){this.keyboardModule=new t.KeyboardEvents(this.treeObj.element,{keyAction:this.keyDown.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"})},n.prototype.unWireEvents=function(){this.keyboardModule.destroy()},n.prototype.keyDown=function(n){switch(n.action){case"altEnter":this.parent.notify(d,{});hf(this.parent,[],this.parent.path,"details");break;case"esc":ds(this.parent);break;case"del":this.updateItemData();y(this.parent.itemData[0])?(this.removeNodes=[],s(this.parent,"Delete")):e(this.parent,this.parent.itemData[0],g);break;case"ctrlC":nf(this.parent);break;case"ctrlV":this.parent.folderPath="";ff(this.parent);break;case"ctrlX":tf(this.parent);break;case"shiftF10":if(this.updateItemData(),!of(this.parent.itemData[0]))return void e(this.parent,this.parent.itemData[0],iu);0!==this.parent.selectedItems.length&&this.doDownload();break;case"f2":if(0===this.parent.selectedItems.length){var t=this.getTreeData(this.treeObj.selectedNodes[0])[0];y(t)?(this.updateRenameData(),s(this.parent,"Rename")):e(this.parent,t,g)}}},n.prototype.getTreeData=function(n){for(var i=this.treeObj.getTreeData(n),r=0;r<i.length;r++)t.isNullOrUndefined(t.getValue("hasChild",i[r]))&&t.setValue("hasChild",!1,i[r]);return i},n.prototype.updateRenameData=function(){this.updateItemData();this.parent.currentItemText=t.getValue("name",this.parent.itemData[0])},n.prototype.updateItemData=function(){var n=this.getTreeData(this.treeObj.selectedNodes[0])[0];this.parent.itemData=[n];this.parent.isFile=!1},n.prototype.updateActionData=function(){this.updateItemData();var n=ru(this.parent.path);this.parent.setProperties({path:n},!0);this.parent.pathId.pop();this.parent.pathNames.pop()},n.prototype.doDownload=function(){var n=ru(this.parent.path),i=this.treeObj.selectedNodes[0]===this.parent.pathId[0]?"":t.getValue("name",this.parent.itemData[0]);cf(this.parent,n,[i])},n}();const eu=ejdashboard.grids;da=function(){function n(n){this.isInteracted=!0;this.interaction=!0;this.isPasteOperation=!1;this.isColumnRefresh=!1;this.dragObj=null;this.startIndex=null;this.firstItemIndex=null;this.isSelectionUpdate=!1;this.currentSelectedItem=[];this.count=0;this.isRendered=!0;this.isLoaded=!1;this.isNameWidth=!1;this.pasteOperation=!1;this.uploadOperation=!1;eu.Grid.Inject(eu.Resize,eu.ContextMenu,eu.Sort,eu.VirtualScroll);this.parent=n;this.element=t.select("#"+this.parent.element.id+cr,this.parent.element);this.addEventListener();this.keyConfigs={altEnter:"alt+enter",esc:"escape",tab:"tab",moveDown:"downarrow",ctrlEnd:"ctrl+end",ctrlHome:"ctrl+home",ctrlDown:"ctrl+downarrow",ctrlLeft:"ctrl+leftarrow",ctrlRight:"ctrl+rightarrow",shiftEnd:"shift+end",shiftHome:"shift+home",shiftDown:"shift+downarrow",shiftUp:"shift+uparrow",ctrlUp:"ctrl+uparrow",csEnd:"ctrl+shift+end",csHome:"ctrl+shift+home",csDown:"ctrl+shift+downarrow",csUp:"ctrl+shift+uparrow",space:"space",ctrlSpace:"ctrl+space",shiftSpace:"shift+space",csSpace:"ctrl+shift+space",end:"end",home:"home",moveUp:"uparrow",del:"delete",ctrlX:"ctrl+x",ctrlC:"ctrl+c",ctrlV:"ctrl+v",ctrlShiftN:"ctrl+shift+n",shiftdel:"shift+delete",ctrlD:"ctrl+d",f2:"f2",ctrlA:"ctrl+a",enter:"enter"}}return n.prototype.render=function(n){var r,u,i;(w.showSpinner(this.parent.element),"Details"===this.parent.view)&&(t.removeClass([this.parent.element],wi),r=pt(this.parent,n.files),this.checkNameWidth(),u=this.getColumns(),i=void 0,this.parent.isMobile?i=[]:"None"!==this.parent.sortOrder&&(i=[{direction:this.parent.sortOrder,field:this.parent.sortBy}]),this.gridObj=new eu.Grid({dataSource:r,allowSorting:!0,rowSelecting:this.onSelection.bind(this,"select"),rowDeselecting:this.onSelection.bind(this,"unselect"),rowSelected:this.onSelected.bind(this),rowDeselected:this.onDeSelection.bind(this),allowResizing:this.parent.detailsViewSettings.columnResizing,selectionSettings:{type:this.parent.allowMultiSelection?"Multiple":"Single",checkboxMode:"ResetOnRowClick"},enableRtl:this.parent.enableRtl,pageSettings:{pageSize:20},sortSettings:{allowUnsort:!1,columns:i},columns:u,recordDoubleClick:this.DblClickEvents.bind(this),beforeDataBound:this.onBeforeDataBound.bind(this),dataBound:this.onDataBound.bind(this),rowDataBound:this.onRowDataBound.bind(this),actionBegin:this.onActionBegin.bind(this),headerCellInfo:this.onHeaderCellInfo.bind(this),width:"100%",beforeCopy:function(n){n.cancel=!0},load:function(){this.focusModule.destroy()},locale:this.parent.locale}),this.gridObj.isStringTemplate=!0,this.gridObj.appendTo("#"+this.parent.element.id+cr),this.wireEvents(),this.adjustHeight(),this.emptyArgs=n)},n.prototype.checkNameWidth=function(){var i=this.parent.detailsViewSettings.columns,n;for(this.isNameWidth=!1,n=0;n<i.length;n++)if("name"===i[n].field)return void(this.isNameWidth=!t.isNullOrUndefined(i[n].width))},n.prototype.adjustWidth=function(n,t){var i,r;if(!this.isNameWidth||"name"!==t)for(i=0;i<n.length;i++)n[i].field===t&&(r=""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?this.element.clientWidth<=680?"name"===t?"120px":"180px":"auto":this.element.clientWidth<=500?"120px":"auto",n[i].width=r)},n.prototype.getColumns=function(){var n,t,r,u,o,f,e;if(this.parent.isMobile)n=[{field:"name",headerText:i(this.parent,"Name"),width:"auto",minWidth:120,headerTextAlign:"Left",template:'<div class="e-fe-text">${name}<\/div><div class="e-fe-date">${_fm_modified}<\/div><span class="e-fe-size">${size}<\/span>'}];else for(n=JSON.parse(JSON.stringify(this.parent.detailsViewSettings.columns)),this.adjustWidth(n,"name"),t=0,r=n.length;t<r;t++)n[t].headerText=i(this.parent,n[t].headerText);for(u=this.parent.isMobile||this.parent.isBigger?"54":"46",o={field:"type",width:u,minWidth:u,template:'<span class="e-fe-icon ${_fm_iconClass}"><\/span>',allowResizing:!1,allowSorting:!0,customAttributes:{"class":"e-fe-grid-icon"},headerTemplate:'<span class="e-fe-icon e-fe-folder"><\/span>'},(n.unshift(o),this.parent.allowMultiSelection)&&(f=this.parent.isBigger?"36":"26",e={type:"checkbox",width:f,minWidth:f,customAttributes:{"class":"e-fe-checkbox"},allowResizing:!1,allowSorting:!1},this.parent.isMobile?n.push(e):n.unshift(e)),t=0,r=n.length;t<r;t++)n[t].disableHtmlEncode=!this.parent.enableHtmlSanitizer;return n},n.prototype.adjustHeight=function(){if(this.gridObj){var n=t.select("#"+this.parent.element.id+ar,this.parent.element),i=t.select("#"+this.parent.element.id+vr,this.parent.element),r=t.select("."+ko,this.parent.element),u=n.offsetHeight-i.offsetHeight-r.offsetHeight;this.gridObj.height=u;this.gridObj.dataBind()}},n.prototype.renderCheckBox=function(){this.gridObj.columns=this.getColumns();this.isColumnRefresh=!0;this.gridObj.refreshColumns()},n.prototype.onRowDataBound=function(n){var f=t.select(".e-fe-grid-name",n.row),u,r,o,s,c,l,e,a,w,h,b;if(!f)for(u=this.parent.detailsViewSettings.columns,r=0;r<u.length;r++)if("name"===u[r].field){f=n.row.children[this.parent.allowMultiSelection?r+2:r+1];break}if((f&&f.setAttribute("title",t.getValue("name",n.data)),this.parent.isLayoutChange&&this.parent.isCut&&"move"===this.parent.fileAction&&this.parent.selectedNodes&&0!==this.parent.selectedNodes.length&&-1!==this.parent.selectedNodes.indexOf(t.getValue("name",n.data))&&de(n.row),!this.parent.showFileExtension&&t.getValue("isFile",n.data))&&(o=n.row.querySelector(".e-fe-text"),o&&(s=t.getValue("name",n.data),c=t.getValue("type",n.data),o.innerHTML=s.substr(0,s.length-c.length))),void 0!==t.getValue("size",n.data)&&n.row.querySelector(".e-fe-size")&&(l=n.row.querySelector(".e-fe-size"),e=void 0,t.getValue("isFile",n.data)?(a=t.getValue("size",n.data),e=(v=new t.Internationalization(this.parent.locale)).formatNumber(a/1024,{format:"n"})+" "+i(this.parent,"KB")):e="",l.innerHTML=e),this.parent.isMobile&&void 0!==t.getValue("_fm_modified",n.data)&&n.row.querySelector(".e-fe-date")){var k=n.row.querySelector(".e-fe-date"),v=new t.Internationalization(this.parent.locale),p=void(u=this.parent.detailsViewSettings.columns);for(r=0;r<u.length;r++)if("dateModified"===u[r].field){p=u[r].format;break}w=v.formatDate(new Date(t.getValue("_fm_modified",n.data)),p);k.innerHTML=w}h=n.row.querySelector("."+yu);h&&h.classList.add("e-small");y(n.data)||(n.row.className+=" "+ro(n.data));b={element:n.row,fileDetails:n.data,module:"DetailsView"};this.parent.trigger("fileLoad",b)},n.prototype.onActionBegin=function(n){var r,i,u;if("sorting"===n.requestType){if(this.parent.setProperties({sortOrder:n.direction},!0),this.parent.setProperties({sortBy:n.columnName},!0),0!==this.parent.selectedItems.length)for(this.sortItem=!0,r=this.gridObj.getSelectedRowIndexes(),i=r.length,this.sortSelectedNodes=[];i>0;)u=this.gridObj.getRowsObject()[r[i-1]].data,this.sortSelectedNodes.push(t.getValue(this.parent.hasId?"id":"name",u)),i--;this.parent.notify(li,{})}},n.prototype.onHeaderCellInfo=function(n){var t=n.node.querySelector("."+yu);t&&t.classList.add("e-small")},n.prototype.onBeforeDataBound=function(n){w.showSpinner(this.parent.element);var t=pt(this.parent,this.gridObj.dataSource);n.result=t},n.prototype.onDataBound=function(){if(this.createDragObj(),0!==this.parent.selectedItems.length&&this.selectRecords(this.parent.selectedItems),!0===this.isPasteOperation&&(this.isColumnRefresh?this.isColumnRefresh=!1:(this.selectRecords(this.parent.pasteNodes),this.isPasteOperation=!1)),this.parent.createdItem&&(this.selectRecords([t.getValue(this.parent.hasId?"id":"name",this.parent.createdItem)]),this.parent.createdItem=null),this.parent.layoutSelectedItems.length&&this.selectRecords(this.parent.layoutSelectedItems),this.parent.renamedItem&&(this.addSelection(this.parent.renamedItem),this.parent.renamedItem=null),!0===this.sortItem&&(this.selectRecords(this.sortSelectedNodes),this.sortItem=!1),this.isSelectionUpdate&&(this.isColumnRefresh?this.isColumnRefresh=!1:(this.selectRecords(this.currentSelectedItem),this.isSelectionUpdate=!1)),!0===this.uploadOperation&&(this.count++,this.selectRecords(this.parent.uploadItem),this.count===this.parent.uploadItem.length&&(this.uploadOperation=!1,this.parent.uploadItem=[])),this.gridObj.currentViewData.length*this.gridObj.getRowHeight()<this.gridObj.height)(n=this.gridObj.getHeaderContent()).style.paddingRight="",n.style.paddingLeft="",t.select(".e-headercontent",n).style.borderRightWidth="0",(i=this.gridObj.getContent().querySelector(".e-content")).style.overflowY="",i.classList.add("e-scrollShow");else{var i,n=this.gridObj.getHeaderContent();this.parent.enableRtl?n.style.paddingLeft="16px":n.style.paddingRight="16px";(i=this.gridObj.getContent().querySelector(".e-content")).classList.remove("e-scrollShow")}this.isRendered=!0;this.parent.isLayoutChange=!1;w.hideSpinner(this.parent.element);this.checkEmptyDiv(this.emptyArgs);this.isInteracted=!!this.isLoaded||this.isInteracted;this.isLoaded=!1},n.prototype.selectRecords=function(n){for(var f,r=this.gridObj.getCurrentViewRecords(),u=[],i=0,e=r.length;i<e;i++)f=this.parent.hasId?t.getValue("id",r[i]):ll(this.parent,r[i]),-1!==n.indexOf(f)&&u.push(i);0!==u.length&&(this.gridObj.selectRows(u),this.addFocus(this.gridObj.selectedRowIndex))},n.prototype.addSelection=function(n){var r=this.gridObj.getCurrentViewRecords(),i=[],f,e;this.parent.hasId?i=new u.DataManager(r).executeLocal((new u.Query).where("id","equal",this.parent.renamedId,!1)):(f=new u.DataManager(r).executeLocal((new u.Query).where("name","equal",t.getValue("name",n),!1)),f.length>0&&(i=new u.DataManager(f).executeLocal((new u.Query).where("filterPath","equal",this.parent.filterPath,!1))));i.length>0&&(e=r.indexOf(i[0]),this.gridObj.selectRows([e]))},n.prototype.onSortColumn=function(){"None"!==this.parent.sortOrder?this.gridObj.sortModule.sortColumn(this.parent.sortBy,this.parent.sortOrder):this.gridObj.dataSource=pt(this.parent,this.gridObj.dataSource)},n.prototype.onPropertyChanged=function(n){var i,r,u,f;if(n.module===this.getModuleName()||"common"===n.module)for(i=0,r=Object.keys(n.newProp);i<r.length;i++)switch(r[i]){case"allowDragAndDrop":this.createDragObj();break;case"height":this.adjustHeight();break;case"detailsViewSettings":t.isNullOrUndefined(this.gridObj)||(this.checkNameWidth(),u=this.getColumns(),this.gridObj.columns=u,this.gridObj.allowResizing=this.parent.detailsViewSettings.columnResizing,this.gridObj.dataBind(),this.gridObj.refreshColumns());break;case"selectedItems":(this.interaction=!1,0!==this.parent.selectedItems.length)?(this.parent.allowMultiSelection||(f=this.parent.selectedItems.slice(this.parent.selectedItems.length-1),this.parent.setProperties({selectedItems:f},!0)),this.selectRecords(this.parent.selectedItems),this.parent.setProperties({selectedItems:this.parent.selectedItems},!0)):t.isNullOrUndefined(this.gridObj)||this.gridObj.clearSelection();break;case"showFileExtension":case"showHiddenItems":o(this.parent,p,this.parent.path);break;case"allowMultiSelection":t.isNullOrUndefined(this.gridObj)||(this.currentSelectedItem=this.parent.selectedItems,this.gridObj.selectionSettings.type=n.newProp.allowMultiSelection?"Multiple":"Single",this.isSelectionUpdate=!0,this.renderCheckBox());break;case"view":yt(this.parent,"Details");break;case"width":this.onDetailsResize()}},n.prototype.onPathChanged=function(n){this.parent.isCut=!1;""===this.parent.breadcrumbbarModule.searchObj.element.value.trim()&&this.gridObj&&(this.parent.searchedItems=[],this.parent.isFiltered?this.updatePathColumn():this.removePathColumn(!1));ut(this.parent);"Details"===this.parent.view&&(this.isInteracted=!1,w.showSpinner(this.parent.element),this.parent.setProperties({selectedItems:[]},!0),this.gridObj.dataSource=pt(this.parent,n.files));this.emptyArgs=n},n.prototype.updatePathColumn=function(){var n=this.gridObj.columns.length,t=JSON.parse(JSON.stringify(this.gridObj.columns)),r;t[n-1].field&&"filterPath"!==t[n-1].field&&!this.parent.isMobile&&(r={field:"filterPath",headerText:i(this.parent,"Path"),minWidth:180,width:"auto"},this.gridObj.columns.push(r),this.adjustWidth(this.gridObj.columns,"filterPath"),this.adjustWidth(this.gridObj.columns,"name"),this.isColumnRefresh=!0,this.gridObj.refreshColumns())},n.prototype.checkEmptyDiv=function(n){var i=pt(this.parent,n.files),r;0!==i.length||t.isNullOrUndefined(this.element.querySelector("."+nr))?0!==i.length&&this.element.querySelector("."+b)&&(this.element.querySelector("."+nr).querySelector("."+b)?(r=this.element.querySelector("."+nr).querySelector("."+b),this.element.querySelector("."+nr).removeChild(r)):this.element.removeChild(this.element.querySelector("."+b))):al(this.parent,this.element,n)},n.prototype.onOpenInit=function(){if("detailsview"===this.parent.activeModule){var n=this.gridObj.getSelectedRecords()[0];this.openContent(n)}},n.prototype.DblClickEvents=function(n){var t;this.gridObj.selectRows([n.rowIndex]);n.rowData&&(t=JSON.parse(JSON.stringify(n.rowData)),this.openContent(t))},n.prototype.openContent=function(n){var i=this,r;ef(n)?(r={cancel:!1,fileDetails:n,module:"DetailsView"},this.parent.trigger("fileOpen",r,function(r){var u,e,f,o;r.cancel||(u=t.getValue("name",n),t.getValue("isFile",n)?rf(n)===wu&&(e=gs(i.parent,n),yh(i.parent,u,e)):(""!==i.parent.breadcrumbbarModule.searchObj.element.value||i.parent.isFiltered?wl(i.parent,n):(f=t.getValue("id",n),o=i.parent.path+(t.isNullOrUndefined(f)?u:f)+"/",i.parent.setProperties({path:o},!0),i.parent.pathNames.push(u),i.parent.pathId.push(t.getValue("_fm_id",n)),i.parent.itemData=[n],cl(i.parent)),i.parent.isFiltered=!1),i.element.focus())})):e(this.parent,n,be)},n.prototype.onLayoutChange=function(n){"Details"===this.parent.view&&(this.gridObj?this.isLoaded=!0:this.render(n),this.parent.isFiltered&&(this.updatePathColumn(),this.parent.setProperties({selectedItems:[]},!0)),this.gridObj.dataSource=pt(this.parent,n.files),this.parent.notify(er,{}),this.gridObj.element.classList.remove(ui),this.isInteracted=!1,this.gridObj.clearSelection(),""!==this.parent.breadcrumbbarModule.searchObj.element.value.trim()&&this.onSearchFiles(n),this.adjustHeight(),this.gridObj.sortSettings.columns.length>0&&this.gridObj.sortSettings.columns[0].field!==this.parent.sortBy&&"None"!==this.parent.sortOrder&&this.gridObj.sortColumn(this.parent.sortBy,this.parent.sortOrder))},n.prototype.onSearchFiles=function(n){"Details"===this.parent.view&&(this.parent.setProperties({selectedItems:[]},!0),this.parent.notify(c,{}),this.parent.isLayoutChange||(this.parent.layoutSelectedItems=[]),this.updatePathColumn(),this.parent.searchedItems=n.files,this.onPathChanged(n))},n.prototype.removePathColumn=function(n){var t=this.gridObj.columns.length,i=JSON.parse(JSON.stringify(this.gridObj.columns));i[t-1].field&&"filterPath"===i[t-1].field&&("filterPath"===this.gridObj.sortSettings.columns[0].field&&("None"!==this.parent.sortOrder?this.gridObj.sortColumn("name",this.parent.sortOrder):this.gridObj.dataSource=pt(this.parent,this.gridObj.dataSource),this.parent.notify(li,{})),this.gridObj.columns.pop(),n||(this.isColumnRefresh=!0,this.gridObj.refreshColumns()))},n.prototype.onFinalizeEnd=function(n){"Details"===this.parent.view&&(this.gridObj?this.onPathChanged(n):this.render(n))},n.prototype.onCreateEnd=function(n){"Details"===this.parent.view&&this.onPathChanged(n)},n.prototype.onRenameInit=function(){"detailsview"===this.parent.activeModule&&1===this.parent.selectedItems.length&&this.updateRenameData()},n.prototype.onSelectedData=function(){"detailsview"===this.parent.activeModule&&(this.parent.itemData=this.gridObj.getSelectedRecords())},n.prototype.onDeleteInit=function(){"detailsview"===this.parent.activeModule&&fo(this.parent,this.parent.selectedItems,this.parent.path,"delete")},n.prototype.onDeleteEnd=function(n){"Details"===this.parent.view&&(this.onPathChanged(n),this.parent.setProperties({selectedItems:[]},!0))},n.prototype.onRefreshEnd=function(n){"Details"===this.parent.view&&(this.isInteracted=!1,this.removePathColumn(!1),this.gridObj.dataSource=pt(this.parent,n.files),this.emptyArgs=n)},n.prototype.onHideLayout=function(){"Details"!==this.parent.view&&this.gridObj&&this.gridObj.element.classList.add(ui)},n.prototype.onSelectAllInit=function(){"Details"===this.parent.view&&(this.isInteracted=!1,this.parent.allowMultiSelection?this.gridObj.selectionModule.selectRowsByRange(0,this.gridObj.getRows().length):this.gridObj.selectRow(this.gridObj.getRows().length-1),this.isInteracted=!0,this.interaction=!0)},n.prototype.onClearAllInit=function(){"Details"===this.parent.view&&(this.removeSelection(),this.interaction=!0)},n.prototype.onSelectionChanged=function(){t.removeClass([this.element],ys);this.parent.selectedItems.length>0&&t.addClass([this.element],ys)},n.prototype.onLayoutRefresh=function(){"Details"===this.parent.view&&this.adjustHeight()},n.prototype.onBeforeRequest=function(){this.isRendered=!1},n.prototype.onAfterRequest=function(){this.isRendered=!0},n.prototype.onUpdateSelectionData=function(){"Details"===this.parent.view&&(this.parent.itemData=this.gridObj.getSelectedRecords())},n.prototype.addEventListener=function(){this.parent.on(k,this.onFinalizeEnd,this);this.parent.on(et,this.destroy,this);this.parent.on(ot,this.onLayoutChange,this);this.parent.on(p,this.onPathChanged,this);this.parent.on(st,this.onCreateEnd,this);this.parent.on(at,this.onDropInit,this);this.parent.on(d,this.onDetailsInit,this);this.parent.on(ct,this.onRefreshEnd,this);this.parent.on(ur,this.onSearchFiles,this);this.parent.on(rt,this.onMethodCall,this);this.parent.on(rr,this.onActionFailure,this);this.parent.on(f,this.onPropertyChanged,this);this.parent.on(fi,this.onDeleteInit,this);this.parent.on(ht,this.onDeleteEnd,this);this.parent.on(ni,this.onSelectedData,this);this.parent.on(gt,this.onRenameInit,this);this.parent.on(tt,this.onPathChanged,this);this.parent.on(ci,this.onOpenInit,this);this.parent.on(ae,this.onSortColumn,this);this.parent.on(lt,this.onPathChanged,this);this.parent.on(dr,this.onPathChanged,this);this.parent.on(ti,this.onPasteInit,this);this.parent.on(er,this.onHideLayout,this);this.parent.on(fr,this.onSelectAllInit,this);this.parent.on(gr,this.onClearAllInit,this);this.parent.on(or,this.onPathColumn,this);this.parent.on(c,this.onSelectionChanged,this);this.parent.on(si,this.onBeforeRequest,this);this.parent.on(dt,this.onAfterRequest,this);this.parent.on(it,this.onpasteEnd,this);this.parent.on(vi,this.oncutCopyInit,this);this.parent.on(ai,this.onMenuItemData,this);this.parent.on(ei,this.onDetailsResizeHandler,this);this.parent.on(oi,this.onDetailsResize,this);this.parent.on(hi,this.onLayoutRefresh,this);this.parent.on(vt,this.onDropPath,this);this.parent.on(tu,this.onUpdateSelectionData,this)},n.prototype.removeEventListener=function(){this.parent.off(k,this.onFinalizeEnd);this.parent.off(et,this.destroy);this.parent.off(ot,this.onLayoutChange);this.parent.off(p,this.onPathChanged);this.parent.off(ti,this.onPasteInit);this.parent.off(st,this.onCreateEnd);this.parent.off(ct,this.onRefreshEnd);this.parent.off(ur,this.onSearchFiles);this.parent.off(rt,this.onMethodCall);this.parent.off(rr,this.onActionFailure);this.parent.off(f,this.onPropertyChanged);this.parent.off(gt,this.onRenameInit);this.parent.off(tt,this.onPathChanged);this.parent.off(dr,this.onPathChanged);this.parent.off(ci,this.onOpenInit);this.parent.off(ae,this.onSortColumn);this.parent.off(lt,this.onPathChanged);this.parent.off(er,this.onHideLayout);this.parent.off(fr,this.onSelectAllInit);this.parent.off(gr,this.onClearAllInit);this.parent.off(fi,this.onDeleteInit);this.parent.off(ht,this.onDeleteEnd);this.parent.off(or,this.onPathColumn);this.parent.off(c,this.onSelectionChanged);this.parent.off(si,this.onBeforeRequest);this.parent.off(dt,this.onAfterRequest);this.parent.off(it,this.onpasteEnd);this.parent.off(vi,this.oncutCopyInit);this.parent.off(at,this.onDropInit);this.parent.off(ni,this.onSelectedData);this.parent.off(d,this.onDetailsInit);this.parent.off(ai,this.onMenuItemData);this.parent.off(ei,this.onDetailsResizeHandler);this.parent.off(oi,this.onDetailsResize);this.parent.off(hi,this.onLayoutRefresh);this.parent.off(vt,this.onDropPath);this.parent.off(tu,this.onUpdateSelectionData)},n.prototype.onActionFailure=function(){this.interaction=!0},n.prototype.onMenuItemData=function(n){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=[this.gridObj.getRowInfo(n.target).rowData])},n.prototype.onPasteInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=""!==this.parent.folderPath?this.gridObj.getSelectedRecords():[v(this.parent)])},n.prototype.onDetailsInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.itemData=0!==this.parent.selectedItems.length?this.gridObj.getSelectedRecords():[t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent)])},n.prototype.dragHelper=function(n){var t=n.sender.target.closest("tr.e-row"),i,r;return t?(r=t.getElementsByClassName("e-fe-text")[0].innerText,t&&!t.querySelector(".e-active")&&this.selectRecords([r]),ge(this.parent,t),this.parent.activeElements=[],this.parent.dragData=[],this.parent.dragData=this.gridObj.getSelectedRecords(),0===this.parent.dragData.length&&t&&(i=this.gridObj.getRowInfo(t)),i&&this.parent.dragData.push(i.rowData),this.parent.dragPath=this.parent.path,this.parent.activeElements=this.gridObj.getSelectedRows(),rh(this.parent),this.parent.virtualDragElement):null},n.prototype.onDetailsResize=function(){if("Details"===this.parent.view&&!this.parent.isMobile&&!t.isNullOrUndefined(this.gridObj))for(var i=this.gridObj.getHeaderContent().querySelector(".e-headercontent").firstChild.childNodes[0],r=this.gridObj.getContent().querySelector(".e-content .e-table").children[0],u=this.gridObj.getColumns(),n=0;n<u.length;n++)(this.isNameWidth||"name"!==u[n].field)&&"filterPath"!==u[n].field||(""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered?this.element.clientWidth<=680?"name"===u[n].field?(i.children[n].setAttribute("style","width: 120px"),r.children[n].setAttribute("style","width: 120px")):(i.children[n].setAttribute("style","width: 180px"),r.children[n].setAttribute("style","width: 180px")):this.element.clientWidth>680&&(i.children[n].setAttribute("style","width: auto"),r.children[n].setAttribute("style","width: auto")):this.element.clientWidth<=500?(i.children[n].setAttribute("style","width: 120px"),r.children[n].setAttribute("style","width: 120px")):this.element.clientWidth>500&&(i.children[n].setAttribute("style","width: auto"),r.children[n].setAttribute("style","width: auto")))},n.prototype.onDetailsResizeHandler=function(){this.onDetailsResize();"Details"!==this.parent.view||this.parent.isMobile||t.isNullOrUndefined(this.gridObj)||this.adjustHeight()},n.prototype.createDragObj=function(){var n=this;!this.parent.isMobile&&this.gridObj&&(this.parent.allowDragAndDrop?(this.dragObj&&this.dragObj.destroy(),this.dragObj=new t.Draggable(this.gridObj.element,{cursorAt:this.parent.dragCursorPosition,distance:5,enableTailMode:!0,dragArea:this.parent.element,dragTarget:"."+te,drag:eh.bind(this,this.parent),dragStart:function(t){fh(n.parent,t,n.dragObj)},dragStop:uh.bind(this,this.parent),enableAutoScroll:!0,helper:this.dragHelper.bind(this)})):!this.parent.allowDragAndDrop&&this.dragObj&&this.dragObj.destroy())},n.prototype.onDropInit=function(n){if(this.parent.targetModule===this.getModuleName()){var i,r=t.getValue(this.parent.pathId[this.parent.pathId.length-1],this.parent.feParent);n.target.closest("tr")?(i=this.gridObj.getRowInfo(n.target).rowData,this.parent.dropPath=i.isFile?this.parent.path:uf(this.parent,i,this.parent.path),this.parent.dropData=i.isFile?r:i):(this.parent.dropPath=this.parent.path,this.parent.dropData=r)}},n.prototype.oncutCopyInit=function(){this.parent.activeModule===this.getModuleName()&&(this.parent.activeRecords=this.gridObj.getSelectedRecords(),this.parent.activeElements=this.gridObj.getSelectedRows())},n.prototype.onpasteEnd=function(n){"Details"===this.parent.view&&(this.isPasteOperation=!0,this.parent.path!==this.parent.destinationPath&&this.parent.path!==nh(this.parent,n)||this.onPathChanged(n))},n.prototype.onDropPath=function(n){"Details"===this.parent.view&&(this.isPasteOperation=!0,this.onPathChanged(n))},n.prototype.getModuleName=function(){return"detailsview"},n.prototype.destroy=function(){this.parent.isDestroyed||(this.removeEventListener(),this.gridObj&&(this.unWireEvents(),this.gridObj.destroy()))},n.prototype.updateType=function(n){var i=t.select("."+di,n);this.parent.isFile=!!t.isNullOrUndefined(i)},n.prototype.onSelection=function(n,t){var i={action:n,fileDetails:t.data,isInteracted:this.interaction,cancel:!1,target:t.target};this.parent.trigger("fileSelection",i);t.cancel=i.cancel},n.prototype.onSelected=function(n){var i,e,r,u,f,o,s,h;if(this.parent.activeModule="detailsview",this.parent.isLayoutChange&&!this.parent.isFiltered||this.selectedRecords(),this.parent.notify(c,{}),1===this.gridObj.getSelectedRowIndexes().length&&(this.firstItemIndex=this.gridObj.selectedRowIndex),this.gridObj.element.setAttribute("tabindex","-1"),this.triggerSelect("select",n),i=this.gridObj.getRowByIndex(this.gridObj.selectedRowIndex),(this.updateType(i),t.isNullOrUndefined(i)||t.isNullOrUndefined(i.querySelector(".e-checkselect")))||(1!==this.gridObj.getSelectedRowIndexes().length&&(e=this.gridObj.getSelectedRowIndexes()[this.gridObj.getSelectedRowIndexes().length-2],this.gridObj.getRowByIndex(e).querySelector(".e-checkselect").setAttribute("tabindex","-1")),i.querySelector(".e-rowcell.e-fe-checkbox").removeAttribute("tabindex")),t.isNullOrUndefined(this.gridObj)||t.isNullOrUndefined(this.gridObj.element.querySelector(".e-checkselectall"))||this.gridObj.element.querySelector(".e-checkselectall").setAttribute("tabindex","-1"),r=this.gridObj.getSelectedRowIndexes(),!this.parent.allowMultiSelection)for(u=0;u<r.length;u++)r[u]===this.gridObj.selectedRowIndex?this.gridObj.getRowByIndex(r[u]).setAttribute("tabindex","0"):this.gridObj.getRowByIndex(r[u]).removeAttribute("tabindex");f=r.length;f>0&&(o=this.gridObj.getRowsObject()[r[f-1]].data,this.parent.currentItemText=t.getValue("name",o));s=t.getValue("rowIndexes",n);h=t.getValue("enableSelectMultiTouch",this.gridObj.selectionModule);this.parent.isDevice&&t.isNullOrUndefined(s)&&n.target&&!h&&!n.target.closest(".e-headercell")&&(this.parent.isFile=t.getValue("isFile",n.data),this.parent.isFile||this.openContent(n.data));this.parent.visitedItem=n.row;!this.parent.allowMultiSelection||t.isNullOrUndefined(i)||t.isNullOrUndefined(i.querySelector(".e-checkselect"))||i.querySelector(".e-checkselect").focus();this.addFocus(this.gridObj.selectedRowIndex);this.parent.isLayoutChange||(this.isInteracted=!0)},n.prototype.onPathColumn=function(){"Details"!==this.parent.view||t.isNullOrUndefined(this.gridObj)||""!==this.parent.breadcrumbbarModule.searchObj.element.value||this.parent.isFiltered||this.removePathColumn(!1)},n.prototype.selectedRecords=function(){var t,n,i,r;for(this.parent.setProperties({selectedItems:[]},!0),t=this.gridSelectNodes(),n=0;n<t.length;)i=t[n],r=yi(this.parent,i),this.parent.selectedItems.push(r),n++;this.parent.setProperties({selectedItems:this.parent.selectedItems},!0)},n.prototype.onDeSelection=function(n){if(!this.parent.allowMultiSelection&&t.isNullOrUndefined(n.data))this.gridObj.getRowByIndex(n.rowIndex).removeAttribute("tabindex");else if(this.gridObj.getSelectedRowIndexes().length>1){var i=this.gridObj.getSelectedRowIndexes()[this.gridObj.getSelectedRowIndexes().length-2];this.gridObj.getRowByIndex(i).querySelector(".e-checkselect").removeAttribute("tabindex")}-1===this.gridObj.selectedRowIndex&&this.gridObj.element.setAttribute("tabindex","0");this.isInteracted?(this.selectedRecords(),0===this.parent.selectedItems.length&&(t.setValue("enableSelectMultiTouch",!1,this.gridObj.selectionModule),t.removeClass([this.parent.element],wi)),this.parent.notify(c,{}),this.triggerSelect("unselect",n),this.parent.visitedItem=null):this.isInteracted=!0},n.prototype.triggerSelect=function(n,t){var i={action:n,fileDetails:t.data,isInteracted:this.interaction};this.parent.trigger("fileSelect",i);this.interaction=!0},n.prototype.wireEvents=function(){this.wireClickEvent(!0);this.keyboardModule=new t.KeyboardEvents(this.gridObj.element,{keyAction:this.keyupHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keyup"});this.keyboardDownModule=new t.KeyboardEvents(this.element,{keyAction:this.keydownHandler.bind(this),keyConfigs:this.keyConfigs,eventName:"keydown"});t.EventHandler.add(this.gridObj.element,"blur",this.removeFocus,this)},n.prototype.unWireEvents=function(){this.wireClickEvent(!1);this.keyboardModule.destroy();this.keyboardDownModule.destroy();t.EventHandler.remove(this.gridObj.element,"blur",this.removeFocus)},n.prototype.wireClickEvent=function(n){if(n){var i=this,r=this.gridObj.getContent();this.clickObj=new t.Touch(r,{tap:function(n){1===n.tapCount&&n.originalEvent.target.classList.contains("e-content")&&i.onClearAllInit()},tapHold:function(n){var r,u,f;i.parent.isDevice&&(n.originalEvent.preventDefault(),i.parent.allowMultiSelection&&(t.setValue("enableSelectMultiTouch",i.parent.allowMultiSelection,i.gridObj.selectionModule),t.addClass([i.parent.element],wi)),r=n.originalEvent.target,r&&(u=t.closest(r,"."+te),f=i.gridObj.getRows().indexOf(u),i.gridObj.selectRow(f)))}})}else this.clickObj&&this.clickObj.destroy()},n.prototype.removeSelection=function(){t.removeClass([this.parent.element],wi);this.gridObj.clearSelection();this.parent.setProperties({selectedItems:[]},!0);this.parent.notify(c,{});-1===this.gridObj.selectedRowIndex&&(this.startIndex=null);this.isInteracted=!0},n.prototype.removeFocus=function(){this.addFocus(null)},n.prototype.getFocusedItemIndex=function(){return t.isNullOrUndefined(this.getFocusedItem())?null:parseInt(this.getFocusedItem().getAttribute("aria-rowindex"),10)},n.prototype.keydownHandler=function(n){if(this.isRendered)switch(n.action){case"end":case"home":case"space":case"ctrlSpace":case"shiftSpace":case"csSpace":case"ctrlA":case"enter":case"altEnter":case"ctrlEnd":case"shiftEnd":case"csEnd":case"ctrlHome":case"shiftHome":case"csHome":case"ctrlDown":case"shiftDown":case"csDown":case"ctrlLeft":case"shiftLeft":case"csLeft":case"esc":case"del":case"shiftdel":case"ctrlC":case"ctrlV":case"ctrlX":case"f2":case"moveDown":case"moveUp":n.preventDefault()}},n.prototype.keyupHandler=function(n){var c;if(this.isRendered){n.preventDefault();var o,u,f,v=n.action,i=pt(this.parent,this.gridObj.dataSource),e=i.length,s=(this.getFocusedItem(),this.getFocusedItemIndex()),r=this.gridObj.selectedRowIndex,h=this.gridObj.getSelectedRowIndexes();switch(v){case"altEnter":hf(this.parent,this.parent.selectedItems,this.parent.path,"details");break;case"esc":ds(this.parent);break;case"del":case"shiftdel":this.performDelete();break;case"enter":if(-1===this.gridObj.selectedRowIndex)break;(o=this.gridObj.getRowsObject()[this.gridObj.selectedRowIndex].data)&&(c=JSON.parse(JSON.stringify(o)),this.openContent(c));break;case"ctrlC":nf(this.parent);break;case"ctrlV":this.parent.folderPath="";ff(this.parent);break;case"ctrlX":tf(this.parent);break;case"ctrlD":this.doDownload();break;case"f2":this.performRename();break;case"ctrlA":if(!t.isNullOrUndefined(i[0])&&this.parent.allowMultiSelection){var l=this.gridObj.getContent().querySelector(".e-content"),y=l.scrollTop,a=this.gridObj.selectedRowIndex;this.gridObj.selectionModule.selectRowsByRange(0,i.length-1);l.scrollTop=y;-1!==a&&this.addFocus(a)}break;case"ctrlHome":case"tab":if(!t.isNullOrUndefined(i[0]))if(this.parent.allowMultiSelection||"ctrlHome"!==n.action){if(-1!==this.gridObj.selectedRowIndex&&"tab"===n.action)return;this.addFocus(0)}else this.gridObj.selectRow(0);break;case"ctrlEnd":t.isNullOrUndefined(i[0])||(this.parent.allowMultiSelection?this.addFocus(e-1):this.gridObj.selectRow(e-1));break;case"shiftHome":case"shiftEnd":case"csHome":case"csEnd":this.parent.allowMultiSelection?t.isNullOrUndefined(i[0])||(t.isNullOrUndefined(r)||-1===r?"csHome"===n.action||"shiftHome"===n.action?this.gridObj.selectRow(0):this.gridObj.selectionModule.selectRowsByRange(0,i.length-1):this.checkRowsKey(i,r,null,n)):this.gridObj.selectRow("shiftHome"===n.action||"csHome"===n.action?0:i.length-1);break;case"space":case"csSpace":case"shiftSpace":case"ctrlSpace":this.spaceSelection(h,s,r,n);break;case"csUp":case"csDown":case"shiftUp":case"shiftDown":this.shiftMoveMethod(i,r,s,h,n);break;case"ctrlUp":case"ctrlDown":this.parent.allowMultiSelection?this.ctrlMoveFunction(i,n,r):this.moveFunction(i,n,r);break;case"home":u=[t.getValue(this.parent.hasId?"id":"name",i[0])];this.parent.setProperties({selectedItems:u},!0);this.selectRecords(u);break;case"moveUp":case"moveDown":this.moveFunction(i,n,r);break;case"end":f=[t.getValue(this.parent.hasId?"id":"name",i[e-1])];this.parent.setProperties({selectedItems:f},!0);this.selectRecords(f)}}},n.prototype.gridSelectNodes=function(){return this.gridObj.getSelectedRecords()},n.prototype.doDownload=function(){if(0!==this.parent.selectedItems.length){this.parent.itemData=this.gridObj.getSelectedRecords();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!of(t[n]))return void e(this.parent,t[n],iu);cf(this.parent,this.parent.path,this.parent.selectedItems)}},n.prototype.performDelete=function(){if(this.parent.selectedItems&&this.parent.selectedItems.length>0){this.parent.itemData=this.gridObj.getSelectedRecords();for(var t=this.parent.itemData,n=0;n<t.length;n++)if(!y(t[n]))return void e(this.parent,t[n],g);s(this.parent,"Delete")}},n.prototype.performRename=function(){1===this.parent.selectedItems.length&&(this.updateRenameData(),io(this.parent))},n.prototype.updateRenameData=function(){var n=this.gridSelectNodes()[0];to(this.parent,n)},n.prototype.shiftMoveMethod=function(n,t,i,r,u){this.parent.allowMultiSelection?-1!==t||"csUp"!==u.action&&"csDown"!==u.action?-1===t||i===t||("csUp"===u.action||"csDown"===u.action)&&this.isSelected(r,i)?this.shiftSelectedItem(t,r,n,u):this.shiftSelectFocusItem(t,i,r,u):this.ctrlMoveFunction(n,u,t):this.moveFunction(n,u,t)},n.prototype.moveFunction=function(n,i,r){!t.isNullOrUndefined(this.getFocusedItem())&&this.parent.allowMultiSelection?"moveDown"===i.action?this.gridObj.selectRow(this.getFocusedItemIndex()+1):this.gridObj.selectRow(this.getFocusedItemIndex()-1):t.isNullOrUndefined(r)||-1===r?t.isNullOrUndefined(n[0])||this.gridObj.selectRow(0):"moveDown"===i.action||"ctrlDown"===i.action||"shiftDown"===i.action||"csDown"===i.action?this.gridObj.selectRow(r+(r!==n.length-1?1:0)):this.gridObj.selectRow(r-(0!==r?1:0))},n.prototype.spaceSelection=function(n,i,r,u){if(this.isSelected(n,i)||-1===r||"shiftSpace"!==u.action&&"csSpace"!==u.action)if(t.isNullOrUndefined(this.getFocusedItem())||i===r)if(-1!==r&&"ctrlSpace"===u.action&&this.parent.allowMultiSelection){var f=r;n.pop();this.gridObj.selectRows(n);this.addFocus(f)}else"shiftSpace"===u.action&&this.gridObj.selectRow(r);else n.push(this.getFocusedItemIndex()),this.gridObj.selectRows(n);else i<r?this.gridObj.selectionModule.selectRowsByRange(i,r):this.gridObj.selectionModule.selectRowsByRange(r,i)},n.prototype.ctrlMoveFunction=function(n,i,r){var f,u;t.isNullOrUndefined(this.getFocusedItem())?t.isNullOrUndefined(r)||-1===r?t.isNullOrUndefined(n[0])||(f=0):f="ctrlDown"===i.action||"csDown"===i.action?r+(r<n.length?1:0):r-(r<1?0:1):(u=this.getFocusedItemIndex(),f="ctrlDown"===i.action||"csDown"===i.action?u+(u<n.length-1?1:0):u-(u<1?0:1));this.addFocus(f)},n.prototype.checkRowsKey=function(n,i,r,u){"Uncheck"===this.gridObj.checkAllRows||"Intermediate"===this.gridObj.checkAllRows?"csHome"!==u.action&&"csEnd"!==u.action?(t.isNullOrUndefined(this.startIndex)&&this.firstItemIndex!==i&&(this.firstItemIndex=i),"shiftEnd"===u.action?this.gridObj.selectionModule.selectRowsByRange(this.firstItemIndex,n.length-1):this.gridObj.selectionModule.selectRowsByRange(0,this.firstItemIndex),this.startIndex=i):"csEnd"===u.action?this.gridObj.selectRows(this.InnerItems(t.isNullOrUndefined(i)?0:i,t.isNullOrUndefined(r)?n.length-1:r,u)):t.isNullOrUndefined(i)?this.gridObj.selectRow(0):this.gridObj.selectRows(this.InnerItems(t.isNullOrUndefined(r)?0:r,i,u)):this.gridObj.selectionModule.selectRow("shiftHome"===u.action||"csHome"===u.action?0:n.length-1)},n.prototype.InnerItems=function(n,t,i){var u=this.gridObj.getSelectedRowIndexes(),r;if("csEnd"===i.action)for(r=n+1;r<=t;r++)u.push(r);else for(r=t-1;n<=r;r--)u.push(r);return u},n.prototype.shiftSelectFocusItem=function(n,i,r,u){var e=i+("shiftDown"===u.action||"csDown"===u.action?1:-1),f=t.isNullOrUndefined(this.startIndex)?n:r[0];f===e?this.gridObj.selectRow(f):f<e?"shiftDown"===u.action||"csDown"===u.action?this.gridObj.selectionModule.selectRowsByRange(f,e):this.gridObj.selectionModule.selectRowsByRange(e,f):"shiftDown"===u.action||"csDown"===u.action?this.gridObj.selectionModule.selectRowsByRange(e,f):this.gridObj.selectionModule.selectRowsByRange(f,e);this.startIndex=this.gridObj.selectedRowIndex},n.prototype.addFocus=function(n){var r=this.getFocusedItem(),i=this.gridObj.getRowByIndex(n);r&&(r.removeAttribute("tabindex"),t.removeClass([r],[pr,ne]));t.isNullOrUndefined(i)||(this.gridObj.element.setAttribute("tabindex","-1"),i.setAttribute("tabindex","0"),i.focus(),t.addClass([i],[pr,ne]))},n.prototype.getFocusedItem=function(){return t.select("."+ne,this.element)},n.prototype.isSelected=function(n,t){for(var r=!1,i=0;i<=n.length-1;i++)if(n[i]===t){r=!0;break}return r},n.prototype.shiftSelectedItem=function(n,i,r,u){-1===n?this.gridObj.selectRow(0):t.isNullOrUndefined(this.startIndex)&&u.shiftKey?(this.startIndex=this.gridObj.selectedRowIndex,this.gridObj.selectRows([n,"shiftDown"===u.action||"csDown"===u.action?n+(n!==r.length-1?1:0):n-(0!==n?1:0)])):"shiftDown"===u.action||"shiftUp"===u.action?("shiftDown"===u.action&&-1===i.indexOf(n+1)?n!==r.length-1&&i.push(n+1):"shiftUp"===u.action&&-1===i.indexOf(n-1)?0!==n&&i.push(n-1):i.pop(),this.gridObj.selectRows(i)):"csDown"===u.action?this.isSelected(i,this.getFocusedItemIndex()+1)?this.addFocus(this.getFocusedItemIndex()+1):(i.push(this.getFocusedItemIndex()+1),this.gridObj.selectRows(i)):this.isSelected(i,this.getFocusedItemIndex()-1)?this.addFocus(this.getFocusedItemIndex()-1):(i.push(this.getFocusedItemIndex()-1),this.gridObj.selectRows(i))},n.prototype.onMethodCall=function(n){if("Details"===this.parent.view)switch(t.getValue("action",n)){case"deleteFiles":this.deleteFiles(t.getValue("ids",n));break;case"downloadFiles":this.downloadFiles(t.getValue("ids",n));break;case"openFile":this.openFile(t.getValue("id",n));break;case"createFolder":this.interaction=!1;break;case"renameFile":this.interaction=!1;this.renameFile(t.getValue("id",n),t.getValue("newName",n));break;case"selectAll":this.interaction=!1;this.onSelectAllInit();break;case"clearSelection":this.interaction=!1;this.onClearAllInit()}},n.prototype.getRecords=function(n){var r=this.gridObj.getCurrentViewRecords(),f=[],o=!(""===this.parent.breadcrumbbarModule.searchObj.element.value&&!this.parent.isFiltered),s=this.parent.hasId?"id":"name",i,u,e;if(this.parent.hasId||!o)for(i=0,u=r.length;i<u;i++)-1!==n.indexOf(t.getValue(s,r[i]))&&f.push(r[i]);else for(i=0,u=r.length;i<u;i++)e=t.getValue("filterPath",r[i])+t.getValue("name",r[i]),-1!==n.indexOf(e)&&f.push(r[i]);return f},n.prototype.deleteFiles=function(n){var r;if(this.parent.activeModule="detailsview",t.isNullOrUndefined(n))this.performDelete();else if(r=this.getRecords(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=r[i],f[i]=yi(this.parent,u[i]);ta(this.parent,u,f)}},n.prototype.downloadFiles=function(n){var r;if(t.isNullOrUndefined(n))this.doDownload();else if(r=this.getRecords(n),0!==r.length){for(var u=[],f=[],i=0;i<r.length;i++)u[i]=r[i],f[i]=yi(this.parent,u[i]);ia(this.parent,u,f)}},n.prototype.openFile=function(n){if(!t.isNullOrUndefined(n)){var i=this.getRecords([n]);i.length>0&&this.openContent(i[0])}},n.prototype.renameFile=function(n,i){if(this.parent.activeModule="detailsview",t.isNullOrUndefined(n))this.performRename();else{var r=this.getRecords([n]);r.length>0&&(to(this.parent,r[0]),t.isNullOrUndefined(i)?io(this.parent):y(this.parent.itemData[0])?sf(this.parent,this.parent.path,i):e(this.parent,this.parent.itemData[0],g))}},n}();eo={};pf.J(eo,yf);ga={filemanager:eo=pf.J(window.ejdashboard?window.ejdashboard.filemanager:{},eo)};window.ejdashboard=pf.J(window.ejdashboard||{},ga)})()})();(()=>{function n(r){var f=t[r],u;return void 0!==f?f.exports:(u=t[r]={exports:{}},i[r](u,u.exports,n),u.exports)}var i={665:(n,t)=>{t.J=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}}},t={};n.d=(t,i)=>{for(var r in i)n.o(i,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:i[r]})};n.o=(n,t)=>Object.prototype.hasOwnProperty.call(n,t);n.r=n=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(n,"__esModule",{value:!0})};(()=>{function vu(n,t,i){for(var r=0;t.length>r;r++)if(t[r].value===i.subCommand)return n.localeObj.getConstant(t[r].locale);return i.text}function rh(n,t){var i=-1;return t.some(function(t,r){return"string"==typeof t&&n===t.toLocaleLowerCase()&&(i=r,!0)}),i}function it(n,t){var i=!1;return n.classList.contains(t)&&(i=!0),i}function yt(n,i,r,u){for(var e,o,f=0;f<n.length;f++){if("value"===r&&n[f].value.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}if("text"===r&&n[f].text.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}if("subCommand"===r&&n[f].subCommand.toLocaleLowerCase()===i.toLocaleLowerCase()){e=n[f];break}}if(!t.isNullOrUndefined(e))switch(u){case"text":o=e.text;break;case"value":o=e.value;break;case"iconCss":o=e.iconCss}return o}function o(){var n=!1;return t.Browser.isDevice&&t.Browser.isIos&&(n=!0),n}function uh(n){return t.isNullOrUndefined(n)?"":n}function gp(n,t,i){return i?window.pageYOffset+t.getBoundingClientRect().top+n.clientY:n.pageY}function fh(n,t){var i=t.getService("rteLocale"),r=ig[n];return i.getConstant(r)}function sl(n,i,r){var f,o,h,a,c,e,v,k,y,d,p,w,g;al(r);for(var u=n.dropDownModule,s=n.args,l=0,b=Object.keys(n.args);l<b.length;l++)for(f=b[l],o=0;o<n.tbItems.length;o++)if(h=n.tbItems[o].subCommand,a=h&&h.toLocaleLowerCase(),h&&a===f||"UL"===h&&"unorderedlist"===f||"OL"===h&&"orderedlist"===f||"pre"===a&&"insertcode"===f)if("boolean"==typeof s[f])!0===s[f]?t.addClass([n.tbElements[o]],[su]):t.removeClass([n.tbElements[o]],[su]);else if(("string"==typeof s[f]||null===s[f])&&rh(f,n.parent.toolbarSettings.items)>-1){c=s[f]?s[f]:"";e="";switch(f){case"formats":if(t.isNullOrUndefined(u.formatDropDown)||i||!t.isNullOrUndefined(u.formatDropDown)&&u.formatDropDown.isDestroyed)break;v=n.parent.format.types;k=t.isNullOrUndefined(n.parent.format.default)?v[0].text:n.parent.format.default;e=yt(v,c,"subCommand","text");u.formatDropDown.content='<span style="display: inline-flex;width:'+n.parent.format.width+'" ><span class="e-rte-dropdown-btn-text">'+(t.isNullOrUndefined(e)?k:e)+"<\/span><\/span>";u.formatDropDown.dataBind();break;case"alignments":if(t.isNullOrUndefined(u.alignDropDown)||!t.isNullOrUndefined(u.alignDropDown)&&u.alignDropDown.isDestroyed)break;e=yt(wf,c,"subCommand","iconCss");u.alignDropDown.iconCss=t.isNullOrUndefined(e)?"e-icons e-justify-left":e;u.alignDropDown.dataBind();break;case"fontname":if(t.isNullOrUndefined(u.fontNameDropDown)||i||!t.isNullOrUndefined(u.fontNameDropDown)&&u.fontNameDropDown.isDestroyed)break;y=n.parent.fontFamily.items;e=yt(y,c,"value","text");d=t.isNullOrUndefined(n.parent.fontFamily.default)?y[0].text:n.parent.fontFamily.default;p=t.isNullOrUndefined(e)?d:e;n.tbElements[o].title=p;u.fontNameDropDown.content='<span style="display: inline-flex;width:'+n.parent.fontFamily.width+'" ><span class="e-rte-dropdown-btn-text">'+p+"<\/span><\/span>";u.fontNameDropDown.dataBind();break;case"fontsize":if(t.isNullOrUndefined(u.fontSizeDropDown)||!t.isNullOrUndefined(u.fontSizeDropDown)&&u.fontSizeDropDown.isDestroyed)break;w=n.parent.fontSize.items;g=t.isNullOrUndefined(n.parent.fontSize.default)?w[1].text:n.parent.fontSize.default;e=yt(w,""===c?g.replace(/\s/g,""):c,"value","text");u.fontSizeDropDown.content='<span style="display: inline-flex;width:'+n.parent.fontSize.width+'" ><span class="e-rte-dropdown-btn-text">'+uh(e)+"<\/span><\/span>";u.fontSizeDropDown.dataBind()}}}function bf(n){return"object"==typeof n?n:[n]}function kf(n,t){for(var i,u=[],r=0;r<n.length;r++)for(i=0;i<t.length;i++)if("Separator"!==t[i].type){if("OrderedList"===n[r]&&"OL"===t[i].subCommand){u.push(i);break}if("UnorderedList"===n[r]&&"UL"===t[i].subCommand){u.push(i);break}if("InsertCode"===n[r]&&"Pre"===t[i].subCommand){u.push(i);break}if("FileManager"===n[r]&&"File"===t[i].subCommand){u.push(i);break}if("object"==typeof n[r]&&"Custom"===n[r].command){u.push(r);break}if(n[r]===t[i].subCommand){u.push(i);break}}return u}function yu(n,i){for(var o,u,f=0,s=kf(bf(og),n.toolbarObj.items),h=t.selectAll("."+vi,n.toolbarObj.element),r=0,e=Object.keys(i);r<e.length;r++)o=e[r],u=h[s[f]],u&&n.toolbarObj.enableItems(u,i[o]),f++}function ir(n,t){var i=document.createEvent("HTMLEvents");i.initEvent(t,!1,!0);n.dispatchEvent(i)}function pi(n){var i=t.createElement("template");return i.innerHTML=n,i.content instanceof DocumentFragment?i.content:document.createRange().createContextualFragment(n)}function hl(n,t){var i=[];for(t=t.firstChild;t;t=t.nextSibling)3===t.nodeType?i.push(t):i=i.concat(hl(n,t));return i}function eh(n){for(var i={},r=Object.keys(n),t=0;t<Object.keys(n).length;t++)i[r[t].toLocaleLowerCase()]=n[r[t]];return i}function df(n,t){var i;return null!==n&&""!==n?(i=t.enableHtmlEncode?cl(pt(n),t):cl(n,t),t.setProperties({value:i},!0)):i="DIV"===t.enterKey?t.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/><\/div>":"BR"===t.enterKey?t.enableHtmlEncode?"&lt;br/&gt;":"<br/>":t.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/><\/p>",i}function cl(n,i){var r=document.createElement("div"),e=document.createElement("div"),c=r.childNodes,f,u;if(r.innerHTML=n,r.setAttribute("class","tempDiv"),c.length>0){for(var s=void 0,h=void 0,o=void 0;r.firstChild;)"BR"!==i.enterKey&&("#text"===r.firstChild.nodeName&&(r.firstChild.textContent.indexOf("\n")<0||""!==r.firstChild.textContent.trim())||sg.indexOf(r.firstChild.nodeName.toLocaleLowerCase())>=0)?(s?h.appendChild(r.firstChild):(o="DIV"===i.enterKey?t.createElement("div"):t.createElement("p"),e.appendChild(o),o.appendChild(r.firstChild)),h=o,s=!0):"#text"===r.firstChild.nodeName&&("\n"===r.firstChild.textContent||r.firstChild.textContent.indexOf("\n")>=0&&""===r.firstChild.textContent.trim())?t.detach(r.firstChild):(e.appendChild(r.firstChild),s=!1);for(f=e.querySelectorAll("img"),u=0;u<f.length;u++)f[u].classList.contains(lu)||f[u].classList.add(lu),f[u].classList.contains(vt)||f[u].classList.contains(ei)||f[u].classList.add(vt)}return e.innerHTML}function oh(n){return"DIV"===n.enterKey?n.enableHtmlEncode?"&lt;div&gt;&lt;br/&gt;&lt;/div&gt;":"<div><br/><\/div>":"BR"===n.enterKey?n.enableHtmlEncode?"&lt;br/&gt;":"<br/>":n.enableHtmlEncode?"&lt;p&gt;&lt;br/&gt;&lt;/p&gt;":"<p><br/><\/p>"}function nw(n){return"<p><br><\/p>"===n||"&lt;p&gt;&lt;br&gt;&lt;/p&gt;"===n||"<div><br><\/div>"===n||"&lt;div&gt;&lt;br&gt;&lt;/div&gt;"===n||"<br>"===n||"&lt;br&gt;"===n||""===n}function pt(n){return n.replace(/&amp;/g,"&").replace(/&amp;lt;/g,"<").replace(/&lt;/g,"<").replace(/&amp;gt;/g,">").replace(/&gt;/g,">").replace(/&nbsp;/g," ").replace(/&amp;nbsp;/g," ").replace(/&quot;/g,"")}function ll(n,i){if(i.enableHtmlSanitizer){var r=t.SanitizeHtmlHelper.beforeSanitize();t.extend(r,r,{cancel:!1,helper:null});i.trigger("beforeSanitizeHtml",r);r.cancel&&!t.isNullOrUndefined(r.helper)?n=r.helper(n):r.cancel||(n=t.SanitizeHtmlHelper.serializeValue(r,n))}return n}function gf(n){for(var i=n.split(","),f=i[0].match(/:(.*?);/)[1],r=atob(i[1]),t=r.length,u=new Uint8Array(t);t--;)u[t]=r.charCodeAt(t);return new Blob([u],{type:f})}function ne(n,t,i){for(var r=0;t.length>r;r++)if(t[r].value===i.value||t[r].value===i.subCommand)return n.localeObj.getConstant(t[r].locale);return i.text}function al(n){gs.forEach(function(t,i){gs[i].text=ne(n,rg,gs[i])});nh.forEach(function(t,i){nh[i].text=ne(n,ug,nh[i])});th.forEach(function(t,i){th[i].text=ne(n,fg,th[i])});ih.forEach(function(t,i){ih[i].text=ne(n,eg,ih[i])})}function d(){var n=!1;return t.Browser.isDevice&&t.Browser.isIos&&(n=!0),n}function wi(n,i){if("BODY"===n.nodeName&&!t.isNullOrUndefined(i)){var r=top.window.document.querySelector(i);t.isNullOrUndefined(r)||r.contentWindow.focus()}}function gh(n,t,i,r){var f,e,o,u;if(f=i?t.contentModule.getDocument().querySelector("body"):t.element,Object.keys(n).length)for(e=0,o=Object.keys(n);e<o.length;e++)u=o[e],"class"===u?f.classList.add(n[u]):"disabled"===u&&"disabled"===n[u]?(t.enabled=!1,t.setEnable()):"readonly"===u&&"readonly"===n[u]?(t.readonly=!0,t.setReadOnly(r)):"style"===u?f.setAttribute("style",n[u]):"tabindex"===u?t.inputElement.setAttribute("tabindex",n[u]):"placeholder"===u?(t.placeholder=n[u],t.setPlaceHolder()):["name","required"].indexOf(u)>-1?t.valueContainer.setAttribute(u,n[u]):f.setAttribute(u,n[u])}var re,ue,db,gb,nk,av,ok;re={};n.r(re);n.d(re,{ACTION:()=>rr,ALIGNMENT_TYPE:()=>rv,Alignments:()=>ib,BLOCK_TAGS:()=>bi,BaseQuickToolbar:()=>rw,BaseToolbar:()=>yl,CLASS_CAPTION:()=>s,CLASS_CAPTION_INLINE:()=>hv,CLASS_IMAGE_BREAK:()=>kh,CLASS_IMAGE_CENTER:()=>fr,CLASS_IMAGE_INLINE:()=>ub,CLASS_IMAGE_LEFT:()=>dt,CLASS_IMAGE_RIGHT:()=>kt,CLASS_RTE_CAPTION:()=>dg,CLEAR_COMMAND:()=>ea,CLEAR_TYPE:()=>sv,CLS_ACTIVE:()=>su,CLS_BACK:()=>hd,CLS_BACKGROUND_COLOR_DROPDOWN:()=>tp,CLS_BACKGROUND_COLOR_PICKER:()=>up,CLS_BACKGROUND_COLOR_TARGET:()=>gy,CLS_BULLETFORMATLIST_TB_BTN:()=>py,CLS_CAPINLINE:()=>ou,CLS_CAPTION:()=>oi,CLS_COLOR_CONTENT:()=>hu,CLS_COLOR_PALETTE:()=>ip,CLS_CONTENT:()=>id,CLS_COUNT:()=>wc,CLS_CUSTOM_TILE:()=>kp,CLS_DISABLED:()=>is,CLS_DROPAREA:()=>pp,CLS_DROPDOWN_BTN:()=>w,CLS_DROPDOWN_ICONS:()=>os,CLS_DROPDOWN_ITEMS:()=>at,CLS_DROPDOWN_POPUP:()=>tt,CLS_ERROR:()=>ls,CLS_EXPAND_OPEN:()=>yi,CLS_FOCUS:()=>hs,CLS_FONT_COLOR_DROPDOWN:()=>np,CLS_FONT_COLOR_PICKER:()=>rp,CLS_FONT_COLOR_TARGET:()=>dy,CLS_FONT_NAME_TB_BTN:()=>by,CLS_FONT_SIZE_TB_BTN:()=>ky,CLS_FORMATS_TB_BTN:()=>wy,CLS_FULL_SCREEN:()=>uu,CLS_HIDE:()=>eu,CLS_HR_SEPARATOR:()=>vy,CLS_ICONS:()=>lf,CLS_IMAGE_POP:()=>ly,CLS_IMGBREAK:()=>ei,CLS_IMGCENTER:()=>pc,CLS_IMGINLINE:()=>vt,CLS_IMGLEFT:()=>yc,CLS_IMGRIGHT:()=>vc,CLS_IMG_FOCUS:()=>vp,CLS_IMG_INNER:()=>wp,CLS_IMG_RESIZE:()=>yp,CLS_INLINE:()=>fs,CLS_INLINE_DROPDOWN:()=>es,CLS_INLINE_POP:()=>fu,CLS_LIST_PRIMARY_CONTENT:()=>vs,CLS_MAXIMIZE:()=>sd,CLS_MINIMIZE:()=>od,CLS_NOCOLOR_ITEM:()=>dp,CLS_NUMBERFORMATLIST_TB_BTN:()=>yy,CLS_POP:()=>sc,CLS_POPUP:()=>fd,CLS_POPUP_OPEN:()=>ys,CLS_QUICK_DROPDOWN:()=>fi,CLS_QUICK_POP:()=>cy,CLS_QUICK_TB:()=>cf,CLS_RESIZE:()=>ap,CLS_RM_WHITE_SPACE:()=>ac,CLS_RTE:()=>rc,CLS_RTE_CAPTION:()=>ay,CLS_RTE_CONTENT:()=>hc,CLS_RTE_DIALOG_MIN_HEIGHT:()=>cp,CLS_RTE_DIALOG_UPLOAD:()=>nl,CLS_RTE_DRAG_IMAGE:()=>pf,CLS_RTE_ELEMENTS:()=>v,CLS_RTE_EXPAND_TB:()=>oc,CLS_RTE_FIXED_TB_EXPAND:()=>fl,CLS_RTE_HIDDEN:()=>kc,CLS_RTE_IMAGE:()=>lu,CLS_RTE_PASTE_CANCEL:()=>hp,CLS_RTE_PASTE_KEEP_FORMAT:()=>fp,CLS_RTE_PASTE_OK:()=>sp,CLS_RTE_PASTE_PLAIN_FORMAT:()=>op,CLS_RTE_PASTE_REMOVE_FORMAT:()=>ep,CLS_RTE_READONLY:()=>cu,CLS_RTE_RES_CNT:()=>tl,CLS_RTE_RES_EAST:()=>lp,CLS_RTE_RES_HANDLE:()=>dc,CLS_RTE_TABLE_RESIZE:()=>ul,CLS_RTE_TB_ENABLED:()=>el,CLS_RTE_UPLOAD_POPUP:()=>gc,CLS_RTL:()=>ts,CLS_SCRIPT_SHEET:()=>uc,CLS_SEPARATOR:()=>ed,CLS_SHOW:()=>cc,CLS_STYLE_SHEET:()=>fc,CLS_TABLE:()=>il,CLS_TABLE_BORDER:()=>rl,CLS_TABLE_SEL:()=>si,CLS_TB_ABS_FLOAT:()=>us,CLS_TB_ALT_BOR:()=>tr,CLS_TB_BOX_RES:()=>yf,CLS_TB_BTN:()=>as,CLS_TB_COL_RES:()=>af,CLS_TB_DASH_BOR:()=>nr,CLS_TB_EXTENDED:()=>ud,CLS_TB_FIXED:()=>ec,CLS_TB_FLOAT:()=>rs,CLS_TB_INLINE:()=>rd,CLS_TB_IOS_FIX:()=>bc,CLS_TB_ITEM:()=>vi,CLS_TB_ROW_RES:()=>vf,CLS_TB_STATIC:()=>hy,CLS_TB_WRAP:()=>ss,CLS_TOOLBAR:()=>hf,CLS_UPLOAD_FILES:()=>bp,CLS_VISIBLE:()=>lc,CLS_WARNING:()=>cs,ClearFormat:()=>pw,ClearFormatExec:()=>hb,ColorPickerInput:()=>kl,ContentRender:()=>lv,Count:()=>yg,DEFAULT_TAG:()=>g,DELETECOLUMN:()=>ba,DELETEROW:()=>wa,DOMNode:()=>bh,DialogRenderer:()=>rk,DialogType:()=>ri,DropDownButtons:()=>pl,EditorManager:()=>vb,ExecCommandCallBack:()=>ew,FORMAT_TYPE:()=>te,FileManager:()=>nk,Formats:()=>nb,Formatter:()=>ra,FullScreen:()=>av,HTMLFormatter:()=>yb,HtmlEditor:()=>un,HtmlToolbarStatus:()=>wb,IGNORE_BLOCK_TAGS:()=>wt,IMAGE:()=>wh,INDENT_TYPE:()=>uv,INSERTHTML_TYPE:()=>ev,INSERT_COLUMN:()=>pa,INSERT_ROW:()=>ya,INSERT_TEXT_TYPE:()=>ov,IframeContentRender:()=>bb,Image:()=>en,ImageCommand:()=>fb,Indents:()=>rb,InsertHtml:()=>bt,InsertHtmlExec:()=>sb,InsertMethods:()=>h,InsertTextExec:()=>ab,IsFormatted:()=>gt,KEY_DOWN:()=>ah,KEY_DOWN_HANDLER:()=>l,KEY_UP:()=>pu,KEY_UP_HANDLER:()=>hi,KeyboardEvents:()=>ch,LINK:()=>va,LINK_COMMAND:()=>fa,LISTS_COMMAND:()=>ua,LIST_TYPE:()=>dl,Link:()=>fn,LinkCommand:()=>tb,Lists:()=>gw,MDFormats:()=>sw,MDLink:()=>vw,MDLists:()=>ow,MDSelectionFormats:()=>hw,MDTable:()=>yw,MD_TABLE:()=>ph,MODEL_CHANGED:()=>vh,MODEL_CHANGED_PLUGIN:()=>wu,MS_WORD_CLEANUP:()=>na,MS_WORD_CLEANUP_PLUGIN:()=>gl,MarkdownEditor:()=>kg,MarkdownFormatter:()=>bw,MarkdownParser:()=>ww,MarkdownRender:()=>kw,MarkdownSelection:()=>lh,MarkdownToolbarStatus:()=>fw,MsWordPaste:()=>lb,NodeCutter:()=>ur,NodeSelection:()=>b,ON_BEGIN:()=>ta,PasteCleanup:()=>db,PopupRenderer:()=>uw,QuickToolbar:()=>vg,REMOVETABLE:()=>ka,Render:()=>tk,RenderType:()=>f,RendererFactory:()=>bl,Resize:()=>gb,RichTextEditor:()=>ett,SELECTION_TYPE:()=>fv,SPACE_ACTION:()=>ia,SelectionBasedExec:()=>ob,SelectionCommands:()=>cv,ServiceLocator:()=>wl,TABLE:()=>aa,TABLEHEADER:()=>da,TABLE_BLOCK_TAGS:()=>bu,TABLE_HORIZONTAL_SPLIT:()=>iv,TABLE_MERGE:()=>nv,TABLE_MOVE:()=>dw,TABLE_VERTICAL_ALIGN:()=>ga,TABLE_VERTICAL_SPLIT:()=>tv,Table:()=>on,TableCommand:()=>eb,Toolbar:()=>cg,ToolbarAction:()=>iw,ToolbarRenderer:()=>tw,ToolbarStatus:()=>pb,ToolbarType:()=>y,UndoRedoCommands:()=>aw,UndoRedoManager:()=>cb,ViewSource:()=>ik,XhtmlValidation:()=>kb,actionBegin:()=>k,actionComplete:()=>ft,actionSuccess:()=>ak,afterImageDelete:()=>ic,afterPasteCleanup:()=>sy,beforeDialogClose:()=>gv,beforeDialogOpen:()=>kv,beforeDropDownItemRender:()=>se,beforeDropDownOpen:()=>ff,beforeImageDrop:()=>ey,beforeImageUpload:()=>vo,beforePasteCleanup:()=>oy,beforeQuickToolbarOpen:()=>ty,bindOnEnd:()=>du,checkUndo:()=>oo,clearDialogObj:()=>ai,closeImageDialog:()=>ko,closeLinkDialog:()=>wo,closeTableDialog:()=>ns,colorPickerChanged:()=>br,contentBlur:()=>gk,contentChanged:()=>sr,contentFocus:()=>dk,contentscroll:()=>wr,convertToBlob:()=>gf,count:()=>io,createTable:()=>uo,created:()=>sk,decode:()=>pt,destroy:()=>u,destroyColorPicker:()=>oe,destroyed:()=>hk,dialogClose:()=>ny,dialogOpen:()=>dv,disableFullScreen:()=>tf,dispatchEvent:()=>ir,docClick:()=>fo,drop:()=>ao,dropDownSelect:()=>ci,dynamicModule:()=>ru,editAreaClick:()=>ui,editLink:()=>we,enableFullScreen:()=>nf,enterHandler:()=>ho,execCommandCallBack:()=>he,executeGroup:()=>uk,expandPopupClick:()=>tc,focusChange:()=>dr,getCollection:()=>bf,getDefaultValue:()=>oh,getDropDownValue:()=>yt,getEditValue:()=>df,getFormattedFontSize:()=>uh,getIndex:()=>rh,getLocaleFontFormat:()=>ne,getSelectedHtml:()=>nu,getTBarItemsIndex:()=>kf,getTextNodesUnder:()=>hl,getTooltipText:()=>fh,hasClass:()=>it,htmlKeyConfig:()=>cw,htmlToolbarClick:()=>fe,iframeMouseDown:()=>ni,imageAlt:()=>de,imageBreak:()=>wk,imageCaption:()=>no,imageCenter:()=>pk,imageDelete:()=>ge,imageInline:()=>bk,imageLeft:()=>vk,imageLink:()=>ke,imageRemoving:()=>fy,imageRight:()=>yk,imageSelected:()=>uy,imageSize:()=>to,imageToolbarAction:()=>ce,imageUploadFailed:()=>lo,imageUploadSuccess:()=>co,imageUploading:()=>gi,imgModule:()=>nd,initialEnd:()=>c,initialLoad:()=>or,insertCompleted:()=>vr,insertImage:()=>ar,insertLink:()=>rf,isEditableValueEmpty:()=>nw,isIDevice:()=>o,keyDown:()=>p,keyUp:()=>ct,linkToolbarAction:()=>le,listConversionFilters:()=>wg,load:()=>pv,markdownFormatTags:()=>oa,markdownKeyConfig:()=>lw,markdownListsTags:()=>ha,markdownSelectionTags:()=>sa,markdownToolbarClick:()=>ee,markerClassName:()=>e,modelChanged:()=>a,mouseDown:()=>nt,mouseUp:()=>cr,onResize:()=>ye,openLink:()=>be,pageYOffset:()=>gp,parseHtml:()=>pi,paste:()=>di,pasteClean:()=>so,pasteCleanupGroupingTags:()=>ca,popupHide:()=>td,quickToolbarClose:()=>ry,quickToolbarOpen:()=>iy,readOnlyMode:()=>tu,redo:()=>lk,refreshBegin:()=>ku,renderColorPicker:()=>gu,renderFileManager:()=>of,renderInlineToolbar:()=>ro,resizeInitialized:()=>yo,resizeStart:()=>ve,resizeStop:()=>pe,rtlMode:()=>ii,sanitizeHelper:()=>ll,scroll:()=>li,selectAll:()=>gr,selectRange:()=>ef,selectionCommand:()=>yh,selectionRestore:()=>et,selectionSave:()=>lt,selfClosingTags:()=>la,setAttributes:()=>gh,setToolbarStatus:()=>sl,showImageDialog:()=>bo,showLinkDialog:()=>po,showTableDialog:()=>go,sourceCode:()=>ki,sourceCodeMouseDown:()=>pr,statusCollection:()=>dh,tableColorPickerChanged:()=>kr,tableToolbarAction:()=>eo,toObjectLowerCase:()=>eh,toolbarClick:()=>hr,toolbarCreated:()=>wv,toolbarOpen:()=>kk,toolbarRefresh:()=>ti,toolbarRenderComplete:()=>nc,toolbarUpdated:()=>ht,unLink:()=>uf,undo:()=>ck,updateDropDownFontFormatLocale:()=>al,updateSource:()=>yr,updateTbItemsStatus:()=>sf,updateTextNode:()=>cl,updateToolbarItem:()=>lr,updateUndoRedoStatus:()=>yu,updatedToolbarStatus:()=>bv,windowResize:()=>ae,xhtmlValidation:()=>iu});ue=n(665);const t=ejdashboard.base;var f,y,ri,sk="create",hk="destroy",pv="load",or="initial-load",sr="content-changed",c="initial-end",ni="iframe-click",u="destroy",hr="toolbarClick",ti="toolbar-refresh",ku="refresh-begin",ht="toolbar-updated",du="bind-on-end",gu="render-color-picker",fe="html-toolbar-click",ee="markdown-toolbar-click",oe="destroy-color-picker",a="model-changed",ct="keyUp",p="keyDown",cr="mouseUp",wv="toolbarCreated",nc="toolbarRenderComplete",nf="enableFullScreen",tf="disableFullScreen",ci="dropDownSelect",se="beforeDropDownItemRender",he="execCommandCallBack",ce="image-toolbar-action",le="link-toolbar-action",ae="resize",ve="resizeStart",ye="resizing",pe="resizeStop",ck="undo",lk="redo",rf="insertLink",uf="unLink",we="editLink",be="openLink",k="actionBegin",ft="actionComplete",bv="updatedToolbarStatus",ak="actionSuccess",lr="updateToolbarItem",ar="insertImage",vr="insertCompleted",vk="justifyLeft",yk="justifyRight",pk="justifyCenter",wk="break",bk="inline",ke="insertImgLink",de="imgAltText",ge="delete",no="caption",to="imageSize",ki="sourceCode",yr="updateSource",kk="toolbarOpen",ff="beforeDropDownOpen",lt="selection-save",et="selection-restore",tc="expandPopupClick",io="count",dk="contentFocus",gk="contentBlur",nt="mouseDown",pr="sourceCodeMouseDown",ui="editAreaClick",li="scroll",wr="contentscroll",br="colorPickerChanged",kr="tableColorPickerChanged",dr="focusChange",gr="selectAll",ef="selectRange",nu="getSelectedHtml",ro="renderInlineToolbar",di="paste-content",nd="imageModule",ii="rtl-mode",uo="createTable",fo="docClick",eo="table-toolbar-action",oo="checkUndoStack",tu="readOnlyMode",so="pasteClean",ho="enterHandler",kv="beforeDialogOpen",ai="clearDialogObj",dv="dialogOpen",gv="beforeDialogClose",ny="dialogClose",ty="beforeQuickToolbarOpen",iy="quickToolbarOpen",ry="quickToolbarClose",td="popupHide",uy="imageSelected",gi="imageUploading",co="imageUploadSuccess",lo="imageUploadFailed",fy="imageRemoving",ic="afterImageDelete",ao="drop",iu="xhtmlValidation",vo="beforeImageUpload",yo="resizeInitialized",of="renderFileManager",ey="beforeImageDrop",ru="dynamicModule",oy="beforePasteCleanup",sy="afterPasteCleanup",sf="updateTbItemsStatus",po="showLinkDialog",wo="closeLinkDialog",bo="showImageDialog",ko="closeImageDialog",go="showTableDialog",ns="closeTableDialog",rc="e-richtexteditor",ts="e-rtl",id="e-content",is="e-disabled",uc="rte-iframe-script-sheet",fc="rte-iframe-style-sheet",hf="e-rte-toolbar",ec="e-rte-tb-fixed",rs="e-rte-tb-float",us="e-rte-tb-abs-float",fs="e-rte-inline",rd="e-rte-tb-inline",oc="e-rte-tb-expand",uu="e-rte-full-screen",cf="e-rte-quick-toolbar",sc="e-rte-pop",hy="e-tb-static",cy="e-rte-quick-popup",fi="e-quick-dropdown",ly="e-rte-image-popup",fu="e-rte-inline-popup",es="e-rte-inline-dropdown",tt="e-rte-dropdown-popup",os="e-rte-dropdown-icons",at="e-rte-dropdown-items",w="e-rte-dropdown-btn",hc="e-rte-content",vi="e-toolbar-item",ud="e-toolbar-extended",ss="e-toolbar-wrapper",fd="e-popup",ed="e-separator",od="e-minimize",sd="e-maximize",hd="e-back",cc="e-show",eu="e-hide",lc="e-visible",hs="e-focused",ac="e-remove-white-space",vc="e-imgright",yc="e-imgleft",pc="e-imgcenter",ei="e-imgbreak",oi="e-img-caption",ay="e-rte-img-caption",ou="e-caption-inline",vt="e-imginline",wc="e-rte-character-count",cs="e-warning",ls="e-error",lf="e-icons",su="e-active",yi="e-expand-open",v="e-rte-elements",as="e-tbar-btn",vy="e-rte-horizontal-separator",bc="e-tbar-ios-fixed",vs="e-rte-list-primary-content",yy="e-rte-numberformatlist-dropdown",py="e-rte-bulletformatlist-dropdown",wy="e-formats-tbar-btn",by="e-font-name-tbar-btn",ky="e-font-size-tbar-btn",dy="e-rte-fontcolor-element",gy="e-rte-backgroundcolor-element",hu="e-rte-color-content",np="e-rte-fontcolor-dropdown",tp="e-rte-backgroundcolor-dropdown",ip="e-rte-square-palette",rp="e-rte-fontcolor-colorpicker",up="e-rte-backgroundcolor-colorpicker",cu="e-rte-readonly",si="e-cell-select",nr="e-dashed-border",tr="e-alternate-border",af="e-column-resize",vf="e-row-resize",yf="e-table-box",kc="e-rte-hidden",fp="e-rte-keepformat",ep="e-rte-removeformat",op="e-rte-plainformat",sp="e-rte-pasteok",hp="e-rte-pastecancel",cp="e-rte-dialog-minheight",dc="e-resize-handle",lp="e-south-east",lu="e-rte-image",ap="e-resize",vp="e-img-focus",pf="e-rte-drag-image",gc="e-rte-upload-popup",ys="e-popup-open",yp="e-img-resize",pp="e-droparea",wp="e-img-inner",bp="e-upload-files",nl="e-rte-dialog-upload",tl="e-rte-resize",kp="e-custom-tile",dp="e-nocolor-item",il="e-rte-table",rl="e-rte-table-border",ul="e-rte-table-resize",fl="e-rte-fixed-tb-expand",el="e-rte-toolbar-enabled";!function(n){n[n.Toolbar=0]="Toolbar";n[n.Content=1]="Content";n[n.Popup=2]="Popup";n[n.LinkToolbar=3]="LinkToolbar";n[n.TextToolbar=4]="TextToolbar";n[n.ImageToolbar=5]="ImageToolbar";n[n.InlineToolbar=6]="InlineToolbar";n[n.TableToolbar=7]="TableToolbar"}(f||(f={})),function(n){n.Expand="Expand";n.MultiRow="MultiRow";n.Scrollable="Scrollable"}(y||(y={})),function(n){n.InsertLink="InsertLink";n.InsertImage="InsertImage";n.InsertTable="InsertTable"}(ri||(ri={}));var ol=["alignments","formats","fontname","fontsize","fontcolor","backgroundcolor","align","display","tablerows","tablecolumns","tablecell","tablecellhorizontalalign","tablecellverticalalign","styles","numberformatlist","bulletformatlist"],au={alignments:{id:"Alignments",icon:"e-alignments",tooltip:"Alignments",command:"Alignments",subCommand:"Alignments"},justifyleft:{id:"JustifyLeft",icon:"e-justify-left",tooltip:"JustifyLeft",command:"Alignments",subCommand:"JustifyLeft"},justifycenter:{id:"JustifyCenter",icon:"e-justify-center",tooltip:"JustifyCenter",command:"Alignments",subCommand:"JustifyCenter"},justifyright:{id:"JustifyRight",icon:"e-justify-right",tooltip:"JustifyRight",command:"Alignments",subCommand:"JustifyRight"},justifyfull:{id:"JustifyFull",icon:"e-justify-full",tooltip:"JustifyFull",command:"Alignments",subCommand:"JustifyFull"},fontname:{id:"FontName",icon:"e-font-name",tooltip:"Font Name",command:"Font",subCommand:"FontName"},fontsize:{id:"FontSize",icon:"e-font-size",tooltip:"Font Size",command:"Font",subCommand:"FontSize"},fontcolor:{id:"FontColor",icon:"e-font-color",tooltip:"Font Color",command:"Font",subCommand:"FontColor",value:"#ff0000ff"},backgroundcolor:{id:"BackgroundColor",icon:"e-background-color",tooltip:"Background Color",command:"Font",subCommand:"BackgroundColor",value:"#ffff00ff"},bold:{id:"Bold",icon:"e-bold",tooltip:"Bold",command:"Style",subCommand:"Bold"},italic:{id:"Italic",icon:"e-italic",tooltip:"Italic",command:"Style",subCommand:"Italic"},underline:{id:"Underline",icon:"e-underline",tooltip:"Underline",command:"Style",subCommand:"Underline"},strikethrough:{id:"StrikeThrough",icon:"e-strike-through",tooltip:"StrikeThrough",command:"Style",subCommand:"StrikeThrough"},clearformat:{id:"ClearFormat",icon:"e-clear-format",tooltip:"Clear Format",command:"Clear",subCommand:"ClearFormat"},clearall:{id:"ClearAll",icon:"e-clear-all",tooltip:"Clear All",command:"Clear",subCommand:"ClearAll"},cut:{id:"Cut",icon:"e-cut",tooltip:"Cut",command:"ClipBoard",subCommand:"Cut"},copy:{id:"Copy",icon:"e-copy",tooltip:"Copy",command:"ClipBoard",subCommand:"Copy"},paste:{id:"Paste",icon:"e-paste",tooltip:"Paste",command:"ClipBoard",subCommand:"Paste"},unorderedlist:{id:"UnorderedList",icon:"e-unorder-list",tooltip:"Bulleted List",command:"Lists",subCommand:"UL"},orderedlist:{id:"OrderedList",icon:"e-order-list",tooltip:"Numbered List",command:"Lists",subCommand:"OL"},numberformatlist:{id:"NumberFormatList",icon:"e-order-list",tooltip:"Number Format List",command:"NumberFormatList",subCommand:"NumberFormatList"},bulletformatlist:{id:"BulletFormatList",icon:"e-unorder-list",tooltip:"Bullet Format List",command:"BulletFormatList",subCommand:"BulletFormatList"},indent:{id:"Indent",icon:"e-indent",tooltip:"Increase Indent",command:"Indents",subCommand:"Indent"},outdent:{id:"Outdent",icon:"e-outdent",tooltip:"Decrease Indent",command:"Indents",subCommand:"Outdent"},undo:{id:"Undo",icon:"e-undo",tooltip:"Undo",command:"Actions",subCommand:"Undo"},redo:{id:"Redo",icon:"e-redo",tooltip:"Redo",command:"Actions",subCommand:"Redo"},superscript:{id:"SuperScript",icon:"e-super-script",tooltip:"Superscript",command:"Effects",subCommand:"SuperScript"},subscript:{id:"SubScript",icon:"e-sub-script",tooltip:"Subscript",command:"Effects",subCommand:"SubScript"},createlink:{id:"CreateLink",icon:"e-create-link",tooltip:"Insert Hyperlink",command:"Links",subCommand:"CreateLink"},openlink:{id:"OpenLink",icon:"e-open-link",tooltip:"Open Link",command:"Links",subCommand:"OpenLink"},editlink:{id:"EditLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Links",subCommand:"EditLink"},removelink:{id:"RemoveLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Links",subCommand:"RemoveLink"},image:{id:"Image",icon:"e-image",tooltip:"Insert Image",command:"Images",subCommand:"Image"},filemanager:{id:"FileManager",icon:"e-rte-file-manager",tooltip:"File Manager",command:"Files",subCommand:"File"},createtable:{id:"CreateTable",icon:"e-create-table",tooltip:"Create Table",command:"Table",subCommand:"CreateTable"},removetable:{id:"removeTable",icon:"e-remove-table",tooltip:"Remove Table",command:"removeTable",subCommand:"removeTable"},replace:{id:"Replace",icon:"e-replace",tooltip:"Replace",command:"Images",subCommand:"Replace"},align:{id:"Align",icon:"e-align",tooltip:"Align",command:"Images",subCommand:"Align"},caption:{id:"Caption",icon:"e-caption",tooltip:"Image Caption",command:"Images",subCommand:"Caption"},remove:{id:"Remove",icon:"e-remove",tooltip:"Remove",command:"Images",subCommand:"Remove"},openimagelink:{id:"OpenImageLink",icon:"e-open-link",tooltip:"Open Link",command:"Images",subCommand:"OpenImageLink"},editimagelink:{id:"EditImageLink",icon:"e-edit-link",tooltip:"Edit Link",command:"Images",subCommand:"EditImageLink"},removeimagelink:{id:"RemoveImageLink",icon:"e-remove-link",tooltip:"Remove Link",command:"Images",subCommand:"RemoveImageLink"},insertlink:{id:"InsertLink",icon:"e-insert-link",tooltip:"Insert Link",command:"Images",subCommand:"InsertLink"},display:{id:"Display",icon:"e-display",tooltip:"Display",command:"Images",subCommand:"Display"},alttext:{id:"AltText",icon:"e-alt-text",tooltip:"Alternative Text",command:"Images",subCommand:"AltText"},dimension:{id:"Dimension",icon:"e-img-dimension",tooltip:"Change Size",command:"Images",subCommand:"Dimension"},fullscreen:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"View",subCommand:"Maximize"},maximize:{id:"Maximize",icon:"e-maximize",tooltip:"Maximize",command:"FullScreen",subCommand:"Maximize"},minimize:{id:"Minimize",icon:"e-minimize",tooltip:"Minimize",command:"FullScreen",subCommand:"Minimize"},lowercase:{id:"LowerCase",icon:"e-lower-case",tooltip:"Lower Case",command:"Casing",subCommand:"LowerCase"},uppercase:{id:"UpperCase",icon:"e-upper-case",tooltip:"Upper Case",command:"Casing",subCommand:"UpperCase"},print:{id:"Print",icon:"e-print",tooltip:"Print",command:"Print",subCommand:"Print"},formats:{id:"Formats",icon:"e-formats",tooltip:"Formats",command:"Formats",subCommand:"Formats"},sourcecode:{id:"SourceCode",icon:"e-source-code",tooltip:"Source Code",command:"SourceCode",subCommand:"SourceCode"},preview:{id:"Preview",icon:"e-preview",tooltip:"Preview",command:"Preview",subCommand:"Preview"},viewside:{id:"ViewSide",icon:"e-view-side",tooltip:"ViewSide",command:"ViewSide",subCommand:"ViewSide"},insertcode:{id:"InsertCode",icon:"e-insert-code",tooltip:"Insert Code",command:"Formats",subCommand:"Pre"},tableheader:{id:"TableHeader",icon:"e-table-header",tooltip:"Table Header",command:"Table",subCommand:"TableHeader"},tableremove:{id:"TableRemove",icon:"e-table-remove",tooltip:"Table Remove",command:"Table",subCommand:"TableRemove"},tablerows:{id:"TableRows",icon:"e-table-rows",tooltip:"Table Rows",command:"Table",subCommand:"TableRows"},tablecolumns:{id:"TableColumns",icon:"e-table-columns",tooltip:"Table Columns",command:"Table",subCommand:"TableColumns"},tablecell:{id:"TableCell",icon:"e-table-cell",tooltip:"Table Cell",command:"Table",subCommand:"TableCell"},tablecellbackground:{id:"TableCellBackground",icon:"e-table-cell-background",tooltip:"Table Cell Background",command:"Table",subCommand:"TableCellBackground"},tablecellhorizontalalign:{id:"TableCellHorizontalAlign",icon:"e-table-cell-horizontalAlign",tooltip:"Table Cell HorizontalAlign",command:"Table",subCommand:"TableCellHorizontalAlign"},tablecellverticalalign:{id:"TableCellVerticalAlign",icon:"e-table-cell-verticalAlign",tooltip:"Table Cell VerticalAlign",command:"Table",subCommand:"TableCellVerticalAlign"},tableeditproperties:{id:"TableEditProperties",icon:"e-table-edit-properties",tooltip:"Table Edit Properties",command:"Table",subCommand:"TableEditProperties"},styles:{id:"Styles",icon:"e-table-styles",tooltip:"Styles",command:"Table",subCommand:"Styles"}},cd=[{locale:"alignmentsDropDownLeft",value:"JustifyLeft"},{locale:"alignmentsDropDownCenter",value:"JustifyCenter"},{locale:"alignmentsDropDownRight",value:"JustifyRight"},{locale:"alignmentsDropDownJustify",value:"JustifyFull"}],wf=[{iconCss:"e-icons e-justify-left",text:"Align Left",command:"Alignments",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",text:"Align Center",command:"Alignments",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",text:"Align Right",command:"Alignments",subCommand:"JustifyRight"},{iconCss:"e-icons e-justify-full",text:"Align Justify",command:"Alignments",subCommand:"JustifyFull"}],ld=[{iconCss:"e-icons e-justify-left",command:"Images",subCommand:"JustifyLeft"},{iconCss:"e-icons e-justify-center",command:"Images",subCommand:"JustifyCenter"},{iconCss:"e-icons e-justify-right",command:"Images",subCommand:"JustifyRight"}],ad=[{locale:"imageDisplayDropDownInline",value:"Inline"},{locale:"imageDisplayDropDownBreak",value:"Break"}],ps=[{text:"Inline",cssClass:"e-inline",command:"Images",subCommand:"Inline"},{text:"Break",cssClass:"e-break",command:"Images",subCommand:"Break"}],vd=[{iconCss:"e-icons e-cell-merge",text:"Merge cells",command:"Table",subCommand:"Merge"},{iconCss:"e-icons e-cell-horizontal-split",text:"Horizontal split",command:"Table",subCommand:"HorizontalSplit"},{iconCss:"e-icons e-cell-vertical-split",text:"Vertical split",command:"Table",subCommand:"VerticalSplit"}],yd=[{locale:"tableInsertRowDropDownBefore",value:"InsertRowBefore"},{locale:"tableInsertRowDropDownAfter",value:"InsertRowAfter"},{locale:"tableInsertRowDropDownDelete",value:"DeleteRow"}],ws=[{iconCss:"e-icons e-insert-row-before",text:"Insert row before",command:"Table",subCommand:"InsertRowBefore"},{iconCss:"e-icons e-insert-row-after",text:"Insert row after",command:"Table",subCommand:"InsertRowAfter"},{iconCss:"e-icons e-delete-row",text:"Delete row",command:"Table",subCommand:"DeleteRow"}],pd=[{locale:"tableInsertColumnDropDownLeft",value:"InsertColumnLeft"},{locale:"tableInsertColumnDropDownRight",value:"InsertColumnRight"},{locale:"tableInsertColumnDropDownDelete",value:"DeleteColumn"}],bs=[{iconCss:"e-icons e-insert-column-left",text:"Insert column left",command:"Table",subCommand:"InsertColumnLeft"},{iconCss:"e-icons e-insert-column-right",text:"Insert column right",command:"Table",subCommand:"InsertColumnRight"},{iconCss:"e-icons e-delete-column",text:"Delete column",command:"Table",subCommand:"DeleteColumn"}],wd=[{locale:"tableVerticalAlignDropDownTop",value:"AlignTop"},{locale:"tableVerticalAlignDropDownMiddle",value:"AlignMiddle"},{locale:"tableVerticalAlignDropDownBottom",value:"AlignBottom"}],ks=[{iconCss:"e-icons e-align-top",text:"Align Top",command:"Table",subCommand:"AlignTop"},{iconCss:"e-icons e-align-middle",text:"Align Middle",command:"Table",subCommand:"AlignMiddle"},{iconCss:"e-icons e-align-bottom",text:"Align Bottom",command:"Table",subCommand:"AlignBottom"}],bd=[{locale:"tableStylesDropDownDashedBorder",value:"Dashed"},{locale:"tableStylesDropDownAlternateRows",value:"Alternate"}],ds=[{text:"Dashed Borders",cssClass:"e-dashed-borders",command:"Table",subCommand:"Dashed"},{text:"Alternate Rows",cssClass:"e-alternate-rows",command:"Table",subCommand:"Alternate"}],kd=["Bold","Italic","Underline","|","Formats","Alignments","OrderedList","UnorderedList","|","CreateLink","Image","|","SourceCode","Undo","Redo"],gs=[{cssClass:"e-segoe-ui",text:"Segoe UI",command:"Font",subCommand:"FontName",value:"Segoe UI"},{cssClass:"e-arial",text:"Arial",command:"Font",subCommand:"FontName",value:"Arial,Helvetica,sans-serif"},{cssClass:"e-georgia",text:"Georgia",command:"Font",subCommand:"FontName",value:"Georgia,serif"},{cssClass:"e-impact",text:"Impact",command:"Font",subCommand:"FontName",value:"Impact,Charcoal,sans-serif"},{cssClass:"e-tahoma",text:"Tahoma",command:"Font",subCommand:"FontName",value:"Tahoma,Geneva,sans-serif"},{cssClass:"e-times-new-roman",text:"Times New Roman",command:"Font",subCommand:"FontName",value:"Times New Roman,Times,serif"},{cssClass:"e-verdana",text:"Verdana",command:"Font",subCommand:"FontName",value:"Verdana,Geneva,sans-serif"}],dd=[{text:"8 pt",value:"8pt"},{text:"10 pt",value:"10pt"},{text:"12 pt",value:"12pt"},{text:"14 pt",value:"14pt"},{text:"18 pt",value:"18pt"},{text:"24 pt",value:"24pt"},{text:"36 pt",value:"36pt"}],nh=[{cssClass:"e-paragraph",text:"Paragraph",command:"Formats",subCommand:"P",value:"P"},{cssClass:"e-code",text:"Code",command:"Formats",subCommand:"Pre",value:"Pre"},{cssClass:"e-quote",text:"Quotation",command:"Formats",subCommand:"BlockQuote",value:"BlockQuote"},{cssClass:"e-h1",text:"Heading 1",command:"Formats",subCommand:"H1",value:"H1"},{cssClass:"e-h2",text:"Heading 2",command:"Formats",subCommand:"H2",value:"H2"},{cssClass:"e-h3",text:"Heading 3",command:"Formats",subCommand:"H3",value:"H3"},{cssClass:"e-h4",text:"Heading 4",command:"Formats",subCommand:"H4",value:"H4"}],gd={Custom:["","#000000","#e7e6e6","#44546a","#4472c4","#ed7d31","#a5a5a5","#ffc000","#70ad47","#ff0000","#f2f2f2","#808080","#cfcdcd","#d5dce4","#d9e2f3","#fbe4d5","#ededed","#fff2cc","#e2efd9","#ffcccc","#d9d9d9","#595959","#aeaaaa","#acb9ca","#b4c6e7","#f7caac","#dbdbdb","#ffe599","#c5e0b3","#ff8080","#bfbfbf","#404040","#747070","#8496b0","#8eaadb","#f4b083","#c9c9c9","#ffd966","#a8d08d","#ff3333","#a6a6a6","#262626","#3b3838","#323e4f","#2f5496","#c45911","#7b7b7b","#bf8f00","#538135","#b30000","#7f7f7f","#0d0d0d","#161616","#212934","#1f3763","#823b0b","#525252","#7f5f00","#375623","#660000"]},ng={Custom:["","#000000","#ffff00","#00ff00","#00ffff","#0000ff","#ff0000","#000080","#800080","#996633","#f2f2f2","#808080","#ffffcc","#b3ffb3","#ccffff","#ccccff","#ffcccc","#ccccff","#ff80ff","#f2e6d9","#d9d9d9","#595959","#ffff80","#80ff80","#b3ffff","#8080ff","#ff8080","#8080ff","#ff00ff","#dfbf9f","#bfbfbf","#404040","#ffff33","#33ff33","#33ffff","#3333ff","#ff3333","#0000b3","#b300b3","#c68c53","#a6a6a6","#262626","#e6e600","#00b300","#009999","#000099","#b30000","#000066","#660066","#86592d","#7f7f7f","#0d0d0d","#999900","#006600","#006666","#000066","#660000","#00004d","#4d004d","#734d26"]},th=[{text:"None",command:"Lists",subCommand:"NumberFormatList",value:"none"},{text:"Number",command:"Lists",subCommand:"NumberFormatList",value:"decimal"},{text:"Lower Greek",command:"Lists",subCommand:"NumberFormatList",value:"lowerGreek"},{text:"Lower Roman",command:"Lists",subCommand:"NumberFormatList",value:"lowerRoman"},{text:"Upper Alpha",command:"Lists",subCommand:"NumberFormatList",value:"upperAlpha"},{text:"Lower Alpha",command:"Lists",subCommand:"NumberFormatList",value:"lowerAlpha"},{text:"Upper Roman",command:"Lists",subCommand:"NumberFormatList",value:"upperRoman"}],ih=[{text:"None",command:"Lists",subCommand:"BulletFormatList",value:"none"},{text:"Disc",command:"Lists",subCommand:"BulletFormatList",value:"disc"},{text:"Circle",command:"Lists",subCommand:"BulletFormatList",value:"circle"},{text:"Square",command:"Lists",subCommand:"BulletFormatList",value:"square"}];var tg={alignments:"Alignments",justifyLeft:"Align Left",justifyCenter:"Align Center",justifyRight:"Align Right",justifyFull:"Align Justify",fontName:"Font Name",fontSize:"Font Size",fontColor:"Font Color",backgroundColor:"Background Color",bold:"Bold",italic:"Italic",underline:"Underline",strikethrough:"Strikethrough",clearFormat:"Clear Format",clearAll:"Clear All",cut:"Cut",copy:"Copy",paste:"Paste",unorderedList:"Bulleted List",orderedList:"Numbered List",indent:"Increase Indent",outdent:"Decrease Indent",undo:"Undo",redo:"Redo",superscript:"Superscript",subscript:"Subscript",createLink:"Insert Link",openLink:"Open Link",editLink:"Edit Link",removeLink:"Remove Link",image:"Insert Image",replace:"Replace",align:"Align",caption:"Image Caption",remove:"Remove",insertLink:"Insert Link",display:"Display",altText:"Alternative Text",dimension:"Change Size",fullscreen:"Maximize",maximize:"Maximize",minimize:"Minimize",lowerCase:"Lower Case",upperCase:"Upper Case",print:"Print",formats:"Formats",sourcecode:"Code View",preview:"Preview",viewside:"ViewSide",insertCode:"Insert Code",linkText:"Display Text",linkTooltipLabel:"Title",linkWebUrl:"Web Address",linkTitle:"Enter a title",linkurl:"http://example.com",linkOpenInNewWindow:"Open Link in New Window",linkHeader:"Insert Link",dialogInsert:"Insert",dialogCancel:"Cancel",dialogUpdate:"Update",imageHeader:"Insert Image",imageLinkHeader:"You can also provide a link from the web",mdimageLink:"Please provide a URL for your image",imageUploadMessage:"Drop image here or browse to upload",imageDeviceUploadMessage:"Click here to upload",imageAlternateText:"Alternate Text",alternateHeader:"Alternative Text",browse:"Browse",imageUrl:"http://example.com/image.png",imageCaption:"Caption",imageSizeHeader:"Image Size",imageHeight:"Height",imageWidth:"Width",textPlaceholder:"Enter Text",inserttablebtn:"Insert Table",tabledialogHeader:"Insert Table",tableWidth:"Width",cellpadding:"Cell Padding",cellspacing:"Cell Spacing",columns:"Number of columns",rows:"Number of rows",tableRows:"Table Rows",tableColumns:"Table Columns",tableCellHorizontalAlign:"Table Cell Horizontal Align",tableCellVerticalAlign:"Table Cell Vertical Align",createTable:"Create Table",removeTable:"Remove Table",tableHeader:"Table Header",tableRemove:"Table Remove",tableCellBackground:"Table Cell Background",tableEditProperties:"Table Edit Properties",styles:"Styles",insertColumnLeft:"Insert Column Left",insertColumnRight:"Insert Column Right",deleteColumn:"Delete Column",insertRowBefore:"Insert Row Before",insertRowAfter:"Insert Row After",deleteRow:"Delete Row",tableEditHeader:"Edit Table",TableHeadingText:"Heading",TableColText:"Col",imageInsertLinkHeader:"Insert Link",editImageHeader:"Edit Image",alignmentsDropDownLeft:"Align Left",alignmentsDropDownCenter:"Align Center",alignmentsDropDownRight:"Align Right",alignmentsDropDownJustify:"Align Justify",imageDisplayDropDownInline:"Inline",imageDisplayDropDownBreak:"Break",tableInsertRowDropDownBefore:"Insert row before",tableInsertRowDropDownAfter:"Insert row after",tableInsertRowDropDownDelete:"Delete row",tableInsertColumnDropDownLeft:"Insert column left",tableInsertColumnDropDownRight:"Insert column right",tableInsertColumnDropDownDelete:"Delete column",tableVerticalAlignDropDownTop:"Align Top",tableVerticalAlignDropDownMiddle:"Align Middle",tableVerticalAlignDropDownBottom:"Align Bottom",tableStylesDropDownDashedBorder:"Dashed Borders",tableStylesDropDownAlternateRows:"Alternate Rows",pasteFormat:"Paste Format",pasteFormatContent:"Choose the formatting action",plainText:"Plain Text",cleanFormat:"Clean",keepFormat:"Keep",pasteDialogOk:"OK",pasteDialogCancel:"Cancel",fileManager:"File Manager",fileDialogHeader:"File Browser",formatsDropDownParagraph:"Paragraph",formatsDropDownCode:"Code",formatsDropDownQuotation:"Quotation",formatsDropDownHeading1:"Heading 1",formatsDropDownHeading2:"Heading 2",formatsDropDownHeading3:"Heading 3",formatsDropDownHeading4:"Heading 4",fontNameSegoeUI:"Segoe UI",fontNameArial:"Arial",fontNameGeorgia:"Georgia",fontNameImpact:"Impact",fontNameTahoma:"Tahoma",fontNameTimesNewRoman:"Times New Roman",fontNameVerdana:"Verdana",numberFormatListNumber:"Number",numberFormatListLowerAlpha:"LowerAlpha",numberFormatListUpperAlpha:"UpperAlpha",numberFormatListLowerRoman:"LowerRoman",numberFormatListUpperRoman:"UpperRoman",numberFormatListLowerGreek:"LowerGreek",bulletFormatListDisc:"Disc",bulletFormatListCircle:"Circle",bulletFormatListSquare:"Square",numberFormatListNone:"None",bulletFormatListNone:"None"},ig={alignments:"alignments",justifyleft:"justifyLeft",justifycenter:"justifyCenter",justifyright:"justifyRight",justifyfull:"justifyFull",fontname:"fontName",fontsize:"fontSize",fontcolor:"fontColor",backgroundcolor:"backgroundColor",bold:"bold",italic:"italic",underline:"underline",strikethrough:"strikethrough",clearformat:"clearFormat",clearall:"clearAll",cut:"cut",copy:"copy",paste:"paste",unorderedlist:"unorderedList",orderedlist:"orderedList",indent:"indent",outdent:"outdent",undo:"undo",redo:"redo",superscript:"superscript",subscript:"subscript",createlink:"createLink",openlink:"openLink",editlink:"editLink",removelink:"removeLink",openimagelink:"openLink",editimagelink:"editLink",removeimagelink:"removeLink",image:"image",replace:"replace",align:"align",caption:"caption",remove:"remove",insertlink:"insertLink",display:"display",alttext:"altText",dimension:"dimension",fullscreen:"fullscreen",maximize:"maximize",minimize:"minimize",lowercase:"lowerCase",uppercase:"upperCase",print:"print",formats:"formats",sourcecode:"sourcecode",preview:"preview",viewside:"viewside",insertcode:"insertCode",tablerows:"tableRows",tablecolumns:"tableColumns",tablecellhorizontalalign:"tableCellHorizontalAlign",tablecellverticalalign:"tableCellVerticalAlign",createtable:"createTable",removetable:"removeTable",tableheader:"tableHeader",tableremove:"tableRemove",tablecellbackground:"tableCellBackground",tableeditproperties:"tableEditProperties",styles:"styles",insertcolumnleft:"insertColumnLeft",insertcolumnright:"insertColumnRight",deletecolumn:"deleteColumn",aligntop:"AlignTop",alignmiddle:"AlignMiddle",alignbottom:"AlignBottom",insertrowbefore:"insertRowBefore",insertrowafter:"insertRowAfter",deleterow:"deleteRow"},rg=[{locale:"fontNameSegoeUI",value:"Segoe UI"},{locale:"fontNameArial",value:"Arial,Helvetica,sans-serif"},{locale:"fontNameGeorgia",value:"Georgia,serif"},{locale:"fontNameImpact",value:"Impact,Charcoal,sans-serif"},{locale:"fontNameTahoma",value:"Tahoma,Geneva,sans-serif"},{locale:"fontNameTimesNewRoman",value:"Times New Roman,Times,serif"},{locale:"fontNameVerdana",value:"Verdana,Geneva,sans-serif"}],ug=[{locale:"formatsDropDownParagraph",value:"P"},{locale:"formatsDropDownCode",value:"Pre"},{locale:"formatsDropDownQuotation",value:"BlockQuote"},{locale:"formatsDropDownHeading1",value:"H1"},{locale:"formatsDropDownHeading2",value:"H2"},{locale:"formatsDropDownHeading3",value:"H3"},{locale:"formatsDropDownHeading4",value:"H4"}],fg=[{locale:"numberFormatListNone",value:"none"},{locale:"numberFormatListNumber",value:"decimal"},{locale:"numberFormatListLowerAlpha",value:"lower-alpha"},{locale:"numberFormatListUpperAlpha",value:"upper-alpha"},{locale:"numberFormatListLowerRoman",value:"lower-roman"},{locale:"numberFormatListUpperRoman",value:"upper-roman"},{locale:"numberFormatListLowerGreek",value:"lower-greek"}],eg=[{locale:"bulletFormatListNone",value:"none"},{locale:"bulletFormatListDisc",value:"disc"},{locale:"bulletFormatListCircle",value:"circle"},{locale:"bulletFormatListSquare",value:"square"}],og=["Undo","Redo"],sg=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];const hg=ejdashboard.navigations,vl=ejdashboard.splitbuttons,ot=ejdashboard.popups,st=ejdashboard.inputs;var sh,tw=function(){function n(n){this.parent=n;this.wireEvent()}return n.prototype.wireEvent=function(){this.parent.on(u,this.unWireEvent,this)},n.prototype.unWireEvent=function(){this.parent.off(u,this.unWireEvent);this.popupOverlay&&t.EventHandler.remove(this.popupOverlay,"click touchmove",this.onPopupOverlay);this.removePopupContainer()},n.prototype.toolbarBeforeCreate=function(n){"Extended"===this.mode&&(n.enableCollision=!1)},n.prototype.toolbarCreated=function(){this.parent.notify(wv,this)},n.prototype.toolbarClicked=function(n){this.parent.enabled&&(this.parent.readonly&&!t.isNullOrUndefined(n.item)||this.parent.notify(hr,n),this.parent.trigger("toolbarClick",n))},n.prototype.dropDownSelected=function(n){this.parent.notify(ci,n);this.onPopupOverlay()},n.prototype.beforeDropDownItemRender=function(n){!this.parent.readonly&&this.parent.enabled&&this.parent.notify(se,n)},n.prototype.dropDownOpen=function(n){if(n.element.parentElement.getAttribute("id").indexOf("TableCell")>-1&&!t.isNullOrUndefined(n.element.parentElement.querySelector(".e-cell-merge"))&&(!t.isNullOrUndefined(n.element.parentElement.querySelector(".e-cell-horizontal-split"))||!t.isNullOrUndefined(n.element.parentElement.querySelector(".e-cell-vertical-split")))){var i=n.element.querySelectorAll("li");1===this.parent.inputElement.querySelectorAll(".e-cell-select").length?(t.addClass([i[0]],"e-disabled"),t.removeClass([i[1],i[2]],"e-disabled")):this.parent.inputElement.querySelectorAll(".e-cell-select").length>1&&(t.removeClass([i[0]],"e-disabled"),t.addClass([i[1],i[2]],"e-disabled"))}t.Browser.isDevice&&!n.element.parentElement.classList.contains(fi)&&this.popupModal(n.element.parentElement);this.parent.notify(lt,n)},n.prototype.dropDownClose=function(n){this.removePopupContainer();this.parent.notify(et,n)},n.prototype.removePopupContainer=function(){if(t.Browser.isDevice&&!t.isNullOrUndefined(this.popupContainer)){var n=this.popupContainer.querySelector(".e-dropdown-popup.e-tbar-btn.e-control");n&&(this.popupContainer.parentNode.insertBefore(n,this.popupContainer.nextSibling),n.style.removeProperty("position"),t.removeClass([n],"e-popup-modal"));t.detach(this.popupContainer);this.popupContainer=void 0}},n.prototype.renderToolbar=function(n){this.setPanel(n.target);this.renderPanel();this.mode=n.overflowMode;n.rteToolbarObj.toolbarObj=new hg.Toolbar({items:n.items,width:"100%",overflowMode:n.overflowMode,beforeCreate:this.toolbarBeforeCreate.bind(this),created:this.toolbarCreated.bind(this),clicked:this.toolbarClicked.bind(this),enablePersistence:n.enablePersistence,enableRtl:n.enableRtl});n.rteToolbarObj.toolbarObj.isStringTemplate=!0;n.rteToolbarObj.toolbarObj.createElement=this.parent.createElement;n.rteToolbarObj.toolbarObj.appendTo(n.target)},n.prototype.renderDropDownButton=function(n){var u,f=this,r,i;return n.element.classList.add(w),u=n.cssClass+" "+v+" "+as,this.parent.inlineMode.enable&&t.Browser.isDevice&&(u=u+" "+es),r=this,i=new vl.DropDownButton({items:n.items,iconCss:n.iconCss,cssClass:u,content:n.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(n){var u,e;if(!r.parent.readonly&&r.parent.enabled){for(u=0;u<n.element.childNodes.length;u++)e=f.parent.createElement("div"),e.innerHTML=i.content.trim(),""!==e.textContent.trim()&&n.element.childNodes[u].textContent.trim()===e.textContent.trim()?n.element.childNodes[u].classList.contains("e-active")||t.addClass([n.element.childNodes[u]],"e-active"):t.removeClass([n.element.childNodes[u]],"e-active");r.parent.notify(ff,n)}else n.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)}),i.isStringTemplate=!0,i.createElement=r.parent.createElement,i.appendTo(n.element),n.element.tabIndex=-1,document.getElementById(i.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),i},n.prototype.renderListDropDown=function(n){var i=this,u=v+" "+as+(this.parent.inlineMode?" "+es:""),r,f,t;return u+=" "+("NumberFormatList"===n.itemName?yy:py),r=i.parent.createElement("span",{className:vs}),f=i.parent.createElement("span",{className:n.cssClass}),r.appendChild(f),t=new vl.DropDownButton({items:n.items,cssClass:u,content:n.content,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,select:this.dropDownSelected.bind(this),beforeOpen:function(n){if(!i.parent.readonly&&i.parent.enabled){var r=n.event?n.event.target:null;i.currentElement=t.element;i.currentDropdown=t;n.event&&"click"===n.event.type&&(r.classList.contains(vs)||r.parentElement.classList.contains(vs))?n.cancel=!0:i.parent.notify(ff,n)}else n.cancel=!0},close:this.dropDownClose.bind(this),open:this.dropDownOpen.bind(this),beforeItemRender:this.beforeDropDownItemRender.bind(this)}),t.isStringTemplate=!0,t.createElement=i.parent.createElement,t.appendTo(n.element),n.element.tabIndex=-1,document.getElementById(t.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),1===n.element.childElementCount&&t.element.insertBefore(r,t.element.querySelector(".e-caret")),n.element.tabIndex=-1,t.element.removeAttribute("type"),t},n.prototype.onPopupOverlay=function(){t.isNullOrUndefined(this.popupOverlay)||(t.closest(this.popupOverlay,".e-popup-container").style.display="none",this.popupOverlay.style.display="none",t.removeClass([this.popupOverlay],"e-popup-overlay"))},n.prototype.setIsModel=function(n){t.closest(n,".e-popup-container")?(n.parentElement.style.display="flex",this.popupOverlay=n.nextElementSibling,this.popupOverlay.style.display="block",t.addClass([this.popupOverlay],"e-popup-overlay")):(this.popupContainer=this.parent.createElement("div",{className:"e-rte-modal-popup e-popup-container e-center"}),n.parentNode.insertBefore(this.popupContainer,n),this.popupContainer.appendChild(n),this.popupContainer.style.zIndex=n.style.zIndex,this.popupContainer.style.display="flex",n.style.position="relative",t.addClass([n],"e-popup-modal"),this.popupOverlay=this.parent.createElement("div",{className:"e-popup-overlay"}),this.popupOverlay.style.zIndex=(parseInt(n.style.zIndex,null)-1).toString(),this.popupOverlay.style.display="block",this.popupContainer.appendChild(this.popupOverlay),t.EventHandler.add(this.popupOverlay,"click touchmove",this.onPopupOverlay,this))},n.prototype.paletteSelection=function(n,i){var f=n.element.querySelector(".e-control.e-colorpicker"),r=[].slice.call(t.selectAll(".e-tile",f.parentElement)),u;t.removeClass(r,"e-selected");u=i.querySelector("."+v).style.borderBottomColor;r.filter(function(n){n.style.backgroundColor===u&&t.addClass([n],"e-selected")})},n.prototype.renderColorPickerDropDown=function(n,i,r,u){var s=this,f=this,h=v+" "+as+(this.parent.inlineMode?" "+es:""),e;h+=" "+("backgroundcolor"===i?tp:np);var o,c=f.parent.createElement("span",{className:hu}),l=f.parent.createElement("span",{className:n.cssClass}),a=t.isNullOrUndefined(u)?f.parent.backgroundColor.default:u;return l.style.borderBottomColor="backgroundcolor"===i?a:f.parent.fontColor.default,c.appendChild(l),e=new vl.DropDownButton({target:r.element.parentElement,cssClass:h,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,beforeOpen:function(i){var r,u,h,c,s;!f.parent.readonly&&f.parent.enabled?(r=i.event?i.event.target:null,(f.currentElement=e.element,f.currentDropdown=e,f.paletteSelection(i,f.currentElement),i.event&&"click"===i.event.type&&(r.classList.contains(hu)||r.parentElement.classList.contains(hu)))?(i.cancel=!0,u=r.classList.contains(v)?r.style.borderBottomColor:r.querySelector("."+v).style.borderBottomColor,f.parent.notify(et,{}),h=(o=f.parent.formatter.editorManager.nodeSelection.getRange(f.parent.contentModule.getDocument())).startContainer.parentNode,("TD"===o.startContainer.nodeName||"TH"===o.startContainer.nodeName||t.closest(o.startContainer.parentNode,"td,th")||f.parent.iframeSettings.enable&&!it(h.ownerDocument.querySelector("body"),"e-lib"))&&o.collapsed&&"BackgroundColor"===n.subCommand?f.parent.notify(kr,{item:{command:n.command,subCommand:n.subCommand,value:u}}):f.parent.notify(br,{item:{command:n.command,subCommand:n.subCommand,value:u}})):(c=i.element.querySelector(".e-control.e-colorpicker"),s=t.getInstance(c,st.ColorPicker),s.showButtons=!i.element.querySelector(".e-color-palette"),s.dataBind(),i.element.onclick=function(n){n.target.classList.contains("e-cancel")&&e.toggle()})):i.cancel=!0},open:function(n){var u,i;s.setColorPickerContentWidth(r);i=n.element.querySelector(".e-control.e-colorpicker");(u=n.element.querySelector(".e-color-palette")?i.parentElement.querySelector(".e-palette"):i.parentElement.querySelector("e-handler"))&&u.focus();t.Browser.isDevice&&s.popupModal(n.element.parentElement);s.pickerRefresh(n)},beforeClose:function(i){var r=i.event?i.event.target:null,u;i.event&&"click"===i.event.type&&(r.classList.contains(hu)||r.parentElement.classList.contains(hu))&&(u=r.classList.contains(v)?r.style.borderBottomColor:r.querySelector("."+v).style.borderBottomColor,("TD"===(o=f.parent.formatter.editorManager.nodeSelection.getRange(f.parent.contentModule.getDocument())).startContainer.nodeName||"TH"===o.startContainer.nodeName||t.closest(o.startContainer.parentNode,"td,th"))&&o.collapsed?f.parent.notify(kr,{item:{command:n.command,subCommand:n.subCommand,value:u}}):f.parent.notify(br,{item:{command:n.command,subCommand:n.subCommand,value:u}}))},close:function(n){var i,r;f.parent.notify(et,{});i=t.closest(n.element.parentElement,".e-popup-container");(i&&(i.style.display="none",i.lastElementChild.style.display="none",t.removeClass([i.lastElementChild],"e-popup-overlay")),t.Browser.isDevice&&!t.isNullOrUndefined(i))&&(r=i.querySelector(".e-dropdown-popup.e-tbar-btn.e-control"),r&&(i.parentNode.insertBefore(r,i.nextSibling),r.style.removeProperty("position"),t.removeClass([r],"e-popup-modal")),t.detach(i),f.popupContainer=void 0)}}),e.isStringTemplate=!0,e.createElement=f.parent.createElement,n.element.setAttribute("role","button"),e.appendTo(n.element),document.getElementById(e.element.id+"-popup").setAttribute("aria-owns",this.parent.getID()),e.element.insertBefore(c,e.element.querySelector(".e-caret")),n.element.tabIndex=-1,e.element.removeAttribute("type"),e.element.onmousedown=function(){f.parent.notify(lt,{})},e.element.onkeydown=function(){f.parent.notify(lt,{})},e},n.prototype.pickerRefresh=function(n){if("Picker"===this.parent.backgroundColor.mode){var i=n.element.parentElement;i.style.width=(i.offsetWidth+5).toString()+"px";t.getInstance(i,ot.Popup).refreshPosition(i);i.style.width=(i.offsetWidth-5).toString()+"px"}},n.prototype.popupModal=function(n){var i=t.getInstance(n,ot.Popup);i.relateTo=document.body;i.position={X:0,Y:0};i.targetType="container";i.collision={X:"fit",Y:"fit"};i.offsetY=4;i.dataBind();this.setIsModel(n)},n.prototype.setColorPickerContentWidth=function(n){var i=n.element.nextSibling,r;"0px"===i.style.width&&(i.style.width="",r=parseInt(getComputedStyle(i).borderBottomWidth,10),i.style.width=t.formatUnit(i.children[0].offsetWidth+r+r))},n.prototype.renderColorPicker=function(n,i){var r=this,u=new st.ColorPicker({enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl,inline:!0,value:"#fff",created:function(){var n="backgroundcolor"===i?r.parent.backgroundColor.default:r.parent.fontColor.default;u.setProperties({value:n})},mode:"backgroundcolor"===i?r.parent.backgroundColor.mode:r.parent.fontColor.mode,modeSwitcher:"backgroundcolor"===i?r.parent.backgroundColor.modeSwitcher:r.parent.fontColor.modeSwitcher,beforeTileRender:function(n){n.element.classList.add(ip);n.element.classList.add(kp);""===n.value&&n.element.classList.add(dp)},change:function(i){var f=i.currentValue.rgba,u;i.item={command:n.command,subCommand:n.subCommand,value:f};r.parent.notify(et,{});r.currentElement.querySelector("."+v).style.borderBottomColor=f;u=r.parent.formatter.editorManager.nodeSelection.getRange(r.parent.contentModule.getDocument());("TD"===u.startContainer.nodeName||"TH"===u.startContainer.nodeName||"BODY"===u.startContainer.nodeName||t.closest(u.startContainer.parentNode,"td,th"))&&u.collapsed&&"BackgroundColor"===n.subCommand?r.parent.notify(kr,i):r.parent.notify(br,i);r.currentDropdown.toggle()},beforeModeSwitch:function(n){""===u.value&&u.setProperties({value:"Picker"===n.mode?"#008000ff":""},!0);u.showButtons="Palette"!==n.mode}});return u.isStringTemplate=!0,u.columns="backgroundcolor"===i?this.parent.backgroundColor.columns:this.parent.fontColor.columns,u.presetColors="backgroundcolor"===i?this.parent.backgroundColor.colorCode:this.parent.fontColor.colorCode,u.cssClass="backgroundcolor"===i?up:rp,u.createElement=this.parent.createElement,u.appendTo(document.getElementById(n.target)),u},n.prototype.renderPanel=function(){this.getPanel().classList.add(hf)},n.prototype.getPanel=function(){return this.toolbarPanel},n.prototype.setPanel=function(n){this.toolbarPanel=n},n}(),yl=function(){function n(n,i){this.tools={};this.parent=n;this.locator=i;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,au,eh(this.parent.toolbarSettings.itemConfigs),!0):this.tools=au}return n.prototype.addEventListener=function(){this.parent.on(ii,this.setRtl,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(ii,this.setRtl);this.parent.off(u,this.removeEventListener)},n.prototype.setRtl=function(n){t.isNullOrUndefined(this.toolbarObj)||this.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.getClass=function(n){var t;switch(n){case"fontsize":t="e-rte-inline-size-template";break;case"fontcolor":case"backgroundcolor":t="e-rte-inline-color-template";break;default:t="e-rte-inline-template"}return t},n.prototype.getTemplateObject=function(n,t){var i;switch(n){case"fontcolor":case"backgroundcolor":case"numberformatlist":case"bulletformatlist":i="span";break;default:i="button"}return{command:this.tools[n.toLocaleLowerCase()].command,subCommand:this.tools[n.toLocaleLowerCase()].subCommand,template:this.parent.createElement(i,{id:this.parent.getID()+"_"+t+"_"+this.tools[n.toLocaleLowerCase()].id}).outerHTML,cssClass:this.parent.inlineMode.enable?this.getClass(n):"",tooltipText:fh(n,this.locator)}},n.prototype.getObject=function(n,t){var i=n.toLowerCase();if(-1!==ol.indexOf(i))return this.getTemplateObject(i,t);switch(i){case"|":return{type:"Separator"};case"-":return{type:"Separator",cssClass:vy};default:return{id:this.parent.getID()+"_"+t+"_"+this.tools[i.toLocaleLowerCase()].id,prefixIcon:this.tools[i.toLocaleLowerCase()].icon,tooltipText:fh(i,this.locator),command:this.tools[i.toLocaleLowerCase()].command,subCommand:this.tools[i.toLocaleLowerCase()].subCommand}}},n.prototype.getItems=function(n,i){var r=this;if(this.parent.toolbarSettings.items.length<1)return[];for(var u=[],o=function(n){if("string"==typeof n)u.push(s.getObject(n,i));else{if(!t.isNullOrUndefined(n.click)){var f=n,e=f.click;f.click=function(){f.undo&&0===r.parent.formatter.getUndoRedoStack().length&&r.parent.formatter.saveData();e.call(r);r.parent.formatter.getUndoRedoStack()[r.parent.formatter.getUndoRedoStack().length-1].text.trim()!==r.parent.inputElement.innerHTML.trim()&&f.undo&&r.parent.formatter.saveData()}}u.push(n)}},s=this,f=0,e=n;f<e.length;f++)o(e[f]);return u},n.prototype.getToolbarOptions=function(n){return{target:n.target,rteToolbarObj:this,items:this.getItems(n.items,n.container),overflowMode:n.mode,enablePersistence:this.parent.enablePersistence,enableRtl:this.parent.enableRtl}},n.prototype.render=function(n){this.toolbarRenderer=this.renderFactory.getRenderer(f.Toolbar);this.toolbarRenderer.renderToolbar(this.getToolbarOptions(n))},n}(),pl=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(f.Toolbar)},n.prototype.beforeRender=function(n){var i=n.item;i.cssClass&&t.addClass([n.element],i.cssClass);"Alignments"!==i.command&&"JustifyLeft"!==i.subCommand&&"JustifyRight"!==i.subCommand&&"JustifyCenter"!==i.subCommand||n.element.setAttribute("title",fh(i.subCommand.toLocaleLowerCase(),this.locator))},n.prototype.dropdownContent=function(n,t,i){return'<span style="display: inline-flex;width:'+("quick"===t?"auto":n)+'" ><span class="e-rte-dropdown-btn-text">'+i+"<\/span><\/span>"},n.prototype.renderDropDowns=function(n){var i=this,r,u;this.initializeInstance();r=n.containerType;u=n.container;ol.forEach(function(f){var e=void 0,c,l,o,a,s,y,h,p;if(-1!==rh(f,n.items))switch(f){case"numberformatlist":if(e=t.select("#"+i.parent.getID()+"_"+r+"_NumberFormatList",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;c=i.parent.numberFormatList.types.slice();c.forEach(function(n){Object.defineProperties(n,{command:{value:"Lists",enumerable:!0},subCommand:{value:"NumberFormatList",enumerable:!0}})});i.numberFormatListDropDown=i.toolbarRenderer.renderListDropDown({cssClass:"e-order-list "+v+" "+lf,itemName:"NumberFormatList",items:c,element:e});break;case"bulletformatlist":if(e=t.select("#"+i.parent.getID()+"_"+r+"_BulletFormatList",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;l=i.parent.bulletFormatList.types.slice();l.forEach(function(n){Object.defineProperties(n,{command:{value:"Lists",enumerable:!0},subCommand:{value:"BulletFormatList",enumerable:!0}})});i.bulletFormatListDropDown=i.toolbarRenderer.renderListDropDown({cssClass:"e-unorder-list "+v+" "+lf,itemName:"BulletFormatList",items:l,element:e});break;case"formats":if(e=t.select("#"+i.parent.getID()+"_"+r+"_Formats",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;o=i.parent.format.types.slice();o.forEach(function(n){Object.defineProperties(n,{command:{value:"Formats",enumerable:!0},subCommand:{value:n.value,enumerable:!0}})});a=t.isNullOrUndefined(i.parent.format.default)?o[0].text:i.parent.format.default;i.formatDropDown=i.toolbarRenderer.renderDropDownButton({iconCss:"quick"===r?"e-formats e-icons":"",content:i.dropdownContent(i.parent.format.width,r,"quick"===r?"":yt(o,a,"text","text")),cssClass:tt+" "+at+" "+wy,itemName:"Formats",items:o,element:e});break;case"fontname":if(e=t.select("#"+i.parent.getID()+"_"+r+"_FontName",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;s=i.parent.fontFamily.items.slice();s.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontName",enumerable:!0}})});y=t.isNullOrUndefined(i.parent.fontFamily.default)?s[0].text:i.parent.fontFamily.default;i.fontNameDropDown=i.toolbarRenderer.renderDropDownButton({iconCss:"quick"===r?"e-font-name e-icons":"",content:i.dropdownContent(i.parent.fontFamily.width,r,"quick"===r?"":yt(s,y,"text","text")),cssClass:tt+" "+at+" "+by,itemName:"FontName",items:s,element:e});t.isNullOrUndefined(i.parent.fontFamily.default)||(i.getEditNode().style.fontFamily=i.parent.fontFamily.default);break;case"fontsize":if(e=t.select("#"+i.parent.getID()+"_"+r+"_FontSize",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;h=i.parent.fontSize.items.slice();h.forEach(function(n){Object.defineProperties(n,{command:{value:"Font",enumerable:!0},subCommand:{value:"FontSize",enumerable:!0}})});p=t.isNullOrUndefined(i.parent.fontSize.default)?h[1].text:i.parent.fontSize.default;i.fontSizeDropDown=i.toolbarRenderer.renderDropDownButton({content:i.dropdownContent(i.parent.fontSize.width,r,uh(yt(h,p.replace(/\s/g,""),"value","text"))),cssClass:tt+" "+at+" "+ky,itemName:"FontSize",items:h,element:e});t.isNullOrUndefined(i.parent.fontSize.default)||(i.getEditNode().style.fontSize=i.parent.fontSize.default);break;case"alignments":if(e=t.select("#"+i.parent.getID()+"_"+r+"_Alignments",u),t.isNullOrUndefined(e)||e.classList.contains(w))return;i.alignDropDown=i.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:tt+" "+at,itemName:"Alignments",items:wf,element:e});break;case"align":i.imageAlignmentDropDown(r,u,e);break;case"display":i.imageDisplayDropDown(r,u,e);break;case"tablerows":i.rowDropDown(r,u,e);break;case"tablecolumns":i.columnDropDown(r,u,e);break;case"tablecell":i.cellDropDown(r,u,e);break;case"tablecellverticalalign":i.verticalAlignDropDown(r,u,e);break;case"styles":i.tableStylesDropDown(r,u,e)}})},n.prototype.getUpdateItems=function(n,t){var i=n.slice();return i.forEach(function(n){Object.defineProperties(n,{command:{value:"Format"===t?"Formats":"Font",enumerable:!0},subCommand:{value:"Format"===t?n.value:t,enumerable:!0}})}),i},n.prototype.onPropertyChanged=function(n){for(var f,h,c,w,e,l,a,b,o,v,y,k,i,u,r=n.newProp,s=0,p=Object.keys(r);s<p.length;s++)switch(p[s]){case"fontFamily":if(this.fontNameDropDown)for(f=0,h=Object.keys(r.fontFamily);f<h.length;f++)switch(h[f]){case"default":case"width":c=this.fontNameDropDown.items;i=t.isNullOrUndefined(t.closest(this.fontNameDropDown.element,"."+cf))?"toolbar":"quick";w=t.isNullOrUndefined(this.parent.fontFamily.default)?c[0].text:this.parent.fontFamily.default;u=this.dropdownContent(this.parent.fontFamily.width,i,"quick"===i?"":yt(c,w,"text","text"));this.fontNameDropDown.setProperties({content:u});t.isNullOrUndefined(this.parent.fontFamily.default)?this.getEditNode().style.removeProperty("font-family"):this.getEditNode().style.fontFamily=this.parent.fontFamily.default;break;case"items":this.fontNameDropDown.setProperties({items:this.getUpdateItems(r.fontFamily.items,"FontName")})}break;case"fontSize":if(this.fontSizeDropDown)for(e=0,l=Object.keys(r.fontSize);e<l.length;e++)switch(l[e]){case"default":case"width":a=this.fontSizeDropDown.items;i=t.isNullOrUndefined(t.closest(this.fontSizeDropDown.element,"."+cf))?"toolbar":"quick";b=t.isNullOrUndefined(this.parent.fontSize.default)?a[1].text:this.parent.fontSize.default;u=this.dropdownContent(this.parent.fontSize.width,i,uh(yt(a,b.replace(/\s/g,""),"value","text")));this.fontSizeDropDown.setProperties({content:u});t.isNullOrUndefined(this.parent.fontSize.default)?this.getEditNode().style.removeProperty("font-size"):this.getEditNode().style.fontSize=this.parent.fontSize.default;break;case"items":this.fontSizeDropDown.setProperties({items:this.getUpdateItems(r.fontSize.items,"FontSize")})}break;case"format":if(this.formatDropDown)for(o=0,v=Object.keys(r.format);o<v.length;o++)switch(v[o]){case"default":case"width":y=this.formatDropDown.items;i=t.isNullOrUndefined(t.closest(this.formatDropDown.element,"."+cf))?"toolbar":"quick";k=t.isNullOrUndefined(this.parent.format.default)?y[0].text:this.parent.format.default;u=this.dropdownContent(this.parent.format.width,i,"quick"===i?"":yt(y,k,"text","text"));this.formatDropDown.setProperties({content:u});break;case"types":this.formatDropDown.setProperties({items:this.getUpdateItems(r.format.types,"Format")})}}},n.prototype.getEditNode=function(){return this.parent.contentModule.getEditPanel()},n.prototype.rowDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableRows",i)).classList.contains(w)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-rows e-icons",cssClass:tt+" "+at+" "+fi,itemName:"TableRows",items:ws,element:r}))},n.prototype.columnDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableColumns",i)).classList.contains(w)||(this.tableColumnsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-columns e-icons",cssClass:tt+" "+at+" "+fi,itemName:"TableColumns",items:bs,element:r}))},n.prototype.cellDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableCell",i)).classList.contains(w)||(this.tableRowsDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell e-icons",cssClass:tt+" "+at+" "+fi,itemName:"TableCell",items:vd,element:r}))},n.prototype.verticalAlignDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_TableCellVerticalAlign",i)).classList.contains(w)||(this.tableCellVerticalAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-table-cell-ver-align e-icons",cssClass:tt+" "+at+" "+fi,itemName:"TableCellVerticalAlign",items:ks,element:r}))},n.prototype.imageDisplayDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_Display",i)).classList.contains(w)||(this.displayDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-display e-icons",cssClass:tt+" "+at+" "+fi,itemName:"Display",items:ps,element:r}))},n.prototype.imageAlignmentDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_Align",i)).classList.contains(w)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-justify-left e-icons",cssClass:tt+" "+os+" "+fi,itemName:"Align",items:ld,element:r}))},n.prototype.tableStylesDropDown=function(n,i,r){(r=t.select("#"+this.parent.getID()+"_"+n+"_Styles",i)).classList.contains(w)||(this.imageAlignDropDown=this.toolbarRenderer.renderDropDownButton({iconCss:"e-style e-icons",cssClass:tt+" "+os+" "+fi,itemName:"Styles",items:this.parent.tableSettings.styles,element:r}))},n.prototype.removeDropDownClasses=function(n){t.removeClass([n],[w,tt,os,at])},n.prototype.destroyDropDowns=function(){this.formatDropDown&&(this.removeDropDownClasses(this.formatDropDown.element),this.formatDropDown.destroy());this.fontNameDropDown&&(this.removeDropDownClasses(this.fontNameDropDown.element),this.fontNameDropDown.destroy());this.fontSizeDropDown&&(this.removeDropDownClasses(this.fontSizeDropDown.element),this.fontSizeDropDown.destroy());this.alignDropDown&&(this.removeDropDownClasses(this.alignDropDown.element),this.alignDropDown.destroy());this.imageAlignDropDown&&(this.removeDropDownClasses(this.imageAlignDropDown.element),this.imageAlignDropDown.destroy());this.displayDropDown&&(this.removeDropDownClasses(this.displayDropDown.element),this.displayDropDown.destroy());this.tableRowsDropDown&&(this.removeDropDownClasses(this.tableRowsDropDown.element),this.tableRowsDropDown.destroy());this.tableColumnsDropDown&&(this.removeDropDownClasses(this.tableColumnsDropDown.element),this.tableColumnsDropDown.destroy());this.tableCellVerticalAlignDropDown&&(this.removeDropDownClasses(this.tableCellVerticalAlignDropDown.element),this.tableCellVerticalAlignDropDown.destroy());this.numberFormatListDropDown&&(this.removeDropDownClasses(this.numberFormatListDropDown.element),this.numberFormatListDropDown.destroy());this.bulletFormatListDropDown&&(this.removeDropDownClasses(this.bulletFormatListDropDown.element),this.bulletFormatListDropDown.destroy())},n.prototype.setRtl=function(n){this.formatDropDown&&this.formatDropDown.setProperties({enableRtl:n.enableRtl});this.fontNameDropDown&&this.fontNameDropDown.setProperties({enableRtl:n.enableRtl});this.fontSizeDropDown&&this.fontSizeDropDown.setProperties({enableRtl:n.enableRtl});this.alignDropDown&&this.alignDropDown.setProperties({enableRtl:n.enableRtl});this.imageAlignDropDown&&this.imageAlignDropDown.setProperties({enableRtl:n.enableRtl});this.displayDropDown&&this.displayDropDown.setProperties({enableRtl:n.enableRtl});this.numberFormatListDropDown&&this.numberFormatListDropDown.setProperties({enableRtl:n.enableRtl});this.bulletFormatListDropDown&&this.bulletFormatListDropDown.setProperties({enableRtl:n.enableRtl})},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(se,this.beforeRender,this),this.parent.on(ni,this.onIframeMouseDown,this),this.parent.on(ii,this.setRtl,this),this.parent.on(u,this.removeEventListener,this),this.parent.on(a,this.onPropertyChanged,this))},n.prototype.onIframeMouseDown=function(){ir(document,"mousedown")},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(ni,this.onIframeMouseDown),this.parent.off(ii,this.setRtl),this.parent.off(se,this.beforeRender),this.parent.off(u,this.removeEventListener),this.parent.off(a,this.onPropertyChanged))},n}(),wl=function(){function n(){this.services={}}return n.prototype.register=function(n,i){t.isNullOrUndefined(this.services[n])&&(this.services[n]=i)},n.prototype.getService=function(n){if(t.isNullOrUndefined(this.services[n]))throw"The service "+n+" is not registered";return this.services[n]},n}(),bl=function(){function n(){this.rendererMap={}}return n.prototype.addRenderer=function(n,i){var r=t.getEnumValue(f,n);t.isNullOrUndefined(this.rendererMap[r])&&(this.rendererMap[r]=i)},n.prototype.getRenderer=function(n){var i=t.getEnumValue(f,n);if(t.isNullOrUndefined(this.rendererMap[i]))throw"The renderer "+i+" is not found";return this.rendererMap[i]},n}(),iw=function(){function n(n){this.parent=n;this.addEventListener();this.serviceLocator=new wl;this.serviceLocator.register("rendererFactory",new bl)}return n.prototype.addEventListener=function(){this.parent.on(hr,this.toolbarClick,this);this.parent.on(ci,this.dropDownSelect,this);this.parent.on(br,this.renderSelection,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.toolbarClick=function(n){if(!t.isNullOrUndefined(n.item)){if(!t.isNullOrUndefined(n.item.controlParent)){var i=n.item.controlParent.activeEle;i&&(i.tabIndex=-1)}"NumberFormatList"!==n.item.command&&"BulletFormatList"!==n.item.command||(n.originalEvent.target.classList.contains("e-order-list")||n.originalEvent.target.classList.contains("e-unorder-list"))&&(n.item.command="Lists",n.item.subCommand="NumberFormatList"===n.item.subCommand?"OL":"UL");"Lists"===n.item.command&&n.originalEvent.target.classList.contains("e-caret")&&(n.originalEvent.target.parentElement.classList.contains("e-rte-bulletformatlist-dropdown")||n.originalEvent.target.parentElement.classList.contains("e-rte-numberformatlist-dropdown"))&&(n.item.command=n.item.subCommand=null);this.parent.notify(fe,n);this.parent.notify(ee,n)}},n.prototype.dropDownSelect=function(n){var t,i;(this.parent.notify(et,{}),document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&n.item&&("Images"===n.item.command||"Display"===n.item.command||"Table"===n.item.command))||(t=n.item.controlParent&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar&&this.parent.quickToolbarModule.tableQTBar.element.contains(n.item.controlParent.element)?"Table":null,"Lists"===n.item.command?(i={listStyle:n.item.value,listImage:n.item.listImage,type:n.item.subCommand},this.parent.formatter.process(this.parent,n,n.originalEvent,i)):this.parent.formatter.process(this.parent,n,n.originalEvent,t));this.parent.notify(lt,{})},n.prototype.renderSelection=function(n){this.parent.notify(et,{});this.parent.formatter.process(this.parent,n,n.originalEvent,null);this.parent.notify(lt,{})},n.prototype.removeEventListener=function(){this.parent.off(hr,this.toolbarClick);this.parent.off(ci,this.dropDownSelect);this.parent.off(br,this.renderSelection);this.parent.off(u,this.removeEventListener)},n}(),cg=function(){function n(n,i){var r;this.parent=n;this.isToolbar=!1;this.locator=i;this.isTransformChild=!1;this.renderFactory=this.locator.getService("rendererFactory");r=this.parent;wf.forEach(function(n,t){wf[t].text=vu(r,cd,wf[t])});ps.forEach(function(n,t){ps[t].text=vu(r,ad,ps[t])});ws.forEach(function(n,t){ws[t].text=vu(r,yd,ws[t])});bs.forEach(function(n,t){bs[t].text=vu(r,pd,bs[t])});ks.forEach(function(n,t){ks[t].text=vu(r,wd,ks[t])});ds.forEach(function(n,t){ds[t].text=vu(r,bd,ds[t])});al(this.parent);this.renderFactory.addRenderer(f.Toolbar,new tw(this.parent));this.toolbarRenderer=this.renderFactory.getRenderer(f.Toolbar);this.baseToolbar=new yl(this.parent,this.locator);this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,au,eh(this.parent.toolbarSettings.itemConfigs),!0):this.tools=au}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(f.Content);this.editableElement=this.contentRenderer.getEditPanel();this.editPanel=this.contentRenderer.getPanel()},n.prototype.toolbarBindEvent=function(){this.parent.inlineMode.enable||(this.keyBoardModule=new t.KeyboardEvents(this.getToolbarElement(),{keyAction:this.toolBarKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"}))},n.prototype.toolBarKeyDown=function(n){"escape"===n.action&&this.parent.contentModule.getEditPanel().focus()},n.prototype.createToolbarElement=function(){this.tbElement=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar"});!t.Browser.isDevice&&this.parent.inlineMode.enable&&o()||(this.parent.toolbarSettings.enableFloating&&!this.parent.inlineMode.enable?(this.tbWrapper=this.parent.createElement("div",{id:this.parent.getID()+"_toolbar_wrapper",innerHTML:this.tbElement.outerHTML,className:ss}),this.tbElement=this.tbWrapper.firstElementChild,this.parent.element.insertBefore(this.tbWrapper,this.editPanel)):this.parent.element.insertBefore(this.tbElement,this.editPanel))},n.prototype.getToolbarMode=function(){var n;switch(this.parent.toolbarSettings.type){case y.Expand:n="Extended";break;case y.Scrollable:n="Scrollable";break;default:n="MultiRow"}return o()&&this.parent.toolbarSettings.type===y.Expand&&(n=y.Scrollable),n},n.prototype.checkToolbarResponsive=function(n){return!(!t.Browser.isDevice||o()||(i=this.parent.toolbarSettings.type===y.Expand?y.MultiRow:this.parent.toolbarSettings.type,this.baseToolbar.render({container:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items,mode:i,target:n}),this.parent.toolbarSettings.type===y.Expand&&(t.addClass([n],["e-rte-tb-mobile"]),this.parent.inlineMode.enable?this.addFixedTBarClass():t.addClass([n],[hy])),this.wireEvents(),this.dropDownModule.renderDropDowns({container:n,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(gu,{container:this.tbElement,containerType:this.parent.inlineMode.enable?"quick":"toolbar",items:this.parent.toolbarSettings.items}),0));var i},n.prototype.checkIsTransformChild=function(){this.isTransformChild=!1;for(var i=t.selectAll('[style*="transform"]',document),n=0;n<i.length;n++)if(!t.isNullOrUndefined(i[n].contains)&&i[n].contains(this.parent.element)){this.isTransformChild=!0;break}},n.prototype.toggleFloatClass=function(n){var i,u,e=!1,s=!1,f=this.parent.floatingToolbarOffset,c,l,a,v,o;if(n&&this.parent.iframeSettings.enable&&this.parent.inputElement.ownerDocument===n.target?u=n.target.body:n&&n.target!==document?u=n.target:(e=!0,u=document.body),c=this.getToolbarHeight()+this.getExpandTBarPopHeight(),this.isTransformChild){i=0;l=0;a=this.parent.element.offsetHeight;e&&(v=window.getComputedStyle(u),l=parseFloat(v.marginTop.split("px")[0])+parseFloat(v.paddingTop.split("px")[0]));var r=this.parent.element.getBoundingClientRect().top,p=t.Browser.isMSPointer&&e?window.pageYOffset:u.parentElement.scrollTop,y=u.getBoundingClientRect(),h=e?y.top+p:y.top;r>h+f||r<-a||r<0&&!(r-(e?0:h)+a>c+f)?(s=!1,t.removeClass([this.tbElement],[us])):r<h+f&&(i=r<0?-r+h:h-r,i=e?i-l:i,t.addClass([this.tbElement],[us]),s=!0)}else{if(o=this.parent.element.getBoundingClientRect(),window.innerHeight<o.top)return;i=n&&n.target!==document?u.getBoundingClientRect().top:0;o.bottom<f+c+i||o.bottom<0||o.top>f+i?s=!1:o.top<f&&(s=!0)}s?(t.addClass([this.tbElement],[rs]),t.setStyleAttribute(this.tbElement,{width:this.parent.element.offsetWidth+"px",top:f+i+"px"})):(t.removeClass([this.tbElement],[rs]),t.setStyleAttribute(this.tbElement,{top:"0px",width:"100%"}))},n.prototype.renderToolbar=function(){if(this.initializeInstance(),this.createToolbarElement(),!this.checkToolbarResponsive(this.tbElement)){this.parent.inlineMode.enable?this.parent.notify(ro,{}):(this.baseToolbar.render({container:"toolbar",items:this.parent.toolbarSettings.items,mode:this.getToolbarMode(),target:this.tbElement}),this.parent.inlineMode.enable||(this.parent.toolbarSettings.enableFloating&&(this.checkIsTransformChild(),this.toggleFloatClass()),t.addClass([this.parent.element],[el]),this.parent.toolbarSettings.type===y.Expand&&t.addClass([this.parent.element],[oc])));this.wireEvents();this.parent.inlineMode.enable&&!o()&&this.addFixedTBarClass();this.parent.inlineMode.enable||(this.dropDownModule.renderDropDowns({container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.parent.notify(gu,{container:this.tbElement,containerType:"toolbar",items:this.parent.toolbarSettings.items}),this.refreshToolbarOverflow());var n=this.parent.element.querySelector(".e-rte-srctextarea"),i=this.parent.element.querySelector(".e-source-content");(this.parent.iframeSettings.enable||t.isNullOrUndefined(n)||"block"!==n.style.display)&&(!this.parent.iframeSettings.enable||t.isNullOrUndefined(i)||"block"!==i.style.display)||(this.parent.notify(lr,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),this.parent.disableToolbarItem(this.parent.toolbarSettings.items))}},n.prototype.addFixedTBarClass=function(){t.addClass([this.tbElement],[ec])},n.prototype.removeFixedTBarClass=function(){t.removeClass([this.tbElement],[ec])},n.prototype.showFixedTBar=function(){t.addClass([this.tbElement],[cc]);t.Browser.isIos&&t.addClass([this.tbElement],[bc])},n.prototype.hideFixedTBar=function(){this.isToolbar?this.isToolbar=!1:t.removeClass([this.tbElement],[cc,bc])},n.prototype.updateItem=function(n){var r=this.tools[n.updateItem.toLocaleLowerCase()],i=kf(bf(this.tools[n.targetItem.toLocaleLowerCase()].subCommand),n.baseToolbar.toolbarObj.items)[0],u;t.isNullOrUndefined(i)?this.addTBarItem(n,0):(u=this.parent.inlineMode.enable?"_quick_":"_toolbar_",n.baseToolbar.toolbarObj.items[i].id=this.parent.getID()+u+r.id,n.baseToolbar.toolbarObj.items[i].prefixIcon=r.icon,n.baseToolbar.toolbarObj.items[i].tooltipText=r.tooltip,n.baseToolbar.toolbarObj.items[i].subCommand=r.subCommand,n.baseToolbar.toolbarObj.dataBind())},n.prototype.updateToolbarStatus=function(n){this.tbElement&&(!this.parent.inlineMode.enable||!o()&&t.Browser.isDevice)&&sl({args:n,dropDownModule:this.dropDownModule,parent:this.parent,tbElements:t.selectAll("."+vi,this.tbElement),tbItems:this.baseToolbar.toolbarObj.items},!!this.parent.inlineMode.enable,this.parent)},n.prototype.fullScreen=function(n){this.parent.fullScreenModule.showFullScreen(n)},n.prototype.hideScreen=function(n){this.parent.fullScreenModule.hideFullScreen(n)},n.prototype.getBaseToolbar=function(){return this.baseToolbar},n.prototype.addTBarItem=function(n,t){n.baseToolbar.toolbarObj.addItems([n.baseToolbar.getObject(n.updateItem,"toolbar")],t)},n.prototype.enableTBarItems=function(n,i,r,u){var o=kf(bf(i),n.toolbarObj.items),f,e;for(this.tbItems=t.selectAll("."+vi,n.toolbarObj.element),f=0;f<o.length;f++)e=this.tbItems[o[f]],e&&n.toolbarObj.enableItems(e,r);t.select(".e-rte-srctextarea",this.parent.element)||u||yu(n,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},n.prototype.removeTBarItems=function(n){var r,i;for(t.isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject()),r=kf(bf(n),this.baseToolbar.toolbarObj.items),this.tbItems=this.parent.inlineMode.enable?t.selectAll("."+vi,this.baseToolbar.toolbarObj.element):t.selectAll("."+vi,this.parent.element),i=0;i<r.length;i++)this.baseToolbar.toolbarObj.removeItems(this.tbItems[r[i]])},n.prototype.getExpandTBarPopHeight=function(){var i=0,n;return this.parent.toolbarSettings.type===y.Expand&&this.tbElement.classList.contains("e-extended-toolbar")&&(n=t.select(".e-toolbar-extended",this.tbElement),n&&this.tbElement.classList.contains("e-expand-open")||n&&n.classList.contains("e-popup-open")?(t.addClass([n],[lc]),i+=n.offsetHeight,t.removeClass([n],[lc])):t.removeClass([this.tbElement],[yi])),i},n.prototype.getToolbarHeight=function(){return this.tbElement.offsetHeight},n.prototype.getToolbarElement=function(){return t.select("."+hf,this.parent.element)},n.prototype.refreshToolbarOverflow=function(){this.baseToolbar.toolbarObj.refreshOverflow()},n.prototype.isToolbarDestroyed=function(){return this.baseToolbar.toolbarObj&&!this.baseToolbar.toolbarObj.isDestroyed},n.prototype.destroyToolbar=function(){if(this.isToolbarDestroyed()){this.parent.unWireScrollElementsEvents();this.unWireEvents();this.parent.notify(oe,{});this.dropDownModule.destroyDropDowns();this.baseToolbar.toolbarObj.destroy();this.removeEventListener();t.removeClass([this.parent.element],[el]);t.removeClass([this.parent.element],[oc]);var n=t.select("."+ss,this.parent.element),i=t.select("."+hf,this.parent.element);t.isNullOrUndefined(n)?t.isNullOrUndefined(i)||t.detach(i):t.detach(n)}},n.prototype.destroy=function(){this.isToolbarDestroyed()&&(this.destroyToolbar(),this.keyBoardModule&&this.keyBoardModule.destroy())},n.prototype.scrollHandler=function(n){this.parent.inlineMode.enable||this.parent.toolbarSettings.enableFloating&&this.getDOMVisibility(this.tbElement)&&this.toggleFloatClass(n.args)},n.prototype.getDOMVisibility=function(n){return!(!n.offsetParent&&0===n.offsetWidth&&0===n.offsetHeight)},n.prototype.mouseDownHandler=function(){t.Browser.isDevice&&this.parent.inlineMode.enable&&!o()&&this.showFixedTBar()},n.prototype.focusChangeHandler=function(){t.Browser.isDevice&&this.parent.inlineMode.enable&&!o()&&(this.isToolbar=!1,this.hideFixedTBar())},n.prototype.dropDownBeforeOpenHandler=function(){this.isToolbar=!0},n.prototype.tbFocusHandler=function(){var r=document.activeElement,u=t.closest(r,".e-rte-toolbar"),i,n;if(r===this.parent.getToolbarElement()||u===this.parent.getToolbarElement())for(i=this.parent.getToolbarElement().querySelectorAll(".e-expended-nav"),n=0;n<i.length;n++)t.isNullOrUndefined(this.parent.getToolbarElement().querySelector(".e-insert-table-btn"))?i[n].setAttribute("tabindex","0"):i[n].setAttribute("tabindex","1")},n.prototype.tbKeydownHandler=function(n){(n.target.classList.contains("e-dropdown-btn")||n.target.getAttribute("id")===this.parent.getID()+"_toolbar_CreateTable")&&n.target.setAttribute("tabindex","0")},n.prototype.toolbarClickHandler=function(n){var i=t.closest(n.originalEvent.target,".e-hor-nav");i&&this.parent.toolbarSettings.type===y.Expand&&!t.isNullOrUndefined(i)?i.classList.contains("e-nav-active")?(t.addClass([this.tbElement],[yi]),this.parent.setContentHeight("toolbar",!0)):(t.removeClass([this.tbElement],[yi]),this.parent.setContentHeight("toolbar",!1)):(t.Browser.isDevice||this.parent.inlineMode.enable)&&(this.isToolbar=!0);t.isNullOrUndefined(i)&&this.parent.toolbarSettings.type===y.Expand&&t.removeClass([this.tbElement],[yi])},n.prototype.wireEvents=function(){this.parent.inlineMode.enable&&o()||(t.EventHandler.add(this.tbElement,"focusin",this.tbFocusHandler,this),t.EventHandler.add(this.tbElement,"keydown",this.tbKeydownHandler,this))},n.prototype.unWireEvents=function(){t.EventHandler.remove(this.tbElement,"focusin",this.tbFocusHandler);t.EventHandler.remove(this.tbElement,"keydown",this.tbKeydownHandler)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.dropDownModule=new pl(this.parent,this.locator),this.toolbarActionModule=new iw(this.parent),this.parent.on(c,this.renderToolbar,this),this.parent.on(li,this.scrollHandler,this),this.parent.on(du,this.toolbarBindEvent,this),this.parent.on(ht,this.updateToolbarStatus,this),this.parent.on(a,this.onPropertyChanged,this),this.parent.on(ku,this.onRefresh,this),this.parent.on(u,this.destroy,this),this.parent.on(nf,this.fullScreen,this),this.parent.on(tf,this.hideScreen,this),this.parent.on(lr,this.updateItem,this),this.parent.on(ff,this.dropDownBeforeOpenHandler,this),this.parent.on(tc,this.parent.setContentHeight,this.parent),this.parent.on(dr,this.focusChangeHandler,this),this.parent.on(nt,this.mouseDownHandler,this),this.parent.on(pr,this.mouseDownHandler,this),this.parent.inlineMode.enable||o()||this.parent.on(hr,this.toolbarClickHandler,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.renderToolbar),this.parent.off(li,this.scrollHandler),this.parent.off(du,this.toolbarBindEvent),this.parent.off(ht,this.updateToolbarStatus),this.parent.off(a,this.onPropertyChanged),this.parent.off(ku,this.onRefresh),this.parent.off(u,this.destroy),this.parent.off(nf,this.parent.fullScreenModule.showFullScreen),this.parent.off(tf,this.parent.fullScreenModule.hideFullScreen),this.parent.off(lr,this.updateItem),this.parent.off(ff,this.dropDownBeforeOpenHandler),this.parent.off(tc,this.parent.setContentHeight),this.parent.off(dr,this.focusChangeHandler),this.parent.off(nt,this.mouseDownHandler),this.parent.off(pr,this.mouseDownHandler),this.parent.inlineMode.enable||o()||this.parent.off(hr,this.toolbarClickHandler))},n.prototype.onRefresh=function(){this.refreshToolbarOverflow();this.parent.setContentHeight("",!0)},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.inlineMode))for(var i=0,r=Object.keys(n.newProp.inlineMode);i<r.length;i++)"enable"===r[i]&&this.refreshToolbar();n.module===this.getModuleName()&&this.refreshToolbar()},n.prototype.refreshToolbar=function(){t.isNullOrUndefined(this.baseToolbar.toolbarObj)&&(this.baseToolbar=this.parent.getBaseToolbarObject());var n=t.select("."+ss,this.parent.element);(t.select("."+hf,this.parent.element)||n)&&this.destroyToolbar();this.parent.toolbarSettings.enable&&(this.addEventListener(),this.renderToolbar(),this.parent.wireScrollElementsEvents(),t.select(".e-rte-srctextarea",this.parent.element)||yu(this.baseToolbar,this.parent.formatter.editorManager.undoRedoManager.getUndoStatus()),this.parent.notify(ru,{}))},n.prototype.getModuleName=function(){return"toolbar"},n}(),lg=(sh=function(n,t){return sh=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},sh(n,t)},function(n,t){function i(){this.constructor=n}sh(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),hh=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ag={backspace:8,tab:9,enter:13,shift:16,control:17,alt:18,pause:19,capslock:20,space:32,escape:27,pageup:33,pagedown:34,end:35,home:36,leftarrow:37,uparrow:38,rightarrow:39,downarrow:40,insert:45,"delete":46,f1:112,f2:113,f3:114,f4:115,f5:116,f6:117,f7:118,f8:119,f9:120,f10:121,f11:122,f12:123,semicolon:186,plus:187,comma:188,minus:189,dot:190,forwardslash:191,graveaccent:192,openbracket:219,backslash:220,closebracket:221,singlequote:222,"]":221,"[":219,"=":187},ch=function(n){function i(t,i){var u=n.call(this,i,t)||this;return u.keyPressHandler=function(n){for(var h,t,c=n.altKey,l=n.ctrlKey,a=n.shiftKey,v=n.metaKey,y=n.which,i=0,e=Object.keys(u.keyConfigs);i<e.length;i++)for(var o=e[i],f=0,s=u.keyConfigs[o].split(",");f<s.length;f++)h=s[f],t=r.getKeyConfigData(h.trim()),c===t.altKey&&(l===t.ctrlKey||v)&&a===t.shiftKey&&y===t.keyCode&&(n.action=o);u.keyAction&&u.keyAction(n)},u.bind(),u}var r;return lg(i,n),r=i,i.prototype.destroy=function(){this.unwireEvents();n.prototype.destroy.call(this)},i.prototype.onPropertyChanged=function(){},i.prototype.bind=function(){this.wireEvents()},i.prototype.getModuleName=function(){return"keyboard"},i.prototype.wireEvents=function(){this.element.addEventListener(this.eventName,this.keyPressHandler)},i.prototype.unwireEvents=function(){this.element.removeEventListener(this.eventName,this.keyPressHandler)},i.getKeyConfigData=function(n){if(n in this.configCache)return this.configCache[n];var t=n.toLowerCase().split("+"),i={altKey:-1!==t.indexOf("alt"),ctrlKey:-1!==t.indexOf("ctrl"),shiftKey:-1!==t.indexOf("shift"),keyCode:null};return i.keyCode=t[t.length-1].length>1&&Number(t[t.length-1])?Number(t[t.length-1]):r.getKeyCode(t[t.length-1]),r.configCache[n]=i,i},i.getKeyCode=function(n){return ag[n]||n.toUpperCase().charCodeAt(0)},i.configCache={},hh([t.Property({})],i.prototype,"keyConfigs",void 0),hh([t.Property("keyup")],i.prototype,"eventName",void 0),hh([t.Event()],i.prototype,"keyAction",void 0),r=hh([t.NotifyPropertyChanges],i)}(t.Base),kl=function(){function n(n,i){this.tools={};this.parent=n;this.locator=i;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener();this.parent.toolbarSettings&&Object.keys(this.parent.toolbarSettings.itemConfigs).length>0?t.extend(this.tools,au,eh(this.parent.toolbarSettings.itemConfigs),!0):this.tools=au}return n.prototype.initializeInstance=function(){this.toolbarRenderer=this.renderFactory.getRenderer(f.Toolbar)},n.prototype.renderColorPickerInput=function(n){var i=this,r,u,f,e;this.initializeInstance();f=n.containerType;e=n.container;ol.forEach(function(o){var s,h;if(-1!==rh(o,n.items))switch(o){case"fontcolor":r=i.parent.getID()+"_"+f+"_FontColor_Target";s=i.parent.createElement("input");s.id=r;s.classList.add(dy);document.body.appendChild(s);u={cssClass:i.tools[o.toLocaleLowerCase()].icon+" "+v+" "+lf,value:i.tools[o.toLocaleLowerCase()].value,command:i.tools[o.toLocaleLowerCase()].command,subCommand:i.tools[o.toLocaleLowerCase()].subCommand,element:t.select("#"+i.parent.getID()+"_"+f+"_FontColor",e),target:r};i.fontColorPicker=i.toolbarRenderer.renderColorPicker(u,"fontcolor");i.fontColorDropDown=i.toolbarRenderer.renderColorPickerDropDown(u,"fontcolor",i.fontColorPicker);break;case"backgroundcolor":r=i.parent.getID()+"_"+f+"_BackgroundColor_Target";h=i.parent.createElement("input");h.id=r;h.classList.add(gy);document.body.appendChild(h);u={cssClass:i.tools[o.toLocaleLowerCase()].icon+" "+v+" "+lf,value:i.tools[o.toLocaleLowerCase()].value,command:i.tools[o.toLocaleLowerCase()].command,subCommand:i.tools[o.toLocaleLowerCase()].subCommand,element:t.select("#"+i.parent.getID()+"_"+f+"_BackgroundColor",e),target:r};i.backgroundColorPicker=i.toolbarRenderer.renderColorPicker(u,"backgroundcolor");i.backgroundColorDropDown=i.toolbarRenderer.renderColorPickerDropDown(u,"backgroundcolor",i.backgroundColorPicker,i.defaultColorPicker)}})},n.prototype.destroy=function(){this.removeEventListener();this.destroyColorPicker()},n.prototype.destroyColorPicker=function(){var n;this.fontColorPicker&&!this.fontColorPicker.isDestroyed&&this.fontColorPicker.destroy();this.backgroundColorPicker&&!this.backgroundColorPicker.isDestroyed&&this.backgroundColorPicker.destroy();this.fontColorDropDown&&!this.fontColorDropDown.isDestroyed&&((n=this.fontColorDropDown.element.querySelector(".e-rte-color-content"))&&t.detach(n),this.fontColorDropDown.destroy());this.backgroundColorDropDown&&!this.backgroundColorDropDown.isDestroyed&&((n=this.backgroundColorDropDown.element.querySelector(".e-rte-color-content"))&&(this.defaultColorPicker=n.children[0].style.borderBottomColor,t.detach(n)),this.backgroundColorDropDown.destroy())},n.prototype.setRtl=function(n){this.fontColorPicker&&(this.fontColorPicker.setProperties({enableRtl:n.enableRtl}),this.fontColorDropDown.setProperties({enableRtl:n.enableRtl}));this.backgroundColorPicker&&(this.backgroundColorPicker.setProperties({enableRtl:n.enableRtl}),this.backgroundColorDropDown.setProperties({enableRtl:n.enableRtl}))},n.prototype.addEventListener=function(){this.parent.on(nc,this.renderColorPickerInput,this);this.parent.on(ii,this.setRtl,this);this.parent.on(u,this.destroy,this);this.parent.on(oe,this.destroyColorPicker,this);this.parent.on(a,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var i,f,r,e,t=n.newProp,u=0,o=Object.keys(t);u<o.length;u++)switch(o[u]){case"fontColor":if(this.fontColorPicker)for(i=0,f=Object.keys(t.fontColor);i<f.length;i++)switch(f[i]){case"default":this.fontColorPicker.setProperties({value:t.fontColor.default});this.fontColorDropDown.element.querySelector("."+this.tools.fontcolor.icon).style.borderBottomColor=t.fontColor.default;break;case"mode":this.fontColorPicker.setProperties({mode:t.fontColor.mode});break;case"columns":this.fontColorPicker.setProperties({columns:t.fontColor.columns});break;case"colorCode":this.fontColorPicker.setProperties({presetColors:t.fontColor.colorCode});break;case"modeSwitcher":this.fontColorPicker.setProperties({modeSwitcher:t.fontColor.modeSwitcher})}break;case"backgroundColor":if(this.backgroundColorPicker)for(r=0,e=Object.keys(t.backgroundColor);r<e.length;r++)switch(e[r]){case"default":this.backgroundColorPicker.setProperties({value:t.backgroundColor.default});this.backgroundColorDropDown.element.querySelector("."+this.tools.backgroundcolor.icon).style.borderBottomColor=t.backgroundColor.default;break;case"mode":this.backgroundColorPicker.setProperties({mode:t.backgroundColor.mode});break;case"columns":this.backgroundColorPicker.setProperties({columns:t.backgroundColor.columns});break;case"colorCode":this.backgroundColorPicker.setProperties({presetColors:t.backgroundColor.colorCode});break;case"modeSwitcher":this.backgroundColorPicker.setProperties({modeSwitcher:t.backgroundColor.modeSwitcher})}}},n.prototype.removeEventListener=function(){this.parent.off(nc,this.renderColorPickerInput);this.parent.off(u,this.destroy);this.parent.off(ii,this.setRtl);this.parent.off(oe,this.destroyColorPicker);this.parent.off(a,this.onPropertyChanged)},n}(),rw=function(){function n(n,t){this.parent=n;this.locator=t;this.isDOMElement=!1;this.renderFactory=this.locator.getService("rendererFactory");this.contentRenderer=this.renderFactory.getRenderer(f.Content);this.popupRenderer=this.renderFactory.getRenderer(f.Popup);this.dropDownButtons=new pl(this.parent,this.locator);this.colorPickerObj=new kl(this.parent,this.locator)}return n.prototype.appendPopupContent=function(){this.toolbarElement=this.parent.createElement("div",{className:cf});this.element.appendChild(this.toolbarElement)},n.prototype.render=function(n){var i,r;i="Image"===n.popupType?ly:"Inline"===n.popupType?fu:"";r=t.getUniqueID(n.popupType+"_Quick_Popup");this.stringItems=n.toolbarItems;this.element=this.parent.createElement("div",{id:r,className:i+" "+v});this.element.setAttribute("aria-owns",this.parent.getID());this.appendPopupContent();this.createToolbar(n.toolbarItems,n.mode);this.popupRenderer.renderPopup(this);this.addEventListener()},n.prototype.createToolbar=function(n,t){this.quickTBarObj=new yl(this.parent,this.locator);this.quickTBarObj.render({container:"quick",target:this.toolbarElement,items:n,mode:t});this.quickTBarObj.toolbarObj.refresh()},n.prototype.setPosition=function(n){var u,f,o=t.closest(n.target,".e-img-caption"),i=t.isNullOrUndefined(o)?n.target:o,r,e;t.addClass([this.toolbarElement],[ac]);r=i.offsetTop;e=window.pageYOffset+n.parentData.top;f=r-n.editTop>n.popHeight?e+n.tBarElementHeight+(r-n.editTop)-n.popHeight-5:n.editTop+n.editHeight-(r+i.offsetHeight)>n.popHeight?e+n.tBarElementHeight+(r-n.editTop)+i.offsetHeight+5:n.y;u=i.offsetWidth>n.popWidth?i.offsetWidth/2-n.popWidth/2+n.parentData.left+i.offsetLeft:n.parentData.left+i.offsetLeft;this.popupObj.position.X=u+n.popWidth>n.parentData.right?n.parentData.right-n.popWidth:u;this.popupObj.position.Y=f>=0?f:n.y+5;this.popupObj.dataBind();t.removeClass([this.toolbarElement],[ac])},n.prototype.checkCollision=function(n,t,i){for(var f,e,r=n.parentData.top,s=n.windowY+r+n.tBarElementHeight,o="document"===t?ot.isCollide(n.popup):ot.isCollide(n.popup,n.parentElement),u=0;u<o.length;u++)switch(o[u]){case"top":e="document"===t?n.windowY:window.pageYOffset+r+n.tBarElementHeight;break;case"bottom":e="document"===t?"inline"===i?n.y-n.popHeight-10:n.windowHeight-(r+n.tBarElementHeight)>n.popHeight?s-n.windowHeight>n.popHeight?s+(n.windowHeight-r)-n.popHeight:s:n.windowY+(r+n.tBarElementHeight):"IMG"!==n.target.tagName?n.parentData.bottom+window.pageYOffset-n.popHeight-10:n.parentData.bottom+window.pageYOffset-n.popHeight-5;break;case"right":f="inline"===i?window.pageXOffset+(n.windowWidth-(n.popWidth+n.bodyRightSpace+10)):n.x-n.popWidth;break;case"left":f="inline"===i?0:n.parentData.left}this.popupObj.position.X=f||this.popupObj.position.X;this.popupObj.position.Y=e||this.popupObj.position.Y;this.popupObj.dataBind()},n.prototype.showPopup=function(n,i,r){var u=this,f={popup:this.popupObj,cancel:!1,targetElement:r};this.parent.trigger(ty,f,function(f){var s;if(!f.cancel){var e,h=void 0,c=void 0,a=window.getComputedStyle(document.body),y=parseFloat(a.marginRight.split("px")[0])+parseFloat(a.paddingRight.split("px")[0]),p=window.innerHeight,w=window.innerWidth,v=u.parent.element,l=!t.isNullOrUndefined(u.parent.getToolbar()),b=l&&u.parent.toolbarModule.getToolbarHeight(),k=l&&u.parent.toolbarModule.getExpandTBarPopHeight(),d=l?b+k:0;t.addClass([u.element],[eu]);t.Browser.isDevice&&!o()&&t.addClass([u.parent.getToolbar()],[eu]);u.parent.iframeSettings.enable?(h=(e=u.contentRenderer.getPanel().contentWindow).pageYOffset,c=e.innerHeight):(h=(e=t.closest(r,"."+hc))?e.scrollTop:0,c=e?e.offsetHeight:0);u.parent.inlineMode.enable||t.closest(r,"table")||(u.parent.disableToolbarItem(u.parent.toolbarSettings.items),u.parent.enableToolbarItem(["Undo","Redo"]));t.append([u.element],document.body);u.popupObj.position.X=n+20;u.popupObj.position.Y=i+20;u.popupObj.dataBind();u.popupObj.element.classList.add("e-popup-open");u.dropDownButtons.renderDropDowns({container:u.toolbarElement,containerType:"quick",items:u.stringItems});u.colorPickerObj.renderColorPickerInput({container:u.toolbarElement,containerType:"quick",items:u.stringItems});s={x:n,y:i,target:r,editTop:h,editHeight:c,popup:u.popupObj.element,popHeight:u.popupObj.element.offsetHeight,popWidth:u.popupObj.element.offsetWidth,parentElement:v,bodyRightSpace:y,windowY:window.pageYOffset,windowHeight:p,windowWidth:w,parentData:v.getBoundingClientRect(),tBarElementHeight:d};"IMG"===r.tagName&&u.setPosition(s);u.parent.inlineMode.enable||u.checkCollision(s,"parent","");u.checkCollision(s,"document",u.parent.inlineMode.enable?"inline":"");u.popupObj.element.classList.remove("e-popup-open");t.removeClass([u.element],[eu]);u.popupObj.show({name:"ZoomIn",duration:t.Browser.isIE?250:400});t.setStyleAttribute(u.element,{maxWidth:window.outerWidth+"px"});t.addClass([u.element],[sc]);u.isDOMElement=!0}})},n.prototype.hidePopup=function(){var n=this.parent.sourceCodeModule.getViewPanel();t.Browser.isDevice&&!o()&&t.removeClass([this.parent.getToolbar()],[eu]);t.isNullOrUndefined(this.parent.getToolbar())||this.parent.inlineMode.enable||(t.isNullOrUndefined(n)||"none"===n.style.display)&&this.parent.enableToolbarItem(this.parent.toolbarSettings.items);this.removeEleFromDOM();this.isDOMElement=!1},n.prototype.addQTBarItem=function(n,t){this.quickTBarObj.toolbarObj.addItems(this.quickTBarObj.getItems(n,"toolbar"),t)},n.prototype.removeQTBarItem=function(n){this.quickTBarObj.toolbarObj.removeItems(n)},n.prototype.removeEleFromDOM=function(){var i=this.popupObj.element,n;this.isDOMElement&&(this.dropDownButtons.destroyDropDowns(),this.colorPickerObj.destroyColorPicker(),t.removeClass([this.element],[sc]),t.detach(i),n=this.popupObj,this.parent.trigger(ry,n))},n.prototype.updateStatus=function(n){sl({args:n,dropDownModule:this.dropDownButtons,parent:this.parent,tbElements:t.selectAll("."+vi,this.element),tbItems:this.quickTBarObj.toolbarObj.items},!0,this.parent);t.select(".e-rte-srctextarea",this.parent.element)||yu(this.parent.getBaseToolbarObject(),this.parent.formatter.editorManager.undoRedoManager.getUndoStatus())},n.prototype.destroy=function(){this.popupObj&&!this.popupObj.isDestroyed&&(this.popupObj.destroy(),this.removeEleFromDOM());this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(u,this.destroy,this),this.parent.on(a,this.onPropertyChanged,this),this.parent.inlineMode.enable&&this.parent.on(ht,this.updateStatus,this))},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.inlineMode))for(var i=0,r=Object.keys(n.newProp.inlineMode);i<r.length;i++)"enable"===r[i]&&(n.newProp.inlineMode.enable?this.parent.on(ht,this.updateStatus,this):this.parent.off(ht,this.updateStatus))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(u,this.destroy),this.parent.off(a,this.onPropertyChanged),this.parent.inlineMode.enable&&this.parent.off(ht,this.updateStatus))},n}(),uw=function(){function n(n){this.parent=n}return n.prototype.quickToolbarOpen=function(){var n=this.popupObj;this.parent.trigger(iy,n)},n.prototype.renderPopup=function(n){this.setPanel(n.element);this.renderPanel();n.popupObj=new ot.Popup(n.element,{targetType:"relative",relateTo:this.parent.element,open:this.quickToolbarOpen.bind(this)});this.popupObj=n.popupObj;n.popupObj.hide()},n.prototype.renderPanel=function(){this.getPanel().classList.add(cy)},n.prototype.getPanel=function(){return this.popupPanel},n.prototype.setPanel=function(n){this.popupPanel=n},n}(),vg=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.renderFactory.addRenderer(f.Popup,new uw(this.parent));this.addEventListener()}return n.prototype.formatItems=function(n){var t=[];return n.forEach(function(n){if("string"==typeof n)switch(n.toLocaleLowerCase()){case"open":t.push("openLink");break;case"edit":t.push("editLink");break;case"unlink":t.push("removeLink");break;default:t.push(n)}else t.push(n)}),t},n.prototype.getQTBarOptions=function(n,t,i,r){return{popupType:n,toolbarItems:i,mode:t,renderType:r}},n.prototype.createQTBar=function(n,t,i,r){if(i.length<1)return null;var u=new rw(this.parent,this.locator);return u.render(this.getQTBarOptions(n,t,this.formatItems(i),r)),u},n.prototype.initializeQuickToolbars=function(){this.parent.quickToolbarModule=this;this.contentRenderer=this.renderFactory.getRenderer(f.Content);this.parent.inlineMode.enable&&this.parent.inlineMode.onSelection&&o()&&t.EventHandler.add(this.contentRenderer.getDocument(),"selectionchange",this.selectionChangeHandler,this)},n.prototype.onMouseDown=function(){this.parent.isBlur=!1;this.parent.isRTE=!0},n.prototype.keyUpQT=function(n){27==n.which&&this.hideQuickToolbars()},n.prototype.renderQuickToolbars=function(){this.linkQTBar||this.imageQTBar||this.textQTBar||this.tableQTBar||(this.linkQTBar=this.createQTBar("Link","Scrollable",this.parent.quickToolbarSettings.link,f.LinkToolbar),this.renderFactory.addRenderer(f.LinkToolbar,this.linkQTBar),this.textQTBar=this.createQTBar("Text","Scrollable",this.parent.quickToolbarSettings.text,f.TextToolbar),this.renderFactory.addRenderer(f.TextToolbar,this.textQTBar),this.imageQTBar=this.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,f.ImageToolbar),this.renderFactory.addRenderer(f.ImageToolbar,this.imageQTBar),this.tableQTBar=this.createQTBar("Table","MultiRow",this.parent.quickToolbarSettings.table,f.TableToolbar),this.renderFactory.addRenderer(f.TableToolbar,this.tableQTBar),this.linkQTBar&&(t.EventHandler.add(this.linkQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.linkQTBar.element,"keyup",this.keyUpQT,this)),this.imageQTBar&&(t.EventHandler.add(this.imageQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.imageQTBar.element,"keyup",this.keyUpQT,this)),this.textQTBar&&(t.EventHandler.add(this.textQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.textQTBar.element,"keyup",this.keyUpQT,this)),this.tableQTBar&&(t.EventHandler.add(this.tableQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.tableQTBar.element,"keyup",this.keyUpQT,this)))},n.prototype.renderInlineQuickToolbar=function(){this.parent.inlineMode.enable&&(!t.Browser.isDevice||o())&&(t.addClass([this.parent.element],[fs]),this.inlineQTBar=this.createQTBar("Inline","MultiRow",this.parent.toolbarSettings.items,f.InlineToolbar),this.renderFactory.addRenderer(f.InlineToolbar,this.inlineQTBar),t.EventHandler.add(this.inlineQTBar.element,"mousedown",this.onMouseDown,this),t.EventHandler.add(this.inlineQTBar.element,"keyup",this.keyUpQT,this))},n.prototype.showInlineQTBar=function(n,t,i){this.parent.readonly||"img"===i.tagName.toLowerCase()||this.inlineQTBar.showPopup(n,t,i)},n.prototype.hideInlineQTBar=function(){this.inlineQTBar&&!it(this.inlineQTBar.element,"e-popup-close")&&this.inlineQTBar.hidePopup()},n.prototype.hideQuickToolbars=function(){this.linkQTBar&&!it(this.linkQTBar.element,"e-popup-close")&&document.body.contains(this.linkQTBar.element)&&this.linkQTBar.hidePopup();this.textQTBar&&!it(this.textQTBar.element,"e-popup-close")&&document.body.contains(this.textQTBar.element)&&this.textQTBar.hidePopup();this.imageQTBar&&!it(this.imageQTBar.element,"e-popup-close")&&document.body.contains(this.imageQTBar.element)&&this.imageQTBar.hidePopup();this.tableQTBar&&!it(this.tableQTBar.element,"e-popup-close")&&document.body.contains(this.tableQTBar.element)&&this.tableQTBar.hidePopup();!this.parent.inlineMode.enable||t.Browser.isDevice&&!o()||this.hideInlineQTBar()},n.prototype.deBounce=function(n,t,i){var r=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){r.showInlineQTBar(n,t,i)},1e3)},n.prototype.mouseUpHandler=function(n){var f,e,s;if(this.parent.inlineMode.enable&&(!t.Browser.isDevice||o())){var r=n.args.touches?n.args.changedTouches[0]:n.args,u=this.parent.getRange(),i=n.args.target;if(t.isNullOrUndefined(t.select("."+fu,document.body))){if(o()&&n.touchData&&n.touchData.prevClientX!==n.touchData.clientX&&n.touchData.prevClientY!==n.touchData.clientY)return;if(this.hideInlineQTBar(),f=this.parent.element.getBoundingClientRect().left,this.offsetX=this.parent.iframeSettings.enable?window.pageXOffset+f+r.clientX:r.pageX,this.offsetY=gp(r,this.parent.element,this.parent.iframeSettings.enable),"TEXTAREA"===i.nodeName)this.showInlineQTBar(this.offsetX,this.offsetY,i);else if(i=t.closest(i,"a")||i,e=this.parent.getRange().startContainer.parentElement,s=this.parent.getRange().endContainer.parentElement,(t.isNullOrUndefined(t.closest(e,"A"))||t.isNullOrUndefined(t.closest(s,"A")))&&(!t.closest(i,"td,th")||!u.collapsed)&&("IMG"!==i.tagName||this.parent.getRange().startOffset!==this.parent.getRange().endOffset)){if(this.parent.inlineMode.onSelection&&u.collapsed)return;this.target=i;this.showInlineQTBar(this.offsetX,this.offsetY,i)}}}},n.prototype.keyDownHandler=function(){!this.parent.inlineMode.enable||t.Browser.isDevice&&!o()||t.isNullOrUndefined(t.select("."+fu,document))||this.hideInlineQTBar()},n.prototype.inlineQTBarMouseDownHandler=function(){!this.parent.inlineMode.enable||t.Browser.isDevice&&!o()||t.isNullOrUndefined(t.select("."+fu,document))||this.hideInlineQTBar()},n.prototype.keyUpHandler=function(n){if(this.parent.inlineMode.enable&&!t.Browser.isDevice){if(this.parent.inlineMode.onSelection)return;var i=n.args;this.deBounce(this.offsetX,this.offsetY,i.target)}},n.prototype.selectionChangeHandler=function(n){var t=this;clearTimeout(this.deBouncer);this.deBouncer=window.setTimeout(function(){t.onSelectionChange(n)},1e3)},n.prototype.onSelectionChange=function(n){t.isNullOrUndefined(t.select("."+fu,document.body))&&(this.contentRenderer.getDocument().getSelection().isCollapsed||this.mouseUpHandler({args:n}))},n.prototype.getInlineBaseToolbar=function(){return this.inlineQTBar&&this.inlineQTBar.quickTBarObj},n.prototype.destroy=function(){this.linkQTBar&&(t.EventHandler.remove(this.linkQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.linkQTBar.element,"keyup",this.keyUpQT),this.linkQTBar.destroy());this.textQTBar&&(t.EventHandler.remove(this.textQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.textQTBar.element,"keyup",this.keyUpQT),this.textQTBar.destroy());this.imageQTBar&&(t.EventHandler.remove(this.imageQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.imageQTBar.element,"keyup",this.keyUpQT),this.imageQTBar.destroy());this.tableQTBar&&(t.EventHandler.remove(this.tableQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.tableQTBar.element,"keyup",this.keyUpQT),this.tableQTBar.destroy());this.inlineQTBar&&(t.EventHandler.remove(this.inlineQTBar.element,"mousedown",this.onMouseDown),t.EventHandler.remove(this.inlineQTBar.element,"keyup",this.keyUpQT),o()&&t.EventHandler.remove(document,"selectionchange",this.selectionChangeHandler),this.inlineQTBar.destroy());this.removeEventListener()},n.prototype.wireInlineQTBarEvents=function(){this.parent.on(cr,this.mouseUpHandler,this);this.parent.on(nt,this.inlineQTBarMouseDownHandler,this);this.parent.on(p,this.keyDownHandler,this);this.parent.on(ct,this.keyUpHandler,this);this.parent.on(pr,this.mouseUpHandler,this);this.parent.on(ro,this.renderInlineQuickToolbar,this)},n.prototype.unWireInlineQTBarEvents=function(){this.parent.off(cr,this.mouseUpHandler);this.parent.off(nt,this.inlineQTBarMouseDownHandler);this.parent.off(p,this.keyDownHandler);this.parent.off(ct,this.keyUpHandler);this.parent.off(pr,this.mouseUpHandler);this.parent.off(ro,this.renderInlineQuickToolbar)},n.prototype.toolbarUpdated=function(){this.linkQTBar&&!it(this.linkQTBar.element,"e-popup-close")&&this.linkQTBar.hidePopup();this.imageQTBar&&!it(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup();this.tableQTBar&&!it(this.tableQTBar.element,"e-popup-close")&&this.tableQTBar.hidePopup()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(c,this.initializeQuickToolbars,this),this.parent.on(nt,this.renderQuickToolbars,this),this.parent.on(ht,this.toolbarUpdated,this),this.parent.on(ao,this.renderQuickToolbars,this),this.wireInlineQTBarEvents(),this.parent.on(a,this.onPropertyChanged,this),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.on(li,this.hideQuickToolbars,this),this.parent.on(wr,this.hideQuickToolbars,this)),this.parent.on(dr,this.hideQuickToolbars,this),this.parent.on(ni,this.onIframeMouseDown,this),this.parent.on(u,this.destroy,this),this.parent.on(p,this.onKeyDown,this),this.parent.on(ii,this.setRtl,this))},n.prototype.onKeyDown=function(n){var t=n.args;8!==t.which&&46!==t.which||this.imageQTBar&&!it(this.imageQTBar.element,"e-popup-close")&&this.imageQTBar.hidePopup()},n.prototype.onIframeMouseDown=function(){this.hideQuickToolbars();this.hideInlineQTBar()},n.prototype.setRtl=function(n){this.inlineQTBar&&this.inlineQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.imageQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl});this.linkQTBar&&this.imageQTBar.quickTBarObj.toolbarObj.setProperties({enableRtl:n.enableRtl})},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.initializeQuickToolbars),this.parent.off(nt,this.renderQuickToolbars),this.parent.off(ht,this.toolbarUpdated),this.parent.off(ao,this.renderQuickToolbars),this.unWireInlineQTBarEvents(),this.parent.off(a,this.onPropertyChanged),"hide"===this.parent.quickToolbarSettings.actionOnScroll&&(this.parent.off(li,this.hideQuickToolbars),this.parent.off(wr,this.hideQuickToolbars)),this.parent.off(dr,this.hideQuickToolbars),this.parent.off(u,this.destroy),this.parent.off(ni,this.onIframeMouseDown),this.parent.off(p,this.onKeyDown),this.parent.off(ii,this.setRtl))},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.quickToolbarSettings))for(var i=0,r=Object.keys(n.newProp.quickToolbarSettings);i<r.length;i++)"actionOnScroll"===r[i]&&("none"===n.newProp.quickToolbarSettings.actionOnScroll?(this.parent.off(li,this.hideQuickToolbars),this.parent.off(wr,this.hideQuickToolbars)):(this.parent.on(li,this.hideQuickToolbars,this),this.parent.on(wr,this.hideQuickToolbars,this)));n.module===this.getModuleName()&&(this.inlineQTBar&&(t.removeClass([this.parent.element],[fs]),this.unWireInlineQTBarEvents(),this.hideInlineQTBar()),!this.parent.inlineMode.enable||t.Browser.isDevice&&!o()||(t.addClass([this.parent.element],[fs]),this.wireInlineQTBarEvents()))},n.prototype.getModuleName=function(){return"quickToolbar"},n}(),yg=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.initializeInstance=function(){this.contentRenderer=this.renderFactory.getRenderer(f.Content);this.editPanel=this.contentRenderer.getEditPanel();this.addEventListener()},n.prototype.renderCount=function(){this.initializeInstance();this.element=this.parent.createElement("span",{className:wc});this.contentRenderer.getPanel().parentElement.appendChild(this.element);this.appendCount();-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength)},n.prototype.appendCount=function(){var n="Markdown"===this.parent.editorMode?this.editPanel.value.trim():this.editPanel.textContent.trim(),t;this.htmlLength="Markdown"!==this.parent.editorMode&&-1!==n.indexOf("​")?n.replace(/\u200B/g,"").length:n.length;t=-1===this.parent.maxLength?this.htmlLength:this.htmlLength+" / "+this.parent.maxLength;this.element.innerHTML=t},n.prototype.charCountBackground=function(n){var t=n/this.parent.maxLength*100;t<85?(this.element.classList.remove(cs),this.element.classList.remove(ls)):t>85&&t<=90?(this.element.classList.remove(ls),this.element.classList.add(cs)):t>90&&(this.element.classList.remove(cs),this.element.classList.add(ls))},n.prototype.refresh=function(){t.isNullOrUndefined(this.editPanel)||(this.appendCount(),-1!==this.parent.maxLength&&this.charCountBackground(this.htmlLength))},n.prototype.destroy=function(){this.element&&!t.isNullOrUndefined(this.parent.element.querySelector("."+wc))&&t.detach(this.element);this.removeEventListener()},n.prototype.toggle=function(n){this.element.style.display="viewSource"===n.member?"none":"block"},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(c,this.renderCount,this),this.parent.on(ct,this.refresh,this),this.parent.on(io,this.refresh,this),this.parent.on(ku,this.refresh,this),this.parent.on(nt,this.refresh,this),this.parent.on(u,this.destroy,this),this.parent.on(ki,this.toggle,this),this.parent.on(yr,this.toggle,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.renderCount),this.parent.off(ct,this.refresh),this.parent.off(ku,this.refresh),this.parent.off(io,this.refresh),this.parent.off(nt,this.refresh),this.parent.off(u,this.destroy),this.parent.off(ki,this.toggle),this.parent.off(yr,this.toggle))},n.prototype.getModuleName=function(){return"count"},n}(),lh=function(){function n(){}return n.prototype.getLineNumber=function(n,t){return n.value.substr(0,t).split("\n").length},n.prototype.getSelectedText=function(n){var t=n.selectionStart,i=n.selectionEnd;return n.value.substring(t,i)},n.prototype.getAllParents=function(n){return n.split("\n")},n.prototype.getSelectedLine=function(n){return this.getAllParents(n.value)[this.getLineNumber(n,n.selectionStart)-1]},n.prototype.getLine=function(n,t){return this.getAllParents(n.value)[t]},n.prototype.getSelectedParentPoints=function(n){var o=this.getAllParents(n.value),h=this.getLineNumber(n,n.selectionStart),c=this.getLineNumber(n,n.selectionEnd),e=this.getSelectedText(n).split("\n"),t=[],s=o[h-1],l=o.slice(0,h-1).join("").length,i={},r,u,f;if(i.line=h-1,i.start=l+i.line,i.end=""!==s?i.start+s.length+1:i.start+s.length,i.text=s,t.push(i),e.length>1){for(r=1;r<e.length-1;r++)u={},u.line=t[r-1].line+1,u.start=(e[r],t[r-1].end),u.end=u.start+e[r].length+1,u.text=e[r],t.push(u);f={};f.line=t[t.length-1].line+1;f.start=t[t.length-1].end;f.end=f.start+o[c-1].length+1;f.text=o[c-1];t.push(f)}return t},n.prototype.setSelection=function(n,t,i){n.setSelectionRange(t,i);n.focus()},n.prototype.save=function(n,t){this.selectionStart=n;this.selectionEnd=t},n.prototype.restore=function(n){this.setSelection(n,this.selectionStart,this.selectionEnd)},n.prototype.isStartWith=function(n,t){var i=!1;return n&&(i=(n.trim()===t.trim()?new RegExp("^("+this.replaceSpecialChar(t.trim())+")","gim"):new RegExp("^("+this.replaceSpecialChar(t)+")","gim")).test(n.trim())),i},n.prototype.replaceSpecialChar=function(n){return n.replace(/[`~!@#$%^&*()_|+\-=?;:'",.<>\{\}\[\]\\\/]/g,"\\$&")},n.prototype.isClear=function(n,t){for(var i=0;i<n.length;i++)if(new RegExp(t,"gim").test(n[i].text))return!0;return!1},n.prototype.getSelectedInlinePoints=function(n){return{start:n.selectionStart,end:n.selectionEnd,text:this.getSelectedText(n)}},n}(),pg=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","strike","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];var fw=function(){function n(n){this.toolbarStatus=this.prevToolbarStatus={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,uppercase:!1,lowercase:!1,inlinecode:!1,unorderedlist:!1,formats:null};this.selection=new lh;this.parent=n;this.element=this.parent.contentModule.getEditPanel();this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ti,this.onRefreshHandler,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(ti,this.onRefreshHandler);this.parent.off(u,this.removeEventListener)},n.prototype.onRefreshHandler=function(n){var i=this.selection.getSelectedParentPoints(this.element),t;this.toolbarStatus={orderedlist:!n.documentNode&&this.isListsApplied(i,"OL"),unorderedlist:!n.documentNode&&this.isListsApplied(i,"UL"),formats:this.currentFormat(i,n.documentNode),bold:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Bold"),italic:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("Italic"),inlinecode:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode"),strikethrough:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("StrikeThrough"),subscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SubScript"),superscript:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("SuperScript"),uppercase:!n.documentNode&&this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("UpperCase")};this.parent.formatter.editorManager.mdSelectionFormats.isAppliedCommand("InlineCode")&&(this.toolbarStatus.formats="pre");t=JSON.stringify(this.toolbarStatus);this.parent.notify(ht,this.toolbarStatus);JSON.stringify(this.prevToolbarStatus)!==t&&(this.parent.notify(sf,{html:null,markdown:JSON.parse(t)}),this.prevToolbarStatus=JSON.parse(t))},n.prototype.isListsApplied=function(n,t){var r=!0,i,u;if("OL"===t){for(i=0;i<n.length;i++)if(u=n[i].text.trim().split(" ",2)[0]+" ",!/^[\d.]+[ ]+$/.test(u)){r=!1;break}}else for(i=0;i<n.length;i++)if(!this.selection.isStartWith(n[i].text,this.parent.formatter.listTags[t])){r=!1;break}return r},n.prototype.currentFormat=function(n,t){for(var u="p",r=Object.keys(this.parent.formatter.formatTags),f="backward"===this.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(f,this.parent.formatter.formatTags[r[i]])){u=r[i];break}if("pre"===r[i]&&this.codeFormat()){u=r[i];break}}return u},n.prototype.codeFormat=function(){var e,o=!1,i=this.parent.inputElement,s=i.selectionStart,n=(e=s,function(n){return[n.slice(0,e),n.slice(e)]})(i.value),r=this.parent.formatter.formatTags.pre,u=this.getSelectedText(i),t,f;return""!==u&&u===u.toLocaleUpperCase()?!0:""===u&&(t=i.value.substr(n[0].length-1,1),f=n[1].substr(0,1),""!==t&&""!==f&&t.match(/[a-z]/i)&&t===t.toLocaleUpperCase()&&f===f.toLocaleUpperCase())?!0:(this.isCode(n[0],r)&&this.isCode(n[1],r)&&n[0].match(this.multiCharRegx(r)).length%2==1&&n[1].match(this.multiCharRegx(r)).length%2==1&&(o=!0),o)},n.prototype.getSelectedText=function(n){return n.value.substring(n.selectionStart,n.selectionEnd)},n.prototype.isCode=function(n,t){return-1!==n.search("\\"+t)},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n}(),ew=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(he,this.commandCallBack,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.commandCallBack=function(n){"Undo"!==n.requestType&&"Redo"!==n.requestType&&this.parent.formatter.saveData();this.parent.notify(ti,{args:n});this.parent.notify(io,{})},n.prototype.removeEventListener=function(){this.parent.off(he,this.commandCallBack);this.parent.off(u,this.removeEventListener)},n}(),ah="keydown",rr="action",te="format-type",l="keydown-handler",dl="list-type",hi="keyup-handler",pu="keyup",wu="model_changed_plugin",vh="model_changed",gl="ms_word_cleanup_plugin",na="ms_word_cleanup",ta="onBegin",ia="actionBegin",ra=function(){function n(){}return n.prototype.process=function(n,i,r,u){var h,e=this,s=n.contentModule.getDocument().getSelection(),o=s.rangeCount>0?s.getRangeAt(s.rangeCount-1):null,f,c,l;("HTML"===n.editorMode&&(h=this.editorManager.nodeSelection.save(o,n.contentModule.getDocument())),t.isNullOrUndefined(i)||!i.item.command||"Table"===i.item.command||"Actions"===i.item.command||"Links"===i.item.command||"Images"===i.item.command||"Files"===i.item.command||!o||n.contentModule.getEditPanel().contains(this.getAncestorNode(o.commonAncestorContainer))||n.contentModule.getEditPanel()===o.commonAncestorContainer||n.contentModule.getPanel()===o.commonAncestorContainer)&&(t.isNullOrUndefined(i)?(f=r.action,"tab"!==f&&"enter"!==f&&"space"!==f&&"escape"!==f&&(i={},"Markdown"===n.editorMode&&"insert-table"===f&&(u={headingText:n.localeObj.getConstant("TableHeadingText"),colText:n.localeObj.getConstant("TableColText")}),c={originalEvent:r,cancel:!1,requestType:f||r.key+"Key",itemCollection:u},t.extend(i,i,c,!0),n.trigger(k,i,function(n){n.cancel&&("paste"!==f&&"cut"!==f&&"copy"!==f||r.preventDefault())})),l=!!t.isNullOrUndefined(n.tableModule)||!!n.tableModule&&n.tableModule.ensureInsideTableList,(9===r.which&&l||9!==r.which)&&(13===r.which&&"HTML"===n.editorMode&&(u={enterAction:n.enterKey}),this.editorManager.observer.notify("keydown"===r.type?ah:pu,{event:r,callBack:this.onSuccess.bind(this,n),value:u,enterAction:n.enterKey}))):!t.isNullOrUndefined(i)&&i.item.command&&i.item.subCommand&&(i.item.command!==i.item.subCommand&&"Font"!==i.item.command||("FontName"===i.item.subCommand||"FontSize"===i.item.subCommand)&&"dropDownSelect"===i.name||("BackgroundColor"===i.item.subCommand||"FontColor"===i.item.subCommand)&&"colorPickerChanged"===i.name)&&(t.extend(i,i,{requestType:i.item.subCommand,cancel:!1,itemCollection:u,selectType:i.name},!0),n.trigger(k,i,function(t){if(!t.cancel){0===e.getUndoRedoStack().length&&"Links"!==t.item.command&&"Images"!==t.item.command&&e.saveData();n.isBlur=!1;n.contentModule.getEditPanel().focus();"HTML"===n.editorMode&&h.restore();var i=t.item.subCommand.toLocaleLowerCase();"paste"===i||"cut"===i||"copy"===i?n.clipboardAction(i,r):(e.editorManager.observer.notify(oo,{subCommand:t.item.subCommand}),e.editorManager.execCommand(t.item.command,t.item.subCommand,r,e.onSuccess.bind(e,n),t.item.value,"Pre"===t.item.subCommand&&"dropDownSelect"===t.selectType?{name:t.selectType}:u,"#"+n.getID()+" iframe",n.enterKey))}})),(t.isNullOrUndefined(r)||r&&"copy"!==r.action)&&this.enableUndo(n))},n.prototype.getAncestorNode=function(n){return 3===n.nodeType?n.parentNode:n},n.prototype.onKeyHandler=function(n,t){var i=this;this.editorManager.observer.notify(pu,{event:t,callBack:function(){n.notify(sr,{});i.enableUndo(n)}})},n.prototype.onSuccess=function(n,i){n.notify(sr,{});i&&(t.isNullOrUndefined(i.event)||"copy"!==i.event.action)&&(this.enableUndo(n),n.notify(he,i));n.trigger(ft,i,function(t){if(n.setPlaceHolder(),"Images"===t.requestType||"Links"===t.requestType&&"HTML"===n.editorMode){var i=t;if("Links"===t.requestType&&t.event&&"keydown"===t.event.type&&32===t.event.keyCode)return;n.notify(vr,{args:i.event,type:t.requestType,isNotify:!0,elements:i.elements})}n.autoResize()})},n.prototype.saveData=function(n){this.editorManager.undoRedoManager.saveData(n)},n.prototype.getUndoStatus=function(){return this.editorManager.undoRedoManager.getUndoStatus()},n.prototype.getUndoRedoStack=function(){return this.editorManager.undoRedoManager.undoRedoStack},n.prototype.enableUndo=function(n){var i=this.getUndoStatus();!n.inlineMode.enable||t.Browser.isDevice&&!o()?n.toolbarModule&&yu(n.toolbarModule.baseToolbar,i):yu(n.quickToolbarModule.inlineQTBar.quickTBarObj,i)},n}(),ua="lists-commands",yh="command-type",fa="link-commands",ea="clear-commands",ph="insert-table",ow=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ua,this.applyListsHandler,this);this.parent.observer.on(l,this.keyDownHandler,this);this.parent.observer.on(hi,this.keyUpHandler,this)},n.prototype.keyDownHandler=function(n){switch(9===n.event.which&&this.tabKey(n),n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault()}},n.prototype.keyUpHandler=function(n){13===n.event.which&&this.enterKey(n)},n.prototype.tabKey=function(n){var r=this.parent.element,y,k,i,h,f,w,u;this.selection.save(r.selectionStart,r.selectionEnd);var e=r.selectionStart,o=r.selectionEnd,t=this.selection.getSelectedParentPoints(r),v=0,b=this.isNotFirstLine(r,t[0]);if(b||n.event.shiftKey){for(y=this.olListType(),k=this.getListRegex(),this.currentAction=this.getAction(t[0].text),i=0;i<t.length;i++)if(h=(n.event.shiftKey,t[i].line-1),f=this.selection.getLine(r,h),f&&(!n.event.shiftKey&&b||n.event.shiftKey)){var d=f.split(". "),c=n.event.shiftKey?-1:1,s=t[i].text.split("\t");if(n.event.shiftKey&&1===s.length)break;if("OL"===this.currentAction&&/^\d+$/.test(d[0].trim())&&y){n.event.preventDefault();t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text;var l=this.getTabSpace(t[i].text),a=this.getTabSpace(f),p=t[i].text.split(". ");if(l===a)this.changeTextAreaValue(p,this.nextOrderedListValue(d[0].trim()),n,r,t,i,o);else if(a<l)this.changeTextAreaValue(p,"1. ",n,r,t,i,o);else for(;a.length>l.length;null)if(h-=1,w=(f=this.selection.getLine(r,h)).trim().split(". "),/^\d+$/.test(w[0])&&(a=this.getTabSpace(f)).length<=l.length){this.changeTextAreaValue(p,this.nextOrderedListValue(w[0]),n,r,t,i,o);break}}else("UL"===this.currentAction&&k.test(f.trim())||!y)&&(n.event.preventDefault(),t[i].text=n.event.shiftKey?s.splice(1,s.length).join("\t"):"\t"+t[i].text,r.value=r.value.substr(0,t[i].start)+t[i].text+"\n"+r.value.substr(t[i].end,r.value.length));if(e=0===i?e+c:e,v+=c,1!==t.length)for(u=i;u<t.length;u++)t[u].start=0!==u?t[u].start+c:t[u].start,t[u].end=t[u].end+c}this.restore(r,e,o+v,n)}else this.restore(r,e,o+v,n)},n.prototype.changeTextAreaValue=function(n,i,r,u,f,e){var k=i,c,w,b;n.splice(0,1);var d,ut=this.selection.getAllParents(u.value).length,o="",h=this.getTabSpace(f[e].text),g=parseInt(k.split(".")[0],null),y=this.getTabSpace(f[e].text),nt=!0,a=!0,tt=-1,it=!0,rt=0,p="";for(o=""!==this.selection.getLine(u,f[0].line+1)?"":o+u.value.substr(f[0].end,u.value.length),c=1;c<ut&&!t.isNullOrUndefined(this.selection.getLine(u,f[0].line+c))&&""!==this.selection.getLine(u,f[0].line+c);c++){var v=this.selection.getLine(u,f[0].line+c),s=this.getTabSpace(v),l=v.split(". ");if(1===l.length){o+=u.value.substr(f[0].end+rt,u.value.length);break}rt+=v.length;w=!1;(d=r.event.shiftKey?h.length+1:h.length-1,s.length>y.length&&(it=!1),h.length!==s.length&&s.length<y.length?(a=!0,nt=!1,w=!(!r.event.shiftKey||h.length!==s.length||(a=!1,0))):it&&r.event.shiftKey&&h.length===s.length&&s.length===y.length&&(a=!1,w=!0),p=""===o?"":"\n",d===s.length&&a)?(b=r.event.shiftKey?(tt++,this.nextOrderedListValue(tt.toString())):this.previousOrderedListValue(l[0]),l.splice(0,1),o=o+p+s+b+l.join(". ")):h.length===s.length&&nt||w?(b=this.nextOrderedListValue(g.toString()),g++,l.splice(0,1),o=o+p+s+b+l.join(". ")):(o=o+p+v,a=!1);y=this.getTabSpace(v)}f[e].text=this.getTabSpace(f[e].text)+k+n.join(". ")+"\n";u.value=u.value.substr(0,f[e].start)+f[e].text+o},n.prototype.getTabSpace=function(n){for(var i=n.split("\t"),r="",t=0;t<i.length&&""===i[t];t++)r+="\t";return r},n.prototype.isNotFirstLine=function(n,t){var s,c=t.text,o=t.line-1,i=this.selection.getLine(n,o),h=this.getListRegex(),r=!1,u,f,e;if(i&&(this.currentAction=this.getAction(i),u=i.split(". "),s="OL"===this.currentAction?/^\d+$/.test(u[0].trim()):h.test(i.trim())),i&&s)for(f=this.getTabSpace(c),e=this.getTabSpace(i),r=f===e||r;e.length>f.length;null)if(o-=1,u=(i=this.selection.getLine(n,o)).trim().split(". "),("OL"===this.currentAction?/^\d+$/.test(u[0]):h.test(i.trim()))&&(e=this.getTabSpace(i)).length<=f.length){r=!0;break}return r},n.prototype.getAction=function(n){var t=n.split(". ")[0],i=/^\d+$/.test(t.trim()),r=n.trim().split(new RegExp("^("+this.selection.replaceSpecialChar(this.syntax.UL).trim()+")"))[1];return i?"OL":r?"UL":"NOTLIST"},n.prototype.nextOrderedListValue=function(n){return(parseInt(n,null)+1).toString()+". "},n.prototype.previousOrderedListValue=function(n){return(parseInt(n,null)-1).toString()+". "},n.prototype.enterKey=function(n){var i=this.parent.element,a,e,f,s,h,v,g;this.selection.save(i.selectionStart,i.selectionEnd);var c=i.selectionStart,nt=i.selectionEnd,r=this.selection.getSelectedParentPoints(i),u=this.selection.getLine(i,r[0].line-1),p=this.olListType(),w=this.getListRegex(),l=[];if(t.isNullOrUndefined(u)||(l=u.split(". "),this.currentAction=this.getAction(u)),a=0,"OL"===this.currentAction&&l.length>1&&/^\d+$/.test(l[0].trim())&&p&&""!==l[1]){e=this.getTabSpace(u);this.currentAction=this.getAction(u);f=this.nextOrderedListValue(l[0]);r[0].text=e+f+r[0].text;for(var tt=this.selection.getAllParents(i.value).length,o="\n",b=this.getTabSpace(u),k=this.getTabSpace(r[0].text),d=!0,y=1;y<tt&&""!==i.value.substr(r[0].end,i.value.length);y++)s=this.selection.getLine(i,r[0].line+y),t.isNullOrUndefined(s)?o+="":(h=s.split(". "),v=this.getTabSpace(s),(v.length<k.length&&(d=!1),h.length>1&&/^\d+$/.test(h[0].trim())&&b.length===v.length&&d)?(g=this.nextOrderedListValue(h[0]),h.splice(0,1),o=o+v+g+h.join(". ")+"\n"):(o=o+s+"\n",k=this.getTabSpace(s)));i.value=i.value.substr(0,r[0].start)+b+f+this.selection.getLine(i,r[0].line)+o;c=c+f.length+e.length;a+=f.length+e.length}else("UL"===this.currentAction&&u&&w.test(u.trim())&&""!==u.trim().replace(w,"")||"OL"===this.currentAction&&!p)&&(e=this.getTabSpace(u),f=this.syntax[this.currentAction],r[0].text=e+f+r[0].text+(r[0].text.trim().length>0?"\n":""),i.value=i.value.substr(0,r[0].start)+r[0].text+i.value.substr(r[0].end,i.value.length),c=c+f.length+e.length,a+=f.length+e.length);this.restore(i,c,nt+a,n)},n.prototype.olListType=function(){var n=this.syntax.OL.split(".,");return 1!==n.length&&parseInt(n[2].trim(),null)-parseInt(n[0].trim(),null)?1:0},n.prototype.applyListsHandler=function(n){var f=this.parent.element,u,p,e;this.selection.save(f.selectionStart,f.selectionEnd);this.currentAction=n.subCommand;for(var s,h=f.selectionStart,l=f.selectionEnd,a=0,v=0,c=0,i=this.selection.getSelectedParentPoints(f),o="",y=this.olListType(),w={},r=0;r<i.length;r++)if(s=y?"OL"===this.currentAction?r+y+". ":this.syntax[this.currentAction]:"OL"===this.currentAction?this.syntax.OL:this.syntax[this.currentAction],this.selection.isStartWith(i[r].text,s))i[r].text=i[r].text.replace(s,""),f.value=f.value.substr(0,i[r].start+c)+i[r].text+"\n"+f.value.substr(i[r].end+c,f.value.length),c-=s.length,v=s.length,this.restore(f,h-v,l+c,null);else{if(""===i[r].text&&0===r&&(this.selection.save(h,l),1!==i.length))for(u=r;u<i.length;u++)i[u].start=0!==u?1+i[u].start:i[u].start,i[u].end=1+i[u].end;if(p=t.isNullOrUndefined(i[r-1])?0:this.getTabSpace(i[r-1].text).length,e=this.appliedLine(i[r].text,s,w,p),o=e.line?o:s,i[r].text=e.line?e.line:o+i[r].text,e.space=e.space?e.space:0,f.value=f.value.substr(0,i[r].start+c)+i[r].text+"\n"+f.value.substr(i[r].end,f.value.length),h=0===r?h+o.length+e.space>0?h+o.length+e.space:0:h,a+=o.length+e.space,1!==i.length)for(u=r;u<i.length;u++)i[u].start=0!==u?o.length+i[u].start+e.space:i[u].start,i[u].end=o.length+i[u].end+e.space;this.restore(f,h,l+a,null)}this.restore(f,null,null,n)},n.prototype.appliedLine=function(n,i,r,u){var e={},c=new RegExp("^["+this.syntax.UL.trim()+"]"),f=n.split(". "),l=f[0]+". ",v=c.test(n.trim())||n.trim()===this.syntax.OL.trim()||n.trim()===this.syntax.UL.trim()||/^\d+$/.test(f[0].trim()),a=this.olListType(),o=this.getTabSpace(n).length,s,h;return("OL"===this.currentAction&&a&&(r[o.toString()]=t.isNullOrUndefined(r[o.toString()])?1:r[o.toString()].valueOf()+1,i=r[o.toString()].valueOf().toString()+". ",!t.isNullOrUndefined(u)&&u>o&&(r[u.toString()]=0)),v)&&(s=void 0,h=void 0,c.test(n.trim())?(h=this.syntax.UL,s=i,e.space=i.trim().length-this.syntax.UL.trim().length):/^\d+$/.test(f[0].trim())&&a?(h=f[0].trim()+". ",s=i,e.space=this.syntax.UL.trim().length-l.trim().length):/^\d+$/.test(f[0].trim())&&(h=f[0].trim()+". ",s=this.syntax.UL,e.space=this.syntax.UL.trim().length-l.trim().length),e.line=n.replace(h,s)),e},n.prototype.restore=function(n,i,r,u){t.isNullOrUndefined(i)||t.isNullOrUndefined(i)||this.selection.save(i,r);t.isNullOrUndefined(u)||this.selection.restore(n);u&&u.callBack&&u.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:u.event})},n.prototype.getListRegex=function(){for(var n,t="",r=Object.keys(this.syntax),i=0;i<r.length;i++)n=this.selection.replaceSpecialChar(this.syntax[r[i]]),t+=""===t?"^("+n+")|^("+n.trim()+")":"|^("+n+")|^("+n.trim()+")";return new RegExp(t)},n}(),sw=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(te,this.applyFormats,this)},n.prototype.applyFormats=function(n){var r,i,u,f;if(n.subCommand=n.subCommand.toLowerCase(),r=this.parent.element,this.selection.save(r.selectionStart,r.selectionEnd),i=this.selection.getSelectedParentPoints(r),this.isAppliedFormat(i)===n.subCommand){if("pre"===n.subCommand){if(!(i.length>1))return;this.applyCodeBlock(r,n,i)}return this.cleanFormat(r),void this.restore(r,r.selectionStart,r.selectionEnd,n)}if("p"===n.subCommand)return this.cleanFormat(r),void this.restore(r,r.selectionStart,r.selectionEnd,n);("pre"===n.subCommand&&1!==i.length||"pre"!==n.subCommand)&&this.cleanFormat(r,n.subCommand);var e=r.selectionStart,s=r.selectionEnd,o=0;if(i=this.selection.getSelectedParentPoints(r),"pre"!==n.subCommand){for(u=0;u<i.length;u++)if(""===i[u].text||this.selection.isStartWith(i[u].text,"\\"+this.syntax[n.subCommand])){if(""===i[u].text&&0===u&&(this.selection.save(e,s),0===this.selection.getSelectedText(r).length&&(i[u].text=this.syntax[n.subCommand],r.value=r.value.substr(0,i[u].start)+this.syntax[n.subCommand]+r.value.substr(i[u].end,r.value.length),e=0===u?e+this.syntax[n.subCommand].length:e,o+=this.syntax[n.subCommand].length),1!==i.length))for(f=u;f<i.length;f++)i[f].start=0!==f?1+i[f].start:i[f].start,i[f].end=1+i[f].end}else if(i[u].text=this.syntax[n.subCommand]+i[u].text,r.value=r.value.substr(0,i[u].start)+i[u].text+"\n"+r.value.substr(i[u].end,r.value.length),e=0===u?e+this.syntax[n.subCommand].length:e,o+=this.syntax[n.subCommand].length,1!==i.length)for(f=u;f<i.length;f++)i[f].start=0!==f?this.syntax[n.subCommand].length+i[f].start:i[f].start,i[f].end=this.syntax[n.subCommand].length+i[f].end;this.restore(r,e,s+o,n)}else i.length>1?this.applyCodeBlock(r,n,i):(t.extend(n,n,{subCommand:"InlineCode"},!0),this.parent.observer.notify(yh,n))},n.prototype.clearRegex=function(){for(var i="",t=Object.keys(this.syntax),n=0;n<t.length&&"pre"!==t[n]&&"p"!==t[n];n++)i+=""===i?"^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")":"|^("+this.selection.replaceSpecialChar(this.syntax[t[n]].trim())+")";return i},n.prototype.cleanFormat=function(n,t){var i=this.selection.getSelectedParentPoints(n),o=n.selectionStart,c=n.selectionEnd,l=0,r,s,u,e,h,f;if(this.selection.isClear(i,this.clearRegex())){for(r=0;r<i.length;r++){for(s=Object.keys(this.syntax),u=0;""!==i[r].text&&u<s.length;u++)if(e=this.syntax[s[u]],s[u]!==t&&(h=new RegExp("^("+this.selection.replaceSpecialChar(e)+")","gim"),h.test(i[r].text))){if(i[r].text=i[r].text.replace(h,""),n.value=n.value.substr(0,i[r].start)+i[r].text+"\n"+n.value.substr(i[r].end,n.value.length),o=0===r?o-e.length>0?o-e.length:0:o,l+=e.length,1!==i.length)for(f=0;f<i.length;f++)i[f].start=0!==f?i[f].start-e.length:i[f].start,i[f].end=i[f].end-e.length;break}if(""===i[r].text&&0===r&&(this.selection.save(o,c),1!==i.length))for(u=r;u<i.length;u++)i[u].start=0!==u?1+i[u].start:i[u].start,i[u].end=1+i[u].end}this.restore(n,o,c-l)}},n.prototype.applyCodeBlock=function(n,t,i){var e=t.subCommand,r=i[0].start,u=i[i.length-1].end,h=this.selection.getAllParents(n.value),y=h[i[0].line-1],p=h[i.length+1+1],l,a,s,v;if(this.selection.isStartWith(y,this.syntax.pre.split("\n")[0])||this.selection.isStartWith(p,this.syntax.pre.split("\n")[0])){var f=this.syntax[e],o=this.parent.markdownSelection.getSelectedInlinePoints(n),w=n.value.substr(0,n.selectionStart).lastIndexOf(f),c=n.value.substr(n.selectionEnd,n.selectionEnd).indexOf(f);c+=o.end;l=this.replaceAt(n.value.substr(0,o.start),f,"",w,o.start);a=this.replaceAt(n.value.substr(o.end,n.value.length),f,"",0,c);n.value=l+o.text+a;r=this.selection.selectionStart-f.length;u=this.selection.selectionEnd-f.length}else s=n.value.substring(r,u).split("\n"),v=""===s[s.length-1]?"":"\n",n.value=n.value.substr(0,r)+this.syntax[e]+n.value.substring(r,u)+v+this.syntax[e]+n.value.substr(u,n.value.length),r=this.selection.selectionStart+this.syntax[e].length,u=this.selection.selectionEnd+this.syntax[e].length-1;this.restore(n,r,u,t)},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.isAppliedFormat=function(n,t){for(var u="p",r=(Object.keys(this.syntax),Object.keys(this.syntax)),e="backward"===this.parent.element.selectionDirection?n[0].text:n[n.length-1].text,i=0;!t&&i<r.length;i++){if("pre"!==r[i]&&this.selection.isStartWith(e,this.syntax[r[i]])){u=r[i];break}if("pre"===r[i]){var f=this.selection.getAllParents(this.parent.element.value),o=f[n[0].line-1],s=f[n.length+1];if(this.selection.isStartWith(o,this.syntax[r[i]].split("\n")[0])&&this.selection.isStartWith(s,this.syntax[r[i]].split("\n")[0])){u=r[i];break}}}return u},n}(),hw=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(yh,this.applyCommands,this);this.parent.observer.on(l,this.keyDownHandler,this)},n.prototype.keyDownHandler=function(n){switch(n.event.action){case"bold":this.applyCommands({subCommand:"Bold",callBack:n.callBack});n.event.preventDefault();break;case"italic":this.applyCommands({subCommand:"Italic",callBack:n.callBack});n.event.preventDefault();break;case"strikethrough":this.applyCommands({subCommand:"StrikeThrough",callBack:n.callBack});n.event.preventDefault();break;case"uppercase":this.applyCommands({subCommand:"UpperCase",callBack:n.callBack});n.event.preventDefault();break;case"lowercase":this.applyCommands({subCommand:"LowerCase",callBack:n.callBack});n.event.preventDefault();break;case"superscript":this.applyCommands({subCommand:"SuperScript",callBack:n.callBack});n.event.preventDefault();break;case"subscript":this.applyCommands({subCommand:"SubScript",callBack:n.callBack});n.event.preventDefault()}},n.prototype.isBold=function(n,t){return-1!==n.search("\\"+t+"\\"+t)},n.prototype.isItalic=function(n,t){return-1!==n.search("\\"+t)},n.prototype.isMatch=function(n,t){var i=[""];switch(t){case this.syntax.Italic:case this.syntax.InlineCode:case this.syntax.StrikeThrough:i=n.match(this.singleCharRegx(t))}return i},n.prototype.multiCharRegx=function(n){return new RegExp("(\\"+n+"\\"+n+")","g")},n.prototype.singleCharRegx=function(n){return new RegExp("(\\"+n+")","g")},n.prototype.isAppliedCommand=function(n){var h,r=!1,e=this.parent.element,l=e.selectionStart,i=(h=l,function(n){return[n.slice(0,h),n.slice(h)]})(e.value),u=this.syntax.Bold.substr(0,1),c=this.syntax.Italic,o=this.parent.markdownSelection.getSelectedText(e),f,s;return""!==o&&o===o.toLocaleUpperCase()&&"UpperCase"===n?!0:""===o&&(f=e.value.substr(i[0].length-1,1),s=i[1].substr(0,1),""!==f&&""!==s&&f.match(/[a-z]/i)&&f===f.toLocaleUpperCase()&&s===s.toLocaleUpperCase()&&"UpperCase"===n)?!0:(this.isBold(i[0],u)||this.isItalic(i[0],c)||this.isBold(i[1],u)||this.isItalic(i[1],c)||(t.isNullOrUndefined(this.isMatch(i[0],this.syntax.StrikeThrough))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.StrikeThrough))||this.isMatch(i[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(i[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.InlineCode))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.InlineCode))||this.isMatch(i[0],this.syntax.InlineCode).length%2!=1||this.isMatch(i[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sub>/g))||t.isNullOrUndefined(i[1].match(/\<\/sub>/g))||i[0].match(/\<sub>/g).length%2!=1||i[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sup>/g))||t.isNullOrUndefined(i[1].match(/\<\/sup>/g))||i[0].match(/\<sup>/g).length%2!=1||i[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(r=!0)),this.isBold(i[0],u)&&this.isBold(i[1],u)&&i[0].match(this.multiCharRegx(u)).length%2==1&&i[1].match(this.multiCharRegx(u)).length%2==1&&"Bold"===n&&(r=!0),i[0]=this.isBold(i[0],u)?i[0].replace(this.multiCharRegx(u),"$%@"):i[0],i[1]=this.isBold(i[1],u)?i[1].replace(this.multiCharRegx(u),"$%@"):i[1],t.isNullOrUndefined(this.isMatch(i[0],this.syntax.Italic))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.Italic))||this.isMatch(i[0],this.syntax.Italic).length%2!=1||this.isMatch(i[1],this.syntax.Italic).length%2!=1||"Italic"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.StrikeThrough))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.StrikeThrough))||this.isMatch(i[0],this.syntax.StrikeThrough).length%2!=1||this.isMatch(i[1],this.syntax.StrikeThrough).length%2!=1||"StrikeThrough"!==n||(r=!0),t.isNullOrUndefined(this.isMatch(i[0],this.syntax.InlineCode))||t.isNullOrUndefined(this.isMatch(i[1],this.syntax.InlineCode))||this.isMatch(i[0],this.syntax.InlineCode).length%2!=1||this.isMatch(i[1],this.syntax.InlineCode).length%2!=1||"InlineCode"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sub>/g))||t.isNullOrUndefined(i[1].match(/\<\/sub>/g))||i[0].match(/\<sub>/g).length%2!=1||i[1].match(/\<\/sub>/g).length%2!=1||"SubScript"!==n||(r=!0),t.isNullOrUndefined(i[0].match(/\<sup>/g))||t.isNullOrUndefined(i[1].match(/\<\/sup>/g))||i[0].match(/\<sup>/g).length%2!=1||i[1].match(/\<\/sup>/g).length%2!=1||"SuperScript"!==n||(r=!0),r)},n.prototype.applyCommands=function(n){var i,e,o,c,s;this.currentAction=n.subCommand;i=this.parent.element;this.selection.save(i.selectionStart,i.selectionEnd);var u=i.selectionStart,f=i.selectionEnd,r=0,t=this.parent.markdownSelection.getSelectedInlinePoints(i);if(this.isAppliedCommand(n.subCommand)&&""!==t.text){var h=this.syntax[n.subCommand],l="SubScript"===n.subCommand?"<\/sub>":"SuperScript"===n.subCommand?"<\/sup>":this.syntax[n.subCommand],a="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:h.length,y=i.value.substr(0,t.start).lastIndexOf(h),v=i.value.substr(t.end,i.value.length).indexOf(l);return v+=t.end,e=this.replaceAt(i.value.substr(0,t.start),h,"",y,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),l,"",0,v),i.value=e+t.text+o,void this.restore(i,u-a,f-a,n)}""===t.text||this.isApplied(t,n.subCommand)?"UpperCase"!==n.subCommand&&"LowerCase"!==n.subCommand?("SubScript"===n.subCommand||"SuperScript"===n.subCommand?(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5)):(t.text=this.textReplace(t.text,n.subCommand),t.text=this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand]),i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),r=this.syntax[n.subCommand].length,t.start===t.end?this.restore(i,u+r,f+r,n):this.restore(i,u+r,f-r,n)):this.restore(i,u,f,n):(r="UpperCase"===n.subCommand||"LowerCase"===n.subCommand?0:this.syntax[n.subCommand].length,c=i.value.substr(t.start-this.syntax[n.subCommand].length,this.syntax[n.subCommand].length),s=void 0,c===n.subCommand||t.start-this.syntax[n.subCommand].length===i.value.indexOf(this.syntax[n.subCommand])&&(t.end===i.value.lastIndexOf(this.syntax[n.subCommand])||t.end===i.value.lastIndexOf("<\/"+this.syntax[n.subCommand].substring(1,5)))?(s="SubScript"===n.subCommand||"SuperScript"===n.subCommand?i.value.substr(t.end,this.syntax[n.subCommand].length+1):i.value.substr(t.end,this.syntax[n.subCommand].length),e=this.replaceAt(i.value.substr(0,t.start),c,"",t.start-this.syntax[n.subCommand].length,t.start),o=this.replaceAt(i.value.substr(t.end,i.value.length),s,"",0,s.length),i.value=e+t.text+o,this.restore(i,u-r,f-r,n)):(t.text="SubScript"===n.subCommand||"SuperScript"===n.subCommand?this.syntax[n.subCommand]+t.text+"<\/"+this.syntax[n.subCommand].substring(1,5):"UpperCase"===n.subCommand||"LowerCase"===n.subCommand?"UpperCase"===n.subCommand?t.text.toUpperCase():t.text.toLowerCase():this.syntax[n.subCommand]+t.text+this.syntax[n.subCommand],i.value=i.value.substr(0,t.start)+t.text+i.value.substr(t.end,i.value.length),this.restore(i,u+r,f+r,n)));this.parent.undoRedoManager.saveData()},n.prototype.replaceAt=function(n,t,i,r,u){return n.slice(0,r)+n.slice(r,u).replace(t,i)+n.slice(u)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.textReplace=function(n,t){var i=this.singleCharRegx(this.syntax[t]),u,r,f;switch(t){case"Bold":i=this.multiCharRegx(this.syntax[t].substr(0,1));n=n.replace(i,"");break;case"Italic":this.isBold(n,this.syntax[t].substr(0,1))?(u=this.multiCharRegx(this.syntax[t].substr(0,1)),r=n,r=r.replace(u,"$%@").replace(i,""),f=new RegExp("\\$%@","g"),n=r.replace(f,this.syntax[t].substr(0,1)+this.syntax[t].substr(0,1))):n=n.replace(i,"");break;case"StrikeThrough":case"InlineCode":n=n.replace(i,"");break;case"SubScript":n=n.replace(/<sub>/g,"").replace(/<\/sub>/g,"");break;case"SuperScript":n=n.replace(/<sup>/g,"").replace(/<\/sup>/g,"")}return n},n.prototype.isApplied=function(n,t){var i=this.singleCharRegx(this.syntax[t]),r,f,u;switch(t){case"SubScript":case"SuperScript":return(i=this.singleCharRegx(this.syntax[t])).test(n.text);case"Bold":case"StrikeThrough":return(i=this.multiCharRegx(this.syntax[t].substr(0,1))).test(n.text);case"UpperCase":case"LowerCase":return(i=new RegExp("^["+this.syntax[t]+"]*$","g")).test(n.text);case"Italic":return r=void 0,f=this.multiCharRegx(this.syntax[t].substr(0,1)),f.test(n.text)?(u=n.text,u=u.replace(f,"$%#"),r=i.test(u)):r=i.test(n.text),r;case"InlineCode":return i.test(n.text)}},n}(),oa={h6:"###### ",h5:"##### ",h4:"#### ",h3:"### ",h2:"## ",h1:"# ",blockquote:"> ",pre:"```\n",p:""},sa={Bold:"**",Italic:"*",StrikeThrough:"~~",InlineCode:"`",SubScript:"<sub>",SuperScript:"<sup>",UpperCase:"A-Z",LowerCase:"a-z"},ha={OL:"1. ",UL:"- "},cw={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",underline:"ctrl+u",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=",indents:"ctrl+]",outdents:"ctrl+[","html-source":"ctrl+shift+h","full-screen":"ctrl+shift+f","decrease-fontsize":"ctrl+shift+<","increase-fontsize":"ctrl+shift+>","justify-center":"ctrl+e","justify-full":"ctrl+j","justify-left":"ctrl+l","justify-right":"ctrl+r","clear-format":"ctrl+shift+r","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o",space:"32",enter:"13",tab:"tab","delete":"46"},lw={"toolbar-focus":"alt+f10",escape:"27","insert-link":"ctrl+k","insert-image":"ctrl+shift+i","insert-table":"ctrl+shift+e",undo:"ctrl+z",redo:"ctrl+y",copy:"ctrl+c",cut:"ctrl+x",paste:"ctrl+v",bold:"ctrl+b",italic:"ctrl+i",strikethrough:"ctrl+shift+s",uppercase:"ctrl+shift+u",lowercase:"ctrl+shift+l",superscript:"ctrl+shift+=",subscript:"ctrl+=","full-screen":"ctrl+shift+f","ordered-list":"ctrl+shift+o","unordered-list":"ctrl+alt+o"},ca={b:["strong"],strong:["b"],i:["emp","cite"],emp:["i","cite"],cite:["i","emp"]},wg={first:"MsoListParagraphCxSpFirst",middle:"MsoListParagraphCxSpMiddle",last:"MsoListParagraphCxSpLast"},la=["BR","IMG"],aw=function(){function n(n,i){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=t.isNullOrUndefined(i)?30:i.undoRedoSteps;this.undoRedoTimer=t.isNullOrUndefined(i)?300:i.undoRedoTimer;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){var n=t.debounce(this.keyUp,this.undoRedoTimer);this.parent.observer.on(hi,n,this);this.parent.observer.on(l,this.keyDown,this);this.parent.observer.on(rr,this.onAction,this);this.parent.observer.on(wu,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){var n=t.debounce(this.keyUp,300);this.parent.observer.off(hi,n);this.parent.observer.off(l,this.keyDown);this.parent.observer.off(rr,this.onAction);this.parent.observer.off(wu,this.onPropertyChanged)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.saveData=function(n){var t=this.parent.element;this.selection.save(t.selectionStart,t.selectionEnd);var i=t.selectionStart,r=t.selectionEnd,u={text:this.parent.element.value,start:i,end:r};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].start===i&&this.undoRedoStack[this.undoRedoStack.length-1].end===r||(this.undoRedoStack.push(u),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())},n.prototype.undo=function(n){if(this.steps>0){this.currentAction="Undo";var t=this.undoRedoStack[this.steps-1].start,i=this.undoRedoStack[this.steps-1].end,r=this.undoRedoStack[this.steps-1].text;this.parent.element.value=r;this.parent.element.focus();this.steps--;this.restore(this.parent.element,t,i,n)}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){this.currentAction="Redo";var t=this.undoRedoStack[this.steps+1].start,i=this.undoRedoStack[this.steps+1].end;this.parent.element.value=this.undoRedoStack[this.steps+1].text;this.parent.element.focus();this.steps++;this.restore(this.parent.element,t,i,n)}},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:this.currentAction,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n}(),vw=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(fa,this.createLink,this)},n.prototype.createLink=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i="Image"===n.subCommand?this.selection.getSelectedText(t):n.item.text,f="Image"===n.subCommand?r+2:r+1,e="Image"===n.subCommand?u+2:u+1;i="Image"===n.subCommand?"!["+i+"]("+n.item.url+")":"["+i+"]("+n.item.url+")";t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,f,e);this.restore(t,f,e,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n}(),yw=function(){function n(n){t.extend(this,this,n,!0);this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ph,this.createTable,this);this.parent.observer.on(l,this.onKeyDown,this)},n.prototype.removeEventListener=function(){this.parent.observer.off(ph,this.createTable);this.parent.observer.off(l,this.onKeyDown)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.onKeyDown=function(n){"insert-table"===n.event.action&&(n.item=n.value,this.createTable(n))},n.prototype.createTable=function(n){this.element=this.parent.element;var t=this.element.selectionStart,i=this.element.selectionEnd,r=this.element.value;this.locale=n;this.selection.save(t,i);this.restore(this.element.selectionStart,this.element.selectionEnd,null);this.insertTable(t,i,r,n)},n.prototype.getTable=function(){var n="";return n+=this.textNonEmpty(),(n+=this.tableHeader(this.locale))+this.tableCell(this.locale)},n.prototype.tableHeader=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=1===i?n.item.headingText+" "+r+"|":"---------|";t+=this.insertLine()}return t},n.prototype.tableCell=function(n){for(var r,t="",i=1;i<=2;i++){for(t+="|",r=1;r<=2;r++)t+=n.item.colText+" "+this.convertToLetters(i)+r+"|";t+=this.insertLine()}return t+this.insertLine()},n.prototype.insertLine=function(){var n=document.createElement("div");return n.innerHTML="\n",n.textContent},n.prototype.insertTable=function(n,t,i,r){var u=this.selection.getSelectedParentPoints(this.element),f=u[u.length-1].text.split(" ",2),e=this.getFormatTag();f.length<2?(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t)):this.ensureFormatApply(u[u.length-1].text)?this.checkValid(n,t,this.getTable(),i,r,f,u,e):(this.element.value=this.updateValue(this.getTable()),this.makeSelection(i,n,t));this.restore(this.element.selectionStart,this.element.selectionEnd,r)},n.prototype.makeSelection=function(n,t,i){i=t+(n.length>0?12:10);t+=n.length>0?3:1;this.selection.setSelection(this.element,t,i)},n.prototype.getFormatTag=function(){for(var n,r=Object.keys(this.syntaxTag.Formats),u=Object.keys(this.syntaxTag.List),t=[],i=0;i<r.length;i++)t.push(this.syntaxTag.Formats[r[i]]);for(n=0;n<u.length;n++)t.push(this.syntaxTag.List[u[n]]);return t},n.prototype.ensureFormatApply=function(n){for(var i=this.getFormatTag(),r=n.trim().split(" ",2)[0]+" ",t=0;t<i.length;t++)if(r===i[t]||/^[\d.]+[ ]+$/.test(r))return!0;return!1},n.prototype.ensureStartValid=function(n,t){for(var r=t[0].text.split(" ",2),i=n+1;i<=n+r[0].length+1;i++)if(this.element.selectionStart===i||this.element.selectionEnd===i)return!1;return!0},n.prototype.ensureEndValid=function(n,t){for(var i=n+1;i<=n+t+1;i++)if(this.element.selectionEnd===i)return!1;return!0},n.prototype.updateValueWithFormat=function(n,t){var i=this.element.value.substring(this.element.selectionEnd,this.element.value.length);return t+=i.replace(i,n[0]+" "+i),this.element.value.substr(0,this.element.selectionStart)+t},n.prototype.updateValue=function(n){return this.element.value.substr(0,this.element.selectionStart)+n+this.element.value.substr(this.element.selectionEnd,this.element.value.length)},n.prototype.checkValid=function(n,t,i,r,u,f,e){this.ensureStartValid(e[0].start,e)&&this.ensureEndValid(e[e.length-1].start,f[0].length)&&(this.element.value=n===e[0].start?n!==t&&t!==e[e.length-1].end-1?this.updateValueWithFormat(f,i):this.updateValue(i):t===e[e.length-1].end-1?this.updateValue(i):this.updateValueWithFormat(f,i),this.makeSelection(r,n,t))},n.prototype.convertToLetters=function(n){var i="A".charCodeAt(0),t="";do n-=1,t=String.fromCharCode(i+n%26)+t,n=n/26>>0;while(n>0);return t},n.prototype.textNonEmpty=function(){var n="";return(this.isCursorBased()||this.isSelectionBased())&&this.element.value.length>0&&(n+=this.insertLine(),n+=this.insertLine()),n},n.prototype.isCursorBased=function(){return this.element.selectionStart===this.element.selectionEnd},n.prototype.isSelectionBased=function(){return this.element.selectionStart!==this.element.selectionEnd},n.prototype.restore=function(n,t,i){this.selection.save(n,t);this.selection.restore(this.element);i&&i.callBack&&i.callBack({requestType:i.subCommand,selectedText:this.selection.getSelectedText(this.element),editorMode:"Markdown",event:i.event})},n}(),pw=function(){function n(n){this.parent=n;this.selection=this.parent.markdownSelection;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ea,this.clear,this)},n.prototype.replaceRegex=function(n){return n.replace(/\*/gi,"\\*").replace(/\&/gi,"\\&").replace(/\-/gi,"\\-").replace(/\^/gi,"\\^").replace(/\$/gi,"\\$").replace(/\./gi,"\\.").replace(/\|/gi,"\\|").replace(/\?/gi,"\\?").replace(/\+/gi,"\\+").replace(/\-/gi,"\\-").replace(/\&/gi,"\\&")},n.prototype.clearSelectionTags=function(n){for(var i,r,u,t=this.parent.selectionTags,e=Object.keys(t),f=0;f<e.length;f++)if(i=e[f],t.hasOwnProperty(i)&&""!==t[i]){var o,s=this.replaceRegex(t[i]),h=t[i].length,c="<sup>"===t[i]||"<sub>"===t[i]?t[i].length+1:t[i].length;for(o="<sup>"===t[i]?new RegExp("<sup>(.*?)<\/sup>","ig"):"<sub>"===t[i]?new RegExp("<sub>(.*?)<\/sub>","ig"):new RegExp(s+"(.*?)"+s,"ig"),r=n.match(o),u=0;r&&u<r.length&&""!==r[u];u++)n=n.replace(r[u],r[u].substr(h,r[u].length-c-h))}return n},n.prototype.clearFormatTags=function(n){var t=n.split("\n");return this.clearFormatLines(t)},n.prototype.clearFormatLines=function(n){for(var u,r,o=[this.parent.formatTags,this.parent.listTags],f="",t=0;t<n.length;t++){for(u=0;u<o.length;u++)for(var i=o[u],s=Object.keys(i),e=0;e<s.length;e++)r=s[e],i.hasOwnProperty(r)&&""!==i[r]&&0===n[t].indexOf(i[r])&&(n[t]=n[t].replace(i[r],""),n[t]=this.clearFormatLines([n[t]]));f=f+n[t]+(t!==n.length-1?"\n":"")}return f},n.prototype.clear=function(n){var t=this.parent.element;t.focus();var r=t.selectionStart,u=t.selectionEnd,i=this.selection.getSelectedText(t);i=this.clearSelectionTags(i);i=this.clearFormatTags(i);t.value=t.value.substr(0,r)+i+t.value.substr(u,t.value.length);this.parent.markdownSelection.setSelection(t,r,r+i.length);this.restore(t,r,r+i.length,n)},n.prototype.restore=function(n,t,i,r){this.selection.save(t,i);this.selection.restore(n);r&&r.callBack&&r.callBack({requestType:r.subCommand,selectedText:this.selection.getSelectedText(n),editorMode:"Markdown",event:r.event})},n}(),ww=function(){function n(n){this.initialize();t.extend(this,this,n,!0);this.observer=new t.Observer(this);this.markdownSelection=new lh;this.listObj=new ow({parent:this,syntax:this.listTags});this.formatObj=new sw({parent:this,syntax:this.formatTags});this.undoRedoManager=new aw(this,n.options);this.mdSelectionFormats=new hw({parent:this,syntax:this.selectionTags});this.linkObj=new vw(this);this.tableObj=new yw({parent:this,syntaxTag:{Formats:this.formatTags,List:this.listTags}});this.clearObj=new pw(this);this.wireEvents()}return n.prototype.initialize=function(){this.formatTags=oa;this.listTags=ha;this.selectionTags=sa},n.prototype.wireEvents=function(){this.observer.on(ah,this.editorKeyDown,this);this.observer.on(pu,this.editorKeyUp,this);this.observer.on(vh,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){this.observer.notify(wu,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(l,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(hi,n)},n.prototype.execCommand=function(n,t,i,r,u,f){switch(n.toLocaleLowerCase()){case"lists":this.observer.notify(ua,{subCommand:t,event:i,callBack:r});break;case"formats":this.observer.notify(te,{subCommand:t,event:i,callBack:r});break;case"actions":this.observer.notify(rr,{subCommand:t,event:i,callBack:r});break;case"style":case"effects":case"casing":this.observer.notify(yh,{subCommand:t,event:i,callBack:r});break;case"links":case"images":this.observer.notify(fa,{subCommand:t,event:i,callBack:r,item:f});break;case"table":"createtable"===t.toString().toLocaleLowerCase()&&this.observer.notify(ph,{subCommand:t,item:f,event:i,callBack:r});break;case"clear":this.observer.notify(ea,{subCommand:t,event:i,callBack:r})}},n}(),bg=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bw=function(n){function i(i){var r=n.call(this)||this;return r.initialize(),t.extend(r,r,i,!0),i&&r.element&&r.updateFormatter(r.element,document,i.options),r}return bg(i,n),i.prototype.initialize=function(){this.keyConfig=lw;this.formatTags=oa;this.listTags=ha;this.selectionTags=sa},i.prototype.updateFormatter=function(n,t,i){n&&(this.editorManager=new ww({element:n,formatTags:this.formatTags,listTags:this.listTags,selectionTags:this.selectionTags,options:i}))},i}(ra),kw=function(){function n(n){this.parent=n}return n.prototype.renderPanel=function(){var t=this.parent,n=this.parent.createElement("div",{id:this.parent.getID()+"_view",className:"e-rte-content"});this.editableElement=this.parent.createElement("textarea",{className:"e-content",id:this.parent.getID()+"_editable-content"});n.appendChild(this.editableElement);this.setPanel(n);t.element.appendChild(n)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){return this.getEditPanel().value},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}(),kg=function(){function n(n,t){this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.saveSelection=new lh,this.parent.on(or,this.instantiateRenderer,this),this.parent.on(c,this.render,this),this.parent.on(a,this.onPropertyChanged,this),this.parent.on(ee,this.onToolbarClick,this),this.parent.on(u,this.destroy,this),this.parent.on(gr,this.selectAll,this),this.parent.on(nu,this.getSelectedHtml,this),this.parent.on(lt,this.onSelectionSave,this),this.parent.on(et,this.onSelectionRestore,this),this.parent.on(tu,this.updateReadOnly,this))},n.prototype.updateReadOnly=function(){this.parent.readonly?(this.parent.contentModule.getEditPanel().setAttribute("readonly","readonly"),t.addClass([this.parent.element],cu)):(this.parent.contentModule.getEditPanel().removeAttribute("readonly"),t.removeClass([this.parent.element],cu))},n.prototype.onSelectionSave=function(){var n=this.parent.contentModule.getEditPanel();this.saveSelection.save(n.selectionStart,n.selectionEnd)},n.prototype.onSelectionRestore=function(){this.contentRenderer.getEditPanel().focus();var n=this.parent.contentModule.getEditPanel();this.saveSelection.restore(n)},n.prototype.onToolbarClick=function(n){var u=n.item,t=this.parent.contentModule.getEditPanel(),r;t.focus();var f=t.selectionStart,e=t.selectionEnd,i=t.value.substring(f,e);switch(u.subCommand){case"Maximize":this.parent.notify(nf,{args:n});break;case"Minimize":this.parent.notify(tf,{args:n});break;case"CreateLink":this.parent.notify(rf,{member:"link",args:n,text:i,module:"Markdown"});break;case"Image":this.parent.notify(ar,{member:"image",args:n,text:i,module:"Markdown"});break;case"CreateTable":r={headingText:this.parent.localeObj.getConstant("TableHeadingText"),colText:this.parent.localeObj.getConstant("TableColText")};this.parent.formatter.process(this.parent,n,n.originalEvent,r);break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}},n.prototype.instantiateRenderer=function(){this.renderFactory.addRenderer(f.Content,new kw(this.parent))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.render),this.parent.off(a,this.onPropertyChanged),this.parent.off(u,this.destroy),this.parent.off(ee,this.onToolbarClick),this.parent.off(or,this.instantiateRenderer),this.parent.off(gr,this.selectAll),this.parent.off(nu,this.getSelectedHtml),this.parent.off(lt,this.onSelectionSave),this.parent.off(et,this.onSelectionRestore),this.parent.off(tu,this.updateReadOnly))},n.prototype.render=function(){this.contentRenderer=this.renderFactory.getRenderer(f.Content);var n=this.contentRenderer.getEditPanel(),i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};t.isNullOrUndefined(this.parent.formatter)?this.parent.formatter=new bw({element:n,options:i}):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),i);this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new fw(this.parent));this.parent.notify(du,{})},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.formatter)){var i=this.contentRenderer.getEditPanel(),r={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(i,this.contentRenderer.getDocument(),r)}},n.prototype.getModuleName=function(){return"markdownEditor"},n.prototype.selectAll=function(){this.parent.formatter.editorManager.markdownSelection.setSelection(this.parent.contentModule.getEditPanel(),0,this.parent.contentModule.getEditPanel().value.length)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()))},n}(),wh="INSERT-IMAGE",aa="INSERT-TABLE",va="INSERT-LINK",ya="INSERT-ROW",pa="INSERT-COLUMN",wa="DELETE-ROW",ba="DELETE-COLUMN",ka="REMOVE-TABLE",da="TABLE-HEADER",ga="TABLE_VERTICAL_ALIGN",nv="TABLE_MERGE",tv="TABLE_VERTICAL_SPLIT",iv="TABLE_HORIZONTAL_SPLIT",dw="TABLE_MOVE",rv="alignment-type",uv="indent-type",g="p",bi=["address","article","aside","audio","blockquote","canvas","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","hr","li","main","nav","noscript","ol","output","p","pre","section","table","tbody","td","tfoot","th","thead","tr","ul","video","body"],wt=["td","th"],bu=["table","tbody","td","tfoot","th","thead","tr"],fv="selection-type",ev="inserthtml-type",ov="insert-text-type",sv="clear-type",b=function(){function n(){this.startNodeName=[];this.endNodeName=[]}return n.prototype.saveInstance=function(n,t){return this.range=n.cloneRange(),this.rootNode=this.documentFromRange(n),this.body=t,this.startContainer=this.getNodeArray(n.startContainer,!0),this.endContainer=this.getNodeArray(n.endContainer,!1),this.startOffset=n.startOffset,this.endOffset=n.endOffset,this.html=this.body.innerHTML,this},n.prototype.documentFromRange=function(n){return 9===n.startContainer.nodeType?n.startContainer:n.startContainer.ownerDocument},n.prototype.getRange=function(n){var i=this.get(n),t=i&&i.rangeCount>0?i.getRangeAt(i.rangeCount-1):n.createRange();return t.startContainer!==n||t.endContainer!==n||t.startOffset||t.endOffset||(t.setStart(n.body,0),t.collapse(!0)),t},n.prototype.get=function(n){return n.defaultView.getSelection()},n.prototype.save=function(n,t){return n=n?n.cloneRange():this.getRange(t),this.saveInstance(n,t.body)},n.prototype.getIndex=function(n){var t=0;if(n=n.previousSibling||"BR"!==n.tagName?n.previousSibling:n)for(n.nodeType;n;null)t++,n.nodeType,n=n.previousSibling;return t},n.prototype.isChildNode=function(n,t){for(var i=0;i<t.childNodes.length;i++)if(n.indexOf(t.childNodes[i])>-1)return!0;return!1},n.prototype.getNode=function(n,t,i){return t!==n||3!==n.nodeType&&n.firstChild&&-1===i.indexOf(n.firstChild)&&!this.isChildNode(i,n)?-1===i.indexOf(n.firstChild)&&n.firstChild&&!this.isChildNode(i,n)?n.firstChild:n.nextSibling?n.nextSibling:n.parentNode?n.parentNode:null:null},n.prototype.getNodeCollection=function(n){var t=n.startContainer.childNodes[n.startOffset]||n.startContainer,r=n.endContainer.childNodes[n.endOffset>0?n.endOffset-1:n.endOffset]||n.endContainer,i;if((t===r||"BR"===t.nodeName&&t===n.endContainer.childNodes[n.endOffset])&&0===t.childNodes.length)return[t];if(n.startOffset===n.endOffset&&0!==n.startOffset&&"PRE"===n.startContainer.nodeName)return["BR"===t.nodeName||"#text"===t.nodeName?t:t.childNodes[0]];i=[];do-1===i.indexOf(t)&&i.push(t),t=this.getNode(t,r,i);while(t);return i},n.prototype.getParentNodeCollection=function(n){return this.getParentNodes(this.getNodeCollection(n),n)},n.prototype.getParentNodes=function(n,t){n=n.reverse();for(var i=0;i<n.length;i++)-1!==n.indexOf(n[i].parentNode)||3===n[i].nodeType&&t.startContainer!==t.endContainer&&t.startContainer.parentNode!==t.endContainer.parentNode?(n.splice(i,1),i--):3===n[i].nodeType&&(n[i]=n[i].parentNode);return n},n.prototype.getSelectionNodeCollection=function(n){return this.getSelectionNodes(this.getNodeCollection(n))},n.prototype.getSelectionNodeCollectionBr=function(n){return this.getSelectionNodesBr(this.getNodeCollection(n))},n.prototype.getSelectionNodes=function(n){n=n.reverse();for(var i=new RegExp(String.fromCharCode(8203),"g"),t=0;t<n.length;t++)(3!==n[t].nodeType||""===n[t].textContent.trim()||1===n[t].textContent.length&&n[t].textContent.match(i))&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getSelectionNodesBr=function(n){n=n.reverse();for(var i=new RegExp(String.fromCharCode(8203),"g"),t=0;t<n.length;t++)"BR"!==n[t].nodeName&&(3!==n[t].nodeType||""===n[t].textContent.trim()||1===n[t].textContent.length&&n[t].textContent.match(i))&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getInsertNodeCollection=function(n){return this.getInsertNodes(this.getNodeCollection(n))},n.prototype.getInsertNodes=function(n){n=n.reverse();for(var t=0;t<n.length;t++)(0!==n[t].childNodes.length&&3!==n[t].nodeType||3===n[t].nodeType&&""===n[t].textContent)&&(n.splice(t,1),t--);return n.reverse()},n.prototype.getNodeArray=function(n,i,r){var u=[];for(i?this.startNodeName=[]:this.endNodeName=[];n!==(r||this.rootNode)&&!t.isNullOrUndefined(n);null)i?this.startNodeName.push(n.nodeName.toLowerCase()):this.endNodeName.push(n.nodeName.toLowerCase()),u.push(this.getIndex(n)),n=n.parentNode;return u},n.prototype.setRangePoint=function(n,t,i,r){for(var u=this.rootNode,f=i.length,e=r;f--;null)u=u&&u.childNodes[i[f]];return u&&e>=0&&"html"!==u.nodeName&&n[t?"setStart":"setEnd"](u,e),n},n.prototype.restore=function(){var n=this.range.cloneRange();return n=this.setRangePoint(n,!0,this.startContainer,this.startOffset),n=this.setRangePoint(n,!1,this.endContainer,this.endOffset),this.selectRange(this.rootNode,n),n},n.prototype.selectRange=function(n,t){this.setRange(n,t);this.save(t,n)},n.prototype.setRange=function(n,t){var i=this.get(n);i.removeAllRanges();i.addRange(t)},n.prototype.setSelectionText=function(n,t,i,r,u){var f=n.createRange();f.setStart(t,r);f.setEnd(i,u);this.setRange(n,f)},n.prototype.setSelectionContents=function(n,t){var i=n.createRange();i.selectNode(t);this.setRange(n,i)},n.prototype.setSelectionNode=function(n,t){var i=n.createRange();i.selectNodeContents(t);this.setRange(n,i)},n.prototype.getSelectedNodes=function(n){return this.getNodeCollection(this.getRange(n))},n.prototype.Clear=function(n){this.get(n).removeAllRanges()},n.prototype.insertParentNode=function(n,t,i){i.surroundContents(t);this.selectRange(n,i)},n.prototype.setCursorPoint=function(n,t,i){var r=n.createRange(),u=n.defaultView.getSelection();r.setStart(t,i);r.collapse(!0);u.removeAllRanges();u.addRange(r)},n}(),e={startSelection:"e-editor-select-start",endSelection:"e-editor-select-end"},bh=function(){function n(n,t){this.parent=n;this.nodeSelection=new b;this.currentDocument=t}return n.prototype.contents=function(n){return n&&"IFRAME"!==n.tagName?Array.prototype.slice.call(n.childNodes||[]):[]},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&bi.indexOf(n.tagName.toLowerCase())>=0},n.prototype.isLink=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&"a"===n.tagName.toLowerCase()},n.prototype.blockParentNode=function(n){for(;n&&n.parentNode!==this.parent&&(!n.parentNode||!this.hasClass(n.parentNode,"e-node-inner"));null)if(n=n.parentNode,this.isBlockNode(n))return n;return n},n.prototype.rawAttributes=function(n){var u={},i=n.attributes,t,r;if(i.length>0)for(t=0;t<i.length;t++)r=i[t],u[r.nodeName]=r.value;return u},n.prototype.attributes=function(n){var i,t;if(!n)return"";for(var u="",f=this.rawAttributes(n),e=Object.keys(f).sort(),r=0;r<e.length;r++)i=e[r],t=f[i],u+=t.indexOf("'")<0&&t.indexOf('"')>=0?" "+i+"='"+t+"'":t.indexOf('"')>=0&&t.indexOf("'")>=0?" "+i+'="'+(t=t.replace(/"/g,"&quot;"))+'"':" "+i+'="'+t+'"';return u},n.prototype.clearAttributes=function(n){for(var r,i=n.attributes,t=i.length-1;t>=0;t--)r=i[t],n.removeAttribute(r.nodeName)},n.prototype.openTagString=function(n){return"<"+n.tagName.toLowerCase()+this.attributes(n)+">"},n.prototype.closeTagString=function(n){return"<\/"+n.tagName.toLowerCase()+">"},n.prototype.createTagString=function(n,t,i){return"<"+n.toLowerCase()+this.attributes(t)+">"+i+"<\/"+n.toLowerCase()+">"},n.prototype.isList=function(n){return!!n&&["UL","OL"].indexOf(n.tagName)>=0},n.prototype.isElement=function(n){return n===this.parent},n.prototype.isEditable=function(n){return(!n.getAttribute||"true"===n.getAttribute("contenteditable"))&&["STYLE","SCRIPT"].indexOf(n.tagName)<0},n.prototype.hasClass=function(n,t){return n&&n.classList&&n.classList.contains(t)},n.prototype.replaceWith=function(n,i){n.parentNode.insertBefore(this.parseHTMLFragment(i),n);t.detach(n)},n.prototype.parseHTMLFragment=function(n){var i=t.createElement("template");return i.innerHTML=n,i.content instanceof DocumentFragment?i.content:document.createRange().createContextualFragment(n)},n.prototype.wrap=function(n,t){return n.parentNode.insertBefore(t,n),(t=n.previousSibling).appendChild(n),t},n.prototype.insertAfter=function(n,t){t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.wrapInner=function(n,t){for(n.appendChild(t),(t=n.querySelector(".e-rte-wrap-inner")).classList.remove("e-rte-wrap-inner"),0===t.classList.length&&t.removeAttribute("class");n.firstChild!==t;)t.appendChild(n.firstChild);return t},n.prototype.unWrap=function(n){for(var i=n.parentNode,t=[];n.firstChild;)t.push(n.firstChild),i.insertBefore(n.firstChild,n);return t=t.length>0?t:[n.parentNode],i.removeChild(n),t},n.prototype.getSelectedNode=function(n,t){return n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t-1]&&n.childNodes[t-1].nodeType===Node.ELEMENT_NODE&&(n.childNodes[t-1].classList.contains(e.startSelection)||n.childNodes[t-1].classList.contains(e.endSelection))?n=n.childNodes[t-1]:n.nodeType===Node.ELEMENT_NODE&&n.childNodes.length>0&&n.childNodes[t]&&(n=n.childNodes[t]),n.nodeType===Node.TEXT_NODE&&(n=n.parentNode),n},n.prototype.nodeFinds=function(n,t){for(var r=[],i=0;i<t.length;i++)n.contains(t[i])&&n!==t[i]&&r.push(t[i]);return r},n.prototype.isEditorArea=function(){for(var n=this.getRangePoint(0).commonAncestorContainer;n&&!this.isElement(n);null)n=n.parentNode;return!!this.isElement(n)},n.prototype.getRangePoint=function(n){var t=this.getSelection(),i=[],r;if(t&&t.getRangeAt&&t.rangeCount)for(i=[],r=0;r<t.rangeCount;r++)i.push(t.getRangeAt(r));else i=[this.currentDocument.createRange()];return void 0!==n?i[n]:i},n.prototype.getSelection=function(){return this.nodeSelection.get(this.currentDocument)},n.prototype.getPreviousNode=function(n){for(n=n.previousElementSibling;n&&"\n"===n.textContent;null)n=n.previousElementSibling;return n},n.prototype.encode=function(n){var t=document.createElement("div");return t.innerText=n,t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},n.prototype.saveMarker=function(n,i){var f,s,r=this.parent.querySelector("."+e.startSelection),u=this.parent.querySelector("."+e.endSelection),o;return(""===r.textContent&&t.isNullOrUndefined(u)&&"tab"!==i&&(r.innerHTML=1===r.childNodes.length&&"BR"===r.childNodes[0].nodeName?"&#65279;&#65279;<br>":"&#65279;&#65279;"),this.hasClass(r,e.startSelection)&&r.classList.length>1)?(o=this.createTagString(g,r,this.encode(r.textContent)),this.replaceWith(r,o),(r=this.parent.querySelector("."+e.startSelection)).classList.remove(e.startSelection),f=r.childNodes[0]):f=this.unWrap(r)[0],this.hasClass(u,e.endSelection)&&u.classList.length>1?(o=this.createTagString(g,u,this.encode(u.textContent)),this.replaceWith(u,o),(u=this.parent.querySelector("."+e.endSelection)).classList.remove(e.endSelection),s=u.childNodes[0]):s=u?this.unWrap(u)[0]:f,n.startContainer=n.getNodeArray(f,!0),n.endContainer=n.getNodeArray(s,!1),n},n.prototype.marker=function(n,t){return'<span class="'+n+'">'+t+"<\/span>"},n.prototype.setMarker=function(n){var r=n.range,o=r.startContainer.childNodes,i=(o.length>1&&"TABLE"===o[0].nodeName?function(n){var t=n;do t.childNodes.length>0&&(t=t.childNodes[0]);while(t.childNodes.length>0);return t}(o[r.startOffset+1]):o[r.startOffset>0?r.startOffset-1:r.startOffset])||r.startContainer,u=r.endContainer.childNodes[r.endOffset>0?r.endOffset-1:r.endOffset]||r.endContainer,s;if(i.nodeType===Node.ELEMENT_NODE&&u.nodeType===Node.ELEMENT_NODE&&(i.contains(u)||u.contains(i))&&(s=i.contains(u)?i:u,s.nodeType!==Node.TEXT_NODE)){for(var h=[],f=[],t=s;s.contains(t);null)h.indexOf(t)<0&&t.childNodes&&t.childNodes.length?(h.push(t),t=t.childNodes[0]):t.nextSibling?t=t.nextSibling:t.parentNode&&(t=t.parentNode,h.push(t)),f.indexOf(t)<0&&(t.nodeType===Node.TEXT_NODE||wt.indexOf(t.parentNode.tagName.toLocaleLowerCase())>=0&&("BR"===t.tagName||"IMG"===t.tagName))&&f.push(t);f.length&&(i=i.contains(u)?f[0]:i,u=f[f.length-1])}i!==u?(i.nodeType!==Node.TEXT_NODE&&("BR"===i.tagName&&wt.indexOf(i.parentNode.tagName.toLocaleLowerCase())>=0||"IMG"===i.tagName)?(this.replaceWith(i,this.marker(e.startSelection,this.encode(i.textContent))),r.startContainer.querySelector("."+e.startSelection).appendChild(i)):this.replaceWith(i,this.marker(e.startSelection,this.encode(i.textContent))),u.nodeType!==Node.TEXT_NODE&&"BR"===u.tagName&&wt.indexOf(u.parentNode.tagName.toLocaleLowerCase())>=0?(this.replaceWith(u,this.marker(e.endSelection,this.encode(u.textContent))),r.endContainer.querySelector("."+e.endSelection).appendChild(u)):this.ensureSelfClosingTag(u,e.endSelection,r)):this.ensureSelfClosingTag(i,e.startSelection,r)},n.prototype.ensureSelfClosingTag=function(n,i,r){var h=!1,f,s,u,o,c;if(3===n.nodeType)this.replaceWith(n,this.marker(i,this.encode(n.textContent)));else if("BR"===n.tagName)this.replaceWith(n,this.marker(i,this.encode(n.textContent))),r.startContainer.querySelector("."+i).appendChild(n);else{if("IMG"===n.tagName&&(f=document.createElement("p"),n.parentElement.insertBefore(f,n),f.appendChild(n),n=f.children[0]),"TABLE"===n.tagName)if(h=!0,""===n.textContent)s=n.querySelectorAll("td"),n=s[s.length-1],n=t.isNullOrUndefined(n.childNodes[0])?n:n.childNodes[0];else{for(u=n.lastChild;3!==u.nodeType&&"#text"!==u.nodeName&&"BR"!==u.nodeName;)u=u.lastChild;n=u}for(o=0;o<la.length;o++)n=n.tagName!==la[o]||h?n:n.parentNode;3===n.nodeType&&"#text"===n.nodeName?this.replaceWith(n,this.marker(i,this.encode(n.textContent))):"BR"===n.nodeName?(this.replaceWith(n,this.marker(e.endSelection,this.encode(n.textContent))),r.endContainer.querySelector("."+e.endSelection).appendChild(n)):(c=this.marker(i,""),t.append([this.parseHTMLFragment(c)],n))}},n.prototype.createTempNode=function(n){var r=n.textContent,i,u,t;return"BR"===n.tagName?(i="<"+g+"><\/"+g+">",u=n.parentNode,wt.indexOf(u.tagName.toLocaleLowerCase())>=0&&(n=this.wrap(n,this.parseHTMLFragment(i)))):(n.nodeType!==Node.TEXT_NODE&&(n.classList.contains(e.startSelection)||n.classList.contains(e.endSelection))||r.replace(/\n/g,"").replace(/(^ *)|( *$)/g,"").length>0||r.length&&r.indexOf("\n")<0)&&(i="<"+g+"><\/"+g+">",t=n,n=this.wrap(n,this.parseHTMLFragment(i)),t.nodeType===Node.ELEMENT_NODE&&t.firstChild&&"BR"===t.firstChild.nodeName&&(t.classList.contains(e.startSelection)||t.classList.contains(e.endSelection))||!n.nextElementSibling||"BR"!==n.nextElementSibling.tagName||n.appendChild(n.nextElementSibling)),n},n.prototype.getImageTagInSelection=function(){var n=this.getSelection();return this.isEditorArea()&&n.rangeCount?n.focusNode.querySelectorAll("img"):null},n.prototype.blockNodes=function(){var i=[],y=this.getSelection(),c,h,a,o,n,f,v;if(this.isEditorArea()&&y.rangeCount)for(c=this.getRangePoint(),h=0;h<c.length;h++){var u=void 0,s=c[h],r=this.getSelectedNode(s.startContainer,s.startOffset),l=this.getSelectedNode(s.endContainer,s.endOffset);for((this.isBlockNode(r)&&i.indexOf(r)<0&&i.push(r),(u=this.blockParentNode(r))&&i.indexOf(u)<0)&&(wt.indexOf(u.tagName.toLocaleLowerCase())>=0&&("BR"===r.tagName||r.nodeType===Node.TEXT_NODE||r.classList.contains(e.startSelection)||r.classList.contains(e.endSelection))?(a=r.previousSibling&&r.previousSibling.nodeType===Node.TEXT_NODE?r.previousSibling:r,r.nextSibling||r.previousSibling||"BR"!==r.tagName?i.push(this.createTempNode(a)):i.push(a)):i.push(u)),o=[],n=r;n!==l&&n!==this.parent;null)o.indexOf(n)<0&&n.childNodes&&n.childNodes.length?(o.push(n),n=n.childNodes[0]):n&&8!==n.nodeType&&("BR"===n.tagName||n.nodeType===Node.TEXT_NODE&&""!==n.textContent.trim()||n.nodeType!==Node.TEXT_NODE&&(n.classList.contains(e.startSelection)||n.classList.contains(e.endSelection)))&&wt.indexOf(n.parentNode.tagName.toLocaleLowerCase())>=0?n=this.createTempNode(n):n.nextSibling&&8!==n.nextSibling.nodeType&&("BR"===n.nextSibling.tagName||n.nextSibling.nodeType===Node.TEXT_NODE||n.nextSibling.classList.contains(e.startSelection)||n.nextSibling.classList.contains(e.endSelection))&&wt.indexOf(n.nextSibling.parentNode.tagName.toLocaleLowerCase())>=0?n=this.createTempNode(n.nextSibling):n.nextSibling?n=n.nextSibling:n.parentNode&&(n=n.parentNode,o.push(n)),i.indexOf(n)<0&&n.nodeType===Node.ELEMENT_NODE&&wt.indexOf(n.parentNode.tagName.toLocaleLowerCase())>=0&&(n.classList.contains(e.startSelection)||n.classList.contains(e.endSelection))&&i.push(this.createTempNode(n)),this.isBlockNode(n)&&this.ignoreTableTag(n)&&o.indexOf(n)<0&&i.indexOf(n)<0&&(n!==l||s.endOffset>0)&&i.push(n),"IMG"===n.nodeName&&"true"===n.parentElement.contentEditable&&i.push(n);(u=this.blockParentNode(l))&&this.ignoreTableTag(u)&&i.indexOf(u)<0&&!t.isNullOrUndefined(u.previousElementSibling)&&"IMG"!==u.previousElementSibling.tagName&&i.push(u)}for(f=i.length-1;f>0;f--)if((o=this.nodeFinds(i[f],i)).length){if(v=i[f].querySelectorAll("ul, ol"),"LI"===i[f].tagName&&v.length>0)continue;i.splice(f,1)}return i},n.prototype.ignoreTableTag=function(n){return!(bu.indexOf(n.tagName.toLocaleLowerCase())>=0)},n}(),gw=function(){function n(n){this.parent=n;this.domNode=this.parent.domNode;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(dl,this.applyListsHandler,this);this.parent.observer.on(l,this.keyDownHandler,this);this.parent.observer.on(ia,this.spaceKeyAction,this)},n.prototype.testList=function(n){var r=[/^[\d]+[.]+$/,/^(?=[MDCLXVI])M*(C[MD]|D?C{0,3})(X[CL]|L?X{0,3})(I[XV]|V?I{0,3})[.]$/gi,/^[a-zA-Z][.]+$/],u=t.isNullOrUndefined(n)?null:n.innerText.trim().split(".")[0]+".",i;if(!t.isNullOrUndefined(u))for(i=0;i<r.length;i++)if(r[i].test(u))return!0;return!1},n.prototype.testCurrentList=function(n){var u=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/],r,i;if(!t.isNullOrUndefined(n.startContainer.textContent.slice(0,n.startOffset)))for(r=n.startContainer.textContent.replace(/\u200B/g,"").slice(0,n.startOffset).trim(),i=0;i<u.length;i++)if(u[i].test(r)&&2===r.length)return!0;return!1},n.prototype.spaceList=function(n){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument);this.saveSelection=this.parent.nodeSelection.save(i,this.parent.currentDocument);var f=this.parent.domNode.getSelectedNode(i.startContainer,i.startOffset),r=(this.parent.domNode.getSelectedNode(i.endContainer,i.endOffset),f.previousElementSibling),u=f.nextElementSibling,e=t.isNullOrUndefined(r)?null:r.innerText.trim().substring(0,1),o=t.isNullOrUndefined(u)?null:u.innerText.trim().substring(0,1),s=this.testCurrentList(i),h=this.testList(r),c=this.testList(u);h||c||"*"===e||"*"===o||(s?(i.startContainer.textContent=i.startContainer.textContent.slice(i.startOffset,i.startContainer.textContent.length),this.applyListsHandler({subCommand:"OL",callBack:n.callBack}),n.event.preventDefault()):"*"!==i.startContainer.textContent.replace(/\u200B/g,"").slice(0,i.startOffset).trim()&&"-"!==i.startContainer.textContent.replace(/\u200B/g,"").slice(0,i.startOffset).trim()||(i.startContainer.textContent=i.startContainer.textContent.slice(i.startOffset,i.startContainer.textContent.length),this.applyListsHandler({subCommand:"UL",callBack:n.callBack}),n.event.preventDefault()))},n.prototype.enterList=function(n){var r=this.parent.nodeSelection.getRange(this.parent.currentDocument),i="LI"===r.startContainer.nodeName?r.startContainer:r.startContainer.parentElement.closest("LI"),e="LI"===r.endContainer.nodeName?r.endContainer:r.endContainer.parentElement.closest("LI"),u,o,f;t.isNullOrUndefined(i)||t.isNullOrUndefined(e)||i!==e||"LI"!==i.tagName||""!==i.textContent.trim()||(65279===i.textContent.charCodeAt(0)&&(i.textContent=""),u=i.parentElement,t.isNullOrUndefined(u.parentElement.closest("UL"))&&t.isNullOrUndefined(u.parentElement.closest("OL"))&&(t.isNullOrUndefined(i.nextElementSibling)||(o=this.parent.domNode.blockParentNode(i),this.parent.nodeCutter.GetSpliceNode(r,o)),f=void 0,"DIV"===n.enterAction?(f=t.createElement("div")).innerHTML="<br>":"P"===n.enterAction?(f=t.createElement("p")).innerHTML="<br>":f=t.createElement("br"),this.parent.domNode.insertAfter(f,u),n.event.preventDefault(),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,f,0),""===u.textContent?t.detach(u):t.detach(i)))},n.prototype.backspaceList=function(){var u=this.parent.nodeSelection.getRange(this.parent.currentDocument),n=this.parent.domNode.getSelectedNode(u.startContainer,u.startOffset),r=this.parent.domNode.getSelectedNode(u.endContainer,u.endOffset),i;if((n="BR"===n.nodeName?n.parentElement:n)===(r="BR"===r.nodeName?r.parentElement:r)&&!t.isNullOrUndefined(t.closest(n,"li"))&&(""===n.textContent.trim()&&65279===n.textContent.charCodeAt(0)||1===n.textContent.length&&8203===n.textContent.charCodeAt(0))&&(n.textContent=""),n===r&&""===n.textContent){if("LI"===n.parentElement.tagName&&"LI"===r.parentElement.tagName)t.detach(n);else if((n.closest("ul")||n.closest("ol"))&&(i=t.isNullOrUndefined(n.closest("ul"))?n.closest("ol"):n.closest("ul")).firstElementChild===n&&!t.isNullOrUndefined(i.children[1])&&("OL"===i.children[1].tagName||"UL"===i.children[1].tagName))if(i.tagName===i.children[1].tagName){for(;i.children[1].lastChild;)this.parent.domNode.insertAfter(i.children[1].lastChild,i.children[1]);t.detach(i.children[1])}else i.parentElement.insertBefore(i.children[1],i)}else if(!(t.isNullOrUndefined(n.firstChild)||"BR"!==n.firstChild.nodeName||t.isNullOrUndefined(n.childNodes[1])||"UL"!==n.childNodes[1].nodeName&&"OL"!==n.childNodes[1].nodeName))if((i=t.isNullOrUndefined(n.closest("ul"))?n.closest("ol"):n.closest("ul")).tagName===n.childNodes[1].nodeName){for(;n.childNodes[1].lastChild;)this.parent.domNode.insertAfter(n.children[1].lastChild,n);t.detach(n.childNodes[1])}else i.parentElement.insertBefore(n.children[1],i)},n.prototype.keyDownHandler=function(n){var i,r,l,a;if(13===n.event.which&&this.enterList(n),32===n.event.which&&this.spaceList(n),8===n.event.which&&this.backspaceList(n),46===n.event.which&&"delete"===n.event.action){var s=(i=this.parent.nodeSelection.getRange(this.parent.currentDocument)).commonAncestorContainer,h=i.startContainer,c=i.endContainer,f=3===h.nodeType?h.parentElement:h,o=3===c.nodeType?c.parentElement:c;"UL"!==s.nodeName&&"OL"!==s.nodeName||f===o||t.isNullOrUndefined(t.closest(f,"ul"))&&t.isNullOrUndefined(t.closest(f,"ol"))||t.isNullOrUndefined(t.closest(o,"ul"))&&t.isNullOrUndefined(t.closest(o,"ol"))||s.lastElementChild!==t.closest(o,"li")||i.collapsed||t.detach(s)}if(9===n.event.which){if(i=this.parent.nodeSelection.getRange(this.parent.currentDocument),n.event.action&&"indent"===n.event.action||(this.saveSelection=this.parent.nodeSelection.save(i,this.parent.currentDocument)),l=i.startOffset,a=i.endOffset,(f=this.parent.domNode.getSelectedNode(i.startContainer,i.startOffset))===(o=this.parent.domNode.getSelectedNode(i.endContainer,i.endOffset))&&("BR"===f.nodeName||"#text"===f.nodeName)&&wt.indexOf(f.parentNode.tagName.toLocaleLowerCase())>=0)return;n.event.action&&"indent"===n.event.action||this.domNode.setMarker(this.saveSelection);r=this.domNode.blockNodes();for(var e=[],v=!0,u=0;u<r.length;u++)"LI"===r[u].parentNode.tagName?e.push(r[u].parentNode):"LI"===r[u].tagName&&"P"!==r[u].childNodes[0].tagName&&"OL"!==r[u].childNodes[0].tagName&&"UL"!==r[u].childNodes[0].tagName&&e.push(r[u]);e.length>1||e.length&&(0===l&&0===a||n.ignoreDefault)?(n.event.preventDefault(),n.event.stopPropagation(),this.currentAction=this.getAction(e[0]),n.event.shiftKey?(this.revertList(e),this.revertClean()):v=this.nestedList(e),v&&(this.cleanNode(),this.parent.editableElement.focus()),n.event.action&&"indent"===n.event.action||(this.saveSelection=this.domNode.saveMarker(this.saveSelection),this.saveSelection.restore(),n.callBack&&n.callBack({requestType:this.currentAction,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes(),event:n.event}))):n.event.action&&"indent"===n.event.action||(n.event&&n.event.shiftKey&&"Tab"===n.event.key&&(n.event.action="tab"),this.saveSelection=this.domNode.saveMarker(this.saveSelection,n.event.action),this.saveSelection.restore())}else switch(n.event.action){case"ordered-list":this.applyListsHandler({subCommand:"OL",callBack:n.callBack});n.event.preventDefault();break;case"unordered-list":this.applyListsHandler({subCommand:"UL",callBack:n.callBack});n.event.preventDefault()}},n.prototype.spaceKeyAction=function(n){32===n.event.which&&this.spaceList(n)},n.prototype.getAction=function(n){return"OL"===n.parentNode.nodeName?"OL":"UL"},n.prototype.revertClean=function(){for(var n,t,r,u=this.parent.editableElement.querySelectorAll("ul, ol"),i=0;i<u.length;i++)if(n=u[i].querySelectorAll("ul, ol"),n.length>0)for(t=0;t<n.length;t++)r=n[t].previousSibling,r&&"LI"===r.tagName&&r.appendChild(n[t])},n.prototype.noPreviousElement=function(n){var e,r,c=n.querySelectorAll("ol, ul"),s=n.querySelectorAll("li"),h=this.domNode.contents(s[0])[0],i,o,u,f;if(s.length>0&&("OL"===h.nodeName||"UL"===h.nodeName)?e=s[0]:r=c[0],e)for(i=this.domNode.contents(n)[0];i&&!this.domNode.isList(i);null)o=i.nextSibling,t.prepend([i],e),t.setStyleAttribute(n,{"list-style-type":"none"}),t.setStyleAttribute(e,{"list-style-type":""}),i=o;else if(r){for(u=t.createElement("li"),t.prepend([u],r),i=this.domNode.contents(n)[0];i&&!this.domNode.isList(i);null)o=i.nextSibling,u.appendChild(i),i=o;t.prepend([r],n.parentNode);t.detach(n);f=t.createElement("li",{styles:"list-style-type: none;"});t.prepend([f],r.parentNode);t.append([r],f)}else f=t.createElement("li",{styles:"list-style-type: none;"}),t.prepend([f],n.parentNode),u=t.createElement(n.parentNode.tagName),t.prepend([u],f),t.append([n],u)},n.prototype.nestedList=function(n){for(var u,f,r,h,a,o=!1,i=0;i<n.length;i++)if(u=this.domNode.getPreviousNode(n[i]),u){o=!0;var s=void 0,e=void 0,v=n[i].querySelectorAll("ol, ul"),c=n[i].querySelectorAll("li"),l=this.domNode.contents(c[0])[0];if(c.length>0&&("OL"===l.nodeName||"UL"===l.nodeName)?e=c[0]:s=v[0],s){for(f=t.createElement("li"),t.prepend([f],s),r=this.domNode.contents(n[i])[0];r&&!this.domNode.isList(r);null)h=r.nextSibling,f.appendChild(r),r=h;t.append([s],u);t.detach(n[i])}else if(e){if("LI"===u.tagName){for(r=this.domNode.contents(n[i])[0];r&&!this.domNode.isList(r);null)h=r.nextSibling,t.prepend([r],e),t.setStyleAttribute(n[i],{"list-style-type":"none"}),t.setStyleAttribute(e,{"list-style-type":""}),r=h;t.append([e.parentNode],u);t.detach(n[i])}}else"LI"===u.tagName&&(f=t.createElement(n[i].parentNode.tagName),t.append([f],u),t.append([n[i]],f))}else a=n[i],o=!0,this.noPreviousElement(a);return o},n.prototype.applyListsHandler=function(n){var a=this.parent.nodeSelection.getRange(this.parent.currentDocument),u,i,r,l,s,f,e,o;if(this.saveSelection=this.parent.nodeSelection.save(a,this.parent.currentDocument),this.currentAction=n.subCommand,this.currentAction=n.subCommand="NumberFormatList"===this.currentAction?"OL":"BulletFormatList"===this.currentAction?"UL":this.currentAction,this.domNode.setMarker(this.saveSelection),u=this.domNode.blockNodes(),"BR"===n.enterAction){this.setSelectionBRConfig();var v=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),h=this.parent.nodeSelection.getSelectionNodes(v),c=[];for(0===h.length&&h.push(u[0]),i=0;i<h.length;i++){for(r=h[i],l=void 0;!this.parent.domNode.isBlockNode(r)&&r!==this.parent.editableElement;)l=r,r=r.parentElement;this.parent.domNode.isBlockNode(r)&&r===this.parent.editableElement&&c.push(l)}for(i=0;i<c.length;i++)if(!this.parent.domNode.isBlockNode(c[i])){for(s=r=c[i];r===this.parent.editableElement;)s=r,r=r.parentElement;for(f=void 0,this.parent.domNode.isBlockNode(s.parentElement)&&s.parentElement===this.parent.editableElement?(f=t.createElement("p"),s.parentElement.insertBefore(f,s),f.appendChild(s)):f=s,e=f.previousSibling;!t.isNullOrUndefined(e)&&"BR"!==e.nodeName&&!this.parent.domNode.isBlockNode(e);)f.firstChild.parentElement.insertBefore(e,f.firstChild),e=f.previousSibling;for(t.isNullOrUndefined(e)||"BR"!==e.nodeName||t.detach(e),o=f.nextSibling;!t.isNullOrUndefined(o)&&"BR"!==o.nodeName&&!this.parent.domNode.isBlockNode(o);)f.appendChild(o),o=f.nextSibling;t.isNullOrUndefined(o)||"BR"!==o.nodeName||t.detach(o)}this.setSelectionBRConfig();u=this.parent.domNode.blockNodes()}for(i=0;i<u.length;i++)"TABLE"!==u[i].tagName||a.collapsed||u.splice(i,1),u.length>0&&"LI"!==u[i].tagName&&"LI"===u[i].parentNode.tagName&&(u[i]=u[i].parentNode);this.applyLists(u,this.currentAction,n.selector,n.item);n.callBack&&n.callBack({requestType:this.currentAction,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.setSelectionBRConfig=function(){var n=this.parent.editableElement.querySelector("."+e.startSelection),i=this.parent.editableElement.querySelector("."+e.endSelection);t.isNullOrUndefined(i)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,i,0,0)},n.prototype.applyLists=function(n,i,r,u){var f,e;if(this.isRevert(n,i)&&t.isNullOrUndefined(u))this.revertList(n),this.removeEmptyListElements();else for(this.checkLists(n,i,u),f=0;f<n.length;f++)if(t.isNullOrUndefined(u)||t.isNullOrUndefined(u.listStyle)||("listImage"===u.listStyle?t.setStyleAttribute(n[f],{"list-style-image":u.listImage}):(t.setStyleAttribute(n[f],{"list-style-image":"none"}),t.setStyleAttribute(n[f],{"list-style-type":u.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),"true"===n[f].getAttribute("contenteditable")&&1===n[f].childNodes.length&&"TABLE"===n[f].childNodes[0].nodeName)e=document.createElement(i),e.innerHTML="<li><br/><\/li>",n[f].appendChild(e);else if("LI"!==n[f].tagName&&t.isNullOrUndefined(u)){var o="<"+i+">",s="<\/"+i+">",h="li"+("IMG"===n[f].tagName?"":this.domNode.attributes(n[f])),c=n[f].tagName.toLowerCase()===g?n[f].innerHTML:n[f].outerHTML,l=o+this.domNode.createTagString(h,null,c)+s;this.domNode.replaceWith(n[f],l)}else t.isNullOrUndefined(u)||"LI"===n[f].tagName||(o="<"+i+("IMG"===n[f].tagName?"":this.domNode.attributes(n[f]))+">",s="<\/"+i+">",h="li",c=n[f].tagName.toLowerCase()===g?n[f].innerHTML:n[f].outerHTML,l=o+this.domNode.createTagString(h,null,c)+s,this.domNode.replaceWith(n[f],l));this.cleanNode();this.parent.editableElement.focus();d()&&wi(this.parent.editableElement,r);this.saveSelection=this.domNode.saveMarker(this.saveSelection);this.saveSelection.restore()},n.prototype.removeEmptyListElements=function(){for(var i=this.parent.editableElement.querySelectorAll("ol, ul"),n=0;n<i.length;n++)""===i[n].textContent.trim()&&t.detach(i[n])},n.prototype.isRevert=function(n,t){for(var r=!0,i=0;i<n.length;i++){if("LI"!==n[i].tagName)return!1;n[i].parentNode.tagName!==t&&(r=!1)}return r},n.prototype.checkLists=function(n,i,r){for(var u,o,s,h,f=[],e=0;e<n.length;e++)u=n[e].parentNode,t.isNullOrUndefined(r)||"LI"!==n[e].tagName||t.isNullOrUndefined(r.listStyle)||("listImage"===r.listStyle?t.setStyleAttribute(u,{"list-style-image":r.listImage}):(t.setStyleAttribute(u,{"list-style-image":"none"}),t.setStyleAttribute(u,{"list-style-type":r.listStyle.replace(/([a-z])([A-Z])/g,"$1-$2").toLowerCase()}))),("LI"===n[e].tagName&&u.tagName!==i&&f.indexOf(u)<0||"LI"===n[e].tagName&&u.tagName===i&&f.indexOf(u)<0&&null!==r)&&f.push(u);for(o=f.length-1;o>=0;o--)s=f[o],h="<"+i.toLowerCase()+" "+this.domNode.attributes(s)+">"+s.innerHTML+"<\/"+i.toLowerCase()+">",this.domNode.replaceWith(f[o],h)},n.prototype.cleanNode=function(){for(var n,u,i,r=this.parent.editableElement.querySelectorAll("ol + ol, ul + ul"),t=0;t<r.length;t++)if(n=r[t],this.domNode.isList(n.previousElementSibling)&&this.domNode.openTagString(n)===this.domNode.openTagString(n.previousElementSibling)){for(u=this.domNode.contents(n),i=0;i<u.length;i++)n.previousElementSibling.appendChild(u[i]);n.parentNode.removeChild(n)}},n.prototype.findUnSelected=function(n,t){var r,s,h,e,a,c,u;if((n=n.slice().reverse()).length>0){var l=[],i=[],f=[],o=[];for(f=t[t.length-1].childNodes,r=0;r<f.length;r++)if(("OL"===f[r].tagName||"UL"===f[r].tagName)&&(s=f[r].querySelectorAll("li"),s.length>0))for(h=0;h<s.length;h++)o.push(s[h]);for(e=0;e<o.length;e++){for(a=0,c=0;c<n.length;c++)o[e].contains(n[c])||(a+=1);a===n.length&&i.push(o[e])}if(i.length>0)for(u=0;u<i.length;u++)"OL"!==this.domNode.contents(i[u])[0].nodeName&&"UL"!==this.domNode.contents(i[u])[0].nodeName&&l.push(i[u]);l.length>0&&this.nestedList(l)}},n.prototype.revertList=function(n){for(var c,l,r,u,f,o,p,w,d,nt,y,s,h,a,b,k,v=[],i=n.length-1;i>=0;i--)for(c=i-1;c>=0;c--)if(n[c].contains(n[i])||n[c]===n[i]){v.push(n[i]);n.splice(i,1);break}for(this.findUnSelected(v,n),l=[],i=0;i<n.length;i++)r=n[i],3===this.domNode.contents(r)[0].nodeType&&0===this.domNode.contents(r)[0].textContent.trim().length&&t.detach(this.domNode.contents(r)[0]),u=n[i].parentNode,f=r.getAttribute("class"),0===v.length&&(o=n[i].querySelectorAll("ul, ol")[0],o&&o.querySelectorAll("li")&&(p=t.createElement(o.tagName),t.append([p],o.parentNode),w=t.createElement("li",{styles:"list-style-type: none;"}),t.append([w],p),t.append([o],w))),(r.parentNode.insertBefore(this.closeTag(u.tagName),r),"LI"===u.parentNode.tagName)?r.parentNode.insertBefore(this.closeTag("LI"),r):(g&&0===r.querySelectorAll(bi.join(", ")).length?(d=t.isNullOrUndefined(f)?' class="e-rte-wrap-inner"':' class="'+f+' e-rte-wrap-inner"',nt="<"+g+d+this.domNode.attributes(u)+"><\/"+g+">",this.domNode.wrapInner(r,this.domNode.parseHTMLFragment(nt))):3===this.domNode.contents(r)[0].nodeType?(y=this.domNode.createTagString(g,u,this.parent.domNode.encode(this.domNode.contents(r)[0].textContent)),this.domNode.replaceWith(this.domNode.contents(r)[0],y)):this.domNode.contents(r)[0].classList.contains(e.startSelection)||this.domNode.contents(r)[0].classList.contains(e.endSelection)?(y=this.domNode.createTagString(g,u,this.domNode.contents(r)[0].outerHTML),this.domNode.replaceWith(this.domNode.contents(r)[0],y)):(s=r.firstChild,f=s.getAttribute("class"),t.attributes(s,this.domNode.rawAttributes(u)),f&&s.getAttribute("class")&&t.attributes(s,{"class":f+" "+s.getAttribute("class")})),t.append([this.openTag("LI")],r),t.prepend([this.closeTag("LI")],r)),this.domNode.insertAfter(this.openTag(u.tagName),r),"LI"===u.parentNode.tagName&&(u=u.parentNode.parentNode),l.indexOf(u)<0&&l.push(u);for(i=0;i<l.length;i++)h=l[i],a=h.innerHTML,a=(a=a.replace(/<span class="e-rte-list-close-([a-z]*)"><\/span>/g,"<\/$1>")).replace(/<span class="e-rte-list-open-([a-z]*)"><\/span>/g,"<$1 "+this.domNode.attributes(h)+">"),this.domNode.replaceWith(h,this.domNode.openTagString(h)+a.trim()+this.domNode.closeTagString(h));for(b=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),i=0;i<b.length;i++)t.detach(b[i]);for(k=this.parent.editableElement.querySelectorAll("li:empty"),i=0;i<k.length;i++)t.detach(k[i])},n.prototype.openTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-open-'+n.toLowerCase()+'"><\/span>')},n.prototype.closeTag=function(n){return this.domNode.parseHTMLFragment('<span class="e-rte-list-close-'+n.toLowerCase()+'"><\/span>')},n}(),h=function(){function n(){}return n.WrapBefore=function(n,t,i){return t.innerText=n.textContent,i?this.AppendBefore(t,n,!0):this.AppendBefore(t,n),n.parentNode&&n.parentNode.removeChild(n),t.childNodes[0]},n.Wrap=function(n,t){return this.AppendBefore(t,n),t.appendChild(n),n},n.unwrap=function(n){for(var t=n.parentNode,i=[];n.firstChild;null)i.push(t.insertBefore(n.firstChild,n));return t.removeChild(n),i},n.AppendBefore=function(n,t,i){return t.parentNode?i?t.parentNode.insertBefore(n,t.nextSibling):t.parentNode.insertBefore(n,t):t},n}(),ur=function(){function n(){this.enterAction="P";this.position=-1;this.nodeSelection=new b}return n.prototype.GetSpliceNode=function(n,t){return t=this.SplitNode(n,t,!0),this.SplitNode(n,t,!1)},n.prototype.SplitNode=function(n,t,i){var e,r;if(t){var f=n.cloneRange(),u=t.parentNode,o=this.nodeSelection.getIndex(t);return f.collapse(i),i?f.setStartBefore(t):f.setEndAfter(t),r=f.extractContents(),i?(t=u.childNodes[o],(r=this.spliceEmptyNode(r,!1))&&r.childNodes.length>0&&(1===r.childNodes.length&&"IMG"!==r.childNodes[0].nodeName&&this.isImgElm(r)&&""===r.textContent||(t?h.AppendBefore(r,t):(u.appendChild(r),(e=document.createElement("div")).innerHTML="&#65279;&#65279;",t=e.firstChild,u.appendChild(t))))):(t=u.childNodes.length>1?u.childNodes[o]:u.childNodes[0],(r=this.spliceEmptyNode(r,!0))&&r.childNodes.length>0&&(1===r.childNodes.length&&"IMG"!==r.childNodes[0].nodeName&&this.isImgElm(r)&&""===r.textContent.trim()||(t?h.AppendBefore(r,t,!0):(u.appendChild(r),(e=document.createElement("div")).innerHTML="&#65279;&#65279;",u.insertBefore(e.firstChild,u.firstChild),t=u.firstChild)))),t}return null},n.prototype.isImgElm=function(n){var u=!0,i,r;if(1===n.childNodes.length&&"IMG"!==n.childNodes[0].nodeName)for(i=n.childNodes[0],r=0;!t.isNullOrUndefined(i.childNodes)&&r<i.childNodes.length;r++)"IMG"===i.childNodes[r].nodeName&&(u=!1);else u=!0;return u},n.prototype.spliceEmptyNode=function(n,t){var i;return(i=1===n.childNodes.length&&"#text"===n.childNodes[0].nodeName&&""===n.childNodes[0].textContent||""===n.textContent?-1:n.childNodes.length-1)>-1&&!t?this.spliceEmptyNode(n.childNodes[i],t):i>-1?this.spliceEmptyNode(n.childNodes[0],t):3!==n.nodeType&&11!==n.nodeType&&n.parentNode.removeChild(n),n},n.prototype.GetCursorStart=function(n,t,i){for(var u=(n=i?n:n.reverse())[0],r=0;r<n.length&&(i?n[r]<t:n[r]>=t);r++)u=n[r];return u},n.prototype.GetCursorRange=function(n,t,i){var e=n.createRange(),r=[],f,u,o;for(r.push(0),f=this.TrimLineBreak(i.data),u=f.indexOf(" ",0);-1!==u;)r.indexOf(u)<0&&r.push(u),new RegExp("\\s").test(f[u-1])&&r.indexOf(u-1)<0&&r.push(u-1),new RegExp("\\s").test(f[u+1])&&r.push(u+1),u=f.indexOf(" ",u+1);return(r.push(f.length),r.indexOf(t.startOffset)>=0||r.indexOf(t.startOffset-1)>=0&&(1!==t.startOffset||1===t.startOffset&&new RegExp("\\s").test(f[0]))||r[r.length-1]-1===t.startOffset)?(e=t,this.position=1):(o=this.GetCursorStart(r,t.startOffset,!0),this.position=t.startOffset-o,e.setStart(t.startContainer,o),e.setEnd(t.startContainer,this.GetCursorStart(r,t.startOffset,!1))),e},n.prototype.GetCursorNode=function(n,t,i){return this.GetSpliceNode(this.GetCursorRange(n,t,i),i)},n.prototype.TrimLineBreak=function(n){return n.replace(/(\r\n\t|\n|\r\t)/gm," ")},n}(),nb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(te,this.applyFormats,this);this.parent.observer.on(hi,this.onKeyUp,this);this.parent.observer.on(l,this.onKeyDown,this)},n.prototype.getParentNode=function(n){for(;n.parentNode&&n.parentNode!==this.parent.editableElement;null)n=n.parentNode;return n},n.prototype.onKeyUp=function(n){var e=this.parent.nodeSelection.getRange(this.parent.currentDocument),f=e.endContainer,i=f.lastChild,r,u;13===n.event.which&&e.startContainer===f&&3!==f.nodeType&&(r=t.createElement("p"),(r.innerHTML="<br>",!t.isNullOrUndefined(i)&&i&&"BR"===i.nodeName&&i.previousSibling&&"TABLE"===i.previousSibling.nodeName)?(f.replaceChild(r,i),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0)):(u=this.parent.nodeSelection.getSelectionNodeCollectionBr(e)[0],!t.isNullOrUndefined(u)&&"BR"===u.nodeName&&u.previousSibling&&"TABLE"===u.previousSibling.nodeName&&(f.replaceChild(r,u),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0))))},n.prototype.onKeyDown=function(n){if(13===n.event.which){var i=this.parent.nodeSelection.getRange(this.parent.currentDocument),h=0===i.startContainer.textContent.length||"PRE"===i.startContainer.nodeName?i.startContainer:i.startContainer.parentElement,o=0===i.endContainer.textContent.length||"PRE"===i.endContainer.nodeName?i.endContainer:i.endContainer.parentElement,u=t.closest(h,"pre"),f=t.closest(o,"pre");if(!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(u.parentElement)&&"LI"===u.parentElement.tagName)return;if((t.isNullOrUndefined(u)&&!t.isNullOrUndefined(f)||!t.isNullOrUndefined(u)&&t.isNullOrUndefined(f))&&(n.event.preventDefault(),this.deleteContent(i),this.removeCodeContent(i),i=this.parent.nodeSelection.getRange(this.parent.currentDocument),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,o,0)),13===n.event.which&&!t.isNullOrUndefined(u)&&!t.isNullOrUndefined(f)){n.event.preventDefault();this.deleteContent(i);this.removeCodeContent(i);var e=(i=this.parent.nodeSelection.getRange(this.parent.currentDocument)).startContainer.childNodes[i.endOffset],s=i.startContainer.childNodes[i.endOffset-1],r=i.startContainer;if(t.isNullOrUndefined(e)||t.isNullOrUndefined(s)||!t.isNullOrUndefined(e.nextSibling)||"BR"!==e.nodeName||"BR"!==s.nodeName)if(8203===r.textContent.charCodeAt(0)&&1===r.textContent.length||0===r.textContent.length){for(;"PRE"!==r.parentElement.nodeName&&(1===r.textContent.length||0===r.textContent.length);)r=r.parentElement;!t.isNullOrUndefined(r.previousSibling)&&"BR"===r.previousSibling.nodeName&&t.isNullOrUndefined(r.nextSibling)?this.paraFocus(r.parentElement):this.isNotEndCursor(u,i)}else this.isNotEndCursor(u,i);else this.paraFocus(i.startContainer,n.enterAction)}}},n.prototype.removeCodeContent=function(n){var i=new RegExp(String.fromCharCode(65279),"g"),r;t.isNullOrUndefined(n.endContainer.textContent.match(i))||(r=65279===n.endContainer.textContent.charCodeAt(n.endOffset-1)?n.endOffset-2:n.endOffset,n.endContainer.textContent=n.endContainer.textContent.replace(i,""),""===n.endContainer.textContent?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer.parentElement,0):this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n.endContainer,r))},n.prototype.deleteContent=function(n){n.startContainer===n.endContainer&&n.startOffset===n.endOffset||n.deleteContents()},n.prototype.paraFocus=function(n,i){var r;"DIV"===i?(r=t.createElement("div")).innerHTML="<br>":"BR"===i?r=t.createElement("br"):(r=t.createElement("p")).innerHTML="<br>";this.parent.domNode.insertAfter(r,n);this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0);t.detach(n.lastChild)},n.prototype.isNotEndCursor=function(n,i){var e=new ur,o=i.startOffset===n.lastChild.textContent.length&&n.lastChild.textContent===i.startContainer.textContent,u,f,r;0===n.textContent.indexOf(i.startContainer.textContent)&&(0===i.startOffset&&0===i.endOffset||"PRE"===i.startContainer.nodeName)?(this.insertMarker(n,i),u=t.createElement("br"),n.childNodes[i.endOffset].parentElement.insertBefore(u,n.childNodes[i.endOffset])):(f=e.SplitNode(i,n,!0),this.insertMarker(n,i),r=n.previousElementSibling,"PRE"===r.tagName&&(r.insertAdjacentHTML("beforeend","<br>"+f.innerHTML),t.detach(n)));this.setCursorPosition(o,n)},n.prototype.setCursorPosition=function(n,i){var u=!1,r=this.parent.editableElement.querySelector(".tempSpan"),f=r.parentElement,e;(""===r.parentNode.textContent?u=!0:this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),n)?u?f===i?(this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),t.detach(r)):this.focusSelectionParent(r,f):(e=t.createElement("br"),this.parent.domNode.insertAfter(e,r),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,r,0),t.detach(r)):u?this.focusSelectionParent(r,f):t.detach(r)},n.prototype.focusSelectionParent=function(n,i){t.detach(n);i.innerHTML="​";this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,i,0)},n.prototype.insertMarker=function(n,i){var r=t.createElement("span",{className:"tempSpan"});"PRE"===i.startContainer.nodeName?n.childNodes[i.endOffset].parentElement.insertBefore(r,n.childNodes[i.endOffset]):i.startContainer.parentElement.insertBefore(r,i.startContainer)},n.prototype.applyFormats=function(n){var a=this.parent.nodeSelection.getRange(this.parent.currentDocument),nt=!1,v,c,r,u,k,h,f,o,s,i,b,tt,g,y,l;if(this.parent.editableElement!==a.endContainer||t.isNullOrUndefined(this.parent.editableElement.children[a.endOffset-1])||"TABLE"!==this.parent.editableElement.children[a.endOffset-1].tagName||a.collapsed||(nt=!0),v=this.parent.nodeSelection.save(a,this.parent.currentDocument),this.parent.domNode.setMarker(v),c=this.parent.domNode.blockNodes(),"BR"===n.enterAction){this.setSelectionBRConfig();var it=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),p=this.parent.nodeSelection.getSelectionNodes(it),w=[];for(0===p.length&&p.push(c[0]),r=0;r<p.length;r++){for(u=p[r],k=void 0;!this.parent.domNode.isBlockNode(u)&&u!==this.parent.editableElement;)k=u,u=u.parentElement;this.parent.domNode.isBlockNode(u)&&u===this.parent.editableElement&&w.push(k)}for(r=0;r<w.length;r++)if(!this.parent.domNode.isBlockNode(w[r])){for(h=u=w[r];u===this.parent.editableElement;)h=u,u=u.parentElement;for(f=void 0,this.parent.domNode.isBlockNode(h.parentElement)&&h.parentElement===this.parent.editableElement?(f=t.createElement("div"),h.parentElement.insertBefore(f,h),f.appendChild(h)):f=h,o=f.previousSibling;!t.isNullOrUndefined(o)&&"BR"!==o.nodeName&&!this.parent.domNode.isBlockNode(o);)f.firstChild.parentElement.insertBefore(o,f.firstChild),o=f.previousSibling;for(t.isNullOrUndefined(o)||"BR"!==o.nodeName||t.detach(o),s=f.nextSibling;!t.isNullOrUndefined(s)&&"BR"!==s.nodeName&&!this.parent.domNode.isBlockNode(s);)f.appendChild(s),s=f.nextSibling;t.isNullOrUndefined(s)||"BR"!==s.nodeName||t.detach(s)}this.setSelectionBRConfig();c=this.parent.domNode.blockNodes()}for(r=0;r<c.length;r++)i=void 0,b=void 0,("blockquote"===n.subCommand.toLowerCase()?(i=this.getParentNode(c[r]),b=this.parent.domNode.isList(i)||"TABLE"===i.tagName?i.outerHTML:i.innerHTML):b=(i=c[r]).innerHTML,n.subCommand.toLowerCase()===i.tagName.toLowerCase()&&("pre"!==n.subCommand.toLowerCase()||!t.isNullOrUndefined(n.exeValue)&&"dropDownSelect"===n.exeValue.name)||t.isNullOrUndefined(i.parentNode)||"TABLE"===i.tagName&&"pre"===n.subCommand.toLowerCase())||(this.cleanFormats(i,n.subCommand),tt="pre"===n.subCommand.toLowerCase()&&"pre"===i.tagName.toLowerCase()?"p":n.subCommand,g=this.parent.domNode.createTagString(tt,i,b.replace(/>\s+</g,"><")),"LI"===i.tagName?(i.innerHTML="",i.insertAdjacentHTML("beforeend",g)):this.parent.domNode.replaceWith(i,g));this.preFormatMerge();y=this.parent.editableElement.querySelector("."+e.startSelection);l=this.parent.editableElement.querySelector("."+e.endSelection);t.isNullOrUndefined(y)||t.isNullOrUndefined(l)||(y=y.lastChild,l=l.lastChild);v=this.parent.domNode.saveMarker(v,null);d()&&wi(this.parent.editableElement,n.selector);nt?this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,y,l,0,l.textContent.length):v.restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n.prototype.setSelectionBRConfig=function(){var n=this.parent.editableElement.querySelector("."+e.startSelection),i=this.parent.editableElement.querySelector("."+e.endSelection);t.isNullOrUndefined(i)?this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,n,0):this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,n,i,0,0)},n.prototype.preFormatMerge=function(){var i=this.parent.editableElement.querySelectorAll("PRE"),n,r;if(!t.isNullOrUndefined(i))for(n=0;n<i.length;n++)r=i[n].previousElementSibling,t.isNullOrUndefined(r)||"PRE"!==r.tagName||(r.insertAdjacentHTML("beforeend","<br>"+i[n].innerHTML),t.detach(i[n]))},n.prototype.cleanFormats=function(n,t){var r=["display","font-size","margin-top","margin-bottom","margin-left","margin-right","font-weight"],i;for(t=t.toLowerCase(),i=0;i<r.length&&"p"!==t&&"blockquote"!==t&&"pre"!==t;i++)n.style.removeProperty(r[i])},n}(),bt=function(){function n(){}return n.Insert=function(n,i,r,u){var f,p,l,a,k,g,w;"string"==typeof i?((p=document.createElement("div")).innerHTML=i,f=u?p:p.firstChild):u&&(t.isNullOrUndefined(i)||t.isNullOrUndefined(i.classList)||!i.classList.contains("pasteContent"))?((p=document.createElement("div")).appendChild(i),f=p):f=i;var s=new b,d=new ur,e=s.getRange(n);e.startContainer===r&&e.startContainer===e.endContainer&&0===e.startOffset&&e.startOffset===e.endOffset&&0===r.textContent.length&&"P"===r.children[0].tagName&&(s.setSelectionText(n,e.startContainer.children[0],e.startContainer.children[0],0,0),e=s.getRange(n));var nt=e.startOffset===e.endOffset&&0===e.startOffset&&e.startContainer===e.endContainer,tt=e.collapsed,c=this.getNodeCollection(e,s,f),v="table"===f.nodeName.toLowerCase()?this.closestEle(c[0].parentNode,r):c[0];if(u||!t.isNullOrUndefined(f)&&!t.isNullOrUndefined(f.classList)&&f.classList.contains("pasteContent"))this.pasteInsertHTML(c,f,e,s,d,n,tt,v,r);else if(r!==e.startContainer&&(!tt&&(v.nodeType!==Node.ELEMENT_NODE||-1===bu.indexOf(v.tagName.toLocaleLowerCase()))||"table"===f.nodeName.toLowerCase()&&v&&-1===bu.indexOf(v.tagName.toLocaleLowerCase()))){var y=d.GetSpliceNode(e,v),it=y.previousSibling,o=y.parentNode;for(1===c.length||"table"===f.nodeName.toLowerCase()&&0===y.childElementCount?(s.setSelectionContents(n,y),e=s.getRange(n)):(l=d.GetSpliceNode(e,c[c.length-1].parentElement),l=t.isNullOrUndefined(l)?y:l,s.setSelectionText(n,y,l,0,3===l.nodeType?l.textContent.length:l.childNodes.length),e=s.getRange(n)),e.extractContents(),"TABLE"===i.tagName&&this.removeEmptyElements(r),a=0;a<c.length;a++)if(3!==c[a].nodeType&&null!=c[a].parentNode){if("IMG"===c[a].nodeName)continue;c[a].parentNode.removeChild(c[a])}if(it)h.AppendBefore(f,it,!0);else{for(k=null;o!==r&&o.firstChild&&""===o.textContent.trim();)k=o,o=o.parentNode;null!==k&&(o=k);o.firstChild&&(o!==r||"TABLE"===f.nodeName&&nt&&o===e.startContainer&&o===e.endContainer)?""===o.textContent.trim()&&o!==r?(h.AppendBefore(f,o,!1),t.detach(o)):h.AppendBefore(f,o.firstChild,!1):o.appendChild(f)}"IMG"===f.nodeName?this.imageFocus(f,s,n):3!==f.nodeType?s.setSelectionText(n,f,f,0,f.childNodes.length):s.setSelectionText(n,f,f,0,f.textContent.length)}else(e.deleteContents(),nt&&""===e.startContainer.textContent&&"BR"!==e.startContainer.nodeName&&(e.startContainer.innerHTML=""),t.Browser.isIE)?(g=n.createDocumentFragment(),g.appendChild(f),e.insertNode(g)):1===e.startContainer.nodeType&&"hr"===e.startContainer.nodeName.toLowerCase()&&"hr"===e.endContainer.nodeName.toLowerCase()?(w=e.startContainer.nextElementSibling,w&&(w.querySelector("br")&&t.detach(w.querySelector("br")),w.appendChild(f))):"BR"===e.startContainer.nodeName?e.startContainer.parentElement.insertBefore(f,e.startContainer):e.insertNode(f),3!==f.nodeType&&f.childNodes.length>0?s.setSelectionText(n,f,f,1,1):"IMG"===f.nodeName?this.imageFocus(f,s,n):3!==f.nodeType?s.setSelectionContents(n,f):s.setSelectionText(n,f,f,f.textContent.length,f.textContent.length)},n.pasteInsertHTML=function(n,i,r,u,f,e,o,s,h){var l,w,b,a,et=r.startOffset===r.endOffset&&r.startContainer===r.endContainer,k,d,v,g,p,c,ot,y,ut,ft;for(et&&r.startContainer===h&&""===h.textContent&&(k=this.getImmediateBlockNode(n[n.length-1],h),u.setSelectionText(e,k,k,0,0),r=u.getRange(e)),h!==r.startContainer&&(!o&&(s.nodeType!==Node.ELEMENT_NODE||-1===bu.indexOf(s.tagName.toLocaleLowerCase()))||"table"===i.nodeName.toLowerCase()&&s&&-1===bu.indexOf(s.tagName.toLocaleLowerCase()))&&(a=f.GetSpliceNode(r,s),w=t.isNullOrUndefined(a.previousSibling)?a.parentNode.previousSibling:a.previousSibling,1===n.length?(u.setSelectionContents(e,a),r=u.getRange(e),b=!0):(l=f.GetSpliceNode(r,n[n.length-1].parentElement),l=t.isNullOrUndefined(l)?a:l,u.setSelectionText(e,a,l,0,3===l.nodeType?l.textContent.length:l.childNodes.length),r=u.getRange(e),b=!1)),d=!1,this.removingComments(i),g=i.childNodes,p=0;p<g.length;p++)if(bi.indexOf(g[p].nodeName.toLocaleLowerCase())>=0){d=!0;break}if(c=document.createDocumentFragment(),d){this.insertTempNode(r,i,n,f,h);var nt=!0,tt=void 0,it=void 0,rt=void 0;for(r.deleteContents();i.firstChild;)"#text"!==i.firstChild.nodeName||""!==i.firstChild.textContent.trim()?"#text"===i.firstChild.nodeName&&nt||this.inlineNode.indexOf(i.firstChild.nodeName.toLocaleLowerCase())>=0&&nt?((v=i.firstChild,t.isNullOrUndefined(i.previousElementSibling))&&(ot=t.createElement("p"),i.parentElement.insertBefore(ot,i)),i.previousElementSibling.appendChild(i.firstChild)):(v=i.firstChild,"#text"===i.firstChild.nodeName||this.inlineNode.indexOf(i.firstChild.nodeName.toLocaleLowerCase())>=0?(tt?(rt.appendChild(i.firstChild),c.appendChild(rt)):((it=t.createElement("p")).appendChild(i.firstChild),c.appendChild(it)),rt=it,tt=!0):(c.appendChild(i.firstChild),tt=!1),nt=!1):t.detach(i.firstChild);i.parentNode.replaceChild(c,i)}else if(et){for(y=t.createElement("span",{className:"tempSpan"}),ut=t.closest(r.startContainer.parentElement,"a"),3===r.startContainer.nodeType&&ut?(ft=this.getImmediateBlockNode(r.startContainer,h),ft.querySelectorAll("br").length>0&&t.detach(ft.querySelector("br")),t.closest(ut,"span").appendChild(y)):r.insertNode(y);i.firstChild;)v=i.firstChild,c.appendChild(i.firstChild);y.parentNode.replaceChild(c,y)}else{for(;i.firstChild;)v=i.firstChild,c.appendChild(i.firstChild);b?a.parentNode.replaceChild(c,a):(r.deleteContents(),t.detach(l),t.isNullOrUndefined(w)?h.appendChild(c):w.parentNode.appendChild(c))}"#text"===v.nodeName?this.placeCursorEnd(v,i,u,e,h):this.cursorPos(v,i,u,e,h)},n.placeCursorEnd=function(n,i,r,u,f){for(n="BR"===n.nodeName?t.isNullOrUndefined(n.previousSibling)?n.parentNode:n.previousSibling:n;!t.isNullOrUndefined(n)&&"#text"!==n.nodeName&&"IMG"!==n.nodeName&&"BR"!==n.nodeName&&"HR"!==n.nodeName;)n=n.lastChild;"IMG"===(n=t.isNullOrUndefined(n)?i:n).nodeName?this.imageFocus(n,r,u):r.setSelectionText(u,n,n,n.textContent.length,n.textContent.length);this.removeEmptyElements(f)},n.getNodeCollection=function(n,t,i){var r=[];return n.startOffset===n.endOffset&&n.startContainer===n.endContainer&&("TD"===n.startContainer.nodeName||3!==n.startContainer.nodeType&&i.classList&&i.classList.contains("pasteContent"))?r.push(n.startContainer.childNodes[n.endOffset]):r=t.getInsertNodeCollection(n),r},n.insertTempNode=function(n,i,r,u,f){var e,s,h,o,c;if(n.startContainer!==f||t.isNullOrUndefined(n.startContainer.childNodes[n.endOffset-1])||"TABLE"!==n.startContainer.childNodes[n.endOffset-1].nodeName)if(n.startContainer!==f||t.isNullOrUndefined(n.startContainer.childNodes[n.endOffset])||"TABLE"!==n.startContainer.childNodes[n.endOffset].nodeName)if(n.startContainer===n.endContainer&&3!==n.startContainer.nodeType&&"HR"===i.firstChild.nodeName)n.startContainer.classList.contains("e-content")||"BODY"===n.startContainer.nodeName?n.startContainer.appendChild(i):n.startContainer.parentNode.insertBefore(i,n.startContainer);else{if(e=this.getImmediateBlockNode(r[r.length-1],f),(t.isNullOrUndefined(e)||t.isNullOrUndefined(e.parentElement))&&3!==n.endContainer.nodeType&&(e=n.endContainer,n.setEnd(e,n.endContainer.textContent.length)),"BODY"===e.nodeName&&n.startContainer===n.endContainer&&1===n.startContainer.nodeType&&(e=n.startContainer),e.closest("LI")&&i&&i.firstElementChild&&("OL"===i.firstElementChild.tagName||"UL"===i.firstElementChild.tagName))for(s=void 0;i.firstElementChild.lastElementChild&&"LI"===i.firstElementChild.lastElementChild.tagName;)(s=i.firstElementChild.lastElementChild).style.removeProperty("margin-left"),s.style.removeProperty("margin-top"),s.style.removeProperty("margin-bottom"),i.firstElementChild.insertAdjacentElement("afterend",s);"TD"===e.nodeName||"TH"===e.nodeName?(h=t.createElement("span",{className:"tempSpan"}),n.insertNode(h),h.parentNode.replaceChild(i,h)):(o=r[r.length-1],c=void 0,(c="BR"!==o.nodeName&&"HR"!==o.nodeName||t.isNullOrUndefined(o.parentElement)||0!==o.parentElement.textContent.trim().length||i.classList.contains("pasteContent")?u.GetSpliceNode(n,e):o).parentNode.replaceChild(i,c))}else n.startContainer.insertBefore(i,n.startContainer.childNodes[n.endOffset]);else t.isNullOrUndefined(n.startContainer.childNodes[n.endOffset-1].nextSibling)?n.startContainer.appendChild(i):n.startContainer.insertBefore(i,n.startContainer.childNodes[n.endOffset-1].nextSibling)},n.cursorPos=function(n,i,r,u,f){n.classList.add("lastNode");f.innerHTML=function(n){var i=document.createElement("div"),s,e,r,f,u,o;if(i.innerHTML=n,i.setAttribute("class","tempDiv"),s=document.createElement("div"),i.childNodes.length>0){for(var c=void 0,l=void 0,h=void 0;i.firstChild;)"#text"===i.firstChild.nodeName&&(i.firstChild.textContent.indexOf("\n")<0||""!==i.firstChild.textContent.trim())||pg.indexOf(i.firstChild.nodeName.toLocaleLowerCase())>=0?(c?l.appendChild(i.firstChild):(h=t.createElement("p"),s.appendChild(h),h.appendChild(i.firstChild)),l=h,c=!0):"#text"===i.firstChild.nodeName&&("\n"===i.firstChild.textContent||i.firstChild.textContent.indexOf("\n")>=0&&""===i.firstChild.textContent.trim())?t.detach(i.firstChild):(s.appendChild(i.firstChild),c=!1);for(e=s.querySelectorAll("table"),r=0;r<e.length;r++){for("0"===e[r].getAttribute("border")&&e[r].removeAttribute("border"),f=e[r].querySelectorAll("td"),u=0;u<f.length;u++)"none"===f[u].style.borderLeft&&f[u].style.removeProperty("border-left"),"none"===f[u].style.borderRight&&f[u].style.removeProperty("border-right"),"none"===f[u].style.borderBottom&&f[u].style.removeProperty("border-bottom"),"none"===f[u].style.borderTop&&f[u].style.removeProperty("border-top"),"none"===f[u].style.border&&f[u].style.removeProperty("border");e[r].classList.contains(il)||e[r].classList.add(il)}for(o=s.querySelectorAll("img"),r=0;r<o.length;r++)o[r].classList.contains(lu)||o[r].classList.add(lu),o[r].classList.contains(vt)||o[r].classList.contains(ei)||o[r].classList.add(vt)}return s.innerHTML}(f.innerHTML);n=f.querySelector(".lastNode");t.isNullOrUndefined(n)||(this.placeCursorEnd(n,i,r,u,f),n.classList.remove("lastNode"),0===n.classList.length&&n.removeAttribute("class"))},n.imageFocus=function(n,t,i){var r=document.createTextNode(" ");n.parentNode.insertBefore(r,n.nextSibling);t.setSelectionText(i,n.nextSibling,n.nextSibling,0,0)},n.getImmediateBlockNode=function(n){do n=n.parentNode;while(n&&bi.indexOf(n.nodeName.toLocaleLowerCase())<0);return n},n.removingComments=function(n){var t=n.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.findDetachEmptyElem=function(n){return t.isNullOrUndefined(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"true"!==n.parentElement.contentEditable?this.findDetachEmptyElem(n.parentElement):n},n.removeEmptyElements=function(n){for(var u,r=n.querySelectorAll(":empty"),i=0;i<r.length;i++)"IMG"!==r[i].tagName&&"BR"!==r[i].tagName&&"IFRAME"!==r[i].tagName&&"TD"!==r[i].tagName&&"SOURCE"!==r[i].tagName&&"HR"!==r[i].tagName&&(u=this.findDetachEmptyElem(r[i]),t.isNullOrUndefined(u)||t.detach(u))},n.closestEle=function(n,i){for(var r=n;r&&1===r.nodeType;){if(r.parentNode===i||!t.isNullOrUndefined(r.parentNode.tagName)&&-1!==wt.indexOf(r.parentNode.tagName.toLocaleLowerCase()))return r;r=r.parentNode}return null},n.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"],n}(),tb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(va,this.linkCommand,this)},n.prototype.linkCommand=function(n){switch(n.value.toString().toLocaleLowerCase()){case"createlink":case"editlink":this.createLink(n);break;case"openlink":this.openLink(n);break;case"removelink":this.removeLink(n)}},n.prototype.createLink=function(n){var u=!t.isNullOrUndefined(n.item.selectParent)&&n.item.selectParent.length>0&&t.closest(n.item.selectParent[0],"a"),e,h,r,o,i,s,f;(u=t.isNullOrUndefined(u)?!t.isNullOrUndefined(n.item.selectParent)&&n.item.selectParent.length>0?n.item.selectParent[0]:null:u,t.isNullOrUndefined(u)||"A"!==u.tagName)?(e=(new b).getRange(this.parent.currentDocument),h=!!t.isNullOrUndefined(n.item.text)||n.item.text.replace(/ /g,"").localeCompare(e.toString().replace(/\n/g," ").replace(/ /g,""))<0,n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode)||"Paste"===n.item.action||e.collapsed||h?(r=this.createAchorNode(n),(r.innerText=""===n.item.text?n.item.url:n.item.text,n.item.selection.restore(),bt.Insert(this.parent.currentDocument,r,this.parent.editableElement),n.event&&"keydown"===n.event.type&&(32===n.event.keyCode||13===n.event.keyCode))?(o=n.item.selection.range.startContainer,o.textContent=this.removeText(o.textContent,n.item.text)):(f="Paste"===n.item.action?r.childNodes[0].textContent.length:0,n.item.selection.setSelectionText(this.parent.currentDocument,r.childNodes[0],r.childNodes[0],f,r.childNodes[0].textContent.length))):this.createLinkNode(n)):(i=u,s="",(t.isNullOrUndefined(n.item.url)||i.setAttribute("href",n.item.url),t.isNullOrUndefined(n.item.title)||i.setAttribute("title",n.item.title),t.isNullOrUndefined(n.item.text)||""===n.item.text||(s=i.innerText,i.innerText=n.item.text),t.isNullOrUndefined(n.item.target)?i.removeAttribute("target"):i.setAttribute("target",n.item.target),s===n.item.text)?(n.item.selection.setSelectionText(this.parent.currentDocument,i,i,1,1),n.item.selection.restore()):(f="Paste"===n.item.action?i.childNodes[0].textContent.length:0,n.item.selection.setSelectionText(this.parent.currentDocument,i.childNodes[0],i.childNodes[0],f,i.childNodes[0].textContent.length)));n.callBack&&n.callBack({requestType:"Links",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.createLinkNode=function(n){for(var t,d,p,w,c,g,l,o,u,a,k=new b,nt=new ur,v=k.getRange(this.parent.currentDocument),y=this.getSelectionNodes(k.getNodeCollection(v)),tt=k.save(v,this.parent.currentDocument),h=[],r=[],e=[],f=[],i=[],s=0;s<y.length;s++)y[s]=nt.GetSpliceNode(v,y[s]),h[s]=y[s];for(t=0;t<h.length;t++)for(d=!0,u=h[t];!0===d;)"A"===u.parentNode.nodeName&&(p=u.parentNode,u.parentNode.parentNode.insertBefore(p.firstChild,p),u.parentNode.removeChild(p)),this.isBlockNode(u.parentNode)||0===h.length||0===t||t===h.length-1||3===v.startContainer.nodeType?(r[t]=u,d=!1):u=u.parentNode;for(t=0,w=0;t<r.length;t++)if(0===t&&(i[w]=r[t]),r.length>1&&t<r.length-1){if(r[t].parentElement===r[t+1].parentElement&&r[t]===r[t+1])continue;i[w+1]=r[t+1];w++}for(c=0,f[c]=this.createAchorNode(n),t=0;t<i.length;t++)(0===t&&(a=i[t].cloneNode(!0),f[t].appendChild(a)),t<i.length-1)&&(i[t].parentNode===i[t+1].parentNode?(g=i[t+1].cloneNode(!0),f[c].appendChild(g)):(f[c+=1]=this.createAchorNode(n),a=i[t+1].cloneNode(!0),f[c].appendChild(a)));for(this.parent.nodeSelection.setRange(document,tt.range),t=0,l=0,o=0;t<=i.length;t++)0===t&&(i[t].parentNode.insertBefore(f[l],i[t].nextSibling),1===this.parent.domNode.blockNodes().length&&this.parent.nodeSelection.setSelectionNode(this.parent.currentDocument,f[l]),e[o]=i[t],o++),t<i.length-1&&(i[t].parentNode===i[t+1].parentNode?(e[o]=i[t+1],o++):(l+=1,i[t+1].parentNode.insertBefore(f[l],i[t+1]),e[o]=i[t+1],o++));for(t=0;t<e.length;t++)e[t].parentNode&&e[t].parentNode.removeChild(e[t])},n.prototype.createAchorNode=function(n){var i=t.createElement("a",{className:"e-rte-anchor",attrs:{href:n.item.url,title:t.isNullOrUndefined(n.item.title)||""===n.item.title?n.item.url:n.item.title}});return t.isNullOrUndefined(n.item.target)||i.setAttribute("target",n.item.target),i},n.prototype.getSelectionNodes=function(n){n=n.reverse();for(var t=0;t<n.length;t++)3===n[t].nodeType&&""!==n[t].textContent.trim()||"IMG"!==n[t].nodeName&&(n.splice(t,1),t--);return n.reverse()},n.prototype.isBlockNode=function(n){return!!n&&n.nodeType===Node.ELEMENT_NODE&&bi.indexOf(n.tagName.toLowerCase())>=0},n.prototype.removeText=function(n,t){for(var r=n.split(" "),i=0;i<r.length;i++)r[i]===t&&(r.splice(i,1),i--);return r.join(" ")+" "},n.prototype.openLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeLink=function(n){var o=this.parent.domNode.blockNodes(),e,f,i;if(o.length<2){this.parent.domNode.setMarker(n.item.selection);for(var r=t.closest(n.item.selectParent[0],"a")||n.item.selectParent[0],s=r.parentNode,u=[];r.firstChild;null)u.push(s.insertBefore(r.firstChild,r));s.removeChild(r);u&&1===u.length&&(n.item.selection.startContainer=n.item.selection.getNodeArray(u[u.length-1],!0),n.item.selection.endContainer=n.item.selection.startContainer);n.item.selection=this.parent.domNode.saveMarker(n.item.selection)}else for(e=0;e<o.length;e++)for(f=o[e].querySelectorAll("a"),i=0;i<f.length;i++)document.getSelection().containsNode(f[i],!0)&&(f[i].outerHTML=f[i].innerHTML);n.item.selection.restore();this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),ib=function(){function n(n){this.alignments={JustifyLeft:"left",JustifyCenter:"center",JustifyRight:"right",JustifyFull:"justify"};this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(rv,this.applyAlignment,this);this.parent.observer.on(l,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"justify-center":this.applyAlignment({subCommand:"JustifyCenter",callBack:n.callBack});n.event.preventDefault();break;case"justify-full":this.applyAlignment({subCommand:"JustifyFull",callBack:n.callBack});n.event.preventDefault();break;case"justify-left":this.applyAlignment({subCommand:"JustifyLeft",callBack:n.callBack});n.event.preventDefault();break;case"justify-right":this.applyAlignment({subCommand:"JustifyRight",callBack:n.callBack});n.event.preventDefault()}},n.prototype.getTableNode=function(n){var i=n.startContainer.nodeType===Node.ELEMENT_NODE?n.startContainer:n.startContainer.parentNode;return[t.closest(i,"td,th")]},n.prototype.applyAlignment=function(n){var s="Table"===n.value,u=this.parent.nodeSelection.getRange(this.parent.currentDocument),r=this.parent.nodeSelection.save(u,this.parent.currentDocument),f,i,h,e,o;if(s)t.setStyleAttribute(this.getTableNode(u)[0],{"text-align":this.alignments[n.subCommand]});else{for(this.parent.domNode.setMarker(r),f=this.parent.domNode.blockNodes(),i=0;i<f.length;i++)h=f[i],t.setStyleAttribute(h,{"text-align":this.alignments[n.subCommand]});for(e=this.parent.domNode.getImageTagInSelection(),i=0;i<e.length;i++)o=[],o.push(e[i]),this.parent.imgObj.imageCommand({item:{selectNode:o},subCommand:n.subCommand,value:n.subCommand,callBack:n.callBack,selector:n.selector});this.parent.editableElement.focus();r=this.parent.domNode.saveMarker(r);d()&&wi(this.parent.editableElement,n.selector);r.restore()}n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:s?this.getTableNode(u):this.parent.domNode.blockNodes()})},n}(),rb=function(){function n(n){this.indentValue=20;this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(uv,this.applyIndents,this);this.parent.observer.on(l,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){switch(n.event.action){case"indents":this.applyIndents({subCommand:"Indent",callBack:n.callBack});n.event.preventDefault();break;case"outdents":this.applyIndents({subCommand:"Outdent",callBack:n.callBack});n.event.preventDefault()}},n.prototype.applyIndents=function(n){var o=this.parent.editableElement,s=o.classList.contains("e-rtl"),a=this.parent.nodeSelection.getRange(this.parent.currentDocument),h=this.parent.nodeSelection.save(a,this.parent.currentDocument);this.parent.domNode.setMarker(h);for(var r=this.parent.domNode.blockNodes(),i=r.slice(),c=[],t=0;t<i.length;t++)"LI"!==i[t].tagName&&"LI"===i[t].parentNode.tagName?(r.splice(r.indexOf(i[t]),1),c.push(i[t].parentNode)):"LI"===i[t].tagName&&(r.splice(r.indexOf(i[t]),1),c.push(i[t]));for(c.length>0&&this.parent.observer.notify(l,{event:{preventDefault:function(){},stopPropagation:function(){},shiftKey:"Indent"!==n.subCommand,which:9,action:"indent"},ignoreDefault:!0}),t=0;t<r.length;t++){var u=r[t],e=s?u.style.marginRight:u.style.marginLeft,f=void 0;"Indent"===n.subCommand?(f=""===e?this.indentValue+"px":parseInt(e,null)+this.indentValue+"px",s?u.style.marginRight=f:u.style.marginLeft=f):(f=""===e||"0px"===e?"":parseInt(e,null)-this.indentValue+"px",s?u.style.marginRight=f:u.style.marginLeft=f)}o.focus();d()&&wi(o,n.selector);(h=this.parent.domNode.saveMarker(h)).restore();n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.domNode.blockNodes()})},n}(),kt="e-imgright",dt="e-imgleft",fr="e-imgcenter",kh="e-imgbreak",s="e-img-caption",dg="e-rte-img-caption",hv="e-caption-inline",ub="e-imginline",fb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(wh,this.imageCommand,this)},n.prototype.imageCommand=function(n){switch(n.value.toString().toLowerCase()){case"image":case"replace":this.createImage(n);break;case"insertlink":this.insertImageLink(n);break;case"openimagelink":this.openImageLink(n);break;case"editimagelink":this.editImageLink(n);break;case"removeimagelink":this.removeImageLink(n);break;case"remove":this.removeImage(n);break;case"alttext":this.insertAltTextImage(n);break;case"dimension":this.imageDimension(n);break;case"caption":this.imageCaption(n);break;case"justifyleft":this.imageJustifyLeft(n);break;case"justifycenter":this.imageJustifyCenter(n);break;case"justifyright":this.imageJustifyRight(n);break;case"inline":this.imageInline(n);break;case"break":this.imageBreak(n)}},n.prototype.createImage=function(n){var e=this,r=!1,i,o,u,f;(n.item.url=t.isNullOrUndefined(n.item.url)||"undefined"===n.item.url?n.item.src:n.item.url,t.isNullOrUndefined(n.item.selectParent)||"IMG"!==n.item.selectParent[0].tagName)?(i=t.createElement("img"),this.setStyle(i,n),t.isNullOrUndefined(n.item.selection)||n.item.selection.restore(),t.isNullOrUndefined(n.selector)||"pasteCleanupModule"!==n.selector?bt.Insert(this.parent.currentDocument,i,this.parent.editableElement):n.callBack({requestType:"Images",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[i]})):(o=n.item.selectParent[0],this.setStyle(o,n),r=!0);n.callBack&&(t.isNullOrUndefined(n.selector)||!t.isNullOrUndefined(n.selector)&&"pasteCleanupModule"!==n.selector)&&(u=this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)[0],f="Replace"===n.value||r?n.item.selectParent[0]:t.Browser.isIE?u.previousSibling:u.previousElementSibling,f.addEventListener("load",function(){"Replace"===n.value&&r||n.callBack({requestType:"Images",editorMode:"HTML",event:n.event,range:e.parent.nodeSelection.getRange(e.parent.currentDocument),elements:[f]})}))},n.prototype.setStyle=function(n,i){t.isNullOrUndefined(i.item.url)||n.setAttribute("src",i.item.url);n.setAttribute("class","e-rte-image"+(t.isNullOrUndefined(i.item.cssClass)?"":" "+i.item.cssClass));t.isNullOrUndefined(i.item.altText)||n.setAttribute("alt",i.item.altText);t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.width)||n.setAttribute("width",this.calculateStyleValue(i.item.width.width));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.height)||n.setAttribute("height",this.calculateStyleValue(i.item.height.height));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.minWidth)||(n.style.minWidth=this.calculateStyleValue(i.item.width.minWidth));t.isNullOrUndefined(i.item.width)||t.isNullOrUndefined(i.item.width.maxWidth)||(n.style.maxWidth=this.calculateStyleValue(i.item.width.maxWidth));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.minHeight)||(n.style.minHeight=this.calculateStyleValue(i.item.height.minHeight));t.isNullOrUndefined(i.item.height)||t.isNullOrUndefined(i.item.height.maxHeight)||(n.style.maxHeight=this.calculateStyleValue(i.item.height.maxHeight))},n.prototype.calculateStyleValue=function(n){return"string"==typeof n&&(n.indexOf("px")||n.indexOf("%")||n.indexOf("auto"))?n:n+"px"},n.prototype.insertImageLink=function(n){var i=t.createElement("a",{attrs:{href:n.item.url}});n.item.selectNode[0].parentElement.classList.contains("e-img-wrap")&&(n.item.selection.restore(),i.setAttribute("contenteditable","true"));i.appendChild(n.item.selectNode[0]);t.isNullOrUndefined(n.item.target)||i.setAttribute("target",n.item.target);bt.Insert(this.parent.currentDocument,i,this.parent.editableElement);this.callBack(n)},n.prototype.openImageLink=function(n){document.defaultView.open(n.item.url,n.item.target);this.callBack(n)},n.prototype.removeImageLink=function(n){var i=n.item.selectParent[0];if(i.classList.contains("e-img-caption")){var r=t.select(".e-img-wrap",i),u=t.select(".e-img-inner",i),f=u.cloneNode(!0);t.detach(t.select("a",i));t.detach(u);r.appendChild(n.item.insertElement);r.appendChild(f)}else t.detach(i),t.Browser.isIE&&n.item.selection.restore(),bt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.editImageLink=function(n){n.item.selectNode[0].parentElement.href=n.item.url;t.isNullOrUndefined(n.item.target)?n.item.selectNode[0].parentElement.removeAttribute("target"):n.item.selectNode[0].parentElement.target=n.item.target;this.callBack(n)},n.prototype.removeImage=function(n){t.closest(n.item.selectNode[0],"a")?"A"!==n.item.selectNode[0].parentElement.nodeName||t.isNullOrUndefined(n.item.selectNode[0].parentElement.innerText)?t.detach(t.closest(n.item.selectNode[0],"a")):t.detach(n.item.selectNode[0]):t.isNullOrUndefined(t.closest(n.item.selectNode[0],"."+s))?t.detach(n.item.selectNode[0]):t.detach(t.closest(n.item.selectNode[0],"."+s));this.callBack(n)},n.prototype.insertAltTextImage=function(n){n.item.selectNode[0].setAttribute("alt",n.item.altText);this.callBack(n)},n.prototype.imageDimension=function(n){var i=n.item.selectNode[0];i.style.height="";i.style.width="";"auto"!==n.item.width?i.style.width=t.formatUnit(n.item.width):i.removeAttribute("width");"auto"!==n.item.height?i.style.height=t.formatUnit(n.item.height):i.removeAttribute("height");this.callBack(n)},n.prototype.imageCaption=function(n){bt.Insert(this.parent.currentDocument,n.item.insertElement,this.parent.editableElement);this.callBack(n)},n.prototype.imageJustifyLeft=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+s))||(t.removeClass([t.closest(i,"."+s)],kt),t.addClass([t.closest(i,"."+s)],dt)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],kt),t.addClass([i.parentElement],dt),t.addClass([i],dt)):t.addClass([i],dt),this.callBack(n))},n.prototype.imageJustifyCenter=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+s))||(t.removeClass([t.closest(i,"."+s)],dt),t.removeClass([t.closest(i,"."+s)],kt),t.addClass([t.closest(i,"."+s)],fr)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],dt),t.removeClass([i.parentElement],kt),t.addClass([i.parentElement],fr),t.addClass([i],fr)):t.addClass([i],fr),this.callBack(n))},n.prototype.imageJustifyRight=function(n){var i=n.item.selectNode[0];t.isNullOrUndefined(i)||(i.removeAttribute("class"),t.addClass([i],"e-rte-image"),t.isNullOrUndefined(t.closest(i,"."+s))||(t.removeClass([t.closest(i,"."+s)],dt),t.addClass([t.closest(i,"."+s)],kt)),"A"===i.parentElement.nodeName?(t.removeClass([i.parentElement],dt),t.addClass([i.parentElement],kt),t.addClass([i],kt)):t.addClass([i],kt),this.callBack(n))},n.prototype.imageInline=function(n){var i=n.item.selectNode[0];i.removeAttribute("class");t.addClass([i],"e-rte-image");t.addClass([i],ub);t.isNullOrUndefined(t.closest(i,"."+s))||(t.removeClass([t.closest(i,"."+s)],kh),t.removeClass([t.closest(i,"."+s)],fr),t.removeClass([t.closest(i,"."+s)],dt),t.removeClass([t.closest(i,"."+s)],kt),t.addClass([t.closest(i,"."+s)],hv));this.callBack(n)},n.prototype.imageBreak=function(n){var i=n.item.selectNode[0];i.removeAttribute("class");t.addClass([i],kh);t.addClass([i],"e-rte-image");t.isNullOrUndefined(t.closest(i,"."+s))||(t.removeClass([t.closest(i,"."+s)],hv),t.removeClass([t.closest(i,"."+s)],fr),t.removeClass([t.closest(i,"."+s)],dt),t.removeClass([t.closest(i,"."+s)],kt),t.addClass([t.closest(i,"."+s)],kh));this.callBack(n)},n.prototype.callBack=function(n){n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),eb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(aa,this.createTable,this);this.parent.observer.on(ya,this.insertRow,this);this.parent.observer.on(pa,this.insertColumn,this);this.parent.observer.on(wa,this.deleteRow,this);this.parent.observer.on(ba,this.deleteColumn,this);this.parent.observer.on(ka,this.removeTable,this);this.parent.observer.on(da,this.tableHeader,this);this.parent.observer.on(ga,this.tableVerticalAlign,this);this.parent.observer.on(nv,this.cellMerge,this);this.parent.observer.on(iv,this.HorizontalSplit,this);this.parent.observer.on(tv,this.VerticalSplit,this);this.parent.observer.on(dw,this.tableMove,this)},n.prototype.createTable=function(n){var i=t.createElement("table",{className:"e-rte-table"}),s=t.createElement("tbody"),h,f,e,o,u,r;for(t.isNullOrUndefined(n.item.width.width)||(i.style.width=this.calculateStyleValue(n.item.width.width)),t.isNullOrUndefined(n.item.width.minWidth)||(i.style.minWidth=this.calculateStyleValue(n.item.width.minWidth)),t.isNullOrUndefined(n.item.width.maxWidth)||(i.style.maxWidth=this.calculateStyleValue(n.item.width.maxWidth)),h=parseInt(n.item.width.width,10)>100?100/n.item.columns:parseInt(n.item.width.width,10)/n.item.columns,f=0;f<n.item.rows;f++){for(e=t.createElement("tr"),o=0;o<n.item.columns;o++)u=t.createElement("td"),u.appendChild(t.createElement("br")),u.style.width=h+"%",e.appendChild(u);s.appendChild(e)}return(i.appendChild(s),n.item.selection.restore(),bt.Insert(this.parent.currentDocument,i,this.parent.editableElement),this.removeEmptyNode(),n.item.selection.setSelectionText(this.parent.currentDocument,i.querySelector("td"),i.querySelector("td"),0,0),null===i.nextElementSibling)&&(r=void 0,"DIV"===n.enterAction?(r=t.createElement("div")).appendChild(t.createElement("br")):"BR"===n.enterAction?r=t.createElement("br"):(r=t.createElement("p")).appendChild(t.createElement("br")),this.insertAfter(r,i)),i.querySelector("td").classList.add("e-cell-select"),n.callBack&&n.callBack({requestType:"Table",editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:[i]}),i},n.prototype.calculateStyleValue=function(n){return"string"==typeof n&&(n.indexOf("px")||n.indexOf("%")||n.indexOf("auto"))?n:n+"px"},n.prototype.removeEmptyNode=function(){for(var i,u,r=this.parent.editableElement.querySelectorAll("ul:empty, ol:empty"),n=0;n<r.length;n++)t.detach(r[n]);for(i=this.parent.editableElement.querySelectorAll("li *:empty"),n=0;n<i.length;n++)t.detach(i[n]),i.length===n+1&&(i=this.parent.editableElement.querySelectorAll("li *:empty"),n=-1);for(u=this.parent.editableElement.querySelectorAll("li:empty"),n=0;n<u.length;n++)t.detach(u[n])},n.prototype.insertAfter=function(n,t){t.parentNode.insertBefore(n,t.nextSibling)},n.prototype.getSelectedCellMinMaxIndex=function(n){for(var t,o,s=this.curTable.querySelectorAll(".e-cell-select"),i=0,r=n.length,u=0,f=n[0].length,e=0;i<s.length;i++)t=this.getCorrespondingIndex(s[i],n),o=this.FindIndex(t[0],t[1],n),r=Math.min(t[0],r),u=Math.max(o[0],u),f=Math.min(t[1],f),e=Math.max(o[1],e);return{startRow:r,endRow:u,startColumn:f,endColumn:e}},n.prototype.insertRow=function(n){var f="InsertRowBefore"!==n.item.subCommand,e=n.item.selection.range.startContainer,h,c,s,o;if("TH"!==e.nodeName&&"TD"!==e.nodeName&&(e=t.closest(e.parentElement,"td,th")),"th"!==e.nodeName.toLowerCase()||"InsertRowBefore"!==n.item.subCommand){if(this.curTable=t.closest(this.parent.nodeSelection.range.startContainer.parentElement,"table"),0===this.curTable.querySelectorAll(".e-cell-select").length)h=this.curTable.rows[this.curTable.rows.length-1],c=h.cloneNode(!0),c.removeAttribute("rowspan"),this.insertAfter(c,h);else{for(var u=this.getCorrespondingColumns(),v=this.getSelectedCellMinMaxIndex(u),i=f?v.endRow:v.startRow,l=t.createElement("tr"),a=this.curTable.querySelectorAll("th.e-cell-select").length>0,r=0;r<u[i].length;r++)f&&i<u.length-1&&u[i][r]===u[i+1][r]||!f&&0<i&&u[i][r]===u[i-1][r]?(0===r||0<r&&u[i][r]!==u[i][r-1])&&u[i][r].setAttribute("rowspan",(parseInt(u[i][r].getAttribute("rowspan"),10)+1).toString()):(s=t.createElement("td"),s.appendChild(t.createElement("br")),l.appendChild(s),s.setAttribute("style",u[a&&f?i+1:i][r].getAttribute("style")));o=void 0;o=a&&f?this.curTable.querySelector("tbody").childNodes[0]:this.curTable.rows[i];"InsertRowBefore"===n.item.subCommand||a?o.parentElement.insertBefore(l,o):this.insertAfter(l,o)}n.item.selection.setSelectionText(this.parent.currentDocument,n.item.selection.range.startContainer,n.item.selection.range.startContainer,0,0);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},n.prototype.insertColumn=function(n){var u=n.item.selection.range.startContainer,r;"TH"!==u.nodeName&&"TD"!==u.nodeName&&(u=t.closest(u.parentElement,"td,th"));for(var o,e=t.closest(u,"tr"),s=t.closest(e,"table").rows,c=Array.prototype.slice.call(e.querySelectorAll(":scope > td, :scope > th")).indexOf(u),l=parseInt(n.item.width,10)/e.querySelectorAll(":scope > td, :scope > th").length,h=parseInt(n.item.width,10)/(e.querySelectorAll(":scope > td, :scope > th").length+1),a=t.closest(e,"table"),f=t.closest(e,"table").querySelectorAll("th,td"),i=0;i<f.length;i++)f[i].dataset.oldWidth=f[i].offsetWidth/a.offsetWidth*100+"%";for(i=0;i<s.length;i++)r=(o=s[i].querySelectorAll(":scope > td, :scope > th")[c]).cloneNode(!0),r.innerHTML="",r.appendChild(t.createElement("br")),r.removeAttribute("class"),r.removeAttribute("colspan"),r.removeAttribute("rowspan"),"InsertColumnLeft"===n.item.subCommand?o.parentElement.insertBefore(r,o):this.insertAfter(r,o),r.style.width=h.toFixed(4)+"%",delete r.dataset.oldWidth;for(i=0;i<f.length;i++)f[i].style.width=(Number(f[i].dataset.oldWidth.split("%")[0])*h/l).toFixed(4)+"%",delete f[i].dataset.oldWidth;n.item.selection.setSelectionText(this.parent.currentDocument,u,u,0,0);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.deleteColumn=function(n){var i=n.item.selection.range.startContainer,e,p,l,u,h,f,v,k,y;if(3===i.nodeType&&(i=t.closest(i.parentElement,"td,th")),e=t.closest(i,"TH"===i.tagName?"thead":"tbody"),p=e&&Array.prototype.indexOf.call(e.childNodes,i.parentNode),this.curTable=t.closest(i,"table"),1===t.closest(i,"tr").querySelectorAll("th,td").length)n.item.selection.restore(),t.detach(t.closest(i.parentElement,"table"));else{for(var r=void 0,o=this.getCorrespondingColumns(),w=this.getSelectedCellMinMaxIndex(o),d=w.startColumn,g=w.endColumn,c=0;c<o.length;c++)for(l=o[c],u=0;u<l.length;u++){var s=l[u],b=this.getCorrespondingIndex(s,o),a=parseInt(s.getAttribute("colspan"),10)||1;b[1]+(a-1)>=d&&b[1]<=g&&(a>1?s.setAttribute("colspan",(a-1).toString()):(t.detach(s),r=u,t.Browser.isIE&&(n.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))))}r>-1&&(h=e.children[p],f=h&&h.children[r<=h.children.length-1?r:r-1],f&&(n.item.selection.setSelectionText(this.parent.currentDocument,f,f,0,0),f.classList.add("e-cell-select")))}n.callBack&&(v=this.parent.nodeSelection.getRange(this.parent.currentDocument).startContainer,"TD"!==v.nodeName&&(k=this.parent.nodeSelection.getRange(this.parent.currentDocument).startOffset,y=v.children[k],y&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,y,0)),n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},n.prototype.deleteRow=function(n){var e=n.item.selection.range.startContainer,v,y,i,u,r,h,c,l,f,o,a,s;if(3===e.nodeType&&(e=t.closest(e.parentElement,"td,th")),y=Array.prototype.indexOf.call(e.parentNode.childNodes,e),this.curTable=t.closest(e,"table"),r=this.getCorrespondingColumns(),h=this.getSelectedCellMinMaxIndex(r),1===this.curTable.rows.length)n.item.selection.restore(),t.detach(t.closest(e.parentElement,"table"));else for(i=h.endRow;i>=h.startRow;i--){for(v=this.curTable.rows[i],u=0;u<r[i].length;u++)if((0===u||r[i][u]!==r[i][u-1])&&1<parseInt(r[i][u].getAttribute("rowspan"),10)&&(c=parseInt(r[i][u].getAttribute("rowspan"),10)-1,1===c?r[i][u].removeAttribute("rowspan"):r[i][u].setAttribute("rowspan",c.toString())),i<r.length-1&&r[i][u]===r[i+1][u]&&(0===i||r[i][u]!==r[i-1][u]))for(l=r[i][u],f=void 0,f=u;0<f&&r[i][f]===r[i][f-1];f--)0===f?this.curTable.rows[i+1].prepend(l):r[i+1][f-1].insertAdjacentElement("afterend",l);o=v.rowIndex;this.curTable.deleteRow(o);a=t.isNullOrUndefined(this.curTable.rows[o])?this.curTable.querySelectorAll("tbody tr")[o-1]:this.curTable.querySelectorAll("tbody tr")[o];s=a&&a.querySelectorAll("td")[y];s?(n.item.selection.setSelectionText(this.parent.currentDocument,s,s,0,0),s.classList.add("e-cell-select")):(n.item.selection.setSelectionText(this.parent.currentDocument,this.curTable.querySelector("td"),this.curTable.querySelector("td"),0,0),this.curTable.querySelector("td, th").classList.add("e-cell-select"))}n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.removeTable=function(n){var i=n.item.selection.range.startContainer,r;i=3===i.nodeType?i.parentNode:i;r=t.closest(i.parentElement,"table");r&&(n.item.selection.restore(),t.detach(r));n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.tableHeader=function(n){var o=!1,r=n.item.selection.range.startContainer,i,h,f,e;if(r=3===r.nodeType?r.parentNode:r,i=t.closest(r.parentElement,"table"),[].slice.call(i.childNodes).forEach(function(n){"THEAD"===n.nodeName&&(o=!0)}),i&&!o){for(var c=i.querySelector("tr").childElementCount,s=0,u=0;u<c;u++)s+=parseInt(i.querySelector("tr").children[u].getAttribute("colspan"),10)||1;for(h=i.createTHead().insertRow(0),f=0;f<s;f++)e=t.createElement("th"),e.appendChild(t.createElement("br")),h.appendChild(e)}else i.deleteTHead();n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.tableVerticalAlign=function(n){n.item.tableCell.style.verticalAlign="AlignTop"===n.item.subCommand?"top":"AlignMiddle"===n.item.subCommand?"middle":"bottom";n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n.prototype.cellMerge=function(n){var u,o,e,r;if(t.isNullOrUndefined(this.curTable)&&(this.curTable=t.closest(this.parent.nodeSelection.range.startContainer.parentElement,"table")),u=this.curTable.querySelectorAll(".e-cell-select"),!(u.length<2)){this.mergeCellContent();var i=this.getSelectedMinMaxIndexes(this.getCorrespondingColumns()),f=u[0],s=f.parentElement.querySelectorAll(".e-cell-select");for(i.startColumn<i.endColumn&&f.setAttribute("colspan",(i.endColumn-i.startColumn+1).toString()),i.startRow<i.endRow&&f.setAttribute("rowspan",(i.endRow-i.startRow+1).toString()),o=0,e=s.length-1;e>=0;e--)o+=parseFloat(s[e].style.width);for(f.style.width=o+"%",r=1;r<=u.length-1;r++)t.detach(u[r]);for(r=0;r<this.curTable.rows.length;r++)""===this.curTable.rows[r].innerHTML&&t.detach(this.curTable.rows[r]);this.updateRowSpanStyle(i.startRow,i.endRow,this.getCorrespondingColumns());this.updateColSpanStyle(i.startColumn,i.endColumn,this.getCorrespondingColumns());n.item.selection.setSelectionText(this.parent.currentDocument,n.item.selection.range.startContainer,n.item.selection.range.startContainer,0,0);this.parent.nodeSelection.range&&this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},n.prototype.updateColSpanStyle=function(n,t,i){var f,u,o,h,s=0,e=0,r=i;if(n<(t=Math.min(t,r[0].length-1))){for(;u<=t;u++)if(!(n<u&&r[0][u]===r[0][u-1])&&1<(s=Math.min(parseInt(r[0][u].getAttribute("colspan"),10)||1,t-n+1))&&r[0][u]===r[0][u+1])for(e=s-1,f=1;f<r.length;f++){if(r[f][u]!==r[f-1][u])for(o=u;o<u+s;o++)if(1<(h=parseInt(r[f][o].getAttribute("colspan"),10)||1)&&r[f][o]===r[f][o+1])o+=e=Math.min(e,h-1);else if(!(e=Math.max(0,e-1)))break;if(!e)break}e&&this.updateCellAttribute(r,e,"colspan",0,r.length-1,n,t)}},n.prototype.updateRowSpanStyle=function(n,t,i){var u,f,o,h,s=0,e=0,r=i;if(n<(t=Math.min(t,r.length-1))){for(u=n;u<=t;u++)if(!(n<u&&r[u][0]===r[u-1][0])&&1<(s=Math.min(parseInt(r[u][0].getAttribute("rowspan"),10)||1,t-n+1))&&r[u][0]===r[u+1][0])for(e=s-1,f=1;f<r[0].length;f++)if(r[u][f]!==r[u][f-1]){for(o=u;o<u+s;o++)if(1<(h=parseInt(r[o][f].getAttribute("rowspan"),10)||1)&&r[o][f]===r[o+1][f])o+=e=Math.min(e,h-1);else if(!(e=Math.max(0,e-1)))break;if(!e)break}e&&this.updateCellAttribute(r,e,"rowspan",n,t,0,r[0].length-1)}},n.prototype.updateCellAttribute=function(n,t,i,r,u,f,e){for(var s,h,o=r;o<=u;o++)for(s=f;s<=e;s++)r<o&&n[o][s]===n[o-1][s]||f<s&&n[o][s]===n[o][s-1]||1<(h=parseInt(n[o][s].getAttribute(i),10)||1)&&(1<h-t?n[o][s].setAttribute(i,(h-t).toString()):n[o][s].removeAttribute(i))},n.prototype.mergeCellContent=function(){for(var n=this.curTable.querySelectorAll(".e-cell-select"),i=n[0].innerHTML,t=1;t<n.length-1;t++)"<br>"!==n[t].innerHTML&&(i+=n[t].innerHTML);n[0].innerHTML=i},n.prototype.getSelectedMinMaxIndexes=function(n){var i=this.curTable.querySelectorAll(".e-cell-select"),t,s;if(0<i.length){for(var r=n.length,u=0,f=n[0].length,e=0,o=0;o<i.length;o++)t=this.getCorrespondingIndex(i[o],n),s=this.FindIndex(t[0],t[1],n),r=Math.min(t[0],r),u=Math.max(s[0],u),f=Math.min(t[1],f),e=Math.max(s[1],e);return{startRow:r,endRow:u,startColumn:f,endColumn:e}}return null},n.prototype.HorizontalSplit=function(n){var a=n.item.selection.range.startContainer,r,c,u,i,l,e,f;if(this.curTable=t.closest(a.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){this.activeCell=this.curTable.querySelector(".e-cell-select");r=this.activeCell.cloneNode(!0);r.removeAttribute("class");r.innerHTML="<\/br>";var s=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),o=this.getCorrespondingColumns(),h=this.activeCell.getAttribute("rowspan")?parseInt(this.activeCell.getAttribute("rowspan"),10):1;if(h>1){for(c=Math.ceil(h/2),1<c?this.activeCell.setAttribute("rowspan",c.toString()):this.activeCell.removeAttribute("rowspan"),1<h-c?r.setAttribute("rowspan",(h-c).toString()):r.removeAttribute("rowspan"),i=void 0,u=s[0]+Math.ceil(h/2),i=0===s[1]?s[1]:s[1]-1;0<=i&&(o[u][i]===o[u][i-1]||0<u&&o[u][i]===o[u-1][i]);)i--;-1===i?this.curTable.rows[u].firstChild?this.curTable.rows[u].prepend(r):this.curTable.appendChild(r):o[u][i].insertAdjacentElement("afterend",r)}else{for(l=t.createElement("tr"),l.appendChild(r),e=o[s[0]],f=0;f<=e.length-1;f++)e[f]!==e[f-1]&&e[f]!==this.activeCell&&e[f].setAttribute("rowspan",((parseInt(e[f].getAttribute("rowspan"),10)?parseInt(e[f].getAttribute("rowspan"),10):1)+1).toString());this.activeCell.parentNode.insertAdjacentElement("afterend",l)}n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},n.prototype.VerticalSplit=function(n){var l=n.item.selection.range.startContainer,h,r,f,c,i,e;if(this.curTable=t.closest(l.parentElement,"table"),!(this.curTable.querySelectorAll(".e-cell-select").length>1)){if(this.activeCell=this.curTable.querySelector(".e-cell-select"),h=this.curTable.rows,r=this.activeCell.cloneNode(!0),r.removeAttribute("class"),r.innerHTML="<\/br>",f=parseFloat(this.activeCell.style.width)/2,"TH"===this.activeCell.tagName&&isNaN(f)){for(c=this.curTable.querySelector("tr").childElementCount,i=0;i<c;i++)parseInt(this.curTable.querySelector("tr").children[i].getAttribute("colspan"),10);f=parseFloat((this.activeCell.offsetWidth/2/this.curTable.offsetWidth*100).toFixed(1))}var o=this.getCorrespondingIndex(this.activeCell,this.getCorrespondingColumns()),s=this.getCorrespondingColumns(),u=parseInt(this.activeCell.getAttribute("colspan"),10);if(u>1)1<Math.ceil(u/2)?this.activeCell.setAttribute("colspan",(u/2).toString()):this.activeCell.removeAttribute("colspan"),1<u-u/2?r.setAttribute("colspan",(u-u/2).toString()):r.removeAttribute("colspan");else for(i=0;i<=h.length-1;i++)(0===i||s[i][o[1]]!==s[i-1][o[1]])&&(e=s[i][o[1]],e!==this.activeCell&&e.setAttribute("colspan",((parseInt(e.getAttribute("colspan"),10)?parseInt(e.getAttribute("colspan"),10):1)+1).toString()));this.activeCell.style.width=f+"%";r.style.width=f+"%";this.activeCell.parentNode.insertBefore(r,this.activeCell.nextSibling);n.callBack&&n.callBack({requestType:n.item.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})}},n.prototype.getCorrespondingColumns=function(){for(var r,t=[],e=this.curTable.rows,i=0;i<=e.length-1;i++)for(var o=e[i],u=0,f=0;f<=o.children.length-1;f++){for(var s=o.children[f],h=s,c=parseInt(h.getAttribute("colspan"),10)||1,l=parseInt(h.getAttribute("rowspan"),10)||1,n=i;n<i+l;n++)for(r=u;r<u+c;r++)t[n]||(t[n]=[]),t[n][r]?u++:t[n][r]=s;u+=0}return t},n.prototype.FindIndex=function(n,t,i){for(var r=n+1,u=t+1;r<i.length;){if(i[r][t]!==i[n][t]){r--;break}r++}for(r===i.length&&r--;u<i[n].length;){if(i[n][u]!==i[n][t]){u--;break}u++}return u===i[n].length&&u--,[r,u]},n.prototype.getCorrespondingIndex=function(n,t){for(var r,i=0;i<t.length;i++)for(r=0;r<t[i].length;r++)if(t[i][r]===n)return[i,r];return[]},n.prototype.highlightCells=function(n,t,i,r,u){for(var l,f,a,e=n,o=t,s=i,h=r,v=new gg,c=e;c<=o;c++){for(((1<(parseInt(u[c][s].getAttribute("rowspan"),10)||1)||1<(parseInt(u[c][s].getAttribute("colspan"),10)||1))&&(a=this.FindIndex((f=this.getCorrespondingIndex(u[c][s],u))[0],f[1],u))||(1<(parseInt(u[c][h].getAttribute("rowspan"),10)||1)||1<(parseInt(u[c][h].getAttribute("colspan"),10)||1))&&(a=this.FindIndex((f=this.getCorrespondingIndex(u[c][h],u))[0],f[1],u)))&&(e=Math.min(f[0],e),o=Math.max(a[0],o),s=Math.min(f[1],s),h=Math.max(a[1],h)),l=s;l<=h;l++)((1<(parseInt(u[e][l].getAttribute("rowspan"),10)||1)||1<(parseInt(u[e][l].getAttribute("colspan"),10)||1))&&(a=this.FindIndex((f=this.getCorrespondingIndex(u[e][l],u))[0],f[1],u))||(1<(parseInt(u[o][l].getAttribute("rowspan"),10)||1)||1<(parseInt(u[o][l].getAttribute("colspan"),10)||1))&&(a=this.FindIndex((f=this.getCorrespondingIndex(u[o][l],u))[0],f[1],u)))&&(e=Math.min(f[0],e),o=Math.max(a[0],o),s=Math.min(f[1],s),h=Math.max(a[1],h));v=e===n&&o===t&&s===i&&h===r?{startRow:n,endRow:t,startColumn:i,endColumn:r}:this.highlightCells(e,o,s,h,u)}return v},n.prototype.tableMove=function(n){var s;this.activeCell=n.selectNode[0];var i=n.event.target,l=this.activeCell.tagName,a=i.tagName;if(this.curTable=t.closest(i,"table"),this.curTable.querySelectorAll(".e-cell-select").length>1&&this.parent.nodeSelection.Clear(this.parent.currentDocument),"TD"===i.tagName||"TH"===i.tagName||l===a){for(var v=Array.prototype.slice.call(this.activeCell.parentElement.parentElement.children).indexOf(this.activeCell.parentElement),y=Array.prototype.slice.call(this.activeCell.parentElement.children).indexOf(this.activeCell),p=Array.prototype.slice.call(i.parentElement.parentElement.children).indexOf(i.parentElement),w=Array.prototype.slice.call(i.parentElement.children).indexOf(i),h=this.curTable.querySelectorAll(".e-cell-select"),r=h.length-1;r>=0;r--)this.activeCell!==h[r]&&h[r].classList.remove("e-cell-select");if(v!==p||y!==w){for(var u=this.getCorrespondingColumns(),f=this.getCorrespondingIndex(this.activeCell,u),e=this.getCorrespondingIndex(i,u),o=this.highlightCells(Math.min(f[0],e[0]),Math.max(f[0],e[0]),Math.min(f[1],e[1]),Math.max(f[1],e[1]),u),c=o.startRow;c<=o.endRow;c++)for(s=o.startColumn;s<=o.endColumn;s++)u[c][s].classList.add("e-cell-select");this.parent.nodeSelection.range&&(this.parent.nodeSelection.setSelectionText(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,this.parent.nodeSelection.range.endContainer,0,0),this.parent.nodeSelection.setCursorPoint(this.parent.currentDocument,this.parent.nodeSelection.range.endContainer,0))}}},n}(),gg=function(){return function(){}}(),gt=function(){function n(){}return n.prototype.getFormattedNode=function(n,t,i){var r=this.getFormatParent(n,t,i);return null!==r&&r!==i?r:null},n.prototype.getFormatParent=function(n,t,i){do n=n.parentNode;while(n&&n!==i&&!this.isFormattedNode(n,t));return n},n.prototype.isFormattedNode=function(t,i){switch(i){case"bold":return n.isBold(t);case"italic":return n.isItalic(t);case"underline":return n.isUnderline(t);case"strikethrough":return n.isStrikethrough(t);case"superscript":return n.isSuperscript(t);case"subscript":return n.isSubscript(t);case"fontcolor":return this.isFontColor(t);case"fontname":return this.isFontName(t);case"fontsize":return this.isFontSize(t);case"backgroundcolor":return this.isBackgroundColor(t);default:return!1}},n.isBold=function(n){return-1!==["strong","b"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"bold"!==n.style.fontWeight)},n.isItalic=function(n){return-1!==["em","i"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"italic"!==n.style.fontStyle)},n.isUnderline=function(n){return-1!==["u"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"underline"!==n.style.textDecoration)},n.isStrikethrough=function(n){return-1!==["del","strike"].indexOf(n.nodeName.toLowerCase())||!(-1===this.inlineTags.indexOf(n.nodeName.toLowerCase())||!n.style||"line-through"!==n.style.textDecoration)},n.isSuperscript=function(n){return-1!==["sup"].indexOf(n.nodeName.toLowerCase())},n.isSubscript=function(n){return-1!==["sub"].indexOf(n.nodeName.toLowerCase())},n.prototype.isFontColor=function(t){var i=t.style&&t.style.color;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isBackgroundColor=function(t){var i=t.style&&t.style.backgroundColor;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontSize=function(t){var i=t.style&&t.style.fontSize;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.prototype.isFontName=function(t){var i=t.style&&t.style.fontFamily;return-1!==n.inlineTags.indexOf(t.nodeName.toLowerCase())&&null!==i&&""!==i&&void 0!==i},n.inlineTags=["a","abbr","acronym","b","bdo","big","cite","code","dfn","em","i","kbd","label","q","samp","small","span","strong","sub","sup","tt","u","var","del"],n}(),cv=function(){function n(){}return n.applyFormat=function(n,i,r,u,f,e){var v,w,k,c,l;if(this.enterAction=u,["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase","fontcolor","fontname","fontsize","backgroundcolor"].indexOf(i)>-1){"backgroundcolor"===i&&""===f&&(f="transparent");var g,s=new b,rt=new bh(r,n),a=new ur,y=new gt,o=s.getRange(n),ut=s.save(o,n),h=o.collapsed?s.getSelectionNodeCollection(o):s.getSelectionNodeCollectionBr(o),nt=!1,p=!1,tt=!1,it=["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(i)>-1;for(o.collapsed&&(h.length>0?(nt=!0,o=a.GetCursorRange(n,o,h[0])):3===o.startContainer.nodeType&&o.startContainer.parentElement.childElementCount>0&&o.startOffset>0&&"br"!==o.startContainer.parentElement.firstElementChild.tagName.toLowerCase()?(nt=!0,o=a.GetCursorRange(n,o,o.startContainer),h.push(o.startContainer)):(v=this.insertCursorNode(n,s,o,y,a,i,f,r),s.endContainer=s.startContainer=s.getNodeArray(v,!0),w="BR"===v.nodeName&&v.parentNode.childNodes,t.isNullOrUndefined(w)||1!==w.length||"BR"!==w[0].nodeName||0!==h.length?s.endOffset=s.startOffset=1:(s.setSelectionText(n,o.startContainer,o.endContainer,0,0),tt=!0),"BR"===v.nodeName&&0===v.parentNode.textContent.length&&(tt=!0))),g=o.collapsed,k=!1,c=0;c<h.length;c++)l=y.getFormattedNode(h[c],i,r),null===l&&("subscript"===i?k=null!==(l=y.getFormattedNode(h[c],"superscript",r)):"superscript"===i&&(k=null!==(l=y.getFormattedNode(h[c],"subscript",r)))),0===c&&null===l&&(p=!0),h[c]=null===l||p&&!it?this.insertFormat(n,h,c,l,g,p,it,o,a,i,f):this.removeFormat(h,c,l,g,p,it,o,a,i,f,s,r,rt),s=this.applySelection(h,s,a,c,nt);d()&&wi(r,e);tt||ut.restore();k&&this.applyFormat(n,i,r,u)}},n.insertCursorNode=function(n,i,r,u,f,e,o,s){var c=i.getNodeCollection(r),l=c.length>0?c.length>1&&r.startContainer===r.endContainer?this.getCursorFormat(u,c,e,s):u.getFormattedNode(c[0],e,s):null,v=null,y,a,p,w;return l?((v=c[0],8203===l.firstChild.textContent.charCodeAt(0))&&(y=new RegExp(String.fromCharCode(8203),"g"),a=void 0,l.firstChild===v?(v.textContent=v.textContent.replace(y,""),a=v):(l.firstChild.textContent=l.firstChild.textContent.replace(y,""),a=l.firstChild),p=void 0,0===a.textContent.length&&(t.isNullOrUndefined(a.previousSibling)?t.isNullOrUndefined(a.parentElement)||0!==a.parentElement.textContent.length||(w=document.createElement("BR"),a.parentElement.appendChild(w),t.detach(a),v=w,i.setCursorPoint(n,v.parentElement,0)):(v=a.previousSibling,p=a.textContent.length-1,i.setCursorPoint(n,a,p)))),["fontcolor","fontname","fontsize","backgroundcolor"].indexOf(e)>-1?("fontcolor"===e?l.style.color=o:"fontname"===e?l.style.fontFamily=o:"fontsize"===e?l.style.fontSize=o:l.style.backgroundColor=o,v=l):h.unwrap(l)):(c.length>1&&r.startOffset>0&&c[0].firstElementChild&&"br"===c[0].firstElementChild.tagName.toLowerCase()&&(c[0].innerHTML=""),1!==c.length||0!==r.startOffset||"BR"!==c[0].nodeName&&"BR"!==c[0].nextSibling.nodeName||t.detach("#text"===c[0].nodeName?c[0].nextSibling:c[0]),v=this.getInsertNode(n,r,e,o).firstChild),v},n.getCursorFormat=function(n,t,i,r){for(var f,u=0;u<t.length;u++)f=t[u].lastElementChild?t[u].lastElementChild:t[u];return n.getFormattedNode(f,i,r)},n.removeFormat=function(n,i,r,u,f,e,o,s,c,l,a,v,y){var rt,ft,ht=null,ct="#text"===o.startContainer.nodeName?o.startContainer.textContent.substring(o.startOffset,o.startContainer.textContent.length):o.startContainer.textContent,g,p,tt,et,st,w,d,k,it,ot,nt,ut;if(o.startContainer!==o.endContainer||0!==o.startOffset||o.endOffset!==o.startContainer.length){g=[];p=n[i];do g.push(a.getIndex(p)),p=p.parentNode;while(p&&p!==r);if("BR"!==n[i].nodeName&&(p=ht=u&&r.textContent.length-1===o.startOffset?s.SplitNode(o,r,!0):s.GetSpliceNode(o,r)),u){for(tt=ht;null!==tt.firstChild&&3!==tt.firstChild.nodeType;null)tt=tt.firstChild;tt.innerHTML="&#8203;";n[i]=tt.firstChild}else{for(;p&&p.childNodes.length>0&&g.length-1>=0&&p.childNodes.length>g[g.length-1];)p=p.childNodes[g[g.length-1]],g.pop();"BR"!==n[i].nodeName&&(3!==p.nodeType||u&&""===p.nodeValue?(et=document.createElement("div"),et.innerHTML="&#8203;",3!==p.nodeType?(p.insertBefore(et.firstChild,p.firstChild),n[i]=p.firstChild):(p.parentNode.insertBefore(et.firstChild,p),n[i]=p.previousSibling,p.parentNode.removeChild(p))):n[i]=p)}}("backgroundcolor"===c&&(rt=r.style.fontSize),"fontsize"===c)&&(st=t.closest(n[i].parentElement,"span[style*=background-color]"),t.isNullOrUndefined(st)||(ft=st.style.backgroundColor));var lt=r.getAttribute("style"),at=r.tagName,b=h.unwrap(r);if(b[0]&&!e)for(w=b[i]?b[i]:b[0],d=w;w&&w.parentElement&&w.parentElement!==v;w)if(w.parentElement&&w.parentElement.tagName.toLocaleLowerCase()===r.tagName.toLocaleLowerCase()&&(w.parentElement.childElementCount>1||o.startOffset>1)){if(d.parentElement&&d.parentElement.tagName.toLocaleLowerCase()===r.tagName.toLocaleLowerCase()&&o.startOffset===o.endOffset&&1!==d.nodeType&&!t.isNullOrUndefined(d.textContent)&&d.parentElement.childElementCount>1&&(o.setStart(d,0),o.setEnd(d,d.textContent.length),s.SplitNode(o,d.parentElement,!1)),"span"===w.parentElement.tagName.toLocaleLowerCase()&&"underline"===r.style.textDecoration&&"underline"!==w.parentElement.style.textDecoration){w=w.parentElement;continue}h.unwrap(w.parentElement);w=t.isNullOrUndefined(w.parentElement)||y.isBlockNode(w.parentElement)?w.parentElement:d}else w=w.parentElement;if(b.length>0&&e){for(k=0;k<b.length;k++)(3!==b[k].nodeType||b[k].textContent&&b[k].textContent.trim().length>0)&&(b[k]=h.Wrap(b[k],this.GetFormatNode(c,l,at,lt)),b[k].textContent===ct&&(0===k?o.setStartBefore(b[k]):k===b.length-1&&o.setEndAfter(b[k])));if(it=n[i].parentElement,(t.isNullOrUndefined(rt)||""===rt||(it.style.fontSize=rt),t.isNullOrUndefined(ft)||""===ft||(it.style.backgroundColor=ft),"backgroundcolor"!==c||t.isNullOrUndefined(rt)||""===rt||it.parentElement.innerHTML!==it.outerHTML)||(ot=it.parentElement,ot.parentElement.insertBefore(it,ot),t.detach(ot)),"fontsize"===c||"fontcolor"===c){for(nt=n[i].parentElement,ut=n[i].parentElement;!t.isNullOrUndefined(ut)&&"li"!==ut.tagName.toLowerCase();)nt=ut=ut.parentElement;t.isNullOrUndefined(nt)||"li"!==nt.tagName.toLowerCase()||nt.textContent.trim()!==n[i].textContent.trim()||("fontsize"===c?nt.style.fontSize=l:(nt.style.color=l,nt.style.textDecoration="inherit"))}}return n[i]},n.insertFormat=function(n,i,r,u,f,e,o,s,h,c,l){var v,a,y,p;if(f)"uppercase"!==c&&"lowercase"!==c?(v=this.getInsertNode(n,s,c,l),i[r]=v.firstChild,h.position=1):h.position=s.startOffset;else if(null===u&&e||o){if("BR"!==i[r].nodeName&&(i[r]=h.GetSpliceNode(s,i[r]),i[r].textContent=h.TrimLineBreak(i[r].textContent)),"uppercase"===c||"lowercase"===c)i[r].textContent="uppercase"===c?i[r].textContent.toLocaleUpperCase():i[r].textContent.toLocaleLowerCase();else if(!0!==o||""!==l)if(v=this.GetFormatNode(c,l),"fontsize"===c||"fontcolor"===c){for(a=i[r].parentElement,y=i[r].parentElement;!t.isNullOrUndefined(y)&&"li"!==y.tagName.toLowerCase();)a=y=y.parentElement;(t.isNullOrUndefined(a)||"li"!==a.tagName.toLowerCase()||a.textContent.trim()!==i[r].textContent.trim()||("fontsize"===c?a.style.fontSize=l:(a.style.color=l,a.style.textDecoration="inherit")),i[r]=this.applyStyles(i,r,v),"fontsize"===c)&&(p=t.closest(i[r].parentElement,"span[style*=background-color]"),t.isNullOrUndefined(p)||(i[r].parentElement.style.backgroundColor=p.style.backgroundColor))}else i[r]=this.applyStyles(i,r,v)}else i[r]=h.GetSpliceNode(s,i[r]);return i[r]},n.applyStyles=function(n,t,i){return"BR"===n[t].nodeName&&"BR"===this.enterAction||(n[t]=t===n.length-1||"BR"===n[t].nodeName?h.Wrap(n[t],i):h.WrapBefore(n[t],i,!0),n[t]=this.getChildNode(n[t],i)),n[t]},n.getInsertNode=function(n,i,r,u){var f=this.GetFormatNode(r,u),e;return(f.innerHTML="&#8203;",t.Browser.isIE)?(e=n.createDocumentFragment(),e.appendChild(f),i.insertNode(e)):i.insertNode(f),f},n.getChildNode=function(n,t){return null==n&&(t.innerHTML="&#8203;",n=t.firstChild),n},n.applySelection=function(n,t,i,r,u){return 1!==n.length||u?1===n.length&&u?(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=i.position,t.endOffset=i.position):0===r?(t.startContainer=t.getNodeArray(n[r],!0),t.startOffset=0):r===n.length-1&&(t.endContainer=t.getNodeArray(n[r],!1),t.endOffset=n[r].textContent.length):(t.startContainer=t.getNodeArray(n[r],!0),t.endContainer=t.startContainer,t.startOffset=0,t.endOffset=n[r].textContent.length),t},n.GetFormatNode=function(n,t,i,r){var u;switch(n){case"bold":return document.createElement("strong");case"italic":return document.createElement("em");case"underline":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.textDecoration="underline",u;case"strikethrough":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.textDecoration="line-through",u;case"superscript":return document.createElement("sup");case"subscript":return document.createElement("sub");case"fontcolor":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.color=t,u.style.textDecoration="inherit",u;case"fontname":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.fontFamily=t,u;case"fontsize":return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.fontSize=t,u;default:return u=document.createElement("span"),this.updateStyles(u,i,r),u.style.backgroundColor=t,u}},n.updateStyles=function(n,t,i){null!==i&&"SPAN"===t&&n.setAttribute("style",i)},n.enterAction="P",n}(),ob=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(fv,this.applySelection,this);this.parent.observer.on(l,this.keyDownHandler,this)},n.prototype.keyDownHandler=function(n){n.event.ctrlKey&&["bold","italic","underline","strikethrough","superscript","subscript","uppercase","lowercase"].indexOf(n.event.action)>-1&&(n.event.preventDefault(),cv.applyFormat(this.parent.currentDocument,n.event.action,this.parent.editableElement,n.enterAction),this.callBack(n,n.event.action))},n.prototype.applySelection=function(n){cv.applyFormat(this.parent.currentDocument,n.subCommand.toLocaleLowerCase(),this.parent.editableElement,n.enterAction,n.value,n.selector);this.callBack(n,n.subCommand)},n.prototype.callBack=function(n,t){n.callBack&&n.callBack({requestType:t,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),sb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ev,this.applyHtml,this)},n.prototype.applyHtml=function(n){if(bt.Insert(this.parent.currentDocument,n.value,this.parent.editableElement,!0),"pasteCleanup"===n.subCommand){var t=this.parent.editableElement.querySelectorAll(".pasteContent_RTE"),i=[].slice.call(t),r=this.parent.editableElement.querySelectorAll(".pasteContent_Img"),u=[].slice.call(r);n.callBack({requestType:n.subCommand,editorMode:"HTML",elements:i,imgElem:u})}else n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),nn=function(){function n(){}return n.clear=function(n,i,r,u){var a,s,v,c,l,y,w;this.domNode=new bh(i,n);this.defaultTag="P"===r?this.defaultTag:"div";var e=new b,h=new ur,o=e.getRange(n),k=o.collapsed,f=e.getInsertNodeCollection(o),p=e.save(o,n);if(!k){if(a="BR"===f[0].nodeName&&t.closest(f[0],"table")?h.GetSpliceNode(o,t.closest(f[0],"table")):h.GetSpliceNode(o,f[f.length>1&&"IMG"===f[0].nodeName?1:0]),1===f.length)e.setSelectionContents(n,a),o=e.getRange(n);else{for(s=1,v=f[f.length-s];f.length<=s&&"BR"===f[f.length-s].nodeName;)s++,v=f[f.length-s];c=h.GetSpliceNode(o,v);e.setSelectionText(n,a,c,0,3===c.nodeType?c.textContent.length:c.childNodes.length);o=e.getRange(n)}l=e.getNodeCollection(o);y=l.slice();this.clearInlines(e.getSelectionNodes(y),y,e.getRange(n),h,i);this.reSelection(n,p,l);o=e.getRange(n);w=(l=e.getNodeCollection(o)).slice();this.clearBlocks(n,w,i,h,e);d()&&wi(i,u);this.reSelection(n,p,l)}},n.reSelection=function(n,t,i){var r=t.getInsertNodes(i),u;t.startContainer=t.getNodeArray(r[0],!0,n);t.startOffset=0;t.endContainer=t.getNodeArray(r[r.length-1],!1,n);u=r[r.length-1];t.endOffset=3===u.nodeType?u.textContent.length:u.childNodes.length;t.restore()},n.clearBlocks=function(n,t,i,r,u){for(var f=[],e=0;e<t.length;e++)this.BLOCK_TAGS.indexOf(t[e].nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e])?f.push(t[e]):this.BLOCK_TAGS.indexOf(t[e].parentNode.nodeName.toLocaleLowerCase())>-1&&-1===f.indexOf(t[e].parentNode)&&i!==t[e].parentNode&&f.push(t[e].parentNode);f=this.spliceParent(f,t)[0];f=this.removeParent(f);this.unWrap(n,f,r,u)},n.spliceParent=function(n,t){for(var f,r,u,e,o,s,i=0;i<n.length;i++)for(f=n[i].childNodes.length,r=0;r<f;r++)if(t.indexOf(n[i].childNodes[r])>0&&n[i].childNodes[r].childNodes.length>0&&(t=this.spliceParent([n[i].childNodes[r]],t)[1]),t.indexOf(n[i].childNodes[r])<=-1&&""!==n[i].childNodes[r].textContent.trim()){for(u=0;u<f;u++)t.indexOf(n[i].childNodes[u])>-1&&t.splice(t.indexOf(n[i].childNodes[u]),1);r=n[i].childNodes.length;e=n.indexOf(n[i].parentNode);o=t.indexOf(n[i].parentNode);e>-1&&n.splice(e,1);o>-1&&t.splice(o,1);s=t.indexOf(n[i]);s>-1&&t.splice(s,1);n.splice(i,1);i--}return[n,t]},n.removeChild=function(n,t){var r=t.childNodes.length,i;if(r>0)for(i=0;i<r;i++)n.indexOf(t.childNodes[i])>-1&&(n=this.removeChild(n,t.childNodes[i])).splice(n.indexOf(t.childNodes[i]),1);return n},n.removeParent=function(n){for(var t=0;t<n.length;t++)n.indexOf(n[t].parentNode)>-1&&((n=this.removeChild(n,n[t])).splice(t,1),t--);return n},n.unWrap=function(n,t,i,r){for(var f,e,o,u=0;u<t.length;u++)if(this.NONVALID_TAGS.indexOf(t[u].nodeName.toLowerCase())>-1&&t[u].parentNode&&this.NONVALID_PARENT_TAGS.indexOf(t[u].parentNode.nodeName.toLowerCase())>-1&&(r.setSelectionText(n,t[u],t[u],0,t[u].childNodes.length),h.unwrap(i.GetSpliceNode(r.getRange(n),t[u].parentNode))),"p"!==t[u].nodeName.toLocaleLowerCase())for(!(this.NONVALID_PARENT_TAGS.indexOf(t[u].nodeName.toLowerCase())<0&&"p"!==t[u].parentNode.nodeName.toLocaleLowerCase())||("blockquote"===t[u].nodeName.toLocaleLowerCase()||"li"===t[u].nodeName.toLocaleLowerCase())&&this.IGNORE_PARENT_TAGS.indexOf(t[u].childNodes[0].nodeName.toLocaleLowerCase())>-1||1===t[u].childNodes.length&&"p"===t[u].childNodes[0].nodeName.toLocaleLowerCase()||h.Wrap(t[u],n.createElement(this.defaultTag)),f=h.unwrap(t[u]),1===f.length&&"p"===f[0].parentNode.nodeName.toLocaleLowerCase()&&(h.Wrap(t[u],n.createElement(this.defaultTag)),h.unwrap(t[u])),e=0;e<f.length;e++)this.NONVALID_TAGS.indexOf(f[e].nodeName.toLowerCase())>-1?this.unWrap(n,[f[e]],i,r):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&"p"!==f[e].nodeName.toLocaleLowerCase()?(o=this.removeParent([f[e]]),this.unWrap(n,o,i,r)):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&f[e].parentNode.nodeName.toLocaleLowerCase()===f[e].nodeName.toLocaleLowerCase()?h.unwrap(f[e]):this.BLOCK_TAGS.indexOf(f[e].nodeName.toLocaleLowerCase())>-1&&"p"===f[e].nodeName.toLocaleLowerCase()&&(h.Wrap(f[e],n.createElement(this.defaultTag)),h.unwrap(f[e]));else h.Wrap(t[u],n.createElement(this.defaultTag)),h.unwrap(t[u])},n.clearInlines=function(n,t,i,r){for(var f,u,e=0;e<n.length;e++){for(f=n[e],u=void 0;!this.domNode.isBlockNode(f);)u=f,f=f.parentElement;u&&gt.inlineTags.indexOf(u.nodeName.toLocaleLowerCase())>-1&&(r.GetSpliceNode(i,u),this.removeInlineParent(u))}},n.removeInlineParent=function(n){for(var i=h.unwrap(n),t=0;t<i.length;t++)1===i[t].parentNode.childNodes.length&&gt.inlineTags.indexOf(i[t].parentNode.nodeName.toLocaleLowerCase())>-1?this.removeInlineParent(i[t].parentNode):gt.inlineTags.indexOf(i[t].nodeName.toLocaleLowerCase())>-1&&this.removeInlineParent(i[t])},n.BLOCK_TAGS=["address","article","aside","blockquote","details","dd","div","dl","dt","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","header","hgroup","li","main","nav","noscript","ol","p","pre","section","ul"],n.NONVALID_PARENT_TAGS=["thead","tbody","ul","ol","table","tfoot","tr"],n.IGNORE_PARENT_TAGS=["ul","ol","table"],n.NONVALID_TAGS=["thead","tbody","figcaption","td","tr","th","tfoot","figcaption","li"],n.defaultTag="p",n}(),hb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(sv,this.applyClear,this);this.parent.observer.on(l,this.onKeyDown,this)},n.prototype.onKeyDown=function(n){"clear-format"===n.event.action&&(this.applyClear({subCommand:"ClearFormat",callBack:n.callBack,enterAction:n.enterAction}),n.event.preventDefault())},n.prototype.applyClear=function(n){"ClearFormat"===n.subCommand&&(nn.clear(this.parent.currentDocument,this.parent.editableElement,n.enterAction,n.selector),n.callBack&&n.callBack({requestType:n.subCommand,event:n.event,editorMode:"HTML",range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)}))},n}(),cb=function(){function n(n,i){this.undoRedoStack=[];this.parent=n;this.undoRedoSteps=t.isNullOrUndefined(i)?30:i.undoRedoSteps;this.undoRedoTimer=t.isNullOrUndefined(i)?300:i.undoRedoTimer;this.addEventListener()}return n.prototype.addEventListener=function(){var n=t.debounce(this.keyUp,this.undoRedoTimer);this.parent.observer.on(hi,n,this);this.parent.observer.on(l,this.keyDown,this);this.parent.observer.on(rr,this.onAction,this);this.parent.observer.on(wu,this.onPropertyChanged,this)},n.prototype.onPropertyChanged=function(n){for(var t=0,i=Object.keys(n.newProp);t<i.length;t++)switch(i[t]){case"undoRedoSteps":this.undoRedoSteps=n.newProp.undoRedoSteps;break;case"undoRedoTimer":this.undoRedoTimer=n.newProp.undoRedoTimer}},n.prototype.removeEventListener=function(){this.parent.observer.off(hi,this.keyUp);this.parent.observer.off(l,this.keyDown);this.parent.observer.off(rr,this.onAction)},n.prototype.onAction=function(n){"Undo"===n.subCommand?this.undo(n):this.redo(n)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.keyDown=function(n){var t=n.event;switch(t.action){case"undo":t.preventDefault();this.undo(n);break;case"redo":t.preventDefault();this.redo(n)}},n.prototype.keyUp=function(n){17===n.event.keyCode||n.event.ctrlKey||this.saveData(n)},n.prototype.saveData=function(n){for(var u,e,f=(new b).getRange(this.parent.currentDocument),r=f.startContainer,i=r.childNodes.length-1;i>=0;i--)!t.isNullOrUndefined(r.childNodes[i])&&"#text"===r.childNodes[i].nodeName&&0===r.childNodes[i].textContent.length&&"IMG"!==r.childNodes[i].nodeName&&"BR"!==r.childNodes[i].nodeName&&r.childNodes[i].nodeName&&t.detach(r.childNodes[i]);f=(new b).getRange(this.parent.currentDocument);u=(new b).save(f,this.parent.currentDocument);e={text:this.parent.editableElement.innerHTML,range:u};this.undoRedoStack.length>=this.steps&&(this.undoRedoStack=this.undoRedoStack.slice(0,this.steps+1));this.undoRedoStack.length>1&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.collapsed===f.collapsed&&this.undoRedoStack[this.undoRedoStack.length-1].range.startOffset===u.range.startOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.endOffset===u.range.endOffset&&this.undoRedoStack[this.undoRedoStack.length-1].range.range.startContainer===u.range.startContainer&&this.undoRedoStack[this.undoRedoStack.length-1].text.trim()===e.text.trim()||(this.undoRedoStack.push(e),this.steps=this.undoRedoStack.length-1,this.steps>this.undoRedoSteps&&(this.undoRedoStack.shift(),this.steps--),n&&n.callBack&&n.callBack())},n.prototype.undo=function(n){if(this.steps>0){var t=this.undoRedoStack[this.steps-1].range,i=this.undoRedoStack[this.steps-1].text;this.parent.editableElement.innerHTML=i;this.parent.editableElement.focus();d()&&wi(this.parent.editableElement,n.selector);t.restore();this.steps--;n.callBack&&n.callBack({requestType:"Undo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.redo=function(n){if(null!=this.undoRedoStack[this.steps+1]){var t=this.undoRedoStack[this.steps+1].range;this.parent.editableElement.innerHTML=this.undoRedoStack[this.steps+1].text;this.parent.editableElement.focus();d()&&wi(this.parent.editableElement,n.selector);t.restore();this.steps++;n.callBack&&n.callBack({requestType:"Redo",editorMode:"HTML",range:t,elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument),event:n.event})}},n.prototype.getUndoStatus=function(){var n={undo:!1,redo:!1};return this.steps>0&&(n.undo=!0),null!=this.undoRedoStack[this.steps+1]&&(n.redo=!0),n},n}(),lb=function(){function n(n){this.olData=["decimal","lower-alpha","lower-roman","upper-alpha","upper-roman","lower-greek"];this.ulData=["disc","square","circle","disc","square","circle"];this.ignorableNodes=["A","APPLET","B","BLOCKQUOTE","BR","BUTTON","CENTER","CODE","COL","COLGROUP","DD","DEL","DFN","DIR","DIV","DL","DT","EM","FIELDSET","FONT","FORM","FRAME","FRAMESET","H1","H2","H3","H4","H5","H6","HR","I","IMG","IFRAME","INPUT","INS","LABEL","LI","OL","OPTION","P","PARAM","PRE","Q","S","SELECT","SPAN","STRIKE","STRONG","SUB","SUP","TABLE","TBODY","TD","TEXTAREA","TFOOT","TH","THEAD","TITLE","TR","TT","U","UL"];this.blockNode=["div","p","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","table","tbody","td","tfoot","th","thead","tr","ul","header","article","nav","footer","section","aside","main","figure","figcaption"];this.borderStyle=["border-top","border-right","border-bottom","border-left"];this.removableElements=["o:p","style"];this.listContents=[];this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(gl,this.wordCleanup,this)},n.prototype.wordCleanup=function(n){var e=t.isNullOrUndefined(n.allowedStylePropertiesArray)?[]:n.allowedStylePropertiesArray,u=[],r=n.args.clipboardData.getData("text/HTML"),o=n.args.clipboardData.getData("text/rtf"),i=t.createElement("p"),f;i.setAttribute("id","MSWord-Content");i.innerHTML=r;f=/style='mso-width-source:/i;/class='?Mso|style='[^ ]*\bmso-/i.test(r)||/class="?Mso|style="[^ ]*\bmso-/i.test(r)||/(class="?Mso|class='?Mso|class="?Xl|class='?Xl|class=Xl|style="[^"]*\bmso-|style='[^']*\bmso-|w:WordDocument)/gi.test(r)||f.test(r)?(this.imageConversion(i,o),r=r.replace(/<img[^>]+>/i,""),this.addListClass(i),u=this.cleanUp(i,u),t.isNullOrUndefined(u[0])||"UL"===u[0].parentElement.tagName||"OL"===u[0].parentElement.tagName||this.listConverter(u),this.styleCorrection(i,e),this.removingComments(i),this.removeUnwantedElements(i),this.removeEmptyElements(i),this.breakLineAddition(i),this.removeClassName(i),f.test(r)&&this.addTableBorderClass(i),n.callBack(i.innerHTML)):n.callBack(i.innerHTML)},n.prototype.addListClass=function(n){for(var r=n.querySelectorAll("*"),i=0;i<r.length;i++)!t.isNullOrUndefined(r[i].getAttribute("style"))&&r[i].getAttribute("style").replace(/ /g,"").replace("\n","").indexOf("mso-list:l")>=0&&-1===r[i].className.toLowerCase().indexOf("msolistparagraph")&&"H"!==r[i].tagName.charAt(0)&&r[i].classList.add("msolistparagraph")},n.prototype.addTableBorderClass=function(n){for(var i,r=n.querySelectorAll("table"),u=!1,t=0;t<r.length;t++){for(i=0;i<this.borderStyle.length;i++)if(r[t].innerHTML.indexOf(this.borderStyle[i])>=0){u=!0;break}u&&(r[t].classList.add("e-rte-table-border"),u=!1)}},n.prototype.imageConversion=function(n,t){var i,f;this.checkVShape(n);var r=n.querySelectorAll("img"),u=[],e=[],o=[],s=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);if(r.length>0){for(i=0;i<r.length;i++)u.push(r[i].getAttribute("src")),o.push(r[i].getAttribute("src").split("/")[r[i].getAttribute("src").split("/").length-1].split(".")[0]);for(f=this.hexConversion(t),i=0;i<f.length;i++)e.push(this.convertToBase64(f[i]));for(i=0;i<r.length;i++)u[i].match(s)?r[i].setAttribute("src",u[i]):r[i].setAttribute("src",e[i]),r[i].setAttribute("id","msWordImg-"+o[i])}},n.prototype.checkVShape=function(n){for(var f,u,r=n.querySelectorAll("*"),i=0;i<r.length;i++)switch(r[i].nodeName){case"V:SHAPETYPE":t.detach(r[i]);break;case"V:SHAPE":"V:IMAGEDATA"===r[i].firstElementChild.nodeName&&(f=r[i].firstElementChild.getAttribute("src"),u=t.createElement("img"),u.setAttribute("src",f),r[i].parentElement.insertBefore(u,r[i]),t.detach(r[i]))}},n.prototype.convertToBase64=function(n){var t=this.conHexStringToBytes(n.hex),i=this.conBytesToBase64(t);return n.type?"data:"+n.type+";base64,"+i:null},n.prototype.conBytesToBase64=function(n){for(var t,e="",o=n.length,u=0;u<o;u+=3){var i=n.slice(u,u+3),f=i.length,r=[];if(f<3)for(t=f;t<3;t++)i[t]=0;for(r[0]=(252&i[0])>>2,r[1]=(3&i[0])<<4|i[1]>>4,r[2]=(15&i[1])<<2|(192&i[2])>>6,r[3]=63&i[2],t=0;t<4;t++)e+=t<=f?"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".charAt(r[t]):"="}return e},n.prototype.conHexStringToBytes=function(n){for(var i=[],r=n.length/2,t=0;t<r;t++)i.push(parseInt(n.substr(2*t,2),16));return i},n.prototype.hexConversion=function(n){var u,f=/\{\\pict[\s\S]+?\\bliptag\-?\d+(\\blipupi\-?\d+)?(\{\\\*\\blipuid\s?[\da-fA-F]+)?[\s\}]*?/,o=new RegExp("(?:("+f.source+"))([\\da-fA-F\\s]+)\\}","g"),r=n.match(o),e=[],i;if(!t.isNullOrUndefined(r))for(i=0;i<r.length;i++)if(f.test(r[i])){if(-1!==r[i].indexOf("\\pngblip"))u="image/png";else{if(-1===r[i].indexOf("\\jpegblip"))continue;u="image/jpeg"}e.push({hex:u?r[i].replace(f,"").replace(/[^\da-fA-F]/g,""):null,type:u})}return e},n.prototype.removeClassName=function(n){for(var i=n.querySelectorAll("*[class]"),t=0;t<i.length;t++)i[t].removeAttribute("class")},n.prototype.breakLineAddition=function(n){for(var u,f,r=n.querySelectorAll("*"),i=0;i<r.length;i++)0!==r[i].children.length||"&nbsp;"!==r[i].innerHTML||"&nbsp;"!==r[i].innerHTML||r[i].closest("li")||r[i].closest("td")||(u=this.findDetachElem(r[i]),f=t.createElement("br"),t.isNullOrUndefined(u.parentElement)||(u.parentElement.insertBefore(f,u),t.detach(u)))},n.prototype.findDetachElem=function(n){return!t.isNullOrUndefined(n.parentElement)&&""===n.parentElement.textContent.trim()&&"TD"!==n.parentElement.tagName&&t.isNullOrUndefined(n.parentElement.querySelector("img"))?this.findDetachElem(n.parentElement):n},n.prototype.removeUnwantedElements=function(n){for(var r,u,t=n.innerHTML,i=0;i<this.removableElements.length;i++)r=new RegExp("<"+this.removableElements[i]+">","g"),u=new RegExp("<\/"+this.removableElements[i]+">","g"),t=(t=t.replace(r,"")).replace(u,"");n.innerHTML=t;n.querySelectorAll(":empty")},n.prototype.findDetachEmptyElem=function(n){return t.isNullOrUndefined(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"MSWord-Content"!==n.parentElement.getAttribute("id")&&t.isNullOrUndefined(n.parentElement.querySelector("img"))?this.findDetachEmptyElem(n.parentElement):n},n.prototype.removeEmptyElements=function(n){for(var u,r=n.querySelectorAll(":empty"),i=0;i<r.length;i++)(t.isNullOrUndefined(r[i].closest("td"))||t.isNullOrUndefined(r[i].closest("td").querySelector(".MsoNormal"))||(r[i].innerHTML="-"),"IMG"!==r[i].tagName&&"BR"!==r[i].tagName&&"IFRAME"!==r[i].tagName&&"TD"!==r[i].tagName&&"HR"!==r[i].tagName)&&(u=this.findDetachEmptyElem(r[i]),t.isNullOrUndefined(u)||t.detach(u))},n.prototype.styleCorrection=function(n,i){var a=n.querySelectorAll("style"),o,h,c,s,p;if(a.length>0){var v=a[0].innerHTML.match(/[\S ]+\s+{[\s\S]+?}/gi),y=t.isNullOrUndefined(v)?null:this.findStyleObject(v),u=Object.keys(y),f=u.map(function(n){return y[n]});f=this.removeUnwantedStyle(f,i);this.filterStyles(n,i);for(var e=void 0,l=!1,r=0;r<u.length;r++){if(""===u[r].split(".")[0])e=n.getElementsByClassName(u[r].split(".")[1]),l=!0;else{if(1===u[r].split(".").length&&u[r].split(".")[0].indexOf("@")>=0)continue;e=1===u[r].split(".").length&&u[r].split(".")[0].indexOf("@")<0?n.getElementsByTagName(u[r]):n.querySelectorAll(u[r])}for(o=0;o<e.length;o++)if(h=e[o].getAttribute("style"),t.isNullOrUndefined(h)||""===h.trim())f[r]=f[r].replace(/text-indent:-(.*?)(?=;|$)/gm,""),e[o].setAttribute("style",f[r]);else{if(c=f[r].split(";"),!l)for(s=0;s<c.length;s++)h.indexOf(c[s].split(":")[0])>=0&&(c.splice(s,1),s--);f[r]=c.join(";")+";";p=h+f[r];e[o].setAttribute("style",p)}l=!1}}},n.prototype.filterStyles=function(n,t){for(var r=n.querySelectorAll("*[style]"),i=0;i<r.length;i++){for(var f=r[i].getAttribute("style").split(";"),e="",u=0;u<f.length;u++)t.indexOf(f[u].split(":")[0].trim())>=0&&(e+=f[u]+";");r[i].setAttribute("style",e)}},n.prototype.removeUnwantedStyle=function(n,t){for(var u,r,i=0;i<n.length;i++)for(u=n[i].split(";"),n[i]="",r=0;r<u.length;r++)t.indexOf(u[r].split(":")[0])>=0&&(n[i]+=u[r]+";");return n},n.prototype.findStyleObject=function(n){for(var e,u,f={},r=0;r<n.length;r++){var o=n[r],t=o.replace(/([\S ]+\s+){[\s\S]+?}/gi,"$1"),i=o.replace(/[\S ]+\s+{([\s\S]+?)}/gi,"$1");for(t=t.replace(/^[\s]|[\s]$/gm,""),i=i.replace(/^[\s]|[\s]$/gm,""),t=t.replace(/\n|\r|\n\r/g,""),i=i.replace(/\n|\r|\n\r/g,""),e=t.split(", "),u=0;u<e.length;u++)f[e[u]]=i}return f},n.prototype.removingComments=function(n){var t=n.innerHTML;t=t.replace(/<!--[\s\S]*?-->/g,"");n.innerHTML=t},n.prototype.cleanUp=function(n,i){for(var f,e=[],u=n.querySelectorAll("*"),r=0;r<u.length;r++)-1===this.ignorableNodes.indexOf(u[r].nodeName)||3===u[r].nodeType&&""===u[r].textContent.trim()?e.push(u[r]):(u[r].className&&-1!==u[r].className.toLowerCase().indexOf("msolistparagraph")&&1!==u[r].childElementCount&&!t.isNullOrUndefined(u[r].getAttribute("style"))&&u[r].getAttribute("style").indexOf("mso-list:")>=0&&(u[r].className.indexOf("MsoListParagraphCxSpFirst")>=0&&i.length>0&&null!==i[i.length-1]&&i.push(null),i.push(u[r])),!f||-1===this.blockNode.indexOf(u[r].nodeName.toLowerCase())||u[r].className&&-1!==u[r].className.toLowerCase().indexOf("msolistparagraph")&&!t.isNullOrUndefined(u[r].getAttribute("style"))&&u[r].getAttribute("style").indexOf("mso-list:")>=0||i.push(null),-1!==this.blockNode.indexOf(u[r].nodeName.toLowerCase())&&(f=!!(u[r].className&&-1!==u[r].className.toLowerCase().indexOf("msolistparagraph")&&!t.isNullOrUndefined(u[r].getAttribute("style"))&&u[r].getAttribute("style").indexOf("mso-list:")>=0)));return i.length&&null!==i[i.length-1]&&i.push(null),i},n.prototype.listConverter=function(n){for(var l,a,s,v,h,f,u,y,r,e=[],c=[],o="",p="",i=0;i<n.length;i++)if(null!==n[i]){if(n[i].getAttribute("style")&&-1!==n[i].getAttribute("style").indexOf("mso-outline-level")&&n[i].setAttribute("style",n[i].getAttribute("style").replace("mso-outline-level","mso-outline")),y=(o=n[i].getAttribute("style"))&&-1!==o.indexOf("level")?parseInt(o.charAt(o.indexOf("level")+5),null):1,this.listContents=[],this.getListContent(n[i]),l=void 0,!t.isNullOrUndefined(this.listContents[0])){for(l=this.listContents[0].trim().length>1?"ol":"ul",a=[],s=1;s<this.listContents.length;s++)a.push(this.listContents[s]);v=void 0;t.isNullOrUndefined(n[i].className)||(v=n[i].className);t.isNullOrUndefined(n[i].getAttribute("style"))||(n[i].setAttribute("style",n[i].getAttribute("style").replace("text-align:start;","")),""!==n[i].style.textAlign&&(n[i].setAttribute("style","text-align:"+n[i].style.textAlign),p=n[i].getAttribute("style")));c.push({listType:l,content:a,nestedLevel:y,"class":v,listStyle:p})}}else e.push({content:this.makeConversion(c),node:n[i-1]}),c=[];for(r=n.shift();r;){for(h=[],f=0;f<e.length;f++)if(e[f].node===r){for(u=0;u<e[f].content.childNodes.length;u++)h.push(e[f].content.childNodes[u]);for(u=0;u<h.length;u++)r.parentElement.insertBefore(h[u],r);break}r.remove();(r=n.shift())||(r=n.shift())}},n.prototype.makeConversion=function(n){for(var f,h,c,r,u,e,o=t.createElement("div"),s=1,l=0,i=0;i<n.length;i++){if(f=t.createElement("p"),f.innerHTML=n[i].content.join(" "),1===n[i].nestedLevel&&0===l&&n[i].content)o.appendChild(r=t.createElement(n[i].listType)),(u=t.createElement("li")).appendChild(f),r.appendChild(u),r.setAttribute("level",n[i].nestedLevel.toString()),r.style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel);else if(n[i].nestedLevel===s)u.parentElement.tagName.toLowerCase()===n[i].listType?(u.parentElement.appendChild(u=t.createElement("li")),u.appendChild(f)):(r=t.createElement(n[i].listType),u.parentElement.parentElement.appendChild(r),(u=t.createElement("li")).appendChild(f),r.appendChild(u),r.setAttribute("level",n[i].nestedLevel.toString()));else if(n[i].nestedLevel>s)if(t.isNullOrUndefined(u))o.appendChild(r=t.createElement(n[i].listType)),(u=t.createElement("li")).appendChild(f),r.appendChild(u),r.setAttribute("level",n[i].nestedLevel.toString()),r.style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel);else{for(h=0;h<n[i].nestedLevel-s;h++)u.appendChild(r=t.createElement(n[i].listType)),u=t.createElement("li",{styles:"list-style-type: none;"}),r.appendChild(u);u.appendChild(f);r.setAttribute("level",n[i].nestedLevel.toString());r.style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel);r.childNodes[0].style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel)}else if(1===n[i].nestedLevel)o.lastChild.tagName.toLowerCase()===n[i].listType?r=o.lastChild:o.appendChild(r=t.createElement(n[i].listType)),(u=t.createElement("li")).appendChild(f),r.appendChild(u),r.setAttribute("level",n[i].nestedLevel.toString()),r.style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel);else for(e=u;e.parentElement;)if((e=e.parentElement).attributes.getNamedItem("level")){if(parseInt(e.attributes.getNamedItem("level").textContent,null)===n[i].nestedLevel){(u=t.createElement("li")).appendChild(f);e.appendChild(u);break}if(n[i].nestedLevel>parseInt(e.attributes.getNamedItem("level").textContent,null)){e.appendChild(r=t.createElement(n[i].listType));(u=t.createElement("li")).appendChild(f);r.appendChild(u);r.setAttribute("level",n[i].nestedLevel.toString());r.style.listStyle=this.getListStyle(n[i].listType,n[i].nestedLevel);break}}u.setAttribute("class",n[i].class);c=u.getAttribute("style");u.setAttribute("style",(t.isNullOrUndefined(c)?"":c)+n[i].listStyle);s=n[i].nestedLevel;l++}return o},n.prototype.getListStyle=function(n,t){return t=t>0?t-1:t,"ol"===n?t<this.olData.length?this.olData[t]:this.olData[0]:t<this.ulData.length?this.ulData[t]:this.ulData[0]},n.prototype.getListContent=function(n){var u="",i=n.firstElementChild,e,r,f;if(""!==i.textContent.trim()||t.isNullOrUndefined(i.firstElementChild)||"IMG"!==i.firstElementChild.nodeName)if(e=["b","em"],i.childNodes.length>0&&(i.querySelectorAll("b").length>0||i.querySelectorAll("em").length>0))for(r=0;r<i.childNodes.length;r++)f=i.childNodes[r].nodeName.toLowerCase(),i.childNodes[r].textContent.trim().length>1&&-1!==e.indexOf(f)?(u="<"+f+">"+i.childNodes[r].textContent+"<\/"+f+">",this.listContents.push(u)):1===i.childNodes[r].textContent.trim().length&&this.listContents.push(i.childNodes[r].textContent.trim());else u=i.textContent.trim(),this.listContents.push(u);else u=n.innerHTML.trim(),this.listContents.push(""),this.listContents.push(u);t.detach(i);this.listContents.push(n.innerHTML)},n}(),ab=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.observer.on(ov,this.insertText,this)},n.prototype.insertText=function(n){var t=document.createTextNode(n.value);bt.Insert(this.parent.currentDocument,t);n.callBack&&n.callBack({requestType:n.subCommand,editorMode:"HTML",event:n.event,range:this.parent.nodeSelection.getRange(this.parent.currentDocument),elements:this.parent.nodeSelection.getSelectedNodes(this.parent.currentDocument)})},n}(),vb=function(){function n(n){this.currentDocument=n.document;this.editableElement=n.editableElement;this.nodeSelection=new b;this.nodeCutter=new ur;this.domNode=new bh(this.editableElement,this.currentDocument);this.observer=new t.Observer(this);this.listObj=new gw(this);this.formatObj=new nb(this);this.alignmentObj=new ib(this);this.indentsObj=new rb(this);this.linkObj=new tb(this);this.imgObj=new fb(this);this.selectionObj=new ob(this);this.inserthtmlObj=new sb(this);this.insertTextObj=new ab(this);this.clearObj=new hb(this);this.tableObj=new eb(this);this.undoRedoManager=new cb(this,n.options);this.msWordPaste=new lb(this);this.wireEvents()}return n.prototype.wireEvents=function(){this.observer.on(ah,this.editorKeyDown,this);this.observer.on(pu,this.editorKeyUp,this);this.observer.on(pu,this.editorKeyUp,this);this.observer.on(vh,this.onPropertyChanged,this);this.observer.on(na,this.onWordPaste,this);this.observer.on(ta,this.onBegin,this)},n.prototype.onWordPaste=function(n){this.observer.notify(gl,n)},n.prototype.onPropertyChanged=function(n){this.observer.notify(wu,n)},n.prototype.editorKeyDown=function(n){this.observer.notify(l,n)},n.prototype.editorKeyUp=function(n){this.observer.notify(hi,n)},n.prototype.onBegin=function(n){this.observer.notify(ia,n)},n.prototype.execCommand=function(n,t,i,r,u,f,e,o){switch(n.toLowerCase()){case"lists":this.observer.notify(dl,{subCommand:t,event:i,callBack:r,selector:e,item:f,enterAction:o});break;case"formats":this.observer.notify(te,{subCommand:t,event:i,callBack:r,selector:e,exeValue:f,enterAction:o});break;case"alignments":this.observer.notify(rv,{subCommand:t,event:i,callBack:r,selector:e,value:f});break;case"indents":this.observer.notify(uv,{subCommand:t,event:i,callBack:r,selector:e});break;case"links":this.observer.notify(va,{command:n,value:t,item:f,event:i,callBack:r});break;case"files":this.observer.notify(wh,{command:n,value:"Image",item:f,event:i,callBack:r,selector:e});break;case"images":this.observer.notify(wh,{command:n,value:t,item:f,event:i,callBack:r,selector:e});break;case"table":switch(t.toString().toLocaleLowerCase()){case"createtable":this.observer.notify(aa,{item:f,event:i,callBack:r,enterAction:o});break;case"insertrowbefore":case"insertrowafter":this.observer.notify(ya,{item:f,event:i,callBack:r});break;case"insertcolumnleft":case"insertcolumnright":this.observer.notify(pa,{item:f,event:i,callBack:r});break;case"deleterow":this.observer.notify(wa,{item:f,event:i,callBack:r});break;case"deletecolumn":this.observer.notify(ba,{item:f,event:i,callBack:r});break;case"tableremove":this.observer.notify(ka,{item:f,event:i,callBack:r});break;case"tableheader":this.observer.notify(da,{item:f,event:i,callBack:r});break;case"aligntop":case"alignmiddle":case"alignbottom":this.observer.notify(ga,{item:f,event:i,callBack:r});break;case"merge":this.observer.notify(nv,{item:f,event:i,callBack:r});break;case"horizontalsplit":this.observer.notify(iv,{item:f,event:i,callBack:r});break;case"verticalsplit":this.observer.notify(tv,{item:f,event:i,callBack:r})}break;case"font":case"style":case"effects":case"casing":this.observer.notify(fv,{subCommand:t,event:i,callBack:r,value:u,selector:e,enterAction:o});break;case"inserthtml":this.observer.notify(ev,{subCommand:t,callBack:r,value:u});break;case"inserttext":this.observer.notify(ov,{subCommand:t,callBack:r,value:u});break;case"clear":this.observer.notify(sv,{subCommand:t,event:i,callBack:r,selector:e,enterAction:o});break;case"actions":this.observer.notify(rr,{subCommand:t,event:i,callBack:r,selector:e})}},n}(),tn=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),yb=function(n){function i(i){var r=n.call(this)||this;return r.initialize(),t.extend(r,r,i,!0),r.currentDocument&&r.element&&r.updateFormatter(r.element,r.currentDocument,i.options),r}return tn(i,n),i.prototype.initialize=function(){this.keyConfig=cw},i.prototype.updateFormatter=function(n,t,i){n&&t&&(this.editorManager=new vb({document:t,editableElement:n,options:i}))},i}(ra),dh={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1},pb=function(){function n(){}return n.get=function(n,t,i,r,u,f){for(var e=JSON.parse(JSON.stringify(dh)),s=JSON.parse(JSON.stringify(dh)),c=new b,h=f?[f]:c.getNodeCollection(c.getRange(n)),v=h.length,l=!1,a=c.getRange(n),o=0;o<h.length;o++){for(;3===h[o].nodeType&&3===a.startContainer.nodeType&&h[o].parentNode&&h[o].parentNode.lastElementChild&&"BR"!==h[o].parentNode.lastElementChild.nodeName&&0===this.getImmediateBlockNode(h[o].parentNode).textContent.replace(/\u200B/g,"").length&&0===a.startContainer.textContent.replace(/\u200B/g,"").length&&0===c.get(n).toString().replace(/\u200B/g,"").length;)h[o]=h[o].parentNode.lastElementChild.firstChild,l=!0;l&&h[o]&&(c.setCursorPoint(n,h[o],h[o].textContent.length),l=!1);("BR"!==h[o].nodeName&&3!==h[o].nodeType||v>1&&3===h[o].nodeType&&""===h[o].textContent.trim())&&(h.splice(o,1),o--)}for(o=0;o<h.length;o++)e=this.getFormatParent(n,e,h[o],t,i,r,u),(0===o&&e.bold||!e.bold)&&(s.bold=e.bold),(0===o&&e.insertcode||!e.insertcode)&&(s.insertcode=e.insertcode),(0===o&&e.italic||!e.italic)&&(s.italic=e.italic),(0===o&&e.underline||!e.underline)&&(s.underline=e.underline),(0===o&&e.strikethrough||!e.strikethrough)&&(s.strikethrough=e.strikethrough),(0===o&&e.superscript||!e.superscript)&&(s.superscript=e.superscript),(0===o&&e.subscript||!e.subscript)&&(s.subscript=e.subscript),(0===o&&e.fontcolor||!e.fontcolor)&&(s.fontcolor=e.fontcolor),(0===o&&e.fontname||!e.fontname)&&(s.fontname=e.fontname),(0===o&&e.fontsize||!e.fontsize)&&(s.fontsize=e.fontsize),(0===o&&e.backgroundcolor||!e.backgroundcolor)&&(s.backgroundcolor=e.backgroundcolor),(0===o&&e.orderedlist||!e.orderedlist)&&(s.orderedlist=e.orderedlist),(0===o&&e.unorderedlist||!e.unorderedlist)&&(s.unorderedlist=e.unorderedlist),(0===o&&e.alignments||!e.alignments)&&(s.alignments=e.alignments),(0===o&&e.formats||!e.formats)&&(s.formats=e.formats),(0===o&&e.createlink||!e.createlink)&&(s.createlink=e.createlink),(0===o&&e.numberFormatList||!e.numberFormatList)&&(s.numberFormatList=e.numberFormatList),(0===o&&e.bulletFormatList||!e.bulletFormatList)&&(s.bulletFormatList=e.bulletFormatList),e=JSON.parse(JSON.stringify(dh));return s},n.getImmediateBlockNode=function(n){do n=n.parentNode;while(n&&bi.indexOf(n.nodeName.toLocaleLowerCase())<0);return n},n.getFormatParent=function(n,t,i,r,u,f,e){if(r.contains(i)||3===i.nodeType&&3!==r.nodeType&&r.contains(i.parentNode))do t=this.isFormattedNode(n,t,i,u,f,e),i=i.parentNode;while(i&&i!==r);return t},n.isFormattedNode=function(n,t,i,r,u,f){return t.bold||(t.bold=gt.isBold(i)),t.italic||(t.italic=gt.isItalic(i)),t.underline||(t.underline=gt.isUnderline(i)),t.strikethrough||(t.strikethrough=gt.isStrikethrough(i)),t.superscript||(t.superscript=gt.isSuperscript(i)),t.subscript||(t.subscript=gt.isSubscript(i)),t.fontcolor||(t.fontcolor=this.isFontColor(n,i)),t.fontname||(t.fontname=this.isFontName(n,i,f)),t.fontsize||(t.fontsize=this.isFontSize(i,u)),t.backgroundcolor||(t.backgroundcolor=this.isBackgroundColor(i)),t.orderedlist||(t.orderedlist=this.isOrderedList(i)),t.unorderedlist||(t.unorderedlist=this.isUnorderedList(i)),t.alignments||(t.alignments=this.isAlignment(i)),t.formats||(t.formats=this.isFormats(i,r),"pre"===t.formats&&(t.insertcode=!0)),t.createlink||(t.createlink=this.isLink(i)),t.numberFormatList||(t.numberFormatList=this.isNumberFormatList(i)),t.bulletFormatList||(t.bulletFormatList=this.isBulletFormatList(i)),t},n.isFontColor=function(n,t){var i=t.style&&t.style.color;return null!=i&&""!==i||3===t.nodeType||(i=this.getComputedStyle(n,t,"color")),null!==i&&""!==i&&void 0!==i?i:null},n.isLink=function(n){return"a"===n.nodeName.toLocaleLowerCase()},n.isBackgroundColor=function(n){var t=n.style&&n.style.backgroundColor;return null!==t&&""!==t&&void 0!==t?t:null},n.isFontSize=function(n,t){var i=n.style&&n.style.fontSize;return null!==i&&""!==i&&void 0!==i&&(null==t||t.indexOf(i)>-1)?i:null},n.isFontName=function(n,t,i){var r=t.style&&t.style.fontFamily,u;return null!=r&&""!==r||3===t.nodeType||(r=this.getComputedStyle(n,t,"font-family")),u=null,null!==r&&""!==r&&void 0!==r&&(null==i||i.filter(function(n,t){var i=new RegExp(r,"i");(n.replace(/"/g,"").replace(/ /g,"")===r.replace(/"/g,"").replace(/ /g,"")||n.search(i)>-1)&&(u=t)})&&null!==u)?null!==u?i[u]:r.replace(/"/g,""):null},n.isOrderedList=function(n){return"ol"===n.nodeName.toLocaleLowerCase()},n.isUnorderedList=function(n){return"ul"===n.nodeName.toLocaleLowerCase()},n.isAlignment=function(n){var t=n.style&&n.style.textAlign;return"left"===t?"justifyleft":"center"===t?"justifycenter":"right"===t?"justifyright":"justify"===t?"justifyfull":null},n.isFormats=function(n,t){return null==t&&bi.indexOf(n.nodeName.toLocaleLowerCase())>-1||null!=t&&t.indexOf(n.nodeName.toLocaleLowerCase())>-1?n.nodeName.toLocaleLowerCase():null},n.getComputedStyle=function(n,t,i){return n.defaultView.getComputedStyle(t,null).getPropertyValue(i)},n.isNumberFormatList=function(n){var t=n.style&&n.style.listStyleType;return"lower-alpha"===t?"Lower Alpha":"number"===t?"Number":"upper-alpha"===t?"Upper Alpha":"lower-roman"===t?"Lower Roman":"upper-roman"===t?"Upper Roman":"lower-greek"===t?"Lower Greek":"none"===t?"None":null},n.isBulletFormatList=function(n){var t=n.style&&n.style.listStyleType;return"circle"===t?"Circle":"square"===t?"Square":"none"===t?"None":"disc"===t?"Disc":null},n}(),wb=function(){function n(n){this.parent=n;this.toolbarStatus=this.prevToolbarStatus={bold:!1,italic:!1,subscript:!1,superscript:!1,strikethrough:!1,orderedlist:!1,unorderedlist:!1,underline:!1,alignments:null,backgroundcolor:null,fontcolor:null,fontname:null,fontsize:null,formats:null,createlink:!1,insertcode:!1};this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ti,this.onRefreshHandler,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(ti,this.onRefreshHandler);this.parent.off(u,this.removeEventListener)},n.prototype.onRefreshHandler=function(n){var t;if(!this.parent.readonly){var i=[],r=[],u=[];this.parent.fontSize.items.forEach(function(n){i.push(n.value)});this.parent.fontFamily.items.forEach(function(n){r.push(n.value)});this.parent.format.types.forEach(function(n){u.push(n.value.toLocaleLowerCase())});this.toolbarStatus=pb.get(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel(),u,i,r,n.documentNode);t=JSON.stringify(this.toolbarStatus);this.parent.notify(ht,this.toolbarStatus);JSON.stringify(this.prevToolbarStatus)!==t&&(this.parent.notify(sf,{html:JSON.parse(t),markdown:null}),this.prevToolbarStatus=JSON.parse(t))}},n}(),lv=function(){function n(n,t){this.parent=n;this.serviceLocator=t}return n.prototype.renderPanel=function(){var n=this.parent,t=this.parent.createElement("div",{className:"e-rte-content",id:this.parent.getID()+"rte-view"}),i=df(n.value,n);this.editableElement=this.parent.createElement("div",{className:"e-content",id:this.parent.getID()+"_rte-edit-view",attrs:{contenteditable:"true"},innerHTML:i});t.appendChild(this.editableElement);this.setPanel(t);n.element.appendChild(t)},n.prototype.getPanel=function(){return this.contentPanel},n.prototype.getEditPanel=function(){return this.editableElement},n.prototype.getText=function(){return this.getEditPanel().innerText},n.prototype.setPanel=function(n){this.contentPanel=n},n.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},n}(),rn=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),bb=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return rn(i,n),i.prototype.renderPanel=function(){var t=this.parent,i='\n<!DOCTYPE html> \n    <html>\n         <head>\n            <meta charset=\'utf-8\' /> \n            <style>\n                @charset "UTF-8";\n                body {\n                    font-family: "Roboto", sans-serif;\n                    font-size: 14px;\n                }\n                html, body{height: 100%;margin: 0;}\n                body.e-cursor{cursor:default}\n                span.e-selected-node\t{background-color: #939393;color: white;}\n                span.e-selected-node.e-highlight {background-color: #1d9dd8;}\n                body{color:#333;word-wrap:break-word;padding: 8px;box-sizing: border-box;}\n                .e-rte-image {border: 0;cursor: pointer;display:\n                    block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-img-caption { display: inline-block; float: none; margin: 5px auto; max-width: 100%;position: relative;}\n                .e-img-caption.e-caption-inline {display: inline-block;float: none;\n                    margin: 5px auto;margin-left: 5px;margin-right: 5px;max-width: calc(100% - (2 * 5px));\n                    position: relativetext-align: center;vertical-align: bottom;}\n                .e-img-inner {box-sizing: border-box;display: block;font-size: 16px;font-weight: initial;\n                    margin: auto;opacity: .9;text-align: center;width: 100%;}\n                .e-img-wrap {display: inline-block;margin: auto;padding: 0;text-align: center;width: 100%;}\n                .e-imgleft {float: left;margin: 0 5px 0 0;text-align: left;}\n                .e-imgright {float: right;margin: 0 0 0 5px;text-align: right;}\n                .e-imgcenter {cursor: pointer;display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-control img:not(.e-resize) {border: 2px solid transparent; z-index: 1000}\n                .e-imginline {display: inline-block;float: none;margin-left: 5px;margin-right: 5px;\n                    max-width: calc(100% - (2 * 5px));vertical-align: bottom;}\n                .e-imgbreak {border: 0;cursor: pointer;\n                    display: block;float: none;height: auto;margin: 5px auto;max-width: 100%;position: relative;}\n                .e-rte-image.e-img-focus:not(.e-resize) {border: solid 2px #4a90e2;}\n                img.e-img-focus::selection { background: transparent;color: transparent;}\n                span.e-rte-imageboxmark {  width: 10px; height: 10px; position: absolute; display: block;\n                    background: #4a90e2; border: 1px solid #fff; z-index: 1000;}\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-mob-rte span.e-rte-imageboxmark { background: #fff; border: 1px solid #4a90e2;\n                    border-radius: 15px; height: 20px; width: 20px; }\n                .e-mob-rte.e-mob-span span.e-rte-imageboxmark { background: #4a90e2; border: 1px solid #fff; }\n                .e-rte-content .e-content img.e-resize { z-index: 1000; }\n                .e-img-caption .e-img-inner { outline: 0; }\n                .e-img-caption a:focus-visible { outline: none; }\n                .e-img-caption .e-rte-image.e-imgright, .e-img-caption .e-rte-image.e-imgleft { float: none; margin: 0;}\n                body{box-sizing: border-box;min-height: 100px;outline: 0 solid transparent;\n                    overflow-x: auto;padding: 16px;position: relative;text-align: inherit;z-index: 2;}\n                p{margin: 0 0 10px;margin-bottom: 10px;}\n                li{margin-bottom: 10px;}\n                h1{font-size: 2.17em;font-weight: 400;line-height: 1;margin: 10px 0;}\n                h2{font-size: 1.74em;font-weight: 400;margin: 10px 0;}\n                h3{font-size: 1.31em;font-weight: 400;margin: 10px 0;}\n                h4{font-size: 16px;font-weight: 400;line-height: 1.5;margin: 0;}\n                h5{font-size: 00.8em;font-weight: 400;margin: 0;}\n                h6{font-size: 00.65em;font-weight: 400;margin: 0;}\n                blockquote{margin: 10px 0;margin-left: 0;padding-left: 5px;border-left: solid 2px #5c5c5c;}\n                pre{background-color: inherit;border: 0;border-radius: 0;color: #333;\n                    font-size: inherit;line-height: inherit;margin: 0 0 10px;overflow: visible;padding: 0;\n                    white-space: pre-wrap;word-break: inherit;word-wrap: break-word;}\n                strong, b{font-weight: 700;}\n                a{text-decoration: none;user-select: auto;}\n                a:hover{text-decoration: underline;};\n                p:last-child, pre:last-child, blockquote:last-child{margin-bottom: 0;}\n                h3+h4, h4+h5, h5+h6{margin-top: 00.6em;}\n                ul:last-child{margin-bottom: 0;}\n                table { border-collapse: collapse; empty-cells: show;}\n                table td,table th {border: 1px solid #BDBDBD; height: 20px; vertical-align: middle;}\n                table.e-alternate-border tbody tr:nth-child(2n) {background-color: #F5F5F5;}\n                table th {background-color: #E0E0E0;}\n                table.e-dashed-border td,table.e-dashed-border th { border: 1px dashed #BDBDBD} \n                table .e-cell-select {border: 1px double #4a90e2;}\n                span.e-table-box { cursor: nwse-resize; display: block; height: 10px; position: absolute; width: 10px; }\n                span.e-table-box.e-rmob {height: 14px;width: 14px;}\n                .e-row-resize, .e-column-resize { background-color: transparent; background-repeat: repeat;\n                    bottom: 0;cursor: col-resize;height: 1px;overflow: visible;position: absolute;width: 1px; }\n                .e-row-resize { cursor: row-resize; height: 1px;}\n                .e-table-rhelper { cursor: col-resize; opacity: .87;position: absolute;}\n                .e-table-rhelper.e-column-helper { width: 1px; }\n                .e-table-rhelper.e-row-helper {height: 1px;}\n                .e-reicon::before { border-bottom: 6px solid transparent; border-right: 6px solid;\n                    border-top: 6px solid transparent; content: \'\'; display: block; height: 0;\n                    position: absolute; right: 4px; top: 4px; width: 20px; }\n                .e-reicon::after { border-bottom: 6px solid transparent; border-left: 6px solid;\n                    border-top: 6px solid transparent; content: \'\'; display: block;\n                    height: 0; left: 4px; position: absolute; top: 4px; width: 20px; z-index: 3; }\n                .e-row-helper.e-reicon::after { top: 10px; transform: rotate(90deg); }\n                .e-row-helper.e-reicon::before { left: 4px; top: -20px; transform: rotate(90deg); }\n                span.e-table-box { background-color: #ffffff; border: 1px solid #BDBDBD; }\n                span.e-table-box.e-rbox-select { background-color: #BDBDBD; border: 1px solid #BDBDBD; }\n                .e-table-rhelper { background-color: #4a90e2;}\n                .e-rtl { direction: rtl; }\n            <\/style>\n        <\/head><body spellcheck="false" autocorrect="off" contenteditable="true">'+df(t.value,t)+"<\/body><\/html>",n=this.parent.createElement("iframe",{id:this.parent.getID()+"_rte-view",className:"e-rte-content",styles:"display:block;",attrs:{srcdoc:i}});this.setPanel(n);t.element.appendChild(n);n.contentDocument.body.id=this.parent.getID()+"_rte-edit-view";n.contentDocument.body.setAttribute("aria-owns",this.parent.getID());n.contentDocument.open();i=this.setThemeColor(i,{color:"#333"});n.contentDocument.write(i);n.contentDocument.close();t.enableRtl&&this.contentPanel.contentDocument.body.setAttribute("class","e-rtl")},i.prototype.setThemeColor=function(n,t){var i=getComputedStyle(this.parent.element,".e-richtexteditor").getPropertyValue("color");return n.replace(t.color,i)},i.prototype.getEditPanel=function(){return t.isNullOrUndefined(this.contentPanel.contentDocument)?this.parent.inputElement:this.contentPanel.contentDocument.body},i.prototype.getDocument=function(){return this.getEditPanel().ownerDocument},i}(lv),kb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(iu,this.enableXhtmlValidation,this);this.parent.on(u,this.removeEventListener,this)},n.prototype.removeEventListener=function(){this.parent.off(iu,this.enableXhtmlValidation);this.parent.off(u,this.removeEventListener)},n.prototype.enableXhtmlValidation=function(){this.parent.enableXhtml&&(this.currentElement=t.isNullOrUndefined(this.parent.inputElement)?this.parent.element:this.parent.inputElement,this.clean(this.currentElement),this.AddRootElement(),this.ImageTags(),this.removeTags(),this.RemoveUnsupported(),this.currentElement.innerHTML=this.selfEncloseValidation(this.currentElement.innerHTML,"\n"===this.currentElement.innerText?this.currentElement.innerText.length:this.currentElement.innerText.trim().length),this.parent.setProperties({value:this.currentElement.innerHTML},!0))},n.prototype.selfEncloseValidation=function(n,t){var u,e,r,f;0===t&&n.indexOf("table")<0&&n.indexOf("img")<0&&(u=n.split("&nbsp;"),u[u.length-1]="&#8203;"+u[u.length-1],n=u.join(""));n=n.replace(/<br>/g,"<br/>").replace(/<hr>/g,"<hr/>").replace(/ /g," ");for(var i=[],h=[],s=[/<img(.*?)>/gi,/<area(.*?)>/gi,/<base(.*?)>/gi,/<col (.*?)>/gi,/<embed(.*?)>/gi,/<input(.*?)>/gi,/<link(.*?)>/gi,/<meta(.*?)>/gi,/<param(.*?)>/gi,/<source(.*?)>/gi,/<track(.*?)>/gi,/<wbr(.*?)>/gi],o=0;o<s.length;o++){for(e=s[o].exec(n);null!==e;)i.push(e[0].toString()),e=s[o].exec(n);for(h=i.slice(0),r=0;r<i.length;r++)-1!==i[r].indexOf("/")&&i[r].lastIndexOf("/")===i[r].length-2||(i[r]=i[r].substr(0,i[r].length-1)+" /"+i[r].substr(i[r].length-1,i[r].length));for(f=0;f<=i.length-1;f++)n=n.replace(h[f],i[f])}return n},n.prototype.AddRootElement=function(){if(1===this.currentElement.childNodes.length&&"DIV"!==this.currentElement.firstChild.nodeName||this.currentElement.childNodes.length>1){for(var n=this.parent.createElement("div");this.currentElement.childNodes.length>0;)n.appendChild(this.currentElement.childNodes[0]);this.currentElement.appendChild(n)}},n.prototype.clean=function(n){for(var t,i=0;i<n.childNodes.length;i++)t=n.childNodes[i],8===t.nodeType||"V:IMAGE"===t.nodeName?(n.removeChild(t),i--):1===t.nodeType&&this.clean(t);return this.currentElement.innerHTML},n.prototype.ImageTags=function(){for(var t=this.currentElement.querySelectorAll("IMG"),n=t.length-1;n>=0;n--)t[n].hasAttribute("alt")||t[n].setAttribute("alt","")},n.prototype.removeTags=function(){for(var t=[["br","ul"],["br","ol"],["table","span"],["div","span"],["p","span"]],n=0;n<t.length;n++)this.RemoveElementNode(t[n][0],t[n][1])},n.prototype.RemoveElementNode=function(n,i){for(var e,u,f=this.currentElement.querySelectorAll(i),r=0;r<f.length;r++)for(e=f[r].querySelectorAll(n),u=e.length;u>0;u--)t.detach(e[u-1])},n.prototype.RemoveUnsupported=function(){for(var u,r,f,e,i=this.currentElement.querySelectorAll("u"),n=i.length-1;n>=0;n--)u=this.parent.createElement("span"),u.style.textDecoration="underline",u.innerHTML=i[n].innerHTML,i[n].parentNode.insertBefore(u,i[n]),t.detach(i[n]);for(r=this.currentElement.querySelectorAll("strong"),n=r.length-1;n>=0;n--)f=this.parent.createElement("b"),f.innerHTML=r[n].innerHTML,r[n].parentNode.insertBefore(f,r[n]),t.detach(r[n]);for(e=["language","role","target","contenteditable","cellspacing","cellpadding","border","valign","colspan"],n=0;n<=e.length;n++)this.RemoveAttributeByName(e[n])},n.prototype.RemoveAttributeByName=function(n){var u,i,f,t,r;if(null!==this.currentElement.firstChild&&3!==this.currentElement.firstChild.nodeType)for(u=0;u<this.currentElement.childNodes.length;u++)if(i=this.currentElement.childNodes[u],3!==i.nodeType&&"TABLE"!==i.nodeName&&"TBODY"!==i.nodeName&&"THEAD"!==i.nodeName&&"TH"!==i.nodeName&&"TR"!==i.nodeName&&"TD"!==i.nodeName&&(i.hasAttribute(n)&&i.removeAttribute(n),i.hasChildNodes()))for(f=0;f<i.childNodes.length;f++)if(t=i.childNodes[f],3!==t.nodeType&&"TABLE"!==t.nodeName&&"TBODY"!==t.nodeName&&"THEAD"!==t.nodeName&&"TH"!==t.nodeName&&"TR"!==t.nodeName&&"TD"!==t.nodeName&&t.hasAttribute(n)&&t.removeAttribute(n),t.hasChildNodes())for(r=0;r<t.childNodes.length;r++)3!==t.childNodes[r].nodeType&&"TABLE"!==t.childNodes[r].nodeName&&"TBODY"!==t.childNodes[r].nodeName&&"THEAD"!==t.childNodes[r].nodeName&&"TH"!==t.childNodes[r].nodeName&&"TR"!==t.childNodes[r].nodeName&&"TD"!==t.childNodes[r].nodeName&&t.childNodes[r].hasAttribute(n)&&t.childNodes[r].removeAttribute(n)},n}(),un=function(){function n(n,t){this.rangeCollection=[];this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.xhtmlValidation=new kb(n);this.addEventListener()}return n.prototype.destroy=function(){this.removeEventListener()},n.prototype.sanitizeHelper=function(n){return ll(n,this.parent)},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.nodeSelectionObj=new b,this.colorPickerModule=new kl(this.parent,this.locator),this.parent.on(or,this.instantiateRenderer,this),this.parent.on(fe,this.onToolbarClick,this),this.parent.on(p,this.onKeyDown,this),this.parent.on(ct,this.onKeyUp,this),this.parent.on(gu,this.renderColorPicker,this),this.parent.on(c,this.render,this),this.parent.on(a,this.onPropertyChanged,this),this.parent.on(u,this.destroy,this),this.parent.on(gr,this.selectAll,this),this.parent.on(ef,this.selectRange,this),this.parent.on(nu,this.getSelectedHtml,this),this.parent.on(lt,this.onSelectionSave,this),this.parent.on(et,this.onSelectionRestore,this),this.parent.on(tu,this.updateReadOnly,this),this.parent.on(di,this.onPaste,this))},n.prototype.updateReadOnly=function(){this.parent.readonly?(t.attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"false"}),t.addClass([this.parent.element],cu)):(t.attributes(this.parent.contentModule.getEditPanel(),{contenteditable:"true"}),t.removeClass([this.parent.element],cu))},n.prototype.onSelectionSave=function(){var n=this.contentRenderer.getDocument(),t=this.nodeSelectionObj.getRange(n);this.saveSelection=this.nodeSelectionObj.save(t,n)},n.prototype.onSelectionRestore=function(n){this.parent.isBlur=!1;this.contentRenderer.getEditPanel().focus();(t.isNullOrUndefined(n.items)||n.items)&&this.saveSelection.restore()},n.prototype.onKeyUp=function(n){var r,u=n.args,i=this.parent.getRange(),f=new RegExp(String.fromCharCode(8203),"g");[8,9,13,16,17,18,20,27,37,38,39,40,44,45,46,91,112,113,114,115,116,117,118,119,120,121,122,123].indexOf(u.keyCode)<0&&!u.shiftKey&&!u.ctrlKey&&!u.altKey&&(8203===i.startContainer.textContent.charCodeAt(0)&&(r=i.startOffset-1,i.startContainer.textContent=i.startContainer.textContent.replace(f,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,r)),t.isNullOrUndefined(i.startContainer.previousSibling)||t.isNullOrUndefined(i.startContainer.previousSibling.parentElement)||i.startContainer.parentElement!==i.startContainer.previousSibling.parentElement||8203!==i.startContainer.previousSibling.textContent.charCodeAt(0)||(i.startContainer.previousSibling.textContent=i.startContainer.previousSibling.textContent.replace(f,"")),8203===i.endContainer.textContent.charCodeAt(i.endOffset)&&(r=i.startOffset,i.endContainer.textContent=i.endContainer.textContent.replace(f,""),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.startContainer,r)))},n.prototype.onKeyDown=function(n){var r,u=this,i=n.args,s,e,o,a,v;if(("chrome"===t.Browser.info.name&&(r=this.parent.getRange(),this.backSpaceCleanup(n,r),this.deleteCleanup(n,r)),9===i.keyCode&&this.parent.enableTabKey&&!t.isNullOrUndefined(i.target)&&t.isNullOrUndefined(t.closest(i.target,".e-rte-toolbar")))&&(s=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),e=this.nodeSelectionObj.getParentNodeCollection(s),("LI"===e[0].nodeName||t.closest(e[0],"li")||t.closest(e[0],"table"))&&0===s.startOffset||((i.preventDefault(),i.shiftKey)?this.rangeCollection.length>0&&4===this.rangeCollection[this.rangeCollection.length-1].startContainer.textContent.length&&(o=this.rangeCollection[this.rangeCollection.length-1].startContainer,this.nodeSelectionObj.setSelectionText(this.contentRenderer.getDocument(),o,o,0,o.textContent.length),bt.Insert(this.contentRenderer.getDocument(),document.createTextNode("")),this.rangeCollection.pop()):(bt.Insert(this.contentRenderer.getDocument(),"&nbsp;&nbsp;&nbsp;&nbsp;"),this.rangeCollection.push(this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()))))),"space"!==n.args.action&&"enter"!==n.args.action&&13!==n.args.keyCode||(this.spaceLink(n.args),"HTML"!==this.parent.editorMode||this.parent.readonly||this.parent.notify(ho,{args:n.args})),"space"===n.args.action){var h=this.parent.getRange(),c=h.startContainer.textContent.slice(0,h.startOffset),f=this.isOrderedList(c),l=this.isUnOrderedList(c);(f&&!l||l&&!f)&&(a={callBack:null,event:n.args,name:"keydown-handler"},v={cancel:!1,item:{command:"Lists",subCommand:f?"OL":"UL"},name:"actionBegin",originalEvent:n.args,requestType:f?"OL":"UL"},this.parent.trigger(k,v,function(t){t.cancel||(u.parent.formatter.editorManager.observer.notify(ta,a),u.parent.trigger(ft,{editorMode:u.parent.editorMode,elements:u.parent.formatter.editorManager.domNode.blockNodes(),event:n.args,name:ft,range:u.parent.getRange(),requestType:f?"OL":"UL"}))}))}"chrome"!==t.Browser.info.name||(t.isNullOrUndefined(this.rangeElement)||t.isNullOrUndefined(this.oldRangeElement))&&(t.isNullOrUndefined(this.deleteRangeElement)||t.isNullOrUndefined(this.deleteOldRangeElement))||"TD"===r.startContainer.parentElement.tagName||"TH"===r.startContainer.parentElement.tagName||(this.rangeElement=null,this.oldRangeElement=null,this.deleteRangeElement=null,this.deleteOldRangeElement=null,i.preventDefault())},n.prototype.isOrderedList=function(n){var r,i;if(n=n.replace(/\u200B/g,""),r=[/^[1]+[.]+$/,/^[i]+[.]+$/,/^[a]+[.]+$/],!t.isNullOrUndefined(n))for(i=0;i<r.length;i++)if(r[i].test(n))return!0;return!1},n.prototype.isUnOrderedList=function(n){var r,i;if(n=n.replace(/\u200B/g,""),r=[/^[*]$/,/^[-]$/],!t.isNullOrUndefined(n))for(i=0;i<r.length;i++)if(r[i].test(n))return!0;return!1},n.prototype.backSpaceCleanup=function(n,i){var u=!1,r;if("Backspace"===n.args.code&&8===n.args.keyCode&&0===i.startOffset&&0===i.endOffset&&0===this.parent.getSelection().length&&i.startContainer.textContent.length>0&&"TD"!==i.startContainer.parentElement.tagName&&"TH"!==i.startContainer.parentElement.tagName){if(this.rangeElement=this.getRootBlockNode(i.startContainer),"OL"===this.rangeElement.tagName||"UL"===this.rangeElement.tagName)r=this.getRangeLiNode(i.startContainer),r.previousElementSibling&&r.previousElementSibling.childElementCount>0&&(this.oldRangeElement=r.previousElementSibling.lastElementChild,t.isNullOrUndefined(r.lastElementChild)?this.rangeElement=r:(this.rangeElement=r.lastElementChild,u=!0));else{if("TABLE"===this.rangeElement.tagName||!t.isNullOrUndefined(this.rangeElement.previousElementSibling)&&"TABLE"===this.rangeElement.previousElementSibling.tagName)return;this.oldRangeElement=this.rangeElement.previousElementSibling}if(t.isNullOrUndefined(this.oldRangeElement))return;if("OL"!==this.oldRangeElement.tagName&&"UL"!==this.oldRangeElement.tagName||(this.oldRangeElement=this.oldRangeElement.lastElementChild.lastElementChild?this.oldRangeElement.lastElementChild.lastElementChild:this.oldRangeElement.lastElementChild),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.oldRangeElement,this.oldRangeElement.childNodes.length),this.oldRangeElement.querySelector("BR")&&t.detach(this.oldRangeElement.querySelector("BR")),!t.isNullOrUndefined(this.rangeElement)&&this.oldRangeElement!==this.rangeElement){for(;this.rangeElement.firstChild;)this.oldRangeElement.appendChild(this.rangeElement.childNodes[0]);u?t.detach(this.rangeElement.parentElement):t.detach(this.rangeElement);this.oldRangeElement.normalize()}}},n.prototype.deleteCleanup=function(n,i){var r,f,u=!1;if("Delete"===n.args.code&&46===n.args.keyCode&&0!==this.parent.contentModule.getText().trim().length&&0===this.parent.getSelection().length&&"TD"!==i.startContainer.parentElement.tagName&&"TH"!==i.startContainer.parentElement.tagName){if(this.deleteRangeElement=f=this.getRootBlockNode(i.startContainer),"OL"===this.deleteRangeElement.tagName||"UL"===this.deleteRangeElement.tagName)(r=this.getRangeLiNode(i.startContainer)).nextElementSibling&&r.nextElementSibling.childElementCount>0&&!r.nextElementSibling.querySelector("BR")?t.isNullOrUndefined(r.lastElementChild)?this.deleteRangeElement=r:(this.deleteRangeElement=r.lastElementChild,u=!0):this.deleteRangeElement=this.getRangeElement(r);else if(3===this.deleteRangeElement.nodeType||"TABLE"===this.deleteRangeElement.tagName||!t.isNullOrUndefined(this.deleteRangeElement.nextElementSibling)&&"TABLE"===this.deleteRangeElement.nextElementSibling.tagName)return;if(this.getCaretIndex(i,this.deleteRangeElement)===this.deleteRangeElement.textContent.length){if(this.deleteOldRangeElement=t.isNullOrUndefined(r)?this.deleteRangeElement.nextElementSibling:u||!t.isNullOrUndefined(r.nextElementSibling)?this.getRangeElement(r.nextElementSibling):f.nextElementSibling,t.isNullOrUndefined(this.deleteOldRangeElement))return;if(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),this.deleteRangeElement,this.deleteRangeElement.childNodes.length),this.deleteRangeElement.querySelector("BR")&&t.detach(this.deleteRangeElement.querySelector("BR")),t.isNullOrUndefined(this.deleteRangeElement)||"OL"===this.deleteOldRangeElement.tagName||"UL"===this.deleteOldRangeElement.tagName||this.deleteOldRangeElement===this.deleteRangeElement)this.deleteRangeElement=null,this.deleteOldRangeElement=null;else{for(;this.deleteOldRangeElement.firstChild;)this.deleteRangeElement.appendChild(this.deleteOldRangeElement.childNodes[0]);u?t.detach(this.deleteOldRangeElement.parentElement):t.detach(this.deleteOldRangeElement);this.deleteRangeElement.normalize()}}else this.deleteRangeElement=null}},n.prototype.getCaretIndex=function(n,t){var r=0,i;return 0!==this.parent.contentModule.getDocument().getSelection().rangeCount&&(i=n.cloneRange(),i.selectNodeContents(t),i.setEnd(n.endContainer,n.endOffset),r=i.toString().length),r},n.prototype.getRangeElement=function(n){return n.lastElementChild?"BR"===n.lastElementChild.tagName?n.lastElementChild.previousElementSibling?n.lastElementChild.previousElementSibling:n:n.lastElementChild:n},n.prototype.getRootBlockNode=function(n){for(;n&&this.parent&&this.parent.inputElement!==n&&n.parentElement!==this.parent.inputElement;n)n=n.parentElement;return n},n.prototype.getRangeLiNode=function(n){for(var t=n.parentElement;t!==this.parent.inputElement&&(1!==t.nodeType||"LI"!==t.tagName);)t=t.parentElement;return t},n.prototype.onPaste=function(n){var v=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi),f,o,u,l;if(n.text.match(v)){if(n.isWordPaste)return;n.args.preventDefault();for(var y=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),p=(this.parent.formatter.editorManager.nodeSelection.save(y,this.parent.contentModule.getDocument()),new RegExp(/([^\S]|^)(((https?\:\/\/)))/gi)),w=new RegExp(/([^\S]|^)(((www\.))(\S+))/gi),s=n.text.split("\n"),h="",r=0;r<s.length;r++)if(""===s[r].trim())h+=oh(this.parent);else{for(var e="",a=!0,c=s[r].split(" "),i=0;i<c.length;i++)""===c[i].trim()?e+=a?"&nbsp;":" ":(a=!1,e+=c[i]+" ");h+=0===r?"<span>"+e.trim()+"<\/span>":"<p>"+e.trim()+"<\/p>"}for(f=this.parent.createElement("div"),f.setAttribute("class","pasteContent"),f.style.display="inline",f.innerHTML=h.replace("&para","&amp;para"),o=f.querySelectorAll("span, p"),r=0;r<o.length;r++){for(u=o[r].innerHTML.split(" "),l="",i=0;i<u.length;i++)l+=u[i].match(p)||u[i].match(w)?'<a className="e-rte-anchor" href="'+u[i]+'" title="'+u[i]+'"target="_blank">'+u[i]+" <\/a>":u[i]+" ";o[r].innerHTML=l.trim()}t.isNullOrUndefined(this.parent.pasteCleanupModule)?this.parent.formatter.editorManager.execCommand("insertHTML",null,null,null,f):n.callBack(f.innerHTML)}},n.prototype.spaceLink=function(n){var i=this.nodeSelectionObj.getRange(this.contentRenderer.getDocument()),s=this.nodeSelectionObj.getParentNodeCollection(i),u=i.startContainer.textContent.substr(0,i.endOffset),r=u.split(" "),t=r[r.length-1],h=i.startOffset-(u.length-r[r.length-1].length),f,e,o;t=t.slice(0,h);f=new RegExp(/([^\S]|^)(((https?\:\/\/)|(www\.))(\S+))/gi);"A"!==s[0].nodeName&&t.match(f)&&(e=this.nodeSelectionObj.save(i,this.parent.contentModule.getDocument()),o={url:t.indexOf("http")>-1?t:"http://"+t,selection:e,selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),text:t,title:"",target:"_blank"},this.parent.formatter.process(this.parent,{item:{command:"Links",subCommand:"CreateLink"}},n,o))},n.prototype.onToolbarClick=function(n){var r,u,f,i=n.item,o=t.closest(n.originalEvent.target,".e-rte-quick-popup"),e,s,h;if(o&&!o.classList.contains("e-rte-inline-popup"))"SourceCode"!==i.subCommand&&"Preview"!==i.subCommand&&"FontColor"!==i.subCommand&&"BackgroundColor"!==i.subCommand&&(d()&&"Images"===i.command&&this.nodeSelectionObj.restore(),e=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),r=this.nodeSelectionObj.save(e,this.parent.contentModule.getDocument()),u=this.nodeSelectionObj.getNodeCollection(e),f=this.nodeSelectionObj.getParentNodeCollection(e)),"Images"===i.command&&this.parent.notify(ce,{member:"image",args:n,selectNode:u,selection:r,selectParent:f}),"Links"===i.command&&this.parent.notify(le,{member:"link",args:n,selectNode:u,selection:r,selectParent:f}),"Table"===i.command&&this.parent.notify(eo,{member:"table",args:n,selectNode:u,selection:r,selectParent:f});else{s=document.getElementById(this.parent.getID()+"_rtelink");h=document.getElementById(this.parent.getID()+"_image");switch("SourceCode"!==i.subCommand&&"Preview"!==i.subCommand&&"FontColor"!==i.subCommand&&"BackgroundColor"!==i.subCommand&&(e=this.nodeSelectionObj.getRange(this.parent.contentModule.getDocument()),t.isNullOrUndefined(s)&&t.isNullOrUndefined(h)&&(r=this.nodeSelectionObj.save(e,this.parent.contentModule.getDocument())),u=this.nodeSelectionObj.getNodeCollection(e),f=this.nodeSelectionObj.getParentNodeCollection(e)),i.subCommand){case"Maximize":this.parent.notify(nf,{args:n});break;case"Minimize":this.parent.notify(tf,{args:n});break;case"CreateLink":this.parent.notify(rf,{member:"link",args:n,selectNode:u,selection:r,selectParent:f});break;case"RemoveLink":this.parent.notify(uf,{member:"link",args:n,selectNode:u,selection:r,selectParent:f});break;case"Print":this.parent.print();break;case"Image":this.parent.notify(ar,{member:"image",args:n,selectNode:u,selection:r,selectParent:f});break;case"CreateTable":this.parent.notify(uo,{member:"table",args:n,selection:r});break;case"SourceCode":this.parent.notify(ki,{member:"viewSource",args:n});break;case"Preview":this.parent.notify(yr,{member:"updateSource",args:n});break;case"FontColor":case"BackgroundColor":break;case"File":this.parent.notify(of,{member:"fileManager",args:n,selectNode:u,selection:r,selectParent:f});break;default:this.parent.formatter.process(this.parent,n,n.originalEvent,null)}}},n.prototype.renderColorPicker=function(n){this.colorPickerModule.renderColorPickerInput(n)},n.prototype.instantiateRenderer=function(){this.parent.iframeSettings.enable?this.renderFactory.addRenderer(f.Content,new bb(this.parent,this.locator)):this.renderFactory.addRenderer(f.Content,new lv(this.parent,this.locator))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.render),this.parent.off(a,this.onPropertyChanged),this.parent.off(fe,this.onToolbarClick),this.parent.off(gu,this.renderColorPicker),this.parent.off(u,this.destroy),this.parent.off(p,this.onKeyDown),this.parent.off(or,this.instantiateRenderer),this.parent.off(gr,this.selectAll),this.parent.off(ef,this.selectRange),this.parent.off(nu,this.getSelectedHtml),this.parent.off(lt,this.onSelectionSave),this.parent.off(et,this.onSelectionRestore),this.parent.off(tu,this.updateReadOnly),this.parent.off(di,this.onPaste))},n.prototype.render=function(){var n,i,r;this.contentRenderer=this.renderFactory.getRenderer(f.Content);n=this.contentRenderer.getEditPanel();i={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};t.isNullOrUndefined(this.parent.formatter)?(r=new yb({currentDocument:this.contentRenderer.getDocument(),element:n,options:i}),this.parent.setProperties({formatter:r},!0)):this.parent.formatter.updateFormatter(n,this.contentRenderer.getDocument(),i);this.parent.enableXhtml&&this.parent.notify(iu,{});this.parent.toolbarSettings.enable&&(this.toolbarUpdate=new wb(this.parent));this.parent.inlineMode.enable&&(t.isNullOrUndefined(this.parent.fontFamily.default)||(n.style.fontFamily=this.parent.fontFamily.default),t.isNullOrUndefined(this.parent.fontSize.default)||(n.style.fontSize=this.parent.fontSize.default));this.parent.notify(du,{})},n.prototype.onPropertyChanged=function(n){if(!t.isNullOrUndefined(n.newProp.formatter)){var i=this.contentRenderer.getEditPanel(),r={undoRedoSteps:this.parent.undoRedoSteps,undoRedoTimer:this.parent.undoRedoTimer};this.parent.formatter.updateFormatter(i,this.contentRenderer.getDocument(),r)}},n.prototype.getModuleName=function(){return"htmlEditor"},n.prototype.selectAll=function(){var n=hl(this.parent.contentModule.getDocument(),this.parent.contentModule.getEditPanel());n.length>0&&this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.parent.contentModule.getDocument(),n[0],n[n.length-1],0,n[n.length-1].textContent.length)},n.prototype.selectRange=function(n){this.parent.formatter.editorManager.nodeSelection.setRange(this.parent.contentModule.getDocument(),n.range)},n.prototype.getSelectedHtml=function(n){n.callBack(this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()).toString())},n}();const er=ejdashboard.buttons;db=function(){function n(n,t){this.inlineNode=["a","abbr","acronym","audio","b","bdi","bdo","big","br","button","canvas","cite","code","data","datalist","del","dfn","em","embed","font","i","iframe","img","input","ins","kbd","label","map","mark","meter","noscript","object","output","picture","progress","q","ruby","s","samp","script","select","slot","small","span","strong","sub","sup","svg","template","textarea","time","u","tt","var","video","wbr"];this.blockNode=["div","h1","h2","h3","h4","h5","h6","address","blockquote","button","center","dd","dir","dl","dt","fieldset","frameset","hr","iframe","isindex","li","map","menu","noframes","noscript","object","ol","pre","td","tr","th","tbody","tfoot","thead","table","ul","header","article","nav","footer","section","aside","main","figure","figcaption"];this.isNotFromHtml=!1;this.containsHtml=!1;this.parent=n;this.locator=t;this.renderFactory=this.locator.getService("rendererFactory");this.i10n=t.getService("rteLocale");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.nodeSelectionObj=new b;this.parent.isDestroyed||(this.parent.on(so,this.pasteClean,this),this.parent.on(u,this.destroy,this))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(so,this.pasteClean),this.parent.off(u,this.destroy))},n.prototype.pasteClean=function(n){var e,o=this,r={requestType:"Paste",editorMode:this.parent.editorMode,event:n},i=null,s,l,h,c,a,u;(n.args&&!t.isNullOrUndefined(n.args.clipboardData)&&(i=n.args.clipboardData.getData("text/html")),this.parent.trigger(oy,{value:i}),n.args&&null!==i&&"HTML"===this.parent.editorMode)&&(0===i.length?(s=new RegExp(/<\/[a-z][\s\S]*>/i),i=n.args.clipboardData.getData("text/plain"),this.isNotFromHtml=""!==i,i=(i=i.replace(/</g,"&lt;")).replace(/>/g,"&gt;"),this.containsHtml=s.test(i),l=n&&n.args.clipboardData&&n.args.clipboardData.items.length>0?n.args.clipboardData.items[0].getAsFile():null,(this.parent.notify(di,{file:l,args:n.args,text:i,callBack:function(t){"object"==typeof(e=t)?o.parent.formatter.editorManager.execCommand("Images","Image",n.args,o.imageFormatting.bind(o,r),"pasteCleanup",e,"pasteCleanupModule"):i=e}}),s.test(i))||(h=this.parent.createElement("div"),h.innerHTML=this.splitBreakLine(i),i=h.innerHTML)):i.length>0&&this.parent.formatter.editorManager.observer.notify(na,{args:n.args,text:n.text,allowedStylePropertiesArray:this.parent.pasteCleanupSettings.allowedStyleProps,callBack:function(n){i=n.trim()}}),this.contentRenderer=this.renderFactory.getRenderer(f.Content),c=this.contentRenderer.getDocument(),a=this.nodeSelectionObj.getRange(c),(this.saveSelection=this.nodeSelectionObj.save(a,c),this.parent.trigger(sy,{value:i},function(n){i=n.value}),this.parent.pasteCleanupSettings.prompt)?(n.args.preventDefault(),u=this.parent.createElement("div"),u.innerHTML=i,""===u.textContent&&t.isNullOrUndefined(u.querySelector("img"))&&t.isNullOrUndefined(u.querySelector("table"))||this.pasteDialog(i,r)):this.parent.pasteCleanupSettings.plainText?(n.args.preventDefault(),this.plainFormatting(i,r)):this.parent.pasteCleanupSettings.keepFormat?(n.args.preventDefault(),this.formatting(i,!1,r)):(n.args.preventDefault(),this.formatting(i,!0,r)))},n.prototype.splitBreakLine=function(n){for(var i=n.split("\n"),r="",t=0;t<i.length;t++)r+=""===i[t].trim()?oh(this.parent):"<p>"+this.makeSpace(i[t]).trim()+"<\/p>";return r},n.prototype.makeSpace=function(n){for(var i="",u=!0,r=n.split(" "),t=0;t<r.length;t++)""===r[t].trim()?i+=u?"&nbsp;":" ":(u=!1,i+=r[t]+" ");return i},n.prototype.imgUploading=function(n){var r=n.querySelectorAll(".pasteContent_Img"),u,f;if(this.parent.insertImageSettings.saveUrl&&r.length>0){for(var e=[],o=[],s=[],i=0;i<r.length;i++)r[i].getAttribute("src").split(",")[0].indexOf("base64")>=0&&(e.push(r[i].getAttribute("src")),o.push(t.getUniqueID("rte_image")),s.push(r[i]));for(u=[],i=0;i<e.length;i++)u.push(this.base64ToFile(e[i],o[i]));for(i=0;i<u.length;i++)this.uploadMethod(u[i],s[i]);t.isNullOrUndefined(this.parent.insertImageSettings.path)&&"Blob"===this.parent.insertImageSettings.saveFormat&&this.getBlob(r)}else"Blob"===this.parent.insertImageSettings.saveFormat&&this.getBlob(r);for(f=n.querySelectorAll(".pasteContent_Img"),i=0;i<f.length;i++)f[i].classList.remove("pasteContent_Img"),""===f[i].getAttribute("class").trim()&&r[i].removeAttribute("class")},n.prototype.getBlob=function(n){for(var r,i=0;i<n.length;i++)!t.isNullOrUndefined(n[i].getAttribute("src"))&&n[i].getAttribute("src").split(",")[0].indexOf("base64")>=0&&(r=URL.createObjectURL(gf(n[i].getAttribute("src"))),n[i].setAttribute("src",r))},n.prototype.uploadMethod=function(n,i){var u=this,h=document.createElement("div"),s,o,c,l,f,e;document.body.appendChild(h);h.setAttribute("display","none");i.style.opacity="0.5";s=this.parent.createElement("div");this.parent.element.appendChild(s);var a=this.parent.createElement("input",{id:this.parent.element.id+"_upload",attrs:{type:"File",name:"UploadFiles"}}),v=this.parent.iframeSettings.enable?-50:-90,r=new ot.Popup(s,{relateTo:i,height:"85px",width:"300px",offsetY:v,content:a,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){u.parent.isBlur=!1;r.destroy();t.detach(r.element)}});r.element.style.display="none";t.addClass([r.element],[ys,gc]);l=n.size>1e6?300:100;setTimeout(function(){u.refreshPopup(i,r)},l);f=new st.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},cssClass:nl,dropArea:this.parent.inputElement,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),success:function(n){setTimeout(function(){u.popupClose(r,f,i,n)},900)},uploading:function(n){u.parent.isServerRendered||u.parent.trigger(gi,n,function(n){n.cancel?(t.isNullOrUndefined(i)||t.detach(i),t.isNullOrUndefined(r.element)||t.detach(r.element)):u.parent.inputElement.contentEditable="false"})},beforeUpload:function(n){u.parent.isServerRendered?((c=JSON.parse(JSON.stringify(n))).filesData=o,n.cancel=!0,u.parent.trigger(gi,c,function(n){n.cancel||(f.currentRequestHeader=n.currentRequest?n.currentRequest:f.currentRequestHeader,f.customFormDatas=n.customFormData&&n.customFormData.length>0?n.customFormData:f.customFormDatas,f.uploadFiles(o,null))})):u.parent.trigger(vo,n)},failure:function(n){setTimeout(function(){u.uploadFailure(i,f,r,n)},900)},canceling:function(){u.parent.inputElement.contentEditable="true";" "===i.nextSibling.textContent&&t.detach(i.nextSibling);t.detach(i);r.close()},selected:function(n){n.cancel=!0;u.parent.isServerRendered&&(o=n.filesData)},removing:function(){u.parent.inputElement.contentEditable="true";" "===i.nextSibling.textContent&&t.detach(i.nextSibling);t.detach(i);r.close()}});f.appendTo(r.element.childNodes[0]);e=[{name:n.name,rawFile:n,size:n.size,type:n.type,validationMessages:{minSize:"",maxSize:""},statusCode:"1"}];f.createFileList(e);f.filesData.push(e[0]);o=e;f.upload(e);r.element.getElementsByClassName("e-file-select-wrap")[0].style.display="none";t.detach(r.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap"))},n.prototype.uploadFailure=function(n,i,r,u){this.parent.inputElement.contentEditable="true";t.detach(n);r&&r.close();this.parent.trigger(lo,u);i.destroy()},n.prototype.popupClose=function(n,i,r,u){var f=this;this.parent.inputElement.contentEditable="true";u.element=r;this.parent.trigger(co,u,function(n){if(!t.isNullOrUndefined(f.parent.insertImageSettings.path)){var i=f.parent.insertImageSettings.path+n.file.name;r.src=i;r.setAttribute("alt",n.file.name)}});n.close();r.style.opacity="1";i.destroy()},n.prototype.refreshPopup=function(n,t){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(t.relateTo=this.parent.inputElement,t.offsetY=this.parent.iframeSettings.enable?-30:-65,t.element.style.display="block"):t&&(t.refreshPosition(n),t.element.style.display="block")},n.prototype.base64ToFile=function(n,i){for(var e,o=n.split(","),r=o[0].match(/:(.*?);/)[1].split("/")[1],s=atob(o[1]),u=s.length,f=new Uint8Array(u);u--;)f[u]=s.charCodeAt(u);return t.Browser.isIE||navigator.appVersion.indexOf("Edge")>-1?(e=new Blob([f],{type:r}),t.extend(e,{name:i+"."+(t.isNullOrUndefined(r)?"":r)}),e):new File([f],i+"."+(t.isNullOrUndefined(r)?"":r),{type:r})},n.prototype.imageFormatting=function(n,t){var u=this.parent.createElement("span"),i,r,e;u.appendChild(t.elements[0]);i=u.innerHTML;this.contentRenderer=this.renderFactory.getRenderer(f.Content);r=this.contentRenderer.getDocument();e=this.nodeSelectionObj.getRange(r);this.saveSelection=this.nodeSelectionObj.save(e,r);this.parent.pasteCleanupSettings.prompt?this.pasteDialog(i,n):this.parent.pasteCleanupSettings.plainText?this.plainFormatting(i,n):this.parent.pasteCleanupSettings.keepFormat?this.formatting(i,!1,n):this.formatting(i,!0,n)},n.prototype.radioRender=function(){var i=new er.RadioButton({label:this.i10n.getConstant("keepFormat"),name:"pasteOption",checked:!0}),r,n,u,t,f;i.isStringTemplate=!0;r=this.parent.element.querySelector("#keepFormating");i.appendTo(r);n=new er.RadioButton({label:this.i10n.getConstant("cleanFormat"),name:"pasteOption"});n.isStringTemplate=!0;u=this.parent.element.querySelector("#cleanFormat");n.appendTo(u);t=new er.RadioButton({label:this.i10n.getConstant("plainText"),name:"pasteOption"});t.isStringTemplate=!0;f=this.parent.element.querySelector("#plainTextFormat");t.appendTo(f)},n.prototype.selectFormatting=function(n,t,i,r){i?this.formatting(n,!1,t):r?this.formatting(n,!0,t):this.plainFormatting(n,t)},n.prototype.pasteDialog=function(n,t){var r=this,f=!1,e=this.parent.height,o={buttons:[{click:function(){var u,o,s;i.isDestroyed||(u=r.parent.element.querySelector("#keepFormating").checked,o=r.parent.element.querySelector("#cleanFormat").checked,i.hide(),r.parent.height=f?e:r.parent.height,f=!1,s=i,r.dialogRenderObj.close(s),i.destroy(),r.selectFormatting(n,t,u,o))},buttonModel:{isPrimary:!0,cssClass:"e-flat "+sp,content:this.i10n.getConstant("pasteDialogOk")}},{click:function(){if(!i.isDestroyed){i.hide();r.parent.height=f?e:r.parent.height;f=!1;var n=i;r.dialogRenderObj.close(n);i.destroy()}},buttonModel:{cssClass:"e-flat "+hp,content:this.i10n.getConstant("pasteDialogCancel")}}],header:this.i10n.getConstant("pasteFormat"),content:this.i10n.getConstant("pasteFormatContent")+'<br/><div><div style="padding-top:24px;"><input type="radio" class="'+fp+'" id="keepFormating"/><\/div><div style="padding-top:20px;"><input type="radio" class="'+ep+'" id="cleanFormat"/><\/div><div style="padding-top:20px;"><input type="radio" class="'+op+'" id="plainTextFormat"/><\/div><\/div>',target:this.parent.element,width:"300px",height:"265px",cssClass:cp,isModal:!0,visible:!1},i=this.dialogRenderObj.render(o),u=this.parent.element.querySelector("#"+this.parent.getID()+"_pasteCleanupDialog");null!==u&&""!==u.innerHTML&&this.destroyDialog(u);null===u&&(u=this.parent.createElement("div",{id:this.parent.getID()+"_pasteCleanupDialog"}),this.parent.element.appendChild(u));i.appendTo(u);this.radioRender();this.parent.element.offsetHeight<parseInt(i.height.split("px")[0],null)&&(this.parent.height=parseInt(i.height.split("px")[0],null)+40,f=!0);i.show()},n.prototype.destroyDialog=function(n){var u=this.parent.element.querySelector(".e-dlg-container"),r,i;for(t.detach(u),r=n.children.length,i=0;i<r;i++)t.detach(n.children[0])},n.prototype.formatting=function(n,i,r){var o=this,u=this.parent.createElement("div",{className:"pasteContent",styles:"display:inline;"}),e,f;for(this.isNotFromHtml&&this.containsHtml&&(n=this.splitBreakLine(n)),u.innerHTML=n,null!==this.parent.pasteCleanupSettings.deniedTags&&(u=this.deniedTags(u)),(i||null!==this.parent.pasteCleanupSettings.deniedAttrs)&&(u=this.deniedAttributes(u,i)),null!==this.parent.pasteCleanupSettings.allowedStyleProps&&(u=this.allowedStyle(u)),this.saveSelection.restore(),u.innerHTML=this.sanitizeHelper(u.innerHTML),e=u.querySelectorAll("img"),f=0;f<e.length;f++)e[f].classList.add("pasteContent_Img"),"auto"!==this.parent.insertImageSettings.width&&e[f].setAttribute("width",this.parent.insertImageSettings.width),"0"!==this.parent.insertImageSettings.minWidth&&0!==this.parent.insertImageSettings.minWidth&&(e[f].style.minWidth=this.parent.insertImageSettings.minWidth.toString()),null!==this.parent.insertImageSettings.maxWidth&&(e[f].style.maxWidth=this.parent.getInsertImgMaxWidth().toString()),"auto"!==this.parent.insertImageSettings.height&&e[f].setAttribute("height",this.parent.insertImageSettings.height),"0"!==this.parent.insertImageSettings.minHeight&&0!==this.parent.insertImageSettings.minHeight&&(e[f].style.minHeight=this.parent.insertImageSettings.minHeight.toString()),null!==this.parent.insertImageSettings.maxHeight&&(e[f].style.maxHeight=this.parent.insertImageSettings.maxHeight.toString());this.addTempClass(u);""===u.textContent&&t.isNullOrUndefined(u.querySelector("img"))&&t.isNullOrUndefined(u.querySelector("table"))||(this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",r,function(n){t.extend(r,{elements:n.elements,imageElements:n.imgElem},!0);o.parent.formatter.onSuccess(o.parent,r)},u),this.removeTempClass(),this.parent.notify(ti,{}),this.imgUploading(this.parent.inputElement),this.parent.iframeSettings.enable&&this.parent.updateValue())},n.prototype.addTempClass=function(n){for(var i=n.children,t=0;t<i.length;t++)i[t].classList.add("pasteContent_RTE")},n.prototype.removeTempClass=function(){for(var t=this.parent.inputElement.querySelectorAll(".pasteContent_RTE"),n=0;n<t.length;n++)t[n].classList.remove("pasteContent_RTE"),""===t[n].getAttribute("class")&&t[n].removeAttribute("class")},n.prototype.sanitizeHelper=function(n){return ll(n,this.parent)},n.prototype.plainFormatting=function(n,i){var s=this,r=this.parent.createElement("div",{className:"pasteContent",styles:"display:inline;"}),u,e;if(r.innerHTML=n,this.detachInlineElements(r),this.getTextContent(r),""!==r.textContent.trim()){if(!t.isNullOrUndefined(r.firstElementChild)&&"BR"!==r.firstElementChild.tagName&&(u=r.firstElementChild,!t.isNullOrUndefined(r.firstElementChild))){for(var o=this.parent.createElement("span"),f=0,h=0;f<u.childNodes.length;f++,h++)if("#text"===u.childNodes[f].nodeName)o.appendChild(u.childNodes[f]),r.insertBefore(o,r.firstElementChild),f--;else{if("#text"===u.childNodes[f].nodeName||0!==h)break;for(e=0;e<u.childNodes[f].childNodes.length;e++)o.appendChild(u.childNodes[f].childNodes[e]),r.insertBefore(o,r.firstElementChild),e--;f--}u.hasChildNodes()||t.detach(u)}this.removeEmptyElements(r);this.saveSelection.restore();r.innerHTML=this.sanitizeHelper(r.innerHTML);this.addTempClass(r);this.parent.formatter.editorManager.execCommand("inserthtml","pasteCleanup",i,function(n){t.extend(i,{elements:n.elements,imageElements:n.imgElem},!0);s.parent.formatter.onSuccess(s.parent,i)},r);this.removeTempClass()}else this.saveSelection.restore(),t.extend(i,{elements:[]},!0),this.parent.formatter.onSuccess(this.parent,i)},n.prototype.getTextContent=function(n){for(var u,i,s,o,h,f=0;f<this.blockNode.length;f++)for(u=n.querySelectorAll(this.blockNode[f]),i=0;i<u.length;i++){for(var e=void 0,r=0,l=0,c=void 0;r<u[i].childNodes.length;r++,l++)"DIV"===u[i].childNodes[r].nodeName||"P"===u[i].childNodes[r].nodeName||"#text"===u[i].childNodes[r].nodeName&&"&nbsp;"!==u[i].childNodes[r].nodeValue.replace(/\u00a0/g,"&nbsp;")&&""===u[i].childNodes[r].textContent.trim()?(e=u[i].childNodes[r].parentElement,u[i].childNodes[r].parentElement.parentElement.insertBefore(u[i].childNodes[r],u[i].childNodes[r].parentElement),r--):((e=u[i].childNodes[r].parentElement,"text"===c)?e.previousElementSibling.appendChild(u[i].childNodes[r]):(s=this.parent.createElement("div",{id:"newDiv"}),s.appendChild(u[i].childNodes[r]),e.parentElement.insertBefore(s,e)),r--,c="text");t.isNullOrUndefined(e)||t.detach(e)}for(o=n.querySelectorAll("*"),f=0;f<o.length;f++)for(h=o[f].attributes,i=0;i<h.length;i++)o[f].removeAttribute(h[i].name),i--},n.prototype.detachInlineElements=function(n){for(var u,i,e,r,f=0;f<this.inlineNode.length;f++)for(u=n.querySelectorAll(this.inlineNode[f]),i=0;i<u.length;i++){for(e=void 0,r=0;r<u[i].childNodes.length;r++)e=u[i].childNodes[r].parentElement,u[i].childNodes[r].parentElement.parentElement.insertBefore(u[i].childNodes[r],u[i].childNodes[r].parentElement),r--;t.isNullOrUndefined(e)||t.detach(e)}},n.prototype.findDetachEmptyElem=function(n){return t.isNullOrUndefined(n.parentElement)?null:""===n.parentElement.textContent.trim()&&"pasteContent"!==n.parentElement.getAttribute("class")?this.findDetachEmptyElem(n.parentElement):n},n.prototype.removeEmptyElements=function(n){for(var u,r=n.querySelectorAll(":empty"),i=0;i<r.length;i++)"BR"!==r[i].tagName&&(u=this.findDetachEmptyElem(r[i]),t.isNullOrUndefined(u)||t.detach(u))},n.prototype.tagGrouping=function(n){for(var u,t=n.slice(),r=Object.keys(ca),f=r.map(function(n){return ca[n]}),e=[],i=0;i<t.length;i++)if(t[i].split("[").length>1&&(t[i]=t[i].split("[")[0].trim()),r.indexOf(t[i])>-1)for(u=0;u<f[r.indexOf(t[i])].length;u++)t.indexOf(f[r.indexOf(t[i])][u])<0&&e.indexOf(f[r.indexOf(t[i])][u])<0&&e.push(f[r.indexOf(t[i])][u]);return n.concat(e)},n.prototype.attributesfilter=function(n){for(var e,o,s,t=0;t<n.length;t++)if(n[t].split("[").length>1){for(var r=n[t].split("[")[1].split("]")[0].split(","),u=[],f=[],i=0;i<r.length;i++)r[i].indexOf("!")<0?u.push(r[i].trim()):f.push(r[i].split("!")[1].trim());e=u.length>1?u.join("]["):u.join();o=f.length>1?f.join("]["):f.join();o.length>0?(s=""!==e?n[t].split("[")[0]+"["+e+"]":n[t].split("[")[0],n[t]=s+":not(["+o+"])"):n[t]=n[t].split("[")[0]+"["+e+"]"}return n},n.prototype.deniedTags=function(n){var u=t.isNullOrUndefined(this.parent.pasteCleanupSettings.deniedTags)?[]:this.parent.pasteCleanupSettings.deniedTags.slice(),f,r,i,e;for(u=this.attributesfilter(u),u=this.tagGrouping(u),f=0;f<u.length;f++)for(r=n.querySelectorAll(u[f]),i=r.length-1;i>=0;i--){for(e=r[i].parentNode;r[i].firstChild;)e.insertBefore(r[i].firstChild,r[i]);e.removeChild(r[i])}return n},n.prototype.deniedAttributes=function(n,i){var u=t.isNullOrUndefined(this.parent.pasteCleanupSettings.deniedAttrs)?[]:this.parent.pasteCleanupSettings.deniedAttrs.slice(),r,e,f;for(i&&u.push("style"),r=0;r<u.length;r++)for(e=n.querySelectorAll("["+u[r]+"]"),f=0;f<e.length;f++)e[f].removeAttribute(u[r]);return n},n.prototype.allowedStyle=function(n){var o=t.isNullOrUndefined(this.parent.pasteCleanupSettings.allowedStyleProps)?[]:this.parent.pasteCleanupSettings.allowedStyleProps.slice(),r,i;for(o.push("list-style-type","list-style"),r=n.querySelectorAll("[style]"),i=0;i<r.length;i++){for(var s,u=[],e=r[i].getAttribute("style").split(";"),f=0;f<e.length;f++)o.indexOf(e[f].split(":")[0].trim())>=0&&u.push(e[f]);r[i].removeAttribute("style");(s=""===u.join(";").trim()?u.join(";"):u.join(";")+";")&&r[i].setAttribute("style",s)}return n},n.prototype.getModuleName=function(){return"pasteCleanup"},n}();gb=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(c,this.renderResizable,this),this.parent.on(u,this.destroy,this))},n.prototype.renderResizable=function(){this.resizer=this.parent.createElement("div",{id:this.parent.getID()+"-resizable",className:"e-icons "+dc+" "+lp});this.parent.element.classList.add(tl);this.parent.element.appendChild(this.resizer);this.touchStartEvent="msie"===t.Browser.info.name?"pointerdown":"touchstart";t.EventHandler.add(this.resizer,"mousedown",this.resizeStart,this);t.EventHandler.add(this.resizer,this.touchStartEvent,this.resizeStart,this)},n.prototype.resizeStart=function(n){var i=this,t;n.cancelable&&n.preventDefault();this.wireResizeEvents();this.parent.notify(yo,{});t={event:n,requestType:"editor"};this.parent.trigger(ve,t,function(n){n.cancel&&i.unwireResizeEvents()})},n.prototype.performResize=function(n){var u=this,f={event:n,requestType:"editor"},i,r;this.parent.trigger(ye,f,function(n){n.cancel&&u.unwireResizeEvents()});i=this.parent.element.getBoundingClientRect();this.isMouseEvent(n)?(this.parent.element.style.height=n.clientY-i.top+"px",this.parent.element.style.width=n.clientX-i.left+"px"):(r="msie"!==t.Browser.info.name?n.touches[0]:n,this.parent.element.style.height=r.clientY-i.top+"px",this.parent.element.style.width=r.clientX-i.left+"px");this.parent.toolbarSettings.enable||this.parent.setContentHeight("",!1);this.parent.refreshUI()},n.prototype.stopResize=function(n){this.parent.refreshUI();this.unwireResizeEvents();var t={event:n,requestType:"editor"};this.parent.trigger(pe,t)},n.prototype.getEventType=function(n){return n.indexOf("mouse")>-1?"mouse":"touch"},n.prototype.isMouseEvent=function(n){var i=!1;return("mouse"===this.getEventType(n.type)||!t.isNullOrUndefined(n.pointerType)&&"mouse"===this.getEventType(n.pointerType))&&(i=!0),i},n.prototype.wireResizeEvents=function(){t.EventHandler.add(document,"mousemove",this.performResize,this);t.EventHandler.add(document,"mouseup",this.stopResize,this);this.touchMoveEvent="msie"===t.Browser.info.name?"pointermove":"touchmove";this.touchEndEvent="msie"===t.Browser.info.name?"pointerup":"touchend";t.EventHandler.add(document,this.touchMoveEvent,this.performResize,this);t.EventHandler.add(document,this.touchEndEvent,this.stopResize,this)},n.prototype.unwireResizeEvents=function(){t.EventHandler.remove(document,"mousemove",this.performResize);t.EventHandler.remove(document,"mouseup",this.stopResize);t.EventHandler.remove(document,this.touchMoveEvent,this.performResize);t.EventHandler.remove(document,this.touchEndEvent,this.stopResize)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(c,this.renderResizable),this.parent.element.classList.remove(tl),t.EventHandler.remove(this.resizer,"mousedown",this.resizeStart),t.EventHandler.remove(this.resizer,this.touchStartEvent,this.resizeStart),this.resizer&&t.detach(this.resizer),this.parent.off(u,this.destroy))},n.prototype.getModuleName=function(){return"resize"},n}();const rt=ejdashboard.filemanager;nk=function(){function n(n,t){rt.FileManager.Inject(rt.ContextMenu,rt.DetailsView,rt.NavigationPane,rt.Toolbar);this.parent=n;this.i10n=t.getService("rteLocale");this.dialogRenderObj=t.getService("dialogRenderObject");this.rendererFactory=t.getService("rendererFactory");this.addEventListener()}return n.prototype.initialize=function(){this.parent.fileManagerModule=this;this.contentModule=this.rendererFactory.getRenderer(f.Content)},n.prototype.render=function(n){var u,i=this,f,e,r,o;u=n.selectNode&&"IMG"===n.selectNode[0].nodeName?this.parent.localeObj.getConstant("dialogUpdate"):this.i10n.getConstant("dialogInsert");f=this.parent.localeObj.getConstant("fileDialogHeader");e=this.i10n.getConstant("dialogCancel");this.dlgButtons=[{click:this.insertImageUrl.bind(this),buttonModel:{content:u,cssClass:"e-flat e-insertImage",isPrimary:!0}},{click:function(){i.cancelDialog()},buttonModel:{cssClass:"e-flat e-cancel",content:e}}];this.dlgButtons[0].buttonModel.disabled=!0;this.selectObj={selection:n.selection,args:n.args,selectParent:n.selectParent};r=this.parent.createElement("div",{className:"e-rte-file-manager-dialog",id:this.parent.getID()+"_file-manager-dialog",attrs:{"aria-owns":this.parent.getID()}});document.body.appendChild(r);this.fileWrap=this.parent.createElement("div",{id:this.parent.getID()+"_rte-file-manager",className:"e-img-file-wrap"});r.appendChild(this.fileWrap);r.appendChild(this.getInputUrlElement());o={visible:!1,isModal:!0,header:f,target:document.body,locale:this.parent.locale,enableRtl:this.parent.enableRtl,cssClass:v,animationSettings:{effect:"None"},showCloseIcon:!0,closeOnEscape:!0,width:"720px",height:"auto",position:{X:"center",Y:"center"},buttons:this.dlgButtons,created:this.renderFileManager.bind(this),close:function(n){i.parent.isBlur=!1;n&&n.event.returnValue&&i.selectObj.selection.restore();i.destroyComponents();i.dialogRenderObj.close(n)}};this.dialogObj=this.dialogRenderObj.render(o);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(r);this.dialogObj.show(!!t.Browser.isDevice)},n.prototype.renderFileManager=function(){var n=this,i=this;this.fileObj=new rt.FileManager({allowMultiSelection:!1,locale:this.parent.locale,enableRtl:this.parent.enableRtl,path:this.parent.fileManagerSettings.path,view:this.parent.fileManagerSettings.view,enablePersistence:this.parent.enablePersistence,cssClass:this.parent.fileManagerSettings.cssClass,sortOrder:this.parent.fileManagerSettings.sortOrder,ajaxSettings:this.parent.fileManagerSettings.ajaxSettings,showThumbnail:this.parent.fileManagerSettings.showThumbnail,rootAliasName:this.parent.fileManagerSettings.rootAliasName,uploadSettings:this.parent.fileManagerSettings.uploadSettings,searchSettings:this.parent.fileManagerSettings.searchSettings,toolbarSettings:this.parent.fileManagerSettings.toolbarSettings,showHiddenItems:this.parent.fileManagerSettings.showHiddenItems,allowDragAndDrop:this.parent.fileManagerSettings.allowDragAndDrop,showFileExtension:this.parent.fileManagerSettings.showFileExtension,detailsViewSettings:this.parent.fileManagerSettings.detailsViewSettings,contextMenuSettings:this.parent.fileManagerSettings.contextMenuSettings,navigationPaneSettings:this.parent.fileManagerSettings.navigationPaneSettings,fileSelect:function(t){var r=t.fileDetails;r.isFile&&i.parent.insertImageSettings.allowedTypes.indexOf(r.type)>-1?(i.inputUrl.value=i.parent.fileManagerSettings.ajaxSettings.getImageUrl+"?path="+(r.filterPath&&r.filterPath.replace(/\\/g,"/"))+r.name,n.dlgButtons[0].buttonModel.disabled=!1):(i.inputUrl.value="",n.dlgButtons[0].buttonModel.disabled=!0);n.dialogObj.buttons=n.dlgButtons},created:function(){n.inputUrl.removeAttribute("disabled")},success:function(){n.fileObj.refreshLayout()}});t.Browser.isDevice&&(this.fileObj.height="85%");this.fileObj.appendTo(this.fileWrap);t.EventHandler.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this)},n.prototype.getInputUrlElement=function(){var n=this.parent.createElement("div",{className:"imgUrl"}),t=this.parent.createElement("div",{className:"e-rte-label"}),i;return t.innerHTML='<label for="rteSample_img_url">'+this.i10n.getConstant("linkWebUrl")+"<\/label>",n.appendChild(t),i=this.i10n.getConstant("imageUrl"),this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url",attrs:{placeholder:i,spellcheck:"false",disabled:"true"}}),n.appendChild(this.inputUrl),n},n.prototype.insertImageUrl=function(){var n=this.inputUrl.value,i;if(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),""!==n){"HTML"===this.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selectObj.selection.range.startContainer.parentNode,"#"+this.contentModule.getPanel().id))&&(this.contentModule.getEditPanel().focus(),i=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),this.selectObj.selection=this.parent.formatter.editorManager.nodeSelection.save(i,this.contentModule.getDocument()),this.selectObj.selectParent=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i));var r=/[\w-]+.(jpg|png|jpeg|gif)/g,u=t.isNullOrUndefined(n.match(r))||"HTML"!==this.parent.editorMode?"":n.match(r)[0],f={cssClass:"inline"===this.parent.insertImageSettings.display?vt:ei,url:n,selection:this.selectObj.selection,altText:u,selectParent:this.selectObj.selectParent,width:{width:this.parent.insertImageSettings.width,minWidth:this.parent.insertImageSettings.minWidth,maxWidth:this.parent.getInsertImgMaxWidth()},height:{height:this.parent.insertImageSettings.height,minHeight:this.parent.insertImageSettings.minHeight,maxHeight:this.parent.insertImageSettings.maxHeight}};this.parent.formatter.process(this.parent,this.selectObj.args,this.selectObj.args.originalEvent,f);this.dialogObj.hide({returnValue:!1})}},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0})},n.prototype.onDocumentClick=function(n){var i=n.target,r="#document"!==i.nodeName&&!t.isNullOrUndefined(i.previousElementSibling)&&i.previousElementSibling;t.isNullOrUndefined(this.dialogObj)||t.closest(i,"#"+this.parent.getID()+"_file-manager-dialog")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_tb_sortby-popup")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_tb_view-popup")||t.closest(i,"#"+this.parent.getID()+"_rte-file-manager_contextmenu")||!t.isNullOrUndefined(t.closest(i,".e-contextmenu-wrapper"))&&t.closest(i,".e-contextmenu-wrapper").querySelector("#"+this.parent.getID()+"_rte-file-manager_contextmenu")||t.isNullOrUndefined(r)||r.classList.contains("e-rte-file-manager-dialog")||t.isNullOrUndefined(r)||r.id===this.parent.getID()+"_rte-file-manager_contextmenu"?this.parent.isRTE=!0:(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,ir(this.parent.element,"focusout"))},n.prototype.addEventListener=function(){this.parent.on(c,this.initialize,this);this.parent.on(of,this.render,this);this.parent.on(u,this.destroy,this)},n.prototype.removeEventListener=function(){t.EventHandler.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick);this.parent.off(c,this.initialize);this.parent.off(of,this.render);this.parent.off(u,this.destroy)},n.prototype.destroyComponents=function(){this.fileObj&&(this.fileObj.destroy(),this.fileObj=null);this.dialogObj&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.destroy=function(){this.parent.isDestroyed||(this.destroyComponents(),this.removeEventListener())},n.prototype.getModuleName=function(){return"fileManager"},n}();av=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.showFullScreen=function(n){var i=this,r;(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||t.isNullOrUndefined(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.scrollableParent=ot.getScrollableParent(this.parent.element),this.parent.element.classList.contains(uu))||(r={cancel:!1,requestType:"Maximize",targetItem:"Maximize",args:n},this.parent.trigger(k,r,function(r){r.cancel||(i.parent.toolbarSettings.enableFloating&&!i.parent.inlineMode.enable&&i.parent.toolbarSettings.enable&&(i.parent.getToolbarElement().style.width="100%",i.parent.getToolbarElement().style.top="0px"),i.parent.element.classList.add(uu),i.toggleParentOverflow(!0),i.parent.setContentHeight(),i.parent.toolbarModule&&(i.parent.getBaseToolbarObject().toolbarObj.items[0].properties||i.parent.getBaseToolbarObject().toolbarObj.removeItems(0),t.Browser.isDevice&&i.parent.toolbarModule.removeFixedTBarClass(),i.parent.toolbarModule.updateItem({targetItem:"Maximize",updateItem:"Minimize",baseToolbar:i.parent.getBaseToolbarObject()})),i.parent.trigger(ft,{requestType:"Maximize",targetItem:"Maximize",args:n}))}))},n.prototype.hideFullScreen=function(n){var i=this,r;(!0!==this.parent.toolbarSettings.enable||"Markdown"===this.parent.editorMode||t.isNullOrUndefined(this.parent.quickToolbarModule)||this.parent.quickToolbarModule.hideQuickToolbars(),this.parent.element.classList.contains(uu))&&(r={cancel:!1,requestType:"Minimize",targetItem:"Minimize",args:n},this.parent.trigger(k,r,function(r){if(!r.cancel){i.parent.element.classList.remove(uu);for(var f=document.querySelectorAll(".e-rte-overflow"),u=0;u<f.length;u++)t.removeClass([f[u]],["e-rte-overflow"]);i.parent.setContentHeight();i.parent.toolbarModule&&(i.parent.getBaseToolbarObject().toolbarObj.items[0].properties||i.parent.getBaseToolbarObject().toolbarObj.removeItems(0),i.parent.toolbarModule.updateItem({targetItem:"Minimize",updateItem:"Maximize",baseToolbar:i.parent.getBaseToolbarObject()}),t.Browser.isDevice&&i.parent.inlineMode.enable&&i.parent.toolbarModule.addFixedTBarClass());i.parent.trigger(ft,{requestType:"Minimize",targetItem:"Minimize",args:n})}}))},n.prototype.toggleParentOverflow=function(){var n,i;if(!t.isNullOrUndefined(this.scrollableParent))for(n=0;n<this.scrollableParent.length;n++)"#document"===this.scrollableParent[n].nodeName?(i=document.querySelector("body"),t.addClass([i],["e-rte-overflow"])):(i=this.scrollableParent[n],t.addClass([i],["e-rte-overflow"]))},n.prototype.onKeyDown=function(n){var t=n.args;switch(t.action){case"full-screen":this.showFullScreen(n.args);t.preventDefault();break;case"escape":this.hideFullScreen(n.args);t.preventDefault()}},n.prototype.addEventListener=function(){this.parent.on(p,this.onKeyDown,this);this.parent.on(u,this.destroy,this)},n.prototype.removeEventListener=function(){this.parent.off(p,this.onKeyDown);this.parent.off(u,this.destroy)},n.prototype.destroy=function(){this.parent.element.classList.contains(uu)&&this.toggleParentOverflow(!1);for(var i=document.querySelectorAll(".e-rte-overflow"),n=0;n<i.length;n++)t.removeClass([i[n]],["e-rte-overflow"]);this.removeEventListener()},n}();var tk=function(){function n(n,t){this.parent=n;this.locator=t;this.renderer=this.locator.getService("rendererFactory");this.addEventListener()}return n.prototype.render=function(){this.parent;this.contentRenderer=this.renderer.getRenderer(f.Content);this.contentRenderer.renderPanel()},n.prototype.refresh=function(n){void 0===n&&(n={requestType:"refresh"});this.parent.notify(n.requestType+"-begin",n)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(a,this.refresh,this),this.parent.on(ct,this.keyUp,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(a,this.refresh),this.parent.off(ct,this.keyUp))},n.prototype.keyUp=function(n){var t,i;if("HTML"===this.parent.editorMode)switch(n.args.which){case 46:case 8:t=this.parent.contentModule.getEditPanel().childNodes;(0===t.length||1===t.length&&0===t[0].childNodes.length&&("BR"===t[0].tagName||("P"===t[0].tagName||"DIV"===t[0].tagName)&&""===t[0].textContent))&&(i=this.parent.contentModule.getEditPanel(),i.innerHTML="DIV"===this.parent.enterKey?"<div><br/><\/div>":"BR"===this.parent.enterKey?"<br/>":"<p><br/><\/p>",this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),i.childNodes[0],0))}},n}(),fn=function(){function n(n,t){this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.addEventListener();this.serviceLocator=t;this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject")}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(rf,this.linkDialog,this),this.parent.on(po,this.showDialog,this),this.parent.on(wo,this.closeDialog,this),this.parent.on(p,this.onKeyDown,this),this.parent.on(vr,this.showLinkQuickToolbar,this),this.parent.on(ai,this.clearDialogObj,this),this.parent.on(le,this.onToolbarAction,this),this.parent.on(ni,this.onIframeMouseDown,this),this.parent.on(uf,this.removeLink,this),this.parent.on(we,this.editLink,this),this.parent.on(be,this.openLink,this),this.parent.on(ui,this.editAreaClickHandler,this),this.parent.on(u,this.destroy,this))},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"OpenLink":this.parent.notify(be,n);break;case"EditLink":this.parent.notify(we,n);break;case"RemoveLink":this.parent.notify(uf,n)}},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(rf,this.linkDialog),this.parent.off(po,this.showDialog),this.parent.off(wo,this.closeDialog),this.parent.off(p,this.onKeyDown),this.parent.off(vr,this.showLinkQuickToolbar),this.parent.off(ai,this.clearDialogObj),this.parent.off(le,this.onToolbarAction),this.parent.off(uf,this.removeLink),this.parent.off(ni,this.onIframeMouseDown),this.parent.off(we,this.editLink),this.parent.off(be,this.openLink),this.parent.off(ui,this.editAreaClickHandler),this.parent.off(u,this.destroy))},n.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.showLinkQuickToolbar=function(n){var r,u,i;if(!t.isNullOrUndefined(n.args)&&"enter"!==n.args.action&&"space"!==n.args.action){if(r=void 0,u=void 0,"Links"!==n.type||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.linkQTBar))return;this.quickToolObj=this.parent.quickToolbarModule;var f,e=this.parent.element.getBoundingClientRect().top,o=this.parent.element.getBoundingClientRect().left,c=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());if([].forEach.call(n.elements,function(n,t){0===t&&(f="#text"===n.nodeName?n.parentNode:n)}),n.isNotify){var s=this.parent.toolbarModule.getToolbarElement(),h=f.getBoundingClientRect().top,l=f.getBoundingClientRect().left,a=h-e,v=s?s.offsetHeight+this.parent.toolbarModule.getExpandTBarPopHeight():0;r=this.parent.iframeSettings.enable?o+l:f.getBoundingClientRect().left;u=window.pageYOffset+(this.parent.iframeSettings.enable?e+v+h:e+a)}else i=void 0,i=n.args.touches?n.args.changedTouches[0]:i=n.args,r=this.parent.iframeSettings.enable?window.pageXOffset+o+i.clientX:i.pageX,u=this.parent.iframeSettings.enable?window.pageYOffset+e+i.clientY:i.pageY;this.quickToolObj.linkQTBar&&this.quickToolObj.linkQTBar.showPopup(r,u,c.endContainer)}},n.prototype.hideLinkQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.linkQTBar&&document.body.contains(this.quickToolObj.linkQTBar.element)&&this.quickToolObj.linkQTBar.hidePopup()},n.prototype.editAreaClickHandler=function(n){var i,u,r,e;if(this.parent.readonly)this.hideLinkQuickToolbar();else if(i=n.args,u=this.parent.quickToolbarSettings.showOnRightClick,!(2===i.which||u&&1===i.which||!u&&3===i.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.linkQTBar)if(this.quickToolObj=this.parent.quickToolbarModule,r=i.target,r=this.getAnchorNode(r),this.contentModule=this.rendererFactory.getRenderer(f.Content),e=this.quickToolObj.linkQTBar.element.classList.contains("e-rte-pop"),"A"===r.nodeName&&r.childNodes.length>0&&"IMG"!==r.childNodes[0].nodeName&&"IMG"!==n.args.target.nodeName&&!t.isNullOrUndefined(t.closest(this.parent.getRange().startContainer.parentElement,"A"))&&!t.isNullOrUndefined(t.closest(this.parent.getRange().endContainer.parentElement,"A"))){if(e)return;this.showLinkQuickToolbar({args:i,isNotify:!1,type:"Links",elements:[i.target]})}else this.hideLinkQuickToolbar()},n.prototype.onKeyDown=function(n){var i=n.args;switch(i.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"insert-link":this.openDialog(!0,n);i.preventDefault()}},n.prototype.openDialog=function(n,t){var r;if(n||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),u=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),o={args:t?t.args:{item:{command:"Links",subCommand:"CreateLink"},originalEvent:void 0},selectNode:f,selection:u,selectParent:e};this.linkDialog(o)}else r=this.parent.contentModule.getEditPanel(),this.parent.formatter.editorManager.markdownSelection.save(r.selectionStart,r.selectionEnd),this.linkDialog({args:{item:{command:"Links",subCommand:"Link"},originalEvent:t&&t.args},member:"link",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertLink"})},n.prototype.showDialog=function(){this.openDialog(!1)},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.linkDialog=function(n,i){var r=this,u,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else if("HTML"===this.parent.editorMode&&n.selectParent.length>0&&!t.isNullOrUndefined(n.selectParent[0].classList)&&n.selectParent[0].classList.contains("e-rte-anchor")&&t.isNullOrUndefined(i))this.editLink(n);else{var c=this.i10n.getConstant("linkWebUrl"),l=this.i10n.getConstant("linkText"),a=this.i10n.getConstant("linkTooltipLabel"),y=this.i10n.getConstant("linkurl"),p=this.i10n.getConstant("textPlaceholder"),w=this.i10n.getConstant("linkTitle"),f=this.parent.createElement("div",{className:"e-rte-link-dialog",id:this.rteID+"_rtelink"});this.parent.element.appendChild(f);u=this.parent.createElement("div",{className:"e-rte-linkcontent",id:this.rteID+"_linkContent"});o=pi('<div class="e-rte-label"><label>'+c+'<\/label><\/div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder="'+y+'" class="e-input e-rte-linkurl"/><\/div><div class="e-rte-label"><label>'+l+'<\/label><\/div><div class="e-rte-field"> <input type="text" data-role ="none" spellcheck="false" class="e-input e-rte-linkText" placeholder="'+p+'"><\/div><div class="e-rte-label">'+("HTML"===this.parent.editorMode?"<label>"+a+'<\/label><\/div><div class="e-rte-field"><input type="text" data-role ="none" spellcheck="false" placeholder = "'+w+'" class="e-input e-rte-linkTitle"><\/div><div class="e-rte-label"><\/div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"><\/div>':""));u.appendChild(o);var b=u.querySelector(".e-rte-linkTarget"),k=u.querySelector(".e-rte-linkurl"),s=u.querySelector(".e-rte-linkText"),d=u.querySelector(".e-rte-linkTitle"),g=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new er.CheckBox({label:g,checked:!0,enableRtl:this.parent.enableRtl});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(b);var e="HTML"===this.parent.editorMode?n.selection.getRange(this.parent.contentModule.getDocument()).toString():n.text,nt=this.i10n.getConstant("dialogInsert"),tt=this.i10n.getConstant("dialogCancel"),it=n.selection,h={selfLink:this,selection:n.selection,selectParent:n.selectParent,args:n.args},rt={header:this.i10n.getConstant("linkHeader"),content:u,cssClass:v,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"310px",height:"inherit",isModal:t.Browser.isDevice,buttons:[{click:this.insertlink.bind(h),buttonModel:{content:nt,cssClass:"e-flat e-insertLink",isPrimary:!0}},{click:this.cancelDialog.bind(h),buttonModel:{cssClass:"e-flat",content:tt}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){r.parent.isBlur=!1;n&&n.event.returnValue&&("HTML"===r.parent.editorMode?it.restore():r.parent.formatter.editorManager.markdownSelection.restore(r.parent.contentModule.getEditPanel()));r.dialogObj.destroy();t.detach(r.dialogObj.element);var i=r.dialogObj;r.dialogRenderObj.close(i);r.dialogObj=null}};this.dialogObj=this.dialogRenderObj.render(rt);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(f);f.style.maxHeight="inherit";t.isNullOrUndefined(this.dialogObj)||(t.isNullOrUndefined(i)||(k.value=i.url,s.value=i.text,d.value=i.title,this.checkBoxObj.checked=i.target?!0:!1,this.dialogObj.header=i.header,this.dialogObj.element.querySelector(".e-insertLink").textContent=i.btnText),this.checkUrl(!1),("HTML"===this.parent.editorMode&&t.isNullOrUndefined(i)&&(!t.isNullOrUndefined(e)&&""!==e&&0===n.selection.range.startOffset||n.selection.range.startOffset!==n.selection.range.endOffset)||"Markdown"===n.module)&&(s.value=e),t.EventHandler.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),this.quickToolObj&&(this.hideLinkQuickToolbar(),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()))}},n.prototype.insertlink=function(){var s,u=this.selfLink.dialogObj.element,i=u.querySelector(".e-rte-linkurl").value,r=u.querySelector(".e-rte-linkText").value,h,n,f,e,c,o;"HTML"===this.selfLink.parent.editorMode&&(s=u.querySelector(".e-rte-linkTitle").value);h=this.selfLink.checkBoxObj.checked?"_blank":null;""!==i?(this.selfLink.isUrl(i)?this.selfLink.checkUrl(!1):(r=""===r?i:r,this.selfLink.parent.enableAutoUrl||(i=i.indexOf("http")>-1?i:"http://"+i)),n=this.selfLink,"HTML"===n.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selection.range.startContainer.parentNode,"[id='"+n.parent.contentModule.getPanel().id+"']"))&&(n.parent.contentModule.getEditPanel().focus(),t.Browser.isIE&&n.parent.iframeSettings.enable&&this.selection.restore(),f=n.parent.formatter.editorManager.nodeSelection.getRange(n.parent.contentModule.getDocument()),this.selection=n.parent.formatter.editorManager.nodeSelection.save(f,n.parent.contentModule.getDocument()),this.selectParent=n.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(f)),c={url:i,text:r,title:s,target:h,selection:this.selection,selectParent:this.selectParent},(document.body.contains(n.dialogObj.element)&&this.selfLink.dialogObj.hide({returnValue:!1}),d()&&n.parent.iframeSettings.enable&&t.select("iframe",n.parent.element).contentWindow.focus(),"HTML"===n.parent.editorMode&&this.selection.restore(),0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),t.isNullOrUndefined(this.args)||"KeyK"!==this.args.code)?e=this.args:(o=this.args,t.extend(this.args,{item:{command:"Links",subCommand:"CreateLink"},originalEvent:o},!0),e={item:{command:"Links",subCommand:"CreateLink"},originalEvent:o}),this.selfLink.parent.formatter.process(this.selfLink.parent,e,!t.isNullOrUndefined(this.args)&&this.args.originalEvent,c),this.selfLink.parent.contentModule.getEditPanel().focus()):this.selfLink.checkUrl(!0)},n.prototype.isUrl=function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(n)},n.prototype.checkUrl=function(n){var i=this.dialogObj.element.querySelector(".e-rte-linkurl");n?(t.addClass([i],"e-error"),i.setSelectionRange(0,i.value.length),i.focus()):t.removeClass([i],"e-error")},n.prototype.removeLink=function(n){0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,selectParent:n.selectParent,selection:n.selection,subCommand:n.args.item.subCommand});d()&&this.parent.iframeSettings.enable?t.select("iframe",this.parent.element).contentWindow.focus():this.parent.contentModule.getEditPanel().focus();this.hideLinkQuickToolbar()},n.prototype.openLink=function(n){var t=this.getAnchorNode(n.selectParent[0]);(t.classList.contains("e-rte-anchor")||"A"===t.tagName)&&this.parent.formatter.process(this.parent,n.args,n.args,{url:t.href,target:""===t.target?"_self":"_blank",selectNode:n.selectNode,subCommand:n.args.item.subCommand})},n.prototype.getAnchorNode=function(n){return t.closest(n,"a")||n},n.prototype.editLink=function(n){var i=this.getAnchorNode(n.selectNode[0]),t=this.getAnchorNode(n.selectParent[0]),r,u;((t="A"===i.nodeName?i:t).classList.contains("e-rte-anchor")||"A"===t.tagName)&&(r=this.i10n.getConstant("dialogUpdate"),u={url:t.getAttribute("href"),text:t.innerText,title:t.title,target:t.target,header:this.i10n.getConstant("editLink"),btnText:r},this.linkDialog(n,u))},n.prototype.cancelDialog=function(){this.selfLink.parent.isBlur=!1;this.selfLink.dialogObj.hide({returnValue:!0});d()?this.selection.restore():this.selfLink.parent.contentModule.getEditPanel().focus()},n.prototype.onDocumentClick=function(n){var i=n.target;t.isNullOrUndefined(this.dialogObj)||(t.closest(i,"[id='"+this.dialogObj.element.id+"']")||!this.parent.toolbarSettings.enable||!this.parent.getToolbarElement()||this.parent.getToolbarElement().contains(n.target))&&(!(this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)||this.parent.inlineMode.enable&&!t.closest(i,"#"+this.dialogObj.element.id))||t.closest(i,"#"+this.parent.getID()+"_toolbar_CreateLink")||i.querySelector("#"+this.parent.getID()+"_toolbar_CreateLink"))||(this.dialogObj.hide({returnValue:!0}),t.EventHandler.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),this.parent.isBlur=!0,ir(this.parent.element,"focusout"))},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.getModuleName=function(){return"link"},n}(),en=function(){function n(n,t){this.isImgUploaded=!1;this.isAllowedTypes=!0;this.pageX=null;this.pageY=null;this.deletedImg=[];this.parent=n;this.rteID=n.element.id;this.i10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(p,this.onKeyDown,this),this.parent.on(ct,this.onKeyUp,this),this.parent.on(ar,this.insertImage,this),this.parent.on(bo,this.showDialog,this),this.parent.on(ko,this.closeDialog,this),this.parent.on(ae,this.onWindowResize,this),this.parent.on(vr,this.showImageQuickToolbar,this),this.parent.on(ai,this.clearDialogObj,this),this.parent.on(ce,this.onToolbarAction,this),this.parent.on(no,this.caption,this),this.parent.on(ge,this.deleteImg,this),this.parent.on(ke,this.insertImgLink,this),this.parent.on(de,this.insertAltText,this),this.parent.on(ui,this.editAreaClickHandler,this),this.parent.on(ni,this.onIframeMouseDown,this),this.parent.on(to,this.imageSize,this),this.parent.on(ci,this.alignmentSelect,this),this.parent.on(c,this.afterRender,this),this.parent.on(ru,this.afterRender,this),this.parent.on(di,this.imagePaste,this),this.parent.on(u,this.removeEventListener,this))},n.prototype.removeEventListener=function(){if(!this.parent.isDestroyed){this.parent.off(p,this.onKeyDown);this.parent.off(ct,this.onKeyUp);this.parent.off(ae,this.onWindowResize);this.parent.off(ar,this.insertImage);this.parent.off(bo,this.showDialog);this.parent.off(ko,this.closeDialog);this.parent.off(vr,this.showImageQuickToolbar);this.parent.off(ai,this.clearDialogObj);this.parent.off(no,this.caption);this.parent.off(ce,this.onToolbarAction);this.parent.off(ge,this.deleteImg);this.parent.off(ke,this.insertImgLink);this.parent.off(de,this.insertAltText);this.parent.off(ui,this.editAreaClickHandler);this.parent.off(ni,this.onIframeMouseDown);this.parent.off(to,this.imageSize);this.parent.off(ci,this.alignmentSelect);this.parent.off(c,this.afterRender);this.parent.off(ru,this.afterRender);this.parent.off(di,this.imagePaste);this.parent.off(u,this.removeEventListener);var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.removeEventListener("drop",this.dragDrop.bind(this),!0);n.removeEventListener("dragstart",this.dragStart.bind(this),!0);n.removeEventListener("dragenter",this.dragEnter.bind(this),!0);n.removeEventListener("dragover",this.dragOver.bind(this),!0);t.isNullOrUndefined(this.contentModule)||(t.EventHandler.remove(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.imageClick),this.parent.formatter.editorManager.observer.off(oo,this.undoStack),this.parent.insertImageSettings.resize&&(t.EventHandler.remove(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart),t.EventHandler.remove(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick),t.EventHandler.remove(this.contentModule.getEditPanel(),"cut",this.onCutHandler)))}},n.prototype.onIframeMouseDown=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.afterRender=function(){this.contentModule=this.rendererFactory.getRenderer(f.Content);t.EventHandler.add(this.contentModule.getEditPanel(),t.Browser.touchEndEvent,this.imageClick,this);this.parent.insertImageSettings.resize&&(t.EventHandler.add(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart,this),t.EventHandler.add(this.parent.element.ownerDocument,"mousedown",this.onDocumentClick,this),t.EventHandler.add(this.contentModule.getEditPanel(),"cut",this.onCutHandler,this));var n=this.parent.iframeSettings.enable?this.parent.inputElement.ownerDocument:this.parent.inputElement;n.addEventListener("drop",this.dragDrop.bind(this),!0);n.addEventListener("dragstart",this.dragStart.bind(this),!0);n.addEventListener("dragenter",this.dragOver.bind(this),!0);n.addEventListener("dragover",this.dragOver.bind(this),!0)},n.prototype.undoStack=function(n){var r,i,e,u,f;if("undo"===n.subCommand.toLowerCase()||"redo"===n.subCommand.toLowerCase())for(r=0;r<this.parent.formatter.getUndoRedoStack().length;r++)if(i=this.parent.createElement("div"),e=pi(this.parent.formatter.getUndoRedoStack()[r].text),i.appendChild(e),u=i.querySelectorAll("img"),i.querySelector(".e-img-resize")&&u.length>0){for(f=0;f<u.length;f++)u[f].style.outline="";t.detach(i.querySelector(".e-img-resize"));this.parent.formatter.getUndoRedoStack()[r].text=i.innerHTML}},n.prototype.resizeEnd=function(n){this.resizeBtnInit();this.imgEle.parentElement.style.cursor="auto";t.Browser.isDevice&&t.removeClass([n.target.parentElement],"e-mob-span");var i={event:n,requestType:"images"};this.parent.trigger(pe,i);this.getPointX(n);this.parent.iframeSettings.enable?(window.pageYOffset,this.parent.element.getBoundingClientRect().top,n.clientY):n.pageY;this.parent.formatter.editorManager.observer.on(oo,this.undoStack,this);this.parent.formatter.saveData()},n.prototype.resizeStart=function(n,i){var e=this,r,u,f;this.parent.readonly||(r=i||n.target,(this.prevSelectedImgEle=this.imgEle,"IMG"===r.tagName)&&(this.parent.preventDefaultResize(n),u=r,this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&t.detach(this.imgResizeDiv),this.imageResize(u)),r.classList.contains("e-rte-imageboxmark")&&((0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),n.preventDefault(),n.stopImmediatePropagation(),this.resizeBtnInit(),this.quickToolObj&&this.quickToolObj.imageQTBar.hidePopup(),r.classList.contains("e-rte-topLeft")&&(this.resizeBtnStat.topLeft=!0),r.classList.contains("e-rte-topRight")&&(this.resizeBtnStat.topRight=!0),r.classList.contains("e-rte-botLeft")&&(this.resizeBtnStat.botLeft=!0),r.classList.contains("e-rte-botRight")&&(this.resizeBtnStat.botRight=!0),t.Browser.isDevice&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&!this.imgResizeDiv.classList.contains("e-mob-span"))?t.addClass([this.imgResizeDiv],"e-mob-span"):(f={event:n,requestType:"images"},this.parent.trigger(ve,f,function(n){n.cancel&&e.cancelResizeAction()})),t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd,this)))},n.prototype.imageClick=function(n){t.Browser.isDevice&&("IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName||"IMG"===n.target.tagName?(this.contentModule.getEditPanel().setAttribute("contenteditable","false"),n.target.focus()):this.parent.readonly||this.contentModule.getEditPanel().setAttribute("contenteditable","true"));"IMG"===n.target.tagName&&"A"===n.target.parentElement.tagName&&n.preventDefault()},n.prototype.onCutHandler=function(){this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&this.cancelResizeAction()},n.prototype.imageResize=function(n){this.resizeBtnInit();this.imgEle=n;t.addClass([this.imgEle],"e-resize");this.imgResizeDiv=this.parent.createElement("span",{className:"e-img-resize",id:this.rteID+"_imgResize"});this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topLeft",styles:"cursor: nwse-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-topRight",styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botLeft",styles:"cursor: nesw-resize"}));this.imgResizeDiv.appendChild(this.parent.createElement("span",{className:"e-rte-imageboxmark e-rte-botRight",styles:"cursor: nwse-resize"}));t.Browser.isDevice&&t.addClass([this.imgResizeDiv],"e-mob-rte");n.style.outline="2px solid #4a90e2";this.imgResizePos(n,this.imgResizeDiv);this.resizeImgDupPos(n);this.contentModule.getEditPanel().appendChild(this.imgResizeDiv);t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing,this)},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.imgResizePos=function(n,i){var e=this.calcPos(n),u=e.top,f=e.left,o=n.width,s=n.height,r=t.Browser.isDevice?4*parseInt(n.style.outline.slice(-3),10)+2:2*parseInt(n.style.outline.slice(-3),10)+2,h=t.Browser.isDevice?0:2;i.querySelector(".e-rte-botLeft").style.left=f-r+"px";i.querySelector(".e-rte-botLeft").style.top=s-r+u+"px";i.querySelector(".e-rte-botRight").style.left=o-(r-h)+f+"px";i.querySelector(".e-rte-botRight").style.top=s-r+u+"px";i.querySelector(".e-rte-topRight").style.left=o-(r-h)+f+"px";i.querySelector(".e-rte-topRight").style.top=u-r+"px";i.querySelector(".e-rte-topLeft").style.left=f-r+"px";i.querySelector(".e-rte-topLeft").style.top=u-r+"px"},n.prototype.calcPos=function(n){for(var r=n.ownerDocument,i=(n.offsetParent&&(n.offsetParent.classList.contains("e-img-caption")||["TD","TH","TABLE","A"].indexOf(n.offsetParent.tagName)>-1)?t.closest(n,"#"+this.parent.getID()+"_rte-edit-view"):n.offsetParent)||r.documentElement;i&&(i===r.body||i===r.documentElement)&&"static"===i.style.position;)i=i.parentNode;return i&&i!==n&&1===i.nodeType&&i.getBoundingClientRect(),{top:n.offsetTop,left:n.offsetLeft}},n.prototype.setAspectRatio=function(n,i,r,u){var f,e,s,o;t.isNullOrUndefined(n.width)||(f=""!==n.style.width?n.style.width.match(/^\d+(\.\d*)?%$/g)?parseFloat(n.style.width):parseInt(n.style.width,10):n.width,e=""!==n.style.height?parseInt(n.style.height,10):n.height,f>e?(n.style.minWidth="20px",this.parent.insertImageSettings.resizeByPercent)?(0!==parseInt(""+n.getBoundingClientRect().width,10)&&0!==parseInt(""+f,10)?(s=this.pixToPerc(f/e*r,n.previousElementSibling||n.parentElement),n.style.width=Math.min(Math.round(s/n.getBoundingClientRect().width*i*100)/100,100)+"%"):n.style.width=this.pixToPerc(f/e*r,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""===n.style.width&&""!==n.style.height?n.style.height=r+"px":""!==n.style.width&&""===n.style.height?(o=f/e*r+f/e<this.parent.inputElement.getBoundingClientRect().right-32?f/e*r+f/e:this.parent.inputElement.getBoundingClientRect().right-32,n.style.width=o.toString()+"px"):""!==n.style.width?(o=f/e*r<this.parent.inputElement.getBoundingClientRect().right-32?f/e*r:this.parent.inputElement.getBoundingClientRect().right-32,n.style.width=o+"px",n.style.height=r+"px"):n.setAttribute("width",(f/e*r+f/e).toString()):e>f?this.parent.insertImageSettings.resizeByPercent?(n.style.width=0!==parseInt(""+n.getBoundingClientRect().width,10)&&0!==parseInt(""+f,10)?Math.min(Math.round(f/n.getBoundingClientRect().width*i*100)/100,100)+"%":this.pixToPerc(i/e*r,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""!==n.style.width?(n.style.width=i+"px",n.style.height=e/f*i+"px"):n.setAttribute("width",this.resizeBtnStat.botRight?(this.getPointX(u.event)-n.getBoundingClientRect().left).toString():i.toString()):this.parent.insertImageSettings.resizeByPercent?(n.style.width=this.pixToPerc(i,n.previousElementSibling||n.parentElement)+"%",n.style.height=null,n.removeAttribute("height")):""!==n.style.width?(n.style.width=i+"px",n.style.height=i+"px"):(n.setAttribute("width",i.toString()),n.setAttribute("height",i.toString())))},n.prototype.pixToPerc=function(n,t){return n/parseFloat(getComputedStyle(t).width)*100},n.prototype.imgDupMouseMove=function(n,i,r){var u=this,f={event:r,requestType:"images"};this.parent.trigger(ye,f,function(r){if(r.cancel)u.cancelResizeAction();else{if(parseInt(u.parent.insertImageSettings.minWidth,10)>=parseInt(n,10)||parseInt(u.parent.getInsertImgMaxWidth(),10)<=parseInt(n,10)&&t.isNullOrUndefined(u.imgEle.style.width))return;if(!u.parent.insertImageSettings.resizeByPercent&&(parseInt(u.parent.insertImageSettings.minHeight,10)>=parseInt(i,10)||parseInt(u.parent.insertImageSettings.maxHeight,10)<=parseInt(i,10)))return;u.imgEle.parentElement.style.cursor="pointer";u.setAspectRatio(u.imgEle,parseInt(n,10),parseInt(i,10),f);u.resizeImgDupPos(u.imgEle);u.imgResizePos(u.imgEle,u.imgResizeDiv);u.parent.setContentHeight("",!1)}})},n.prototype.resizing=function(n){this.imgEle.offsetWidth>=this.parent.getInsertImgMaxWidth()&&(this.imgEle.style.maxHeight=this.imgEle.offsetHeight+"px");var t=this.getPointX(n),i=this.getPointY(n),r=this.resizeBtnStat.botLeft||this.resizeBtnStat.topLeft?-(t-this.pageX):t-this.pageX,u=this.resizeBtnStat.topLeft||this.resizeBtnStat.topRight?-(i-this.pageY):i-this.pageY,f=parseInt(this.imgDupPos.width,10)+r,e=parseInt(this.imgDupPos.height,10)+u;this.pageX=t;this.pageY=i;(this.resizeBtnStat.botRight||this.resizeBtnStat.botLeft||this.resizeBtnStat.topRight||this.resizeBtnStat.topLeft)&&this.imgDupMouseMove(f+"px",e+"px",n)},n.prototype.cancelResizeAction=function(){t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);this.imgEle&&this.imgResizeDiv&&this.contentModule.getEditPanel().contains(this.imgResizeDiv)&&(t.detach(this.imgResizeDiv),this.imgEle.style.outline="",this.imgResizeDiv=null,this.pageX=null,this.pageY=null)},n.prototype.resizeImgDupPos=function(n){this.imgDupPos={width:""!==n.style.width?this.imgEle.style.width:n.width+"px",height:""!==n.style.height?this.imgEle.style.height:n.height+"px"}},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={botLeft:!1,botRight:!1,topRight:!1,topLeft:!1}},n.prototype.onToolbarAction=function(n){switch(d()&&this.parent.notify(et,{}),n.args.item.subCommand){case"Replace":this.parent.fileManagerSettings.enable?this.parent.notify(of,n):this.parent.notify(ar,n);break;case"Caption":this.parent.notify(no,n);break;case"InsertLink":this.parent.notify(ke,n);break;case"AltText":this.parent.notify(de,n);break;case"Remove":this.parent.notify(ge,n);break;case"Dimension":this.parent.notify(to,n);break;case"OpenImageLink":this.openImgLink(n);break;case"EditImageLink":this.editImgLink(n);break;case"RemoveImageLink":this.removeImgLink(n)}},n.prototype.openImgLink=function(n){var t=""===n.selectParent[0].parentNode.target?"_self":"_blank";this.parent.formatter.process(this.parent,n.args,n.args,{url:n.selectParent[0].parentNode.href,target:t,selectNode:n.selectNode,subCommand:n.args.item.subCommand})},n.prototype.editImgLink=function(n){var t=n.selectParent[0].parentNode,i=this.i10n.getConstant("dialogUpdate"),r={url:t.href,target:t.target,header:"Edit Link",btnText:i};this.insertImgLink(n,r)},n.prototype.removeImgLink=function(n){t.Browser.isIE&&this.contentModule.getEditPanel().focus();n.selection.restore();var i=!(!this.contentModule.getEditPanel().contains(this.captionEle)||!t.select("a",this.captionEle)),r=i?[this.captionEle]:[n.selectNode[0].parentElement];this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:n.selectNode[0],selectParent:r,selection:n.selection,subCommand:n.args.item.subCommand});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.isNullOrUndefined(n.selectParent)||t.removeClass([n.selectParent[0]],"e-img-focus"));i&&t.select(".e-img-inner",this.captionEle).focus()},n.prototype.onKeyDown=function(n){var i,h,e,f,l,r=n.args,s,u,c,o,a,v;if(this.deletedImg=[],"HTML"===this.parent.editorMode&&(l=(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument())).startContainer===i.endContainer&&i.startOffset===i.endOffset),!l&&"HTML"===this.parent.editorMode&&[27,112,113,114,115,116,117,118,119,120,121,122,123,44,45,9,16,17,18,19,20,33,34,35,36,37,38,39,40,91,92,93,144,145,182,183].indexOf(r.which)<0)for(s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),u=0;u<s.length;u++)"IMG"===s[u].nodeName&&this.deletedImg.push(s[u]);"HTML"===this.parent.editorMode&&(8===r.which&&"Backspace"===r.code||46===r.which&&"Delete"===r.code)&&(c=i.startContainer===i.endContainer&&i.startOffset===i.endOffset,8===r.which&&"Backspace"===r.code&&c?this.checkImageBack(i):46===r.which&&"Delete"===r.code&&c&&this.checkImageDel(i));!t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)&&"KeyK"!==r.code&&(i=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),h=this.parent.formatter.editorManager.nodeSelection.save(i,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(i),f=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(i),!r.ctrlKey&&r.key&&(1===r.key.length||"enter"===r.action)&&"IMG"===f[0].tagName&&f[0].parentElement)&&(o=f[0].parentElement.childNodes[0],this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle(),this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),o,o,o.textContent.length,o.textContent.length),t.removeClass([f[0]],"e-img-focus"),this.quickToolObj.imageQTBar.hidePopup());(!r.ctrlKey||89!==r.keyCode&&90!==r.keyCode||this.undoStack({subCommand:90===r.keyCode?"undo":"redo"}),8===r.keyCode||46===r.keyCode)&&(e&&"IMG"===e[0].nodeName&&e.length<1&&(r.preventDefault(),a={selectNode:e,selection:h,selectParent:f,args:{item:{command:"Images",subCommand:"Remove"},originalEvent:r}},this.deleteImg(a,r.keyCode)),this.parent.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle());switch("Backspace"===r.code&&(r.action="backspace"),r.action){case"escape":t.isNullOrUndefined(this.dialogObj)||this.dialogObj.close();break;case"backspace":case"delete":for(u=0;u<this.deletedImg.length;u++)v=this.deletedImg[u].src,this.imageRemovePost(v);3===i.startContainer.nodeType?"Backspace"===r.code?i.startContainer.previousElementSibling&&0===i.startOffset&&i.startContainer.previousElementSibling.classList.contains(oi)&&i.startContainer.previousElementSibling.classList.contains(ou)&&t.detach(i.startContainer.previousElementSibling):i.startContainer.nextElementSibling&&i.endContainer.textContent.length===i.endOffset&&i.startContainer.nextElementSibling.classList.contains(oi)&&i.startContainer.nextElementSibling.classList.contains(ou)&&t.detach(i.startContainer.nextElementSibling):1===i.startContainer.nodeType&&i.startContainer.querySelector("."+oi+"."+ou)&&t.detach(i.startContainer.querySelector("."+oi+"."+ou));break;case"insert-image":this.openDialog(!0,r,h,e,f);r.preventDefault()}},n.prototype.openDialog=function(n,i,r,u,f){var e,o,s,h;n||t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)?(o=r,s=u,h=f):(e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),o=this.parent.formatter.editorManager.nodeSelection.save(e,this.parent.contentModule.getDocument()),s=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(e),h=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(e));"HTML"===this.parent.editorMode?this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:i},selectNode:s,selection:o,selectParent:h}):this.insertImage({args:{item:{command:"Images",subCommand:"Image"},originalEvent:i},member:"image",text:this.parent.formatter.editorManager.markdownSelection.getSelectedText(this.parent.contentModule.getEditPanel()),module:"Markdown",name:"insertImage"})},n.prototype.showDialog=function(){this.openDialog(!1)},n.prototype.closeDialog=function(){this.dialogObj&&this.dialogObj.hide({returnValue:!0})},n.prototype.onKeyUp=function(){var n,i;if(!t.isNullOrUndefined(this.deletedImg)&&this.deletedImg.length>0)for(n=0;n<this.deletedImg.length;n++)i={element:this.deletedImg[n],src:this.deletedImg[n].getAttribute("src")},this.parent.trigger(ic,i)},n.prototype.checkImageBack=function(n){"#text"!==n.startContainer.nodeName||0!==n.startOffset||t.isNullOrUndefined(n.startContainer.previousSibling)||"IMG"!==n.startContainer.previousSibling.nodeName?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset-1])||"IMG"!==n.startContainer.childNodes[n.startOffset-1].nodeName||this.deletedImg.push(n.startContainer.childNodes[n.startOffset-1]):this.deletedImg.push(n.startContainer.previousSibling)},n.prototype.checkImageDel=function(n){"#text"!==n.startContainer.nodeName||n.startOffset!==n.startContainer.textContent.length||t.isNullOrUndefined(n.startContainer.nextSibling)||"IMG"!==n.startContainer.nextSibling.nodeName?"#text"===n.startContainer.nodeName||t.isNullOrUndefined(n.startContainer.childNodes[n.startOffset])||"IMG"!==n.startContainer.childNodes[n.startOffset].nodeName||this.deletedImg.push(n.startContainer.childNodes[n.startOffset]):this.deletedImg.push(n.startContainer.nextSibling)},n.prototype.alignmentSelect=function(n){var u=n.item;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Images"===u.command){var f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),r=this.parent.formatter.editorManager.nodeSelection.getNodeCollection(f),i={args:n,selectNode:r="IMG"===r[0].nodeName?r:[this.imgEle]};switch(0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),u.subCommand){case"JustifyLeft":this.alignImage(i,"JustifyLeft");break;case"JustifyCenter":this.alignImage(i,"JustifyCenter");break;case"JustifyRight":this.alignImage(i,"JustifyRight");break;case"Inline":this.inline(i);break;case"Break":this.break(i)}this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.removeClass([r[0]],"e-img-focus"));this.cancelResizeAction()}},n.prototype.imageWithLinkQTBarItemUpdate=function(){for(var r,i=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),n=0;n<i.length;n++)i[n].getAttribute("title")===this.i10n.getConstant("openLink")||i[n].getAttribute("title")===this.i10n.getConstant("editLink")||i[n].getAttribute("title")===this.i10n.getConstant("removeLink")?(t.addClass([i[n]],"e-link-groups"),i[n].style.display="none"):"Insert Link"===i[n].getAttribute("title")?i[n].style.display="":i[n].classList.contains("e-rte-horizontal-separator")&&(i[n],t.detach(i[n]));r=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(r.length/2))},n.prototype.showImageQuickToolbar=function(n){var f=this,r,i,u;"Images"!==n.type||t.isNullOrUndefined(this.parent.quickToolbarModule)||t.isNullOrUndefined(this.parent.quickToolbarModule.imageQTBar)||t.isNullOrUndefined(n.args)||(this.quickToolObj=this.parent.quickToolbarModule,r=n.args,i=n.elements,[].forEach.call(n.elements,function(n,t){0===t&&(i=n)}),i&&!t.closest(i,"a")&&this.imageWithLinkQTBarItemUpdate(),"IMG"===i.nodeName&&t.addClass([i],["e-img-focus"]),u=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+r.clientY:r.pageY,this.parent.quickToolbarModule.imageQTBar&&(n.isNotify?setTimeout(function(){f.quickToolObj.imageQTBar.showPopup(r.pageX,u,i)},400):this.quickToolObj.imageQTBar.showPopup(r.pageX,u,i)))},n.prototype.hideImageQuickToolbar=function(){t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-img-focus"))||(t.removeClass([this.contentModule.getEditPanel().querySelector(".e-img-focus")],"e-img-focus"),this.quickToolObj&&this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup())},n.prototype.editAreaClickHandler=function(n){var u,o,e,s,r,i,h;if(this.parent.readonly)this.hideImageQuickToolbar();else if(u=n.args,o=this.parent.quickToolbarSettings.showOnRightClick,2===u.which||o&&1===u.which||!o&&3===u.which)o&&1===u.which&&!t.isNullOrUndefined(u.target)&&"IMG"===u.target.tagName&&(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),u.target));else if("HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.imageQTBar)if(this.quickToolObj=this.parent.quickToolbarModule,e=u.target,this.contentModule=this.rendererFactory.getRenderer(f.Content),s=this.quickToolObj.imageQTBar.element.classList.contains("e-rte-pop"),"IMG"===e.nodeName&&this.parent.quickToolbarModule){if(s)return;if(this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.setSelectionContents(this.contentModule.getDocument(),e),d()&&this.parent.notify(lt,n),t.addClass([e],"e-img-focus"),r=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item"),t.closest(e,"a")){for(i=0;i<r.length;i++)r[i].getAttribute("title")===this.i10n.getConstant("openLink")||r[i].getAttribute("title")===this.i10n.getConstant("editLink")||r[i].getAttribute("title")===this.i10n.getConstant("removeLink")?(r[i].style.display="",t.removeClass([r[i]],"e-link-groups")):"Insert Link"===r[i].getAttribute("title")?r[i].style.display="none":r[i].classList.contains("e-rte-horizontal-separator")&&(r[i],t.detach(r[i]));h=this.quickToolObj.imageQTBar.toolbarElement.querySelectorAll(".e-toolbar-item:not(.e-link-groups)");this.quickToolObj.imageQTBar.addQTBarItem(["-"],Math.round(h.length/2))}else t.closest(e,"a")||this.imageWithLinkQTBarItemUpdate();this.showImageQuickToolbar({args:u,type:"Images",elements:[u.target]})}else this.hideImageQuickToolbar()},n.prototype.insertImgLink=function(n,i){var o=this,r,u;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),!t.isNullOrUndefined(this.dialogObj))){r=this.parent.createElement("div",{className:"e-img-linkwrap"});u=pi('<div class="e-rte-field"><input type="text" data-role ="none" class="e-input e-img-link" spellcheck="false" placeholder="'+this.i10n.getConstant("linkurl")+'"/><\/div><div class="e-rte-label"><\/div><div class="e-rte-field"><input type="checkbox" class="e-rte-linkTarget"  data-role ="none"><\/div>');r.appendChild(u);var s=r.querySelector(".e-rte-linkTarget"),f=r.querySelector(".e-img-link"),h=this.i10n.getConstant("linkOpenInNewWindow");this.checkBoxObj=new er.CheckBox({label:h,checked:!0,enableRtl:this.parent.enableRtl,change:function(n){e=n.checked?"_blank":null}});this.checkBoxObj.isStringTemplate=!0;this.checkBoxObj.createElement=this.parent.createElement;this.checkBoxObj.appendTo(s);var e=this.checkBoxObj.checked?"_blank":null,c=this.i10n.getConstant("dialogUpdate"),l={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,selectParent:n.selectParent,link:f,target:e};this.dialogObj.setProperties({height:"inherit",width:"290px",header:this.parent.localeObj.getConstant("imageInsertLinkHeader"),content:r,position:{X:"center",Y:"center"},buttons:[{click:function(){o.insertlink(l)},buttonModel:{content:c,cssClass:"e-flat e-update-link",isPrimary:!0}}]});t.isNullOrUndefined(i)||(f.value=i.url,this.checkBoxObj.checked=i.target?!0:!1,this.dialogObj.header=i.header);this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAltText=function(n){var e=this,r,u,f;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),r=this.i10n.getConstant("altText"),!t.isNullOrUndefined(this.dialogObj))){var i=this.parent.createElement("div",{className:"e-img-altwrap"}),o=this.i10n.getConstant("alternateHeader"),s=this.i10n.getConstant("dialogUpdate"),h=pi('<div class="e-rte-field"><input type="text" spellcheck="false" value="'+(null===n.selectNode[0].getAttribute("alt")?"":n.selectNode[0].getAttribute("alt"))+'" class="e-input e-img-alt" placeholder="'+r+'"/><\/div>');i.appendChild(h);u=i.querySelector(".e-img-alt");f={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode,alt:u};this.dialogObj.setProperties({height:"inherit",width:"290px",header:o,content:i,position:{X:"center",Y:"center"},buttons:[{click:function(){e.insertAlt(f)},buttonModel:{content:s,cssClass:"e-flat e-update-alt",isPrimary:!0}}]});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.insertAlt=function(n){if(!t.isNullOrUndefined(n.alt)){n.selection.restore();0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();var i=n.alt.value;this.parent.formatter.process(this.parent,n.args,n.args,{altText:i,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.dialogObj.hide({returnValue:!1})}},n.prototype.insertlink=function(n){var r,i,u;if("IMG"===n.selectNode[0].nodeName){if(r=n.link.value,""===r)return t.addClass([n.link],"e-error"),n.link.setSelectionRange(0,r.length),void n.link.focus();if(this.isUrl(r)?t.removeClass([n.link],"e-error"):r="http://"+r,i=n.selfImage,"HTML"===i.parent.editorMode&&n.selection.restore(),0===i.parent.formatter.getUndoRedoStack().length&&i.parent.formatter.saveData(),"A"===n.selectNode[0].parentElement.nodeName)return i.parent.formatter.process(i.parent,n.args,n.args,{url:r,target:i.checkBoxObj.checked?"_blank":null,selectNode:n.selectNode,subCommand:n.args.item.subCommand}),void i.dialogObj.hide({returnValue:!0});i.parent.formatter.process(i.parent,n.args,n.args,{url:r,target:i.checkBoxObj.checked?"_blank":null,selectNode:n.selectNode,subCommand:n.args.item.subCommand,selection:n.selection});u=t.closest(n.selectNode[0],".e-img-caption");u&&t.select(".e-img-inner",u).focus();u&&t.select(".e-img-inner",u).focus();i.dialogObj.hide({returnValue:!1})}},n.prototype.isUrl=function(n){return/(ftp|http|https):\/\/(\w+:{0,1}\w*@)?(\S+)(:[0-9]+)?(\/|\/([\w#!:.?+=&%@!\-\/]))?/gi.test(n)},n.prototype.deleteImg=function(n,i){if("IMG"===n.selectNode[0].nodeName){var r={element:n.selectNode[0],src:n.selectNode[0].getAttribute("src")};0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData();n.selection.restore();this.contentModule.getEditPanel().querySelector(".e-img-resize")&&this.removeResizeEle();this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,captionClass:oi,subCommand:n.args.item.subCommand});this.imageRemovePost(r.src);this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&this.quickToolObj.imageQTBar.hidePopup();this.cancelResizeAction();t.isNullOrUndefined(i)&&this.parent.trigger(ic,r)}},n.prototype.imageRemovePost=function(n){var u=this,r="",i;t.isNullOrUndefined(this.parent.insertImageSettings.removeUrl)||""===this.parent.insertImageSettings.removeUrl||(r=n.indexOf("http://")>-1||n.indexOf("https://")>-1?n:new URL(n,document.baseURI).href,this.removingImgName=r.replace(/^.*[\\\/]/,""),i=new XMLHttpRequest,i.addEventListener("readystatechange",function(){4==this.readyState&&200==this.status&&u.triggerPost(this.response)}),i.open("GET",r),i.responseType="blob",i.send())},n.prototype.triggerPost=function(n){var i=this.parent.insertImageSettings.removeUrl;if(!t.isNullOrUndefined(i)&&""!==i){var u=new File([n],this.removingImgName),f=new t.Ajax(i,"POST",!0,null),r=new FormData;r.append("UploadFiles",u);f.send(r)}},n.prototype.caption=function(n){var i=n.selectNode[0],u,o;if("IMG"===i.nodeName){if(n.selection.restore(),0===this.parent.formatter.getUndoRedoStack().length&&this.parent.formatter.saveData(),this.cancelResizeAction(),t.addClass([i],"e-rte-image"),u=n.args.item?n.args.item.subCommand:"Caption",t.isNullOrUndefined(t.closest(i,"."+oi))){this.captionEle=this.parent.createElement("span",{className:oi+" "+ay,attrs:{contenteditable:"false",draggable:"false",style:"width:"+this.parent.insertImageSettings.width}});var e=this.parent.createElement("span",{className:"e-img-wrap"}),r=this.parent.createElement("span",{className:"e-img-inner",attrs:{contenteditable:"true"}}),f=n.selectNode[0].parentElement;"A"===f.tagName&&f.setAttribute("contenteditable","true");e.appendChild("A"===f.tagName?f:n.selectNode[0]);e.appendChild(r);o=this.i10n.getConstant("imageCaption");r.innerHTML=o;this.captionEle.appendChild(e);i.classList.contains(vt)&&t.addClass([this.captionEle],ou);i.classList.contains(ei)&&t.addClass([this.captionEle],ei);i.classList.contains(yc)&&t.addClass([this.captionEle],yc);i.classList.contains(vc)&&t.addClass([this.captionEle],vc);i.classList.contains(pc)&&t.addClass([this.captionEle],pc);this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:this.captionEle,selectNode:n.selectNode,subCommand:u});this.parent.formatter.editorManager.nodeSelection.setSelectionText(this.contentModule.getDocument(),r.childNodes[0],r.childNodes[0],0,r.childNodes[0].textContent.length)}else t.detach(t.closest(i,"."+oi)),t.Browser.isIE&&(this.contentModule.getEditPanel().focus(),n.selection.restore()),"A"===i.parentElement.tagName?this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:i.parentElement,selectNode:n.selectNode,subCommand:u}):this.parent.formatter.process(this.parent,n.args,n.args,{insertElement:i,selectNode:n.selectNode,subCommand:u});this.quickToolObj&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.removeClass([i],"e-img-focus"))}},n.prototype.imageSize=function(n){var i=this;if("IMG"===n.selectNode[0].nodeName&&(this.imagDialog(n),!t.isNullOrUndefined(this.dialogObj))){var r=this.i10n.getConstant("imageSizeHeader"),u=this.i10n.getConstant("dialogUpdate"),f=this.imgsizeInput(n),e={args:n.args,selfImage:this,selection:n.selection,selectNode:n.selectNode};this.dialogObj.setProperties({height:"inherit",width:"290px",header:r,content:f,position:{X:"center",Y:"center"},buttons:[{click:function(){i.insertSize(e)},buttonModel:{content:u,cssClass:"e-flat e-update-size",isPrimary:!0}}]});this.dialogObj.element.style.maxHeight="inherit";this.dialogObj.content.querySelector("input").focus()}},n.prototype.break=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item?n.args.item.subCommand:"Break";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.inline=function(n){if("IMG"===n.selectNode[0].nodeName){var t=n.args.item?n.args.item.subCommand:"Inline";this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:t})}},n.prototype.alignImage=function(n,t){var i=n.args.item?n.args.item.subCommand:t;this.parent.formatter.process(this.parent,n.args,n.args,{selectNode:n.selectNode,subCommand:i})},n.prototype.clearDialogObj=function(){this.dialogObj&&(this.dialogObj.destroy(),t.detach(this.dialogObj.element),this.dialogObj=null)},n.prototype.imagDialog=function(n){var i=this,u,e,o;if(this.dialogObj)this.dialogObj.hide({returnValue:!0});else{u=this.parent.createElement("div",{className:"e-rte-img-dialog",id:this.rteID+"_image"});this.parent.element.appendChild(u);var s=this.i10n.getConstant("dialogInsert"),h=this.i10n.getConstant("dialogCancel"),c=this.i10n.getConstant("imageHeader"),l=n.selection,a={selfImage:this,selection:n.selection,args:n.args,selectParent:n.selectParent},f={header:c,cssClass:v,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",height:"inherit",position:{X:"center",Y:t.Browser.isDevice?"center":"top"},isModal:t.Browser.isDevice,buttons:[{click:this.insertImageUrl.bind(a),buttonModel:{content:s,cssClass:"e-flat e-insertImage",isPrimary:!0,disabled:!0}},{click:function(n){i.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:h}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(n){i.isImgUploaded&&i.uploadObj.removing();i.parent.isBlur=!1;n&&n.event.returnValue&&("HTML"===i.parent.editorMode?l.restore():i.parent.formatter.editorManager.markdownSelection.restore(i.parent.contentModule.getEditPanel()));i.dialogObj.destroy();t.detach(i.dialogObj.element);i.dialogRenderObj.close(n);i.dialogObj=null}},r=this.parent.createElement("div",{className:"e-img-content"});(t.isNullOrUndefined(this.parent.insertImageSettings.path)||"Markdown"!==this.parent.editorMode)&&"HTML"!==this.parent.editorMode||r.appendChild(this.imgUpload(n));e=this.parent.createElement("div",{className:"e-linkheader"});o=this.i10n.getConstant("imageLinkHeader");e.innerHTML="HTML"===this.parent.editorMode?o:this.i10n.getConstant("mdimageLink");r.appendChild(e);r.appendChild(this.imageUrlPopup(n));n.selectNode&&"IMG"===n.selectNode[0].nodeName?(f.header=this.parent.localeObj.getConstant("editImageHeader"),f.content=r):f.content=r;this.dialogObj=this.dialogRenderObj.render(f);this.dialogObj.createElement=this.parent.createElement;this.dialogObj.appendTo(u);t.isNullOrUndefined(this.dialogObj)||(n.selectNode&&"IMG"===n.selectNode[0].nodeName&&"insertImage"===n.name&&(this.dialogObj.element.querySelector(".e-insertImage").textContent=this.parent.localeObj.getConstant("dialogUpdate")),u.style.maxHeight="inherit",this.quickToolObj&&(this.quickToolObj.imageQTBar&&document.body.contains(this.quickToolObj.imageQTBar.element)&&(this.quickToolObj.imageQTBar.hidePopup(),t.isNullOrUndefined(n.selectParent)||t.removeClass([n.selectParent[0]],"e-img-focus")),this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()))}},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.dialogObj.hide({returnValue:!0});this.isImgUploaded&&this.uploadObj.removing()},n.prototype.onDocumentClick=function(n){var i=n.target;"IMG"===i.nodeName&&(this.imgEle=i);!t.isNullOrUndefined(this.dialogObj)&&(!t.closest(i,"[id='"+this.dialogObj.element.id+"']")&&this.parent.toolbarSettings.enable&&this.parent.getToolbarElement()&&!this.parent.getToolbarElement().contains(n.target)||this.parent.getToolbarElement()&&this.parent.getToolbarElement().contains(n.target)&&!t.closest(i,"#"+this.parent.getID()+"_toolbar_Image")&&!i.querySelector("#"+this.parent.getID()+"_toolbar_Image"))&&(n.offsetX>n.target.clientWidth||n.offsetY>n.target.clientHeight||(this.dialogObj.hide({returnValue:!0}),this.parent.isBlur=!0,ir(this.parent.element,"focusout")));"IMG"===n.target.tagName||!this.imgResizeDiv||this.quickToolObj&&this.quickToolObj.imageQTBar&&this.quickToolObj.imageQTBar.element.contains(n.target)||!this.contentModule.getEditPanel().contains(this.imgResizeDiv)||this.cancelResizeAction();this.contentModule.getEditPanel().querySelector(".e-img-resize")&&("IMG"!==i.tagName&&this.removeResizeEle(),"IMG"===i.tagName||t.isNullOrUndefined(this.imgEle)?t.isNullOrUndefined(this.prevSelectedImgEle)||this.prevSelectedImgEle===i||(this.prevSelectedImgEle.style.outline=""):this.imgEle.style.outline="")},n.prototype.removeResizeEle=function(){t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);t.detach(this.contentModule.getEditPanel().querySelector(".e-img-resize"))},n.prototype.onWindowResize=function(){t.isNullOrUndefined(this.contentModule)||t.isNullOrUndefined(this.contentModule.getEditPanel().querySelector(".e-img-resize"))||this.cancelResizeAction()},n.prototype.imageUrlPopup=function(){var n=this,i=this.parent.createElement("div",{className:"imgUrl"}),r=this.i10n.getConstant("imageUrl");return this.inputUrl=this.parent.createElement("input",{className:"e-input e-img-url",attrs:{placeholder:r,spellcheck:"false"}}),this.inputUrl.addEventListener("input",function(){t.isNullOrUndefined(n.inputUrl)||(0===n.inputUrl.value.length?n.dialogObj.getButtons(0).element.disabled=!0:n.dialogObj.getButtons(0).element.removeAttribute("disabled"))}),i.appendChild(this.inputUrl),i},n.prototype.insertImageUrl=function(){var n=this.selfImage,i,r;if(n.isImgUploaded=!1,i=n.inputUrl.value,0===n.parent.formatter.getUndoRedoStack().length&&n.parent.formatter.saveData(),t.isNullOrUndefined(n.uploadUrl)||""===n.uploadUrl.url){if(""!==i){"HTML"===n.parent.editorMode&&t.isNullOrUndefined(t.closest(this.selection.range.startContainer.parentNode,"[id='"+n.contentModule.getPanel().id+"']"))&&(n.contentModule.getEditPanel().focus(),r=n.parent.formatter.editorManager.nodeSelection.getRange(n.contentModule.getDocument()),this.selection=n.parent.formatter.editorManager.nodeSelection.save(r,n.contentModule.getDocument()),this.selectParent=n.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(r));var u=/[\w-]+.(jpg|png|jpeg|gif)/g,f=t.isNullOrUndefined(i.match(u))||"HTML"!==n.parent.editorMode?"":i.match(u)[0],e={cssClass:"inline"===n.parent.insertImageSettings.display?vt:ei,url:i,selection:this.selection,altText:f,selectParent:this.selectParent,width:{width:n.parent.insertImageSettings.width,minWidth:n.parent.insertImageSettings.minWidth,maxWidth:n.parent.getInsertImgMaxWidth()},height:{height:n.parent.insertImageSettings.height,minHeight:n.parent.insertImageSettings.minHeight,maxHeight:n.parent.insertImageSettings.maxHeight}};n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,e);n.dialogObj.hide({returnValue:!1})}}else n.uploadUrl.cssClass="inline"===n.parent.insertImageSettings.display?vt:ei,n.dialogObj.hide({returnValue:!1}),n.parent.formatter.process(n.parent,this.args,this.args.originalEvent,n.uploadUrl),n.uploadUrl.url="",n.contentModule.getEditPanel().querySelector(".e-img-resize")&&(n.imgEle.style.outline="",n.removeResizeEle())},n.prototype.imgsizeInput=function(n){var r=this,i=n.selectNode[0],c=this.i10n.getConstant("imageHeight"),l=this.i10n.getConstant("imageWidth"),u=this.parent.createElement("div",{className:"e-img-sizewrap"}),o=!t.isNullOrUndefined(this.changedWidthValue)||"auto"!==i.style.width.toString()&&""===i.style.width?t.isNullOrUndefined(this.changedWidthValue)?parseInt(i.getClientRects()[0].width.toString(),10).toString():this.changedWidthValue:i.style.width,s=!t.isNullOrUndefined(this.changedHeightValue)||"auto"!==i.style.height.toString()&&""===i.style.height?t.isNullOrUndefined(this.changedHeightValue)?parseInt(i.getClientRects()[0].height.toString(),10).toString():this.changedHeightValue:i.style.height,h,f,e;return this.changedWidthValue=null,this.changedHeightValue=null,h=pi('<div class="e-rte-label"><label>'+l+'<\/label><\/div><div class="e-rte-field"><input type="text" id="imgwidth" class="e-img-width" value='+o+' /><\/div><div class="e-rte-label"><label>'+c+'<\/label><\/div><div class="e-rte-field"> <input type="text" id="imgheight" class="e-img-height" value='+s+" /><\/div>"),u.appendChild(h),f=new st.TextBox({value:t.formatUnit(o),enableRtl:this.parent.enableRtl,input:function(n){r.inputWidthValue=t.formatUnit(r.inputValue(n.value))}}),f.createElement=this.parent.createElement,f.appendTo(u.querySelector("#imgwidth")),e=new st.TextBox({value:t.formatUnit(s),enableRtl:this.parent.enableRtl,input:function(n){r.inputHeightValue=t.formatUnit(r.inputValue(n.value))}}),e.createElement=this.parent.createElement,e.appendTo(u.querySelector("#imgheight")),u},n.prototype.inputValue=function(n){return"auto"===n||-1!==n.indexOf("%")||-1!==n.indexOf("px")||n.match(/(\d+)/)?n:"auto"},n.prototype.insertSize=function(n){var t,i,r,u;n.selection.restore();t=n.selfImage;0===t.parent.formatter.getUndoRedoStack().length&&t.parent.formatter.saveData();i=t.dialogObj.element;this.changedWidthValue=this.inputWidthValue;this.changedHeightValue=this.inputHeightValue;r=i.querySelector(".e-img-width").value;u=i.parentElement.querySelector(".e-img-height").value;t.parent.formatter.process(this.parent,n.args,n.args,{width:r,height:u,selectNode:n.selectNode,subCommand:n.args.item.subCommand});this.imgResizeDiv&&t.imgResizePos(n.selectNode[0],this.imgResizeDiv);t.dialogObj.hide({returnValue:!0})},n.prototype.insertImage=function(n){if(this.imagDialog(n),!t.isNullOrUndefined(this.dialogObj)){this.dialogObj.element.style.maxHeight="inherit";var i=this.dialogObj.element.querySelector(".e-img-content");!t.isNullOrUndefined(this.parent.insertImageSettings.path)&&"Markdown"===this.parent.editorMode||"HTML"===this.parent.editorMode?document.getElementById(this.rteID+"_insertImage").focus():i.querySelector(".e-img-url").focus()}},n.prototype.imgUpload=function(n){var f,e,i=this,r=this,p=r.parent.iframeSettings.enable,l,o,w,s,b,v,h,c,k,d,y;"HTML"===r.parent.editorMode&&(!p&&t.isNullOrUndefined(t.closest(n.selection.range.startContainer.parentNode,"[id='"+this.parent.contentModule.getPanel().id+"']"))||p&&!it(n.selection.range.startContainer.parentNode.ownerDocument.querySelector("body"),"e-lib"))?(this.contentModule.getEditPanel().focus(),l=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.formatter.editorManager.nodeSelection.save(l,this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(l)):(f=n.selection,e=n.selectParent);var a=this.parent.createElement("div",{className:"e-img-uploadwrap e-droparea"}),g=this.i10n.getConstant("imageDeviceUploadMessage"),nt=this.i10n.getConstant("imageUploadMessage"),u=this.parent.createElement("span",{className:"e-droptext"}),tt=this.parent.createElement("span",{className:"e-rte-upload-text",innerHTML:t.Browser.isDevice?g:nt});return u.appendChild(tt),o=this.parent.createElement("button",{className:"e-browsebtn",id:this.rteID+"_insertImage",attrs:{autofocus:"true",type:"button"}}),u.appendChild(o),a.appendChild(u),w=this.i10n.getConstant("browse"),s=new er.Button({content:w,enableRtl:this.parent.enableRtl}),s.isStringTemplate=!0,s.createElement=this.parent.createElement,s.appendTo(o),b=t.Browser.isDevice?u:o,t.EventHandler.add(b,"click",this.fileSelect,this),y=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}}),a.appendChild(y),this.uploadObj=new st.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},dropArea:u,multiple:!1,enableRtl:this.parent.enableRtl,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),selected:function(n){r.isImgUploaded=!0;c=n;k=n.filesData;i.parent.isServerRendered&&(c=JSON.parse(JSON.stringify(n)),n.cancel=!0,h=n.filesData,c.filesData=h);i.parent.trigger(uy,c,function(n){if(!n.cancel){if(i.checkExtension(n.filesData[0]),v=n.filesData[0].name,"HTML"===i.parent.editorMode&&t.isNullOrUndefined(i.parent.insertImageSettings.path)){var u=new FileReader;u.addEventListener("load",function(){var n="Base64"===i.parent.insertImageSettings.saveFormat?u.result:URL.createObjectURL(gf(u.result));r.uploadUrl={url:n,selection:f,altText:v,selectParent:e,width:{width:r.parent.insertImageSettings.width,minWidth:r.parent.insertImageSettings.minWidth,maxWidth:r.parent.getInsertImgMaxWidth()},height:{height:r.parent.insertImageSettings.height,minHeight:r.parent.insertImageSettings.minHeight,maxHeight:r.parent.insertImageSettings.maxHeight}};r.inputUrl.setAttribute("disabled","true");t.isNullOrUndefined(r.parent.insertImageSettings.saveUrl)&&i.isAllowedTypes&&!t.isNullOrUndefined(i.dialogObj)&&i.dialogObj.getButtons(0).element.removeAttribute("disabled")});u.readAsDataURL(n.filesData[0].rawFile)}i.parent.isServerRendered&&i.uploadObj._internalRenderSelect(n,h)}})},beforeUpload:function(n){i.parent.isServerRendered?((d=JSON.parse(JSON.stringify(n))).filesData=k,n.cancel=!0,i.parent.trigger(gi,d,function(n){n.cancel||(i.uploadObj.currentRequestHeader=n.currentRequest?n.currentRequest:i.uploadObj.currentRequestHeader,i.uploadObj.customFormDatas=n.customFormData&&n.customFormData.length>0?n.customFormData:i.uploadObj.customFormDatas,i.uploadObj.uploadFiles(h,null))})):i.parent.trigger(vo,n)},uploading:function(n){i.parent.isServerRendered||i.parent.trigger(gi,n)},success:function(n){i.parent.trigger(co,n,function(n){if(!t.isNullOrUndefined(i.parent.insertImageSettings.path)){var u=i.parent.insertImageSettings.path+n.file.name;r.uploadUrl={url:u,selection:f,altText:v,selectParent:e,width:{width:r.parent.insertImageSettings.width,minWidth:r.parent.insertImageSettings.minWidth,maxWidth:r.parent.getInsertImgMaxWidth()},height:{height:r.parent.insertImageSettings.height,minHeight:r.parent.insertImageSettings.minHeight,maxHeight:r.parent.insertImageSettings.maxHeight}};r.inputUrl.setAttribute("disabled","true")}"upload"!==n.operation||t.isNullOrUndefined(i.dialogObj)||i.dialogObj.getButtons(0).element.removeAttribute("disabled")})},failure:function(n){i.parent.trigger(lo,n)},removing:function(){i.parent.trigger(fy,n,function(){r.isImgUploaded=!1;i.dialogObj.getButtons(0).element.disabled=!0;r.inputUrl.removeAttribute("disabled");r.uploadUrl&&(r.uploadUrl.url="")})}}),this.uploadObj.isStringTemplate=!0,this.uploadObj.createElement=this.parent.createElement,this.uploadObj.appendTo(y),a},n.prototype.checkExtension=function(n){this.uploadObj.allowedExtensions&&(-1===this.uploadObj.allowedExtensions.toLocaleLowerCase().indexOf(("."+n.type).toLocaleLowerCase())?(this.dialogObj.getButtons(0).element.setAttribute("disabled","disabled"),this.isAllowedTypes=!1):this.isAllowedTypes=!0)},n.prototype.fileSelect=function(){return this.dialogObj.element.getElementsByClassName("e-file-select-wrap")[0].querySelector("button").click(),!1},n.prototype.dragStart=function(n){if("IMG"!==n.target.nodeName)return!0;this.parent.trigger(k,n,function(t){t.cancel?n.preventDefault():(n.dataTransfer.effectAllowed="copyMove",n.target.classList.add(pf))})},n.prototype.dragEnter=function(n){n.dataTransfer.dropEffect="copy";n.preventDefault()},n.prototype.dragOver=function(n){if(!("edge"===t.Browser.info.name&&n.dataTransfer.items[0].type.split("/")[0].indexOf("image")>-1||t.Browser.isIE&&"Files"===n.dataTransfer.types[0]))return!0;n.preventDefault()},n.prototype.dragDrop=function(n){var i=this;this.parent.trigger(ey,n,function(n){var r=i.parent.inputElement.ownerDocument.querySelector("."+pf),u=r&&"IMG"===r.tagName||n.dataTransfer.files.length>0;!n.cancel&&u?i.parent.trigger(k,n,function(r){if(r.cancel)n.preventDefault();else{if(t.closest(n.target,"#"+i.parent.getID()+"_toolbar")||"false"===i.parent.inputElement.contentEditable)return void n.preventDefault();i.parent.element.querySelector("."+yp)&&t.detach(i.imgResizeDiv);n.preventDefault();var u=void 0;if(i.contentModule.getDocument().caretRangeFromPoint?u=i.contentModule.getDocument().caretRangeFromPoint(n.clientX,n.clientY):n.rangeParent?(u=i.contentModule.getDocument().createRange()).setStart(n.rangeParent,n.rangeOffset):u=i.getDropRange(n.clientX,n.clientY),i.parent.notify(ef,{range:u}),i.parent.element.querySelector("."+pp))return;i.insertDragImage(n)}}):u&&n.preventDefault()})},n.prototype.getDropRange=function(n,t){var i=this.contentModule.getDocument().createRange(),e;this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),i);var f=this.contentModule.getDocument().elementFromPoint(n,t),u=f.childNodes.length>0?f.childNodes[0]:f,r=0;if("<br>"===this.parent.inputElement.firstChild.innerHTML)i.setStart(u,r),i.setEnd(u,r);else{e=void 0;do r++,i.setStart(u,r),i.setEnd(u,r+1),e=i.getBoundingClientRect();while(e.left<n&&r<u.length-1)}return i},n.prototype.insertDragImage=function(n){var c=this,r,i,f,t,h;if(n.preventDefault(),r=this.parent.element.querySelector(""+ys),this.parent.notify(ao,{args:n}),r&&r.classList.add(eu),n.dataTransfer.files.length>0){if(n.dataTransfer.files.length>1)return;for(var e=n.dataTransfer.files,o=e[0].name,l=o.substring(o.lastIndexOf(".")),s=this.parent.insertImageSettings.allowedTypes,u=0;u<s.length;u++)if(l.toLocaleLowerCase()===s[u].toLowerCase())if(this.parent.insertImageSettings.saveUrl)this.onSelect(n);else i={args:n,text:"",file:e[0]},n.preventDefault(),this.imagePaste(i)}else f=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),t=this.parent.inputElement.ownerDocument.querySelector("."+pf),t&&"IMG"===t.tagName&&(t.nextElementSibling&&t.nextElementSibling.classList.contains(wp)?f.insertNode(t.parentElement.parentElement):f.insertNode(t),t.classList.remove(pf),h={elements:[t]},t.addEventListener("load",function(){c.parent.trigger(ft,h)}),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),i=n,this.resizeStart(i,t),this.hideImageQuickToolbar())},n.prototype.onSelect=function(n){var s=this,h=this,c=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),f=this.parent.createElement("ul",{className:bp}),e,i,u,r,o;this.parent.element.appendChild(f);e={name:"",size:0,status:"",statusCode:"",type:"",rawFile:n.dataTransfer.files[0],validationMessages:{}};i=this.parent.createElement("IMG");i.style.opacity="0.5";i.classList.add(lu);i.classList.add(vt);i.classList.add(ap);u=e.rawFile;r=new FileReader;r.addEventListener("load",function(){var n=URL.createObjectURL(gf(r.result));i.src="Blob"===h.parent.insertImageSettings.saveFormat?n:r.result});u&&r.readAsDataURL(u);c.insertNode(i);this.uploadMethod(n,i);o={elements:[i]};i.addEventListener("load",function(){s.parent.trigger(ft,o)});t.detach(f)},n.prototype.uploadMethod=function(n,i){var r=this,u=!1,a=this,o=this.parent.createElement("div"),s,h,f,c,e,l;this.parent.element.appendChild(o);s=this.parent.createElement("input",{id:this.rteID+"_upload",attrs:{type:"File",name:"UploadFiles"}});h=this.parent.iframeSettings.enable?-50:-90;this.popupObj=new ot.Popup(o,{relateTo:i,height:"85px",width:"300px",offsetY:h,content:s,viewPortElement:this.parent.element,position:{X:"center",Y:"top"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){r.parent.isBlur=!1;r.popupObj.destroy();t.detach(r.popupObj.element);r.popupObj=null;r.parent.inlineMode.enable||r.parent.toolbarModule.baseToolbar.toolbarObj.disable(!1)}});this.popupObj.element.style.display="none";t.addClass([this.popupObj.element],ys);t.addClass([this.popupObj.element],gc);e=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());l=n.dataTransfer.files[0].size>1e6?300:100;setTimeout(function(){a.refreshPopup(i)},l);this.uploadObj=new st.Uploader({asyncSettings:{saveUrl:this.parent.insertImageSettings.saveUrl,removeUrl:this.parent.insertImageSettings.removeUrl},cssClass:nl,dropArea:this.parent.element,allowedExtensions:this.parent.insertImageSettings.allowedTypes.toString(),removing:function(){r.parent.inputElement.contentEditable="true";u=!1;t.detach(i);r.popupObj.close()},canceling:function(){r.parent.inputElement.contentEditable="true";u=!1;t.detach(i);r.popupObj.close();r.quickToolObj.imageQTBar.hidePopup();setTimeout(function(){r.uploadObj.destroy()},900)},beforeUpload:function(n){r.parent.isServerRendered?((c=JSON.parse(JSON.stringify(n))).filesData=f,u=!0,n.cancel=!0,r.parent.trigger(gi,c,function(n){n.cancel||(r.parent.inlineMode.enable||r.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0),r.uploadObj.currentRequestHeader=n.currentRequest?n.currentRequest:r.uploadObj.currentRequestHeader,r.uploadObj.customFormDatas=n.customFormData&&n.customFormData.length>0?n.customFormData:r.uploadObj.customFormDatas,r.uploadObj.uploadFiles(f,null),r.parent.inputElement.contentEditable="false")})):(r.parent.trigger(vo,n),r.parent.inlineMode.enable||r.parent.toolbarModule.baseToolbar.toolbarObj.disable(!0))},uploading:function(n){r.parent.isServerRendered||(u=!0,r.parent.trigger(gi,n,function(n){n.cancel?(t.isNullOrUndefined(i)||t.detach(i),t.isNullOrUndefined(r.popupObj.element)||t.detach(r.popupObj.element)):r.parent.inputElement.contentEditable="false"}))},selected:function(n){u&&(n.cancel=!0);r.parent.isServerRendered&&(f=n.filesData)},failure:function(t){u=!1;r.parent.inputElement.contentEditable="true";var f={args:n,type:"Images",isNotify:void 0,elements:i};setTimeout(function(){r.uploadFailure(i,f,t)},900)},success:function(t){if("cancel"!==t.operation){u=!1;r.parent.inputElement.contentEditable="true";var f={args:n,type:"Images",isNotify:void 0,elements:i};setTimeout(function(){r.uploadSuccess(i,n,f,t)},900)}}});this.uploadObj.appendTo(this.popupObj.element.childNodes[0]);this.popupObj.element.querySelector(".e-rte-dialog-upload .e-file-select-wrap").style.display="none";e.selectNodeContents(i);this.parent.formatter.editorManager.nodeSelection.setRange(this.contentModule.getDocument(),e)},n.prototype.refreshPopup=function(n){(this.parent.iframeSettings.enable?this.parent.element.offsetTop+n.offsetTop:n.offsetTop)>this.parent.element.offsetTop+this.parent.element.offsetHeight?(this.popupObj.relateTo=this.parent.inputElement,this.popupObj.offsetY=this.parent.iframeSettings.enable?-30:-65,this.popupObj.element.style.display="block"):this.popupObj&&(this.popupObj.refreshPosition(n),this.popupObj.element.style.display="block")},n.prototype.uploadFailure=function(n,i,r){t.detach(n);this.popupObj&&this.popupObj.close();this.parent.trigger(lo,r);this.uploadObj.destroy()},n.prototype.uploadSuccess=function(n,i,r,u){var f=this;n.style.opacity="1";n.classList.add(vp);u.element=n;this.parent.trigger(co,u,function(i){if(!t.isNullOrUndefined(f.parent.insertImageSettings.path)){var r=f.parent.insertImageSettings.path+i.file.name;n.src=r;n.setAttribute("alt",i.file.name)}});this.popupObj&&(this.popupObj.close(),this.uploadObj.destroy());this.showImageQuickToolbar(r);this.resizeStart(i,n)},n.prototype.imagePaste=function(n){var u=this,i,r;0!==n.text.length||t.isNullOrUndefined(n.file)||(i=this,r=new FileReader,n.args.preventDefault(),r.addEventListener("load",function(){var f={cssClass:"inline"===i.parent.insertImageSettings.display?vt:ei,url:"Base64"!==u.parent.insertImageSettings.saveFormat&&t.isNullOrUndefined(n.callBack)?URL.createObjectURL(gf(r.result)):r.result,width:{width:i.parent.insertImageSettings.width,minWidth:i.parent.insertImageSettings.minWidth,maxWidth:i.parent.getInsertImgMaxWidth()},height:{height:i.parent.insertImageSettings.height,minHeight:i.parent.insertImageSettings.minHeight,maxHeight:i.parent.insertImageSettings.maxHeight}};t.isNullOrUndefined(n.callBack)?(i.parent.formatter.process(i.parent,{item:{command:"Images",subCommand:"Image"}},n.args,f),u.showPopupToolBar(n,f)):n.callBack(f)}),r.readAsDataURL(n.file))},n.prototype.showPopupToolBar=function(n,t){var r=this,e='img[src="'+t.url+'"]',i=this.parent.inputElement.querySelector(e),u;this.parent.quickToolbarModule.createQTBar("Image","MultiRow",this.parent.quickToolbarSettings.image,f.ImageToolbar);u={args:n.args,type:"Images",isNotify:void 0,elements:i};i&&setTimeout(function(){r.showImageQuickToolbar(u);r.resizeStart(n.args,i)},0)},n.prototype.destroy=function(){this.prevSelectedImgEle=void 0;this.removeEventListener()},n.prototype.getModuleName=function(){return"image"},n}(),ik=function(){function n(n,t){this.parent=n;var i=t;this.rendererFactory=i.getService("rendererFactory");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ki,this.sourceCode,this);this.parent.on(c,this.onInitialEnd,this);this.parent.on(yr,this.updateSourceCode,this);this.parent.on(u,this.destroy,this)},n.prototype.onInitialEnd=function(){this.parent.formatter.editorManager.observer.on(l,this.onKeyDown,this)},n.prototype.removeEventListener=function(){this.unWireEvent();this.parent.off(ki,this.sourceCode);this.parent.off(yr,this.updateSourceCode);this.parent.off(c,this.onInitialEnd);this.parent.off(u,this.destroy);this.parent.formatter.editorManager.observer.off(l,this.onKeyDown)},n.prototype.getSourceCode=function(){return this.parent.createElement("textarea",{className:"e-rte-srctextarea"})},n.prototype.wireEvent=function(n){this.keyboardModule=new ch(n,{keyAction:this.previewKeyDown.bind(this),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"});t.EventHandler.add(this.previewElement,"mousedown",this.mouseDownHandler,this)},n.prototype.unWireEvent=function(){this.keyboardModule&&this.keyboardModule.destroy();this.previewElement&&t.EventHandler.remove(this.previewElement,"mousedown",this.mouseDownHandler)},n.prototype.wireBaseKeyDown=function(){this.parent.keyboardModule=new ch(this.contentModule.getEditPanel(),{keyAction:this.parent.keyDown.bind(this.parent),keyConfigs:this.parent.formatter.keyConfig,eventName:"keydown"})},n.prototype.unWireBaseKeyDown=function(){this.parent.keyboardModule.destroy()},n.prototype.mouseDownHandler=function(n){this.parent.notify(pr,{args:n})},n.prototype.previewKeyDown=function(n){switch(n.action){case"html-source":this.updateSourceCode(n);n.preventDefault();break;case"toolbar-focus":this.parent.toolbarSettings.enable&&this.parent.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus()}},n.prototype.onKeyDown=function(n){"html-source"===n.event.action&&(n.event.preventDefault(),this.sourceCode(n),n.callBack({requestType:"SourceCode",editorMode:"HTML",event:n.event}))},n.prototype.sourceCode=function(n){var r,i;this.parent.isBlur=!1;this.parent.trigger(k,{requestType:"SourceCode",targetItem:"SourceCode",args:n});r=t.selectAll("."+vi,this.parent.element);(this.contentModule=this.rendererFactory.getRenderer(f.Content),this.parent.notify(lr,{targetItem:"SourceCode",updateItem:"Preview",baseToolbar:this.parent.getBaseToolbarObject()}),t.isNullOrUndefined(this.previewElement)&&(this.previewElement=this.getSourceCode()),this.parent.updateValueData(),this.parent.iframeSettings.enable)?(i=void 0,(i=t.isNullOrUndefined(this.parent.element.querySelector("#"+this.parent.element.id+"_source-view"))?this.parent.createElement("div",{className:"e-source-content",id:this.parent.element.id+"_source-view"}):this.parent.element.querySelector("#"+this.parent.element.id+"_source-view")).appendChild(this.previewElement),this.parent.element.appendChild(i),i.style.height=this.contentModule.getPanel().style.height,i.style.marginTop=this.contentModule.getPanel().style.marginTop,this.getPanel().value=this.getTextAreaValue(),this.contentModule.getPanel().style.display="none",i.style.display="block",this.getPanel().style.display="block"):(this.contentModule.getPanel().appendChild(this.previewElement),this.getPanel().value=this.getTextAreaValue(),this.contentModule.getEditPanel().style.display="none",this.previewElement.style.display="block");this.parent.isBlur=!1;this.parent.disableToolbarItem(this.parent.toolbarSettings.items);this.parent.enableToolbarItem("SourceCode");this.parent.getToolbar()&&t.removeClass([this.parent.getToolbar()],[yi]);t.removeClass(r,[su]);this.parent.setContentHeight("sourceCode",!0);this.wireEvent(this.previewElement);this.unWireBaseKeyDown();this.previewElement.focus();this.parent.updateValue();t.isNullOrUndefined(this.parent.placeholder)||this.parent.iframeSettings.enable||(this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder").style.display="none");this.parent.trigger(ft,{requestType:"SourceCode",targetItem:"SourceCode",args:n});this.parent.invokeChangeEvent()},n.prototype.updateSourceCode=function(n){var i,u,r;this.parent.isBlur=!1;this.parent.trigger(k,{requestType:"Preview",targetItem:"Preview",args:n});i=this.getPanel();this.parent.notify(lr,{targetItem:"Preview",updateItem:"SourceCode",baseToolbar:this.parent.getBaseToolbarObject()});r=this.parent.serializeValue(i.value);u=null===r||""===r?"DIV"===this.parent.enterKey?"<div><br/><\/div>":"BR"===this.parent.enterKey?"<br/>":"<p><br/><\/p>":r;this.parent.iframeSettings.enable?(i.parentElement.style.display="none",i.style.display="none",this.contentModule.getPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=u):(i.style.display="none",this.contentModule.getEditPanel().style.display="block",this.contentModule.getEditPanel().innerHTML=u);this.parent.isBlur=!1;this.parent.enableToolbarItem(this.parent.toolbarSettings.items);this.parent.getToolbar()&&t.removeClass([this.parent.getToolbar()],[yi]);this.parent.setContentHeight("preview",!0);this.unWireEvent();this.wireBaseKeyDown();this.contentModule.getEditPanel().focus();this.parent.updateValue();t.isNullOrUndefined(this.parent.placeholder)||0!==this.contentModule.getEditPanel().innerText.length||(this.parent.element.querySelector(".rte-placeholder.e-rte-placeholder").style.display="block");this.parent.trigger(ft,{requestType:"Preview",targetItem:"Preview",args:n});this.parent.formatter.enableUndo(this.parent);this.parent.invokeChangeEvent()},n.prototype.getTextAreaValue=function(){return"<p><br><\/p>"===this.contentModule.getEditPanel().innerHTML||"<div><br><\/div>"===this.contentModule.getEditPanel().innerHTML||"<br>"===this.contentModule.getEditPanel().innerHTML||1===this.contentModule.getEditPanel().childNodes.length&&"P"===this.contentModule.getEditPanel().childNodes[0].tagName&&7===this.contentModule.getEditPanel().innerHTML.length||"DIV"===this.contentModule.getEditPanel().childNodes[0].tagName&&11===this.contentModule.getEditPanel().innerHTML.length?"":this.parent.value},n.prototype.getPanel=function(){return this.parent.element&&this.parent.element.querySelector(".e-rte-srctextarea")},n.prototype.getViewPanel=function(){return this.parent.iframeSettings.enable&&this.getPanel()?this.getPanel().parentElement:this.getPanel()},n.prototype.destroy=function(){this.removeEventListener()},n}(),on=function(){function n(n,t){this.ensureInsideTableList=!0;this.pageX=null;this.pageY=null;this.moveEle=null;this.parent=n;this.rteID=n.element.id;this.l10n=t.getService("rteLocale");this.rendererFactory=t.getService("rendererFactory");this.dialogRenderObj=t.getService("dialogRenderObject");this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.isDestroyed||(this.parent.on(uo,this.renderDlgContent,this),this.parent.on(c,this.afterRender,this),this.parent.on(ru,this.afterRender,this),this.parent.on(go,this.showDialog,this),this.parent.on(ns,this.closeDialog,this),this.parent.on(fo,this.docClick,this),this.parent.on(ui,this.editAreaClickHandler,this),this.parent.on(ai,this.clearDialogObj,this),this.parent.on(eo,this.onToolbarAction,this),this.parent.on(ci,this.dropdownSelect,this),this.parent.on(p,this.keyDown,this),this.parent.on(cr,this.selectionTable,this),this.parent.on(u,this.destroy,this))},n.prototype.removeEventListener=function(){this.parent.isDestroyed||(this.parent.off(uo,this.renderDlgContent),this.parent.off(c,this.afterRender),this.parent.off(ru,this.afterRender),this.parent.off(fo,this.docClick),this.parent.off(go,this.showDialog),this.parent.off(ns,this.closeDialog),this.parent.off(ui,this.editAreaClickHandler),this.parent.off(ai,this.clearDialogObj),this.parent.off(eo,this.onToolbarAction),this.parent.off(ci,this.dropdownSelect),this.parent.off(nt,this.cellSelect),this.parent.off(kr,this.setBGColor),this.parent.off(p,this.keyDown),this.parent.off(cr,this.selectionTable),this.parent.off(u,this.destroy))},n.prototype.selectionTable=function(n){var i=n.args.target;"mozilla"!==t.Browser.info.name||t.isNullOrUndefined(t.closest(i,"table"))||"TABLE"!==t.closest(i,"table").tagName||this.parent.contentModule.getEditPanel().setAttribute("contenteditable","true")},n.prototype.afterRender=function(){t.isNullOrUndefined(this.contentModule)&&(this.contentModule=this.rendererFactory.getRenderer(f.Content),this.parent.on(kr,this.setBGColor,this),this.parent.on(nt,this.cellSelect,this),this.parent.tableSettings.resize&&t.EventHandler.add(this.parent.contentModule.getEditPanel(),t.Browser.touchStartEvent,this.resizeStart,this),!t.Browser.isDevice&&this.parent.tableSettings.resize&&t.EventHandler.add(this.contentModule.getEditPanel(),"mouseover",this.resizeHelper,this))},n.prototype.dropdownSelect=function(n){var i=n.item,r,t;if(document.body.contains(document.body.querySelector(".e-rte-quick-toolbar"))&&"Table"===i.command){r=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument());t={args:n,selection:this.parent.formatter.editorManager.nodeSelection.save(r,this.contentModule.getDocument()),selectParent:this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(r)};switch(i.subCommand){case"InsertRowBefore":case"InsertRowAfter":this.addRow(t.selection,n);break;case"InsertColumnLeft":case"InsertColumnRight":this.addColumn(t.selection,n);break;case"DeleteColumn":case"DeleteRow":this.removeRowColumn(t.selection,n);break;case"AlignTop":case"AlignMiddle":case"AlignBottom":this.verticalAlign(t,n);break;case"Dashed":case"Alternate":case"Custom":this.tableStyles(t,i.subCommand);break;case"Merge":case"VerticalSplit":case"HorizontalSplit":this.UpdateCells(t.selection,n)}}},n.prototype.UpdateCells=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,subCommand:t.item.subCommand});this.hideTableQuickToolbar()},n.prototype.keyDown=function(n){var r=n.args,f=this,u;switch(r.action){case"insert-table":this.openDialog(!0,n);r.preventDefault()}if(!t.isNullOrUndefined(this.parent.formatter.editorManager.nodeSelection)&&this.contentModule&&"KeyK"!==r.code){var o=this.parent.formatter.editorManager.nodeSelection.getRange(this.parent.contentModule.getDocument()),e=this.parent.formatter.editorManager.nodeSelection.save(o,this.contentModule.getDocument()),i=this.parent.formatter.editorManager.nodeSelection.getParentNodeCollection(o)[0];if((i=i&&"TD"!==i.tagName&&"TH"!==i.tagName?i.parentElement:i,(8===r.keyCode||46===r.keyCode||r.ctrlKey&&88===r.keyCode)&&(i&&"TBODY"===i.tagName?(r.preventDefault(),f.removeTable(e,r,!0)):i&&i.querySelectorAll("table").length>0&&this.removeResizeElement()),i&&"TD"!==i.tagName&&"TH"!==i.tagName)&&(u=t.closest(i,"td"),i=!t.isNullOrUndefined(u)&&this.parent.inputElement.contains(u)?u:i),i&&("TD"===i.tagName||"TH"===i.tagName))switch(r.keyCode){case 9:case 37:case 39:f.tabSelection(r,e,i);break;case 40:case 38:f.tableArrowNavigation(r,e,i)}}},n.prototype.openDialog=function(n,t){if(n||this.parent.contentModule.getEditPanel().focus(),"HTML"===this.parent.editorMode){var i=this.parent.contentModule.getDocument(),r=this.parent.formatter.editorManager.nodeSelection.getRange(i),u=this.parent.formatter.editorManager.nodeSelection.save(r,i),f={originalEvent:t?t.args:{action:"insert-table"},item:{command:"Table",subCommand:"CreateTable"}};this.insertTableDialog({self:this,args:f,selection:u})}},n.prototype.showDialog=function(){this.openDialog(!1)},n.prototype.closeDialog=function(){this.editdlgObj&&this.editdlgObj.hide({returnValue:!0})},n.prototype.onToolbarAction=function(n){switch(n.args.item.subCommand){case"TableHeader":this.tableHeader(n.selection,n.args);break;case"TableRemove":this.removeTable(n.selection,n.args);break;case"TableEditProperties":this.editTable(n)}},n.prototype.verticalAlign=function(n,i){var r=t.closest(n.selectParent[0],"td")||t.closest(n.selectParent[0],"th");r&&this.parent.formatter.process(this.parent,i,i,{tableCell:r,subCommand:i.item.subCommand})},n.prototype.tableStyles=function(n,i){var r=t.closest(n.selectParent[0],"table"),f,u;if("Dashed"===i&&(this.parent.element.classList.contains(nr)?this.parent.element.classList.remove(nr):this.parent.element.classList.add(nr),r.classList.contains(nr)?r.classList.remove(nr):r.classList.add(nr)),"Alternate"===i&&(this.parent.element.classList.contains(tr)?this.parent.element.classList.remove(tr):this.parent.element.classList.add(tr),r.classList.contains(tr)?r.classList.remove(tr):r.classList.add(tr)),n.args&&n.args.item.cssClass)for(f=n.args.item.cssClass.split(" "),u=0;u<f.length;u++)r.classList.contains(f[u])?r.classList.remove(f[u]):r.classList.add(f[u]);this.parent.formatter.saveData();this.parent.formatter.editorManager.nodeSelection.restore()},n.prototype.insideList=function(n){for(var i=this.parent.formatter.editorManager.domNode.blockNodes(),r=[],t=0;t<i.length;t++)"LI"===i[t].parentNode.tagName?r.push(i[t].parentNode):"LI"===i[t].tagName&&"P"!==i[t].childNodes[0].tagName&&"OL"!==i[t].childNodes[0].tagName&&"UL"!==i[t].childNodes[0].tagName&&r.push(i[t]);return r.length>1||r.length&&0===n.startOffset&&0===n.endOffset?(this.ensureInsideTableList=!0,!0):(this.ensureInsideTableList=!1,!1)},n.prototype.tabSelection=function(n,i,r){var o=this.insideList(i.range),f,e,u;(37===n.keyCode||39===n.keyCode)&&3===i.range.startContainer.nodeType||o||((n.preventDefault(),r.classList.remove(si),n.shiftKey||37===n.keyCode)?(f=t.isNullOrUndefined(r.previousSibling)?t.isNullOrUndefined(t.closest(r,"tr").previousSibling)?t.isNullOrUndefined(t.closest(r,"table").previousSibling)?r:"td"===t.closest(r,"table").previousSibling.nodeName.toLowerCase()?t.closest(r,"table").previousSibling:r:t.closest(r,"tr").previousSibling.childNodes[t.closest(r,"tr").previousSibling.childNodes.length-1]:r.previousSibling,r===f&&0===r.cellIndex&&t.closest(r,"table").tHead&&(e=t.closest(r,"table"),f=e.rows[0].cells[e.rows[0].cells.length-1]),37===n.keyCode&&r===f&&(f=t.closest(r,"table").previousSibling),f&&(""!==f.textContent.trim()&&t.closest(f,"td")?i.setSelectionNode(this.contentModule.getDocument(),f):i.setSelectionText(this.contentModule.getDocument(),f,f,0,0))):(u=t.isNullOrUndefined(r.nextSibling)?t.isNullOrUndefined(t.closest(r,"tr").nextSibling)?t.isNullOrUndefined(t.closest(r,"table").nextSibling)?r:"td"===t.closest(r,"table").nextSibling.nodeName.toLowerCase()?t.closest(r,"table").nextSibling:r:t.closest(r,"tr").nextSibling.childNodes[0]:r.nextSibling,r===u&&"TH"===r.nodeName&&(u=t.closest(r,"table").rows[1].cells[0]),39===n.keyCode&&r===u&&(u=t.closest(r,"table").nextSibling),u&&(""!==u.textContent.trim()&&t.closest(u,"td")?i.setSelectionNode(this.contentModule.getDocument(),u):i.setSelectionText(this.contentModule.getDocument(),u,u,0,0)),r===u&&39!==n.keyCode&&u&&(r.classList.add(si),this.addRow(i,n,!0),r.classList.remove(si),""!==(u=u.parentElement.nextSibling.firstChild).textContent.trim()&&t.closest(u,"td")?i.setSelectionNode(this.contentModule.getDocument(),u):i.setSelectionText(this.contentModule.getDocument(),u,u,0,0))))},n.prototype.tableArrowNavigation=function(n,i,r){var u=i.range.startContainer;40===n.keyCode&&3===u.nodeType&&(u.nextSibling&&"BR"===u.nextSibling.nodeName||u.parentNode&&"TD"!==u.parentNode.nodeName)||38===n.keyCode&&3===u.nodeType&&(u.previousSibling&&"BR"===u.previousSibling.nodeName||u.parentNode&&"TD"!==u.parentNode.nodeName)||(n.preventDefault(),r.classList.remove(si),(r=40===n.keyCode?t.isNullOrUndefined(t.closest(r,"tr").nextElementSibling)?t.closest(r,"table").tHead&&"TH"===r.nodeName?t.closest(r,"table").rows[1].cells[r.cellIndex]:t.isNullOrUndefined(t.closest(r,"table").nextSibling)?r:t.closest(r,"table").nextSibling:t.closest(r,"tr").nextElementSibling.children[r.cellIndex]:t.isNullOrUndefined(t.closest(r,"tr").previousElementSibling)?t.closest(r,"table").tHead&&"TH"!==r.nodeName?t.closest(r,"table").tHead.rows[0].cells[r.cellIndex]:t.isNullOrUndefined(t.closest(r,"table").previousSibling)?r:t.closest(r,"table").previousSibling:t.closest(r,"tr").previousElementSibling.children[r.cellIndex])&&i.setSelectionText(this.contentModule.getDocument(),r,r,0,0))},n.prototype.setBGColor=function(n){for(var r=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),i=(this.parent.formatter.editorManager.nodeSelection.save(r,this.contentModule.getDocument()),this.curTable.querySelectorAll(".e-cell-select")),t=0;t<i.length;t++)i[t].style.backgroundColor=n.item.value;this.parent.formatter.saveData()},n.prototype.hideTableQuickToolbar=function(){this.quickToolObj&&this.quickToolObj.tableQTBar&&document.body.contains(this.quickToolObj.tableQTBar.element)&&this.quickToolObj.tableQTBar.hidePopup()},n.prototype.tableHeader=function(n,t){this.parent.formatter.process(this.parent,t,t.originalEvent,{selection:n,subCommand:t.item.subCommand})},n.prototype.editAreaClickHandler=function(n){var r,u,i,s,h;if(!this.parent.readonly&&t.isNullOrUndefined(t.closest(n.args.target,".e-img-caption"))&&(r=n.args,u=this.parent.quickToolbarSettings.showOnRightClick,!(2===r.which||u&&1===r.which||!u&&3===r.which)&&"HTML"===this.parent.editorMode&&this.parent.quickToolbarModule&&this.parent.quickToolbarModule.tableQTBar)){if(this.quickToolObj=this.parent.quickToolbarModule,i=r.target,this.contentModule=this.rendererFactory.getRenderer(f.Content),this.quickToolObj.tableQTBar.element.classList.contains("e-rte-pop"))return;var e=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),o=t.closest(i,"table"),c=this.parent.getRange().startContainer.parentElement,l=this.parent.getRange().endContainer.parentElement;i&&"A"!==i.nodeName&&"IMG"!==i.nodeName&&c===l&&("TD"===i.nodeName||"TH"===i.nodeName||"TABLE"===i.nodeName||o&&this.parent.contentModule.getEditPanel().contains(o))&&(3!==e.startContainer.nodeType||e.collapsed)?(s=this.parent.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.save(s,this.contentModule.getDocument()),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),h=this.parent.iframeSettings.enable?window.pageYOffset+this.parent.element.getBoundingClientRect().top+r.clientY:r.pageY,this.quickToolObj.tableQTBar.showPopup(r.pageX,h,i),this.parent.formatter.editorManager.nodeSelection.restore()):this.hideTableQuickToolbar()}},n.prototype.tableCellSelect=function(n){var i=n.target,r=Array.prototype.slice.call(i.parentElement.parentElement.children).indexOf(i.parentElement),u=Array.prototype.slice.call(i.parentElement.children).indexOf(i),f=this.dlgDiv.querySelectorAll(".e-rte-tablecell");Array.prototype.forEach.call(f,function(n){var i=Array.prototype.slice.call(n.parentElement.parentElement.children).indexOf(n.parentElement),f=Array.prototype.slice.call(n.parentElement.children).indexOf(n);t.removeClass([n],"e-active");i<=r&&f<=u&&t.addClass([n],"e-active")});this.tblHeader.innerHTML=u+1+"x"+(r+1)},n.prototype.tableMouseUp=function(){t.EventHandler.remove(this.curTable,"mousemove",this.tableMove)},n.prototype.tableCellLeave=function(){t.removeClass(this.dlgDiv.querySelectorAll(".e-rte-tablecell"),"e-active");t.addClass([this.dlgDiv.querySelector(".e-rte-tablecell")],"e-active");this.tblHeader.innerHTML="1x1"},n.prototype.tableCellClick=function(n){var t=n.target,i=Array.prototype.slice.call(t.parentElement.parentElement.children).indexOf(t.parentElement)+1,r=Array.prototype.slice.call(t.parentElement.children).indexOf(t)+1;this.self.tableInsert(i,r,n,this)},n.prototype.tableInsert=function(n,i,r,u){var f=u.self?u.self:this,e=u.selection.range.startContainer,o,s,h;"P"!==e.nodeName||""!==e.textContent.trim()||e.childNodes.length>0||(e.innerHTML="<br />");o=e.parentNode;"HTML"===f.parent.editorMode&&(f.parent.iframeSettings.enable&&!it(o.ownerDocument.querySelector("body"),"e-lib")||!f.parent.iframeSettings.enable&&t.isNullOrUndefined(t.closest(o,"[id='"+f.contentModule.getPanel().id+"']")))&&(f.contentModule.getEditPanel().focus(),s=f.parent.formatter.editorManager.nodeSelection.getRange(f.contentModule.getDocument()),u.selection=f.parent.formatter.editorManager.nodeSelection.save(s,f.contentModule.getDocument()));h={rows:n,columns:i,width:{minWidth:f.parent.tableSettings.minWidth,maxWidth:f.parent.tableSettings.maxWidth,width:f.parent.tableSettings.width},selection:u.selection};f.popupObj&&f.popupObj.hide();f.editdlgObj&&f.editdlgObj.hide();f.parent.formatter.process(f.parent,u.args,u.args.originalEvent,h);f.contentModule.getEditPanel().focus();f.parent.on(nt,f.cellSelect,f)},n.prototype.cellSelect=function(n){var i=n.args.target,r=t.closest(i,"td,th");i="TD"!==i.nodeName&&r&&this.parent.contentModule.getEditPanel().contains(r)?r:i;t.removeClass(this.contentModule.getEditPanel().querySelectorAll("table td, table th"),si);!i||"TD"!==i.tagName&&"TH"!==i.tagName||(t.addClass([i],si),this.activeCell=i,this.curTable=this.curTable?this.curTable:t.closest(i,"table"),t.EventHandler.add(this.curTable,"mousemove",this.tableMove,this),t.EventHandler.add(this.curTable,"mouseup",this.tableMouseUp,this),this.removeResizeElement(),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&t.detach(this.helper));"mozilla"!==t.Browser.info.name||t.isNullOrUndefined(t.closest(i,"table"))||"TABLE"!==t.closest(i,"table").tagName||this.parent.contentModule.getEditPanel().setAttribute("contenteditable","false")},n.prototype.tableMove=function(n){this.parent.formatter.editorManager.observer.notify("TABLE_MOVE",{event:n,selectNode:[this.activeCell]})},n.prototype.resizeHelper=function(n){if(!this.parent.readonly){var i=n.target||n.targetTouches[0].target,r=t.closest(i,"table");t.isNullOrUndefined(this.curTable)||t.isNullOrUndefined(r)||r===this.curTable||(this.removeResizeElement(),this.removeHelper(n),this.cancelResizeAction());"TABLE"!==i.nodeName&&"TD"!==i.nodeName&&"TH"!==i.nodeName||(this.curTable=r&&this.parent.contentModule.getEditPanel().contains(r)&&("TD"===i.nodeName||"TH"===i.nodeName)?r:i,this.removeResizeElement(),this.tableResizeEleCreation(this.curTable,n))}},n.prototype.tableResizeEleCreation=function(n,i){var e,o,a,s;this.parent.preventDefaultResize(i);for(var h=Array.prototype.slice.call(n.rows[this.calMaxCol(n)].cells,1),f=[],r=0;r<n.rows.length;r++)f.push(Array.prototype.slice.call(n.rows[r].cells,0,1)[0]);var c=parseInt(getComputedStyle(n).height,10),l=parseInt(getComputedStyle(n).width,10),u=this.calcPos(n);for(r=0;h.length>r;r++)e=this.parent.createElement("span",{attrs:{"data-col":(r+1).toString(),unselectable:"on",contenteditable:"false"}}),e.classList.add(ul,af),e.style.cssText="height: "+c+"px; width: 4px; top: "+u.top+"px; left:"+(u.left+this.calcPos(h[r]).left)+"px;",this.contentModule.getEditPanel().appendChild(e);for(r=0;f.length>r;r++)o=this.parent.createElement("span",{attrs:{"data-row":r.toString(),unselectable:"on",contenteditable:"false"}}),o.classList.add(ul,vf),a=t.isNullOrUndefined(n.getAttribute("cellspacing"))&&""===n.getAttribute("cellspacing")?this.calcPos(f[r]).left:0,o.style.cssText="width: "+l+"px; height: 4px; top: "+(this.calcPos(f[r]).top+u.top+f[r].offsetHeight-2)+"px; left:"+(a+u.left)+"px;",this.contentModule.getEditPanel().appendChild(o);s=this.parent.createElement("span",{className:yf,attrs:{"data-col":h.length.toString(),unselectable:"on",contenteditable:"false"}});s.style.cssText="top: "+(u.top+c-4)+"px; left:"+(u.left+l-4)+"px;";t.Browser.isDevice&&s.classList.add("e-rmob");this.contentModule.getEditPanel().appendChild(s)},n.prototype.removeResizeElement=function(){var i=this.parent.contentModule.getEditPanel().querySelectorAll(".e-column-resize, .e-row-resize, .e-table-box"),n;if(i.length>0)for(n=0;n<i.length;n++)t.detach(i[n])},n.prototype.calcPos=function(n){n.getBoundingClientRect();for(var r=n.ownerDocument,i=n.offsetParent||r.documentElement;i&&(i===r.body||i===r.documentElement)&&"static"===i.style.position;)i=i.parentNode;return"TD"===i.nodeName&&"TABLE"===n.nodeName&&(i=t.closest(i,".e-rte-content")),i&&i!==n&&1===i.nodeType&&i.getBoundingClientRect(),{top:n.offsetTop,left:n.offsetLeft}},n.prototype.getPointX=function(n){return n.touches&&n.touches.length?n.touches[0].pageX:n.pageX},n.prototype.getPointY=function(n){return n.touches&&n.touches.length?n.touches[0].pageY:n.pageY},n.prototype.resizeStart=function(n){var u=this,i,r;this.parent.readonly||(t.Browser.isDevice&&this.resizeHelper(n),i=n.target,(i.classList.contains(af)||i.classList.contains(vf)||i.classList.contains(yf))&&((n.preventDefault(),this.parent.preventDefaultResize(n),t.removeClass(this.curTable.querySelectorAll("td,th"),si),this.parent.formatter.editorManager.nodeSelection.Clear(this.contentModule.getDocument()),this.pageX=this.getPointX(n),this.pageY=this.getPointY(n),this.resizeBtnInit(),this.hideTableQuickToolbar(),i.classList.contains(af)&&(this.resizeBtnStat.column=!0,this.columnEle=this.curTable.rows[this.calMaxCol(this.curTable)].cells[parseInt(i.getAttribute("data-col"),10)],this.colIndex=this.columnEle.cellIndex,this.moveEle=n.target,this.appendHelper()),i.classList.contains(vf)&&(this.rowEle=this.curTable.rows[parseInt(i.getAttribute("data-row"),10)],this.resizeBtnStat.row=!0,this.appendHelper()),i.classList.contains(yf)&&(this.resizeBtnStat.tableBox=!0),t.Browser.isDevice&&this.helper&&!this.helper.classList.contains("e-reicon"))?(this.helper.classList.add("e-reicon"),t.EventHandler.add(document,t.Browser.touchStartEvent,this.removeHelper,this),t.EventHandler.add(this.helper,t.Browser.touchStartEvent,this.resizeStart,this)):(r={event:n,requestType:"Table"},this.parent.trigger(ve,r,function(n){n.cancel&&u.cancelResizeAction()})),t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing,this),t.EventHandler.add(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd,this)))},n.prototype.removeHelper=function(n){!n.target.classList.contains("e-reicon")&&this.helper&&(t.EventHandler.remove(document,t.Browser.touchStartEvent,this.removeHelper),t.EventHandler.remove(this.helper,t.Browser.touchStartEvent,this.resizeStart),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&t.detach(this.helper),this.pageX=null,this.helper=null)},n.prototype.appendHelper=function(){this.helper=this.parent.createElement("div",{className:"e-table-rhelper"});t.Browser.isDevice&&this.helper.classList.add("e-reicon");this.contentModule.getEditPanel().appendChild(this.helper);this.setHelperHeight()},n.prototype.setHelperHeight=function(){var n=this.calcPos(this.curTable);this.resizeBtnStat.column?(this.helper.classList.add("e-column-helper"),this.helper.style.cssText="height: "+getComputedStyle(this.curTable).height+"; top: "+n.top+"px; left:"+(n.left+this.calcPos(this.columnEle).left-1)+"px;"):(this.helper.classList.add("e-row-helper"),this.helper.style.cssText="width: "+getComputedStyle(this.curTable).width+"; top: "+(this.calcPos(this.rowEle).top+n.top+this.rowEle.offsetHeight)+"px; left:"+(this.calcPos(this.rowEle).left+n.left)+"px;")},n.prototype.updateHelper=function(){var n=this.calcPos(this.curTable),t,i;this.resizeBtnStat.column?(t=n.left+this.calcPos(this.columnEle).left-1,this.helper.style.left=t+"px"):(i=this.calcPos(this.rowEle).top+n.top+this.rowEle.offsetHeight,this.helper.style.top=i+"px")},n.prototype.calMaxCol=function(n){for(var i,r=0,t=0;t<n.rows.length;t++)r<n.rows[t].cells.length&&(i=t,r=n.rows[t].cells.length);return i},n.prototype.resizing=function(n){var i=this,r=this.getPointX(n),u=this.getPointY(n),f=this.parent.enableRtl?-(r-this.pageX):r-this.pageX,e=this.parent.enableRtl?-(u-this.pageY):u-this.pageY,o;this.pageX=r;this.pageY=u;o={event:n,requestType:"table"};this.parent.trigger(ye,o,function(r){var v,y,l,p;if(r.cancel)i.cancelResizeAction();else{var s=i.contentModule.getEditPanel().querySelector(".e-table-box"),u=parseInt(getComputedStyle(i.curTable).width,10),c=parseInt(getComputedStyle(i.curTable).height,10),w=+getComputedStyle(i.contentModule.getEditPanel()).paddingRight.match(/\d/g).join(""),b=i.contentModule.getEditPanel().offsetWidth-2*w;if(i.resizeBtnStat.column){for(var k=i.curTable.rows[i.calMaxCol(i.curTable)].cells,h=parseFloat(i.columnEle.offsetWidth.toString())-f,a=parseFloat(i.columnEle.offsetWidth.toString())+parseFloat(k[i.colIndex-1].offsetWidth.toString()),o=0;o<i.curTable.rows.length;o++)a-h>20&&h>20&&(v=a-h,y=h,t.isNullOrUndefined(i.curTable.rows[o].cells[i.colIndex-1])||(i.curTable.rows[o].cells[i.colIndex-1].style.width=i.convertPixelToPercentage(v,u)+"%"),t.isNullOrUndefined(i.curTable.rows[o].cells[i.colIndex])||(i.curTable.rows[o].cells[i.colIndex].style.width=i.convertPixelToPercentage(y,u)+"%"));i.updateHelper()}else i.resizeBtnStat.row?(i.parent.preventDefaultResize(n),l=parseFloat(i.rowEle.clientHeight.toString())+e,l>20&&(i.rowEle.style.height=l+"px"),i.curTable.style.height="",t.isNullOrUndefined(s)||(s.style.cssText="top: "+(i.calcPos(i.curTable).top+c-4)+"px; left:"+(i.calcPos(i.curTable).left+u-4)+"px;"),i.updateHelper()):i.resizeBtnStat.tableBox&&(t.Browser.isDevice||t.EventHandler.remove(i.contentModule.getEditPanel(),"mouseover",i.resizeHelper),p=i.curTable.style.width.indexOf("%")>-1,i.curTable.style.width=p?i.convertPixelToPercentage(u+f,b)+"%":u+f+"px",i.curTable.style.height=c+e+"px",s.classList.add("e-rbox-select"),s.style.cssText="top: "+(i.calcPos(i.curTable).top+c-4)+"px; left:"+(i.calcPos(i.curTable).left+u-4)+"px;")}})},n.prototype.convertPixelToPercentage=function(n,t){return n/t*100},n.prototype.cancelResizeAction=function(){t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);this.removeResizeElement()},n.prototype.resizeEnd=function(n){this.resizeBtnInit();t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchMoveEvent,this.resizing);t.EventHandler.remove(this.contentModule.getDocument(),t.Browser.touchEndEvent,this.resizeEnd);this.contentModule.getEditPanel().querySelector(".e-table-box")&&this.contentModule.getEditPanel().contains(this.contentModule.getEditPanel().querySelector(".e-table-box"))&&(t.Browser.isDevice||t.EventHandler.add(this.contentModule.getEditPanel(),"mouseover",this.resizeHelper,this),this.removeResizeElement(),this.helper&&this.contentModule.getEditPanel().contains(this.helper)&&(t.detach(this.helper),this.helper=null),this.pageX=null,this.pageY=null,this.moveEle=null);var i={event:n,requestType:"table"};this.parent.trigger(pe,i);this.parent.formatter.saveData()},n.prototype.resizeBtnInit=function(){return this.resizeBtnStat={column:!1,row:!1,tableBox:!1}},n.prototype.addRow=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"InsertRowAfter"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t,u)},n.prototype.addColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,width:this.parent.tableSettings.width,subCommand:t.item.subCommand})},n.prototype.removeRowColumn=function(n,t){this.parent.formatter.process(this.parent,t,t,{selection:n,subCommand:t.item.subCommand});this.hideTableQuickToolbar()},n.prototype.removeTable=function(n,t,i){var r,u;i&&(r={item:{command:"Table",subCommand:"TableRemove"}});u={selection:n,subCommand:i?r.item.subCommand:t.item.subCommand};this.parent.formatter.process(this.parent,i?r:t,t.originalEvent,u);this.contentModule.getEditPanel().focus();this.removeResizeElement();this.hideTableQuickToolbar()},n.prototype.renderDlgContent=function(n){var r=this,o,f,u,e,i;t.Browser.isDevice||this.parent.inlineMode.enable?this.insertTableDialog(n):this.popupObj?this.popupObj.hide():(this.hideTableQuickToolbar(),o=this.l10n.getConstant("inserttablebtn"),this.dlgDiv=this.parent.createElement("div",{className:"e-rte-table-popup",id:this.rteID+"_table"}),this.tblHeader=this.parent.createElement("div",{className:"e-rte-popup-header"}),this.tblHeader.innerHTML="1X1",this.dlgDiv.appendChild(this.tblHeader),f=this.parent.createElement("div",{className:"e-rte-table-span"}),this.drawTable(f,n),this.dlgDiv.appendChild(f),this.dlgDiv.appendChild(this.parent.createElement("span",{className:"e-span-border"})),u=this.parent.createElement("button",{className:"e-insert-table-btn",id:this.rteID+"_insertTable",attrs:{type:"button",tabindex:"0"}}),t.isNullOrUndefined(this.parent.getToolbarElement().querySelector(".e-expended-nav"))||this.parent.getToolbarElement().querySelector(".e-expended-nav").setAttribute("tabindex","1"),this.dlgDiv.appendChild(u),e=new er.Button({iconCss:"e-icons e-create-table",content:o,cssClass:"e-flat",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),e.isStringTemplate=!0,e.appendTo(u),t.EventHandler.add(u,"click",this.insertTableDialog,{self:this,args:n.args,selection:n.selection}),this.parent.getToolbar().appendChild(this.dlgDiv),i=n.args.originalEvent.target,i=i.classList.contains("e-toolbar-item")?i.firstChild:i.parentElement,this.popupObj=new ot.Popup(this.dlgDiv,{targetType:"relative",relateTo:i,collision:{X:"fit",Y:"none"},offsetY:8,viewPortElement:this.parent.element,position:{X:"left",Y:"bottom"},enableRtl:this.parent.enableRtl,zIndex:10001,close:function(){r.parent.isBlur=!1;r.popupObj.destroy();t.detach(r.popupObj.element);r.popupObj=null}}),t.addClass([this.popupObj.element],"e-popup-open"),this.popupObj.refreshPosition(i))},n.prototype.docClick=function(n){var i=n.args.target,r,u;i&&i.classList&&(this.popupObj&&!t.closest(i,"[id='"+this.popupObj.element.id+"']")||this.editdlgObj&&!t.closest(i,"#"+this.editdlgObj.element.id))&&!i.classList.contains("e-create-table")&&i.offsetParent&&!i.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")&&(this.popupObj&&this.popupObj.hide(),this.editdlgObj&&this.editdlgObj.hide(),this.parent.isBlur=!0,ir(this.parent.element,"focusout"));r=t.closest(i,"td");u=!(!r||!this.parent.contentModule.getEditPanel().contains(r));!i||"TD"===i.tagName||"TH"===i.tagName||u||null!==t.closest(i,".e-rte-quick-popup")||!i.offsetParent||i.offsetParent.classList.contains("e-quick-dropdown")||i.offsetParent.classList.contains("e-rte-backgroundcolor-dropdown")||t.closest(i,".e-rte-dropdown-popup")||t.closest(i,".e-rte-elements")||(t.removeClass(this.parent.element.querySelectorAll("table td"),si),t.Browser.isIE||this.hideTableQuickToolbar());!i||!i.classList||i.classList.contains(af)||i.classList.contains(vf)||i.classList.contains(yf)||this.removeResizeElement()},n.prototype.drawTable=function(n,i){for(var e,r,f,o,u=0;u<3;u++){for(e=this.parent.createElement("div",{className:"e-rte-table-row",attrs:{"data-column":""+u}}),f=0;f<10;f++)o=u>2?"none":"inline-block",r=this.parent.createElement("div",{className:"e-rte-tablecell e-default",attrs:{"data-cell":""+f}}),e.appendChild(r),r.style.display=o,0===f&&0===u&&t.addClass([r],"e-active"),t.EventHandler.add(r,"mousemove",this.tableCellSelect,this),t.EventHandler.add(e,"mouseleave",this.tableCellLeave,this),t.EventHandler.add(r,"mouseup",this.tableCellClick,{self:this,args:i.args,selection:i.selection});n.appendChild(e)}},n.prototype.editTable=function(n){var t=this;this.createDialog(n);var i=this.tableDlgContent(n),r=this.l10n.getConstant("dialogUpdate"),u=this.l10n.getConstant("dialogCancel"),f=this.l10n.getConstant("tableEditHeader");this.editdlgObj.setProperties({height:"initial",width:"290px",content:i,header:f,buttons:[{click:this.applyProperties.bind(this,n),buttonModel:{content:r,cssClass:"e-flat e-size-update",isPrimary:!0}},{click:function(n){t.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:u}}]});this.editdlgObj.element.style.maxHeight="none";this.editdlgObj.content.querySelector("input").focus();this.hideTableQuickToolbar()},n.prototype.insertTableDialog=function(n){var i=this.self?this.self:this;i.popupObj&&i.popupObj.hide();i.createDialog(n);var r=i.tableCellDlgContent(),u=i.l10n.getConstant("dialogInsert"),f=i.l10n.getConstant("dialogCancel");t.isNullOrUndefined(i.editdlgObj)||(i.editdlgObj.setProperties({height:"initial",width:"290px",content:r,buttons:[{click:i.customTable.bind(this,n),buttonModel:{content:u,cssClass:"e-flat e-insert-table",isPrimary:!0}},{click:function(n){i.cancelDialog(n)},buttonModel:{cssClass:"e-flat e-cancel",content:f}}]}),i.editdlgObj.element.style.maxHeight="none",i.editdlgObj.content.querySelector("input").focus())},n.prototype.tableCellDlgContent=function(){var t=this.l10n.getConstant("columns"),i=this.l10n.getConstant("rows"),n=this.parent.createElement("div",{className:"e-cell-wrap"}),r=pi('<div class="e-rte-field"><input type="text"  data-role ="none" id="tableColumn" class="e-table-column"/><\/div><div class="e-rte-field"><input type="text" data-role ="none" id="tableRow" class="e-table-row" /><\/div>');return n.appendChild(r),this.columnTextBox=new st.NumericTextBox({format:"n0",min:1,value:3,placeholder:t,floatLabelType:"Auto",max:50,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),this.columnTextBox.isStringTemplate=!0,this.columnTextBox.appendTo(n.querySelector("#tableColumn")),this.rowTextBox=new st.NumericTextBox({format:"n0",min:1,value:3,placeholder:i,floatLabelType:"Auto",max:50,enableRtl:this.parent.enableRtl,locale:this.parent.locale}),this.rowTextBox.isStringTemplate=!0,this.rowTextBox.appendTo(n.querySelector("#tableRow")),n},n.prototype.clearDialogObj=function(){this.editdlgObj&&(this.editdlgObj.destroy(),t.detach(this.editdlgObj.element),this.editdlgObj=null)},n.prototype.createDialog=function(){var n=this,i;if(this.editdlgObj)this.editdlgObj.hide({returnValue:!0});else{i=this.parent.createElement("div",{className:"e-rte-edit-table",id:this.rteID+"_tabledialog"});this.parent.element.appendChild(i);var r=this.l10n.getConstant("dialogInsert"),u=this.l10n.getConstant("dialogCancel"),f={header:this.l10n.getConstant("tabledialogHeader"),cssClass:v,enableRtl:this.parent.enableRtl,locale:this.parent.locale,showCloseIcon:!0,closeOnEscape:!0,width:t.Browser.isDevice?"290px":"340px",height:"initial",position:{X:"center",Y:t.Browser.isDevice?"center":"top"},isModal:t.Browser.isDevice,buttons:[{buttonModel:{content:r,cssClass:"e-flat e-insert-table",isPrimary:!0}},{click:function(t){n.cancelDialog(t)},buttonModel:{cssClass:"e-flat e-cancel",content:u}}],target:t.Browser.isDevice?document.body:this.parent.element,animationSettings:{effect:"None"},close:function(i){n.parent.isBlur=!1;n.editdlgObj.destroy();t.detach(n.editdlgObj.element);n.dialogRenderObj.close(i);n.editdlgObj=null}};this.editdlgObj=this.dialogRenderObj.render(f);this.editdlgObj.appendTo(i);this.quickToolObj&&this.quickToolObj.inlineQTBar&&document.body.contains(this.quickToolObj.inlineQTBar.element)&&this.quickToolObj.inlineQTBar.hidePopup()}},n.prototype.customTable=function(n,i){var r=this.self?this.self:this,u;r.rowTextBox.value&&r.columnTextBox.value&&(u=t.Browser.isDevice||!t.isNullOrUndefined(n.args)&&!t.isNullOrUndefined(n.args.originalEvent)&&"insert-table"===n.args.originalEvent.action||r.parent.inlineMode.enable?n:this,r.tableInsert(r.rowTextBox.value,r.columnTextBox.value,i,u))},n.prototype.cancelDialog=function(){this.parent.isBlur=!1;this.editdlgObj.hide({returnValue:!0})},n.prototype.applyProperties=function(n){var f=this.editdlgObj.element,r=t.closest(n.selectNode[0],"table"),u,i,e;if(r.style.width=f.querySelector(".e-table-width").value+"px",""!==f.querySelector(".e-cell-padding").value)for(u=r.querySelectorAll("td"),i=0;i<u.length;i++)e="",""===u[i].style.padding?e=u[i].getAttribute("style")+" padding:"+f.querySelector(".e-cell-padding").value+"px;":(u[i].style.padding=f.querySelector(".e-cell-padding").value+"px",e=u[i].getAttribute("style")),u[i].setAttribute("style",e);r.cellSpacing=f.querySelector(".e-cell-spacing").value;t.isNullOrUndefined(r.cellSpacing)&&"0"===r.cellSpacing?t.removeClass([r],rl):t.addClass([r],rl);this.parent.formatter.saveData();this.editdlgObj.hide({returnValue:!0})},n.prototype.tableDlgContent=function(n){var r=n.selectParent[0],h=this.l10n.getConstant("tableWidth"),c=this.l10n.getConstant("cellpadding"),l=this.l10n.getConstant("cellspacing"),i=this.parent.createElement("div",{className:"e-table-sizewrap"}),a=t.closest(r,"table").getClientRects()[0].width,s=t.closest(r,"td").style.padding,u=t.closest(r,"table").getAttribute("cellspacing"),v=pi('<div class="e-rte-field"><input type="text" data-role ="none" id="tableWidth" class="e-table-width"  /><\/div><div class="e-rte-field"><input type="text" data-role ="none" id="cellPadding" class="e-cell-padding" /> <\/div><div class="e-rte-field"><input type="text" data-role ="none" id="cellSpacing" class="e-cell-spacing" /><\/div>'),f,e,o;return i.appendChild(v),f=new st.NumericTextBox({format:"n0",min:0,value:a,placeholder:h,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),f.isStringTemplate=!0,f.appendTo(i.querySelector("#tableWidth")),e=new st.NumericTextBox({format:"n0",min:0,value:""!==s?parseInt(s,null):0,placeholder:c,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),e.isStringTemplate=!0,e.appendTo(i.querySelector("#cellPadding")),o=new st.NumericTextBox({format:"n0",min:0,value:""===u||t.isNullOrUndefined(u)?0:parseInt(u,null),placeholder:l,floatLabelType:"Auto",enableRtl:this.parent.enableRtl,locale:this.parent.locale}),o.isStringTemplate=!0,o.appendTo(i.querySelector("#cellSpacing")),i},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.getModuleName=function(){return"table"},n}(),rk=function(){function n(n){this.parent=n}return n.prototype.render=function(n){var i;return n.beforeOpen=this.beforeOpen.bind(this),n.open=this.open.bind(this),t.isNullOrUndefined(n.close)&&(n.close=this.close.bind(this)),n.beforeClose=this.beforeClose.bind(this),(i=new ot.Dialog(n)).isStringTemplate=!0,i},n.prototype.beforeOpen=function(n){this.parent.trigger(kv,n,this.beforeOpenCallback.bind(this,n))},n.prototype.beforeOpenCallback=function(n){n.cancel&&this.parent.notify(ai,null)},n.prototype.open=function(n){this.parent.trigger(dv,n)},n.prototype.beforeClose=function(n){this.parent.trigger(gv,n,function(n){n.cancel||n.container.classList.contains("e-popup-close")&&(n.cancel=!0)})},n.prototype.close=function(n){this.parent.trigger(ny,n)},n}(),uk={bold:{command:"Style",subCommand:"Bold",value:"strong"},italic:{command:"Style",subCommand:"Italic",value:"em"},underline:{command:"Style",subCommand:"Underline",value:"span"},strikeThrough:{command:"Style",subCommand:"StrikeThrough",value:"span"},insertCode:{command:"Formats",subCommand:"Pre",value:"pre"},superscript:{command:"Effects",subCommand:"SuperScript",value:"sup"},subscript:{command:"Effects",subCommand:"SubScript",value:"sub"},uppercase:{command:"Casing",subCommand:"UpperCase"},lowercase:{command:"Casing",subCommand:"LowerCase"},fontColor:{command:"font",subCommand:"fontcolor",value:"#ff0000"},fontName:{command:"font",subCommand:"fontname",value:"Segoe UI"},fontSize:{command:"font",subCommand:"fontsize",value:"10pt"},backColor:{command:"font",subCommand:"backgroundcolor",value:"#ffff00"},justifyCenter:{command:"Alignments",subCommand:"JustifyCenter"},justifyFull:{command:"Alignments",subCommand:"JustifyFull"},justifyLeft:{command:"Alignments",subCommand:"JustifyLeft"},justifyRight:{command:"Alignments",subCommand:"JustifyRight"},undo:{command:"Actions",subCommand:"Undo"},redo:{command:"Actions",subCommand:"Redo"},createLink:{command:"Links",subCommand:"createLink"},editLink:{command:"Links",subCommand:"createLink"},createImage:{command:"Images",subCommand:"Images"},formatBlock:{command:"Formats",value:"P"},heading:{command:"Formats",value:"H1"},indent:{command:"Indents",subCommand:"Indent"},outdent:{command:"Indents",subCommand:"Outdent"},insertHTML:{command:"InsertHTML",subCommand:"InsertHTML",value:""},insertText:{command:"InsertText",subCommand:"InsertText",value:""},insertHorizontalRule:{command:"InsertHTML",subCommand:"InsertHTML",value:"<hr/>"},insertImage:{command:"Images",subCommand:"Image"},editImage:{command:"Images",subCommand:"Image"},insertTable:{command:"Table",subCommand:"CreateTable"},insertBrOnReturn:{command:"InsertHTML",subCommand:"InsertHTML",value:"<br/>"},insertOrderedList:{command:"Lists",value:"OL"},insertUnorderedList:{command:"Lists",value:"UL"},insertParagraph:{command:"Formats",value:"P"},removeFormat:{command:"Clear",subCommand:"ClearFormat"}},ut=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),i=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},sn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(!0)],r.prototype,"enable",void 0),i([t.Property(!0)],r.prototype,"enableFloating",void 0),i([t.Property(y.Expand)],r.prototype,"type",void 0),i([t.Property(kd)],r.prototype,"items",void 0),i([t.Property({})],r.prototype,"itemConfigs",void 0),r}(t.ChildProperty),hn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property([".jpeg",".jpg",".png"])],r.prototype,"allowedTypes",void 0),i([t.Property("inline")],r.prototype,"display",void 0),i([t.Property("Blob")],r.prototype,"saveFormat",void 0),i([t.Property("auto")],r.prototype,"width",void 0),i([t.Property("auto")],r.prototype,"height",void 0),i([t.Property(null)],r.prototype,"saveUrl",void 0),i([t.Property(null)],r.prototype,"path",void 0),i([t.Property(!0)],r.prototype,"resize",void 0),i([t.Property(null)],r.prototype,"removeUrl",void 0),i([t.Property(0)],r.prototype,"minWidth",void 0),i([t.Property(null)],r.prototype,"maxWidth",void 0),i([t.Property(0)],r.prototype,"minHeight",void 0),i([t.Property(null)],r.prototype,"maxHeight",void 0),i([t.Property(!1)],r.prototype,"resizeByPercent",void 0),r}(t.ChildProperty),cn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Complex({getImageUrl:null,url:null,uploadUrl:null},rt.AjaxSettings)],r.prototype,"ajaxSettings",void 0),i([t.Property(!1)],r.prototype,"allowDragAndDrop",void 0),i([t.Complex({visible:!0,file:["Open","|","Cut","Copy","|","Delete","Rename","|","Details"],folder:["Open","|","Cut","Copy","Paste","|","Delete","Rename","|","Details"],layout:["SortBy","View","Refresh","|","Paste","|","NewFolder","Upload","|","Details","|","SelectAll"]},rt.ContextMenuSettings)],r.prototype,"contextMenuSettings",void 0),i([t.Property("")],r.prototype,"cssClass",void 0),i([t.Complex({},rt.DetailsViewSettings)],r.prototype,"detailsViewSettings",void 0),i([t.Property(!1)],r.prototype,"enable",void 0),i([t.Complex({maxWidth:"650px",minWidth:"240px",visible:!0},rt.NavigationPaneSettings)],r.prototype,"navigationPaneSettings",void 0),i([t.Property("/")],r.prototype,"path",void 0),i([t.Property(null)],r.prototype,"rootAliasName",void 0),i([t.Complex({},rt.SearchSettings)],r.prototype,"searchSettings",void 0),i([t.Property(!0)],r.prototype,"showFileExtension",void 0),i([t.Property(!1)],r.prototype,"showHiddenItems",void 0),i([t.Property(!0)],r.prototype,"showThumbnail",void 0),i([t.Property("Ascending")],r.prototype,"sortOrder",void 0),i([t.Complex({visible:!0,items:["NewFolder","Upload","Cut","Copy","Paste","Delete","Download","Rename","SortBy","Refresh","Selection","View","Details"]},rt.ToolbarSettings)],r.prototype,"toolbarSettings",void 0),i([t.Complex({autoUpload:!0,minFileSize:0,maxFileSize:3e7,allowedExtensions:"",autoClose:!1},rt.UploadSettings)],r.prototype,"uploadSettings",void 0),i([t.Property("LargeIcons")],r.prototype,"view",void 0),r}(t.ChildProperty),ln=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property("100%")],r.prototype,"width",void 0),i([t.Property(ds)],r.prototype,"styles",void 0),i([t.Property(!0)],r.prototype,"resize",void 0),i([t.Property(0)],r.prototype,"minWidth",void 0),i([t.Property(null)],r.prototype,"maxWidth",void 0),r}(t.ChildProperty),an=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(!0)],r.prototype,"enable",void 0),i([t.Property(!1)],r.prototype,"showOnRightClick",void 0),i([t.Property("hide")],r.prototype,"actionOnScroll",void 0),i([t.Property(["Open","Edit","UnLink"])],r.prototype,"link",void 0),i([t.Property(["Replace","Align","Caption","Remove","-","InsertLink","OpenImageLink","EditImageLink","RemoveImageLink","Display","AltText","Dimension"])],r.prototype,"image",void 0),i([t.Property(["Cut","Copy","Paste"])],r.prototype,"text",void 0),i([t.Property(["TableHeader","TableRows","TableColumns","BackgroundColor","-","TableRemove","Alignments","TableCellVerticalAlign","Styles"])],r.prototype,"table",void 0),r}(t.ChildProperty),vn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(!1)],r.prototype,"prompt",void 0),i([t.Property(null)],r.prototype,"deniedAttrs",void 0),i([t.Property(["background","background-color","border","border-bottom","border-left","border-radius","border-right","border-style","border-top","border-width","clear","color","cursor","direction","display","float","font","font-family","font-size","font-weight","font-style","height","left","line-height","margin","margin-top","margin-left","margin-right","margin-bottom","max-height","max-width","min-height","min-width","overflow","overflow-x","overflow-y","padding","padding-bottom","padding-left","padding-right","padding-top","position","right","table-layout","text-align","text-decoration","text-indent","top","vertical-align","visibility","white-space","width"])],r.prototype,"allowedStyleProps",void 0),i([t.Property(null)],r.prototype,"deniedTags",void 0),i([t.Property(!0)],r.prototype,"keepFormat",void 0),i([t.Property(!1)],r.prototype,"plainText",void 0),r}(t.ChildProperty),yn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("65px")],r.prototype,"width",void 0),i([t.Property(gs)],r.prototype,"items",void 0),r}(t.ChildProperty),pn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("35px")],r.prototype,"width",void 0),i([t.Property(dd)],r.prototype,"items",void 0),r}(t.ChildProperty),wn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(null)],r.prototype,"default",void 0),i([t.Property("65px")],r.prototype,"width",void 0),i([t.Property(nh)],r.prototype,"types",void 0),r}(t.ChildProperty),bn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property("#ff0000")],r.prototype,"default",void 0),i([t.Property("Palette")],r.prototype,"mode",void 0),i([t.Property(10)],r.prototype,"columns",void 0),i([t.Property(gd)],r.prototype,"colorCode",void 0),i([t.Property(!1)],r.prototype,"modeSwitcher",void 0),r}(t.ChildProperty),kn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property("#ffff00")],r.prototype,"default",void 0),i([t.Property("Palette")],r.prototype,"mode",void 0),i([t.Property(10)],r.prototype,"columns",void 0),i([t.Property(ng)],r.prototype,"colorCode",void 0),i([t.Property(!1)],r.prototype,"modeSwitcher",void 0),r}(t.ChildProperty),dn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(th)],r.prototype,"types",void 0),r}(t.ChildProperty),gn=function(n){function r(){return null!==n&&n.apply(this,arguments)||this}return ut(r,n),i([t.Property(ih)],r.prototype,"types",void 0),r}(t.ChildProperty),fk=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ie=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ntt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return fk(i,n),ie([t.Property([])],i.prototype,"styles",void 0),ie([t.Property([])],i.prototype,"scripts",void 0),i}(t.ChildProperty),ttt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return fk(i,n),ie([t.Property(!1)],i.prototype,"enable",void 0),ie([t.Property(null)],i.prototype,"attributes",void 0),ie([t.Complex({},ntt)],i.prototype,"resources",void 0),i}(t.ChildProperty),itt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ek=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},rtt=function(n){function i(){return null!==n&&n.apply(this,arguments)||this}return itt(i,n),ek([t.Property(!1)],i.prototype,"enable",void 0),ek([t.Property(!0)],i.prototype,"onSelection",void 0),i}(t.ChildProperty),utt=function(){function n(n){this.parent=n;this.addEventListener()}return n.prototype.addEventListener=function(){this.parent.on(ho,this.enterHandler,this);this.parent.on(u,this.destroy,this)},n.prototype.destroy=function(){this.removeEventListener()},n.prototype.removeEventListener=function(){this.parent.off(ho,this.enterHandler);this.parent.off(u,this.destroy)},n.prototype.getRangeNode=function(){this.range=this.parent.getRange();this.startNode="#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement:this.range.startContainer;this.endNode="#text"===this.range.endContainer.nodeName?this.range.endContainer.parentElement:this.range.endContainer},n.prototype.enterHandler=function(n){var i=this,f,u,e,r,o;if(this.getRangeNode(),f=!0,!t.isNullOrUndefined(this.startNode.closest("TABLE"))&&!t.isNullOrUndefined(this.endNode.closest("TABLE"))){for(f=!1,u=this.startNode,e=u;!this.parent.formatter.editorManager.domNode.isBlockNode(u);)e=u,u=u.parentElement;f="TD"!==e.tagName}13===n.args.which&&"Enter"===n.args.code&&t.isNullOrUndefined(this.startNode.closest("LI"))&&t.isNullOrUndefined(this.endNode.closest("LI"))&&f&&t.isNullOrUndefined(this.startNode.closest("PRE"))&&t.isNullOrUndefined(this.endNode.closest("PRE"))&&(r=n.args.shiftKey,o={cancel:!1,name:k,requestType:r?"ShiftEnterAction":"EnterAction",originalEvent:n.args},this.parent.trigger(k,o,function(u){var c,h,s,k,w,d,p,e,l,g,nt,it,b,o,a,tt,y,rt,v;if(!u.cancel){if(i.range.startOffset!==i.range.endOffset||i.range.startContainer!==i.range.endContainer)if(i.range.deleteContents(),"#text"===i.range.startContainer.nodeName&&0===i.range.startContainer.textContent.length&&i.range.startContainer.parentElement!==i.parent.inputElement)i.range.startContainer.parentElement.innerHTML="BR"===i.parent.enterKey?"&#8203;":"<br>";else if(i.range.startContainer===i.parent.inputElement&&""===i.range.startContainer.innerHTML)i.range.startContainer.innerHTML="<br>",c=i.range.startContainer.childNodes[i.range.startOffset],i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),c,0);else if(i.parent.inputElement===i.range.startContainer){if("#text"===(c=i.range.startContainer.childNodes[i.range.startOffset]).nodeName&&0===c.textContent.length)i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),c,c.previousSibling.textContent.length);else if(i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),c,c.textContent.length>=0?0:1),0===c.previousSibling.textContent.length)t.detach(c.previousSibling);else if(0===c.textContent.length){for(h=c.previousSibling.lastChild;"#text"!==h.nodeName;)h=h.lastChild;i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,h.textContent.length);t.detach(c)}else if("BR"!==i.parent.enterKey&&0!==c.previousSibling.textContent.length&&0!==c.textContent.length)return void n.args.preventDefault();i.getRangeNode()}if(i.range.startContainer===i.range.endContainer&&i.range.startOffset===i.range.endOffset&&i.range.startContainer===i.parent.inputElement&&(i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),i.range.startContainer.childNodes[i.range.startOffset],0),i.getRangeNode()),"P"===i.parent.enterKey&&!r||"DIV"===i.parent.enterKey&&!r||"P"===i.parent.shiftEnterKey&&r||"DIV"===i.parent.shiftEnterKey&&r){if(s=void 0,s=f&&i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode)?i.startNode:i.parent.formatter.editorManager.domNode.blockParentNode(i.startNode),k=!1,w=!1,0!=i.range.startOffset&&0!=i.range.endOffset&&i.range.startContainer===i.range.endContainer&&(t.isNullOrUndefined(s.childNodes[0])||"IMG"!==s.childNodes[0].nodeName)?(d=i.range.startContainer.textContent.substring(0,i.range.startOffset),160!=d.charCodeAt(i.range.startOffset-1)&&0===d.trim().length&&(w=!0)):0===i.range.startOffset&&0===i.range.endOffset&&(w=!0),(0===i.range.startOffset&&0===i.range.endOffset||w)&&(t.isNullOrUndefined(i.range.startContainer.previousSibling)||"IMG"!==i.range.startContainer.previousSibling.nodeName&&"BR"!==i.range.startContainer.previousSibling.nodeName)){for(p=void 0,e=void 0,"IMG"===i.range.startContainer.nodeName?(e=i.createInsertElement(r),k=!0,p=!1):0!==s.textContent.trim().length?(e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!1).cloneNode(!0),p=!1):(e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!0).cloneNode(!0),p=!0),l=i.createInsertElement(r);e.firstChild;)l.appendChild(e.firstChild);if(s.parentElement.insertBefore(l,s),!p){for(h=l,g=void 0;!t.isNullOrUndefined(h)&&"#text"!==h.nodeName;)g=h,h=h.lastChild;g.innerHTML="<br>";k||t.detach(s)}i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),l.nextElementSibling,0)}else if(0===s.textContent.length&&(t.isNullOrUndefined(s.childNodes[0])||"IMG"!==s.childNodes[0].nodeName))t.isNullOrUndefined(s.children[0])||"BR"===s.children[0].tagName?((l=i.createInsertElement(r)).innerHTML="<br>",i.parent.formatter.editorManager.domNode.insertAfter(l,s),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),l,0)):(e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!1).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(e,s),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),e,e.textContent.length>=0?0:1));else if((e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,s,!0),t.isNullOrUndefined(e.childNodes[0])||"#text"!==e.childNodes[0].nodeName||0!==e.childNodes[0].textContent.length||t.detach(e.childNodes[0]),0===e.textContent.trim().length)&&(nt=i.parent.createElement("br"),"A"===i.startNode.nodeName?(it=i.startNode.parentElement,i.startNode.parentElement.insertBefore(nt,i.startNode),t.detach(i.startNode),i.startNode=it):i.startNode.appendChild(nt),"\n"===e.childNodes[0].textContent&&t.detach(e.childNodes[0]),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),i.startNode,0)),("P"===i.parent.enterKey||"DIV"===i.parent.enterKey)&&!r||("DIV"===i.parent.shiftEnterKey||"P"===i.parent.shiftEnterKey)&&r){for(b=i.createInsertElement(r);e.firstChild;)b.appendChild(e.firstChild);i.parent.formatter.editorManager.domNode.insertAfter(b,e);t.detach(e);i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode)?b:i.startNode,0)}n.args.preventDefault()}if("BR"===i.parent.enterKey&&!r||"BR"===i.parent.shiftEnterKey&&r){if(o=void 0,i.parent.formatter.editorManager.domNode.isBlockNode(i.startNode))o=i.startNode;else{for(a=i.startNode,tt=a;!i.parent.formatter.editorManager.domNode.isBlockNode(a);)tt=a,a=a.parentElement;o=a===i.parent.inputElement?tt:a}for(y=o.lastChild;!t.isNullOrUndefined(y)&&"#text"!==y.nodeName;)y=y.lastChild;if(rt=i.range.startContainer===y?i.range.startContainer.textContent.length:o.textContent.length,o!==i.parent.inputElement&&i.parent.formatter.editorManager.domNode.isBlockNode(o)&&i.range.startOffset===i.range.endOffset&&i.range.startOffset===rt)v=i.parent.createElement("br"),i.parent.formatter.editorManager.domNode.insertAfter(v,o),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),v,0);else if(t.isNullOrUndefined(o)||o===i.parent.inputElement||"BR"===o.nodeName)i.insertBRElement();else if(0===o.textContent.trim().length||1===o.textContent.trim().length&&8203===o.textContent.charCodeAt(0))e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!0).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(e,o),v=i.parent.createElement("br"),e.parentElement.insertBefore(v,e),i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),e,0);else if(e=void 0,v=i.parent.createElement("br"),0!==i.range.startOffset||0!==i.range.endOffset||t.isNullOrUndefined(o.previousSibling)||"BR"!==o.previousSibling.nodeName)i.insertBRElement();else{for(e=i.parent.formatter.editorManager.nodeCutter.SplitNode(i.range,o,!1).cloneNode(!0),i.parent.formatter.editorManager.domNode.insertAfter(v,o),i.insertFocusContent(),h=v.nextSibling;!t.isNullOrUndefined(h)&&"#text"!==h.nodeName;)h=h.lastChild;i.parent.formatter.editorManager.nodeSelection.setCursorPoint(i.parent.contentModule.getDocument(),h,0)}n.args.preventDefault()}i.parent.trigger(ft,{requestType:r?"ShiftEnterAction":"EnterAction",args:n.args})}}))},n.prototype.insertBRElement=function(){var i=!1,n=this.parent.createElement("br"),r;("BR"===this.startNode.nodeName&&"BR"===this.endNode.nodeName&&0===this.range.startOffset&&this.range.startOffset===this.range.endOffset?(this.parent.formatter.editorManager.domNode.insertAfter(n,this.startNode),i=!0):(this.startNode!==this.parent.inputElement||t.isNullOrUndefined(this.range.startContainer.previousSibling)||"BR"!==this.range.startContainer.previousSibling.nodeName||0!==this.range.startContainer.textContent.length||(i=!0),this.range.insertNode(n)),i||!t.isNullOrUndefined(n.nextElementSibling)&&"BR"===n.nextElementSibling.tagName||!t.isNullOrUndefined(n.nextSibling)&&n.nextSibling.textContent.length>0)?(this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),t.isNullOrUndefined(n.nextSibling)?n:n.nextSibling,0),i=!1):(r=this.parent.createElement("br"),this.range.insertNode(r),this.parent.formatter.editorManager.nodeSelection.setCursorPoint(this.parent.contentModule.getDocument(),n,0))},n.prototype.insertFocusContent=function(){0===this.range.startContainer.textContent.length&&("#text"===this.range.startContainer.nodeName?this.range.startContainer.parentElement.innerHTML="&#8203;":this.range.startContainer.innerHTML="&#8203;")},n.prototype.createInsertElement=function(n){var t;return"DIV"===this.parent.enterKey&&!n||"DIV"===this.parent.shiftEnterKey&&n?t=this.parent.createElement("div"):("P"===this.parent.enterKey&&!n||"P"===this.parent.shiftEnterKey&&n)&&(t=this.parent.createElement("p")),t},n}(),ftt=function(){var n=function(t,i){return n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])},n(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),vv=function(){return vv=Object.assign||function(n){for(var r,i,t=1,u=arguments.length;t<u;t++)for(i in r=arguments[t])Object.prototype.hasOwnProperty.call(r,i)&&(n[i]=r[i]);return n},vv.apply(this,arguments)},r=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ett=function(n){function i(t,i){var r=n.call(this,t,i)||this;return r.defaultResetValue=null,r.isResizeInitialized=!1,r.isFocusOut=!1,r.isRTE=!1,r.isBlur=!0,r.needsID=!0,r}return ftt(i,n),i.prototype.requiredModules=function(){var n=[];return this.toolbarSettings.enable&&(n.push({member:"toolbar",args:[this,this.serviceLocator]}),n.push({member:"link",args:[this,this.serviceLocator]}),n.push({member:"table",args:[this,this.serviceLocator]}),n.push({member:"image",args:[this,this.serviceLocator]}),this.quickToolbarSettings.enable&&n.push({member:"quickToolbar",args:[this,this.serviceLocator]})),this.showCharCount&&n.push({member:"count",args:[this,this.serviceLocator]}),"Markdown"===this.editorMode&&n.push({member:"markdownEditor",args:[this,this.serviceLocator]}),"HTML"===this.editorMode&&(n.push({member:"htmlEditor",args:[this,this.serviceLocator]}),n.push({member:"pasteCleanup",args:[this,this.serviceLocator]})),this.fileManagerSettings.enable&&n.push({member:"fileManager",args:[this,this.serviceLocator]}),this.enableResize&&n.push({member:"resize",args:[this]}),n},i.prototype.updateEnable=function(){this.enabled?(t.removeClass([this.element],is),this.element.setAttribute("aria-disabled","false"),t.isNullOrUndefined(this.htmlAttributes.tabindex)?this.inputElement.setAttribute("tabindex","0"):this.inputElement.setAttribute("tabindex",this.htmlAttributes.tabindex)):(this.getToolbar()&&(t.removeClass(this.getToolbar().querySelectorAll("."+su),su),t.removeClass([this.getToolbar()],[rs,us])),t.addClass([this.element],is),this.element.tabIndex=-1,this.element.setAttribute("aria-disabled","true"),this.inputElement.setAttribute("tabindex","-1"))},i.prototype.setEnable=function(){this.updateEnable();this.enabled?this.eventInitializer():this.unWireEvents()},i.prototype.preRender=function(){this.onBlurHandler=this.blurHandler.bind(this);this.onFocusHandler=this.focusHandler.bind(this);this.onResizeHandler=this.resizeHandler.bind(this);this.clickPoints={clientX:0,clientY:0};this.initialValue=this.value;this.serviceLocator=new wl;this.initializeServices();this.setContainer();this.persistData();t.setStyleAttribute(this.element,{width:t.formatUnit(this.width)});t.attributes(this.element,{role:"application"})},i.prototype.persistData=function(){if(this.enablePersistence&&"TEXTAREA"===this.originalElement.tagName){this.element.id=this.originalElement.id+"_wrapper";var n=window.localStorage.getItem(this.getModuleName()+this.element.id);t.isNullOrUndefined(n)||""===n||this.setProperties(JSON.parse(n),!0)}},i.prototype.setContainer=function(){var r;this.originalElement=this.element.cloneNode(!0);null!==this.value&&null===this.valueTemplate||this.setValue();this.element.hasAttribute("tabindex")&&(this.htmlAttributes={tabindex:this.element.getAttribute("tabindex")},this.element.removeAttribute("tabindex"));this.element.innerHTML="";for(var u=["class","style","id","ejs-for"],i={},n=0;n<this.element.attributes.length;n++)-1!==u.indexOf(this.element.attributes[n].name)||/^data-val/.test(this.element.attributes[n].name)||(i[this.element.attributes[n].name]=this.element.getAttribute(this.element.attributes[n].name));(t.extend(i,this.htmlAttributes,i),this.setProperties({htmlAttributes:i},!0),t.isNullOrUndefined(this.htmlAttributes.id)||(this.element.id=this.htmlAttributes.id),"TEXTAREA"===this.element.tagName)?(r=this.createElement("div",{className:this.element.getAttribute("class")}),this.element.innerHTML="",this.element.parentElement.insertBefore(r,this.element),this.valueContainer=this.element,t.removeClass([this.valueContainer],this.element.getAttribute("class").split(" ")),this.element=r):this.valueContainer=this.createElement("textarea",{id:this.getID()+"-value"});this.valueContainer.name=this.getID();t.addClass([this.valueContainer],kc);this.element.appendChild(this.valueContainer)},i.prototype.getPersistData=function(){return this.addOnPersist(["value"])},i.prototype.focusIn=function(){this.enabled&&(this.inputElement.focus(),this.focusHandler({}))},i.prototype.focusOut=function(){this.enabled&&(this.inputElement.blur(),this.blurHandler({}))},i.prototype.selectAll=function(){this.notify(gr,{})},i.prototype.selectRange=function(n){this.notify(ef,{range:n})},i.prototype.getSelection=function(){var n="";return this.notify(nu,{callBack:function(t){n=t}}),n},i.prototype.executeCommand=function(n,t,i){var u,r;(t=this.htmlPurifier(n,t),"HTML"===this.editorMode)&&(u=this.getRange(),this.iframeSettings.enable&&this.formatter.editorManager.nodeSelection.Clear(this.element.ownerDocument),(this.iframeSettings.enable&&u.startContainer===this.inputElement||!this.inputElement.contains(u.startContainer))&&this.focusIn());r=uk[n];i&&i.undo&&i.undo&&0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData();this.formatter.editorManager.execCommand(r.command,r.subCommand?r.subCommand:t||r.value,null,null,t||r.value,t||r.value);i&&i.undo&&(this.formatter.saveData(),this.formatter.enableUndo(this));this.setPlaceHolder();this.notify(sr,{})},i.prototype.htmlPurifier=function(n,i){var o,f,r,s,e,u;if("HTML"===this.editorMode)switch(n){case"insertHTML":this.enableHtmlSanitizer&&(i="string"==typeof i?this.htmlEditorModule.sanitizeHelper(i):this.htmlEditorModule.sanitizeHelper(i.outerHTML));break;case"insertTable":t.isNullOrUndefined(i.width)&&(i.width={minWidth:this.tableSettings.minWidth,maxWidth:this.tableSettings.maxWidth,width:this.tableSettings.width});break;case"insertImage":o=this.createElement("img",{attrs:{src:i.url}});f=o.outerHTML;this.enableHtmlSanitizer&&(f=this.htmlEditorModule.sanitizeHelper(o.outerHTML));r=""!==f&&this.createElement("div",{innerHTML:f}).firstElementChild.getAttribute("src")||null;r=t.isNullOrUndefined(r)?"":r;i.url=r;t.isNullOrUndefined(i.width)&&(i.width={minWidth:this.insertImageSettings.minWidth,maxWidth:this.insertImageSettings.maxWidth,width:this.insertImageSettings.width});t.isNullOrUndefined(i.height)&&(i.height={minHeight:this.insertImageSettings.minHeight,maxHeight:this.insertImageSettings.maxHeight,height:this.insertImageSettings.height});break;case"createLink":s=this.createElement("a",{attrs:{href:i.url}});e=s.outerHTML;this.enableHtmlSanitizer&&(e=this.htmlEditorModule.sanitizeHelper(s.outerHTML));u=""!==e&&this.createElement("div",{innerHTML:e}).firstElementChild.getAttribute("href")||null;u=t.isNullOrUndefined(u)?"":u;i.url=u}return i},i.prototype.encode=function(n){var t=this.createElement("div");return t.innerText=n.trim(),t.innerHTML.replace(/<br\s*[\/]?>/gi,"\n")},i.prototype.render=function(){this.value&&!this.valueTemplate&&this.setProperties({value:this.serializeValue(this.value)},!0);this.renderModule=new tk(this,this.serviceLocator);this.sourceCodeModule=new ik(this,this.serviceLocator);this.notify(or,{});this.trigger(pv);this.RTERender();new ew(this);this.notify(c,{});this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0);this.toolbarSettings.enable&&"Expand"===this.toolbarSettings.type&&!t.isNullOrUndefined(this.getToolbar())&&this.toolbarSettings.items.indexOf("Undo")>-1&&this.toolbarSettings.items.indexOf("Redo")>-1&&this.disableToolbarItem(["Undo","Redo"]);this.setContentHeight();null!==this.value&&(this.valueContainer.defaultValue=this.value);this.enabled?this.eventInitializer():this.unWireEvents();this.renderComplete()},i.prototype.eventInitializer=function(){this.wireEvents()},i.prototype.keyDown=function(n){var i,o,s,h,e,f;if(this.notify(p,{member:"keydown",args:n}),this.restrict(n),"HTML"===this.editorMode&&(8===n.which&&"Backspace"===n.code||46===n.which&&"Delete"===n.code))if(i=this.getRange(),o="#text"===i.startContainer.nodeName?i.startContainer.parentElement:i.startContainer,t.closest(o,"pre")&&8===n.which&&8203===i.startContainer.textContent.charCodeAt(i.startOffset-1)||46===n.which&&8203===i.startContainer.textContent.charCodeAt(i.startOffset))s=new RegExp(String.fromCharCode(8203),"g"),h=8===n.which?i.startOffset-1:i.startOffset,i.startContainer.textContent=i.startContainer.textContent.replace(s,""),this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,h);else if("Backspace"===n.code&&8===n.which&&8203===i.startContainer.textContent.charCodeAt(0)&&i.collapsed){for(var u=i.startContainer.parentElement,c=void 0,r=void 0,r=0;r<u.childNodes.length;r++)u.childNodes[r]===i.startContainer&&(c=r);for(e=!0,f=[],r=c;r>=0;r--)3===u.childNodes[r].nodeType&&8203===u.childNodes[r].textContent.charCodeAt(0)&&e?f.push(r):e=!1;if(f.length>0)for(r=f.length-1;r>0;r--)u.childNodes[f[r]].textContent="";this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),i.startContainer,i.startOffset)}if(0===this.formatter.getUndoRedoStack().length&&this.formatter.saveData(),"insert-link"!==n.action&&(n.action&&"paste"!==n.action&&"space"!==n.action||9===n.which||"Backspace"===n.code&&8===n.which))switch(this.formatter.process(this,null,n),n.action){case"toolbar-focus":this.toolbarSettings.enable&&this.toolbarModule.baseToolbar.toolbarObj.element.querySelector('.e-toolbar-item[aria-disabled="false"][title] [tabindex]').focus();break;case"escape":this.contentModule.getEditPanel().focus()}t.isNullOrUndefined(this.placeholder)||(t.isNullOrUndefined(this.placeHolderWrapper)||1===this.inputElement.textContent.length?this.setPlaceHolder():this.placeHolderWrapper.style.display="none");this.autoResize()},i.prototype.keyUp=function(n){this.notify(ct,{member:"keyup",args:n});"KeyX"===n.code&&88===n.which&&88===n.keyCode&&n.ctrlKey&&(""===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML)&&(this.inputElement.innerHTML=df(oh(this),this));var i=32===n.which||13===n.which||8===n.which||46===n.which;("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||i||"Markdown"===this.editorMode&&("shift"!==n.key&&!n.ctrlKey&&n.key&&1===n.key.length||i)&&!this.inlineMode.enable)&&this.formatter.onKeyHandler(this,n);(this.inputElement&&0!==this.inputElement.textContent.length||this.element.querySelectorAll(".e-toolbar-item.e-active").length>0)&&this.notify(ti,{args:n});t.isNullOrUndefined(this.placeholder)||"Enter"===n.key&&13===n.keyCode||"<p><br><\/p>"!==this.inputElement.innerHTML&&"<div><br><\/div>"!==this.inputElement.innerHTML&&"<br>"!==this.inputElement.innerHTML||this.setPlaceHolder()},i.prototype.serializeValue=function(n){return"HTML"!==this.editorMode||t.isNullOrUndefined(n)||(this.enableHtmlEncode?(n=this.htmlEditorModule.sanitizeHelper(pt(n)),n=this.encode(n)):n=this.htmlEditorModule.sanitizeHelper(n)),n},i.prototype.sanitizeHtml=function(n){return this.serializeValue(n)},i.prototype.updateValue=function(n){if(t.isNullOrUndefined(n)){var i=this.inputElement.innerHTML;this.setProperties({value:nw(i)?null:i})}else this.setProperties({value:n})},i.prototype.triggerEditArea=function(n){if(o()){var t=n.touches?n.changedTouches[0]:n;this.clickPoints.clientX===t.clientX&&this.clickPoints.clientY===t.clientY&&this.notify(ui,{member:"editAreaClick",args:n})}else this.notify(ui,{member:"editAreaClick",args:n})},i.prototype.notifyMouseUp=function(n){var t=n.touches?n.changedTouches[0]:n;this.notify(cr,{member:"mouseUp",args:n,touchData:{prevClientX:this.clickPoints.clientX,prevClientY:this.clickPoints.clientY,clientX:t.clientX,clientY:t.clientY}});this.inputElement&&("HTML"===this.editorMode&&0!==this.inputElement.textContent.length||"Markdown"===this.editorMode&&0!==this.inputElement.value.length)&&this.notify(ti,{args:n});this.triggerEditArea(n)},i.prototype.mouseUp=function(n){var r,u,i,f;this.quickToolbarSettings.showOnRightClick&&t.Browser.isDevice&&(r=n.target,u=t.closest(r,"table"),r&&"A"===r.nodeName||"IMG"===r.nodeName||"TD"===r.nodeName||"TH"===r.nodeName||"TABLE"===r.nodeName||u&&this.contentModule.getEditPanel().contains(u))||(this.notifyMouseUp(n),3===n.detail)&&(i=this.getRange(),f=this.formatter.editorManager.domNode.getSelection(),/\s+$/.test(f.toString())&&((t.isNullOrUndefined(i.startContainer.parentElement)||(t.isNullOrUndefined(i.startContainer.parentElement.nextSibling)||3===i.startContainer.parentElement.nextSibling.nodeType&&!/\s+$/.test(i.startContainer.parentElement.nextSibling.textContent))&&i.startOffset!==i.endOffset)&&"li"!==i.startContainer.parentElement.tagName.toLocaleLowerCase()||(i.setStart(i.startContainer,i.startOffset),i.setEnd(i.startContainer,i.startContainer.textContent.length))))},i.prototype.ensureModuleInjected=function(n){return this.getInjectedModules().indexOf(n)>=0},i.prototype.onCopy=function(){this.contentModule.getDocument().execCommand("copy",!1,null)},i.prototype.onCut=function(){this.contentModule.getDocument().execCommand("cut",!1,null)},i.prototype.onPaste=function(n){var i=this,r={originalEvent:n,cancel:!1,requestType:"Paste"};this.trigger(k,r,function(r){var f=i.getText().trim().length-i.getSelection().length+(t.isNullOrUndefined(n)||t.isNullOrUndefined(n.clipboardData)?0:n.clipboardData.getData("text/plain").length),o;if("Markdown"!==i.editorMode)if(!r.cancel&&"true"===i.inputElement.contentEditable&&(-1===i.maxLength||f<=i.maxLength))if(t.isNullOrUndefined(i.pasteCleanupModule)){var s={requestType:"Paste",editorMode:i.editorMode,event:n},u=null,e=!1;n&&!t.isNullOrUndefined(n.clipboardData)&&(u=n.clipboardData.getData("text/plain"),e=n.clipboardData.getData("text/html").indexOf("MsoNormal")>0);o=n&&n.clipboardData&&n.clipboardData.items.length>0?n.clipboardData.items[0].getAsFile():null;null!==u&&i.notify(di,{file:o,args:n,text:u,isWordPaste:e});setTimeout(function(){i.formatter.onSuccess(i,s)},0)}else i.notify(so,{args:n});else n.preventDefault();else-1===i.maxLength||f<=i.maxLength||n.preventDefault()})},i.prototype.clipboardAction=function(n,t){switch(n.toLowerCase()){case"cut":this.onCut();this.formatter.onSuccess(this,{requestType:"Cut",editorMode:this.editorMode,event:t});break;case"copy":this.onCopy();this.formatter.onSuccess(this,{requestType:"Copy",editorMode:this.editorMode,event:t});break;case"paste":this.onPaste(t)}},i.prototype.destroy=function(){var i,r;if(!this.isDestroyed&&this.isRendered)if(null!==this.element.offsetParent||t.isNullOrUndefined(this.toolbarModule)){if(this.notify(u,{}),this.destroyDependentModules(),t.isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),this.unWireEvents(),"TEXTAREA"===this.originalElement.tagName){for(this.element.parentElement.insertBefore(this.valueContainer,this.element),this.valueContainer.id=this.getID(),this.valueContainer.removeAttribute("name"),t.detach(this.element),""!==this.originalElement.innerHTML.trim()?(this.valueContainer.value=this.originalElement.innerHTML.trim(),this.setProperties({value:t.isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.valueContainer.value=this.valueContainer.defaultValue,this.element=this.valueContainer,i=0;i<this.originalElement.classList.length;i++)t.addClass([this.element],this.originalElement.classList[i]);t.removeClass([this.element],kc)}else""!==this.originalElement.innerHTML.trim()?(this.element.innerHTML=this.originalElement.innerHTML.trim(),this.setProperties({value:t.isNullOrUndefined(this.initialValue)?null:this.initialValue},!0)):this.element.innerHTML="";if(this.placeholder&&this.placeHolderWrapper&&(this.placeHolderWrapper=null),!t.isNullOrUndefined(this.cssClass))for(r=this.cssClass.split(" "),i=0;i<r.length;i++)""!==r[i].trim()&&t.removeClass([this.element],r[i]);this.removeHtmlAttributes();this.removeAttributes();n.prototype.destroy.call(this);this.isRendered=!1;this.enablePersistence&&window.localStorage.removeItem(this.getModuleName()+this.element.id)}else this.toolbarModule.destroy()},i.prototype.removeHtmlAttributes=function(){if(this.htmlAttributes)for(var t=Object.keys(this.htmlAttributes),n=0;n<t.length&&this.element.hasAttribute(t[n]);n++)this.element.removeAttribute(t[n])},i.prototype.removeAttributes=function(){this.enabled||t.removeClass([this.element],is);this.enableRtl&&t.removeClass([this.element],ts);this.readonly&&t.removeClass([this.element],cu);""!==this.element.style.width&&""===this.originalElement.style.width&&this.element.style.removeProperty("width");""!==this.element.style.height&&""===this.originalElement.style.height&&this.element.style.removeProperty("height");this.element.removeAttribute("aria-disabled");this.element.removeAttribute("role");this.element.removeAttribute("tabindex")},i.prototype.destroyDependentModules=function(){this.renderModule.destroy();this.formatter.editorManager.undoRedoManager.destroy();this.sourceCodeModule.destroy()},i.prototype.getContent=function(){return this.contentModule.getPanel()},i.prototype.getText=function(){return this.contentModule.getText()},i.prototype.getSelectedHtml=function(){var n=this.createElement("div"),t=this.contentModule.getDocument().getSelection(),i;return t.rangeCount>0&&(i=t.getRangeAt(0).cloneContents(),n.appendChild(i)),n.innerHTML},i.prototype.showInlineToolbar=function(){if(this.inlineMode.enable){var n=this.getRange(),t="#text"===n.endContainer.nodeName?n.endContainer.parentElement:n.endContainer,i=n.getClientRects()[0].left,r=n.getClientRects()[0].top;this.quickToolbarModule.showInlineQTBar(i,r,t)}},i.prototype.hideInlineToolbar=function(){this.quickToolbarModule.hideInlineQTBar()},i.prototype.getModuleName=function(){return"richtexteditor"},i.prototype.onPropertyChanged=function(i,r){for(var u,f,c,s,l,e,o=0,h=Object.keys(i);o<h.length;o++){u=h[o];switch(u){case"enterKey":case"value":f="enterKey"===u?null===this.value||"<div><br><\/div>"===this.value||"<p><br><\/p>"===this.value||"<br>"===this.value?null:this.value:i[u];c="HTML"===this.editorMode?df(f,this):f;(t.isNullOrUndefined(f)||""===f)&&"enterKey"!==u||(this.value=this.serializeValue(this.enableHtmlEncode?this.encode(pt(c)):c));this.updatePanelValue();this.setPlaceHolder();this.notify(iu,{module:"XhtmlValidation",newProp:i,oldProp:r});this.enableXhtml&&this.setProperties({value:this.getXhtml()},!0);this.showCharCount&&this.countModule.refresh();break;case"valueTemplate":this.setValue();this.showCharCount&&this.countModule.refresh();break;case"width":this.setWidth(i[u]);this.toolbarSettings.enable&&(this.toolbarModule.refreshToolbarOverflow(),this.resizeHandler());break;case"height":this.setHeight(i[u]);this.setContentHeight();this.autoResize();break;case"readonly":this.setReadOnly(!1);break;case"cssClass":this.element.classList.remove(r[u]);this.setCssClass(i[u]);break;case"enabled":this.setEnable();break;case"enableRtl":this.updateRTL();break;case"placeholder":this.placeholder=i[u];this.setPlaceHolder();break;case"htmlAttributes":gh(this.htmlAttributes,this,!1,!1);break;case"iframeSettings":s=r[u];s.resources&&(l=this.contentModule.getDocument().querySelector("head"),e=void 0,s.resources.scripts&&(e=l.querySelectorAll("."+uc),this.removeSheets(e)),s.resources.styles&&(e=l.querySelectorAll("."+fc),this.removeSheets(e)));this.setIframeSettings();break;case"locale":n.prototype.refresh.call(this);break;case"inlineMode":this.notify(a,{module:"quickToolbar",newProp:i,oldProp:r});this.setContentHeight();break;case"toolbarSettings":this.notify(a,{module:"toolbar",newProp:i,oldProp:r});this.setContentHeight();break;case"maxLength":this.showCharCount&&this.countModule.refresh();break;case"showCharCount":i[u]&&this.countModule?this.countModule.renderCount():!1===i[u]&&this.countModule&&this.countModule.destroy();break;case"enableHtmlEncode":this.updateValueData();this.updatePanelValue();this.setPlaceHolder();this.showCharCount&&this.countModule.refresh();break;case"undoRedoSteps":case"undoRedoTimer":this.formatter.editorManager.observer.notify(vh,{newProp:i,oldProp:r});break;case"enableXhtml":this.notify(iu,{module:"XhtmlValidation",newProp:i,oldProp:r});break;case"quickToolbarSettings":i.quickToolbarSettings.showOnRightClick?this.wireContextEvent():this.unWireContextEvent();this.notify(a,{newProp:i,oldProp:r});break;default:this.notify(a,{newProp:i,oldProp:r})}}},i.prototype.updateValueData=function(){this.enableHtmlEncode?this.setProperties({value:this.encode(pt(this.inputElement.innerHTML))},!0):this.setProperties({value:/<[a-z][\s\S]*>/i.test(this.inputElement.innerHTML)?this.inputElement.innerHTML:pt(this.inputElement.innerHTML)})},i.prototype.removeSheets=function(n){for(var i=0;i<n.length;i++)t.detach(n[i])},i.prototype.updatePanelValue=function(){var n=this.value,t;n=this.enableHtmlEncode&&this.value?pt(n):n;t=this.element.querySelector(".e-rte-srctextarea");n?(t&&"block"===t.style.display&&(t.value=this.value),this.valueContainer&&(this.valueContainer.value=this.enableHtmlEncode?this.value:n),"HTML"===this.editorMode&&this.inputElement&&this.inputElement.innerHTML.trim()!==n.trim()?this.inputElement.innerHTML=n:"Markdown"===this.editorMode&&this.inputElement&&this.inputElement.value.trim()!==n.trim()&&(this.inputElement.value=n)):(t&&"block"===t.style.display&&(t.value=""),"HTML"===this.editorMode?"DIV"===this.enterKey?this.inputElement.innerHTML="<div><br/><\/div>":"BR"===this.enterKey?this.inputElement.innerHTML="<br/>":(this.inputElement.innerHTML="<p><br/><\/p>",""===n&&this.formatter&&this.inputElement&&this.formatter.editorManager.nodeSelection.setCursorPoint(this.contentModule.getDocument(),this.inputElement.firstElementChild,this.inputElement.firstElementChild.childElementCount)):this.inputElement.value="",this.valueContainer&&(this.valueContainer.value=""));this.showCharCount&&this.countModule.refresh()},i.prototype.setHeight=function(n){this.element.style.height="auto"!==n?t.formatUnit(n):"auto";"Expand"===this.toolbarSettings.type&&("string"==typeof this.height&&this.height.indexOf("px")>-1||"number"==typeof this.height)?this.element.classList.add(fl):this.element.classList.remove(fl)},i.prototype.setPlaceHolder=function(){this.inputElement&&this.placeholder&&!0!==this.iframeSettings.enable&&("Markdown"!==this.editorMode?(this.placeHolderWrapper||(this.placeHolderWrapper=this.createElement("span",{className:"rte-placeholder e-rte-placeholder"}),this.inputElement&&this.inputElement.parentElement.insertBefore(this.placeHolderWrapper,this.inputElement),t.attributes(this.placeHolderWrapper,{style:"font-size: 14px; padding: 16px; margin-left: 0px; margin-right: 0px;"})),this.placeHolderWrapper.innerHTML=this.placeholder,this.placeHolderWrapper.style.display=0!==this.inputElement.textContent.length||t.isNullOrUndefined(this.inputElement.firstChild)||"BR"!==this.inputElement.firstChild.nodeName&&("P"!==this.inputElement.firstChild.nodeName&&"DIV"!==this.inputElement.firstChild.nodeName||t.isNullOrUndefined(this.inputElement.firstChild.firstChild)||"BR"!==this.inputElement.firstChild.firstChild.nodeName)?"none":"block"):this.inputElement.setAttribute("placeholder",this.placeholder))},i.prototype.setWidth=function(n){"auto"!==n?t.setStyleAttribute(this.element,{width:t.formatUnit(this.width)}):this.element.style.width="auto"},i.prototype.setCssClass=function(n){if(!t.isNullOrUndefined(n))for(var r=n.split(" "),i=0;i<r.length;i++)""!==r[i].trim()&&this.element.classList.add(r[i])},i.prototype.updateRTL=function(){this.notify(ii,{enableRtl:this.enableRtl});this.enableRtl?this.element.classList.add(ts):this.element.classList.remove(ts)},i.prototype.updateReadOnly=function(){this.notify(tu,{editPanel:this.inputElement,mode:this.readonly})},i.prototype.setReadOnly=function(n){this.updateReadOnly();n||(this.readonly&&this.enabled?this.unbindEvents():this.enabled&&this.bindEvents())},i.prototype.print=function(){var n,i=this,r={element:this.inputElement,requestType:"print",cancel:!1};this.trigger(k,r,function(r){n=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth);"msie"===t.Browser.info.name&&n.resizeTo(screen.availWidth,screen.availHeight);n=t.print(i.inputElement,n);r.cancel||i.trigger(ft,{requestType:"print"})})},i.prototype.refreshUI=function(){this.renderModule.refresh()},i.prototype.showFullScreen=function(){this.fullScreenModule.showFullScreen()},i.prototype.enableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!0,t)},i.prototype.disableToolbarItem=function(n,t){this.toolbarModule.enableTBarItems(this.getBaseToolbarObject(),n,!1,t)},i.prototype.removeToolbarItem=function(n){this.toolbarModule.removeTBarItems(n)},i.prototype.getRange=function(){return this.formatter.editorManager.nodeSelection.getRange(this.contentModule.getDocument())},i.prototype.initializeServices=function(){this.serviceLocator.register("rendererFactory",new bl);this.serviceLocator.register("rteLocale",this.localeObj=new t.L10n(this.getModuleName(),tg,this.locale));this.serviceLocator.register("dialogRenderObject",new rk(this))},i.prototype.RTERender=function(){var n=this.serviceLocator.getService("rendererFactory");this.contentModule=n.getRenderer(f.Content);this.fullScreenModule=new av(this);this.enterKeyModule=new utt(this);this.renderModule.render();this.inputElement=this.contentModule.getEditPanel();this.setHeight(this.height);gh(this.htmlAttributes,this,!1,!0);this.iframeSettings&&this.setIframeSettings();this.setCssClass(this.cssClass);this.updateEnable();this.setPlaceHolder();this.updateRTL();this.updateReadOnly();this.updatePanelValue();this.enableHtmlEncode&&!t.isNullOrUndefined(this.value)&&this.setProperties({value:this.encode(pt(this.value))})},i.prototype.setIframeSettings=function(){if(this.iframeSettings.resources){var n=this.iframeSettings.resources.styles,t=this.iframeSettings.resources.scripts;this.iframeSettings.resources.scripts.length>0&&this.InjectSheet(!0,t);this.iframeSettings.resources.styles.length>0&&this.InjectSheet(!1,n)}this.iframeSettings.attributes&&gh(this.iframeSettings.attributes,this,!0,!1)},i.prototype.InjectSheet=function(n,t){var r,i,u,f;try{if(t&&t.length>0)for(r=this.contentModule.getDocument().querySelector("head"),i=0;i<t.length;i++)n?(u=this.createScriptElement(),u.src=t[i],r.appendChild(u)):(f=this.createStyleElement(),f.href=t[i],r.appendChild(f))}catch(n){return}},i.prototype.createScriptElement=function(){var n=this.createElement("script",{className:uc});return n.type="text/javascript",n},i.prototype.createStyleElement=function(){var n=this.createElement("link",{className:fc});return n.rel="stylesheet",n},i.prototype.setValue=function(){var r,n,u,i;if(this.valueTemplate)if("string"==typeof this.valueTemplate)this.setProperties({value:this.valueTemplate});else{for(r=t.compile(this.valueTemplate)("",this,"valueTemplate"),n=0;n<r.length;n++)u=r[n],t.append([u],this.element);this.setProperties({value:this.element.innerHTML.trim()})}else i=!t.isNullOrUndefined(this.element.innerHTML)&&this.element.innerHTML.replace(/<(\/?|\!?)(!--!--)>/g,"").trim(),""!==i&&("TEXTAREA"===this.element.tagName?this.setProperties({value:pt(i)}):this.setProperties({value:i}))},i.prototype.updateResizeFlag=function(){this.isResizeInitialized=!0},i.prototype.getInsertImgMaxWidth=function(){var i=this.insertImageSettings.maxWidth,r=this.contentModule.getEditPanel(),n=window.getComputedStyle(r),u=r.offsetWidth-(14+parseFloat(n.paddingLeft.split("px")[0])+parseFloat(n.paddingRight.split("px")[0])+parseFloat(n.marginLeft.split("px")[0])+parseFloat(n.marginRight.split("px")[0]));return t.isNullOrUndefined(i)?u:i},i.prototype.setContentHeight=function(n,i){var r,s,u=0,c="string"==typeof this.height&&this.height.indexOf("%")>-1,l=this.sourceCodeModule.getPanel()&&"block"===this.sourceCodeModule.getPanel().parentElement.style.display?this.sourceCodeModule.getPanel().parentElement:this.contentModule.getPanel(),f=this.element.offsetHeight,v,p;0!==f||"auto"===this.height||this.getToolbar()||(f=parseInt(this.height,10),c&&(s=this.height));var e=this.getToolbar()?this.toolbarModule.getToolbarHeight():0,a=this.element.querySelector("."+dc),o=this.enableResize?t.isNullOrUndefined(a)?0:a.offsetHeight+8:0,h=this.getToolbar()?this.toolbarModule.getExpandTBarPopHeight():0;(this.toolbarSettings.type===y.Expand&&i&&"preview"!==n?(r="auto"===this.height&&0===o?"auto":f-(e+h+o)+"px",u=this.toolbarSettings.enableFloating?0:h):r="auto"!==this.height||this.element.classList.contains("e-rte-full-screen")||this.isResizeInitialized?c&&s?s:f-(e+o)+"px":"auto","windowResize"!==n&&(this.iframeSettings.enable?"auto"!==r&&t.setStyleAttribute(l,{height:r,marginTop:u+"px"}):t.setStyleAttribute(l,{height:r,marginTop:u+"px"})),this.iframeSettings.enable&&"sourceCode"===n)&&(v=t.select("."+hc,this.element),t.setStyleAttribute(v,{height:r,marginTop:u+"px"}));this.toolbarSettings.enableFloating&&this.getToolbar()&&!this.inlineMode.enable&&(p=(i?e+h:e)+"px",t.setStyleAttribute(this.getToolbar().parentElement,{height:p}));0===o&&this.autoResize()},i.prototype.getHtml=function(){return this.serializeValue(this.contentModule.getEditPanel().innerHTML)},i.prototype.getXhtml=function(){var n=this.value;return!t.isNullOrUndefined(n)&&this.enableXhtml&&(n=this.htmlEditorModule.xhtmlValidation.selfEncloseValidation(n)),n},i.prototype.showSourceCode=function(){this.readonly||this.notify(ki,{})},i.prototype.getCharCount=function(){var n="Markdown"===this.editorMode?this.inputElement.value.trim():this.inputElement.textContent.trim();return"Markdown"!==this.editorMode&&-1!==n.indexOf("​")?n.replace(/\u200B/g,"").length:n.length},i.prototype.showDialog=function(n){n===ri.InsertLink?this.notify(po,{}):n===ri.InsertImage?this.notify(bo,{}):n===ri.InsertTable&&this.notify(go,{})},i.prototype.closeDialog=function(n){n===ri.InsertLink?this.notify(wo,{}):n===ri.InsertImage?this.notify(ko,{}):n===ri.InsertTable&&this.notify(ns,{})},i.prototype.getBaseToolbarObject=function(){return!this.inlineMode.enable||t.Browser.isDevice&&!o()?this.toolbarModule&&this.toolbarModule.getBaseToolbar():this.quickToolbarModule&&this.quickToolbarModule.getInlineBaseToolbar()},i.prototype.getToolbar=function(){return this.toolbarModule?this.toolbarModule.getToolbarElement():null},i.prototype.getToolbarElement=function(){return this.toolbarModule&&this.toolbarModule.getToolbarElement()},i.prototype.getID=function(){return"TEXTAREA"===this.originalElement.tagName?this.valueContainer.id:this.element.id},i.prototype.mouseDownHandler=function(n){var i=n.touches?n.changedTouches[0]:n;t.addClass([this.element],[hs]);this.preventDefaultResize(n);this.notify(nt,{args:n});this.clickPoints={clientX:i.clientX,clientY:i.clientY}},i.prototype.preventImgResize=function(n){"img"===n.target.nodeName.toLocaleLowerCase()&&n.preventDefault()},i.prototype.preventDefaultResize=function(){"msie"===t.Browser.info.name?this.contentModule.getEditPanel().addEventListener("mscontrolselect",this.preventImgResize):"mozilla"===t.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!1,"false"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!1,"false"))},i.prototype.defaultResize=function(){"msie"===t.Browser.info.name?this.contentModule.getEditPanel().removeEventListener("mscontrolselect",this.preventImgResize):"mozilla"===t.Browser.info.name&&(this.contentModule.getDocument().execCommand("enableObjectResizing",!0,"true"),this.contentModule.getDocument().execCommand("enableInlineTableEditing",!0,"true"))},i.prototype.resizeHandler=function(){var n=!1;document.body.contains(this.element)?(this.toolbarSettings.enable&&!this.inlineMode.enable&&(this.toolbarModule.refreshToolbarOverflow(),n=this.toolbarModule.baseToolbar.toolbarObj.element.classList.contains(yi)),this.setContentHeight("windowResize",n),this.notify(ae,null)):document.defaultView.removeEventListener("resize",this.onResizeHandler,!0)},i.prototype.scrollHandler=function(n){this.notify(li,{args:n})},i.prototype.contentScrollHandler=function(n){this.notify(wr,{args:n})},i.prototype.focusHandler=function(n){var u,f,i,r;if(!this.isRTE||this.isFocusOut){if(this.isRTE=!this.isFocusOut,this.isFocusOut=!1,t.addClass([this.element],[hs]),this.cloneValue="HTML"===this.editorMode?"<p><br><\/p>"===this.inputElement.innerHTML||"<div><br><\/div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(pt(this.inputElement.innerHTML)):this.inputElement.innerHTML:""===this.inputElement.value?null:this.inputElement.value,u=document.activeElement,(u===this.element||u===this.getToolbarElement()||u===this.contentModule.getEditPanel()||this.iframeSettings.enable&&u===this.contentModule.getPanel()&&n.target&&!n.target.classList.contains("e-img-inner")&&n.target&&n.target.parentElement&&!n.target.parentElement.classList.contains("e-img-wrap")||t.closest(u,".e-rte-toolbar")===this.getToolbarElement())&&(this.contentModule.getEditPanel().focus(),!t.isNullOrUndefined(this.getToolbarElement())))for(this.getToolbarElement().setAttribute("tabindex","-1"),f=this.getToolbarElement().querySelectorAll('[tabindex="0"]'),i=0;i<f.length;i++)f[i].setAttribute("tabindex","-1");this.preventDefaultResize(n);this.trigger("focus",{event:n,isInteracted:0!==Object.keys(n).length});!t.isNullOrUndefined(this.saveInterval)&&this.saveInterval>0&&!this.autoSaveOnIdle&&(this.timeInterval=setInterval(this.updateValueOnIdle.bind(this),this.saveInterval));t.EventHandler.add(document,"mousedown",this.onDocumentClick,this)}if(!t.isNullOrUndefined(this.getToolbarElement()))for(r=this.getToolbarElement().querySelectorAll("input,select,button,a,[tabindex]"),i=0;i<r.length;i++)r[i].classList.contains("e-rte-dropdown-btn")||r[i].classList.contains("e-insert-table-btn")||r[i].hasAttribute("tabindex")&&"-1"===r[i].getAttribute("tabindex")||r[i].setAttribute("tabindex","-1")},i.prototype.getUpdatedValue=function(){var n,i;return t.isNullOrUndefined(this.tableModule)||this.tableModule.removeResizeElement(),i=this.element.querySelector(".e-rte-srctextarea"),"HTML"===this.editorMode?(n="<p><br><\/p>"===this.inputElement.innerHTML||"<div><br><\/div>"===this.inputElement.innerHTML||"<br>"===this.inputElement.innerHTML?null:this.enableHtmlEncode?this.encode(pt(this.inputElement.innerHTML)):this.inputElement.innerHTML,i&&"block"===i.style.display&&(n=i.value)):n=""===this.inputElement.value?null:this.inputElement.value,n},i.prototype.updateValueOnIdle=function(){(t.isNullOrUndefined(this.tableModule)||t.isNullOrUndefined(this.inputElement.querySelector(".e-table-box.e-rbox-select")))&&(this.setProperties({value:this.getUpdatedValue()},!0),this.valueContainer.value=this.value,this.invokeChangeEvent())},i.prototype.updateIntervalValue=function(){clearTimeout(this.idleInterval);this.idleInterval=setTimeout(this.updateValueOnIdle.bind(this),0)},i.prototype.updateStatus=function(n){if(!t.isNullOrUndefined(n.html)||!t.isNullOrUndefined(n.markdown)){var i=this.formatter.editorManager.undoRedoManager.getUndoStatus(),r={undo:i.undo,redo:i.redo,html:n.html,markdown:n.markdown};this.trigger(bv,r)}},i.prototype.onDocumentClick=function(n){var i=n.target,r=t.closest(i,"."+rc);this.element.contains(n.target)||document===n.target||r===this.element||t.closest(i,'[aria-owns="'+this.getID()+'"]')||(this.isBlur=!0,this.isRTE=!1);this.notify(fo,{args:n});n.detail>3&&n.preventDefault()},i.prototype.blurHandler=function(n){var i=n.relatedTarget,r,u;i&&(r=t.closest(i,"."+rc),r&&r===this.element?(this.isBlur=!1,i===this.getToolbarElement()&&i.setAttribute("tabindex","-1")):t.closest(i,'[aria-owns="'+this.getID()+'"]')?this.isBlur=!1:(this.isBlur=!0,i=null));this.isBlur&&t.isNullOrUndefined(i)?(t.removeClass([this.element],[hs]),this.notify(dr,{}),u=this.getUpdatedValue(),this.setProperties({value:u}),this.notify(ti,{args:n,documentNode:document}),this.invokeChangeEvent(),this.isFocusOut=!0,this.isBlur=!1,ir(this.valueContainer,"focusout"),this.defaultResize(n),this.trigger("blur",{event:n,isInteracted:0!==Object.keys(n).length}),t.isNullOrUndefined(this.timeInterval)||(clearInterval(this.timeInterval),this.timeInterval=null),t.EventHandler.remove(document,"mousedown",this.onDocumentClick)):this.isRTE=!0},i.prototype.contentChanged=function(){this.autoSaveOnIdle&&(t.isNullOrUndefined(this.saveInterval)||(clearTimeout(this.timeInterval),this.timeInterval=setTimeout(this.updateIntervalValue.bind(this),this.saveInterval)))},i.prototype.invokeChangeEvent=function(){var n={value:this.enableXhtml?this.getXhtml():this.value};this.value!==this.cloneValue&&(this.trigger("change",n),this.cloneValue=this.value)},i.prototype.wireScrollElementsEvents=function(){var n,i,r;for(this.scrollParentElements=ot.getScrollableParent(this.element),n=0,i=this.scrollParentElements;n<i.length;n++)r=i[n],t.EventHandler.add(r,"scroll",this.scrollHandler,this);this.iframeSettings.enable||t.EventHandler.add(this.contentModule.getPanel(),"scroll",this.contentScrollHandler,this)},i.prototype.wireContextEvent=function(){this.quickToolbarSettings.showOnRightClick&&(t.EventHandler.add(this.inputElement,"contextmenu",this.contextHandler,this),t.Browser.isDevice&&(this.touchModule=new t.Touch(this.inputElement,{tapHold:this.touchHandler.bind(this),tapHoldThreshold:500})))},i.prototype.unWireContextEvent=function(){t.EventHandler.remove(this.inputElement,"contextmenu",this.contextHandler);t.Browser.isDevice&&this.touchModule&&this.touchModule.destroy()},i.prototype.unWireScrollElementsEvents=function(){var n,i,r;for(this.scrollParentElements=ot.getScrollableParent(this.element),n=0,i=this.scrollParentElements;n<i.length;n++)r=i[n],t.EventHandler.remove(r,"scroll",this.scrollHandler);this.iframeSettings.enable||t.EventHandler.remove(this.contentModule.getPanel(),"scroll",this.contentScrollHandler)},i.prototype.touchHandler=function(n){this.notifyMouseUp(n.originalEvent);this.triggerEditArea(n.originalEvent)},i.prototype.contextHandler=function(n){var i=t.closest(n.target,"a, table, img");!1!==this.inlineMode.onSelection&&(t.isNullOrUndefined(i)||!this.inputElement.contains(i)||"IMG"!==i.tagName&&"TABLE"!==i.tagName&&"A"!==i.tagName)||n.preventDefault()},i.prototype.resetHandler=function(){var n=this.valueContainer.defaultValue.trim();this.setProperties({value:""===n?null:n})},i.prototype.autoResize=function(){var n=this,t;"auto"===this.height?"Markdown"===this.editorMode?setTimeout(function(){n.setAutoHeight(n.inputElement)},0):this.iframeSettings.enable&&(t=this.element.querySelector("#"+this.getID()+"_rte-view"),setTimeout(function(){n.setAutoHeight(t)},100),this.inputElement.style.overflow="hidden"):this.inputElement.style.overflow=null},i.prototype.setAutoHeight=function(n){t.isNullOrUndefined(n)||(n.style.height="",n.style.height=this.inputElement.scrollHeight+"px",n.style.overflow="hidden")},i.prototype.wireEvents=function(){this.element.addEventListener("focusin",this.onFocusHandler,!0);this.element.addEventListener("focusout",this.onBlurHandler,!0);this.on(sr,this.contentChanged,this);this.on(yo,this.updateResizeFlag,this);this.on(sf,this.updateStatus,this);this.readonly&&this.enabled||this.bindEvents()},i.prototype.restrict=function(n){if(this.maxLength>=0){for(var u="Markdown"===this.editorMode?this.contentModule.getText():n.currentTarget.textContent.trim(),i=[8,16,17,37,38,39,40,46,65],r=void 0,t=0;t<=i.length-1;t++)if(n.which===i[t]){if(n.ctrlKey&&65===n.which)return;if(65!==n.which)return void(r=i[t])}u.length>=this.maxLength&&-1!==this.maxLength&&n.which!==r&&n.preventDefault()}},i.prototype.bindEvents=function(){this.keyboardModule=new ch(this.inputElement,{keyAction:this.keyDown.bind(this),keyConfigs:vv({},this.formatter.keyConfig,this.keyConfig),eventName:"keydown"});var n=t.closest(this.valueContainer,"form");n&&t.EventHandler.add(n,"reset",this.resetHandler,this);t.EventHandler.add(this.inputElement,"keyup",this.keyUp,this);t.EventHandler.add(this.inputElement,"paste",this.onPaste,this);t.EventHandler.add(this.inputElement,t.Browser.touchEndEvent,t.debounce(this.mouseUp,30),this);t.EventHandler.add(this.inputElement,t.Browser.touchStartEvent,this.mouseDownHandler,this);this.wireContextEvent();this.formatter.editorManager.observer.on(l,this.editorKeyDown,this);this.element.ownerDocument.defaultView.addEventListener("resize",this.onResizeHandler,!0);this.iframeSettings.enable&&(t.EventHandler.add(this.inputElement,"focusin",this.focusHandler,this),t.EventHandler.add(this.inputElement,"focusout",this.blurHandler,this),t.EventHandler.add(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler,this),t.EventHandler.add(this.inputElement.ownerDocument,t.Browser.touchStartEvent,this.onIframeMouseDown,this));this.wireScrollElementsEvents()},i.prototype.onIframeMouseDown=function(n){this.isBlur=!1;this.notify(ni,n)},i.prototype.editorKeyDown=function(n){switch(n.event.action){case"copy":this.onCopy();break;case"cut":this.onCut()}n.callBack&&("copy"===n.event.action||"cut"===n.event.action||"delete"===n.event.action)&&n.callBack({requestType:n.event.action,editorMode:"HTML",event:n.event})},i.prototype.unWireEvents=function(){this.element.removeEventListener("focusin",this.onFocusHandler,!0);this.element.removeEventListener("focusout",this.onBlurHandler,!0);this.off(sr,this.contentChanged);this.off(yo,this.updateResizeFlag);this.off(sf,this.updateStatus);this.readonly&&this.enabled||this.unbindEvents()},i.prototype.unbindEvents=function(){this.keyboardModule&&this.keyboardModule.destroy();var n=t.closest(this.valueContainer,"form");n&&t.EventHandler.remove(n,"reset",this.resetHandler);t.EventHandler.remove(this.inputElement,"keyup",this.keyUp);t.EventHandler.remove(this.inputElement,"paste",this.onPaste);t.EventHandler.remove(this.inputElement,t.Browser.touchEndEvent,t.debounce(this.mouseUp,30));t.EventHandler.remove(this.inputElement,t.Browser.touchStartEvent,this.mouseDownHandler);this.unWireContextEvent();this.formatter&&this.formatter.editorManager.observer.off(l,this.editorKeyDown);this.element.ownerDocument.defaultView.removeEventListener("resize",this.onResizeHandler,!0);this.iframeSettings.enable&&(t.EventHandler.remove(this.inputElement,"focusin",this.focusHandler),t.EventHandler.remove(this.inputElement,"focusout",this.blurHandler),t.EventHandler.remove(this.inputElement.ownerDocument,"scroll",this.contentScrollHandler),t.EventHandler.remove(this.inputElement.ownerDocument,t.Browser.touchStartEvent,this.onIframeMouseDown));this.unWireScrollElementsEvents()},r([t.Complex({},sn)],i.prototype,"toolbarSettings",void 0),r([t.Complex({},an)],i.prototype,"quickToolbarSettings",void 0),r([t.Complex({},vn)],i.prototype,"pasteCleanupSettings",void 0),r([t.Complex({},ttt)],i.prototype,"iframeSettings",void 0),r([t.Complex({},hn)],i.prototype,"insertImageSettings",void 0),r([t.Complex({},ln)],i.prototype,"tableSettings",void 0),r([t.Property(0)],i.prototype,"floatingToolbarOffset",void 0),r([t.Complex({},rtt)],i.prototype,"inlineMode",void 0),r([t.Complex({},cn)],i.prototype,"fileManagerSettings",void 0),r([t.Property("100%")],i.prototype,"width",void 0),r([t.Property(!1)],i.prototype,"enablePersistence",void 0),r([t.Property(!1)],i.prototype,"enableResize",void 0),r([t.Property({})],i.prototype,"htmlAttributes",void 0),r([t.Property(null)],i.prototype,"placeholder",void 0),r([t.Property(!1)],i.prototype,"autoSaveOnIdle",void 0),r([t.Property(!1)],i.prototype,"readonly",void 0),r([t.Property(!0)],i.prototype,"enabled",void 0),r([t.Property(!0)],i.prototype,"enableHtmlSanitizer",void 0),r([t.Property(!1)],i.prototype,"enableHtmlEncode",void 0),r([t.Property(!1)],i.prototype,"enableXhtml",void 0),r([t.Property("auto")],i.prototype,"height",void 0),r([t.Property(null)],i.prototype,"cssClass",void 0),r([t.Property(null)],i.prototype,"value",void 0),r([t.Property("P")],i.prototype,"enterKey",void 0),r([t.Property("BR")],i.prototype,"shiftEnterKey",void 0),r([t.Property(30)],i.prototype,"undoRedoSteps",void 0),r([t.Property(300)],i.prototype,"undoRedoTimer",void 0),r([t.Property("HTML")],i.prototype,"editorMode",void 0),r([t.Property(null)],i.prototype,"keyConfig",void 0),r([t.Property(!1)],i.prototype,"showCharCount",void 0),r([t.Property(!1)],i.prototype,"enableTabKey",void 0),r([t.Property(!1)],i.prototype,"enableAutoUrl",void 0),r([t.Property(-1)],i.prototype,"maxLength",void 0),r([t.Complex({},wn)],i.prototype,"format",void 0),r([t.Complex({},dn)],i.prototype,"numberFormatList",void 0),r([t.Complex({},gn)],i.prototype,"bulletFormatList",void 0),r([t.Complex({},yn)],i.prototype,"fontFamily",void 0),r([t.Complex({},pn)],i.prototype,"fontSize",void 0),r([t.Complex({},bn)],i.prototype,"fontColor",void 0),r([t.Complex({},kn)],i.prototype,"backgroundColor",void 0),r([t.Property(null)],i.prototype,"valueTemplate",void 0),r([t.Property(1e4)],i.prototype,"saveInterval",void 0),r([t.Event()],i.prototype,"actionBegin",void 0),r([t.Event()],i.prototype,"actionComplete",void 0),r([t.Event()],i.prototype,"beforeDialogOpen",void 0),r([t.Event()],i.prototype,"dialogOpen",void 0),r([t.Event()],i.prototype,"beforeDialogClose",void 0),r([t.Event()],i.prototype,"dialogClose",void 0),r([t.Event()],i.prototype,"beforeQuickToolbarOpen",void 0),r([t.Event()],i.prototype,"quickToolbarOpen",void 0),r([t.Event()],i.prototype,"quickToolbarClose",void 0),r([t.Event()],i.prototype,"toolbarStatusUpdate",void 0),r([t.Event()],i.prototype,"updatedToolbarStatus",void 0),r([t.Event()],i.prototype,"imageSelected",void 0),r([t.Event()],i.prototype,"beforeImageUpload",void 0),r([t.Event()],i.prototype,"imageUploading",void 0),r([t.Event()],i.prototype,"imageUploadSuccess",void 0),r([t.Event()],i.prototype,"imageUploadFailed",void 0),r([t.Event()],i.prototype,"imageRemoving",void 0),r([t.Event()],i.prototype,"afterImageDelete",void 0),r([t.Event()],i.prototype,"created",void 0),r([t.Event()],i.prototype,"destroyed",void 0),r([t.Event()],i.prototype,"beforeSanitizeHtml",void 0),r([t.Event()],i.prototype,"blur",void 0),r([t.Event()],i.prototype,"toolbarClick",void 0),r([t.Event()],i.prototype,"focus",void 0),r([t.Event()],i.prototype,"change",void 0),r([t.Event()],i.prototype,"resizing",void 0),r([t.Event()],i.prototype,"resizeStart",void 0),r([t.Event()],i.prototype,"resizeStop",void 0),r([t.Event()],i.prototype,"beforePasteCleanup",void 0),r([t.Event()],i.prototype,"afterPasteCleanup",void 0),r([t.Event()],i.prototype,"beforeImageDrop",void 0),r([t.Property(null)],i.prototype,"formatter",void 0),r([t.NotifyPropertyChanges],i)}(t.Component),yv={};ue.J(yv,re);ok={richtexteditor:yv=ue.J(window.ejdashboard?window.ejdashboard.richtexteditor:{},yv)};window.ejdashboard=ue.J(window.ejdashboard||{},ok)})()})();ejdashboard.richtexteditor.RichTextEditor.Inject(ejdashboard.richtexteditor.HtmlEditor,ejdashboard.richtexteditor.Toolbar,ejdashboard.richtexteditor.QuickToolbar,ejdashboard.richtexteditor.Link,ejdashboard.richtexteditor.Image,ejdashboard.richtexteditor.Count,ejdashboard.richtexteditor.MarkdownEditor,ejdashboard.richtexteditor.PasteCleanup,ejdashboard.richtexteditor.Resize,ejdashboard.richtexteditor.Table);
