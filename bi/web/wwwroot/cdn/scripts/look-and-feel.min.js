const additionalSpecialChar=/^[a-zA-Z_0-9`~!\$\^()=\-\.\{\} ]+$/;function InheritFromGlobalAppTheme(){$(".css-radio").attr("disabled",!0);var e="#"+themeAppearanceUms+"-theme-required";$(e).prop("checked",!0),$("#applicationTheme option").removeAttr("selected"),$("#applicationTheme ").selectpicker("refresh"),$(".dropdown-look-and-feel .btn").addClass("disabled"),"light"==themeApplicationThemeUms||"dark"==themeApplicationThemeUms||isEmptyOrWhitespace(themeApplicationThemeUms)?$(".dropdown-look-and-feel .filter-option").html(window.Server.App.Localization.DefaultOption):$(".dropdown-look-and-feel .filter-option").html(themeApplicationThemeUms),"light"==themeApplicationThemeUms||"dark"==themeApplicationThemeUms||isEmptyOrWhitespace(themeApplicationThemeUms)?$("#applicationTheme").val(window.Server.App.Localization.DefaultOption):$("#applicationTheme").val(themeApplicationThemeUms),("light"==themeApplicationThemeUms||"dark"==themeApplicationThemeUms||isEmptyOrWhitespace(themeApplicationThemeUms)?$("#applicationTheme option:first"):$("#applicationTheme option[value='"+themeApplicationThemeUms+"']")).attr("selected","selected"),$(".dropdown-look-and-feel ul li").removeClass("selected active"),$(".dropdown-look-and-feel ul li span").each(function(){"light"==themeApplicationThemeUms||"dark"==themeApplicationThemeUms||isEmptyOrWhitespace(themeApplicationThemeUms)?$(".dropdown-look-and-feel ul li:first").addClass("selected active"):$(this).text()==themeApplicationThemeUms&&$(this).parent().parent().addClass("selected active")})}function InheritFromGlobalDashboardTheme(){$("#dashboardTheme option").removeAttr("selected"),$("#dashboardTheme").selectpicker("refresh"),$(".dropdown-look-and-feel-dashboard .btn").addClass("disabled"),("light"==themeDashboardThemeUms||"dark"==themeDashboardThemeUms||isEmptyOrWhitespace(themeDashboardThemeUms)?$("#dashboardTheme option:first"):$("#dashboardTheme option[value='"+themeDashboardThemeUms+"']")).attr("selected","selected"),"light"==themeDashboardThemeUms||"dark"==themeDashboardThemeUms||isEmptyOrWhitespace(themeDashboardThemeUms)?$(".dropdown-look-and-feel-dashboard .filter-option").html(window.Server.App.Localization.DefaultOption):$(".dropdown-look-and-feel-dashboard .filter-option").html(themeDashboardThemeUms),"light"==themeDashboardThemeUms||"dark"==themeDashboardThemeUms||isEmptyOrWhitespace(themeDashboardThemeUms)?$("#dashboardTheme").val(window.Server.App.Localization.DefaultOption):$("#dashboardTheme").val(themeDashboardThemeUms),$(".dropdown-look-and-feel-dashboard ul li").removeClass("selected active"),$(".dropdown-look-and-feel-dashboard ul li span").each(function(){"light"==themeDashboardThemeUms||"dark"==themeDashboardThemeUms||isEmptyOrWhitespace(themeDashboardThemeUms)?$(".dropdown-look-and-feel-dashboard ul li:first").addClass("selected active"):$(this).text()==themeDashboardThemeUms&&$(this).parent().parent().addClass("selected active")})}function InheritFontStyle(){$("#application-font option").removeAttr("selected"),$("#application-font").selectpicker("refresh"),$("#app-font-customize ul li").removeClass("selected active"),$("#app-font-customize .btn").addClass("disabled");var e=fontUms==defaultFont?fontUms+" ("+window.Server.App.Localization.DefaultOption+")":fontUms;$("#app-font-customize .filter-option").html(e),$("#application-font").val(fontUms),$("#application-font option[value='"+fontUms+"']").attr("selected","selected"),$("#app-font-customize ul li span").each(function(){$(this).text()==e&&$(this).parent().parent().addClass("selected active")}),document.getElementsByClassName("font-stylesheet")[0].href=InternalAppIdpUrl+"/ums/user-interface/fonts?family="+fontUms}function onChangeTheme(e){var a,o,t=isDebug;$("#applicationTheme.selectpicker").selectpicker("val",""),t?(o="default.css",a="dark"===e?"dark.css":"light.css"):(a="light.min.css",o="default.min.css","dark"===e&&(a="dark.min.css")),isSelfHosted?(document.getElementsByClassName("theme-ref")[0].href=dashboardServerResourceUrl+"/cdn/css/theme/"+a,document.getElementsByClassName("application-theme-ref")[0].href=InternalAppIdpUrl+"/ums/theme/styles/application?theme="+e):(document.getElementsByClassName("theme-ref")[0].href=dashboardServerResourceUrl+"/cdn/css/theme/"+a,document.getElementsByClassName("application-theme-ref")[0].href=dashboardServerResourceUrl+"/cdn/css/theme/"+e+o),isDefaultMainLogo&&$("#application-logo").attr("src","/bi/cdn/images/application/boldbi/"+e+"/main_logo.svg"),isDefaultFooterLogo&&$("#footerlogo").attr("src","/bi/cdn/images/application/boldbi/"+e+"/footer_logo.svg")}function onUploadFontDialogOpen(){document.getElementById("font-upload-dialog").ej2_instances[0].show()}function onUploadApplicationThemeDialogOpen(){document.getElementById("application-theme-upload-dialog").ej2_instances[0].show()}function onUploadDashboardThemeDialogOpen(){document.getElementById("dashboard-theme-upload-dialog").ej2_instances[0].show()}function onUploadFontDialogClose(){$("#upload-font").attr("disabled",!0),$("#font-name").val(""),$('input[type="file"]').val(null),$("#font-file-name").val("Browse file path (.woff2)"),$("#font-name").closest("div").removeClass("has-error"),$("#invalid-font-name").css("display","none"),$("#font-file-name").closest("div").removeClass("has-error"),$("#invalid-font-file-name").html("").css("display","none")}function onUploadFontDialogCancel(){document.getElementById("font-upload-dialog").ej2_instances[0].hide(),onUploadFontDialogClose()}function onUploadApplicationThemeDialogClose(){$("#upload-applicationtheme").attr("disabled",!0),$("#applicationtheme-name").val(""),$('input[type="file"]').val(null),$("#application-theme-file-name").val(""),$("#applicationtheme-file").closest("div").removeClass("has-error"),$(".validation").closest("div").removeClass("has-error"),$(".applicationthemefileupload-validation-messages").css("display","none"),$(".applicationthemeupload-validation-messages").css("display","none")}function onUploadApplicationThemeDialogCancel(){document.getElementById("application-theme-upload-dialog").ej2_instances[0].hide(),onUploadApplicationThemeDialogClose()}function onUploadDashboardThemeDialogClose(){$("#upload-dashboardtheme").attr("disabled",!0),$("#dashboardtheme-name").val(""),$('input[type="file"]').val(null),$("#dashboard-theme-file-name").val(""),$("#dashboardtheme-file").closest("div").removeClass("has-error"),$(".validation").closest("div").removeClass("has-error"),$(".applicationthemefileupload-validation-messages").css("display","none"),$(".applicationthemeupload-validation-messages").css("display","none")}function onUploadDashboardThemeDialogCancel(){document.getElementById("dashboard-theme-upload-dialog").ej2_instances[0].hide(),onUploadDashboardThemeDialogClose()}function keyvalidation(e){var a=$(e).val(),o="#applicationtheme-name"===e?"#invalid-applicationtheme-name":"#invalid-dashboardtheme-name";""==$.trim(a)?($(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.ItemNameValidator).css("display","block"),$(".upload-applicationtheme").attr("disabled","disabled"),$(".applicationthemeupload-validation-messages").css("display","block")):additionalSpecialChar.test(a)&&""!==a?("#applicationtheme-name"===e?$("#applicationTheme option"):$("#dashboardTheme option")).each(function(){if(a.toLowerCase().trim()===$(this).text().trim().toLowerCase())return $(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.FileNameAlreadyExists).css("display","block"),$(".upload-applicationtheme").attr("disabled","disabled"),$(".applicationthemeupload-validation-messages").css("display","block"),!1;$(e).closest("div").removeClass("has-error"),$(".applicationthemeupload-validation-messages").css("display","none"),$(".upload-applicationtheme").removeAttr("disabled")}):($(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.AvoidSpecialCharacters).css("display","block"),$(".upload-applicationtheme").attr("disabled","disabled"),$(".applicationthemeupload-validation-messages").css("display","block"))}$(document).ready(function(){new ejs.popups.Dialog({header:"Upload font",showCloseIcon:!0,width:"472px",close:onUploadFontDialogClose,isModal:!0,visible:!1,animationSettings:{effect:"Zoom"}}).appendTo("#font-upload-dialog"),new ejs.popups.Dialog({header:window.Server.App.Localization.ManageApplicationTheme,showCloseIcon:!0,width:"472px",close:onUploadApplicationThemeDialogClose,isModal:!0,visible:!1,animationSettings:{effect:"Zoom"}}).appendTo("#application-theme-upload-dialog"),new ejs.popups.Dialog({header:window.Server.App.Localization.ManageDashboardTheme,showCloseIcon:!0,width:"472px",close:onUploadDashboardThemeDialogClose,isModal:!0,visible:!1,animationSettings:{effect:"Zoom"}}).appendTo("#dashboard-theme-upload-dialog"),$.validator.addMethod("additionalSpecialCharValidation",function(e){if(additionalSpecialChar.test(e)||""===e)return!0},window.Server.App.Localization.AvoidSpecialCharacters),$.validator.addMethod("isRequired",function(e){return!isEmptyOrWhitespace(e)},window.Server.App.Localization.ItemNameValidator),$(document).on("click","#trigger-application-file, #application-theme-file-name",function(){$('input[type="file"]').val(null),$("#applicationtheme-file").trigger("click")}),$(document).on("click","#trigger-dashboard-file, #dashboard-theme-file-name",function(){$('input[type="file"]').val(null),$("#dashboardtheme-file").trigger("click")}),$(document).on("click","#trigger-font-upload, #font-file-name",function(){$('input[type="file"]').val(null),$("#font-file").trigger("click")}),umsSettingsInherit(isUMSLookAndFeelSettingsInherited,!1,".ums-inherit-look-and-feel .btn"),umsSettingsInherit(isUMSLookAndFeelSettingsInherited,!0,"#update-look-and-feel-settings, #appearance-container .css-radio, .ums-inherit-lookandfeel"),isUMSLookAndFeelSettingsInherited||$("#inherit-from-global-app-theme").is(":checked")?(InheritFromGlobalAppTheme(),InheritFromGlobalDashboardTheme(),InheritFontStyle()):($(".css-radio").attr("disabled",!1),$(".dropdown-look-and-feel .btn, .dropdown-look-and-feel-dashboard .btn, #app-font-customize .btn").removeClass("disabled"))}),$(document).on("change","#application-font",function(){var e=$("#application-font").val(),a=document.getElementsByClassName("font-stylesheet");isSelfHosted?a[0].href=InternalAppIdpUrl+"/ums/user-interface/fonts?family="+e:e.trim()==defaultFont||isEmptyOrWhitespace(e)?isDebug?a[0].href=dashboardServerResourceUrl+"/cdn/css/fonts/font-robotoregular.css":a[0].href=dashboardServerResourceUrl+"/cdn/css/fonts/font-robotoregular.min.css":a[0].href=dns+"/bi/user-interface/fonts?family="+e}),$(document).on("click","#inherit-from-global-app-theme",function(){var e,a;$("#inherit-from-global-app-theme").is(":checked")?(InheritFromGlobalAppTheme(),InheritFromGlobalDashboardTheme(),InheritFontStyle(),$("#app-font-customize .btn").addClass("disabled"),e=themeAppearanceUms,a=isDebug?"dark"===e?"dark.css":"light.css":"dark"===e?"dark.min.css":"light.min.css",document.getElementsByClassName("theme-ref")[0].href=dashboardServerResourceUrl+"/cdn/css/theme/"+a,a=document.getElementsByClassName("application-theme-ref"),isEmptyOrWhitespace(themeApplicationThemeUms)?a[0].href=InternalAppIdpUrl+"/ums/theme/styles/application":a[0].href=InternalAppIdpUrl+"/ums/theme/styles/application?theme="+themeApplicationThemeUms,isDefaultMainLogo&&$("#application-logo").attr("src","/bi/cdn/images/application/boldbi/"+e+"/main_logo.svg"),isDefaultFooterLogo&&$("#footerlogo").attr("src","/bi/cdn/images/application/boldbi/"+e+"/footer_logo.svg")):($(".css-radio").attr("disabled",!1),$(".dropdown-look-and-feel .btn, .dropdown-look-and-feel-dashboard .btn, #app-font-customize .btn").removeClass("disabled"))}),$(document).on("change","input[name='theme-required']",function(e){onChangeTheme($("input:radio[name=theme-required]:checked").val())}),$(document).on("change","#applicationTheme",function(){e=isDebug?"default.css":"default.min.css";var e,a,o=$("#applicationTheme").val();isSelfHosted?(a=document.getElementsByClassName("application-theme-ref"),isEmptyOrWhitespace(o)?a[0].href=InternalAppIdpUrl+"/ums/theme/styles/application?theme="+$("input:radio[name=theme-required]:checked").val():a[0].href=InternalAppIdpUrl+"/ums/theme/styles/application?theme="+o):(a=document.getElementsByClassName("application-theme-ref"))[0].href=""===o?dashboardServerResourceUrl+"/cdn/css/theme/"+$("input:radio[name=theme-required]:checked").val()+e:applicationThemeReferenceUrl+"?theme="+o}),$(document).on("change","#font-file",function(e){var e=e.target.files[0].name,a=e.substring(0,e.indexOf("."));$("#font-file-name").val(e),$("#font-name").val(a),$("#font-name").closest("div").removeClass("has-error"),$("#invalid-font-name").css("display","none"),$("#font-file-name").closest("div").removeClass("has-error"),$("#invalid-font-file-name").html("").css("display","none"),$("#upload-font").attr("disabled",!1);e=document.getElementById("font-file").value;/(\.woff2)$/i.exec(e)||($("#font-file-name").closest("div").addClass("has-error"),$("#invalid-font-file-name").html(window.Server.App.Localization.FontFileInvalid).css("display","block"),$("#upload-font").attr("disabled","disabled"))}),$(document).on("change","#applicationtheme-file",function(e){var e=e.target.files[0].name,a=e.substring(0,e.indexOf("."));$("#application-theme-file-name").val(e),$("#upload-applicationtheme").attr("disabled","disabled");e=document.getElementById("applicationtheme-file").value;/(\.css)$/i.exec(e)?($("#applicationtheme-file").closest("div").removeClass("has-error"),$(".validation-message").css("display","none"),$("#upload-applicationtheme,#applicationtheme-name").removeAttr("disabled"),$("#applicationtheme-name").closest("div").removeClass("has-error"),$("#applicationtheme-name").val(a),$("#applicationTheme option").each(function(){a.toLowerCase()===$(this).text().toLowerCase()&&($("#applicationtheme-name").closest("div").addClass("has-error"),$("#invalid-applicationtheme-name").html(window.Server.App.Localization.FileNameAlreadyExists).css("display","block"),$("#upload-applicationtheme,#applicationtheme-name").attr("disabled","disabled"),$("#invalid-applicationtheme-name.validation-message").css("display","block"))})):($("#invalid-applicationtheme-name").html("").css("display","none"),$("#applicationtheme-file").closest("div").addClass("has-error"),$("#invalid-applicationthemefile-name").html(window.Server.App.Localization.CssInvalid).css("display","block"),$("#upload-applicationtheme,#applicationtheme-name").attr("disabled","disabled"),$("#invalid-applicationthemefile-name.validation-message").css("display","block"))}),$(document).on("change","#dashboardtheme-file",function(e){var e=e.target.files[0].name,a=e.substring(0,e.indexOf("."));$("#dashboard-theme-file-name").val(e),$("#upload-dashboardtheme").attr("disabled","disabled");e=document.getElementById("dashboardtheme-file").value;/(\.css)$/i.exec(e)?($("#dashboardtheme-file").closest("div").removeClass("has-error"),$(".validation-message").css("display","none"),$("#upload-dashboardtheme").removeAttr("disabled"),$("#dashboardtheme-name").removeAttr("disabled"),$("#dashboardtheme-name").closest("div").removeClass("has-error"),$(".validation-message").css("display","none"),$("#dashboardtheme-name").val(a),$("#dashboardTheme option").each(function(){a.toLowerCase()===$(this).text().toLowerCase()&&($("#dashboardtheme-name").closest("div").addClass("has-error"),$("#invalid-dashboardtheme-name").html(window.Server.App.Localization.FileNameAlreadyExists).css("display","block"),$("#upload-dashboardtheme,#dashboardtheme-name").attr("disabled","disabled"),$("#invalid-dashboardtheme-name.validation-message").css("display","block"))})):($("#invalid-dashboardtheme-name").html("").css("display","none"),$("#dashboardtheme-file").closest("div").addClass("has-error"),$("#invalid-dashboardthemefile-name").html(window.Server.App.Localization.CssInvalid).css("display","block"),$(".upload-theme").attr("disabled","disabled"),$("#invalid-dashboardthemefile-name.validation-message").css("display","block"))}),$(document).on("click","#update-look-and-feel-settings",function(){var e={ThemeAppearance:$("input[name='theme-required']:checked").val(),CustomApplicationTheme:(isEmptyOrWhitespace($("#applicationTheme").val())&&isSelfHosted?$("input[name='theme-required']:checked"):$("#applicationTheme")).val(),CustomDashboardTheme:$(".dropdown-look-and-feel-dashboard .filter-option").html()==window.Server.App.Localization.DefaultOption?"":$(".dropdown-look-and-feel-dashboard .filter-option").html(),IsInheritFromGlobalLookAndFeelSettings:$("#inherit-from-global-app-theme").is(":checked"),FontPreference:$("#application-font").val()};$.ajax({type:"POST",url:updateCustomThemeSettingsUrl,data:{themeSettingsData:e},success:function(e){e.status?successToast(window.Server.App.Localization.UpdateCustomThemeSettingSuccess,7e3):warningToast(null!=e.permissionDenied&&e.permissionDenied?window.Server.App.Localization.PermissionWarningAlert:window.Server.App.Localization.SettingsWarningAlert,null!=e.permissionDenied&&e.permissionDenied?null:e.message,(new Date).getTime(),window.Server.App.Localization.LookAndFeelSettings)}})}),$(document).on("click","#upload-applicationtheme",function(){var e=$("#upload-application-theme-form"),e=new FormData(e[0]);showWaitingPopup("application-theme-upload-dialog"),$.ajax({type:"POST",url:$("#upload-application-theme-form").prop("action"),data:e,contentType:!1,processData:!1,success:function(e){e.Status?(successToast(window.Server.App.Localization.UpdateCustomThemeSettingSuccess,7e3),hideWaitingPopup("application-theme-upload-dialog"),onUploadApplicationThemeDialogCancel(),showWaitingPopup($("#server-app-container")),window.location.href=lookAndFeelSettingsUrl):(hideWaitingPopup("application-theme-upload-dialog"),void 0===e.message||isEmptyOrWhitespace(e.message)?(warningToast(window.Server.App.Localization.SettingsWarningAlert,null,(new Date).getTime(),window.Server.App.Localization.LookAndFeelSettings),$("#applicationtheme-name").closest("div").removeClass("has-error"),$(".applicationthemeupload-validation-messages").css("display","none"),$(".upload-applicationtheme").removeAttr("disabled")):($("#applicationtheme-name").closest("div").addClass("has-error"),$("#invalid-applicationtheme-name").html(e.message).css("display","block"),$(".upload-applicationtheme").attr("disabled","disabled"),$(".applicationthemeupload-validation-messages").css("display","block")))}})}),$(document).on("click","#upload-dashboardtheme",function(){var e=$("#upload-dashboard-theme-form"),e=new FormData(e[0]);showWaitingPopup("dashboard-theme-upload-dialog"),$.ajax({type:"POST",url:$("#upload-dashboard-theme-form").prop("action"),data:e,contentType:!1,processData:!1,success:function(e){e.Status?(successToast(window.Server.App.Localization.UpdateCustomThemeSettingSuccess,7e3),hideWaitingPopup("dashboard-theme-upload-dialog"),onUploadDashboardThemeDialogCancel(),showWaitingPopup($("#server-app-container")),window.location.href=lookAndFeelSettingsUrl):(hideWaitingPopup("dashboard-theme-upload-dialog"),void 0===e.message||isEmptyOrWhitespace(e.message)?(onUploadDashboardThemeDialogCancel(),warningToast(window.Server.App.Localization.SettingsWarningAlert,null,(new Date).getTime(),window.Server.App.Localization.LookAndFeelSettings),$("#dashboardtheme-name").closest("div").removeClass("has-error"),$(".applicationthemeupload-validation-messages").css("display","none"),$(".upload-applicationtheme").removeAttr("disabled")):($("#dashboardtheme-name").closest("div").addClass("has-error"),$("#invalid-dashboardtheme-name").html(e.message).css("display","block"),$(".upload-applicationtheme").attr("disabled","disabled"),$(".applicationthemeupload-validation-messages").css("display","block")))}})}),$(document).on("click","#upload-font",function(){var e=$("#upload-font-form"),e=new FormData(e[0]);showWaitingPopup("font-upload-dialog"),$.ajax({type:"POST",url:$("#upload-font-form").prop("action"),data:e,contentType:!1,processData:!1,success:function(e){e.Status?(successToast(window.Server.App.Localization.UpdateCustomThemeSettingSuccess,7e3),hideWaitingPopup("font-upload-dialog"),onUploadFontDialogClose(),showWaitingPopup($("#server-app-container")),window.location.href=lookAndFeelSettingsUrl):(hideWaitingPopup("font-upload-dialog"),void 0===e.message||isEmptyOrWhitespace(e.message)?(onUploadFontDialogClose(),warningToast(window.Server.App.Localization.SettingsWarningAlert,null,(new Date).getTime(),window.Server.App.Localization.LookAndFeelSettings),$("#font-name").closest("div").removeClass("has-error"),$("#invalid-font-name").css("display","none"),$("#upload-font").removeAttr("disabled")):($("#font-name").closest("div").addClass("has-error"),$("#invalid-font-name").html(e.message).css("display","block"),$("#upload-font").attr("disabled","disabled"),$("#invalid-font-name").css("display","block")))}})}),$(document).on("keyup","#applicationtheme-name",function(){keyvalidation("#applicationtheme-name")}),$(document).on("keyup","#dashboardtheme-name",function(){keyvalidation("#dashboardtheme-name")}),$(document).on("keyup","#font-name",function(){var e="#font-name",a=$("#font-name").val(),o="#invalid-font-name",t=$("#font-file-name").val();/(\.woff2)$/i.exec(t)?""==$.trim(a)?($(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.ItemNameValidator).css("display","block"),$("#upload-font").attr("disabled","disabled"),$("#invalid-font-name").css("display","block")):additionalSpecialChar.test(a)&&""!==a?$("#application-font option").each(function(){if(a.toLowerCase().trim()===$(this).text().trim().toLowerCase())return $(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.FileNameAlreadyExists).css("display","block"),$("#upload-font").attr("disabled","disabled"),$("#invalid-font-name").css("display","block"),!1;$(e).closest("div").removeClass("has-error"),$("#invalid-font-name").css("display","none"),$("#upload-font").removeAttr("disabled"),$("#font-file-name").closest("div").removeClass("has-error"),$("#invalid-font-file-name").html("").css("display","none")}):($(e).closest("div").addClass("has-error"),$(o).html(window.Server.App.Localization.AvoidSpecialCharacters).css("display","block"),$("#upload-font").attr("disabled","disabled"),$("#invalid-font-name").css("display","block")):($("#font-file-name").closest("div").addClass("has-error"),$("#invalid-font-file-name").html(window.Server.App.Localization.FontFileInvalid).css("display","block"),$("#upload-font").attr("disabled","disabled"))});