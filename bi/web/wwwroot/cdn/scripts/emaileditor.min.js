!function(e){var d={newline:/^\n+/,code:/^( {4}[^\n]+\n*)+/,fences:m,hr:/^ {0,3}((?:- *){3,}|(?:_ *){3,}|(?:\* *){3,})(?:\n+|$)/,heading:/^ *(#{1,6}) *([^\n]+?) *#* *(?:\n+|$)/,nptable:m,blockquote:/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/,list:/^( *)(bull) [\s\S]+?(?:hr|def|\n{2,}(?! )(?!\1bull )\n*|\s*$)/,html:/^ *(?:comment *(?:\n|\s*$)|closed *(?:\n{2,}|\s*$)|closing *(?:\n{2,}|\s*$))/,def:/^ {0,3}\[(label)\]: *\n? *<?([^\s>]+)>?(?:(?: +\n? *| *\n *)(title))? *(?:\n+|$)/,table:m,lheading:/^([^\n]+)\n *(=|-){2,} *(?:\n+|$)/,paragraph:/^([^\n]+(?:\n?(?!hr|heading|lheading| {0,3}>|tag)[^\n]+)+)/,text:/^[^\n]+/};function o(e){this.tokens=[],this.tokens.links={},this.options=e||b.defaults,this.rules=d.normal,this.options.gfm&&(this.options.tables?this.rules=d.tables:this.rules=d.gfm)}d._label=/(?:\\[\[\]]|[^\[\]])+/,d._title=/(?:"(?:\\"|[^"]|"[^"\n]*")*"|'\n?(?:[^'\n]+\n?)*'|\([^()]*\))/,d.def=t(d.def).replace("label",d._label).replace("title",d._title).getRegex(),d.bullet=/(?:[*+-]|\d+\.)/,d.item=/^( *)(bull) [^\n]*(?:\n(?!\1bull )[^\n]*)*/,d.item=t(d.item,"gm").replace(/bull/g,d.bullet).getRegex(),d.list=t(d.list).replace(/bull/g,d.bullet).replace("hr","\\n+(?=\\1?(?:(?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$))").replace("def","\\n+(?="+d.def.source+")").getRegex(),d._tag="(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b",d.html=t(d.html).replace("comment",/<!--[\s\S]*?-->/).replace("closed",/<(tag)[\s\S]+?<\/\1>/).replace("closing",/<tag(?:"[^"]*"|'[^']*'|\s[^'"\/>\s]*)*?\/?>/).replace(/tag/g,d._tag).getRegex(),d.paragraph=t(d.paragraph).replace("hr",d.hr).replace("heading",d.heading).replace("lheading",d.lheading).replace("tag","<"+d._tag).getRegex(),d.blockquote=t(d.blockquote).replace("paragraph",d.paragraph).getRegex(),d.normal=g({},d),d.gfm=g({},d.normal,{fences:/^ *(`{3,}|~{3,})[ \.]*(\S+)? *\n([\s\S]*?)\n? *\1 *(?:\n+|$)/,paragraph:/^/,heading:/^ *(#{1,6}) +([^\n]+?) *#* *(?:\n+|$)/}),d.gfm.paragraph=t(d.paragraph).replace("(?!","(?!"+d.gfm.fences.source.replace("\\1","\\2")+"|"+d.list.source.replace("\\1","\\3")+"|").getRegex(),d.tables=g({},d.gfm,{nptable:/^ *(\S.*\|.*)\n *([-:]+ *\|[-| :]*)\n((?:.*\|.*(?:\n|$))*)\n*/,table:/^ *\|(.+)\n *\|( *[-:]+[-| :]*)\n((?: *\|.*(?:\n|$))*)\n*/}),o.rules=d,o.lex=function(e,t){return new o(t).lex(e)},o.prototype.lex=function(e){return e=e.replace(/\r\n|\r/g,"\n").replace(/\t/g,"    ").replace(/\u00a0/g," ").replace(/\u2424/g,"\n"),this.token(e,!0)},o.prototype.token=function(e,t){var n,i,a,s,r,l,o,c;for(e=e.replace(/^ +$/gm,"");e;)if((i=this.rules.newline.exec(e))&&(e=e.substring(i[0].length),1<i[0].length)&&this.tokens.push({type:"space"}),i=this.rules.code.exec(e))e=e.substring(i[0].length),i=i[0].replace(/^ {4}/gm,""),this.tokens.push({type:"code",text:this.options.pedantic?i:i.replace(/\n+$/,"")});else if(i=this.rules.fences.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"code",lang:i[2],text:i[3]||""});else if(i=this.rules.heading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:i[1].length,text:i[2]});else if(t&&(i=this.rules.nptable.exec(e))){for(e=e.substring(i[0].length),s={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/\n$/,"").split("\n")},l=0;l<s.align.length;l++)/^ *-+: *$/.test(s.align[l])?s.align[l]="right":/^ *:-+: *$/.test(s.align[l])?s.align[l]="center":/^ *:-+ *$/.test(s.align[l])?s.align[l]="left":s.align[l]=null;for(l=0;l<s.cells.length;l++)s.cells[l]=s.cells[l].split(/ *\| */);this.tokens.push(s)}else if(i=this.rules.hr.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"hr"});else if(i=this.rules.blockquote.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"blockquote_start"}),i=i[0].replace(/^ *> ?/gm,""),this.token(i,t),this.tokens.push({type:"blockquote_end"});else if(i=this.rules.list.exec(e)){for(e=e.substring(i[0].length),c=1<(a=i[2]).length,this.tokens.push({type:"list_start",ordered:c,start:c?+a:""}),n=!1,o=(i=i[0].match(this.rules.item)).length,l=0;l<o;l++)r=(s=i[l]).length,~(s=s.replace(/^ *([*+-]|\d+\.) +/,"")).indexOf("\n ")&&(r-=s.length,s=this.options.pedantic?s.replace(/^ {1,4}/gm,""):s.replace(new RegExp("^ {1,"+r+"}","gm"),"")),!this.options.smartLists||l===o-1||a===(r=d.bullet.exec(i[l+1])[0])||1<a.length&&1<r.length||(e=i.slice(l+1).join("\n")+e,l=o-1),r=n||/\n\n(?!\s*$)/.test(s),l!==o-1&&(n="\n"===s.charAt(s.length-1),r=r||n),this.tokens.push({type:r?"loose_item_start":"list_item_start"}),this.token(s,!1),this.tokens.push({type:"list_item_end"});this.tokens.push({type:"list_end"})}else if(i=this.rules.html.exec(e))e=e.substring(i[0].length),this.tokens.push({type:this.options.sanitize?"paragraph":"html",pre:!this.options.sanitizer&&("pre"===i[1]||"script"===i[1]||"style"===i[1]),text:i[0]});else if(t&&(i=this.rules.def.exec(e)))e=e.substring(i[0].length),i[3]&&(i[3]=i[3].substring(1,i[3].length-1)),c=i[1].toLowerCase(),this.tokens.links[c]||(this.tokens.links[c]={href:i[2],title:i[3]});else if(t&&(i=this.rules.table.exec(e))){for(e=e.substring(i[0].length),s={type:"table",header:i[1].replace(/^ *| *\| *$/g,"").split(/ *\| */),align:i[2].replace(/^ *|\| *$/g,"").split(/ *\| */),cells:i[3].replace(/(?: *\| *)?\n$/,"").split("\n")},l=0;l<s.align.length;l++)/^ *-+: *$/.test(s.align[l])?s.align[l]="right":/^ *:-+: *$/.test(s.align[l])?s.align[l]="center":/^ *:-+ *$/.test(s.align[l])?s.align[l]="left":s.align[l]=null;for(l=0;l<s.cells.length;l++)s.cells[l]=s.cells[l].replace(/^ *\| *| *\| *$/g,"").split(/ *\| */);this.tokens.push(s)}else if(i=this.rules.lheading.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"heading",depth:"="===i[2]?1:2,text:i[1]});else if(t&&(i=this.rules.paragraph.exec(e)))e=e.substring(i[0].length),this.tokens.push({type:"paragraph",text:"\n"===i[1].charAt(i[1].length-1)?i[1].slice(0,-1):i[1]});else if(i=this.rules.text.exec(e))e=e.substring(i[0].length),this.tokens.push({type:"text",text:i[0]});else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return this.tokens};var n={escape:/^\\([\\`*{}\[\]()#+\-.!_>])/,autolink:/^<(scheme:[^\s\x00-\x1f<>]*|email)>/,url:m,tag:/^<!--[\s\S]*?-->|^<\/?[a-zA-Z0-9\-]+(?:"[^"]*"|'[^']*'|\s[^<'">\/\s]*)*?\/?>/,link:/^!?\[(inside)\]\(href\)/,reflink:/^!?\[(inside)\]\s*\[([^\]]*)\]/,nolink:/^!?\[((?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]])*)\]/,strong:/^__([\s\S]+?)__(?!_)|^\*\*([\s\S]+?)\*\*(?!\*)/,em:/^_([^\s_](?:[^_]|__)+?[^\s_])_\b|^\*((?:\*\*|[^*])+?)\*(?!\*)/,code:/^(`+)\s*([\s\S]*?[^`]?)\s*\1(?!`)/,br:/^ {2,}\n(?!\s*$)/,del:m,text:/^[\s\S]+?(?=[\\<!\[`*]|\b_| {2,}\n|$)/};function i(e,t){if(this.options=t||b.defaults,this.links=e,this.rules=n.normal,this.renderer=this.options.renderer||new a,this.renderer.options=this.options,!this.links)throw new Error("Tokens array requires a `links` property.");this.options.gfm?this.options.breaks?this.rules=n.breaks:this.rules=n.gfm:this.options.pedantic&&(this.rules=n.pedantic)}function a(e){this.options=e||{}}function s(){}function c(e){this.tokens=[],this.token=null,this.options=e||b.defaults,this.options.renderer=this.options.renderer||new a,this.renderer=this.options.renderer,this.renderer.options=this.options}function u(e,t){return e.replace(t?/&/g:/&(?!#?\w+;)/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;")}function l(e){return e.replace(/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/gi,function(e,t){return"colon"===(t=t.toLowerCase())?":":"#"===t.charAt(0)?"x"===t.charAt(1)?String.fromCharCode(parseInt(t.substring(2),16)):String.fromCharCode(+t.substring(1)):""})}function t(n,e){return n=n.source,e=e||"",{replace:function(e,t){return t=(t=t.source||t).replace(/(^|[^\[])\^/g,"$1"),n=n.replace(e,t),this},getRegex:function(){return new RegExp(n,e)}}}function r(e,t){return p[" "+e]||(/^[^:]+:\/*[^/]*$/.test(e)?p[" "+e]=e+"/":p[" "+e]=e.replace(/[^/]*$/,"")),e=p[" "+e],"//"===t.slice(0,2)?e.replace(/:[\s\S]*/,":")+t:"/"===t.charAt(0)?e.replace(/(:\/*[^/]*)[\s\S]*/,"$1")+t:e+t}n._scheme=/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/,n._email=/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/,n.autolink=t(n.autolink).replace("scheme",n._scheme).replace("email",n._email).getRegex(),n._inside=/(?:\[[^\[\]]*\]|\\[\[\]]|[^\[\]]|\](?=[^\[]*\]))*/,n._href=/\s*<?([\s\S]*?)>?(?:\s+['"]([\s\S]*?)['"])?\s*/,n.link=t(n.link).replace("inside",n._inside).replace("href",n._href).getRegex(),n.reflink=t(n.reflink).replace("inside",n._inside).getRegex(),n.normal=g({},n),n.pedantic=g({},n.normal,{strong:/^__(?=\S)([\s\S]*?\S)__(?!_)|^\*\*(?=\S)([\s\S]*?\S)\*\*(?!\*)/,em:/^_(?=\S)([\s\S]*?\S)_(?!_)|^\*(?=\S)([\s\S]*?\S)\*(?!\*)/}),n.gfm=g({},n.normal,{escape:t(n.escape).replace("])","~|])").getRegex(),url:t(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/).replace("email",n._email).getRegex(),_backpedal:/(?:[^?!.,:;*_~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_~)]+(?!$))+/,del:/^~~(?=\S)([\s\S]*?\S)~~/,text:t(n.text).replace("]|","~]|").replace("|","|https?://|ftp://|www\\.|[a-zA-Z0-9.!#$%&'*+/=?^_`{\\|}~-]+@|").getRegex()}),n.breaks=g({},n.gfm,{br:t(n.br).replace("{2,}","*").getRegex(),text:t(n.gfm.text).replace("{2,}","*").getRegex()}),i.rules=n,i.output=function(e,t,n){return new i(t,n).output(e)},i.prototype.output=function(e){for(var t,n,i,a,s="";e;)if(a=this.rules.escape.exec(e))e=e.substring(a[0].length),s+=a[1];else if(a=this.rules.autolink.exec(e))e=e.substring(a[0].length),i="@"===a[2]?"mailto:"+(n=u(this.mangle(a[1]))):n=u(a[1]),s+=this.renderer.link(i,null,n);else if(!this.inLink&&(a=this.rules.url.exec(e)))a[0]=this.rules._backpedal.exec(a[0])[0],e=e.substring(a[0].length),i="@"===a[2]?"mailto:"+(n=u(a[0])):(n=u(a[0]),"www."===a[1]?"http://"+n:n),s+=this.renderer.link(i,null,n);else if(a=this.rules.tag.exec(e))!this.inLink&&/^<a /i.test(a[0])?this.inLink=!0:this.inLink&&/^<\/a>/i.test(a[0])&&(this.inLink=!1),e=e.substring(a[0].length),s+=this.options.sanitize?this.options.sanitizer?this.options.sanitizer(a[0]):u(a[0]):a[0];else if(a=this.rules.link.exec(e))e=e.substring(a[0].length),this.inLink=!0,s+=this.outputLink(a,{href:a[2],title:a[3]}),this.inLink=!1;else if(a=(a=this.rules.reflink.exec(e))||this.rules.nolink.exec(e))e=e.substring(a[0].length),t=(a[2]||a[1]).replace(/\s+/g," "),(t=this.links[t.toLowerCase()])&&t.href?(this.inLink=!0,s+=this.outputLink(a,t),this.inLink=!1):(s+=a[0].charAt(0),e=a[0].substring(1)+e);else if(a=this.rules.strong.exec(e))e=e.substring(a[0].length),s+=this.renderer.strong(this.output(a[2]||a[1]));else if(a=this.rules.em.exec(e))e=e.substring(a[0].length),s+=this.renderer.em(this.output(a[2]||a[1]));else if(a=this.rules.code.exec(e))e=e.substring(a[0].length),s+=this.renderer.codespan(u(a[2].trim(),!0));else if(a=this.rules.br.exec(e))e=e.substring(a[0].length),s+=this.renderer.br();else if(a=this.rules.del.exec(e))e=e.substring(a[0].length),s+=this.renderer.del(this.output(a[1]));else if(a=this.rules.text.exec(e))e=e.substring(a[0].length),s+=this.renderer.text(u(this.smartypants(a[0])));else if(e)throw new Error("Infinite loop on byte: "+e.charCodeAt(0));return s},i.prototype.outputLink=function(e,t){var n=u(t.href),t=t.title?u(t.title):null;return"!"!==e[0].charAt(0)?this.renderer.link(n,t,this.output(e[1])):this.renderer.image(n,t,u(e[1]))},i.prototype.smartypants=function(e){return this.options.smartypants?e.replace(/---/g,"—").replace(/--/g,"–").replace(/(^|[-\u2014/(\[{"\s])'/g,"$1‘").replace(/'/g,"’").replace(/(^|[-\u2014/(\[{\u2018\s])"/g,"$1“").replace(/"/g,"”").replace(/\.{3}/g,"…"):e},i.prototype.mangle=function(e){if(!this.options.mangle)return e;for(var t,n="",i=e.length,a=0;a<i;a++)t=e.charCodeAt(a),n+="&#"+(t=.5<Math.random()?"x"+t.toString(16):t)+";";return n},a.prototype.code=function(e,t,n){var i;return this.options.highlight&&null!=(i=this.options.highlight(e,t))&&i!==e&&(n=!0,e=i),t?'<pre><code class="'+this.options.langPrefix+u(t,!0)+'">'+(n?e:u(e,!0))+"\n</code></pre>\n":"<pre><code>"+(n?e:u(e,!0))+"\n</code></pre>"},a.prototype.blockquote=function(e){return"<blockquote>\n"+e+"</blockquote>\n"},a.prototype.html=function(e){return e},a.prototype.heading=function(e,t,n){return"<h"+t+' id="'+this.options.headerPrefix+n.toLowerCase().replace(/[^\w]+/g,"-")+'">'+e+"</h"+t+">\n"},a.prototype.hr=function(){return this.options.xhtml?"<hr/>\n":"<hr>\n"},a.prototype.list=function(e,t,n){var i=t?"ol":"ul";return"<"+i+(t&&1!==n?' start="'+n+'"':"")+">\n"+e+"</"+i+">\n"},a.prototype.listitem=function(e){return"<li>"+e+"</li>\n"},a.prototype.paragraph=function(e){return"<p>"+e+"</p>\n"},a.prototype.table=function(e,t){return"<table>\n<thead>\n"+e+"</thead>\n<tbody>\n"+t+"</tbody>\n</table>\n"},a.prototype.tablerow=function(e){return"<tr>\n"+e+"</tr>\n"},a.prototype.tablecell=function(e,t){var n=t.header?"th":"td";return(t.align?"<"+n+' style="text-align:'+t.align+'">':"<"+n+">")+e+"</"+n+">\n"},a.prototype.strong=function(e){return"<strong>"+e+"</strong>"},a.prototype.em=function(e){return"<em>"+e+"</em>"},a.prototype.codespan=function(e){return"<code>"+e+"</code>"},a.prototype.br=function(){return this.options.xhtml?"<br/>":"<br>"},a.prototype.del=function(e){return"<del>"+e+"</del>"},a.prototype.link=function(e,t,n){if(this.options.sanitize){try{var i=decodeURIComponent(l(e)).replace(/[^\w:]/g,"").toLowerCase()}catch(e){return n}if(0===i.indexOf("javascript:")||0===i.indexOf("vbscript:")||0===i.indexOf("data:"))return n}i='<a href="'+(e=this.options.baseUrl&&!h.test(e)?r(this.options.baseUrl,e):e)+'"';return t&&(i+=' title="'+t+'"'),i+=">"+n+"</a>"},a.prototype.image=function(e,t,n){e='<img src="'+(e=this.options.baseUrl&&!h.test(e)?r(this.options.baseUrl,e):e)+'" alt="'+n+'"';return t&&(e+=' title="'+t+'"'),e+=this.options.xhtml?"/>":">"},a.prototype.text=function(e){return e},s.prototype.strong=s.prototype.em=s.prototype.codespan=s.prototype.del=s.prototype.text=function(e){return e},s.prototype.link=s.prototype.image=function(e,t,n){return""+n},s.prototype.br=function(){return""},c.parse=function(e,t){return new c(t).parse(e)},c.prototype.parse=function(e){this.inline=new i(e.links,this.options),this.inlineText=new i(e.links,g({},this.options,{renderer:new s})),this.tokens=e.reverse();for(var t="";this.next();)t+=this.tok();return t},c.prototype.next=function(){return this.token=this.tokens.pop()},c.prototype.peek=function(){return this.tokens[this.tokens.length-1]||0},c.prototype.parseText=function(){for(var e=this.token.text;"text"===this.peek().type;)e+="\n"+this.next().text;return this.inline.output(e)},c.prototype.tok=function(){switch(this.token.type){case"space":return"";case"hr":return this.renderer.hr();case"heading":return this.renderer.heading(this.inline.output(this.token.text),this.token.depth,l(this.inlineText.output(this.token.text)));case"code":return this.renderer.code(this.token.text,this.token.lang,this.token.escaped);case"table":for(var e,t,n="",i="",a="",s=0;s<this.token.header.length;s++)a+=this.renderer.tablecell(this.inline.output(this.token.header[s]),{header:!0,align:this.token.align[s]});for(n+=this.renderer.tablerow(a),s=0;s<this.token.cells.length;s++){for(e=this.token.cells[s],a="",t=0;t<e.length;t++)a+=this.renderer.tablecell(this.inline.output(e[t]),{header:!1,align:this.token.align[t]});i+=this.renderer.tablerow(a)}return this.renderer.table(n,i);case"blockquote_start":for(i="";"blockquote_end"!==this.next().type;)i+=this.tok();return this.renderer.blockquote(i);case"list_start":for(var i="",n=this.token.ordered,r=this.token.start;"list_end"!==this.next().type;)i+=this.tok();return this.renderer.list(i,n,r);case"list_item_start":for(i="";"list_item_end"!==this.next().type;)i+="text"===this.token.type?this.parseText():this.tok();return this.renderer.listitem(i);case"loose_item_start":for(i="";"list_item_end"!==this.next().type;)i+=this.tok();return this.renderer.listitem(i);case"html":n=this.token.pre||this.options.pedantic?this.token.text:this.inline.output(this.token.text);return this.renderer.html(n);case"paragraph":return this.renderer.paragraph(this.inline.output(this.token.text));case"text":return this.renderer.paragraph(this.parseText())}};var p={},h=/^$|^[a-z][a-z0-9+.-]*:|^[?#]/i;function m(){}function g(e){for(var t,n,i=1;i<arguments.length;i++)for(n in t=arguments[i])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function b(e,n,i){if(null==e)throw new Error("marked(): input parameter is undefined or null");if("string"!=typeof e)throw new Error("marked(): input parameter is of type "+Object.prototype.toString.call(e)+", string expected");if(i||"function"==typeof n){i||(i=n,n=null);var a,s=(n=g({},b.defaults,n||{})).highlight,t=0;try{a=o.lex(e,n)}catch(e){return i(e)}var r=a.length,l=function(t){if(t)return n.highlight=s,i(t);var e;try{e=c.parse(a,n)}catch(e){t=e}return n.highlight=s,t?i(t):i(null,e)};if(!s||s.length<3)return l();if(delete n.highlight,!r)return l();for(;t<a.length;t++)!function(n){"code"!==n.type?--r||l():s(n.text,n.lang,function(e,t){return e?l(e):null==t||t===n.text?--r||l():(n.text=t,n.escaped=!0,void(--r||l()))})}(a[t])}else try{return n=n&&g({},b.defaults,n),c.parse(o.lex(e,n),n)}catch(e){if(e.message+="\nPlease report this to https://github.com/markedjs/marked.",(n||b.defaults).silent)return"<p>An error occurred:</p><pre>"+u(e.message+"",!0)+"</pre>";throw e}}m.exec=m,b.options=b.setOptions=function(e){return g(b.defaults,e),b},b.defaults={gfm:!0,tables:!0,breaks:!1,pedantic:!1,sanitize:!1,sanitizer:null,mangle:!0,smartLists:!1,silent:!1,highlight:null,langPrefix:"lang-",smartypants:!1,headerPrefix:"",renderer:new a,xhtml:!1,baseUrl:null},b.Parser=c,b.parser=c.parse,b.Renderer=a,b.TextRenderer=s,b.Lexer=o,b.lexer=o.lex,b.InlineLexer=i,b.inlineLexer=i.output,b.parse=b,"undefined"!=typeof module&&"object"==typeof exports?module.exports=b:"function"==typeof define&&define.amd?define(function(){return b}):e.marked=b}(this||("undefined"!=typeof window?window:global));var scheduleEmailEditRTE="",activeFilterCondition="",specificTemplates=[];function changeEmailContents(e){$("#selected-users-container_editable-content").val(e.MailBody),$("#subject-area").val(e.Subject);var t=$("#selected-users-container"),n=$("#selected-users-container_editable-content"),i=$("#selected-users-container_toolbar button"),a=$(".btn[data-id='email-subject-variables']"),s=$(".btn[data-id='widget-items']");e.IsDefaultTemplate?($("#enable-schedule-template").prop("checked",!1),$("#enable-schedule-template").attr("disabled",!0),$("#subject-area").prop("disabled",!0),scheduleEmailEditRTE.disableToolbarItem(scheduleEmailEditRTE.toolbarSettings.items),t.addClass("disabled-container"),n.prop("readonly",!0).addClass("disabled-textarea"),i.prop("disabled",!0),i.off("click"),n.prop("disabled",!0),a.addClass("disabled").attr("aria-disabled",!0),s.addClass("disabled").attr("aria-disabled",!0)):$("#enable-schedule-template").prop("checked")?($("#enable-schedule-template").prop("checked",!1),toggleEmailCustomization()):$("#enable-schedule-template").attr("disabled",!1)}function setSubjectAndBody(){for(var e=$("#email-templates option:selected").val(),t={},n=0;n<specificTemplates.length;n++)(e==specificTemplates[n].Id||0==e&&specificTemplates[n].IsDefaultTemplate)&&(t=specificTemplates[n]);""===$("#selected-users-container_editable-content").val().trim()&&$("#selected-users-container_editable-content").val(t.MailBody),""!==$("#selected-users-container_editable-content").val().trim()&&$("#email-content-validation").html("")}function toggleEmailCustomization(){var e=$("#enable-schedule-template").prop("checked"),t=$("#selected-users-container"),n=$("#selected-users-container_editable-content"),i=$("#selected-users-container_toolbar button"),a=$(".btn[data-id='email-subject-variables']"),s=$(".btn[data-id='widget-items']");setSubjectAndBody(),$("#subject-area, #email-editor-panel input, #widget-items, #add-alert-column").prop("disabled",!e),e?(scheduleEmailEditRTE.enableToolbarItem(scheduleEmailEditRTE.toolbarSettings.items),t.removeClass("disabled-container"),n.prop("readonly",!1).removeClass("disabled-textarea"),i.prop("disabled",!1),n.prop("disabled",!1),a.removeClass("disabled").attr("aria-disabled",!1),s.removeClass("disabled").attr("aria-disabled",!1)):(scheduleEmailEditRTE.disableToolbarItem(scheduleEmailEditRTE.toolbarSettings.items),t.addClass("disabled-container"),n.prop("readonly",!0).addClass("disabled-textarea"),i.prop("disabled",!0),i.off("click"),n.prop("disabled",!0),a.addClass("disabled").attr("aria-disabled",!0),s.addClass("disabled").attr("aria-disabled",!0),$("#email-content-validation").html(""),$(".email-subject-text").removeClass("has-error"),$("#email-subject-validation").css("display","none"),""===$("#subject-area").val()&&setDefaultEmailSubject())}function selectSubjectVariables(e){var t=[],n=e.match(/{:(.*?)}/g);if(null!=n)for(i=0;i<n.length;i++)"{:general.organizationname}"===n[i].toLowerCase()?t.push("Organization Name"):"{:Schedule.resource.name}"===n[i].toLowerCase()?t.push("Schedule Name"):"{:Schedule.resource.dashboardname}"===n[i].toLowerCase()?t.push("Dashboard Name"):"{:general.date}"===n[i].toLowerCase()?t.push("Date"):"{:general.time}"===n[i].toLowerCase()&&t.push("Time"),$("#email-subject-variables").selectpicker("val",t)}function setDefaultEmailSubject(){2==alertChange?$("#subject-area").val("{:General.OrganizationName}: Data Alert - {:Schedule.Resource.Name}"):$("#subject-area").val("{:General.OrganizationName}: Your scheduled dashboard")}function getRelativePath(e){$("#itemType").attr("data-item-type").toLowerCase().replace(/\b[a-z]/g,function(e){return e.toUpperCase()});var t=e.match(/(?:\!\[\]\((.*?)\))/g),n=[];if(null!=t)for(var i=0;i<t.length;i++)n[i]=t[i].split(/[\(\\!\[\ \]\\)\s]+/),n[i]=$.grep(n[i],function(e){return e});return e}function setValue(e){var t=scheduleEmailEditRTE.inputElement.selectionStart,n=(scheduleEmailEditRTE.inputElement.selectionEnd,scheduleEmailEditRTE.formatter.editorManager.markdownSelection.getSelectedInlinePoints(scheduleEmailEditRTE.inputElement));scheduleEmailEditRTE.inputElement.value=scheduleEmailEditRTE.inputElement.value.substr(0,t)+e+scheduleEmailEditRTE.inputElement.value.substr(n.end,scheduleEmailEditRTE.inputElement.value.length)}$(document).ready(function(){$(".schedule-dialog #email-editor-panel").css("display","inline"),$(".selectpicker").selectpicker("show");var e="";if(2==alertChange){for(var t=0;t<filterContent.Filters.length;t++)e+="<option data-id='"+filterContent.Filters[t].FilterName+"'>"+filterContent.Filters[t].DisplayText+"</option>";$("#widget-items").html(e).selectpicker("refresh")}else $("#data-alert-header").hide();"Create"==actionType||""==subject?(setDefaultEmailSubject(),selectSubjectVariables($("#subject-area").val())):"Edit"==actionType&&($("#subject-area").val(subject),selectSubjectVariables(subject));var n=(ejdashboard||ejs).richtexteditor;scheduleEmailEditRTE=new n.RichTextEditor({height:"410px",cssClass:"bbi-designer",formatter:new n.MarkdownFormatter({listTags:{OL:"1., 2., 3."}}),toolbarSettings:{items:["Bold","Italic","|","Formats","OrderedList","UnorderedList","|","CreateLink","Image","|",{tooltipText:"Preview",template:'<button id="preview-code" class="e-tbar-btn e-control e-btn e-icon-btn"><span class="e-btn-icon su su-preview e-icons"></span></button>'},{tooltipText:"Reset",template:'<button id="reset-code" class="e-tbar-btn e-control e-btn e-icon-btn"><span class="e-btn-icon su su-reset e-icons"></span></button>'}]},editorMode:"Markdown",created:function(){textArea=scheduleEmailEditRTE.contentModule.getEditPanel(),mdsource=document.getElementById("preview-code"),mdResetSource=document.getElementById("reset-code"),mdsource.addEventListener("click",function(e){var t,n,i;t=ejdashboard||ejs,n=scheduleEmailEditRTE.getID()+"html-preview",i=scheduleEmailEditRTE.element.querySelector("#"+n),mdsource.classList.contains("e-active")?(mdsource.classList.remove("e-active"),mdsource.parentElement.title="Preview",scheduleEmailEditRTE.enableToolbarItem(scheduleEmailEditRTE.toolbarSettings.items),textArea.style.display="block",i.style.display="none"):(mdsource.classList.add("e-active"),scheduleEmailEditRTE.disableToolbarItem(scheduleEmailEditRTE.toolbarSettings.items),i||((i=t.base.createElement("div",{className:"e-content e-pre-source"})).id=n,textArea.parentNode.appendChild(i)),textArea.style.display="none",i.style.display="block",i.innerHTML=marked(scheduleEmailEditRTE.contentModule.getEditPanel().value),mdsource.parentElement.title="Code View"),e.currentTarget.classList.contains("e-active")?scheduleEmailEditRTE.disableToolbarItem(["Bold","Italic","OrderedList","UnorderedList","CreateLink","Image","Formats","Undo","Redo"]):scheduleEmailEditRTE.enableToolbarItem(["Bold","Italic","OrderedList","UnorderedList","CreateLink","Image","Formats","Undo","Redo"])}),mdResetSource.addEventListener("click",function(){""==scheduleEmailEditRTE.value||null==scheduleEmailEditRTE.value?$("#email-content-validation").html(window.Server.App.Localization.ScheduleMessageValidator):$("#email-content-validation").html("")})}}),"Create"==actionType||null==emailContent?1==alertChange?scheduleEmailEditRTE.value="Hello {:Username},\n\nPlease find attached, the dashboard that you had requested. \n \nSchedule- {:ScheduleName} has exported the dashboard [{:DashboardName}]({:DashboardLink}).\n\nRegards,\n\n{:OrganizationName}":scheduleEmailEditRTE.value="Hi {:Username},\n\nThe configured data notification condition has been met. \n \nPlease find a snapshot of the current state of the dashboard attached.\n\nRegards,\n\n{:OrganizationName}":emailContent.includes("data notification")&&1==alertChange?scheduleEmailEditRTE.value="Hello {:Username},\n\nPlease find attached, the dashboard that you had requested. \n \nSchedule- {:ScheduleName} has exported the dashboard [{:DashboardName}]({:DashboardLink}).\n\nRegards,\n\n{:OrganizationName}":scheduleEmailEditRTE.value=emailContent,""==emailContent&&(1==alertChange?scheduleEmailEditRTE.value="Hello {:Username},\n\nPlease find attached, the dashboard that you had requested. \n \nSchedule- {:ScheduleName} has exported the dashboard [{:DashboardName}]({:DashboardLink}).\n\nRegards,\n\n{:OrganizationName}":scheduleEmailEditRTE.value="Hi {:Username},\n\nThe configured data notification condition has been met. \n \nPlease find a snapshot of the current state of the dashboard attached.\n\nRegards,\n\n{:OrganizationName}"),scheduleEmailEditRTE.appendTo("#email-editor-panel #selected-users-container"),"undefined"!=typeof BoldBIDashboard&&"function"==typeof parent.$("#popup-container_wrapper").BoldBIDashboardWaitingPopup?(parent.$("#popup-container_wrapper").BoldBIDashboardWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").BoldBIDashboardWaitingPopup("hide")):(parent.$("#popup-container_wrapper").ejWaitingPopup("hide"),parent.$("#editpopup-container_wrapper").ejWaitingPopup("hide")),2==alertChange&&(activeFilterCondition=$("#widget-items option").val().trim()),""!=emailContent&&(n=document.getElementById("enable-schedule-template"),$(n).prop("checked","checked")),toggleEmailCustomization();var i="";""==i&&$.ajax({type:"GET",url:specificEventListURL+"?templateId="+(2==alertChange?12:13),success:function(e){if(null!=e.result)for(var t=e.result,e=(specificTemplates=e.result,t.sort((e,t)=>t.IsDefaultTemplate-e.IsDefaultTemplate)),t=e,n=0;n<t.length;n++)null==item||null==item.Recurrence||0==item.Recurrence.TemplateId?t[n].IsDefaultTemplate?(i+='<option selected="selected" value="0">'+window.Server.App.Localization.InheritDefaultTemplateFromSystem+"</option>",$("#enable-schedule-template").attr("disabled",!0),changeEmailContents(t[n])):i+='<option value="'+t[n].Id+'">'+t[n].EmailTemplateName+"</option>":t[n].Id==item.Recurrence.TemplateId?(eventId=t[n].Id,i+='<option selected="selected" value="'+t[n].Id+'">'+t[n].EmailTemplateName+"</option>",t[n].IsDefaultTemplate&&$("#enable-schedule-template").attr("disabled",!0),""===emailContent&&changeEmailContents(t[n])):t[n].IsDefaultTemplate?i+='<option selected="selected" value="0">'+window.Server.App.Localization.InheritDefaultTemplateFromSystem+"</option>":i+='<option value="'+t[n].Id+'">'+t[n].EmailTemplateName+"</option>";$("#email-templates").html(""),$("#email-templates").html(i).selectpicker("refresh")}})}),$(document).on("change","#email-templates",function(){for(var e=$("#email-templates option:selected").val(),t={},n=0;n<specificTemplates.length;n++)(e==specificTemplates[n].Id||0==e&&specificTemplates[n].IsDefaultTemplate)&&(t=specificTemplates[n]);$("#email-content-validation").html(""),$("#email-content-validation").removeClass("email-error"),$(".email-subject-text").removeClass("has-error"),$("#email-subject-validation").css("display","none"),$("#email-subject-variables").selectpicker("val","Organization Name"),eventId=e,changeEmailContents(t)}),$(document).on("click","#preview-code",function(){$(".su-reset").hasClass("disable-reset")?($("#reset-code").attr("disabled",!1),$(".su-reset").removeClass("disable-reset")):($(".su-reset").addClass("disable-reset"),$("#reset-code").attr("disabled",!0))}),$(document).on("click","#reset-code",function(){setSubjectAndBody()}),$(document).on("click","#enable-schedule-template",function(e){toggleEmailCustomization()}),$(document).on("change","#email-subject-variables",function(e){var t="";if($(this).find("option").is(":selected")){var n=$(this).find("option:selected").length,a=[],s="";for(i=0;i<n;i++)"Organization Name"===$(this).val()[i]?s="General.OrganizationName":"Schedule Name"===$(this).val()[i]?s="Schedule.Resource.Name":"Dashboard Name"===$(this).val()[i]?s="Schedule.Resource.DashboardName":"Date"===$(this).val()[i]?s="General.Date":"Time"===$(this).val()[i]&&(s="General.Time"),a.push("{:"+s+"}"),t=a.join("-");$("#subject-area").val(t)}else setDefaultEmailSubject();""!=$(this).val()&&($(".email-subject-text").removeClass("has-error"),$("#email-subject-validation").css("display","none"))}),$(document).on("focusout","#subject-area",function(){var e=$(this).val();$("#email-subject-variables").selectpicker("val",[]),selectSubjectVariables(e),(""!=$(this).val().trim()||""!=$("#subject-area").val().trim()&&$("#subject-area").val().trim().length<=$("#subject-area").attr("data-maxlength"))&&($(".email-subject-text").removeClass("has-error"),$("#email-subject-validation").css("display","none"))}),document.getElementById("add-alert-column").addEventListener("click",function(){scheduleEmailEditRTE.focusIn();var e=$("#email-alert-widget-container .bootstrap-select").find(".dropdown-menu ul .selected a")[0].text.trim();setValue("{:"+(activeFilterCondition=activeFilterCondition!=e?e:activeFilterCondition)+"}"),$("#email-content-validation").html("")}),$(document).on("click","#selected-users-containerhtml-preview p a",function(e){e.preventDefault()}),$(document).on("click","#email-alert-widget-container .bootstrap-select .dropdown-menu ul .selected a",function(e){activeFilterCondition=$("#widget-items option")[$(e.target.parentElement).index()].value.trim()}),$(document).on("keyup","#selected-users-container_editable-content",function(){var e=$("#selected-users-container_editable-content").val().trim();""==(e=null==e?null:e.replace(/(<([^>]+)>)/gi,""))||null==e?$("#email-content-validation").html(window.Server.App.Localization.ScheduleMessageValidator):$("#email-content-validation").html("")}),$(document).on("click","#selected-users-container_toolbar_CreateLink",function(e){$("#selected-users-container_rtelink").find(".e-footer-content").children().last().addClass("e-cancel")});