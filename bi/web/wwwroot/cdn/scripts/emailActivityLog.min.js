/*!
*  filename: emailActivityLog.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function setTimpickerValue(){emailActivityLogTimeFomat=="True"?(emailLogStartDateTime="00:00",emailLogEndDateTime="23:59"):(emailLogStartDateTime="12:00 AM",emailLogEndDateTime="11:59 PM")}function openEmailLogDetails(){var t=angular.element("[ng-controller=EmailLogInfoCtrl]").scope(),n=$("#emailActivityLogGrid").ejGrid("instance"),i=n.getCurrentViewData()[n.getIndexByRow($("tr.e-row[aria-selected *='true']"))];t.openEmailLogInfoDialog(i)}function fnActionBegin(n){var r=[],t,i;if(n.model.filterSettings.filteredColumns.length>0){for(t=0;t<n.model.filterSettings.filteredColumns.length;t++)i=n.model.filterSettings.filteredColumns[t],r.push({PropertyName:i.field,FilterType:i.operator,FilterKey:i.value});this.model.query._params.push({key:"filterCollection",value:r})}}function DateRangeLocalization(){var n={customPicker:window.Server.App.Localization.CustomPicker,watermarkText:window.Server.App.Localization.SelectRange};typeof BoldBIDashboard!="undefined"?BoldBIDashboard.DateRangePicker.Locale["en-US"]=n:ej.DateRangePicker.Locale["en-US"]=n}var emailLogStartDateTime="",emailLogEndDateTime="";$(document).ready(function(){$("[data-toggle='tooltip'], .selectpicker").tooltip();DateRangeLocalization();$("#datePicker").ejDateRangePicker({dateFormat:emailActivityLogDateFormat,locale:"en-US",buttonText:{apply:window.Server.App.Localization.Apply,cancel:window.Server.App.Localization.CancelButton,reset:window.Server.App.Localization.Reset},ranges:[{label:window.Server.App.Localization.Today,range:[new Date,new Date]},{label:window.Server.App.Localization.Yesterday,range:[new Date((new Date).setDate((new Date).getDate()-1)),new Date((new Date).setDate((new Date).getDate()-1))]},{label:window.Server.App.Localization.LastDays.format("7"),range:[new Date((new Date).setDate((new Date).getDate()-7)),new Date]},{label:window.Server.App.Localization.LastDays.format("15"),range:[new Date((new Date).setDate((new Date).getDate()-14)),new Date]},{label:window.Server.App.Localization.LastDays.format("30"),range:[new Date((new Date).setMonth((new Date).getMonth()-1)),new Date]},{label:window.Server.App.Localization.LastDays.format("60"),range:[new Date((new Date).setMonth((new Date).getMonth()-2)),new Date]},{label:window.Server.App.Localization.ThisWeek,range:[new Date((new Date).setDate((new Date).getDate()-(new Date).getDay())),new Date((new Date).setDate((new Date).getDate()-(new Date).getDay()+6))]},{label:window.Server.App.Localization.ThisMonth,range:[new Date((new Date).getFullYear(),(new Date).getMonth(),1),new Date((new Date).getFullYear(),(new Date).getMonth()+1,0)]}]});var n=$("#emailActivityLogGrid").ejGrid("instance");$(".e-gridheader .e-filtericon").mousedown(function(t){var i=t.target;$("#emailActivityLogGrid_stringDlg").ejDialog({open:function(){$(i).parent().find(".e-headercelldiv").attr("ej-mappingname")=="Status"&&($("#emailActivityLogGridstring_ddinput_hidden").val("Contains"),$("#"+n._id+"string_ddinput_popup_wrapper").find("li[value='Equal']").hide(),$("#"+n._id+"string_ddinput_popup_wrapper").find("li[value='NotEqual']").hide(),$("#"+n._id+"string_ddinput_popup_wrapper").find("li[value='StartsWith']").hide(),$("#"+n._id+"string_ddinput_popup_wrapper").find("li[value='EndsWith']").hide())}})})});$(document).on("click","#email-log-filter-apply-button",function(){$.ajax({type:"GET",url:emailSettingsPagePermissionUrl,data:{scope:SettingsScopes.Email},success:function(n){if(n.status){setTimpickerValue();var t=$("#datePicker").val().split("-"),r=$.trim(t[0])!=""?$.trim(t[0])+" "+emailLogStartDateTime:"",u=$.trim(t[1])!=""?$.trim(t[1])+" "+emailLogEndDateTime:"",f=$("#email-event").val().toString(),i=$("#emailActivityLogGrid").data("ejGrid"),e=ej.DataManager({url:filterEmailLogsUrl+"?startDate="+r+"&endDate="+u+"&eventType="+f,adaptor:new ej.UrlAdaptor});i.dataSource(e);i.model.pageSettings.currentPage=1}else n.permissionDenied&&warningToast(window.Server.App.Localization.AdminPageAccessWarningAlert,null,(new Date).getTime())}})});$(document).on("click",".email-log-info",function(){openEmailLogDetails()});serverApp.controller("EmailLogInfoCtrl",["$scope","$timeout",function(n,t){n.EmailLogDetail=null;n.closeItemInfo=function(){$("#emaillog-info-popup").ejDialog("close");$(".mail-error-message").hide()};n.openEmailLogInfoDialog=function(i){i.StatusMessage!=""&&i.StatusMessage!=null&&$(".mail-error-message").show();n.EmailLogDetail=i;$("#emaillog-info-popup").ejDialog({width:window.innerWidth>480?"400px":window.innerWidth-10+"px",height:"548px",showOnInit:!1,allowDraggable:!1,enableResize:!1,showHeader:!1,enableModal:!0});$("#emaillog-info-popup").ejDialog("open");$("#emaillog-info-popup").ejDialog("refresh");t(function(){n.$apply()},100)}}])