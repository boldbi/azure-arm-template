/*!
*  filename: intermediatedb-configuration.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function renderdataCachePage(){var n={serviceUrl:designerServiceUrl,serverUrl:dashboardServerUrl,serviceAuthorizationToken:designerToken,mode:BoldBIDashboard.Designer.mode.datacache,designerAppSettings:{cacheSettingServerInfo:dataCache},actionComplete:$.proxy(afterSaveDataCacheSettings,this)},t=new BoldBIDashboardDesigner($("#dataCacheDesigner"),n)}function afterSaveDataCacheSettings(n){$("#body").BoldBIDashboardWaitingPopup("hide");n.data.status?successToast(window.Server.App.Localization.UpdateSettingsSuccess,7e3):n.data.status||n.data.message==""||warningToast(window.Server.App.Localization.DataCacheErrorMessage,n.data.message,7e3,window.Server.App.Localization.Error)}var designerServiceUrl="",dashboardServerUrl="",designerToken="";$(document).ready(function(){function u(){var t,n;$(".has-error").removeClass("has-error");$(".validation-txt-errors").hide();$(".validation-errors").html("");$("#connection-validation").addClass("display-none");$("#update-datastore-settings").prop("disabled",!0);t=$("#db-content-holder").valid();t&&($("#content-area").ejWaitingPopup("show"),window.serverName=$("#txt-servername").val(),window.portNumber=$("#txt-portnumber").val(),window.maintenanceDatabase=$("#txt-maintenancedb").val(),window.IsWindowsAuthentication=$("#check-windows").val()=="windows",window.login=$("#txt-login").val(),window.password=$("#txt-password-db").val(),n=$("#database-type").val(),window.databaseName=$("#txt-dbname").val(),window.imDbAdditionalParameters=$("#additional-db-parameter").val(),window.sslEnabled=$("#secure-sql-connection").is(":checked"),doAjaxPost("POST",connectDatabaseUrl,{data:JSON.stringify({ServerType:n,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,databaseName:window.databaseName,imDbAdditionalParameters:window.imDbAdditionalParameters,sslEnabled:window.sslEnabled,isNewDatabase:!0})},function(t){t.Data.key?(doAjaxPost("POST",generateIntermediateDatabaseUrl,{data:JSON.stringify({ServerType:n,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,databaseName:window.databaseName,imDbAdditionalParameters:window.imDbAdditionalParameters,sslEnabled:window.sslEnabled,Prefix:""})},function(t){t.Data.key?($(".selected").removeClass("selected"),window.connectionString=t.Data.value,doAjaxPost("POST",updateIntermediateDBUrl,{data:JSON.stringify({ServerType:n,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,databaseName:window.databaseName,imDbAdditionalParameters:window.imDbAdditionalParameters,sslEnabled:window.sslEnabled,Prefix:""})},function(n){n.Data!=undefined&&n.Data.key?successToast(window.Server.App.Localization.UpdateSettingsSuccess,7e3):warningToast(n.permissionDenied!=undefined&&n.permissionDenied?window.Server.App.Localization.PermissionWarningAlert+" "+window.Server.App.Localization.ReloadPage:window.Server.App.Localization.DataStoreErrorMessage,n.permissionDenied!=undefined&&n.permissionDenied?null:n.message,(new Date).getTime(),window.Server.App.Localization.DatabaseSettings);$("#content-area").ejWaitingPopup("hide")}),$("#txt-username").focus(),delete window.serverName,delete window.portNumber,delete window.maintenanceDatabase,delete window.login,delete window.password,delete window.databaseName,delete window.imDbAdditionalParameters,delete window.sslEnabled):($("#content-area").ejWaitingPopup("hide"),$("#connection-validation").removeClass("display-none"),$("#connection-validation").find(".validation-errors").html(t.Data.value).css("display","block"))}),$("#txt-dbname").focus()):($("#content-area").ejWaitingPopup("hide"),$("#connection-validation").removeClass("display-none"),$("#connection-validation").find(".validation-errors").html(t.Data.value).css("display","block"))}))}function t(){$("#connection-validation").find(".validation-errors").html("");$("#connection-validation").addClass("display-none")}var r,n,i;designerServiceUrl=$('meta[name="designer_service:url"]').attr("content");dashboardServerUrl=$('meta[name="dashboard_server:url"]').attr("content");designerToken=$('meta[name="designer_service:access_token"]').attr("content");renderdataCachePage();r=createLoader("body");$("#body").BoldBIDashboardWaitingPopup({template:$("#"+r)});n=$("input[name=databaseType]:checked").val()==="0"?!0:!1;$("#connection-validation").addClass("display-none");$("#database-type").on("change",function(){var n=$("#database-type").val().toLowerCase(),t=$("#check-windows").val()==="windows";n==="mssql"?($("#db-content-holder").show(),$("#db-content-holder").removeClass("display-none"),$("#port-number-dropdown").removeClass("show").addClass("hide"),$("#maintenance-db-dropdown").removeClass("show").addClass("hide"),$("#authentication-dropdown").removeClass("hide").addClass("show"),t?($("#txt-login").val("").attr("disabled",!0),$("#txt-password-db").val("").attr("disabled",!0)):($("#txt-login").attr("disabled",!1),$("#txt-password-db").attr("disabled",!1)),$("a.redirect-link").attr("href",mssqlConnectionParameterHelpLink)):n==="postgresql"?($("#db-content-holder").show(),$("#db-content-holder").removeClass("display-none"),$("#authentication-dropdown").removeClass("show").addClass("hide"),$("#port-number-dropdown").removeClass("hide").addClass("show"),$("#maintenance-db-dropdown").removeClass("hide").addClass("show"),$("#txt-login").attr("disabled",!1),$("#txt-password-db").attr("disabled",!1),$("#txt-maintenancedb").val(maintenanceDb),$("#txt-portnumber").val(postgrePortNumber),$("a.redirect-link").attr("href",postgresqlConnectionParameterHelpLink)):n==="mysql"?($("#db-content-holder").show(),$("#db-content-holder").removeClass("display-none"),$("#authentication-dropdown").removeClass("show").addClass("hide"),$("#port-number-dropdown").removeClass("hide").addClass("show"),$("#maintenance-db-dropdown").removeClass("show").addClass("hide"),$("#txt-login").attr("disabled",!1),$("#txt-password-db").attr("disabled",!1),$("#txt-portnumber").val(mysqlPortNumber),$("a.redirect-link").attr("href",mysqlConnectionParameterHelpLink)):($("#db-content-holder").addClass("display-none"),$("#port-number-dropdown").removeClass("show").addClass("hide"),$("#maintenance-db-dropdown").removeClass("show").addClass("hide"),$("#authentication-dropdown").removeClass("hide").addClass("show"),$("#database-name").html("<option value='' class='display-none'>"+window.Server.App.Localization.SelectDatabase+"<\/option>").selectpicker("refresh"),$("#txt-servername").val(""),$("#txt-dbname").val(""),$("#txt-login").val(""),$("#txt-password-db").val(""))});$("#check-windows").on("click change",function(){var n=$("#check-windows").val()=="windows",t=$("#database-type").val();n?($("#txt-login").val("").attr("disabled",!0),$("#txt-password-db").val("").attr("disabled",!0)):($("#txt-login").attr("disabled",!1),$("#txt-password-db").attr("disabled",!1));$(".has-error").removeClass("has-error");$(".validation-txt-errors").hide()});$("input[type=radio][name=databaseType]").change(function(){t();$(this).val()==="0"?($("#existing-db-form").addClass("display-none"),$("#new-db-form").removeClass("display-none"),$("#txt-dbname").val(""),n=!0):($("#existing-db-form").removeClass("display-none"),$("#new-db-form").addClass("display-none"),n=!1)});$.validator.addMethod("isValidDatabaseName",function(n){if(/^[a-zA-Z_0-9@~!#\$\^&()+=\-,\.\/\{\} ]+$/.test(n)&&!/^[\s]+|[\s]+$/g.test(n))return!0},window.Server.App.Localization.AvoidLeadingTrailingSpace);$.validator.addMethod("sqlUsernamevalidation",function(n){if(/^[a-zA-Z_0-9@`~!#\$\^%&*()+=\-\[\]\\\',\.\/\{\}\|:<>\? ]+$/.test(n)&&!/^[\s]/g.test(n))return!0},window.Server.App.Localization.AvoidLeadingSpace);$.validator.addMethod("isValidCredentials",function(n){return/^[a-zA-Z_0-9@`~!#\$\^%&*()+=\-\[\]\\\',\.\/\{\}\|:<>\? ]+$/.test(n)},window.Server.App.Localization.AvoidSpecialCharacters);$("#db-content-holder").validate({errorElement:"span",onkeyup:function(n,i){t();i.keyCode!=9?(isKeyUp=!0,$(n).valid(),isKeyUp=!1):!0},onfocusout:function(n){$(n).valid()},rules:{servername:{isRequired:!0},portnumber:{isRequired:!0},maintenancedatabase:{isRequired:!0},username:{required:!0,sqlUsernamevalidation:!0},password:{required:!0,isValidCredentials:!0},dbname:{required:{depends:function(){return $("input[name='databaseType']:checked").val()==="0"||$("input[name='databaseType']:checked").val()==="1"}},isValidDatabaseName:{depends:function(){return $("input[name='databaseType']:checked").val()==="0"}}}},highlight:function(n){$(n).closest(".txt-holder").addClass("has-error");$(n).closest(".text-holder").addClass("has-error");$(n).parent().find(">.startup-validation").show()},unhighlight:function(n){$(n).closest(".txt-holder").removeClass("has-error");$(n).closest(".text-holder").removeClass("has-error");$(n).parent().find(">.startup-validation").hide()},errorPlacement:function(n,t){$(t).parent().find(">.startup-validation").html(n.html())},messages:{servername:{isRequired:window.Server.App.Localization.ServerNamevalidator},portnumber:{isRequired:window.Server.App.Localization.PortValidator},maintenancedatabase:{isRequired:window.Server.App.Localization.MaintenanceDatabaseValidator},username:{required:window.Server.App.Localization.UserNameValidator},password:{required:window.Server.App.Localization.PasswordValidator},dbname:{required:window.Server.App.Localization.DatabaseValidator}}});$(document).on("click",".databse-dropdown .dropdown-toggle",function(){var t,n,i;$(".databse-dropdown ul").html("");$("#database-name").html("<option value='' class='display-none'>"+window.Server.App.Localization.SelectDatabase+"<\/option>").selectpicker("refresh");t=$("#check-windows").val()==="windows";t?n=$("#txt-servername").valid()?!0:!1:($("#txt-login").valid(),$("#txt-servername").valid(),$("#txt-portnumber").valid(),$("#txt-maintenancedb").valid(),$("#txt-password-db").valid(),n=$("#txt-login").val()!==""&&$("#txt-servername").val()!==""&&$("#txt-password-db").val()!==""?!0:!1);n&&($("#waiting-icon").show(),window.serverName=$("#txt-servername").val(),window.portNumber=$("#txt-portnumber").val(),window.maintenanceDatabase=$("#txt-maintenancedb").val(),window.IsWindowsAuthentication=$("#check-windows").val()=="windows",window.login=$("#txt-login").val(),window.password=$("#txt-password-db").val(),i=$("#database-type").val(),window.databaseName=$("#txt-dbname").val(),window.sslEnabled=$("#secure-sql-connection").is(":checked"),doAjaxPost("POST",getAllDatabaseUrl,{data:JSON.stringify({ServerType:i,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,sslEnabled:window.sslEnabled})},function(n){var t,u,i,r,f;if(n.Data.key){if($("#database-error").hide(),$("#connection-validation").addClass("display-none"),t=n.Data.value,u="",t.length>0){for(i=0;i<t.length;i++)u+='<option value="'+t[i]+'">'+t[i]+"<\/option>";for($("#connection-validation").find(".validation-errors").html(""),$("#database-name").append(u).selectpicker("refresh"),r=0;r<$("#db-content-holder .databse-dropdown .bootstrap-select li a .text").length;r++)f=$("#db-content-holder .databse-dropdown .bootstrap-select li a .text").eq(r).text(),$("#db-content-holder .databse-dropdown .bootstrap-select li a").eq(r).attr("title",f)}else $("#database-name").selectpicker("refresh").html("<option value='' class='display-none'>"+window.Server.App.Localization.SelectDatabase+"<\/option>").selectpicker("refresh"),$(".databse-dropdown ul").html("<li class='no-results active' title='"+window.Server.App.Localization.NodatabaseTitle+"' style='display: list-item;'>"+window.Server.App.Localization.Nodatabase+"<\/li>");$("#waiting-icon").hide()}else $("#database-name").html("<option value='' class='display-none'>"+window.Server.App.Localization.SelectDatabase+"<\/option>").selectpicker("refresh"),$("#connection-validation").find(".validation-errors").html(n.Data.value).css("display","block"),$("#waiting-icon").hide()}))});$("#database-type-dropdown, #auth-type-dropdown, #secure-sql-connection").on("click",function(){t()});$("#update-datastore-settings").on("click",function(){var i,t;if(n)u(),$("#update-datastore-settings").prop("disabled",!1);else{if($(".has-error").removeClass("has-error"),$(".validation-txt-errors").hide(),$(".validation-errors").html(""),$("#connection-validation").addClass("display-none"),i=$("#db-content-holder").valid(),$("#database-name").val()==""){$("#database-error").html(window.Server.App.Localization.DatabaseType).show();return}i&&($("#content-area").ejWaitingPopup("show"),$("#update-datastore-settings").prop("disabled",!0),window.serverName=$("#txt-servername").val(),window.portNumber=$("#txt-portnumber").val(),window.maintenanceDatabase=$("#txt-maintenancedb").val(),window.IsWindowsAuthentication=$("#check-windows").val()=="windows",window.login=$("#txt-login").val(),window.password=$("#txt-password-db").val(),t=$("#database-type").val(),t=t=="SQLite"?"MSSQLCE":t,window.databaseName=$("#database-name").val()==""?$("#txt-dbname").val():$("#database-name").val(),window.imDbAdditionalParameters=$("#additional-db-parameter").val(),window.sslEnabled=$("#secure-sql-connection").is(":checked"),doAjaxPost("POST",connectDatabaseUrl,{data:JSON.stringify({ServerType:t,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,databaseName:window.databaseName,imDbAdditionalParameters:window.imDbAdditionalParameters,sslEnabled:window.sslEnabled,isNewDatabase:!1})},function(n){n.Data.key?(doAjaxPost("POST",updateIntermediateDBUrl,{data:JSON.stringify({ServerType:t,serverName:window.serverName,Port:window.portNumber,maintenanceDatabase:window.maintenanceDatabase,userName:window.login,password:window.password,IsWindowsAuthentication:window.IsWindowsAuthentication,databaseName:window.databaseName,imDbAdditionalParameters:window.imDbAdditionalParameters,sslEnabled:window.sslEnabled,Prefix:""})},function(n){n.Data!=undefined&&n.Data.key?successToast(window.Server.App.Localization.UpdateSettingsSuccess,7e3):warningToast(n.permissionDenied!=undefined&&n.permissionDenied?window.Server.App.Localization.PermissionWarningAlert+" "+window.Server.App.Localization.ReloadPage:window.Server.App.Localization.DataStoreErrorMessage,n.permissionDenied!=undefined&&n.permissionDenied?null:n.message,null,window.Server.App.Localization.DatabaseSettings);$("#update-datastore-settings").prop("disabled",!1);$("#content-area").ejWaitingPopup("hide")}),delete window.serverName,delete window.portNumber,delete window.maintenanceDatabase,delete window.login,delete window.password,delete window.databaseName,delete window.imDbAdditionalParameters,delete window.sslEnabled):($("#update-datastore-settings").prop("disabled",!1),$("#connection-validation").removeClass("display-none"),$("#connection-validation").find(".validation-errors").html(n.Data.value).css("display","block"),$("#content-area").ejWaitingPopup("hide"))}))}});setTimeout(function(){addTitleForDropdownList(".database-dropdown-margin")},1e3);i=window.location.search;i.contains("?tab=data-store")?($('a[href="#data-store"]').tab("show"),$("#datastore-settings-header").show()):i.contains("?tab=data-cache")?($('a[href="#data-cache"]').tab("show"),$("#datastore-settings-header").show()):($('a[href="#datastore-settings-tab"]').tab("show"),$("#datastore-settings-header").show())});$(document).on("click","#update-datacache-settings",function(){$.ajax({type:"GET",url:datacachePagePermissionUrl,data:{scope:SettingsScopes.DataStoreSettings},success:function(n){if(n.status){var t=$("#dataCacheDesigner").data("BoldBIDashboardDesigner");$("#body").BoldBIDashboardWaitingPopup("show");t.modules.dataCache.saveDataCacheSettings()}else n.permissionDenied&&warningToast(window.Server.App.Localization.PermissionWarningAlert,null,(new Date).getTime(),window.Server.App.Localization.DatabaseSettings)}})})