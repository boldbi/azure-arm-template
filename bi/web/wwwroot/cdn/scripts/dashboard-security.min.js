/*!
*  filename: dashboard-security.min.js
*  version : unknown version
*  Copyright Syncfusion Inc. 2001 - 2013. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
function openItemSettingsDialog(n){var r,i,u,t;itemInfo=n;r='<span class="dialog-header-with-subtitle"><span class ="dialog-header-title">'+window.Server.App.Localization.Security+'<\/span><span class="item-name">'+itemInfo.Name+"<\/span><\/span>";isDialogBinded?(t=document.getElementById("item-settings-dialog").ej2_instances,t[0].header=r,t[0].show(),$("#item-settings-dialog .e-primary").attr("disabled","true")):(i=document.createElement("div"),i.setAttribute("id","item-settings-dialog"),u=document.getElementById("dashboard-page-container"),u.appendChild(i),t=new ejs.popups.Dialog({header:r,content:document.getElementById("itemsettings-dialog-content"),buttons:[{click:function(n){if(n.keyCode==keyCode.Enter)return n.preventDefault(),!1;saveItemSettings()},buttonModel:{isPrimary:!0,disabled:!0,cssClass:"app-btn-primary",content:window.Server.App.Localization.SaveButton}},{click:function(){t.hide();$(".domain-name-validation").hide();$(".ip-address-validation").hide();cancelItemSettings();ClearSettingsFields()},buttonModel:{cssClass:"app-btn-secondary",content:window.Server.App.Localization.CancelButton}}],animationSettings:{effect:"Zoom"},beforeOpen:beforeOpenSecurityDialog,width:"600px",showCloseIcon:!0,isModal:!0}),t.appendTo(i),isDialogBinded=!0);ejs.popups.createSpinner({target:document.getElementById("item-settings-dialog")});ejs.popups.setSpinner({type:"Material"});ejs.popups.showSpinner(document.getElementById("item-settings-dialog"));getItemSettings();isChipChanged=!1}function beforeOpenSecurityDialog(){$("#itemsettings-dialog-content").show()}function saveItemSettings(){var i=document.getElementById("domain-chip-content").ej2_instances,r=document.getElementById("ip-chip-content").ej2_instances,u=$("#select-option").val(),f=$("<a/>",{href:getDashboardShareLink(itemInfo.Id,itemInfo.CategoryName,itemInfo.Name),target:"_blank",html:" "+itemInfo.Name+"."}),n,t;i!=undefined?(n=i[0].chips,n==null&&(n=[])):n=[];r!=undefined?(t=r[0].chips,t==null&&(t=[])):t=[];$.ajax({type:"POST",url:itemSettingsAccessUrl,data:{itemId:itemInfo.Id,ipAddressList:t,domainList:n,setting:u},success:function(n){n.result?successToast(window.Server.App.Localization.AddDashboardSecurity.format(f[0].outerHTML),7e3):warningToast(window.Server.App.Localization.SecurityFailed);var t=document.getElementById("item-settings-dialog").ej2_instances;t[0].hide()}})}function ClearSettingsFields(){var n,t;$("#domain-input-text").val("");n=document.getElementById("domain-chip-content").ej2_instances;n==undefined&&$("#domain-input-text").val().length==0&&applyDomainContainer();$("#ip-input-text").val("");t=document.getElementById("ip-chip-content").ej2_instances;t==undefined&&$("#ip-input-text").val().length==0&&applyIpContainer()}function getItemSettings(){domainChipData=[];ipChipData=[];getDomainInstance();getIpInstance();var n=itemInfo.Id;$.ajax({type:"POST",url:getItemSettingsUrl,data:{itemId:n},success:function(n){if(n.Status){if($("#select-option").val(n.result.SecuritySettingScope).selectpicker("refresh"),n.result.Domains!=null){for(i=0;i<n.result.Domains.length;i++)domainChipData[i]=n.result.Domains[i],domainChipData[i].length!=0&&domainChipConversion(domainChipData);domainCount=n.result.Domains.length}if(n.result.IPAddresses!=null){for(i=0;i<n.result.IPAddresses.length;i++)ipChipData[i]=n.result.IPAddresses[i],ipChipData[i].length!=0&&ipChipConversion(ipChipData);ipCount=n.result.IPAddresses.length}}ejs.popups.hideSpinner(document.getElementById("item-settings-dialog"))}})}function objectConvertAsChip(n){(n.endsWith(",")||n.endsWith(";")||n.endsWith("\n"))&&(n=n.slice(0,-1).trim());n.length!=0?isDomainSelected?validateDomainName(n)?isAlreadyExists(n)&&(domainChipData.push(n),domainChipConversion(domainChipData),$(".domain-name-validation").hide(),enableSaveButton()):($("#domain-input-text").val(n),addDomainValidation()):validateIpAddress(n)?(n.contains("/")||(n=isIPv6?n+"/128":n+"/32"),isIpAlreadyExistsorNot(n)&&(ipChipData.push(n),ipChipConversion(ipChipData),$(".ip-address-validation").hide(),enableSaveButton())):($("#ip-input-text").val(n),addIpValidation()):ClearSettingsFields()}function isAlreadyExists(n){var t=document.getElementById("domain-chip-content").ej2_instances;if(t!=undefined&&t[0].chips!=0&&t[0].chips!=null)for(i=0;i<t[0].chips.length;i++)if(t[0].chips[i].toLowerCase()==n.toLowerCase())return $("#domain-input-text").val(""),!1;return!0}function domainChipConversion(n){var t,i;isDomainChipBinded?(t=document.getElementById("domain-chip-content").ej2_instances,t[0].chips=[],t[0].chips=n,t[0].createChip(),t[0].refresh()):(new ejs.buttons.ChipList({chips:n,enableDelete:!0,"delete":onDomainChipDelete},"#domain-chip-content"),isDomainChipBinded=!0);$("#domain-name-content").height()>140&&(i=document.getElementById("domain-name-content"),i.scrollTop=i.scrollHeight);$("#domain-chip-content .e-chip-delete").addClass("domain-name");removeDomainContainer();applyDomainTooltip()}function removeDomainContainer(){$("#domain-input-text").css("width","10%").removeAttr("placeholder").val("");$("#domain-chip-content").css("display","inline")}function applyDomainContainer(){$("#domain-input-text").css("width","100%").attr("placeholder",window.Server.App.Localization.DomainContent);$("#domain-chip-content").hide()}function cancelItemSettings(){getDomainInstance();getIpInstance();ClearSettingsFields();domainCount=0;ipCount=0;$("#select-option").val("1").selectpicker("refresh")}function ipChipConversion(n){var t,i;isIpChipBinded?(t=document.getElementById("ip-chip-content").ej2_instances,t[0].chips=[],t[0].chips=n,t[0].createChip(),t[0].refresh()):(new ejs.buttons.ChipList({chips:n,enableDelete:!0,"delete":onIpChipDelete},"#ip-chip-content"),isIpChipBinded=!0);$("#ip-address-content").height()>140&&(i=document.getElementById("ip-address-content"),i.scrollTop=i.scrollHeight);removeIpContainer();applyIpTooltip()}function removeIpContainer(){$("#ip-input-text").css("width","10%").removeAttr("placeholder").val("");$("#ip-chip-content").css("display","inline")}function applyIpContainer(){$("#ip-input-text").css("width","100%").attr("placeholder",window.Server.App.Localization.IpContent);$("#ip-chip-content").hide()}function isIpAlreadyExistsorNot(n){var t=document.getElementById("ip-chip-content").ej2_instances;if(t!=undefined&&t[0].chips!=0&&t[0].chips!=null)for(i=0;i<t[0].chips.length;i++)if(t[0].chips[i]==n)return $("#ip-input-text").val(""),!1;return!0}function getDomainInstance(){var n=document.getElementById("domain-chip-content").ej2_instances;n!=undefined&&(n[0].chips=[],applyDomainContainer());$("#domain-chip-content").html("")}function getIpInstance(){var n=document.getElementById("ip-chip-content").ej2_instances;n!=undefined&&(n[0].chips=[],applyIpContainer());$("#ip-chip-content").html("")}function validateDomainName(n){var t;return/(?=^.{4,253}$)(^((?!-)[a-zA-Z0-9-]{0,62}[a-zA-Z0-9]\.)+[a-zA-Z]{2,63}$)/.test(n)?!0:(t=/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/,t.test(n))?!0:!1}function validateIpAddress(n){var t;return n.contains("/")&&(n=n.split("/"),t=n[1],n=n[0]),/^((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(n)?(isIPv6=!1,typeof t!="undefined"&&t>32)?!1:!0:/^s*((([0-9A-Fa-f]{1,4}:){7}([0-9A-Fa-f]{1,4}|:))|(([0-9A-Fa-f]{1,4}:){6}(:[0-9A-Fa-f]{1,4}|((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){5}(((:[0-9A-Fa-f]{1,4}){1,2})|:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3})|:))|(([0-9A-Fa-f]{1,4}:){4}(((:[0-9A-Fa-f]{1,4}){1,3})|((:[0-9A-Fa-f]{1,4})?:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){3}(((:[0-9A-Fa-f]{1,4}){1,4})|((:[0-9A-Fa-f]{1,4}){0,2}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){2}(((:[0-9A-Fa-f]{1,4}){1,5})|((:[0-9A-Fa-f]{1,4}){0,3}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(([0-9A-Fa-f]{1,4}:){1}(((:[0-9A-Fa-f]{1,4}){1,6})|((:[0-9A-Fa-f]{1,4}){0,4}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:))|(:(((:[0-9A-Fa-f]{1,4}){1,7})|((:[0-9A-Fa-f]{1,4}){0,5}:((25[0-5]|2[0-4]d|1dd|[1-9]?d)(.(25[0-5]|2[0-4]d|1dd|[1-9]?d)){3}))|:)))(%.+)?s*(\/([0-9]|[1-9][0-9]|1[0-1][0-9]|12[0-8]))?$/.test(n)?(isIPv6=!0,typeof t!="undefined"&&t>128)?!1:!0:!1}function addDomainValidation(){$(".domain-name-validation").show();$("#item-settings-dialog .e-primary").attr("disabled","true")}function addIpValidation(){$(".ip-address-validation").show();$("#item-settings-dialog .e-primary").attr("disabled","true")}function checkDomainValidation(){var t=$("#domain-chip-content .e-chip").toArray(),n=0;$("#domain-chip-content .e-chip").each(function(){if(n<t.length){var i=$(t[n]).find(".e-chip-text").text(),r=validateDomainName(i);r||($(this).addClass("chip-validation"),addDomainValidation());n++}})}function checkIpValidation(){var t=$("#ip-chip-content .e-chip").toArray(),n=0;$("#ip-chip-content .e-chip").each(function(){if(n<t.length){var i=$(t[n]).find(".e-chip-text").text(),r=validateIpAddress(i);r||($(this).addClass("chip-validation"),addIpValidation());n++}})}function enableSaveButton(){$("#domain-chip-content .e-chip").hasClass("chip-validation")||$("#ip-chip-content .e-chip").hasClass("chip-validation")||$("#domain-input-text").val()!=""||$("#ip-input-text").val()!=""||($("#item-settings-dialog .e-primary").removeAttr("disabled"),isChipChanged=!0)}function applyDomainTooltip(){for(var t,n=0;n<$("#domain-chip-content .e-chip").length;n++)$("#domain-chip-content .e-chip")[n].setAttribute("data-toggle","tooltip"),$("#domain-chip-content .e-chip")[n].setAttribute("data-placement","top"),t=$("#domain-chip-content .e-chip > .e-chip-text")[n].innerText,$("#domain-chip-content .e-chip")[n].setAttribute("data-original-title",t);$('[data-toggle="tooltip"]').tooltip()}function applyIpTooltip(){for(var t,n=0;n<$("#ip-chip-content .e-chip").length;n++)$("#ip-chip-content .e-chip")[n].setAttribute("data-toggle","tooltip"),$("#ip-chip-content .e-chip")[n].setAttribute("data-placement","top"),t=$("#ip-chip-content .e-chip > .e-chip-text")[n].innerText,$("#ip-chip-content .e-chip")[n].setAttribute("data-original-title",t);$('[data-toggle="tooltip"]').tooltip()}function removeDomainValidation(){$("#domain-chip-content .e-chip").hasClass("chip-validation")||$("#domain-input-text").val()!=""||$(".domain-name-validation").hide()}function removeIpValidation(){$("#ip-chip-content .e-chip").hasClass("chip-validation")||$("#ip-input-text").val()!=""||$(".ip-address-validation").hide()}function checkSaveEnabled(){$("#domain-chip-content > .e-chip").length==domainCount&&($("#ip-chip-content > .e-chip").length==ipCount||isChipChanged)?isChipChanged&&enableSaveButton():enableSaveButton()}function onDomainChipDelete(){$("#domain-input-text").focus();setTimeout(function(){removeDomainValidation();checkSaveEnabled()},100);$(".tooltip").hide();var n=document.getElementById("domain-chip-content").ej2_instances;n[0].chips.length==1&&(applyDomainContainer(),$(".domain-name-validation").hide())}function onIpChipDelete(){$("#ip-input-text").focus();setTimeout(function(){removeIpValidation();checkSaveEnabled()},100);$(".tooltip").hide();var n=document.getElementById("ip-chip-content").ej2_instances;n[0].chips.length==1&&(applyIpContainer(),$(".ip-address-validation").hide())}var itemInfo="",isDomainSelected=!1,isDialogBinded=!1,isIpChipBinded=!1,isDomainChipBinded=!1,isChipChanged=!1,isIPv6=!1,domainChipData=[],ipChipData=[],domainCount=0,ipCount=0,isChrome=navigator.userAgent.indexOf("Chrome")!=-1,isEdge=navigator.userAgent.indexOf("Edge")!=-1,isIE=browser!=null&&browser.name==="msie"&&parseFloat(browser.version)>=8;$(document).on("keyup","#domain-input-text",function(n){if($("#domain-input-text").length==1&&$("#domain-input-text").focus(),n.keyCode==keyCode.Comma||n.keyCode==keyCode.SemiColon&&!n.shiftKey||n.keyCode==keyCode.Enter){var t=$("#domain-input-text").val();isDomainSelected=!0;objectConvertAsChip(t)}});$(document).on("keyup","#domain-name-content",function(){var n=document.getElementById("domain-chip-content").ej2_instances;n!=undefined&&(n[0].chips==null||n[0].chips==0)?($("#domain-input-text").val()==""&&applyDomainContainer(),n[0].chips=[],setTimeout(function(){$("#domain-chip-content").html("")},100)):n==undefined&&$("#domain-input-text").val().length==0&&applyDomainContainer();setTimeout(function(){removeDomainValidation();checkSaveEnabled()},100)});$(document).on("paste","#domain-input-text",function(n){var u,t,i,r;if(u=isIE?window.clipboardData.getData("Text").trim():n.originalEvent.clipboardData.getData("Text").trim(),t=u.split(/[\s,;\r?\n]+/),t.length>1){for(i=0;i<t.length;i++)r=t[i],isAlreadyExists(r)&&r!=""&&(domainChipData.push(r),domainChipConversion(domainChipData));setTimeout(function(){$("#domain-input-text").val("");checkDomainValidation()},100)}});$(document).on("paste","#ip-input-text",function(n){var u,i,r,t;if(u=isIE?window.clipboardData.getData("Text").trim():n.originalEvent.clipboardData.getData("Text").trim(),i=u.split(/[\s,;\r?\n]+/),i.length>1){for(r=0;r<i.length;r++)t=i[r],validateIpAddress(t)&&(t.contains("/")||(t=isIPv6?t+"/128":t+"/32")),isIpAlreadyExistsorNot(t)&&t!=""&&(ipChipData.push(t),ipChipConversion(ipChipData));setTimeout(function(){$("#ip-input-text").val("");checkIpValidation()},100)}});$(document).on("keyup","#ip-address-content",function(){var n=document.getElementById("ip-chip-content").ej2_instances;n!=undefined&&(n[0].chips==null||n[0].chips==0)?($("#ip-input-text").val()==""&&applyIpContainer(),n[0].chips=[],setTimeout(function(){$("#ip-chip-content").html("")},100)):n==undefined&&$("#ip-input-text").val().length==0&&applyIpContainer();setTimeout(function(){removeIpValidation();checkSaveEnabled()},100)});$(document).on("keyup","#ip-input-text",function(n){if(n.keyCode==keyCode.Comma||n.keyCode==keyCode.SemiColon&&!n.shiftKey||n.keyCode==keyCode.Enter){var t=$("#ip-input-text").val();isDomainSelected=!1;objectConvertAsChip(t)}});$(document).on("focusin","#domain-input-text",function(){$("#domain-name-content").addClass("focused")});$(document).on("focusout","#domain-input-text",function(){var n=$("#domain-input-text").val()+",";n.length>1&&(isDomainSelected=!0,objectConvertAsChip(n));$("#domain-name-content").removeClass("focused")});$(document).on("focusin","#ip-input-text",function(){$("#ip-address-content").addClass("focused")});$(document).on("focusout","#ip-input-text",function(){var n=$("#ip-input-text").val()+",";n.length>1&&(isDomainSelected=!1,objectConvertAsChip(n));$("#ip-address-content").removeClass("focused")});$(document).on("click","#domain-name-content",function(n){$(n.target).hasClass("e-chip")||$(n.target).hasClass("e-chip-text")||$("#domain-input-text").focus()});$(document).on("click","#ip-address-content",function(n){$(n.target).hasClass("e-chip")||$(n.target).hasClass("e-chip-text")||$("#ip-input-text").focus()});$(document).on("keypress","#domain-input-text",function(){var n=($("#domain-input-text").val().length+1)*8;$("#domain-input-text").css("width",n+"px")});$(document).on("keypress","#ip-input-text",function(){var n=($("#ip-input-text").val().length+1)*8;$("#ip-input-text").css("width",n+"px")});$(document).on("change","#select-option",function(){enableSaveButton()});$(document).on("keydown","#domain-name-content",function(n){if(n.keyCode==keyCode.BackSpace&&$("#domain-input-text").val().length==0){isChrome&&isEdge||n.preventDefault();var t=document.getElementById("domain-chip-content").ej2_instances;t!=undefined&&t[0].chips!=0&&t[0].chips!=null&&($("#domain-chip-content > .e-chip:last").hasClass("e-focused")?(t[0].chips.pop(),t[0].chips.length>0&&t[0].refresh(),applyDomainTooltip(),checkDomainValidation(),removeDomainValidation(),checkSaveEnabled(),$("#domain-input-text").focus()):($("#domain-chip-content > .e-chip:last").addClass("e-focused"),$("#domain-chip-content > .e-chip:last").focus()),(t[0].chips==null||t[0].chips.length==0)&&getDomainInstance())}});$(document).on("keydown","#ip-address-content",function(n){if(n.keyCode==keyCode.BackSpace&&$("#ip-input-text").val().length==0){isChrome&&isEdge||n.preventDefault();var t=document.getElementById("ip-chip-content").ej2_instances;t!=undefined&&t[0].chips!=0&&t[0].chips!=null&&($("#ip-chip-content > .e-chip:last").hasClass("e-focused")?(t[0].chips.pop(),t[0].chips.length>0&&t[0].refresh(),applyIpTooltip(),checkIpValidation(),removeIpValidation(),checkSaveEnabled(),$("#ip-input-text").focus()):($("#ip-chip-content > .e-chip:last").addClass("e-focused"),$("#ip-chip-content > .e-chip:last").focus()),(t[0].chips==null||t[0].chips.length==0)&&getIpInstance())}});$(document).on("click",".e-icon-dlg-close",function(){$(".domain-name-validation").hide();$(".ip-address-validation").hide();cancelItemSettings();ClearSettingsFields()})