/*!
*  filename: ej2.heatmap.all.min.js
*  version : 5.2.48.48
*  Copyright Syncfusion Inc. 2001 - 2017. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
!function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};t.m=n;t.c=i;t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})};t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})};t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r};t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i};t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)};t.p="";t(t.s=5)}([function(n){n.exports=ejs.base},function(n){n.exports=ejs.svgbase},function(n){n.exports=ejs.data},function(n){n.exports=ejs.pdfexport},function(n,t){t.copy=function(n,t,i,r){var u=n||{},e=arguments.length;r&&(e-=1);for(var s=function(n){if(!o[n])return"continue";var t=o[n];Object.keys(t).forEach(function(n){var f,e=u[n],i=t[n];r&&(isObject(i)||Array.isArray(i))?isObject(i)?(f=e||{},u[n]=i({},f,i,r)):(f=e||[],u[n]=i([],f,i,r)):u[n]=i})},o=arguments,f=1;f<e;f++)s(f);return u}},function(n,t,i){"use strict";function b(n,t){return null!=n?-1!==n.indexOf("%")?t/100*parseInt(n,10):parseInt(n,10):null}function f(n,t){var i=document.getElementById("heatmapmeasuretext");return null===i&&(i=Object(r.createElement)("text",{id:"heatmapmeasuretext"}),document.body.appendChild(i)),i.innerText=n,i.style.position="absolute",i.style.visibility="hidden",i.style.fontSize=-1!==t.size.indexOf("px")?t.size:t.size+"px",i.style.fontWeight=t.fontWeight,i.style.fontStyle=t.fontStyle,i.style.fontFamily=t.fontFamily,i.style.top="-100",i.style.left="0",i.style.whiteSpace="nowrap",i.style.lineHeight="normal",new h(i.clientWidth,i.clientHeight)}function ai(n,t,i,r){return"Near"===r.textAlignment?t:"Center"===r.textAlignment?t+n/2:n+t}function p(n){for(var i=0,t=0,r=n;t<r.length;t++)i+=r[t];return i}function vi(n,t,i){var e=new rt.SvgRenderer("heatmapMeasureRotateText"),f=e.createSvg({id:"heatmapMeasureRotateText_svg",width:100,height:100}),s={"font-size":n.size,"font-style":n.fontStyle.toLowerCase(),"font-family":n.fontFamily,"font-weight":n.fontWeight.toLowerCase(),transform:"rotate("+i+", 0, 0)","text-anchor":"middle"},o=e.createText(s,t),u;return f.appendChild(o),document.body.appendChild(f),u=o.getBoundingClientRect(),Object(r.remove)(f),new h(u.right-u.left,u.bottom-u.top)}function ct(n,t,i){var r=[];switch(t.textOverflow){case"Wrap":r=bt(n,i,t);break;case"Trim":r.push(w(i,n,t));break;default:r.push(function(n,t,i){var r=t,e=f(t,i).width,u;if(e>n)for(u=t.length-1;u>=0;--u)if(r=t.substring(0,u),(e=f(r,i).width)<=n)return r;return r}(i,n,t))}return r}function bt(n,t,i){for(var u,s=n.split(" "),r="",e=[],o=0,h=s.length;o<h;o++)u=s[o],f(r.concat(u),i).width<t?r=r.concat((""===r?"":" ")+u):""!==r?(e.push(w(t,r,i)),r=u):(e.push(w(t,u,i)),u=""),r&&o===h-1&&e.push(w(t,r,i));return e}function w(n,t,i){var u=t,e=f(t,i).width,r;if(e>n)for(r=t.length-1;r>=0;--r)if((e=f(u=t.substring(0,r)+"...",i).width)<=n)return u;return u}function lt(n,t,i,u,e,o,s,h){var c=document.getElementById(e),l=f(n,{fontFamily:"Segoe UI",size:"12px",fontStyle:"Normal",fontWeight:"Regular"}),v=l.width+5;t=(t=t+v>u?t-v:t)<0?5:t;c?(c.innerText=n,c.style.top=(i+15).toString()+"px",c.style.left=(t+15).toString()+"px"):((c=Object(r.createElement)("div",{id:e,styles:"top:"+(i+15).toString()+"px;left:"+(t+15).toString()+"px;background-color: rgb(255, 255, 255) !important; color:black !important; position:absolute;border:1px solid rgb(112, 112, 112); padding-left : 3px; padding-right : 2px;padding-bottom : 2px; padding-top : 2px; font-size:12px; font-family: Segoe UI"})).innerText=n,o.appendChild(c));n===h.titleSettings.text?c.style.width=t+15+l.width+7>h.availableSize.width?(h.availableSize.width-(t+15)).toString()+"px":"":(c.style.left=t+15+l.width+7>h.availableSize.width?(h.availableSize.width-(l.width+7)).toString()+"px":t.toString()+"px",c.style.top=i+15+l.height+6>h.availableSize.height?(i-(l.height+6)-10).toString()+"px":c.style.top);s&&setTimeout(function(){a(e)},1500)}function a(n){var t=et(n);t&&Object(r.remove)(t)}function et(n){return document.getElementById(n)}function at(n,t,i,r){var u=new Date(n);switch(t=Math.ceil(t*r),i){case"Years":u.setFullYear(u.getFullYear()+t);break;case"Months":u.setMonth(u.getMonth()+t);break;case"Days":u.setDate(u.getDate()+t);break;case"Hours":u.setHours(u.getHours()+t);break;case"Minutes":u.setMinutes(u.getMinutes()+t)}return u}function kt(n,t,i){for(var f,r,e,o=n.length,u=0;u<o;u++)if(t>=(r=(f=n[u]).region).x&&t<=r.x+r.width&&i>=r.y&&i<=r.y+r.height){e=f.text;break}return e}function nu(n){var i,r,t;return n="transparent"===n?"white":n,i=document.getElementById("heatmapmeasuretext"),i.style.color=n,n=window.getComputedStyle(i).color,t=/^(rgb|hsl)(a?)[(]\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*,\s*([\d.]+\s*%?)\s*(?:,\s*([\d.]+)\s*)?[)]$/.exec(n),"#"+oi((r=new wt(parseInt(t[3],10),parseInt(t[4],10),parseInt(t[5],10))).R)+oi(r.G)+oi(r.B)}function oi(n){var t=n.toString(16);return 1===t.length?"0"+t:t}function yt(n,t,i,r){return n?t.replace("{value}",r(i)):r(i)}var li,ht,ei,it,d,ni,ki;i.r(t);var g,si=i(4),r=i(0),rt=i(1);!function(n){n.heatMapTitleFont={size:"15px",fontWeight:"500",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.titleFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.axisTitleFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.axisLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI"};n.legendLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.rectLabelFont={size:"12px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"};n.tooltipFont={size:"13px",fontWeight:"Normal",color:null,fontStyle:"Normal",fontFamily:"Segoe UI",textOverflow:"None"}}(g||(g={}));var ti,y=(ti=function(n,t){return(ti=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(n,t)},function(n,t){function i(){this.constructor=n}ti(n,t);n.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}),u=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},ut=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("16px")],t.prototype,"size",void 0),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)("Segoe UI")],t.prototype,"fontFamily",void 0),u([Object(r.Property)("Normal")],t.prototype,"fontWeight",void 0),u([Object(r.Property)("Normal")],t.prototype,"fontStyle",void 0),u([Object(r.Property)("Center")],t.prototype,"textAlignment",void 0),u([Object(r.Property)("Trim")],t.prototype,"textOverflow",void 0),t}(r.ChildProperty),di=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(10)],t.prototype,"left",void 0),u([Object(r.Property)(10)],t.prototype,"right",void 0),u([Object(r.Property)(10)],t.prototype,"top",void 0),u([Object(r.Property)(10)],t.prototype,"bottom",void 0),t}(r.ChildProperty),gi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("")],t.prototype,"radius",void 0),t}(r.ChildProperty),nr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"color",void 0),u([Object(r.Property)(0)],t.prototype,"width",void 0),t}(r.ChildProperty),tr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"size",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),t}(r.ChildProperty),ii=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("")],t.prototype,"text",void 0),u([Object(r.Complex)({},ut)],t.prototype,"textStyle",void 0),t}(r.ChildProperty),ir=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("#eeeeee")],t.prototype,"minColor",void 0),u([Object(r.Property)("#eeeeee")],t.prototype,"maxColor",void 0),t}(r.ChildProperty),rr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"value",void 0),u([Object(r.Property)(null)],t.prototype,"color",void 0),u([Object(r.Property)(null)],t.prototype,"label",void 0),u([Object(r.Property)(null)],t.prototype,"startValue",void 0),u([Object(r.Property)(null)],t.prototype,"endValue",void 0),u([Object(r.Property)(null)],t.prototype,"minColor",void 0),u([Object(r.Property)(null)],t.prototype,"maxColor",void 0),t}(r.ChildProperty),hi=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("#b5b5b5")],t.prototype,"color",void 0),u([Object(r.Property)(1)],t.prototype,"width",void 0),u([Object(r.Property)("Rectangle")],t.prototype,"type",void 0),t}(r.ChildProperty),ur=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("0%")],t.prototype,"minimum",void 0),u([Object(r.Property)("100%")],t.prototype,"maximum",void 0),t}(r.ChildProperty),fr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)(null)],t.prototype,"start",void 0),u([Object(r.Property)(null)],t.prototype,"end",void 0),u([Object(r.Property)("")],t.prototype,"text",void 0),u([Object(r.Property)(null)],t.prototype,"maximumTextWidth",void 0),t}(r.ChildProperty),er=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return y(t,n),u([Object(r.Property)("Center")],t.prototype,"alignment",void 0),u([Object(r.Property)("Wrap")],t.prototype,"overflow",void 0),u([Object(r.Complex)(g.axisLabelFont,ut)],t.prototype,"textStyle",void 0),u([Object(r.Complex)({color:"#b5b5b5",width:1,type:"Rectangle"},hi)],t.prototype,"border",void 0),u([Object(r.Collection)([],fr)],t.prototype,"categories",void 0),t}(r.ChildProperty),or=function(){return function(n,t,i,r,u,f,e){this.value=n;this.color=t;this.label=i;this.startValue=r;this.endValue=u;this.minColor=f;this.maxColor=e}}(),sr=function(){return function(n,t,i){this.mappingName=n;this.bubbleData=t;this.valueType=i}}(),ri=function(){return function(n,t,i,r,u,f,e,o){this.value=n;this.color=t;this.label=i;this.startValue=r;this.endValue=u;this.minColor=f;this.maxColor=e;this.isHidden=o}}(),hr=function(){return function(n,t,i,r,u){this.index=1;this.row=1;this.start=n;this.end=t;this.index=i;this.label=r;this.row=u}}(),cr=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),st=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},lr=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return cr(t,n),st([Object(r.Collection)([{}],rr)],t.prototype,"palette",void 0),st([Object(r.Property)("Gradient")],t.prototype,"type",void 0),st([Object(r.Property)("")],t.prototype,"emptyPointColor",void 0),st([Object(r.Property)("Table")],t.prototype,"colorGradientMode",void 0),st([Object(r.Complex)({},ir)],t.prototype,"fillColor",void 0),t}(r.ChildProperty),wt=function(){return function(n,t,i){this.R=n;this.G=t;this.B=i}}(),ci=function(){function n(n){this.heatMap=n}return n.prototype.convertToRGB=function(n,t){var o,s,f=this.heatMap.isColorRange?t[0].startValue:t[0].value,u=0,i=0,r,e;if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type)for(i=0;i<t.length;i++){if(n<=(r=Number(t[i].endValue))&&n>=Number(t[i].startValue)){u=r;o=this.heatMap.colorCollection[i].minColor;s=this.heatMap.colorCollection[i].maxColor;break}if(t[0].startValue!==this.heatMap.dataSourceMinValue&&n<t[0].startValue){u=t[0].startValue;f=this.heatMap.dataSourceMinValue;o=this.heatMap.paletteSettings.fillColor.minColor;s=this.heatMap.paletteSettings.fillColor.maxColor;break}if(n>r&&n<=(i===t.length-1?this.heatMap.dataSourceMaxValue:t[i+1].startValue)){u=i===t.length-1?this.heatMap.dataSourceMaxValue:t[i+1].startValue;f=r;o=this.heatMap.paletteSettings.fillColor.minColor;s=this.heatMap.paletteSettings.fillColor.maxColor;break}u=r;f=r}else for(i=1;i<t.length;i++){if(n<=(r=Number(t[i].value))){u=r;o=this.getEqualColor(t,f);s=this.getEqualColor(t,u);break}u=r;f=r}return e=0,e=(n-f)/(u-f),e=isNaN(e)?0:e,this.getPercentageColor(e,o,s)},n.prototype.rgbToHex=function(n,t,i){return"#"+this.componentToHex(n)+this.componentToHex(t)+this.componentToHex(i)},n.prototype.componentToHex=function(n){var t=n.toString(16);return 1===t.length?"0"+t:t},n.prototype.getEqualColor=function(n,t){for(var i,r=0;r<n.length;r++)if(Number(n[r].value)===t)return i=n[r].color,-1!==i.indexOf("rgb")?i=this.convertToHex(i):-1===i.indexOf("#")&&(i="#FFFFFF"),i;return"#00000"},n.prototype.convertToHex=function(n){var i=n.substr(3),t=(i=i.split("(")[1].split(")")[0]).split(",");return this.rgbToHex(parseInt(t[0],10),parseInt(t[1],10),parseInt(t[2],10))},n.prototype.getPercentageColor=function(n,t,i){var r=i.split("#")[1],u=t.split("#")[1],f=this.getPercentage(n,parseInt(u.substr(0,2),16),parseInt(r.substr(0,2),16)),e=this.getPercentage(n,parseInt(u.substr(2,2),16),parseInt(r.substr(2,2),16)),o=this.getPercentage(n,parseInt(u.substr(4,2),16),parseInt(r.substr(4,2),16));return new wt(f,e,o)},n.prototype.getPercentage=function(n,t,i){var r=i-t;return Math.round(t+r*n)},n.prototype.getColorCollection=function(){var o,n=this.heatMap,f,u,e,t,i;for(n.colorCollection=[],n.legendColorCollection=[],f=0;f<this.heatMap.paletteSettings.palette.length;f++){if(null===this.heatMap.paletteSettings.palette[f].startValue||null===this.heatMap.paletteSettings.palette[f].endValue){this.heatMap.isColorRange=!1;break}this.heatMap.isColorRange=!0}if(u=n.bubbleSizeWithColor?n.minColorValue:n.dataSourceMinValue,e=n.bubbleSizeWithColor?n.maxColorValue:n.dataSourceMaxValue,n.emptyPointColor=n.paletteSettings.emptyPointColor?n.paletteSettings.emptyPointColor:n.themeStyle.emptyCellColor,t=this.orderbyOffset(this.heatMap.isColorRange||n.paletteSettings.palette&&n.paletteSettings.palette.length>1?n.paletteSettings.palette:n.themeStyle.palette),t.isCompact)n.colorCollection=t.offsets,n.legendColorCollection=Object(r.extend)([],t.offsets,null,!0);else if(o="Gradient"===n.paletteSettings.type?(e-u)/(t.offsets.length-1):(e-u)/t.offsets.length,t.offsets.length>=2)for(i=0;i<t.offsets.length;i++)n.colorCollection.push(new or(Math.round(100*(u+i*o))/100,t.offsets[i].color,t.offsets[i].label,t.offsets[i].startValue,t.offsets[i].endValue,t.offsets[i].minColor,t.offsets[i].maxColor)),n.legendColorCollection.push(new ri(Math.round(100*(u+i*o))/100,t.offsets[i].color,t.offsets[i].label,t.offsets[i].startValue,t.offsets[i].endValue,t.offsets[i].minColor,t.offsets[i].maxColor,!1));this.heatMap.isColorRange||this.updateLegendColorCollection(u,e,t)},n.prototype.updateLegendColorCollection=function(n,t,i){"Fixed"===this.heatMap.paletteSettings.type&&(i.isCompact||i.isLabel)||(Math.round(100*n)/100<this.heatMap.legendColorCollection[0].value&&this.heatMap.legendColorCollection.unshift(new ri(Math.round(100*n)/100,this.heatMap.legendColorCollection[0].color,this.heatMap.legendColorCollection[0].label,this.heatMap.legendColorCollection[0].startValue,this.heatMap.legendColorCollection[0].endValue,this.heatMap.legendColorCollection[0].minColor,this.heatMap.legendColorCollection[0].maxColor,!0)),Math.round(100*t)/100>this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].value&&this.heatMap.legendColorCollection.push(new ri(Math.round(100*t)/100,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].color,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].label,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].startValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].endValue,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].minColor,this.heatMap.legendColorCollection[this.heatMap.legendColorCollection.length-1].maxColor,!0)))},n.prototype.orderbyOffset=function(n){var t=new br,i=this.heatMap.isColorRange?"to":"value";return t.isCompact=!0,t.isLabel=!0,t.offsets=n.sort(function(n,u){return Object(r.isNullOrUndefined)(n.label)&&Object(r.isNullOrUndefined)(u.label)&&(t.isLabel=!1),Object(r.isNullOrUndefined)(n[i])||Object(r.isNullOrUndefined)(u[i])?(t.isCompact=!1,n):n[i]-u[i]}),t.isCompact||(t.offsets=this.heatMap.paletteSettings.palette&&this.heatMap.paletteSettings.palette.length>1?this.heatMap.paletteSettings.palette:this.heatMap.themeStyle.palette),t},n.prototype.getColorByValue=function(n){var u,i="",f=0,t,e,r;if(""!==n.toString())if("Bubble"!==this.heatMap.cellSettings.tileType||"Size"!==this.heatMap.cellSettings.bubbleType&&"Sector"!==this.heatMap.cellSettings.bubbleType)if("Fixed"===this.heatMap.paletteSettings.type){for(t=0;t<this.heatMap.colorCollection.length;t++)if(f=this.heatMap.isColorRange?this.heatMap.paletteSettings.palette[t].startValue:this.heatMap.colorCollection[t+1]?this.heatMap.colorCollection[t+1].value:this.heatMap.colorCollection[t].value,e=this.heatMap.dataSourceMinValue===this.heatMap.dataSourceMaxValue,this.heatMap.isColorRange){if(r=void 0,n<=this.heatMap.colorCollection[t].endValue&&n>=this.heatMap.colorCollection[t].startValue){this.heatMap.legendVisibilityByCellType&&(r=this.heatMap.legendModule.legendRange);i=this.heatMap.legendVisibilityByCellType&&r[t]&&!r[t].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[t].minColor;break}i=this.heatMap.paletteSettings.fillColor.minColor}else if(n<=f&&e&&0===t||n<f||n>=f&&t===this.heatMap.colorCollection.length-1){r=void 0;this.heatMap.legendVisibilityByCellType&&(r=this.heatMap.legendModule.legendRange);i=this.heatMap.legendVisibilityByCellType&&r[t]&&!r[t].visible?this.heatMap.themeStyle.toggledColor:this.heatMap.colorCollection[t].color;break}}else"Table"!==this.heatMap.paletteSettings.colorGradientMode&&this.getColorCollection(),n<this.heatMap.colorCollection[0].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[0].color:n>this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].value&&!this.heatMap.isColorRange?i=this.heatMap.colorCollection[this.heatMap.colorCollection.length-1].color:(u=this.convertToRGB(n,this.heatMap.colorCollection),i=this.rgbToHex(u.R,u.G,u.B));else i=this.heatMap.isColorRange?this.heatMap.colorCollection[0].minColor:this.heatMap.colorCollection[0].color;else i=this.heatMap.emptyPointColor;return i},n}(),ft=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}();li=function(){return function(n,t){this["font-size"]=n.size;this["font-style"]=n.fontStyle.toLowerCase();this["font-family"]=n.fontFamily;this["font-weight"]=n.fontWeight.toLowerCase();this.fill=t||""}}();var h=function(){return function(n,t){this.width=n;this.height=t}}(),nt=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t)||this;return s.opacity=f,s.fill=i,s.stroke=u||"",s["stroke-width"]=parseFloat(r.toString()),s["stroke-dasharray"]=e,s.d=o,s}return ft(t,n),t}(function(){return function(n){this.id=n}}()),ar=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l,a,v){this.x=n;this.y=t;this.width=i;this.height=r;this.value=u;this.id=f;this.xIndex=e;this.yIndex=o;this.xValue=s;this.yValue=h;this.visible=c;this.displayText=l;this.textId=a;this.allowCollection=v}}(),vr=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l){this.value=n;this.xLabel=t;this.yLabel=i;this.xValue=r;this.yValue=u;this.cellElement=f;this.xPosition=e;this.yPosition=o;this.width=s;this.height=h;this.x=c;this.y=l}}(),k=function(n){function t(t,i,r,u,f,e,o,s,h,c){var l=n.call(this,t,i,r.width,e,u,c)||this;return l.y=f.y,l.x=f.x,l.height=f.height>0?f.height:0,l.width=f.width>0?f.width:0,l.rx=o||0,l.ry=s||0,l.transform=h||"",l}return ft(t,n),t}(nt),yr=function(n){function t(t,i,r,u,f,e,o,s){var h=n.call(this,t,i,r.width,f,u)||this;return h.cx=e||0,h.cy=o||0,h.r=s||0,h}return ft(t,n),t}(nt),e=function(){return function(n,t,i,r){this.x=n;this.y=t;this.width=i;this.height=r}}(),c=function(n){function t(t,i,r,u){var f=n.call(this,r,u)||this;return f.transform="",f["dominant-baseline"]="auto",f.labelRotation=0,f.baseline="auto",f.id=t,f.x=i.x,f.y=i.y,f["text-anchor"]=i["text-anchor"],f.text=i.text,f.transform=i.transform,f.labelRotation=i.labelRotation,f["dominant-baseline"]=i["dominant-baseline"],f.baseline=i.baseline,f.dy=i.dy,f}return ft(t,n),t}(li),l=function(){return function(n,t,i,r,u,f,e,o){this.transform="";this["dominant-baseline"]="auto";this.labelRotation=0;this.baseline="auto";this.x=n||0;this.y=t||0;this["text-anchor"]=i||"start";this.text=r||"";this.transform=f||"";this.labelRotation=u;this["dominant-baseline"]=e||"auto";this.baseline=e||"";this.dy=o||""}}(),ui=function(){return function(n,t,i,r){this.x1=n;this.y1=t;this.x2=i;this.y2=r}}(),fi=function(n){function t(t,i,r,u,f,e){var o=n.call(this,t,null,u,r,f,e,null)||this;return o.x1=i.x1,o.y1=i.y1,o.x2=i.x2,o.y2=i.y2,o}return ft(t,n),t}(nt),pr=function(n){function t(t,i,r,u,f,e,o){var s=n.call(this,t,r,f,o,e,null)||this;return s.d=i.d,s.x=i.x,s.y=i.y,s}return ft(t,n),t}(nt),wr=function(){return function(n,t,i,r,u,f,e,o,s,h,c,l){this.d=n;this.innerR=t;this.cx=e;this.cy=o;this.x=i;this.y=r;this.x1=u;this.y1=f;this.start=s;this.end=h;this.radius=c;this.counterClockWise=l}}();ht=function(){function n(n){this.heatMap=n}return n.prototype.drawRectangle=function(n,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasRectangle(this.heatMap.canvasRenderer,n,i):(delete n.d,t.appendChild(this.heatMap.renderer.drawRectangle(n)))},n.prototype.drawCircle=function(n,t){this.heatMap.enableCanvasRendering?this.drawCanvasCircle(this.heatMap.canvasRenderer,n):(delete n.d,t.appendChild(this.heatMap.renderer.drawCircle(n)))},n.prototype.drawPath=function(n,t,i){this.heatMap.enableCanvasRendering?this.drawCanvasPath(this.heatMap.canvasRenderer,n,t):(delete n.x,delete n.y,i.appendChild(this.heatMap.renderer.drawPath(n)))},n.prototype.createText=function(n,t,i){this.heatMap.enableCanvasRendering?this.canvasDrawText(n,i):(delete n.labelRotation,delete n.baseline,delete n.text,t.appendChild(this.heatMap.renderer.createText(n,i)),n.text=i)},n.prototype.createWrapText=function(n,t,i){var s,u,h,e,o,r,c;if(s={id:n.id,x:n.x,y:n.y,fill:n.fill,"font-size":t.size,"font-style":t.fontStyle,"font-family":t.fontFamily,"font-weight":t.fontWeight.toLowerCase(),"text-anchor":n["text-anchor"],transform:n.transform,"dominant-baseline":n["dominant-baseline"]},o=n.text[0],this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.createText(n,o):u=this.heatMap.renderer.createText(s,o),"string"!=typeof n.text&&n.text.length>1)for(r=1,c=n.text.length;r<c;r++)e=f(n.text[r],t).height,this.heatMap.enableCanvasRendering?(n.id=n.id+r,n.y+=e,this.heatMap.canvasRenderer.createText(n,n.text[r])):(h=this.heatMap.renderer.createTSpan({x:n.x,id:n.id+r,y:n.y+r*e},n.text[r]),u.appendChild(h));this.heatMap.enableCanvasRendering||i.appendChild(u)},n.prototype.drawLine=function(n,t){this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawLine(n):(delete n.d,t.appendChild(this.heatMap.renderer.drawLine(n)))},n.prototype.canvasDrawText=function(n,t,i,u){var f=this.heatMap.canvasRenderer.ctx,e;i||(i=n.x);u||(u=n.y);e=this.getOptionValue(n,"font-weight");Object(r.isNullOrUndefined)(e)||"regular"!==e.toLowerCase()||(e="normal");var s=this.getOptionValue(n,"font-family"),h=-1===n["font-size"].toString().indexOf("px")?n["font-size"]+"px":n["font-size"],o=this.getOptionValue(n,"text-anchor"),c=this.getOptionValue(n,"font-style").toLowerCase()+" "+e+" "+h+" "+s;"middle"===o&&(o="center");f.save();f.fillStyle=n.fill;f.font=c;f.textAlign=o;n.baseline&&(f.textBaseline=n.baseline);f.translate(i,u);f.rotate(n.labelRotation*Math.PI/180);f.fillText(t,n.x-i,n.y-u);f.restore()},n.prototype.getOptionValue=function(n,t){return n[t]},n.prototype.setAttributes=function(n,t){var i,u;n.ctx.lineWidth=t["stroke-width"];i=t["stroke-dasharray"];Object(r.isNullOrUndefined)(i)||(u=i.split(","),n.ctx.setLineDash([parseInt(u[0],10),parseInt(u[1],10)]));n.ctx.strokeStyle=t.stroke},n.prototype.drawCanvasRectangle=function(n,t,i){var r=n.ctx;n.ctx.save();n.ctx.beginPath();n.ctx.globalAlpha=t.opacity;this.setAttributes(n,t);this.drawCornerRadius(n,t);(t["stroke-width"]&&0!==t["stroke-width"]||i)&&n.ctx.stroke();n.ctx.restore();n.ctx=r},n.prototype.drawCornerRadius=function(n,t){var i=t.rx,r=t.x,u=t.y,f=t.width,e=t.height;"none"===t.fill&&(t.fill="transparent");n.ctx.fillStyle=t.fill;f<2*i&&(i=f/2);e<2*i&&(i=e/2);n.ctx.beginPath();n.ctx.moveTo(r+f-i,u);n.ctx.arcTo(r+f,u,r+f,u+e,i);n.ctx.arcTo(r+f,u+e,r,u+e,i);n.ctx.arcTo(r,u+e,r,u,i);n.ctx.arcTo(r,u,r+f,u,i);n.ctx.closePath();n.ctx.fill()},n.prototype.drawCanvasCircle=function(n,t){n.ctx.save();n.ctx.beginPath();n.ctx.arc(t.cx,t.cy,t.r,0,2*Math.PI);n.ctx.fillStyle=t.fill;n.ctx.globalAlpha=t.opacity;n.ctx.fill();this.setAttributes(n,t);t["stroke-width"]&&0!==t["stroke-width"]&&n.ctx.stroke();n.ctx.restore()},n.prototype.drawCanvasPath=function(n,t,i){var u=t.d.split(" "),r,f,e;for(n.ctx.save(),n.ctx.beginPath(),n.ctx.globalAlpha=t.opacity,n.ctx.fillStyle=t.fill,this.setAttributes(n,t),r=0;r<u.length;r+=3){f=parseFloat(u[r+1]);e=parseFloat(u[r+2]);switch(u[r]){case"M":n.ctx.moveTo(f,e);break;case"L":n.ctx.lineTo(f,e);break;case"A":case"a":n.ctx.arc(i.x,i.y,i.radius,.0174533*i.start,.0174533*i.end,!1);r="a"===u[r]?r+13:r+5;break;case"Z":n.ctx.closePath()}}n.ctx.fill();t["stroke-width"]&&0!==t["stroke-width"]&&n.ctx.stroke();n.ctx.restore()},n}();ei=function(){return function(n,t,i,r,u){this.id=n;this.x1=t;this.x2=i;this.y1=r;this.y2=u}}();it=function(){return function(n,t){this.color=n;this.colorStop=t}}();d=function(){return function(n,t){this.region=new e(0,0,0,0);this.text=n;this.region=t}}();var br=function(){return function(){}}(),kr=function(){return function(n,t,i,r,u,f){this.pathX1=n;this.pathY1=t;this.pathX2=i;this.pathY2=r;this.pathX3=u;this.pathY3=f}}(),dr=function(){return function(n,t,i,r,u,f){this.x=n;this.y=t;this.width=i;this.height=r;this.label=u;this.id=f}}(),vt=function(){return function(n,t,i,r,u,f,e){this.x=n;this.y=t;this.width=i;this.height=r;this.value=u;this.visible=f;this.currentPage=e}}(),gr=function(){return function(n,t,i,r){this.visible=n;this.value=t;this.startValue=i;this.endValue=r}}();var tu=function(){return function(n,t){this.x=n;this.y=t}}(),pt=i(2),iu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),s=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},yi=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.multipleRow=[],t.rect=new e(void 0,void 0,0,0),t.nearSizes=[],t.farSizes=[],t.maxLabelSize=new h(0,0),t.titleSize=new h(0,0),t.multilevel=[],t.axisLabels=[],t.tooltipLabels=[],t.labelValue=[],t.axisLabelSize=0,t.axisLabelInterval=0,t.dateTimeAxisLabelInterval=[],t.maxLength=0,t.min=0,t.max=0,t.isIntersect=!1,t.jsonCellLabel=[],t.multiLevelSize=[],t.xAxisMultiLabelHeight=[],t.yAxisMultiLabelHeight=[],t.multiLevelPosition=[],t}return iu(t,n),t.prototype.computeSize=function(n,t,i){var u=new h(0,0),r;for(this.titleSize=n.getTitleSize(n,10),this.maxLabelSize=n.getMaxLabelSize(n,t),this.getMultilevelLabelsHeight(n,i,t),r=0;r<this.multiLevelLabels.length;r++)u=n.multiLevelLabelSize(10,r),this.multiLevelSize.push(u)},t.prototype.multiPosition=function(n,t){var f="Horizontal"===n.orientation?10:20,u=new tu(0,0),i,r;return"Horizontal"===n.orientation?(i=n.maxLabelSize.height+f,r=this.xAxisMultiLabelHeight[t-1],u.x=n.isInversed?n.rect.x+n.rect.width:n.rect.x,u.y=0===t?n.rect.y+(n.opposedPosition?-i:i):n.multiLevelPosition[t-1].y+(n.opposedPosition?-r:r)):(i=n.maxLabelSize.width+f,r=0!==t&&this.multiLevelSize[t-1].width,u.x=0===t?n.rect.x-(n.opposedPosition?-i:i):n.multiLevelPosition[t-1].x-(n.opposedPosition?-(r+f):r+f),u.y=n.isInversed?n.rect.y:n.rect.y+n.rect.height),u},t.prototype.multiLevelLabelSize=function(n,t){for(var r,e,i=new h(0,0),o=this.multiLevelLabels,s=o[t].categories,u=0;u<s.length;u++)r=f(s[u].text,o[t].textStyle),i.width=i.width>r.width?i.width:r.width,i.height=i.height>r.height?i.height:r.height;return e="Horizontal"===this.orientation?this.xAxisMultiLabelHeight[t]:this.yAxisMultiLabelHeight[t],this.opposedPosition?this.farSizes.push(e):this.nearSizes.push(e),i},t.prototype.getMultilevelLabelsHeight=function(n,t,i){var u,s,e,c,l,a,v,r=[],h="Vertical"===n.orientation,o="Vertical"===n.orientation?20:10;this.multiLevelLabels.map(function(y,p){y.categories.map(function(w){c="number"==typeof w.start?w.start:Number(new Date(w.start));l="number"==typeof w.end?w.end:Number(new Date(w.end));""!==w.text&&null!==w.start&&null!==w.end&&(u=f(w.text,y.textStyle),e=h?u.width:u.height,a=i.heatMapAxis.calculateLeftPosition(n,c,w.start,t),v=i.heatMapAxis.calculateWidth(n,w.end,l,t),u=f(w.text,y.textStyle),s=null===w.maximumTextWidth?Math.abs(v-a):w.maximumTextWidth,u.width>s-o&&"Wrap"===y.overflow&&!h&&(e*=bt(w.text,s-o,y.textStyle).length),r[p]=r[p]?r[p]<e?e+o:r[p]:e+o)})});h?this.yAxisMultiLabelHeight=r:this.xAxisMultiLabelHeight=r},t.prototype.getTitleSize=function(n,t){var i=new h(0,0);return this.title.text&&((i=f(this.title.text,this.title.textStyle)).height+=t),n.opposedPosition?this.farSizes.push(i.height):this.nearSizes.push(i.height),i},t.prototype.getMaxLabelSize=function(n,t){var u=new h(0,0),c=this.axisLabels,nt=n.border.width>0||n.multiLevelLabels.length>0?10:0,e=1,y="DateTime"===n.valueType&&"None"!==n.showLabelOn?t.initialClipRect.width/n.axisLabelSize:t.initialClipRect.width/n.axisLabels.length,i,it,o,p,s,a,v;if(n.angle=n.labelRotation,n.isIntersect=!1,"Horizontal"===n.orientation&&("Rotate45"===n.labelIntersectAction||n.labelRotation%180==0&&"Trim"===n.labelIntersectAction||n.enableTrim)||"MultipleRows"===n.labelIntersectAction){var tt=t.initialClipRect.x+(n.isInversed?t.initialClipRect.width:0),b=void 0,k=void 0;for(this.clearMultipleRow(),i=0,it=c.length;i<it;i++){var g=f(p=c[i],n.textStyle),rt="DateTime"===n.valueType&&"None"!==n.showLabelOn?n.dateTimeAxisLabelInterval[i]*y:y,l=tt+(n.isInversed?-(y+g.width)/2:(y-g.width)/2),d=(l=l<t.initialClipRect.x?t.initialClipRect.x:l)+g.width;if(n.isInversed){if(Object(r.isNullOrUndefined)(k))k=l;else if(k<d&&"MultipleRows"!==n.labelIntersectAction){"Rotate45"!==n.labelIntersectAction||n.enableTrim?n.isIntersect=!0:n.angle=45;break}k=l}else{if(Object(r.isNullOrUndefined)(b))b=d;else if(l<b&&"MultipleRows"!==n.labelIntersectAction){"Rotate45"!==n.labelIntersectAction||n.enableTrim?n.isIntersect=!0:n.angle=45;break}b=d}tt+=n.isInversed?-rt:rt;"Horizontal"===n.orientation&&"MultipleRows"===n.labelIntersectAction&&0===n.labelRotation&&this.multipleRow.push(new hr(l,d,e,p,1))}"Horizontal"===n.orientation&&"MultipleRows"===n.labelIntersectAction&&n.isInversed&&(this.multipleRow=this.multipleRow.reverse())}for(i=0;i<c.length;i++)if(o=this.multipleRow,p=void 0,p=n.enableTrim?w(n.maxLabelLength,c[i],n.textStyle):c[i],s=n.angle%180==0?f(p,n.textStyle):vi(n.textStyle,c[i],n.angle),u.width=u.width>s.width?u.width:s.width,"MultipleRows"===n.labelIntersectAction&&"Horizontal"===n.orientation&&i>0&&0===n.labelRotation){for(o[i].end>=t.initialClipRect.width&&i<c.length-1&&(o[i].row=o[i].row+1),a=1;a<=n.multilevel.length;a++)if(o[i].start<o[i-1].end){if(n.multilevel[a]<o[i].start){e=a;break}if(a===n.multilevel.length-1){e=n.multilevel.length;break}}else if(s.width<y)for(v=1;v<=n.multilevel.length;v++)if(n.multilevel[v]<o[i].start){e=v;o[v].row=e;break}u.height=u.height>s.height*e+.5*s.height/2*(e-1)?u.height:s.height*e+.5*s.height/2*e;this.multipleRow[i].index=e;n.multilevel[e]=o[i].end}else"Horizontal"===n.orientation&&"MultipleRows"===n.labelIntersectAction&&0===i&&0===n.labelRotation&&(n.multilevel[1]=o[i].end),u.height=u.height>s.height?u.height:s.height;return t.cellSettings.border.width>=20&&"Horizontal"!==n.orientation&&(u.width=u.width+t.cellSettings.border.width/4),n.opposedPosition?this.farSizes.push("Horizontal"===n.orientation?u.height:u.width+nt):this.nearSizes.push("Horizontal"===n.orientation?u.height:u.width+nt),u},t.prototype.calculateNumericAxisLabels=function(n){var h,s,c,u=0,t=0,l=this.interval?this.interval:1,f,e,i,o;for(n.adaptorModule&&n.isCellData&&(h="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.min:n.adaptorModule.adaptiveYMinMax.min,s="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.max:n.adaptorModule.adaptiveYMinMax.max),u=Object(r.isNullOrUndefined)(this.minimum)?h||0:this.minimum,t=Object(r.isNullOrUndefined)(this.maximum)?s||this.maxLength*this.increment:this.maximum,this.minimum&&this.maximum&&u>t&&(c=u,u=t,t=c),t=Object(r.isNullOrUndefined)(this.maximum)?s||t+u:t,f=this.labelFormat,e=null!==f.match("{value}"),this.format=n.intl.getNumberFormat({format:e?"":f}),i=u;i<=t;i+=l*this.increment)o=yt(e,f,i,this.format),this.axisLabels.push(o);for(this.min=0,this.axisLabelSize=Math.floor((t-u)/this.increment+1),this.max=this.axisLabelSize-1,this.axisLabelInterval=l,i=u;i<=t;i+=this.increment)o=yt(e,f,i,this.format),this.tooltipLabels.push(o),this.labelValue.push(i);this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},t.prototype.calculateCategoryAxisLabels=function(){var t=this.labels?this.labels:[],n,o;t=t.length>0?t:this.jsonCellLabel;var e,i=Object(r.isNullOrUndefined)(this.minimum)||this.minimum instanceof Date?0:this.minimum,u=Object(r.isNullOrUndefined)(this.maximum)||this.maximum instanceof Date?this.maxLength:this.maximum,f=this.interval?this.interval:1;if(!Object(r.isNullOrUndefined)(this.minimum)&&!Object(r.isNullOrUndefined)(this.maximum)&&i>u&&(e=i,i=u,u=e),t&&t.length>0)for(n=i;n<=u;n+=f)o=t[n]?t[n].toString():n.toString(),this.axisLabels.push(o);else for(n=i;n<=u;n+=f)this.axisLabels.push(n.toString());for(n=i;n<=u;n++)this.tooltipLabels.push(t[n]?t[n].toString():n.toString()),this.labelValue.push(t[n]?t[n].toString():n.toString());this.min=i;this.max=u;this.axisLabelSize=u-i+1;this.axisLabelInterval=f;this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},t.prototype.calculateDateTimeAxisLabel=function(n){var i,r,u=this.interval?this.interval:1,l={skeleton:"full",type:"dateTime"},s=n.intl.getDateParser(l),h=n.intl.getDateFormat(l),a=null,v=null,f,e,o,t,c;if(n.adaptorModule&&n.isCellData&&(a="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.min:n.adaptorModule.adaptiveYMinMax.min,v="Horizontal"===this.orientation?n.adaptorModule.adaptiveXMinMax.max:n.adaptorModule.adaptiveYMinMax.max),f=this.minimum?this.minimum:a||null,e=this.maximum?this.maximum:v||null,null===f&&null===e){for(i=0,r=this.maxLength*this.increment,o=i;o<=r;o+=u*this.increment)this.axisLabels.push(o.toString()),this.tooltipLabels.push(o.toString()),this.labelValue.push(o.toString());this.min=0;this.max=this.maxLength;this.axisLabelSize=(r-i)/this.increment+1;this.axisLabelInterval=u}else{for(null!==f&&null===e?r=at(i=Date.parse(s(h(new Date(pt.DataUtil.parse.parseJson({val:f}).val)))),this.maxLength,this.intervalType,this.increment).getTime():null===f&&null!==e?i=at(r=Date.parse(s(h(new Date(pt.DataUtil.parse.parseJson({val:e}).val)))),-this.maxLength,this.intervalType,this.increment).getTime():(i=Date.parse(s(h(new Date(pt.DataUtil.parse.parseJson({val:f}).val)))),r=Date.parse(s(h(new Date(pt.DataUtil.parse.parseJson({val:e}).val))))),this.format=n.intl.getDateFormat({format:this.labelFormat,skeleton:this.getSkeleton()}),t=i;t<=r;)c=this.format(new Date(t)),this.axisLabels.push(c),"None"!==this.showLabelOn&&(u=this.calculateLabelInterval(t),this.dateTimeAxisLabelInterval.push(u)),t=at(t,u,this.intervalType,this.increment).getTime();for(this.min=0,this.axisLabelInterval=u,this.axisLabelSize=this.getTotalLabelLength(i,r),this.max=this.axisLabelSize-1,t=i;t<=r;)c=this.format(new Date(t)),this.tooltipLabels.push(c),this.labelValue.push(new Date(t)),t=at(t,1,this.intervalType,this.increment).getTime()}this.labelValue=this.isInversed?this.labelValue.reverse():this.labelValue},t.prototype.calculateLabelInterval=function(n){var i,t,r=new Date(n).getFullYear(),f=new Date(n).getMonth()+1,e=new Date(n).getDate(),u;return"Years"===this.showLabelOn||"Months"===this.showLabelOn?"Years"===this.showLabelOn&&"Months"===this.intervalType?t=Math.ceil(12/this.increment):(i="Years"===this.showLabelOn?r%4==0?366:365:new Date(r,f,0).getDate(),i+=1-e,t="Days"===this.intervalType?Math.ceil(i/this.increment):"Hours"===this.intervalType?Math.ceil(24*i/this.increment):"Minutes"===this.intervalType?Math.ceil(1440*i/this.increment):1):"Days"===this.showLabelOn?t="Hours"===this.intervalType?Math.ceil(24/this.increment):"Minutes"===this.intervalType?Math.ceil(1440/this.increment):1:"Hours"===this.showLabelOn?(u=new Date(n).getMinutes(),t="Minutes"===this.intervalType?Math.ceil((60-u)/this.increment):1):t=1,t},t.prototype.getSkeleton=function(){return"Years"===this.intervalType?"yMMM":"Months"===this.intervalType?"MMMd":"Days"===this.intervalType?"yMd":"Hours"===this.intervalType?"EHm":(this.intervalType,"Hms")},t.prototype.getTotalLabelLength=function(n,t){var i,o,r=0,u=new Date(n),f=new Date(t),s,e,h,c;switch(this.intervalType){case"Years":s=(f.getFullYear()-u.getFullYear())/this.increment+1;r=Math.floor(s);break;case"Months":e=12*(f.getFullYear()-u.getFullYear());e-=u.getMonth();r=(e+=f.getMonth())<=0?1:Math.floor(e/this.increment+1);break;case"Days":i=Math.abs(u.getTime()-f.getTime());o=Math.floor(i/864e5);r=Math.floor(o/this.increment+1);break;case"Hours":i=Math.abs(u.getTime()-f.getTime());h=Math.floor(i/36e5);r=Math.floor(h/this.increment)+1;break;case"Minutes":i=Math.abs(u.getTime()-f.getTime());c=Math.floor(i/6e4);r=Math.floor(c/this.increment)+1}return r},t.prototype.clearAxisLabel=function(){this.axisLabels=[];this.tooltipLabels=[];this.dateTimeAxisLabelInterval=[];this.labelValue=[]},t.prototype.clearMultipleRow=function(){this.multipleRow=[];this.multilevel=[]},s([Object(r.Complex)({text:"",textStyle:g.axisTitleFont},ii)],t.prototype,"title",void 0),s([Object(r.Property)(!1)],t.prototype,"opposedPosition",void 0),s([Object(r.Property)(null)],t.prototype,"labels",void 0),s([Object(r.Complex)(g.axisLabelFont,ut)],t.prototype,"textStyle",void 0),s([Object(r.Property)(0)],t.prototype,"labelRotation",void 0),s([Object(r.Property)(!1)],t.prototype,"isInversed",void 0),s([Object(r.Property)("Category")],t.prototype,"valueType",void 0),s([Object(r.Property)(1)],t.prototype,"increment",void 0),s([Object(r.Property)("None")],t.prototype,"showLabelOn",void 0),s([Object(r.Property)(null)],t.prototype,"minimum",void 0),s([Object(r.Property)(null)],t.prototype,"maximum",void 0),s([Object(r.Property)(null)],t.prototype,"interval",void 0),s([Object(r.Property)("")],t.prototype,"labelFormat",void 0),s([Object(r.Property)("Days")],t.prototype,"intervalType",void 0),s([Object(r.Property)("Trim")],t.prototype,"labelIntersectAction",void 0),s([Object(r.Property)(!1)],t.prototype,"enableTrim",void 0),s([Object(r.Property)(35)],t.prototype,"maxLabelLength",void 0),s([Object(r.Complex)({color:"#b5b5b5",width:0,type:"Rectangle"},hi)],t.prototype,"border",void 0),s([Object(r.Collection)([],er)],t.prototype,"multiLevelLabels",void 0),t}(r.ChildProperty),ru=function(){function n(n){this.heatMap=n;this.padding=10;this.drawSvgCanvas=new ht(n)}return n.prototype.renderAxes=function(){var r,t,i,n;this.initialClipRect=this.heatMap.initialClipRect;i=this.heatMap;i.enableCanvasRendering||(r=this.heatMap.renderer.createGroup({id:i.element.id+"AxisCollection"}));for(var f=this.heatMap.axisCollections,u=0,e=f.length;u<e;u++)n=f[u],"Horizontal"===n.orientation?(i.enableCanvasRendering||(t=this.heatMap.renderer.createGroup({id:i.element.id+"XAxisGroup"})),this.drawXAxisLine(t,n),this.drawXAxisTitle(n,t,n.rect),this.drawXAxisLabels(n,t,n.rect)):(t=i.renderer.createGroup({id:i.element.id+"YAxisGroup"}),this.drawYAxisLine(t,n),this.drawYAxisTitle(n,t,n.rect),this.drawYAxisLabels(n,t,n.rect)),n.multiLevelLabels.length>0&&this.drawMultiLevels(t,n),i.enableCanvasRendering||r.appendChild(t);i.enableCanvasRendering||this.heatMap.svgObject.appendChild(r)},n.prototype.drawXAxisLine=function(n,t){var i=this.initialClipRect.y+(t.opposedPosition?0:this.initialClipRect.height),r=new fi(this.heatMap.element.id+"_XAxisLine",new ui(this.initialClipRect.x,i,this.initialClipRect.x+this.initialClipRect.width,i),"transparent",0);this.drawSvgCanvas.drawLine(r,n)},n.prototype.drawYAxisLine=function(n,t){var i=this.initialClipRect.x+(t.opposedPosition?this.initialClipRect.width:0),r=new fi(this.heatMap.element.id+"_YAxisLine",new ui(i,this.initialClipRect.y,i,this.initialClipRect.height+this.initialClipRect.y),"transparent",0);this.drawSvgCanvas.drawLine(r,n)},n.prototype.drawXAxisTitle=function(n,t,i){var e="0px"===n.textStyle.size?0:10,a=i.y+(n.opposedPosition?-(n.maxLabelSize.height+e+p(n.xAxisMultiLabelHeight)):n.maxLabelSize.height+e+p(n.xAxisMultiLabelHeight)),h;if(n.title.text){var o=this.heatMap,r=n.title,s=f(r.text,r.textStyle),u=this.padding,v="Near"===r.textStyle.textAlignment?"start":"Far"===r.textStyle.textAlignment?"end":"middle";u=n.opposedPosition?-(u+s.height/4):u+3*s.height/4;h=new c(o.element.id+"_XAxisTitle",new l(i.x+ai(i.width,0,0,r.textStyle),a+u,v,r.text),r.textStyle,r.textStyle.color||o.themeStyle.axisTitle);this.drawSvgCanvas.createText(h,t,r.text)}},n.prototype.drawYAxisTitle=function(n,t,i){var o,v,y,w;if(n.title.text){var r=n.title,s=this.heatMap,h=n.opposedPosition?90:-90,b="Near"===r.textStyle.textAlignment?"start":"Far"===r.textStyle.textAlignment?"end":"middle",u=10;u=n.opposedPosition?u:-u;var k="0px"===n.textStyle.size?0:u,f=i.x+k+(n.opposedPosition?n.maxLabelSize.width+p(n.yAxisMultiLabelHeight):-(n.maxLabelSize.width+p(n.yAxisMultiLabelHeight))),e=i.y+(o=i,v=0,y=0,"Near"===(w=r.textStyle).textAlignment?o.height-y:"Center"===w.textAlignment?o.height/2:v)+(n.opposedPosition?this.padding:-this.padding),a=new c(s.element.id+"_YAxisTitle",new l(f,e-this.padding,b,r.text,h,"rotate("+h+","+f+","+e+")","auto"),r.textStyle,r.textStyle.color||s.themeStyle.axisTitle);this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(a,r.text,f,e):this.drawSvgCanvas.createText(a,t,r.text)}},n.prototype.calculateVisibleLabels=function(){for(var n,r=this.heatMap.axisCollections,t=this.heatMap.dataSourceSettings,u=!(t&&t.isJsonData&&"Cell"===t.adaptorType),i=0,f=r.length;i<f;i++)"Numeric"===(n=r[i]).valueType&&u?(n.clearAxisLabel(),n.calculateNumericAxisLabels(this.heatMap)):"DateTime"===n.valueType&&u?(n.clearAxisLabel(),n.calculateDateTimeAxisLabel(this.heatMap)):"Category"===n.valueType&&(n.clearAxisLabel(),n.calculateCategoryAxisLabels()),n.tooltipLabels=n.isInversed?n.tooltipLabels.reverse():n.tooltipLabels},n.prototype.measureAxis=function(n){for(var i,t,u=this.heatMap,f=u.axisCollections,r=f.length-1;r>=0;r--)i="0px"===(t=f[r]).textStyle.size?0:this.padding,t.nearSizes=[],t.farSizes=[],t.computeSize(t,u,n),t.opposedPosition?"Horizontal"===t.orientation?(n.y+=p(t.farSizes)+i,n.height-=p(t.farSizes)+i):n.width-=p(t.farSizes)+i:"Horizontal"===t.orientation?n.height-=p(t.nearSizes)+i:(n.x+=p(t.nearSizes)+i,n.width-=p(t.nearSizes)+i)},n.prototype.calculateAxisSize=function(n){for(var t,i,e,f=this.heatMap.axisCollections,u=0,o=f.length;u<o;u++)for(t=f[u],t.rect=Object(r.extend)({},n,null,!0),"Horizontal"!==t.orientation||t.opposedPosition||(t.rect.y=n.y+n.height,t.rect.height=0),"Vertical"===t.orientation&&t.opposedPosition&&(t.rect.x=n.x+n.width,t.rect.width=0),t.multiLevelPosition=[],i=0;i<t.multiLevelLabels.length;i++)e=t.multiPosition(t,i),t.multiLevelPosition.push(e)},n.prototype.drawXAxisLabels=function(n,t,i){var p,b=this.heatMap,v=n.axisLabels,vt=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2:0,h=(i.width-vt)/n.axisLabelSize,k=0,ht=n.interval?n.interval:1,it=i.width/(n.axisLabelSize/n.axisLabelInterval),g=n.axisLabelInterval,rt,tt,ut,ft,nt,o,r,ct,u,at,et,ot,st;if(it>0)for(;it<parseInt(n.textStyle.size,10);)g+=1,it=i.width/(n.axisLabelSize/g);else g=n.tooltipLabels.length;for(n.axisLabelInterval<g&&(k=g,v=n.tooltipLabels,ht=g),nt=i.x+(n.isInversed?i.width:0),o=n.angle,rt=this.padding,b.enableCanvasRendering||(ut=this.heatMap.renderer.createGroup({id:b.element.id+"XAxisLabels"}),ft=this.heatMap.renderer.createGroup({id:b.element.id+"XAxisLabelBorder"})),n.isInversed&&"MultipleRows"===n.labelIntersectAction&&n.multipleRow.reverse(),r=0,ct=v.length;r<ct;r++){var a=new e(nt,i.y,h,i.height),y="Trim"===n.labelIntersectAction&&n.isIntersect?"DateTime"!==n.valueType||"None"===n.showLabelOn?w(h*ht,v[r],n.textStyle):w(n.dateTimeAxisLabelInterval[r]*h,v[r],n.textStyle):v[r],s=f(y=n.enableTrim?w(n.maxLabelLength,v[r],n.textStyle):y,n.textStyle),lt=void 0;tt=n.opposedPosition?-rt:rt+(o%360==0?s.height/2:0);u=a.x+(n.isInversed?-(a.width/2+s.width/2):a.width/2-s.width/2);("Trim"===n.labelIntersectAction?u=n.isInversed?u>nt-h?u:nt-h:u>=a.x?u:a.x:o%180==0&&(u=(u=u<i.x?i.x:u)+s.width>i.x+i.width?i.x+i.width-s.width:u),"MultipleRows"===n.labelIntersectAction&&0===n.labelRotation)?(at=n.opposedPosition?-(n.multipleRow[r].index-1):n.multipleRow[r].index-1,p=n.multipleRow[r].index>1?i.y+tt+s.height*at+(n.opposedPosition?-.5*s.height/2*n.multipleRow[r].index:.5*s.height/2*n.multipleRow[r].index):i.y+tt+(n.opposedPosition?-.5*s.height/2:.5*s.height/2)):p=i.y+tt;(this.drawXAxisBorder(n,ft,n.rect,u,s.width,r),o%360!=0)&&(o=o>360?o%360:o,et=vi(n.textStyle,y,o),lt="rotate("+o+","+(u=a.x+(n.isInversed?-a.width/2:a.width/2))+","+(p+=n.opposedPosition?-et.height/2:o%360==180||o%360==-180?0:et.height/2)+")");this.heatMap.cellSettings.border.width>5&&n.opposedPosition&&(p-=this.heatMap.cellSettings.border.width/2);this.heatMap.yAxis.opposedPosition&&this.heatMap.cellSettings.border.width>5&&(u+=this.heatMap.cellSettings.border.width/2);this.heatMap.xAxis.isInversed&&this.heatMap.cellSettings.border.width>5&&(u-=this.heatMap.cellSettings.border.width/2);ot=new c(b.element.id+"_XAxis_Label"+r,new l(u,p,o%360==0?"start":"middle",y,o,lt),n.textStyle,n.textStyle.color||b.themeStyle.axisLabel);(0!==o&&this.heatMap.enableCanvasRendering?this.drawSvgCanvas.canvasDrawText(ot,y):this.drawSvgCanvas.createText(ot,ut,y),0===k)?(st="DateTime"===n.valueType&&"None"!==n.showLabelOn?n.dateTimeAxisLabelInterval[r]:n.axisLabelInterval,nt+=n.isInversed?-st*h:st*h):nt+=n.isInversed?-k*h:k*h;-1!==y.indexOf("...")&&this.heatMap.tooltipCollection.push(new d(v[r],new e(u,p-s.height,s.width,s.height)));0!==k&&(r+=k-1)}b.enableCanvasRendering||(t.appendChild(ut),t.appendChild(ft))},n.prototype.drawYAxisLabels=function(n,t,i){var h,o=this.heatMap,a=n.axisLabels,v=i.height/n.axisLabelSize,y=0,tt=i.height/(n.axisLabelSize/n.axisLabelInterval),p=n.axisLabelInterval,u,k,et,ot,s,ct;if(tt>0)for(;tt<parseInt(n.textStyle.size,10);)p+=1,tt=i.height/(n.axisLabelSize/p);else p=n.tooltipLabels.length;n.axisLabelInterval<p&&(y=p,a=n.tooltipLabels);var it,rt,b=10,ut=i.y+(n.isInversed?0:i.height),lt=n.opposedPosition?"start":"end";for(b=n.opposedPosition?b:-b,o.enableCanvasRendering||(it=this.heatMap.renderer.createGroup({id:o.element.id+"YAxisLabels"}),rt=this.heatMap.renderer.createGroup({id:o.element.id+"YAxisLabelBorder"})),u=0,k=a.length;u<k;u++){var ft=new e(i.x,ut,i.width,v),st=ft.height/2,ht=this.heatMap.cellSettings.border.width>=20?this.heatMap.cellSettings.border.width/2:0,g=ft.x+b+(n.opposedPosition?ht:-ht),at=this.heatMap.cellSettings.border.width>5?this.heatMap.cellSettings.border.width/2/k*(n.isInversed?u:k-u):0,nt=ft.y-at+(n.isInversed?st:-st);h=n.enableTrim?w(n.maxLabelLength,a[u],n.textStyle):a[u];et=new c(o.element.id+"_YAxis_Label"+u,new l(g,nt,lt,h,0,"rotate("+n.angle+","+g+","+nt+")","middle"),n.textStyle,n.textStyle.color||o.themeStyle.axisLabel);(r.Browser.isIE&&!o.enableCanvasRendering&&(et.dy="1ex"),this.drawSvgCanvas.createText(et,it,h),0===y)?(ot="DateTime"===n.valueType&&"None"!==n.showLabelOn?n.dateTimeAxisLabelInterval[u]:n.axisLabelInterval,ut+=n.isInversed?ot*v:-ot*v):(ut+=n.isInversed?y*v:-y*v,u+=y-1);s=f(h,n.textStyle);(this.drawYAxisBorder(n,rt,n.rect,nt,s.height,u),-1!==h.indexOf("..."))&&(ct=n.opposedPosition?g:g-s.width,this.heatMap.tooltipCollection.push(new d(a[u],new e(ct,nt-s.height,s.width,s.height))))}o.enableCanvasRendering||(t.appendChild(it),t.appendChild(rt))},n.prototype.drawXAxisBorder=function(n,t,i,r,u,f){var h,e,l=i.width/n.axisLabelSize,c="",a=n.interval?n.interval:1,s=n.isInversed?i.x+i.width-l*f*a:i.x+l*f*a,o=i.y,v,y;e=o+(n.opposedPosition?-(n.maxLabelSize.height+10):n.maxLabelSize.height+10);h=n.isInversed?s-l:s+l;v=n.isInversed?r+u+10:r-10;y=n.isInversed?r-10:r+u+10;switch(n.border.type){case"Rectangle":c="M "+s+" "+o+" L "+s+" "+e+" L "+h+" "+e+" L "+h+" "+o+" L "+s+" "+o;break;case"WithoutTopBorder":c="M "+s+" "+o+" L "+s+" "+e+" L "+h+" "+e+" L "+h+" "+o+" ";break;case"WithoutBottomBorder":c="M "+s+" "+e+" L "+s+" "+o+" L "+h+" "+o+" L "+h+" "+e+" ";break;case"WithoutTopandBottomBorder":c="M "+s+" "+o+" L "+s+" "+e+" M "+h+" "+o+" L "+h+" "+e+" ";break;case"Brace":c="M "+s+" "+o+" L "+s+" "+(e=o+(e-o)/2+(n.opposedPosition?0:5))+" L "+v+" "+e+" M "+y+" "+e+" L "+h+" "+e+" L "+h+" "+o+" "}n.border.width>0&&"WithoutBorder"!==n.border.type&&this.createAxisBorderElement(n,c,t,f)},n.prototype.drawYAxisBorder=function(n,t,i,r,u,f){var e,h,l=i.height/n.axisLabelSize,c="",a=n.interval?n.interval:1,o=i.x,s=n.isInversed?i.y+l*f*a:i.y+i.height-l*f*a,v,y;e=o+(n.opposedPosition?n.maxLabelSize.width+20:-(n.maxLabelSize.width+20));h=n.isInversed?s+l:s-l;v=n.isInversed?r-u/2:r+u/2;y=n.isInversed?r+u/2:r-u/2;switch(n.border.type){case"Rectangle":c="M "+o+" "+s+" L "+o+" "+h+" L "+e+" "+h+" L "+e+" "+s+" L "+o+" "+s;break;case"WithoutTopBorder":c="M "+o+" "+s+" L "+e+" "+s+" L "+e+" "+h+" L "+o+" "+h+" ";break;case"WithoutBottomBorder":c="M "+e+" "+s+" L "+o+" "+s+" L "+o+" "+h+" L "+e+" "+h+" ";break;case"WithoutTopandBottomBorder":c="M "+o+" "+s+" L "+e+" "+s+" M "+e+" "+h+" L "+o+" "+h+" ";break;case"Brace":c="M "+o+" "+s+" L "+(e=o-(o-e)/2)+" "+s+" L "+e+" "+v+" M "+e+" "+y+" L "+e+" "+h+" L "+o+" "+h}n.border.width>0&&"WithoutBorder"!==n.border.type&&this.createAxisBorderElement(n,c,t,f)},n.prototype.createAxisBorderElement=function(n,t,i,r){var e="Horizontal"===n.orientation?"_XAxis_Label_Border":"_YAxis_Label_Border",u=new nt(this.heatMap.element.id+e+r,"transparent",n.border.width,n.border.color,1,"none",t),f;this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(u,void 0):(f=this.heatMap.renderer.drawPath(u),i.appendChild(f))},n.prototype.drawMultiLevels=function(n,t){var i;this.heatMap.enableCanvasRendering||(i=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_"+t.orientation+"_MultiLevelLabel"}));"Horizontal"===t.orientation?this.renderXAxisMultiLevelLabels(t,i):this.renderYAxisMultiLevelLabels(t,i);this.heatMap.enableCanvasRendering||n.appendChild(i)},n.prototype.renderXAxisMultiLevelLabels=function(n,t){var p,r,b,k,nt,tt,u,it,a,o,g,i=this,s=0,h=0,v=n.isInversed,ut=n.opposedPosition,y="",rt=(v?n.rect.width:0)+n.rect.x;n.multiLevelLabels.map(function(ft,et){a=i.heatMap.renderer.createGroup({id:i.heatMap.element.id+"_XAxisMultiLevelLabel"+et});ft.categories.map(function(ot,st){var lt,ht,ct;if("Bootstrap5"!==i.heatMap.theme&&"Bootstrap5Dark"!==i.heatMap.theme||ft.setProperties({textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},!0),"Tailwind"!==i.heatMap.theme&&"TailwindDark"!==i.heatMap.theme||ft.setProperties({textStyle:{fontFamily:"Inter"}},!0),k=!1,nt="number"==typeof ot.start?ot.start:Number(new Date(ot.start)),tt="number"==typeof ot.end?ot.end:Number(new Date(ot.end)),r=rt+i.calculateLeftPosition(n,nt,ot.start,n.rect),b=n.multiLevelPosition[et].y,h=rt+i.calculateWidth(n,ot.end,tt,n.rect),u=f(ot.text,ft.textStyle),o=(null===ot.maximumTextWidth?Math.abs(h-r):ot.maximumTextWidth)-10,p=b+(ut?-(n.xAxisMultiLabelHeight[et]-u.height):u.height),s=v?r-o:r+10,"Center"===ft.alignment?(s=(h-r)/2+r,s-=(u.width>o?o:u.width)/2):"Far"===ft.alignment?(s=v?r-10:h-10,s-=u.width>o?o:u.width):s=v?h+10:r+10,"None"===ft.overflow&&u.width>Math.abs(h-r)&&(s=v?r-u.width-10:r+10,it="start"),lt=new l(s,p,it,ot.text,0,"translate(0,0)"),ht=new c(i.heatMap.element.id+"_XAxis_MultiLevel"+et+"_Text"+st,lt,ft.textStyle,ft.textStyle.color||i.heatMap.themeStyle.axisLabel),"Wrap"===ft.overflow?(ht.text=bt(ot.text,o,ft.textStyle),g=ht.text.length):"Trim"===ft.overflow&&(ht.text=w(o,ot.text,ft.textStyle),g=1),"Wrap"===ft.overflow&&ht.text.length>1){for(i.drawSvgCanvas.createWrapText(ht,ft.textStyle,a),ct=0;ct<ht.text.length;ct++)if(-1!==ht.text[ct].indexOf("...")){k=!0;break}}else i.drawSvgCanvas.createText(ht,a,ht.text);i.heatMap.enableCanvasRendering||t.appendChild(a);(-1!==ht.text.indexOf("...")||-1!==ht.text[0].indexOf("...")||k)&&i.heatMap.tooltipCollection.push(new d(ot.text,new e(s,p-u.height,o,u.height*g)));ft.border.width>0&&"WithoutBorder"!==ft.border.type&&(y=i.renderXAxisLabelBorder(et,n,r,b,h,y,et,u,o,s))});""!==y&&(i.createBorderElement(et,n,y,t),y="")});this.heatMap.enableCanvasRendering||t.appendChild(a)},n.prototype.renderXAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h){var c=r+(t.opposedPosition?-t.xAxisMultiLabelHeight[n]:t.xAxisMultiLabelHeight[n]);switch(t.multiLevelLabels[e].border.type){case"Rectangle":f+="M "+i+" "+r+" L "+i+" "+c+" L "+u+" "+c+" L "+u+" "+r+" L "+i+" "+r+" ";break;case"WithoutTopBorder":f+="M "+i+" "+r+" L "+i+" "+c+" L "+u+" "+c+" L "+u+" "+r+" ";break;case"WithoutBottomBorder":f+="M "+i+" "+c+" L "+i+" "+r+" L "+u+" "+r+" L "+u+" "+c+" ";break;case"WithoutTopandBottomBorder":f+="M "+i+" "+r+" L "+i+" "+c+" M "+u+" "+r+" L "+u+" "+c+" ";break;case"Brace":f+="M "+i+" "+r+" L "+i+" "+(r+(c-r)/2)+" L "+(t.isInversed?(o.width>s?s:o.width)+h+3:h-3)+" "+(r+(c-r)/2)+" M "+(t.isInversed?h-3:(o.width>s?s:o.width)+h+3)+" "+(r+(c-r)/2)+" L "+u+" "+(r+(c-r)/2)+" L "+u+" "+r+" "}return f},n.prototype.renderYAxisMultiLevelLabels=function(n,t){var u,o,s,h,g,nt,r,y,a,p,i=this,b=0,k=n.isInversed,v="",tt=(k?0:n.rect.height)+n.rect.y;n.multiLevelLabels.map(function(it,rt){s=n.multiLevelPosition[rt].y;y=i.heatMap.renderer.createGroup({id:i.heatMap.element.id+"_YAxisMultiLevelLabel"+rt});it.categories.map(function(ut,ft){var ot,st,et;"Tailwind"!==i.heatMap.theme&&"TailwindDark"!==i.heatMap.theme||it.setProperties({textStyle:{fontFamily:"Inter"}},!0);"Bootstrap5"!==i.heatMap.theme&&"Bootstrap5Dark"!==i.heatMap.theme||it.setProperties({textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},!0);g="number"==typeof ut.start?ut.start:Number(new Date(ut.start));nt="number"==typeof ut.end?ut.end:Number(new Date(ut.end));s=tt+i.calculateLeftPosition(n,g,ut.start,n.rect);o=n.multiLevelPosition[rt].x;h=tt+i.calculateWidth(n,ut.start,nt,n.rect);r=f(ut.text,it.textStyle);a=(null===ut.maximumTextWidth?Math.abs(o):ut.maximumTextWidth)-10;ot=Math.abs(o-(o-n.multiLevelSize[rt].width-20))/2-r.width/2;b=(n.opposedPosition?o:o-n.multiLevelSize[rt].width-20)+ot;u=s+10;"None"!==it.overflow&&(p="Wrap"===it.overflow?bt(ut.text,a,it.textStyle):w(a,ut.text,it.textStyle));"Center"===it.alignment?u+=(h-s)/2-p.length*r.height/2:u="Far"===it.alignment?k?h-r.height/2:u-r.height:k?u+r.height/2:h+r.height;it.border.width>0&&"WithoutBorder"!==it.border.type&&(v=i.renderYAxisLabelBorder(rt,n,o,s,h,v,rt,r,a,u));st=new l(b,u,"start",ut.text,0,"translate(0,0)");et=new c(i.heatMap.element.id+"_YAxis_MultiLevel"+rt+"_Text"+ft,st,it.textStyle,it.textStyle.color||i.heatMap.themeStyle.axisLabel);et.text=p;i.drawSvgCanvas.createText(et,y,et.text);-1!==et.text.indexOf("...")&&i.heatMap.tooltipCollection.push(new d(ut.text,new e(b,u-r.height,a,r.height)));i.heatMap.enableCanvasRendering||t.appendChild(y)});""!==v&&(i.createBorderElement(rt,n,v,t),v="")});this.heatMap.enableCanvasRendering||t.appendChild(y)},n.prototype.renderYAxisLabelBorder=function(n,t,i,r,u,f,e,o,s,h){var l=20,c=i-(t.opposedPosition?-(t.multiLevelSize[n].width+l):t.multiLevelSize[n].width+l);switch(t.multiLevelLabels[e].border.type){case"Rectangle":f+="M "+i+" "+r+" L "+c+" "+r+" L "+c+" "+u+" L "+i+" "+u+" L "+i+" "+r+" ";break;case"WithoutTopBorder":f+="M "+i+" "+r+" L "+c+" "+r+" L "+c+" "+u+" L "+i+" "+u+" ";break;case"WithoutBottomBorder":f+="M "+c+" "+r+" L "+i+" "+r+" L "+i+" "+u+" L "+c+" "+u+" ";break;case"WithoutTopandBottomBorder":f+="M "+i+" "+r+" L "+c+" "+r+" M "+i+" "+u+" L "+c+" "+u+" ";break;case"Brace":l=10;f+="M "+i+" "+r+" L "+(i+(c-i)/2)+" "+r+" L "+(i+(c-i)/2)+" "+(t.isInversed?h-l-5:h+o.height-l)+" M "+(i+(c-i)/2)+" "+(t.isInversed?h+o.height-l:h-l-5)+" L "+(i+(c-i)/2)+" "+u+" L "+i+" "+u+" "}return f},n.prototype.createBorderElement=function(n,t,i,r){var f="Horizontal"===t.orientation?"XAxis":"YAxis",u=new nt(this.heatMap.element.id+"_"+f+"_MultiLevel_Rect_"+n,"Transparent",t.multiLevelLabels[n].border.width,t.multiLevelLabels[n].border.color,1,"",i),e=this.heatMap.renderer.drawPath(u);this.heatMap.enableCanvasRendering?this.heatMap.canvasRenderer.drawPath(u,void 0):r.appendChild(e)},n.prototype.calculateLeftPosition=function(n,t,i,r){var u,f;return"number"==typeof i?("Numeric"===n.valueType&&(n.minimum||n.maximum)&&(t-=n.minimum?n.minimum:0),f=("Horizontal"===n.orientation?r.width:r.height)/(n.axisLabelSize*n.increment),u=(n.isInversed?-1:1)*t*f,u="Horizontal"===n.orientation?u:-u):(f=this.calculateNumberOfDays(t,n,!0,r),u=n.isInversed?-f:f,u="Horizontal"===n.orientation?u:-u),u},n.prototype.calculateWidth=function(n,t,i,r){var f,u;return"number"==typeof t?("Numeric"===n.valueType&&(n.minimum||n.maximum)&&(i-=n.minimum?n.minimum:0),f=("Horizontal"===n.orientation?r.width:r.height)/(n.axisLabelSize*n.increment),u=(n.isInversed?-1:1)*(i+1)*f,u="Horizontal"===n.orientation?u:-u):(u=f=this.calculateNumberOfDays(i,n,!1,r),u=n.isInversed?-u:u,u="Horizontal"===n.orientation?u:-u),u},n.prototype.calculateNumberOfDays=function(n,t,i,r){for(var s,e,u,a,h=t.labelValue,c=("Horizontal"===t.orientation?r.width:r.height)/t.axisLabelSize,o=new Date(Number(n)),l=0,f=0;f<t.axisLabelSize;f++)if((e=new Date(Number(h[f])),u=t.isInversed?new Date(Number(h[f-1])):new Date(Number(h[f+1])),f===(t.isInversed?0:t.axisLabelSize-1))&&((u=new Date(Number(h[f])),"Hours"===t.intervalType)?u=new Date(Number(u.setHours(u.getHours()+1))):"Minutes"===t.intervalType?u=new Date(Number(u.setMinutes(u.getMinutes()+1))):"Days"===t.intervalType?u=new Date(Number(u.setDate(u.getDate()+1))):(s="Months"===t.intervalType?new Date(u.getFullYear(),u.getMonth()+1,0).getDate():u.getFullYear()%4==0?366:365,u=new Date(Number(u.setDate(u.getDate()+s))))),Number(e)<=n&&Number(u)>=n){if("Minutes"===t.intervalType||"Hours"===t.intervalType){l=c/Math.round(Math.abs((e.getTime()-u.getTime())/6e4))*Math.abs((e.getTime()-o.getTime())/6e4);a=(f=t.isInversed?t.axisLabelSize-1-f:f)*c+l;break}s=Math.round(Math.abs((e.getTime()-u.getTime())/864e5));i?o.getDate():o.setDate(o.getDate()+1);0!==s&&(l=c/s*Math.abs((e.getTime()-o.getTime())/864e5));a=(f=t.isInversed?t.axisLabelSize-1-f:f)*c+l;break}return a},n}(),uu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),tt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},fu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return uu(t,n),tt([Object(r.Property)(!0)],t.prototype,"showLabel",void 0),tt([Object(r.Property)("")],t.prototype,"format",void 0),tt([Object(r.Property)(!0)],t.prototype,"enableCellHighlighting",void 0),tt([Object(r.Complex)({},ur)],t.prototype,"bubbleSize",void 0),tt([Object(r.Complex)({},gi)],t.prototype,"border",void 0),tt([Object(r.Complex)(g.rectLabelFont,ut)],t.prototype,"textStyle",void 0),tt([Object(r.Property)("Rect")],t.prototype,"tileType",void 0),tt([Object(r.Property)("Color")],t.prototype,"bubbleType",void 0),tt([Object(r.Property)(!1)],t.prototype,"isInversedBubbleSize",void 0),t}(r.ChildProperty),eu=function(){function n(n){this.heatMap=n;this.drawSvgCanvas=new ht(this.heatMap);this.cellColor=new ci(this.heatMap)}return n.prototype.renderRectSeries=function(){var n,k,p,u,i,d,tt,w;this.createSeriesGroup();n=this.heatMap;k=!1;n.xLength=n.axisCollections[0].axisLabelSize;n.yLength=n.axisCollections[1].axisLabelSize;var s,f,h=Math.round(100*n.initialClipRect.x)/100,b=Math.round(100*n.initialClipRect.y)/100,a=0,e=0,t=n.cellSettings,v=Math.round((n.initialClipRect.width-t.border.width/2)/n.xLength*100)/100,y=Math.round((n.initialClipRect.height-t.border.width/2)/n.yLength*100)/100,g=0,nt=(n.themeStyle,[]),o=t.border;for(this.rectPositionCollection=[],this.color="",this.bubbleColorValue=[],n.yAxis.opposedPosition&&(h=Math.round(100*(n.initialClipRect.x+parseFloat(o.width.toString())/2))/100),p=this.getBubbleRadius(v,y),u=0;u<n.xLength*n.yLength;u++)"Column"===n.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type?(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[e],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[e]):"Row"===n.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataSourceMinValue=this.heatMap.dataMin[a],this.heatMap.dataSourceMaxValue=this.heatMap.dataMax[a]),this.setTextAndColor(a,e),i=new ar(0,0,0,0,0,"",0,0,0,0,!0,"","",!0),(s=o.color,this.heatMap.bubbleSizeWithColor?this.updateRectDetails(i,h,b,v,y,Object(r.extend)("",this.bubbleColorValue,null,!0),u,e,a):this.updateRectDetails(i,h,b,v,y,this.text,u,e,a),f=t.showLabel?this.getFormatedText(this.text,t.format):"",i.displayText=f,Object(r.isNullOrUndefined)(this.heatMap.cellRender)||(f=this.cellRendering(i,f)),("Canvas"===n.renderingMode&&0===parseFloat(o.width.toString())||!s&&"Bubble"===t.tileType&&"Sector"===t.bubbleType)&&(s=this.color),"Rect"===t.tileType)?(this.renderTileCell(i,o,u,this.color,s),this.updateLabelVisibleStatus(v,y,f)):"Color"===t.bubbleType?(this.renderBubbleCell(i,o,u,this.color,s,p),this.updateLabelVisibleStatus(2*p-12,2*p-6,f)):Object(r.isNullOrUndefined)(this.text)||"Size"!==t.bubbleType&&"SizeAndColor"!==t.bubbleType||""===this.text.toString()?"Sector"!==t.bubbleType||Object(r.isNullOrUndefined)(this.text)||""===this.text.toString()||(this.renderSectorCell(i,o,u.toString(),this.color,s,p,this.text),this.checkLabelXDisplay=!1,this.checkLabelYDisplay=!1):("Table"!==this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.minColorValue=isFinite(this.heatMap.minColorValue)?this.heatMap.minColorValue:this.heatMap.dataSourceMinValue,this.heatMap.maxColorValue=isFinite(this.heatMap.maxColorValue)?this.heatMap.maxColorValue:this.heatMap.dataSourceMaxValue),d=this.getRadiusBypercentage(parseFloat(this.text.toString()),n.dataSourceMinValue,n.dataSourceMaxValue,p),this.renderBubbleCell(i,o,u,this.color,s,d),this.updateLabelVisibleStatus(2*d-12,2*d-6,f)),(nt.push(i),n.rangeSelection&&"Fixed"===n.paletteSettings.type&&(k=this.isCellValueInRange(a,e),i.visible=k),t.showLabel&&this.checkLabelYDisplay&&this.checkLabelXDisplay)&&(tt=t.textStyle,w=new c(n.element.id+"_HeatMapRectLabels_"+u,new l(Math.round(100*(h+v/2))/100,Math.round(100*(b+y/2))/100,"middle",f,null,null,"middle"),tt,tt.color||this.getSaturatedColor(this.color)),i.textId=w.id,n.rangeSelection&&"Fixed"===n.paletteSettings.type&&(w.fill=k?w.fill:this.heatMap.themeStyle.toggledColor),r.Browser.isIE&&!n.enableCanvasRendering&&(w.dy="Bubble"===this.heatMap.cellSettings.tileType?"0.5ex":"1ex"),this.drawSvgCanvas.createText(w,this.containerTextObject,f)),g===n.xLength-1?(b=Math.round(100*(b+y))/100,g=0,e=0,h=n.yAxis.opposedPosition?Math.round(100*(n.initialClipRect.x+parseFloat(o.width.toString())/2))/100:Math.round(100*n.initialClipRect.x)/100,this.rectPositionCollection.push(nt),nt=[],a++):(h=Math.round(100*(h+v))/100,g++,e++);n.enableCanvasRendering||(n.svgObject.appendChild(this.containerRectObject),!t.showLabel||"Bubble"===t.tileType&&"Sector"===t.bubbleType||n.svgObject.appendChild(this.containerTextObject))},n.prototype.isCellValueInRange=function(n,t){for(var f,s,u=!1,i=0;i<this.heatMap.toggleValue.length;i++){f=void 0;s=0!==i||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[i].startValue:this.heatMap.toggleValue[i].value:this.heatMap.dataSourceMinValue;f="Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?i===this.heatMap.toggleValue.length-1?this.heatMap.maxColorValue:this.heatMap.toggleValue[i+1].value-.01:i!==this.heatMap.toggleValue.length-1||this.heatMap.isColorRange?this.heatMap.isColorRange?this.heatMap.toggleValue[i].endValue:this.heatMap.toggleValue[i+1].value-.01:this.heatMap.dataSourceMaxValue;var o=this.heatMap.clonedDataSource,h=Object(r.isNullOrUndefined)(o[n][t][1])||""===o[n][t][1].toString()?"":o[n][t][1],e=parseFloat("Bubble"===this.heatMap.cellSettings.tileType&&"SizeAndColor"===this.heatMap.cellSettings.bubbleType?h.toString():this.text.toString());if(isNaN(e))u=!0;else{if(!isNaN(e)&&e>=s&&e<=f){if(this.heatMap.toggleValue[i].visible){u=!0;break}u=!1;break}if(this.heatMap.isColorRange&&f>=this.heatMap.toggleValue[i].endValue&&i===this.heatMap.toggleValue.length-1){u=!0;break}}}return u},n.prototype.cellRendering=function(n,t){var r=this.heatMap.axisCollections[0],u=this.heatMap.axisCollections[1],f=r.tooltipLabels,e=u.tooltipLabels.slice().reverse(),o=u.labelValue.slice().reverse(),i={heatmap:this.heatMap,cancel:!1,name:"cellRender",value:n.value,xLabel:f[n.xIndex].toString(),yLabel:e[n.yIndex].toString(),displayText:t,xValue:r.labelValue[n.xIndex],yValue:o[n.yIndex],cellColor:this.color};return this.heatMap.trigger("cellRender",i),this.color=i.cellColor,i.displayText},n.prototype.setTextAndColor=function(n,t){var u,i,f;this.bubbleColorValue=[];u=this.heatMap.dataSourceSettings;i=this.heatMap.clonedDataSource;this.heatMap.bubbleSizeWithColor?(this.text=Object(r.isNullOrUndefined)(i[n][t][0])||""===i[n][t][0].toString()?"":i[n][t][0],this.color=Object(r.isNullOrUndefined)(i[n][t][1])||""===i[n][t][1].toString()?this.heatMap.isColorValueExist?this.heatMap.emptyPointColor:this.cellColor.getColorByValue(this.text):this.cellColor.getColorByValue(i[n][t][1]),f=new sr(u.isJsonData&&"Cell"===u.adaptorType?u.bubbleDataMapping.size:null,this.text,"Size"),this.bubbleColorValue.push(f),this.bubbleColorValue.push({mappingName:u.isJsonData&&"Cell"===u.adaptorType?u.bubbleDataMapping.color:null,bubbleData:Object(r.isNullOrUndefined)(i[n][t][1])||""===i[n][t][1].toString()?"":i[n][t][1],valueType:"Color"})):(this.text=i[n][t],this.color=this.cellColor.getColorByValue(this.text))},n.prototype.createSeriesGroup=function(){this.heatMap.enableCanvasRendering||(this.containerRectObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_RectGroup"}),!this.heatMap.cellSettings.showLabel||"Bubble"===this.heatMap.cellSettings.tileType&&"Sector"===this.heatMap.cellSettings.bubbleType||(this.containerTextObject=this.heatMap.renderer.createGroup({id:this.heatMap.element.id+"_Container_TextGroup",transform:"translate( 0, 0)"})))},n.prototype.updateRectDetails=function(n,t,i,r,u,f,e,o,s){n.x=t;n.y=i;n.width=r;n.height=u;n.value=f;n.id=this.heatMap.element.id+"_HeatMapRect_"+e;n.xIndex=o;n.yIndex=s},n.prototype.renderTileCell=function(n,t,i,r,u){var f=new k(this.heatMap.element.id+"_HeatMapRect_"+i,r,t,1,new e(n.x,n.y,n.width,n.height),u||this.heatMap.themeStyle.cellBorder,t.radius,t.radius);this.drawSvgCanvas.drawRectangle(f,this.containerRectObject,!0)},n.prototype.getBubbleRadius=function(n,t){var i=n/2-2;return t/2<n/2&&(i=t/2-2),i<0?0:i},n.prototype.renderSectorCell=function(n,t,i,r,u,f,e){for(var v,nt,y,p,s,h,c,l,a,tt,it,w,b=Math.round(100*(n.x+n.width/2))/100,k=Math.round(100*(n.y+n.height/2))/100,d=r,o=this.getRadiusBypercentage(e,this.heatMap.dataSourceMinValue,this.heatMap.dataSourceMaxValue,360),g=0;g<2;g++)if(w=parseFloat(t.width.toString()),0===g?(y=o>=180?1:0,p=-90,s=0===o?270:o-90,h=Math.round(100*(b+f*Math.cos((o-90)*(Math.PI/180))))/100,c=Math.round(100*(k+f*Math.sin((o-90)*(Math.PI/180))))/100,l=Math.round(100*b)/100,a=Math.round(100*(k-f))/100,0===o&&(d=this.heatMap.emptyPointColor)):(y=o>=180?0:1,p=s,s=270,d=this.heatMap.emptyPointColor,i+="_Unfilled",tt=h,it=c,h=l,c=a,l=tt,a=it,0===o&&(w=1,u=r)),v=new wr("",!1,b,k,l,a,h,c,p,s,f,!0),nt=new pr(this.heatMap.element.id+"_HeatMapRect_"+i,v,d,t,w,1,u),this.calculateShapes(nt,v,o,y),this.drawSvgCanvas.drawPath(nt,v,this.containerRectObject),360===o)break},n.prototype.calculateShapes=function(n,t,i,u){var f;switch(i){case 360:case 0:f=0===i&&t.start===t.end?"M "+n.x+" "+n.y+" L "+t.x+" "+(t.y-t.radius):(f=this.heatMap.enableCanvasRendering?"":"M "+n.x+" "+n.y+" ")+"m "+-t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+2*t.radius+" 0 a "+t.radius+" "+t.radius+" 0 1 0 "+-2*t.radius+" 0 ";Object(r.merge)(n,{d:f});break;default:f="M "+n.x+" "+n.y+" L "+t.x1+" "+t.y1+" A "+t.radius+" "+t.radius+" 0 "+u+" 1 "+t.cx+" "+t.cy+" Z";Object(r.merge)(n,{d:f})}},n.prototype.renderBubbleCell=function(n,t,i,r,u,f){var e=new yr(this.heatMap.element.id+"_HeatMapRect_"+i,r,t,1,u||this.heatMap.themeStyle.cellBorder,Math.round(100*(n.x+n.width/2))/100,Math.round(100*(n.y+n.height/2))/100,f);this.drawSvgCanvas.drawCircle(e,this.containerRectObject)},n.prototype.updateLabelVisibleStatus=function(n,t,i){this.heatMap.cellSettings.showLabel&&(this.checkLabelYDisplay=t>parseInt(this.heatMap.cellSettings.textStyle.size,10),this.checkLabelXDisplay=n>i.length*(parseInt(this.heatMap.cellSettings.textStyle.size,10)/2))},n.prototype.getRadiusBypercentage=function(n,t,i,r){var f=parseInt(this.heatMap.cellSettings.bubbleSize.minimum,10),e=parseInt(this.heatMap.cellSettings.bubbleSize.maximum,10),u;return(f<0||f>100||isNaN(f))&&(f=0),(e<0||e>100||isNaN(e))&&(e=100),u=(n-t)/(i-t)*100,u=isNaN(u)?100:u,(this.heatMap.bubbleSizeWithColor||"Bubble"===this.heatMap.cellSettings.tileType&&"Size"===this.heatMap.cellSettings.bubbleType)&&(this.heatMap.cellSettings.isInversedBubbleSize&&(u=100-u),u=u*(e-f)/100+f),r*=u/100,Math.round(100*r)/100<0?0:Math.round(100*r)/100},n.prototype.getSaturatedColor=function(n){var t=n,u,i,r;return t="transparent"===t?window.getComputedStyle(document.body,null).backgroundColor:t,r=(u=nu(t),(i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(u))?new wt(parseInt(i[1],16),parseInt(i[2],16),parseInt(i[3],16)):new wt(255,255,255)),Math.round((299*r.R+587*r.G+114*r.B)/1e3)>=128?"black":"white"},n.prototype.highlightSvgRect=function(n){var r,i,t;-1===n.indexOf("Celltooltip")&&(-1!==n.indexOf("_HeatMapRect")?(-1!==n.indexOf("_HeatMapRectLabels_")&&(r=n.indexOf("_HeatMapRectLabels_")+19,n=this.heatMap.element.id+"_HeatMapRect_"+n.slice(r)),i=document.getElementById(n),this.heatMap.tempRectHoverClass!==n&&(this.heatMap.cellSettings.enableCellHighlighting&&(t=void 0,this.heatMap.tempRectHoverClass&&(t=document.getElementById(this.heatMap.tempRectHoverClass)),t&&!this.heatMap.rectSelected&&t.setAttribute("opacity","1"),i&&!this.heatMap.rectSelected&&i.setAttribute("opacity","0.65")),this.heatMap.tempRectHoverClass=n)):this.heatMap.cellSettings.enableCellHighlighting&&(t=void 0,this.heatMap.tempRectHoverClass&&(t=document.getElementById(this.heatMap.tempRectHoverClass)),t&&!this.heatMap.rectSelected&&(t.setAttribute("opacity","1"),this.heatMap.tempRectHoverClass="")))},n.prototype.getFormatedText=function(n,t){var i=t,u=null!==i.match("{value}"),r;return this.format=this.heatMap.intl.getNumberFormat({format:u?"":i}),r="",""!==n.toString()&&(r=yt(u,i,n,this.format)),r},n.prototype.getCurrentRect=function(n,t){var f,i=[],r,u;return i.push(this.heatMap.heatMapSeries.rectPositionCollection[0][0]),r=Math.ceil((n-i[0].x)/i[0].width)<this.heatMap.axisCollections[0].axisLabelSize?Math.ceil((n-i[0].x)/i[0].width):this.heatMap.axisCollections[0].axisLabelSize,u=Math.floor((t-i[0].y)/i[0].height)<this.heatMap.axisCollections[1].axisLabelSize?Math.floor((t-i[0].y)/i[0].height):this.heatMap.axisCollections[1].axisLabelSize-1,r=0===r?1:r,f=this.heatMap.heatMapSeries.rectPositionCollection[u][r-1],this.hoverXAxisLabel=this.heatMap.axisCollections[0].tooltipLabels[r-1],this.hoverXAxisValue=this.heatMap.axisCollections[0].labelValue[r-1],this.hoverYAxisLabel=this.heatMap.axisCollections[1].tooltipLabels[this.heatMap.axisCollections[1].tooltipLabels.length-1-u],this.hoverYAxisValue=this.heatMap.axisCollections[1].labelValue[this.heatMap.axisCollections[1].labelValue.length-1-u],f},n}(),ou=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),dt=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},su=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return ou(t,n),dt([Object(r.Property)("")],t.prototype,"template",void 0),dt([Object(r.Property)("")],t.prototype,"fill",void 0),dt([Object(r.Complex)({},nr)],t.prototype,"border",void 0),dt([Object(r.Complex)(g.tooltipFont,ut)],t.prototype,"textStyle",void 0),t}(r.ChildProperty),hu=function(){function n(n){this.isFirst=!0;this.isFadeout=!1;this.heatMap=n}return n.prototype.getModuleName=function(){return"Tooltip"},n.prototype.showHideTooltip=function(n,t){var i=document.getElementById(this.heatMap.element.id+"Celltooltipcontainer");n?i.style.visibility="visible":(i&&"hidden"!==i.style.visibility&&(this.tooltipObject&&t&&this.heatMap.isRectBoundary?this.tooltipObject.fadeOut():this.tooltipObject&&this.tooltipObject.element&&this.tooltipObject.element.firstChild.setAttribute("opacity","0"),i.style.visibility="hidden"),this.isFadeout=!0)},n.prototype.destroy=function(){},n.prototype.createTooltip=function(n,t,i,u){var f=null,e=Object(r.select)("#"+this.heatMap.element.id+"Celltooltipcontainer");this.heatMap.cellSettings.showLabel&&this.heatMap.heatMapSeries.checkLabelXDisplay&&this.heatMap.heatMapSeries.checkLabelYDisplay&&(f=parseInt(this.heatMap.cellSettings.textStyle.size,10)/2);"Tailwind"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}}},!0);"TailwindDark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#F9FAFB",textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500",color:"#1F2937"}}},!0);"Bootstrap5"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{textStyle:{size:"14px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500"}}},!0);"Bootstrap5Dark"===this.heatMap.theme&&this.heatMap.setProperties({tooltipSettings:{fill:"#E9ECEF",textStyle:{size:"14px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500",color:"#212529"}}},!0);this.tooltipObject=new rt.Tooltip({opacity:"Tailwind"===this.heatMap.theme||"TailwindDark"===this.heatMap.theme||"Bootstrap5"===this.heatMap.theme||"Bootstrap5Dark"===this.heatMap.theme?1:.75,enableAnimation:!1,offset:f,location:{x:t,y:i},availableSize:this.heatMap.availableSize,data:{xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,value:n.value,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null},theme:this.heatMap.theme,content:u,fill:this.heatMap.tooltipSettings.fill,template:""===this.heatMap.tooltipSettings.template?null:this.heatMap.tooltipSettings.template,border:{width:this.heatMap.tooltipSettings.border.width,color:this.heatMap.tooltipSettings.border.color},textStyle:{size:this.heatMap.tooltipSettings.textStyle.size,fontWeight:this.heatMap.tooltipSettings.textStyle.fontWeight.toLowerCase(),color:this.heatMap.tooltipSettings.textStyle.color,fontStyle:this.heatMap.tooltipSettings.textStyle.fontStyle.toLowerCase(),fontFamily:this.heatMap.tooltipSettings.textStyle.fontFamily},areaBounds:{height:this.heatMap.initialClipRect.height+this.heatMap.initialClipRect.y,width:this.heatMap.initialClipRect.width,x:this.heatMap.initialClipRect.x}},e)},n.prototype.createTooltipDiv=function(n){var t=n.enableCanvasRendering&&n.allowSelection?n.availableSize.height:0,i=Object(r.createElement)("div",{id:this.heatMap.element.id+"Celltooltipcontainer",styles:"position:absolute; z-index: 3;top:-"+t+"px"});this.heatMap.element.appendChild(Object(r.createElement)("div",{id:this.heatMap.element.id+"Celltooltipparent",styles:"position:relative"}).appendChild(i))},n.prototype.getTooltipContent=function(n,t){var u,f,i=this.heatMap,r=this.heatMap.dataSourceSettings;if(i.bubbleSizeWithColor){var e=i.xAxis.title&&""!==i.xAxis.title.text?i.xAxis.title.text:"X-Axis",o=i.yAxis.title&&""!==i.yAxis.title.text?i.yAxis.title.text:"Y-Axis",s=r.isJsonData&&"Cell"===r.adaptorType?r.bubbleDataMapping.size:"Value 1",h=r.isJsonData&&"Cell"===r.adaptorType?r.bubbleDataMapping.color:"Value 2";u=t.getFormatedText(n.value[0].bubbleData,this.heatMap.cellSettings.format);f=[e+" : "+t.hoverXAxisLabel+"<br/>"+o+" : "+t.hoverYAxisLabel+"<br/>"+s+" : "+u+"<br/>"+h+" : "+t.getFormatedText(n.value[1].bubbleData,this.heatMap.cellSettings.format)]}else u=n.value,f=[t.hoverXAxisLabel+" | "+t.hoverYAxisLabel+" : "+t.getFormatedText(u,this.heatMap.cellSettings.format)];return f},n.prototype.renderTooltip=function(n){var i=this,u=this.heatMap.heatMapSeries,t=[""],f,e;(this.heatMap.bubbleSizeWithColor?Object(r.isNullOrUndefined)(n.value)||Object(r.isNullOrUndefined)(n.value[0].bubbleData)||""===n.value[0].bubbleData.toString():Object(r.isNullOrUndefined)(n.value)||!Object(r.isNullOrUndefined)(n.value)&&""===n.value.toString())?(this.showHideTooltip(!1,!1),n.visible||this.showHideTooltip(!1,!1)):Object(r.isNullOrUndefined)(this.heatMap.tooltipRender)?(t=this.getTooltipContent(n,u),this.tooltipCallback(n,t)):(f=this.getTooltipContent(n,u),e={heatmap:this.heatMap,cancel:!1,name:"tooltipRender",value:n.value,xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,content:f},this.heatMap.trigger("tooltipRender",e,function(r){r.cancel?i.tooltipObject&&i.showHideTooltip(!1):(t=r.content,i.tooltipCallback(n,t))}))},n.prototype.tooltipCallback=function(n,t){this.tooltipObject?(this.tooltipObject.content=t,this.tooltipObject.data={xValue:this.heatMap.heatMapSeries.hoverXAxisValue,yValue:this.heatMap.heatMapSeries.hoverYAxisValue,xLabel:this.heatMap.heatMapSeries.hoverXAxisLabel?this.heatMap.heatMapSeries.hoverXAxisLabel.toString():null,yLabel:this.heatMap.heatMapSeries.hoverYAxisLabel?this.heatMap.heatMapSeries.hoverYAxisLabel.toString():null,value:n.value}):this.createTooltip(n,n.x+n.width/2,n.y+n.height/2,t);this.showHideTooltip(!0);this.tooltipObject.enableAnimation=!this.isFirst&&!this.isFadeout;this.isFirst=!this.isFirst&&this.isFirst;this.isFadeout=!this.isFadeout&&this.isFadeout;this.tooltipObject.location.x=n.x+n.width/2;this.tooltipObject.location.y=n.y+n.height/2;n.visible||this.showHideTooltip(!1,!1)},n}(),cu=function(){function n(n){this.heatMap=n}return n.prototype.processDataSource=function(n){var w=Object(r.extend)([],n,null,!0),u,o,e,s;this.heatMap.clonedDataSource=[];this.completeDataSource=[];var h,c,i,t=this.heatMap.axisCollections,l=t[0].maxLength+1,a=t[0].axisLabelSize+(t[0].min>0?t[0].min:0),v=l>a?l:a,y=(l=t[1].maxLength+1)>(a=t[1].axisLabelSize+(t[1].min>0?t[1].min:0))?l:a,f=0,p=[];for(this.tempSizeArray=[],this.tempColorArray=[],this.heatMap.minColorValue=null,this.heatMap.maxColorValue=null,this.heatMap.dataMax=[],this.heatMap.dataMin=[],"Column"===this.heatMap.paletteSettings.colorGradientMode&&v<y&&(v=y),u="Category"===t[1].valueType?t[1].min:0;u<("Column"===this.heatMap.paletteSettings.colorGradientMode?v:y);u++){for(o="Category"===t[0].valueType?t[0].min:0,this.completeDataSource.push([]);o<v;)o>=t[0].min&&o<=t[0].max&&this.processDataArray(w,o,u,f),o++;if("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type)for(i=Object(r.extend)([],w[f],null,!0),e=0;e<i.length;e++)"object"==typeof i[e]&&null!==i[e]&&(i[e]=i[e][0]);else i=Object(r.extend)([],this.completeDataSource[f],null,!0);s=this.getMinMaxValue(h,c,i);"Column"!==this.heatMap.paletteSettings.colorGradientMode&&"Row"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax[u]=s[1],this.heatMap.dataMin[u]=s[0]);h=s[0];c=s[1];this.heatMap.xAxis.isInversed&&(this.completeDataSource[f]=this.completeDataSource[f].reverse());u>=this.heatMap.axisCollections[1].min&&u<=this.heatMap.axisCollections[1].max&&p.push(this.completeDataSource[f]);f++}"Row"!==this.heatMap.paletteSettings.colorGradientMode||this.heatMap.yAxis.isInversed||"Gradient"!==this.heatMap.paletteSettings.type||(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse());"Column"===this.heatMap.paletteSettings.colorGradientMode&&this.heatMap.xAxis.isInversed&&"Gradient"===this.heatMap.paletteSettings.type&&(this.heatMap.dataMax=this.heatMap.dataMax.reverse(),this.heatMap.dataMin=this.heatMap.dataMin.reverse());this.heatMap.yAxis.isInversed||(this.completeDataSource.reverse(),p.reverse());this.heatMap.clonedDataSource=p;this.heatMap.dataSourceMinValue=Object(r.isNullOrUndefined)(h)?0:parseFloat(h.toString());this.heatMap.dataSourceMaxValue=Object(r.isNullOrUndefined)(c)?0:parseFloat(c.toString());this.heatMap.isColorValueExist=!Object(r.isNullOrUndefined)(this.heatMap.minColorValue);this.heatMap.minColorValue=Object(r.isNullOrUndefined)(this.heatMap.minColorValue)?this.heatMap.dataSourceMinValue:parseFloat(this.heatMap.minColorValue.toString());this.heatMap.maxColorValue=Object(r.isNullOrUndefined)(this.heatMap.maxColorValue)?this.heatMap.dataSourceMaxValue:parseFloat(this.heatMap.maxColorValue.toString())},n.prototype.processDataArray=function(n,t,i,u){if(this.heatMap.bubbleSizeWithColor)if(n[t]&&!Object(r.isNullOrUndefined)(n[t][i])&&"object"==typeof n[t][i]){for(var e=n[t][i],f=0;f<e.length;f++)if((Object(r.isNullOrUndefined)(e[f])||isNaN(e[f]))&&(e[f]=""),0===f)this.tempSizeArray.push(e[f]);else if(1===f){this.tempColorArray.push(e[f]);break}this.completeDataSource[u].push(e)}else!Object(r.isNullOrUndefined)(n[t])&&(n[t][i]||0===n[t][i]&&""!==n[t][i].toString())?(this.completeDataSource[u].push([n[t][i]]),this.tempSizeArray.push(n[t][i])):this.completeDataSource[u].push("");else n[t]&&(n[t][i]||0===n[t][i]&&""!==n[t][i].toString())?"object"==typeof n[t][i]?n[t][i].length>0&&!Object(r.isNullOrUndefined)(n[t][i][0])?this.completeDataSource[u].push(n[t][i][0]):this.completeDataSource[u].push(""):this.completeDataSource[u].push(n[t][i]):this.completeDataSource[u].push("")},n.prototype.getMinMaxValue=function(n,t,i){var r=[];return this.heatMap.bubbleSizeWithColor?("Column"===this.heatMap.paletteSettings.colorGradientMode&&"Gradient"===this.heatMap.paletteSettings.type&&(this.tempSizeArray=i),r.push(this.getMinValue(n,this.tempSizeArray)),r.push(this.getMaxValue(t,this.tempSizeArray)),this.heatMap.minColorValue=this.getMinValue(this.heatMap.minColorValue,this.tempColorArray),this.heatMap.maxColorValue=this.getMaxValue(this.heatMap.maxColorValue,this.tempColorArray)):(r.push(this.getMinValue(n,i)),r.push(this.getMaxValue(t,i))),r},n.prototype.getMinValue=function(n,t){return Object(r.isNullOrUndefined)(n)||this.performSort(t)<n?n=this.performSort(t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(n=this.performSort(t)),Object(r.isNullOrUndefined)(n)?n:parseFloat(n.toString())},n.prototype.getMaxValue=function(n,t){return Object(r.isNullOrUndefined)(n)&&t.length>0||Math.max.apply(Math,t)>n?n=Math.max.apply(Math,t):"Row"!==this.heatMap.paletteSettings.colorGradientMode&&"Column"!==this.heatMap.paletteSettings.colorGradientMode||"Gradient"!==this.heatMap.paletteSettings.type||(n=Math.max.apply(Math,t)),Object(r.isNullOrUndefined)(n)?n:parseFloat(n.toString())},n.prototype.performSort=function(n){return n.sort(function(n,t){return n-t}).filter(this.checkmin)[0]},n.prototype.checkmin=function(n){return!Object(r.isNullOrUndefined)(n)&&""!==n.toString()},n}(),lu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),v=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},au=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return lu(t,n),v([Object(r.Property)("")],t.prototype,"height",void 0),v([Object(r.Property)("")],t.prototype,"width",void 0),v([Object(r.Complex)({text:"",textStyle:g.titleFont},ii)],t.prototype,"title",void 0),v([Object(r.Property)("Right")],t.prototype,"position",void 0),v([Object(r.Property)(!0)],t.prototype,"visible",void 0),v([Object(r.Property)("Center")],t.prototype,"alignment",void 0),v([Object(r.Property)(!0)],t.prototype,"showLabel",void 0),v([Object(r.Property)(!0)],t.prototype,"showGradientPointer",void 0),v([Object(r.Property)(!1)],t.prototype,"enableSmartLegend",void 0),v([Object(r.Property)("All")],t.prototype,"labelDisplayType",void 0),v([Object(r.Complex)(g.legendLabelFont,ut)],t.prototype,"textStyle",void 0),v([Object(r.Property)("")],t.prototype,"labelFormat",void 0),v([Object(r.Property)(!0)],t.prototype,"toggleVisibility",void 0),t}(r.ChildProperty),vu=function(){function n(n){this.maxLegendLabelSize=new h(0,0);this.gradientScaleSize=10;this.segmentCollections=[];this.segmentCollectionsLabels=[];this.textWrapCollections=[];this.labelCollections=[];this.labelCollection=[];this.legendSize=10;this.previousOptions=new kr(0,0,0,0,0,0);this.listPerPage=0;this.numberOfPages=1;this.listWidth=0;this.fillRect=new e(0,0,0,0);this.legendRect=new e(0,0,0,0);this.currentPage=1;this.lastList=[];this.navigationCollections=[];this.pagingRect=new e(0,0,0,0);this.listInterval=10;this.legendLabelTooltip=[];this.legendTitleTooltip=[];this.labelXCollections=[];this.labelYCollections=[];this.legendXCollections=[];this.legendYCollections=[];this.legendRectPositionCollection=[];this.legendRange=[];this.legendTextRange=[];this.visibilityCollections=[];this.heatMap=n;this.drawSvgCanvas=new ht(n)}return n.prototype.getModuleName=function(){return"Legend"},n.prototype.destroy=function(){},n.prototype.renderLegendItems=function(){var n=this.heatMap,l,p,o,t,w,f,s,h,c,g,nt,tt;n.toggleValue=[];l={color:"transparent",width:0};this.legend=n.renderer.createGroup({id:n.element.id+"_Heatmap_Legend"});p=new k(n.element.id+"_LegendBound","none",l,1,this.legendGroup);this.drawSvgCanvas.drawRectangle(p,this.legend);var v,i=this.legendRectScale,a=n.canvasRenderer.ctx,u=new e(i.x,i.y,i.width,i.height);if("Fixed"===n.paletteSettings.type)for(o=n.legendSettings.enableSmartLegend?n.legendColorCollection:n.colorCollection,this.legendRange=n.resizing||!n.legendOnLoad&&n.rendering?[]:this.legendRange,this.legendTextRange=n.resizing||!n.legendOnLoad&&n.rendering?[]:this.legendTextRange,n.enableCanvasRendering&&(a.save(),a.clip()),t=0;t<o.length;t++)w=!!Object(r.isNullOrUndefined)(this.visibilityCollections[t])||this.visibilityCollections[t],n.toggleValue.push(new gr(w,o[t].value,o[t].startValue,o[t].endValue));if("Gradient"===n.paletteSettings.type||"Fixed"===n.paletteSettings.type&&!0===n.legendSettings.enableSmartLegend){if("Gradient"===n.paletteSettings.type){if(n.enableCanvasRendering){for(f=void 0,s=n.canvasRenderer.ctx,f=n.horizontalGradient?s.createLinearGradient(i.x,0,i.x+i.width,0):s.createLinearGradient(0,i.y,0,i.y+i.height),n.legendSettings.title.text&&s.clip(),t=0;t<n.legendColorCollection.length;t++)h=((this.heatMap.isColorRange?n.legendColorCollection[t].startValue:n.legendColorCollection[t].value)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),h=isNaN(h)?0:h,this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateCanvasColorRange(t,f):f.addColorStop(h,n.legendColorCollection[t].color);s.fillStyle=f;v=f.toString()}else{var b=void 0,d=void 0,y=[];for(t=0;t<n.legendColorCollection.length;t++)if(this.heatMap.isColorRange&&"Gradient"===this.heatMap.paletteSettings.type?this.calculateColorRange(t,y):(c=(n.legendColorCollection[t].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,c=isNaN(c)?0:c,d=new it(n.legendColorCollection[t].color,c+"%"),y.push(d)),this.legendMaxValue===this.legendMinValue)break;b=n.horizontalGradient?new ei(n.element.id+"_lineargradient","0%","100%","0%","0%"):new ei(n.element.id+"_lineargradient","0%","0%","0%","100%");g=n.renderer.drawGradient("linearGradient",b,y);this.legend.appendChild(g);v="url(#"+n.element.id+"_lineargradient)"}nt=new k(n.element.id+"_Gradient_Legend",v,l,1,u);this.drawSvgCanvas.drawRectangle(nt,this.legend);this.renderElements(u)}else this.renderSmartLegend(),this.renderTitle(u);n.enableCanvasRendering||n.svgObject.appendChild(this.legend);n.enableCanvasRendering&&a.restore();this.renderLegendLabel(u)}else this.legendScale=n.renderer.createGroup({id:n.element.id+"Heatmap_GradientScale"}),tt=new k(n.element.id+"_Gradient_Scale","none",l,1,this.legendRectScale),this.drawSvgCanvas.drawRectangle(tt,this.legendScale),this.renderTitle(u),n.enableCanvasRendering||this.legend.appendChild(this.legendScale),this.translategroup=n.renderer.createGroup({id:n.element.id+"_translate"}),this.calculateListPerPage(u),this.numberOfPages>1&&(this.paginggroup=n.renderer.createGroup({id:n.element.id+"_navigation"})),this.renderListLegendMode(u,!0),n.enableCanvasRendering&&a.restore()},n.prototype.renderElements=function(n){this.renderTitle(n);this.renderColorAxisGrid(n)},n.prototype.calculateCanvasColorRange=function(n,t){var i=this.heatMap,r=((i.legendColorCollection[n].startValue<i.dataSourceMinValue&&i.legendColorCollection[n].endValue>i.dataSourceMinValue?i.dataSourceMinValue:i.legendColorCollection[n].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),u;r=isNaN(r)?0:r;u=((i.legendColorCollection[n].endValue>=this.heatMap.dataSourceMaxValue?this.heatMap.dataSourceMaxValue:i.legendColorCollection[n].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue);this.heatMap.legendColorCollection[0].startValue!==this.heatMap.dataSourceMinValue&&0===n&&this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&(r=(this.heatMap.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r/2,this.heatMap.paletteSettings.fillColor.minColor),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.maxColor));t.addColorStop(r,i.legendColorCollection[n].minColor);t.addColorStop(u,i.legendColorCollection[n].maxColor);this.heatMap.legendColorCollection[n].endValue!==(n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[n+1].startValue)&&this.heatMap.legendColorCollection[n].endValue<this.heatMap.dataSourceMaxValue&&(r=(i.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.minColor),r=((n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:i.legendColorCollection[n+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue),t.addColorStop(r,this.heatMap.paletteSettings.fillColor.maxColor))},n.prototype.calculateColorRange=function(n,t){var i,u,f,e,r,o;void 0===t&&(t=[]);r=this.heatMap;r.toggleValue=[];this.heatMap.legendColorCollection[0].startValue>this.heatMap.dataSourceMinValue&&0===n&&(i=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,i=isNaN(i)?0:i,u=new it(r.paletteSettings.fillColor.minColor,i+"%"),t.push(u),i=(r.legendColorCollection[0].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,u=new it(r.paletteSettings.fillColor.maxColor,i+"%"),t.push(u));i=(r.legendColorCollection[n].startValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;i=isNaN(i)?0:i;u=new it(r.legendColorCollection[n].minColor,i+"%");t.push(u);i=(r.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100;o=new it(r.legendColorCollection[n].maxColor,i+"%");t.push(o);this.heatMap.legendColorCollection[n].endValue!==(n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:this.heatMap.legendColorCollection[n+1].startValue)&&(i=(r.legendColorCollection[n].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=new it(this.heatMap.paletteSettings.fillColor.minColor,i+"%"),t.push(f),i=((n===this.heatMap.legendColorCollection.length-1?this.heatMap.dataSourceMaxValue:r.legendColorCollection[n+1].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,e=new it(this.heatMap.paletteSettings.fillColor.maxColor,i+"%"),t.push(e))},n.prototype.renderTitle=function(n){var t=this.heatMap;if(t.legendSettings.title.text){var r=t.legendSettings.title,i=f(r.text,r.textStyle),u=t.legendSettings.showLabel?this.labelPadding:t.horizontalGradient?10:6,s=void 0,h=void 0,o=r.text,a=void 0,v=void 0;"Trim"===t.legendSettings.title.textStyle.textOverflow&&(o=w(h=this.width-10,o,r.textStyle));t.horizontalGradient?(s=n.y+("Top"===t.legendSettings.position?0:-(10+i.height+u)),u="Top"===t.legendSettings.position?-(u+i.height/4):u+3*i.height/4,v="Bottom"===t.legendSettings.position?s:s-i.height,0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new d(r.text,new e(n.x,v,h,i.height))),i.width=n.width<i.width?n.width:i.width,a=new c(t.element.id+"_legendTitle",new l(n.x+n.width/2-i.width/2,s+u,"start",o,0,"translate(0,0)",void 0),r.textStyle,r.textStyle.color||t.themeStyle.heatMapTitle)):(u=-(u+i.height/4),0!==o.length&&t.enableCanvasRendering&&this.legendTitleTooltip.push(new d(r.text,new e(n.x,n.y-i.height,h,i.height))),a=new c(t.element.id+"_legendTitle",new l(n.x,n.y+u,"start",o,0,"translate(0,0)",void 0),r.textStyle,r.textStyle.color||t.themeStyle.heatMapTitle));this.drawSvgCanvas.createText(a,this.legend,o)}},n.prototype.renderSmartLegend=function(){var w,s,h,c,l,t=this.heatMap,a=t.colorCollection,nt={color:"transparent",width:0},o=this.legendRectScale,v=o.width/a.length,y=o.height/a.length,n,u,i,b,g,p;for(this.legendRectPositionCollection=[],this.legendRange=[],n=0;n<t.legendColorCollection.length;n++)u=new dr(0,0,0,0,"",""),t.horizontalGradient?(s=o.x+n*v,h=o.y,c=v,l=o.height,this.segmentCollections.push("Edge"!==t.legendSettings.labelDisplayType||n!==t.legendColorCollection.length-1||t.legendColorCollection[n].isHidden?s:s+v)):(s=o.x,h=o.y+n*y,c=o.width,l=y,this.segmentCollections.push("Edge"!==t.legendSettings.labelDisplayType||n!==t.legendColorCollection.length-1||t.legendColorCollection[n].isHidden?h:h+y)),w=new e(s,h,c,l),i=new vt(0,0,0,0,0,!0,0),(i.x=s,i.y=h,i.width=c,i.height=l,i.value=this.heatMap.isColorRange?t.legendColorCollection[n].endValue:t.legendColorCollection[n].value,i.currentPage=this.currentPage,a.length!==t.legendColorCollection.length&&n===t.legendColorCollection.length-1&&(t.horizontalGradient?i.width=0:i.height=0,this.visibilityCollections[n]=this.visibilityCollections[n-1]),i.visible=!!Object(r.isNullOrUndefined)(this.visibilityCollections[n])||this.visibilityCollections[n],this.legendRange.push(i),t.legendColorCollection[n].isHidden)||(b=t.legendOnLoad||this.legendRange[n].visible?this.heatMap.isColorRange?a[n].minColor:a[n].color:"#D3D3D3",g=new k(t.element.id+"_Smart_Legend"+n,b,nt,1,w),(this.drawSvgCanvas.drawRectangle(g,this.legend),u.x=s,u.y=h,u.width=c,u.height=l,u.label=this.labelCollections[n],u.id=t.element.id+"_Smart_Legend"+n,this.legendRectPositionCollection.push(u),0!==ct(this.labelCollections[n],t.legendSettings.textStyle,this.textWrapCollections[n]).length&&t.enableCanvasRendering)&&(p=f(this.labelCollections[n],t.legendSettings.textStyle),this.legendLabelTooltip.push(new d(this.labelCollections[n],new e(u.x,u.y,p.width,p.height)))))},n.prototype.colorRangeLegendPosition=function(n,t){if(this.segmentCollections.length!==this.segmentCollectionsLabels.length){for(var i=0;i<this.segmentCollections.length;i++)if(this.segmentCollectionsLabels[n]===this.segmentCollections[i]){t=this.segmentCollectionsLabels[n]+((i===this.segmentCollections.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollections[i+1])-this.segmentCollections[i])/2;break}}else t=this.segmentCollectionsLabels[n]+((n===this.segmentCollectionsLabels.length-1?this.heatMap.horizontalGradient?this.width:this.height:this.segmentCollectionsLabels[n+1])-this.segmentCollectionsLabels[n])/2;this.labelPosition=t},n.prototype.renderLegendLabel=function(n){var t=this.heatMap,p,w,rt,b,nt,ut;if(this.legendTextRange=[],t.legendSettings.showLabel&&("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&"None"!==t.legendSettings.labelDisplayType)){var k="start",h=void 0,v=void 0,tt=0,y=void 0;this.legendLabelTooltip=[];var u=void 0,g=t.isColorRange,a=t.legendColorCollection;t.enableCanvasRendering?(p=t.canvasRenderer.ctx,p.rect(this.legendGroup.x,this.legendGroup.y,this.legendGroup.width,this.legendGroup.height),p.save(),p.clip(),p.restore()):v=t.renderer.createGroup({id:t.element.id+"_Heatmap_LegendLabel"});for(var o=void 0,s=void 0,i=0;i<a.length;i++){if(w=(a[i].value-Math.round(100*this.legendMinValue)/100)/(Math.round(100*this.legendMaxValue)/100-Math.round(100*this.legendMinValue)/100)*100,t.horizontalGradient?(this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(i,o),o=this.labelPosition):o=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[i]+n.width/a.length/2:this.segmentCollections[i],s=n.y+n.height+this.labelPadding,k=Math.round(100*w)/100==0&&!g||"Fixed"===t.paletteSettings.type&&0===i?"start":Math.round(100*w)/100==100&&"Gradient"===t.paletteSettings.type&&!g||Math.round(100*t.dataSourceMaxValue)/100===a[i].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Fixed"===t.paletteSettings.type&&"Edge"===t.legendSettings.labelDisplayType?"end":"middle",h="hanging"):(o=n.x+n.width+this.labelPadding,this.heatMap.isColorRange&&"Gradient"===t.paletteSettings.type?(this.colorRangeLegendPosition(i,s),s=this.labelPosition):s=this.heatMap.legendSettings.enableSmartLegend&&this.heatMap.isColorRange&&"Fixed"===t.paletteSettings.type?this.segmentCollections[i]+n.height/a.length/2:this.segmentCollections[i],h=Math.round(100*w)/100==0&&!g||0===i&&"Fixed"===t.paletteSettings.type?"hanging":Math.round(100*w)/100==100&&!g&&"Gradient"===t.paletteSettings.type||Math.round(100*t.dataSourceMaxValue)/100===a[i].value&&t.legendSettings.enableSmartLegend||t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&"Fixed"===t.paletteSettings.type?"auto":"middle"),tt=t.horizontalGradient?this.textWrapCollections[i]:this.width-(this.legendRectScale.width+this.labelPadding+this.legendRectPadding),u=f((y=ct(this.labelCollections[i],t.legendSettings.textStyle,tt))[0],t.legendSettings.textStyle),"Fixed"===t.paletteSettings.type){var ft="hanging"===h?s:"middle"===h?s-u.height/2:s-u.height,et="end"===k?o-u.width:"middle"===k?o-u.width/2:o,it=new vt(et,ft,u.width,u.height,a[i].value,!0,this.currentPage);it.visible=!!Object(r.isNullOrUndefined)(this.visibilityCollections[i])||this.visibilityCollections[i];this.legendTextRange.push(it)}if(""!==this.labelCollections[i]&&(0!==y.length&&-1!==y[0].indexOf("...")&&t.enableCanvasRendering&&this.legendLabelTooltip.push(new d(this.labelCollections[i],new e(o,s,u.width,u.height))),rt=new l(o,s,k,y,0,"translate(0,0)",h),b=new c(t.element.id+"_Legend_Label"+i,rt,t.legendSettings.textStyle,t.legendSettings.textStyle.color||t.themeStyle.legendLabel),b.fill=t.legendOnLoad||"Fixed"!==t.paletteSettings.type||this.legendRange[i].visible?b.fill:"#D3D3D3",y.length>1?this.drawSvgCanvas.createWrapText(b,t.legendSettings.textStyle,v):this.drawSvgCanvas.createText(b,v,y[0]),r.Browser.isIE&&!t.enableCanvasRendering&&("middle"===h?v.lastChild.setAttribute("dy","0.6ex"):"hanging"===h&&v.lastChild.setAttribute("dy","1.5ex"))),this.legendMaxValue===this.legendMinValue&&"Gradient"===t.paletteSettings.type)break}t.enableCanvasRendering||(this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,this.legend.appendChild(v),nt=t.renderer.createClipPath({id:t.element.id+"_clipPath"}),ut=t.renderer.drawRectangle(this.legendGroup),nt.appendChild(ut),t.svgObject.appendChild(nt),this.legend.setAttribute("style","clip-path:url(#"+nt.id+")"))}},n.prototype.renderGradientPointer=function(n,t,i){var p,v,r,e,o,s,h,c,l,f=this.heatMap,a=f.heatMapSeries.getCurrentRect(t,i),y=f.bubbleSizeWithColor?""!==a.value[0].bubbleData.toString()?this.heatMap.isColorValueExist?a.value[1].bubbleData.toString():a.value[0].bubbleData.toString():"":a.value.toString(),u=this.legendRectScale;""!==y.toString()?(f.horizontalGradient?(r=u.width/100*((Number(y)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,r=isNaN(r)?0:r,e=u.x+r,o=u.y+u.height,s=u.x-5+r,h=l=u.y+u.height+8,c=u.x+5+r):(r=u.height/100*((Number(y)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue))*100,r=isNaN(r)?0:r,e=u.x-1,o=u.y+r,s=c=u.x-8,h=u.y-5+r,l=u.y+5+r),p="M "+e+" "+o+" L "+s+" "+h+" L "+c+" "+l+" Z",v=new nt(f.element.id+"_Gradient_Pointer","gray",.01,"#A0A0A0",1,"0,0",p),f.enableCanvasRendering)?(this.removeGradientPointer(),f.canvasRenderer.drawPath(v,void 0),this.previousOptions.pathX1=e,this.previousOptions.pathY1=o,this.previousOptions.pathX2=s,this.previousOptions.pathY2=h,this.previousOptions.pathX3=c,this.previousOptions.pathY3=l):(this.gradientPointer=f.renderer.drawPath(v),this.gradientPointer.style.visibility="visible",this.legend.appendChild(this.gradientPointer)):this.removeGradientPointer()},n.prototype.removeGradientPointer=function(){var n=this.heatMap;this.gradientPointer&&!n.enableCanvasRendering?this.gradientPointer.style.visibility="hidden":n.enableCanvasRendering&&(0!==Object.keys(this.previousOptions).length&&(n.horizontalGradient?(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY1,this.fillRect.width=this.previousOptions.pathX3-this.previousOptions.pathX2+2,this.fillRect.height=this.previousOptions.pathY2+1-this.previousOptions.pathY1):(this.fillRect.x=this.previousOptions.pathX2-1,this.fillRect.y=this.previousOptions.pathY2-1,this.fillRect.width=this.previousOptions.pathX1-this.previousOptions.pathX2+1,this.fillRect.height=this.previousOptions.pathY3-this.previousOptions.pathY2+2)),n.canvasRenderer.ctx.fillStyle=n.themeStyle.background,n.canvasRenderer.ctx.fillRect(this.fillRect.x,this.fillRect.y,this.fillRect.width,this.fillRect.height))},n.prototype.calculateLegendBounds=function(n){var t=this.heatMap,u=t.legendSettings,r,c,l,o,h,i,e,s;if(this.labelCollection=[],this.labelCollections=[],r=t.legendColorCollection,"Bottom"!==u.position&&"Top"!==u.position&&"Right"!==u.position&&"Left"!==u.position&&(u.position="Right"),c=t.legendSettings.title,l=f(c.text,c.textStyle),t.horizontalGradient="Bottom"===u.position||"Top"===u.position,this.legendRectPadding=t.horizontalGradient?t.legendSettings.title.text?l.height+16:16:10,this.labelPadding=u.showLabel?this.heatMap.horizontalGradient?10:6:0,this.legendHeight=u.height,this.legendWidth=u.width,o=t.legendSettings.labelFormat,h=null!==o.match("{value}"),this.format=t.intl.getNumberFormat({format:h?"":o}),"Fixed"===t.paletteSettings.type)for(i=0;i<r.length;i++)e={cancel:!1,text:s=r[i].label?r[i].label:this.heatMap.isColorRange?r[i].startValue.toString()+"-"+r[i].endValue.toString():yt(h,o,r[i].value,this.format).toString(),name:"legendRender"},this.labelCollection.push(s),this.heatMap.trigger("legendRender",e),t.legendRender?t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&i>0&&i<r.length-1||e.cancel?this.labelCollections.push(""):this.labelCollections.push(e.text):t.legendSettings.enableSmartLegend&&"Edge"===t.legendSettings.labelDisplayType&&i>0&&i<r.length-1?this.labelCollections.push(""):this.labelCollections.push(s);else for(i=0;i<r.length;i++)e={cancel:!1,text:s=r[i].isHidden?"":r[i].label?r[i].label:this.heatMap.isColorRange?r[i].startValue.toString()+"-"+r[i].endValue.toString():yt(h,o,r[i].value,this.format).toString(),name:"legendRender"},r[i].isHidden||this.heatMap.trigger("legendRender",e),t.legendRender?e.cancel||i>0&&i<r.length-1&&"Edge"===t.legendSettings.labelDisplayType||e.cancel?this.labelCollections.push(""):this.labelCollections.push(e.text):i>0&&i<r.length-1&&"Edge"===t.legendSettings.labelDisplayType?this.labelCollections.push(""):this.labelCollections.push(s);"Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend?(this.maxLegendLabelSize=this.getMaxLabelSize(),t.horizontalGradient&&""===u.height?this.legendHeight=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.height).toString():!t.horizontalGradient&&""===u.width&&("None"===u.textStyle.textOverflow||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend&&"None"===t.legendSettings.labelDisplayType)&&(this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.maxLegendLabelSize.width).toString()),this.calculateTitleBounds()):this.calculateListLegendBounds(n);this.legendHeight=this.legendHeight?this.legendHeight:t.horizontalGradient?"50":"100%";this.legendWidth=this.legendWidth?this.legendWidth:t.horizontalGradient?"100%":"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?"50":"70";this.height=b(this.legendHeight,n.height);this.width=b(this.legendWidth,n.width);t.horizontalGradient?(this.height=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.height<50?50:this.height,"Top"===u.position&&(n.y+=this.height),n.height-=this.height):(this.width=("Gradient"===t.paletteSettings.type||t.legendSettings.enableSmartLegend)&&this.width<50?50:this.width,"Left"===u.position&&(n.x+=this.width),n.width-=this.width)},n.prototype.calculateTitleBounds=function(){var n=this.heatMap,i=n.legendSettings.title,t=f(i.text,i.textStyle);n.legendSettings.title.text&&("Top"!==n.legendSettings.position&&"Bottom"!==n.legendSettings.position||""!==n.legendSettings.height||(this.legendHeight=(2*this.legendRectPadding-t.height+this.legendSize+this.maxLegendLabelSize.height).toString()),""===n.legendSettings.width&&("None"===n.legendSettings.textStyle.textOverflow||"Fixed"===n.paletteSettings.type&&n.legendSettings.enableSmartLegend&&"None"===n.legendSettings.labelDisplayType)&&("Right"===n.legendSettings.position?this.legendWidth=(2*this.legendRectPadding+t.width+this.legendSize+this.maxLegendLabelSize.width).toString():"Left"===n.legendSettings.position&&(t.width=t.width>this.maxLegendLabelSize.width?t.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+t.width+this.legendSize).toString())))},n.prototype.calculateListLegendBounds=function(n){var t=this.heatMap,r,u,o;this.listWidth=0;this.listHeight=0;this.currentPage=1;var e=t.legendSettings.title,i=f(e.text,e.textStyle),s=(i.height+50).toString();if(t.horizontalGradient){for(r=0;r<t.colorCollection.length;r++)u=0,t.legendSettings.showLabel&&(u=f(this.labelCollections[r],t.legendSettings.textStyle).width),o=this.legendSize+this.labelPadding+u+this.listInterval,this.listWidth+=o;this.listWidth+=this.listInterval+10;""===this.legendWidth&&(this.legendWidth=this.listWidth>n.width?n.width.toString():this.listWidth.toString());""===this.legendHeight&&(this.numberOfRows=Math.ceil(this.listWidth/b(this.legendWidth,n.width)),this.numberOfRows=this.numberOfRows>3?3:this.numberOfRows,this.legendHeight=(this.listWidth>n.width||this.listWidth>b(this.legendWidth,n.width))&&this.numberOfRows>3?((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding+parseInt(t.legendSettings.textStyle.size,10)+10).toString():((this.legendSize+this.listInterval)*this.numberOfRows+this.legendRectPadding).toString())}else this.listHeight=(this.legendSize+this.listInterval)*t.colorCollection.length+this.listInterval+(t.legendSettings.title.text?i.height:0),""===this.legendHeight&&(this.legendHeight=this.listHeight>n.height?n.height.toString():this.listHeight.toString()),""===this.legendWidth&&"Trim"!==t.legendSettings.textStyle.textOverflow&&(this.maxLegendLabelSize=this.getMaxLabelSize(),this.maxLegendLabelSize.width=i.width>this.maxLegendLabelSize.width?i.width:this.maxLegendLabelSize.width,this.legendWidth=(2*this.legendRectPadding+this.legendSize+this.labelPadding+this.maxLegendLabelSize.width).toString());b(this.legendHeight,n.height)<50&&(this.legendHeight=s);b(this.legendWidth,n.width)<70&&(this.legendWidth="70")},n.prototype.getMaxLabelSize=function(){var n=this.heatMap,t,r,i;if(this.maxLegendLabelSize=new h(0,0),!n.legendSettings.showLabel||n.horizontalGradient&&"Fixed"===n.paletteSettings.type&&!n.legendSettings.enableSmartLegend||"Fixed"===n.paletteSettings.type&&"None"===n.legendSettings.labelDisplayType)return this.maxLegendLabelSize;for(t=this.maxLegendLabelSize,r=0;r<n.legendColorCollection.length;r++)i=f(this.labelCollections[r],n.legendSettings.textStyle),t.width=t.width>i.width?t.width:i.width,t.height=t.height>i.height?t.height:i.height;return t},n.prototype.calculateLegendSize=function(n,t){var c,l,r,i=this.heatMap,a=i.legendSettings,h=a.alignment,u=b(this.legendHeight,n.height),o,s,v,y;r=i.legendSettings.title.text?this.width:b(this.legendWidth,n.width);o=i.axisCollections;s=0;i.horizontalGradient?(r=r>n.width?n.width:r,u="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?u>50?u:50:this.height,c="Near"===h?n.x:"Far"===h?n.x+n.width-r:n.x+n.width/2-r/2,""!==i.xAxis.title.text&&(s=f(i.xAxis.title.text,i.xAxis.textStyle).height+10),v=o[0].opposedPosition?0:p(o[0].xAxisMultiLabelHeight)+o[0].maxLabelSize.height+s+10,l="Top"===a.position?i.titleSettings.text?t:i.margin.top:n.y+n.height+v):(u=u>n.height?n.height:u,r="Gradient"===i.paletteSettings.type||i.legendSettings.enableSmartLegend?r>50?r:50:r,l="Near"===h?n.y:"Far"===h?n.y+n.height-u:n.y+n.height/2-u/2,""!==i.yAxis.title.text&&(s=f(i.yAxis.title.text,i.yAxis.textStyle).height+10),y=o[1].opposedPosition?p(o[1].yAxisMultiLabelHeight)+o[1].maxLabelSize.width+s+20:0,c="Right"===a.position?n.x+n.width+y:i.margin.left);this.legendGroup=new e(c,l,r,u);this.calculateGradientScale(this.legendGroup)},n.prototype.measureListLegendBound=function(n){var i=this.heatMap,r=i.legendSettings.title,u,t;this.numberOfPages=1;u=f(r.text,r.textStyle);i.horizontalGradient?this.listWidth>this.width?(this.numberOfRows=Math.ceil(this.listWidth/this.width),this.listHeight=(this.legendSize+this.listInterval)*this.numberOfRows,this.listPerPage=this.numberOfRows<=3?this.numberOfRows:Math.ceil((this.height-15-parseInt(i.legendSettings.textStyle.size,10)-this.legendRectPadding)/(this.legendSize+this.listInterval)),this.numberOfPages=Math.ceil(this.numberOfRows/this.listPerPage)):this.listPerPage=1:this.listHeight>n.height||this.listHeight>this.height?(t=b(this.legendHeight,n.height),t=t>n.height?n.height:t,t=i.legendSettings.title.text?t-u.height:t,this.listPerPage=Math.floor(t/(this.legendSize+this.listInterval)-1),this.numberOfPages=Math.max(1,Math.ceil(i.colorCollection.length/this.listPerPage))):(this.listPerPage=i.colorCollection.length,this.legendHeight=this.listHeight.toString())},n.prototype.renderPagingElements=function(){var n=this.heatMap,p,a,v,y,b,d;if(this.numberOfPages>1){this.navigationCollections=[];this.legend.appendChild(this.paginggroup);var i=this.legendGroup.x+this.legendGroup.width-10,t=this.legendGroup.y+this.legendGroup.height-10,s=this.currentPage+"/"+this.numberOfPages,u=f(s,n.legendSettings.textStyle),h=i-u.width-15,g=new l(h,t,"start",s,0,"translate(0,0)","middle"),tt=new c(n.element.id+"_paging",g,n.legendSettings.textStyle,n.legendSettings.textStyle.color||n.themeStyle.legendLabel);this.drawSvgCanvas.createText(tt,this.paginggroup,s);r.Browser.isIE&&!n.enableCanvasRendering&&this.paginggroup.lastChild.setAttribute("dy","0.6ex");this.pagingRect=new e(h,t-u.height/2,u.width,u.height);p=new k(n.element.id+"_pagingText","none",{color:"transparent",width:0},1,this.pagingRect);this.drawSvgCanvas.drawRectangle(p,this.paginggroup);a=new k(n.element.id+"_rightArrow","none",{color:"transparent",width:0},1,new e(i-10,t-5,10,10));this.drawSvgCanvas.drawRectangle(a,this.paginggroup);var it="M "+i+" "+t+" L "+(i-10)+" "+(t-5)+" L "+(i-10)+" "+(t+5)+"Z",o=h-15,rt="M "+o+" "+t+" L "+(o+10)+" "+(t-5)+" L "+(o+10)+" "+(t+5)+"Z",w=new k(n.element.id+"_leftArrow","none",{color:"transparent",width:0},1,new e(o,t-5,10,10));this.drawSvgCanvas.drawRectangle(w,this.paginggroup);v=new nt(n.element.id+"_Legend_leftarrow","gray",.01,"#A0A0A0",1,"0,0",rt);y=new nt(n.element.id+"_Legend_rightarrow","gray",.01,"#A0A0A0",1,"0,0",it);(this.navigationCollections.push(a),this.navigationCollections.push(w),n.enableCanvasRendering)?(n.canvasRenderer.drawPath(v,void 0),n.canvasRenderer.drawPath(y,void 0)):(b=n.renderer.drawPath(v),d=n.renderer.drawPath(y),this.paginggroup.appendChild(b),this.paginggroup.appendChild(d))}},n.prototype.calculateGradientScale=function(n){var i,r,u,o,t=this.heatMap,s=t.legendSettings.title,c=f(s.text,s.textStyle),h=t.legendSettings.title.text?c.height:0;"Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend||this.measureListLegendBound(t.initialClipRect);t.horizontalGradient?(i=n.x+10,r=n.y+this.legendRectPadding,o="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?n.width-20:n.width-2*this.listInterval,u="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval):(i=n.x+this.legendRectPadding,r=n.y+10+h,o="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?this.gradientScaleSize:n.width-10,u="Fixed"!==t.paletteSettings.type||t.legendSettings.enableSmartLegend?n.height-20-h:(this.legendSize+this.listInterval)*this.listPerPage-this.listInterval);this.legendRectScale=new e(i,r,o,u);("Gradient"===t.paletteSettings.type||"Fixed"===t.paletteSettings.type&&t.legendSettings.enableSmartLegend)&&this.calculateColorAxisGrid(this.legendRectScale)},n.prototype.calculateColorAxisGrid=function(n){var o,p,w,f,t=this.heatMap,c=this.legendRectScale,s=0,u,r,h,e,a,v,y;this.segmentCollectionsLabels=[];this.segmentCollections=[];this.textWrapCollections=[];var l,i="Gradient"===t.paletteSettings.type?t.legendColorCollection:t.colorCollection,b=t.bubbleSizeWithColor?t.minColorValue:t.dataSourceMinValue,k=t.bubbleSizeWithColor?t.maxColorValue:t.dataSourceMaxValue;if(this.legendMinValue=this.heatMap.isColorRange?i[0].startValue>t.dataSourceMinValue?t.dataSourceMinValue:i[0].startValue:i[0].value>b?b:i[0].value,this.legendMaxValue=this.heatMap.isColorRange?i[i.length-1].endValue<t.dataSourceMaxValue?t.dataSourceMaxValue:i[i.length-1].endValue:i[i.length-1].value<k?k:i[i.length-1].value,"Gradient"===t.paletteSettings.type)for(u=0;u<i.length;u++)r=void 0,o=(this.heatMap.isColorRange&&t.horizontalGradient?c.width:c.height)/100,this.heatMap.isColorRange?(i[0].startValue!==this.heatMap.dataSourceMinValue&&0===u&&i[0].startValue>this.heatMap.dataSourceMinValue&&(r=(this.heatMap.dataSourceMinValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f)),r=((i[u].startValue<t.dataSourceMinValue&&i[u].endValue>t.dataSourceMaxValue?t.dataSourceMinValue:i[u].startValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,r=isNaN(r)?0:r,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f),this.segmentCollectionsLabels.push(f),i[u].endValue!==(u===i.length-1?this.heatMap.dataSourceMaxValue:i[u+1].startValue)&&this.heatMap.legendColorCollection[u].endValue<this.heatMap.dataSourceMaxValue&&(u===i.length-1&&(r=(i[u].endValue-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f)),r=((u===i.length-1?this.heatMap.dataSourceMaxValue:i[u].endValue)-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,f=(t.horizontalGradient?n.x:n.y)+o*r,this.segmentCollections.push(f))):(r=(i[u].value-this.legendMinValue)/(this.legendMaxValue-this.legendMinValue)*100,r=isNaN(r)?0:r,t.horizontalGradient?(o=c.width/100,w=n.x+o*r,this.segmentCollections.push(w)):(o=c.height/100,f=n.y+o*r,this.segmentCollections.push(f)));if(t.horizontalGradient){for(h=this.heatMap.isColorRange?this.segmentCollectionsLabels:this.segmentCollections,e=0;e<i.length;e++)"Gradient"===t.paletteSettings.type?(a=(h[e]-h[e-1])/2,v=(h[e+1]-h[e])/2,l=e===i.length-1?this.heatMap.isColorRange?(n.width-h[e-1])/2:a:0===e?v:a<v&&!this.heatMap.isColorRange?a:v):(y=this.legendRectScale.width/t.colorCollection.length,l="Edge"===t.legendSettings.labelDisplayType?y:y/2),this.textWrapCollections.push(l),s=(p=ct(this.labelCollections[e],t.legendSettings.textStyle,l)).length>s?p.length:s;"Bottom"===t.legendSettings.position?(t.initialClipRect.height-=this.maxLegendLabelSize.height*(s-1),this.legendGroup.y-=this.maxLegendLabelSize.height*(s-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(s-1)):(t.initialClipRect.y+=this.maxLegendLabelSize.height*(s-1),t.initialClipRect.height-=this.maxLegendLabelSize.height*(s-1),this.legendRectScale.y=this.legendGroup.y+this.legendRectPadding,this.legendGroup.height=parseInt(this.legendHeight,10)+this.maxLegendLabelSize.height*(s-1))}},n.prototype.renderColorAxisGrid=function(n){var r,u,f,e,o,t=this.heatMap,i,s,h;for(t.enableCanvasRendering||(r=this.heatMap.renderer.createGroup({id:t.element.id+"_ColorAxis_Grid"})),i=0;i<(t.isColorRange?this.segmentCollections.length:t.legendColorCollection.length);i++)t.horizontalGradient?(u=e=this.segmentCollections[i],f=n.y,o=n.y+n.height):(u=n.x,f=o=this.segmentCollections[i],e=n.x+n.width),s=new ui(u,f,e,o),h=new fi(this.heatMap.element.id+"_ColorAxis_Grid"+i,s,"#EEEEEE",1),this.drawSvgCanvas.drawLine(h,r),t.enableCanvasRendering||this.legend.appendChild(r)},n.prototype.renderLegendTitleTooltip=function(n,t,i){if(-1!==n.target.id.indexOf("_legendTitle")&&n.target.textContent.indexOf("...")>-1)lt(this.heatMap.legendSettings.title.text,t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_legendTitle_Tooltip",et(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip").style.visibility="visible";else{var r=document.getElementById(this.heatMap.element.id+"_legendTitle_Tooltip");r&&(r.style.visibility="hidden")}},n.prototype.renderLegendLabelTooltip=function(n,t,i){var r,u,f;-1!==n.target.id.indexOf("_Legend_Label")&&n.target.textContent.indexOf("...")>-1?(r=n.target.id.split(this.heatMap.element.id+"_Legend_Label"),2===r.length&&(u=void 0,u=1===r[1].length||"Trim"===this.heatMap.legendSettings.textStyle.textOverflow?parseInt(r[1],10):parseInt(r[1].substring(0,r[1].length-1),10),lt(this.labelCollections[u],t,i,this.heatMap.element.offsetWidth,this.heatMap.element.id+"_LegendLabel_Tooltip",et(this.heatMap.element.id+"_Secondary_Element"),null,this.heatMap),document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip").style.visibility="visible")):(f=document.getElementById(this.heatMap.element.id+"_LegendLabel_Tooltip"),f&&(f.style.visibility="hidden"))},n.prototype.calculateListPerPage=function(n){var r=this.heatMap,c;if(r.horizontalGradient){this.lastList=[];var i=n.x,u=n.y,h=0,e=0,o=0,s=0,t=void 0;for(this.labelXCollections=[],this.labelYCollections=[],this.legendXCollections=[],this.legendYCollections=[],t=0;t<r.colorCollection.length;t++)r.legendSettings.showLabel&&(h=f(this.labelCollections[t],r.legendSettings.textStyle).width),o=i+10+5,s=u+5,c=r.legendSettings.showLabel?o+h:i+this.legendSize+this.listInterval,0!==t&&c>this.legendGroup.width+this.legendGroup.x-this.listInterval&&(e+=1,o=(i=n.x)+10+5,s=(u=n.y+20*e)+5,e%this.listPerPage==0&&(this.lastList.push(t),s=(u=n.y)+5,e=0)),this.labelXCollections.push(o),this.labelYCollections.push(s),this.legendXCollections.push(i),this.legendYCollections.push(u),i=i+this.legendSize+this.labelPadding+h+this.listInterval;this.lastList.push(t);this.numberOfPages=this.lastList.length}},n.prototype.renderListLegendMode=function(n,t){var ut,i=this.heatMap,at={color:"transparent",width:0},ft,u,w,it,et,rt,b,ot,g,st,ht,nt,lt;this.legendLabelTooltip=[];var tt,v,o=new h(0,0),y=0,p=0,s=n.x,a=n.y;for(t&&this.renderPagingElements(),ft=i.legendSettings.title.text?this.width-2*(this.legendSize+this.labelPadding):this.legendGroup.width-(this.legendSize+this.legendRectPadding+this.labelPadding),i.horizontalGradient?(tt=1===this.currentPage?0:this.lastList[this.currentPage-2],v=this.lastList[this.currentPage-1]):v=(v=(tt=this.currentPage*this.listPerPage-this.listPerPage)+this.listPerPage)<i.colorCollection.length?v:i.colorCollection.length,u=tt;u<v;u++)i.legendSettings.showLabel&&(o=f(b=this.labelCollections[u],i.legendSettings.textStyle)),w={cancel:!1,text:this.labelCollection[u],name:"legendRender"},(i.horizontalGradient&&(s=this.legendXCollections[u],a=this.legendYCollections[u],y=this.labelXCollections[u],p=this.labelYCollections[u]),y=s+this.legendSize+this.labelPadding,p=a+5,this.heatMap.trigger("legendRender",w),t&&i.rendering&&this.legendRange.length<=i.colorCollection.length)&&(it=new vt(s,a,10,10,i.colorCollection[u].value,!0,this.currentPage),(it.visible=!!Object(r.isNullOrUndefined)(this.visibilityCollections[u])||this.visibilityCollections[u],w.cancel)?(et=new vt(s,a,0,0,i.colorCollection[u].value,!0,this.currentPage),this.legendRange.push(et)):this.legendRange.push(it),i.legendSettings.showLabel&&(rt=new vt(y,p-o.height/2,o.width,o.height,i.colorCollection[u].value,!0,this.currentPage),rt.visible=!!Object(r.isNullOrUndefined)(this.visibilityCollections[u])||this.visibilityCollections[u],this.legendTextRange.push(rt))),w.cancel||(i.legendSettings.showLabel&&(-1!==(b=ct(this.labelCollections[u],i.legendSettings.textStyle,ft))[0].indexOf("...")&&i.enableCanvasRendering&&this.legendLabelTooltip.push(new d(this.labelCollections[u],new e(y,p,o.width,o.height))),ot=new l(y,p,"start",b,0,"translate(0,0)","middle"),g=new c(i.element.id+"_Legend_Label"+u,ot,i.legendSettings.textStyle,i.legendSettings.textStyle.color||i.themeStyle.legendLabel),g.fill=i.legendOnLoad||this.legendRange[u].visible?g.fill:"#D3D3D3",this.drawSvgCanvas.createText(g,this.translategroup,b[0]),r.Browser.isIE&&!i.enableCanvasRendering&&this.translategroup.lastChild.setAttribute("dy","0.6ex")),ut=new e(s,a,10,10),st=i.legendOnLoad||this.legendRange[u].visible?this.heatMap.isColorRange?i.colorCollection[u].minColor:i.colorCollection[u].color:"#D3D3D3",ht=new k(i.element.id+"_legend_list"+u,st,at,1,ut),this.drawSvgCanvas.drawRectangle(ht,this.translategroup),i.horizontalGradient?s=s+this.legendSize+this.labelPadding+o.width+this.listInterval:a+=this.legendSize+this.listInterval);i.enableCanvasRendering||(this.legendGroup.height=this.legendGroup.height>0?this.legendGroup.height:0,this.legendGroup.width=this.legendGroup.width>0?this.legendGroup.width:0,nt=i.renderer.createClipPath({id:i.element.id+"_LegendScale_ClipPath"}),lt=i.renderer.drawRectangle(this.legendGroup),nt.appendChild(lt),this.translategroup.appendChild(nt),this.legend.setAttribute("style","clip-path:url(#"+nt.id+")"),this.legendScale.appendChild(this.translategroup),i.svgObject.appendChild(this.legend))},n.prototype.translatePage=function(n,t,i){if(i&&t>=1&&t<this.numberOfPages||!i&&t>1&&t<=this.numberOfPages){if(i?(this.currentPage+=1,this.legendRect.y+=this.legendRect.height):(this.currentPage-=1,this.legendRect.y-=this.legendRect.height),n.enableCanvasRendering)(f=n.canvasRenderer.ctx).fillRect(this.legendRectScale.x-5,this.legendRectScale.y-5,this.legendRectScale.width+5,this.legendRectScale.height+10),f.fillRect(this.pagingRect.x,this.pagingRect.y,this.pagingRect.width,this.pagingRect.height);else for(this.paginggroup.removeChild(this.paginggroup.firstChild);this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);this.renderListLegendMode(this.legendRectScale,!0)}if(n.enableCanvasRendering&&n.allowSelection&&n.rectSelected){var f=n.secondaryCanvasRenderer.ctx,u=n.legendSettings.position,r=n.initialClipRect,e="Right"===u?r.x+r.width:0,o="Bottom"===u?r.y+r.height:0,s="Right"===u?n.availableSize.width-(r.x+r.width):"Left"===u?r.x:n.availableSize.width,h="Top"===u?r.y:"Bottom"===u?n.availableSize.height-(r.y+r.height):n.availableSize.height;f.save();f.clearRect(e,o,s,h);f.restore();var c=document.getElementById(n.element.id+"_canvas"),l=document.getElementById(n.element.id+"_secondary_canvas"),a=c.getContext("2d").getImageData(e,o,s,h);l.getContext("2d").putImageData(a,e,o);c.style.opacity="0.3"}},n.prototype.createTooltipDiv=function(){var n=Object(r.createElement)("div",{id:this.heatMap.element.id+"legendLabelTooltipContainer",styles:"position:absolute"});this.heatMap.element.appendChild(n)},n.prototype.renderTooltip=function(n){var i,t=this.heatMap,r=[n.label];i=parseInt(t.legendSettings.textStyle.size,10)/2;this.tooltipObject=new rt.Tooltip({offset:i,theme:t.theme,content:r,location:{x:n.x+n.width/2,y:n.y+n.height/2},inverted:!t.horizontalGradient,areaBounds:{height:this.legendGroup.height+this.legendGroup.y,width:this.legendGroup.width+this.legendGroup.x,x:"Right"===t.legendSettings.position?0:this.legendGroup.x,y:"Top"===t.legendSettings.position?""===t.titleSettings.text?this.legendGroup.height-this.legendGroup.y:this.legendGroup.y:0}},"#"+this.heatMap.element.id+"legendLabelTooltipContainer");this.tooltipObject.element.style.visibility="visible"},n.prototype.createTooltip=function(n,t){for(var f,i,u,r=0;r<this.heatMap.colorCollection.length;r++)if(i=this.legendRectPositionCollection[r],i&&n>i.x&&n<i.width+i.x&&t>i.y&&t<i.height+i.y){f=this.legendRectPositionCollection[r];break}u=document.getElementById(this.heatMap.element.id+"legendLabelTooltipContainer");u&&"visible"===u.style.visibility&&this.tooltipObject&&!this.heatMap.isTouch&&(this.tooltipObject.fadeOut(),u.style.visibility="hidden");f&&this.renderTooltip(f)},n.prototype.legendRangeSelection=function(n){var t=this.heatMap,r=this.legendRange,s=t.horizontalGradient?10:0,i=this.legendRectScale,u=t.canvasRenderer.ctx,f,o;if(t.rangeSelection=!0,t.enableCanvasRendering)f=t.canvasRenderer.ctx,t.legendSettings.enableSmartLegend?f.fillRect(i.x-5,i.y-5,i.width+this.labelPadding+this.maxLegendLabelSize.width+5,i.height+2*(5+s)):f.fillRect(i.x-5,i.y-5,i.width+5,i.height+10);else{if(t.legendSettings.enableSmartLegend)for(;this.legend&&this.legend.childNodes.length;)this.legend.removeChild(this.legend.firstChild);else for(;this.translategroup&&this.translategroup.childNodes.length;)this.translategroup.removeChild(this.translategroup.firstChild);a(t.heatMapSeries.containerRectObject.id);t.cellSettings.showLabel&&a(t.heatMapSeries.containerTextObject.id)}(t.legendSettings.enableSmartLegend&&t.colorCollection.length!==t.legendColorCollection.length&&(n===t.legendColorCollection.length-1?t.toggleValue[n-1].visible=this.visibilityCollections[n-1]=r[n-1].visible=!r[n].visible:n===t.colorCollection.length-1&&(t.toggleValue[n+1].visible=this.visibilityCollections[n+1]=r[n+1].visible=!r[n].visible)),t.toggleValue[n].visible=this.visibilityCollections[n]=r[n].visible=!r[n].visible,t.legendOnLoad=!1,t.legendSettings.enableSmartLegend)?(this.renderSmartLegend(),o=new e(i.x,i.y,i.width,i.height),this.renderLegendLabel(o),t.enableCanvasRendering&&(u.save(),u.clip()),"SVG"===t.renderingMode&&this.renderTitle(o)):this.renderListLegendMode(this.legendRectScale,!1);t.enableCanvasRendering&&u.restore();t.heatMapSeries.renderRectSeries();t.clearSelection();t.enableCanvasRendering&&t.allowSelection},n.prototype.updateLegendRangeCollections=function(){var n=this.heatMap;n.rangeSelection=!n.legendOnLoad;this.visibilityCollections=n.legendOnLoad?[]:this.visibilityCollections;n.toggleValue=n.legendOnLoad?[]:n.toggleValue;this.legendRange=n.legendOnLoad?[]:this.legendRange;this.legendTextRange=n.legendOnLoad?[]:this.legendTextRange},n}(),yu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),ot=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},pu=function(n){function t(){return null!==n&&n.apply(this,arguments)||this}return yu(t,n),ot([Object(r.Property)(!1)],t.prototype,"isJsonData",void 0),ot([Object(r.Property)("None")],t.prototype,"adaptorType",void 0),ot([Object(r.Property)("")],t.prototype,"xDataMapping",void 0),ot([Object(r.Property)("")],t.prototype,"yDataMapping",void 0),ot([Object(r.Property)("")],t.prototype,"valueMapping",void 0),ot([Object(r.Complex)({},tr)],t.prototype,"bubbleDataMapping",void 0),t}(r.ChildProperty),pi=function(){return function(){}}(),wu=function(){function n(n){this.reconstructedXAxis=[];this.reconstructedYAxis=[];this.adaptiveXMinMax=new pi;this.adaptiveYMinMax=new pi;this.heatMap=n}return n.prototype.constructDatasource=function(n,t){if("Cell"===t.adaptorType){var i=this.heatMap.xAxis,u=this.heatMap.yAxis;this.adaptiveXMinMax.min=i.minimum;this.adaptiveXMinMax.max=i.maximum;this.adaptiveYMinMax.min=u.minimum;this.adaptiveYMinMax.max=u.maximum;("Numeric"!==i.valueType&&"DateTime"!==i.valueType||!Object(r.isNullOrUndefined)(i.minimum)&&!Object(r.isNullOrUndefined)(i.maximum))&&("Numeric"!==u.valueType&&"DateTime"!==u.valueType||!Object(r.isNullOrUndefined)(u.minimum)&&!Object(r.isNullOrUndefined)(u.maximum))||this.getMinMaxValue(n,t,i,u);this.heatMap.isCellData=!0}"None"===t.adaptorType?this.heatMap.completeAdaptDataSource=n:t.isJsonData||"Table"!==t.adaptorType?t.isJsonData&&"Table"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonTableData(n,t):t.isJsonData&&"Cell"===t.adaptorType?this.heatMap.completeAdaptDataSource=this.processJsonCellData(n,t):t.isJsonData||"Cell"!==t.adaptorType||(this.constructAdaptiveAxis(),this.heatMap.completeAdaptDataSource=this.processCellData(n),this.heatMap.isCellData=!0):this.heatMap.completeAdaptDataSource=n},n.prototype.constructAdaptiveAxis=function(){var n=this.heatMap.xAxis,t=this.heatMap.yAxis;"Numeric"===n.valueType&&(this.reconstructedXAxis=this.getNumericAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,n.increment));"Numeric"===t.valueType&&(this.reconstructedYAxis=this.getNumericAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.increment));"DateTime"===n.valueType&&(this.reconstructedXAxis=this.getDateAxisCollection(this.adaptiveXMinMax.min,this.adaptiveXMinMax.max,n.intervalType,n.increment));"DateTime"===t.valueType&&(this.reconstructedYAxis=this.getDateAxisCollection(this.adaptiveYMinMax.min,this.adaptiveYMinMax.max,t.intervalType,t.increment))},n.prototype.getNumericAxisCollection=function(n,t,i){for(var r=n,u=[];r<=t;)u.push(r.toString()),r+=i;return u},n.prototype.getDateAxisCollection=function(n,t,i,r){for(var f={skeleton:"full",type:"dateTime"},o=this.heatMap.intl.getDateParser(f),s=this.heatMap.intl.getDateFormat(f),u=n=Date.parse(o(s(new Date(pt.DataUtil.parse.parseJson({val:n}).val)))),e=[];u<=t;)e.push(new Date(u).toString()),u=at(u,1,i,r).getTime();return e},n.prototype.getMinMaxValue=function(n,t,i,u){var f=n,o=Object.keys(f[0]),e,s,h;for(f.length>0&&(this.adaptiveXMinMax.min=Object(r.isNullOrUndefined)(i.minimum)?t.isJsonData?f[0][o[0]]:f[0][0]:i.minimum,this.adaptiveYMinMax.min=Object(r.isNullOrUndefined)(u.minimum)?t.isJsonData?f[0][o[1]]:f[0][1]:u.minimum,this.adaptiveXMinMax.max=Object(r.isNullOrUndefined)(i.maximum)?t.isJsonData?f[0][o[0]]:f[0][0]:i.maximum,this.adaptiveYMinMax.max=Object(r.isNullOrUndefined)(u.maximum)?t.isJsonData?f[0][o[1]]:f[0][1]:u.maximum),e=0;e<f.length;e++)s=t.isJsonData?f[e][o[0]]:f[e][0],h=t.isJsonData?f[e][o[1]]:f[e][1],s<this.adaptiveXMinMax.min&&Object(r.isNullOrUndefined)(i.minimum)&&(this.adaptiveXMinMax.min=s),s>this.adaptiveXMinMax.max&&Object(r.isNullOrUndefined)(i.maximum)&&(this.adaptiveXMinMax.max=s),h<this.adaptiveYMinMax.min&&Object(r.isNullOrUndefined)(u.minimum)&&(this.adaptiveYMinMax.min=h),h>this.adaptiveYMinMax.max&&Object(r.isNullOrUndefined)(u.maximum)&&(this.adaptiveYMinMax.max=h)},n.prototype.processCellData=function(n){var t=n,e=this.reconstructedXAxis,o=this.reconstructedYAxis,u=0,f=0,i;if(this.reconstructData=[],t&&t.length)for(i=0;i<t.length;i++)if((u="Category"===this.heatMap.xAxis.valueType?t[i][0]:e.indexOf(t[i][0].toString()))>-1){for(;!this.reconstructData[u];)this.reconstructData.push([]);if(-1!==(f="Category"===this.heatMap.yAxis.valueType?t[i][1]:o.indexOf(t[i][1].toString()))){for(;""!==this.reconstructData[u][f];)this.reconstructData[u].push("");this.reconstructData[u][f]=Object(r.isNullOrUndefined)(t[i][2])?"":t[i][2]}}return this.reconstructData},n.prototype.processJsonCellData=function(n,t){var u=n,s=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],h=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],e=this.heatMap.axisCollections,i;0!==s.length&&0!==h.length||this.generateAxisLabels(n,t);var c="Category"===this.heatMap.xAxis.valueType?s.length>0?this.heatMap.xAxis.labels:e[0].jsonCellLabel:e[0].labelValue,l="Category"===this.heatMap.yAxis.valueType?h.length>0?this.heatMap.yAxis.labels:e[1].jsonCellLabel:e[1].labelValue,f=0,o=0;if(u.length)for(this.reconstructData=[],i=0;i<u.length;i++)if(-1!==(f=this.getSplitDataValue(u[i],t,c,t.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[f];)this.reconstructData.push([]);if(-1!==(o=this.getSplitDataValue(u[i],t,l,t.yDataMapping.split("."),this.heatMap.yAxis.valueType))){for(;Object(r.isNullOrUndefined)(this.reconstructData[f][o]);)this.reconstructData[f].push("");this.reconstructData[f][o]=this.heatMap.bubbleSizeWithColor?[this.getSplitDataValue(u[i],t,null,t.bubbleDataMapping.size.split("."),""),this.getSplitDataValue(u[i],t,null,t.bubbleDataMapping.color.split("."),"")]:this.getSplitDataValue(u[i],t,null,t.valueMapping.split("."),"")}}return this.reconstructData},n.prototype.generateAxisLabels=function(n,t){for(var h,i,r,l,o=n,a=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],v=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],y=a.length>0,p=v.length>0,s=this.heatMap.axisCollections,u=0;u<s.length;u++)if(h=s[u].valueType,i=s[u],"Category"===h){var c=void 0,f=void 0,e=void 0;if("Horizontal"===i.orientation?(c=y,f=t.xDataMapping,i.jsonCellLabel=e=[]):(c=p,f=t.yDataMapping,i.jsonCellLabel=e=[]),!c)for(r=0;r<o.length;r++)f in o[r]&&(l=o[r][f].toString(),-1===e.indexOf(l.toString())&&e.push(l))}else"DateTime"===h?(i.clearAxisLabel(),i.calculateDateTimeAxisLabel(this.heatMap)):(i.clearAxisLabel(),i.calculateNumericAxisLabels(this.heatMap))},n.prototype.getSplitDataValue=function(n,t,i,u,f){var o=-1,e;for(this.tempSplitDataCollection=n,e=0;e<u.length&&(o=Object(r.isNullOrUndefined)(i)?null:"DateTime"!==f?i.indexOf(this.tempSplitDataCollection[u[e]]):i.map(Number).indexOf(+this.tempSplitDataCollection[u[e]]),Object(r.isNullOrUndefined)(this.tempSplitDataCollection)||(this.tempSplitDataCollection=-1===o||Object(r.isNullOrUndefined)(i)?this.tempSplitDataCollection[u[e]]:this.tempSplitDataCollection),!Object(r.isNullOrUndefined)(this.tempSplitDataCollection));e++);return Object(r.isNullOrUndefined)(i)?Object(r.isNullOrUndefined)(this.tempSplitDataCollection)||""===this.tempSplitDataCollection.toString()?"":parseFloat(this.tempSplitDataCollection.toString()):o},n.prototype.processJsonTableData=function(n,t){var u,o=n,i=0,s=0,h=this.heatMap.xAxis.labels?this.heatMap.xAxis.labels:[],c=this.heatMap.yAxis.labels?this.heatMap.yAxis.labels:[],f,e;if(o.length)for(this.reconstructData=[],f=0;f<o.length;f++)if(-1!==(i=this.getSplitDataValue(o[f],t,h,t.xDataMapping.split("."),this.heatMap.xAxis.valueType))){for(;!this.reconstructData[i];)this.reconstructData.push([]);for(e=0;e<Object.keys(this.tempSplitDataCollection).length;e++)if(-1!==(s=(u=Object.keys(this.tempSplitDataCollection)[e])!==t.xDataMapping?c.indexOf(u):-1)){for(;Object(r.isNullOrUndefined)(this.reconstructData[i][s]);)this.reconstructData[i].push("");this.reconstructData[i][s]=Object(r.isNullOrUndefined)(this.tempSplitDataCollection[u])?"":this.tempSplitDataCollection[u]}}return this.reconstructData},n.prototype.destroy=function(){},n.prototype.getModuleName=function(){return"Adaptor"},n}(),gt=i(3),wi=function(){function n(n){this.control=n}return n.prototype.export=function(n,t,i){var y,p=this,f=this.getControlsValue(),c=f.width,l=f.height,u=this.control.svgObject,v=this.control.enableCanvasRendering,e,w,o,b,s,h,k;v||(u=Object(r.createElement)("canvas",{id:"ej2-canvas",attrs:{width:c.toString(),height:l.toString()}}));e=!(r.Browser.userAgent.toString().indexOf("HeadlessChrome")>-1);i=Object(r.isNullOrUndefined)(i)?gt.PdfPageOrientation.Landscape:i;w='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">'+f.svg.outerHTML+"<\/svg>";o=window.URL.createObjectURL(new Blob("SVG"===n?[w]:[(new XMLSerializer).serializeToString(f.svg)],{type:"image/svg+xml"}));"SVG"===n?"msie"===r.Browser.info.name?(b=new Blob([(new XMLSerializer).serializeToString(f.svg)],{type:"application/octet-stream"}),window.navigator.msSaveOrOpenBlob(b,t+"."+n.toLocaleLowerCase())):this.triggerDownload(t,n,o,e):"msie"===r.Browser.info.name?(s=u,v||(s=this.createCanvas()),y=s.toDataURL(n),"PDF"===n?this.exportPdf(s,i,c,l,e,t):this.doExport(n,y,t)):(h=new Image,k=u.getContext("2d"),h.onload=function(){k.drawImage(h,0,0);window.URL.revokeObjectURL(o);"PDF"===n?p.exportPdf(u,i,c,l,e,t):window.navigator.msSaveOrOpenBlob?window.navigator.msSaveOrOpenBlob(u.msToBlob(),t+"."+n.toLocaleLowerCase()):p.triggerDownload(t,n,u.toDataURL("image/png").replace("image/png","image/octet-stream"),e)},h.src=o);v||a(document.getElementById(this.control.element.id)+"_canvas")},n.prototype.triggerDownload=function(n,t,i,u){Object(r.createElement)("a",{attrs:{download:n+"."+t.toLocaleLowerCase(),href:i}}).dispatchEvent(new MouseEvent(u?"click":"move",{view:window,bubbles:!1,cancelable:!0}))},n.prototype.getControlsValue=function(){var n=0,t=0,r=this.control.enableCanvasRendering,i=new rt.SvgRenderer("").createSvg({id:"Svg_Export_Element",width:200,height:200}),f=this.control.svgObject.cloneNode(!0),u=this.control.renderer.createGroup({style:"transform: translateY("+t+"px)"});return r||u.appendChild(f),n=Math.max(this.control.availableSize.width,n),t+=this.control.availableSize.height,r||i.appendChild(u),r||(i.setAttribute("width",n+""),i.setAttribute("height",t+"")),{width:n,height:t,svg:i}},n.prototype.createCanvas=function(){var n=this.control,i=n.renderingMode,t;return n.renderingMode="Canvas",n.refresh(),t=n.svgObject,n.renderingMode=i,n.refresh(),t},n.prototype.exportPdf=function(n,t,i,r,u,f){var e=new gt.PdfDocument,o=e.pageSettings.margins,h=e.pageSettings.width,c=e.pageSettings.height,s=n.toDataURL("image/jpeg").replace("image/jpeg","image/octet-stream"),l,a;e.pageSettings.orientation=t;l=h<i?i+o.left+o.right:h;a=c<r?r+o.top+o.bottom:c;e.pageSettings.size=new gt.SizeF(l,a);s=s.slice(s.indexOf(",")+1);e.pages.add().graphics.drawImage(new gt.PdfBitmap(s),0,0,i,r);u&&(e.save(f+".pdf"),e.destroy())},n.prototype.doExport=function(n,t,i){var r,u=n||"JPG";r=[t];this.exportImage(r,i,u,t)},n.prototype.exportImage=function(n,t,i){for(var f,c,e=[],l=n instanceof HTMLElement?0:n.length,o=0;o<l;o++){for(var a=n[o].replace(/^data:[a-z]*;,/,"").split(","),s=atob(a[1]),h=new ArrayBuffer(s.length),v=new Uint8Array(h),u=0;u<s.length;u++)v[u]=s.charCodeAt(u);e.push(h)}for(f=0;f<e.length;f++)c=new Blob([e[f]],{type:"application/octet-stream"}),"msie"===r.Browser.info.name&&window.navigator.msSaveOrOpenBlob(c,t+"."+i.toLocaleLowerCase())},n.prototype.print=function(){if(this.printWindow=window.open("","print","height="+window.outerHeight+",width="+window.outerWidth+",tabbar=no"),this.printWindow.moveTo(0,0),this.printWindow.resizeTo(screen.availWidth,screen.availHeight),"SVG"===this.control.renderingMode)Object(r.print)(this.getHTMLContent(),this.printWindow);else{var t=this.control.svgObject,i=t.toDataURL(),n=new Image,u=t.getContext("2d");n.onload=function(){u.drawImage(n,0,0)};n.src=i;Object(r.print)(n,this.printWindow)}},n.prototype.getHTMLContent=function(){var n=Object(r.createElement)("div");return n.appendChild(this.control.element.cloneNode(!0)),n},n}(),bu=function(){var n=function(t,i){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,t){n.__proto__=t}||function(n,t){for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i])})(t,i)};return function(t,i){function r(){this.constructor=t}n(t,i);t.prototype=null===i?Object.create(i):(r.prototype=i.prototype,new r)}}(),o=function(n,t,i,r){var f,e=arguments.length,u=e<3?t:null===r?r=Object.getOwnPropertyDescriptor(t,i):r,o;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)u=Reflect.decorate(n,t,i,r);else for(o=n.length-1;o>=0;o--)(f=n[o])&&(u=(e<3?f(u):e>3?f(t,i,u):f(t,i))||u);return e>3&&u&&Object.defineProperty(t,i,u),u},bi=function(n){function t(){var t=null!==n&&n.apply(this,arguments)||this;return t.enableCanvasRendering=!1,t.isColorRange=!1,t.isCellTapHold=!1,t.selectedCellCount=0,t.toggleValue=[],t.legendOnLoad=!0,t.resizing=!1,t.rendering=!0,t.multiSelection=!1,t.rectSelected=!1,t.previousSelectedCellsRect=[],t.multiCellCollection=[],t.selectedMultiCellCollection=[],t.tempMultiCellCollection=[],t.tooltipCollection=[],t.isCellData=!1,t}return bu(t,n),t.prototype.preRender=function(){this.initPrivateVariable();this.unWireEvents();this.wireEvents()},t.prototype.export=function(n,t,i){new wi(this).export(n,t,i)},t.prototype.initPrivateVariable=function(){this.renderer=new rt.SvgRenderer(this.element.id);this.canvasRenderer=new rt.CanvasRenderer(this.element.id);this.secondaryCanvasRenderer=new rt.CanvasRenderer(this.element.id+"_secondary");this.heatMapAxis=new ru(this);this.heatMapSeries=new eu(this);this.drawSvgCanvas=new ht(this);this.twoDimensional=new cu(this);this.cellColor=new ci(this);this.tempRectHoverClass="";this.tempTooltipRectId="";this.setCulture()},t.prototype.setCulture=function(){this.intl=new r.Internationalization},t.prototype.render=function(){if(this.horizontalGradient="Bottom"===this.legendSettings.position||"Top"===this.legendSettings.position,this.updateBubbleHelperProperty(),this.trigger("load",{heatmap:this}),"TailwindDark"===this.theme||"Tailwind"===this.theme){var n={title:{textStyle:{size:"12px",fontFamily:"Inter",fontWeight:"500"}},textStyle:{size:"12px",fontFamily:"Inter"}};this.setProperties({titleSettings:{textStyle:{size:"14px",fontFamily:"Inter"}}},!0);this.setProperties({legendSettings:n},!0);this.setProperties({xAxis:n},!0);this.setProperties({yAxis:n},!0);this.setProperties({cellSettings:{textStyle:{fontFamily:"Inter"}}},!0)}("Bootstrap5"===this.theme||"Bootstrap5Dark"===this.theme)&&(n={title:{textStyle:{size:"12px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"',fontWeight:"500"}},textStyle:{size:"12px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}},this.setProperties({titleSettings:{textStyle:{size:"16px",fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}}},!0),this.setProperties({legendSettings:n},!0),this.setProperties({xAxis:n},!0),this.setProperties({yAxis:n},!0),this.setProperties({cellSettings:{textStyle:{fontFamily:'system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial, "Noto Sans", "Liberation Sans", sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol", "Noto Color Emoji"'}}},!0));this.initAxis();this.processInitData();this.setTheme();this.calculateMaxLength();this.heatMapAxis.calculateVisibleLabels();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.createSvg();this.cellColor.getColorCollection();this.calculateBounds();this.renderElements();this.appendSvgObject();this.tooltipModule&&this.tooltipModule.showHideTooltip(!1);this.renderComplete()},t.prototype.reRenderDatasource=function(){this.dataSourceMinValue=null;this.dataSourceMaxValue=null;this.processInitData();this.calculateMaxLength();this.heatMapAxis.calculateVisibleLabels();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.cellColor.getColorCollection();this.calculateBounds()},t.prototype.processInitData=function(){this.adaptorModule?this.adaptorModule.constructDatasource(this.dataSource,this.dataSourceSettings):this.completeAdaptDataSource=this.dataSource},t.prototype.setRenderMode=function(){this.enableCanvasRendering="Canvas"===this.renderingMode||"Auto"===this.renderingMode&&this.axisCollections[0].axisLabelSize*this.axisCollections[1].axisLabelSize>=1e4?!0:!1},t.prototype.updateBubbleHelperProperty=function(){"Bubble"!==this.cellSettings.tileType||"Size"!==this.cellSettings.bubbleType&&"Sector"!==this.cellSettings.bubbleType?this.legendModule&&this.legendSettings.visible&&(this.legendVisibilityByCellType=!0):this.legendVisibilityByCellType=!1;this.bubbleSizeWithColor="Bubble"===this.cellSettings.tileType&&"SizeAndColor"===this.cellSettings.bubbleType?!0:!1},t.prototype.renderElements=function(){this.tooltipCollection=[];this.renderSecondaryElement();this.renderBorder();this.renderTitle();this.heatMapAxis.renderAxes();this.tooltipModule&&this.showTooltip&&(this.tooltipModule.tooltipObject=null,this.tooltipModule.createTooltipDiv(this));this.heatMapSeries.renderRectSeries();this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&(this.legendModule.renderLegendItems(),"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltipDiv())},t.prototype.getModuleName=function(){return"heatmap"},t.prototype.getPersistData=function(){return""},t.prototype.onPropertyChanged=function(n,t){for(var u=!1,i=!1,r=!0,f=0,e=Object.keys(n);f<e.length;f++)switch(e[f]){case"renderingMode":this.rendering=!1;r=!1;u=!0;break;case"cellSettings":this.updateBubbleHelperProperty();!this.legendModule||n.cellSettings.tileType===(void 0!==t.cellSettings&&t.cellSettings.tileType)&&n.cellSettings.bubbleType===t.cellSettings.bubbleType||(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections());"Bubble"===this.cellSettings.tileType&&(r=!1);this.reRenderDatasource();i=!0;break;case"showTooltip":i=!0;break;case"dataSource":case"dataSourceSettings":this.isCellData=!1;this.paletteCellSelectionUpdation();this.reRenderDatasource();r=!1;u=!0;break;case"titleSettings":case"width":case"height":case"margin":i=!0;break;case"legendSettings":this.updateBubbleHelperProperty();!this.legendVisibilityByCellType||n.legendSettings.visible===(void 0!==t.legendSettings&&t.legendSettings.visible)&&n.legendSettings.enableSmartLegend===t.legendSettings.enableSmartLegend?this.legendOnLoad=!1:(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections());i=!0;break;case"yAxis":case"xAxis":this.paletteCellSelectionUpdation();this.reRenderDatasource();r=!1;i=!0;break;case"paletteSettings":this.paletteCellSelectionUpdation();this.twoDimensional.processDataSource(this.completeAdaptDataSource);this.cellColor.getColorCollection();this.calculateBounds();u=!0;break;case"theme":this.setTheme();u=!0;break;case"tooltipSettings":this.tooltipModule&&(this.tooltipModule.tooltipObject.fill=this.tooltipSettings.fill,this.tooltipModule.tooltipObject.border=this.tooltipSettings.border,this.tooltipModule.tooltipObject.textStyle=this.tooltipSettings.textStyle,this.tooltipModule.tooltipObject.template=this.tooltipSettings.template,this.tooltipModule.tooltipObject.refresh())}!i&&u?(this.createSvg(),this.renderElements(),this.appendSvgObject(),this.trigger("created"),r||this.clearSelection()):i&&(this.createSvg(),this.refreshBound(),this.appendSvgObject(),this.trigger("created"));this.allowSelection&&this.rectSelected&&(r?this.updateCellSelection():this.clearSelection());this.rendering=!0},t.prototype.paletteCellSelectionUpdation=function(){this.updateBubbleHelperProperty();this.legendVisibilityByCellType&&(this.legendOnLoad=!0,this.legendModule.updateLegendRangeCollections())},t.prototype.createSvg=function(){this.removeSvg();this.setRenderMode();this.calculateSize();this.enableCanvasRendering?(this.svgObject=this.canvasRenderer.createCanvas({id:this.element.id+"_canvas",width:this.availableSize.width,height:this.availableSize.height}),this.allowSelection&&this.createMultiCellDiv(!0)):(this.svgObject=this.renderer.createSvg({id:this.element.id+"_svg",width:this.availableSize.width,height:this.availableSize.height}),"0"===this.cellSettings.border.width.toString()&&"Rect"===this.cellSettings.tileType&&this.svgObject.setAttribute("shape-rendering","crispEdges"))},t.prototype.removeSvg=function(){if((document.getElementById(this.element.id+"_Secondary_Element")&&Object(r.remove)(document.getElementById(this.element.id+"_Secondary_Element")),document.getElementById(this.element.id+"Celltooltipcontainer")&&Object(r.remove)(document.getElementById(this.element.id+"Celltooltipcontainer")),document.getElementById(this.element.id+"legendLabelTooltipContainer")&&Object(r.remove)(document.getElementById(this.element.id+"legendLabelTooltipContainer")),document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")&&Object(r.remove)(document.getElementById(this.element.id+"_Multi_CellSelection_Canvas")),document.getElementById(this.element.id+"_CellSelection_Container")&&Object(r.remove)(document.getElementById(this.element.id+"_CellSelection_Container")),this.svgObject)&&document.getElementById(this.svgObject.id)){for(;this.svgObject.childNodes.length;)this.svgObject.removeChild(this.svgObject.firstChild);Object(r.remove)(this.svgObject)}},t.prototype.renderSecondaryElement=function(){var n=this.createElement("div"),t;n.id=this.element.id+"_Secondary_Element";this.element.appendChild(n);t=this.createElement("div",{id:this.element.id+"_CellSelection_Container",styles:"position:absolute; z-index: 2 ; top:"+this.initialClipRect.y+"px; left:"+this.initialClipRect.x+"px"});this.element.appendChild(t)},t.prototype.requiredModules=function(){var n=[];return this.showTooltip&&n.push({member:"Tooltip",args:[this]}),this.legendSettings&&n.push({member:"Legend",args:[this]}),this.dataSource&&n.push({member:"Adaptor",args:[this]}),n},t.prototype.destroy=function(){this.unWireEvents();n.prototype.destroy.call(this);this.element.innerHTML="";this.element.classList.remove("e-heatmap")},t.prototype.refresh=function(){n.prototype.refresh.call(this);this.element.classList.add("e-heatmap")},t.prototype.appendSvgObject=function(){this.enableCanvasRendering&&this.allowSelection?this.createMultiCellDiv(!1):this.element.appendChild(this.svgObject)},t.prototype.renderBorder=function(){this.border={width:0};var n=new k(this.element.id+"_HeatmapBorder",this.themeStyle.background,this.border,1,new e(0,0,this.availableSize.width-0,this.availableSize.height-0));this.drawSvgCanvas.drawRectangle(n,this.svgObject)},t.prototype.calculateSize=function(){var i=b(this.width,this.element.offsetWidth)||this.element.offsetWidth||600,r=b(this.height,this.element.offsetHeight)||this.element.offsetHeight||450,n,t;for(this.availableSize=new h(i,r),n=this.element;n.parentNode&&"BODY"!==n.tagName;){if("center"===n.align){t=this.availableSize.width.toString();this.element.style.width=t+"px";this.element.style.margin="0 auto";break}n=n.parentElement}},t.prototype.renderTitle=function(){var n,i,t;this.titleSettings.text&&(n=this.titleSettings.textStyle,i="Near"===n.textAlignment?"start":"Far"===n.textAlignment?"end":"middle",this.elementSize=f(this.titleCollection[0],n),t=new c(this.element.id+"_HeatmapTitle",new l(ai(this.availableSize.width-this.margin.left-this.margin.right,this.margin.left,this.margin.right,n),this.margin.top+3*this.elementSize.height/4,i,this.titleCollection),n,n.color||this.themeStyle.heatMapTitle),this.titleCollection.length>1?this.drawSvgCanvas.createWrapText(t,n,this.svgObject):(this.drawSvgCanvas.createText(t,this.svgObject,this.titleCollection[0]),-1!==this.titleCollection[0].indexOf("...")&&this.enableCanvasRendering&&this.tooltipCollection.push(new d(this.titleSettings.text,new e(this.margin.left,this.margin.top,this.elementSize.width,this.elementSize.height)))))},t.prototype.titleTooltip=function(n,t,i,r){n.target.id===this.element.id+"_HeatmapTitle"&&n.target.textContent.indexOf("...")>-1?lt(this.titleSettings.text,t,i,this.element.offsetWidth,this.element.id+"_Title_Tooltip",et(this.element.id+"_Secondary_Element"),r,this):a(this.element.id+"_Title_Tooltip")},t.prototype.axisTooltip=function(n,t,i){var r=n.target.id,u;-1!==r.indexOf(this.element.id+"_XAxis_Label")||-1!==r.indexOf(this.element.id+"_YAxis_Label")||-1!==r.indexOf(this.element.id+"_XAxis_MultiLevel")||-1!==r.indexOf(this.element.id+"_YAxis_MultiLevel")?(u=kt(this.tooltipCollection,t,i),u?lt(u,t,i,this.element.offsetWidth,this.element.id+"_axis_Tooltip",et(this.element.id+"_Secondary_Element"),this.isTouch,this):a(this.element.id+"_axis_Tooltip")):a(this.element.id+"_axis_Tooltip")},t.prototype.isHeatmapRect=function(n,t){var r,u=[],i=[];if(u.push(this.heatMapSeries.rectPositionCollection[0][0]),i.push(this.heatMapSeries.rectPositionCollection[this.yLength-1][this.xLength-1]),this.cellSettings.border.width>5&&n>=u[0].x&&t>=u[0].y&&n<=i[0].x+i[0].width&&t<=i[0].y+i[0].height&&"Rect"===this.cellSettings.tileType){var f=this.heatMapSeries.getCurrentRect(n,t),o=i[0].height,s=i[0].width,e=this.cellSettings.border.width/2;n>=f.x+e&&t>=f.y+e&&n<=f.x+(s-e)&&t<=f.y+(o-e)?(r=!0,this.isRectBoundary=!0):(r=!1,this.isRectBoundary=!1)}else r=n>=u[0].x&&t>=u[0].y&&n<=i[0].x+i[0].width&&t<=i[0].y+i[0].height,this.isRectBoundary=r;return r},t.prototype.setTheme=function(){this.themeStyle=function(n){var t;switch(n.toLowerCase()){case"highcontrastlight":case"highcontrast":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#ffffff",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"materialdark":case"fabricdark":case"bootstrapdark":t={heatMapTitle:"#ffffff",axisTitle:"#ffffff",axisLabel:"#DADADA",cellBorder:"#EEEEEE",background:"#000000",cellTextColor:"#000000",toggledColor:"#000000",emptyCellColor:"#EEEEEE",legendLabel:"#ffffff",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"bootstrap4":t={heatMapTitle:"#212529",axisTitle:"#212529",axisLabel:"#212529",cellBorder:"#E9ECEF",background:"#FFFFFF",cellTextColor:"#212529",toggledColor:"#ffffff",emptyCellColor:"#E9ECEF",legendLabel:"#212529",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]};break;case"tailwind":t={heatMapTitle:"#374151",axisTitle:"#374151",axisLabel:"#6B7280",cellBorder:"#E5E7EB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#374151",palette:[{color:"#5A61F6"},{color:"#65A30D"},{color:"#14B8A6"}]};break;case"tailwinddark":t={heatMapTitle:"#D1D5DB",axisTitle:"#D1D5DB",axisLabel:"#9CA3AF",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#374151",legendLabel:"#D1D5DB",palette:[{color:"#8B5CF6"},{color:"#22D3EE"},{color:"#F87171"}]};break;case"bootstrap5":t={heatMapTitle:"#343A40",axisTitle:"#343A40",axisLabel:"#495057",cellBorder:"#D1D5DB",background:"transparent",cellTextColor:"#111827",toggledColor:"transparent",emptyCellColor:"#E5E7EB",legendLabel:"#343A40",palette:[{color:"#668E1F"},{color:"#262E0B"},{color:"#AF6E10"}]};break;case"bootstrap5dark":t={heatMapTitle:"#E9ECEF",axisTitle:"#E9ECEF",axisLabel:"#CED4DA",cellBorder:"#4B5563",background:"transparent",cellTextColor:"#FFFFFF",toggledColor:"transparent",emptyCellColor:"#343A40",legendLabel:"#E9ECEF",palette:[{color:"#A860F1"},{color:"#5ECB9B"},{color:"#557EF7"}]};break;default:t={heatMapTitle:"#424242",axisTitle:"#424242",axisLabel:"#686868",cellBorder:"#EEEEEE",cellTextColor:"#000000",toggledColor:"#ffffff",background:"#FFFFFF",emptyCellColor:"#EEEEEE",legendLabel:"#353535",palette:[{color:"#BEE7EE"},{color:"#85c4cf"},{color:"#4CA1AF"}]}}return t}(this.theme)},t.prototype.calculateBounds=function(){var n=this.margin,i=0,c=this.legendModule&&"Top"===this.legendSettings.position&&this.legendVisibilityByCellType||"0px"===this.titleSettings.textStyle.size?0:16,u=n.left,o=this.availableSize.width-u-n.right,t,r,s,h;if(("Column"===this.paletteSettings.colorGradientMode||"Row"===this.paletteSettings.colorGradientMode)&&"Gradient"===this.paletteSettings.type)if(0===this.paletteSettings.palette.length)this.legendVisibilityByCellType=!1;else for(t=0;t<this.paletteSettings.palette.length;t++)if(null!==this.paletteSettings.palette[t].value)this.legendVisibilityByCellType=!0;else if(null===this.paletteSettings.palette[t].value){this.legendVisibilityByCellType=!1;break}this.titleSettings.text&&(this.titleCollection=ct(this.titleSettings.text,this.titleSettings.textStyle,o),i=f(this.titleSettings.text,this.titleSettings.textStyle).height*this.titleCollection.length+c);r=n.top+i;this.titleRect=new e(n.left,n.top,this.availableSize.width-n.left-n.right,i);s=this.availableSize.height-r-n.bottom;this.initialClipRect=new e(u,r,o,s);h=this.initialClipRect.y;this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendBounds(this.initialClipRect);this.heatMapAxis.measureAxis(this.initialClipRect);this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.calculateLegendSize(this.initialClipRect,h);this.heatMapAxis.calculateAxisSize(this.initialClipRect)},t.prototype.refreshBound=function(){this.updateBubbleHelperProperty();this.calculateBounds();this.renderElements()},t.prototype.initAxis=function(){var t,i=[this.xAxis,this.yAxis],n,r;for(this.axisCollections=[],n=0,r=i.length;n<r;n++)(t=i[n]).orientation=0===n?"Horizontal":"Vertical",t.jsonCellLabel=[],this.axisCollections.push(t)},t.prototype.wireEvents=function(){var i=r.Browser.isPointer,t=r.Browser.touchStartEvent,u=r.Browser.touchEndEvent,f=r.Browser.touchMoveEvent,e=i?"pointerleave":"mouseleave",n;r.EventHandler.add(this.element,r.Browser.isDevice?t:"click",this.heatMapMouseClick,this);r.EventHandler.add(this.element,t,this.heatMapMouseMove,this);r.EventHandler.add(this.element,u,this.heatMapMouseLeave,this);r.EventHandler.add(this.element,f,this.heatMapMouseMove,this);r.EventHandler.add(this.element,e,this.heatMapMouseLeave,this);window.addEventListener(r.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize.bind(this));n=this;new r.Touch(this.element,{tapHold:function(){n.isCellTapHold=!0;n.getDataCollection();n.currentRect.allowCollection=!1;n.setCellOpacity();var t={heatmap:n,cancel:!1,name:"cellSelected",data:n.multiCellCollection};n.trigger("cellSelected",t)},tap:function(){var t=!1;n.isCellTapHold||(t=!0);n.tooltipOnMouseMove(null,n.currentRect,t)}});this.setStyle(this.element)},t.prototype.setStyle=function(n){n.style.touchAction="element";n.style.touchAction="element";n.style.zoom="none";n.style.userSelect="none";n.style.webkitUserSelect="none";n.style.position="relative";n.style.display="block"},t.prototype.print=function(){new wi(this).print()},t.prototype.unWireEvents=function(){var i=r.Browser.isPointer,n=r.Browser.touchStartEvent,t=(r.Browser.touchEndEvent,r.Browser.touchMoveEvent),u=i?"pointerleave":"mouseleave";r.EventHandler.remove(this.element,r.Browser.isDevice?n:"click",this.heatMapMouseClick);r.EventHandler.remove(this.element,n,this.heatMapMouseMove);r.EventHandler.remove(this.element,t,this.heatMapMouseLeave);r.EventHandler.remove(this.element,t,this.heatMapMouseMove);r.EventHandler.remove(this.element,u,this.heatMapMouseLeave);window.removeEventListener(r.Browser.isTouch&&"orientation"in window&&"onorientationchange"in window?"orientationchange":"resize",this.heatMapResize)},t.prototype.heatMapResize=function(){var n=this,t;return this.resizing=!0,t={heatmap:this,cancel:!1,name:"resized",currentSize:new h(0,0),previousSize:new h(this.availableSize.width,this.availableSize.height)},this.resizeTimer&&clearTimeout(this.resizeTimer),this.resizeTimer=setTimeout(function(){n.isDestroyed?clearTimeout(n.resizeTimer):(n.createSvg(),t.currentSize=n.availableSize,n.trigger("resized",t),n.refreshBound(),n.appendSvgObject(),n.allowSelection&&n.updateCellSelection(),n.trigger("loaded",{heatmap:n}),n.resizing=!1)},500),!1},t.prototype.updateCellSelection=function(){var c=this.initialClipRect.width/this.axisCollections[0].axisLabelSize,l=this.initialClipRect.height/this.axisCollections[1].axisLabelSize,g=this.initialClipRect.x,nt=this.initialClipRect.y,y,p,w,b,k,n,d,e,h;if(this.enableCanvasRendering){if(this.enableCanvasRendering){var t=this.multiCellCollection,r=document.getElementById(this.element.id+"_canvas"),u=document.getElementById(this.element.id+"_secondary_canvas"),i=this.initialClipRect,v=i.y+i.height,o=i.x+i.width;for(n=0;n<this.multiCellCollection.length;n++)this.multiCellCollection[n].width=t[n].width=c,this.multiCellCollection[n].height=t[n].height=l,this.multiCellCollection[n].x=t[n].x=g+c*this.multiCellCollection[n].xPosition,this.multiCellCollection[n].y=t[n].y=nt+l*this.multiCellCollection[n].yPosition,y=r.getContext("2d").getImageData(t[n].x,t[n].y,t[n].width,t[n].height),u.getContext("2d").putImageData(y,t[n].x,t[n].y),r.style.opacity="0.3";p=r.getContext("2d").getImageData(0,0,this.availableSize.width,i.y);u.getContext("2d").putImageData(p,0,0);w=r.getContext("2d").getImageData(0,v,this.availableSize.width,this.availableSize.height-v);u.getContext("2d").putImageData(w,0,i.y+i.height);b=r.getContext("2d").getImageData(o,0,this.availableSize.width-o,this.availableSize.height);u.getContext("2d").putImageData(b,o,0);k=r.getContext("2d").getImageData(0,0,i.x,this.availableSize.height);u.getContext("2d").putImageData(k,0,0);a(this.element.id+"_selectedCells")}}else if(0!==this.multiCellCollection.length){for(var f=document.getElementById(this.element.id+"_Container_RectGroup"),s=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<f.childNodes.length;n++)f.childNodes[n].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&s.childNodes[n]&&s.childNodes[n].setAttribute("opacity","0.3");for(n=0;n<this.multiCellCollection.length;n++)d=this.multiCellCollection[n].cellElement.id.replace(this.element.id+"_HeatMapRect_",""),e=parseInt(d,10),(f.childNodes[e].setAttribute("opacity","1"),this.cellSettings.showLabel&&s.childNodes[n])&&(h=document.getElementById(this.element.id+"_HeatMapRectLabels_"+e),h&&h.setAttribute("opacity","1"),this.addSvgClass(f.childNodes[e]))}},t.prototype.clearSVGSelection=function(){for(var i,t=document.getElementById(this.element.id+"_Container_RectGroup"),r=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<t.childNodes.length;n++)i=t.childNodes[n].getAttribute("class"),i===this.element.id+"_selected"&&this.removeSvgClass(t.childNodes[n],i),t.childNodes[n].setAttribute("opacity","1"),this.cellSettings.showLabel&&r.childNodes[n]&&r.childNodes[n].setAttribute("opacity","1")},t.prototype.calculateMaxLength=function(){var n=this.completeAdaptDataSource,r;if(n&&n.length>0){for(var u=n.length-1,t=0,i=0;i<=u;i++)r=n[i].length,t=t>r?t:r;this.axisCollections[0].maxLength=u;this.axisCollections[1].maxLength=t-1}else this.axisCollections[0].maxLength=0,this.axisCollections[1].maxLength=0},t.prototype.setMouseXY=function(n,t){var r,i=this.element.getBoundingClientRect();r=this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").getBoundingClientRect():document.getElementById(this.element.id+"_svg").getBoundingClientRect();this.mouseX=n-i.left-Math.max(r.left-i.left,0);this.mouseY=t-i.top-Math.max(r.top-i.top,0)},t.prototype.heatMapMouseClick=function(n){var r,u,s,h=this.element.getBoundingClientRect(),o,i;if(("touchstart"===n.type?(this.isTouch=!0,u=(s=n).changedTouches[0].clientY,r=s.changedTouches[0].clientX):(this.isTouch=!1,u=n.clientY,r=n.clientX),r-=h.left,u-=h.top,this.isHeatmapRect(r,u))&&(o=this.heatMapSeries.getCurrentRect(r,u),this.trigger("cellClick",{heatmap:this,value:o.value,x:o.x,y:o.y,xLabel:this.heatMapSeries.hoverXAxisLabel,yLabel:this.heatMapSeries.hoverYAxisLabel,xValue:this.heatMapSeries.hoverXAxisValue,yValue:this.heatMapSeries.hoverYAxisValue,cellElement:this.enableCanvasRendering?null:document.getElementById(o.id),event:n})),this.notify("click",n),"Gradient"!==this.paletteSettings.type&&this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType){i=this.legendModule.navigationCollections;i.length&&r>i[0].x&&r<i[0].x+i[0].width&&u>i[0].y&&u<i[0].y+i[0].height?this.legendModule.translatePage(this,this.legendModule.currentPage,!0):i.length&&r>i[1].x&&r<i[1].x+i[1].width&&u>i[1].y&&u<i[1].y+i[1].height&&this.legendModule.translatePage(this,this.legendModule.currentPage,!1);for(var f=this.legendModule.legendRange,e=this.legendModule.legendTextRange,c=!0,t=0;t<f.length;t++)this.legendModule&&this.legendSettings.toggleVisibility&&this.legendModule.currentPage===f[t].currentPage&&(c&&r>=f[t].x&&r<=f[t].width+f[t].x&&u>=f[t].y&&u<=f[t].y+f[t].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&r>=e[t].x&&r<=e[t].width+e[t].x&&u>=e[t].y&&u<=e[t].y+e[t].height)&&(this.legendModule.legendRangeSelection(t),c=!1)}return!1},t.prototype.heatMapMouseMove=function(n){var t,i,r,u=this.element.getBoundingClientRect();return"touchmove"===n.type||"touchstart"===n.type?(this.isTouch=!0,t=(r=n).changedTouches[0].clientX,i=r.changedTouches[0].clientY):(this.isTouch=!1,t=n.clientX,i=n.clientY),t-=u.left,i-=u.top,this.setMouseXY(t,i),this.mouseAction(n,t,i,r,u),!0},t.prototype.mouseAction=function(n,t,i){var e,r,u,f,o;return n.target&&n.target.id&&(r=this.isHeatmapRect(t,i),this.legendModule&&(r?"Gradient"===this.paletteSettings.type&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderGradientPointer(n,t,i):this.legendModule.removeGradientPointer(),this.renderMousePointer(t,i)),u=void 0,f=void 0,(u=!(!this.showTooltip||!this.tooltipModule)&&r,r&&(f=this.heatMapSeries.getCurrentRect(t,i),2!==n.which&&3!==n.which&&(u=this.cellSelectionOnMouseMove(n,f,t,i,u))),this.tooltipOnMouseMove(n,f,u,r),this.legendModule&&this.legendSettings.visible&&"Fixed"===this.paletteSettings.type&&this.legendSettings.enableSmartLegend&&"None"===this.legendSettings.labelDisplayType&&this.legendModule.createTooltip(t,i),this.enableCanvasRendering)?(this.element.getBoundingClientRect(),o="Fixed"!==this.paletteSettings.type||!this.legendSettings.enableSmartLegend||"None"!==this.legendSettings.labelDisplayType,(e=kt(this.tooltipCollection,t,i)||this.legendModule&&o&&(kt(this.legendModule.legendLabelTooltip,t,i)||kt(this.legendModule.legendTitleTooltip,t,i)))?lt(e,t,i,this.element.offsetWidth,this.element.id+"_canvas_Tooltip",et(this.element.id+"_Secondary_Element"),this.isTouch,this):a(this.element.id+"_canvas_Tooltip")):(this.titleSettings.text&&"Trim"===this.titleSettings.textStyle.textOverflow&&this.titleTooltip(n,t,i,this.isTouch),this.axisTooltip(n,t,i,this.isTouch),this.legendModule&&this.legendSettings.visible&&this.legendSettings.showLabel&&this.legendVisibilityByCellType&&this.legendModule.renderLegendLabelTooltip(n,t,i),this.legendModule&&this.legendSettings.visible&&this.legendVisibilityByCellType&&this.legendModule.renderLegendTitleTooltip(n,t,i))),!0},t.prototype.cellSelectionOnMouseMove=function(n,t,i,r,u){return("Rect"===this.cellSettings.tileType&&"mousedown"===n.type||"touchstart"===n.type||"pointerdown"===n.type)&&this.allowSelection&&(this.previousRect=t,this.multiSelection=!0,this.rectSelected=!0,this.initialCellX=i,this.initialCellY=r,n.preventDefault()),"Rect"===this.cellSettings.tileType&&this.multiSelection&&t&&(u=!1,this.highlightSelectedCells(this.previousRect,t,i,r,n)),u},t.prototype.tooltipOnMouseMove=function(n,t,i,r){var u=this;i&&t?this.tempTooltipRectId!==t.id&&(this.showTooltip&&((this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(t.id),this.tooltipModule.renderTooltip(t),this.isTouch&&(this.tooltipTimer&&window.clearTimeout(this.tooltipTimer),this.tooltipTimer=setTimeout(function(){u.tooltipModule.tooltipObject.fadeOut();u.tooltipModule.isFadeout=!0},1500),n&&"touchmove"===n.type&&n.preventDefault())),this.tempTooltipRectId=t.id):(null!==n&&(r?!this.showTooltip&&this.cellSettings.border.width>5&&this.heatMapSeries.highlightSvgRect(n.target.id):((this.cellSettings.enableCellHighlighting||this.showTooltip)&&!this.enableCanvasRendering&&this.cellSettings.border.width<5&&this.heatMapSeries.highlightSvgRect(n.target.id),this.tooltipModule&&this.showTooltip&&this.tooltipModule.showHideTooltip(!1,!0))),this.tempTooltipRectId="")},t.prototype.highlightSelectedCells=function(n,t,i,r,u){var f=n.xIndex,o=n.yIndex,s=t.xIndex,h=t.yIndex;this.currentRect=t;this.selectedCellsRect=new e(0,0,0,0);this.selectedCellsRect.x=n.x>t.x?t.x:n.x;this.selectedCellsRect.y=n.y>t.y?t.y:n.y;this.selectedCellsRect.width=(1+(n.x>t.x?f-s:s-f))*t.width;this.selectedCellsRect.height=(1+(n.y>t.y?o-h:h-o))*t.height;this.isCellTapHold="touchstart"===u.type?!0:!1;u.preventDefault();!1===u.ctrlKey&&"touchstart"!==u.type&&"touchmove"!==u.type&&this.removeSelectedCellsBorder();var c=this.initialCellX>i?i:this.initialCellX,l=this.initialCellY>r?r:this.initialCellY,a=document.getElementById(this.element.id+"_CellSelection_Container"),v=this.renderer.createSvg({id:this.element.id+"_CellSelection_Container_svg",width:this.initialClipRect.width,height:this.initialClipRect.height});a.appendChild(v);var y=document.getElementById(this.element.id+"_CellSelection_Container_svg"),p=new e(c-this.initialClipRect.x,l-this.initialClipRect.y,Math.abs(i-this.initialCellX),Math.abs(r-this.initialCellY)),w=new k(this.element.id+"_selectedCells","#87ceeb",{color:"transparent",width:1},1,p,"#0000ff");y.appendChild(this.renderer.drawRectangle(w));document.getElementById(this.element.id+"_selectedCells").style.opacity="0.5"},t.prototype.getDataCollection=function(){var n=this.previousRect.xIndex,t=this.previousRect.yIndex,i=this.currentRect.xIndex,r=this.currentRect.yIndex,u=i>n?n:i,c=i>n?i:n,l=r>t?t:r,a=r>t?r:t,f=u,o=l,s=this.previousRect.x,h=this.previousRect.y;this.getCellCollection(this.currentRect,this.previousRect,!0,f,o,c,a,u,s,h);f=u;o=l;s=this.previousRect.x;h=this.previousRect.y;this.checkSelectedCells();this.getCellCollection(this.currentRect,this.previousRect,!1,f,o,c,a,u,s,h);this.selectedMultiCellCollection=[];this.canvasSelectedCells=new e(0,0,0,0);this.selectedCellCount=0},t.prototype.getCellCollection=function(n,t,i,r,u,f,e,o,s,h){for(var l=Math.abs(n.xIndex===t.xIndex?0:n.xIndex-t.xIndex)+1,a=Math.abs(n.yIndex===t.yIndex?0:n.yIndex-t.yIndex)+1,c=0;c<l*a;c++)i?this.getSelectedCellData(s,h,!0):this.getSelectedCellData(s,h,!1),r<f?(s+=n.xIndex>t.xIndex?n.width:-n.width,r++):u<e&&(h+=n.yIndex>t.yIndex?n.height:-n.height,s=t.x,r=o)},t.prototype.removeSelectedCellsBorder=function(){var t,i,r,e;if(this.enableCanvasRendering){for(t=this.secondaryCanvasRenderer.ctx,n=0;n<this.previousSelectedCellsRect.length;n++)i=this.previousSelectedCellsRect[n],t.save(),t.clearRect(i.x-1,i.y-1,i.width+2,i.height+2),t.restore();for(n=0;n<this.multiCellCollection.length;n++)r=this.multiCellCollection[n],this.multiCellCollection.length>0&&(t.save(),t.clearRect(r.x-1,r.y-1,r.width+2,r.height+2))}else for(var u=document.getElementById(this.element.id+"_Container_RectGroup"),f=document.getElementById(this.element.id+"_Container_TextGroup"),n=0;n<u.childNodes.length;n++)e=u.childNodes[n].getAttribute("class"),u.childNodes[n].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&f.childNodes[n]&&(f.childNodes[n].setAttribute("opacity","0.3"),this.removeSvgClass(u.childNodes[n],e));this.multiCellCollection=[]},t.prototype.highlightSelectedAreaInCanvas=function(n){var u,f,e,o;if(n.x){var i=document.getElementById(this.element.id+"_canvas"),r=document.getElementById(this.element.id+"_secondary_canvas"),t=this.initialClipRect,s=i.getContext("2d").getImageData(n.x,n.y,n.width,n.height);r.getContext("2d").putImageData(s,n.x,n.y);i.style.opacity="0.3";u=i.getContext("2d").getImageData(0,0,this.availableSize.width,t.y);r.getContext("2d").putImageData(u,0,0);f=i.getContext("2d").getImageData(0,t.y+t.height,this.availableSize.width,this.availableSize.height-(t.y+t.height));r.getContext("2d").putImageData(f,0,t.y+t.height);e=i.getContext("2d").getImageData(t.x+t.width,0,this.availableSize.width-(t.x+t.width),this.availableSize.height);r.getContext("2d").putImageData(e,t.x+t.width,0);o=i.getContext("2d").getImageData(0,0,t.x,this.availableSize.height);r.getContext("2d").putImageData(o,0,0)}},t.prototype.getSelectedCellData=function(n,t,i){var v=this.axisCollections[0],y=this.axisCollections[1],k=v.tooltipLabels,d=y.tooltipLabels.slice().reverse(),f=this.heatMapSeries.getCurrentRect(n+1,t+1),p=document.getElementById(f.id),u=new vr(null,"","",0,0,null,0,0,0,0,0,0),o,c,h,l,s,w,b,a;if(u.value=f.value,u.xLabel=k[f.xIndex].toString(),u.yLabel=d[f.yIndex].toString(),u.xValue=v.labelValue[f.xIndex],u.yValue=y.labelValue.slice().reverse()[f.yIndex],u.cellElement=this.enableCanvasRendering?null:p,u.xPosition=f.xIndex,u.yPosition=f.yIndex,u.width=this.currentRect.width,u.height=this.currentRect.height,u.x=this.currentRect.x,u.y=this.currentRect.y,this.currentRect.allowCollection=!0,this.addSvgClass(p),i)this.selectedMultiCellCollection.push(u),this.currentRect.allowCollection=!1;else for(o=0;o<this.multiCellCollection.length;o++)if(this.multiCellCollection[o].xPosition===u.xPosition&&this.multiCellCollection[o].yPosition===u.yPosition&&(this.currentRect.allowCollection=!1,this.selectedCellCount===this.selectedMultiCellCollection.length)){if(this.currentRect.allowCollection=!1,this.enableCanvasRendering)c=this.secondaryCanvasRenderer.ctx,h=this.canvasSelectedCells,c.save(),c.clearRect(h.x-1,h.y-1,h.width+2,h.height+2),c.restore(),this.selectedCellsRect=new e(0,0,0,0);else for(l=0;l<this.selectedMultiCellCollection.length;l++)s=this.selectedMultiCellCollection[l].cellElement,s&&(w=s.id.replace(this.element.id+"_HeatMapRect_",""),b=(document.getElementById(this.element.id+"_Container_TextGroup"),s.getAttribute("class")),s.setAttribute("opacity","0.3"),a=document.getElementById(this.element.id+"_HeatMapRectLabels_"+w),a&&a.setAttribute("opacity","0.3"),this.removeSvgClass(s,b));this.multiCellCollection.splice(o,1)}f.visible&&!Object(r.isNullOrUndefined)(f.value)&&!0===this.currentRect.allowCollection&&this.multiCellCollection.push(u)},t.prototype.addSvgClass=function(n){if(!this.enableCanvasRendering){var t=this.element.id+"_selected";n.setAttribute("class",t)}},t.prototype.removeSvgClass=function(n,t){t&&n.setAttribute("class",t.replace(t,""))},t.prototype.clearSelection=function(){var t,n,i;if(!this.enableCanvasRendering&&this.allowSelection&&this.clearSVGSelection(),this.enableCanvasRendering){for(t=this.secondaryCanvasRenderer.ctx,n=0;n<this.previousSelectedCellsRect.length;n++)t.save(),t.clearRect(this.previousSelectedCellsRect[n].x-1,this.previousSelectedCellsRect[n].y-1,this.previousSelectedCellsRect[n].width+2,this.previousSelectedCellsRect[n].height+2),t.restore();for(n=0;n<this.multiCellCollection.length;n++)i=this.multiCellCollection[n],this.multiCellCollection.length>0&&(t.save(),t.clearRect(i.x-1,i.y-1,i.width+2,i.height+2));document.getElementById(this.element.id+"_canvas").style.opacity="1"}this.tempMultiCellCollection=[];this.multiCellCollection=[];this.rectSelected=!1},t.prototype.renderMousePointer=function(n,t){for(var r=this.legendModule.legendRange,u=this.legendModule.legendTextRange,f=!0,i=0;i<r.length;i++)this.legendSettings.toggleVisibility&&this.legendModule.currentPage===r[i].currentPage&&(f&&n>=r[i].x&&n<=r[i].width+r[i].x&&t>=r[i].y&&t<=r[i].y+r[i].height||this.legendSettings.showLabel&&"None"!==this.legendSettings.labelDisplayType&&n>=u[i].x&&n<=u[i].width+u[i].x&&t>=u[i].y&&t<=u[i].y+u[i].height?(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="Pointer":document.getElementById(this.element.id+"_svg").style.cursor="Pointer",f=!1):f&&(this.enableCanvasRendering?document.getElementById(this.element.id+"_canvas").style.cursor="":document.getElementById(this.element.id+"_svg").style.cursor=""))},t.prototype.heatMapMouseLeave=function(n){var u=this,r,t,i;return(n.target&&n.target.id&&(this.cellSettings.enableCellHighlighting||this.tooltipModule&&this.showTooltip)&&!this.enableCanvasRendering&&this.heatMapSeries.highlightSvgRect(this.tempTooltipRectId),this.allowSelection&&this.multiSelection)&&((this.multiSelection=!1,"mouseup"===n.type||"touchend"===n.type||"pointerup"===n.type)?2!==n.which&&3!==n.which&&(!1===this.isCellTapHold?(this.getDataCollection(),this.currentRect.allowCollection=!1,this.setCellOpacity(),r={heatmap:this,cancel:!1,name:"cellSelected",data:this.multiCellCollection},this.trigger("cellSelected",r)):this.isCellTapHold=!1):"mouseleave"===n.type&&(this.element.id,1)&&a(this.element.id+"_selectedCells")),(this.tooltipModule&&this.showTooltip&&"mouseleave"===n.type&&this.tooltipModule.showHideTooltip(!1),this.tempTooltipRectId="",this.legendModule&&this.legendSettings.visible&&this.legendModule.tooltipObject&&this.legendModule.tooltipObject.element)&&(t=this.legendModule.tooltipObject.element.firstChild,"mouseleave"===n.type?t.setAttribute("opacity","0"):(this.legendTooltipTimer&&window.clearTimeout(this.legendTooltipTimer),this.legendTooltipTimer=setTimeout(function(){t.setAttribute("opacity","0")},1500))),("Gradient"===this.paletteSettings.type&&this.legendModule&&this.legendSettings.showGradientPointer&&this.legendSettings.visible&&this.legendVisibilityByCellType&&("mouseleave"===n.type?this.legendModule.removeGradientPointer():(this.gradientTimer&&window.clearTimeout(this.gradientTimer),this.gradientTimer=setTimeout(function(){u.legendModule.removeGradientPointer()},1500))),this.enableCanvasRendering)&&(i=document.getElementById(this.element.id+"_hoverRect_canvas"),i&&(i.style.visibility="hidden",this.tempRectHoverClass="")),this.titleSettings.text&&-1!==this.titleCollection[0].indexOf("...")&&(this.enableCanvasRendering?a(this.element.id+"_canvas_Tooltip"):a(this.element.id+"_Title_Tooltip")),!0},t.prototype.checkSelectedCells=function(){var n,t;if(this.enableCanvasRendering){for(this.canvasSelectedCells=new e(0,0,0,0),this.canvasSelectedCells.x=this.selectedCellsRect.x,this.canvasSelectedCells.y=this.selectedCellsRect.y,this.canvasSelectedCells.width=this.selectedCellsRect.width,this.canvasSelectedCells.height=this.selectedCellsRect.height,n=0;n<this.multiCellCollection.length;n++)for(t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].xPosition===this.multiCellCollection[n].xPosition&&this.selectedMultiCellCollection[t].yPosition===this.multiCellCollection[n].yPosition&&this.selectedCellCount++;this.rectSelected&&"Gradient"===this.paletteSettings.type&&this.legendModule.removeGradientPointer()}else for(n=0;n<this.multiCellCollection.length;n++)for(t=0;t<this.selectedMultiCellCollection.length;t++)this.selectedMultiCellCollection[t].cellElement.getAttribute("id")===this.multiCellCollection[n].cellElement.getAttribute("id")&&this.selectedCellCount++},t.prototype.removeOpacity=function(n,t){for(var i=0;i<n.childNodes.length;i++)n.childNodes[i].setAttribute("opacity","0.3"),this.cellSettings.showLabel&&t.childNodes[i]&&t.childNodes[i].setAttribute("opacity","0.3")},t.prototype.setCellOpacity=function(){var t,u,n,f,i,r;if(this.enableCanvasRendering)this.previousSelectedCellsRect.push(this.selectedCellsRect),this.highlightSelectedAreaInCanvas(this.selectedCellsRect);else if(0!==this.multiCellCollection.length)for(this.tempMultiCellCollection.push(this.multiCellCollection),t=document.getElementById(this.element.id+"_Container_RectGroup"),u=document.getElementById(this.element.id+"_Container_TextGroup"),this.removeOpacity(t,u),n=0;n<this.multiCellCollection.length;n++)f=this.multiCellCollection[n].cellElement,i=parseInt(f.id.replace(this.element.id+"_HeatMapRect_",""),10),(t.childNodes[i].setAttribute("opacity","1"),this.cellSettings.showLabel)&&(r=document.getElementById(this.element.id+"_HeatMapRectLabels_"+i),r&&r.setAttribute("opacity","1"));a(this.element.id+"_selectedCells")},t.prototype.createMultiCellDiv=function(n){var t,i,r;n?(t=this.createElement("div",{id:this.element.id+"_Multi_CellSelection_Canvas",styles:"position:relative"}),this.element.appendChild(t),t.appendChild(this.svgObject),this.svgObject.style.position="absolute",this.svgObject.style.left="0px",this.svgObject.style.top="0px",this.svgObject.style.zIndex="0"):(i=document.getElementById(this.element.id+"_Multi_CellSelection_Canvas"),r=this.secondaryCanvasRenderer.createCanvas({width:this.availableSize.width,height:this.availableSize.height,x:0,y:0,style:"position: absolute; z-index: 1"}),i.appendChild(r))},o([Object(r.Property)(null)],t.prototype,"width",void 0),o([Object(r.Property)(null)],t.prototype,"height",void 0),o([Object(r.Property)(!0)],t.prototype,"showTooltip",void 0),o([Object(r.Event)()],t.prototype,"tooltipRender",void 0),o([Object(r.Event)()],t.prototype,"resized",void 0),o([Object(r.Event)()],t.prototype,"loaded",void 0),o([Object(r.Event)()],t.prototype,"cellRender",void 0),o([Object(r.Event)()],t.prototype,"cellSelected",void 0),o([Object(r.Property)("SVG")],t.prototype,"renderingMode",void 0),o([Object(r.Property)(null)],t.prototype,"dataSource",void 0),o([Object(r.Complex)({},pu)],t.prototype,"dataSourceSettings",void 0),o([Object(r.Property)("Material")],t.prototype,"theme",void 0),o([Object(r.Property)(!1)],t.prototype,"allowSelection",void 0),o([Object(r.Complex)({},di)],t.prototype,"margin",void 0),o([Object(r.Complex)({text:"",textStyle:g.heatMapTitleFont},ii)],t.prototype,"titleSettings",void 0),o([Object(r.Complex)({},yi)],t.prototype,"xAxis",void 0),o([Object(r.Complex)({position:"Right"},au)],t.prototype,"legendSettings",void 0),o([Object(r.Complex)({},lr)],t.prototype,"paletteSettings",void 0),o([Object(r.Complex)({},su)],t.prototype,"tooltipSettings",void 0),o([Object(r.Complex)({},yi)],t.prototype,"yAxis",void 0),o([Object(r.Complex)({},fu)],t.prototype,"cellSettings",void 0),o([Object(r.Event)()],t.prototype,"created",void 0),o([Object(r.Event)()],t.prototype,"load",void 0),o([Object(r.Event)()],t.prototype,"cellClick",void 0),o([Object(r.Event)()],t.prototype,"legendRender",void 0),t=o([r.NotifyPropertyChanges],t)}(r.Component);bi.Inject(hu,vu,wu);ni={};ni.HeatMap=bi;ki={heatmap:ni=Object(si.copy)(window.ejs?window.ejs.heatmap:{},ni)};window.ejs=Object(si.copy)(window.ejs||{},ki);window.ejdashboard=window.ejs}]);
