/*!
*  filename: ej1.card.all.min.js
*  version : 8.1.14
*  Copyright Syncfusion Inc. 2001 - 2024. All rights reserved.
*  Use of this code is subject to the terms of our license.
*  A copy of the current license can be obtained at any time by e-mailing
*  licensing@syncfusion.com. Any infringement will be prosecuted under
*  applicable laws. 
*/
var NumberFormatting=function(){function n(){}return n.prototype.isIntegerValue=function(n){return typeof n=="number"&&isFinite(n)&&Math.floor(n)===n},n.prototype.applyFormat=function(n,t){var f="",u,r;switch(t.format){case Format.Percentage:f="P"+t.numberOfDecimals;break;case Format.Number:f="N"+t.numberOfDecimals;break;case Format.Currency:f="C"+t.numberOfDecimals}if(u=BoldBIDashboard.findCulture(t.currencyCulture).numberFormat.currency.symbol,n=this.applyStringFormatting(f,t.currencyCulture,t.representation,n,t.negativeValueFormat,t.enableLakhsAndCroreRep),t.format!==Format.Percentage){var o=n.indexOf(u),e=n.indexOf("-"),i=n.replace(u,""),s=n.startsWith("-"),h=n.endsWith("-");i=i.replace("-","");r=i.split(t.decimalSeparator.CurrentValue);r[0]=r[0].replaceAll(t.groupSeparator.CurrentValue,t.groupSeparator.AliasValue);i=r.length>1?r[0]+t.decimalSeparator.AliasValue+r[1]:r[0];n=o==-1?i:BoldBIDashboard.findCulture(t.currencyCulture).isRTL==!0?i+u:o>1?i+u:u+i;e!=-1&&(negativeValues=n.slice(0,e),n=s?"-"+n:h?n+"-":negativeValues+"-"+n.slice(e))}return t.prefix+n+t.suffix},n.prototype.applyNegativeFormatting=function(n,t,i,r){var f=Math.abs(n.toString()),u=BoldBIDashboard.globalize.format(f,"N"+t,i);switch(r){case NegativeValueFormat.Default:return"-"+u;case NegativeValueFormat.NoNegativeSignWithBracket:return"("+u+")";case NegativeValueFormat.NegativeSignInSuffix:return u+"-"}return"-"+u},n.prototype.applyStringFormatting=function(n,t,i,r,u,f){if(!BoldBIDashboard.isNullOrUndefined(r)){BoldBIDashboard.preferredCulture(t);var e=i===Representation.Auto?this.truncateNumber(r,t,f):this.applyNumberUnit(i,r,t);return this.adjustZeros(e,i,n,t,u)}},n.prototype.adjustZeros=function(n,t,i,r,u){BoldBIDashboard.preferredCulture(r);var e=i,o=0,c=-1,l=0,f=parseInt(i.replace(/^\D+/g,"")),s=n.fraction===parseInt(n.fraction)||n.fraction%f===o,h=r;return t===Representation.Auto?(this.representSymbol=n.symbol,n.fraction===o?(n={fraction:0,symbol:""},e=i.replace(f,"0")):s&&(e=i.replace(f,"0")),i.indexOf("N")>c&&n.fraction<l)?this.applyNegativeFormatting(n.fraction,s?o:f,h,u)+n.symbol:BoldBIDashboard.globalize.format(n.fraction,e,h)+n.symbol:(n.fraction===o&&(n={fraction:o,postFixLabel:""},e=i.replace(f,"0")),s&&(e=i.replace(f,"0")),i.indexOf("N")>c&&n.fraction<l)?this.applyNegativeFormatting(n.fraction,s?o:f,h,u)+n.postFixLabel:BoldBIDashboard.globalize.format(n.fraction,e,h)+n.postFixLabel},n.prototype.truncateNumber=function(n,t,i){var u=10,h=Math.pow(u,3),c=Math.pow(u,5),f=Math.pow(u,6),e=Math.pow(u,7),o=Math.pow(u,9),s=Math.pow(u,12),r=n;if(r>=h&&r<f||r<=-h&&r>-f)return{fraction:this.calculateFraction(r,h),symbol:"K"};if(this.isRequiredCulture(t)&&i){if(r>=c&&r<e||r<=-c&&r>-e)return{fraction:this.calculateFraction(r,c),symbol:"L"};if(r>=e||r<=-e)return{fraction:this.calculateFraction(r,e),symbol:"Cr"}}else{if(r>=f&&r<o||r<=-f&&r>-o)return{fraction:this.calculateFraction(r,f),symbol:"M"};if(r>=o&&r<s||r<=-o&&r>-s)return{fraction:this.calculateFraction(r,o),symbol:"B"};if(r>=s||r<=-s)return{fraction:this.calculateFraction(r,s),symbol:"T"}}return{fraction:r,symbol:""}},n.prototype.isRequiredCulture=function(n){return["en-IN","as-IN","bn-BD","bn-IN","gu-IN","hi-IN","kn-IN","kok-IN","ml-IN","mr-IN","ne-NP","or-IN","pa-IN","pa-Arab-PK","sa-IN","sd-Arab-PK","ta-IN","ur-PK"].filter(function(t){return t===n}).length>0},n.prototype.calculateFraction=function(n,t){return n/t},n.prototype.applyNumberUnit=function(n,t){var i=10,r=Math.pow(i,3),u=Math.pow(i,5),f=Math.pow(i,6),e=Math.pow(i,7),o=Math.pow(i,9);switch(n){case Representation.Ones:return{fraction:t/1,postFixLabel:""};case Representation.Thousands:return{fraction:t/r,postFixLabel:"K"};case Representation.Lakhs:return{fraction:t/u,postFixLabel:"L"};case Representation.Millions:return{fraction:t/f,postFixLabel:"M"};case Representation.Crores:return{fraction:t/e,postFixLabel:"Cr"};case Representation.Billions:return{fraction:t/o,postFixLabel:"B"};default:return{fraction:t,postFixLabel:""}}},n}(),__extends,BoldBIDashboardSparkline;Representation={Auto:"Auto",Ones:"Ones",Thousands:"Thousands",Lakhs:"Lakhs",Millions:"Millions",Crores:"Crores",Billions:"Billions"};Format={Number:"Number",Currency:"Currency",Percentage:"Percentage"};NegativeValueFormat={Default:"default",NoNegativeSignWithBracket:"nonegativesignwithbracket",NegativeSignInSuffix:"negativesigninsuffix"},function(n,t){t.widget("BoldBIDashboardCard","BoldBIDashboard.Card",{_rootCSS:"e-Card",element:null,model:null,defaults:{targetValue:{name:"",value:"",fontSize:"",color:"",customText:""},actualValue:{name:"",value:"",fontSize:"",color:"",position:"",customText:""},additionalValue:{name:"",value:"",fontSize:"",color:"",position:"",customText:""},headers:{headerFontSize:"",visible:!0,headerPosition:""},higherValueGood:!0,secondaryValueType:"variance",cssClass:"",showTooltip:!0,showIndicatorOnly:!1,showActualValue:!0,secondaryValuePosition:"",primaryValuePosition:"",customVisibility:{actualValue:!0,primaryValue:!0,secondaryValue:!0,indicator:!0,additionalElement:!0,sparkline:!0,compactView:!0},customHeader:{text:"",value:"",color:"",visible:!1,size:""},subTitle:{visible:!1,color:"",text:"",size:"",position:""},size:{width:300,height:100},valueRepresentation:{format:"number",variationType:"absolute",abbreviationType:"auto",numberOfDecimals:6,currencyCulture:"en-US",negativeValueFormat:"default",prefix:"",suffix:""},additionalValueRepresentation:{format:"number",variationType:"absolute",abbreviationType:"auto",decimalSeparator:null,groupSeparator:null,numberOfDecimals:6,currencyCulture:"en-US",negativeValueFormat:"default",prefix:"",suffix:""},uniformFontSize:!1,culture:"en-US",background:{type:"none",imageSrc:"",opacity:"",color:""},enableResize:!1,enableAnination:!1,selected:null,create:null,enableRightClick:!1,rightClick:null,icon:{path:"",type:"",color:""},primaryValue:{color:""}},dataTypes:{targetValue:"data",actualValue:"data"},_init:function(){this._initPrivateVarialbles();this._draw();this._wireEvents()},_initPrivateVarialbles:function(){this._tooltipTarget=null;this._tooltipTimer=null;this.browserType=t.Card.BrowserType.Chrome;this._proxy=this.element.attr("id");this._parentWidth=n(this.element).parent().width();this._parentHeight=n(this.element).parent().height();this.warning=!1;this._width=Number(this.model.size.width||this.element.width());this._height=Number(this.model.size.height||this.element.height());this._varianceColor="";this.actualExponent=!1;this.additionalExponent=!1;this.targetExponent=!1;this.variantExponent=!1;this.representSymbol="";this._isCompact=!1},_setModel:function(n){for(var t in n)if(n.hasOwnProperty(t))switch(t){case"selected":this.model.selected=n[t];break;case"background":this.model.background=n[t];break;case"rightClick":this.model.rightClick=n[t]}},setHigherValueGood:function(n){this.model.higherValueGood=n},_wireEvents:function(){this._on(this.element,"click",this._selectedHandler);t.isMobile()||(this._on(this.element,"mousemove",".e-hoverable",this._showToolTip),this._on(this.element,"mouseleave",".e-hoverable",this._hideToolTip));this.model.enableResize&&this._on(n(window),"resize",this._cardResize);this._on(this.element,"contextmenu",this._rightClickHandler);this._on(this.element,"dblclick",this._doubleClickHandler)},_unWireEvents:function(){this._off(this.element,"click",this._selectedHandler);t.isMobile()||(this._off(this.element,"mousemove",".e-hoverable",this._showToolTip),this._off(this.element,"mouseleave",".e-hoverable",this._hideToolTip));this._off(n(window),"resize",this._cardResize);this._off(this.element,"contextmenu",this._rightClickHandler);this._off(this.element,"dblclick",this._doubleClickHandler)},_destroy:function(){this.element.empty().removeClass("e-Card"+this.model.cssClass)},redraw:function(){this._unWireEvents();this.element.html("");this._init()},_draw:function(){this.element.addClass("e-js");(this.model.targetValue!==null,this.model.actualValue!==null)&&(this._render(),this.model.uniformFontSize||this._calculateFontSizes(),this.model.IsCustomRange||this.element.find(".e-variationkpi").css({height:this.element.find(".e-variationkpi").parent()+"px"}))},_isNullOrEmptyOrUndefined:function(n){return n===null||n===""||typeof n=="undefined"},_createTitleContainer:function(){var f=0,n=this.element.find(".e-title").addClass("e-hoverable"),u,i,r;return this.model.headers.visible?(this._isNullOrEmptyOrUndefined(this.model.headers.headerPosition)||n.css({display:"flex","justify-content":this._getTitleAlignmentValue(this.model.headers.headerPosition.toLowerCase())}),this.model.customHeader.visible?(n.html(this.model.customHeader.text).css({"font-size":this.model.customHeader.size===f?25:this.model.customHeader.size,color:this._isNullOrEmptyOrUndefined(this.model.customHeader.color)?"":this.model.customHeader.color}),n.attr({"data-value":this.model.customHeader.value}),this.model.customHeader.size===f&&n.removeClass("e-hoverable")):(u=!1,i="",this._isNullOrEmptyOrUndefined(this.model.actualValue.name)||(i+=this.model.actualValue.name,u=!0),this._isNullOrEmptyOrUndefined(this.model.targetValue.name)||(u&&(i+=" vs "),i+=this.model.targetValue.name),n.html(i).css({color:this.model.customHeader&&!this._isNullOrEmptyOrUndefined(this.model.customHeader.color)?this.model.customHeader.color:""})),this.model.subTitle.visible?(r=this.element.find(".e-subtitle").html(this.model.subTitle.text).css({height:this.model.showIndicatorOnly?"8%":"12%",color:this.model.subTitle.color}),n.css({height:"18%"}),this._isNullOrEmptyOrUndefined(this.model.headers.headerPosition)||r.css({display:"flex","justify-content":this._getTitleAlignmentValue(this.model.headers.headerPosition.toLowerCase())}),this.element.parent().height()<120?(r.css({"font-size":"50%"}),n.css({"font-size":"70%"})):r.css({"font-size":"80%",height:"12%"})):this.model.uniformFontSize?n.css({"font-size":this._isCompact?"85%":"95%"}):n.css({height:"22%"}),this.model.background.type===t.Card.BackgroundType.Full):n.css({height:0}),n},_createExponentValues:function(n,i,r){var e=null,o=null,u=null,c=-1,l=0,h=1,a=2,f=r?this.model.additionalValueRepresentation:this.model.valueRepresentation,w,s,v,y,p,b;return u=i?this._getFormattedValue(n,!0,!1).value:this._getFormattedValue(n,!1,!1),f.format==="currency"?(w=t.preferredCulture(f.currencyCulture),s=w.numberFormat.currency.symbol,e=u.charAt(l),e==="-"&&(e=u.charAt(h)),o=u[u.length-h],o==="-"&&(o=u[u.length-a]),v=s[s.length-h],y=s.charAt(l),f.abbreviationType==="auto"&&this.representSymbol!==""?e==="("?(n=n.toString(),n.indexOf("-")!==c&&(n=n.replace("-","")),e=u.charAt(h),o=u[u.length-3],e===y&&(n="("+s+n+")"+this.representSymbol),o===v&&(n="("+n+s+")"+this.representSymbol)):(o=f.abbreviationType==="ones"?u[u.length-h]:u[u.length-a],e===y&&(n=s+n+this.representSymbol),o===v&&(n=n+s+this.representSymbol)):e==="("?(n=n.toString(),n.indexOf("-")!==c&&(n=n.replace("-","")),e=u.charAt(h),o=u[u.length-a],e===y&&(n="("+s+n+")"),o===v&&(n="("+n+s+")")):(o=f.abbreviationType==="ones"?u[u.length-h]:u[u.length-a],e===y&&(n=s+n),o===v&&(n+=s))):f.format==="number"?(u=u.replace(f.prefix,""),u=u.replace(f.suffix,""),e=u.charAt(l),o=u[u.length-h],n=n.toString(),n.indexOf("-")!==c&&(n=n.replace("-","")),f.abbreviationType==="auto"&&this.representSymbol!==""?(u=u.replace(this.representSymbol,""),e=u.charAt(l),o=u[u.length-h],n=n.toString(),n.indexOf("-")!==c&&(n=n.replace("-","")),n=e==="-"?f.prefix+"-"+n+this.representSymbol+f.suffix:e==="("?f.prefix+"("+n+")"+this.representSymbol+f.suffix:o==="-"?f.prefix+n+"-"+this.representSymbol+f.suffix:f.prefix+n+this.representSymbol+f.suffix):(e=u.charAt(l),o=f.abbreviationType==="ones"?u[u.length-h]:u[u.length-a],n=n.toString(),n.indexOf("-")!==c&&(n=n.replace("-","")),n=e==="-"?f.prefix+"-"+n+f.suffix:e==="("?f.prefix+"("+n+")"+f.suffix:o==="-"?f.prefix+n+"-"+f.suffix:f.prefix+n+f.suffix)):(p=u[u.length-h],n=n.indexOf(p)===c?n+p:n),(n.indexOf("e")!=-1||n.indexOf("E")!=-1)&&(b=parseFloat(this.model.valueRepresentation.numberOfDecimals),n=parseFloat(n.toString()).toPrecision(b+1)),n},_createActualValueContainer:function(){var r=null,f=null,n=this.element.find("#"+this._proxy+"_ActValue").addClass("e-hoverable").attr({"data-tooltip":"Value: "}),i,e,u;return n.css({width:"auto","max-width":"100%"}),this.model.customVisibility.actualValue?(this.model.valueRepresentation.variationType!==t.Card.VariationTypes.ActualValue?this._isNullOrEmptyOrUndefined(this.model.actualValue.color)||n.css({color:this.model.actualValue.color}):this.model.hasTarget||n.css({color:this.model.actualValue.color}),this._isNullOrEmptyOrUndefined(this.model.actualValue.position)&&this._isNullOrEmptyOrUndefined(this.model.targetValue.position)||this._isCompact||(i=this.element.find(".e-value").parent(),i.parent().css({"justify-content":this.model.actualValue.position=="left"?"flex-start":this.model.actualValue.position=="center"?"center":this._isCompact?"flex-start":"flex-end"}),t.isNullOrUndefined(this.model.actualValue.customText)||this.model.actualValue.customText===""||(i.parent().css({"justify-content":this.model.actualValue.position=="left"?"flex-start":this.model.actualValue.position=="center"?"flex-start":this._isCompact?"flex-start":"space-between"}),this.model.actualValue.position=="center"&&i.css({width:"60%","justify-content":"center"}))),this._isNullOrEmptyOrUndefined(this.model.actualValue.value)?this._isNullOrEmptyOrUndefined(this.model.targetValue.value)||(f=this.targetExponent?this._createExponentValues(this.model.targetValue.value,!1,!1):this._getFormattedValue(this.model.targetValue.value,!1,!1),n.html(f)):(this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue&&this.model.hasTarget?(e=(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)).toString(),u="",u=this._getFormattedValue(e,!0,!1),r=u.variance):r=this.actualExponent?this._createExponentValues(this.model.actualValue.value,!1,!1):this._getFormattedValue(this.model.actualValue.value,!1,!1),n.html(r)),this._isNullOrEmptyOrUndefined(this.model.targetValue.value)||this._isNullOrEmptyOrUndefined(this.model.actualValue.value),this.model.background.type===t.Card.BackgroundType.Full&&n.css({color:"white"}),t.isNullOrUndefined(this.model.actualValue.customText)||this.model.actualValue.customText===""||this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue||this.element.find(".e-customtext-value").html(this.model.actualValue.customText).css({"min-width":"10%"})):n.css({height:0}),{actualValueDiv:n,customText:null}},_createVariationContainer:function(){var o=this.element.find(".e-variation"),i=null,a=null,s=null,v=-1,f,e,r,u,h,y,c,l,p,w;return this._isNullOrEmptyOrUndefined(this.model.cardDefaultData)||(a=this._getFormattedValue(this.model.cardDefaultData.toString(),!0,!1).value,this.model.cardDefaultData=parseFloat(a.replace(",","").replace(" ","").replace(/[^\d.-]/g,""))),this._isNullOrEmptyOrUndefined(this.model.actualValue.value)||this._isNullOrEmptyOrUndefined(this.model.targetValue.value)?!this._isNullOrEmptyOrUndefined(this.model.actualValue.value)&&this._isNullOrEmptyOrUndefined(this.model.targetValue.value)?this.Value=this._getFormattedValue(this.model.actualValue.value,!0,!1).value:this._isNullOrEmptyOrUndefined(this.model.actualValue.value)&&!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&(this.Value=this._getFormattedValue(this.model.targetValue.value,!0,!1).value):this.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?(h=this._isNullOrEmptyOrUndefined(this.model.actualValue.value)?Math.abs(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)):parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value),this.Value=this._getVarianceValue(h)):this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?this.Value=this._getFormattedValue(this.model.actualValue.value,!0,!1).value:(c=this._getFormattedValue(this._isNullOrEmptyOrUndefined(this.model.actualValue.value)?parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value):parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value),!0,!1),this.Value=c.variance),this.model.showIndicatorOnly&&this.model.hasTarget?(i=this.element.find(".e-variationkpi"),i.addClass("e-hoverable"),this.model.headers.visible||o.css({height:"99%"}),!this._isNullOrEmptyOrUndefined(this.model.rangeSettings)&&(this.model.rangeSettings.Type=="Absolute"||this.model.rangeSettings.Type=="Percent")&&this.model.rangeSettings.Ranges.length>0&&this.model.IsCustomRange&&this.model.IsApplied?this._createRangeKpiIndicator(i):this._isNullOrEmptyOrUndefined(this.model.icon)||this._isNullOrEmptyOrUndefined(this.model.icon.path)?this._createKpiIndicator(i):this._customIndicatorForCard(i),this.model.customVisibility.primaryValue?this._createPrimaryValueForIndicator(i):i.parents(".e-variation").css({"justify-content":"center"})):this._isNullOrEmptyOrUndefined(this.model.actualValue.value)||this._isNullOrEmptyOrUndefined(this.model.targetValue.value)||(o.addClass("e-hoverable"),f=this.element.find(".e-primary-value"),i=this.element.find(".e-variationkpi"),t.preferredCulture(this.model.valueRepresentation.currencyCulture),e=parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value),r=e.toString(),this.variantExponent=r.indexOf("e")!==v||r.indexOf("E")!==v,l=e===0?"#FBCB43":e>0?this.warning?"#FBCB43":this.model.higherValueGood?"#34B67A":"#E57368":this.warning?"#FBCB43":this.model.higherValueGood?"#E57368":"#34B67A",this.model.customVisibility.secondaryValue&&(s=this.variantExponent?this._createExponentValues(r,!0,!1):this._getFormattedValue(r,!0,!1).value,s=this.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute&&this.model.secondaryValueType===t.Card.SecondaryValueType.Variance?this._getFormattedValue(r,!0,!1).variance:this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue&&this.model.secondaryValueType===t.Card.SecondaryValueType.Variance?this._getFormattedValue(r,!0,!1).value:this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue&&this.model.secondaryValueType===t.Card.SecondaryValueType.Target?this._getFormattedValue(this.model.targetValue.value,!0,!1):this._getVarianceValue(r),u=this.element.find(".e-secondary-value").html(s).attr({"data-tooltip":"Variance: "}),u.css({width:"auto","max-width":"100%"}),u.parent().parent().css({"justify-content":this.model.secondaryValuePosition=="left"?"flex-start":this.model.secondaryValuePosition=="center"?"center":"flex-end"}),t.isNullOrUndefined(this.model.targetValue.customText)||this.model.targetValue.customText===""||(u.parent().parent().css({"justify-content":this.model.secondaryValuePosition=="left"?"flex-start":this.model.secondaryValuePosition=="center"?"flex-start":"space-between"}),this.model.secondaryValuePosition=="center"&&u.parent().css({width:"60%","justify-content":"center"})),this.model.secondaryValueType===t.Card.SecondaryValueType.Target&&(s=this.targetExponent?this._createExponentValues(this.model.targetValue.value,!1,!1):this._getFormattedValue(this.model.targetValue.value,!1,!1),u.html(s),u.css({color:"#686262"}),this._isNullOrEmptyOrUndefined(this.model.targetValue.customText)||this.element.find(".e-customtext-target").html(this.model.targetValue.customText).css({"min-width":"10%"}))),this.model.customVisibility.primaryValue&&(h="",h=this._getFormattedValue(r,!0,!1),y=n("<div style='height:50%;'>"),c="",c=this.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?this._getVarianceValue(r):this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?this._getFormattedValue(this.model.actualValue.value,!0,!1).value:h.variance,f.html(c),f.parent().css({"justify-content":this.model.primaryValuePosition=="center"?"center":this.model.primaryValuePosition=="left"?"flex-start":this._isCompact&&this.model.customVisibility.compactView?"flex-start":"flex-end"}),n(f.parents(".e-row")[0]).css({width:"100%"}),this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue&&y.css({color:this.model.actualValue.color})),!this._isNullOrEmptyOrUndefined(this.model.rangeSettings)&&(this.model.rangeSettings.Type=="Absolute"||this.model.rangeSettings.Type=="Percent")&&this.model.rangeSettings.Ranges.length>0&&this.model.IsCustomRange&&this.model.IsApplied?this._createRangeKpiIndicator(i):this._isNullOrEmptyOrUndefined(this.model.icon)||this._isNullOrEmptyOrUndefined(this.model.icon.path)?this._createKpiIndicator(i):this._customIndicatorForCard(i),l=e===0?"#FBCB43":e>0?this.warning?"#FBCB43":this.model.higherValueGood?"#34B67A":"#E57368":this.warning?"#FBCB43":this.model.higherValueGood?"#E57368":"#34B67A",o.css({color:this._varianceColor===""?l:this._varianceColor}),this.model.customVisibility.secondaryValue&&this.model.secondaryValueType!==t.Card.SecondaryValueType.Target&&u.css({color:this._varianceColor===""?l:this._varianceColor}),this.element.width()>250&&this.element.parents("td").height()>100,p=n(this.element).find(".e-variation.e-row.e-hoverable").width()-n(this.element).find(".e-variationkpi.e-row").width(),w=n(n(this.element).find(".e-primary-value").parents(".e-row")[0]).width(),w>p&&n(f.parents(".e-row")[0]).css({width:"85%"}),f.parents(".e-variation.e-row.e-compact").css({width:"100%"})),t.isNullOrUndefined(i)||i.css({"line-height":"normal"}),this.model.background.type===t.Card.BackgroundType.Full&&o.css({color:"white"}),o},_createSparkLineContainer:function(i){var r={},u=this.element.find(".e-sparkline").css({height:"20%"}),s;t.browserInfo()&&t.browserInfo().name==="chrome"&&u.addClass("e-chrome");r[this.model.sparkLine.SparklineName]="#point.sparklineName#";r[this.model.actualValue.name]="#point.valueName#";var f=n("<div>").attr({id:this._proxy+"_sparkLineTooltipTemplate"}),e=n("<div>").addClass("e-card-tooltip").css({width:"auto","max-width":"400px","word-wrap":"break-word",display:"none"}),o=this._renderingToopTipTemplate(r);e.html(o);f.html(e);n(i).append(f);s=this;n(u).BoldBIDashboardSparkline({dataSource:this.model.sparkLine.Data,tooltip:{visible:!0,template:this._proxy+"_sparkLineTooltipTemplate"},yName:"valueName",type:this.model.sparkLine.Type,markerSettings:{visible:this.model.sparkLine.Type.toLowerCase()!=="column"?this.model.sparkLine.ShowMarker:!1,fill:"transparent",border:{color:"transparent"},width:2},highPointColor:this.model.sparkLine.HighValueColor,lowPointColor:this.model.sparkLine.LowValueColor,opacity:this.model.sparkLine.Opacity,height:"80%"})},_createPrimaryValueForIndicator:function(t){var r=n("<div>").addClass("e-primary-value").css({color:this._varianceColor}),i;this._createColorForPrimaryValue();i=this._getPrimaryValue();r.text(i.value).css({color:this._varianceColor,"max-width":this.element.find(".e-value-parent").width()});this._createFontForIndicator(r,i.value);t.attr({variation:i.value,variance:i.variance}).css({"text-align":"center",width:"auto"});t.parents(".e-variation").css({"justify-content":"center"});t.append(r)},_createColorForPrimaryValue:function(){var t=0,n=!this._isNullOrEmptyOrUndefined(this.model.primaryValue)&&!this._isNullOrEmptyOrUndefined(this.model.primaryValue.color)?this.model.primaryValue.color:"";this._varianceColor=this._isNullOrEmptyOrUndefined(this.model.actualValue.value)||this._isNullOrEmptyOrUndefined(this.model.targetValue.value)||parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)!==t?parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)>t?n!==""?n:this.warning?"#FBCB43":this.model.higherValueGood?"#34B67A":"#E57368":n!==""?n:this.warning?"#FBCB43":this.model.higherValueGood?"#E57368":"#34B67A":n==""?"#FBCB43":n},_getPrimaryValue:function(){var i=this._getFormattedValue(!this._isNullOrEmptyOrUndefined(this.model.actualValue.value)&&!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)?parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value):"",!0,!1),r,n;return this.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?(r=!this._isNullOrEmptyOrUndefined(this.model.actualValue.value)&&!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)?parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value):"",n=this._getVarianceValue(r)):n=this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?this._getFormattedValue(this.model.actualValue.value,!0,!1).value:i.variance,{value:n,variance:i.variance}},_createFontForIndicator:function(n,i){var h=null,c=null,r=this.element.find(".e-value-parent").height(),s=this.element.find(".e-value-parent").width(),u=s<r?s:r,f,e,o;h=u;c=u;f=u;r=f*Math.sqrt(3)/2;e=this._getOptimumFontSize(r/3.2,f,t.Card.AdjustFont.Width,i);o=12;n.css({"font-size":parseInt(e)<o?o+"px":e})},_getVarianceValue:function(n){var o=n,r="",f=2,i,u,e;switch(this.model.valueRepresentation.format){case t.Card.Format.Percentage:r="P"+f;break;case t.Card.Format.Number:r="N"+f;break;case t.Card.Format.Currency:r="C"+f}return i=this._applyStringFormatting(r,this.model.valueRepresentation.currencyCulture,this.model.valueRepresentation.abbreviationType,o,!1),this.model.valueRepresentation.decimalSeparator==null||this.model.valueRepresentation.groupSeparator==null||t.isNullOrUndefined(i)||(u=i.split(this.model.valueRepresentation.decimalSeparator.CurrentValue),e=u[0].replace(this.model.valueRepresentation.groupSeparator.CurrentValue,this.model.valueRepresentation.groupSeparator.AliasValue),i=u.length>1?e+this.model.valueRepresentation.decimalSeparator.AliasValue+u[1]:e),i},_createKpiIndicator:function(i,r){var a,v,k,d,y;this._isNullOrEmptyOrUndefined(this.model.IsCustomRange)||this.model.IsCustomRange||(this.model.primaryValue.color="",s=n(this.element).parents("#topParent").hasClass("e-Card-Single")?n(this.element).parents("#topParent"):[],t.isNullOrUndefined(s[0])&&(s=n(this.element)),s.css({"background-color":""}));var o=null,s=null,h=0;r?this.browserType===t.Card.BrowserType.IE?(o=document.createElement("canvas"),o.setAttribute("id",this._proxy+"_Kpi_Canvas")):o=document.getElementById(this._proxy+"_Kpi_Canvas"):(o=document.createElement("canvas"),o.setAttribute("id",this._proxy+"_Kpi_Canvas"));var u=document.createElement("div"),e=this.element.find(".e-variationkpi").height(),l=this.element.find(".e-variationkpi").height();this.model.customVisibility.primaryValue||this._isCompact||this.element.find(".e-variation").css({"justify-content":"flex-end"});this.element.width()<250&&this.element.parents("td").height()<100;a=16;v=16;e=e>a?e:a;l=l>v?l:v;t.preferredCulture(this.model.valueRepresentation.currencyCulture);var g=this._getFormattedValue(this._isNullOrEmptyOrUndefined(this.model.actualValue.value)?Math.abs(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)):parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value),!0,!1),b=null,p=null,f=!this._isNullOrEmptyOrUndefined(this.model.primaryValue)&&!this._isNullOrEmptyOrUndefined(this.model.primaryValue.color)?this.model.primaryValue.color:"";if(this.model.showIndicatorOnly){var p=this.element.find(".e-value-parent").height()/1.5,w=this.element.find(".e-value-parent").width(),c=w<p?w:p;b=c;u.setAttribute("id",this._proxy+"_Kpi_SVG");u.style.width=Math.floor(c)+"px";u.style.height=Math.floor(c)+"px";u.style.fontSize=Math.floor(c)+"px";u.style.margin="auto";u.style.lineHeight="normal";k=!1;d=!1;t.preferredCulture(this.model.valueRepresentation.currencyCulture);parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)===h||this._isNullOrEmptyOrUndefined(this.model.actualValue.value)||this._isNullOrEmptyOrUndefined(this.model.targetValue.value)?(this._varianceColor=f==""?"#FBCB43":f,u.classList.add("e-card-icon-circle"),u.style.color=this._varianceColor):parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)>h?(this._varianceColor=f!==""?f:this.warning?"#FBCB43":this.model.higherValueGood?"#34B67A":"#E57368",u.classList.add("e-card-icon-tri-up"),u.style.color=this._varianceColor):(this._varianceColor=f!==""?f:this.warning?"#FBCB43":this.model.higherValueGood?"#E57368":"#34B67A",u.classList.add("e-card-icon-tri-down"),u.style.color=this._varianceColor)}else u.style.height=Math.floor(e)+"px",u.style.width=Math.floor(e)+"px",u.style.fontSize=Math.floor(e)+"px",u.style.lineHeight="normal",t.preferredCulture(this.model.valueRepresentation.currencyCulture),parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)===h?(this._varianceColor=f==""?"#FBCB43":f,u.classList.add("e-card-icon-circle"),u.style.color=this._varianceColor):parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)>h?(this._varianceColor=f!==""?f:this.warning?"#FBCB43":this.model.higherValueGood?"#34B67A":"#E57368",u.classList.add("e-card-icon-tri-up"),u.style.color=this._varianceColor):(this._varianceColor=f!==""?f:this.warning?"#FBCB43":this.model.higherValueGood?"#E57368":"#34B67A",u.classList.add("e-card-icon-tri-down"),u.style.color=this._varianceColor);y=this._getPrimaryValue();i.attr({variation:y.value,variance:y.variance});i.parents(".e-variation").css({"align-items":"center"});i.append(u)},_createRangeForActualValue:function(){var u=this.model.rangeSettings.Ranges,o=n("<img>"),e=null,f=n(this.element).parents("#topParent").hasClass("e-Card-Single")?n(this.element).parents("#topParent"):[],r,i;for(this.count=0,r=null,t.isNullOrUndefined(f[0])&&(f=n(this.element)),this.model.valueRepresentation.negativeValueFormat==="nonegativesignwithbracket"?r=parseFloat(n(this.element).find(".e-value.e-hoverable").text().replace("(","-").replace(")","").replace(",","").replace(" ","").replace(/[^\d.-]/g,"")):this.model.valueRepresentation.negativeValueFormat==="negativesigninsuffix"?(r=n(this.element).find(".e-value.e-hoverable").text().replace("-","").replace(")","").replace(",","").replace(" ","").replace(/[^\d.-]/g,""),r=parseFloat("-"+r)):r=parseFloat(n(this.element).find(".e-value.e-hoverable").text().replace(",","").replace(" ","").replace(/[^\d.-]/g,"")),i=0;i<u.length;i++)if(u[i].RangeValueType===1)if(e=this._createActualConditonIndicator(u[i],f,r),this.count!==0)break;else u.length-1==i&&(this._varianceColor="");else if(u[i].RangeValueType===0)if(e=this._createActualRangeIndicator(u[i],f,r),this.count!==0)break;else u.length-1==i&&(this._varianceColor="")},_createActualRangeIndicator:function(t,i,r){this.model.rangeSettings.Type=="Percent"?n(this.element).find(".e-value.e-hoverable").text().indexOf("%")==-1?parseFloat(t.RangeFrom)/100*this.model.cardDefaultData<=r&&parseFloat(t.RangeTo)/100*this.model.cardDefaultData>=r&&this._loadActualIndicatorForCard(t,i):parseFloat(t.RangeFrom)<=r&&parseFloat(t.RangeTo)>=r&&this._loadActualIndicatorForCard(t,i):this.model.rangeSettings.Type=="Absolute"&&parseFloat(t.RangeFrom)<=r&&parseFloat(t.RangeTo)>=r&&this._loadActualIndicatorForCard(t,i)},_loadActualIndicatorForCard:function(n,t){this._varianceColor="#"+n.RangeColor.substr(3,6);t.css({"background-color":"#"+n.RangeBackGroundColor.substr(3,6)});this.count++},_createActualConditonIndicator:function(t,r,u){var f=null,e=this.model.rangeSettings.Type=="Percent"?n(this.element).find(".e-value.e-hoverable").text().indexOf("%")==-1?t.RangeConditionValue/100*this.model.cardDefaultData:t.RangeConditionValue:t.RangeConditionValue;switch(t.RangeCondition){case 0:u===e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);break;case 1:u!==e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);break;case 2:u>e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);break;case 3:u<e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);break;case 4:u>=e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);break;case 5:u<=e&&(f=this._loadActualIndicatorForCard(t,r),this.count++);default:length-1==i&&(f=this._loadActualIndicatorForCard(t,r),this.count++)}return f},_createRangeKpiIndicator:function(t){var r=this.model.rangeSettings.Ranges,u=null,i;for(this.count=0,this.model.valueRepresentation.negativeValueFormat==="nonegativesignwithbracket"?this.primaryValueType=parseFloat(this.Value.replace("(","-").replace(")","").replace(",","").replace(" ","").replace(/[^\d.-]/g,"")):this.model.valueRepresentation.negativeValueFormat==="negativesigninsuffix"?(this.Value=this.Value.replace("-","").replace(")","").replace(",","").replace(" ","").replace(/[^\d.-]/g,""),this.primaryValueType=parseFloat("-"+this.Value)):this.primaryValueType=parseFloat(n(this.element).find(".e-primary-value").text().replace(",","").replace(" ","").replace(/[^\d.-]/g,"")),isNaN(this.primaryValueType)&&(this.primaryValueType=parseFloat(this.Value.replace(",","").replace(" ","").replace(/[^\d.-]/g,""))),i=0;i<r.length;i++)if(r[i].RangeValueType===1)if(u=this._createConditonIndicator(r[i],t,i,r.length),this.count!==0)break;else r.length-1==i&&(u=this._createKpiIndicator(t));else if(r[i].RangeValueType===0)if(u=this._createRangeIndicator(r[i],t,i,r.length),this.count!==0)break;else r.length-1==i&&(u=this._createKpiIndicator(t));return u},_createRangeIndicator:function(i,r,u,f){var h=n(this.element).parents("#topParent").hasClass("e-Card-Single")?n(this.element).parents("#topParent"):[],l=.7,a=.9,e=16,v=null,y=this.element.find(".e-value-parent").height()/1.5,p=this.element.find(".e-value-parent").width(),c=p<y?p:y,s,o;if(t.isNullOrUndefined(h[0])&&(h=n(this.element)),v=n(this.element).find(".e-primary-value").text()==""?this.Value:n(this.element).find(".e-primary-value").text(),s=n("<img>"),this.model.rangeSettings.Type=="Percent")if(v.indexOf("%")!=-1){if(parseFloat(i.RangeFrom)<=this.primaryValueType&&parseFloat(i.RangeTo)>=this.primaryValueType&&i.RangeIcon!=null&&i.IsChecked)return this._varianceColor="#"+i.RangeColor.substr(3,6),r.css({height:""}),s.attr("src",i.RangeIcon),s.css({width:this.model.showIndicatorOnly?Math.floor(c):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._width*.13<e?e:this._width*.13+"px",height:this.model.showIndicatorOnly?Math.floor(c)*(this.model.headers.visible?l:a):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._height*(this.model.headers.visible?.26:.32)<e?e:this._height*(this.model.headers.visible?.25:.32)+"px"}),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),r.append(s),this.count++,r;if(parseFloat(i.RangeFrom)<=this.primaryValueType&&parseFloat(i.RangeTo)>=this.primaryValueType)return this.model.primaryValue.color="#"+i.RangeColor.substr(3,6),o=this._createKpiIndicator(r),this._varianceColor="#"+i.RangeColor.substr(3,6),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),this.count++,o;if(f-1==u)return o=this._createKpiIndicator(r),this.count++,o}else{if(parseFloat(i.RangeFrom)/100*this.model.cardDefaultData<=this.primaryValueType&&parseFloat(i.RangeTo)/100*this.model.cardDefaultData>=this.primaryValueType&&i.RangeIcon!=null&&i.IsChecked)return this._varianceColor="#"+i.RangeColor.substr(3,6),r.css({height:""}),s.attr("src",i.RangeIcon),s.css({width:this.model.showIndicatorOnly?Math.floor(c):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._width*.13<e?e:this._width*.13+"px",height:this.model.showIndicatorOnly?Math.floor(c)*(this.model.headers.visible?l:a):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._height*(this.model.headers.visible?.25:.32)<e?e:this._height*(this.model.headers.visible?.25:.32)+"px"}),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),r.append(s),this.count++,r;if(parseFloat(i.RangeFrom)/100*this.model.cardDefaultData<=this.primaryValueType&&parseFloat(i.RangeTo)*this.model.cardDefaultData/100>=this.primaryValueType)return this.model.primaryValue.color="#"+i.RangeColor.substr(3,6),o=this._createKpiIndicator(r),this._varianceColor="#"+i.RangeColor.substr(3,6),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),this.count++,o;if(f-1==u)return o=this._createKpiIndicator(r),this.count++,o}else if(this.model.rangeSettings.Type=="Absolute"){if(parseFloat(i.RangeFrom)<=this.primaryValueType&&parseFloat(i.RangeTo)>=this.primaryValueType&&i.RangeIcon!=null&&i.IsChecked)return this._varianceColor="#"+i.RangeColor.substr(3,6),r.css({height:""}),s.attr("src",i.RangeIcon),s.css({width:this.model.showIndicatorOnly?Math.floor(c):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._width*.13<e?e:this._width*.13+"px",height:this.model.showIndicatorOnly?Math.floor(c)*(this.model.headers.visible?l:a):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._height*(this.model.headers.visible?.25:.32)<e?e:this._height*(this.model.headers.visible?.25:.32)+"px"}),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),r.append(s),this.count++,r;if(parseFloat(i.RangeFrom)<=this.primaryValueType&&parseFloat(i.RangeTo)>=this.primaryValueType)return this.model.primaryValue.color="#"+i.RangeColor.substr(3,6),o=this._createKpiIndicator(r),this._varianceColor="#"+i.RangeColor.substr(3,6),h.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),this.count++,o;if(f-1==u)return o=this._createKpiIndicator(r),this.count++,o}},_createConditonIndicator:function(t,i,r,u){var f=null,o=null,e=null;o=n(this.element).find(".e-primary-value").text()==""?this.Value:n(this.element).find(".e-primary-value").text();e=this.model.rangeSettings.Type=="Percent"?o.indexOf("%")==-1?t.RangeConditionValue/100*this.model.cardDefaultData:t.RangeConditionValue:t.RangeConditionValue;switch(t.RangeCondition){case 0:this.primaryValueType===e&&(f=this._loadIndicatorForCard(t,i),this.count++);break;case 1:this.primaryValueType!==e&&(f=this._loadIndicatorForCard(t,i),this.count++);break;case 2:this.primaryValueType>e&&(f=this._loadIndicatorForCard(t,i),this.count++);break;case 3:this.primaryValueType<e&&(f=this._loadIndicatorForCard(t,i),this.count++);break;case 4:this.primaryValueType>=e&&(f=this._loadIndicatorForCard(t,i),this.count++);break;case 5:this.primaryValueType<=e&&(f=this._loadIndicatorForCard(t,i),this.count++);default:u-1==r&&(f=this._createKpiIndicator(i),this.count++)}return f},_customIndicatorForCard:function(t){var r,i,o;this._varianceColor=this.model.primaryValue.color;var u=16,s=this.element.find(".e-value-parent").height()/1.5,h=this.element.find(".e-value-parent").width(),e=h<s?h:s,f=t.height();if(this.model.icon.type==="Default"){r=this.model.icon.color;i=n("<div><\/div>");i.css({"font-size":this.model.showIndicatorOnly?Math.floor(e):f<u?u:f+"px",width:this.model.showIndicatorOnly?Math.floor(e)+"px":" ",margin:"auto",height:this.model.showIndicatorOnly?Math.floor(e)+"px":f<u?u:f+"px"});switch(this.model.icon.path.toLowerCase()){case"up":i.addClass("e-card-icon-arrow-up").css({color:r});break;case"down":i.addClass("e-card-icon-arrow-down").css({color:r});break;case"right":i.addClass("e-card-icon-arrow-right").css({color:r});break;case"tick":i.addClass("e-card-icon-tick").css({color:r});break;case"close":i.addClass("e-card-icon-close").css({color:r});break;case"pointerup":i.addClass("e-card-icon-tri-up").css({color:r});break;case"warning":i.addClass("e-card-icon-warning").css({color:r});break;case"star":i.addClass("e-card-icon-star").css({color:r});break;case"polygon":i.addClass("e-card-icon-polygon").css({color:r});break;case"round":i.addClass("e-card-icon-circle").css({color:r});break;case"minus":i.addClass("e-card-icon-minus").css({color:r});break;default:i.addClass("e-card-icon-tri-down").css({color:r})}t.append(i)}else o=n("<img>"),t.css({height:""}),o.attr("src",this.model.icon.path),o.css({width:this.model.showIndicatorOnly?Math.floor(e):f<u?u:f+"px",height:this.model.showIndicatorOnly?Math.floor(e):f<u?u:f+"px"}),t.append(o)},_loadIndicatorForCard:function(i,r){var u=n(this.element).parents("#topParent").hasClass("e-Card-Single")?n(this.element).parents("#topParent"):[],c;t.isNullOrUndefined(u[0])&&(u=n(this.element));var e=n("<img>"),f=16,o=this.element.find(".e-value-parent").height()/1.5,s=this.element.find(".e-value-parent").width(),h=s<o?s:o;return i.IsChecked&&!t.isNullOrUndefined(i.RangeIcon)?(this._varianceColor="#"+i.RangeColor.substr(3,6),r.css({height:""}),e.attr("src",i.RangeIcon),u.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),e.css({width:this.model.showIndicatorOnly?Math.floor(h):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._width*.13<f?f:this._width*.13+"px",height:this.model.showIndicatorOnly?Math.floor(h)*(this.model.headers.visible?.7:.9):this.element.width()<200&&this.element.parents("td").height()<90?"10px":this._height*(this.model.headers.visible?.25:.32)<f?f:this._height*(this.model.headers.visible?.25:.32)+"px"}),r.append(e),r):(this.model.primaryValue.color="#"+i.RangeColor.substr(3,6),c=this._createKpiIndicator(r),u.css({"background-color":"#"+i.RangeBackGroundColor.substr(3,6)}),this._varianceColor="#"+i.RangeColor.substr(3,6),c)},_setBackgroundImageIfAny:function(i){if(this.model.background.type===t.Card.BackgroundType.Image&&this.model.background.imageSrc){var r=n("<img>").addClass("e-bgr"),u=n("<div>").addClass("e-top").css({width:i.width(),top:-i.height(),height:i.height()});i.append(r,u);this._isDataURI("data:image/*;base64,"+this.model.background.imageSrc)?r.attr({src:"data:image/*;base64,"+this.model.background.imageSrc}).css({opacity:this.model.background.opacity}):r.attr({src:this.model.background.imageSrc}).css({opacity:this.model.background.opacity});i=u}return this._isNullOrEmptyOrUndefined(this.model.background.color)||i.css({"background-color":this.model.background.color}),i},_render:function(){var i=this.element,f,e,h,u,c,a;i.addClass("e-card");var r=-1,o=2;if(this.actualExponent=this.model.actualValue.value.indexOf("e")!==r||this.model.actualValue.value.indexOf("E")!==r,this.additionalExponent=!t.isNullOrUndefined(this.model.additionalValue)&&!this._isNullOrEmptyOrUndefined(this.model.additionalValue.value)?this.model.additionalValue.value.indexOf("e")!==r||this.model.additionalValue.value.indexOf("E")!==r:!1,this.targetExponent=this.model.targetValue.value.indexOf("e")!==r||this.model.targetValue.value.indexOf("E")!==r,this.model.size.height!==""?i.css({height:this.model.size.height}):i.height()>i.width()/o?i.css({height:i.width()/o}):i.css({height:i.height()-4}),this.model.size.width!==""&&i.css({width:this.model.size.width}),i=this._setBackgroundImageIfAny(i),this.model.hasTarget=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value),this.model.hasSparkLine=!n.isEmptyObject(this.model.sparkLine)&&!t.isNullOrUndefined(this.model.sparkLine.Data)?this.model.sparkLine.Data.length>0&&this.model.customVisibility.sparkline:!1,this.model.hasTarget&&(this.model.hasTarget=!this._isNullOrEmptyOrUndefined(this.model.actualValue.value)),f=null,e=null,i=this._createLayout(i),this.model.showIndicatorOnly&&this.model.hasTarget)a=this._createTitleContainer(),f=this._createVariationContainer(),this.model.hasSparkLine&&this._createSparkLineContainer(i);else{f=this._createVariationContainer();var v=this.element.find(".e-value-parent"),l=this._createTitleContainer(),s=this.element.find(".e-value-additional");!this.model.customVisibility.additionalElement||this._isNullOrEmptyOrUndefined(this.model.additionalValue)||this._isNullOrEmptyOrUndefined(this.model.additionalValue.value)||(e=this.additionalExponent?this._createExponentValues(this.model.additionalValue.value,!1,!0):this._getFormattedValue(this.model.additionalValue.value,!1,!0),s.html(e),s.css({"justify-content":this.model.additionalValue.position=="center"?"center":this.model.additionalValue.position=="left"?"flex-start":this._isCompact&&this.model.customVisibility.compactView?"flex-start":"flex-end",width:this._isCompact?"auto":"100%"}));this.model.hasTarget?(c=this._createActualValueContainer(),this.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue&&c.actualValueDiv.css({color:this._varianceColor})):(h=this._createActualValueContainer(),!this._isNullOrEmptyOrUndefined(this.model.rangeSettings)&&(this.model.rangeSettings.Type=="Absolute"||this.model.rangeSettings.Type=="Percent")&&this.model.rangeSettings.Ranges.length>0&&this.model.IsCustomRange&&(this._createRangeForActualValue(),h.actualValueDiv.css({color:this._varianceColor})),this.model.IsCustomRange||(u=n(this.element).parents("#topParent").hasClass("e-Card-Single")?n(this.element).parents("#topParent"):[],t.isNullOrUndefined(u[0])&&(u=n(this.element)),u.css({"background-color":""})));this.model.headers.visible||l.css({height:0});this.model.hasSparkLine&&this._createSparkLineContainer(i);!this.model.showActualValue;this.model.background.type!==t.Card.BackgroundType.Full}this.model.background.type===t.Card.BackgroundType.Full&&i.css({"background-color":this._varianceColor});this._isNullOrEmptyOrUndefined(this.model.background.color)||i.css({"background-color":this.model.background.color});!this.model.customVisibility.indicator&&this.element.find(".e-variationkpi").children().length>0&&!this.model.showIndicatorOnly&&this.element.find(".e-variationkpi").children().css({display:"none"});this._trigger("create",this)},_createLayout:function(i){var s=this.model.hasSparkLine&&!this.model.subTitle.visible?"20%":this.model.showIndicatorOnly?"22%":"30%",h=this.model.headers.visible?this.model.hasSparkLine&&!this.model.subTitle.visible?"80%":"70%":"100%",r,u,o;if(!(this.model.headers.visible||this.model.customVisibility.actualValue||this.model.customVisibility.primaryValue||this.model.customVisibility.secondaryValue||this.model.customVisibility.additionalValue||this.model.customVisibility.sparkline))return i.append(n("<div>").addClass("widget-not-configured-icon")),i.append(n("<div>").css({"font-size":"x-small"}).html("No visible items to display")),i.css({display:"flex","align-items":"center","justify-content":"center","flex-direction":"column"}),i;if(this.model.customVisibility.compactView&&this.element.width()<250&&this.element.height()<100&&this.model.hasTarget){this._isCompact=!0;var f=n("<div>").attr("id",this._proxy+"_CardWrapper").addClass("e-card-wrapper e-column").css({height:i.height(),width:i.width()-10,padding:"5px 5px 0px 5px"}),c=n("<div>").attr("id",this._proxy+"_Title").addClass("e-title").css({height:s}),l=n("<div>").addClass("e-subtitle e-hoverable");if(f.append(c),f.append(l),r=n("<div>").addClass("e-value-parent e-left").css({height:h}),this.model.showIndicatorOnly)u=n("<div>").addClass("e-variation e-variation-indicator  e-hoverable").css({display:"flex","justify-content":"center","align-items":"center"}),o=n("<div>").addClass("e-variationkpi").css({margin:"0 auto",float:"none"}),u.append(o),r.append(u),f.append(r),i.append(f);else{var e=n("<div>").addClass("e-row e-compact e-hoverable").css({width:"100%"}),a=n("<div>").addClass("e-customtext-value"),v=n("<div>").attr("id",this._proxy+"_ActValue").addClass("e-value").css({"min-width":"15%"}),o=n("<div>").addClass("e-variationkpi e-row e-compact-value e-hoverable");e.append(a);e.append(v);e.append(o);e.append(n("<div>").addClass("e-value-additional e-row e-hoverable").attr({"data-tooltip":"Value: "}).css({color:this.model.actualValue.color}));var u=n("<div>").addClass("e-variation e-row e-compact"),y=n("<div>").addClass("e-primary-value e-compact-value"),p=n("<div>").addClass("e-customtext-target"),w=n("<div>").addClass("e-secondary-value").css({"min-width":"8%"});u.append(p);u.append(w);this.model.hasTarget&&this.model.customVisibility.primaryValue&&this.model.customVisibility.secondaryValue&&u.append(n("<div>").addClass("e-separator-card").text("/").css({"margin-right":"3px","margin-left":"2px"}));u.append(y);r.append(e);!t.isNullOrUndefined(this.model.isDefault)&&(t.isNullOrUndefined(this.model.isDefault)||this.model.isDefault)||r.append(u);this.model.hasSparkLine&&r.append(n("<div>").attr({id:this._proxy+"_sparkLine","class":"e-sparkline"}).css({width:"100%","margin-bottom":"5px"}));f.append(r);i.append(f);this.model.uniformFontSize?this._setFontSize():this._setHeight()}}else{var f=n("<div>").attr("id",this._proxy+"_CardWrapper").addClass("e-card-wrapper").css({height:i.height(),width:i.width()-10,padding:"5px 5px 0px 5px"}),c=n("<div>").attr("id",this._proxy+"_Title").addClass("e-title").css({height:s}),l=n("<div>").addClass("e-subtitle e-hoverable");if(f.append(c),f.append(l),r=n("<div>").addClass("e-value-parent e-left").css({height:h}),this.model.showIndicatorOnly)u=n("<div>").addClass("e-variation").css({display:"flex","justify-content":"center","align-items":"center"}),o=n("<div>").addClass("e-variationkpi"),u.append(o),r.append(u),f.append(r),i.append(f);else{var e=n("<div>").addClass("e-row e-hoverable").css({width:"100%"}),a=n("<div>").addClass("e-customtext-value"),v=n("<div>").attr("id",this._proxy+"_ActValue").addClass("e-value");e.append(a);e.append(n("<div>").addClass("e-row").css({height:"100%","max-width":this._isNullOrEmptyOrUndefined(this.model.actualValue.customText)?"100%":"90%"}).append(v));var b=n("<div>").addClass("e-row e-hoverable").css({width:"100%"}),p=n("<div>").addClass("e-customtext-target"),w=n("<div>").addClass("e-secondary-value e-row");b.append(p,n("<div>").addClass("e-row").css({height:"100%","max-width":this._isNullOrEmptyOrUndefined(this.model.targetValue.customText)?"100%":"90%"}).append(w));var u=n("<div>").addClass("e-variation e-row").css({"align-items":"center"}),y=n("<div>").addClass("e-primary-value"),o=n("<div>").addClass("e-variationkpi e-row");u.append(o);u.append(n("<div>").addClass("e-row").append(y));r.append(e);r.append(b);r.append(u);r.append(n("<div>").addClass("e-value-additional e-row e-hoverable").attr({"data-tooltip":"Value: "}).css({color:this.model.actualValue.color}));this.model.hasSparkLine&&r.append(n("<div>").attr({id:this._proxy+"_sparkLine","class":"e-sparkline"}).css({width:"100%","margin-bottom":"5px"}));f.append(r);i.append(f);this.model.uniformFontSize?this._setFontSize():this._setHeight()}}return i},_setFontSize:function(){var o=40,s=80,r=this.element.children().height()>this.element.children().width()?this.element.children().width():this.element.children().height(),e=this._isCompact?this.model.hasSparkLine?.15:.18:this.model.hasSparkLine?.12:.13,n=Math.floor(r*(!this._isCompact&&!t.isNullOrUndefined(this.model.additionalValue)&&this.model.additionalValue.value!==""?.11:e)),i=Math.floor(r*(!this._isCompact&&!t.isNullOrUndefined(this.model.additionalValue)&&this.model.additionalValue.value!==""?.2:.25)),h,u,f;n=n>o?o:n;i=i>s?s:i;h=Math.ceil(r*(!t.isNullOrUndefined(this.model.additionalValue)&&this.model.additionalValue.value!==""?e:e+.01));!this.model.hasTarget&&(t.isNullOrUndefined(this.model.additionalValue)||t.isNullOrUndefined(this.model.additionalValue.value)||this.model.additionalValue.value==="")&&(n=Math.floor(r*.35)>135?135:Math.floor(r*.35));this.model.hasTarget&&(u=!1,f=Math.floor(r*.35)>135?135:Math.floor(r*.35),this.model.customVisibility.actualValue||this.model.customVisibility.secondaryValue||(u=!0),this.model.customVisibility.primaryValue&&u?i=this.model.customVisibility.indicator||this.model.customVisibility.additionalValue?i:f:this.model.customVisibility.actualValue&&!this.model.customVisibility.secondaryValue?n=u?n:this.model.customVisibility.primaryValue||this.model.customVisibility.indicator||this.model.customVisibility.additionalValue?n:f:!this.model.customVisibility.actualValue&&this.model.customVisibility.secondaryValue&&(n=u?n:this.model.customVisibility.primaryValue||this.model.customVisibility.indicator||this.model.customVisibility.additionalValue?n:f));this.element.find(".e-value").css({"font-size":t.isNullOrUndefined(this.model.isDefault)||!t.isNullOrUndefined(this.model.isDefault)&&!this.model.isDefault?n:i+"px",height:this.model.customVisibility.actualValue?"":0});this.element.find(".e-customtext-value").css({"font-size":n+"px",height:this.model.customVisibility.actualValue?"":0});this.model.hasTarget&&(this.element.find(".e-variationkpi").css({height:this.model.customVisibility.indicator?(this.model.hasSparkLine||this._isCompact&&(t.isNullOrUndefined(this.model.isDefault)||!t.isNullOrUndefined(this.model.isDefault)&&!this.model.isDefault)?h:i)+"px":0}),this.element.children().height()<100&&this.element.children().width()<250&&this.model.customVisibility.compactView?(this.element.find(".e-secondary-value").css({"font-size":this.model.hasSparkLine?n+"px":i+"px",height:this.model.customVisibility.secondaryValue?"":0}),this.element.find(".e-customtext-target").css({"font-size":this.model.hasSparkLine?n+"px":i+"px",height:this.model.customVisibility.secondaryValue?"":0})):(this.element.find(".e-secondary-value").css({"font-size":n+"px",height:this.model.customVisibility.secondaryValue?"":0}),this.element.find(".e-customtext-target").css({"font-size":n+"px",height:this.model.customVisibility.secondaryValue?"":0})),this.element.find(".e-primary-value").css({"font-size":this.model.hasSparkLine?n+"px":i+"px",height:this.model.customVisibility.primaryValue?"":0}),t.isNullOrUndefined(this.element.find(".e-separator-card"))||this.element.find(".e-separator-card").css({"font-size":this.model.hasSparkLine?n+"px":i+"px",height:this.model.customVisibility.secondaryValue||this.model.customVisibility.primaryValue?"":0}));t.isNullOrUndefined(this.element.find(".e-value-additional"))||this.element.find(".e-value-additional").css({"font-size":n+"px",height:this.model.customVisibility.additionalElement?"":0});this.model.hasSparkLine&&this.element.find(".e-sparkline").css({height:this.model.customVisibility.sparkline?i+"px":0,"margin-bottom":"5px"})},_setHeight:function(){var i=!t.isNullOrUndefined(this.model.additionalValue)&&!this._isNullOrEmptyOrUndefined(this.model.additionalValue.value),n=this.model.hasSparkLine||i?"15%":"20%",r=this.model.hasSparkLine||i?"40%":"50%";this.model.hasTarget?(this.element.find(".e-value").parent().parent().css({width:"100%",height:this.model.customVisibility.actualValue?n:0}),this.element.find(".e-customtext-value").css({height:this.model.customVisibility.actualValue?"":0}),this.element.find(".e-variationkpi").css({height:this.model.customVisibility.indicator?"100%":0}),this.element.find(".e-secondary-value").parent().parent().css({height:this.model.customVisibility.secondaryValue?n:0,width:"100%"}),this.element.find(".e-customtext-target").css({height:this.model.customVisibility.secondaryValue?"":0}),this.element.find(".e-variation").css({height:this.model.customVisibility.primaryValue||this.model.customVisibility.indicator?this.model.hasSparkLine?n:r:0,width:"100%"})):this.element.find(".e-value").parent().parent().css({width:"100%",height:this.model.customVisibility.actualValue?"70%":0});!t.isNullOrUndefined(this.element.find(".e-value-additional"))&&i&&this.element.find(".e-value-additional").css({height:this.model.customVisibility.additionalElement?n:0});this.model.hasSparkLine&&this.element.find(".e-sparkline").css({height:this.model.customVisibility.sparkline?r:0,"margin-bottom":"5px"})},_getBrowserVendor:function(){var n=navigator.userAgent;(n.indexOf("MSIE")!==-1||n.match(/Trident.*rv\:11\./)!==null)&&(this.browserType=t.Card.BrowserType.IE)},_reDrawKPI:function(){var t=n(this.element).find(n(".e-variationkpi"));!this._isNullOrEmptyOrUndefined(this.model.rangeSettings)&&(this.model.rangeSettings.Type=="Absolute"||this.model.rangeSettings.Type=="Percent")&&this.model.rangeSettings.Ranges.length>0&&this.model.IsCustomRange&&this.model.IsApplied?this._createRangeKpiIndicator(t):this._isNullOrEmptyOrUndefined(this.model.icon.path)?this._createKpiIndicator(t):this._customIndicatorForCard(t)},_isDataURI:function(n){return!n.match(/^\s*data:([a-z]+\/[a-z]+(;[a-z\-]+\=[a-z\-]+)?)?(;base64)?,[a-z0-9\!\$\&\'\,\(\)\*\+\,\;\=\-\.\_\~\:\@\/\?\%\s]*\s*$/i)},_calculateFontSizes:function(){var o=this.element.height()>this.element.width()?this.element.width():this.element.height(),s=this._isCompact?this.model.hasSparkLine?.15:.18:this.model.hasSparkLine?.12:.13,h=Math.floor(o*(!this._isCompact&&!t.isNullOrUndefined(this.model.additionalValue)&&this.model.additionalValue.value!==""?.11:s)),r=12,u=this._getOptimumFontSize(this.element.find(".e-title").height(),this.element.find(".e-title").width(),t.Card.AdjustFont.Both,this.element.find(".e-title").html()),e,i,f;n(this.element).find(".e-title").css({"font-size":u<r?r:u+"px","line-height":this.element.find(".e-title").height()+"px"});n(this.element).find(".e-subtitle").css({"font-size":(u<r?r:u)*.7+"px"});this.model.showIndicatorOnly&&this.model.hasTarget||(e=this._isNullOrEmptyOrUndefined(this.element.find(".e-value").parent().parent().find(".e-customtext-value").text())?this.element.find(".e-value").parent().parent().width():this.element.find(".e-value").parent().parent().width()-.1*this.element.find(".e-value").parent().parent().width(),i=this._getOptimumFontSize(this.element.find(".e-value").parent().parent().height(),e,t.Card.AdjustFont.Both,this.element.find(".e-value").text()),n(this.element).find(".e-value").css({"font-size":i+"px","line-height":(!this.model.hasTarget&&this.model.actualValue.position.toLowerCase()!=="center"?n(this.element).find(".e-value").parent().parent().height()*1.1:n(this.element).find(".e-value").parent().parent().height()-(this.model.hasTarget?0:10))+"px"}),n(this.element).find(".e-value"),this.model.hasTarget&&(i=this._getOptimumFontSize(this.element.find(".e-secondary-value").parent().parent().height(),this.element.find(".e-secondary-value").parent().parent().width(),t.Card.AdjustFont.Both,this.element.find(".e-secondary-value").text())/1.2,n(this.element).find(".e-secondary-value").css({"font-size":i+"px","line-height":n(this.element).find(".e-secondary-value").parent().parent().height()+"px"}),n(this.element).find(".e-value-additional").css({"font-size":this._getOptimumFontSize(n(this.element).find(".e-value-additional").height(),n(this.element).find(".e-value-additional").width(),t.Card.AdjustFont.Both,n(this.element).find(".e-value-additional").html())+"px","text-align":"right","text-overflow":"ellipsis",overflow:"hidden"}),n(this.element).find(".e-primary-value").css({"font-size":this._getOptimumFontSize(n(this.element).find(".e-variation").height(),n(this.element).find(".e-primary-value").parent().width(),t.Card.AdjustFont.Both,n(this.element).find(".e-primary-value").html())+"px","line-height":n(this.element).find(".e-variation").height()+"px"})),this.model.targetValue.value!=""&&this.model.actualValue.value!=""?(n(this.element).find(".e-value-parent .e-row").children(".e-customtext-value").length>0&&(f=this._measureText(n(this.element).find(".e-value.e-hoverable").text(),null,"Normal "+n(this.element).find(".e-value.e-hoverable").css("font-size")+" "+n(this.element).find(".e-value.e-hoverable").css("font-family")),n(this.element).find(".e-value-parent .e-row").children(".e-customtext-value").css({"font-size":h+"px",width:"auto",float:"left"})),n(this.element).find(".e-value-parent .e-row").children(".e-customtext-target").length>0&&(f=this._measureText(n(this.element).find(".e-secondaryvalue").text(),null,"Normal "+n(this.element).find(".e-secondaryvalue").css("font-size")+" "+n(this.element).find(".e-secondaryvalue").css("font-family")),n(this.element).find(".e-value-parent .e-row").children(".e-customtext-target").css({"font-size":i+"px",width:"auto",float:"left"}))):(n(this.element).find(".e-value-parent .e-row").children(".e-customtext-value").length>0&&(f=this._measureText(n(this.element).find(".e-value.e-hoverable").text(),null,"Normal "+n(this.element).find(".e-value.e-hoverable").css("font-size")+" "+n(this.element).find(".e-value.e-hoverable").css("font-family")),n(this.element).find(".e-value-parent").children(".e-customtext-value").css({width:"auto",height:"100%","font-size":i+"px"})),n(this.element).find(".e-value-parent .e-row").children(".e-customtext-target").length>0&&(f=this._measureText(n(this.element).find(".e-secondaryvalue").text(),null,"Normal "+n(this.element).find(".e-secondaryvalue.e-hoverable").css("font-size")+" "+n(this.element).find(".e-secondaryvalue.e-hoverable").css("font-family")),n(this.element).find(".e-value-parent .e-row").children(".e-customtext-target").css({width:"auto",height:"100%","font-size":i+"px"}))))},_getOptimumFontSize:function(n,i,r,u){var f=null,e=null,s=1,o=.1;if(r===t.Card.AdjustFont.Both)for(f=.9;;)if(e=this._measureText(u,i,"Bold "+n*f+" Roboto"),e.width>i||e.height>n){if(f.toFixed(s)<=o)return n*f;f-=o}else return n*f;else{if(r===t.Card.AdjustFont.Height)return f=.72,n*f;if(r===t.Card.AdjustFont.Width)for(f=.9;;)if(e=this._measureText(u,i,"Bold "+n*f+" Roboto"),e.width>i){if(f.toFixed(s)<=o)return n*f;f-=o}else return n*f;else return n*.9}},_measureText:function(i,r,u){var s=n(document).find("#cardMeasureText"),f=null,h=0,c=-1,e,v;s.length===h?(f=document.createElement("text"),n(f).attr({id:"cardMeasureText"}),document.body.appendChild(f)):f=s[0];var l="",o="",a="";return f.innerHTML=i,typeof u!="undefined"&&typeof u.size=="undefined"&&(e=u,e=e.split(" "),l=e[0],o=e[1],a=e[2]),u!==null&&(f.style.fontSize=u.size>h?u.size+"px":u.size?u.size:o.indexOf("px")===c&&o.indexOf("%")===c?o+"px":o,f.style.fontStyle=u.fontStyle?u.fontStyle:l,f.style.fontFamily=u.fontFamily?u.fontFamily:a),f.style.backgroundColor="white",f.style.position="absolute",f.style.top=-100,f.style.left=0,f.style.visibility="hidden",r&&(f.style.maxwidth=r+"px"),v={width:f.offsetWidth,height:f.offsetHeight},t.browserInfo().name==="msie"||t.browserInfo().name==="webkit"?f.parentNode.removeChild(f):f.remove(),v},_getFormattedValue:function(n,i,r){var y=n,h="",o=0,c=2,s=100,u=r?this.model.additionalValueRepresentation:this.model.valueRepresentation,f,l,v,a,e;switch(u.format){case t.Card.Format.Percentage:h="P"+u.numberOfDecimals;break;case t.Card.Format.Number:h="N"+u.numberOfDecimals;break;case t.Card.Format.Currency:h="C"+u.numberOfDecimals}if(f=this._applyStringFormatting(h,u.currencyCulture,u.abbreviationType,y,r),u.format!==t.Card.Format.Percentage&&(u.decimalSeparator==null||u.groupSeparator==null||t.isNullOrUndefined(f)||(l=f.split(u.decimalSeparator.CurrentValue),v=l[0].replaceAll(u.groupSeparator.CurrentValue,u.groupSeparator.AliasValue),f=l.length>1?v+u.decimalSeparator.AliasValue+l[1]:v),f=u.prefix+f+u.suffix),t.preferredCulture(u.currencyCulture),a=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&!this._isNullOrEmptyOrUndefined(this.model.actualValue.value)&&parseFloat(this.model.actualValue.value)===o&&parseFloat(this.model.targetValue.value)===o,i){e=0;switch(u.variationType){case t.Card.VariationTypes.Absolute:e=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&parseFloat(this.model.targetValue.value)===o?o:y*s/parseFloat(this.model.targetValue.value);f={value:f,variance:t.globalize.format(e.toFixed(c).toString())+"%"};break;case t.Card.VariationTypes.ActualValue:case t.Card.VariationTypes.PercentOfDifference:e=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&parseFloat(this.model.targetValue.value)!==o?(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value))/((parseFloat(this.model.targetValue.value)+parseFloat(this.model.actualValue.value))/2)*s:a?o:s;f={value:f,variance:t.globalize.format(e.toFixed(c).toString())+"%"};break;case t.Card.VariationTypes.PercentOfTarget:e=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&parseFloat(this.model.targetValue.value)!==o?parseFloat(this.model.actualValue.value)/parseFloat(this.model.targetValue.value)*s:a?o:s;f={value:f,variance:t.globalize.format(this.model.customHeader.text==="Actual vs Target"?e.toFixed(o).toString():e.toFixed(c).toString())+"%"};break;case t.Card.VariationTypes.PercentOfChange:e=!this._isNullOrEmptyOrUndefined(this.model.targetValue.value)&&parseFloat(this.model.targetValue.value)!==o?(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value))/parseFloat(this.model.targetValue.value)*s:a?o:s;f={value:f,variance:t.globalize.format(e.toFixed(c).toString())+"%"}}e<=5&&e>=-5&&(this.warning=!0)}return f},_getTitleAlignmentValue:function(n){var t=null;switch(n){case"center":t="center";break;case"left":t="flex-start";break;case"right":t="flex-end";break;default:t="flex-start"}return t},_applyNegativeFormatting:function(n,i,r){var f=Math.abs(n.toString()),u=t.globalize.format(f,"N"+i,r);switch(this.model.valueRepresentation.negativeValueFormat){case t.Card.NegativeValueFormat.Default:return"-"+u;case t.Card.NegativeValueFormat.NoNegativeSignWithBracket:return"("+u+")";case t.Card.NegativeValueFormat.NegativeSignInSuffix:return u+"-"}return"-"+u},_applyStringFormatting:function(n,i,r,u,f){if(!t.isNullOrUndefined(u)){t.preferredCulture(i);var e=parseFloat(u.toString());return isNaN(e)?u:(e=r===t.Card.AbbreviationTypes.Auto?this._truncateNumber(e):this._applyNumberUnit(r,e),this._adjustZeros(e,r,n,i,f))}},_adjustZeros:function(n,i,r,u,f){t.preferredCulture(u);var o=r,s=0,l=-1,a=0,e=parseInt(r.replace(/^\D+/g,"")),h=n.fraction===parseInt(n.fraction)||n.fraction%e===s,c=f?this.model.additionalValueRepresentation.currencyCulture:this.model.valueRepresentation.currencyCulture;return i===t.Card.AbbreviationTypes.Auto?(this.representSymbol=n.symbol,n.fraction===s?(n={fraction:0,symbol:""},o=r.replace(e,"0")):h&&(o=r.replace(e,"0")),r.indexOf("N")>l&&n.fraction<a)?this._applyNegativeFormatting(n.fraction,h?s:e,c)+n.symbol:t.globalize.format(n.fraction,o,c)+n.symbol:(n.fraction===s&&(n={fraction:s,postFixLabel:""},o=r.replace(e,"0")),h&&(o=r.replace(e,"0")),r.indexOf("N")>l&&n.fraction<a)?this._applyNegativeFormatting(n.fraction,h?s:e,c)+n.postFixLabel:t.globalize.format(n.fraction,o,c)+n.postFixLabel},_truncateNumber:function(n){var f=10,e=Math.pow(f,3),o=Math.pow(f,5),i=Math.pow(f,6),s=Math.pow(f,7),r=Math.pow(f,9),u=Math.pow(f,12),t=n;if(this.model.culture==="en-IN"){if(t>=e&&t<o||t<=-e&&t>-o)return{fraction:this._calculateFraction(t,e),symbol:"K"};if(t>=o&&t<i||t<=-o&&t>-i)return{fraction:this._calculateFraction(t,o),symbol:"L"};if(t>=i&&t<s||t<=-i&&t>-s)return{fraction:this._calculateFraction(t,i),symbol:"M"};if(t>=s&&t<r||t<=-s&&t>-r)return{fraction:this._calculateFraction(t,s),symbol:"C"};if(t>=r&&t<u||t<=-r&&t>-u)return{fraction:this._calculateFraction(t,r),symbol:"B"};if(t>=u||t<=-u)return{fraction:this._calculateFraction(t,u),symbol:"T"}}else{if(t>=e&&t<i||t<=-e&&t>-i)return{fraction:this._calculateFraction(t,e),symbol:"K"};if(t>=i&&t<r||t<=-i&&t>-r)return{fraction:this._calculateFraction(t,i),symbol:"M"};if(t>=r&&t<u||t<=-r&&t>-u)return{fraction:this._calculateFraction(t,r),symbol:"B"};if(t>=u||t<=-u)return{fraction:this._calculateFraction(t,u),symbol:"T"}}return{fraction:t,symbol:""}},_calculateFraction:function(n,t){return n/t},_applyNumberUnit:function(n,i){var u=1,r=10,f=Math.pow(r,3),s=Math.pow(r,5),e=Math.pow(r,6),h=Math.pow(r,7),o=Math.pow(r,9);if(this.model.culture==="en-IN")switch(n){case t.Card.AbbreviationTypes.Ones:return{fraction:i/u,postFixLabel:""};case t.Card.AbbreviationTypes.Thousands:return{fraction:i/f,postFixLabel:"K"};case t.Card.AbbreviationTypes.Lakhs:return{fraction:i/s,postFixLabel:"L"};case t.Card.AbbreviationTypes.Millions:return{fraction:i/e,postFixLabel:"M"};case t.Card.AbbreviationTypes.Crores:return{fraction:i/h,postFixLabel:"C"};case t.Card.AbbreviationTypes.Billions:return{fraction:i/o,postFixLabel:"B"};default:return{fraction:i,postFixLabel:""}}else switch(n){case t.Card.AbbreviationTypes.Ones:return{fraction:i/u,postFixLabel:""};case t.Card.AbbreviationTypes.Thousands:return{fraction:i/f,postFixLabel:"K"};case t.Card.AbbreviationTypes.Millions:return{fraction:i/e,postFixLabel:"M"};case t.Card.AbbreviationTypes.Billions:return{fraction:i/o,postFixLabel:"B"};default:return{fraction:i,postFixLabel:""}}},_renderingToopTipTemplate:function(n){for(var i,r="<table>",u=Object.keys(n),t=0;t<u.length;t++)i=u[t],r+="<tr><td>"+i+" :<\/td><td><b>"+n[i]+"<\/b><\/td><\/tr>";return r+"<\/table>"},_showToolTip:function(i){var h=-1,c=0,l=28,a=18,v=20,y=5,f=null,e=null,u=null,o=null,r,s;(f=this.targetExponent?this._createExponentValues(this.model.targetValue.value,!1,!1):this._getFormattedValue(this.model.targetValue.value,!1,!1),e=this.actualExponent?this._createExponentValues(this.model.actualValue.value,!1,!1):this._getFormattedValue(this.model.actualValue.value,!1,!1),t.isNullOrUndefined(this.model.additionalValue)||(o=this.additionalExponent?this._createExponentValues(this.model.additionalValue.value,!1,!0):this._getFormattedValue(this.model.additionalValue.value,!1,!0)),u=(parseFloat(this.model.actualValue.value)-parseFloat(this.model.targetValue.value)).toString(),this.variantExponent=u.indexOf("e")!==h||u.indexOf("E")!==h,u=this.variantExponent?this._createExponentValues(u,!0,!1):this.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute&&(this.model.secondaryValueType===t.Card.SecondaryValueType.Variance||this.model.secondaryValueType===t.Card.SecondaryValueType.Target)?this._getFormattedValue(u,!0,!1).variance:this._getVarianceValue(u),this._tooltipTarget&&this._tooltipTarget.attr("class")===n(i.currentTarget).attr("class"))||(this._tooltipTimer&&clearTimeout(this._tooltipTimer),r=this,s=document.getElementsByTagName("BODY")[0],this._tooltipTimer=setTimeout(function(){var k,d,g;r._tooltipTarget=n(i.currentTarget);var h={},p={},b="",w={};if(n(s).find(n("#"+r._proxy+"_toolTip")).length===c?(p=n("<div>").attr({id:r._proxy+"_toolTip"}).addClass("e-card-tooltip").css({width:"auto","max-width":"400px","word-wrap":"break-word"}),n(s).append(p)):(p=n(s).find(n("#"+r._proxy+"_toolTip")),w=r._measureText(p,r._tooltipTarget.width(),"Normal  14  "+r._tooltipTarget.css("font-family"))),r._tooltipTarget.hasClass("e-variation")||r._tooltipTarget.hasClass("e-variationkpi")||r._tooltipTarget.hasClass("e-row")||r._tooltipTarget.hasClass("e-value")||r._tooltipTarget.hasClass("e-value-additional")||r._tooltipTarget.hasClass("e-variation-indicator")){if(!r.model.showTooltip)return;r.model.showIndicatorOnly&&r.model.hasTarget?(r._isNullOrEmptyOrUndefined(r.model.actualValue.name)||(h[r.model.actualValue.name]=(r._isNullOrEmptyOrUndefined(r.model.actualValue.customText)?"":r.model.actualValue.customText+"   ")+e),r._isNullOrEmptyOrUndefined(r.model.targetValue.name)||(h[r.model.targetValue.name]=(r._isNullOrEmptyOrUndefined(r.model.targetValue.customText)?"":r.model.targetValue.customText+"   ")+f),t.isNullOrUndefined(r.model.additionalValue)||r.model.additionalValue.value==""||(h[r.model.additionalValue.name]=o),h.Variation=u,d=r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfDifference?"Percent Of Difference":r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfTarget?"Percent Of Target":r.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?"Absolute difference":r.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?"Actual Value":"Percent of Change",h[d]=r.Value,b=r._renderingToopTipTemplate(h)):(k=null,r._isNullOrEmptyOrUndefined(r.model.actualValue.value)||r._isNullOrEmptyOrUndefined(r.model.targetValue.value)||r._isNullOrEmptyOrUndefined(r.model.additionalValue)||r._isNullOrEmptyOrUndefined(r.model.additionalValue.value)?r._isNullOrEmptyOrUndefined(r.model.actualValue.value)||r._isNullOrEmptyOrUndefined(r.model.targetValue.value)?(k="Value",r._isNullOrEmptyOrUndefined(r.model.actualValue.name)||(h[r.model.actualValue.name]=n(r.element).find(".e-value").html()),r._isNullOrEmptyOrUndefined(r.model.targetValue.name)||(h[r.model.targetValue.name]=n(r.element).find(".e-value").html()),t.isNullOrUndefined(r.model.additionalValue)||r._isNullOrEmptyOrUndefined(r.model.additionalValue.value)||(h[r.model.additionalValue.name]=o),b=r._renderingToopTipTemplate(h),w=r._measureText(b,r._tooltipTarget.width(),"Normal 14 "+r._tooltipTarget.css("font-family"))):(k="",r._isNullOrEmptyOrUndefined(r.model.actualValue.customText)||(k=r.model.actualValue.customText+"   "),h[r.model.actualValue.name]=k+e,r._isNullOrEmptyOrUndefined(r.model.targetValue.name)||(h[r.model.targetValue.name]=(r._isNullOrEmptyOrUndefined(r.model.targetValue.customText)?"":r.model.targetValue.customText+"   ")+f),t.preferredCulture(r.model.valueRepresentation.currencyCulture),h.Variation=u,d=r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfDifference?"Percent Of Difference ":r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfTarget?"Percent Of Target":r.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?"Absolute difference":r.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?"Actual Value :":"Percent of Change",h[d]=r.Value,b=r._renderingToopTipTemplate(h),p.html(b).css({visibility:"hidden",display:""}),w.width=p.width(),w.height=p.height(),p.css({visibility:"visible",display:"none"})):(k="",r._isNullOrEmptyOrUndefined(r.model.actualValue.customText)||(k=r.model.actualValue.customText+"   "),h[r.model.actualValue.name]=k+e,r._isNullOrEmptyOrUndefined(r.model.targetValue.name)||(h[r.model.targetValue.name]=(r._isNullOrEmptyOrUndefined(r.model.targetValue.customText)?"":r.model.targetValue.customText+"   ")+f),t.preferredCulture(r.model.valueRepresentation.currencyCulture),h.Variation=u,d=r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfDifference?"Percent Of Difference : ":r.model.valueRepresentation.variationType===t.Card.VariationTypes.PercentOfTarget?"Percent Of Target : ":r.model.valueRepresentation.variationType===t.Card.VariationTypes.Absolute?"Absolute difference : ":r.model.valueRepresentation.variationType===t.Card.VariationTypes.ActualValue?"Actual Value :":"Percent of Change : ",h[d]=r.Value,t.isNullOrUndefined(r.model.additionalValue)||r._isNullOrEmptyOrUndefined(r.model.additionalValue.value)||(h[r.model.additionalValue.name]=o),b=r._renderingToopTipTemplate(h),p.html(b).css({visibility:"hidden",display:""}),w.width=p.width(),w.height=p.height(),p.css({visibility:"visible",display:"none"})))}else b=r._tooltipTarget.html(),w=r._measureText(b,r._tooltipTarget.width(),"Normal 14 "+r._tooltipTarget.css("font-family"));w.width>400&&(w.width=400);p.html(b).css({top:i.clientY+w.height+l>n(window).height()?i.clientY-w.height:i.clientY+a+"px",left:i.clientX+w.width>n(window).width()?i.clientX-w.width-v+"px":i.clientX+y+"px","z-index":1e4}).fadeIn();g=t.browserInfo();g.name==="msie"&&p.css({position:"-ms-page"})},300),i.stopPropagation(),i.bubbles=!1)},_hideToolTip:function(){this._tooltipTimer&&clearTimeout(this._tooltipTimer);this._tooltipTarget=null;n("#"+this._proxy+"_toolTip").fadeOut()},_cardResize:function(t){t.preventDefault();t.stopPropagation();this.resizeTo&&clearTimeout(this.resizeTo);var i=this,r=5;this.resizeTo=setTimeout(function(){(t.bubbles=!1,i.model.enableResize)&&((i._parentWidth!==n(i.element).parent().width()||i._parentHeight!==n(i.element).parent().height())&&(i._width=n(i.element).parent().width(),i._height=n(i.element).parent().height(),n(i.element).css({width:i._width-r,height:i._height}),i._parentWidth=n(i.element).parent().width(),i._parentHeight=n(i.element).parent().height(),i._setFontSize()),i._reDrawKPI())},600)},_selectedHandler:function(t){var i=this;this.singleTimer=setTimeout(function(){var r={};i.model.selected&&(r={name:i.element.attr("id"),targetValue:i.model.targetValue,actualValue:i.model.actualValue,currentTarget:n("#"+i._proxy),currentValue:i.model.customHeader.value!==""?i.model.customHeader.value:i.model.actualValue.text+" vs "+i.model.targetValue.text,ctrlKey:t.ctrlKey},i._trigger("selected",r),t.stopPropagation(),t.bubbles=!1)},400)},_doubleClickHandler:function(t){clearTimeout(this.singleTimer);var i={};i={name:this.element.attr("id"),targetValue:this.model.targetValue,actualValue:this.model.actualValue,currentTarget:n("#"+this._proxy),currentValue:this.model.customHeader.value!==""?this.model.customHeader.value:this.model.actualValue.text+" vs "+this.model.targetValue.text,ctrlKey:t.ctrlKey,type:t.type};this._trigger("doubleClick",i)},_rightClickHandler:function(t){var i={};this.model.enableRightClick&&(i={name:this.element.attr("id"),targetValue:this.model.targetValue,actualValue:this.model.actualValue,currentTarget:n("#"+this._proxy),currentValue:this.model.customHeader.value!==""?this.model.customHeader.value:this.model.actualValue.text+" vs "+this.model.targetValue.text,ctrlKey:t.ctrlKey,type:t.type},this._trigger("rightClick",i))}});t.Card.Format={Number:"number",Currency:"currency",Percentage:"percentage"};t.Card.AbbreviationTypes={Auto:"auto",Ones:"ones",Thousands:"thousands",Lakhs:"lakhs",Millions:"millions",Crores:"crores",Billions:"billions"};t.Card.VariationTypes={Absolute:"absolute",PercentOfDifference:"percentofdifference",PercentOfTarget:"percentoftarget",ActualValue:"actualvalue",PercentOfChange:"percentofchange"};t.Card.BackgroundType={None:"none",Full:"fullbackground",Image:"image"};t.Card.TextAlign={Right:"right",Centre:"center",Left:"left"};t.Card.BrowserType={IE:"Internet Explorer",Chrome:"Google Chrome",FireFox:"Mozilla FireFox"};t.Card.AdjustFont={Height:"height",Width:"width",Both:"both"};t.Card.SecondaryValueType={Variance:"variance",Target:"target"};t.Card.NegativeValueFormat={Default:"default",NoNegativeSignWithBracket:"nonegativesignwithbracket",NegativeSignInSuffix:"negativesigninsuffix"}}(bbdesigner$,SyncfusionBoldBIDashboard);__extends=this&&this.__extends||function(n,t){function r(){this.constructor=n}for(var i in t)t.hasOwnProperty(i)&&(n[i]=t[i]);n.prototype=t===null?Object.create(t):(r.prototype=t.prototype,new r)},function(n){var t,i;(function(n){n[n.Line="line"]="Line";n[n.Column="column"]="Column";n[n.Area="area"]="Area";n[n.WinLoss="winloss"]="WinLoss";n[n.Pie="pie"]="Pie"})(n.Type||(n.Type={}));t=n.Type,function(n){n[n.flatlight="flatlight"]="flatlight";n[n.azurelight="azurelight"]="azurelight";n[n.limelight="limelight"]="limelight";n[n.saffronlight="saffronlight"]="saffronlight";n[n.gradientlight="gradientlight"]="gradientlight";n[n.flatdark="flatdark"]="flatdark";n[n.azuredark="azuredark"]="azuredark";n[n.limedark="limedark"]="limedark";n[n.saffrondark="saffrondark"]="saffrondark";n[n.gradientdark="gradientdark"]="gradientdark"}(n.Themes||(n.Themes={}));i=n.Themes,function(){var r=function(r){function u(u,f){r.call(this);this.defaults={locale:null,enableGroupSeparator:!1,enableCanvasRendering:!1,padding:8,palette:["#8A2BE2","#ff1a75","#99cc00","#4d4dff","#660066","#FFA500","#FFD700","#FF00FF","#808000","#990000"],isResponsive:!0,dataSource:null,xName:"",yName:"",type:t.Line,width:1,stroke:null,opacity:1,fill:"#33ccff",border:{color:"transparent",width:1},rangeBandSettings:{startRange:null,endRange:null,opacity:.4,color:"transparent"},highPointColor:null,lowPointColor:null,negativePointColor:null,startPointColor:null,endPointColor:null,tooltip:{visible:!1,template:null,fill:"white",border:{width:1,color:null},font:{fontFamily:"Segoe UI",fontStyle:"Normal",fontWeight:"Regular",color:"#111111",opacity:1,size:"8px"}},markerSettings:{visible:!1,fill:null,width:2,opacity:1,border:{color:"white",width:1}},background:"transparent",size:{height:"",width:""},axisLineSettings:{visible:!1,color:"#111111",width:1,dashArray:""},theme:i.flatlight,load:null,loaded:null,doubleClick:null,rightClick:null,click:null,sparklineMouseMove:null,sparklineMouseLeave:null,seriesRendering:null,pointRegionMouseMove:null,pointRegionMouseClick:null,tooltipInitialize:null};this.dataTypes={dataSource:"data",palette:"array",type:"enum",theme:"enum"};this.model=null;this.svgLink="http://www.w3.org/2000/svg";this._id=null;this.negativePointIndexes=[];this.validTags=["div"];this._id=u;!f||(this.model=n.compareExtend({},f,this.defaults))}return __extends(u,r),u.prototype.isTouch=function(n){var t=n.originalEvent?n.originalEvent:n;return t.pointerType=="touch"||t.pointerType==2||t.type.indexOf("touch")>-1?!0:!1},u.prototype.browserInfo=function(){var n={},t=[],i={webkit:/(chrome)[ \/]([\w.]+)/i,safari:/(webkit)[ \/]([\w.]+)/i,msie:/(msie) ([\w.]+)/i,opera:/(opera)(?:.*version|)[ \/]([\w.]+)/i,mozilla:/(mozilla)(?:.*? rv:([\w.]+)|)/i};for(var r in i)if(i.hasOwnProperty(r)&&(t=navigator.userAgent.match(i[r]),t)){n.name=t[1].toLowerCase();n.version=t[2];!navigator.userAgent.match(/Trident\/7\./)||(n.name="msie");break}return n.isMSPointerEnabled=n.name=="msie"&&n.version>9&&window.navigator.msPointerEnabled,n.pointerEnabled=window.navigator.pointerEnabled,n},u.prototype.fadeOut=function(n){var t=1,i=setInterval(function(){t<=.1&&(clearInterval(i),n.parentNode?n.parentNode.removeChild(n):n);n.style.opacity=t;n.style.filter="alpha(opacity="+t*100+")";t-=t*.1},50)},u.prototype._setModel=function(t){var i;for(i in t)switch(i){default:n.deepExtend(!0,this.model,{},t[i])}this.redraw()},u.prototype.unBindEvents=function(){var t=document.getElementById(this.rootId),n="",i=this.browserInfo(),r=i.isMSPointerEnabled,u=i.pointerEnabled,e=r?u?"pointerup":"MSPointerUp":"touchend mouseup",o=r?u?"pointermove":"MSPointerMove":"touchmove mousemove",f;n=e+" "+o;n=n.split(" ");for(f in n)t.removeEventListener(n[f],this.sparkMouseMove);t.removeEventListener("mouseout",this.sparkMouseLeave)},u.prototype.bindClickEvents=function(n){this.sparkClick=this.sparkClick.bind(this);BoldBIDashboard.isTouchDevice()?(this.sparkTouchStart=this.sparkTouchStart.bind(this),n.addEventListener("touchend",this.sparkClick),n.addEventListener("touchstart",this.sparkTouchStart)):(this.sparkDoubleClick=this.sparkDoubleClick.bind(this),this.sparkRightClick=this.sparkRightClick.bind(this),n.addEventListener("click",this.sparkClick),n.addEventListener("dblclick",this.sparkDoubleClick),n.addEventListener("contextmenu",this.sparkRightClick))},u.prototype.unBindClickEvents=function(n){BoldBIDashboard.isTouchDevice()?(n.removeEventListener("touchend",this.sparkClick),n.removeEventListener("touchstart",this.sparkTouchStart)):(n.removeEventListener("click",this.sparkClick),n.removeEventListener("dblclick",this.sparkDoubleClick),n.removeEventListener("contextmenu",this.sparkRightClick))},u.prototype.bindEvents=function(n){var f;this.sparkMouseMove=this.sparkMouseMove.bind(this);this.sparkMouseLeave=this.sparkMouseLeave.bind(this);var t="",i=this.browserInfo(),r=i.isMSPointerEnabled,u=i.pointerEnabled,e=r?u?"pointerup":"MSPointerUp":"touchend mouseup",o=r?u?"pointermove":"MSPointerMove":"touchmove mousemove";t=e+" "+o;t=t.split(" ");for(f in t)n.addEventListener(t[f],this.sparkMouseMove);n.addEventListener("mouseout",this.sparkMouseLeave)},u.prototype.sparkTouchStart=function(){this._longPressTimer=new Date},u.prototype.sparkClick=function(n){var t=new Date;this.model.click!=null&&this._trigger("click",{data:{event:n}});BoldBIDashboard.isTouchDevice()&&n.type!="click"&&(this._doubleTapTimer!=null&&t-this._doubleTapTimer<300&&this.sparkDoubleClick(n),this._doubleTapTimer=t,this._longPressTimer!=null&&t-this._longPressTimer>1e3&&this.sparkRightClick(n))},u.prototype.sparkDoubleClick=function(n){this.model.doubleClick!=null&&this._trigger("doubleClick",{data:{event:n}})},u.prototype.sparkRightClick=function(n){this.model.rightClick!=null&&this._trigger("rightClick",{data:{event:n}})},u.prototype.sparkMouseMove=function(n){var hi=this.isTouch(n),ft,oi,ki,wt,si,nr,ni,ti,y,bt,v,it,gt,et;if(!(hi&&n.type.toString().toLowerCase().indexOf("move")>-1)){var t=this.model,ot=this,ii=t.locale,ci=ii&&t.enableGroupSeparator,li,ai,ri=this.visiblePoints,vi=this.container.id+"_markerExplode",p,rt,h,ut,s,d,ct=t.enableCanvasRendering?0:3,lt="",l,f,a,u,g,ui=parseInt(t.size.height),st=parseInt(t.size.width),o=t.tooltip.font,w=this.container.id+"_tooltip",tr=document.getElementById(w),yi,nt=t.tooltip.border.color,at=document.getElementById(this.container.id),or=at.clientHeight,sr=at.parentNode,b=at.getClientRects()[0],vt=b.top,yt=b.left,fi=n.clientX||(n.changedTouches?n.changedTouches[0].clientX:n.touches?n.touches[0].clientX:0),pi=n.clientY||(n.changedTouches?n.changedTouches[0].clientY:n.touches?n.touches[0].clientY:0),ei=ri.map(function(n){return n.location.X+b.left}),hr=ri.map(function(n){return n.location.markerPos+b.top}),i=Infinity,ht=this.measureText,wi,c=this.model.markerSettings,pt,tt,k,bi,r,e,ir=document.getElementById(this.container.id+"_canvasTracker");for(ft=0,ki=ei.length;ft<ki;ft++)oi=Math.abs(fi-ei[ft]),i>oi&&(i=oi,pt=ei[ft],this.pointIndex=ft);if(fi>yt&&fi<yt+b.width&&pi>vt&&pi<vt+b.height)if(i=ri[this.pointIndex].location,wt=function(n){wi=n.length/2;var u=ht(n,o);l=u.height+4;f=u.width+wi;r=i.X;e=i.markerPos;e-l/2<0?e+=l/2:e+l/2>ui&&(e-=l/2);r+f+f/10>st-t.padding?(r=i.X-Number(t.markerSettings.width)-Number(t.markerSettings.border.width)-4,lt="M "+r+" "+i.markerPos+" L "+(r-f/10)+" "+(e-4)+" L "+(r-f/10)+" "+(e-l/2)+" L "+(r-f-f/10)+" "+(e-l/2)+" L "+(r-f-f/10)+" "+(e+l/2)+" L "+(r-f/10)+" "+(e+l/2)+" L "+(r-f/10)+" "+(e+4)+" Z"):(r=i.X+Number(t.markerSettings.width)+Number(t.markerSettings.border.width)+4,lt="M "+r+" "+i.markerPos+" L "+(r+f/10)+" "+(e-4)+" L "+(r+f/10)+" "+(e-l/2)+" L "+(r+f+f/10)+" "+(e-l/2)+" L "+(r+f+f/10)+" "+(e+l/2)+" L "+(r+f/10)+" "+(e+l/2)+" L "+(r+f/10)+" "+(e+4)+" Z")},(t.tooltip.template==null||t.tooltip.template=="")&&(li=ci&&i.Xval?i.Xval.toLocaleString(ii):i.Xval,ai=ci&&i.Yval?i.Yval.toLocaleString(ii):i.Yval,h=" X : "+li+" Y : "+ai+" ",wt(h)),p=this.pointIndex,this.prevMousePos==undefined&&(this.prevMousePos=pt),si=function(n){var i=ot.highPointIndex,r=ot.lowPointIndex,u=ot.negativePointIndexes,f=ot.startPointIndex,e=ot.endPointIndex;return n==i?t.highPointColor:n==r?t.lowPointColor:n==f&&t.startPointColor!=null?t.startPointColor:n==e&&t.endPointColor!=null?t.endPointColor:u.indexOf(n)>=0&&t.negativePointColor!=null?t.negativePointColor:c.fill?c.fill:t.fill},tr||ir){if(this.prevMousePos!=pt){if(this.prevMousePos=pt,g=si(p),ut={id:vi,cx:i.X,cy:i.markerPos,r:Number(c.width),fill:c.border.color,stroke:g,"stroke-width":Number(c.border.width)},t.tooltip.template==null||t.tooltip.template=="")s={id:w,fill:t.tooltip.fill,stroke:nt!=null?nt:g,"stroke-width":t.tooltip.border.width,d:lt,"pointer-events":"none"},d={x:i.X+f+f/10>st-t.padding?r+ct-f-f/10:r+ct+f/10,y:e+l/4,fill:o.color,"font-size":o.size,"font-family":o.fontFamily,"font-weight":o.fontWeight,"font-style":o.fontStyle};else{y=document.getElementById(t.tooltip.template);bt=y.innerHTML;typeof t.dataSource[p]=="object"?(v=t.dataSource[p],v.x=i.Xval,v.y=i.Yval,v.display="block"):v={x:i.Xval,y:i.Yval};var kt={point:v},bt=this.parseTemplate(y,kt),di=y.innerText,dt=Number(t.markerSettings.width),di=this.parseTemplate(y,kt),rr=ht(di,o),gi=i.X+Number(c.width)+Number(c.border.width)+dt;e=vt+i.markerPos-rr.height/2;r=yt+gi;s={background:t.tooltip.fill,border:t.tooltip.border.width+"px solid "+(nt!=null?nt:g),left:r+"px",top:e+"px","pointer-events":"none"};u=document.getElementById(w);u.innerHTML=bt;this.setStyles(s,u);it=ht(u.textContent,o).width+u.textContent.length/2;gi+it>st-t.padding&&(r=r-it-(Number(c.width)+Number(c.border.width)+dt)*2,s.left=r+"px",console.log(u.offsetWidth),this.setStyles(s,u),BoldBIDashboard.isNullOrUndefined(u.childNodes)||(gt=u.childNodes[0].offsetWidth,nr=gt-it,s.left=r-nr+"px",this.setStyles(s,u)));i.markerPos-u.offsetHeight<t.padding?(e=e-u.offsetHeight/2,s.top=e+"px",this.setStyles(s,u)):i.markerPos+u.offsetHeight>ui-t.padding&&(e=e-u.offsetHeight/2,s.top=e+"px",this.setStyles(s,u))}a={data:{pointIndex:p,currentText:h,location:i}};this.model.tooltipInitialize!=null&&this._trigger("tooltipInitialize",a);yi=i.X-t.width/2;h==a.data.currentText||a.cancel||(h=a.data.currentText,t.tooltip.template==null?wt(h):(u.innerText=a.data.currentText,h=u.innerText));t.enableCanvasRendering?(tt=document.getElementById(this.container.id+"_canvasTracker"),k=tt.getContext("2d"),k.clearRect(0,0,st,ui),this.canvasDrawCircle(ut,k),(t.tooltip.template==null||t.tooltip.template=="")&&(this.canvasDrawPath(s,k),d.font=o.size+" "+o.fontFamily,this.canvasDrawText(d,h,k))):(ni=document.getElementById(w+"_g"),this.drawCircle(ut,ni),t.tooltip.template==null&&(this.drawPath(s,ni),rt=at.getElementsByTagName("text")[0],rt.textContent=h,this.setAttributes(d,rt),ni.appendChild(rt)))}}else{if(ti=document.getElementsByClassName("ej-sparkline-tooltip"),ti[0]&&ti[0].parentNode.removeChild(ti[0]),g=si(p),ut={id:vi,cx:i.X,cy:i.markerPos,r:Number(c.width),fill:c.border.color,stroke:g,"stroke-width":Number(c.border.width)},t.tooltip.template==null||t.tooltip.template=="")s={id:w,fill:t.tooltip.fill,stroke:nt!=null?nt:g,"stroke-width":t.tooltip.border.width,d:lt,"pointer-events":"none"},d={x:i.X+f+f/10>st-t.padding?r+ct-f-f/10:r+ct+f/10,y:e+l/4,fill:o.color,opacity:o.opacity,"font-size":o.size,"font-family":o.fontFamily,"font-weight":o.fontWeight,"font-style":o.fontStyle};else{y=document.getElementById(t.tooltip.template);bt=y.innerHTML;typeof t.dataSource[p]=="object"?(v=t.dataSource[p],v.x=i.Xval,v.y=i.Yval,v.display="block"):v={x:i.Xval,y:i.Yval};var kt={point:v},bt=this.parseTemplate(y,kt),di=y.innerText,dt=Number(t.markerSettings.width),di=this.parseTemplate(y,kt),rr=ht(di,o),gi=i.X+Number(c.width)+Number(c.border.width)+dt;e=n.pageY;r=n.pageX+10;s={background:t.tooltip.fill,border:t.tooltip.border.width+"px solid "+(nt!=null?nt:g),left:r+"px",top:e+"px",position:"fixed",height:"auto",width:"auto",display:"block",opacity:o.opacity,font:o.size+" "+o.fontFamily,"pointer-events":"none"};u=document.createElement("div");this.setAttributes({id:w,"class":"ej-sparkline-tooltip"},u);this.setStyles(s,u);u.innerHTML=bt;document.body.appendChild(u);it=ht(u.textContent,o).width+u.textContent.length/2;padding=10;u.offsetWidth<b.width&&r+it>b.x+b.width&&(s.left=r-it+"px",this.setStyles(s,u),BoldBIDashboard.isNullOrUndefined(u.childNodes)||(gt=u.childNodes[0].offsetWidth,s.left=r-gt-(Number(c.width)+Number(c.border.width)+dt)-padding+"px",this.setStyles(s,u)))}a={data:{pointIndex:p,currentText:h,location:i}};this.model.tooltipInitialize!=null&&this._trigger("tooltipInitialize",a);yi=i.X-t.width/2;h==a.data.currentText||a.cancel||(h=a.data.currentText,t.tooltip.template==null?wt(h):(u.innerText=a.data.currentText,h=u.innerText));t.enableCanvasRendering?(tt=document.createElement("canvas"),bi={id:this.container.id+"_canvasTracker",fill:"transparent","class":"ej-sparkline-tooltip",height:t.size.height,width:t.size.width},this.setAttributes(bi,tt),this.setStyles({left:yt+"px",top:vt+"px",position:"fixed"},tt),k=tt.getContext("2d"),this.canvasDrawCircle(ut,k),(t.tooltip.template==null||t.tooltip.template=="")&&(this.canvasDrawPath(s,k),d.font=o.size+" "+o.fontFamily,this.canvasDrawText(d,h,k)),this.container.parentNode.appendChild(tt)):(et=document.createElementNS(this.svgLink,"g"),this.setAttributes({id:w+"_g","class":"ej-sparkline-tooltip"},et),this.container.appendChild(et),this.drawCircle(ut,et),t.tooltip.template==null&&(this.drawPath(s,et),rt=this.createText(d,h),et.appendChild(rt)))}if(hi){var ur=t.tooltip.template==null||t.tooltip.template==""?t.enableCanvasRendering?this.container.id+"_canvasTracker":w+"_g":w,fr=document.getElementById(ur),er=this;setTimeout(function(){er.fadeOut(fr)},1e3)}}},u.prototype.sparkMouseLeave=function(n){var s=n.clientX||(n.touches[0]?n.touches[0].clientX:n.changedTouches[0].clientX),h=n.clientY||(n.touches[0]?n.touches[0].clientY:n.changedTouches[0].clientY),e=this.container,y=e.clientHeight,u=e.getClientRects()[0],c=u.top,l=u.left,a=this.model,o=this.container.id+"_tooltip",t=e.getClientRects()[0],i,v,f,r;a.tooltip.template!=null&&a.tooltip.template!=""&&(n.pageX<t.top||n.pageX>t.top+t.width||n.pageY<t.left||n.pageY>t.left+t.height?(i=document.getElementById(o),i?document.body.removeChild(i):i):(n.pageX<t.top||n.pageX>t.top+t.width||n.pageY<t.left||n.currentTarget.id==this._id)&&t.height<=20&&(i=document.getElementById(o),i?document.body.removeChild(i):i));(s<l||s>l+u.width||h<c||h>c+u.height||this.touchEnd)&&(this.model.enableCanvasRendering?(r=document.getElementById(this.container.id+"_canvasTracker"),r?r.parentNode.removeChild(r):r):(v=o+"_g",f=document.getElementById(v),f?this.container.removeChild(f):f))},u.prototype.bindPieEvents=function(n){var f;this.pieTooltip=this.pieTooltip.bind(this);this.pieTooltipHide=this.pieTooltipHide.bind(this);var t="",i=this.browserInfo(),r=i.isMSPointerEnabled,u=i.pointerEnabled,e=r?u?"pointerup":"MSPointerUp":"touchend mouseup",o=r?u?"pointermove":"MSPointerMove":"touchmove mousemove";t=e+" "+o;t=t.split(" ");for(f in t)n.addEventListener(t[f],this.pieTooltip);n.addEventListener("mouseout",this.pieTooltipHide);this.model.pointRegionMouseClick!=null&&(n.addEventListener("click",this.pieTooltip),n.addEventListener("touchstart",this.pieTooltip))},u.prototype.unbindPieEvents=function(){var n="",t=this.browserInfo(),i=t.isMSPointerEnabled,r=t.pointerEnabled,e=i?r?"pointerup":"MSPointerUp":"touchend mouseup",o=i?r?"pointermove":"MSPointerMove":"touchmove mousemove",u=document.getElementById(this.rootId),f;n=e+" "+o;n=n.split(" ");for(f in n)u.removeEventListener(n[f],this.pieTooltip);u.removeEventListener("mouseout",this.pieTooltipHide)},u.prototype.pieTooltip=function(n){var y=this.isTouch(n),e,ot,i,s,st,ht;if(y&&n.stopImmediatePropagation(),!(y&&n.type.toString().toLowerCase().indexOf("move")>-1)){this.model.sparklineMouseMove!=null&&this._trigger("sparklineMouseMove");var t=this.model,h=n.clientX||(n.changedTouches?n.changedTouches[0].clientX:n.touches?n.touches[0].clientX:0),yt=parseInt(t.size.height),pt=parseInt(t.size.width),u=t.tooltip.font,c=n.clientY||(n.changedTouches?n.changedTouches[0].clientY:n.touches?n.touches[0].clientY:0),d=document.getElementById(this.container.id),wt=d.parentNode,g=d.getClientRects()[0],ct=g.top,lt=g.left,bt=this.visiblePoints.map(function(n){return n.coordinates}),nt=this.visiblePoints.map(function(n){return n.location}),at=this.visiblePoints.radius,tt=this.visiblePoints.centerPos,p=this.visiblePoints,it,rt,f,w=h-(tt.X+lt),b=c-(tt.Y+ct),o=Math.atan2(b,w),ut=this.container.id+"_pieTooltip",r=document.getElementById(ut),l,a=t.tooltip.border.color,vt=Math.sqrt(w*w+b*b),k=t.pointRegionMouseClick!=null?"pointRegionMouseClick":t.pointRegionMouseMove!=null?"pointRegionMouseMove":null,v=t.palette,ft=t.locale,et=t.enableGroupSeparator;if(Math.abs(vt)<=at)for(e=0,ot=p.length;e<ot;e++)it=p[e].stAng,rt=p[e].endAng,o=o<0?6.283+o:o,o<=rt&&o>=it&&(f=e,(k=="pointRegionMouseClick"&&(n.type=="click"||n.type=="touchstart")||k=="pointRegionMouseMove")&&this._trigger(k,{data:{pointIndex:e,seriesType:"Pie",locationX:h,locationY:c}}));else r&&r.parentNode.removeChild(r);r&&f!=null?(i=nt[f].Percent.toFixed(2),i=et?"&nbsp"+parseFloat(i).toLocaleString(ft):i+"&nbsp%&nbsp",s=this.measureText(i,u),l={left:h+12+"px",top:c+"px",border:t.tooltip.border.width+"px solid "+(a!=null?a:v[f%v.length]),"background-color":t.tooltip.fill,height:s.height+"px",width:s.width+"px"},this.setStyles(l,r),r.innerHTML=i):f!=null&&(r=document.createElement("div"),i=nt[f].Percent.toFixed(2),i=et?"&nbsp"+parseFloat(i).toLocaleString(ft):i+"&nbsp%&nbsp",s=this.measureText(i,u),l={left:h+12+"px",top:c+"px","background-color":t.tooltip.fill,color:u.color,border:t.tooltip.border.width+"px solid "+(a!=null?a:v[f%v.length]),height:s.height+"px",width:s.width+"px","font-size":u.size,opacity:u.opacity,"font-weight":u.fontWeight,"font-family":u.fontFamily,"font-style":u.fontStyle,"z-index":"100000",position:"fixed"},r.setAttribute("id",ut),this.setStyles(l,r),r.innerHTML=i,document.body.appendChild(r));y&&(this.touchEnd=!0,st=document.getElementById(this.container.id+"_pieTooltip"),ht=this,setTimeout(function(){ht.fadeOut(st)},500))}},u.prototype.pieTooltipHide=function(){if(!this.touchEnd){this.model.sparklineMouseLeave!=null&&this._trigger("sparklineMouseLeave");var t=this.container.id+"_pieTooltip",n=document.getElementById(t);n?document.body.removeChild(n):n}},u.prototype.bindRegionEvents=function(n){this.sparklineEvent=this.sparklineEvent.bind(this);var t=this.findBrowser();(t=="IE"||t=="firefox")&&(n.style["touch-action"]="none");this.model.pointRegionMouseMove!=null&&(n.addEventListener("mousemove",this.sparklineEvent,!0),n.addEventListener("touchmove",this.sparklineEvent,!0));this.model.pointRegionMouseClick!=null&&(n.addEventListener("click",this.sparklineEvent,!0),n.addEventListener("touchstart",this.sparklineEvent,!0));this.model.sparklineMouseMove!=null&&(n.addEventListener("mousemove",this.sparklineEvent,!0),n.addEventListener("touchmove",this.sparklineEvent,!0));this.model.sparklineMouseLeave!=null&&(this.sparklineLeave=this.sparklineLeave.bind(this),n.addEventListener("mouseout",this.sparklineLeave,!0),t=="firefox"&&n.addEventListener("mouseup",this.sparklineLeave,!0),n.addEventListener("touchend",this.sparklineLeave,!0))},u.prototype.sparklineLeave=function(){this.model.sparklineMouseLeave!=null&&this._trigger("sparklineMouseLeave")},u.prototype.sparklineEvent=function(n){var i,p;this.model.sparklineMouseMove!=null&&this._trigger("sparklineMouseMove");var s=this.model,l=n.clientX||n.touches[0].clientX,a=n.clientY||n.touches[0].clientY,f=s.type,r=this.visiblePoints,e,o,v,y,u,h,w=document.getElementById(this.container.id),g=w.parentNode,b=w.getClientRects()[0],k=b.top,d=b.left,c;if(c=s.pointRegionMouseClick!=null?"pointRegionMouseClick":s.pointRegionMouseMove!=null?"pointRegionMouseMove":null,f==t.Line||f==t.Area)for(u=2*(s.markerSettings.width+s.markerSettings.border.width),h=u,i=0,p=r.length;i<p;i++)e=d+r[i].location.X-u/2,o=k+r[i].location.Y-h/2,v=e+u,y=o+h,l>=e&&l<=v&&a>=o&&a<=y&&c!=null&&this._trigger(c,{data:{pointIndex:i,seriesType:f,locationX:r[i].location.X,locationY:r[i].location.Y}});else if(f==t.Column||f==t.WinLoss)for(u=r[0].location.width,i=0,p=r.length;i<p;i++)h=r[i].location.height,e=d+r[i].location.X-u/2,o=k+r[i].location.Y,v=e+u,y=o+h,l>=e&&l<=v&&a>=o&&a<=y&&c!=null&&this._trigger(c,{data:{pointIndex:i,seriesType:f,locationX:r[i].location.X,locationY:r[i].location.Y}})},u.prototype.findBrowser=function(){return navigator.userAgent.indexOf("Firefox")!=-1?"firefox":navigator.userAgent.indexOf("MSIE")!=-1||!!document.documentMode==!0?"IE":null},u.prototype.resize=function(){var t=this,n=document.getElementById(this.rootId);n!=null||n!=undefined?(window.removeEventListener("resize",this.resize),this.isResized=!0,this._destroy(),this.createSvg(),this.renderSparkline(),this.isResized=!1):window.removeEventListener("resize",this.resize)},u.prototype.supportsSvg=function(){return!!document.createElementNS&&!!document.createElementNS("http://www.w3.org/2000/svg","svg")},u.prototype._init=function(){this.supportsSvg()&&(this.rootId=this.rootId!=null?this.rootId:this._id,this.parentElement=this.parentElement!=null?this.parentElement:document.getElementById(this.rootId),this.model.load!=null&&this._trigger("load"),this.setTheme(this.model),this.height=parseInt(this.model.size.height),this.width=parseInt(this.model.size.width),this.createSvg(),this.renderSparkline(),this.model.loaded!=null&&this._trigger("loaded"))},u.prototype.redraw=function(){this.emptyContainer();var n={width:this.model.size.width,height:this.model.size.height};this.setAttributes(n,this.container);this.renderSparkline();this.model.loaded!=null&&this._trigger("loaded")},u.prototype.touchCheck=function(n){this.touchEnd=!0;this.model.type.toString().toLocaleLowerCase()!="pie"?this.sparkMouseLeave(n):this.pieTooltipHide(n)},u.prototype.emptyContainer=function(){var t=this.model,n;if(t.enableCanvasRendering)this.ctx.clearRect(0,0,this.height,this.width);else for(n=this.container;n.firstChild;)n.removeChild(n.firstChild)},u.prototype._destroy=function(){var n=document.getElementById(this.container.id);n!=null?(this.unBindEvents(),this.unbindPieEvents(),window.removeEventListener("resize",this.resize),n.parentNode.removeChild(n)):window.removeEventListener("resize",this.resize)},u.prototype.renderSparkline=function(){this.setStyles({background:this.model.background},this.container);this.calculatePoints();this.seriesRender();this.resize=this.resize.bind(this);this.model.isResponsive?window.addEventListener("resize",this.resize):window.removeEventListener("resize",this.resize);this.model.type!=t.WinLoss&&this.model.type!=t.Pie&&this.model.tooltip.visible?this.bindEvents(this.parentElement):this.unBindEvents();this.model.type==t.Pie&&this.model.tooltip.visible?this.bindPieEvents(this.parentElement):this.unbindPieEvents();this.bindRegionEvents(this.parentElement);this.unBindClickEvents(this.parentElement);this.bindClickEvents(this.parentElement)},u.prototype.animateSparkline=function(){function ht(){n<=a?r.setAttribute("width",n.toString()):(clearInterval(it),h._trigger("animationComplete"));n=n+i}function ct(){f=u-n;n>=0?(r.setAttribute("y",n.toString()),r.setAttribute("height",f)):(clearInterval(ut),h._trigger("animationComplete"));n=n-i}function lt(){n<=u?r.setAttribute("height",n.toString()):(clearInterval(rt),h._trigger("animationComplete"));n=n+i}function at(){f=(l-n)*2;n>=-i?(r.setAttribute("y",n<0?0:n.toString()),r.setAttribute("height",f)):(clearInterval(ft),h._trigger("animationComplete"));n=n-i}function vt(){n<=v.length-1?(d=90,et=v[n].location.Degree,ot+=et+(n==0?d:0),b=(d-90)*Math.PI/180,p=(ot-90)*Math.PI/180,n==v.length-1&&(p-=.0001),f={sX:o.X+s*Math.cos(b),sY:o.Y+s*Math.sin(b),eX:o.X+s*Math.cos(p),eY:o.Y+s*Math.sin(p)},k="M "+o.X+" "+o.Y+" L "+f.eX+" "+f.eY+" A "+s+" "+s+" 0 1,0 "+f.sX+" "+f.sY+" Z",r.setAttribute("d",k)):(clearInterval(st),h._trigger("animationComplete"));n+=1}var y=this.model,h=this,c=y.type,g=y.padding,l=this.axisHeight,a=parseInt(y.size.width),u=parseInt(y.size.height),n,f,i,nt=document.createElementNS(this.svgLink,"defs"),w=document.createElementNS(this.svgLink,"clipPath"),e,tt,r,it,rt,ut,ft,st;if(r=c==t.Pie?document.createElementNS(this.svgLink,"path"):document.createElementNS(this.svgLink,"rect"),c==t.Line||c==t.Area)e={id:"clipRectSparkline",x:0,y:0,width:0,height:u},i=a/10,it=setInterval(ht,120),n=i;else if(c==t.Column||c==t.WinLoss)l==g?(e={id:"clipRectSparkline",x:0,y:0,width:a,height:0},i=u/10,n=i,rt=setInterval(lt,120)):l==u-g?(e={id:"clipRectSparkline",x:0,y:u,width:a,height:0},i=u/10,n=u,ut=setInterval(ct,120)):(e={id:"clipRectSparkline",x:0,y:l,width:a,height:0},i=u/10,n=l,ft=setInterval(at,120));else{var v=this.visiblePoints,o=v.centerPos,s=v.radius,et,b,p,k="",d=90,ot=0;n=0;e={id:"clipRectSparkline",d:k};st=setInterval(vt,120)}tt={id:this.container.id+"_sparklineRect"};this.setAttributes(e,r);this.setAttributes(tt,w);w.appendChild(r);nt.appendChild(w);this.container.appendChild(nt)},u.prototype.setTheme=function(n){var r=n.theme,t=this.defaults;r==i.flatdark?(n.background=n.background==t.background?"#111111":n.background,n.fill=n.fill==t.fill?"#B5B5B5":n.fill,n.stroke=n.stroke==t.stroke?"#F6D321":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#AAAAAA":n.axisLineSettings.color):r==i.gradientlight?(n.background=n.background==t.background?"transparent":n.background,n.fill=n.fill==t.fill?"#F34649":n.fill,n.stroke=n.stroke==t.stroke?"#597B15":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#8E8E8E":n.axisLineSettings.color):r==i.gradientdark?(n.background=n.background==t.background?"#111111":n.background,n.fill=n.fill==t.fill?"#005378":n.fill,n.stroke=n.stroke==t.stroke?"#6A9319":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#AAAAAA":n.axisLineSettings.color):r==i.azuredark?(n.background=n.background==t.background?"#111111":n.background,n.fill=n.fill==t.fill?"#007fff":n.fill,n.stroke=n.stroke==t.stroke?"#f0ffff":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#336699":n.axisLineSettings.color):r==i.azurelight?(n.background=n.background==t.background?"transparent":n.background,n.fill=n.fill==t.fill?"#336699":n.fill,n.stroke=n.stroke==t.stroke?"#007fff":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#336699":n.axisLineSettings.color):r==i.limedark?(n.background=n.background==t.background?"#111111":n.background,n.fill=n.fill==t.fill?"#238f23":n.fill,n.stroke=n.stroke==t.stroke?"#32CD32":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#43da21":n.axisLineSettings.color):r==i.limelight?(n.background=n.background==t.background?"transparent":n.background,n.fill=n.fill==t.fill?"#238f23":n.fill,n.stroke=n.stroke==t.stroke?"#32CD32":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#43da21":n.axisLineSettings.color):r==i.saffrondark?(n.background=n.background==t.background?"#111111":n.background,n.fill=n.fill==t.fill?"#ffaa33":n.fill,n.stroke=n.stroke==t.stroke?"#ffdba9":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#ffc26e":n.axisLineSettings.color):r==i.saffronlight?(n.background=n.background==t.background?"transparent":n.background,n.fill=n.fill==t.fill?"#ffaa33":n.fill,n.stroke=n.stroke==t.stroke?"#ffdba9":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#ffc26e":n.axisLineSettings.color):(r==null||r==i.flatlight)&&(n.background=n.background==t.background?"transparent":n.background,n.fill=n.fill==t.fill?"#33ccff":n.fill,n.stroke=n.stroke==t.stroke?"#33ccff":n.stroke,n.axisLineSettings.color=n.axisLineSettings.color==t.axisLineSettings.color?"#FF0000":n.axisLineSettings.color)},u.prototype.createSvg=function(){var i=this.model,t=this.parentElement.clientWidth>0?this.parentElement:this.parentElement.parentElement,e,u=parseInt(t.style.height)>t.clientHeight?parseInt(t.style.height):t.clientHeight,f=parseInt(t.style.width)>t.clientWidth?parseInt(t.style.width):t.clientWidth,n=i.size.width==""?f:parseInt(i.size.width),r=i.size.height==""?u:parseInt(i.size.height);r=r>0?r:u>0?u:30;n=this.model.isResponsive&&this.isResized?f>0?f:n:n;n=n<=0?50:n;i.size.height=r.toString();i.size.width=n.toString();this.height=r;this.width=n;e={id:this.rootId+"_sparkline_svg",width:n,height:r};i.enableCanvasRendering?(this.container=document.createElement("canvas"),this.ctx=this.container.getContext("2d")):this.container=document.createElementNS(this.svgLink,"svg");this.setAttributes(e,this.container);this.parentElement.appendChild(this.container)},u.prototype.setStyles=function(n,t){for(var r=Object.keys(n),u,f=r.map(function(t){return n[t]}),i=0,e=r.length;i<e;i++)u=r[i],t.style[u]=f[i]},u.prototype.setAttributes=function(n,t){for(var r=Object.keys(n),u=r.map(function(t){return n[t]}),i=0,f=r.length;i<f;i++)t.setAttribute(r[i],u[i])},u.prototype.getDefaultPoints=function(n){for(var t=[],i=1;i<=n;i++)Math.random()*10>5&&t.push(-Math.round(Math.random()*100)),t.push(Math.round(Math.random()*100));return t},u.prototype.calculatePoints=function(){var n=this.model,a=n.type,r=n.dataSource!=null?n.dataSource:this.getDefaultPoints(12),f,v,o,w,k,ft=[],h=r.length,c,d=0,y,et,l,i,ut,ot,st,ht;if(Array.isArray(r)&&typeof r[0]!="object")if(n.type==t.Pie)for(i=0;i<h;i++)d+=Math.abs(r[i]);else v=Math.max.apply(null,r),o=Math.min.apply(null,r),w=0,k=h-1;else if(n.type==t.Pie)for(i=0;i<h;i++)d+=Math.abs(r[i][n.yName]);else r[0][n.xName]?(c=r,c=c.sort(function(t,i){return t[n.yName]-i[n.yName]}),v=c[c.length-1][n.yName],o=c[0][n.yName]):(y=r.map(function(t){return t[n.yName]}),v=Math.max.apply(null,y),o=Math.min.apply(null,y)),r[0][n.xName]?(c=c.sort(function(t,i){return t[n.xName]-i[n.xName]}),k=c[c.length-1][n.xName],w=c[0][n.xName]):(w=0,k=h-1);if(n.type!=t.Pie){this.maxLength=h;var l,b=Number(n.padding),u=parseInt(n.size.height)-b*2,tt=parseInt(n.size.width)-b*2,g=k-w,e=v-o,g=g==0?1:g;e=e==0?1:e;this.min=o;this.unitX=g;this.minX=w;this.unitY=e;this.max=v;this.maxX=k;var it=0,p=u-u/e*-o,s,p=o<0&&v<=0?0:o<0&&v>0?p:u;this.axisHeight=p+b;a!=t.WinLoss&&n.axisLineSettings.visible&&this.drawAxis()}for(i=0;i<h;i++){if(r[i][n.xName]||r[i][n.yName]||r[i][n.yName]==0?r[i][n.xName]?(y=r[i][n.xName],f=r[i][n.yName]):(y=i,f=r[i][n.yName]):(y=i,f=r[i]),a==t.Line||a==t.Area)s=h!=1?u-Math.round(u*((f-o)/e)):0,l={X:h!=1?Math.round(tt*((y-w)/g)):tt/2,Y:s,markerPos:s};else if(a==t.Column||a==t.WinLoss){var nt=tt/h,rt=.5*2;nt-=rt;it=i*(nt+rt)+rt/2;a==t.WinLoss?(ut=.5,ot=40,s=f>0?u/4:f<0?u*ut:u*ut-u/ot,l={X:it,Y:s,height:f!=0?u/4:u/20,width:nt}):(st=u/e*(f-o),ht=f==o&&f>0?h!=1&&e!=1?u/e*(o/2)>u?u/e:u/e*(o/2):u/e:f==v&&f<0&&h!=1&&e!=1?u/e*(-v/2):st,s=Math.abs(u-ht),l={X:it,Y:s>p?p:s,height:Math.abs(s-p),width:nt,markerPos:s>p?p+Math.abs(s-p):s})}else a==t.Pie&&(et=Math.abs(f)/d*100,l={Percent:et,Degree:Math.abs(f)/d*360});a!=t.Pie&&(l.X+=b,l.Y+=b);a!=t.WinLoss&&(l.markerPos+=b);l.Xval=y;l.Yval=f;ft.push({location:l})}this.visiblePoints=ft},u.prototype.seriesRender=function(){var i=this.model,r=this.visiblePoints,f=r.length,u,n=i.type;u={data:{minX:this.minX,minY:this.min,maxX:this.maxX,maxY:this.max,xName:i.xName,yName:i.yName,pointsCount:f,seriesType:n,visiblePoints:this.visiblePoints}};this.model.seriesRendering!=null&&this._trigger("seriesRendering",u);n==t.Line?this.drawLineSeries(r):n==t.Area?this.drawAreaSeries(r):n==t.Column?this.drawColumnSeries(r):n==t.WinLoss?this.drawWinlossSeries(r):n==t.Pie&&this.drawPieSeries();i.markerSettings.visible&&n!=t.WinLoss&&n!=t.Pie&&this.drawMarker(r);i.rangeBandSettings.startRange!=null&&i.rangeBandSettings.endRange!=null&&n!=t.WinLoss&&n!=t.Pie&&this.drawRangeBand()},u.prototype.drawPieSeries=function(){var n=this.model,r=this.visiblePoints,i,c,b,y;n.padding=n.padding==this.defaults.padding?2:n.padding;var nt=r.length,l=parseInt(n.size.height)-n.padding*2,a=parseInt(n.size.width)-n.padding*2,u=l<=a?l/2:a/2,f,e,t={X:a/2,Y:l/2},o,p,v,w=n.palette,s=0,k=n.border.color,d=n.opacity,g=n.border.width,h;for(r.centerPos=t,r.radius=u,i=0,c=90;i<r.length;i++)c+=s,s=r[i].location.Degree,b=c+s,f=(c-90)*Math.PI/180,e=(b-90)*Math.PI/180,r[i].stAng=f,r[i].endAng=e,y=s<180?"0":"1",o=r[i].coordinates={sX:t.X+u*Math.cos(f),sY:t.Y+u*Math.sin(f),eX:t.X+u*Math.cos(e),eY:t.Y+u*Math.sin(e)},p="M "+t.X+" "+t.Y+" L "+o.eX+" "+o.eY+" A "+u+" "+u+" 0 "+y+",0 "+o.sX+" "+o.sY+" Z",v={id:this.container.id+"_pieBase"+i,fill:w[i%w.length],stroke:k,opacity:d,"stroke-width":g,d:p,start:e,end:f,x:t.X,y:t.Y,counterClockWise:y,radius:u},n.enableCanvasRendering?this.canvasDrawPath(v):(h=this.createGroup({id:"sparkpieSeries"}),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},h),this.container.appendChild(h),this.drawPath(v,h))},u.prototype.drawRangeBand=function(){var n=this.model,t=parseInt(n.size.height)-n.padding*2,f=parseInt(n.size.width)-n.padding*2,o=n.rangeBandSettings.startRange,s=n.rangeBandSettings.endRange,i=Number(t-t/this.unitY*(o-this.min))+n.padding,r=Number(t-t/this.unitY*(s-this.min))+n.padding,u,e;r=r>Number(t+n.padding)?Number(t+n.padding):r<0+n.padding?0+n.padding:r;i=i>Number(t+n.padding)?Number(t+n.padding):i<0+n.padding?0+n.padding:i;e="M "+n.padding+" "+i+" L "+(f+Number(n.padding))+" "+i+" L "+(f+Number(n.padding))+" "+r+" L "+n.padding+" "+r+" Z";u={id:this.container.id+"_rangeBand",fill:n.rangeBandSettings.color,opacity:n.rangeBandSettings.opacity,stroke:"transparent","stroke-width":n.border.width,d:e};n.enableCanvasRendering?this.canvasDrawPath(u):this.drawPath(u)},u.prototype.drawAxis=function(){var n=this.model,r=this.axisHeight,u=n.axisLineSettings.color,f=n.type,i;f!=t.WinLoss&&f!=t.Pie&&(n.axisLineSettings.visible||(u="transparent"),i={id:this.container.id+"_Sparkline_XAxis",x1:0+n.padding,y1:r,x2:parseInt(n.size.width)-n.padding,y2:r,stroke:u,"stroke-dasharray":n.axisLineSettings.dashArray,"stroke-width":n.axisLineSettings.width},n.enableCanvasRendering?this.canvasDrawLine(i):this.drawLine(i))},u.prototype.drawColumnSeries=function(t){var f,u,r=this.model,c=t.length,w=n.compareExtend({},[],t),b=r.border.width,l,k=r.opacity,a,d=r.fill,g=r.border.color,o=r.highPointColor,s=r.lowPointColor,v=r.startPointColor,y=r.endPointColor,p=r.negativePointColor,e,h,i;for((o||s)&&(h=w.map(function(n){return n.location.markerPos}),a=Math.min.apply(null,h),l=Math.max.apply(null,h)),r.enableCanvasRendering==!1&&(e=this.createGroup({id:this.container.id+"sparkcolumnSeries"}),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},e),this.container.appendChild(e)),i=0;i<c;i++)u=t[i].location,f={id:this.container.id+"_column_series_"+i,x:u.X,y:u.Y,height:u.height,width:u.width,fill:d,stroke:g,opacity:k,"stroke-width":b},u.markerPos==a&&o?(f.fill=o,this.highPointIndex=i):u.markerPos==l&&s?(f.fill=s,this.lowPointIndex=i):i==0&&v?(f.fill=v,this.startPointIndex=i):i==c-1&&y?(f.fill=y,this.endPointIndex=i):u.markerPos>=this.axisHeight&&p&&(f.fill=p,this.negativePointIndexes.push(i)),r.enableCanvasRendering?this.canvasDrawRectangle(f):this.drawRect(f,e),u.X+=u.width/2},u.prototype.drawWinlossSeries=function(n){var f,i,t=this.model,s=t.border.width,e=t.padding,h=t.border.color,c=t.opacity,l=n.length,o=parseInt(t.size.height)-e*2,u,r;for(t.enableCanvasRendering==!1&&(u=this.createGroup({id:this.container.id+"sparkwinlossSeries"}),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},u),this.container.appendChild(u)),r=0;r<l;r++)i=n[r].location,f={id:this.container.id+"_winloss_series_"+r,x:i.X,y:i.Y,height:i.height,width:i.width,fill:i.Y<o/2+e?i.Y>o/4+e?"#EE82EE":t.fill:t.negativePointColor?t.negativePointColor:"#FF0000",stroke:h,opacity:c,"stroke-width":s},t.enableCanvasRendering?this.canvasDrawRectangle(f):this.drawRect(f,u)},u.prototype.drawAreaSeries=function(n){for(var r="",e=this.axisHeight,t=this.model,f,u,i=0,o=n.length;i<o;i++)i==0&&(r="M "+n[0].location.X+" "+e+" "),r+="L "+n[i].location.X+" "+n[i].location.Y+" ",i==o-1&&(r+="L "+n[i].location.X+" "+e+" Z");f={id:this.container.id+"_area_series_fill",fill:t.fill,stroke:t.stroke?t.stroke:t.fill,"fill-opacity":t.opacity,"stroke-width":t.width,d:r};t.enableCanvasRendering?this.canvasDrawPath(f):(u=this.createGroup({id:"sparkAreaSeries"}),this.container.appendChild(u),this.drawPath(f,u),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},u))},u.prototype.drawLineSeries=function(n){for(var f,u="",t=this.model,r,i=0,e=n.length;i<e;i++)i==0&&(u="M "+n[0].location.X+" "+n[i].location.Y+" "),u+="L "+n[i].location.X+" "+n[i].location.Y+" ";f={id:this.container.id+"_Line_series",fill:"transparent",stroke:t.stroke?t.stroke:t.fill,opacity:t.opacity,"stroke-width":t.width,d:u};t.enableCanvasRendering?this.canvasDrawPath(f):(r=this.createGroup({id:"sparklineSeries"}),this.container.appendChild(r),this.drawPath(f,r),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},r))},u.prototype.drawMarker=function(i){var a=i.length,f,o=this.model.markerSettings,u=this.model,g=n.compareExtend({},[],i),nt=o.fill?o.fill:u.fill,tt=o.border.color,v=o.width,it=o.opacity,y=o.border.width,e,p,w,h=u.highPointColor,c=u.lowPointColor,b=u.startPointColor,k=u.endPointColor,d=u.negativePointColor,s,l,r,rt;for(u.enableCanvasRendering==!1&&(s=this.createGroup({id:this.container.id+"sparkmarkers"}),this.setStyles({"clip-path":"url(#"+this.container.id+"_sparklineRect)"},s),this.container.appendChild(s)),(o.visible==!1||u.type==t.Pie||u.type==t.WinLoss)&&(v=0,y=0),(h||c)&&(l=g.map(function(n){return n.location.markerPos}),w=Math.min.apply(null,l),p=Math.max.apply(null,l)),r=0;r<a;r++)e=i[r].location,rt=e.width!=undefined?e.width/2:0,f={id:this.container.id+"_marker_"+r,cx:e.X,cy:e.markerPos,r:v,fill:nt,stroke:tt,opacity:it,"stroke-width":y},e.markerPos==w&&h?(f.fill=h,this.highPointIndex=r):e.markerPos==p&&c?(f.fill=c,this.lowPointIndex=r):r==0&&b?(f.fill=b,this.startPointIndex=r):r==a-1&&k?(f.fill=k,this.endPointIndex=r):e.markerPos>this.axisHeight&&d&&(f.fill=d,this.negativePointIndexes.push(r)),this.model.enableCanvasRendering?this.canvasDrawCircle(f):this.drawCircle(f,s)},u.prototype.drawLine=function(n){var t=document.getElementById(n.id);t||(t=document.createElementNS(this.svgLink,"line"));this.setAttributes(n,t);this.container.appendChild(t)},u.prototype.drawCircle=function(n,t){t=!t?this.container:t;var i=document.getElementById(n.id);i||(i=document.createElementNS(this.svgLink,"circle"));this.setAttributes(n,i);t.appendChild(i)},u.prototype.drawPolyLine=function(n){var t=document.getElementById(n.id);t||(t=document.createElementNS(this.svgLink,"polyline"));this.setAttributes(n,t);this.container.appendChild(t)},u.prototype.drawPath=function(n,t){t=!t?this.container:t;var i=document.getElementById(n.id);i||(i=document.createElementNS(this.svgLink,"path"));this.setAttributes(n,i);t.appendChild(i)},u.prototype.drawRect=function(n,t){t=!t?this.container:t;var i=document.getElementById(n.id);i||(i=document.createElementNS(this.svgLink,"rect"));this.setAttributes(n,i);t.appendChild(i)},u.prototype.createGroup=function(n){var t=document.createElementNS(this.svgLink,"g");return this.setAttributes(n,t),t},u.prototype.createText=function(n,t){var i=document.createElementNS(this.svgLink,"text");return this.setAttributes(n,i),t&&(i.textContent=t),i},u.prototype.canvasDrawLine=function(n,t){var i=t?t:this.ctx;i.save();i.beginPath();i.lineWidth=n["stroke-width"];i.strokeStyle=n.stroke;i.moveTo(n.x1,n.y1);i.lineTo(n.x2,n.y2);i.stroke();i.restore();this.dataURL=this.container.toDataURL()},u.prototype.canvasDrawRectangle=function(n,t){var i=t?t:this.ctx,u=t?t:this.ctx,r;i.save();i.beginPath();i.globalAlpha=n.opacity;i.lineWidth=n["stroke-width"];r=n["stroke-dasharray"]?n["stroke-dasharray"].split(","):!1;r&&this.ctx.setLineDash(r);i.strokeStyle=n.stroke;i.rect(n.x,n.y,n.width,n.height);n.fill=="none"&&(n.fill="transparent");i.fillStyle=n.fill;i.fillRect(n.x,n.y,n.width,n.height);i.stroke();i.restore();i=u;this.dataURL=this.container.toDataURL()},u.prototype.canvasDrawPath=function(n,t){var c=n.d,u=c.split(" "),h=n["stroke-width"],i=t?t:this.ctx,l=t?t:this.ctx,o,s,r,f,e;for(i.save(),i.beginPath(),i.globalAlpha=n.opacity?n.opacity:n["fill-opacity"],o=!0,i.lineWidth=h,s=n["stroke-dasharray"]?n["stroke-dasharray"].split(","):!1,s&&i.setLineDash(s),i.strokeStyle=n.stroke,r=0;r<u.length;r=r+3){f=parseFloat(u[r+1]);e=parseFloat(u[r+2]);switch(u[r]){case"M":n.innerR||n.cx||i.moveTo(f,e);break;case"L":n.innerR||i.lineTo(f,e);break;case"C":i.bezierCurveTo(f,e,parseFloat(u[r+3]),parseFloat(u[r+4]),parseFloat(u[r+5]),parseFloat(u[r+6]));r=r+4;break;case"A":n.innerR?o&&(i.arc(n.x,n.y,n.radius,n.start,n.end,n.counterClockWise),i.arc(n.x,n.y,n.innerR,n.end,n.start,!n.counterClockWise),o=!1):n.cx?i.arc(n.cx,n.cy,n.radius,0,2*Math.PI,n.counterClockWise):(i.moveTo(n.x,n.y),i.arc(n.x,n.y,n.radius,n.start,n.end,n.counterClockWise),i.lineTo(n.x,n.y));r=r+5;break;case"Z":i.closePath()}}n.fill!="none"&&n.fill!=undefined&&(i.fillStyle=n.fill,i.fill());h>0&&i.stroke();i.restore();i=l;this.dataURL=this.container.toDataURL()},u.prototype.canvasDrawCircle=function(n,t){var i=t?t:this.ctx,u=t?t:this.ctx,r;i.save();i.beginPath();i.arc(n.cx,n.cy,n.r,0,2*Math.PI);i.fillStyle=n.fill;i.globalAlpha=n.opacity;i.fill();i.lineWidth=n["stroke-width"];r=n["stroke-dasharray"]?n["stroke-dasharray"].split(","):!1;r&&i.setLineDash(r);i.strokeStyle=n.stroke;i.stroke();i.restore();i=u;this.dataURL=this.container.toDataURL()},u.prototype.canvasDrawPolyline=function(n,t){var i=t?t:this.ctx,u,r;for(i.save(),i.beginPath(),u=n.points.split(" "),r=0;r<u.length-1;r++){var f=u[r].split(","),e=f[0],o=f[1];r==0?i.moveTo(e,o):i.lineTo(e,o)}i.lineWidth=n["stroke-width"];i.strokeStyle=n.stroke;i.stroke();i.restore();this.dataURL=this.container.toDataURL()},u.prototype.canvasDrawText=function(n,t,i){var e=n.font,u=n["text-anchor"],o=n.opacity!==undefined?n.opacity:1,r,f;u=="middle"&&(u="center");r=i?i:this.ctx;r.save();r.fillStyle=n.fill;r.font=e;r.textAlign=u;r.globalAlpha=o;n.baseline&&(r.textBaseline=n.baseline);f=0;n.labelRotation==90&&n.id.indexOf("XLabel")!=-1&&(f=r.measureText(t).width);r.translate(n.x+f/2,n.y);r.rotate(n.labelRotation*Math.PI/180);r.fillText(t,0,0);r.restore();this.dataURL=this.container.toDataURL()},u.prototype.parseTemplate=function(n,t){var i,o=Object.values,s,h,f,r,u,e;for(Object.entries||(Object.entries=function(n){for(var i=Object.keys(n),t=i.length,r=new Array(t);t--;)r[t]=[i[t],n[i[t]]];return r}),i=n.innerHTML,s=o?o(t):Object.keys(t).map(function(n){return t[n]}),h=s[0],u=0,e=Object.entries(h);u<e.length;u++){var c=e[u],a=c[0],l=c[1];f="#point."+a+"#";r="none";i.search(r)!=-1&&r=="none"&&(i=i.replace(r,l));i.search(f)!=-1&&(i=i.replace(f,l))}return i},u.prototype.measureText=function(n,t){var e=document.getElementById("measureTex"),i,u,f,r;e&&e.clientHeight!=0?i=e:(i=document.createElement("text"),i.setAttribute("id","measureTex"),document.body.appendChild(i));var o=null,s=null,h=null,c=null;if(typeof n=="string"&&(n.indexOf("<")>-1||n.indexOf(">")>-1)){for(u=n.split(" "),f=0;f<u.length;f++)u[f].indexOf("<br/>")==-1&&(u[f]=u[f].replace(/[<>]/g,"&"));n=u.join(" ")}return i.innerHTML=n,t!=undefined&&t.size==undefined&&(r=t,r=r.split(" "),o=r[0],s=r[1],h=r[2],c=r[3]),t!=null&&(i.style.fontSize=t.size>0?t.size+"px":t.size?t.size:s,i.style.fontStyle&&(i.style.fontStyle=t.fontStyle?t.fontStyle:o),i.style.fontFamily=t.fontFamily?t.fontFamily:h,window.navigator.userAgent.indexOf("MSIE 8.0")==-1&&(i.style.fontWeight=t.fontWeight?t.fontWeight:c)),i.style.backgroundColor="white",i.style.position="absolute",i.style.top="-100px",i.style.left="0px",i.style.visibility="hidden",i.style.whiteSpace="nowrap",{width:i.offsetWidth,height:i.offsetHeight}},u}(BoldBIDashboard.WidgetBase);n.Sparkline=r;BoldBIDashboard.widget("BoldBIDashboardSparkline","BoldBIDashboard.Sparkline",new r)}(bbdesigner$);n.deepExtend=function(t){var u,i,r;for(t=t||{},u=1;u<arguments.length;u++)if(i=arguments[u],i)for(r in i)i.hasOwnProperty(r)&&(t[r]=typeof i[r]=="object"?n.deepExtend(t[r],i[r]):i[r]);return t};n.compareExtend=function(t,i,r){var e,o,u,f;if(typeof r=="object"&&r!==null)for(e=Object.keys(r),o=e.length,f=0;f<o;f++)u=e[f],i.hasOwnProperty(u)&&i[u]!=null?(Array.isArray(i[u])||typeof i[u]=="object"&&i[u]!==null)&&n.compareExtend({},i[u],r[u]):i[u]=r[u];return i}}(BoldBIDashboardSparkline||(BoldBIDashboardSparkline={})),function(n,t){t.widget("BoldBIDashboardKPICard","BoldBIDashboard.KPICard",{element:null,model:null,defaults:{actualValue:null,targetValue:null,animationSettings:{enableAnimation:!0,animationDuration:1500},leftValue:{caption:"",value:null,type:"actualvalue",visibility:!0,captionVisibility:!0,isValueFollowDirectionColor:!0,isCaptionFollowDirectionColor:!0,foreground:"",captionForeground:"",fontSize:"",fontFamily:"",fontWeight:"",captionFontSize:"",captionFontFamily:"",captionFontWeight:""},rightValue:{caption:"",value:null,type:"targetvalue",visibility:!0,captionVisibility:!0,isValueFollowDirectionColor:!0,isCaptionFollowDirectionColor:!0,foreground:"",captionForeground:"",fontSize:"",fontFamily:"",fontWeight:"",captionFontSize:"",captionFontFamily:"",captionFontWeight:""},kpiValue:{type:"percentoftarget",foreground:"",followDirectionColor:!0,alignment:"",visibility:!0,fontSize:"",fontFamily:"",fontWeight:"",isColorCustomized:!1},valueRepresentation:{format:"Number",representation:"Auto",numberOfDecimals:2,currencyCulture:"en-US",decimalSeparator:{CurrentValue:".",AliasValue:"."},groupSeparator:{CurrentValue:",",AliasValue:","},negativeValueFormat:"default",prefix:"",suffix:"",enableLakhsAndCroreRep:!1},sparkline:{data:null,fill:"",type:"area",visibility:!1,opacity:.2,followDirectionColor:!0,isColorCustomized:!1},hiddenColumns:[],title:{text:"",foreground:"",alignment:"center",visibility:!0,fontSize:"",fontFamily:"",fontWeight:"",isColorCustomized:!1,fontSettings:{IsBold:!1,IsItalic:!1,IsUnderLine:!1,IsStrikeThrough:!1}},icon:{type:null,path:"",color:"",followDirectionColor:!0,visibility:!0,fontSize:"",lowValueIcon:"",highValueIcon:"",neutralValueIcon:"",customizedIcon:"",isIconCustomized:!1,mode:"",placement:"",alignment:""},image:{mode:"Fill",data:null,visibility:!0,isImageCustomized:!1,position:"Left"},backgroundSettings:{mode:"Fill",image:null,showImage:!0,plotArea:"default",color:"",opacity:"",isColorCustomized:!1,isImageCustomized:!1},size:{width:300,height:100},colorSettings:{highColor:"",lowColor:"",neutralColor:""},informationIcon:{visibility:!1},tooltip:{visibility:!0,"class":"",attribute:"",text:""},separator:{color:"",visibility:!0,followDirectionColor:!1},autoFontSize:{fontSizeFactor:1,enable:!1},isFixedLayout:!1,responsiveMargin:!1,selected:null,enableTooltip:!1},_init:function(){this.intializePrivateVariables();this.createLayout();this.wireEvents();this.updateData();this.responsiveLayout()},intializePrivateVariables:function(){this._tooltipClass=this.model.tooltip.class;this.height=this.model.size.height;this.width=this.model.size.width;this.margin=0;this.isInvalidValue=!1;this.formatting=new NumberFormatting},wireEvents:function(){this._on(this.element,"click",this._selectedHandler);this._on(this.element,"mousemove",this._toolTipInitializeHandler);this._on(this.element,"mouseleave",this._hideTooltip)},unwireEvents:function(){this._off(this.element,"click",this._selectedHandler);this._off(this.element,"mousemove",this._toolTipInitializeHandler);this._off(this.element,"mouseleave",this._hideTooltip)},setHeight:function(){return this.model.size.height>250?150:this.model.size.height},showToolTip:function(t){var r=document.getElementsByTagName("BODY")[0],i=n("<div>").attr("id","e-kpi-card-tooltip").css({position:"absolute",top:t.clientY+"px",left:t.clientX+"px","z-index":1e5,visibility:"visible",display:"inline-block"});i.innerHTML="This card contains image.<br>Increase the width to view the Image";n(r).append(i)},hideToolTip:function(){var t=document.getElementsByTagName("BODY")[0];n(t).find("#e-kpi-card-tooltip").remove()},createLayout:function(){var t=this.element,i;this.createBackgroundImageWrapper();t.css({height:this.model.size.height+"px",width:this.model.size.width+"px"});i=n("<div>").addClass("e-kpi-card-sparkline-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});t.append(i);this.createIconWrapper();this.createCardWrapperParent();this.createCardWrapper();this.createTableCellElement();this.createCardValueWrapper();this.createContentImageWrapper();this.createKPIImageWrapper();this.createImageElement();this.createValueContainerMiddle();this.createTitleWrapper();this.createEmptyContainer();this.createTitleElement();this.createKPIElement();this.createValueContainerBottom();this.createLeftValueContainer();this.createLeftValueCaptionElement();this.createLeftIconValueWrapper();this.createLeftValueElement();this.createBorderline();this.createRightValueContainer();this.createRightValueCaptionElement();this.createRightIconValueWrapper();this.createRightValueElement();this.createSparklineContainer();this.createIndicatorElement();this.updateTitleContainer();this.updateMiddleValueContainer();this.updateContentImageWrapper();this.updateBottomContainer();this.updateIndicatorContainer();this.updateSparklineContainer()},_setModel:function(n){for(var t in n)if(n.hasOwnProperty(t))switch(t){case"icon":this.updateIndicatorContainer();this.updateIcon();this.updateMiddleValueContainer();this.updateContentImageWrapper();this.updateBottomContainerElementsAlingment();this.updateBottomContainer();this.responsiveLayout();break;case"leftValue":this.updateBottomContainer();this.updateLeftSideData();this.responsiveLayout();break;case"rightValue":this.updateBottomContainer();this.updateRightSideData();this.responsiveLayout();break;case"kpiValue":this.updateMiddleValueContainer();this.updateContentImageWrapper();this.updateKPIValue();this.updateIcon();this.responsiveLayout();break;case"title":this.updateTitleContainer();this.updateTitle();this.updateContentImageWrapper();this.updateBottomContainerElementsAlingment();this.responsiveLayout();break;case"image":this.updateImage();this.responsiveLayout();break;case"sparkline":this.updateSparklineContainer();this.updateSparkline();this.responsiveLayout();break;case"informationIcon":this.responsiveLayout();break;case"size":this.updateIcon();this.updateKPIValue();this.updateTitle();this.updateLeftCaption();this.updateLeftValue();this.updateRightCaption();this.updateRightValue();this.height=this.model.size.height;this.width=this.model.size.width;this.resize();break;case"animationSettings":this.applyAnimation();break;case"actualValue":case"targetValue":this.updateLeftSideData();this.updateRightSideData();this.updateKPIValue();this.updateIcon();this.updateSparklineColor();this.updateBackgroundColor();this.applyAnimation();break;case"colorSettings":this.updateLeftSideData();this.updateRightSideData();this.updateKPIValue();this.updateIcon();this.updateSparklineColor();this.applyAnimation();break;case"valueRepresentation":this.updateLeftValue();this.updateRightValue();this.updateKPIValue();this.updateBackgroundColor();this.applyAnimation();break;case"tooltip":this._updateElementsTooltip();this.updateInformationTooltip();this.applyAnimation();this._tooltipClass=this.model.tooltip.class;break;case"backgroundSettings":this.resizeBackgroundContainer();this.updateBackgroundImage();this.applyAnimation();break;case"separator":this.updateBorderLineVisibility();this.updateSeparatorColor();this.applyAnimation();break;case"autoFontSize":this.updateIcon();this.updateKPIValue();this.updateTitle();this.updateLeftCaption();this.updateLeftValue();this.updateRightCaption();this.updateRightValue();this.responsiveLayout();break;case"isFixedLayout":this.responsiveLayout();break;case"responsiveMargin":this.responsiveLayout()}},createBackgroundImageWrapper:function(){var t=n("<div>").addClass("e-kpi-card-background-image-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.append(t);t.append(n("<div>").addClass("e-kpi-card-background-image-container e-kpi-card-image-styles"))},createSeparatorElement:function(){var i=n(this.element).find(".e-kpi-card-wrapper"),t=n("<div>").addClass("e-kpi-card-separator-container");i.append(t);t.append(n("<div>").addClass("e-kpi-card-separator"))},createCardWrapperParent:function(){var t=this.element.find(".e-kpi-card-sparkline-wrapper");t.append(n("<div>").addClass("e-kpi-card-wrapper-parent e-kpi-card-image-styles"))},createCardWrapper:function(){var t=this.element.find(".e-kpi-card-wrapper-parent");t.append(n("<div>").addClass("e-kpi-card-wrapper"))},createTableCellElement:function(){var t=this.element.find(".e-kpi-card-wrapper");t.append(n("<div>").addClass("e-kpi-card-table-cell"))},createCardValueWrapper:function(){var t=this.element.find(".e-kpi-card-table-cell");t.append(n("<div>").addClass("e-kpi-card-value-wrapper e-kpi-card-default-layout"))},createContentImageWrapper:function(){var t=n(this.element).find(".e-kpi-card-value-wrapper"),i=n("<div>").addClass("e-kpi-card-content-image-wrapper");t.append(i)},createKPIImageWrapper:function(){var t=n(this.element).find(".e-kpi-card-content-image-wrapper"),i=n("<div>").addClass("e-kpi-card-kpi-image-wrapper");t.append(i)},createImageElement:function(){var i=n(this.element).find(".e-kpi-card-kpi-image-wrapper"),t=n("<div>").addClass("e-kpi-card-image-wrapper");i.append(t);t.append(n("<div>").addClass("e-kpi-card-image-container e-kpi-card-image-styles"))},createTitleWrapper:function(){var t=n(this.element).find(".e-kpi-card-content-image-wrapper"),i=n("<div>").addClass("e-kpi-card-title-wrapper");t.append(i)},createEmptyContainer:function(){var t=n(this.element).find(".e-kpi-card-title-wrapper"),i=n("<div>").addClass("e-kpi-card-empty-container");t.append(i)},createTitleElement:function(){var i=n(this.element).find(".e-kpi-card-title-wrapper"),t=n("<div>").addClass("e-kpi-card-title-container");t.append(n("<div>").addClass("e-kpi-card-title-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createValueContainerMiddle:function(){var t=n(this.element).find(".e-kpi-card-kpi-image-wrapper"),i=n("<div>").addClass("e-kpi-card-value-container-middle e-kpi-card-justify-center");t.append(i)},createIndicatorElement:function(){var i=this.getIconParent(),t=n("<div>").addClass("e-kpi-card-indicator-container");t.append(n("<div>").addClass("e-kpi-card-indicator"));i.prepend(t)},getIconParent:function(){switch(this.model.icon.placement){case t.KPICard.IconPlacement.Left:return n(this.element).find(".e-kpi-card-left-icon-value-wrapper");case t.KPICard.IconPlacement.Right:return n(this.element).find(".e-kpi-card-right-icon-value-wrapper");default:return n(this.element).find(".e-kpi-card-value-container-middle")}},createKPIElement:function(){var i=n(this.element).find(".e-kpi-card-value-container-middle"),t=n("<div>").addClass("e-kpi-card-middle-value-container e-kpi-card-text-ellipsis");t.append(n("<div>").addClass("e-kpi-card-middle-value-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createValueContainerBottom:function(){var t=n(this.element).find(".e-kpi-card-value-wrapper"),i=n("<div>").addClass("e-kpi-card-value-container-bottom");t.append(i)},createLeftValueContainer:function(){var t=n(this.element).find(".e-kpi-card-value-container-bottom"),i=n("<div>").addClass("e-kpi-card-value-container-left");t.append(i)},createLeftValueCaptionElement:function(){var i=n(this.element).find(".e-kpi-card-value-container-left"),t=n("<div>").addClass("e-kpi-card-left-value-caption");t.append(n("<div>").addClass("e-kpi-card-left-value-caption-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createLeftIconValueWrapper:function(){var t=n(this.element).find(".e-kpi-card-value-container-left");t.prepend(n("<div>").addClass("e-kpi-card-left-icon-value-wrapper"))},createLeftValueElement:function(){var i=n(this.element).find(".e-kpi-card-left-icon-value-wrapper"),t=n("<div>").addClass("e-kpi-card-left-value");t.append(n("<div>").addClass("e-kpi-card-left-value-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createBorderline:function(){var i=n(this.element).find(".e-kpi-card-value-container-bottom"),t=n("<div>").addClass("border-line");t.append(n("<span>").addClass("border-line-span"));i.append(t)},createRightValueContainer:function(){var t=n(this.element).find(".e-kpi-card-value-container-bottom"),i=n("<div>").addClass("e-kpi-card-value-container-right");t.append(i)},createRightValueCaptionElement:function(){var i=n(this.element).find(".e-kpi-card-value-container-right"),t=n("<div>").addClass("e-kpi-card-right-value-caption");t.append(n("<div>").addClass("e-kpi-card-right-value-caption-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createRightIconValueWrapper:function(){var t=n(this.element).find(".e-kpi-card-value-container-right");t.prepend(n("<div>").addClass("e-kpi-card-right-icon-value-wrapper"))},createRightValueElement:function(){var i=n(this.element).find(".e-kpi-card-right-icon-value-wrapper"),t=n("<div>").addClass("e-kpi-card-right-value");t.append(n("<div>").addClass("e-kpi-card-right-value-text "+this.model.tooltip.class+" e-kpi-card-text-ellipsis"));i.append(t)},createSparklineContainer:function(){var r=n(this.element).find(".e-kpi-card-sparkline-wrapper"),t=n("<div>").addClass("e-kpi-card-sparkline-container"),i;r.append(t);t.append(n("<div>").attr("id",n(this.element).attr("id")+"-sparkline"));i=n("<div>").addClass("e-sparkline-gradient-container");this.element.append(i)},createIconWrapper:function(){var i=n(this.element).find(".e-kpi-card-sparkline-wrapper"),t=n("<div>").addClass("e-kpi-card-information-wrapper e-kpi-card-display-none").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});i.append(t);t.append(n("<div>").addClass("e-kpi-card-information-icon"))},updateData:function(){this.updateTitle();this.updateKPIValue();this.updateIcon();this.updateLeftSideData();this.updateRightSideData();this.updateSparkline();this.updateImage();this.updateBackgroundImage();this.updateInformationTooltip();this.updateSeparatorColor()},updateLeftSideData:function(){this.updateLeftValue();this.updateLeftCaption()},updateLeftCaption:function(){this.element.find(".e-kpi-card-left-value-caption-text").css({color:this.model.leftValue.isCaptionFollowDirectionColor?this.getDirectionColor():this.model.leftValue.captionForeground,"font-size":this.getResolutionBasedFontSize(this.model.leftValue.captionFontSize)+"px","font-weight":this.model.leftValue.captionFontWeight,"font-family":this.model.leftValue.captionFontFamily,"line-height":1.25}).html(this.model.leftValue.caption).attr({"data-tooltip":this.model.leftValue.caption})},updateLeftValue:function(){var n=this.getFormattedValue(this.model.leftValue.type,this.model.valueRepresentation);this.element.find(".e-kpi-card-left-value-text").css({color:this.model.leftValue.isValueFollowDirectionColor?this.getDirectionColor():this.model.leftValue.foreground,"font-size":this.getResolutionBasedFontSize(this.model.leftValue.fontSize)+"px","font-weight":this.model.leftValue.fontWeight,"font-family":this.model.leftValue.fontFamily,"line-height":1.5}).html(n).attr({"data-tooltip":n})},updateRightSideData:function(){this.updateRightValue();this.updateRightCaption()},updateRightCaption:function(){this.element.find(".e-kpi-card-right-value-caption-text").css({color:this.model.rightValue.isCaptionFollowDirectionColor?this.getDirectionColor():this.model.rightValue.captionForeground,"font-size":this.getResolutionBasedFontSize(this.model.rightValue.captionFontSize)+"px","font-weight":this.model.rightValue.captionFontWeight,"font-family":this.model.rightValue.captionFontFamily,"line-height":1.25}).html(this.model.rightValue.caption).attr({"data-tooltip":this.model.rightValue.caption})},updateRightValue:function(){var n=this.getFormattedValue(this.model.rightValue.type,this.model.valueRepresentation);this.element.find(".e-kpi-card-right-value-text").css({color:this.model.rightValue.isValueFollowDirectionColor?this.getDirectionColor():this.model.rightValue.foreground,"font-size":this.getResolutionBasedFontSize(this.model.rightValue.fontSize)+"px","font-weight":this.model.rightValue.fontWeight,"font-family":this.model.rightValue.fontFamily,"line-height":1.5}).html(n).attr({"data-tooltip":n})},updateKPIValue:function(){var n=this.getFormattedValue(this.model.kpiValue.type,this.model.valueRepresentation);this.element.find(".e-kpi-card-middle-value-text").css({color:this.model.kpiValue.followDirectionColor&&!this.model.kpiValue.isColorCustomized?this.getDirectionColor():this.model.kpiValue.foreground,"font-size":this.getResolutionBasedFontSize(this.model.kpiValue.fontSize)+"px","font-weight":this.model.kpiValue.fontWeight,"font-family":this.model.kpiValue.fontFamily,"line-height":1.25}).html(n).attr({"data-tooltip":n})},updateIcon:function(){this.updateIconType();this.updateIconColor()},updateIconColor:function(){var n=this.isWarningRange();!n&&this.model.kpiValue.higherValueIsGood&&this.model.actualValue>this.model.targetValue||!this.model.kpiValue.higherValueIsGood&&this.model.targetValue>this.model.actualValue?(this.element.find(".e-kpi-card-indicator").addClass("e-kpi-card-icon-color-green"),this.element.find(".e-kpi-card-indicator").removeClass("e-kpi-card-icon-color-red e-kpi-card-icon-color-yellow")):this.model.targetValue>this.model.actualValue&&!n?(this.element.find(".e-kpi-card-indicator").addClass("e-kpi-card-icon-color-red"),this.element.find(".e-kpi-card-indicator").removeClass("e-kpi-card-icon-color-green e-kpi-card-icon-color-yellow")):(this.element.find(".e-kpi-card-indicator").addClass("e-kpi-card-icon-color-yellow"),this.element.find(".e-kpi-card-indicator").removeClass("e-kpi-card-icon-color-green e-kpi-card-icon-color-red"));this.element.find(".e-kpi-card-indicator").css({color:this.model.icon.followDirectionColor&&!this.model.icon.isIconCustomized?this.getDirectionColor():this.model.icon.color,"font-size":this.getResolutionBasedFontSize(this.model.icon.fontSize)+"px"})},updateIconType:function(){this.element.find(".e-kpi-card-indicator").attr("class","e-kpi-card-indicator");this.model.icon.isIconCustomized?this.model.icon.mode==="Default"&&this.element.find(".e-kpi-card-indicator").addClass("e-color-custom-icon "+this.model.icon.customizedIcon):this.model.actualValue>this.model.targetValue?this.element.find(".e-kpi-card-indicator").addClass("e-color-custom-icon "+this.model.icon.highValueIcon):this.model.actualValue<this.model.targetValue?this.element.find(".e-kpi-card-indicator").addClass("e-color-custom-icon "+this.model.icon.lowValueIcon):this.element.find(".e-kpi-card-indicator").addClass("e-color-custom-icon "+this.model.icon.neutralValueIcon)},updateTitle:function(){this.element.find(".e-kpi-card-title-text").css({color:this.model.title.foreground,"font-size":this.getResolutionBasedFontSize(this.model.title.fontSize)+"px","font-weight":this.model.title.fontWeight,"font-family":this.model.title.fontFamily,"line-height":1.25}).html(this.model.title.text).attr({"data-tooltip":this.model.title.text});t.isNullOrUndefined(this.model.title.fontSettings)||this.updateFontSettings()},getResolutionBasedFontSize:function(n){return this.model.autoFontSize.enable?n+this.model.autoFontSize.fontSizeFactor/100*window.screen.width:n},updateFontSettings:function(){this.model.title.fontSettings.IsBold&&this.element.find(".e-kpi-card-title-text").addClass("e-kpicard-text-bold");this.model.title.fontSettings.IsItalic&&this.element.find(".e-kpi-card-title-text").addClass("e-kpicard-text-italic");this.model.title.fontSettings.IsUnderLine&&this.model.title.fontSettings.IsStrikeThrough?this.element.find(".e-kpi-card-title-text").addClass("e-kpicard-text-underline-strikethrough"):this.model.title.fontSettings.IsUnderLine?this.element.find(".e-kpi-card-title-text").addClass("e-kpicard-text-underline"):this.model.title.fontSettings.IsStrikeThrough&&this.element.find(".e-kpi-card-title-text").addClass("e-kpicard-text-strikethrough")},updateSparkline:function(){this.updateSparklineData();this.updateSparklineColor()},updateSparklineData:function(){if(this.model.sparkline.visibility&&this.model.sparkline.data){var t=this.element.find("#"+n(this.element).attr("id")+"-sparkline");n(t).BoldBIDashboardSparkline({dataSource:this.model.sparkline.data,type:this.model.sparkline.type,padding:0,width:2,yName:"valueName",opacity:this.model.sparkline.opacity,loaded:n.proxy(this.onSparklineLoaded,this)})}},onSparklineLoaded:function(){var i="#"+n(this.element).attr("id")+"-sparkline_sparkline_svg_area_series_fill",t=this.element.find(i),r=t.attr("d").replace("Z","");t.attr("d",r)},updateImage:function(){var n=this.element.find(".e-kpi-card-image-container");this.model.image.visibility?this.updateImageData(n,this.model.image.data,this.model.image):n.css({"background-image":"none"});this.updateImagePosition(n,this.model.image.mode,this.model.image.data);this.updateContentWidth();this.swapImage()},swapImage:function(){var i=this.element.find(".e-kpi-card-value-container-middle"),n=this.element.find(".e-kpi-card-image-wrapper");this.model.image.position==="Left"?(i.before(n),n.css({"margin-right":this.model.icon.visibility&&this.model.icon.position===t.KPICard.IconPosition.Left?"8px":"16px","margin-left":"16px"})):(i.after(n),n.css({"margin-right":"16px","margin-left":this.model.icon.visibility&&this.model.icon.position===t.KPICard.IconPosition.Right?"8px":"16px"}))},updateContentWidth:function(){this.isImagePresent()?(this.element.find(".e-kpi-card-value-container-middle").addClass("e-kpi-card-max-width"),this.element.find(".e-kpi-card-title-container").addClass("e-kpi-card-max-width")):(this.element.find(".e-kpi-card-value-container-middle").removeClass("e-kpi-card-max-width"),this.element.find(".e-kpi-card-title-container").removeClass("e-kpi-card-max-width"))},updateBackgroundImage:function(){var n=this.element.find(".e-kpi-card-background-image-container");this.model.backgroundSettings.showImage?this.updateImageData(n,this.model.backgroundSettings.image,this.model.backgroundSettings):n.css({"background-image":"none"});this.updateImagePosition(n,this.model.backgroundSettings.mode,this.model.backgroundSettings.image);n.css({"background-color":this.model.backgroundSettings.color,opacity:this.model.backgroundSettings.opacity})},updateImageData:function(n,t){n.css({"background-image":"url("+t+")"})},updateImagePosition:function(n,i,r){if(!this.isNullOrEmptyOrUndefined(r))switch(i){case t.KPICard.ImageModes.Fill:n.addClass("e-kpi-card-image-fill");n.removeClass("e-kpi-card-image-default e-kpi-card-image-uniform e-kpi-card-image-uniformtofill");break;case t.KPICard.ImageModes.Uniform:n.addClass("e-kpi-card-image-uniform");n.removeClass("e-kpi-card-image-default e-kpi-card-image-fill e-kpi-card-image-uniformtofill");break;case t.KPICard.ImageModes.UniformToFill:n.addClass("e-kpi-card-image-uniformtofill");n.removeClass("e-kpi-card-image-default e-kpi-card-image-fill e-kpi-card-image-uniform");break;default:n.addClass("e-kpi-card-image-default");n.removeClass("e-kpi-card-image-fill e-kpi-card-image-uniform e-kpi-card-image-uniformtofill")}},updateSparklineColor:function(){var r=this.model.sparkline.followDirectionColor&&!this.model.sparkline.isColorCustomized?this.getDirectionColor():this.model.sparkline.fill,f='<svg style="height: 0"><defs><linearGradient id='+n(this.element).attr("id")+'sparkline-gradient style="opacity: 0.75" class="chart-gradient" x1="0" x2="0" y1="0" y2="1"><stop offset="0" stop-color='+r+" stop-opacity="+this.model.sparkline.opacity+' ><\/stop><stop offset="0.9" stop-color='+r+" stop-opacity=0><\/stop><\/linearGradient><\/defs><\/svg>",e=this.element.find(".e-sparkline-gradient-container"),i,u;if(e.html(f),i=this.element.find("#"+n(this.element).attr("id")+"-sparkline").data("BoldBIDashboardSparkline"),!t.isNullOrUndefined(i)){switch(this.model.sparkline.type){case"area":u=n(this.element).attr("id")+"sparkline-gradient";i.model.stroke=r;i.model.fill="url(#"+u+")";i.model.opacity=this.model.sparkline.opacity;break;case"column":i.model.fill=this.model.sparkline.followDirectionColor&&!this.model.sparkline.isColorCustomized?this.getDirectionColor():this.model.sparkline.fill;break;default:i.model.stroke=this.getStrokeColor()}i.redraw()}},_updateElementsTooltip:function(){this.element.find(".e-kpi-card-title-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-middle-value-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-left-value-caption-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-left-value-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-right-value-caption-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-right-value-text").removeClass(this._tooltipClass);this.element.find(".e-kpi-card-title-text").addClass(this.model.tooltip.class);this.element.find(".e-kpi-card-middle-value-text").addClass(this.model.tooltip.class);this.element.find(".e-kpi-card-left-value-caption-text").addClass(this.model.tooltip.class);this.element.find(".e-kpi-card-left-value-text").addClass(this.model.tooltip.class);this.element.find(".e-kpi-card-right-value-caption-text").addClass(this.model.tooltip.class);this.element.find(".e-kpi-card-right-value-text").addClass(this.model.tooltip.class)},updateInformationTooltip:function(){this.isNullOrEmptyOrUndefined(this.model.tooltip.class)||this.isNullOrEmptyOrUndefined(this.model.tooltip.attribute)||(this.element.find(".e-kpi-card-information-icon").removeClass(this._tooltipClass),this.element.find(".e-kpi-card-information-icon").addClass(this.model.tooltip.class).attr(this.model.tooltip.attribute,this.model.tooltip.text))},updateBackgroundColor:function(){this.element.find(".e-kpi-card-sparkline-wrapper").css({"background-color":this.model.backgroundSettings.color})},updateSeparatorColor:function(){this.element.find(".border-line-span").css({"border-color":this.model.separator.followDirectionColor?this.getDirectionColor():this.model.separator.color})},getStrokeColor:function(){var n=this.isWarningRange();return!n&&this.model.kpiValue.higherValueIsGood&&this.model.actualValue>this.model.targetValue||!this.model.kpiValue.higherValueIsGood&&this.model.targetValue>this.model.actualValue?"#3BB44A":!n&&this.model.targetValue>this.model.actualValue?"#E81123":"#F2C914"},getDirectionColor:function(){var n=this.isWarningRange();return!n&&this.model.kpiValue.higherValueIsGood&&this.model.actualValue>this.model.targetValue||!this.model.kpiValue.higherValueIsGood&&this.model.targetValue>this.model.actualValue?this.model.colorSettings.highColor:this.model.targetValue>this.model.actualValue&&!n?this.model.colorSettings.lowColor:this.model.colorSettings.neutralColor},getFormattedValue:function(n,i){var r=this.getCalculatedValue(n);switch(n){case t.KPICard.ValueType.AbsoluteDifference:case t.KPICard.ValueType.ActualValue:case t.KPICard.ValueType.TargetValue:return this.formatting.applyFormat(r,i);default:return this.adjustDemicalPlacesOnly(r,i)}},getCalculatedValue:function(n){this.isInvalidValue=this.model.actualValue===0||this.model.targetValue===0;switch(n){case t.KPICard.ValueType.AbsoluteDifference:return this.model.actualValue-this.model.targetValue;case t.KPICard.ValueType.PercentOfDifference:return this.isInvalidValue?this.getZeroValue(this.model.actualValue,this.model.targetValue):(this.model.actualValue-this.model.targetValue)/((this.model.actualValue+this.model.targetValue)/2)*100;case t.KPICard.ValueType.PercentOfChange:return this.isInvalidValue?this.getZeroValue(this.model.actualValue,this.model.targetValue):(this.model.actualValue-this.model.targetValue)/this.model.targetValue*100;case t.KPICard.ValueType.PercentOfTarget:return isFinite(this.model.actualValue/this.model.targetValue)?this.model.actualValue/this.model.targetValue*100:this.getZeroValue(this.model.actualValue,this.model.targetValue);case t.KPICard.ValueType.TargetValue:return this.model.targetValue;default:return this.model.actualValue}},getZeroValue:function(n,t){return n===0&&t===0?0:n===0&&t>0?-100:n>0&&t===0||n===0&&t<0?100:n<0&&t===0?-100:void 0},isWarningRange:function(){var n=this.getCalculatedValue(this.model.kpiValue.type);return!1},adjustDemicalPlacesOnly:function(n){return(n===0?n.toString():n.toFixed(this.model.valueRepresentation.numberOfDecimals).toString())+"%"},showImage:function(){this.element.find(".e-kpi-card-image-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-image-wrapper").removeClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-empty-container").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-empty-container").removeClass("e-kpi-card-display-none")},hideImage:function(){this.element.find(".e-kpi-card-image-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-image-wrapper").removeClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-empty-container").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-empty-container").removeClass("e-kpi-card-display-flex")},showInformationIcon:function(){this.element.find(".e-kpi-card-information-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-information-wrapper").removeClass("e-kpi-card-display-none")},hideInformationIcon:function(){this.element.find(".e-kpi-card-information-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-information-wrapper").removeClass("e-kpi-card-display-flex")},showTitle:function(){this.element.find(".e-kpi-card-title-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-title-wrapper").removeClass("e-kpi-card-display-none")},hideTitle:function(){this.element.find(".e-kpi-card-title-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-title-wrapper").removeClass("e-kpi-card-display-flex")},hideIndicator:function(){this.element.find(".e-kpi-card-indicator-container").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-indicator-container").removeClass("e-kpi-card-display-flex")},showIndicator:function(){this.element.find(".e-kpi-card-indicator-container").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-indicator-container").removeClass("e-kpi-card-display-none")},showKPIValue:function(){this.element.find(".e-kpi-card-middle-value-container").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-middle-value-container").removeClass("e-kpi-card-display-none")},hideKPIValue:function(){this.element.find(".e-kpi-card-middle-value-container").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-middle-value-container").removeClass("e-kpi-card-display-flex")},hideLeftCaption:function(){this.element.find(".e-kpi-card-left-value-caption").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-left-value-caption").removeClass("e-kpi-card-display-flex")},showLeftCaption:function(){this.element.find(".e-kpi-card-left-value-caption").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-left-value-caption").removeClass("e-kpi-card-display-none")},hideLeftValue:function(){this.element.find(".e-kpi-card-left-value").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-left-value").removeClass("e-kpi-card-display-flex")},showLeftValue:function(){this.element.find(".e-kpi-card-left-value").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-left-value").removeClass("e-kpi-card-display-none")},hideBorderLine:function(){this.element.find(".border-line").addClass("e-kpi-card-display-none");this.element.find(".border-line").removeClass("e-kpi-card-display-flex")},showBorderLine:function(){this.element.find(".border-line").addClass("e-kpi-card-display-flex");this.element.find(".border-line").removeClass("e-kpi-card-display-none")},hideRightCaption:function(){this.element.find(".e-kpi-card-right-value-caption").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-right-value-caption").removeClass("e-kpi-card-display-flex")},showRightCaption:function(){this.element.find(".e-kpi-card-right-value-caption").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-right-value-caption").removeClass("e-kpi-card-display-none")},hideRightValue:function(){this.element.find(".e-kpi-card-right-value").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-right-value").removeClass("e-kpi-card-display-flex")},showRightValue:function(){this.element.find(".e-kpi-card-right-value").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-right-value").removeClass("e-kpi-card-display-none")},hideContentImageWrapper:function(){this.element.find(".e-kpi-card-content-image-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-content-image-wrapper").removeClass("e-kpi-card-display-flex")},showContentImageWrapper:function(){this.element.find(".e-kpi-card-content-image-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-content-image-wrapper").removeClass("e-kpi-card-display-none")},hideImageWrapper:function(){this.element.find(".e-kpi-card-kpi-image-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-kpi-image-wrapper").removeClass("e-kpi-card-display-flex")},showImageWrapper:function(){this.element.find(".e-kpi-card-kpi-image-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-kpi-image-wrapper").removeClass("e-kpi-card-display-none")},hideValueContainerMiddle:function(){this.element.find(".e-kpi-card-value-container-middle").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-value-container-middle").removeClass("e-kpi-card-display-flex")},showValueContainerMiddle:function(){this.element.find(".e-kpi-card-value-container-middle").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-value-container-middle").removeClass("e-kpi-card-display-none")},hideValueContainerBottom:function(){this.element.find(".e-kpi-card-value-container-bottom").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-value-container-bottom").removeClass("e-kpi-card-display-flex")},showValueContainerBottom:function(){this.element.find(".e-kpi-card-value-container-bottom").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-value-container-bottom").removeClass("e-kpi-card-display-none")},hideLeftValueContainer:function(){this.element.find(".e-kpi-card-value-container-left").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-value-container-left").removeClass("e-kpi-card-display-flex")},showLeftValueContainer:function(){this.element.find(".e-kpi-card-value-container-left").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-value-container-left").removeClass("e-kpi-card-display-none")},hideRightValueContainer:function(){this.element.find(".e-kpi-card-value-container-right").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-value-container-right").removeClass("e-kpi-card-display-flex")},showLeftIconValueWrapper:function(){this.element.find(".e-kpi-card-left-icon-value-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-left-icon-value-wrapper").removeClass("e-kpi-card-display-none")},hideLeftIconValueWrapper:function(){this.element.find(".e-kpi-card-left-icon-value-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-left-icon-value-wrapper").removeClass("e-kpi-card-display-flex")},showRightIconValueWrapper:function(){this.element.find(".e-kpi-card-right-icon-value-wrapper").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-right-icon-value-wrapper").removeClass("e-kpi-card-display-none")},hideRightIconValueWrapper:function(){this.element.find(".e-kpi-card-right-icon-value-wrapper").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-right-icon-value-wrapper").removeClass("e-kpi-card-display-flex")},showRightValueContainer:function(){this.element.find(".e-kpi-card-value-container-right").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-value-container-right").removeClass("e-kpi-card-display-none")},showSparkline:function(){this.element.find(".e-kpi-card-sparkline-container").addClass("e-kpi-card-display-flex");this.element.find(".e-kpi-card-sparkline-container").removeClass("e-kpi-card-display-none")},hideSparkline:function(){this.element.find(".e-kpi-card-sparkline-container").addClass("e-kpi-card-display-none");this.element.find(".e-kpi-card-sparkline-container").removeClass("e-kpi-card-display-flex")},justifyEnd:function(n){n.removeClass("e-kpi-card-justify-start e-kpi-card-justify-center");n.addClass("e-kpi-card-justify-end")},justifyStart:function(n){n.removeClass("e-kpi-card-justify-end e-kpi-card-justify-center");n.addClass("e-kpi-card-justify-start")},justifyCenter:function(n){n.removeClass("e-kpi-card-justify-start e-kpi-card-justify-end");n.addClass("e-kpi-card-justify-center")},alignEnd:function(n){n.removeClass("e-kpi-card-align-start e-kpi-card-align-center");n.addClass("e-kpi-card-align-end")},alignStart:function(n){n.removeClass("e-kpi-card-align-end e-kpi-card-align-center");n.addClass("e-kpi-card-align-start")},alignCenter:function(n){n.removeClass("e-kpi-card-align-start e-kpi-card-align-end");n.addClass("e-kpi-card-align-center")},resize:function(){this.element.css({height:this.model.size.height+"px",width:this.model.size.width+"px"});this.element.find(".e-kpi-card-sparkline-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.find(".e-kpi-card-information-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.find(".e-kpi-card-background-image-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.responsiveLayout()},resizeSparklineContainer:function(){var n=(this.model.size.height-this.margin)*.2;this.element.find(".e-kpi-card-sparkline-container").css({height:n+"px",width:this.model.size.width-this.margin+"px"});this.resizeSparkline()},resizeSparkline:function(){var i=this.element.find("#"+n(this.element).attr("id")+"-sparkline").data("BoldBIDashboardSparkline");t.isNullOrUndefined(i)||(i.model.size.height=(this.model.size.height-this.margin)*.2,i.model.size.width=this.model.size.width-this.margin,i.redraw())},setValueWrapperHeight:function(){this.updateTitleContainer();var n=this.getFontHight();this.element.find(".e-kpi-card-value-wrapper").css({height:n+"px"})},getFontHight:function(){var f=0,s=0,u=this.model.size.height-this.margin-10,n=0,y=this.element.find(".e-kpi-card-title-text").height(),d=this.element.find(".e-kpi-card-middle-value-text").height(),p=this.element.find(".e-kpi-card-left-value-caption-text").height(),w=this.element.find(".e-kpi-card-right-value-caption-text").height(),h=this.element.find(".e-kpi-card-left-value-text").height(),c=this.element.find(".e-kpi-card-right-value-text").height(),v=this.element.find(".e-kpi-card-indicator").height(),l=d,e=(this.model.size.height-this.margin)*.2,g,b,o,k,a,nt,i,r;switch(this.model.icon.placement){case t.KPICard.IconPlacement.Left:h=h>v?h:v;break;case t.KPICard.IconPlacement.Right:c=c>v?c:v;break;default:l=d>v?d:v}if(l=l<40&&this.isImagePresent()?40:l,this.model.size.height>=296&&!this.model.isFixedLayout)n=this.isBottomContainerPresent()&&(this.isKpiImagewrapperPresent()||this.isTitleWrapperPresent())?n+26:n,n=this.isKpiImagewrapperPresent()&&this.isTitleWrapperPresent()?n+8:n,f=h+c+p+w+25,g=Math.max(this.element.find(".e-kpi-card-right-value-caption-text").width(),this.element.find(".e-kpi-card-right-value-text").width(),this.element.find(".e-kpi-card-left-value-caption-text").width(),this.element.find(".e-kpi-card-left-value-text").width()),this.element.find(".border-line-span").css({width:g+"px",height:"1px"}),this.element.find(".border-line").css({height:"25px",width:"Auto"}),s=y+l+f+n+e;else if(this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout)this.element.find(".e-kpi-card-value-container-left").hasClass("e-kpi-card-display-flex")&&this.element.find(".e-kpi-card-value-container-right").hasClass("e-kpi-card-display-flex")?n+=12:this.isTitleWrapperPresent()&&this.isKpiImagewrapperPresent()&&(n+=8),f=Math.max(h+c,p+w)+12,b=l+y+8,this.element.find(".border-line-span").css({height:Math.max(f,b)+"px",width:"1px"}),this.element.find(".border-line").css({width:"1px",height:"Auto"}),s=Math.max(f,b)+n+e;else if(n=this.isBottomContainerPresent()&&(this.isKpiImagewrapperPresent()||this.isTitleWrapperPresent())?n+26:n,n=this.isKpiImagewrapperPresent()&&this.isTitleWrapperPresent()?n+8:n,n=this.element.find(".e-kpi-card-left-icon-value-wrapper").hasClass("e-kpi-card-display-flex")&&(this.element.find(".e-kpi-card-left-value-caption").hasClass("e-kpi-card-display-flex")||this.element.find(".e-kpi-card-right-icon-value-wrapper").hasClass("e-kpi-card-display-flex")&&this.element.find(".e-kpi-card-right-value-caption").hasClass("e-kpi-card-display-flex"))?n+4:n,f=h+p>w+c?h+p:c+w,this.element.find(".border-line-span").css({height:f+"px",width:"1px"}),this.element.find(".border-line").css({width:"1px",height:"Auto"}),s=y+l+f+n+e,o=26,k=4,this.model.responsiveMargin&&this.model.isFixedLayout){for(a=u;a<s;)if(a=a+2,o=o-2,o<4){nt=4-o;o=4;a=a-nt;break}a<s&&(k=2);this.element.find(".e-kpi-card-title-wrapper").css("margin-top",k+"px");this.element.find(".e-kpi-card-kpi-image-wrapper").css("margin-bottom",k+"px");this.element.find(".e-kpi-card-content-image-wrapper").css("margin-bottom",o/2+"px");this.element.find(".e-kpi-card-value-container-bottom").css("margin-top",+(o/2)+"px")}return i=s,u<i?(r=i-e,u>r?this.isBottomContainerPresent()||this.isTitleWrapperPresent()||this.isKpiImagewrapperPresent()?(this.hideSparkline(),i=r):i=u:this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout?(this.isTitleWrapperPresent()||this.isKpiImagewrapperPresent()?(r=b+n,u>r?(this.hideValueContainerBottom(),this.hideSparkline(),i=r):this.isKpiImagewrapperPresent()?(r=i-e-y,u>r?(this.hideSparkline(),this.hideTitle(),i=r):(this.hideValueContainerBottom(),this.hideTitle(),this.hideSparkline(),i=u)):(this.hideSparkline(),this.hideValueContainerBottom(),i=u)):(this.hideSparkline(),i=u),this.updateBorderLineVisibility()):(r=i-f-e,u>r?this.isTitleWrapperPresent()||this.isKpiImagewrapperPresent()?(this.hideValueContainerBottom(),this.hideSparkline(),i=r):(this.hideSparkline(),wrapper=u):(r=i-f-e-y,this.isKpiImagewrapperPresent()?(this.hideValueContainerBottom(),this.hideSparkline(),this.hideTitle(),i=r):this.isTitleWrapperPresent()?(this.hideValueContainerBottom(),this.hideSparkline(),i=u):(this.hideSparkline(),i=u)))):i=s-e,i},responsiveLayout:function(){this.updateSparklineContainer();this.rearrangeElements();this.updateBottomContainer();this.width>=250&&!this.isNullOrEmptyOrUndefined(this.model.image.data)&&this.model.image.visibility?(this.showImage(),this.hideInformationIcon()):(this.hideImage(),this.model.informationIcon.visibility&&this.model.image.visibility&&!this.isNullOrEmptyOrUndefined(this.model.image.data)?this.showInformationIcon():this.hideInformationIcon());this.updateMiddleValueContainer();this.updateContentImageWrapper();this.updateContentWidth();this.resizeBackgroundContainer();this.width<110?this.model.icon.placement===t.KPICard.IconPlacement.Middle&&this.model.icon.visibility&&this.hideKPIValue():this.model.kpiValue.visibility&&this.showKPIValue();this.setValueWrapperHeight();this.resizeSparklineContainer();this.updateMargins();this.applyAnimation()},rearrangeElements:function(){var t=this.element.find(".border-line"),i=this.element.find(".e-kpi-card-left-value-caption"),r=this.element.find(".e-kpi-card-right-value-caption"),u=this.element.find(".e-kpi-card-left-icon-value-wrapper"),f=this.element.find(".e-kpi-card-right-icon-value-wrapper"),e,n;this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout?(this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-default-layout"),this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-vertical-layout"),this.element.find(".e-kpi-card-value-wrapper").addClass("e-kpi-card-horizontal-layout"),e=this.element.find(".e-kpi-card-value-container-bottom"),e.before(t),u.before(i),this.element.find(".e-kpi-card-left-value-caption-text").css("line-height",1.5),this.element.find(".e-kpi-card-right-value-caption-text").css("line-height",1.5),f.before(r)):this.model.size.height>=296&&!this.model.isFixedLayout?(this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-default-layout"),this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-horizontal-layout"),this.element.find(".e-kpi-card-value-wrapper").addClass("e-kpi-card-vertical-layout"),n=this.element.find(".e-kpi-card-value-container-right"),n.before(t),this.element.find(".e-kpi-card-left-value-caption-text").css("line-height",1.25),this.element.find(".e-kpi-card-right-value-caption-text").css("line-height",1.25),u.after(i),f.after(r)):(this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-horizontal-layout"),this.element.find(".e-kpi-card-value-wrapper").removeClass("e-kpi-card-vertical-layout"),this.element.find(".e-kpi-card-value-wrapper").addClass("e-kpi-card-default-layout"),n=this.element.find(".e-kpi-card-value-container-right"),n.before(t),this.element.find(".e-kpi-card-left-value-caption-text").css("line-height",1.25),this.element.find(".e-kpi-card-right-value-caption-text").css("line-height",1.25),u.after(i),f.after(r))},updateMargins:function(){var n=this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout,t=this.element.find(".e-kpi-card-value-container-bottom").hasClass("e-kpi-card-display-flex"),i=this.element.find(".e-kpi-card-content-image-wrapper").hasClass("e-kpi-card-display-flex"),r=this.element.find(".e-kpi-card-title-wrapper").hasClass("e-kpi-card-display-flex"),u=this.element.find(".e-kpi-card-kpi-image-wrapper").hasClass("e-kpi-card-display-flex");this.model.responsiveMargin||(this.element.find(".e-kpi-card-content-image-wrapper").css("margin-bottom",t&&!n?"13px":"0px"),this.element.find(".e-kpi-card-value-container-bottom").css("margin-top",i&&!n?"13px":"0px"),this.element.find(".e-kpi-card-kpi-image-wrapper").css("margin-bottom",r?"4px":"0px"),this.element.find(".e-kpi-card-title-wrapper").css("margin-top",u?"4px":"0px"));this.element.find(".e-kpi-card-value-container-left").css("margin-bottom",n?"6px":"0px");this.element.find(".e-kpi-card-value-container-right").css("margin-top",n?"6px":"0px")},applyAnimation:function(){var t,i,r;this.model.animationSettings.enableAnimation&&(this.model.kpiValue.visibility&&(t=this.element.find(".e-kpi-card-middle-value-text"),n(t).stop(),n(t).prop("Counter",0).animate({Counter:this.getCalculatedValue(this.model.kpiValue.type)},{duration:this.model.animationSettings.animationDuration,easing:"swing",step:n.proxy(this.animateNumbers,this)})),this.model.leftValue.visibility&&(i=this.element.find(".e-kpi-card-left-value-text"),n(i).stop(),n(i).prop("Counter",0).animate({Counter:this.getCalculatedValue(this.model.leftValue.type)},{duration:this.model.animationSettings.animationDuration,easing:"swing",step:n.proxy(this.animateLeftNumbers,this)})),this.model.rightValue.visibility&&(r=this.element.find(".e-kpi-card-right-value-text"),n(r).stop(),n(r).prop("Counter",0).animate({Counter:this.getCalculatedValue(this.model.rightValue.type)},{duration:this.model.animationSettings.animationDuration,easing:"swing",step:n.proxy(this.animateRightNumbers,this)})))},animateLeftNumbers:function(i){if(!t.isNullOrUndefined(this.element)){var u=this.element.find(".e-kpi-card-left-value-text"),r=JSON.parse(JSON.stringify(this.model.valueRepresentation));this.formatting.isIntegerValue(this.getCalculatedValue(this.model.kpiValue.type))&&i!==this.getCalculatedValue(this.model.leftValue.type)&&(r.numberOfDecimals=0);n(u).text(this.formatting.applyFormat(i,r))}},animateRightNumbers:function(i){if(!t.isNullOrUndefined(this.element)){var u=this.element.find(".e-kpi-card-right-value-text"),r=JSON.parse(JSON.stringify(this.model.valueRepresentation));this.formatting.isIntegerValue(this.getCalculatedValue(this.model.kpiValue.type))&&i!==this.getCalculatedValue(this.model.rightValue.type)&&(r.numberOfDecimals=0);n(u).text(this.formatting.applyFormat(i,r))}},animateNumbers:function(i){if(!t.isNullOrUndefined(this.element)){var u=this.element.find(".e-kpi-card-middle-value-text"),r=JSON.parse(JSON.stringify(this.model.valueRepresentation));this.formatting.isIntegerValue(this.getCalculatedValue(this.model.kpiValue.type))&&i!==this.getCalculatedValue(this.model.kpiValue.type)&&(r.numberOfDecimals=0);switch(this.model.kpiValue.type){case t.KPICard.ValueType.AbsoluteDifference:case t.KPICard.ValueType.ActualValue:case t.KPICard.ValueType.TargetValue:n(u).text(this.formatting.applyFormat(i,r));break;default:n(u).text(this.adjustDemicalPlacesOnly(i,r))}}},updateTitleContainer:function(){this.model.title.visibility&&!this.isNullOrEmptyOrUndefined(this.model.title.text)?this.showTitle():this.hideTitle()},updateMiddleValueContainer:function(){var n=this.element.find(".e-kpi-card-indicator-container"),i=this.element.find(".e-kpi-card-middle-value-container");this.model.kpiValue.visibility||this.model.icon.visibility&&this.model.icon.placement===t.KPICard.IconPlacement.Middle?(this.showValueContainerMiddle(),this.showImageWrapper()):(this.hideValueContainerMiddle(),this.isImagePresent()?this.showImageWrapper():this.hideImageWrapper());this.model.kpiValue.visibility?this.showKPIValue():this.hideKPIValue()},updateContentImageWrapper:function(){this.element.find(".e-kpi-card-title-wrapper").hasClass("e-kpi-card-display-flex")||this.element.find(".e-kpi-card-kpi-image-wrapper").hasClass("e-kpi-card-display-flex")?this.showContentImageWrapper():this.hideContentImageWrapper()},updateBottomContainer:function(){this.updateLeftValueContainer();this.updateRightValueContainer();this.element.find(".e-kpi-card-value-container-left").hasClass("e-kpi-card-display-none")&&this.element.find(".e-kpi-card-value-container-right").hasClass("e-kpi-card-display-none")?this.hideValueContainerBottom():(this.showValueContainerBottom(),this.updateBottomContainerElementsAlingment());this.updateBorderLineVisibility()},updateLeftValueContainer:function(){var n=this.element.find(".e-kpi-card-value-container-left");this.model.leftValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.leftValue.caption)||this.model.leftValue.visibility||this.model.icon.placement===t.KPICard.IconPlacement.Left&&this.model.icon.visibility?this.showLeftValueContainer():this.hideLeftValueContainer();this.updateLeftCaptionVisibility();this.updateLeftIconValueWrapper();this.updateLeftValueVisibility();this.leftContainerElementsAlignment()},updateLeftIconValueWrapper:function(){this.model.leftValue.visibility||this.model.icon.placement===t.KPICard.IconPlacement.Left&&this.model.icon.visibility?this.showLeftIconValueWrapper():this.hideLeftIconValueWrapper()},updateLeftValueVisibility:function(){this.model.leftValue.visibility?this.showLeftValue():this.showLeftValue()},updateLeftCaptionVisibility:function(){this.model.leftValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.leftValue.caption)?this.showLeftCaption():this.hideLeftCaption()},updateRightValueContainer:function(){var n=this.element.find(".e-kpi-card-value-container-right");this.model.rightValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.rightValue.caption)||this.model.rightValue.visibility||this.model.icon.placement===t.KPICard.IconPlacement.Right&&this.model.icon.visibility?this.showRightValueContainer():this.hideRightValueContainer();this.updateRightCaptionVisibility();this.updateRightIconValueWrapper();this.updateRightValueVisibility();this.rightContainerElementsAlignment()},updateRightIconValueWrapper:function(){this.model.rightValue.visibility||this.model.icon.placement===t.KPICard.IconPlacement.Right&&this.model.icon.visibility?this.showRightIconValueWrapper():this.hideRightIconValueWrapper()},updateRightValueVisibility:function(){this.model.rightValue.visibility?this.showRightValue():this.hideRightValue()},updateRightCaptionVisibility:function(){this.model.rightValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.rightValue.caption)?this.showRightCaption():this.hideRightCaption()},updateBottomContainerElementsAlingment:function(){for(var i=this.element.find(".e-kpi-card-value-container-bottom").children(),t=0;t<=i.length;t++)n(i[t]).hasClass("border-line")||this.justifyCenter(n(i[t]))},updateIndicatorContainer:function(){var i,n,r,u;this.model.icon.visibility?this.showIndicator():this.hideIndicator();i=this.getIconParent();n=this.element.find(".e-kpi-card-indicator-container");this.model.icon.position===t.KPICard.IconPosition.Right?(n.detach().appendTo(i),r=this.model.icon.placement===t.KPICard.IconPlacement.Left?"0px":"8px",n.css({"margin-left":"8px","margin-right":r})):(n.detach().prependTo(i),u=this.model.icon.placement===t.KPICard.IconPlacement.Right?"0px":"8px",n.css({"margin-left":u,"margin-right":"8px"}))},updateSparklineContainer:function(){this.element.find(".e-kpi-card-sparkline-container");this.isSparklinePresent()?this.showSparkline():this.hideSparkline()},resizeBackgroundContainer:function(){this.element.find(".e-kpi-card-background-image-container").addClass("e-kpi-card-plotarea-default");this.element.find(".e-kpi-card-background-image-container").removeClass("e-kpi-card-plotarea-content")},updateVerticalAlignment:function(){var n=this.element.find(".e-kpi-card-title-container"),t=this.element.find(".e-kpi-card-value-container-middle"),i=this.element.find(".e-kpi-card-value-container-bottom");this.setAlignment(n,this.model.alignment.titleContainer);this.setAlignment(t,this.model.alignment.kpiContainer);this.setAlignment(i,this.model.alignment.bottomContainer)},setAlignment:function(n,i){switch(i){case t.KPICard.Alignment.Center:this.alignCenter(n);break;case t.KPICard.Alignment.Start:this.alignStart(n);break;case t.KPICard.Alignment.End:this.alignEnd(n)}},isKpiImagewrapperPresent:function(){return this.element.find(".e-kpi-card-kpi-image-wrapper").hasClass("e-kpi-card-display-flex")},isTitleWrapperPresent:function(){return this.element.find(".e-kpi-card-title-wrapper").hasClass("e-kpi-card-display-flex")},isLeftAndRightPresent:function(){return(this.model.leftValue.visibility||this.model.leftValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.leftValue.caption)||this.model.icon.placement===t.KPICard.IconPlacement.Left&&this.model.icon.visibility)&&(this.model.rightValue.visibility||this.model.rightValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.rightValue.caption)||this.model.icon.placement===t.KPICard.IconPlacement.Right&&this.model.icon.visibility)},isAnyBottomContainerElementPresent:function(){return this.model.icon.placement===t.KPICard.IconPlacement.Left&&this.model.icon.visibility&&this.element.find(".e-kpi-card-indicator-container").hasClass("e-kpi-card-display-flex")||this.model.leftValue.visibility&&this.element.find(".e-kpi-card-left-value").hasClass("e-kpi-card-display-flex")||this.model.leftValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.leftValue.caption)&&this.element.find(".e-kpi-card-left-value-caption").hasClass("e-kpi-card-display-flex")||this.model.rightValue.visibility&&this.element.find(".e-kpi-card-right-value").hasClass("e-kpi-card-display-flex")||this.model.rightValue.captionVisibility&&!this.isNullOrEmptyOrUndefined(this.model.rightValue.caption)&&this.element.find(".e-kpi-card-right-value-caption").hasClass("e-kpi-card-display-flex")||this.model.icon.placement===t.KPICard.IconPlacement.Right&&this.model.icon.visibility&&this.element.find(".e-kpi-card-indicator-container").hasClass("e-kpi-card-display-flex")},isBottomContainerPresent:function(){return this.element.find(".e-kpi-card-value-container-bottom").hasClass("e-kpi-card-display-flex")},isImagePresent:function(){return this.element.find(".e-kpi-card-image-wrapper").hasClass("e-kpi-card-display-flex")&&this.model.image.visibility},isSparklinePresent:function(){return this.model.sparkline.visibility&&!t.isNullOrUndefined(this.model.sparkline.data)&&this.model.sparkline.data.length>0},leftContainerElementsAlignment:function(){var e=!this.model.rightValue.visibility&&(!this.model.rightValue.captionVisibility||this.isNullOrEmptyOrUndefined(this.model.leftValue.caption))&&!(this.model.icon.placement===t.KPICard.IconPlacement.Right&&this.model.icon.visibility),f,i;if(this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout){var r=this.element.find(".e-kpi-card-left-value-caption"),u=this.element.find(".e-kpi-card-left-icon-value-wrapper"),o=r.hasClass("e-kpi-card-display-flex")&&u.hasClass("e-kpi-card-display-flex");e?(this.alignCenter(r),this.alignCenter(u)):(this.alignEnd(r),this.alignEnd(u));o?(this.justifyEnd(r),this.justifyStart(u)):(this.justifyCenter(r),this.justifyCenter(u))}else for(f=this.element.find(".e-kpi-card-value-container-left").children(),i=0;i<=f.length;i++)e?this.justifyCenter(n(f[i])):this.model.size.height>=296&&!this.model.isFixedLayout?this.justifyCenter(n(f[i])):this.justifyEnd(n(f[i]))},updateBorderLineVisibility:function(){var n=this.model.separator.visibility&&(this.model.size.width>=447&&this.model.size.height<296?this.element.find(".e-kpi-card-value-container-bottom").hasClass("e-kpi-card-display-flex")&&this.element.find(".e-kpi-card-content-image-wrapper").hasClass("e-kpi-card-display-flex"):this.isLeftAndRightPresent());n?this.showBorderLine():this.hideBorderLine()},rightContainerElementsAlignment:function(){var e=!this.model.leftValue.visibility&&(!this.model.leftValue.captionVisibility||this.isNullOrEmptyOrUndefined(this.model.leftValue.caption))&&!(this.model.icon.placement===t.KPICard.IconPlacement.Left&&this.model.icon.visibility),f,i;if(this.model.size.width>=447&&this.model.size.height<296&&!this.model.isFixedLayout){var r=this.element.find(".e-kpi-card-right-value-caption"),u=this.element.find(".e-kpi-card-right-icon-value-wrapper"),o=r.hasClass("e-kpi-card-display-flex")&&u.hasClass("e-kpi-card-display-flex");e?(this.alignCenter(r),this.alignCenter(u)):(this.alignStart(r),this.alignStart(u));o?(this.justifyEnd(r),this.justifyStart(u)):(this.justifyCenter(r),this.justifyCenter(u))}else for(f=this.element.find(".e-kpi-card-value-container-right").children(),i=0;i<=f.length;i++)e?this.justifyCenter(n(f[i])):this.model.size.height>=296&&!this.model.isFixedLayout?this.justifyCenter(n(f[i])):this.justifyStart(n(f[i]))},isNullOrEmptyOrUndefined:function(n){return n===null||n===""||typeof n=="undefined"},_destroy:function(){this.unwireEvents();this.element.empty()},_selectedHandler:function(t){var i=this;this._hideTooltip();this.singleTimer=setTimeout(function(){var r={};i.model.selected&&(r={model:i.model,currentTarget:n("#"+i.element.attr("id")),PageX:t.pageX,PageY:t.pageY},i._trigger("selected",r),t.stopPropagation(),t.bubbles=!1)},400)},_hideTooltip:function(i){t.isNullOrUndefined(i)||(i.bubbles=!1,n.isFunction(i.stopPropagation)&&i.stopPropagation());this.singleTimer&&clearTimeout(this.singleTimer);this.singleTimer=setTimeout(()=>{t.isNullOrUndefined(n("#"+this.pluginName+"_Track_ToolTip_Template"))||n("#"+this.pluginName+"_Track_ToolTip_Template").css("display","none")},50)},_toolTipInitializeHandler:function(t){var i=this,r={};this.singleTimer=setTimeout(function(){var e=i.getFormattedValue(i.model.kpiValue.type,i.model.valueRepresentation),o=i.getFormattedValue(i.model.leftValue.type,i.model.valueRepresentation),s=i.getFormattedValue(i.model.rightValue.type,i.model.valueRepresentation),u,f;if(r={model:i.model,currentTarget:t.target,PageX:t.pageX,PageY:t.pageY,data:{actualValue:o,currentText:t.target.getAttribute("data-tooltip"),kpiValue:e,targetValue:s}},i._trigger("toolTipInitialize",r),i.model.enableTooltip){u=n("#"+i.pluginName+"_Track_ToolTip_Template");u.length===0&&(u=n("<div id='"+i.pluginName+"_Track_ToolTip_Template' class='bbi-kpi-card-tooltip'><\/div>"),n(document.body).append(u[0]));f={position:"absolute",top:t.pageY+n(document).scrollTop(),left:t.pageX+n(document).scrollLeft(),"border-style":"solid","border-color":"transparent","border-width":1,opacity:1,"z-index":1e5,"border-radius":"0px","padding-left":"5px","padding-right":"5px","padding-top":"2px","padding-bottom":"2px"};n(u).css(f);n("#"+i.pluginName+"_Track_ToolTip_Template").html(r.data.currentText);t.pageX=t.pageX+5;t.pageY=t.pageY+20;var h=t.pageX+n("#"+i.pluginName+"_Track_ToolTip_Template").outerWidth(!0),c=n(document).width(),l=t.pageY+n("#"+i.pluginName+"_Track_ToolTip_Template").outerHeight(!0),a=n(document).height();h>c&&(t.pageX=t.pageX-n("#"+i.pluginName+"_Track_ToolTip_Template").outerWidth(!0));l>a&&(t.pageY=t.pageY-n("#"+i.pluginName+"_Track_ToolTip_Template").outerHeight(!0));n("#"+i.pluginName+"_Track_ToolTip_Template").css({top:`${t.pageY}px`,left:`${t.pageX}px`,display:"block"});t.stopPropagation();t.bubbles=!1}},10)}});t.KPICard.ValueType={AbsoluteDifference:"Absolute Difference",PercentOfDifference:"Percent of Difference",PercentOfTarget:"Percent of Target",ActualValue:"Actual Value",TargetValue:"Target Value",PercentOfChange:"Percent of Change"};t.KPICard.SparklineType={Line:"line",Column:"column",Area:"area"};t.KPICard.ImageModes={Default:"Default",Fill:"Fill",Uniform:"Uniform",UniformToFill:"Uniform To Fill"};t.KPICard.Representation={Auto:"Auto",Ones:"Ones",Thousands:"Thousands",Lakhs:"Lakhs",Millions:"Millions",Crores:"Crores",Billions:"Billions"};t.KPICard.Format={Number:"Number",Currency:"Currency",Percentage:"Percentage"};t.KPICard.NegativeValueFormat={Default:"default",NoNegativeSignWithBracket:"nonegativesignwithbracket",NegativeSignInSuffix:"negativesigninsuffix"};t.KPICard.PlotArea={Complete:"Complete",KPIBackground:"KPI Background"};t.KPICard.ImageType={URL:"url",Base64:"base64"};t.KPICard.IconPlacement={Middle:"KPI Value",Left:"Left Value",Right:"Right Value"};t.KPICard.IconPosition={Left:"Left",Right:"Right"};t.KPICard.Alignment={Start:"Start",Center:"Center",End:"End"}}(bbdesigner$,SyncfusionBoldBIDashboard),function(n,t){t.widget("BoldBIDashboardNumberCard","BoldBIDashboard.NumberCard",{element:null,model:null,defaults:{title:{text:"",foreground:"black",visibility:!0,fontSize:"14",fontFamily:"",fontWeight:"",isColorCustomized:!1,position:"Bottom",enableWrap:!1,fontSettings:{IsBold:!1,IsItalic:!1,IsUnderLine:!1,IsStrikeThrough:!1}},description:{text:"",visibility:!1,color:"#1a1a1a"},animationSettings:{enableAnimation:!0,animationDuration:1500},measure:{text:"",foreground:"black",visibility:!0,fontSize:"36",fontFamily:"",fontWeight:"",isColorCustomized:!1,fontSettings:{IsBold:!1,IsItalic:!1,IsUnderLine:!1,IsStrikeThrough:!1}},valueRepresentation:{format:"Number",representation:"Auto",numberOfDecimals:2,currencyCulture:"en-US",decimalSeparator:{CurrentValue:".",AliasValue:"."},groupSeparator:{CurrentValue:",",AliasValue:","},negativeValueFormat:"default",prefix:"",suffix:"",enableLakhsAndCroreRep:!1},dimension:{text:"",foreground:"black",visibility:!0,fontSize:"24",isColorCustomized:!1,fontSettings:{IsBold:!1,IsItalic:!1,IsUnderLine:!1,IsStrikeThrough:!1}},icon:{type:null,path:"",color:"",followDirectionColor:!0,visibility:!1,fontSize:"",customizedIcon:"",isIconCustomized:!1,mode:""},image:{mode:"Fill",data:null,visibility:!0,isImageCustomized:!1,position:"Right"},background:{mode:"Fill",image:null,showImage:!0,plotArea:"default",color:"",opacity:"",isColorCustomized:!1,isImageCustomized:!1},sparkline:{data:null,fill:"",type:"area",visibility:!1,opacity:.2,followDirectionColor:!0,isColorCustomized:!1},hiddenColumns:[],informationIcon:{visibility:!1},alignment:{horizontal:"Left",vertical:"Top"},autoFontSize:{fontSizeFactor:1,enable:!1,measureText:"",titleText:""},responsiveMargin:!1,tooltip:{"class":"",attribute:"",text:""},enableToolTip:!1},_init:function(){this._initializePrivateVariables();this._createLayout();this._wireEvents();this._updateVisibility();this._updateData();this._updateCardAlignment();this._responsiveLayout()},_initializePrivateVariables:function(){this.margin=0;this._tooltipClass=this.model.tooltip.class;this.formatting=new NumberFormatting;this._initializeMargins()},_initializeMargins:function(){this.marginTop=this.model.alignment.vertical==="Center"?0:this.model.alignment.vertical==="Bottom"?2:window.screen.width<1920?8:12;this.marginTopWithSparkline=this.model.alignment.vertical==="Center"?0:this.model.alignment.vertical==="Bottom"?2:window.screen.width<1920?8:12;this.inBetweenMargin=window.screen.width<1920?4:4;this.bottomMargin=this.model.alignment.vertical==="Center"?0:this.model.alignment.vertical==="Top"?2:window.screen.width<1920?8:12;this.bottomMarginWithSparkline=this.model.alignment.vertical==="Center"?0:this.model.alignment.vertical==="Top"?2:window.screen.width<1920?8:12},_wireEvents:function(){this._on(this.element,"click",this._selectedHandler);this._on(this.element,"mousemove",this._toolTipInitializeHandler);this._on(this.element,"mouseleave",this._hideTooltip);this._on(this.element,"mouseover",".e-number-card-description-text",this._showTooltipDescription);this._on(this.element,"mouseout",".e-number-card-description-text",this._hideTooltipDescription)},_unwireEvents:function(){this._off(this.element,"click",this._selectedHandler);this._off(this.element,"mousemove",this._toolTipInitializeHandler);this._off(this.element,"mouseleave",this._hideTooltip);this._off(this.element,"mouseover",".e-number-card-description-text",this._showTooltipDescription);this._off(this.element,"mouseout",".e-number-card-description-text",this._hideTooltipDescription)},_setModel:function(n){for(var t in n)if(n.hasOwnProperty(t))switch(t){case"icon":this.updateMiddleValueContainer();this.updateIcon();this.updateBottomContainerElementsAlingment();this.responsiveLayout();break;case"title":this._updateTitleVisibility();this._updateTitle();this._responsiveLayout();break;case"description":this._updateDescriptionVisibility();this._updateDescription();this._responsiveLayout();break;case"image":this._updateImage();this._responsiveLayout();break;case"sparkline":this._updateSparklineVisibility();this._updateSparkline();this._responsiveLayout();break;case"informationIcon":this._responsiveLayout();break;case"size":this._initializeMargins();this._updateTitle();this._updateMeasure();this._resize();break;case"measure":this._updateMeasureVisibility();this._updateMeasure();this._applyAnimation();this._responsiveLayout();break;case"animationSettings":this._applyAnimation();break;case"dimension":this._updateDimensionVisibility();this._updateDimension();this._applyAnimation();this._updateWrapperHeight();break;case"colorSettings":this._updateMeasure();this._updateDimension();this._updateIcon();this._updateSparklineColor();this._applyAnimation();break;case"background":this._resizeBackgroundContainer();this._updateBackgroundImage();this._applyAnimation();break;case"tooltip":this._updateElementsTooltip();this._updateInformationTooltip();this._applyAnimation();this._tooltipClass=this.model.tooltip.class;break;case"alignment":this._updateCardAlignment();this._initializeMargins();this._responsiveLayout();break;case"autoFontSize":this._updateTitle();this._updateMeasure();this._responsiveLayout();break;case"responsiveMargin":this._initializeMargins();this._responsiveLayout()}},_createLayout:function(){var t=this.element,i;t.css({height:this.model.size.height+"px",width:this.model.size.width+"px"});this._createBackgroundImageWrapper();i=n("<div>").addClass("e-number-card-sparkline-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});t.append(i);this._createIconWrapper();this._createCardWrapperParent();this._createCardWrapper();this._createCardValueWrapper();this._creteContentWrapper();this._createImageElement();this._createMeasureWrapper();this._createTitleElement();this._createDimensionContainer();this._createIconElement();this._createnumberElement();this._createSparklineContainer()},_updateVisibility:function(){this._updateTitleVisibility();this._updateDescriptionVisibility();this._updateDimensionVisibility();this._updateIconVisibility();this._updateMeasureVisibility();this._updateImageVisibility();this._resizeBackgroundContainer();this._updateSparklineVisibility();this._updateContentImageWrapper();this._updateMargin()},_updateData:function(){this._updateTitle();this._updateDescription();this._updateDimension();this._updateMeasure();this._updateIcon();this._updateImage();this._updateBackgroundImage();this._updateSparkline();this._updateInformationTooltip()},_createIconWrapper:function(){var i=n(this.element).find(".e-number-card-sparkline-wrapper"),t=n("<div>").addClass("e-number-card-information-wrapper e-number-card-display-none").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});i.append(t);t.append(n("<div>").addClass("e-number-card-information-icon"))},_createCardWrapperParent:function(){var t=this.element.find(".e-number-card-sparkline-wrapper");t.append(n("<div>").addClass("e-number-card-wrapper-parent e-number-card-image-styles"))},_createCardWrapper:function(){var t=this.element.find(".e-number-card-wrapper-parent");t.append(n("<div>").addClass("e-number-card-wrapper"))},_createTableCellElement:function(){var t=this.element.find(".e-number-card-wrapper");t.append(n("<div>").addClass("e-number-card-table-cell"))},_createCardValueWrapper:function(){var t=this.element.find(".e-number-card-wrapper");t.append(n("<div>").addClass("e-number-card-value-wrapper").css({height:this.height-this.margin+"px"}))},_createTitleElement:function(){var i=n(this.element).find(".e-number-card-value-wrapper"),t=n("<div>").addClass("e-number-card-title-container");t.append(n("<div>").addClass("e-number-card-title-text "+this.model.tooltip.class+" e-number-card-text-ellipsis"));t.append(n("<div>").addClass("e-number-card-description-text "+this.model.tooltip.class));i.append(t)},_createDimensionContainer:function(){var i=n(this.element).find(".e-number-card-value-wrapper"),t=n("<div>").addClass("e-number-card-dimension-container");i.append(t);t.append(n("<div>").addClass("e-number-card-dimension-text "+this.model.tooltip.class+" e-number-card-text-ellipsis"))},_creteContentWrapper:function(){var t=n(this.element).find(".e-number-card-value-wrapper"),i=n("<div>").addClass("e-number-card-content-image-wrapper e-number-card-justify-center");t.append(i)},_createMeasureWrapper:function(){var t=n(this.element).find(".e-number-card-content-image-wrapper"),i=n("<div>").addClass("e-number-card-measure-wrapper e-number-card-justify-center");t.append(i)},_createImageElement:function(){var i=n(this.element).find(".e-number-card-content-image-wrapper"),t=n("<div>").addClass("e-number-card-image-wrapper");i.append(t);t.append(n("<div>").addClass("e-number-card-image-container e-number-card-image-styles"))},_createIconElement:function(){var i=n(this.element).find(".e-number-card-measure-wrapper"),t=n("<div>").addClass("e-number-card-icon-container");t.append(n("<div>").addClass("e-number-card-icon"));i.prepend(t)},_createnumberElement:function(){var i=n(this.element).find(".e-number-card-measure-wrapper"),t=n("<div>").addClass("e-number-card-measure-container e-number-card-text-ellipsis");t.append(n("<div>").addClass("e-number-card-measure-text "+this.model.tooltip.class+" e-number-card-text-ellipsis"));i.append(t)},_createSparklineContainer:function(){var r=n(this.element).find(".e-number-card-sparkline-wrapper"),t=n("<div>").addClass("e-number-card-sparkline-container"),i;r.append(t);t.append(n("<div>").attr("id",n(this.element).attr("id")+"-sparkline"));i=n("<div>").addClass("e-sparkline-gradient-container");this.element.append(i)},_createBackgroundImageWrapper:function(){var t=n("<div>").addClass("e-number-card-background-image-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.append(t);t.append(n("<div>").addClass("e-number-card-background-image-container e-number-card-image-styles"))},_updateTitleVisibility:function(){this.model.title.visibility?this._showTitle():this._hideTitle()},_updateDescriptionVisibility:function(){this.model.description.visibility?this._showDescription():this._hideDescription()},_updateDimensionVisibility:function(){this.model.dimension.visibility?this._showDimension():this._hideDimension()},_updateIconVisibility:function(){this.model.icon.visibility?this._showIcon():this._hideIcon();this._updateMeasureWrapper()},_updateMeasureVisibility:function(){this.model.measure.visibility?this._showMeasure():this._hideMeasure();this._updateMeasureWrapper()},_updateMeasureWrapper:function(){this.model.measure.visibility||this.model.icon.visibility?this._showMeasureWrapper():this._hideMeasureWrapper()},_updateImageVisibility:function(){this.model.image.visibility||this.model.image.visibility?this._showImage():this._hideImage()},_resizeBackgroundContainer:function(){this.element.find(".e-number-card-background-image-container").addClass("e-number-card-plotarea-default");this.element.find(".e-number-card-background-image-container").removeClass("e-number-card-plotarea-content")},_updateSparklineVisibility:function(){this._isSparklinePresent()?this._showSparkline():this._hideSparkline()},_updateTitleWrap:function(){var a,v,y,p,i;if(this.model.title.visibility&&this.model.title.enableWrap&&!t.isNullOrUndefined(this.model.title.text)&&this.model.title.text.length>0&&this.model.title.text.indexOf(" ")>0){var s=16,h=16,w=this.model.size.width-s-h;this.element.find(".e-number-card-wrapper-parent").css({width:w+"px","margin-left":s+"px","margin-right":h+"px"});var c=this.element.find(".e-number-card-title-text").width(),e=this.model.size.height-this.margin-this.marginTop-this.bottomMargin,o=this.element.find(".e-number-card-title-text").height(),l=this.model.description.visibility?this.element.find(".e-number-card-description-text").height()+10:0;o<l&&(o=l);a=this._isSparklinePresent()?(this.model.size.height-this.margin-this.marginTop-this.bottomMargin)*.2:0;v=this.element.find(".e-number-card-title-container").hasClass("e-number-card-display-flex")&&this.element.find(".e-number-card-content-image-wrapper").hasClass("e-number-card-display-flex")?this.inBetweenMargin*2:0;e=e-(this._getFontHight(!0)+v-o-a);this.element.find(".e-number-card-title-container").append(n("<div>").addClass("temp-wrapper-class").css({"white-space":"nowrap","text-overflow":"unset","font-size":this._getResolutionBasedFontSize(this.model.title.fontSize)+"px","line-height":1.25}));this.element.find(".temp-wrapper-class").html(this.model.title.text);t.isNullOrUndefined(this.model.title.fontSettings)||this._updateFontSettings(this.element.find(".temp-wrapper-class"),this.model.title.fontSettings);y=this.element.find(".temp-wrapper-class").height();p=parseInt(e/y);this.element.find(".e-number-card-title-text").html("");var r="",u=this.model.title.text.split(" "),f=0;for(i=0;i<u.length;i++)this.element.find(".temp-wrapper-class").html(r+u[i]),f<p-1?c>this.element.find(".temp-wrapper-class").width()?i===u.length-1?(r+=u[i],this.element.find(".e-number-card-title-text").append(n("<div>").html(r.trim()))):r+=u[i]+" ":(this.element.find(".temp-wrapper-class").html(u[i]),c>this.element.find(".temp-wrapper-class").width()?(this.element.find(".e-number-card-title-text").append(n("<div>").html(r.trim())),f++,i=i-1):r.length>0?(this.element.find(".e-number-card-title-text").append(n("<div>").html(r.trim())),f++,i=i-1):(this.element.find(".e-number-card-title-text").append(n("<div>").html(u[i]).addClass("e-number-card-text-ellipsis")),f++),r="",this.element.find(".temp-wrapper-class").html("")):i===u.length-1?(r+=u[i],this.element.find(".e-number-card-title-text").append(n("<div>").html(r.trim()).addClass("e-number-card-text-ellipsis"))):r+=u[i]+" ";this.element.find(".e-number-card-title-container").find(".temp-wrapper-class").remove()}},_updateContentImageWrapper:function(){this.element.find(".e-number-card-measure-wrapper").hasClass("e-number-card-display-flex")||this.element.find(".e-number-card-image-wrapper").hasClass("e-number-card-display-flex")?this._showContentImageWrapper():this._hideContentImageWrapper()},_showContentImageWrapper:function(){this.element.find(".e-number-card-content-image-wrapper").addClass("e-number-card-display-flex");this.element.find(".e-number-card-content-image-wrapper").removeClass("e-number-card-display-none")},_hideContentImageWrapper:function(){this.element.find(".e-number-card-content-image-wrapper").addClass("e-number-card-display-none");this.element.find(".e-number-card-content-image-wrapper").removeClass("e-number-card-display-flex")},_showTitle:function(){this.element.find(".e-number-card-title-container").addClass("e-number-card-display-flex");this.element.find(".e-number-card-title-container").removeClass("e-number-card-display-none")},_hideTitle:function(){this.element.find(".e-number-card-title-container").addClass("e-number-card-display-none");this.element.find(".e-number-card-title-container").removeClass("e-number-card-display-flex")},_showDescription:function(){this.element.find(".e-number-card-description-text").addClass("e-number-card-display-flex");this.element.find(".e-number-card-description-text").removeClass("e-number-card-display-none")},_hideDescription:function(){this.element.find(".e-number-card-description-text").addClass("e-number-card-display-none");this.element.find(".e-number-card-description-text").removeClass("e-number-card-display-flex")},_showDimension:function(){this.element.find(".e-number-card-dimension-container").addClass("e-number-card-display-flex");this.element.find(".e-number-card-dimension-container").removeClass("e-number-card-display-none")},_hideDimension:function(){this.element.find(".e-number-card-dimension-container").addClass("e-number-card-display-none");this.element.find(".e-number-card-dimension-container").removeClass("e-number-card-display-flex")},_showIcon:function(){this.element.find(".e-number-card-icon-container").addClass("e-number-card-display-flex");this.element.find(".e-number-card-icon-container").removeClass("e-number-card-display-none")},_hideIcon:function(){this.element.find(".e-number-card-icon-container").addClass("e-number-card-display-none");this.element.find(".e-number-card-icon-container").removeClass("e-number-card-display-flex")},_showMeasure:function(){this.element.find(".e-number-card-measure-container").addClass("e-number-card-display-flex");this.element.find(".e-number-card-measure-container").removeClass("e-number-card-display-none")},_hideMeasure:function(){this.element.find(".e-number-card-measure-container").addClass("e-number-card-display-none");this.element.find(".e-number-card-measure-container").removeClass("e-number-card-display-flex")},_showMeasureWrapper:function(){this.element.find(".e-number-card-measure-wrapper").addClass("e-number-card-display-flex");this.element.find(".e-number-card-measure-wrapper").removeClass("e-number-card-display-none")},_hideMeasureWrapper:function(){this.element.find(".e-number-card-measure-wrapper").addClass("e-number-card-display-none");this.element.find(".e-number-card-measure-wrapper").removeClass("e-number-card-display-flex")},_showImage:function(){this.element.find(".e-number-card-image-wrapper").addClass("e-number-card-display-flex");this.element.find(".e-number-card-image-wrapper").removeClass("e-number-card-display-none")},_hideImage:function(){this.element.find(".e-number-card-image-wrapper").addClass("e-number-card-display-none");this.element.find(".e-number-card-image-wrapper").removeClass("e-number-card-display-flex")},_showSparkline:function(){this.element.find(".e-number-card-sparkline-container").addClass("e-number-card-display-flex");this.element.find(".e-number-card-sparkline-container").removeClass("e-number-card-display-none")},_hideSparkline:function(){this.element.find(".e-number-card-sparkline-container").addClass("e-number-card-display-none");this.element.find(".e-number-card-sparkline-container").removeClass("e-number-card-display-flex")},_showInformationIcon:function(){this.element.find(".e-number-card-information-wrapper").addClass("e-number-card-display-flex");this.element.find(".e-number-card-information-wrapper").removeClass("e-number-card-display-none")},_hideInformationIcon:function(){this.element.find(".e-number-card-information-wrapper").addClass("e-number-card-display-none");this.element.find(".e-number-card-information-wrapper").removeClass("e-number-card-display-flex")},_updateTitle:function(){var n=this.element.find(".e-number-card-title-text");n.html(this.model.title.text).css({color:this.model.title.foreground,"font-size":this._getResolutionBasedFontSize(this.model.title.fontSize)+"px","font-weight":this.model.title.fontWeight,"font-family":this.model.title.fontFamily}).attr({"data-tooltip":this.model.title.text});t.isNullOrUndefined(this.model.title.fontSettings)||this._updateFontSettings(n,this.model.title.fontSettings)},_updateDescription:function(){var n=this.element.find(".e-number-card-description-text");n.addClass(this.model.tooltip.class).css({"font-size":this._getIconFontSizeBasedOnResolution(),color:this.model.description.color}).attr(this.model.tooltip.attribute,this.model.description.text)},_updateDimension:function(){var n=this.element.find(".e-number-card-dimension-text");n.html(this.model.dimension.text).css({color:this.model.dimension.foreground,"font-size":this.model.dimension.fontSize+"px"}).attr({"data-tooltip":this.model.dimension.text});this._updateFontSettings(n,this.model.dimension.fontSettings)},_updateMeasure:function(){var n=this.element.find(".e-number-card-measure-text"),t=this.formatting.applyFormat(this.model.measure.text,this.model.valueRepresentation);n.html(t).css({color:this.model.measure.foreground,"font-size":this._getResolutionBasedFontSize(this.model.measure.fontSize)+"px","font-weight":this.model.measure.fontWeight,"font-family":this.model.measure.fontFamily}).attr({"data-tooltip":t});this._updateFontSettings(n,this.model.measure.fontSettings)},_updateIcon:function(){var n=this.element.find(".e-number-card-icon-container");n.addClass(this.model.icon.path).css({color:this.model.icon.foreground,"font-size":this.model.icon.fontSize+"px"})},_updateFontSettings:function(n,t){n.removeClass("e-numbercard-text-bold e-numbercard-text-italic e-numbercard-text-underline e-numbercard-text-strikethrough");t.IsBold&&n.addClass("e-numbercard-text-bold");t.IsItalic&&n.addClass("e-numbercard-text-italic");t.IsUnderLine&&t.IsStrikeThrough?n.addClass("e-numbercard-text-underline-strikethrough"):t.IsUnderLine?n.addClass("e-numbercard-text-underline"):t.IsStrikeThrough&&n.addClass("e-numbercard-text-strikethrough")},_updateImage:function(){this.element.find(".e-number-card-image-wrapper").css({height:"40px",width:"40px"});var n=this.element.find(".e-number-card-image-container");this.model.image.visibility?this._updateImageData(n,this.model.image.data,this.model.image):n.css({"background-image":"none"});this._updateImagePosition(n,this.model.image.mode,this.model.image.data);this._swapImage()},_swapImage:function(){var t=this.element.find(".e-number-card-measure-wrapper"),n=this.element.find(".e-number-card-image-wrapper");n.css({"margin-left":"0px","margin-right":"0px"});this.element.find(".e-number-card-title-container").css({"margin-left":"0px","margin-right":"0px"});this.model.image.position==="Left"?t.before(n):t.after(n)},_updateBackgroundImage:function(){var n=this.element.find(".e-number-card-background-image-container");this.model.background.showImage?this._updateImageData(n,this.model.background.image,this.model.background):n.css({"background-image":"none"});this._updateImagePosition(n,this.model.background.mode,this.model.background.image);n.css({"background-color":this.model.background.color,opacity:this.model.background.opacity})},_updateImageData:function(n,t){n.css({"background-image":"url("+t+")"})},_updateImagePosition:function(n,i,r){if(!this._isNullOrEmptyOrUndefined(r))switch(i){case t.NumberCard.ImageModes.Fill:n.addClass("e-number-card-image-fill");n.removeClass("e-number-card-image-default e-number-card-image-uniform e-number-card-image-uniformtofill");break;case t.NumberCard.ImageModes.Uniform:n.addClass("e-number-card-image-uniform");n.removeClass("e-number-card-image-default e-number-card-image-fill e-number-card-image-uniformtofill");break;case t.NumberCard.ImageModes.UniformToFill:n.addClass("e-number-card-image-uniformtofill");n.removeClass("e-number-card-image-default e-number-card-image-fill e-number-card-image-uniform");break;default:n.addClass("e-number-card-image-default");n.removeClass("e-number-card-image-fill e-number-card-image-uniform e-number-card-image-uniformtofill")}},_updateSparkline:function(){this._updateSparklineData();this._updateSparklineColor()},_updateSparklineData:function(){if(this.model.sparkline.visibility&&this.model.sparkline.data){var i=n(this.element).attr("id")+"sparkline-gradient",t=this.element.find("#"+n(this.element).attr("id")+"-sparkline");n(t).BoldBIDashboardSparkline({dataSource:this.model.sparkline.data,padding:0,type:this.model.sparkline.type,yName:"valueName",opacity:this.model.sparkline.opacity,width:2,loaded:n.proxy(this._onSparklineLoaded,this)})}},_onSparklineLoaded:function(){var i="#"+n(this.element).attr("id")+"-sparkline_sparkline_svg_area_series_fill",t=this.element.find(i),r=t.attr("d").replace("Z","");t.attr("d",r)},_updateSparklineColor:function(){var u='<svg style="height: 0"><defs><linearGradient id='+n(this.element).attr("id")+'sparkline-gradient style="opacity: 0.75" class="chart-gradient" x1="0" x2="0" y1="0" y2="1"><stop offset="0" stop-color='+this.model.sparkline.fill+" stop-opacity="+this.model.sparkline.opacity+' ><\/stop><stop offset="0.9" stop-color='+this.model.sparkline.fill+" stop-opacity=0><\/stop><\/linearGradient><\/defs><\/svg>",f=this.element.find(".e-sparkline-gradient-container"),i,r;if(f.html(u),i=this.element.find("#"+n(this.element).attr("id")+"-sparkline").data("BoldBIDashboardSparkline"),!t.isNullOrUndefined(i)){switch(this.model.sparkline.type){case"area":r=n(this.element).attr("id")+"sparkline-gradient";i.model.stroke=this.model.sparkline.fill;i.model.fill="url(#"+r+")";i.model.opacity=this.model.sparkline.opacity;break;case"column":i.model.fill=this.model.sparkline.followDirectionColor&&!this.model.sparkline.isColorCustomized?this.getDirectionColor():this.model.sparkline.fill;break;default:i.model.stroke=this.getStrokeColor()}i.redraw()}},_updateElementsTooltip:function(){this.element.find(".e-number-card-title-text").removeClass(this._tooltipClass);this.element.find(".e-number-card-description-text").removeClass(this._tooltipClass);this.element.find(".e-number-card-dimension-text").removeClass(this._tooltipClass);this.element.find(".e-number-card-measure-text").removeClass(this._tooltipClass);this.element.find(".e-number-card-title-text").addClass(this.model.tooltip.class);this.element.find(".e-number-card-description-text").addClass(this.model.tooltip.class);this.element.find(".e-number-card-dimension-text").addClass(this.model.tooltip.class);this.element.find(".e-number-card-measure-text").addClass(this.model.tooltip.class)},_updateInformationTooltip:function(){this._isNullOrEmptyOrUndefined(this.model.tooltip.class)||this._isNullOrEmptyOrUndefined(this.model.tooltip.attribute)||(this.element.find(".e-number-card-information-icon").removeClass(this._tooltipClass),this.element.find(".e-number-card-information-icon").addClass(this.model.tooltip.class).attr(this.model.tooltip.attribute,this.model.tooltip.text))},_getResolutionBasedFontSize:function(n){return this.model.autoFontSize.enable?n+this.model.autoFontSize.fontSizeFactor/100*window.screen.width:n},_updateWrapperHeight:function(){this._updateTitleWrap();var i=this._getFontHight(!1),n=16,t=16,r=this.model.size.width-n-t;this.element.find(".e-number-card-wrapper-parent").css({width:r+"px","margin-left":n+"px","margin-right":t+"px"});this.element.find(".e-number-card-value-wrapper").css({height:i+"px"})},_getFontHight:function(n){var e=this._isSparklinePresent()?(this.model.size.height-this.margin-this.marginTop-this.bottomMargin)*.2:0,i=this.model.size.height-this.margin-this.marginTop-this.bottomMargin,c=this.element.find(".e-number-card-title-container").hasClass("e-number-card-display-flex")&&this.element.find(".e-number-card-content-image-wrapper").hasClass("e-number-card-display-flex")?this.inBetweenMargin*2:0,o=this.element.find(".e-number-card-title-text").height(),l=this.model.description.visibility?this.element.find(".e-number-card-description-text").height()+10:0,u,f,w,r;o<l&&(o=l);var a=this.element.find(".e-number-card-dimension-text").height(),v=this.element.find(".e-number-card-icon-container").height(),y=this.element.find(".e-number-card-measure-text").height(),p=this.element.find(".e-number-card-content-image-wrapper").height(),h=v>y?v:y,h=h<p?p:h,s=o+a+h+c+e,t=s;if(n)return t;if(this.model.responsiveMargin){if(this.model.alignment.vertical!=="Center"){for(u=this.model.alignment.vertical==="Top"?this.marginTop:this.bottomMargin,f=i;f<t;)if(f=f+1,u=u-1,u<4){w=4-u;u=4;f=f-w;break}i=f;this.model.alignment.vertical==="Top"?(this.marginTop=u,this.marginTopWithSparkline=this.marginTopWithSparkline>this.marginTop?this.marginTop:this.marginTopWithSparkline):(this.bottomMargin=u,this.bottomMarginWithSparkline=this.bottomMarginWithSparkline>this.bottomMargin?this.bottomMargin:this.bottomMarginWithSparkline)}i<t&&(this.inBetweenMargin=3,s=s-c+this.inBetweenMargin,t=s)}return i<t?(r=t-e,i>r?this._isMeasurePresent()||this._isImagePresent()||this._isTitlePresent()?(this._hideSparkline(),t=r):t=i:(r=t-e-o,i>=r?this._isMeasurePresent()||this._isImagePresent()?(this._hideSparkline(),this._hideTitle(),t=r):t=i:(r=t-e-a-o,i>=r?this._isMeasurePresent()||this._isImagePresent()?(this._hideDimension(),this._hideSparkline(),this._hideTitle(),t=r):t=i:((this._isMeasurePresent()||this._isImagePresent())&&(this._hideSparkline(),this._hideDimension(),this._hideTitle()),t=i)))):t=s-e,t},_resize:function(){this.element.css({height:this.model.size.height+"px",width:this.model.size.width+"px"});this.element.find(".e-number-card-sparkline-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.find(".e-number-card-information-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this.element.find(".e-number-card-background-image-wrapper").css({height:this.model.size.height-this.margin+"px",width:this.model.size.width-this.margin+"px"});this._responsiveLayout()},_getIconFontSizeBasedOnResolution:function(){return window.screen.width<1920?"12px":window.screen.width<3840?"16px":"32px"},_resizeSparklineContainer:function(){var n=this.element.find(".e-number-card-sparkline-container").hasClass("e-number-card-display-flex")?this.marginTopWithSparkline:this.marginTop,t=(this.model.size.height-this.margin-n-this.bottomMargin)*.2;this.element.find(".e-number-card-sparkline-container").css({height:t+"px",width:this.model.size.width-this.margin+"px"});this._resizeSparkline()},_resizeSparkline:function(){var r=this.element.find(".e-number-card-sparkline-container").hasClass("e-number-card-display-flex")?this.marginTopWithSparkline:this.marginTop,u=(this.model.size.height-this.margin-r-this.bottomMargin)*.2,i=this.element.find("#"+n(this.element).attr("id")+"-sparkline").data("BoldBIDashboardSparkline");t.isNullOrUndefined(i)||(i.model.size.height=u,i.model.size.width=this.model.size.width-this.margin,i.redraw())},_responsiveLayout:function(){this._updateSparklineVisibility();this._updateTitleVisibility();this._updateDimensionVisibility();this.model.size.width>=218&&!this._isNullOrEmptyOrUndefined(this.model.image.data)&&this.model.image.visibility?(this._showImage(),this._hideInformationIcon()):(this._hideImage(),this.model.informationIcon.visibility&&this.model.image.visibility&&!this._isNullOrEmptyOrUndefined(this.model.image.data)?this._showInformationIcon():this._hideInformationIcon());this._updateMeasureWrapperWidth();var n=this.element.find(".e-number-card-description-text");n.css({"font-size":this._getIconFontSizeBasedOnResolution()});this._updateTitlePosition();this._updateMeasureWrapperWidth();this._updateContentImageWrapper();this._resizeBackgroundContainer();this._updateWrapperHeight();this._resizeSparklineContainer();this._updateMargin();this._applyAnimation()},_calculateFontSize:function(){var n=this._isSparklinePresent()?this.model.size.height*.75-this.marginTopWithSparkline-this.bottomMargin:this.model.size.height-this.marginTop-this.bottomMargin;n=this.model.title.visibility&&(this.model.measure.visibility||this.model.image.visibility)?n-this.inBetweenMargin*2:n;var r=this.model.measure.visibility||this.model.image.visibility?.24*n:n,i=this.model.title.visibility?.76*n:n,t=this.model.size.width-32;t=this._isImagePresent()?t*.8-16:t;var u=this._isNullOrEmptyOrUndefined(this.model.autoFontSize.measureText)?this.model.measure.text:this.model.autoFontSize.measureText,f=this._isNullOrEmptyOrUndefined(this.model.autoFontSize.titleText)?this.model.title.text:this.model.autoFontSize.titleText,e=this._getOptimumFontSize(r,t,f),o=this._getOptimumFontSize(i,t,u);this.element.find(".e-number-card-title-text").css("font-size",e);this.element.find(".e-number-card-measure-text").css("font-size",o);this.element.find(".e-number-card-image-wrapper").css({height:i+"px",width:t*.2+"px"})},_getOptimumFontSize:function(n,t,i){for(var r=null,u=null,f=.1,r=.9;;)if(u=this._measureText(i,t,"Bold "+n*r+" Roboto"),u.width>t||u.height>n){if(r.toFixed(1)<=f)return n*r;r-=f}else return n*r},_measureText:function(i,r,u){var s=n(document).find("#cardMeasureText"),f=null,h=0,c=-1,e,v;s.length===h?(f=document.createElement("text"),n(f).attr({id:"cardMeasureText"}),document.body.appendChild(f)):f=s[0];var l="",o="",a="";return f.innerHTML=i,typeof u!="undefined"&&typeof u.size=="undefined"&&(e=u,e=e.split(" "),l=e[0],o=e[1],a=e[2]),u!==null&&(f.style.fontSize=u.size>h?u.size+"px":u.size?u.size:o.indexOf("px")===c&&o.indexOf("%")===c?o+"px":o,f.style.fontStyle=u.fontStyle?u.fontStyle:l,f.style.fontFamily=u.fontFamily?u.fontFamily:a),f.style.backgroundColor="white",f.style.position="absolute",f.style.top=-100,f.style.left=0,f.style.visibility="hidden",r&&(f.style.maxwidth=r+"px"),v={width:f.offsetWidth,height:f.offsetHeight},t.browserInfo().name==="msie"||t.browserInfo().name==="webkit"?f.parentNode.removeChild(f):f.remove(),v},_updateMeasureWrapperWidth:function(){if(this._isImagePresent())this.element.find(".e-number-card-measure-wrapper").css("max-width","Calc(100% - 56px)");else this.element.find(".e-number-card-measure-wrapper").css("max-width","100%")},_updateTitlePosition:function(){var n=this.element.find(".e-number-card-title-container"),i=this.element.find(".e-number-card-content-image-wrapper");this.model.title.position===t.NumberCard.TitlePosition.Top?i.before(n):i.after(n)},_updateMeasureWrapperWidth:function(){this._isImagePresent()?this.element.find(".e-number-card-measure-wrapper").css("max-width","Calc(100% - 57px)"):this.element.find(".e-number-card-measure-wrapper").css("max-width","100%")},_updateMargin:function(){var i=this.element.find(".e-number-card-content-image-wrapper"),r=this.element.find(".e-number-card-title-container"),o=i.hasClass("e-number-card-display-flex"),s=r.hasClass("e-number-card-display-flex"),n=o&&s?this.inBetweenMargin:0,u,f,e;this.model.title.position===t.NumberCard.TitlePosition.Top?(i.css({"margin-top":n+"px","margin-bottom":"0px"}),r.css({"margin-bottom":n+"px","margin-top":"0px"})):(i.css({"margin-bottom":n+"px","margin-top":"0px"}),r.css({"margin-top":n+"px","margin-bottom":"0px"}));this._isImagePresent()?(n=56,u=this.model.alignment.horizontal==="Center"?"0px":n+"px",this.model.image.position==="Left"?(this.element.find(".e-number-card-title-container").css({"margin-left":u,"margin-right":"0px"}),this.element.find(".e-number-card-image-wrapper").css({"margin-left":"0","margin-right":"16px"})):(this.element.find(".e-number-card-title-container").css({"margin-left":"0px","margin-right":u}),this.element.find(".e-number-card-image-wrapper").css({"margin-left":"16px","margin-right":"0px"}))):(this.element.find(".e-number-card-title-container").css({"margin-left":"0px","margin-right":"0px"}),this.element.find(".e-number-card-image-wrapper").css({"margin-left":"0px","margin-right":"0px"}));f=this.element.find(".e-number-card-sparkline-container").hasClass("e-number-card-display-flex")?this.marginTopWithSparkline:this.marginTop;e=this.element.find(".e-number-card-sparkline-container").hasClass("e-number-card-display-flex")?this.bottomMarginWithSparkline:this.bottomMargin;this.element.find(".e-number-card-wrapper-parent").css({"margin-bottom":e+"px","margin-top":f+"px"})},_applyAnimation:function(){if(this.model.measure.visibility&&this.model.animationSettings.enableAnimation){var t=this.element.find(".e-number-card-measure-text");n(t).stop();n(t).prop("Counter",0).animate({Counter:this.model.measure.text},{duration:this.model.animationSettings.animationDuration,easing:"swing",step:n.proxy(this._animateNumbers,this)})}},_animateNumbers:function(i){if(!t.isNullOrUndefined(this.element)){var u=this.element.find(".e-number-card-measure-text"),r=JSON.parse(JSON.stringify(this.model.valueRepresentation));this.formatting.isIntegerValue(this.model.measure.text)&&i!==this.model.measure.text&&(r.numberOfDecimals=0);n(u).text(this.formatting.applyFormat(i,r))}},_updateCardAlignment:function(){this.element.find(".e-number-card-wrapper").removeClass("e-number-card-justify-start e-number-card-justify-center e-number-card-justify-end e-number-card-align-start e-number-card-align-center e-number-card-align-end");this.element.find(".e-number-card-title-container").removeClass("e-number-card-justify-start e-number-card-justify-center e-number-card-justify-end");this.element.find(".e-number-card-content-image-wrapper").removeClass("e-number-card-justify-start e-number-card-justify-center e-number-card-justify-end");this.model.alignment.horizontal==="Right"?(this.element.find(".e-number-card-wrapper").addClass("e-number-card-justify-end"),this.element.find(".e-number-card-title-container").addClass("e-number-card-justify-end"),this.element.find(".e-number-card-content-image-wrapper").addClass("e-number-card-justify-end")):this.model.alignment.horizontal==="Center"?(this.element.find(".e-number-card-wrapper").addClass("e-number-card-justify-center"),this.element.find(".e-number-card-title-container").addClass("e-number-card-justify-center"),this.element.find(".e-number-card-content-image-wrapper").addClass("e-number-card-justify-center")):(this.element.find(".e-number-card-wrapper").addClass("e-number-card-justify-start"),this.element.find(".e-number-card-title-container").addClass("e-number-card-justify-start"),this.element.find(".e-number-card-content-image-wrapper").addClass("e-number-card-justify-start"));switch(this.model.alignment.vertical){case"Bottom":this.element.find(".e-number-card-wrapper").addClass("e-number-card-align-end");break;case"Center":this.element.find(".e-number-card-wrapper").addClass("e-number-card-align-center");break;default:this.element.find(".e-number-card-wrapper").addClass("e-number-card-align-start")}},_isNullOrEmptyOrUndefined:function(n){return n===null||n===""||typeof n=="undefined"},_isMeasurePresent:function(){return this.element.find(".e-number-card-measure-wrapper").hasClass("e-number-card-display-flex")&&this.model.measure.visibility},_isTitlePresent:function(){return this.element.find(".e-number-card-title-container").hasClass("e-number-card-display-flex")&&this.model.title.visibility},_isImagePresent:function(){return this.element.find(".e-number-card-image-wrapper").hasClass("e-number-card-display-flex")&&this.model.image.visibility},_isSparklinePresent:function(){return this.model.sparkline.visibility&&!t.isNullOrUndefined(this.model.sparkline.data)&&this.model.sparkline.data.length>0},_destroy:function(){this._unwireEvents();this.element.empty()},_selectedHandler:function(t){var i=this;this._hideTooltip();this._hideTooltipDescription();this.singleTimer=setTimeout(function(){var r={};i.model.selected&&(r={model:i.model,currentTarget:n("#"+i.element.attr("id")),PageX:t.pageX,PageY:t.pageY},i._trigger("selected",r),t.stopPropagation(),t.bubbles=!1)},400)},_hideTooltip:function(i){t.isNullOrUndefined(i)||(i.bubbles=!1,n.isFunction(i.stopPropagation)&&i.stopPropagation());this.singleTimer&&clearTimeout(this.singleTimer);this.singleTimer=setTimeout(()=>{t.isNullOrUndefined(n("#"+this.pluginName+"_Track_ToolTip_Template"))||n("#"+this.pluginName+"_Track_ToolTip_Template").css("display","none")},50)},_toolTipInitializeHandler:function(t){var i=this,r={};n(t.target).hasClass("e-number-card-description-text")||(this.singleTimer=setTimeout(function(){var e=i.formatting.applyFormat(i.model.measure.text,i.model.valueRepresentation),u,f;if(r={model:i.model,currentTarget:t.target,PageX:t.pageX,PageY:t.pageY,currentText:t.target.getAttribute("data-tooltip"),measureValue:e},i._trigger("toolTipInitialize",r),i.model.enableTooltip){u=n("#"+i.pluginName+"_Track_ToolTip_Template");u.length===0&&(u=n("<div id='"+i.pluginName+"_Track_ToolTip_Template' class='bbi-number-card-tooltip'><\/div>"),n(document.body).append(u[0]));f={position:"absolute",top:t.pageY+n(document).scrollTop(),left:t.pageX+n(document).scrollLeft(),"border-style":"solid","border-color":"transparent","border-width":1,opacity:1,"z-index":1e5,"border-radius":"0px","padding-left":"5px","padding-right":"5px","padding-top":"2px","padding-bottom":"2px"};n(u).css(f);n("#"+i.pluginName+"_Track_ToolTip_Template").html(r.currentText);t.pageX=t.pageX+5;t.pageY=t.pageY+20;var o=t.pageX+n("#"+i.pluginName+"_Track_ToolTip_Template").outerWidth(!0),s=n(document).width(),h=t.pageY+n("#"+i.pluginName+"_Track_ToolTip_Template").outerHeight(!0),c=n(document).height();o>s&&(t.pageX=t.pageX-n("#"+i.pluginName+"_Track_ToolTip_Template").outerWidth(!0));h>c&&(t.pageY=t.pageY-n("#"+i.pluginName+"_Track_ToolTip_Template").outerHeight(!0));n("#"+i.pluginName+"_Track_ToolTip_Template").css({top:`${t.pageY}px`,left:`${t.pageX}px`,display:"block"});t.stopPropagation();t.bubbles=!1}},10))},_showTooltipDescription:function(t){var i=this;this._hideTooltip();this.singleTimer=setTimeout(function(){var r=n("#"+i.pluginName+"Description_Track_ToolTip_Template");r.length===0&&(r=n("<div id='"+i.pluginName+"Description_Track_ToolTip_Template' class='boldbi-dashboarddesigner bbi-dbrd-designer-tooltip'><\/div>"),n(document.body).append(r[0]));n("#"+i.pluginName+"Description_Track_ToolTip_Template").css({position:"absolute","z-index":100001,"font-size":"12px","font-family":"'Heebo', 'Roboto'",color:"var(--primary-text-normal-color)","white-space":"pre-wrap","max-width":"400px","word-wrap":"break-word",padding:"10px","border-radius":"4px","box-shadow":"0 2px 4px 0 rgba(0,0,0,.12)",border:"1px solid var(--designer-primary-border-color)",background:"var(--designer-preview-background)","min-height":"15px",width:"auto",height:"auto",cursor:"pointer"});n("#"+i.pluginName+"Description_Track_ToolTip_Template").html(t.target.getAttribute("data-tooltip"));t.pageY=t.pageY+20;t.pageX=t.pageX+10;var u=t.pageX+n("#"+i.pluginName+"Description_Track_ToolTip_Template").outerWidth(!0),f=n(document.body).width(),e=t.pageY+n("#"+i.pluginName+"Description_Track_ToolTip_Template").outerHeight(!0),o=n(document.body).height();u>f&&(t.pageX=t.pageX-n("#"+i.pluginName+"Description_Track_ToolTip_Template").outerWidth(!0));e>o&&(t.pageY=t.pageY-n("#"+i.pluginName+"Description_Track_ToolTip_Template").outerHeight(!0));n("#"+i.pluginName+"Description_Track_ToolTip_Template").css({top:`${t.pageY}px`,left:`${t.pageX}px`,display:"block"});t.stopPropagation();t.bubbles=!1},10)},_hideTooltipDescription:function(i){t.isNullOrUndefined(i)||(i.bubbles=!1,n.isFunction(i.stopPropagation)&&i.stopPropagation());this.singleTimer&&clearTimeout(this.singleTimer);this.singleTimer=setTimeout(()=>{t.isNullOrUndefined(n("#"+this.pluginName+"Description_Track_ToolTip_Template"))||n("#"+this.pluginName+"Description_Track_ToolTip_Template").css("display","none")},50)}});t.NumberCard.ImageModes={Default:"Default",Fill:"Fill",Uniform:"Uniform",UniformToFill:"Uniform To Fill"};t.NumberCard.PlotArea={Complete:"Complete",CardBackground:"Card Background"};t.NumberCard.TitlePosition={Top:"Top",Bottom:"Bottom"}}(bbdesigner$,SyncfusionBoldBIDashboard);
