@using Syncfusion.Server.Base;
@using Syncfusion.Server.Base.DataClasses;
@using System.Security.Claims;
@{ 
    var isMfaEnabled = ViewBag.IsMfaEnabled != null ? (bool)ViewBag.IsMfaEnabled : false;
    var headerLogo = (ViewBag.LoginLogo != null) ? ViewBag.LoginLogo : CloudAppConfig.FallbackLoginLogoUrl;
    var imageHelper = new ImageHelper(Context);
}


<div role="tabpanel" class="tab-pane col-12 float-start no-padding twofa-tab" id="2fa-tab">
    <div id="2fa" class="col-lg-12 col-md-12 col-sm-12 col-12 float-start admin-page-body">

        <div class="col-12 float-start no-padding">
        </div>
        @if (!isMfaEnabled)
        {<div class="twofa-container">
             <img src="@imageHelper.MfaLogo()" />
                <div>
                    @Html.Label("configure-2FA", T["Configure two factor authentication"].Value, new { @class = "app-textbox-label" })
                </div>
                <div class="info-message">
                    @Html.Raw(string.Format(T["Two factor authentication adds an extra layer of security to your {0} account. Once enabled, each time you login you will also be prompted to enter a code which is generated by your smartphone."].Value, GlobalAppSettings.SystemSettings.OrganizationName))
                </div>
                <button type="button" id="mfa-button" class="app-button primary-button">@T["Enable Two Factor Authentication"]</button>
            </div>
        }
        else
        {
            <img src="@imageHelper.MfaSuccessImage()" />
            @Html.Label("configure-2FA", T["Two factor authentication is enabled for this user account."].Value, new { @class = "app-textbox-label" })
            <div class="mfa-disable">
                <button type="button" class="secondary-button" id="generate-recovery-code">@T["Regenerate Recovery Code"]</button>
                <div class="mfa-button"><a href="" id="mfa-disable-button" class="mfa-disable-button text-decoration-none">@T["Remove Two Factor Authentication"]</a></div>
            </div>
        }
    </div>
</div>

