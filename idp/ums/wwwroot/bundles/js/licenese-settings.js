var windowRef,changeSubscriptionDialog;function fnBeforeOpen(){document.getElementById("change-subscription-dialog").style.visibility="visible"}function fnOnClose(){$(".online-change-subscription").attr("license-service-url",""),$(".offline-change-subscription").attr("data-offlinelicense-url","").attr("data-tenant-type","")}function handleApplyLicense(e,t){var i,o;void 0!==t.originalEvent.data.isSuccess&&(!0===t.originalEvent.data.isSuccess?(i=null!=t.originalEvent.data.refreshtoken?t.originalEvent.data.refreshtoken:"",o=null!=t.originalEvent.data.boldLicenseToken&&null!=t.originalEvent.data.boldLicenseToken?t.originalEvent.data.boldLicenseToken:"",$.ajax({type:"POST",url:updateLicenseKeyUrl,data:{licenseKey:t.originalEvent.data.licenseKey,refreshToken:i,licenseType:"1",boldLicenseToken:o,currentUrl:window.location.origin},beforeSend:showWaitingPopup("server-app-container"),success:function(e){e.Status?(hideWaitingPopup("server-app-container"),SuccessAlert(window.Server.App.LocalizationContent.ManageLicense,window.Server.App.LocalizationContent.LicenseUpdated,7e3),window.location.reload()):(hideWaitingPopup("server-app-container"),WarningAlert(window.Server.App.LocalizationContent.ManageLicense,window.Server.App.LocalizationContent.LicenseUpdateFailed,e.Message,0))}})):!1===t.originalEvent.data.isSuccess&&WarningAlert(window.Server.App.LocalizationContent.ManageLicense,window.Server.App.LocalizationContent.LicenseUpdateFailed,null,0))}function checkWindowRef(e){windowRef.closed&&($("#update-onpremise-plan-bi").show(),$("#update-license-key-notification-loader-bi").hide(),$("#update-onpremise-plan-reports").show(),$("#update-license-key-notification-loader-reports").hide(),hideWaitingPopup("server-app-container"),clearInterval(timer))}function licenseWindow(e,t,i){void 0!==windowRef&&(clearInterval(timer),windowRef.close()),addButtonObj=e,$(window).off("message",$.proxy(handleApplyLicense,window,addButtonObj)),$(window).on("message",$.proxy(handleApplyLicense,window,addButtonObj)),showWaitingPopup("server-app-container"),windowRef=window.open(e.attr("license-service-url")+"&origin="+window.location.origin,"","height="+t,"width="+i),timer=setInterval($.proxy(checkWindowRef,500,addButtonObj))}$(document).ready(function(){null!=location.href.match(/boldbi/)?(history.pushState(null,"","?product=embedded-bi"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-bi").closest("li").addClass("active"),$("#bold-bi").tab("show"),$("#bold-bi-tab").addClass("active"),$("#bold-reports-tab").removeClass("active")):null!=location.href.match(/boldreports/)?(history.pushState(null,"","?product=enterprise-reporting"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-reports").closest("li").addClass("active"),$("#bold-reports").tab("show"),$("#bold-reports-tab").addClass("active"),$("#bold-bi-tab").removeClass("active")):null!=location.href.match(/embedded-bi/)?(history.pushState(null,"","?product=enterprise-bi"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-bi").closest("li").addClass("active"),$("#bold-bi").tab("show"),$("#bold-bi-tab").addClass("active"),$("#bold-reports-tab").removeClass("active")):null!=location.href.match(/enterprise-reporting/)?(history.pushState(null,"","?product=enterprise-reporting"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-reports").closest("li").addClass("active"),$("#bold-reports").tab("show"),$("#bold-reports-tab").addClass("active"),$("#bold-bi-tab").removeClass("active")):null==location.href.match(/boldbi/)&&null==location.href.match(/boldreports/)&&null==location.href.match(/boldbi/)&&null==location.href.match(/boldbi/)&&("true"==isBoldBiLicenseAvailable.toLowerCase()&&"true"==isBoldReportsLicenseAvailable.toLowerCase()||"true"==isBoldBiLicenseAvailable.toLowerCase()&&"false"==isBoldReportsLicenseAvailable.toLowerCase()?(history.pushState(null,"","?product=embedded-bi"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-bi").closest("li").addClass("active"),$("#bold-bi").tab("show"),$("#bold-bi-tab").addClass("active"),$("#bold-reports-tab").removeClass("active")):"false"==isBoldBiLicenseAvailable.toLowerCase()&&"true"==isBoldReportsLicenseAvailable.toLowerCase()&&(history.pushState(null,"","?product=enterprise-reporting"),$("ul.nav.nav-tabs li").removeClass("active"),$("#bold-reports").closest("li").addClass("active"),$("#bold-reports").tab("show"),$("#bold-reports-tab").addClass("active"),$("#bold-bi-tab").removeClass("active"))),$("a[data-bs-toggle='tab']").on("click",function(e){$("ul.nav.nav-tabs li").removeClass("active");var t=window.location.search.toString();switch($(this).attr("id")){case"bold-bi":$(this).closest("li").addClass("active"),"?product=embedded-bi"===t&&"?product=boldbi"===t||(history.pushState(null,"","?product=embedded-bi"),$("#bold-bi-tab").addClass("active"),$("#bold-reports-tab").removeClass("active"));break;case"bold-reports":$(this).closest("li").addClass("active"),"?product=enterprise-reporting"===t&&"?product=boldreports"===t||(history.pushState(null,"","?product=enterprise-reporting"),$("#bold-reports-tab").addClass("active"),$("#bold-bi-tab").removeClass("active"))}}),(changeSubscriptionDialog=new ej.popups.Dialog({header:window.Server.App.LocalizationContent.EditSubscriptionDialogHeader,content:document.getElementById("change-subscription-dialog"),showCloseIcon:!0,width:"546px",height:"279px",isModal:!0,visible:!1,beforeOpen:fnBeforeOpen,animationSettings:{effect:"Zoom"},close:fnOnClose})).appendTo("#change-subscription-content");[].slice.call(document.querySelectorAll('[data-bs-toggle="tooltip"]')).map(function(e){return new bootstrap.Tooltip(e)});isBoldBILicenseExpired&&($("#bold-bi-tab #details-information").css("padding-top","20px"),$("#change-subscription-content_title").html(window.Server.App.LocalizationContent.RenewSubscriptionDialogHeader)),isBoldReportsLicenseExpired&&($("#bold-reports-tab #details-information").css("padding-top","20px"),$("#change-subscription-content_title").html(window.Server.App.LocalizationContent.RenewSubscriptionDialogHeader))}),$(document).on("click","#change-subscription",function(){$(".online-change-subscription").attr("license-service-url",$(this).attr("license-service-url")+"&change_subscription=true"),$(".offline-change-subscription").attr("data-offlinelicense-url",$(this).attr("data-offlinelicense-url")).attr("data-tenant-type",$(this).attr("data-tenant-type")),$("#change-subscription-help").attr("href",$(this).attr("data-offlinelicense-url")),$("#change-subscription-content_title").html(window.Server.App.LocalizationContent.RefreshLicenseDialogHeader),changeSubscriptionDialog.show()}),$(document).on("click",".edit-link",function(){$(".online-change-subscription").attr("license-service-url",$(this).attr("license-service-url")+"&change_subscription=true"),$(".offline-change-subscription").attr("data-offlinelicense-url",$(this).attr("data-offlinelicense-url")).attr("data-tenant-type",$(this).attr("data-tenant-type")),$("#change-subscription-help").attr("href",$(this).attr("data-offlinelicense-url")),$("#change-subscription-content_title").html(window.Server.App.LocalizationContent.EditSubscriptionDialogHeader),changeSubscriptionDialog.show()}),$(document).on("click","#update-onpremise-plan-bi, #update-onpremise-plan-reports",function(e){$("#"+$(this).next("div").attr("id")).show(),$(this).hide(),licenseWindow($(this),600,500)}),$(document).on("click","#online-license-reports, #online-license-bi, .online-change-subscription",function(e){licenseWindow($(this),800,960)}),$(document).on("click","#subscription-copy-bi",function(){copyToClipboard("#subscription-id-bi","#subscription-copy-bi")}),$(document).on("click","#subscription-copy-reports",function(){copyToClipboard("#subscription-id-reports","#subscription-copy-reports")});